Variant name from 1-8: 9
Cores to use: 32-39
taskset -c 32-39 PROTOCOL_BUFFERS_PYTHON_IMPLEMENTATION=python python3.9 benchmarks_end_to_end.py feature_importance reviews slow_loading featurization_0 logistic_regression
2022-09-21 18:43:29.300614: W tensorflow/stream_executor/platform/default/dso_loader.cc:64] Could not load dynamic library 'libcudart.so.11.0'; dlerror: libcudart.so.11.0: cannot open shared object file: No such file or directory; LD_LIBRARY_PATH: /home/sgrafbe/mlwhatif/venv/lib/python3.9/site-packages/cv2/../../lib64:
2022-09-21 18:43:29.300659: I tensorflow/stream_executor/cuda/cudart_stub.cc:29] Ignore above cudart dlerror if you do not have a GPU set up on your machine.
2022-09-21 18:43:30 INFO  Patching sys.argv with ['mlwhatif', 'reviews', 'slow_loading', 'featurization_0', 'logistic_regression']
2022-09-21 18:43:30 INFO  Running instrumented original pipeline...
2022-09-21 18:43:30 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-21 18:43:30 INFO  ---RUNTIME: Importing and monkey-patching took 94.53344345092773 ms
2022-09-21 18:43:38 INFO  ---RUNTIME: Original pipeline execution took 7565.45090675354 ms (excluding imports and monkey-patching)
2022-09-21 18:43:38 INFO  Starting execution of 0 what-if analyses...
2022-09-21 18:43:38 INFO  Estimated runtime of original DAG is 5928.258895874023ms
2022-09-21 18:43:38 INFO  Performing Multi-Query Optimization
2022-09-21 18:43:38 INFO  Estimated unoptimized what-if runtime is 0ms
2022-09-21 18:43:38 INFO  Estimated optimised what-if runtime is 0ms
2022-09-21 18:43:38 INFO  Estimated optimisation runtime saving is 0ms
2022-09-21 18:43:38 INFO  ---RUNTIME: Multi-Query Optimization took 0.5064010620117188 ms
2022-09-21 18:43:38 INFO  Executing generated plans
2022-09-21 18:43:38 INFO  ---RUNTIME: Execution took 0.02574920654296875 ms
2022-09-21 18:43:38 INFO  Done!
2022-09-21 18:43:38 INFO  # Optimization benchmark for feature_importance with args [['reviews', 'slow_loading', 'featurization_0', 'logistic_regression']] -- repetition 1 of 7
2022-09-21 18:43:38 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-21 18:43:38 INFO  Running instrumented original pipeline...
2022-09-21 18:43:38 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-21 18:43:38 INFO  ---RUNTIME: Importing and monkey-patching took 5.5599212646484375 ms
2022-09-21 18:43:45 INFO  ---RUNTIME: Original pipeline execution took 6845.063209533691 ms (excluding imports and monkey-patching)
2022-09-21 18:43:45 INFO  Starting execution of 1 what-if analyses...
2022-09-21 18:43:45 INFO  Start plan generation for analysis PermutationFeatureImportance...
2022-09-21 18:43:45 INFO  ---RUNTIME: Plan generation took 0.19359588623046875 ms
2022-09-21 18:43:45 INFO  Estimated runtime of original DAG is 5250.481843948364ms
2022-09-21 18:43:45 INFO  Performing Multi-Query Optimization
2022-09-21 18:43:45 INFO  Estimated unoptimized what-if runtime is 26252.40921974182ms
2022-09-21 18:43:45 INFO  Estimated optimised what-if runtime is 6545.63045501709ms
2022-09-21 18:43:45 INFO  Estimated optimisation runtime saving is 19706.77876472473ms
2022-09-21 18:43:45 INFO  ---RUNTIME: Multi-Query Optimization took 9.588956832885742 ms
2022-09-21 18:43:45 INFO  Executing generated plans
2022-09-21 18:43:52 INFO  ---RUNTIME: Execution took 7622.073650360107 ms
2022-09-21 18:43:52 INFO  Done!
2022-09-21 18:43:52 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-21 18:43:52 INFO  Running instrumented original pipeline...
2022-09-21 18:43:52 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-21 18:43:52 INFO  ---RUNTIME: Importing and monkey-patching took 5.689144134521484 ms
2022-09-21 18:43:59 INFO  ---RUNTIME: Original pipeline execution took 7039.168834686279 ms (excluding imports and monkey-patching)
2022-09-21 18:43:59 INFO  Starting execution of 1 what-if analyses...
2022-09-21 18:43:59 INFO  Start plan generation for analysis PermutationFeatureImportance...
2022-09-21 18:43:59 INFO  ---RUNTIME: Plan generation took 0.141143798828125 ms
2022-09-21 18:43:59 INFO  Estimated runtime of original DAG is 5287.869453430176ms
2022-09-21 18:43:59 WARNING Skipping Multi-Query Optimization (instead, only applying patches)
2022-09-21 18:43:59 INFO  Estimated unoptimised what-if runtime is 26439.34726715088ms
2022-09-21 18:43:59 INFO  ---RUNTIME: Multi-Query Optimization took 3.7679672241210938 ms
2022-09-21 18:43:59 INFO  Executing generated plans
2022-09-21 18:44:30 INFO  ---RUNTIME: Execution took 30911.697387695312 ms
2022-09-21 18:44:30 INFO  Done!
2022-09-21 18:44:30 INFO  # Finished -- repetition 1 of 7 
2022-09-21 18:44:30 INFO  # Optimization benchmark for feature_importance with args [['reviews', 'slow_loading', 'featurization_0', 'logistic_regression']] -- repetition 2 of 7
2022-09-21 18:44:30 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-21 18:44:30 INFO  Running instrumented original pipeline...
2022-09-21 18:44:30 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-21 18:44:30 INFO  ---RUNTIME: Importing and monkey-patching took 6.27589225769043 ms
2022-09-21 18:44:37 INFO  ---RUNTIME: Original pipeline execution took 6895.450830459595 ms (excluding imports and monkey-patching)
2022-09-21 18:44:37 INFO  Starting execution of 1 what-if analyses...
2022-09-21 18:44:37 INFO  Start plan generation for analysis PermutationFeatureImportance...
2022-09-21 18:44:37 INFO  ---RUNTIME: Plan generation took 0.12302398681640625 ms
2022-09-21 18:44:37 INFO  Estimated runtime of original DAG is 5274.815797805786ms
2022-09-21 18:44:37 INFO  Performing Multi-Query Optimization
2022-09-21 18:44:37 INFO  Estimated unoptimized what-if runtime is 26374.07898902893ms
2022-09-21 18:44:37 INFO  Estimated optimised what-if runtime is 6564.307689666748ms
2022-09-21 18:44:37 INFO  Estimated optimisation runtime saving is 19809.771299362183ms
2022-09-21 18:44:37 INFO  ---RUNTIME: Multi-Query Optimization took 9.289026260375977 ms
2022-09-21 18:44:37 INFO  Executing generated plans
2022-09-21 18:44:45 INFO  ---RUNTIME: Execution took 7567.563772201538 ms
2022-09-21 18:44:45 INFO  Done!
2022-09-21 18:44:45 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-21 18:44:45 INFO  Running instrumented original pipeline...
2022-09-21 18:44:45 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-21 18:44:45 INFO  ---RUNTIME: Importing and monkey-patching took 6.119489669799805 ms
2022-09-21 18:44:52 INFO  ---RUNTIME: Original pipeline execution took 6929.1746616363525 ms (excluding imports and monkey-patching)
2022-09-21 18:44:52 INFO  Starting execution of 1 what-if analyses...
2022-09-21 18:44:52 INFO  Start plan generation for analysis PermutationFeatureImportance...
2022-09-21 18:44:52 INFO  ---RUNTIME: Plan generation took 0.11205673217773438 ms
2022-09-21 18:44:52 INFO  Estimated runtime of original DAG is 5299.75438117981ms
2022-09-21 18:44:52 WARNING Skipping Multi-Query Optimization (instead, only applying patches)
2022-09-21 18:44:52 INFO  Estimated unoptimised what-if runtime is 26498.771905899048ms
2022-09-21 18:44:52 INFO  ---RUNTIME: Multi-Query Optimization took 3.8633346557617188 ms
2022-09-21 18:44:52 INFO  Executing generated plans
2022-09-21 18:45:22 INFO  ---RUNTIME: Execution took 30944.16379928589 ms
2022-09-21 18:45:22 INFO  Done!
2022-09-21 18:45:23 INFO  # Finished -- repetition 2 of 7 
2022-09-21 18:45:23 INFO  # Optimization benchmark for feature_importance with args [['reviews', 'slow_loading', 'featurization_0', 'logistic_regression']] -- repetition 3 of 7
2022-09-21 18:45:23 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-21 18:45:23 INFO  Running instrumented original pipeline...
2022-09-21 18:45:23 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-21 18:45:23 INFO  ---RUNTIME: Importing and monkey-patching took 6.051063537597656 ms
2022-09-21 18:45:29 INFO  ---RUNTIME: Original pipeline execution took 6890.606641769409 ms (excluding imports and monkey-patching)
2022-09-21 18:45:29 INFO  Starting execution of 1 what-if analyses...
2022-09-21 18:45:29 INFO  Start plan generation for analysis PermutationFeatureImportance...
2022-09-21 18:45:29 INFO  ---RUNTIME: Plan generation took 0.12874603271484375 ms
2022-09-21 18:45:29 INFO  Estimated runtime of original DAG is 5266.366720199585ms
2022-09-21 18:45:29 INFO  Performing Multi-Query Optimization
2022-09-21 18:45:29 INFO  Estimated unoptimized what-if runtime is 26331.833600997925ms
2022-09-21 18:45:29 INFO  Estimated optimised what-if runtime is 6564.252853393555ms
2022-09-21 18:45:29 INFO  Estimated optimisation runtime saving is 19767.58074760437ms
2022-09-21 18:45:29 INFO  ---RUNTIME: Multi-Query Optimization took 9.622573852539062 ms
2022-09-21 18:45:29 INFO  Executing generated plans
2022-09-21 18:45:37 INFO  ---RUNTIME: Execution took 7467.7414894104 ms
2022-09-21 18:45:37 INFO  Done!
2022-09-21 18:45:37 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-21 18:45:37 INFO  Running instrumented original pipeline...
2022-09-21 18:45:37 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-21 18:45:37 INFO  ---RUNTIME: Importing and monkey-patching took 5.866050720214844 ms
2022-09-21 18:45:44 INFO  ---RUNTIME: Original pipeline execution took 6915.366649627686 ms (excluding imports and monkey-patching)
2022-09-21 18:45:44 INFO  Starting execution of 1 what-if analyses...
2022-09-21 18:45:44 INFO  Start plan generation for analysis PermutationFeatureImportance...
2022-09-21 18:45:44 INFO  ---RUNTIME: Plan generation took 0.10633468627929688 ms
2022-09-21 18:45:44 INFO  Estimated runtime of original DAG is 5289.309501647949ms
2022-09-21 18:45:44 WARNING Skipping Multi-Query Optimization (instead, only applying patches)
2022-09-21 18:45:44 INFO  Estimated unoptimised what-if runtime is 26446.547508239746ms
2022-09-21 18:45:44 INFO  ---RUNTIME: Multi-Query Optimization took 3.665447235107422 ms
2022-09-21 18:45:44 INFO  Executing generated plans
2022-09-21 18:46:15 INFO  ---RUNTIME: Execution took 31142.314672470093 ms
2022-09-21 18:46:15 INFO  Done!
2022-09-21 18:46:15 INFO  # Finished -- repetition 3 of 7 
2022-09-21 18:46:15 INFO  # Optimization benchmark for feature_importance with args [['reviews', 'slow_loading', 'featurization_0', 'logistic_regression']] -- repetition 4 of 7
2022-09-21 18:46:15 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-21 18:46:15 INFO  Running instrumented original pipeline...
2022-09-21 18:46:15 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-21 18:46:15 INFO  ---RUNTIME: Importing and monkey-patching took 6.23011589050293 ms
2022-09-21 18:46:22 INFO  ---RUNTIME: Original pipeline execution took 6916.338205337524 ms (excluding imports and monkey-patching)
2022-09-21 18:46:22 INFO  Starting execution of 1 what-if analyses...
2022-09-21 18:46:22 INFO  Start plan generation for analysis PermutationFeatureImportance...
2022-09-21 18:46:22 INFO  ---RUNTIME: Plan generation took 0.1327991485595703 ms
2022-09-21 18:46:22 INFO  Estimated runtime of original DAG is 5240.369558334351ms
2022-09-21 18:46:22 INFO  Performing Multi-Query Optimization
2022-09-21 18:46:22 INFO  Estimated unoptimized what-if runtime is 26201.847791671753ms
2022-09-21 18:46:22 INFO  Estimated optimised what-if runtime is 6536.004304885864ms
2022-09-21 18:46:22 INFO  Estimated optimisation runtime saving is 19665.84348678589ms
2022-09-21 18:46:22 INFO  ---RUNTIME: Multi-Query Optimization took 9.360551834106445 ms
2022-09-21 18:46:22 INFO  Executing generated plans
2022-09-21 18:46:29 INFO  ---RUNTIME: Execution took 7517.580032348633 ms
2022-09-21 18:46:29 INFO  Done!
2022-09-21 18:46:29 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-21 18:46:29 INFO  Running instrumented original pipeline...
2022-09-21 18:46:29 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-21 18:46:29 INFO  ---RUNTIME: Importing and monkey-patching took 5.786895751953125 ms
2022-09-21 18:46:36 INFO  ---RUNTIME: Original pipeline execution took 6918.049335479736 ms (excluding imports and monkey-patching)
2022-09-21 18:46:36 INFO  Starting execution of 1 what-if analyses...
2022-09-21 18:46:36 INFO  Start plan generation for analysis PermutationFeatureImportance...
2022-09-21 18:46:36 INFO  ---RUNTIME: Plan generation took 0.11086463928222656 ms
2022-09-21 18:46:36 INFO  Estimated runtime of original DAG is 5284.411191940308ms
2022-09-21 18:46:36 WARNING Skipping Multi-Query Optimization (instead, only applying patches)
2022-09-21 18:46:36 INFO  Estimated unoptimised what-if runtime is 26422.055959701538ms
2022-09-21 18:46:36 INFO  ---RUNTIME: Multi-Query Optimization took 3.6840438842773438 ms
2022-09-21 18:46:36 INFO  Executing generated plans
2022-09-21 18:47:07 INFO  ---RUNTIME: Execution took 31075.020790100098 ms
2022-09-21 18:47:07 INFO  Done!
2022-09-21 18:47:07 INFO  # Finished -- repetition 4 of 7 
2022-09-21 18:47:07 INFO  # Optimization benchmark for feature_importance with args [['reviews', 'slow_loading', 'featurization_0', 'logistic_regression']] -- repetition 5 of 7
2022-09-21 18:47:07 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-21 18:47:07 INFO  Running instrumented original pipeline...
2022-09-21 18:47:08 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-21 18:47:08 INFO  ---RUNTIME: Importing and monkey-patching took 6.000518798828125 ms
2022-09-21 18:47:15 INFO  ---RUNTIME: Original pipeline execution took 7347.540855407715 ms (excluding imports and monkey-patching)
2022-09-21 18:47:15 INFO  Starting execution of 1 what-if analyses...
2022-09-21 18:47:15 INFO  Start plan generation for analysis PermutationFeatureImportance...
2022-09-21 18:47:15 INFO  ---RUNTIME: Plan generation took 0.10514259338378906 ms
2022-09-21 18:47:15 INFO  Estimated runtime of original DAG is 5434.145927429199ms
2022-09-21 18:47:15 INFO  Performing Multi-Query Optimization
2022-09-21 18:47:15 INFO  Estimated unoptimized what-if runtime is 27170.729637145996ms
2022-09-21 18:47:15 INFO  Estimated optimised what-if runtime is 6726.125001907349ms
2022-09-21 18:47:15 INFO  Estimated optimisation runtime saving is 20444.604635238647ms
2022-09-21 18:47:15 INFO  ---RUNTIME: Multi-Query Optimization took 9.148836135864258 ms
2022-09-21 18:47:15 INFO  Executing generated plans
2022-09-21 18:47:22 INFO  ---RUNTIME: Execution took 7660.704612731934 ms
2022-09-21 18:47:22 INFO  Done!
2022-09-21 18:47:22 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-21 18:47:22 INFO  Running instrumented original pipeline...
2022-09-21 18:47:23 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-21 18:47:23 INFO  ---RUNTIME: Importing and monkey-patching took 5.919456481933594 ms
2022-09-21 18:47:30 INFO  ---RUNTIME: Original pipeline execution took 7041.968107223511 ms (excluding imports and monkey-patching)
2022-09-21 18:47:30 INFO  Starting execution of 1 what-if analyses...
2022-09-21 18:47:30 INFO  Start plan generation for analysis PermutationFeatureImportance...
2022-09-21 18:47:30 INFO  ---RUNTIME: Plan generation took 0.09918212890625 ms
2022-09-21 18:47:30 INFO  Estimated runtime of original DAG is 5344.6385860443115ms
2022-09-21 18:47:30 WARNING Skipping Multi-Query Optimization (instead, only applying patches)
2022-09-21 18:47:30 INFO  Estimated unoptimised what-if runtime is 26723.192930221558ms
2022-09-21 18:47:30 INFO  ---RUNTIME: Multi-Query Optimization took 3.6492347717285156 ms
2022-09-21 18:47:30 INFO  Executing generated plans
2022-09-21 18:48:01 INFO  ---RUNTIME: Execution took 31396.95167541504 ms
2022-09-21 18:48:01 INFO  Done!
2022-09-21 18:48:01 INFO  # Finished -- repetition 5 of 7 
2022-09-21 18:48:01 INFO  # Optimization benchmark for feature_importance with args [['reviews', 'slow_loading', 'featurization_0', 'logistic_regression']] -- repetition 6 of 7
2022-09-21 18:48:01 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-21 18:48:01 INFO  Running instrumented original pipeline...
2022-09-21 18:48:01 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-21 18:48:01 INFO  ---RUNTIME: Importing and monkey-patching took 5.729436874389648 ms
2022-09-21 18:48:08 INFO  ---RUNTIME: Original pipeline execution took 7139.04333114624 ms (excluding imports and monkey-patching)
2022-09-21 18:48:08 INFO  Starting execution of 1 what-if analyses...
2022-09-21 18:48:08 INFO  Start plan generation for analysis PermutationFeatureImportance...
2022-09-21 18:48:08 INFO  ---RUNTIME: Plan generation took 0.1354217529296875 ms
2022-09-21 18:48:08 INFO  Estimated runtime of original DAG is 5395.254850387573ms
2022-09-21 18:48:08 INFO  Performing Multi-Query Optimization
2022-09-21 18:48:08 INFO  Estimated unoptimized what-if runtime is 26976.274251937866ms
2022-09-21 18:48:08 INFO  Estimated optimised what-if runtime is 6694.156885147095ms
2022-09-21 18:48:08 INFO  Estimated optimisation runtime saving is 20282.11736679077ms
2022-09-21 18:48:08 INFO  ---RUNTIME: Multi-Query Optimization took 9.339570999145508 ms
2022-09-21 18:48:08 INFO  Executing generated plans
2022-09-21 18:48:16 INFO  ---RUNTIME: Execution took 7655.856370925903 ms
2022-09-21 18:48:16 INFO  Done!
2022-09-21 18:48:16 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-21 18:48:16 INFO  Running instrumented original pipeline...
2022-09-21 18:48:16 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-21 18:48:16 INFO  ---RUNTIME: Importing and monkey-patching took 6.087303161621094 ms
2022-09-21 18:48:23 INFO  ---RUNTIME: Original pipeline execution took 6940.502166748047 ms (excluding imports and monkey-patching)
2022-09-21 18:48:23 INFO  Starting execution of 1 what-if analyses...
2022-09-21 18:48:23 INFO  Start plan generation for analysis PermutationFeatureImportance...
2022-09-21 18:48:23 INFO  ---RUNTIME: Plan generation took 0.10156631469726562 ms
2022-09-21 18:48:23 INFO  Estimated runtime of original DAG is 5289.448261260986ms
2022-09-21 18:48:23 WARNING Skipping Multi-Query Optimization (instead, only applying patches)
2022-09-21 18:48:23 INFO  Estimated unoptimised what-if runtime is 26447.24130630493ms
2022-09-21 18:48:23 INFO  ---RUNTIME: Multi-Query Optimization took 3.70025634765625 ms
2022-09-21 18:48:23 INFO  Executing generated plans
2022-09-21 18:48:54 INFO  ---RUNTIME: Execution took 31717.3330783844 ms
2022-09-21 18:48:54 INFO  Done!
2022-09-21 18:48:54 INFO  # Finished -- repetition 6 of 7 
2022-09-21 18:48:54 INFO  # Optimization benchmark for feature_importance with args [['reviews', 'slow_loading', 'featurization_0', 'logistic_regression']] -- repetition 7 of 7
2022-09-21 18:48:54 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-21 18:48:54 INFO  Running instrumented original pipeline...
2022-09-21 18:48:54 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-21 18:48:54 INFO  ---RUNTIME: Importing and monkey-patching took 6.041526794433594 ms
2022-09-21 18:49:01 INFO  ---RUNTIME: Original pipeline execution took 6999.9964237213135 ms (excluding imports and monkey-patching)
2022-09-21 18:49:01 INFO  Starting execution of 1 what-if analyses...
2022-09-21 18:49:01 INFO  Start plan generation for analysis PermutationFeatureImportance...
2022-09-21 18:49:01 INFO  ---RUNTIME: Plan generation took 0.1316070556640625 ms
2022-09-21 18:49:01 INFO  Estimated runtime of original DAG is 5330.191373825073ms
2022-09-21 18:49:01 INFO  Performing Multi-Query Optimization
2022-09-21 18:49:01 INFO  Estimated unoptimized what-if runtime is 26650.956869125366ms
2022-09-21 18:49:01 INFO  Estimated optimised what-if runtime is 6628.863334655762ms
2022-09-21 18:49:01 INFO  Estimated optimisation runtime saving is 20022.093534469604ms
2022-09-21 18:49:01 INFO  ---RUNTIME: Multi-Query Optimization took 19.829988479614258 ms
2022-09-21 18:49:01 INFO  Executing generated plans
2022-09-21 18:49:09 INFO  ---RUNTIME: Execution took 7606.667757034302 ms
2022-09-21 18:49:09 INFO  Done!
2022-09-21 18:49:09 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-21 18:49:09 INFO  Running instrumented original pipeline...
2022-09-21 18:49:09 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-21 18:49:09 INFO  ---RUNTIME: Importing and monkey-patching took 5.713939666748047 ms
2022-09-21 18:49:16 INFO  ---RUNTIME: Original pipeline execution took 7116.366863250732 ms (excluding imports and monkey-patching)
2022-09-21 18:49:16 INFO  Starting execution of 1 what-if analyses...
2022-09-21 18:49:16 INFO  Start plan generation for analysis PermutationFeatureImportance...
2022-09-21 18:49:16 INFO  ---RUNTIME: Plan generation took 0.10013580322265625 ms
2022-09-21 18:49:16 INFO  Estimated runtime of original DAG is 5433.906555175781ms
2022-09-21 18:49:16 WARNING Skipping Multi-Query Optimization (instead, only applying patches)
2022-09-21 18:49:16 INFO  Estimated unoptimised what-if runtime is 27169.532775878906ms
2022-09-21 18:49:16 INFO  ---RUNTIME: Multi-Query Optimization took 3.6973953247070312 ms
2022-09-21 18:49:16 INFO  Executing generated plans
2022-09-21 18:49:48 INFO  ---RUNTIME: Execution took 31646.039247512817 ms
2022-09-21 18:49:48 INFO  Done!
2022-09-21 18:49:48 INFO  # Finished -- repetition 7 of 7 
2022-09-21 18:49:48 INFO  # Final results after all repetitions
2022-09-21 18:49:48 INFO     repetition  ... no_opt_what_if_execution_combined_model_training
0           0  ...                                       790.787458
1           1  ...                                       795.453310
2           2  ...                                       791.288376
3           3  ...                                       789.665222
4           4  ...                                       793.477297
5           5  ...                                       787.232161
6           6  ...                                       790.182114

[7 rows x 26 columns]
taskset -c 32-39 PROTOCOL_BUFFERS_PYTHON_IMPLEMENTATION=python python3.9 benchmarks_end_to_end.py feature_importance reviews slow_loading featurization_0 xgboost
2022-09-21 18:49:50.531503: W tensorflow/stream_executor/platform/default/dso_loader.cc:64] Could not load dynamic library 'libcudart.so.11.0'; dlerror: libcudart.so.11.0: cannot open shared object file: No such file or directory; LD_LIBRARY_PATH: /home/sgrafbe/mlwhatif/venv/lib/python3.9/site-packages/cv2/../../lib64:
2022-09-21 18:49:50.531546: I tensorflow/stream_executor/cuda/cudart_stub.cc:29] Ignore above cudart dlerror if you do not have a GPU set up on your machine.
2022-09-21 18:49:51 INFO  Patching sys.argv with ['mlwhatif', 'reviews', 'slow_loading', 'featurization_0', 'xgboost']
2022-09-21 18:49:51 INFO  Running instrumented original pipeline...
2022-09-21 18:49:51 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-21 18:49:51 INFO  ---RUNTIME: Importing and monkey-patching took 95.67761421203613 ms
2022-09-21 18:50:01 INFO  ---RUNTIME: Original pipeline execution took 9896.574258804321 ms (excluding imports and monkey-patching)
2022-09-21 18:50:01 INFO  Starting execution of 0 what-if analyses...
2022-09-21 18:50:01 INFO  Estimated runtime of original DAG is 8257.421255111694ms
2022-09-21 18:50:01 INFO  Performing Multi-Query Optimization
2022-09-21 18:50:01 INFO  Estimated unoptimized what-if runtime is 0ms
2022-09-21 18:50:01 INFO  Estimated optimised what-if runtime is 0ms
2022-09-21 18:50:01 INFO  Estimated optimisation runtime saving is 0ms
2022-09-21 18:50:01 INFO  ---RUNTIME: Multi-Query Optimization took 0.4973411560058594 ms
2022-09-21 18:50:01 INFO  Executing generated plans
2022-09-21 18:50:01 INFO  ---RUNTIME: Execution took 0.024318695068359375 ms
2022-09-21 18:50:01 INFO  Done!
2022-09-21 18:50:01 INFO  # Optimization benchmark for feature_importance with args [['reviews', 'slow_loading', 'featurization_0', 'xgboost']] -- repetition 1 of 7
2022-09-21 18:50:01 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-21 18:50:01 INFO  Running instrumented original pipeline...
2022-09-21 18:50:01 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-21 18:50:01 INFO  ---RUNTIME: Importing and monkey-patching took 5.420923233032227 ms
2022-09-21 18:50:11 INFO  ---RUNTIME: Original pipeline execution took 9980.447053909302 ms (excluding imports and monkey-patching)
2022-09-21 18:50:11 INFO  Starting execution of 1 what-if analyses...
2022-09-21 18:50:11 INFO  Start plan generation for analysis PermutationFeatureImportance...
2022-09-21 18:50:11 INFO  ---RUNTIME: Plan generation took 0.18477439880371094 ms
2022-09-21 18:50:11 INFO  Estimated runtime of original DAG is 8364.364624023438ms
2022-09-21 18:50:11 INFO  Performing Multi-Query Optimization
2022-09-21 18:50:11 INFO  Estimated unoptimized what-if runtime is 41821.82312011719ms
2022-09-21 18:50:11 INFO  Estimated optimised what-if runtime is 9855.526685714722ms
2022-09-21 18:50:11 INFO  Estimated optimisation runtime saving is 31966.296434402466ms
2022-09-21 18:50:11 INFO  ---RUNTIME: Multi-Query Optimization took 9.477853775024414 ms
2022-09-21 18:50:11 INFO  Executing generated plans
2022-09-21 18:50:20 INFO  ---RUNTIME: Execution took 8352.362632751465 ms
2022-09-21 18:50:20 INFO  Done!
2022-09-21 18:50:20 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-21 18:50:20 INFO  Running instrumented original pipeline...
2022-09-21 18:50:20 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-21 18:50:20 INFO  ---RUNTIME: Importing and monkey-patching took 5.808591842651367 ms
2022-09-21 18:50:28 INFO  ---RUNTIME: Original pipeline execution took 8380.047082901001 ms (excluding imports and monkey-patching)
2022-09-21 18:50:28 INFO  Starting execution of 1 what-if analyses...
2022-09-21 18:50:28 INFO  Start plan generation for analysis PermutationFeatureImportance...
2022-09-21 18:50:28 INFO  ---RUNTIME: Plan generation took 0.12683868408203125 ms
2022-09-21 18:50:28 INFO  Estimated runtime of original DAG is 6414.8571491241455ms
2022-09-21 18:50:28 WARNING Skipping Multi-Query Optimization (instead, only applying patches)
2022-09-21 18:50:28 INFO  Estimated unoptimised what-if runtime is 32074.285745620728ms
2022-09-21 18:50:28 INFO  ---RUNTIME: Multi-Query Optimization took 3.728628158569336 ms
2022-09-21 18:50:28 INFO  Executing generated plans
2022-09-21 18:51:03 INFO  ---RUNTIME: Execution took 35094.88606452942 ms
2022-09-21 18:51:03 INFO  Done!
2022-09-21 18:51:03 INFO  # Finished -- repetition 1 of 7 
2022-09-21 18:51:03 INFO  # Optimization benchmark for feature_importance with args [['reviews', 'slow_loading', 'featurization_0', 'xgboost']] -- repetition 2 of 7
2022-09-21 18:51:03 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-21 18:51:03 INFO  Running instrumented original pipeline...
2022-09-21 18:51:03 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-21 18:51:03 INFO  ---RUNTIME: Importing and monkey-patching took 6.138086318969727 ms
2022-09-21 18:51:11 INFO  ---RUNTIME: Original pipeline execution took 7546.248435974121 ms (excluding imports and monkey-patching)
2022-09-21 18:51:11 INFO  Starting execution of 1 what-if analyses...
2022-09-21 18:51:11 INFO  Start plan generation for analysis PermutationFeatureImportance...
2022-09-21 18:51:11 INFO  ---RUNTIME: Plan generation took 0.14734268188476562 ms
2022-09-21 18:51:11 INFO  Estimated runtime of original DAG is 5914.831161499023ms
2022-09-21 18:51:11 INFO  Performing Multi-Query Optimization
2022-09-21 18:51:11 INFO  Estimated unoptimized what-if runtime is 29574.155807495117ms
2022-09-21 18:51:11 INFO  Estimated optimised what-if runtime is 7407.965898513794ms
2022-09-21 18:51:11 INFO  Estimated optimisation runtime saving is 22166.189908981323ms
2022-09-21 18:51:11 INFO  ---RUNTIME: Multi-Query Optimization took 9.694099426269531 ms
2022-09-21 18:51:11 INFO  Executing generated plans
2022-09-21 18:51:20 INFO  ---RUNTIME: Execution took 9065.343141555786 ms
2022-09-21 18:51:20 INFO  Done!
2022-09-21 18:51:20 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-21 18:51:20 INFO  Running instrumented original pipeline...
2022-09-21 18:51:20 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-21 18:51:20 INFO  ---RUNTIME: Importing and monkey-patching took 5.733489990234375 ms
2022-09-21 18:51:28 INFO  ---RUNTIME: Original pipeline execution took 7903.459548950195 ms (excluding imports and monkey-patching)
2022-09-21 18:51:28 INFO  Starting execution of 1 what-if analyses...
2022-09-21 18:51:28 INFO  Start plan generation for analysis PermutationFeatureImportance...
2022-09-21 18:51:28 INFO  ---RUNTIME: Plan generation took 0.12731552124023438 ms
2022-09-21 18:51:28 INFO  Estimated runtime of original DAG is 6176.850318908691ms
2022-09-21 18:51:28 WARNING Skipping Multi-Query Optimization (instead, only applying patches)
2022-09-21 18:51:28 INFO  Estimated unoptimised what-if runtime is 30884.251594543457ms
2022-09-21 18:51:28 INFO  ---RUNTIME: Multi-Query Optimization took 3.8132667541503906 ms
2022-09-21 18:51:28 INFO  Executing generated plans
2022-09-21 18:52:03 INFO  ---RUNTIME: Execution took 34932.721853256226 ms
2022-09-21 18:52:03 INFO  Done!
2022-09-21 18:52:03 INFO  # Finished -- repetition 2 of 7 
2022-09-21 18:52:03 INFO  # Optimization benchmark for feature_importance with args [['reviews', 'slow_loading', 'featurization_0', 'xgboost']] -- repetition 3 of 7
2022-09-21 18:52:03 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-21 18:52:03 INFO  Running instrumented original pipeline...
2022-09-21 18:52:03 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-21 18:52:03 INFO  ---RUNTIME: Importing and monkey-patching took 5.856037139892578 ms
2022-09-21 18:52:11 INFO  ---RUNTIME: Original pipeline execution took 8247.058391571045 ms (excluding imports and monkey-patching)
2022-09-21 18:52:11 INFO  Starting execution of 1 what-if analyses...
2022-09-21 18:52:11 INFO  Start plan generation for analysis PermutationFeatureImportance...
2022-09-21 18:52:11 INFO  ---RUNTIME: Plan generation took 0.12683868408203125 ms
2022-09-21 18:52:11 INFO  Estimated runtime of original DAG is 6237.028121948242ms
2022-09-21 18:52:11 INFO  Performing Multi-Query Optimization
2022-09-21 18:52:11 INFO  Estimated unoptimized what-if runtime is 31185.14060974121ms
2022-09-21 18:52:11 INFO  Estimated optimised what-if runtime is 7724.32804107666ms
2022-09-21 18:52:11 INFO  Estimated optimisation runtime saving is 23460.81256866455ms
2022-09-21 18:52:11 INFO  ---RUNTIME: Multi-Query Optimization took 9.45281982421875 ms
2022-09-21 18:52:11 INFO  Executing generated plans
2022-09-21 18:52:19 INFO  ---RUNTIME: Execution took 8439.451456069946 ms
2022-09-21 18:52:19 INFO  Done!
2022-09-21 18:52:19 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-21 18:52:19 INFO  Running instrumented original pipeline...
2022-09-21 18:52:19 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-21 18:52:19 INFO  ---RUNTIME: Importing and monkey-patching took 5.965948104858398 ms
2022-09-21 18:52:27 INFO  ---RUNTIME: Original pipeline execution took 7905.386447906494 ms (excluding imports and monkey-patching)
2022-09-21 18:52:27 INFO  Starting execution of 1 what-if analyses...
2022-09-21 18:52:27 INFO  Start plan generation for analysis PermutationFeatureImportance...
2022-09-21 18:52:27 INFO  ---RUNTIME: Plan generation took 0.10085105895996094 ms
2022-09-21 18:52:27 INFO  Estimated runtime of original DAG is 6132.079601287842ms
2022-09-21 18:52:27 WARNING Skipping Multi-Query Optimization (instead, only applying patches)
2022-09-21 18:52:27 INFO  Estimated unoptimised what-if runtime is 30660.39800643921ms
2022-09-21 18:52:27 INFO  ---RUNTIME: Multi-Query Optimization took 3.654956817626953 ms
2022-09-21 18:52:27 INFO  Executing generated plans
2022-09-21 18:53:02 INFO  ---RUNTIME: Execution took 35029.22821044922 ms
2022-09-21 18:53:02 INFO  Done!
2022-09-21 18:53:02 INFO  # Finished -- repetition 3 of 7 
2022-09-21 18:53:02 INFO  # Optimization benchmark for feature_importance with args [['reviews', 'slow_loading', 'featurization_0', 'xgboost']] -- repetition 4 of 7
2022-09-21 18:53:02 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-21 18:53:02 INFO  Running instrumented original pipeline...
2022-09-21 18:53:02 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-21 18:53:02 INFO  ---RUNTIME: Importing and monkey-patching took 6.247520446777344 ms
2022-09-21 18:53:10 INFO  ---RUNTIME: Original pipeline execution took 7679.141998291016 ms (excluding imports and monkey-patching)
2022-09-21 18:53:10 INFO  Starting execution of 1 what-if analyses...
2022-09-21 18:53:10 INFO  Start plan generation for analysis PermutationFeatureImportance...
2022-09-21 18:53:10 INFO  ---RUNTIME: Plan generation took 0.11849403381347656 ms
2022-09-21 18:53:10 INFO  Estimated runtime of original DAG is 6032.967805862427ms
2022-09-21 18:53:10 INFO  Performing Multi-Query Optimization
2022-09-21 18:53:10 INFO  Estimated unoptimized what-if runtime is 30164.839029312134ms
2022-09-21 18:53:10 INFO  Estimated optimised what-if runtime is 7505.51700592041ms
2022-09-21 18:53:10 INFO  Estimated optimisation runtime saving is 22659.322023391724ms
2022-09-21 18:53:10 INFO  ---RUNTIME: Multi-Query Optimization took 9.454727172851562 ms
2022-09-21 18:53:10 INFO  Executing generated plans
2022-09-21 18:53:19 INFO  ---RUNTIME: Execution took 8644.018173217773 ms
2022-09-21 18:53:19 INFO  Done!
2022-09-21 18:53:19 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-21 18:53:19 INFO  Running instrumented original pipeline...
2022-09-21 18:53:19 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-21 18:53:19 INFO  ---RUNTIME: Importing and monkey-patching took 5.728006362915039 ms
2022-09-21 18:53:26 INFO  ---RUNTIME: Original pipeline execution took 7748.584508895874 ms (excluding imports and monkey-patching)
2022-09-21 18:53:26 INFO  Starting execution of 1 what-if analyses...
2022-09-21 18:53:26 INFO  Start plan generation for analysis PermutationFeatureImportance...
2022-09-21 18:53:26 INFO  ---RUNTIME: Plan generation took 0.09489059448242188 ms
2022-09-21 18:53:26 INFO  Estimated runtime of original DAG is 6115.405559539795ms
2022-09-21 18:53:26 WARNING Skipping Multi-Query Optimization (instead, only applying patches)
2022-09-21 18:53:26 INFO  Estimated unoptimised what-if runtime is 30577.027797698975ms
2022-09-21 18:53:26 INFO  ---RUNTIME: Multi-Query Optimization took 3.6394596099853516 ms
2022-09-21 18:53:26 INFO  Executing generated plans
2022-09-21 18:54:03 INFO  ---RUNTIME: Execution took 36284.300565719604 ms
2022-09-21 18:54:03 INFO  Done!
2022-09-21 18:54:03 INFO  # Finished -- repetition 4 of 7 
2022-09-21 18:54:03 INFO  # Optimization benchmark for feature_importance with args [['reviews', 'slow_loading', 'featurization_0', 'xgboost']] -- repetition 5 of 7
2022-09-21 18:54:03 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-21 18:54:03 INFO  Running instrumented original pipeline...
2022-09-21 18:54:03 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-21 18:54:03 INFO  ---RUNTIME: Importing and monkey-patching took 6.098747253417969 ms
2022-09-21 18:54:11 INFO  ---RUNTIME: Original pipeline execution took 8170.271396636963 ms (excluding imports and monkey-patching)
2022-09-21 18:54:11 INFO  Starting execution of 1 what-if analyses...
2022-09-21 18:54:11 INFO  Start plan generation for analysis PermutationFeatureImportance...
2022-09-21 18:54:11 INFO  ---RUNTIME: Plan generation took 0.09322166442871094 ms
2022-09-21 18:54:11 INFO  Estimated runtime of original DAG is 6224.929571151733ms
2022-09-21 18:54:11 INFO  Performing Multi-Query Optimization
2022-09-21 18:54:11 INFO  Estimated unoptimized what-if runtime is 31124.647855758667ms
2022-09-21 18:54:11 INFO  Estimated optimised what-if runtime is 7738.638877868652ms
2022-09-21 18:54:11 INFO  Estimated optimisation runtime saving is 23386.008977890015ms
2022-09-21 18:54:11 INFO  ---RUNTIME: Multi-Query Optimization took 9.20724868774414 ms
2022-09-21 18:54:11 INFO  Executing generated plans
2022-09-21 18:54:19 INFO  ---RUNTIME: Execution took 8611.538171768188 ms
2022-09-21 18:54:19 INFO  Done!
2022-09-21 18:54:19 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-21 18:54:19 INFO  Running instrumented original pipeline...
2022-09-21 18:54:19 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-21 18:54:19 INFO  ---RUNTIME: Importing and monkey-patching took 6.018161773681641 ms
2022-09-21 18:54:27 INFO  ---RUNTIME: Original pipeline execution took 7881.713390350342 ms (excluding imports and monkey-patching)
2022-09-21 18:54:27 INFO  Starting execution of 1 what-if analyses...
2022-09-21 18:54:27 INFO  Start plan generation for analysis PermutationFeatureImportance...
2022-09-21 18:54:27 INFO  ---RUNTIME: Plan generation took 0.11897087097167969 ms
2022-09-21 18:54:27 INFO  Estimated runtime of original DAG is 6117.161750793457ms
2022-09-21 18:54:27 WARNING Skipping Multi-Query Optimization (instead, only applying patches)
2022-09-21 18:54:27 INFO  Estimated unoptimised what-if runtime is 30585.808753967285ms
2022-09-21 18:54:27 INFO  ---RUNTIME: Multi-Query Optimization took 3.736734390258789 ms
2022-09-21 18:54:27 INFO  Executing generated plans
2022-09-21 18:55:03 INFO  ---RUNTIME: Execution took 35907.39345550537 ms
2022-09-21 18:55:03 INFO  Done!
2022-09-21 18:55:03 INFO  # Finished -- repetition 5 of 7 
2022-09-21 18:55:03 INFO  # Optimization benchmark for feature_importance with args [['reviews', 'slow_loading', 'featurization_0', 'xgboost']] -- repetition 6 of 7
2022-09-21 18:55:03 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-21 18:55:03 INFO  Running instrumented original pipeline...
2022-09-21 18:55:03 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-21 18:55:03 INFO  ---RUNTIME: Importing and monkey-patching took 5.937814712524414 ms
2022-09-21 18:55:11 INFO  ---RUNTIME: Original pipeline execution took 7892.020702362061 ms (excluding imports and monkey-patching)
2022-09-21 18:55:11 INFO  Starting execution of 1 what-if analyses...
2022-09-21 18:55:11 INFO  Start plan generation for analysis PermutationFeatureImportance...
2022-09-21 18:55:11 INFO  ---RUNTIME: Plan generation took 0.10514259338378906 ms
2022-09-21 18:55:11 INFO  Estimated runtime of original DAG is 6195.00470161438ms
2022-09-21 18:55:11 INFO  Performing Multi-Query Optimization
2022-09-21 18:55:11 INFO  Estimated unoptimized what-if runtime is 30975.0235080719ms
2022-09-21 18:55:11 INFO  Estimated optimised what-if runtime is 7754.596471786499ms
2022-09-21 18:55:11 INFO  Estimated optimisation runtime saving is 23220.4270362854ms
2022-09-21 18:55:11 INFO  ---RUNTIME: Multi-Query Optimization took 9.412050247192383 ms
2022-09-21 18:55:11 INFO  Executing generated plans
2022-09-21 18:55:20 INFO  ---RUNTIME: Execution took 8633.318424224854 ms
2022-09-21 18:55:20 INFO  Done!
2022-09-21 18:55:20 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-21 18:55:20 INFO  Running instrumented original pipeline...
2022-09-21 18:55:20 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-21 18:55:20 INFO  ---RUNTIME: Importing and monkey-patching took 6.04701042175293 ms
2022-09-21 18:55:28 INFO  ---RUNTIME: Original pipeline execution took 7896.65961265564 ms (excluding imports and monkey-patching)
2022-09-21 18:55:28 INFO  Starting execution of 1 what-if analyses...
2022-09-21 18:55:28 INFO  Start plan generation for analysis PermutationFeatureImportance...
2022-09-21 18:55:28 INFO  ---RUNTIME: Plan generation took 0.11348724365234375 ms
2022-09-21 18:55:28 INFO  Estimated runtime of original DAG is 6102.384090423584ms
2022-09-21 18:55:28 WARNING Skipping Multi-Query Optimization (instead, only applying patches)
2022-09-21 18:55:28 INFO  Estimated unoptimised what-if runtime is 30511.92045211792ms
2022-09-21 18:55:28 INFO  ---RUNTIME: Multi-Query Optimization took 3.7469863891601562 ms
2022-09-21 18:55:28 INFO  Executing generated plans
2022-09-21 18:56:03 INFO  ---RUNTIME: Execution took 35827.20613479614 ms
2022-09-21 18:56:03 INFO  Done!
2022-09-21 18:56:03 INFO  # Finished -- repetition 6 of 7 
2022-09-21 18:56:03 INFO  # Optimization benchmark for feature_importance with args [['reviews', 'slow_loading', 'featurization_0', 'xgboost']] -- repetition 7 of 7
2022-09-21 18:56:03 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-21 18:56:03 INFO  Running instrumented original pipeline...
2022-09-21 18:56:04 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-21 18:56:04 INFO  ---RUNTIME: Importing and monkey-patching took 5.917549133300781 ms
2022-09-21 18:56:11 INFO  ---RUNTIME: Original pipeline execution took 7829.3821811676025 ms (excluding imports and monkey-patching)
2022-09-21 18:56:11 INFO  Starting execution of 1 what-if analyses...
2022-09-21 18:56:11 INFO  Start plan generation for analysis PermutationFeatureImportance...
2022-09-21 18:56:11 INFO  ---RUNTIME: Plan generation took 0.1609325408935547 ms
2022-09-21 18:56:11 INFO  Estimated runtime of original DAG is 6163.6505126953125ms
2022-09-21 18:56:11 INFO  Performing Multi-Query Optimization
2022-09-21 18:56:11 INFO  Estimated unoptimized what-if runtime is 30818.252563476562ms
2022-09-21 18:56:11 INFO  Estimated optimised what-if runtime is 7691.5602684021ms
2022-09-21 18:56:11 INFO  Estimated optimisation runtime saving is 23126.692295074463ms
2022-09-21 18:56:11 INFO  ---RUNTIME: Multi-Query Optimization took 9.61160659790039 ms
2022-09-21 18:56:11 INFO  Executing generated plans
2022-09-21 18:56:20 INFO  ---RUNTIME: Execution took 8312.198638916016 ms
2022-09-21 18:56:20 INFO  Done!
2022-09-21 18:56:20 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-21 18:56:20 INFO  Running instrumented original pipeline...
2022-09-21 18:56:20 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-21 18:56:20 INFO  ---RUNTIME: Importing and monkey-patching took 5.9375762939453125 ms
2022-09-21 18:56:27 INFO  ---RUNTIME: Original pipeline execution took 7720.741510391235 ms (excluding imports and monkey-patching)
2022-09-21 18:56:27 INFO  Starting execution of 1 what-if analyses...
2022-09-21 18:56:27 INFO  Start plan generation for analysis PermutationFeatureImportance...
2022-09-21 18:56:27 INFO  ---RUNTIME: Plan generation took 0.10943412780761719 ms
2022-09-21 18:56:27 INFO  Estimated runtime of original DAG is 6039.407968521118ms
2022-09-21 18:56:27 WARNING Skipping Multi-Query Optimization (instead, only applying patches)
2022-09-21 18:56:27 INFO  Estimated unoptimised what-if runtime is 30197.03984260559ms
2022-09-21 18:56:27 INFO  ---RUNTIME: Multi-Query Optimization took 3.683805465698242 ms
2022-09-21 18:56:27 INFO  Executing generated plans
2022-09-21 18:57:03 INFO  ---RUNTIME: Execution took 35794.145822525024 ms
2022-09-21 18:57:03 INFO  Done!
2022-09-21 18:57:03 INFO  # Finished -- repetition 7 of 7 
2022-09-21 18:57:03 INFO  # Final results after all repetitions
2022-09-21 18:57:03 INFO     repetition  ... no_opt_what_if_execution_combined_model_training
0           0  ...                                      3736.527443
1           1  ...                                      3737.190247
2           2  ...                                      3708.714247
3           3  ...                                      3724.661589
4           4  ...                                      3755.835772
5           5  ...                                      3774.916172
6           6  ...                                      4633.338451

[7 rows x 26 columns]
taskset -c 32-39 PROTOCOL_BUFFERS_PYTHON_IMPLEMENTATION=python python3.9 benchmarks_end_to_end.py feature_importance reviews slow_loading featurization_0 neural_network
2022-09-21 18:57:05.876508: W tensorflow/stream_executor/platform/default/dso_loader.cc:64] Could not load dynamic library 'libcudart.so.11.0'; dlerror: libcudart.so.11.0: cannot open shared object file: No such file or directory; LD_LIBRARY_PATH: /home/sgrafbe/mlwhatif/venv/lib/python3.9/site-packages/cv2/../../lib64:
2022-09-21 18:57:05.876554: I tensorflow/stream_executor/cuda/cudart_stub.cc:29] Ignore above cudart dlerror if you do not have a GPU set up on your machine.
2022-09-21 18:57:07 INFO  Patching sys.argv with ['mlwhatif', 'reviews', 'slow_loading', 'featurization_0', 'neural_network']
2022-09-21 18:57:07 INFO  Running instrumented original pipeline...
2022-09-21 18:57:07 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-21 18:57:07 INFO  ---RUNTIME: Importing and monkey-patching took 101.38392448425293 ms
2022-09-21 18:57:12.787273: W tensorflow/stream_executor/platform/default/dso_loader.cc:64] Could not load dynamic library 'libcuda.so.1'; dlerror: libcuda.so.1: cannot open shared object file: No such file or directory; LD_LIBRARY_PATH: /home/sgrafbe/mlwhatif/venv/lib/python3.9/site-packages/cv2/../../lib64:
2022-09-21 18:57:12.787314: W tensorflow/stream_executor/cuda/cuda_driver.cc:326] failed call to cuInit: UNKNOWN ERROR (303)
2022-09-21 18:57:12.787339: I tensorflow/stream_executor/cuda/cuda_diagnostics.cc:156] kernel driver does not appear to be running on this host (wagyu): /proc/driver/nvidia/version does not exist
2022-09-21 18:57:12.787832: I tensorflow/core/platform/cpu_feature_guard.cc:142] This TensorFlow binary is optimized with oneAPI Deep Neural Network Library (oneDNN) to use the following CPU instructions in performance-critical operations:  AVX2 FMA
To enable them in other operations, rebuild TensorFlow with the appropriate compiler flags.
2022-09-21 18:57:12.858383: I tensorflow/compiler/mlir/mlir_graph_optimization_pass.cc:176] None of the MLIR Optimization Passes are enabled (registered 2)
2022-09-21 18:57:12.870378: I tensorflow/core/platform/profile_utils/cpu_utils.cc:114] CPU Frequency: 2595290000 Hz
2022-09-21 18:57:18 INFO  ---RUNTIME: Original pipeline execution took 10799.994468688965 ms (excluding imports and monkey-patching)
2022-09-21 18:57:18 INFO  Starting execution of 0 what-if analyses...
2022-09-21 18:57:18 INFO  Estimated runtime of original DAG is 9162.289381027222ms
2022-09-21 18:57:18 INFO  Performing Multi-Query Optimization
2022-09-21 18:57:18 INFO  Estimated unoptimized what-if runtime is 0ms
2022-09-21 18:57:18 INFO  Estimated optimised what-if runtime is 0ms
2022-09-21 18:57:18 INFO  Estimated optimisation runtime saving is 0ms
2022-09-21 18:57:18 INFO  ---RUNTIME: Multi-Query Optimization took 0.5109310150146484 ms
2022-09-21 18:57:18 INFO  Executing generated plans
2022-09-21 18:57:18 INFO  ---RUNTIME: Execution took 0.027894973754882812 ms
2022-09-21 18:57:18 INFO  Done!
2022-09-21 18:57:18 INFO  # Optimization benchmark for feature_importance with args [['reviews', 'slow_loading', 'featurization_0', 'neural_network']] -- repetition 1 of 7
2022-09-21 18:57:18 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-21 18:57:18 INFO  Running instrumented original pipeline...
2022-09-21 18:57:18 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-21 18:57:18 INFO  ---RUNTIME: Importing and monkey-patching took 5.969524383544922 ms
2022-09-21 18:57:28 INFO  ---RUNTIME: Original pipeline execution took 10589.87045288086 ms (excluding imports and monkey-patching)
2022-09-21 18:57:28 INFO  Starting execution of 1 what-if analyses...
2022-09-21 18:57:28 INFO  Start plan generation for analysis PermutationFeatureImportance...
2022-09-21 18:57:28 INFO  ---RUNTIME: Plan generation took 0.1983642578125 ms
2022-09-21 18:57:28 INFO  Estimated runtime of original DAG is 9000.093221664429ms
2022-09-21 18:57:28 INFO  Performing Multi-Query Optimization
2022-09-21 18:57:28 INFO  Estimated unoptimized what-if runtime is 45000.46610832214ms
2022-09-21 18:57:28 INFO  Estimated optimised what-if runtime is 12096.891164779663ms
2022-09-21 18:57:28 INFO  Estimated optimisation runtime saving is 32903.57494354248ms
2022-09-21 18:57:28 INFO  ---RUNTIME: Multi-Query Optimization took 10.289669036865234 ms
2022-09-21 18:57:28 INFO  Executing generated plans
2022-09-21 18:57:41 INFO  ---RUNTIME: Execution took 12840.169668197632 ms
2022-09-21 18:57:41 INFO  Done!
2022-09-21 18:57:41 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-21 18:57:41 INFO  Running instrumented original pipeline...
2022-09-21 18:57:41 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-21 18:57:41 INFO  ---RUNTIME: Importing and monkey-patching took 6.056785583496094 ms
2022-09-21 18:57:52 INFO  ---RUNTIME: Original pipeline execution took 10949.48697090149 ms (excluding imports and monkey-patching)
2022-09-21 18:57:52 INFO  Starting execution of 1 what-if analyses...
2022-09-21 18:57:52 INFO  Start plan generation for analysis PermutationFeatureImportance...
2022-09-21 18:57:52 INFO  ---RUNTIME: Plan generation took 0.09393692016601562 ms
2022-09-21 18:57:52 INFO  Estimated runtime of original DAG is 9351.296186447144ms
2022-09-21 18:57:52 WARNING Skipping Multi-Query Optimization (instead, only applying patches)
2022-09-21 18:57:52 INFO  Estimated unoptimised what-if runtime is 46756.48093223572ms
2022-09-21 18:57:52 INFO  ---RUNTIME: Multi-Query Optimization took 3.5016536712646484 ms
2022-09-21 18:57:52 INFO  Executing generated plans
2022-09-21 18:58:41 INFO  ---RUNTIME: Execution took 48733.22010040283 ms
2022-09-21 18:58:41 INFO  Done!
2022-09-21 18:58:41 INFO  # Finished -- repetition 1 of 7 
2022-09-21 18:58:41 INFO  # Optimization benchmark for feature_importance with args [['reviews', 'slow_loading', 'featurization_0', 'neural_network']] -- repetition 2 of 7
2022-09-21 18:58:41 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-21 18:58:41 INFO  Running instrumented original pipeline...
2022-09-21 18:58:41 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-21 18:58:41 INFO  ---RUNTIME: Importing and monkey-patching took 6.0214996337890625 ms
2022-09-21 18:58:52 INFO  ---RUNTIME: Original pipeline execution took 11021.517515182495 ms (excluding imports and monkey-patching)
2022-09-21 18:58:52 INFO  Starting execution of 1 what-if analyses...
2022-09-21 18:58:52 INFO  Start plan generation for analysis PermutationFeatureImportance...
2022-09-21 18:58:52 INFO  ---RUNTIME: Plan generation took 0.11563301086425781 ms
2022-09-21 18:58:52 INFO  Estimated runtime of original DAG is 9428.656816482544ms
2022-09-21 18:58:52 INFO  Performing Multi-Query Optimization
2022-09-21 18:58:52 INFO  Estimated unoptimized what-if runtime is 47143.28408241272ms
2022-09-21 18:58:52 INFO  Estimated optimised what-if runtime is 12328.342914581299ms
2022-09-21 18:58:52 INFO  Estimated optimisation runtime saving is 34814.94116783142ms
2022-09-21 18:58:52 INFO  ---RUNTIME: Multi-Query Optimization took 9.120941162109375 ms
2022-09-21 18:58:52 INFO  Executing generated plans
2022-09-21 18:59:04 INFO  ---RUNTIME: Execution took 12558.930397033691 ms
2022-09-21 18:59:04 INFO  Done!
2022-09-21 18:59:04 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-21 18:59:04 INFO  Running instrumented original pipeline...
2022-09-21 18:59:04 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-21 18:59:04 INFO  ---RUNTIME: Importing and monkey-patching took 6.252050399780273 ms
2022-09-21 18:59:15 INFO  ---RUNTIME: Original pipeline execution took 10879.747152328491 ms (excluding imports and monkey-patching)
2022-09-21 18:59:15 INFO  Starting execution of 1 what-if analyses...
2022-09-21 18:59:15 INFO  Start plan generation for analysis PermutationFeatureImportance...
2022-09-21 18:59:15 INFO  ---RUNTIME: Plan generation took 0.12421607971191406 ms
2022-09-21 18:59:15 INFO  Estimated runtime of original DAG is 9210.881233215332ms
2022-09-21 18:59:15 WARNING Skipping Multi-Query Optimization (instead, only applying patches)
2022-09-21 18:59:15 INFO  Estimated unoptimised what-if runtime is 46054.40616607666ms
2022-09-21 18:59:15 INFO  ---RUNTIME: Multi-Query Optimization took 3.6280155181884766 ms
2022-09-21 18:59:15 INFO  Executing generated plans
2022-09-21 19:00:06 INFO  ---RUNTIME: Execution took 50766.106605529785 ms
2022-09-21 19:00:06 INFO  Done!
2022-09-21 19:00:06 INFO  # Finished -- repetition 2 of 7 
2022-09-21 19:00:06 INFO  # Optimization benchmark for feature_importance with args [['reviews', 'slow_loading', 'featurization_0', 'neural_network']] -- repetition 3 of 7
2022-09-21 19:00:06 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-21 19:00:06 INFO  Running instrumented original pipeline...
2022-09-21 19:00:06 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-21 19:00:06 INFO  ---RUNTIME: Importing and monkey-patching took 6.167411804199219 ms
2022-09-21 19:00:17 INFO  ---RUNTIME: Original pipeline execution took 10585.490226745605 ms (excluding imports and monkey-patching)
2022-09-21 19:00:17 INFO  Starting execution of 1 what-if analyses...
2022-09-21 19:00:17 INFO  Start plan generation for analysis PermutationFeatureImportance...
2022-09-21 19:00:17 INFO  ---RUNTIME: Plan generation took 0.11110305786132812 ms
2022-09-21 19:00:17 INFO  Estimated runtime of original DAG is 8941.065311431885ms
2022-09-21 19:00:17 INFO  Performing Multi-Query Optimization
2022-09-21 19:00:17 INFO  Estimated unoptimized what-if runtime is 44705.326557159424ms
2022-09-21 19:00:17 INFO  Estimated optimised what-if runtime is 12086.281061172485ms
2022-09-21 19:00:17 INFO  Estimated optimisation runtime saving is 32619.04549598694ms
2022-09-21 19:00:17 INFO  ---RUNTIME: Multi-Query Optimization took 10.080337524414062 ms
2022-09-21 19:00:17 INFO  Executing generated plans
2022-09-21 19:00:29 INFO  ---RUNTIME: Execution took 12877.196788787842 ms
2022-09-21 19:00:29 INFO  Done!
2022-09-21 19:00:29 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-21 19:00:29 INFO  Running instrumented original pipeline...
2022-09-21 19:00:29 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-21 19:00:29 INFO  ---RUNTIME: Importing and monkey-patching took 5.972385406494141 ms
2022-09-21 19:00:40 INFO  ---RUNTIME: Original pipeline execution took 10767.078399658203 ms (excluding imports and monkey-patching)
2022-09-21 19:00:40 INFO  Starting execution of 1 what-if analyses...
2022-09-21 19:00:40 INFO  Start plan generation for analysis PermutationFeatureImportance...
2022-09-21 19:00:40 INFO  ---RUNTIME: Plan generation took 0.118255615234375 ms
2022-09-21 19:00:40 INFO  Estimated runtime of original DAG is 9154.389381408691ms
2022-09-21 19:00:40 WARNING Skipping Multi-Query Optimization (instead, only applying patches)
2022-09-21 19:00:40 INFO  Estimated unoptimised what-if runtime is 45771.94690704346ms
2022-09-21 19:00:40 INFO  ---RUNTIME: Multi-Query Optimization took 3.5986900329589844 ms
2022-09-21 19:00:40 INFO  Executing generated plans
2022-09-21 19:01:30 INFO  ---RUNTIME: Execution took 49472.050189971924 ms
2022-09-21 19:01:30 INFO  Done!
2022-09-21 19:01:30 INFO  # Finished -- repetition 3 of 7 
2022-09-21 19:01:30 INFO  # Optimization benchmark for feature_importance with args [['reviews', 'slow_loading', 'featurization_0', 'neural_network']] -- repetition 4 of 7
2022-09-21 19:01:30 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-21 19:01:30 INFO  Running instrumented original pipeline...
2022-09-21 19:01:30 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-21 19:01:30 INFO  ---RUNTIME: Importing and monkey-patching took 6.206512451171875 ms
2022-09-21 19:01:40 INFO  ---RUNTIME: Original pipeline execution took 10668.029069900513 ms (excluding imports and monkey-patching)
2022-09-21 19:01:40 INFO  Starting execution of 1 what-if analyses...
2022-09-21 19:01:40 INFO  Start plan generation for analysis PermutationFeatureImportance...
2022-09-21 19:01:40 INFO  ---RUNTIME: Plan generation took 0.13446807861328125 ms
2022-09-21 19:01:40 INFO  Estimated runtime of original DAG is 8954.247951507568ms
2022-09-21 19:01:40 INFO  Performing Multi-Query Optimization
2022-09-21 19:01:40 INFO  Estimated unoptimized what-if runtime is 44771.23975753784ms
2022-09-21 19:01:40 INFO  Estimated optimised what-if runtime is 11794.402599334717ms
2022-09-21 19:01:40 INFO  Estimated optimisation runtime saving is 32976.837158203125ms
2022-09-21 19:01:40 INFO  ---RUNTIME: Multi-Query Optimization took 9.218692779541016 ms
2022-09-21 19:01:40 INFO  Executing generated plans
2022-09-21 19:01:53 INFO  ---RUNTIME: Execution took 12957.843542098999 ms
2022-09-21 19:01:53 INFO  Done!
2022-09-21 19:01:53 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-21 19:01:53 INFO  Running instrumented original pipeline...
2022-09-21 19:01:53 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-21 19:01:53 INFO  ---RUNTIME: Importing and monkey-patching took 6.231546401977539 ms
2022-09-21 19:02:04 INFO  ---RUNTIME: Original pipeline execution took 11095.118045806885 ms (excluding imports and monkey-patching)
2022-09-21 19:02:04 INFO  Starting execution of 1 what-if analyses...
2022-09-21 19:02:04 INFO  Start plan generation for analysis PermutationFeatureImportance...
2022-09-21 19:02:04 INFO  ---RUNTIME: Plan generation took 0.13446807861328125 ms
2022-09-21 19:02:04 INFO  Estimated runtime of original DAG is 9433.766603469849ms
2022-09-21 19:02:04 WARNING Skipping Multi-Query Optimization (instead, only applying patches)
2022-09-21 19:02:04 INFO  Estimated unoptimised what-if runtime is 47168.83301734924ms
2022-09-21 19:02:04 INFO  ---RUNTIME: Multi-Query Optimization took 4.05573844909668 ms
2022-09-21 19:02:04 INFO  Executing generated plans
2022-09-21 19:02:55 INFO  ---RUNTIME: Execution took 50200.89149475098 ms
2022-09-21 19:02:55 INFO  Done!
2022-09-21 19:02:55 INFO  # Finished -- repetition 4 of 7 
2022-09-21 19:02:55 INFO  # Optimization benchmark for feature_importance with args [['reviews', 'slow_loading', 'featurization_0', 'neural_network']] -- repetition 5 of 7
2022-09-21 19:02:55 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-21 19:02:55 INFO  Running instrumented original pipeline...
2022-09-21 19:02:55 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-21 19:02:55 INFO  ---RUNTIME: Importing and monkey-patching took 6.833553314208984 ms
2022-09-21 19:03:06 INFO  ---RUNTIME: Original pipeline execution took 11100.695133209229 ms (excluding imports and monkey-patching)
2022-09-21 19:03:06 INFO  Starting execution of 1 what-if analyses...
2022-09-21 19:03:06 INFO  Start plan generation for analysis PermutationFeatureImportance...
2022-09-21 19:03:06 INFO  ---RUNTIME: Plan generation took 0.12493133544921875 ms
2022-09-21 19:03:06 INFO  Estimated runtime of original DAG is 9442.462921142578ms
2022-09-21 19:03:06 INFO  Performing Multi-Query Optimization
2022-09-21 19:03:06 INFO  Estimated unoptimized what-if runtime is 47212.31460571289ms
2022-09-21 19:03:06 INFO  Estimated optimised what-if runtime is 12320.85394859314ms
2022-09-21 19:03:06 INFO  Estimated optimisation runtime saving is 34891.46065711975ms
2022-09-21 19:03:06 INFO  ---RUNTIME: Multi-Query Optimization took 11.580228805541992 ms
2022-09-21 19:03:06 INFO  Executing generated plans
2022-09-21 19:03:18 INFO  ---RUNTIME: Execution took 12540.289640426636 ms
2022-09-21 19:03:18 INFO  Done!
2022-09-21 19:03:18 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-21 19:03:18 INFO  Running instrumented original pipeline...
2022-09-21 19:03:18 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-21 19:03:18 INFO  ---RUNTIME: Importing and monkey-patching took 6.114482879638672 ms
2022-09-21 19:03:29 INFO  ---RUNTIME: Original pipeline execution took 10869.603633880615 ms (excluding imports and monkey-patching)
2022-09-21 19:03:29 INFO  Starting execution of 1 what-if analyses...
2022-09-21 19:03:29 INFO  Start plan generation for analysis PermutationFeatureImportance...
2022-09-21 19:03:29 INFO  ---RUNTIME: Plan generation took 0.10776519775390625 ms
2022-09-21 19:03:29 INFO  Estimated runtime of original DAG is 9151.832342147827ms
2022-09-21 19:03:29 WARNING Skipping Multi-Query Optimization (instead, only applying patches)
2022-09-21 19:03:29 INFO  Estimated unoptimised what-if runtime is 45759.161710739136ms
2022-09-21 19:03:29 INFO  ---RUNTIME: Multi-Query Optimization took 3.8480758666992188 ms
2022-09-21 19:03:29 INFO  Executing generated plans
2022-09-21 19:04:19 INFO  ---RUNTIME: Execution took 50245.023012161255 ms
2022-09-21 19:04:19 INFO  Done!
2022-09-21 19:04:19 INFO  # Finished -- repetition 5 of 7 
2022-09-21 19:04:19 INFO  # Optimization benchmark for feature_importance with args [['reviews', 'slow_loading', 'featurization_0', 'neural_network']] -- repetition 6 of 7
2022-09-21 19:04:19 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-21 19:04:19 INFO  Running instrumented original pipeline...
2022-09-21 19:04:19 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-21 19:04:20 INFO  ---RUNTIME: Importing and monkey-patching took 6.805896759033203 ms
2022-09-21 19:04:30 INFO  ---RUNTIME: Original pipeline execution took 10535.50410270691 ms (excluding imports and monkey-patching)
2022-09-21 19:04:30 INFO  Starting execution of 1 what-if analyses...
2022-09-21 19:04:30 INFO  Start plan generation for analysis PermutationFeatureImportance...
2022-09-21 19:04:30 INFO  ---RUNTIME: Plan generation took 0.1304149627685547 ms
2022-09-21 19:04:30 INFO  Estimated runtime of original DAG is 8875.33950805664ms
2022-09-21 19:04:30 INFO  Performing Multi-Query Optimization
2022-09-21 19:04:30 INFO  Estimated unoptimized what-if runtime is 44376.6975402832ms
2022-09-21 19:04:30 INFO  Estimated optimised what-if runtime is 11725.095510482788ms
2022-09-21 19:04:30 INFO  Estimated optimisation runtime saving is 32651.602029800415ms
2022-09-21 19:04:30 INFO  ---RUNTIME: Multi-Query Optimization took 9.148836135864258 ms
2022-09-21 19:04:30 INFO  Executing generated plans
2022-09-21 19:04:43 INFO  ---RUNTIME: Execution took 12981.952905654907 ms
2022-09-21 19:04:43 INFO  Done!
2022-09-21 19:04:43 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-21 19:04:43 INFO  Running instrumented original pipeline...
2022-09-21 19:04:43 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-21 19:04:43 INFO  ---RUNTIME: Importing and monkey-patching took 5.800962448120117 ms
2022-09-21 19:04:54 INFO  ---RUNTIME: Original pipeline execution took 10645.979166030884 ms (excluding imports and monkey-patching)
2022-09-21 19:04:54 INFO  Starting execution of 1 what-if analyses...
2022-09-21 19:04:54 INFO  Start plan generation for analysis PermutationFeatureImportance...
2022-09-21 19:04:54 INFO  ---RUNTIME: Plan generation took 0.09846687316894531 ms
2022-09-21 19:04:54 INFO  Estimated runtime of original DAG is 8923.101663589478ms
2022-09-21 19:04:54 WARNING Skipping Multi-Query Optimization (instead, only applying patches)
2022-09-21 19:04:54 INFO  Estimated unoptimised what-if runtime is 44615.50831794739ms
2022-09-21 19:04:54 INFO  ---RUNTIME: Multi-Query Optimization took 3.5474300384521484 ms
2022-09-21 19:04:54 INFO  Executing generated plans
2022-09-21 19:05:43 INFO  ---RUNTIME: Execution took 49170.75181007385 ms
2022-09-21 19:05:43 INFO  Done!
2022-09-21 19:05:43 INFO  # Finished -- repetition 6 of 7 
2022-09-21 19:05:43 INFO  # Optimization benchmark for feature_importance with args [['reviews', 'slow_loading', 'featurization_0', 'neural_network']] -- repetition 7 of 7
2022-09-21 19:05:43 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-21 19:05:43 INFO  Running instrumented original pipeline...
2022-09-21 19:05:43 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-21 19:05:43 INFO  ---RUNTIME: Importing and monkey-patching took 6.238698959350586 ms
2022-09-21 19:05:53 INFO  ---RUNTIME: Original pipeline execution took 10374.980449676514 ms (excluding imports and monkey-patching)
2022-09-21 19:05:53 INFO  Starting execution of 1 what-if analyses...
2022-09-21 19:05:53 INFO  Start plan generation for analysis PermutationFeatureImportance...
2022-09-21 19:05:53 INFO  ---RUNTIME: Plan generation took 0.1437664031982422 ms
2022-09-21 19:05:53 INFO  Estimated runtime of original DAG is 8738.516569137573ms
2022-09-21 19:05:53 INFO  Performing Multi-Query Optimization
2022-09-21 19:05:53 INFO  Estimated unoptimized what-if runtime is 43692.582845687866ms
2022-09-21 19:05:53 INFO  Estimated optimised what-if runtime is 11566.732406616211ms
2022-09-21 19:05:53 INFO  Estimated optimisation runtime saving is 32125.850439071655ms
2022-09-21 19:05:53 INFO  ---RUNTIME: Multi-Query Optimization took 9.083032608032227 ms
2022-09-21 19:05:53 INFO  Executing generated plans
2022-09-21 19:06:05 INFO  ---RUNTIME: Execution took 12274.01328086853 ms
2022-09-21 19:06:05 INFO  Done!
2022-09-21 19:06:05 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-21 19:06:05 INFO  Running instrumented original pipeline...
2022-09-21 19:06:06 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-21 19:06:06 INFO  ---RUNTIME: Importing and monkey-patching took 5.838632583618164 ms
2022-09-21 19:06:16 INFO  ---RUNTIME: Original pipeline execution took 10895.935535430908 ms (excluding imports and monkey-patching)
2022-09-21 19:06:16 INFO  Starting execution of 1 what-if analyses...
2022-09-21 19:06:16 INFO  Start plan generation for analysis PermutationFeatureImportance...
2022-09-21 19:06:16 INFO  ---RUNTIME: Plan generation took 0.1087188720703125 ms
2022-09-21 19:06:16 INFO  Estimated runtime of original DAG is 8778.797626495361ms
2022-09-21 19:06:16 WARNING Skipping Multi-Query Optimization (instead, only applying patches)
2022-09-21 19:06:16 INFO  Estimated unoptimised what-if runtime is 43893.98813247681ms
2022-09-21 19:06:16 INFO  ---RUNTIME: Multi-Query Optimization took 4.218578338623047 ms
2022-09-21 19:06:16 INFO  Executing generated plans
2022-09-21 19:07:05 INFO  ---RUNTIME: Execution took 48460.7720375061 ms
2022-09-21 19:07:05 INFO  Done!
2022-09-21 19:07:05 INFO  # Finished -- repetition 7 of 7 
2022-09-21 19:07:05 INFO  # Final results after all repetitions
2022-09-21 19:07:05 INFO     repetition  ... no_opt_what_if_execution_combined_model_training
0           0  ...                                     16171.993732
1           1  ...                                     17812.414408
2           2  ...                                     15861.322165
3           3  ...                                     17446.171761
4           4  ...                                     16618.889093
5           5  ...                                     16234.777451
6           6  ...                                     15682.168961

[7 rows x 26 columns]
taskset -c 32-39 PROTOCOL_BUFFERS_PYTHON_IMPLEMENTATION=python python3.9 benchmarks_end_to_end.py feature_importance reviews slow_loading featurization_1 logistic_regression
2022-09-21 19:07:07.635215: W tensorflow/stream_executor/platform/default/dso_loader.cc:64] Could not load dynamic library 'libcudart.so.11.0'; dlerror: libcudart.so.11.0: cannot open shared object file: No such file or directory; LD_LIBRARY_PATH: /home/sgrafbe/mlwhatif/venv/lib/python3.9/site-packages/cv2/../../lib64:
2022-09-21 19:07:07.635259: I tensorflow/stream_executor/cuda/cudart_stub.cc:29] Ignore above cudart dlerror if you do not have a GPU set up on your machine.
2022-09-21 19:07:08 INFO  Patching sys.argv with ['mlwhatif', 'reviews', 'slow_loading', 'featurization_1', 'logistic_regression']
2022-09-21 19:07:08 INFO  Running instrumented original pipeline...
2022-09-21 19:07:08 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-21 19:07:08 INFO  ---RUNTIME: Importing and monkey-patching took 95.21126747131348 ms
2022-09-21 19:07:16 INFO  ---RUNTIME: Original pipeline execution took 7900.924205780029 ms (excluding imports and monkey-patching)
2022-09-21 19:07:16 INFO  Starting execution of 0 what-if analyses...
2022-09-21 19:07:16 INFO  Estimated runtime of original DAG is 5634.963274002075ms
2022-09-21 19:07:16 INFO  Performing Multi-Query Optimization
2022-09-21 19:07:16 INFO  Estimated unoptimized what-if runtime is 0ms
2022-09-21 19:07:16 INFO  Estimated optimised what-if runtime is 0ms
2022-09-21 19:07:16 INFO  Estimated optimisation runtime saving is 0ms
2022-09-21 19:07:16 INFO  ---RUNTIME: Multi-Query Optimization took 0.5109310150146484 ms
2022-09-21 19:07:16 INFO  Executing generated plans
2022-09-21 19:07:16 INFO  ---RUNTIME: Execution took 0.025272369384765625 ms
2022-09-21 19:07:16 INFO  Done!
2022-09-21 19:07:16 INFO  # Optimization benchmark for feature_importance with args [['reviews', 'slow_loading', 'featurization_1', 'logistic_regression']] -- repetition 1 of 7
2022-09-21 19:07:16 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-21 19:07:16 INFO  Running instrumented original pipeline...
2022-09-21 19:07:16 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-21 19:07:16 INFO  ---RUNTIME: Importing and monkey-patching took 5.487680435180664 ms
2022-09-21 19:07:24 INFO  ---RUNTIME: Original pipeline execution took 7653.958320617676 ms (excluding imports and monkey-patching)
2022-09-21 19:07:24 INFO  Starting execution of 1 what-if analyses...
2022-09-21 19:07:24 INFO  Start plan generation for analysis PermutationFeatureImportance...
2022-09-21 19:07:24 INFO  ---RUNTIME: Plan generation took 0.33164024353027344 ms
2022-09-21 19:07:24 INFO  Estimated runtime of original DAG is 5399.784088134766ms
2022-09-21 19:07:24 INFO  Performing Multi-Query Optimization
2022-09-21 19:07:24 INFO  Estimated unoptimized what-if runtime is 26998.920440673828ms
2022-09-21 19:07:24 INFO  Estimated optimised what-if runtime is 6757.1423053741455ms
2022-09-21 19:07:24 INFO  Estimated optimisation runtime saving is 20241.778135299683ms
2022-09-21 19:07:24 INFO  ---RUNTIME: Multi-Query Optimization took 20.892620086669922 ms
2022-09-21 19:07:24 INFO  Executing generated plans
2022-09-21 19:07:32 INFO  ---RUNTIME: Execution took 7532.8168869018555 ms
2022-09-21 19:07:32 INFO  Done!
2022-09-21 19:07:32 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-21 19:07:32 INFO  Running instrumented original pipeline...
2022-09-21 19:07:32 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-21 19:07:32 INFO  ---RUNTIME: Importing and monkey-patching took 6.608247756958008 ms
2022-09-21 19:07:39 INFO  ---RUNTIME: Original pipeline execution took 7846.158981323242 ms (excluding imports and monkey-patching)
2022-09-21 19:07:39 INFO  Starting execution of 1 what-if analyses...
2022-09-21 19:07:39 INFO  Start plan generation for analysis PermutationFeatureImportance...
2022-09-21 19:07:39 INFO  ---RUNTIME: Plan generation took 0.26106834411621094 ms
2022-09-21 19:07:39 INFO  Estimated runtime of original DAG is 5473.865270614624ms
2022-09-21 19:07:39 WARNING Skipping Multi-Query Optimization (instead, only applying patches)
2022-09-21 19:07:39 INFO  Estimated unoptimised what-if runtime is 27369.32635307312ms
2022-09-21 19:07:39 INFO  ---RUNTIME: Multi-Query Optimization took 3.9577484130859375 ms
2022-09-21 19:07:39 INFO  Executing generated plans
2022-09-21 19:08:10 INFO  ---RUNTIME: Execution took 31006.486415863037 ms
2022-09-21 19:08:10 INFO  Done!
2022-09-21 19:08:10 INFO  # Finished -- repetition 1 of 7 
2022-09-21 19:08:10 INFO  # Optimization benchmark for feature_importance with args [['reviews', 'slow_loading', 'featurization_1', 'logistic_regression']] -- repetition 2 of 7
2022-09-21 19:08:10 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-21 19:08:10 INFO  Running instrumented original pipeline...
2022-09-21 19:08:11 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-21 19:08:11 INFO  ---RUNTIME: Importing and monkey-patching took 6.066799163818359 ms
2022-09-21 19:08:18 INFO  ---RUNTIME: Original pipeline execution took 7756.681442260742 ms (excluding imports and monkey-patching)
2022-09-21 19:08:18 INFO  Starting execution of 1 what-if analyses...
2022-09-21 19:08:18 INFO  Start plan generation for analysis PermutationFeatureImportance...
2022-09-21 19:08:18 INFO  ---RUNTIME: Plan generation took 0.25963783264160156 ms
2022-09-21 19:08:18 INFO  Estimated runtime of original DAG is 5498.297691345215ms
2022-09-21 19:08:18 INFO  Performing Multi-Query Optimization
2022-09-21 19:08:18 INFO  Estimated unoptimized what-if runtime is 27491.488456726074ms
2022-09-21 19:08:18 INFO  Estimated optimised what-if runtime is 6862.807989120483ms
2022-09-21 19:08:18 INFO  Estimated optimisation runtime saving is 20628.68046760559ms
2022-09-21 19:08:18 INFO  ---RUNTIME: Multi-Query Optimization took 10.663747787475586 ms
2022-09-21 19:08:18 INFO  Executing generated plans
2022-09-21 19:08:26 INFO  ---RUNTIME: Execution took 7566.4379596710205 ms
2022-09-21 19:08:26 INFO  Done!
2022-09-21 19:08:26 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-21 19:08:26 INFO  Running instrumented original pipeline...
2022-09-21 19:08:26 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-21 19:08:26 INFO  ---RUNTIME: Importing and monkey-patching took 5.8803558349609375 ms
2022-09-21 19:08:33 INFO  ---RUNTIME: Original pipeline execution took 7571.778297424316 ms (excluding imports and monkey-patching)
2022-09-21 19:08:33 INFO  Starting execution of 1 what-if analyses...
2022-09-21 19:08:33 INFO  Start plan generation for analysis PermutationFeatureImportance...
2022-09-21 19:08:33 INFO  ---RUNTIME: Plan generation took 0.26345252990722656 ms
2022-09-21 19:08:33 INFO  Estimated runtime of original DAG is 5322.673320770264ms
2022-09-21 19:08:33 WARNING Skipping Multi-Query Optimization (instead, only applying patches)
2022-09-21 19:08:33 INFO  Estimated unoptimised what-if runtime is 26613.36660385132ms
2022-09-21 19:08:33 INFO  ---RUNTIME: Multi-Query Optimization took 3.9887428283691406 ms
2022-09-21 19:08:33 INFO  Executing generated plans
2022-09-21 19:09:05 INFO  ---RUNTIME: Execution took 31377.93278694153 ms
2022-09-21 19:09:05 INFO  Done!
2022-09-21 19:09:05 INFO  # Finished -- repetition 2 of 7 
2022-09-21 19:09:05 INFO  # Optimization benchmark for feature_importance with args [['reviews', 'slow_loading', 'featurization_1', 'logistic_regression']] -- repetition 3 of 7
2022-09-21 19:09:05 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-21 19:09:05 INFO  Running instrumented original pipeline...
2022-09-21 19:09:05 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-21 19:09:05 INFO  ---RUNTIME: Importing and monkey-patching took 16.180753707885742 ms
2022-09-21 19:09:12 INFO  ---RUNTIME: Original pipeline execution took 7583.47487449646 ms (excluding imports and monkey-patching)
2022-09-21 19:09:12 INFO  Starting execution of 1 what-if analyses...
2022-09-21 19:09:12 INFO  Start plan generation for analysis PermutationFeatureImportance...
2022-09-21 19:09:12 INFO  ---RUNTIME: Plan generation took 0.2300739288330078 ms
2022-09-21 19:09:12 INFO  Estimated runtime of original DAG is 5330.110788345337ms
2022-09-21 19:09:12 INFO  Performing Multi-Query Optimization
2022-09-21 19:09:12 INFO  Estimated unoptimized what-if runtime is 26650.553941726685ms
2022-09-21 19:09:12 INFO  Estimated optimised what-if runtime is 6693.164110183716ms
2022-09-21 19:09:12 INFO  Estimated optimisation runtime saving is 19957.38983154297ms
2022-09-21 19:09:12 INFO  ---RUNTIME: Multi-Query Optimization took 20.038604736328125 ms
2022-09-21 19:09:12 INFO  Executing generated plans
2022-09-21 19:09:20 INFO  ---RUNTIME: Execution took 7562.894582748413 ms
2022-09-21 19:09:20 INFO  Done!
2022-09-21 19:09:20 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-21 19:09:20 INFO  Running instrumented original pipeline...
2022-09-21 19:09:20 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-21 19:09:20 INFO  ---RUNTIME: Importing and monkey-patching took 5.707263946533203 ms
2022-09-21 19:09:28 INFO  ---RUNTIME: Original pipeline execution took 7638.143301010132 ms (excluding imports and monkey-patching)
2022-09-21 19:09:28 INFO  Starting execution of 1 what-if analyses...
2022-09-21 19:09:28 INFO  Start plan generation for analysis PermutationFeatureImportance...
2022-09-21 19:09:28 INFO  ---RUNTIME: Plan generation took 0.23651123046875 ms
2022-09-21 19:09:28 INFO  Estimated runtime of original DAG is 5417.072534561157ms
2022-09-21 19:09:28 WARNING Skipping Multi-Query Optimization (instead, only applying patches)
2022-09-21 19:09:28 INFO  Estimated unoptimised what-if runtime is 27085.362672805786ms
2022-09-21 19:09:28 INFO  ---RUNTIME: Multi-Query Optimization took 3.918886184692383 ms
2022-09-21 19:09:28 INFO  Executing generated plans
2022-09-21 19:09:59 INFO  ---RUNTIME: Execution took 31107.563495635986 ms
2022-09-21 19:09:59 INFO  Done!
2022-09-21 19:09:59 INFO  # Finished -- repetition 3 of 7 
2022-09-21 19:09:59 INFO  # Optimization benchmark for feature_importance with args [['reviews', 'slow_loading', 'featurization_1', 'logistic_regression']] -- repetition 4 of 7
2022-09-21 19:09:59 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-21 19:09:59 INFO  Running instrumented original pipeline...
2022-09-21 19:09:59 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-21 19:09:59 INFO  ---RUNTIME: Importing and monkey-patching took 6.091833114624023 ms
2022-09-21 19:10:06 INFO  ---RUNTIME: Original pipeline execution took 7601.760149002075 ms (excluding imports and monkey-patching)
2022-09-21 19:10:06 INFO  Starting execution of 1 what-if analyses...
2022-09-21 19:10:06 INFO  Start plan generation for analysis PermutationFeatureImportance...
2022-09-21 19:10:06 INFO  ---RUNTIME: Plan generation took 0.2391338348388672 ms
2022-09-21 19:10:06 INFO  Estimated runtime of original DAG is 5324.422359466553ms
2022-09-21 19:10:06 INFO  Performing Multi-Query Optimization
2022-09-21 19:10:06 INFO  Estimated unoptimized what-if runtime is 26622.111797332764ms
2022-09-21 19:10:06 INFO  Estimated optimised what-if runtime is 6648.534059524536ms
2022-09-21 19:10:06 INFO  Estimated optimisation runtime saving is 19973.577737808228ms
2022-09-21 19:10:06 INFO  ---RUNTIME: Multi-Query Optimization took 49.9422550201416 ms
2022-09-21 19:10:06 INFO  Executing generated plans
2022-09-21 19:10:14 INFO  ---RUNTIME: Execution took 7657.189607620239 ms
2022-09-21 19:10:14 INFO  Done!
2022-09-21 19:10:14 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-21 19:10:14 INFO  Running instrumented original pipeline...
2022-09-21 19:10:14 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-21 19:10:14 INFO  ---RUNTIME: Importing and monkey-patching took 5.81812858581543 ms
2022-09-21 19:10:22 INFO  ---RUNTIME: Original pipeline execution took 7974.056720733643 ms (excluding imports and monkey-patching)
2022-09-21 19:10:22 INFO  Starting execution of 1 what-if analyses...
2022-09-21 19:10:22 INFO  Start plan generation for analysis PermutationFeatureImportance...
2022-09-21 19:10:22 INFO  ---RUNTIME: Plan generation took 0.20456314086914062 ms
2022-09-21 19:10:22 INFO  Estimated runtime of original DAG is 5406.319379806519ms
2022-09-21 19:10:22 WARNING Skipping Multi-Query Optimization (instead, only applying patches)
2022-09-21 19:10:22 INFO  Estimated unoptimised what-if runtime is 27031.596899032593ms
2022-09-21 19:10:22 INFO  ---RUNTIME: Multi-Query Optimization took 3.912210464477539 ms
2022-09-21 19:10:22 INFO  Executing generated plans
2022-09-21 19:10:54 INFO  ---RUNTIME: Execution took 31907.38344192505 ms
2022-09-21 19:10:54 INFO  Done!
2022-09-21 19:10:54 INFO  # Finished -- repetition 4 of 7 
2022-09-21 19:10:54 INFO  # Optimization benchmark for feature_importance with args [['reviews', 'slow_loading', 'featurization_1', 'logistic_regression']] -- repetition 5 of 7
2022-09-21 19:10:54 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-21 19:10:54 INFO  Running instrumented original pipeline...
2022-09-21 19:10:54 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-21 19:10:54 INFO  ---RUNTIME: Importing and monkey-patching took 6.145238876342773 ms
2022-09-21 19:11:02 INFO  ---RUNTIME: Original pipeline execution took 7726.45115852356 ms (excluding imports and monkey-patching)
2022-09-21 19:11:02 INFO  Starting execution of 1 what-if analyses...
2022-09-21 19:11:02 INFO  Start plan generation for analysis PermutationFeatureImportance...
2022-09-21 19:11:02 INFO  ---RUNTIME: Plan generation took 0.2357959747314453 ms
2022-09-21 19:11:02 INFO  Estimated runtime of original DAG is 5412.486553192139ms
2022-09-21 19:11:02 INFO  Performing Multi-Query Optimization
2022-09-21 19:11:02 INFO  Estimated unoptimized what-if runtime is 27062.432765960693ms
2022-09-21 19:11:02 INFO  Estimated optimised what-if runtime is 6773.979187011719ms
2022-09-21 19:11:02 INFO  Estimated optimisation runtime saving is 20288.453578948975ms
2022-09-21 19:11:02 INFO  ---RUNTIME: Multi-Query Optimization took 42.029380798339844 ms
2022-09-21 19:11:02 INFO  Executing generated plans
2022-09-21 19:11:09 INFO  ---RUNTIME: Execution took 7729.129076004028 ms
2022-09-21 19:11:09 INFO  Done!
2022-09-21 19:11:09 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-21 19:11:09 INFO  Running instrumented original pipeline...
2022-09-21 19:11:10 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-21 19:11:10 INFO  ---RUNTIME: Importing and monkey-patching took 5.781650543212891 ms
2022-09-21 19:11:17 INFO  ---RUNTIME: Original pipeline execution took 7835.608720779419 ms (excluding imports and monkey-patching)
2022-09-21 19:11:17 INFO  Starting execution of 1 what-if analyses...
2022-09-21 19:11:17 INFO  Start plan generation for analysis PermutationFeatureImportance...
2022-09-21 19:11:17 INFO  ---RUNTIME: Plan generation took 0.22673606872558594 ms
2022-09-21 19:11:17 INFO  Estimated runtime of original DAG is 5512.42733001709ms
2022-09-21 19:11:17 WARNING Skipping Multi-Query Optimization (instead, only applying patches)
2022-09-21 19:11:17 INFO  Estimated unoptimised what-if runtime is 27562.13665008545ms
2022-09-21 19:11:17 INFO  ---RUNTIME: Multi-Query Optimization took 3.9281845092773438 ms
2022-09-21 19:11:17 INFO  Executing generated plans
2022-09-21 19:11:49 INFO  ---RUNTIME: Execution took 31754.93311882019 ms
2022-09-21 19:11:49 INFO  Done!
2022-09-21 19:11:49 INFO  # Finished -- repetition 5 of 7 
2022-09-21 19:11:49 INFO  # Optimization benchmark for feature_importance with args [['reviews', 'slow_loading', 'featurization_1', 'logistic_regression']] -- repetition 6 of 7
2022-09-21 19:11:49 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-21 19:11:49 INFO  Running instrumented original pipeline...
2022-09-21 19:11:49 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-21 19:11:49 INFO  ---RUNTIME: Importing and monkey-patching took 7.71331787109375 ms
2022-09-21 19:11:57 INFO  ---RUNTIME: Original pipeline execution took 7675.75740814209 ms (excluding imports and monkey-patching)
2022-09-21 19:11:57 INFO  Starting execution of 1 what-if analyses...
2022-09-21 19:11:57 INFO  Start plan generation for analysis PermutationFeatureImportance...
2022-09-21 19:11:57 INFO  ---RUNTIME: Plan generation took 0.21529197692871094 ms
2022-09-21 19:11:57 INFO  Estimated runtime of original DAG is 5375.7195472717285ms
2022-09-21 19:11:57 INFO  Performing Multi-Query Optimization
2022-09-21 19:11:57 INFO  Estimated unoptimized what-if runtime is 26878.597736358643ms
2022-09-21 19:11:57 INFO  Estimated optimised what-if runtime is 6702.928066253662ms
2022-09-21 19:11:57 INFO  Estimated optimisation runtime saving is 20175.66967010498ms
2022-09-21 19:11:57 INFO  ---RUNTIME: Multi-Query Optimization took 9.878396987915039 ms
2022-09-21 19:11:57 INFO  Executing generated plans
2022-09-21 19:12:04 INFO  ---RUNTIME: Execution took 7652.125358581543 ms
2022-09-21 19:12:04 INFO  Done!
2022-09-21 19:12:04 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-21 19:12:04 INFO  Running instrumented original pipeline...
2022-09-21 19:12:04 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-21 19:12:04 INFO  ---RUNTIME: Importing and monkey-patching took 5.736351013183594 ms
2022-09-21 19:12:12 INFO  ---RUNTIME: Original pipeline execution took 7687.345743179321 ms (excluding imports and monkey-patching)
2022-09-21 19:12:12 INFO  Starting execution of 1 what-if analyses...
2022-09-21 19:12:12 INFO  Start plan generation for analysis PermutationFeatureImportance...
2022-09-21 19:12:12 INFO  ---RUNTIME: Plan generation took 0.23603439331054688 ms
2022-09-21 19:12:12 INFO  Estimated runtime of original DAG is 5466.570138931274ms
2022-09-21 19:12:12 WARNING Skipping Multi-Query Optimization (instead, only applying patches)
2022-09-21 19:12:12 INFO  Estimated unoptimised what-if runtime is 27332.850694656372ms
2022-09-21 19:12:12 INFO  ---RUNTIME: Multi-Query Optimization took 3.996610641479492 ms
2022-09-21 19:12:12 INFO  Executing generated plans
2022-09-21 19:12:44 INFO  ---RUNTIME: Execution took 31608.862161636353 ms
2022-09-21 19:12:44 INFO  Done!
2022-09-21 19:12:44 INFO  # Finished -- repetition 6 of 7 
2022-09-21 19:12:44 INFO  # Optimization benchmark for feature_importance with args [['reviews', 'slow_loading', 'featurization_1', 'logistic_regression']] -- repetition 7 of 7
2022-09-21 19:12:44 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-21 19:12:44 INFO  Running instrumented original pipeline...
2022-09-21 19:12:44 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-21 19:12:44 INFO  ---RUNTIME: Importing and monkey-patching took 16.467571258544922 ms
2022-09-21 19:12:51 INFO  ---RUNTIME: Original pipeline execution took 7657.9554080963135 ms (excluding imports and monkey-patching)
2022-09-21 19:12:51 INFO  Starting execution of 1 what-if analyses...
2022-09-21 19:12:51 INFO  Start plan generation for analysis PermutationFeatureImportance...
2022-09-21 19:12:51 INFO  ---RUNTIME: Plan generation took 0.2315044403076172 ms
2022-09-21 19:12:51 INFO  Estimated runtime of original DAG is 5390.090465545654ms
2022-09-21 19:12:51 INFO  Performing Multi-Query Optimization
2022-09-21 19:12:51 INFO  Estimated unoptimized what-if runtime is 26950.45232772827ms
2022-09-21 19:12:51 INFO  Estimated optimised what-if runtime is 6721.883058547974ms
2022-09-21 19:12:51 INFO  Estimated optimisation runtime saving is 20228.569269180298ms
2022-09-21 19:12:51 INFO  ---RUNTIME: Multi-Query Optimization took 20.06697654724121 ms
2022-09-21 19:12:51 INFO  Executing generated plans
2022-09-21 19:12:59 INFO  ---RUNTIME: Execution took 7860.453128814697 ms
2022-09-21 19:12:59 INFO  Done!
2022-09-21 19:12:59 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-21 19:12:59 INFO  Running instrumented original pipeline...
2022-09-21 19:12:59 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-21 19:12:59 INFO  ---RUNTIME: Importing and monkey-patching took 5.873918533325195 ms
2022-09-21 19:13:07 INFO  ---RUNTIME: Original pipeline execution took 7980.473279953003 ms (excluding imports and monkey-patching)
2022-09-21 19:13:07 INFO  Starting execution of 1 what-if analyses...
2022-09-21 19:13:07 INFO  Start plan generation for analysis PermutationFeatureImportance...
2022-09-21 19:13:07 INFO  ---RUNTIME: Plan generation took 0.10275840759277344 ms
2022-09-21 19:13:07 INFO  Estimated runtime of original DAG is 5542.966842651367ms
2022-09-21 19:13:07 WARNING Skipping Multi-Query Optimization (instead, only applying patches)
2022-09-21 19:13:07 INFO  Estimated unoptimised what-if runtime is 27714.834213256836ms
2022-09-21 19:13:07 INFO  ---RUNTIME: Multi-Query Optimization took 4.030942916870117 ms
2022-09-21 19:13:07 INFO  Executing generated plans
2022-09-21 19:13:40 INFO  ---RUNTIME: Execution took 33161.4670753479 ms
2022-09-21 19:13:40 INFO  Done!
2022-09-21 19:13:40 INFO  # Finished -- repetition 7 of 7 
2022-09-21 19:13:40 INFO  # Final results after all repetitions
2022-09-21 19:13:40 INFO     repetition  ... no_opt_what_if_execution_combined_model_training
0           0  ...                                       593.381405
1           1  ...                                       597.360611
2           2  ...                                       599.135876
3           3  ...                                       590.134382
4           4  ...                                       591.126919
5           5  ...                                       593.569994
6           6  ...                                       710.751295

[7 rows x 26 columns]
taskset -c 32-39 PROTOCOL_BUFFERS_PYTHON_IMPLEMENTATION=python python3.9 benchmarks_end_to_end.py feature_importance reviews slow_loading featurization_1 xgboost
2022-09-21 19:13:43.165384: W tensorflow/stream_executor/platform/default/dso_loader.cc:64] Could not load dynamic library 'libcudart.so.11.0'; dlerror: libcudart.so.11.0: cannot open shared object file: No such file or directory; LD_LIBRARY_PATH: /home/sgrafbe/mlwhatif/venv/lib/python3.9/site-packages/cv2/../../lib64:
2022-09-21 19:13:43.165428: I tensorflow/stream_executor/cuda/cudart_stub.cc:29] Ignore above cudart dlerror if you do not have a GPU set up on your machine.
2022-09-21 19:13:44 INFO  Patching sys.argv with ['mlwhatif', 'reviews', 'slow_loading', 'featurization_1', 'xgboost']
2022-09-21 19:13:44 INFO  Running instrumented original pipeline...
2022-09-21 19:13:44 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-21 19:13:44 INFO  ---RUNTIME: Importing and monkey-patching took 95.09539604187012 ms
2022-09-21 19:13:54 INFO  ---RUNTIME: Original pipeline execution took 9708.825588226318 ms (excluding imports and monkey-patching)
2022-09-21 19:13:54 INFO  Starting execution of 0 what-if analyses...
2022-09-21 19:13:54 INFO  Estimated runtime of original DAG is 7449.227809906006ms
2022-09-21 19:13:54 INFO  Performing Multi-Query Optimization
2022-09-21 19:13:54 INFO  Estimated unoptimized what-if runtime is 0ms
2022-09-21 19:13:54 INFO  Estimated optimised what-if runtime is 0ms
2022-09-21 19:13:54 INFO  Estimated optimisation runtime saving is 0ms
2022-09-21 19:13:54 INFO  ---RUNTIME: Multi-Query Optimization took 0.5021095275878906 ms
2022-09-21 19:13:54 INFO  Executing generated plans
2022-09-21 19:13:54 INFO  ---RUNTIME: Execution took 0.022172927856445312 ms
2022-09-21 19:13:54 INFO  Done!
2022-09-21 19:13:54 INFO  # Optimization benchmark for feature_importance with args [['reviews', 'slow_loading', 'featurization_1', 'xgboost']] -- repetition 1 of 7
2022-09-21 19:13:54 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-21 19:13:54 INFO  Running instrumented original pipeline...
2022-09-21 19:13:54 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-21 19:13:54 INFO  ---RUNTIME: Importing and monkey-patching took 5.975246429443359 ms
2022-09-21 19:14:03 INFO  ---RUNTIME: Original pipeline execution took 8731.364727020264 ms (excluding imports and monkey-patching)
2022-09-21 19:14:03 INFO  Starting execution of 1 what-if analyses...
2022-09-21 19:14:03 INFO  Start plan generation for analysis PermutationFeatureImportance...
2022-09-21 19:14:03 INFO  ---RUNTIME: Plan generation took 0.3058910369873047 ms
2022-09-21 19:14:03 INFO  Estimated runtime of original DAG is 6178.245067596436ms
2022-09-21 19:14:03 INFO  Performing Multi-Query Optimization
2022-09-21 19:14:03 INFO  Estimated unoptimized what-if runtime is 30891.225337982178ms
2022-09-21 19:14:03 INFO  Estimated optimised what-if runtime is 7717.507123947144ms
2022-09-21 19:14:03 INFO  Estimated optimisation runtime saving is 23173.718214035034ms
2022-09-21 19:14:03 INFO  ---RUNTIME: Multi-Query Optimization took 10.049819946289062 ms
2022-09-21 19:14:03 INFO  Executing generated plans
2022-09-21 19:14:12 INFO  ---RUNTIME: Execution took 8778.971910476685 ms
2022-09-21 19:14:12 INFO  Done!
2022-09-21 19:14:12 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-21 19:14:12 INFO  Running instrumented original pipeline...
2022-09-21 19:14:12 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-21 19:14:12 INFO  ---RUNTIME: Importing and monkey-patching took 6.236553192138672 ms
2022-09-21 19:14:20 INFO  ---RUNTIME: Original pipeline execution took 8821.81191444397 ms (excluding imports and monkey-patching)
2022-09-21 19:14:20 INFO  Starting execution of 1 what-if analyses...
2022-09-21 19:14:20 INFO  Start plan generation for analysis PermutationFeatureImportance...
2022-09-21 19:14:20 INFO  ---RUNTIME: Plan generation took 0.24056434631347656 ms
2022-09-21 19:14:20 INFO  Estimated runtime of original DAG is 6381.599903106689ms
2022-09-21 19:14:20 WARNING Skipping Multi-Query Optimization (instead, only applying patches)
2022-09-21 19:14:20 INFO  Estimated unoptimised what-if runtime is 31907.999515533447ms
2022-09-21 19:14:20 INFO  ---RUNTIME: Multi-Query Optimization took 3.9548873901367188 ms
2022-09-21 19:14:20 INFO  Executing generated plans
2022-09-21 19:14:58 INFO  ---RUNTIME: Execution took 37559.714794158936 ms
2022-09-21 19:14:58 INFO  Done!
2022-09-21 19:14:58 INFO  # Finished -- repetition 1 of 7 
2022-09-21 19:14:58 INFO  # Optimization benchmark for feature_importance with args [['reviews', 'slow_loading', 'featurization_1', 'xgboost']] -- repetition 2 of 7
2022-09-21 19:14:58 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-21 19:14:58 INFO  Running instrumented original pipeline...
2022-09-21 19:14:58 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-21 19:14:58 INFO  ---RUNTIME: Importing and monkey-patching took 6.119251251220703 ms
2022-09-21 19:15:07 INFO  ---RUNTIME: Original pipeline execution took 8663.841247558594 ms (excluding imports and monkey-patching)
2022-09-21 19:15:07 INFO  Starting execution of 1 what-if analyses...
2022-09-21 19:15:07 INFO  Start plan generation for analysis PermutationFeatureImportance...
2022-09-21 19:15:07 INFO  ---RUNTIME: Plan generation took 0.263214111328125 ms
2022-09-21 19:15:07 INFO  Estimated runtime of original DAG is 6125.653028488159ms
2022-09-21 19:15:07 INFO  Performing Multi-Query Optimization
2022-09-21 19:15:07 INFO  Estimated unoptimized what-if runtime is 30628.265142440796ms
2022-09-21 19:15:07 INFO  Estimated optimised what-if runtime is 7659.426212310791ms
2022-09-21 19:15:07 INFO  Estimated optimisation runtime saving is 22968.838930130005ms
2022-09-21 19:15:07 INFO  ---RUNTIME: Multi-Query Optimization took 10.094642639160156 ms
2022-09-21 19:15:07 INFO  Executing generated plans
2022-09-21 19:15:16 INFO  ---RUNTIME: Execution took 8917.05298423767 ms
2022-09-21 19:15:16 INFO  Done!
2022-09-21 19:15:16 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-21 19:15:16 INFO  Running instrumented original pipeline...
2022-09-21 19:15:16 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-21 19:15:16 INFO  ---RUNTIME: Importing and monkey-patching took 5.899190902709961 ms
2022-09-21 19:15:24 INFO  ---RUNTIME: Original pipeline execution took 8604.023218154907 ms (excluding imports and monkey-patching)
2022-09-21 19:15:24 INFO  Starting execution of 1 what-if analyses...
2022-09-21 19:15:24 INFO  Start plan generation for analysis PermutationFeatureImportance...
2022-09-21 19:15:24 INFO  ---RUNTIME: Plan generation took 0.22673606872558594 ms
2022-09-21 19:15:24 INFO  Estimated runtime of original DAG is 6200.358867645264ms
2022-09-21 19:15:24 WARNING Skipping Multi-Query Optimization (instead, only applying patches)
2022-09-21 19:15:24 INFO  Estimated unoptimised what-if runtime is 31001.79433822632ms
2022-09-21 19:15:24 INFO  ---RUNTIME: Multi-Query Optimization took 3.882169723510742 ms
2022-09-21 19:15:24 INFO  Executing generated plans
2022-09-21 19:16:01 INFO  ---RUNTIME: Execution took 37249.664306640625 ms
2022-09-21 19:16:01 INFO  Done!
2022-09-21 19:16:01 INFO  # Finished -- repetition 2 of 7 
2022-09-21 19:16:01 INFO  # Optimization benchmark for feature_importance with args [['reviews', 'slow_loading', 'featurization_1', 'xgboost']] -- repetition 3 of 7
2022-09-21 19:16:01 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-21 19:16:01 INFO  Running instrumented original pipeline...
2022-09-21 19:16:01 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-21 19:16:01 INFO  ---RUNTIME: Importing and monkey-patching took 9.326934814453125 ms
2022-09-21 19:16:10 INFO  ---RUNTIME: Original pipeline execution took 8707.78203010559 ms (excluding imports and monkey-patching)
2022-09-21 19:16:10 INFO  Starting execution of 1 what-if analyses...
2022-09-21 19:16:10 INFO  Start plan generation for analysis PermutationFeatureImportance...
2022-09-21 19:16:10 INFO  ---RUNTIME: Plan generation took 0.2434253692626953 ms
2022-09-21 19:16:10 INFO  Estimated runtime of original DAG is 6459.49649810791ms
2022-09-21 19:16:10 INFO  Performing Multi-Query Optimization
2022-09-21 19:16:10 INFO  Estimated unoptimized what-if runtime is 32297.48249053955ms
2022-09-21 19:16:10 INFO  Estimated optimised what-if runtime is 8219.798803329468ms
2022-09-21 19:16:10 INFO  Estimated optimisation runtime saving is 24077.683687210083ms
2022-09-21 19:16:10 INFO  ---RUNTIME: Multi-Query Optimization took 9.94420051574707 ms
2022-09-21 19:16:10 INFO  Executing generated plans
2022-09-21 19:16:19 INFO  ---RUNTIME: Execution took 8810.760498046875 ms
2022-09-21 19:16:19 INFO  Done!
2022-09-21 19:16:19 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-21 19:16:19 INFO  Running instrumented original pipeline...
2022-09-21 19:16:19 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-21 19:16:19 INFO  ---RUNTIME: Importing and monkey-patching took 5.863189697265625 ms
2022-09-21 19:16:28 INFO  ---RUNTIME: Original pipeline execution took 8750.61297416687 ms (excluding imports and monkey-patching)
2022-09-21 19:16:28 INFO  Starting execution of 1 what-if analyses...
2022-09-21 19:16:28 INFO  Start plan generation for analysis PermutationFeatureImportance...
2022-09-21 19:16:28 INFO  ---RUNTIME: Plan generation took 0.244140625 ms
2022-09-21 19:16:28 INFO  Estimated runtime of original DAG is 6260.320425033569ms
2022-09-21 19:16:28 WARNING Skipping Multi-Query Optimization (instead, only applying patches)
2022-09-21 19:16:28 INFO  Estimated unoptimised what-if runtime is 31301.602125167847ms
2022-09-21 19:16:28 INFO  ---RUNTIME: Multi-Query Optimization took 3.899097442626953 ms
2022-09-21 19:16:28 INFO  Executing generated plans
2022-09-21 19:17:05 INFO  ---RUNTIME: Execution took 37583.20951461792 ms
2022-09-21 19:17:05 INFO  Done!
2022-09-21 19:17:05 INFO  # Finished -- repetition 3 of 7 
2022-09-21 19:17:05 INFO  # Optimization benchmark for feature_importance with args [['reviews', 'slow_loading', 'featurization_1', 'xgboost']] -- repetition 4 of 7
2022-09-21 19:17:05 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-21 19:17:05 INFO  Running instrumented original pipeline...
2022-09-21 19:17:05 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-21 19:17:05 INFO  ---RUNTIME: Importing and monkey-patching took 6.134986877441406 ms
2022-09-21 19:17:14 INFO  ---RUNTIME: Original pipeline execution took 8666.415691375732 ms (excluding imports and monkey-patching)
2022-09-21 19:17:14 INFO  Starting execution of 1 what-if analyses...
2022-09-21 19:17:14 INFO  Start plan generation for analysis PermutationFeatureImportance...
2022-09-21 19:17:14 INFO  ---RUNTIME: Plan generation took 0.23365020751953125 ms
2022-09-21 19:17:14 INFO  Estimated runtime of original DAG is 6444.5507526397705ms
2022-09-21 19:17:14 INFO  Performing Multi-Query Optimization
2022-09-21 19:17:14 INFO  Estimated unoptimized what-if runtime is 32222.753763198853ms
2022-09-21 19:17:14 INFO  Estimated optimised what-if runtime is 7980.3571701049805ms
2022-09-21 19:17:14 INFO  Estimated optimisation runtime saving is 24242.396593093872ms
2022-09-21 19:17:14 INFO  ---RUNTIME: Multi-Query Optimization took 9.915351867675781 ms
2022-09-21 19:17:14 INFO  Executing generated plans
2022-09-21 19:17:23 INFO  ---RUNTIME: Execution took 9106.749773025513 ms
2022-09-21 19:17:23 INFO  Done!
2022-09-21 19:17:23 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-21 19:17:23 INFO  Running instrumented original pipeline...
2022-09-21 19:17:23 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-21 19:17:23 INFO  ---RUNTIME: Importing and monkey-patching took 5.843877792358398 ms
2022-09-21 19:17:32 INFO  ---RUNTIME: Original pipeline execution took 8983.630418777466 ms (excluding imports and monkey-patching)
2022-09-21 19:17:32 INFO  Starting execution of 1 what-if analyses...
2022-09-21 19:17:32 INFO  Start plan generation for analysis PermutationFeatureImportance...
2022-09-21 19:17:32 INFO  ---RUNTIME: Plan generation took 0.25343894958496094 ms
2022-09-21 19:17:32 INFO  Estimated runtime of original DAG is 6211.271047592163ms
2022-09-21 19:17:32 WARNING Skipping Multi-Query Optimization (instead, only applying patches)
2022-09-21 19:17:32 INFO  Estimated unoptimised what-if runtime is 31056.355237960815ms
2022-09-21 19:17:32 INFO  ---RUNTIME: Multi-Query Optimization took 3.8328170776367188 ms
2022-09-21 19:17:32 INFO  Executing generated plans
2022-09-21 19:18:09 INFO  ---RUNTIME: Execution took 37310.474157333374 ms
2022-09-21 19:18:09 INFO  Done!
2022-09-21 19:18:09 INFO  # Finished -- repetition 4 of 7 
2022-09-21 19:18:09 INFO  # Optimization benchmark for feature_importance with args [['reviews', 'slow_loading', 'featurization_1', 'xgboost']] -- repetition 5 of 7
2022-09-21 19:18:09 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-21 19:18:09 INFO  Running instrumented original pipeline...
2022-09-21 19:18:09 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-21 19:18:09 INFO  ---RUNTIME: Importing and monkey-patching took 8.507251739501953 ms
2022-09-21 19:18:19 INFO  ---RUNTIME: Original pipeline execution took 9451.873540878296 ms (excluding imports and monkey-patching)
2022-09-21 19:18:19 INFO  Starting execution of 1 what-if analyses...
2022-09-21 19:18:19 INFO  Start plan generation for analysis PermutationFeatureImportance...
2022-09-21 19:18:19 INFO  ---RUNTIME: Plan generation took 0.2460479736328125 ms
2022-09-21 19:18:19 INFO  Estimated runtime of original DAG is 7040.760517120361ms
2022-09-21 19:18:19 INFO  Performing Multi-Query Optimization
2022-09-21 19:18:19 INFO  Estimated unoptimized what-if runtime is 35203.80258560181ms
2022-09-21 19:18:19 INFO  Estimated optimised what-if runtime is 8581.294536590576ms
2022-09-21 19:18:19 INFO  Estimated optimisation runtime saving is 26622.50804901123ms
2022-09-21 19:18:19 INFO  ---RUNTIME: Multi-Query Optimization took 9.965896606445312 ms
2022-09-21 19:18:19 INFO  Executing generated plans
2022-09-21 19:18:28 INFO  ---RUNTIME: Execution took 8998.424053192139 ms
2022-09-21 19:18:28 INFO  Done!
2022-09-21 19:18:28 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-21 19:18:28 INFO  Running instrumented original pipeline...
2022-09-21 19:18:28 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-21 19:18:28 INFO  ---RUNTIME: Importing and monkey-patching took 5.734443664550781 ms
2022-09-21 19:18:37 INFO  ---RUNTIME: Original pipeline execution took 8961.581230163574 ms (excluding imports and monkey-patching)
2022-09-21 19:18:37 INFO  Starting execution of 1 what-if analyses...
2022-09-21 19:18:37 INFO  Start plan generation for analysis PermutationFeatureImportance...
2022-09-21 19:18:37 INFO  ---RUNTIME: Plan generation took 0.21123886108398438 ms
2022-09-21 19:18:37 INFO  Estimated runtime of original DAG is 6681.271314620972ms
2022-09-21 19:18:37 WARNING Skipping Multi-Query Optimization (instead, only applying patches)
2022-09-21 19:18:37 INFO  Estimated unoptimised what-if runtime is 33406.35657310486ms
2022-09-21 19:18:37 INFO  ---RUNTIME: Multi-Query Optimization took 3.9048194885253906 ms
2022-09-21 19:18:37 INFO  Executing generated plans
2022-09-21 19:19:15 INFO  ---RUNTIME: Execution took 38042.954444885254 ms
2022-09-21 19:19:15 INFO  Done!
2022-09-21 19:19:15 INFO  # Finished -- repetition 5 of 7 
2022-09-21 19:19:15 INFO  # Optimization benchmark for feature_importance with args [['reviews', 'slow_loading', 'featurization_1', 'xgboost']] -- repetition 6 of 7
2022-09-21 19:19:15 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-21 19:19:15 INFO  Running instrumented original pipeline...
2022-09-21 19:19:15 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-21 19:19:15 INFO  ---RUNTIME: Importing and monkey-patching took 6.241083145141602 ms
2022-09-21 19:19:24 INFO  ---RUNTIME: Original pipeline execution took 8992.247104644775 ms (excluding imports and monkey-patching)
2022-09-21 19:19:24 INFO  Starting execution of 1 what-if analyses...
2022-09-21 19:19:24 INFO  Start plan generation for analysis PermutationFeatureImportance...
2022-09-21 19:19:24 INFO  ---RUNTIME: Plan generation took 0.3654956817626953 ms
2022-09-21 19:19:24 INFO  Estimated runtime of original DAG is 6727.571964263916ms
2022-09-21 19:19:24 INFO  Performing Multi-Query Optimization
2022-09-21 19:19:24 INFO  Estimated unoptimized what-if runtime is 33637.85982131958ms
2022-09-21 19:19:24 INFO  Estimated optimised what-if runtime is 8703.548431396484ms
2022-09-21 19:19:24 INFO  Estimated optimisation runtime saving is 24934.311389923096ms
2022-09-21 19:19:24 INFO  ---RUNTIME: Multi-Query Optimization took 17.356157302856445 ms
2022-09-21 19:19:24 INFO  Executing generated plans
2022-09-21 19:19:33 INFO  ---RUNTIME: Execution took 9455.23452758789 ms
2022-09-21 19:19:33 INFO  Done!
2022-09-21 19:19:33 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-21 19:19:33 INFO  Running instrumented original pipeline...
2022-09-21 19:19:33 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-21 19:19:33 INFO  ---RUNTIME: Importing and monkey-patching took 8.042097091674805 ms
2022-09-21 19:19:44 INFO  ---RUNTIME: Original pipeline execution took 10807.298421859741 ms (excluding imports and monkey-patching)
2022-09-21 19:19:44 INFO  Starting execution of 1 what-if analyses...
2022-09-21 19:19:44 INFO  Start plan generation for analysis PermutationFeatureImportance...
2022-09-21 19:19:44 INFO  ---RUNTIME: Plan generation took 0.23174285888671875 ms
2022-09-21 19:19:44 INFO  Estimated runtime of original DAG is 8550.49204826355ms
2022-09-21 19:19:44 WARNING Skipping Multi-Query Optimization (instead, only applying patches)
2022-09-21 19:19:44 INFO  Estimated unoptimised what-if runtime is 42752.46024131775ms
2022-09-21 19:19:44 INFO  ---RUNTIME: Multi-Query Optimization took 3.869771957397461 ms
2022-09-21 19:19:44 INFO  Executing generated plans
2022-09-21 19:20:21 INFO  ---RUNTIME: Execution took 36655.80701828003 ms
2022-09-21 19:20:21 INFO  Done!
2022-09-21 19:20:21 INFO  # Finished -- repetition 6 of 7 
2022-09-21 19:20:21 INFO  # Optimization benchmark for feature_importance with args [['reviews', 'slow_loading', 'featurization_1', 'xgboost']] -- repetition 7 of 7
2022-09-21 19:20:21 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-21 19:20:21 INFO  Running instrumented original pipeline...
2022-09-21 19:20:21 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-21 19:20:21 INFO  ---RUNTIME: Importing and monkey-patching took 6.186246871948242 ms
2022-09-21 19:20:29 INFO  ---RUNTIME: Original pipeline execution took 8420.001983642578 ms (excluding imports and monkey-patching)
2022-09-21 19:20:29 INFO  Starting execution of 1 what-if analyses...
2022-09-21 19:20:29 INFO  Start plan generation for analysis PermutationFeatureImportance...
2022-09-21 19:20:29 INFO  ---RUNTIME: Plan generation took 0.2548694610595703 ms
2022-09-21 19:20:29 INFO  Estimated runtime of original DAG is 6195.32036781311ms
2022-09-21 19:20:29 INFO  Performing Multi-Query Optimization
2022-09-21 19:20:29 INFO  Estimated unoptimized what-if runtime is 30976.60183906555ms
2022-09-21 19:20:29 INFO  Estimated optimised what-if runtime is 7717.976093292236ms
2022-09-21 19:20:29 INFO  Estimated optimisation runtime saving is 23258.625745773315ms
2022-09-21 19:20:29 INFO  ---RUNTIME: Multi-Query Optimization took 9.888887405395508 ms
2022-09-21 19:20:29 INFO  Executing generated plans
2022-09-21 19:20:39 INFO  ---RUNTIME: Execution took 9848.955869674683 ms
2022-09-21 19:20:39 INFO  Done!
2022-09-21 19:20:39 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-21 19:20:39 INFO  Running instrumented original pipeline...
2022-09-21 19:20:39 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-21 19:20:39 INFO  ---RUNTIME: Importing and monkey-patching took 7.803678512573242 ms
2022-09-21 19:20:48 INFO  ---RUNTIME: Original pipeline execution took 8723.644495010376 ms (excluding imports and monkey-patching)
2022-09-21 19:20:48 INFO  Starting execution of 1 what-if analyses...
2022-09-21 19:20:48 INFO  Start plan generation for analysis PermutationFeatureImportance...
2022-09-21 19:20:48 INFO  ---RUNTIME: Plan generation took 0.12111663818359375 ms
2022-09-21 19:20:48 INFO  Estimated runtime of original DAG is 6484.794616699219ms
2022-09-21 19:20:48 WARNING Skipping Multi-Query Optimization (instead, only applying patches)
2022-09-21 19:20:48 INFO  Estimated unoptimised what-if runtime is 32423.973083496094ms
2022-09-21 19:20:48 INFO  ---RUNTIME: Multi-Query Optimization took 4.056692123413086 ms
2022-09-21 19:20:48 INFO  Executing generated plans
2022-09-21 19:21:24 INFO  ---RUNTIME: Execution took 36437.278747558594 ms
2022-09-21 19:21:24 INFO  Done!
2022-09-21 19:21:24 INFO  # Finished -- repetition 7 of 7 
2022-09-21 19:21:24 INFO  # Final results after all repetitions
2022-09-21 19:21:24 INFO     repetition  ... no_opt_what_if_execution_combined_model_training
0           0  ...                                      4518.060446
1           1  ...                                      4637.559414
2           2  ...                                      4854.837179
3           3  ...                                      5123.460293
4           4  ...                                      5420.720100
5           5  ...                                      4678.123474
6           6  ...                                      4782.667875

[7 rows x 26 columns]
taskset -c 32-39 PROTOCOL_BUFFERS_PYTHON_IMPLEMENTATION=python python3.9 benchmarks_end_to_end.py feature_importance reviews slow_loading featurization_1 neural_network
2022-09-21 19:21:27.334961: W tensorflow/stream_executor/platform/default/dso_loader.cc:64] Could not load dynamic library 'libcudart.so.11.0'; dlerror: libcudart.so.11.0: cannot open shared object file: No such file or directory; LD_LIBRARY_PATH: /home/sgrafbe/mlwhatif/venv/lib/python3.9/site-packages/cv2/../../lib64:
2022-09-21 19:21:27.335005: I tensorflow/stream_executor/cuda/cudart_stub.cc:29] Ignore above cudart dlerror if you do not have a GPU set up on your machine.
2022-09-21 19:21:28 INFO  Patching sys.argv with ['mlwhatif', 'reviews', 'slow_loading', 'featurization_1', 'neural_network']
2022-09-21 19:21:28 INFO  Running instrumented original pipeline...
2022-09-21 19:21:28 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-21 19:21:28 INFO  ---RUNTIME: Importing and monkey-patching took 95.60847282409668 ms
2022-09-21 19:21:34.783738: W tensorflow/stream_executor/platform/default/dso_loader.cc:64] Could not load dynamic library 'libcuda.so.1'; dlerror: libcuda.so.1: cannot open shared object file: No such file or directory; LD_LIBRARY_PATH: /home/sgrafbe/mlwhatif/venv/lib/python3.9/site-packages/cv2/../../lib64:
2022-09-21 19:21:34.783773: W tensorflow/stream_executor/cuda/cuda_driver.cc:326] failed call to cuInit: UNKNOWN ERROR (303)
2022-09-21 19:21:34.783795: I tensorflow/stream_executor/cuda/cuda_diagnostics.cc:156] kernel driver does not appear to be running on this host (wagyu): /proc/driver/nvidia/version does not exist
2022-09-21 19:21:34.784400: I tensorflow/core/platform/cpu_feature_guard.cc:142] This TensorFlow binary is optimized with oneAPI Deep Neural Network Library (oneDNN) to use the following CPU instructions in performance-critical operations:  AVX2 FMA
To enable them in other operations, rebuild TensorFlow with the appropriate compiler flags.
2022-09-21 19:21:34.853678: I tensorflow/compiler/mlir/mlir_graph_optimization_pass.cc:176] None of the MLIR Optimization Passes are enabled (registered 2)
2022-09-21 19:21:34.866380: I tensorflow/core/platform/profile_utils/cpu_utils.cc:114] CPU Frequency: 2595290000 Hz
2022-09-21 19:21:40 INFO  ---RUNTIME: Original pipeline execution took 11757.035970687866 ms (excluding imports and monkey-patching)
2022-09-21 19:21:40 INFO  Starting execution of 0 what-if analyses...
2022-09-21 19:21:40 INFO  Estimated runtime of original DAG is 9509.49740409851ms
2022-09-21 19:21:40 INFO  Performing Multi-Query Optimization
2022-09-21 19:21:40 INFO  Estimated unoptimized what-if runtime is 0ms
2022-09-21 19:21:40 INFO  Estimated optimised what-if runtime is 0ms
2022-09-21 19:21:40 INFO  Estimated optimisation runtime saving is 0ms
2022-09-21 19:21:40 INFO  ---RUNTIME: Multi-Query Optimization took 0.4754066467285156 ms
2022-09-21 19:21:40 INFO  Executing generated plans
2022-09-21 19:21:40 INFO  ---RUNTIME: Execution took 0.02193450927734375 ms
2022-09-21 19:21:40 INFO  Done!
2022-09-21 19:21:40 INFO  # Optimization benchmark for feature_importance with args [['reviews', 'slow_loading', 'featurization_1', 'neural_network']] -- repetition 1 of 7
2022-09-21 19:21:40 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-21 19:21:40 INFO  Running instrumented original pipeline...
2022-09-21 19:21:40 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-21 19:21:40 INFO  ---RUNTIME: Importing and monkey-patching took 5.236625671386719 ms
2022-09-21 19:21:51 INFO  ---RUNTIME: Original pipeline execution took 11397.852659225464 ms (excluding imports and monkey-patching)
2022-09-21 19:21:51 INFO  Starting execution of 1 what-if analyses...
2022-09-21 19:21:51 INFO  Start plan generation for analysis PermutationFeatureImportance...
2022-09-21 19:21:51 INFO  ---RUNTIME: Plan generation took 0.20694732666015625 ms
2022-09-21 19:21:51 INFO  Estimated runtime of original DAG is 9222.288846969604ms
2022-09-21 19:21:51 INFO  Performing Multi-Query Optimization
2022-09-21 19:21:51 INFO  Estimated unoptimized what-if runtime is 46111.44423484802ms
2022-09-21 19:21:51 INFO  Estimated optimised what-if runtime is 12460.887670516968ms
2022-09-21 19:21:51 INFO  Estimated optimisation runtime saving is 33650.556564331055ms
2022-09-21 19:21:51 INFO  ---RUNTIME: Multi-Query Optimization took 10.010004043579102 ms
2022-09-21 19:21:51 INFO  Executing generated plans
2022-09-21 19:22:04 INFO  ---RUNTIME: Execution took 12699.799299240112 ms
2022-09-21 19:22:04 INFO  Done!
2022-09-21 19:22:04 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-21 19:22:04 INFO  Running instrumented original pipeline...
2022-09-21 19:22:04 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-21 19:22:04 INFO  ---RUNTIME: Importing and monkey-patching took 6.072282791137695 ms
2022-09-21 19:22:16 INFO  ---RUNTIME: Original pipeline execution took 12050.07529258728 ms (excluding imports and monkey-patching)
2022-09-21 19:22:16 INFO  Starting execution of 1 what-if analyses...
2022-09-21 19:22:16 INFO  Start plan generation for analysis PermutationFeatureImportance...
2022-09-21 19:22:16 INFO  ---RUNTIME: Plan generation took 0.12183189392089844 ms
2022-09-21 19:22:16 INFO  Estimated runtime of original DAG is 9749.077081680298ms
2022-09-21 19:22:16 WARNING Skipping Multi-Query Optimization (instead, only applying patches)
2022-09-21 19:22:16 INFO  Estimated unoptimised what-if runtime is 48745.38540840149ms
2022-09-21 19:22:16 INFO  ---RUNTIME: Multi-Query Optimization took 4.181861877441406 ms
2022-09-21 19:22:16 INFO  Executing generated plans
2022-09-21 19:23:08 INFO  ---RUNTIME: Execution took 51738.19351196289 ms
2022-09-21 19:23:08 INFO  Done!
2022-09-21 19:23:08 INFO  # Finished -- repetition 1 of 7 
2022-09-21 19:23:08 INFO  # Optimization benchmark for feature_importance with args [['reviews', 'slow_loading', 'featurization_1', 'neural_network']] -- repetition 2 of 7
2022-09-21 19:23:08 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-21 19:23:08 INFO  Running instrumented original pipeline...
2022-09-21 19:23:08 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-21 19:23:08 INFO  ---RUNTIME: Importing and monkey-patching took 6.767749786376953 ms
2022-09-21 19:23:20 INFO  ---RUNTIME: Original pipeline execution took 11832.631587982178 ms (excluding imports and monkey-patching)
2022-09-21 19:23:20 INFO  Starting execution of 1 what-if analyses...
2022-09-21 19:23:20 INFO  Start plan generation for analysis PermutationFeatureImportance...
2022-09-21 19:23:20 INFO  ---RUNTIME: Plan generation took 0.10538101196289062 ms
2022-09-21 19:23:20 INFO  Estimated runtime of original DAG is 9379.627704620361ms
2022-09-21 19:23:20 INFO  Performing Multi-Query Optimization
2022-09-21 19:23:20 INFO  Estimated unoptimized what-if runtime is 46898.13852310181ms
2022-09-21 19:23:20 INFO  Estimated optimised what-if runtime is 12631.78038597107ms
2022-09-21 19:23:20 INFO  Estimated optimisation runtime saving is 34266.35813713074ms
2022-09-21 19:23:20 INFO  ---RUNTIME: Multi-Query Optimization took 10.439634323120117 ms
2022-09-21 19:23:20 INFO  Executing generated plans
2022-09-21 19:23:33 INFO  ---RUNTIME: Execution took 13003.709554672241 ms
2022-09-21 19:23:33 INFO  Done!
2022-09-21 19:23:33 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-21 19:23:33 INFO  Running instrumented original pipeline...
2022-09-21 19:23:33 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-21 19:23:33 INFO  ---RUNTIME: Importing and monkey-patching took 6.094694137573242 ms
2022-09-21 19:23:44 INFO  ---RUNTIME: Original pipeline execution took 11465.687990188599 ms (excluding imports and monkey-patching)
2022-09-21 19:23:44 INFO  Starting execution of 1 what-if analyses...
2022-09-21 19:23:44 INFO  Start plan generation for analysis PermutationFeatureImportance...
2022-09-21 19:23:44 INFO  ---RUNTIME: Plan generation took 0.11301040649414062 ms
2022-09-21 19:23:44 INFO  Estimated runtime of original DAG is 9191.34545326233ms
2022-09-21 19:23:44 WARNING Skipping Multi-Query Optimization (instead, only applying patches)
2022-09-21 19:23:44 INFO  Estimated unoptimised what-if runtime is 45956.727266311646ms
2022-09-21 19:23:44 INFO  ---RUNTIME: Multi-Query Optimization took 5.531787872314453 ms
2022-09-21 19:23:44 INFO  Executing generated plans
2022-09-21 19:24:36 INFO  ---RUNTIME: Execution took 51778.35512161255 ms
2022-09-21 19:24:36 INFO  Done!
2022-09-21 19:24:36 INFO  # Finished -- repetition 2 of 7 
2022-09-21 19:24:36 INFO  # Optimization benchmark for feature_importance with args [['reviews', 'slow_loading', 'featurization_1', 'neural_network']] -- repetition 3 of 7
2022-09-21 19:24:36 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-21 19:24:36 INFO  Running instrumented original pipeline...
2022-09-21 19:24:36 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-21 19:24:36 INFO  ---RUNTIME: Importing and monkey-patching took 6.814002990722656 ms
2022-09-21 19:24:47 INFO  ---RUNTIME: Original pipeline execution took 11381.938457489014 ms (excluding imports and monkey-patching)
2022-09-21 19:24:47 INFO  Starting execution of 1 what-if analyses...
2022-09-21 19:24:47 INFO  Start plan generation for analysis PermutationFeatureImportance...
2022-09-21 19:24:47 INFO  ---RUNTIME: Plan generation took 0.11706352233886719 ms
2022-09-21 19:24:47 INFO  Estimated runtime of original DAG is 9143.80693435669ms
2022-09-21 19:24:47 INFO  Performing Multi-Query Optimization
2022-09-21 19:24:47 INFO  Estimated unoptimized what-if runtime is 45719.03467178345ms
2022-09-21 19:24:47 INFO  Estimated optimised what-if runtime is 12030.468463897705ms
2022-09-21 19:24:47 INFO  Estimated optimisation runtime saving is 33688.56620788574ms
2022-09-21 19:24:47 INFO  ---RUNTIME: Multi-Query Optimization took 9.541034698486328 ms
2022-09-21 19:24:47 INFO  Executing generated plans
2022-09-21 19:25:00 INFO  ---RUNTIME: Execution took 12631.858587265015 ms
2022-09-21 19:25:00 INFO  Done!
2022-09-21 19:25:00 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-21 19:25:00 INFO  Running instrumented original pipeline...
2022-09-21 19:25:00 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-21 19:25:00 INFO  ---RUNTIME: Importing and monkey-patching took 6.066799163818359 ms
2022-09-21 19:25:12 INFO  ---RUNTIME: Original pipeline execution took 11759.927749633789 ms (excluding imports and monkey-patching)
2022-09-21 19:25:12 INFO  Starting execution of 1 what-if analyses...
2022-09-21 19:25:12 INFO  Start plan generation for analysis PermutationFeatureImportance...
2022-09-21 19:25:12 INFO  ---RUNTIME: Plan generation took 0.09417533874511719 ms
2022-09-21 19:25:12 INFO  Estimated runtime of original DAG is 9002.536535263062ms
2022-09-21 19:25:12 WARNING Skipping Multi-Query Optimization (instead, only applying patches)
2022-09-21 19:25:12 INFO  Estimated unoptimised what-if runtime is 45012.68267631531ms
2022-09-21 19:25:12 INFO  ---RUNTIME: Multi-Query Optimization took 3.8099288940429688 ms
2022-09-21 19:25:12 INFO  Executing generated plans
2022-09-21 19:26:02 INFO  ---RUNTIME: Execution took 50412.65273094177 ms
2022-09-21 19:26:02 INFO  Done!
2022-09-21 19:26:02 INFO  # Finished -- repetition 3 of 7 
2022-09-21 19:26:02 INFO  # Optimization benchmark for feature_importance with args [['reviews', 'slow_loading', 'featurization_1', 'neural_network']] -- repetition 4 of 7
2022-09-21 19:26:02 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-21 19:26:02 INFO  Running instrumented original pipeline...
2022-09-21 19:26:03 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-21 19:26:03 INFO  ---RUNTIME: Importing and monkey-patching took 6.299734115600586 ms
2022-09-21 19:26:14 INFO  ---RUNTIME: Original pipeline execution took 11738.171577453613 ms (excluding imports and monkey-patching)
2022-09-21 19:26:14 INFO  Starting execution of 1 what-if analyses...
2022-09-21 19:26:14 INFO  Start plan generation for analysis PermutationFeatureImportance...
2022-09-21 19:26:14 INFO  ---RUNTIME: Plan generation took 0.09393692016601562 ms
2022-09-21 19:26:14 INFO  Estimated runtime of original DAG is 9047.899007797241ms
2022-09-21 19:26:14 INFO  Performing Multi-Query Optimization
2022-09-21 19:26:14 INFO  Estimated unoptimized what-if runtime is 45239.495038986206ms
2022-09-21 19:26:14 INFO  Estimated optimised what-if runtime is 11906.929969787598ms
2022-09-21 19:26:14 INFO  Estimated optimisation runtime saving is 33332.56506919861ms
2022-09-21 19:26:14 INFO  ---RUNTIME: Multi-Query Optimization took 9.581804275512695 ms
2022-09-21 19:26:14 INFO  Executing generated plans
2022-09-21 19:26:27 INFO  ---RUNTIME: Execution took 12745.543003082275 ms
2022-09-21 19:26:27 INFO  Done!
2022-09-21 19:26:27 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-21 19:26:27 INFO  Running instrumented original pipeline...
2022-09-21 19:26:27 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-21 19:26:27 INFO  ---RUNTIME: Importing and monkey-patching took 5.706548690795898 ms
2022-09-21 19:26:38 INFO  ---RUNTIME: Original pipeline execution took 11234.18140411377 ms (excluding imports and monkey-patching)
2022-09-21 19:26:38 INFO  Starting execution of 1 what-if analyses...
2022-09-21 19:26:38 INFO  Start plan generation for analysis PermutationFeatureImportance...
2022-09-21 19:26:38 INFO  ---RUNTIME: Plan generation took 0.12636184692382812 ms
2022-09-21 19:26:38 INFO  Estimated runtime of original DAG is 8936.060667037964ms
2022-09-21 19:26:38 WARNING Skipping Multi-Query Optimization (instead, only applying patches)
2022-09-21 19:26:38 INFO  Estimated unoptimised what-if runtime is 44680.30333518982ms
2022-09-21 19:26:38 INFO  ---RUNTIME: Multi-Query Optimization took 3.877878189086914 ms
2022-09-21 19:26:38 INFO  Executing generated plans
2022-09-21 19:27:28 INFO  ---RUNTIME: Execution took 49778.68437767029 ms
2022-09-21 19:27:28 INFO  Done!
2022-09-21 19:27:28 INFO  # Finished -- repetition 4 of 7 
2022-09-21 19:27:28 INFO  # Optimization benchmark for feature_importance with args [['reviews', 'slow_loading', 'featurization_1', 'neural_network']] -- repetition 5 of 7
2022-09-21 19:27:28 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-21 19:27:28 INFO  Running instrumented original pipeline...
2022-09-21 19:27:28 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-21 19:27:28 INFO  ---RUNTIME: Importing and monkey-patching took 6.261110305786133 ms
2022-09-21 19:27:40 INFO  ---RUNTIME: Original pipeline execution took 11908.779859542847 ms (excluding imports and monkey-patching)
2022-09-21 19:27:40 INFO  Starting execution of 1 what-if analyses...
2022-09-21 19:27:40 INFO  Start plan generation for analysis PermutationFeatureImportance...
2022-09-21 19:27:40 INFO  ---RUNTIME: Plan generation took 0.10418891906738281 ms
2022-09-21 19:27:40 INFO  Estimated runtime of original DAG is 9560.054302215576ms
2022-09-21 19:27:40 INFO  Performing Multi-Query Optimization
2022-09-21 19:27:40 INFO  Estimated unoptimized what-if runtime is 47800.27151107788ms
2022-09-21 19:27:40 INFO  Estimated optimised what-if runtime is 12676.196813583374ms
2022-09-21 19:27:40 INFO  Estimated optimisation runtime saving is 35124.07469749451ms
2022-09-21 19:27:40 INFO  ---RUNTIME: Multi-Query Optimization took 10.236740112304688 ms
2022-09-21 19:27:40 INFO  Executing generated plans
2022-09-21 19:27:53 INFO  ---RUNTIME: Execution took 12944.321393966675 ms
2022-09-21 19:27:53 INFO  Done!
2022-09-21 19:27:53 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-21 19:27:53 INFO  Running instrumented original pipeline...
2022-09-21 19:27:53 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-21 19:27:53 INFO  ---RUNTIME: Importing and monkey-patching took 6.1626434326171875 ms
2022-09-21 19:28:04 INFO  ---RUNTIME: Original pipeline execution took 11182.534456253052 ms (excluding imports and monkey-patching)
2022-09-21 19:28:04 INFO  Starting execution of 1 what-if analyses...
2022-09-21 19:28:04 INFO  Start plan generation for analysis PermutationFeatureImportance...
2022-09-21 19:28:04 INFO  ---RUNTIME: Plan generation took 0.1163482666015625 ms
2022-09-21 19:28:04 INFO  Estimated runtime of original DAG is 8933.295249938965ms
2022-09-21 19:28:04 WARNING Skipping Multi-Query Optimization (instead, only applying patches)
2022-09-21 19:28:04 INFO  Estimated unoptimised what-if runtime is 44666.476249694824ms
2022-09-21 19:28:04 INFO  ---RUNTIME: Multi-Query Optimization took 3.799915313720703 ms
2022-09-21 19:28:04 INFO  Executing generated plans
2022-09-21 19:28:54 INFO  ---RUNTIME: Execution took 49971.76504135132 ms
2022-09-21 19:28:54 INFO  Done!
2022-09-21 19:28:54 INFO  # Finished -- repetition 5 of 7 
2022-09-21 19:28:54 INFO  # Optimization benchmark for feature_importance with args [['reviews', 'slow_loading', 'featurization_1', 'neural_network']] -- repetition 6 of 7
2022-09-21 19:28:54 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-21 19:28:54 INFO  Running instrumented original pipeline...
2022-09-21 19:28:54 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-21 19:28:54 INFO  ---RUNTIME: Importing and monkey-patching took 6.089448928833008 ms
2022-09-21 19:29:05 INFO  ---RUNTIME: Original pipeline execution took 11358.71434211731 ms (excluding imports and monkey-patching)
2022-09-21 19:29:05 INFO  Starting execution of 1 what-if analyses...
2022-09-21 19:29:05 INFO  Start plan generation for analysis PermutationFeatureImportance...
2022-09-21 19:29:05 INFO  ---RUNTIME: Plan generation took 0.11396408081054688 ms
2022-09-21 19:29:05 INFO  Estimated runtime of original DAG is 9047.119617462158ms
2022-09-21 19:29:05 INFO  Performing Multi-Query Optimization
2022-09-21 19:29:05 INFO  Estimated unoptimized what-if runtime is 45235.59808731079ms
2022-09-21 19:29:05 INFO  Estimated optimised what-if runtime is 12007.673978805542ms
2022-09-21 19:29:05 INFO  Estimated optimisation runtime saving is 33227.92410850525ms
2022-09-21 19:29:05 INFO  ---RUNTIME: Multi-Query Optimization took 9.734869003295898 ms
2022-09-21 19:29:05 INFO  Executing generated plans
2022-09-21 19:29:19 INFO  ---RUNTIME: Execution took 13626.42502784729 ms
2022-09-21 19:29:19 INFO  Done!
2022-09-21 19:29:19 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-21 19:29:19 INFO  Running instrumented original pipeline...
2022-09-21 19:29:19 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-21 19:29:19 INFO  ---RUNTIME: Importing and monkey-patching took 6.397008895874023 ms
2022-09-21 19:29:31 INFO  ---RUNTIME: Original pipeline execution took 12089.787244796753 ms (excluding imports and monkey-patching)
2022-09-21 19:29:31 INFO  Starting execution of 1 what-if analyses...
2022-09-21 19:29:31 INFO  Start plan generation for analysis PermutationFeatureImportance...
2022-09-21 19:29:31 INFO  ---RUNTIME: Plan generation took 0.13828277587890625 ms
2022-09-21 19:29:31 INFO  Estimated runtime of original DAG is 9658.371210098267ms
2022-09-21 19:29:31 WARNING Skipping Multi-Query Optimization (instead, only applying patches)
2022-09-21 19:29:31 INFO  Estimated unoptimised what-if runtime is 48291.85605049133ms
2022-09-21 19:29:31 INFO  ---RUNTIME: Multi-Query Optimization took 5.586385726928711 ms
2022-09-21 19:29:31 INFO  Executing generated plans
2022-09-21 19:30:20 INFO  ---RUNTIME: Execution took 49551.65600776672 ms
2022-09-21 19:30:20 INFO  Done!
2022-09-21 19:30:20 INFO  # Finished -- repetition 6 of 7 
2022-09-21 19:30:20 INFO  # Optimization benchmark for feature_importance with args [['reviews', 'slow_loading', 'featurization_1', 'neural_network']] -- repetition 7 of 7
2022-09-21 19:30:20 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-21 19:30:20 INFO  Running instrumented original pipeline...
2022-09-21 19:30:20 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-21 19:30:20 INFO  ---RUNTIME: Importing and monkey-patching took 6.139039993286133 ms
2022-09-21 19:30:32 INFO  ---RUNTIME: Original pipeline execution took 11701.828479766846 ms (excluding imports and monkey-patching)
2022-09-21 19:30:32 INFO  Starting execution of 1 what-if analyses...
2022-09-21 19:30:32 INFO  Start plan generation for analysis PermutationFeatureImportance...
2022-09-21 19:30:32 INFO  ---RUNTIME: Plan generation took 0.09822845458984375 ms
2022-09-21 19:30:32 INFO  Estimated runtime of original DAG is 8921.37885093689ms
2022-09-21 19:30:32 INFO  Performing Multi-Query Optimization
2022-09-21 19:30:32 INFO  Estimated unoptimized what-if runtime is 44606.89425468445ms
2022-09-21 19:30:32 INFO  Estimated optimised what-if runtime is 11843.346118927002ms
2022-09-21 19:30:32 INFO  Estimated optimisation runtime saving is 32763.548135757446ms
2022-09-21 19:30:32 INFO  ---RUNTIME: Multi-Query Optimization took 9.563922882080078 ms
2022-09-21 19:30:32 INFO  Executing generated plans
2022-09-21 19:30:45 INFO  ---RUNTIME: Execution took 13093.957424163818 ms
2022-09-21 19:30:45 INFO  Done!
2022-09-21 19:30:45 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-21 19:30:45 INFO  Running instrumented original pipeline...
2022-09-21 19:30:45 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-21 19:30:45 INFO  ---RUNTIME: Importing and monkey-patching took 6.380319595336914 ms
2022-09-21 19:30:56 INFO  ---RUNTIME: Original pipeline execution took 11161.153316497803 ms (excluding imports and monkey-patching)
2022-09-21 19:30:56 INFO  Starting execution of 1 what-if analyses...
2022-09-21 19:30:56 INFO  Start plan generation for analysis PermutationFeatureImportance...
2022-09-21 19:30:56 INFO  ---RUNTIME: Plan generation took 0.1316070556640625 ms
2022-09-21 19:30:56 INFO  Estimated runtime of original DAG is 8888.601779937744ms
2022-09-21 19:30:56 WARNING Skipping Multi-Query Optimization (instead, only applying patches)
2022-09-21 19:30:56 INFO  Estimated unoptimised what-if runtime is 44443.00889968872ms
2022-09-21 19:30:56 INFO  ---RUNTIME: Multi-Query Optimization took 3.835916519165039 ms
2022-09-21 19:30:56 INFO  Executing generated plans
2022-09-21 19:31:48 INFO  ---RUNTIME: Execution took 51264.97745513916 ms
2022-09-21 19:31:48 INFO  Done!
2022-09-21 19:31:48 INFO  # Finished -- repetition 7 of 7 
2022-09-21 19:31:48 INFO  # Final results after all repetitions
2022-09-21 19:31:48 INFO     repetition  ... no_opt_what_if_execution_combined_model_training
0           0  ...                                     17991.438389
1           1  ...                                     17457.718134
2           2  ...                                     16818.214655
3           3  ...                                     16457.798004
4           4  ...                                     16411.195040
5           5  ...                                     16100.691557
6           6  ...                                     17417.415619

[7 rows x 26 columns]
taskset -c 32-39 PROTOCOL_BUFFERS_PYTHON_IMPLEMENTATION=python python3.9 benchmarks_end_to_end.py feature_importance reviews slow_loading featurization_2 logistic_regression
2022-09-21 19:31:50.574845: W tensorflow/stream_executor/platform/default/dso_loader.cc:64] Could not load dynamic library 'libcudart.so.11.0'; dlerror: libcudart.so.11.0: cannot open shared object file: No such file or directory; LD_LIBRARY_PATH: /home/sgrafbe/mlwhatif/venv/lib/python3.9/site-packages/cv2/../../lib64:
2022-09-21 19:31:50.574891: I tensorflow/stream_executor/cuda/cudart_stub.cc:29] Ignore above cudart dlerror if you do not have a GPU set up on your machine.
2022-09-21 19:31:51 INFO  Patching sys.argv with ['mlwhatif', 'reviews', 'slow_loading', 'featurization_2', 'logistic_regression']
2022-09-21 19:31:51 INFO  Running instrumented original pipeline...
2022-09-21 19:31:51 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-21 19:31:52 INFO  ---RUNTIME: Importing and monkey-patching took 96.55618667602539 ms
2022-09-21 19:31:59 INFO  ---RUNTIME: Original pipeline execution took 7165.539741516113 ms (excluding imports and monkey-patching)
2022-09-21 19:31:59 INFO  Starting execution of 0 what-if analyses...
2022-09-21 19:31:59 INFO  Estimated runtime of original DAG is 5949.3536949157715ms
2022-09-21 19:31:59 INFO  Performing Multi-Query Optimization
2022-09-21 19:31:59 INFO  Estimated unoptimized what-if runtime is 0ms
2022-09-21 19:31:59 INFO  Estimated optimised what-if runtime is 0ms
2022-09-21 19:31:59 INFO  Estimated optimisation runtime saving is 0ms
2022-09-21 19:31:59 INFO  ---RUNTIME: Multi-Query Optimization took 0.6473064422607422 ms
2022-09-21 19:31:59 INFO  Executing generated plans
2022-09-21 19:31:59 INFO  ---RUNTIME: Execution took 0.02574920654296875 ms
2022-09-21 19:31:59 INFO  Done!
2022-09-21 19:31:59 INFO  # Optimization benchmark for feature_importance with args [['reviews', 'slow_loading', 'featurization_2', 'logistic_regression']] -- repetition 1 of 7
2022-09-21 19:31:59 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-21 19:31:59 INFO  Running instrumented original pipeline...
2022-09-21 19:31:59 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-21 19:31:59 INFO  ---RUNTIME: Importing and monkey-patching took 6.295204162597656 ms
2022-09-21 19:32:06 INFO  ---RUNTIME: Original pipeline execution took 7299.109935760498 ms (excluding imports and monkey-patching)
2022-09-21 19:32:06 INFO  Starting execution of 1 what-if analyses...
2022-09-21 19:32:06 INFO  Start plan generation for analysis PermutationFeatureImportance...
2022-09-21 19:32:06 INFO  ---RUNTIME: Plan generation took 0.2231597900390625 ms
2022-09-21 19:32:06 INFO  Estimated runtime of original DAG is 6067.617177963257ms
2022-09-21 19:32:06 INFO  Performing Multi-Query Optimization
2022-09-21 19:32:06 INFO  Estimated unoptimized what-if runtime is 30338.085889816284ms
2022-09-21 19:32:06 INFO  Estimated optimised what-if runtime is 7638.588190078735ms
2022-09-21 19:32:06 INFO  Estimated optimisation runtime saving is 22699.49769973755ms
2022-09-21 19:32:06 INFO  ---RUNTIME: Multi-Query Optimization took 10.845422744750977 ms
2022-09-21 19:32:06 INFO  Executing generated plans
2022-09-21 19:32:15 INFO  ---RUNTIME: Execution took 8642.790079116821 ms
2022-09-21 19:32:15 INFO  Done!
2022-09-21 19:32:15 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-21 19:32:15 INFO  Running instrumented original pipeline...
2022-09-21 19:32:15 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-21 19:32:15 INFO  ---RUNTIME: Importing and monkey-patching took 5.75566291809082 ms
2022-09-21 19:32:22 INFO  ---RUNTIME: Original pipeline execution took 7529.285907745361 ms (excluding imports and monkey-patching)
2022-09-21 19:32:22 INFO  Starting execution of 1 what-if analyses...
2022-09-21 19:32:22 INFO  Start plan generation for analysis PermutationFeatureImportance...
2022-09-21 19:32:22 INFO  ---RUNTIME: Plan generation took 0.11849403381347656 ms
2022-09-21 19:32:22 INFO  Estimated runtime of original DAG is 6158.46586227417ms
2022-09-21 19:32:22 WARNING Skipping Multi-Query Optimization (instead, only applying patches)
2022-09-21 19:32:22 INFO  Estimated unoptimised what-if runtime is 30792.32931137085ms
2022-09-21 19:32:22 INFO  ---RUNTIME: Multi-Query Optimization took 4.375696182250977 ms
2022-09-21 19:32:22 INFO  Executing generated plans
2022-09-21 19:32:57 INFO  ---RUNTIME: Execution took 34929.359912872314 ms
2022-09-21 19:32:57 INFO  Done!
2022-09-21 19:32:57 INFO  # Finished -- repetition 1 of 7 
2022-09-21 19:32:57 INFO  # Optimization benchmark for feature_importance with args [['reviews', 'slow_loading', 'featurization_2', 'logistic_regression']] -- repetition 2 of 7
2022-09-21 19:32:57 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-21 19:32:57 INFO  Running instrumented original pipeline...
2022-09-21 19:32:57 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-21 19:32:57 INFO  ---RUNTIME: Importing and monkey-patching took 6.26683235168457 ms
2022-09-21 19:33:05 INFO  ---RUNTIME: Original pipeline execution took 7615.279912948608 ms (excluding imports and monkey-patching)
2022-09-21 19:33:05 INFO  Starting execution of 1 what-if analyses...
2022-09-21 19:33:05 INFO  Start plan generation for analysis PermutationFeatureImportance...
2022-09-21 19:33:05 INFO  ---RUNTIME: Plan generation took 0.13589859008789062 ms
2022-09-21 19:33:05 INFO  Estimated runtime of original DAG is 6331.2249183654785ms
2022-09-21 19:33:05 INFO  Performing Multi-Query Optimization
2022-09-21 19:33:05 INFO  Estimated unoptimized what-if runtime is 31656.124591827393ms
2022-09-21 19:33:05 INFO  Estimated optimised what-if runtime is 8020.935535430908ms
2022-09-21 19:33:05 INFO  Estimated optimisation runtime saving is 23635.189056396484ms
2022-09-21 19:33:05 INFO  ---RUNTIME: Multi-Query Optimization took 11.540651321411133 ms
2022-09-21 19:33:05 INFO  Executing generated plans
2022-09-21 19:33:13 INFO  ---RUNTIME: Execution took 8547.158241271973 ms
2022-09-21 19:33:13 INFO  Done!
2022-09-21 19:33:13 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-21 19:33:13 INFO  Running instrumented original pipeline...
2022-09-21 19:33:13 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-21 19:33:13 INFO  ---RUNTIME: Importing and monkey-patching took 6.430149078369141 ms
2022-09-21 19:33:21 INFO  ---RUNTIME: Original pipeline execution took 7281.0704708099365 ms (excluding imports and monkey-patching)
2022-09-21 19:33:21 INFO  Starting execution of 1 what-if analyses...
2022-09-21 19:33:21 INFO  Start plan generation for analysis PermutationFeatureImportance...
2022-09-21 19:33:21 INFO  ---RUNTIME: Plan generation took 0.09894371032714844 ms
2022-09-21 19:33:21 INFO  Estimated runtime of original DAG is 6059.193134307861ms
2022-09-21 19:33:21 WARNING Skipping Multi-Query Optimization (instead, only applying patches)
2022-09-21 19:33:21 INFO  Estimated unoptimised what-if runtime is 30295.965671539307ms
2022-09-21 19:33:21 INFO  ---RUNTIME: Multi-Query Optimization took 4.097938537597656 ms
2022-09-21 19:33:21 INFO  Executing generated plans
2022-09-21 19:33:56 INFO  ---RUNTIME: Execution took 34928.799629211426 ms
2022-09-21 19:33:56 INFO  Done!
2022-09-21 19:33:56 INFO  # Finished -- repetition 2 of 7 
2022-09-21 19:33:56 INFO  # Optimization benchmark for feature_importance with args [['reviews', 'slow_loading', 'featurization_2', 'logistic_regression']] -- repetition 3 of 7
2022-09-21 19:33:56 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-21 19:33:56 INFO  Running instrumented original pipeline...
2022-09-21 19:33:56 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-21 19:33:56 INFO  ---RUNTIME: Importing and monkey-patching took 7.110595703125 ms
2022-09-21 19:34:03 INFO  ---RUNTIME: Original pipeline execution took 7239.188194274902 ms (excluding imports and monkey-patching)
2022-09-21 19:34:03 INFO  Starting execution of 1 what-if analyses...
2022-09-21 19:34:03 INFO  Start plan generation for analysis PermutationFeatureImportance...
2022-09-21 19:34:03 INFO  ---RUNTIME: Plan generation took 0.1239776611328125 ms
2022-09-21 19:34:03 INFO  Estimated runtime of original DAG is 6029.703378677368ms
2022-09-21 19:34:03 INFO  Performing Multi-Query Optimization
2022-09-21 19:34:03 INFO  Estimated unoptimized what-if runtime is 30148.51689338684ms
2022-09-21 19:34:03 INFO  Estimated optimised what-if runtime is 7599.236488342285ms
2022-09-21 19:34:03 INFO  Estimated optimisation runtime saving is 22549.280405044556ms
2022-09-21 19:34:03 INFO  ---RUNTIME: Multi-Query Optimization took 10.61701774597168 ms
2022-09-21 19:34:03 INFO  Executing generated plans
2022-09-21 19:34:12 INFO  ---RUNTIME: Execution took 9279.15620803833 ms
2022-09-21 19:34:12 INFO  Done!
2022-09-21 19:34:12 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-21 19:34:12 INFO  Running instrumented original pipeline...
2022-09-21 19:34:12 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-21 19:34:12 INFO  ---RUNTIME: Importing and monkey-patching took 5.702972412109375 ms
2022-09-21 19:34:19 INFO  ---RUNTIME: Original pipeline execution took 7192.368268966675 ms (excluding imports and monkey-patching)
2022-09-21 19:34:19 INFO  Starting execution of 1 what-if analyses...
2022-09-21 19:34:19 INFO  Start plan generation for analysis PermutationFeatureImportance...
2022-09-21 19:34:19 INFO  ---RUNTIME: Plan generation took 0.10418891906738281 ms
2022-09-21 19:34:19 INFO  Estimated runtime of original DAG is 5991.90354347229ms
2022-09-21 19:34:19 WARNING Skipping Multi-Query Optimization (instead, only applying patches)
2022-09-21 19:34:19 INFO  Estimated unoptimised what-if runtime is 29959.51771736145ms
2022-09-21 19:34:19 INFO  ---RUNTIME: Multi-Query Optimization took 4.095315933227539 ms
2022-09-21 19:34:19 INFO  Executing generated plans
2022-09-21 19:34:53 INFO  ---RUNTIME: Execution took 33942.506074905396 ms
2022-09-21 19:34:53 INFO  Done!
2022-09-21 19:34:53 INFO  # Finished -- repetition 3 of 7 
2022-09-21 19:34:53 INFO  # Optimization benchmark for feature_importance with args [['reviews', 'slow_loading', 'featurization_2', 'logistic_regression']] -- repetition 4 of 7
2022-09-21 19:34:53 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-21 19:34:53 INFO  Running instrumented original pipeline...
2022-09-21 19:34:53 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-21 19:34:53 INFO  ---RUNTIME: Importing and monkey-patching took 5.965948104858398 ms
2022-09-21 19:35:00 INFO  ---RUNTIME: Original pipeline execution took 7156.176805496216 ms (excluding imports and monkey-patching)
2022-09-21 19:35:00 INFO  Starting execution of 1 what-if analyses...
2022-09-21 19:35:00 INFO  Start plan generation for analysis PermutationFeatureImportance...
2022-09-21 19:35:00 INFO  ---RUNTIME: Plan generation took 0.13518333435058594 ms
2022-09-21 19:35:00 INFO  Estimated runtime of original DAG is 5953.436613082886ms
2022-09-21 19:35:00 INFO  Performing Multi-Query Optimization
2022-09-21 19:35:00 INFO  Estimated unoptimized what-if runtime is 29767.18306541443ms
2022-09-21 19:35:00 INFO  Estimated optimised what-if runtime is 7533.03074836731ms
2022-09-21 19:35:00 INFO  Estimated optimisation runtime saving is 22234.15231704712ms
2022-09-21 19:35:00 INFO  ---RUNTIME: Multi-Query Optimization took 10.77127456665039 ms
2022-09-21 19:35:00 INFO  Executing generated plans
2022-09-21 19:35:09 INFO  ---RUNTIME: Execution took 8400.850057601929 ms
2022-09-21 19:35:09 INFO  Done!
2022-09-21 19:35:09 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-21 19:35:09 INFO  Running instrumented original pipeline...
2022-09-21 19:35:09 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-21 19:35:09 INFO  ---RUNTIME: Importing and monkey-patching took 5.622148513793945 ms
2022-09-21 19:35:16 INFO  ---RUNTIME: Original pipeline execution took 7489.372491836548 ms (excluding imports and monkey-patching)
2022-09-21 19:35:16 INFO  Starting execution of 1 what-if analyses...
2022-09-21 19:35:16 INFO  Start plan generation for analysis PermutationFeatureImportance...
2022-09-21 19:35:16 INFO  ---RUNTIME: Plan generation took 0.10466575622558594 ms
2022-09-21 19:35:16 INFO  Estimated runtime of original DAG is 6277.457237243652ms
2022-09-21 19:35:16 WARNING Skipping Multi-Query Optimization (instead, only applying patches)
2022-09-21 19:35:16 INFO  Estimated unoptimised what-if runtime is 31387.28618621826ms
2022-09-21 19:35:16 INFO  ---RUNTIME: Multi-Query Optimization took 4.110813140869141 ms
2022-09-21 19:35:16 INFO  Executing generated plans
2022-09-21 19:35:52 INFO  ---RUNTIME: Execution took 35766.55626296997 ms
2022-09-21 19:35:52 INFO  Done!
2022-09-21 19:35:52 INFO  # Finished -- repetition 4 of 7 
2022-09-21 19:35:52 INFO  # Optimization benchmark for feature_importance with args [['reviews', 'slow_loading', 'featurization_2', 'logistic_regression']] -- repetition 5 of 7
2022-09-21 19:35:52 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-21 19:35:52 INFO  Running instrumented original pipeline...
2022-09-21 19:35:52 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-21 19:35:52 INFO  ---RUNTIME: Importing and monkey-patching took 5.809307098388672 ms
2022-09-21 19:35:59 INFO  ---RUNTIME: Original pipeline execution took 7208.397626876831 ms (excluding imports and monkey-patching)
2022-09-21 19:35:59 INFO  Starting execution of 1 what-if analyses...
2022-09-21 19:35:59 INFO  Start plan generation for analysis PermutationFeatureImportance...
2022-09-21 19:35:59 INFO  ---RUNTIME: Plan generation took 0.1068115234375 ms
2022-09-21 19:35:59 INFO  Estimated runtime of original DAG is 5992.013216018677ms
2022-09-21 19:35:59 INFO  Performing Multi-Query Optimization
2022-09-21 19:35:59 INFO  Estimated unoptimized what-if runtime is 29960.066080093384ms
2022-09-21 19:35:59 INFO  Estimated optimised what-if runtime is 7566.090822219849ms
2022-09-21 19:35:59 INFO  Estimated optimisation runtime saving is 22393.975257873535ms
2022-09-21 19:35:59 INFO  ---RUNTIME: Multi-Query Optimization took 10.67972183227539 ms
2022-09-21 19:35:59 INFO  Executing generated plans
2022-09-21 19:36:08 INFO  ---RUNTIME: Execution took 8481.001615524292 ms
2022-09-21 19:36:08 INFO  Done!
2022-09-21 19:36:08 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-21 19:36:08 INFO  Running instrumented original pipeline...
2022-09-21 19:36:08 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-21 19:36:08 INFO  ---RUNTIME: Importing and monkey-patching took 5.876064300537109 ms
2022-09-21 19:36:15 INFO  ---RUNTIME: Original pipeline execution took 7280.636310577393 ms (excluding imports and monkey-patching)
2022-09-21 19:36:15 INFO  Starting execution of 1 what-if analyses...
2022-09-21 19:36:15 INFO  Start plan generation for analysis PermutationFeatureImportance...
2022-09-21 19:36:15 INFO  ---RUNTIME: Plan generation took 0.12040138244628906 ms
2022-09-21 19:36:15 INFO  Estimated runtime of original DAG is 6067.539930343628ms
2022-09-21 19:36:15 WARNING Skipping Multi-Query Optimization (instead, only applying patches)
2022-09-21 19:36:15 INFO  Estimated unoptimised what-if runtime is 30337.69965171814ms
2022-09-21 19:36:15 INFO  ---RUNTIME: Multi-Query Optimization took 4.18543815612793 ms
2022-09-21 19:36:15 INFO  Executing generated plans
2022-09-21 19:36:51 INFO  ---RUNTIME: Execution took 36121.10447883606 ms
2022-09-21 19:36:51 INFO  Done!
2022-09-21 19:36:51 INFO  # Finished -- repetition 5 of 7 
2022-09-21 19:36:51 INFO  # Optimization benchmark for feature_importance with args [['reviews', 'slow_loading', 'featurization_2', 'logistic_regression']] -- repetition 6 of 7
2022-09-21 19:36:51 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-21 19:36:51 INFO  Running instrumented original pipeline...
2022-09-21 19:36:51 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-21 19:36:51 INFO  ---RUNTIME: Importing and monkey-patching took 5.8689117431640625 ms
2022-09-21 19:36:59 INFO  ---RUNTIME: Original pipeline execution took 7620.7263469696045 ms (excluding imports and monkey-patching)
2022-09-21 19:36:59 INFO  Starting execution of 1 what-if analyses...
2022-09-21 19:36:59 INFO  Start plan generation for analysis PermutationFeatureImportance...
2022-09-21 19:36:59 INFO  ---RUNTIME: Plan generation took 0.10609626770019531 ms
2022-09-21 19:36:59 INFO  Estimated runtime of original DAG is 6399.586915969849ms
2022-09-21 19:36:59 INFO  Performing Multi-Query Optimization
2022-09-21 19:36:59 INFO  Estimated unoptimized what-if runtime is 31997.934579849243ms
2022-09-21 19:36:59 INFO  Estimated optimised what-if runtime is 7978.5826206207275ms
2022-09-21 19:36:59 INFO  Estimated optimisation runtime saving is 24019.351959228516ms
2022-09-21 19:36:59 INFO  ---RUNTIME: Multi-Query Optimization took 10.651826858520508 ms
2022-09-21 19:36:59 INFO  Executing generated plans
2022-09-21 19:37:07 INFO  ---RUNTIME: Execution took 8500.677108764648 ms
2022-09-21 19:37:07 INFO  Done!
2022-09-21 19:37:07 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-21 19:37:07 INFO  Running instrumented original pipeline...
2022-09-21 19:37:07 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-21 19:37:07 INFO  ---RUNTIME: Importing and monkey-patching took 5.581378936767578 ms
2022-09-21 19:37:15 INFO  ---RUNTIME: Original pipeline execution took 7256.611108779907 ms (excluding imports and monkey-patching)
2022-09-21 19:37:15 INFO  Starting execution of 1 what-if analyses...
2022-09-21 19:37:15 INFO  Start plan generation for analysis PermutationFeatureImportance...
2022-09-21 19:37:15 INFO  ---RUNTIME: Plan generation took 0.12922286987304688 ms
2022-09-21 19:37:15 INFO  Estimated runtime of original DAG is 6041.260242462158ms
2022-09-21 19:37:15 WARNING Skipping Multi-Query Optimization (instead, only applying patches)
2022-09-21 19:37:15 INFO  Estimated unoptimised what-if runtime is 30206.30121231079ms
2022-09-21 19:37:15 INFO  ---RUNTIME: Multi-Query Optimization took 4.230499267578125 ms
2022-09-21 19:37:15 INFO  Executing generated plans
2022-09-21 19:37:50 INFO  ---RUNTIME: Execution took 35183.64453315735 ms
2022-09-21 19:37:50 INFO  Done!
2022-09-21 19:37:50 INFO  # Finished -- repetition 6 of 7 
2022-09-21 19:37:50 INFO  # Optimization benchmark for feature_importance with args [['reviews', 'slow_loading', 'featurization_2', 'logistic_regression']] -- repetition 7 of 7
2022-09-21 19:37:50 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-21 19:37:50 INFO  Running instrumented original pipeline...
2022-09-21 19:37:50 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-21 19:37:50 INFO  ---RUNTIME: Importing and monkey-patching took 5.808830261230469 ms
2022-09-21 19:37:57 INFO  ---RUNTIME: Original pipeline execution took 7157.306671142578 ms (excluding imports and monkey-patching)
2022-09-21 19:37:57 INFO  Starting execution of 1 what-if analyses...
2022-09-21 19:37:57 INFO  Start plan generation for analysis PermutationFeatureImportance...
2022-09-21 19:37:57 INFO  ---RUNTIME: Plan generation took 0.10609626770019531 ms
2022-09-21 19:37:57 INFO  Estimated runtime of original DAG is 5937.829256057739ms
2022-09-21 19:37:57 INFO  Performing Multi-Query Optimization
2022-09-21 19:37:57 INFO  Estimated unoptimized what-if runtime is 29689.146280288696ms
2022-09-21 19:37:57 INFO  Estimated optimised what-if runtime is 7521.646738052368ms
2022-09-21 19:37:57 INFO  Estimated optimisation runtime saving is 22167.499542236328ms
2022-09-21 19:37:57 INFO  ---RUNTIME: Multi-Query Optimization took 10.598182678222656 ms
2022-09-21 19:37:57 INFO  Executing generated plans
2022-09-21 19:38:05 INFO  ---RUNTIME: Execution took 8442.991733551025 ms
2022-09-21 19:38:05 INFO  Done!
2022-09-21 19:38:05 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-21 19:38:05 INFO  Running instrumented original pipeline...
2022-09-21 19:38:06 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-21 19:38:06 INFO  ---RUNTIME: Importing and monkey-patching took 5.721569061279297 ms
2022-09-21 19:38:13 INFO  ---RUNTIME: Original pipeline execution took 7141.857862472534 ms (excluding imports and monkey-patching)
2022-09-21 19:38:13 INFO  Starting execution of 1 what-if analyses...
2022-09-21 19:38:13 INFO  Start plan generation for analysis PermutationFeatureImportance...
2022-09-21 19:38:13 INFO  ---RUNTIME: Plan generation took 0.1304149627685547 ms
2022-09-21 19:38:13 INFO  Estimated runtime of original DAG is 5925.663232803345ms
2022-09-21 19:38:13 WARNING Skipping Multi-Query Optimization (instead, only applying patches)
2022-09-21 19:38:13 INFO  Estimated unoptimised what-if runtime is 29628.316164016724ms
2022-09-21 19:38:13 INFO  ---RUNTIME: Multi-Query Optimization took 4.163265228271484 ms
2022-09-21 19:38:13 INFO  Executing generated plans
2022-09-21 19:38:47 INFO  ---RUNTIME: Execution took 34140.215158462524 ms
2022-09-21 19:38:47 INFO  Done!
2022-09-21 19:38:47 INFO  # Finished -- repetition 7 of 7 
2022-09-21 19:38:47 INFO  # Final results after all repetitions
2022-09-21 19:38:47 INFO     repetition  ... no_opt_what_if_execution_combined_model_training
0           0  ...                                       534.512043
1           1  ...                                       542.205811
2           2  ...                                       497.351646
3           3  ...                                       493.440866
4           4  ...                                       487.562180
5           5  ...                                       493.526220
6           6  ...                                       504.513264

[7 rows x 26 columns]
taskset -c 32-39 PROTOCOL_BUFFERS_PYTHON_IMPLEMENTATION=python python3.9 benchmarks_end_to_end.py feature_importance reviews slow_loading featurization_2 xgboost
2022-09-21 19:38:49.422051: W tensorflow/stream_executor/platform/default/dso_loader.cc:64] Could not load dynamic library 'libcudart.so.11.0'; dlerror: libcudart.so.11.0: cannot open shared object file: No such file or directory; LD_LIBRARY_PATH: /home/sgrafbe/mlwhatif/venv/lib/python3.9/site-packages/cv2/../../lib64:
2022-09-21 19:38:49.422093: I tensorflow/stream_executor/cuda/cudart_stub.cc:29] Ignore above cudart dlerror if you do not have a GPU set up on your machine.
2022-09-21 19:38:50 INFO  Patching sys.argv with ['mlwhatif', 'reviews', 'slow_loading', 'featurization_2', 'xgboost']
2022-09-21 19:38:50 INFO  Running instrumented original pipeline...
2022-09-21 19:38:50 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-21 19:38:50 INFO  ---RUNTIME: Importing and monkey-patching took 94.5587158203125 ms
2022-09-21 19:39:12 INFO  ---RUNTIME: Original pipeline execution took 21383.12578201294 ms (excluding imports and monkey-patching)
2022-09-21 19:39:12 INFO  Starting execution of 0 what-if analyses...
2022-09-21 19:39:12 INFO  Estimated runtime of original DAG is 20166.14079475403ms
2022-09-21 19:39:12 INFO  Performing Multi-Query Optimization
2022-09-21 19:39:12 INFO  Estimated unoptimized what-if runtime is 0ms
2022-09-21 19:39:12 INFO  Estimated optimised what-if runtime is 0ms
2022-09-21 19:39:12 INFO  Estimated optimisation runtime saving is 0ms
2022-09-21 19:39:12 INFO  ---RUNTIME: Multi-Query Optimization took 0.5433559417724609 ms
2022-09-21 19:39:12 INFO  Executing generated plans
2022-09-21 19:39:12 INFO  ---RUNTIME: Execution took 0.025987625122070312 ms
2022-09-21 19:39:12 INFO  Done!
2022-09-21 19:39:12 INFO  # Optimization benchmark for feature_importance with args [['reviews', 'slow_loading', 'featurization_2', 'xgboost']] -- repetition 1 of 7
2022-09-21 19:39:12 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-21 19:39:12 INFO  Running instrumented original pipeline...
2022-09-21 19:39:12 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-21 19:39:12 INFO  ---RUNTIME: Importing and monkey-patching took 5.4531097412109375 ms
2022-09-21 19:39:32 INFO  ---RUNTIME: Original pipeline execution took 20344.619750976562 ms (excluding imports and monkey-patching)
2022-09-21 19:39:32 INFO  Starting execution of 1 what-if analyses...
2022-09-21 19:39:32 INFO  Start plan generation for analysis PermutationFeatureImportance...
2022-09-21 19:39:32 INFO  ---RUNTIME: Plan generation took 0.21600723266601562 ms
2022-09-21 19:39:32 INFO  Estimated runtime of original DAG is 19168.663024902344ms
2022-09-21 19:39:32 INFO  Performing Multi-Query Optimization
2022-09-21 19:39:32 INFO  Estimated unoptimized what-if runtime is 95843.31512451172ms
2022-09-21 19:39:32 INFO  Estimated optimised what-if runtime is 20978.40976715088ms
2022-09-21 19:39:32 INFO  Estimated optimisation runtime saving is 74864.90535736084ms
2022-09-21 19:39:32 INFO  ---RUNTIME: Multi-Query Optimization took 10.858774185180664 ms
2022-09-21 19:39:32 INFO  Executing generated plans
2022-09-21 19:39:54 INFO  ---RUNTIME: Execution took 21664.58821296692 ms
2022-09-21 19:39:54 INFO  Done!
2022-09-21 19:39:54 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-21 19:39:54 INFO  Running instrumented original pipeline...
2022-09-21 19:39:54 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-21 19:39:54 INFO  ---RUNTIME: Importing and monkey-patching took 5.942106246948242 ms
2022-09-21 19:40:14 INFO  ---RUNTIME: Original pipeline execution took 20081.51602745056 ms (excluding imports and monkey-patching)
2022-09-21 19:40:14 INFO  Starting execution of 1 what-if analyses...
2022-09-21 19:40:14 INFO  Start plan generation for analysis PermutationFeatureImportance...
2022-09-21 19:40:14 INFO  ---RUNTIME: Plan generation took 0.14019012451171875 ms
2022-09-21 19:40:14 INFO  Estimated runtime of original DAG is 18732.5758934021ms
2022-09-21 19:40:14 WARNING Skipping Multi-Query Optimization (instead, only applying patches)
2022-09-21 19:40:14 INFO  Estimated unoptimised what-if runtime is 93662.8794670105ms
2022-09-21 19:40:14 INFO  ---RUNTIME: Multi-Query Optimization took 4.203557968139648 ms
2022-09-21 19:40:14 INFO  Executing generated plans
2022-09-21 19:42:19 INFO  ---RUNTIME: Execution took 125352.3850440979 ms
2022-09-21 19:42:19 INFO  Done!
2022-09-21 19:42:19 INFO  # Finished -- repetition 1 of 7 
2022-09-21 19:42:19 INFO  # Optimization benchmark for feature_importance with args [['reviews', 'slow_loading', 'featurization_2', 'xgboost']] -- repetition 2 of 7
2022-09-21 19:42:19 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-21 19:42:19 INFO  Running instrumented original pipeline...
2022-09-21 19:42:19 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-21 19:42:19 INFO  ---RUNTIME: Importing and monkey-patching took 6.330966949462891 ms
2022-09-21 19:42:45 INFO  ---RUNTIME: Original pipeline execution took 26302.063703536987 ms (excluding imports and monkey-patching)
2022-09-21 19:42:45 INFO  Starting execution of 1 what-if analyses...
2022-09-21 19:42:45 INFO  Start plan generation for analysis PermutationFeatureImportance...
2022-09-21 19:42:45 INFO  ---RUNTIME: Plan generation took 0.15807151794433594 ms
2022-09-21 19:42:45 INFO  Estimated runtime of original DAG is 25113.664865493774ms
2022-09-21 19:42:45 INFO  Performing Multi-Query Optimization
2022-09-21 19:42:45 INFO  Estimated unoptimized what-if runtime is 125568.32432746887ms
2022-09-21 19:42:45 INFO  Estimated optimised what-if runtime is 26920.487642288208ms
2022-09-21 19:42:45 INFO  Estimated optimisation runtime saving is 98647.83668518066ms
2022-09-21 19:42:45 INFO  ---RUNTIME: Multi-Query Optimization took 10.616779327392578 ms
2022-09-21 19:42:45 INFO  Executing generated plans
2022-09-21 19:43:14 INFO  ---RUNTIME: Execution took 28142.632246017456 ms
2022-09-21 19:43:14 INFO  Done!
2022-09-21 19:43:14 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-21 19:43:14 INFO  Running instrumented original pipeline...
2022-09-21 19:43:14 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-21 19:43:14 INFO  ---RUNTIME: Importing and monkey-patching took 6.146430969238281 ms
2022-09-21 19:43:36 INFO  ---RUNTIME: Original pipeline execution took 22721.717357635498 ms (excluding imports and monkey-patching)
2022-09-21 19:43:36 INFO  Starting execution of 1 what-if analyses...
2022-09-21 19:43:36 INFO  Start plan generation for analysis PermutationFeatureImportance...
2022-09-21 19:43:36 INFO  ---RUNTIME: Plan generation took 0.14019012451171875 ms
2022-09-21 19:43:36 INFO  Estimated runtime of original DAG is 21509.27996635437ms
2022-09-21 19:43:36 WARNING Skipping Multi-Query Optimization (instead, only applying patches)
2022-09-21 19:43:36 INFO  Estimated unoptimised what-if runtime is 107546.39983177185ms
2022-09-21 19:43:36 INFO  ---RUNTIME: Multi-Query Optimization took 4.146337509155273 ms
2022-09-21 19:43:36 INFO  Executing generated plans
2022-09-21 19:45:43 INFO  ---RUNTIME: Execution took 126908.23483467102 ms
2022-09-21 19:45:43 INFO  Done!
2022-09-21 19:45:43 INFO  # Finished -- repetition 2 of 7 
2022-09-21 19:45:43 INFO  # Optimization benchmark for feature_importance with args [['reviews', 'slow_loading', 'featurization_2', 'xgboost']] -- repetition 3 of 7
2022-09-21 19:45:43 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-21 19:45:43 INFO  Running instrumented original pipeline...
2022-09-21 19:45:43 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-21 19:45:43 INFO  ---RUNTIME: Importing and monkey-patching took 6.475210189819336 ms
2022-09-21 19:46:09 INFO  ---RUNTIME: Original pipeline execution took 26091.69888496399 ms (excluding imports and monkey-patching)
2022-09-21 19:46:09 INFO  Starting execution of 1 what-if analyses...
2022-09-21 19:46:09 INFO  Start plan generation for analysis PermutationFeatureImportance...
2022-09-21 19:46:09 INFO  ---RUNTIME: Plan generation took 0.179290771484375 ms
2022-09-21 19:46:09 INFO  Estimated runtime of original DAG is 24653.873205184937ms
2022-09-21 19:46:09 INFO  Performing Multi-Query Optimization
2022-09-21 19:46:09 INFO  Estimated unoptimized what-if runtime is 123269.36602592468ms
2022-09-21 19:46:09 INFO  Estimated optimised what-if runtime is 27501.79386138916ms
2022-09-21 19:46:09 INFO  Estimated optimisation runtime saving is 95767.57216453552ms
2022-09-21 19:46:09 INFO  ---RUNTIME: Multi-Query Optimization took 16.932010650634766 ms
2022-09-21 19:46:09 INFO  Executing generated plans
2022-09-21 19:46:38 INFO  ---RUNTIME: Execution took 28920.697689056396 ms
2022-09-21 19:46:38 INFO  Done!
2022-09-21 19:46:38 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-21 19:46:38 INFO  Running instrumented original pipeline...
2022-09-21 19:46:38 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-21 19:46:38 INFO  ---RUNTIME: Importing and monkey-patching took 9.774208068847656 ms
2022-09-21 19:47:05 INFO  ---RUNTIME: Original pipeline execution took 26988.44337463379 ms (excluding imports and monkey-patching)
2022-09-21 19:47:05 INFO  Starting execution of 1 what-if analyses...
2022-09-21 19:47:05 INFO  Start plan generation for analysis PermutationFeatureImportance...
2022-09-21 19:47:05 INFO  ---RUNTIME: Plan generation took 0.1811981201171875 ms
2022-09-21 19:47:05 INFO  Estimated runtime of original DAG is 25167.309522628784ms
2022-09-21 19:47:05 WARNING Skipping Multi-Query Optimization (instead, only applying patches)
2022-09-21 19:47:05 INFO  Estimated unoptimised what-if runtime is 125836.54761314392ms
2022-09-21 19:47:05 INFO  ---RUNTIME: Multi-Query Optimization took 5.129098892211914 ms
2022-09-21 19:47:05 INFO  Executing generated plans
2022-09-21 19:49:09 INFO  ---RUNTIME: Execution took 123503.57985496521 ms
2022-09-21 19:49:09 INFO  Done!
2022-09-21 19:49:09 INFO  # Finished -- repetition 3 of 7 
2022-09-21 19:49:09 INFO  # Optimization benchmark for feature_importance with args [['reviews', 'slow_loading', 'featurization_2', 'xgboost']] -- repetition 4 of 7
2022-09-21 19:49:09 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-21 19:49:09 INFO  Running instrumented original pipeline...
2022-09-21 19:49:09 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-21 19:49:09 INFO  ---RUNTIME: Importing and monkey-patching took 6.244897842407227 ms
2022-09-21 19:49:33 INFO  ---RUNTIME: Original pipeline execution took 23865.139961242676 ms (excluding imports and monkey-patching)
2022-09-21 19:49:33 INFO  Starting execution of 1 what-if analyses...
2022-09-21 19:49:33 INFO  Start plan generation for analysis PermutationFeatureImportance...
2022-09-21 19:49:33 INFO  ---RUNTIME: Plan generation took 0.14543533325195312 ms
2022-09-21 19:49:33 INFO  Estimated runtime of original DAG is 22066.211462020874ms
2022-09-21 19:49:33 INFO  Performing Multi-Query Optimization
2022-09-21 19:49:33 INFO  Estimated unoptimized what-if runtime is 110331.05731010437ms
2022-09-21 19:49:33 INFO  Estimated optimised what-if runtime is 23865.792274475098ms
2022-09-21 19:49:33 INFO  Estimated optimisation runtime saving is 86465.26503562927ms
2022-09-21 19:49:33 INFO  ---RUNTIME: Multi-Query Optimization took 10.620594024658203 ms
2022-09-21 19:49:33 INFO  Executing generated plans
2022-09-21 19:49:59 INFO  ---RUNTIME: Execution took 26501.810789108276 ms
2022-09-21 19:49:59 INFO  Done!
2022-09-21 19:49:59 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-21 19:49:59 INFO  Running instrumented original pipeline...
2022-09-21 19:49:59 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-21 19:49:59 INFO  ---RUNTIME: Importing and monkey-patching took 5.718469619750977 ms
2022-09-21 19:50:23 INFO  ---RUNTIME: Original pipeline execution took 24217.865228652954 ms (excluding imports and monkey-patching)
2022-09-21 19:50:23 INFO  Starting execution of 1 what-if analyses...
2022-09-21 19:50:23 INFO  Start plan generation for analysis PermutationFeatureImportance...
2022-09-21 19:50:23 INFO  ---RUNTIME: Plan generation took 0.1468658447265625 ms
2022-09-21 19:50:23 INFO  Estimated runtime of original DAG is 22530.985116958618ms
2022-09-21 19:50:23 WARNING Skipping Multi-Query Optimization (instead, only applying patches)
2022-09-21 19:50:23 INFO  Estimated unoptimised what-if runtime is 112654.92558479309ms
2022-09-21 19:50:23 INFO  ---RUNTIME: Multi-Query Optimization took 4.127025604248047 ms
2022-09-21 19:50:23 INFO  Executing generated plans
2022-09-21 19:52:30 INFO  ---RUNTIME: Execution took 126865.03481864929 ms
2022-09-21 19:52:30 INFO  Done!
2022-09-21 19:52:30 INFO  # Finished -- repetition 4 of 7 
2022-09-21 19:52:30 INFO  # Optimization benchmark for feature_importance with args [['reviews', 'slow_loading', 'featurization_2', 'xgboost']] -- repetition 5 of 7
2022-09-21 19:52:30 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-21 19:52:30 INFO  Running instrumented original pipeline...
2022-09-21 19:52:30 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-21 19:52:30 INFO  ---RUNTIME: Importing and monkey-patching took 8.362531661987305 ms
2022-09-21 19:52:55 INFO  ---RUNTIME: Original pipeline execution took 24795.03560066223 ms (excluding imports and monkey-patching)
2022-09-21 19:52:55 INFO  Starting execution of 1 what-if analyses...
2022-09-21 19:52:55 INFO  Start plan generation for analysis PermutationFeatureImportance...
2022-09-21 19:52:55 INFO  ---RUNTIME: Plan generation took 0.18525123596191406 ms
2022-09-21 19:52:55 INFO  Estimated runtime of original DAG is 23393.056392669678ms
2022-09-21 19:52:55 INFO  Performing Multi-Query Optimization
2022-09-21 19:52:55 INFO  Estimated unoptimized what-if runtime is 116965.28196334839ms
2022-09-21 19:52:55 INFO  Estimated optimised what-if runtime is 25955.880880355835ms
2022-09-21 19:52:55 INFO  Estimated optimisation runtime saving is 91009.40108299255ms
2022-09-21 19:52:55 INFO  ---RUNTIME: Multi-Query Optimization took 15.088081359863281 ms
2022-09-21 19:52:55 INFO  Executing generated plans
2022-09-21 19:53:20 INFO  ---RUNTIME: Execution took 25325.972080230713 ms
2022-09-21 19:53:20 INFO  Done!
2022-09-21 19:53:21 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-21 19:53:21 INFO  Running instrumented original pipeline...
2022-09-21 19:53:21 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-21 19:53:21 INFO  ---RUNTIME: Importing and monkey-patching took 9.921073913574219 ms
2022-09-21 19:53:44 INFO  ---RUNTIME: Original pipeline execution took 23893.23616027832 ms (excluding imports and monkey-patching)
2022-09-21 19:53:44 INFO  Starting execution of 1 what-if analyses...
2022-09-21 19:53:44 INFO  Start plan generation for analysis PermutationFeatureImportance...
2022-09-21 19:53:44 INFO  ---RUNTIME: Plan generation took 0.22792816162109375 ms
2022-09-21 19:53:44 INFO  Estimated runtime of original DAG is 22624.666690826416ms
2022-09-21 19:53:44 WARNING Skipping Multi-Query Optimization (instead, only applying patches)
2022-09-21 19:53:44 INFO  Estimated unoptimised what-if runtime is 113123.33345413208ms
2022-09-21 19:53:44 INFO  ---RUNTIME: Multi-Query Optimization took 5.370378494262695 ms
2022-09-21 19:53:44 INFO  Executing generated plans
2022-09-21 19:55:49 INFO  ---RUNTIME: Execution took 124167.44375228882 ms
2022-09-21 19:55:49 INFO  Done!
2022-09-21 19:55:49 INFO  # Finished -- repetition 5 of 7 
2022-09-21 19:55:49 INFO  # Optimization benchmark for feature_importance with args [['reviews', 'slow_loading', 'featurization_2', 'xgboost']] -- repetition 6 of 7
2022-09-21 19:55:49 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-21 19:55:49 INFO  Running instrumented original pipeline...
2022-09-21 19:55:49 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-21 19:55:49 INFO  ---RUNTIME: Importing and monkey-patching took 7.172584533691406 ms
2022-09-21 19:56:20 INFO  ---RUNTIME: Original pipeline execution took 31177.836179733276 ms (excluding imports and monkey-patching)
2022-09-21 19:56:20 INFO  Starting execution of 1 what-if analyses...
2022-09-21 19:56:20 INFO  Start plan generation for analysis PermutationFeatureImportance...
2022-09-21 19:56:20 INFO  ---RUNTIME: Plan generation took 1.7962455749511719 ms
2022-09-21 19:56:20 INFO  Estimated runtime of original DAG is 29671.860456466675ms
2022-09-21 19:56:20 INFO  Performing Multi-Query Optimization
2022-09-21 19:56:20 INFO  Estimated unoptimized what-if runtime is 148359.30228233337ms
2022-09-21 19:56:20 INFO  Estimated optimised what-if runtime is 32436.078786849976ms
2022-09-21 19:56:20 INFO  Estimated optimisation runtime saving is 115923.2234954834ms
2022-09-21 19:56:20 INFO  ---RUNTIME: Multi-Query Optimization took 21.503448486328125 ms
2022-09-21 19:56:20 INFO  Executing generated plans
2022-09-21 19:56:49 INFO  ---RUNTIME: Execution took 29084.241151809692 ms
2022-09-21 19:56:49 INFO  Done!
2022-09-21 19:56:49 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-21 19:56:49 INFO  Running instrumented original pipeline...
2022-09-21 19:56:49 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-21 19:56:49 INFO  ---RUNTIME: Importing and monkey-patching took 7.454395294189453 ms
2022-09-21 19:57:16 INFO  ---RUNTIME: Original pipeline execution took 26922.41907119751 ms (excluding imports and monkey-patching)
2022-09-21 19:57:16 INFO  Starting execution of 1 what-if analyses...
2022-09-21 19:57:16 INFO  Start plan generation for analysis PermutationFeatureImportance...
2022-09-21 19:57:16 INFO  ---RUNTIME: Plan generation took 0.15115737915039062 ms
2022-09-21 19:57:16 INFO  Estimated runtime of original DAG is 25048.44641685486ms
2022-09-21 19:57:16 WARNING Skipping Multi-Query Optimization (instead, only applying patches)
2022-09-21 19:57:16 INFO  Estimated unoptimised what-if runtime is 125242.23208427429ms
2022-09-21 19:57:16 INFO  ---RUNTIME: Multi-Query Optimization took 5.0983428955078125 ms
2022-09-21 19:57:16 INFO  Executing generated plans
2022-09-21 19:59:16 INFO  ---RUNTIME: Execution took 119728.99174690247 ms
2022-09-21 19:59:16 INFO  Done!
2022-09-21 19:59:16 INFO  # Finished -- repetition 6 of 7 
2022-09-21 19:59:16 INFO  # Optimization benchmark for feature_importance with args [['reviews', 'slow_loading', 'featurization_2', 'xgboost']] -- repetition 7 of 7
2022-09-21 19:59:16 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-21 19:59:16 INFO  Running instrumented original pipeline...
2022-09-21 19:59:16 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-21 19:59:16 INFO  ---RUNTIME: Importing and monkey-patching took 8.46242904663086 ms
2022-09-21 19:59:42 INFO  ---RUNTIME: Original pipeline execution took 26180.659770965576 ms (excluding imports and monkey-patching)
2022-09-21 19:59:42 INFO  Starting execution of 1 what-if analyses...
2022-09-21 19:59:42 INFO  Start plan generation for analysis PermutationFeatureImportance...
2022-09-21 19:59:42 INFO  ---RUNTIME: Plan generation took 0.15091896057128906 ms
2022-09-21 19:59:42 INFO  Estimated runtime of original DAG is 24310.209035873413ms
2022-09-21 19:59:42 INFO  Performing Multi-Query Optimization
2022-09-21 19:59:42 INFO  Estimated unoptimized what-if runtime is 121551.04517936707ms
2022-09-21 19:59:42 INFO  Estimated optimised what-if runtime is 27021.323442459106ms
2022-09-21 19:59:42 INFO  Estimated optimisation runtime saving is 94529.72173690796ms
2022-09-21 19:59:42 INFO  ---RUNTIME: Multi-Query Optimization took 16.49785041809082 ms
2022-09-21 19:59:42 INFO  Executing generated plans
2022-09-21 20:00:09 INFO  ---RUNTIME: Execution took 27040.120840072632 ms
2022-09-21 20:00:09 INFO  Done!
2022-09-21 20:00:09 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-21 20:00:09 INFO  Running instrumented original pipeline...
2022-09-21 20:00:09 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-21 20:00:09 INFO  ---RUNTIME: Importing and monkey-patching took 10.342597961425781 ms
2022-09-21 20:00:37 INFO  ---RUNTIME: Original pipeline execution took 27886.43479347229 ms (excluding imports and monkey-patching)
2022-09-21 20:00:37 INFO  Starting execution of 1 what-if analyses...
2022-09-21 20:00:37 INFO  Start plan generation for analysis PermutationFeatureImportance...
2022-09-21 20:00:37 INFO  ---RUNTIME: Plan generation took 0.15497207641601562 ms
2022-09-21 20:00:37 INFO  Estimated runtime of original DAG is 26097.755670547485ms
2022-09-21 20:00:37 WARNING Skipping Multi-Query Optimization (instead, only applying patches)
2022-09-21 20:00:37 INFO  Estimated unoptimised what-if runtime is 130488.77835273743ms
2022-09-21 20:00:37 INFO  ---RUNTIME: Multi-Query Optimization took 5.924463272094727 ms
2022-09-21 20:00:37 INFO  Executing generated plans
2022-09-21 20:02:42 INFO  ---RUNTIME: Execution took 125006.71672821045 ms
2022-09-21 20:02:42 INFO  Done!
2022-09-21 20:02:42 INFO  # Finished -- repetition 7 of 7 
2022-09-21 20:02:42 INFO  # Final results after all repetitions
2022-09-21 20:02:42 INFO     repetition  ... no_opt_what_if_execution_combined_model_training
0           0  ...                                     91314.210415
1           1  ...                                     85926.020861
2           2  ...                                     74132.829189
3           3  ...                                     78537.263393
4           4  ...                                     78259.003162
5           5  ...                                     80801.729679
6           6  ...                                     79918.131113

[7 rows x 26 columns]
taskset -c 32-39 PROTOCOL_BUFFERS_PYTHON_IMPLEMENTATION=python python3.9 benchmarks_end_to_end.py feature_importance reviews slow_loading featurization_2 neural_network
2022-09-21 20:02:45.561109: W tensorflow/stream_executor/platform/default/dso_loader.cc:64] Could not load dynamic library 'libcudart.so.11.0'; dlerror: libcudart.so.11.0: cannot open shared object file: No such file or directory; LD_LIBRARY_PATH: /home/sgrafbe/mlwhatif/venv/lib/python3.9/site-packages/cv2/../../lib64:
2022-09-21 20:02:45.561159: I tensorflow/stream_executor/cuda/cudart_stub.cc:29] Ignore above cudart dlerror if you do not have a GPU set up on your machine.
2022-09-21 20:02:47 INFO  Patching sys.argv with ['mlwhatif', 'reviews', 'slow_loading', 'featurization_2', 'neural_network']
2022-09-21 20:02:47 INFO  Running instrumented original pipeline...
2022-09-21 20:02:47 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-21 20:02:47 INFO  ---RUNTIME: Importing and monkey-patching took 155.79962730407715 ms
2022-09-21 20:02:56.262454: W tensorflow/stream_executor/platform/default/dso_loader.cc:64] Could not load dynamic library 'libcuda.so.1'; dlerror: libcuda.so.1: cannot open shared object file: No such file or directory; LD_LIBRARY_PATH: /home/sgrafbe/mlwhatif/venv/lib/python3.9/site-packages/cv2/../../lib64:
2022-09-21 20:02:56.262505: W tensorflow/stream_executor/cuda/cuda_driver.cc:326] failed call to cuInit: UNKNOWN ERROR (303)
2022-09-21 20:02:56.262533: I tensorflow/stream_executor/cuda/cuda_diagnostics.cc:156] kernel driver does not appear to be running on this host (wagyu): /proc/driver/nvidia/version does not exist
2022-09-21 20:02:56.263111: I tensorflow/core/platform/cpu_feature_guard.cc:142] This TensorFlow binary is optimized with oneAPI Deep Neural Network Library (oneDNN) to use the following CPU instructions in performance-critical operations:  AVX2 FMA
To enable them in other operations, rebuild TensorFlow with the appropriate compiler flags.
2022-09-21 20:02:57.093301: I tensorflow/compiler/mlir/mlir_graph_optimization_pass.cc:176] None of the MLIR Optimization Passes are enabled (registered 2)
2022-09-21 20:02:57.107375: I tensorflow/core/platform/profile_utils/cpu_utils.cc:114] CPU Frequency: 2595290000 Hz
2022-09-21 20:03:05 INFO  ---RUNTIME: Original pipeline execution took 17958.53853225708 ms (excluding imports and monkey-patching)
2022-09-21 20:03:05 INFO  Starting execution of 0 what-if analyses...
2022-09-21 20:03:05 INFO  Estimated runtime of original DAG is 16121.182203292847ms
2022-09-21 20:03:05 INFO  Performing Multi-Query Optimization
2022-09-21 20:03:05 INFO  Estimated unoptimized what-if runtime is 0ms
2022-09-21 20:03:05 INFO  Estimated optimised what-if runtime is 0ms
2022-09-21 20:03:05 INFO  Estimated optimisation runtime saving is 0ms
2022-09-21 20:03:05 INFO  ---RUNTIME: Multi-Query Optimization took 0.8168220520019531 ms
2022-09-21 20:03:05 INFO  Executing generated plans
2022-09-21 20:03:05 INFO  ---RUNTIME: Execution took 0.030994415283203125 ms
2022-09-21 20:03:05 INFO  Done!
2022-09-21 20:03:05 INFO  # Optimization benchmark for feature_importance with args [['reviews', 'slow_loading', 'featurization_2', 'neural_network']] -- repetition 1 of 7
2022-09-21 20:03:05 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-21 20:03:05 INFO  Running instrumented original pipeline...
2022-09-21 20:03:05 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-21 20:03:05 INFO  ---RUNTIME: Importing and monkey-patching took 15.067815780639648 ms
2022-09-21 20:03:22 INFO  ---RUNTIME: Original pipeline execution took 17064.38899040222 ms (excluding imports and monkey-patching)
2022-09-21 20:03:22 INFO  Starting execution of 1 what-if analyses...
2022-09-21 20:03:22 INFO  Start plan generation for analysis PermutationFeatureImportance...
2022-09-21 20:03:22 INFO  ---RUNTIME: Plan generation took 0.2205371856689453 ms
2022-09-21 20:03:22 INFO  Estimated runtime of original DAG is 15259.966611862183ms
2022-09-21 20:03:22 INFO  Performing Multi-Query Optimization
2022-09-21 20:03:22 INFO  Estimated unoptimized what-if runtime is 76299.83305931091ms
2022-09-21 20:03:22 INFO  Estimated optimised what-if runtime is 19737.09011077881ms
2022-09-21 20:03:22 INFO  Estimated optimisation runtime saving is 56562.742948532104ms
2022-09-21 20:03:22 INFO  ---RUNTIME: Multi-Query Optimization took 11.46388053894043 ms
2022-09-21 20:03:22 INFO  Executing generated plans
2022-09-21 20:03:45 INFO  ---RUNTIME: Execution took 22901.958227157593 ms
2022-09-21 20:03:45 INFO  Done!
2022-09-21 20:03:45 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-21 20:03:45 INFO  Running instrumented original pipeline...
2022-09-21 20:03:45 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-21 20:03:45 INFO  ---RUNTIME: Importing and monkey-patching took 17.688512802124023 ms
2022-09-21 20:04:03 INFO  ---RUNTIME: Original pipeline execution took 17810.893297195435 ms (excluding imports and monkey-patching)
2022-09-21 20:04:03 INFO  Starting execution of 1 what-if analyses...
2022-09-21 20:04:03 INFO  Start plan generation for analysis PermutationFeatureImportance...
2022-09-21 20:04:03 INFO  ---RUNTIME: Plan generation took 0.10991096496582031 ms
2022-09-21 20:04:03 INFO  Estimated runtime of original DAG is 15991.78671836853ms
2022-09-21 20:04:03 WARNING Skipping Multi-Query Optimization (instead, only applying patches)
2022-09-21 20:04:03 INFO  Estimated unoptimised what-if runtime is 79958.93359184265ms
2022-09-21 20:04:03 INFO  ---RUNTIME: Multi-Query Optimization took 4.570960998535156 ms
2022-09-21 20:04:03 INFO  Executing generated plans
2022-09-21 20:05:30 INFO  ---RUNTIME: Execution took 87268.26167106628 ms
2022-09-21 20:05:30 INFO  Done!
2022-09-21 20:05:30 INFO  # Finished -- repetition 1 of 7 
2022-09-21 20:05:30 INFO  # Optimization benchmark for feature_importance with args [['reviews', 'slow_loading', 'featurization_2', 'neural_network']] -- repetition 2 of 7
2022-09-21 20:05:30 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-21 20:05:30 INFO  Running instrumented original pipeline...
2022-09-21 20:05:31 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-21 20:05:31 INFO  ---RUNTIME: Importing and monkey-patching took 6.17527961730957 ms
2022-09-21 20:05:49 INFO  ---RUNTIME: Original pipeline execution took 18795.34149169922 ms (excluding imports and monkey-patching)
2022-09-21 20:05:49 INFO  Starting execution of 1 what-if analyses...
2022-09-21 20:05:49 INFO  Start plan generation for analysis PermutationFeatureImportance...
2022-09-21 20:05:49 INFO  ---RUNTIME: Plan generation took 0.1430511474609375 ms
2022-09-21 20:05:49 INFO  Estimated runtime of original DAG is 17433.133602142334ms
2022-09-21 20:05:49 INFO  Performing Multi-Query Optimization
2022-09-21 20:05:49 INFO  Estimated unoptimized what-if runtime is 87165.66801071167ms
2022-09-21 20:05:49 INFO  Estimated optimised what-if runtime is 22148.06056022644ms
2022-09-21 20:05:49 INFO  Estimated optimisation runtime saving is 65017.60745048523ms
2022-09-21 20:05:49 INFO  ---RUNTIME: Multi-Query Optimization took 10.477542877197266 ms
2022-09-21 20:05:49 INFO  Executing generated plans
2022-09-21 20:06:10 INFO  ---RUNTIME: Execution took 20686.43045425415 ms
2022-09-21 20:06:10 INFO  Done!
2022-09-21 20:06:10 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-21 20:06:10 INFO  Running instrumented original pipeline...
2022-09-21 20:06:10 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-21 20:06:10 INFO  ---RUNTIME: Importing and monkey-patching took 9.60397720336914 ms
2022-09-21 20:06:31 INFO  ---RUNTIME: Original pipeline execution took 21483.661890029907 ms (excluding imports and monkey-patching)
2022-09-21 20:06:31 INFO  Starting execution of 1 what-if analyses...
2022-09-21 20:06:31 INFO  Start plan generation for analysis PermutationFeatureImportance...
2022-09-21 20:06:31 INFO  ---RUNTIME: Plan generation took 0.1399517059326172 ms
2022-09-21 20:06:31 INFO  Estimated runtime of original DAG is 19708.85682106018ms
2022-09-21 20:06:31 WARNING Skipping Multi-Query Optimization (instead, only applying patches)
2022-09-21 20:06:31 INFO  Estimated unoptimised what-if runtime is 98544.2841053009ms
2022-09-21 20:06:31 INFO  ---RUNTIME: Multi-Query Optimization took 10.45989990234375 ms
2022-09-21 20:06:31 INFO  Executing generated plans
2022-09-21 20:08:34 INFO  ---RUNTIME: Execution took 122477.10251808167 ms
2022-09-21 20:08:34 INFO  Done!
2022-09-21 20:08:34 INFO  # Finished -- repetition 2 of 7 
2022-09-21 20:08:34 INFO  # Optimization benchmark for feature_importance with args [['reviews', 'slow_loading', 'featurization_2', 'neural_network']] -- repetition 3 of 7
2022-09-21 20:08:34 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-21 20:08:34 INFO  Running instrumented original pipeline...
2022-09-21 20:08:34 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-21 20:08:34 INFO  ---RUNTIME: Importing and monkey-patching took 6.126642227172852 ms
2022-09-21 20:08:53 INFO  ---RUNTIME: Original pipeline execution took 18552.346229553223 ms (excluding imports and monkey-patching)
2022-09-21 20:08:53 INFO  Starting execution of 1 what-if analyses...
2022-09-21 20:08:53 INFO  Start plan generation for analysis PermutationFeatureImportance...
2022-09-21 20:08:53 INFO  ---RUNTIME: Plan generation took 0.12445449829101562 ms
2022-09-21 20:08:53 INFO  Estimated runtime of original DAG is 17022.183179855347ms
2022-09-21 20:08:53 INFO  Performing Multi-Query Optimization
2022-09-21 20:08:53 INFO  Estimated unoptimized what-if runtime is 85110.91589927673ms
2022-09-21 20:08:53 INFO  Estimated optimised what-if runtime is 21532.586574554443ms
2022-09-21 20:08:53 INFO  Estimated optimisation runtime saving is 63578.32932472229ms
2022-09-21 20:08:53 INFO  ---RUNTIME: Multi-Query Optimization took 403.14745903015137 ms
2022-09-21 20:08:53 INFO  Executing generated plans
2022-09-21 20:09:16 INFO  ---RUNTIME: Execution took 22741.08076095581 ms
2022-09-21 20:09:16 INFO  Done!
2022-09-21 20:09:16 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-21 20:09:16 INFO  Running instrumented original pipeline...
2022-09-21 20:09:16 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-21 20:09:16 INFO  ---RUNTIME: Importing and monkey-patching took 5.772829055786133 ms
2022-09-21 20:09:36 INFO  ---RUNTIME: Original pipeline execution took 20017.23337173462 ms (excluding imports and monkey-patching)
2022-09-21 20:09:36 INFO  Starting execution of 1 what-if analyses...
2022-09-21 20:09:36 INFO  Start plan generation for analysis PermutationFeatureImportance...
2022-09-21 20:09:36 INFO  ---RUNTIME: Plan generation took 0.11467933654785156 ms
2022-09-21 20:09:36 INFO  Estimated runtime of original DAG is 17918.773889541626ms
2022-09-21 20:09:36 WARNING Skipping Multi-Query Optimization (instead, only applying patches)
2022-09-21 20:09:36 INFO  Estimated unoptimised what-if runtime is 89593.86944770813ms
2022-09-21 20:09:36 INFO  ---RUNTIME: Multi-Query Optimization took 4.81414794921875 ms
2022-09-21 20:09:36 INFO  Executing generated plans
2022-09-21 20:11:08 INFO  ---RUNTIME: Execution took 92196.3472366333 ms
2022-09-21 20:11:08 INFO  Done!
2022-09-21 20:11:08 INFO  # Finished -- repetition 3 of 7 
2022-09-21 20:11:08 INFO  # Optimization benchmark for feature_importance with args [['reviews', 'slow_loading', 'featurization_2', 'neural_network']] -- repetition 4 of 7
2022-09-21 20:11:08 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-21 20:11:08 INFO  Running instrumented original pipeline...
2022-09-21 20:11:08 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-21 20:11:08 INFO  ---RUNTIME: Importing and monkey-patching took 8.944511413574219 ms
2022-09-21 20:11:29 INFO  ---RUNTIME: Original pipeline execution took 21319.462537765503 ms (excluding imports and monkey-patching)
2022-09-21 20:11:29 INFO  Starting execution of 1 what-if analyses...
2022-09-21 20:11:29 INFO  Start plan generation for analysis PermutationFeatureImportance...
2022-09-21 20:11:29 INFO  ---RUNTIME: Plan generation took 0.15497207641601562 ms
2022-09-21 20:11:29 INFO  Estimated runtime of original DAG is 19339.7536277771ms
2022-09-21 20:11:29 INFO  Performing Multi-Query Optimization
2022-09-21 20:11:29 INFO  Estimated unoptimized what-if runtime is 96698.7681388855ms
2022-09-21 20:11:29 INFO  Estimated optimised what-if runtime is 26720.839738845825ms
2022-09-21 20:11:29 INFO  Estimated optimisation runtime saving is 69977.92840003967ms
2022-09-21 20:11:29 INFO  ---RUNTIME: Multi-Query Optimization took 15.084981918334961 ms
2022-09-21 20:11:29 INFO  Executing generated plans
2022-09-21 20:11:54 INFO  ---RUNTIME: Execution took 24818.828344345093 ms
2022-09-21 20:11:54 INFO  Done!
2022-09-21 20:11:54 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-21 20:11:54 INFO  Running instrumented original pipeline...
2022-09-21 20:11:54 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-21 20:11:54 INFO  ---RUNTIME: Importing and monkey-patching took 5.775928497314453 ms
2022-09-21 20:12:13 INFO  ---RUNTIME: Original pipeline execution took 18428.4930229187 ms (excluding imports and monkey-patching)
2022-09-21 20:12:13 INFO  Starting execution of 1 what-if analyses...
2022-09-21 20:12:13 INFO  Start plan generation for analysis PermutationFeatureImportance...
2022-09-21 20:12:13 INFO  ---RUNTIME: Plan generation took 0.28967857360839844 ms
2022-09-21 20:12:13 INFO  Estimated runtime of original DAG is 16587.306022644043ms
2022-09-21 20:12:13 WARNING Skipping Multi-Query Optimization (instead, only applying patches)
2022-09-21 20:12:13 INFO  Estimated unoptimised what-if runtime is 82936.53011322021ms
2022-09-21 20:12:13 INFO  ---RUNTIME: Multi-Query Optimization took 4.001379013061523 ms
2022-09-21 20:12:13 INFO  Executing generated plans
2022-09-21 20:13:30 INFO  ---RUNTIME: Execution took 77131.48832321167 ms
2022-09-21 20:13:30 INFO  Done!
2022-09-21 20:13:30 INFO  # Finished -- repetition 4 of 7 
2022-09-21 20:13:30 INFO  # Optimization benchmark for feature_importance with args [['reviews', 'slow_loading', 'featurization_2', 'neural_network']] -- repetition 5 of 7
2022-09-21 20:13:30 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-21 20:13:30 INFO  Running instrumented original pipeline...
2022-09-21 20:13:30 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-21 20:13:30 INFO  ---RUNTIME: Importing and monkey-patching took 6.418466567993164 ms
2022-09-21 20:13:49 INFO  ---RUNTIME: Original pipeline execution took 19096.3077545166 ms (excluding imports and monkey-patching)
2022-09-21 20:13:49 INFO  Starting execution of 1 what-if analyses...
2022-09-21 20:13:49 INFO  Start plan generation for analysis PermutationFeatureImportance...
2022-09-21 20:13:49 INFO  ---RUNTIME: Plan generation took 0.10657310485839844 ms
2022-09-21 20:13:49 INFO  Estimated runtime of original DAG is 17807.919025421143ms
2022-09-21 20:13:49 INFO  Performing Multi-Query Optimization
2022-09-21 20:13:49 INFO  Estimated unoptimized what-if runtime is 89039.59512710571ms
2022-09-21 20:13:49 INFO  Estimated optimised what-if runtime is 22545.191526412964ms
2022-09-21 20:13:49 INFO  Estimated optimisation runtime saving is 66494.40360069275ms
2022-09-21 20:13:49 INFO  ---RUNTIME: Multi-Query Optimization took 10.258197784423828 ms
2022-09-21 20:13:49 INFO  Executing generated plans
2022-09-21 20:14:12 INFO  ---RUNTIME: Execution took 22887.361526489258 ms
2022-09-21 20:14:12 INFO  Done!
2022-09-21 20:14:12 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-21 20:14:12 INFO  Running instrumented original pipeline...
2022-09-21 20:14:12 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-21 20:14:12 INFO  ---RUNTIME: Importing and monkey-patching took 5.972623825073242 ms
2022-09-21 20:14:32 INFO  ---RUNTIME: Original pipeline execution took 20039.068937301636 ms (excluding imports and monkey-patching)
2022-09-21 20:14:32 INFO  Starting execution of 1 what-if analyses...
2022-09-21 20:14:32 INFO  Start plan generation for analysis PermutationFeatureImportance...
2022-09-21 20:14:32 INFO  ---RUNTIME: Plan generation took 0.10228157043457031 ms
2022-09-21 20:14:32 INFO  Estimated runtime of original DAG is 17954.72764968872ms
2022-09-21 20:14:32 WARNING Skipping Multi-Query Optimization (instead, only applying patches)
2022-09-21 20:14:32 INFO  Estimated unoptimised what-if runtime is 89773.6382484436ms
2022-09-21 20:14:32 INFO  ---RUNTIME: Multi-Query Optimization took 4.9610137939453125 ms
2022-09-21 20:14:32 INFO  Executing generated plans
2022-09-21 20:16:05 INFO  ---RUNTIME: Execution took 93265.20466804504 ms
2022-09-21 20:16:05 INFO  Done!
2022-09-21 20:16:05 INFO  # Finished -- repetition 5 of 7 
2022-09-21 20:16:05 INFO  # Optimization benchmark for feature_importance with args [['reviews', 'slow_loading', 'featurization_2', 'neural_network']] -- repetition 6 of 7
2022-09-21 20:16:05 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-21 20:16:05 INFO  Running instrumented original pipeline...
2022-09-21 20:16:05 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-21 20:16:05 INFO  ---RUNTIME: Importing and monkey-patching took 9.234189987182617 ms
2022-09-21 20:16:27 INFO  ---RUNTIME: Original pipeline execution took 21746.755599975586 ms (excluding imports and monkey-patching)
2022-09-21 20:16:27 INFO  Starting execution of 1 what-if analyses...
2022-09-21 20:16:27 INFO  Start plan generation for analysis PermutationFeatureImportance...
2022-09-21 20:16:27 INFO  ---RUNTIME: Plan generation took 0.1399517059326172 ms
2022-09-21 20:16:27 INFO  Estimated runtime of original DAG is 19790.863037109375ms
2022-09-21 20:16:27 INFO  Performing Multi-Query Optimization
2022-09-21 20:16:27 INFO  Estimated unoptimized what-if runtime is 98954.31518554688ms
2022-09-21 20:16:27 INFO  Estimated optimised what-if runtime is 27118.5941696167ms
2022-09-21 20:16:27 INFO  Estimated optimisation runtime saving is 71835.72101593018ms
2022-09-21 20:16:27 INFO  ---RUNTIME: Multi-Query Optimization took 19.510507583618164 ms
2022-09-21 20:16:27 INFO  Executing generated plans
2022-09-21 20:16:51 INFO  ---RUNTIME: Execution took 24316.34211540222 ms
2022-09-21 20:16:51 INFO  Done!
2022-09-21 20:16:51 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-21 20:16:51 INFO  Running instrumented original pipeline...
2022-09-21 20:16:51 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-21 20:16:51 INFO  ---RUNTIME: Importing and monkey-patching took 6.049156188964844 ms
2022-09-21 20:17:09 INFO  ---RUNTIME: Original pipeline execution took 18357.670068740845 ms (excluding imports and monkey-patching)
2022-09-21 20:17:09 INFO  Starting execution of 1 what-if analyses...
2022-09-21 20:17:09 INFO  Start plan generation for analysis PermutationFeatureImportance...
2022-09-21 20:17:09 INFO  ---RUNTIME: Plan generation took 0.12469291687011719 ms
2022-09-21 20:17:09 INFO  Estimated runtime of original DAG is 16560.274839401245ms
2022-09-21 20:17:09 WARNING Skipping Multi-Query Optimization (instead, only applying patches)
2022-09-21 20:17:09 INFO  Estimated unoptimised what-if runtime is 82801.37419700623ms
2022-09-21 20:17:09 INFO  ---RUNTIME: Multi-Query Optimization took 4.07719612121582 ms
2022-09-21 20:17:09 INFO  Executing generated plans
2022-09-21 20:18:37 INFO  ---RUNTIME: Execution took 87509.13333892822 ms
2022-09-21 20:18:37 INFO  Done!
2022-09-21 20:18:37 INFO  # Finished -- repetition 6 of 7 
2022-09-21 20:18:37 INFO  # Optimization benchmark for feature_importance with args [['reviews', 'slow_loading', 'featurization_2', 'neural_network']] -- repetition 7 of 7
2022-09-21 20:18:37 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-21 20:18:37 INFO  Running instrumented original pipeline...
2022-09-21 20:18:37 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-21 20:18:37 INFO  ---RUNTIME: Importing and monkey-patching took 5.971670150756836 ms
2022-09-21 20:18:55 INFO  ---RUNTIME: Original pipeline execution took 18080.034017562866 ms (excluding imports and monkey-patching)
2022-09-21 20:18:55 INFO  Starting execution of 1 what-if analyses...
2022-09-21 20:18:55 INFO  Start plan generation for analysis PermutationFeatureImportance...
2022-09-21 20:18:55 INFO  ---RUNTIME: Plan generation took 0.17690658569335938 ms
2022-09-21 20:18:55 INFO  Estimated runtime of original DAG is 16843.997478485107ms
2022-09-21 20:18:55 INFO  Performing Multi-Query Optimization
2022-09-21 20:18:55 INFO  Estimated unoptimized what-if runtime is 84219.98739242554ms
2022-09-21 20:18:55 INFO  Estimated optimised what-if runtime is 24240.602493286133ms
2022-09-21 20:18:55 INFO  Estimated optimisation runtime saving is 59979.384899139404ms
2022-09-21 20:18:55 INFO  ---RUNTIME: Multi-Query Optimization took 17.39811897277832 ms
2022-09-21 20:18:55 INFO  Executing generated plans
2022-09-21 20:19:19 INFO  ---RUNTIME: Execution took 24304.94785308838 ms
2022-09-21 20:19:19 INFO  Done!
2022-09-21 20:19:19 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-21 20:19:19 INFO  Running instrumented original pipeline...
2022-09-21 20:19:20 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-21 20:19:20 INFO  ---RUNTIME: Importing and monkey-patching took 9.541034698486328 ms
2022-09-21 20:19:34 INFO  ---RUNTIME: Original pipeline execution took 15076.175689697266 ms (excluding imports and monkey-patching)
2022-09-21 20:19:34 INFO  Starting execution of 1 what-if analyses...
2022-09-21 20:19:34 INFO  Start plan generation for analysis PermutationFeatureImportance...
2022-09-21 20:19:34 INFO  ---RUNTIME: Plan generation took 0.10752677917480469 ms
2022-09-21 20:19:34 INFO  Estimated runtime of original DAG is 13027.466773986816ms
2022-09-21 20:19:34 WARNING Skipping Multi-Query Optimization (instead, only applying patches)
2022-09-21 20:19:34 INFO  Estimated unoptimised what-if runtime is 65137.33386993408ms
2022-09-21 20:19:34 INFO  ---RUNTIME: Multi-Query Optimization took 4.829883575439453 ms
2022-09-21 20:19:34 INFO  Executing generated plans
2022-09-21 20:20:46 INFO  ---RUNTIME: Execution took 71577.76236534119 ms
2022-09-21 20:20:46 INFO  Done!
2022-09-21 20:20:46 INFO  # Finished -- repetition 7 of 7 
2022-09-21 20:20:46 INFO  # Final results after all repetitions
2022-09-21 20:20:46 INFO     repetition  ... no_opt_what_if_execution_combined_model_training
0           0  ...                                     40340.714931
1           1  ...                                     44225.699902
2           2  ...                                     45122.897148
3           3  ...                                     35875.514984
4           4  ...                                     45577.282667
5           5  ...                                     42644.421101
6           6  ...                                     32069.908381

[7 rows x 26 columns]
taskset -c 32-39 PROTOCOL_BUFFERS_PYTHON_IMPLEMENTATION=python python3.9 benchmarks_end_to_end.py feature_importance reviews slow_loading featurization_3 logistic_regression
2022-09-21 20:20:49.266082: W tensorflow/stream_executor/platform/default/dso_loader.cc:64] Could not load dynamic library 'libcudart.so.11.0'; dlerror: libcudart.so.11.0: cannot open shared object file: No such file or directory; LD_LIBRARY_PATH: /home/sgrafbe/mlwhatif/venv/lib/python3.9/site-packages/cv2/../../lib64:
2022-09-21 20:20:49.266119: I tensorflow/stream_executor/cuda/cudart_stub.cc:29] Ignore above cudart dlerror if you do not have a GPU set up on your machine.
2022-09-21 20:20:50 INFO  Patching sys.argv with ['mlwhatif', 'reviews', 'slow_loading', 'featurization_3', 'logistic_regression']
2022-09-21 20:20:50 INFO  Running instrumented original pipeline...
2022-09-21 20:20:50 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-21 20:20:50 INFO  ---RUNTIME: Importing and monkey-patching took 95.31855583190918 ms
2022-09-21 20:21:32 INFO  ---RUNTIME: Original pipeline execution took 41414.03388977051 ms (excluding imports and monkey-patching)
2022-09-21 20:21:32 INFO  Starting execution of 0 what-if analyses...
2022-09-21 20:21:32 INFO  Estimated runtime of original DAG is 33958.62126350403ms
2022-09-21 20:21:32 INFO  Performing Multi-Query Optimization
2022-09-21 20:21:32 INFO  Estimated unoptimized what-if runtime is 0ms
2022-09-21 20:21:32 INFO  Estimated optimised what-if runtime is 0ms
2022-09-21 20:21:32 INFO  Estimated optimisation runtime saving is 0ms
2022-09-21 20:21:32 INFO  ---RUNTIME: Multi-Query Optimization took 0.5900859832763672 ms
2022-09-21 20:21:32 INFO  Executing generated plans
2022-09-21 20:21:32 INFO  ---RUNTIME: Execution took 0.022411346435546875 ms
2022-09-21 20:21:32 INFO  Done!
2022-09-21 20:21:32 INFO  # Optimization benchmark for feature_importance with args [['reviews', 'slow_loading', 'featurization_3', 'logistic_regression']] -- repetition 1 of 7
2022-09-21 20:21:32 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-21 20:21:32 INFO  Running instrumented original pipeline...
2022-09-21 20:21:32 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-21 20:21:32 INFO  ---RUNTIME: Importing and monkey-patching took 5.473136901855469 ms
2022-09-21 20:22:13 INFO  ---RUNTIME: Original pipeline execution took 41215.93260765076 ms (excluding imports and monkey-patching)
2022-09-21 20:22:13 INFO  Starting execution of 1 what-if analyses...
2022-09-21 20:22:13 INFO  Start plan generation for analysis PermutationFeatureImportance...
2022-09-21 20:22:13 INFO  ---RUNTIME: Plan generation took 0.2593994140625 ms
2022-09-21 20:22:13 INFO  Estimated runtime of original DAG is 33823.670864105225ms
2022-09-21 20:22:13 INFO  Performing Multi-Query Optimization
2022-09-21 20:22:13 INFO  Estimated unoptimized what-if runtime is 169118.35432052612ms
2022-09-21 20:22:13 INFO  Estimated optimised what-if runtime is 50229.49814796448ms
2022-09-21 20:22:13 INFO  Estimated optimisation runtime saving is 118888.85617256165ms
2022-09-21 20:22:13 INFO  ---RUNTIME: Multi-Query Optimization took 12.884855270385742 ms
2022-09-21 20:22:13 INFO  Executing generated plans
2022-09-21 20:22:42 INFO  ---RUNTIME: Execution took 28788.63286972046 ms
2022-09-21 20:22:42 INFO  Done!
2022-09-21 20:22:42 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-21 20:22:42 INFO  Running instrumented original pipeline...
2022-09-21 20:22:42 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-21 20:22:42 INFO  ---RUNTIME: Importing and monkey-patching took 5.718469619750977 ms
2022-09-21 20:23:22 INFO  ---RUNTIME: Original pipeline execution took 40311.70582771301 ms (excluding imports and monkey-patching)
2022-09-21 20:23:22 INFO  Starting execution of 1 what-if analyses...
2022-09-21 20:23:22 INFO  Start plan generation for analysis PermutationFeatureImportance...
2022-09-21 20:23:22 INFO  ---RUNTIME: Plan generation took 0.14162063598632812 ms
2022-09-21 20:23:22 INFO  Estimated runtime of original DAG is 32824.97596740723ms
2022-09-21 20:23:22 WARNING Skipping Multi-Query Optimization (instead, only applying patches)
2022-09-21 20:23:22 INFO  Estimated unoptimised what-if runtime is 164124.87983703613ms
2022-09-21 20:23:22 INFO  ---RUNTIME: Multi-Query Optimization took 4.976987838745117 ms
2022-09-21 20:23:22 INFO  Executing generated plans
2022-09-21 20:25:31 INFO  ---RUNTIME: Execution took 129396.65031433105 ms
2022-09-21 20:25:31 INFO  Done!
2022-09-21 20:25:31 INFO  # Finished -- repetition 1 of 7 
2022-09-21 20:25:31 INFO  # Optimization benchmark for feature_importance with args [['reviews', 'slow_loading', 'featurization_3', 'logistic_regression']] -- repetition 2 of 7
2022-09-21 20:25:31 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-21 20:25:31 INFO  Running instrumented original pipeline...
2022-09-21 20:25:31 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-21 20:25:31 INFO  ---RUNTIME: Importing and monkey-patching took 6.703376770019531 ms
2022-09-21 20:26:19 INFO  ---RUNTIME: Original pipeline execution took 48095.348834991455 ms (excluding imports and monkey-patching)
2022-09-21 20:26:19 INFO  Starting execution of 1 what-if analyses...
2022-09-21 20:26:19 INFO  Start plan generation for analysis PermutationFeatureImportance...
2022-09-21 20:26:19 INFO  ---RUNTIME: Plan generation took 0.21123886108398438 ms
2022-09-21 20:26:19 INFO  Estimated runtime of original DAG is 36312.45255470276ms
2022-09-21 20:26:19 INFO  Performing Multi-Query Optimization
2022-09-21 20:26:19 INFO  Estimated unoptimized what-if runtime is 181562.2627735138ms
2022-09-21 20:26:19 INFO  Estimated optimised what-if runtime is 55478.99055480957ms
2022-09-21 20:26:19 INFO  Estimated optimisation runtime saving is 126083.27221870422ms
2022-09-21 20:26:19 INFO  ---RUNTIME: Multi-Query Optimization took 37.19043731689453 ms
2022-09-21 20:26:19 INFO  Executing generated plans
2022-09-21 20:26:54 INFO  ---RUNTIME: Execution took 34567.22664833069 ms
2022-09-21 20:26:54 INFO  Done!
2022-09-21 20:26:54 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-21 20:26:54 INFO  Running instrumented original pipeline...
2022-09-21 20:26:54 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-21 20:26:54 INFO  ---RUNTIME: Importing and monkey-patching took 10.368585586547852 ms
2022-09-21 20:27:37 INFO  ---RUNTIME: Original pipeline execution took 42582.1316242218 ms (excluding imports and monkey-patching)
2022-09-21 20:27:37 INFO  Starting execution of 1 what-if analyses...
2022-09-21 20:27:37 INFO  Start plan generation for analysis PermutationFeatureImportance...
2022-09-21 20:27:37 INFO  ---RUNTIME: Plan generation took 0.1571178436279297 ms
2022-09-21 20:27:37 INFO  Estimated runtime of original DAG is 34749.661922454834ms
2022-09-21 20:27:37 WARNING Skipping Multi-Query Optimization (instead, only applying patches)
2022-09-21 20:27:37 INFO  Estimated unoptimised what-if runtime is 173748.30961227417ms
2022-09-21 20:27:37 INFO  ---RUNTIME: Multi-Query Optimization took 5.979299545288086 ms
2022-09-21 20:27:37 INFO  Executing generated plans
2022-09-21 20:30:17 INFO  ---RUNTIME: Execution took 160351.46403312683 ms
2022-09-21 20:30:17 INFO  Done!
2022-09-21 20:30:18 INFO  # Finished -- repetition 2 of 7 
2022-09-21 20:30:18 INFO  # Optimization benchmark for feature_importance with args [['reviews', 'slow_loading', 'featurization_3', 'logistic_regression']] -- repetition 3 of 7
2022-09-21 20:30:18 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-21 20:30:18 INFO  Running instrumented original pipeline...
2022-09-21 20:30:18 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-21 20:30:18 INFO  ---RUNTIME: Importing and monkey-patching took 6.631374359130859 ms
2022-09-21 20:31:00 INFO  ---RUNTIME: Original pipeline execution took 42623.170375823975 ms (excluding imports and monkey-patching)
2022-09-21 20:31:00 INFO  Starting execution of 1 what-if analyses...
2022-09-21 20:31:00 INFO  Start plan generation for analysis PermutationFeatureImportance...
2022-09-21 20:31:00 INFO  ---RUNTIME: Plan generation took 0.1590251922607422 ms
2022-09-21 20:31:00 INFO  Estimated runtime of original DAG is 34964.45178985596ms
2022-09-21 20:31:00 INFO  Performing Multi-Query Optimization
2022-09-21 20:31:00 INFO  Estimated unoptimized what-if runtime is 174822.25894927979ms
2022-09-21 20:31:00 INFO  Estimated optimised what-if runtime is 51762.964725494385ms
2022-09-21 20:31:00 INFO  Estimated optimisation runtime saving is 123059.2942237854ms
2022-09-21 20:31:00 INFO  ---RUNTIME: Multi-Query Optimization took 12.616157531738281 ms
2022-09-21 20:31:00 INFO  Executing generated plans
2022-09-21 20:31:36 INFO  ---RUNTIME: Execution took 35330.440521240234 ms
2022-09-21 20:31:36 INFO  Done!
2022-09-21 20:31:37 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-21 20:31:37 INFO  Running instrumented original pipeline...
2022-09-21 20:31:37 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-21 20:31:37 INFO  ---RUNTIME: Importing and monkey-patching took 7.701873779296875 ms
2022-09-21 20:32:23 INFO  ---RUNTIME: Original pipeline execution took 46756.8039894104 ms (excluding imports and monkey-patching)
2022-09-21 20:32:23 INFO  Starting execution of 1 what-if analyses...
2022-09-21 20:32:23 INFO  Start plan generation for analysis PermutationFeatureImportance...
2022-09-21 20:32:23 INFO  ---RUNTIME: Plan generation took 0.1552104949951172 ms
2022-09-21 20:32:23 INFO  Estimated runtime of original DAG is 35922.877073287964ms
2022-09-21 20:32:23 WARNING Skipping Multi-Query Optimization (instead, only applying patches)
2022-09-21 20:32:23 INFO  Estimated unoptimised what-if runtime is 179614.38536643982ms
2022-09-21 20:32:23 INFO  ---RUNTIME: Multi-Query Optimization took 5.67936897277832 ms
2022-09-21 20:32:23 INFO  Executing generated plans
2022-09-21 20:35:18 INFO  ---RUNTIME: Execution took 175090.57068824768 ms
2022-09-21 20:35:18 INFO  Done!
2022-09-21 20:35:19 INFO  # Finished -- repetition 3 of 7 
2022-09-21 20:35:19 INFO  # Optimization benchmark for feature_importance with args [['reviews', 'slow_loading', 'featurization_3', 'logistic_regression']] -- repetition 4 of 7
2022-09-21 20:35:19 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-21 20:35:19 INFO  Running instrumented original pipeline...
2022-09-21 20:35:19 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-21 20:35:19 INFO  ---RUNTIME: Importing and monkey-patching took 7.040500640869141 ms
2022-09-21 20:36:05 INFO  ---RUNTIME: Original pipeline execution took 46217.68808364868 ms (excluding imports and monkey-patching)
2022-09-21 20:36:05 INFO  Starting execution of 1 what-if analyses...
2022-09-21 20:36:05 INFO  Start plan generation for analysis PermutationFeatureImportance...
2022-09-21 20:36:05 INFO  ---RUNTIME: Plan generation took 0.15020370483398438 ms
2022-09-21 20:36:05 INFO  Estimated runtime of original DAG is 33886.41691207886ms
2022-09-21 20:36:05 INFO  Performing Multi-Query Optimization
2022-09-21 20:36:05 INFO  Estimated unoptimized what-if runtime is 169432.0845603943ms
2022-09-21 20:36:05 INFO  Estimated optimised what-if runtime is 50551.424741744995ms
2022-09-21 20:36:05 INFO  Estimated optimisation runtime saving is 118880.65981864929ms
2022-09-21 20:36:05 INFO  ---RUNTIME: Multi-Query Optimization took 12.633562088012695 ms
2022-09-21 20:36:05 INFO  Executing generated plans
2022-09-21 20:36:45 INFO  ---RUNTIME: Execution took 40317.665338516235 ms
2022-09-21 20:36:45 INFO  Done!
2022-09-21 20:36:45 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-21 20:36:45 INFO  Running instrumented original pipeline...
2022-09-21 20:36:45 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-21 20:36:45 INFO  ---RUNTIME: Importing and monkey-patching took 7.812023162841797 ms
2022-09-21 20:37:27 INFO  ---RUNTIME: Original pipeline execution took 42071.49338722229 ms (excluding imports and monkey-patching)
2022-09-21 20:37:27 INFO  Starting execution of 1 what-if analyses...
2022-09-21 20:37:27 INFO  Start plan generation for analysis PermutationFeatureImportance...
2022-09-21 20:37:27 INFO  ---RUNTIME: Plan generation took 0.14209747314453125 ms
2022-09-21 20:37:27 INFO  Estimated runtime of original DAG is 34313.451528549194ms
2022-09-21 20:37:27 WARNING Skipping Multi-Query Optimization (instead, only applying patches)
2022-09-21 20:37:27 INFO  Estimated unoptimised what-if runtime is 171567.25764274597ms
2022-09-21 20:37:27 INFO  ---RUNTIME: Multi-Query Optimization took 5.148410797119141 ms
2022-09-21 20:37:27 INFO  Executing generated plans
2022-09-21 20:40:21 INFO  ---RUNTIME: Execution took 173691.06268882751 ms
2022-09-21 20:40:21 INFO  Done!
2022-09-21 20:40:22 INFO  # Finished -- repetition 4 of 7 
2022-09-21 20:40:22 INFO  # Optimization benchmark for feature_importance with args [['reviews', 'slow_loading', 'featurization_3', 'logistic_regression']] -- repetition 5 of 7
2022-09-21 20:40:22 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-21 20:40:22 INFO  Running instrumented original pipeline...
2022-09-21 20:40:22 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-21 20:40:22 INFO  ---RUNTIME: Importing and monkey-patching took 7.286548614501953 ms
2022-09-21 20:41:08 INFO  ---RUNTIME: Original pipeline execution took 45721.614837646484 ms (excluding imports and monkey-patching)
2022-09-21 20:41:08 INFO  Starting execution of 1 what-if analyses...
2022-09-21 20:41:08 INFO  Start plan generation for analysis PermutationFeatureImportance...
2022-09-21 20:41:08 INFO  ---RUNTIME: Plan generation took 0.16999244689941406 ms
2022-09-21 20:41:08 INFO  Estimated runtime of original DAG is 34663.209438323975ms
2022-09-21 20:41:08 INFO  Performing Multi-Query Optimization
2022-09-21 20:41:08 INFO  Estimated unoptimized what-if runtime is 173316.04719161987ms
2022-09-21 20:41:08 INFO  Estimated optimised what-if runtime is 52026.69858932495ms
2022-09-21 20:41:08 INFO  Estimated optimisation runtime saving is 121289.34860229492ms
2022-09-21 20:41:08 INFO  ---RUNTIME: Multi-Query Optimization took 13.340950012207031 ms
2022-09-21 20:41:08 INFO  Executing generated plans
2022-09-21 20:41:47 INFO  ---RUNTIME: Execution took 38540.90118408203 ms
2022-09-21 20:41:47 INFO  Done!
2022-09-21 20:41:48 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-21 20:41:48 INFO  Running instrumented original pipeline...
2022-09-21 20:41:48 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-21 20:41:48 INFO  ---RUNTIME: Importing and monkey-patching took 6.856441497802734 ms
2022-09-21 20:42:32 INFO  ---RUNTIME: Original pipeline execution took 44077.25119590759 ms (excluding imports and monkey-patching)
2022-09-21 20:42:32 INFO  Starting execution of 1 what-if analyses...
2022-09-21 20:42:32 INFO  Start plan generation for analysis PermutationFeatureImportance...
2022-09-21 20:42:32 INFO  ---RUNTIME: Plan generation took 0.1480579376220703 ms
2022-09-21 20:42:32 INFO  Estimated runtime of original DAG is 35202.08692550659ms
2022-09-21 20:42:32 WARNING Skipping Multi-Query Optimization (instead, only applying patches)
2022-09-21 20:42:32 INFO  Estimated unoptimised what-if runtime is 176010.43462753296ms
2022-09-21 20:42:32 INFO  ---RUNTIME: Multi-Query Optimization took 4.993200302124023 ms
2022-09-21 20:42:32 INFO  Executing generated plans
2022-09-21 20:45:36 INFO  ---RUNTIME: Execution took 183838.41228485107 ms
2022-09-21 20:45:36 INFO  Done!
2022-09-21 20:45:37 INFO  # Finished -- repetition 5 of 7 
2022-09-21 20:45:37 INFO  # Optimization benchmark for feature_importance with args [['reviews', 'slow_loading', 'featurization_3', 'logistic_regression']] -- repetition 6 of 7
2022-09-21 20:45:37 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-21 20:45:37 INFO  Running instrumented original pipeline...
2022-09-21 20:45:37 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-21 20:45:37 INFO  ---RUNTIME: Importing and monkey-patching took 6.476163864135742 ms
2022-09-21 20:46:22 INFO  ---RUNTIME: Original pipeline execution took 44939.7246837616 ms (excluding imports and monkey-patching)
2022-09-21 20:46:22 INFO  Starting execution of 1 what-if analyses...
2022-09-21 20:46:22 INFO  Start plan generation for analysis PermutationFeatureImportance...
2022-09-21 20:46:22 INFO  ---RUNTIME: Plan generation took 0.148773193359375 ms
2022-09-21 20:46:22 INFO  Estimated runtime of original DAG is 34455.75213432312ms
2022-09-21 20:46:22 INFO  Performing Multi-Query Optimization
2022-09-21 20:46:22 INFO  Estimated unoptimized what-if runtime is 172278.7606716156ms
2022-09-21 20:46:22 INFO  Estimated optimised what-if runtime is 52139.61720466614ms
2022-09-21 20:46:22 INFO  Estimated optimisation runtime saving is 120139.14346694946ms
2022-09-21 20:46:22 INFO  ---RUNTIME: Multi-Query Optimization took 13.025283813476562 ms
2022-09-21 20:46:22 INFO  Executing generated plans
2022-09-21 20:46:56 INFO  ---RUNTIME: Execution took 34226.58371925354 ms
2022-09-21 20:46:56 INFO  Done!
2022-09-21 20:46:57 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-21 20:46:57 INFO  Running instrumented original pipeline...
2022-09-21 20:46:57 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-21 20:46:57 INFO  ---RUNTIME: Importing and monkey-patching took 7.630109786987305 ms
2022-09-21 20:47:45 INFO  ---RUNTIME: Original pipeline execution took 47874.40609931946 ms (excluding imports and monkey-patching)
2022-09-21 20:47:45 INFO  Starting execution of 1 what-if analyses...
2022-09-21 20:47:45 INFO  Start plan generation for analysis PermutationFeatureImportance...
2022-09-21 20:47:45 INFO  ---RUNTIME: Plan generation took 0.1456737518310547 ms
2022-09-21 20:47:45 INFO  Estimated runtime of original DAG is 35331.00152015686ms
2022-09-21 20:47:45 WARNING Skipping Multi-Query Optimization (instead, only applying patches)
2022-09-21 20:47:45 INFO  Estimated unoptimised what-if runtime is 176655.0076007843ms
2022-09-21 20:47:45 INFO  ---RUNTIME: Multi-Query Optimization took 4.930019378662109 ms
2022-09-21 20:47:45 INFO  Executing generated plans
Traceback (most recent call last):
  File "/home/sgrafbe/mlwhatif/experiments/end_to_end/benchmarks_end_to_end.py", line 238, in <module>
    analysis_result_no_opt = PipelineAnalyzer \
  File "/home/sgrafbe/mlwhatif/mlwhatif/_pipeline_analyzer.py", line 93, in execute
    return singleton.run(notebook_path=self._notebook_path,
  File "/home/sgrafbe/mlwhatif/mlwhatif/execution/_pipeline_executor.py", line 149, in run
    self.run_what_if_analyses()
  File "/home/sgrafbe/mlwhatif/mlwhatif/execution/_pipeline_executor.py", line 181, in run_what_if_analyses
    DagExecutor(self).execute(what_if_dag)
  File "/home/sgrafbe/mlwhatif/mlwhatif/execution/_dag_executor.py", line 45, in execute
    self.traverse_graph_and_process_nodes(dag, execute_node)
  File "/home/sgrafbe/mlwhatif/mlwhatif/execution/_dag_executor.py", line 57, in traverse_graph_and_process_nodes
    result_node = func(node)
  File "/home/sgrafbe/mlwhatif/mlwhatif/execution/_dag_executor.py", line 40, in execute_node
    optimizer_info, result_df = capture_optimizer_info(executable_processing_func)
  File "/home/sgrafbe/mlwhatif/mlwhatif/execution/_stat_tracking.py", line 28, in capture_optimizer_info
    result = instrumented_function_call()
  File "/home/sgrafbe/mlwhatif/mlwhatif/monkeypatching/_patch_sklearn.py", line 1729, in processing_func
    transformed_data = wrap_in_mlinspect_array_if_necessary(transformed_data)
  File "/home/sgrafbe/mlwhatif/mlwhatif/monkeypatching/_monkey_patching_utils.py", line 229, in wrap_in_mlinspect_array_if_necessary
    df_object = MlinspectNdarray(df_object)
  File "/home/sgrafbe/mlwhatif/mlwhatif/monkeypatching/_mlinspect_ndarray.py", line 16, in __new__
    obj = numpy.asarray(input_array).view(cls)
  File "/home/sgrafbe/mlwhatif/venv/lib64/python3.9/site-packages/numpy/core/_asarray.py", line 83, in asarray
    return array(a, dtype, copy=False, order=order)
numpy.core._exceptions.MemoryError: Unable to allocate 3.89 GiB for an array with shape (35312,) and data type <U29600
taskset -c 32-39 PROTOCOL_BUFFERS_PYTHON_IMPLEMENTATION=python python3.9 benchmarks_end_to_end.py feature_importance reviews slow_loading featurization_3 xgboost
2022-09-21 20:47:58.137932: W tensorflow/stream_executor/platform/default/dso_loader.cc:64] Could not load dynamic library 'libcudart.so.11.0'; dlerror: libcudart.so.11.0: cannot open shared object file: No such file or directory; LD_LIBRARY_PATH: /home/sgrafbe/mlwhatif/venv/lib/python3.9/site-packages/cv2/../../lib64:
2022-09-21 20:47:58.137973: I tensorflow/stream_executor/cuda/cudart_stub.cc:29] Ignore above cudart dlerror if you do not have a GPU set up on your machine.
2022-09-21 20:47:59 INFO  Patching sys.argv with ['mlwhatif', 'reviews', 'slow_loading', 'featurization_3', 'xgboost']
2022-09-21 20:47:59 INFO  Running instrumented original pipeline...
2022-09-21 20:47:59 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-21 20:47:59 INFO  ---RUNTIME: Importing and monkey-patching took 112.41602897644043 ms
2022-09-21 20:48:57 INFO  ---RUNTIME: Original pipeline execution took 57238.471269607544 ms (excluding imports and monkey-patching)
2022-09-21 20:48:57 INFO  Starting execution of 0 what-if analyses...
2022-09-21 20:48:57 INFO  Estimated runtime of original DAG is 49413.381576538086ms
2022-09-21 20:48:57 INFO  Performing Multi-Query Optimization
2022-09-21 20:48:57 INFO  Estimated unoptimized what-if runtime is 0ms
2022-09-21 20:48:57 INFO  Estimated optimised what-if runtime is 0ms
2022-09-21 20:48:57 INFO  Estimated optimisation runtime saving is 0ms
2022-09-21 20:48:57 INFO  ---RUNTIME: Multi-Query Optimization took 0.5586147308349609 ms
2022-09-21 20:48:57 INFO  Executing generated plans
2022-09-21 20:48:57 INFO  ---RUNTIME: Execution took 0.024080276489257812 ms
2022-09-21 20:48:57 INFO  Done!
2022-09-21 20:48:57 INFO  # Optimization benchmark for feature_importance with args [['reviews', 'slow_loading', 'featurization_3', 'xgboost']] -- repetition 1 of 7
2022-09-21 20:48:57 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-21 20:48:57 INFO  Running instrumented original pipeline...
2022-09-21 20:48:57 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-21 20:48:57 INFO  ---RUNTIME: Importing and monkey-patching took 5.402565002441406 ms
2022-09-21 20:49:57 INFO  ---RUNTIME: Original pipeline execution took 59910.778284072876 ms (excluding imports and monkey-patching)
2022-09-21 20:49:57 INFO  Starting execution of 1 what-if analyses...
2022-09-21 20:49:57 INFO  Start plan generation for analysis PermutationFeatureImportance...
2022-09-21 20:49:57 INFO  ---RUNTIME: Plan generation took 0.24962425231933594 ms
2022-09-21 20:49:57 INFO  Estimated runtime of original DAG is 48968.11103820801ms
2022-09-21 20:49:57 INFO  Performing Multi-Query Optimization
2022-09-21 20:49:57 INFO  Estimated unoptimized what-if runtime is 244840.55519104004ms
2022-09-21 20:49:57 INFO  Estimated optimised what-if runtime is 65455.50346374512ms
2022-09-21 20:49:57 INFO  Estimated optimisation runtime saving is 179385.05172729492ms
2022-09-21 20:49:57 INFO  ---RUNTIME: Multi-Query Optimization took 12.801885604858398 ms
2022-09-21 20:49:57 INFO  Executing generated plans
2022-09-21 20:50:51 INFO  ---RUNTIME: Execution took 54619.028091430664 ms
2022-09-21 20:50:51 INFO  Done!
2022-09-21 20:50:51 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-21 20:50:51 INFO  Running instrumented original pipeline...
2022-09-21 20:50:51 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-21 20:50:51 INFO  ---RUNTIME: Importing and monkey-patching took 5.935907363891602 ms
2022-09-21 20:51:59 INFO  ---RUNTIME: Original pipeline execution took 67645.94435691833 ms (excluding imports and monkey-patching)
2022-09-21 20:51:59 INFO  Starting execution of 1 what-if analyses...
2022-09-21 20:51:59 INFO  Start plan generation for analysis PermutationFeatureImportance...
2022-09-21 20:51:59 INFO  ---RUNTIME: Plan generation took 0.1480579376220703 ms
2022-09-21 20:51:59 INFO  Estimated runtime of original DAG is 51994.70281600952ms
2022-09-21 20:51:59 WARNING Skipping Multi-Query Optimization (instead, only applying patches)
2022-09-21 20:51:59 INFO  Estimated unoptimised what-if runtime is 259973.5140800476ms
2022-09-21 20:51:59 INFO  ---RUNTIME: Multi-Query Optimization took 5.132436752319336 ms
2022-09-21 20:51:59 INFO  Executing generated plans
2022-09-21 20:57:29 INFO  ---RUNTIME: Execution took 329798.1595993042 ms
2022-09-21 20:57:29 INFO  Done!
2022-09-21 20:57:29 INFO  # Finished -- repetition 1 of 7 
2022-09-21 20:57:29 INFO  # Optimization benchmark for feature_importance with args [['reviews', 'slow_loading', 'featurization_3', 'xgboost']] -- repetition 2 of 7
2022-09-21 20:57:29 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-21 20:57:29 INFO  Running instrumented original pipeline...
2022-09-21 20:57:29 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-21 20:57:29 INFO  ---RUNTIME: Importing and monkey-patching took 63.31777572631836 ms
2022-09-21 20:58:39 INFO  ---RUNTIME: Original pipeline execution took 69966.10283851624 ms (excluding imports and monkey-patching)
2022-09-21 20:58:39 INFO  Starting execution of 1 what-if analyses...
2022-09-21 20:58:39 INFO  Start plan generation for analysis PermutationFeatureImportance...
2022-09-21 20:58:39 INFO  ---RUNTIME: Plan generation took 5.550861358642578 ms
2022-09-21 20:58:39 INFO  Estimated runtime of original DAG is 55470.83258628845ms
2022-09-21 20:58:39 INFO  Performing Multi-Query Optimization
2022-09-21 20:58:39 INFO  Estimated unoptimized what-if runtime is 277354.16293144226ms
2022-09-21 20:58:39 INFO  Estimated optimised what-if runtime is 77671.51141166687ms
2022-09-21 20:58:39 INFO  Estimated optimisation runtime saving is 199682.6515197754ms
2022-09-21 20:58:39 INFO  ---RUNTIME: Multi-Query Optimization took 53.5280704498291 ms
2022-09-21 20:58:39 INFO  Executing generated plans
./run-benchmarks--end-to-end.sh: line 50: 563579 Killed                  PROTOCOL_BUFFERS_PYTHON_IMPLEMENTATION=python taskset -c "$core_num" python3.9 benchmarks_end_to_end.py "$scenario" "$dataset" "$data_loading" "$featurization" "$model"
taskset -c 32-39 PROTOCOL_BUFFERS_PYTHON_IMPLEMENTATION=python python3.9 benchmarks_end_to_end.py feature_importance reviews slow_loading featurization_3 neural_network
2022-09-21 20:59:13.627175: W tensorflow/stream_executor/platform/default/dso_loader.cc:64] Could not load dynamic library 'libcudart.so.11.0'; dlerror: libcudart.so.11.0: cannot open shared object file: No such file or directory; LD_LIBRARY_PATH: /home/sgrafbe/mlwhatif/venv/lib/python3.9/site-packages/cv2/../../lib64:
2022-09-21 20:59:13.627209: I tensorflow/stream_executor/cuda/cudart_stub.cc:29] Ignore above cudart dlerror if you do not have a GPU set up on your machine.
2022-09-21 20:59:15 INFO  Patching sys.argv with ['mlwhatif', 'reviews', 'slow_loading', 'featurization_3', 'neural_network']
2022-09-21 20:59:15 INFO  Running instrumented original pipeline...
2022-09-21 20:59:15 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-21 20:59:15 INFO  ---RUNTIME: Importing and monkey-patching took 147.56274223327637 ms
2022-09-21 20:59:38.483763: W tensorflow/stream_executor/platform/default/dso_loader.cc:64] Could not load dynamic library 'libcuda.so.1'; dlerror: libcuda.so.1: cannot open shared object file: No such file or directory; LD_LIBRARY_PATH: /home/sgrafbe/mlwhatif/venv/lib/python3.9/site-packages/cv2/../../lib64:
2022-09-21 20:59:38.483798: W tensorflow/stream_executor/cuda/cuda_driver.cc:326] failed call to cuInit: UNKNOWN ERROR (303)
2022-09-21 20:59:38.483826: I tensorflow/stream_executor/cuda/cuda_diagnostics.cc:156] kernel driver does not appear to be running on this host (wagyu): /proc/driver/nvidia/version does not exist
2022-09-21 20:59:38.484318: I tensorflow/core/platform/cpu_feature_guard.cc:142] This TensorFlow binary is optimized with oneAPI Deep Neural Network Library (oneDNN) to use the following CPU instructions in performance-critical operations:  AVX2 FMA
To enable them in other operations, rebuild TensorFlow with the appropriate compiler flags.
2022-09-21 20:59:39.122397: I tensorflow/compiler/mlir/mlir_graph_optimization_pass.cc:176] None of the MLIR Optimization Passes are enabled (registered 2)
2022-09-21 20:59:39.136377: I tensorflow/core/platform/profile_utils/cpu_utils.cc:114] CPU Frequency: 2595290000 Hz
2022-09-21 21:00:04 INFO  ---RUNTIME: Original pipeline execution took 48580.10697364807 ms (excluding imports and monkey-patching)
2022-09-21 21:00:04 INFO  Starting execution of 0 what-if analyses...
2022-09-21 21:00:04 INFO  Estimated runtime of original DAG is 40931.68020248413ms
2022-09-21 21:00:04 INFO  Performing Multi-Query Optimization
2022-09-21 21:00:04 INFO  Estimated unoptimized what-if runtime is 0ms
2022-09-21 21:00:04 INFO  Estimated optimised what-if runtime is 0ms
2022-09-21 21:00:04 INFO  Estimated optimisation runtime saving is 0ms
2022-09-21 21:00:04 INFO  ---RUNTIME: Multi-Query Optimization took 0.5805492401123047 ms
2022-09-21 21:00:04 INFO  Executing generated plans
2022-09-21 21:00:04 INFO  ---RUNTIME: Execution took 0.0152587890625 ms
2022-09-21 21:00:04 INFO  Done!
2022-09-21 21:00:04 INFO  # Optimization benchmark for feature_importance with args [['reviews', 'slow_loading', 'featurization_3', 'neural_network']] -- repetition 1 of 7
2022-09-21 21:00:04 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-21 21:00:04 INFO  Running instrumented original pipeline...
2022-09-21 21:00:04 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-21 21:00:04 INFO  ---RUNTIME: Importing and monkey-patching took 5.541801452636719 ms
2022-09-21 21:00:54 INFO  ---RUNTIME: Original pipeline execution took 50547.78742790222 ms (excluding imports and monkey-patching)
2022-09-21 21:00:54 INFO  Starting execution of 1 what-if analyses...
2022-09-21 21:00:54 INFO  Start plan generation for analysis PermutationFeatureImportance...
2022-09-21 21:00:54 INFO  ---RUNTIME: Plan generation took 0.3082752227783203 ms
2022-09-21 21:00:54 INFO  Estimated runtime of original DAG is 40421.2384223938ms
2022-09-21 21:00:54 INFO  Performing Multi-Query Optimization
2022-09-21 21:00:54 INFO  Estimated unoptimized what-if runtime is 202106.192111969ms
2022-09-21 21:00:54 INFO  Estimated optimised what-if runtime is 59973.47569465637ms
2022-09-21 21:00:54 INFO  Estimated optimisation runtime saving is 142132.71641731262ms
2022-09-21 21:00:54 INFO  ---RUNTIME: Multi-Query Optimization took 13.732671737670898 ms
2022-09-21 21:00:54 INFO  Executing generated plans
2022-09-21 21:01:42 INFO  ---RUNTIME: Execution took 47649.66893196106 ms
2022-09-21 21:01:42 INFO  Done!
2022-09-21 21:01:42 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-21 21:01:42 INFO  Running instrumented original pipeline...
2022-09-21 21:01:42 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-21 21:01:42 INFO  ---RUNTIME: Importing and monkey-patching took 13.37742805480957 ms
2022-09-21 21:02:41 INFO  ---RUNTIME: Original pipeline execution took 59069.46086883545 ms (excluding imports and monkey-patching)
2022-09-21 21:02:41 INFO  Starting execution of 1 what-if analyses...
2022-09-21 21:02:41 INFO  Start plan generation for analysis PermutationFeatureImportance...
2022-09-21 21:02:41 INFO  ---RUNTIME: Plan generation took 0.1461505889892578 ms
2022-09-21 21:02:41 INFO  Estimated runtime of original DAG is 44508.076429367065ms
2022-09-21 21:02:41 WARNING Skipping Multi-Query Optimization (instead, only applying patches)
2022-09-21 21:02:41 INFO  Estimated unoptimised what-if runtime is 222540.38214683533ms
2022-09-21 21:02:41 INFO  ---RUNTIME: Multi-Query Optimization took 4.972696304321289 ms
2022-09-21 21:02:41 INFO  Executing generated plans
2022-09-21 21:06:07 INFO  ---RUNTIME: Execution took 205390.86246490479 ms
2022-09-21 21:06:07 INFO  Done!
2022-09-21 21:06:07 INFO  # Finished -- repetition 1 of 7 
2022-09-21 21:06:07 INFO  # Optimization benchmark for feature_importance with args [['reviews', 'slow_loading', 'featurization_3', 'neural_network']] -- repetition 2 of 7
2022-09-21 21:06:07 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-21 21:06:07 INFO  Running instrumented original pipeline...
2022-09-21 21:06:07 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-21 21:06:07 INFO  ---RUNTIME: Importing and monkey-patching took 10.068178176879883 ms
2022-09-21 21:07:05 INFO  ---RUNTIME: Original pipeline execution took 58243.93630027771 ms (excluding imports and monkey-patching)
2022-09-21 21:07:05 INFO  Starting execution of 1 what-if analyses...
2022-09-21 21:07:05 INFO  Start plan generation for analysis PermutationFeatureImportance...
2022-09-21 21:07:05 INFO  ---RUNTIME: Plan generation took 0.1575946807861328 ms
2022-09-21 21:07:05 INFO  Estimated runtime of original DAG is 43422.15704917908ms
2022-09-21 21:07:05 INFO  Performing Multi-Query Optimization
2022-09-21 21:07:05 INFO  Estimated unoptimized what-if runtime is 217110.7852458954ms
2022-09-21 21:07:05 INFO  Estimated optimised what-if runtime is 64550.90093612671ms
2022-09-21 21:07:05 INFO  Estimated optimisation runtime saving is 152559.88430976868ms
2022-09-21 21:07:05 INFO  ---RUNTIME: Multi-Query Optimization took 12.645244598388672 ms
2022-09-21 21:07:05 INFO  Executing generated plans
2022-09-21 21:07:44 INFO  ---RUNTIME: Execution took 38704.821825027466 ms
2022-09-21 21:07:44 INFO  Done!
2022-09-21 21:07:45 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-21 21:07:45 INFO  Running instrumented original pipeline...
2022-09-21 21:07:45 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-21 21:07:45 INFO  ---RUNTIME: Importing and monkey-patching took 6.598472595214844 ms
2022-09-21 21:08:33 INFO  ---RUNTIME: Original pipeline execution took 48369.26984786987 ms (excluding imports and monkey-patching)
2022-09-21 21:08:33 INFO  Starting execution of 1 what-if analyses...
2022-09-21 21:08:33 INFO  Start plan generation for analysis PermutationFeatureImportance...
2022-09-21 21:08:33 INFO  ---RUNTIME: Plan generation took 0.14972686767578125 ms
2022-09-21 21:08:33 INFO  Estimated runtime of original DAG is 40823.216915130615ms
2022-09-21 21:08:33 WARNING Skipping Multi-Query Optimization (instead, only applying patches)
2022-09-21 21:08:33 INFO  Estimated unoptimised what-if runtime is 204116.08457565308ms
2022-09-21 21:08:33 INFO  ---RUNTIME: Multi-Query Optimization took 4.851579666137695 ms
2022-09-21 21:08:33 INFO  Executing generated plans
2022-09-21 21:11:12 INFO  ---RUNTIME: Execution took 158280.06219863892 ms
2022-09-21 21:11:12 INFO  Done!
2022-09-21 21:11:13 INFO  # Finished -- repetition 2 of 7 
2022-09-21 21:11:13 INFO  # Optimization benchmark for feature_importance with args [['reviews', 'slow_loading', 'featurization_3', 'neural_network']] -- repetition 3 of 7
2022-09-21 21:11:13 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-21 21:11:13 INFO  Running instrumented original pipeline...
2022-09-21 21:11:13 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-21 21:11:13 INFO  ---RUNTIME: Importing and monkey-patching took 6.577253341674805 ms
2022-09-21 21:12:02 INFO  ---RUNTIME: Original pipeline execution took 48603.839635849 ms (excluding imports and monkey-patching)
2022-09-21 21:12:02 INFO  Starting execution of 1 what-if analyses...
2022-09-21 21:12:02 INFO  Start plan generation for analysis PermutationFeatureImportance...
2022-09-21 21:12:02 INFO  ---RUNTIME: Plan generation took 0.1952648162841797 ms
2022-09-21 21:12:02 INFO  Estimated runtime of original DAG is 40462.84747123718ms
2022-09-21 21:12:02 INFO  Performing Multi-Query Optimization
2022-09-21 21:12:02 INFO  Estimated unoptimized what-if runtime is 202314.2373561859ms
2022-09-21 21:12:02 INFO  Estimated optimised what-if runtime is 59903.76114845276ms
2022-09-21 21:12:02 INFO  Estimated optimisation runtime saving is 142410.47620773315ms
2022-09-21 21:12:02 INFO  ---RUNTIME: Multi-Query Optimization took 18.996238708496094 ms
2022-09-21 21:12:02 INFO  Executing generated plans
2022-09-21 21:12:46 INFO  ---RUNTIME: Execution took 44019.871950149536 ms
2022-09-21 21:12:46 INFO  Done!
2022-09-21 21:12:47 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-21 21:12:47 INFO  Running instrumented original pipeline...
2022-09-21 21:12:47 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-21 21:12:47 INFO  ---RUNTIME: Importing and monkey-patching took 6.684064865112305 ms
2022-09-21 21:13:43 INFO  ---RUNTIME: Original pipeline execution took 55585.429668426514 ms (excluding imports and monkey-patching)
2022-09-21 21:13:43 INFO  Starting execution of 1 what-if analyses...
2022-09-21 21:13:43 INFO  Start plan generation for analysis PermutationFeatureImportance...
2022-09-21 21:13:43 INFO  ---RUNTIME: Plan generation took 0.15115737915039062 ms
2022-09-21 21:13:43 INFO  Estimated runtime of original DAG is 43011.73758506775ms
2022-09-21 21:13:43 WARNING Skipping Multi-Query Optimization (instead, only applying patches)
2022-09-21 21:13:43 INFO  Estimated unoptimised what-if runtime is 215058.68792533875ms
2022-09-21 21:13:43 INFO  ---RUNTIME: Multi-Query Optimization took 4.871606826782227 ms
2022-09-21 21:13:43 INFO  Executing generated plans
2022-09-21 21:17:06 INFO  ---RUNTIME: Execution took 203501.84845924377 ms
2022-09-21 21:17:06 INFO  Done!
2022-09-21 21:17:06 INFO  # Finished -- repetition 3 of 7 
2022-09-21 21:17:06 INFO  # Optimization benchmark for feature_importance with args [['reviews', 'slow_loading', 'featurization_3', 'neural_network']] -- repetition 4 of 7
2022-09-21 21:17:06 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-21 21:17:06 INFO  Running instrumented original pipeline...
2022-09-21 21:17:06 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-21 21:17:06 INFO  ---RUNTIME: Importing and monkey-patching took 6.475210189819336 ms
2022-09-21 21:17:54 INFO  ---RUNTIME: Original pipeline execution took 47562.19410896301 ms (excluding imports and monkey-patching)
2022-09-21 21:17:54 INFO  Starting execution of 1 what-if analyses...
2022-09-21 21:17:54 INFO  Start plan generation for analysis PermutationFeatureImportance...
2022-09-21 21:17:54 INFO  ---RUNTIME: Plan generation took 0.15306472778320312 ms
2022-09-21 21:17:54 INFO  Estimated runtime of original DAG is 40283.46133232117ms
2022-09-21 21:17:54 INFO  Performing Multi-Query Optimization
2022-09-21 21:17:54 INFO  Estimated unoptimized what-if runtime is 201417.30666160583ms
2022-09-21 21:17:54 INFO  Estimated optimised what-if runtime is 59833.152532577515ms
2022-09-21 21:17:54 INFO  Estimated optimisation runtime saving is 141584.15412902832ms
2022-09-21 21:17:54 INFO  ---RUNTIME: Multi-Query Optimization took 12.515783309936523 ms
2022-09-21 21:17:54 INFO  Executing generated plans
2022-09-21 21:18:42 INFO  ---RUNTIME: Execution took 47807.193756103516 ms
2022-09-21 21:18:42 INFO  Done!
2022-09-21 21:18:43 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-21 21:18:43 INFO  Running instrumented original pipeline...
2022-09-21 21:18:43 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-21 21:18:43 INFO  ---RUNTIME: Importing and monkey-patching took 6.386518478393555 ms
2022-09-21 21:19:31 INFO  ---RUNTIME: Original pipeline execution took 48901.469707489014 ms (excluding imports and monkey-patching)
2022-09-21 21:19:31 INFO  Starting execution of 1 what-if analyses...
2022-09-21 21:19:31 INFO  Start plan generation for analysis PermutationFeatureImportance...
2022-09-21 21:19:31 INFO  ---RUNTIME: Plan generation took 0.15926361083984375 ms
2022-09-21 21:19:31 INFO  Estimated runtime of original DAG is 40852.65922546387ms
2022-09-21 21:19:31 WARNING Skipping Multi-Query Optimization (instead, only applying patches)
2022-09-21 21:19:32 INFO  Estimated unoptimised what-if runtime is 204263.29612731934ms
2022-09-21 21:19:32 INFO  ---RUNTIME: Multi-Query Optimization took 4.911661148071289 ms
2022-09-21 21:19:32 INFO  Executing generated plans
2022-09-21 21:22:51 INFO  ---RUNTIME: Execution took 199709.57803726196 ms
2022-09-21 21:22:51 INFO  Done!
2022-09-21 21:22:53 INFO  # Finished -- repetition 4 of 7 
2022-09-21 21:22:53 INFO  # Optimization benchmark for feature_importance with args [['reviews', 'slow_loading', 'featurization_3', 'neural_network']] -- repetition 5 of 7
2022-09-21 21:22:53 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-21 21:22:53 INFO  Running instrumented original pipeline...
2022-09-21 21:22:53 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-21 21:22:53 INFO  ---RUNTIME: Importing and monkey-patching took 6.00743293762207 ms
2022-09-21 21:23:51 INFO  ---RUNTIME: Original pipeline execution took 58312.798261642456 ms (excluding imports and monkey-patching)
2022-09-21 21:23:51 INFO  Starting execution of 1 what-if analyses...
2022-09-21 21:23:51 INFO  Start plan generation for analysis PermutationFeatureImportance...
2022-09-21 21:23:51 INFO  ---RUNTIME: Plan generation took 0.1544952392578125 ms
2022-09-21 21:23:51 INFO  Estimated runtime of original DAG is 44272.13907241821ms
2022-09-21 21:23:51 INFO  Performing Multi-Query Optimization
2022-09-21 21:23:51 INFO  Estimated unoptimized what-if runtime is 221360.69536209106ms
2022-09-21 21:23:51 INFO  Estimated optimised what-if runtime is 65278.178691864014ms
2022-09-21 21:23:51 INFO  Estimated optimisation runtime saving is 156082.51667022705ms
2022-09-21 21:23:51 INFO  ---RUNTIME: Multi-Query Optimization took 14.763355255126953 ms
2022-09-21 21:23:51 INFO  Executing generated plans
2022-09-21 21:24:52 INFO  ---RUNTIME: Execution took 60983.29782485962 ms
2022-09-21 21:24:52 INFO  Done!
2022-09-21 21:24:52 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-21 21:24:52 INFO  Running instrumented original pipeline...
2022-09-21 21:24:52 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-21 21:24:52 INFO  ---RUNTIME: Importing and monkey-patching took 6.307363510131836 ms
2022-09-21 21:25:48 INFO  ---RUNTIME: Original pipeline execution took 55413.596868515015 ms (excluding imports and monkey-patching)
2022-09-21 21:25:48 INFO  Starting execution of 1 what-if analyses...
2022-09-21 21:25:48 INFO  Start plan generation for analysis PermutationFeatureImportance...
2022-09-21 21:25:48 INFO  ---RUNTIME: Plan generation took 0.1544952392578125 ms
2022-09-21 21:25:48 INFO  Estimated runtime of original DAG is 46117.54322052002ms
2022-09-21 21:25:48 WARNING Skipping Multi-Query Optimization (instead, only applying patches)
2022-09-21 21:25:48 INFO  Estimated unoptimised what-if runtime is 230587.7161026001ms
2022-09-21 21:25:48 INFO  ---RUNTIME: Multi-Query Optimization took 4.822969436645508 ms
2022-09-21 21:25:48 INFO  Executing generated plans
2022-09-21 21:29:50 INFO  ---RUNTIME: Execution took 242221.68684005737 ms
2022-09-21 21:29:50 INFO  Done!
2022-09-21 21:29:50 INFO  # Finished -- repetition 5 of 7 
2022-09-21 21:29:50 INFO  # Optimization benchmark for feature_importance with args [['reviews', 'slow_loading', 'featurization_3', 'neural_network']] -- repetition 6 of 7
2022-09-21 21:29:50 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-21 21:29:50 INFO  Running instrumented original pipeline...
2022-09-21 21:29:51 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-21 21:29:51 INFO  ---RUNTIME: Importing and monkey-patching took 8.459091186523438 ms
2022-09-21 21:30:44 INFO  ---RUNTIME: Original pipeline execution took 53618.01743507385 ms (excluding imports and monkey-patching)
2022-09-21 21:30:44 INFO  Starting execution of 1 what-if analyses...
2022-09-21 21:30:44 INFO  Start plan generation for analysis PermutationFeatureImportance...
2022-09-21 21:30:44 INFO  ---RUNTIME: Plan generation took 0.14901161193847656 ms
2022-09-21 21:30:44 INFO  Estimated runtime of original DAG is 44144.64211463928ms
2022-09-21 21:30:44 INFO  Performing Multi-Query Optimization
2022-09-21 21:30:44 INFO  Estimated unoptimized what-if runtime is 220723.2105731964ms
2022-09-21 21:30:44 INFO  Estimated optimised what-if runtime is 64635.929346084595ms
2022-09-21 21:30:44 INFO  Estimated optimisation runtime saving is 156087.28122711182ms
2022-09-21 21:30:44 INFO  ---RUNTIME: Multi-Query Optimization took 13.133525848388672 ms
2022-09-21 21:30:44 INFO  Executing generated plans
2022-09-21 21:31:48 INFO  ---RUNTIME: Execution took 63711.99321746826 ms
2022-09-21 21:31:48 INFO  Done!
2022-09-21 21:31:49 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-21 21:31:49 INFO  Running instrumented original pipeline...
2022-09-21 21:31:49 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-21 21:31:49 INFO  ---RUNTIME: Importing and monkey-patching took 6.689786911010742 ms
2022-09-21 21:32:52 INFO  ---RUNTIME: Original pipeline execution took 62068.392753601074 ms (excluding imports and monkey-patching)
2022-09-21 21:32:52 INFO  Starting execution of 1 what-if analyses...
2022-09-21 21:32:52 INFO  Start plan generation for analysis PermutationFeatureImportance...
2022-09-21 21:32:52 INFO  ---RUNTIME: Plan generation took 0.1499652862548828 ms
2022-09-21 21:32:52 INFO  Estimated runtime of original DAG is 46858.856439590454ms
2022-09-21 21:32:52 WARNING Skipping Multi-Query Optimization (instead, only applying patches)
2022-09-21 21:32:52 INFO  Estimated unoptimised what-if runtime is 234294.28219795227ms
2022-09-21 21:32:52 INFO  ---RUNTIME: Multi-Query Optimization took 5.412101745605469 ms
2022-09-21 21:32:52 INFO  Executing generated plans
2022-09-21 21:36:57 INFO  ---RUNTIME: Execution took 245027.87518501282 ms
2022-09-21 21:36:57 INFO  Done!
2022-09-21 21:36:57 INFO  # Finished -- repetition 6 of 7 
2022-09-21 21:36:57 INFO  # Optimization benchmark for feature_importance with args [['reviews', 'slow_loading', 'featurization_3', 'neural_network']] -- repetition 7 of 7
2022-09-21 21:36:57 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-21 21:36:57 INFO  Running instrumented original pipeline...
2022-09-21 21:36:57 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-21 21:36:57 INFO  ---RUNTIME: Importing and monkey-patching took 6.333112716674805 ms
2022-09-21 21:37:55 INFO  ---RUNTIME: Original pipeline execution took 58384.59658622742 ms (excluding imports and monkey-patching)
2022-09-21 21:37:55 INFO  Starting execution of 1 what-if analyses...
2022-09-21 21:37:55 INFO  Start plan generation for analysis PermutationFeatureImportance...
2022-09-21 21:37:55 INFO  ---RUNTIME: Plan generation took 0.21839141845703125 ms
2022-09-21 21:37:55 INFO  Estimated runtime of original DAG is 49860.76354980469ms
2022-09-21 21:37:55 INFO  Performing Multi-Query Optimization
2022-09-21 21:37:55 INFO  Estimated unoptimized what-if runtime is 249303.81774902344ms
2022-09-21 21:37:55 INFO  Estimated optimised what-if runtime is 78490.19980430603ms
2022-09-21 21:37:55 INFO  Estimated optimisation runtime saving is 170813.6179447174ms
2022-09-21 21:37:55 INFO  ---RUNTIME: Multi-Query Optimization took 29.249191284179688 ms
2022-09-21 21:37:55 INFO  Executing generated plans
2022-09-21 21:38:49 INFO  ---RUNTIME: Execution took 54327.4827003479 ms
2022-09-21 21:38:49 INFO  Done!
2022-09-21 21:38:50 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-21 21:38:50 INFO  Running instrumented original pipeline...
2022-09-21 21:38:50 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-21 21:38:50 INFO  ---RUNTIME: Importing and monkey-patching took 6.439685821533203 ms
2022-09-21 21:39:45 INFO  ---RUNTIME: Original pipeline execution took 55096.88472747803 ms (excluding imports and monkey-patching)
2022-09-21 21:39:45 INFO  Starting execution of 1 what-if analyses...
2022-09-21 21:39:45 INFO  Start plan generation for analysis PermutationFeatureImportance...
2022-09-21 21:39:45 INFO  ---RUNTIME: Plan generation took 0.16307830810546875 ms
2022-09-21 21:39:45 INFO  Estimated runtime of original DAG is 46333.22191238403ms
2022-09-21 21:39:45 WARNING Skipping Multi-Query Optimization (instead, only applying patches)
2022-09-21 21:39:45 INFO  Estimated unoptimised what-if runtime is 231666.10956192017ms
2022-09-21 21:39:45 INFO  ---RUNTIME: Multi-Query Optimization took 4.931211471557617 ms
2022-09-21 21:39:45 INFO  Executing generated plans
2022-09-21 21:43:50 INFO  ---RUNTIME: Execution took 245377.19058990479 ms
2022-09-21 21:43:50 INFO  Done!
2022-09-21 21:43:52 INFO  # Finished -- repetition 7 of 7 
2022-09-21 21:43:52 INFO  # Final results after all repetitions
2022-09-21 21:43:52 INFO     repetition  ... no_opt_what_if_execution_combined_model_training
0           0  ...                                     33082.722902
1           1  ...                                     30983.885765
2           2  ...                                     31129.929304
3           3  ...                                     30748.787165
4           4  ...                                     33395.554543
5           5  ...                                     42601.802349
6           6  ...                                     43555.755854

[7 rows x 26 columns]
taskset -c 32-39 PROTOCOL_BUFFERS_PYTHON_IMPLEMENTATION=python python3.9 benchmarks_end_to_end.py feature_importance reviews slow_loading featurization_4 logistic_regression
2022-09-21 21:43:57.304913: W tensorflow/stream_executor/platform/default/dso_loader.cc:64] Could not load dynamic library 'libcudart.so.11.0'; dlerror: libcudart.so.11.0: cannot open shared object file: No such file or directory; LD_LIBRARY_PATH: /home/sgrafbe/mlwhatif/venv/lib/python3.9/site-packages/cv2/../../lib64:
2022-09-21 21:43:57.304962: I tensorflow/stream_executor/cuda/cudart_stub.cc:29] Ignore above cudart dlerror if you do not have a GPU set up on your machine.
2022-09-21 21:43:58 INFO  Patching sys.argv with ['mlwhatif', 'reviews', 'slow_loading', 'featurization_4', 'logistic_regression']
2022-09-21 21:43:58 INFO  Running instrumented original pipeline...
2022-09-21 21:43:58 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-21 21:43:58 INFO  ---RUNTIME: Importing and monkey-patching took 96.80008888244629 ms
2022-09-21 21:44:12 INFO  ---RUNTIME: Original pipeline execution took 13304.346561431885 ms (excluding imports and monkey-patching)
2022-09-21 21:44:12 INFO  Starting execution of 0 what-if analyses...
2022-09-21 21:44:12 INFO  Estimated runtime of original DAG is 9925.540447235107ms
2022-09-21 21:44:12 INFO  Performing Multi-Query Optimization
2022-09-21 21:44:12 INFO  Estimated unoptimized what-if runtime is 0ms
2022-09-21 21:44:12 INFO  Estimated optimised what-if runtime is 0ms
2022-09-21 21:44:12 INFO  Estimated optimisation runtime saving is 0ms
2022-09-21 21:44:12 INFO  ---RUNTIME: Multi-Query Optimization took 0.6334781646728516 ms
2022-09-21 21:44:12 INFO  Executing generated plans
2022-09-21 21:44:12 INFO  ---RUNTIME: Execution took 0.027894973754882812 ms
2022-09-21 21:44:12 INFO  Done!
2022-09-21 21:44:12 INFO  # Optimization benchmark for feature_importance with args [['reviews', 'slow_loading', 'featurization_4', 'logistic_regression']] -- repetition 1 of 7
2022-09-21 21:44:12 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-21 21:44:12 INFO  Running instrumented original pipeline...
2022-09-21 21:44:12 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-21 21:44:12 INFO  ---RUNTIME: Importing and monkey-patching took 6.050586700439453 ms
2022-09-21 21:44:29 INFO  ---RUNTIME: Original pipeline execution took 17352.88405418396 ms (excluding imports and monkey-patching)
2022-09-21 21:44:29 INFO  Starting execution of 1 what-if analyses...
2022-09-21 21:44:29 INFO  Start plan generation for analysis PermutationFeatureImportance...
2022-09-21 21:44:29 INFO  ---RUNTIME: Plan generation took 0.27251243591308594 ms
2022-09-21 21:44:29 INFO  Estimated runtime of original DAG is 12556.540727615356ms
2022-09-21 21:44:29 INFO  Performing Multi-Query Optimization
2022-09-21 21:44:29 INFO  Estimated unoptimized what-if runtime is 62782.70363807678ms
2022-09-21 21:44:29 INFO  Estimated optimised what-if runtime is 12900.523900985718ms
2022-09-21 21:44:29 INFO  Estimated optimisation runtime saving is 49882.179737091064ms
2022-09-21 21:44:29 INFO  ---RUNTIME: Multi-Query Optimization took 17.518281936645508 ms
2022-09-21 21:44:29 INFO  Executing generated plans
2022-09-21 21:44:45 INFO  ---RUNTIME: Execution took 16503.067016601562 ms
2022-09-21 21:44:45 INFO  Done!
2022-09-21 21:44:45 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-21 21:44:45 INFO  Running instrumented original pipeline...
2022-09-21 21:44:45 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-21 21:44:45 INFO  ---RUNTIME: Importing and monkey-patching took 6.092309951782227 ms
2022-09-21 21:44:59 INFO  ---RUNTIME: Original pipeline execution took 14091.882228851318 ms (excluding imports and monkey-patching)
2022-09-21 21:44:59 INFO  Starting execution of 1 what-if analyses...
2022-09-21 21:44:59 INFO  Start plan generation for analysis PermutationFeatureImportance...
2022-09-21 21:44:59 INFO  ---RUNTIME: Plan generation took 0.1888275146484375 ms
2022-09-21 21:45:00 INFO  Estimated runtime of original DAG is 10135.576725006104ms
2022-09-21 21:45:00 WARNING Skipping Multi-Query Optimization (instead, only applying patches)
2022-09-21 21:45:00 INFO  Estimated unoptimised what-if runtime is 50677.88362503052ms
2022-09-21 21:45:00 INFO  ---RUNTIME: Multi-Query Optimization took 7.724523544311523 ms
2022-09-21 21:45:00 INFO  Executing generated plans
2022-09-21 21:45:59 INFO  ---RUNTIME: Execution took 59811.88082695007 ms
2022-09-21 21:45:59 INFO  Done!
2022-09-21 21:45:59 INFO  # Finished -- repetition 1 of 7 
2022-09-21 21:45:59 INFO  # Optimization benchmark for feature_importance with args [['reviews', 'slow_loading', 'featurization_4', 'logistic_regression']] -- repetition 2 of 7
2022-09-21 21:45:59 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-21 21:45:59 INFO  Running instrumented original pipeline...
2022-09-21 21:45:59 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-21 21:45:59 INFO  ---RUNTIME: Importing and monkey-patching took 6.009340286254883 ms
2022-09-21 21:46:14 INFO  ---RUNTIME: Original pipeline execution took 14522.966146469116 ms (excluding imports and monkey-patching)
2022-09-21 21:46:14 INFO  Starting execution of 1 what-if analyses...
2022-09-21 21:46:14 INFO  Start plan generation for analysis PermutationFeatureImportance...
2022-09-21 21:46:14 INFO  ---RUNTIME: Plan generation took 0.12755393981933594 ms
2022-09-21 21:46:14 INFO  Estimated runtime of original DAG is 10719.841241836548ms
2022-09-21 21:46:14 INFO  Performing Multi-Query Optimization
2022-09-21 21:46:14 INFO  Estimated unoptimized what-if runtime is 53599.20620918274ms
2022-09-21 21:46:14 INFO  Estimated optimised what-if runtime is 10926.97262763977ms
2022-09-21 21:46:14 INFO  Estimated optimisation runtime saving is 42672.23358154297ms
2022-09-21 21:46:14 INFO  ---RUNTIME: Multi-Query Optimization took 11.102914810180664 ms
2022-09-21 21:46:14 INFO  Executing generated plans
2022-09-21 21:46:25 INFO  ---RUNTIME: Execution took 11141.672611236572 ms
2022-09-21 21:46:25 INFO  Done!
2022-09-21 21:46:25 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-21 21:46:25 INFO  Running instrumented original pipeline...
2022-09-21 21:46:25 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-21 21:46:25 INFO  ---RUNTIME: Importing and monkey-patching took 8.876323699951172 ms
2022-09-21 21:46:40 INFO  ---RUNTIME: Original pipeline execution took 14662.533283233643 ms (excluding imports and monkey-patching)
2022-09-21 21:46:40 INFO  Starting execution of 1 what-if analyses...
2022-09-21 21:46:40 INFO  Start plan generation for analysis PermutationFeatureImportance...
2022-09-21 21:46:40 INFO  ---RUNTIME: Plan generation took 0.12421607971191406 ms
2022-09-21 21:46:40 INFO  Estimated runtime of original DAG is 11275.189876556396ms
2022-09-21 21:46:40 WARNING Skipping Multi-Query Optimization (instead, only applying patches)
2022-09-21 21:46:40 INFO  Estimated unoptimised what-if runtime is 56375.94938278198ms
2022-09-21 21:46:40 INFO  ---RUNTIME: Multi-Query Optimization took 4.3659210205078125 ms
2022-09-21 21:46:40 INFO  Executing generated plans
2022-09-21 21:47:35 INFO  ---RUNTIME: Execution took 55801.613092422485 ms
2022-09-21 21:47:35 INFO  Done!
2022-09-21 21:47:35 INFO  # Finished -- repetition 2 of 7 
2022-09-21 21:47:35 INFO  # Optimization benchmark for feature_importance with args [['reviews', 'slow_loading', 'featurization_4', 'logistic_regression']] -- repetition 3 of 7
2022-09-21 21:47:35 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-21 21:47:36 INFO  Running instrumented original pipeline...
2022-09-21 21:47:36 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-21 21:47:36 INFO  ---RUNTIME: Importing and monkey-patching took 6.793498992919922 ms
2022-09-21 21:47:49 INFO  ---RUNTIME: Original pipeline execution took 13544.082164764404 ms (excluding imports and monkey-patching)
2022-09-21 21:47:49 INFO  Starting execution of 1 what-if analyses...
2022-09-21 21:47:49 INFO  Start plan generation for analysis PermutationFeatureImportance...
2022-09-21 21:47:49 INFO  ---RUNTIME: Plan generation took 0.12826919555664062 ms
2022-09-21 21:47:49 INFO  Estimated runtime of original DAG is 10227.901220321655ms
2022-09-21 21:47:49 INFO  Performing Multi-Query Optimization
2022-09-21 21:47:49 INFO  Estimated unoptimized what-if runtime is 51139.50610160828ms
2022-09-21 21:47:49 INFO  Estimated optimised what-if runtime is 10465.399980545044ms
2022-09-21 21:47:49 INFO  Estimated optimisation runtime saving is 40674.10612106323ms
2022-09-21 21:47:49 INFO  ---RUNTIME: Multi-Query Optimization took 11.007070541381836 ms
2022-09-21 21:47:49 INFO  Executing generated plans
2022-09-21 21:48:01 INFO  ---RUNTIME: Execution took 11699.59020614624 ms
2022-09-21 21:48:01 INFO  Done!
2022-09-21 21:48:01 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-21 21:48:01 INFO  Running instrumented original pipeline...
2022-09-21 21:48:01 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-21 21:48:01 INFO  ---RUNTIME: Importing and monkey-patching took 6.444215774536133 ms
2022-09-21 21:48:15 INFO  ---RUNTIME: Original pipeline execution took 14240.660429000854 ms (excluding imports and monkey-patching)
2022-09-21 21:48:15 INFO  Starting execution of 1 what-if analyses...
2022-09-21 21:48:15 INFO  Start plan generation for analysis PermutationFeatureImportance...
2022-09-21 21:48:15 INFO  ---RUNTIME: Plan generation took 0.10538101196289062 ms
2022-09-21 21:48:15 INFO  Estimated runtime of original DAG is 10842.015266418457ms
2022-09-21 21:48:15 WARNING Skipping Multi-Query Optimization (instead, only applying patches)
2022-09-21 21:48:15 INFO  Estimated unoptimised what-if runtime is 54210.076332092285ms
2022-09-21 21:48:15 INFO  ---RUNTIME: Multi-Query Optimization took 4.554986953735352 ms
2022-09-21 21:48:15 INFO  Executing generated plans
2022-09-21 21:49:10 INFO  ---RUNTIME: Execution took 55467.32449531555 ms
2022-09-21 21:49:10 INFO  Done!
2022-09-21 21:49:10 INFO  # Finished -- repetition 3 of 7 
2022-09-21 21:49:10 INFO  # Optimization benchmark for feature_importance with args [['reviews', 'slow_loading', 'featurization_4', 'logistic_regression']] -- repetition 4 of 7
2022-09-21 21:49:10 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-21 21:49:11 INFO  Running instrumented original pipeline...
2022-09-21 21:49:11 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-21 21:49:11 INFO  ---RUNTIME: Importing and monkey-patching took 6.7291259765625 ms
2022-09-21 21:49:24 INFO  ---RUNTIME: Original pipeline execution took 13658.153772354126 ms (excluding imports and monkey-patching)
2022-09-21 21:49:24 INFO  Starting execution of 1 what-if analyses...
2022-09-21 21:49:24 INFO  Start plan generation for analysis PermutationFeatureImportance...
2022-09-21 21:49:24 INFO  ---RUNTIME: Plan generation took 0.095367431640625 ms
2022-09-21 21:49:24 INFO  Estimated runtime of original DAG is 10053.557634353638ms
2022-09-21 21:49:24 INFO  Performing Multi-Query Optimization
2022-09-21 21:49:24 INFO  Estimated unoptimized what-if runtime is 50267.78817176819ms
2022-09-21 21:49:24 INFO  Estimated optimised what-if runtime is 10300.052642822266ms
2022-09-21 21:49:24 INFO  Estimated optimisation runtime saving is 39967.73552894592ms
2022-09-21 21:49:24 INFO  ---RUNTIME: Multi-Query Optimization took 10.90550422668457 ms
2022-09-21 21:49:24 INFO  Executing generated plans
2022-09-21 21:49:36 INFO  ---RUNTIME: Execution took 11335.527420043945 ms
2022-09-21 21:49:36 INFO  Done!
2022-09-21 21:49:36 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-21 21:49:36 INFO  Running instrumented original pipeline...
2022-09-21 21:49:36 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-21 21:49:36 INFO  ---RUNTIME: Importing and monkey-patching took 5.947113037109375 ms
2022-09-21 21:49:49 INFO  ---RUNTIME: Original pipeline execution took 13640.06495475769 ms (excluding imports and monkey-patching)
2022-09-21 21:49:49 INFO  Starting execution of 1 what-if analyses...
2022-09-21 21:49:49 INFO  Start plan generation for analysis PermutationFeatureImportance...
2022-09-21 21:49:49 INFO  ---RUNTIME: Plan generation took 0.09965896606445312 ms
2022-09-21 21:49:49 INFO  Estimated runtime of original DAG is 10115.485906600952ms
2022-09-21 21:49:49 WARNING Skipping Multi-Query Optimization (instead, only applying patches)
2022-09-21 21:49:49 INFO  Estimated unoptimised what-if runtime is 50577.42953300476ms
2022-09-21 21:49:49 INFO  ---RUNTIME: Multi-Query Optimization took 4.294395446777344 ms
2022-09-21 21:49:49 INFO  Executing generated plans
2022-09-21 21:50:44 INFO  ---RUNTIME: Execution took 54753.0243396759 ms
2022-09-21 21:50:44 INFO  Done!
2022-09-21 21:50:44 INFO  # Finished -- repetition 4 of 7 
2022-09-21 21:50:44 INFO  # Optimization benchmark for feature_importance with args [['reviews', 'slow_loading', 'featurization_4', 'logistic_regression']] -- repetition 5 of 7
2022-09-21 21:50:44 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-21 21:50:44 INFO  Running instrumented original pipeline...
2022-09-21 21:50:44 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-21 21:50:44 INFO  ---RUNTIME: Importing and monkey-patching took 6.220817565917969 ms
2022-09-21 21:50:57 INFO  ---RUNTIME: Original pipeline execution took 13198.509693145752 ms (excluding imports and monkey-patching)
2022-09-21 21:50:57 INFO  Starting execution of 1 what-if analyses...
2022-09-21 21:50:57 INFO  Start plan generation for analysis PermutationFeatureImportance...
2022-09-21 21:50:57 INFO  ---RUNTIME: Plan generation took 0.12135505676269531 ms
2022-09-21 21:50:57 INFO  Estimated runtime of original DAG is 9933.611869812012ms
2022-09-21 21:50:57 INFO  Performing Multi-Query Optimization
2022-09-21 21:50:57 INFO  Estimated unoptimized what-if runtime is 49668.05934906006ms
2022-09-21 21:50:57 INFO  Estimated optimised what-if runtime is 10140.59567451477ms
2022-09-21 21:50:57 INFO  Estimated optimisation runtime saving is 39527.46367454529ms
2022-09-21 21:50:57 INFO  ---RUNTIME: Multi-Query Optimization took 11.064529418945312 ms
2022-09-21 21:50:57 INFO  Executing generated plans
2022-09-21 21:51:09 INFO  ---RUNTIME: Execution took 11850.441217422485 ms
2022-09-21 21:51:09 INFO  Done!
2022-09-21 21:51:09 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-21 21:51:09 INFO  Running instrumented original pipeline...
2022-09-21 21:51:09 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-21 21:51:09 INFO  ---RUNTIME: Importing and monkey-patching took 8.112192153930664 ms
2022-09-21 21:51:23 INFO  ---RUNTIME: Original pipeline execution took 14087.673902511597 ms (excluding imports and monkey-patching)
2022-09-21 21:51:23 INFO  Starting execution of 1 what-if analyses...
2022-09-21 21:51:23 INFO  Start plan generation for analysis PermutationFeatureImportance...
2022-09-21 21:51:23 INFO  ---RUNTIME: Plan generation took 0.09965896606445312 ms
2022-09-21 21:51:23 INFO  Estimated runtime of original DAG is 10614.766359329224ms
2022-09-21 21:51:23 WARNING Skipping Multi-Query Optimization (instead, only applying patches)
2022-09-21 21:51:23 INFO  Estimated unoptimised what-if runtime is 53073.83179664612ms
2022-09-21 21:51:23 INFO  ---RUNTIME: Multi-Query Optimization took 4.263639450073242 ms
2022-09-21 21:51:23 INFO  Executing generated plans
2022-09-21 21:52:18 INFO  ---RUNTIME: Execution took 54931.708574295044 ms
2022-09-21 21:52:18 INFO  Done!
2022-09-21 21:52:18 INFO  # Finished -- repetition 5 of 7 
2022-09-21 21:52:18 INFO  # Optimization benchmark for feature_importance with args [['reviews', 'slow_loading', 'featurization_4', 'logistic_regression']] -- repetition 6 of 7
2022-09-21 21:52:18 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-21 21:52:18 INFO  Running instrumented original pipeline...
2022-09-21 21:52:18 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-21 21:52:18 INFO  ---RUNTIME: Importing and monkey-patching took 6.386756896972656 ms
2022-09-21 21:52:32 INFO  ---RUNTIME: Original pipeline execution took 13548.927307128906 ms (excluding imports and monkey-patching)
2022-09-21 21:52:32 INFO  Starting execution of 1 what-if analyses...
2022-09-21 21:52:32 INFO  Start plan generation for analysis PermutationFeatureImportance...
2022-09-21 21:52:32 INFO  ---RUNTIME: Plan generation took 0.11420249938964844 ms
2022-09-21 21:52:32 INFO  Estimated runtime of original DAG is 10247.585535049438ms
2022-09-21 21:52:32 INFO  Performing Multi-Query Optimization
2022-09-21 21:52:32 INFO  Estimated unoptimized what-if runtime is 51237.92767524719ms
2022-09-21 21:52:32 INFO  Estimated optimised what-if runtime is 10457.133293151855ms
2022-09-21 21:52:32 INFO  Estimated optimisation runtime saving is 40780.79438209534ms
2022-09-21 21:52:32 INFO  ---RUNTIME: Multi-Query Optimization took 11.060714721679688 ms
2022-09-21 21:52:32 INFO  Executing generated plans
2022-09-21 21:52:43 INFO  ---RUNTIME: Execution took 11099.581956863403 ms
2022-09-21 21:52:43 INFO  Done!
2022-09-21 21:52:43 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-21 21:52:43 INFO  Running instrumented original pipeline...
2022-09-21 21:52:43 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-21 21:52:43 INFO  ---RUNTIME: Importing and monkey-patching took 6.061077117919922 ms
2022-09-21 21:52:56 INFO  ---RUNTIME: Original pipeline execution took 13548.129558563232 ms (excluding imports and monkey-patching)
2022-09-21 21:52:56 INFO  Starting execution of 1 what-if analyses...
2022-09-21 21:52:56 INFO  Start plan generation for analysis PermutationFeatureImportance...
2022-09-21 21:52:56 INFO  ---RUNTIME: Plan generation took 0.11992454528808594 ms
2022-09-21 21:52:56 INFO  Estimated runtime of original DAG is 9935.234546661377ms
2022-09-21 21:52:56 WARNING Skipping Multi-Query Optimization (instead, only applying patches)
2022-09-21 21:52:56 INFO  Estimated unoptimised what-if runtime is 49676.172733306885ms
2022-09-21 21:52:56 INFO  ---RUNTIME: Multi-Query Optimization took 4.313945770263672 ms
2022-09-21 21:52:56 INFO  Executing generated plans
2022-09-21 21:53:51 INFO  ---RUNTIME: Execution took 54678.319215774536 ms
2022-09-21 21:53:51 INFO  Done!
2022-09-21 21:53:51 INFO  # Finished -- repetition 6 of 7 
2022-09-21 21:53:51 INFO  # Optimization benchmark for feature_importance with args [['reviews', 'slow_loading', 'featurization_4', 'logistic_regression']] -- repetition 7 of 7
2022-09-21 21:53:51 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-21 21:53:51 INFO  Running instrumented original pipeline...
2022-09-21 21:53:51 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-21 21:53:51 INFO  ---RUNTIME: Importing and monkey-patching took 5.941867828369141 ms
2022-09-21 21:54:04 INFO  ---RUNTIME: Original pipeline execution took 13367.694854736328 ms (excluding imports and monkey-patching)
2022-09-21 21:54:04 INFO  Starting execution of 1 what-if analyses...
2022-09-21 21:54:04 INFO  Start plan generation for analysis PermutationFeatureImportance...
2022-09-21 21:54:04 INFO  ---RUNTIME: Plan generation took 0.09942054748535156 ms
2022-09-21 21:54:04 INFO  Estimated runtime of original DAG is 10031.299591064453ms
2022-09-21 21:54:04 INFO  Performing Multi-Query Optimization
2022-09-21 21:54:04 INFO  Estimated unoptimized what-if runtime is 50156.497955322266ms
2022-09-21 21:54:04 INFO  Estimated optimised what-if runtime is 10240.205526351929ms
2022-09-21 21:54:04 INFO  Estimated optimisation runtime saving is 39916.29242897034ms
2022-09-21 21:54:04 INFO  ---RUNTIME: Multi-Query Optimization took 11.163473129272461 ms
2022-09-21 21:54:04 INFO  Executing generated plans
2022-09-21 21:54:16 INFO  ---RUNTIME: Execution took 11881.857872009277 ms
2022-09-21 21:54:16 INFO  Done!
2022-09-21 21:54:16 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-21 21:54:16 INFO  Running instrumented original pipeline...
2022-09-21 21:54:17 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-21 21:54:17 INFO  ---RUNTIME: Importing and monkey-patching took 6.240606307983398 ms
2022-09-21 21:54:30 INFO  ---RUNTIME: Original pipeline execution took 14064.56708908081 ms (excluding imports and monkey-patching)
2022-09-21 21:54:30 INFO  Starting execution of 1 what-if analyses...
2022-09-21 21:54:30 INFO  Start plan generation for analysis PermutationFeatureImportance...
2022-09-21 21:54:30 INFO  ---RUNTIME: Plan generation took 0.1544952392578125 ms
2022-09-21 21:54:30 INFO  Estimated runtime of original DAG is 10368.345737457275ms
2022-09-21 21:54:30 WARNING Skipping Multi-Query Optimization (instead, only applying patches)
2022-09-21 21:54:30 INFO  Estimated unoptimised what-if runtime is 51841.72868728638ms
2022-09-21 21:54:30 INFO  ---RUNTIME: Multi-Query Optimization took 5.070924758911133 ms
2022-09-21 21:54:30 INFO  Executing generated plans
2022-09-21 21:55:26 INFO  ---RUNTIME: Execution took 55253.602504730225 ms
2022-09-21 21:55:26 INFO  Done!
2022-09-21 21:55:26 INFO  # Finished -- repetition 7 of 7 
2022-09-21 21:55:26 INFO  # Final results after all repetitions
2022-09-21 21:55:26 INFO     repetition  ... no_opt_what_if_execution_combined_model_training
0           0  ...                                       859.242201
1           1  ...                                       876.485586
2           2  ...                                       867.565155
3           3  ...                                       875.061035
4           4  ...                                       852.128744
5           5  ...                                       838.173866
6           6  ...                                       852.213860

[7 rows x 26 columns]
taskset -c 32-39 PROTOCOL_BUFFERS_PYTHON_IMPLEMENTATION=python python3.9 benchmarks_end_to_end.py feature_importance reviews slow_loading featurization_4 xgboost
2022-09-21 21:55:28.325158: W tensorflow/stream_executor/platform/default/dso_loader.cc:64] Could not load dynamic library 'libcudart.so.11.0'; dlerror: libcudart.so.11.0: cannot open shared object file: No such file or directory; LD_LIBRARY_PATH: /home/sgrafbe/mlwhatif/venv/lib/python3.9/site-packages/cv2/../../lib64:
2022-09-21 21:55:28.325202: I tensorflow/stream_executor/cuda/cudart_stub.cc:29] Ignore above cudart dlerror if you do not have a GPU set up on your machine.
2022-09-21 21:55:29 INFO  Patching sys.argv with ['mlwhatif', 'reviews', 'slow_loading', 'featurization_4', 'xgboost']
2022-09-21 21:55:29 INFO  Running instrumented original pipeline...
2022-09-21 21:55:29 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-21 21:55:29 INFO  ---RUNTIME: Importing and monkey-patching took 96.66705131530762 ms
2022-09-21 21:55:46 INFO  ---RUNTIME: Original pipeline execution took 17175.3568649292 ms (excluding imports and monkey-patching)
2022-09-21 21:55:46 INFO  Starting execution of 0 what-if analyses...
2022-09-21 21:55:46 INFO  Estimated runtime of original DAG is 13845.251083374023ms
2022-09-21 21:55:46 INFO  Performing Multi-Query Optimization
2022-09-21 21:55:46 INFO  Estimated unoptimized what-if runtime is 0ms
2022-09-21 21:55:46 INFO  Estimated optimised what-if runtime is 0ms
2022-09-21 21:55:46 INFO  Estimated optimisation runtime saving is 0ms
2022-09-21 21:55:46 INFO  ---RUNTIME: Multi-Query Optimization took 0.5609989166259766 ms
2022-09-21 21:55:46 INFO  Executing generated plans
2022-09-21 21:55:46 INFO  ---RUNTIME: Execution took 0.030994415283203125 ms
2022-09-21 21:55:46 INFO  Done!
2022-09-21 21:55:46 INFO  # Optimization benchmark for feature_importance with args [['reviews', 'slow_loading', 'featurization_4', 'xgboost']] -- repetition 1 of 7
2022-09-21 21:55:46 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-21 21:55:46 INFO  Running instrumented original pipeline...
2022-09-21 21:55:46 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-21 21:55:46 INFO  ---RUNTIME: Importing and monkey-patching took 5.567789077758789 ms
2022-09-21 21:56:03 INFO  ---RUNTIME: Original pipeline execution took 16859.983682632446 ms (excluding imports and monkey-patching)
2022-09-21 21:56:03 INFO  Starting execution of 1 what-if analyses...
2022-09-21 21:56:03 INFO  Start plan generation for analysis PermutationFeatureImportance...
2022-09-21 21:56:03 INFO  ---RUNTIME: Plan generation took 0.21028518676757812 ms
2022-09-21 21:56:03 INFO  Estimated runtime of original DAG is 13619.016408920288ms
2022-09-21 21:56:03 INFO  Performing Multi-Query Optimization
2022-09-21 21:56:03 INFO  Estimated unoptimized what-if runtime is 68095.08204460144ms
2022-09-21 21:56:03 INFO  Estimated optimised what-if runtime is 14026.89266204834ms
2022-09-21 21:56:03 INFO  Estimated optimisation runtime saving is 54068.1893825531ms
2022-09-21 21:56:03 INFO  ---RUNTIME: Multi-Query Optimization took 11.158227920532227 ms
2022-09-21 21:56:03 INFO  Executing generated plans
2022-09-21 21:56:18 INFO  ---RUNTIME: Execution took 15165.850400924683 ms
2022-09-21 21:56:18 INFO  Done!
2022-09-21 21:56:18 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-21 21:56:18 INFO  Running instrumented original pipeline...
2022-09-21 21:56:18 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-21 21:56:18 INFO  ---RUNTIME: Importing and monkey-patching took 6.479501724243164 ms
2022-09-21 21:56:35 INFO  ---RUNTIME: Original pipeline execution took 16936.91849708557 ms (excluding imports and monkey-patching)
2022-09-21 21:56:35 INFO  Starting execution of 1 what-if analyses...
2022-09-21 21:56:35 INFO  Start plan generation for analysis PermutationFeatureImportance...
2022-09-21 21:56:35 INFO  ---RUNTIME: Plan generation took 0.1347064971923828 ms
2022-09-21 21:56:35 INFO  Estimated runtime of original DAG is 13648.398160934448ms
2022-09-21 21:56:35 WARNING Skipping Multi-Query Optimization (instead, only applying patches)
2022-09-21 21:56:35 INFO  Estimated unoptimised what-if runtime is 68241.99080467224ms
2022-09-21 21:56:35 INFO  ---RUNTIME: Multi-Query Optimization took 4.462718963623047 ms
2022-09-21 21:56:35 INFO  Executing generated plans
2022-09-21 21:57:48 INFO  ---RUNTIME: Execution took 72805.92608451843 ms
2022-09-21 21:57:48 INFO  Done!
2022-09-21 21:57:48 INFO  # Finished -- repetition 1 of 7 
2022-09-21 21:57:48 INFO  # Optimization benchmark for feature_importance with args [['reviews', 'slow_loading', 'featurization_4', 'xgboost']] -- repetition 2 of 7
2022-09-21 21:57:48 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-21 21:57:48 INFO  Running instrumented original pipeline...
2022-09-21 21:57:48 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-21 21:57:48 INFO  ---RUNTIME: Importing and monkey-patching took 6.624698638916016 ms
2022-09-21 21:58:05 INFO  ---RUNTIME: Original pipeline execution took 16993.69764328003 ms (excluding imports and monkey-patching)
2022-09-21 21:58:05 INFO  Starting execution of 1 what-if analyses...
2022-09-21 21:58:05 INFO  Start plan generation for analysis PermutationFeatureImportance...
2022-09-21 21:58:05 INFO  ---RUNTIME: Plan generation took 0.13446807861328125 ms
2022-09-21 21:58:05 INFO  Estimated runtime of original DAG is 13468.217849731445ms
2022-09-21 21:58:05 INFO  Performing Multi-Query Optimization
2022-09-21 21:58:05 INFO  Estimated unoptimized what-if runtime is 67341.08924865723ms
2022-09-21 21:58:05 INFO  Estimated optimised what-if runtime is 13965.940237045288ms
2022-09-21 21:58:05 INFO  Estimated optimisation runtime saving is 53375.14901161194ms
2022-09-21 21:58:05 INFO  ---RUNTIME: Multi-Query Optimization took 11.312246322631836 ms
2022-09-21 21:58:05 INFO  Executing generated plans
2022-09-21 21:58:20 INFO  ---RUNTIME: Execution took 14787.348985671997 ms
2022-09-21 21:58:20 INFO  Done!
2022-09-21 21:58:20 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-21 21:58:20 INFO  Running instrumented original pipeline...
2022-09-21 21:58:20 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-21 21:58:20 INFO  ---RUNTIME: Importing and monkey-patching took 6.294488906860352 ms
2022-09-21 21:58:36 INFO  ---RUNTIME: Original pipeline execution took 16390.95687866211 ms (excluding imports and monkey-patching)
2022-09-21 21:58:36 INFO  Starting execution of 1 what-if analyses...
2022-09-21 21:58:36 INFO  Start plan generation for analysis PermutationFeatureImportance...
2022-09-21 21:58:36 INFO  ---RUNTIME: Plan generation took 0.12326240539550781 ms
2022-09-21 21:58:36 INFO  Estimated runtime of original DAG is 13037.61887550354ms
2022-09-21 21:58:36 WARNING Skipping Multi-Query Optimization (instead, only applying patches)
2022-09-21 21:58:36 INFO  Estimated unoptimised what-if runtime is 65188.0943775177ms
2022-09-21 21:58:36 INFO  ---RUNTIME: Multi-Query Optimization took 4.326105117797852 ms
2022-09-21 21:58:36 INFO  Executing generated plans
2022-09-21 21:59:50 INFO  ---RUNTIME: Execution took 73178.78770828247 ms
2022-09-21 21:59:50 INFO  Done!
2022-09-21 21:59:50 INFO  # Finished -- repetition 2 of 7 
2022-09-21 21:59:50 INFO  # Optimization benchmark for feature_importance with args [['reviews', 'slow_loading', 'featurization_4', 'xgboost']] -- repetition 3 of 7
2022-09-21 21:59:50 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-21 21:59:50 INFO  Running instrumented original pipeline...
2022-09-21 21:59:50 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-21 21:59:50 INFO  ---RUNTIME: Importing and monkey-patching took 6.3076019287109375 ms
2022-09-21 22:00:07 INFO  ---RUNTIME: Original pipeline execution took 17123.75807762146 ms (excluding imports and monkey-patching)
2022-09-21 22:00:07 INFO  Starting execution of 1 what-if analyses...
2022-09-21 22:00:07 INFO  Start plan generation for analysis PermutationFeatureImportance...
2022-09-21 22:00:07 INFO  ---RUNTIME: Plan generation took 0.11396408081054688 ms
2022-09-21 22:00:07 INFO  Estimated runtime of original DAG is 13762.551307678223ms
2022-09-21 22:00:07 INFO  Performing Multi-Query Optimization
2022-09-21 22:00:07 INFO  Estimated unoptimized what-if runtime is 68812.75653839111ms
2022-09-21 22:00:07 INFO  Estimated optimised what-if runtime is 14176.641941070557ms
2022-09-21 22:00:07 INFO  Estimated optimisation runtime saving is 54636.11459732056ms
2022-09-21 22:00:07 INFO  ---RUNTIME: Multi-Query Optimization took 11.054039001464844 ms
2022-09-21 22:00:07 INFO  Executing generated plans
2022-09-21 22:00:22 INFO  ---RUNTIME: Execution took 14980.709791183472 ms
2022-09-21 22:00:22 INFO  Done!
2022-09-21 22:00:22 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-21 22:00:22 INFO  Running instrumented original pipeline...
2022-09-21 22:00:22 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-21 22:00:22 INFO  ---RUNTIME: Importing and monkey-patching took 5.844831466674805 ms
2022-09-21 22:00:39 INFO  ---RUNTIME: Original pipeline execution took 17178.619146347046 ms (excluding imports and monkey-patching)
2022-09-21 22:00:39 INFO  Starting execution of 1 what-if analyses...
2022-09-21 22:00:39 INFO  Start plan generation for analysis PermutationFeatureImportance...
2022-09-21 22:00:39 INFO  ---RUNTIME: Plan generation took 0.09679794311523438 ms
2022-09-21 22:00:39 INFO  Estimated runtime of original DAG is 13852.439403533936ms
2022-09-21 22:00:39 WARNING Skipping Multi-Query Optimization (instead, only applying patches)
2022-09-21 22:00:39 INFO  Estimated unoptimised what-if runtime is 69262.19701766968ms
2022-09-21 22:00:39 INFO  ---RUNTIME: Multi-Query Optimization took 4.218339920043945 ms
2022-09-21 22:00:39 INFO  Executing generated plans
2022-09-21 22:01:52 INFO  ---RUNTIME: Execution took 72680.95469474792 ms
2022-09-21 22:01:52 INFO  Done!
2022-09-21 22:01:52 INFO  # Finished -- repetition 3 of 7 
2022-09-21 22:01:52 INFO  # Optimization benchmark for feature_importance with args [['reviews', 'slow_loading', 'featurization_4', 'xgboost']] -- repetition 4 of 7
2022-09-21 22:01:52 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-21 22:01:52 INFO  Running instrumented original pipeline...
2022-09-21 22:01:52 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-21 22:01:52 INFO  ---RUNTIME: Importing and monkey-patching took 6.799936294555664 ms
2022-09-21 22:02:09 INFO  ---RUNTIME: Original pipeline execution took 16993.975400924683 ms (excluding imports and monkey-patching)
2022-09-21 22:02:09 INFO  Starting execution of 1 what-if analyses...
2022-09-21 22:02:09 INFO  Start plan generation for analysis PermutationFeatureImportance...
2022-09-21 22:02:09 INFO  ---RUNTIME: Plan generation took 0.12063980102539062 ms
2022-09-21 22:02:09 INFO  Estimated runtime of original DAG is 13256.837844848633ms
2022-09-21 22:02:09 INFO  Performing Multi-Query Optimization
2022-09-21 22:02:09 INFO  Estimated unoptimized what-if runtime is 66284.18922424316ms
2022-09-21 22:02:09 INFO  Estimated optimised what-if runtime is 13669.325351715088ms
2022-09-21 22:02:09 INFO  Estimated optimisation runtime saving is 52614.863872528076ms
2022-09-21 22:02:09 INFO  ---RUNTIME: Multi-Query Optimization took 11.314630508422852 ms
2022-09-21 22:02:09 INFO  Executing generated plans
2022-09-21 22:02:23 INFO  ---RUNTIME: Execution took 14732.545614242554 ms
2022-09-21 22:02:23 INFO  Done!
2022-09-21 22:02:23 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-21 22:02:23 INFO  Running instrumented original pipeline...
2022-09-21 22:02:23 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-21 22:02:23 INFO  ---RUNTIME: Importing and monkey-patching took 5.94329833984375 ms
2022-09-21 22:02:41 INFO  ---RUNTIME: Original pipeline execution took 17256.200551986694 ms (excluding imports and monkey-patching)
2022-09-21 22:02:41 INFO  Starting execution of 1 what-if analyses...
2022-09-21 22:02:41 INFO  Start plan generation for analysis PermutationFeatureImportance...
2022-09-21 22:02:41 INFO  ---RUNTIME: Plan generation took 0.12731552124023438 ms
2022-09-21 22:02:41 INFO  Estimated runtime of original DAG is 13631.126880645752ms
2022-09-21 22:02:41 WARNING Skipping Multi-Query Optimization (instead, only applying patches)
2022-09-21 22:02:41 INFO  Estimated unoptimised what-if runtime is 68155.63440322876ms
2022-09-21 22:02:41 INFO  ---RUNTIME: Multi-Query Optimization took 4.332780838012695 ms
2022-09-21 22:02:41 INFO  Executing generated plans
2022-09-21 22:03:53 INFO  ---RUNTIME: Execution took 72732.51128196716 ms
2022-09-21 22:03:53 INFO  Done!
2022-09-21 22:03:53 INFO  # Finished -- repetition 4 of 7 
2022-09-21 22:03:53 INFO  # Optimization benchmark for feature_importance with args [['reviews', 'slow_loading', 'featurization_4', 'xgboost']] -- repetition 5 of 7
2022-09-21 22:03:53 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-21 22:03:53 INFO  Running instrumented original pipeline...
2022-09-21 22:03:53 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-21 22:03:53 INFO  ---RUNTIME: Importing and monkey-patching took 6.426334381103516 ms
2022-09-21 22:04:10 INFO  ---RUNTIME: Original pipeline execution took 16616.527557373047 ms (excluding imports and monkey-patching)
2022-09-21 22:04:10 INFO  Starting execution of 1 what-if analyses...
2022-09-21 22:04:10 INFO  Start plan generation for analysis PermutationFeatureImportance...
2022-09-21 22:04:10 INFO  ---RUNTIME: Plan generation took 0.12111663818359375 ms
2022-09-21 22:04:10 INFO  Estimated runtime of original DAG is 13301.135301589966ms
2022-09-21 22:04:10 INFO  Performing Multi-Query Optimization
2022-09-21 22:04:10 INFO  Estimated unoptimized what-if runtime is 66505.67650794983ms
2022-09-21 22:04:10 INFO  Estimated optimised what-if runtime is 13761.226415634155ms
2022-09-21 22:04:10 INFO  Estimated optimisation runtime saving is 52744.450092315674ms
2022-09-21 22:04:10 INFO  ---RUNTIME: Multi-Query Optimization took 11.250734329223633 ms
2022-09-21 22:04:10 INFO  Executing generated plans
2022-09-21 22:04:28 INFO  ---RUNTIME: Execution took 17593.228578567505 ms
2022-09-21 22:04:28 INFO  Done!
2022-09-21 22:04:28 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-21 22:04:28 INFO  Running instrumented original pipeline...
2022-09-21 22:04:28 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-21 22:04:28 INFO  ---RUNTIME: Importing and monkey-patching took 5.897045135498047 ms
2022-09-21 22:04:44 INFO  ---RUNTIME: Original pipeline execution took 16898.777723312378 ms (excluding imports and monkey-patching)
2022-09-21 22:04:44 INFO  Starting execution of 1 what-if analyses...
2022-09-21 22:04:44 INFO  Start plan generation for analysis PermutationFeatureImportance...
2022-09-21 22:04:44 INFO  ---RUNTIME: Plan generation took 0.1270771026611328 ms
2022-09-21 22:04:44 INFO  Estimated runtime of original DAG is 13459.828853607178ms
2022-09-21 22:04:44 WARNING Skipping Multi-Query Optimization (instead, only applying patches)
2022-09-21 22:04:44 INFO  Estimated unoptimised what-if runtime is 67299.14426803589ms
2022-09-21 22:04:44 INFO  ---RUNTIME: Multi-Query Optimization took 4.4231414794921875 ms
2022-09-21 22:04:44 INFO  Executing generated plans
2022-09-21 22:05:57 INFO  ---RUNTIME: Execution took 72523.27704429626 ms
2022-09-21 22:05:57 INFO  Done!
2022-09-21 22:05:57 INFO  # Finished -- repetition 5 of 7 
2022-09-21 22:05:57 INFO  # Optimization benchmark for feature_importance with args [['reviews', 'slow_loading', 'featurization_4', 'xgboost']] -- repetition 6 of 7
2022-09-21 22:05:57 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-21 22:05:57 INFO  Running instrumented original pipeline...
2022-09-21 22:05:57 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-21 22:05:57 INFO  ---RUNTIME: Importing and monkey-patching took 6.313800811767578 ms
2022-09-21 22:06:14 INFO  ---RUNTIME: Original pipeline execution took 17286.72218322754 ms (excluding imports and monkey-patching)
2022-09-21 22:06:14 INFO  Starting execution of 1 what-if analyses...
2022-09-21 22:06:14 INFO  Start plan generation for analysis PermutationFeatureImportance...
2022-09-21 22:06:14 INFO  ---RUNTIME: Plan generation took 0.1270771026611328 ms
2022-09-21 22:06:14 INFO  Estimated runtime of original DAG is 13708.580732345581ms
2022-09-21 22:06:14 INFO  Performing Multi-Query Optimization
2022-09-21 22:06:14 INFO  Estimated unoptimized what-if runtime is 68542.9036617279ms
2022-09-21 22:06:14 INFO  Estimated optimised what-if runtime is 14172.435998916626ms
2022-09-21 22:06:14 INFO  Estimated optimisation runtime saving is 54370.46766281128ms
2022-09-21 22:06:14 INFO  ---RUNTIME: Multi-Query Optimization took 11.096715927124023 ms
2022-09-21 22:06:14 INFO  Executing generated plans
2022-09-21 22:06:29 INFO  ---RUNTIME: Execution took 14762.333154678345 ms
2022-09-21 22:06:29 INFO  Done!
2022-09-21 22:06:29 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-21 22:06:29 INFO  Running instrumented original pipeline...
2022-09-21 22:06:29 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-21 22:06:29 INFO  ---RUNTIME: Importing and monkey-patching took 5.865335464477539 ms
2022-09-21 22:06:46 INFO  ---RUNTIME: Original pipeline execution took 16993.011236190796 ms (excluding imports and monkey-patching)
2022-09-21 22:06:46 INFO  Starting execution of 1 what-if analyses...
2022-09-21 22:06:46 INFO  Start plan generation for analysis PermutationFeatureImportance...
2022-09-21 22:06:46 INFO  ---RUNTIME: Plan generation took 0.095367431640625 ms
2022-09-21 22:06:46 INFO  Estimated runtime of original DAG is 13415.343761444092ms
2022-09-21 22:06:46 WARNING Skipping Multi-Query Optimization (instead, only applying patches)
2022-09-21 22:06:46 INFO  Estimated unoptimised what-if runtime is 67076.71880722046ms
2022-09-21 22:06:46 INFO  ---RUNTIME: Multi-Query Optimization took 4.309415817260742 ms
2022-09-21 22:06:46 INFO  Executing generated plans
2022-09-21 22:07:58 INFO  ---RUNTIME: Execution took 71678.95126342773 ms
2022-09-21 22:07:58 INFO  Done!
2022-09-21 22:07:58 INFO  # Finished -- repetition 6 of 7 
2022-09-21 22:07:58 INFO  # Optimization benchmark for feature_importance with args [['reviews', 'slow_loading', 'featurization_4', 'xgboost']] -- repetition 7 of 7
2022-09-21 22:07:58 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-21 22:07:58 INFO  Running instrumented original pipeline...
2022-09-21 22:07:58 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-21 22:07:58 INFO  ---RUNTIME: Importing and monkey-patching took 5.958795547485352 ms
2022-09-21 22:08:15 INFO  ---RUNTIME: Original pipeline execution took 17245.233058929443 ms (excluding imports and monkey-patching)
2022-09-21 22:08:15 INFO  Starting execution of 1 what-if analyses...
2022-09-21 22:08:15 INFO  Start plan generation for analysis PermutationFeatureImportance...
2022-09-21 22:08:15 INFO  ---RUNTIME: Plan generation took 0.12874603271484375 ms
2022-09-21 22:08:15 INFO  Estimated runtime of original DAG is 13734.626293182373ms
2022-09-21 22:08:15 INFO  Performing Multi-Query Optimization
2022-09-21 22:08:15 INFO  Estimated unoptimized what-if runtime is 68673.13146591187ms
2022-09-21 22:08:15 INFO  Estimated optimised what-if runtime is 14147.629261016846ms
2022-09-21 22:08:15 INFO  Estimated optimisation runtime saving is 54525.50220489502ms
2022-09-21 22:08:15 INFO  ---RUNTIME: Multi-Query Optimization took 11.791467666625977 ms
2022-09-21 22:08:15 INFO  Executing generated plans
2022-09-21 22:08:30 INFO  ---RUNTIME: Execution took 15037.47272491455 ms
2022-09-21 22:08:30 INFO  Done!
2022-09-21 22:08:30 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-21 22:08:30 INFO  Running instrumented original pipeline...
2022-09-21 22:08:30 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-21 22:08:30 INFO  ---RUNTIME: Importing and monkey-patching took 6.66356086730957 ms
2022-09-21 22:08:47 INFO  ---RUNTIME: Original pipeline execution took 16612.712383270264 ms (excluding imports and monkey-patching)
2022-09-21 22:08:47 INFO  Starting execution of 1 what-if analyses...
2022-09-21 22:08:47 INFO  Start plan generation for analysis PermutationFeatureImportance...
2022-09-21 22:08:47 INFO  ---RUNTIME: Plan generation took 0.1277923583984375 ms
2022-09-21 22:08:47 INFO  Estimated runtime of original DAG is 13037.254571914673ms
2022-09-21 22:08:47 WARNING Skipping Multi-Query Optimization (instead, only applying patches)
2022-09-21 22:08:47 INFO  Estimated unoptimised what-if runtime is 65186.272859573364ms
2022-09-21 22:08:47 INFO  ---RUNTIME: Multi-Query Optimization took 4.344463348388672 ms
2022-09-21 22:08:47 INFO  Executing generated plans
2022-09-21 22:10:01 INFO  ---RUNTIME: Execution took 74333.02283287048 ms
2022-09-21 22:10:01 INFO  Done!
2022-09-21 22:10:01 INFO  # Finished -- repetition 7 of 7 
2022-09-21 22:10:01 INFO  # Final results after all repetitions
2022-09-21 22:10:01 INFO     repetition  ... no_opt_what_if_execution_combined_model_training
0           0  ...                                     18249.513626
1           1  ...                                     18031.720161
2           2  ...                                     17690.137625
3           3  ...                                     18125.456572
4           4  ...                                     17973.556757
5           5  ...                                     17861.436605
6           6  ...                                     18621.561527

[7 rows x 26 columns]
taskset -c 32-39 PROTOCOL_BUFFERS_PYTHON_IMPLEMENTATION=python python3.9 benchmarks_end_to_end.py feature_importance reviews slow_loading featurization_4 neural_network
2022-09-21 22:10:03.884525: W tensorflow/stream_executor/platform/default/dso_loader.cc:64] Could not load dynamic library 'libcudart.so.11.0'; dlerror: libcudart.so.11.0: cannot open shared object file: No such file or directory; LD_LIBRARY_PATH: /home/sgrafbe/mlwhatif/venv/lib/python3.9/site-packages/cv2/../../lib64:
2022-09-21 22:10:03.884563: I tensorflow/stream_executor/cuda/cudart_stub.cc:29] Ignore above cudart dlerror if you do not have a GPU set up on your machine.
2022-09-21 22:10:05 INFO  Patching sys.argv with ['mlwhatif', 'reviews', 'slow_loading', 'featurization_4', 'neural_network']
2022-09-21 22:10:05 INFO  Running instrumented original pipeline...
2022-09-21 22:10:05 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-21 22:10:05 INFO  ---RUNTIME: Importing and monkey-patching took 107.27238655090332 ms
2022-09-21 22:10:18.472141: W tensorflow/stream_executor/platform/default/dso_loader.cc:64] Could not load dynamic library 'libcuda.so.1'; dlerror: libcuda.so.1: cannot open shared object file: No such file or directory; LD_LIBRARY_PATH: /home/sgrafbe/mlwhatif/venv/lib/python3.9/site-packages/cv2/../../lib64:
2022-09-21 22:10:18.472179: W tensorflow/stream_executor/cuda/cuda_driver.cc:326] failed call to cuInit: UNKNOWN ERROR (303)
2022-09-21 22:10:18.472202: I tensorflow/stream_executor/cuda/cuda_diagnostics.cc:156] kernel driver does not appear to be running on this host (wagyu): /proc/driver/nvidia/version does not exist
2022-09-21 22:10:18.472786: I tensorflow/core/platform/cpu_feature_guard.cc:142] This TensorFlow binary is optimized with oneAPI Deep Neural Network Library (oneDNN) to use the following CPU instructions in performance-critical operations:  AVX2 FMA
To enable them in other operations, rebuild TensorFlow with the appropriate compiler flags.
2022-09-21 22:10:18.547730: I tensorflow/compiler/mlir/mlir_graph_optimization_pass.cc:176] None of the MLIR Optimization Passes are enabled (registered 2)
2022-09-21 22:10:18.559376: I tensorflow/core/platform/profile_utils/cpu_utils.cc:114] CPU Frequency: 2595290000 Hz
2022-09-21 22:10:23 INFO  ---RUNTIME: Original pipeline execution took 17878.37862968445 ms (excluding imports and monkey-patching)
2022-09-21 22:10:23 INFO  Starting execution of 0 what-if analyses...
2022-09-21 22:10:23 INFO  Estimated runtime of original DAG is 14585.553646087646ms
2022-09-21 22:10:23 INFO  Performing Multi-Query Optimization
2022-09-21 22:10:23 INFO  Estimated unoptimized what-if runtime is 0ms
2022-09-21 22:10:23 INFO  Estimated optimised what-if runtime is 0ms
2022-09-21 22:10:23 INFO  Estimated optimisation runtime saving is 0ms
2022-09-21 22:10:23 INFO  ---RUNTIME: Multi-Query Optimization took 0.5371570587158203 ms
2022-09-21 22:10:23 INFO  Executing generated plans
2022-09-21 22:10:23 INFO  ---RUNTIME: Execution took 0.017404556274414062 ms
2022-09-21 22:10:23 INFO  Done!
2022-09-21 22:10:23 INFO  # Optimization benchmark for feature_importance with args [['reviews', 'slow_loading', 'featurization_4', 'neural_network']] -- repetition 1 of 7
2022-09-21 22:10:23 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-21 22:10:23 INFO  Running instrumented original pipeline...
2022-09-21 22:10:23 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-21 22:10:23 INFO  ---RUNTIME: Importing and monkey-patching took 6.324291229248047 ms
2022-09-21 22:10:40 INFO  ---RUNTIME: Original pipeline execution took 17295.013189315796 ms (excluding imports and monkey-patching)
2022-09-21 22:10:40 INFO  Starting execution of 1 what-if analyses...
2022-09-21 22:10:40 INFO  Start plan generation for analysis PermutationFeatureImportance...
2022-09-21 22:10:40 INFO  ---RUNTIME: Plan generation took 0.20265579223632812 ms
2022-09-21 22:10:40 INFO  Estimated runtime of original DAG is 13796.956539154053ms
2022-09-21 22:10:40 INFO  Performing Multi-Query Optimization
2022-09-21 22:10:40 INFO  Estimated unoptimized what-if runtime is 68984.78269577026ms
2022-09-21 22:10:40 INFO  Estimated optimised what-if runtime is 15767.590761184692ms
2022-09-21 22:10:40 INFO  Estimated optimisation runtime saving is 53217.19193458557ms
2022-09-21 22:10:40 INFO  ---RUNTIME: Multi-Query Optimization took 11.368513107299805 ms
2022-09-21 22:10:40 INFO  Executing generated plans
2022-09-21 22:10:56 INFO  ---RUNTIME: Execution took 16104.990482330322 ms
2022-09-21 22:10:56 INFO  Done!
2022-09-21 22:10:56 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-21 22:10:56 INFO  Running instrumented original pipeline...
2022-09-21 22:10:56 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-21 22:10:56 INFO  ---RUNTIME: Importing and monkey-patching took 6.349802017211914 ms
2022-09-21 22:11:13 INFO  ---RUNTIME: Original pipeline execution took 17140.401124954224 ms (excluding imports and monkey-patching)
2022-09-21 22:11:13 INFO  Starting execution of 1 what-if analyses...
2022-09-21 22:11:13 INFO  Start plan generation for analysis PermutationFeatureImportance...
2022-09-21 22:11:13 INFO  ---RUNTIME: Plan generation took 0.1289844512939453 ms
2022-09-21 22:11:13 INFO  Estimated runtime of original DAG is 13672.560930252075ms
2022-09-21 22:11:13 WARNING Skipping Multi-Query Optimization (instead, only applying patches)
2022-09-21 22:11:13 INFO  Estimated unoptimised what-if runtime is 68362.80465126038ms
2022-09-21 22:11:13 INFO  ---RUNTIME: Multi-Query Optimization took 4.257678985595703 ms
2022-09-21 22:11:13 INFO  Executing generated plans
2022-09-21 22:12:25 INFO  ---RUNTIME: Execution took 72102.92601585388 ms
2022-09-21 22:12:25 INFO  Done!
2022-09-21 22:12:25 INFO  # Finished -- repetition 1 of 7 
2022-09-21 22:12:25 INFO  # Optimization benchmark for feature_importance with args [['reviews', 'slow_loading', 'featurization_4', 'neural_network']] -- repetition 2 of 7
2022-09-21 22:12:25 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-21 22:12:25 INFO  Running instrumented original pipeline...
2022-09-21 22:12:25 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-21 22:12:25 INFO  ---RUNTIME: Importing and monkey-patching took 6.288766860961914 ms
2022-09-21 22:12:42 INFO  ---RUNTIME: Original pipeline execution took 16975.987195968628 ms (excluding imports and monkey-patching)
2022-09-21 22:12:42 INFO  Starting execution of 1 what-if analyses...
2022-09-21 22:12:42 INFO  Start plan generation for analysis PermutationFeatureImportance...
2022-09-21 22:12:42 INFO  ---RUNTIME: Plan generation took 0.10704994201660156 ms
2022-09-21 22:12:42 INFO  Estimated runtime of original DAG is 13758.07785987854ms
2022-09-21 22:12:42 INFO  Performing Multi-Query Optimization
2022-09-21 22:12:42 INFO  Estimated unoptimized what-if runtime is 68790.3892993927ms
2022-09-21 22:12:42 INFO  Estimated optimised what-if runtime is 15583.998680114746ms
2022-09-21 22:12:42 INFO  Estimated optimisation runtime saving is 53206.390619277954ms
2022-09-21 22:12:42 INFO  ---RUNTIME: Multi-Query Optimization took 11.340856552124023 ms
2022-09-21 22:12:42 INFO  Executing generated plans
2022-09-21 22:12:59 INFO  ---RUNTIME: Execution took 16190.133333206177 ms
2022-09-21 22:12:59 INFO  Done!
2022-09-21 22:12:59 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-21 22:12:59 INFO  Running instrumented original pipeline...
2022-09-21 22:12:59 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-21 22:12:59 INFO  ---RUNTIME: Importing and monkey-patching took 6.308078765869141 ms
2022-09-21 22:13:16 INFO  ---RUNTIME: Original pipeline execution took 17023.667097091675 ms (excluding imports and monkey-patching)
2022-09-21 22:13:16 INFO  Starting execution of 1 what-if analyses...
2022-09-21 22:13:16 INFO  Start plan generation for analysis PermutationFeatureImportance...
2022-09-21 22:13:16 INFO  ---RUNTIME: Plan generation took 0.09679794311523438 ms
2022-09-21 22:13:16 INFO  Estimated runtime of original DAG is 13510.915994644165ms
2022-09-21 22:13:16 WARNING Skipping Multi-Query Optimization (instead, only applying patches)
2022-09-21 22:13:16 INFO  Estimated unoptimised what-if runtime is 67554.57997322083ms
2022-09-21 22:13:16 INFO  ---RUNTIME: Multi-Query Optimization took 4.178762435913086 ms
2022-09-21 22:13:16 INFO  Executing generated plans
2022-09-21 22:14:27 INFO  ---RUNTIME: Execution took 71613.35515975952 ms
2022-09-21 22:14:27 INFO  Done!
2022-09-21 22:14:27 INFO  # Finished -- repetition 2 of 7 
2022-09-21 22:14:27 INFO  # Optimization benchmark for feature_importance with args [['reviews', 'slow_loading', 'featurization_4', 'neural_network']] -- repetition 3 of 7
2022-09-21 22:14:27 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-21 22:14:27 INFO  Running instrumented original pipeline...
2022-09-21 22:14:27 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-21 22:14:27 INFO  ---RUNTIME: Importing and monkey-patching took 6.128787994384766 ms
2022-09-21 22:14:44 INFO  ---RUNTIME: Original pipeline execution took 17120.760202407837 ms (excluding imports and monkey-patching)
2022-09-21 22:14:44 INFO  Starting execution of 1 what-if analyses...
2022-09-21 22:14:44 INFO  Start plan generation for analysis PermutationFeatureImportance...
2022-09-21 22:14:44 INFO  ---RUNTIME: Plan generation took 0.13399124145507812 ms
2022-09-21 22:14:44 INFO  Estimated runtime of original DAG is 13538.485050201416ms
2022-09-21 22:14:44 INFO  Performing Multi-Query Optimization
2022-09-21 22:14:44 INFO  Estimated unoptimized what-if runtime is 67692.42525100708ms
2022-09-21 22:14:44 INFO  Estimated optimised what-if runtime is 15273.854970932007ms
2022-09-21 22:14:44 INFO  Estimated optimisation runtime saving is 52418.57028007507ms
2022-09-21 22:14:44 INFO  ---RUNTIME: Multi-Query Optimization took 12.340784072875977 ms
2022-09-21 22:14:44 INFO  Executing generated plans
2022-09-21 22:15:01 INFO  ---RUNTIME: Execution took 16222.914218902588 ms
2022-09-21 22:15:01 INFO  Done!
2022-09-21 22:15:01 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-21 22:15:01 INFO  Running instrumented original pipeline...
2022-09-21 22:15:01 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-21 22:15:01 INFO  ---RUNTIME: Importing and monkey-patching took 6.249666213989258 ms
2022-09-21 22:15:18 INFO  ---RUNTIME: Original pipeline execution took 17388.59510421753 ms (excluding imports and monkey-patching)
2022-09-21 22:15:18 INFO  Starting execution of 1 what-if analyses...
2022-09-21 22:15:18 INFO  Start plan generation for analysis PermutationFeatureImportance...
2022-09-21 22:15:18 INFO  ---RUNTIME: Plan generation took 0.11348724365234375 ms
2022-09-21 22:15:18 INFO  Estimated runtime of original DAG is 14079.955101013184ms
2022-09-21 22:15:18 WARNING Skipping Multi-Query Optimization (instead, only applying patches)
2022-09-21 22:15:18 INFO  Estimated unoptimised what-if runtime is 70399.77550506592ms
2022-09-21 22:15:18 INFO  ---RUNTIME: Multi-Query Optimization took 4.258632659912109 ms
2022-09-21 22:15:18 INFO  Executing generated plans
2022-09-21 22:16:30 INFO  ---RUNTIME: Execution took 72392.24243164062 ms
2022-09-21 22:16:30 INFO  Done!
2022-09-21 22:16:30 INFO  # Finished -- repetition 3 of 7 
2022-09-21 22:16:30 INFO  # Optimization benchmark for feature_importance with args [['reviews', 'slow_loading', 'featurization_4', 'neural_network']] -- repetition 4 of 7
2022-09-21 22:16:30 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-21 22:16:30 INFO  Running instrumented original pipeline...
2022-09-21 22:16:30 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-21 22:16:30 INFO  ---RUNTIME: Importing and monkey-patching took 6.411075592041016 ms
2022-09-21 22:16:47 INFO  ---RUNTIME: Original pipeline execution took 16654.905796051025 ms (excluding imports and monkey-patching)
2022-09-21 22:16:47 INFO  Starting execution of 1 what-if analyses...
2022-09-21 22:16:47 INFO  Start plan generation for analysis PermutationFeatureImportance...
2022-09-21 22:16:47 INFO  ---RUNTIME: Plan generation took 0.11968612670898438 ms
2022-09-21 22:16:47 INFO  Estimated runtime of original DAG is 13418.90001296997ms
2022-09-21 22:16:47 INFO  Performing Multi-Query Optimization
2022-09-21 22:16:47 INFO  Estimated unoptimized what-if runtime is 67094.50006484985ms
2022-09-21 22:16:47 INFO  Estimated optimised what-if runtime is 15265.176773071289ms
2022-09-21 22:16:47 INFO  Estimated optimisation runtime saving is 51829.323291778564ms
2022-09-21 22:16:47 INFO  ---RUNTIME: Multi-Query Optimization took 10.957002639770508 ms
2022-09-21 22:16:47 INFO  Executing generated plans
2022-09-21 22:17:04 INFO  ---RUNTIME: Execution took 16626.94263458252 ms
2022-09-21 22:17:04 INFO  Done!
2022-09-21 22:17:04 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-21 22:17:04 INFO  Running instrumented original pipeline...
2022-09-21 22:17:04 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-21 22:17:04 INFO  ---RUNTIME: Importing and monkey-patching took 6.3323974609375 ms
2022-09-21 22:17:21 INFO  ---RUNTIME: Original pipeline execution took 16866.46294593811 ms (excluding imports and monkey-patching)
2022-09-21 22:17:21 INFO  Starting execution of 1 what-if analyses...
2022-09-21 22:17:21 INFO  Start plan generation for analysis PermutationFeatureImportance...
2022-09-21 22:17:21 INFO  ---RUNTIME: Plan generation took 0.14519691467285156 ms
2022-09-21 22:17:21 INFO  Estimated runtime of original DAG is 13619.115352630615ms
2022-09-21 22:17:21 WARNING Skipping Multi-Query Optimization (instead, only applying patches)
2022-09-21 22:17:21 INFO  Estimated unoptimised what-if runtime is 68095.57676315308ms
2022-09-21 22:17:21 INFO  ---RUNTIME: Multi-Query Optimization took 4.227399826049805 ms
2022-09-21 22:17:21 INFO  Executing generated plans
2022-09-21 22:18:33 INFO  ---RUNTIME: Execution took 72681.9224357605 ms
2022-09-21 22:18:33 INFO  Done!
2022-09-21 22:18:33 INFO  # Finished -- repetition 4 of 7 
2022-09-21 22:18:33 INFO  # Optimization benchmark for feature_importance with args [['reviews', 'slow_loading', 'featurization_4', 'neural_network']] -- repetition 5 of 7
2022-09-21 22:18:33 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-21 22:18:33 INFO  Running instrumented original pipeline...
2022-09-21 22:18:33 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-21 22:18:33 INFO  ---RUNTIME: Importing and monkey-patching took 5.995273590087891 ms
2022-09-21 22:18:50 INFO  ---RUNTIME: Original pipeline execution took 16770.6356048584 ms (excluding imports and monkey-patching)
2022-09-21 22:18:50 INFO  Starting execution of 1 what-if analyses...
2022-09-21 22:18:50 INFO  Start plan generation for analysis PermutationFeatureImportance...
2022-09-21 22:18:50 INFO  ---RUNTIME: Plan generation took 0.10704994201660156 ms
2022-09-21 22:18:50 INFO  Estimated runtime of original DAG is 13489.820957183838ms
2022-09-21 22:18:50 INFO  Performing Multi-Query Optimization
2022-09-21 22:18:50 INFO  Estimated unoptimized what-if runtime is 67449.10478591919ms
2022-09-21 22:18:50 INFO  Estimated optimised what-if runtime is 15226.52292251587ms
2022-09-21 22:18:50 INFO  Estimated optimisation runtime saving is 52222.58186340332ms
2022-09-21 22:18:50 INFO  ---RUNTIME: Multi-Query Optimization took 10.856151580810547 ms
2022-09-21 22:18:50 INFO  Executing generated plans
2022-09-21 22:19:07 INFO  ---RUNTIME: Execution took 16471.534252166748 ms
2022-09-21 22:19:07 INFO  Done!
2022-09-21 22:19:07 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-21 22:19:07 INFO  Running instrumented original pipeline...
2022-09-21 22:19:07 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-21 22:19:07 INFO  ---RUNTIME: Importing and monkey-patching took 6.529092788696289 ms
2022-09-21 22:19:24 INFO  ---RUNTIME: Original pipeline execution took 17229.85553741455 ms (excluding imports and monkey-patching)
2022-09-21 22:19:24 INFO  Starting execution of 1 what-if analyses...
2022-09-21 22:19:24 INFO  Start plan generation for analysis PermutationFeatureImportance...
2022-09-21 22:19:24 INFO  ---RUNTIME: Plan generation took 0.11658668518066406 ms
2022-09-21 22:19:24 INFO  Estimated runtime of original DAG is 13904.75869178772ms
2022-09-21 22:19:24 WARNING Skipping Multi-Query Optimization (instead, only applying patches)
2022-09-21 22:19:24 INFO  Estimated unoptimised what-if runtime is 69523.7934589386ms
2022-09-21 22:19:24 INFO  ---RUNTIME: Multi-Query Optimization took 4.110097885131836 ms
2022-09-21 22:19:24 INFO  Executing generated plans
2022-09-21 22:20:36 INFO  ---RUNTIME: Execution took 72560.15157699585 ms
2022-09-21 22:20:36 INFO  Done!
2022-09-21 22:20:36 INFO  # Finished -- repetition 5 of 7 
2022-09-21 22:20:36 INFO  # Optimization benchmark for feature_importance with args [['reviews', 'slow_loading', 'featurization_4', 'neural_network']] -- repetition 6 of 7
2022-09-21 22:20:36 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-21 22:20:36 INFO  Running instrumented original pipeline...
2022-09-21 22:20:36 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-21 22:20:36 INFO  ---RUNTIME: Importing and monkey-patching took 6.575584411621094 ms
2022-09-21 22:20:53 INFO  ---RUNTIME: Original pipeline execution took 17080.063343048096 ms (excluding imports and monkey-patching)
2022-09-21 22:20:53 INFO  Starting execution of 1 what-if analyses...
2022-09-21 22:20:53 INFO  Start plan generation for analysis PermutationFeatureImportance...
2022-09-21 22:20:53 INFO  ---RUNTIME: Plan generation took 0.10347366333007812 ms
2022-09-21 22:20:53 INFO  Estimated runtime of original DAG is 13834.11192893982ms
2022-09-21 22:20:53 INFO  Performing Multi-Query Optimization
2022-09-21 22:20:53 INFO  Estimated unoptimized what-if runtime is 69170.5596446991ms
2022-09-21 22:20:53 INFO  Estimated optimised what-if runtime is 15669.823408126831ms
2022-09-21 22:20:53 INFO  Estimated optimisation runtime saving is 53500.736236572266ms
2022-09-21 22:20:53 INFO  ---RUNTIME: Multi-Query Optimization took 10.768413543701172 ms
2022-09-21 22:20:53 INFO  Executing generated plans
2022-09-21 22:21:10 INFO  ---RUNTIME: Execution took 16240.282535552979 ms
2022-09-21 22:21:10 INFO  Done!
2022-09-21 22:21:10 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-21 22:21:10 INFO  Running instrumented original pipeline...
2022-09-21 22:21:10 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-21 22:21:10 INFO  ---RUNTIME: Importing and monkey-patching took 6.036996841430664 ms
2022-09-21 22:21:27 INFO  ---RUNTIME: Original pipeline execution took 17202.87299156189 ms (excluding imports and monkey-patching)
2022-09-21 22:21:27 INFO  Starting execution of 1 what-if analyses...
2022-09-21 22:21:27 INFO  Start plan generation for analysis PermutationFeatureImportance...
2022-09-21 22:21:27 INFO  ---RUNTIME: Plan generation took 0.1010894775390625 ms
2022-09-21 22:21:27 INFO  Estimated runtime of original DAG is 13578.837394714355ms
2022-09-21 22:21:27 WARNING Skipping Multi-Query Optimization (instead, only applying patches)
2022-09-21 22:21:27 INFO  Estimated unoptimised what-if runtime is 67894.18697357178ms
2022-09-21 22:21:27 INFO  ---RUNTIME: Multi-Query Optimization took 4.181861877441406 ms
2022-09-21 22:21:27 INFO  Executing generated plans
2022-09-21 22:22:39 INFO  ---RUNTIME: Execution took 72563.37237358093 ms
2022-09-21 22:22:39 INFO  Done!
2022-09-21 22:22:40 INFO  # Finished -- repetition 6 of 7 
2022-09-21 22:22:40 INFO  # Optimization benchmark for feature_importance with args [['reviews', 'slow_loading', 'featurization_4', 'neural_network']] -- repetition 7 of 7
2022-09-21 22:22:40 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-21 22:22:40 INFO  Running instrumented original pipeline...
2022-09-21 22:22:40 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-21 22:22:40 INFO  ---RUNTIME: Importing and monkey-patching took 5.91278076171875 ms
2022-09-21 22:22:56 INFO  ---RUNTIME: Original pipeline execution took 16892.773628234863 ms (excluding imports and monkey-patching)
2022-09-21 22:22:56 INFO  Starting execution of 1 what-if analyses...
2022-09-21 22:22:56 INFO  Start plan generation for analysis PermutationFeatureImportance...
2022-09-21 22:22:56 INFO  ---RUNTIME: Plan generation took 0.13971328735351562 ms
2022-09-21 22:22:56 INFO  Estimated runtime of original DAG is 13662.287712097168ms
2022-09-21 22:22:56 INFO  Performing Multi-Query Optimization
2022-09-21 22:22:56 INFO  Estimated unoptimized what-if runtime is 68311.43856048584ms
2022-09-21 22:22:56 INFO  Estimated optimised what-if runtime is 15423.657417297363ms
2022-09-21 22:22:56 INFO  Estimated optimisation runtime saving is 52887.78114318848ms
2022-09-21 22:22:56 INFO  ---RUNTIME: Multi-Query Optimization took 10.818004608154297 ms
2022-09-21 22:22:56 INFO  Executing generated plans
2022-09-21 22:23:13 INFO  ---RUNTIME: Execution took 16181.120157241821 ms
2022-09-21 22:23:13 INFO  Done!
2022-09-21 22:23:13 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-21 22:23:13 INFO  Running instrumented original pipeline...
2022-09-21 22:23:13 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-21 22:23:13 INFO  ---RUNTIME: Importing and monkey-patching took 6.395101547241211 ms
2022-09-21 22:23:30 INFO  ---RUNTIME: Original pipeline execution took 17082.424879074097 ms (excluding imports and monkey-patching)
2022-09-21 22:23:30 INFO  Starting execution of 1 what-if analyses...
2022-09-21 22:23:30 INFO  Start plan generation for analysis PermutationFeatureImportance...
2022-09-21 22:23:30 INFO  ---RUNTIME: Plan generation took 0.1354217529296875 ms
2022-09-21 22:23:30 INFO  Estimated runtime of original DAG is 13798.595905303955ms
2022-09-21 22:23:30 WARNING Skipping Multi-Query Optimization (instead, only applying patches)
2022-09-21 22:23:30 INFO  Estimated unoptimised what-if runtime is 68992.97952651978ms
2022-09-21 22:23:30 INFO  ---RUNTIME: Multi-Query Optimization took 4.24647331237793 ms
2022-09-21 22:23:30 INFO  Executing generated plans
2022-09-21 22:24:42 INFO  ---RUNTIME: Execution took 72583.87088775635 ms
2022-09-21 22:24:42 INFO  Done!
2022-09-21 22:24:42 INFO  # Finished -- repetition 7 of 7 
2022-09-21 22:24:42 INFO  # Final results after all repetitions
2022-09-21 22:24:42 INFO     repetition  ... no_opt_what_if_execution_combined_model_training
0           0  ...                                     16636.763573
1           1  ...                                     16736.251593
2           2  ...                                     16455.887556
3           3  ...                                     16464.168787
4           4  ...                                     16566.073179
5           5  ...                                     16944.395304
6           6  ...                                     16611.912251

[7 rows x 26 columns]
taskset -c 32-39 PROTOCOL_BUFFERS_PYTHON_IMPLEMENTATION=python python3.9 benchmarks_end_to_end.py data_corruption reviews slow_loading featurization_0 logistic_regression
2022-09-21 22:24:45.200253: W tensorflow/stream_executor/platform/default/dso_loader.cc:64] Could not load dynamic library 'libcudart.so.11.0'; dlerror: libcudart.so.11.0: cannot open shared object file: No such file or directory; LD_LIBRARY_PATH: /home/sgrafbe/mlwhatif/venv/lib/python3.9/site-packages/cv2/../../lib64:
2022-09-21 22:24:45.200304: I tensorflow/stream_executor/cuda/cudart_stub.cc:29] Ignore above cudart dlerror if you do not have a GPU set up on your machine.
2022-09-21 22:24:46 INFO  Patching sys.argv with ['mlwhatif', 'reviews', 'slow_loading', 'featurization_0', 'logistic_regression']
2022-09-21 22:24:46 INFO  Running instrumented original pipeline...
2022-09-21 22:24:46 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-21 22:24:46 INFO  ---RUNTIME: Importing and monkey-patching took 96.10843658447266 ms
2022-09-21 22:24:53 INFO  ---RUNTIME: Original pipeline execution took 7029.605865478516 ms (excluding imports and monkey-patching)
2022-09-21 22:24:53 INFO  Starting execution of 0 what-if analyses...
2022-09-21 22:24:53 INFO  Estimated runtime of original DAG is 5366.106033325195ms
2022-09-21 22:24:53 INFO  Performing Multi-Query Optimization
2022-09-21 22:24:53 INFO  Estimated unoptimized what-if runtime is 0ms
2022-09-21 22:24:53 INFO  Estimated optimised what-if runtime is 0ms
2022-09-21 22:24:53 INFO  Estimated optimisation runtime saving is 0ms
2022-09-21 22:24:53 INFO  ---RUNTIME: Multi-Query Optimization took 0.4756450653076172 ms
2022-09-21 22:24:53 INFO  Executing generated plans
2022-09-21 22:24:53 INFO  ---RUNTIME: Execution took 0.021457672119140625 ms
2022-09-21 22:24:53 INFO  Done!
2022-09-21 22:24:53 INFO  # Optimization benchmark for data_corruption with args [['reviews', 'slow_loading', 'featurization_0', 'logistic_regression']] -- repetition 1 of 7
2022-09-21 22:24:53 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-21 22:24:53 INFO  Running instrumented original pipeline...
2022-09-21 22:24:53 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-21 22:24:53 INFO  ---RUNTIME: Importing and monkey-patching took 5.79071044921875 ms
2022-09-21 22:25:00 INFO  ---RUNTIME: Original pipeline execution took 7104.106664657593 ms (excluding imports and monkey-patching)
2022-09-21 22:25:00 INFO  Starting execution of 1 what-if analyses...
2022-09-21 22:25:00 INFO  Start plan generation for analysis DataCorruption...
2022-09-21 22:25:00 INFO  ---RUNTIME: Plan generation took 0.4477500915527344 ms
2022-09-21 22:25:00 INFO  Estimated runtime of original DAG is 5497.427463531494ms
2022-09-21 22:25:00 INFO  Performing Multi-Query Optimization
2022-09-21 22:25:00 INFO  Estimated unoptimized what-if runtime is 137435.68658828735ms
2022-09-21 22:25:00 INFO  Estimated optimised what-if runtime is 12166.73755645752ms
2022-09-21 22:25:00 INFO  Estimated optimisation runtime saving is 125268.94903182983ms
2022-09-21 22:25:00 INFO  ---RUNTIME: Multi-Query Optimization took 59.67307090759277 ms
2022-09-21 22:25:00 INFO  Executing generated plans
2022-09-21 22:25:18 INFO  ---RUNTIME: Execution took 17939.563274383545 ms
2022-09-21 22:25:18 INFO  Done!
2022-09-21 22:25:18 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-21 22:25:18 INFO  Running instrumented original pipeline...
2022-09-21 22:25:18 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-21 22:25:18 INFO  ---RUNTIME: Importing and monkey-patching took 5.897760391235352 ms
2022-09-21 22:25:25 INFO  ---RUNTIME: Original pipeline execution took 7102.6318073272705 ms (excluding imports and monkey-patching)
2022-09-21 22:25:25 INFO  Starting execution of 1 what-if analyses...
2022-09-21 22:25:25 INFO  Start plan generation for analysis DataCorruption...
2022-09-21 22:25:25 INFO  ---RUNTIME: Plan generation took 0.5633831024169922 ms
2022-09-21 22:25:25 INFO  Estimated runtime of original DAG is 5328.943490982056ms
2022-09-21 22:25:25 WARNING Skipping Multi-Query Optimization (instead, only applying patches)
2022-09-21 22:25:25 INFO  Estimated unoptimised what-if runtime is 133223.5872745514ms
2022-09-21 22:25:25 INFO  ---RUNTIME: Multi-Query Optimization took 17.771244049072266 ms
2022-09-21 22:25:25 INFO  Executing generated plans
2022-09-21 22:28:15 INFO  ---RUNTIME: Execution took 169520.8432674408 ms
2022-09-21 22:28:15 INFO  Done!
2022-09-21 22:28:15 INFO  # Finished -- repetition 1 of 7 
2022-09-21 22:28:15 INFO  # Optimization benchmark for data_corruption with args [['reviews', 'slow_loading', 'featurization_0', 'logistic_regression']] -- repetition 2 of 7
2022-09-21 22:28:15 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-21 22:28:15 INFO  Running instrumented original pipeline...
2022-09-21 22:28:15 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-21 22:28:15 INFO  ---RUNTIME: Importing and monkey-patching took 6.217002868652344 ms
2022-09-21 22:28:22 INFO  ---RUNTIME: Original pipeline execution took 6935.372829437256 ms (excluding imports and monkey-patching)
2022-09-21 22:28:22 INFO  Starting execution of 1 what-if analyses...
2022-09-21 22:28:22 INFO  Start plan generation for analysis DataCorruption...
2022-09-21 22:28:22 INFO  ---RUNTIME: Plan generation took 0.4215240478515625 ms
2022-09-21 22:28:22 INFO  Estimated runtime of original DAG is 5285.881996154785ms
2022-09-21 22:28:22 INFO  Performing Multi-Query Optimization
2022-09-21 22:28:22 INFO  Estimated unoptimized what-if runtime is 132147.04990386963ms
2022-09-21 22:28:22 INFO  Estimated optimised what-if runtime is 11902.68087387085ms
2022-09-21 22:28:22 INFO  Estimated optimisation runtime saving is 120244.36902999878ms
2022-09-21 22:28:22 INFO  ---RUNTIME: Multi-Query Optimization took 58.42018127441406 ms
2022-09-21 22:28:22 INFO  Executing generated plans
2022-09-21 22:28:40 INFO  ---RUNTIME: Execution took 17839.478731155396 ms
2022-09-21 22:28:40 INFO  Done!
2022-09-21 22:28:40 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-21 22:28:40 INFO  Running instrumented original pipeline...
2022-09-21 22:28:40 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-21 22:28:40 INFO  ---RUNTIME: Importing and monkey-patching took 6.130695343017578 ms
2022-09-21 22:28:47 INFO  ---RUNTIME: Original pipeline execution took 6920.4065799713135 ms (excluding imports and monkey-patching)
2022-09-21 22:28:47 INFO  Starting execution of 1 what-if analyses...
2022-09-21 22:28:47 INFO  Start plan generation for analysis DataCorruption...
2022-09-21 22:28:47 INFO  ---RUNTIME: Plan generation took 0.40984153747558594 ms
2022-09-21 22:28:47 INFO  Estimated runtime of original DAG is 5301.15270614624ms
2022-09-21 22:28:47 WARNING Skipping Multi-Query Optimization (instead, only applying patches)
2022-09-21 22:28:47 INFO  Estimated unoptimised what-if runtime is 132528.817653656ms
2022-09-21 22:28:47 INFO  ---RUNTIME: Multi-Query Optimization took 17.80080795288086 ms
2022-09-21 22:28:47 INFO  Executing generated plans
2022-09-21 22:31:37 INFO  ---RUNTIME: Execution took 170399.39761161804 ms
2022-09-21 22:31:37 INFO  Done!
2022-09-21 22:31:37 INFO  # Finished -- repetition 2 of 7 
2022-09-21 22:31:37 INFO  # Optimization benchmark for data_corruption with args [['reviews', 'slow_loading', 'featurization_0', 'logistic_regression']] -- repetition 3 of 7
2022-09-21 22:31:37 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-21 22:31:37 INFO  Running instrumented original pipeline...
2022-09-21 22:31:37 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-21 22:31:37 INFO  ---RUNTIME: Importing and monkey-patching took 12.540817260742188 ms
2022-09-21 22:31:44 INFO  ---RUNTIME: Original pipeline execution took 6961.413383483887 ms (excluding imports and monkey-patching)
2022-09-21 22:31:44 INFO  Starting execution of 1 what-if analyses...
2022-09-21 22:31:44 INFO  Start plan generation for analysis DataCorruption...
2022-09-21 22:31:44 INFO  ---RUNTIME: Plan generation took 0.44155120849609375 ms
2022-09-21 22:31:44 INFO  Estimated runtime of original DAG is 5287.984132766724ms
2022-09-21 22:31:44 INFO  Performing Multi-Query Optimization
2022-09-21 22:31:44 INFO  Estimated unoptimized what-if runtime is 132199.6033191681ms
2022-09-21 22:31:44 INFO  Estimated optimised what-if runtime is 11907.057523727417ms
2022-09-21 22:31:44 INFO  Estimated optimisation runtime saving is 120292.54579544067ms
2022-09-21 22:31:44 INFO  ---RUNTIME: Multi-Query Optimization took 100.30364990234375 ms
2022-09-21 22:31:44 INFO  Executing generated plans
2022-09-21 22:32:04 INFO  ---RUNTIME: Execution took 19447.230100631714 ms
2022-09-21 22:32:04 INFO  Done!
2022-09-21 22:32:04 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-21 22:32:04 INFO  Running instrumented original pipeline...
2022-09-21 22:32:04 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-21 22:32:04 INFO  ---RUNTIME: Importing and monkey-patching took 8.259296417236328 ms
2022-09-21 22:32:13 INFO  ---RUNTIME: Original pipeline execution took 9451.305389404297 ms (excluding imports and monkey-patching)
2022-09-21 22:32:13 INFO  Starting execution of 1 what-if analyses...
2022-09-21 22:32:13 INFO  Start plan generation for analysis DataCorruption...
2022-09-21 22:32:13 INFO  ---RUNTIME: Plan generation took 0.5497932434082031 ms
2022-09-21 22:32:13 INFO  Estimated runtime of original DAG is 7121.806621551514ms
2022-09-21 22:32:13 WARNING Skipping Multi-Query Optimization (instead, only applying patches)
2022-09-21 22:32:13 INFO  Estimated unoptimised what-if runtime is 178045.16553878784ms
2022-09-21 22:32:13 INFO  ---RUNTIME: Multi-Query Optimization took 25.109529495239258 ms
2022-09-21 22:32:13 INFO  Executing generated plans
2022-09-21 22:35:08 INFO  ---RUNTIME: Execution took 175075.5033493042 ms
2022-09-21 22:35:08 INFO  Done!
2022-09-21 22:35:08 INFO  # Finished -- repetition 3 of 7 
2022-09-21 22:35:08 INFO  # Optimization benchmark for data_corruption with args [['reviews', 'slow_loading', 'featurization_0', 'logistic_regression']] -- repetition 4 of 7
2022-09-21 22:35:08 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-21 22:35:08 INFO  Running instrumented original pipeline...
2022-09-21 22:35:08 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-21 22:35:08 INFO  ---RUNTIME: Importing and monkey-patching took 6.173133850097656 ms
2022-09-21 22:35:15 INFO  ---RUNTIME: Original pipeline execution took 6954.890727996826 ms (excluding imports and monkey-patching)
2022-09-21 22:35:15 INFO  Starting execution of 1 what-if analyses...
2022-09-21 22:35:15 INFO  Start plan generation for analysis DataCorruption...
2022-09-21 22:35:15 INFO  ---RUNTIME: Plan generation took 0.4062652587890625 ms
2022-09-21 22:35:15 INFO  Estimated runtime of original DAG is 5303.423643112183ms
2022-09-21 22:35:15 INFO  Performing Multi-Query Optimization
2022-09-21 22:35:15 INFO  Estimated unoptimized what-if runtime is 132585.59107780457ms
2022-09-21 22:35:15 INFO  Estimated optimised what-if runtime is 11907.379150390625ms
2022-09-21 22:35:15 INFO  Estimated optimisation runtime saving is 120678.21192741394ms
2022-09-21 22:35:15 INFO  ---RUNTIME: Multi-Query Optimization took 58.79926681518555 ms
2022-09-21 22:35:15 INFO  Executing generated plans
2022-09-21 22:35:37 INFO  ---RUNTIME: Execution took 21762.03489303589 ms
2022-09-21 22:35:37 INFO  Done!
2022-09-21 22:35:37 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-21 22:35:37 INFO  Running instrumented original pipeline...
2022-09-21 22:35:37 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-21 22:35:37 INFO  ---RUNTIME: Importing and monkey-patching took 6.17527961730957 ms
2022-09-21 22:35:44 INFO  ---RUNTIME: Original pipeline execution took 7216.456651687622 ms (excluding imports and monkey-patching)
2022-09-21 22:35:44 INFO  Starting execution of 1 what-if analyses...
2022-09-21 22:35:44 INFO  Start plan generation for analysis DataCorruption...
2022-09-21 22:35:44 INFO  ---RUNTIME: Plan generation took 0.4343986511230469 ms
2022-09-21 22:35:44 INFO  Estimated runtime of original DAG is 5486.353397369385ms
2022-09-21 22:35:44 WARNING Skipping Multi-Query Optimization (instead, only applying patches)
2022-09-21 22:35:44 INFO  Estimated unoptimised what-if runtime is 137158.83493423462ms
2022-09-21 22:35:44 INFO  ---RUNTIME: Multi-Query Optimization took 18.039226531982422 ms
2022-09-21 22:35:44 INFO  Executing generated plans
2022-09-21 22:38:38 INFO  ---RUNTIME: Execution took 173378.27587127686 ms
2022-09-21 22:38:38 INFO  Done!
2022-09-21 22:38:38 INFO  # Finished -- repetition 4 of 7 
2022-09-21 22:38:38 INFO  # Optimization benchmark for data_corruption with args [['reviews', 'slow_loading', 'featurization_0', 'logistic_regression']] -- repetition 5 of 7
2022-09-21 22:38:38 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-21 22:38:38 INFO  Running instrumented original pipeline...
2022-09-21 22:38:38 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-21 22:38:38 INFO  ---RUNTIME: Importing and monkey-patching took 6.41179084777832 ms
2022-09-21 22:38:46 INFO  ---RUNTIME: Original pipeline execution took 8848.718643188477 ms (excluding imports and monkey-patching)
2022-09-21 22:38:46 INFO  Starting execution of 1 what-if analyses...
2022-09-21 22:38:46 INFO  Start plan generation for analysis DataCorruption...
2022-09-21 22:38:46 INFO  ---RUNTIME: Plan generation took 0.6060600280761719 ms
2022-09-21 22:38:46 INFO  Estimated runtime of original DAG is 6569.6868896484375ms
2022-09-21 22:38:46 INFO  Performing Multi-Query Optimization
2022-09-21 22:38:46 INFO  Estimated unoptimized what-if runtime is 164242.17224121094ms
2022-09-21 22:38:46 INFO  Estimated optimised what-if runtime is 15320.871353149414ms
2022-09-21 22:38:46 INFO  Estimated optimisation runtime saving is 148921.30088806152ms
2022-09-21 22:38:46 INFO  ---RUNTIME: Multi-Query Optimization took 80.93690872192383 ms
2022-09-21 22:38:46 INFO  Executing generated plans
2022-09-21 22:39:07 INFO  ---RUNTIME: Execution took 20406.126022338867 ms
2022-09-21 22:39:07 INFO  Done!
2022-09-21 22:39:07 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-21 22:39:07 INFO  Running instrumented original pipeline...
2022-09-21 22:39:07 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-21 22:39:07 INFO  ---RUNTIME: Importing and monkey-patching took 6.311655044555664 ms
2022-09-21 22:39:14 INFO  ---RUNTIME: Original pipeline execution took 7136.813402175903 ms (excluding imports and monkey-patching)
2022-09-21 22:39:14 INFO  Starting execution of 1 what-if analyses...
2022-09-21 22:39:14 INFO  Start plan generation for analysis DataCorruption...
2022-09-21 22:39:14 INFO  ---RUNTIME: Plan generation took 0.4100799560546875 ms
2022-09-21 22:39:14 INFO  Estimated runtime of original DAG is 5311.988353729248ms
2022-09-21 22:39:14 WARNING Skipping Multi-Query Optimization (instead, only applying patches)
2022-09-21 22:39:14 INFO  Estimated unoptimised what-if runtime is 132799.7088432312ms
2022-09-21 22:39:14 INFO  ---RUNTIME: Multi-Query Optimization took 17.510652542114258 ms
2022-09-21 22:39:14 INFO  Executing generated plans
2022-09-21 22:42:09 INFO  ---RUNTIME: Execution took 175230.50618171692 ms
2022-09-21 22:42:09 INFO  Done!
2022-09-21 22:42:09 INFO  # Finished -- repetition 5 of 7 
2022-09-21 22:42:09 INFO  # Optimization benchmark for data_corruption with args [['reviews', 'slow_loading', 'featurization_0', 'logistic_regression']] -- repetition 6 of 7
2022-09-21 22:42:09 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-21 22:42:09 INFO  Running instrumented original pipeline...
2022-09-21 22:42:09 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-21 22:42:09 INFO  ---RUNTIME: Importing and monkey-patching took 8.69607925415039 ms
2022-09-21 22:42:19 INFO  ---RUNTIME: Original pipeline execution took 9510.63323020935 ms (excluding imports and monkey-patching)
2022-09-21 22:42:19 INFO  Starting execution of 1 what-if analyses...
2022-09-21 22:42:19 INFO  Start plan generation for analysis DataCorruption...
2022-09-21 22:42:19 INFO  ---RUNTIME: Plan generation took 0.6666183471679688 ms
2022-09-21 22:42:19 INFO  Estimated runtime of original DAG is 7221.238851547241ms
2022-09-21 22:42:19 INFO  Performing Multi-Query Optimization
2022-09-21 22:42:19 INFO  Estimated unoptimized what-if runtime is 180530.97128868103ms
2022-09-21 22:42:19 INFO  Estimated optimised what-if runtime is 15680.917501449585ms
2022-09-21 22:42:19 INFO  Estimated optimisation runtime saving is 164850.05378723145ms
2022-09-21 22:42:19 INFO  ---RUNTIME: Multi-Query Optimization took 78.88293266296387 ms
2022-09-21 22:42:19 INFO  Executing generated plans
2022-09-21 22:42:37 INFO  ---RUNTIME: Execution took 18177.932739257812 ms
2022-09-21 22:42:37 INFO  Done!
2022-09-21 22:42:37 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-21 22:42:37 INFO  Running instrumented original pipeline...
2022-09-21 22:42:37 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-21 22:42:37 INFO  ---RUNTIME: Importing and monkey-patching took 6.414890289306641 ms
2022-09-21 22:42:45 INFO  ---RUNTIME: Original pipeline execution took 7413.643836975098 ms (excluding imports and monkey-patching)
2022-09-21 22:42:45 INFO  Starting execution of 1 what-if analyses...
2022-09-21 22:42:45 INFO  Start plan generation for analysis DataCorruption...
2022-09-21 22:42:45 INFO  ---RUNTIME: Plan generation took 0.4932880401611328 ms
2022-09-21 22:42:45 INFO  Estimated runtime of original DAG is 5289.226055145264ms
2022-09-21 22:42:45 WARNING Skipping Multi-Query Optimization (instead, only applying patches)
2022-09-21 22:42:45 INFO  Estimated unoptimised what-if runtime is 132230.6513786316ms
2022-09-21 22:42:45 INFO  ---RUNTIME: Multi-Query Optimization took 17.05455780029297 ms
2022-09-21 22:42:45 INFO  Executing generated plans
2022-09-21 22:45:43 INFO  ---RUNTIME: Execution took 178600.38828849792 ms
2022-09-21 22:45:43 INFO  Done!
2022-09-21 22:45:43 INFO  # Finished -- repetition 6 of 7 
2022-09-21 22:45:43 INFO  # Optimization benchmark for data_corruption with args [['reviews', 'slow_loading', 'featurization_0', 'logistic_regression']] -- repetition 7 of 7
2022-09-21 22:45:43 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-21 22:45:43 INFO  Running instrumented original pipeline...
2022-09-21 22:45:43 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-21 22:45:43 INFO  ---RUNTIME: Importing and monkey-patching took 6.336688995361328 ms
2022-09-21 22:45:50 INFO  ---RUNTIME: Original pipeline execution took 7250.1540184021 ms (excluding imports and monkey-patching)
2022-09-21 22:45:50 INFO  Starting execution of 1 what-if analyses...
2022-09-21 22:45:50 INFO  Start plan generation for analysis DataCorruption...
2022-09-21 22:45:50 INFO  ---RUNTIME: Plan generation took 0.41222572326660156 ms
2022-09-21 22:45:50 INFO  Estimated runtime of original DAG is 5477.937936782837ms
2022-09-21 22:45:50 INFO  Performing Multi-Query Optimization
2022-09-21 22:45:50 INFO  Estimated unoptimized what-if runtime is 136948.44841957092ms
2022-09-21 22:45:50 INFO  Estimated optimised what-if runtime is 12106.631755828857ms
2022-09-21 22:45:50 INFO  Estimated optimisation runtime saving is 124841.81666374207ms
2022-09-21 22:45:50 INFO  ---RUNTIME: Multi-Query Optimization took 58.07971954345703 ms
2022-09-21 22:45:50 INFO  Executing generated plans
2022-09-21 22:46:09 INFO  ---RUNTIME: Execution took 18429.755210876465 ms
2022-09-21 22:46:09 INFO  Done!
2022-09-21 22:46:09 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-21 22:46:09 INFO  Running instrumented original pipeline...
2022-09-21 22:46:09 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-21 22:46:09 INFO  ---RUNTIME: Importing and monkey-patching took 7.803678512573242 ms
2022-09-21 22:46:16 INFO  ---RUNTIME: Original pipeline execution took 7120.502233505249 ms (excluding imports and monkey-patching)
2022-09-21 22:46:16 INFO  Starting execution of 1 what-if analyses...
2022-09-21 22:46:16 INFO  Start plan generation for analysis DataCorruption...
2022-09-21 22:46:16 INFO  ---RUNTIME: Plan generation took 0.553131103515625 ms
2022-09-21 22:46:16 INFO  Estimated runtime of original DAG is 5446.557521820068ms
2022-09-21 22:46:16 WARNING Skipping Multi-Query Optimization (instead, only applying patches)
2022-09-21 22:46:16 INFO  Estimated unoptimised what-if runtime is 136163.9380455017ms
2022-09-21 22:46:16 INFO  ---RUNTIME: Multi-Query Optimization took 23.431777954101562 ms
2022-09-21 22:46:16 INFO  Executing generated plans
2022-09-21 22:49:14 INFO  ---RUNTIME: Execution took 177481.11963272095 ms
2022-09-21 22:49:14 INFO  Done!
2022-09-21 22:49:14 INFO  # Finished -- repetition 7 of 7 
2022-09-21 22:49:14 INFO  # Final results after all repetitions
2022-09-21 22:49:14 INFO     repetition  ... no_opt_what_if_execution_combined_model_training
0           0  ...                                      3947.416782
1           1  ...                                      3926.858425
2           2  ...                                      3935.381651
3           3  ...                                      4368.369579
4           4  ...                                      4362.262487
5           5  ...                                      4063.498259
6           6  ...                                      4220.984221

[7 rows x 26 columns]
taskset -c 32-39 PROTOCOL_BUFFERS_PYTHON_IMPLEMENTATION=python python3.9 benchmarks_end_to_end.py data_corruption reviews slow_loading featurization_0 xgboost
2022-09-21 22:49:16.256345: W tensorflow/stream_executor/platform/default/dso_loader.cc:64] Could not load dynamic library 'libcudart.so.11.0'; dlerror: libcudart.so.11.0: cannot open shared object file: No such file or directory; LD_LIBRARY_PATH: /home/sgrafbe/mlwhatif/venv/lib/python3.9/site-packages/cv2/../../lib64:
2022-09-21 22:49:16.256406: I tensorflow/stream_executor/cuda/cudart_stub.cc:29] Ignore above cudart dlerror if you do not have a GPU set up on your machine.
2022-09-21 22:49:17 INFO  Patching sys.argv with ['mlwhatif', 'reviews', 'slow_loading', 'featurization_0', 'xgboost']
2022-09-21 22:49:17 INFO  Running instrumented original pipeline...
2022-09-21 22:49:17 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-21 22:49:17 INFO  ---RUNTIME: Importing and monkey-patching took 95.89552879333496 ms
2022-09-21 22:49:25 INFO  ---RUNTIME: Original pipeline execution took 7975.786209106445 ms (excluding imports and monkey-patching)
2022-09-21 22:49:25 INFO  Starting execution of 0 what-if analyses...
2022-09-21 22:49:25 INFO  Estimated runtime of original DAG is 6321.638822555542ms
2022-09-21 22:49:25 INFO  Performing Multi-Query Optimization
2022-09-21 22:49:25 INFO  Estimated unoptimized what-if runtime is 0ms
2022-09-21 22:49:25 INFO  Estimated optimised what-if runtime is 0ms
2022-09-21 22:49:25 INFO  Estimated optimisation runtime saving is 0ms
2022-09-21 22:49:25 INFO  ---RUNTIME: Multi-Query Optimization took 0.5004405975341797 ms
2022-09-21 22:49:25 INFO  Executing generated plans
2022-09-21 22:49:25 INFO  ---RUNTIME: Execution took 0.02288818359375 ms
2022-09-21 22:49:25 INFO  Done!
2022-09-21 22:49:25 INFO  # Optimization benchmark for data_corruption with args [['reviews', 'slow_loading', 'featurization_0', 'xgboost']] -- repetition 1 of 7
2022-09-21 22:49:25 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-21 22:49:25 INFO  Running instrumented original pipeline...
2022-09-21 22:49:25 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-21 22:49:25 INFO  ---RUNTIME: Importing and monkey-patching took 5.730867385864258 ms
2022-09-21 22:49:33 INFO  ---RUNTIME: Original pipeline execution took 7712.251424789429 ms (excluding imports and monkey-patching)
2022-09-21 22:49:33 INFO  Starting execution of 1 what-if analyses...
2022-09-21 22:49:33 INFO  Start plan generation for analysis DataCorruption...
2022-09-21 22:49:33 INFO  ---RUNTIME: Plan generation took 0.42629241943359375 ms
2022-09-21 22:49:33 INFO  Estimated runtime of original DAG is 6102.6294231414795ms
2022-09-21 22:49:33 INFO  Performing Multi-Query Optimization
2022-09-21 22:49:33 INFO  Estimated unoptimized what-if runtime is 152565.735578537ms
2022-09-21 22:49:33 INFO  Estimated optimised what-if runtime is 13903.743028640747ms
2022-09-21 22:49:33 INFO  Estimated optimisation runtime saving is 138661.99254989624ms
2022-09-21 22:49:33 INFO  ---RUNTIME: Multi-Query Optimization took 59.814453125 ms
2022-09-21 22:49:33 INFO  Executing generated plans
2022-09-21 22:49:53 INFO  ---RUNTIME: Execution took 20081.668376922607 ms
2022-09-21 22:49:53 INFO  Done!
2022-09-21 22:49:53 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-21 22:49:53 INFO  Running instrumented original pipeline...
2022-09-21 22:49:53 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-21 22:49:53 INFO  ---RUNTIME: Importing and monkey-patching took 5.856513977050781 ms
2022-09-21 22:50:01 INFO  ---RUNTIME: Original pipeline execution took 8097.825288772583 ms (excluding imports and monkey-patching)
2022-09-21 22:50:01 INFO  Starting execution of 1 what-if analyses...
2022-09-21 22:50:01 INFO  Start plan generation for analysis DataCorruption...
2022-09-21 22:50:01 INFO  ---RUNTIME: Plan generation took 0.44608116149902344 ms
2022-09-21 22:50:01 INFO  Estimated runtime of original DAG is 6293.831348419189ms
2022-09-21 22:50:01 WARNING Skipping Multi-Query Optimization (instead, only applying patches)
2022-09-21 22:50:01 INFO  Estimated unoptimised what-if runtime is 157345.78371047974ms
2022-09-21 22:50:01 INFO  ---RUNTIME: Multi-Query Optimization took 17.563581466674805 ms
2022-09-21 22:50:01 INFO  Executing generated plans
2022-09-21 22:53:14 INFO  ---RUNTIME: Execution took 192450.4120349884 ms
2022-09-21 22:53:14 INFO  Done!
2022-09-21 22:53:14 INFO  # Finished -- repetition 1 of 7 
2022-09-21 22:53:14 INFO  # Optimization benchmark for data_corruption with args [['reviews', 'slow_loading', 'featurization_0', 'xgboost']] -- repetition 2 of 7
2022-09-21 22:53:14 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-21 22:53:14 INFO  Running instrumented original pipeline...
2022-09-21 22:53:14 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-21 22:53:14 INFO  ---RUNTIME: Importing and monkey-patching took 6.2198638916015625 ms
2022-09-21 22:53:21 INFO  ---RUNTIME: Original pipeline execution took 7736.807584762573 ms (excluding imports and monkey-patching)
2022-09-21 22:53:21 INFO  Starting execution of 1 what-if analyses...
2022-09-21 22:53:21 INFO  Start plan generation for analysis DataCorruption...
2022-09-21 22:53:21 INFO  ---RUNTIME: Plan generation took 0.42748451232910156 ms
2022-09-21 22:53:21 INFO  Estimated runtime of original DAG is 6105.231046676636ms
2022-09-21 22:53:21 INFO  Performing Multi-Query Optimization
2022-09-21 22:53:21 INFO  Estimated unoptimized what-if runtime is 152630.7761669159ms
2022-09-21 22:53:21 INFO  Estimated optimised what-if runtime is 13863.512992858887ms
2022-09-21 22:53:21 INFO  Estimated optimisation runtime saving is 138767.263174057ms
2022-09-21 22:53:21 INFO  ---RUNTIME: Multi-Query Optimization took 59.59439277648926 ms
2022-09-21 22:53:21 INFO  Executing generated plans
2022-09-21 22:53:42 INFO  ---RUNTIME: Execution took 20219.674825668335 ms
2022-09-21 22:53:42 INFO  Done!
2022-09-21 22:53:42 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-21 22:53:42 INFO  Running instrumented original pipeline...
2022-09-21 22:53:42 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-21 22:53:42 INFO  ---RUNTIME: Importing and monkey-patching took 5.897760391235352 ms
2022-09-21 22:53:49 INFO  ---RUNTIME: Original pipeline execution took 7767.779111862183 ms (excluding imports and monkey-patching)
2022-09-21 22:53:49 INFO  Starting execution of 1 what-if analyses...
2022-09-21 22:53:49 INFO  Start plan generation for analysis DataCorruption...
2022-09-21 22:53:49 INFO  ---RUNTIME: Plan generation took 0.40435791015625 ms
2022-09-21 22:53:49 INFO  Estimated runtime of original DAG is 6129.019975662231ms
2022-09-21 22:53:49 WARNING Skipping Multi-Query Optimization (instead, only applying patches)
2022-09-21 22:53:50 INFO  Estimated unoptimised what-if runtime is 153225.4993915558ms
2022-09-21 22:53:50 INFO  ---RUNTIME: Multi-Query Optimization took 18.10741424560547 ms
2022-09-21 22:53:50 INFO  Executing generated plans
2022-09-21 22:57:08 INFO  ---RUNTIME: Execution took 198053.4610748291 ms
2022-09-21 22:57:08 INFO  Done!
2022-09-21 22:57:08 INFO  # Finished -- repetition 2 of 7 
2022-09-21 22:57:08 INFO  # Optimization benchmark for data_corruption with args [['reviews', 'slow_loading', 'featurization_0', 'xgboost']] -- repetition 3 of 7
2022-09-21 22:57:08 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-21 22:57:08 INFO  Running instrumented original pipeline...
2022-09-21 22:57:08 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-21 22:57:08 INFO  ---RUNTIME: Importing and monkey-patching took 6.760835647583008 ms
2022-09-21 22:57:15 INFO  ---RUNTIME: Original pipeline execution took 7672.18017578125 ms (excluding imports and monkey-patching)
2022-09-21 22:57:15 INFO  Starting execution of 1 what-if analyses...
2022-09-21 22:57:15 INFO  Start plan generation for analysis DataCorruption...
2022-09-21 22:57:15 INFO  ---RUNTIME: Plan generation took 0.4172325134277344 ms
2022-09-21 22:57:15 INFO  Estimated runtime of original DAG is 6000.89430809021ms
2022-09-21 22:57:15 INFO  Performing Multi-Query Optimization
2022-09-21 22:57:15 INFO  Estimated unoptimized what-if runtime is 150022.35770225525ms
2022-09-21 22:57:15 INFO  Estimated optimised what-if runtime is 13806.630849838257ms
2022-09-21 22:57:15 INFO  Estimated optimisation runtime saving is 136215.726852417ms
2022-09-21 22:57:15 INFO  ---RUNTIME: Multi-Query Optimization took 59.78250503540039 ms
2022-09-21 22:57:15 INFO  Executing generated plans
2022-09-21 22:57:36 INFO  ---RUNTIME: Execution took 20249.622344970703 ms
2022-09-21 22:57:36 INFO  Done!
2022-09-21 22:57:36 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-21 22:57:36 INFO  Running instrumented original pipeline...
2022-09-21 22:57:36 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-21 22:57:36 INFO  ---RUNTIME: Importing and monkey-patching took 5.818367004394531 ms
2022-09-21 22:57:44 INFO  ---RUNTIME: Original pipeline execution took 8230.022668838501 ms (excluding imports and monkey-patching)
2022-09-21 22:57:44 INFO  Starting execution of 1 what-if analyses...
2022-09-21 22:57:44 INFO  Start plan generation for analysis DataCorruption...
2022-09-21 22:57:44 INFO  ---RUNTIME: Plan generation took 0.4150867462158203 ms
2022-09-21 22:57:44 INFO  Estimated runtime of original DAG is 6477.944612503052ms
2022-09-21 22:57:44 WARNING Skipping Multi-Query Optimization (instead, only applying patches)
2022-09-21 22:57:44 INFO  Estimated unoptimised what-if runtime is 161948.6153125763ms
2022-09-21 22:57:44 INFO  ---RUNTIME: Multi-Query Optimization took 17.762422561645508 ms
2022-09-21 22:57:44 INFO  Executing generated plans
2022-09-21 23:01:06 INFO  ---RUNTIME: Execution took 201723.73414039612 ms
2022-09-21 23:01:06 INFO  Done!
2022-09-21 23:01:06 INFO  # Finished -- repetition 3 of 7 
2022-09-21 23:01:06 INFO  # Optimization benchmark for data_corruption with args [['reviews', 'slow_loading', 'featurization_0', 'xgboost']] -- repetition 4 of 7
2022-09-21 23:01:06 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-21 23:01:06 INFO  Running instrumented original pipeline...
2022-09-21 23:01:06 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-21 23:01:06 INFO  ---RUNTIME: Importing and monkey-patching took 5.938529968261719 ms
2022-09-21 23:01:13 INFO  ---RUNTIME: Original pipeline execution took 7803.657054901123 ms (excluding imports and monkey-patching)
2022-09-21 23:01:13 INFO  Starting execution of 1 what-if analyses...
2022-09-21 23:01:13 INFO  Start plan generation for analysis DataCorruption...
2022-09-21 23:01:13 INFO  ---RUNTIME: Plan generation took 0.43582916259765625 ms
2022-09-21 23:01:13 INFO  Estimated runtime of original DAG is 5931.526899337769ms
2022-09-21 23:01:13 INFO  Performing Multi-Query Optimization
2022-09-21 23:01:13 INFO  Estimated unoptimized what-if runtime is 148288.1724834442ms
2022-09-21 23:01:13 INFO  Estimated optimised what-if runtime is 13731.197595596313ms
2022-09-21 23:01:13 INFO  Estimated optimisation runtime saving is 134556.9748878479ms
2022-09-21 23:01:13 INFO  ---RUNTIME: Multi-Query Optimization took 59.67974662780762 ms
2022-09-21 23:01:13 INFO  Executing generated plans
2022-09-21 23:01:35 INFO  ---RUNTIME: Execution took 21917.232513427734 ms
2022-09-21 23:01:35 INFO  Done!
2022-09-21 23:01:35 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-21 23:01:35 INFO  Running instrumented original pipeline...
2022-09-21 23:01:35 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-21 23:01:35 INFO  ---RUNTIME: Importing and monkey-patching took 6.782293319702148 ms
2022-09-21 23:01:44 INFO  ---RUNTIME: Original pipeline execution took 8153.3567905426025 ms (excluding imports and monkey-patching)
2022-09-21 23:01:44 INFO  Starting execution of 1 what-if analyses...
2022-09-21 23:01:44 INFO  Start plan generation for analysis DataCorruption...
2022-09-21 23:01:44 INFO  ---RUNTIME: Plan generation took 0.5009174346923828 ms
2022-09-21 23:01:44 INFO  Estimated runtime of original DAG is 6358.872175216675ms
2022-09-21 23:01:44 WARNING Skipping Multi-Query Optimization (instead, only applying patches)
2022-09-21 23:01:44 INFO  Estimated unoptimised what-if runtime is 158971.80438041687ms
2022-09-21 23:01:44 INFO  ---RUNTIME: Multi-Query Optimization took 20.52164077758789 ms
2022-09-21 23:01:44 INFO  Executing generated plans
2022-09-21 23:04:55 INFO  ---RUNTIME: Execution took 191117.48695373535 ms
2022-09-21 23:04:55 INFO  Done!
2022-09-21 23:04:55 INFO  # Finished -- repetition 4 of 7 
2022-09-21 23:04:55 INFO  # Optimization benchmark for data_corruption with args [['reviews', 'slow_loading', 'featurization_0', 'xgboost']] -- repetition 5 of 7
2022-09-21 23:04:55 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-21 23:04:55 INFO  Running instrumented original pipeline...
2022-09-21 23:04:55 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-21 23:04:55 INFO  ---RUNTIME: Importing and monkey-patching took 6.142854690551758 ms
2022-09-21 23:05:03 INFO  ---RUNTIME: Original pipeline execution took 7873.530387878418 ms (excluding imports and monkey-patching)
2022-09-21 23:05:03 INFO  Starting execution of 1 what-if analyses...
2022-09-21 23:05:03 INFO  Start plan generation for analysis DataCorruption...
2022-09-21 23:05:03 INFO  ---RUNTIME: Plan generation took 0.4317760467529297 ms
2022-09-21 23:05:03 INFO  Estimated runtime of original DAG is 6161.928653717041ms
2022-09-21 23:05:03 INFO  Performing Multi-Query Optimization
2022-09-21 23:05:03 INFO  Estimated unoptimized what-if runtime is 154048.21634292603ms
2022-09-21 23:05:03 INFO  Estimated optimised what-if runtime is 14017.600059509277ms
2022-09-21 23:05:03 INFO  Estimated optimisation runtime saving is 140030.61628341675ms
2022-09-21 23:05:03 INFO  ---RUNTIME: Multi-Query Optimization took 58.61496925354004 ms
2022-09-21 23:05:03 INFO  Executing generated plans
2022-09-21 23:05:23 INFO  ---RUNTIME: Execution took 20055.78923225403 ms
2022-09-21 23:05:23 INFO  Done!
2022-09-21 23:05:23 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-21 23:05:23 INFO  Running instrumented original pipeline...
2022-09-21 23:05:23 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-21 23:05:23 INFO  ---RUNTIME: Importing and monkey-patching took 5.6781768798828125 ms
2022-09-21 23:05:30 INFO  ---RUNTIME: Original pipeline execution took 7715.67177772522 ms (excluding imports and monkey-patching)
2022-09-21 23:05:30 INFO  Starting execution of 1 what-if analyses...
2022-09-21 23:05:30 INFO  Start plan generation for analysis DataCorruption...
2022-09-21 23:05:30 INFO  ---RUNTIME: Plan generation took 0.446319580078125 ms
2022-09-21 23:05:30 INFO  Estimated runtime of original DAG is 6036.263942718506ms
2022-09-21 23:05:30 WARNING Skipping Multi-Query Optimization (instead, only applying patches)
2022-09-21 23:05:30 INFO  Estimated unoptimised what-if runtime is 150906.59856796265ms
2022-09-21 23:05:30 INFO  ---RUNTIME: Multi-Query Optimization took 17.075061798095703 ms
2022-09-21 23:05:30 INFO  Executing generated plans
2022-09-21 23:08:46 INFO  ---RUNTIME: Execution took 195915.88020324707 ms
2022-09-21 23:08:46 INFO  Done!
2022-09-21 23:08:46 INFO  # Finished -- repetition 5 of 7 
2022-09-21 23:08:46 INFO  # Optimization benchmark for data_corruption with args [['reviews', 'slow_loading', 'featurization_0', 'xgboost']] -- repetition 6 of 7
2022-09-21 23:08:46 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-21 23:08:46 INFO  Running instrumented original pipeline...
2022-09-21 23:08:46 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-21 23:08:46 INFO  ---RUNTIME: Importing and monkey-patching took 6.2198638916015625 ms
2022-09-21 23:08:54 INFO  ---RUNTIME: Original pipeline execution took 7661.879777908325 ms (excluding imports and monkey-patching)
2022-09-21 23:08:54 INFO  Starting execution of 1 what-if analyses...
2022-09-21 23:08:54 INFO  Start plan generation for analysis DataCorruption...
2022-09-21 23:08:54 INFO  ---RUNTIME: Plan generation took 0.4382133483886719 ms
2022-09-21 23:08:54 INFO  Estimated runtime of original DAG is 6021.651744842529ms
2022-09-21 23:08:54 INFO  Performing Multi-Query Optimization
2022-09-21 23:08:54 INFO  Estimated unoptimized what-if runtime is 150541.29362106323ms
2022-09-21 23:08:54 INFO  Estimated optimised what-if runtime is 14289.417028427124ms
2022-09-21 23:08:54 INFO  Estimated optimisation runtime saving is 136251.8765926361ms
2022-09-21 23:08:54 INFO  ---RUNTIME: Multi-Query Optimization took 65.23799896240234 ms
2022-09-21 23:08:54 INFO  Executing generated plans
2022-09-21 23:09:14 INFO  ---RUNTIME: Execution took 19821.82240486145 ms
2022-09-21 23:09:14 INFO  Done!
2022-09-21 23:09:14 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-21 23:09:14 INFO  Running instrumented original pipeline...
2022-09-21 23:09:14 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-21 23:09:14 INFO  ---RUNTIME: Importing and monkey-patching took 6.437063217163086 ms
2022-09-21 23:09:22 INFO  ---RUNTIME: Original pipeline execution took 7664.7515296936035 ms (excluding imports and monkey-patching)
2022-09-21 23:09:22 INFO  Starting execution of 1 what-if analyses...
2022-09-21 23:09:22 INFO  Start plan generation for analysis DataCorruption...
2022-09-21 23:09:22 INFO  ---RUNTIME: Plan generation took 0.4010200500488281 ms
2022-09-21 23:09:22 INFO  Estimated runtime of original DAG is 6023.6687660217285ms
2022-09-21 23:09:22 WARNING Skipping Multi-Query Optimization (instead, only applying patches)
2022-09-21 23:09:22 INFO  Estimated unoptimised what-if runtime is 150591.7191505432ms
2022-09-21 23:09:22 INFO  ---RUNTIME: Multi-Query Optimization took 263.90552520751953 ms
2022-09-21 23:09:22 INFO  Executing generated plans
2022-09-21 23:12:41 INFO  ---RUNTIME: Execution took 199063.12227249146 ms
2022-09-21 23:12:41 INFO  Done!
2022-09-21 23:12:41 INFO  # Finished -- repetition 6 of 7 
2022-09-21 23:12:41 INFO  # Optimization benchmark for data_corruption with args [['reviews', 'slow_loading', 'featurization_0', 'xgboost']] -- repetition 7 of 7
2022-09-21 23:12:41 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-21 23:12:41 INFO  Running instrumented original pipeline...
2022-09-21 23:12:41 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-21 23:12:41 INFO  ---RUNTIME: Importing and monkey-patching took 6.980180740356445 ms
2022-09-21 23:12:49 INFO  ---RUNTIME: Original pipeline execution took 8073.382377624512 ms (excluding imports and monkey-patching)
2022-09-21 23:12:49 INFO  Starting execution of 1 what-if analyses...
2022-09-21 23:12:49 INFO  Start plan generation for analysis DataCorruption...
2022-09-21 23:12:49 INFO  ---RUNTIME: Plan generation took 0.4253387451171875 ms
2022-09-21 23:12:49 INFO  Estimated runtime of original DAG is 6347.0799922943115ms
2022-09-21 23:12:49 INFO  Performing Multi-Query Optimization
2022-09-21 23:12:49 INFO  Estimated unoptimized what-if runtime is 158676.9998073578ms
2022-09-21 23:12:49 INFO  Estimated optimised what-if runtime is 14657.097816467285ms
2022-09-21 23:12:49 INFO  Estimated optimisation runtime saving is 144019.9019908905ms
2022-09-21 23:12:49 INFO  ---RUNTIME: Multi-Query Optimization took 64.49007987976074 ms
2022-09-21 23:12:49 INFO  Executing generated plans
2022-09-21 23:13:10 INFO  ---RUNTIME: Execution took 20864.498376846313 ms
2022-09-21 23:13:10 INFO  Done!
2022-09-21 23:13:10 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-21 23:13:10 INFO  Running instrumented original pipeline...
2022-09-21 23:13:10 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-21 23:13:10 INFO  ---RUNTIME: Importing and monkey-patching took 6.352901458740234 ms
2022-09-21 23:13:18 INFO  ---RUNTIME: Original pipeline execution took 8122.63560295105 ms (excluding imports and monkey-patching)
2022-09-21 23:13:18 INFO  Starting execution of 1 what-if analyses...
2022-09-21 23:13:18 INFO  Start plan generation for analysis DataCorruption...
2022-09-21 23:13:18 INFO  ---RUNTIME: Plan generation took 0.4191398620605469 ms
2022-09-21 23:13:18 INFO  Estimated runtime of original DAG is 6333.826065063477ms
2022-09-21 23:13:18 WARNING Skipping Multi-Query Optimization (instead, only applying patches)
2022-09-21 23:13:18 INFO  Estimated unoptimised what-if runtime is 158345.6516265869ms
2022-09-21 23:13:18 INFO  ---RUNTIME: Multi-Query Optimization took 18.8140869140625 ms
2022-09-21 23:13:18 INFO  Executing generated plans
2022-09-21 23:16:36 INFO  ---RUNTIME: Execution took 197839.90359306335 ms
2022-09-21 23:16:36 INFO  Done!
2022-09-21 23:16:36 INFO  # Finished -- repetition 7 of 7 
2022-09-21 23:16:36 INFO  # Final results after all repetitions
2022-09-21 23:16:36 INFO     repetition  ... no_opt_what_if_execution_combined_model_training
0           0  ...                                     19560.270548
1           1  ...                                     26314.354181
2           2  ...                                     31662.617683
3           3  ...                                     19831.169844
4           4  ...                                     24827.849627
5           5  ...                                     27782.683134
6           6  ...                                     26867.645502

[7 rows x 26 columns]
taskset -c 32-39 PROTOCOL_BUFFERS_PYTHON_IMPLEMENTATION=python python3.9 benchmarks_end_to_end.py data_corruption reviews slow_loading featurization_0 neural_network
2022-09-21 23:16:38.519418: W tensorflow/stream_executor/platform/default/dso_loader.cc:64] Could not load dynamic library 'libcudart.so.11.0'; dlerror: libcudart.so.11.0: cannot open shared object file: No such file or directory; LD_LIBRARY_PATH: /home/sgrafbe/mlwhatif/venv/lib/python3.9/site-packages/cv2/../../lib64:
2022-09-21 23:16:38.519463: I tensorflow/stream_executor/cuda/cudart_stub.cc:29] Ignore above cudart dlerror if you do not have a GPU set up on your machine.
2022-09-21 23:16:39 INFO  Patching sys.argv with ['mlwhatif', 'reviews', 'slow_loading', 'featurization_0', 'neural_network']
2022-09-21 23:16:39 INFO  Running instrumented original pipeline...
2022-09-21 23:16:39 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-21 23:16:39 INFO  ---RUNTIME: Importing and monkey-patching took 96.21143341064453 ms
2022-09-21 23:16:45.549681: W tensorflow/stream_executor/platform/default/dso_loader.cc:64] Could not load dynamic library 'libcuda.so.1'; dlerror: libcuda.so.1: cannot open shared object file: No such file or directory; LD_LIBRARY_PATH: /home/sgrafbe/mlwhatif/venv/lib/python3.9/site-packages/cv2/../../lib64:
2022-09-21 23:16:45.549734: W tensorflow/stream_executor/cuda/cuda_driver.cc:326] failed call to cuInit: UNKNOWN ERROR (303)
2022-09-21 23:16:45.549764: I tensorflow/stream_executor/cuda/cuda_diagnostics.cc:156] kernel driver does not appear to be running on this host (wagyu): /proc/driver/nvidia/version does not exist
2022-09-21 23:16:45.550306: I tensorflow/core/platform/cpu_feature_guard.cc:142] This TensorFlow binary is optimized with oneAPI Deep Neural Network Library (oneDNN) to use the following CPU instructions in performance-critical operations:  AVX2 FMA
To enable them in other operations, rebuild TensorFlow with the appropriate compiler flags.
2022-09-21 23:16:45.632077: I tensorflow/compiler/mlir/mlir_graph_optimization_pass.cc:176] None of the MLIR Optimization Passes are enabled (registered 2)
2022-09-21 23:16:45.644389: I tensorflow/core/platform/profile_utils/cpu_utils.cc:114] CPU Frequency: 2595290000 Hz
2022-09-21 23:16:50 INFO  ---RUNTIME: Original pipeline execution took 11010.706663131714 ms (excluding imports and monkey-patching)
2022-09-21 23:16:50 INFO  Starting execution of 0 what-if analyses...
2022-09-21 23:16:50 INFO  Estimated runtime of original DAG is 9253.192663192749ms
2022-09-21 23:16:50 INFO  Performing Multi-Query Optimization
2022-09-21 23:16:50 INFO  Estimated unoptimized what-if runtime is 0ms
2022-09-21 23:16:50 INFO  Estimated optimised what-if runtime is 0ms
2022-09-21 23:16:50 INFO  Estimated optimisation runtime saving is 0ms
2022-09-21 23:16:50 INFO  ---RUNTIME: Multi-Query Optimization took 0.5102157592773438 ms
2022-09-21 23:16:50 INFO  Executing generated plans
2022-09-21 23:16:50 INFO  ---RUNTIME: Execution took 0.020265579223632812 ms
2022-09-21 23:16:50 INFO  Done!
2022-09-21 23:16:50 INFO  # Optimization benchmark for data_corruption with args [['reviews', 'slow_loading', 'featurization_0', 'neural_network']] -- repetition 1 of 7
2022-09-21 23:16:50 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-21 23:16:50 INFO  Running instrumented original pipeline...
2022-09-21 23:16:50 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-21 23:16:50 INFO  ---RUNTIME: Importing and monkey-patching took 5.870819091796875 ms
2022-09-21 23:17:01 INFO  ---RUNTIME: Original pipeline execution took 10749.570608139038 ms (excluding imports and monkey-patching)
2022-09-21 23:17:01 INFO  Starting execution of 1 what-if analyses...
2022-09-21 23:17:01 INFO  Start plan generation for analysis DataCorruption...
2022-09-21 23:17:01 INFO  ---RUNTIME: Plan generation took 0.44155120849609375 ms
2022-09-21 23:17:01 INFO  Estimated runtime of original DAG is 9133.0246925354ms
2022-09-21 23:17:01 INFO  Performing Multi-Query Optimization
2022-09-21 23:17:01 INFO  Estimated unoptimized what-if runtime is 228325.617313385ms
2022-09-21 23:17:01 INFO  Estimated optimised what-if runtime is 25306.33044242859ms
2022-09-21 23:17:01 INFO  Estimated optimisation runtime saving is 203019.28687095642ms
2022-09-21 23:17:01 INFO  ---RUNTIME: Multi-Query Optimization took 61.267852783203125 ms
2022-09-21 23:17:01 INFO  Executing generated plans
2022-09-21 23:17:32 INFO  ---RUNTIME: Execution took 30724.647760391235 ms
2022-09-21 23:17:32 INFO  Done!
2022-09-21 23:17:32 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-21 23:17:32 INFO  Running instrumented original pipeline...
2022-09-21 23:17:32 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-21 23:17:32 INFO  ---RUNTIME: Importing and monkey-patching took 5.93113899230957 ms
2022-09-21 23:17:43 INFO  ---RUNTIME: Original pipeline execution took 10602.250099182129 ms (excluding imports and monkey-patching)
2022-09-21 23:17:43 INFO  Starting execution of 1 what-if analyses...
2022-09-21 23:17:43 INFO  Start plan generation for analysis DataCorruption...
2022-09-21 23:17:43 INFO  ---RUNTIME: Plan generation took 0.42748451232910156 ms
2022-09-21 23:17:43 INFO  Estimated runtime of original DAG is 8770.949125289917ms
2022-09-21 23:17:43 WARNING Skipping Multi-Query Optimization (instead, only applying patches)
2022-09-21 23:17:43 INFO  Estimated unoptimised what-if runtime is 219273.72813224792ms
2022-09-21 23:17:43 INFO  ---RUNTIME: Multi-Query Optimization took 18.08905601501465 ms
2022-09-21 23:17:43 INFO  Executing generated plans
2022-09-21 23:22:09 INFO  ---RUNTIME: Execution took 266234.8918914795 ms
2022-09-21 23:22:09 INFO  Done!
2022-09-21 23:22:09 INFO  # Finished -- repetition 1 of 7 
2022-09-21 23:22:09 INFO  # Optimization benchmark for data_corruption with args [['reviews', 'slow_loading', 'featurization_0', 'neural_network']] -- repetition 2 of 7
2022-09-21 23:22:09 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-21 23:22:09 INFO  Running instrumented original pipeline...
2022-09-21 23:22:09 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-21 23:22:09 INFO  ---RUNTIME: Importing and monkey-patching took 5.96165657043457 ms
2022-09-21 23:22:19 INFO  ---RUNTIME: Original pipeline execution took 10640.05160331726 ms (excluding imports and monkey-patching)
2022-09-21 23:22:19 INFO  Starting execution of 1 what-if analyses...
2022-09-21 23:22:19 INFO  Start plan generation for analysis DataCorruption...
2022-09-21 23:22:19 INFO  ---RUNTIME: Plan generation took 0.4076957702636719 ms
2022-09-21 23:22:19 INFO  Estimated runtime of original DAG is 8905.64489364624ms
2022-09-21 23:22:19 INFO  Performing Multi-Query Optimization
2022-09-21 23:22:19 INFO  Estimated unoptimized what-if runtime is 222641.122341156ms
2022-09-21 23:22:19 INFO  Estimated optimised what-if runtime is 24912.36925125122ms
2022-09-21 23:22:19 INFO  Estimated optimisation runtime saving is 197728.75308990479ms
2022-09-21 23:22:19 INFO  ---RUNTIME: Multi-Query Optimization took 59.304237365722656 ms
2022-09-21 23:22:19 INFO  Executing generated plans
2022-09-21 23:22:51 INFO  ---RUNTIME: Execution took 31086.797952651978 ms
2022-09-21 23:22:51 INFO  Done!
2022-09-21 23:22:51 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-21 23:22:51 INFO  Running instrumented original pipeline...
2022-09-21 23:22:51 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-21 23:22:51 INFO  ---RUNTIME: Importing and monkey-patching took 5.96165657043457 ms
2022-09-21 23:23:01 INFO  ---RUNTIME: Original pipeline execution took 10690.296411514282 ms (excluding imports and monkey-patching)
2022-09-21 23:23:01 INFO  Starting execution of 1 what-if analyses...
2022-09-21 23:23:01 INFO  Start plan generation for analysis DataCorruption...
2022-09-21 23:23:01 INFO  ---RUNTIME: Plan generation took 0.40984153747558594 ms
2022-09-21 23:23:01 INFO  Estimated runtime of original DAG is 8768.780708312988ms
2022-09-21 23:23:01 WARNING Skipping Multi-Query Optimization (instead, only applying patches)
2022-09-21 23:23:01 INFO  Estimated unoptimised what-if runtime is 219219.5177078247ms
2022-09-21 23:23:01 INFO  ---RUNTIME: Multi-Query Optimization took 17.876625061035156 ms
2022-09-21 23:23:01 INFO  Executing generated plans
2022-09-21 23:27:26 INFO  ---RUNTIME: Execution took 264878.3104419708 ms
2022-09-21 23:27:26 INFO  Done!
2022-09-21 23:27:26 INFO  # Finished -- repetition 2 of 7 
2022-09-21 23:27:26 INFO  # Optimization benchmark for data_corruption with args [['reviews', 'slow_loading', 'featurization_0', 'neural_network']] -- repetition 3 of 7
2022-09-21 23:27:26 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-21 23:27:26 INFO  Running instrumented original pipeline...
2022-09-21 23:27:26 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-21 23:27:26 INFO  ---RUNTIME: Importing and monkey-patching took 6.7081451416015625 ms
2022-09-21 23:27:37 INFO  ---RUNTIME: Original pipeline execution took 10458.072423934937 ms (excluding imports and monkey-patching)
2022-09-21 23:27:37 INFO  Starting execution of 1 what-if analyses...
2022-09-21 23:27:37 INFO  Start plan generation for analysis DataCorruption...
2022-09-21 23:27:37 INFO  ---RUNTIME: Plan generation took 2.285480499267578 ms
2022-09-21 23:27:37 INFO  Estimated runtime of original DAG is 8817.87085533142ms
2022-09-21 23:27:37 INFO  Performing Multi-Query Optimization
2022-09-21 23:27:37 INFO  Estimated unoptimized what-if runtime is 220446.77138328552ms
2022-09-21 23:27:37 INFO  Estimated optimised what-if runtime is 26114.88103866577ms
2022-09-21 23:27:37 INFO  Estimated optimisation runtime saving is 194331.89034461975ms
2022-09-21 23:27:37 INFO  ---RUNTIME: Multi-Query Optimization took 428.70187759399414 ms
2022-09-21 23:27:37 INFO  Executing generated plans
2022-09-21 23:28:09 INFO  ---RUNTIME: Execution took 31552.892446517944 ms
2022-09-21 23:28:09 INFO  Done!
2022-09-21 23:28:09 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-21 23:28:09 INFO  Running instrumented original pipeline...
2022-09-21 23:28:09 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-21 23:28:09 INFO  ---RUNTIME: Importing and monkey-patching took 6.732940673828125 ms
2022-09-21 23:28:19 INFO  ---RUNTIME: Original pipeline execution took 10453.214883804321 ms (excluding imports and monkey-patching)
2022-09-21 23:28:19 INFO  Starting execution of 1 what-if analyses...
2022-09-21 23:28:19 INFO  Start plan generation for analysis DataCorruption...
2022-09-21 23:28:19 INFO  ---RUNTIME: Plan generation took 0.42057037353515625 ms
2022-09-21 23:28:19 INFO  Estimated runtime of original DAG is 8799.542427062988ms
2022-09-21 23:28:19 WARNING Skipping Multi-Query Optimization (instead, only applying patches)
2022-09-21 23:28:19 INFO  Estimated unoptimised what-if runtime is 219988.5606765747ms
2022-09-21 23:28:19 INFO  ---RUNTIME: Multi-Query Optimization took 17.653465270996094 ms
2022-09-21 23:28:19 INFO  Executing generated plans
2022-09-21 23:32:46 INFO  ---RUNTIME: Execution took 267320.41811943054 ms
2022-09-21 23:32:46 INFO  Done!
2022-09-21 23:32:46 INFO  # Finished -- repetition 3 of 7 
2022-09-21 23:32:46 INFO  # Optimization benchmark for data_corruption with args [['reviews', 'slow_loading', 'featurization_0', 'neural_network']] -- repetition 4 of 7
2022-09-21 23:32:46 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-21 23:32:46 INFO  Running instrumented original pipeline...
2022-09-21 23:32:46 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-21 23:32:46 INFO  ---RUNTIME: Importing and monkey-patching took 6.29425048828125 ms
2022-09-21 23:32:57 INFO  ---RUNTIME: Original pipeline execution took 10811.291456222534 ms (excluding imports and monkey-patching)
2022-09-21 23:32:57 INFO  Starting execution of 1 what-if analyses...
2022-09-21 23:32:57 INFO  Start plan generation for analysis DataCorruption...
2022-09-21 23:32:57 INFO  ---RUNTIME: Plan generation took 0.4131793975830078 ms
2022-09-21 23:32:57 INFO  Estimated runtime of original DAG is 9168.854713439941ms
2022-09-21 23:32:57 INFO  Performing Multi-Query Optimization
2022-09-21 23:32:57 INFO  Estimated unoptimized what-if runtime is 229221.36783599854ms
2022-09-21 23:32:57 INFO  Estimated optimised what-if runtime is 24944.849491119385ms
2022-09-21 23:32:57 INFO  Estimated optimisation runtime saving is 204276.51834487915ms
2022-09-21 23:32:57 INFO  ---RUNTIME: Multi-Query Optimization took 59.964895248413086 ms
2022-09-21 23:32:57 INFO  Executing generated plans
2022-09-21 23:33:28 INFO  ---RUNTIME: Execution took 31118.82996559143 ms
2022-09-21 23:33:28 INFO  Done!
2022-09-21 23:33:28 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-21 23:33:28 INFO  Running instrumented original pipeline...
2022-09-21 23:33:28 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-21 23:33:29 INFO  ---RUNTIME: Importing and monkey-patching took 6.035804748535156 ms
2022-09-21 23:33:39 INFO  ---RUNTIME: Original pipeline execution took 10307.238578796387 ms (excluding imports and monkey-patching)
2022-09-21 23:33:39 INFO  Starting execution of 1 what-if analyses...
2022-09-21 23:33:39 INFO  Start plan generation for analysis DataCorruption...
2022-09-21 23:33:39 INFO  ---RUNTIME: Plan generation took 0.39267539978027344 ms
2022-09-21 23:33:39 INFO  Estimated runtime of original DAG is 8680.4940700531ms
2022-09-21 23:33:39 WARNING Skipping Multi-Query Optimization (instead, only applying patches)
2022-09-21 23:33:39 INFO  Estimated unoptimised what-if runtime is 217012.35175132751ms
2022-09-21 23:33:39 INFO  ---RUNTIME: Multi-Query Optimization took 17.98272132873535 ms
2022-09-21 23:33:39 INFO  Executing generated plans
2022-09-21 23:37:55 INFO  ---RUNTIME: Execution took 255970.59965133667 ms
2022-09-21 23:37:55 INFO  Done!
2022-09-21 23:37:55 INFO  # Finished -- repetition 4 of 7 
2022-09-21 23:37:55 INFO  # Optimization benchmark for data_corruption with args [['reviews', 'slow_loading', 'featurization_0', 'neural_network']] -- repetition 5 of 7
2022-09-21 23:37:55 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-21 23:37:55 INFO  Running instrumented original pipeline...
2022-09-21 23:37:55 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-21 23:37:55 INFO  ---RUNTIME: Importing and monkey-patching took 6.010532379150391 ms
2022-09-21 23:38:05 INFO  ---RUNTIME: Original pipeline execution took 10511.492729187012 ms (excluding imports and monkey-patching)
2022-09-21 23:38:05 INFO  Starting execution of 1 what-if analyses...
2022-09-21 23:38:05 INFO  Start plan generation for analysis DataCorruption...
2022-09-21 23:38:05 INFO  ---RUNTIME: Plan generation took 0.46706199645996094 ms
2022-09-21 23:38:05 INFO  Estimated runtime of original DAG is 8831.313371658325ms
2022-09-21 23:38:05 INFO  Performing Multi-Query Optimization
2022-09-21 23:38:05 INFO  Estimated unoptimized what-if runtime is 220782.83429145813ms
2022-09-21 23:38:05 INFO  Estimated optimised what-if runtime is 24727.964401245117ms
2022-09-21 23:38:05 INFO  Estimated optimisation runtime saving is 196054.869890213ms
2022-09-21 23:38:05 INFO  ---RUNTIME: Multi-Query Optimization took 59.33213233947754 ms
2022-09-21 23:38:05 INFO  Executing generated plans
2022-09-21 23:38:35 INFO  ---RUNTIME: Execution took 30119.90451812744 ms
2022-09-21 23:38:35 INFO  Done!
2022-09-21 23:38:35 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-21 23:38:35 INFO  Running instrumented original pipeline...
2022-09-21 23:38:36 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-21 23:38:36 INFO  ---RUNTIME: Importing and monkey-patching took 8.694171905517578 ms
2022-09-21 23:38:47 INFO  ---RUNTIME: Original pipeline execution took 11063.019514083862 ms (excluding imports and monkey-patching)
2022-09-21 23:38:47 INFO  Starting execution of 1 what-if analyses...
2022-09-21 23:38:47 INFO  Start plan generation for analysis DataCorruption...
2022-09-21 23:38:47 INFO  ---RUNTIME: Plan generation took 0.40841102600097656 ms
2022-09-21 23:38:47 INFO  Estimated runtime of original DAG is 9420.28021812439ms
2022-09-21 23:38:47 WARNING Skipping Multi-Query Optimization (instead, only applying patches)
2022-09-21 23:38:47 INFO  Estimated unoptimised what-if runtime is 235507.00545310974ms
2022-09-21 23:38:47 INFO  ---RUNTIME: Multi-Query Optimization took 17.426729202270508 ms
2022-09-21 23:38:47 INFO  Executing generated plans
2022-09-21 23:43:02 INFO  ---RUNTIME: Execution took 255410.10546684265 ms
2022-09-21 23:43:02 INFO  Done!
2022-09-21 23:43:02 INFO  # Finished -- repetition 5 of 7 
2022-09-21 23:43:02 INFO  # Optimization benchmark for data_corruption with args [['reviews', 'slow_loading', 'featurization_0', 'neural_network']] -- repetition 6 of 7
2022-09-21 23:43:02 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-21 23:43:02 INFO  Running instrumented original pipeline...
2022-09-21 23:43:02 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-21 23:43:02 INFO  ---RUNTIME: Importing and monkey-patching took 6.117105484008789 ms
2022-09-21 23:43:12 INFO  ---RUNTIME: Original pipeline execution took 10424.981594085693 ms (excluding imports and monkey-patching)
2022-09-21 23:43:12 INFO  Starting execution of 1 what-if analyses...
2022-09-21 23:43:12 INFO  Start plan generation for analysis DataCorruption...
2022-09-21 23:43:12 INFO  ---RUNTIME: Plan generation took 2.263784408569336 ms
2022-09-21 23:43:12 INFO  Estimated runtime of original DAG is 8728.805303573608ms
2022-09-21 23:43:12 INFO  Performing Multi-Query Optimization
2022-09-21 23:43:12 INFO  Estimated unoptimized what-if runtime is 218220.1325893402ms
2022-09-21 23:43:12 INFO  Estimated optimised what-if runtime is 24387.3074054718ms
2022-09-21 23:43:12 INFO  Estimated optimisation runtime saving is 193832.8251838684ms
2022-09-21 23:43:12 INFO  ---RUNTIME: Multi-Query Optimization took 58.478355407714844 ms
2022-09-21 23:43:12 INFO  Executing generated plans
2022-09-21 23:43:43 INFO  ---RUNTIME: Execution took 30046.675443649292 ms
2022-09-21 23:43:43 INFO  Done!
2022-09-21 23:43:43 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-21 23:43:43 INFO  Running instrumented original pipeline...
2022-09-21 23:43:43 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-21 23:43:43 INFO  ---RUNTIME: Importing and monkey-patching took 5.924463272094727 ms
2022-09-21 23:43:53 INFO  ---RUNTIME: Original pipeline execution took 10778.892278671265 ms (excluding imports and monkey-patching)
2022-09-21 23:43:53 INFO  Starting execution of 1 what-if analyses...
2022-09-21 23:43:53 INFO  Start plan generation for analysis DataCorruption...
2022-09-21 23:43:53 INFO  ---RUNTIME: Plan generation took 2.035379409790039 ms
2022-09-21 23:43:53 INFO  Estimated runtime of original DAG is 9133.221864700317ms
2022-09-21 23:43:53 WARNING Skipping Multi-Query Optimization (instead, only applying patches)
2022-09-21 23:43:53 INFO  Estimated unoptimised what-if runtime is 228330.54661750793ms
2022-09-21 23:43:53 INFO  ---RUNTIME: Multi-Query Optimization took 17.111539840698242 ms
2022-09-21 23:43:53 INFO  Executing generated plans
2022-09-21 23:48:08 INFO  ---RUNTIME: Execution took 254506.45399093628 ms
2022-09-21 23:48:08 INFO  Done!
2022-09-21 23:48:08 INFO  # Finished -- repetition 6 of 7 
2022-09-21 23:48:08 INFO  # Optimization benchmark for data_corruption with args [['reviews', 'slow_loading', 'featurization_0', 'neural_network']] -- repetition 7 of 7
2022-09-21 23:48:08 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-21 23:48:08 INFO  Running instrumented original pipeline...
2022-09-21 23:48:08 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-21 23:48:08 INFO  ---RUNTIME: Importing and monkey-patching took 5.970001220703125 ms
2022-09-21 23:48:18 INFO  ---RUNTIME: Original pipeline execution took 10401.264667510986 ms (excluding imports and monkey-patching)
2022-09-21 23:48:18 INFO  Starting execution of 1 what-if analyses...
2022-09-21 23:48:18 INFO  Start plan generation for analysis DataCorruption...
2022-09-21 23:48:18 INFO  ---RUNTIME: Plan generation took 0.4229545593261719 ms
2022-09-21 23:48:18 INFO  Estimated runtime of original DAG is 8750.895738601685ms
2022-09-21 23:48:18 INFO  Performing Multi-Query Optimization
2022-09-21 23:48:18 INFO  Estimated unoptimized what-if runtime is 218772.3934650421ms
2022-09-21 23:48:18 INFO  Estimated optimised what-if runtime is 24869.112968444824ms
2022-09-21 23:48:18 INFO  Estimated optimisation runtime saving is 193903.2804965973ms
2022-09-21 23:48:18 INFO  ---RUNTIME: Multi-Query Optimization took 59.94844436645508 ms
2022-09-21 23:48:18 INFO  Executing generated plans
2022-09-21 23:48:48 INFO  ---RUNTIME: Execution took 30133.110284805298 ms
2022-09-21 23:48:48 INFO  Done!
2022-09-21 23:48:48 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-21 23:48:48 INFO  Running instrumented original pipeline...
2022-09-21 23:48:48 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-21 23:48:48 INFO  ---RUNTIME: Importing and monkey-patching took 6.133556365966797 ms
2022-09-21 23:48:59 INFO  ---RUNTIME: Original pipeline execution took 10356.426000595093 ms (excluding imports and monkey-patching)
2022-09-21 23:48:59 INFO  Starting execution of 1 what-if analyses...
2022-09-21 23:48:59 INFO  Start plan generation for analysis DataCorruption...
2022-09-21 23:48:59 INFO  ---RUNTIME: Plan generation took 0.4012584686279297 ms
2022-09-21 23:48:59 INFO  Estimated runtime of original DAG is 8739.69030380249ms
2022-09-21 23:48:59 WARNING Skipping Multi-Query Optimization (instead, only applying patches)
2022-09-21 23:48:59 INFO  Estimated unoptimised what-if runtime is 218492.25759506226ms
2022-09-21 23:48:59 INFO  ---RUNTIME: Multi-Query Optimization took 17.795085906982422 ms
2022-09-21 23:48:59 INFO  Executing generated plans
2022-09-21 23:53:14 INFO  ---RUNTIME: Execution took 254881.986618042 ms
2022-09-21 23:53:14 INFO  Done!
2022-09-21 23:53:14 INFO  # Finished -- repetition 7 of 7 
2022-09-21 23:53:14 INFO  # Final results after all repetitions
2022-09-21 23:53:14 INFO     repetition  ... no_opt_what_if_execution_combined_model_training
0           0  ...                                     87973.583937
1           1  ...                                     86058.814287
2           2  ...                                     86456.498146
3           3  ...                                     81254.932404
4           4  ...                                     80469.490051
5           5  ...                                     80170.458078
6           6  ...                                     80340.396881

[7 rows x 26 columns]
taskset -c 32-39 PROTOCOL_BUFFERS_PYTHON_IMPLEMENTATION=python python3.9 benchmarks_end_to_end.py data_corruption reviews slow_loading featurization_1 logistic_regression
2022-09-21 23:53:16.692657: W tensorflow/stream_executor/platform/default/dso_loader.cc:64] Could not load dynamic library 'libcudart.so.11.0'; dlerror: libcudart.so.11.0: cannot open shared object file: No such file or directory; LD_LIBRARY_PATH: /home/sgrafbe/mlwhatif/venv/lib/python3.9/site-packages/cv2/../../lib64:
2022-09-21 23:53:16.692701: I tensorflow/stream_executor/cuda/cudart_stub.cc:29] Ignore above cudart dlerror if you do not have a GPU set up on your machine.
2022-09-21 23:53:17 INFO  Patching sys.argv with ['mlwhatif', 'reviews', 'slow_loading', 'featurization_1', 'logistic_regression']
2022-09-21 23:53:17 INFO  Running instrumented original pipeline...
2022-09-21 23:53:17 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-21 23:53:18 INFO  ---RUNTIME: Importing and monkey-patching took 95.91794013977051 ms
2022-09-21 23:53:25 INFO  ---RUNTIME: Original pipeline execution took 7730.593681335449 ms (excluding imports and monkey-patching)
2022-09-21 23:53:25 INFO  Starting execution of 0 what-if analyses...
2022-09-21 23:53:25 INFO  Estimated runtime of original DAG is 5494.531631469727ms
2022-09-21 23:53:25 INFO  Performing Multi-Query Optimization
2022-09-21 23:53:25 INFO  Estimated unoptimized what-if runtime is 0ms
2022-09-21 23:53:25 INFO  Estimated optimised what-if runtime is 0ms
2022-09-21 23:53:25 INFO  Estimated optimisation runtime saving is 0ms
2022-09-21 23:53:25 INFO  ---RUNTIME: Multi-Query Optimization took 0.5083084106445312 ms
2022-09-21 23:53:25 INFO  Executing generated plans
2022-09-21 23:53:25 INFO  ---RUNTIME: Execution took 0.023603439331054688 ms
2022-09-21 23:53:25 INFO  Done!
2022-09-21 23:53:25 INFO  # Optimization benchmark for data_corruption with args [['reviews', 'slow_loading', 'featurization_1', 'logistic_regression']] -- repetition 1 of 7
2022-09-21 23:53:25 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-21 23:53:25 INFO  Running instrumented original pipeline...
2022-09-21 23:53:25 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-21 23:53:25 INFO  ---RUNTIME: Importing and monkey-patching took 5.606889724731445 ms
2022-09-21 23:53:33 INFO  ---RUNTIME: Original pipeline execution took 7679.121017456055 ms (excluding imports and monkey-patching)
2022-09-21 23:53:33 INFO  Starting execution of 1 what-if analyses...
2022-09-21 23:53:33 INFO  Start plan generation for analysis DataCorruption...
2022-09-21 23:53:33 INFO  ---RUNTIME: Plan generation took 0.5271434783935547 ms
2022-09-21 23:53:33 INFO  Estimated runtime of original DAG is 5471.464395523071ms
2022-09-21 23:53:33 INFO  Performing Multi-Query Optimization
2022-09-21 23:53:33 INFO  Estimated unoptimized what-if runtime is 136786.60988807678ms
2022-09-21 23:53:33 INFO  Estimated optimised what-if runtime is 12369.062662124634ms
2022-09-21 23:53:33 INFO  Estimated optimisation runtime saving is 124417.54722595215ms
2022-09-21 23:53:33 INFO  ---RUNTIME: Multi-Query Optimization took 63.45534324645996 ms
2022-09-21 23:53:33 INFO  Executing generated plans
2022-09-21 23:53:51 INFO  ---RUNTIME: Execution took 18281.173944473267 ms
2022-09-21 23:53:51 INFO  Done!
2022-09-21 23:53:51 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-21 23:53:51 INFO  Running instrumented original pipeline...
2022-09-21 23:53:51 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-21 23:53:51 INFO  ---RUNTIME: Importing and monkey-patching took 5.83648681640625 ms
2022-09-21 23:53:59 INFO  ---RUNTIME: Original pipeline execution took 7773.791551589966 ms (excluding imports and monkey-patching)
2022-09-21 23:53:59 INFO  Starting execution of 1 what-if analyses...
2022-09-21 23:53:59 INFO  Start plan generation for analysis DataCorruption...
2022-09-21 23:53:59 INFO  ---RUNTIME: Plan generation took 0.5288124084472656 ms
2022-09-21 23:53:59 INFO  Estimated runtime of original DAG is 5413.274765014648ms
2022-09-21 23:53:59 WARNING Skipping Multi-Query Optimization (instead, only applying patches)
2022-09-21 23:53:59 INFO  Estimated unoptimised what-if runtime is 135331.8691253662ms
2022-09-21 23:53:59 INFO  ---RUNTIME: Multi-Query Optimization took 18.827199935913086 ms
2022-09-21 23:53:59 INFO  Executing generated plans
2022-09-21 23:57:00 INFO  ---RUNTIME: Execution took 180455.46555519104 ms
2022-09-21 23:57:00 INFO  Done!
2022-09-21 23:57:00 INFO  # Finished -- repetition 1 of 7 
2022-09-21 23:57:00 INFO  # Optimization benchmark for data_corruption with args [['reviews', 'slow_loading', 'featurization_1', 'logistic_regression']] -- repetition 2 of 7
2022-09-21 23:57:00 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-21 23:57:00 INFO  Running instrumented original pipeline...
2022-09-21 23:57:00 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-21 23:57:00 INFO  ---RUNTIME: Importing and monkey-patching took 6.182193756103516 ms
2022-09-21 23:57:07 INFO  ---RUNTIME: Original pipeline execution took 7877.669334411621 ms (excluding imports and monkey-patching)
2022-09-21 23:57:07 INFO  Starting execution of 1 what-if analyses...
2022-09-21 23:57:07 INFO  Start plan generation for analysis DataCorruption...
2022-09-21 23:57:07 INFO  ---RUNTIME: Plan generation took 0.5526542663574219 ms
2022-09-21 23:57:07 INFO  Estimated runtime of original DAG is 5438.369512557983ms
2022-09-21 23:57:07 INFO  Performing Multi-Query Optimization
2022-09-21 23:57:07 INFO  Estimated unoptimized what-if runtime is 135959.23781394958ms
2022-09-21 23:57:07 INFO  Estimated optimised what-if runtime is 12384.688377380371ms
2022-09-21 23:57:07 INFO  Estimated optimisation runtime saving is 123574.54943656921ms
2022-09-21 23:57:07 INFO  ---RUNTIME: Multi-Query Optimization took 62.89505958557129 ms
2022-09-21 23:57:07 INFO  Executing generated plans
2022-09-21 23:57:27 INFO  ---RUNTIME: Execution took 19177.107334136963 ms
2022-09-21 23:57:27 INFO  Done!
2022-09-21 23:57:27 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-21 23:57:27 INFO  Running instrumented original pipeline...
2022-09-21 23:57:27 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-21 23:57:27 INFO  ---RUNTIME: Importing and monkey-patching took 6.222724914550781 ms
2022-09-21 23:57:34 INFO  ---RUNTIME: Original pipeline execution took 7818.695783615112 ms (excluding imports and monkey-patching)
2022-09-21 23:57:34 INFO  Starting execution of 1 what-if analyses...
2022-09-21 23:57:34 INFO  Start plan generation for analysis DataCorruption...
2022-09-21 23:57:34 INFO  ---RUNTIME: Plan generation took 0.5304813385009766 ms
2022-09-21 23:57:34 INFO  Estimated runtime of original DAG is 5624.094247817993ms
2022-09-21 23:57:34 WARNING Skipping Multi-Query Optimization (instead, only applying patches)
2022-09-21 23:57:35 INFO  Estimated unoptimised what-if runtime is 140602.35619544983ms
2022-09-21 23:57:35 INFO  ---RUNTIME: Multi-Query Optimization took 18.556833267211914 ms
2022-09-21 23:57:35 INFO  Executing generated plans
2022-09-22 00:00:35 INFO  ---RUNTIME: Execution took 180176.88536643982 ms
2022-09-22 00:00:35 INFO  Done!
2022-09-22 00:00:35 INFO  # Finished -- repetition 2 of 7 
2022-09-22 00:00:35 INFO  # Optimization benchmark for data_corruption with args [['reviews', 'slow_loading', 'featurization_1', 'logistic_regression']] -- repetition 3 of 7
2022-09-22 00:00:35 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-22 00:00:35 INFO  Running instrumented original pipeline...
2022-09-22 00:00:35 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-22 00:00:35 INFO  ---RUNTIME: Importing and monkey-patching took 8.737802505493164 ms
2022-09-22 00:00:43 INFO  ---RUNTIME: Original pipeline execution took 7909.656047821045 ms (excluding imports and monkey-patching)
2022-09-22 00:00:43 INFO  Starting execution of 1 what-if analyses...
2022-09-22 00:00:43 INFO  Start plan generation for analysis DataCorruption...
2022-09-22 00:00:43 INFO  ---RUNTIME: Plan generation took 0.4978179931640625 ms
2022-09-22 00:00:43 INFO  Estimated runtime of original DAG is 5688.273668289185ms
2022-09-22 00:00:43 INFO  Performing Multi-Query Optimization
2022-09-22 00:00:43 INFO  Estimated unoptimized what-if runtime is 142206.8417072296ms
2022-09-22 00:00:43 INFO  Estimated optimised what-if runtime is 13786.921739578247ms
2022-09-22 00:00:43 INFO  Estimated optimisation runtime saving is 128419.91996765137ms
2022-09-22 00:00:43 INFO  ---RUNTIME: Multi-Query Optimization took 63.374996185302734 ms
2022-09-22 00:00:43 INFO  Executing generated plans
2022-09-22 00:01:02 INFO  ---RUNTIME: Execution took 19139.31155204773 ms
2022-09-22 00:01:02 INFO  Done!
2022-09-22 00:01:02 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-22 00:01:02 INFO  Running instrumented original pipeline...
2022-09-22 00:01:02 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-22 00:01:02 INFO  ---RUNTIME: Importing and monkey-patching took 6.325483322143555 ms
2022-09-22 00:01:10 INFO  ---RUNTIME: Original pipeline execution took 7804.63719367981 ms (excluding imports and monkey-patching)
2022-09-22 00:01:10 INFO  Starting execution of 1 what-if analyses...
2022-09-22 00:01:10 INFO  Start plan generation for analysis DataCorruption...
2022-09-22 00:01:10 INFO  ---RUNTIME: Plan generation took 0.5335807800292969 ms
2022-09-22 00:01:10 INFO  Estimated runtime of original DAG is 5616.99104309082ms
2022-09-22 00:01:10 WARNING Skipping Multi-Query Optimization (instead, only applying patches)
2022-09-22 00:01:10 INFO  Estimated unoptimised what-if runtime is 140424.7760772705ms
2022-09-22 00:01:10 INFO  ---RUNTIME: Multi-Query Optimization took 224.69019889831543 ms
2022-09-22 00:01:10 INFO  Executing generated plans
2022-09-22 00:04:12 INFO  ---RUNTIME: Execution took 181747.48373031616 ms
2022-09-22 00:04:12 INFO  Done!
2022-09-22 00:04:12 INFO  # Finished -- repetition 3 of 7 
2022-09-22 00:04:12 INFO  # Optimization benchmark for data_corruption with args [['reviews', 'slow_loading', 'featurization_1', 'logistic_regression']] -- repetition 4 of 7
2022-09-22 00:04:12 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-22 00:04:12 INFO  Running instrumented original pipeline...
2022-09-22 00:04:12 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-22 00:04:12 INFO  ---RUNTIME: Importing and monkey-patching took 6.135463714599609 ms
2022-09-22 00:04:20 INFO  ---RUNTIME: Original pipeline execution took 7906.048536300659 ms (excluding imports and monkey-patching)
2022-09-22 00:04:20 INFO  Starting execution of 1 what-if analyses...
2022-09-22 00:04:20 INFO  Start plan generation for analysis DataCorruption...
2022-09-22 00:04:20 INFO  ---RUNTIME: Plan generation took 0.47850608825683594 ms
2022-09-22 00:04:20 INFO  Estimated runtime of original DAG is 5553.980827331543ms
2022-09-22 00:04:20 INFO  Performing Multi-Query Optimization
2022-09-22 00:04:20 INFO  Estimated unoptimized what-if runtime is 138849.52068328857ms
2022-09-22 00:04:20 INFO  Estimated optimised what-if runtime is 12403.884887695312ms
2022-09-22 00:04:20 INFO  Estimated optimisation runtime saving is 126445.63579559326ms
2022-09-22 00:04:20 INFO  ---RUNTIME: Multi-Query Optimization took 62.76059150695801 ms
2022-09-22 00:04:20 INFO  Executing generated plans
2022-09-22 00:04:39 INFO  ---RUNTIME: Execution took 19415.749073028564 ms
2022-09-22 00:04:39 INFO  Done!
2022-09-22 00:04:39 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-22 00:04:39 INFO  Running instrumented original pipeline...
2022-09-22 00:04:39 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-22 00:04:39 INFO  ---RUNTIME: Importing and monkey-patching took 6.071805953979492 ms
2022-09-22 00:04:47 INFO  ---RUNTIME: Original pipeline execution took 7625.585079193115 ms (excluding imports and monkey-patching)
2022-09-22 00:04:47 INFO  Starting execution of 1 what-if analyses...
2022-09-22 00:04:47 INFO  Start plan generation for analysis DataCorruption...
2022-09-22 00:04:47 INFO  ---RUNTIME: Plan generation took 0.8938312530517578 ms
2022-09-22 00:04:47 INFO  Estimated runtime of original DAG is 5415.835618972778ms
2022-09-22 00:04:47 WARNING Skipping Multi-Query Optimization (instead, only applying patches)
2022-09-22 00:04:47 INFO  Estimated unoptimised what-if runtime is 135395.89047431946ms
2022-09-22 00:04:47 INFO  ---RUNTIME: Multi-Query Optimization took 29.679059982299805 ms
2022-09-22 00:04:47 INFO  Executing generated plans
2022-09-22 00:07:48 INFO  ---RUNTIME: Execution took 181748.11816215515 ms
2022-09-22 00:07:48 INFO  Done!
2022-09-22 00:07:48 INFO  # Finished -- repetition 4 of 7 
2022-09-22 00:07:48 INFO  # Optimization benchmark for data_corruption with args [['reviews', 'slow_loading', 'featurization_1', 'logistic_regression']] -- repetition 5 of 7
2022-09-22 00:07:48 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-22 00:07:48 INFO  Running instrumented original pipeline...
2022-09-22 00:07:48 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-22 00:07:48 INFO  ---RUNTIME: Importing and monkey-patching took 6.14166259765625 ms
2022-09-22 00:07:56 INFO  ---RUNTIME: Original pipeline execution took 7967.615604400635 ms (excluding imports and monkey-patching)
2022-09-22 00:07:56 INFO  Starting execution of 1 what-if analyses...
2022-09-22 00:07:56 INFO  Start plan generation for analysis DataCorruption...
2022-09-22 00:07:56 INFO  ---RUNTIME: Plan generation took 0.4730224609375 ms
2022-09-22 00:07:56 INFO  Estimated runtime of original DAG is 5659.245729446411ms
2022-09-22 00:07:56 INFO  Performing Multi-Query Optimization
2022-09-22 00:07:56 INFO  Estimated unoptimized what-if runtime is 141481.14323616028ms
2022-09-22 00:07:56 INFO  Estimated optimised what-if runtime is 12541.285514831543ms
2022-09-22 00:07:56 INFO  Estimated optimisation runtime saving is 128939.85772132874ms
2022-09-22 00:07:56 INFO  ---RUNTIME: Multi-Query Optimization took 62.96086311340332 ms
2022-09-22 00:07:56 INFO  Executing generated plans
2022-09-22 00:08:15 INFO  ---RUNTIME: Execution took 18707.995653152466 ms
2022-09-22 00:08:15 INFO  Done!
2022-09-22 00:08:15 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-22 00:08:15 INFO  Running instrumented original pipeline...
2022-09-22 00:08:15 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-22 00:08:15 INFO  ---RUNTIME: Importing and monkey-patching took 5.86247444152832 ms
2022-09-22 00:08:23 INFO  ---RUNTIME: Original pipeline execution took 7905.57861328125 ms (excluding imports and monkey-patching)
2022-09-22 00:08:23 INFO  Starting execution of 1 what-if analyses...
2022-09-22 00:08:23 INFO  Start plan generation for analysis DataCorruption...
2022-09-22 00:08:23 INFO  ---RUNTIME: Plan generation took 0.507354736328125 ms
2022-09-22 00:08:23 INFO  Estimated runtime of original DAG is 5467.807769775391ms
2022-09-22 00:08:23 WARNING Skipping Multi-Query Optimization (instead, only applying patches)
2022-09-22 00:08:23 INFO  Estimated unoptimised what-if runtime is 136695.19424438477ms
2022-09-22 00:08:23 INFO  ---RUNTIME: Multi-Query Optimization took 18.871784210205078 ms
2022-09-22 00:08:23 INFO  Executing generated plans
2022-09-22 00:11:24 INFO  ---RUNTIME: Execution took 180994.01664733887 ms
2022-09-22 00:11:24 INFO  Done!
2022-09-22 00:11:24 INFO  # Finished -- repetition 5 of 7 
2022-09-22 00:11:24 INFO  # Optimization benchmark for data_corruption with args [['reviews', 'slow_loading', 'featurization_1', 'logistic_regression']] -- repetition 6 of 7
2022-09-22 00:11:24 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-22 00:11:24 INFO  Running instrumented original pipeline...
2022-09-22 00:11:24 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-22 00:11:24 INFO  ---RUNTIME: Importing and monkey-patching took 6.281852722167969 ms
2022-09-22 00:11:32 INFO  ---RUNTIME: Original pipeline execution took 8008.93235206604 ms (excluding imports and monkey-patching)
2022-09-22 00:11:32 INFO  Starting execution of 1 what-if analyses...
2022-09-22 00:11:32 INFO  Start plan generation for analysis DataCorruption...
2022-09-22 00:11:32 INFO  ---RUNTIME: Plan generation took 0.8800029754638672 ms
2022-09-22 00:11:32 INFO  Estimated runtime of original DAG is 5797.751903533936ms
2022-09-22 00:11:32 INFO  Performing Multi-Query Optimization
2022-09-22 00:11:32 INFO  Estimated unoptimized what-if runtime is 144943.7975883484ms
2022-09-22 00:11:32 INFO  Estimated optimised what-if runtime is 13171.871185302734ms
2022-09-22 00:11:32 INFO  Estimated optimisation runtime saving is 131771.92640304565ms
2022-09-22 00:11:32 INFO  ---RUNTIME: Multi-Query Optimization took 98.62375259399414 ms
2022-09-22 00:11:32 INFO  Executing generated plans
2022-09-22 00:11:51 INFO  ---RUNTIME: Execution took 18853.696584701538 ms
2022-09-22 00:11:51 INFO  Done!
2022-09-22 00:11:51 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-22 00:11:51 INFO  Running instrumented original pipeline...
2022-09-22 00:11:51 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-22 00:11:51 INFO  ---RUNTIME: Importing and monkey-patching took 5.951642990112305 ms
2022-09-22 00:11:59 INFO  ---RUNTIME: Original pipeline execution took 7955.182313919067 ms (excluding imports and monkey-patching)
2022-09-22 00:11:59 INFO  Starting execution of 1 what-if analyses...
2022-09-22 00:11:59 INFO  Start plan generation for analysis DataCorruption...
2022-09-22 00:11:59 INFO  ---RUNTIME: Plan generation took 0.7755756378173828 ms
2022-09-22 00:11:59 INFO  Estimated runtime of original DAG is 5482.661247253418ms
2022-09-22 00:11:59 WARNING Skipping Multi-Query Optimization (instead, only applying patches)
2022-09-22 00:11:59 INFO  Estimated unoptimised what-if runtime is 137066.53118133545ms
2022-09-22 00:11:59 INFO  ---RUNTIME: Multi-Query Optimization took 27.17280387878418 ms
2022-09-22 00:11:59 INFO  Executing generated plans
2022-09-22 00:15:00 INFO  ---RUNTIME: Execution took 181091.67432785034 ms
2022-09-22 00:15:00 INFO  Done!
2022-09-22 00:15:00 INFO  # Finished -- repetition 6 of 7 
2022-09-22 00:15:00 INFO  # Optimization benchmark for data_corruption with args [['reviews', 'slow_loading', 'featurization_1', 'logistic_regression']] -- repetition 7 of 7
2022-09-22 00:15:00 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-22 00:15:00 INFO  Running instrumented original pipeline...
2022-09-22 00:15:00 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-22 00:15:00 INFO  ---RUNTIME: Importing and monkey-patching took 6.130456924438477 ms
2022-09-22 00:15:08 INFO  ---RUNTIME: Original pipeline execution took 8118.265628814697 ms (excluding imports and monkey-patching)
2022-09-22 00:15:08 INFO  Starting execution of 1 what-if analyses...
2022-09-22 00:15:08 INFO  Start plan generation for analysis DataCorruption...
2022-09-22 00:15:08 INFO  ---RUNTIME: Plan generation took 0.4665851593017578 ms
2022-09-22 00:15:08 INFO  Estimated runtime of original DAG is 5571.073532104492ms
2022-09-22 00:15:08 INFO  Performing Multi-Query Optimization
2022-09-22 00:15:08 INFO  Estimated unoptimized what-if runtime is 139276.8383026123ms
2022-09-22 00:15:08 INFO  Estimated optimised what-if runtime is 12452.4245262146ms
2022-09-22 00:15:08 INFO  Estimated optimisation runtime saving is 126824.4137763977ms
2022-09-22 00:15:08 INFO  ---RUNTIME: Multi-Query Optimization took 62.88456916809082 ms
2022-09-22 00:15:08 INFO  Executing generated plans
2022-09-22 00:15:27 INFO  ---RUNTIME: Execution took 18782.564640045166 ms
2022-09-22 00:15:27 INFO  Done!
2022-09-22 00:15:27 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-22 00:15:27 INFO  Running instrumented original pipeline...
2022-09-22 00:15:27 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-22 00:15:27 INFO  ---RUNTIME: Importing and monkey-patching took 6.142139434814453 ms
2022-09-22 00:15:35 INFO  ---RUNTIME: Original pipeline execution took 8001.8980503082275 ms (excluding imports and monkey-patching)
2022-09-22 00:15:35 INFO  Starting execution of 1 what-if analyses...
2022-09-22 00:15:35 INFO  Start plan generation for analysis DataCorruption...
2022-09-22 00:15:35 INFO  ---RUNTIME: Plan generation took 0.4794597625732422 ms
2022-09-22 00:15:35 INFO  Estimated runtime of original DAG is 5415.945291519165ms
2022-09-22 00:15:35 WARNING Skipping Multi-Query Optimization (instead, only applying patches)
2022-09-22 00:15:35 INFO  Estimated unoptimised what-if runtime is 135398.63228797913ms
2022-09-22 00:15:35 INFO  ---RUNTIME: Multi-Query Optimization took 18.75591278076172 ms
2022-09-22 00:15:35 INFO  Executing generated plans
2022-09-22 00:18:37 INFO  ---RUNTIME: Execution took 181772.53127098083 ms
2022-09-22 00:18:37 INFO  Done!
2022-09-22 00:18:37 INFO  # Finished -- repetition 7 of 7 
2022-09-22 00:18:37 INFO  # Final results after all repetitions
2022-09-22 00:18:37 INFO     repetition  ... no_opt_what_if_execution_combined_model_training
0           0  ...                                      3441.616774
1           1  ...                                      3773.231745
2           2  ...                                      3772.522211
3           3  ...                                      3686.988354
4           4  ...                                      3774.613142
5           5  ...                                      3442.758799
6           6  ...                                      3789.207935

[7 rows x 26 columns]
taskset -c 32-39 PROTOCOL_BUFFERS_PYTHON_IMPLEMENTATION=python python3.9 benchmarks_end_to_end.py data_corruption reviews slow_loading featurization_1 xgboost
2022-09-22 00:18:40.179890: W tensorflow/stream_executor/platform/default/dso_loader.cc:64] Could not load dynamic library 'libcudart.so.11.0'; dlerror: libcudart.so.11.0: cannot open shared object file: No such file or directory; LD_LIBRARY_PATH: /home/sgrafbe/mlwhatif/venv/lib/python3.9/site-packages/cv2/../../lib64:
2022-09-22 00:18:40.179938: I tensorflow/stream_executor/cuda/cudart_stub.cc:29] Ignore above cudart dlerror if you do not have a GPU set up on your machine.
2022-09-22 00:18:41 INFO  Patching sys.argv with ['mlwhatif', 'reviews', 'slow_loading', 'featurization_1', 'xgboost']
2022-09-22 00:18:41 INFO  Running instrumented original pipeline...
2022-09-22 00:18:41 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-22 00:18:41 INFO  ---RUNTIME: Importing and monkey-patching took 96.05669975280762 ms
2022-09-22 00:18:50 INFO  ---RUNTIME: Original pipeline execution took 8841.77851676941 ms (excluding imports and monkey-patching)
2022-09-22 00:18:50 INFO  Starting execution of 0 what-if analyses...
2022-09-22 00:18:50 INFO  Estimated runtime of original DAG is 6327.795028686523ms
2022-09-22 00:18:50 INFO  Performing Multi-Query Optimization
2022-09-22 00:18:50 INFO  Estimated unoptimized what-if runtime is 0ms
2022-09-22 00:18:50 INFO  Estimated optimised what-if runtime is 0ms
2022-09-22 00:18:50 INFO  Estimated optimisation runtime saving is 0ms
2022-09-22 00:18:50 INFO  ---RUNTIME: Multi-Query Optimization took 0.5171298980712891 ms
2022-09-22 00:18:50 INFO  Executing generated plans
2022-09-22 00:18:50 INFO  ---RUNTIME: Execution took 0.022411346435546875 ms
2022-09-22 00:18:50 INFO  Done!
2022-09-22 00:18:50 INFO  # Optimization benchmark for data_corruption with args [['reviews', 'slow_loading', 'featurization_1', 'xgboost']] -- repetition 1 of 7
2022-09-22 00:18:50 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-22 00:18:50 INFO  Running instrumented original pipeline...
2022-09-22 00:18:50 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-22 00:18:50 INFO  ---RUNTIME: Importing and monkey-patching took 6.104469299316406 ms
2022-09-22 00:18:59 INFO  ---RUNTIME: Original pipeline execution took 8682.445764541626 ms (excluding imports and monkey-patching)
2022-09-22 00:18:59 INFO  Starting execution of 1 what-if analyses...
2022-09-22 00:18:59 INFO  Start plan generation for analysis DataCorruption...
2022-09-22 00:18:59 INFO  ---RUNTIME: Plan generation took 0.5517005920410156 ms
2022-09-22 00:18:59 INFO  Estimated runtime of original DAG is 6280.200004577637ms
2022-09-22 00:18:59 INFO  Performing Multi-Query Optimization
2022-09-22 00:18:59 INFO  Estimated unoptimized what-if runtime is 157005.00011444092ms
2022-09-22 00:18:59 INFO  Estimated optimised what-if runtime is 14325.864553451538ms
2022-09-22 00:18:59 INFO  Estimated optimisation runtime saving is 142679.13556098938ms
2022-09-22 00:18:59 INFO  ---RUNTIME: Multi-Query Optimization took 224.64346885681152 ms
2022-09-22 00:18:59 INFO  Executing generated plans
2022-09-22 00:19:19 INFO  ---RUNTIME: Execution took 20530.03692626953 ms
2022-09-22 00:19:19 INFO  Done!
2022-09-22 00:19:19 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-22 00:19:19 INFO  Running instrumented original pipeline...
2022-09-22 00:19:19 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-22 00:19:19 INFO  ---RUNTIME: Importing and monkey-patching took 6.34312629699707 ms
2022-09-22 00:19:28 INFO  ---RUNTIME: Original pipeline execution took 8539.101839065552 ms (excluding imports and monkey-patching)
2022-09-22 00:19:28 INFO  Starting execution of 1 what-if analyses...
2022-09-22 00:19:28 INFO  Start plan generation for analysis DataCorruption...
2022-09-22 00:19:28 INFO  ---RUNTIME: Plan generation took 0.5526542663574219 ms
2022-09-22 00:19:28 INFO  Estimated runtime of original DAG is 6256.088972091675ms
2022-09-22 00:19:28 WARNING Skipping Multi-Query Optimization (instead, only applying patches)
2022-09-22 00:19:28 INFO  Estimated unoptimised what-if runtime is 156402.22430229187ms
2022-09-22 00:19:28 INFO  ---RUNTIME: Multi-Query Optimization took 18.636465072631836 ms
2022-09-22 00:19:28 INFO  Executing generated plans
2022-09-22 00:22:45 INFO  ---RUNTIME: Execution took 196990.42439460754 ms
2022-09-22 00:22:45 INFO  Done!
2022-09-22 00:22:45 INFO  # Finished -- repetition 1 of 7 
2022-09-22 00:22:45 INFO  # Optimization benchmark for data_corruption with args [['reviews', 'slow_loading', 'featurization_1', 'xgboost']] -- repetition 2 of 7
2022-09-22 00:22:45 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-22 00:22:45 INFO  Running instrumented original pipeline...
2022-09-22 00:22:45 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-22 00:22:45 INFO  ---RUNTIME: Importing and monkey-patching took 6.354093551635742 ms
2022-09-22 00:22:53 INFO  ---RUNTIME: Original pipeline execution took 8532.249689102173 ms (excluding imports and monkey-patching)
2022-09-22 00:22:53 INFO  Starting execution of 1 what-if analyses...
2022-09-22 00:22:53 INFO  Start plan generation for analysis DataCorruption...
2022-09-22 00:22:53 INFO  ---RUNTIME: Plan generation took 0.5311965942382812 ms
2022-09-22 00:22:53 INFO  Estimated runtime of original DAG is 6242.998123168945ms
2022-09-22 00:22:53 INFO  Performing Multi-Query Optimization
2022-09-22 00:22:53 INFO  Estimated unoptimized what-if runtime is 156074.95307922363ms
2022-09-22 00:22:53 INFO  Estimated optimised what-if runtime is 14415.453910827637ms
2022-09-22 00:22:53 INFO  Estimated optimisation runtime saving is 141659.499168396ms
2022-09-22 00:22:53 INFO  ---RUNTIME: Multi-Query Optimization took 62.98208236694336 ms
2022-09-22 00:22:53 INFO  Executing generated plans
2022-09-22 00:23:14 INFO  ---RUNTIME: Execution took 20287.185430526733 ms
2022-09-22 00:23:14 INFO  Done!
2022-09-22 00:23:14 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-22 00:23:14 INFO  Running instrumented original pipeline...
2022-09-22 00:23:14 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-22 00:23:14 INFO  ---RUNTIME: Importing and monkey-patching took 5.96165657043457 ms
2022-09-22 00:23:22 INFO  ---RUNTIME: Original pipeline execution took 8539.592981338501 ms (excluding imports and monkey-patching)
2022-09-22 00:23:22 INFO  Starting execution of 1 what-if analyses...
2022-09-22 00:23:22 INFO  Start plan generation for analysis DataCorruption...
2022-09-22 00:23:22 INFO  ---RUNTIME: Plan generation took 0.5390644073486328 ms
2022-09-22 00:23:22 INFO  Estimated runtime of original DAG is 6294.190168380737ms
2022-09-22 00:23:22 WARNING Skipping Multi-Query Optimization (instead, only applying patches)
2022-09-22 00:23:22 INFO  Estimated unoptimised what-if runtime is 157354.75420951843ms
2022-09-22 00:23:22 INFO  ---RUNTIME: Multi-Query Optimization took 18.801450729370117 ms
2022-09-22 00:23:22 INFO  Executing generated plans
2022-09-22 00:26:46 INFO  ---RUNTIME: Execution took 203436.83195114136 ms
2022-09-22 00:26:46 INFO  Done!
2022-09-22 00:26:46 INFO  # Finished -- repetition 2 of 7 
2022-09-22 00:26:46 INFO  # Optimization benchmark for data_corruption with args [['reviews', 'slow_loading', 'featurization_1', 'xgboost']] -- repetition 3 of 7
2022-09-22 00:26:46 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-22 00:26:46 INFO  Running instrumented original pipeline...
2022-09-22 00:26:46 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-22 00:26:46 INFO  ---RUNTIME: Importing and monkey-patching took 6.703615188598633 ms
2022-09-22 00:26:54 INFO  ---RUNTIME: Original pipeline execution took 8521.868705749512 ms (excluding imports and monkey-patching)
2022-09-22 00:26:54 INFO  Starting execution of 1 what-if analyses...
2022-09-22 00:26:54 INFO  Start plan generation for analysis DataCorruption...
2022-09-22 00:26:54 INFO  ---RUNTIME: Plan generation took 0.5619525909423828 ms
2022-09-22 00:26:54 INFO  Estimated runtime of original DAG is 6272.6123332977295ms
2022-09-22 00:26:54 INFO  Performing Multi-Query Optimization
2022-09-22 00:26:54 INFO  Estimated unoptimized what-if runtime is 156815.30833244324ms
2022-09-22 00:26:54 INFO  Estimated optimised what-if runtime is 14202.913045883179ms
2022-09-22 00:26:54 INFO  Estimated optimisation runtime saving is 142612.39528656006ms
2022-09-22 00:26:54 INFO  ---RUNTIME: Multi-Query Optimization took 62.726736068725586 ms
2022-09-22 00:26:54 INFO  Executing generated plans
2022-09-22 00:27:15 INFO  ---RUNTIME: Execution took 20305.09614944458 ms
2022-09-22 00:27:15 INFO  Done!
2022-09-22 00:27:15 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-22 00:27:15 INFO  Running instrumented original pipeline...
2022-09-22 00:27:15 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-22 00:27:15 INFO  ---RUNTIME: Importing and monkey-patching took 6.256103515625 ms
2022-09-22 00:27:23 INFO  ---RUNTIME: Original pipeline execution took 8740.787982940674 ms (excluding imports and monkey-patching)
2022-09-22 00:27:23 INFO  Starting execution of 1 what-if analyses...
2022-09-22 00:27:23 INFO  Start plan generation for analysis DataCorruption...
2022-09-22 00:27:23 INFO  ---RUNTIME: Plan generation took 0.6108283996582031 ms
2022-09-22 00:27:23 INFO  Estimated runtime of original DAG is 6211.582899093628ms
2022-09-22 00:27:23 WARNING Skipping Multi-Query Optimization (instead, only applying patches)
2022-09-22 00:27:23 INFO  Estimated unoptimised what-if runtime is 155289.5724773407ms
2022-09-22 00:27:23 INFO  ---RUNTIME: Multi-Query Optimization took 19.13738250732422 ms
2022-09-22 00:27:23 INFO  Executing generated plans
2022-09-22 00:30:57 INFO  ---RUNTIME: Execution took 213474.87688064575 ms
2022-09-22 00:30:57 INFO  Done!
2022-09-22 00:30:57 INFO  # Finished -- repetition 3 of 7 
2022-09-22 00:30:57 INFO  # Optimization benchmark for data_corruption with args [['reviews', 'slow_loading', 'featurization_1', 'xgboost']] -- repetition 4 of 7
2022-09-22 00:30:57 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-22 00:30:57 INFO  Running instrumented original pipeline...
2022-09-22 00:30:57 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-22 00:30:57 INFO  ---RUNTIME: Importing and monkey-patching took 6.170511245727539 ms
2022-09-22 00:31:05 INFO  ---RUNTIME: Original pipeline execution took 8343.480587005615 ms (excluding imports and monkey-patching)
2022-09-22 00:31:05 INFO  Starting execution of 1 what-if analyses...
2022-09-22 00:31:05 INFO  Start plan generation for analysis DataCorruption...
2022-09-22 00:31:05 INFO  ---RUNTIME: Plan generation took 0.5316734313964844 ms
2022-09-22 00:31:05 INFO  Estimated runtime of original DAG is 6142.68946647644ms
2022-09-22 00:31:05 INFO  Performing Multi-Query Optimization
2022-09-22 00:31:05 INFO  Estimated unoptimized what-if runtime is 153567.236661911ms
2022-09-22 00:31:05 INFO  Estimated optimised what-if runtime is 14040.432214736938ms
2022-09-22 00:31:05 INFO  Estimated optimisation runtime saving is 139526.80444717407ms
2022-09-22 00:31:05 INFO  ---RUNTIME: Multi-Query Optimization took 63.2786750793457 ms
2022-09-22 00:31:05 INFO  Executing generated plans
2022-09-22 00:31:26 INFO  ---RUNTIME: Execution took 20933.509349822998 ms
2022-09-22 00:31:26 INFO  Done!
2022-09-22 00:31:26 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-22 00:31:26 INFO  Running instrumented original pipeline...
2022-09-22 00:31:26 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-22 00:31:26 INFO  ---RUNTIME: Importing and monkey-patching took 6.993293762207031 ms
2022-09-22 00:31:35 INFO  ---RUNTIME: Original pipeline execution took 8713.41609954834 ms (excluding imports and monkey-patching)
2022-09-22 00:31:35 INFO  Starting execution of 1 what-if analyses...
2022-09-22 00:31:35 INFO  Start plan generation for analysis DataCorruption...
2022-09-22 00:31:35 INFO  ---RUNTIME: Plan generation took 0.49996376037597656 ms
2022-09-22 00:31:35 INFO  Estimated runtime of original DAG is 6443.790435791016ms
2022-09-22 00:31:35 WARNING Skipping Multi-Query Optimization (instead, only applying patches)
2022-09-22 00:31:35 INFO  Estimated unoptimised what-if runtime is 161094.7608947754ms
2022-09-22 00:31:35 INFO  ---RUNTIME: Multi-Query Optimization took 19.962549209594727 ms
2022-09-22 00:31:35 INFO  Executing generated plans
2022-09-22 00:34:51 INFO  ---RUNTIME: Execution took 196064.79120254517 ms
2022-09-22 00:34:51 INFO  Done!
2022-09-22 00:34:51 INFO  # Finished -- repetition 4 of 7 
2022-09-22 00:34:51 INFO  # Optimization benchmark for data_corruption with args [['reviews', 'slow_loading', 'featurization_1', 'xgboost']] -- repetition 5 of 7
2022-09-22 00:34:51 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-22 00:34:51 INFO  Running instrumented original pipeline...
2022-09-22 00:34:51 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-22 00:34:51 INFO  ---RUNTIME: Importing and monkey-patching took 6.827116012573242 ms
2022-09-22 00:34:59 INFO  ---RUNTIME: Original pipeline execution took 8366.64342880249 ms (excluding imports and monkey-patching)
2022-09-22 00:34:59 INFO  Starting execution of 1 what-if analyses...
2022-09-22 00:34:59 INFO  Start plan generation for analysis DataCorruption...
2022-09-22 00:34:59 INFO  ---RUNTIME: Plan generation took 0.5195140838623047 ms
2022-09-22 00:34:59 INFO  Estimated runtime of original DAG is 6172.250032424927ms
2022-09-22 00:34:59 INFO  Performing Multi-Query Optimization
2022-09-22 00:35:00 INFO  Estimated unoptimized what-if runtime is 154306.25081062317ms
2022-09-22 00:35:00 INFO  Estimated optimised what-if runtime is 14253.376007080078ms
2022-09-22 00:35:00 INFO  Estimated optimisation runtime saving is 140052.8748035431ms
2022-09-22 00:35:00 INFO  ---RUNTIME: Multi-Query Optimization took 62.8664493560791 ms
2022-09-22 00:35:00 INFO  Executing generated plans
2022-09-22 00:35:21 INFO  ---RUNTIME: Execution took 21553.795099258423 ms
2022-09-22 00:35:21 INFO  Done!
2022-09-22 00:35:21 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-22 00:35:21 INFO  Running instrumented original pipeline...
2022-09-22 00:35:21 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-22 00:35:21 INFO  ---RUNTIME: Importing and monkey-patching took 5.780696868896484 ms
2022-09-22 00:35:30 INFO  ---RUNTIME: Original pipeline execution took 8543.5631275177 ms (excluding imports and monkey-patching)
2022-09-22 00:35:30 INFO  Starting execution of 1 what-if analyses...
2022-09-22 00:35:30 INFO  Start plan generation for analysis DataCorruption...
2022-09-22 00:35:30 INFO  ---RUNTIME: Plan generation took 0.4832744598388672 ms
2022-09-22 00:35:30 INFO  Estimated runtime of original DAG is 6295.716047286987ms
2022-09-22 00:35:30 WARNING Skipping Multi-Query Optimization (instead, only applying patches)
2022-09-22 00:35:30 INFO  Estimated unoptimised what-if runtime is 157392.90118217468ms
2022-09-22 00:35:30 INFO  ---RUNTIME: Multi-Query Optimization took 18.484115600585938 ms
2022-09-22 00:35:30 INFO  Executing generated plans
2022-09-22 00:38:46 INFO  ---RUNTIME: Execution took 196573.89044761658 ms
2022-09-22 00:38:46 INFO  Done!
2022-09-22 00:38:46 INFO  # Finished -- repetition 5 of 7 
2022-09-22 00:38:46 INFO  # Optimization benchmark for data_corruption with args [['reviews', 'slow_loading', 'featurization_1', 'xgboost']] -- repetition 6 of 7
2022-09-22 00:38:46 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-22 00:38:46 INFO  Running instrumented original pipeline...
2022-09-22 00:38:46 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-22 00:38:46 INFO  ---RUNTIME: Importing and monkey-patching took 6.23321533203125 ms
2022-09-22 00:38:55 INFO  ---RUNTIME: Original pipeline execution took 8839.923858642578 ms (excluding imports and monkey-patching)
2022-09-22 00:38:55 INFO  Starting execution of 1 what-if analyses...
2022-09-22 00:38:55 INFO  Start plan generation for analysis DataCorruption...
2022-09-22 00:38:55 INFO  ---RUNTIME: Plan generation took 0.5829334259033203 ms
2022-09-22 00:38:55 INFO  Estimated runtime of original DAG is 6261.5039348602295ms
2022-09-22 00:38:55 INFO  Performing Multi-Query Optimization
2022-09-22 00:38:55 INFO  Estimated unoptimized what-if runtime is 156537.59837150574ms
2022-09-22 00:38:55 INFO  Estimated optimised what-if runtime is 15366.19257926941ms
2022-09-22 00:38:55 INFO  Estimated optimisation runtime saving is 141171.40579223633ms
2022-09-22 00:38:55 INFO  ---RUNTIME: Multi-Query Optimization took 64.16773796081543 ms
2022-09-22 00:38:55 INFO  Executing generated plans
2022-09-22 00:39:16 INFO  ---RUNTIME: Execution took 20632.49111175537 ms
2022-09-22 00:39:16 INFO  Done!
2022-09-22 00:39:16 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-22 00:39:16 INFO  Running instrumented original pipeline...
2022-09-22 00:39:16 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-22 00:39:16 INFO  ---RUNTIME: Importing and monkey-patching took 6.195068359375 ms
2022-09-22 00:39:24 INFO  ---RUNTIME: Original pipeline execution took 8593.8560962677 ms (excluding imports and monkey-patching)
2022-09-22 00:39:24 INFO  Starting execution of 1 what-if analyses...
2022-09-22 00:39:24 INFO  Start plan generation for analysis DataCorruption...
2022-09-22 00:39:24 INFO  ---RUNTIME: Plan generation took 0.591278076171875 ms
2022-09-22 00:39:24 INFO  Estimated runtime of original DAG is 6303.293943405151ms
2022-09-22 00:39:24 WARNING Skipping Multi-Query Optimization (instead, only applying patches)
2022-09-22 00:39:24 INFO  Estimated unoptimised what-if runtime is 157582.34858512878ms
2022-09-22 00:39:24 INFO  ---RUNTIME: Multi-Query Optimization took 20.230531692504883 ms
2022-09-22 00:39:24 INFO  Executing generated plans
2022-09-22 00:42:51 INFO  ---RUNTIME: Execution took 206152.16588974 ms
2022-09-22 00:42:51 INFO  Done!
2022-09-22 00:42:51 INFO  # Finished -- repetition 6 of 7 
2022-09-22 00:42:51 INFO  # Optimization benchmark for data_corruption with args [['reviews', 'slow_loading', 'featurization_1', 'xgboost']] -- repetition 7 of 7
2022-09-22 00:42:51 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-22 00:42:51 INFO  Running instrumented original pipeline...
2022-09-22 00:42:51 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-22 00:42:51 INFO  ---RUNTIME: Importing and monkey-patching took 7.0056915283203125 ms
2022-09-22 00:43:00 INFO  ---RUNTIME: Original pipeline execution took 8952.247381210327 ms (excluding imports and monkey-patching)
2022-09-22 00:43:00 INFO  Starting execution of 1 what-if analyses...
2022-09-22 00:43:00 INFO  Start plan generation for analysis DataCorruption...
2022-09-22 00:43:00 INFO  ---RUNTIME: Plan generation took 0.6089210510253906 ms
2022-09-22 00:43:00 INFO  Estimated runtime of original DAG is 6517.502546310425ms
2022-09-22 00:43:00 INFO  Performing Multi-Query Optimization
2022-09-22 00:43:00 INFO  Estimated unoptimized what-if runtime is 162937.56365776062ms
2022-09-22 00:43:00 INFO  Estimated optimised what-if runtime is 15629.635095596313ms
2022-09-22 00:43:00 INFO  Estimated optimisation runtime saving is 147307.9285621643ms
2022-09-22 00:43:00 INFO  ---RUNTIME: Multi-Query Optimization took 68.26329231262207 ms
2022-09-22 00:43:00 INFO  Executing generated plans
2022-09-22 00:43:21 INFO  ---RUNTIME: Execution took 21050.669193267822 ms
2022-09-22 00:43:21 INFO  Done!
2022-09-22 00:43:21 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-22 00:43:21 INFO  Running instrumented original pipeline...
2022-09-22 00:43:21 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-22 00:43:21 INFO  ---RUNTIME: Importing and monkey-patching took 6.217002868652344 ms
2022-09-22 00:43:32 INFO  ---RUNTIME: Original pipeline execution took 11688.26699256897 ms (excluding imports and monkey-patching)
2022-09-22 00:43:32 INFO  Starting execution of 1 what-if analyses...
2022-09-22 00:43:32 INFO  Start plan generation for analysis DataCorruption...
2022-09-22 00:43:32 INFO  ---RUNTIME: Plan generation took 0.5612373352050781 ms
2022-09-22 00:43:32 INFO  Estimated runtime of original DAG is 9469.54321861267ms
2022-09-22 00:43:32 WARNING Skipping Multi-Query Optimization (instead, only applying patches)
2022-09-22 00:43:32 INFO  Estimated unoptimised what-if runtime is 236738.58046531677ms
2022-09-22 00:43:32 INFO  ---RUNTIME: Multi-Query Optimization took 19.464731216430664 ms
2022-09-22 00:43:32 INFO  Executing generated plans
2022-09-22 00:46:47 INFO  ---RUNTIME: Execution took 194451.62510871887 ms
2022-09-22 00:46:47 INFO  Done!
2022-09-22 00:46:47 INFO  # Finished -- repetition 7 of 7 
2022-09-22 00:46:47 INFO  # Final results after all repetitions
2022-09-22 00:46:47 INFO     repetition  ... no_opt_what_if_execution_combined_model_training
0           0  ...                                     24684.722185
1           1  ...                                     31515.858889
2           2  ...                                     42828.505993
3           3  ...                                     25122.168064
4           4  ...                                     24917.239666
5           5  ...                                     33944.756508
6           6  ...                                     23963.217497

[7 rows x 26 columns]
taskset -c 32-39 PROTOCOL_BUFFERS_PYTHON_IMPLEMENTATION=python python3.9 benchmarks_end_to_end.py data_corruption reviews slow_loading featurization_1 neural_network
2022-09-22 00:46:49.506691: W tensorflow/stream_executor/platform/default/dso_loader.cc:64] Could not load dynamic library 'libcudart.so.11.0'; dlerror: libcudart.so.11.0: cannot open shared object file: No such file or directory; LD_LIBRARY_PATH: /home/sgrafbe/mlwhatif/venv/lib/python3.9/site-packages/cv2/../../lib64:
2022-09-22 00:46:49.506740: I tensorflow/stream_executor/cuda/cudart_stub.cc:29] Ignore above cudart dlerror if you do not have a GPU set up on your machine.
2022-09-22 00:46:50 INFO  Patching sys.argv with ['mlwhatif', 'reviews', 'slow_loading', 'featurization_1', 'neural_network']
2022-09-22 00:46:50 INFO  Running instrumented original pipeline...
2022-09-22 00:46:50 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-22 00:46:50 INFO  ---RUNTIME: Importing and monkey-patching took 95.88623046875 ms
2022-09-22 00:46:57.177418: W tensorflow/stream_executor/platform/default/dso_loader.cc:64] Could not load dynamic library 'libcuda.so.1'; dlerror: libcuda.so.1: cannot open shared object file: No such file or directory; LD_LIBRARY_PATH: /home/sgrafbe/mlwhatif/venv/lib/python3.9/site-packages/cv2/../../lib64:
2022-09-22 00:46:57.177457: W tensorflow/stream_executor/cuda/cuda_driver.cc:326] failed call to cuInit: UNKNOWN ERROR (303)
2022-09-22 00:46:57.177481: I tensorflow/stream_executor/cuda/cuda_diagnostics.cc:156] kernel driver does not appear to be running on this host (wagyu): /proc/driver/nvidia/version does not exist
2022-09-22 00:46:57.178065: I tensorflow/core/platform/cpu_feature_guard.cc:142] This TensorFlow binary is optimized with oneAPI Deep Neural Network Library (oneDNN) to use the following CPU instructions in performance-critical operations:  AVX2 FMA
To enable them in other operations, rebuild TensorFlow with the appropriate compiler flags.
2022-09-22 00:46:57.247304: I tensorflow/compiler/mlir/mlir_graph_optimization_pass.cc:176] None of the MLIR Optimization Passes are enabled (registered 2)
2022-09-22 00:46:57.260370: I tensorflow/core/platform/profile_utils/cpu_utils.cc:114] CPU Frequency: 2595290000 Hz
2022-09-22 00:47:02 INFO  ---RUNTIME: Original pipeline execution took 11649.92904663086 ms (excluding imports and monkey-patching)
2022-09-22 00:47:02 INFO  Starting execution of 0 what-if analyses...
2022-09-22 00:47:02 INFO  Estimated runtime of original DAG is 9351.184368133545ms
2022-09-22 00:47:02 INFO  Performing Multi-Query Optimization
2022-09-22 00:47:02 INFO  Estimated unoptimized what-if runtime is 0ms
2022-09-22 00:47:02 INFO  Estimated optimised what-if runtime is 0ms
2022-09-22 00:47:02 INFO  Estimated optimisation runtime saving is 0ms
2022-09-22 00:47:02 INFO  ---RUNTIME: Multi-Query Optimization took 0.5438327789306641 ms
2022-09-22 00:47:02 INFO  Executing generated plans
2022-09-22 00:47:02 INFO  ---RUNTIME: Execution took 0.024318695068359375 ms
2022-09-22 00:47:02 INFO  Done!
2022-09-22 00:47:02 INFO  # Optimization benchmark for data_corruption with args [['reviews', 'slow_loading', 'featurization_1', 'neural_network']] -- repetition 1 of 7
2022-09-22 00:47:02 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-22 00:47:02 INFO  Running instrumented original pipeline...
2022-09-22 00:47:02 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-22 00:47:02 INFO  ---RUNTIME: Importing and monkey-patching took 6.501674652099609 ms
2022-09-22 00:47:13 INFO  ---RUNTIME: Original pipeline execution took 11315.390586853027 ms (excluding imports and monkey-patching)
2022-09-22 00:47:13 INFO  Starting execution of 1 what-if analyses...
2022-09-22 00:47:13 INFO  Start plan generation for analysis DataCorruption...
2022-09-22 00:47:13 INFO  ---RUNTIME: Plan generation took 0.5559921264648438 ms
2022-09-22 00:47:13 INFO  Estimated runtime of original DAG is 9090.336799621582ms
2022-09-22 00:47:13 INFO  Performing Multi-Query Optimization
2022-09-22 00:47:13 INFO  Estimated unoptimized what-if runtime is 227258.41999053955ms
2022-09-22 00:47:13 INFO  Estimated optimised what-if runtime is 27972.785234451294ms
2022-09-22 00:47:13 INFO  Estimated optimisation runtime saving is 199285.63475608826ms
2022-09-22 00:47:13 INFO  ---RUNTIME: Multi-Query Optimization took 67.84796714782715 ms
2022-09-22 00:47:13 INFO  Executing generated plans
2022-09-22 00:47:44 INFO  ---RUNTIME: Execution took 31077.622175216675 ms
2022-09-22 00:47:44 INFO  Done!
2022-09-22 00:47:44 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-22 00:47:44 INFO  Running instrumented original pipeline...
2022-09-22 00:47:44 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-22 00:47:44 INFO  ---RUNTIME: Importing and monkey-patching took 6.397008895874023 ms
2022-09-22 00:47:56 INFO  ---RUNTIME: Original pipeline execution took 11884.96446609497 ms (excluding imports and monkey-patching)
2022-09-22 00:47:56 INFO  Starting execution of 1 what-if analyses...
2022-09-22 00:47:56 INFO  Start plan generation for analysis DataCorruption...
2022-09-22 00:47:56 INFO  ---RUNTIME: Plan generation took 2.9447078704833984 ms
2022-09-22 00:47:56 INFO  Estimated runtime of original DAG is 9570.257902145386ms
2022-09-22 00:47:56 WARNING Skipping Multi-Query Optimization (instead, only applying patches)
2022-09-22 00:47:56 INFO  Estimated unoptimised what-if runtime is 239256.44755363464ms
2022-09-22 00:47:56 INFO  ---RUNTIME: Multi-Query Optimization took 20.557641983032227 ms
2022-09-22 00:47:56 INFO  Executing generated plans
2022-09-22 00:52:24 INFO  ---RUNTIME: Execution took 267228.35779190063 ms
2022-09-22 00:52:24 INFO  Done!
2022-09-22 00:52:24 INFO  # Finished -- repetition 1 of 7 
2022-09-22 00:52:24 INFO  # Optimization benchmark for data_corruption with args [['reviews', 'slow_loading', 'featurization_1', 'neural_network']] -- repetition 2 of 7
2022-09-22 00:52:24 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-22 00:52:24 INFO  Running instrumented original pipeline...
2022-09-22 00:52:24 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-22 00:52:24 INFO  ---RUNTIME: Importing and monkey-patching took 6.676435470581055 ms
2022-09-22 00:52:35 INFO  ---RUNTIME: Original pipeline execution took 11456.268548965454 ms (excluding imports and monkey-patching)
2022-09-22 00:52:35 INFO  Starting execution of 1 what-if analyses...
2022-09-22 00:52:35 INFO  Start plan generation for analysis DataCorruption...
2022-09-22 00:52:35 INFO  ---RUNTIME: Plan generation took 0.4057884216308594 ms
2022-09-22 00:52:35 INFO  Estimated runtime of original DAG is 9264.81032371521ms
2022-09-22 00:52:35 INFO  Performing Multi-Query Optimization
2022-09-22 00:52:35 INFO  Estimated unoptimized what-if runtime is 231620.25809288025ms
2022-09-22 00:52:35 INFO  Estimated optimised what-if runtime is 26709.025382995605ms
2022-09-22 00:52:35 INFO  Estimated optimisation runtime saving is 204911.23270988464ms
2022-09-22 00:52:35 INFO  ---RUNTIME: Multi-Query Optimization took 62.384605407714844 ms
2022-09-22 00:52:35 INFO  Executing generated plans
2022-09-22 00:53:06 INFO  ---RUNTIME: Execution took 30706.43901824951 ms
2022-09-22 00:53:06 INFO  Done!
2022-09-22 00:53:06 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-22 00:53:06 INFO  Running instrumented original pipeline...
2022-09-22 00:53:06 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-22 00:53:06 INFO  ---RUNTIME: Importing and monkey-patching took 6.389617919921875 ms
2022-09-22 00:53:18 INFO  ---RUNTIME: Original pipeline execution took 11949.88989830017 ms (excluding imports and monkey-patching)
2022-09-22 00:53:18 INFO  Starting execution of 1 what-if analyses...
2022-09-22 00:53:18 INFO  Start plan generation for analysis DataCorruption...
2022-09-22 00:53:18 INFO  ---RUNTIME: Plan generation took 0.5915164947509766 ms
2022-09-22 00:53:18 INFO  Estimated runtime of original DAG is 9347.709894180298ms
2022-09-22 00:53:18 WARNING Skipping Multi-Query Optimization (instead, only applying patches)
2022-09-22 00:53:18 INFO  Estimated unoptimised what-if runtime is 233692.74735450745ms
2022-09-22 00:53:18 INFO  ---RUNTIME: Multi-Query Optimization took 23.444414138793945 ms
2022-09-22 00:53:18 INFO  Executing generated plans
2022-09-22 00:57:44 INFO  ---RUNTIME: Execution took 266610.0904941559 ms
2022-09-22 00:57:44 INFO  Done!
2022-09-22 00:57:44 INFO  # Finished -- repetition 2 of 7 
2022-09-22 00:57:44 INFO  # Optimization benchmark for data_corruption with args [['reviews', 'slow_loading', 'featurization_1', 'neural_network']] -- repetition 3 of 7
2022-09-22 00:57:44 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-22 00:57:44 INFO  Running instrumented original pipeline...
2022-09-22 00:57:44 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-22 00:57:44 INFO  ---RUNTIME: Importing and monkey-patching took 6.300687789916992 ms
2022-09-22 00:57:56 INFO  ---RUNTIME: Original pipeline execution took 11796.215295791626 ms (excluding imports and monkey-patching)
2022-09-22 00:57:56 INFO  Starting execution of 1 what-if analyses...
2022-09-22 00:57:56 INFO  Start plan generation for analysis DataCorruption...
2022-09-22 00:57:56 INFO  ---RUNTIME: Plan generation took 2.2046566009521484 ms
2022-09-22 00:57:56 INFO  Estimated runtime of original DAG is 9192.393064498901ms
2022-09-22 00:57:56 INFO  Performing Multi-Query Optimization
2022-09-22 00:57:56 INFO  Estimated unoptimized what-if runtime is 229809.82661247253ms
2022-09-22 00:57:56 INFO  Estimated optimised what-if runtime is 25513.198137283325ms
2022-09-22 00:57:56 INFO  Estimated optimisation runtime saving is 204296.6284751892ms
2022-09-22 00:57:56 INFO  ---RUNTIME: Multi-Query Optimization took 62.94655799865723 ms
2022-09-22 00:57:56 INFO  Executing generated plans
2022-09-22 00:58:27 INFO  ---RUNTIME: Execution took 30788.56372833252 ms
2022-09-22 00:58:27 INFO  Done!
2022-09-22 00:58:27 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-22 00:58:27 INFO  Running instrumented original pipeline...
2022-09-22 00:58:27 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-22 00:58:27 INFO  ---RUNTIME: Importing and monkey-patching took 6.308794021606445 ms
2022-09-22 00:58:38 INFO  ---RUNTIME: Original pipeline execution took 11003.095626831055 ms (excluding imports and monkey-patching)
2022-09-22 00:58:38 INFO  Starting execution of 1 what-if analyses...
2022-09-22 00:58:38 INFO  Start plan generation for analysis DataCorruption...
2022-09-22 00:58:38 INFO  ---RUNTIME: Plan generation took 0.4067420959472656 ms
2022-09-22 00:58:38 INFO  Estimated runtime of original DAG is 8775.899648666382ms
2022-09-22 00:58:38 WARNING Skipping Multi-Query Optimization (instead, only applying patches)
2022-09-22 00:58:38 INFO  Estimated unoptimised what-if runtime is 219397.49121665955ms
2022-09-22 00:58:38 INFO  ---RUNTIME: Multi-Query Optimization took 18.55778694152832 ms
2022-09-22 00:58:38 INFO  Executing generated plans
2022-09-22 01:02:57 INFO  ---RUNTIME: Execution took 258491.08958244324 ms
2022-09-22 01:02:57 INFO  Done!
2022-09-22 01:02:57 INFO  # Finished -- repetition 3 of 7 
2022-09-22 01:02:57 INFO  # Optimization benchmark for data_corruption with args [['reviews', 'slow_loading', 'featurization_1', 'neural_network']] -- repetition 4 of 7
2022-09-22 01:02:57 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-22 01:02:57 INFO  Running instrumented original pipeline...
2022-09-22 01:02:57 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-22 01:02:57 INFO  ---RUNTIME: Importing and monkey-patching took 6.0176849365234375 ms
2022-09-22 01:03:08 INFO  ---RUNTIME: Original pipeline execution took 11047.447919845581 ms (excluding imports and monkey-patching)
2022-09-22 01:03:08 INFO  Starting execution of 1 what-if analyses...
2022-09-22 01:03:08 INFO  Start plan generation for analysis DataCorruption...
2022-09-22 01:03:08 INFO  ---RUNTIME: Plan generation took 2.215147018432617 ms
2022-09-22 01:03:08 INFO  Estimated runtime of original DAG is 8800.10724067688ms
2022-09-22 01:03:08 INFO  Performing Multi-Query Optimization
2022-09-22 01:03:08 INFO  Estimated unoptimized what-if runtime is 220002.681016922ms
2022-09-22 01:03:08 INFO  Estimated optimised what-if runtime is 24951.292514801025ms
2022-09-22 01:03:08 INFO  Estimated optimisation runtime saving is 195051.38850212097ms
2022-09-22 01:03:08 INFO  ---RUNTIME: Multi-Query Optimization took 62.16621398925781 ms
2022-09-22 01:03:08 INFO  Executing generated plans
2022-09-22 01:03:38 INFO  ---RUNTIME: Execution took 30707.128286361694 ms
2022-09-22 01:03:38 INFO  Done!
2022-09-22 01:03:38 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-22 01:03:38 INFO  Running instrumented original pipeline...
2022-09-22 01:03:38 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-22 01:03:39 INFO  ---RUNTIME: Importing and monkey-patching took 6.021261215209961 ms
2022-09-22 01:03:50 INFO  ---RUNTIME: Original pipeline execution took 11359.52615737915 ms (excluding imports and monkey-patching)
2022-09-22 01:03:50 INFO  Starting execution of 1 what-if analyses...
2022-09-22 01:03:50 INFO  Start plan generation for analysis DataCorruption...
2022-09-22 01:03:50 INFO  ---RUNTIME: Plan generation took 0.4639625549316406 ms
2022-09-22 01:03:50 INFO  Estimated runtime of original DAG is 9153.09739112854ms
2022-09-22 01:03:50 WARNING Skipping Multi-Query Optimization (instead, only applying patches)
2022-09-22 01:03:50 INFO  Estimated unoptimised what-if runtime is 228827.4347782135ms
2022-09-22 01:03:50 INFO  ---RUNTIME: Multi-Query Optimization took 19.054889678955078 ms
2022-09-22 01:03:50 INFO  Executing generated plans
2022-09-22 01:08:07 INFO  ---RUNTIME: Execution took 257581.56180381775 ms
2022-09-22 01:08:07 INFO  Done!
2022-09-22 01:08:07 INFO  # Finished -- repetition 4 of 7 
2022-09-22 01:08:07 INFO  # Optimization benchmark for data_corruption with args [['reviews', 'slow_loading', 'featurization_1', 'neural_network']] -- repetition 5 of 7
2022-09-22 01:08:07 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-22 01:08:07 INFO  Running instrumented original pipeline...
2022-09-22 01:08:07 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-22 01:08:07 INFO  ---RUNTIME: Importing and monkey-patching took 6.382942199707031 ms
2022-09-22 01:08:19 INFO  ---RUNTIME: Original pipeline execution took 11059.356451034546 ms (excluding imports and monkey-patching)
2022-09-22 01:08:19 INFO  Starting execution of 1 what-if analyses...
2022-09-22 01:08:19 INFO  Start plan generation for analysis DataCorruption...
2022-09-22 01:08:19 INFO  ---RUNTIME: Plan generation took 0.46372413635253906 ms
2022-09-22 01:08:19 INFO  Estimated runtime of original DAG is 8812.132835388184ms
2022-09-22 01:08:19 INFO  Performing Multi-Query Optimization
2022-09-22 01:08:19 INFO  Estimated unoptimized what-if runtime is 220303.3208847046ms
2022-09-22 01:08:19 INFO  Estimated optimised what-if runtime is 24984.761953353882ms
2022-09-22 01:08:19 INFO  Estimated optimisation runtime saving is 195318.5589313507ms
2022-09-22 01:08:19 INFO  ---RUNTIME: Multi-Query Optimization took 62.323570251464844 ms
2022-09-22 01:08:19 INFO  Executing generated plans
2022-09-22 01:08:49 INFO  ---RUNTIME: Execution took 30700.50859451294 ms
2022-09-22 01:08:49 INFO  Done!
2022-09-22 01:08:49 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-22 01:08:49 INFO  Running instrumented original pipeline...
2022-09-22 01:08:49 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-22 01:08:49 INFO  ---RUNTIME: Importing and monkey-patching took 6.1855316162109375 ms
2022-09-22 01:09:00 INFO  ---RUNTIME: Original pipeline execution took 11091.246366500854 ms (excluding imports and monkey-patching)
2022-09-22 01:09:00 INFO  Starting execution of 1 what-if analyses...
2022-09-22 01:09:00 INFO  Start plan generation for analysis DataCorruption...
2022-09-22 01:09:00 INFO  ---RUNTIME: Plan generation took 0.4858970642089844 ms
2022-09-22 01:09:00 INFO  Estimated runtime of original DAG is 8816.595792770386ms
2022-09-22 01:09:00 WARNING Skipping Multi-Query Optimization (instead, only applying patches)
2022-09-22 01:09:00 INFO  Estimated unoptimised what-if runtime is 220414.89481925964ms
2022-09-22 01:09:00 INFO  ---RUNTIME: Multi-Query Optimization took 19.469261169433594 ms
2022-09-22 01:09:00 INFO  Executing generated plans
2022-09-22 01:13:18 INFO  ---RUNTIME: Execution took 257689.82362747192 ms
2022-09-22 01:13:18 INFO  Done!
2022-09-22 01:13:18 INFO  # Finished -- repetition 5 of 7 
2022-09-22 01:13:18 INFO  # Optimization benchmark for data_corruption with args [['reviews', 'slow_loading', 'featurization_1', 'neural_network']] -- repetition 6 of 7
2022-09-22 01:13:18 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-22 01:13:18 INFO  Running instrumented original pipeline...
2022-09-22 01:13:18 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-22 01:13:18 INFO  ---RUNTIME: Importing and monkey-patching took 6.012439727783203 ms
2022-09-22 01:13:29 INFO  ---RUNTIME: Original pipeline execution took 11119.603157043457 ms (excluding imports and monkey-patching)
2022-09-22 01:13:29 INFO  Starting execution of 1 what-if analyses...
2022-09-22 01:13:29 INFO  Start plan generation for analysis DataCorruption...
2022-09-22 01:13:29 INFO  ---RUNTIME: Plan generation took 2.2008419036865234 ms
2022-09-22 01:13:29 INFO  Estimated runtime of original DAG is 8872.389316558838ms
2022-09-22 01:13:29 INFO  Performing Multi-Query Optimization
2022-09-22 01:13:29 INFO  Estimated unoptimized what-if runtime is 221809.73291397095ms
2022-09-22 01:13:29 INFO  Estimated optimised what-if runtime is 24747.11036682129ms
2022-09-22 01:13:29 INFO  Estimated optimisation runtime saving is 197062.62254714966ms
2022-09-22 01:13:29 INFO  ---RUNTIME: Multi-Query Optimization took 62.34145164489746 ms
2022-09-22 01:13:29 INFO  Executing generated plans
2022-09-22 01:14:00 INFO  ---RUNTIME: Execution took 30402.377605438232 ms
2022-09-22 01:14:00 INFO  Done!
2022-09-22 01:14:00 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-22 01:14:00 INFO  Running instrumented original pipeline...
2022-09-22 01:14:00 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-22 01:14:00 INFO  ---RUNTIME: Importing and monkey-patching took 5.948305130004883 ms
2022-09-22 01:14:11 INFO  ---RUNTIME: Original pipeline execution took 11590.593338012695 ms (excluding imports and monkey-patching)
2022-09-22 01:14:11 INFO  Starting execution of 1 what-if analyses...
2022-09-22 01:14:11 INFO  Start plan generation for analysis DataCorruption...
2022-09-22 01:14:11 INFO  ---RUNTIME: Plan generation took 0.4298686981201172 ms
2022-09-22 01:14:11 INFO  Estimated runtime of original DAG is 8897.84836769104ms
2022-09-22 01:14:11 WARNING Skipping Multi-Query Optimization (instead, only applying patches)
2022-09-22 01:14:11 INFO  Estimated unoptimised what-if runtime is 222446.209192276ms
2022-09-22 01:14:11 INFO  ---RUNTIME: Multi-Query Optimization took 19.143342971801758 ms
2022-09-22 01:14:11 INFO  Executing generated plans
2022-09-22 01:18:29 INFO  ---RUNTIME: Execution took 257371.27327919006 ms
2022-09-22 01:18:29 INFO  Done!
2022-09-22 01:18:29 INFO  # Finished -- repetition 6 of 7 
2022-09-22 01:18:29 INFO  # Optimization benchmark for data_corruption with args [['reviews', 'slow_loading', 'featurization_1', 'neural_network']] -- repetition 7 of 7
2022-09-22 01:18:29 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-22 01:18:29 INFO  Running instrumented original pipeline...
2022-09-22 01:18:29 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-22 01:18:29 INFO  ---RUNTIME: Importing and monkey-patching took 6.003379821777344 ms
2022-09-22 01:18:40 INFO  ---RUNTIME: Original pipeline execution took 11025.8629322052 ms (excluding imports and monkey-patching)
2022-09-22 01:18:40 INFO  Starting execution of 1 what-if analyses...
2022-09-22 01:18:40 INFO  Start plan generation for analysis DataCorruption...
2022-09-22 01:18:40 INFO  ---RUNTIME: Plan generation took 0.4417896270751953 ms
2022-09-22 01:18:40 INFO  Estimated runtime of original DAG is 8758.196830749512ms
2022-09-22 01:18:40 INFO  Performing Multi-Query Optimization
2022-09-22 01:18:40 INFO  Estimated unoptimized what-if runtime is 218954.9207687378ms
2022-09-22 01:18:40 INFO  Estimated optimised what-if runtime is 25097.55778312683ms
2022-09-22 01:18:40 INFO  Estimated optimisation runtime saving is 193857.36298561096ms
2022-09-22 01:18:40 INFO  ---RUNTIME: Multi-Query Optimization took 62.287330627441406 ms
2022-09-22 01:18:40 INFO  Executing generated plans
2022-09-22 01:19:10 INFO  ---RUNTIME: Execution took 30494.932651519775 ms
2022-09-22 01:19:10 INFO  Done!
2022-09-22 01:19:10 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-22 01:19:10 INFO  Running instrumented original pipeline...
2022-09-22 01:19:10 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-22 01:19:10 INFO  ---RUNTIME: Importing and monkey-patching took 5.935907363891602 ms
2022-09-22 01:19:21 INFO  ---RUNTIME: Original pipeline execution took 10949.275255203247 ms (excluding imports and monkey-patching)
2022-09-22 01:19:21 INFO  Starting execution of 1 what-if analyses...
2022-09-22 01:19:21 INFO  Start plan generation for analysis DataCorruption...
2022-09-22 01:19:21 INFO  ---RUNTIME: Plan generation took 0.3986358642578125 ms
2022-09-22 01:19:21 INFO  Estimated runtime of original DAG is 8737.070083618164ms
2022-09-22 01:19:21 WARNING Skipping Multi-Query Optimization (instead, only applying patches)
2022-09-22 01:19:21 INFO  Estimated unoptimised what-if runtime is 218426.7520904541ms
2022-09-22 01:19:21 INFO  ---RUNTIME: Multi-Query Optimization took 19.458770751953125 ms
2022-09-22 01:19:21 INFO  Executing generated plans
2022-09-22 01:24:44 INFO  ---RUNTIME: Execution took 322666.6295528412 ms
2022-09-22 01:24:44 INFO  Done!
2022-09-22 01:24:44 INFO  # Finished -- repetition 7 of 7 
2022-09-22 01:24:44 INFO  # Final results after all repetitions
2022-09-22 01:24:44 INFO     repetition  ... no_opt_what_if_execution_combined_model_training
0           0  ...                                     86422.994375
1           1  ...                                     86576.196909
2           2  ...                                     81692.289829
3           3  ...                                     81146.400213
4           4  ...                                     80490.282774
5           5  ...                                     80629.080772
6           6  ...                                    102875.541925

[7 rows x 26 columns]
taskset -c 32-39 PROTOCOL_BUFFERS_PYTHON_IMPLEMENTATION=python python3.9 benchmarks_end_to_end.py data_corruption reviews slow_loading featurization_2 logistic_regression
2022-09-22 01:24:48.900164: W tensorflow/stream_executor/platform/default/dso_loader.cc:64] Could not load dynamic library 'libcudart.so.11.0'; dlerror: libcudart.so.11.0: cannot open shared object file: No such file or directory; LD_LIBRARY_PATH: /home/sgrafbe/mlwhatif/venv/lib/python3.9/site-packages/cv2/../../lib64:
2022-09-22 01:24:48.900214: I tensorflow/stream_executor/cuda/cudart_stub.cc:29] Ignore above cudart dlerror if you do not have a GPU set up on your machine.
2022-09-22 01:24:50 INFO  Patching sys.argv with ['mlwhatif', 'reviews', 'slow_loading', 'featurization_2', 'logistic_regression']
2022-09-22 01:24:50 INFO  Running instrumented original pipeline...
2022-09-22 01:24:51 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-22 01:24:51 INFO  ---RUNTIME: Importing and monkey-patching took 169.37565803527832 ms
2022-09-22 01:25:01 INFO  ---RUNTIME: Original pipeline execution took 10803.39503288269 ms (excluding imports and monkey-patching)
2022-09-22 01:25:01 INFO  Starting execution of 0 what-if analyses...
2022-09-22 01:25:01 INFO  Estimated runtime of original DAG is 9051.15556716919ms
2022-09-22 01:25:01 INFO  Performing Multi-Query Optimization
2022-09-22 01:25:01 INFO  Estimated unoptimized what-if runtime is 0ms
2022-09-22 01:25:01 INFO  Estimated optimised what-if runtime is 0ms
2022-09-22 01:25:01 INFO  Estimated optimisation runtime saving is 0ms
2022-09-22 01:25:01 INFO  ---RUNTIME: Multi-Query Optimization took 0.7550716400146484 ms
2022-09-22 01:25:01 INFO  Executing generated plans
2022-09-22 01:25:01 INFO  ---RUNTIME: Execution took 0.026702880859375 ms
2022-09-22 01:25:01 INFO  Done!
2022-09-22 01:25:01 INFO  # Optimization benchmark for data_corruption with args [['reviews', 'slow_loading', 'featurization_2', 'logistic_regression']] -- repetition 1 of 7
2022-09-22 01:25:01 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-22 01:25:01 INFO  Running instrumented original pipeline...
2022-09-22 01:25:01 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-22 01:25:01 INFO  ---RUNTIME: Importing and monkey-patching took 6.748676300048828 ms
2022-09-22 01:25:12 INFO  ---RUNTIME: Original pipeline execution took 10420.156240463257 ms (excluding imports and monkey-patching)
2022-09-22 01:25:12 INFO  Starting execution of 1 what-if analyses...
2022-09-22 01:25:12 INFO  Start plan generation for analysis DataCorruption...
2022-09-22 01:25:12 INFO  ---RUNTIME: Plan generation took 5.0830841064453125 ms
2022-09-22 01:25:12 INFO  Estimated runtime of original DAG is 8649.364471435547ms
2022-09-22 01:25:12 INFO  Performing Multi-Query Optimization
2022-09-22 01:25:12 INFO  Estimated unoptimized what-if runtime is 216234.11178588867ms
2022-09-22 01:25:12 INFO  Estimated optimised what-if runtime is 20104.554176330566ms
2022-09-22 01:25:12 INFO  Estimated optimisation runtime saving is 196129.5576095581ms
2022-09-22 01:25:12 INFO  ---RUNTIME: Multi-Query Optimization took 136.83724403381348 ms
2022-09-22 01:25:12 INFO  Executing generated plans
2022-09-22 01:25:41 INFO  ---RUNTIME: Execution took 29448.23145866394 ms
2022-09-22 01:25:41 INFO  Done!
2022-09-22 01:25:41 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-22 01:25:41 INFO  Running instrumented original pipeline...
2022-09-22 01:25:42 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-22 01:25:42 INFO  ---RUNTIME: Importing and monkey-patching took 8.755683898925781 ms
2022-09-22 01:25:53 INFO  ---RUNTIME: Original pipeline execution took 11109.105348587036 ms (excluding imports and monkey-patching)
2022-09-22 01:25:53 INFO  Starting execution of 1 what-if analyses...
2022-09-22 01:25:53 INFO  Start plan generation for analysis DataCorruption...
2022-09-22 01:25:53 INFO  ---RUNTIME: Plan generation took 0.6041526794433594 ms
2022-09-22 01:25:53 INFO  Estimated runtime of original DAG is 9088.49287033081ms
2022-09-22 01:25:53 WARNING Skipping Multi-Query Optimization (instead, only applying patches)
2022-09-22 01:25:53 INFO  Estimated unoptimised what-if runtime is 227212.32175827026ms
2022-09-22 01:25:53 INFO  ---RUNTIME: Multi-Query Optimization took 32.90700912475586 ms
2022-09-22 01:25:53 INFO  Executing generated plans
2022-09-22 01:29:50 INFO  ---RUNTIME: Execution took 237811.23876571655 ms
2022-09-22 01:29:50 INFO  Done!
2022-09-22 01:29:50 INFO  # Finished -- repetition 1 of 7 
2022-09-22 01:29:50 INFO  # Optimization benchmark for data_corruption with args [['reviews', 'slow_loading', 'featurization_2', 'logistic_regression']] -- repetition 2 of 7
2022-09-22 01:29:50 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-22 01:29:50 INFO  Running instrumented original pipeline...
2022-09-22 01:29:50 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-22 01:29:50 INFO  ---RUNTIME: Importing and monkey-patching took 6.536006927490234 ms
2022-09-22 01:30:01 INFO  ---RUNTIME: Original pipeline execution took 10757.361650466919 ms (excluding imports and monkey-patching)
2022-09-22 01:30:01 INFO  Starting execution of 1 what-if analyses...
2022-09-22 01:30:01 INFO  Start plan generation for analysis DataCorruption...
2022-09-22 01:30:01 INFO  ---RUNTIME: Plan generation took 0.6084442138671875 ms
2022-09-22 01:30:01 INFO  Estimated runtime of original DAG is 8952.364683151245ms
2022-09-22 01:30:01 INFO  Performing Multi-Query Optimization
2022-09-22 01:30:01 INFO  Estimated unoptimized what-if runtime is 223809.11707878113ms
2022-09-22 01:30:01 INFO  Estimated optimised what-if runtime is 20941.230058670044ms
2022-09-22 01:30:01 INFO  Estimated optimisation runtime saving is 202867.88702011108ms
2022-09-22 01:30:01 INFO  ---RUNTIME: Multi-Query Optimization took 109.24935340881348 ms
2022-09-22 01:30:01 INFO  Executing generated plans
2022-09-22 01:30:26 INFO  ---RUNTIME: Execution took 24543.272018432617 ms
2022-09-22 01:30:26 INFO  Done!
2022-09-22 01:30:26 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-22 01:30:26 INFO  Running instrumented original pipeline...
2022-09-22 01:30:26 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-22 01:30:26 INFO  ---RUNTIME: Importing and monkey-patching took 6.263017654418945 ms
2022-09-22 01:30:35 INFO  ---RUNTIME: Original pipeline execution took 8981.961965560913 ms (excluding imports and monkey-patching)
2022-09-22 01:30:35 INFO  Starting execution of 1 what-if analyses...
2022-09-22 01:30:35 INFO  Start plan generation for analysis DataCorruption...
2022-09-22 01:30:35 INFO  ---RUNTIME: Plan generation took 0.5304813385009766 ms
2022-09-22 01:30:35 INFO  Estimated runtime of original DAG is 7687.848091125488ms
2022-09-22 01:30:35 WARNING Skipping Multi-Query Optimization (instead, only applying patches)
2022-09-22 01:30:35 INFO  Estimated unoptimised what-if runtime is 192196.2022781372ms
2022-09-22 01:30:35 INFO  ---RUNTIME: Multi-Query Optimization took 35.72845458984375 ms
2022-09-22 01:30:35 INFO  Executing generated plans
2022-09-22 01:34:26 INFO  ---RUNTIME: Execution took 231034.2447757721 ms
2022-09-22 01:34:26 INFO  Done!
2022-09-22 01:34:26 INFO  # Finished -- repetition 2 of 7 
2022-09-22 01:34:26 INFO  # Optimization benchmark for data_corruption with args [['reviews', 'slow_loading', 'featurization_2', 'logistic_regression']] -- repetition 3 of 7
2022-09-22 01:34:26 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-22 01:34:26 INFO  Running instrumented original pipeline...
2022-09-22 01:34:26 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-22 01:34:26 INFO  ---RUNTIME: Importing and monkey-patching took 6.181955337524414 ms
2022-09-22 01:34:36 INFO  ---RUNTIME: Original pipeline execution took 10399.463891983032 ms (excluding imports and monkey-patching)
2022-09-22 01:34:36 INFO  Starting execution of 1 what-if analyses...
2022-09-22 01:34:36 INFO  Start plan generation for analysis DataCorruption...
2022-09-22 01:34:36 INFO  ---RUNTIME: Plan generation took 0.5927085876464844 ms
2022-09-22 01:34:36 INFO  Estimated runtime of original DAG is 8414.2906665802ms
2022-09-22 01:34:36 INFO  Performing Multi-Query Optimization
2022-09-22 01:34:36 INFO  Estimated unoptimized what-if runtime is 210357.266664505ms
2022-09-22 01:34:36 INFO  Estimated optimised what-if runtime is 20172.622680664062ms
2022-09-22 01:34:36 INFO  Estimated optimisation runtime saving is 190184.64398384094ms
2022-09-22 01:34:36 INFO  ---RUNTIME: Multi-Query Optimization took 104.42566871643066 ms
2022-09-22 01:34:36 INFO  Executing generated plans
2022-09-22 01:35:05 INFO  ---RUNTIME: Execution took 28857.218742370605 ms
2022-09-22 01:35:05 INFO  Done!
2022-09-22 01:35:05 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-22 01:35:05 INFO  Running instrumented original pipeline...
2022-09-22 01:35:06 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-22 01:35:06 INFO  ---RUNTIME: Importing and monkey-patching took 6.566762924194336 ms
2022-09-22 01:35:17 INFO  ---RUNTIME: Original pipeline execution took 11390.110731124878 ms (excluding imports and monkey-patching)
2022-09-22 01:35:17 INFO  Starting execution of 1 what-if analyses...
2022-09-22 01:35:17 INFO  Start plan generation for analysis DataCorruption...
2022-09-22 01:35:17 INFO  ---RUNTIME: Plan generation took 0.5321502685546875 ms
2022-09-22 01:35:17 INFO  Estimated runtime of original DAG is 9265.58542251587ms
2022-09-22 01:35:17 WARNING Skipping Multi-Query Optimization (instead, only applying patches)
2022-09-22 01:35:17 INFO  Estimated unoptimised what-if runtime is 231639.63556289673ms
2022-09-22 01:35:17 INFO  ---RUNTIME: Multi-Query Optimization took 28.435230255126953 ms
2022-09-22 01:35:17 INFO  Executing generated plans
2022-09-22 01:39:48 INFO  ---RUNTIME: Execution took 271407.0439338684 ms
2022-09-22 01:39:48 INFO  Done!
2022-09-22 01:39:48 INFO  # Finished -- repetition 3 of 7 
2022-09-22 01:39:48 INFO  # Optimization benchmark for data_corruption with args [['reviews', 'slow_loading', 'featurization_2', 'logistic_regression']] -- repetition 4 of 7
2022-09-22 01:39:48 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-22 01:39:48 INFO  Running instrumented original pipeline...
2022-09-22 01:39:48 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-22 01:39:48 INFO  ---RUNTIME: Importing and monkey-patching took 8.260488510131836 ms
2022-09-22 01:39:59 INFO  ---RUNTIME: Original pipeline execution took 10598.53720664978 ms (excluding imports and monkey-patching)
2022-09-22 01:39:59 INFO  Starting execution of 1 what-if analyses...
2022-09-22 01:39:59 INFO  Start plan generation for analysis DataCorruption...
2022-09-22 01:39:59 INFO  ---RUNTIME: Plan generation took 0.4565715789794922 ms
2022-09-22 01:39:59 INFO  Estimated runtime of original DAG is 8735.702514648438ms
2022-09-22 01:39:59 INFO  Performing Multi-Query Optimization
2022-09-22 01:39:59 INFO  Estimated unoptimized what-if runtime is 218392.56286621094ms
2022-09-22 01:39:59 INFO  Estimated optimised what-if runtime is 19269.094467163086ms
2022-09-22 01:39:59 INFO  Estimated optimisation runtime saving is 199123.46839904785ms
2022-09-22 01:39:59 INFO  ---RUNTIME: Multi-Query Optimization took 69.51689720153809 ms
2022-09-22 01:39:59 INFO  Executing generated plans
2022-09-22 01:40:23 INFO  ---RUNTIME: Execution took 23853.900909423828 ms
2022-09-22 01:40:23 INFO  Done!
2022-09-22 01:40:23 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-22 01:40:23 INFO  Running instrumented original pipeline...
2022-09-22 01:40:23 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-22 01:40:23 INFO  ---RUNTIME: Importing and monkey-patching took 5.919933319091797 ms
2022-09-22 01:40:33 INFO  ---RUNTIME: Original pipeline execution took 10417.825698852539 ms (excluding imports and monkey-patching)
2022-09-22 01:40:33 INFO  Starting execution of 1 what-if analyses...
2022-09-22 01:40:33 INFO  Start plan generation for analysis DataCorruption...
2022-09-22 01:40:33 INFO  ---RUNTIME: Plan generation took 0.6394386291503906 ms
2022-09-22 01:40:33 INFO  Estimated runtime of original DAG is 8367.160320281982ms
2022-09-22 01:40:33 WARNING Skipping Multi-Query Optimization (instead, only applying patches)
2022-09-22 01:40:33 INFO  Estimated unoptimised what-if runtime is 209179.00800704956ms
2022-09-22 01:40:33 INFO  ---RUNTIME: Multi-Query Optimization took 29.98495101928711 ms
2022-09-22 01:40:33 INFO  Executing generated plans
2022-09-22 01:44:32 INFO  ---RUNTIME: Execution took 238581.98809623718 ms
2022-09-22 01:44:32 INFO  Done!
2022-09-22 01:44:32 INFO  # Finished -- repetition 4 of 7 
2022-09-22 01:44:32 INFO  # Optimization benchmark for data_corruption with args [['reviews', 'slow_loading', 'featurization_2', 'logistic_regression']] -- repetition 5 of 7
2022-09-22 01:44:32 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-22 01:44:32 INFO  Running instrumented original pipeline...
2022-09-22 01:44:32 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-22 01:44:32 INFO  ---RUNTIME: Importing and monkey-patching took 7.767677307128906 ms
2022-09-22 01:44:43 INFO  ---RUNTIME: Original pipeline execution took 10909.395217895508 ms (excluding imports and monkey-patching)
2022-09-22 01:44:43 INFO  Starting execution of 1 what-if analyses...
2022-09-22 01:44:43 INFO  Start plan generation for analysis DataCorruption...
2022-09-22 01:44:43 INFO  ---RUNTIME: Plan generation took 0.45013427734375 ms
2022-09-22 01:44:43 INFO  Estimated runtime of original DAG is 9068.25590133667ms
2022-09-22 01:44:43 INFO  Performing Multi-Query Optimization
2022-09-22 01:44:43 INFO  Estimated unoptimized what-if runtime is 226706.39753341675ms
2022-09-22 01:44:43 INFO  Estimated optimised what-if runtime is 20662.251710891724ms
2022-09-22 01:44:43 INFO  Estimated optimisation runtime saving is 206044.14582252502ms
2022-09-22 01:44:43 INFO  ---RUNTIME: Multi-Query Optimization took 67.71349906921387 ms
2022-09-22 01:44:43 INFO  Executing generated plans
2022-09-22 01:45:07 INFO  ---RUNTIME: Execution took 23954.261302947998 ms
2022-09-22 01:45:07 INFO  Done!
2022-09-22 01:45:07 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-22 01:45:07 INFO  Running instrumented original pipeline...
2022-09-22 01:45:07 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-22 01:45:07 INFO  ---RUNTIME: Importing and monkey-patching took 6.227731704711914 ms
2022-09-22 01:45:15 INFO  ---RUNTIME: Original pipeline execution took 8202.765941619873 ms (excluding imports and monkey-patching)
2022-09-22 01:45:15 INFO  Starting execution of 1 what-if analyses...
2022-09-22 01:45:15 INFO  Start plan generation for analysis DataCorruption...
2022-09-22 01:45:15 INFO  ---RUNTIME: Plan generation took 13.065814971923828 ms
2022-09-22 01:45:15 INFO  Estimated runtime of original DAG is 6979.788303375244ms
2022-09-22 01:45:15 WARNING Skipping Multi-Query Optimization (instead, only applying patches)
2022-09-22 01:45:15 INFO  Estimated unoptimised what-if runtime is 174494.7075843811ms
2022-09-22 01:45:15 INFO  ---RUNTIME: Multi-Query Optimization took 497.8039264678955 ms
2022-09-22 01:45:15 INFO  Executing generated plans
2022-09-22 01:49:33 INFO  ---RUNTIME: Execution took 257553.2910823822 ms
2022-09-22 01:49:33 INFO  Done!
2022-09-22 01:49:33 INFO  # Finished -- repetition 5 of 7 
2022-09-22 01:49:33 INFO  # Optimization benchmark for data_corruption with args [['reviews', 'slow_loading', 'featurization_2', 'logistic_regression']] -- repetition 6 of 7
2022-09-22 01:49:33 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-22 01:49:33 INFO  Running instrumented original pipeline...
2022-09-22 01:49:33 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-22 01:49:33 INFO  ---RUNTIME: Importing and monkey-patching took 8.879899978637695 ms
2022-09-22 01:49:44 INFO  ---RUNTIME: Original pipeline execution took 10924.169778823853 ms (excluding imports and monkey-patching)
2022-09-22 01:49:44 INFO  Starting execution of 1 what-if analyses...
2022-09-22 01:49:44 INFO  Start plan generation for analysis DataCorruption...
2022-09-22 01:49:44 INFO  ---RUNTIME: Plan generation took 0.5910396575927734 ms
2022-09-22 01:49:44 INFO  Estimated runtime of original DAG is 9084.779977798462ms
2022-09-22 01:49:44 INFO  Performing Multi-Query Optimization
2022-09-22 01:49:44 INFO  Estimated unoptimized what-if runtime is 227119.49944496155ms
2022-09-22 01:49:44 INFO  Estimated optimised what-if runtime is 20864.561796188354ms
2022-09-22 01:49:44 INFO  Estimated optimisation runtime saving is 206254.9376487732ms
2022-09-22 01:49:44 INFO  ---RUNTIME: Multi-Query Optimization took 105.07750511169434 ms
2022-09-22 01:49:44 INFO  Executing generated plans
2022-09-22 01:50:14 INFO  ---RUNTIME: Execution took 29548.87580871582 ms
2022-09-22 01:50:14 INFO  Done!
2022-09-22 01:50:14 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-22 01:50:14 INFO  Running instrumented original pipeline...
2022-09-22 01:50:14 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-22 01:50:14 INFO  ---RUNTIME: Importing and monkey-patching took 8.847951889038086 ms
2022-09-22 01:50:25 INFO  ---RUNTIME: Original pipeline execution took 10855.477571487427 ms (excluding imports and monkey-patching)
2022-09-22 01:50:25 INFO  Starting execution of 1 what-if analyses...
2022-09-22 01:50:25 INFO  Start plan generation for analysis DataCorruption...
2022-09-22 01:50:25 INFO  ---RUNTIME: Plan generation took 0.5366802215576172 ms
2022-09-22 01:50:25 INFO  Estimated runtime of original DAG is 9003.408670425415ms
2022-09-22 01:50:25 WARNING Skipping Multi-Query Optimization (instead, only applying patches)
2022-09-22 01:50:25 INFO  Estimated unoptimised what-if runtime is 225085.21676063538ms
2022-09-22 01:50:25 INFO  ---RUNTIME: Multi-Query Optimization took 26.804685592651367 ms
2022-09-22 01:50:25 INFO  Executing generated plans
2022-09-22 01:54:32 INFO  ---RUNTIME: Execution took 246985.12816429138 ms
2022-09-22 01:54:32 INFO  Done!
2022-09-22 01:54:32 INFO  # Finished -- repetition 6 of 7 
2022-09-22 01:54:32 INFO  # Optimization benchmark for data_corruption with args [['reviews', 'slow_loading', 'featurization_2', 'logistic_regression']] -- repetition 7 of 7
2022-09-22 01:54:32 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-22 01:54:32 INFO  Running instrumented original pipeline...
2022-09-22 01:54:32 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-22 01:54:32 INFO  ---RUNTIME: Importing and monkey-patching took 6.129741668701172 ms
2022-09-22 01:54:42 INFO  ---RUNTIME: Original pipeline execution took 10713.141679763794 ms (excluding imports and monkey-patching)
2022-09-22 01:54:42 INFO  Starting execution of 1 what-if analyses...
2022-09-22 01:54:42 INFO  Start plan generation for analysis DataCorruption...
2022-09-22 01:54:42 INFO  ---RUNTIME: Plan generation took 3.0698776245117188 ms
2022-09-22 01:54:42 INFO  Estimated runtime of original DAG is 8800.138235092163ms
2022-09-22 01:54:42 INFO  Performing Multi-Query Optimization
2022-09-22 01:54:42 INFO  Estimated unoptimized what-if runtime is 220003.45587730408ms
2022-09-22 01:54:42 INFO  Estimated optimised what-if runtime is 20771.94857597351ms
2022-09-22 01:54:42 INFO  Estimated optimisation runtime saving is 199231.50730133057ms
2022-09-22 01:54:42 INFO  ---RUNTIME: Multi-Query Optimization took 116.33610725402832 ms
2022-09-22 01:54:42 INFO  Executing generated plans
2022-09-22 01:55:07 INFO  ---RUNTIME: Execution took 24838.214635849 ms
2022-09-22 01:55:07 INFO  Done!
2022-09-22 01:55:07 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-22 01:55:07 INFO  Running instrumented original pipeline...
2022-09-22 01:55:07 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-22 01:55:07 INFO  ---RUNTIME: Importing and monkey-patching took 5.958318710327148 ms
2022-09-22 01:55:16 INFO  ---RUNTIME: Original pipeline execution took 8714.971780776978 ms (excluding imports and monkey-patching)
2022-09-22 01:55:16 INFO  Starting execution of 1 what-if analyses...
2022-09-22 01:55:16 INFO  Start plan generation for analysis DataCorruption...
2022-09-22 01:55:16 INFO  ---RUNTIME: Plan generation took 0.5335807800292969 ms
2022-09-22 01:55:16 INFO  Estimated runtime of original DAG is 7463.546276092529ms
2022-09-22 01:55:16 WARNING Skipping Multi-Query Optimization (instead, only applying patches)
2022-09-22 01:55:16 INFO  Estimated unoptimised what-if runtime is 186588.65690231323ms
2022-09-22 01:55:16 INFO  ---RUNTIME: Multi-Query Optimization took 30.75718879699707 ms
2022-09-22 01:55:16 INFO  Executing generated plans
2022-09-22 01:59:12 INFO  ---RUNTIME: Execution took 236033.35309028625 ms
2022-09-22 01:59:12 INFO  Done!
2022-09-22 01:59:12 INFO  # Finished -- repetition 7 of 7 
2022-09-22 01:59:12 INFO  # Final results after all repetitions
2022-09-22 01:59:12 INFO     repetition  ... no_opt_what_if_execution_combined_model_training
0           0  ...                                      4065.010071
1           1  ...                                      3711.702824
2           2  ...                                      4653.185368
3           3  ...                                      3924.142361
4           4  ...                                      4127.583742
5           5  ...                                      3816.399574
6           6  ...                                      3580.157995

[7 rows x 26 columns]
taskset -c 32-39 PROTOCOL_BUFFERS_PYTHON_IMPLEMENTATION=python python3.9 benchmarks_end_to_end.py data_corruption reviews slow_loading featurization_2 xgboost
2022-09-22 01:59:14.733346: W tensorflow/stream_executor/platform/default/dso_loader.cc:64] Could not load dynamic library 'libcudart.so.11.0'; dlerror: libcudart.so.11.0: cannot open shared object file: No such file or directory; LD_LIBRARY_PATH: /home/sgrafbe/mlwhatif/venv/lib/python3.9/site-packages/cv2/../../lib64:
2022-09-22 01:59:14.733391: I tensorflow/stream_executor/cuda/cudart_stub.cc:29] Ignore above cudart dlerror if you do not have a GPU set up on your machine.
2022-09-22 01:59:15 INFO  Patching sys.argv with ['mlwhatif', 'reviews', 'slow_loading', 'featurization_2', 'xgboost']
2022-09-22 01:59:15 INFO  Running instrumented original pipeline...
2022-09-22 01:59:15 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-22 01:59:16 INFO  ---RUNTIME: Importing and monkey-patching took 95.6268310546875 ms
2022-09-22 01:59:40 INFO  ---RUNTIME: Original pipeline execution took 24062.19458580017 ms (excluding imports and monkey-patching)
2022-09-22 01:59:40 INFO  Starting execution of 0 what-if analyses...
2022-09-22 01:59:40 INFO  Estimated runtime of original DAG is 22837.96525001526ms
2022-09-22 01:59:40 INFO  Performing Multi-Query Optimization
2022-09-22 01:59:40 INFO  Estimated unoptimized what-if runtime is 0ms
2022-09-22 01:59:40 INFO  Estimated optimised what-if runtime is 0ms
2022-09-22 01:59:40 INFO  Estimated optimisation runtime saving is 0ms
2022-09-22 01:59:40 INFO  ---RUNTIME: Multi-Query Optimization took 0.8857250213623047 ms
2022-09-22 01:59:40 INFO  Executing generated plans
2022-09-22 01:59:40 INFO  ---RUNTIME: Execution took 0.033855438232421875 ms
2022-09-22 01:59:40 INFO  Done!
2022-09-22 01:59:40 INFO  # Optimization benchmark for data_corruption with args [['reviews', 'slow_loading', 'featurization_2', 'xgboost']] -- repetition 1 of 7
2022-09-22 01:59:40 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-22 01:59:40 INFO  Running instrumented original pipeline...
2022-09-22 01:59:40 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-22 01:59:40 INFO  ---RUNTIME: Importing and monkey-patching took 11.384248733520508 ms
2022-09-22 02:00:07 INFO  ---RUNTIME: Original pipeline execution took 27097.878456115723 ms (excluding imports and monkey-patching)
2022-09-22 02:00:07 INFO  Starting execution of 1 what-if analyses...
2022-09-22 02:00:07 INFO  Start plan generation for analysis DataCorruption...
2022-09-22 02:00:07 INFO  ---RUNTIME: Plan generation took 0.6155967712402344 ms
2022-09-22 02:00:07 INFO  Estimated runtime of original DAG is 25411.86285018921ms
2022-09-22 02:00:07 INFO  Performing Multi-Query Optimization
2022-09-22 02:00:07 INFO  Estimated unoptimized what-if runtime is 635296.5712547302ms
2022-09-22 02:00:07 INFO  Estimated optimised what-if runtime is 41001.574993133545ms
2022-09-22 02:00:07 INFO  Estimated optimisation runtime saving is 594294.9962615967ms
2022-09-22 02:00:07 INFO  ---RUNTIME: Multi-Query Optimization took 118.44897270202637 ms
2022-09-22 02:00:07 INFO  Executing generated plans
2022-09-22 02:00:54 INFO  ---RUNTIME: Execution took 47215.63458442688 ms
2022-09-22 02:00:54 INFO  Done!
2022-09-22 02:00:54 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-22 02:00:54 INFO  Running instrumented original pipeline...
2022-09-22 02:00:54 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-22 02:00:54 INFO  ---RUNTIME: Importing and monkey-patching took 10.849952697753906 ms
2022-09-22 02:01:21 INFO  ---RUNTIME: Original pipeline execution took 27390.57755470276 ms (excluding imports and monkey-patching)
2022-09-22 02:01:21 INFO  Starting execution of 1 what-if analyses...
2022-09-22 02:01:21 INFO  Start plan generation for analysis DataCorruption...
2022-09-22 02:01:21 INFO  ---RUNTIME: Plan generation took 0.5996227264404297 ms
2022-09-22 02:01:21 INFO  Estimated runtime of original DAG is 25353.128671646118ms
2022-09-22 02:01:21 WARNING Skipping Multi-Query Optimization (instead, only applying patches)
2022-09-22 02:01:22 INFO  Estimated unoptimised what-if runtime is 633828.216791153ms
2022-09-22 02:01:22 INFO  ---RUNTIME: Multi-Query Optimization took 37.65869140625 ms
2022-09-22 02:01:22 INFO  Executing generated plans
2022-09-22 02:11:53 INFO  ---RUNTIME: Execution took 631405.8248996735 ms
2022-09-22 02:11:53 INFO  Done!
2022-09-22 02:11:53 INFO  # Finished -- repetition 1 of 7 
2022-09-22 02:11:53 INFO  # Optimization benchmark for data_corruption with args [['reviews', 'slow_loading', 'featurization_2', 'xgboost']] -- repetition 2 of 7
2022-09-22 02:11:53 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-22 02:11:53 INFO  Running instrumented original pipeline...
2022-09-22 02:11:53 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-22 02:11:53 INFO  ---RUNTIME: Importing and monkey-patching took 8.426427841186523 ms
2022-09-22 02:12:17 INFO  ---RUNTIME: Original pipeline execution took 24540.37618637085 ms (excluding imports and monkey-patching)
2022-09-22 02:12:17 INFO  Starting execution of 1 what-if analyses...
2022-09-22 02:12:17 INFO  Start plan generation for analysis DataCorruption...
2022-09-22 02:12:17 INFO  ---RUNTIME: Plan generation took 0.6012916564941406 ms
2022-09-22 02:12:17 INFO  Estimated runtime of original DAG is 22991.0888671875ms
2022-09-22 02:12:17 INFO  Performing Multi-Query Optimization
2022-09-22 02:12:18 INFO  Estimated unoptimized what-if runtime is 574777.2216796875ms
2022-09-22 02:12:18 INFO  Estimated optimised what-if runtime is 36846.08721733093ms
2022-09-22 02:12:18 INFO  Estimated optimisation runtime saving is 537931.1344623566ms
2022-09-22 02:12:18 INFO  ---RUNTIME: Multi-Query Optimization took 107.25760459899902 ms
2022-09-22 02:12:18 INFO  Executing generated plans
2022-09-22 02:13:00 INFO  ---RUNTIME: Execution took 42331.06517791748 ms
2022-09-22 02:13:00 INFO  Done!
2022-09-22 02:13:00 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-22 02:13:00 INFO  Running instrumented original pipeline...
2022-09-22 02:13:00 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-22 02:13:00 INFO  ---RUNTIME: Importing and monkey-patching took 8.017778396606445 ms
2022-09-22 02:13:24 INFO  ---RUNTIME: Original pipeline execution took 24398.836851119995 ms (excluding imports and monkey-patching)
2022-09-22 02:13:24 INFO  Starting execution of 1 what-if analyses...
2022-09-22 02:13:24 INFO  Start plan generation for analysis DataCorruption...
2022-09-22 02:13:24 INFO  ---RUNTIME: Plan generation took 1.0268688201904297 ms
2022-09-22 02:13:24 INFO  Estimated runtime of original DAG is 22623.454332351685ms
2022-09-22 02:13:24 WARNING Skipping Multi-Query Optimization (instead, only applying patches)
2022-09-22 02:13:24 INFO  Estimated unoptimised what-if runtime is 565586.3583087921ms
2022-09-22 02:13:24 INFO  ---RUNTIME: Multi-Query Optimization took 32.75704383850098 ms
2022-09-22 02:13:24 INFO  Executing generated plans
2022-09-22 02:24:04 INFO  ---RUNTIME: Execution took 640078.4938335419 ms
2022-09-22 02:24:04 INFO  Done!
2022-09-22 02:24:04 INFO  # Finished -- repetition 2 of 7 
2022-09-22 02:24:04 INFO  # Optimization benchmark for data_corruption with args [['reviews', 'slow_loading', 'featurization_2', 'xgboost']] -- repetition 3 of 7
2022-09-22 02:24:04 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-22 02:24:04 INFO  Running instrumented original pipeline...
2022-09-22 02:24:05 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-22 02:24:05 INFO  ---RUNTIME: Importing and monkey-patching took 8.453607559204102 ms
2022-09-22 02:24:28 INFO  ---RUNTIME: Original pipeline execution took 23668.292760849 ms (excluding imports and monkey-patching)
2022-09-22 02:24:28 INFO  Starting execution of 1 what-if analyses...
2022-09-22 02:24:28 INFO  Start plan generation for analysis DataCorruption...
2022-09-22 02:24:28 INFO  ---RUNTIME: Plan generation took 0.5178451538085938 ms
2022-09-22 02:24:28 INFO  Estimated runtime of original DAG is 22443.639755249023ms
2022-09-22 02:24:28 INFO  Performing Multi-Query Optimization
2022-09-22 02:24:28 INFO  Estimated unoptimized what-if runtime is 561090.9938812256ms
2022-09-22 02:24:28 INFO  Estimated optimised what-if runtime is 35848.26683998108ms
2022-09-22 02:24:28 INFO  Estimated optimisation runtime saving is 525242.7270412445ms
2022-09-22 02:24:28 INFO  ---RUNTIME: Multi-Query Optimization took 103.00922393798828 ms
2022-09-22 02:24:28 INFO  Executing generated plans
2022-09-22 02:25:09 INFO  ---RUNTIME: Execution took 40472.66888618469 ms
2022-09-22 02:25:09 INFO  Done!
2022-09-22 02:25:09 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-22 02:25:09 INFO  Running instrumented original pipeline...
2022-09-22 02:25:09 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-22 02:25:09 INFO  ---RUNTIME: Importing and monkey-patching took 10.314702987670898 ms
2022-09-22 02:25:33 INFO  ---RUNTIME: Original pipeline execution took 24488.029718399048 ms (excluding imports and monkey-patching)
2022-09-22 02:25:33 INFO  Starting execution of 1 what-if analyses...
2022-09-22 02:25:33 INFO  Start plan generation for analysis DataCorruption...
2022-09-22 02:25:33 INFO  ---RUNTIME: Plan generation took 0.5347728729248047 ms
2022-09-22 02:25:33 INFO  Estimated runtime of original DAG is 22491.286039352417ms
2022-09-22 02:25:33 WARNING Skipping Multi-Query Optimization (instead, only applying patches)
2022-09-22 02:25:33 INFO  Estimated unoptimised what-if runtime is 562282.1509838104ms
2022-09-22 02:25:33 INFO  ---RUNTIME: Multi-Query Optimization took 28.001070022583008 ms
2022-09-22 02:25:33 INFO  Executing generated plans
2022-09-22 02:36:22 INFO  ---RUNTIME: Execution took 649036.3581180573 ms
2022-09-22 02:36:22 INFO  Done!
2022-09-22 02:36:22 INFO  # Finished -- repetition 3 of 7 
2022-09-22 02:36:22 INFO  # Optimization benchmark for data_corruption with args [['reviews', 'slow_loading', 'featurization_2', 'xgboost']] -- repetition 4 of 7
2022-09-22 02:36:22 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-22 02:36:22 INFO  Running instrumented original pipeline...
2022-09-22 02:36:22 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-22 02:36:22 INFO  ---RUNTIME: Importing and monkey-patching took 10.504961013793945 ms
2022-09-22 02:36:46 INFO  ---RUNTIME: Original pipeline execution took 23757.452726364136 ms (excluding imports and monkey-patching)
2022-09-22 02:36:46 INFO  Starting execution of 1 what-if analyses...
2022-09-22 02:36:46 INFO  Start plan generation for analysis DataCorruption...
2022-09-22 02:36:46 INFO  ---RUNTIME: Plan generation took 0.6244182586669922 ms
2022-09-22 02:36:46 INFO  Estimated runtime of original DAG is 22529.08444404602ms
2022-09-22 02:36:46 INFO  Performing Multi-Query Optimization
2022-09-22 02:36:46 INFO  Estimated unoptimized what-if runtime is 563227.1111011505ms
2022-09-22 02:36:46 INFO  Estimated optimised what-if runtime is 35644.131898880005ms
2022-09-22 02:36:46 INFO  Estimated optimisation runtime saving is 527582.9792022705ms
2022-09-22 02:36:46 INFO  ---RUNTIME: Multi-Query Optimization took 98.79422187805176 ms
2022-09-22 02:36:46 INFO  Executing generated plans
2022-09-22 02:37:26 INFO  ---RUNTIME: Execution took 40118.94965171814 ms
2022-09-22 02:37:26 INFO  Done!
2022-09-22 02:37:26 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-22 02:37:26 INFO  Running instrumented original pipeline...
2022-09-22 02:37:26 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-22 02:37:26 INFO  ---RUNTIME: Importing and monkey-patching took 8.796930313110352 ms
2022-09-22 02:37:52 INFO  ---RUNTIME: Original pipeline execution took 25211.870908737183 ms (excluding imports and monkey-patching)
2022-09-22 02:37:52 INFO  Starting execution of 1 what-if analyses...
2022-09-22 02:37:52 INFO  Start plan generation for analysis DataCorruption...
2022-09-22 02:37:52 INFO  ---RUNTIME: Plan generation took 0.6136894226074219 ms
2022-09-22 02:37:52 INFO  Estimated runtime of original DAG is 23528.33652496338ms
2022-09-22 02:37:52 WARNING Skipping Multi-Query Optimization (instead, only applying patches)
2022-09-22 02:37:52 INFO  Estimated unoptimised what-if runtime is 588208.4131240845ms
2022-09-22 02:37:52 INFO  ---RUNTIME: Multi-Query Optimization took 27.415990829467773 ms
2022-09-22 02:37:52 INFO  Executing generated plans
2022-09-22 02:48:29 INFO  ---RUNTIME: Execution took 637348.4129905701 ms
2022-09-22 02:48:29 INFO  Done!
2022-09-22 02:48:29 INFO  # Finished -- repetition 4 of 7 
2022-09-22 02:48:29 INFO  # Optimization benchmark for data_corruption with args [['reviews', 'slow_loading', 'featurization_2', 'xgboost']] -- repetition 5 of 7
2022-09-22 02:48:29 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-22 02:48:29 INFO  Running instrumented original pipeline...
2022-09-22 02:48:29 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-22 02:48:29 INFO  ---RUNTIME: Importing and monkey-patching took 7.505893707275391 ms
2022-09-22 02:48:55 INFO  ---RUNTIME: Original pipeline execution took 26103.0752658844 ms (excluding imports and monkey-patching)
2022-09-22 02:48:55 INFO  Starting execution of 1 what-if analyses...
2022-09-22 02:48:55 INFO  Start plan generation for analysis DataCorruption...
2022-09-22 02:48:55 INFO  ---RUNTIME: Plan generation took 0.48804283142089844 ms
2022-09-22 02:48:55 INFO  Estimated runtime of original DAG is 24252.004146575928ms
2022-09-22 02:48:55 INFO  Performing Multi-Query Optimization
2022-09-22 02:48:55 INFO  Estimated unoptimized what-if runtime is 606300.1036643982ms
2022-09-22 02:48:55 INFO  Estimated optimised what-if runtime is 34931.164026260376ms
2022-09-22 02:48:55 INFO  Estimated optimisation runtime saving is 571368.9396381378ms
2022-09-22 02:48:55 INFO  ---RUNTIME: Multi-Query Optimization took 86.75336837768555 ms
2022-09-22 02:48:55 INFO  Executing generated plans
2022-09-22 02:49:36 INFO  ---RUNTIME: Execution took 40904.67643737793 ms
2022-09-22 02:49:36 INFO  Done!
2022-09-22 02:49:36 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-22 02:49:36 INFO  Running instrumented original pipeline...
2022-09-22 02:49:36 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-22 02:49:36 INFO  ---RUNTIME: Importing and monkey-patching took 6.200313568115234 ms
2022-09-22 02:50:00 INFO  ---RUNTIME: Original pipeline execution took 23593.170404434204 ms (excluding imports and monkey-patching)
2022-09-22 02:50:00 INFO  Starting execution of 1 what-if analyses...
2022-09-22 02:50:00 INFO  Start plan generation for analysis DataCorruption...
2022-09-22 02:50:00 INFO  ---RUNTIME: Plan generation took 0.44727325439453125 ms
2022-09-22 02:50:00 INFO  Estimated runtime of original DAG is 22318.599224090576ms
2022-09-22 02:50:00 WARNING Skipping Multi-Query Optimization (instead, only applying patches)
2022-09-22 02:50:00 INFO  Estimated unoptimised what-if runtime is 557964.9806022644ms
2022-09-22 02:50:00 INFO  ---RUNTIME: Multi-Query Optimization took 245.59760093688965 ms
2022-09-22 02:50:00 INFO  Executing generated plans
2022-09-22 02:59:56 INFO  ---RUNTIME: Execution took 596346.8890190125 ms
2022-09-22 02:59:56 INFO  Done!
2022-09-22 02:59:56 INFO  # Finished -- repetition 5 of 7 
2022-09-22 02:59:56 INFO  # Optimization benchmark for data_corruption with args [['reviews', 'slow_loading', 'featurization_2', 'xgboost']] -- repetition 6 of 7
2022-09-22 02:59:56 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-22 02:59:56 INFO  Running instrumented original pipeline...
2022-09-22 02:59:56 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-22 02:59:56 INFO  ---RUNTIME: Importing and monkey-patching took 6.200551986694336 ms
2022-09-22 03:00:17 INFO  ---RUNTIME: Original pipeline execution took 20547.526121139526 ms (excluding imports and monkey-patching)
2022-09-22 03:00:17 INFO  Starting execution of 1 what-if analyses...
2022-09-22 03:00:17 INFO  Start plan generation for analysis DataCorruption...
2022-09-22 03:00:17 INFO  ---RUNTIME: Plan generation took 0.537872314453125 ms
2022-09-22 03:00:17 INFO  Estimated runtime of original DAG is 19272.048234939575ms
2022-09-22 03:00:17 INFO  Performing Multi-Query Optimization
2022-09-22 03:00:17 INFO  Estimated unoptimized what-if runtime is 481801.2058734894ms
2022-09-22 03:00:17 INFO  Estimated optimised what-if runtime is 29130.800247192383ms
2022-09-22 03:00:17 INFO  Estimated optimisation runtime saving is 452670.405626297ms
2022-09-22 03:00:17 INFO  ---RUNTIME: Multi-Query Optimization took 72.3121166229248 ms
2022-09-22 03:00:17 INFO  Executing generated plans
2022-09-22 03:00:52 INFO  ---RUNTIME: Execution took 34639.72473144531 ms
2022-09-22 03:00:52 INFO  Done!
2022-09-22 03:00:52 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-22 03:00:52 INFO  Running instrumented original pipeline...
2022-09-22 03:00:52 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-22 03:00:52 INFO  ---RUNTIME: Importing and monkey-patching took 6.7291259765625 ms
2022-09-22 03:01:12 INFO  ---RUNTIME: Original pipeline execution took 20310.906648635864 ms (excluding imports and monkey-patching)
2022-09-22 03:01:12 INFO  Starting execution of 1 what-if analyses...
2022-09-22 03:01:12 INFO  Start plan generation for analysis DataCorruption...
2022-09-22 03:01:12 INFO  ---RUNTIME: Plan generation took 0.4742145538330078 ms
2022-09-22 03:01:12 INFO  Estimated runtime of original DAG is 19037.850856781006ms
2022-09-22 03:01:12 WARNING Skipping Multi-Query Optimization (instead, only applying patches)
2022-09-22 03:01:12 INFO  Estimated unoptimised what-if runtime is 475946.27141952515ms
2022-09-22 03:01:12 INFO  ---RUNTIME: Multi-Query Optimization took 22.4609375 ms
2022-09-22 03:01:12 INFO  Executing generated plans
2022-09-22 03:10:13 INFO  ---RUNTIME: Execution took 541259.6273422241 ms
2022-09-22 03:10:13 INFO  Done!
2022-09-22 03:10:13 INFO  # Finished -- repetition 6 of 7 
2022-09-22 03:10:13 INFO  # Optimization benchmark for data_corruption with args [['reviews', 'slow_loading', 'featurization_2', 'xgboost']] -- repetition 7 of 7
2022-09-22 03:10:13 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-22 03:10:13 INFO  Running instrumented original pipeline...
2022-09-22 03:10:13 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-22 03:10:13 INFO  ---RUNTIME: Importing and monkey-patching took 6.927490234375 ms
2022-09-22 03:10:35 INFO  ---RUNTIME: Original pipeline execution took 21398.26536178589 ms (excluding imports and monkey-patching)
2022-09-22 03:10:35 INFO  Starting execution of 1 what-if analyses...
2022-09-22 03:10:35 INFO  Start plan generation for analysis DataCorruption...
2022-09-22 03:10:35 INFO  ---RUNTIME: Plan generation took 0.46753883361816406 ms
2022-09-22 03:10:35 INFO  Estimated runtime of original DAG is 20144.211769104004ms
2022-09-22 03:10:35 INFO  Performing Multi-Query Optimization
2022-09-22 03:10:35 INFO  Estimated unoptimized what-if runtime is 503605.2942276001ms
2022-09-22 03:10:35 INFO  Estimated optimised what-if runtime is 29980.475187301636ms
2022-09-22 03:10:35 INFO  Estimated optimisation runtime saving is 473624.81904029846ms
2022-09-22 03:10:35 INFO  ---RUNTIME: Multi-Query Optimization took 68.41111183166504 ms
2022-09-22 03:10:35 INFO  Executing generated plans
2022-09-22 03:11:09 INFO  ---RUNTIME: Execution took 34623.02207946777 ms
2022-09-22 03:11:09 INFO  Done!
2022-09-22 03:11:09 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-22 03:11:09 INFO  Running instrumented original pipeline...
2022-09-22 03:11:09 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-22 03:11:09 INFO  ---RUNTIME: Importing and monkey-patching took 6.167411804199219 ms
2022-09-22 03:11:30 INFO  ---RUNTIME: Original pipeline execution took 20695.10579109192 ms (excluding imports and monkey-patching)
2022-09-22 03:11:30 INFO  Starting execution of 1 what-if analyses...
2022-09-22 03:11:30 INFO  Start plan generation for analysis DataCorruption...
2022-09-22 03:11:30 INFO  ---RUNTIME: Plan generation took 0.42629241943359375 ms
2022-09-22 03:11:30 INFO  Estimated runtime of original DAG is 19477.455377578735ms
2022-09-22 03:11:30 WARNING Skipping Multi-Query Optimization (instead, only applying patches)
2022-09-22 03:11:30 INFO  Estimated unoptimised what-if runtime is 486936.3844394684ms
2022-09-22 03:11:30 INFO  ---RUNTIME: Multi-Query Optimization took 19.354820251464844 ms
2022-09-22 03:11:30 INFO  Executing generated plans
2022-09-22 03:20:25 INFO  ---RUNTIME: Execution took 535225.504398346 ms
2022-09-22 03:20:25 INFO  Done!
2022-09-22 03:20:25 INFO  # Finished -- repetition 7 of 7 
2022-09-22 03:20:25 INFO  # Final results after all repetitions
2022-09-22 03:20:25 INFO     repetition  ... no_opt_what_if_execution_combined_model_training
0           0  ...                                    396528.473139
1           1  ...                                    394551.938057
2           2  ...                                    401735.857487
3           3  ...                                    391569.578886
4           4  ...                                    356601.609230
5           5  ...                                    351610.673428
6           6  ...                                    350266.127586

[7 rows x 26 columns]
taskset -c 32-39 PROTOCOL_BUFFERS_PYTHON_IMPLEMENTATION=python python3.9 benchmarks_end_to_end.py data_corruption reviews slow_loading featurization_2 neural_network
2022-09-22 03:20:27.912314: W tensorflow/stream_executor/platform/default/dso_loader.cc:64] Could not load dynamic library 'libcudart.so.11.0'; dlerror: libcudart.so.11.0: cannot open shared object file: No such file or directory; LD_LIBRARY_PATH: /home/sgrafbe/mlwhatif/venv/lib/python3.9/site-packages/cv2/../../lib64:
2022-09-22 03:20:27.912355: I tensorflow/stream_executor/cuda/cudart_stub.cc:29] Ignore above cudart dlerror if you do not have a GPU set up on your machine.
2022-09-22 03:20:29 INFO  Patching sys.argv with ['mlwhatif', 'reviews', 'slow_loading', 'featurization_2', 'neural_network']
2022-09-22 03:20:29 INFO  Running instrumented original pipeline...
2022-09-22 03:20:29 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-22 03:20:29 INFO  ---RUNTIME: Importing and monkey-patching took 99.58004951477051 ms
2022-09-22 03:20:35.447467: W tensorflow/stream_executor/platform/default/dso_loader.cc:64] Could not load dynamic library 'libcuda.so.1'; dlerror: libcuda.so.1: cannot open shared object file: No such file or directory; LD_LIBRARY_PATH: /home/sgrafbe/mlwhatif/venv/lib/python3.9/site-packages/cv2/../../lib64:
2022-09-22 03:20:35.447506: W tensorflow/stream_executor/cuda/cuda_driver.cc:326] failed call to cuInit: UNKNOWN ERROR (303)
2022-09-22 03:20:35.447529: I tensorflow/stream_executor/cuda/cuda_diagnostics.cc:156] kernel driver does not appear to be running on this host (wagyu): /proc/driver/nvidia/version does not exist
2022-09-22 03:20:35.448003: I tensorflow/core/platform/cpu_feature_guard.cc:142] This TensorFlow binary is optimized with oneAPI Deep Neural Network Library (oneDNN) to use the following CPU instructions in performance-critical operations:  AVX2 FMA
To enable them in other operations, rebuild TensorFlow with the appropriate compiler flags.
2022-09-22 03:20:36.120755: I tensorflow/compiler/mlir/mlir_graph_optimization_pass.cc:176] None of the MLIR Optimization Passes are enabled (registered 2)
2022-09-22 03:20:36.134377: I tensorflow/core/platform/profile_utils/cpu_utils.cc:114] CPU Frequency: 2595290000 Hz
2022-09-22 03:20:44 INFO  ---RUNTIME: Original pipeline execution took 15443.862915039062 ms (excluding imports and monkey-patching)
2022-09-22 03:20:44 INFO  Starting execution of 0 what-if analyses...
2022-09-22 03:20:44 INFO  Estimated runtime of original DAG is 14148.388147354126ms
2022-09-22 03:20:44 INFO  Performing Multi-Query Optimization
2022-09-22 03:20:44 INFO  Estimated unoptimized what-if runtime is 0ms
2022-09-22 03:20:44 INFO  Estimated optimised what-if runtime is 0ms
2022-09-22 03:20:44 INFO  Estimated optimisation runtime saving is 0ms
2022-09-22 03:20:44 INFO  ---RUNTIME: Multi-Query Optimization took 0.5373954772949219 ms
2022-09-22 03:20:44 INFO  Executing generated plans
2022-09-22 03:20:44 INFO  ---RUNTIME: Execution took 0.025033950805664062 ms
2022-09-22 03:20:44 INFO  Done!
2022-09-22 03:20:44 INFO  # Optimization benchmark for data_corruption with args [['reviews', 'slow_loading', 'featurization_2', 'neural_network']] -- repetition 1 of 7
2022-09-22 03:20:44 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-22 03:20:44 INFO  Running instrumented original pipeline...
2022-09-22 03:20:44 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-22 03:20:44 INFO  ---RUNTIME: Importing and monkey-patching took 6.3629150390625 ms
2022-09-22 03:20:59 INFO  ---RUNTIME: Original pipeline execution took 14591.20488166809 ms (excluding imports and monkey-patching)
2022-09-22 03:20:59 INFO  Starting execution of 1 what-if analyses...
2022-09-22 03:20:59 INFO  Start plan generation for analysis DataCorruption...
2022-09-22 03:20:59 INFO  ---RUNTIME: Plan generation took 1.2955665588378906 ms
2022-09-22 03:20:59 INFO  Estimated runtime of original DAG is 13374.744176864624ms
2022-09-22 03:20:59 INFO  Performing Multi-Query Optimization
2022-09-22 03:20:59 INFO  Estimated unoptimized what-if runtime is 334368.6044216156ms
2022-09-22 03:20:59 INFO  Estimated optimised what-if runtime is 40097.92923927307ms
2022-09-22 03:20:59 INFO  Estimated optimisation runtime saving is 294270.67518234253ms
2022-09-22 03:20:59 INFO  ---RUNTIME: Multi-Query Optimization took 67.81983375549316 ms
2022-09-22 03:20:59 INFO  Executing generated plans
2022-09-22 03:21:43 INFO  ---RUNTIME: Execution took 44515.384912490845 ms
2022-09-22 03:21:43 INFO  Done!
2022-09-22 03:21:43 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-22 03:21:43 INFO  Running instrumented original pipeline...
2022-09-22 03:21:43 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-22 03:21:43 INFO  ---RUNTIME: Importing and monkey-patching took 7.148027420043945 ms
2022-09-22 03:21:58 INFO  ---RUNTIME: Original pipeline execution took 14326.205492019653 ms (excluding imports and monkey-patching)
2022-09-22 03:21:58 INFO  Starting execution of 1 what-if analyses...
2022-09-22 03:21:58 INFO  Start plan generation for analysis DataCorruption...
2022-09-22 03:21:58 INFO  ---RUNTIME: Plan generation took 0.4794597625732422 ms
2022-09-22 03:21:58 INFO  Estimated runtime of original DAG is 13147.835969924927ms
2022-09-22 03:21:58 WARNING Skipping Multi-Query Optimization (instead, only applying patches)
2022-09-22 03:21:58 INFO  Estimated unoptimised what-if runtime is 328695.89924812317ms
2022-09-22 03:21:58 INFO  ---RUNTIME: Multi-Query Optimization took 23.29277992248535 ms
2022-09-22 03:21:58 INFO  Executing generated plans
2022-09-22 03:28:03 INFO  ---RUNTIME: Execution took 365519.2971229553 ms
2022-09-22 03:28:03 INFO  Done!
2022-09-22 03:28:03 INFO  # Finished -- repetition 1 of 7 
2022-09-22 03:28:03 INFO  # Optimization benchmark for data_corruption with args [['reviews', 'slow_loading', 'featurization_2', 'neural_network']] -- repetition 2 of 7
2022-09-22 03:28:03 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-22 03:28:03 INFO  Running instrumented original pipeline...
2022-09-22 03:28:03 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-22 03:28:03 INFO  ---RUNTIME: Importing and monkey-patching took 6.274223327636719 ms
2022-09-22 03:28:18 INFO  ---RUNTIME: Original pipeline execution took 15175.691604614258 ms (excluding imports and monkey-patching)
2022-09-22 03:28:18 INFO  Starting execution of 1 what-if analyses...
2022-09-22 03:28:18 INFO  Start plan generation for analysis DataCorruption...
2022-09-22 03:28:18 INFO  ---RUNTIME: Plan generation took 0.4534721374511719 ms
2022-09-22 03:28:18 INFO  Estimated runtime of original DAG is 13883.143424987793ms
2022-09-22 03:28:18 INFO  Performing Multi-Query Optimization
2022-09-22 03:28:19 INFO  Estimated unoptimized what-if runtime is 347078.5856246948ms
2022-09-22 03:28:19 INFO  Estimated optimised what-if runtime is 50296.52118682861ms
2022-09-22 03:28:19 INFO  Estimated optimisation runtime saving is 296782.0644378662ms
2022-09-22 03:28:19 INFO  ---RUNTIME: Multi-Query Optimization took 84.87200736999512 ms
2022-09-22 03:28:19 INFO  Executing generated plans
2022-09-22 03:29:05 INFO  ---RUNTIME: Execution took 46031.3777923584 ms
2022-09-22 03:29:05 INFO  Done!
2022-09-22 03:29:05 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-22 03:29:05 INFO  Running instrumented original pipeline...
2022-09-22 03:29:05 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-22 03:29:05 INFO  ---RUNTIME: Importing and monkey-patching took 6.799459457397461 ms
2022-09-22 03:29:19 INFO  ---RUNTIME: Original pipeline execution took 14358.923196792603 ms (excluding imports and monkey-patching)
2022-09-22 03:29:19 INFO  Starting execution of 1 what-if analyses...
2022-09-22 03:29:19 INFO  Start plan generation for analysis DataCorruption...
2022-09-22 03:29:19 INFO  ---RUNTIME: Plan generation took 0.5321502685546875 ms
2022-09-22 03:29:19 INFO  Estimated runtime of original DAG is 13151.707887649536ms
2022-09-22 03:29:19 WARNING Skipping Multi-Query Optimization (instead, only applying patches)
2022-09-22 03:29:19 INFO  Estimated unoptimised what-if runtime is 328792.6971912384ms
2022-09-22 03:29:19 INFO  ---RUNTIME: Multi-Query Optimization took 22.929906845092773 ms
2022-09-22 03:29:19 INFO  Executing generated plans
2022-09-22 03:35:25 INFO  ---RUNTIME: Execution took 365554.9318790436 ms
2022-09-22 03:35:25 INFO  Done!
2022-09-22 03:35:25 INFO  # Finished -- repetition 2 of 7 
2022-09-22 03:35:25 INFO  # Optimization benchmark for data_corruption with args [['reviews', 'slow_loading', 'featurization_2', 'neural_network']] -- repetition 3 of 7
2022-09-22 03:35:25 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-22 03:35:25 INFO  Running instrumented original pipeline...
2022-09-22 03:35:25 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-22 03:35:25 INFO  ---RUNTIME: Importing and monkey-patching took 6.211996078491211 ms
2022-09-22 03:35:39 INFO  ---RUNTIME: Original pipeline execution took 14838.147640228271 ms (excluding imports and monkey-patching)
2022-09-22 03:35:39 INFO  Starting execution of 1 what-if analyses...
2022-09-22 03:35:39 INFO  Start plan generation for analysis DataCorruption...
2022-09-22 03:35:39 INFO  ---RUNTIME: Plan generation took 0.5388259887695312 ms
2022-09-22 03:35:39 INFO  Estimated runtime of original DAG is 13605.813980102539ms
2022-09-22 03:35:39 INFO  Performing Multi-Query Optimization
2022-09-22 03:35:39 INFO  Estimated unoptimized what-if runtime is 340145.3495025635ms
2022-09-22 03:35:39 INFO  Estimated optimised what-if runtime is 42352.160930633545ms
2022-09-22 03:35:39 INFO  Estimated optimisation runtime saving is 297793.18857192993ms
2022-09-22 03:35:39 INFO  ---RUNTIME: Multi-Query Optimization took 74.07760620117188 ms
2022-09-22 03:35:39 INFO  Executing generated plans
2022-09-22 03:36:26 INFO  ---RUNTIME: Execution took 46592.19837188721 ms
2022-09-22 03:36:26 INFO  Done!
2022-09-22 03:36:26 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-22 03:36:26 INFO  Running instrumented original pipeline...
2022-09-22 03:36:26 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-22 03:36:26 INFO  ---RUNTIME: Importing and monkey-patching took 6.603479385375977 ms
2022-09-22 03:36:42 INFO  ---RUNTIME: Original pipeline execution took 15438.183069229126 ms (excluding imports and monkey-patching)
2022-09-22 03:36:42 INFO  Starting execution of 1 what-if analyses...
2022-09-22 03:36:42 INFO  Start plan generation for analysis DataCorruption...
2022-09-22 03:36:42 INFO  ---RUNTIME: Plan generation took 0.43201446533203125 ms
2022-09-22 03:36:42 INFO  Estimated runtime of original DAG is 14038.007020950317ms
2022-09-22 03:36:42 WARNING Skipping Multi-Query Optimization (instead, only applying patches)
2022-09-22 03:36:42 INFO  Estimated unoptimised what-if runtime is 350950.17552375793ms
2022-09-22 03:36:42 INFO  ---RUNTIME: Multi-Query Optimization took 20.166873931884766 ms
2022-09-22 03:36:42 INFO  Executing generated plans
2022-09-22 03:42:47 INFO  ---RUNTIME: Execution took 365229.81810569763 ms
2022-09-22 03:42:47 INFO  Done!
2022-09-22 03:42:47 INFO  # Finished -- repetition 3 of 7 
2022-09-22 03:42:47 INFO  # Optimization benchmark for data_corruption with args [['reviews', 'slow_loading', 'featurization_2', 'neural_network']] -- repetition 4 of 7
2022-09-22 03:42:47 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-22 03:42:47 INFO  Running instrumented original pipeline...
2022-09-22 03:42:47 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-22 03:42:47 INFO  ---RUNTIME: Importing and monkey-patching took 6.239652633666992 ms
2022-09-22 03:43:00 INFO  ---RUNTIME: Original pipeline execution took 13690.703630447388 ms (excluding imports and monkey-patching)
2022-09-22 03:43:00 INFO  Starting execution of 1 what-if analyses...
2022-09-22 03:43:00 INFO  Start plan generation for analysis DataCorruption...
2022-09-22 03:43:00 INFO  ---RUNTIME: Plan generation took 0.4220008850097656 ms
2022-09-22 03:43:00 INFO  Estimated runtime of original DAG is 12487.65778541565ms
2022-09-22 03:43:00 INFO  Performing Multi-Query Optimization
2022-09-22 03:43:01 INFO  Estimated unoptimized what-if runtime is 312191.44463539124ms
2022-09-22 03:43:01 INFO  Estimated optimised what-if runtime is 38003.41272354126ms
2022-09-22 03:43:01 INFO  Estimated optimisation runtime saving is 274188.03191185ms
2022-09-22 03:43:01 INFO  ---RUNTIME: Multi-Query Optimization took 67.47865676879883 ms
2022-09-22 03:43:01 INFO  Executing generated plans
2022-09-22 03:43:46 INFO  ---RUNTIME: Execution took 45913.34342956543 ms
2022-09-22 03:43:46 INFO  Done!
2022-09-22 03:43:46 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-22 03:43:46 INFO  Running instrumented original pipeline...
2022-09-22 03:43:47 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-22 03:43:47 INFO  ---RUNTIME: Importing and monkey-patching took 6.462574005126953 ms
2022-09-22 03:44:02 INFO  ---RUNTIME: Original pipeline execution took 15155.523538589478 ms (excluding imports and monkey-patching)
2022-09-22 03:44:02 INFO  Starting execution of 1 what-if analyses...
2022-09-22 03:44:02 INFO  Start plan generation for analysis DataCorruption...
2022-09-22 03:44:02 INFO  ---RUNTIME: Plan generation took 0.431060791015625 ms
2022-09-22 03:44:02 INFO  Estimated runtime of original DAG is 13901.376962661743ms
2022-09-22 03:44:02 WARNING Skipping Multi-Query Optimization (instead, only applying patches)
2022-09-22 03:44:02 INFO  Estimated unoptimised what-if runtime is 347534.4240665436ms
2022-09-22 03:44:02 INFO  ---RUNTIME: Multi-Query Optimization took 20.0192928314209 ms
2022-09-22 03:44:02 INFO  Executing generated plans
2022-09-22 03:50:09 INFO  ---RUNTIME: Execution took 367037.3845100403 ms
2022-09-22 03:50:09 INFO  Done!
2022-09-22 03:50:09 INFO  # Finished -- repetition 4 of 7 
2022-09-22 03:50:09 INFO  # Optimization benchmark for data_corruption with args [['reviews', 'slow_loading', 'featurization_2', 'neural_network']] -- repetition 5 of 7
2022-09-22 03:50:09 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-22 03:50:09 INFO  Running instrumented original pipeline...
2022-09-22 03:50:09 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-22 03:50:09 INFO  ---RUNTIME: Importing and monkey-patching took 6.43467903137207 ms
2022-09-22 03:50:23 INFO  ---RUNTIME: Original pipeline execution took 14632.982015609741 ms (excluding imports and monkey-patching)
2022-09-22 03:50:23 INFO  Starting execution of 1 what-if analyses...
2022-09-22 03:50:23 INFO  Start plan generation for analysis DataCorruption...
2022-09-22 03:50:23 INFO  ---RUNTIME: Plan generation took 0.44155120849609375 ms
2022-09-22 03:50:23 INFO  Estimated runtime of original DAG is 12984.551191329956ms
2022-09-22 03:50:23 INFO  Performing Multi-Query Optimization
2022-09-22 03:50:23 INFO  Estimated unoptimized what-if runtime is 324613.7797832489ms
2022-09-22 03:50:23 INFO  Estimated optimised what-if runtime is 40676.25689506531ms
2022-09-22 03:50:23 INFO  Estimated optimisation runtime saving is 283937.5228881836ms
2022-09-22 03:50:23 INFO  ---RUNTIME: Multi-Query Optimization took 72.4947452545166 ms
2022-09-22 03:50:23 INFO  Executing generated plans
2022-09-22 03:51:05 INFO  ---RUNTIME: Execution took 42036.319971084595 ms
2022-09-22 03:51:05 INFO  Done!
2022-09-22 03:51:05 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-22 03:51:05 INFO  Running instrumented original pipeline...
2022-09-22 03:51:05 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-22 03:51:05 INFO  ---RUNTIME: Importing and monkey-patching took 6.310939788818359 ms
2022-09-22 03:51:20 INFO  ---RUNTIME: Original pipeline execution took 14964.668989181519 ms (excluding imports and monkey-patching)
2022-09-22 03:51:20 INFO  Starting execution of 1 what-if analyses...
2022-09-22 03:51:20 INFO  Start plan generation for analysis DataCorruption...
2022-09-22 03:51:20 INFO  ---RUNTIME: Plan generation took 0.4839897155761719 ms
2022-09-22 03:51:20 INFO  Estimated runtime of original DAG is 13655.847549438477ms
2022-09-22 03:51:20 WARNING Skipping Multi-Query Optimization (instead, only applying patches)
2022-09-22 03:51:20 INFO  Estimated unoptimised what-if runtime is 341396.1887359619ms
2022-09-22 03:51:20 INFO  ---RUNTIME: Multi-Query Optimization took 22.86052703857422 ms
2022-09-22 03:51:20 INFO  Executing generated plans
2022-09-22 03:57:25 INFO  ---RUNTIME: Execution took 365050.7791042328 ms
2022-09-22 03:57:26 INFO  Done!
2022-09-22 03:57:26 INFO  # Finished -- repetition 5 of 7 
2022-09-22 03:57:26 INFO  # Optimization benchmark for data_corruption with args [['reviews', 'slow_loading', 'featurization_2', 'neural_network']] -- repetition 6 of 7
2022-09-22 03:57:26 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-22 03:57:26 INFO  Running instrumented original pipeline...
2022-09-22 03:57:26 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-22 03:57:26 INFO  ---RUNTIME: Importing and monkey-patching took 6.276607513427734 ms
2022-09-22 03:57:40 INFO  ---RUNTIME: Original pipeline execution took 14301.778078079224 ms (excluding imports and monkey-patching)
2022-09-22 03:57:40 INFO  Starting execution of 1 what-if analyses...
2022-09-22 03:57:40 INFO  Start plan generation for analysis DataCorruption...
2022-09-22 03:57:40 INFO  ---RUNTIME: Plan generation took 0.4112720489501953 ms
2022-09-22 03:57:40 INFO  Estimated runtime of original DAG is 13101.731061935425ms
2022-09-22 03:57:40 INFO  Performing Multi-Query Optimization
2022-09-22 03:57:40 INFO  Estimated unoptimized what-if runtime is 327543.2765483856ms
2022-09-22 03:57:40 INFO  Estimated optimised what-if runtime is 38123.08931350708ms
2022-09-22 03:57:40 INFO  Estimated optimisation runtime saving is 289420.18723487854ms
2022-09-22 03:57:40 INFO  ---RUNTIME: Multi-Query Optimization took 67.05451011657715 ms
2022-09-22 03:57:40 INFO  Executing generated plans
2022-09-22 03:58:23 INFO  ---RUNTIME: Execution took 43464.88881111145 ms
2022-09-22 03:58:23 INFO  Done!
2022-09-22 03:58:23 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-22 03:58:23 INFO  Running instrumented original pipeline...
2022-09-22 03:58:23 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-22 03:58:23 INFO  ---RUNTIME: Importing and monkey-patching took 6.4220428466796875 ms
2022-09-22 03:58:38 INFO  ---RUNTIME: Original pipeline execution took 14268.388986587524 ms (excluding imports and monkey-patching)
2022-09-22 03:58:38 INFO  Starting execution of 1 what-if analyses...
2022-09-22 03:58:38 INFO  Start plan generation for analysis DataCorruption...
2022-09-22 03:58:38 INFO  ---RUNTIME: Plan generation took 0.4119873046875 ms
2022-09-22 03:58:38 INFO  Estimated runtime of original DAG is 13071.51484489441ms
2022-09-22 03:58:38 WARNING Skipping Multi-Query Optimization (instead, only applying patches)
2022-09-22 03:58:38 INFO  Estimated unoptimised what-if runtime is 326787.87112236023ms
2022-09-22 03:58:38 INFO  ---RUNTIME: Multi-Query Optimization took 19.949913024902344 ms
2022-09-22 03:58:38 INFO  Executing generated plans
2022-09-22 04:04:27 INFO  ---RUNTIME: Execution took 349718.24407577515 ms
2022-09-22 04:04:27 INFO  Done!
2022-09-22 04:04:27 INFO  # Finished -- repetition 6 of 7 
2022-09-22 04:04:27 INFO  # Optimization benchmark for data_corruption with args [['reviews', 'slow_loading', 'featurization_2', 'neural_network']] -- repetition 7 of 7
2022-09-22 04:04:27 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-22 04:04:27 INFO  Running instrumented original pipeline...
2022-09-22 04:04:27 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-22 04:04:27 INFO  ---RUNTIME: Importing and monkey-patching took 6.220817565917969 ms
2022-09-22 04:04:41 INFO  ---RUNTIME: Original pipeline execution took 13668.14136505127 ms (excluding imports and monkey-patching)
2022-09-22 04:04:41 INFO  Starting execution of 1 what-if analyses...
2022-09-22 04:04:41 INFO  Start plan generation for analysis DataCorruption...
2022-09-22 04:04:41 INFO  ---RUNTIME: Plan generation took 0.4239082336425781 ms
2022-09-22 04:04:41 INFO  Estimated runtime of original DAG is 12461.95363998413ms
2022-09-22 04:04:41 INFO  Performing Multi-Query Optimization
2022-09-22 04:04:41 INFO  Estimated unoptimized what-if runtime is 311548.8409996033ms
2022-09-22 04:04:41 INFO  Estimated optimised what-if runtime is 38933.63285064697ms
2022-09-22 04:04:41 INFO  Estimated optimisation runtime saving is 272615.2081489563ms
2022-09-22 04:04:41 INFO  ---RUNTIME: Multi-Query Optimization took 67.58308410644531 ms
2022-09-22 04:04:41 INFO  Executing generated plans
2022-09-22 04:05:25 INFO  ---RUNTIME: Execution took 43745.917320251465 ms
2022-09-22 04:05:25 INFO  Done!
2022-09-22 04:05:25 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-22 04:05:25 INFO  Running instrumented original pipeline...
2022-09-22 04:05:25 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-22 04:05:25 INFO  ---RUNTIME: Importing and monkey-patching took 6.8607330322265625 ms
2022-09-22 04:05:39 INFO  ---RUNTIME: Original pipeline execution took 13756.966590881348 ms (excluding imports and monkey-patching)
2022-09-22 04:05:39 INFO  Starting execution of 1 what-if analyses...
2022-09-22 04:05:39 INFO  Start plan generation for analysis DataCorruption...
2022-09-22 04:05:39 INFO  ---RUNTIME: Plan generation took 0.4448890686035156 ms
2022-09-22 04:05:39 INFO  Estimated runtime of original DAG is 12546.558618545532ms
2022-09-22 04:05:39 WARNING Skipping Multi-Query Optimization (instead, only applying patches)
2022-09-22 04:05:39 INFO  Estimated unoptimised what-if runtime is 313663.9654636383ms
2022-09-22 04:05:39 INFO  ---RUNTIME: Multi-Query Optimization took 20.342350006103516 ms
2022-09-22 04:05:39 INFO  Executing generated plans
2022-09-22 04:11:28 INFO  ---RUNTIME: Execution took 349017.573595047 ms
2022-09-22 04:11:28 INFO  Done!
2022-09-22 04:11:28 INFO  # Finished -- repetition 7 of 7 
2022-09-22 04:11:28 INFO  # Final results after all repetitions
2022-09-22 04:11:28 INFO     repetition  ... no_opt_what_if_execution_combined_model_training
0           0  ...                                    162046.876431
1           1  ...                                    160743.479729
2           2  ...                                    158314.603806
3           3  ...                                    158789.951324
4           4  ...                                    157263.896227
5           5  ...                                    147699.616432
6           6  ...                                    147602.660418

[7 rows x 26 columns]
taskset -c 32-39 PROTOCOL_BUFFERS_PYTHON_IMPLEMENTATION=python python3.9 benchmarks_end_to_end.py data_corruption reviews slow_loading featurization_3 logistic_regression
2022-09-22 04:11:30.779321: W tensorflow/stream_executor/platform/default/dso_loader.cc:64] Could not load dynamic library 'libcudart.so.11.0'; dlerror: libcudart.so.11.0: cannot open shared object file: No such file or directory; LD_LIBRARY_PATH: /home/sgrafbe/mlwhatif/venv/lib/python3.9/site-packages/cv2/../../lib64:
2022-09-22 04:11:30.779365: I tensorflow/stream_executor/cuda/cudart_stub.cc:29] Ignore above cudart dlerror if you do not have a GPU set up on your machine.
2022-09-22 04:11:31 INFO  Patching sys.argv with ['mlwhatif', 'reviews', 'slow_loading', 'featurization_3', 'logistic_regression']
2022-09-22 04:11:31 INFO  Running instrumented original pipeline...
2022-09-22 04:11:32 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-22 04:11:32 INFO  ---RUNTIME: Importing and monkey-patching took 95.46685218811035 ms
2022-09-22 04:12:18 INFO  ---RUNTIME: Original pipeline execution took 46077.9824256897 ms (excluding imports and monkey-patching)
2022-09-22 04:12:18 INFO  Starting execution of 0 what-if analyses...
2022-09-22 04:12:18 INFO  Estimated runtime of original DAG is 33603.37448120117ms
2022-09-22 04:12:18 INFO  Performing Multi-Query Optimization
2022-09-22 04:12:18 INFO  Estimated unoptimized what-if runtime is 0ms
2022-09-22 04:12:18 INFO  Estimated optimised what-if runtime is 0ms
2022-09-22 04:12:18 INFO  Estimated optimisation runtime saving is 0ms
2022-09-22 04:12:18 INFO  ---RUNTIME: Multi-Query Optimization took 0.5900859832763672 ms
2022-09-22 04:12:18 INFO  Executing generated plans
2022-09-22 04:12:18 INFO  ---RUNTIME: Execution took 0.02384185791015625 ms
2022-09-22 04:12:18 INFO  Done!
2022-09-22 04:12:18 INFO  # Optimization benchmark for data_corruption with args [['reviews', 'slow_loading', 'featurization_3', 'logistic_regression']] -- repetition 1 of 7
2022-09-22 04:12:18 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-22 04:12:18 INFO  Running instrumented original pipeline...
2022-09-22 04:12:18 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-22 04:12:18 INFO  ---RUNTIME: Importing and monkey-patching took 5.560398101806641 ms
2022-09-22 04:13:09 INFO  ---RUNTIME: Original pipeline execution took 51305.660009384155 ms (excluding imports and monkey-patching)
2022-09-22 04:13:09 INFO  Starting execution of 1 what-if analyses...
2022-09-22 04:13:09 INFO  Start plan generation for analysis DataCorruption...
2022-09-22 04:13:09 INFO  ---RUNTIME: Plan generation took 0.4878044128417969 ms
2022-09-22 04:13:09 INFO  Estimated runtime of original DAG is 35978.825092315674ms
2022-09-22 04:13:09 INFO  Performing Multi-Query Optimization
2022-09-22 04:13:09 INFO  Estimated unoptimized what-if runtime is 899470.6273078918ms
2022-09-22 04:13:09 INFO  Estimated optimised what-if runtime is 118862.03169822693ms
2022-09-22 04:13:09 INFO  Estimated optimisation runtime saving is 780608.5956096649ms
2022-09-22 04:13:09 INFO  ---RUNTIME: Multi-Query Optimization took 243.8037395477295 ms
2022-09-22 04:13:09 INFO  Executing generated plans
2022-09-22 04:14:10 INFO  ---RUNTIME: Execution took 60740.33212661743 ms
2022-09-22 04:14:10 INFO  Done!
2022-09-22 04:14:10 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-22 04:14:10 INFO  Running instrumented original pipeline...
2022-09-22 04:14:10 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-22 04:14:10 INFO  ---RUNTIME: Importing and monkey-patching took 6.197929382324219 ms
Traceback (most recent call last):
  File "/home/sgrafbe/mlwhatif/experiments/end_to_end/benchmarks_end_to_end.py", line 238, in <module>
    analysis_result_no_opt = PipelineAnalyzer \
  File "/home/sgrafbe/mlwhatif/mlwhatif/_pipeline_analyzer.py", line 93, in execute
    return singleton.run(notebook_path=self._notebook_path,
  File "/home/sgrafbe/mlwhatif/mlwhatif/execution/_pipeline_executor.py", line 110, in run
    self.run_instrumented_pipeline(notebook_path, python_code, python_path)
  File "/home/sgrafbe/mlwhatif/mlwhatif/execution/_pipeline_executor.py", line 205, in run_instrumented_pipeline
    exec(compile(parsed_modified_ast, filename=self.source_code_path, mode="exec"), self.script_scope)
  File "/home/sgrafbe/mlwhatif/experiments/end_to_end/run_pipeline.py", line 451, in <module>
    predictions = pipeline.predict(test)
  File "/home/sgrafbe/mlwhatif/venv/lib64/python3.9/site-packages/sklearn/utils/metaestimators.py", line 119, in <lambda>
    out = lambda *args, **kwargs: self.fn(obj, *args, **kwargs)
  File "/home/sgrafbe/mlwhatif/venv/lib64/python3.9/site-packages/sklearn/pipeline.py", line 407, in predict
    Xt = transform.transform(Xt)
  File "/home/sgrafbe/mlwhatif/mlwhatif/monkeypatching/_patch_sklearn.py", line 323, in patched_transform
    result = original(self, *args, **kwargs)
  File "/home/sgrafbe/mlwhatif/venv/lib64/python3.9/site-packages/sklearn/compose/_column_transformer.py", line 604, in transform
    Xs = self._fit_transform(X, None, _transform_one, fitted=True)
  File "/home/sgrafbe/mlwhatif/venv/lib64/python3.9/site-packages/sklearn/compose/_column_transformer.py", line 458, in _fit_transform
    return Parallel(n_jobs=self.n_jobs)(
  File "/home/sgrafbe/mlwhatif/venv/lib64/python3.9/site-packages/joblib/parallel.py", line 1088, in __call__
    while self.dispatch_one_batch(iterator):
  File "/home/sgrafbe/mlwhatif/venv/lib64/python3.9/site-packages/joblib/parallel.py", line 901, in dispatch_one_batch
    self._dispatch(tasks)
  File "/home/sgrafbe/mlwhatif/venv/lib64/python3.9/site-packages/joblib/parallel.py", line 819, in _dispatch
    job = self._backend.apply_async(batch, callback=cb)
  File "/home/sgrafbe/mlwhatif/venv/lib64/python3.9/site-packages/joblib/_parallel_backends.py", line 208, in apply_async
    result = ImmediateResult(func)
  File "/home/sgrafbe/mlwhatif/venv/lib64/python3.9/site-packages/joblib/_parallel_backends.py", line 597, in __init__
    self.results = batch()
  File "/home/sgrafbe/mlwhatif/venv/lib64/python3.9/site-packages/joblib/parallel.py", line 288, in __call__
    return [func(*args, **kwargs)
  File "/home/sgrafbe/mlwhatif/venv/lib64/python3.9/site-packages/joblib/parallel.py", line 288, in <listcomp>
    return [func(*args, **kwargs)
  File "/home/sgrafbe/mlwhatif/venv/lib64/python3.9/site-packages/sklearn/pipeline.py", line 719, in _transform_one
    res = transformer.transform(X)
  File "/home/sgrafbe/mlwhatif/venv/lib64/python3.9/site-packages/sklearn/pipeline.py", line 549, in _transform
    Xt = transform.transform(Xt)
  File "/home/sgrafbe/mlwhatif/mlwhatif/monkeypatching/_patch_sklearn.py", line 1789, in patched_transform
    add_dag_node(dag_node, [transformer_dag_node, input_info.dag_node], function_call_result)
  File "/home/sgrafbe/mlwhatif/mlwhatif/monkeypatching/_monkey_patching_utils.py", line 255, in add_dag_node
    function_call_result.function_result = wrap_in_mlinspect_array_if_necessary(
  File "/home/sgrafbe/mlwhatif/mlwhatif/monkeypatching/_monkey_patching_utils.py", line 229, in wrap_in_mlinspect_array_if_necessary
    df_object = MlinspectNdarray(df_object)
  File "/home/sgrafbe/mlwhatif/mlwhatif/monkeypatching/_mlinspect_ndarray.py", line 16, in __new__
    obj = numpy.asarray(input_array).view(cls)
  File "/home/sgrafbe/mlwhatif/venv/lib64/python3.9/site-packages/numpy/core/_asarray.py", line 83, in asarray
    return array(a, dtype, copy=False, order=order)
numpy.core._exceptions.MemoryError: Unable to allocate 4.53 GiB for an array with shape (52075,) and data type <U23345
taskset -c 32-39 PROTOCOL_BUFFERS_PYTHON_IMPLEMENTATION=python python3.9 benchmarks_end_to_end.py data_corruption reviews slow_loading featurization_3 xgboost
2022-09-22 04:15:02.982691: W tensorflow/stream_executor/platform/default/dso_loader.cc:64] Could not load dynamic library 'libcudart.so.11.0'; dlerror: libcudart.so.11.0: cannot open shared object file: No such file or directory; LD_LIBRARY_PATH: /home/sgrafbe/mlwhatif/venv/lib/python3.9/site-packages/cv2/../../lib64:
2022-09-22 04:15:02.982722: I tensorflow/stream_executor/cuda/cudart_stub.cc:29] Ignore above cudart dlerror if you do not have a GPU set up on your machine.
2022-09-22 04:15:05 INFO  Patching sys.argv with ['mlwhatif', 'reviews', 'slow_loading', 'featurization_3', 'xgboost']
2022-09-22 04:15:05 INFO  Running instrumented original pipeline...
2022-09-22 04:15:05 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-22 04:15:05 INFO  ---RUNTIME: Importing and monkey-patching took 163.99836540222168 ms
2022-09-22 04:16:02 INFO  ---RUNTIME: Original pipeline execution took 57226.14121437073 ms (excluding imports and monkey-patching)
2022-09-22 04:16:02 INFO  Starting execution of 0 what-if analyses...
2022-09-22 04:16:02 INFO  Estimated runtime of original DAG is 49274.32870864868ms
2022-09-22 04:16:02 INFO  Performing Multi-Query Optimization
2022-09-22 04:16:02 INFO  Estimated unoptimized what-if runtime is 0ms
2022-09-22 04:16:02 INFO  Estimated optimised what-if runtime is 0ms
2022-09-22 04:16:02 INFO  Estimated optimisation runtime saving is 0ms
2022-09-22 04:16:02 INFO  ---RUNTIME: Multi-Query Optimization took 0.6287097930908203 ms
2022-09-22 04:16:02 INFO  Executing generated plans
2022-09-22 04:16:02 INFO  ---RUNTIME: Execution took 0.02384185791015625 ms
2022-09-22 04:16:02 INFO  Done!
2022-09-22 04:16:02 INFO  # Optimization benchmark for data_corruption with args [['reviews', 'slow_loading', 'featurization_3', 'xgboost']] -- repetition 1 of 7
2022-09-22 04:16:02 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-22 04:16:02 INFO  Running instrumented original pipeline...
2022-09-22 04:16:02 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-22 04:16:02 INFO  ---RUNTIME: Importing and monkey-patching took 8.141517639160156 ms
2022-09-22 04:17:03 INFO  ---RUNTIME: Original pipeline execution took 60714.728355407715 ms (excluding imports and monkey-patching)
2022-09-22 04:17:03 INFO  Starting execution of 1 what-if analyses...
2022-09-22 04:17:03 INFO  Start plan generation for analysis DataCorruption...
2022-09-22 04:17:03 INFO  ---RUNTIME: Plan generation took 0.47779083251953125 ms
2022-09-22 04:17:03 INFO  Estimated runtime of original DAG is 49350.539207458496ms
2022-09-22 04:17:03 INFO  Performing Multi-Query Optimization
2022-09-22 04:17:03 INFO  Estimated unoptimized what-if runtime is 1233763.4801864624ms
2022-09-22 04:17:03 INFO  Estimated optimised what-if runtime is 132694.68116760254ms
2022-09-22 04:17:03 INFO  Estimated optimisation runtime saving is 1101068.7990188599ms
2022-09-22 04:17:03 INFO  ---RUNTIME: Multi-Query Optimization took 248.4910488128662 ms
2022-09-22 04:17:03 INFO  Executing generated plans
2022-09-22 04:18:20 INFO  ---RUNTIME: Execution took 77112.6229763031 ms
2022-09-22 04:18:20 INFO  Done!
2022-09-22 04:18:20 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-22 04:18:20 INFO  Running instrumented original pipeline...
2022-09-22 04:18:20 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-22 04:18:20 INFO  ---RUNTIME: Importing and monkey-patching took 6.697654724121094 ms
2022-09-22 04:19:25 INFO  ---RUNTIME: Original pipeline execution took 64866.51659011841 ms (excluding imports and monkey-patching)
2022-09-22 04:19:25 INFO  Starting execution of 1 what-if analyses...
2022-09-22 04:19:25 INFO  Start plan generation for analysis DataCorruption...
2022-09-22 04:19:25 INFO  ---RUNTIME: Plan generation took 0.5254745483398438 ms
2022-09-22 04:19:25 INFO  Estimated runtime of original DAG is 49442.246198654175ms
2022-09-22 04:19:25 WARNING Skipping Multi-Query Optimization (instead, only applying patches)
2022-09-22 04:19:25 INFO  Estimated unoptimised what-if runtime is 1236056.1549663544ms
2022-09-22 04:19:25 INFO  ---RUNTIME: Multi-Query Optimization took 24.03116226196289 ms
2022-09-22 04:19:25 INFO  Executing generated plans
2022-09-22 04:44:13 INFO  ---RUNTIME: Execution took 1488033.8487625122 ms
2022-09-22 04:44:13 INFO  Done!
2022-09-22 04:44:13 INFO  # Finished -- repetition 1 of 7 
2022-09-22 04:44:13 INFO  # Optimization benchmark for data_corruption with args [['reviews', 'slow_loading', 'featurization_3', 'xgboost']] -- repetition 2 of 7
2022-09-22 04:44:13 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-22 04:44:13 INFO  Running instrumented original pipeline...
2022-09-22 04:44:13 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-22 04:44:13 INFO  ---RUNTIME: Importing and monkey-patching took 8.655309677124023 ms
2022-09-22 04:45:26 INFO  ---RUNTIME: Original pipeline execution took 72898.6029624939 ms (excluding imports and monkey-patching)
2022-09-22 04:45:26 INFO  Starting execution of 1 what-if analyses...
2022-09-22 04:45:26 INFO  Start plan generation for analysis DataCorruption...
2022-09-22 04:45:26 INFO  ---RUNTIME: Plan generation took 13.035058975219727 ms
2022-09-22 04:45:26 INFO  Estimated runtime of original DAG is 57304.996728897095ms
2022-09-22 04:45:26 INFO  Performing Multi-Query Optimization
2022-09-22 04:45:26 INFO  Estimated unoptimized what-if runtime is 1432624.9182224274ms
2022-09-22 04:45:26 INFO  Estimated optimised what-if runtime is 147468.7259197235ms
2022-09-22 04:45:26 INFO  Estimated optimisation runtime saving is 1285156.1923027039ms
2022-09-22 04:45:26 INFO  ---RUNTIME: Multi-Query Optimization took 193.0856704711914 ms
2022-09-22 04:45:26 INFO  Executing generated plans
2022-09-22 04:46:50 INFO  ---RUNTIME: Execution took 84251.62696838379 ms
2022-09-22 04:46:50 INFO  Done!
2022-09-22 04:46:51 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-22 04:46:51 INFO  Running instrumented original pipeline...
2022-09-22 04:46:51 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-22 04:46:51 INFO  ---RUNTIME: Importing and monkey-patching took 6.4697265625 ms
2022-09-22 04:48:02 INFO  ---RUNTIME: Original pipeline execution took 71029.08301353455 ms (excluding imports and monkey-patching)
2022-09-22 04:48:02 INFO  Starting execution of 1 what-if analyses...
2022-09-22 04:48:02 INFO  Start plan generation for analysis DataCorruption...
2022-09-22 04:48:02 INFO  ---RUNTIME: Plan generation took 0.5948543548583984 ms
2022-09-22 04:48:02 INFO  Estimated runtime of original DAG is 60770.17784118652ms
2022-09-22 04:48:02 WARNING Skipping Multi-Query Optimization (instead, only applying patches)
2022-09-22 04:48:02 INFO  Estimated unoptimised what-if runtime is 1519254.446029663ms
2022-09-22 04:48:02 INFO  ---RUNTIME: Multi-Query Optimization took 23.8189697265625 ms
2022-09-22 04:48:02 INFO  Executing generated plans
Traceback (most recent call last):
  File "/home/sgrafbe/mlwhatif/experiments/end_to_end/benchmarks_end_to_end.py", line 238, in <module>
    analysis_result_no_opt = PipelineAnalyzer \
  File "/home/sgrafbe/mlwhatif/mlwhatif/_pipeline_analyzer.py", line 93, in execute
    return singleton.run(notebook_path=self._notebook_path,
  File "/home/sgrafbe/mlwhatif/mlwhatif/execution/_pipeline_executor.py", line 149, in run
    self.run_what_if_analyses()
  File "/home/sgrafbe/mlwhatif/mlwhatif/execution/_pipeline_executor.py", line 181, in run_what_if_analyses
    DagExecutor(self).execute(what_if_dag)
  File "/home/sgrafbe/mlwhatif/mlwhatif/execution/_dag_executor.py", line 45, in execute
    self.traverse_graph_and_process_nodes(dag, execute_node)
  File "/home/sgrafbe/mlwhatif/mlwhatif/execution/_dag_executor.py", line 57, in traverse_graph_and_process_nodes
    result_node = func(node)
  File "/home/sgrafbe/mlwhatif/mlwhatif/execution/_dag_executor.py", line 40, in execute_node
    optimizer_info, result_df = capture_optimizer_info(executable_processing_func)
  File "/home/sgrafbe/mlwhatif/mlwhatif/execution/_stat_tracking.py", line 28, in capture_optimizer_info
    result = instrumented_function_call()
  File "/home/sgrafbe/mlwhatif/mlwhatif/monkeypatching/_patch_sklearn.py", line 1726, in processing_func
    input_df_copy = input_df.copy()
numpy.core._exceptions.MemoryError: Unable to allocate 3.89 GiB for an array with shape (35312,) and data type <U29600
taskset -c 32-39 PROTOCOL_BUFFERS_PYTHON_IMPLEMENTATION=python python3.9 benchmarks_end_to_end.py data_corruption reviews slow_loading featurization_3 neural_network
2022-09-22 04:55:55.952227: W tensorflow/stream_executor/platform/default/dso_loader.cc:64] Could not load dynamic library 'libcudart.so.11.0'; dlerror: libcudart.so.11.0: cannot open shared object file: No such file or directory; LD_LIBRARY_PATH: /home/sgrafbe/mlwhatif/venv/lib/python3.9/site-packages/cv2/../../lib64:
2022-09-22 04:55:55.952269: I tensorflow/stream_executor/cuda/cudart_stub.cc:29] Ignore above cudart dlerror if you do not have a GPU set up on your machine.
2022-09-22 04:55:57 INFO  Patching sys.argv with ['mlwhatif', 'reviews', 'slow_loading', 'featurization_3', 'neural_network']
2022-09-22 04:55:57 INFO  Running instrumented original pipeline...
2022-09-22 04:55:57 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-22 04:55:57 INFO  ---RUNTIME: Importing and monkey-patching took 96.18043899536133 ms
2022-09-22 04:56:19.243679: W tensorflow/stream_executor/platform/default/dso_loader.cc:64] Could not load dynamic library 'libcuda.so.1'; dlerror: libcuda.so.1: cannot open shared object file: No such file or directory; LD_LIBRARY_PATH: /home/sgrafbe/mlwhatif/venv/lib/python3.9/site-packages/cv2/../../lib64:
2022-09-22 04:56:19.243713: W tensorflow/stream_executor/cuda/cuda_driver.cc:326] failed call to cuInit: UNKNOWN ERROR (303)
2022-09-22 04:56:19.243737: I tensorflow/stream_executor/cuda/cuda_diagnostics.cc:156] kernel driver does not appear to be running on this host (wagyu): /proc/driver/nvidia/version does not exist
2022-09-22 04:56:19.244204: I tensorflow/core/platform/cpu_feature_guard.cc:142] This TensorFlow binary is optimized with oneAPI Deep Neural Network Library (oneDNN) to use the following CPU instructions in performance-critical operations:  AVX2 FMA
To enable them in other operations, rebuild TensorFlow with the appropriate compiler flags.
2022-09-22 04:56:19.845878: I tensorflow/compiler/mlir/mlir_graph_optimization_pass.cc:176] None of the MLIR Optimization Passes are enabled (registered 2)
2022-09-22 04:56:19.859412: I tensorflow/core/platform/profile_utils/cpu_utils.cc:114] CPU Frequency: 2595290000 Hz
2022-09-22 04:56:44 INFO  ---RUNTIME: Original pipeline execution took 47506.17742538452 ms (excluding imports and monkey-patching)
2022-09-22 04:56:44 INFO  Starting execution of 0 what-if analyses...
2022-09-22 04:56:44 INFO  Estimated runtime of original DAG is 40271.08883857727ms
2022-09-22 04:56:44 INFO  Performing Multi-Query Optimization
2022-09-22 04:56:44 INFO  Estimated unoptimized what-if runtime is 0ms
2022-09-22 04:56:44 INFO  Estimated optimised what-if runtime is 0ms
2022-09-22 04:56:44 INFO  Estimated optimisation runtime saving is 0ms
2022-09-22 04:56:44 INFO  ---RUNTIME: Multi-Query Optimization took 0.5526542663574219 ms
2022-09-22 04:56:44 INFO  Executing generated plans
2022-09-22 04:56:44 INFO  ---RUNTIME: Execution took 0.014781951904296875 ms
2022-09-22 04:56:44 INFO  Done!
2022-09-22 04:56:44 INFO  # Optimization benchmark for data_corruption with args [['reviews', 'slow_loading', 'featurization_3', 'neural_network']] -- repetition 1 of 7
2022-09-22 04:56:44 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-22 04:56:44 INFO  Running instrumented original pipeline...
2022-09-22 04:56:44 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-22 04:56:44 INFO  ---RUNTIME: Importing and monkey-patching took 5.528450012207031 ms
2022-09-22 04:57:32 INFO  ---RUNTIME: Original pipeline execution took 47917.518615722656 ms (excluding imports and monkey-patching)
2022-09-22 04:57:32 INFO  Starting execution of 1 what-if analyses...
2022-09-22 04:57:32 INFO  Start plan generation for analysis DataCorruption...
2022-09-22 04:57:32 INFO  ---RUNTIME: Plan generation took 1.2400150299072266 ms
2022-09-22 04:57:32 INFO  Estimated runtime of original DAG is 40752.087354660034ms
2022-09-22 04:57:32 INFO  Performing Multi-Query Optimization
2022-09-22 04:57:32 INFO  Estimated unoptimized what-if runtime is 1018802.1838665009ms
2022-09-22 04:57:32 INFO  Estimated optimised what-if runtime is 143889.235496521ms
2022-09-22 04:57:32 INFO  Estimated optimisation runtime saving is 874912.9483699799ms
2022-09-22 04:57:32 INFO  ---RUNTIME: Multi-Query Optimization took 77.79836654663086 ms
2022-09-22 04:57:32 INFO  Executing generated plans
2022-09-22 04:58:43 INFO  ---RUNTIME: Execution took 71070.34063339233 ms
2022-09-22 04:58:43 INFO  Done!
2022-09-22 04:58:43 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-22 04:58:43 INFO  Running instrumented original pipeline...
2022-09-22 04:58:44 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-22 04:58:44 INFO  ---RUNTIME: Importing and monkey-patching took 5.937099456787109 ms
2022-09-22 04:59:30 INFO  ---RUNTIME: Original pipeline execution took 47090.6720161438 ms (excluding imports and monkey-patching)
2022-09-22 04:59:30 INFO  Starting execution of 1 what-if analyses...
2022-09-22 04:59:30 INFO  Start plan generation for analysis DataCorruption...
2022-09-22 04:59:30 INFO  ---RUNTIME: Plan generation took 0.4525184631347656 ms
2022-09-22 04:59:30 INFO  Estimated runtime of original DAG is 39551.72276496887ms
2022-09-22 04:59:30 WARNING Skipping Multi-Query Optimization (instead, only applying patches)
2022-09-22 04:59:31 INFO  Estimated unoptimised what-if runtime is 988793.0691242218ms
2022-09-22 04:59:31 INFO  ---RUNTIME: Multi-Query Optimization took 23.015737533569336 ms
2022-09-22 04:59:31 INFO  Executing generated plans
2022-09-22 05:14:27 INFO  ---RUNTIME: Execution took 896883.3858966827 ms
2022-09-22 05:14:27 INFO  Done!
2022-09-22 05:14:27 INFO  # Finished -- repetition 1 of 7 
2022-09-22 05:14:27 INFO  # Optimization benchmark for data_corruption with args [['reviews', 'slow_loading', 'featurization_3', 'neural_network']] -- repetition 2 of 7
2022-09-22 05:14:27 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-22 05:14:27 INFO  Running instrumented original pipeline...
2022-09-22 05:14:27 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-22 05:14:27 INFO  ---RUNTIME: Importing and monkey-patching took 6.346464157104492 ms
2022-09-22 05:15:20 INFO  ---RUNTIME: Original pipeline execution took 52869.75717544556 ms (excluding imports and monkey-patching)
2022-09-22 05:15:20 INFO  Starting execution of 1 what-if analyses...
2022-09-22 05:15:20 INFO  Start plan generation for analysis DataCorruption...
2022-09-22 05:15:20 INFO  ---RUNTIME: Plan generation took 0.453948974609375 ms
2022-09-22 05:15:20 INFO  Estimated runtime of original DAG is 40849.3230342865ms
2022-09-22 05:15:20 INFO  Performing Multi-Query Optimization
2022-09-22 05:15:20 INFO  Estimated unoptimized what-if runtime is 1021233.0758571625ms
2022-09-22 05:15:20 INFO  Estimated optimised what-if runtime is 144258.1009864807ms
2022-09-22 05:15:20 INFO  Estimated optimisation runtime saving is 876974.9748706818ms
2022-09-22 05:15:20 INFO  ---RUNTIME: Multi-Query Optimization took 79.15306091308594 ms
2022-09-22 05:15:20 INFO  Executing generated plans
2022-09-22 05:16:43 INFO  ---RUNTIME: Execution took 82239.49694633484 ms
2022-09-22 05:16:43 INFO  Done!
2022-09-22 05:16:43 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-22 05:16:43 INFO  Running instrumented original pipeline...
2022-09-22 05:16:43 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-22 05:16:43 INFO  ---RUNTIME: Importing and monkey-patching took 6.48951530456543 ms
2022-09-22 05:17:30 INFO  ---RUNTIME: Original pipeline execution took 47629.30941581726 ms (excluding imports and monkey-patching)
2022-09-22 05:17:30 INFO  Starting execution of 1 what-if analyses...
2022-09-22 05:17:30 INFO  Start plan generation for analysis DataCorruption...
2022-09-22 05:17:30 INFO  ---RUNTIME: Plan generation took 0.44083595275878906 ms
2022-09-22 05:17:30 INFO  Estimated runtime of original DAG is 40339.42413330078ms
2022-09-22 05:17:30 WARNING Skipping Multi-Query Optimization (instead, only applying patches)
2022-09-22 05:17:30 INFO  Estimated unoptimised what-if runtime is 1008485.6033325195ms
2022-09-22 05:17:30 INFO  ---RUNTIME: Multi-Query Optimization took 22.9947566986084 ms
2022-09-22 05:17:30 INFO  Executing generated plans
2022-09-22 05:35:27 INFO  ---RUNTIME: Execution took 1076582.9310417175 ms
2022-09-22 05:35:27 INFO  Done!
2022-09-22 05:35:27 INFO  # Finished -- repetition 2 of 7 
2022-09-22 05:35:27 INFO  # Optimization benchmark for data_corruption with args [['reviews', 'slow_loading', 'featurization_3', 'neural_network']] -- repetition 3 of 7
2022-09-22 05:35:27 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-22 05:35:27 INFO  Running instrumented original pipeline...
2022-09-22 05:35:27 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-22 05:35:27 INFO  ---RUNTIME: Importing and monkey-patching took 6.289482116699219 ms
2022-09-22 05:36:23 INFO  ---RUNTIME: Original pipeline execution took 55507.93242454529 ms (excluding imports and monkey-patching)
2022-09-22 05:36:23 INFO  Starting execution of 1 what-if analyses...
2022-09-22 05:36:23 INFO  Start plan generation for analysis DataCorruption...
2022-09-22 05:36:23 INFO  ---RUNTIME: Plan generation took 1.2230873107910156 ms
2022-09-22 05:36:23 INFO  Estimated runtime of original DAG is 48245.54371833801ms
2022-09-22 05:36:23 INFO  Performing Multi-Query Optimization
2022-09-22 05:36:23 INFO  Estimated unoptimized what-if runtime is 1206138.5929584503ms
2022-09-22 05:36:23 INFO  Estimated optimised what-if runtime is 169465.29269218445ms
2022-09-22 05:36:23 INFO  Estimated optimisation runtime saving is 1036673.3002662659ms
2022-09-22 05:36:23 INFO  ---RUNTIME: Multi-Query Optimization took 78.22680473327637 ms
2022-09-22 05:36:23 INFO  Executing generated plans
2022-09-22 05:38:01 INFO  ---RUNTIME: Execution took 98361.20820045471 ms
2022-09-22 05:38:01 INFO  Done!
2022-09-22 05:38:02 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-22 05:38:02 INFO  Running instrumented original pipeline...
2022-09-22 05:38:02 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-22 05:38:02 INFO  ---RUNTIME: Importing and monkey-patching took 6.287813186645508 ms
2022-09-22 05:39:04 INFO  ---RUNTIME: Original pipeline execution took 61987.74242401123 ms (excluding imports and monkey-patching)
2022-09-22 05:39:04 INFO  Starting execution of 1 what-if analyses...
2022-09-22 05:39:04 INFO  Start plan generation for analysis DataCorruption...
2022-09-22 05:39:04 INFO  ---RUNTIME: Plan generation took 0.44226646423339844 ms
2022-09-22 05:39:04 INFO  Estimated runtime of original DAG is 49387.059450149536ms
2022-09-22 05:39:04 WARNING Skipping Multi-Query Optimization (instead, only applying patches)
2022-09-22 05:39:04 INFO  Estimated unoptimised what-if runtime is 1234676.4862537384ms
2022-09-22 05:39:04 INFO  ---RUNTIME: Multi-Query Optimization took 22.704124450683594 ms
2022-09-22 05:39:04 INFO  Executing generated plans
2022-09-22 05:59:24 INFO  ---RUNTIME: Execution took 1220149.5790481567 ms
2022-09-22 05:59:24 INFO  Done!
2022-09-22 05:59:24 INFO  # Finished -- repetition 3 of 7 
2022-09-22 05:59:24 INFO  # Optimization benchmark for data_corruption with args [['reviews', 'slow_loading', 'featurization_3', 'neural_network']] -- repetition 4 of 7
2022-09-22 05:59:24 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-22 05:59:24 INFO  Running instrumented original pipeline...
2022-09-22 05:59:25 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-22 05:59:25 INFO  ---RUNTIME: Importing and monkey-patching took 6.473302841186523 ms
2022-09-22 06:00:18 INFO  ---RUNTIME: Original pipeline execution took 53307.81960487366 ms (excluding imports and monkey-patching)
2022-09-22 06:00:18 INFO  Starting execution of 1 what-if analyses...
2022-09-22 06:00:18 INFO  Start plan generation for analysis DataCorruption...
2022-09-22 06:00:18 INFO  ---RUNTIME: Plan generation took 0.5424022674560547 ms
2022-09-22 06:00:18 INFO  Estimated runtime of original DAG is 45959.83362197876ms
2022-09-22 06:00:18 INFO  Performing Multi-Query Optimization
2022-09-22 06:00:18 INFO  Estimated unoptimized what-if runtime is 1148995.840549469ms
2022-09-22 06:00:18 INFO  Estimated optimised what-if runtime is 160576.84540748596ms
2022-09-22 06:00:18 INFO  Estimated optimisation runtime saving is 988418.995141983ms
2022-09-22 06:00:18 INFO  ---RUNTIME: Multi-Query Optimization took 113.82341384887695 ms
2022-09-22 06:00:18 INFO  Executing generated plans
2022-09-22 06:01:52 INFO  ---RUNTIME: Execution took 94317.34108924866 ms
2022-09-22 06:01:52 INFO  Done!
2022-09-22 06:01:52 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-22 06:01:52 INFO  Running instrumented original pipeline...
2022-09-22 06:01:52 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-22 06:01:52 INFO  ---RUNTIME: Importing and monkey-patching took 6.513357162475586 ms
2022-09-22 06:02:45 INFO  ---RUNTIME: Original pipeline execution took 52638.42153549194 ms (excluding imports and monkey-patching)
2022-09-22 06:02:45 INFO  Starting execution of 1 what-if analyses...
2022-09-22 06:02:45 INFO  Start plan generation for analysis DataCorruption...
2022-09-22 06:02:45 INFO  ---RUNTIME: Plan generation took 0.6453990936279297 ms
2022-09-22 06:02:45 INFO  Estimated runtime of original DAG is 43277.15277671814ms
2022-09-22 06:02:45 WARNING Skipping Multi-Query Optimization (instead, only applying patches)
2022-09-22 06:02:45 INFO  Estimated unoptimised what-if runtime is 1081928.8194179535ms
2022-09-22 06:02:45 INFO  ---RUNTIME: Multi-Query Optimization took 35.91036796569824 ms
2022-09-22 06:02:45 INFO  Executing generated plans
2022-09-22 06:22:19 INFO  ---RUNTIME: Execution took 1174314.8984909058 ms
2022-09-22 06:22:19 INFO  Done!
2022-09-22 06:22:21 INFO  # Finished -- repetition 4 of 7 
2022-09-22 06:22:21 INFO  # Optimization benchmark for data_corruption with args [['reviews', 'slow_loading', 'featurization_3', 'neural_network']] -- repetition 5 of 7
2022-09-22 06:22:21 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-22 06:22:21 INFO  Running instrumented original pipeline...
2022-09-22 06:22:21 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-22 06:22:21 INFO  ---RUNTIME: Importing and monkey-patching took 11.245250701904297 ms
2022-09-22 06:23:19 INFO  ---RUNTIME: Original pipeline execution took 57779.64186668396 ms (excluding imports and monkey-patching)
2022-09-22 06:23:19 INFO  Starting execution of 1 what-if analyses...
2022-09-22 06:23:19 INFO  Start plan generation for analysis DataCorruption...
2022-09-22 06:23:19 INFO  ---RUNTIME: Plan generation took 1.4195442199707031 ms
2022-09-22 06:23:19 INFO  Estimated runtime of original DAG is 45240.71478843689ms
2022-09-22 06:23:19 INFO  Performing Multi-Query Optimization
2022-09-22 06:23:19 INFO  Estimated unoptimized what-if runtime is 1131017.8697109222ms
2022-09-22 06:23:19 INFO  Estimated optimised what-if runtime is 167661.66353225708ms
2022-09-22 06:23:19 INFO  Estimated optimisation runtime saving is 963356.2061786652ms
2022-09-22 06:23:19 INFO  ---RUNTIME: Multi-Query Optimization took 167.47021675109863 ms
2022-09-22 06:23:19 INFO  Executing generated plans
2022-09-22 06:24:52 INFO  ---RUNTIME: Execution took 93279.82234954834 ms
2022-09-22 06:24:52 INFO  Done!
2022-09-22 06:24:52 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-22 06:24:52 INFO  Running instrumented original pipeline...
2022-09-22 06:24:52 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-22 06:24:52 INFO  ---RUNTIME: Importing and monkey-patching took 6.281375885009766 ms
2022-09-22 06:25:44 INFO  ---RUNTIME: Original pipeline execution took 51413.84506225586 ms (excluding imports and monkey-patching)
2022-09-22 06:25:44 INFO  Starting execution of 1 what-if analyses...
2022-09-22 06:25:44 INFO  Start plan generation for analysis DataCorruption...
2022-09-22 06:25:44 INFO  ---RUNTIME: Plan generation took 0.4367828369140625 ms
2022-09-22 06:25:44 INFO  Estimated runtime of original DAG is 44152.57406234741ms
2022-09-22 06:25:44 WARNING Skipping Multi-Query Optimization (instead, only applying patches)
2022-09-22 06:25:44 INFO  Estimated unoptimised what-if runtime is 1103814.3515586853ms
2022-09-22 06:25:44 INFO  ---RUNTIME: Multi-Query Optimization took 22.78280258178711 ms
2022-09-22 06:25:44 INFO  Executing generated plans
2022-09-22 06:43:01 INFO  ---RUNTIME: Execution took 1037340.5404090881 ms
2022-09-22 06:43:01 INFO  Done!
2022-09-22 06:43:01 INFO  # Finished -- repetition 5 of 7 
2022-09-22 06:43:01 INFO  # Optimization benchmark for data_corruption with args [['reviews', 'slow_loading', 'featurization_3', 'neural_network']] -- repetition 6 of 7
2022-09-22 06:43:01 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-22 06:43:01 INFO  Running instrumented original pipeline...
2022-09-22 06:43:01 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-22 06:43:01 INFO  ---RUNTIME: Importing and monkey-patching took 6.2465667724609375 ms
2022-09-22 06:43:50 INFO  ---RUNTIME: Original pipeline execution took 48835.58416366577 ms (excluding imports and monkey-patching)
2022-09-22 06:43:50 INFO  Starting execution of 1 what-if analyses...
2022-09-22 06:43:50 INFO  Start plan generation for analysis DataCorruption...
2022-09-22 06:43:50 INFO  ---RUNTIME: Plan generation took 1.3110637664794922 ms
2022-09-22 06:43:50 INFO  Estimated runtime of original DAG is 41501.67441368103ms
2022-09-22 06:43:50 INFO  Performing Multi-Query Optimization
2022-09-22 06:43:50 INFO  Estimated unoptimized what-if runtime is 1037541.8603420258ms
2022-09-22 06:43:50 INFO  Estimated optimised what-if runtime is 145927.84523963928ms
2022-09-22 06:43:50 INFO  Estimated optimisation runtime saving is 891614.0151023865ms
2022-09-22 06:43:50 INFO  ---RUNTIME: Multi-Query Optimization took 77.25834846496582 ms
2022-09-22 06:43:50 INFO  Executing generated plans
2022-09-22 06:45:15 INFO  ---RUNTIME: Execution took 84711.3893032074 ms
2022-09-22 06:45:15 INFO  Done!
2022-09-22 06:45:16 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-22 06:45:16 INFO  Running instrumented original pipeline...
2022-09-22 06:45:16 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-22 06:45:16 INFO  ---RUNTIME: Importing and monkey-patching took 6.884574890136719 ms
2022-09-22 06:46:09 INFO  ---RUNTIME: Original pipeline execution took 52804.52585220337 ms (excluding imports and monkey-patching)
2022-09-22 06:46:09 INFO  Starting execution of 1 what-if analyses...
2022-09-22 06:46:09 INFO  Start plan generation for analysis DataCorruption...
2022-09-22 06:46:09 INFO  ---RUNTIME: Plan generation took 0.4677772521972656 ms
2022-09-22 06:46:09 INFO  Estimated runtime of original DAG is 41200.72937011719ms
2022-09-22 06:46:09 WARNING Skipping Multi-Query Optimization (instead, only applying patches)
2022-09-22 06:46:09 INFO  Estimated unoptimised what-if runtime is 1030018.2342529297ms
2022-09-22 06:46:09 INFO  ---RUNTIME: Multi-Query Optimization took 23.604631423950195 ms
2022-09-22 06:46:09 INFO  Executing generated plans
2022-09-22 07:03:34 INFO  ---RUNTIME: Execution took 1045533.8790416718 ms
2022-09-22 07:03:34 INFO  Done!
2022-09-22 07:03:34 INFO  # Finished -- repetition 6 of 7 
2022-09-22 07:03:34 INFO  # Optimization benchmark for data_corruption with args [['reviews', 'slow_loading', 'featurization_3', 'neural_network']] -- repetition 7 of 7
2022-09-22 07:03:34 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-22 07:03:34 INFO  Running instrumented original pipeline...
2022-09-22 07:03:34 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-22 07:03:34 INFO  ---RUNTIME: Importing and monkey-patching took 6.230831146240234 ms
2022-09-22 07:04:23 INFO  ---RUNTIME: Original pipeline execution took 48647.63617515564 ms (excluding imports and monkey-patching)
2022-09-22 07:04:23 INFO  Starting execution of 1 what-if analyses...
2022-09-22 07:04:23 INFO  Start plan generation for analysis DataCorruption...
2022-09-22 07:04:23 INFO  ---RUNTIME: Plan generation took 0.5578994750976562 ms
2022-09-22 07:04:23 INFO  Estimated runtime of original DAG is 40584.40947532654ms
2022-09-22 07:04:23 INFO  Performing Multi-Query Optimization
2022-09-22 07:04:23 INFO  Estimated unoptimized what-if runtime is 1014610.2368831635ms
2022-09-22 07:04:23 INFO  Estimated optimised what-if runtime is 145490.63849449158ms
2022-09-22 07:04:23 INFO  Estimated optimisation runtime saving is 869119.5983886719ms
2022-09-22 07:04:23 INFO  ---RUNTIME: Multi-Query Optimization took 88.8524055480957 ms
2022-09-22 07:04:23 INFO  Executing generated plans
2022-09-22 07:05:50 INFO  ---RUNTIME: Execution took 86506.75797462463 ms
2022-09-22 07:05:50 INFO  Done!
2022-09-22 07:05:50 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-22 07:05:50 INFO  Running instrumented original pipeline...
2022-09-22 07:05:50 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-22 07:05:50 INFO  ---RUNTIME: Importing and monkey-patching took 6.400346755981445 ms
2022-09-22 07:06:38 INFO  ---RUNTIME: Original pipeline execution took 48075.07920265198 ms (excluding imports and monkey-patching)
2022-09-22 07:06:38 INFO  Starting execution of 1 what-if analyses...
2022-09-22 07:06:38 INFO  Start plan generation for analysis DataCorruption...
2022-09-22 07:06:38 INFO  ---RUNTIME: Plan generation took 0.4706382751464844 ms
2022-09-22 07:06:38 INFO  Estimated runtime of original DAG is 40596.88973426819ms
2022-09-22 07:06:38 WARNING Skipping Multi-Query Optimization (instead, only applying patches)
2022-09-22 07:06:38 INFO  Estimated unoptimised what-if runtime is 1014922.2433567047ms
2022-09-22 07:06:38 INFO  ---RUNTIME: Multi-Query Optimization took 24.141788482666016 ms
2022-09-22 07:06:38 INFO  Executing generated plans
2022-09-22 07:23:08 INFO  ---RUNTIME: Execution took 989988.5489940643 ms
2022-09-22 07:23:08 INFO  Done!
2022-09-22 07:23:09 INFO  # Finished -- repetition 7 of 7 
2022-09-22 07:23:09 INFO  # Final results after all repetitions
2022-09-22 07:23:09 INFO     repetition  ... no_opt_what_if_execution_combined_model_training
0           0  ...                                    150138.850927
1           1  ...                                    160417.101145
2           2  ...                                    178506.023407
3           3  ...                                    183123.072624
4           4  ...                                    158056.013346
5           5  ...                                    154514.350176
6           6  ...                                    151666.770697

[7 rows x 26 columns]
taskset -c 32-39 PROTOCOL_BUFFERS_PYTHON_IMPLEMENTATION=python python3.9 benchmarks_end_to_end.py data_corruption reviews slow_loading featurization_4 logistic_regression
2022-09-22 07:23:12.758219: W tensorflow/stream_executor/platform/default/dso_loader.cc:64] Could not load dynamic library 'libcudart.so.11.0'; dlerror: libcudart.so.11.0: cannot open shared object file: No such file or directory; LD_LIBRARY_PATH: /home/sgrafbe/mlwhatif/venv/lib/python3.9/site-packages/cv2/../../lib64:
2022-09-22 07:23:12.758262: I tensorflow/stream_executor/cuda/cudart_stub.cc:29] Ignore above cudart dlerror if you do not have a GPU set up on your machine.
2022-09-22 07:23:13 INFO  Patching sys.argv with ['mlwhatif', 'reviews', 'slow_loading', 'featurization_4', 'logistic_regression']
2022-09-22 07:23:13 INFO  Running instrumented original pipeline...
2022-09-22 07:23:14 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-22 07:23:14 INFO  ---RUNTIME: Importing and monkey-patching took 97.11098670959473 ms
2022-09-22 07:23:27 INFO  ---RUNTIME: Original pipeline execution took 13022.197723388672 ms (excluding imports and monkey-patching)
2022-09-22 07:23:27 INFO  Starting execution of 0 what-if analyses...
2022-09-22 07:23:27 INFO  Estimated runtime of original DAG is 9729.917764663696ms
2022-09-22 07:23:27 INFO  Performing Multi-Query Optimization
2022-09-22 07:23:27 INFO  Estimated unoptimized what-if runtime is 0ms
2022-09-22 07:23:27 INFO  Estimated optimised what-if runtime is 0ms
2022-09-22 07:23:27 INFO  Estimated optimisation runtime saving is 0ms
2022-09-22 07:23:27 INFO  ---RUNTIME: Multi-Query Optimization took 0.5261898040771484 ms
2022-09-22 07:23:27 INFO  Executing generated plans
2022-09-22 07:23:27 INFO  ---RUNTIME: Execution took 0.02384185791015625 ms
2022-09-22 07:23:27 INFO  Done!
2022-09-22 07:23:27 INFO  # Optimization benchmark for data_corruption with args [['reviews', 'slow_loading', 'featurization_4', 'logistic_regression']] -- repetition 1 of 7
2022-09-22 07:23:27 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-22 07:23:27 INFO  Running instrumented original pipeline...
2022-09-22 07:23:27 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-22 07:23:27 INFO  ---RUNTIME: Importing and monkey-patching took 6.130456924438477 ms
2022-09-22 07:23:40 INFO  ---RUNTIME: Original pipeline execution took 12973.669290542603 ms (excluding imports and monkey-patching)
2022-09-22 07:23:40 INFO  Starting execution of 1 what-if analyses...
2022-09-22 07:23:40 INFO  Start plan generation for analysis DataCorruption...
2022-09-22 07:23:40 INFO  ---RUNTIME: Plan generation took 0.43010711669921875 ms
2022-09-22 07:23:40 INFO  Estimated runtime of original DAG is 9753.197431564331ms
2022-09-22 07:23:40 INFO  Performing Multi-Query Optimization
2022-09-22 07:23:40 INFO  Estimated unoptimized what-if runtime is 243829.93578910828ms
2022-09-22 07:23:40 INFO  Estimated optimised what-if runtime is 10828.746318817139ms
2022-09-22 07:23:40 INFO  Estimated optimisation runtime saving is 233001.18947029114ms
2022-09-22 07:23:40 INFO  ---RUNTIME: Multi-Query Optimization took 69.44060325622559 ms
2022-09-22 07:23:40 INFO  Executing generated plans
2022-09-22 07:23:56 INFO  ---RUNTIME: Execution took 16018.413305282593 ms
2022-09-22 07:23:56 INFO  Done!
2022-09-22 07:23:56 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-22 07:23:56 INFO  Running instrumented original pipeline...
2022-09-22 07:23:56 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-22 07:23:56 INFO  ---RUNTIME: Importing and monkey-patching took 6.197452545166016 ms
2022-09-22 07:24:09 INFO  ---RUNTIME: Original pipeline execution took 12856.19592666626 ms (excluding imports and monkey-patching)
2022-09-22 07:24:09 INFO  Starting execution of 1 what-if analyses...
2022-09-22 07:24:09 INFO  Start plan generation for analysis DataCorruption...
2022-09-22 07:24:09 INFO  ---RUNTIME: Plan generation took 0.4487037658691406 ms
2022-09-22 07:24:09 INFO  Estimated runtime of original DAG is 9617.913722991943ms
2022-09-22 07:24:09 WARNING Skipping Multi-Query Optimization (instead, only applying patches)
2022-09-22 07:24:09 INFO  Estimated unoptimised what-if runtime is 240447.84307479858ms
2022-09-22 07:24:09 INFO  ---RUNTIME: Multi-Query Optimization took 204.2520046234131 ms
2022-09-22 07:24:09 INFO  Executing generated plans
2022-09-22 07:28:46 INFO  ---RUNTIME: Execution took 277596.91739082336 ms
2022-09-22 07:28:46 INFO  Done!
2022-09-22 07:28:46 INFO  # Finished -- repetition 1 of 7 
2022-09-22 07:28:46 INFO  # Optimization benchmark for data_corruption with args [['reviews', 'slow_loading', 'featurization_4', 'logistic_regression']] -- repetition 2 of 7
2022-09-22 07:28:46 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-22 07:28:46 INFO  Running instrumented original pipeline...
2022-09-22 07:28:46 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-22 07:28:46 INFO  ---RUNTIME: Importing and monkey-patching took 5.977630615234375 ms
2022-09-22 07:28:59 INFO  ---RUNTIME: Original pipeline execution took 12915.60173034668 ms (excluding imports and monkey-patching)
2022-09-22 07:28:59 INFO  Starting execution of 1 what-if analyses...
2022-09-22 07:28:59 INFO  Start plan generation for analysis DataCorruption...
2022-09-22 07:28:59 INFO  ---RUNTIME: Plan generation took 0.4258155822753906 ms
2022-09-22 07:28:59 INFO  Estimated runtime of original DAG is 9508.987426757812ms
2022-09-22 07:28:59 INFO  Performing Multi-Query Optimization
2022-09-22 07:28:59 INFO  Estimated unoptimized what-if runtime is 237724.6856689453ms
2022-09-22 07:28:59 INFO  Estimated optimised what-if runtime is 10574.726819992065ms
2022-09-22 07:28:59 INFO  Estimated optimisation runtime saving is 227149.95884895325ms
2022-09-22 07:28:59 INFO  ---RUNTIME: Multi-Query Optimization took 69.17619705200195 ms
2022-09-22 07:28:59 INFO  Executing generated plans
2022-09-22 07:29:15 INFO  ---RUNTIME: Execution took 15787.374258041382 ms
2022-09-22 07:29:15 INFO  Done!
2022-09-22 07:29:15 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-22 07:29:15 INFO  Running instrumented original pipeline...
2022-09-22 07:29:15 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-22 07:29:15 INFO  ---RUNTIME: Importing and monkey-patching took 5.845546722412109 ms
2022-09-22 07:29:28 INFO  ---RUNTIME: Original pipeline execution took 13057.841777801514 ms (excluding imports and monkey-patching)
2022-09-22 07:29:28 INFO  Starting execution of 1 what-if analyses...
2022-09-22 07:29:28 INFO  Start plan generation for analysis DataCorruption...
2022-09-22 07:29:28 INFO  ---RUNTIME: Plan generation took 0.4417896270751953 ms
2022-09-22 07:29:28 INFO  Estimated runtime of original DAG is 9613.109827041626ms
2022-09-22 07:29:28 WARNING Skipping Multi-Query Optimization (instead, only applying patches)
2022-09-22 07:29:28 INFO  Estimated unoptimised what-if runtime is 240327.74567604065ms
2022-09-22 07:29:28 INFO  ---RUNTIME: Multi-Query Optimization took 20.227432250976562 ms
2022-09-22 07:29:28 INFO  Executing generated plans
2022-09-22 07:34:05 INFO  ---RUNTIME: Execution took 276790.2407646179 ms
2022-09-22 07:34:05 INFO  Done!
2022-09-22 07:34:05 INFO  # Finished -- repetition 2 of 7 
2022-09-22 07:34:05 INFO  # Optimization benchmark for data_corruption with args [['reviews', 'slow_loading', 'featurization_4', 'logistic_regression']] -- repetition 3 of 7
2022-09-22 07:34:05 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-22 07:34:05 INFO  Running instrumented original pipeline...
2022-09-22 07:34:05 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-22 07:34:05 INFO  ---RUNTIME: Importing and monkey-patching took 5.924701690673828 ms
2022-09-22 07:34:18 INFO  ---RUNTIME: Original pipeline execution took 13020.395278930664 ms (excluding imports and monkey-patching)
2022-09-22 07:34:18 INFO  Starting execution of 1 what-if analyses...
2022-09-22 07:34:18 INFO  Start plan generation for analysis DataCorruption...
2022-09-22 07:34:18 INFO  ---RUNTIME: Plan generation took 0.4496574401855469 ms
2022-09-22 07:34:18 INFO  Estimated runtime of original DAG is 9579.433679580688ms
2022-09-22 07:34:18 INFO  Performing Multi-Query Optimization
2022-09-22 07:34:18 INFO  Estimated unoptimized what-if runtime is 239485.8419895172ms
2022-09-22 07:34:18 INFO  Estimated optimised what-if runtime is 10651.249885559082ms
2022-09-22 07:34:18 INFO  Estimated optimisation runtime saving is 228834.59210395813ms
2022-09-22 07:34:18 INFO  ---RUNTIME: Multi-Query Optimization took 67.98601150512695 ms
2022-09-22 07:34:18 INFO  Executing generated plans
2022-09-22 07:34:34 INFO  ---RUNTIME: Execution took 15980.625629425049 ms
2022-09-22 07:34:34 INFO  Done!
2022-09-22 07:34:34 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-22 07:34:34 INFO  Running instrumented original pipeline...
2022-09-22 07:34:34 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-22 07:34:34 INFO  ---RUNTIME: Importing and monkey-patching took 6.189107894897461 ms
2022-09-22 07:34:47 INFO  ---RUNTIME: Original pipeline execution took 13338.279962539673 ms (excluding imports and monkey-patching)
2022-09-22 07:34:47 INFO  Starting execution of 1 what-if analyses...
2022-09-22 07:34:47 INFO  Start plan generation for analysis DataCorruption...
2022-09-22 07:34:47 INFO  ---RUNTIME: Plan generation took 0.4298686981201172 ms
2022-09-22 07:34:47 INFO  Estimated runtime of original DAG is 10152.852058410645ms
2022-09-22 07:34:47 WARNING Skipping Multi-Query Optimization (instead, only applying patches)
2022-09-22 07:34:47 INFO  Estimated unoptimised what-if runtime is 253821.3014602661ms
2022-09-22 07:34:47 INFO  ---RUNTIME: Multi-Query Optimization took 20.203590393066406 ms
2022-09-22 07:34:47 INFO  Executing generated plans
2022-09-22 07:39:24 INFO  ---RUNTIME: Execution took 276581.6969871521 ms
2022-09-22 07:39:24 INFO  Done!
2022-09-22 07:39:24 INFO  # Finished -- repetition 3 of 7 
2022-09-22 07:39:24 INFO  # Optimization benchmark for data_corruption with args [['reviews', 'slow_loading', 'featurization_4', 'logistic_regression']] -- repetition 4 of 7
2022-09-22 07:39:24 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-22 07:39:24 INFO  Running instrumented original pipeline...
2022-09-22 07:39:24 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-22 07:39:24 INFO  ---RUNTIME: Importing and monkey-patching took 5.996227264404297 ms
2022-09-22 07:39:37 INFO  ---RUNTIME: Original pipeline execution took 12975.877523422241 ms (excluding imports and monkey-patching)
2022-09-22 07:39:37 INFO  Starting execution of 1 what-if analyses...
2022-09-22 07:39:37 INFO  Start plan generation for analysis DataCorruption...
2022-09-22 07:39:37 INFO  ---RUNTIME: Plan generation took 0.4496574401855469 ms
2022-09-22 07:39:37 INFO  Estimated runtime of original DAG is 9516.796112060547ms
2022-09-22 07:39:37 INFO  Performing Multi-Query Optimization
2022-09-22 07:39:37 INFO  Estimated unoptimized what-if runtime is 237919.90280151367ms
2022-09-22 07:39:37 INFO  Estimated optimised what-if runtime is 10591.859817504883ms
2022-09-22 07:39:37 INFO  Estimated optimisation runtime saving is 227328.0429840088ms
2022-09-22 07:39:37 INFO  ---RUNTIME: Multi-Query Optimization took 68.81070137023926 ms
2022-09-22 07:39:37 INFO  Executing generated plans
2022-09-22 07:39:53 INFO  ---RUNTIME: Execution took 16161.996603012085 ms
2022-09-22 07:39:53 INFO  Done!
2022-09-22 07:39:53 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-22 07:39:53 INFO  Running instrumented original pipeline...
2022-09-22 07:39:53 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-22 07:39:53 INFO  ---RUNTIME: Importing and monkey-patching took 6.301641464233398 ms
2022-09-22 07:40:06 INFO  ---RUNTIME: Original pipeline execution took 13076.256036758423 ms (excluding imports and monkey-patching)
2022-09-22 07:40:06 INFO  Starting execution of 1 what-if analyses...
2022-09-22 07:40:06 INFO  Start plan generation for analysis DataCorruption...
2022-09-22 07:40:06 INFO  ---RUNTIME: Plan generation took 0.43773651123046875 ms
2022-09-22 07:40:06 INFO  Estimated runtime of original DAG is 9589.258432388306ms
2022-09-22 07:40:06 WARNING Skipping Multi-Query Optimization (instead, only applying patches)
2022-09-22 07:40:06 INFO  Estimated unoptimised what-if runtime is 239731.46080970764ms
2022-09-22 07:40:06 INFO  ---RUNTIME: Multi-Query Optimization took 20.27153968811035 ms
2022-09-22 07:40:06 INFO  Executing generated plans
2022-09-22 07:44:43 INFO  ---RUNTIME: Execution took 276884.40322875977 ms
2022-09-22 07:44:43 INFO  Done!
2022-09-22 07:44:43 INFO  # Finished -- repetition 4 of 7 
2022-09-22 07:44:43 INFO  # Optimization benchmark for data_corruption with args [['reviews', 'slow_loading', 'featurization_4', 'logistic_regression']] -- repetition 5 of 7
2022-09-22 07:44:43 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-22 07:44:43 INFO  Running instrumented original pipeline...
2022-09-22 07:44:43 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-22 07:44:43 INFO  ---RUNTIME: Importing and monkey-patching took 5.856990814208984 ms
2022-09-22 07:44:57 INFO  ---RUNTIME: Original pipeline execution took 13739.245891571045 ms (excluding imports and monkey-patching)
2022-09-22 07:44:57 INFO  Starting execution of 1 what-if analyses...
2022-09-22 07:44:57 INFO  Start plan generation for analysis DataCorruption...
2022-09-22 07:44:57 INFO  ---RUNTIME: Plan generation took 0.41031837463378906 ms
2022-09-22 07:44:57 INFO  Estimated runtime of original DAG is 10266.19553565979ms
2022-09-22 07:44:57 INFO  Performing Multi-Query Optimization
2022-09-22 07:44:57 INFO  Estimated unoptimized what-if runtime is 256654.88839149475ms
2022-09-22 07:44:57 INFO  Estimated optimised what-if runtime is 11362.531423568726ms
2022-09-22 07:44:57 INFO  Estimated optimisation runtime saving is 245292.35696792603ms
2022-09-22 07:44:57 INFO  ---RUNTIME: Multi-Query Optimization took 68.84312629699707 ms
2022-09-22 07:44:57 INFO  Executing generated plans
2022-09-22 07:45:13 INFO  ---RUNTIME: Execution took 15741.528987884521 ms
2022-09-22 07:45:13 INFO  Done!
2022-09-22 07:45:13 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-22 07:45:13 INFO  Running instrumented original pipeline...
2022-09-22 07:45:13 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-22 07:45:13 INFO  ---RUNTIME: Importing and monkey-patching took 6.057262420654297 ms
2022-09-22 07:45:26 INFO  ---RUNTIME: Original pipeline execution took 12972.685813903809 ms (excluding imports and monkey-patching)
2022-09-22 07:45:26 INFO  Starting execution of 1 what-if analyses...
2022-09-22 07:45:26 INFO  Start plan generation for analysis DataCorruption...
2022-09-22 07:45:26 INFO  ---RUNTIME: Plan generation took 0.45180320739746094 ms
2022-09-22 07:45:26 INFO  Estimated runtime of original DAG is 9526.01957321167ms
2022-09-22 07:45:26 WARNING Skipping Multi-Query Optimization (instead, only applying patches)
2022-09-22 07:45:26 INFO  Estimated unoptimised what-if runtime is 238150.48933029175ms
2022-09-22 07:45:26 INFO  ---RUNTIME: Multi-Query Optimization took 20.093679428100586 ms
2022-09-22 07:45:26 INFO  Executing generated plans
2022-09-22 07:50:03 INFO  ---RUNTIME: Execution took 277299.54743385315 ms
2022-09-22 07:50:03 INFO  Done!
2022-09-22 07:50:03 INFO  # Finished -- repetition 5 of 7 
2022-09-22 07:50:03 INFO  # Optimization benchmark for data_corruption with args [['reviews', 'slow_loading', 'featurization_4', 'logistic_regression']] -- repetition 6 of 7
2022-09-22 07:50:03 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-22 07:50:03 INFO  Running instrumented original pipeline...
2022-09-22 07:50:03 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-22 07:50:03 INFO  ---RUNTIME: Importing and monkey-patching took 5.940675735473633 ms
2022-09-22 07:50:16 INFO  ---RUNTIME: Original pipeline execution took 12898.923635482788 ms (excluding imports and monkey-patching)
2022-09-22 07:50:16 INFO  Starting execution of 1 what-if analyses...
2022-09-22 07:50:16 INFO  Start plan generation for analysis DataCorruption...
2022-09-22 07:50:16 INFO  ---RUNTIME: Plan generation took 0.5061626434326172 ms
2022-09-22 07:50:16 INFO  Estimated runtime of original DAG is 9689.095973968506ms
2022-09-22 07:50:16 INFO  Performing Multi-Query Optimization
2022-09-22 07:50:16 INFO  Estimated unoptimized what-if runtime is 242227.39934921265ms
2022-09-22 07:50:16 INFO  Estimated optimised what-if runtime is 10772.733688354492ms
2022-09-22 07:50:16 INFO  Estimated optimisation runtime saving is 231454.66566085815ms
2022-09-22 07:50:16 INFO  ---RUNTIME: Multi-Query Optimization took 294.4343090057373 ms
2022-09-22 07:50:16 INFO  Executing generated plans
2022-09-22 07:50:32 INFO  ---RUNTIME: Execution took 15875.874042510986 ms
2022-09-22 07:50:32 INFO  Done!
2022-09-22 07:50:32 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-22 07:50:32 INFO  Running instrumented original pipeline...
2022-09-22 07:50:32 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-22 07:50:32 INFO  ---RUNTIME: Importing and monkey-patching took 6.03485107421875 ms
2022-09-22 07:50:45 INFO  ---RUNTIME: Original pipeline execution took 12825.23775100708 ms (excluding imports and monkey-patching)
2022-09-22 07:50:45 INFO  Starting execution of 1 what-if analyses...
2022-09-22 07:50:45 INFO  Start plan generation for analysis DataCorruption...
2022-09-22 07:50:45 INFO  ---RUNTIME: Plan generation took 0.4200935363769531 ms
2022-09-22 07:50:45 INFO  Estimated runtime of original DAG is 9598.918676376343ms
2022-09-22 07:50:45 WARNING Skipping Multi-Query Optimization (instead, only applying patches)
2022-09-22 07:50:45 INFO  Estimated unoptimised what-if runtime is 239972.96690940857ms
2022-09-22 07:50:45 INFO  ---RUNTIME: Multi-Query Optimization took 19.797563552856445 ms
2022-09-22 07:50:45 INFO  Executing generated plans
2022-09-22 07:55:23 INFO  ---RUNTIME: Execution took 277710.35051345825 ms
2022-09-22 07:55:23 INFO  Done!
2022-09-22 07:55:23 INFO  # Finished -- repetition 6 of 7 
2022-09-22 07:55:23 INFO  # Optimization benchmark for data_corruption with args [['reviews', 'slow_loading', 'featurization_4', 'logistic_regression']] -- repetition 7 of 7
2022-09-22 07:55:23 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-22 07:55:23 INFO  Running instrumented original pipeline...
2022-09-22 07:55:23 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-22 07:55:23 INFO  ---RUNTIME: Importing and monkey-patching took 5.9375762939453125 ms
2022-09-22 07:55:36 INFO  ---RUNTIME: Original pipeline execution took 13042.835474014282 ms (excluding imports and monkey-patching)
2022-09-22 07:55:36 INFO  Starting execution of 1 what-if analyses...
2022-09-22 07:55:36 INFO  Start plan generation for analysis DataCorruption...
2022-09-22 07:55:36 INFO  ---RUNTIME: Plan generation took 0.41747093200683594 ms
2022-09-22 07:55:36 INFO  Estimated runtime of original DAG is 9587.612390518188ms
2022-09-22 07:55:36 INFO  Performing Multi-Query Optimization
2022-09-22 07:55:36 INFO  Estimated unoptimized what-if runtime is 239690.3097629547ms
2022-09-22 07:55:36 INFO  Estimated optimised what-if runtime is 10667.644023895264ms
2022-09-22 07:55:36 INFO  Estimated optimisation runtime saving is 229022.66573905945ms
2022-09-22 07:55:36 INFO  ---RUNTIME: Multi-Query Optimization took 68.34912300109863 ms
2022-09-22 07:55:36 INFO  Executing generated plans
2022-09-22 07:55:52 INFO  ---RUNTIME: Execution took 15769.209384918213 ms
2022-09-22 07:55:52 INFO  Done!
2022-09-22 07:55:52 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-22 07:55:52 INFO  Running instrumented original pipeline...
2022-09-22 07:55:52 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-22 07:55:52 INFO  ---RUNTIME: Importing and monkey-patching took 5.7582855224609375 ms
2022-09-22 07:56:05 INFO  ---RUNTIME: Original pipeline execution took 13097.308874130249 ms (excluding imports and monkey-patching)
2022-09-22 07:56:05 INFO  Starting execution of 1 what-if analyses...
2022-09-22 07:56:05 INFO  Start plan generation for analysis DataCorruption...
2022-09-22 07:56:05 INFO  ---RUNTIME: Plan generation took 0.4277229309082031 ms
2022-09-22 07:56:05 INFO  Estimated runtime of original DAG is 9888.99278640747ms
2022-09-22 07:56:05 WARNING Skipping Multi-Query Optimization (instead, only applying patches)
2022-09-22 07:56:05 INFO  Estimated unoptimised what-if runtime is 247224.81966018677ms
2022-09-22 07:56:05 INFO  ---RUNTIME: Multi-Query Optimization took 19.78445053100586 ms
2022-09-22 07:56:05 INFO  Executing generated plans
2022-09-22 08:00:41 INFO  ---RUNTIME: Execution took 276368.8623905182 ms
2022-09-22 08:00:41 INFO  Done!
2022-09-22 08:00:41 INFO  # Finished -- repetition 7 of 7 
2022-09-22 08:00:41 INFO  # Final results after all repetitions
2022-09-22 08:00:41 INFO     repetition  ... no_opt_what_if_execution_combined_model_training
0           0  ...                                      4529.491901
1           1  ...                                      4533.116102
2           2  ...                                      4540.117264
3           3  ...                                      4532.791853
4           4  ...                                      4518.294811
5           5  ...                                      4521.252155
6           6  ...                                      4529.526234

[7 rows x 26 columns]
taskset -c 32-39 PROTOCOL_BUFFERS_PYTHON_IMPLEMENTATION=python python3.9 benchmarks_end_to_end.py data_corruption reviews slow_loading featurization_4 xgboost
2022-09-22 08:00:43.803449: W tensorflow/stream_executor/platform/default/dso_loader.cc:64] Could not load dynamic library 'libcudart.so.11.0'; dlerror: libcudart.so.11.0: cannot open shared object file: No such file or directory; LD_LIBRARY_PATH: /home/sgrafbe/mlwhatif/venv/lib/python3.9/site-packages/cv2/../../lib64:
2022-09-22 08:00:43.803492: I tensorflow/stream_executor/cuda/cudart_stub.cc:29] Ignore above cudart dlerror if you do not have a GPU set up on your machine.
2022-09-22 08:00:45 INFO  Patching sys.argv with ['mlwhatif', 'reviews', 'slow_loading', 'featurization_4', 'xgboost']
2022-09-22 08:00:45 INFO  Running instrumented original pipeline...
2022-09-22 08:00:45 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-22 08:00:45 INFO  ---RUNTIME: Importing and monkey-patching took 96.4515209197998 ms
2022-09-22 08:01:01 INFO  ---RUNTIME: Original pipeline execution took 16301.398515701294 ms (excluding imports and monkey-patching)
2022-09-22 08:01:01 INFO  Starting execution of 0 what-if analyses...
2022-09-22 08:01:01 INFO  Estimated runtime of original DAG is 13047.985076904297ms
2022-09-22 08:01:01 INFO  Performing Multi-Query Optimization
2022-09-22 08:01:01 INFO  Estimated unoptimized what-if runtime is 0ms
2022-09-22 08:01:01 INFO  Estimated optimised what-if runtime is 0ms
2022-09-22 08:01:01 INFO  Estimated optimisation runtime saving is 0ms
2022-09-22 08:01:01 INFO  ---RUNTIME: Multi-Query Optimization took 0.5726814270019531 ms
2022-09-22 08:01:01 INFO  Executing generated plans
2022-09-22 08:01:01 INFO  ---RUNTIME: Execution took 0.02384185791015625 ms
2022-09-22 08:01:01 INFO  Done!
2022-09-22 08:01:01 INFO  # Optimization benchmark for data_corruption with args [['reviews', 'slow_loading', 'featurization_4', 'xgboost']] -- repetition 1 of 7
2022-09-22 08:01:01 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-22 08:01:01 INFO  Running instrumented original pipeline...
2022-09-22 08:01:01 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-22 08:01:01 INFO  ---RUNTIME: Importing and monkey-patching took 5.619049072265625 ms
2022-09-22 08:01:17 INFO  ---RUNTIME: Original pipeline execution took 16248.137712478638 ms (excluding imports and monkey-patching)
2022-09-22 08:01:17 INFO  Starting execution of 1 what-if analyses...
2022-09-22 08:01:17 INFO  Start plan generation for analysis DataCorruption...
2022-09-22 08:01:17 INFO  ---RUNTIME: Plan generation took 0.43392181396484375 ms
2022-09-22 08:01:17 INFO  Estimated runtime of original DAG is 13040.488004684448ms
2022-09-22 08:01:17 INFO  Performing Multi-Query Optimization
2022-09-22 08:01:17 INFO  Estimated unoptimized what-if runtime is 326012.2001171112ms
2022-09-22 08:01:17 INFO  Estimated optimised what-if runtime is 15027.943134307861ms
2022-09-22 08:01:17 INFO  Estimated optimisation runtime saving is 310984.25698280334ms
2022-09-22 08:01:17 INFO  ---RUNTIME: Multi-Query Optimization took 69.04244422912598 ms
2022-09-22 08:01:17 INFO  Executing generated plans
2022-09-22 08:01:37 INFO  ---RUNTIME: Execution took 20107.682466506958 ms
2022-09-22 08:01:37 INFO  Done!
2022-09-22 08:01:37 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-22 08:01:37 INFO  Running instrumented original pipeline...
2022-09-22 08:01:37 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-22 08:01:37 INFO  ---RUNTIME: Importing and monkey-patching took 6.251096725463867 ms
2022-09-22 08:01:54 INFO  ---RUNTIME: Original pipeline execution took 16181.48159980774 ms (excluding imports and monkey-patching)
2022-09-22 08:01:54 INFO  Starting execution of 1 what-if analyses...
2022-09-22 08:01:54 INFO  Start plan generation for analysis DataCorruption...
2022-09-22 08:01:54 INFO  ---RUNTIME: Plan generation took 0.46133995056152344 ms
2022-09-22 08:01:54 INFO  Estimated runtime of original DAG is 12989.951133728027ms
2022-09-22 08:01:54 WARNING Skipping Multi-Query Optimization (instead, only applying patches)
2022-09-22 08:01:54 INFO  Estimated unoptimised what-if runtime is 324748.7783432007ms
2022-09-22 08:01:54 INFO  ---RUNTIME: Multi-Query Optimization took 197.24345207214355 ms
2022-09-22 08:01:54 INFO  Executing generated plans
2022-09-22 08:07:49 INFO  ---RUNTIME: Execution took 355097.67961502075 ms
2022-09-22 08:07:49 INFO  Done!
2022-09-22 08:07:49 INFO  # Finished -- repetition 1 of 7 
2022-09-22 08:07:49 INFO  # Optimization benchmark for data_corruption with args [['reviews', 'slow_loading', 'featurization_4', 'xgboost']] -- repetition 2 of 7
2022-09-22 08:07:49 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-22 08:07:49 INFO  Running instrumented original pipeline...
2022-09-22 08:07:49 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-22 08:07:49 INFO  ---RUNTIME: Importing and monkey-patching took 5.858421325683594 ms
2022-09-22 08:08:05 INFO  ---RUNTIME: Original pipeline execution took 16222.662925720215 ms (excluding imports and monkey-patching)
2022-09-22 08:08:05 INFO  Starting execution of 1 what-if analyses...
2022-09-22 08:08:05 INFO  Start plan generation for analysis DataCorruption...
2022-09-22 08:08:05 INFO  ---RUNTIME: Plan generation took 0.4208087921142578 ms
2022-09-22 08:08:05 INFO  Estimated runtime of original DAG is 12833.15396308899ms
2022-09-22 08:08:05 INFO  Performing Multi-Query Optimization
2022-09-22 08:08:05 INFO  Estimated unoptimized what-if runtime is 320828.84907722473ms
2022-09-22 08:08:05 INFO  Estimated optimised what-if runtime is 14835.916519165039ms
2022-09-22 08:08:05 INFO  Estimated optimisation runtime saving is 305992.9325580597ms
2022-09-22 08:08:05 INFO  ---RUNTIME: Multi-Query Optimization took 68.36080551147461 ms
2022-09-22 08:08:05 INFO  Executing generated plans
2022-09-22 08:08:25 INFO  ---RUNTIME: Execution took 19738.401412963867 ms
2022-09-22 08:08:25 INFO  Done!
2022-09-22 08:08:25 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-22 08:08:25 INFO  Running instrumented original pipeline...
2022-09-22 08:08:25 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-22 08:08:25 INFO  ---RUNTIME: Importing and monkey-patching took 5.998373031616211 ms
2022-09-22 08:08:41 INFO  ---RUNTIME: Original pipeline execution took 16159.74760055542 ms (excluding imports and monkey-patching)
2022-09-22 08:08:41 INFO  Starting execution of 1 what-if analyses...
2022-09-22 08:08:41 INFO  Start plan generation for analysis DataCorruption...
2022-09-22 08:08:41 INFO  ---RUNTIME: Plan generation took 0.4444122314453125 ms
2022-09-22 08:08:41 INFO  Estimated runtime of original DAG is 12742.552995681763ms
2022-09-22 08:08:41 WARNING Skipping Multi-Query Optimization (instead, only applying patches)
2022-09-22 08:08:41 INFO  Estimated unoptimised what-if runtime is 318563.82489204407ms
2022-09-22 08:08:41 INFO  ---RUNTIME: Multi-Query Optimization took 20.57480812072754 ms
2022-09-22 08:08:41 INFO  Executing generated plans
2022-09-22 08:14:35 INFO  ---RUNTIME: Execution took 354355.05843162537 ms
2022-09-22 08:14:35 INFO  Done!
2022-09-22 08:14:35 INFO  # Finished -- repetition 2 of 7 
2022-09-22 08:14:35 INFO  # Optimization benchmark for data_corruption with args [['reviews', 'slow_loading', 'featurization_4', 'xgboost']] -- repetition 3 of 7
2022-09-22 08:14:35 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-22 08:14:35 INFO  Running instrumented original pipeline...
2022-09-22 08:14:36 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-22 08:14:36 INFO  ---RUNTIME: Importing and monkey-patching took 5.908489227294922 ms
2022-09-22 08:14:52 INFO  ---RUNTIME: Original pipeline execution took 16254.164457321167 ms (excluding imports and monkey-patching)
2022-09-22 08:14:52 INFO  Starting execution of 1 what-if analyses...
2022-09-22 08:14:52 INFO  Start plan generation for analysis DataCorruption...
2022-09-22 08:14:52 INFO  ---RUNTIME: Plan generation took 0.457763671875 ms
2022-09-22 08:14:52 INFO  Estimated runtime of original DAG is 12829.833507537842ms
2022-09-22 08:14:52 INFO  Performing Multi-Query Optimization
2022-09-22 08:14:52 INFO  Estimated unoptimized what-if runtime is 320745.83768844604ms
2022-09-22 08:14:52 INFO  Estimated optimised what-if runtime is 14867.526054382324ms
2022-09-22 08:14:52 INFO  Estimated optimisation runtime saving is 305878.3116340637ms
2022-09-22 08:14:52 INFO  ---RUNTIME: Multi-Query Optimization took 68.0079460144043 ms
2022-09-22 08:14:52 INFO  Executing generated plans
2022-09-22 08:15:12 INFO  ---RUNTIME: Execution took 20015.304803848267 ms
2022-09-22 08:15:12 INFO  Done!
2022-09-22 08:15:12 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-22 08:15:12 INFO  Running instrumented original pipeline...
2022-09-22 08:15:12 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-22 08:15:12 INFO  ---RUNTIME: Importing and monkey-patching took 5.867719650268555 ms
2022-09-22 08:15:28 INFO  ---RUNTIME: Original pipeline execution took 15836.26675605774 ms (excluding imports and monkey-patching)
2022-09-22 08:15:28 INFO  Starting execution of 1 what-if analyses...
2022-09-22 08:15:28 INFO  Start plan generation for analysis DataCorruption...
2022-09-22 08:15:28 INFO  ---RUNTIME: Plan generation took 0.4227161407470703 ms
2022-09-22 08:15:28 INFO  Estimated runtime of original DAG is 12655.480861663818ms
2022-09-22 08:15:28 WARNING Skipping Multi-Query Optimization (instead, only applying patches)
2022-09-22 08:15:28 INFO  Estimated unoptimised what-if runtime is 316387.02154159546ms
2022-09-22 08:15:28 INFO  ---RUNTIME: Multi-Query Optimization took 20.433664321899414 ms
2022-09-22 08:15:28 INFO  Executing generated plans
2022-09-22 08:21:23 INFO  ---RUNTIME: Execution took 355011.23571395874 ms
2022-09-22 08:21:23 INFO  Done!
2022-09-22 08:21:23 INFO  # Finished -- repetition 3 of 7 
2022-09-22 08:21:23 INFO  # Optimization benchmark for data_corruption with args [['reviews', 'slow_loading', 'featurization_4', 'xgboost']] -- repetition 4 of 7
2022-09-22 08:21:23 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-22 08:21:23 INFO  Running instrumented original pipeline...
2022-09-22 08:21:23 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-22 08:21:23 INFO  ---RUNTIME: Importing and monkey-patching took 6.328105926513672 ms
2022-09-22 08:21:39 INFO  ---RUNTIME: Original pipeline execution took 16143.267631530762 ms (excluding imports and monkey-patching)
2022-09-22 08:21:39 INFO  Starting execution of 1 what-if analyses...
2022-09-22 08:21:39 INFO  Start plan generation for analysis DataCorruption...
2022-09-22 08:21:39 INFO  ---RUNTIME: Plan generation took 0.41294097900390625 ms
2022-09-22 08:21:39 INFO  Estimated runtime of original DAG is 12712.821006774902ms
2022-09-22 08:21:39 INFO  Performing Multi-Query Optimization
2022-09-22 08:21:39 INFO  Estimated unoptimized what-if runtime is 317820.52516937256ms
2022-09-22 08:21:39 INFO  Estimated optimised what-if runtime is 14733.344793319702ms
2022-09-22 08:21:39 INFO  Estimated optimisation runtime saving is 303087.18037605286ms
2022-09-22 08:21:39 INFO  ---RUNTIME: Multi-Query Optimization took 67.57473945617676 ms
2022-09-22 08:21:39 INFO  Executing generated plans
2022-09-22 08:21:59 INFO  ---RUNTIME: Execution took 19913.74945640564 ms
2022-09-22 08:21:59 INFO  Done!
2022-09-22 08:21:59 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-22 08:21:59 INFO  Running instrumented original pipeline...
2022-09-22 08:21:59 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-22 08:21:59 INFO  ---RUNTIME: Importing and monkey-patching took 6.279468536376953 ms
2022-09-22 08:22:15 INFO  ---RUNTIME: Original pipeline execution took 16198.830127716064 ms (excluding imports and monkey-patching)
2022-09-22 08:22:15 INFO  Starting execution of 1 what-if analyses...
2022-09-22 08:22:15 INFO  Start plan generation for analysis DataCorruption...
2022-09-22 08:22:15 INFO  ---RUNTIME: Plan generation took 0.43487548828125 ms
2022-09-22 08:22:15 INFO  Estimated runtime of original DAG is 12744.408369064331ms
2022-09-22 08:22:15 WARNING Skipping Multi-Query Optimization (instead, only applying patches)
2022-09-22 08:22:15 INFO  Estimated unoptimised what-if runtime is 318610.2092266083ms
2022-09-22 08:22:15 INFO  ---RUNTIME: Multi-Query Optimization took 20.28059959411621 ms
2022-09-22 08:22:15 INFO  Executing generated plans
2022-09-22 08:28:10 INFO  ---RUNTIME: Execution took 354756.5836906433 ms
2022-09-22 08:28:10 INFO  Done!
2022-09-22 08:28:10 INFO  # Finished -- repetition 4 of 7 
2022-09-22 08:28:10 INFO  # Optimization benchmark for data_corruption with args [['reviews', 'slow_loading', 'featurization_4', 'xgboost']] -- repetition 5 of 7
2022-09-22 08:28:10 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-22 08:28:10 INFO  Running instrumented original pipeline...
2022-09-22 08:28:10 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-22 08:28:10 INFO  ---RUNTIME: Importing and monkey-patching took 5.87773323059082 ms
2022-09-22 08:28:26 INFO  ---RUNTIME: Original pipeline execution took 16433.960914611816 ms (excluding imports and monkey-patching)
2022-09-22 08:28:26 INFO  Starting execution of 1 what-if analyses...
2022-09-22 08:28:26 INFO  Start plan generation for analysis DataCorruption...
2022-09-22 08:28:26 INFO  ---RUNTIME: Plan generation took 0.4405975341796875 ms
2022-09-22 08:28:26 INFO  Estimated runtime of original DAG is 12984.70401763916ms
2022-09-22 08:28:26 INFO  Performing Multi-Query Optimization
2022-09-22 08:28:26 INFO  Estimated unoptimized what-if runtime is 324617.600440979ms
2022-09-22 08:28:26 INFO  Estimated optimised what-if runtime is 15030.014514923096ms
2022-09-22 08:28:26 INFO  Estimated optimisation runtime saving is 309587.5859260559ms
2022-09-22 08:28:26 INFO  ---RUNTIME: Multi-Query Optimization took 70.07336616516113 ms
2022-09-22 08:28:26 INFO  Executing generated plans
2022-09-22 08:28:46 INFO  ---RUNTIME: Execution took 19814.160585403442 ms
2022-09-22 08:28:46 INFO  Done!
2022-09-22 08:28:46 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-22 08:28:46 INFO  Running instrumented original pipeline...
2022-09-22 08:28:46 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-22 08:28:46 INFO  ---RUNTIME: Importing and monkey-patching took 5.95545768737793 ms
2022-09-22 08:29:02 INFO  ---RUNTIME: Original pipeline execution took 15975.996017456055 ms (excluding imports and monkey-patching)
2022-09-22 08:29:02 INFO  Starting execution of 1 what-if analyses...
2022-09-22 08:29:02 INFO  Start plan generation for analysis DataCorruption...
2022-09-22 08:29:02 INFO  ---RUNTIME: Plan generation took 0.4425048828125 ms
2022-09-22 08:29:02 INFO  Estimated runtime of original DAG is 12770.498991012573ms
2022-09-22 08:29:02 WARNING Skipping Multi-Query Optimization (instead, only applying patches)
2022-09-22 08:29:02 INFO  Estimated unoptimised what-if runtime is 319262.47477531433ms
2022-09-22 08:29:02 INFO  ---RUNTIME: Multi-Query Optimization took 20.09415626525879 ms
2022-09-22 08:29:02 INFO  Executing generated plans
2022-09-22 08:34:57 INFO  ---RUNTIME: Execution took 354860.8739376068 ms
2022-09-22 08:34:57 INFO  Done!
2022-09-22 08:34:57 INFO  # Finished -- repetition 5 of 7 
2022-09-22 08:34:57 INFO  # Optimization benchmark for data_corruption with args [['reviews', 'slow_loading', 'featurization_4', 'xgboost']] -- repetition 6 of 7
2022-09-22 08:34:57 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-22 08:34:57 INFO  Running instrumented original pipeline...
2022-09-22 08:34:57 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-22 08:34:57 INFO  ---RUNTIME: Importing and monkey-patching took 6.459474563598633 ms
2022-09-22 08:35:13 INFO  ---RUNTIME: Original pipeline execution took 15970.736503601074 ms (excluding imports and monkey-patching)
2022-09-22 08:35:13 INFO  Starting execution of 1 what-if analyses...
2022-09-22 08:35:13 INFO  Start plan generation for analysis DataCorruption...
2022-09-22 08:35:13 INFO  ---RUNTIME: Plan generation took 0.4417896270751953 ms
2022-09-22 08:35:13 INFO  Estimated runtime of original DAG is 12787.203550338745ms
2022-09-22 08:35:13 INFO  Performing Multi-Query Optimization
2022-09-22 08:35:13 INFO  Estimated unoptimized what-if runtime is 319680.0887584686ms
2022-09-22 08:35:13 INFO  Estimated optimised what-if runtime is 14777.4977684021ms
2022-09-22 08:35:13 INFO  Estimated optimisation runtime saving is 304902.5909900665ms
2022-09-22 08:35:13 INFO  ---RUNTIME: Multi-Query Optimization took 68.34936141967773 ms
2022-09-22 08:35:13 INFO  Executing generated plans
2022-09-22 08:35:33 INFO  ---RUNTIME: Execution took 19929.38995361328 ms
2022-09-22 08:35:33 INFO  Done!
2022-09-22 08:35:33 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-22 08:35:33 INFO  Running instrumented original pipeline...
2022-09-22 08:35:33 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-22 08:35:33 INFO  ---RUNTIME: Importing and monkey-patching took 5.724430084228516 ms
2022-09-22 08:35:49 INFO  ---RUNTIME: Original pipeline execution took 15989.375591278076 ms (excluding imports and monkey-patching)
2022-09-22 08:35:49 INFO  Starting execution of 1 what-if analyses...
2022-09-22 08:35:49 INFO  Start plan generation for analysis DataCorruption...
2022-09-22 08:35:49 INFO  ---RUNTIME: Plan generation took 0.3962516784667969 ms
2022-09-22 08:35:49 INFO  Estimated runtime of original DAG is 12814.260721206665ms
2022-09-22 08:35:49 WARNING Skipping Multi-Query Optimization (instead, only applying patches)
2022-09-22 08:35:49 INFO  Estimated unoptimised what-if runtime is 320356.5180301666ms
2022-09-22 08:35:49 INFO  ---RUNTIME: Multi-Query Optimization took 20.159482955932617 ms
2022-09-22 08:35:49 INFO  Executing generated plans
2022-09-22 08:41:43 INFO  ---RUNTIME: Execution took 353884.9301338196 ms
2022-09-22 08:41:43 INFO  Done!
2022-09-22 08:41:43 INFO  # Finished -- repetition 6 of 7 
2022-09-22 08:41:43 INFO  # Optimization benchmark for data_corruption with args [['reviews', 'slow_loading', 'featurization_4', 'xgboost']] -- repetition 7 of 7
2022-09-22 08:41:43 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-22 08:41:43 INFO  Running instrumented original pipeline...
2022-09-22 08:41:43 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-22 08:41:43 INFO  ---RUNTIME: Importing and monkey-patching took 5.845308303833008 ms
2022-09-22 08:41:59 INFO  ---RUNTIME: Original pipeline execution took 16118.75057220459 ms (excluding imports and monkey-patching)
2022-09-22 08:41:59 INFO  Starting execution of 1 what-if analyses...
2022-09-22 08:41:59 INFO  Start plan generation for analysis DataCorruption...
2022-09-22 08:41:59 INFO  ---RUNTIME: Plan generation took 0.38433074951171875 ms
2022-09-22 08:41:59 INFO  Estimated runtime of original DAG is 12696.824550628662ms
2022-09-22 08:41:59 INFO  Performing Multi-Query Optimization
2022-09-22 08:41:59 INFO  Estimated unoptimized what-if runtime is 317420.61376571655ms
2022-09-22 08:41:59 INFO  Estimated optimised what-if runtime is 14726.34243965149ms
2022-09-22 08:41:59 INFO  Estimated optimisation runtime saving is 302694.27132606506ms
2022-09-22 08:41:59 INFO  ---RUNTIME: Multi-Query Optimization took 68.29690933227539 ms
2022-09-22 08:41:59 INFO  Executing generated plans
2022-09-22 08:42:19 INFO  ---RUNTIME: Execution took 19807.217121124268 ms
2022-09-22 08:42:19 INFO  Done!
2022-09-22 08:42:19 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-22 08:42:19 INFO  Running instrumented original pipeline...
2022-09-22 08:42:19 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-22 08:42:19 INFO  ---RUNTIME: Importing and monkey-patching took 5.752325057983398 ms
2022-09-22 08:42:35 INFO  ---RUNTIME: Original pipeline execution took 16206.70747756958 ms (excluding imports and monkey-patching)
2022-09-22 08:42:35 INFO  Starting execution of 1 what-if analyses...
2022-09-22 08:42:35 INFO  Start plan generation for analysis DataCorruption...
2022-09-22 08:42:35 INFO  ---RUNTIME: Plan generation took 0.46372413635253906 ms
2022-09-22 08:42:35 INFO  Estimated runtime of original DAG is 13001.60026550293ms
2022-09-22 08:42:35 WARNING Skipping Multi-Query Optimization (instead, only applying patches)
2022-09-22 08:42:35 INFO  Estimated unoptimised what-if runtime is 325040.00663757324ms
2022-09-22 08:42:35 INFO  ---RUNTIME: Multi-Query Optimization took 20.378589630126953 ms
2022-09-22 08:42:35 INFO  Executing generated plans
2022-09-22 08:48:30 INFO  ---RUNTIME: Execution took 354447.32189178467 ms
2022-09-22 08:48:30 INFO  Done!
2022-09-22 08:48:30 INFO  # Finished -- repetition 7 of 7 
2022-09-22 08:48:30 INFO  # Final results after all repetitions
2022-09-22 08:48:30 INFO     repetition  ... no_opt_what_if_execution_combined_model_training
0           0  ...                                     78588.743925
1           1  ...                                     77829.295397
2           2  ...                                     77783.210278
3           3  ...                                     77749.165535
4           4  ...                                     77730.508804
5           5  ...                                     77661.204338
6           6  ...                                     77750.001192

[7 rows x 26 columns]
taskset -c 32-39 PROTOCOL_BUFFERS_PYTHON_IMPLEMENTATION=python python3.9 benchmarks_end_to_end.py data_corruption reviews slow_loading featurization_4 neural_network
2022-09-22 08:48:32.218647: W tensorflow/stream_executor/platform/default/dso_loader.cc:64] Could not load dynamic library 'libcudart.so.11.0'; dlerror: libcudart.so.11.0: cannot open shared object file: No such file or directory; LD_LIBRARY_PATH: /home/sgrafbe/mlwhatif/venv/lib/python3.9/site-packages/cv2/../../lib64:
2022-09-22 08:48:32.218692: I tensorflow/stream_executor/cuda/cudart_stub.cc:29] Ignore above cudart dlerror if you do not have a GPU set up on your machine.
2022-09-22 08:48:33 INFO  Patching sys.argv with ['mlwhatif', 'reviews', 'slow_loading', 'featurization_4', 'neural_network']
2022-09-22 08:48:33 INFO  Running instrumented original pipeline...
2022-09-22 08:48:33 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-22 08:48:33 INFO  ---RUNTIME: Importing and monkey-patching took 95.85142135620117 ms
2022-09-22 08:48:46.454434: W tensorflow/stream_executor/platform/default/dso_loader.cc:64] Could not load dynamic library 'libcuda.so.1'; dlerror: libcuda.so.1: cannot open shared object file: No such file or directory; LD_LIBRARY_PATH: /home/sgrafbe/mlwhatif/venv/lib/python3.9/site-packages/cv2/../../lib64:
2022-09-22 08:48:46.454469: W tensorflow/stream_executor/cuda/cuda_driver.cc:326] failed call to cuInit: UNKNOWN ERROR (303)
2022-09-22 08:48:46.454492: I tensorflow/stream_executor/cuda/cuda_diagnostics.cc:156] kernel driver does not appear to be running on this host (wagyu): /proc/driver/nvidia/version does not exist
2022-09-22 08:48:46.455087: I tensorflow/core/platform/cpu_feature_guard.cc:142] This TensorFlow binary is optimized with oneAPI Deep Neural Network Library (oneDNN) to use the following CPU instructions in performance-critical operations:  AVX2 FMA
To enable them in other operations, rebuild TensorFlow with the appropriate compiler flags.
2022-09-22 08:48:46.527308: I tensorflow/compiler/mlir/mlir_graph_optimization_pass.cc:176] None of the MLIR Optimization Passes are enabled (registered 2)
2022-09-22 08:48:46.539378: I tensorflow/core/platform/profile_utils/cpu_utils.cc:114] CPU Frequency: 2595290000 Hz
2022-09-22 08:48:50 INFO  ---RUNTIME: Original pipeline execution took 17014.793872833252 ms (excluding imports and monkey-patching)
2022-09-22 08:48:50 INFO  Starting execution of 0 what-if analyses...
2022-09-22 08:48:50 INFO  Estimated runtime of original DAG is 13740.305185317993ms
2022-09-22 08:48:50 INFO  Performing Multi-Query Optimization
2022-09-22 08:48:50 INFO  Estimated unoptimized what-if runtime is 0ms
2022-09-22 08:48:50 INFO  Estimated optimised what-if runtime is 0ms
2022-09-22 08:48:50 INFO  Estimated optimisation runtime saving is 0ms
2022-09-22 08:48:50 INFO  ---RUNTIME: Multi-Query Optimization took 0.5161762237548828 ms
2022-09-22 08:48:50 INFO  Executing generated plans
2022-09-22 08:48:50 INFO  ---RUNTIME: Execution took 0.019788742065429688 ms
2022-09-22 08:48:50 INFO  Done!
2022-09-22 08:48:50 INFO  # Optimization benchmark for data_corruption with args [['reviews', 'slow_loading', 'featurization_4', 'neural_network']] -- repetition 1 of 7
2022-09-22 08:48:50 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-22 08:48:50 INFO  Running instrumented original pipeline...
2022-09-22 08:48:50 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-22 08:48:50 INFO  ---RUNTIME: Importing and monkey-patching took 5.524635314941406 ms
2022-09-22 08:49:07 INFO  ---RUNTIME: Original pipeline execution took 16683.175086975098 ms (excluding imports and monkey-patching)
2022-09-22 08:49:07 INFO  Starting execution of 1 what-if analyses...
2022-09-22 08:49:07 INFO  Start plan generation for analysis DataCorruption...
2022-09-22 08:49:07 INFO  ---RUNTIME: Plan generation took 0.3781318664550781 ms
2022-09-22 08:49:07 INFO  Estimated runtime of original DAG is 13254.692077636719ms
2022-09-22 08:49:07 INFO  Performing Multi-Query Optimization
2022-09-22 08:49:07 INFO  Estimated unoptimized what-if runtime is 331367.30194091797ms
2022-09-22 08:49:07 INFO  Estimated optimised what-if runtime is 23741.633653640747ms
2022-09-22 08:49:07 INFO  Estimated optimisation runtime saving is 307625.6682872772ms
2022-09-22 08:49:07 INFO  ---RUNTIME: Multi-Query Optimization took 68.70889663696289 ms
2022-09-22 08:49:07 INFO  Executing generated plans
2022-09-22 08:49:35 INFO  ---RUNTIME: Execution took 28068.287134170532 ms
2022-09-22 08:49:35 INFO  Done!
2022-09-22 08:49:35 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-22 08:49:35 INFO  Running instrumented original pipeline...
2022-09-22 08:49:35 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-22 08:49:35 INFO  ---RUNTIME: Importing and monkey-patching took 6.457328796386719 ms
2022-09-22 08:49:51 INFO  ---RUNTIME: Original pipeline execution took 16573.837518692017 ms (excluding imports and monkey-patching)
2022-09-22 08:49:51 INFO  Starting execution of 1 what-if analyses...
2022-09-22 08:49:51 INFO  Start plan generation for analysis DataCorruption...
2022-09-22 08:49:51 INFO  ---RUNTIME: Plan generation took 0.37980079650878906 ms
2022-09-22 08:49:51 INFO  Estimated runtime of original DAG is 13371.303081512451ms
2022-09-22 08:49:51 WARNING Skipping Multi-Query Optimization (instead, only applying patches)
2022-09-22 08:49:52 INFO  Estimated unoptimised what-if runtime is 334282.5770378113ms
2022-09-22 08:49:52 INFO  ---RUNTIME: Multi-Query Optimization took 20.128488540649414 ms
2022-09-22 08:49:52 INFO  Executing generated plans
2022-09-22 08:55:54 INFO  ---RUNTIME: Execution took 362537.7252101898 ms
2022-09-22 08:55:54 INFO  Done!
2022-09-22 08:55:54 INFO  # Finished -- repetition 1 of 7 
2022-09-22 08:55:54 INFO  # Optimization benchmark for data_corruption with args [['reviews', 'slow_loading', 'featurization_4', 'neural_network']] -- repetition 2 of 7
2022-09-22 08:55:54 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-22 08:55:54 INFO  Running instrumented original pipeline...
2022-09-22 08:55:54 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-22 08:55:54 INFO  ---RUNTIME: Importing and monkey-patching took 6.233930587768555 ms
2022-09-22 08:56:11 INFO  ---RUNTIME: Original pipeline execution took 16789.813995361328 ms (excluding imports and monkey-patching)
2022-09-22 08:56:11 INFO  Starting execution of 1 what-if analyses...
2022-09-22 08:56:11 INFO  Start plan generation for analysis DataCorruption...
2022-09-22 08:56:11 INFO  ---RUNTIME: Plan generation took 0.4184246063232422 ms
2022-09-22 08:56:11 INFO  Estimated runtime of original DAG is 13617.621660232544ms
2022-09-22 08:56:11 INFO  Performing Multi-Query Optimization
2022-09-22 08:56:11 INFO  Estimated unoptimized what-if runtime is 340440.5415058136ms
2022-09-22 08:56:11 INFO  Estimated optimised what-if runtime is 23795.21870613098ms
2022-09-22 08:56:11 INFO  Estimated optimisation runtime saving is 316645.3227996826ms
2022-09-22 08:56:11 INFO  ---RUNTIME: Multi-Query Optimization took 69.1378116607666 ms
2022-09-22 08:56:11 INFO  Executing generated plans
2022-09-22 08:56:39 INFO  ---RUNTIME: Execution took 27860.673427581787 ms
2022-09-22 08:56:39 INFO  Done!
2022-09-22 08:56:39 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-22 08:56:39 INFO  Running instrumented original pipeline...
2022-09-22 08:56:39 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-22 08:56:39 INFO  ---RUNTIME: Importing and monkey-patching took 5.896329879760742 ms
2022-09-22 08:56:55 INFO  ---RUNTIME: Original pipeline execution took 16695.86229324341 ms (excluding imports and monkey-patching)
2022-09-22 08:56:55 INFO  Starting execution of 1 what-if analyses...
2022-09-22 08:56:55 INFO  Start plan generation for analysis DataCorruption...
2022-09-22 08:56:55 INFO  ---RUNTIME: Plan generation took 0.4506111145019531 ms
2022-09-22 08:56:55 INFO  Estimated runtime of original DAG is 13489.049673080444ms
2022-09-22 08:56:55 WARNING Skipping Multi-Query Optimization (instead, only applying patches)
2022-09-22 08:56:56 INFO  Estimated unoptimised what-if runtime is 337226.2418270111ms
2022-09-22 08:56:56 INFO  ---RUNTIME: Multi-Query Optimization took 316.42723083496094 ms
2022-09-22 08:56:56 INFO  Executing generated plans
2022-09-22 09:02:59 INFO  ---RUNTIME: Execution took 363068.6285495758 ms
2022-09-22 09:02:59 INFO  Done!
2022-09-22 09:02:59 INFO  # Finished -- repetition 2 of 7 
2022-09-22 09:02:59 INFO  # Optimization benchmark for data_corruption with args [['reviews', 'slow_loading', 'featurization_4', 'neural_network']] -- repetition 3 of 7
2022-09-22 09:02:59 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-22 09:02:59 INFO  Running instrumented original pipeline...
2022-09-22 09:02:59 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-22 09:02:59 INFO  ---RUNTIME: Importing and monkey-patching took 6.03795051574707 ms
2022-09-22 09:03:15 INFO  ---RUNTIME: Original pipeline execution took 16365.960597991943 ms (excluding imports and monkey-patching)
2022-09-22 09:03:15 INFO  Starting execution of 1 what-if analyses...
2022-09-22 09:03:15 INFO  Start plan generation for analysis DataCorruption...
2022-09-22 09:03:15 INFO  ---RUNTIME: Plan generation took 0.37384033203125 ms
2022-09-22 09:03:15 INFO  Estimated runtime of original DAG is 13188.803672790527ms
2022-09-22 09:03:15 INFO  Performing Multi-Query Optimization
2022-09-22 09:03:15 INFO  Estimated unoptimized what-if runtime is 329720.0918197632ms
2022-09-22 09:03:15 INFO  Estimated optimised what-if runtime is 23154.138565063477ms
2022-09-22 09:03:15 INFO  Estimated optimisation runtime saving is 306565.9532546997ms
2022-09-22 09:03:15 INFO  ---RUNTIME: Multi-Query Optimization took 67.24023818969727 ms
2022-09-22 09:03:15 INFO  Executing generated plans
2022-09-22 09:03:43 INFO  ---RUNTIME: Execution took 27989.82548713684 ms
2022-09-22 09:03:43 INFO  Done!
2022-09-22 09:03:43 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-22 09:03:43 INFO  Running instrumented original pipeline...
2022-09-22 09:03:43 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-22 09:03:43 INFO  ---RUNTIME: Importing and monkey-patching took 5.766630172729492 ms
2022-09-22 09:04:00 INFO  ---RUNTIME: Original pipeline execution took 16629.847049713135 ms (excluding imports and monkey-patching)
2022-09-22 09:04:00 INFO  Starting execution of 1 what-if analyses...
2022-09-22 09:04:00 INFO  Start plan generation for analysis DataCorruption...
2022-09-22 09:04:00 INFO  ---RUNTIME: Plan generation took 0.43845176696777344 ms
2022-09-22 09:04:00 INFO  Estimated runtime of original DAG is 13121.132612228394ms
2022-09-22 09:04:00 WARNING Skipping Multi-Query Optimization (instead, only applying patches)
2022-09-22 09:04:00 INFO  Estimated unoptimised what-if runtime is 328028.31530570984ms
2022-09-22 09:04:00 INFO  ---RUNTIME: Multi-Query Optimization took 19.73247528076172 ms
2022-09-22 09:04:00 INFO  Executing generated plans
2022-09-22 09:10:02 INFO  ---RUNTIME: Execution took 362090.6546115875 ms
2022-09-22 09:10:02 INFO  Done!
2022-09-22 09:10:02 INFO  # Finished -- repetition 3 of 7 
2022-09-22 09:10:02 INFO  # Optimization benchmark for data_corruption with args [['reviews', 'slow_loading', 'featurization_4', 'neural_network']] -- repetition 4 of 7
2022-09-22 09:10:02 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-22 09:10:02 INFO  Running instrumented original pipeline...
2022-09-22 09:10:02 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-22 09:10:02 INFO  ---RUNTIME: Importing and monkey-patching took 5.895376205444336 ms
2022-09-22 09:10:19 INFO  ---RUNTIME: Original pipeline execution took 16629.304885864258 ms (excluding imports and monkey-patching)
2022-09-22 09:10:19 INFO  Starting execution of 1 what-if analyses...
2022-09-22 09:10:19 INFO  Start plan generation for analysis DataCorruption...
2022-09-22 09:10:19 INFO  ---RUNTIME: Plan generation took 0.4153251647949219 ms
2022-09-22 09:10:19 INFO  Estimated runtime of original DAG is 13074.335098266602ms
2022-09-22 09:10:19 INFO  Performing Multi-Query Optimization
2022-09-22 09:10:19 INFO  Estimated unoptimized what-if runtime is 326858.37745666504ms
2022-09-22 09:10:19 INFO  Estimated optimised what-if runtime is 23149.80435371399ms
2022-09-22 09:10:19 INFO  Estimated optimisation runtime saving is 303708.57310295105ms
2022-09-22 09:10:19 INFO  ---RUNTIME: Multi-Query Optimization took 67.5649642944336 ms
2022-09-22 09:10:19 INFO  Executing generated plans
2022-09-22 09:10:47 INFO  ---RUNTIME: Execution took 28065.85931777954 ms
2022-09-22 09:10:47 INFO  Done!
2022-09-22 09:10:47 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-22 09:10:47 INFO  Running instrumented original pipeline...
2022-09-22 09:10:47 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-22 09:10:47 INFO  ---RUNTIME: Importing and monkey-patching took 6.166696548461914 ms
2022-09-22 09:11:03 INFO  ---RUNTIME: Original pipeline execution took 16589.26749229431 ms (excluding imports and monkey-patching)
2022-09-22 09:11:03 INFO  Starting execution of 1 what-if analyses...
2022-09-22 09:11:03 INFO  Start plan generation for analysis DataCorruption...
2022-09-22 09:11:03 INFO  ---RUNTIME: Plan generation took 0.4601478576660156 ms
2022-09-22 09:11:03 INFO  Estimated runtime of original DAG is 13385.258436203003ms
2022-09-22 09:11:03 WARNING Skipping Multi-Query Optimization (instead, only applying patches)
2022-09-22 09:11:03 INFO  Estimated unoptimised what-if runtime is 334631.4609050751ms
2022-09-22 09:11:03 INFO  ---RUNTIME: Multi-Query Optimization took 19.900798797607422 ms
2022-09-22 09:11:03 INFO  Executing generated plans
2022-09-22 09:17:06 INFO  ---RUNTIME: Execution took 362812.8821849823 ms
2022-09-22 09:17:06 INFO  Done!
2022-09-22 09:17:06 INFO  # Finished -- repetition 4 of 7 
2022-09-22 09:17:06 INFO  # Optimization benchmark for data_corruption with args [['reviews', 'slow_loading', 'featurization_4', 'neural_network']] -- repetition 5 of 7
2022-09-22 09:17:06 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-22 09:17:06 INFO  Running instrumented original pipeline...
2022-09-22 09:17:06 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-22 09:17:06 INFO  ---RUNTIME: Importing and monkey-patching took 6.183147430419922 ms
2022-09-22 09:17:23 INFO  ---RUNTIME: Original pipeline execution took 17179.18372154236 ms (excluding imports and monkey-patching)
2022-09-22 09:17:23 INFO  Starting execution of 1 what-if analyses...
2022-09-22 09:17:23 INFO  Start plan generation for analysis DataCorruption...
2022-09-22 09:17:23 INFO  ---RUNTIME: Plan generation took 0.39696693420410156 ms
2022-09-22 09:17:23 INFO  Estimated runtime of original DAG is 13655.524730682373ms
2022-09-22 09:17:23 INFO  Performing Multi-Query Optimization
2022-09-22 09:17:24 INFO  Estimated unoptimized what-if runtime is 341388.1182670593ms
2022-09-22 09:17:24 INFO  Estimated optimised what-if runtime is 23988.253355026245ms
2022-09-22 09:17:24 INFO  Estimated optimisation runtime saving is 317399.8649120331ms
2022-09-22 09:17:24 INFO  ---RUNTIME: Multi-Query Optimization took 69.17190551757812 ms
2022-09-22 09:17:24 INFO  Executing generated plans
2022-09-22 09:17:51 INFO  ---RUNTIME: Execution took 27620.909214019775 ms
2022-09-22 09:17:51 INFO  Done!
2022-09-22 09:17:51 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-22 09:17:51 INFO  Running instrumented original pipeline...
2022-09-22 09:17:51 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-22 09:17:51 INFO  ---RUNTIME: Importing and monkey-patching took 5.778074264526367 ms
2022-09-22 09:18:08 INFO  ---RUNTIME: Original pipeline execution took 16637.872457504272 ms (excluding imports and monkey-patching)
2022-09-22 09:18:08 INFO  Starting execution of 1 what-if analyses...
2022-09-22 09:18:08 INFO  Start plan generation for analysis DataCorruption...
2022-09-22 09:18:08 INFO  ---RUNTIME: Plan generation took 0.40841102600097656 ms
2022-09-22 09:18:08 INFO  Estimated runtime of original DAG is 13437.496900558472ms
2022-09-22 09:18:08 WARNING Skipping Multi-Query Optimization (instead, only applying patches)
2022-09-22 09:18:08 INFO  Estimated unoptimised what-if runtime is 335937.4225139618ms
2022-09-22 09:18:08 INFO  ---RUNTIME: Multi-Query Optimization took 21.115541458129883 ms
2022-09-22 09:18:08 INFO  Executing generated plans
2022-09-22 09:24:11 INFO  ---RUNTIME: Execution took 363256.33692741394 ms
2022-09-22 09:24:11 INFO  Done!
2022-09-22 09:24:11 INFO  # Finished -- repetition 5 of 7 
2022-09-22 09:24:11 INFO  # Optimization benchmark for data_corruption with args [['reviews', 'slow_loading', 'featurization_4', 'neural_network']] -- repetition 6 of 7
2022-09-22 09:24:11 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-22 09:24:11 INFO  Running instrumented original pipeline...
2022-09-22 09:24:11 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-22 09:24:11 INFO  ---RUNTIME: Importing and monkey-patching took 5.943059921264648 ms
2022-09-22 09:24:27 INFO  ---RUNTIME: Original pipeline execution took 16202.720880508423 ms (excluding imports and monkey-patching)
2022-09-22 09:24:27 INFO  Starting execution of 1 what-if analyses...
2022-09-22 09:24:27 INFO  Start plan generation for analysis DataCorruption...
2022-09-22 09:24:27 INFO  ---RUNTIME: Plan generation took 0.4115104675292969 ms
2022-09-22 09:24:27 INFO  Estimated runtime of original DAG is 13010.51926612854ms
2022-09-22 09:24:27 INFO  Performing Multi-Query Optimization
2022-09-22 09:24:27 INFO  Estimated unoptimized what-if runtime is 325262.9816532135ms
2022-09-22 09:24:27 INFO  Estimated optimised what-if runtime is 22997.016191482544ms
2022-09-22 09:24:27 INFO  Estimated optimisation runtime saving is 302265.96546173096ms
2022-09-22 09:24:27 INFO  ---RUNTIME: Multi-Query Optimization took 67.86441802978516 ms
2022-09-22 09:24:27 INFO  Executing generated plans
2022-09-22 09:24:56 INFO  ---RUNTIME: Execution took 28205.52396774292 ms
2022-09-22 09:24:56 INFO  Done!
2022-09-22 09:24:56 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-22 09:24:56 INFO  Running instrumented original pipeline...
2022-09-22 09:24:56 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-22 09:24:56 INFO  ---RUNTIME: Importing and monkey-patching took 6.264209747314453 ms
2022-09-22 09:25:12 INFO  ---RUNTIME: Original pipeline execution took 16239.386796951294 ms (excluding imports and monkey-patching)
2022-09-22 09:25:12 INFO  Starting execution of 1 what-if analyses...
2022-09-22 09:25:12 INFO  Start plan generation for analysis DataCorruption...
2022-09-22 09:25:12 INFO  ---RUNTIME: Plan generation took 0.42724609375 ms
2022-09-22 09:25:12 INFO  Estimated runtime of original DAG is 13054.718971252441ms
2022-09-22 09:25:12 WARNING Skipping Multi-Query Optimization (instead, only applying patches)
2022-09-22 09:25:12 INFO  Estimated unoptimised what-if runtime is 326367.97428131104ms
2022-09-22 09:25:12 INFO  ---RUNTIME: Multi-Query Optimization took 20.110130310058594 ms
2022-09-22 09:25:12 INFO  Executing generated plans
2022-09-22 09:31:16 INFO  ---RUNTIME: Execution took 363713.90438079834 ms
2022-09-22 09:31:16 INFO  Done!
2022-09-22 09:31:16 INFO  # Finished -- repetition 6 of 7 
2022-09-22 09:31:16 INFO  # Optimization benchmark for data_corruption with args [['reviews', 'slow_loading', 'featurization_4', 'neural_network']] -- repetition 7 of 7
2022-09-22 09:31:16 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-22 09:31:16 INFO  Running instrumented original pipeline...
2022-09-22 09:31:16 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-22 09:31:16 INFO  ---RUNTIME: Importing and monkey-patching took 5.89752197265625 ms
2022-09-22 09:31:32 INFO  ---RUNTIME: Original pipeline execution took 16158.243894577026 ms (excluding imports and monkey-patching)
2022-09-22 09:31:32 INFO  Starting execution of 1 what-if analyses...
2022-09-22 09:31:32 INFO  Start plan generation for analysis DataCorruption...
2022-09-22 09:31:32 INFO  ---RUNTIME: Plan generation took 0.44417381286621094 ms
2022-09-22 09:31:32 INFO  Estimated runtime of original DAG is 12963.241338729858ms
2022-09-22 09:31:32 INFO  Performing Multi-Query Optimization
2022-09-22 09:31:32 INFO  Estimated unoptimized what-if runtime is 324081.03346824646ms
2022-09-22 09:31:32 INFO  Estimated optimised what-if runtime is 22946.08211517334ms
2022-09-22 09:31:32 INFO  Estimated optimisation runtime saving is 301134.9513530731ms
2022-09-22 09:31:32 INFO  ---RUNTIME: Multi-Query Optimization took 69.34070587158203 ms
2022-09-22 09:31:32 INFO  Executing generated plans
2022-09-22 09:32:00 INFO  ---RUNTIME: Execution took 28152.12106704712 ms
2022-09-22 09:32:00 INFO  Done!
2022-09-22 09:32:00 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-22 09:32:00 INFO  Running instrumented original pipeline...
2022-09-22 09:32:00 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-22 09:32:00 INFO  ---RUNTIME: Importing and monkey-patching took 5.794525146484375 ms
2022-09-22 09:32:17 INFO  ---RUNTIME: Original pipeline execution took 16669.94881629944 ms (excluding imports and monkey-patching)
2022-09-22 09:32:17 INFO  Starting execution of 1 what-if analyses...
2022-09-22 09:32:17 INFO  Start plan generation for analysis DataCorruption...
2022-09-22 09:32:17 INFO  ---RUNTIME: Plan generation took 0.4012584686279297 ms
2022-09-22 09:32:17 INFO  Estimated runtime of original DAG is 13130.997896194458ms
2022-09-22 09:32:17 WARNING Skipping Multi-Query Optimization (instead, only applying patches)
2022-09-22 09:32:17 INFO  Estimated unoptimised what-if runtime is 328274.94740486145ms
2022-09-22 09:32:17 INFO  ---RUNTIME: Multi-Query Optimization took 21.254301071166992 ms
2022-09-22 09:32:17 INFO  Executing generated plans
2022-09-22 09:38:21 INFO  ---RUNTIME: Execution took 363843.0595397949 ms
2022-09-22 09:38:21 INFO  Done!
2022-09-22 09:38:21 INFO  # Finished -- repetition 7 of 7 
2022-09-22 09:38:21 INFO  # Final results after all repetitions
2022-09-22 09:38:21 INFO     repetition  ... no_opt_what_if_execution_combined_model_training
0           0  ...                                     80231.339931
1           1  ...                                     79497.720003
2           2  ...                                     80000.924110
3           3  ...                                     79551.924467
4           4  ...                                     80107.154131
5           5  ...                                     79239.967346
6           6  ...                                     79943.000555

[7 rows x 26 columns]
