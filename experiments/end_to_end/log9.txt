Variant name from 0-15: 9
Cores to use: 32-39
PROTOCOL_BUFFERS_PYTHON_IMPLEMENTATION=python taskset -c 32-39 python3.9 benchmarks_end_to_end.py feature_importance reviews slow_loading featurization_0 logistic_regression
2022-09-24 21:27:40.380048: W tensorflow/stream_executor/platform/default/dso_loader.cc:64] Could not load dynamic library 'libcudart.so.11.0'; dlerror: libcudart.so.11.0: cannot open shared object file: No such file or directory; LD_LIBRARY_PATH: /home/sgrafbe/mlwhatif/venv/lib/python3.9/site-packages/cv2/../../lib64:
2022-09-24 21:27:40.380093: I tensorflow/stream_executor/cuda/cudart_stub.cc:29] Ignore above cudart dlerror if you do not have a GPU set up on your machine.
2022-09-24 21:27:41 INFO  Patching sys.argv with ['mlwhatif', 'reviews', 'slow_loading', 'featurization_0', 'logistic_regression']
2022-09-24 21:27:41 INFO  Running instrumented original pipeline...
2022-09-24 21:27:41 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-24 21:27:41 INFO  ---RUNTIME: Importing and monkey-patching took 95.85189819335938 ms
2022-09-24 21:27:48 INFO  ---RUNTIME: Original pipeline execution took 6316.889524459839 ms (excluding imports and monkey-patching)
2022-09-24 21:27:48 INFO  Starting execution of 0 what-if analyses...
2022-09-24 21:27:48 INFO  Estimated runtime of original DAG is 6006.369352340698ms
2022-09-24 21:27:48 INFO  Performing Multi-Query Optimization
2022-09-24 21:27:48 INFO  Estimated unoptimized what-if runtime is 0ms
2022-09-24 21:27:48 INFO  Estimated optimised what-if runtime is 0ms
2022-09-24 21:27:48 INFO  Estimated optimisation runtime saving is 0ms
2022-09-24 21:27:48 INFO  ---RUNTIME: Multi-Query Optimization took 0.5052089691162109 ms
2022-09-24 21:27:48 INFO  Executing generated plans
2022-09-24 21:27:48 INFO  ---RUNTIME: Execution took 0.026702880859375 ms
2022-09-24 21:27:48 INFO  Done!
2022-09-24 21:27:48 INFO  # Optimization benchmark for feature_importance with args [['reviews', 'slow_loading', 'featurization_0', 'logistic_regression']] -- repetition 1 of 7
2022-09-24 21:27:48 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-24 21:27:48 INFO  Running instrumented original pipeline...
2022-09-24 21:27:48 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-24 21:27:48 INFO  ---RUNTIME: Importing and monkey-patching took 5.890846252441406 ms
2022-09-24 21:27:53 INFO  ---RUNTIME: Original pipeline execution took 5592.060565948486 ms (excluding imports and monkey-patching)
2022-09-24 21:27:53 INFO  Starting execution of 1 what-if analyses...
2022-09-24 21:27:53 INFO  Start plan generation for analysis PermutationFeatureImportance...
2022-09-24 21:27:53 INFO  ---RUNTIME: Plan generation took 0.19288063049316406 ms
2022-09-24 21:27:53 INFO  Estimated runtime of original DAG is 5312.05415725708ms
2022-09-24 21:27:53 INFO  Performing Multi-Query Optimization
2022-09-24 21:27:53 INFO  Estimated unoptimized what-if runtime is 26560.2707862854ms
2022-09-24 21:27:53 INFO  Estimated optimised what-if runtime is 6638.223886489868ms
2022-09-24 21:27:53 INFO  Estimated optimisation runtime saving is 19922.046899795532ms
2022-09-24 21:27:53 INFO  ---RUNTIME: Multi-Query Optimization took 10.636091232299805 ms
2022-09-24 21:27:53 INFO  Executing generated plans
2022-09-24 21:28:00 INFO  ---RUNTIME: Execution took 6746.522665023804 ms
2022-09-24 21:28:00 INFO  Done!
2022-09-24 21:28:00 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-24 21:28:00 INFO  Running instrumented original pipeline...
2022-09-24 21:28:00 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-24 21:28:00 INFO  ---RUNTIME: Importing and monkey-patching took 6.020545959472656 ms
2022-09-24 21:28:06 INFO  ---RUNTIME: Original pipeline execution took 5846.465349197388 ms (excluding imports and monkey-patching)
2022-09-24 21:28:06 INFO  Starting execution of 1 what-if analyses...
2022-09-24 21:28:06 INFO  Start plan generation for analysis PermutationFeatureImportance...
2022-09-24 21:28:06 INFO  ---RUNTIME: Plan generation took 0.11777877807617188 ms
2022-09-24 21:28:06 INFO  Estimated runtime of original DAG is 5376.356840133667ms
2022-09-24 21:28:06 WARNING Skipping Multi-Query Optimization (instead, only applying patches)
2022-09-24 21:28:06 INFO  Estimated unoptimised what-if runtime is 26881.784200668335ms
2022-09-24 21:28:06 INFO  ---RUNTIME: Multi-Query Optimization took 3.828287124633789 ms
2022-09-24 21:28:06 INFO  Executing generated plans
2022-09-24 21:28:33 INFO  ---RUNTIME: Execution took 27331.77638053894 ms
2022-09-24 21:28:33 INFO  Done!
2022-09-24 21:28:33 INFO  # Finished -- repetition 1 of 7 
2022-09-24 21:28:33 INFO  # Optimization benchmark for feature_importance with args [['reviews', 'slow_loading', 'featurization_0', 'logistic_regression']] -- repetition 2 of 7
2022-09-24 21:28:33 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-24 21:28:33 INFO  Running instrumented original pipeline...
2022-09-24 21:28:33 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-24 21:28:33 INFO  ---RUNTIME: Importing and monkey-patching took 6.6928863525390625 ms
2022-09-24 21:28:39 INFO  ---RUNTIME: Original pipeline execution took 5712.008237838745 ms (excluding imports and monkey-patching)
2022-09-24 21:28:39 INFO  Starting execution of 1 what-if analyses...
2022-09-24 21:28:39 INFO  Start plan generation for analysis PermutationFeatureImportance...
2022-09-24 21:28:39 INFO  ---RUNTIME: Plan generation took 0.1537799835205078 ms
2022-09-24 21:28:39 INFO  Estimated runtime of original DAG is 5433.767080307007ms
2022-09-24 21:28:39 INFO  Performing Multi-Query Optimization
2022-09-24 21:28:39 INFO  Estimated unoptimized what-if runtime is 27168.835401535034ms
2022-09-24 21:28:39 INFO  Estimated optimised what-if runtime is 6756.546497344971ms
2022-09-24 21:28:39 INFO  Estimated optimisation runtime saving is 20412.288904190063ms
2022-09-24 21:28:39 INFO  ---RUNTIME: Multi-Query Optimization took 9.759187698364258 ms
2022-09-24 21:28:39 INFO  Executing generated plans
2022-09-24 21:28:46 INFO  ---RUNTIME: Execution took 6878.04913520813 ms
2022-09-24 21:28:46 INFO  Done!
2022-09-24 21:28:46 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-24 21:28:46 INFO  Running instrumented original pipeline...
2022-09-24 21:28:46 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-24 21:28:46 INFO  ---RUNTIME: Importing and monkey-patching took 6.252050399780273 ms
2022-09-24 21:28:52 INFO  ---RUNTIME: Original pipeline execution took 5724.078178405762 ms (excluding imports and monkey-patching)
2022-09-24 21:28:52 INFO  Starting execution of 1 what-if analyses...
2022-09-24 21:28:52 INFO  Start plan generation for analysis PermutationFeatureImportance...
2022-09-24 21:28:52 INFO  ---RUNTIME: Plan generation took 0.11157989501953125 ms
2022-09-24 21:28:52 INFO  Estimated runtime of original DAG is 5412.2374057769775ms
2022-09-24 21:28:52 WARNING Skipping Multi-Query Optimization (instead, only applying patches)
2022-09-24 21:28:52 INFO  Estimated unoptimised what-if runtime is 27061.187028884888ms
2022-09-24 21:28:52 INFO  ---RUNTIME: Multi-Query Optimization took 4.807233810424805 ms
2022-09-24 21:28:52 INFO  Executing generated plans
2022-09-24 21:29:19 INFO  ---RUNTIME: Execution took 27873.146533966064 ms
2022-09-24 21:29:19 INFO  Done!
2022-09-24 21:29:19 INFO  # Finished -- repetition 2 of 7 
2022-09-24 21:29:19 INFO  # Optimization benchmark for feature_importance with args [['reviews', 'slow_loading', 'featurization_0', 'logistic_regression']] -- repetition 3 of 7
2022-09-24 21:29:19 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-24 21:29:19 INFO  Running instrumented original pipeline...
2022-09-24 21:29:19 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-24 21:29:19 INFO  ---RUNTIME: Importing and monkey-patching took 6.625652313232422 ms
2022-09-24 21:29:25 INFO  ---RUNTIME: Original pipeline execution took 5660.722255706787 ms (excluding imports and monkey-patching)
2022-09-24 21:29:25 INFO  Starting execution of 1 what-if analyses...
2022-09-24 21:29:25 INFO  Start plan generation for analysis PermutationFeatureImportance...
2022-09-24 21:29:25 INFO  ---RUNTIME: Plan generation took 0.11467933654785156 ms
2022-09-24 21:29:25 INFO  Estimated runtime of original DAG is 5375.752210617065ms
2022-09-24 21:29:25 INFO  Performing Multi-Query Optimization
2022-09-24 21:29:25 INFO  Estimated unoptimized what-if runtime is 26878.761053085327ms
2022-09-24 21:29:25 INFO  Estimated optimised what-if runtime is 6709.148645401001ms
2022-09-24 21:29:25 INFO  Estimated optimisation runtime saving is 20169.612407684326ms
2022-09-24 21:29:25 INFO  ---RUNTIME: Multi-Query Optimization took 9.48023796081543 ms
2022-09-24 21:29:25 INFO  Executing generated plans
2022-09-24 21:29:32 INFO  ---RUNTIME: Execution took 6844.503164291382 ms
2022-09-24 21:29:32 INFO  Done!
2022-09-24 21:29:32 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-24 21:29:32 INFO  Running instrumented original pipeline...
2022-09-24 21:29:32 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-24 21:29:32 INFO  ---RUNTIME: Importing and monkey-patching took 6.501913070678711 ms
2022-09-24 21:29:38 INFO  ---RUNTIME: Original pipeline execution took 5658.967733383179 ms (excluding imports and monkey-patching)
2022-09-24 21:29:38 INFO  Starting execution of 1 what-if analyses...
2022-09-24 21:29:38 INFO  Start plan generation for analysis PermutationFeatureImportance...
2022-09-24 21:29:38 INFO  ---RUNTIME: Plan generation took 0.13518333435058594 ms
2022-09-24 21:29:38 INFO  Estimated runtime of original DAG is 5375.300645828247ms
2022-09-24 21:29:38 WARNING Skipping Multi-Query Optimization (instead, only applying patches)
2022-09-24 21:29:38 INFO  Estimated unoptimised what-if runtime is 26876.503229141235ms
2022-09-24 21:29:38 INFO  ---RUNTIME: Multi-Query Optimization took 3.815889358520508 ms
2022-09-24 21:29:38 INFO  Executing generated plans
2022-09-24 21:30:05 INFO  ---RUNTIME: Execution took 27559.525728225708 ms
2022-09-24 21:30:05 INFO  Done!
2022-09-24 21:30:05 INFO  # Finished -- repetition 3 of 7 
2022-09-24 21:30:05 INFO  # Optimization benchmark for feature_importance with args [['reviews', 'slow_loading', 'featurization_0', 'logistic_regression']] -- repetition 4 of 7
2022-09-24 21:30:05 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-24 21:30:05 INFO  Running instrumented original pipeline...
2022-09-24 21:30:05 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-24 21:30:05 INFO  ---RUNTIME: Importing and monkey-patching took 6.483793258666992 ms
2022-09-24 21:30:11 INFO  ---RUNTIME: Original pipeline execution took 5652.442455291748 ms (excluding imports and monkey-patching)
2022-09-24 21:30:11 INFO  Starting execution of 1 what-if analyses...
2022-09-24 21:30:11 INFO  Start plan generation for analysis PermutationFeatureImportance...
2022-09-24 21:30:11 INFO  ---RUNTIME: Plan generation took 0.12111663818359375 ms
2022-09-24 21:30:11 INFO  Estimated runtime of original DAG is 5368.639945983887ms
2022-09-24 21:30:11 INFO  Performing Multi-Query Optimization
2022-09-24 21:30:11 INFO  Estimated unoptimized what-if runtime is 26843.199729919434ms
2022-09-24 21:30:11 INFO  Estimated optimised what-if runtime is 6706.817150115967ms
2022-09-24 21:30:11 INFO  Estimated optimisation runtime saving is 20136.382579803467ms
2022-09-24 21:30:11 INFO  ---RUNTIME: Multi-Query Optimization took 9.403467178344727 ms
2022-09-24 21:30:11 INFO  Executing generated plans
2022-09-24 21:30:18 INFO  ---RUNTIME: Execution took 6898.348093032837 ms
2022-09-24 21:30:18 INFO  Done!
2022-09-24 21:30:18 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-24 21:30:18 INFO  Running instrumented original pipeline...
2022-09-24 21:30:18 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-24 21:30:18 INFO  ---RUNTIME: Importing and monkey-patching took 6.227016448974609 ms
2022-09-24 21:30:23 INFO  ---RUNTIME: Original pipeline execution took 5702.669858932495 ms (excluding imports and monkey-patching)
2022-09-24 21:30:23 INFO  Starting execution of 1 what-if analyses...
2022-09-24 21:30:23 INFO  Start plan generation for analysis PermutationFeatureImportance...
2022-09-24 21:30:23 INFO  ---RUNTIME: Plan generation took 0.10037422180175781 ms
2022-09-24 21:30:23 INFO  Estimated runtime of original DAG is 5420.402526855469ms
2022-09-24 21:30:23 WARNING Skipping Multi-Query Optimization (instead, only applying patches)
2022-09-24 21:30:23 INFO  Estimated unoptimised what-if runtime is 27102.012634277344ms
2022-09-24 21:30:23 INFO  ---RUNTIME: Multi-Query Optimization took 3.719806671142578 ms
2022-09-24 21:30:23 INFO  Executing generated plans
2022-09-24 21:30:51 INFO  ---RUNTIME: Execution took 27519.586324691772 ms
2022-09-24 21:30:51 INFO  Done!
2022-09-24 21:30:51 INFO  # Finished -- repetition 4 of 7 
2022-09-24 21:30:51 INFO  # Optimization benchmark for feature_importance with args [['reviews', 'slow_loading', 'featurization_0', 'logistic_regression']] -- repetition 5 of 7
2022-09-24 21:30:51 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-24 21:30:51 INFO  Running instrumented original pipeline...
2022-09-24 21:30:51 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-24 21:30:51 INFO  ---RUNTIME: Importing and monkey-patching took 6.630659103393555 ms
2022-09-24 21:30:57 INFO  ---RUNTIME: Original pipeline execution took 5643.323183059692 ms (excluding imports and monkey-patching)
2022-09-24 21:30:57 INFO  Starting execution of 1 what-if analyses...
2022-09-24 21:30:57 INFO  Start plan generation for analysis PermutationFeatureImportance...
2022-09-24 21:30:57 INFO  ---RUNTIME: Plan generation took 0.11873245239257812 ms
2022-09-24 21:30:57 INFO  Estimated runtime of original DAG is 5360.72039604187ms
2022-09-24 21:30:57 INFO  Performing Multi-Query Optimization
2022-09-24 21:30:57 INFO  Estimated unoptimized what-if runtime is 26803.60198020935ms
2022-09-24 21:30:57 INFO  Estimated optimised what-if runtime is 6719.085931777954ms
2022-09-24 21:30:57 INFO  Estimated optimisation runtime saving is 20084.516048431396ms
2022-09-24 21:30:57 INFO  ---RUNTIME: Multi-Query Optimization took 9.458541870117188 ms
2022-09-24 21:30:57 INFO  Executing generated plans
2022-09-24 21:31:04 INFO  ---RUNTIME: Execution took 6934.056282043457 ms
2022-09-24 21:31:04 INFO  Done!
2022-09-24 21:31:04 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-24 21:31:04 INFO  Running instrumented original pipeline...
2022-09-24 21:31:04 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-24 21:31:04 INFO  ---RUNTIME: Importing and monkey-patching took 6.352663040161133 ms
2022-09-24 21:31:10 INFO  ---RUNTIME: Original pipeline execution took 5930.561542510986 ms (excluding imports and monkey-patching)
2022-09-24 21:31:10 INFO  Starting execution of 1 what-if analyses...
2022-09-24 21:31:10 INFO  Start plan generation for analysis PermutationFeatureImportance...
2022-09-24 21:31:10 INFO  ---RUNTIME: Plan generation took 0.09918212890625 ms
2022-09-24 21:31:10 INFO  Estimated runtime of original DAG is 5436.9189739227295ms
2022-09-24 21:31:10 WARNING Skipping Multi-Query Optimization (instead, only applying patches)
2022-09-24 21:31:10 INFO  Estimated unoptimised what-if runtime is 27184.594869613647ms
2022-09-24 21:31:10 INFO  ---RUNTIME: Multi-Query Optimization took 3.681182861328125 ms
2022-09-24 21:31:10 INFO  Executing generated plans
2022-09-24 21:31:37 INFO  ---RUNTIME: Execution took 27384.29045677185 ms
2022-09-24 21:31:37 INFO  Done!
2022-09-24 21:31:37 INFO  # Finished -- repetition 5 of 7 
2022-09-24 21:31:37 INFO  # Optimization benchmark for feature_importance with args [['reviews', 'slow_loading', 'featurization_0', 'logistic_regression']] -- repetition 6 of 7
2022-09-24 21:31:37 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-24 21:31:37 INFO  Running instrumented original pipeline...
2022-09-24 21:31:37 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-24 21:31:37 INFO  ---RUNTIME: Importing and monkey-patching took 6.113290786743164 ms
2022-09-24 21:31:43 INFO  ---RUNTIME: Original pipeline execution took 5839.455604553223 ms (excluding imports and monkey-patching)
2022-09-24 21:31:43 INFO  Starting execution of 1 what-if analyses...
2022-09-24 21:31:43 INFO  Start plan generation for analysis PermutationFeatureImportance...
2022-09-24 21:31:43 INFO  ---RUNTIME: Plan generation took 0.11515617370605469 ms
2022-09-24 21:31:43 INFO  Estimated runtime of original DAG is 5559.955835342407ms
2022-09-24 21:31:43 INFO  Performing Multi-Query Optimization
2022-09-24 21:31:43 INFO  Estimated unoptimized what-if runtime is 27799.779176712036ms
2022-09-24 21:31:43 INFO  Estimated optimised what-if runtime is 6944.806098937988ms
2022-09-24 21:31:43 INFO  Estimated optimisation runtime saving is 20854.973077774048ms
2022-09-24 21:31:43 INFO  ---RUNTIME: Multi-Query Optimization took 10.589838027954102 ms
2022-09-24 21:31:43 INFO  Executing generated plans
2022-09-24 21:31:50 INFO  ---RUNTIME: Execution took 6787.0495319366455 ms
2022-09-24 21:31:50 INFO  Done!
2022-09-24 21:31:50 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-24 21:31:50 INFO  Running instrumented original pipeline...
2022-09-24 21:31:50 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-24 21:31:50 INFO  ---RUNTIME: Importing and monkey-patching took 6.134748458862305 ms
2022-09-24 21:31:55 INFO  ---RUNTIME: Original pipeline execution took 5660.552263259888 ms (excluding imports and monkey-patching)
2022-09-24 21:31:55 INFO  Starting execution of 1 what-if analyses...
2022-09-24 21:31:55 INFO  Start plan generation for analysis PermutationFeatureImportance...
2022-09-24 21:31:55 INFO  ---RUNTIME: Plan generation took 0.1385211944580078 ms
2022-09-24 21:31:55 INFO  Estimated runtime of original DAG is 5372.876167297363ms
2022-09-24 21:31:55 WARNING Skipping Multi-Query Optimization (instead, only applying patches)
2022-09-24 21:31:55 INFO  Estimated unoptimised what-if runtime is 26864.380836486816ms
2022-09-24 21:31:55 INFO  ---RUNTIME: Multi-Query Optimization took 3.833770751953125 ms
2022-09-24 21:31:55 INFO  Executing generated plans
2022-09-24 21:32:23 INFO  ---RUNTIME: Execution took 27784.39688682556 ms
2022-09-24 21:32:23 INFO  Done!
2022-09-24 21:32:23 INFO  # Finished -- repetition 6 of 7 
2022-09-24 21:32:23 INFO  # Optimization benchmark for feature_importance with args [['reviews', 'slow_loading', 'featurization_0', 'logistic_regression']] -- repetition 7 of 7
2022-09-24 21:32:23 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-24 21:32:23 INFO  Running instrumented original pipeline...
2022-09-24 21:32:23 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-24 21:32:23 INFO  ---RUNTIME: Importing and monkey-patching took 6.056547164916992 ms
2022-09-24 21:32:29 INFO  ---RUNTIME: Original pipeline execution took 5814.89634513855 ms (excluding imports and monkey-patching)
2022-09-24 21:32:29 INFO  Starting execution of 1 what-if analyses...
2022-09-24 21:32:29 INFO  Start plan generation for analysis PermutationFeatureImportance...
2022-09-24 21:32:29 INFO  ---RUNTIME: Plan generation took 0.13303756713867188 ms
2022-09-24 21:32:29 INFO  Estimated runtime of original DAG is 5518.405199050903ms
2022-09-24 21:32:29 INFO  Performing Multi-Query Optimization
2022-09-24 21:32:29 INFO  Estimated unoptimized what-if runtime is 27592.025995254517ms
2022-09-24 21:32:29 INFO  Estimated optimised what-if runtime is 6882.307291030884ms
2022-09-24 21:32:29 INFO  Estimated optimisation runtime saving is 20709.718704223633ms
2022-09-24 21:32:29 INFO  ---RUNTIME: Multi-Query Optimization took 9.423971176147461 ms
2022-09-24 21:32:29 INFO  Executing generated plans
2022-09-24 21:32:36 INFO  ---RUNTIME: Execution took 6868.81422996521 ms
2022-09-24 21:32:36 INFO  Done!
2022-09-24 21:32:36 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-24 21:32:36 INFO  Running instrumented original pipeline...
2022-09-24 21:32:36 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-24 21:32:36 INFO  ---RUNTIME: Importing and monkey-patching took 6.103038787841797 ms
2022-09-24 21:32:41 INFO  ---RUNTIME: Original pipeline execution took 5672.974109649658 ms (excluding imports and monkey-patching)
2022-09-24 21:32:41 INFO  Starting execution of 1 what-if analyses...
2022-09-24 21:32:41 INFO  Start plan generation for analysis PermutationFeatureImportance...
2022-09-24 21:32:41 INFO  ---RUNTIME: Plan generation took 0.10633468627929688 ms
2022-09-24 21:32:41 INFO  Estimated runtime of original DAG is 5392.561197280884ms
2022-09-24 21:32:41 WARNING Skipping Multi-Query Optimization (instead, only applying patches)
2022-09-24 21:32:41 INFO  Estimated unoptimised what-if runtime is 26962.80598640442ms
2022-09-24 21:32:41 INFO  ---RUNTIME: Multi-Query Optimization took 3.705263137817383 ms
2022-09-24 21:32:41 INFO  Executing generated plans
2022-09-24 21:33:09 INFO  ---RUNTIME: Execution took 27886.764764785767 ms
2022-09-24 21:33:09 INFO  Done!
2022-09-24 21:33:09 INFO  # Finished -- repetition 7 of 7 
2022-09-24 21:33:09 INFO  # Final results after all repetitions
2022-09-24 21:33:09 INFO     repetition  ... no_opt_what_if_execution_combined_model_training
0           0  ...                                       790.242672
1           1  ...                                       792.107821
2           2  ...                                       792.690992
3           3  ...                                       793.523788
4           4  ...                                       814.731598
5           5  ...                                       801.498890
6           6  ...                                       807.451963

[7 rows x 26 columns]
PROTOCOL_BUFFERS_PYTHON_IMPLEMENTATION=python taskset -c 32-39 python3.9 benchmarks_end_to_end.py feature_importance reviews slow_loading featurization_0 xgboost
2022-09-24 21:33:12.123929: W tensorflow/stream_executor/platform/default/dso_loader.cc:64] Could not load dynamic library 'libcudart.so.11.0'; dlerror: libcudart.so.11.0: cannot open shared object file: No such file or directory; LD_LIBRARY_PATH: /home/sgrafbe/mlwhatif/venv/lib/python3.9/site-packages/cv2/../../lib64:
2022-09-24 21:33:12.123972: I tensorflow/stream_executor/cuda/cudart_stub.cc:29] Ignore above cudart dlerror if you do not have a GPU set up on your machine.
2022-09-24 21:33:13 INFO  Patching sys.argv with ['mlwhatif', 'reviews', 'slow_loading', 'featurization_0', 'xgboost']
2022-09-24 21:33:13 INFO  Running instrumented original pipeline...
2022-09-24 21:33:13 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-24 21:33:13 INFO  ---RUNTIME: Importing and monkey-patching took 95.90744972229004 ms
2022-09-24 21:33:21 INFO  ---RUNTIME: Original pipeline execution took 7755.582094192505 ms (excluding imports and monkey-patching)
2022-09-24 21:33:21 INFO  Starting execution of 0 what-if analyses...
2022-09-24 21:33:21 INFO  Estimated runtime of original DAG is 7437.864542007446ms
2022-09-24 21:33:21 INFO  Performing Multi-Query Optimization
2022-09-24 21:33:21 INFO  Estimated unoptimized what-if runtime is 0ms
2022-09-24 21:33:21 INFO  Estimated optimised what-if runtime is 0ms
2022-09-24 21:33:21 INFO  Estimated optimisation runtime saving is 0ms
2022-09-24 21:33:21 INFO  ---RUNTIME: Multi-Query Optimization took 0.5371570587158203 ms
2022-09-24 21:33:21 INFO  Executing generated plans
2022-09-24 21:33:21 INFO  ---RUNTIME: Execution took 0.026464462280273438 ms
2022-09-24 21:33:21 INFO  Done!
2022-09-24 21:33:21 INFO  # Optimization benchmark for feature_importance with args [['reviews', 'slow_loading', 'featurization_0', 'xgboost']] -- repetition 1 of 7
2022-09-24 21:33:21 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-24 21:33:21 INFO  Running instrumented original pipeline...
2022-09-24 21:33:21 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-24 21:33:21 INFO  ---RUNTIME: Importing and monkey-patching took 5.725622177124023 ms
2022-09-24 21:33:28 INFO  ---RUNTIME: Original pipeline execution took 7634.608745574951 ms (excluding imports and monkey-patching)
2022-09-24 21:33:28 INFO  Starting execution of 1 what-if analyses...
2022-09-24 21:33:28 INFO  Start plan generation for analysis PermutationFeatureImportance...
2022-09-24 21:33:28 INFO  ---RUNTIME: Plan generation took 0.19240379333496094 ms
2022-09-24 21:33:28 INFO  Estimated runtime of original DAG is 7345.380783081055ms
2022-09-24 21:33:28 INFO  Performing Multi-Query Optimization
2022-09-24 21:33:28 INFO  Estimated unoptimized what-if runtime is 36726.90391540527ms
2022-09-24 21:33:28 INFO  Estimated optimised what-if runtime is 9851.05586051941ms
2022-09-24 21:33:28 INFO  Estimated optimisation runtime saving is 26875.848054885864ms
2022-09-24 21:33:28 INFO  ---RUNTIME: Multi-Query Optimization took 10.684967041015625 ms
2022-09-24 21:33:28 INFO  Executing generated plans
2022-09-24 21:33:39 INFO  ---RUNTIME: Execution took 10523.087739944458 ms
2022-09-24 21:33:39 INFO  Done!
2022-09-24 21:33:39 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-24 21:33:39 INFO  Running instrumented original pipeline...
2022-09-24 21:33:39 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-24 21:33:39 INFO  ---RUNTIME: Importing and monkey-patching took 6.085395812988281 ms
2022-09-24 21:33:47 INFO  ---RUNTIME: Original pipeline execution took 7842.07010269165 ms (excluding imports and monkey-patching)
2022-09-24 21:33:47 INFO  Starting execution of 1 what-if analyses...
2022-09-24 21:33:47 INFO  Start plan generation for analysis PermutationFeatureImportance...
2022-09-24 21:33:47 INFO  ---RUNTIME: Plan generation took 0.12135505676269531 ms
2022-09-24 21:33:47 INFO  Estimated runtime of original DAG is 7370.012044906616ms
2022-09-24 21:33:47 WARNING Skipping Multi-Query Optimization (instead, only applying patches)
2022-09-24 21:33:47 INFO  Estimated unoptimised what-if runtime is 36850.06022453308ms
2022-09-24 21:33:47 INFO  ---RUNTIME: Multi-Query Optimization took 4.5986175537109375 ms
2022-09-24 21:33:47 INFO  Executing generated plans
2022-09-24 21:34:24 INFO  ---RUNTIME: Execution took 37138.55504989624 ms
2022-09-24 21:34:24 INFO  Done!
2022-09-24 21:34:24 INFO  # Finished -- repetition 1 of 7 
2022-09-24 21:34:24 INFO  # Optimization benchmark for feature_importance with args [['reviews', 'slow_loading', 'featurization_0', 'xgboost']] -- repetition 2 of 7
2022-09-24 21:34:24 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-24 21:34:24 INFO  Running instrumented original pipeline...
2022-09-24 21:34:24 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-24 21:34:24 INFO  ---RUNTIME: Importing and monkey-patching took 6.4868927001953125 ms
2022-09-24 21:34:32 INFO  ---RUNTIME: Original pipeline execution took 7602.36668586731 ms (excluding imports and monkey-patching)
2022-09-24 21:34:32 INFO  Starting execution of 1 what-if analyses...
2022-09-24 21:34:32 INFO  Start plan generation for analysis PermutationFeatureImportance...
2022-09-24 21:34:32 INFO  ---RUNTIME: Plan generation took 0.1399517059326172 ms
2022-09-24 21:34:32 INFO  Estimated runtime of original DAG is 7314.1114711761475ms
2022-09-24 21:34:32 INFO  Performing Multi-Query Optimization
2022-09-24 21:34:32 INFO  Estimated unoptimized what-if runtime is 36570.55735588074ms
2022-09-24 21:34:32 INFO  Estimated optimised what-if runtime is 9816.120147705078ms
2022-09-24 21:34:32 INFO  Estimated optimisation runtime saving is 26754.43720817566ms
2022-09-24 21:34:32 INFO  ---RUNTIME: Multi-Query Optimization took 9.510993957519531 ms
2022-09-24 21:34:32 INFO  Executing generated plans
2022-09-24 21:34:41 INFO  ---RUNTIME: Execution took 9937.573432922363 ms
2022-09-24 21:34:41 INFO  Done!
2022-09-24 21:34:42 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-24 21:34:42 INFO  Running instrumented original pipeline...
2022-09-24 21:34:42 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-24 21:34:42 INFO  ---RUNTIME: Importing and monkey-patching took 6.215333938598633 ms
2022-09-24 21:34:49 INFO  ---RUNTIME: Original pipeline execution took 7696.7198848724365 ms (excluding imports and monkey-patching)
2022-09-24 21:34:49 INFO  Starting execution of 1 what-if analyses...
2022-09-24 21:34:49 INFO  Start plan generation for analysis PermutationFeatureImportance...
2022-09-24 21:34:49 INFO  ---RUNTIME: Plan generation took 0.13065338134765625 ms
2022-09-24 21:34:49 INFO  Estimated runtime of original DAG is 7404.904842376709ms
2022-09-24 21:34:49 WARNING Skipping Multi-Query Optimization (instead, only applying patches)
2022-09-24 21:34:49 INFO  Estimated unoptimised what-if runtime is 37024.524211883545ms
2022-09-24 21:34:49 INFO  ---RUNTIME: Multi-Query Optimization took 3.6826133728027344 ms
2022-09-24 21:34:49 INFO  Executing generated plans
2022-09-24 21:35:27 INFO  ---RUNTIME: Execution took 37365.69929122925 ms
2022-09-24 21:35:27 INFO  Done!
2022-09-24 21:35:27 INFO  # Finished -- repetition 2 of 7 
2022-09-24 21:35:27 INFO  # Optimization benchmark for feature_importance with args [['reviews', 'slow_loading', 'featurization_0', 'xgboost']] -- repetition 3 of 7
2022-09-24 21:35:27 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-24 21:35:27 INFO  Running instrumented original pipeline...
2022-09-24 21:35:27 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-24 21:35:27 INFO  ---RUNTIME: Importing and monkey-patching took 6.589651107788086 ms
2022-09-24 21:35:34 INFO  ---RUNTIME: Original pipeline execution took 7633.469820022583 ms (excluding imports and monkey-patching)
2022-09-24 21:35:34 INFO  Starting execution of 1 what-if analyses...
2022-09-24 21:35:34 INFO  Start plan generation for analysis PermutationFeatureImportance...
2022-09-24 21:35:34 INFO  ---RUNTIME: Plan generation took 0.12063980102539062 ms
2022-09-24 21:35:34 INFO  Estimated runtime of original DAG is 7341.058015823364ms
2022-09-24 21:35:34 INFO  Performing Multi-Query Optimization
2022-09-24 21:35:34 INFO  Estimated unoptimized what-if runtime is 36705.29007911682ms
2022-09-24 21:35:34 INFO  Estimated optimised what-if runtime is 9847.360134124756ms
2022-09-24 21:35:34 INFO  Estimated optimisation runtime saving is 26857.929944992065ms
2022-09-24 21:35:34 INFO  ---RUNTIME: Multi-Query Optimization took 9.447813034057617 ms
2022-09-24 21:35:34 INFO  Executing generated plans
2022-09-24 21:35:44 INFO  ---RUNTIME: Execution took 9989.525079727173 ms
2022-09-24 21:35:44 INFO  Done!
2022-09-24 21:35:44 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-24 21:35:44 INFO  Running instrumented original pipeline...
2022-09-24 21:35:44 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-24 21:35:44 INFO  ---RUNTIME: Importing and monkey-patching took 6.116151809692383 ms
2022-09-24 21:35:52 INFO  ---RUNTIME: Original pipeline execution took 7708.328485488892 ms (excluding imports and monkey-patching)
2022-09-24 21:35:52 INFO  Starting execution of 1 what-if analyses...
2022-09-24 21:35:52 INFO  Start plan generation for analysis PermutationFeatureImportance...
2022-09-24 21:35:52 INFO  ---RUNTIME: Plan generation took 0.11968612670898438 ms
2022-09-24 21:35:52 INFO  Estimated runtime of original DAG is 7413.8758182525635ms
2022-09-24 21:35:52 WARNING Skipping Multi-Query Optimization (instead, only applying patches)
2022-09-24 21:35:52 INFO  Estimated unoptimised what-if runtime is 37069.37909126282ms
2022-09-24 21:35:52 INFO  ---RUNTIME: Multi-Query Optimization took 3.7348270416259766 ms
2022-09-24 21:35:52 INFO  Executing generated plans
2022-09-24 21:36:29 INFO  ---RUNTIME: Execution took 37282.75489807129 ms
2022-09-24 21:36:29 INFO  Done!
2022-09-24 21:36:29 INFO  # Finished -- repetition 3 of 7 
2022-09-24 21:36:29 INFO  # Optimization benchmark for feature_importance with args [['reviews', 'slow_loading', 'featurization_0', 'xgboost']] -- repetition 4 of 7
2022-09-24 21:36:29 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-24 21:36:29 INFO  Running instrumented original pipeline...
2022-09-24 21:36:29 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-24 21:36:29 INFO  ---RUNTIME: Importing and monkey-patching took 6.546497344970703 ms
2022-09-24 21:36:37 INFO  ---RUNTIME: Original pipeline execution took 7655.866384506226 ms (excluding imports and monkey-patching)
2022-09-24 21:36:37 INFO  Starting execution of 1 what-if analyses...
2022-09-24 21:36:37 INFO  Start plan generation for analysis PermutationFeatureImportance...
2022-09-24 21:36:37 INFO  ---RUNTIME: Plan generation took 0.11444091796875 ms
2022-09-24 21:36:37 INFO  Estimated runtime of original DAG is 7361.234664916992ms
2022-09-24 21:36:37 INFO  Performing Multi-Query Optimization
2022-09-24 21:36:37 INFO  Estimated unoptimized what-if runtime is 36806.17332458496ms
2022-09-24 21:36:37 INFO  Estimated optimised what-if runtime is 9867.76614189148ms
2022-09-24 21:36:37 INFO  Estimated optimisation runtime saving is 26938.40718269348ms
2022-09-24 21:36:37 INFO  ---RUNTIME: Multi-Query Optimization took 9.48476791381836 ms
2022-09-24 21:36:37 INFO  Executing generated plans
2022-09-24 21:36:47 INFO  ---RUNTIME: Execution took 9953.121423721313 ms
2022-09-24 21:36:47 INFO  Done!
2022-09-24 21:36:47 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-24 21:36:47 INFO  Running instrumented original pipeline...
2022-09-24 21:36:47 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-24 21:36:47 INFO  ---RUNTIME: Importing and monkey-patching took 6.687641143798828 ms
2022-09-24 21:36:55 INFO  ---RUNTIME: Original pipeline execution took 7738.6016845703125 ms (excluding imports and monkey-patching)
2022-09-24 21:36:55 INFO  Starting execution of 1 what-if analyses...
2022-09-24 21:36:55 INFO  Start plan generation for analysis PermutationFeatureImportance...
2022-09-24 21:36:55 INFO  ---RUNTIME: Plan generation took 0.1239776611328125 ms
2022-09-24 21:36:55 INFO  Estimated runtime of original DAG is 7446.35009765625ms
2022-09-24 21:36:55 WARNING Skipping Multi-Query Optimization (instead, only applying patches)
2022-09-24 21:36:55 INFO  Estimated unoptimised what-if runtime is 37231.75048828125ms
2022-09-24 21:36:55 INFO  ---RUNTIME: Multi-Query Optimization took 3.7603378295898438 ms
2022-09-24 21:36:55 INFO  Executing generated plans
2022-09-24 21:37:32 INFO  ---RUNTIME: Execution took 37158.393144607544 ms
2022-09-24 21:37:32 INFO  Done!
2022-09-24 21:37:32 INFO  # Finished -- repetition 4 of 7 
2022-09-24 21:37:32 INFO  # Optimization benchmark for feature_importance with args [['reviews', 'slow_loading', 'featurization_0', 'xgboost']] -- repetition 5 of 7
2022-09-24 21:37:32 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-24 21:37:32 INFO  Running instrumented original pipeline...
2022-09-24 21:37:32 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-24 21:37:32 INFO  ---RUNTIME: Importing and monkey-patching took 6.202220916748047 ms
2022-09-24 21:37:39 INFO  ---RUNTIME: Original pipeline execution took 7637.6378536224365 ms (excluding imports and monkey-patching)
2022-09-24 21:37:39 INFO  Starting execution of 1 what-if analyses...
2022-09-24 21:37:39 INFO  Start plan generation for analysis PermutationFeatureImportance...
2022-09-24 21:37:39 INFO  ---RUNTIME: Plan generation took 0.12683868408203125 ms
2022-09-24 21:37:39 INFO  Estimated runtime of original DAG is 7344.835996627808ms
2022-09-24 21:37:39 INFO  Performing Multi-Query Optimization
2022-09-24 21:37:40 INFO  Estimated unoptimized what-if runtime is 36724.17998313904ms
2022-09-24 21:37:40 INFO  Estimated optimised what-if runtime is 9852.291822433472ms
2022-09-24 21:37:40 INFO  Estimated optimisation runtime saving is 26871.888160705566ms
2022-09-24 21:37:40 INFO  ---RUNTIME: Multi-Query Optimization took 10.190725326538086 ms
2022-09-24 21:37:40 INFO  Executing generated plans
2022-09-24 21:37:50 INFO  ---RUNTIME: Execution took 10166.328430175781 ms
2022-09-24 21:37:50 INFO  Done!
2022-09-24 21:37:50 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-24 21:37:50 INFO  Running instrumented original pipeline...
2022-09-24 21:37:50 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-24 21:37:50 INFO  ---RUNTIME: Importing and monkey-patching took 6.58416748046875 ms
2022-09-24 21:37:57 INFO  ---RUNTIME: Original pipeline execution took 7645.6334590911865 ms (excluding imports and monkey-patching)
2022-09-24 21:37:57 INFO  Starting execution of 1 what-if analyses...
2022-09-24 21:37:57 INFO  Start plan generation for analysis PermutationFeatureImportance...
2022-09-24 21:37:57 INFO  ---RUNTIME: Plan generation took 0.091552734375 ms
2022-09-24 21:37:57 INFO  Estimated runtime of original DAG is 7353.341102600098ms
2022-09-24 21:37:57 WARNING Skipping Multi-Query Optimization (instead, only applying patches)
2022-09-24 21:37:57 INFO  Estimated unoptimised what-if runtime is 36766.70551300049ms
2022-09-24 21:37:57 INFO  ---RUNTIME: Multi-Query Optimization took 3.6754608154296875 ms
2022-09-24 21:37:57 INFO  Executing generated plans
2022-09-24 21:38:35 INFO  ---RUNTIME: Execution took 37445.07360458374 ms
2022-09-24 21:38:35 INFO  Done!
2022-09-24 21:38:35 INFO  # Finished -- repetition 5 of 7 
2022-09-24 21:38:35 INFO  # Optimization benchmark for feature_importance with args [['reviews', 'slow_loading', 'featurization_0', 'xgboost']] -- repetition 6 of 7
2022-09-24 21:38:35 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-24 21:38:35 INFO  Running instrumented original pipeline...
2022-09-24 21:38:35 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-24 21:38:35 INFO  ---RUNTIME: Importing and monkey-patching took 6.316900253295898 ms
2022-09-24 21:38:42 INFO  ---RUNTIME: Original pipeline execution took 7634.345769882202 ms (excluding imports and monkey-patching)
2022-09-24 21:38:42 INFO  Starting execution of 1 what-if analyses...
2022-09-24 21:38:42 INFO  Start plan generation for analysis PermutationFeatureImportance...
2022-09-24 21:38:42 INFO  ---RUNTIME: Plan generation took 0.12636184692382812 ms
2022-09-24 21:38:42 INFO  Estimated runtime of original DAG is 7342.691898345947ms
2022-09-24 21:38:42 INFO  Performing Multi-Query Optimization
2022-09-24 21:38:42 INFO  Estimated unoptimized what-if runtime is 36713.459491729736ms
2022-09-24 21:38:42 INFO  Estimated optimised what-if runtime is 9852.048635482788ms
2022-09-24 21:38:42 INFO  Estimated optimisation runtime saving is 26861.41085624695ms
2022-09-24 21:38:42 INFO  ---RUNTIME: Multi-Query Optimization took 10.324239730834961 ms
2022-09-24 21:38:42 INFO  Executing generated plans
2022-09-24 21:38:52 INFO  ---RUNTIME: Execution took 9944.291114807129 ms
2022-09-24 21:38:52 INFO  Done!
2022-09-24 21:38:52 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-24 21:38:52 INFO  Running instrumented original pipeline...
2022-09-24 21:38:52 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-24 21:38:52 INFO  ---RUNTIME: Importing and monkey-patching took 6.045818328857422 ms
2022-09-24 21:39:00 INFO  ---RUNTIME: Original pipeline execution took 7650.727987289429 ms (excluding imports and monkey-patching)
2022-09-24 21:39:00 INFO  Starting execution of 1 what-if analyses...
2022-09-24 21:39:00 INFO  Start plan generation for analysis PermutationFeatureImportance...
2022-09-24 21:39:00 INFO  ---RUNTIME: Plan generation took 0.11086463928222656 ms
2022-09-24 21:39:00 INFO  Estimated runtime of original DAG is 7354.071855545044ms
2022-09-24 21:39:00 WARNING Skipping Multi-Query Optimization (instead, only applying patches)
2022-09-24 21:39:00 INFO  Estimated unoptimised what-if runtime is 36770.35927772522ms
2022-09-24 21:39:00 INFO  ---RUNTIME: Multi-Query Optimization took 3.6830902099609375 ms
2022-09-24 21:39:00 INFO  Executing generated plans
2022-09-24 21:39:37 INFO  ---RUNTIME: Execution took 37075.66452026367 ms
2022-09-24 21:39:37 INFO  Done!
2022-09-24 21:39:37 INFO  # Finished -- repetition 6 of 7 
2022-09-24 21:39:37 INFO  # Optimization benchmark for feature_importance with args [['reviews', 'slow_loading', 'featurization_0', 'xgboost']] -- repetition 7 of 7
2022-09-24 21:39:37 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-24 21:39:37 INFO  Running instrumented original pipeline...
2022-09-24 21:39:37 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-24 21:39:37 INFO  ---RUNTIME: Importing and monkey-patching took 6.434440612792969 ms
2022-09-24 21:39:45 INFO  ---RUNTIME: Original pipeline execution took 7622.794151306152 ms (excluding imports and monkey-patching)
2022-09-24 21:39:45 INFO  Starting execution of 1 what-if analyses...
2022-09-24 21:39:45 INFO  Start plan generation for analysis PermutationFeatureImportance...
2022-09-24 21:39:45 INFO  ---RUNTIME: Plan generation took 0.12159347534179688 ms
2022-09-24 21:39:45 INFO  Estimated runtime of original DAG is 7329.06174659729ms
2022-09-24 21:39:45 INFO  Performing Multi-Query Optimization
2022-09-24 21:39:45 INFO  Estimated unoptimized what-if runtime is 36645.30873298645ms
2022-09-24 21:39:45 INFO  Estimated optimised what-if runtime is 9841.514348983765ms
2022-09-24 21:39:45 INFO  Estimated optimisation runtime saving is 26803.794384002686ms
2022-09-24 21:39:45 INFO  ---RUNTIME: Multi-Query Optimization took 9.463071823120117 ms
2022-09-24 21:39:45 INFO  Executing generated plans
2022-09-24 21:39:55 INFO  ---RUNTIME: Execution took 9939.581871032715 ms
2022-09-24 21:39:55 INFO  Done!
2022-09-24 21:39:55 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-24 21:39:55 INFO  Running instrumented original pipeline...
2022-09-24 21:39:55 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-24 21:39:55 INFO  ---RUNTIME: Importing and monkey-patching took 6.090641021728516 ms
2022-09-24 21:40:02 INFO  ---RUNTIME: Original pipeline execution took 7691.655397415161 ms (excluding imports and monkey-patching)
2022-09-24 21:40:02 INFO  Starting execution of 1 what-if analyses...
2022-09-24 21:40:02 INFO  Start plan generation for analysis PermutationFeatureImportance...
2022-09-24 21:40:02 INFO  ---RUNTIME: Plan generation took 0.10776519775390625 ms
2022-09-24 21:40:02 INFO  Estimated runtime of original DAG is 7401.663780212402ms
2022-09-24 21:40:02 WARNING Skipping Multi-Query Optimization (instead, only applying patches)
2022-09-24 21:40:02 INFO  Estimated unoptimised what-if runtime is 37008.31890106201ms
2022-09-24 21:40:02 INFO  ---RUNTIME: Multi-Query Optimization took 3.7195682525634766 ms
2022-09-24 21:40:02 INFO  Executing generated plans
2022-09-24 21:40:41 INFO  ---RUNTIME: Execution took 38406.04209899902 ms
2022-09-24 21:40:41 INFO  Done!
2022-09-24 21:40:41 INFO  # Finished -- repetition 7 of 7 
2022-09-24 21:40:41 INFO  # Final results after all repetitions
2022-09-24 21:40:41 INFO     repetition  ... no_opt_what_if_execution_combined_model_training
0           0  ...                                      9429.518938
1           1  ...                                      9415.499210
2           2  ...                                      9410.852909
3           3  ...                                      9424.129963
4           4  ...                                      9438.854456
5           5  ...                                      9412.168026
6           6  ...                                      9582.239866

[7 rows x 26 columns]
PROTOCOL_BUFFERS_PYTHON_IMPLEMENTATION=python taskset -c 32-39 python3.9 benchmarks_end_to_end.py feature_importance reviews slow_loading featurization_0 neural_network
2022-09-24 21:40:43.578893: W tensorflow/stream_executor/platform/default/dso_loader.cc:64] Could not load dynamic library 'libcudart.so.11.0'; dlerror: libcudart.so.11.0: cannot open shared object file: No such file or directory; LD_LIBRARY_PATH: /home/sgrafbe/mlwhatif/venv/lib/python3.9/site-packages/cv2/../../lib64:
2022-09-24 21:40:43.578932: I tensorflow/stream_executor/cuda/cudart_stub.cc:29] Ignore above cudart dlerror if you do not have a GPU set up on your machine.
2022-09-24 21:40:44 INFO  Patching sys.argv with ['mlwhatif', 'reviews', 'slow_loading', 'featurization_0', 'neural_network']
2022-09-24 21:40:44 INFO  Running instrumented original pipeline...
2022-09-24 21:40:45 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-24 21:40:45 INFO  ---RUNTIME: Importing and monkey-patching took 105.21578788757324 ms
2022-09-24 21:40:49.400647: W tensorflow/stream_executor/platform/default/dso_loader.cc:64] Could not load dynamic library 'libcuda.so.1'; dlerror: libcuda.so.1: cannot open shared object file: No such file or directory; LD_LIBRARY_PATH: /home/sgrafbe/mlwhatif/venv/lib/python3.9/site-packages/cv2/../../lib64:
2022-09-24 21:40:49.400681: W tensorflow/stream_executor/cuda/cuda_driver.cc:326] failed call to cuInit: UNKNOWN ERROR (303)
2022-09-24 21:40:49.400704: I tensorflow/stream_executor/cuda/cuda_diagnostics.cc:156] kernel driver does not appear to be running on this host (wagyu): /proc/driver/nvidia/version does not exist
2022-09-24 21:40:49.401217: I tensorflow/core/platform/cpu_feature_guard.cc:142] This TensorFlow binary is optimized with oneAPI Deep Neural Network Library (oneDNN) to use the following CPU instructions in performance-critical operations:  AVX2 FMA
To enable them in other operations, rebuild TensorFlow with the appropriate compiler flags.
2022-09-24 21:40:49.471365: I tensorflow/compiler/mlir/mlir_graph_optimization_pass.cc:176] None of the MLIR Optimization Passes are enabled (registered 2)
2022-09-24 21:40:49.483377: I tensorflow/core/platform/profile_utils/cpu_utils.cc:114] CPU Frequency: 2595290000 Hz
2022-09-24 21:40:54 INFO  ---RUNTIME: Original pipeline execution took 9911.994934082031 ms (excluding imports and monkey-patching)
2022-09-24 21:40:54 INFO  Starting execution of 0 what-if analyses...
2022-09-24 21:40:54 INFO  Estimated runtime of original DAG is 9597.233295440674ms
2022-09-24 21:40:54 INFO  Performing Multi-Query Optimization
2022-09-24 21:40:54 INFO  Estimated unoptimized what-if runtime is 0ms
2022-09-24 21:40:54 INFO  Estimated optimised what-if runtime is 0ms
2022-09-24 21:40:54 INFO  Estimated optimisation runtime saving is 0ms
2022-09-24 21:40:54 INFO  ---RUNTIME: Multi-Query Optimization took 0.4515647888183594 ms
2022-09-24 21:40:54 INFO  Executing generated plans
2022-09-24 21:40:54 INFO  ---RUNTIME: Execution took 0.02193450927734375 ms
2022-09-24 21:40:54 INFO  Done!
2022-09-24 21:40:54 INFO  # Optimization benchmark for feature_importance with args [['reviews', 'slow_loading', 'featurization_0', 'neural_network']] -- repetition 1 of 7
2022-09-24 21:40:54 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-24 21:40:54 INFO  Running instrumented original pipeline...
2022-09-24 21:40:55 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-24 21:40:55 INFO  ---RUNTIME: Importing and monkey-patching took 5.64122200012207 ms
2022-09-24 21:41:04 INFO  ---RUNTIME: Original pipeline execution took 9413.978815078735 ms (excluding imports and monkey-patching)
2022-09-24 21:41:04 INFO  Starting execution of 1 what-if analyses...
2022-09-24 21:41:04 INFO  Start plan generation for analysis PermutationFeatureImportance...
2022-09-24 21:41:04 INFO  ---RUNTIME: Plan generation took 0.20456314086914062 ms
2022-09-24 21:41:04 INFO  Estimated runtime of original DAG is 9134.60397720337ms
2022-09-24 21:41:04 INFO  Performing Multi-Query Optimization
2022-09-24 21:41:04 INFO  Estimated unoptimized what-if runtime is 45673.019886016846ms
2022-09-24 21:41:04 INFO  Estimated optimised what-if runtime is 12590.430974960327ms
2022-09-24 21:41:04 INFO  Estimated optimisation runtime saving is 33082.58891105652ms
2022-09-24 21:41:04 INFO  ---RUNTIME: Multi-Query Optimization took 12.52293586730957 ms
2022-09-24 21:41:04 INFO  Executing generated plans
2022-09-24 21:41:16 INFO  ---RUNTIME: Execution took 12444.969177246094 ms
2022-09-24 21:41:16 INFO  Done!
2022-09-24 21:41:16 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-24 21:41:16 INFO  Running instrumented original pipeline...
2022-09-24 21:41:16 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-24 21:41:16 INFO  ---RUNTIME: Importing and monkey-patching took 7.152795791625977 ms
2022-09-24 21:41:26 INFO  ---RUNTIME: Original pipeline execution took 9870.56040763855 ms (excluding imports and monkey-patching)
2022-09-24 21:41:26 INFO  Starting execution of 1 what-if analyses...
2022-09-24 21:41:26 INFO  Start plan generation for analysis PermutationFeatureImportance...
2022-09-24 21:41:26 INFO  ---RUNTIME: Plan generation took 0.1595020294189453 ms
2022-09-24 21:41:26 INFO  Estimated runtime of original DAG is 9584.50961112976ms
2022-09-24 21:41:26 WARNING Skipping Multi-Query Optimization (instead, only applying patches)
2022-09-24 21:41:26 INFO  Estimated unoptimised what-if runtime is 47922.548055648804ms
2022-09-24 21:41:26 INFO  ---RUNTIME: Multi-Query Optimization took 4.439592361450195 ms
2022-09-24 21:41:26 INFO  Executing generated plans
2022-09-24 21:42:13 INFO  ---RUNTIME: Execution took 46649.311542510986 ms
2022-09-24 21:42:13 INFO  Done!
2022-09-24 21:42:13 INFO  # Finished -- repetition 1 of 7 
2022-09-24 21:42:13 INFO  # Optimization benchmark for feature_importance with args [['reviews', 'slow_loading', 'featurization_0', 'neural_network']] -- repetition 2 of 7
2022-09-24 21:42:13 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-24 21:42:13 INFO  Running instrumented original pipeline...
2022-09-24 21:42:13 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-24 21:42:13 INFO  ---RUNTIME: Importing and monkey-patching took 6.947517395019531 ms
2022-09-24 21:42:23 INFO  ---RUNTIME: Original pipeline execution took 9594.902992248535 ms (excluding imports and monkey-patching)
2022-09-24 21:42:23 INFO  Starting execution of 1 what-if analyses...
2022-09-24 21:42:23 INFO  Start plan generation for analysis PermutationFeatureImportance...
2022-09-24 21:42:23 INFO  ---RUNTIME: Plan generation took 0.10275840759277344 ms
2022-09-24 21:42:23 INFO  Estimated runtime of original DAG is 9310.45389175415ms
2022-09-24 21:42:23 INFO  Performing Multi-Query Optimization
2022-09-24 21:42:23 INFO  Estimated unoptimized what-if runtime is 46552.26945877075ms
2022-09-24 21:42:23 INFO  Estimated optimised what-if runtime is 13363.783836364746ms
2022-09-24 21:42:23 INFO  Estimated optimisation runtime saving is 33188.485622406006ms
2022-09-24 21:42:23 INFO  ---RUNTIME: Multi-Query Optimization took 9.871482849121094 ms
2022-09-24 21:42:23 INFO  Executing generated plans
2022-09-24 21:42:34 INFO  ---RUNTIME: Execution took 11933.478593826294 ms
2022-09-24 21:42:34 INFO  Done!
2022-09-24 21:42:34 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-24 21:42:34 INFO  Running instrumented original pipeline...
2022-09-24 21:42:35 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-24 21:42:35 INFO  ---RUNTIME: Importing and monkey-patching took 6.33692741394043 ms
2022-09-24 21:42:44 INFO  ---RUNTIME: Original pipeline execution took 9391.71838760376 ms (excluding imports and monkey-patching)
2022-09-24 21:42:44 INFO  Starting execution of 1 what-if analyses...
2022-09-24 21:42:44 INFO  Start plan generation for analysis PermutationFeatureImportance...
2022-09-24 21:42:44 INFO  ---RUNTIME: Plan generation took 0.11754035949707031 ms
2022-09-24 21:42:44 INFO  Estimated runtime of original DAG is 9094.117403030396ms
2022-09-24 21:42:44 WARNING Skipping Multi-Query Optimization (instead, only applying patches)
2022-09-24 21:42:44 INFO  Estimated unoptimised what-if runtime is 45470.58701515198ms
2022-09-24 21:42:44 INFO  ---RUNTIME: Multi-Query Optimization took 4.088163375854492 ms
2022-09-24 21:42:44 INFO  Executing generated plans
2022-09-24 21:43:31 INFO  ---RUNTIME: Execution took 47572.84188270569 ms
2022-09-24 21:43:31 INFO  Done!
2022-09-24 21:43:31 INFO  # Finished -- repetition 2 of 7 
2022-09-24 21:43:31 INFO  # Optimization benchmark for feature_importance with args [['reviews', 'slow_loading', 'featurization_0', 'neural_network']] -- repetition 3 of 7
2022-09-24 21:43:31 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-24 21:43:31 INFO  Running instrumented original pipeline...
2022-09-24 21:43:32 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-24 21:43:32 INFO  ---RUNTIME: Importing and monkey-patching took 6.872415542602539 ms
2022-09-24 21:43:41 INFO  ---RUNTIME: Original pipeline execution took 9439.574241638184 ms (excluding imports and monkey-patching)
2022-09-24 21:43:41 INFO  Starting execution of 1 what-if analyses...
2022-09-24 21:43:41 INFO  Start plan generation for analysis PermutationFeatureImportance...
2022-09-24 21:43:41 INFO  ---RUNTIME: Plan generation took 0.1468658447265625 ms
2022-09-24 21:43:41 INFO  Estimated runtime of original DAG is 9149.301290512085ms
2022-09-24 21:43:41 INFO  Performing Multi-Query Optimization
2022-09-24 21:43:41 INFO  Estimated unoptimized what-if runtime is 45746.506452560425ms
2022-09-24 21:43:41 INFO  Estimated optimised what-if runtime is 12385.325193405151ms
2022-09-24 21:43:41 INFO  Estimated optimisation runtime saving is 33361.18125915527ms
2022-09-24 21:43:41 INFO  ---RUNTIME: Multi-Query Optimization took 9.984970092773438 ms
2022-09-24 21:43:41 INFO  Executing generated plans
2022-09-24 21:43:53 INFO  ---RUNTIME: Execution took 12329.792737960815 ms
2022-09-24 21:43:53 INFO  Done!
2022-09-24 21:43:53 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-24 21:43:53 INFO  Running instrumented original pipeline...
2022-09-24 21:43:53 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-24 21:43:53 INFO  ---RUNTIME: Importing and monkey-patching took 6.265163421630859 ms
2022-09-24 21:44:03 INFO  ---RUNTIME: Original pipeline execution took 9596.604108810425 ms (excluding imports and monkey-patching)
2022-09-24 21:44:03 INFO  Starting execution of 1 what-if analyses...
2022-09-24 21:44:03 INFO  Start plan generation for analysis PermutationFeatureImportance...
2022-09-24 21:44:03 INFO  ---RUNTIME: Plan generation took 0.11539459228515625 ms
2022-09-24 21:44:03 INFO  Estimated runtime of original DAG is 9313.937664031982ms
2022-09-24 21:44:03 WARNING Skipping Multi-Query Optimization (instead, only applying patches)
2022-09-24 21:44:03 INFO  Estimated unoptimised what-if runtime is 46569.68832015991ms
2022-09-24 21:44:03 INFO  ---RUNTIME: Multi-Query Optimization took 3.754138946533203 ms
2022-09-24 21:44:03 INFO  Executing generated plans
2022-09-24 21:44:49 INFO  ---RUNTIME: Execution took 46518.24760437012 ms
2022-09-24 21:44:49 INFO  Done!
2022-09-24 21:44:49 INFO  # Finished -- repetition 3 of 7 
2022-09-24 21:44:49 INFO  # Optimization benchmark for feature_importance with args [['reviews', 'slow_loading', 'featurization_0', 'neural_network']] -- repetition 4 of 7
2022-09-24 21:44:49 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-24 21:44:49 INFO  Running instrumented original pipeline...
2022-09-24 21:44:49 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-24 21:44:49 INFO  ---RUNTIME: Importing and monkey-patching took 6.579875946044922 ms
2022-09-24 21:44:59 INFO  ---RUNTIME: Original pipeline execution took 9499.380111694336 ms (excluding imports and monkey-patching)
2022-09-24 21:44:59 INFO  Starting execution of 1 what-if analyses...
2022-09-24 21:44:59 INFO  Start plan generation for analysis PermutationFeatureImportance...
2022-09-24 21:44:59 INFO  ---RUNTIME: Plan generation took 0.12135505676269531 ms
2022-09-24 21:44:59 INFO  Estimated runtime of original DAG is 9199.272394180298ms
2022-09-24 21:44:59 INFO  Performing Multi-Query Optimization
2022-09-24 21:44:59 INFO  Estimated unoptimized what-if runtime is 45996.36197090149ms
2022-09-24 21:44:59 INFO  Estimated optimised what-if runtime is 12123.067855834961ms
2022-09-24 21:44:59 INFO  Estimated optimisation runtime saving is 33873.29411506653ms
2022-09-24 21:44:59 INFO  ---RUNTIME: Multi-Query Optimization took 9.414434432983398 ms
2022-09-24 21:44:59 INFO  Executing generated plans
2022-09-24 21:45:11 INFO  ---RUNTIME: Execution took 12045.847177505493 ms
2022-09-24 21:45:11 INFO  Done!
2022-09-24 21:45:11 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-24 21:45:11 INFO  Running instrumented original pipeline...
2022-09-24 21:45:11 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-24 21:45:11 INFO  ---RUNTIME: Importing and monkey-patching took 6.969928741455078 ms
2022-09-24 21:45:21 INFO  ---RUNTIME: Original pipeline execution took 9704.161643981934 ms (excluding imports and monkey-patching)
2022-09-24 21:45:21 INFO  Starting execution of 1 what-if analyses...
2022-09-24 21:45:21 INFO  Start plan generation for analysis PermutationFeatureImportance...
2022-09-24 21:45:21 INFO  ---RUNTIME: Plan generation took 0.12373924255371094 ms
2022-09-24 21:45:21 INFO  Estimated runtime of original DAG is 9003.647327423096ms
2022-09-24 21:45:21 WARNING Skipping Multi-Query Optimization (instead, only applying patches)
2022-09-24 21:45:21 INFO  Estimated unoptimised what-if runtime is 45018.23663711548ms
2022-09-24 21:45:21 INFO  ---RUNTIME: Multi-Query Optimization took 3.7109851837158203 ms
2022-09-24 21:45:21 INFO  Executing generated plans
2022-09-24 21:46:08 INFO  ---RUNTIME: Execution took 47092.80300140381 ms
2022-09-24 21:46:08 INFO  Done!
2022-09-24 21:46:08 INFO  # Finished -- repetition 4 of 7 
2022-09-24 21:46:08 INFO  # Optimization benchmark for feature_importance with args [['reviews', 'slow_loading', 'featurization_0', 'neural_network']] -- repetition 5 of 7
2022-09-24 21:46:08 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-24 21:46:08 INFO  Running instrumented original pipeline...
2022-09-24 21:46:08 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-24 21:46:08 INFO  ---RUNTIME: Importing and monkey-patching took 7.290363311767578 ms
2022-09-24 21:46:18 INFO  ---RUNTIME: Original pipeline execution took 9850.579023361206 ms (excluding imports and monkey-patching)
2022-09-24 21:46:18 INFO  Starting execution of 1 what-if analyses...
2022-09-24 21:46:18 INFO  Start plan generation for analysis PermutationFeatureImportance...
2022-09-24 21:46:18 INFO  ---RUNTIME: Plan generation took 0.10943412780761719 ms
2022-09-24 21:46:18 INFO  Estimated runtime of original DAG is 9559.97633934021ms
2022-09-24 21:46:18 INFO  Performing Multi-Query Optimization
2022-09-24 21:46:18 INFO  Estimated unoptimized what-if runtime is 47799.88169670105ms
2022-09-24 21:46:18 INFO  Estimated optimised what-if runtime is 12738.720417022705ms
2022-09-24 21:46:18 INFO  Estimated optimisation runtime saving is 35061.161279678345ms
2022-09-24 21:46:18 INFO  ---RUNTIME: Multi-Query Optimization took 11.577367782592773 ms
2022-09-24 21:46:18 INFO  Executing generated plans
2022-09-24 21:46:30 INFO  ---RUNTIME: Execution took 12148.757696151733 ms
2022-09-24 21:46:30 INFO  Done!
2022-09-24 21:46:30 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-24 21:46:30 INFO  Running instrumented original pipeline...
2022-09-24 21:46:30 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-24 21:46:30 INFO  ---RUNTIME: Importing and monkey-patching took 6.236076354980469 ms
2022-09-24 21:46:39 INFO  ---RUNTIME: Original pipeline execution took 9209.913969039917 ms (excluding imports and monkey-patching)
2022-09-24 21:46:39 INFO  Starting execution of 1 what-if analyses...
2022-09-24 21:46:39 INFO  Start plan generation for analysis PermutationFeatureImportance...
2022-09-24 21:46:39 INFO  ---RUNTIME: Plan generation took 0.11777877807617188 ms
2022-09-24 21:46:39 INFO  Estimated runtime of original DAG is 8922.553777694702ms
2022-09-24 21:46:39 WARNING Skipping Multi-Query Optimization (instead, only applying patches)
2022-09-24 21:46:39 INFO  Estimated unoptimised what-if runtime is 44612.76888847351ms
2022-09-24 21:46:39 INFO  ---RUNTIME: Multi-Query Optimization took 3.7260055541992188 ms
2022-09-24 21:46:39 INFO  Executing generated plans
2022-09-24 21:47:26 INFO  ---RUNTIME: Execution took 46666.92924499512 ms
2022-09-24 21:47:26 INFO  Done!
2022-09-24 21:47:26 INFO  # Finished -- repetition 5 of 7 
2022-09-24 21:47:26 INFO  # Optimization benchmark for feature_importance with args [['reviews', 'slow_loading', 'featurization_0', 'neural_network']] -- repetition 6 of 7
2022-09-24 21:47:26 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-24 21:47:26 INFO  Running instrumented original pipeline...
2022-09-24 21:47:26 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-24 21:47:26 INFO  ---RUNTIME: Importing and monkey-patching took 6.17218017578125 ms
2022-09-24 21:47:35 INFO  ---RUNTIME: Original pipeline execution took 9405.989408493042 ms (excluding imports and monkey-patching)
2022-09-24 21:47:35 INFO  Starting execution of 1 what-if analyses...
2022-09-24 21:47:35 INFO  Start plan generation for analysis PermutationFeatureImportance...
2022-09-24 21:47:35 INFO  ---RUNTIME: Plan generation took 0.10347366333007812 ms
2022-09-24 21:47:35 INFO  Estimated runtime of original DAG is 9106.668710708618ms
2022-09-24 21:47:35 INFO  Performing Multi-Query Optimization
2022-09-24 21:47:35 INFO  Estimated unoptimized what-if runtime is 45533.34355354309ms
2022-09-24 21:47:35 INFO  Estimated optimised what-if runtime is 12012.953758239746ms
2022-09-24 21:47:35 INFO  Estimated optimisation runtime saving is 33520.389795303345ms
2022-09-24 21:47:35 INFO  ---RUNTIME: Multi-Query Optimization took 9.27734375 ms
2022-09-24 21:47:35 INFO  Executing generated plans
2022-09-24 21:47:47 INFO  ---RUNTIME: Execution took 12044.696569442749 ms
2022-09-24 21:47:47 INFO  Done!
2022-09-24 21:47:47 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-24 21:47:47 INFO  Running instrumented original pipeline...
2022-09-24 21:47:47 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-24 21:47:47 INFO  ---RUNTIME: Importing and monkey-patching took 6.53386116027832 ms
2022-09-24 21:47:57 INFO  ---RUNTIME: Original pipeline execution took 9815.263986587524 ms (excluding imports and monkey-patching)
2022-09-24 21:47:57 INFO  Starting execution of 1 what-if analyses...
2022-09-24 21:47:57 INFO  Start plan generation for analysis PermutationFeatureImportance...
2022-09-24 21:47:57 INFO  ---RUNTIME: Plan generation took 0.12230873107910156 ms
2022-09-24 21:47:57 INFO  Estimated runtime of original DAG is 9526.334285736084ms
2022-09-24 21:47:57 WARNING Skipping Multi-Query Optimization (instead, only applying patches)
2022-09-24 21:47:57 INFO  Estimated unoptimised what-if runtime is 47631.67142868042ms
2022-09-24 21:47:57 INFO  ---RUNTIME: Multi-Query Optimization took 6.232261657714844 ms
2022-09-24 21:47:57 INFO  Executing generated plans
2022-09-24 21:48:45 INFO  ---RUNTIME: Execution took 47769.56248283386 ms
2022-09-24 21:48:45 INFO  Done!
2022-09-24 21:48:45 INFO  # Finished -- repetition 6 of 7 
2022-09-24 21:48:45 INFO  # Optimization benchmark for feature_importance with args [['reviews', 'slow_loading', 'featurization_0', 'neural_network']] -- repetition 7 of 7
2022-09-24 21:48:45 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-24 21:48:45 INFO  Running instrumented original pipeline...
2022-09-24 21:48:45 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-24 21:48:45 INFO  ---RUNTIME: Importing and monkey-patching took 6.392002105712891 ms
2022-09-24 21:48:54 INFO  ---RUNTIME: Original pipeline execution took 9043.286085128784 ms (excluding imports and monkey-patching)
2022-09-24 21:48:54 INFO  Starting execution of 1 what-if analyses...
2022-09-24 21:48:54 INFO  Start plan generation for analysis PermutationFeatureImportance...
2022-09-24 21:48:54 INFO  ---RUNTIME: Plan generation took 0.10132789611816406 ms
2022-09-24 21:48:54 INFO  Estimated runtime of original DAG is 8759.839057922363ms
2022-09-24 21:48:54 INFO  Performing Multi-Query Optimization
2022-09-24 21:48:54 INFO  Estimated unoptimized what-if runtime is 43799.19528961182ms
2022-09-24 21:48:54 INFO  Estimated optimised what-if runtime is 11601.888418197632ms
2022-09-24 21:48:54 INFO  Estimated optimisation runtime saving is 32197.306871414185ms
2022-09-24 21:48:54 INFO  ---RUNTIME: Multi-Query Optimization took 9.226560592651367 ms
2022-09-24 21:48:54 INFO  Executing generated plans
2022-09-24 21:49:06 INFO  ---RUNTIME: Execution took 11851.453065872192 ms
2022-09-24 21:49:06 INFO  Done!
2022-09-24 21:49:06 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-24 21:49:06 INFO  Running instrumented original pipeline...
2022-09-24 21:49:06 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-24 21:49:06 INFO  ---RUNTIME: Importing and monkey-patching took 6.273746490478516 ms
2022-09-24 21:49:15 INFO  ---RUNTIME: Original pipeline execution took 9604.6621799469 ms (excluding imports and monkey-patching)
2022-09-24 21:49:15 INFO  Starting execution of 1 what-if analyses...
2022-09-24 21:49:15 INFO  Start plan generation for analysis PermutationFeatureImportance...
2022-09-24 21:49:15 INFO  ---RUNTIME: Plan generation took 0.11539459228515625 ms
2022-09-24 21:49:15 INFO  Estimated runtime of original DAG is 9321.160078048706ms
2022-09-24 21:49:15 WARNING Skipping Multi-Query Optimization (instead, only applying patches)
2022-09-24 21:49:15 INFO  Estimated unoptimised what-if runtime is 46605.80039024353ms
2022-09-24 21:49:15 INFO  ---RUNTIME: Multi-Query Optimization took 3.804445266723633 ms
2022-09-24 21:49:15 INFO  Executing generated plans
2022-09-24 21:50:00 INFO  ---RUNTIME: Execution took 44916.14890098572 ms
2022-09-24 21:50:00 INFO  Done!
2022-09-24 21:50:00 INFO  # Finished -- repetition 7 of 7 
2022-09-24 21:50:00 INFO  # Final results after all repetitions
2022-09-24 21:50:00 INFO     repetition  ... no_opt_what_if_execution_combined_model_training
0           0  ...                                     16934.651852
1           1  ...                                     17965.916395
2           2  ...                                     16336.693287
3           3  ...                                     17975.550652
4           4  ...                                     16767.031431
5           5  ...                                     17723.904133
6           6  ...                                     15962.763548

[7 rows x 26 columns]
PROTOCOL_BUFFERS_PYTHON_IMPLEMENTATION=python taskset -c 32-39 python3.9 benchmarks_end_to_end.py feature_importance reviews slow_loading featurization_1 logistic_regression
2022-09-24 21:50:03.257415: W tensorflow/stream_executor/platform/default/dso_loader.cc:64] Could not load dynamic library 'libcudart.so.11.0'; dlerror: libcudart.so.11.0: cannot open shared object file: No such file or directory; LD_LIBRARY_PATH: /home/sgrafbe/mlwhatif/venv/lib/python3.9/site-packages/cv2/../../lib64:
2022-09-24 21:50:03.257460: I tensorflow/stream_executor/cuda/cudart_stub.cc:29] Ignore above cudart dlerror if you do not have a GPU set up on your machine.
2022-09-24 21:50:04 INFO  Patching sys.argv with ['mlwhatif', 'reviews', 'slow_loading', 'featurization_1', 'logistic_regression']
2022-09-24 21:50:04 INFO  Running instrumented original pipeline...
2022-09-24 21:50:04 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-24 21:50:04 INFO  ---RUNTIME: Importing and monkey-patching took 95.91841697692871 ms
2022-09-24 21:50:10 INFO  ---RUNTIME: Original pipeline execution took 5806.441307067871 ms (excluding imports and monkey-patching)
2022-09-24 21:50:10 INFO  Starting execution of 0 what-if analyses...
2022-09-24 21:50:10 INFO  Estimated runtime of original DAG is 5466.729402542114ms
2022-09-24 21:50:10 INFO  Performing Multi-Query Optimization
2022-09-24 21:50:10 INFO  Estimated unoptimized what-if runtime is 0ms
2022-09-24 21:50:10 INFO  Estimated optimised what-if runtime is 0ms
2022-09-24 21:50:10 INFO  Estimated optimisation runtime saving is 0ms
2022-09-24 21:50:10 INFO  ---RUNTIME: Multi-Query Optimization took 0.568389892578125 ms
2022-09-24 21:50:10 INFO  Executing generated plans
2022-09-24 21:50:10 INFO  ---RUNTIME: Execution took 0.03147125244140625 ms
2022-09-24 21:50:10 INFO  Done!
2022-09-24 21:50:10 INFO  # Optimization benchmark for feature_importance with args [['reviews', 'slow_loading', 'featurization_1', 'logistic_regression']] -- repetition 1 of 7
2022-09-24 21:50:10 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-24 21:50:10 INFO  Running instrumented original pipeline...
2022-09-24 21:50:10 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-24 21:50:10 INFO  ---RUNTIME: Importing and monkey-patching took 5.67936897277832 ms
2022-09-24 21:50:16 INFO  ---RUNTIME: Original pipeline execution took 5686.027526855469 ms (excluding imports and monkey-patching)
2022-09-24 21:50:16 INFO  Starting execution of 1 what-if analyses...
2022-09-24 21:50:16 INFO  Start plan generation for analysis PermutationFeatureImportance...
2022-09-24 21:50:16 INFO  ---RUNTIME: Plan generation took 0.2193450927734375 ms
2022-09-24 21:50:16 INFO  Estimated runtime of original DAG is 5387.430667877197ms
2022-09-24 21:50:16 INFO  Performing Multi-Query Optimization
2022-09-24 21:50:16 INFO  Estimated unoptimized what-if runtime is 26937.153339385986ms
2022-09-24 21:50:16 INFO  Estimated optimised what-if runtime is 6762.895107269287ms
2022-09-24 21:50:16 INFO  Estimated optimisation runtime saving is 20174.2582321167ms
2022-09-24 21:50:16 INFO  ---RUNTIME: Multi-Query Optimization took 10.546207427978516 ms
2022-09-24 21:50:16 INFO  Executing generated plans
2022-09-24 21:50:23 INFO  ---RUNTIME: Execution took 6952.9993534088135 ms
2022-09-24 21:50:23 INFO  Done!
2022-09-24 21:50:23 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-24 21:50:23 INFO  Running instrumented original pipeline...
2022-09-24 21:50:23 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-24 21:50:23 INFO  ---RUNTIME: Importing and monkey-patching took 5.993366241455078 ms
2022-09-24 21:50:28 INFO  ---RUNTIME: Original pipeline execution took 5891.212463378906 ms (excluding imports and monkey-patching)
2022-09-24 21:50:28 INFO  Starting execution of 1 what-if analyses...
2022-09-24 21:50:28 INFO  Start plan generation for analysis PermutationFeatureImportance...
2022-09-24 21:50:28 INFO  ---RUNTIME: Plan generation took 0.13780593872070312 ms
2022-09-24 21:50:28 INFO  Estimated runtime of original DAG is 5421.283960342407ms
2022-09-24 21:50:28 WARNING Skipping Multi-Query Optimization (instead, only applying patches)
2022-09-24 21:50:28 INFO  Estimated unoptimised what-if runtime is 27106.419801712036ms
2022-09-24 21:50:28 INFO  ---RUNTIME: Multi-Query Optimization took 4.944324493408203 ms
2022-09-24 21:50:28 INFO  Executing generated plans
2022-09-24 21:50:56 INFO  ---RUNTIME: Execution took 27280.909538269043 ms
2022-09-24 21:50:56 INFO  Done!
2022-09-24 21:50:56 INFO  # Finished -- repetition 1 of 7 
2022-09-24 21:50:56 INFO  # Optimization benchmark for feature_importance with args [['reviews', 'slow_loading', 'featurization_1', 'logistic_regression']] -- repetition 2 of 7
2022-09-24 21:50:56 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-24 21:50:56 INFO  Running instrumented original pipeline...
2022-09-24 21:50:56 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-24 21:50:56 INFO  ---RUNTIME: Importing and monkey-patching took 6.627798080444336 ms
2022-09-24 21:51:02 INFO  ---RUNTIME: Original pipeline execution took 5768.442392349243 ms (excluding imports and monkey-patching)
2022-09-24 21:51:02 INFO  Starting execution of 1 what-if analyses...
2022-09-24 21:51:02 INFO  Start plan generation for analysis PermutationFeatureImportance...
2022-09-24 21:51:02 INFO  ---RUNTIME: Plan generation took 0.1430511474609375 ms
2022-09-24 21:51:02 INFO  Estimated runtime of original DAG is 5448.340654373169ms
2022-09-24 21:51:02 INFO  Performing Multi-Query Optimization
2022-09-24 21:51:02 INFO  Estimated unoptimized what-if runtime is 27241.703271865845ms
2022-09-24 21:51:02 INFO  Estimated optimised what-if runtime is 6817.789554595947ms
2022-09-24 21:51:02 INFO  Estimated optimisation runtime saving is 20423.913717269897ms
2022-09-24 21:51:02 INFO  ---RUNTIME: Multi-Query Optimization took 10.236740112304688 ms
2022-09-24 21:51:02 INFO  Executing generated plans
2022-09-24 21:51:08 INFO  ---RUNTIME: Execution took 6820.500373840332 ms
2022-09-24 21:51:08 INFO  Done!
2022-09-24 21:51:08 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-24 21:51:08 INFO  Running instrumented original pipeline...
2022-09-24 21:51:08 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-24 21:51:08 INFO  ---RUNTIME: Importing and monkey-patching took 12.387990951538086 ms
2022-09-24 21:51:14 INFO  ---RUNTIME: Original pipeline execution took 5715.354442596436 ms (excluding imports and monkey-patching)
2022-09-24 21:51:14 INFO  Starting execution of 1 what-if analyses...
2022-09-24 21:51:14 INFO  Start plan generation for analysis PermutationFeatureImportance...
2022-09-24 21:51:14 INFO  ---RUNTIME: Plan generation took 0.10561943054199219 ms
2022-09-24 21:51:14 INFO  Estimated runtime of original DAG is 5395.0300216674805ms
2022-09-24 21:51:14 WARNING Skipping Multi-Query Optimization (instead, only applying patches)
2022-09-24 21:51:14 INFO  Estimated unoptimised what-if runtime is 26975.150108337402ms
2022-09-24 21:51:14 INFO  ---RUNTIME: Multi-Query Optimization took 3.9625167846679688 ms
2022-09-24 21:51:14 INFO  Executing generated plans
2022-09-24 21:51:42 INFO  ---RUNTIME: Execution took 27404.606819152832 ms
2022-09-24 21:51:42 INFO  Done!
2022-09-24 21:51:42 INFO  # Finished -- repetition 2 of 7 
2022-09-24 21:51:42 INFO  # Optimization benchmark for feature_importance with args [['reviews', 'slow_loading', 'featurization_1', 'logistic_regression']] -- repetition 3 of 7
2022-09-24 21:51:42 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-24 21:51:42 INFO  Running instrumented original pipeline...
2022-09-24 21:51:42 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-24 21:51:42 INFO  ---RUNTIME: Importing and monkey-patching took 6.487369537353516 ms
2022-09-24 21:51:47 INFO  ---RUNTIME: Original pipeline execution took 5872.522354125977 ms (excluding imports and monkey-patching)
2022-09-24 21:51:47 INFO  Starting execution of 1 what-if analyses...
2022-09-24 21:51:47 INFO  Start plan generation for analysis PermutationFeatureImportance...
2022-09-24 21:51:47 INFO  ---RUNTIME: Plan generation took 0.12683868408203125 ms
2022-09-24 21:51:47 INFO  Estimated runtime of original DAG is 5576.058387756348ms
2022-09-24 21:51:47 INFO  Performing Multi-Query Optimization
2022-09-24 21:51:47 INFO  Estimated unoptimized what-if runtime is 27880.29193878174ms
2022-09-24 21:51:47 INFO  Estimated optimised what-if runtime is 6945.928573608398ms
2022-09-24 21:51:47 INFO  Estimated optimisation runtime saving is 20934.36336517334ms
2022-09-24 21:51:47 INFO  ---RUNTIME: Multi-Query Optimization took 10.796785354614258 ms
2022-09-24 21:51:47 INFO  Executing generated plans
2022-09-24 21:51:54 INFO  ---RUNTIME: Execution took 6887.461185455322 ms
2022-09-24 21:51:54 INFO  Done!
2022-09-24 21:51:54 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-24 21:51:54 INFO  Running instrumented original pipeline...
2022-09-24 21:51:54 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-24 21:51:54 INFO  ---RUNTIME: Importing and monkey-patching took 6.09135627746582 ms
2022-09-24 21:52:00 INFO  ---RUNTIME: Original pipeline execution took 5735.584735870361 ms (excluding imports and monkey-patching)
2022-09-24 21:52:00 INFO  Starting execution of 1 what-if analyses...
2022-09-24 21:52:00 INFO  Start plan generation for analysis PermutationFeatureImportance...
2022-09-24 21:52:00 INFO  ---RUNTIME: Plan generation took 0.09679794311523438 ms
2022-09-24 21:52:00 INFO  Estimated runtime of original DAG is 5438.701629638672ms
2022-09-24 21:52:00 WARNING Skipping Multi-Query Optimization (instead, only applying patches)
2022-09-24 21:52:00 INFO  Estimated unoptimised what-if runtime is 27193.50814819336ms
2022-09-24 21:52:00 INFO  ---RUNTIME: Multi-Query Optimization took 3.9234161376953125 ms
2022-09-24 21:52:00 INFO  Executing generated plans
2022-09-24 21:52:28 INFO  ---RUNTIME: Execution took 27612.73145675659 ms
2022-09-24 21:52:28 INFO  Done!
2022-09-24 21:52:28 INFO  # Finished -- repetition 3 of 7 
2022-09-24 21:52:28 INFO  # Optimization benchmark for feature_importance with args [['reviews', 'slow_loading', 'featurization_1', 'logistic_regression']] -- repetition 4 of 7
2022-09-24 21:52:28 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-24 21:52:28 INFO  Running instrumented original pipeline...
2022-09-24 21:52:28 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-24 21:52:28 INFO  ---RUNTIME: Importing and monkey-patching took 6.664752960205078 ms
2022-09-24 21:52:33 INFO  ---RUNTIME: Original pipeline execution took 5736.178636550903 ms (excluding imports and monkey-patching)
2022-09-24 21:52:33 INFO  Starting execution of 1 what-if analyses...
2022-09-24 21:52:33 INFO  Start plan generation for analysis PermutationFeatureImportance...
2022-09-24 21:52:33 INFO  ---RUNTIME: Plan generation took 0.12540817260742188 ms
2022-09-24 21:52:33 INFO  Estimated runtime of original DAG is 5437.854290008545ms
2022-09-24 21:52:33 INFO  Performing Multi-Query Optimization
2022-09-24 21:52:33 INFO  Estimated unoptimized what-if runtime is 27189.271450042725ms
2022-09-24 21:52:33 INFO  Estimated optimised what-if runtime is 6822.065114974976ms
2022-09-24 21:52:33 INFO  Estimated optimisation runtime saving is 20367.20633506775ms
2022-09-24 21:52:33 INFO  ---RUNTIME: Multi-Query Optimization took 11.554956436157227 ms
2022-09-24 21:52:33 INFO  Executing generated plans
2022-09-24 21:52:40 INFO  ---RUNTIME: Execution took 6836.910009384155 ms
2022-09-24 21:52:40 INFO  Done!
2022-09-24 21:52:40 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-24 21:52:40 INFO  Running instrumented original pipeline...
2022-09-24 21:52:40 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-24 21:52:40 INFO  ---RUNTIME: Importing and monkey-patching took 6.1244964599609375 ms
2022-09-24 21:52:46 INFO  ---RUNTIME: Original pipeline execution took 5770.594358444214 ms (excluding imports and monkey-patching)
2022-09-24 21:52:46 INFO  Starting execution of 1 what-if analyses...
2022-09-24 21:52:46 INFO  Start plan generation for analysis PermutationFeatureImportance...
2022-09-24 21:52:46 INFO  ---RUNTIME: Plan generation took 0.12469291687011719 ms
2022-09-24 21:52:46 INFO  Estimated runtime of original DAG is 5451.977968215942ms
2022-09-24 21:52:46 WARNING Skipping Multi-Query Optimization (instead, only applying patches)
2022-09-24 21:52:46 INFO  Estimated unoptimised what-if runtime is 27259.889841079712ms
2022-09-24 21:52:46 INFO  ---RUNTIME: Multi-Query Optimization took 4.00090217590332 ms
2022-09-24 21:52:46 INFO  Executing generated plans
2022-09-24 21:53:14 INFO  ---RUNTIME: Execution took 27529.371738433838 ms
2022-09-24 21:53:14 INFO  Done!
2022-09-24 21:53:14 INFO  # Finished -- repetition 4 of 7 
2022-09-24 21:53:14 INFO  # Optimization benchmark for feature_importance with args [['reviews', 'slow_loading', 'featurization_1', 'logistic_regression']] -- repetition 5 of 7
2022-09-24 21:53:14 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-24 21:53:14 INFO  Running instrumented original pipeline...
2022-09-24 21:53:14 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-24 21:53:14 INFO  ---RUNTIME: Importing and monkey-patching took 6.324529647827148 ms
2022-09-24 21:53:20 INFO  ---RUNTIME: Original pipeline execution took 6022.395133972168 ms (excluding imports and monkey-patching)
2022-09-24 21:53:20 INFO  Starting execution of 1 what-if analyses...
2022-09-24 21:53:20 INFO  Start plan generation for analysis PermutationFeatureImportance...
2022-09-24 21:53:20 INFO  ---RUNTIME: Plan generation took 0.10514259338378906 ms
2022-09-24 21:53:20 INFO  Estimated runtime of original DAG is 5690.870761871338ms
2022-09-24 21:53:20 INFO  Performing Multi-Query Optimization
2022-09-24 21:53:20 INFO  Estimated unoptimized what-if runtime is 28454.35380935669ms
2022-09-24 21:53:20 INFO  Estimated optimised what-if runtime is 7074.791193008423ms
2022-09-24 21:53:20 INFO  Estimated optimisation runtime saving is 21379.562616348267ms
2022-09-24 21:53:20 INFO  ---RUNTIME: Multi-Query Optimization took 9.98830795288086 ms
2022-09-24 21:53:20 INFO  Executing generated plans
2022-09-24 21:53:27 INFO  ---RUNTIME: Execution took 6848.490953445435 ms
2022-09-24 21:53:27 INFO  Done!
2022-09-24 21:53:27 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-24 21:53:27 INFO  Running instrumented original pipeline...
2022-09-24 21:53:27 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-24 21:53:27 INFO  ---RUNTIME: Importing and monkey-patching took 5.97834587097168 ms
2022-09-24 21:53:32 INFO  ---RUNTIME: Original pipeline execution took 5700.591325759888 ms (excluding imports and monkey-patching)
2022-09-24 21:53:32 INFO  Starting execution of 1 what-if analyses...
2022-09-24 21:53:32 INFO  Start plan generation for analysis PermutationFeatureImportance...
2022-09-24 21:53:32 INFO  ---RUNTIME: Plan generation took 0.10085105895996094 ms
2022-09-24 21:53:32 INFO  Estimated runtime of original DAG is 5402.7650356292725ms
2022-09-24 21:53:32 WARNING Skipping Multi-Query Optimization (instead, only applying patches)
2022-09-24 21:53:32 INFO  Estimated unoptimised what-if runtime is 27013.825178146362ms
2022-09-24 21:53:32 INFO  ---RUNTIME: Multi-Query Optimization took 4.926443099975586 ms
2022-09-24 21:53:32 INFO  Executing generated plans
2022-09-24 21:54:00 INFO  ---RUNTIME: Execution took 27360.60070991516 ms
2022-09-24 21:54:00 INFO  Done!
2022-09-24 21:54:00 INFO  # Finished -- repetition 5 of 7 
2022-09-24 21:54:00 INFO  # Optimization benchmark for feature_importance with args [['reviews', 'slow_loading', 'featurization_1', 'logistic_regression']] -- repetition 6 of 7
2022-09-24 21:54:00 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-24 21:54:00 INFO  Running instrumented original pipeline...
2022-09-24 21:54:00 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-24 21:54:00 INFO  ---RUNTIME: Importing and monkey-patching took 6.596565246582031 ms
2022-09-24 21:54:05 INFO  ---RUNTIME: Original pipeline execution took 5760.918378829956 ms (excluding imports and monkey-patching)
2022-09-24 21:54:05 INFO  Starting execution of 1 what-if analyses...
2022-09-24 21:54:05 INFO  Start plan generation for analysis PermutationFeatureImportance...
2022-09-24 21:54:05 INFO  ---RUNTIME: Plan generation took 0.1418590545654297 ms
2022-09-24 21:54:05 INFO  Estimated runtime of original DAG is 5422.819375991821ms
2022-09-24 21:54:05 INFO  Performing Multi-Query Optimization
2022-09-24 21:54:05 INFO  Estimated unoptimized what-if runtime is 27114.096879959106ms
2022-09-24 21:54:05 INFO  Estimated optimised what-if runtime is 6827.8467655181885ms
2022-09-24 21:54:05 INFO  Estimated optimisation runtime saving is 20286.250114440918ms
2022-09-24 21:54:05 INFO  ---RUNTIME: Multi-Query Optimization took 21.20494842529297 ms
2022-09-24 21:54:05 INFO  Executing generated plans
2022-09-24 21:54:12 INFO  ---RUNTIME: Execution took 6870.436906814575 ms
2022-09-24 21:54:12 INFO  Done!
2022-09-24 21:54:12 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-24 21:54:12 INFO  Running instrumented original pipeline...
2022-09-24 21:54:12 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-24 21:54:12 INFO  ---RUNTIME: Importing and monkey-patching took 6.182670593261719 ms
2022-09-24 21:54:18 INFO  ---RUNTIME: Original pipeline execution took 5757.196664810181 ms (excluding imports and monkey-patching)
2022-09-24 21:54:18 INFO  Starting execution of 1 what-if analyses...
2022-09-24 21:54:18 INFO  Start plan generation for analysis PermutationFeatureImportance...
2022-09-24 21:54:18 INFO  ---RUNTIME: Plan generation took 0.10395050048828125 ms
2022-09-24 21:54:18 INFO  Estimated runtime of original DAG is 5458.323001861572ms
2022-09-24 21:54:18 WARNING Skipping Multi-Query Optimization (instead, only applying patches)
2022-09-24 21:54:18 INFO  Estimated unoptimised what-if runtime is 27291.61500930786ms
2022-09-24 21:54:18 INFO  ---RUNTIME: Multi-Query Optimization took 4.004240036010742 ms
2022-09-24 21:54:18 INFO  Executing generated plans
2022-09-24 21:54:46 INFO  ---RUNTIME: Execution took 27459.765911102295 ms
2022-09-24 21:54:46 INFO  Done!
2022-09-24 21:54:46 INFO  # Finished -- repetition 6 of 7 
2022-09-24 21:54:46 INFO  # Optimization benchmark for feature_importance with args [['reviews', 'slow_loading', 'featurization_1', 'logistic_regression']] -- repetition 7 of 7
2022-09-24 21:54:46 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-24 21:54:46 INFO  Running instrumented original pipeline...
2022-09-24 21:54:46 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-24 21:54:46 INFO  ---RUNTIME: Importing and monkey-patching took 6.499528884887695 ms
2022-09-24 21:54:51 INFO  ---RUNTIME: Original pipeline execution took 5777.578115463257 ms (excluding imports and monkey-patching)
2022-09-24 21:54:51 INFO  Starting execution of 1 what-if analyses...
2022-09-24 21:54:51 INFO  Start plan generation for analysis PermutationFeatureImportance...
2022-09-24 21:54:51 INFO  ---RUNTIME: Plan generation took 0.12540817260742188 ms
2022-09-24 21:54:51 INFO  Estimated runtime of original DAG is 5477.622032165527ms
2022-09-24 21:54:51 INFO  Performing Multi-Query Optimization
2022-09-24 21:54:51 INFO  Estimated unoptimized what-if runtime is 27388.110160827637ms
2022-09-24 21:54:51 INFO  Estimated optimised what-if runtime is 6848.651885986328ms
2022-09-24 21:54:51 INFO  Estimated optimisation runtime saving is 20539.45827484131ms
2022-09-24 21:54:51 INFO  ---RUNTIME: Multi-Query Optimization took 10.827064514160156 ms
2022-09-24 21:54:51 INFO  Executing generated plans
2022-09-24 21:54:58 INFO  ---RUNTIME: Execution took 6882.933855056763 ms
2022-09-24 21:54:58 INFO  Done!
2022-09-24 21:54:58 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-24 21:54:58 INFO  Running instrumented original pipeline...
2022-09-24 21:54:58 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-24 21:54:58 INFO  ---RUNTIME: Importing and monkey-patching took 16.460657119750977 ms
2022-09-24 21:55:04 INFO  ---RUNTIME: Original pipeline execution took 5798.054456710815 ms (excluding imports and monkey-patching)
2022-09-24 21:55:04 INFO  Starting execution of 1 what-if analyses...
2022-09-24 21:55:04 INFO  Start plan generation for analysis PermutationFeatureImportance...
2022-09-24 21:55:04 INFO  ---RUNTIME: Plan generation took 0.10657310485839844 ms
2022-09-24 21:55:04 INFO  Estimated runtime of original DAG is 5500.974416732788ms
2022-09-24 21:55:04 WARNING Skipping Multi-Query Optimization (instead, only applying patches)
2022-09-24 21:55:04 INFO  Estimated unoptimised what-if runtime is 27504.87208366394ms
2022-09-24 21:55:04 INFO  ---RUNTIME: Multi-Query Optimization took 3.9720535278320312 ms
2022-09-24 21:55:04 INFO  Executing generated plans
2022-09-24 21:55:32 INFO  ---RUNTIME: Execution took 27547.65558242798 ms
2022-09-24 21:55:32 INFO  Done!
2022-09-24 21:55:32 INFO  # Finished -- repetition 7 of 7 
2022-09-24 21:55:32 INFO  # Final results after all repetitions
2022-09-24 21:55:32 INFO     repetition  ... no_opt_what_if_execution_combined_model_training
0           0  ...                                       592.912436
1           1  ...                                       592.531681
2           2  ...                                       604.070663
3           3  ...                                       588.134289
4           4  ...                                       592.454672
5           5  ...                                       601.965427
6           6  ...                                       599.610567

[7 rows x 26 columns]
PROTOCOL_BUFFERS_PYTHON_IMPLEMENTATION=python taskset -c 32-39 python3.9 benchmarks_end_to_end.py feature_importance reviews slow_loading featurization_1 xgboost
2022-09-24 21:55:34.368981: W tensorflow/stream_executor/platform/default/dso_loader.cc:64] Could not load dynamic library 'libcudart.so.11.0'; dlerror: libcudart.so.11.0: cannot open shared object file: No such file or directory; LD_LIBRARY_PATH: /home/sgrafbe/mlwhatif/venv/lib/python3.9/site-packages/cv2/../../lib64:
2022-09-24 21:55:34.369027: I tensorflow/stream_executor/cuda/cudart_stub.cc:29] Ignore above cudart dlerror if you do not have a GPU set up on your machine.
2022-09-24 21:55:35 INFO  Patching sys.argv with ['mlwhatif', 'reviews', 'slow_loading', 'featurization_1', 'xgboost']
2022-09-24 21:55:35 INFO  Running instrumented original pipeline...
2022-09-24 21:55:35 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-24 21:55:35 INFO  ---RUNTIME: Importing and monkey-patching took 96.08793258666992 ms
2022-09-24 21:55:44 INFO  ---RUNTIME: Original pipeline execution took 8505.263090133667 ms (excluding imports and monkey-patching)
2022-09-24 21:55:44 INFO  Starting execution of 0 what-if analyses...
2022-09-24 21:55:44 INFO  Estimated runtime of original DAG is 8184.609651565552ms
2022-09-24 21:55:44 INFO  Performing Multi-Query Optimization
2022-09-24 21:55:44 INFO  Estimated unoptimized what-if runtime is 0ms
2022-09-24 21:55:44 INFO  Estimated optimised what-if runtime is 0ms
2022-09-24 21:55:44 INFO  Estimated optimisation runtime saving is 0ms
2022-09-24 21:55:44 INFO  ---RUNTIME: Multi-Query Optimization took 0.5273818969726562 ms
2022-09-24 21:55:44 INFO  Executing generated plans
2022-09-24 21:55:44 INFO  ---RUNTIME: Execution took 0.024080276489257812 ms
2022-09-24 21:55:44 INFO  Done!
2022-09-24 21:55:44 INFO  # Optimization benchmark for feature_importance with args [['reviews', 'slow_loading', 'featurization_1', 'xgboost']] -- repetition 1 of 7
2022-09-24 21:55:44 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-24 21:55:44 INFO  Running instrumented original pipeline...
2022-09-24 21:55:44 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-24 21:55:44 INFO  ---RUNTIME: Importing and monkey-patching took 5.752801895141602 ms
2022-09-24 21:55:52 INFO  ---RUNTIME: Original pipeline execution took 8394.552946090698 ms (excluding imports and monkey-patching)
2022-09-24 21:55:52 INFO  Starting execution of 1 what-if analyses...
2022-09-24 21:55:52 INFO  Start plan generation for analysis PermutationFeatureImportance...
2022-09-24 21:55:52 INFO  ---RUNTIME: Plan generation took 0.19288063049316406 ms
2022-09-24 21:55:52 INFO  Estimated runtime of original DAG is 8100.775718688965ms
2022-09-24 21:55:52 INFO  Performing Multi-Query Optimization
2022-09-24 21:55:52 INFO  Estimated unoptimized what-if runtime is 40503.878593444824ms
2022-09-24 21:55:52 INFO  Estimated optimised what-if runtime is 10671.96798324585ms
2022-09-24 21:55:52 INFO  Estimated optimisation runtime saving is 29831.910610198975ms
2022-09-24 21:55:52 INFO  ---RUNTIME: Multi-Query Optimization took 10.136127471923828 ms
2022-09-24 21:55:52 INFO  Executing generated plans
2022-09-24 21:56:03 INFO  ---RUNTIME: Execution took 10811.142444610596 ms
2022-09-24 21:56:03 INFO  Done!
2022-09-24 21:56:03 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-24 21:56:03 INFO  Running instrumented original pipeline...
2022-09-24 21:56:03 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-24 21:56:03 INFO  ---RUNTIME: Importing and monkey-patching took 6.131887435913086 ms
2022-09-24 21:56:12 INFO  ---RUNTIME: Original pipeline execution took 8659.265279769897 ms (excluding imports and monkey-patching)
2022-09-24 21:56:12 INFO  Starting execution of 1 what-if analyses...
2022-09-24 21:56:12 INFO  Start plan generation for analysis PermutationFeatureImportance...
2022-09-24 21:56:12 INFO  ---RUNTIME: Plan generation took 0.1087188720703125 ms
2022-09-24 21:56:12 INFO  Estimated runtime of original DAG is 8183.279514312744ms
2022-09-24 21:56:12 WARNING Skipping Multi-Query Optimization (instead, only applying patches)
2022-09-24 21:56:12 INFO  Estimated unoptimised what-if runtime is 40916.39757156372ms
2022-09-24 21:56:12 INFO  ---RUNTIME: Multi-Query Optimization took 4.229307174682617 ms
2022-09-24 21:56:12 INFO  Executing generated plans
2022-09-24 21:56:53 INFO  ---RUNTIME: Execution took 41026.34644508362 ms
2022-09-24 21:56:53 INFO  Done!
2022-09-24 21:56:53 INFO  # Finished -- repetition 1 of 7 
2022-09-24 21:56:53 INFO  # Optimization benchmark for feature_importance with args [['reviews', 'slow_loading', 'featurization_1', 'xgboost']] -- repetition 2 of 7
2022-09-24 21:56:53 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-24 21:56:53 INFO  Running instrumented original pipeline...
2022-09-24 21:56:53 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-24 21:56:53 INFO  ---RUNTIME: Importing and monkey-patching took 6.625890731811523 ms
2022-09-24 21:57:01 INFO  ---RUNTIME: Original pipeline execution took 8462.984800338745 ms (excluding imports and monkey-patching)
2022-09-24 21:57:01 INFO  Starting execution of 1 what-if analyses...
2022-09-24 21:57:01 INFO  Start plan generation for analysis PermutationFeatureImportance...
2022-09-24 21:57:01 INFO  ---RUNTIME: Plan generation took 0.12493133544921875 ms
2022-09-24 21:57:01 INFO  Estimated runtime of original DAG is 8170.557260513306ms
2022-09-24 21:57:01 INFO  Performing Multi-Query Optimization
2022-09-24 21:57:01 INFO  Estimated unoptimized what-if runtime is 40852.78630256653ms
2022-09-24 21:57:01 INFO  Estimated optimised what-if runtime is 10750.630617141724ms
2022-09-24 21:57:01 INFO  Estimated optimisation runtime saving is 30102.155685424805ms
2022-09-24 21:57:01 INFO  ---RUNTIME: Multi-Query Optimization took 10.893106460571289 ms
2022-09-24 21:57:01 INFO  Executing generated plans
2022-09-24 21:57:12 INFO  ---RUNTIME: Execution took 10805.17578125 ms
2022-09-24 21:57:12 INFO  Done!
2022-09-24 21:57:12 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-24 21:57:12 INFO  Running instrumented original pipeline...
2022-09-24 21:57:12 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-24 21:57:12 INFO  ---RUNTIME: Importing and monkey-patching took 6.524562835693359 ms
2022-09-24 21:57:20 INFO  ---RUNTIME: Original pipeline execution took 8496.995449066162 ms (excluding imports and monkey-patching)
2022-09-24 21:57:20 INFO  Starting execution of 1 what-if analyses...
2022-09-24 21:57:20 INFO  Start plan generation for analysis PermutationFeatureImportance...
2022-09-24 21:57:20 INFO  ---RUNTIME: Plan generation took 0.10633468627929688 ms
2022-09-24 21:57:20 INFO  Estimated runtime of original DAG is 8205.755710601807ms
2022-09-24 21:57:20 WARNING Skipping Multi-Query Optimization (instead, only applying patches)
2022-09-24 21:57:20 INFO  Estimated unoptimised what-if runtime is 41028.77855300903ms
2022-09-24 21:57:20 INFO  ---RUNTIME: Multi-Query Optimization took 4.0340423583984375 ms
2022-09-24 21:57:20 INFO  Executing generated plans
2022-09-24 21:58:02 INFO  ---RUNTIME: Execution took 41443.2168006897 ms
2022-09-24 21:58:02 INFO  Done!
2022-09-24 21:58:02 INFO  # Finished -- repetition 2 of 7 
2022-09-24 21:58:02 INFO  # Optimization benchmark for feature_importance with args [['reviews', 'slow_loading', 'featurization_1', 'xgboost']] -- repetition 3 of 7
2022-09-24 21:58:02 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-24 21:58:02 INFO  Running instrumented original pipeline...
2022-09-24 21:58:02 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-24 21:58:02 INFO  ---RUNTIME: Importing and monkey-patching took 6.69097900390625 ms
2022-09-24 21:58:11 INFO  ---RUNTIME: Original pipeline execution took 9124.228715896606 ms (excluding imports and monkey-patching)
2022-09-24 21:58:11 INFO  Starting execution of 1 what-if analyses...
2022-09-24 21:58:11 INFO  Start plan generation for analysis PermutationFeatureImportance...
2022-09-24 21:58:11 INFO  ---RUNTIME: Plan generation took 0.12254714965820312 ms
2022-09-24 21:58:11 INFO  Estimated runtime of original DAG is 8829.813480377197ms
2022-09-24 21:58:11 INFO  Performing Multi-Query Optimization
2022-09-24 21:58:11 INFO  Estimated unoptimized what-if runtime is 44149.067401885986ms
2022-09-24 21:58:11 INFO  Estimated optimised what-if runtime is 11387.383460998535ms
2022-09-24 21:58:11 INFO  Estimated optimisation runtime saving is 32761.68394088745ms
2022-09-24 21:58:11 INFO  ---RUNTIME: Multi-Query Optimization took 11.162042617797852 ms
2022-09-24 21:58:11 INFO  Executing generated plans
2022-09-24 21:58:22 INFO  ---RUNTIME: Execution took 10890.73395729065 ms
2022-09-24 21:58:22 INFO  Done!
2022-09-24 21:58:22 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-24 21:58:22 INFO  Running instrumented original pipeline...
2022-09-24 21:58:22 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-24 21:58:22 INFO  ---RUNTIME: Importing and monkey-patching took 6.331682205200195 ms
2022-09-24 21:58:30 INFO  ---RUNTIME: Original pipeline execution took 8443.734645843506 ms (excluding imports and monkey-patching)
2022-09-24 21:58:30 INFO  Starting execution of 1 what-if analyses...
2022-09-24 21:58:30 INFO  Start plan generation for analysis PermutationFeatureImportance...
2022-09-24 21:58:30 INFO  ---RUNTIME: Plan generation took 0.13065338134765625 ms
2022-09-24 21:58:30 INFO  Estimated runtime of original DAG is 8151.189088821411ms
2022-09-24 21:58:30 WARNING Skipping Multi-Query Optimization (instead, only applying patches)
2022-09-24 21:58:30 INFO  Estimated unoptimised what-if runtime is 40755.945444107056ms
2022-09-24 21:58:30 INFO  ---RUNTIME: Multi-Query Optimization took 3.9505958557128906 ms
2022-09-24 21:58:30 INFO  Executing generated plans
2022-09-24 21:59:12 INFO  ---RUNTIME: Execution took 41070.53995132446 ms
2022-09-24 21:59:12 INFO  Done!
2022-09-24 21:59:12 INFO  # Finished -- repetition 3 of 7 
2022-09-24 21:59:12 INFO  # Optimization benchmark for feature_importance with args [['reviews', 'slow_loading', 'featurization_1', 'xgboost']] -- repetition 4 of 7
2022-09-24 21:59:12 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-24 21:59:12 INFO  Running instrumented original pipeline...
2022-09-24 21:59:12 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-24 21:59:12 INFO  ---RUNTIME: Importing and monkey-patching took 6.680727005004883 ms
2022-09-24 21:59:20 INFO  ---RUNTIME: Original pipeline execution took 8433.09998512268 ms (excluding imports and monkey-patching)
2022-09-24 21:59:20 INFO  Starting execution of 1 what-if analyses...
2022-09-24 21:59:20 INFO  Start plan generation for analysis PermutationFeatureImportance...
2022-09-24 21:59:20 INFO  ---RUNTIME: Plan generation took 0.1342296600341797 ms
2022-09-24 21:59:20 INFO  Estimated runtime of original DAG is 8139.203071594238ms
2022-09-24 21:59:20 INFO  Performing Multi-Query Optimization
2022-09-24 21:59:20 INFO  Estimated unoptimized what-if runtime is 40696.01535797119ms
2022-09-24 21:59:20 INFO  Estimated optimised what-if runtime is 10711.515188217163ms
2022-09-24 21:59:20 INFO  Estimated optimisation runtime saving is 29984.50016975403ms
2022-09-24 21:59:20 INFO  ---RUNTIME: Multi-Query Optimization took 10.299921035766602 ms
2022-09-24 21:59:20 INFO  Executing generated plans
2022-09-24 21:59:31 INFO  ---RUNTIME: Execution took 10777.760028839111 ms
2022-09-24 21:59:31 INFO  Done!
2022-09-24 21:59:31 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-24 21:59:31 INFO  Running instrumented original pipeline...
2022-09-24 21:59:31 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-24 21:59:31 INFO  ---RUNTIME: Importing and monkey-patching took 6.460428237915039 ms
2022-09-24 21:59:39 INFO  ---RUNTIME: Original pipeline execution took 8681.148767471313 ms (excluding imports and monkey-patching)
2022-09-24 21:59:39 INFO  Starting execution of 1 what-if analyses...
2022-09-24 21:59:39 INFO  Start plan generation for analysis PermutationFeatureImportance...
2022-09-24 21:59:39 INFO  ---RUNTIME: Plan generation took 0.13303756713867188 ms
2022-09-24 21:59:39 INFO  Estimated runtime of original DAG is 8384.972095489502ms
2022-09-24 21:59:39 WARNING Skipping Multi-Query Optimization (instead, only applying patches)
2022-09-24 21:59:39 INFO  Estimated unoptimised what-if runtime is 41924.86047744751ms
2022-09-24 21:59:39 INFO  ---RUNTIME: Multi-Query Optimization took 3.9980411529541016 ms
2022-09-24 21:59:39 INFO  Executing generated plans
2022-09-24 22:00:21 INFO  ---RUNTIME: Execution took 41527.37331390381 ms
2022-09-24 22:00:21 INFO  Done!
2022-09-24 22:00:21 INFO  # Finished -- repetition 4 of 7 
2022-09-24 22:00:21 INFO  # Optimization benchmark for feature_importance with args [['reviews', 'slow_loading', 'featurization_1', 'xgboost']] -- repetition 5 of 7
2022-09-24 22:00:21 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-24 22:00:21 INFO  Running instrumented original pipeline...
2022-09-24 22:00:21 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-24 22:00:21 INFO  ---RUNTIME: Importing and monkey-patching took 222.94282913208008 ms
2022-09-24 22:00:30 INFO  ---RUNTIME: Original pipeline execution took 8459.849119186401 ms (excluding imports and monkey-patching)
2022-09-24 22:00:30 INFO  Starting execution of 1 what-if analyses...
2022-09-24 22:00:30 INFO  Start plan generation for analysis PermutationFeatureImportance...
2022-09-24 22:00:30 INFO  ---RUNTIME: Plan generation took 0.12731552124023438 ms
2022-09-24 22:00:30 INFO  Estimated runtime of original DAG is 8165.108203887939ms
2022-09-24 22:00:30 INFO  Performing Multi-Query Optimization
2022-09-24 22:00:30 INFO  Estimated unoptimized what-if runtime is 40825.5410194397ms
2022-09-24 22:00:30 INFO  Estimated optimised what-if runtime is 10747.682571411133ms
2022-09-24 22:00:30 INFO  Estimated optimisation runtime saving is 30077.858448028564ms
2022-09-24 22:00:30 INFO  ---RUNTIME: Multi-Query Optimization took 9.987592697143555 ms
2022-09-24 22:00:30 INFO  Executing generated plans
2022-09-24 22:00:41 INFO  ---RUNTIME: Execution took 10835.255146026611 ms
2022-09-24 22:00:41 INFO  Done!
2022-09-24 22:00:41 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-24 22:00:41 INFO  Running instrumented original pipeline...
2022-09-24 22:00:41 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-24 22:00:41 INFO  ---RUNTIME: Importing and monkey-patching took 6.386756896972656 ms
2022-09-24 22:00:49 INFO  ---RUNTIME: Original pipeline execution took 8411.637306213379 ms (excluding imports and monkey-patching)
2022-09-24 22:00:49 INFO  Starting execution of 1 what-if analyses...
2022-09-24 22:00:49 INFO  Start plan generation for analysis PermutationFeatureImportance...
2022-09-24 22:00:49 INFO  ---RUNTIME: Plan generation took 0.13208389282226562 ms
2022-09-24 22:00:49 INFO  Estimated runtime of original DAG is 8115.212917327881ms
2022-09-24 22:00:49 WARNING Skipping Multi-Query Optimization (instead, only applying patches)
2022-09-24 22:00:49 INFO  Estimated unoptimised what-if runtime is 40576.064586639404ms
2022-09-24 22:00:49 INFO  ---RUNTIME: Multi-Query Optimization took 4.9839019775390625 ms
2022-09-24 22:00:49 INFO  Executing generated plans
2022-09-24 22:01:31 INFO  ---RUNTIME: Execution took 41769.31834220886 ms
2022-09-24 22:01:31 INFO  Done!
2022-09-24 22:01:31 INFO  # Finished -- repetition 5 of 7 
2022-09-24 22:01:31 INFO  # Optimization benchmark for feature_importance with args [['reviews', 'slow_loading', 'featurization_1', 'xgboost']] -- repetition 6 of 7
2022-09-24 22:01:31 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-24 22:01:31 INFO  Running instrumented original pipeline...
2022-09-24 22:01:31 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-24 22:01:31 INFO  ---RUNTIME: Importing and monkey-patching took 6.591796875 ms
2022-09-24 22:01:39 INFO  ---RUNTIME: Original pipeline execution took 8549.147605895996 ms (excluding imports and monkey-patching)
2022-09-24 22:01:39 INFO  Starting execution of 1 what-if analyses...
2022-09-24 22:01:39 INFO  Start plan generation for analysis PermutationFeatureImportance...
2022-09-24 22:01:39 INFO  ---RUNTIME: Plan generation took 0.13327598571777344 ms
2022-09-24 22:01:39 INFO  Estimated runtime of original DAG is 8253.30924987793ms
2022-09-24 22:01:39 INFO  Performing Multi-Query Optimization
2022-09-24 22:01:39 INFO  Estimated unoptimized what-if runtime is 41266.54624938965ms
2022-09-24 22:01:39 INFO  Estimated optimised what-if runtime is 10836.96174621582ms
2022-09-24 22:01:39 INFO  Estimated optimisation runtime saving is 30429.584503173828ms
2022-09-24 22:01:39 INFO  ---RUNTIME: Multi-Query Optimization took 10.228872299194336 ms
2022-09-24 22:01:39 INFO  Executing generated plans
2022-09-24 22:01:50 INFO  ---RUNTIME: Execution took 10901.540994644165 ms
2022-09-24 22:01:50 INFO  Done!
2022-09-24 22:01:50 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-24 22:01:50 INFO  Running instrumented original pipeline...
2022-09-24 22:01:50 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-24 22:01:50 INFO  ---RUNTIME: Importing and monkey-patching took 6.188154220581055 ms
2022-09-24 22:01:59 INFO  ---RUNTIME: Original pipeline execution took 8452.83842086792 ms (excluding imports and monkey-patching)
2022-09-24 22:01:59 INFO  Starting execution of 1 what-if analyses...
2022-09-24 22:01:59 INFO  Start plan generation for analysis PermutationFeatureImportance...
2022-09-24 22:01:59 INFO  ---RUNTIME: Plan generation took 0.09369850158691406 ms
2022-09-24 22:01:59 INFO  Estimated runtime of original DAG is 8155.658721923828ms
2022-09-24 22:01:59 WARNING Skipping Multi-Query Optimization (instead, only applying patches)
2022-09-24 22:01:59 INFO  Estimated unoptimised what-if runtime is 40778.29360961914ms
2022-09-24 22:01:59 INFO  ---RUNTIME: Multi-Query Optimization took 3.937959671020508 ms
2022-09-24 22:01:59 INFO  Executing generated plans
2022-09-24 22:02:40 INFO  ---RUNTIME: Execution took 41257.48586654663 ms
2022-09-24 22:02:40 INFO  Done!
2022-09-24 22:02:40 INFO  # Finished -- repetition 6 of 7 
2022-09-24 22:02:40 INFO  # Optimization benchmark for feature_importance with args [['reviews', 'slow_loading', 'featurization_1', 'xgboost']] -- repetition 7 of 7
2022-09-24 22:02:40 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-24 22:02:40 INFO  Running instrumented original pipeline...
2022-09-24 22:02:40 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-24 22:02:40 INFO  ---RUNTIME: Importing and monkey-patching took 6.643533706665039 ms
2022-09-24 22:02:48 INFO  ---RUNTIME: Original pipeline execution took 8425.430059432983 ms (excluding imports and monkey-patching)
2022-09-24 22:02:48 INFO  Starting execution of 1 what-if analyses...
2022-09-24 22:02:48 INFO  Start plan generation for analysis PermutationFeatureImportance...
2022-09-24 22:02:48 INFO  ---RUNTIME: Plan generation took 0.12826919555664062 ms
2022-09-24 22:02:48 INFO  Estimated runtime of original DAG is 8128.715515136719ms
2022-09-24 22:02:48 INFO  Performing Multi-Query Optimization
2022-09-24 22:02:48 INFO  Estimated unoptimized what-if runtime is 40643.577575683594ms
2022-09-24 22:02:48 INFO  Estimated optimised what-if runtime is 10706.82978630066ms
2022-09-24 22:02:48 INFO  Estimated optimisation runtime saving is 29936.747789382935ms
2022-09-24 22:02:48 INFO  ---RUNTIME: Multi-Query Optimization took 11.343240737915039 ms
2022-09-24 22:02:48 INFO  Executing generated plans
2022-09-24 22:02:59 INFO  ---RUNTIME: Execution took 10855.338096618652 ms
2022-09-24 22:02:59 INFO  Done!
2022-09-24 22:02:59 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-24 22:02:59 INFO  Running instrumented original pipeline...
2022-09-24 22:02:59 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-24 22:02:59 INFO  ---RUNTIME: Importing and monkey-patching took 6.285667419433594 ms
2022-09-24 22:03:08 INFO  ---RUNTIME: Original pipeline execution took 8419.360160827637 ms (excluding imports and monkey-patching)
2022-09-24 22:03:08 INFO  Starting execution of 1 what-if analyses...
2022-09-24 22:03:08 INFO  Start plan generation for analysis PermutationFeatureImportance...
2022-09-24 22:03:08 INFO  ---RUNTIME: Plan generation took 0.11992454528808594 ms
2022-09-24 22:03:08 INFO  Estimated runtime of original DAG is 8126.882076263428ms
2022-09-24 22:03:08 WARNING Skipping Multi-Query Optimization (instead, only applying patches)
2022-09-24 22:03:08 INFO  Estimated unoptimised what-if runtime is 40634.41038131714ms
2022-09-24 22:03:08 INFO  ---RUNTIME: Multi-Query Optimization took 4.014492034912109 ms
2022-09-24 22:03:08 INFO  Executing generated plans
2022-09-24 22:03:49 INFO  ---RUNTIME: Execution took 41421.180725097656 ms
2022-09-24 22:03:49 INFO  Done!
2022-09-24 22:03:49 INFO  # Finished -- repetition 7 of 7 
2022-09-24 22:03:49 INFO  # Final results after all repetitions
2022-09-24 22:03:49 INFO     repetition  ... no_opt_what_if_execution_combined_model_training
0           0  ...                                     12749.013901
1           1  ...                                     12711.002111
2           2  ...                                     12706.713200
3           3  ...                                     12718.359232
4           4  ...                                     12698.441982
5           5  ...                                     12706.351757
6           6  ...                                     12725.299120

[7 rows x 26 columns]
PROTOCOL_BUFFERS_PYTHON_IMPLEMENTATION=python taskset -c 32-39 python3.9 benchmarks_end_to_end.py feature_importance reviews slow_loading featurization_1 neural_network
2022-09-24 22:03:51.893513: W tensorflow/stream_executor/platform/default/dso_loader.cc:64] Could not load dynamic library 'libcudart.so.11.0'; dlerror: libcudart.so.11.0: cannot open shared object file: No such file or directory; LD_LIBRARY_PATH: /home/sgrafbe/mlwhatif/venv/lib/python3.9/site-packages/cv2/../../lib64:
2022-09-24 22:03:51.893560: I tensorflow/stream_executor/cuda/cudart_stub.cc:29] Ignore above cudart dlerror if you do not have a GPU set up on your machine.
2022-09-24 22:03:53 INFO  Patching sys.argv with ['mlwhatif', 'reviews', 'slow_loading', 'featurization_1', 'neural_network']
2022-09-24 22:03:53 INFO  Running instrumented original pipeline...
2022-09-24 22:03:53 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-24 22:03:53 INFO  ---RUNTIME: Importing and monkey-patching took 95.94583511352539 ms
2022-09-24 22:03:57.529746: W tensorflow/stream_executor/platform/default/dso_loader.cc:64] Could not load dynamic library 'libcuda.so.1'; dlerror: libcuda.so.1: cannot open shared object file: No such file or directory; LD_LIBRARY_PATH: /home/sgrafbe/mlwhatif/venv/lib/python3.9/site-packages/cv2/../../lib64:
2022-09-24 22:03:57.529786: W tensorflow/stream_executor/cuda/cuda_driver.cc:326] failed call to cuInit: UNKNOWN ERROR (303)
2022-09-24 22:03:57.529815: I tensorflow/stream_executor/cuda/cuda_diagnostics.cc:156] kernel driver does not appear to be running on this host (wagyu): /proc/driver/nvidia/version does not exist
2022-09-24 22:03:57.530338: I tensorflow/core/platform/cpu_feature_guard.cc:142] This TensorFlow binary is optimized with oneAPI Deep Neural Network Library (oneDNN) to use the following CPU instructions in performance-critical operations:  AVX2 FMA
To enable them in other operations, rebuild TensorFlow with the appropriate compiler flags.
2022-09-24 22:03:57.599896: I tensorflow/compiler/mlir/mlir_graph_optimization_pass.cc:176] None of the MLIR Optimization Passes are enabled (registered 2)
2022-09-24 22:03:57.612374: I tensorflow/core/platform/profile_utils/cpu_utils.cc:114] CPU Frequency: 2595290000 Hz
2022-09-24 22:04:02 INFO  ---RUNTIME: Original pipeline execution took 9508.41736793518 ms (excluding imports and monkey-patching)
2022-09-24 22:04:02 INFO  Starting execution of 0 what-if analyses...
2022-09-24 22:04:02 INFO  Estimated runtime of original DAG is 9175.342798233032ms
2022-09-24 22:04:02 INFO  Performing Multi-Query Optimization
2022-09-24 22:04:02 INFO  Estimated unoptimized what-if runtime is 0ms
2022-09-24 22:04:02 INFO  Estimated optimised what-if runtime is 0ms
2022-09-24 22:04:02 INFO  Estimated optimisation runtime saving is 0ms
2022-09-24 22:04:02 INFO  ---RUNTIME: Multi-Query Optimization took 0.4963874816894531 ms
2022-09-24 22:04:02 INFO  Executing generated plans
2022-09-24 22:04:02 INFO  ---RUNTIME: Execution took 0.019550323486328125 ms
2022-09-24 22:04:02 INFO  Done!
2022-09-24 22:04:02 INFO  # Optimization benchmark for feature_importance with args [['reviews', 'slow_loading', 'featurization_1', 'neural_network']] -- repetition 1 of 7
2022-09-24 22:04:02 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-24 22:04:02 INFO  Running instrumented original pipeline...
2022-09-24 22:04:02 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-24 22:04:02 INFO  ---RUNTIME: Importing and monkey-patching took 5.588769912719727 ms
2022-09-24 22:04:11 INFO  ---RUNTIME: Original pipeline execution took 9091.075420379639 ms (excluding imports and monkey-patching)
2022-09-24 22:04:11 INFO  Starting execution of 1 what-if analyses...
2022-09-24 22:04:11 INFO  Start plan generation for analysis PermutationFeatureImportance...
2022-09-24 22:04:11 INFO  ---RUNTIME: Plan generation took 0.2162456512451172 ms
2022-09-24 22:04:11 INFO  Estimated runtime of original DAG is 8795.22728919983ms
2022-09-24 22:04:11 INFO  Performing Multi-Query Optimization
2022-09-24 22:04:11 INFO  Estimated unoptimized what-if runtime is 43976.136445999146ms
2022-09-24 22:04:11 INFO  Estimated optimised what-if runtime is 11759.037017822266ms
2022-09-24 22:04:11 INFO  Estimated optimisation runtime saving is 32217.09942817688ms
2022-09-24 22:04:11 INFO  ---RUNTIME: Multi-Query Optimization took 10.571956634521484 ms
2022-09-24 22:04:11 INFO  Executing generated plans
2022-09-24 22:04:23 INFO  ---RUNTIME: Execution took 11864.931583404541 ms
2022-09-24 22:04:23 INFO  Done!
2022-09-24 22:04:23 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-24 22:04:23 INFO  Running instrumented original pipeline...
2022-09-24 22:04:23 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-24 22:04:23 INFO  ---RUNTIME: Importing and monkey-patching took 6.586790084838867 ms
2022-09-24 22:04:32 INFO  ---RUNTIME: Original pipeline execution took 9228.025674819946 ms (excluding imports and monkey-patching)
2022-09-24 22:04:32 INFO  Starting execution of 1 what-if analyses...
2022-09-24 22:04:32 INFO  Start plan generation for analysis PermutationFeatureImportance...
2022-09-24 22:04:32 INFO  ---RUNTIME: Plan generation took 0.13828277587890625 ms
2022-09-24 22:04:32 INFO  Estimated runtime of original DAG is 8929.6715259552ms
2022-09-24 22:04:32 WARNING Skipping Multi-Query Optimization (instead, only applying patches)
2022-09-24 22:04:32 INFO  Estimated unoptimised what-if runtime is 44648.357629776ms
2022-09-24 22:04:32 INFO  ---RUNTIME: Multi-Query Optimization took 3.923177719116211 ms
2022-09-24 22:04:32 INFO  Executing generated plans
2022-09-24 22:05:17 INFO  ---RUNTIME: Execution took 44810.19878387451 ms
2022-09-24 22:05:17 INFO  Done!
2022-09-24 22:05:17 INFO  # Finished -- repetition 1 of 7 
2022-09-24 22:05:17 INFO  # Optimization benchmark for feature_importance with args [['reviews', 'slow_loading', 'featurization_1', 'neural_network']] -- repetition 2 of 7
2022-09-24 22:05:17 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-24 22:05:17 INFO  Running instrumented original pipeline...
2022-09-24 22:05:17 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-24 22:05:17 INFO  ---RUNTIME: Importing and monkey-patching took 6.642580032348633 ms
2022-09-24 22:05:27 INFO  ---RUNTIME: Original pipeline execution took 9638.819217681885 ms (excluding imports and monkey-patching)
2022-09-24 22:05:27 INFO  Starting execution of 1 what-if analyses...
2022-09-24 22:05:27 INFO  Start plan generation for analysis PermutationFeatureImportance...
2022-09-24 22:05:27 INFO  ---RUNTIME: Plan generation took 0.11301040649414062 ms
2022-09-24 22:05:27 INFO  Estimated runtime of original DAG is 9337.185859680176ms
2022-09-24 22:05:27 INFO  Performing Multi-Query Optimization
2022-09-24 22:05:27 INFO  Estimated unoptimized what-if runtime is 46685.92929840088ms
2022-09-24 22:05:27 INFO  Estimated optimised what-if runtime is 12568.10975074768ms
2022-09-24 22:05:27 INFO  Estimated optimisation runtime saving is 34117.8195476532ms
2022-09-24 22:05:27 INFO  ---RUNTIME: Multi-Query Optimization took 10.555267333984375 ms
2022-09-24 22:05:27 INFO  Executing generated plans
2022-09-24 22:05:39 INFO  ---RUNTIME: Execution took 12168.141603469849 ms
2022-09-24 22:05:39 INFO  Done!
2022-09-24 22:05:39 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-24 22:05:39 INFO  Running instrumented original pipeline...
2022-09-24 22:05:39 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-24 22:05:39 INFO  ---RUNTIME: Importing and monkey-patching took 6.094455718994141 ms
2022-09-24 22:05:48 INFO  ---RUNTIME: Original pipeline execution took 9129.24861907959 ms (excluding imports and monkey-patching)
2022-09-24 22:05:48 INFO  Starting execution of 1 what-if analyses...
2022-09-24 22:05:48 INFO  Start plan generation for analysis PermutationFeatureImportance...
2022-09-24 22:05:48 INFO  ---RUNTIME: Plan generation took 0.14734268188476562 ms
2022-09-24 22:05:48 INFO  Estimated runtime of original DAG is 8827.66604423523ms
2022-09-24 22:05:48 WARNING Skipping Multi-Query Optimization (instead, only applying patches)
2022-09-24 22:05:48 INFO  Estimated unoptimised what-if runtime is 44138.33022117615ms
2022-09-24 22:05:48 INFO  ---RUNTIME: Multi-Query Optimization took 3.971099853515625 ms
2022-09-24 22:05:48 INFO  Executing generated plans
2022-09-24 22:06:35 INFO  ---RUNTIME: Execution took 46930.56392669678 ms
2022-09-24 22:06:35 INFO  Done!
2022-09-24 22:06:35 INFO  # Finished -- repetition 2 of 7 
2022-09-24 22:06:35 INFO  # Optimization benchmark for feature_importance with args [['reviews', 'slow_loading', 'featurization_1', 'neural_network']] -- repetition 3 of 7
2022-09-24 22:06:35 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-24 22:06:35 INFO  Running instrumented original pipeline...
2022-09-24 22:06:35 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-24 22:06:35 INFO  ---RUNTIME: Importing and monkey-patching took 6.180047988891602 ms
2022-09-24 22:06:45 INFO  ---RUNTIME: Original pipeline execution took 9652.268886566162 ms (excluding imports and monkey-patching)
2022-09-24 22:06:45 INFO  Starting execution of 1 what-if analyses...
2022-09-24 22:06:45 INFO  Start plan generation for analysis PermutationFeatureImportance...
2022-09-24 22:06:45 INFO  ---RUNTIME: Plan generation took 0.12302398681640625 ms
2022-09-24 22:06:45 INFO  Estimated runtime of original DAG is 9339.909553527832ms
2022-09-24 22:06:45 INFO  Performing Multi-Query Optimization
2022-09-24 22:06:45 INFO  Estimated unoptimized what-if runtime is 46699.54776763916ms
2022-09-24 22:06:45 INFO  Estimated optimised what-if runtime is 12248.973846435547ms
2022-09-24 22:06:45 INFO  Estimated optimisation runtime saving is 34450.57392120361ms
2022-09-24 22:06:45 INFO  ---RUNTIME: Multi-Query Optimization took 10.043144226074219 ms
2022-09-24 22:06:45 INFO  Executing generated plans
2022-09-24 22:06:57 INFO  ---RUNTIME: Execution took 12126.74069404602 ms
2022-09-24 22:06:57 INFO  Done!
2022-09-24 22:06:57 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-24 22:06:57 INFO  Running instrumented original pipeline...
2022-09-24 22:06:57 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-24 22:06:57 INFO  ---RUNTIME: Importing and monkey-patching took 6.531000137329102 ms
2022-09-24 22:07:06 INFO  ---RUNTIME: Original pipeline execution took 9348.163604736328 ms (excluding imports and monkey-patching)
2022-09-24 22:07:06 INFO  Starting execution of 1 what-if analyses...
2022-09-24 22:07:06 INFO  Start plan generation for analysis PermutationFeatureImportance...
2022-09-24 22:07:06 INFO  ---RUNTIME: Plan generation took 0.1125335693359375 ms
2022-09-24 22:07:06 INFO  Estimated runtime of original DAG is 9037.885904312134ms
2022-09-24 22:07:06 WARNING Skipping Multi-Query Optimization (instead, only applying patches)
2022-09-24 22:07:06 INFO  Estimated unoptimised what-if runtime is 45189.42952156067ms
2022-09-24 22:07:06 INFO  ---RUNTIME: Multi-Query Optimization took 4.574060440063477 ms
2022-09-24 22:07:06 INFO  Executing generated plans
2022-09-24 22:07:54 INFO  ---RUNTIME: Execution took 47161.56721115112 ms
2022-09-24 22:07:54 INFO  Done!
2022-09-24 22:07:54 INFO  # Finished -- repetition 3 of 7 
2022-09-24 22:07:54 INFO  # Optimization benchmark for feature_importance with args [['reviews', 'slow_loading', 'featurization_1', 'neural_network']] -- repetition 4 of 7
2022-09-24 22:07:54 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-24 22:07:54 INFO  Running instrumented original pipeline...
2022-09-24 22:07:54 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-24 22:07:54 INFO  ---RUNTIME: Importing and monkey-patching took 6.56890869140625 ms
2022-09-24 22:08:03 INFO  ---RUNTIME: Original pipeline execution took 9504.734516143799 ms (excluding imports and monkey-patching)
2022-09-24 22:08:03 INFO  Starting execution of 1 what-if analyses...
2022-09-24 22:08:03 INFO  Start plan generation for analysis PermutationFeatureImportance...
2022-09-24 22:08:03 INFO  ---RUNTIME: Plan generation took 0.125885009765625 ms
2022-09-24 22:08:03 INFO  Estimated runtime of original DAG is 9198.748588562012ms
2022-09-24 22:08:03 INFO  Performing Multi-Query Optimization
2022-09-24 22:08:03 INFO  Estimated unoptimized what-if runtime is 45993.74294281006ms
2022-09-24 22:08:03 INFO  Estimated optimised what-if runtime is 12072.363138198853ms
2022-09-24 22:08:03 INFO  Estimated optimisation runtime saving is 33921.379804611206ms
2022-09-24 22:08:03 INFO  ---RUNTIME: Multi-Query Optimization took 9.981632232666016 ms
2022-09-24 22:08:03 INFO  Executing generated plans
2022-09-24 22:08:15 INFO  ---RUNTIME: Execution took 12391.00193977356 ms
2022-09-24 22:08:15 INFO  Done!
2022-09-24 22:08:16 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-24 22:08:16 INFO  Running instrumented original pipeline...
2022-09-24 22:08:16 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-24 22:08:16 INFO  ---RUNTIME: Importing and monkey-patching took 6.239652633666992 ms
2022-09-24 22:08:25 INFO  ---RUNTIME: Original pipeline execution took 9373.427867889404 ms (excluding imports and monkey-patching)
2022-09-24 22:08:25 INFO  Starting execution of 1 what-if analyses...
2022-09-24 22:08:25 INFO  Start plan generation for analysis PermutationFeatureImportance...
2022-09-24 22:08:25 INFO  ---RUNTIME: Plan generation took 0.14281272888183594 ms
2022-09-24 22:08:25 INFO  Estimated runtime of original DAG is 9058.165788650513ms
2022-09-24 22:08:25 WARNING Skipping Multi-Query Optimization (instead, only applying patches)
2022-09-24 22:08:25 INFO  Estimated unoptimised what-if runtime is 45290.82894325256ms
2022-09-24 22:08:25 INFO  ---RUNTIME: Multi-Query Optimization took 3.8518905639648438 ms
2022-09-24 22:08:25 INFO  Executing generated plans
2022-09-24 22:09:10 INFO  ---RUNTIME: Execution took 45574.827909469604 ms
2022-09-24 22:09:10 INFO  Done!
2022-09-24 22:09:10 INFO  # Finished -- repetition 4 of 7 
2022-09-24 22:09:10 INFO  # Optimization benchmark for feature_importance with args [['reviews', 'slow_loading', 'featurization_1', 'neural_network']] -- repetition 5 of 7
2022-09-24 22:09:10 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-24 22:09:10 INFO  Running instrumented original pipeline...
2022-09-24 22:09:11 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-24 22:09:11 INFO  ---RUNTIME: Importing and monkey-patching took 6.979227066040039 ms
2022-09-24 22:09:21 INFO  ---RUNTIME: Original pipeline execution took 10408.071041107178 ms (excluding imports and monkey-patching)
2022-09-24 22:09:21 INFO  Starting execution of 1 what-if analyses...
2022-09-24 22:09:21 INFO  Start plan generation for analysis PermutationFeatureImportance...
2022-09-24 22:09:21 INFO  ---RUNTIME: Plan generation took 0.11467933654785156 ms
2022-09-24 22:09:21 INFO  Estimated runtime of original DAG is 9690.909147262573ms
2022-09-24 22:09:21 INFO  Performing Multi-Query Optimization
2022-09-24 22:09:21 INFO  Estimated unoptimized what-if runtime is 48454.545736312866ms
2022-09-24 22:09:21 INFO  Estimated optimised what-if runtime is 12988.441228866577ms
2022-09-24 22:09:21 INFO  Estimated optimisation runtime saving is 35466.10450744629ms
2022-09-24 22:09:21 INFO  ---RUNTIME: Multi-Query Optimization took 10.761737823486328 ms
2022-09-24 22:09:21 INFO  Executing generated plans
2022-09-24 22:09:33 INFO  ---RUNTIME: Execution took 12564.14771080017 ms
2022-09-24 22:09:33 INFO  Done!
2022-09-24 22:09:34 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-24 22:09:34 INFO  Running instrumented original pipeline...
2022-09-24 22:09:34 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-24 22:09:34 INFO  ---RUNTIME: Importing and monkey-patching took 6.503105163574219 ms
2022-09-24 22:09:43 INFO  ---RUNTIME: Original pipeline execution took 9524.324655532837 ms (excluding imports and monkey-patching)
2022-09-24 22:09:43 INFO  Starting execution of 1 what-if analyses...
2022-09-24 22:09:43 INFO  Start plan generation for analysis PermutationFeatureImportance...
2022-09-24 22:09:43 INFO  ---RUNTIME: Plan generation took 0.1125335693359375 ms
2022-09-24 22:09:43 INFO  Estimated runtime of original DAG is 9210.092067718506ms
2022-09-24 22:09:43 WARNING Skipping Multi-Query Optimization (instead, only applying patches)
2022-09-24 22:09:43 INFO  Estimated unoptimised what-if runtime is 46050.46033859253ms
2022-09-24 22:09:43 INFO  ---RUNTIME: Multi-Query Optimization took 3.904104232788086 ms
2022-09-24 22:09:43 INFO  Executing generated plans
2022-09-24 22:10:30 INFO  ---RUNTIME: Execution took 47046.39792442322 ms
2022-09-24 22:10:30 INFO  Done!
2022-09-24 22:10:30 INFO  # Finished -- repetition 5 of 7 
2022-09-24 22:10:30 INFO  # Optimization benchmark for feature_importance with args [['reviews', 'slow_loading', 'featurization_1', 'neural_network']] -- repetition 6 of 7
2022-09-24 22:10:30 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-24 22:10:30 INFO  Running instrumented original pipeline...
2022-09-24 22:10:30 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-24 22:10:30 INFO  ---RUNTIME: Importing and monkey-patching took 6.260871887207031 ms
2022-09-24 22:10:40 INFO  ---RUNTIME: Original pipeline execution took 9618.31521987915 ms (excluding imports and monkey-patching)
2022-09-24 22:10:40 INFO  Starting execution of 1 what-if analyses...
2022-09-24 22:10:40 INFO  Start plan generation for analysis PermutationFeatureImportance...
2022-09-24 22:10:40 INFO  ---RUNTIME: Plan generation took 0.10132789611816406 ms
2022-09-24 22:10:40 INFO  Estimated runtime of original DAG is 9318.039417266846ms
2022-09-24 22:10:40 INFO  Performing Multi-Query Optimization
2022-09-24 22:10:40 INFO  Estimated unoptimized what-if runtime is 46590.19708633423ms
2022-09-24 22:10:40 INFO  Estimated optimised what-if runtime is 12217.574834823608ms
2022-09-24 22:10:40 INFO  Estimated optimisation runtime saving is 34372.62225151062ms
2022-09-24 22:10:40 INFO  ---RUNTIME: Multi-Query Optimization took 9.990453720092773 ms
2022-09-24 22:10:40 INFO  Executing generated plans
2022-09-24 22:10:52 INFO  ---RUNTIME: Execution took 11896.546125411987 ms
2022-09-24 22:10:52 INFO  Done!
2022-09-24 22:10:52 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-24 22:10:52 INFO  Running instrumented original pipeline...
2022-09-24 22:10:52 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-24 22:10:52 INFO  ---RUNTIME: Importing and monkey-patching took 6.652593612670898 ms
2022-09-24 22:11:02 INFO  ---RUNTIME: Original pipeline execution took 10194.870233535767 ms (excluding imports and monkey-patching)
2022-09-24 22:11:02 INFO  Starting execution of 1 what-if analyses...
2022-09-24 22:11:02 INFO  Start plan generation for analysis PermutationFeatureImportance...
2022-09-24 22:11:02 INFO  ---RUNTIME: Plan generation took 0.10418891906738281 ms
2022-09-24 22:11:02 INFO  Estimated runtime of original DAG is 9878.413677215576ms
2022-09-24 22:11:02 WARNING Skipping Multi-Query Optimization (instead, only applying patches)
2022-09-24 22:11:02 INFO  Estimated unoptimised what-if runtime is 49392.06838607788ms
2022-09-24 22:11:02 INFO  ---RUNTIME: Multi-Query Optimization took 4.099607467651367 ms
2022-09-24 22:11:02 INFO  Executing generated plans
2022-09-24 22:11:49 INFO  ---RUNTIME: Execution took 47408.59389305115 ms
2022-09-24 22:11:49 INFO  Done!
2022-09-24 22:11:49 INFO  # Finished -- repetition 6 of 7 
2022-09-24 22:11:49 INFO  # Optimization benchmark for feature_importance with args [['reviews', 'slow_loading', 'featurization_1', 'neural_network']] -- repetition 7 of 7
2022-09-24 22:11:49 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-24 22:11:49 INFO  Running instrumented original pipeline...
2022-09-24 22:11:49 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-24 22:11:49 INFO  ---RUNTIME: Importing and monkey-patching took 7.562875747680664 ms
2022-09-24 22:11:59 INFO  ---RUNTIME: Original pipeline execution took 9509.027004241943 ms (excluding imports and monkey-patching)
2022-09-24 22:11:59 INFO  Starting execution of 1 what-if analyses...
2022-09-24 22:11:59 INFO  Start plan generation for analysis PermutationFeatureImportance...
2022-09-24 22:11:59 INFO  ---RUNTIME: Plan generation took 0.11205673217773438 ms
2022-09-24 22:11:59 INFO  Estimated runtime of original DAG is 9198.813438415527ms
2022-09-24 22:11:59 INFO  Performing Multi-Query Optimization
2022-09-24 22:11:59 INFO  Estimated unoptimized what-if runtime is 45994.06719207764ms
2022-09-24 22:11:59 INFO  Estimated optimised what-if runtime is 12416.930675506592ms
2022-09-24 22:11:59 INFO  Estimated optimisation runtime saving is 33577.136516571045ms
2022-09-24 22:11:59 INFO  ---RUNTIME: Multi-Query Optimization took 12.303829193115234 ms
2022-09-24 22:11:59 INFO  Executing generated plans
2022-09-24 22:12:11 INFO  ---RUNTIME: Execution took 12434.704065322876 ms
2022-09-24 22:12:11 INFO  Done!
2022-09-24 22:12:11 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-24 22:12:11 INFO  Running instrumented original pipeline...
2022-09-24 22:12:11 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-24 22:12:11 INFO  ---RUNTIME: Importing and monkey-patching took 6.158351898193359 ms
2022-09-24 22:12:21 INFO  ---RUNTIME: Original pipeline execution took 10048.091888427734 ms (excluding imports and monkey-patching)
2022-09-24 22:12:21 INFO  Starting execution of 1 what-if analyses...
2022-09-24 22:12:21 INFO  Start plan generation for analysis PermutationFeatureImportance...
2022-09-24 22:12:21 INFO  ---RUNTIME: Plan generation took 0.12564659118652344 ms
2022-09-24 22:12:21 INFO  Estimated runtime of original DAG is 9744.51494216919ms
2022-09-24 22:12:21 WARNING Skipping Multi-Query Optimization (instead, only applying patches)
2022-09-24 22:12:21 INFO  Estimated unoptimised what-if runtime is 48722.57471084595ms
2022-09-24 22:12:21 INFO  ---RUNTIME: Multi-Query Optimization took 3.9870738983154297 ms
2022-09-24 22:12:21 INFO  Executing generated plans
2022-09-24 22:13:08 INFO  ---RUNTIME: Execution took 46366.172790527344 ms
2022-09-24 22:13:08 INFO  Done!
2022-09-24 22:13:08 INFO  # Finished -- repetition 7 of 7 
2022-09-24 22:13:08 INFO  # Final results after all repetitions
2022-09-24 22:13:08 INFO     repetition  ... no_opt_what_if_execution_combined_model_training
0           0  ...                                     16353.064775
1           1  ...                                     17302.752972
2           2  ...                                     17655.597925
3           3  ...                                     16208.656311
4           4  ...                                     17517.665386
5           5  ...                                     18410.913944
6           6  ...                                     16961.838722

[7 rows x 26 columns]
PROTOCOL_BUFFERS_PYTHON_IMPLEMENTATION=python taskset -c 32-39 python3.9 benchmarks_end_to_end.py feature_importance reviews slow_loading featurization_2 logistic_regression
2022-09-24 22:13:10.716445: W tensorflow/stream_executor/platform/default/dso_loader.cc:64] Could not load dynamic library 'libcudart.so.11.0'; dlerror: libcudart.so.11.0: cannot open shared object file: No such file or directory; LD_LIBRARY_PATH: /home/sgrafbe/mlwhatif/venv/lib/python3.9/site-packages/cv2/../../lib64:
2022-09-24 22:13:10.716486: I tensorflow/stream_executor/cuda/cudart_stub.cc:29] Ignore above cudart dlerror if you do not have a GPU set up on your machine.
2022-09-24 22:13:12 INFO  Patching sys.argv with ['mlwhatif', 'reviews', 'slow_loading', 'featurization_2', 'logistic_regression']
2022-09-24 22:13:12 INFO  Running instrumented original pipeline...
2022-09-24 22:13:12 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-24 22:13:12 INFO  ---RUNTIME: Importing and monkey-patching took 101.18651390075684 ms
2022-09-24 22:13:18 INFO  ---RUNTIME: Original pipeline execution took 6513.060569763184 ms (excluding imports and monkey-patching)
2022-09-24 22:13:18 INFO  Starting execution of 0 what-if analyses...
2022-09-24 22:13:18 INFO  Estimated runtime of original DAG is 6180.156946182251ms
2022-09-24 22:13:18 INFO  Performing Multi-Query Optimization
2022-09-24 22:13:18 INFO  Estimated unoptimized what-if runtime is 0ms
2022-09-24 22:13:18 INFO  Estimated optimised what-if runtime is 0ms
2022-09-24 22:13:18 INFO  Estimated optimisation runtime saving is 0ms
2022-09-24 22:13:18 INFO  ---RUNTIME: Multi-Query Optimization took 0.6432533264160156 ms
2022-09-24 22:13:18 INFO  Executing generated plans
2022-09-24 22:13:18 INFO  ---RUNTIME: Execution took 0.02956390380859375 ms
2022-09-24 22:13:18 INFO  Done!
2022-09-24 22:13:18 INFO  # Optimization benchmark for feature_importance with args [['reviews', 'slow_loading', 'featurization_2', 'logistic_regression']] -- repetition 1 of 7
2022-09-24 22:13:18 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-24 22:13:18 INFO  Running instrumented original pipeline...
2022-09-24 22:13:18 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-24 22:13:18 INFO  ---RUNTIME: Importing and monkey-patching took 6.386518478393555 ms
2022-09-24 22:13:25 INFO  ---RUNTIME: Original pipeline execution took 6464.136838912964 ms (excluding imports and monkey-patching)
2022-09-24 22:13:25 INFO  Starting execution of 1 what-if analyses...
2022-09-24 22:13:25 INFO  Start plan generation for analysis PermutationFeatureImportance...
2022-09-24 22:13:25 INFO  ---RUNTIME: Plan generation took 0.22125244140625 ms
2022-09-24 22:13:25 INFO  Estimated runtime of original DAG is 6156.22878074646ms
2022-09-24 22:13:25 INFO  Performing Multi-Query Optimization
2022-09-24 22:13:25 INFO  Estimated unoptimized what-if runtime is 30781.1439037323ms
2022-09-24 22:13:25 INFO  Estimated optimised what-if runtime is 7761.317729949951ms
2022-09-24 22:13:25 INFO  Estimated optimisation runtime saving is 23019.82617378235ms
2022-09-24 22:13:25 INFO  ---RUNTIME: Multi-Query Optimization took 10.929107666015625 ms
2022-09-24 22:13:25 INFO  Executing generated plans
2022-09-24 22:13:32 INFO  ---RUNTIME: Execution took 7781.903266906738 ms
2022-09-24 22:13:32 INFO  Done!
2022-09-24 22:13:32 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-24 22:13:32 INFO  Running instrumented original pipeline...
2022-09-24 22:13:33 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-24 22:13:33 INFO  ---RUNTIME: Importing and monkey-patching took 6.115436553955078 ms
2022-09-24 22:13:39 INFO  ---RUNTIME: Original pipeline execution took 6656.811952590942 ms (excluding imports and monkey-patching)
2022-09-24 22:13:39 INFO  Starting execution of 1 what-if analyses...
2022-09-24 22:13:39 INFO  Start plan generation for analysis PermutationFeatureImportance...
2022-09-24 22:13:39 INFO  ---RUNTIME: Plan generation took 0.11587142944335938 ms
2022-09-24 22:13:39 INFO  Estimated runtime of original DAG is 6165.634870529175ms
2022-09-24 22:13:39 WARNING Skipping Multi-Query Optimization (instead, only applying patches)
2022-09-24 22:13:39 INFO  Estimated unoptimised what-if runtime is 30828.174352645874ms
2022-09-24 22:13:39 INFO  ---RUNTIME: Multi-Query Optimization took 4.758596420288086 ms
2022-09-24 22:13:39 INFO  Executing generated plans
2022-09-24 22:14:10 INFO  ---RUNTIME: Execution took 30619.659900665283 ms
2022-09-24 22:14:10 INFO  Done!
2022-09-24 22:14:10 INFO  # Finished -- repetition 1 of 7 
2022-09-24 22:14:10 INFO  # Optimization benchmark for feature_importance with args [['reviews', 'slow_loading', 'featurization_2', 'logistic_regression']] -- repetition 2 of 7
2022-09-24 22:14:10 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-24 22:14:10 INFO  Running instrumented original pipeline...
2022-09-24 22:14:10 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-24 22:14:10 INFO  ---RUNTIME: Importing and monkey-patching took 6.470680236816406 ms
2022-09-24 22:14:16 INFO  ---RUNTIME: Original pipeline execution took 6602.74863243103 ms (excluding imports and monkey-patching)
2022-09-24 22:14:16 INFO  Starting execution of 1 what-if analyses...
2022-09-24 22:14:16 INFO  Start plan generation for analysis PermutationFeatureImportance...
2022-09-24 22:14:16 INFO  ---RUNTIME: Plan generation took 0.14257431030273438 ms
2022-09-24 22:14:16 INFO  Estimated runtime of original DAG is 6296.325922012329ms
2022-09-24 22:14:16 INFO  Performing Multi-Query Optimization
2022-09-24 22:14:16 INFO  Estimated unoptimized what-if runtime is 31481.629610061646ms
2022-09-24 22:14:16 INFO  Estimated optimised what-if runtime is 7969.912528991699ms
2022-09-24 22:14:16 INFO  Estimated optimisation runtime saving is 23511.717081069946ms
2022-09-24 22:14:16 INFO  ---RUNTIME: Multi-Query Optimization took 11.312007904052734 ms
2022-09-24 22:14:16 INFO  Executing generated plans
2022-09-24 22:14:24 INFO  ---RUNTIME: Execution took 8112.526655197144 ms
2022-09-24 22:14:24 INFO  Done!
2022-09-24 22:14:24 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-24 22:14:24 INFO  Running instrumented original pipeline...
2022-09-24 22:14:25 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-24 22:14:25 INFO  ---RUNTIME: Importing and monkey-patching took 6.23631477355957 ms
2022-09-24 22:14:31 INFO  ---RUNTIME: Original pipeline execution took 6593.367576599121 ms (excluding imports and monkey-patching)
2022-09-24 22:14:31 INFO  Starting execution of 1 what-if analyses...
2022-09-24 22:14:31 INFO  Start plan generation for analysis PermutationFeatureImportance...
2022-09-24 22:14:31 INFO  ---RUNTIME: Plan generation took 0.12683868408203125 ms
2022-09-24 22:14:31 INFO  Estimated runtime of original DAG is 6278.911352157593ms
2022-09-24 22:14:31 WARNING Skipping Multi-Query Optimization (instead, only applying patches)
2022-09-24 22:14:31 INFO  Estimated unoptimised what-if runtime is 31394.556760787964ms
2022-09-24 22:14:31 INFO  ---RUNTIME: Multi-Query Optimization took 4.390954971313477 ms
2022-09-24 22:14:31 INFO  Executing generated plans
2022-09-24 22:15:02 INFO  ---RUNTIME: Execution took 30769.20485496521 ms
2022-09-24 22:15:02 INFO  Done!
2022-09-24 22:15:02 INFO  # Finished -- repetition 2 of 7 
2022-09-24 22:15:02 INFO  # Optimization benchmark for feature_importance with args [['reviews', 'slow_loading', 'featurization_2', 'logistic_regression']] -- repetition 3 of 7
2022-09-24 22:15:02 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-24 22:15:02 INFO  Running instrumented original pipeline...
2022-09-24 22:15:02 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-24 22:15:02 INFO  ---RUNTIME: Importing and monkey-patching took 6.884098052978516 ms
2022-09-24 22:15:08 INFO  ---RUNTIME: Original pipeline execution took 6498.447418212891 ms (excluding imports and monkey-patching)
2022-09-24 22:15:08 INFO  Starting execution of 1 what-if analyses...
2022-09-24 22:15:08 INFO  Start plan generation for analysis PermutationFeatureImportance...
2022-09-24 22:15:08 INFO  ---RUNTIME: Plan generation took 0.1270771026611328 ms
2022-09-24 22:15:08 INFO  Estimated runtime of original DAG is 6180.092811584473ms
2022-09-24 22:15:08 INFO  Performing Multi-Query Optimization
2022-09-24 22:15:08 INFO  Estimated unoptimized what-if runtime is 30900.464057922363ms
2022-09-24 22:15:08 INFO  Estimated optimised what-if runtime is 7764.788866043091ms
2022-09-24 22:15:08 INFO  Estimated optimisation runtime saving is 23135.675191879272ms
2022-09-24 22:15:08 INFO  ---RUNTIME: Multi-Query Optimization took 10.867118835449219 ms
2022-09-24 22:15:08 INFO  Executing generated plans
2022-09-24 22:15:16 INFO  ---RUNTIME: Execution took 7911.174774169922 ms
2022-09-24 22:15:16 INFO  Done!
2022-09-24 22:15:16 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-24 22:15:16 INFO  Running instrumented original pipeline...
2022-09-24 22:15:16 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-24 22:15:16 INFO  ---RUNTIME: Importing and monkey-patching took 6.088495254516602 ms
2022-09-24 22:15:23 INFO  ---RUNTIME: Original pipeline execution took 6400.823354721069 ms (excluding imports and monkey-patching)
2022-09-24 22:15:23 INFO  Starting execution of 1 what-if analyses...
2022-09-24 22:15:23 INFO  Start plan generation for analysis PermutationFeatureImportance...
2022-09-24 22:15:23 INFO  ---RUNTIME: Plan generation took 0.10943412780761719 ms
2022-09-24 22:15:23 INFO  Estimated runtime of original DAG is 6089.757204055786ms
2022-09-24 22:15:23 WARNING Skipping Multi-Query Optimization (instead, only applying patches)
2022-09-24 22:15:23 INFO  Estimated unoptimised what-if runtime is 30448.78602027893ms
2022-09-24 22:15:23 INFO  ---RUNTIME: Multi-Query Optimization took 4.451990127563477 ms
2022-09-24 22:15:23 INFO  Executing generated plans
2022-09-24 22:15:54 INFO  ---RUNTIME: Execution took 30890.595197677612 ms
2022-09-24 22:15:54 INFO  Done!
2022-09-24 22:15:54 INFO  # Finished -- repetition 3 of 7 
2022-09-24 22:15:54 INFO  # Optimization benchmark for feature_importance with args [['reviews', 'slow_loading', 'featurization_2', 'logistic_regression']] -- repetition 4 of 7
2022-09-24 22:15:54 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-24 22:15:54 INFO  Running instrumented original pipeline...
2022-09-24 22:15:54 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-24 22:15:54 INFO  ---RUNTIME: Importing and monkey-patching took 7.079124450683594 ms
2022-09-24 22:16:00 INFO  ---RUNTIME: Original pipeline execution took 6687.621831893921 ms (excluding imports and monkey-patching)
2022-09-24 22:16:00 INFO  Starting execution of 1 what-if analyses...
2022-09-24 22:16:00 INFO  Start plan generation for analysis PermutationFeatureImportance...
2022-09-24 22:16:00 INFO  ---RUNTIME: Plan generation took 0.11372566223144531 ms
2022-09-24 22:16:00 INFO  Estimated runtime of original DAG is 6367.667675018311ms
2022-09-24 22:16:00 INFO  Performing Multi-Query Optimization
2022-09-24 22:16:00 INFO  Estimated unoptimized what-if runtime is 31838.338375091553ms
2022-09-24 22:16:00 INFO  Estimated optimised what-if runtime is 8053.19356918335ms
2022-09-24 22:16:00 INFO  Estimated optimisation runtime saving is 23785.144805908203ms
2022-09-24 22:16:00 INFO  ---RUNTIME: Multi-Query Optimization took 10.642528533935547 ms
2022-09-24 22:16:00 INFO  Executing generated plans
2022-09-24 22:16:08 INFO  ---RUNTIME: Execution took 7843.585252761841 ms
2022-09-24 22:16:08 INFO  Done!
2022-09-24 22:16:08 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-24 22:16:08 INFO  Running instrumented original pipeline...
2022-09-24 22:16:08 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-24 22:16:08 INFO  ---RUNTIME: Importing and monkey-patching took 6.183862686157227 ms
2022-09-24 22:16:15 INFO  ---RUNTIME: Original pipeline execution took 6466.889381408691 ms (excluding imports and monkey-patching)
2022-09-24 22:16:15 INFO  Starting execution of 1 what-if analyses...
2022-09-24 22:16:15 INFO  Start plan generation for analysis PermutationFeatureImportance...
2022-09-24 22:16:15 INFO  ---RUNTIME: Plan generation took 0.10061264038085938 ms
2022-09-24 22:16:15 INFO  Estimated runtime of original DAG is 6144.53125ms
2022-09-24 22:16:15 WARNING Skipping Multi-Query Optimization (instead, only applying patches)
2022-09-24 22:16:15 INFO  Estimated unoptimised what-if runtime is 30722.65625ms
2022-09-24 22:16:15 INFO  ---RUNTIME: Multi-Query Optimization took 4.129648208618164 ms
2022-09-24 22:16:15 INFO  Executing generated plans
2022-09-24 22:16:46 INFO  ---RUNTIME: Execution took 31089.781999588013 ms
2022-09-24 22:16:46 INFO  Done!
2022-09-24 22:16:46 INFO  # Finished -- repetition 4 of 7 
2022-09-24 22:16:46 INFO  # Optimization benchmark for feature_importance with args [['reviews', 'slow_loading', 'featurization_2', 'logistic_regression']] -- repetition 5 of 7
2022-09-24 22:16:46 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-24 22:16:46 INFO  Running instrumented original pipeline...
2022-09-24 22:16:46 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-24 22:16:46 INFO  ---RUNTIME: Importing and monkey-patching took 6.409168243408203 ms
2022-09-24 22:16:52 INFO  ---RUNTIME: Original pipeline execution took 6628.214359283447 ms (excluding imports and monkey-patching)
2022-09-24 22:16:52 INFO  Starting execution of 1 what-if analyses...
2022-09-24 22:16:52 INFO  Start plan generation for analysis PermutationFeatureImportance...
2022-09-24 22:16:52 INFO  ---RUNTIME: Plan generation took 0.12040138244628906 ms
2022-09-24 22:16:52 INFO  Estimated runtime of original DAG is 6312.608480453491ms
2022-09-24 22:16:52 INFO  Performing Multi-Query Optimization
2022-09-24 22:16:52 INFO  Estimated unoptimized what-if runtime is 31563.042402267456ms
2022-09-24 22:16:52 INFO  Estimated optimised what-if runtime is 7930.464744567871ms
2022-09-24 22:16:52 INFO  Estimated optimisation runtime saving is 23632.577657699585ms
2022-09-24 22:16:52 INFO  ---RUNTIME: Multi-Query Optimization took 10.682106018066406 ms
2022-09-24 22:16:52 INFO  Executing generated plans
2022-09-24 22:17:00 INFO  ---RUNTIME: Execution took 7845.443964004517 ms
2022-09-24 22:17:00 INFO  Done!
2022-09-24 22:17:00 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-24 22:17:00 INFO  Running instrumented original pipeline...
2022-09-24 22:17:00 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-24 22:17:00 INFO  ---RUNTIME: Importing and monkey-patching took 6.41632080078125 ms
2022-09-24 22:17:07 INFO  ---RUNTIME: Original pipeline execution took 6345.555782318115 ms (excluding imports and monkey-patching)
2022-09-24 22:17:07 INFO  Starting execution of 1 what-if analyses...
2022-09-24 22:17:07 INFO  Start plan generation for analysis PermutationFeatureImportance...
2022-09-24 22:17:07 INFO  ---RUNTIME: Plan generation took 0.10061264038085938 ms
2022-09-24 22:17:07 INFO  Estimated runtime of original DAG is 6032.901763916016ms
2022-09-24 22:17:07 WARNING Skipping Multi-Query Optimization (instead, only applying patches)
2022-09-24 22:17:07 INFO  Estimated unoptimised what-if runtime is 30164.508819580078ms
2022-09-24 22:17:07 INFO  ---RUNTIME: Multi-Query Optimization took 4.103660583496094 ms
2022-09-24 22:17:07 INFO  Executing generated plans
2022-09-24 22:17:37 INFO  ---RUNTIME: Execution took 30228.337049484253 ms
2022-09-24 22:17:37 INFO  Done!
2022-09-24 22:17:37 INFO  # Finished -- repetition 5 of 7 
2022-09-24 22:17:37 INFO  # Optimization benchmark for feature_importance with args [['reviews', 'slow_loading', 'featurization_2', 'logistic_regression']] -- repetition 6 of 7
2022-09-24 22:17:37 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-24 22:17:37 INFO  Running instrumented original pipeline...
2022-09-24 22:17:37 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-24 22:17:37 INFO  ---RUNTIME: Importing and monkey-patching took 6.544351577758789 ms
2022-09-24 22:17:43 INFO  ---RUNTIME: Original pipeline execution took 6318.126678466797 ms (excluding imports and monkey-patching)
2022-09-24 22:17:43 INFO  Starting execution of 1 what-if analyses...
2022-09-24 22:17:43 INFO  Start plan generation for analysis PermutationFeatureImportance...
2022-09-24 22:17:43 INFO  ---RUNTIME: Plan generation took 0.11754035949707031 ms
2022-09-24 22:17:43 INFO  Estimated runtime of original DAG is 6011.305332183838ms
2022-09-24 22:17:43 INFO  Performing Multi-Query Optimization
2022-09-24 22:17:43 INFO  Estimated unoptimized what-if runtime is 30056.52666091919ms
2022-09-24 22:17:43 INFO  Estimated optimised what-if runtime is 7590.633392333984ms
2022-09-24 22:17:43 INFO  Estimated optimisation runtime saving is 22465.893268585205ms
2022-09-24 22:17:43 INFO  ---RUNTIME: Multi-Query Optimization took 10.868549346923828 ms
2022-09-24 22:17:43 INFO  Executing generated plans
2022-09-24 22:17:51 INFO  ---RUNTIME: Execution took 7630.624532699585 ms
2022-09-24 22:17:51 INFO  Done!
2022-09-24 22:17:51 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-24 22:17:51 INFO  Running instrumented original pipeline...
2022-09-24 22:17:51 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-24 22:17:51 INFO  ---RUNTIME: Importing and monkey-patching took 6.323575973510742 ms
2022-09-24 22:17:57 INFO  ---RUNTIME: Original pipeline execution took 6238.645792007446 ms (excluding imports and monkey-patching)
2022-09-24 22:17:57 INFO  Starting execution of 1 what-if analyses...
2022-09-24 22:17:57 INFO  Start plan generation for analysis PermutationFeatureImportance...
2022-09-24 22:17:57 INFO  ---RUNTIME: Plan generation took 0.10728836059570312 ms
2022-09-24 22:17:57 INFO  Estimated runtime of original DAG is 5934.586763381958ms
2022-09-24 22:17:57 WARNING Skipping Multi-Query Optimization (instead, only applying patches)
2022-09-24 22:17:57 INFO  Estimated unoptimised what-if runtime is 29672.93381690979ms
2022-09-24 22:17:57 INFO  ---RUNTIME: Multi-Query Optimization took 4.096031188964844 ms
2022-09-24 22:17:57 INFO  Executing generated plans
2022-09-24 22:18:29 INFO  ---RUNTIME: Execution took 31498.49796295166 ms
2022-09-24 22:18:29 INFO  Done!
2022-09-24 22:18:29 INFO  # Finished -- repetition 6 of 7 
2022-09-24 22:18:29 INFO  # Optimization benchmark for feature_importance with args [['reviews', 'slow_loading', 'featurization_2', 'logistic_regression']] -- repetition 7 of 7
2022-09-24 22:18:29 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-24 22:18:29 INFO  Running instrumented original pipeline...
2022-09-24 22:18:29 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-24 22:18:29 INFO  ---RUNTIME: Importing and monkey-patching took 6.938457489013672 ms
2022-09-24 22:18:35 INFO  ---RUNTIME: Original pipeline execution took 6405.5445194244385 ms (excluding imports and monkey-patching)
2022-09-24 22:18:35 INFO  Starting execution of 1 what-if analyses...
2022-09-24 22:18:35 INFO  Start plan generation for analysis PermutationFeatureImportance...
2022-09-24 22:18:35 INFO  ---RUNTIME: Plan generation took 0.11801719665527344 ms
2022-09-24 22:18:35 INFO  Estimated runtime of original DAG is 6097.586631774902ms
2022-09-24 22:18:35 INFO  Performing Multi-Query Optimization
2022-09-24 22:18:35 INFO  Estimated unoptimized what-if runtime is 30487.93315887451ms
2022-09-24 22:18:35 INFO  Estimated optimised what-if runtime is 7687.211751937866ms
2022-09-24 22:18:35 INFO  Estimated optimisation runtime saving is 22800.721406936646ms
2022-09-24 22:18:35 INFO  ---RUNTIME: Multi-Query Optimization took 10.729074478149414 ms
2022-09-24 22:18:35 INFO  Executing generated plans
2022-09-24 22:18:43 INFO  ---RUNTIME: Execution took 7710.460901260376 ms
2022-09-24 22:18:43 INFO  Done!
2022-09-24 22:18:43 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-24 22:18:43 INFO  Running instrumented original pipeline...
2022-09-24 22:18:43 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-24 22:18:43 INFO  ---RUNTIME: Importing and monkey-patching took 6.223440170288086 ms
2022-09-24 22:18:49 INFO  ---RUNTIME: Original pipeline execution took 6281.464338302612 ms (excluding imports and monkey-patching)
2022-09-24 22:18:49 INFO  Starting execution of 1 what-if analyses...
2022-09-24 22:18:49 INFO  Start plan generation for analysis PermutationFeatureImportance...
2022-09-24 22:18:49 INFO  ---RUNTIME: Plan generation took 0.10371208190917969 ms
2022-09-24 22:18:49 INFO  Estimated runtime of original DAG is 5981.059551239014ms
2022-09-24 22:18:49 WARNING Skipping Multi-Query Optimization (instead, only applying patches)
2022-09-24 22:18:49 INFO  Estimated unoptimised what-if runtime is 29905.29775619507ms
2022-09-24 22:18:49 INFO  ---RUNTIME: Multi-Query Optimization took 4.2705535888671875 ms
2022-09-24 22:18:49 INFO  Executing generated plans
2022-09-24 22:19:20 INFO  ---RUNTIME: Execution took 30381.168842315674 ms
2022-09-24 22:19:20 INFO  Done!
2022-09-24 22:19:20 INFO  # Finished -- repetition 7 of 7 
2022-09-24 22:19:20 INFO  # Final results after all repetitions
2022-09-24 22:19:20 INFO     repetition  ... no_opt_what_if_execution_combined_model_training
0           0  ...                                       516.822577
1           1  ...                                       540.116310
2           2  ...                                       524.928093
3           3  ...                                       540.399790
4           4  ...                                       479.437113
5           5  ...                                       515.208483
6           6  ...                                       494.134903

[7 rows x 26 columns]
PROTOCOL_BUFFERS_PYTHON_IMPLEMENTATION=python taskset -c 32-39 python3.9 benchmarks_end_to_end.py feature_importance reviews slow_loading featurization_2 xgboost
2022-09-24 22:19:22.195141: W tensorflow/stream_executor/platform/default/dso_loader.cc:64] Could not load dynamic library 'libcudart.so.11.0'; dlerror: libcudart.so.11.0: cannot open shared object file: No such file or directory; LD_LIBRARY_PATH: /home/sgrafbe/mlwhatif/venv/lib/python3.9/site-packages/cv2/../../lib64:
2022-09-24 22:19:22.195186: I tensorflow/stream_executor/cuda/cudart_stub.cc:29] Ignore above cudart dlerror if you do not have a GPU set up on your machine.
2022-09-24 22:19:23 INFO  Patching sys.argv with ['mlwhatif', 'reviews', 'slow_loading', 'featurization_2', 'xgboost']
2022-09-24 22:19:23 INFO  Running instrumented original pipeline...
2022-09-24 22:19:23 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-24 22:19:23 INFO  ---RUNTIME: Importing and monkey-patching took 96.0383415222168 ms
2022-09-24 22:20:04 INFO  ---RUNTIME: Original pipeline execution took 40620.09692192078 ms (excluding imports and monkey-patching)
2022-09-24 22:20:04 INFO  Starting execution of 0 what-if analyses...
2022-09-24 22:20:04 INFO  Estimated runtime of original DAG is 40279.944896698ms
2022-09-24 22:20:04 INFO  Performing Multi-Query Optimization
2022-09-24 22:20:04 INFO  Estimated unoptimized what-if runtime is 0ms
2022-09-24 22:20:04 INFO  Estimated optimised what-if runtime is 0ms
2022-09-24 22:20:04 INFO  Estimated optimisation runtime saving is 0ms
2022-09-24 22:20:04 INFO  ---RUNTIME: Multi-Query Optimization took 0.5452632904052734 ms
2022-09-24 22:20:04 INFO  Executing generated plans
2022-09-24 22:20:04 INFO  ---RUNTIME: Execution took 0.026464462280273438 ms
2022-09-24 22:20:04 INFO  Done!
2022-09-24 22:20:04 INFO  # Optimization benchmark for feature_importance with args [['reviews', 'slow_loading', 'featurization_2', 'xgboost']] -- repetition 1 of 7
2022-09-24 22:20:04 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-24 22:20:04 INFO  Running instrumented original pipeline...
2022-09-24 22:20:04 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-24 22:20:04 INFO  ---RUNTIME: Importing and monkey-patching took 5.667924880981445 ms
2022-09-24 22:20:44 INFO  ---RUNTIME: Original pipeline execution took 40435.61315536499 ms (excluding imports and monkey-patching)
2022-09-24 22:20:44 INFO  Starting execution of 1 what-if analyses...
2022-09-24 22:20:44 INFO  Start plan generation for analysis PermutationFeatureImportance...
2022-09-24 22:20:44 INFO  ---RUNTIME: Plan generation took 0.21219253540039062 ms
2022-09-24 22:20:44 INFO  Estimated runtime of original DAG is 40130.01489639282ms
2022-09-24 22:20:44 INFO  Performing Multi-Query Optimization
2022-09-24 22:20:44 INFO  Estimated unoptimized what-if runtime is 200650.0744819641ms
2022-09-24 22:20:44 INFO  Estimated optimised what-if runtime is 43059.359550476074ms
2022-09-24 22:20:44 INFO  Estimated optimisation runtime saving is 157590.71493148804ms
2022-09-24 22:20:44 INFO  ---RUNTIME: Multi-Query Optimization took 10.771512985229492 ms
2022-09-24 22:20:44 INFO  Executing generated plans
2022-09-24 22:21:27 INFO  ---RUNTIME: Execution took 43194.719314575195 ms
2022-09-24 22:21:27 INFO  Done!
2022-09-24 22:21:27 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-24 22:21:27 INFO  Running instrumented original pipeline...
2022-09-24 22:21:28 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-24 22:21:28 INFO  ---RUNTIME: Importing and monkey-patching took 6.015777587890625 ms
2022-09-24 22:22:08 INFO  ---RUNTIME: Original pipeline execution took 40610.81051826477 ms (excluding imports and monkey-patching)
2022-09-24 22:22:08 INFO  Starting execution of 1 what-if analyses...
2022-09-24 22:22:08 INFO  Start plan generation for analysis PermutationFeatureImportance...
2022-09-24 22:22:08 INFO  ---RUNTIME: Plan generation took 0.13256072998046875 ms
2022-09-24 22:22:08 INFO  Estimated runtime of original DAG is 40111.20820045471ms
2022-09-24 22:22:08 WARNING Skipping Multi-Query Optimization (instead, only applying patches)
2022-09-24 22:22:08 INFO  Estimated unoptimised what-if runtime is 200556.04100227356ms
2022-09-24 22:22:08 INFO  ---RUNTIME: Multi-Query Optimization took 4.279136657714844 ms
2022-09-24 22:22:08 INFO  Executing generated plans
2022-09-24 22:25:30 INFO  ---RUNTIME: Execution took 202262.3872756958 ms
2022-09-24 22:25:30 INFO  Done!
2022-09-24 22:25:30 INFO  # Finished -- repetition 1 of 7 
2022-09-24 22:25:30 INFO  # Optimization benchmark for feature_importance with args [['reviews', 'slow_loading', 'featurization_2', 'xgboost']] -- repetition 2 of 7
2022-09-24 22:25:30 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-24 22:25:30 INFO  Running instrumented original pipeline...
2022-09-24 22:25:30 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-24 22:25:30 INFO  ---RUNTIME: Importing and monkey-patching took 6.687164306640625 ms
2022-09-24 22:26:11 INFO  ---RUNTIME: Original pipeline execution took 40620.10192871094 ms (excluding imports and monkey-patching)
2022-09-24 22:26:11 INFO  Starting execution of 1 what-if analyses...
2022-09-24 22:26:11 INFO  Start plan generation for analysis PermutationFeatureImportance...
2022-09-24 22:26:11 INFO  ---RUNTIME: Plan generation took 0.1418590545654297 ms
2022-09-24 22:26:11 INFO  Estimated runtime of original DAG is 40314.894676208496ms
2022-09-24 22:26:11 INFO  Performing Multi-Query Optimization
2022-09-24 22:26:11 INFO  Estimated unoptimized what-if runtime is 201574.47338104248ms
2022-09-24 22:26:11 INFO  Estimated optimised what-if runtime is 43239.64023590088ms
2022-09-24 22:26:11 INFO  Estimated optimisation runtime saving is 158334.8331451416ms
2022-09-24 22:26:11 INFO  ---RUNTIME: Multi-Query Optimization took 10.757684707641602 ms
2022-09-24 22:26:11 INFO  Executing generated plans
2022-09-24 22:26:54 INFO  ---RUNTIME: Execution took 43254.71591949463 ms
2022-09-24 22:26:54 INFO  Done!
2022-09-24 22:26:54 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-24 22:26:54 INFO  Running instrumented original pipeline...
2022-09-24 22:26:54 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-24 22:26:54 INFO  ---RUNTIME: Importing and monkey-patching took 6.043910980224609 ms
2022-09-24 22:27:35 INFO  ---RUNTIME: Original pipeline execution took 40580.129861831665 ms (excluding imports and monkey-patching)
2022-09-24 22:27:35 INFO  Starting execution of 1 what-if analyses...
2022-09-24 22:27:35 INFO  Start plan generation for analysis PermutationFeatureImportance...
2022-09-24 22:27:35 INFO  ---RUNTIME: Plan generation took 0.13017654418945312 ms
2022-09-24 22:27:35 INFO  Estimated runtime of original DAG is 40271.87132835388ms
2022-09-24 22:27:35 WARNING Skipping Multi-Query Optimization (instead, only applying patches)
2022-09-24 22:27:35 INFO  Estimated unoptimised what-if runtime is 201359.3566417694ms
2022-09-24 22:27:35 INFO  ---RUNTIME: Multi-Query Optimization took 4.276514053344727 ms
2022-09-24 22:27:35 INFO  Executing generated plans
2022-09-24 22:30:57 INFO  ---RUNTIME: Execution took 202495.31507492065 ms
2022-09-24 22:30:57 INFO  Done!
2022-09-24 22:30:57 INFO  # Finished -- repetition 2 of 7 
2022-09-24 22:30:57 INFO  # Optimization benchmark for feature_importance with args [['reviews', 'slow_loading', 'featurization_2', 'xgboost']] -- repetition 3 of 7
2022-09-24 22:30:57 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-24 22:30:57 INFO  Running instrumented original pipeline...
2022-09-24 22:30:57 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-24 22:30:57 INFO  ---RUNTIME: Importing and monkey-patching took 6.540775299072266 ms
2022-09-24 22:31:38 INFO  ---RUNTIME: Original pipeline execution took 40566.9105052948 ms (excluding imports and monkey-patching)
2022-09-24 22:31:38 INFO  Starting execution of 1 what-if analyses...
2022-09-24 22:31:38 INFO  Start plan generation for analysis PermutationFeatureImportance...
2022-09-24 22:31:38 INFO  ---RUNTIME: Plan generation took 0.12731552124023438 ms
2022-09-24 22:31:38 INFO  Estimated runtime of original DAG is 40256.646156311035ms
2022-09-24 22:31:38 INFO  Performing Multi-Query Optimization
2022-09-24 22:31:38 INFO  Estimated unoptimized what-if runtime is 201283.23078155518ms
2022-09-24 22:31:38 INFO  Estimated optimised what-if runtime is 43155.28583526611ms
2022-09-24 22:31:38 INFO  Estimated optimisation runtime saving is 158127.94494628906ms
2022-09-24 22:31:38 INFO  ---RUNTIME: Multi-Query Optimization took 10.77413558959961 ms
2022-09-24 22:31:38 INFO  Executing generated plans
2022-09-24 22:32:21 INFO  ---RUNTIME: Execution took 43223.52981567383 ms
2022-09-24 22:32:21 INFO  Done!
2022-09-24 22:32:21 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-24 22:32:21 INFO  Running instrumented original pipeline...
2022-09-24 22:32:21 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-24 22:32:21 INFO  ---RUNTIME: Importing and monkey-patching took 6.5765380859375 ms
2022-09-24 22:33:02 INFO  ---RUNTIME: Original pipeline execution took 40561.23733520508 ms (excluding imports and monkey-patching)
2022-09-24 22:33:02 INFO  Starting execution of 1 what-if analyses...
2022-09-24 22:33:02 INFO  Start plan generation for analysis PermutationFeatureImportance...
2022-09-24 22:33:02 INFO  ---RUNTIME: Plan generation took 0.11515617370605469 ms
2022-09-24 22:33:02 INFO  Estimated runtime of original DAG is 40257.36212730408ms
2022-09-24 22:33:02 WARNING Skipping Multi-Query Optimization (instead, only applying patches)
2022-09-24 22:33:02 INFO  Estimated unoptimised what-if runtime is 201286.8106365204ms
2022-09-24 22:33:02 INFO  ---RUNTIME: Multi-Query Optimization took 4.097938537597656 ms
2022-09-24 22:33:02 INFO  Executing generated plans
2022-09-24 22:36:23 INFO  ---RUNTIME: Execution took 201503.36813926697 ms
2022-09-24 22:36:23 INFO  Done!
2022-09-24 22:36:23 INFO  # Finished -- repetition 3 of 7 
2022-09-24 22:36:23 INFO  # Optimization benchmark for feature_importance with args [['reviews', 'slow_loading', 'featurization_2', 'xgboost']] -- repetition 4 of 7
2022-09-24 22:36:23 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-24 22:36:23 INFO  Running instrumented original pipeline...
2022-09-24 22:36:23 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-24 22:36:23 INFO  ---RUNTIME: Importing and monkey-patching took 6.402492523193359 ms
2022-09-24 22:37:04 INFO  ---RUNTIME: Original pipeline execution took 40469.2656993866 ms (excluding imports and monkey-patching)
2022-09-24 22:37:04 INFO  Starting execution of 1 what-if analyses...
2022-09-24 22:37:04 INFO  Start plan generation for analysis PermutationFeatureImportance...
2022-09-24 22:37:04 INFO  ---RUNTIME: Plan generation took 0.11444091796875 ms
2022-09-24 22:37:04 INFO  Estimated runtime of original DAG is 40163.230419158936ms
2022-09-24 22:37:04 INFO  Performing Multi-Query Optimization
2022-09-24 22:37:04 INFO  Estimated unoptimized what-if runtime is 200816.15209579468ms
2022-09-24 22:37:04 INFO  Estimated optimised what-if runtime is 43076.74026489258ms
2022-09-24 22:37:04 INFO  Estimated optimisation runtime saving is 157739.4118309021ms
2022-09-24 22:37:04 INFO  ---RUNTIME: Multi-Query Optimization took 10.512113571166992 ms
2022-09-24 22:37:04 INFO  Executing generated plans
2022-09-24 22:37:47 INFO  ---RUNTIME: Execution took 43276.66258811951 ms
2022-09-24 22:37:47 INFO  Done!
2022-09-24 22:37:47 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-24 22:37:47 INFO  Running instrumented original pipeline...
2022-09-24 22:37:47 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-24 22:37:47 INFO  ---RUNTIME: Importing and monkey-patching took 6.422519683837891 ms
2022-09-24 22:38:28 INFO  ---RUNTIME: Original pipeline execution took 40584.53273773193 ms (excluding imports and monkey-patching)
2022-09-24 22:38:28 INFO  Starting execution of 1 what-if analyses...
2022-09-24 22:38:28 INFO  Start plan generation for analysis PermutationFeatureImportance...
2022-09-24 22:38:28 INFO  ---RUNTIME: Plan generation took 0.1163482666015625 ms
2022-09-24 22:38:28 INFO  Estimated runtime of original DAG is 40277.661085128784ms
2022-09-24 22:38:28 WARNING Skipping Multi-Query Optimization (instead, only applying patches)
2022-09-24 22:38:28 INFO  Estimated unoptimised what-if runtime is 201388.30542564392ms
2022-09-24 22:38:28 INFO  ---RUNTIME: Multi-Query Optimization took 4.066705703735352 ms
2022-09-24 22:38:28 INFO  Executing generated plans
2022-09-24 22:41:50 INFO  ---RUNTIME: Execution took 202650.60663223267 ms
2022-09-24 22:41:50 INFO  Done!
2022-09-24 22:41:50 INFO  # Finished -- repetition 4 of 7 
2022-09-24 22:41:50 INFO  # Optimization benchmark for feature_importance with args [['reviews', 'slow_loading', 'featurization_2', 'xgboost']] -- repetition 5 of 7
2022-09-24 22:41:50 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-24 22:41:50 INFO  Running instrumented original pipeline...
2022-09-24 22:41:50 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-24 22:41:50 INFO  ---RUNTIME: Importing and monkey-patching took 6.2847137451171875 ms
2022-09-24 22:42:31 INFO  ---RUNTIME: Original pipeline execution took 40529.34694290161 ms (excluding imports and monkey-patching)
2022-09-24 22:42:31 INFO  Starting execution of 1 what-if analyses...
2022-09-24 22:42:31 INFO  Start plan generation for analysis PermutationFeatureImportance...
2022-09-24 22:42:31 INFO  ---RUNTIME: Plan generation took 0.11992454528808594 ms
2022-09-24 22:42:31 INFO  Estimated runtime of original DAG is 40222.620248794556ms
2022-09-24 22:42:31 INFO  Performing Multi-Query Optimization
2022-09-24 22:42:31 INFO  Estimated unoptimized what-if runtime is 201113.10124397278ms
2022-09-24 22:42:31 INFO  Estimated optimised what-if runtime is 43115.2822971344ms
2022-09-24 22:42:31 INFO  Estimated optimisation runtime saving is 157997.81894683838ms
2022-09-24 22:42:31 INFO  ---RUNTIME: Multi-Query Optimization took 10.481595993041992 ms
2022-09-24 22:42:31 INFO  Executing generated plans
2022-09-24 22:43:14 INFO  ---RUNTIME: Execution took 43178.99513244629 ms
2022-09-24 22:43:14 INFO  Done!
2022-09-24 22:43:14 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-24 22:43:14 INFO  Running instrumented original pipeline...
2022-09-24 22:43:14 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-24 22:43:14 INFO  ---RUNTIME: Importing and monkey-patching took 6.443500518798828 ms
2022-09-24 22:43:55 INFO  ---RUNTIME: Original pipeline execution took 40571.29454612732 ms (excluding imports and monkey-patching)
2022-09-24 22:43:55 INFO  Starting execution of 1 what-if analyses...
2022-09-24 22:43:55 INFO  Start plan generation for analysis PermutationFeatureImportance...
2022-09-24 22:43:55 INFO  ---RUNTIME: Plan generation took 0.11992454528808594 ms
2022-09-24 22:43:55 INFO  Estimated runtime of original DAG is 40264.04023170471ms
2022-09-24 22:43:55 WARNING Skipping Multi-Query Optimization (instead, only applying patches)
2022-09-24 22:43:55 INFO  Estimated unoptimised what-if runtime is 201320.20115852356ms
2022-09-24 22:43:55 INFO  ---RUNTIME: Multi-Query Optimization took 4.070043563842773 ms
2022-09-24 22:43:55 INFO  Executing generated plans
2022-09-24 22:47:16 INFO  ---RUNTIME: Execution took 201760.08892059326 ms
2022-09-24 22:47:16 INFO  Done!
2022-09-24 22:47:16 INFO  # Finished -- repetition 5 of 7 
2022-09-24 22:47:16 INFO  # Optimization benchmark for feature_importance with args [['reviews', 'slow_loading', 'featurization_2', 'xgboost']] -- repetition 6 of 7
2022-09-24 22:47:16 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-24 22:47:16 INFO  Running instrumented original pipeline...
2022-09-24 22:47:16 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-24 22:47:16 INFO  ---RUNTIME: Importing and monkey-patching took 6.432771682739258 ms
2022-09-24 22:47:57 INFO  ---RUNTIME: Original pipeline execution took 40611.93013191223 ms (excluding imports and monkey-patching)
2022-09-24 22:47:57 INFO  Starting execution of 1 what-if analyses...
2022-09-24 22:47:57 INFO  Start plan generation for analysis PermutationFeatureImportance...
2022-09-24 22:47:57 INFO  ---RUNTIME: Plan generation took 0.12087821960449219 ms
2022-09-24 22:47:57 INFO  Estimated runtime of original DAG is 40302.873373031616ms
2022-09-24 22:47:57 INFO  Performing Multi-Query Optimization
2022-09-24 22:47:57 INFO  Estimated unoptimized what-if runtime is 201514.36686515808ms
2022-09-24 22:47:57 INFO  Estimated optimised what-if runtime is 43228.285789489746ms
2022-09-24 22:47:57 INFO  Estimated optimisation runtime saving is 158286.08107566833ms
2022-09-24 22:47:57 INFO  ---RUNTIME: Multi-Query Optimization took 10.70547103881836 ms
2022-09-24 22:47:57 INFO  Executing generated plans
2022-09-24 22:48:40 INFO  ---RUNTIME: Execution took 43371.06227874756 ms
2022-09-24 22:48:40 INFO  Done!
2022-09-24 22:48:40 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-24 22:48:40 INFO  Running instrumented original pipeline...
2022-09-24 22:48:40 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-24 22:48:40 INFO  ---RUNTIME: Importing and monkey-patching took 6.466150283813477 ms
2022-09-24 22:49:21 INFO  ---RUNTIME: Original pipeline execution took 40547.240018844604 ms (excluding imports and monkey-patching)
2022-09-24 22:49:21 INFO  Starting execution of 1 what-if analyses...
2022-09-24 22:49:21 INFO  Start plan generation for analysis PermutationFeatureImportance...
2022-09-24 22:49:21 INFO  ---RUNTIME: Plan generation took 0.125885009765625 ms
2022-09-24 22:49:21 INFO  Estimated runtime of original DAG is 40240.2241230011ms
2022-09-24 22:49:21 WARNING Skipping Multi-Query Optimization (instead, only applying patches)
2022-09-24 22:49:21 INFO  Estimated unoptimised what-if runtime is 201201.1206150055ms
2022-09-24 22:49:21 INFO  ---RUNTIME: Multi-Query Optimization took 4.260063171386719 ms
2022-09-24 22:49:21 INFO  Executing generated plans
2022-09-24 22:52:43 INFO  ---RUNTIME: Execution took 202288.17892074585 ms
2022-09-24 22:52:43 INFO  Done!
2022-09-24 22:52:43 INFO  # Finished -- repetition 6 of 7 
2022-09-24 22:52:43 INFO  # Optimization benchmark for feature_importance with args [['reviews', 'slow_loading', 'featurization_2', 'xgboost']] -- repetition 7 of 7
2022-09-24 22:52:43 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-24 22:52:43 INFO  Running instrumented original pipeline...
2022-09-24 22:52:43 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-24 22:52:43 INFO  ---RUNTIME: Importing and monkey-patching took 6.868600845336914 ms
2022-09-24 22:53:24 INFO  ---RUNTIME: Original pipeline execution took 40554.819107055664 ms (excluding imports and monkey-patching)
2022-09-24 22:53:24 INFO  Starting execution of 1 what-if analyses...
2022-09-24 22:53:24 INFO  Start plan generation for analysis PermutationFeatureImportance...
2022-09-24 22:53:24 INFO  ---RUNTIME: Plan generation took 0.1201629638671875 ms
2022-09-24 22:53:24 INFO  Estimated runtime of original DAG is 40248.18253517151ms
2022-09-24 22:53:24 INFO  Performing Multi-Query Optimization
2022-09-24 22:53:24 INFO  Estimated unoptimized what-if runtime is 201240.91267585754ms
2022-09-24 22:53:24 INFO  Estimated optimised what-if runtime is 43160.84098815918ms
2022-09-24 22:53:24 INFO  Estimated optimisation runtime saving is 158080.07168769836ms
2022-09-24 22:53:24 INFO  ---RUNTIME: Multi-Query Optimization took 10.445833206176758 ms
2022-09-24 22:53:24 INFO  Executing generated plans
2022-09-24 22:54:07 INFO  ---RUNTIME: Execution took 43143.75066757202 ms
2022-09-24 22:54:07 INFO  Done!
2022-09-24 22:54:07 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-24 22:54:07 INFO  Running instrumented original pipeline...
2022-09-24 22:54:07 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-24 22:54:07 INFO  ---RUNTIME: Importing and monkey-patching took 6.490468978881836 ms
2022-09-24 22:54:47 INFO  ---RUNTIME: Original pipeline execution took 40530.24888038635 ms (excluding imports and monkey-patching)
2022-09-24 22:54:47 INFO  Starting execution of 1 what-if analyses...
2022-09-24 22:54:47 INFO  Start plan generation for analysis PermutationFeatureImportance...
2022-09-24 22:54:47 INFO  ---RUNTIME: Plan generation took 0.12111663818359375 ms
2022-09-24 22:54:47 INFO  Estimated runtime of original DAG is 40220.447301864624ms
2022-09-24 22:54:47 WARNING Skipping Multi-Query Optimization (instead, only applying patches)
2022-09-24 22:54:47 INFO  Estimated unoptimised what-if runtime is 201102.23650932312ms
2022-09-24 22:54:47 INFO  ---RUNTIME: Multi-Query Optimization took 4.225730895996094 ms
2022-09-24 22:54:47 INFO  Executing generated plans
2022-09-24 22:58:09 INFO  ---RUNTIME: Execution took 201665.01760482788 ms
2022-09-24 22:58:09 INFO  Done!
2022-09-24 22:58:09 INFO  # Finished -- repetition 7 of 7 
2022-09-24 22:58:09 INFO  # Final results after all repetitions
2022-09-24 22:58:09 INFO     repetition  ... no_opt_what_if_execution_combined_model_training
0           0  ...                                    169972.515583
1           1  ...                                    170580.560923
2           2  ...                                    170388.044119
3           3  ...                                    170698.039055
4           4  ...                                    170417.604446
5           5  ...                                    170477.798939
6           6  ...                                    170440.064669

[7 rows x 26 columns]
PROTOCOL_BUFFERS_PYTHON_IMPLEMENTATION=python taskset -c 32-39 python3.9 benchmarks_end_to_end.py feature_importance reviews slow_loading featurization_2 neural_network
2022-09-24 22:58:11.793341: W tensorflow/stream_executor/platform/default/dso_loader.cc:64] Could not load dynamic library 'libcudart.so.11.0'; dlerror: libcudart.so.11.0: cannot open shared object file: No such file or directory; LD_LIBRARY_PATH: /home/sgrafbe/mlwhatif/venv/lib/python3.9/site-packages/cv2/../../lib64:
2022-09-24 22:58:11.793388: I tensorflow/stream_executor/cuda/cudart_stub.cc:29] Ignore above cudart dlerror if you do not have a GPU set up on your machine.
2022-09-24 22:58:13 INFO  Patching sys.argv with ['mlwhatif', 'reviews', 'slow_loading', 'featurization_2', 'neural_network']
2022-09-24 22:58:13 INFO  Running instrumented original pipeline...
2022-09-24 22:58:13 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-24 22:58:13 INFO  ---RUNTIME: Importing and monkey-patching took 96.59695625305176 ms
2022-09-24 22:58:17.961597: W tensorflow/stream_executor/platform/default/dso_loader.cc:64] Could not load dynamic library 'libcuda.so.1'; dlerror: libcuda.so.1: cannot open shared object file: No such file or directory; LD_LIBRARY_PATH: /home/sgrafbe/mlwhatif/venv/lib/python3.9/site-packages/cv2/../../lib64:
2022-09-24 22:58:17.961633: W tensorflow/stream_executor/cuda/cuda_driver.cc:326] failed call to cuInit: UNKNOWN ERROR (303)
2022-09-24 22:58:17.961656: I tensorflow/stream_executor/cuda/cuda_diagnostics.cc:156] kernel driver does not appear to be running on this host (wagyu): /proc/driver/nvidia/version does not exist
2022-09-24 22:58:17.962170: I tensorflow/core/platform/cpu_feature_guard.cc:142] This TensorFlow binary is optimized with oneAPI Deep Neural Network Library (oneDNN) to use the following CPU instructions in performance-critical operations:  AVX2 FMA
To enable them in other operations, rebuild TensorFlow with the appropriate compiler flags.
2022-09-24 22:58:18.579164: I tensorflow/compiler/mlir/mlir_graph_optimization_pass.cc:176] None of the MLIR Optimization Passes are enabled (registered 2)
2022-09-24 22:58:18.593371: I tensorflow/core/platform/profile_utils/cpu_utils.cc:114] CPU Frequency: 2595290000 Hz
2022-09-24 22:58:26 INFO  ---RUNTIME: Original pipeline execution took 13270.9379196167 ms (excluding imports and monkey-patching)
2022-09-24 22:58:26 INFO  Starting execution of 0 what-if analyses...
2022-09-24 22:58:26 INFO  Estimated runtime of original DAG is 12930.341005325317ms
2022-09-24 22:58:26 INFO  Performing Multi-Query Optimization
2022-09-24 22:58:26 INFO  Estimated unoptimized what-if runtime is 0ms
2022-09-24 22:58:26 INFO  Estimated optimised what-if runtime is 0ms
2022-09-24 22:58:26 INFO  Estimated optimisation runtime saving is 0ms
2022-09-24 22:58:26 INFO  ---RUNTIME: Multi-Query Optimization took 0.5619525909423828 ms
2022-09-24 22:58:26 INFO  Executing generated plans
2022-09-24 22:58:26 INFO  ---RUNTIME: Execution took 0.023603439331054688 ms
2022-09-24 22:58:26 INFO  Done!
2022-09-24 22:58:26 INFO  # Optimization benchmark for feature_importance with args [['reviews', 'slow_loading', 'featurization_2', 'neural_network']] -- repetition 1 of 7
2022-09-24 22:58:26 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-24 22:58:26 INFO  Running instrumented original pipeline...
2022-09-24 22:58:26 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-24 22:58:26 INFO  ---RUNTIME: Importing and monkey-patching took 5.640983581542969 ms
2022-09-24 22:58:39 INFO  ---RUNTIME: Original pipeline execution took 12902.71258354187 ms (excluding imports and monkey-patching)
2022-09-24 22:58:39 INFO  Starting execution of 1 what-if analyses...
2022-09-24 22:58:39 INFO  Start plan generation for analysis PermutationFeatureImportance...
2022-09-24 22:58:39 INFO  ---RUNTIME: Plan generation took 0.24700164794921875 ms
2022-09-24 22:58:39 INFO  Estimated runtime of original DAG is 12592.092514038086ms
2022-09-24 22:58:39 INFO  Performing Multi-Query Optimization
2022-09-24 22:58:39 INFO  Estimated unoptimized what-if runtime is 62960.46257019043ms
2022-09-24 22:58:39 INFO  Estimated optimised what-if runtime is 17219.75326538086ms
2022-09-24 22:58:39 INFO  Estimated optimisation runtime saving is 45740.70930480957ms
2022-09-24 22:58:39 INFO  ---RUNTIME: Multi-Query Optimization took 11.111259460449219 ms
2022-09-24 22:58:39 INFO  Executing generated plans
2022-09-24 22:58:56 INFO  ---RUNTIME: Execution took 16919.249057769775 ms
2022-09-24 22:58:56 INFO  Done!
2022-09-24 22:58:56 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-24 22:58:56 INFO  Running instrumented original pipeline...
2022-09-24 22:58:56 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-24 22:58:56 INFO  ---RUNTIME: Importing and monkey-patching took 6.354808807373047 ms
2022-09-24 22:59:09 INFO  ---RUNTIME: Original pipeline execution took 13129.067182540894 ms (excluding imports and monkey-patching)
2022-09-24 22:59:09 INFO  Starting execution of 1 what-if analyses...
2022-09-24 22:59:09 INFO  Start plan generation for analysis PermutationFeatureImportance...
2022-09-24 22:59:09 INFO  ---RUNTIME: Plan generation took 0.11706352233886719 ms
2022-09-24 22:59:09 INFO  Estimated runtime of original DAG is 12818.987846374512ms
2022-09-24 22:59:09 WARNING Skipping Multi-Query Optimization (instead, only applying patches)
2022-09-24 22:59:09 INFO  Estimated unoptimised what-if runtime is 64094.93923187256ms
2022-09-24 22:59:09 INFO  ---RUNTIME: Multi-Query Optimization took 4.917383193969727 ms
2022-09-24 22:59:09 INFO  Executing generated plans
2022-09-24 23:00:13 INFO  ---RUNTIME: Execution took 64003.740072250366 ms
2022-09-24 23:00:13 INFO  Done!
2022-09-24 23:00:13 INFO  # Finished -- repetition 1 of 7 
2022-09-24 23:00:13 INFO  # Optimization benchmark for feature_importance with args [['reviews', 'slow_loading', 'featurization_2', 'neural_network']] -- repetition 2 of 7
2022-09-24 23:00:13 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-24 23:00:13 INFO  Running instrumented original pipeline...
2022-09-24 23:00:13 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-24 23:00:13 INFO  ---RUNTIME: Importing and monkey-patching took 6.131172180175781 ms
2022-09-24 23:00:26 INFO  ---RUNTIME: Original pipeline execution took 13482.806921005249 ms (excluding imports and monkey-patching)
2022-09-24 23:00:26 INFO  Starting execution of 1 what-if analyses...
2022-09-24 23:00:26 INFO  Start plan generation for analysis PermutationFeatureImportance...
2022-09-24 23:00:26 INFO  ---RUNTIME: Plan generation took 0.1354217529296875 ms
2022-09-24 23:00:26 INFO  Estimated runtime of original DAG is 13165.731191635132ms
2022-09-24 23:00:26 INFO  Performing Multi-Query Optimization
2022-09-24 23:00:26 INFO  Estimated unoptimized what-if runtime is 65828.65595817566ms
2022-09-24 23:00:26 INFO  Estimated optimised what-if runtime is 17816.70045852661ms
2022-09-24 23:00:26 INFO  Estimated optimisation runtime saving is 48011.95549964905ms
2022-09-24 23:00:26 INFO  ---RUNTIME: Multi-Query Optimization took 11.66987419128418 ms
2022-09-24 23:00:26 INFO  Executing generated plans
2022-09-24 23:00:43 INFO  ---RUNTIME: Execution took 16882.78603553772 ms
2022-09-24 23:00:43 INFO  Done!
2022-09-24 23:00:43 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-24 23:00:43 INFO  Running instrumented original pipeline...
2022-09-24 23:00:43 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-24 23:00:43 INFO  ---RUNTIME: Importing and monkey-patching took 6.443977355957031 ms
2022-09-24 23:00:56 INFO  ---RUNTIME: Original pipeline execution took 12956.701755523682 ms (excluding imports and monkey-patching)
2022-09-24 23:00:56 INFO  Starting execution of 1 what-if analyses...
2022-09-24 23:00:56 INFO  Start plan generation for analysis PermutationFeatureImportance...
2022-09-24 23:00:56 INFO  ---RUNTIME: Plan generation took 0.12135505676269531 ms
2022-09-24 23:00:56 INFO  Estimated runtime of original DAG is 12636.693477630615ms
2022-09-24 23:00:56 WARNING Skipping Multi-Query Optimization (instead, only applying patches)
2022-09-24 23:00:56 INFO  Estimated unoptimised what-if runtime is 63183.467388153076ms
2022-09-24 23:00:56 INFO  ---RUNTIME: Multi-Query Optimization took 4.213094711303711 ms
2022-09-24 23:00:56 INFO  Executing generated plans
2022-09-24 23:02:00 INFO  ---RUNTIME: Execution took 64009.007692337036 ms
2022-09-24 23:02:00 INFO  Done!
2022-09-24 23:02:00 INFO  # Finished -- repetition 2 of 7 
2022-09-24 23:02:00 INFO  # Optimization benchmark for feature_importance with args [['reviews', 'slow_loading', 'featurization_2', 'neural_network']] -- repetition 3 of 7
2022-09-24 23:02:00 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-24 23:02:00 INFO  Running instrumented original pipeline...
2022-09-24 23:02:00 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-24 23:02:00 INFO  ---RUNTIME: Importing and monkey-patching took 6.562232971191406 ms
2022-09-24 23:02:13 INFO  ---RUNTIME: Original pipeline execution took 12823.47321510315 ms (excluding imports and monkey-patching)
2022-09-24 23:02:13 INFO  Starting execution of 1 what-if analyses...
2022-09-24 23:02:13 INFO  Start plan generation for analysis PermutationFeatureImportance...
2022-09-24 23:02:13 INFO  ---RUNTIME: Plan generation took 0.1442432403564453 ms
2022-09-24 23:02:13 INFO  Estimated runtime of original DAG is 12503.282070159912ms
2022-09-24 23:02:13 INFO  Performing Multi-Query Optimization
2022-09-24 23:02:13 INFO  Estimated unoptimized what-if runtime is 62516.41035079956ms
2022-09-24 23:02:13 INFO  Estimated optimised what-if runtime is 17016.599655151367ms
2022-09-24 23:02:13 INFO  Estimated optimisation runtime saving is 45499.81069564819ms
2022-09-24 23:02:13 INFO  ---RUNTIME: Multi-Query Optimization took 10.956048965454102 ms
2022-09-24 23:02:13 INFO  Executing generated plans
2022-09-24 23:02:31 INFO  ---RUNTIME: Execution took 17768.78046989441 ms
2022-09-24 23:02:31 INFO  Done!
2022-09-24 23:02:31 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-24 23:02:31 INFO  Running instrumented original pipeline...
2022-09-24 23:02:31 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-24 23:02:31 INFO  ---RUNTIME: Importing and monkey-patching took 6.313562393188477 ms
2022-09-24 23:02:44 INFO  ---RUNTIME: Original pipeline execution took 12832.042455673218 ms (excluding imports and monkey-patching)
2022-09-24 23:02:44 INFO  Starting execution of 1 what-if analyses...
2022-09-24 23:02:44 INFO  Start plan generation for analysis PermutationFeatureImportance...
2022-09-24 23:02:44 INFO  ---RUNTIME: Plan generation took 0.11301040649414062 ms
2022-09-24 23:02:44 INFO  Estimated runtime of original DAG is 12505.53297996521ms
2022-09-24 23:02:44 WARNING Skipping Multi-Query Optimization (instead, only applying patches)
2022-09-24 23:02:44 INFO  Estimated unoptimised what-if runtime is 62527.66489982605ms
2022-09-24 23:02:44 INFO  ---RUNTIME: Multi-Query Optimization took 4.109859466552734 ms
2022-09-24 23:02:44 INFO  Executing generated plans
2022-09-24 23:03:48 INFO  ---RUNTIME: Execution took 63814.27264213562 ms
2022-09-24 23:03:48 INFO  Done!
2022-09-24 23:03:48 INFO  # Finished -- repetition 3 of 7 
2022-09-24 23:03:48 INFO  # Optimization benchmark for feature_importance with args [['reviews', 'slow_loading', 'featurization_2', 'neural_network']] -- repetition 4 of 7
2022-09-24 23:03:48 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-24 23:03:48 INFO  Running instrumented original pipeline...
2022-09-24 23:03:48 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-24 23:03:48 INFO  ---RUNTIME: Importing and monkey-patching took 6.61015510559082 ms
2022-09-24 23:04:00 INFO  ---RUNTIME: Original pipeline execution took 12738.852739334106 ms (excluding imports and monkey-patching)
2022-09-24 23:04:00 INFO  Starting execution of 1 what-if analyses...
2022-09-24 23:04:00 INFO  Start plan generation for analysis PermutationFeatureImportance...
2022-09-24 23:04:00 INFO  ---RUNTIME: Plan generation took 0.11491775512695312 ms
2022-09-24 23:04:00 INFO  Estimated runtime of original DAG is 12409.796714782715ms
2022-09-24 23:04:00 INFO  Performing Multi-Query Optimization
2022-09-24 23:04:00 INFO  Estimated unoptimized what-if runtime is 62048.983573913574ms
2022-09-24 23:04:00 INFO  Estimated optimised what-if runtime is 16955.293655395508ms
2022-09-24 23:04:00 INFO  Estimated optimisation runtime saving is 45093.68991851807ms
2022-09-24 23:04:00 INFO  ---RUNTIME: Multi-Query Optimization took 10.619163513183594 ms
2022-09-24 23:04:00 INFO  Executing generated plans
2022-09-24 23:04:18 INFO  ---RUNTIME: Execution took 17268.090963363647 ms
2022-09-24 23:04:18 INFO  Done!
2022-09-24 23:04:18 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-24 23:04:18 INFO  Running instrumented original pipeline...
2022-09-24 23:04:18 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-24 23:04:18 INFO  ---RUNTIME: Importing and monkey-patching took 6.227016448974609 ms
2022-09-24 23:04:31 INFO  ---RUNTIME: Original pipeline execution took 13059.861183166504 ms (excluding imports and monkey-patching)
2022-09-24 23:04:31 INFO  Starting execution of 1 what-if analyses...
2022-09-24 23:04:31 INFO  Start plan generation for analysis PermutationFeatureImportance...
2022-09-24 23:04:31 INFO  ---RUNTIME: Plan generation took 0.11086463928222656 ms
2022-09-24 23:04:31 INFO  Estimated runtime of original DAG is 12737.400770187378ms
2022-09-24 23:04:31 WARNING Skipping Multi-Query Optimization (instead, only applying patches)
2022-09-24 23:04:31 INFO  Estimated unoptimised what-if runtime is 63687.00385093689ms
2022-09-24 23:04:31 INFO  ---RUNTIME: Multi-Query Optimization took 4.252195358276367 ms
2022-09-24 23:04:31 INFO  Executing generated plans
2022-09-24 23:05:36 INFO  ---RUNTIME: Execution took 64885.78414916992 ms
2022-09-24 23:05:36 INFO  Done!
2022-09-24 23:05:36 INFO  # Finished -- repetition 4 of 7 
2022-09-24 23:05:36 INFO  # Optimization benchmark for feature_importance with args [['reviews', 'slow_loading', 'featurization_2', 'neural_network']] -- repetition 5 of 7
2022-09-24 23:05:36 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-24 23:05:36 INFO  Running instrumented original pipeline...
2022-09-24 23:05:36 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-24 23:05:36 INFO  ---RUNTIME: Importing and monkey-patching took 6.9522857666015625 ms
2022-09-24 23:05:49 INFO  ---RUNTIME: Original pipeline execution took 12887.834310531616 ms (excluding imports and monkey-patching)
2022-09-24 23:05:49 INFO  Starting execution of 1 what-if analyses...
2022-09-24 23:05:49 INFO  Start plan generation for analysis PermutationFeatureImportance...
2022-09-24 23:05:49 INFO  ---RUNTIME: Plan generation took 0.12755393981933594 ms
2022-09-24 23:05:49 INFO  Estimated runtime of original DAG is 12566.41149520874ms
2022-09-24 23:05:49 INFO  Performing Multi-Query Optimization
2022-09-24 23:05:49 INFO  Estimated unoptimized what-if runtime is 62832.0574760437ms
2022-09-24 23:05:49 INFO  Estimated optimised what-if runtime is 17080.06763458252ms
2022-09-24 23:05:49 INFO  Estimated optimisation runtime saving is 45751.98984146118ms
2022-09-24 23:05:49 INFO  ---RUNTIME: Multi-Query Optimization took 10.806083679199219 ms
2022-09-24 23:05:49 INFO  Executing generated plans
2022-09-24 23:06:06 INFO  ---RUNTIME: Execution took 17469.54369544983 ms
2022-09-24 23:06:06 INFO  Done!
2022-09-24 23:06:06 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-24 23:06:06 INFO  Running instrumented original pipeline...
2022-09-24 23:06:06 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-24 23:06:06 INFO  ---RUNTIME: Importing and monkey-patching took 6.682872772216797 ms
2022-09-24 23:06:19 INFO  ---RUNTIME: Original pipeline execution took 12961.955070495605 ms (excluding imports and monkey-patching)
2022-09-24 23:06:19 INFO  Starting execution of 1 what-if analyses...
2022-09-24 23:06:19 INFO  Start plan generation for analysis PermutationFeatureImportance...
2022-09-24 23:06:19 INFO  ---RUNTIME: Plan generation took 0.14901161193847656 ms
2022-09-24 23:06:19 INFO  Estimated runtime of original DAG is 12634.846925735474ms
2022-09-24 23:06:19 WARNING Skipping Multi-Query Optimization (instead, only applying patches)
2022-09-24 23:06:19 INFO  Estimated unoptimised what-if runtime is 63174.23462867737ms
2022-09-24 23:06:19 INFO  ---RUNTIME: Multi-Query Optimization took 5.3558349609375 ms
2022-09-24 23:06:19 INFO  Executing generated plans
2022-09-24 23:07:23 INFO  ---RUNTIME: Execution took 64162.62340545654 ms
2022-09-24 23:07:23 INFO  Done!
2022-09-24 23:07:23 INFO  # Finished -- repetition 5 of 7 
2022-09-24 23:07:23 INFO  # Optimization benchmark for feature_importance with args [['reviews', 'slow_loading', 'featurization_2', 'neural_network']] -- repetition 6 of 7
2022-09-24 23:07:23 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-24 23:07:23 INFO  Running instrumented original pipeline...
2022-09-24 23:07:23 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-24 23:07:23 INFO  ---RUNTIME: Importing and monkey-patching took 6.11424446105957 ms
2022-09-24 23:07:36 INFO  ---RUNTIME: Original pipeline execution took 13079.056739807129 ms (excluding imports and monkey-patching)
2022-09-24 23:07:36 INFO  Starting execution of 1 what-if analyses...
2022-09-24 23:07:36 INFO  Start plan generation for analysis PermutationFeatureImportance...
2022-09-24 23:07:36 INFO  ---RUNTIME: Plan generation took 0.1308917999267578 ms
2022-09-24 23:07:36 INFO  Estimated runtime of original DAG is 12753.720998764038ms
2022-09-24 23:07:36 INFO  Performing Multi-Query Optimization
2022-09-24 23:07:36 INFO  Estimated unoptimized what-if runtime is 63768.60499382019ms
2022-09-24 23:07:36 INFO  Estimated optimised what-if runtime is 17514.834880828857ms
2022-09-24 23:07:36 INFO  Estimated optimisation runtime saving is 46253.77011299133ms
2022-09-24 23:07:36 INFO  ---RUNTIME: Multi-Query Optimization took 11.702299118041992 ms
2022-09-24 23:07:36 INFO  Executing generated plans
2022-09-24 23:07:53 INFO  ---RUNTIME: Execution took 17051.409006118774 ms
2022-09-24 23:07:53 INFO  Done!
2022-09-24 23:07:53 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-24 23:07:53 INFO  Running instrumented original pipeline...
2022-09-24 23:07:53 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-24 23:07:53 INFO  ---RUNTIME: Importing and monkey-patching took 6.169557571411133 ms
2022-09-24 23:08:06 INFO  ---RUNTIME: Original pipeline execution took 13021.432876586914 ms (excluding imports and monkey-patching)
2022-09-24 23:08:06 INFO  Starting execution of 1 what-if analyses...
2022-09-24 23:08:06 INFO  Start plan generation for analysis PermutationFeatureImportance...
2022-09-24 23:08:06 INFO  ---RUNTIME: Plan generation took 0.10848045349121094 ms
2022-09-24 23:08:06 INFO  Estimated runtime of original DAG is 12698.15969467163ms
2022-09-24 23:08:06 WARNING Skipping Multi-Query Optimization (instead, only applying patches)
2022-09-24 23:08:06 INFO  Estimated unoptimised what-if runtime is 63490.798473358154ms
2022-09-24 23:08:06 INFO  ---RUNTIME: Multi-Query Optimization took 4.187345504760742 ms
2022-09-24 23:08:06 INFO  Executing generated plans
2022-09-24 23:09:11 INFO  ---RUNTIME: Execution took 64250.93626976013 ms
2022-09-24 23:09:11 INFO  Done!
2022-09-24 23:09:11 INFO  # Finished -- repetition 6 of 7 
2022-09-24 23:09:11 INFO  # Optimization benchmark for feature_importance with args [['reviews', 'slow_loading', 'featurization_2', 'neural_network']] -- repetition 7 of 7
2022-09-24 23:09:11 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-24 23:09:11 INFO  Running instrumented original pipeline...
2022-09-24 23:09:11 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-24 23:09:11 INFO  ---RUNTIME: Importing and monkey-patching took 6.065130233764648 ms
2022-09-24 23:09:24 INFO  ---RUNTIME: Original pipeline execution took 13092.405557632446 ms (excluding imports and monkey-patching)
2022-09-24 23:09:24 INFO  Starting execution of 1 what-if analyses...
2022-09-24 23:09:24 INFO  Start plan generation for analysis PermutationFeatureImportance...
2022-09-24 23:09:24 INFO  ---RUNTIME: Plan generation took 0.13566017150878906 ms
2022-09-24 23:09:24 INFO  Estimated runtime of original DAG is 12764.423608779907ms
2022-09-24 23:09:24 INFO  Performing Multi-Query Optimization
2022-09-24 23:09:24 INFO  Estimated unoptimized what-if runtime is 63822.118043899536ms
2022-09-24 23:09:24 INFO  Estimated optimised what-if runtime is 17470.475673675537ms
2022-09-24 23:09:24 INFO  Estimated optimisation runtime saving is 46351.642370224ms
2022-09-24 23:09:24 INFO  ---RUNTIME: Multi-Query Optimization took 10.788917541503906 ms
2022-09-24 23:09:24 INFO  Executing generated plans
2022-09-24 23:09:41 INFO  ---RUNTIME: Execution took 17585.20793914795 ms
2022-09-24 23:09:41 INFO  Done!
2022-09-24 23:09:41 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-24 23:09:41 INFO  Running instrumented original pipeline...
2022-09-24 23:09:41 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-24 23:09:41 INFO  ---RUNTIME: Importing and monkey-patching took 6.035327911376953 ms
2022-09-24 23:09:54 INFO  ---RUNTIME: Original pipeline execution took 12859.028816223145 ms (excluding imports and monkey-patching)
2022-09-24 23:09:54 INFO  Starting execution of 1 what-if analyses...
2022-09-24 23:09:54 INFO  Start plan generation for analysis PermutationFeatureImportance...
2022-09-24 23:09:54 INFO  ---RUNTIME: Plan generation took 0.10037422180175781 ms
2022-09-24 23:09:54 INFO  Estimated runtime of original DAG is 12537.381649017334ms
2022-09-24 23:09:54 WARNING Skipping Multi-Query Optimization (instead, only applying patches)
2022-09-24 23:09:54 INFO  Estimated unoptimised what-if runtime is 62686.90824508667ms
2022-09-24 23:09:54 INFO  ---RUNTIME: Multi-Query Optimization took 4.987955093383789 ms
2022-09-24 23:09:54 INFO  Executing generated plans
2022-09-24 23:10:59 INFO  ---RUNTIME: Execution took 64302.406311035156 ms
2022-09-24 23:10:59 INFO  Done!
2022-09-24 23:10:59 INFO  # Finished -- repetition 7 of 7 
2022-09-24 23:10:59 INFO  # Final results after all repetitions
2022-09-24 23:10:59 INFO     repetition  ... no_opt_what_if_execution_combined_model_training
0           0  ...                                     30185.091734
1           1  ...                                     30351.638556
2           2  ...                                     29842.096329
3           3  ...                                     29942.332983
4           4  ...                                     30362.937689
5           5  ...                                     30312.494516
6           6  ...                                     29506.402493

[7 rows x 26 columns]
PROTOCOL_BUFFERS_PYTHON_IMPLEMENTATION=python taskset -c 32-39 python3.9 benchmarks_end_to_end.py feature_importance reviews slow_loading featurization_3 logistic_regression
2022-09-24 23:11:01.768599: W tensorflow/stream_executor/platform/default/dso_loader.cc:64] Could not load dynamic library 'libcudart.so.11.0'; dlerror: libcudart.so.11.0: cannot open shared object file: No such file or directory; LD_LIBRARY_PATH: /home/sgrafbe/mlwhatif/venv/lib/python3.9/site-packages/cv2/../../lib64:
2022-09-24 23:11:01.768641: I tensorflow/stream_executor/cuda/cudart_stub.cc:29] Ignore above cudart dlerror if you do not have a GPU set up on your machine.
2022-09-24 23:11:03 INFO  Patching sys.argv with ['mlwhatif', 'reviews', 'slow_loading', 'featurization_3', 'logistic_regression']
2022-09-24 23:11:03 INFO  Running instrumented original pipeline...
2022-09-24 23:11:03 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-24 23:11:03 INFO  ---RUNTIME: Importing and monkey-patching took 96.35543823242188 ms
2022-09-24 23:11:13 INFO  ---RUNTIME: Original pipeline execution took 10088.259220123291 ms (excluding imports and monkey-patching)
2022-09-24 23:11:13 INFO  Starting execution of 0 what-if analyses...
2022-09-24 23:11:13 INFO  Estimated runtime of original DAG is 9692.74878501892ms
2022-09-24 23:11:13 INFO  Performing Multi-Query Optimization
2022-09-24 23:11:13 INFO  Estimated unoptimized what-if runtime is 0ms
2022-09-24 23:11:13 INFO  Estimated optimised what-if runtime is 0ms
2022-09-24 23:11:13 INFO  Estimated optimisation runtime saving is 0ms
2022-09-24 23:11:13 INFO  ---RUNTIME: Multi-Query Optimization took 0.5996227264404297 ms
2022-09-24 23:11:13 INFO  Executing generated plans
2022-09-24 23:11:13 INFO  ---RUNTIME: Execution took 0.029087066650390625 ms
2022-09-24 23:11:13 INFO  Done!
2022-09-24 23:11:13 INFO  # Optimization benchmark for feature_importance with args [['reviews', 'slow_loading', 'featurization_3', 'logistic_regression']] -- repetition 1 of 7
2022-09-24 23:11:13 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-24 23:11:13 INFO  Running instrumented original pipeline...
2022-09-24 23:11:13 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-24 23:11:13 INFO  ---RUNTIME: Importing and monkey-patching took 5.960941314697266 ms
2022-09-24 23:11:23 INFO  ---RUNTIME: Original pipeline execution took 9971.234798431396 ms (excluding imports and monkey-patching)
2022-09-24 23:11:23 INFO  Starting execution of 1 what-if analyses...
2022-09-24 23:11:23 INFO  Start plan generation for analysis PermutationFeatureImportance...
2022-09-24 23:11:23 INFO  ---RUNTIME: Plan generation took 0.2570152282714844 ms
2022-09-24 23:11:23 INFO  Estimated runtime of original DAG is 9611.632347106934ms
2022-09-24 23:11:23 INFO  Performing Multi-Query Optimization
2022-09-24 23:11:23 INFO  Estimated unoptimized what-if runtime is 48058.16173553467ms
2022-09-24 23:11:23 INFO  Estimated optimised what-if runtime is 13035.411834716797ms
2022-09-24 23:11:23 INFO  Estimated optimisation runtime saving is 35022.74990081787ms
2022-09-24 23:11:23 INFO  ---RUNTIME: Multi-Query Optimization took 17.858266830444336 ms
2022-09-24 23:11:23 INFO  Executing generated plans
2022-09-24 23:11:36 INFO  ---RUNTIME: Execution took 13023.35238456726 ms
2022-09-24 23:11:36 INFO  Done!
2022-09-24 23:11:36 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-24 23:11:36 INFO  Running instrumented original pipeline...
2022-09-24 23:11:36 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-24 23:11:36 INFO  ---RUNTIME: Importing and monkey-patching took 6.01649284362793 ms
2022-09-24 23:11:46 INFO  ---RUNTIME: Original pipeline execution took 10221.727132797241 ms (excluding imports and monkey-patching)
2022-09-24 23:11:46 INFO  Starting execution of 1 what-if analyses...
2022-09-24 23:11:46 INFO  Start plan generation for analysis PermutationFeatureImportance...
2022-09-24 23:11:46 INFO  ---RUNTIME: Plan generation took 0.118255615234375 ms
2022-09-24 23:11:46 INFO  Estimated runtime of original DAG is 9634.13143157959ms
2022-09-24 23:11:46 WARNING Skipping Multi-Query Optimization (instead, only applying patches)
2022-09-24 23:11:46 INFO  Estimated unoptimised what-if runtime is 48170.65715789795ms
2022-09-24 23:11:46 INFO  ---RUNTIME: Multi-Query Optimization took 5.581378936767578 ms
2022-09-24 23:11:46 INFO  Executing generated plans
2022-09-24 23:12:34 INFO  ---RUNTIME: Execution took 48195.29175758362 ms
2022-09-24 23:12:34 INFO  Done!
2022-09-24 23:12:34 INFO  # Finished -- repetition 1 of 7 
2022-09-24 23:12:34 INFO  # Optimization benchmark for feature_importance with args [['reviews', 'slow_loading', 'featurization_3', 'logistic_regression']] -- repetition 2 of 7
2022-09-24 23:12:34 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-24 23:12:34 INFO  Running instrumented original pipeline...
2022-09-24 23:12:34 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-24 23:12:34 INFO  ---RUNTIME: Importing and monkey-patching took 6.289482116699219 ms
2022-09-24 23:12:44 INFO  ---RUNTIME: Original pipeline execution took 9989.711999893188 ms (excluding imports and monkey-patching)
2022-09-24 23:12:44 INFO  Starting execution of 1 what-if analyses...
2022-09-24 23:12:44 INFO  Start plan generation for analysis PermutationFeatureImportance...
2022-09-24 23:12:44 INFO  ---RUNTIME: Plan generation took 0.1270771026611328 ms
2022-09-24 23:12:44 INFO  Estimated runtime of original DAG is 9641.737699508667ms
2022-09-24 23:12:44 INFO  Performing Multi-Query Optimization
2022-09-24 23:12:44 INFO  Estimated unoptimized what-if runtime is 48208.688497543335ms
2022-09-24 23:12:44 INFO  Estimated optimised what-if runtime is 13061.570405960083ms
2022-09-24 23:12:44 INFO  Estimated optimisation runtime saving is 35147.11809158325ms
2022-09-24 23:12:44 INFO  ---RUNTIME: Multi-Query Optimization took 23.601770401000977 ms
2022-09-24 23:12:44 INFO  Executing generated plans
2022-09-24 23:12:57 INFO  ---RUNTIME: Execution took 13011.08980178833 ms
2022-09-24 23:12:57 INFO  Done!
2022-09-24 23:12:57 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-24 23:12:57 INFO  Running instrumented original pipeline...
2022-09-24 23:12:57 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-24 23:12:57 INFO  ---RUNTIME: Importing and monkey-patching took 6.119012832641602 ms
2022-09-24 23:13:07 INFO  ---RUNTIME: Original pipeline execution took 9966.552019119263 ms (excluding imports and monkey-patching)
2022-09-24 23:13:07 INFO  Starting execution of 1 what-if analyses...
2022-09-24 23:13:07 INFO  Start plan generation for analysis PermutationFeatureImportance...
2022-09-24 23:13:07 INFO  ---RUNTIME: Plan generation took 0.12612342834472656 ms
2022-09-24 23:13:07 INFO  Estimated runtime of original DAG is 9619.92859840393ms
2022-09-24 23:13:07 WARNING Skipping Multi-Query Optimization (instead, only applying patches)
2022-09-24 23:13:07 INFO  Estimated unoptimised what-if runtime is 48099.64299201965ms
2022-09-24 23:13:07 INFO  ---RUNTIME: Multi-Query Optimization took 4.742860794067383 ms
2022-09-24 23:13:07 INFO  Executing generated plans
2022-09-24 23:13:55 INFO  ---RUNTIME: Execution took 48155.01141548157 ms
2022-09-24 23:13:55 INFO  Done!
2022-09-24 23:13:55 INFO  # Finished -- repetition 2 of 7 
2022-09-24 23:13:55 INFO  # Optimization benchmark for feature_importance with args [['reviews', 'slow_loading', 'featurization_3', 'logistic_regression']] -- repetition 3 of 7
2022-09-24 23:13:55 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-24 23:13:55 INFO  Running instrumented original pipeline...
2022-09-24 23:13:55 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-24 23:13:55 INFO  ---RUNTIME: Importing and monkey-patching took 6.422281265258789 ms
2022-09-24 23:14:05 INFO  ---RUNTIME: Original pipeline execution took 9988.312482833862 ms (excluding imports and monkey-patching)
2022-09-24 23:14:05 INFO  Starting execution of 1 what-if analyses...
2022-09-24 23:14:05 INFO  Start plan generation for analysis PermutationFeatureImportance...
2022-09-24 23:14:05 INFO  ---RUNTIME: Plan generation took 0.1251697540283203 ms
2022-09-24 23:14:05 INFO  Estimated runtime of original DAG is 9639.191627502441ms
2022-09-24 23:14:05 INFO  Performing Multi-Query Optimization
2022-09-24 23:14:05 INFO  Estimated unoptimized what-if runtime is 48195.95813751221ms
2022-09-24 23:14:05 INFO  Estimated optimised what-if runtime is 13055.843830108643ms
2022-09-24 23:14:05 INFO  Estimated optimisation runtime saving is 35140.114307403564ms
2022-09-24 23:14:05 INFO  ---RUNTIME: Multi-Query Optimization took 17.538070678710938 ms
2022-09-24 23:14:05 INFO  Executing generated plans
2022-09-24 23:14:18 INFO  ---RUNTIME: Execution took 13023.61536026001 ms
2022-09-24 23:14:18 INFO  Done!
2022-09-24 23:14:19 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-24 23:14:19 INFO  Running instrumented original pipeline...
2022-09-24 23:14:19 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-24 23:14:19 INFO  ---RUNTIME: Importing and monkey-patching took 6.090402603149414 ms
2022-09-24 23:14:29 INFO  ---RUNTIME: Original pipeline execution took 9969.748973846436 ms (excluding imports and monkey-patching)
2022-09-24 23:14:29 INFO  Starting execution of 1 what-if analyses...
2022-09-24 23:14:29 INFO  Start plan generation for analysis PermutationFeatureImportance...
2022-09-24 23:14:29 INFO  ---RUNTIME: Plan generation took 0.11038780212402344 ms
2022-09-24 23:14:29 INFO  Estimated runtime of original DAG is 9612.704753875732ms
2022-09-24 23:14:29 WARNING Skipping Multi-Query Optimization (instead, only applying patches)
2022-09-24 23:14:29 INFO  Estimated unoptimised what-if runtime is 48063.52376937866ms
2022-09-24 23:14:29 INFO  ---RUNTIME: Multi-Query Optimization took 5.483388900756836 ms
2022-09-24 23:14:29 INFO  Executing generated plans
2022-09-24 23:15:17 INFO  ---RUNTIME: Execution took 48165.97628593445 ms
2022-09-24 23:15:17 INFO  Done!
2022-09-24 23:15:17 INFO  # Finished -- repetition 3 of 7 
2022-09-24 23:15:17 INFO  # Optimization benchmark for feature_importance with args [['reviews', 'slow_loading', 'featurization_3', 'logistic_regression']] -- repetition 4 of 7
2022-09-24 23:15:17 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-24 23:15:17 INFO  Running instrumented original pipeline...
2022-09-24 23:15:17 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-24 23:15:17 INFO  ---RUNTIME: Importing and monkey-patching took 6.387472152709961 ms
2022-09-24 23:15:27 INFO  ---RUNTIME: Original pipeline execution took 10013.608932495117 ms (excluding imports and monkey-patching)
2022-09-24 23:15:27 INFO  Starting execution of 1 what-if analyses...
2022-09-24 23:15:27 INFO  Start plan generation for analysis PermutationFeatureImportance...
2022-09-24 23:15:27 INFO  ---RUNTIME: Plan generation took 0.1316070556640625 ms
2022-09-24 23:15:27 INFO  Estimated runtime of original DAG is 9660.764932632446ms
2022-09-24 23:15:27 INFO  Performing Multi-Query Optimization
2022-09-24 23:15:27 INFO  Estimated unoptimized what-if runtime is 48303.82466316223ms
2022-09-24 23:15:27 INFO  Estimated optimised what-if runtime is 13079.525470733643ms
2022-09-24 23:15:27 INFO  Estimated optimisation runtime saving is 35224.29919242859ms
2022-09-24 23:15:27 INFO  ---RUNTIME: Multi-Query Optimization took 12.511014938354492 ms
2022-09-24 23:15:27 INFO  Executing generated plans
2022-09-24 23:15:40 INFO  ---RUNTIME: Execution took 13056.082487106323 ms
2022-09-24 23:15:40 INFO  Done!
2022-09-24 23:15:40 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-24 23:15:40 INFO  Running instrumented original pipeline...
2022-09-24 23:15:40 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-24 23:15:40 INFO  ---RUNTIME: Importing and monkey-patching took 6.227254867553711 ms
2022-09-24 23:15:51 INFO  ---RUNTIME: Original pipeline execution took 10694.79250907898 ms (excluding imports and monkey-patching)
2022-09-24 23:15:51 INFO  Starting execution of 1 what-if analyses...
2022-09-24 23:15:51 INFO  Start plan generation for analysis PermutationFeatureImportance...
2022-09-24 23:15:51 INFO  ---RUNTIME: Plan generation took 0.12731552124023438 ms
2022-09-24 23:15:51 INFO  Estimated runtime of original DAG is 10347.752571105957ms
2022-09-24 23:15:51 WARNING Skipping Multi-Query Optimization (instead, only applying patches)
2022-09-24 23:15:51 INFO  Estimated unoptimised what-if runtime is 51738.762855529785ms
2022-09-24 23:15:51 INFO  ---RUNTIME: Multi-Query Optimization took 9.948968887329102 ms
2022-09-24 23:15:51 INFO  Executing generated plans
2022-09-24 23:16:39 INFO  ---RUNTIME: Execution took 48073.94313812256 ms
2022-09-24 23:16:39 INFO  Done!
2022-09-24 23:16:39 INFO  # Finished -- repetition 4 of 7 
2022-09-24 23:16:39 INFO  # Optimization benchmark for feature_importance with args [['reviews', 'slow_loading', 'featurization_3', 'logistic_regression']] -- repetition 5 of 7
2022-09-24 23:16:39 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-24 23:16:39 INFO  Running instrumented original pipeline...
2022-09-24 23:16:39 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-24 23:16:39 INFO  ---RUNTIME: Importing and monkey-patching took 6.054878234863281 ms
2022-09-24 23:16:49 INFO  ---RUNTIME: Original pipeline execution took 10241.805791854858 ms (excluding imports and monkey-patching)
2022-09-24 23:16:49 INFO  Starting execution of 1 what-if analyses...
2022-09-24 23:16:49 INFO  Start plan generation for analysis PermutationFeatureImportance...
2022-09-24 23:16:49 INFO  ---RUNTIME: Plan generation took 0.11706352233886719 ms
2022-09-24 23:16:49 INFO  Estimated runtime of original DAG is 9583.704710006714ms
2022-09-24 23:16:49 INFO  Performing Multi-Query Optimization
2022-09-24 23:16:49 INFO  Estimated unoptimized what-if runtime is 47918.52355003357ms
2022-09-24 23:16:49 INFO  Estimated optimised what-if runtime is 13005.3551197052ms
2022-09-24 23:16:49 INFO  Estimated optimisation runtime saving is 34913.16843032837ms
2022-09-24 23:16:49 INFO  ---RUNTIME: Multi-Query Optimization took 12.446165084838867 ms
2022-09-24 23:16:49 INFO  Executing generated plans
2022-09-24 23:17:02 INFO  ---RUNTIME: Execution took 13080.970764160156 ms
2022-09-24 23:17:02 INFO  Done!
2022-09-24 23:17:02 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-24 23:17:02 INFO  Running instrumented original pipeline...
2022-09-24 23:17:02 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-24 23:17:02 INFO  ---RUNTIME: Importing and monkey-patching took 5.913972854614258 ms
2022-09-24 23:17:12 INFO  ---RUNTIME: Original pipeline execution took 9966.476202011108 ms (excluding imports and monkey-patching)
2022-09-24 23:17:12 INFO  Starting execution of 1 what-if analyses...
2022-09-24 23:17:12 INFO  Start plan generation for analysis PermutationFeatureImportance...
2022-09-24 23:17:12 INFO  ---RUNTIME: Plan generation took 0.10013580322265625 ms
2022-09-24 23:17:12 INFO  Estimated runtime of original DAG is 9622.438430786133ms
2022-09-24 23:17:12 WARNING Skipping Multi-Query Optimization (instead, only applying patches)
2022-09-24 23:17:12 INFO  Estimated unoptimised what-if runtime is 48112.192153930664ms
2022-09-24 23:17:12 INFO  ---RUNTIME: Multi-Query Optimization took 9.777307510375977 ms
2022-09-24 23:17:12 INFO  Executing generated plans
2022-09-24 23:18:00 INFO  ---RUNTIME: Execution took 47994.980573654175 ms
2022-09-24 23:18:00 INFO  Done!
2022-09-24 23:18:00 INFO  # Finished -- repetition 5 of 7 
2022-09-24 23:18:00 INFO  # Optimization benchmark for feature_importance with args [['reviews', 'slow_loading', 'featurization_3', 'logistic_regression']] -- repetition 6 of 7
2022-09-24 23:18:00 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-24 23:18:00 INFO  Running instrumented original pipeline...
2022-09-24 23:18:00 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-24 23:18:00 INFO  ---RUNTIME: Importing and monkey-patching took 6.294965744018555 ms
2022-09-24 23:18:10 INFO  ---RUNTIME: Original pipeline execution took 9915.021657943726 ms (excluding imports and monkey-patching)
2022-09-24 23:18:10 INFO  Starting execution of 1 what-if analyses...
2022-09-24 23:18:10 INFO  Start plan generation for analysis PermutationFeatureImportance...
2022-09-24 23:18:10 INFO  ---RUNTIME: Plan generation took 0.13136863708496094 ms
2022-09-24 23:18:10 INFO  Estimated runtime of original DAG is 9567.250728607178ms
2022-09-24 23:18:10 INFO  Performing Multi-Query Optimization
2022-09-24 23:18:10 INFO  Estimated unoptimized what-if runtime is 47836.25364303589ms
2022-09-24 23:18:10 INFO  Estimated optimised what-if runtime is 12980.128288269043ms
2022-09-24 23:18:10 INFO  Estimated optimisation runtime saving is 34856.125354766846ms
2022-09-24 23:18:10 INFO  ---RUNTIME: Multi-Query Optimization took 12.602567672729492 ms
2022-09-24 23:18:10 INFO  Executing generated plans
2022-09-24 23:18:23 INFO  ---RUNTIME: Execution took 13016.32022857666 ms
2022-09-24 23:18:23 INFO  Done!
2022-09-24 23:18:23 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-24 23:18:23 INFO  Running instrumented original pipeline...
2022-09-24 23:18:23 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-24 23:18:23 INFO  ---RUNTIME: Importing and monkey-patching took 6.122350692749023 ms
2022-09-24 23:18:33 INFO  ---RUNTIME: Original pipeline execution took 10048.335552215576 ms (excluding imports and monkey-patching)
2022-09-24 23:18:33 INFO  Starting execution of 1 what-if analyses...
2022-09-24 23:18:33 INFO  Start plan generation for analysis PermutationFeatureImportance...
2022-09-24 23:18:33 INFO  ---RUNTIME: Plan generation took 0.1595020294189453 ms
2022-09-24 23:18:33 INFO  Estimated runtime of original DAG is 9686.878204345703ms
2022-09-24 23:18:33 WARNING Skipping Multi-Query Optimization (instead, only applying patches)
2022-09-24 23:18:33 INFO  Estimated unoptimised what-if runtime is 48434.391021728516ms
2022-09-24 23:18:33 INFO  ---RUNTIME: Multi-Query Optimization took 4.877328872680664 ms
2022-09-24 23:18:33 INFO  Executing generated plans
2022-09-24 23:19:21 INFO  ---RUNTIME: Execution took 48161.49044036865 ms
2022-09-24 23:19:21 INFO  Done!
2022-09-24 23:19:21 INFO  # Finished -- repetition 6 of 7 
2022-09-24 23:19:21 INFO  # Optimization benchmark for feature_importance with args [['reviews', 'slow_loading', 'featurization_3', 'logistic_regression']] -- repetition 7 of 7
2022-09-24 23:19:21 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-24 23:19:21 INFO  Running instrumented original pipeline...
2022-09-24 23:19:21 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-24 23:19:21 INFO  ---RUNTIME: Importing and monkey-patching took 6.472349166870117 ms
2022-09-24 23:19:31 INFO  ---RUNTIME: Original pipeline execution took 9837.463855743408 ms (excluding imports and monkey-patching)
2022-09-24 23:19:31 INFO  Starting execution of 1 what-if analyses...
2022-09-24 23:19:31 INFO  Start plan generation for analysis PermutationFeatureImportance...
2022-09-24 23:19:31 INFO  ---RUNTIME: Plan generation took 0.12111663818359375 ms
2022-09-24 23:19:31 INFO  Estimated runtime of original DAG is 9488.813877105713ms
2022-09-24 23:19:31 INFO  Performing Multi-Query Optimization
2022-09-24 23:19:31 INFO  Estimated unoptimized what-if runtime is 47444.069385528564ms
2022-09-24 23:19:31 INFO  Estimated optimised what-if runtime is 12916.65530204773ms
2022-09-24 23:19:31 INFO  Estimated optimisation runtime saving is 34527.414083480835ms
2022-09-24 23:19:31 INFO  ---RUNTIME: Multi-Query Optimization took 17.82059669494629 ms
2022-09-24 23:19:31 INFO  Executing generated plans
2022-09-24 23:19:44 INFO  ---RUNTIME: Execution took 13021.411895751953 ms
2022-09-24 23:19:44 INFO  Done!
2022-09-24 23:19:44 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-24 23:19:44 INFO  Running instrumented original pipeline...
2022-09-24 23:19:44 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-24 23:19:44 INFO  ---RUNTIME: Importing and monkey-patching took 5.980014801025391 ms
2022-09-24 23:19:54 INFO  ---RUNTIME: Original pipeline execution took 9963.819980621338 ms (excluding imports and monkey-patching)
2022-09-24 23:19:54 INFO  Starting execution of 1 what-if analyses...
2022-09-24 23:19:54 INFO  Start plan generation for analysis PermutationFeatureImportance...
2022-09-24 23:19:54 INFO  ---RUNTIME: Plan generation took 0.11944770812988281 ms
2022-09-24 23:19:54 INFO  Estimated runtime of original DAG is 9619.259357452393ms
2022-09-24 23:19:54 WARNING Skipping Multi-Query Optimization (instead, only applying patches)
2022-09-24 23:19:54 INFO  Estimated unoptimised what-if runtime is 48096.29678726196ms
2022-09-24 23:19:54 INFO  ---RUNTIME: Multi-Query Optimization took 4.739522933959961 ms
2022-09-24 23:19:54 INFO  Executing generated plans
2022-09-24 23:20:43 INFO  ---RUNTIME: Execution took 48261.83104515076 ms
2022-09-24 23:20:43 INFO  Done!
2022-09-24 23:20:43 INFO  # Finished -- repetition 7 of 7 
2022-09-24 23:20:43 INFO  # Final results after all repetitions
2022-09-24 23:20:43 INFO     repetition  ... no_opt_what_if_execution_combined_model_training
0           0  ...                                       457.865000
1           1  ...                                       446.449757
2           2  ...                                       448.523045
3           3  ...                                       445.798874
4           4  ...                                       446.408272
5           5  ...                                       438.864946
6           6  ...                                       446.632624

[7 rows x 26 columns]
PROTOCOL_BUFFERS_PYTHON_IMPLEMENTATION=python taskset -c 32-39 python3.9 benchmarks_end_to_end.py feature_importance reviews slow_loading featurization_3 xgboost
2022-09-24 23:20:45.547622: W tensorflow/stream_executor/platform/default/dso_loader.cc:64] Could not load dynamic library 'libcudart.so.11.0'; dlerror: libcudart.so.11.0: cannot open shared object file: No such file or directory; LD_LIBRARY_PATH: /home/sgrafbe/mlwhatif/venv/lib/python3.9/site-packages/cv2/../../lib64:
2022-09-24 23:20:45.547663: I tensorflow/stream_executor/cuda/cudart_stub.cc:29] Ignore above cudart dlerror if you do not have a GPU set up on your machine.
2022-09-24 23:20:46 INFO  Patching sys.argv with ['mlwhatif', 'reviews', 'slow_loading', 'featurization_3', 'xgboost']
2022-09-24 23:20:46 INFO  Running instrumented original pipeline...
2022-09-24 23:20:46 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-24 23:20:46 INFO  ---RUNTIME: Importing and monkey-patching took 96.78316116333008 ms
2022-09-24 23:21:31 INFO  ---RUNTIME: Original pipeline execution took 44490.66972732544 ms (excluding imports and monkey-patching)
2022-09-24 23:21:31 INFO  Starting execution of 0 what-if analyses...
2022-09-24 23:21:31 INFO  Estimated runtime of original DAG is 44114.41779136658ms
2022-09-24 23:21:31 INFO  Performing Multi-Query Optimization
2022-09-24 23:21:31 INFO  Estimated unoptimized what-if runtime is 0ms
2022-09-24 23:21:31 INFO  Estimated optimised what-if runtime is 0ms
2022-09-24 23:21:31 INFO  Estimated optimisation runtime saving is 0ms
2022-09-24 23:21:31 INFO  ---RUNTIME: Multi-Query Optimization took 0.5846023559570312 ms
2022-09-24 23:21:31 INFO  Executing generated plans
2022-09-24 23:21:31 INFO  ---RUNTIME: Execution took 0.030040740966796875 ms
2022-09-24 23:21:31 INFO  Done!
2022-09-24 23:21:31 INFO  # Optimization benchmark for feature_importance with args [['reviews', 'slow_loading', 'featurization_3', 'xgboost']] -- repetition 1 of 7
2022-09-24 23:21:31 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-24 23:21:31 INFO  Running instrumented original pipeline...
2022-09-24 23:21:31 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-24 23:21:31 INFO  ---RUNTIME: Importing and monkey-patching took 6.402015686035156 ms
2022-09-24 23:22:15 INFO  ---RUNTIME: Original pipeline execution took 43793.81775856018 ms (excluding imports and monkey-patching)
2022-09-24 23:22:15 INFO  Starting execution of 1 what-if analyses...
2022-09-24 23:22:15 INFO  Start plan generation for analysis PermutationFeatureImportance...
2022-09-24 23:22:15 INFO  ---RUNTIME: Plan generation took 0.2665519714355469 ms
2022-09-24 23:22:15 INFO  Estimated runtime of original DAG is 43440.37961959839ms
2022-09-24 23:22:15 INFO  Performing Multi-Query Optimization
2022-09-24 23:22:15 INFO  Estimated unoptimized what-if runtime is 217201.89809799194ms
2022-09-24 23:22:15 INFO  Estimated optimised what-if runtime is 48212.0840549469ms
2022-09-24 23:22:15 INFO  Estimated optimisation runtime saving is 168989.81404304504ms
2022-09-24 23:22:15 INFO  ---RUNTIME: Multi-Query Optimization took 24.56355094909668 ms
2022-09-24 23:22:15 INFO  Executing generated plans
2022-09-24 23:23:03 INFO  ---RUNTIME: Execution took 48105.836153030396 ms
2022-09-24 23:23:03 INFO  Done!
2022-09-24 23:23:03 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-24 23:23:03 INFO  Running instrumented original pipeline...
2022-09-24 23:23:03 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-24 23:23:03 INFO  ---RUNTIME: Importing and monkey-patching took 6.023168563842773 ms
2022-09-24 23:23:47 INFO  ---RUNTIME: Original pipeline execution took 44082.44848251343 ms (excluding imports and monkey-patching)
2022-09-24 23:23:47 INFO  Starting execution of 1 what-if analyses...
2022-09-24 23:23:47 INFO  Start plan generation for analysis PermutationFeatureImportance...
2022-09-24 23:23:47 INFO  ---RUNTIME: Plan generation took 0.14543533325195312 ms
2022-09-24 23:23:47 INFO  Estimated runtime of original DAG is 43511.04164123535ms
2022-09-24 23:23:47 WARNING Skipping Multi-Query Optimization (instead, only applying patches)
2022-09-24 23:23:47 INFO  Estimated unoptimised what-if runtime is 217555.20820617676ms
2022-09-24 23:23:47 INFO  ---RUNTIME: Multi-Query Optimization took 7.042646408081055 ms
2022-09-24 23:23:47 INFO  Executing generated plans
2022-09-24 23:27:25 INFO  ---RUNTIME: Execution took 217598.7560749054 ms
2022-09-24 23:27:25 INFO  Done!
2022-09-24 23:27:25 INFO  # Finished -- repetition 1 of 7 
2022-09-24 23:27:25 INFO  # Optimization benchmark for feature_importance with args [['reviews', 'slow_loading', 'featurization_3', 'xgboost']] -- repetition 2 of 7
2022-09-24 23:27:25 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-24 23:27:25 INFO  Running instrumented original pipeline...
2022-09-24 23:27:25 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-24 23:27:25 INFO  ---RUNTIME: Importing and monkey-patching took 6.41632080078125 ms
2022-09-24 23:28:08 INFO  ---RUNTIME: Original pipeline execution took 43801.35941505432 ms (excluding imports and monkey-patching)
2022-09-24 23:28:08 INFO  Starting execution of 1 what-if analyses...
2022-09-24 23:28:08 INFO  Start plan generation for analysis PermutationFeatureImportance...
2022-09-24 23:28:08 INFO  ---RUNTIME: Plan generation took 0.17595291137695312 ms
2022-09-24 23:28:08 INFO  Estimated runtime of original DAG is 43459.34343338013ms
2022-09-24 23:28:08 INFO  Performing Multi-Query Optimization
2022-09-24 23:28:08 INFO  Estimated unoptimized what-if runtime is 217296.71716690063ms
2022-09-24 23:28:08 INFO  Estimated optimised what-if runtime is 48246.55342102051ms
2022-09-24 23:28:08 INFO  Estimated optimisation runtime saving is 169050.16374588013ms
2022-09-24 23:28:08 INFO  ---RUNTIME: Multi-Query Optimization took 14.769315719604492 ms
2022-09-24 23:28:08 INFO  Executing generated plans
2022-09-24 23:28:57 INFO  ---RUNTIME: Execution took 48216.24445915222 ms
2022-09-24 23:28:57 INFO  Done!
2022-09-24 23:28:57 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-24 23:28:57 INFO  Running instrumented original pipeline...
2022-09-24 23:28:57 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-24 23:28:57 INFO  ---RUNTIME: Importing and monkey-patching took 7.07697868347168 ms
2022-09-24 23:29:40 INFO  ---RUNTIME: Original pipeline execution took 43709.78355407715 ms (excluding imports and monkey-patching)
2022-09-24 23:29:40 INFO  Starting execution of 1 what-if analyses...
2022-09-24 23:29:40 INFO  Start plan generation for analysis PermutationFeatureImportance...
2022-09-24 23:29:40 INFO  ---RUNTIME: Plan generation took 0.14019012451171875 ms
2022-09-24 23:29:40 INFO  Estimated runtime of original DAG is 43359.83324050903ms
2022-09-24 23:29:40 WARNING Skipping Multi-Query Optimization (instead, only applying patches)
2022-09-24 23:29:40 INFO  Estimated unoptimised what-if runtime is 216799.16620254517ms
2022-09-24 23:29:40 INFO  ---RUNTIME: Multi-Query Optimization took 5.668401718139648 ms
2022-09-24 23:29:40 INFO  Executing generated plans
2022-09-24 23:33:18 INFO  ---RUNTIME: Execution took 217625.89120864868 ms
2022-09-24 23:33:18 INFO  Done!
2022-09-24 23:33:18 INFO  # Finished -- repetition 2 of 7 
2022-09-24 23:33:18 INFO  # Optimization benchmark for feature_importance with args [['reviews', 'slow_loading', 'featurization_3', 'xgboost']] -- repetition 3 of 7
2022-09-24 23:33:18 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-24 23:33:18 INFO  Running instrumented original pipeline...
2022-09-24 23:33:18 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-24 23:33:18 INFO  ---RUNTIME: Importing and monkey-patching took 6.596088409423828 ms
2022-09-24 23:34:02 INFO  ---RUNTIME: Original pipeline execution took 43978.976011276245 ms (excluding imports and monkey-patching)
2022-09-24 23:34:02 INFO  Starting execution of 1 what-if analyses...
2022-09-24 23:34:02 INFO  Start plan generation for analysis PermutationFeatureImportance...
2022-09-24 23:34:02 INFO  ---RUNTIME: Plan generation took 0.1442432403564453 ms
2022-09-24 23:34:02 INFO  Estimated runtime of original DAG is 43633.88895988464ms
2022-09-24 23:34:02 INFO  Performing Multi-Query Optimization
2022-09-24 23:34:02 INFO  Estimated unoptimized what-if runtime is 218169.44479942322ms
2022-09-24 23:34:02 INFO  Estimated optimised what-if runtime is 48586.978912353516ms
2022-09-24 23:34:02 INFO  Estimated optimisation runtime saving is 169582.4658870697ms
2022-09-24 23:34:02 INFO  ---RUNTIME: Multi-Query Optimization took 21.07524871826172 ms
2022-09-24 23:34:02 INFO  Executing generated plans
2022-09-24 23:34:51 INFO  ---RUNTIME: Execution took 48680.79471588135 ms
2022-09-24 23:34:51 INFO  Done!
2022-09-24 23:34:51 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-24 23:34:51 INFO  Running instrumented original pipeline...
2022-09-24 23:34:51 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-24 23:34:51 INFO  ---RUNTIME: Importing and monkey-patching took 6.948947906494141 ms
2022-09-24 23:35:36 INFO  ---RUNTIME: Original pipeline execution took 44840.08431434631 ms (excluding imports and monkey-patching)
2022-09-24 23:35:36 INFO  Starting execution of 1 what-if analyses...
2022-09-24 23:35:36 INFO  Start plan generation for analysis PermutationFeatureImportance...
2022-09-24 23:35:36 INFO  ---RUNTIME: Plan generation took 0.1804828643798828 ms
2022-09-24 23:35:36 INFO  Estimated runtime of original DAG is 44488.343715667725ms
2022-09-24 23:35:36 WARNING Skipping Multi-Query Optimization (instead, only applying patches)
2022-09-24 23:35:36 INFO  Estimated unoptimised what-if runtime is 222441.71857833862ms
2022-09-24 23:35:36 INFO  ---RUNTIME: Multi-Query Optimization took 5.706548690795898 ms
2022-09-24 23:35:36 INFO  Executing generated plans
2022-09-24 23:39:16 INFO  ---RUNTIME: Execution took 220470.52574157715 ms
2022-09-24 23:39:16 INFO  Done!
2022-09-24 23:39:16 INFO  # Finished -- repetition 3 of 7 
2022-09-24 23:39:16 INFO  # Optimization benchmark for feature_importance with args [['reviews', 'slow_loading', 'featurization_3', 'xgboost']] -- repetition 4 of 7
2022-09-24 23:39:16 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-24 23:39:16 INFO  Running instrumented original pipeline...
2022-09-24 23:39:16 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-24 23:39:16 INFO  ---RUNTIME: Importing and monkey-patching took 6.495237350463867 ms
2022-09-24 23:40:00 INFO  ---RUNTIME: Original pipeline execution took 44251.238107681274 ms (excluding imports and monkey-patching)
2022-09-24 23:40:00 INFO  Starting execution of 1 what-if analyses...
2022-09-24 23:40:00 INFO  Start plan generation for analysis PermutationFeatureImportance...
2022-09-24 23:40:00 INFO  ---RUNTIME: Plan generation took 0.141143798828125 ms
2022-09-24 23:40:00 INFO  Estimated runtime of original DAG is 43910.50577163696ms
2022-09-24 23:40:00 INFO  Performing Multi-Query Optimization
2022-09-24 23:40:00 INFO  Estimated unoptimized what-if runtime is 219552.5288581848ms
2022-09-24 23:40:00 INFO  Estimated optimised what-if runtime is 48659.653663635254ms
2022-09-24 23:40:00 INFO  Estimated optimisation runtime saving is 170892.87519454956ms
2022-09-24 23:40:00 INFO  ---RUNTIME: Multi-Query Optimization took 13.225555419921875 ms
2022-09-24 23:40:00 INFO  Executing generated plans
2022-09-24 23:40:49 INFO  ---RUNTIME: Execution took 48614.03799057007 ms
2022-09-24 23:40:49 INFO  Done!
2022-09-24 23:40:49 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-24 23:40:49 INFO  Running instrumented original pipeline...
2022-09-24 23:40:49 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-24 23:40:49 INFO  ---RUNTIME: Importing and monkey-patching took 6.965875625610352 ms
2022-09-24 23:41:34 INFO  ---RUNTIME: Original pipeline execution took 44708.659648895264 ms (excluding imports and monkey-patching)
2022-09-24 23:41:34 INFO  Starting execution of 1 what-if analyses...
2022-09-24 23:41:34 INFO  Start plan generation for analysis PermutationFeatureImportance...
2022-09-24 23:41:34 INFO  ---RUNTIME: Plan generation took 0.1366138458251953 ms
2022-09-24 23:41:34 INFO  Estimated runtime of original DAG is 44367.12455749512ms
2022-09-24 23:41:34 WARNING Skipping Multi-Query Optimization (instead, only applying patches)
2022-09-24 23:41:34 INFO  Estimated unoptimised what-if runtime is 221835.6227874756ms
2022-09-24 23:41:34 INFO  ---RUNTIME: Multi-Query Optimization took 14.864206314086914 ms
2022-09-24 23:41:34 INFO  Executing generated plans
2022-09-24 23:45:15 INFO  ---RUNTIME: Execution took 221189.71133232117 ms
2022-09-24 23:45:15 INFO  Done!
2022-09-24 23:45:15 INFO  # Finished -- repetition 4 of 7 
2022-09-24 23:45:15 INFO  # Optimization benchmark for feature_importance with args [['reviews', 'slow_loading', 'featurization_3', 'xgboost']] -- repetition 5 of 7
2022-09-24 23:45:15 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-24 23:45:15 INFO  Running instrumented original pipeline...
2022-09-24 23:45:15 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-24 23:45:15 INFO  ---RUNTIME: Importing and monkey-patching took 7.559299468994141 ms
2022-09-24 23:45:59 INFO  ---RUNTIME: Original pipeline execution took 44275.73108673096 ms (excluding imports and monkey-patching)
2022-09-24 23:45:59 INFO  Starting execution of 1 what-if analyses...
2022-09-24 23:45:59 INFO  Start plan generation for analysis PermutationFeatureImportance...
2022-09-24 23:45:59 INFO  ---RUNTIME: Plan generation took 0.1373291015625 ms
2022-09-24 23:45:59 INFO  Estimated runtime of original DAG is 43928.96914482117ms
2022-09-24 23:45:59 INFO  Performing Multi-Query Optimization
2022-09-24 23:45:59 INFO  Estimated unoptimized what-if runtime is 219644.84572410583ms
2022-09-24 23:45:59 INFO  Estimated optimised what-if runtime is 48682.36827850342ms
2022-09-24 23:45:59 INFO  Estimated optimisation runtime saving is 170962.47744560242ms
2022-09-24 23:45:59 INFO  ---RUNTIME: Multi-Query Optimization took 13.183116912841797 ms
2022-09-24 23:45:59 INFO  Executing generated plans
2022-09-24 23:46:48 INFO  ---RUNTIME: Execution took 48725.89993476868 ms
2022-09-24 23:46:48 INFO  Done!
2022-09-24 23:46:48 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-24 23:46:48 INFO  Running instrumented original pipeline...
2022-09-24 23:46:48 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-24 23:46:48 INFO  ---RUNTIME: Importing and monkey-patching took 7.032871246337891 ms
2022-09-24 23:47:33 INFO  ---RUNTIME: Original pipeline execution took 44591.00794792175 ms (excluding imports and monkey-patching)
2022-09-24 23:47:33 INFO  Starting execution of 1 what-if analyses...
2022-09-24 23:47:33 INFO  Start plan generation for analysis PermutationFeatureImportance...
2022-09-24 23:47:33 INFO  ---RUNTIME: Plan generation took 0.13566017150878906 ms
2022-09-24 23:47:33 INFO  Estimated runtime of original DAG is 44239.53032493591ms
2022-09-24 23:47:33 WARNING Skipping Multi-Query Optimization (instead, only applying patches)
2022-09-24 23:47:33 INFO  Estimated unoptimised what-if runtime is 221197.65162467957ms
2022-09-24 23:47:33 INFO  ---RUNTIME: Multi-Query Optimization took 5.631446838378906 ms
2022-09-24 23:47:33 INFO  Executing generated plans
2022-09-24 23:51:13 INFO  ---RUNTIME: Execution took 220460.19077301025 ms
2022-09-24 23:51:13 INFO  Done!
2022-09-24 23:51:13 INFO  # Finished -- repetition 5 of 7 
2022-09-24 23:51:13 INFO  # Optimization benchmark for feature_importance with args [['reviews', 'slow_loading', 'featurization_3', 'xgboost']] -- repetition 6 of 7
2022-09-24 23:51:13 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-24 23:51:13 INFO  Running instrumented original pipeline...
2022-09-24 23:51:13 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-24 23:51:13 INFO  ---RUNTIME: Importing and monkey-patching took 6.7844390869140625 ms
2022-09-24 23:51:58 INFO  ---RUNTIME: Original pipeline execution took 44247.09057807922 ms (excluding imports and monkey-patching)
2022-09-24 23:51:58 INFO  Starting execution of 1 what-if analyses...
2022-09-24 23:51:58 INFO  Start plan generation for analysis PermutationFeatureImportance...
2022-09-24 23:51:58 INFO  ---RUNTIME: Plan generation took 0.1404285430908203 ms
2022-09-24 23:51:58 INFO  Estimated runtime of original DAG is 43908.490896224976ms
2022-09-24 23:51:58 INFO  Performing Multi-Query Optimization
2022-09-24 23:51:58 INFO  Estimated unoptimized what-if runtime is 219542.45448112488ms
2022-09-24 23:51:58 INFO  Estimated optimised what-if runtime is 48650.89297294617ms
2022-09-24 23:51:58 INFO  Estimated optimisation runtime saving is 170891.5615081787ms
2022-09-24 23:51:58 INFO  ---RUNTIME: Multi-Query Optimization took 15.074729919433594 ms
2022-09-24 23:51:58 INFO  Executing generated plans
2022-09-24 23:52:46 INFO  ---RUNTIME: Execution took 48794.66509819031 ms
2022-09-24 23:52:46 INFO  Done!
2022-09-24 23:52:46 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-24 23:52:46 INFO  Running instrumented original pipeline...
2022-09-24 23:52:46 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-24 23:52:46 INFO  ---RUNTIME: Importing and monkey-patching took 6.681919097900391 ms
2022-09-24 23:53:31 INFO  ---RUNTIME: Original pipeline execution took 44803.231954574585 ms (excluding imports and monkey-patching)
2022-09-24 23:53:31 INFO  Starting execution of 1 what-if analyses...
2022-09-24 23:53:31 INFO  Start plan generation for analysis PermutationFeatureImportance...
2022-09-24 23:53:31 INFO  ---RUNTIME: Plan generation took 0.11944770812988281 ms
2022-09-24 23:53:31 INFO  Estimated runtime of original DAG is 44450.700521469116ms
2022-09-24 23:53:31 WARNING Skipping Multi-Query Optimization (instead, only applying patches)
2022-09-24 23:53:31 INFO  Estimated unoptimised what-if runtime is 222253.50260734558ms
2022-09-24 23:53:31 INFO  ---RUNTIME: Multi-Query Optimization took 5.554437637329102 ms
2022-09-24 23:53:31 INFO  Executing generated plans
2022-09-24 23:57:10 INFO  ---RUNTIME: Execution took 218424.25870895386 ms
2022-09-24 23:57:10 INFO  Done!
2022-09-24 23:57:10 INFO  # Finished -- repetition 6 of 7 
2022-09-24 23:57:10 INFO  # Optimization benchmark for feature_importance with args [['reviews', 'slow_loading', 'featurization_3', 'xgboost']] -- repetition 7 of 7
2022-09-24 23:57:10 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-24 23:57:10 INFO  Running instrumented original pipeline...
2022-09-24 23:57:10 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-24 23:57:10 INFO  ---RUNTIME: Importing and monkey-patching took 6.390810012817383 ms
2022-09-24 23:57:53 INFO  ---RUNTIME: Original pipeline execution took 43767.43221282959 ms (excluding imports and monkey-patching)
2022-09-24 23:57:53 INFO  Starting execution of 1 what-if analyses...
2022-09-24 23:57:53 INFO  Start plan generation for analysis PermutationFeatureImportance...
2022-09-24 23:57:53 INFO  ---RUNTIME: Plan generation took 0.12636184692382812 ms
2022-09-24 23:57:53 INFO  Estimated runtime of original DAG is 43426.48243904114ms
2022-09-24 23:57:53 INFO  Performing Multi-Query Optimization
2022-09-24 23:57:53 INFO  Estimated unoptimized what-if runtime is 217132.4121952057ms
2022-09-24 23:57:53 INFO  Estimated optimised what-if runtime is 48186.73133850098ms
2022-09-24 23:57:53 INFO  Estimated optimisation runtime saving is 168945.6808567047ms
2022-09-24 23:57:53 INFO  ---RUNTIME: Multi-Query Optimization took 17.758846282958984 ms
2022-09-24 23:57:53 INFO  Executing generated plans
2022-09-24 23:58:42 INFO  ---RUNTIME: Execution took 48355.96680641174 ms
2022-09-24 23:58:42 INFO  Done!
2022-09-24 23:58:42 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-24 23:58:42 INFO  Running instrumented original pipeline...
2022-09-24 23:58:42 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-24 23:58:42 INFO  ---RUNTIME: Importing and monkey-patching took 6.394386291503906 ms
2022-09-24 23:59:26 INFO  ---RUNTIME: Original pipeline execution took 43696.78544998169 ms (excluding imports and monkey-patching)
2022-09-24 23:59:26 INFO  Starting execution of 1 what-if analyses...
2022-09-24 23:59:26 INFO  Start plan generation for analysis PermutationFeatureImportance...
2022-09-24 23:59:26 INFO  ---RUNTIME: Plan generation took 0.133514404296875 ms
2022-09-24 23:59:26 INFO  Estimated runtime of original DAG is 43354.650020599365ms
2022-09-24 23:59:26 WARNING Skipping Multi-Query Optimization (instead, only applying patches)
2022-09-24 23:59:26 INFO  Estimated unoptimised what-if runtime is 216773.25010299683ms
2022-09-24 23:59:26 INFO  ---RUNTIME: Multi-Query Optimization took 5.521297454833984 ms
2022-09-24 23:59:26 INFO  Executing generated plans
2022-09-25 00:03:03 INFO  ---RUNTIME: Execution took 217217.7140712738 ms
2022-09-25 00:03:03 INFO  Done!
2022-09-25 00:03:03 INFO  # Finished -- repetition 7 of 7 
2022-09-25 00:03:03 INFO  # Final results after all repetitions
2022-09-25 00:03:03 INFO     repetition  ... no_opt_what_if_execution_combined_model_training
0           0  ...                                    167728.352308
1           1  ...                                    167595.318556
2           2  ...                                    169929.653406
3           3  ...                                    170151.328087
4           4  ...                                    170166.112185
5           5  ...                                    168258.855581
6           6  ...                                    167807.513475

[7 rows x 26 columns]
PROTOCOL_BUFFERS_PYTHON_IMPLEMENTATION=python taskset -c 32-39 python3.9 benchmarks_end_to_end.py feature_importance reviews slow_loading featurization_3 neural_network
2022-09-25 00:03:05.592231: W tensorflow/stream_executor/platform/default/dso_loader.cc:64] Could not load dynamic library 'libcudart.so.11.0'; dlerror: libcudart.so.11.0: cannot open shared object file: No such file or directory; LD_LIBRARY_PATH: /home/sgrafbe/mlwhatif/venv/lib/python3.9/site-packages/cv2/../../lib64:
2022-09-25 00:03:05.592277: I tensorflow/stream_executor/cuda/cudart_stub.cc:29] Ignore above cudart dlerror if you do not have a GPU set up on your machine.
2022-09-25 00:03:06 INFO  Patching sys.argv with ['mlwhatif', 'reviews', 'slow_loading', 'featurization_3', 'neural_network']
2022-09-25 00:03:06 INFO  Running instrumented original pipeline...
2022-09-25 00:03:06 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-25 00:03:06 INFO  ---RUNTIME: Importing and monkey-patching took 95.76535224914551 ms
2022-09-25 00:03:13.678881: W tensorflow/stream_executor/platform/default/dso_loader.cc:64] Could not load dynamic library 'libcuda.so.1'; dlerror: libcuda.so.1: cannot open shared object file: No such file or directory; LD_LIBRARY_PATH: /home/sgrafbe/mlwhatif/venv/lib/python3.9/site-packages/cv2/../../lib64:
2022-09-25 00:03:13.678921: W tensorflow/stream_executor/cuda/cuda_driver.cc:326] failed call to cuInit: UNKNOWN ERROR (303)
2022-09-25 00:03:13.678945: I tensorflow/stream_executor/cuda/cuda_diagnostics.cc:156] kernel driver does not appear to be running on this host (wagyu): /proc/driver/nvidia/version does not exist
2022-09-25 00:03:13.679500: I tensorflow/core/platform/cpu_feature_guard.cc:142] This TensorFlow binary is optimized with oneAPI Deep Neural Network Library (oneDNN) to use the following CPU instructions in performance-critical operations:  AVX2 FMA
To enable them in other operations, rebuild TensorFlow with the appropriate compiler flags.
2022-09-25 00:03:14.322454: I tensorflow/compiler/mlir/mlir_graph_optimization_pass.cc:176] None of the MLIR Optimization Passes are enabled (registered 2)
2022-09-25 00:03:14.336374: I tensorflow/core/platform/profile_utils/cpu_utils.cc:114] CPU Frequency: 2595290000 Hz
2022-09-25 00:03:24 INFO  ---RUNTIME: Original pipeline execution took 17129.656553268433 ms (excluding imports and monkey-patching)
2022-09-25 00:03:24 INFO  Starting execution of 0 what-if analyses...
2022-09-25 00:03:24 INFO  Estimated runtime of original DAG is 16734.877824783325ms
2022-09-25 00:03:24 INFO  Performing Multi-Query Optimization
2022-09-25 00:03:24 INFO  Estimated unoptimized what-if runtime is 0ms
2022-09-25 00:03:24 INFO  Estimated optimised what-if runtime is 0ms
2022-09-25 00:03:24 INFO  Estimated optimisation runtime saving is 0ms
2022-09-25 00:03:24 INFO  ---RUNTIME: Multi-Query Optimization took 0.6122589111328125 ms
2022-09-25 00:03:24 INFO  Executing generated plans
2022-09-25 00:03:24 INFO  ---RUNTIME: Execution took 0.027179718017578125 ms
2022-09-25 00:03:24 INFO  Done!
2022-09-25 00:03:24 INFO  # Optimization benchmark for feature_importance with args [['reviews', 'slow_loading', 'featurization_3', 'neural_network']] -- repetition 1 of 7
2022-09-25 00:03:24 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-25 00:03:24 INFO  Running instrumented original pipeline...
2022-09-25 00:03:24 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-25 00:03:24 INFO  ---RUNTIME: Importing and monkey-patching took 5.582094192504883 ms
2022-09-25 00:03:40 INFO  ---RUNTIME: Original pipeline execution took 16586.96460723877 ms (excluding imports and monkey-patching)
2022-09-25 00:03:40 INFO  Starting execution of 1 what-if analyses...
2022-09-25 00:03:40 INFO  Start plan generation for analysis PermutationFeatureImportance...
2022-09-25 00:03:40 INFO  ---RUNTIME: Plan generation took 0.2589225769042969 ms
2022-09-25 00:03:40 INFO  Estimated runtime of original DAG is 16234.781742095947ms
2022-09-25 00:03:40 INFO  Performing Multi-Query Optimization
2022-09-25 00:03:40 INFO  Estimated unoptimized what-if runtime is 81173.90871047974ms
2022-09-25 00:03:40 INFO  Estimated optimised what-if runtime is 22558.977603912354ms
2022-09-25 00:03:40 INFO  Estimated optimisation runtime saving is 58614.93110656738ms
2022-09-25 00:03:40 INFO  ---RUNTIME: Multi-Query Optimization took 18.538236618041992 ms
2022-09-25 00:03:40 INFO  Executing generated plans
2022-09-25 00:04:02 INFO  ---RUNTIME: Execution took 22206.393003463745 ms
2022-09-25 00:04:02 INFO  Done!
2022-09-25 00:04:02 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-25 00:04:02 INFO  Running instrumented original pipeline...
2022-09-25 00:04:02 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-25 00:04:02 INFO  ---RUNTIME: Importing and monkey-patching took 6.425380706787109 ms
2022-09-25 00:04:19 INFO  ---RUNTIME: Original pipeline execution took 17032.325506210327 ms (excluding imports and monkey-patching)
2022-09-25 00:04:19 INFO  Starting execution of 1 what-if analyses...
2022-09-25 00:04:19 INFO  Start plan generation for analysis PermutationFeatureImportance...
2022-09-25 00:04:19 INFO  ---RUNTIME: Plan generation took 0.1556873321533203 ms
2022-09-25 00:04:19 INFO  Estimated runtime of original DAG is 16671.412467956543ms
2022-09-25 00:04:19 WARNING Skipping Multi-Query Optimization (instead, only applying patches)
2022-09-25 00:04:19 INFO  Estimated unoptimised what-if runtime is 83357.06233978271ms
2022-09-25 00:04:19 INFO  ---RUNTIME: Multi-Query Optimization took 4.87971305847168 ms
2022-09-25 00:04:19 INFO  Executing generated plans
2022-09-25 00:05:41 INFO  ---RUNTIME: Execution took 81513.8373374939 ms
2022-09-25 00:05:41 INFO  Done!
2022-09-25 00:05:41 INFO  # Finished -- repetition 1 of 7 
2022-09-25 00:05:41 INFO  # Optimization benchmark for feature_importance with args [['reviews', 'slow_loading', 'featurization_3', 'neural_network']] -- repetition 2 of 7
2022-09-25 00:05:41 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-25 00:05:41 INFO  Running instrumented original pipeline...
2022-09-25 00:05:41 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-25 00:05:41 INFO  ---RUNTIME: Importing and monkey-patching took 6.305694580078125 ms
2022-09-25 00:05:58 INFO  ---RUNTIME: Original pipeline execution took 16693.00889968872 ms (excluding imports and monkey-patching)
2022-09-25 00:05:58 INFO  Starting execution of 1 what-if analyses...
2022-09-25 00:05:58 INFO  Start plan generation for analysis PermutationFeatureImportance...
2022-09-25 00:05:58 INFO  ---RUNTIME: Plan generation took 0.1761913299560547 ms
2022-09-25 00:05:58 INFO  Estimated runtime of original DAG is 16333.99510383606ms
2022-09-25 00:05:58 INFO  Performing Multi-Query Optimization
2022-09-25 00:05:58 INFO  Estimated unoptimized what-if runtime is 81669.9755191803ms
2022-09-25 00:05:58 INFO  Estimated optimised what-if runtime is 22759.9139213562ms
2022-09-25 00:05:58 INFO  Estimated optimisation runtime saving is 58910.0615978241ms
2022-09-25 00:05:58 INFO  ---RUNTIME: Multi-Query Optimization took 18.719911575317383 ms
2022-09-25 00:05:58 INFO  Executing generated plans
2022-09-25 00:06:21 INFO  ---RUNTIME: Execution took 23001.76763534546 ms
2022-09-25 00:06:21 INFO  Done!
2022-09-25 00:06:21 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-25 00:06:21 INFO  Running instrumented original pipeline...
2022-09-25 00:06:21 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-25 00:06:21 INFO  ---RUNTIME: Importing and monkey-patching took 5.921840667724609 ms
2022-09-25 00:06:37 INFO  ---RUNTIME: Original pipeline execution took 16619.28367614746 ms (excluding imports and monkey-patching)
2022-09-25 00:06:37 INFO  Starting execution of 1 what-if analyses...
2022-09-25 00:06:37 INFO  Start plan generation for analysis PermutationFeatureImportance...
2022-09-25 00:06:37 INFO  ---RUNTIME: Plan generation took 0.10371208190917969 ms
2022-09-25 00:06:37 INFO  Estimated runtime of original DAG is 16243.141174316406ms
2022-09-25 00:06:37 WARNING Skipping Multi-Query Optimization (instead, only applying patches)
2022-09-25 00:06:37 INFO  Estimated unoptimised what-if runtime is 81215.70587158203ms
2022-09-25 00:06:37 INFO  ---RUNTIME: Multi-Query Optimization took 4.723310470581055 ms
2022-09-25 00:06:37 INFO  Executing generated plans
2022-09-25 00:07:59 INFO  ---RUNTIME: Execution took 81673.40421676636 ms
2022-09-25 00:07:59 INFO  Done!
2022-09-25 00:07:59 INFO  # Finished -- repetition 2 of 7 
2022-09-25 00:07:59 INFO  # Optimization benchmark for feature_importance with args [['reviews', 'slow_loading', 'featurization_3', 'neural_network']] -- repetition 3 of 7
2022-09-25 00:07:59 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-25 00:07:59 INFO  Running instrumented original pipeline...
2022-09-25 00:07:59 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-25 00:07:59 INFO  ---RUNTIME: Importing and monkey-patching took 6.717681884765625 ms
2022-09-25 00:08:16 INFO  ---RUNTIME: Original pipeline execution took 16634.435415267944 ms (excluding imports and monkey-patching)
2022-09-25 00:08:16 INFO  Starting execution of 1 what-if analyses...
2022-09-25 00:08:16 INFO  Start plan generation for analysis PermutationFeatureImportance...
2022-09-25 00:08:16 INFO  ---RUNTIME: Plan generation took 0.13494491577148438 ms
2022-09-25 00:08:16 INFO  Estimated runtime of original DAG is 16263.097286224365ms
2022-09-25 00:08:16 INFO  Performing Multi-Query Optimization
2022-09-25 00:08:16 INFO  Estimated unoptimized what-if runtime is 81315.48643112183ms
2022-09-25 00:08:16 INFO  Estimated optimised what-if runtime is 22748.798370361328ms
2022-09-25 00:08:16 INFO  Estimated optimisation runtime saving is 58566.6880607605ms
2022-09-25 00:08:16 INFO  ---RUNTIME: Multi-Query Optimization took 18.402576446533203 ms
2022-09-25 00:08:16 INFO  Executing generated plans
2022-09-25 00:08:39 INFO  ---RUNTIME: Execution took 23085.498094558716 ms
2022-09-25 00:08:39 INFO  Done!
2022-09-25 00:08:39 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-25 00:08:39 INFO  Running instrumented original pipeline...
2022-09-25 00:08:39 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-25 00:08:39 INFO  ---RUNTIME: Importing and monkey-patching took 5.912542343139648 ms
2022-09-25 00:08:56 INFO  ---RUNTIME: Original pipeline execution took 16745.97716331482 ms (excluding imports and monkey-patching)
2022-09-25 00:08:56 INFO  Starting execution of 1 what-if analyses...
2022-09-25 00:08:56 INFO  Start plan generation for analysis PermutationFeatureImportance...
2022-09-25 00:08:56 INFO  ---RUNTIME: Plan generation took 0.11515617370605469 ms
2022-09-25 00:08:56 INFO  Estimated runtime of original DAG is 16370.699405670166ms
2022-09-25 00:08:56 WARNING Skipping Multi-Query Optimization (instead, only applying patches)
2022-09-25 00:08:56 INFO  Estimated unoptimised what-if runtime is 81853.49702835083ms
2022-09-25 00:08:56 INFO  ---RUNTIME: Multi-Query Optimization took 4.721879959106445 ms
2022-09-25 00:08:56 INFO  Executing generated plans
2022-09-25 00:10:18 INFO  ---RUNTIME: Execution took 82593.4898853302 ms
2022-09-25 00:10:18 INFO  Done!
2022-09-25 00:10:18 INFO  # Finished -- repetition 3 of 7 
2022-09-25 00:10:18 INFO  # Optimization benchmark for feature_importance with args [['reviews', 'slow_loading', 'featurization_3', 'neural_network']] -- repetition 4 of 7
2022-09-25 00:10:18 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-25 00:10:18 INFO  Running instrumented original pipeline...
2022-09-25 00:10:18 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-25 00:10:18 INFO  ---RUNTIME: Importing and monkey-patching took 6.3419342041015625 ms
2022-09-25 00:10:35 INFO  ---RUNTIME: Original pipeline execution took 16865.27919769287 ms (excluding imports and monkey-patching)
2022-09-25 00:10:35 INFO  Starting execution of 1 what-if analyses...
2022-09-25 00:10:35 INFO  Start plan generation for analysis PermutationFeatureImportance...
2022-09-25 00:10:35 INFO  ---RUNTIME: Plan generation took 0.13518333435058594 ms
2022-09-25 00:10:35 INFO  Estimated runtime of original DAG is 16500.093460083008ms
2022-09-25 00:10:35 INFO  Performing Multi-Query Optimization
2022-09-25 00:10:35 INFO  Estimated unoptimized what-if runtime is 82500.46730041504ms
2022-09-25 00:10:35 INFO  Estimated optimised what-if runtime is 22859.529495239258ms
2022-09-25 00:10:35 INFO  Estimated optimisation runtime saving is 59640.93780517578ms
2022-09-25 00:10:35 INFO  ---RUNTIME: Multi-Query Optimization took 12.595891952514648 ms
2022-09-25 00:10:35 INFO  Executing generated plans
2022-09-25 00:10:58 INFO  ---RUNTIME: Execution took 22775.51507949829 ms
2022-09-25 00:10:58 INFO  Done!
2022-09-25 00:10:58 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-25 00:10:58 INFO  Running instrumented original pipeline...
2022-09-25 00:10:58 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-25 00:10:58 INFO  ---RUNTIME: Importing and monkey-patching took 5.887269973754883 ms
2022-09-25 00:11:15 INFO  ---RUNTIME: Original pipeline execution took 16729.68554496765 ms (excluding imports and monkey-patching)
2022-09-25 00:11:15 INFO  Starting execution of 1 what-if analyses...
2022-09-25 00:11:15 INFO  Start plan generation for analysis PermutationFeatureImportance...
2022-09-25 00:11:15 INFO  ---RUNTIME: Plan generation took 0.12183189392089844 ms
2022-09-25 00:11:15 INFO  Estimated runtime of original DAG is 16359.69877243042ms
2022-09-25 00:11:15 WARNING Skipping Multi-Query Optimization (instead, only applying patches)
2022-09-25 00:11:15 INFO  Estimated unoptimised what-if runtime is 81798.4938621521ms
2022-09-25 00:11:15 INFO  ---RUNTIME: Multi-Query Optimization took 4.84156608581543 ms
2022-09-25 00:11:15 INFO  Executing generated plans
2022-09-25 00:12:38 INFO  ---RUNTIME: Execution took 82841.97926521301 ms
2022-09-25 00:12:38 INFO  Done!
2022-09-25 00:12:38 INFO  # Finished -- repetition 4 of 7 
2022-09-25 00:12:38 INFO  # Optimization benchmark for feature_importance with args [['reviews', 'slow_loading', 'featurization_3', 'neural_network']] -- repetition 5 of 7
2022-09-25 00:12:38 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-25 00:12:38 INFO  Running instrumented original pipeline...
2022-09-25 00:12:38 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-25 00:12:38 INFO  ---RUNTIME: Importing and monkey-patching took 6.972312927246094 ms
2022-09-25 00:12:54 INFO  ---RUNTIME: Original pipeline execution took 16803.0207157135 ms (excluding imports and monkey-patching)
2022-09-25 00:12:54 INFO  Starting execution of 1 what-if analyses...
2022-09-25 00:12:54 INFO  Start plan generation for analysis PermutationFeatureImportance...
2022-09-25 00:12:54 INFO  ---RUNTIME: Plan generation took 0.12302398681640625 ms
2022-09-25 00:12:54 INFO  Estimated runtime of original DAG is 16431.514501571655ms
2022-09-25 00:12:54 INFO  Performing Multi-Query Optimization
2022-09-25 00:12:54 INFO  Estimated unoptimized what-if runtime is 82157.57250785828ms
2022-09-25 00:12:54 INFO  Estimated optimised what-if runtime is 23170.92514038086ms
2022-09-25 00:12:54 INFO  Estimated optimisation runtime saving is 58986.64736747742ms
2022-09-25 00:12:54 INFO  ---RUNTIME: Multi-Query Optimization took 12.187719345092773 ms
2022-09-25 00:12:54 INFO  Executing generated plans
2022-09-25 00:13:18 INFO  ---RUNTIME: Execution took 23355.720281600952 ms
2022-09-25 00:13:18 INFO  Done!
2022-09-25 00:13:18 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-25 00:13:18 INFO  Running instrumented original pipeline...
2022-09-25 00:13:18 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-25 00:13:18 INFO  ---RUNTIME: Importing and monkey-patching took 5.929231643676758 ms
2022-09-25 00:13:35 INFO  ---RUNTIME: Original pipeline execution took 17196.394681930542 ms (excluding imports and monkey-patching)
2022-09-25 00:13:35 INFO  Starting execution of 1 what-if analyses...
2022-09-25 00:13:35 INFO  Start plan generation for analysis PermutationFeatureImportance...
2022-09-25 00:13:35 INFO  ---RUNTIME: Plan generation took 0.14257431030273438 ms
2022-09-25 00:13:35 INFO  Estimated runtime of original DAG is 16811.580181121826ms
2022-09-25 00:13:35 WARNING Skipping Multi-Query Optimization (instead, only applying patches)
2022-09-25 00:13:35 INFO  Estimated unoptimised what-if runtime is 84057.90090560913ms
2022-09-25 00:13:35 INFO  ---RUNTIME: Multi-Query Optimization took 4.832983016967773 ms
2022-09-25 00:13:35 INFO  Executing generated plans
2022-09-25 00:14:57 INFO  ---RUNTIME: Execution took 82205.44242858887 ms
2022-09-25 00:14:57 INFO  Done!
2022-09-25 00:14:57 INFO  # Finished -- repetition 5 of 7 
2022-09-25 00:14:57 INFO  # Optimization benchmark for feature_importance with args [['reviews', 'slow_loading', 'featurization_3', 'neural_network']] -- repetition 6 of 7
2022-09-25 00:14:57 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-25 00:14:57 INFO  Running instrumented original pipeline...
2022-09-25 00:14:57 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-25 00:14:57 INFO  ---RUNTIME: Importing and monkey-patching took 6.167173385620117 ms
2022-09-25 00:15:14 INFO  ---RUNTIME: Original pipeline execution took 16723.03056716919 ms (excluding imports and monkey-patching)
2022-09-25 00:15:14 INFO  Starting execution of 1 what-if analyses...
2022-09-25 00:15:14 INFO  Start plan generation for analysis PermutationFeatureImportance...
2022-09-25 00:15:14 INFO  ---RUNTIME: Plan generation took 0.1068115234375 ms
2022-09-25 00:15:14 INFO  Estimated runtime of original DAG is 16346.111536026001ms
2022-09-25 00:15:14 INFO  Performing Multi-Query Optimization
2022-09-25 00:15:14 INFO  Estimated unoptimized what-if runtime is 81730.55768013ms
2022-09-25 00:15:14 INFO  Estimated optimised what-if runtime is 22685.797691345215ms
2022-09-25 00:15:14 INFO  Estimated optimisation runtime saving is 59044.75998878479ms
2022-09-25 00:15:14 INFO  ---RUNTIME: Multi-Query Optimization took 18.210411071777344 ms
2022-09-25 00:15:14 INFO  Executing generated plans
2022-09-25 00:15:37 INFO  ---RUNTIME: Execution took 22512.536764144897 ms
2022-09-25 00:15:37 INFO  Done!
2022-09-25 00:15:37 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-25 00:15:37 INFO  Running instrumented original pipeline...
2022-09-25 00:15:37 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-25 00:15:37 INFO  ---RUNTIME: Importing and monkey-patching took 6.097078323364258 ms
2022-09-25 00:15:53 INFO  ---RUNTIME: Original pipeline execution took 16596.760511398315 ms (excluding imports and monkey-patching)
2022-09-25 00:15:53 INFO  Starting execution of 1 what-if analyses...
2022-09-25 00:15:53 INFO  Start plan generation for analysis PermutationFeatureImportance...
2022-09-25 00:15:53 INFO  ---RUNTIME: Plan generation took 0.14400482177734375 ms
2022-09-25 00:15:53 INFO  Estimated runtime of original DAG is 16223.644971847534ms
2022-09-25 00:15:53 WARNING Skipping Multi-Query Optimization (instead, only applying patches)
2022-09-25 00:15:53 INFO  Estimated unoptimised what-if runtime is 81118.22485923767ms
2022-09-25 00:15:53 INFO  ---RUNTIME: Multi-Query Optimization took 4.8370361328125 ms
2022-09-25 00:15:53 INFO  Executing generated plans
2022-09-25 00:17:16 INFO  ---RUNTIME: Execution took 83257.1587562561 ms
2022-09-25 00:17:16 INFO  Done!
2022-09-25 00:17:17 INFO  # Finished -- repetition 6 of 7 
2022-09-25 00:17:17 INFO  # Optimization benchmark for feature_importance with args [['reviews', 'slow_loading', 'featurization_3', 'neural_network']] -- repetition 7 of 7
2022-09-25 00:17:17 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-25 00:17:17 INFO  Running instrumented original pipeline...
2022-09-25 00:17:17 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-25 00:17:17 INFO  ---RUNTIME: Importing and monkey-patching took 6.453514099121094 ms
2022-09-25 00:17:33 INFO  ---RUNTIME: Original pipeline execution took 16846.693515777588 ms (excluding imports and monkey-patching)
2022-09-25 00:17:33 INFO  Starting execution of 1 what-if analyses...
2022-09-25 00:17:33 INFO  Start plan generation for analysis PermutationFeatureImportance...
2022-09-25 00:17:33 INFO  ---RUNTIME: Plan generation took 0.13256072998046875 ms
2022-09-25 00:17:33 INFO  Estimated runtime of original DAG is 16466.236352920532ms
2022-09-25 00:17:33 INFO  Performing Multi-Query Optimization
2022-09-25 00:17:33 INFO  Estimated unoptimized what-if runtime is 82331.18176460266ms
2022-09-25 00:17:33 INFO  Estimated optimised what-if runtime is 23168.959379196167ms
2022-09-25 00:17:33 INFO  Estimated optimisation runtime saving is 59162.222385406494ms
2022-09-25 00:17:33 INFO  ---RUNTIME: Multi-Query Optimization took 18.594980239868164 ms
2022-09-25 00:17:33 INFO  Executing generated plans
2022-09-25 00:17:56 INFO  ---RUNTIME: Execution took 22573.335886001587 ms
2022-09-25 00:17:56 INFO  Done!
2022-09-25 00:17:56 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-25 00:17:56 INFO  Running instrumented original pipeline...
2022-09-25 00:17:56 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-25 00:17:56 INFO  ---RUNTIME: Importing and monkey-patching took 6.599187850952148 ms
2022-09-25 00:18:14 INFO  ---RUNTIME: Original pipeline execution took 17627.496004104614 ms (excluding imports and monkey-patching)
2022-09-25 00:18:14 INFO  Starting execution of 1 what-if analyses...
2022-09-25 00:18:14 INFO  Start plan generation for analysis PermutationFeatureImportance...
2022-09-25 00:18:14 INFO  ---RUNTIME: Plan generation took 0.11897087097167969 ms
2022-09-25 00:18:14 INFO  Estimated runtime of original DAG is 17249.398469924927ms
2022-09-25 00:18:14 WARNING Skipping Multi-Query Optimization (instead, only applying patches)
2022-09-25 00:18:14 INFO  Estimated unoptimised what-if runtime is 86246.99234962463ms
2022-09-25 00:18:14 INFO  ---RUNTIME: Multi-Query Optimization took 10.990142822265625 ms
2022-09-25 00:18:14 INFO  Executing generated plans
2022-09-25 00:19:36 INFO  ---RUNTIME: Execution took 81882.24267959595 ms
2022-09-25 00:19:36 INFO  Done!
2022-09-25 00:19:36 INFO  # Finished -- repetition 7 of 7 
2022-09-25 00:19:36 INFO  # Final results after all repetitions
2022-09-25 00:19:36 INFO     repetition  ... no_opt_what_if_execution_combined_model_training
0           0  ...                                     29877.396822
1           1  ...                                     30013.125896
2           2  ...                                     30244.859934
3           3  ...                                     30030.487537
4           4  ...                                     30135.251999
5           5  ...                                     30372.399330
6           6  ...                                     29718.266726

[7 rows x 26 columns]
PROTOCOL_BUFFERS_PYTHON_IMPLEMENTATION=python taskset -c 32-39 python3.9 benchmarks_end_to_end.py feature_importance reviews slow_loading featurization_4 logistic_regression
2022-09-25 00:19:38.935538: W tensorflow/stream_executor/platform/default/dso_loader.cc:64] Could not load dynamic library 'libcudart.so.11.0'; dlerror: libcudart.so.11.0: cannot open shared object file: No such file or directory; LD_LIBRARY_PATH: /home/sgrafbe/mlwhatif/venv/lib/python3.9/site-packages/cv2/../../lib64:
2022-09-25 00:19:38.935584: I tensorflow/stream_executor/cuda/cudart_stub.cc:29] Ignore above cudart dlerror if you do not have a GPU set up on your machine.
2022-09-25 00:19:40 INFO  Patching sys.argv with ['mlwhatif', 'reviews', 'slow_loading', 'featurization_4', 'logistic_regression']
2022-09-25 00:19:40 INFO  Running instrumented original pipeline...
2022-09-25 00:19:40 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-25 00:19:40 INFO  ---RUNTIME: Importing and monkey-patching took 97.0306396484375 ms
2022-09-25 00:19:50 INFO  ---RUNTIME: Original pipeline execution took 10520.570278167725 ms (excluding imports and monkey-patching)
2022-09-25 00:19:50 INFO  Starting execution of 0 what-if analyses...
2022-09-25 00:19:50 INFO  Estimated runtime of original DAG is 10166.444778442383ms
2022-09-25 00:19:50 INFO  Performing Multi-Query Optimization
2022-09-25 00:19:50 INFO  Estimated unoptimized what-if runtime is 0ms
2022-09-25 00:19:50 INFO  Estimated optimised what-if runtime is 0ms
2022-09-25 00:19:50 INFO  Estimated optimisation runtime saving is 0ms
2022-09-25 00:19:50 INFO  ---RUNTIME: Multi-Query Optimization took 0.5371570587158203 ms
2022-09-25 00:19:50 INFO  Executing generated plans
2022-09-25 00:19:50 INFO  ---RUNTIME: Execution took 0.028371810913085938 ms
2022-09-25 00:19:50 INFO  Done!
2022-09-25 00:19:50 INFO  # Optimization benchmark for feature_importance with args [['reviews', 'slow_loading', 'featurization_4', 'logistic_regression']] -- repetition 1 of 7
2022-09-25 00:19:50 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-25 00:19:50 INFO  Running instrumented original pipeline...
2022-09-25 00:19:50 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-25 00:19:50 INFO  ---RUNTIME: Importing and monkey-patching took 5.697488784790039 ms
2022-09-25 00:20:01 INFO  ---RUNTIME: Original pipeline execution took 10267.937660217285 ms (excluding imports and monkey-patching)
2022-09-25 00:20:01 INFO  Starting execution of 1 what-if analyses...
2022-09-25 00:20:01 INFO  Start plan generation for analysis PermutationFeatureImportance...
2022-09-25 00:20:01 INFO  ---RUNTIME: Plan generation took 0.2512931823730469 ms
2022-09-25 00:20:01 INFO  Estimated runtime of original DAG is 9949.816226959229ms
2022-09-25 00:20:01 INFO  Performing Multi-Query Optimization
2022-09-25 00:20:01 INFO  Estimated unoptimized what-if runtime is 49749.08113479614ms
2022-09-25 00:20:01 INFO  Estimated optimised what-if runtime is 10165.79556465149ms
2022-09-25 00:20:01 INFO  Estimated optimisation runtime saving is 39583.28557014465ms
2022-09-25 00:20:01 INFO  ---RUNTIME: Multi-Query Optimization took 11.332273483276367 ms
2022-09-25 00:20:01 INFO  Executing generated plans
2022-09-25 00:20:11 INFO  ---RUNTIME: Execution took 10140.482187271118 ms
2022-09-25 00:20:11 INFO  Done!
2022-09-25 00:20:11 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-25 00:20:11 INFO  Running instrumented original pipeline...
2022-09-25 00:20:11 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-25 00:20:11 INFO  ---RUNTIME: Importing and monkey-patching took 6.531715393066406 ms
2022-09-25 00:20:21 INFO  ---RUNTIME: Original pipeline execution took 10262.389421463013 ms (excluding imports and monkey-patching)
2022-09-25 00:20:21 INFO  Starting execution of 1 what-if analyses...
2022-09-25 00:20:21 INFO  Start plan generation for analysis PermutationFeatureImportance...
2022-09-25 00:20:21 INFO  ---RUNTIME: Plan generation took 0.1087188720703125 ms
2022-09-25 00:20:21 INFO  Estimated runtime of original DAG is 9948.917865753174ms
2022-09-25 00:20:21 WARNING Skipping Multi-Query Optimization (instead, only applying patches)
2022-09-25 00:20:21 INFO  Estimated unoptimised what-if runtime is 49744.58932876587ms
2022-09-25 00:20:21 INFO  ---RUNTIME: Multi-Query Optimization took 4.213094711303711 ms
2022-09-25 00:20:21 INFO  Executing generated plans
2022-09-25 00:21:11 INFO  ---RUNTIME: Execution took 49904.30521965027 ms
2022-09-25 00:21:11 INFO  Done!
2022-09-25 00:21:11 INFO  # Finished -- repetition 1 of 7 
2022-09-25 00:21:11 INFO  # Optimization benchmark for feature_importance with args [['reviews', 'slow_loading', 'featurization_4', 'logistic_regression']] -- repetition 2 of 7
2022-09-25 00:21:11 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-25 00:21:11 INFO  Running instrumented original pipeline...
2022-09-25 00:21:11 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-25 00:21:11 INFO  ---RUNTIME: Importing and monkey-patching took 6.621837615966797 ms
2022-09-25 00:21:21 INFO  ---RUNTIME: Original pipeline execution took 10317.863702774048 ms (excluding imports and monkey-patching)
2022-09-25 00:21:21 INFO  Starting execution of 1 what-if analyses...
2022-09-25 00:21:21 INFO  Start plan generation for analysis PermutationFeatureImportance...
2022-09-25 00:21:21 INFO  ---RUNTIME: Plan generation took 0.1609325408935547 ms
2022-09-25 00:21:21 INFO  Estimated runtime of original DAG is 10001.9690990448ms
2022-09-25 00:21:21 INFO  Performing Multi-Query Optimization
2022-09-25 00:21:21 INFO  Estimated unoptimized what-if runtime is 50009.845495224ms
2022-09-25 00:21:21 INFO  Estimated optimised what-if runtime is 10218.687534332275ms
2022-09-25 00:21:21 INFO  Estimated optimisation runtime saving is 39791.15796089172ms
2022-09-25 00:21:21 INFO  ---RUNTIME: Multi-Query Optimization took 11.009693145751953 ms
2022-09-25 00:21:21 INFO  Executing generated plans
2022-09-25 00:21:32 INFO  ---RUNTIME: Execution took 10239.47811126709 ms
2022-09-25 00:21:32 INFO  Done!
2022-09-25 00:21:32 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-25 00:21:32 INFO  Running instrumented original pipeline...
2022-09-25 00:21:32 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-25 00:21:32 INFO  ---RUNTIME: Importing and monkey-patching took 6.168842315673828 ms
2022-09-25 00:21:42 INFO  ---RUNTIME: Original pipeline execution took 10402.313470840454 ms (excluding imports and monkey-patching)
2022-09-25 00:21:42 INFO  Starting execution of 1 what-if analyses...
2022-09-25 00:21:42 INFO  Start plan generation for analysis PermutationFeatureImportance...
2022-09-25 00:21:42 INFO  ---RUNTIME: Plan generation took 0.11038780212402344 ms
2022-09-25 00:21:42 INFO  Estimated runtime of original DAG is 10083.861351013184ms
2022-09-25 00:21:42 WARNING Skipping Multi-Query Optimization (instead, only applying patches)
2022-09-25 00:21:42 INFO  Estimated unoptimised what-if runtime is 50419.30675506592ms
2022-09-25 00:21:42 INFO  ---RUNTIME: Multi-Query Optimization took 4.1484832763671875 ms
2022-09-25 00:21:42 INFO  Executing generated plans
2022-09-25 00:22:33 INFO  ---RUNTIME: Execution took 50451.5814781189 ms
2022-09-25 00:22:33 INFO  Done!
2022-09-25 00:22:33 INFO  # Finished -- repetition 2 of 7 
2022-09-25 00:22:33 INFO  # Optimization benchmark for feature_importance with args [['reviews', 'slow_loading', 'featurization_4', 'logistic_regression']] -- repetition 3 of 7
2022-09-25 00:22:33 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-25 00:22:33 INFO  Running instrumented original pipeline...
2022-09-25 00:22:33 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-25 00:22:33 INFO  ---RUNTIME: Importing and monkey-patching took 6.2389373779296875 ms
2022-09-25 00:22:43 INFO  ---RUNTIME: Original pipeline execution took 10116.113424301147 ms (excluding imports and monkey-patching)
2022-09-25 00:22:43 INFO  Starting execution of 1 what-if analyses...
2022-09-25 00:22:43 INFO  Start plan generation for analysis PermutationFeatureImportance...
2022-09-25 00:22:43 INFO  ---RUNTIME: Plan generation took 0.12302398681640625 ms
2022-09-25 00:22:43 INFO  Estimated runtime of original DAG is 9803.160667419434ms
2022-09-25 00:22:43 INFO  Performing Multi-Query Optimization
2022-09-25 00:22:43 INFO  Estimated unoptimized what-if runtime is 49015.80333709717ms
2022-09-25 00:22:43 INFO  Estimated optimised what-if runtime is 10015.267848968506ms
2022-09-25 00:22:43 INFO  Estimated optimisation runtime saving is 39000.53548812866ms
2022-09-25 00:22:43 INFO  ---RUNTIME: Multi-Query Optimization took 10.849475860595703 ms
2022-09-25 00:22:43 INFO  Executing generated plans
2022-09-25 00:22:53 INFO  ---RUNTIME: Execution took 10083.620309829712 ms
2022-09-25 00:22:53 INFO  Done!
2022-09-25 00:22:53 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-25 00:22:53 INFO  Running instrumented original pipeline...
2022-09-25 00:22:53 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-25 00:22:53 INFO  ---RUNTIME: Importing and monkey-patching took 6.3533782958984375 ms
2022-09-25 00:23:03 INFO  ---RUNTIME: Original pipeline execution took 10002.980470657349 ms (excluding imports and monkey-patching)
2022-09-25 00:23:03 INFO  Starting execution of 1 what-if analyses...
2022-09-25 00:23:03 INFO  Start plan generation for analysis PermutationFeatureImportance...
2022-09-25 00:23:03 INFO  ---RUNTIME: Plan generation took 0.1239776611328125 ms
2022-09-25 00:23:03 INFO  Estimated runtime of original DAG is 9688.510656356812ms
2022-09-25 00:23:03 WARNING Skipping Multi-Query Optimization (instead, only applying patches)
2022-09-25 00:23:03 INFO  Estimated unoptimised what-if runtime is 48442.55328178406ms
2022-09-25 00:23:03 INFO  ---RUNTIME: Multi-Query Optimization took 4.219293594360352 ms
2022-09-25 00:23:03 INFO  Executing generated plans
2022-09-25 00:23:53 INFO  ---RUNTIME: Execution took 50096.00043296814 ms
2022-09-25 00:23:53 INFO  Done!
2022-09-25 00:23:53 INFO  # Finished -- repetition 3 of 7 
2022-09-25 00:23:53 INFO  # Optimization benchmark for feature_importance with args [['reviews', 'slow_loading', 'featurization_4', 'logistic_regression']] -- repetition 4 of 7
2022-09-25 00:23:53 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-25 00:23:53 INFO  Running instrumented original pipeline...
2022-09-25 00:23:53 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-25 00:23:53 INFO  ---RUNTIME: Importing and monkey-patching took 6.381988525390625 ms
2022-09-25 00:24:03 INFO  ---RUNTIME: Original pipeline execution took 10440.895318984985 ms (excluding imports and monkey-patching)
2022-09-25 00:24:03 INFO  Starting execution of 1 what-if analyses...
2022-09-25 00:24:03 INFO  Start plan generation for analysis PermutationFeatureImportance...
2022-09-25 00:24:03 INFO  ---RUNTIME: Plan generation took 0.10275840759277344 ms
2022-09-25 00:24:03 INFO  Estimated runtime of original DAG is 10124.644756317139ms
2022-09-25 00:24:03 INFO  Performing Multi-Query Optimization
2022-09-25 00:24:03 INFO  Estimated unoptimized what-if runtime is 50623.22378158569ms
2022-09-25 00:24:03 INFO  Estimated optimised what-if runtime is 10338.8512134552ms
2022-09-25 00:24:03 INFO  Estimated optimisation runtime saving is 40284.37256813049ms
2022-09-25 00:24:03 INFO  ---RUNTIME: Multi-Query Optimization took 10.744571685791016 ms
2022-09-25 00:24:03 INFO  Executing generated plans
2022-09-25 00:24:14 INFO  ---RUNTIME: Execution took 10144.590616226196 ms
2022-09-25 00:24:14 INFO  Done!
2022-09-25 00:24:14 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-25 00:24:14 INFO  Running instrumented original pipeline...
2022-09-25 00:24:14 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-25 00:24:14 INFO  ---RUNTIME: Importing and monkey-patching took 6.1492919921875 ms
2022-09-25 00:24:24 INFO  ---RUNTIME: Original pipeline execution took 10355.034828186035 ms (excluding imports and monkey-patching)
2022-09-25 00:24:24 INFO  Starting execution of 1 what-if analyses...
2022-09-25 00:24:24 INFO  Start plan generation for analysis PermutationFeatureImportance...
2022-09-25 00:24:24 INFO  ---RUNTIME: Plan generation took 0.1068115234375 ms
2022-09-25 00:24:24 INFO  Estimated runtime of original DAG is 10042.02914237976ms
2022-09-25 00:24:24 WARNING Skipping Multi-Query Optimization (instead, only applying patches)
2022-09-25 00:24:24 INFO  Estimated unoptimised what-if runtime is 50210.145711898804ms
2022-09-25 00:24:24 INFO  ---RUNTIME: Multi-Query Optimization took 4.138946533203125 ms
2022-09-25 00:24:24 INFO  Executing generated plans
2022-09-25 00:25:14 INFO  ---RUNTIME: Execution took 49867.47884750366 ms
2022-09-25 00:25:14 INFO  Done!
2022-09-25 00:25:14 INFO  # Finished -- repetition 4 of 7 
2022-09-25 00:25:14 INFO  # Optimization benchmark for feature_importance with args [['reviews', 'slow_loading', 'featurization_4', 'logistic_regression']] -- repetition 5 of 7
2022-09-25 00:25:14 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-25 00:25:14 INFO  Running instrumented original pipeline...
2022-09-25 00:25:14 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-25 00:25:14 INFO  ---RUNTIME: Importing and monkey-patching took 7.033348083496094 ms
2022-09-25 00:25:24 INFO  ---RUNTIME: Original pipeline execution took 10076.937913894653 ms (excluding imports and monkey-patching)
2022-09-25 00:25:24 INFO  Starting execution of 1 what-if analyses...
2022-09-25 00:25:24 INFO  Start plan generation for analysis PermutationFeatureImportance...
2022-09-25 00:25:24 INFO  ---RUNTIME: Plan generation took 0.12159347534179688 ms
2022-09-25 00:25:24 INFO  Estimated runtime of original DAG is 9761.760473251343ms
2022-09-25 00:25:24 INFO  Performing Multi-Query Optimization
2022-09-25 00:25:24 INFO  Estimated unoptimized what-if runtime is 48808.802366256714ms
2022-09-25 00:25:24 INFO  Estimated optimised what-if runtime is 9971.260070800781ms
2022-09-25 00:25:24 INFO  Estimated optimisation runtime saving is 38837.54229545593ms
2022-09-25 00:25:24 INFO  ---RUNTIME: Multi-Query Optimization took 11.17849349975586 ms
2022-09-25 00:25:24 INFO  Executing generated plans
2022-09-25 00:25:34 INFO  ---RUNTIME: Execution took 10521.93570137024 ms
2022-09-25 00:25:34 INFO  Done!
2022-09-25 00:25:34 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-25 00:25:34 INFO  Running instrumented original pipeline...
2022-09-25 00:25:34 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-25 00:25:34 INFO  ---RUNTIME: Importing and monkey-patching took 6.181478500366211 ms
2022-09-25 00:25:45 INFO  ---RUNTIME: Original pipeline execution took 10082.510232925415 ms (excluding imports and monkey-patching)
2022-09-25 00:25:45 INFO  Starting execution of 1 what-if analyses...
2022-09-25 00:25:45 INFO  Start plan generation for analysis PermutationFeatureImportance...
2022-09-25 00:25:45 INFO  ---RUNTIME: Plan generation took 0.12612342834472656 ms
2022-09-25 00:25:45 INFO  Estimated runtime of original DAG is 9764.589071273804ms
2022-09-25 00:25:45 WARNING Skipping Multi-Query Optimization (instead, only applying patches)
2022-09-25 00:25:45 INFO  Estimated unoptimised what-if runtime is 48822.94535636902ms
2022-09-25 00:25:45 INFO  ---RUNTIME: Multi-Query Optimization took 4.216909408569336 ms
2022-09-25 00:25:45 INFO  Executing generated plans
2022-09-25 00:26:34 INFO  ---RUNTIME: Execution took 49766.92581176758 ms
2022-09-25 00:26:34 INFO  Done!
2022-09-25 00:26:34 INFO  # Finished -- repetition 5 of 7 
2022-09-25 00:26:34 INFO  # Optimization benchmark for feature_importance with args [['reviews', 'slow_loading', 'featurization_4', 'logistic_regression']] -- repetition 6 of 7
2022-09-25 00:26:34 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-25 00:26:34 INFO  Running instrumented original pipeline...
2022-09-25 00:26:34 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-25 00:26:34 INFO  ---RUNTIME: Importing and monkey-patching took 6.494283676147461 ms
2022-09-25 00:26:44 INFO  ---RUNTIME: Original pipeline execution took 9997.824907302856 ms (excluding imports and monkey-patching)
2022-09-25 00:26:44 INFO  Starting execution of 1 what-if analyses...
2022-09-25 00:26:44 INFO  Start plan generation for analysis PermutationFeatureImportance...
2022-09-25 00:26:44 INFO  ---RUNTIME: Plan generation took 0.11944770812988281 ms
2022-09-25 00:26:44 INFO  Estimated runtime of original DAG is 9683.917760848999ms
2022-09-25 00:26:44 INFO  Performing Multi-Query Optimization
2022-09-25 00:26:44 INFO  Estimated unoptimized what-if runtime is 48419.588804244995ms
2022-09-25 00:26:44 INFO  Estimated optimised what-if runtime is 9903.18751335144ms
2022-09-25 00:26:44 INFO  Estimated optimisation runtime saving is 38516.401290893555ms
2022-09-25 00:26:44 INFO  ---RUNTIME: Multi-Query Optimization took 10.90097427368164 ms
2022-09-25 00:26:44 INFO  Executing generated plans
2022-09-25 00:26:54 INFO  ---RUNTIME: Execution took 10149.653673171997 ms
2022-09-25 00:26:54 INFO  Done!
2022-09-25 00:26:55 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-25 00:26:55 INFO  Running instrumented original pipeline...
2022-09-25 00:26:55 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-25 00:26:55 INFO  ---RUNTIME: Importing and monkey-patching took 6.216287612915039 ms
2022-09-25 00:27:05 INFO  ---RUNTIME: Original pipeline execution took 10466.56322479248 ms (excluding imports and monkey-patching)
2022-09-25 00:27:05 INFO  Starting execution of 1 what-if analyses...
2022-09-25 00:27:05 INFO  Start plan generation for analysis PermutationFeatureImportance...
2022-09-25 00:27:05 INFO  ---RUNTIME: Plan generation took 0.09751319885253906 ms
2022-09-25 00:27:05 INFO  Estimated runtime of original DAG is 10151.742458343506ms
2022-09-25 00:27:05 WARNING Skipping Multi-Query Optimization (instead, only applying patches)
2022-09-25 00:27:05 INFO  Estimated unoptimised what-if runtime is 50758.71229171753ms
2022-09-25 00:27:05 INFO  ---RUNTIME: Multi-Query Optimization took 4.119396209716797 ms
2022-09-25 00:27:05 INFO  Executing generated plans
2022-09-25 00:27:56 INFO  ---RUNTIME: Execution took 50681.628942489624 ms
2022-09-25 00:27:56 INFO  Done!
2022-09-25 00:27:56 INFO  # Finished -- repetition 6 of 7 
2022-09-25 00:27:56 INFO  # Optimization benchmark for feature_importance with args [['reviews', 'slow_loading', 'featurization_4', 'logistic_regression']] -- repetition 7 of 7
2022-09-25 00:27:56 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-25 00:27:56 INFO  Running instrumented original pipeline...
2022-09-25 00:27:56 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-25 00:27:56 INFO  ---RUNTIME: Importing and monkey-patching took 6.379604339599609 ms
2022-09-25 00:28:06 INFO  ---RUNTIME: Original pipeline execution took 10416.35274887085 ms (excluding imports and monkey-patching)
2022-09-25 00:28:06 INFO  Starting execution of 1 what-if analyses...
2022-09-25 00:28:06 INFO  Start plan generation for analysis PermutationFeatureImportance...
2022-09-25 00:28:06 INFO  ---RUNTIME: Plan generation took 0.10180473327636719 ms
2022-09-25 00:28:06 INFO  Estimated runtime of original DAG is 10097.727298736572ms
2022-09-25 00:28:06 INFO  Performing Multi-Query Optimization
2022-09-25 00:28:06 INFO  Estimated unoptimized what-if runtime is 50488.63649368286ms
2022-09-25 00:28:06 INFO  Estimated optimised what-if runtime is 10307.008266448975ms
2022-09-25 00:28:06 INFO  Estimated optimisation runtime saving is 40181.62822723389ms
2022-09-25 00:28:06 INFO  ---RUNTIME: Multi-Query Optimization took 10.957956314086914 ms
2022-09-25 00:28:06 INFO  Executing generated plans
2022-09-25 00:28:16 INFO  ---RUNTIME: Execution took 10225.748062133789 ms
2022-09-25 00:28:16 INFO  Done!
2022-09-25 00:28:16 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-25 00:28:16 INFO  Running instrumented original pipeline...
2022-09-25 00:28:16 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-25 00:28:16 INFO  ---RUNTIME: Importing and monkey-patching took 5.984067916870117 ms
2022-09-25 00:28:27 INFO  ---RUNTIME: Original pipeline execution took 10209.884405136108 ms (excluding imports and monkey-patching)
2022-09-25 00:28:27 INFO  Starting execution of 1 what-if analyses...
2022-09-25 00:28:27 INFO  Start plan generation for analysis PermutationFeatureImportance...
2022-09-25 00:28:27 INFO  ---RUNTIME: Plan generation took 0.11920928955078125 ms
2022-09-25 00:28:27 INFO  Estimated runtime of original DAG is 9894.609928131104ms
2022-09-25 00:28:27 WARNING Skipping Multi-Query Optimization (instead, only applying patches)
2022-09-25 00:28:27 INFO  Estimated unoptimised what-if runtime is 49473.04964065552ms
2022-09-25 00:28:27 INFO  ---RUNTIME: Multi-Query Optimization took 4.237890243530273 ms
2022-09-25 00:28:27 INFO  Executing generated plans
2022-09-25 00:29:16 INFO  ---RUNTIME: Execution took 49712.36181259155 ms
2022-09-25 00:29:16 INFO  Done!
2022-09-25 00:29:16 INFO  # Finished -- repetition 7 of 7 
2022-09-25 00:29:16 INFO  # Final results after all repetitions
2022-09-25 00:29:16 INFO     repetition  ... no_opt_what_if_execution_combined_model_training
0           0  ...                                       861.482143
1           1  ...                                       874.248028
2           2  ...                                       851.498365
3           3  ...                                       851.420164
4           4  ...                                       855.519772
5           5  ...                                       847.576141
6           6  ...                                       847.550392

[7 rows x 26 columns]
PROTOCOL_BUFFERS_PYTHON_IMPLEMENTATION=python taskset -c 32-39 python3.9 benchmarks_end_to_end.py feature_importance reviews slow_loading featurization_4 xgboost
2022-09-25 00:29:19.141495: W tensorflow/stream_executor/platform/default/dso_loader.cc:64] Could not load dynamic library 'libcudart.so.11.0'; dlerror: libcudart.so.11.0: cannot open shared object file: No such file or directory; LD_LIBRARY_PATH: /home/sgrafbe/mlwhatif/venv/lib/python3.9/site-packages/cv2/../../lib64:
2022-09-25 00:29:19.141542: I tensorflow/stream_executor/cuda/cudart_stub.cc:29] Ignore above cudart dlerror if you do not have a GPU set up on your machine.
2022-09-25 00:29:20 INFO  Patching sys.argv with ['mlwhatif', 'reviews', 'slow_loading', 'featurization_4', 'xgboost']
2022-09-25 00:29:20 INFO  Running instrumented original pipeline...
2022-09-25 00:29:20 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-25 00:29:20 INFO  ---RUNTIME: Importing and monkey-patching took 96.43244743347168 ms
2022-09-25 00:29:42 INFO  ---RUNTIME: Original pipeline execution took 22452.286958694458 ms (excluding imports and monkey-patching)
2022-09-25 00:29:42 INFO  Starting execution of 0 what-if analyses...
2022-09-25 00:29:42 INFO  Estimated runtime of original DAG is 22101.963996887207ms
2022-09-25 00:29:42 INFO  Performing Multi-Query Optimization
2022-09-25 00:29:42 INFO  Estimated unoptimized what-if runtime is 0ms
2022-09-25 00:29:42 INFO  Estimated optimised what-if runtime is 0ms
2022-09-25 00:29:42 INFO  Estimated optimisation runtime saving is 0ms
2022-09-25 00:29:42 INFO  ---RUNTIME: Multi-Query Optimization took 0.5390644073486328 ms
2022-09-25 00:29:42 INFO  Executing generated plans
2022-09-25 00:29:42 INFO  ---RUNTIME: Execution took 0.025510787963867188 ms
2022-09-25 00:29:42 INFO  Done!
2022-09-25 00:29:42 INFO  # Optimization benchmark for feature_importance with args [['reviews', 'slow_loading', 'featurization_4', 'xgboost']] -- repetition 1 of 7
2022-09-25 00:29:42 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-25 00:29:42 INFO  Running instrumented original pipeline...
2022-09-25 00:29:43 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-25 00:29:43 INFO  ---RUNTIME: Importing and monkey-patching took 5.558252334594727 ms
2022-09-25 00:30:05 INFO  ---RUNTIME: Original pipeline execution took 22495.622873306274 ms (excluding imports and monkey-patching)
2022-09-25 00:30:05 INFO  Starting execution of 1 what-if analyses...
2022-09-25 00:30:05 INFO  Start plan generation for analysis PermutationFeatureImportance...
2022-09-25 00:30:05 INFO  ---RUNTIME: Plan generation took 0.2193450927734375 ms
2022-09-25 00:30:05 INFO  Estimated runtime of original DAG is 22130.02586364746ms
2022-09-25 00:30:05 INFO  Performing Multi-Query Optimization
2022-09-25 00:30:05 INFO  Estimated unoptimized what-if runtime is 110650.1293182373ms
2022-09-25 00:30:05 INFO  Estimated optimised what-if runtime is 23545.840740203857ms
2022-09-25 00:30:05 INFO  Estimated optimisation runtime saving is 87104.28857803345ms
2022-09-25 00:30:05 INFO  ---RUNTIME: Multi-Query Optimization took 10.955095291137695 ms
2022-09-25 00:30:05 INFO  Executing generated plans
2022-09-25 00:30:28 INFO  ---RUNTIME: Execution took 23401.079416275024 ms
2022-09-25 00:30:28 INFO  Done!
2022-09-25 00:30:28 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-25 00:30:28 INFO  Running instrumented original pipeline...
2022-09-25 00:30:28 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-25 00:30:28 INFO  ---RUNTIME: Importing and monkey-patching took 6.364583969116211 ms
2022-09-25 00:30:51 INFO  ---RUNTIME: Original pipeline execution took 22311.673164367676 ms (excluding imports and monkey-patching)
2022-09-25 00:30:51 INFO  Starting execution of 1 what-if analyses...
2022-09-25 00:30:51 INFO  Start plan generation for analysis PermutationFeatureImportance...
2022-09-25 00:30:51 INFO  ---RUNTIME: Plan generation took 0.13947486877441406 ms
2022-09-25 00:30:51 INFO  Estimated runtime of original DAG is 21996.665954589844ms
2022-09-25 00:30:51 WARNING Skipping Multi-Query Optimization (instead, only applying patches)
2022-09-25 00:30:51 INFO  Estimated unoptimised what-if runtime is 109983.32977294922ms
2022-09-25 00:30:51 INFO  ---RUNTIME: Multi-Query Optimization took 4.223823547363281 ms
2022-09-25 00:30:51 INFO  Executing generated plans
2022-09-25 00:32:41 INFO  ---RUNTIME: Execution took 110464.22934532166 ms
2022-09-25 00:32:41 INFO  Done!
2022-09-25 00:32:41 INFO  # Finished -- repetition 1 of 7 
2022-09-25 00:32:41 INFO  # Optimization benchmark for feature_importance with args [['reviews', 'slow_loading', 'featurization_4', 'xgboost']] -- repetition 2 of 7
2022-09-25 00:32:41 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-25 00:32:41 INFO  Running instrumented original pipeline...
2022-09-25 00:32:41 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-25 00:32:41 INFO  ---RUNTIME: Importing and monkey-patching took 6.914854049682617 ms
2022-09-25 00:33:03 INFO  ---RUNTIME: Original pipeline execution took 22307.889223098755 ms (excluding imports and monkey-patching)
2022-09-25 00:33:03 INFO  Starting execution of 1 what-if analyses...
2022-09-25 00:33:03 INFO  Start plan generation for analysis PermutationFeatureImportance...
2022-09-25 00:33:03 INFO  ---RUNTIME: Plan generation took 0.13446807861328125 ms
2022-09-25 00:33:03 INFO  Estimated runtime of original DAG is 21990.862131118774ms
2022-09-25 00:33:03 INFO  Performing Multi-Query Optimization
2022-09-25 00:33:03 INFO  Estimated unoptimized what-if runtime is 109954.31065559387ms
2022-09-25 00:33:03 INFO  Estimated optimised what-if runtime is 23393.33486557007ms
2022-09-25 00:33:03 INFO  Estimated optimisation runtime saving is 86560.9757900238ms
2022-09-25 00:33:03 INFO  ---RUNTIME: Multi-Query Optimization took 11.539936065673828 ms
2022-09-25 00:33:03 INFO  Executing generated plans
2022-09-25 00:33:27 INFO  ---RUNTIME: Execution took 23386.5225315094 ms
2022-09-25 00:33:27 INFO  Done!
2022-09-25 00:33:27 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-25 00:33:27 INFO  Running instrumented original pipeline...
2022-09-25 00:33:27 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-25 00:33:27 INFO  ---RUNTIME: Importing and monkey-patching took 6.341457366943359 ms
2022-09-25 00:33:49 INFO  ---RUNTIME: Original pipeline execution took 22427.93345451355 ms (excluding imports and monkey-patching)
2022-09-25 00:33:49 INFO  Starting execution of 1 what-if analyses...
2022-09-25 00:33:49 INFO  Start plan generation for analysis PermutationFeatureImportance...
2022-09-25 00:33:49 INFO  ---RUNTIME: Plan generation took 0.10800361633300781 ms
2022-09-25 00:33:49 INFO  Estimated runtime of original DAG is 22104.148864746094ms
2022-09-25 00:33:49 WARNING Skipping Multi-Query Optimization (instead, only applying patches)
2022-09-25 00:33:49 INFO  Estimated unoptimised what-if runtime is 110520.74432373047ms
2022-09-25 00:33:49 INFO  ---RUNTIME: Multi-Query Optimization took 4.16111946105957 ms
2022-09-25 00:33:49 INFO  Executing generated plans
2022-09-25 00:35:39 INFO  ---RUNTIME: Execution took 109468.8994884491 ms
2022-09-25 00:35:39 INFO  Done!
2022-09-25 00:35:39 INFO  # Finished -- repetition 2 of 7 
2022-09-25 00:35:39 INFO  # Optimization benchmark for feature_importance with args [['reviews', 'slow_loading', 'featurization_4', 'xgboost']] -- repetition 3 of 7
2022-09-25 00:35:39 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-25 00:35:39 INFO  Running instrumented original pipeline...
2022-09-25 00:35:39 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-25 00:35:39 INFO  ---RUNTIME: Importing and monkey-patching took 6.026029586791992 ms
2022-09-25 00:36:01 INFO  ---RUNTIME: Original pipeline execution took 22192.641973495483 ms (excluding imports and monkey-patching)
2022-09-25 00:36:01 INFO  Starting execution of 1 what-if analyses...
2022-09-25 00:36:01 INFO  Start plan generation for analysis PermutationFeatureImportance...
2022-09-25 00:36:01 INFO  ---RUNTIME: Plan generation took 0.12755393981933594 ms
2022-09-25 00:36:01 INFO  Estimated runtime of original DAG is 21873.744010925293ms
2022-09-25 00:36:01 INFO  Performing Multi-Query Optimization
2022-09-25 00:36:01 INFO  Estimated unoptimized what-if runtime is 109368.72005462646ms
2022-09-25 00:36:01 INFO  Estimated optimised what-if runtime is 23343.263864517212ms
2022-09-25 00:36:01 INFO  Estimated optimisation runtime saving is 86025.45619010925ms
2022-09-25 00:36:01 INFO  ---RUNTIME: Multi-Query Optimization took 10.855674743652344 ms
2022-09-25 00:36:01 INFO  Executing generated plans
2022-09-25 00:36:24 INFO  ---RUNTIME: Execution took 23239.500284194946 ms
2022-09-25 00:36:24 INFO  Done!
2022-09-25 00:36:24 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-25 00:36:24 INFO  Running instrumented original pipeline...
2022-09-25 00:36:24 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-25 00:36:24 INFO  ---RUNTIME: Importing and monkey-patching took 6.435394287109375 ms
2022-09-25 00:36:46 INFO  ---RUNTIME: Original pipeline execution took 22120.96905708313 ms (excluding imports and monkey-patching)
2022-09-25 00:36:46 INFO  Starting execution of 1 what-if analyses...
2022-09-25 00:36:46 INFO  Start plan generation for analysis PermutationFeatureImportance...
2022-09-25 00:36:46 INFO  ---RUNTIME: Plan generation took 0.11944770812988281 ms
2022-09-25 00:36:46 INFO  Estimated runtime of original DAG is 21798.18630218506ms
2022-09-25 00:36:46 WARNING Skipping Multi-Query Optimization (instead, only applying patches)
2022-09-25 00:36:46 INFO  Estimated unoptimised what-if runtime is 108990.9315109253ms
2022-09-25 00:36:46 INFO  ---RUNTIME: Multi-Query Optimization took 4.239082336425781 ms
2022-09-25 00:36:46 INFO  Executing generated plans
2022-09-25 00:38:37 INFO  ---RUNTIME: Execution took 110267.34161376953 ms
2022-09-25 00:38:37 INFO  Done!
2022-09-25 00:38:37 INFO  # Finished -- repetition 3 of 7 
2022-09-25 00:38:37 INFO  # Optimization benchmark for feature_importance with args [['reviews', 'slow_loading', 'featurization_4', 'xgboost']] -- repetition 4 of 7
2022-09-25 00:38:37 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-25 00:38:37 INFO  Running instrumented original pipeline...
2022-09-25 00:38:37 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-25 00:38:37 INFO  ---RUNTIME: Importing and monkey-patching took 6.023406982421875 ms
2022-09-25 00:38:59 INFO  ---RUNTIME: Original pipeline execution took 22339.632511138916 ms (excluding imports and monkey-patching)
2022-09-25 00:38:59 INFO  Starting execution of 1 what-if analyses...
2022-09-25 00:38:59 INFO  Start plan generation for analysis PermutationFeatureImportance...
2022-09-25 00:38:59 INFO  ---RUNTIME: Plan generation took 0.1537799835205078 ms
2022-09-25 00:38:59 INFO  Estimated runtime of original DAG is 21805.346727371216ms
2022-09-25 00:38:59 INFO  Performing Multi-Query Optimization
2022-09-25 00:38:59 INFO  Estimated unoptimized what-if runtime is 109026.73363685608ms
2022-09-25 00:38:59 INFO  Estimated optimised what-if runtime is 23223.84810447693ms
2022-09-25 00:38:59 INFO  Estimated optimisation runtime saving is 85802.88553237915ms
2022-09-25 00:38:59 INFO  ---RUNTIME: Multi-Query Optimization took 10.868549346923828 ms
2022-09-25 00:38:59 INFO  Executing generated plans
2022-09-25 00:39:22 INFO  ---RUNTIME: Execution took 23218.96505355835 ms
2022-09-25 00:39:22 INFO  Done!
2022-09-25 00:39:22 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-25 00:39:22 INFO  Running instrumented original pipeline...
2022-09-25 00:39:22 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-25 00:39:22 INFO  ---RUNTIME: Importing and monkey-patching took 6.208658218383789 ms
2022-09-25 00:39:45 INFO  ---RUNTIME: Original pipeline execution took 22261.970281600952 ms (excluding imports and monkey-patching)
2022-09-25 00:39:45 INFO  Starting execution of 1 what-if analyses...
2022-09-25 00:39:45 INFO  Start plan generation for analysis PermutationFeatureImportance...
2022-09-25 00:39:45 INFO  ---RUNTIME: Plan generation took 0.10728836059570312 ms
2022-09-25 00:39:45 INFO  Estimated runtime of original DAG is 21945.868253707886ms
2022-09-25 00:39:45 WARNING Skipping Multi-Query Optimization (instead, only applying patches)
2022-09-25 00:39:45 INFO  Estimated unoptimised what-if runtime is 109729.34126853943ms
2022-09-25 00:39:45 INFO  ---RUNTIME: Multi-Query Optimization took 4.408836364746094 ms
2022-09-25 00:39:45 INFO  Executing generated plans
2022-09-25 00:41:34 INFO  ---RUNTIME: Execution took 109452.29625701904 ms
2022-09-25 00:41:34 INFO  Done!
2022-09-25 00:41:34 INFO  # Finished -- repetition 4 of 7 
2022-09-25 00:41:34 INFO  # Optimization benchmark for feature_importance with args [['reviews', 'slow_loading', 'featurization_4', 'xgboost']] -- repetition 5 of 7
2022-09-25 00:41:34 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-25 00:41:34 INFO  Running instrumented original pipeline...
2022-09-25 00:41:34 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-25 00:41:34 INFO  ---RUNTIME: Importing and monkey-patching took 6.515026092529297 ms
2022-09-25 00:41:56 INFO  ---RUNTIME: Original pipeline execution took 22187.549829483032 ms (excluding imports and monkey-patching)
2022-09-25 00:41:56 INFO  Starting execution of 1 what-if analyses...
2022-09-25 00:41:56 INFO  Start plan generation for analysis PermutationFeatureImportance...
2022-09-25 00:41:56 INFO  ---RUNTIME: Plan generation took 0.1404285430908203 ms
2022-09-25 00:41:56 INFO  Estimated runtime of original DAG is 21868.091821670532ms
2022-09-25 00:41:56 INFO  Performing Multi-Query Optimization
2022-09-25 00:41:56 INFO  Estimated unoptimized what-if runtime is 109340.45910835266ms
2022-09-25 00:41:56 INFO  Estimated optimised what-if runtime is 23279.27541732788ms
2022-09-25 00:41:56 INFO  Estimated optimisation runtime saving is 86061.18369102478ms
2022-09-25 00:41:56 INFO  ---RUNTIME: Multi-Query Optimization took 11.296987533569336 ms
2022-09-25 00:41:56 INFO  Executing generated plans
2022-09-25 00:42:20 INFO  ---RUNTIME: Execution took 23732.7880859375 ms
2022-09-25 00:42:20 INFO  Done!
2022-09-25 00:42:20 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-25 00:42:20 INFO  Running instrumented original pipeline...
2022-09-25 00:42:20 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-25 00:42:20 INFO  ---RUNTIME: Importing and monkey-patching took 6.073474884033203 ms
2022-09-25 00:42:42 INFO  ---RUNTIME: Original pipeline execution took 22065.43254852295 ms (excluding imports and monkey-patching)
2022-09-25 00:42:42 INFO  Starting execution of 1 what-if analyses...
2022-09-25 00:42:42 INFO  Start plan generation for analysis PermutationFeatureImportance...
2022-09-25 00:42:42 INFO  ---RUNTIME: Plan generation took 0.14448165893554688 ms
2022-09-25 00:42:42 INFO  Estimated runtime of original DAG is 21750.120878219604ms
2022-09-25 00:42:42 WARNING Skipping Multi-Query Optimization (instead, only applying patches)
2022-09-25 00:42:42 INFO  Estimated unoptimised what-if runtime is 108750.60439109802ms
2022-09-25 00:42:42 INFO  ---RUNTIME: Multi-Query Optimization took 4.239082336425781 ms
2022-09-25 00:42:42 INFO  Executing generated plans
2022-09-25 00:44:32 INFO  ---RUNTIME: Execution took 110303.02834510803 ms
2022-09-25 00:44:32 INFO  Done!
2022-09-25 00:44:32 INFO  # Finished -- repetition 5 of 7 
2022-09-25 00:44:32 INFO  # Optimization benchmark for feature_importance with args [['reviews', 'slow_loading', 'featurization_4', 'xgboost']] -- repetition 6 of 7
2022-09-25 00:44:32 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-25 00:44:32 INFO  Running instrumented original pipeline...
2022-09-25 00:44:33 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-25 00:44:33 INFO  ---RUNTIME: Importing and monkey-patching took 6.441354751586914 ms
2022-09-25 00:44:55 INFO  ---RUNTIME: Original pipeline execution took 22102.386951446533 ms (excluding imports and monkey-patching)
2022-09-25 00:44:55 INFO  Starting execution of 1 what-if analyses...
2022-09-25 00:44:55 INFO  Start plan generation for analysis PermutationFeatureImportance...
2022-09-25 00:44:55 INFO  ---RUNTIME: Plan generation took 0.1347064971923828 ms
2022-09-25 00:44:55 INFO  Estimated runtime of original DAG is 21781.911611557007ms
2022-09-25 00:44:55 INFO  Performing Multi-Query Optimization
2022-09-25 00:44:55 INFO  Estimated unoptimized what-if runtime is 108909.55805778503ms
2022-09-25 00:44:55 INFO  Estimated optimised what-if runtime is 23206.323623657227ms
2022-09-25 00:44:55 INFO  Estimated optimisation runtime saving is 85703.23443412781ms
2022-09-25 00:44:55 INFO  ---RUNTIME: Multi-Query Optimization took 10.970830917358398 ms
2022-09-25 00:44:55 INFO  Executing generated plans
2022-09-25 00:45:18 INFO  ---RUNTIME: Execution took 23274.670362472534 ms
2022-09-25 00:45:18 INFO  Done!
2022-09-25 00:45:18 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-25 00:45:18 INFO  Running instrumented original pipeline...
2022-09-25 00:45:18 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-25 00:45:18 INFO  ---RUNTIME: Importing and monkey-patching took 6.528615951538086 ms
2022-09-25 00:45:41 INFO  ---RUNTIME: Original pipeline execution took 22733.521938323975 ms (excluding imports and monkey-patching)
2022-09-25 00:45:41 INFO  Starting execution of 1 what-if analyses...
2022-09-25 00:45:41 INFO  Start plan generation for analysis PermutationFeatureImportance...
2022-09-25 00:45:41 INFO  ---RUNTIME: Plan generation took 0.1316070556640625 ms
2022-09-25 00:45:41 INFO  Estimated runtime of original DAG is 22413.771390914917ms
2022-09-25 00:45:41 WARNING Skipping Multi-Query Optimization (instead, only applying patches)
2022-09-25 00:45:41 INFO  Estimated unoptimised what-if runtime is 112068.85695457458ms
2022-09-25 00:45:41 INFO  ---RUNTIME: Multi-Query Optimization took 4.467487335205078 ms
2022-09-25 00:45:41 INFO  Executing generated plans
2022-09-25 00:47:30 INFO  ---RUNTIME: Execution took 109469.41947937012 ms
2022-09-25 00:47:30 INFO  Done!
2022-09-25 00:47:30 INFO  # Finished -- repetition 6 of 7 
2022-09-25 00:47:30 INFO  # Optimization benchmark for feature_importance with args [['reviews', 'slow_loading', 'featurization_4', 'xgboost']] -- repetition 7 of 7
2022-09-25 00:47:30 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-25 00:47:30 INFO  Running instrumented original pipeline...
2022-09-25 00:47:30 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-25 00:47:30 INFO  ---RUNTIME: Importing and monkey-patching took 6.791591644287109 ms
2022-09-25 00:47:53 INFO  ---RUNTIME: Original pipeline execution took 22384.698152542114 ms (excluding imports and monkey-patching)
2022-09-25 00:47:53 INFO  Starting execution of 1 what-if analyses...
2022-09-25 00:47:53 INFO  Start plan generation for analysis PermutationFeatureImportance...
2022-09-25 00:47:53 INFO  ---RUNTIME: Plan generation took 0.1327991485595703 ms
2022-09-25 00:47:53 INFO  Estimated runtime of original DAG is 22060.429573059082ms
2022-09-25 00:47:53 INFO  Performing Multi-Query Optimization
2022-09-25 00:47:53 INFO  Estimated unoptimized what-if runtime is 110302.14786529541ms
2022-09-25 00:47:53 INFO  Estimated optimised what-if runtime is 23486.108779907227ms
2022-09-25 00:47:53 INFO  Estimated optimisation runtime saving is 86816.03908538818ms
2022-09-25 00:47:53 INFO  ---RUNTIME: Multi-Query Optimization took 11.253595352172852 ms
2022-09-25 00:47:53 INFO  Executing generated plans
2022-09-25 00:48:17 INFO  ---RUNTIME: Execution took 24136.378049850464 ms
2022-09-25 00:48:17 INFO  Done!
2022-09-25 00:48:17 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-25 00:48:17 INFO  Running instrumented original pipeline...
2022-09-25 00:48:17 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-25 00:48:17 INFO  ---RUNTIME: Importing and monkey-patching took 10.72382926940918 ms
2022-09-25 00:48:39 INFO  ---RUNTIME: Original pipeline execution took 22241.595029830933 ms (excluding imports and monkey-patching)
2022-09-25 00:48:39 INFO  Starting execution of 1 what-if analyses...
2022-09-25 00:48:39 INFO  Start plan generation for analysis PermutationFeatureImportance...
2022-09-25 00:48:39 INFO  ---RUNTIME: Plan generation took 0.13756752014160156 ms
2022-09-25 00:48:39 INFO  Estimated runtime of original DAG is 21920.953035354614ms
2022-09-25 00:48:39 WARNING Skipping Multi-Query Optimization (instead, only applying patches)
2022-09-25 00:48:39 INFO  Estimated unoptimised what-if runtime is 109604.76517677307ms
2022-09-25 00:48:39 INFO  ---RUNTIME: Multi-Query Optimization took 4.296064376831055 ms
2022-09-25 00:48:39 INFO  Executing generated plans
2022-09-25 00:50:29 INFO  ---RUNTIME: Execution took 109682.91306495667 ms
2022-09-25 00:50:29 INFO  Done!
2022-09-25 00:50:29 INFO  # Finished -- repetition 7 of 7 
2022-09-25 00:50:29 INFO  # Final results after all repetitions
2022-09-25 00:50:29 INFO     repetition  ... no_opt_what_if_execution_combined_model_training
0           0  ...                                     60092.779636
1           1  ...                                     59833.992243
2           2  ...                                     59923.652887
3           3  ...                                     59832.007408
4           4  ...                                     59778.344154
5           5  ...                                     59858.316898
6           6  ...                                     59739.168882

[7 rows x 26 columns]
PROTOCOL_BUFFERS_PYTHON_IMPLEMENTATION=python taskset -c 32-39 python3.9 benchmarks_end_to_end.py feature_importance reviews slow_loading featurization_4 neural_network
2022-09-25 00:50:31.440768: W tensorflow/stream_executor/platform/default/dso_loader.cc:64] Could not load dynamic library 'libcudart.so.11.0'; dlerror: libcudart.so.11.0: cannot open shared object file: No such file or directory; LD_LIBRARY_PATH: /home/sgrafbe/mlwhatif/venv/lib/python3.9/site-packages/cv2/../../lib64:
2022-09-25 00:50:31.440813: I tensorflow/stream_executor/cuda/cudart_stub.cc:29] Ignore above cudart dlerror if you do not have a GPU set up on your machine.
2022-09-25 00:50:32 INFO  Patching sys.argv with ['mlwhatif', 'reviews', 'slow_loading', 'featurization_4', 'neural_network']
2022-09-25 00:50:32 INFO  Running instrumented original pipeline...
2022-09-25 00:50:32 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-25 00:50:32 INFO  ---RUNTIME: Importing and monkey-patching took 96.49872779846191 ms
2022-09-25 00:50:42.938817: W tensorflow/stream_executor/platform/default/dso_loader.cc:64] Could not load dynamic library 'libcuda.so.1'; dlerror: libcuda.so.1: cannot open shared object file: No such file or directory; LD_LIBRARY_PATH: /home/sgrafbe/mlwhatif/venv/lib/python3.9/site-packages/cv2/../../lib64:
2022-09-25 00:50:42.938853: W tensorflow/stream_executor/cuda/cuda_driver.cc:326] failed call to cuInit: UNKNOWN ERROR (303)
2022-09-25 00:50:42.938877: I tensorflow/stream_executor/cuda/cuda_diagnostics.cc:156] kernel driver does not appear to be running on this host (wagyu): /proc/driver/nvidia/version does not exist
2022-09-25 00:50:42.939417: I tensorflow/core/platform/cpu_feature_guard.cc:142] This TensorFlow binary is optimized with oneAPI Deep Neural Network Library (oneDNN) to use the following CPU instructions in performance-critical operations:  AVX2 FMA
To enable them in other operations, rebuild TensorFlow with the appropriate compiler flags.
2022-09-25 00:50:43.013454: I tensorflow/compiler/mlir/mlir_graph_optimization_pass.cc:176] None of the MLIR Optimization Passes are enabled (registered 2)
2022-09-25 00:50:43.025384: I tensorflow/core/platform/profile_utils/cpu_utils.cc:114] CPU Frequency: 2595290000 Hz
2022-09-25 00:50:46 INFO  ---RUNTIME: Original pipeline execution took 14175.644159317017 ms (excluding imports and monkey-patching)
2022-09-25 00:50:46 INFO  Starting execution of 0 what-if analyses...
2022-09-25 00:50:46 INFO  Estimated runtime of original DAG is 13813.297986984253ms
2022-09-25 00:50:46 INFO  Performing Multi-Query Optimization
2022-09-25 00:50:46 INFO  Estimated unoptimized what-if runtime is 0ms
2022-09-25 00:50:46 INFO  Estimated optimised what-if runtime is 0ms
2022-09-25 00:50:46 INFO  Estimated optimisation runtime saving is 0ms
2022-09-25 00:50:46 INFO  ---RUNTIME: Multi-Query Optimization took 0.5562305450439453 ms
2022-09-25 00:50:46 INFO  Executing generated plans
2022-09-25 00:50:46 INFO  ---RUNTIME: Execution took 0.02384185791015625 ms
2022-09-25 00:50:46 INFO  Done!
2022-09-25 00:50:46 INFO  # Optimization benchmark for feature_importance with args [['reviews', 'slow_loading', 'featurization_4', 'neural_network']] -- repetition 1 of 7
2022-09-25 00:50:46 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-25 00:50:46 INFO  Running instrumented original pipeline...
2022-09-25 00:50:47 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-25 00:50:47 INFO  ---RUNTIME: Importing and monkey-patching took 5.53584098815918 ms
2022-09-25 00:51:00 INFO  ---RUNTIME: Original pipeline execution took 13639.583587646484 ms (excluding imports and monkey-patching)
2022-09-25 00:51:00 INFO  Starting execution of 1 what-if analyses...
2022-09-25 00:51:00 INFO  Start plan generation for analysis PermutationFeatureImportance...
2022-09-25 00:51:00 INFO  ---RUNTIME: Plan generation took 0.22649765014648438 ms
2022-09-25 00:51:00 INFO  Estimated runtime of original DAG is 13311.707735061646ms
2022-09-25 00:51:00 INFO  Performing Multi-Query Optimization
2022-09-25 00:51:00 INFO  Estimated unoptimized what-if runtime is 66558.53867530823ms
2022-09-25 00:51:00 INFO  Estimated optimised what-if runtime is 15062.276601791382ms
2022-09-25 00:51:00 INFO  Estimated optimisation runtime saving is 51496.262073516846ms
2022-09-25 00:51:00 INFO  ---RUNTIME: Multi-Query Optimization took 226.6557216644287 ms
2022-09-25 00:51:00 INFO  Executing generated plans
2022-09-25 00:51:15 INFO  ---RUNTIME: Execution took 15111.50574684143 ms
2022-09-25 00:51:15 INFO  Done!
2022-09-25 00:51:15 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-25 00:51:15 INFO  Running instrumented original pipeline...
2022-09-25 00:51:16 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-25 00:51:16 INFO  ---RUNTIME: Importing and monkey-patching took 6.885528564453125 ms
2022-09-25 00:51:29 INFO  ---RUNTIME: Original pipeline execution took 13722.736597061157 ms (excluding imports and monkey-patching)
2022-09-25 00:51:29 INFO  Starting execution of 1 what-if analyses...
2022-09-25 00:51:29 INFO  Start plan generation for analysis PermutationFeatureImportance...
2022-09-25 00:51:29 INFO  ---RUNTIME: Plan generation took 0.14352798461914062 ms
2022-09-25 00:51:29 INFO  Estimated runtime of original DAG is 13396.364212036133ms
2022-09-25 00:51:29 WARNING Skipping Multi-Query Optimization (instead, only applying patches)
2022-09-25 00:51:29 INFO  Estimated unoptimised what-if runtime is 66981.82106018066ms
2022-09-25 00:51:29 INFO  ---RUNTIME: Multi-Query Optimization took 4.317522048950195 ms
2022-09-25 00:51:29 INFO  Executing generated plans
2022-09-25 00:52:37 INFO  ---RUNTIME: Execution took 68116.47653579712 ms
2022-09-25 00:52:37 INFO  Done!
2022-09-25 00:52:37 INFO  # Finished -- repetition 1 of 7 
2022-09-25 00:52:37 INFO  # Optimization benchmark for feature_importance with args [['reviews', 'slow_loading', 'featurization_4', 'neural_network']] -- repetition 2 of 7
2022-09-25 00:52:37 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-25 00:52:37 INFO  Running instrumented original pipeline...
2022-09-25 00:52:37 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-25 00:52:37 INFO  ---RUNTIME: Importing and monkey-patching took 6.171464920043945 ms
2022-09-25 00:52:51 INFO  ---RUNTIME: Original pipeline execution took 13569.042444229126 ms (excluding imports and monkey-patching)
2022-09-25 00:52:51 INFO  Starting execution of 1 what-if analyses...
2022-09-25 00:52:51 INFO  Start plan generation for analysis PermutationFeatureImportance...
2022-09-25 00:52:51 INFO  ---RUNTIME: Plan generation took 0.15306472778320312 ms
2022-09-25 00:52:51 INFO  Estimated runtime of original DAG is 13243.481874465942ms
2022-09-25 00:52:51 INFO  Performing Multi-Query Optimization
2022-09-25 00:52:51 INFO  Estimated unoptimized what-if runtime is 66217.40937232971ms
2022-09-25 00:52:51 INFO  Estimated optimised what-if runtime is 15033.250331878662ms
2022-09-25 00:52:51 INFO  Estimated optimisation runtime saving is 51184.15904045105ms
2022-09-25 00:52:51 INFO  ---RUNTIME: Multi-Query Optimization took 11.349916458129883 ms
2022-09-25 00:52:51 INFO  Executing generated plans
2022-09-25 00:53:06 INFO  ---RUNTIME: Execution took 15359.827756881714 ms
2022-09-25 00:53:06 INFO  Done!
2022-09-25 00:53:06 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-25 00:53:06 INFO  Running instrumented original pipeline...
2022-09-25 00:53:06 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-25 00:53:06 INFO  ---RUNTIME: Importing and monkey-patching took 6.01506233215332 ms
2022-09-25 00:53:21 INFO  ---RUNTIME: Original pipeline execution took 14223.794937133789 ms (excluding imports and monkey-patching)
2022-09-25 00:53:21 INFO  Starting execution of 1 what-if analyses...
2022-09-25 00:53:21 INFO  Start plan generation for analysis PermutationFeatureImportance...
2022-09-25 00:53:21 INFO  ---RUNTIME: Plan generation took 0.11301040649414062 ms
2022-09-25 00:53:21 INFO  Estimated runtime of original DAG is 13892.138004302979ms
2022-09-25 00:53:21 WARNING Skipping Multi-Query Optimization (instead, only applying patches)
2022-09-25 00:53:21 INFO  Estimated unoptimised what-if runtime is 69460.69002151489ms
2022-09-25 00:53:21 INFO  ---RUNTIME: Multi-Query Optimization took 5.941867828369141 ms
2022-09-25 00:53:21 INFO  Executing generated plans
2022-09-25 00:54:29 INFO  ---RUNTIME: Execution took 68073.31991195679 ms
2022-09-25 00:54:29 INFO  Done!
2022-09-25 00:54:29 INFO  # Finished -- repetition 2 of 7 
2022-09-25 00:54:29 INFO  # Optimization benchmark for feature_importance with args [['reviews', 'slow_loading', 'featurization_4', 'neural_network']] -- repetition 3 of 7
2022-09-25 00:54:29 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-25 00:54:29 INFO  Running instrumented original pipeline...
2022-09-25 00:54:29 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-25 00:54:29 INFO  ---RUNTIME: Importing and monkey-patching took 6.86955451965332 ms
2022-09-25 00:54:42 INFO  ---RUNTIME: Original pipeline execution took 13584.304571151733 ms (excluding imports and monkey-patching)
2022-09-25 00:54:42 INFO  Starting execution of 1 what-if analyses...
2022-09-25 00:54:42 INFO  Start plan generation for analysis PermutationFeatureImportance...
2022-09-25 00:54:42 INFO  ---RUNTIME: Plan generation took 0.13780593872070312 ms
2022-09-25 00:54:42 INFO  Estimated runtime of original DAG is 13255.280494689941ms
2022-09-25 00:54:42 INFO  Performing Multi-Query Optimization
2022-09-25 00:54:42 INFO  Estimated unoptimized what-if runtime is 66276.4024734497ms
2022-09-25 00:54:42 INFO  Estimated optimised what-if runtime is 15049.040079116821ms
2022-09-25 00:54:42 INFO  Estimated optimisation runtime saving is 51227.362394332886ms
2022-09-25 00:54:42 INFO  ---RUNTIME: Multi-Query Optimization took 11.208057403564453 ms
2022-09-25 00:54:42 INFO  Executing generated plans
2022-09-25 00:54:57 INFO  ---RUNTIME: Execution took 15196.87271118164 ms
2022-09-25 00:54:57 INFO  Done!
2022-09-25 00:54:57 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-25 00:54:57 INFO  Running instrumented original pipeline...
2022-09-25 00:54:57 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-25 00:54:57 INFO  ---RUNTIME: Importing and monkey-patching took 6.075620651245117 ms
2022-09-25 00:55:12 INFO  ---RUNTIME: Original pipeline execution took 14145.829677581787 ms (excluding imports and monkey-patching)
2022-09-25 00:55:12 INFO  Starting execution of 1 what-if analyses...
2022-09-25 00:55:12 INFO  Start plan generation for analysis PermutationFeatureImportance...
2022-09-25 00:55:12 INFO  ---RUNTIME: Plan generation took 0.11563301086425781 ms
2022-09-25 00:55:12 INFO  Estimated runtime of original DAG is 13812.803983688354ms
2022-09-25 00:55:12 WARNING Skipping Multi-Query Optimization (instead, only applying patches)
2022-09-25 00:55:12 INFO  Estimated unoptimised what-if runtime is 69064.01991844177ms
2022-09-25 00:55:12 INFO  ---RUNTIME: Multi-Query Optimization took 4.283666610717773 ms
2022-09-25 00:55:12 INFO  Executing generated plans
2022-09-25 00:56:19 INFO  ---RUNTIME: Execution took 67329.17332649231 ms
2022-09-25 00:56:19 INFO  Done!
2022-09-25 00:56:19 INFO  # Finished -- repetition 3 of 7 
2022-09-25 00:56:19 INFO  # Optimization benchmark for feature_importance with args [['reviews', 'slow_loading', 'featurization_4', 'neural_network']] -- repetition 4 of 7
2022-09-25 00:56:19 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-25 00:56:19 INFO  Running instrumented original pipeline...
2022-09-25 00:56:19 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-25 00:56:19 INFO  ---RUNTIME: Importing and monkey-patching took 6.267786026000977 ms
2022-09-25 00:56:33 INFO  ---RUNTIME: Original pipeline execution took 13968.068361282349 ms (excluding imports and monkey-patching)
2022-09-25 00:56:33 INFO  Starting execution of 1 what-if analyses...
2022-09-25 00:56:33 INFO  Start plan generation for analysis PermutationFeatureImportance...
2022-09-25 00:56:33 INFO  ---RUNTIME: Plan generation took 0.10967254638671875 ms
2022-09-25 00:56:33 INFO  Estimated runtime of original DAG is 13637.792587280273ms
2022-09-25 00:56:33 INFO  Performing Multi-Query Optimization
2022-09-25 00:56:33 INFO  Estimated unoptimized what-if runtime is 68188.96293640137ms
2022-09-25 00:56:33 INFO  Estimated optimised what-if runtime is 15417.08779335022ms
2022-09-25 00:56:33 INFO  Estimated optimisation runtime saving is 52771.87514305115ms
2022-09-25 00:56:33 INFO  ---RUNTIME: Multi-Query Optimization took 10.789155960083008 ms
2022-09-25 00:56:33 INFO  Executing generated plans
2022-09-25 00:56:48 INFO  ---RUNTIME: Execution took 15186.850309371948 ms
2022-09-25 00:56:48 INFO  Done!
2022-09-25 00:56:48 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-25 00:56:48 INFO  Running instrumented original pipeline...
2022-09-25 00:56:48 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-25 00:56:48 INFO  ---RUNTIME: Importing and monkey-patching took 6.406307220458984 ms
2022-09-25 00:57:02 INFO  ---RUNTIME: Original pipeline execution took 13557.737350463867 ms (excluding imports and monkey-patching)
2022-09-25 00:57:02 INFO  Starting execution of 1 what-if analyses...
2022-09-25 00:57:02 INFO  Start plan generation for analysis PermutationFeatureImportance...
2022-09-25 00:57:02 INFO  ---RUNTIME: Plan generation took 0.1285076141357422 ms
2022-09-25 00:57:02 INFO  Estimated runtime of original DAG is 13222.84197807312ms
2022-09-25 00:57:02 WARNING Skipping Multi-Query Optimization (instead, only applying patches)
2022-09-25 00:57:02 INFO  Estimated unoptimised what-if runtime is 66114.2098903656ms
2022-09-25 00:57:02 INFO  ---RUNTIME: Multi-Query Optimization took 4.311561584472656 ms
2022-09-25 00:57:02 INFO  Executing generated plans
2022-09-25 00:58:10 INFO  ---RUNTIME: Execution took 67805.87124824524 ms
2022-09-25 00:58:10 INFO  Done!
2022-09-25 00:58:10 INFO  # Finished -- repetition 4 of 7 
2022-09-25 00:58:10 INFO  # Optimization benchmark for feature_importance with args [['reviews', 'slow_loading', 'featurization_4', 'neural_network']] -- repetition 5 of 7
2022-09-25 00:58:10 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-25 00:58:10 INFO  Running instrumented original pipeline...
2022-09-25 00:58:10 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-25 00:58:10 INFO  ---RUNTIME: Importing and monkey-patching took 6.855010986328125 ms
2022-09-25 00:58:24 INFO  ---RUNTIME: Original pipeline execution took 14453.469514846802 ms (excluding imports and monkey-patching)
2022-09-25 00:58:24 INFO  Starting execution of 1 what-if analyses...
2022-09-25 00:58:24 INFO  Start plan generation for analysis PermutationFeatureImportance...
2022-09-25 00:58:24 INFO  ---RUNTIME: Plan generation took 0.1380443572998047 ms
2022-09-25 00:58:24 INFO  Estimated runtime of original DAG is 14117.842435836792ms
2022-09-25 00:58:24 INFO  Performing Multi-Query Optimization
2022-09-25 00:58:24 INFO  Estimated unoptimized what-if runtime is 70589.21217918396ms
2022-09-25 00:58:24 INFO  Estimated optimised what-if runtime is 16009.100437164307ms
2022-09-25 00:58:24 INFO  Estimated optimisation runtime saving is 54580.11174201965ms
2022-09-25 00:58:24 INFO  ---RUNTIME: Multi-Query Optimization took 12.684106826782227 ms
2022-09-25 00:58:24 INFO  Executing generated plans
2022-09-25 00:58:39 INFO  ---RUNTIME: Execution took 15158.47659111023 ms
2022-09-25 00:58:39 INFO  Done!
2022-09-25 00:58:39 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-25 00:58:39 INFO  Running instrumented original pipeline...
2022-09-25 00:58:39 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-25 00:58:39 INFO  ---RUNTIME: Importing and monkey-patching took 6.0882568359375 ms
2022-09-25 00:58:53 INFO  ---RUNTIME: Original pipeline execution took 13969.236612319946 ms (excluding imports and monkey-patching)
2022-09-25 00:58:53 INFO  Starting execution of 1 what-if analyses...
2022-09-25 00:58:53 INFO  Start plan generation for analysis PermutationFeatureImportance...
2022-09-25 00:58:53 INFO  ---RUNTIME: Plan generation took 0.1068115234375 ms
2022-09-25 00:58:53 INFO  Estimated runtime of original DAG is 13633.11243057251ms
2022-09-25 00:58:53 WARNING Skipping Multi-Query Optimization (instead, only applying patches)
2022-09-25 00:58:53 INFO  Estimated unoptimised what-if runtime is 68165.56215286255ms
2022-09-25 00:58:53 INFO  ---RUNTIME: Multi-Query Optimization took 4.153251647949219 ms
2022-09-25 00:58:53 INFO  Executing generated plans
2022-09-25 01:00:01 INFO  ---RUNTIME: Execution took 67865.11778831482 ms
2022-09-25 01:00:01 INFO  Done!
2022-09-25 01:00:01 INFO  # Finished -- repetition 5 of 7 
2022-09-25 01:00:01 INFO  # Optimization benchmark for feature_importance with args [['reviews', 'slow_loading', 'featurization_4', 'neural_network']] -- repetition 6 of 7
2022-09-25 01:00:01 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-25 01:00:01 INFO  Running instrumented original pipeline...
2022-09-25 01:00:01 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-25 01:00:01 INFO  ---RUNTIME: Importing and monkey-patching took 6.172895431518555 ms
2022-09-25 01:00:15 INFO  ---RUNTIME: Original pipeline execution took 13619.48537826538 ms (excluding imports and monkey-patching)
2022-09-25 01:00:15 INFO  Starting execution of 1 what-if analyses...
2022-09-25 01:00:15 INFO  Start plan generation for analysis PermutationFeatureImportance...
2022-09-25 01:00:15 INFO  ---RUNTIME: Plan generation took 0.11324882507324219 ms
2022-09-25 01:00:15 INFO  Estimated runtime of original DAG is 13288.453102111816ms
2022-09-25 01:00:15 INFO  Performing Multi-Query Optimization
2022-09-25 01:00:15 INFO  Estimated unoptimized what-if runtime is 66442.26551055908ms
2022-09-25 01:00:15 INFO  Estimated optimised what-if runtime is 15035.16411781311ms
2022-09-25 01:00:15 INFO  Estimated optimisation runtime saving is 51407.10139274597ms
2022-09-25 01:00:15 INFO  ---RUNTIME: Multi-Query Optimization took 10.801076889038086 ms
2022-09-25 01:00:15 INFO  Executing generated plans
2022-09-25 01:00:30 INFO  ---RUNTIME: Execution took 15565.648555755615 ms
2022-09-25 01:00:30 INFO  Done!
2022-09-25 01:00:30 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-25 01:00:30 INFO  Running instrumented original pipeline...
2022-09-25 01:00:30 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-25 01:00:30 INFO  ---RUNTIME: Importing and monkey-patching took 6.313085556030273 ms
2022-09-25 01:00:44 INFO  ---RUNTIME: Original pipeline execution took 13772.400379180908 ms (excluding imports and monkey-patching)
2022-09-25 01:00:44 INFO  Starting execution of 1 what-if analyses...
2022-09-25 01:00:44 INFO  Start plan generation for analysis PermutationFeatureImportance...
2022-09-25 01:00:44 INFO  ---RUNTIME: Plan generation took 0.1404285430908203 ms
2022-09-25 01:00:44 INFO  Estimated runtime of original DAG is 13439.303159713745ms
2022-09-25 01:00:44 WARNING Skipping Multi-Query Optimization (instead, only applying patches)
2022-09-25 01:00:44 INFO  Estimated unoptimised what-if runtime is 67196.51579856873ms
2022-09-25 01:00:44 INFO  ---RUNTIME: Multi-Query Optimization took 6.160497665405273 ms
2022-09-25 01:00:44 INFO  Executing generated plans
2022-09-25 01:01:52 INFO  ---RUNTIME: Execution took 68101.07946395874 ms
2022-09-25 01:01:52 INFO  Done!
2022-09-25 01:01:52 INFO  # Finished -- repetition 6 of 7 
2022-09-25 01:01:52 INFO  # Optimization benchmark for feature_importance with args [['reviews', 'slow_loading', 'featurization_4', 'neural_network']] -- repetition 7 of 7
2022-09-25 01:01:52 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-25 01:01:52 INFO  Running instrumented original pipeline...
2022-09-25 01:01:52 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-25 01:01:52 INFO  ---RUNTIME: Importing and monkey-patching took 8.085489273071289 ms
2022-09-25 01:02:07 INFO  ---RUNTIME: Original pipeline execution took 14301.665544509888 ms (excluding imports and monkey-patching)
2022-09-25 01:02:07 INFO  Starting execution of 1 what-if analyses...
2022-09-25 01:02:07 INFO  Start plan generation for analysis PermutationFeatureImportance...
2022-09-25 01:02:07 INFO  ---RUNTIME: Plan generation took 0.10895729064941406 ms
2022-09-25 01:02:07 INFO  Estimated runtime of original DAG is 13963.273048400879ms
2022-09-25 01:02:07 INFO  Performing Multi-Query Optimization
2022-09-25 01:02:07 INFO  Estimated unoptimized what-if runtime is 69816.3652420044ms
2022-09-25 01:02:07 INFO  Estimated optimised what-if runtime is 15775.48599243164ms
2022-09-25 01:02:07 INFO  Estimated optimisation runtime saving is 54040.879249572754ms
2022-09-25 01:02:07 INFO  ---RUNTIME: Multi-Query Optimization took 10.744571685791016 ms
2022-09-25 01:02:07 INFO  Executing generated plans
2022-09-25 01:02:22 INFO  ---RUNTIME: Execution took 15571.339130401611 ms
2022-09-25 01:02:22 INFO  Done!
2022-09-25 01:02:22 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-25 01:02:22 INFO  Running instrumented original pipeline...
2022-09-25 01:02:22 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-25 01:02:22 INFO  ---RUNTIME: Importing and monkey-patching took 6.006002426147461 ms
2022-09-25 01:02:36 INFO  ---RUNTIME: Original pipeline execution took 13583.093166351318 ms (excluding imports and monkey-patching)
2022-09-25 01:02:36 INFO  Starting execution of 1 what-if analyses...
2022-09-25 01:02:36 INFO  Start plan generation for analysis PermutationFeatureImportance...
2022-09-25 01:02:36 INFO  ---RUNTIME: Plan generation took 0.14710426330566406 ms
2022-09-25 01:02:36 INFO  Estimated runtime of original DAG is 13249.563694000244ms
2022-09-25 01:02:36 WARNING Skipping Multi-Query Optimization (instead, only applying patches)
2022-09-25 01:02:36 INFO  Estimated unoptimised what-if runtime is 66247.81847000122ms
2022-09-25 01:02:36 INFO  ---RUNTIME: Multi-Query Optimization took 4.363536834716797 ms
2022-09-25 01:02:36 INFO  Executing generated plans
2022-09-25 01:03:44 INFO  ---RUNTIME: Execution took 67983.15668106079 ms
2022-09-25 01:03:44 INFO  Done!
2022-09-25 01:03:44 INFO  # Finished -- repetition 7 of 7 
2022-09-25 01:03:44 INFO  # Final results after all repetitions
2022-09-25 01:03:44 INFO     repetition  ... no_opt_what_if_execution_combined_model_training
0           0  ...                                     16460.742235
1           1  ...                                     16361.257076
2           2  ...                                     16316.452503
3           3  ...                                     16698.182583
4           4  ...                                     16389.075518
5           5  ...                                     16316.807508
6           6  ...                                     16288.969040

[7 rows x 26 columns]
PROTOCOL_BUFFERS_PYTHON_IMPLEMENTATION=python taskset -c 32-39 python3.9 benchmarks_end_to_end.py data_corruption reviews slow_loading featurization_0 logistic_regression
2022-09-25 01:03:46.793982: W tensorflow/stream_executor/platform/default/dso_loader.cc:64] Could not load dynamic library 'libcudart.so.11.0'; dlerror: libcudart.so.11.0: cannot open shared object file: No such file or directory; LD_LIBRARY_PATH: /home/sgrafbe/mlwhatif/venv/lib/python3.9/site-packages/cv2/../../lib64:
2022-09-25 01:03:46.794027: I tensorflow/stream_executor/cuda/cudart_stub.cc:29] Ignore above cudart dlerror if you do not have a GPU set up on your machine.
2022-09-25 01:03:48 INFO  Patching sys.argv with ['mlwhatif', 'reviews', 'slow_loading', 'featurization_0', 'logistic_regression']
2022-09-25 01:03:48 INFO  Running instrumented original pipeline...
2022-09-25 01:03:48 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-25 01:03:48 INFO  ---RUNTIME: Importing and monkey-patching took 95.9465503692627 ms
2022-09-25 01:03:53 INFO  ---RUNTIME: Original pipeline execution took 5683.305263519287 ms (excluding imports and monkey-patching)
2022-09-25 01:03:53 INFO  Starting execution of 0 what-if analyses...
2022-09-25 01:03:53 INFO  Estimated runtime of original DAG is 5363.948106765747ms
2022-09-25 01:03:53 INFO  Performing Multi-Query Optimization
2022-09-25 01:03:53 INFO  Estimated unoptimized what-if runtime is 0ms
2022-09-25 01:03:53 INFO  Estimated optimised what-if runtime is 0ms
2022-09-25 01:03:53 INFO  Estimated optimisation runtime saving is 0ms
2022-09-25 01:03:53 INFO  ---RUNTIME: Multi-Query Optimization took 0.4801750183105469 ms
2022-09-25 01:03:53 INFO  Executing generated plans
2022-09-25 01:03:53 INFO  ---RUNTIME: Execution took 0.026464462280273438 ms
2022-09-25 01:03:53 INFO  Done!
2022-09-25 01:03:53 INFO  # Optimization benchmark for data_corruption with args [['reviews', 'slow_loading', 'featurization_0', 'logistic_regression']] -- repetition 1 of 7
2022-09-25 01:03:53 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-25 01:03:53 INFO  Running instrumented original pipeline...
2022-09-25 01:03:53 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-25 01:03:53 INFO  ---RUNTIME: Importing and monkey-patching took 5.86390495300293 ms
2022-09-25 01:03:59 INFO  ---RUNTIME: Original pipeline execution took 5656.733751296997 ms (excluding imports and monkey-patching)
2022-09-25 01:03:59 INFO  Starting execution of 1 what-if analyses...
2022-09-25 01:03:59 INFO  Start plan generation for analysis DataCorruption...
2022-09-25 01:03:59 INFO  ---RUNTIME: Plan generation took 1.573801040649414 ms
2022-09-25 01:03:59 INFO  Estimated runtime of original DAG is 5326.264381408691ms
2022-09-25 01:03:59 INFO  Performing Multi-Query Optimization
2022-09-25 01:03:59 INFO  Estimated unoptimized what-if runtime is 133156.60953521729ms
2022-09-25 01:03:59 INFO  Estimated optimised what-if runtime is 11981.828451156616ms
2022-09-25 01:03:59 INFO  Estimated optimisation runtime saving is 121174.78108406067ms
2022-09-25 01:03:59 INFO  ---RUNTIME: Multi-Query Optimization took 79.89239692687988 ms
2022-09-25 01:03:59 INFO  Executing generated plans
2022-09-25 01:04:16 INFO  ---RUNTIME: Execution took 17031.31413459778 ms
2022-09-25 01:04:16 INFO  Done!
2022-09-25 01:04:16 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-25 01:04:16 INFO  Running instrumented original pipeline...
2022-09-25 01:04:16 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-25 01:04:16 INFO  ---RUNTIME: Importing and monkey-patching took 6.512880325317383 ms
2022-09-25 01:04:22 INFO  ---RUNTIME: Original pipeline execution took 5816.203832626343 ms (excluding imports and monkey-patching)
2022-09-25 01:04:22 INFO  Starting execution of 1 what-if analyses...
2022-09-25 01:04:22 INFO  Start plan generation for analysis DataCorruption...
2022-09-25 01:04:22 INFO  ---RUNTIME: Plan generation took 0.5772113800048828 ms
2022-09-25 01:04:22 INFO  Estimated runtime of original DAG is 5362.593173980713ms
2022-09-25 01:04:22 WARNING Skipping Multi-Query Optimization (instead, only applying patches)
2022-09-25 01:04:22 INFO  Estimated unoptimised what-if runtime is 134064.82934951782ms
2022-09-25 01:04:22 INFO  ---RUNTIME: Multi-Query Optimization took 18.382549285888672 ms
2022-09-25 01:04:22 INFO  Executing generated plans
2022-09-25 01:06:51 INFO  ---RUNTIME: Execution took 149169.5327758789 ms
2022-09-25 01:06:51 INFO  Done!
2022-09-25 01:06:51 INFO  # Finished -- repetition 1 of 7 
2022-09-25 01:06:51 INFO  # Optimization benchmark for data_corruption with args [['reviews', 'slow_loading', 'featurization_0', 'logistic_regression']] -- repetition 2 of 7
2022-09-25 01:06:51 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-25 01:06:51 INFO  Running instrumented original pipeline...
2022-09-25 01:06:51 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-25 01:06:51 INFO  ---RUNTIME: Importing and monkey-patching took 6.453275680541992 ms
2022-09-25 01:06:57 INFO  ---RUNTIME: Original pipeline execution took 5632.726192474365 ms (excluding imports and monkey-patching)
2022-09-25 01:06:57 INFO  Starting execution of 1 what-if analyses...
2022-09-25 01:06:57 INFO  Start plan generation for analysis DataCorruption...
2022-09-25 01:06:57 INFO  ---RUNTIME: Plan generation took 0.46324729919433594 ms
2022-09-25 01:06:57 INFO  Estimated runtime of original DAG is 5340.15679359436ms
2022-09-25 01:06:57 INFO  Performing Multi-Query Optimization
2022-09-25 01:06:57 INFO  Estimated unoptimized what-if runtime is 133503.919839859ms
2022-09-25 01:06:57 INFO  Estimated optimised what-if runtime is 11979.366302490234ms
2022-09-25 01:06:57 INFO  Estimated optimisation runtime saving is 121524.55353736877ms
2022-09-25 01:06:57 INFO  ---RUNTIME: Multi-Query Optimization took 90.15965461730957 ms
2022-09-25 01:06:57 INFO  Executing generated plans
2022-09-25 01:07:14 INFO  ---RUNTIME: Execution took 16939.947366714478 ms
2022-09-25 01:07:14 INFO  Done!
2022-09-25 01:07:14 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-25 01:07:14 INFO  Running instrumented original pipeline...
2022-09-25 01:07:14 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-25 01:07:14 INFO  ---RUNTIME: Importing and monkey-patching took 6.7195892333984375 ms
2022-09-25 01:07:19 INFO  ---RUNTIME: Original pipeline execution took 5635.98108291626 ms (excluding imports and monkey-patching)
2022-09-25 01:07:19 INFO  Starting execution of 1 what-if analyses...
2022-09-25 01:07:19 INFO  Start plan generation for analysis DataCorruption...
2022-09-25 01:07:19 INFO  ---RUNTIME: Plan generation took 0.45990943908691406 ms
2022-09-25 01:07:19 INFO  Estimated runtime of original DAG is 5354.489326477051ms
2022-09-25 01:07:19 WARNING Skipping Multi-Query Optimization (instead, only applying patches)
2022-09-25 01:07:19 INFO  Estimated unoptimised what-if runtime is 133862.23316192627ms
2022-09-25 01:07:19 INFO  ---RUNTIME: Multi-Query Optimization took 18.059968948364258 ms
2022-09-25 01:07:19 INFO  Executing generated plans
2022-09-25 01:09:49 INFO  ---RUNTIME: Execution took 149574.0361213684 ms
2022-09-25 01:09:49 INFO  Done!
2022-09-25 01:09:49 INFO  # Finished -- repetition 2 of 7 
2022-09-25 01:09:49 INFO  # Optimization benchmark for data_corruption with args [['reviews', 'slow_loading', 'featurization_0', 'logistic_regression']] -- repetition 3 of 7
2022-09-25 01:09:49 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-25 01:09:49 INFO  Running instrumented original pipeline...
2022-09-25 01:09:49 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-25 01:09:49 INFO  ---RUNTIME: Importing and monkey-patching took 6.6165924072265625 ms
2022-09-25 01:09:55 INFO  ---RUNTIME: Original pipeline execution took 5628.41010093689 ms (excluding imports and monkey-patching)
2022-09-25 01:09:55 INFO  Starting execution of 1 what-if analyses...
2022-09-25 01:09:55 INFO  Start plan generation for analysis DataCorruption...
2022-09-25 01:09:55 INFO  ---RUNTIME: Plan generation took 0.5021095275878906 ms
2022-09-25 01:09:55 INFO  Estimated runtime of original DAG is 5335.890769958496ms
2022-09-25 01:09:55 INFO  Performing Multi-Query Optimization
2022-09-25 01:09:55 INFO  Estimated unoptimized what-if runtime is 133397.2692489624ms
2022-09-25 01:09:55 INFO  Estimated optimised what-if runtime is 12022.286415100098ms
2022-09-25 01:09:55 INFO  Estimated optimisation runtime saving is 121374.9828338623ms
2022-09-25 01:09:55 INFO  ---RUNTIME: Multi-Query Optimization took 59.572458267211914 ms
2022-09-25 01:09:55 INFO  Executing generated plans
2022-09-25 01:10:12 INFO  ---RUNTIME: Execution took 17011.26003265381 ms
2022-09-25 01:10:12 INFO  Done!
2022-09-25 01:10:12 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-25 01:10:12 INFO  Running instrumented original pipeline...
2022-09-25 01:10:12 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-25 01:10:12 INFO  ---RUNTIME: Importing and monkey-patching took 6.591558456420898 ms
2022-09-25 01:10:17 INFO  ---RUNTIME: Original pipeline execution took 5676.761865615845 ms (excluding imports and monkey-patching)
2022-09-25 01:10:17 INFO  Starting execution of 1 what-if analyses...
2022-09-25 01:10:17 INFO  Start plan generation for analysis DataCorruption...
2022-09-25 01:10:18 INFO  ---RUNTIME: Plan generation took 0.46706199645996094 ms
2022-09-25 01:10:18 INFO  Estimated runtime of original DAG is 5390.741348266602ms
2022-09-25 01:10:18 WARNING Skipping Multi-Query Optimization (instead, only applying patches)
2022-09-25 01:10:18 INFO  Estimated unoptimised what-if runtime is 134768.53370666504ms
2022-09-25 01:10:18 INFO  ---RUNTIME: Multi-Query Optimization took 18.281936645507812 ms
2022-09-25 01:10:18 INFO  Executing generated plans
2022-09-25 01:12:47 INFO  ---RUNTIME: Execution took 149233.33358764648 ms
2022-09-25 01:12:47 INFO  Done!
2022-09-25 01:12:47 INFO  # Finished -- repetition 3 of 7 
2022-09-25 01:12:47 INFO  # Optimization benchmark for data_corruption with args [['reviews', 'slow_loading', 'featurization_0', 'logistic_regression']] -- repetition 4 of 7
2022-09-25 01:12:47 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-25 01:12:47 INFO  Running instrumented original pipeline...
2022-09-25 01:12:47 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-25 01:12:47 INFO  ---RUNTIME: Importing and monkey-patching took 6.304025650024414 ms
2022-09-25 01:12:53 INFO  ---RUNTIME: Original pipeline execution took 5839.985132217407 ms (excluding imports and monkey-patching)
2022-09-25 01:12:53 INFO  Starting execution of 1 what-if analyses...
2022-09-25 01:12:53 INFO  Start plan generation for analysis DataCorruption...
2022-09-25 01:12:53 INFO  ---RUNTIME: Plan generation took 0.4601478576660156 ms
2022-09-25 01:12:53 INFO  Estimated runtime of original DAG is 5334.755182266235ms
2022-09-25 01:12:53 INFO  Performing Multi-Query Optimization
2022-09-25 01:12:53 INFO  Estimated unoptimized what-if runtime is 133368.87955665588ms
2022-09-25 01:12:53 INFO  Estimated optimised what-if runtime is 11965.705394744873ms
2022-09-25 01:12:53 INFO  Estimated optimisation runtime saving is 121403.17416191101ms
2022-09-25 01:12:53 INFO  ---RUNTIME: Multi-Query Optimization took 59.20600891113281 ms
2022-09-25 01:12:53 INFO  Executing generated plans
2022-09-25 01:13:10 INFO  ---RUNTIME: Execution took 16910.97903251648 ms
2022-09-25 01:13:10 INFO  Done!
2022-09-25 01:13:10 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-25 01:13:10 INFO  Running instrumented original pipeline...
2022-09-25 01:13:10 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-25 01:13:10 INFO  ---RUNTIME: Importing and monkey-patching took 6.627082824707031 ms
2022-09-25 01:13:15 INFO  ---RUNTIME: Original pipeline execution took 5636.822462081909 ms (excluding imports and monkey-patching)
2022-09-25 01:13:15 INFO  Starting execution of 1 what-if analyses...
2022-09-25 01:13:15 INFO  Start plan generation for analysis DataCorruption...
2022-09-25 01:13:15 INFO  ---RUNTIME: Plan generation took 0.45371055603027344 ms
2022-09-25 01:13:15 INFO  Estimated runtime of original DAG is 5350.883960723877ms
2022-09-25 01:13:15 WARNING Skipping Multi-Query Optimization (instead, only applying patches)
2022-09-25 01:13:15 INFO  Estimated unoptimised what-if runtime is 133772.09901809692ms
2022-09-25 01:13:15 INFO  ---RUNTIME: Multi-Query Optimization took 18.488168716430664 ms
2022-09-25 01:13:15 INFO  Executing generated plans
2022-09-25 01:15:45 INFO  ---RUNTIME: Execution took 149404.03413772583 ms
2022-09-25 01:15:45 INFO  Done!
2022-09-25 01:15:45 INFO  # Finished -- repetition 4 of 7 
2022-09-25 01:15:45 INFO  # Optimization benchmark for data_corruption with args [['reviews', 'slow_loading', 'featurization_0', 'logistic_regression']] -- repetition 5 of 7
2022-09-25 01:15:45 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-25 01:15:45 INFO  Running instrumented original pipeline...
2022-09-25 01:15:45 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-25 01:15:45 INFO  ---RUNTIME: Importing and monkey-patching took 6.538152694702148 ms
2022-09-25 01:15:50 INFO  ---RUNTIME: Original pipeline execution took 5632.622480392456 ms (excluding imports and monkey-patching)
2022-09-25 01:15:50 INFO  Starting execution of 1 what-if analyses...
2022-09-25 01:15:50 INFO  Start plan generation for analysis DataCorruption...
2022-09-25 01:15:50 INFO  ---RUNTIME: Plan generation took 0.4699230194091797 ms
2022-09-25 01:15:50 INFO  Estimated runtime of original DAG is 5334.533452987671ms
2022-09-25 01:15:50 INFO  Performing Multi-Query Optimization
2022-09-25 01:15:50 INFO  Estimated unoptimized what-if runtime is 133363.33632469177ms
2022-09-25 01:15:50 INFO  Estimated optimised what-if runtime is 11983.858346939087ms
2022-09-25 01:15:50 INFO  Estimated optimisation runtime saving is 121379.47797775269ms
2022-09-25 01:15:50 INFO  ---RUNTIME: Multi-Query Optimization took 59.27610397338867 ms
2022-09-25 01:15:50 INFO  Executing generated plans
2022-09-25 01:16:07 INFO  ---RUNTIME: Execution took 16980.84831237793 ms
2022-09-25 01:16:07 INFO  Done!
2022-09-25 01:16:07 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-25 01:16:07 INFO  Running instrumented original pipeline...
2022-09-25 01:16:07 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-25 01:16:07 INFO  ---RUNTIME: Importing and monkey-patching took 6.583690643310547 ms
2022-09-25 01:16:13 INFO  ---RUNTIME: Original pipeline execution took 5609.8833084106445 ms (excluding imports and monkey-patching)
2022-09-25 01:16:13 INFO  Starting execution of 1 what-if analyses...
2022-09-25 01:16:13 INFO  Start plan generation for analysis DataCorruption...
2022-09-25 01:16:13 INFO  ---RUNTIME: Plan generation took 0.4477500915527344 ms
2022-09-25 01:16:13 INFO  Estimated runtime of original DAG is 5326.862335205078ms
2022-09-25 01:16:13 WARNING Skipping Multi-Query Optimization (instead, only applying patches)
2022-09-25 01:16:13 INFO  Estimated unoptimised what-if runtime is 133171.55838012695ms
2022-09-25 01:16:13 INFO  ---RUNTIME: Multi-Query Optimization took 18.474340438842773 ms
2022-09-25 01:16:13 INFO  Executing generated plans
2022-09-25 01:18:42 INFO  ---RUNTIME: Execution took 148684.79943275452 ms
2022-09-25 01:18:42 INFO  Done!
2022-09-25 01:18:42 INFO  # Finished -- repetition 5 of 7 
2022-09-25 01:18:42 INFO  # Optimization benchmark for data_corruption with args [['reviews', 'slow_loading', 'featurization_0', 'logistic_regression']] -- repetition 6 of 7
2022-09-25 01:18:42 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-25 01:18:42 INFO  Running instrumented original pipeline...
2022-09-25 01:18:42 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-25 01:18:42 INFO  ---RUNTIME: Importing and monkey-patching took 6.449460983276367 ms
2022-09-25 01:18:47 INFO  ---RUNTIME: Original pipeline execution took 5597.8100299835205 ms (excluding imports and monkey-patching)
2022-09-25 01:18:47 INFO  Starting execution of 1 what-if analyses...
2022-09-25 01:18:47 INFO  Start plan generation for analysis DataCorruption...
2022-09-25 01:18:47 INFO  ---RUNTIME: Plan generation took 0.4611015319824219 ms
2022-09-25 01:18:47 INFO  Estimated runtime of original DAG is 5314.756393432617ms
2022-09-25 01:18:47 INFO  Performing Multi-Query Optimization
2022-09-25 01:18:47 INFO  Estimated unoptimized what-if runtime is 132868.90983581543ms
2022-09-25 01:18:47 INFO  Estimated optimised what-if runtime is 11959.625720977783ms
2022-09-25 01:18:47 INFO  Estimated optimisation runtime saving is 120909.28411483765ms
2022-09-25 01:18:47 INFO  ---RUNTIME: Multi-Query Optimization took 58.924198150634766 ms
2022-09-25 01:18:47 INFO  Executing generated plans
2022-09-25 01:19:04 INFO  ---RUNTIME: Execution took 16910.223722457886 ms
2022-09-25 01:19:04 INFO  Done!
2022-09-25 01:19:04 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-25 01:19:04 INFO  Running instrumented original pipeline...
2022-09-25 01:19:04 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-25 01:19:04 INFO  ---RUNTIME: Importing and monkey-patching took 6.121158599853516 ms
2022-09-25 01:19:10 INFO  ---RUNTIME: Original pipeline execution took 5571.606874465942 ms (excluding imports and monkey-patching)
2022-09-25 01:19:10 INFO  Starting execution of 1 what-if analyses...
2022-09-25 01:19:10 INFO  Start plan generation for analysis DataCorruption...
2022-09-25 01:19:10 INFO  ---RUNTIME: Plan generation took 1.4276504516601562 ms
2022-09-25 01:19:10 INFO  Estimated runtime of original DAG is 5291.157484054565ms
2022-09-25 01:19:10 WARNING Skipping Multi-Query Optimization (instead, only applying patches)
2022-09-25 01:19:10 INFO  Estimated unoptimised what-if runtime is 132278.93710136414ms
2022-09-25 01:19:10 INFO  ---RUNTIME: Multi-Query Optimization took 17.29893684387207 ms
2022-09-25 01:19:10 INFO  Executing generated plans
2022-09-25 01:21:38 INFO  ---RUNTIME: Execution took 148205.76524734497 ms
2022-09-25 01:21:38 INFO  Done!
2022-09-25 01:21:38 INFO  # Finished -- repetition 6 of 7 
2022-09-25 01:21:38 INFO  # Optimization benchmark for data_corruption with args [['reviews', 'slow_loading', 'featurization_0', 'logistic_regression']] -- repetition 7 of 7
2022-09-25 01:21:38 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-25 01:21:38 INFO  Running instrumented original pipeline...
2022-09-25 01:21:38 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-25 01:21:38 INFO  ---RUNTIME: Importing and monkey-patching took 6.40416145324707 ms
2022-09-25 01:21:44 INFO  ---RUNTIME: Original pipeline execution took 5917.786121368408 ms (excluding imports and monkey-patching)
2022-09-25 01:21:44 INFO  Starting execution of 1 what-if analyses...
2022-09-25 01:21:44 INFO  Start plan generation for analysis DataCorruption...
2022-09-25 01:21:44 INFO  ---RUNTIME: Plan generation took 1.253366470336914 ms
2022-09-25 01:21:44 INFO  Estimated runtime of original DAG is 5615.615606307983ms
2022-09-25 01:21:44 INFO  Performing Multi-Query Optimization
2022-09-25 01:21:44 INFO  Estimated unoptimized what-if runtime is 140390.39015769958ms
2022-09-25 01:21:44 INFO  Estimated optimised what-if runtime is 12231.323719024658ms
2022-09-25 01:21:44 INFO  Estimated optimisation runtime saving is 128159.06643867493ms
2022-09-25 01:21:44 INFO  ---RUNTIME: Multi-Query Optimization took 57.66105651855469 ms
2022-09-25 01:21:44 INFO  Executing generated plans
2022-09-25 01:22:01 INFO  ---RUNTIME: Execution took 16992.488861083984 ms
2022-09-25 01:22:01 INFO  Done!
2022-09-25 01:22:01 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-25 01:22:01 INFO  Running instrumented original pipeline...
2022-09-25 01:22:01 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-25 01:22:01 INFO  ---RUNTIME: Importing and monkey-patching took 6.000518798828125 ms
2022-09-25 01:22:07 INFO  ---RUNTIME: Original pipeline execution took 5820.667505264282 ms (excluding imports and monkey-patching)
2022-09-25 01:22:07 INFO  Starting execution of 1 what-if analyses...
2022-09-25 01:22:07 INFO  Start plan generation for analysis DataCorruption...
2022-09-25 01:22:07 INFO  ---RUNTIME: Plan generation took 0.4048347473144531 ms
2022-09-25 01:22:07 INFO  Estimated runtime of original DAG is 5322.78847694397ms
2022-09-25 01:22:07 WARNING Skipping Multi-Query Optimization (instead, only applying patches)
2022-09-25 01:22:07 INFO  Estimated unoptimised what-if runtime is 133069.71192359924ms
2022-09-25 01:22:07 INFO  ---RUNTIME: Multi-Query Optimization took 17.302513122558594 ms
2022-09-25 01:22:07 INFO  Executing generated plans
2022-09-25 01:24:35 INFO  ---RUNTIME: Execution took 148341.5286540985 ms
2022-09-25 01:24:35 INFO  Done!
2022-09-25 01:24:35 INFO  # Finished -- repetition 7 of 7 
2022-09-25 01:24:35 INFO  # Final results after all repetitions
2022-09-25 01:24:35 INFO     repetition  ... no_opt_what_if_execution_combined_model_training
0           0  ...                                      3993.537426
1           1  ...                                      3933.543921
2           2  ...                                      3919.693470
3           3  ...                                      3941.481113
4           4  ...                                      3903.234243
5           5  ...                                      3905.193806
6           6  ...                                      3907.861948

[7 rows x 26 columns]
PROTOCOL_BUFFERS_PYTHON_IMPLEMENTATION=python taskset -c 32-39 python3.9 benchmarks_end_to_end.py data_corruption reviews slow_loading featurization_0 xgboost
2022-09-25 01:24:37.982110: W tensorflow/stream_executor/platform/default/dso_loader.cc:64] Could not load dynamic library 'libcudart.so.11.0'; dlerror: libcudart.so.11.0: cannot open shared object file: No such file or directory; LD_LIBRARY_PATH: /home/sgrafbe/mlwhatif/venv/lib/python3.9/site-packages/cv2/../../lib64:
2022-09-25 01:24:37.982153: I tensorflow/stream_executor/cuda/cudart_stub.cc:29] Ignore above cudart dlerror if you do not have a GPU set up on your machine.
2022-09-25 01:24:39 INFO  Patching sys.argv with ['mlwhatif', 'reviews', 'slow_loading', 'featurization_0', 'xgboost']
2022-09-25 01:24:39 INFO  Running instrumented original pipeline...
2022-09-25 01:24:39 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-25 01:24:39 INFO  ---RUNTIME: Importing and monkey-patching took 96.1151123046875 ms
2022-09-25 01:24:47 INFO  ---RUNTIME: Original pipeline execution took 7762.793302536011 ms (excluding imports and monkey-patching)
2022-09-25 01:24:47 INFO  Starting execution of 0 what-if analyses...
2022-09-25 01:24:47 INFO  Estimated runtime of original DAG is 7447.440147399902ms
2022-09-25 01:24:47 INFO  Performing Multi-Query Optimization
2022-09-25 01:24:47 INFO  Estimated unoptimized what-if runtime is 0ms
2022-09-25 01:24:47 INFO  Estimated optimised what-if runtime is 0ms
2022-09-25 01:24:47 INFO  Estimated optimisation runtime saving is 0ms
2022-09-25 01:24:47 INFO  ---RUNTIME: Multi-Query Optimization took 0.4851818084716797 ms
2022-09-25 01:24:47 INFO  Executing generated plans
2022-09-25 01:24:47 INFO  ---RUNTIME: Execution took 0.026702880859375 ms
2022-09-25 01:24:47 INFO  Done!
2022-09-25 01:24:47 INFO  # Optimization benchmark for data_corruption with args [['reviews', 'slow_loading', 'featurization_0', 'xgboost']] -- repetition 1 of 7
2022-09-25 01:24:47 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-25 01:24:47 INFO  Running instrumented original pipeline...
2022-09-25 01:24:47 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-25 01:24:47 INFO  ---RUNTIME: Importing and monkey-patching took 5.903959274291992 ms
2022-09-25 01:24:54 INFO  ---RUNTIME: Original pipeline execution took 7664.756059646606 ms (excluding imports and monkey-patching)
2022-09-25 01:24:54 INFO  Starting execution of 1 what-if analyses...
2022-09-25 01:24:54 INFO  Start plan generation for analysis DataCorruption...
2022-09-25 01:24:54 INFO  ---RUNTIME: Plan generation took 1.682281494140625 ms
2022-09-25 01:24:54 INFO  Estimated runtime of original DAG is 7378.3838748931885ms
2022-09-25 01:24:54 INFO  Performing Multi-Query Optimization
2022-09-25 01:24:54 INFO  Estimated unoptimized what-if runtime is 184459.5968723297ms
2022-09-25 01:24:54 INFO  Estimated optimised what-if runtime is 21168.69020462036ms
2022-09-25 01:24:54 INFO  Estimated optimisation runtime saving is 163290.90666770935ms
2022-09-25 01:24:54 INFO  ---RUNTIME: Multi-Query Optimization took 59.020042419433594 ms
2022-09-25 01:24:54 INFO  Executing generated plans
2022-09-25 01:25:21 INFO  ---RUNTIME: Execution took 26397.402048110962 ms
2022-09-25 01:25:21 INFO  Done!
2022-09-25 01:25:21 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-25 01:25:21 INFO  Running instrumented original pipeline...
2022-09-25 01:25:21 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-25 01:25:21 INFO  ---RUNTIME: Importing and monkey-patching took 6.471157073974609 ms
2022-09-25 01:25:29 INFO  ---RUNTIME: Original pipeline execution took 7859.687328338623 ms (excluding imports and monkey-patching)
2022-09-25 01:25:29 INFO  Starting execution of 1 what-if analyses...
2022-09-25 01:25:29 INFO  Start plan generation for analysis DataCorruption...
2022-09-25 01:25:29 INFO  ---RUNTIME: Plan generation took 0.47707557678222656 ms
2022-09-25 01:25:29 INFO  Estimated runtime of original DAG is 7381.918907165527ms
2022-09-25 01:25:29 WARNING Skipping Multi-Query Optimization (instead, only applying patches)
2022-09-25 01:25:29 INFO  Estimated unoptimised what-if runtime is 184547.97267913818ms
2022-09-25 01:25:29 INFO  ---RUNTIME: Multi-Query Optimization took 17.6699161529541 ms
2022-09-25 01:25:29 INFO  Executing generated plans
2022-09-25 01:28:48 INFO  ---RUNTIME: Execution took 199320.89924812317 ms
2022-09-25 01:28:48 INFO  Done!
2022-09-25 01:28:48 INFO  # Finished -- repetition 1 of 7 
2022-09-25 01:28:48 INFO  # Optimization benchmark for data_corruption with args [['reviews', 'slow_loading', 'featurization_0', 'xgboost']] -- repetition 2 of 7
2022-09-25 01:28:48 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-25 01:28:48 INFO  Running instrumented original pipeline...
2022-09-25 01:28:48 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-25 01:28:48 INFO  ---RUNTIME: Importing and monkey-patching took 6.664752960205078 ms
2022-09-25 01:28:56 INFO  ---RUNTIME: Original pipeline execution took 7628.324270248413 ms (excluding imports and monkey-patching)
2022-09-25 01:28:56 INFO  Starting execution of 1 what-if analyses...
2022-09-25 01:28:56 INFO  Start plan generation for analysis DataCorruption...
2022-09-25 01:28:56 INFO  ---RUNTIME: Plan generation took 0.45180320739746094 ms
2022-09-25 01:28:56 INFO  Estimated runtime of original DAG is 7343.46342086792ms
2022-09-25 01:28:56 INFO  Performing Multi-Query Optimization
2022-09-25 01:28:56 INFO  Estimated unoptimized what-if runtime is 183586.585521698ms
2022-09-25 01:28:56 INFO  Estimated optimised what-if runtime is 21153.7344455719ms
2022-09-25 01:28:56 INFO  Estimated optimisation runtime saving is 162432.8510761261ms
2022-09-25 01:28:56 INFO  ---RUNTIME: Multi-Query Optimization took 58.731794357299805 ms
2022-09-25 01:28:56 INFO  Executing generated plans
2022-09-25 01:29:22 INFO  ---RUNTIME: Execution took 26045.133352279663 ms
2022-09-25 01:29:22 INFO  Done!
2022-09-25 01:29:22 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-25 01:29:22 INFO  Running instrumented original pipeline...
2022-09-25 01:29:22 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-25 01:29:22 INFO  ---RUNTIME: Importing and monkey-patching took 6.266117095947266 ms
2022-09-25 01:29:29 INFO  ---RUNTIME: Original pipeline execution took 7665.274143218994 ms (excluding imports and monkey-patching)
2022-09-25 01:29:29 INFO  Starting execution of 1 what-if analyses...
2022-09-25 01:29:29 INFO  Start plan generation for analysis DataCorruption...
2022-09-25 01:29:29 INFO  ---RUNTIME: Plan generation took 0.4291534423828125 ms
2022-09-25 01:29:29 INFO  Estimated runtime of original DAG is 7378.90362739563ms
2022-09-25 01:29:29 WARNING Skipping Multi-Query Optimization (instead, only applying patches)
2022-09-25 01:29:29 INFO  Estimated unoptimised what-if runtime is 184472.59068489075ms
2022-09-25 01:29:29 INFO  ---RUNTIME: Multi-Query Optimization took 17.95029640197754 ms
2022-09-25 01:29:29 INFO  Executing generated plans
2022-09-25 01:32:48 INFO  ---RUNTIME: Execution took 198892.40980148315 ms
2022-09-25 01:32:48 INFO  Done!
2022-09-25 01:32:48 INFO  # Finished -- repetition 2 of 7 
2022-09-25 01:32:48 INFO  # Optimization benchmark for data_corruption with args [['reviews', 'slow_loading', 'featurization_0', 'xgboost']] -- repetition 3 of 7
2022-09-25 01:32:48 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-25 01:32:48 INFO  Running instrumented original pipeline...
2022-09-25 01:32:48 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-25 01:32:48 INFO  ---RUNTIME: Importing and monkey-patching took 6.666421890258789 ms
2022-09-25 01:32:56 INFO  ---RUNTIME: Original pipeline execution took 7679.595947265625 ms (excluding imports and monkey-patching)
2022-09-25 01:32:56 INFO  Starting execution of 1 what-if analyses...
2022-09-25 01:32:56 INFO  Start plan generation for analysis DataCorruption...
2022-09-25 01:32:56 INFO  ---RUNTIME: Plan generation took 0.4825592041015625 ms
2022-09-25 01:32:56 INFO  Estimated runtime of original DAG is 7392.282724380493ms
2022-09-25 01:32:56 INFO  Performing Multi-Query Optimization
2022-09-25 01:32:56 INFO  Estimated unoptimized what-if runtime is 184807.06810951233ms
2022-09-25 01:32:56 INFO  Estimated optimised what-if runtime is 21187.580585479736ms
2022-09-25 01:32:56 INFO  Estimated optimisation runtime saving is 163619.4875240326ms
2022-09-25 01:32:56 INFO  ---RUNTIME: Multi-Query Optimization took 59.88478660583496 ms
2022-09-25 01:32:56 INFO  Executing generated plans
2022-09-25 01:33:22 INFO  ---RUNTIME: Execution took 26113.44027519226 ms
2022-09-25 01:33:22 INFO  Done!
2022-09-25 01:33:22 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-25 01:33:22 INFO  Running instrumented original pipeline...
2022-09-25 01:33:22 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-25 01:33:22 INFO  ---RUNTIME: Importing and monkey-patching took 6.205081939697266 ms
2022-09-25 01:33:30 INFO  ---RUNTIME: Original pipeline execution took 7693.130970001221 ms (excluding imports and monkey-patching)
2022-09-25 01:33:30 INFO  Starting execution of 1 what-if analyses...
2022-09-25 01:33:30 INFO  Start plan generation for analysis DataCorruption...
2022-09-25 01:33:30 INFO  ---RUNTIME: Plan generation took 0.43320655822753906 ms
2022-09-25 01:33:30 INFO  Estimated runtime of original DAG is 7408.811807632446ms
2022-09-25 01:33:30 WARNING Skipping Multi-Query Optimization (instead, only applying patches)
2022-09-25 01:33:30 INFO  Estimated unoptimised what-if runtime is 185220.29519081116ms
2022-09-25 01:33:30 INFO  ---RUNTIME: Multi-Query Optimization took 17.85898208618164 ms
2022-09-25 01:33:30 INFO  Executing generated plans
2022-09-25 01:36:49 INFO  ---RUNTIME: Execution took 199395.49565315247 ms
2022-09-25 01:36:49 INFO  Done!
2022-09-25 01:36:49 INFO  # Finished -- repetition 3 of 7 
2022-09-25 01:36:49 INFO  # Optimization benchmark for data_corruption with args [['reviews', 'slow_loading', 'featurization_0', 'xgboost']] -- repetition 4 of 7
2022-09-25 01:36:49 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-25 01:36:49 INFO  Running instrumented original pipeline...
2022-09-25 01:36:50 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-25 01:36:50 INFO  ---RUNTIME: Importing and monkey-patching took 6.118297576904297 ms
2022-09-25 01:36:57 INFO  ---RUNTIME: Original pipeline execution took 7815.259695053101 ms (excluding imports and monkey-patching)
2022-09-25 01:36:57 INFO  Starting execution of 1 what-if analyses...
2022-09-25 01:36:57 INFO  Start plan generation for analysis DataCorruption...
2022-09-25 01:36:57 INFO  ---RUNTIME: Plan generation took 0.4303455352783203 ms
2022-09-25 01:36:57 INFO  Estimated runtime of original DAG is 7330.150604248047ms
2022-09-25 01:36:57 INFO  Performing Multi-Query Optimization
2022-09-25 01:36:57 INFO  Estimated unoptimized what-if runtime is 183253.76510620117ms
2022-09-25 01:36:57 INFO  Estimated optimised what-if runtime is 20868.5200214386ms
2022-09-25 01:36:57 INFO  Estimated optimisation runtime saving is 162385.24508476257ms
2022-09-25 01:36:57 INFO  ---RUNTIME: Multi-Query Optimization took 58.75968933105469 ms
2022-09-25 01:36:57 INFO  Executing generated plans
2022-09-25 01:37:23 INFO  ---RUNTIME: Execution took 25934.107542037964 ms
2022-09-25 01:37:23 INFO  Done!
2022-09-25 01:37:23 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-25 01:37:23 INFO  Running instrumented original pipeline...
2022-09-25 01:37:23 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-25 01:37:23 INFO  ---RUNTIME: Importing and monkey-patching took 6.096363067626953 ms
2022-09-25 01:37:31 INFO  ---RUNTIME: Original pipeline execution took 7613.475799560547 ms (excluding imports and monkey-patching)
2022-09-25 01:37:31 INFO  Starting execution of 1 what-if analyses...
2022-09-25 01:37:31 INFO  Start plan generation for analysis DataCorruption...
2022-09-25 01:37:31 INFO  ---RUNTIME: Plan generation took 0.4115104675292969 ms
2022-09-25 01:37:31 INFO  Estimated runtime of original DAG is 7325.4640102386475ms
2022-09-25 01:37:31 WARNING Skipping Multi-Query Optimization (instead, only applying patches)
2022-09-25 01:37:31 INFO  Estimated unoptimised what-if runtime is 183136.6002559662ms
2022-09-25 01:37:31 INFO  ---RUNTIME: Multi-Query Optimization took 17.992019653320312 ms
2022-09-25 01:37:31 INFO  Executing generated plans
2022-09-25 01:40:49 INFO  ---RUNTIME: Execution took 198325.5171775818 ms
2022-09-25 01:40:49 INFO  Done!
2022-09-25 01:40:49 INFO  # Finished -- repetition 4 of 7 
2022-09-25 01:40:49 INFO  # Optimization benchmark for data_corruption with args [['reviews', 'slow_loading', 'featurization_0', 'xgboost']] -- repetition 5 of 7
2022-09-25 01:40:49 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-25 01:40:49 INFO  Running instrumented original pipeline...
2022-09-25 01:40:49 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-25 01:40:49 INFO  ---RUNTIME: Importing and monkey-patching took 6.569147109985352 ms
2022-09-25 01:40:57 INFO  ---RUNTIME: Original pipeline execution took 7591.994285583496 ms (excluding imports and monkey-patching)
2022-09-25 01:40:57 INFO  Starting execution of 1 what-if analyses...
2022-09-25 01:40:57 INFO  Start plan generation for analysis DataCorruption...
2022-09-25 01:40:57 INFO  ---RUNTIME: Plan generation took 0.42557716369628906 ms
2022-09-25 01:40:57 INFO  Estimated runtime of original DAG is 7310.319185256958ms
2022-09-25 01:40:57 INFO  Performing Multi-Query Optimization
2022-09-25 01:40:57 INFO  Estimated unoptimized what-if runtime is 182757.97963142395ms
2022-09-25 01:40:57 INFO  Estimated optimised what-if runtime is 20935.871362686157ms
2022-09-25 01:40:57 INFO  Estimated optimisation runtime saving is 161822.1082687378ms
2022-09-25 01:40:57 INFO  ---RUNTIME: Multi-Query Optimization took 58.646440505981445 ms
2022-09-25 01:40:57 INFO  Executing generated plans
2022-09-25 01:41:23 INFO  ---RUNTIME: Execution took 25851.781606674194 ms
2022-09-25 01:41:23 INFO  Done!
2022-09-25 01:41:23 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-25 01:41:23 INFO  Running instrumented original pipeline...
2022-09-25 01:41:23 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-25 01:41:23 INFO  ---RUNTIME: Importing and monkey-patching took 6.476879119873047 ms
2022-09-25 01:41:30 INFO  ---RUNTIME: Original pipeline execution took 7574.134826660156 ms (excluding imports and monkey-patching)
2022-09-25 01:41:30 INFO  Starting execution of 1 what-if analyses...
2022-09-25 01:41:30 INFO  Start plan generation for analysis DataCorruption...
2022-09-25 01:41:30 INFO  ---RUNTIME: Plan generation took 0.42700767517089844 ms
2022-09-25 01:41:30 INFO  Estimated runtime of original DAG is 7287.1413230896ms
2022-09-25 01:41:30 WARNING Skipping Multi-Query Optimization (instead, only applying patches)
2022-09-25 01:41:30 INFO  Estimated unoptimised what-if runtime is 182178.53307724ms
2022-09-25 01:41:30 INFO  ---RUNTIME: Multi-Query Optimization took 17.780780792236328 ms
2022-09-25 01:41:30 INFO  Executing generated plans
2022-09-25 01:44:48 INFO  ---RUNTIME: Execution took 197754.58884239197 ms
2022-09-25 01:44:48 INFO  Done!
2022-09-25 01:44:48 INFO  # Finished -- repetition 5 of 7 
2022-09-25 01:44:48 INFO  # Optimization benchmark for data_corruption with args [['reviews', 'slow_loading', 'featurization_0', 'xgboost']] -- repetition 6 of 7
2022-09-25 01:44:48 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-25 01:44:48 INFO  Running instrumented original pipeline...
2022-09-25 01:44:48 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-25 01:44:48 INFO  ---RUNTIME: Importing and monkey-patching took 6.462812423706055 ms
2022-09-25 01:44:56 INFO  ---RUNTIME: Original pipeline execution took 7589.1289710998535 ms (excluding imports and monkey-patching)
2022-09-25 01:44:56 INFO  Starting execution of 1 what-if analyses...
2022-09-25 01:44:56 INFO  Start plan generation for analysis DataCorruption...
2022-09-25 01:44:56 INFO  ---RUNTIME: Plan generation took 0.4265308380126953 ms
2022-09-25 01:44:56 INFO  Estimated runtime of original DAG is 7305.794477462769ms
2022-09-25 01:44:56 INFO  Performing Multi-Query Optimization
2022-09-25 01:44:56 INFO  Estimated unoptimized what-if runtime is 182644.8619365692ms
2022-09-25 01:44:56 INFO  Estimated optimised what-if runtime is 20933.278799057007ms
2022-09-25 01:44:56 INFO  Estimated optimisation runtime saving is 161711.5831375122ms
2022-09-25 01:44:56 INFO  ---RUNTIME: Multi-Query Optimization took 58.309078216552734 ms
2022-09-25 01:44:56 INFO  Executing generated plans
2022-09-25 01:45:21 INFO  ---RUNTIME: Execution took 25785.006284713745 ms
2022-09-25 01:45:21 INFO  Done!
2022-09-25 01:45:21 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-25 01:45:21 INFO  Running instrumented original pipeline...
2022-09-25 01:45:22 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-25 01:45:22 INFO  ---RUNTIME: Importing and monkey-patching took 6.583213806152344 ms
2022-09-25 01:45:29 INFO  ---RUNTIME: Original pipeline execution took 7583.229303359985 ms (excluding imports and monkey-patching)
2022-09-25 01:45:29 INFO  Starting execution of 1 what-if analyses...
2022-09-25 01:45:29 INFO  Start plan generation for analysis DataCorruption...
2022-09-25 01:45:29 INFO  ---RUNTIME: Plan generation took 1.2166500091552734 ms
2022-09-25 01:45:29 INFO  Estimated runtime of original DAG is 7302.1299839019775ms
2022-09-25 01:45:29 WARNING Skipping Multi-Query Optimization (instead, only applying patches)
2022-09-25 01:45:29 INFO  Estimated unoptimised what-if runtime is 182553.24959754944ms
2022-09-25 01:45:29 INFO  ---RUNTIME: Multi-Query Optimization took 16.915082931518555 ms
2022-09-25 01:45:29 INFO  Executing generated plans
2022-09-25 01:48:46 INFO  ---RUNTIME: Execution took 197334.20491218567 ms
2022-09-25 01:48:46 INFO  Done!
2022-09-25 01:48:46 INFO  # Finished -- repetition 6 of 7 
2022-09-25 01:48:46 INFO  # Optimization benchmark for data_corruption with args [['reviews', 'slow_loading', 'featurization_0', 'xgboost']] -- repetition 7 of 7
2022-09-25 01:48:46 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-25 01:48:46 INFO  Running instrumented original pipeline...
2022-09-25 01:48:46 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-25 01:48:46 INFO  ---RUNTIME: Importing and monkey-patching took 6.438970565795898 ms
2022-09-25 01:48:55 INFO  ---RUNTIME: Original pipeline execution took 8213.629007339478 ms (excluding imports and monkey-patching)
2022-09-25 01:48:55 INFO  Starting execution of 1 what-if analyses...
2022-09-25 01:48:55 INFO  Start plan generation for analysis DataCorruption...
2022-09-25 01:48:55 INFO  ---RUNTIME: Plan generation took 1.2497901916503906 ms
2022-09-25 01:48:55 INFO  Estimated runtime of original DAG is 7928.781032562256ms
2022-09-25 01:48:55 INFO  Performing Multi-Query Optimization
2022-09-25 01:48:55 INFO  Estimated unoptimized what-if runtime is 198219.5258140564ms
2022-09-25 01:48:55 INFO  Estimated optimised what-if runtime is 21541.22495651245ms
2022-09-25 01:48:55 INFO  Estimated optimisation runtime saving is 176678.30085754395ms
2022-09-25 01:48:55 INFO  ---RUNTIME: Multi-Query Optimization took 57.192325592041016 ms
2022-09-25 01:48:55 INFO  Executing generated plans
2022-09-25 01:49:21 INFO  ---RUNTIME: Execution took 25897.300958633423 ms
2022-09-25 01:49:21 INFO  Done!
2022-09-25 01:49:21 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-25 01:49:21 INFO  Running instrumented original pipeline...
2022-09-25 01:49:21 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-25 01:49:21 INFO  ---RUNTIME: Importing and monkey-patching took 6.083965301513672 ms
2022-09-25 01:49:28 INFO  ---RUNTIME: Original pipeline execution took 7823.838472366333 ms (excluding imports and monkey-patching)
2022-09-25 01:49:28 INFO  Starting execution of 1 what-if analyses...
2022-09-25 01:49:28 INFO  Start plan generation for analysis DataCorruption...
2022-09-25 01:49:28 INFO  ---RUNTIME: Plan generation took 0.4596710205078125 ms
2022-09-25 01:49:28 INFO  Estimated runtime of original DAG is 7318.501234054565ms
2022-09-25 01:49:28 WARNING Skipping Multi-Query Optimization (instead, only applying patches)
2022-09-25 01:49:28 INFO  Estimated unoptimised what-if runtime is 182962.53085136414ms
2022-09-25 01:49:28 INFO  ---RUNTIME: Multi-Query Optimization took 17.255783081054688 ms
2022-09-25 01:49:28 INFO  Executing generated plans
2022-09-25 01:52:46 INFO  ---RUNTIME: Execution took 197435.98294258118 ms
2022-09-25 01:52:46 INFO  Done!
2022-09-25 01:52:46 INFO  # Finished -- repetition 7 of 7 
2022-09-25 01:52:46 INFO  # Final results after all repetitions
2022-09-25 01:52:46 INFO     repetition  ... no_opt_what_if_execution_combined_model_training
0           0  ...                                     47271.096468
1           1  ...                                     47216.458082
2           2  ...                                     47067.441225
3           3  ...                                     46657.592058
4           4  ...                                     46581.541061
5           5  ...                                     46647.983789
6           6  ...                                     46730.360508

[7 rows x 26 columns]
PROTOCOL_BUFFERS_PYTHON_IMPLEMENTATION=python taskset -c 32-39 python3.9 benchmarks_end_to_end.py data_corruption reviews slow_loading featurization_0 neural_network
2022-09-25 01:52:48.565600: W tensorflow/stream_executor/platform/default/dso_loader.cc:64] Could not load dynamic library 'libcudart.so.11.0'; dlerror: libcudart.so.11.0: cannot open shared object file: No such file or directory; LD_LIBRARY_PATH: /home/sgrafbe/mlwhatif/venv/lib/python3.9/site-packages/cv2/../../lib64:
2022-09-25 01:52:48.565644: I tensorflow/stream_executor/cuda/cudart_stub.cc:29] Ignore above cudart dlerror if you do not have a GPU set up on your machine.
2022-09-25 01:52:49 INFO  Patching sys.argv with ['mlwhatif', 'reviews', 'slow_loading', 'featurization_0', 'neural_network']
2022-09-25 01:52:49 INFO  Running instrumented original pipeline...
2022-09-25 01:52:49 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-25 01:52:49 INFO  ---RUNTIME: Importing and monkey-patching took 95.88623046875 ms
2022-09-25 01:52:54.114640: W tensorflow/stream_executor/platform/default/dso_loader.cc:64] Could not load dynamic library 'libcuda.so.1'; dlerror: libcuda.so.1: cannot open shared object file: No such file or directory; LD_LIBRARY_PATH: /home/sgrafbe/mlwhatif/venv/lib/python3.9/site-packages/cv2/../../lib64:
2022-09-25 01:52:54.114683: W tensorflow/stream_executor/cuda/cuda_driver.cc:326] failed call to cuInit: UNKNOWN ERROR (303)
2022-09-25 01:52:54.114706: I tensorflow/stream_executor/cuda/cuda_diagnostics.cc:156] kernel driver does not appear to be running on this host (wagyu): /proc/driver/nvidia/version does not exist
2022-09-25 01:52:54.115419: I tensorflow/core/platform/cpu_feature_guard.cc:142] This TensorFlow binary is optimized with oneAPI Deep Neural Network Library (oneDNN) to use the following CPU instructions in performance-critical operations:  AVX2 FMA
To enable them in other operations, rebuild TensorFlow with the appropriate compiler flags.
2022-09-25 01:52:54.184844: I tensorflow/compiler/mlir/mlir_graph_optimization_pass.cc:176] None of the MLIR Optimization Passes are enabled (registered 2)
2022-09-25 01:52:54.197373: I tensorflow/core/platform/profile_utils/cpu_utils.cc:114] CPU Frequency: 2595290000 Hz
2022-09-25 01:52:59 INFO  ---RUNTIME: Original pipeline execution took 9395.040512084961 ms (excluding imports and monkey-patching)
2022-09-25 01:52:59 INFO  Starting execution of 0 what-if analyses...
2022-09-25 01:52:59 INFO  Estimated runtime of original DAG is 9081.653356552124ms
2022-09-25 01:52:59 INFO  Performing Multi-Query Optimization
2022-09-25 01:52:59 INFO  Estimated unoptimized what-if runtime is 0ms
2022-09-25 01:52:59 INFO  Estimated optimised what-if runtime is 0ms
2022-09-25 01:52:59 INFO  Estimated optimisation runtime saving is 0ms
2022-09-25 01:52:59 INFO  ---RUNTIME: Multi-Query Optimization took 0.4754066467285156 ms
2022-09-25 01:52:59 INFO  Executing generated plans
2022-09-25 01:52:59 INFO  ---RUNTIME: Execution took 0.0209808349609375 ms
2022-09-25 01:52:59 INFO  Done!
2022-09-25 01:52:59 INFO  # Optimization benchmark for data_corruption with args [['reviews', 'slow_loading', 'featurization_0', 'neural_network']] -- repetition 1 of 7
2022-09-25 01:52:59 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-25 01:52:59 INFO  Running instrumented original pipeline...
2022-09-25 01:52:59 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-25 01:52:59 INFO  ---RUNTIME: Importing and monkey-patching took 5.639314651489258 ms
2022-09-25 01:53:08 INFO  ---RUNTIME: Original pipeline execution took 9043.70379447937 ms (excluding imports and monkey-patching)
2022-09-25 01:53:08 INFO  Starting execution of 1 what-if analyses...
2022-09-25 01:53:08 INFO  Start plan generation for analysis DataCorruption...
2022-09-25 01:53:08 INFO  ---RUNTIME: Plan generation took 0.42700767517089844 ms
2022-09-25 01:53:08 INFO  Estimated runtime of original DAG is 8763.784646987915ms
2022-09-25 01:53:08 INFO  Performing Multi-Query Optimization
2022-09-25 01:53:08 INFO  Estimated unoptimized what-if runtime is 219094.61617469788ms
2022-09-25 01:53:08 INFO  Estimated optimised what-if runtime is 25725.800275802612ms
2022-09-25 01:53:08 INFO  Estimated optimisation runtime saving is 193368.81589889526ms
2022-09-25 01:53:08 INFO  ---RUNTIME: Multi-Query Optimization took 58.593034744262695 ms
2022-09-25 01:53:08 INFO  Executing generated plans
2022-09-25 01:53:37 INFO  ---RUNTIME: Execution took 29086.89284324646 ms
2022-09-25 01:53:37 INFO  Done!
2022-09-25 01:53:37 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-25 01:53:37 INFO  Running instrumented original pipeline...
2022-09-25 01:53:37 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-25 01:53:37 INFO  ---RUNTIME: Importing and monkey-patching took 6.366252899169922 ms
2022-09-25 01:53:46 INFO  ---RUNTIME: Original pipeline execution took 9268.289804458618 ms (excluding imports and monkey-patching)
2022-09-25 01:53:46 INFO  Starting execution of 1 what-if analyses...
2022-09-25 01:53:46 INFO  Start plan generation for analysis DataCorruption...
2022-09-25 01:53:46 INFO  ---RUNTIME: Plan generation took 0.6248950958251953 ms
2022-09-25 01:53:46 INFO  Estimated runtime of original DAG is 8735.381126403809ms
2022-09-25 01:53:46 WARNING Skipping Multi-Query Optimization (instead, only applying patches)
2022-09-25 01:53:46 INFO  Estimated unoptimised what-if runtime is 218384.52816009521ms
2022-09-25 01:53:46 INFO  ---RUNTIME: Multi-Query Optimization took 26.855945587158203 ms
2022-09-25 01:53:46 INFO  Executing generated plans
2022-09-25 01:57:41 INFO  ---RUNTIME: Execution took 234239.7677898407 ms
2022-09-25 01:57:41 INFO  Done!
2022-09-25 01:57:41 INFO  # Finished -- repetition 1 of 7 
2022-09-25 01:57:41 INFO  # Optimization benchmark for data_corruption with args [['reviews', 'slow_loading', 'featurization_0', 'neural_network']] -- repetition 2 of 7
2022-09-25 01:57:41 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-25 01:57:41 INFO  Running instrumented original pipeline...
2022-09-25 01:57:41 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-25 01:57:41 INFO  ---RUNTIME: Importing and monkey-patching took 6.078243255615234 ms
2022-09-25 01:57:50 INFO  ---RUNTIME: Original pipeline execution took 9031.8763256073 ms (excluding imports and monkey-patching)
2022-09-25 01:57:50 INFO  Starting execution of 1 what-if analyses...
2022-09-25 01:57:50 INFO  Start plan generation for analysis DataCorruption...
2022-09-25 01:57:50 INFO  ---RUNTIME: Plan generation took 0.39696693420410156 ms
2022-09-25 01:57:50 INFO  Estimated runtime of original DAG is 8754.709243774414ms
2022-09-25 01:57:50 INFO  Performing Multi-Query Optimization
2022-09-25 01:57:50 INFO  Estimated unoptimized what-if runtime is 218867.73109436035ms
2022-09-25 01:57:50 INFO  Estimated optimised what-if runtime is 24605.287551879883ms
2022-09-25 01:57:50 INFO  Estimated optimisation runtime saving is 194262.44354248047ms
2022-09-25 01:57:50 INFO  ---RUNTIME: Multi-Query Optimization took 59.648990631103516 ms
2022-09-25 01:57:50 INFO  Executing generated plans
2022-09-25 01:58:19 INFO  ---RUNTIME: Execution took 29000.956058502197 ms
2022-09-25 01:58:19 INFO  Done!
2022-09-25 01:58:19 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-25 01:58:19 INFO  Running instrumented original pipeline...
2022-09-25 01:58:19 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-25 01:58:19 INFO  ---RUNTIME: Importing and monkey-patching took 7.299184799194336 ms
2022-09-25 01:58:28 INFO  ---RUNTIME: Original pipeline execution took 9231.460809707642 ms (excluding imports and monkey-patching)
2022-09-25 01:58:28 INFO  Starting execution of 1 what-if analyses...
2022-09-25 01:58:28 INFO  Start plan generation for analysis DataCorruption...
2022-09-25 01:58:28 INFO  ---RUNTIME: Plan generation took 0.38695335388183594 ms
2022-09-25 01:58:28 INFO  Estimated runtime of original DAG is 8944.031715393066ms
2022-09-25 01:58:28 WARNING Skipping Multi-Query Optimization (instead, only applying patches)
2022-09-25 01:58:28 INFO  Estimated unoptimised what-if runtime is 223600.79288482666ms
2022-09-25 01:58:28 INFO  ---RUNTIME: Multi-Query Optimization took 17.80390739440918 ms
2022-09-25 01:58:28 INFO  Executing generated plans
2022-09-25 02:02:21 INFO  ---RUNTIME: Execution took 232876.70469284058 ms
2022-09-25 02:02:21 INFO  Done!
2022-09-25 02:02:21 INFO  # Finished -- repetition 2 of 7 
2022-09-25 02:02:21 INFO  # Optimization benchmark for data_corruption with args [['reviews', 'slow_loading', 'featurization_0', 'neural_network']] -- repetition 3 of 7
2022-09-25 02:02:21 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-25 02:02:21 INFO  Running instrumented original pipeline...
2022-09-25 02:02:21 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-25 02:02:21 INFO  ---RUNTIME: Importing and monkey-patching took 6.435155868530273 ms
2022-09-25 02:02:30 INFO  ---RUNTIME: Original pipeline execution took 9279.402732849121 ms (excluding imports and monkey-patching)
2022-09-25 02:02:30 INFO  Starting execution of 1 what-if analyses...
2022-09-25 02:02:30 INFO  Start plan generation for analysis DataCorruption...
2022-09-25 02:02:30 INFO  ---RUNTIME: Plan generation took 0.3955364227294922 ms
2022-09-25 02:02:30 INFO  Estimated runtime of original DAG is 9002.522706985474ms
2022-09-25 02:02:30 INFO  Performing Multi-Query Optimization
2022-09-25 02:02:30 INFO  Estimated unoptimized what-if runtime is 225063.06767463684ms
2022-09-25 02:02:30 INFO  Estimated optimised what-if runtime is 32793.527603149414ms
2022-09-25 02:02:30 INFO  Estimated optimisation runtime saving is 192269.54007148743ms
2022-09-25 02:02:30 INFO  ---RUNTIME: Multi-Query Optimization took 58.82763862609863 ms
2022-09-25 02:02:30 INFO  Executing generated plans
2022-09-25 02:02:59 INFO  ---RUNTIME: Execution took 28844.563245773315 ms
2022-09-25 02:02:59 INFO  Done!
2022-09-25 02:02:59 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-25 02:02:59 INFO  Running instrumented original pipeline...
2022-09-25 02:02:59 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-25 02:02:59 INFO  ---RUNTIME: Importing and monkey-patching took 6.447076797485352 ms
2022-09-25 02:03:08 INFO  ---RUNTIME: Original pipeline execution took 8923.770189285278 ms (excluding imports and monkey-patching)
2022-09-25 02:03:08 INFO  Starting execution of 1 what-if analyses...
2022-09-25 02:03:08 INFO  Start plan generation for analysis DataCorruption...
2022-09-25 02:03:08 INFO  ---RUNTIME: Plan generation took 0.4458427429199219 ms
2022-09-25 02:03:08 INFO  Estimated runtime of original DAG is 8642.634868621826ms
2022-09-25 02:03:08 WARNING Skipping Multi-Query Optimization (instead, only applying patches)
2022-09-25 02:03:08 INFO  Estimated unoptimised what-if runtime is 216065.87171554565ms
2022-09-25 02:03:08 INFO  ---RUNTIME: Multi-Query Optimization took 17.83013343811035 ms
2022-09-25 02:03:08 INFO  Executing generated plans
2022-09-25 02:07:01 INFO  ---RUNTIME: Execution took 232604.0358543396 ms
2022-09-25 02:07:01 INFO  Done!
2022-09-25 02:07:01 INFO  # Finished -- repetition 3 of 7 
2022-09-25 02:07:01 INFO  # Optimization benchmark for data_corruption with args [['reviews', 'slow_loading', 'featurization_0', 'neural_network']] -- repetition 4 of 7
2022-09-25 02:07:01 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-25 02:07:01 INFO  Running instrumented original pipeline...
2022-09-25 02:07:01 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-25 02:07:01 INFO  ---RUNTIME: Importing and monkey-patching took 6.101369857788086 ms
2022-09-25 02:07:10 INFO  ---RUNTIME: Original pipeline execution took 9001.336812973022 ms (excluding imports and monkey-patching)
2022-09-25 02:07:10 INFO  Starting execution of 1 what-if analyses...
2022-09-25 02:07:10 INFO  Start plan generation for analysis DataCorruption...
2022-09-25 02:07:10 INFO  ---RUNTIME: Plan generation took 0.4425048828125 ms
2022-09-25 02:07:10 INFO  Estimated runtime of original DAG is 8719.81430053711ms
2022-09-25 02:07:10 INFO  Performing Multi-Query Optimization
2022-09-25 02:07:10 INFO  Estimated unoptimized what-if runtime is 217995.35751342773ms
2022-09-25 02:07:10 INFO  Estimated optimised what-if runtime is 24494.145393371582ms
2022-09-25 02:07:10 INFO  Estimated optimisation runtime saving is 193501.21212005615ms
2022-09-25 02:07:10 INFO  ---RUNTIME: Multi-Query Optimization took 59.79800224304199 ms
2022-09-25 02:07:10 INFO  Executing generated plans
2022-09-25 02:07:39 INFO  ---RUNTIME: Execution took 28832.64994621277 ms
2022-09-25 02:07:39 INFO  Done!
2022-09-25 02:07:39 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-25 02:07:39 INFO  Running instrumented original pipeline...
2022-09-25 02:07:39 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-25 02:07:39 INFO  ---RUNTIME: Importing and monkey-patching took 7.010936737060547 ms
2022-09-25 02:07:48 INFO  ---RUNTIME: Original pipeline execution took 8964.04242515564 ms (excluding imports and monkey-patching)
2022-09-25 02:07:48 INFO  Starting execution of 1 what-if analyses...
2022-09-25 02:07:48 INFO  Start plan generation for analysis DataCorruption...
2022-09-25 02:07:48 INFO  ---RUNTIME: Plan generation took 2.138853073120117 ms
2022-09-25 02:07:48 INFO  Estimated runtime of original DAG is 8677.988052368164ms
2022-09-25 02:07:48 WARNING Skipping Multi-Query Optimization (instead, only applying patches)
2022-09-25 02:07:48 INFO  Estimated unoptimised what-if runtime is 216949.7013092041ms
2022-09-25 02:07:48 INFO  ---RUNTIME: Multi-Query Optimization took 16.977548599243164 ms
2022-09-25 02:07:48 INFO  Executing generated plans
2022-09-25 02:11:40 INFO  ---RUNTIME: Execution took 232822.57533073425 ms
2022-09-25 02:11:40 INFO  Done!
2022-09-25 02:11:40 INFO  # Finished -- repetition 4 of 7 
2022-09-25 02:11:40 INFO  # Optimization benchmark for data_corruption with args [['reviews', 'slow_loading', 'featurization_0', 'neural_network']] -- repetition 5 of 7
2022-09-25 02:11:40 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-25 02:11:40 INFO  Running instrumented original pipeline...
2022-09-25 02:11:40 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-25 02:11:40 INFO  ---RUNTIME: Importing and monkey-patching took 6.412744522094727 ms
2022-09-25 02:11:49 INFO  ---RUNTIME: Original pipeline execution took 8860.173463821411 ms (excluding imports and monkey-patching)
2022-09-25 02:11:49 INFO  Starting execution of 1 what-if analyses...
2022-09-25 02:11:49 INFO  Start plan generation for analysis DataCorruption...
2022-09-25 02:11:49 INFO  ---RUNTIME: Plan generation took 0.37860870361328125 ms
2022-09-25 02:11:49 INFO  Estimated runtime of original DAG is 8576.54857635498ms
2022-09-25 02:11:49 INFO  Performing Multi-Query Optimization
2022-09-25 02:11:49 INFO  Estimated unoptimized what-if runtime is 214413.7144088745ms
2022-09-25 02:11:49 INFO  Estimated optimised what-if runtime is 24134.666919708252ms
2022-09-25 02:11:49 INFO  Estimated optimisation runtime saving is 190279.04748916626ms
2022-09-25 02:11:49 INFO  ---RUNTIME: Multi-Query Optimization took 58.08281898498535 ms
2022-09-25 02:11:49 INFO  Executing generated plans
2022-09-25 02:12:18 INFO  ---RUNTIME: Execution took 28849.088430404663 ms
2022-09-25 02:12:18 INFO  Done!
2022-09-25 02:12:18 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-25 02:12:18 INFO  Running instrumented original pipeline...
2022-09-25 02:12:18 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-25 02:12:18 INFO  ---RUNTIME: Importing and monkey-patching took 6.119966506958008 ms
2022-09-25 02:12:28 INFO  ---RUNTIME: Original pipeline execution took 9424.445867538452 ms (excluding imports and monkey-patching)
2022-09-25 02:12:28 INFO  Starting execution of 1 what-if analyses...
2022-09-25 02:12:28 INFO  Start plan generation for analysis DataCorruption...
2022-09-25 02:12:28 INFO  ---RUNTIME: Plan generation took 0.6575584411621094 ms
2022-09-25 02:12:28 INFO  Estimated runtime of original DAG is 9136.495590209961ms
2022-09-25 02:12:28 WARNING Skipping Multi-Query Optimization (instead, only applying patches)
2022-09-25 02:12:28 INFO  Estimated unoptimised what-if runtime is 228412.38975524902ms
2022-09-25 02:12:28 INFO  ---RUNTIME: Multi-Query Optimization took 27.516841888427734 ms
2022-09-25 02:12:28 INFO  Executing generated plans
2022-09-25 02:16:21 INFO  ---RUNTIME: Execution took 233257.81106948853 ms
2022-09-25 02:16:21 INFO  Done!
2022-09-25 02:16:21 INFO  # Finished -- repetition 5 of 7 
2022-09-25 02:16:21 INFO  # Optimization benchmark for data_corruption with args [['reviews', 'slow_loading', 'featurization_0', 'neural_network']] -- repetition 6 of 7
2022-09-25 02:16:21 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-25 02:16:21 INFO  Running instrumented original pipeline...
2022-09-25 02:16:21 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-25 02:16:21 INFO  ---RUNTIME: Importing and monkey-patching took 6.315708160400391 ms
2022-09-25 02:16:30 INFO  ---RUNTIME: Original pipeline execution took 9004.579782485962 ms (excluding imports and monkey-patching)
2022-09-25 02:16:30 INFO  Starting execution of 1 what-if analyses...
2022-09-25 02:16:30 INFO  Start plan generation for analysis DataCorruption...
2022-09-25 02:16:30 INFO  ---RUNTIME: Plan generation took 0.4391670227050781 ms
2022-09-25 02:16:30 INFO  Estimated runtime of original DAG is 8722.447156906128ms
2022-09-25 02:16:30 INFO  Performing Multi-Query Optimization
2022-09-25 02:16:30 INFO  Estimated unoptimized what-if runtime is 218061.1789226532ms
2022-09-25 02:16:30 INFO  Estimated optimised what-if runtime is 24551.161289215088ms
2022-09-25 02:16:30 INFO  Estimated optimisation runtime saving is 193510.0176334381ms
2022-09-25 02:16:30 INFO  ---RUNTIME: Multi-Query Optimization took 57.9071044921875 ms
2022-09-25 02:16:30 INFO  Executing generated plans
2022-09-25 02:17:00 INFO  ---RUNTIME: Execution took 29565.136671066284 ms
2022-09-25 02:17:00 INFO  Done!
2022-09-25 02:17:00 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-25 02:17:00 INFO  Running instrumented original pipeline...
2022-09-25 02:17:00 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-25 02:17:00 INFO  ---RUNTIME: Importing and monkey-patching took 6.548404693603516 ms
2022-09-25 02:17:09 INFO  ---RUNTIME: Original pipeline execution took 9858.936309814453 ms (excluding imports and monkey-patching)
2022-09-25 02:17:09 INFO  Starting execution of 1 what-if analyses...
2022-09-25 02:17:09 INFO  Start plan generation for analysis DataCorruption...
2022-09-25 02:17:09 INFO  ---RUNTIME: Plan generation took 0.45490264892578125 ms
2022-09-25 02:17:09 INFO  Estimated runtime of original DAG is 9187.508344650269ms
2022-09-25 02:17:09 WARNING Skipping Multi-Query Optimization (instead, only applying patches)
2022-09-25 02:17:09 INFO  Estimated unoptimised what-if runtime is 229687.7086162567ms
2022-09-25 02:17:09 INFO  ---RUNTIME: Multi-Query Optimization took 19.68097686767578 ms
2022-09-25 02:17:09 INFO  Executing generated plans
2022-09-25 02:21:11 INFO  ---RUNTIME: Execution took 241327.57878303528 ms
2022-09-25 02:21:11 INFO  Done!
2022-09-25 02:21:11 INFO  # Finished -- repetition 6 of 7 
2022-09-25 02:21:11 INFO  # Optimization benchmark for data_corruption with args [['reviews', 'slow_loading', 'featurization_0', 'neural_network']] -- repetition 7 of 7
2022-09-25 02:21:11 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-25 02:21:11 INFO  Running instrumented original pipeline...
2022-09-25 02:21:11 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-25 02:21:11 INFO  ---RUNTIME: Importing and monkey-patching took 6.505727767944336 ms
2022-09-25 02:21:20 INFO  ---RUNTIME: Original pipeline execution took 9450.941801071167 ms (excluding imports and monkey-patching)
2022-09-25 02:21:20 INFO  Starting execution of 1 what-if analyses...
2022-09-25 02:21:20 INFO  Start plan generation for analysis DataCorruption...
2022-09-25 02:21:20 INFO  ---RUNTIME: Plan generation took 0.4496574401855469 ms
2022-09-25 02:21:20 INFO  Estimated runtime of original DAG is 9164.008140563965ms
2022-09-25 02:21:20 INFO  Performing Multi-Query Optimization
2022-09-25 02:21:20 INFO  Estimated unoptimized what-if runtime is 229100.20351409912ms
2022-09-25 02:21:20 INFO  Estimated optimised what-if runtime is 25509.16028022766ms
2022-09-25 02:21:20 INFO  Estimated optimisation runtime saving is 203591.04323387146ms
2022-09-25 02:21:20 INFO  ---RUNTIME: Multi-Query Optimization took 58.94804000854492 ms
2022-09-25 02:21:20 INFO  Executing generated plans
2022-09-25 02:21:50 INFO  ---RUNTIME: Execution took 29387.614965438843 ms
2022-09-25 02:21:50 INFO  Done!
2022-09-25 02:21:50 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-25 02:21:50 INFO  Running instrumented original pipeline...
2022-09-25 02:21:50 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-25 02:21:50 INFO  ---RUNTIME: Importing and monkey-patching took 6.020545959472656 ms
2022-09-25 02:21:59 INFO  ---RUNTIME: Original pipeline execution took 9414.513349533081 ms (excluding imports and monkey-patching)
2022-09-25 02:21:59 INFO  Starting execution of 1 what-if analyses...
2022-09-25 02:21:59 INFO  Start plan generation for analysis DataCorruption...
2022-09-25 02:21:59 INFO  ---RUNTIME: Plan generation took 0.37598609924316406 ms
2022-09-25 02:21:59 INFO  Estimated runtime of original DAG is 9131.728172302246ms
2022-09-25 02:21:59 WARNING Skipping Multi-Query Optimization (instead, only applying patches)
2022-09-25 02:22:00 INFO  Estimated unoptimised what-if runtime is 228293.20430755615ms
2022-09-25 02:22:00 INFO  ---RUNTIME: Multi-Query Optimization took 391.909122467041 ms
2022-09-25 02:22:00 INFO  Executing generated plans
2022-09-25 02:25:59 INFO  ---RUNTIME: Execution took 239103.53541374207 ms
2022-09-25 02:25:59 INFO  Done!
2022-09-25 02:25:59 INFO  # Finished -- repetition 7 of 7 
2022-09-25 02:25:59 INFO  # Final results after all repetitions
2022-09-25 02:25:59 INFO     repetition  ... no_opt_what_if_execution_combined_model_training
0           0  ...                                     80109.122276
1           1  ...                                     79044.138670
2           2  ...                                     78425.791979
3           3  ...                                     78725.446224
4           4  ...                                     79447.497845
5           5  ...                                     83903.243303
6           6  ...                                     82586.483717

[7 rows x 26 columns]
PROTOCOL_BUFFERS_PYTHON_IMPLEMENTATION=python taskset -c 32-39 python3.9 benchmarks_end_to_end.py data_corruption reviews slow_loading featurization_1 logistic_regression
2022-09-25 02:26:01.667000: W tensorflow/stream_executor/platform/default/dso_loader.cc:64] Could not load dynamic library 'libcudart.so.11.0'; dlerror: libcudart.so.11.0: cannot open shared object file: No such file or directory; LD_LIBRARY_PATH: /home/sgrafbe/mlwhatif/venv/lib/python3.9/site-packages/cv2/../../lib64:
2022-09-25 02:26:01.667037: I tensorflow/stream_executor/cuda/cudart_stub.cc:29] Ignore above cudart dlerror if you do not have a GPU set up on your machine.
2022-09-25 02:26:03 INFO  Patching sys.argv with ['mlwhatif', 'reviews', 'slow_loading', 'featurization_1', 'logistic_regression']
2022-09-25 02:26:03 INFO  Running instrumented original pipeline...
2022-09-25 02:26:03 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-25 02:26:03 INFO  ---RUNTIME: Importing and monkey-patching took 102.3099422454834 ms
2022-09-25 02:26:08 INFO  ---RUNTIME: Original pipeline execution took 5842.754125595093 ms (excluding imports and monkey-patching)
2022-09-25 02:26:08 INFO  Starting execution of 0 what-if analyses...
2022-09-25 02:26:08 INFO  Estimated runtime of original DAG is 5498.02041053772ms
2022-09-25 02:26:08 INFO  Performing Multi-Query Optimization
2022-09-25 02:26:08 INFO  Estimated unoptimized what-if runtime is 0ms
2022-09-25 02:26:08 INFO  Estimated optimised what-if runtime is 0ms
2022-09-25 02:26:08 INFO  Estimated optimisation runtime saving is 0ms
2022-09-25 02:26:08 INFO  ---RUNTIME: Multi-Query Optimization took 0.5202293395996094 ms
2022-09-25 02:26:08 INFO  Executing generated plans
2022-09-25 02:26:08 INFO  ---RUNTIME: Execution took 0.027179718017578125 ms
2022-09-25 02:26:08 INFO  Done!
2022-09-25 02:26:08 INFO  # Optimization benchmark for data_corruption with args [['reviews', 'slow_loading', 'featurization_1', 'logistic_regression']] -- repetition 1 of 7
2022-09-25 02:26:08 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-25 02:26:08 INFO  Running instrumented original pipeline...
2022-09-25 02:26:09 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-25 02:26:09 INFO  ---RUNTIME: Importing and monkey-patching took 5.692958831787109 ms
2022-09-25 02:26:14 INFO  ---RUNTIME: Original pipeline execution took 5727.338075637817 ms (excluding imports and monkey-patching)
2022-09-25 02:26:14 INFO  Starting execution of 1 what-if analyses...
2022-09-25 02:26:14 INFO  Start plan generation for analysis DataCorruption...
2022-09-25 02:26:14 INFO  ---RUNTIME: Plan generation took 1.6362667083740234 ms
2022-09-25 02:26:14 INFO  Estimated runtime of original DAG is 5390.9642696380615ms
2022-09-25 02:26:14 INFO  Performing Multi-Query Optimization
2022-09-25 02:26:14 INFO  Estimated unoptimized what-if runtime is 134774.10674095154ms
2022-09-25 02:26:14 INFO  Estimated optimised what-if runtime is 12574.946403503418ms
2022-09-25 02:26:14 INFO  Estimated optimisation runtime saving is 122199.16033744812ms
2022-09-25 02:26:14 INFO  ---RUNTIME: Multi-Query Optimization took 69.5645809173584 ms
2022-09-25 02:26:14 INFO  Executing generated plans
2022-09-25 02:26:32 INFO  ---RUNTIME: Execution took 17692.63005256653 ms
2022-09-25 02:26:32 INFO  Done!
2022-09-25 02:26:32 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-25 02:26:32 INFO  Running instrumented original pipeline...
2022-09-25 02:26:32 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-25 02:26:32 INFO  ---RUNTIME: Importing and monkey-patching took 6.859064102172852 ms
2022-09-25 02:26:38 INFO  ---RUNTIME: Original pipeline execution took 5994.335889816284 ms (excluding imports and monkey-patching)
2022-09-25 02:26:38 INFO  Starting execution of 1 what-if analyses...
2022-09-25 02:26:38 INFO  Start plan generation for analysis DataCorruption...
2022-09-25 02:26:38 INFO  ---RUNTIME: Plan generation took 0.47898292541503906 ms
2022-09-25 02:26:38 INFO  Estimated runtime of original DAG is 5502.206563949585ms
2022-09-25 02:26:38 WARNING Skipping Multi-Query Optimization (instead, only applying patches)
2022-09-25 02:26:38 INFO  Estimated unoptimised what-if runtime is 137555.16409873962ms
2022-09-25 02:26:38 INFO  ---RUNTIME: Multi-Query Optimization took 39.78896141052246 ms
2022-09-25 02:26:38 INFO  Executing generated plans
2022-09-25 02:29:08 INFO  ---RUNTIME: Execution took 150298.98071289062 ms
2022-09-25 02:29:08 INFO  Done!
2022-09-25 02:29:08 INFO  # Finished -- repetition 1 of 7 
2022-09-25 02:29:08 INFO  # Optimization benchmark for data_corruption with args [['reviews', 'slow_loading', 'featurization_1', 'logistic_regression']] -- repetition 2 of 7
2022-09-25 02:29:08 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-25 02:29:08 INFO  Running instrumented original pipeline...
2022-09-25 02:29:08 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-25 02:29:08 INFO  ---RUNTIME: Importing and monkey-patching took 6.52003288269043 ms
2022-09-25 02:29:14 INFO  ---RUNTIME: Original pipeline execution took 5903.212070465088 ms (excluding imports and monkey-patching)
2022-09-25 02:29:14 INFO  Starting execution of 1 what-if analyses...
2022-09-25 02:29:14 INFO  Start plan generation for analysis DataCorruption...
2022-09-25 02:29:14 INFO  ---RUNTIME: Plan generation took 0.4665851593017578 ms
2022-09-25 02:29:14 INFO  Estimated runtime of original DAG is 5600.37088394165ms
2022-09-25 02:29:14 INFO  Performing Multi-Query Optimization
2022-09-25 02:29:14 INFO  Estimated unoptimized what-if runtime is 140009.27209854126ms
2022-09-25 02:29:14 INFO  Estimated optimised what-if runtime is 12470.113754272461ms
2022-09-25 02:29:14 INFO  Estimated optimisation runtime saving is 127539.1583442688ms
2022-09-25 02:29:14 INFO  ---RUNTIME: Multi-Query Optimization took 63.4303092956543 ms
2022-09-25 02:29:14 INFO  Executing generated plans
2022-09-25 02:29:32 INFO  ---RUNTIME: Execution took 17410.845518112183 ms
2022-09-25 02:29:32 INFO  Done!
2022-09-25 02:29:32 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-25 02:29:32 INFO  Running instrumented original pipeline...
2022-09-25 02:29:32 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-25 02:29:32 INFO  ---RUNTIME: Importing and monkey-patching took 7.082700729370117 ms
2022-09-25 02:29:38 INFO  ---RUNTIME: Original pipeline execution took 5939.567089080811 ms (excluding imports and monkey-patching)
2022-09-25 02:29:38 INFO  Starting execution of 1 what-if analyses...
2022-09-25 02:29:38 INFO  Start plan generation for analysis DataCorruption...
2022-09-25 02:29:38 INFO  ---RUNTIME: Plan generation took 0.4169940948486328 ms
2022-09-25 02:29:38 INFO  Estimated runtime of original DAG is 5628.716707229614ms
2022-09-25 02:29:38 WARNING Skipping Multi-Query Optimization (instead, only applying patches)
2022-09-25 02:29:38 INFO  Estimated unoptimised what-if runtime is 140717.91768074036ms
2022-09-25 02:29:38 INFO  ---RUNTIME: Multi-Query Optimization took 19.032955169677734 ms
2022-09-25 02:29:38 INFO  Executing generated plans
2022-09-25 02:32:09 INFO  ---RUNTIME: Execution took 151563.3466243744 ms
2022-09-25 02:32:09 INFO  Done!
2022-09-25 02:32:09 INFO  # Finished -- repetition 2 of 7 
2022-09-25 02:32:09 INFO  # Optimization benchmark for data_corruption with args [['reviews', 'slow_loading', 'featurization_1', 'logistic_regression']] -- repetition 3 of 7
2022-09-25 02:32:09 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-25 02:32:09 INFO  Running instrumented original pipeline...
2022-09-25 02:32:09 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-25 02:32:09 INFO  ---RUNTIME: Importing and monkey-patching took 7.812261581420898 ms
2022-09-25 02:32:15 INFO  ---RUNTIME: Original pipeline execution took 5981.015682220459 ms (excluding imports and monkey-patching)
2022-09-25 02:32:15 INFO  Starting execution of 1 what-if analyses...
2022-09-25 02:32:15 INFO  Start plan generation for analysis DataCorruption...
2022-09-25 02:32:15 INFO  ---RUNTIME: Plan generation took 1.3756752014160156 ms
2022-09-25 02:32:15 INFO  Estimated runtime of original DAG is 5661.214113235474ms
2022-09-25 02:32:15 INFO  Performing Multi-Query Optimization
2022-09-25 02:32:15 INFO  Estimated unoptimized what-if runtime is 141530.35283088684ms
2022-09-25 02:32:15 INFO  Estimated optimised what-if runtime is 12790.762662887573ms
2022-09-25 02:32:15 INFO  Estimated optimisation runtime saving is 128739.59016799927ms
2022-09-25 02:32:15 INFO  ---RUNTIME: Multi-Query Optimization took 63.26413154602051 ms
2022-09-25 02:32:15 INFO  Executing generated plans
2022-09-25 02:32:33 INFO  ---RUNTIME: Execution took 17527.51874923706 ms
2022-09-25 02:32:33 INFO  Done!
2022-09-25 02:32:33 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-25 02:32:33 INFO  Running instrumented original pipeline...
2022-09-25 02:32:33 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-25 02:32:33 INFO  ---RUNTIME: Importing and monkey-patching took 6.056785583496094 ms
2022-09-25 02:32:39 INFO  ---RUNTIME: Original pipeline execution took 5715.53897857666 ms (excluding imports and monkey-patching)
2022-09-25 02:32:39 INFO  Starting execution of 1 what-if analyses...
2022-09-25 02:32:39 INFO  Start plan generation for analysis DataCorruption...
2022-09-25 02:32:39 INFO  ---RUNTIME: Plan generation took 0.41961669921875 ms
2022-09-25 02:32:39 INFO  Estimated runtime of original DAG is 5410.665988922119ms
2022-09-25 02:32:39 WARNING Skipping Multi-Query Optimization (instead, only applying patches)
2022-09-25 02:32:39 INFO  Estimated unoptimised what-if runtime is 135266.64972305298ms
2022-09-25 02:32:39 INFO  ---RUNTIME: Multi-Query Optimization took 39.92652893066406 ms
2022-09-25 02:32:39 INFO  Executing generated plans
2022-09-25 02:35:10 INFO  ---RUNTIME: Execution took 151295.47309875488 ms
2022-09-25 02:35:10 INFO  Done!
2022-09-25 02:35:10 INFO  # Finished -- repetition 3 of 7 
2022-09-25 02:35:10 INFO  # Optimization benchmark for data_corruption with args [['reviews', 'slow_loading', 'featurization_1', 'logistic_regression']] -- repetition 4 of 7
2022-09-25 02:35:10 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-25 02:35:10 INFO  Running instrumented original pipeline...
2022-09-25 02:35:10 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-25 02:35:10 INFO  ---RUNTIME: Importing and monkey-patching took 207.92150497436523 ms
2022-09-25 02:35:16 INFO  ---RUNTIME: Original pipeline execution took 5892.091512680054 ms (excluding imports and monkey-patching)
2022-09-25 02:35:16 INFO  Starting execution of 1 what-if analyses...
2022-09-25 02:35:16 INFO  Start plan generation for analysis DataCorruption...
2022-09-25 02:35:16 INFO  ---RUNTIME: Plan generation took 0.4661083221435547 ms
2022-09-25 02:35:16 INFO  Estimated runtime of original DAG is 5588.998794555664ms
2022-09-25 02:35:16 INFO  Performing Multi-Query Optimization
2022-09-25 02:35:16 INFO  Estimated unoptimized what-if runtime is 139724.9698638916ms
2022-09-25 02:35:16 INFO  Estimated optimised what-if runtime is 12989.58683013916ms
2022-09-25 02:35:16 INFO  Estimated optimisation runtime saving is 126735.38303375244ms
2022-09-25 02:35:16 INFO  ---RUNTIME: Multi-Query Optimization took 76.53379440307617 ms
2022-09-25 02:35:16 INFO  Executing generated plans
2022-09-25 02:35:33 INFO  ---RUNTIME: Execution took 17354.3918132782 ms
2022-09-25 02:35:33 INFO  Done!
2022-09-25 02:35:34 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-25 02:35:34 INFO  Running instrumented original pipeline...
2022-09-25 02:35:34 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-25 02:35:34 INFO  ---RUNTIME: Importing and monkey-patching took 6.096839904785156 ms
2022-09-25 02:35:40 INFO  ---RUNTIME: Original pipeline execution took 6012.414455413818 ms (excluding imports and monkey-patching)
2022-09-25 02:35:40 INFO  Starting execution of 1 what-if analyses...
2022-09-25 02:35:40 INFO  Start plan generation for analysis DataCorruption...
2022-09-25 02:35:40 INFO  ---RUNTIME: Plan generation took 0.4420280456542969 ms
2022-09-25 02:35:40 INFO  Estimated runtime of original DAG is 5688.027620315552ms
2022-09-25 02:35:40 WARNING Skipping Multi-Query Optimization (instead, only applying patches)
2022-09-25 02:35:40 INFO  Estimated unoptimised what-if runtime is 142200.6905078888ms
2022-09-25 02:35:40 INFO  ---RUNTIME: Multi-Query Optimization took 42.855262756347656 ms
2022-09-25 02:35:40 INFO  Executing generated plans
2022-09-25 02:38:12 INFO  ---RUNTIME: Execution took 152618.44110488892 ms
2022-09-25 02:38:12 INFO  Done!
2022-09-25 02:38:12 INFO  # Finished -- repetition 4 of 7 
2022-09-25 02:38:12 INFO  # Optimization benchmark for data_corruption with args [['reviews', 'slow_loading', 'featurization_1', 'logistic_regression']] -- repetition 5 of 7
2022-09-25 02:38:12 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-25 02:38:12 INFO  Running instrumented original pipeline...
2022-09-25 02:38:12 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-25 02:38:12 INFO  ---RUNTIME: Importing and monkey-patching took 6.553173065185547 ms
2022-09-25 02:38:18 INFO  ---RUNTIME: Original pipeline execution took 5726.080656051636 ms (excluding imports and monkey-patching)
2022-09-25 02:38:18 INFO  Starting execution of 1 what-if analyses...
2022-09-25 02:38:18 INFO  Start plan generation for analysis DataCorruption...
2022-09-25 02:38:18 INFO  ---RUNTIME: Plan generation took 0.4756450653076172 ms
2022-09-25 02:38:18 INFO  Estimated runtime of original DAG is 5428.032875061035ms
2022-09-25 02:38:18 INFO  Performing Multi-Query Optimization
2022-09-25 02:38:18 INFO  Estimated unoptimized what-if runtime is 135700.82187652588ms
2022-09-25 02:38:18 INFO  Estimated optimised what-if runtime is 12255.068063735962ms
2022-09-25 02:38:18 INFO  Estimated optimisation runtime saving is 123445.75381278992ms
2022-09-25 02:38:18 INFO  ---RUNTIME: Multi-Query Optimization took 63.7364387512207 ms
2022-09-25 02:38:18 INFO  Executing generated plans
2022-09-25 02:38:36 INFO  ---RUNTIME: Execution took 17505.75876235962 ms
2022-09-25 02:38:36 INFO  Done!
2022-09-25 02:38:36 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-25 02:38:36 INFO  Running instrumented original pipeline...
2022-09-25 02:38:36 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-25 02:38:36 INFO  ---RUNTIME: Importing and monkey-patching took 6.158113479614258 ms
2022-09-25 02:38:41 INFO  ---RUNTIME: Original pipeline execution took 5851.978778839111 ms (excluding imports and monkey-patching)
2022-09-25 02:38:41 INFO  Starting execution of 1 what-if analyses...
2022-09-25 02:38:41 INFO  Start plan generation for analysis DataCorruption...
2022-09-25 02:38:41 INFO  ---RUNTIME: Plan generation took 0.42724609375 ms
2022-09-25 02:38:41 INFO  Estimated runtime of original DAG is 5552.486896514893ms
2022-09-25 02:38:41 WARNING Skipping Multi-Query Optimization (instead, only applying patches)
2022-09-25 02:38:41 INFO  Estimated unoptimised what-if runtime is 138812.1724128723ms
2022-09-25 02:38:41 INFO  ---RUNTIME: Multi-Query Optimization took 20.985126495361328 ms
2022-09-25 02:38:41 INFO  Executing generated plans
2022-09-25 02:41:12 INFO  ---RUNTIME: Execution took 150686.48600578308 ms
2022-09-25 02:41:12 INFO  Done!
2022-09-25 02:41:12 INFO  # Finished -- repetition 5 of 7 
2022-09-25 02:41:12 INFO  # Optimization benchmark for data_corruption with args [['reviews', 'slow_loading', 'featurization_1', 'logistic_regression']] -- repetition 6 of 7
2022-09-25 02:41:12 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-25 02:41:12 INFO  Running instrumented original pipeline...
2022-09-25 02:41:12 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-25 02:41:12 INFO  ---RUNTIME: Importing and monkey-patching took 7.570028305053711 ms
2022-09-25 02:41:18 INFO  ---RUNTIME: Original pipeline execution took 5943.855047225952 ms (excluding imports and monkey-patching)
2022-09-25 02:41:18 INFO  Starting execution of 1 what-if analyses...
2022-09-25 02:41:18 INFO  Start plan generation for analysis DataCorruption...
2022-09-25 02:41:18 INFO  ---RUNTIME: Plan generation took 0.5114078521728516 ms
2022-09-25 02:41:18 INFO  Estimated runtime of original DAG is 5634.505271911621ms
2022-09-25 02:41:18 INFO  Performing Multi-Query Optimization
2022-09-25 02:41:18 INFO  Estimated unoptimized what-if runtime is 140862.63179779053ms
2022-09-25 02:41:18 INFO  Estimated optimised what-if runtime is 12689.101934432983ms
2022-09-25 02:41:18 INFO  Estimated optimisation runtime saving is 128173.52986335754ms
2022-09-25 02:41:18 INFO  ---RUNTIME: Multi-Query Optimization took 62.627553939819336 ms
2022-09-25 02:41:18 INFO  Executing generated plans
2022-09-25 02:41:36 INFO  ---RUNTIME: Execution took 17776.023387908936 ms
2022-09-25 02:41:36 INFO  Done!
2022-09-25 02:41:36 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-25 02:41:36 INFO  Running instrumented original pipeline...
2022-09-25 02:41:36 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-25 02:41:36 INFO  ---RUNTIME: Importing and monkey-patching took 6.877422332763672 ms
2022-09-25 02:41:42 INFO  ---RUNTIME: Original pipeline execution took 6026.7298221588135 ms (excluding imports and monkey-patching)
2022-09-25 02:41:42 INFO  Starting execution of 1 what-if analyses...
2022-09-25 02:41:42 INFO  Start plan generation for analysis DataCorruption...
2022-09-25 02:41:42 INFO  ---RUNTIME: Plan generation took 0.4127025604248047 ms
2022-09-25 02:41:42 INFO  Estimated runtime of original DAG is 5705.411672592163ms
2022-09-25 02:41:42 WARNING Skipping Multi-Query Optimization (instead, only applying patches)
2022-09-25 02:41:42 INFO  Estimated unoptimised what-if runtime is 142635.29181480408ms
2022-09-25 02:41:42 INFO  ---RUNTIME: Multi-Query Optimization took 21.527528762817383 ms
2022-09-25 02:41:42 INFO  Executing generated plans
2022-09-25 02:44:13 INFO  ---RUNTIME: Execution took 151349.10655021667 ms
2022-09-25 02:44:13 INFO  Done!
2022-09-25 02:44:13 INFO  # Finished -- repetition 6 of 7 
2022-09-25 02:44:13 INFO  # Optimization benchmark for data_corruption with args [['reviews', 'slow_loading', 'featurization_1', 'logistic_regression']] -- repetition 7 of 7
2022-09-25 02:44:13 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-25 02:44:13 INFO  Running instrumented original pipeline...
2022-09-25 02:44:13 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-25 02:44:13 INFO  ---RUNTIME: Importing and monkey-patching took 6.625890731811523 ms
2022-09-25 02:44:19 INFO  ---RUNTIME: Original pipeline execution took 6075.472593307495 ms (excluding imports and monkey-patching)
2022-09-25 02:44:19 INFO  Starting execution of 1 what-if analyses...
2022-09-25 02:44:19 INFO  Start plan generation for analysis DataCorruption...
2022-09-25 02:44:19 INFO  ---RUNTIME: Plan generation took 0.45943260192871094 ms
2022-09-25 02:44:19 INFO  Estimated runtime of original DAG is 5761.073589324951ms
2022-09-25 02:44:19 INFO  Performing Multi-Query Optimization
2022-09-25 02:44:20 INFO  Estimated unoptimized what-if runtime is 144026.83973312378ms
2022-09-25 02:44:20 INFO  Estimated optimised what-if runtime is 13004.680395126343ms
2022-09-25 02:44:20 INFO  Estimated optimisation runtime saving is 131022.15933799744ms
2022-09-25 02:44:20 INFO  ---RUNTIME: Multi-Query Optimization took 321.911096572876 ms
2022-09-25 02:44:20 INFO  Executing generated plans
2022-09-25 02:44:37 INFO  ---RUNTIME: Execution took 17626.32989883423 ms
2022-09-25 02:44:37 INFO  Done!
2022-09-25 02:44:37 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-25 02:44:37 INFO  Running instrumented original pipeline...
2022-09-25 02:44:37 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-25 02:44:37 INFO  ---RUNTIME: Importing and monkey-patching took 5.960941314697266 ms
2022-09-25 02:44:43 INFO  ---RUNTIME: Original pipeline execution took 5694.552898406982 ms (excluding imports and monkey-patching)
2022-09-25 02:44:43 INFO  Starting execution of 1 what-if analyses...
2022-09-25 02:44:43 INFO  Start plan generation for analysis DataCorruption...
2022-09-25 02:44:43 INFO  ---RUNTIME: Plan generation took 0.4966259002685547 ms
2022-09-25 02:44:43 INFO  Estimated runtime of original DAG is 5397.690296173096ms
2022-09-25 02:44:43 WARNING Skipping Multi-Query Optimization (instead, only applying patches)
2022-09-25 02:44:43 INFO  Estimated unoptimised what-if runtime is 134942.2574043274ms
2022-09-25 02:44:43 INFO  ---RUNTIME: Multi-Query Optimization took 19.56653594970703 ms
2022-09-25 02:44:43 INFO  Executing generated plans
2022-09-25 02:47:14 INFO  ---RUNTIME: Execution took 151309.68236923218 ms
2022-09-25 02:47:14 INFO  Done!
2022-09-25 02:47:14 INFO  # Finished -- repetition 7 of 7 
2022-09-25 02:47:14 INFO  # Final results after all repetitions
2022-09-25 02:47:14 INFO     repetition  ... no_opt_what_if_execution_combined_model_training
0           0  ...                                      3293.135166
1           1  ...                                      3434.517860
2           2  ...                                      3435.395002
3           3  ...                                      3418.539047
4           4  ...                                      3368.351936
5           5  ...                                      3392.236948
6           6  ...                                      3445.277691

[7 rows x 26 columns]
PROTOCOL_BUFFERS_PYTHON_IMPLEMENTATION=python taskset -c 32-39 python3.9 benchmarks_end_to_end.py data_corruption reviews slow_loading featurization_1 xgboost
2022-09-25 02:47:17.277178: W tensorflow/stream_executor/platform/default/dso_loader.cc:64] Could not load dynamic library 'libcudart.so.11.0'; dlerror: libcudart.so.11.0: cannot open shared object file: No such file or directory; LD_LIBRARY_PATH: /home/sgrafbe/mlwhatif/venv/lib/python3.9/site-packages/cv2/../../lib64:
2022-09-25 02:47:17.277216: I tensorflow/stream_executor/cuda/cudart_stub.cc:29] Ignore above cudart dlerror if you do not have a GPU set up on your machine.
2022-09-25 02:47:18 INFO  Patching sys.argv with ['mlwhatif', 'reviews', 'slow_loading', 'featurization_1', 'xgboost']
2022-09-25 02:47:18 INFO  Running instrumented original pipeline...
2022-09-25 02:47:18 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-25 02:47:18 INFO  ---RUNTIME: Importing and monkey-patching took 105.36766052246094 ms
2022-09-25 02:47:27 INFO  ---RUNTIME: Original pipeline execution took 9005.517959594727 ms (excluding imports and monkey-patching)
2022-09-25 02:47:27 INFO  Starting execution of 0 what-if analyses...
2022-09-25 02:47:27 INFO  Estimated runtime of original DAG is 8663.408994674683ms
2022-09-25 02:47:27 INFO  Performing Multi-Query Optimization
2022-09-25 02:47:27 INFO  Estimated unoptimized what-if runtime is 0ms
2022-09-25 02:47:27 INFO  Estimated optimised what-if runtime is 0ms
2022-09-25 02:47:27 INFO  Estimated optimisation runtime saving is 0ms
2022-09-25 02:47:27 INFO  ---RUNTIME: Multi-Query Optimization took 0.5762577056884766 ms
2022-09-25 02:47:27 INFO  Executing generated plans
2022-09-25 02:47:27 INFO  ---RUNTIME: Execution took 0.027418136596679688 ms
2022-09-25 02:47:27 INFO  Done!
2022-09-25 02:47:27 INFO  # Optimization benchmark for data_corruption with args [['reviews', 'slow_loading', 'featurization_1', 'xgboost']] -- repetition 1 of 7
2022-09-25 02:47:27 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-25 02:47:27 INFO  Running instrumented original pipeline...
2022-09-25 02:47:27 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-25 02:47:27 INFO  ---RUNTIME: Importing and monkey-patching took 6.652116775512695 ms
2022-09-25 02:47:36 INFO  ---RUNTIME: Original pipeline execution took 8812.690734863281 ms (excluding imports and monkey-patching)
2022-09-25 02:47:36 INFO  Starting execution of 1 what-if analyses...
2022-09-25 02:47:36 INFO  Start plan generation for analysis DataCorruption...
2022-09-25 02:47:36 INFO  ---RUNTIME: Plan generation took 0.46563148498535156 ms
2022-09-25 02:47:36 INFO  Estimated runtime of original DAG is 8502.83145904541ms
2022-09-25 02:47:36 INFO  Performing Multi-Query Optimization
2022-09-25 02:47:36 INFO  Estimated unoptimized what-if runtime is 212570.78647613525ms
2022-09-25 02:47:36 INFO  Estimated optimised what-if runtime is 22735.697269439697ms
2022-09-25 02:47:36 INFO  Estimated optimisation runtime saving is 189835.08920669556ms
2022-09-25 02:47:36 INFO  ---RUNTIME: Multi-Query Optimization took 62.899112701416016 ms
2022-09-25 02:47:36 INFO  Executing generated plans
2022-09-25 02:48:04 INFO  ---RUNTIME: Execution took 27972.784996032715 ms
2022-09-25 02:48:04 INFO  Done!
2022-09-25 02:48:04 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-25 02:48:04 INFO  Running instrumented original pipeline...
2022-09-25 02:48:04 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-25 02:48:04 INFO  ---RUNTIME: Importing and monkey-patching took 6.743907928466797 ms
2022-09-25 02:48:13 INFO  ---RUNTIME: Original pipeline execution took 8589.50662612915 ms (excluding imports and monkey-patching)
2022-09-25 02:48:13 INFO  Starting execution of 1 what-if analyses...
2022-09-25 02:48:13 INFO  Start plan generation for analysis DataCorruption...
2022-09-25 02:48:13 INFO  ---RUNTIME: Plan generation took 0.45108795166015625 ms
2022-09-25 02:48:13 INFO  Estimated runtime of original DAG is 8120.860815048218ms
2022-09-25 02:48:13 WARNING Skipping Multi-Query Optimization (instead, only applying patches)
2022-09-25 02:48:13 INFO  Estimated unoptimised what-if runtime is 203021.52037620544ms
2022-09-25 02:48:13 INFO  ---RUNTIME: Multi-Query Optimization took 19.202709197998047 ms
2022-09-25 02:48:13 INFO  Executing generated plans
2022-09-25 02:51:54 INFO  ---RUNTIME: Execution took 221655.44033050537 ms
2022-09-25 02:51:54 INFO  Done!
2022-09-25 02:51:54 INFO  # Finished -- repetition 1 of 7 
2022-09-25 02:51:54 INFO  # Optimization benchmark for data_corruption with args [['reviews', 'slow_loading', 'featurization_1', 'xgboost']] -- repetition 2 of 7
2022-09-25 02:51:54 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-25 02:51:54 INFO  Running instrumented original pipeline...
2022-09-25 02:51:54 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-25 02:51:54 INFO  ---RUNTIME: Importing and monkey-patching took 6.618738174438477 ms
2022-09-25 02:52:03 INFO  ---RUNTIME: Original pipeline execution took 8894.726753234863 ms (excluding imports and monkey-patching)
2022-09-25 02:52:03 INFO  Starting execution of 1 what-if analyses...
2022-09-25 02:52:03 INFO  Start plan generation for analysis DataCorruption...
2022-09-25 02:52:03 INFO  ---RUNTIME: Plan generation took 0.4489421844482422 ms
2022-09-25 02:52:03 INFO  Estimated runtime of original DAG is 8600.647687911987ms
2022-09-25 02:52:03 INFO  Performing Multi-Query Optimization
2022-09-25 02:52:03 INFO  Estimated unoptimized what-if runtime is 215016.19219779968ms
2022-09-25 02:52:03 INFO  Estimated optimised what-if runtime is 22479.28261756897ms
2022-09-25 02:52:03 INFO  Estimated optimisation runtime saving is 192536.9095802307ms
2022-09-25 02:52:03 INFO  ---RUNTIME: Multi-Query Optimization took 62.88552284240723 ms
2022-09-25 02:52:03 INFO  Executing generated plans
2022-09-25 02:52:30 INFO  ---RUNTIME: Execution took 26970.43204307556 ms
2022-09-25 02:52:30 INFO  Done!
2022-09-25 02:52:30 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-25 02:52:30 INFO  Running instrumented original pipeline...
2022-09-25 02:52:30 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-25 02:52:30 INFO  ---RUNTIME: Importing and monkey-patching took 6.592512130737305 ms
2022-09-25 02:52:39 INFO  ---RUNTIME: Original pipeline execution took 8463.791847229004 ms (excluding imports and monkey-patching)
2022-09-25 02:52:39 INFO  Starting execution of 1 what-if analyses...
2022-09-25 02:52:39 INFO  Start plan generation for analysis DataCorruption...
2022-09-25 02:52:39 INFO  ---RUNTIME: Plan generation took 1.4119148254394531 ms
2022-09-25 02:52:39 INFO  Estimated runtime of original DAG is 8171.242713928223ms
2022-09-25 02:52:39 WARNING Skipping Multi-Query Optimization (instead, only applying patches)
2022-09-25 02:52:39 INFO  Estimated unoptimised what-if runtime is 204281.06784820557ms
2022-09-25 02:52:39 INFO  ---RUNTIME: Multi-Query Optimization took 18.55945587158203 ms
2022-09-25 02:52:39 INFO  Executing generated plans
2022-09-25 02:56:22 INFO  ---RUNTIME: Execution took 223441.04099273682 ms
2022-09-25 02:56:22 INFO  Done!
2022-09-25 02:56:22 INFO  # Finished -- repetition 2 of 7 
2022-09-25 02:56:22 INFO  # Optimization benchmark for data_corruption with args [['reviews', 'slow_loading', 'featurization_1', 'xgboost']] -- repetition 3 of 7
2022-09-25 02:56:22 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-25 02:56:22 INFO  Running instrumented original pipeline...
2022-09-25 02:56:22 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-25 02:56:22 INFO  ---RUNTIME: Importing and monkey-patching took 7.009029388427734 ms
2022-09-25 02:56:31 INFO  ---RUNTIME: Original pipeline execution took 8426.358938217163 ms (excluding imports and monkey-patching)
2022-09-25 02:56:31 INFO  Starting execution of 1 what-if analyses...
2022-09-25 02:56:31 INFO  Start plan generation for analysis DataCorruption...
2022-09-25 02:56:31 INFO  ---RUNTIME: Plan generation took 0.47135353088378906 ms
2022-09-25 02:56:31 INFO  Estimated runtime of original DAG is 8134.066581726074ms
2022-09-25 02:56:31 INFO  Performing Multi-Query Optimization
2022-09-25 02:56:31 INFO  Estimated unoptimized what-if runtime is 203351.66454315186ms
2022-09-25 02:56:31 INFO  Estimated optimised what-if runtime is 22389.53423500061ms
2022-09-25 02:56:31 INFO  Estimated optimisation runtime saving is 180962.13030815125ms
2022-09-25 02:56:31 INFO  ---RUNTIME: Multi-Query Optimization took 69.8249340057373 ms
2022-09-25 02:56:31 INFO  Executing generated plans
2022-09-25 02:56:59 INFO  ---RUNTIME: Execution took 27787.567853927612 ms
2022-09-25 02:56:59 INFO  Done!
2022-09-25 02:56:59 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-25 02:56:59 INFO  Running instrumented original pipeline...
2022-09-25 02:56:59 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-25 02:56:59 INFO  ---RUNTIME: Importing and monkey-patching took 6.40416145324707 ms
2022-09-25 02:57:07 INFO  ---RUNTIME: Original pipeline execution took 8482.712268829346 ms (excluding imports and monkey-patching)
2022-09-25 02:57:07 INFO  Starting execution of 1 what-if analyses...
2022-09-25 02:57:07 INFO  Start plan generation for analysis DataCorruption...
2022-09-25 02:57:07 INFO  ---RUNTIME: Plan generation took 0.46825408935546875 ms
2022-09-25 02:57:07 INFO  Estimated runtime of original DAG is 8188.48729133606ms
2022-09-25 02:57:07 WARNING Skipping Multi-Query Optimization (instead, only applying patches)
2022-09-25 02:57:07 INFO  Estimated unoptimised what-if runtime is 204712.1822834015ms
2022-09-25 02:57:07 INFO  ---RUNTIME: Multi-Query Optimization took 20.601272583007812 ms
2022-09-25 02:57:07 INFO  Executing generated plans
2022-09-25 03:00:47 INFO  ---RUNTIME: Execution took 219867.7442073822 ms
2022-09-25 03:00:47 INFO  Done!
2022-09-25 03:00:47 INFO  # Finished -- repetition 3 of 7 
2022-09-25 03:00:47 INFO  # Optimization benchmark for data_corruption with args [['reviews', 'slow_loading', 'featurization_1', 'xgboost']] -- repetition 4 of 7
2022-09-25 03:00:47 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-25 03:00:47 INFO  Running instrumented original pipeline...
2022-09-25 03:00:47 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-25 03:00:47 INFO  ---RUNTIME: Importing and monkey-patching took 6.1092376708984375 ms
2022-09-25 03:00:56 INFO  ---RUNTIME: Original pipeline execution took 8643.816232681274 ms (excluding imports and monkey-patching)
2022-09-25 03:00:56 INFO  Starting execution of 1 what-if analyses...
2022-09-25 03:00:56 INFO  Start plan generation for analysis DataCorruption...
2022-09-25 03:00:56 INFO  ---RUNTIME: Plan generation took 0.37980079650878906 ms
2022-09-25 03:00:56 INFO  Estimated runtime of original DAG is 8138.326644897461ms
2022-09-25 03:00:56 INFO  Performing Multi-Query Optimization
2022-09-25 03:00:56 INFO  Estimated unoptimized what-if runtime is 203458.16612243652ms
2022-09-25 03:00:56 INFO  Estimated optimised what-if runtime is 22189.953565597534ms
2022-09-25 03:00:56 INFO  Estimated optimisation runtime saving is 181268.212556839ms
2022-09-25 03:00:56 INFO  ---RUNTIME: Multi-Query Optimization took 62.22724914550781 ms
2022-09-25 03:00:56 INFO  Executing generated plans
2022-09-25 03:01:23 INFO  ---RUNTIME: Execution took 27074.536085128784 ms
2022-09-25 03:01:23 INFO  Done!
2022-09-25 03:01:23 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-25 03:01:23 INFO  Running instrumented original pipeline...
2022-09-25 03:01:23 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-25 03:01:23 INFO  ---RUNTIME: Importing and monkey-patching took 6.62684440612793 ms
2022-09-25 03:01:31 INFO  ---RUNTIME: Original pipeline execution took 8410.39752960205 ms (excluding imports and monkey-patching)
2022-09-25 03:01:31 INFO  Starting execution of 1 what-if analyses...
2022-09-25 03:01:31 INFO  Start plan generation for analysis DataCorruption...
2022-09-25 03:01:31 INFO  ---RUNTIME: Plan generation took 0.44465065002441406 ms
2022-09-25 03:01:31 INFO  Estimated runtime of original DAG is 8115.736484527588ms
2022-09-25 03:01:31 WARNING Skipping Multi-Query Optimization (instead, only applying patches)
2022-09-25 03:01:31 INFO  Estimated unoptimised what-if runtime is 202893.4121131897ms
2022-09-25 03:01:31 INFO  ---RUNTIME: Multi-Query Optimization took 18.815994262695312 ms
2022-09-25 03:01:31 INFO  Executing generated plans
2022-09-25 03:05:09 INFO  ---RUNTIME: Execution took 217820.28913497925 ms
2022-09-25 03:05:09 INFO  Done!
2022-09-25 03:05:09 INFO  # Finished -- repetition 4 of 7 
2022-09-25 03:05:09 INFO  # Optimization benchmark for data_corruption with args [['reviews', 'slow_loading', 'featurization_1', 'xgboost']] -- repetition 5 of 7
2022-09-25 03:05:09 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-25 03:05:09 INFO  Running instrumented original pipeline...
2022-09-25 03:05:09 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-25 03:05:09 INFO  ---RUNTIME: Importing and monkey-patching took 6.488323211669922 ms
2022-09-25 03:05:18 INFO  ---RUNTIME: Original pipeline execution took 9068.415403366089 ms (excluding imports and monkey-patching)
2022-09-25 03:05:18 INFO  Starting execution of 1 what-if analyses...
2022-09-25 03:05:18 INFO  Start plan generation for analysis DataCorruption...
2022-09-25 03:05:18 INFO  ---RUNTIME: Plan generation took 0.4298686981201172 ms
2022-09-25 03:05:18 INFO  Estimated runtime of original DAG is 8775.533676147461ms
2022-09-25 03:05:18 INFO  Performing Multi-Query Optimization
2022-09-25 03:05:18 INFO  Estimated unoptimized what-if runtime is 219388.34190368652ms
2022-09-25 03:05:18 INFO  Estimated optimised what-if runtime is 22531.429290771484ms
2022-09-25 03:05:18 INFO  Estimated optimisation runtime saving is 196856.91261291504ms
2022-09-25 03:05:18 INFO  ---RUNTIME: Multi-Query Optimization took 63.01116943359375 ms
2022-09-25 03:05:18 INFO  Executing generated plans
2022-09-25 03:05:45 INFO  ---RUNTIME: Execution took 27087.324857711792 ms
2022-09-25 03:05:45 INFO  Done!
2022-09-25 03:05:45 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-25 03:05:45 INFO  Running instrumented original pipeline...
2022-09-25 03:05:45 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-25 03:05:45 INFO  ---RUNTIME: Importing and monkey-patching took 6.621837615966797 ms
2022-09-25 03:05:54 INFO  ---RUNTIME: Original pipeline execution took 8385.361909866333 ms (excluding imports and monkey-patching)
2022-09-25 03:05:54 INFO  Starting execution of 1 what-if analyses...
2022-09-25 03:05:54 INFO  Start plan generation for analysis DataCorruption...
2022-09-25 03:05:54 INFO  ---RUNTIME: Plan generation took 0.42891502380371094 ms
2022-09-25 03:05:54 INFO  Estimated runtime of original DAG is 8094.436168670654ms
2022-09-25 03:05:54 WARNING Skipping Multi-Query Optimization (instead, only applying patches)
2022-09-25 03:05:54 INFO  Estimated unoptimised what-if runtime is 202360.90421676636ms
2022-09-25 03:05:54 INFO  ---RUNTIME: Multi-Query Optimization took 19.417524337768555 ms
2022-09-25 03:05:54 INFO  Executing generated plans
2022-09-25 03:09:31 INFO  ---RUNTIME: Execution took 217532.17601776123 ms
2022-09-25 03:09:31 INFO  Done!
2022-09-25 03:09:31 INFO  # Finished -- repetition 5 of 7 
2022-09-25 03:09:31 INFO  # Optimization benchmark for data_corruption with args [['reviews', 'slow_loading', 'featurization_1', 'xgboost']] -- repetition 6 of 7
2022-09-25 03:09:31 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-25 03:09:31 INFO  Running instrumented original pipeline...
2022-09-25 03:09:31 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-25 03:09:31 INFO  ---RUNTIME: Importing and monkey-patching took 6.369829177856445 ms
2022-09-25 03:09:40 INFO  ---RUNTIME: Original pipeline execution took 8434.237957000732 ms (excluding imports and monkey-patching)
2022-09-25 03:09:40 INFO  Starting execution of 1 what-if analyses...
2022-09-25 03:09:40 INFO  Start plan generation for analysis DataCorruption...
2022-09-25 03:09:40 INFO  ---RUNTIME: Plan generation took 0.42438507080078125 ms
2022-09-25 03:09:40 INFO  Estimated runtime of original DAG is 8146.187543869019ms
2022-09-25 03:09:40 INFO  Performing Multi-Query Optimization
2022-09-25 03:09:40 INFO  Estimated unoptimized what-if runtime is 203654.68859672546ms
2022-09-25 03:09:40 INFO  Estimated optimised what-if runtime is 21945.738792419434ms
2022-09-25 03:09:40 INFO  Estimated optimisation runtime saving is 181708.94980430603ms
2022-09-25 03:09:40 INFO  ---RUNTIME: Multi-Query Optimization took 61.12337112426758 ms
2022-09-25 03:09:40 INFO  Executing generated plans
2022-09-25 03:10:07 INFO  ---RUNTIME: Execution took 26942.89541244507 ms
2022-09-25 03:10:07 INFO  Done!
2022-09-25 03:10:07 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-25 03:10:07 INFO  Running instrumented original pipeline...
2022-09-25 03:10:07 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-25 03:10:07 INFO  ---RUNTIME: Importing and monkey-patching took 6.321907043457031 ms
2022-09-25 03:10:15 INFO  ---RUNTIME: Original pipeline execution took 8386.5807056427 ms (excluding imports and monkey-patching)
2022-09-25 03:10:15 INFO  Starting execution of 1 what-if analyses...
2022-09-25 03:10:15 INFO  Start plan generation for analysis DataCorruption...
2022-09-25 03:10:15 INFO  ---RUNTIME: Plan generation took 0.43845176696777344 ms
2022-09-25 03:10:15 INFO  Estimated runtime of original DAG is 8095.27325630188ms
2022-09-25 03:10:15 WARNING Skipping Multi-Query Optimization (instead, only applying patches)
2022-09-25 03:10:15 INFO  Estimated unoptimised what-if runtime is 202381.831407547ms
2022-09-25 03:10:15 INFO  ---RUNTIME: Multi-Query Optimization took 18.623828887939453 ms
2022-09-25 03:10:15 INFO  Executing generated plans
2022-09-25 03:13:53 INFO  ---RUNTIME: Execution took 217720.6633090973 ms
2022-09-25 03:13:53 INFO  Done!
2022-09-25 03:13:53 INFO  # Finished -- repetition 6 of 7 
2022-09-25 03:13:53 INFO  # Optimization benchmark for data_corruption with args [['reviews', 'slow_loading', 'featurization_1', 'xgboost']] -- repetition 7 of 7
2022-09-25 03:13:53 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-25 03:13:53 INFO  Running instrumented original pipeline...
2022-09-25 03:13:53 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-25 03:13:53 INFO  ---RUNTIME: Importing and monkey-patching took 6.098031997680664 ms
2022-09-25 03:14:01 INFO  ---RUNTIME: Original pipeline execution took 8537.237167358398 ms (excluding imports and monkey-patching)
2022-09-25 03:14:01 INFO  Starting execution of 1 what-if analyses...
2022-09-25 03:14:01 INFO  Start plan generation for analysis DataCorruption...
2022-09-25 03:14:01 INFO  ---RUNTIME: Plan generation took 0.3857612609863281 ms
2022-09-25 03:14:01 INFO  Estimated runtime of original DAG is 8030.929803848267ms
2022-09-25 03:14:01 INFO  Performing Multi-Query Optimization
2022-09-25 03:14:01 INFO  Estimated unoptimized what-if runtime is 200773.24509620667ms
2022-09-25 03:14:01 INFO  Estimated optimised what-if runtime is 21787.566900253296ms
2022-09-25 03:14:01 INFO  Estimated optimisation runtime saving is 178985.67819595337ms
2022-09-25 03:14:01 INFO  ---RUNTIME: Multi-Query Optimization took 61.537742614746094 ms
2022-09-25 03:14:01 INFO  Executing generated plans
2022-09-25 03:14:28 INFO  ---RUNTIME: Execution took 26837.576389312744 ms
2022-09-25 03:14:28 INFO  Done!
2022-09-25 03:14:28 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-25 03:14:28 INFO  Running instrumented original pipeline...
2022-09-25 03:14:28 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-25 03:14:28 INFO  ---RUNTIME: Importing and monkey-patching took 6.104230880737305 ms
2022-09-25 03:14:37 INFO  ---RUNTIME: Original pipeline execution took 8328.71675491333 ms (excluding imports and monkey-patching)
2022-09-25 03:14:37 INFO  Starting execution of 1 what-if analyses...
2022-09-25 03:14:37 INFO  Start plan generation for analysis DataCorruption...
2022-09-25 03:14:37 INFO  ---RUNTIME: Plan generation took 1.402139663696289 ms
2022-09-25 03:14:37 INFO  Estimated runtime of original DAG is 8037.829875946045ms
2022-09-25 03:14:37 WARNING Skipping Multi-Query Optimization (instead, only applying patches)
2022-09-25 03:14:37 INFO  Estimated unoptimised what-if runtime is 200945.74689865112ms
2022-09-25 03:14:37 INFO  ---RUNTIME: Multi-Query Optimization took 18.271923065185547 ms
2022-09-25 03:14:37 INFO  Executing generated plans
2022-09-25 03:18:14 INFO  ---RUNTIME: Execution took 217006.79445266724 ms
2022-09-25 03:18:14 INFO  Done!
2022-09-25 03:18:14 INFO  # Finished -- repetition 7 of 7 
2022-09-25 03:18:14 INFO  # Final results after all repetitions
2022-09-25 03:18:14 INFO     repetition  ... no_opt_what_if_execution_combined_model_training
0           0  ...                                     64635.557652
1           1  ...                                     65158.801317
2           2  ...                                     64036.023855
3           3  ...                                     63528.163910
4           4  ...                                     63582.550049
5           5  ...                                     63309.617043
6           6  ...                                     63440.890789

[7 rows x 26 columns]
PROTOCOL_BUFFERS_PYTHON_IMPLEMENTATION=python taskset -c 32-39 python3.9 benchmarks_end_to_end.py data_corruption reviews slow_loading featurization_1 neural_network
2022-09-25 03:18:16.275587: W tensorflow/stream_executor/platform/default/dso_loader.cc:64] Could not load dynamic library 'libcudart.so.11.0'; dlerror: libcudart.so.11.0: cannot open shared object file: No such file or directory; LD_LIBRARY_PATH: /home/sgrafbe/mlwhatif/venv/lib/python3.9/site-packages/cv2/../../lib64:
2022-09-25 03:18:16.275632: I tensorflow/stream_executor/cuda/cudart_stub.cc:29] Ignore above cudart dlerror if you do not have a GPU set up on your machine.
2022-09-25 03:18:17 INFO  Patching sys.argv with ['mlwhatif', 'reviews', 'slow_loading', 'featurization_1', 'neural_network']
2022-09-25 03:18:17 INFO  Running instrumented original pipeline...
2022-09-25 03:18:17 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-25 03:18:17 INFO  ---RUNTIME: Importing and monkey-patching took 95.71075439453125 ms
2022-09-25 03:18:21.902543: W tensorflow/stream_executor/platform/default/dso_loader.cc:64] Could not load dynamic library 'libcuda.so.1'; dlerror: libcuda.so.1: cannot open shared object file: No such file or directory; LD_LIBRARY_PATH: /home/sgrafbe/mlwhatif/venv/lib/python3.9/site-packages/cv2/../../lib64:
2022-09-25 03:18:21.902577: W tensorflow/stream_executor/cuda/cuda_driver.cc:326] failed call to cuInit: UNKNOWN ERROR (303)
2022-09-25 03:18:21.902601: I tensorflow/stream_executor/cuda/cuda_diagnostics.cc:156] kernel driver does not appear to be running on this host (wagyu): /proc/driver/nvidia/version does not exist
2022-09-25 03:18:21.903111: I tensorflow/core/platform/cpu_feature_guard.cc:142] This TensorFlow binary is optimized with oneAPI Deep Neural Network Library (oneDNN) to use the following CPU instructions in performance-critical operations:  AVX2 FMA
To enable them in other operations, rebuild TensorFlow with the appropriate compiler flags.
2022-09-25 03:18:21.973291: I tensorflow/compiler/mlir/mlir_graph_optimization_pass.cc:176] None of the MLIR Optimization Passes are enabled (registered 2)
2022-09-25 03:18:21.985377: I tensorflow/core/platform/profile_utils/cpu_utils.cc:114] CPU Frequency: 2595290000 Hz
2022-09-25 03:18:27 INFO  ---RUNTIME: Original pipeline execution took 9620.190858840942 ms (excluding imports and monkey-patching)
2022-09-25 03:18:27 INFO  Starting execution of 0 what-if analyses...
2022-09-25 03:18:27 INFO  Estimated runtime of original DAG is 9292.705535888672ms
2022-09-25 03:18:27 INFO  Performing Multi-Query Optimization
2022-09-25 03:18:27 INFO  Estimated unoptimized what-if runtime is 0ms
2022-09-25 03:18:27 INFO  Estimated optimised what-if runtime is 0ms
2022-09-25 03:18:27 INFO  Estimated optimisation runtime saving is 0ms
2022-09-25 03:18:27 INFO  ---RUNTIME: Multi-Query Optimization took 0.4591941833496094 ms
2022-09-25 03:18:27 INFO  Executing generated plans
2022-09-25 03:18:27 INFO  ---RUNTIME: Execution took 0.015974044799804688 ms
2022-09-25 03:18:27 INFO  Done!
2022-09-25 03:18:27 INFO  # Optimization benchmark for data_corruption with args [['reviews', 'slow_loading', 'featurization_1', 'neural_network']] -- repetition 1 of 7
2022-09-25 03:18:27 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-25 03:18:27 INFO  Running instrumented original pipeline...
2022-09-25 03:18:27 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-25 03:18:27 INFO  ---RUNTIME: Importing and monkey-patching took 5.603551864624023 ms
2022-09-25 03:18:36 INFO  ---RUNTIME: Original pipeline execution took 9130.301237106323 ms (excluding imports and monkey-patching)
2022-09-25 03:18:36 INFO  Starting execution of 1 what-if analyses...
2022-09-25 03:18:36 INFO  Start plan generation for analysis DataCorruption...
2022-09-25 03:18:36 INFO  ---RUNTIME: Plan generation took 0.41604042053222656 ms
2022-09-25 03:18:36 INFO  Estimated runtime of original DAG is 8836.260080337524ms
2022-09-25 03:18:36 INFO  Performing Multi-Query Optimization
2022-09-25 03:18:36 INFO  Estimated unoptimized what-if runtime is 220906.5020084381ms
2022-09-25 03:18:36 INFO  Estimated optimised what-if runtime is 25600.472927093506ms
2022-09-25 03:18:36 INFO  Estimated optimisation runtime saving is 195306.0290813446ms
2022-09-25 03:18:36 INFO  ---RUNTIME: Multi-Query Optimization took 63.25650215148926 ms
2022-09-25 03:18:36 INFO  Executing generated plans
2022-09-25 03:19:06 INFO  ---RUNTIME: Execution took 29719.60759162903 ms
2022-09-25 03:19:06 INFO  Done!
2022-09-25 03:19:06 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-25 03:19:06 INFO  Running instrumented original pipeline...
2022-09-25 03:19:06 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-25 03:19:06 INFO  ---RUNTIME: Importing and monkey-patching took 7.061481475830078 ms
2022-09-25 03:19:15 INFO  ---RUNTIME: Original pipeline execution took 9194.141387939453 ms (excluding imports and monkey-patching)
2022-09-25 03:19:15 INFO  Starting execution of 1 what-if analyses...
2022-09-25 03:19:15 INFO  Start plan generation for analysis DataCorruption...
2022-09-25 03:19:15 INFO  ---RUNTIME: Plan generation took 0.46443939208984375 ms
2022-09-25 03:19:15 INFO  Estimated runtime of original DAG is 8891.714811325073ms
2022-09-25 03:19:15 WARNING Skipping Multi-Query Optimization (instead, only applying patches)
2022-09-25 03:19:15 INFO  Estimated unoptimised what-if runtime is 222292.87028312683ms
2022-09-25 03:19:15 INFO  ---RUNTIME: Multi-Query Optimization took 19.25969123840332 ms
2022-09-25 03:19:15 INFO  Executing generated plans
2022-09-25 03:23:12 INFO  ---RUNTIME: Execution took 237160.05992889404 ms
2022-09-25 03:23:12 INFO  Done!
2022-09-25 03:23:12 INFO  # Finished -- repetition 1 of 7 
2022-09-25 03:23:12 INFO  # Optimization benchmark for data_corruption with args [['reviews', 'slow_loading', 'featurization_1', 'neural_network']] -- repetition 2 of 7
2022-09-25 03:23:12 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-25 03:23:12 INFO  Running instrumented original pipeline...
2022-09-25 03:23:12 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-25 03:23:12 INFO  ---RUNTIME: Importing and monkey-patching took 6.455898284912109 ms
2022-09-25 03:23:21 INFO  ---RUNTIME: Original pipeline execution took 9091.277360916138 ms (excluding imports and monkey-patching)
2022-09-25 03:23:21 INFO  Starting execution of 1 what-if analyses...
2022-09-25 03:23:21 INFO  Start plan generation for analysis DataCorruption...
2022-09-25 03:23:21 INFO  ---RUNTIME: Plan generation took 0.4172325134277344 ms
2022-09-25 03:23:21 INFO  Estimated runtime of original DAG is 8792.280197143555ms
2022-09-25 03:23:21 INFO  Performing Multi-Query Optimization
2022-09-25 03:23:21 INFO  Estimated unoptimized what-if runtime is 219807.00492858887ms
2022-09-25 03:23:21 INFO  Estimated optimised what-if runtime is 24926.287412643433ms
2022-09-25 03:23:21 INFO  Estimated optimisation runtime saving is 194880.71751594543ms
2022-09-25 03:23:21 INFO  ---RUNTIME: Multi-Query Optimization took 63.14373016357422 ms
2022-09-25 03:23:21 INFO  Executing generated plans
2022-09-25 03:23:51 INFO  ---RUNTIME: Execution took 30133.16011428833 ms
2022-09-25 03:23:51 INFO  Done!
2022-09-25 03:23:51 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-25 03:23:51 INFO  Running instrumented original pipeline...
2022-09-25 03:23:51 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-25 03:23:51 INFO  ---RUNTIME: Importing and monkey-patching took 6.145954132080078 ms
2022-09-25 03:24:01 INFO  ---RUNTIME: Original pipeline execution took 9222.423076629639 ms (excluding imports and monkey-patching)
2022-09-25 03:24:01 INFO  Starting execution of 1 what-if analyses...
2022-09-25 03:24:01 INFO  Start plan generation for analysis DataCorruption...
2022-09-25 03:24:01 INFO  ---RUNTIME: Plan generation took 0.5047321319580078 ms
2022-09-25 03:24:01 INFO  Estimated runtime of original DAG is 8919.970512390137ms
2022-09-25 03:24:01 WARNING Skipping Multi-Query Optimization (instead, only applying patches)
2022-09-25 03:24:01 INFO  Estimated unoptimised what-if runtime is 222999.26280975342ms
2022-09-25 03:24:01 INFO  ---RUNTIME: Multi-Query Optimization took 19.12093162536621 ms
2022-09-25 03:24:01 INFO  Executing generated plans
2022-09-25 03:27:59 INFO  ---RUNTIME: Execution took 237966.39466285706 ms
2022-09-25 03:27:59 INFO  Done!
2022-09-25 03:27:59 INFO  # Finished -- repetition 2 of 7 
2022-09-25 03:27:59 INFO  # Optimization benchmark for data_corruption with args [['reviews', 'slow_loading', 'featurization_1', 'neural_network']] -- repetition 3 of 7
2022-09-25 03:27:59 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-25 03:27:59 INFO  Running instrumented original pipeline...
2022-09-25 03:27:59 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-25 03:27:59 INFO  ---RUNTIME: Importing and monkey-patching took 6.416797637939453 ms
2022-09-25 03:28:08 INFO  ---RUNTIME: Original pipeline execution took 9557.548522949219 ms (excluding imports and monkey-patching)
2022-09-25 03:28:08 INFO  Starting execution of 1 what-if analyses...
2022-09-25 03:28:08 INFO  Start plan generation for analysis DataCorruption...
2022-09-25 03:28:08 INFO  ---RUNTIME: Plan generation took 0.4589557647705078 ms
2022-09-25 03:28:08 INFO  Estimated runtime of original DAG is 8845.949172973633ms
2022-09-25 03:28:08 INFO  Performing Multi-Query Optimization
2022-09-25 03:28:08 INFO  Estimated unoptimized what-if runtime is 221148.72932434082ms
2022-09-25 03:28:08 INFO  Estimated optimised what-if runtime is 25820.760250091553ms
2022-09-25 03:28:08 INFO  Estimated optimisation runtime saving is 195327.96907424927ms
2022-09-25 03:28:08 INFO  ---RUNTIME: Multi-Query Optimization took 67.05236434936523 ms
2022-09-25 03:28:08 INFO  Executing generated plans
2022-09-25 03:28:38 INFO  ---RUNTIME: Execution took 29916.167736053467 ms
2022-09-25 03:28:38 INFO  Done!
2022-09-25 03:28:38 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-25 03:28:38 INFO  Running instrumented original pipeline...
2022-09-25 03:28:38 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-25 03:28:38 INFO  ---RUNTIME: Importing and monkey-patching took 6.339073181152344 ms
2022-09-25 03:28:47 INFO  ---RUNTIME: Original pipeline execution took 9177.964210510254 ms (excluding imports and monkey-patching)
2022-09-25 03:28:47 INFO  Starting execution of 1 what-if analyses...
2022-09-25 03:28:47 INFO  Start plan generation for analysis DataCorruption...
2022-09-25 03:28:47 INFO  ---RUNTIME: Plan generation took 2.305746078491211 ms
2022-09-25 03:28:47 INFO  Estimated runtime of original DAG is 8877.599000930786ms
2022-09-25 03:28:47 WARNING Skipping Multi-Query Optimization (instead, only applying patches)
2022-09-25 03:28:47 INFO  Estimated unoptimised what-if runtime is 221939.97502326965ms
2022-09-25 03:28:47 INFO  ---RUNTIME: Multi-Query Optimization took 18.435239791870117 ms
2022-09-25 03:28:47 INFO  Executing generated plans
2022-09-25 03:32:45 INFO  ---RUNTIME: Execution took 238088.9174938202 ms
2022-09-25 03:32:45 INFO  Done!
2022-09-25 03:32:45 INFO  # Finished -- repetition 3 of 7 
2022-09-25 03:32:45 INFO  # Optimization benchmark for data_corruption with args [['reviews', 'slow_loading', 'featurization_1', 'neural_network']] -- repetition 4 of 7
2022-09-25 03:32:45 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-25 03:32:45 INFO  Running instrumented original pipeline...
2022-09-25 03:32:46 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-25 03:32:46 INFO  ---RUNTIME: Importing and monkey-patching took 6.2770843505859375 ms
2022-09-25 03:32:55 INFO  ---RUNTIME: Original pipeline execution took 9151.742458343506 ms (excluding imports and monkey-patching)
2022-09-25 03:32:55 INFO  Starting execution of 1 what-if analyses...
2022-09-25 03:32:55 INFO  Start plan generation for analysis DataCorruption...
2022-09-25 03:32:55 INFO  ---RUNTIME: Plan generation took 0.4227161407470703 ms
2022-09-25 03:32:55 INFO  Estimated runtime of original DAG is 8850.002765655518ms
2022-09-25 03:32:55 INFO  Performing Multi-Query Optimization
2022-09-25 03:32:55 INFO  Estimated unoptimized what-if runtime is 221250.06914138794ms
2022-09-25 03:32:55 INFO  Estimated optimised what-if runtime is 25195.348501205444ms
2022-09-25 03:32:55 INFO  Estimated optimisation runtime saving is 196054.7206401825ms
2022-09-25 03:32:55 INFO  ---RUNTIME: Multi-Query Optimization took 63.227176666259766 ms
2022-09-25 03:32:55 INFO  Executing generated plans
2022-09-25 03:33:25 INFO  ---RUNTIME: Execution took 30030.307054519653 ms
2022-09-25 03:33:25 INFO  Done!
2022-09-25 03:33:25 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-25 03:33:25 INFO  Running instrumented original pipeline...
2022-09-25 03:33:25 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-25 03:33:25 INFO  ---RUNTIME: Importing and monkey-patching took 6.102323532104492 ms
2022-09-25 03:33:34 INFO  ---RUNTIME: Original pipeline execution took 9235.553503036499 ms (excluding imports and monkey-patching)
2022-09-25 03:33:34 INFO  Starting execution of 1 what-if analyses...
2022-09-25 03:33:34 INFO  Start plan generation for analysis DataCorruption...
2022-09-25 03:33:34 INFO  ---RUNTIME: Plan generation took 0.4906654357910156 ms
2022-09-25 03:33:34 INFO  Estimated runtime of original DAG is 8927.046298980713ms
2022-09-25 03:33:34 WARNING Skipping Multi-Query Optimization (instead, only applying patches)
2022-09-25 03:33:34 INFO  Estimated unoptimised what-if runtime is 223176.15747451782ms
2022-09-25 03:33:34 INFO  ---RUNTIME: Multi-Query Optimization took 19.997596740722656 ms
2022-09-25 03:33:34 INFO  Executing generated plans
2022-09-25 03:37:32 INFO  ---RUNTIME: Execution took 237820.7561969757 ms
2022-09-25 03:37:32 INFO  Done!
2022-09-25 03:37:32 INFO  # Finished -- repetition 4 of 7 
2022-09-25 03:37:32 INFO  # Optimization benchmark for data_corruption with args [['reviews', 'slow_loading', 'featurization_1', 'neural_network']] -- repetition 5 of 7
2022-09-25 03:37:32 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-25 03:37:32 INFO  Running instrumented original pipeline...
2022-09-25 03:37:32 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-25 03:37:32 INFO  ---RUNTIME: Importing and monkey-patching took 6.520509719848633 ms
2022-09-25 03:37:41 INFO  ---RUNTIME: Original pipeline execution took 9142.134189605713 ms (excluding imports and monkey-patching)
2022-09-25 03:37:41 INFO  Starting execution of 1 what-if analyses...
2022-09-25 03:37:41 INFO  Start plan generation for analysis DataCorruption...
2022-09-25 03:37:41 INFO  ---RUNTIME: Plan generation took 0.42128562927246094 ms
2022-09-25 03:37:41 INFO  Estimated runtime of original DAG is 8839.135885238647ms
2022-09-25 03:37:41 INFO  Performing Multi-Query Optimization
2022-09-25 03:37:41 INFO  Estimated unoptimized what-if runtime is 220978.3971309662ms
2022-09-25 03:37:41 INFO  Estimated optimised what-if runtime is 25296.99206352234ms
2022-09-25 03:37:41 INFO  Estimated optimisation runtime saving is 195681.40506744385ms
2022-09-25 03:37:41 INFO  ---RUNTIME: Multi-Query Optimization took 62.72625923156738 ms
2022-09-25 03:37:41 INFO  Executing generated plans
2022-09-25 03:38:11 INFO  ---RUNTIME: Execution took 29801.3973236084 ms
2022-09-25 03:38:11 INFO  Done!
2022-09-25 03:38:11 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-25 03:38:11 INFO  Running instrumented original pipeline...
2022-09-25 03:38:11 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-25 03:38:11 INFO  ---RUNTIME: Importing and monkey-patching took 6.087064743041992 ms
2022-09-25 03:38:20 INFO  ---RUNTIME: Original pipeline execution took 9165.767431259155 ms (excluding imports and monkey-patching)
2022-09-25 03:38:20 INFO  Starting execution of 1 what-if analyses...
2022-09-25 03:38:20 INFO  Start plan generation for analysis DataCorruption...
2022-09-25 03:38:20 INFO  ---RUNTIME: Plan generation took 0.4189014434814453 ms
2022-09-25 03:38:20 INFO  Estimated runtime of original DAG is 8862.268209457397ms
2022-09-25 03:38:20 WARNING Skipping Multi-Query Optimization (instead, only applying patches)
2022-09-25 03:38:20 INFO  Estimated unoptimised what-if runtime is 221556.70523643494ms
2022-09-25 03:38:20 INFO  ---RUNTIME: Multi-Query Optimization took 19.103288650512695 ms
2022-09-25 03:38:20 INFO  Executing generated plans
2022-09-25 03:42:16 INFO  ---RUNTIME: Execution took 235698.87614250183 ms
2022-09-25 03:42:16 INFO  Done!
2022-09-25 03:42:16 INFO  # Finished -- repetition 5 of 7 
2022-09-25 03:42:16 INFO  # Optimization benchmark for data_corruption with args [['reviews', 'slow_loading', 'featurization_1', 'neural_network']] -- repetition 6 of 7
2022-09-25 03:42:16 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-25 03:42:16 INFO  Running instrumented original pipeline...
2022-09-25 03:42:16 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-25 03:42:16 INFO  ---RUNTIME: Importing and monkey-patching took 6.118059158325195 ms
2022-09-25 03:42:25 INFO  ---RUNTIME: Original pipeline execution took 9064.952850341797 ms (excluding imports and monkey-patching)
2022-09-25 03:42:25 INFO  Starting execution of 1 what-if analyses...
2022-09-25 03:42:25 INFO  Start plan generation for analysis DataCorruption...
2022-09-25 03:42:25 INFO  ---RUNTIME: Plan generation took 0.4189014434814453 ms
2022-09-25 03:42:25 INFO  Estimated runtime of original DAG is 8767.862796783447ms
2022-09-25 03:42:25 INFO  Performing Multi-Query Optimization
2022-09-25 03:42:25 INFO  Estimated unoptimized what-if runtime is 219196.56991958618ms
2022-09-25 03:42:25 INFO  Estimated optimised what-if runtime is 24849.14779663086ms
2022-09-25 03:42:25 INFO  Estimated optimisation runtime saving is 194347.42212295532ms
2022-09-25 03:42:25 INFO  ---RUNTIME: Multi-Query Optimization took 64.2538070678711 ms
2022-09-25 03:42:25 INFO  Executing generated plans
2022-09-25 03:42:55 INFO  ---RUNTIME: Execution took 29962.440967559814 ms
2022-09-25 03:42:55 INFO  Done!
2022-09-25 03:42:55 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-25 03:42:55 INFO  Running instrumented original pipeline...
2022-09-25 03:42:55 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-25 03:42:55 INFO  ---RUNTIME: Importing and monkey-patching took 6.54149055480957 ms
2022-09-25 03:43:04 INFO  ---RUNTIME: Original pipeline execution took 9230.74722290039 ms (excluding imports and monkey-patching)
2022-09-25 03:43:04 INFO  Starting execution of 1 what-if analyses...
2022-09-25 03:43:04 INFO  Start plan generation for analysis DataCorruption...
2022-09-25 03:43:04 INFO  ---RUNTIME: Plan generation took 0.38313865661621094 ms
2022-09-25 03:43:04 INFO  Estimated runtime of original DAG is 8916.340351104736ms
2022-09-25 03:43:04 WARNING Skipping Multi-Query Optimization (instead, only applying patches)
2022-09-25 03:43:04 INFO  Estimated unoptimised what-if runtime is 222908.5087776184ms
2022-09-25 03:43:04 INFO  ---RUNTIME: Multi-Query Optimization took 20.131349563598633 ms
2022-09-25 03:43:04 INFO  Executing generated plans
2022-09-25 03:46:59 INFO  ---RUNTIME: Execution took 234716.51768684387 ms
2022-09-25 03:46:59 INFO  Done!
2022-09-25 03:46:59 INFO  # Finished -- repetition 6 of 7 
2022-09-25 03:46:59 INFO  # Optimization benchmark for data_corruption with args [['reviews', 'slow_loading', 'featurization_1', 'neural_network']] -- repetition 7 of 7
2022-09-25 03:46:59 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-25 03:46:59 INFO  Running instrumented original pipeline...
2022-09-25 03:46:59 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-25 03:46:59 INFO  ---RUNTIME: Importing and monkey-patching took 6.15239143371582 ms
2022-09-25 03:47:08 INFO  ---RUNTIME: Original pipeline execution took 9016.930103302002 ms (excluding imports and monkey-patching)
2022-09-25 03:47:08 INFO  Starting execution of 1 what-if analyses...
2022-09-25 03:47:08 INFO  Start plan generation for analysis DataCorruption...
2022-09-25 03:47:08 INFO  ---RUNTIME: Plan generation took 0.4336833953857422 ms
2022-09-25 03:47:08 INFO  Estimated runtime of original DAG is 8721.119403839111ms
2022-09-25 03:47:08 INFO  Performing Multi-Query Optimization
2022-09-25 03:47:08 INFO  Estimated unoptimized what-if runtime is 218027.98509597778ms
2022-09-25 03:47:08 INFO  Estimated optimised what-if runtime is 24430.95111846924ms
2022-09-25 03:47:08 INFO  Estimated optimisation runtime saving is 193597.03397750854ms
2022-09-25 03:47:08 INFO  ---RUNTIME: Multi-Query Optimization took 63.91334533691406 ms
2022-09-25 03:47:08 INFO  Executing generated plans
2022-09-25 03:47:38 INFO  ---RUNTIME: Execution took 29790.544986724854 ms
2022-09-25 03:47:38 INFO  Done!
2022-09-25 03:47:38 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-25 03:47:38 INFO  Running instrumented original pipeline...
2022-09-25 03:47:38 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-25 03:47:38 INFO  ---RUNTIME: Importing and monkey-patching took 6.337165832519531 ms
2022-09-25 03:47:47 INFO  ---RUNTIME: Original pipeline execution took 9046.49043083191 ms (excluding imports and monkey-patching)
2022-09-25 03:47:47 INFO  Starting execution of 1 what-if analyses...
2022-09-25 03:47:47 INFO  Start plan generation for analysis DataCorruption...
2022-09-25 03:47:47 INFO  ---RUNTIME: Plan generation took 0.4394054412841797 ms
2022-09-25 03:47:47 INFO  Estimated runtime of original DAG is 8748.609066009521ms
2022-09-25 03:47:47 WARNING Skipping Multi-Query Optimization (instead, only applying patches)
2022-09-25 03:47:47 INFO  Estimated unoptimised what-if runtime is 218715.22665023804ms
2022-09-25 03:47:47 INFO  ---RUNTIME: Multi-Query Optimization took 20.27106285095215 ms
2022-09-25 03:47:47 INFO  Executing generated plans
2022-09-25 03:51:44 INFO  ---RUNTIME: Execution took 237089.5025730133 ms
2022-09-25 03:51:44 INFO  Done!
2022-09-25 03:51:44 INFO  # Finished -- repetition 7 of 7 
2022-09-25 03:51:44 INFO  # Final results after all repetitions
2022-09-25 03:51:44 INFO     repetition  ... no_opt_what_if_execution_combined_model_training
0           0  ...                                     81916.168451
1           1  ...                                     81425.248623
2           2  ...                                     81684.043407
3           3  ...                                     81667.480946
4           4  ...                                     79894.790173
5           5  ...                                     80377.649784
6           6  ...                                     81177.361250

[7 rows x 26 columns]
PROTOCOL_BUFFERS_PYTHON_IMPLEMENTATION=python taskset -c 32-39 python3.9 benchmarks_end_to_end.py data_corruption reviews slow_loading featurization_2 logistic_regression
2022-09-25 03:51:46.900131: W tensorflow/stream_executor/platform/default/dso_loader.cc:64] Could not load dynamic library 'libcudart.so.11.0'; dlerror: libcudart.so.11.0: cannot open shared object file: No such file or directory; LD_LIBRARY_PATH: /home/sgrafbe/mlwhatif/venv/lib/python3.9/site-packages/cv2/../../lib64:
2022-09-25 03:51:46.900168: I tensorflow/stream_executor/cuda/cudart_stub.cc:29] Ignore above cudart dlerror if you do not have a GPU set up on your machine.
2022-09-25 03:51:48 INFO  Patching sys.argv with ['mlwhatif', 'reviews', 'slow_loading', 'featurization_2', 'logistic_regression']
2022-09-25 03:51:48 INFO  Running instrumented original pipeline...
2022-09-25 03:51:48 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-25 03:51:48 INFO  ---RUNTIME: Importing and monkey-patching took 95.98684310913086 ms
2022-09-25 03:51:54 INFO  ---RUNTIME: Original pipeline execution took 6308.738470077515 ms (excluding imports and monkey-patching)
2022-09-25 03:51:54 INFO  Starting execution of 0 what-if analyses...
2022-09-25 03:51:54 INFO  Estimated runtime of original DAG is 5981.373310089111ms
2022-09-25 03:51:54 INFO  Performing Multi-Query Optimization
2022-09-25 03:51:54 INFO  Estimated unoptimized what-if runtime is 0ms
2022-09-25 03:51:54 INFO  Estimated optimised what-if runtime is 0ms
2022-09-25 03:51:54 INFO  Estimated optimisation runtime saving is 0ms
2022-09-25 03:51:54 INFO  ---RUNTIME: Multi-Query Optimization took 0.6043910980224609 ms
2022-09-25 03:51:54 INFO  Executing generated plans
2022-09-25 03:51:54 INFO  ---RUNTIME: Execution took 0.030755996704101562 ms
2022-09-25 03:51:54 INFO  Done!
2022-09-25 03:51:54 INFO  # Optimization benchmark for data_corruption with args [['reviews', 'slow_loading', 'featurization_2', 'logistic_regression']] -- repetition 1 of 7
2022-09-25 03:51:54 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-25 03:51:54 INFO  Running instrumented original pipeline...
2022-09-25 03:51:54 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-25 03:51:54 INFO  ---RUNTIME: Importing and monkey-patching took 5.684137344360352 ms
2022-09-25 03:52:01 INFO  ---RUNTIME: Original pipeline execution took 6483.796119689941 ms (excluding imports and monkey-patching)
2022-09-25 03:52:01 INFO  Starting execution of 1 what-if analyses...
2022-09-25 03:52:01 INFO  Start plan generation for analysis DataCorruption...
2022-09-25 03:52:01 INFO  ---RUNTIME: Plan generation took 0.4489421844482422 ms
2022-09-25 03:52:01 INFO  Estimated runtime of original DAG is 6183.002471923828ms
2022-09-25 03:52:01 INFO  Performing Multi-Query Optimization
2022-09-25 03:52:01 INFO  Estimated unoptimized what-if runtime is 154575.0617980957ms
2022-09-25 03:52:01 INFO  Estimated optimised what-if runtime is 14883.275508880615ms
2022-09-25 03:52:01 INFO  Estimated optimisation runtime saving is 139691.7862892151ms
2022-09-25 03:52:01 INFO  ---RUNTIME: Multi-Query Optimization took 69.43988800048828 ms
2022-09-25 03:52:01 INFO  Executing generated plans
2022-09-25 03:52:20 INFO  ---RUNTIME: Execution took 18981.84847831726 ms
2022-09-25 03:52:20 INFO  Done!
2022-09-25 03:52:20 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-25 03:52:20 INFO  Running instrumented original pipeline...
2022-09-25 03:52:20 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-25 03:52:20 INFO  ---RUNTIME: Importing and monkey-patching took 5.991697311401367 ms
2022-09-25 03:52:26 INFO  ---RUNTIME: Original pipeline execution took 6614.1676902771 ms (excluding imports and monkey-patching)
2022-09-25 03:52:26 INFO  Starting execution of 1 what-if analyses...
2022-09-25 03:52:26 INFO  Start plan generation for analysis DataCorruption...
2022-09-25 03:52:26 INFO  ---RUNTIME: Plan generation took 0.5557537078857422 ms
2022-09-25 03:52:26 INFO  Estimated runtime of original DAG is 6141.049146652222ms
2022-09-25 03:52:26 WARNING Skipping Multi-Query Optimization (instead, only applying patches)
2022-09-25 03:52:26 INFO  Estimated unoptimised what-if runtime is 153526.22866630554ms
2022-09-25 03:52:26 INFO  ---RUNTIME: Multi-Query Optimization took 20.481586456298828 ms
2022-09-25 03:52:26 INFO  Executing generated plans
2022-09-25 03:55:12 INFO  ---RUNTIME: Execution took 165499.96328353882 ms
2022-09-25 03:55:12 INFO  Done!
2022-09-25 03:55:12 INFO  # Finished -- repetition 1 of 7 
2022-09-25 03:55:12 INFO  # Optimization benchmark for data_corruption with args [['reviews', 'slow_loading', 'featurization_2', 'logistic_regression']] -- repetition 2 of 7
2022-09-25 03:55:12 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-25 03:55:12 INFO  Running instrumented original pipeline...
2022-09-25 03:55:12 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-25 03:55:12 INFO  ---RUNTIME: Importing and monkey-patching took 6.419897079467773 ms
2022-09-25 03:55:18 INFO  ---RUNTIME: Original pipeline execution took 6184.521436691284 ms (excluding imports and monkey-patching)
2022-09-25 03:55:18 INFO  Starting execution of 1 what-if analyses...
2022-09-25 03:55:18 INFO  Start plan generation for analysis DataCorruption...
2022-09-25 03:55:18 INFO  ---RUNTIME: Plan generation took 0.438690185546875 ms
2022-09-25 03:55:18 INFO  Estimated runtime of original DAG is 5887.001752853394ms
2022-09-25 03:55:18 INFO  Performing Multi-Query Optimization
2022-09-25 03:55:18 INFO  Estimated unoptimized what-if runtime is 147175.04382133484ms
2022-09-25 03:55:18 INFO  Estimated optimised what-if runtime is 13970.416784286499ms
2022-09-25 03:55:18 INFO  Estimated optimisation runtime saving is 133204.62703704834ms
2022-09-25 03:55:18 INFO  ---RUNTIME: Multi-Query Optimization took 68.0699348449707 ms
2022-09-25 03:55:18 INFO  Executing generated plans
2022-09-25 03:55:37 INFO  ---RUNTIME: Execution took 18807.875871658325 ms
2022-09-25 03:55:37 INFO  Done!
2022-09-25 03:55:37 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-25 03:55:37 INFO  Running instrumented original pipeline...
2022-09-25 03:55:37 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-25 03:55:37 INFO  ---RUNTIME: Importing and monkey-patching took 6.983041763305664 ms
2022-09-25 03:55:43 INFO  ---RUNTIME: Original pipeline execution took 6325.986623764038 ms (excluding imports and monkey-patching)
2022-09-25 03:55:43 INFO  Starting execution of 1 what-if analyses...
2022-09-25 03:55:43 INFO  Start plan generation for analysis DataCorruption...
2022-09-25 03:55:43 INFO  ---RUNTIME: Plan generation took 0.41747093200683594 ms
2022-09-25 03:55:43 INFO  Estimated runtime of original DAG is 6020.17068862915ms
2022-09-25 03:55:43 WARNING Skipping Multi-Query Optimization (instead, only applying patches)
2022-09-25 03:55:43 INFO  Estimated unoptimised what-if runtime is 150504.26721572876ms
2022-09-25 03:55:43 INFO  ---RUNTIME: Multi-Query Optimization took 19.9737548828125 ms
2022-09-25 03:55:43 INFO  Executing generated plans
2022-09-25 03:58:30 INFO  ---RUNTIME: Execution took 166981.23383522034 ms
2022-09-25 03:58:30 INFO  Done!
2022-09-25 03:58:30 INFO  # Finished -- repetition 2 of 7 
2022-09-25 03:58:30 INFO  # Optimization benchmark for data_corruption with args [['reviews', 'slow_loading', 'featurization_2', 'logistic_regression']] -- repetition 3 of 7
2022-09-25 03:58:30 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-25 03:58:30 INFO  Running instrumented original pipeline...
2022-09-25 03:58:30 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-25 03:58:30 INFO  ---RUNTIME: Importing and monkey-patching took 6.436824798583984 ms
2022-09-25 03:58:37 INFO  ---RUNTIME: Original pipeline execution took 6550.135612487793 ms (excluding imports and monkey-patching)
2022-09-25 03:58:37 INFO  Starting execution of 1 what-if analyses...
2022-09-25 03:58:37 INFO  Start plan generation for analysis DataCorruption...
2022-09-25 03:58:37 INFO  ---RUNTIME: Plan generation took 0.4451274871826172 ms
2022-09-25 03:58:37 INFO  Estimated runtime of original DAG is 6230.91197013855ms
2022-09-25 03:58:37 INFO  Performing Multi-Query Optimization
2022-09-25 03:58:37 INFO  Estimated unoptimized what-if runtime is 155772.79925346375ms
2022-09-25 03:58:37 INFO  Estimated optimised what-if runtime is 14355.748891830444ms
2022-09-25 03:58:37 INFO  Estimated optimisation runtime saving is 141417.0503616333ms
2022-09-25 03:58:37 INFO  ---RUNTIME: Multi-Query Optimization took 68.21990013122559 ms
2022-09-25 03:58:37 INFO  Executing generated plans
2022-09-25 03:58:56 INFO  ---RUNTIME: Execution took 18939.90182876587 ms
2022-09-25 03:58:56 INFO  Done!
2022-09-25 03:58:56 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-25 03:58:56 INFO  Running instrumented original pipeline...
2022-09-25 03:58:56 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-25 03:58:56 INFO  ---RUNTIME: Importing and monkey-patching took 205.6131362915039 ms
2022-09-25 03:59:02 INFO  ---RUNTIME: Original pipeline execution took 6469.8121547698975 ms (excluding imports and monkey-patching)
2022-09-25 03:59:02 INFO  Starting execution of 1 what-if analyses...
2022-09-25 03:59:02 INFO  Start plan generation for analysis DataCorruption...
2022-09-25 03:59:02 INFO  ---RUNTIME: Plan generation took 0.4470348358154297 ms
2022-09-25 03:59:02 INFO  Estimated runtime of original DAG is 6155.774831771851ms
2022-09-25 03:59:02 WARNING Skipping Multi-Query Optimization (instead, only applying patches)
2022-09-25 03:59:03 INFO  Estimated unoptimised what-if runtime is 153894.37079429626ms
2022-09-25 03:59:03 INFO  ---RUNTIME: Multi-Query Optimization took 20.006656646728516 ms
2022-09-25 03:59:03 INFO  Executing generated plans
2022-09-25 04:01:48 INFO  ---RUNTIME: Execution took 165600.54111480713 ms
2022-09-25 04:01:48 INFO  Done!
2022-09-25 04:01:48 INFO  # Finished -- repetition 3 of 7 
2022-09-25 04:01:48 INFO  # Optimization benchmark for data_corruption with args [['reviews', 'slow_loading', 'featurization_2', 'logistic_regression']] -- repetition 4 of 7
2022-09-25 04:01:48 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-25 04:01:48 INFO  Running instrumented original pipeline...
2022-09-25 04:01:48 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-25 04:01:48 INFO  ---RUNTIME: Importing and monkey-patching took 6.312370300292969 ms
2022-09-25 04:01:54 INFO  ---RUNTIME: Original pipeline execution took 6210.558652877808 ms (excluding imports and monkey-patching)
2022-09-25 04:01:54 INFO  Starting execution of 1 what-if analyses...
2022-09-25 04:01:54 INFO  Start plan generation for analysis DataCorruption...
2022-09-25 04:01:54 INFO  ---RUNTIME: Plan generation took 0.43392181396484375 ms
2022-09-25 04:01:54 INFO  Estimated runtime of original DAG is 5908.658742904663ms
2022-09-25 04:01:54 INFO  Performing Multi-Query Optimization
2022-09-25 04:01:54 INFO  Estimated unoptimized what-if runtime is 147716.46857261658ms
2022-09-25 04:01:54 INFO  Estimated optimised what-if runtime is 14033.533334732056ms
2022-09-25 04:01:54 INFO  Estimated optimisation runtime saving is 133682.93523788452ms
2022-09-25 04:01:54 INFO  ---RUNTIME: Multi-Query Optimization took 68.17770004272461 ms
2022-09-25 04:01:54 INFO  Executing generated plans
2022-09-25 04:02:13 INFO  ---RUNTIME: Execution took 19044.286251068115 ms
2022-09-25 04:02:13 INFO  Done!
2022-09-25 04:02:13 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-25 04:02:13 INFO  Running instrumented original pipeline...
2022-09-25 04:02:14 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-25 04:02:14 INFO  ---RUNTIME: Importing and monkey-patching took 7.1506500244140625 ms
2022-09-25 04:02:20 INFO  ---RUNTIME: Original pipeline execution took 6453.518867492676 ms (excluding imports and monkey-patching)
2022-09-25 04:02:20 INFO  Starting execution of 1 what-if analyses...
2022-09-25 04:02:20 INFO  Start plan generation for analysis DataCorruption...
2022-09-25 04:02:20 INFO  ---RUNTIME: Plan generation took 0.4184246063232422 ms
2022-09-25 04:02:20 INFO  Estimated runtime of original DAG is 6146.857976913452ms
2022-09-25 04:02:20 WARNING Skipping Multi-Query Optimization (instead, only applying patches)
2022-09-25 04:02:20 INFO  Estimated unoptimised what-if runtime is 153671.4494228363ms
2022-09-25 04:02:20 INFO  ---RUNTIME: Multi-Query Optimization took 19.991159439086914 ms
2022-09-25 04:02:20 INFO  Executing generated plans
2022-09-25 04:05:06 INFO  ---RUNTIME: Execution took 165651.96299552917 ms
2022-09-25 04:05:06 INFO  Done!
2022-09-25 04:05:06 INFO  # Finished -- repetition 4 of 7 
2022-09-25 04:05:06 INFO  # Optimization benchmark for data_corruption with args [['reviews', 'slow_loading', 'featurization_2', 'logistic_regression']] -- repetition 5 of 7
2022-09-25 04:05:06 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-25 04:05:06 INFO  Running instrumented original pipeline...
2022-09-25 04:05:06 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-25 04:05:06 INFO  ---RUNTIME: Importing and monkey-patching took 6.508350372314453 ms
2022-09-25 04:05:12 INFO  ---RUNTIME: Original pipeline execution took 6574.6331214904785 ms (excluding imports and monkey-patching)
2022-09-25 04:05:12 INFO  Starting execution of 1 what-if analyses...
2022-09-25 04:05:12 INFO  Start plan generation for analysis DataCorruption...
2022-09-25 04:05:12 INFO  ---RUNTIME: Plan generation took 0.43082237243652344 ms
2022-09-25 04:05:12 INFO  Estimated runtime of original DAG is 6252.053499221802ms
2022-09-25 04:05:12 INFO  Performing Multi-Query Optimization
2022-09-25 04:05:12 INFO  Estimated unoptimized what-if runtime is 156301.33748054504ms
2022-09-25 04:05:12 INFO  Estimated optimised what-if runtime is 14799.682140350342ms
2022-09-25 04:05:12 INFO  Estimated optimisation runtime saving is 141501.6553401947ms
2022-09-25 04:05:12 INFO  ---RUNTIME: Multi-Query Optimization took 72.40962982177734 ms
2022-09-25 04:05:12 INFO  Executing generated plans
2022-09-25 04:05:32 INFO  ---RUNTIME: Execution took 19212.05234527588 ms
2022-09-25 04:05:32 INFO  Done!
2022-09-25 04:05:32 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-25 04:05:32 INFO  Running instrumented original pipeline...
2022-09-25 04:05:32 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-25 04:05:32 INFO  ---RUNTIME: Importing and monkey-patching took 6.026268005371094 ms
2022-09-25 04:05:38 INFO  ---RUNTIME: Original pipeline execution took 6395.789384841919 ms (excluding imports and monkey-patching)
2022-09-25 04:05:38 INFO  Starting execution of 1 what-if analyses...
2022-09-25 04:05:38 INFO  Start plan generation for analysis DataCorruption...
2022-09-25 04:05:38 INFO  ---RUNTIME: Plan generation took 0.5319118499755859 ms
2022-09-25 04:05:38 INFO  Estimated runtime of original DAG is 6093.076944351196ms
2022-09-25 04:05:38 WARNING Skipping Multi-Query Optimization (instead, only applying patches)
2022-09-25 04:05:38 INFO  Estimated unoptimised what-if runtime is 152326.9236087799ms
2022-09-25 04:05:38 INFO  ---RUNTIME: Multi-Query Optimization took 21.97265625 ms
2022-09-25 04:05:38 INFO  Executing generated plans
2022-09-25 04:08:25 INFO  ---RUNTIME: Execution took 166616.1825656891 ms
2022-09-25 04:08:25 INFO  Done!
2022-09-25 04:08:25 INFO  # Finished -- repetition 5 of 7 
2022-09-25 04:08:25 INFO  # Optimization benchmark for data_corruption with args [['reviews', 'slow_loading', 'featurization_2', 'logistic_regression']] -- repetition 6 of 7
2022-09-25 04:08:25 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-25 04:08:25 INFO  Running instrumented original pipeline...
2022-09-25 04:08:25 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-25 04:08:25 INFO  ---RUNTIME: Importing and monkey-patching took 6.441831588745117 ms
2022-09-25 04:08:31 INFO  ---RUNTIME: Original pipeline execution took 6468.448162078857 ms (excluding imports and monkey-patching)
2022-09-25 04:08:31 INFO  Starting execution of 1 what-if analyses...
2022-09-25 04:08:31 INFO  Start plan generation for analysis DataCorruption...
2022-09-25 04:08:31 INFO  ---RUNTIME: Plan generation took 0.4260540008544922 ms
2022-09-25 04:08:31 INFO  Estimated runtime of original DAG is 5938.550233840942ms
2022-09-25 04:08:31 INFO  Performing Multi-Query Optimization
2022-09-25 04:08:31 INFO  Estimated unoptimized what-if runtime is 148463.75584602356ms
2022-09-25 04:08:31 INFO  Estimated optimised what-if runtime is 14038.38300704956ms
2022-09-25 04:08:31 INFO  Estimated optimisation runtime saving is 134425.372838974ms
2022-09-25 04:08:31 INFO  ---RUNTIME: Multi-Query Optimization took 68.22943687438965 ms
2022-09-25 04:08:31 INFO  Executing generated plans
2022-09-25 04:08:50 INFO  ---RUNTIME: Execution took 18928.049087524414 ms
2022-09-25 04:08:50 INFO  Done!
2022-09-25 04:08:50 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-25 04:08:50 INFO  Running instrumented original pipeline...
2022-09-25 04:08:50 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-25 04:08:50 INFO  ---RUNTIME: Importing and monkey-patching took 5.995750427246094 ms
2022-09-25 04:08:56 INFO  ---RUNTIME: Original pipeline execution took 6319.600582122803 ms (excluding imports and monkey-patching)
2022-09-25 04:08:56 INFO  Starting execution of 1 what-if analyses...
2022-09-25 04:08:56 INFO  Start plan generation for analysis DataCorruption...
2022-09-25 04:08:56 INFO  ---RUNTIME: Plan generation took 0.4112720489501953 ms
2022-09-25 04:08:56 INFO  Estimated runtime of original DAG is 6017.860174179077ms
2022-09-25 04:08:56 WARNING Skipping Multi-Query Optimization (instead, only applying patches)
2022-09-25 04:08:56 INFO  Estimated unoptimised what-if runtime is 150446.50435447693ms
2022-09-25 04:08:56 INFO  ---RUNTIME: Multi-Query Optimization took 19.726037979125977 ms
2022-09-25 04:08:56 INFO  Executing generated plans
2022-09-25 04:11:43 INFO  ---RUNTIME: Execution took 166700.91843605042 ms
2022-09-25 04:11:43 INFO  Done!
2022-09-25 04:11:43 INFO  # Finished -- repetition 6 of 7 
2022-09-25 04:11:43 INFO  # Optimization benchmark for data_corruption with args [['reviews', 'slow_loading', 'featurization_2', 'logistic_regression']] -- repetition 7 of 7
2022-09-25 04:11:43 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-25 04:11:43 INFO  Running instrumented original pipeline...
2022-09-25 04:11:43 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-25 04:11:43 INFO  ---RUNTIME: Importing and monkey-patching took 6.378412246704102 ms
2022-09-25 04:11:49 INFO  ---RUNTIME: Original pipeline execution took 6205.197334289551 ms (excluding imports and monkey-patching)
2022-09-25 04:11:49 INFO  Starting execution of 1 what-if analyses...
2022-09-25 04:11:49 INFO  Start plan generation for analysis DataCorruption...
2022-09-25 04:11:49 INFO  ---RUNTIME: Plan generation took 0.4830360412597656 ms
2022-09-25 04:11:49 INFO  Estimated runtime of original DAG is 5900.471448898315ms
2022-09-25 04:11:49 INFO  Performing Multi-Query Optimization
2022-09-25 04:11:49 INFO  Estimated unoptimized what-if runtime is 147511.7862224579ms
2022-09-25 04:11:49 INFO  Estimated optimised what-if runtime is 13932.228803634644ms
2022-09-25 04:11:49 INFO  Estimated optimisation runtime saving is 133579.55741882324ms
2022-09-25 04:11:49 INFO  ---RUNTIME: Multi-Query Optimization took 67.95954704284668 ms
2022-09-25 04:11:49 INFO  Executing generated plans
2022-09-25 04:12:08 INFO  ---RUNTIME: Execution took 18552.97064781189 ms
2022-09-25 04:12:08 INFO  Done!
2022-09-25 04:12:08 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-25 04:12:08 INFO  Running instrumented original pipeline...
2022-09-25 04:12:08 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-25 04:12:08 INFO  ---RUNTIME: Importing and monkey-patching took 6.3762664794921875 ms
2022-09-25 04:12:14 INFO  ---RUNTIME: Original pipeline execution took 6253.690242767334 ms (excluding imports and monkey-patching)
2022-09-25 04:12:14 INFO  Starting execution of 1 what-if analyses...
2022-09-25 04:12:14 INFO  Start plan generation for analysis DataCorruption...
2022-09-25 04:12:14 INFO  ---RUNTIME: Plan generation took 0.43082237243652344 ms
2022-09-25 04:12:14 INFO  Estimated runtime of original DAG is 5950.922727584839ms
2022-09-25 04:12:14 WARNING Skipping Multi-Query Optimization (instead, only applying patches)
2022-09-25 04:12:14 INFO  Estimated unoptimised what-if runtime is 148773.06818962097ms
2022-09-25 04:12:14 INFO  ---RUNTIME: Multi-Query Optimization took 19.864559173583984 ms
2022-09-25 04:12:14 INFO  Executing generated plans
2022-09-25 04:14:56 INFO  ---RUNTIME: Execution took 162196.39992713928 ms
2022-09-25 04:14:57 INFO  Done!
2022-09-25 04:14:57 INFO  # Finished -- repetition 7 of 7 
2022-09-25 04:14:57 INFO  # Final results after all repetitions
2022-09-25 04:14:57 INFO     repetition  ... no_opt_what_if_execution_combined_model_training
0           0  ...                                      2734.258413
1           1  ...                                      2739.278078
2           2  ...                                      2651.953220
3           3  ...                                      2693.374395
4           4  ...                                      2747.256279
5           5  ...                                      2658.133268
6           6  ...                                      2506.225824

[7 rows x 26 columns]
PROTOCOL_BUFFERS_PYTHON_IMPLEMENTATION=python taskset -c 32-39 python3.9 benchmarks_end_to_end.py data_corruption reviews slow_loading featurization_2 xgboost
2022-09-25 04:14:59.150840: W tensorflow/stream_executor/platform/default/dso_loader.cc:64] Could not load dynamic library 'libcudart.so.11.0'; dlerror: libcudart.so.11.0: cannot open shared object file: No such file or directory; LD_LIBRARY_PATH: /home/sgrafbe/mlwhatif/venv/lib/python3.9/site-packages/cv2/../../lib64:
2022-09-25 04:14:59.150884: I tensorflow/stream_executor/cuda/cudart_stub.cc:29] Ignore above cudart dlerror if you do not have a GPU set up on your machine.
2022-09-25 04:15:00 INFO  Patching sys.argv with ['mlwhatif', 'reviews', 'slow_loading', 'featurization_2', 'xgboost']
2022-09-25 04:15:00 INFO  Running instrumented original pipeline...
2022-09-25 04:15:00 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-25 04:15:00 INFO  ---RUNTIME: Importing and monkey-patching took 95.35932540893555 ms
2022-09-25 04:15:41 INFO  ---RUNTIME: Original pipeline execution took 40678.1530380249 ms (excluding imports and monkey-patching)
2022-09-25 04:15:41 INFO  Starting execution of 0 what-if analyses...
2022-09-25 04:15:41 INFO  Estimated runtime of original DAG is 40343.12462806702ms
2022-09-25 04:15:41 INFO  Performing Multi-Query Optimization
2022-09-25 04:15:41 INFO  Estimated unoptimized what-if runtime is 0ms
2022-09-25 04:15:41 INFO  Estimated optimised what-if runtime is 0ms
2022-09-25 04:15:41 INFO  Estimated optimisation runtime saving is 0ms
2022-09-25 04:15:41 INFO  ---RUNTIME: Multi-Query Optimization took 0.5171298980712891 ms
2022-09-25 04:15:41 INFO  Executing generated plans
2022-09-25 04:15:41 INFO  ---RUNTIME: Execution took 0.025987625122070312 ms
2022-09-25 04:15:41 INFO  Done!
2022-09-25 04:15:41 INFO  # Optimization benchmark for data_corruption with args [['reviews', 'slow_loading', 'featurization_2', 'xgboost']] -- repetition 1 of 7
2022-09-25 04:15:41 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-25 04:15:41 INFO  Running instrumented original pipeline...
2022-09-25 04:15:41 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-25 04:15:41 INFO  ---RUNTIME: Importing and monkey-patching took 5.669355392456055 ms
2022-09-25 04:16:21 INFO  ---RUNTIME: Original pipeline execution took 40400.416135787964 ms (excluding imports and monkey-patching)
2022-09-25 04:16:21 INFO  Starting execution of 1 what-if analyses...
2022-09-25 04:16:21 INFO  Start plan generation for analysis DataCorruption...
2022-09-25 04:16:21 INFO  ---RUNTIME: Plan generation took 0.4673004150390625 ms
2022-09-25 04:16:21 INFO  Estimated runtime of original DAG is 40101.083755493164ms
2022-09-25 04:16:21 INFO  Performing Multi-Query Optimization
2022-09-25 04:16:21 INFO  Estimated unoptimized what-if runtime is 1002527.0938873291ms
2022-09-25 04:16:21 INFO  Estimated optimised what-if runtime is 56259.679555892944ms
2022-09-25 04:16:21 INFO  Estimated optimisation runtime saving is 946267.4143314362ms
2022-09-25 04:16:21 INFO  ---RUNTIME: Multi-Query Optimization took 67.3675537109375 ms
2022-09-25 04:16:21 INFO  Executing generated plans
2022-09-25 04:17:22 INFO  ---RUNTIME: Execution took 60518.53823661804 ms
2022-09-25 04:17:22 INFO  Done!
2022-09-25 04:17:22 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-25 04:17:22 INFO  Running instrumented original pipeline...
2022-09-25 04:17:22 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-25 04:17:22 INFO  ---RUNTIME: Importing and monkey-patching took 6.067991256713867 ms
2022-09-25 04:18:02 INFO  ---RUNTIME: Original pipeline execution took 40733.4725856781 ms (excluding imports and monkey-patching)
2022-09-25 04:18:02 INFO  Starting execution of 1 what-if analyses...
2022-09-25 04:18:02 INFO  Start plan generation for analysis DataCorruption...
2022-09-25 04:18:02 INFO  ---RUNTIME: Plan generation took 0.5099773406982422 ms
2022-09-25 04:18:02 INFO  Estimated runtime of original DAG is 40250.21457672119ms
2022-09-25 04:18:02 WARNING Skipping Multi-Query Optimization (instead, only applying patches)
2022-09-25 04:18:02 INFO  Estimated unoptimised what-if runtime is 1006255.3644180298ms
2022-09-25 04:18:02 INFO  ---RUNTIME: Multi-Query Optimization took 19.405364990234375 ms
2022-09-25 04:18:02 INFO  Executing generated plans
2022-09-25 04:34:58 INFO  ---RUNTIME: Execution took 1016014.6203041077 ms
2022-09-25 04:34:58 INFO  Done!
2022-09-25 04:34:58 INFO  # Finished -- repetition 1 of 7 
2022-09-25 04:34:58 INFO  # Optimization benchmark for data_corruption with args [['reviews', 'slow_loading', 'featurization_2', 'xgboost']] -- repetition 2 of 7
2022-09-25 04:34:58 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-25 04:34:58 INFO  Running instrumented original pipeline...
2022-09-25 04:34:59 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-25 04:34:59 INFO  ---RUNTIME: Importing and monkey-patching took 6.479501724243164 ms
2022-09-25 04:35:39 INFO  ---RUNTIME: Original pipeline execution took 40296.34976387024 ms (excluding imports and monkey-patching)
2022-09-25 04:35:39 INFO  Starting execution of 1 what-if analyses...
2022-09-25 04:35:39 INFO  Start plan generation for analysis DataCorruption...
2022-09-25 04:35:39 INFO  ---RUNTIME: Plan generation took 0.44536590576171875 ms
2022-09-25 04:35:39 INFO  Estimated runtime of original DAG is 39996.559381484985ms
2022-09-25 04:35:39 INFO  Performing Multi-Query Optimization
2022-09-25 04:35:39 INFO  Estimated unoptimized what-if runtime is 999913.9845371246ms
2022-09-25 04:35:39 INFO  Estimated optimised what-if runtime is 55963.65714073181ms
2022-09-25 04:35:39 INFO  Estimated optimisation runtime saving is 943950.3273963928ms
2022-09-25 04:35:39 INFO  ---RUNTIME: Multi-Query Optimization took 66.21956825256348 ms
2022-09-25 04:35:39 INFO  Executing generated plans
2022-09-25 04:36:39 INFO  ---RUNTIME: Execution took 60557.743072509766 ms
2022-09-25 04:36:39 INFO  Done!
2022-09-25 04:36:39 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-25 04:36:39 INFO  Running instrumented original pipeline...
2022-09-25 04:36:39 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-25 04:36:39 INFO  ---RUNTIME: Importing and monkey-patching took 6.460666656494141 ms
2022-09-25 04:37:20 INFO  ---RUNTIME: Original pipeline execution took 40316.80774688721 ms (excluding imports and monkey-patching)
2022-09-25 04:37:20 INFO  Starting execution of 1 what-if analyses...
2022-09-25 04:37:20 INFO  Start plan generation for analysis DataCorruption...
2022-09-25 04:37:20 INFO  ---RUNTIME: Plan generation took 0.4124641418457031 ms
2022-09-25 04:37:20 INFO  Estimated runtime of original DAG is 40015.92922210693ms
2022-09-25 04:37:20 WARNING Skipping Multi-Query Optimization (instead, only applying patches)
2022-09-25 04:37:20 INFO  Estimated unoptimised what-if runtime is 1000398.2305526733ms
2022-09-25 04:37:20 INFO  ---RUNTIME: Multi-Query Optimization took 19.294023513793945 ms
2022-09-25 04:37:20 INFO  Executing generated plans
2022-09-25 04:54:15 INFO  ---RUNTIME: Execution took 1015164.4942760468 ms
2022-09-25 04:54:15 INFO  Done!
2022-09-25 04:54:15 INFO  # Finished -- repetition 2 of 7 
2022-09-25 04:54:15 INFO  # Optimization benchmark for data_corruption with args [['reviews', 'slow_loading', 'featurization_2', 'xgboost']] -- repetition 3 of 7
2022-09-25 04:54:15 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-25 04:54:15 INFO  Running instrumented original pipeline...
2022-09-25 04:54:15 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-25 04:54:15 INFO  ---RUNTIME: Importing and monkey-patching took 6.412744522094727 ms
2022-09-25 04:54:55 INFO  ---RUNTIME: Original pipeline execution took 40281.35585784912 ms (excluding imports and monkey-patching)
2022-09-25 04:54:55 INFO  Starting execution of 1 what-if analyses...
2022-09-25 04:54:55 INFO  Start plan generation for analysis DataCorruption...
2022-09-25 04:54:55 INFO  ---RUNTIME: Plan generation took 0.43272972106933594 ms
2022-09-25 04:54:55 INFO  Estimated runtime of original DAG is 39982.87844657898ms
2022-09-25 04:54:55 INFO  Performing Multi-Query Optimization
2022-09-25 04:54:55 INFO  Estimated unoptimized what-if runtime is 999571.9611644745ms
2022-09-25 04:54:55 INFO  Estimated optimised what-if runtime is 55987.89024353027ms
2022-09-25 04:54:55 INFO  Estimated optimisation runtime saving is 943584.0709209442ms
2022-09-25 04:54:55 INFO  ---RUNTIME: Multi-Query Optimization took 65.86790084838867 ms
2022-09-25 04:54:55 INFO  Executing generated plans
2022-09-25 04:55:56 INFO  ---RUNTIME: Execution took 60904.301166534424 ms
2022-09-25 04:55:56 INFO  Done!
2022-09-25 04:55:56 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-25 04:55:56 INFO  Running instrumented original pipeline...
2022-09-25 04:55:56 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-25 04:55:56 INFO  ---RUNTIME: Importing and monkey-patching took 189.44525718688965 ms
2022-09-25 04:56:37 INFO  ---RUNTIME: Original pipeline execution took 40312.639236450195 ms (excluding imports and monkey-patching)
2022-09-25 04:56:37 INFO  Starting execution of 1 what-if analyses...
2022-09-25 04:56:37 INFO  Start plan generation for analysis DataCorruption...
2022-09-25 04:56:37 INFO  ---RUNTIME: Plan generation took 0.4055500030517578 ms
2022-09-25 04:56:37 INFO  Estimated runtime of original DAG is 40013.728618621826ms
2022-09-25 04:56:37 WARNING Skipping Multi-Query Optimization (instead, only applying patches)
2022-09-25 04:56:37 INFO  Estimated unoptimised what-if runtime is 1000343.2154655457ms
2022-09-25 04:56:37 INFO  ---RUNTIME: Multi-Query Optimization took 19.376516342163086 ms
2022-09-25 04:56:37 INFO  Executing generated plans
2022-09-25 05:13:54 INFO  ---RUNTIME: Execution took 1037447.1192359924 ms
2022-09-25 05:13:54 INFO  Done!
2022-09-25 05:13:54 INFO  # Finished -- repetition 3 of 7 
2022-09-25 05:13:54 INFO  # Optimization benchmark for data_corruption with args [['reviews', 'slow_loading', 'featurization_2', 'xgboost']] -- repetition 4 of 7
2022-09-25 05:13:54 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-25 05:13:54 INFO  Running instrumented original pipeline...
2022-09-25 05:13:54 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-25 05:13:54 INFO  ---RUNTIME: Importing and monkey-patching took 7.071018218994141 ms
2022-09-25 05:14:35 INFO  ---RUNTIME: Original pipeline execution took 40853.527307510376 ms (excluding imports and monkey-patching)
2022-09-25 05:14:35 INFO  Starting execution of 1 what-if analyses...
2022-09-25 05:14:35 INFO  Start plan generation for analysis DataCorruption...
2022-09-25 05:14:35 INFO  ---RUNTIME: Plan generation took 0.4303455352783203 ms
2022-09-25 05:14:35 INFO  Estimated runtime of original DAG is 40548.933267593384ms
2022-09-25 05:14:35 INFO  Performing Multi-Query Optimization
2022-09-25 05:14:35 INFO  Estimated unoptimized what-if runtime is 1013723.3316898346ms
2022-09-25 05:14:35 INFO  Estimated optimised what-if runtime is 56519.61708068848ms
2022-09-25 05:14:35 INFO  Estimated optimisation runtime saving is 957203.7146091461ms
2022-09-25 05:14:35 INFO  ---RUNTIME: Multi-Query Optimization took 65.65022468566895 ms
2022-09-25 05:14:35 INFO  Executing generated plans
2022-09-25 05:15:37 INFO  ---RUNTIME: Execution took 61553.26175689697 ms
2022-09-25 05:15:37 INFO  Done!
2022-09-25 05:15:37 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-25 05:15:37 INFO  Running instrumented original pipeline...
2022-09-25 05:15:37 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-25 05:15:37 INFO  ---RUNTIME: Importing and monkey-patching took 6.4716339111328125 ms
2022-09-25 05:16:18 INFO  ---RUNTIME: Original pipeline execution took 41189.41283226013 ms (excluding imports and monkey-patching)
2022-09-25 05:16:18 INFO  Starting execution of 1 what-if analyses...
2022-09-25 05:16:18 INFO  Start plan generation for analysis DataCorruption...
2022-09-25 05:16:18 INFO  ---RUNTIME: Plan generation took 0.4343986511230469 ms
2022-09-25 05:16:18 INFO  Estimated runtime of original DAG is 40874.927043914795ms
2022-09-25 05:16:18 WARNING Skipping Multi-Query Optimization (instead, only applying patches)
2022-09-25 05:16:18 INFO  Estimated unoptimised what-if runtime is 1021873.1760978699ms
2022-09-25 05:16:18 INFO  ---RUNTIME: Multi-Query Optimization took 19.621849060058594 ms
2022-09-25 05:16:18 INFO  Executing generated plans
2022-09-25 05:33:33 INFO  ---RUNTIME: Execution took 1035140.3248310089 ms
2022-09-25 05:33:33 INFO  Done!
2022-09-25 05:33:33 INFO  # Finished -- repetition 4 of 7 
2022-09-25 05:33:33 INFO  # Optimization benchmark for data_corruption with args [['reviews', 'slow_loading', 'featurization_2', 'xgboost']] -- repetition 5 of 7
2022-09-25 05:33:33 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-25 05:33:33 INFO  Running instrumented original pipeline...
2022-09-25 05:33:33 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-25 05:33:33 INFO  ---RUNTIME: Importing and monkey-patching took 6.425380706787109 ms
2022-09-25 05:34:13 INFO  ---RUNTIME: Original pipeline execution took 40223.660469055176 ms (excluding imports and monkey-patching)
2022-09-25 05:34:13 INFO  Starting execution of 1 what-if analyses...
2022-09-25 05:34:13 INFO  Start plan generation for analysis DataCorruption...
2022-09-25 05:34:13 INFO  ---RUNTIME: Plan generation took 0.45871734619140625 ms
2022-09-25 05:34:13 INFO  Estimated runtime of original DAG is 39923.75302314758ms
2022-09-25 05:34:13 INFO  Performing Multi-Query Optimization
2022-09-25 05:34:13 INFO  Estimated unoptimized what-if runtime is 998093.8255786896ms
2022-09-25 05:34:13 INFO  Estimated optimised what-if runtime is 55826.82704925537ms
2022-09-25 05:34:13 INFO  Estimated optimisation runtime saving is 942266.9985294342ms
2022-09-25 05:34:13 INFO  ---RUNTIME: Multi-Query Optimization took 65.85502624511719 ms
2022-09-25 05:34:13 INFO  Executing generated plans
2022-09-25 05:35:13 INFO  ---RUNTIME: Execution took 60018.88155937195 ms
2022-09-25 05:35:13 INFO  Done!
2022-09-25 05:35:13 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-25 05:35:13 INFO  Running instrumented original pipeline...
2022-09-25 05:35:13 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-25 05:35:13 INFO  ---RUNTIME: Importing and monkey-patching took 6.360292434692383 ms
2022-09-25 05:35:54 INFO  ---RUNTIME: Original pipeline execution took 40252.110719680786 ms (excluding imports and monkey-patching)
2022-09-25 05:35:54 INFO  Starting execution of 1 what-if analyses...
2022-09-25 05:35:54 INFO  Start plan generation for analysis DataCorruption...
2022-09-25 05:35:54 INFO  ---RUNTIME: Plan generation took 0.5037784576416016 ms
2022-09-25 05:35:54 INFO  Estimated runtime of original DAG is 39952.54468917847ms
2022-09-25 05:35:54 WARNING Skipping Multi-Query Optimization (instead, only applying patches)
2022-09-25 05:35:54 INFO  Estimated unoptimised what-if runtime is 998813.6172294617ms
2022-09-25 05:35:54 INFO  ---RUNTIME: Multi-Query Optimization took 19.20795440673828 ms
2022-09-25 05:35:54 INFO  Executing generated plans
2022-09-25 05:52:49 INFO  ---RUNTIME: Execution took 1015162.2595787048 ms
2022-09-25 05:52:49 INFO  Done!
2022-09-25 05:52:49 INFO  # Finished -- repetition 5 of 7 
2022-09-25 05:52:49 INFO  # Optimization benchmark for data_corruption with args [['reviews', 'slow_loading', 'featurization_2', 'xgboost']] -- repetition 6 of 7
2022-09-25 05:52:49 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-25 05:52:49 INFO  Running instrumented original pipeline...
2022-09-25 05:52:49 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-25 05:52:49 INFO  ---RUNTIME: Importing and monkey-patching took 6.41179084777832 ms
2022-09-25 05:53:29 INFO  ---RUNTIME: Original pipeline execution took 40519.79875564575 ms (excluding imports and monkey-patching)
2022-09-25 05:53:29 INFO  Starting execution of 1 what-if analyses...
2022-09-25 05:53:29 INFO  Start plan generation for analysis DataCorruption...
2022-09-25 05:53:29 INFO  ---RUNTIME: Plan generation took 0.4265308380126953 ms
2022-09-25 05:53:29 INFO  Estimated runtime of original DAG is 40020.04957199097ms
2022-09-25 05:53:29 INFO  Performing Multi-Query Optimization
2022-09-25 05:53:29 INFO  Estimated unoptimized what-if runtime is 1000501.2392997742ms
2022-09-25 05:53:29 INFO  Estimated optimised what-if runtime is 56024.88017082214ms
2022-09-25 05:53:29 INFO  Estimated optimisation runtime saving is 944476.359128952ms
2022-09-25 05:53:29 INFO  ---RUNTIME: Multi-Query Optimization took 65.92226028442383 ms
2022-09-25 05:53:29 INFO  Executing generated plans
2022-09-25 05:54:30 INFO  ---RUNTIME: Execution took 60389.389991760254 ms
2022-09-25 05:54:30 INFO  Done!
2022-09-25 05:54:30 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-25 05:54:30 INFO  Running instrumented original pipeline...
2022-09-25 05:54:30 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-25 05:54:30 INFO  ---RUNTIME: Importing and monkey-patching took 6.325960159301758 ms
2022-09-25 05:55:10 INFO  ---RUNTIME: Original pipeline execution took 40315.07706642151 ms (excluding imports and monkey-patching)
2022-09-25 05:55:10 INFO  Starting execution of 1 what-if analyses...
2022-09-25 05:55:10 INFO  Start plan generation for analysis DataCorruption...
2022-09-25 05:55:10 INFO  ---RUNTIME: Plan generation took 0.42366981506347656 ms
2022-09-25 05:55:10 INFO  Estimated runtime of original DAG is 40014.760971069336ms
2022-09-25 05:55:10 WARNING Skipping Multi-Query Optimization (instead, only applying patches)
2022-09-25 05:55:10 INFO  Estimated unoptimised what-if runtime is 1000369.0242767334ms
2022-09-25 05:55:10 INFO  ---RUNTIME: Multi-Query Optimization took 19.147396087646484 ms
2022-09-25 05:55:10 INFO  Executing generated plans
2022-09-25 06:12:06 INFO  ---RUNTIME: Execution took 1015640.6624317169 ms
2022-09-25 06:12:06 INFO  Done!
2022-09-25 06:12:06 INFO  # Finished -- repetition 6 of 7 
2022-09-25 06:12:06 INFO  # Optimization benchmark for data_corruption with args [['reviews', 'slow_loading', 'featurization_2', 'xgboost']] -- repetition 7 of 7
2022-09-25 06:12:06 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-25 06:12:06 INFO  Running instrumented original pipeline...
2022-09-25 06:12:06 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-25 06:12:06 INFO  ---RUNTIME: Importing and monkey-patching took 6.537675857543945 ms
2022-09-25 06:12:46 INFO  ---RUNTIME: Original pipeline execution took 40286.05246543884 ms (excluding imports and monkey-patching)
2022-09-25 06:12:46 INFO  Starting execution of 1 what-if analyses...
2022-09-25 06:12:46 INFO  Start plan generation for analysis DataCorruption...
2022-09-25 06:12:46 INFO  ---RUNTIME: Plan generation took 0.4239082336425781 ms
2022-09-25 06:12:46 INFO  Estimated runtime of original DAG is 39984.29465293884ms
2022-09-25 06:12:46 INFO  Performing Multi-Query Optimization
2022-09-25 06:12:46 INFO  Estimated unoptimized what-if runtime is 999607.3663234711ms
2022-09-25 06:12:46 INFO  Estimated optimised what-if runtime is 55891.29996299744ms
2022-09-25 06:12:46 INFO  Estimated optimisation runtime saving is 943716.0663604736ms
2022-09-25 06:12:46 INFO  ---RUNTIME: Multi-Query Optimization took 66.08271598815918 ms
2022-09-25 06:12:46 INFO  Executing generated plans
2022-09-25 06:13:47 INFO  ---RUNTIME: Execution took 60343.260049819946 ms
2022-09-25 06:13:47 INFO  Done!
2022-09-25 06:13:47 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-25 06:13:47 INFO  Running instrumented original pipeline...
2022-09-25 06:13:47 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-25 06:13:47 INFO  ---RUNTIME: Importing and monkey-patching took 6.381750106811523 ms
2022-09-25 06:14:27 INFO  ---RUNTIME: Original pipeline execution took 40324.83720779419 ms (excluding imports and monkey-patching)
2022-09-25 06:14:27 INFO  Starting execution of 1 what-if analyses...
2022-09-25 06:14:27 INFO  Start plan generation for analysis DataCorruption...
2022-09-25 06:14:27 INFO  ---RUNTIME: Plan generation took 0.4336833953857422 ms
2022-09-25 06:14:27 INFO  Estimated runtime of original DAG is 40022.531509399414ms
2022-09-25 06:14:27 WARNING Skipping Multi-Query Optimization (instead, only applying patches)
2022-09-25 06:14:27 INFO  Estimated unoptimised what-if runtime is 1000563.2877349854ms
2022-09-25 06:14:27 INFO  ---RUNTIME: Multi-Query Optimization took 19.284963607788086 ms
2022-09-25 06:14:27 INFO  Executing generated plans
2022-09-25 06:31:35 INFO  ---RUNTIME: Execution took 1027630.8269500732 ms
2022-09-25 06:31:35 INFO  Done!
2022-09-25 06:31:35 INFO  # Finished -- repetition 7 of 7 
2022-09-25 06:31:35 INFO  # Final results after all repetitions
2022-09-25 06:31:35 INFO     repetition  ... no_opt_what_if_execution_combined_model_training
0           0  ...                                    848622.035027
1           1  ...                                    848067.661047
2           2  ...                                    865747.697592
3           3  ...                                    863881.606340
4           4  ...                                    847531.237364
5           5  ...                                    848117.074728
6           6  ...                                    858465.507030

[7 rows x 26 columns]
PROTOCOL_BUFFERS_PYTHON_IMPLEMENTATION=python taskset -c 32-39 python3.9 benchmarks_end_to_end.py data_corruption reviews slow_loading featurization_2 neural_network
2022-09-25 06:31:37.167291: W tensorflow/stream_executor/platform/default/dso_loader.cc:64] Could not load dynamic library 'libcudart.so.11.0'; dlerror: libcudart.so.11.0: cannot open shared object file: No such file or directory; LD_LIBRARY_PATH: /home/sgrafbe/mlwhatif/venv/lib/python3.9/site-packages/cv2/../../lib64:
2022-09-25 06:31:37.167334: I tensorflow/stream_executor/cuda/cudart_stub.cc:29] Ignore above cudart dlerror if you do not have a GPU set up on your machine.
2022-09-25 06:31:38 INFO  Patching sys.argv with ['mlwhatif', 'reviews', 'slow_loading', 'featurization_2', 'neural_network']
2022-09-25 06:31:38 INFO  Running instrumented original pipeline...
2022-09-25 06:31:38 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-25 06:31:38 INFO  ---RUNTIME: Importing and monkey-patching took 95.37458419799805 ms
2022-09-25 06:31:43.289172: W tensorflow/stream_executor/platform/default/dso_loader.cc:64] Could not load dynamic library 'libcuda.so.1'; dlerror: libcuda.so.1: cannot open shared object file: No such file or directory; LD_LIBRARY_PATH: /home/sgrafbe/mlwhatif/venv/lib/python3.9/site-packages/cv2/../../lib64:
2022-09-25 06:31:43.289207: W tensorflow/stream_executor/cuda/cuda_driver.cc:326] failed call to cuInit: UNKNOWN ERROR (303)
2022-09-25 06:31:43.289231: I tensorflow/stream_executor/cuda/cuda_diagnostics.cc:156] kernel driver does not appear to be running on this host (wagyu): /proc/driver/nvidia/version does not exist
2022-09-25 06:31:43.289745: I tensorflow/core/platform/cpu_feature_guard.cc:142] This TensorFlow binary is optimized with oneAPI Deep Neural Network Library (oneDNN) to use the following CPU instructions in performance-critical operations:  AVX2 FMA
To enable them in other operations, rebuild TensorFlow with the appropriate compiler flags.
2022-09-25 06:31:43.912450: I tensorflow/compiler/mlir/mlir_graph_optimization_pass.cc:176] None of the MLIR Optimization Passes are enabled (registered 2)
2022-09-25 06:31:43.926372: I tensorflow/core/platform/profile_utils/cpu_utils.cc:114] CPU Frequency: 2595290000 Hz
2022-09-25 06:31:51 INFO  ---RUNTIME: Original pipeline execution took 13381.654262542725 ms (excluding imports and monkey-patching)
2022-09-25 06:31:51 INFO  Starting execution of 0 what-if analyses...
2022-09-25 06:31:51 INFO  Estimated runtime of original DAG is 13047.1031665802ms
2022-09-25 06:31:51 INFO  Performing Multi-Query Optimization
2022-09-25 06:31:51 INFO  Estimated unoptimized what-if runtime is 0ms
2022-09-25 06:31:51 INFO  Estimated optimised what-if runtime is 0ms
2022-09-25 06:31:51 INFO  Estimated optimisation runtime saving is 0ms
2022-09-25 06:31:51 INFO  ---RUNTIME: Multi-Query Optimization took 0.598907470703125 ms
2022-09-25 06:31:51 INFO  Executing generated plans
2022-09-25 06:31:51 INFO  ---RUNTIME: Execution took 0.022411346435546875 ms
2022-09-25 06:31:51 INFO  Done!
2022-09-25 06:31:51 INFO  # Optimization benchmark for data_corruption with args [['reviews', 'slow_loading', 'featurization_2', 'neural_network']] -- repetition 1 of 7
2022-09-25 06:31:51 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-25 06:31:51 INFO  Running instrumented original pipeline...
2022-09-25 06:31:51 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-25 06:31:51 INFO  ---RUNTIME: Importing and monkey-patching took 6.38127326965332 ms
2022-09-25 06:32:05 INFO  ---RUNTIME: Original pipeline execution took 13975.340843200684 ms (excluding imports and monkey-patching)
2022-09-25 06:32:05 INFO  Starting execution of 1 what-if analyses...
2022-09-25 06:32:05 INFO  Start plan generation for analysis DataCorruption...
2022-09-25 06:32:05 INFO  ---RUNTIME: Plan generation took 0.4754066467285156 ms
2022-09-25 06:32:05 INFO  Estimated runtime of original DAG is 13655.128955841064ms
2022-09-25 06:32:05 INFO  Performing Multi-Query Optimization
2022-09-25 06:32:05 INFO  Estimated unoptimized what-if runtime is 341378.2238960266ms
2022-09-25 06:32:05 INFO  Estimated optimised what-if runtime is 43032.925844192505ms
2022-09-25 06:32:05 INFO  Estimated optimisation runtime saving is 298345.2980518341ms
2022-09-25 06:32:05 INFO  ---RUNTIME: Multi-Query Optimization took 73.3041763305664 ms
2022-09-25 06:32:05 INFO  Executing generated plans
2022-09-25 06:32:51 INFO  ---RUNTIME: Execution took 45386.990547180176 ms
2022-09-25 06:32:51 INFO  Done!
2022-09-25 06:32:51 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-25 06:32:51 INFO  Running instrumented original pipeline...
2022-09-25 06:32:51 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-25 06:32:51 INFO  ---RUNTIME: Importing and monkey-patching took 6.473779678344727 ms
2022-09-25 06:33:05 INFO  ---RUNTIME: Original pipeline execution took 14076.585054397583 ms (excluding imports and monkey-patching)
2022-09-25 06:33:05 INFO  Starting execution of 1 what-if analyses...
2022-09-25 06:33:05 INFO  Start plan generation for analysis DataCorruption...
2022-09-25 06:33:05 INFO  ---RUNTIME: Plan generation took 1.0592937469482422 ms
2022-09-25 06:33:05 INFO  Estimated runtime of original DAG is 13754.67038154602ms
2022-09-25 06:33:05 WARNING Skipping Multi-Query Optimization (instead, only applying patches)
2022-09-25 06:33:05 INFO  Estimated unoptimised what-if runtime is 343866.7595386505ms
2022-09-25 06:33:05 INFO  ---RUNTIME: Multi-Query Optimization took 19.199371337890625 ms
2022-09-25 06:33:05 INFO  Executing generated plans
2022-09-25 06:38:46 INFO  ---RUNTIME: Execution took 341289.7319793701 ms
2022-09-25 06:38:46 INFO  Done!
2022-09-25 06:38:46 INFO  # Finished -- repetition 1 of 7 
2022-09-25 06:38:46 INFO  # Optimization benchmark for data_corruption with args [['reviews', 'slow_loading', 'featurization_2', 'neural_network']] -- repetition 2 of 7
2022-09-25 06:38:46 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-25 06:38:46 INFO  Running instrumented original pipeline...
2022-09-25 06:38:46 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-25 06:38:46 INFO  ---RUNTIME: Importing and monkey-patching took 6.890296936035156 ms
2022-09-25 06:39:00 INFO  ---RUNTIME: Original pipeline execution took 13719.631671905518 ms (excluding imports and monkey-patching)
2022-09-25 06:39:00 INFO  Starting execution of 1 what-if analyses...
2022-09-25 06:39:00 INFO  Start plan generation for analysis DataCorruption...
2022-09-25 06:39:00 INFO  ---RUNTIME: Plan generation took 0.39267539978027344 ms
2022-09-25 06:39:00 INFO  Estimated runtime of original DAG is 13408.245086669922ms
2022-09-25 06:39:00 INFO  Performing Multi-Query Optimization
2022-09-25 06:39:00 INFO  Estimated unoptimized what-if runtime is 335206.12716674805ms
2022-09-25 06:39:00 INFO  Estimated optimised what-if runtime is 39572.61919975281ms
2022-09-25 06:39:00 INFO  Estimated optimisation runtime saving is 295633.50796699524ms
2022-09-25 06:39:00 INFO  ---RUNTIME: Multi-Query Optimization took 66.24126434326172 ms
2022-09-25 06:39:00 INFO  Executing generated plans
2022-09-25 06:39:44 INFO  ---RUNTIME: Execution took 44151.48663520813 ms
2022-09-25 06:39:44 INFO  Done!
2022-09-25 06:39:44 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-25 06:39:44 INFO  Running instrumented original pipeline...
2022-09-25 06:39:44 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-25 06:39:44 INFO  ---RUNTIME: Importing and monkey-patching took 6.601810455322266 ms
2022-09-25 06:39:58 INFO  ---RUNTIME: Original pipeline execution took 13301.57446861267 ms (excluding imports and monkey-patching)
2022-09-25 06:39:58 INFO  Starting execution of 1 what-if analyses...
2022-09-25 06:39:58 INFO  Start plan generation for analysis DataCorruption...
2022-09-25 06:39:58 INFO  ---RUNTIME: Plan generation took 0.4169940948486328 ms
2022-09-25 06:39:58 INFO  Estimated runtime of original DAG is 12985.547065734863ms
2022-09-25 06:39:58 WARNING Skipping Multi-Query Optimization (instead, only applying patches)
2022-09-25 06:39:58 INFO  Estimated unoptimised what-if runtime is 324638.6766433716ms
2022-09-25 06:39:58 INFO  ---RUNTIME: Multi-Query Optimization took 19.750595092773438 ms
2022-09-25 06:39:58 INFO  Executing generated plans
2022-09-25 06:45:40 INFO  ---RUNTIME: Execution took 342620.0501918793 ms
2022-09-25 06:45:40 INFO  Done!
2022-09-25 06:45:40 INFO  # Finished -- repetition 2 of 7 
2022-09-25 06:45:40 INFO  # Optimization benchmark for data_corruption with args [['reviews', 'slow_loading', 'featurization_2', 'neural_network']] -- repetition 3 of 7
2022-09-25 06:45:40 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-25 06:45:40 INFO  Running instrumented original pipeline...
2022-09-25 06:45:40 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-25 06:45:40 INFO  ---RUNTIME: Importing and monkey-patching took 7.044076919555664 ms
2022-09-25 06:45:54 INFO  ---RUNTIME: Original pipeline execution took 13854.143381118774 ms (excluding imports and monkey-patching)
2022-09-25 06:45:54 INFO  Starting execution of 1 what-if analyses...
2022-09-25 06:45:54 INFO  Start plan generation for analysis DataCorruption...
2022-09-25 06:45:54 INFO  ---RUNTIME: Plan generation took 0.4112720489501953 ms
2022-09-25 06:45:54 INFO  Estimated runtime of original DAG is 13541.889905929565ms
2022-09-25 06:45:54 INFO  Performing Multi-Query Optimization
2022-09-25 06:45:54 INFO  Estimated unoptimized what-if runtime is 338547.24764823914ms
2022-09-25 06:45:54 INFO  Estimated optimised what-if runtime is 49830.67774772644ms
2022-09-25 06:45:54 INFO  Estimated optimisation runtime saving is 288716.5699005127ms
2022-09-25 06:45:54 INFO  ---RUNTIME: Multi-Query Optimization took 65.89674949645996 ms
2022-09-25 06:45:54 INFO  Executing generated plans
2022-09-25 06:46:37 INFO  ---RUNTIME: Execution took 42667.85001754761 ms
2022-09-25 06:46:37 INFO  Done!
2022-09-25 06:46:37 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-25 06:46:37 INFO  Running instrumented original pipeline...
2022-09-25 06:46:37 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-25 06:46:37 INFO  ---RUNTIME: Importing and monkey-patching took 6.484508514404297 ms
2022-09-25 06:46:50 INFO  ---RUNTIME: Original pipeline execution took 12825.544357299805 ms (excluding imports and monkey-patching)
2022-09-25 06:46:50 INFO  Starting execution of 1 what-if analyses...
2022-09-25 06:46:50 INFO  Start plan generation for analysis DataCorruption...
2022-09-25 06:46:50 INFO  ---RUNTIME: Plan generation took 0.4355907440185547 ms
2022-09-25 06:46:50 INFO  Estimated runtime of original DAG is 12494.075059890747ms
2022-09-25 06:46:50 WARNING Skipping Multi-Query Optimization (instead, only applying patches)
2022-09-25 06:46:50 INFO  Estimated unoptimised what-if runtime is 312351.8764972687ms
2022-09-25 06:46:50 INFO  ---RUNTIME: Multi-Query Optimization took 20.075082778930664 ms
2022-09-25 06:46:50 INFO  Executing generated plans
2022-09-25 06:52:31 INFO  ---RUNTIME: Execution took 341506.4797401428 ms
2022-09-25 06:52:31 INFO  Done!
2022-09-25 06:52:31 INFO  # Finished -- repetition 3 of 7 
2022-09-25 06:52:31 INFO  # Optimization benchmark for data_corruption with args [['reviews', 'slow_loading', 'featurization_2', 'neural_network']] -- repetition 4 of 7
2022-09-25 06:52:31 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-25 06:52:31 INFO  Running instrumented original pipeline...
2022-09-25 06:52:31 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-25 06:52:31 INFO  ---RUNTIME: Importing and monkey-patching took 7.826805114746094 ms
2022-09-25 06:52:45 INFO  ---RUNTIME: Original pipeline execution took 13857.588291168213 ms (excluding imports and monkey-patching)
2022-09-25 06:52:45 INFO  Starting execution of 1 what-if analyses...
2022-09-25 06:52:45 INFO  Start plan generation for analysis DataCorruption...
2022-09-25 06:52:45 INFO  ---RUNTIME: Plan generation took 0.4901885986328125 ms
2022-09-25 06:52:45 INFO  Estimated runtime of original DAG is 13533.013820648193ms
2022-09-25 06:52:45 INFO  Performing Multi-Query Optimization
2022-09-25 06:52:45 INFO  Estimated unoptimized what-if runtime is 338325.34551620483ms
2022-09-25 06:52:45 INFO  Estimated optimised what-if runtime is 39949.397563934326ms
2022-09-25 06:52:45 INFO  Estimated optimisation runtime saving is 298375.9479522705ms
2022-09-25 06:52:45 INFO  ---RUNTIME: Multi-Query Optimization took 73.87089729309082 ms
2022-09-25 06:52:45 INFO  Executing generated plans
2022-09-25 06:53:30 INFO  ---RUNTIME: Execution took 45028.13172340393 ms
2022-09-25 06:53:30 INFO  Done!
2022-09-25 06:53:30 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-25 06:53:30 INFO  Running instrumented original pipeline...
2022-09-25 06:53:31 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-25 06:53:31 INFO  ---RUNTIME: Importing and monkey-patching took 6.061792373657227 ms
2022-09-25 06:53:44 INFO  ---RUNTIME: Original pipeline execution took 13614.429473876953 ms (excluding imports and monkey-patching)
2022-09-25 06:53:44 INFO  Starting execution of 1 what-if analyses...
2022-09-25 06:53:44 INFO  Start plan generation for analysis DataCorruption...
2022-09-25 06:53:44 INFO  ---RUNTIME: Plan generation took 0.4558563232421875 ms
2022-09-25 06:53:44 INFO  Estimated runtime of original DAG is 12868.585109710693ms
2022-09-25 06:53:44 WARNING Skipping Multi-Query Optimization (instead, only applying patches)
2022-09-25 06:53:44 INFO  Estimated unoptimised what-if runtime is 321714.62774276733ms
2022-09-25 06:53:44 INFO  ---RUNTIME: Multi-Query Optimization took 20.632266998291016 ms
2022-09-25 06:53:44 INFO  Executing generated plans
2022-09-25 06:59:15 INFO  ---RUNTIME: Execution took 331069.0793991089 ms
2022-09-25 06:59:15 INFO  Done!
2022-09-25 06:59:15 INFO  # Finished -- repetition 4 of 7 
2022-09-25 06:59:15 INFO  # Optimization benchmark for data_corruption with args [['reviews', 'slow_loading', 'featurization_2', 'neural_network']] -- repetition 5 of 7
2022-09-25 06:59:15 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-25 06:59:15 INFO  Running instrumented original pipeline...
2022-09-25 06:59:15 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-25 06:59:15 INFO  ---RUNTIME: Importing and monkey-patching took 6.083965301513672 ms
2022-09-25 06:59:28 INFO  ---RUNTIME: Original pipeline execution took 13408.062934875488 ms (excluding imports and monkey-patching)
2022-09-25 06:59:28 INFO  Starting execution of 1 what-if analyses...
2022-09-25 06:59:28 INFO  Start plan generation for analysis DataCorruption...
2022-09-25 06:59:28 INFO  ---RUNTIME: Plan generation took 0.39696693420410156 ms
2022-09-25 06:59:28 INFO  Estimated runtime of original DAG is 13094.366073608398ms
2022-09-25 06:59:28 INFO  Performing Multi-Query Optimization
2022-09-25 06:59:28 INFO  Estimated unoptimized what-if runtime is 327359.15184020996ms
2022-09-25 06:59:28 INFO  Estimated optimised what-if runtime is 38116.63341522217ms
2022-09-25 06:59:28 INFO  Estimated optimisation runtime saving is 289242.5184249878ms
2022-09-25 06:59:28 INFO  ---RUNTIME: Multi-Query Optimization took 65.49263000488281 ms
2022-09-25 06:59:28 INFO  Executing generated plans
2022-09-25 07:00:10 INFO  ---RUNTIME: Execution took 41910.351276397705 ms
2022-09-25 07:00:10 INFO  Done!
2022-09-25 07:00:10 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-25 07:00:10 INFO  Running instrumented original pipeline...
2022-09-25 07:00:10 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-25 07:00:10 INFO  ---RUNTIME: Importing and monkey-patching took 6.423711776733398 ms
2022-09-25 07:00:23 INFO  ---RUNTIME: Original pipeline execution took 12656.728982925415 ms (excluding imports and monkey-patching)
2022-09-25 07:00:23 INFO  Starting execution of 1 what-if analyses...
2022-09-25 07:00:23 INFO  Start plan generation for analysis DataCorruption...
2022-09-25 07:00:23 INFO  ---RUNTIME: Plan generation took 0.4284381866455078 ms
2022-09-25 07:00:23 INFO  Estimated runtime of original DAG is 12347.363233566284ms
2022-09-25 07:00:23 WARNING Skipping Multi-Query Optimization (instead, only applying patches)
2022-09-25 07:00:23 INFO  Estimated unoptimised what-if runtime is 308684.0808391571ms
2022-09-25 07:00:23 INFO  ---RUNTIME: Multi-Query Optimization took 19.42157745361328 ms
2022-09-25 07:00:23 INFO  Executing generated plans
2022-09-25 07:05:47 INFO  ---RUNTIME: Execution took 324003.289937973 ms
2022-09-25 07:05:47 INFO  Done!
2022-09-25 07:05:47 INFO  # Finished -- repetition 5 of 7 
2022-09-25 07:05:47 INFO  # Optimization benchmark for data_corruption with args [['reviews', 'slow_loading', 'featurization_2', 'neural_network']] -- repetition 6 of 7
2022-09-25 07:05:47 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-25 07:05:47 INFO  Running instrumented original pipeline...
2022-09-25 07:05:47 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-25 07:05:47 INFO  ---RUNTIME: Importing and monkey-patching took 6.382942199707031 ms
2022-09-25 07:06:00 INFO  ---RUNTIME: Original pipeline execution took 12528.62286567688 ms (excluding imports and monkey-patching)
2022-09-25 07:06:00 INFO  Starting execution of 1 what-if analyses...
2022-09-25 07:06:00 INFO  Start plan generation for analysis DataCorruption...
2022-09-25 07:06:00 INFO  ---RUNTIME: Plan generation took 0.4124641418457031 ms
2022-09-25 07:06:00 INFO  Estimated runtime of original DAG is 12217.819452285767ms
2022-09-25 07:06:00 INFO  Performing Multi-Query Optimization
2022-09-25 07:06:00 INFO  Estimated unoptimized what-if runtime is 305445.48630714417ms
2022-09-25 07:06:00 INFO  Estimated optimised what-if runtime is 37109.93838310242ms
2022-09-25 07:06:00 INFO  Estimated optimisation runtime saving is 268335.54792404175ms
2022-09-25 07:06:00 INFO  ---RUNTIME: Multi-Query Optimization took 64.88656997680664 ms
2022-09-25 07:06:00 INFO  Executing generated plans
2022-09-25 07:06:41 INFO  ---RUNTIME: Execution took 40905.81727027893 ms
2022-09-25 07:06:41 INFO  Done!
2022-09-25 07:06:41 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-25 07:06:41 INFO  Running instrumented original pipeline...
2022-09-25 07:06:41 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-25 07:06:41 INFO  ---RUNTIME: Importing and monkey-patching took 7.530689239501953 ms
2022-09-25 07:06:54 INFO  ---RUNTIME: Original pipeline execution took 12937.790155410767 ms (excluding imports and monkey-patching)
2022-09-25 07:06:54 INFO  Starting execution of 1 what-if analyses...
2022-09-25 07:06:54 INFO  Start plan generation for analysis DataCorruption...
2022-09-25 07:06:54 INFO  ---RUNTIME: Plan generation took 0.431060791015625 ms
2022-09-25 07:06:54 INFO  Estimated runtime of original DAG is 12209.455251693726ms
2022-09-25 07:06:54 WARNING Skipping Multi-Query Optimization (instead, only applying patches)
2022-09-25 07:06:54 INFO  Estimated unoptimised what-if runtime is 305236.38129234314ms
2022-09-25 07:06:54 INFO  ---RUNTIME: Multi-Query Optimization took 19.872426986694336 ms
2022-09-25 07:06:54 INFO  Executing generated plans
2022-09-25 07:12:16 INFO  ---RUNTIME: Execution took 322201.96986198425 ms
2022-09-25 07:12:16 INFO  Done!
2022-09-25 07:12:16 INFO  # Finished -- repetition 6 of 7 
2022-09-25 07:12:16 INFO  # Optimization benchmark for data_corruption with args [['reviews', 'slow_loading', 'featurization_2', 'neural_network']] -- repetition 7 of 7
2022-09-25 07:12:16 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-25 07:12:16 INFO  Running instrumented original pipeline...
2022-09-25 07:12:16 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-25 07:12:16 INFO  ---RUNTIME: Importing and monkey-patching took 6.881237030029297 ms
2022-09-25 07:12:28 INFO  ---RUNTIME: Original pipeline execution took 12581.616878509521 ms (excluding imports and monkey-patching)
2022-09-25 07:12:28 INFO  Starting execution of 1 what-if analyses...
2022-09-25 07:12:28 INFO  Start plan generation for analysis DataCorruption...
2022-09-25 07:12:28 INFO  ---RUNTIME: Plan generation took 0.4246234893798828 ms
2022-09-25 07:12:28 INFO  Estimated runtime of original DAG is 12270.862579345703ms
2022-09-25 07:12:28 INFO  Performing Multi-Query Optimization
2022-09-25 07:12:29 INFO  Estimated unoptimized what-if runtime is 306771.5644836426ms
2022-09-25 07:12:29 INFO  Estimated optimised what-if runtime is 38458.67371559143ms
2022-09-25 07:12:29 INFO  Estimated optimisation runtime saving is 268312.89076805115ms
2022-09-25 07:12:29 INFO  ---RUNTIME: Multi-Query Optimization took 482.7537536621094 ms
2022-09-25 07:12:29 INFO  Executing generated plans
2022-09-25 07:13:10 INFO  ---RUNTIME: Execution took 41645.973205566406 ms
2022-09-25 07:13:10 INFO  Done!
2022-09-25 07:13:11 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-25 07:13:11 INFO  Running instrumented original pipeline...
2022-09-25 07:13:11 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-25 07:13:11 INFO  ---RUNTIME: Importing and monkey-patching took 6.546974182128906 ms
2022-09-25 07:13:23 INFO  ---RUNTIME: Original pipeline execution took 12563.488960266113 ms (excluding imports and monkey-patching)
2022-09-25 07:13:23 INFO  Starting execution of 1 what-if analyses...
2022-09-25 07:13:23 INFO  Start plan generation for analysis DataCorruption...
2022-09-25 07:13:23 INFO  ---RUNTIME: Plan generation took 1.4455318450927734 ms
2022-09-25 07:13:23 INFO  Estimated runtime of original DAG is 12250.482559204102ms
2022-09-25 07:13:23 WARNING Skipping Multi-Query Optimization (instead, only applying patches)
2022-09-25 07:13:23 INFO  Estimated unoptimised what-if runtime is 306262.06398010254ms
2022-09-25 07:13:23 INFO  ---RUNTIME: Multi-Query Optimization took 19.27971839904785 ms
2022-09-25 07:13:23 INFO  Executing generated plans
2022-09-25 07:18:47 INFO  ---RUNTIME: Execution took 323708.08839797974 ms
2022-09-25 07:18:47 INFO  Done!
2022-09-25 07:18:47 INFO  # Finished -- repetition 7 of 7 
2022-09-25 07:18:47 INFO  # Final results after all repetitions
2022-09-25 07:18:47 INFO     repetition  ... no_opt_what_if_execution_combined_model_training
0           0  ...                                    155762.301683
1           1  ...                                    157805.908680
2           2  ...                                    156006.531000
3           3  ...                                    149649.324417
4           4  ...                                    145198.555708
5           5  ...                                    144848.103762
6           6  ...                                    144938.317776

[7 rows x 26 columns]
PROTOCOL_BUFFERS_PYTHON_IMPLEMENTATION=python taskset -c 32-39 python3.9 benchmarks_end_to_end.py data_corruption reviews slow_loading featurization_3 logistic_regression
2022-09-25 07:18:49.902112: W tensorflow/stream_executor/platform/default/dso_loader.cc:64] Could not load dynamic library 'libcudart.so.11.0'; dlerror: libcudart.so.11.0: cannot open shared object file: No such file or directory; LD_LIBRARY_PATH: /home/sgrafbe/mlwhatif/venv/lib/python3.9/site-packages/cv2/../../lib64:
2022-09-25 07:18:49.902156: I tensorflow/stream_executor/cuda/cudart_stub.cc:29] Ignore above cudart dlerror if you do not have a GPU set up on your machine.
2022-09-25 07:18:51 INFO  Patching sys.argv with ['mlwhatif', 'reviews', 'slow_loading', 'featurization_3', 'logistic_regression']
2022-09-25 07:18:51 INFO  Running instrumented original pipeline...
2022-09-25 07:18:51 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-25 07:18:51 INFO  ---RUNTIME: Importing and monkey-patching took 95.3819751739502 ms
2022-09-25 07:19:01 INFO  ---RUNTIME: Original pipeline execution took 10019.67453956604 ms (excluding imports and monkey-patching)
2022-09-25 07:19:01 INFO  Starting execution of 0 what-if analyses...
2022-09-25 07:19:01 INFO  Estimated runtime of original DAG is 9626.270055770874ms
2022-09-25 07:19:01 INFO  Performing Multi-Query Optimization
2022-09-25 07:19:01 INFO  Estimated unoptimized what-if runtime is 0ms
2022-09-25 07:19:01 INFO  Estimated optimised what-if runtime is 0ms
2022-09-25 07:19:01 INFO  Estimated optimisation runtime saving is 0ms
2022-09-25 07:19:01 INFO  ---RUNTIME: Multi-Query Optimization took 0.6148815155029297 ms
2022-09-25 07:19:01 INFO  Executing generated plans
2022-09-25 07:19:01 INFO  ---RUNTIME: Execution took 0.030279159545898438 ms
2022-09-25 07:19:01 INFO  Done!
2022-09-25 07:19:01 INFO  # Optimization benchmark for data_corruption with args [['reviews', 'slow_loading', 'featurization_3', 'logistic_regression']] -- repetition 1 of 7
2022-09-25 07:19:01 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-25 07:19:01 INFO  Running instrumented original pipeline...
2022-09-25 07:19:01 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-25 07:19:01 INFO  ---RUNTIME: Importing and monkey-patching took 5.906343460083008 ms
2022-09-25 07:19:11 INFO  ---RUNTIME: Original pipeline execution took 9930.3138256073 ms (excluding imports and monkey-patching)
2022-09-25 07:19:11 INFO  Starting execution of 1 what-if analyses...
2022-09-25 07:19:11 INFO  Start plan generation for analysis DataCorruption...
2022-09-25 07:19:11 INFO  ---RUNTIME: Plan generation took 0.45680999755859375 ms
2022-09-25 07:19:11 INFO  Estimated runtime of original DAG is 9572.76201248169ms
2022-09-25 07:19:11 INFO  Performing Multi-Query Optimization
2022-09-25 07:19:11 INFO  Estimated unoptimized what-if runtime is 239319.05031204224ms
2022-09-25 07:19:11 INFO  Estimated optimised what-if runtime is 26886.136770248413ms
2022-09-25 07:19:11 INFO  Estimated optimisation runtime saving is 212432.91354179382ms
2022-09-25 07:19:11 INFO  ---RUNTIME: Multi-Query Optimization took 82.20911026000977 ms
2022-09-25 07:19:11 INFO  Executing generated plans
2022-09-25 07:19:44 INFO  ---RUNTIME: Execution took 32936.19394302368 ms
2022-09-25 07:19:44 INFO  Done!
2022-09-25 07:19:44 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-25 07:19:44 INFO  Running instrumented original pipeline...
2022-09-25 07:19:44 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-25 07:19:44 INFO  ---RUNTIME: Importing and monkey-patching took 5.916357040405273 ms
2022-09-25 07:19:55 INFO  ---RUNTIME: Original pipeline execution took 10828.248023986816 ms (excluding imports and monkey-patching)
2022-09-25 07:19:55 INFO  Starting execution of 1 what-if analyses...
2022-09-25 07:19:55 INFO  Start plan generation for analysis DataCorruption...
2022-09-25 07:19:55 INFO  ---RUNTIME: Plan generation took 1.3854503631591797 ms
2022-09-25 07:19:55 INFO  Estimated runtime of original DAG is 10228.687286376953ms
2022-09-25 07:19:55 WARNING Skipping Multi-Query Optimization (instead, only applying patches)
2022-09-25 07:19:55 INFO  Estimated unoptimised what-if runtime is 255717.18215942383ms
2022-09-25 07:19:55 INFO  ---RUNTIME: Multi-Query Optimization took 22.948503494262695 ms
2022-09-25 07:19:55 INFO  Executing generated plans
2022-09-25 07:24:08 INFO  ---RUNTIME: Execution took 253774.5339870453 ms
2022-09-25 07:24:08 INFO  Done!
2022-09-25 07:24:08 INFO  # Finished -- repetition 1 of 7 
2022-09-25 07:24:08 INFO  # Optimization benchmark for data_corruption with args [['reviews', 'slow_loading', 'featurization_3', 'logistic_regression']] -- repetition 2 of 7
2022-09-25 07:24:08 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-25 07:24:08 INFO  Running instrumented original pipeline...
2022-09-25 07:24:08 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-25 07:24:08 INFO  ---RUNTIME: Importing and monkey-patching took 6.26373291015625 ms
2022-09-25 07:24:18 INFO  ---RUNTIME: Original pipeline execution took 9922.884464263916 ms (excluding imports and monkey-patching)
2022-09-25 07:24:18 INFO  Starting execution of 1 what-if analyses...
2022-09-25 07:24:18 INFO  Start plan generation for analysis DataCorruption...
2022-09-25 07:24:18 INFO  ---RUNTIME: Plan generation took 1.4014244079589844 ms
2022-09-25 07:24:18 INFO  Estimated runtime of original DAG is 9564.222574234009ms
2022-09-25 07:24:18 INFO  Performing Multi-Query Optimization
2022-09-25 07:24:18 INFO  Estimated unoptimized what-if runtime is 239105.56435585022ms
2022-09-25 07:24:18 INFO  Estimated optimised what-if runtime is 26735.545873641968ms
2022-09-25 07:24:18 INFO  Estimated optimisation runtime saving is 212370.01848220825ms
2022-09-25 07:24:18 INFO  ---RUNTIME: Multi-Query Optimization took 82.11708068847656 ms
2022-09-25 07:24:18 INFO  Executing generated plans
2022-09-25 07:24:51 INFO  ---RUNTIME: Execution took 32792.800188064575 ms
2022-09-25 07:24:51 INFO  Done!
2022-09-25 07:24:51 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-25 07:24:51 INFO  Running instrumented original pipeline...
2022-09-25 07:24:51 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-25 07:24:51 INFO  ---RUNTIME: Importing and monkey-patching took 6.422519683837891 ms
2022-09-25 07:25:02 INFO  ---RUNTIME: Original pipeline execution took 10584.396123886108 ms (excluding imports and monkey-patching)
2022-09-25 07:25:02 INFO  Starting execution of 1 what-if analyses...
2022-09-25 07:25:02 INFO  Start plan generation for analysis DataCorruption...
2022-09-25 07:25:02 INFO  ---RUNTIME: Plan generation took 0.4191398620605469 ms
2022-09-25 07:25:02 INFO  Estimated runtime of original DAG is 10234.476566314697ms
2022-09-25 07:25:02 WARNING Skipping Multi-Query Optimization (instead, only applying patches)
2022-09-25 07:25:02 INFO  Estimated unoptimised what-if runtime is 255861.91415786743ms
2022-09-25 07:25:02 INFO  ---RUNTIME: Multi-Query Optimization took 27.979135513305664 ms
2022-09-25 07:25:02 INFO  Executing generated plans
2022-09-25 07:29:15 INFO  ---RUNTIME: Execution took 253165.27724266052 ms
2022-09-25 07:29:15 INFO  Done!
2022-09-25 07:29:15 INFO  # Finished -- repetition 2 of 7 
2022-09-25 07:29:15 INFO  # Optimization benchmark for data_corruption with args [['reviews', 'slow_loading', 'featurization_3', 'logistic_regression']] -- repetition 3 of 7
2022-09-25 07:29:15 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-25 07:29:15 INFO  Running instrumented original pipeline...
2022-09-25 07:29:15 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-25 07:29:15 INFO  ---RUNTIME: Importing and monkey-patching took 6.412029266357422 ms
2022-09-25 07:29:25 INFO  ---RUNTIME: Original pipeline execution took 9902.13418006897 ms (excluding imports and monkey-patching)
2022-09-25 07:29:25 INFO  Starting execution of 1 what-if analyses...
2022-09-25 07:29:25 INFO  Start plan generation for analysis DataCorruption...
2022-09-25 07:29:25 INFO  ---RUNTIME: Plan generation took 0.4420280456542969 ms
2022-09-25 07:29:25 INFO  Estimated runtime of original DAG is 9555.06682395935ms
2022-09-25 07:29:25 INFO  Performing Multi-Query Optimization
2022-09-25 07:29:25 INFO  Estimated unoptimized what-if runtime is 238876.67059898376ms
2022-09-25 07:29:25 INFO  Estimated optimised what-if runtime is 26648.250579833984ms
2022-09-25 07:29:25 INFO  Estimated optimisation runtime saving is 212228.42001914978ms
2022-09-25 07:29:25 INFO  ---RUNTIME: Multi-Query Optimization took 82.47900009155273 ms
2022-09-25 07:29:25 INFO  Executing generated plans
2022-09-25 07:29:58 INFO  ---RUNTIME: Execution took 32805.54175376892 ms
2022-09-25 07:29:58 INFO  Done!
2022-09-25 07:29:58 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-25 07:29:58 INFO  Running instrumented original pipeline...
2022-09-25 07:29:58 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-25 07:29:58 INFO  ---RUNTIME: Importing and monkey-patching took 5.907297134399414 ms
2022-09-25 07:30:09 INFO  ---RUNTIME: Original pipeline execution took 10870.77283859253 ms (excluding imports and monkey-patching)
2022-09-25 07:30:09 INFO  Starting execution of 1 what-if analyses...
2022-09-25 07:30:09 INFO  Start plan generation for analysis DataCorruption...
2022-09-25 07:30:09 INFO  ---RUNTIME: Plan generation took 0.4143714904785156 ms
2022-09-25 07:30:09 INFO  Estimated runtime of original DAG is 10203.43542098999ms
2022-09-25 07:30:09 WARNING Skipping Multi-Query Optimization (instead, only applying patches)
2022-09-25 07:30:09 INFO  Estimated unoptimised what-if runtime is 255085.88552474976ms
2022-09-25 07:30:09 INFO  ---RUNTIME: Multi-Query Optimization took 27.696609497070312 ms
2022-09-25 07:30:09 INFO  Executing generated plans
2022-09-25 07:34:23 INFO  ---RUNTIME: Execution took 253776.42583847046 ms
2022-09-25 07:34:23 INFO  Done!
2022-09-25 07:34:23 INFO  # Finished -- repetition 3 of 7 
2022-09-25 07:34:23 INFO  # Optimization benchmark for data_corruption with args [['reviews', 'slow_loading', 'featurization_3', 'logistic_regression']] -- repetition 4 of 7
2022-09-25 07:34:23 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-25 07:34:23 INFO  Running instrumented original pipeline...
2022-09-25 07:34:23 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-25 07:34:23 INFO  ---RUNTIME: Importing and monkey-patching took 6.430864334106445 ms
2022-09-25 07:34:33 INFO  ---RUNTIME: Original pipeline execution took 9938.118696212769 ms (excluding imports and monkey-patching)
2022-09-25 07:34:33 INFO  Starting execution of 1 what-if analyses...
2022-09-25 07:34:33 INFO  Start plan generation for analysis DataCorruption...
2022-09-25 07:34:33 INFO  ---RUNTIME: Plan generation took 0.45228004455566406 ms
2022-09-25 07:34:33 INFO  Estimated runtime of original DAG is 9586.306810379028ms
2022-09-25 07:34:33 INFO  Performing Multi-Query Optimization
2022-09-25 07:34:33 INFO  Estimated unoptimized what-if runtime is 239657.6702594757ms
2022-09-25 07:34:33 INFO  Estimated optimised what-if runtime is 26777.818202972412ms
2022-09-25 07:34:33 INFO  Estimated optimisation runtime saving is 212879.8520565033ms
2022-09-25 07:34:33 INFO  ---RUNTIME: Multi-Query Optimization took 82.10635185241699 ms
2022-09-25 07:34:33 INFO  Executing generated plans
2022-09-25 07:35:06 INFO  ---RUNTIME: Execution took 32887.80689239502 ms
2022-09-25 07:35:06 INFO  Done!
2022-09-25 07:35:06 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-25 07:35:06 INFO  Running instrumented original pipeline...
2022-09-25 07:35:06 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-25 07:35:06 INFO  ---RUNTIME: Importing and monkey-patching took 6.408452987670898 ms
2022-09-25 07:35:16 INFO  ---RUNTIME: Original pipeline execution took 10531.97455406189 ms (excluding imports and monkey-patching)
2022-09-25 07:35:16 INFO  Starting execution of 1 what-if analyses...
2022-09-25 07:35:16 INFO  Start plan generation for analysis DataCorruption...
2022-09-25 07:35:16 INFO  ---RUNTIME: Plan generation took 0.42128562927246094 ms
2022-09-25 07:35:16 INFO  Estimated runtime of original DAG is 10180.084705352783ms
2022-09-25 07:35:16 WARNING Skipping Multi-Query Optimization (instead, only applying patches)
2022-09-25 07:35:16 INFO  Estimated unoptimised what-if runtime is 254502.11763381958ms
2022-09-25 07:35:16 INFO  ---RUNTIME: Multi-Query Optimization took 27.824878692626953 ms
2022-09-25 07:35:16 INFO  Executing generated plans
2022-09-25 07:39:30 INFO  ---RUNTIME: Execution took 253985.24594306946 ms
2022-09-25 07:39:30 INFO  Done!
2022-09-25 07:39:30 INFO  # Finished -- repetition 4 of 7 
2022-09-25 07:39:30 INFO  # Optimization benchmark for data_corruption with args [['reviews', 'slow_loading', 'featurization_3', 'logistic_regression']] -- repetition 5 of 7
2022-09-25 07:39:30 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-25 07:39:30 INFO  Running instrumented original pipeline...
2022-09-25 07:39:30 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-25 07:39:30 INFO  ---RUNTIME: Importing and monkey-patching took 6.299018859863281 ms
2022-09-25 07:39:40 INFO  ---RUNTIME: Original pipeline execution took 9943.291425704956 ms (excluding imports and monkey-patching)
2022-09-25 07:39:40 INFO  Starting execution of 1 what-if analyses...
2022-09-25 07:39:40 INFO  Start plan generation for analysis DataCorruption...
2022-09-25 07:39:40 INFO  ---RUNTIME: Plan generation took 0.4284381866455078 ms
2022-09-25 07:39:40 INFO  Estimated runtime of original DAG is 9583.487272262573ms
2022-09-25 07:39:40 INFO  Performing Multi-Query Optimization
2022-09-25 07:39:40 INFO  Estimated unoptimized what-if runtime is 239587.18180656433ms
2022-09-25 07:39:40 INFO  Estimated optimised what-if runtime is 26796.133995056152ms
2022-09-25 07:39:40 INFO  Estimated optimisation runtime saving is 212791.04781150818ms
2022-09-25 07:39:40 INFO  ---RUNTIME: Multi-Query Optimization took 81.05111122131348 ms
2022-09-25 07:39:40 INFO  Executing generated plans
2022-09-25 07:40:13 INFO  ---RUNTIME: Execution took 32771.18921279907 ms
2022-09-25 07:40:13 INFO  Done!
2022-09-25 07:40:13 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-25 07:40:13 INFO  Running instrumented original pipeline...
2022-09-25 07:40:13 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-25 07:40:13 INFO  ---RUNTIME: Importing and monkey-patching took 6.147861480712891 ms
2022-09-25 07:40:24 INFO  ---RUNTIME: Original pipeline execution took 10533.971548080444 ms (excluding imports and monkey-patching)
2022-09-25 07:40:24 INFO  Starting execution of 1 what-if analyses...
2022-09-25 07:40:24 INFO  Start plan generation for analysis DataCorruption...
2022-09-25 07:40:24 INFO  ---RUNTIME: Plan generation took 0.423431396484375 ms
2022-09-25 07:40:24 INFO  Estimated runtime of original DAG is 10187.580585479736ms
2022-09-25 07:40:24 WARNING Skipping Multi-Query Optimization (instead, only applying patches)
2022-09-25 07:40:24 INFO  Estimated unoptimised what-if runtime is 254689.5146369934ms
2022-09-25 07:40:24 INFO  ---RUNTIME: Multi-Query Optimization took 27.56786346435547 ms
2022-09-25 07:40:24 INFO  Executing generated plans
2022-09-25 07:44:38 INFO  ---RUNTIME: Execution took 254197.26991653442 ms
2022-09-25 07:44:38 INFO  Done!
2022-09-25 07:44:38 INFO  # Finished -- repetition 5 of 7 
2022-09-25 07:44:38 INFO  # Optimization benchmark for data_corruption with args [['reviews', 'slow_loading', 'featurization_3', 'logistic_regression']] -- repetition 6 of 7
2022-09-25 07:44:38 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-25 07:44:38 INFO  Running instrumented original pipeline...
2022-09-25 07:44:38 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-25 07:44:38 INFO  ---RUNTIME: Importing and monkey-patching took 6.163358688354492 ms
2022-09-25 07:44:48 INFO  ---RUNTIME: Original pipeline execution took 9948.073387145996 ms (excluding imports and monkey-patching)
2022-09-25 07:44:48 INFO  Starting execution of 1 what-if analyses...
2022-09-25 07:44:48 INFO  Start plan generation for analysis DataCorruption...
2022-09-25 07:44:48 INFO  ---RUNTIME: Plan generation took 0.4413127899169922 ms
2022-09-25 07:44:48 INFO  Estimated runtime of original DAG is 9598.17123413086ms
2022-09-25 07:44:48 INFO  Performing Multi-Query Optimization
2022-09-25 07:44:48 INFO  Estimated unoptimized what-if runtime is 239954.28085327148ms
2022-09-25 07:44:48 INFO  Estimated optimised what-if runtime is 26783.529043197632ms
2022-09-25 07:44:48 INFO  Estimated optimisation runtime saving is 213170.75181007385ms
2022-09-25 07:44:48 INFO  ---RUNTIME: Multi-Query Optimization took 80.65915107727051 ms
2022-09-25 07:44:48 INFO  Executing generated plans
2022-09-25 07:45:21 INFO  ---RUNTIME: Execution took 32937.674045562744 ms
2022-09-25 07:45:21 INFO  Done!
2022-09-25 07:45:21 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-25 07:45:21 INFO  Running instrumented original pipeline...
2022-09-25 07:45:21 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-25 07:45:21 INFO  ---RUNTIME: Importing and monkey-patching took 6.375551223754883 ms
2022-09-25 07:45:32 INFO  ---RUNTIME: Original pipeline execution took 10497.360944747925 ms (excluding imports and monkey-patching)
2022-09-25 07:45:32 INFO  Starting execution of 1 what-if analyses...
2022-09-25 07:45:32 INFO  Start plan generation for analysis DataCorruption...
2022-09-25 07:45:32 INFO  ---RUNTIME: Plan generation took 0.4642009735107422 ms
2022-09-25 07:45:32 INFO  Estimated runtime of original DAG is 10146.004915237427ms
2022-09-25 07:45:32 WARNING Skipping Multi-Query Optimization (instead, only applying patches)
2022-09-25 07:45:32 INFO  Estimated unoptimised what-if runtime is 253650.12288093567ms
2022-09-25 07:45:32 INFO  ---RUNTIME: Multi-Query Optimization took 26.779651641845703 ms
2022-09-25 07:45:32 INFO  Executing generated plans
2022-09-25 07:49:46 INFO  ---RUNTIME: Execution took 254001.64914131165 ms
2022-09-25 07:49:46 INFO  Done!
2022-09-25 07:49:46 INFO  # Finished -- repetition 6 of 7 
2022-09-25 07:49:46 INFO  # Optimization benchmark for data_corruption with args [['reviews', 'slow_loading', 'featurization_3', 'logistic_regression']] -- repetition 7 of 7
2022-09-25 07:49:46 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-25 07:49:46 INFO  Running instrumented original pipeline...
2022-09-25 07:49:46 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-25 07:49:46 INFO  ---RUNTIME: Importing and monkey-patching took 6.320953369140625 ms
2022-09-25 07:49:56 INFO  ---RUNTIME: Original pipeline execution took 9926.793575286865 ms (excluding imports and monkey-patching)
2022-09-25 07:49:56 INFO  Starting execution of 1 what-if analyses...
2022-09-25 07:49:56 INFO  Start plan generation for analysis DataCorruption...
2022-09-25 07:49:56 INFO  ---RUNTIME: Plan generation took 0.42319297790527344 ms
2022-09-25 07:49:56 INFO  Estimated runtime of original DAG is 9562.12568283081ms
2022-09-25 07:49:56 INFO  Performing Multi-Query Optimization
2022-09-25 07:49:56 INFO  Estimated unoptimized what-if runtime is 239053.14207077026ms
2022-09-25 07:49:56 INFO  Estimated optimised what-if runtime is 26718.230962753296ms
2022-09-25 07:49:56 INFO  Estimated optimisation runtime saving is 212334.91110801697ms
2022-09-25 07:49:56 INFO  ---RUNTIME: Multi-Query Optimization took 80.80339431762695 ms
2022-09-25 07:49:56 INFO  Executing generated plans
2022-09-25 07:50:28 INFO  ---RUNTIME: Execution took 32733.883142471313 ms
2022-09-25 07:50:28 INFO  Done!
2022-09-25 07:50:28 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-25 07:50:28 INFO  Running instrumented original pipeline...
2022-09-25 07:50:28 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-25 07:50:28 INFO  ---RUNTIME: Importing and monkey-patching took 6.073713302612305 ms
2022-09-25 07:50:39 INFO  ---RUNTIME: Original pipeline execution took 10545.89867591858 ms (excluding imports and monkey-patching)
2022-09-25 07:50:39 INFO  Starting execution of 1 what-if analyses...
2022-09-25 07:50:39 INFO  Start plan generation for analysis DataCorruption...
2022-09-25 07:50:39 INFO  ---RUNTIME: Plan generation took 5.299806594848633 ms
2022-09-25 07:50:39 INFO  Estimated runtime of original DAG is 10197.07703590393ms
2022-09-25 07:50:39 WARNING Skipping Multi-Query Optimization (instead, only applying patches)
2022-09-25 07:50:39 INFO  Estimated unoptimised what-if runtime is 254926.92589759827ms
2022-09-25 07:50:39 INFO  ---RUNTIME: Multi-Query Optimization took 22.132158279418945 ms
2022-09-25 07:50:39 INFO  Executing generated plans
2022-09-25 07:54:53 INFO  ---RUNTIME: Execution took 253919.85630989075 ms
2022-09-25 07:54:53 INFO  Done!
2022-09-25 07:54:53 INFO  # Finished -- repetition 7 of 7 
2022-09-25 07:54:53 INFO  # Final results after all repetitions
2022-09-25 07:54:53 INFO     repetition  ... no_opt_what_if_execution_combined_model_training
0           0  ...                                      2467.873096
1           1  ...                                      2569.589615
2           2  ...                                      2451.486826
3           3  ...                                      2569.039822
4           4  ...                                      2358.409643
5           5  ...                                      2472.176075
6           6  ...                                      2440.167904

[7 rows x 26 columns]
PROTOCOL_BUFFERS_PYTHON_IMPLEMENTATION=python taskset -c 32-39 python3.9 benchmarks_end_to_end.py data_corruption reviews slow_loading featurization_3 xgboost
2022-09-25 07:54:55.917719: W tensorflow/stream_executor/platform/default/dso_loader.cc:64] Could not load dynamic library 'libcudart.so.11.0'; dlerror: libcudart.so.11.0: cannot open shared object file: No such file or directory; LD_LIBRARY_PATH: /home/sgrafbe/mlwhatif/venv/lib/python3.9/site-packages/cv2/../../lib64:
2022-09-25 07:54:55.917762: I tensorflow/stream_executor/cuda/cudart_stub.cc:29] Ignore above cudart dlerror if you do not have a GPU set up on your machine.
2022-09-25 07:54:57 INFO  Patching sys.argv with ['mlwhatif', 'reviews', 'slow_loading', 'featurization_3', 'xgboost']
2022-09-25 07:54:57 INFO  Running instrumented original pipeline...
2022-09-25 07:54:57 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-25 07:54:57 INFO  ---RUNTIME: Importing and monkey-patching took 96.1151123046875 ms
2022-09-25 07:55:41 INFO  ---RUNTIME: Original pipeline execution took 43884.214639663696 ms (excluding imports and monkey-patching)
2022-09-25 07:55:41 INFO  Starting execution of 0 what-if analyses...
2022-09-25 07:55:41 INFO  Estimated runtime of original DAG is 43509.721517562866ms
2022-09-25 07:55:41 INFO  Performing Multi-Query Optimization
2022-09-25 07:55:41 INFO  Estimated unoptimized what-if runtime is 0ms
2022-09-25 07:55:41 INFO  Estimated optimised what-if runtime is 0ms
2022-09-25 07:55:41 INFO  Estimated optimisation runtime saving is 0ms
2022-09-25 07:55:41 INFO  ---RUNTIME: Multi-Query Optimization took 0.55694580078125 ms
2022-09-25 07:55:41 INFO  Executing generated plans
2022-09-25 07:55:41 INFO  ---RUNTIME: Execution took 0.027418136596679688 ms
2022-09-25 07:55:41 INFO  Done!
2022-09-25 07:55:41 INFO  # Optimization benchmark for data_corruption with args [['reviews', 'slow_loading', 'featurization_3', 'xgboost']] -- repetition 1 of 7
2022-09-25 07:55:41 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-25 07:55:41 INFO  Running instrumented original pipeline...
2022-09-25 07:55:41 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-25 07:55:41 INFO  ---RUNTIME: Importing and monkey-patching took 6.0138702392578125 ms
2022-09-25 07:56:25 INFO  ---RUNTIME: Original pipeline execution took 44303.28917503357 ms (excluding imports and monkey-patching)
2022-09-25 07:56:25 INFO  Starting execution of 1 what-if analyses...
2022-09-25 07:56:25 INFO  Start plan generation for analysis DataCorruption...
2022-09-25 07:56:25 INFO  ---RUNTIME: Plan generation took 1.2624263763427734 ms
2022-09-25 07:56:25 INFO  Estimated runtime of original DAG is 43952.211141586304ms
2022-09-25 07:56:25 INFO  Performing Multi-Query Optimization
2022-09-25 07:56:25 INFO  Estimated unoptimized what-if runtime is 1098805.2785396576ms
2022-09-25 07:56:25 INFO  Estimated optimised what-if runtime is 69638.69714736938ms
2022-09-25 07:56:25 INFO  Estimated optimisation runtime saving is 1029166.5813922882ms
2022-09-25 07:56:25 INFO  ---RUNTIME: Multi-Query Optimization took 81.24566078186035 ms
2022-09-25 07:56:25 INFO  Executing generated plans
2022-09-25 07:57:39 INFO  ---RUNTIME: Execution took 74332.12161064148 ms
2022-09-25 07:57:39 INFO  Done!
2022-09-25 07:57:39 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-25 07:57:39 INFO  Running instrumented original pipeline...
2022-09-25 07:57:40 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-25 07:57:40 INFO  ---RUNTIME: Importing and monkey-patching took 5.92041015625 ms
2022-09-25 07:58:23 INFO  ---RUNTIME: Original pipeline execution took 43880.42211532593 ms (excluding imports and monkey-patching)
2022-09-25 07:58:23 INFO  Starting execution of 1 what-if analyses...
2022-09-25 07:58:23 INFO  Start plan generation for analysis DataCorruption...
2022-09-25 07:58:23 INFO  ---RUNTIME: Plan generation took 2.736330032348633 ms
2022-09-25 07:58:23 INFO  Estimated runtime of original DAG is 43316.79439544678ms
2022-09-25 07:58:23 WARNING Skipping Multi-Query Optimization (instead, only applying patches)
2022-09-25 07:58:23 INFO  Estimated unoptimised what-if runtime is 1082919.8598861694ms
2022-09-25 07:58:23 INFO  ---RUNTIME: Multi-Query Optimization took 27.378320693969727 ms
2022-09-25 07:58:23 INFO  Executing generated plans
2022-09-25 08:16:39 INFO  ---RUNTIME: Execution took 1096135.950088501 ms
2022-09-25 08:16:39 INFO  Done!
2022-09-25 08:16:39 INFO  # Finished -- repetition 1 of 7 
2022-09-25 08:16:39 INFO  # Optimization benchmark for data_corruption with args [['reviews', 'slow_loading', 'featurization_3', 'xgboost']] -- repetition 2 of 7
2022-09-25 08:16:39 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-25 08:16:39 INFO  Running instrumented original pipeline...
2022-09-25 08:16:40 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-25 08:16:40 INFO  ---RUNTIME: Importing and monkey-patching took 6.321907043457031 ms
2022-09-25 08:17:24 INFO  ---RUNTIME: Original pipeline execution took 44299.51524734497 ms (excluding imports and monkey-patching)
2022-09-25 08:17:24 INFO  Starting execution of 1 what-if analyses...
2022-09-25 08:17:24 INFO  Start plan generation for analysis DataCorruption...
2022-09-25 08:17:24 INFO  ---RUNTIME: Plan generation took 1.2693405151367188 ms
2022-09-25 08:17:24 INFO  Estimated runtime of original DAG is 43959.38038825989ms
2022-09-25 08:17:24 INFO  Performing Multi-Query Optimization
2022-09-25 08:17:24 INFO  Estimated unoptimized what-if runtime is 1098984.5097064972ms
2022-09-25 08:17:24 INFO  Estimated optimised what-if runtime is 69273.5366821289ms
2022-09-25 08:17:24 INFO  Estimated optimisation runtime saving is 1029710.9730243683ms
2022-09-25 08:17:24 INFO  ---RUNTIME: Multi-Query Optimization took 81.32219314575195 ms
2022-09-25 08:17:24 INFO  Executing generated plans
2022-09-25 08:18:38 INFO  ---RUNTIME: Execution took 74270.44439315796 ms
2022-09-25 08:18:38 INFO  Done!
2022-09-25 08:18:38 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-25 08:18:38 INFO  Running instrumented original pipeline...
2022-09-25 08:18:38 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-25 08:18:38 INFO  ---RUNTIME: Importing and monkey-patching took 7.887125015258789 ms
2022-09-25 08:19:22 INFO  ---RUNTIME: Original pipeline execution took 43676.47624015808 ms (excluding imports and monkey-patching)
2022-09-25 08:19:22 INFO  Starting execution of 1 what-if analyses...
2022-09-25 08:19:22 INFO  Start plan generation for analysis DataCorruption...
2022-09-25 08:19:22 INFO  ---RUNTIME: Plan generation took 1.2707710266113281 ms
2022-09-25 08:19:22 INFO  Estimated runtime of original DAG is 43338.39559555054ms
2022-09-25 08:19:22 WARNING Skipping Multi-Query Optimization (instead, only applying patches)
2022-09-25 08:19:22 INFO  Estimated unoptimised what-if runtime is 1083459.8898887634ms
2022-09-25 08:19:22 INFO  ---RUNTIME: Multi-Query Optimization took 27.217388153076172 ms
2022-09-25 08:19:22 INFO  Executing generated plans
2022-09-25 08:37:39 INFO  ---RUNTIME: Execution took 1097343.8353538513 ms
2022-09-25 08:37:39 INFO  Done!
2022-09-25 08:37:39 INFO  # Finished -- repetition 2 of 7 
2022-09-25 08:37:39 INFO  # Optimization benchmark for data_corruption with args [['reviews', 'slow_loading', 'featurization_3', 'xgboost']] -- repetition 3 of 7
2022-09-25 08:37:39 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-25 08:37:39 INFO  Running instrumented original pipeline...
2022-09-25 08:37:39 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-25 08:37:39 INFO  ---RUNTIME: Importing and monkey-patching took 6.69407844543457 ms
2022-09-25 08:38:24 INFO  ---RUNTIME: Original pipeline execution took 44268.25284957886 ms (excluding imports and monkey-patching)
2022-09-25 08:38:24 INFO  Starting execution of 1 what-if analyses...
2022-09-25 08:38:24 INFO  Start plan generation for analysis DataCorruption...
2022-09-25 08:38:24 INFO  ---RUNTIME: Plan generation took 1.2028217315673828 ms
2022-09-25 08:38:24 INFO  Estimated runtime of original DAG is 43932.10315704346ms
2022-09-25 08:38:24 INFO  Performing Multi-Query Optimization
2022-09-25 08:38:24 INFO  Estimated unoptimized what-if runtime is 1098302.5789260864ms
2022-09-25 08:38:24 INFO  Estimated optimised what-if runtime is 69189.90778923035ms
2022-09-25 08:38:24 INFO  Estimated optimisation runtime saving is 1029112.6711368561ms
2022-09-25 08:38:24 INFO  ---RUNTIME: Multi-Query Optimization took 81.7420482635498 ms
2022-09-25 08:38:24 INFO  Executing generated plans
2022-09-25 08:39:38 INFO  ---RUNTIME: Execution took 74257.50994682312 ms
2022-09-25 08:39:38 INFO  Done!
2022-09-25 08:39:38 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-25 08:39:38 INFO  Running instrumented original pipeline...
2022-09-25 08:39:38 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-25 08:39:38 INFO  ---RUNTIME: Importing and monkey-patching took 5.945444107055664 ms
2022-09-25 08:40:22 INFO  ---RUNTIME: Original pipeline execution took 43917.87910461426 ms (excluding imports and monkey-patching)
2022-09-25 08:40:22 INFO  Starting execution of 1 what-if analyses...
2022-09-25 08:40:22 INFO  Start plan generation for analysis DataCorruption...
2022-09-25 08:40:22 INFO  ---RUNTIME: Plan generation took 2.2454261779785156 ms
2022-09-25 08:40:22 INFO  Estimated runtime of original DAG is 43336.63582801819ms
2022-09-25 08:40:22 WARNING Skipping Multi-Query Optimization (instead, only applying patches)
2022-09-25 08:40:22 INFO  Estimated unoptimised what-if runtime is 1083415.8957004547ms
2022-09-25 08:40:22 INFO  ---RUNTIME: Multi-Query Optimization took 30.130624771118164 ms
2022-09-25 08:40:22 INFO  Executing generated plans
2022-09-25 08:58:38 INFO  ---RUNTIME: Execution took 1096371.5238571167 ms
2022-09-25 08:58:38 INFO  Done!
2022-09-25 08:58:38 INFO  # Finished -- repetition 3 of 7 
2022-09-25 08:58:38 INFO  # Optimization benchmark for data_corruption with args [['reviews', 'slow_loading', 'featurization_3', 'xgboost']] -- repetition 4 of 7
2022-09-25 08:58:38 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-25 08:58:38 INFO  Running instrumented original pipeline...
2022-09-25 08:58:38 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-25 08:58:38 INFO  ---RUNTIME: Importing and monkey-patching took 6.363868713378906 ms
2022-09-25 08:59:22 INFO  ---RUNTIME: Original pipeline execution took 43606.96887969971 ms (excluding imports and monkey-patching)
2022-09-25 08:59:22 INFO  Starting execution of 1 what-if analyses...
2022-09-25 08:59:22 INFO  Start plan generation for analysis DataCorruption...
2022-09-25 08:59:22 INFO  ---RUNTIME: Plan generation took 1.2431144714355469 ms
2022-09-25 08:59:22 INFO  Estimated runtime of original DAG is 43257.48634338379ms
2022-09-25 08:59:22 INFO  Performing Multi-Query Optimization
2022-09-25 08:59:22 INFO  Estimated unoptimized what-if runtime is 1081437.1585845947ms
2022-09-25 08:59:22 INFO  Estimated optimised what-if runtime is 68404.51860427856ms
2022-09-25 08:59:22 INFO  Estimated optimisation runtime saving is 1013032.6399803162ms
2022-09-25 08:59:22 INFO  ---RUNTIME: Multi-Query Optimization took 80.9941291809082 ms
2022-09-25 08:59:22 INFO  Executing generated plans
2022-09-25 09:00:36 INFO  ---RUNTIME: Execution took 74066.15257263184 ms
2022-09-25 09:00:36 INFO  Done!
2022-09-25 09:00:36 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-25 09:00:36 INFO  Running instrumented original pipeline...
2022-09-25 09:00:36 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-25 09:00:36 INFO  ---RUNTIME: Importing and monkey-patching took 6.3800811767578125 ms
2022-09-25 09:01:20 INFO  ---RUNTIME: Original pipeline execution took 43637.163400650024 ms (excluding imports and monkey-patching)
2022-09-25 09:01:20 INFO  Starting execution of 1 what-if analyses...
2022-09-25 09:01:20 INFO  Start plan generation for analysis DataCorruption...
2022-09-25 09:01:20 INFO  ---RUNTIME: Plan generation took 1.2295246124267578 ms
2022-09-25 09:01:20 INFO  Estimated runtime of original DAG is 43305.62210083008ms
2022-09-25 09:01:20 WARNING Skipping Multi-Query Optimization (instead, only applying patches)
2022-09-25 09:01:20 INFO  Estimated unoptimised what-if runtime is 1082640.552520752ms
2022-09-25 09:01:20 INFO  ---RUNTIME: Multi-Query Optimization took 26.539087295532227 ms
2022-09-25 09:01:20 INFO  Executing generated plans
2022-09-25 09:19:36 INFO  ---RUNTIME: Execution took 1096625.056028366 ms
2022-09-25 09:19:36 INFO  Done!
2022-09-25 09:19:36 INFO  # Finished -- repetition 4 of 7 
2022-09-25 09:19:36 INFO  # Optimization benchmark for data_corruption with args [['reviews', 'slow_loading', 'featurization_3', 'xgboost']] -- repetition 5 of 7
2022-09-25 09:19:36 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-25 09:19:36 INFO  Running instrumented original pipeline...
2022-09-25 09:19:37 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-25 09:19:37 INFO  ---RUNTIME: Importing and monkey-patching took 6.474018096923828 ms
2022-09-25 09:20:21 INFO  ---RUNTIME: Original pipeline execution took 44300.85015296936 ms (excluding imports and monkey-patching)
2022-09-25 09:20:21 INFO  Starting execution of 1 what-if analyses...
2022-09-25 09:20:21 INFO  Start plan generation for analysis DataCorruption...
2022-09-25 09:20:21 INFO  ---RUNTIME: Plan generation took 1.230001449584961 ms
2022-09-25 09:20:21 INFO  Estimated runtime of original DAG is 43963.46139907837ms
2022-09-25 09:20:21 INFO  Performing Multi-Query Optimization
2022-09-25 09:20:21 INFO  Estimated unoptimized what-if runtime is 1099086.5349769592ms
2022-09-25 09:20:21 INFO  Estimated optimised what-if runtime is 69483.96420478821ms
2022-09-25 09:20:21 INFO  Estimated optimisation runtime saving is 1029602.570772171ms
2022-09-25 09:20:21 INFO  ---RUNTIME: Multi-Query Optimization took 79.78129386901855 ms
2022-09-25 09:20:21 INFO  Executing generated plans
2022-09-25 09:21:35 INFO  ---RUNTIME: Execution took 74050.93789100647 ms
2022-09-25 09:21:35 INFO  Done!
2022-09-25 09:21:35 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-25 09:21:35 INFO  Running instrumented original pipeline...
2022-09-25 09:21:35 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-25 09:21:35 INFO  ---RUNTIME: Importing and monkey-patching took 6.34765625 ms
2022-09-25 09:22:19 INFO  ---RUNTIME: Original pipeline execution took 43639.43266868591 ms (excluding imports and monkey-patching)
2022-09-25 09:22:19 INFO  Starting execution of 1 what-if analyses...
2022-09-25 09:22:19 INFO  Start plan generation for analysis DataCorruption...
2022-09-25 09:22:19 INFO  ---RUNTIME: Plan generation took 1.255035400390625 ms
2022-09-25 09:22:19 INFO  Estimated runtime of original DAG is 43301.33771896362ms
2022-09-25 09:22:19 WARNING Skipping Multi-Query Optimization (instead, only applying patches)
2022-09-25 09:22:19 INFO  Estimated unoptimised what-if runtime is 1082533.4429740906ms
2022-09-25 09:22:19 INFO  ---RUNTIME: Multi-Query Optimization took 26.37338638305664 ms
2022-09-25 09:22:19 INFO  Executing generated plans
2022-09-25 09:40:35 INFO  ---RUNTIME: Execution took 1096142.2023773193 ms
2022-09-25 09:40:35 INFO  Done!
2022-09-25 09:40:35 INFO  # Finished -- repetition 5 of 7 
2022-09-25 09:40:35 INFO  # Optimization benchmark for data_corruption with args [['reviews', 'slow_loading', 'featurization_3', 'xgboost']] -- repetition 6 of 7
2022-09-25 09:40:35 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-25 09:40:35 INFO  Running instrumented original pipeline...
2022-09-25 09:40:35 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-25 09:40:35 INFO  ---RUNTIME: Importing and monkey-patching took 6.270885467529297 ms
2022-09-25 09:41:19 INFO  ---RUNTIME: Original pipeline execution took 44210.77299118042 ms (excluding imports and monkey-patching)
2022-09-25 09:41:19 INFO  Starting execution of 1 what-if analyses...
2022-09-25 09:41:19 INFO  Start plan generation for analysis DataCorruption...
2022-09-25 09:41:19 INFO  ---RUNTIME: Plan generation took 1.493215560913086 ms
2022-09-25 09:41:19 INFO  Estimated runtime of original DAG is 43875.57673454285ms
2022-09-25 09:41:19 INFO  Performing Multi-Query Optimization
2022-09-25 09:41:19 INFO  Estimated unoptimized what-if runtime is 1096889.4183635712ms
2022-09-25 09:41:19 INFO  Estimated optimised what-if runtime is 69096.45557403564ms
2022-09-25 09:41:19 INFO  Estimated optimisation runtime saving is 1027792.9627895355ms
2022-09-25 09:41:19 INFO  ---RUNTIME: Multi-Query Optimization took 80.87515830993652 ms
2022-09-25 09:41:19 INFO  Executing generated plans
2022-09-25 09:42:33 INFO  ---RUNTIME: Execution took 73819.56315040588 ms
2022-09-25 09:42:33 INFO  Done!
2022-09-25 09:42:33 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-25 09:42:33 INFO  Running instrumented original pipeline...
2022-09-25 09:42:33 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-25 09:42:33 INFO  ---RUNTIME: Importing and monkey-patching took 6.537199020385742 ms
2022-09-25 09:43:17 INFO  ---RUNTIME: Original pipeline execution took 43573.174238204956 ms (excluding imports and monkey-patching)
2022-09-25 09:43:17 INFO  Starting execution of 1 what-if analyses...
2022-09-25 09:43:17 INFO  Start plan generation for analysis DataCorruption...
2022-09-25 09:43:17 INFO  ---RUNTIME: Plan generation took 7.210016250610352 ms
2022-09-25 09:43:17 INFO  Estimated runtime of original DAG is 43239.3798828125ms
2022-09-25 09:43:17 WARNING Skipping Multi-Query Optimization (instead, only applying patches)
2022-09-25 09:43:17 INFO  Estimated unoptimised what-if runtime is 1080984.4970703125ms
2022-09-25 09:43:17 INFO  ---RUNTIME: Multi-Query Optimization took 21.965742111206055 ms
2022-09-25 09:43:17 INFO  Executing generated plans
2022-09-25 10:01:34 INFO  ---RUNTIME: Execution took 1097447.3326206207 ms
2022-09-25 10:01:34 INFO  Done!
2022-09-25 10:01:34 INFO  # Finished -- repetition 6 of 7 
2022-09-25 10:01:34 INFO  # Optimization benchmark for data_corruption with args [['reviews', 'slow_loading', 'featurization_3', 'xgboost']] -- repetition 7 of 7
2022-09-25 10:01:34 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-25 10:01:34 INFO  Running instrumented original pipeline...
2022-09-25 10:01:34 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-25 10:01:34 INFO  ---RUNTIME: Importing and monkey-patching took 6.398439407348633 ms
2022-09-25 10:02:18 INFO  ---RUNTIME: Original pipeline execution took 44304.01158332825 ms (excluding imports and monkey-patching)
2022-09-25 10:02:18 INFO  Starting execution of 1 what-if analyses...
2022-09-25 10:02:18 INFO  Start plan generation for analysis DataCorruption...
2022-09-25 10:02:18 INFO  ---RUNTIME: Plan generation took 5.794525146484375 ms
2022-09-25 10:02:18 INFO  Estimated runtime of original DAG is 43967.45157241821ms
2022-09-25 10:02:18 INFO  Performing Multi-Query Optimization
2022-09-25 10:02:19 INFO  Estimated unoptimized what-if runtime is 1099186.2893104553ms
2022-09-25 10:02:19 INFO  Estimated optimised what-if runtime is 69202.8079032898ms
2022-09-25 10:02:19 INFO  Estimated optimisation runtime saving is 1029983.4814071655ms
2022-09-25 10:02:19 INFO  ---RUNTIME: Multi-Query Optimization took 74.94425773620605 ms
2022-09-25 10:02:19 INFO  Executing generated plans
2022-09-25 10:03:33 INFO  ---RUNTIME: Execution took 74073.08721542358 ms
2022-09-25 10:03:33 INFO  Done!
2022-09-25 10:03:33 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-25 10:03:33 INFO  Running instrumented original pipeline...
2022-09-25 10:03:33 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-25 10:03:33 INFO  ---RUNTIME: Importing and monkey-patching took 6.245851516723633 ms
2022-09-25 10:04:16 INFO  ---RUNTIME: Original pipeline execution took 43627.60257720947 ms (excluding imports and monkey-patching)
2022-09-25 10:04:16 INFO  Starting execution of 1 what-if analyses...
2022-09-25 10:04:16 INFO  Start plan generation for analysis DataCorruption...
2022-09-25 10:04:16 INFO  ---RUNTIME: Plan generation took 3.8797855377197266 ms
2022-09-25 10:04:16 INFO  Estimated runtime of original DAG is 43297.81770706177ms
2022-09-25 10:04:16 WARNING Skipping Multi-Query Optimization (instead, only applying patches)
2022-09-25 10:04:16 INFO  Estimated unoptimised what-if runtime is 1082445.4426765442ms
2022-09-25 10:04:16 INFO  ---RUNTIME: Multi-Query Optimization took 24.495601654052734 ms
2022-09-25 10:04:16 INFO  Executing generated plans
2022-09-25 10:22:33 INFO  ---RUNTIME: Execution took 1096390.2723789215 ms
2022-09-25 10:22:33 INFO  Done!
2022-09-25 10:22:33 INFO  # Finished -- repetition 7 of 7 
2022-09-25 10:22:33 INFO  # Final results after all repetitions
2022-09-25 10:22:33 INFO     repetition  ... no_opt_what_if_execution_combined_model_training
0           0  ...                                    835505.196810
1           1  ...                                    835917.024851
2           2  ...                                    836028.006792
3           3  ...                                    835729.121208
4           4  ...                                    835491.797209
5           5  ...                                    835866.497993
6           6  ...                                    835651.625156

[7 rows x 26 columns]
PROTOCOL_BUFFERS_PYTHON_IMPLEMENTATION=python taskset -c 32-39 python3.9 benchmarks_end_to_end.py data_corruption reviews slow_loading featurization_3 neural_network
2022-09-25 10:22:35.552312: W tensorflow/stream_executor/platform/default/dso_loader.cc:64] Could not load dynamic library 'libcudart.so.11.0'; dlerror: libcudart.so.11.0: cannot open shared object file: No such file or directory; LD_LIBRARY_PATH: /home/sgrafbe/mlwhatif/venv/lib/python3.9/site-packages/cv2/../../lib64:
2022-09-25 10:22:35.552351: I tensorflow/stream_executor/cuda/cudart_stub.cc:29] Ignore above cudart dlerror if you do not have a GPU set up on your machine.
2022-09-25 10:22:36 INFO  Patching sys.argv with ['mlwhatif', 'reviews', 'slow_loading', 'featurization_3', 'neural_network']
2022-09-25 10:22:36 INFO  Running instrumented original pipeline...
2022-09-25 10:22:36 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-25 10:22:36 INFO  ---RUNTIME: Importing and monkey-patching took 95.85356712341309 ms
2022-09-25 10:22:44.144955: W tensorflow/stream_executor/platform/default/dso_loader.cc:64] Could not load dynamic library 'libcuda.so.1'; dlerror: libcuda.so.1: cannot open shared object file: No such file or directory; LD_LIBRARY_PATH: /home/sgrafbe/mlwhatif/venv/lib/python3.9/site-packages/cv2/../../lib64:
2022-09-25 10:22:44.144995: W tensorflow/stream_executor/cuda/cuda_driver.cc:326] failed call to cuInit: UNKNOWN ERROR (303)
2022-09-25 10:22:44.145019: I tensorflow/stream_executor/cuda/cuda_diagnostics.cc:156] kernel driver does not appear to be running on this host (wagyu): /proc/driver/nvidia/version does not exist
2022-09-25 10:22:44.145566: I tensorflow/core/platform/cpu_feature_guard.cc:142] This TensorFlow binary is optimized with oneAPI Deep Neural Network Library (oneDNN) to use the following CPU instructions in performance-critical operations:  AVX2 FMA
To enable them in other operations, rebuild TensorFlow with the appropriate compiler flags.
2022-09-25 10:22:44.784909: I tensorflow/compiler/mlir/mlir_graph_optimization_pass.cc:176] None of the MLIR Optimization Passes are enabled (registered 2)
2022-09-25 10:22:44.799368: I tensorflow/core/platform/profile_utils/cpu_utils.cc:114] CPU Frequency: 2595290000 Hz
2022-09-25 10:22:54 INFO  ---RUNTIME: Original pipeline execution took 17559.285640716553 ms (excluding imports and monkey-patching)
2022-09-25 10:22:54 INFO  Starting execution of 0 what-if analyses...
2022-09-25 10:22:54 INFO  Estimated runtime of original DAG is 17176.544427871704ms
2022-09-25 10:22:54 INFO  Performing Multi-Query Optimization
2022-09-25 10:22:54 INFO  Estimated unoptimized what-if runtime is 0ms
2022-09-25 10:22:54 INFO  Estimated optimised what-if runtime is 0ms
2022-09-25 10:22:54 INFO  Estimated optimisation runtime saving is 0ms
2022-09-25 10:22:54 INFO  ---RUNTIME: Multi-Query Optimization took 0.6091594696044922 ms
2022-09-25 10:22:54 INFO  Executing generated plans
2022-09-25 10:22:54 INFO  ---RUNTIME: Execution took 0.026702880859375 ms
2022-09-25 10:22:54 INFO  Done!
2022-09-25 10:22:54 INFO  # Optimization benchmark for data_corruption with args [['reviews', 'slow_loading', 'featurization_3', 'neural_network']] -- repetition 1 of 7
2022-09-25 10:22:54 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-25 10:22:54 INFO  Running instrumented original pipeline...
2022-09-25 10:22:54 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-25 10:22:54 INFO  ---RUNTIME: Importing and monkey-patching took 5.532979965209961 ms
2022-09-25 10:23:10 INFO  ---RUNTIME: Original pipeline execution took 16492.009162902832 ms (excluding imports and monkey-patching)
2022-09-25 10:23:10 INFO  Starting execution of 1 what-if analyses...
2022-09-25 10:23:10 INFO  Start plan generation for analysis DataCorruption...
2022-09-25 10:23:10 INFO  ---RUNTIME: Plan generation took 0.45299530029296875 ms
2022-09-25 10:23:10 INFO  Estimated runtime of original DAG is 16146.093845367432ms
2022-09-25 10:23:10 INFO  Performing Multi-Query Optimization
2022-09-25 10:23:11 INFO  Estimated unoptimized what-if runtime is 403652.3461341858ms
2022-09-25 10:23:11 INFO  Estimated optimised what-if runtime is 50230.51309585571ms
2022-09-25 10:23:11 INFO  Estimated optimisation runtime saving is 353421.8330383301ms
2022-09-25 10:23:11 INFO  ---RUNTIME: Multi-Query Optimization took 83.79077911376953 ms
2022-09-25 10:23:11 INFO  Executing generated plans
2022-09-25 10:24:05 INFO  ---RUNTIME: Execution took 54807.42430686951 ms
2022-09-25 10:24:05 INFO  Done!
2022-09-25 10:24:05 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-25 10:24:05 INFO  Running instrumented original pipeline...
2022-09-25 10:24:05 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-25 10:24:05 INFO  ---RUNTIME: Importing and monkey-patching took 6.40869140625 ms
2022-09-25 10:24:22 INFO  ---RUNTIME: Original pipeline execution took 16806.999683380127 ms (excluding imports and monkey-patching)
2022-09-25 10:24:22 INFO  Starting execution of 1 what-if analyses...
2022-09-25 10:24:22 INFO  Start plan generation for analysis DataCorruption...
2022-09-25 10:24:22 INFO  ---RUNTIME: Plan generation took 0.40078163146972656 ms
2022-09-25 10:24:22 INFO  Estimated runtime of original DAG is 16444.232940673828ms
2022-09-25 10:24:22 WARNING Skipping Multi-Query Optimization (instead, only applying patches)
2022-09-25 10:24:22 INFO  Estimated unoptimised what-if runtime is 411105.8235168457ms
2022-09-25 10:24:22 INFO  ---RUNTIME: Multi-Query Optimization took 22.600650787353516 ms
2022-09-25 10:24:22 INFO  Executing generated plans
2022-09-25 10:31:22 INFO  ---RUNTIME: Execution took 419939.91208076477 ms
2022-09-25 10:31:22 INFO  Done!
2022-09-25 10:31:22 INFO  # Finished -- repetition 1 of 7 
2022-09-25 10:31:22 INFO  # Optimization benchmark for data_corruption with args [['reviews', 'slow_loading', 'featurization_3', 'neural_network']] -- repetition 2 of 7
2022-09-25 10:31:22 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-25 10:31:22 INFO  Running instrumented original pipeline...
2022-09-25 10:31:22 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-25 10:31:22 INFO  ---RUNTIME: Importing and monkey-patching took 6.150960922241211 ms
2022-09-25 10:31:39 INFO  ---RUNTIME: Original pipeline execution took 16387.209177017212 ms (excluding imports and monkey-patching)
2022-09-25 10:31:39 INFO  Starting execution of 1 what-if analyses...
2022-09-25 10:31:39 INFO  Start plan generation for analysis DataCorruption...
2022-09-25 10:31:39 INFO  ---RUNTIME: Plan generation took 0.37097930908203125 ms
2022-09-25 10:31:39 INFO  Estimated runtime of original DAG is 16036.72456741333ms
2022-09-25 10:31:39 INFO  Performing Multi-Query Optimization
2022-09-25 10:31:39 INFO  Estimated unoptimized what-if runtime is 400918.11418533325ms
2022-09-25 10:31:39 INFO  Estimated optimised what-if runtime is 50317.74854660034ms
2022-09-25 10:31:39 INFO  Estimated optimisation runtime saving is 350600.3656387329ms
2022-09-25 10:31:39 INFO  ---RUNTIME: Multi-Query Optimization took 455.1260471343994 ms
2022-09-25 10:31:39 INFO  Executing generated plans
2022-09-25 10:32:34 INFO  ---RUNTIME: Execution took 55143.99075508118 ms
2022-09-25 10:32:34 INFO  Done!
2022-09-25 10:32:34 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-25 10:32:34 INFO  Running instrumented original pipeline...
2022-09-25 10:32:34 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-25 10:32:34 INFO  ---RUNTIME: Importing and monkey-patching took 6.255626678466797 ms
2022-09-25 10:32:51 INFO  ---RUNTIME: Original pipeline execution took 16676.035165786743 ms (excluding imports and monkey-patching)
2022-09-25 10:32:51 INFO  Starting execution of 1 what-if analyses...
2022-09-25 10:32:51 INFO  Start plan generation for analysis DataCorruption...
2022-09-25 10:32:51 INFO  ---RUNTIME: Plan generation took 0.4038810729980469 ms
2022-09-25 10:32:51 INFO  Estimated runtime of original DAG is 16316.871643066406ms
2022-09-25 10:32:51 WARNING Skipping Multi-Query Optimization (instead, only applying patches)
2022-09-25 10:32:51 INFO  Estimated unoptimised what-if runtime is 407921.79107666016ms
2022-09-25 10:32:51 INFO  ---RUNTIME: Multi-Query Optimization took 22.4609375 ms
2022-09-25 10:32:51 INFO  Executing generated plans
2022-09-25 10:39:54 INFO  ---RUNTIME: Execution took 422962.41664886475 ms
2022-09-25 10:39:54 INFO  Done!
2022-09-25 10:39:54 INFO  # Finished -- repetition 2 of 7 
2022-09-25 10:39:54 INFO  # Optimization benchmark for data_corruption with args [['reviews', 'slow_loading', 'featurization_3', 'neural_network']] -- repetition 3 of 7
2022-09-25 10:39:54 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-25 10:39:54 INFO  Running instrumented original pipeline...
2022-09-25 10:39:54 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-25 10:39:54 INFO  ---RUNTIME: Importing and monkey-patching took 6.642341613769531 ms
2022-09-25 10:40:12 INFO  ---RUNTIME: Original pipeline execution took 17769.219160079956 ms (excluding imports and monkey-patching)
2022-09-25 10:40:12 INFO  Starting execution of 1 what-if analyses...
2022-09-25 10:40:12 INFO  Start plan generation for analysis DataCorruption...
2022-09-25 10:40:12 INFO  ---RUNTIME: Plan generation took 0.43487548828125 ms
2022-09-25 10:40:12 INFO  Estimated runtime of original DAG is 17406.192779541016ms
2022-09-25 10:40:12 INFO  Performing Multi-Query Optimization
2022-09-25 10:40:12 INFO  Estimated unoptimized what-if runtime is 435154.8194885254ms
2022-09-25 10:40:12 INFO  Estimated optimised what-if runtime is 55098.98114204407ms
2022-09-25 10:40:12 INFO  Estimated optimisation runtime saving is 380055.8383464813ms
2022-09-25 10:40:12 INFO  ---RUNTIME: Multi-Query Optimization took 86.00783348083496 ms
2022-09-25 10:40:12 INFO  Executing generated plans
2022-09-25 10:41:12 INFO  ---RUNTIME: Execution took 60271.89779281616 ms
2022-09-25 10:41:12 INFO  Done!
2022-09-25 10:41:12 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-25 10:41:12 INFO  Running instrumented original pipeline...
2022-09-25 10:41:12 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-25 10:41:12 INFO  ---RUNTIME: Importing and monkey-patching took 5.977630615234375 ms
2022-09-25 10:41:30 INFO  ---RUNTIME: Original pipeline execution took 17473.958730697632 ms (excluding imports and monkey-patching)
2022-09-25 10:41:30 INFO  Starting execution of 1 what-if analyses...
2022-09-25 10:41:30 INFO  Start plan generation for analysis DataCorruption...
2022-09-25 10:41:30 INFO  ---RUNTIME: Plan generation took 6.571769714355469 ms
2022-09-25 10:41:30 INFO  Estimated runtime of original DAG is 17108.586072921753ms
2022-09-25 10:41:30 WARNING Skipping Multi-Query Optimization (instead, only applying patches)
2022-09-25 10:41:30 INFO  Estimated unoptimised what-if runtime is 427714.6518230438ms
2022-09-25 10:41:30 INFO  ---RUNTIME: Multi-Query Optimization took 22.465229034423828 ms
2022-09-25 10:41:30 INFO  Executing generated plans
2022-09-25 10:48:46 INFO  ---RUNTIME: Execution took 436586.9286060333 ms
2022-09-25 10:48:46 INFO  Done!
2022-09-25 10:48:46 INFO  # Finished -- repetition 3 of 7 
2022-09-25 10:48:46 INFO  # Optimization benchmark for data_corruption with args [['reviews', 'slow_loading', 'featurization_3', 'neural_network']] -- repetition 4 of 7
2022-09-25 10:48:46 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-25 10:48:46 INFO  Running instrumented original pipeline...
2022-09-25 10:48:46 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-25 10:48:46 INFO  ---RUNTIME: Importing and monkey-patching took 6.211042404174805 ms
2022-09-25 10:49:04 INFO  ---RUNTIME: Original pipeline execution took 17748.344659805298 ms (excluding imports and monkey-patching)
2022-09-25 10:49:04 INFO  Starting execution of 1 what-if analyses...
2022-09-25 10:49:04 INFO  Start plan generation for analysis DataCorruption...
2022-09-25 10:49:04 INFO  ---RUNTIME: Plan generation took 0.41484832763671875 ms
2022-09-25 10:49:04 INFO  Estimated runtime of original DAG is 17383.38541984558ms
2022-09-25 10:49:04 INFO  Performing Multi-Query Optimization
2022-09-25 10:49:04 INFO  Estimated unoptimized what-if runtime is 434584.6354961395ms
2022-09-25 10:49:04 INFO  Estimated optimised what-if runtime is 55605.45802116394ms
2022-09-25 10:49:04 INFO  Estimated optimisation runtime saving is 378979.1774749756ms
2022-09-25 10:49:04 INFO  ---RUNTIME: Multi-Query Optimization took 92.52643585205078 ms
2022-09-25 10:49:04 INFO  Executing generated plans
2022-09-25 10:50:01 INFO  ---RUNTIME: Execution took 56993.228912353516 ms
2022-09-25 10:50:01 INFO  Done!
2022-09-25 10:50:01 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-25 10:50:01 INFO  Running instrumented original pipeline...
2022-09-25 10:50:01 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-25 10:50:01 INFO  ---RUNTIME: Importing and monkey-patching took 6.022453308105469 ms
2022-09-25 10:50:19 INFO  ---RUNTIME: Original pipeline execution took 17590.529918670654 ms (excluding imports and monkey-patching)
2022-09-25 10:50:19 INFO  Starting execution of 1 what-if analyses...
2022-09-25 10:50:19 INFO  Start plan generation for analysis DataCorruption...
2022-09-25 10:50:19 INFO  ---RUNTIME: Plan generation took 0.4246234893798828 ms
2022-09-25 10:50:19 INFO  Estimated runtime of original DAG is 17228.48081588745ms
2022-09-25 10:50:19 WARNING Skipping Multi-Query Optimization (instead, only applying patches)
2022-09-25 10:50:19 INFO  Estimated unoptimised what-if runtime is 430712.0203971863ms
2022-09-25 10:50:19 INFO  ---RUNTIME: Multi-Query Optimization took 22.684812545776367 ms
2022-09-25 10:50:19 INFO  Executing generated plans
2022-09-25 10:57:33 INFO  ---RUNTIME: Execution took 434355.3042411804 ms
2022-09-25 10:57:33 INFO  Done!
2022-09-25 10:57:33 INFO  # Finished -- repetition 4 of 7 
2022-09-25 10:57:33 INFO  # Optimization benchmark for data_corruption with args [['reviews', 'slow_loading', 'featurization_3', 'neural_network']] -- repetition 5 of 7
2022-09-25 10:57:33 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-25 10:57:33 INFO  Running instrumented original pipeline...
2022-09-25 10:57:33 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-25 10:57:33 INFO  ---RUNTIME: Importing and monkey-patching took 6.384372711181641 ms
2022-09-25 10:57:51 INFO  ---RUNTIME: Original pipeline execution took 17477.938652038574 ms (excluding imports and monkey-patching)
2022-09-25 10:57:51 INFO  Starting execution of 1 what-if analyses...
2022-09-25 10:57:51 INFO  Start plan generation for analysis DataCorruption...
2022-09-25 10:57:51 INFO  ---RUNTIME: Plan generation took 5.764484405517578 ms
2022-09-25 10:57:51 INFO  Estimated runtime of original DAG is 17127.39849090576ms
2022-09-25 10:57:51 INFO  Performing Multi-Query Optimization
2022-09-25 10:57:51 INFO  Estimated unoptimized what-if runtime is 428184.96227264404ms
2022-09-25 10:57:51 INFO  Estimated optimised what-if runtime is 52510.65754890442ms
2022-09-25 10:57:51 INFO  Estimated optimisation runtime saving is 375674.3047237396ms
2022-09-25 10:57:51 INFO  ---RUNTIME: Multi-Query Optimization took 77.15940475463867 ms
2022-09-25 10:57:51 INFO  Executing generated plans
2022-09-25 10:58:47 INFO  ---RUNTIME: Execution took 56400.18844604492 ms
2022-09-25 10:58:47 INFO  Done!
2022-09-25 10:58:47 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-25 10:58:47 INFO  Running instrumented original pipeline...
2022-09-25 10:58:47 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-25 10:58:47 INFO  ---RUNTIME: Importing and monkey-patching took 6.272792816162109 ms
2022-09-25 10:59:04 INFO  ---RUNTIME: Original pipeline execution took 16705.684423446655 ms (excluding imports and monkey-patching)
2022-09-25 10:59:04 INFO  Starting execution of 1 what-if analyses...
2022-09-25 10:59:04 INFO  Start plan generation for analysis DataCorruption...
2022-09-25 10:59:04 INFO  ---RUNTIME: Plan generation took 0.4520416259765625 ms
2022-09-25 10:59:04 INFO  Estimated runtime of original DAG is 16343.047142028809ms
2022-09-25 10:59:04 WARNING Skipping Multi-Query Optimization (instead, only applying patches)
2022-09-25 10:59:04 INFO  Estimated unoptimised what-if runtime is 408576.1785507202ms
2022-09-25 10:59:04 INFO  ---RUNTIME: Multi-Query Optimization took 22.815465927124023 ms
2022-09-25 10:59:04 INFO  Executing generated plans
2022-09-25 11:06:19 INFO  ---RUNTIME: Execution took 435184.6179962158 ms
2022-09-25 11:06:19 INFO  Done!
2022-09-25 11:06:19 INFO  # Finished -- repetition 5 of 7 
2022-09-25 11:06:19 INFO  # Optimization benchmark for data_corruption with args [['reviews', 'slow_loading', 'featurization_3', 'neural_network']] -- repetition 6 of 7
2022-09-25 11:06:19 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-25 11:06:19 INFO  Running instrumented original pipeline...
2022-09-25 11:06:19 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-25 11:06:19 INFO  ---RUNTIME: Importing and monkey-patching took 6.095409393310547 ms
2022-09-25 11:06:36 INFO  ---RUNTIME: Original pipeline execution took 16972.264766693115 ms (excluding imports and monkey-patching)
2022-09-25 11:06:36 INFO  Starting execution of 1 what-if analyses...
2022-09-25 11:06:36 INFO  Start plan generation for analysis DataCorruption...
2022-09-25 11:06:36 INFO  ---RUNTIME: Plan generation took 6.446123123168945 ms
2022-09-25 11:06:36 INFO  Estimated runtime of original DAG is 16600.042581558228ms
2022-09-25 11:06:36 INFO  Performing Multi-Query Optimization
2022-09-25 11:06:36 INFO  Estimated unoptimized what-if runtime is 415001.0645389557ms
2022-09-25 11:06:36 INFO  Estimated optimised what-if runtime is 53985.91995239258ms
2022-09-25 11:06:36 INFO  Estimated optimisation runtime saving is 361015.1445865631ms
2022-09-25 11:06:36 INFO  ---RUNTIME: Multi-Query Optimization took 81.70509338378906 ms
2022-09-25 11:06:36 INFO  Executing generated plans
2022-09-25 11:07:33 INFO  ---RUNTIME: Execution took 56777.81391143799 ms
2022-09-25 11:07:33 INFO  Done!
2022-09-25 11:07:33 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-25 11:07:33 INFO  Running instrumented original pipeline...
2022-09-25 11:07:33 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-25 11:07:33 INFO  ---RUNTIME: Importing and monkey-patching took 6.066083908081055 ms
2022-09-25 11:07:50 INFO  ---RUNTIME: Original pipeline execution took 17386.693239212036 ms (excluding imports and monkey-patching)
2022-09-25 11:07:50 INFO  Starting execution of 1 what-if analyses...
2022-09-25 11:07:50 INFO  Start plan generation for analysis DataCorruption...
2022-09-25 11:07:50 INFO  ---RUNTIME: Plan generation took 0.4074573516845703 ms
2022-09-25 11:07:50 INFO  Estimated runtime of original DAG is 17030.816078186035ms
2022-09-25 11:07:50 WARNING Skipping Multi-Query Optimization (instead, only applying patches)
2022-09-25 11:07:50 INFO  Estimated unoptimised what-if runtime is 425770.4019546509ms
2022-09-25 11:07:50 INFO  ---RUNTIME: Multi-Query Optimization took 22.454023361206055 ms
2022-09-25 11:07:50 INFO  Executing generated plans
2022-09-25 11:15:04 INFO  ---RUNTIME: Execution took 433777.54163742065 ms
2022-09-25 11:15:04 INFO  Done!
2022-09-25 11:15:04 INFO  # Finished -- repetition 6 of 7 
2022-09-25 11:15:04 INFO  # Optimization benchmark for data_corruption with args [['reviews', 'slow_loading', 'featurization_3', 'neural_network']] -- repetition 7 of 7
2022-09-25 11:15:04 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-25 11:15:04 INFO  Running instrumented original pipeline...
2022-09-25 11:15:04 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-25 11:15:04 INFO  ---RUNTIME: Importing and monkey-patching took 6.282567977905273 ms
2022-09-25 11:15:21 INFO  ---RUNTIME: Original pipeline execution took 16924.906015396118 ms (excluding imports and monkey-patching)
2022-09-25 11:15:21 INFO  Starting execution of 1 what-if analyses...
2022-09-25 11:15:21 INFO  Start plan generation for analysis DataCorruption...
2022-09-25 11:15:21 INFO  ---RUNTIME: Plan generation took 0.4291534423828125 ms
2022-09-25 11:15:21 INFO  Estimated runtime of original DAG is 16564.369678497314ms
2022-09-25 11:15:21 INFO  Performing Multi-Query Optimization
2022-09-25 11:15:21 INFO  Estimated unoptimized what-if runtime is 414109.24196243286ms
2022-09-25 11:15:21 INFO  Estimated optimised what-if runtime is 52550.705432891846ms
2022-09-25 11:15:21 INFO  Estimated optimisation runtime saving is 361558.536529541ms
2022-09-25 11:15:21 INFO  ---RUNTIME: Multi-Query Optimization took 80.98006248474121 ms
2022-09-25 11:15:21 INFO  Executing generated plans
2022-09-25 11:16:19 INFO  ---RUNTIME: Execution took 57569.429874420166 ms
2022-09-25 11:16:19 INFO  Done!
2022-09-25 11:16:19 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-25 11:16:19 INFO  Running instrumented original pipeline...
2022-09-25 11:16:19 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-25 11:16:19 INFO  ---RUNTIME: Importing and monkey-patching took 5.982637405395508 ms
2022-09-25 11:16:36 INFO  ---RUNTIME: Original pipeline execution took 16896.666049957275 ms (excluding imports and monkey-patching)
2022-09-25 11:16:36 INFO  Starting execution of 1 what-if analyses...
2022-09-25 11:16:36 INFO  Start plan generation for analysis DataCorruption...
2022-09-25 11:16:36 INFO  ---RUNTIME: Plan generation took 0.4019737243652344 ms
2022-09-25 11:16:36 INFO  Estimated runtime of original DAG is 16522.578239440918ms
2022-09-25 11:16:36 WARNING Skipping Multi-Query Optimization (instead, only applying patches)
2022-09-25 11:16:36 INFO  Estimated unoptimised what-if runtime is 413064.45598602295ms
2022-09-25 11:16:36 INFO  ---RUNTIME: Multi-Query Optimization took 23.4220027923584 ms
2022-09-25 11:16:36 INFO  Executing generated plans
2022-09-25 11:23:51 INFO  ---RUNTIME: Execution took 434749.66955184937 ms
2022-09-25 11:23:51 INFO  Done!
2022-09-25 11:23:51 INFO  # Finished -- repetition 7 of 7 
2022-09-25 11:23:51 INFO  # Final results after all repetitions
2022-09-25 11:23:51 INFO     repetition  ... no_opt_what_if_execution_combined_model_training
0           0  ...                                    149073.324442
1           1  ...                                    150671.078444
2           2  ...                                    156789.302588
3           3  ...                                    154753.694296
4           4  ...                                    155052.280188
5           5  ...                                    154696.591377
6           6  ...                                    155389.860630

[7 rows x 26 columns]
PROTOCOL_BUFFERS_PYTHON_IMPLEMENTATION=python taskset -c 32-39 python3.9 benchmarks_end_to_end.py data_corruption reviews slow_loading featurization_4 logistic_regression
2022-09-25 11:23:53.917754: W tensorflow/stream_executor/platform/default/dso_loader.cc:64] Could not load dynamic library 'libcudart.so.11.0'; dlerror: libcudart.so.11.0: cannot open shared object file: No such file or directory; LD_LIBRARY_PATH: /home/sgrafbe/mlwhatif/venv/lib/python3.9/site-packages/cv2/../../lib64:
2022-09-25 11:23:53.917791: I tensorflow/stream_executor/cuda/cudart_stub.cc:29] Ignore above cudart dlerror if you do not have a GPU set up on your machine.
2022-09-25 11:23:55 INFO  Patching sys.argv with ['mlwhatif', 'reviews', 'slow_loading', 'featurization_4', 'logistic_regression']
2022-09-25 11:23:55 INFO  Running instrumented original pipeline...
2022-09-25 11:23:55 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-25 11:23:55 INFO  ---RUNTIME: Importing and monkey-patching took 95.8561897277832 ms
2022-09-25 11:24:05 INFO  ---RUNTIME: Original pipeline execution took 10644.393682479858 ms (excluding imports and monkey-patching)
2022-09-25 11:24:05 INFO  Starting execution of 0 what-if analyses...
2022-09-25 11:24:05 INFO  Estimated runtime of original DAG is 10299.208164215088ms
2022-09-25 11:24:05 INFO  Performing Multi-Query Optimization
2022-09-25 11:24:05 INFO  Estimated unoptimized what-if runtime is 0ms
2022-09-25 11:24:05 INFO  Estimated optimised what-if runtime is 0ms
2022-09-25 11:24:05 INFO  Estimated optimisation runtime saving is 0ms
2022-09-25 11:24:05 INFO  ---RUNTIME: Multi-Query Optimization took 0.6849765777587891 ms
2022-09-25 11:24:05 INFO  Executing generated plans
2022-09-25 11:24:05 INFO  ---RUNTIME: Execution took 0.02956390380859375 ms
2022-09-25 11:24:05 INFO  Done!
2022-09-25 11:24:05 INFO  # Optimization benchmark for data_corruption with args [['reviews', 'slow_loading', 'featurization_4', 'logistic_regression']] -- repetition 1 of 7
2022-09-25 11:24:05 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-25 11:24:05 INFO  Running instrumented original pipeline...
2022-09-25 11:24:06 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-25 11:24:06 INFO  ---RUNTIME: Importing and monkey-patching took 5.882978439331055 ms
2022-09-25 11:24:16 INFO  ---RUNTIME: Original pipeline execution took 10403.736352920532 ms (excluding imports and monkey-patching)
2022-09-25 11:24:16 INFO  Starting execution of 1 what-if analyses...
2022-09-25 11:24:16 INFO  Start plan generation for analysis DataCorruption...
2022-09-25 11:24:16 INFO  ---RUNTIME: Plan generation took 0.7145404815673828 ms
2022-09-25 11:24:16 INFO  Estimated runtime of original DAG is 10093.153476715088ms
2022-09-25 11:24:16 INFO  Performing Multi-Query Optimization
2022-09-25 11:24:16 INFO  Estimated unoptimized what-if runtime is 252328.8369178772ms
2022-09-25 11:24:16 INFO  Estimated optimised what-if runtime is 11234.187841415405ms
2022-09-25 11:24:16 INFO  Estimated optimisation runtime saving is 241094.6490764618ms
2022-09-25 11:24:16 INFO  ---RUNTIME: Multi-Query Optimization took 68.34244728088379 ms
2022-09-25 11:24:16 INFO  Executing generated plans
2022-09-25 11:24:31 INFO  ---RUNTIME: Execution took 15078.1090259552 ms
2022-09-25 11:24:31 INFO  Done!
2022-09-25 11:24:31 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-25 11:24:31 INFO  Running instrumented original pipeline...
2022-09-25 11:24:31 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-25 11:24:31 INFO  ---RUNTIME: Importing and monkey-patching took 7.026195526123047 ms
2022-09-25 11:24:42 INFO  ---RUNTIME: Original pipeline execution took 10566.688299179077 ms (excluding imports and monkey-patching)
2022-09-25 11:24:42 INFO  Starting execution of 1 what-if analyses...
2022-09-25 11:24:42 INFO  Start plan generation for analysis DataCorruption...
2022-09-25 11:24:42 INFO  ---RUNTIME: Plan generation took 0.4096031188964844 ms
2022-09-25 11:24:42 INFO  Estimated runtime of original DAG is 10241.411685943604ms
2022-09-25 11:24:42 WARNING Skipping Multi-Query Optimization (instead, only applying patches)
2022-09-25 11:24:42 INFO  Estimated unoptimised what-if runtime is 256035.2921485901ms
2022-09-25 11:24:42 INFO  ---RUNTIME: Multi-Query Optimization took 20.244121551513672 ms
2022-09-25 11:24:42 INFO  Executing generated plans
2022-09-25 11:29:08 INFO  ---RUNTIME: Execution took 266254.79435920715 ms
2022-09-25 11:29:08 INFO  Done!
2022-09-25 11:29:08 INFO  # Finished -- repetition 1 of 7 
2022-09-25 11:29:08 INFO  # Optimization benchmark for data_corruption with args [['reviews', 'slow_loading', 'featurization_4', 'logistic_regression']] -- repetition 2 of 7
2022-09-25 11:29:08 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-25 11:29:08 INFO  Running instrumented original pipeline...
2022-09-25 11:29:08 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-25 11:29:08 INFO  ---RUNTIME: Importing and monkey-patching took 5.895376205444336 ms
2022-09-25 11:29:18 INFO  ---RUNTIME: Original pipeline execution took 10186.86318397522 ms (excluding imports and monkey-patching)
2022-09-25 11:29:18 INFO  Starting execution of 1 what-if analyses...
2022-09-25 11:29:18 INFO  Start plan generation for analysis DataCorruption...
2022-09-25 11:29:18 INFO  ---RUNTIME: Plan generation took 0.7257461547851562 ms
2022-09-25 11:29:18 INFO  Estimated runtime of original DAG is 9871.48380279541ms
2022-09-25 11:29:18 INFO  Performing Multi-Query Optimization
2022-09-25 11:29:18 INFO  Estimated unoptimized what-if runtime is 246787.09506988525ms
2022-09-25 11:29:18 INFO  Estimated optimised what-if runtime is 10954.037189483643ms
2022-09-25 11:29:18 INFO  Estimated optimisation runtime saving is 235833.0578804016ms
2022-09-25 11:29:18 INFO  ---RUNTIME: Multi-Query Optimization took 67.62814521789551 ms
2022-09-25 11:29:18 INFO  Executing generated plans
2022-09-25 11:29:34 INFO  ---RUNTIME: Execution took 15414.425611495972 ms
2022-09-25 11:29:34 INFO  Done!
2022-09-25 11:29:34 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-25 11:29:34 INFO  Running instrumented original pipeline...
2022-09-25 11:29:34 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-25 11:29:34 INFO  ---RUNTIME: Importing and monkey-patching took 5.989313125610352 ms
2022-09-25 11:29:44 INFO  ---RUNTIME: Original pipeline execution took 10316.90764427185 ms (excluding imports and monkey-patching)
2022-09-25 11:29:44 INFO  Starting execution of 1 what-if analyses...
2022-09-25 11:29:44 INFO  Start plan generation for analysis DataCorruption...
2022-09-25 11:29:44 INFO  ---RUNTIME: Plan generation took 0.4112720489501953 ms
2022-09-25 11:29:44 INFO  Estimated runtime of original DAG is 9997.411727905273ms
2022-09-25 11:29:44 WARNING Skipping Multi-Query Optimization (instead, only applying patches)
2022-09-25 11:29:44 INFO  Estimated unoptimised what-if runtime is 249935.29319763184ms
2022-09-25 11:29:44 INFO  ---RUNTIME: Multi-Query Optimization took 20.078659057617188 ms
2022-09-25 11:29:44 INFO  Executing generated plans
2022-09-25 11:34:07 INFO  ---RUNTIME: Execution took 262936.44762039185 ms
2022-09-25 11:34:07 INFO  Done!
2022-09-25 11:34:07 INFO  # Finished -- repetition 2 of 7 
2022-09-25 11:34:07 INFO  # Optimization benchmark for data_corruption with args [['reviews', 'slow_loading', 'featurization_4', 'logistic_regression']] -- repetition 3 of 7
2022-09-25 11:34:07 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-25 11:34:07 INFO  Running instrumented original pipeline...
2022-09-25 11:34:07 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-25 11:34:07 INFO  ---RUNTIME: Importing and monkey-patching took 5.915164947509766 ms
2022-09-25 11:34:17 INFO  ---RUNTIME: Original pipeline execution took 10509.56130027771 ms (excluding imports and monkey-patching)
2022-09-25 11:34:17 INFO  Starting execution of 1 what-if analyses...
2022-09-25 11:34:17 INFO  Start plan generation for analysis DataCorruption...
2022-09-25 11:34:17 INFO  ---RUNTIME: Plan generation took 0.4086494445800781 ms
2022-09-25 11:34:17 INFO  Estimated runtime of original DAG is 10203.37200164795ms
2022-09-25 11:34:17 INFO  Performing Multi-Query Optimization
2022-09-25 11:34:17 INFO  Estimated unoptimized what-if runtime is 255084.30004119873ms
2022-09-25 11:34:17 INFO  Estimated optimised what-if runtime is 11288.189888000488ms
2022-09-25 11:34:17 INFO  Estimated optimisation runtime saving is 243796.11015319824ms
2022-09-25 11:34:17 INFO  ---RUNTIME: Multi-Query Optimization took 67.7194595336914 ms
2022-09-25 11:34:17 INFO  Executing generated plans
2022-09-25 11:34:32 INFO  ---RUNTIME: Execution took 14808.289051055908 ms
2022-09-25 11:34:32 INFO  Done!
2022-09-25 11:34:32 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-25 11:34:32 INFO  Running instrumented original pipeline...
2022-09-25 11:34:32 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-25 11:34:32 INFO  ---RUNTIME: Importing and monkey-patching took 6.560802459716797 ms
2022-09-25 11:34:43 INFO  ---RUNTIME: Original pipeline execution took 10275.99811553955 ms (excluding imports and monkey-patching)
2022-09-25 11:34:43 INFO  Starting execution of 1 what-if analyses...
2022-09-25 11:34:43 INFO  Start plan generation for analysis DataCorruption...
2022-09-25 11:34:43 INFO  ---RUNTIME: Plan generation took 0.4107952117919922 ms
2022-09-25 11:34:43 INFO  Estimated runtime of original DAG is 9969.9387550354ms
2022-09-25 11:34:43 WARNING Skipping Multi-Query Optimization (instead, only applying patches)
2022-09-25 11:34:43 INFO  Estimated unoptimised what-if runtime is 249248.468875885ms
2022-09-25 11:34:43 INFO  ---RUNTIME: Multi-Query Optimization took 19.650697708129883 ms
2022-09-25 11:34:43 INFO  Executing generated plans
2022-09-25 11:39:03 INFO  ---RUNTIME: Execution took 260272.2532749176 ms
2022-09-25 11:39:03 INFO  Done!
2022-09-25 11:39:03 INFO  # Finished -- repetition 3 of 7 
2022-09-25 11:39:03 INFO  # Optimization benchmark for data_corruption with args [['reviews', 'slow_loading', 'featurization_4', 'logistic_regression']] -- repetition 4 of 7
2022-09-25 11:39:03 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-25 11:39:03 INFO  Running instrumented original pipeline...
2022-09-25 11:39:03 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-25 11:39:03 INFO  ---RUNTIME: Importing and monkey-patching took 6.345987319946289 ms
2022-09-25 11:39:14 INFO  ---RUNTIME: Original pipeline execution took 10744.061708450317 ms (excluding imports and monkey-patching)
2022-09-25 11:39:14 INFO  Starting execution of 1 what-if analyses...
2022-09-25 11:39:14 INFO  Start plan generation for analysis DataCorruption...
2022-09-25 11:39:14 INFO  ---RUNTIME: Plan generation took 0.44989585876464844 ms
2022-09-25 11:39:14 INFO  Estimated runtime of original DAG is 10404.13236618042ms
2022-09-25 11:39:14 INFO  Performing Multi-Query Optimization
2022-09-25 11:39:14 INFO  Estimated unoptimized what-if runtime is 260103.3091545105ms
2022-09-25 11:39:14 INFO  Estimated optimised what-if runtime is 11493.19338798523ms
2022-09-25 11:39:14 INFO  Estimated optimisation runtime saving is 248610.11576652527ms
2022-09-25 11:39:14 INFO  ---RUNTIME: Multi-Query Optimization took 68.0091381072998 ms
2022-09-25 11:39:14 INFO  Executing generated plans
2022-09-25 11:39:29 INFO  ---RUNTIME: Execution took 15119.813442230225 ms
2022-09-25 11:39:29 INFO  Done!
2022-09-25 11:39:29 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-25 11:39:29 INFO  Running instrumented original pipeline...
2022-09-25 11:39:29 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-25 11:39:29 INFO  ---RUNTIME: Importing and monkey-patching took 5.81669807434082 ms
2022-09-25 11:39:39 INFO  ---RUNTIME: Original pipeline execution took 10287.426710128784 ms (excluding imports and monkey-patching)
2022-09-25 11:39:39 INFO  Starting execution of 1 what-if analyses...
2022-09-25 11:39:39 INFO  Start plan generation for analysis DataCorruption...
2022-09-25 11:39:39 INFO  ---RUNTIME: Plan generation took 0.4305839538574219 ms
2022-09-25 11:39:39 INFO  Estimated runtime of original DAG is 9980.46875ms
2022-09-25 11:39:39 WARNING Skipping Multi-Query Optimization (instead, only applying patches)
2022-09-25 11:39:39 INFO  Estimated unoptimised what-if runtime is 249511.71875ms
2022-09-25 11:39:39 INFO  ---RUNTIME: Multi-Query Optimization took 20.29109001159668 ms
2022-09-25 11:39:39 INFO  Executing generated plans
2022-09-25 11:44:01 INFO  ---RUNTIME: Execution took 261528.0728340149 ms
2022-09-25 11:44:01 INFO  Done!
2022-09-25 11:44:01 INFO  # Finished -- repetition 4 of 7 
2022-09-25 11:44:01 INFO  # Optimization benchmark for data_corruption with args [['reviews', 'slow_loading', 'featurization_4', 'logistic_regression']] -- repetition 5 of 7
2022-09-25 11:44:01 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-25 11:44:01 INFO  Running instrumented original pipeline...
2022-09-25 11:44:01 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-25 11:44:01 INFO  ---RUNTIME: Importing and monkey-patching took 6.228208541870117 ms
2022-09-25 11:44:11 INFO  ---RUNTIME: Original pipeline execution took 10351.285934448242 ms (excluding imports and monkey-patching)
2022-09-25 11:44:11 INFO  Starting execution of 1 what-if analyses...
2022-09-25 11:44:11 INFO  Start plan generation for analysis DataCorruption...
2022-09-25 11:44:11 INFO  ---RUNTIME: Plan generation took 0.37384033203125 ms
2022-09-25 11:44:11 INFO  Estimated runtime of original DAG is 10046.43177986145ms
2022-09-25 11:44:11 INFO  Performing Multi-Query Optimization
2022-09-25 11:44:11 INFO  Estimated unoptimized what-if runtime is 251160.79449653625ms
2022-09-25 11:44:11 INFO  Estimated optimised what-if runtime is 11170.146703720093ms
2022-09-25 11:44:11 INFO  Estimated optimisation runtime saving is 239990.64779281616ms
2022-09-25 11:44:11 INFO  ---RUNTIME: Multi-Query Optimization took 68.21584701538086 ms
2022-09-25 11:44:11 INFO  Executing generated plans
2022-09-25 11:44:26 INFO  ---RUNTIME: Execution took 14796.326875686646 ms
2022-09-25 11:44:26 INFO  Done!
2022-09-25 11:44:26 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-25 11:44:26 INFO  Running instrumented original pipeline...
2022-09-25 11:44:26 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-25 11:44:26 INFO  ---RUNTIME: Importing and monkey-patching took 5.920171737670898 ms
2022-09-25 11:44:36 INFO  ---RUNTIME: Original pipeline execution took 9986.538648605347 ms (excluding imports and monkey-patching)
2022-09-25 11:44:36 INFO  Starting execution of 1 what-if analyses...
2022-09-25 11:44:36 INFO  Start plan generation for analysis DataCorruption...
2022-09-25 11:44:36 INFO  ---RUNTIME: Plan generation took 0.4024505615234375 ms
2022-09-25 11:44:36 INFO  Estimated runtime of original DAG is 9681.178331375122ms
2022-09-25 11:44:36 WARNING Skipping Multi-Query Optimization (instead, only applying patches)
2022-09-25 11:44:36 INFO  Estimated unoptimised what-if runtime is 242029.45828437805ms
2022-09-25 11:44:36 INFO  ---RUNTIME: Multi-Query Optimization took 20.0498104095459 ms
2022-09-25 11:44:36 INFO  Executing generated plans
2022-09-25 11:48:55 INFO  ---RUNTIME: Execution took 259110.77785491943 ms
2022-09-25 11:48:55 INFO  Done!
2022-09-25 11:48:55 INFO  # Finished -- repetition 5 of 7 
2022-09-25 11:48:55 INFO  # Optimization benchmark for data_corruption with args [['reviews', 'slow_loading', 'featurization_4', 'logistic_regression']] -- repetition 6 of 7
2022-09-25 11:48:55 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-25 11:48:55 INFO  Running instrumented original pipeline...
2022-09-25 11:48:55 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-25 11:48:55 INFO  ---RUNTIME: Importing and monkey-patching took 6.424665451049805 ms
2022-09-25 11:49:05 INFO  ---RUNTIME: Original pipeline execution took 10134.52935218811 ms (excluding imports and monkey-patching)
2022-09-25 11:49:05 INFO  Starting execution of 1 what-if analyses...
2022-09-25 11:49:05 INFO  Start plan generation for analysis DataCorruption...
2022-09-25 11:49:05 INFO  ---RUNTIME: Plan generation took 0.43773651123046875 ms
2022-09-25 11:49:05 INFO  Estimated runtime of original DAG is 9824.821949005127ms
2022-09-25 11:49:05 INFO  Performing Multi-Query Optimization
2022-09-25 11:49:05 INFO  Estimated unoptimized what-if runtime is 245620.54872512817ms
2022-09-25 11:49:05 INFO  Estimated optimised what-if runtime is 10924.40152168274ms
2022-09-25 11:49:05 INFO  Estimated optimisation runtime saving is 234696.14720344543ms
2022-09-25 11:49:05 INFO  ---RUNTIME: Multi-Query Optimization took 68.15576553344727 ms
2022-09-25 11:49:05 INFO  Executing generated plans
2022-09-25 11:49:21 INFO  ---RUNTIME: Execution took 15704.951047897339 ms
2022-09-25 11:49:21 INFO  Done!
2022-09-25 11:49:21 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-25 11:49:21 INFO  Running instrumented original pipeline...
2022-09-25 11:49:21 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-25 11:49:21 INFO  ---RUNTIME: Importing and monkey-patching took 6.197929382324219 ms
2022-09-25 11:49:31 INFO  ---RUNTIME: Original pipeline execution took 10136.608839035034 ms (excluding imports and monkey-patching)
2022-09-25 11:49:31 INFO  Starting execution of 1 what-if analyses...
2022-09-25 11:49:31 INFO  Start plan generation for analysis DataCorruption...
2022-09-25 11:49:31 INFO  ---RUNTIME: Plan generation took 0.40268898010253906 ms
2022-09-25 11:49:31 INFO  Estimated runtime of original DAG is 9830.54518699646ms
2022-09-25 11:49:31 WARNING Skipping Multi-Query Optimization (instead, only applying patches)
2022-09-25 11:49:31 INFO  Estimated unoptimised what-if runtime is 245763.6296749115ms
2022-09-25 11:49:31 INFO  ---RUNTIME: Multi-Query Optimization took 19.945383071899414 ms
2022-09-25 11:49:31 INFO  Executing generated plans
2022-09-25 11:53:51 INFO  ---RUNTIME: Execution took 260108.6449623108 ms
2022-09-25 11:53:51 INFO  Done!
2022-09-25 11:53:51 INFO  # Finished -- repetition 6 of 7 
2022-09-25 11:53:51 INFO  # Optimization benchmark for data_corruption with args [['reviews', 'slow_loading', 'featurization_4', 'logistic_regression']] -- repetition 7 of 7
2022-09-25 11:53:51 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-25 11:53:51 INFO  Running instrumented original pipeline...
2022-09-25 11:53:51 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-25 11:53:51 INFO  ---RUNTIME: Importing and monkey-patching took 6.197690963745117 ms
2022-09-25 11:54:02 INFO  ---RUNTIME: Original pipeline execution took 10355.88264465332 ms (excluding imports and monkey-patching)
2022-09-25 11:54:02 INFO  Starting execution of 1 what-if analyses...
2022-09-25 11:54:02 INFO  Start plan generation for analysis DataCorruption...
2022-09-25 11:54:02 INFO  ---RUNTIME: Plan generation took 0.3597736358642578 ms
2022-09-25 11:54:02 INFO  Estimated runtime of original DAG is 10047.03950881958ms
2022-09-25 11:54:02 INFO  Performing Multi-Query Optimization
2022-09-25 11:54:02 INFO  Estimated unoptimized what-if runtime is 251175.9877204895ms
2022-09-25 11:54:02 INFO  Estimated optimised what-if runtime is 11189.242124557495ms
2022-09-25 11:54:02 INFO  Estimated optimisation runtime saving is 239986.745595932ms
2022-09-25 11:54:02 INFO  ---RUNTIME: Multi-Query Optimization took 66.93673133850098 ms
2022-09-25 11:54:02 INFO  Executing generated plans
2022-09-25 11:54:17 INFO  ---RUNTIME: Execution took 14744.03190612793 ms
2022-09-25 11:54:17 INFO  Done!
2022-09-25 11:54:17 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-25 11:54:17 INFO  Running instrumented original pipeline...
2022-09-25 11:54:17 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-25 11:54:17 INFO  ---RUNTIME: Importing and monkey-patching took 5.966424942016602 ms
2022-09-25 11:54:27 INFO  ---RUNTIME: Original pipeline execution took 10093.513250350952 ms (excluding imports and monkey-patching)
2022-09-25 11:54:27 INFO  Starting execution of 1 what-if analyses...
2022-09-25 11:54:27 INFO  Start plan generation for analysis DataCorruption...
2022-09-25 11:54:27 INFO  ---RUNTIME: Plan generation took 0.43392181396484375 ms
2022-09-25 11:54:27 INFO  Estimated runtime of original DAG is 9772.341966629028ms
2022-09-25 11:54:27 WARNING Skipping Multi-Query Optimization (instead, only applying patches)
2022-09-25 11:54:27 INFO  Estimated unoptimised what-if runtime is 244308.5491657257ms
2022-09-25 11:54:27 INFO  ---RUNTIME: Multi-Query Optimization took 20.027637481689453 ms
2022-09-25 11:54:27 INFO  Executing generated plans
2022-09-25 11:58:46 INFO  ---RUNTIME: Execution took 259729.57921028137 ms
2022-09-25 11:58:46 INFO  Done!
2022-09-25 11:58:46 INFO  # Finished -- repetition 7 of 7 
2022-09-25 11:58:46 INFO  # Final results after all repetitions
2022-09-25 11:58:46 INFO     repetition  ... no_opt_what_if_execution_combined_model_training
0           0  ...                                      4727.419376
1           1  ...                                      4664.201975
2           2  ...                                      4538.249254
3           3  ...                                      4533.375978
4           4  ...                                      4593.177080
5           5  ...                                      4594.393492
6           6  ...                                      4546.045542

[7 rows x 26 columns]
PROTOCOL_BUFFERS_PYTHON_IMPLEMENTATION=python taskset -c 32-39 python3.9 benchmarks_end_to_end.py data_corruption reviews slow_loading featurization_4 xgboost
2022-09-25 11:58:49.137641: W tensorflow/stream_executor/platform/default/dso_loader.cc:64] Could not load dynamic library 'libcudart.so.11.0'; dlerror: libcudart.so.11.0: cannot open shared object file: No such file or directory; LD_LIBRARY_PATH: /home/sgrafbe/mlwhatif/venv/lib/python3.9/site-packages/cv2/../../lib64:
2022-09-25 11:58:49.137688: I tensorflow/stream_executor/cuda/cudart_stub.cc:29] Ignore above cudart dlerror if you do not have a GPU set up on your machine.
2022-09-25 11:58:50 INFO  Patching sys.argv with ['mlwhatif', 'reviews', 'slow_loading', 'featurization_4', 'xgboost']
2022-09-25 11:58:50 INFO  Running instrumented original pipeline...
2022-09-25 11:58:50 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-25 11:58:50 INFO  ---RUNTIME: Importing and monkey-patching took 95.55935859680176 ms
2022-09-25 11:59:12 INFO  ---RUNTIME: Original pipeline execution took 22472.424745559692 ms (excluding imports and monkey-patching)
2022-09-25 11:59:12 INFO  Starting execution of 0 what-if analyses...
2022-09-25 11:59:12 INFO  Estimated runtime of original DAG is 22125.797748565674ms
2022-09-25 11:59:12 INFO  Performing Multi-Query Optimization
2022-09-25 11:59:12 INFO  Estimated unoptimized what-if runtime is 0ms
2022-09-25 11:59:12 INFO  Estimated optimised what-if runtime is 0ms
2022-09-25 11:59:12 INFO  Estimated optimisation runtime saving is 0ms
2022-09-25 11:59:12 INFO  ---RUNTIME: Multi-Query Optimization took 0.5328655242919922 ms
2022-09-25 11:59:12 INFO  Executing generated plans
2022-09-25 11:59:12 INFO  ---RUNTIME: Execution took 0.026702880859375 ms
2022-09-25 11:59:12 INFO  Done!
2022-09-25 11:59:12 INFO  # Optimization benchmark for data_corruption with args [['reviews', 'slow_loading', 'featurization_4', 'xgboost']] -- repetition 1 of 7
2022-09-25 11:59:12 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-25 11:59:12 INFO  Running instrumented original pipeline...
2022-09-25 11:59:12 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-25 11:59:13 INFO  ---RUNTIME: Importing and monkey-patching took 5.542755126953125 ms
2022-09-25 11:59:35 INFO  ---RUNTIME: Original pipeline execution took 22161.91577911377 ms (excluding imports and monkey-patching)
2022-09-25 11:59:35 INFO  Starting execution of 1 what-if analyses...
2022-09-25 11:59:35 INFO  Start plan generation for analysis DataCorruption...
2022-09-25 11:59:35 INFO  ---RUNTIME: Plan generation took 0.6968975067138672 ms
2022-09-25 11:59:35 INFO  Estimated runtime of original DAG is 21848.832845687866ms
2022-09-25 11:59:35 INFO  Performing Multi-Query Optimization
2022-09-25 11:59:35 INFO  Estimated unoptimized what-if runtime is 546220.8211421967ms
2022-09-25 11:59:35 INFO  Estimated optimised what-if runtime is 30414.613962173462ms
2022-09-25 11:59:35 INFO  Estimated optimisation runtime saving is 515806.2071800232ms
2022-09-25 11:59:35 INFO  ---RUNTIME: Multi-Query Optimization took 68.90106201171875 ms
2022-09-25 11:59:35 INFO  Executing generated plans
2022-09-25 12:00:09 INFO  ---RUNTIME: Execution took 34211.485385894775 ms
2022-09-25 12:00:09 INFO  Done!
2022-09-25 12:00:09 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-25 12:00:09 INFO  Running instrumented original pipeline...
2022-09-25 12:00:09 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-25 12:00:09 INFO  ---RUNTIME: Importing and monkey-patching took 6.348133087158203 ms
2022-09-25 12:00:32 INFO  ---RUNTIME: Original pipeline execution took 22687.99328804016 ms (excluding imports and monkey-patching)
2022-09-25 12:00:32 INFO  Starting execution of 1 what-if analyses...
2022-09-25 12:00:32 INFO  Start plan generation for analysis DataCorruption...
2022-09-25 12:00:32 INFO  ---RUNTIME: Plan generation took 0.42128562927246094 ms
2022-09-25 12:00:32 INFO  Estimated runtime of original DAG is 22378.303050994873ms
2022-09-25 12:00:32 WARNING Skipping Multi-Query Optimization (instead, only applying patches)
2022-09-25 12:00:32 INFO  Estimated unoptimised what-if runtime is 559457.5762748718ms
2022-09-25 12:00:32 INFO  ---RUNTIME: Multi-Query Optimization took 20.039081573486328 ms
2022-09-25 12:00:32 INFO  Executing generated plans
2022-09-25 12:09:50 INFO  ---RUNTIME: Execution took 558124.0544319153 ms
2022-09-25 12:09:50 INFO  Done!
2022-09-25 12:09:50 INFO  # Finished -- repetition 1 of 7 
2022-09-25 12:09:50 INFO  # Optimization benchmark for data_corruption with args [['reviews', 'slow_loading', 'featurization_4', 'xgboost']] -- repetition 2 of 7
2022-09-25 12:09:50 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-25 12:09:50 INFO  Running instrumented original pipeline...
2022-09-25 12:09:50 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-25 12:09:50 INFO  ---RUNTIME: Importing and monkey-patching took 6.245851516723633 ms
2022-09-25 12:10:13 INFO  ---RUNTIME: Original pipeline execution took 22778.746604919434 ms (excluding imports and monkey-patching)
2022-09-25 12:10:13 INFO  Starting execution of 1 what-if analyses...
2022-09-25 12:10:13 INFO  Start plan generation for analysis DataCorruption...
2022-09-25 12:10:13 INFO  ---RUNTIME: Plan generation took 0.8301734924316406 ms
2022-09-25 12:10:13 INFO  Estimated runtime of original DAG is 22468.265056610107ms
2022-09-25 12:10:13 INFO  Performing Multi-Query Optimization
2022-09-25 12:10:13 INFO  Estimated unoptimized what-if runtime is 561706.6264152527ms
2022-09-25 12:10:13 INFO  Estimated optimised what-if runtime is 30715.20447731018ms
2022-09-25 12:10:13 INFO  Estimated optimisation runtime saving is 530991.4219379425ms
2022-09-25 12:10:13 INFO  ---RUNTIME: Multi-Query Optimization took 67.67559051513672 ms
2022-09-25 12:10:13 INFO  Executing generated plans
2022-09-25 12:10:47 INFO  ---RUNTIME: Execution took 34145.32446861267 ms
2022-09-25 12:10:47 INFO  Done!
2022-09-25 12:10:47 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-25 12:10:47 INFO  Running instrumented original pipeline...
2022-09-25 12:10:47 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-25 12:10:47 INFO  ---RUNTIME: Importing and monkey-patching took 5.987405776977539 ms
2022-09-25 12:11:09 INFO  ---RUNTIME: Original pipeline execution took 21994.043111801147 ms (excluding imports and monkey-patching)
2022-09-25 12:11:09 INFO  Starting execution of 1 what-if analyses...
2022-09-25 12:11:09 INFO  Start plan generation for analysis DataCorruption...
2022-09-25 12:11:09 INFO  ---RUNTIME: Plan generation took 0.4253387451171875 ms
2022-09-25 12:11:09 INFO  Estimated runtime of original DAG is 21681.586503982544ms
2022-09-25 12:11:09 WARNING Skipping Multi-Query Optimization (instead, only applying patches)
2022-09-25 12:11:09 INFO  Estimated unoptimised what-if runtime is 542039.6625995636ms
2022-09-25 12:11:09 INFO  ---RUNTIME: Multi-Query Optimization took 19.865751266479492 ms
2022-09-25 12:11:09 INFO  Executing generated plans
2022-09-25 12:20:26 INFO  ---RUNTIME: Execution took 557434.675693512 ms
2022-09-25 12:20:26 INFO  Done!
2022-09-25 12:20:26 INFO  # Finished -- repetition 2 of 7 
2022-09-25 12:20:26 INFO  # Optimization benchmark for data_corruption with args [['reviews', 'slow_loading', 'featurization_4', 'xgboost']] -- repetition 3 of 7
2022-09-25 12:20:26 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-25 12:20:26 INFO  Running instrumented original pipeline...
2022-09-25 12:20:26 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-25 12:20:26 INFO  ---RUNTIME: Importing and monkey-patching took 6.195306777954102 ms
2022-09-25 12:20:49 INFO  ---RUNTIME: Original pipeline execution took 22546.290636062622 ms (excluding imports and monkey-patching)
2022-09-25 12:20:49 INFO  Starting execution of 1 what-if analyses...
2022-09-25 12:20:49 INFO  Start plan generation for analysis DataCorruption...
2022-09-25 12:20:49 INFO  ---RUNTIME: Plan generation took 0.42891502380371094 ms
2022-09-25 12:20:49 INFO  Estimated runtime of original DAG is 22236.95421218872ms
2022-09-25 12:20:49 INFO  Performing Multi-Query Optimization
2022-09-25 12:20:49 INFO  Estimated unoptimized what-if runtime is 555923.855304718ms
2022-09-25 12:20:49 INFO  Estimated optimised what-if runtime is 30515.970468521118ms
2022-09-25 12:20:49 INFO  Estimated optimisation runtime saving is 525407.8848361969ms
2022-09-25 12:20:49 INFO  ---RUNTIME: Multi-Query Optimization took 68.08280944824219 ms
2022-09-25 12:20:49 INFO  Executing generated plans
2022-09-25 12:21:23 INFO  ---RUNTIME: Execution took 34265.774726867676 ms
2022-09-25 12:21:23 INFO  Done!
2022-09-25 12:21:23 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-25 12:21:23 INFO  Running instrumented original pipeline...
2022-09-25 12:21:23 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-25 12:21:23 INFO  ---RUNTIME: Importing and monkey-patching took 6.134986877441406 ms
2022-09-25 12:21:45 INFO  ---RUNTIME: Original pipeline execution took 22141.525506973267 ms (excluding imports and monkey-patching)
2022-09-25 12:21:45 INFO  Starting execution of 1 what-if analyses...
2022-09-25 12:21:45 INFO  Start plan generation for analysis DataCorruption...
2022-09-25 12:21:45 INFO  ---RUNTIME: Plan generation took 0.3895759582519531 ms
2022-09-25 12:21:45 INFO  Estimated runtime of original DAG is 21828.550100326538ms
2022-09-25 12:21:45 WARNING Skipping Multi-Query Optimization (instead, only applying patches)
2022-09-25 12:21:45 INFO  Estimated unoptimised what-if runtime is 545713.7525081635ms
2022-09-25 12:21:45 INFO  ---RUNTIME: Multi-Query Optimization took 19.663095474243164 ms
2022-09-25 12:21:45 INFO  Executing generated plans
2022-09-25 12:31:04 INFO  ---RUNTIME: Execution took 558490.3953075409 ms
2022-09-25 12:31:04 INFO  Done!
2022-09-25 12:31:04 INFO  # Finished -- repetition 3 of 7 
2022-09-25 12:31:04 INFO  # Optimization benchmark for data_corruption with args [['reviews', 'slow_loading', 'featurization_4', 'xgboost']] -- repetition 4 of 7
2022-09-25 12:31:04 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-25 12:31:04 INFO  Running instrumented original pipeline...
2022-09-25 12:31:04 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-25 12:31:04 INFO  ---RUNTIME: Importing and monkey-patching took 6.194829940795898 ms
2022-09-25 12:31:26 INFO  ---RUNTIME: Original pipeline execution took 22127.61378288269 ms (excluding imports and monkey-patching)
2022-09-25 12:31:26 INFO  Starting execution of 1 what-if analyses...
2022-09-25 12:31:26 INFO  Start plan generation for analysis DataCorruption...
2022-09-25 12:31:26 INFO  ---RUNTIME: Plan generation took 0.46706199645996094 ms
2022-09-25 12:31:26 INFO  Estimated runtime of original DAG is 21817.03495979309ms
2022-09-25 12:31:26 INFO  Performing Multi-Query Optimization
2022-09-25 12:31:26 INFO  Estimated unoptimized what-if runtime is 545425.8739948273ms
2022-09-25 12:31:26 INFO  Estimated optimised what-if runtime is 30294.947624206543ms
2022-09-25 12:31:26 INFO  Estimated optimisation runtime saving is 515130.9263706207ms
2022-09-25 12:31:26 INFO  ---RUNTIME: Multi-Query Optimization took 67.50869750976562 ms
2022-09-25 12:31:26 INFO  Executing generated plans
2022-09-25 12:32:00 INFO  ---RUNTIME: Execution took 34149.269104003906 ms
2022-09-25 12:32:00 INFO  Done!
2022-09-25 12:32:00 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-25 12:32:00 INFO  Running instrumented original pipeline...
2022-09-25 12:32:00 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-25 12:32:00 INFO  ---RUNTIME: Importing and monkey-patching took 5.850315093994141 ms
2022-09-25 12:32:22 INFO  ---RUNTIME: Original pipeline execution took 22119.985818862915 ms (excluding imports and monkey-patching)
2022-09-25 12:32:22 INFO  Starting execution of 1 what-if analyses...
2022-09-25 12:32:22 INFO  Start plan generation for analysis DataCorruption...
2022-09-25 12:32:22 INFO  ---RUNTIME: Plan generation took 0.6921291351318359 ms
2022-09-25 12:32:22 INFO  Estimated runtime of original DAG is 21807.846069335938ms
2022-09-25 12:32:22 WARNING Skipping Multi-Query Optimization (instead, only applying patches)
2022-09-25 12:32:22 INFO  Estimated unoptimised what-if runtime is 545196.1517333984ms
2022-09-25 12:32:22 INFO  ---RUNTIME: Multi-Query Optimization took 19.672870635986328 ms
2022-09-25 12:32:22 INFO  Executing generated plans
2022-09-25 12:41:41 INFO  ---RUNTIME: Execution took 558410.6848239899 ms
2022-09-25 12:41:41 INFO  Done!
2022-09-25 12:41:41 INFO  # Finished -- repetition 4 of 7 
2022-09-25 12:41:41 INFO  # Optimization benchmark for data_corruption with args [['reviews', 'slow_loading', 'featurization_4', 'xgboost']] -- repetition 5 of 7
2022-09-25 12:41:41 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-25 12:41:41 INFO  Running instrumented original pipeline...
2022-09-25 12:41:41 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-25 12:41:41 INFO  ---RUNTIME: Importing and monkey-patching took 6.2351226806640625 ms
2022-09-25 12:42:03 INFO  ---RUNTIME: Original pipeline execution took 22247.29895591736 ms (excluding imports and monkey-patching)
2022-09-25 12:42:03 INFO  Starting execution of 1 what-if analyses...
2022-09-25 12:42:03 INFO  Start plan generation for analysis DataCorruption...
2022-09-25 12:42:03 INFO  ---RUNTIME: Plan generation took 0.3895759582519531 ms
2022-09-25 12:42:03 INFO  Estimated runtime of original DAG is 21935.13798713684ms
2022-09-25 12:42:03 INFO  Performing Multi-Query Optimization
2022-09-25 12:42:03 INFO  Estimated unoptimized what-if runtime is 548378.449678421ms
2022-09-25 12:42:03 INFO  Estimated optimised what-if runtime is 30250.55956840515ms
2022-09-25 12:42:03 INFO  Estimated optimisation runtime saving is 518127.89011001587ms
2022-09-25 12:42:03 INFO  ---RUNTIME: Multi-Query Optimization took 67.53683090209961 ms
2022-09-25 12:42:03 INFO  Executing generated plans
2022-09-25 12:42:37 INFO  ---RUNTIME: Execution took 33785.9992980957 ms
2022-09-25 12:42:37 INFO  Done!
2022-09-25 12:42:37 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-25 12:42:37 INFO  Running instrumented original pipeline...
2022-09-25 12:42:37 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-25 12:42:37 INFO  ---RUNTIME: Importing and monkey-patching took 5.944013595581055 ms
2022-09-25 12:42:59 INFO  ---RUNTIME: Original pipeline execution took 22047.28412628174 ms (excluding imports and monkey-patching)
2022-09-25 12:42:59 INFO  Starting execution of 1 what-if analyses...
2022-09-25 12:42:59 INFO  Start plan generation for analysis DataCorruption...
2022-09-25 12:42:59 INFO  ---RUNTIME: Plan generation took 0.7278919219970703 ms
2022-09-25 12:42:59 INFO  Estimated runtime of original DAG is 21735.36205291748ms
2022-09-25 12:42:59 WARNING Skipping Multi-Query Optimization (instead, only applying patches)
2022-09-25 12:42:59 INFO  Estimated unoptimised what-if runtime is 543384.051322937ms
2022-09-25 12:42:59 INFO  ---RUNTIME: Multi-Query Optimization took 19.526004791259766 ms
2022-09-25 12:42:59 INFO  Executing generated plans
2022-09-25 12:52:18 INFO  ---RUNTIME: Execution took 558754.9636363983 ms
2022-09-25 12:52:18 INFO  Done!
2022-09-25 12:52:18 INFO  # Finished -- repetition 5 of 7 
2022-09-25 12:52:18 INFO  # Optimization benchmark for data_corruption with args [['reviews', 'slow_loading', 'featurization_4', 'xgboost']] -- repetition 6 of 7
2022-09-25 12:52:18 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-25 12:52:18 INFO  Running instrumented original pipeline...
2022-09-25 12:52:18 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-25 12:52:18 INFO  ---RUNTIME: Importing and monkey-patching took 6.536006927490234 ms
2022-09-25 12:52:40 INFO  ---RUNTIME: Original pipeline execution took 22544.148206710815 ms (excluding imports and monkey-patching)
2022-09-25 12:52:40 INFO  Starting execution of 1 what-if analyses...
2022-09-25 12:52:40 INFO  Start plan generation for analysis DataCorruption...
2022-09-25 12:52:40 INFO  ---RUNTIME: Plan generation took 0.4341602325439453 ms
2022-09-25 12:52:40 INFO  Estimated runtime of original DAG is 22019.01912689209ms
2022-09-25 12:52:40 INFO  Performing Multi-Query Optimization
2022-09-25 12:52:40 INFO  Estimated unoptimized what-if runtime is 550475.4781723022ms
2022-09-25 12:52:40 INFO  Estimated optimised what-if runtime is 30532.25088119507ms
2022-09-25 12:52:40 INFO  Estimated optimisation runtime saving is 519943.2272911072ms
2022-09-25 12:52:40 INFO  ---RUNTIME: Multi-Query Optimization took 67.58618354797363 ms
2022-09-25 12:52:40 INFO  Executing generated plans
2022-09-25 12:53:14 INFO  ---RUNTIME: Execution took 34077.821016311646 ms
2022-09-25 12:53:14 INFO  Done!
2022-09-25 12:53:15 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-25 12:53:15 INFO  Running instrumented original pipeline...
2022-09-25 12:53:15 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-25 12:53:15 INFO  ---RUNTIME: Importing and monkey-patching took 6.438255310058594 ms
2022-09-25 12:53:37 INFO  ---RUNTIME: Original pipeline execution took 22138.23699951172 ms (excluding imports and monkey-patching)
2022-09-25 12:53:37 INFO  Starting execution of 1 what-if analyses...
2022-09-25 12:53:37 INFO  Start plan generation for analysis DataCorruption...
2022-09-25 12:53:37 INFO  ---RUNTIME: Plan generation took 0.6501674652099609 ms
2022-09-25 12:53:37 INFO  Estimated runtime of original DAG is 21828.15670967102ms
2022-09-25 12:53:37 WARNING Skipping Multi-Query Optimization (instead, only applying patches)
2022-09-25 12:53:37 INFO  Estimated unoptimised what-if runtime is 545703.9177417755ms
2022-09-25 12:53:37 INFO  ---RUNTIME: Multi-Query Optimization took 19.3479061126709 ms
2022-09-25 12:53:37 INFO  Executing generated plans
2022-09-25 13:02:56 INFO  ---RUNTIME: Execution took 559456.3722610474 ms
2022-09-25 13:02:56 INFO  Done!
2022-09-25 13:02:56 INFO  # Finished -- repetition 6 of 7 
2022-09-25 13:02:56 INFO  # Optimization benchmark for data_corruption with args [['reviews', 'slow_loading', 'featurization_4', 'xgboost']] -- repetition 7 of 7
2022-09-25 13:02:56 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-25 13:02:56 INFO  Running instrumented original pipeline...
2022-09-25 13:02:56 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-25 13:02:56 INFO  ---RUNTIME: Importing and monkey-patching took 6.339788436889648 ms
2022-09-25 13:03:18 INFO  ---RUNTIME: Original pipeline execution took 22227.86808013916 ms (excluding imports and monkey-patching)
2022-09-25 13:03:18 INFO  Starting execution of 1 what-if analyses...
2022-09-25 13:03:18 INFO  Start plan generation for analysis DataCorruption...
2022-09-25 13:03:18 INFO  ---RUNTIME: Plan generation took 0.3693103790283203 ms
2022-09-25 13:03:18 INFO  Estimated runtime of original DAG is 21915.70210456848ms
2022-09-25 13:03:18 INFO  Performing Multi-Query Optimization
2022-09-25 13:03:18 INFO  Estimated unoptimized what-if runtime is 547892.552614212ms
2022-09-25 13:03:18 INFO  Estimated optimised what-if runtime is 30545.84312438965ms
2022-09-25 13:03:18 INFO  Estimated optimisation runtime saving is 517346.7094898224ms
2022-09-25 13:03:18 INFO  ---RUNTIME: Multi-Query Optimization took 67.2292709350586 ms
2022-09-25 13:03:18 INFO  Executing generated plans
2022-09-25 13:03:52 INFO  ---RUNTIME: Execution took 33981.04953765869 ms
2022-09-25 13:03:52 INFO  Done!
2022-09-25 13:03:52 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-25 13:03:52 INFO  Running instrumented original pipeline...
2022-09-25 13:03:52 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-25 13:03:52 INFO  ---RUNTIME: Importing and monkey-patching took 6.337642669677734 ms
2022-09-25 13:04:15 INFO  ---RUNTIME: Original pipeline execution took 22363.142013549805 ms (excluding imports and monkey-patching)
2022-09-25 13:04:15 INFO  Starting execution of 1 what-if analyses...
2022-09-25 13:04:15 INFO  Start plan generation for analysis DataCorruption...
2022-09-25 13:04:15 INFO  ---RUNTIME: Plan generation took 0.41484832763671875 ms
2022-09-25 13:04:15 INFO  Estimated runtime of original DAG is 22054.965257644653ms
2022-09-25 13:04:15 WARNING Skipping Multi-Query Optimization (instead, only applying patches)
2022-09-25 13:04:15 INFO  Estimated unoptimised what-if runtime is 551374.1314411163ms
2022-09-25 13:04:15 INFO  ---RUNTIME: Multi-Query Optimization took 19.782304763793945 ms
2022-09-25 13:04:15 INFO  Executing generated plans
2022-09-25 13:13:34 INFO  ---RUNTIME: Execution took 559235.0089550018 ms
2022-09-25 13:13:34 INFO  Done!
2022-09-25 13:13:34 INFO  # Finished -- repetition 7 of 7 
2022-09-25 13:13:34 INFO  # Final results after all repetitions
2022-09-25 13:13:34 INFO     repetition  ... no_opt_what_if_execution_combined_model_training
0           0  ...                                    294471.011162
1           1  ...                                    294288.275242
2           2  ...                                    294436.306000
3           3  ...                                    294432.710409
4           4  ...                                    294453.607082
5           5  ...                                    294327.941656
6           6  ...                                    294304.676771

[7 rows x 26 columns]
PROTOCOL_BUFFERS_PYTHON_IMPLEMENTATION=python taskset -c 32-39 python3.9 benchmarks_end_to_end.py data_corruption reviews slow_loading featurization_4 neural_network
2022-09-25 13:13:36.846885: W tensorflow/stream_executor/platform/default/dso_loader.cc:64] Could not load dynamic library 'libcudart.so.11.0'; dlerror: libcudart.so.11.0: cannot open shared object file: No such file or directory; LD_LIBRARY_PATH: /home/sgrafbe/mlwhatif/venv/lib/python3.9/site-packages/cv2/../../lib64:
2022-09-25 13:13:36.846928: I tensorflow/stream_executor/cuda/cudart_stub.cc:29] Ignore above cudart dlerror if you do not have a GPU set up on your machine.
2022-09-25 13:13:38 INFO  Patching sys.argv with ['mlwhatif', 'reviews', 'slow_loading', 'featurization_4', 'neural_network']
2022-09-25 13:13:38 INFO  Running instrumented original pipeline...
2022-09-25 13:13:38 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-25 13:13:38 INFO  ---RUNTIME: Importing and monkey-patching took 95.37482261657715 ms
2022-09-25 13:13:48.050316: W tensorflow/stream_executor/platform/default/dso_loader.cc:64] Could not load dynamic library 'libcuda.so.1'; dlerror: libcuda.so.1: cannot open shared object file: No such file or directory; LD_LIBRARY_PATH: /home/sgrafbe/mlwhatif/venv/lib/python3.9/site-packages/cv2/../../lib64:
2022-09-25 13:13:48.050353: W tensorflow/stream_executor/cuda/cuda_driver.cc:326] failed call to cuInit: UNKNOWN ERROR (303)
2022-09-25 13:13:48.050375: I tensorflow/stream_executor/cuda/cuda_diagnostics.cc:156] kernel driver does not appear to be running on this host (wagyu): /proc/driver/nvidia/version does not exist
2022-09-25 13:13:48.050905: I tensorflow/core/platform/cpu_feature_guard.cc:142] This TensorFlow binary is optimized with oneAPI Deep Neural Network Library (oneDNN) to use the following CPU instructions in performance-critical operations:  AVX2 FMA
To enable them in other operations, rebuild TensorFlow with the appropriate compiler flags.
2022-09-25 13:13:48.126643: I tensorflow/compiler/mlir/mlir_graph_optimization_pass.cc:176] None of the MLIR Optimization Passes are enabled (registered 2)
2022-09-25 13:13:48.138380: I tensorflow/core/platform/profile_utils/cpu_utils.cc:114] CPU Frequency: 2595290000 Hz
2022-09-25 13:13:52 INFO  ---RUNTIME: Original pipeline execution took 13922.312021255493 ms (excluding imports and monkey-patching)
2022-09-25 13:13:52 INFO  Starting execution of 0 what-if analyses...
2022-09-25 13:13:52 INFO  Estimated runtime of original DAG is 13566.779375076294ms
2022-09-25 13:13:52 INFO  Performing Multi-Query Optimization
2022-09-25 13:13:52 INFO  Estimated unoptimized what-if runtime is 0ms
2022-09-25 13:13:52 INFO  Estimated optimised what-if runtime is 0ms
2022-09-25 13:13:52 INFO  Estimated optimisation runtime saving is 0ms
2022-09-25 13:13:52 INFO  ---RUNTIME: Multi-Query Optimization took 0.5788803100585938 ms
2022-09-25 13:13:52 INFO  Executing generated plans
2022-09-25 13:13:52 INFO  ---RUNTIME: Execution took 0.024080276489257812 ms
2022-09-25 13:13:52 INFO  Done!
2022-09-25 13:13:52 INFO  # Optimization benchmark for data_corruption with args [['reviews', 'slow_loading', 'featurization_4', 'neural_network']] -- repetition 1 of 7
2022-09-25 13:13:52 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-25 13:13:52 INFO  Running instrumented original pipeline...
2022-09-25 13:13:52 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-25 13:13:52 INFO  ---RUNTIME: Importing and monkey-patching took 5.966424942016602 ms
2022-09-25 13:14:05 INFO  ---RUNTIME: Original pipeline execution took 13593.337297439575 ms (excluding imports and monkey-patching)
2022-09-25 13:14:05 INFO  Starting execution of 1 what-if analyses...
2022-09-25 13:14:05 INFO  Start plan generation for analysis DataCorruption...
2022-09-25 13:14:05 INFO  ---RUNTIME: Plan generation took 0.4372596740722656 ms
2022-09-25 13:14:05 INFO  Estimated runtime of original DAG is 13273.077011108398ms
2022-09-25 13:14:05 INFO  Performing Multi-Query Optimization
2022-09-25 13:14:06 INFO  Estimated unoptimized what-if runtime is 331826.92527770996ms
2022-09-25 13:14:06 INFO  Estimated optimised what-if runtime is 23901.25846862793ms
2022-09-25 13:14:06 INFO  Estimated optimisation runtime saving is 307925.66680908203ms
2022-09-25 13:14:06 INFO  ---RUNTIME: Multi-Query Optimization took 275.3009796142578 ms
2022-09-25 13:14:06 INFO  Executing generated plans
2022-09-25 13:14:33 INFO  ---RUNTIME: Execution took 27483.800649642944 ms
2022-09-25 13:14:33 INFO  Done!
2022-09-25 13:14:33 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-25 13:14:33 INFO  Running instrumented original pipeline...
2022-09-25 13:14:33 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-25 13:14:33 INFO  ---RUNTIME: Importing and monkey-patching took 6.501674652099609 ms
2022-09-25 13:14:47 INFO  ---RUNTIME: Original pipeline execution took 13767.967700958252 ms (excluding imports and monkey-patching)
2022-09-25 13:14:47 INFO  Starting execution of 1 what-if analyses...
2022-09-25 13:14:47 INFO  Start plan generation for analysis DataCorruption...
2022-09-25 13:14:47 INFO  ---RUNTIME: Plan generation took 0.4448890686035156 ms
2022-09-25 13:14:47 INFO  Estimated runtime of original DAG is 13451.39479637146ms
2022-09-25 13:14:47 WARNING Skipping Multi-Query Optimization (instead, only applying patches)
2022-09-25 13:14:47 INFO  Estimated unoptimised what-if runtime is 336284.8699092865ms
2022-09-25 13:14:47 INFO  ---RUNTIME: Multi-Query Optimization took 20.137786865234375 ms
2022-09-25 13:14:47 INFO  Executing generated plans
2022-09-25 13:20:34 INFO  ---RUNTIME: Execution took 347473.91152381897 ms
2022-09-25 13:20:34 INFO  Done!
2022-09-25 13:20:34 INFO  # Finished -- repetition 1 of 7 
2022-09-25 13:20:34 INFO  # Optimization benchmark for data_corruption with args [['reviews', 'slow_loading', 'featurization_4', 'neural_network']] -- repetition 2 of 7
2022-09-25 13:20:34 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-25 13:20:34 INFO  Running instrumented original pipeline...
2022-09-25 13:20:34 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-25 13:20:34 INFO  ---RUNTIME: Importing and monkey-patching took 6.249904632568359 ms
2022-09-25 13:20:48 INFO  ---RUNTIME: Original pipeline execution took 13455.111742019653 ms (excluding imports and monkey-patching)
2022-09-25 13:20:48 INFO  Starting execution of 1 what-if analyses...
2022-09-25 13:20:48 INFO  Start plan generation for analysis DataCorruption...
2022-09-25 13:20:48 INFO  ---RUNTIME: Plan generation took 0.4363059997558594 ms
2022-09-25 13:20:48 INFO  Estimated runtime of original DAG is 13133.439302444458ms
2022-09-25 13:20:48 INFO  Performing Multi-Query Optimization
2022-09-25 13:20:48 INFO  Estimated unoptimized what-if runtime is 328335.98256111145ms
2022-09-25 13:20:48 INFO  Estimated optimised what-if runtime is 23587.3544216156ms
2022-09-25 13:20:48 INFO  Estimated optimisation runtime saving is 304748.62813949585ms
2022-09-25 13:20:48 INFO  ---RUNTIME: Multi-Query Optimization took 71.39301300048828 ms
2022-09-25 13:20:48 INFO  Executing generated plans
2022-09-25 13:21:16 INFO  ---RUNTIME: Execution took 27777.546644210815 ms
2022-09-25 13:21:16 INFO  Done!
2022-09-25 13:21:16 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-25 13:21:16 INFO  Running instrumented original pipeline...
2022-09-25 13:21:16 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-25 13:21:16 INFO  ---RUNTIME: Importing and monkey-patching took 6.586551666259766 ms
2022-09-25 13:21:29 INFO  ---RUNTIME: Original pipeline execution took 13591.368198394775 ms (excluding imports and monkey-patching)
2022-09-25 13:21:29 INFO  Starting execution of 1 what-if analyses...
2022-09-25 13:21:29 INFO  Start plan generation for analysis DataCorruption...
2022-09-25 13:21:29 INFO  ---RUNTIME: Plan generation took 0.4506111145019531 ms
2022-09-25 13:21:29 INFO  Estimated runtime of original DAG is 13266.086101531982ms
2022-09-25 13:21:29 WARNING Skipping Multi-Query Optimization (instead, only applying patches)
2022-09-25 13:21:29 INFO  Estimated unoptimised what-if runtime is 331652.15253829956ms
2022-09-25 13:21:29 INFO  ---RUNTIME: Multi-Query Optimization took 20.742177963256836 ms
2022-09-25 13:21:29 INFO  Executing generated plans
2022-09-25 13:27:17 INFO  ---RUNTIME: Execution took 348256.54768943787 ms
2022-09-25 13:27:17 INFO  Done!
2022-09-25 13:27:18 INFO  # Finished -- repetition 2 of 7 
2022-09-25 13:27:18 INFO  # Optimization benchmark for data_corruption with args [['reviews', 'slow_loading', 'featurization_4', 'neural_network']] -- repetition 3 of 7
2022-09-25 13:27:18 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-25 13:27:18 INFO  Running instrumented original pipeline...
2022-09-25 13:27:18 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-25 13:27:18 INFO  ---RUNTIME: Importing and monkey-patching took 6.395578384399414 ms
2022-09-25 13:27:31 INFO  ---RUNTIME: Original pipeline execution took 13877.686262130737 ms (excluding imports and monkey-patching)
2022-09-25 13:27:31 INFO  Starting execution of 1 what-if analyses...
2022-09-25 13:27:31 INFO  Start plan generation for analysis DataCorruption...
2022-09-25 13:27:31 INFO  ---RUNTIME: Plan generation took 2.147674560546875 ms
2022-09-25 13:27:31 INFO  Estimated runtime of original DAG is 13556.867122650146ms
2022-09-25 13:27:31 INFO  Performing Multi-Query Optimization
2022-09-25 13:27:31 INFO  Estimated unoptimized what-if runtime is 338921.67806625366ms
2022-09-25 13:27:31 INFO  Estimated optimised what-if runtime is 23770.25556564331ms
2022-09-25 13:27:31 INFO  Estimated optimisation runtime saving is 315151.42250061035ms
2022-09-25 13:27:31 INFO  ---RUNTIME: Multi-Query Optimization took 68.90869140625 ms
2022-09-25 13:27:31 INFO  Executing generated plans
2022-09-25 13:27:59 INFO  ---RUNTIME: Execution took 27444.87762451172 ms
2022-09-25 13:27:59 INFO  Done!
2022-09-25 13:27:59 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-25 13:27:59 INFO  Running instrumented original pipeline...
2022-09-25 13:27:59 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-25 13:27:59 INFO  ---RUNTIME: Importing and monkey-patching took 6.260871887207031 ms
2022-09-25 13:28:13 INFO  ---RUNTIME: Original pipeline execution took 14165.467739105225 ms (excluding imports and monkey-patching)
2022-09-25 13:28:13 INFO  Starting execution of 1 what-if analyses...
2022-09-25 13:28:13 INFO  Start plan generation for analysis DataCorruption...
2022-09-25 13:28:13 INFO  ---RUNTIME: Plan generation took 0.3783702850341797 ms
2022-09-25 13:28:13 INFO  Estimated runtime of original DAG is 13813.066959381104ms
2022-09-25 13:28:13 WARNING Skipping Multi-Query Optimization (instead, only applying patches)
2022-09-25 13:28:13 INFO  Estimated unoptimised what-if runtime is 345326.6739845276ms
2022-09-25 13:28:13 INFO  ---RUNTIME: Multi-Query Optimization took 20.53999900817871 ms
2022-09-25 13:28:13 INFO  Executing generated plans
2022-09-25 13:34:02 INFO  ---RUNTIME: Execution took 348420.462846756 ms
2022-09-25 13:34:02 INFO  Done!
2022-09-25 13:34:02 INFO  # Finished -- repetition 3 of 7 
2022-09-25 13:34:02 INFO  # Optimization benchmark for data_corruption with args [['reviews', 'slow_loading', 'featurization_4', 'neural_network']] -- repetition 4 of 7
2022-09-25 13:34:02 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-25 13:34:02 INFO  Running instrumented original pipeline...
2022-09-25 13:34:02 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-25 13:34:02 INFO  ---RUNTIME: Importing and monkey-patching took 6.225824356079102 ms
2022-09-25 13:34:16 INFO  ---RUNTIME: Original pipeline execution took 13933.34698677063 ms (excluding imports and monkey-patching)
2022-09-25 13:34:16 INFO  Starting execution of 1 what-if analyses...
2022-09-25 13:34:16 INFO  Start plan generation for analysis DataCorruption...
2022-09-25 13:34:16 INFO  ---RUNTIME: Plan generation took 0.6000995635986328 ms
2022-09-25 13:34:16 INFO  Estimated runtime of original DAG is 13252.87938117981ms
2022-09-25 13:34:16 INFO  Performing Multi-Query Optimization
2022-09-25 13:34:16 INFO  Estimated unoptimized what-if runtime is 331321.98452949524ms
2022-09-25 13:34:16 INFO  Estimated optimised what-if runtime is 24149.699687957764ms
2022-09-25 13:34:16 INFO  Estimated optimisation runtime saving is 307172.2848415375ms
2022-09-25 13:34:16 INFO  ---RUNTIME: Multi-Query Optimization took 71.97332382202148 ms
2022-09-25 13:34:16 INFO  Executing generated plans
2022-09-25 13:34:43 INFO  ---RUNTIME: Execution took 27531.626224517822 ms
2022-09-25 13:34:43 INFO  Done!
2022-09-25 13:34:43 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-25 13:34:43 INFO  Running instrumented original pipeline...
2022-09-25 13:34:43 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-25 13:34:43 INFO  ---RUNTIME: Importing and monkey-patching took 6.373167037963867 ms
2022-09-25 13:34:57 INFO  ---RUNTIME: Original pipeline execution took 13958.74834060669 ms (excluding imports and monkey-patching)
2022-09-25 13:34:57 INFO  Starting execution of 1 what-if analyses...
2022-09-25 13:34:57 INFO  Start plan generation for analysis DataCorruption...
2022-09-25 13:34:57 INFO  ---RUNTIME: Plan generation took 0.4334449768066406 ms
2022-09-25 13:34:57 INFO  Estimated runtime of original DAG is 13632.76219367981ms
2022-09-25 13:34:57 WARNING Skipping Multi-Query Optimization (instead, only applying patches)
2022-09-25 13:34:57 INFO  Estimated unoptimised what-if runtime is 340819.05484199524ms
2022-09-25 13:34:57 INFO  ---RUNTIME: Multi-Query Optimization took 21.12865447998047 ms
2022-09-25 13:34:57 INFO  Executing generated plans
2022-09-25 13:40:45 INFO  ---RUNTIME: Execution took 348298.3567714691 ms
2022-09-25 13:40:45 INFO  Done!
2022-09-25 13:40:45 INFO  # Finished -- repetition 4 of 7 
2022-09-25 13:40:45 INFO  # Optimization benchmark for data_corruption with args [['reviews', 'slow_loading', 'featurization_4', 'neural_network']] -- repetition 5 of 7
2022-09-25 13:40:45 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-25 13:40:45 INFO  Running instrumented original pipeline...
2022-09-25 13:40:45 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-25 13:40:46 INFO  ---RUNTIME: Importing and monkey-patching took 6.349325180053711 ms
2022-09-25 13:40:59 INFO  ---RUNTIME: Original pipeline execution took 13540.851593017578 ms (excluding imports and monkey-patching)
2022-09-25 13:40:59 INFO  Starting execution of 1 what-if analyses...
2022-09-25 13:40:59 INFO  Start plan generation for analysis DataCorruption...
2022-09-25 13:40:59 INFO  ---RUNTIME: Plan generation took 2.4805068969726562 ms
2022-09-25 13:40:59 INFO  Estimated runtime of original DAG is 13215.360164642334ms
2022-09-25 13:40:59 INFO  Performing Multi-Query Optimization
2022-09-25 13:40:59 INFO  Estimated unoptimized what-if runtime is 330384.00411605835ms
2022-09-25 13:40:59 INFO  Estimated optimised what-if runtime is 23728.47843170166ms
2022-09-25 13:40:59 INFO  Estimated optimisation runtime saving is 306655.5256843567ms
2022-09-25 13:40:59 INFO  ---RUNTIME: Multi-Query Optimization took 70.76573371887207 ms
2022-09-25 13:40:59 INFO  Executing generated plans
2022-09-25 13:41:27 INFO  ---RUNTIME: Execution took 27495.82529067993 ms
2022-09-25 13:41:27 INFO  Done!
2022-09-25 13:41:27 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-25 13:41:27 INFO  Running instrumented original pipeline...
2022-09-25 13:41:27 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-25 13:41:27 INFO  ---RUNTIME: Importing and monkey-patching took 6.337642669677734 ms
2022-09-25 13:41:41 INFO  ---RUNTIME: Original pipeline execution took 13951.30205154419 ms (excluding imports and monkey-patching)
2022-09-25 13:41:41 INFO  Starting execution of 1 what-if analyses...
2022-09-25 13:41:41 INFO  Start plan generation for analysis DataCorruption...
2022-09-25 13:41:41 INFO  ---RUNTIME: Plan generation took 0.39839744567871094 ms
2022-09-25 13:41:41 INFO  Estimated runtime of original DAG is 13624.25947189331ms
2022-09-25 13:41:41 WARNING Skipping Multi-Query Optimization (instead, only applying patches)
2022-09-25 13:41:41 INFO  Estimated unoptimised what-if runtime is 340606.48679733276ms
2022-09-25 13:41:41 INFO  ---RUNTIME: Multi-Query Optimization took 20.389318466186523 ms
2022-09-25 13:41:41 INFO  Executing generated plans
2022-09-25 13:47:28 INFO  ---RUNTIME: Execution took 347084.34319496155 ms
2022-09-25 13:47:28 INFO  Done!
2022-09-25 13:47:28 INFO  # Finished -- repetition 5 of 7 
2022-09-25 13:47:28 INFO  # Optimization benchmark for data_corruption with args [['reviews', 'slow_loading', 'featurization_4', 'neural_network']] -- repetition 6 of 7
2022-09-25 13:47:28 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-25 13:47:28 INFO  Running instrumented original pipeline...
2022-09-25 13:47:28 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-25 13:47:28 INFO  ---RUNTIME: Importing and monkey-patching took 6.426095962524414 ms
2022-09-25 13:47:41 INFO  ---RUNTIME: Original pipeline execution took 13706.544637680054 ms (excluding imports and monkey-patching)
2022-09-25 13:47:41 INFO  Starting execution of 1 what-if analyses...
2022-09-25 13:47:41 INFO  Start plan generation for analysis DataCorruption...
2022-09-25 13:47:41 INFO  ---RUNTIME: Plan generation took 0.4563331604003906 ms
2022-09-25 13:47:41 INFO  Estimated runtime of original DAG is 13383.249044418335ms
2022-09-25 13:47:41 INFO  Performing Multi-Query Optimization
2022-09-25 13:47:41 INFO  Estimated unoptimized what-if runtime is 334581.2261104584ms
2022-09-25 13:47:41 INFO  Estimated optimised what-if runtime is 24076.175928115845ms
2022-09-25 13:47:41 INFO  Estimated optimisation runtime saving is 310505.05018234253ms
2022-09-25 13:47:41 INFO  ---RUNTIME: Multi-Query Optimization took 71.04825973510742 ms
2022-09-25 13:47:41 INFO  Executing generated plans
2022-09-25 13:48:09 INFO  ---RUNTIME: Execution took 27726.443767547607 ms
2022-09-25 13:48:09 INFO  Done!
2022-09-25 13:48:09 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-25 13:48:09 INFO  Running instrumented original pipeline...
2022-09-25 13:48:09 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-25 13:48:09 INFO  ---RUNTIME: Importing and monkey-patching took 6.508827209472656 ms
2022-09-25 13:48:23 INFO  ---RUNTIME: Original pipeline execution took 13403.843879699707 ms (excluding imports and monkey-patching)
2022-09-25 13:48:23 INFO  Starting execution of 1 what-if analyses...
2022-09-25 13:48:23 INFO  Start plan generation for analysis DataCorruption...
2022-09-25 13:48:23 INFO  ---RUNTIME: Plan generation took 0.43487548828125 ms
2022-09-25 13:48:23 INFO  Estimated runtime of original DAG is 13080.349206924438ms
2022-09-25 13:48:23 WARNING Skipping Multi-Query Optimization (instead, only applying patches)
2022-09-25 13:48:23 INFO  Estimated unoptimised what-if runtime is 327008.73017311096ms
2022-09-25 13:48:23 INFO  ---RUNTIME: Multi-Query Optimization took 21.828174591064453 ms
2022-09-25 13:48:23 INFO  Executing generated plans
2022-09-25 13:54:09 INFO  ---RUNTIME: Execution took 346614.62807655334 ms
2022-09-25 13:54:09 INFO  Done!
2022-09-25 13:54:09 INFO  # Finished -- repetition 6 of 7 
2022-09-25 13:54:09 INFO  # Optimization benchmark for data_corruption with args [['reviews', 'slow_loading', 'featurization_4', 'neural_network']] -- repetition 7 of 7
2022-09-25 13:54:09 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-25 13:54:09 INFO  Running instrumented original pipeline...
2022-09-25 13:54:10 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-25 13:54:10 INFO  ---RUNTIME: Importing and monkey-patching took 6.484508514404297 ms
2022-09-25 13:54:23 INFO  ---RUNTIME: Original pipeline execution took 13770.205020904541 ms (excluding imports and monkey-patching)
2022-09-25 13:54:23 INFO  Starting execution of 1 what-if analyses...
2022-09-25 13:54:23 INFO  Start plan generation for analysis DataCorruption...
2022-09-25 13:54:23 INFO  ---RUNTIME: Plan generation took 0.45228004455566406 ms
2022-09-25 13:54:23 INFO  Estimated runtime of original DAG is 13077.573299407959ms
2022-09-25 13:54:23 INFO  Performing Multi-Query Optimization
2022-09-25 13:54:23 INFO  Estimated unoptimized what-if runtime is 326939.332485199ms
2022-09-25 13:54:23 INFO  Estimated optimised what-if runtime is 23249.440670013428ms
2022-09-25 13:54:23 INFO  Estimated optimisation runtime saving is 303689.89181518555ms
2022-09-25 13:54:23 INFO  ---RUNTIME: Multi-Query Optimization took 71.81644439697266 ms
2022-09-25 13:54:23 INFO  Executing generated plans
2022-09-25 13:54:50 INFO  ---RUNTIME: Execution took 27208.00232887268 ms
2022-09-25 13:54:50 INFO  Done!
2022-09-25 13:54:50 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-25 13:54:50 INFO  Running instrumented original pipeline...
2022-09-25 13:54:50 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-25 13:54:50 INFO  ---RUNTIME: Importing and monkey-patching took 7.058143615722656 ms
2022-09-25 13:55:04 INFO  ---RUNTIME: Original pipeline execution took 13872.12085723877 ms (excluding imports and monkey-patching)
2022-09-25 13:55:04 INFO  Starting execution of 1 what-if analyses...
2022-09-25 13:55:04 INFO  Start plan generation for analysis DataCorruption...
2022-09-25 13:55:04 INFO  ---RUNTIME: Plan generation took 0.4096031188964844 ms
2022-09-25 13:55:04 INFO  Estimated runtime of original DAG is 13550.302743911743ms
2022-09-25 13:55:04 WARNING Skipping Multi-Query Optimization (instead, only applying patches)
2022-09-25 13:55:04 INFO  Estimated unoptimised what-if runtime is 338757.5685977936ms
2022-09-25 13:55:04 INFO  ---RUNTIME: Multi-Query Optimization took 20.410537719726562 ms
2022-09-25 13:55:04 INFO  Executing generated plans
2022-09-25 14:00:50 INFO  ---RUNTIME: Execution took 345284.4774723053 ms
2022-09-25 14:00:50 INFO  Done!
2022-09-25 14:00:50 INFO  # Finished -- repetition 7 of 7 
2022-09-25 14:00:50 INFO  # Final results after all repetitions
2022-09-25 14:00:50 INFO     repetition  ... no_opt_what_if_execution_combined_model_training
0           0  ...                                     83100.516319
1           1  ...                                     83606.243134
2           2  ...                                     83557.700157
3           3  ...                                     83340.077877
4           4  ...                                     83261.797190
5           5  ...                                     81496.969461
6           6  ...                                     81927.073002

[7 rows x 26 columns]
