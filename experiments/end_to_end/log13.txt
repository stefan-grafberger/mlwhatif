Variant name from 1-8: 13
Cores to use: 160-167
taskset -c 160-167 PROTOCOL_BUFFERS_PYTHON_IMPLEMENTATION=python python3.9 benchmarks_end_to_end.py operator_impact reviews slow_loading featurization_0 logistic_regression
2022-09-21 18:44:07.364320: W tensorflow/stream_executor/platform/default/dso_loader.cc:64] Could not load dynamic library 'libcudart.so.11.0'; dlerror: libcudart.so.11.0: cannot open shared object file: No such file or directory; LD_LIBRARY_PATH: /home/sgrafbe/mlwhatif/venv/lib/python3.9/site-packages/cv2/../../lib64:
2022-09-21 18:44:07.364366: I tensorflow/stream_executor/cuda/cudart_stub.cc:29] Ignore above cudart dlerror if you do not have a GPU set up on your machine.
2022-09-21 18:44:08 INFO  Patching sys.argv with ['mlwhatif', 'reviews', 'slow_loading', 'featurization_0', 'logistic_regression']
2022-09-21 18:44:08 INFO  Running instrumented original pipeline...
2022-09-21 18:44:08 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-21 18:44:08 INFO  ---RUNTIME: Importing and monkey-patching took 95.6730842590332 ms
2022-09-21 18:44:15 INFO  ---RUNTIME: Original pipeline execution took 7004.44769859314 ms (excluding imports and monkey-patching)
2022-09-21 18:44:15 INFO  Starting execution of 0 what-if analyses...
2022-09-21 18:44:15 INFO  Estimated runtime of original DAG is 5307.388067245483ms
2022-09-21 18:44:15 INFO  Performing Multi-Query Optimization
2022-09-21 18:44:15 INFO  Estimated unoptimized what-if runtime is 0ms
2022-09-21 18:44:15 INFO  Estimated optimised what-if runtime is 0ms
2022-09-21 18:44:15 INFO  Estimated optimisation runtime saving is 0ms
2022-09-21 18:44:15 INFO  ---RUNTIME: Multi-Query Optimization took 0.4837512969970703 ms
2022-09-21 18:44:15 INFO  Executing generated plans
2022-09-21 18:44:15 INFO  ---RUNTIME: Execution took 0.024318695068359375 ms
2022-09-21 18:44:15 INFO  Done!
2022-09-21 18:44:15 INFO  # Optimization benchmark for operator_impact with args [['reviews', 'slow_loading', 'featurization_0', 'logistic_regression']] -- repetition 1 of 7
2022-09-21 18:44:15 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-21 18:44:15 INFO  Running instrumented original pipeline...
2022-09-21 18:44:15 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-21 18:44:15 INFO  ---RUNTIME: Importing and monkey-patching took 5.654096603393555 ms
2022-09-21 18:44:22 INFO  ---RUNTIME: Original pipeline execution took 6957.993268966675 ms (excluding imports and monkey-patching)
2022-09-21 18:44:22 INFO  Starting execution of 1 what-if analyses...
2022-09-21 18:44:22 INFO  Start plan generation for analysis OperatorImpact...
2022-09-21 18:44:22 INFO  ---RUNTIME: Plan generation took 5.119085311889648 ms
2022-09-21 18:44:22 INFO  Estimated runtime of original DAG is 5277.590036392212ms
2022-09-21 18:44:22 INFO  Performing Multi-Query Optimization
2022-09-21 18:44:22 INFO  Estimated unoptimized what-if runtime is 16264.661025190731ms
2022-09-21 18:44:22 INFO  Estimated optimised what-if runtime is 11124.083509313881ms
2022-09-21 18:44:22 INFO  Estimated optimisation runtime saving is 5140.57751587685ms
2022-09-21 18:44:22 INFO  ---RUNTIME: Multi-Query Optimization took 141.6783332824707 ms
2022-09-21 18:44:22 INFO  Executing generated plans
2022-09-21 18:44:35 INFO  ---RUNTIME: Execution took 12462.635517120361 ms
2022-09-21 18:44:35 INFO  Done!
2022-09-21 18:44:35 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-21 18:44:35 INFO  Running instrumented original pipeline...
2022-09-21 18:44:35 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-21 18:44:35 INFO  ---RUNTIME: Importing and monkey-patching took 6.136894226074219 ms
2022-09-21 18:44:42 INFO  ---RUNTIME: Original pipeline execution took 7138.669729232788 ms (excluding imports and monkey-patching)
2022-09-21 18:44:42 INFO  Starting execution of 1 what-if analyses...
2022-09-21 18:44:42 INFO  Start plan generation for analysis OperatorImpact...
2022-09-21 18:44:42 INFO  ---RUNTIME: Plan generation took 4.32896614074707 ms
2022-09-21 18:44:42 INFO  Estimated runtime of original DAG is 5353.189945220947ms
2022-09-21 18:44:42 WARNING Skipping Multi-Query Optimization (instead, only applying patches)
2022-09-21 18:44:42 INFO  Estimated unoptimised what-if runtime is 16451.749531638572ms
2022-09-21 18:44:42 INFO  ---RUNTIME: Multi-Query Optimization took 29.53028678894043 ms
2022-09-21 18:44:42 INFO  Executing generated plans
2022-09-21 18:45:01 INFO  ---RUNTIME: Execution took 19176.640033721924 ms
2022-09-21 18:45:01 INFO  Done!
2022-09-21 18:45:01 INFO  # Finished -- repetition 1 of 7 
2022-09-21 18:45:01 INFO  # Optimization benchmark for operator_impact with args [['reviews', 'slow_loading', 'featurization_0', 'logistic_regression']] -- repetition 2 of 7
2022-09-21 18:45:01 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-21 18:45:01 INFO  Running instrumented original pipeline...
2022-09-21 18:45:01 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-21 18:45:01 INFO  ---RUNTIME: Importing and monkey-patching took 6.004810333251953 ms
2022-09-21 18:45:08 INFO  ---RUNTIME: Original pipeline execution took 6968.887567520142 ms (excluding imports and monkey-patching)
2022-09-21 18:45:08 INFO  Starting execution of 1 what-if analyses...
2022-09-21 18:45:08 INFO  Start plan generation for analysis OperatorImpact...
2022-09-21 18:45:08 INFO  ---RUNTIME: Plan generation took 4.546165466308594 ms
2022-09-21 18:45:08 INFO  Estimated runtime of original DAG is 5306.025743484497ms
2022-09-21 18:45:08 INFO  Performing Multi-Query Optimization
2022-09-21 18:45:08 INFO  Estimated unoptimized what-if runtime is 16352.046455648811ms
2022-09-21 18:45:08 INFO  Estimated optimised what-if runtime is 11172.448727111449ms
2022-09-21 18:45:08 INFO  Estimated optimisation runtime saving is 5179.597728537363ms
2022-09-21 18:45:08 INFO  ---RUNTIME: Multi-Query Optimization took 99.46870803833008 ms
2022-09-21 18:45:08 INFO  Executing generated plans
2022-09-21 18:45:21 INFO  ---RUNTIME: Execution took 12610.159873962402 ms
2022-09-21 18:45:21 INFO  Done!
2022-09-21 18:45:21 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-21 18:45:21 INFO  Running instrumented original pipeline...
2022-09-21 18:45:21 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-21 18:45:21 INFO  ---RUNTIME: Importing and monkey-patching took 6.000518798828125 ms
2022-09-21 18:45:28 INFO  ---RUNTIME: Original pipeline execution took 6952.418565750122 ms (excluding imports and monkey-patching)
2022-09-21 18:45:28 INFO  Starting execution of 1 what-if analyses...
2022-09-21 18:45:28 INFO  Start plan generation for analysis OperatorImpact...
2022-09-21 18:45:28 INFO  ---RUNTIME: Plan generation took 4.472970962524414 ms
2022-09-21 18:45:28 INFO  Estimated runtime of original DAG is 5315.62614440918ms
2022-09-21 18:45:28 WARNING Skipping Multi-Query Optimization (instead, only applying patches)
2022-09-21 18:45:28 INFO  Estimated unoptimised what-if runtime is 16338.15280553884ms
2022-09-21 18:45:28 INFO  ---RUNTIME: Multi-Query Optimization took 13.61703872680664 ms
2022-09-21 18:45:28 INFO  Executing generated plans
2022-09-21 18:45:47 INFO  ---RUNTIME: Execution took 19123.12912940979 ms
2022-09-21 18:45:47 INFO  Done!
2022-09-21 18:45:47 INFO  # Finished -- repetition 2 of 7 
2022-09-21 18:45:47 INFO  # Optimization benchmark for operator_impact with args [['reviews', 'slow_loading', 'featurization_0', 'logistic_regression']] -- repetition 3 of 7
2022-09-21 18:45:47 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-21 18:45:47 INFO  Running instrumented original pipeline...
2022-09-21 18:45:47 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-21 18:45:47 INFO  ---RUNTIME: Importing and monkey-patching took 5.748748779296875 ms
2022-09-21 18:45:54 INFO  ---RUNTIME: Original pipeline execution took 6914.409399032593 ms (excluding imports and monkey-patching)
2022-09-21 18:45:54 INFO  Starting execution of 1 what-if analyses...
2022-09-21 18:45:54 INFO  Start plan generation for analysis OperatorImpact...
2022-09-21 18:45:54 INFO  ---RUNTIME: Plan generation took 4.294395446777344 ms
2022-09-21 18:45:54 INFO  Estimated runtime of original DAG is 5258.953094482422ms
2022-09-21 18:45:54 INFO  Performing Multi-Query Optimization
2022-09-21 18:45:54 INFO  Estimated unoptimized what-if runtime is 16211.840269156575ms
2022-09-21 18:45:54 INFO  Estimated optimised what-if runtime is 11151.369533055284ms
2022-09-21 18:45:54 INFO  Estimated optimisation runtime saving is 5060.470736101292ms
2022-09-21 18:45:54 INFO  ---RUNTIME: Multi-Query Optimization took 102.78725624084473 ms
2022-09-21 18:45:54 INFO  Executing generated plans
2022-09-21 18:46:07 INFO  ---RUNTIME: Execution took 12708.630323410034 ms
2022-09-21 18:46:07 INFO  Done!
2022-09-21 18:46:07 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-21 18:46:07 INFO  Running instrumented original pipeline...
2022-09-21 18:46:07 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-21 18:46:07 INFO  ---RUNTIME: Importing and monkey-patching took 5.926609039306641 ms
2022-09-21 18:46:14 INFO  ---RUNTIME: Original pipeline execution took 6991.180419921875 ms (excluding imports and monkey-patching)
2022-09-21 18:46:14 INFO  Starting execution of 1 what-if analyses...
2022-09-21 18:46:14 INFO  Start plan generation for analysis OperatorImpact...
2022-09-21 18:46:14 INFO  ---RUNTIME: Plan generation took 4.345893859863281 ms
2022-09-21 18:46:14 INFO  Estimated runtime of original DAG is 5338.071346282959ms
2022-09-21 18:46:14 WARNING Skipping Multi-Query Optimization (instead, only applying patches)
2022-09-21 18:46:14 INFO  Estimated unoptimised what-if runtime is 16406.7055370725ms
2022-09-21 18:46:14 INFO  ---RUNTIME: Multi-Query Optimization took 13.895511627197266 ms
2022-09-21 18:46:14 INFO  Executing generated plans
2022-09-21 18:46:33 INFO  ---RUNTIME: Execution took 19024.75094795227 ms
2022-09-21 18:46:33 INFO  Done!
2022-09-21 18:46:33 INFO  # Finished -- repetition 3 of 7 
2022-09-21 18:46:33 INFO  # Optimization benchmark for operator_impact with args [['reviews', 'slow_loading', 'featurization_0', 'logistic_regression']] -- repetition 4 of 7
2022-09-21 18:46:33 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-21 18:46:33 INFO  Running instrumented original pipeline...
2022-09-21 18:46:33 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-21 18:46:33 INFO  ---RUNTIME: Importing and monkey-patching took 6.2103271484375 ms
2022-09-21 18:46:40 INFO  ---RUNTIME: Original pipeline execution took 6902.538061141968 ms (excluding imports and monkey-patching)
2022-09-21 18:46:40 INFO  Starting execution of 1 what-if analyses...
2022-09-21 18:46:40 INFO  Start plan generation for analysis OperatorImpact...
2022-09-21 18:46:40 INFO  ---RUNTIME: Plan generation took 4.295587539672852 ms
2022-09-21 18:46:40 INFO  Estimated runtime of original DAG is 5250.355243682861ms
2022-09-21 18:46:40 INFO  Performing Multi-Query Optimization
2022-09-21 18:46:40 INFO  Estimated unoptimized what-if runtime is 16180.993453356003ms
2022-09-21 18:46:40 INFO  Estimated optimised what-if runtime is 11109.582153291276ms
2022-09-21 18:46:40 INFO  Estimated optimisation runtime saving is 5071.411300064727ms
2022-09-21 18:46:40 INFO  ---RUNTIME: Multi-Query Optimization took 98.76608848571777 ms
2022-09-21 18:46:40 INFO  Executing generated plans
2022-09-21 18:46:52 INFO  ---RUNTIME: Execution took 12399.049758911133 ms
2022-09-21 18:46:52 INFO  Done!
2022-09-21 18:46:52 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-21 18:46:52 INFO  Running instrumented original pipeline...
2022-09-21 18:46:52 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-21 18:46:52 INFO  ---RUNTIME: Importing and monkey-patching took 5.851030349731445 ms
2022-09-21 18:46:59 INFO  ---RUNTIME: Original pipeline execution took 7175.821304321289 ms (excluding imports and monkey-patching)
2022-09-21 18:46:59 INFO  Starting execution of 1 what-if analyses...
2022-09-21 18:46:59 INFO  Start plan generation for analysis OperatorImpact...
2022-09-21 18:46:59 INFO  ---RUNTIME: Plan generation took 4.282474517822266 ms
2022-09-21 18:46:59 INFO  Estimated runtime of original DAG is 5257.05361366272ms
2022-09-21 18:46:59 WARNING Skipping Multi-Query Optimization (instead, only applying patches)
2022-09-21 18:46:59 INFO  Estimated unoptimised what-if runtime is 16160.753923008537ms
2022-09-21 18:46:59 INFO  ---RUNTIME: Multi-Query Optimization took 13.489007949829102 ms
2022-09-21 18:46:59 INFO  Executing generated plans
2022-09-21 18:47:19 INFO  ---RUNTIME: Execution took 19491.07336997986 ms
2022-09-21 18:47:19 INFO  Done!
2022-09-21 18:47:19 INFO  # Finished -- repetition 4 of 7 
2022-09-21 18:47:19 INFO  # Optimization benchmark for operator_impact with args [['reviews', 'slow_loading', 'featurization_0', 'logistic_regression']] -- repetition 5 of 7
2022-09-21 18:47:19 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-21 18:47:19 INFO  Running instrumented original pipeline...
2022-09-21 18:47:19 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-21 18:47:19 INFO  ---RUNTIME: Importing and monkey-patching took 5.807161331176758 ms
2022-09-21 18:47:26 INFO  ---RUNTIME: Original pipeline execution took 7063.2500648498535 ms (excluding imports and monkey-patching)
2022-09-21 18:47:26 INFO  Starting execution of 1 what-if analyses...
2022-09-21 18:47:26 INFO  Start plan generation for analysis OperatorImpact...
2022-09-21 18:47:26 INFO  ---RUNTIME: Plan generation took 4.2591094970703125 ms
2022-09-21 18:47:26 INFO  Estimated runtime of original DAG is 5364.255666732788ms
2022-09-21 18:47:26 INFO  Performing Multi-Query Optimization
2022-09-21 18:47:26 INFO  Estimated unoptimized what-if runtime is 16525.40168956017ms
2022-09-21 18:47:26 INFO  Estimated optimised what-if runtime is 11247.441950665676ms
2022-09-21 18:47:26 INFO  Estimated optimisation runtime saving is 5277.959738894495ms
2022-09-21 18:47:26 INFO  ---RUNTIME: Multi-Query Optimization took 138.63754272460938 ms
2022-09-21 18:47:26 INFO  Executing generated plans
2022-09-21 18:47:39 INFO  ---RUNTIME: Execution took 12567.530870437622 ms
2022-09-21 18:47:39 INFO  Done!
2022-09-21 18:47:39 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-21 18:47:39 INFO  Running instrumented original pipeline...
2022-09-21 18:47:39 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-21 18:47:39 INFO  ---RUNTIME: Importing and monkey-patching took 6.400585174560547 ms
2022-09-21 18:47:46 INFO  ---RUNTIME: Original pipeline execution took 7072.066307067871 ms (excluding imports and monkey-patching)
2022-09-21 18:47:46 INFO  Starting execution of 1 what-if analyses...
2022-09-21 18:47:46 INFO  Start plan generation for analysis OperatorImpact...
2022-09-21 18:47:46 INFO  ---RUNTIME: Plan generation took 4.8580169677734375 ms
2022-09-21 18:47:46 INFO  Estimated runtime of original DAG is 5382.513046264648ms
2022-09-21 18:47:46 WARNING Skipping Multi-Query Optimization (instead, only applying patches)
2022-09-21 18:47:46 INFO  Estimated unoptimised what-if runtime is 16536.975336153846ms
2022-09-21 18:47:46 INFO  ---RUNTIME: Multi-Query Optimization took 13.74506950378418 ms
2022-09-21 18:47:46 INFO  Executing generated plans
2022-09-21 18:48:05 INFO  ---RUNTIME: Execution took 19388.7677192688 ms
2022-09-21 18:48:05 INFO  Done!
2022-09-21 18:48:05 INFO  # Finished -- repetition 5 of 7 
2022-09-21 18:48:05 INFO  # Optimization benchmark for operator_impact with args [['reviews', 'slow_loading', 'featurization_0', 'logistic_regression']] -- repetition 6 of 7
2022-09-21 18:48:05 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-21 18:48:05 INFO  Running instrumented original pipeline...
2022-09-21 18:48:05 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-21 18:48:05 INFO  ---RUNTIME: Importing and monkey-patching took 5.838155746459961 ms
2022-09-21 18:48:12 INFO  ---RUNTIME: Original pipeline execution took 6987.723350524902 ms (excluding imports and monkey-patching)
2022-09-21 18:48:12 INFO  Starting execution of 1 what-if analyses...
2022-09-21 18:48:12 INFO  Start plan generation for analysis OperatorImpact...
2022-09-21 18:48:12 INFO  ---RUNTIME: Plan generation took 4.346609115600586 ms
2022-09-21 18:48:12 INFO  Estimated runtime of original DAG is 5301.522493362427ms
2022-09-21 18:48:12 INFO  Performing Multi-Query Optimization
2022-09-21 18:48:12 INFO  Estimated unoptimized what-if runtime is 16331.174177599994ms
2022-09-21 18:48:12 INFO  Estimated optimised what-if runtime is 11194.19871462499ms
2022-09-21 18:48:12 INFO  Estimated optimisation runtime saving is 5136.975462975004ms
2022-09-21 18:48:12 INFO  ---RUNTIME: Multi-Query Optimization took 99.83515739440918 ms
2022-09-21 18:48:12 INFO  Executing generated plans
2022-09-21 18:48:25 INFO  ---RUNTIME: Execution took 12537.283897399902 ms
2022-09-21 18:48:25 INFO  Done!
2022-09-21 18:48:25 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-21 18:48:25 INFO  Running instrumented original pipeline...
2022-09-21 18:48:25 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-21 18:48:25 INFO  ---RUNTIME: Importing and monkey-patching took 5.79380989074707 ms
2022-09-21 18:48:32 INFO  ---RUNTIME: Original pipeline execution took 7138.468265533447 ms (excluding imports and monkey-patching)
2022-09-21 18:48:32 INFO  Starting execution of 1 what-if analyses...
2022-09-21 18:48:32 INFO  Start plan generation for analysis OperatorImpact...
2022-09-21 18:48:32 INFO  ---RUNTIME: Plan generation took 4.265308380126953 ms
2022-09-21 18:48:32 INFO  Estimated runtime of original DAG is 5461.634874343872ms
2022-09-21 18:48:32 WARNING Skipping Multi-Query Optimization (instead, only applying patches)
2022-09-21 18:48:32 INFO  Estimated unoptimised what-if runtime is 16777.34602132796ms
2022-09-21 18:48:32 INFO  ---RUNTIME: Multi-Query Optimization took 13.628482818603516 ms
2022-09-21 18:48:32 INFO  Executing generated plans
2022-09-21 18:48:52 INFO  ---RUNTIME: Execution took 19828.91345024109 ms
2022-09-21 18:48:52 INFO  Done!
2022-09-21 18:48:52 INFO  # Finished -- repetition 6 of 7 
2022-09-21 18:48:52 INFO  # Optimization benchmark for operator_impact with args [['reviews', 'slow_loading', 'featurization_0', 'logistic_regression']] -- repetition 7 of 7
2022-09-21 18:48:52 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-21 18:48:52 INFO  Running instrumented original pipeline...
2022-09-21 18:48:52 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-21 18:48:52 INFO  ---RUNTIME: Importing and monkey-patching took 6.18290901184082 ms
2022-09-21 18:48:59 INFO  ---RUNTIME: Original pipeline execution took 6969.085693359375 ms (excluding imports and monkey-patching)
2022-09-21 18:48:59 INFO  Starting execution of 1 what-if analyses...
2022-09-21 18:48:59 INFO  Start plan generation for analysis OperatorImpact...
2022-09-21 18:48:59 INFO  ---RUNTIME: Plan generation took 4.410505294799805 ms
2022-09-21 18:48:59 INFO  Estimated runtime of original DAG is 5299.698352813721ms
2022-09-21 18:48:59 INFO  Performing Multi-Query Optimization
2022-09-21 18:48:59 INFO  Estimated unoptimized what-if runtime is 16328.9906252999ms
2022-09-21 18:48:59 INFO  Estimated optimised what-if runtime is 11159.197767341884ms
2022-09-21 18:48:59 INFO  Estimated optimisation runtime saving is 5169.792857958017ms
2022-09-21 18:48:59 INFO  ---RUNTIME: Multi-Query Optimization took 100.55041313171387 ms
2022-09-21 18:48:59 INFO  Executing generated plans
2022-09-21 18:49:11 INFO  ---RUNTIME: Execution took 12490.89503288269 ms
2022-09-21 18:49:11 INFO  Done!
2022-09-21 18:49:11 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-21 18:49:11 INFO  Running instrumented original pipeline...
2022-09-21 18:49:11 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-21 18:49:11 INFO  ---RUNTIME: Importing and monkey-patching took 5.697488784790039 ms
2022-09-21 18:49:18 INFO  ---RUNTIME: Original pipeline execution took 7092.350006103516 ms (excluding imports and monkey-patching)
2022-09-21 18:49:18 INFO  Starting execution of 1 what-if analyses...
2022-09-21 18:49:18 INFO  Start plan generation for analysis OperatorImpact...
2022-09-21 18:49:18 INFO  ---RUNTIME: Plan generation took 4.242658615112305 ms
2022-09-21 18:49:18 INFO  Estimated runtime of original DAG is 5415.752649307251ms
2022-09-21 18:49:18 WARNING Skipping Multi-Query Optimization (instead, only applying patches)
2022-09-21 18:49:18 INFO  Estimated unoptimised what-if runtime is 16637.175771490896ms
2022-09-21 18:49:18 INFO  ---RUNTIME: Multi-Query Optimization took 13.742685317993164 ms
2022-09-21 18:49:18 INFO  Executing generated plans
2022-09-21 18:49:38 INFO  ---RUNTIME: Execution took 19130.20920753479 ms
2022-09-21 18:49:38 INFO  Done!
2022-09-21 18:49:38 INFO  # Finished -- repetition 7 of 7 
2022-09-21 18:49:38 INFO  # Final results after all repetitions
2022-09-21 18:49:38 INFO     repetition  ... no_opt_what_if_execution_combined_model_training
0           0  ...                                       459.221363
1           1  ...                                       463.741541
2           2  ...                                       460.031509
3           3  ...                                       465.502739
4           4  ...                                       465.257645
5           5  ...                                       462.459087
6           6  ...                                       461.882830

[7 rows x 26 columns]
taskset -c 160-167 PROTOCOL_BUFFERS_PYTHON_IMPLEMENTATION=python python3.9 benchmarks_end_to_end.py operator_impact reviews slow_loading featurization_0 xgboost
2022-09-21 18:49:40.222776: W tensorflow/stream_executor/platform/default/dso_loader.cc:64] Could not load dynamic library 'libcudart.so.11.0'; dlerror: libcudart.so.11.0: cannot open shared object file: No such file or directory; LD_LIBRARY_PATH: /home/sgrafbe/mlwhatif/venv/lib/python3.9/site-packages/cv2/../../lib64:
2022-09-21 18:49:40.222820: I tensorflow/stream_executor/cuda/cudart_stub.cc:29] Ignore above cudart dlerror if you do not have a GPU set up on your machine.
2022-09-21 18:49:41 INFO  Patching sys.argv with ['mlwhatif', 'reviews', 'slow_loading', 'featurization_0', 'xgboost']
2022-09-21 18:49:41 INFO  Running instrumented original pipeline...
2022-09-21 18:49:41 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-21 18:49:41 INFO  ---RUNTIME: Importing and monkey-patching took 94.46191787719727 ms
2022-09-21 18:50:01 INFO  ---RUNTIME: Original pipeline execution took 20161.52000427246 ms (excluding imports and monkey-patching)
2022-09-21 18:50:01 INFO  Starting execution of 0 what-if analyses...
2022-09-21 18:50:01 INFO  Estimated runtime of original DAG is 18514.1863822937ms
2022-09-21 18:50:01 INFO  Performing Multi-Query Optimization
2022-09-21 18:50:01 INFO  Estimated unoptimized what-if runtime is 0ms
2022-09-21 18:50:01 INFO  Estimated optimised what-if runtime is 0ms
2022-09-21 18:50:01 INFO  Estimated optimisation runtime saving is 0ms
2022-09-21 18:50:01 INFO  ---RUNTIME: Multi-Query Optimization took 0.5130767822265625 ms
2022-09-21 18:50:01 INFO  Executing generated plans
2022-09-21 18:50:01 INFO  ---RUNTIME: Execution took 0.025033950805664062 ms
2022-09-21 18:50:01 INFO  Done!
2022-09-21 18:50:01 INFO  # Optimization benchmark for operator_impact with args [['reviews', 'slow_loading', 'featurization_0', 'xgboost']] -- repetition 1 of 7
2022-09-21 18:50:01 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-21 18:50:01 INFO  Running instrumented original pipeline...
2022-09-21 18:50:01 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-21 18:50:01 INFO  ---RUNTIME: Importing and monkey-patching took 5.508899688720703 ms
2022-09-21 18:50:09 INFO  ---RUNTIME: Original pipeline execution took 7598.6974239349365 ms (excluding imports and monkey-patching)
2022-09-21 18:50:09 INFO  Starting execution of 1 what-if analyses...
2022-09-21 18:50:09 INFO  Start plan generation for analysis OperatorImpact...
2022-09-21 18:50:09 INFO  ---RUNTIME: Plan generation took 5.148410797119141 ms
2022-09-21 18:50:09 INFO  Estimated runtime of original DAG is 5997.388601303101ms
2022-09-21 18:50:09 INFO  Performing Multi-Query Optimization
2022-09-21 18:50:09 INFO  Estimated unoptimized what-if runtime is 18525.09636137908ms
2022-09-21 18:50:09 INFO  Estimated optimised what-if runtime is 13294.074511821042ms
2022-09-21 18:50:09 INFO  Estimated optimisation runtime saving is 5231.021849558039ms
2022-09-21 18:50:09 INFO  ---RUNTIME: Multi-Query Optimization took 99.81465339660645 ms
2022-09-21 18:50:09 INFO  Executing generated plans
2022-09-21 18:50:24 INFO  ---RUNTIME: Execution took 15033.050537109375 ms
2022-09-21 18:50:24 INFO  Done!
2022-09-21 18:50:24 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-21 18:50:24 INFO  Running instrumented original pipeline...
2022-09-21 18:50:24 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-21 18:50:24 INFO  ---RUNTIME: Importing and monkey-patching took 6.132841110229492 ms
2022-09-21 18:50:32 INFO  ---RUNTIME: Original pipeline execution took 7894.487142562866 ms (excluding imports and monkey-patching)
2022-09-21 18:50:32 INFO  Starting execution of 1 what-if analyses...
2022-09-21 18:50:32 INFO  Start plan generation for analysis OperatorImpact...
2022-09-21 18:50:32 INFO  ---RUNTIME: Plan generation took 4.436254501342773 ms
2022-09-21 18:50:32 INFO  Estimated runtime of original DAG is 6086.160182952881ms
2022-09-21 18:50:32 WARNING Skipping Multi-Query Optimization (instead, only applying patches)
2022-09-21 18:50:32 INFO  Estimated unoptimised what-if runtime is 18744.922864222804ms
2022-09-21 18:50:32 INFO  ---RUNTIME: Multi-Query Optimization took 13.933181762695312 ms
2022-09-21 18:50:32 INFO  Executing generated plans
2022-09-21 18:50:54 INFO  ---RUNTIME: Execution took 22096.975088119507 ms
2022-09-21 18:50:54 INFO  Done!
2022-09-21 18:50:54 INFO  # Finished -- repetition 1 of 7 
2022-09-21 18:50:54 INFO  # Optimization benchmark for operator_impact with args [['reviews', 'slow_loading', 'featurization_0', 'xgboost']] -- repetition 2 of 7
2022-09-21 18:50:54 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-21 18:50:54 INFO  Running instrumented original pipeline...
2022-09-21 18:50:54 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-21 18:50:54 INFO  ---RUNTIME: Importing and monkey-patching took 6.048679351806641 ms
2022-09-21 18:51:02 INFO  ---RUNTIME: Original pipeline execution took 7745.376825332642 ms (excluding imports and monkey-patching)
2022-09-21 18:51:02 INFO  Starting execution of 1 what-if analyses...
2022-09-21 18:51:02 INFO  Start plan generation for analysis OperatorImpact...
2022-09-21 18:51:02 INFO  ---RUNTIME: Plan generation took 4.424333572387695 ms
2022-09-21 18:51:02 INFO  Estimated runtime of original DAG is 6112.916469573975ms
2022-09-21 18:51:02 INFO  Performing Multi-Query Optimization
2022-09-21 18:51:02 INFO  Estimated unoptimized what-if runtime is 18867.821995828715ms
2022-09-21 18:51:02 INFO  Estimated optimised what-if runtime is 13412.295977266018ms
2022-09-21 18:51:02 INFO  Estimated optimisation runtime saving is 5455.526018562698ms
2022-09-21 18:51:02 INFO  ---RUNTIME: Multi-Query Optimization took 100.82316398620605 ms
2022-09-21 18:51:02 INFO  Executing generated plans
2022-09-21 18:51:17 INFO  ---RUNTIME: Execution took 14801.774024963379 ms
2022-09-21 18:51:17 INFO  Done!
2022-09-21 18:51:17 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-21 18:51:17 INFO  Running instrumented original pipeline...
2022-09-21 18:51:17 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-21 18:51:17 INFO  ---RUNTIME: Importing and monkey-patching took 5.939960479736328 ms
2022-09-21 18:51:24 INFO  ---RUNTIME: Original pipeline execution took 7769.063234329224 ms (excluding imports and monkey-patching)
2022-09-21 18:51:24 INFO  Starting execution of 1 what-if analyses...
2022-09-21 18:51:24 INFO  Start plan generation for analysis OperatorImpact...
2022-09-21 18:51:24 INFO  ---RUNTIME: Plan generation took 4.320859909057617 ms
2022-09-21 18:51:24 INFO  Estimated runtime of original DAG is 5998.469591140747ms
2022-09-21 18:51:24 WARNING Skipping Multi-Query Optimization (instead, only applying patches)
2022-09-21 18:51:24 INFO  Estimated unoptimised what-if runtime is 18470.729964365084ms
2022-09-21 18:51:24 INFO  ---RUNTIME: Multi-Query Optimization took 13.544797897338867 ms
2022-09-21 18:51:24 INFO  Executing generated plans
2022-09-21 18:51:46 INFO  ---RUNTIME: Execution took 21904.040098190308 ms
2022-09-21 18:51:46 INFO  Done!
2022-09-21 18:51:46 INFO  # Finished -- repetition 2 of 7 
2022-09-21 18:51:46 INFO  # Optimization benchmark for operator_impact with args [['reviews', 'slow_loading', 'featurization_0', 'xgboost']] -- repetition 3 of 7
2022-09-21 18:51:46 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-21 18:51:46 INFO  Running instrumented original pipeline...
2022-09-21 18:51:46 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-21 18:51:46 INFO  ---RUNTIME: Importing and monkey-patching took 6.135702133178711 ms
2022-09-21 18:51:54 INFO  ---RUNTIME: Original pipeline execution took 7861.880540847778 ms (excluding imports and monkey-patching)
2022-09-21 18:51:54 INFO  Starting execution of 1 what-if analyses...
2022-09-21 18:51:54 INFO  Start plan generation for analysis OperatorImpact...
2022-09-21 18:51:54 INFO  ---RUNTIME: Plan generation took 4.453897476196289 ms
2022-09-21 18:51:54 INFO  Estimated runtime of original DAG is 6227.109432220459ms
2022-09-21 18:51:54 INFO  Performing Multi-Query Optimization
2022-09-21 18:51:54 INFO  Estimated unoptimized what-if runtime is 19211.437220557073ms
2022-09-21 18:51:54 INFO  Estimated optimised what-if runtime is 13513.39713667818ms
2022-09-21 18:51:54 INFO  Estimated optimisation runtime saving is 5698.040083878892ms
2022-09-21 18:51:54 INFO  ---RUNTIME: Multi-Query Optimization took 100.24666786193848 ms
2022-09-21 18:51:54 INFO  Executing generated plans
2022-09-21 18:52:09 INFO  ---RUNTIME: Execution took 15022.496461868286 ms
2022-09-21 18:52:09 INFO  Done!
2022-09-21 18:52:09 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-21 18:52:09 INFO  Running instrumented original pipeline...
2022-09-21 18:52:09 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-21 18:52:09 INFO  ---RUNTIME: Importing and monkey-patching took 7.818937301635742 ms
2022-09-21 18:52:17 INFO  ---RUNTIME: Original pipeline execution took 7563.217878341675 ms (excluding imports and monkey-patching)
2022-09-21 18:52:17 INFO  Starting execution of 1 what-if analyses...
2022-09-21 18:52:17 INFO  Start plan generation for analysis OperatorImpact...
2022-09-21 18:52:17 INFO  ---RUNTIME: Plan generation took 4.456281661987305 ms
2022-09-21 18:52:17 INFO  Estimated runtime of original DAG is 5915.318727493286ms
2022-09-21 18:52:17 WARNING Skipping Multi-Query Optimization (instead, only applying patches)
2022-09-21 18:52:17 INFO  Estimated unoptimised what-if runtime is 18221.83844128747ms
2022-09-21 18:52:17 INFO  ---RUNTIME: Multi-Query Optimization took 13.766765594482422 ms
2022-09-21 18:52:17 INFO  Executing generated plans
2022-09-21 18:52:39 INFO  ---RUNTIME: Execution took 21917.482137680054 ms
2022-09-21 18:52:39 INFO  Done!
2022-09-21 18:52:39 INFO  # Finished -- repetition 3 of 7 
2022-09-21 18:52:39 INFO  # Optimization benchmark for operator_impact with args [['reviews', 'slow_loading', 'featurization_0', 'xgboost']] -- repetition 4 of 7
2022-09-21 18:52:39 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-21 18:52:39 INFO  Running instrumented original pipeline...
2022-09-21 18:52:39 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-21 18:52:39 INFO  ---RUNTIME: Importing and monkey-patching took 5.810737609863281 ms
2022-09-21 18:52:47 INFO  ---RUNTIME: Original pipeline execution took 7846.71688079834 ms (excluding imports and monkey-patching)
2022-09-21 18:52:47 INFO  Starting execution of 1 what-if analyses...
2022-09-21 18:52:47 INFO  Start plan generation for analysis OperatorImpact...
2022-09-21 18:52:47 INFO  ---RUNTIME: Plan generation took 4.33349609375 ms
2022-09-21 18:52:47 INFO  Estimated runtime of original DAG is 6210.46781539917ms
2022-09-21 18:52:47 INFO  Performing Multi-Query Optimization
2022-09-21 18:52:47 INFO  Estimated unoptimized what-if runtime is 19162.158844797246ms
2022-09-21 18:52:47 INFO  Estimated optimised what-if runtime is 13531.12096818571ms
2022-09-21 18:52:47 INFO  Estimated optimisation runtime saving is 5631.0378766115355ms
2022-09-21 18:52:47 INFO  ---RUNTIME: Multi-Query Optimization took 99.99918937683105 ms
2022-09-21 18:52:47 INFO  Executing generated plans
2022-09-21 18:53:02 INFO  ---RUNTIME: Execution took 14820.817708969116 ms
2022-09-21 18:53:02 INFO  Done!
2022-09-21 18:53:02 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-21 18:53:02 INFO  Running instrumented original pipeline...
2022-09-21 18:53:02 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-21 18:53:02 INFO  ---RUNTIME: Importing and monkey-patching took 7.752656936645508 ms
2022-09-21 18:53:10 INFO  ---RUNTIME: Original pipeline execution took 8077.615737915039 ms (excluding imports and monkey-patching)
2022-09-21 18:53:10 INFO  Starting execution of 1 what-if analyses...
2022-09-21 18:53:10 INFO  Start plan generation for analysis OperatorImpact...
2022-09-21 18:53:10 INFO  ---RUNTIME: Plan generation took 4.231452941894531 ms
2022-09-21 18:53:10 INFO  Estimated runtime of original DAG is 6145.139217376709ms
2022-09-21 18:53:10 WARNING Skipping Multi-Query Optimization (instead, only applying patches)
2022-09-21 18:53:10 INFO  Estimated unoptimised what-if runtime is 18945.519842026948ms
2022-09-21 18:53:10 INFO  ---RUNTIME: Multi-Query Optimization took 13.843774795532227 ms
2022-09-21 18:53:10 INFO  Executing generated plans
2022-09-21 18:53:31 INFO  ---RUNTIME: Execution took 21610.140800476074 ms
2022-09-21 18:53:31 INFO  Done!
2022-09-21 18:53:31 INFO  # Finished -- repetition 4 of 7 
2022-09-21 18:53:31 INFO  # Optimization benchmark for operator_impact with args [['reviews', 'slow_loading', 'featurization_0', 'xgboost']] -- repetition 5 of 7
2022-09-21 18:53:31 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-21 18:53:31 INFO  Running instrumented original pipeline...
2022-09-21 18:53:31 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-21 18:53:31 INFO  ---RUNTIME: Importing and monkey-patching took 5.9967041015625 ms
2022-09-21 18:53:39 INFO  ---RUNTIME: Original pipeline execution took 7823.709011077881 ms (excluding imports and monkey-patching)
2022-09-21 18:53:39 INFO  Starting execution of 1 what-if analyses...
2022-09-21 18:53:39 INFO  Start plan generation for analysis OperatorImpact...
2022-09-21 18:53:39 INFO  ---RUNTIME: Plan generation took 4.312753677368164 ms
2022-09-21 18:53:39 INFO  Estimated runtime of original DAG is 6141.563653945923ms
2022-09-21 18:53:39 INFO  Performing Multi-Query Optimization
2022-09-21 18:53:39 INFO  Estimated unoptimized what-if runtime is 18948.329899461605ms
2022-09-21 18:53:39 INFO  Estimated optimised what-if runtime is 13358.850137454197ms
2022-09-21 18:53:39 INFO  Estimated optimisation runtime saving is 5589.479762007408ms
2022-09-21 18:53:39 INFO  ---RUNTIME: Multi-Query Optimization took 100.8000373840332 ms
2022-09-21 18:53:39 INFO  Executing generated plans
2022-09-21 18:53:54 INFO  ---RUNTIME: Execution took 15039.681911468506 ms
2022-09-21 18:53:54 INFO  Done!
2022-09-21 18:53:54 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-21 18:53:54 INFO  Running instrumented original pipeline...
2022-09-21 18:53:54 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-21 18:53:54 INFO  ---RUNTIME: Importing and monkey-patching took 5.75709342956543 ms
2022-09-21 18:54:02 INFO  ---RUNTIME: Original pipeline execution took 8041.233539581299 ms (excluding imports and monkey-patching)
2022-09-21 18:54:02 INFO  Starting execution of 1 what-if analyses...
2022-09-21 18:54:02 INFO  Start plan generation for analysis OperatorImpact...
2022-09-21 18:54:02 INFO  ---RUNTIME: Plan generation took 6.470680236816406 ms
2022-09-21 18:54:02 INFO  Estimated runtime of original DAG is 6349.837779998779ms
2022-09-21 18:54:02 WARNING Skipping Multi-Query Optimization (instead, only applying patches)
2022-09-21 18:54:02 INFO  Estimated unoptimised what-if runtime is 19551.83909410196ms
2022-09-21 18:54:02 INFO  ---RUNTIME: Multi-Query Optimization took 19.372940063476562 ms
2022-09-21 18:54:02 INFO  Executing generated plans
2022-09-21 18:54:24 INFO  ---RUNTIME: Execution took 21909.311771392822 ms
2022-09-21 18:54:24 INFO  Done!
2022-09-21 18:54:24 INFO  # Finished -- repetition 5 of 7 
2022-09-21 18:54:24 INFO  # Optimization benchmark for operator_impact with args [['reviews', 'slow_loading', 'featurization_0', 'xgboost']] -- repetition 6 of 7
2022-09-21 18:54:24 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-21 18:54:24 INFO  Running instrumented original pipeline...
2022-09-21 18:54:24 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-21 18:54:24 INFO  ---RUNTIME: Importing and monkey-patching took 6.075859069824219 ms
2022-09-21 18:54:32 INFO  ---RUNTIME: Original pipeline execution took 7858.948707580566 ms (excluding imports and monkey-patching)
2022-09-21 18:54:32 INFO  Starting execution of 1 what-if analyses...
2022-09-21 18:54:32 INFO  Start plan generation for analysis OperatorImpact...
2022-09-21 18:54:32 INFO  ---RUNTIME: Plan generation took 4.424571990966797 ms
2022-09-21 18:54:32 INFO  Estimated runtime of original DAG is 6166.659832000732ms
2022-09-21 18:54:32 INFO  Performing Multi-Query Optimization
2022-09-21 18:54:32 INFO  Estimated unoptimized what-if runtime is 19030.11526546467ms
2022-09-21 18:54:32 INFO  Estimated optimised what-if runtime is 13478.22903638888ms
2022-09-21 18:54:32 INFO  Estimated optimisation runtime saving is 5551.886229075788ms
2022-09-21 18:54:32 INFO  ---RUNTIME: Multi-Query Optimization took 100.63576698303223 ms
2022-09-21 18:54:32 INFO  Executing generated plans
2022-09-21 18:54:47 INFO  ---RUNTIME: Execution took 14984.614849090576 ms
2022-09-21 18:54:47 INFO  Done!
2022-09-21 18:54:47 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-21 18:54:47 INFO  Running instrumented original pipeline...
2022-09-21 18:54:47 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-21 18:54:47 INFO  ---RUNTIME: Importing and monkey-patching took 5.755424499511719 ms
2022-09-21 18:54:55 INFO  ---RUNTIME: Original pipeline execution took 7852.661371231079 ms (excluding imports and monkey-patching)
2022-09-21 18:54:55 INFO  Starting execution of 1 what-if analyses...
2022-09-21 18:54:55 INFO  Start plan generation for analysis OperatorImpact...
2022-09-21 18:54:55 INFO  ---RUNTIME: Plan generation took 4.514217376708984 ms
2022-09-21 18:54:55 INFO  Estimated runtime of original DAG is 6190.131187438965ms
2022-09-21 18:54:55 WARNING Skipping Multi-Query Optimization (instead, only applying patches)
2022-09-21 18:54:55 INFO  Estimated unoptimised what-if runtime is 19057.529972828008ms
2022-09-21 18:54:55 INFO  ---RUNTIME: Multi-Query Optimization took 13.852596282958984 ms
2022-09-21 18:54:55 INFO  Executing generated plans
2022-09-21 18:55:17 INFO  ---RUNTIME: Execution took 21704.758167266846 ms
2022-09-21 18:55:17 INFO  Done!
2022-09-21 18:55:17 INFO  # Finished -- repetition 6 of 7 
2022-09-21 18:55:17 INFO  # Optimization benchmark for operator_impact with args [['reviews', 'slow_loading', 'featurization_0', 'xgboost']] -- repetition 7 of 7
2022-09-21 18:55:17 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-21 18:55:17 INFO  Running instrumented original pipeline...
2022-09-21 18:55:17 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-21 18:55:17 INFO  ---RUNTIME: Importing and monkey-patching took 5.9223175048828125 ms
2022-09-21 18:55:25 INFO  ---RUNTIME: Original pipeline execution took 7874.433755874634 ms (excluding imports and monkey-patching)
2022-09-21 18:55:25 INFO  Starting execution of 1 what-if analyses...
2022-09-21 18:55:25 INFO  Start plan generation for analysis OperatorImpact...
2022-09-21 18:55:25 INFO  ---RUNTIME: Plan generation took 4.294157028198242 ms
2022-09-21 18:55:25 INFO  Estimated runtime of original DAG is 6131.532192230225ms
2022-09-21 18:55:25 INFO  Performing Multi-Query Optimization
2022-09-21 18:55:25 INFO  Estimated unoptimized what-if runtime is 18917.52956538088ms
2022-09-21 18:55:25 INFO  Estimated optimised what-if runtime is 13387.645925977411ms
2022-09-21 18:55:25 INFO  Estimated optimisation runtime saving is 5529.883639403468ms
2022-09-21 18:55:25 INFO  ---RUNTIME: Multi-Query Optimization took 99.28774833679199 ms
2022-09-21 18:55:25 INFO  Executing generated plans
2022-09-21 18:55:40 INFO  ---RUNTIME: Execution took 14834.896564483643 ms
2022-09-21 18:55:40 INFO  Done!
2022-09-21 18:55:40 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-21 18:55:40 INFO  Running instrumented original pipeline...
2022-09-21 18:55:40 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-21 18:55:40 INFO  ---RUNTIME: Importing and monkey-patching took 5.691766738891602 ms
2022-09-21 18:55:48 INFO  ---RUNTIME: Original pipeline execution took 7840.532302856445 ms (excluding imports and monkey-patching)
2022-09-21 18:55:48 INFO  Starting execution of 1 what-if analyses...
2022-09-21 18:55:48 INFO  Start plan generation for analysis OperatorImpact...
2022-09-21 18:55:48 INFO  ---RUNTIME: Plan generation took 4.3182373046875 ms
2022-09-21 18:55:48 INFO  Estimated runtime of original DAG is 6204.83660697937ms
2022-09-21 18:55:48 WARNING Skipping Multi-Query Optimization (instead, only applying patches)
2022-09-21 18:55:48 INFO  Estimated unoptimised what-if runtime is 19098.282964498925ms
2022-09-21 18:55:48 INFO  ---RUNTIME: Multi-Query Optimization took 13.544082641601562 ms
2022-09-21 18:55:48 INFO  Executing generated plans
2022-09-21 18:56:09 INFO  ---RUNTIME: Execution took 21645.102500915527 ms
2022-09-21 18:56:09 INFO  Done!
2022-09-21 18:56:09 INFO  # Finished -- repetition 7 of 7 
2022-09-21 18:56:09 INFO  # Final results after all repetitions
2022-09-21 18:56:09 INFO     repetition  ... no_opt_what_if_execution_combined_model_training
0           0  ...                                      2438.514709
1           1  ...                                      2384.330511
2           2  ...                                      2339.518785
3           3  ...                                      2369.014263
4           4  ...                                      2643.760443
5           5  ...                                      2553.431034
6           6  ...                                      2253.527164

[7 rows x 26 columns]
taskset -c 160-167 PROTOCOL_BUFFERS_PYTHON_IMPLEMENTATION=python python3.9 benchmarks_end_to_end.py operator_impact reviews slow_loading featurization_0 neural_network
2022-09-21 18:56:12.069677: W tensorflow/stream_executor/platform/default/dso_loader.cc:64] Could not load dynamic library 'libcudart.so.11.0'; dlerror: libcudart.so.11.0: cannot open shared object file: No such file or directory; LD_LIBRARY_PATH: /home/sgrafbe/mlwhatif/venv/lib/python3.9/site-packages/cv2/../../lib64:
2022-09-21 18:56:12.069724: I tensorflow/stream_executor/cuda/cudart_stub.cc:29] Ignore above cudart dlerror if you do not have a GPU set up on your machine.
2022-09-21 18:56:13 INFO  Patching sys.argv with ['mlwhatif', 'reviews', 'slow_loading', 'featurization_0', 'neural_network']
2022-09-21 18:56:13 INFO  Running instrumented original pipeline...
2022-09-21 18:56:13 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-21 18:56:13 INFO  ---RUNTIME: Importing and monkey-patching took 94.72370147705078 ms
2022-09-21 18:56:18.962288: W tensorflow/stream_executor/platform/default/dso_loader.cc:64] Could not load dynamic library 'libcuda.so.1'; dlerror: libcuda.so.1: cannot open shared object file: No such file or directory; LD_LIBRARY_PATH: /home/sgrafbe/mlwhatif/venv/lib/python3.9/site-packages/cv2/../../lib64:
2022-09-21 18:56:18.962324: W tensorflow/stream_executor/cuda/cuda_driver.cc:326] failed call to cuInit: UNKNOWN ERROR (303)
2022-09-21 18:56:18.962349: I tensorflow/stream_executor/cuda/cuda_diagnostics.cc:156] kernel driver does not appear to be running on this host (wagyu): /proc/driver/nvidia/version does not exist
2022-09-21 18:56:18.962825: I tensorflow/core/platform/cpu_feature_guard.cc:142] This TensorFlow binary is optimized with oneAPI Deep Neural Network Library (oneDNN) to use the following CPU instructions in performance-critical operations:  AVX2 FMA
To enable them in other operations, rebuild TensorFlow with the appropriate compiler flags.
2022-09-21 18:56:19.037194: I tensorflow/compiler/mlir/mlir_graph_optimization_pass.cc:176] None of the MLIR Optimization Passes are enabled (registered 2)
2022-09-21 18:56:19.049423: I tensorflow/core/platform/profile_utils/cpu_utils.cc:114] CPU Frequency: 2595290000 Hz
2022-09-21 18:56:24 INFO  ---RUNTIME: Original pipeline execution took 11109.097480773926 ms (excluding imports and monkey-patching)
2022-09-21 18:56:24 INFO  Starting execution of 0 what-if analyses...
2022-09-21 18:56:24 INFO  Estimated runtime of original DAG is 9427.536010742188ms
2022-09-21 18:56:24 INFO  Performing Multi-Query Optimization
2022-09-21 18:56:24 INFO  Estimated unoptimized what-if runtime is 0ms
2022-09-21 18:56:24 INFO  Estimated optimised what-if runtime is 0ms
2022-09-21 18:56:24 INFO  Estimated optimisation runtime saving is 0ms
2022-09-21 18:56:24 INFO  ---RUNTIME: Multi-Query Optimization took 0.47516822814941406 ms
2022-09-21 18:56:24 INFO  Executing generated plans
2022-09-21 18:56:24 INFO  ---RUNTIME: Execution took 0.02193450927734375 ms
2022-09-21 18:56:24 INFO  Done!
2022-09-21 18:56:24 INFO  # Optimization benchmark for operator_impact with args [['reviews', 'slow_loading', 'featurization_0', 'neural_network']] -- repetition 1 of 7
2022-09-21 18:56:24 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-21 18:56:24 INFO  Running instrumented original pipeline...
2022-09-21 18:56:24 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-21 18:56:24 INFO  ---RUNTIME: Importing and monkey-patching took 5.567312240600586 ms
2022-09-21 18:56:35 INFO  ---RUNTIME: Original pipeline execution took 10736.032485961914 ms (excluding imports and monkey-patching)
2022-09-21 18:56:35 INFO  Starting execution of 1 what-if analyses...
2022-09-21 18:56:35 INFO  Start plan generation for analysis OperatorImpact...
2022-09-21 18:56:35 INFO  ---RUNTIME: Plan generation took 5.1403045654296875 ms
2022-09-21 18:56:35 INFO  Estimated runtime of original DAG is 9102.736234664917ms
2022-09-21 18:56:35 INFO  Performing Multi-Query Optimization
2022-09-21 18:56:35 INFO  Estimated unoptimized what-if runtime is 28267.035170188326ms
2022-09-21 18:56:35 INFO  Estimated optimised what-if runtime is 22761.84286855368ms
2022-09-21 18:56:35 INFO  Estimated optimisation runtime saving is 5505.192301634648ms
2022-09-21 18:56:35 INFO  ---RUNTIME: Multi-Query Optimization took 103.52969169616699 ms
2022-09-21 18:56:35 INFO  Executing generated plans
2022-09-21 18:57:00 INFO  ---RUNTIME: Execution took 24722.256183624268 ms
2022-09-21 18:57:00 INFO  Done!
2022-09-21 18:57:00 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-21 18:57:00 INFO  Running instrumented original pipeline...
2022-09-21 18:57:00 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-21 18:57:00 INFO  ---RUNTIME: Importing and monkey-patching took 5.972385406494141 ms
2022-09-21 18:57:10 INFO  ---RUNTIME: Original pipeline execution took 10488.605737686157 ms (excluding imports and monkey-patching)
2022-09-21 18:57:10 INFO  Starting execution of 1 what-if analyses...
2022-09-21 18:57:10 INFO  Start plan generation for analysis OperatorImpact...
2022-09-21 18:57:10 INFO  ---RUNTIME: Plan generation took 4.406929016113281 ms
2022-09-21 18:57:10 INFO  Estimated runtime of original DAG is 8714.394569396973ms
2022-09-21 18:57:10 WARNING Skipping Multi-Query Optimization (instead, only applying patches)
2022-09-21 18:57:10 INFO  Estimated unoptimised what-if runtime is 27034.087321182018ms
2022-09-21 18:57:10 INFO  ---RUNTIME: Multi-Query Optimization took 13.335227966308594 ms
2022-09-21 18:57:10 INFO  Executing generated plans
2022-09-21 18:57:41 INFO  ---RUNTIME: Execution took 31094.218969345093 ms
2022-09-21 18:57:41 INFO  Done!
2022-09-21 18:57:41 INFO  # Finished -- repetition 1 of 7 
2022-09-21 18:57:41 INFO  # Optimization benchmark for operator_impact with args [['reviews', 'slow_loading', 'featurization_0', 'neural_network']] -- repetition 2 of 7
2022-09-21 18:57:41 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-21 18:57:41 INFO  Running instrumented original pipeline...
2022-09-21 18:57:41 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-21 18:57:41 INFO  ---RUNTIME: Importing and monkey-patching took 6.175994873046875 ms
2022-09-21 18:57:52 INFO  ---RUNTIME: Original pipeline execution took 11233.165979385376 ms (excluding imports and monkey-patching)
2022-09-21 18:57:52 INFO  Starting execution of 1 what-if analyses...
2022-09-21 18:57:52 INFO  Start plan generation for analysis OperatorImpact...
2022-09-21 18:57:52 INFO  ---RUNTIME: Plan generation took 4.389286041259766 ms
2022-09-21 18:57:52 INFO  Estimated runtime of original DAG is 9604.81333732605ms
2022-09-21 18:57:52 INFO  Performing Multi-Query Optimization
2022-09-21 18:57:53 INFO  Estimated unoptimized what-if runtime is 29838.077883408707ms
2022-09-21 18:57:53 INFO  Estimated optimised what-if runtime is 24190.971801149783ms
2022-09-21 18:57:53 INFO  Estimated optimisation runtime saving is 5647.106082258924ms
2022-09-21 18:57:53 INFO  ---RUNTIME: Multi-Query Optimization took 101.7603874206543 ms
2022-09-21 18:57:53 INFO  Executing generated plans
2022-09-21 18:58:17 INFO  ---RUNTIME: Execution took 24278.761386871338 ms
2022-09-21 18:58:17 INFO  Done!
2022-09-21 18:58:17 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-21 18:58:17 INFO  Running instrumented original pipeline...
2022-09-21 18:58:17 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-21 18:58:17 INFO  ---RUNTIME: Importing and monkey-patching took 6.18433952331543 ms
2022-09-21 18:58:27 INFO  ---RUNTIME: Original pipeline execution took 10570.085287094116 ms (excluding imports and monkey-patching)
2022-09-21 18:58:27 INFO  Starting execution of 1 what-if analyses...
2022-09-21 18:58:27 INFO  Start plan generation for analysis OperatorImpact...
2022-09-21 18:58:27 INFO  ---RUNTIME: Plan generation took 4.393577575683594 ms
2022-09-21 18:58:27 INFO  Estimated runtime of original DAG is 8832.411766052246ms
2022-09-21 18:58:27 WARNING Skipping Multi-Query Optimization (instead, only applying patches)
2022-09-21 18:58:27 INFO  Estimated unoptimised what-if runtime is 27386.99800075557ms
2022-09-21 18:58:27 INFO  ---RUNTIME: Multi-Query Optimization took 13.44919204711914 ms
2022-09-21 18:58:27 INFO  Executing generated plans
2022-09-21 18:58:59 INFO  ---RUNTIME: Execution took 31960.882425308228 ms
2022-09-21 18:58:59 INFO  Done!
2022-09-21 18:58:59 INFO  # Finished -- repetition 2 of 7 
2022-09-21 18:58:59 INFO  # Optimization benchmark for operator_impact with args [['reviews', 'slow_loading', 'featurization_0', 'neural_network']] -- repetition 3 of 7
2022-09-21 18:58:59 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-21 18:58:59 INFO  Running instrumented original pipeline...
2022-09-21 18:58:59 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-21 18:58:59 INFO  ---RUNTIME: Importing and monkey-patching took 6.253242492675781 ms
2022-09-21 18:59:10 INFO  ---RUNTIME: Original pipeline execution took 10591.56584739685 ms (excluding imports and monkey-patching)
2022-09-21 18:59:10 INFO  Starting execution of 1 what-if analyses...
2022-09-21 18:59:10 INFO  Start plan generation for analysis OperatorImpact...
2022-09-21 18:59:10 INFO  ---RUNTIME: Plan generation took 5.776643753051758 ms
2022-09-21 18:59:10 INFO  Estimated runtime of original DAG is 8847.409725189209ms
2022-09-21 18:59:10 INFO  Performing Multi-Query Optimization
2022-09-21 18:59:10 INFO  Estimated unoptimized what-if runtime is 27480.357287858467ms
2022-09-21 18:59:10 INFO  Estimated optimised what-if runtime is 22095.896911259373ms
2022-09-21 18:59:10 INFO  Estimated optimisation runtime saving is 5384.460376599094ms
2022-09-21 18:59:10 INFO  ---RUNTIME: Multi-Query Optimization took 99.5478630065918 ms
2022-09-21 18:59:10 INFO  Executing generated plans
2022-09-21 18:59:35 INFO  ---RUNTIME: Execution took 25241.575479507446 ms
2022-09-21 18:59:35 INFO  Done!
2022-09-21 18:59:35 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-21 18:59:35 INFO  Running instrumented original pipeline...
2022-09-21 18:59:35 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-21 18:59:35 INFO  ---RUNTIME: Importing and monkey-patching took 5.964994430541992 ms
2022-09-21 18:59:47 INFO  ---RUNTIME: Original pipeline execution took 11295.962810516357 ms (excluding imports and monkey-patching)
2022-09-21 18:59:47 INFO  Starting execution of 1 what-if analyses...
2022-09-21 18:59:47 INFO  Start plan generation for analysis OperatorImpact...
2022-09-21 18:59:47 INFO  ---RUNTIME: Plan generation took 4.260540008544922 ms
2022-09-21 18:59:47 INFO  Estimated runtime of original DAG is 9615.70930480957ms
2022-09-21 18:59:47 WARNING Skipping Multi-Query Optimization (instead, only applying patches)
2022-09-21 18:59:47 INFO  Estimated unoptimised what-if runtime is 29800.725713198004ms
2022-09-21 18:59:47 INFO  ---RUNTIME: Multi-Query Optimization took 13.824462890625 ms
2022-09-21 18:59:47 INFO  Executing generated plans
2022-09-21 19:00:18 INFO  ---RUNTIME: Execution took 31460.866451263428 ms
2022-09-21 19:00:18 INFO  Done!
2022-09-21 19:00:18 INFO  # Finished -- repetition 3 of 7 
2022-09-21 19:00:18 INFO  # Optimization benchmark for operator_impact with args [['reviews', 'slow_loading', 'featurization_0', 'neural_network']] -- repetition 4 of 7
2022-09-21 19:00:18 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-21 19:00:18 INFO  Running instrumented original pipeline...
2022-09-21 19:00:18 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-21 19:00:18 INFO  ---RUNTIME: Importing and monkey-patching took 6.264209747314453 ms
2022-09-21 19:00:29 INFO  ---RUNTIME: Original pipeline execution took 10942.032098770142 ms (excluding imports and monkey-patching)
2022-09-21 19:00:29 INFO  Starting execution of 1 what-if analyses...
2022-09-21 19:00:29 INFO  Start plan generation for analysis OperatorImpact...
2022-09-21 19:00:29 INFO  ---RUNTIME: Plan generation took 4.428386688232422 ms
2022-09-21 19:00:29 INFO  Estimated runtime of original DAG is 9299.385070800781ms
2022-09-21 19:00:29 INFO  Performing Multi-Query Optimization
2022-09-21 19:00:29 INFO  Estimated unoptimized what-if runtime is 28894.82239370919ms
2022-09-21 19:00:29 INFO  Estimated optimised what-if runtime is 23555.90137567072ms
2022-09-21 19:00:29 INFO  Estimated optimisation runtime saving is 5338.921018038469ms
2022-09-21 19:00:29 INFO  ---RUNTIME: Multi-Query Optimization took 104.65526580810547 ms
2022-09-21 19:00:29 INFO  Executing generated plans
2022-09-21 19:00:54 INFO  ---RUNTIME: Execution took 24922.79553413391 ms
2022-09-21 19:00:54 INFO  Done!
2022-09-21 19:00:54 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-21 19:00:54 INFO  Running instrumented original pipeline...
2022-09-21 19:00:54 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-21 19:00:54 INFO  ---RUNTIME: Importing and monkey-patching took 5.807399749755859 ms
2022-09-21 19:01:05 INFO  ---RUNTIME: Original pipeline execution took 10636.866569519043 ms (excluding imports and monkey-patching)
2022-09-21 19:01:05 INFO  Starting execution of 1 what-if analyses...
2022-09-21 19:01:05 INFO  Start plan generation for analysis OperatorImpact...
2022-09-21 19:01:05 INFO  ---RUNTIME: Plan generation took 4.243373870849609 ms
2022-09-21 19:01:05 INFO  Estimated runtime of original DAG is 8874.824523925781ms
2022-09-21 19:01:05 WARNING Skipping Multi-Query Optimization (instead, only applying patches)
2022-09-21 19:01:05 INFO  Estimated unoptimised what-if runtime is 27526.39857593279ms
2022-09-21 19:01:05 INFO  ---RUNTIME: Multi-Query Optimization took 15.048742294311523 ms
2022-09-21 19:01:05 INFO  Executing generated plans
2022-09-21 19:01:36 INFO  ---RUNTIME: Execution took 30922.929048538208 ms
2022-09-21 19:01:36 INFO  Done!
2022-09-21 19:01:36 INFO  # Finished -- repetition 4 of 7 
2022-09-21 19:01:36 INFO  # Optimization benchmark for operator_impact with args [['reviews', 'slow_loading', 'featurization_0', 'neural_network']] -- repetition 5 of 7
2022-09-21 19:01:36 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-21 19:01:36 INFO  Running instrumented original pipeline...
2022-09-21 19:01:36 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-21 19:01:36 INFO  ---RUNTIME: Importing and monkey-patching took 7.246255874633789 ms
2022-09-21 19:01:47 INFO  ---RUNTIME: Original pipeline execution took 11270.444631576538 ms (excluding imports and monkey-patching)
2022-09-21 19:01:47 INFO  Starting execution of 1 what-if analyses...
2022-09-21 19:01:47 INFO  Start plan generation for analysis OperatorImpact...
2022-09-21 19:01:47 INFO  ---RUNTIME: Plan generation took 4.305601119995117 ms
2022-09-21 19:01:47 INFO  Estimated runtime of original DAG is 9129.210710525513ms
2022-09-21 19:01:47 INFO  Performing Multi-Query Optimization
2022-09-21 19:01:47 INFO  Estimated unoptimized what-if runtime is 28322.081450619953ms
2022-09-21 19:01:47 INFO  Estimated optimised what-if runtime is 22469.759203428086ms
2022-09-21 19:01:47 INFO  Estimated optimisation runtime saving is 5852.322247191867ms
2022-09-21 19:01:47 INFO  ---RUNTIME: Multi-Query Optimization took 100.44074058532715 ms
2022-09-21 19:01:47 INFO  Executing generated plans
2022-09-21 19:02:12 INFO  ---RUNTIME: Execution took 24677.920818328857 ms
2022-09-21 19:02:12 INFO  Done!
2022-09-21 19:02:12 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-21 19:02:12 INFO  Running instrumented original pipeline...
2022-09-21 19:02:12 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-21 19:02:12 INFO  ---RUNTIME: Importing and monkey-patching took 6.184101104736328 ms
2022-09-21 19:02:23 INFO  ---RUNTIME: Original pipeline execution took 10996.767282485962 ms (excluding imports and monkey-patching)
2022-09-21 19:02:23 INFO  Starting execution of 1 what-if analyses...
2022-09-21 19:02:23 INFO  Start plan generation for analysis OperatorImpact...
2022-09-21 19:02:23 INFO  ---RUNTIME: Plan generation took 4.437446594238281 ms
2022-09-21 19:02:23 INFO  Estimated runtime of original DAG is 9317.533493041992ms
2022-09-21 19:02:23 WARNING Skipping Multi-Query Optimization (instead, only applying patches)
2022-09-21 19:02:23 INFO  Estimated unoptimised what-if runtime is 28855.787180347914ms
2022-09-21 19:02:23 INFO  ---RUNTIME: Multi-Query Optimization took 14.078378677368164 ms
2022-09-21 19:02:23 INFO  Executing generated plans
2022-09-21 19:02:55 INFO  ---RUNTIME: Execution took 32136.528730392456 ms
2022-09-21 19:02:55 INFO  Done!
2022-09-21 19:02:55 INFO  # Finished -- repetition 5 of 7 
2022-09-21 19:02:55 INFO  # Optimization benchmark for operator_impact with args [['reviews', 'slow_loading', 'featurization_0', 'neural_network']] -- repetition 6 of 7
2022-09-21 19:02:55 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-21 19:02:55 INFO  Running instrumented original pipeline...
2022-09-21 19:02:55 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-21 19:02:55 INFO  ---RUNTIME: Importing and monkey-patching took 5.862712860107422 ms
2022-09-21 19:03:06 INFO  ---RUNTIME: Original pipeline execution took 11066.406965255737 ms (excluding imports and monkey-patching)
2022-09-21 19:03:06 INFO  Starting execution of 1 what-if analyses...
2022-09-21 19:03:06 INFO  Start plan generation for analysis OperatorImpact...
2022-09-21 19:03:06 INFO  ---RUNTIME: Plan generation took 4.169225692749023 ms
2022-09-21 19:03:06 INFO  Estimated runtime of original DAG is 9394.1650390625ms
2022-09-21 19:03:06 INFO  Performing Multi-Query Optimization
2022-09-21 19:03:06 INFO  Estimated unoptimized what-if runtime is 29181.68382211658ms
2022-09-21 19:03:06 INFO  Estimated optimised what-if runtime is 23653.619990205112ms
2022-09-21 19:03:06 INFO  Estimated optimisation runtime saving is 5528.06383191147ms
2022-09-21 19:03:06 INFO  ---RUNTIME: Multi-Query Optimization took 99.80010986328125 ms
2022-09-21 19:03:06 INFO  Executing generated plans
2022-09-21 19:03:30 INFO  ---RUNTIME: Execution took 24335.000038146973 ms
2022-09-21 19:03:30 INFO  Done!
2022-09-21 19:03:30 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-21 19:03:30 INFO  Running instrumented original pipeline...
2022-09-21 19:03:30 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-21 19:03:30 INFO  ---RUNTIME: Importing and monkey-patching took 5.911111831665039 ms
2022-09-21 19:03:42 INFO  ---RUNTIME: Original pipeline execution took 11122.449398040771 ms (excluding imports and monkey-patching)
2022-09-21 19:03:42 INFO  Starting execution of 1 what-if analyses...
2022-09-21 19:03:42 INFO  Start plan generation for analysis OperatorImpact...
2022-09-21 19:03:42 INFO  ---RUNTIME: Plan generation took 4.565000534057617 ms
2022-09-21 19:03:42 INFO  Estimated runtime of original DAG is 9094.83790397644ms
2022-09-21 19:03:42 WARNING Skipping Multi-Query Optimization (instead, only applying patches)
2022-09-21 19:03:42 INFO  Estimated unoptimised what-if runtime is 28223.75295169361ms
2022-09-21 19:03:42 INFO  ---RUNTIME: Multi-Query Optimization took 13.773679733276367 ms
2022-09-21 19:03:42 INFO  Executing generated plans
2022-09-21 19:04:13 INFO  ---RUNTIME: Execution took 31091.33815765381 ms
2022-09-21 19:04:13 INFO  Done!
2022-09-21 19:04:13 INFO  # Finished -- repetition 6 of 7 
2022-09-21 19:04:13 INFO  # Optimization benchmark for operator_impact with args [['reviews', 'slow_loading', 'featurization_0', 'neural_network']] -- repetition 7 of 7
2022-09-21 19:04:13 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-21 19:04:13 INFO  Running instrumented original pipeline...
2022-09-21 19:04:13 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-21 19:04:13 INFO  ---RUNTIME: Importing and monkey-patching took 5.950689315795898 ms
2022-09-21 19:04:23 INFO  ---RUNTIME: Original pipeline execution took 10636.247634887695 ms (excluding imports and monkey-patching)
2022-09-21 19:04:23 INFO  Starting execution of 1 what-if analyses...
2022-09-21 19:04:23 INFO  Start plan generation for analysis OperatorImpact...
2022-09-21 19:04:23 INFO  ---RUNTIME: Plan generation took 4.494667053222656 ms
2022-09-21 19:04:23 INFO  Estimated runtime of original DAG is 8909.695863723755ms
2022-09-21 19:04:23 INFO  Performing Multi-Query Optimization
2022-09-21 19:04:23 INFO  Estimated unoptimized what-if runtime is 27692.38642676903ms
2022-09-21 19:04:23 INFO  Estimated optimised what-if runtime is 22610.21445995157ms
2022-09-21 19:04:23 INFO  Estimated optimisation runtime saving is 5082.171966817459ms
2022-09-21 19:04:23 INFO  ---RUNTIME: Multi-Query Optimization took 103.63078117370605 ms
2022-09-21 19:04:23 INFO  Executing generated plans
2022-09-21 19:04:48 INFO  ---RUNTIME: Execution took 24851.680517196655 ms
2022-09-21 19:04:48 INFO  Done!
2022-09-21 19:04:48 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-21 19:04:48 INFO  Running instrumented original pipeline...
2022-09-21 19:04:48 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-21 19:04:48 INFO  ---RUNTIME: Importing and monkey-patching took 5.80286979675293 ms
2022-09-21 19:04:59 INFO  ---RUNTIME: Original pipeline execution took 10536.584377288818 ms (excluding imports and monkey-patching)
2022-09-21 19:04:59 INFO  Starting execution of 1 what-if analyses...
2022-09-21 19:04:59 INFO  Start plan generation for analysis OperatorImpact...
2022-09-21 19:04:59 INFO  ---RUNTIME: Plan generation took 4.276514053344727 ms
2022-09-21 19:04:59 INFO  Estimated runtime of original DAG is 8837.319374084473ms
2022-09-21 19:04:59 WARNING Skipping Multi-Query Optimization (instead, only applying patches)
2022-09-21 19:04:59 INFO  Estimated unoptimised what-if runtime is 27391.530293096184ms
2022-09-21 19:04:59 INFO  ---RUNTIME: Multi-Query Optimization took 13.526439666748047 ms
2022-09-21 19:04:59 INFO  Executing generated plans
2022-09-21 19:05:30 INFO  ---RUNTIME: Execution took 30819.811582565308 ms
2022-09-21 19:05:30 INFO  Done!
2022-09-21 19:05:30 INFO  # Finished -- repetition 7 of 7 
2022-09-21 19:05:30 INFO  # Final results after all repetitions
2022-09-21 19:05:30 INFO     repetition  ... no_opt_what_if_execution_combined_model_training
0           0  ...                                     10983.628273
1           1  ...                                     11158.785343
2           2  ...                                     11358.855247
3           3  ...                                     10605.396509
4           4  ...                                     12028.750181
5           5  ...                                     10849.239588
6           6  ...                                     10452.237368

[7 rows x 26 columns]
taskset -c 160-167 PROTOCOL_BUFFERS_PYTHON_IMPLEMENTATION=python python3.9 benchmarks_end_to_end.py operator_impact reviews slow_loading featurization_1 logistic_regression
2022-09-21 19:05:32.606017: W tensorflow/stream_executor/platform/default/dso_loader.cc:64] Could not load dynamic library 'libcudart.so.11.0'; dlerror: libcudart.so.11.0: cannot open shared object file: No such file or directory; LD_LIBRARY_PATH: /home/sgrafbe/mlwhatif/venv/lib/python3.9/site-packages/cv2/../../lib64:
2022-09-21 19:05:32.606056: I tensorflow/stream_executor/cuda/cudart_stub.cc:29] Ignore above cudart dlerror if you do not have a GPU set up on your machine.
2022-09-21 19:05:33 INFO  Patching sys.argv with ['mlwhatif', 'reviews', 'slow_loading', 'featurization_1', 'logistic_regression']
2022-09-21 19:05:33 INFO  Running instrumented original pipeline...
2022-09-21 19:05:33 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-21 19:05:34 INFO  ---RUNTIME: Importing and monkey-patching took 111.68622970581055 ms
2022-09-21 19:05:41 INFO  ---RUNTIME: Original pipeline execution took 7647.942781448364 ms (excluding imports and monkey-patching)
2022-09-21 19:05:41 INFO  Starting execution of 0 what-if analyses...
2022-09-21 19:05:41 INFO  Estimated runtime of original DAG is 5410.430192947388ms
2022-09-21 19:05:41 INFO  Performing Multi-Query Optimization
2022-09-21 19:05:41 INFO  Estimated unoptimized what-if runtime is 0ms
2022-09-21 19:05:41 INFO  Estimated optimised what-if runtime is 0ms
2022-09-21 19:05:41 INFO  Estimated optimisation runtime saving is 0ms
2022-09-21 19:05:41 INFO  ---RUNTIME: Multi-Query Optimization took 0.5726814270019531 ms
2022-09-21 19:05:41 INFO  Executing generated plans
2022-09-21 19:05:41 INFO  ---RUNTIME: Execution took 0.03266334533691406 ms
2022-09-21 19:05:41 INFO  Done!
2022-09-21 19:05:41 INFO  # Optimization benchmark for operator_impact with args [['reviews', 'slow_loading', 'featurization_1', 'logistic_regression']] -- repetition 1 of 7
2022-09-21 19:05:41 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-21 19:05:41 INFO  Running instrumented original pipeline...
2022-09-21 19:05:41 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-21 19:05:41 INFO  ---RUNTIME: Importing and monkey-patching took 6.129264831542969 ms
2022-09-21 19:05:49 INFO  ---RUNTIME: Original pipeline execution took 7596.724033355713 ms (excluding imports and monkey-patching)
2022-09-21 19:05:49 INFO  Starting execution of 1 what-if analyses...
2022-09-21 19:05:49 INFO  Start plan generation for analysis OperatorImpact...
2022-09-21 19:05:49 INFO  ---RUNTIME: Plan generation took 5.815029144287109 ms
2022-09-21 19:05:49 INFO  Estimated runtime of original DAG is 5395.302057266235ms
2022-09-21 19:05:49 INFO  Performing Multi-Query Optimization
2022-09-21 19:05:49 INFO  Estimated unoptimized what-if runtime is 27459.787252317215ms
2022-09-21 19:05:49 INFO  Estimated optimised what-if runtime is 11790.600616618933ms
2022-09-21 19:05:49 INFO  Estimated optimisation runtime saving is 15669.186635698283ms
2022-09-21 19:05:49 INFO  ---RUNTIME: Multi-Query Optimization took 121.58536911010742 ms
2022-09-21 19:05:49 INFO  Executing generated plans
2022-09-21 19:06:02 INFO  ---RUNTIME: Execution took 13084.30790901184 ms
2022-09-21 19:06:02 INFO  Done!
2022-09-21 19:06:02 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-21 19:06:02 INFO  Running instrumented original pipeline...
2022-09-21 19:06:02 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-21 19:06:02 INFO  ---RUNTIME: Importing and monkey-patching took 6.568193435668945 ms
2022-09-21 19:06:10 INFO  ---RUNTIME: Original pipeline execution took 7849.734783172607 ms (excluding imports and monkey-patching)
2022-09-21 19:06:10 INFO  Starting execution of 1 what-if analyses...
2022-09-21 19:06:10 INFO  Start plan generation for analysis OperatorImpact...
2022-09-21 19:06:10 INFO  ---RUNTIME: Plan generation took 4.95457649230957 ms
2022-09-21 19:06:10 INFO  Estimated runtime of original DAG is 5465.951442718506ms
2022-09-21 19:06:10 WARNING Skipping Multi-Query Optimization (instead, only applying patches)
2022-09-21 19:06:10 INFO  Estimated unoptimised what-if runtime is 27715.57017034928ms
2022-09-21 19:06:10 INFO  ---RUNTIME: Multi-Query Optimization took 15.439033508300781 ms
2022-09-21 19:06:10 INFO  Executing generated plans
2022-09-21 19:06:42 INFO  ---RUNTIME: Execution took 32593.91164779663 ms
2022-09-21 19:06:42 INFO  Done!
2022-09-21 19:06:42 INFO  # Finished -- repetition 1 of 7 
2022-09-21 19:06:42 INFO  # Optimization benchmark for operator_impact with args [['reviews', 'slow_loading', 'featurization_1', 'logistic_regression']] -- repetition 2 of 7
2022-09-21 19:06:42 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-21 19:06:42 INFO  Running instrumented original pipeline...
2022-09-21 19:06:43 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-21 19:06:43 INFO  ---RUNTIME: Importing and monkey-patching took 6.091117858886719 ms
2022-09-21 19:06:50 INFO  ---RUNTIME: Original pipeline execution took 7745.441198348999 ms (excluding imports and monkey-patching)
2022-09-21 19:06:50 INFO  Starting execution of 1 what-if analyses...
2022-09-21 19:06:50 INFO  Start plan generation for analysis OperatorImpact...
2022-09-21 19:06:50 INFO  ---RUNTIME: Plan generation took 4.912376403808594 ms
2022-09-21 19:06:50 INFO  Estimated runtime of original DAG is 5500.618696212769ms
2022-09-21 19:06:50 INFO  Performing Multi-Query Optimization
2022-09-21 19:06:50 INFO  Estimated unoptimized what-if runtime is 27986.290493656095ms
2022-09-21 19:06:50 INFO  Estimated optimised what-if runtime is 11887.809321949984ms
2022-09-21 19:06:50 INFO  Estimated optimisation runtime saving is 16098.481171706111ms
2022-09-21 19:06:50 INFO  ---RUNTIME: Multi-Query Optimization took 110.89730262756348 ms
2022-09-21 19:06:50 INFO  Executing generated plans
2022-09-21 19:07:03 INFO  ---RUNTIME: Execution took 13151.507377624512 ms
2022-09-21 19:07:03 INFO  Done!
2022-09-21 19:07:03 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-21 19:07:03 INFO  Running instrumented original pipeline...
2022-09-21 19:07:04 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-21 19:07:04 INFO  ---RUNTIME: Importing and monkey-patching took 6.574392318725586 ms
2022-09-21 19:07:11 INFO  ---RUNTIME: Original pipeline execution took 7610.622882843018 ms (excluding imports and monkey-patching)
2022-09-21 19:07:11 INFO  Starting execution of 1 what-if analyses...
2022-09-21 19:07:11 INFO  Start plan generation for analysis OperatorImpact...
2022-09-21 19:07:11 INFO  ---RUNTIME: Plan generation took 4.782199859619141 ms
2022-09-21 19:07:11 INFO  Estimated runtime of original DAG is 5387.058973312378ms
2022-09-21 19:07:11 WARNING Skipping Multi-Query Optimization (instead, only applying patches)
2022-09-21 19:07:11 INFO  Estimated unoptimised what-if runtime is 27325.725905818777ms
2022-09-21 19:07:11 INFO  ---RUNTIME: Multi-Query Optimization took 15.523433685302734 ms
2022-09-21 19:07:11 INFO  Executing generated plans
2022-09-21 19:07:43 INFO  ---RUNTIME: Execution took 31451.532125473022 ms
2022-09-21 19:07:43 INFO  Done!
2022-09-21 19:07:43 INFO  # Finished -- repetition 2 of 7 
2022-09-21 19:07:43 INFO  # Optimization benchmark for operator_impact with args [['reviews', 'slow_loading', 'featurization_1', 'logistic_regression']] -- repetition 3 of 7
2022-09-21 19:07:43 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-21 19:07:43 INFO  Running instrumented original pipeline...
2022-09-21 19:07:43 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-21 19:07:43 INFO  ---RUNTIME: Importing and monkey-patching took 6.1550140380859375 ms
2022-09-21 19:07:50 INFO  ---RUNTIME: Original pipeline execution took 7574.365615844727 ms (excluding imports and monkey-patching)
2022-09-21 19:07:50 INFO  Starting execution of 1 what-if analyses...
2022-09-21 19:07:50 INFO  Start plan generation for analysis OperatorImpact...
2022-09-21 19:07:50 INFO  ---RUNTIME: Plan generation took 4.972219467163086 ms
2022-09-21 19:07:50 INFO  Estimated runtime of original DAG is 5360.15772819519ms
2022-09-21 19:07:50 INFO  Performing Multi-Query Optimization
2022-09-21 19:07:50 INFO  Estimated unoptimized what-if runtime is 27277.956385082947ms
2022-09-21 19:07:50 INFO  Estimated optimised what-if runtime is 11747.948070261307ms
2022-09-21 19:07:50 INFO  Estimated optimisation runtime saving is 15530.00831482164ms
2022-09-21 19:07:50 INFO  ---RUNTIME: Multi-Query Optimization took 112.59603500366211 ms
2022-09-21 19:07:50 INFO  Executing generated plans
2022-09-21 19:08:03 INFO  ---RUNTIME: Execution took 12809.794902801514 ms
2022-09-21 19:08:03 INFO  Done!
2022-09-21 19:08:03 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-21 19:08:03 INFO  Running instrumented original pipeline...
2022-09-21 19:08:03 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-21 19:08:03 INFO  ---RUNTIME: Importing and monkey-patching took 6.165742874145508 ms
2022-09-21 19:08:11 INFO  ---RUNTIME: Original pipeline execution took 7549.149513244629 ms (excluding imports and monkey-patching)
2022-09-21 19:08:11 INFO  Starting execution of 1 what-if analyses...
2022-09-21 19:08:11 INFO  Start plan generation for analysis OperatorImpact...
2022-09-21 19:08:11 INFO  ---RUNTIME: Plan generation took 4.808902740478516 ms
2022-09-21 19:08:11 INFO  Estimated runtime of original DAG is 5342.291831970215ms
2022-09-21 19:08:11 WARNING Skipping Multi-Query Optimization (instead, only applying patches)
2022-09-21 19:08:11 INFO  Estimated unoptimised what-if runtime is 27100.39369945ms
2022-09-21 19:08:11 INFO  ---RUNTIME: Multi-Query Optimization took 15.346050262451172 ms
2022-09-21 19:08:11 INFO  Executing generated plans
2022-09-21 19:08:42 INFO  ---RUNTIME: Execution took 31633.169889450073 ms
2022-09-21 19:08:42 INFO  Done!
2022-09-21 19:08:42 INFO  # Finished -- repetition 3 of 7 
2022-09-21 19:08:42 INFO  # Optimization benchmark for operator_impact with args [['reviews', 'slow_loading', 'featurization_1', 'logistic_regression']] -- repetition 4 of 7
2022-09-21 19:08:42 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-21 19:08:42 INFO  Running instrumented original pipeline...
2022-09-21 19:08:42 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-21 19:08:42 INFO  ---RUNTIME: Importing and monkey-patching took 5.841732025146484 ms
2022-09-21 19:08:50 INFO  ---RUNTIME: Original pipeline execution took 7897.350788116455 ms (excluding imports and monkey-patching)
2022-09-21 19:08:50 INFO  Starting execution of 1 what-if analyses...
2022-09-21 19:08:50 INFO  Start plan generation for analysis OperatorImpact...
2022-09-21 19:08:50 INFO  ---RUNTIME: Plan generation took 4.935264587402344 ms
2022-09-21 19:08:50 INFO  Estimated runtime of original DAG is 5680.865287780762ms
2022-09-21 19:08:50 INFO  Performing Multi-Query Optimization
2022-09-21 19:08:51 INFO  Estimated unoptimized what-if runtime is 28882.441638163968ms
2022-09-21 19:08:51 INFO  Estimated optimised what-if runtime is 12085.276437927318ms
2022-09-21 19:08:51 INFO  Estimated optimisation runtime saving is 16797.16520023665ms
2022-09-21 19:08:51 INFO  ---RUNTIME: Multi-Query Optimization took 352.8745174407959 ms
2022-09-21 19:08:51 INFO  Executing generated plans
2022-09-21 19:09:04 INFO  ---RUNTIME: Execution took 13014.189720153809 ms
2022-09-21 19:09:04 INFO  Done!
2022-09-21 19:09:04 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-21 19:09:04 INFO  Running instrumented original pipeline...
2022-09-21 19:09:04 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-21 19:09:04 INFO  ---RUNTIME: Importing and monkey-patching took 6.18743896484375 ms
2022-09-21 19:09:11 INFO  ---RUNTIME: Original pipeline execution took 7636.314392089844 ms (excluding imports and monkey-patching)
2022-09-21 19:09:11 INFO  Starting execution of 1 what-if analyses...
2022-09-21 19:09:11 INFO  Start plan generation for analysis OperatorImpact...
2022-09-21 19:09:11 INFO  ---RUNTIME: Plan generation took 4.839181900024414 ms
2022-09-21 19:09:11 INFO  Estimated runtime of original DAG is 5376.75404548645ms
2022-09-21 19:09:11 WARNING Skipping Multi-Query Optimization (instead, only applying patches)
2022-09-21 19:09:11 INFO  Estimated unoptimised what-if runtime is 27274.93471332127ms
2022-09-21 19:09:11 INFO  ---RUNTIME: Multi-Query Optimization took 15.651464462280273 ms
2022-09-21 19:09:11 INFO  Executing generated plans
2022-09-21 19:09:43 INFO  ---RUNTIME: Execution took 32015.77138900757 ms
2022-09-21 19:09:43 INFO  Done!
2022-09-21 19:09:43 INFO  # Finished -- repetition 4 of 7 
2022-09-21 19:09:43 INFO  # Optimization benchmark for operator_impact with args [['reviews', 'slow_loading', 'featurization_1', 'logistic_regression']] -- repetition 5 of 7
2022-09-21 19:09:43 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-21 19:09:43 INFO  Running instrumented original pipeline...
2022-09-21 19:09:43 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-21 19:09:43 INFO  ---RUNTIME: Importing and monkey-patching took 6.03485107421875 ms
2022-09-21 19:09:51 INFO  ---RUNTIME: Original pipeline execution took 7712.344646453857 ms (excluding imports and monkey-patching)
2022-09-21 19:09:51 INFO  Starting execution of 1 what-if analyses...
2022-09-21 19:09:51 INFO  Start plan generation for analysis OperatorImpact...
2022-09-21 19:09:51 INFO  ---RUNTIME: Plan generation took 4.837274551391602 ms
2022-09-21 19:09:51 INFO  Estimated runtime of original DAG is 5446.941614151001ms
2022-09-21 19:09:51 INFO  Performing Multi-Query Optimization
2022-09-21 19:09:51 INFO  Estimated unoptimized what-if runtime is 27708.39038572324ms
2022-09-21 19:09:51 INFO  Estimated optimised what-if runtime is 11826.868499739432ms
2022-09-21 19:09:51 INFO  Estimated optimisation runtime saving is 15881.521885983808ms
2022-09-21 19:09:51 INFO  ---RUNTIME: Multi-Query Optimization took 113.61408233642578 ms
2022-09-21 19:09:51 INFO  Executing generated plans
2022-09-21 19:10:04 INFO  ---RUNTIME: Execution took 12915.087223052979 ms
2022-09-21 19:10:04 INFO  Done!
2022-09-21 19:10:04 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-21 19:10:04 INFO  Running instrumented original pipeline...
2022-09-21 19:10:04 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-21 19:10:04 INFO  ---RUNTIME: Importing and monkey-patching took 6.237268447875977 ms
2022-09-21 19:10:12 INFO  ---RUNTIME: Original pipeline execution took 7703.59206199646 ms (excluding imports and monkey-patching)
2022-09-21 19:10:12 INFO  Starting execution of 1 what-if analyses...
2022-09-21 19:10:12 INFO  Start plan generation for analysis OperatorImpact...
2022-09-21 19:10:12 INFO  ---RUNTIME: Plan generation took 4.9457550048828125 ms
2022-09-21 19:10:12 INFO  Estimated runtime of original DAG is 5451.516389846802ms
2022-09-21 19:10:12 WARNING Skipping Multi-Query Optimization (instead, only applying patches)
2022-09-21 19:10:12 INFO  Estimated unoptimised what-if runtime is 27644.09356932011ms
2022-09-21 19:10:12 INFO  ---RUNTIME: Multi-Query Optimization took 15.592098236083984 ms
2022-09-21 19:10:12 INFO  Executing generated plans
2022-09-21 19:10:43 INFO  ---RUNTIME: Execution took 31709.247589111328 ms
2022-09-21 19:10:43 INFO  Done!
2022-09-21 19:10:43 INFO  # Finished -- repetition 5 of 7 
2022-09-21 19:10:43 INFO  # Optimization benchmark for operator_impact with args [['reviews', 'slow_loading', 'featurization_1', 'logistic_regression']] -- repetition 6 of 7
2022-09-21 19:10:43 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-21 19:10:43 INFO  Running instrumented original pipeline...
2022-09-21 19:10:44 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-21 19:10:44 INFO  ---RUNTIME: Importing and monkey-patching took 5.7201385498046875 ms
2022-09-21 19:10:51 INFO  ---RUNTIME: Original pipeline execution took 7636.299133300781 ms (excluding imports and monkey-patching)
2022-09-21 19:10:51 INFO  Starting execution of 1 what-if analyses...
2022-09-21 19:10:51 INFO  Start plan generation for analysis OperatorImpact...
2022-09-21 19:10:51 INFO  ---RUNTIME: Plan generation took 4.875659942626953 ms
2022-09-21 19:10:51 INFO  Estimated runtime of original DAG is 5413.006544113159ms
2022-09-21 19:10:51 INFO  Performing Multi-Query Optimization
2022-09-21 19:10:51 INFO  Estimated unoptimized what-if runtime is 27537.876837529442ms
2022-09-21 19:10:51 INFO  Estimated optimised what-if runtime is 11776.742288008421ms
2022-09-21 19:10:51 INFO  Estimated optimisation runtime saving is 15761.13454952102ms
2022-09-21 19:10:51 INFO  ---RUNTIME: Multi-Query Optimization took 113.78931999206543 ms
2022-09-21 19:10:51 INFO  Executing generated plans
2022-09-21 19:11:04 INFO  ---RUNTIME: Execution took 12911.309957504272 ms
2022-09-21 19:11:04 INFO  Done!
2022-09-21 19:11:04 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-21 19:11:04 INFO  Running instrumented original pipeline...
2022-09-21 19:11:04 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-21 19:11:04 INFO  ---RUNTIME: Importing and monkey-patching took 6.075859069824219 ms
2022-09-21 19:11:12 INFO  ---RUNTIME: Original pipeline execution took 7554.085493087769 ms (excluding imports and monkey-patching)
2022-09-21 19:11:12 INFO  Starting execution of 1 what-if analyses...
2022-09-21 19:11:12 INFO  Start plan generation for analysis OperatorImpact...
2022-09-21 19:11:12 INFO  ---RUNTIME: Plan generation took 4.84156608581543 ms
2022-09-21 19:11:12 INFO  Estimated runtime of original DAG is 5346.722602844238ms
2022-09-21 19:11:12 WARNING Skipping Multi-Query Optimization (instead, only applying patches)
2022-09-21 19:11:12 INFO  Estimated unoptimised what-if runtime is 27124.403651626795ms
2022-09-21 19:11:12 INFO  ---RUNTIME: Multi-Query Optimization took 15.796899795532227 ms
2022-09-21 19:11:12 INFO  Executing generated plans
2022-09-21 19:11:43 INFO  ---RUNTIME: Execution took 31671.782732009888 ms
2022-09-21 19:11:43 INFO  Done!
2022-09-21 19:11:43 INFO  # Finished -- repetition 6 of 7 
2022-09-21 19:11:43 INFO  # Optimization benchmark for operator_impact with args [['reviews', 'slow_loading', 'featurization_1', 'logistic_regression']] -- repetition 7 of 7
2022-09-21 19:11:43 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-21 19:11:43 INFO  Running instrumented original pipeline...
2022-09-21 19:11:43 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-21 19:11:43 INFO  ---RUNTIME: Importing and monkey-patching took 5.773067474365234 ms
2022-09-21 19:11:51 INFO  ---RUNTIME: Original pipeline execution took 7564.890146255493 ms (excluding imports and monkey-patching)
2022-09-21 19:11:51 INFO  Starting execution of 1 what-if analyses...
2022-09-21 19:11:51 INFO  Start plan generation for analysis OperatorImpact...
2022-09-21 19:11:51 INFO  ---RUNTIME: Plan generation took 4.893064498901367 ms
2022-09-21 19:11:51 INFO  Estimated runtime of original DAG is 5344.10834312439ms
2022-09-21 19:11:51 INFO  Performing Multi-Query Optimization
2022-09-21 19:11:51 INFO  Estimated unoptimized what-if runtime is 27194.315568092527ms
2022-09-21 19:11:51 INFO  Estimated optimised what-if runtime is 11749.517125152577ms
2022-09-21 19:11:51 INFO  Estimated optimisation runtime saving is 15444.79844293995ms
2022-09-21 19:11:51 INFO  ---RUNTIME: Multi-Query Optimization took 114.27831649780273 ms
2022-09-21 19:11:51 INFO  Executing generated plans
2022-09-21 19:12:04 INFO  ---RUNTIME: Execution took 12919.835090637207 ms
2022-09-21 19:12:04 INFO  Done!
2022-09-21 19:12:04 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-21 19:12:04 INFO  Running instrumented original pipeline...
2022-09-21 19:12:04 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-21 19:12:04 INFO  ---RUNTIME: Importing and monkey-patching took 6.0577392578125 ms
2022-09-21 19:12:12 INFO  ---RUNTIME: Original pipeline execution took 7909.158706665039 ms (excluding imports and monkey-patching)
2022-09-21 19:12:12 INFO  Starting execution of 1 what-if analyses...
2022-09-21 19:12:12 INFO  Start plan generation for analysis OperatorImpact...
2022-09-21 19:12:12 INFO  ---RUNTIME: Plan generation took 4.788875579833984 ms
2022-09-21 19:12:12 INFO  Estimated runtime of original DAG is 5351.931810379028ms
2022-09-21 19:12:12 WARNING Skipping Multi-Query Optimization (instead, only applying patches)
2022-09-21 19:12:12 INFO  Estimated unoptimised what-if runtime is 27152.221843412357ms
2022-09-21 19:12:12 INFO  ---RUNTIME: Multi-Query Optimization took 15.651702880859375 ms
2022-09-21 19:12:12 INFO  Executing generated plans
2022-09-21 19:12:44 INFO  ---RUNTIME: Execution took 32192.442417144775 ms
2022-09-21 19:12:44 INFO  Done!
2022-09-21 19:12:44 INFO  # Finished -- repetition 7 of 7 
2022-09-21 19:12:44 INFO  # Final results after all repetitions
2022-09-21 19:12:44 INFO     repetition  ... no_opt_what_if_execution_combined_model_training
0           0  ...                                       673.308134
1           1  ...                                       637.451887
2           2  ...                                       636.506557
3           3  ...                                       648.680687
4           4  ...                                       647.703886
5           5  ...                                       642.541885
6           6  ...                                       643.944025

[7 rows x 26 columns]
taskset -c 160-167 PROTOCOL_BUFFERS_PYTHON_IMPLEMENTATION=python python3.9 benchmarks_end_to_end.py operator_impact reviews slow_loading featurization_1 xgboost
2022-09-21 19:12:46.776536: W tensorflow/stream_executor/platform/default/dso_loader.cc:64] Could not load dynamic library 'libcudart.so.11.0'; dlerror: libcudart.so.11.0: cannot open shared object file: No such file or directory; LD_LIBRARY_PATH: /home/sgrafbe/mlwhatif/venv/lib/python3.9/site-packages/cv2/../../lib64:
2022-09-21 19:12:46.776579: I tensorflow/stream_executor/cuda/cudart_stub.cc:29] Ignore above cudart dlerror if you do not have a GPU set up on your machine.
2022-09-21 19:12:47 INFO  Patching sys.argv with ['mlwhatif', 'reviews', 'slow_loading', 'featurization_1', 'xgboost']
2022-09-21 19:12:47 INFO  Running instrumented original pipeline...
2022-09-21 19:12:48 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-21 19:12:48 INFO  ---RUNTIME: Importing and monkey-patching took 95.46327590942383 ms
2022-09-21 19:12:56 INFO  ---RUNTIME: Original pipeline execution took 8411.636352539062 ms (excluding imports and monkey-patching)
2022-09-21 19:12:56 INFO  Starting execution of 0 what-if analyses...
2022-09-21 19:12:56 INFO  Estimated runtime of original DAG is 6167.238712310791ms
2022-09-21 19:12:56 INFO  Performing Multi-Query Optimization
2022-09-21 19:12:56 INFO  Estimated unoptimized what-if runtime is 0ms
2022-09-21 19:12:56 INFO  Estimated optimised what-if runtime is 0ms
2022-09-21 19:12:56 INFO  Estimated optimisation runtime saving is 0ms
2022-09-21 19:12:56 INFO  ---RUNTIME: Multi-Query Optimization took 0.4856586456298828 ms
2022-09-21 19:12:56 INFO  Executing generated plans
2022-09-21 19:12:56 INFO  ---RUNTIME: Execution took 0.023603439331054688 ms
2022-09-21 19:12:56 INFO  Done!
2022-09-21 19:12:56 INFO  # Optimization benchmark for operator_impact with args [['reviews', 'slow_loading', 'featurization_1', 'xgboost']] -- repetition 1 of 7
2022-09-21 19:12:56 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-21 19:12:56 INFO  Running instrumented original pipeline...
2022-09-21 19:12:56 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-21 19:12:56 INFO  ---RUNTIME: Importing and monkey-patching took 5.952119827270508 ms
2022-09-21 19:13:04 INFO  ---RUNTIME: Original pipeline execution took 8286.755323410034 ms (excluding imports and monkey-patching)
2022-09-21 19:13:04 INFO  Starting execution of 1 what-if analyses...
2022-09-21 19:13:04 INFO  Start plan generation for analysis OperatorImpact...
2022-09-21 19:13:04 INFO  ---RUNTIME: Plan generation took 5.580425262451172 ms
2022-09-21 19:13:04 INFO  Estimated runtime of original DAG is 6111.818790435791ms
2022-09-21 19:13:04 INFO  Performing Multi-Query Optimization
2022-09-21 19:13:04 INFO  Estimated unoptimized what-if runtime is 31154.14066552257ms
2022-09-21 19:13:04 INFO  Estimated optimised what-if runtime is 15826.260453432847ms
2022-09-21 19:13:04 INFO  Estimated optimisation runtime saving is 15327.880212089722ms
2022-09-21 19:13:04 INFO  ---RUNTIME: Multi-Query Optimization took 113.60669136047363 ms
2022-09-21 19:13:04 INFO  Executing generated plans
2022-09-21 19:13:22 INFO  ---RUNTIME: Execution took 17352.681398391724 ms
2022-09-21 19:13:22 INFO  Done!
2022-09-21 19:13:22 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-21 19:13:22 INFO  Running instrumented original pipeline...
2022-09-21 19:13:22 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-21 19:13:22 INFO  ---RUNTIME: Importing and monkey-patching took 5.77855110168457 ms
2022-09-21 19:13:30 INFO  ---RUNTIME: Original pipeline execution took 8448.209285736084 ms (excluding imports and monkey-patching)
2022-09-21 19:13:30 INFO  Starting execution of 1 what-if analyses...
2022-09-21 19:13:30 INFO  Start plan generation for analysis OperatorImpact...
2022-09-21 19:13:30 INFO  ---RUNTIME: Plan generation took 4.873752593994141 ms
2022-09-21 19:13:30 INFO  Estimated runtime of original DAG is 6126.170873641968ms
2022-09-21 19:13:30 WARNING Skipping Multi-Query Optimization (instead, only applying patches)
2022-09-21 19:13:30 INFO  Estimated unoptimised what-if runtime is 31137.48841576371ms
2022-09-21 19:13:30 INFO  ---RUNTIME: Multi-Query Optimization took 15.442132949829102 ms
2022-09-21 19:13:30 INFO  Executing generated plans
2022-09-21 19:14:07 INFO  ---RUNTIME: Execution took 37038.18488121033 ms
2022-09-21 19:14:07 INFO  Done!
2022-09-21 19:14:07 INFO  # Finished -- repetition 1 of 7 
2022-09-21 19:14:07 INFO  # Optimization benchmark for operator_impact with args [['reviews', 'slow_loading', 'featurization_1', 'xgboost']] -- repetition 2 of 7
2022-09-21 19:14:07 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-21 19:14:07 INFO  Running instrumented original pipeline...
2022-09-21 19:14:07 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-21 19:14:07 INFO  ---RUNTIME: Importing and monkey-patching took 6.124258041381836 ms
2022-09-21 19:14:16 INFO  ---RUNTIME: Original pipeline execution took 8713.790893554688 ms (excluding imports and monkey-patching)
2022-09-21 19:14:16 INFO  Starting execution of 1 what-if analyses...
2022-09-21 19:14:16 INFO  Start plan generation for analysis OperatorImpact...
2022-09-21 19:14:16 INFO  ---RUNTIME: Plan generation took 4.840612411499023 ms
2022-09-21 19:14:16 INFO  Estimated runtime of original DAG is 6311.631679534912ms
2022-09-21 19:14:16 INFO  Performing Multi-Query Optimization
2022-09-21 19:14:16 INFO  Estimated unoptimized what-if runtime is 32247.115074912144ms
2022-09-21 19:14:16 INFO  Estimated optimised what-if runtime is 16196.949097836505ms
2022-09-21 19:14:16 INFO  Estimated optimisation runtime saving is 16050.16597707564ms
2022-09-21 19:14:16 INFO  ---RUNTIME: Multi-Query Optimization took 111.27471923828125 ms
2022-09-21 19:14:16 INFO  Executing generated plans
2022-09-21 19:14:34 INFO  ---RUNTIME: Execution took 17849.4713306427 ms
2022-09-21 19:14:34 INFO  Done!
2022-09-21 19:14:34 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-21 19:14:34 INFO  Running instrumented original pipeline...
2022-09-21 19:14:34 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-21 19:14:34 INFO  ---RUNTIME: Importing and monkey-patching took 6.356477737426758 ms
2022-09-21 19:14:43 INFO  ---RUNTIME: Original pipeline execution took 8612.45584487915 ms (excluding imports and monkey-patching)
2022-09-21 19:14:43 INFO  Starting execution of 1 what-if analyses...
2022-09-21 19:14:43 INFO  Start plan generation for analysis OperatorImpact...
2022-09-21 19:14:43 INFO  ---RUNTIME: Plan generation took 8.24594497680664 ms
2022-09-21 19:14:43 INFO  Estimated runtime of original DAG is 6415.759801864624ms
2022-09-21 19:14:43 WARNING Skipping Multi-Query Optimization (instead, only applying patches)
2022-09-21 19:14:43 INFO  Estimated unoptimised what-if runtime is 32586.746981655357ms
2022-09-21 19:14:43 INFO  ---RUNTIME: Multi-Query Optimization took 27.939558029174805 ms
2022-09-21 19:14:43 INFO  Executing generated plans
2022-09-21 19:15:20 INFO  ---RUNTIME: Execution took 36993.05725097656 ms
2022-09-21 19:15:20 INFO  Done!
2022-09-21 19:15:20 INFO  # Finished -- repetition 2 of 7 
2022-09-21 19:15:20 INFO  # Optimization benchmark for operator_impact with args [['reviews', 'slow_loading', 'featurization_1', 'xgboost']] -- repetition 3 of 7
2022-09-21 19:15:20 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-21 19:15:20 INFO  Running instrumented original pipeline...
2022-09-21 19:15:20 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-21 19:15:20 INFO  ---RUNTIME: Importing and monkey-patching took 6.137609481811523 ms
2022-09-21 19:15:28 INFO  ---RUNTIME: Original pipeline execution took 8647.164344787598 ms (excluding imports and monkey-patching)
2022-09-21 19:15:28 INFO  Starting execution of 1 what-if analyses...
2022-09-21 19:15:28 INFO  Start plan generation for analysis OperatorImpact...
2022-09-21 19:15:28 INFO  ---RUNTIME: Plan generation took 4.921436309814453 ms
2022-09-21 19:15:28 INFO  Estimated runtime of original DAG is 6252.1116733551025ms
2022-09-21 19:15:28 INFO  Performing Multi-Query Optimization
2022-09-21 19:15:28 INFO  Estimated unoptimized what-if runtime is 31808.265335629665ms
2022-09-21 19:15:28 INFO  Estimated optimised what-if runtime is 16015.593225711053ms
2022-09-21 19:15:28 INFO  Estimated optimisation runtime saving is 15792.672109918612ms
2022-09-21 19:15:28 INFO  ---RUNTIME: Multi-Query Optimization took 112.69807815551758 ms
2022-09-21 19:15:28 INFO  Executing generated plans
2022-09-21 19:15:46 INFO  ---RUNTIME: Execution took 17857.47003555298 ms
2022-09-21 19:15:46 INFO  Done!
2022-09-21 19:15:46 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-21 19:15:46 INFO  Running instrumented original pipeline...
2022-09-21 19:15:46 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-21 19:15:46 INFO  ---RUNTIME: Importing and monkey-patching took 9.20724868774414 ms
2022-09-21 19:15:55 INFO  ---RUNTIME: Original pipeline execution took 8660.043716430664 ms (excluding imports and monkey-patching)
2022-09-21 19:15:55 INFO  Starting execution of 1 what-if analyses...
2022-09-21 19:15:55 INFO  Start plan generation for analysis OperatorImpact...
2022-09-21 19:15:55 INFO  ---RUNTIME: Plan generation took 4.840612411499023 ms
2022-09-21 19:15:55 INFO  Estimated runtime of original DAG is 6429.629802703857ms
2022-09-21 19:15:55 WARNING Skipping Multi-Query Optimization (instead, only applying patches)
2022-09-21 19:15:55 INFO  Estimated unoptimised what-if runtime is 32687.783343342442ms
2022-09-21 19:15:55 INFO  ---RUNTIME: Multi-Query Optimization took 15.516281127929688 ms
2022-09-21 19:15:55 INFO  Executing generated plans
2022-09-21 19:16:32 INFO  ---RUNTIME: Execution took 37213.93656730652 ms
2022-09-21 19:16:32 INFO  Done!
2022-09-21 19:16:32 INFO  # Finished -- repetition 3 of 7 
2022-09-21 19:16:32 INFO  # Optimization benchmark for operator_impact with args [['reviews', 'slow_loading', 'featurization_1', 'xgboost']] -- repetition 4 of 7
2022-09-21 19:16:32 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-21 19:16:32 INFO  Running instrumented original pipeline...
2022-09-21 19:16:32 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-21 19:16:32 INFO  ---RUNTIME: Importing and monkey-patching took 6.200551986694336 ms
2022-09-21 19:16:41 INFO  ---RUNTIME: Original pipeline execution took 8718.797445297241 ms (excluding imports and monkey-patching)
2022-09-21 19:16:41 INFO  Starting execution of 1 what-if analyses...
2022-09-21 19:16:41 INFO  Start plan generation for analysis OperatorImpact...
2022-09-21 19:16:41 INFO  ---RUNTIME: Plan generation took 5.014181137084961 ms
2022-09-21 19:16:41 INFO  Estimated runtime of original DAG is 6364.8576736450195ms
2022-09-21 19:16:41 INFO  Performing Multi-Query Optimization
2022-09-21 19:16:41 INFO  Estimated unoptimized what-if runtime is 32446.61097580368ms
2022-09-21 19:16:41 INFO  Estimated optimised what-if runtime is 16155.891097026317ms
2022-09-21 19:16:41 INFO  Estimated optimisation runtime saving is 16290.719878777363ms
2022-09-21 19:16:41 INFO  ---RUNTIME: Multi-Query Optimization took 343.9147472381592 ms
2022-09-21 19:16:41 INFO  Executing generated plans
2022-09-21 19:16:59 INFO  ---RUNTIME: Execution took 18149.680137634277 ms
2022-09-21 19:16:59 INFO  Done!
2022-09-21 19:16:59 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-21 19:16:59 INFO  Running instrumented original pipeline...
2022-09-21 19:16:59 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-21 19:16:59 INFO  ---RUNTIME: Importing and monkey-patching took 6.069183349609375 ms
2022-09-21 19:17:08 INFO  ---RUNTIME: Original pipeline execution took 8733.85238647461 ms (excluding imports and monkey-patching)
2022-09-21 19:17:08 INFO  Starting execution of 1 what-if analyses...
2022-09-21 19:17:08 INFO  Start plan generation for analysis OperatorImpact...
2022-09-21 19:17:08 INFO  ---RUNTIME: Plan generation took 4.827976226806641 ms
2022-09-21 19:17:08 INFO  Estimated runtime of original DAG is 6175.019979476929ms
2022-09-21 19:17:08 WARNING Skipping Multi-Query Optimization (instead, only applying patches)
2022-09-21 19:17:08 INFO  Estimated unoptimised what-if runtime is 31378.330373347726ms
2022-09-21 19:17:08 INFO  ---RUNTIME: Multi-Query Optimization took 15.83552360534668 ms
2022-09-21 19:17:08 INFO  Executing generated plans
2022-09-21 19:17:46 INFO  ---RUNTIME: Execution took 37410.879135131836 ms
2022-09-21 19:17:46 INFO  Done!
2022-09-21 19:17:46 INFO  # Finished -- repetition 4 of 7 
2022-09-21 19:17:46 INFO  # Optimization benchmark for operator_impact with args [['reviews', 'slow_loading', 'featurization_1', 'xgboost']] -- repetition 5 of 7
2022-09-21 19:17:46 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-21 19:17:46 INFO  Running instrumented original pipeline...
2022-09-21 19:17:46 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-21 19:17:46 INFO  ---RUNTIME: Importing and monkey-patching took 6.151676177978516 ms
2022-09-21 19:17:55 INFO  ---RUNTIME: Original pipeline execution took 9046.124696731567 ms (excluding imports and monkey-patching)
2022-09-21 19:17:55 INFO  Starting execution of 1 what-if analyses...
2022-09-21 19:17:55 INFO  Start plan generation for analysis OperatorImpact...
2022-09-21 19:17:55 INFO  ---RUNTIME: Plan generation took 4.838466644287109 ms
2022-09-21 19:17:55 INFO  Estimated runtime of original DAG is 6779.574155807495ms
2022-09-21 19:17:55 INFO  Performing Multi-Query Optimization
2022-09-21 19:17:55 INFO  Estimated unoptimized what-if runtime is 34544.132247983776ms
2022-09-21 19:17:55 INFO  Estimated optimised what-if runtime is 17070.336523923215ms
2022-09-21 19:17:55 INFO  Estimated optimisation runtime saving is 17473.79572406056ms
2022-09-21 19:17:55 INFO  ---RUNTIME: Multi-Query Optimization took 114.32504653930664 ms
2022-09-21 19:17:55 INFO  Executing generated plans
2022-09-21 19:18:13 INFO  ---RUNTIME: Execution took 18170.889854431152 ms
2022-09-21 19:18:13 INFO  Done!
2022-09-21 19:18:13 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-21 19:18:13 INFO  Running instrumented original pipeline...
2022-09-21 19:18:13 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-21 19:18:13 INFO  ---RUNTIME: Importing and monkey-patching took 6.549358367919922 ms
2022-09-21 19:18:22 INFO  ---RUNTIME: Original pipeline execution took 8852.051258087158 ms (excluding imports and monkey-patching)
2022-09-21 19:18:22 INFO  Starting execution of 1 what-if analyses...
2022-09-21 19:18:22 INFO  Start plan generation for analysis OperatorImpact...
2022-09-21 19:18:22 INFO  ---RUNTIME: Plan generation took 4.862546920776367 ms
2022-09-21 19:18:22 INFO  Estimated runtime of original DAG is 6499.133586883545ms
2022-09-21 19:18:22 WARNING Skipping Multi-Query Optimization (instead, only applying patches)
2022-09-21 19:18:22 INFO  Estimated unoptimised what-if runtime is 33027.645003337646ms
2022-09-21 19:18:22 INFO  ---RUNTIME: Multi-Query Optimization took 15.404462814331055 ms
2022-09-21 19:18:22 INFO  Executing generated plans
2022-09-21 19:19:00 INFO  ---RUNTIME: Execution took 38040.70425033569 ms
2022-09-21 19:19:00 INFO  Done!
2022-09-21 19:19:00 INFO  # Finished -- repetition 5 of 7 
2022-09-21 19:19:00 INFO  # Optimization benchmark for operator_impact with args [['reviews', 'slow_loading', 'featurization_1', 'xgboost']] -- repetition 6 of 7
2022-09-21 19:19:00 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-21 19:19:00 INFO  Running instrumented original pipeline...
2022-09-21 19:19:00 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-21 19:19:00 INFO  ---RUNTIME: Importing and monkey-patching took 5.913257598876953 ms
2022-09-21 19:19:09 INFO  ---RUNTIME: Original pipeline execution took 8960.582971572876 ms (excluding imports and monkey-patching)
2022-09-21 19:19:09 INFO  Starting execution of 1 what-if analyses...
2022-09-21 19:19:09 INFO  Start plan generation for analysis OperatorImpact...
2022-09-21 19:19:09 INFO  ---RUNTIME: Plan generation took 4.906654357910156 ms
2022-09-21 19:19:09 INFO  Estimated runtime of original DAG is 6716.850757598877ms
2022-09-21 19:19:09 INFO  Performing Multi-Query Optimization
2022-09-21 19:19:09 INFO  Estimated unoptimized what-if runtime is 34204.369647161504ms
2022-09-21 19:19:09 INFO  Estimated optimised what-if runtime is 17270.168965093904ms
2022-09-21 19:19:09 INFO  Estimated optimisation runtime saving is 16934.2006820676ms
2022-09-21 19:19:09 INFO  ---RUNTIME: Multi-Query Optimization took 112.92386054992676 ms
2022-09-21 19:19:09 INFO  Executing generated plans
2022-09-21 19:19:27 INFO  ---RUNTIME: Execution took 17741.953372955322 ms
2022-09-21 19:19:27 INFO  Done!
2022-09-21 19:19:27 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-21 19:19:27 INFO  Running instrumented original pipeline...
2022-09-21 19:19:27 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-21 19:19:27 INFO  ---RUNTIME: Importing and monkey-patching took 6.225347518920898 ms
2022-09-21 19:19:35 INFO  ---RUNTIME: Original pipeline execution took 8729.076862335205 ms (excluding imports and monkey-patching)
2022-09-21 19:19:35 INFO  Starting execution of 1 what-if analyses...
2022-09-21 19:19:35 INFO  Start plan generation for analysis OperatorImpact...
2022-09-21 19:19:35 INFO  ---RUNTIME: Plan generation took 4.727602005004883 ms
2022-09-21 19:19:35 INFO  Estimated runtime of original DAG is 6196.374893188477ms
2022-09-21 19:19:35 WARNING Skipping Multi-Query Optimization (instead, only applying patches)
2022-09-21 19:19:35 INFO  Estimated unoptimised what-if runtime is 31488.35193047461ms
2022-09-21 19:19:35 INFO  ---RUNTIME: Multi-Query Optimization took 15.388727188110352 ms
2022-09-21 19:19:35 INFO  Executing generated plans
2022-09-21 19:20:13 INFO  ---RUNTIME: Execution took 37043.56932640076 ms
2022-09-21 19:20:13 INFO  Done!
2022-09-21 19:20:13 INFO  # Finished -- repetition 6 of 7 
2022-09-21 19:20:13 INFO  # Optimization benchmark for operator_impact with args [['reviews', 'slow_loading', 'featurization_1', 'xgboost']] -- repetition 7 of 7
2022-09-21 19:20:13 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-21 19:20:13 INFO  Running instrumented original pipeline...
2022-09-21 19:20:13 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-21 19:20:13 INFO  ---RUNTIME: Importing and monkey-patching took 6.301403045654297 ms
2022-09-21 19:20:21 INFO  ---RUNTIME: Original pipeline execution took 8845.813274383545 ms (excluding imports and monkey-patching)
2022-09-21 19:20:21 INFO  Starting execution of 1 what-if analyses...
2022-09-21 19:20:21 INFO  Start plan generation for analysis OperatorImpact...
2022-09-21 19:20:21 INFO  ---RUNTIME: Plan generation took 4.865169525146484 ms
2022-09-21 19:20:21 INFO  Estimated runtime of original DAG is 6640.190124511719ms
2022-09-21 19:20:21 INFO  Performing Multi-Query Optimization
2022-09-21 19:20:21 INFO  Estimated unoptimized what-if runtime is 33834.92564755733ms
2022-09-21 19:20:21 INFO  Estimated optimised what-if runtime is 16961.10545392241ms
2022-09-21 19:20:21 INFO  Estimated optimisation runtime saving is 16873.820193634918ms
2022-09-21 19:20:21 INFO  ---RUNTIME: Multi-Query Optimization took 111.846923828125 ms
2022-09-21 19:20:21 INFO  Executing generated plans
2022-09-21 19:20:39 INFO  ---RUNTIME: Execution took 17796.71597480774 ms
2022-09-21 19:20:39 INFO  Done!
2022-09-21 19:20:39 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-21 19:20:39 INFO  Running instrumented original pipeline...
2022-09-21 19:20:39 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-21 19:20:39 INFO  ---RUNTIME: Importing and monkey-patching took 6.031513214111328 ms
2022-09-21 19:20:49 INFO  ---RUNTIME: Original pipeline execution took 9359.979391098022 ms (excluding imports and monkey-patching)
2022-09-21 19:20:49 INFO  Starting execution of 1 what-if analyses...
2022-09-21 19:20:49 INFO  Start plan generation for analysis OperatorImpact...
2022-09-21 19:20:49 INFO  ---RUNTIME: Plan generation took 4.775285720825195 ms
2022-09-21 19:20:49 INFO  Estimated runtime of original DAG is 6481.789350509644ms
2022-09-21 19:20:49 WARNING Skipping Multi-Query Optimization (instead, only applying patches)
2022-09-21 19:20:49 INFO  Estimated unoptimised what-if runtime is 32918.75793425077ms
2022-09-21 19:20:49 INFO  ---RUNTIME: Multi-Query Optimization took 15.559196472167969 ms
2022-09-21 19:20:49 INFO  Executing generated plans
2022-09-21 19:21:26 INFO  ---RUNTIME: Execution took 37538.26284408569 ms
2022-09-21 19:21:26 INFO  Done!
2022-09-21 19:21:26 INFO  # Finished -- repetition 7 of 7 
2022-09-21 19:21:26 INFO  # Final results after all repetitions
2022-09-21 19:21:26 INFO     repetition  ... no_opt_what_if_execution_combined_model_training
0           0  ...                                      4906.822681
1           1  ...                                      4947.833061
2           2  ...                                      4832.029819
3           3  ...                                      5193.828344
4           4  ...                                      5381.460905
5           5  ...                                      5066.449404
6           6  ...                                      4803.935766

[7 rows x 26 columns]
taskset -c 160-167 PROTOCOL_BUFFERS_PYTHON_IMPLEMENTATION=python python3.9 benchmarks_end_to_end.py operator_impact reviews slow_loading featurization_1 neural_network
2022-09-21 19:21:28.861902: W tensorflow/stream_executor/platform/default/dso_loader.cc:64] Could not load dynamic library 'libcudart.so.11.0'; dlerror: libcudart.so.11.0: cannot open shared object file: No such file or directory; LD_LIBRARY_PATH: /home/sgrafbe/mlwhatif/venv/lib/python3.9/site-packages/cv2/../../lib64:
2022-09-21 19:21:28.861948: I tensorflow/stream_executor/cuda/cudart_stub.cc:29] Ignore above cudart dlerror if you do not have a GPU set up on your machine.
2022-09-21 19:21:30 INFO  Patching sys.argv with ['mlwhatif', 'reviews', 'slow_loading', 'featurization_1', 'neural_network']
2022-09-21 19:21:30 INFO  Running instrumented original pipeline...
2022-09-21 19:21:30 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-21 19:21:30 INFO  ---RUNTIME: Importing and monkey-patching took 94.81668472290039 ms
2022-09-21 19:21:36.382112: W tensorflow/stream_executor/platform/default/dso_loader.cc:64] Could not load dynamic library 'libcuda.so.1'; dlerror: libcuda.so.1: cannot open shared object file: No such file or directory; LD_LIBRARY_PATH: /home/sgrafbe/mlwhatif/venv/lib/python3.9/site-packages/cv2/../../lib64:
2022-09-21 19:21:36.382147: W tensorflow/stream_executor/cuda/cuda_driver.cc:326] failed call to cuInit: UNKNOWN ERROR (303)
2022-09-21 19:21:36.382170: I tensorflow/stream_executor/cuda/cuda_diagnostics.cc:156] kernel driver does not appear to be running on this host (wagyu): /proc/driver/nvidia/version does not exist
2022-09-21 19:21:36.382771: I tensorflow/core/platform/cpu_feature_guard.cc:142] This TensorFlow binary is optimized with oneAPI Deep Neural Network Library (oneDNN) to use the following CPU instructions in performance-critical operations:  AVX2 FMA
To enable them in other operations, rebuild TensorFlow with the appropriate compiler flags.
2022-09-21 19:21:36.459534: I tensorflow/compiler/mlir/mlir_graph_optimization_pass.cc:176] None of the MLIR Optimization Passes are enabled (registered 2)
2022-09-21 19:21:36.471388: I tensorflow/core/platform/profile_utils/cpu_utils.cc:114] CPU Frequency: 2595290000 Hz
2022-09-21 19:21:41 INFO  ---RUNTIME: Original pipeline execution took 11756.252765655518 ms (excluding imports and monkey-patching)
2022-09-21 19:21:41 INFO  Starting execution of 0 what-if analyses...
2022-09-21 19:21:41 INFO  Estimated runtime of original DAG is 9429.725646972656ms
2022-09-21 19:21:41 INFO  Performing Multi-Query Optimization
2022-09-21 19:21:41 INFO  Estimated unoptimized what-if runtime is 0ms
2022-09-21 19:21:41 INFO  Estimated optimised what-if runtime is 0ms
2022-09-21 19:21:41 INFO  Estimated optimisation runtime saving is 0ms
2022-09-21 19:21:41 INFO  ---RUNTIME: Multi-Query Optimization took 0.5249977111816406 ms
2022-09-21 19:21:41 INFO  Executing generated plans
2022-09-21 19:21:41 INFO  ---RUNTIME: Execution took 0.0247955322265625 ms
2022-09-21 19:21:41 INFO  Done!
2022-09-21 19:21:41 INFO  # Optimization benchmark for operator_impact with args [['reviews', 'slow_loading', 'featurization_1', 'neural_network']] -- repetition 1 of 7
2022-09-21 19:21:41 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-21 19:21:41 INFO  Running instrumented original pipeline...
2022-09-21 19:21:41 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-21 19:21:41 INFO  ---RUNTIME: Importing and monkey-patching took 5.358219146728516 ms
2022-09-21 19:21:53 INFO  ---RUNTIME: Original pipeline execution took 11434.115648269653 ms (excluding imports and monkey-patching)
2022-09-21 19:21:53 INFO  Starting execution of 1 what-if analyses...
2022-09-21 19:21:53 INFO  Start plan generation for analysis OperatorImpact...
2022-09-21 19:21:53 INFO  ---RUNTIME: Plan generation took 5.586147308349609 ms
2022-09-21 19:21:53 INFO  Estimated runtime of original DAG is 9168.458938598633ms
2022-09-21 19:21:53 INFO  Performing Multi-Query Optimization
2022-09-21 19:21:53 INFO  Estimated unoptimized what-if runtime is 46868.74938119906ms
2022-09-21 19:21:53 INFO  Estimated optimised what-if runtime is 31173.725455554635ms
2022-09-21 19:21:53 INFO  Estimated optimisation runtime saving is 15695.023925644422ms
2022-09-21 19:21:53 INFO  ---RUNTIME: Multi-Query Optimization took 115.16666412353516 ms
2022-09-21 19:21:53 INFO  Executing generated plans
2022-09-21 19:22:25 INFO  ---RUNTIME: Execution took 32370.538473129272 ms
2022-09-21 19:22:25 INFO  Done!
2022-09-21 19:22:25 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-21 19:22:25 INFO  Running instrumented original pipeline...
2022-09-21 19:22:25 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-21 19:22:25 INFO  ---RUNTIME: Importing and monkey-patching took 8.281469345092773 ms
2022-09-21 19:22:37 INFO  ---RUNTIME: Original pipeline execution took 11456.204175949097 ms (excluding imports and monkey-patching)
2022-09-21 19:22:37 INFO  Starting execution of 1 what-if analyses...
2022-09-21 19:22:37 INFO  Start plan generation for analysis OperatorImpact...
2022-09-21 19:22:37 INFO  ---RUNTIME: Plan generation took 4.7054290771484375 ms
2022-09-21 19:22:37 INFO  Estimated runtime of original DAG is 9266.15571975708ms
2022-09-21 19:22:37 WARNING Skipping Multi-Query Optimization (instead, only applying patches)
2022-09-21 19:22:37 INFO  Estimated unoptimised what-if runtime is 47272.64835153078ms
2022-09-21 19:22:37 INFO  ---RUNTIME: Multi-Query Optimization took 16.028165817260742 ms
2022-09-21 19:22:37 INFO  Executing generated plans
2022-09-21 19:23:30 INFO  ---RUNTIME: Execution took 53227.44131088257 ms
2022-09-21 19:23:30 INFO  Done!
2022-09-21 19:23:30 INFO  # Finished -- repetition 1 of 7 
2022-09-21 19:23:30 INFO  # Optimization benchmark for operator_impact with args [['reviews', 'slow_loading', 'featurization_1', 'neural_network']] -- repetition 2 of 7
2022-09-21 19:23:30 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-21 19:23:30 INFO  Running instrumented original pipeline...
2022-09-21 19:23:30 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-21 19:23:30 INFO  ---RUNTIME: Importing and monkey-patching took 6.505727767944336 ms
2022-09-21 19:23:41 INFO  ---RUNTIME: Original pipeline execution took 11289.563417434692 ms (excluding imports and monkey-patching)
2022-09-21 19:23:41 INFO  Starting execution of 1 what-if analyses...
2022-09-21 19:23:41 INFO  Start plan generation for analysis OperatorImpact...
2022-09-21 19:23:41 INFO  ---RUNTIME: Plan generation took 5.521059036254883 ms
2022-09-21 19:23:41 INFO  Estimated runtime of original DAG is 9096.13561630249ms
2022-09-21 19:23:41 INFO  Performing Multi-Query Optimization
2022-09-21 19:23:42 INFO  Estimated unoptimized what-if runtime is 46476.181987407785ms
2022-09-21 19:23:42 INFO  Estimated optimised what-if runtime is 30137.584644103088ms
2022-09-21 19:23:42 INFO  Estimated optimisation runtime saving is 16338.597343304697ms
2022-09-21 19:23:42 INFO  ---RUNTIME: Multi-Query Optimization took 123.59762191772461 ms
2022-09-21 19:23:42 INFO  Executing generated plans
2022-09-21 19:24:14 INFO  ---RUNTIME: Execution took 32344.263792037964 ms
2022-09-21 19:24:14 INFO  Done!
2022-09-21 19:24:14 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-21 19:24:14 INFO  Running instrumented original pipeline...
2022-09-21 19:24:14 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-21 19:24:14 INFO  ---RUNTIME: Importing and monkey-patching took 6.549596786499023 ms
2022-09-21 19:24:25 INFO  ---RUNTIME: Original pipeline execution took 11403.31506729126 ms (excluding imports and monkey-patching)
2022-09-21 19:24:25 INFO  Starting execution of 1 what-if analyses...
2022-09-21 19:24:25 INFO  Start plan generation for analysis OperatorImpact...
2022-09-21 19:24:25 INFO  ---RUNTIME: Plan generation took 5.009889602661133 ms
2022-09-21 19:24:25 INFO  Estimated runtime of original DAG is 9204.842805862427ms
2022-09-21 19:24:25 WARNING Skipping Multi-Query Optimization (instead, only applying patches)
2022-09-21 19:24:25 INFO  Estimated unoptimised what-if runtime is 46968.583472420316ms
2022-09-21 19:24:25 INFO  ---RUNTIME: Multi-Query Optimization took 16.61229133605957 ms
2022-09-21 19:24:25 INFO  Executing generated plans
2022-09-21 19:25:17 INFO  ---RUNTIME: Execution took 51466.79091453552 ms
2022-09-21 19:25:17 INFO  Done!
2022-09-21 19:25:17 INFO  # Finished -- repetition 2 of 7 
2022-09-21 19:25:17 INFO  # Optimization benchmark for operator_impact with args [['reviews', 'slow_loading', 'featurization_1', 'neural_network']] -- repetition 3 of 7
2022-09-21 19:25:17 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-21 19:25:17 INFO  Running instrumented original pipeline...
2022-09-21 19:25:17 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-21 19:25:17 INFO  ---RUNTIME: Importing and monkey-patching took 6.075859069824219 ms
2022-09-21 19:25:28 INFO  ---RUNTIME: Original pipeline execution took 11138.399839401245 ms (excluding imports and monkey-patching)
2022-09-21 19:25:28 INFO  Starting execution of 1 what-if analyses...
2022-09-21 19:25:28 INFO  Start plan generation for analysis OperatorImpact...
2022-09-21 19:25:28 INFO  ---RUNTIME: Plan generation took 4.743814468383789 ms
2022-09-21 19:25:28 INFO  Estimated runtime of original DAG is 8854.638576507568ms
2022-09-21 19:25:28 INFO  Performing Multi-Query Optimization
2022-09-21 19:25:28 INFO  Estimated unoptimized what-if runtime is 45273.040695166375ms
2022-09-21 19:25:28 INFO  Estimated optimised what-if runtime is 29288.36215322452ms
2022-09-21 19:25:28 INFO  Estimated optimisation runtime saving is 15984.678541941856ms
2022-09-21 19:25:28 INFO  ---RUNTIME: Multi-Query Optimization took 115.33546447753906 ms
2022-09-21 19:25:28 INFO  Executing generated plans
2022-09-21 19:26:01 INFO  ---RUNTIME: Execution took 32532.399892807007 ms
2022-09-21 19:26:01 INFO  Done!
2022-09-21 19:26:01 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-21 19:26:01 INFO  Running instrumented original pipeline...
2022-09-21 19:26:01 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-21 19:26:01 INFO  ---RUNTIME: Importing and monkey-patching took 6.622076034545898 ms
2022-09-21 19:26:12 INFO  ---RUNTIME: Original pipeline execution took 11363.070964813232 ms (excluding imports and monkey-patching)
2022-09-21 19:26:12 INFO  Starting execution of 1 what-if analyses...
2022-09-21 19:26:12 INFO  Start plan generation for analysis OperatorImpact...
2022-09-21 19:26:12 INFO  ---RUNTIME: Plan generation took 4.559040069580078 ms
2022-09-21 19:26:12 INFO  Estimated runtime of original DAG is 9131.217002868652ms
2022-09-21 19:26:12 WARNING Skipping Multi-Query Optimization (instead, only applying patches)
2022-09-21 19:26:12 INFO  Estimated unoptimised what-if runtime is 46586.36202899153ms
2022-09-21 19:26:12 INFO  ---RUNTIME: Multi-Query Optimization took 15.708446502685547 ms
2022-09-21 19:26:12 INFO  Executing generated plans
2022-09-21 19:27:03 INFO  ---RUNTIME: Execution took 51005.125522613525 ms
2022-09-21 19:27:03 INFO  Done!
2022-09-21 19:27:03 INFO  # Finished -- repetition 3 of 7 
2022-09-21 19:27:03 INFO  # Optimization benchmark for operator_impact with args [['reviews', 'slow_loading', 'featurization_1', 'neural_network']] -- repetition 4 of 7
2022-09-21 19:27:03 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-21 19:27:03 INFO  Running instrumented original pipeline...
2022-09-21 19:27:03 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-21 19:27:03 INFO  ---RUNTIME: Importing and monkey-patching took 6.284952163696289 ms
2022-09-21 19:27:14 INFO  ---RUNTIME: Original pipeline execution took 11140.653610229492 ms (excluding imports and monkey-patching)
2022-09-21 19:27:14 INFO  Starting execution of 1 what-if analyses...
2022-09-21 19:27:14 INFO  Start plan generation for analysis OperatorImpact...
2022-09-21 19:27:14 INFO  ---RUNTIME: Plan generation took 4.665136337280273 ms
2022-09-21 19:27:14 INFO  Estimated runtime of original DAG is 8872.447967529297ms
2022-09-21 19:27:14 INFO  Performing Multi-Query Optimization
2022-09-21 19:27:14 INFO  Estimated unoptimized what-if runtime is 45361.94241225356ms
2022-09-21 19:27:14 INFO  Estimated optimised what-if runtime is 29575.283608256257ms
2022-09-21 19:27:14 INFO  Estimated optimisation runtime saving is 15786.6588039973ms
2022-09-21 19:27:14 INFO  ---RUNTIME: Multi-Query Optimization took 111.33170127868652 ms
2022-09-21 19:27:14 INFO  Executing generated plans
2022-09-21 19:27:47 INFO  ---RUNTIME: Execution took 32353.45149040222 ms
2022-09-21 19:27:47 INFO  Done!
2022-09-21 19:27:47 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-21 19:27:47 INFO  Running instrumented original pipeline...
2022-09-21 19:27:47 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-21 19:27:47 INFO  ---RUNTIME: Importing and monkey-patching took 5.822420120239258 ms
2022-09-21 19:27:58 INFO  ---RUNTIME: Original pipeline execution took 11230.590105056763 ms (excluding imports and monkey-patching)
2022-09-21 19:27:58 INFO  Starting execution of 1 what-if analyses...
2022-09-21 19:27:58 INFO  Start plan generation for analysis OperatorImpact...
2022-09-21 19:27:58 INFO  ---RUNTIME: Plan generation took 4.630565643310547 ms
2022-09-21 19:27:58 INFO  Estimated runtime of original DAG is 8924.890279769897ms
2022-09-21 19:27:58 WARNING Skipping Multi-Query Optimization (instead, only applying patches)
2022-09-21 19:27:58 INFO  Estimated unoptimised what-if runtime is 45514.1933654747ms
2022-09-21 19:27:58 INFO  ---RUNTIME: Multi-Query Optimization took 15.078306198120117 ms
2022-09-21 19:27:58 INFO  Executing generated plans
2022-09-21 19:28:49 INFO  ---RUNTIME: Execution took 51338.300943374634 ms
2022-09-21 19:28:49 INFO  Done!
2022-09-21 19:28:49 INFO  # Finished -- repetition 4 of 7 
2022-09-21 19:28:49 INFO  # Optimization benchmark for operator_impact with args [['reviews', 'slow_loading', 'featurization_1', 'neural_network']] -- repetition 5 of 7
2022-09-21 19:28:49 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-21 19:28:49 INFO  Running instrumented original pipeline...
2022-09-21 19:28:49 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-21 19:28:49 INFO  ---RUNTIME: Importing and monkey-patching took 6.339073181152344 ms
2022-09-21 19:29:00 INFO  ---RUNTIME: Original pipeline execution took 11254.529237747192 ms (excluding imports and monkey-patching)
2022-09-21 19:29:00 INFO  Starting execution of 1 what-if analyses...
2022-09-21 19:29:00 INFO  Start plan generation for analysis OperatorImpact...
2022-09-21 19:29:00 INFO  ---RUNTIME: Plan generation took 5.315065383911133 ms
2022-09-21 19:29:00 INFO  Estimated runtime of original DAG is 8975.963592529297ms
2022-09-21 19:29:00 INFO  Performing Multi-Query Optimization
2022-09-21 19:29:01 INFO  Estimated unoptimized what-if runtime is 45875.78589644565ms
2022-09-21 19:29:01 INFO  Estimated optimised what-if runtime is 29727.99423474172ms
2022-09-21 19:29:01 INFO  Estimated optimisation runtime saving is 16147.791661703934ms
2022-09-21 19:29:01 INFO  ---RUNTIME: Multi-Query Optimization took 121.54889106750488 ms
2022-09-21 19:29:01 INFO  Executing generated plans
2022-09-21 19:29:34 INFO  ---RUNTIME: Execution took 33604.97045516968 ms
2022-09-21 19:29:34 INFO  Done!
2022-09-21 19:29:34 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-21 19:29:34 INFO  Running instrumented original pipeline...
2022-09-21 19:29:34 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-21 19:29:34 INFO  ---RUNTIME: Importing and monkey-patching took 6.067752838134766 ms
2022-09-21 19:29:45 INFO  ---RUNTIME: Original pipeline execution took 11239.338874816895 ms (excluding imports and monkey-patching)
2022-09-21 19:29:45 INFO  Starting execution of 1 what-if analyses...
2022-09-21 19:29:45 INFO  Start plan generation for analysis OperatorImpact...
2022-09-21 19:29:45 INFO  ---RUNTIME: Plan generation took 4.5375823974609375 ms
2022-09-21 19:29:45 INFO  Estimated runtime of original DAG is 8904.521226882935ms
2022-09-21 19:29:45 WARNING Skipping Multi-Query Optimization (instead, only applying patches)
2022-09-21 19:29:45 INFO  Estimated unoptimised what-if runtime is 45427.07493942433ms
2022-09-21 19:29:45 INFO  ---RUNTIME: Multi-Query Optimization took 16.983985900878906 ms
2022-09-21 19:29:45 INFO  Executing generated plans
2022-09-21 19:30:37 INFO  ---RUNTIME: Execution took 51140.8007144928 ms
2022-09-21 19:30:37 INFO  Done!
2022-09-21 19:30:37 INFO  # Finished -- repetition 5 of 7 
2022-09-21 19:30:37 INFO  # Optimization benchmark for operator_impact with args [['reviews', 'slow_loading', 'featurization_1', 'neural_network']] -- repetition 6 of 7
2022-09-21 19:30:37 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-21 19:30:37 INFO  Running instrumented original pipeline...
2022-09-21 19:30:37 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-21 19:30:37 INFO  ---RUNTIME: Importing and monkey-patching took 5.926370620727539 ms
2022-09-21 19:30:48 INFO  ---RUNTIME: Original pipeline execution took 11410.403490066528 ms (excluding imports and monkey-patching)
2022-09-21 19:30:48 INFO  Starting execution of 1 what-if analyses...
2022-09-21 19:30:48 INFO  Start plan generation for analysis OperatorImpact...
2022-09-21 19:30:48 INFO  ---RUNTIME: Plan generation took 4.548072814941406 ms
2022-09-21 19:30:48 INFO  Estimated runtime of original DAG is 9037.632465362549ms
2022-09-21 19:30:48 INFO  Performing Multi-Query Optimization
2022-09-21 19:30:48 INFO  Estimated unoptimized what-if runtime is 46202.0896301833ms
2022-09-21 19:30:48 INFO  Estimated optimised what-if runtime is 30573.32732585158ms
2022-09-21 19:30:48 INFO  Estimated optimisation runtime saving is 15628.762304331718ms
2022-09-21 19:30:48 INFO  ---RUNTIME: Multi-Query Optimization took 112.32638359069824 ms
2022-09-21 19:30:48 INFO  Executing generated plans
2022-09-21 19:31:21 INFO  ---RUNTIME: Execution took 32398.27251434326 ms
2022-09-21 19:31:21 INFO  Done!
2022-09-21 19:31:21 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-21 19:31:21 INFO  Running instrumented original pipeline...
2022-09-21 19:31:21 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-21 19:31:21 INFO  ---RUNTIME: Importing and monkey-patching took 5.834817886352539 ms
2022-09-21 19:31:32 INFO  ---RUNTIME: Original pipeline execution took 11781.892776489258 ms (excluding imports and monkey-patching)
2022-09-21 19:31:32 INFO  Starting execution of 1 what-if analyses...
2022-09-21 19:31:32 INFO  Start plan generation for analysis OperatorImpact...
2022-09-21 19:31:32 INFO  ---RUNTIME: Plan generation took 4.70733642578125 ms
2022-09-21 19:31:32 INFO  Estimated runtime of original DAG is 8963.773250579834ms
2022-09-21 19:31:32 WARNING Skipping Multi-Query Optimization (instead, only applying patches)
2022-09-21 19:31:32 INFO  Estimated unoptimised what-if runtime is 45730.367668377265ms
2022-09-21 19:31:32 INFO  ---RUNTIME: Multi-Query Optimization took 17.41933822631836 ms
2022-09-21 19:31:32 INFO  Executing generated plans
2022-09-21 19:32:23 INFO  ---RUNTIME: Execution took 50645.20621299744 ms
2022-09-21 19:32:23 INFO  Done!
2022-09-21 19:32:23 INFO  # Finished -- repetition 6 of 7 
2022-09-21 19:32:23 INFO  # Optimization benchmark for operator_impact with args [['reviews', 'slow_loading', 'featurization_1', 'neural_network']] -- repetition 7 of 7
2022-09-21 19:32:23 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-21 19:32:23 INFO  Running instrumented original pipeline...
2022-09-21 19:32:23 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-21 19:32:23 INFO  ---RUNTIME: Importing and monkey-patching took 5.965709686279297 ms
2022-09-21 19:32:34 INFO  ---RUNTIME: Original pipeline execution took 11380.562782287598 ms (excluding imports and monkey-patching)
2022-09-21 19:32:34 INFO  Starting execution of 1 what-if analyses...
2022-09-21 19:32:34 INFO  Start plan generation for analysis OperatorImpact...
2022-09-21 19:32:34 INFO  ---RUNTIME: Plan generation took 4.538297653198242 ms
2022-09-21 19:32:34 INFO  Estimated runtime of original DAG is 9162.955045700073ms
2022-09-21 19:32:34 INFO  Performing Multi-Query Optimization
2022-09-21 19:32:35 INFO  Estimated unoptimized what-if runtime is 46853.29319475053ms
2022-09-21 19:32:35 INFO  Estimated optimised what-if runtime is 31397.574944679825ms
2022-09-21 19:32:35 INFO  Estimated optimisation runtime saving is 15455.718250070702ms
2022-09-21 19:32:35 INFO  ---RUNTIME: Multi-Query Optimization took 113.0971908569336 ms
2022-09-21 19:32:35 INFO  Executing generated plans
2022-09-21 19:33:06 INFO  ---RUNTIME: Execution took 31254.936695098877 ms
2022-09-21 19:33:06 INFO  Done!
2022-09-21 19:33:06 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-21 19:33:06 INFO  Running instrumented original pipeline...
2022-09-21 19:33:06 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-21 19:33:06 INFO  ---RUNTIME: Importing and monkey-patching took 6.301641464233398 ms
2022-09-21 19:33:17 INFO  ---RUNTIME: Original pipeline execution took 11048.962831497192 ms (excluding imports and monkey-patching)
2022-09-21 19:33:17 INFO  Starting execution of 1 what-if analyses...
2022-09-21 19:33:17 INFO  Start plan generation for analysis OperatorImpact...
2022-09-21 19:33:17 INFO  ---RUNTIME: Plan generation took 4.639863967895508 ms
2022-09-21 19:33:17 INFO  Estimated runtime of original DAG is 8848.965167999268ms
2022-09-21 19:33:17 WARNING Skipping Multi-Query Optimization (instead, only applying patches)
2022-09-21 19:33:17 INFO  Estimated unoptimised what-if runtime is 45135.53776796337ms
2022-09-21 19:33:17 INFO  ---RUNTIME: Multi-Query Optimization took 15.722274780273438 ms
2022-09-21 19:33:17 INFO  Executing generated plans
2022-09-21 19:34:07 INFO  ---RUNTIME: Execution took 50448.29773902893 ms
2022-09-21 19:34:07 INFO  Done!
2022-09-21 19:34:07 INFO  # Finished -- repetition 7 of 7 
2022-09-21 19:34:07 INFO  # Final results after all repetitions
2022-09-21 19:34:07 INFO     repetition  ... no_opt_what_if_execution_combined_model_training
0           0  ...                                     19159.008026
1           1  ...                                     17628.626108
2           2  ...                                     17333.119869
3           3  ...                                     17518.384933
4           4  ...                                     16919.594526
5           5  ...                                     17152.157307
6           6  ...                                     17264.945745

[7 rows x 26 columns]
taskset -c 160-167 PROTOCOL_BUFFERS_PYTHON_IMPLEMENTATION=python python3.9 benchmarks_end_to_end.py operator_impact reviews slow_loading featurization_2 logistic_regression
2022-09-21 19:34:10.078802: W tensorflow/stream_executor/platform/default/dso_loader.cc:64] Could not load dynamic library 'libcudart.so.11.0'; dlerror: libcudart.so.11.0: cannot open shared object file: No such file or directory; LD_LIBRARY_PATH: /home/sgrafbe/mlwhatif/venv/lib/python3.9/site-packages/cv2/../../lib64:
2022-09-21 19:34:10.078849: I tensorflow/stream_executor/cuda/cudart_stub.cc:29] Ignore above cudart dlerror if you do not have a GPU set up on your machine.
2022-09-21 19:34:11 INFO  Patching sys.argv with ['mlwhatif', 'reviews', 'slow_loading', 'featurization_2', 'logistic_regression']
2022-09-21 19:34:11 INFO  Running instrumented original pipeline...
2022-09-21 19:34:11 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-21 19:34:11 INFO  ---RUNTIME: Importing and monkey-patching took 94.90561485290527 ms
2022-09-21 19:34:18 INFO  ---RUNTIME: Original pipeline execution took 7156.8403244018555 ms (excluding imports and monkey-patching)
2022-09-21 19:34:18 INFO  Starting execution of 0 what-if analyses...
2022-09-21 19:34:18 INFO  Estimated runtime of original DAG is 5960.108757019043ms
2022-09-21 19:34:18 INFO  Performing Multi-Query Optimization
2022-09-21 19:34:18 INFO  Estimated unoptimized what-if runtime is 0ms
2022-09-21 19:34:18 INFO  Estimated optimised what-if runtime is 0ms
2022-09-21 19:34:18 INFO  Estimated optimisation runtime saving is 0ms
2022-09-21 19:34:18 INFO  ---RUNTIME: Multi-Query Optimization took 0.6029605865478516 ms
2022-09-21 19:34:18 INFO  Executing generated plans
2022-09-21 19:34:18 INFO  ---RUNTIME: Execution took 0.024318695068359375 ms
2022-09-21 19:34:18 INFO  Done!
2022-09-21 19:34:18 INFO  # Optimization benchmark for operator_impact with args [['reviews', 'slow_loading', 'featurization_2', 'logistic_regression']] -- repetition 1 of 7
2022-09-21 19:34:18 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-21 19:34:18 INFO  Running instrumented original pipeline...
2022-09-21 19:34:18 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-21 19:34:18 INFO  ---RUNTIME: Importing and monkey-patching took 5.471944808959961 ms
2022-09-21 19:34:25 INFO  ---RUNTIME: Original pipeline execution took 7065.408706665039 ms (excluding imports and monkey-patching)
2022-09-21 19:34:25 INFO  Starting execution of 1 what-if analyses...
2022-09-21 19:34:25 INFO  Start plan generation for analysis OperatorImpact...
2022-09-21 19:34:25 INFO  ---RUNTIME: Plan generation took 5.811929702758789 ms
2022-09-21 19:34:25 INFO  Estimated runtime of original DAG is 5898.085832595825ms
2022-09-21 19:34:25 INFO  Performing Multi-Query Optimization
2022-09-21 19:34:25 INFO  Estimated unoptimized what-if runtime is 41537.21974382726ms
2022-09-21 19:34:25 INFO  Estimated optimised what-if runtime is 13963.337228354474ms
2022-09-21 19:34:25 INFO  Estimated optimisation runtime saving is 27573.88251547279ms
2022-09-21 19:34:25 INFO  ---RUNTIME: Multi-Query Optimization took 125.42533874511719 ms
2022-09-21 19:34:25 INFO  Executing generated plans
2022-09-21 19:34:41 INFO  ---RUNTIME: Execution took 15771.294593811035 ms
2022-09-21 19:34:41 INFO  Done!
2022-09-21 19:34:41 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-21 19:34:41 INFO  Running instrumented original pipeline...
2022-09-21 19:34:41 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-21 19:34:41 INFO  ---RUNTIME: Importing and monkey-patching took 5.848407745361328 ms
2022-09-21 19:34:48 INFO  ---RUNTIME: Original pipeline execution took 7286.4227294921875 ms (excluding imports and monkey-patching)
2022-09-21 19:34:48 INFO  Starting execution of 1 what-if analyses...
2022-09-21 19:34:48 INFO  Start plan generation for analysis OperatorImpact...
2022-09-21 19:34:48 INFO  ---RUNTIME: Plan generation took 5.179643630981445 ms
2022-09-21 19:34:48 INFO  Estimated runtime of original DAG is 5948.896169662476ms
2022-09-21 19:34:48 WARNING Skipping Multi-Query Optimization (instead, only applying patches)
2022-09-21 19:34:48 INFO  Estimated unoptimised what-if runtime is 41754.918676141155ms
2022-09-21 19:34:48 INFO  ---RUNTIME: Multi-Query Optimization took 17.455577850341797 ms
2022-09-21 19:34:48 INFO  Executing generated plans
2022-09-21 19:35:37 INFO  ---RUNTIME: Execution took 49092.031955718994 ms
2022-09-21 19:35:37 INFO  Done!
2022-09-21 19:35:37 INFO  # Finished -- repetition 1 of 7 
2022-09-21 19:35:37 INFO  # Optimization benchmark for operator_impact with args [['reviews', 'slow_loading', 'featurization_2', 'logistic_regression']] -- repetition 2 of 7
2022-09-21 19:35:37 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-21 19:35:37 INFO  Running instrumented original pipeline...
2022-09-21 19:35:37 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-21 19:35:37 INFO  ---RUNTIME: Importing and monkey-patching took 6.102800369262695 ms
2022-09-21 19:35:45 INFO  ---RUNTIME: Original pipeline execution took 7101.523637771606 ms (excluding imports and monkey-patching)
2022-09-21 19:35:45 INFO  Starting execution of 1 what-if analyses...
2022-09-21 19:35:45 INFO  Start plan generation for analysis OperatorImpact...
2022-09-21 19:35:45 INFO  ---RUNTIME: Plan generation took 4.990816116333008 ms
2022-09-21 19:35:45 INFO  Estimated runtime of original DAG is 5923.109531402588ms
2022-09-21 19:35:45 INFO  Performing Multi-Query Optimization
2022-09-21 19:35:45 INFO  Estimated unoptimized what-if runtime is 41696.76027074082ms
2022-09-21 19:35:45 INFO  Estimated optimised what-if runtime is 13968.054656324954ms
2022-09-21 19:35:45 INFO  Estimated optimisation runtime saving is 27728.70561441587ms
2022-09-21 19:35:45 INFO  ---RUNTIME: Multi-Query Optimization took 125.20837783813477 ms
2022-09-21 19:35:45 INFO  Executing generated plans
2022-09-21 19:36:01 INFO  ---RUNTIME: Execution took 16092.938899993896 ms
2022-09-21 19:36:01 INFO  Done!
2022-09-21 19:36:01 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-21 19:36:01 INFO  Running instrumented original pipeline...
2022-09-21 19:36:01 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-21 19:36:01 INFO  ---RUNTIME: Importing and monkey-patching took 6.205320358276367 ms
2022-09-21 19:36:08 INFO  ---RUNTIME: Original pipeline execution took 7162.6996994018555 ms (excluding imports and monkey-patching)
2022-09-21 19:36:08 INFO  Starting execution of 1 what-if analyses...
2022-09-21 19:36:08 INFO  Start plan generation for analysis OperatorImpact...
2022-09-21 19:36:08 INFO  ---RUNTIME: Plan generation took 5.009889602661133 ms
2022-09-21 19:36:08 INFO  Estimated runtime of original DAG is 5970.889329910278ms
2022-09-21 19:36:08 WARNING Skipping Multi-Query Optimization (instead, only applying patches)
2022-09-21 19:36:08 INFO  Estimated unoptimised what-if runtime is 41900.68297923944ms
2022-09-21 19:36:08 INFO  ---RUNTIME: Multi-Query Optimization took 17.055511474609375 ms
2022-09-21 19:36:08 INFO  Executing generated plans
2022-09-21 19:36:58 INFO  ---RUNTIME: Execution took 50277.36043930054 ms
2022-09-21 19:36:58 INFO  Done!
2022-09-21 19:36:58 INFO  # Finished -- repetition 2 of 7 
2022-09-21 19:36:58 INFO  # Optimization benchmark for operator_impact with args [['reviews', 'slow_loading', 'featurization_2', 'logistic_regression']] -- repetition 3 of 7
2022-09-21 19:36:58 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-21 19:36:58 INFO  Running instrumented original pipeline...
2022-09-21 19:36:58 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-21 19:36:58 INFO  ---RUNTIME: Importing and monkey-patching took 6.097555160522461 ms
2022-09-21 19:37:05 INFO  ---RUNTIME: Original pipeline execution took 7128.159046173096 ms (excluding imports and monkey-patching)
2022-09-21 19:37:05 INFO  Starting execution of 1 what-if analyses...
2022-09-21 19:37:05 INFO  Start plan generation for analysis OperatorImpact...
2022-09-21 19:37:05 INFO  ---RUNTIME: Plan generation took 5.063295364379883 ms
2022-09-21 19:37:05 INFO  Estimated runtime of original DAG is 5939.908742904663ms
2022-09-21 19:37:05 INFO  Performing Multi-Query Optimization
2022-09-21 19:37:06 INFO  Estimated unoptimized what-if runtime is 41798.891976605395ms
2022-09-21 19:37:06 INFO  Estimated optimised what-if runtime is 14003.94660299983ms
2022-09-21 19:37:06 INFO  Estimated optimisation runtime saving is 27794.945373605566ms
2022-09-21 19:37:06 INFO  ---RUNTIME: Multi-Query Optimization took 126.00445747375488 ms
2022-09-21 19:37:06 INFO  Executing generated plans
2022-09-21 19:37:21 INFO  ---RUNTIME: Execution took 15858.930587768555 ms
2022-09-21 19:37:21 INFO  Done!
2022-09-21 19:37:21 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-21 19:37:21 INFO  Running instrumented original pipeline...
2022-09-21 19:37:21 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-21 19:37:21 INFO  ---RUNTIME: Importing and monkey-patching took 6.318569183349609 ms
2022-09-21 19:37:29 INFO  ---RUNTIME: Original pipeline execution took 7249.562978744507 ms (excluding imports and monkey-patching)
2022-09-21 19:37:29 INFO  Starting execution of 1 what-if analyses...
2022-09-21 19:37:29 INFO  Start plan generation for analysis OperatorImpact...
2022-09-21 19:37:29 INFO  ---RUNTIME: Plan generation took 5.051374435424805 ms
2022-09-21 19:37:29 INFO  Estimated runtime of original DAG is 6060.333967208862ms
2022-09-21 19:37:29 WARNING Skipping Multi-Query Optimization (instead, only applying patches)
2022-09-21 19:37:29 INFO  Estimated unoptimised what-if runtime is 42528.4150898593ms
2022-09-21 19:37:29 INFO  ---RUNTIME: Multi-Query Optimization took 17.258644104003906 ms
2022-09-21 19:37:29 INFO  Executing generated plans
2022-09-21 19:38:17 INFO  ---RUNTIME: Execution took 48773.69713783264 ms
2022-09-21 19:38:17 INFO  Done!
2022-09-21 19:38:17 INFO  # Finished -- repetition 3 of 7 
2022-09-21 19:38:17 INFO  # Optimization benchmark for operator_impact with args [['reviews', 'slow_loading', 'featurization_2', 'logistic_regression']] -- repetition 4 of 7
2022-09-21 19:38:17 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-21 19:38:17 INFO  Running instrumented original pipeline...
2022-09-21 19:38:18 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-21 19:38:18 INFO  ---RUNTIME: Importing and monkey-patching took 6.035089492797852 ms
2022-09-21 19:38:25 INFO  ---RUNTIME: Original pipeline execution took 7457.617521286011 ms (excluding imports and monkey-patching)
2022-09-21 19:38:25 INFO  Starting execution of 1 what-if analyses...
2022-09-21 19:38:25 INFO  Start plan generation for analysis OperatorImpact...
2022-09-21 19:38:25 INFO  ---RUNTIME: Plan generation took 4.903316497802734 ms
2022-09-21 19:38:25 INFO  Estimated runtime of original DAG is 6016.570091247559ms
2022-09-21 19:38:25 INFO  Performing Multi-Query Optimization
2022-09-21 19:38:25 INFO  Estimated unoptimized what-if runtime is 42349.27414534905ms
2022-09-21 19:38:25 INFO  Estimated optimised what-if runtime is 14132.239876739648ms
2022-09-21 19:38:25 INFO  Estimated optimisation runtime saving is 28217.034268609405ms
2022-09-21 19:38:25 INFO  ---RUNTIME: Multi-Query Optimization took 126.6474723815918 ms
2022-09-21 19:38:25 INFO  Executing generated plans
2022-09-21 19:38:41 INFO  ---RUNTIME: Execution took 15925.327777862549 ms
2022-09-21 19:38:41 INFO  Done!
2022-09-21 19:38:41 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-21 19:38:41 INFO  Running instrumented original pipeline...
2022-09-21 19:38:41 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-21 19:38:41 INFO  ---RUNTIME: Importing and monkey-patching took 6.25157356262207 ms
2022-09-21 19:38:48 INFO  ---RUNTIME: Original pipeline execution took 7212.307691574097 ms (excluding imports and monkey-patching)
2022-09-21 19:38:48 INFO  Starting execution of 1 what-if analyses...
2022-09-21 19:38:48 INFO  Start plan generation for analysis OperatorImpact...
2022-09-21 19:38:48 INFO  ---RUNTIME: Plan generation took 4.988670349121094 ms
2022-09-21 19:38:48 INFO  Estimated runtime of original DAG is 6018.418073654175ms
2022-09-21 19:38:48 WARNING Skipping Multi-Query Optimization (instead, only applying patches)
2022-09-21 19:38:48 INFO  Estimated unoptimised what-if runtime is 42231.22435309012ms
2022-09-21 19:38:48 INFO  ---RUNTIME: Multi-Query Optimization took 17.32039451599121 ms
2022-09-21 19:38:48 INFO  Executing generated plans
2022-09-21 19:39:50 INFO  ---RUNTIME: Execution took 61570.65963745117 ms
2022-09-21 19:39:50 INFO  Done!
2022-09-21 19:39:50 INFO  # Finished -- repetition 4 of 7 
2022-09-21 19:39:50 INFO  # Optimization benchmark for operator_impact with args [['reviews', 'slow_loading', 'featurization_2', 'logistic_regression']] -- repetition 5 of 7
2022-09-21 19:39:50 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-21 19:39:50 INFO  Running instrumented original pipeline...
2022-09-21 19:39:50 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-21 19:39:50 INFO  ---RUNTIME: Importing and monkey-patching took 6.192684173583984 ms
2022-09-21 19:39:58 INFO  ---RUNTIME: Original pipeline execution took 8255.139350891113 ms (excluding imports and monkey-patching)
2022-09-21 19:39:58 INFO  Starting execution of 1 what-if analyses...
2022-09-21 19:39:58 INFO  Start plan generation for analysis OperatorImpact...
2022-09-21 19:39:58 INFO  ---RUNTIME: Plan generation took 5.05828857421875 ms
2022-09-21 19:39:58 INFO  Estimated runtime of original DAG is 6921.594858169556ms
2022-09-21 19:39:58 INFO  Performing Multi-Query Optimization
2022-09-21 19:39:58 INFO  Estimated unoptimized what-if runtime is 48632.938464336046ms
2022-09-21 19:39:58 INFO  Estimated optimised what-if runtime is 15058.71306393164ms
2022-09-21 19:39:58 INFO  Estimated optimisation runtime saving is 33574.22540040441ms
2022-09-21 19:39:58 INFO  ---RUNTIME: Multi-Query Optimization took 125.90336799621582 ms
2022-09-21 19:39:58 INFO  Executing generated plans
2022-09-21 19:40:19 INFO  ---RUNTIME: Execution took 20300.46820640564 ms
2022-09-21 19:40:19 INFO  Done!
2022-09-21 19:40:19 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-21 19:40:19 INFO  Running instrumented original pipeline...
2022-09-21 19:40:19 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-21 19:40:19 INFO  ---RUNTIME: Importing and monkey-patching took 5.882501602172852 ms
2022-09-21 19:40:28 INFO  ---RUNTIME: Original pipeline execution took 9730.292558670044 ms (excluding imports and monkey-patching)
2022-09-21 19:40:28 INFO  Starting execution of 1 what-if analyses...
2022-09-21 19:40:28 INFO  Start plan generation for analysis OperatorImpact...
2022-09-21 19:40:28 INFO  ---RUNTIME: Plan generation took 5.057334899902344 ms
2022-09-21 19:40:28 INFO  Estimated runtime of original DAG is 7858.0827713012695ms
2022-09-21 19:40:28 WARNING Skipping Multi-Query Optimization (instead, only applying patches)
2022-09-21 19:40:28 INFO  Estimated unoptimised what-if runtime is 55215.08762763496ms
2022-09-21 19:40:28 INFO  ---RUNTIME: Multi-Query Optimization took 18.199920654296875 ms
2022-09-21 19:40:28 INFO  Executing generated plans
2022-09-21 19:41:22 INFO  ---RUNTIME: Execution took 53837.11767196655 ms
2022-09-21 19:41:22 INFO  Done!
2022-09-21 19:41:22 INFO  # Finished -- repetition 5 of 7 
2022-09-21 19:41:22 INFO  # Optimization benchmark for operator_impact with args [['reviews', 'slow_loading', 'featurization_2', 'logistic_regression']] -- repetition 6 of 7
2022-09-21 19:41:22 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-21 19:41:22 INFO  Running instrumented original pipeline...
2022-09-21 19:41:22 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-21 19:41:22 INFO  ---RUNTIME: Importing and monkey-patching took 6.181001663208008 ms
2022-09-21 19:41:32 INFO  ---RUNTIME: Original pipeline execution took 9874.92322921753 ms (excluding imports and monkey-patching)
2022-09-21 19:41:32 INFO  Starting execution of 1 what-if analyses...
2022-09-21 19:41:32 INFO  Start plan generation for analysis OperatorImpact...
2022-09-21 19:41:32 INFO  ---RUNTIME: Plan generation took 6.909608840942383 ms
2022-09-21 19:41:32 INFO  Estimated runtime of original DAG is 8486.8643283844ms
2022-09-21 19:41:32 INFO  Performing Multi-Query Optimization
2022-09-21 19:41:32 INFO  Estimated unoptimized what-if runtime is 59775.046434876254ms
2022-09-21 19:41:32 INFO  Estimated optimised what-if runtime is 21069.897820105343ms
2022-09-21 19:41:32 INFO  Estimated optimisation runtime saving is 38705.14861477091ms
2022-09-21 19:41:32 INFO  ---RUNTIME: Multi-Query Optimization took 214.51973915100098 ms
2022-09-21 19:41:32 INFO  Executing generated plans
2022-09-21 19:41:52 INFO  ---RUNTIME: Execution took 19898.245334625244 ms
2022-09-21 19:41:52 INFO  Done!
2022-09-21 19:41:52 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-21 19:41:52 INFO  Running instrumented original pipeline...
2022-09-21 19:41:52 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-21 19:41:52 INFO  ---RUNTIME: Importing and monkey-patching took 6.097316741943359 ms
2022-09-21 19:42:01 INFO  ---RUNTIME: Original pipeline execution took 8937.291860580444 ms (excluding imports and monkey-patching)
2022-09-21 19:42:01 INFO  Starting execution of 1 what-if analyses...
2022-09-21 19:42:01 INFO  Start plan generation for analysis OperatorImpact...
2022-09-21 19:42:01 INFO  ---RUNTIME: Plan generation took 4.8923492431640625 ms
2022-09-21 19:42:01 INFO  Estimated runtime of original DAG is 7246.1998462677ms
2022-09-21 19:42:01 WARNING Skipping Multi-Query Optimization (instead, only applying patches)
2022-09-21 19:42:01 INFO  Estimated unoptimised what-if runtime is 50862.10410724647ms
2022-09-21 19:42:01 INFO  ---RUNTIME: Multi-Query Optimization took 17.225027084350586 ms
2022-09-21 19:42:01 INFO  Executing generated plans
2022-09-21 19:43:00 INFO  ---RUNTIME: Execution took 58576.60913467407 ms
2022-09-21 19:43:00 INFO  Done!
2022-09-21 19:43:00 INFO  # Finished -- repetition 6 of 7 
2022-09-21 19:43:00 INFO  # Optimization benchmark for operator_impact with args [['reviews', 'slow_loading', 'featurization_2', 'logistic_regression']] -- repetition 7 of 7
2022-09-21 19:43:00 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-21 19:43:00 INFO  Running instrumented original pipeline...
2022-09-21 19:43:00 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-21 19:43:00 INFO  ---RUNTIME: Importing and monkey-patching took 6.127834320068359 ms
2022-09-21 19:43:09 INFO  ---RUNTIME: Original pipeline execution took 8873.765230178833 ms (excluding imports and monkey-patching)
2022-09-21 19:43:09 INFO  Starting execution of 1 what-if analyses...
2022-09-21 19:43:09 INFO  Start plan generation for analysis OperatorImpact...
2022-09-21 19:43:09 INFO  ---RUNTIME: Plan generation took 4.820108413696289 ms
2022-09-21 19:43:09 INFO  Estimated runtime of original DAG is 7417.938947677612ms
2022-09-21 19:43:09 INFO  Performing Multi-Query Optimization
2022-09-21 19:43:09 INFO  Estimated unoptimized what-if runtime is 52213.33681112534ms
2022-09-21 19:43:09 INFO  Estimated optimised what-if runtime is 16321.347109581402ms
2022-09-21 19:43:09 INFO  Estimated optimisation runtime saving is 35891.989701543935ms
2022-09-21 19:43:09 INFO  ---RUNTIME: Multi-Query Optimization took 127.65836715698242 ms
2022-09-21 19:43:09 INFO  Executing generated plans
2022-09-21 19:43:28 INFO  ---RUNTIME: Execution took 19724.531412124634 ms
2022-09-21 19:43:28 INFO  Done!
2022-09-21 19:43:28 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-21 19:43:28 INFO  Running instrumented original pipeline...
2022-09-21 19:43:29 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-21 19:43:29 INFO  ---RUNTIME: Importing and monkey-patching took 5.753517150878906 ms
2022-09-21 19:43:38 INFO  ---RUNTIME: Original pipeline execution took 9194.212436676025 ms (excluding imports and monkey-patching)
2022-09-21 19:43:38 INFO  Starting execution of 1 what-if analyses...
2022-09-21 19:43:38 INFO  Start plan generation for analysis OperatorImpact...
2022-09-21 19:43:38 INFO  ---RUNTIME: Plan generation took 4.843473434448242 ms
2022-09-21 19:43:38 INFO  Estimated runtime of original DAG is 7498.735666275024ms
2022-09-21 19:43:38 WARNING Skipping Multi-Query Optimization (instead, only applying patches)
2022-09-21 19:43:38 INFO  Estimated unoptimised what-if runtime is 52625.85592111318ms
2022-09-21 19:43:38 INFO  ---RUNTIME: Multi-Query Optimization took 17.32182502746582 ms
2022-09-21 19:43:38 INFO  Executing generated plans
2022-09-21 19:44:36 INFO  ---RUNTIME: Execution took 58620.962619781494 ms
2022-09-21 19:44:36 INFO  Done!
2022-09-21 19:44:36 INFO  # Finished -- repetition 7 of 7 
2022-09-21 19:44:36 INFO  # Final results after all repetitions
2022-09-21 19:44:36 INFO     repetition  ... no_opt_what_if_execution_combined_model_training
0           0  ...                                      1031.264067
1           1  ...                                      1066.868305
2           2  ...                                      1057.658911
3           3  ...                                      1347.518444
4           4  ...                                      1260.760546
5           5  ...                                      1661.847353
6           6  ...                                      1466.900826

[7 rows x 26 columns]
taskset -c 160-167 PROTOCOL_BUFFERS_PYTHON_IMPLEMENTATION=python python3.9 benchmarks_end_to_end.py operator_impact reviews slow_loading featurization_2 xgboost
2022-09-21 19:44:39.463532: W tensorflow/stream_executor/platform/default/dso_loader.cc:64] Could not load dynamic library 'libcudart.so.11.0'; dlerror: libcudart.so.11.0: cannot open shared object file: No such file or directory; LD_LIBRARY_PATH: /home/sgrafbe/mlwhatif/venv/lib/python3.9/site-packages/cv2/../../lib64:
2022-09-21 19:44:39.463583: I tensorflow/stream_executor/cuda/cudart_stub.cc:29] Ignore above cudart dlerror if you do not have a GPU set up on your machine.
2022-09-21 19:44:41 INFO  Patching sys.argv with ['mlwhatif', 'reviews', 'slow_loading', 'featurization_2', 'xgboost']
2022-09-21 19:44:41 INFO  Running instrumented original pipeline...
2022-09-21 19:44:41 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-21 19:44:41 INFO  ---RUNTIME: Importing and monkey-patching took 156.2347412109375 ms
2022-09-21 19:45:05 INFO  ---RUNTIME: Original pipeline execution took 24237.247467041016 ms (excluding imports and monkey-patching)
2022-09-21 19:45:05 INFO  Starting execution of 0 what-if analyses...
2022-09-21 19:45:05 INFO  Estimated runtime of original DAG is 22480.801582336426ms
2022-09-21 19:45:05 INFO  Performing Multi-Query Optimization
2022-09-21 19:45:05 INFO  Estimated unoptimized what-if runtime is 0ms
2022-09-21 19:45:05 INFO  Estimated optimised what-if runtime is 0ms
2022-09-21 19:45:05 INFO  Estimated optimisation runtime saving is 0ms
2022-09-21 19:45:05 INFO  ---RUNTIME: Multi-Query Optimization took 0.8749961853027344 ms
2022-09-21 19:45:05 INFO  Executing generated plans
2022-09-21 19:45:05 INFO  ---RUNTIME: Execution took 0.03457069396972656 ms
2022-09-21 19:45:05 INFO  Done!
2022-09-21 19:45:05 INFO  # Optimization benchmark for operator_impact with args [['reviews', 'slow_loading', 'featurization_2', 'xgboost']] -- repetition 1 of 7
2022-09-21 19:45:05 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-21 19:45:05 INFO  Running instrumented original pipeline...
2022-09-21 19:45:05 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-21 19:45:05 INFO  ---RUNTIME: Importing and monkey-patching took 9.072542190551758 ms
2022-09-21 19:45:30 INFO  ---RUNTIME: Original pipeline execution took 24543.122053146362 ms (excluding imports and monkey-patching)
2022-09-21 19:45:30 INFO  Starting execution of 1 what-if analyses...
2022-09-21 19:45:30 INFO  Start plan generation for analysis OperatorImpact...
2022-09-21 19:45:30 INFO  ---RUNTIME: Plan generation took 9.350061416625977 ms
2022-09-21 19:45:30 INFO  Estimated runtime of original DAG is 23244.55237388611ms
2022-09-21 19:45:30 INFO  Performing Multi-Query Optimization
2022-09-21 19:45:30 INFO  Estimated unoptimized what-if runtime is 165254.92556848162ms
2022-09-21 19:45:30 INFO  Estimated optimised what-if runtime is 126609.71261993443ms
2022-09-21 19:45:30 INFO  Estimated optimisation runtime saving is 38645.21294854718ms
2022-09-21 19:45:30 INFO  ---RUNTIME: Multi-Query Optimization took 216.9167995452881 ms
2022-09-21 19:45:30 INFO  Executing generated plans
2022-09-21 19:47:20 INFO  ---RUNTIME: Execution took 110533.09392929077 ms
2022-09-21 19:47:20 INFO  Done!
2022-09-21 19:47:20 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-21 19:47:20 INFO  Running instrumented original pipeline...
2022-09-21 19:47:21 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-21 19:47:21 INFO  ---RUNTIME: Importing and monkey-patching took 6.7920684814453125 ms
2022-09-21 19:47:44 INFO  ---RUNTIME: Original pipeline execution took 24069.327354431152 ms (excluding imports and monkey-patching)
2022-09-21 19:47:44 INFO  Starting execution of 1 what-if analyses...
2022-09-21 19:47:44 INFO  Start plan generation for analysis OperatorImpact...
2022-09-21 19:47:44 INFO  ---RUNTIME: Plan generation took 6.475925445556641 ms
2022-09-21 19:47:44 INFO  Estimated runtime of original DAG is 22082.361698150635ms
2022-09-21 19:47:44 WARNING Skipping Multi-Query Optimization (instead, only applying patches)
2022-09-21 19:47:44 INFO  Estimated unoptimised what-if runtime is 156760.6361549262ms
2022-09-21 19:47:44 INFO  ---RUNTIME: Multi-Query Optimization took 30.20954132080078 ms
2022-09-21 19:47:44 INFO  Executing generated plans
2022-09-21 19:50:18 INFO  ---RUNTIME: Execution took 153875.18000602722 ms
2022-09-21 19:50:18 INFO  Done!
2022-09-21 19:50:18 INFO  # Finished -- repetition 1 of 7 
2022-09-21 19:50:18 INFO  # Optimization benchmark for operator_impact with args [['reviews', 'slow_loading', 'featurization_2', 'xgboost']] -- repetition 2 of 7
2022-09-21 19:50:18 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-21 19:50:18 INFO  Running instrumented original pipeline...
2022-09-21 19:50:18 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-21 19:50:18 INFO  ---RUNTIME: Importing and monkey-patching took 11.745214462280273 ms
2022-09-21 19:50:41 INFO  ---RUNTIME: Original pipeline execution took 23110.27479171753 ms (excluding imports and monkey-patching)
2022-09-21 19:50:41 INFO  Starting execution of 1 what-if analyses...
2022-09-21 19:50:41 INFO  Start plan generation for analysis OperatorImpact...
2022-09-21 19:50:41 INFO  ---RUNTIME: Plan generation took 6.558895111083984 ms
2022-09-21 19:50:41 INFO  Estimated runtime of original DAG is 21772.93848991394ms
2022-09-21 19:50:41 INFO  Performing Multi-Query Optimization
2022-09-21 19:50:42 INFO  Estimated unoptimized what-if runtime is 154805.69523316954ms
2022-09-21 19:50:42 INFO  Estimated optimised what-if runtime is 118852.28532572363ms
2022-09-21 19:50:42 INFO  Estimated optimisation runtime saving is 35953.40990744591ms
2022-09-21 19:50:42 INFO  ---RUNTIME: Multi-Query Optimization took 208.74381065368652 ms
2022-09-21 19:50:42 INFO  Executing generated plans
2022-09-21 19:52:35 INFO  ---RUNTIME: Execution took 112830.24287223816 ms
2022-09-21 19:52:35 INFO  Done!
2022-09-21 19:52:35 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-21 19:52:35 INFO  Running instrumented original pipeline...
2022-09-21 19:52:35 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-21 19:52:35 INFO  ---RUNTIME: Importing and monkey-patching took 6.316661834716797 ms
2022-09-21 19:52:58 INFO  ---RUNTIME: Original pipeline execution took 23896.472454071045 ms (excluding imports and monkey-patching)
2022-09-21 19:52:58 INFO  Starting execution of 1 what-if analyses...
2022-09-21 19:52:58 INFO  Start plan generation for analysis OperatorImpact...
2022-09-21 19:52:58 INFO  ---RUNTIME: Plan generation took 5.112886428833008 ms
2022-09-21 19:52:58 INFO  Estimated runtime of original DAG is 22340.197801589966ms
2022-09-21 19:52:58 WARNING Skipping Multi-Query Optimization (instead, only applying patches)
2022-09-21 19:52:58 INFO  Estimated unoptimised what-if runtime is 158717.62702974293ms
2022-09-21 19:52:58 INFO  ---RUNTIME: Multi-Query Optimization took 17.14801788330078 ms
2022-09-21 19:52:58 INFO  Executing generated plans
2022-09-21 19:55:31 INFO  ---RUNTIME: Execution took 152226.8283367157 ms
2022-09-21 19:55:31 INFO  Done!
2022-09-21 19:55:31 INFO  # Finished -- repetition 2 of 7 
2022-09-21 19:55:31 INFO  # Optimization benchmark for operator_impact with args [['reviews', 'slow_loading', 'featurization_2', 'xgboost']] -- repetition 3 of 7
2022-09-21 19:55:31 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-21 19:55:31 INFO  Running instrumented original pipeline...
2022-09-21 19:55:31 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-21 19:55:31 INFO  ---RUNTIME: Importing and monkey-patching took 6.366729736328125 ms
2022-09-21 19:55:55 INFO  ---RUNTIME: Original pipeline execution took 23812.646865844727 ms (excluding imports and monkey-patching)
2022-09-21 19:55:55 INFO  Starting execution of 1 what-if analyses...
2022-09-21 19:55:55 INFO  Start plan generation for analysis OperatorImpact...
2022-09-21 19:55:55 INFO  ---RUNTIME: Plan generation took 5.09333610534668 ms
2022-09-21 19:55:55 INFO  Estimated runtime of original DAG is 22163.615703582764ms
2022-09-21 19:55:55 INFO  Performing Multi-Query Optimization
2022-09-21 19:55:55 INFO  Estimated unoptimized what-if runtime is 157596.35713829478ms
2022-09-21 19:55:55 INFO  Estimated optimised what-if runtime is 124901.22438837786ms
2022-09-21 19:55:55 INFO  Estimated optimisation runtime saving is 32695.132749916927ms
2022-09-21 19:55:55 INFO  ---RUNTIME: Multi-Query Optimization took 123.71563911437988 ms
2022-09-21 19:55:55 INFO  Executing generated plans
2022-09-21 19:57:45 INFO  ---RUNTIME: Execution took 110504.69589233398 ms
2022-09-21 19:57:45 INFO  Done!
2022-09-21 19:57:45 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-21 19:57:45 INFO  Running instrumented original pipeline...
2022-09-21 19:57:45 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-21 19:57:45 INFO  ---RUNTIME: Importing and monkey-patching took 6.778478622436523 ms
2022-09-21 19:58:09 INFO  ---RUNTIME: Original pipeline execution took 23626.494884490967 ms (excluding imports and monkey-patching)
2022-09-21 19:58:09 INFO  Starting execution of 1 what-if analyses...
2022-09-21 19:58:09 INFO  Start plan generation for analysis OperatorImpact...
2022-09-21 19:58:09 INFO  ---RUNTIME: Plan generation took 5.063056945800781 ms
2022-09-21 19:58:09 INFO  Estimated runtime of original DAG is 22395.337104797363ms
2022-09-21 19:58:09 WARNING Skipping Multi-Query Optimization (instead, only applying patches)
2022-09-21 19:58:09 INFO  Estimated unoptimised what-if runtime is 159125.09597760468ms
2022-09-21 19:58:09 INFO  ---RUNTIME: Multi-Query Optimization took 17.398595809936523 ms
2022-09-21 19:58:09 INFO  Executing generated plans
2022-09-21 20:00:41 INFO  ---RUNTIME: Execution took 152003.60941886902 ms
2022-09-21 20:00:41 INFO  Done!
2022-09-21 20:00:41 INFO  # Finished -- repetition 3 of 7 
2022-09-21 20:00:41 INFO  # Optimization benchmark for operator_impact with args [['reviews', 'slow_loading', 'featurization_2', 'xgboost']] -- repetition 4 of 7
2022-09-21 20:00:41 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-21 20:00:41 INFO  Running instrumented original pipeline...
2022-09-21 20:00:41 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-21 20:00:41 INFO  ---RUNTIME: Importing and monkey-patching took 5.849599838256836 ms
2022-09-21 20:01:05 INFO  ---RUNTIME: Original pipeline execution took 23859.227418899536 ms (excluding imports and monkey-patching)
2022-09-21 20:01:05 INFO  Starting execution of 1 what-if analyses...
2022-09-21 20:01:05 INFO  Start plan generation for analysis OperatorImpact...
2022-09-21 20:01:05 INFO  ---RUNTIME: Plan generation took 5.19561767578125 ms
2022-09-21 20:01:05 INFO  Estimated runtime of original DAG is 22303.7006855011ms
2022-09-21 20:01:05 INFO  Performing Multi-Query Optimization
2022-09-21 20:01:05 INFO  Estimated unoptimized what-if runtime is 158514.81796549502ms
2022-09-21 20:01:05 INFO  Estimated optimised what-if runtime is 128498.23970328234ms
2022-09-21 20:01:05 INFO  Estimated optimisation runtime saving is 30016.578262212686ms
2022-09-21 20:01:05 INFO  ---RUNTIME: Multi-Query Optimization took 126.41334533691406 ms
2022-09-21 20:01:05 INFO  Executing generated plans
2022-09-21 20:02:56 INFO  ---RUNTIME: Execution took 111652.9610157013 ms
2022-09-21 20:02:56 INFO  Done!
2022-09-21 20:02:57 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-21 20:02:57 INFO  Running instrumented original pipeline...
2022-09-21 20:02:57 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-21 20:02:57 INFO  ---RUNTIME: Importing and monkey-patching took 6.307125091552734 ms
2022-09-21 20:03:17 INFO  ---RUNTIME: Original pipeline execution took 20607.87296295166 ms (excluding imports and monkey-patching)
2022-09-21 20:03:17 INFO  Starting execution of 1 what-if analyses...
2022-09-21 20:03:17 INFO  Start plan generation for analysis OperatorImpact...
2022-09-21 20:03:17 INFO  ---RUNTIME: Plan generation took 5.817651748657227 ms
2022-09-21 20:03:17 INFO  Estimated runtime of original DAG is 19302.97040939331ms
2022-09-21 20:03:17 WARNING Skipping Multi-Query Optimization (instead, only applying patches)
2022-09-21 20:03:17 INFO  Estimated unoptimised what-if runtime is 137109.50820368007ms
2022-09-21 20:03:17 INFO  ---RUNTIME: Multi-Query Optimization took 19.06895637512207 ms
2022-09-21 20:03:17 INFO  Executing generated plans
2022-09-21 20:05:28 INFO  ---RUNTIME: Execution took 130859.16876792908 ms
2022-09-21 20:05:28 INFO  Done!
2022-09-21 20:05:28 INFO  # Finished -- repetition 4 of 7 
2022-09-21 20:05:28 INFO  # Optimization benchmark for operator_impact with args [['reviews', 'slow_loading', 'featurization_2', 'xgboost']] -- repetition 5 of 7
2022-09-21 20:05:28 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-21 20:05:28 INFO  Running instrumented original pipeline...
2022-09-21 20:05:28 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-21 20:05:28 INFO  ---RUNTIME: Importing and monkey-patching took 6.346464157104492 ms
2022-09-21 20:05:48 INFO  ---RUNTIME: Original pipeline execution took 20180.535078048706 ms (excluding imports and monkey-patching)
2022-09-21 20:05:48 INFO  Starting execution of 1 what-if analyses...
2022-09-21 20:05:48 INFO  Start plan generation for analysis OperatorImpact...
2022-09-21 20:05:48 INFO  ---RUNTIME: Plan generation took 4.949331283569336 ms
2022-09-21 20:05:48 INFO  Estimated runtime of original DAG is 18976.522207260132ms
2022-09-21 20:05:48 INFO  Performing Multi-Query Optimization
2022-09-21 20:05:48 INFO  Estimated unoptimized what-if runtime is 134926.17240811864ms
2022-09-21 20:05:48 INFO  Estimated optimised what-if runtime is 106151.87437457964ms
2022-09-21 20:05:48 INFO  Estimated optimisation runtime saving is 28774.298033539002ms
2022-09-21 20:05:48 INFO  ---RUNTIME: Multi-Query Optimization took 123.25620651245117 ms
2022-09-21 20:05:48 INFO  Executing generated plans
2022-09-21 20:07:23 INFO  ---RUNTIME: Execution took 94997.01619148254 ms
2022-09-21 20:07:23 INFO  Done!
2022-09-21 20:07:23 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-21 20:07:23 INFO  Running instrumented original pipeline...
2022-09-21 20:07:23 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-21 20:07:23 INFO  ---RUNTIME: Importing and monkey-patching took 7.320642471313477 ms
2022-09-21 20:07:44 INFO  ---RUNTIME: Original pipeline execution took 20165.867567062378 ms (excluding imports and monkey-patching)
2022-09-21 20:07:44 INFO  Starting execution of 1 what-if analyses...
2022-09-21 20:07:44 INFO  Start plan generation for analysis OperatorImpact...
2022-09-21 20:07:44 INFO  ---RUNTIME: Plan generation took 5.281925201416016 ms
2022-09-21 20:07:44 INFO  Estimated runtime of original DAG is 18953.758716583252ms
2022-09-21 20:07:44 WARNING Skipping Multi-Query Optimization (instead, only applying patches)
2022-09-21 20:07:44 INFO  Estimated unoptimised what-if runtime is 134639.03253071057ms
2022-09-21 20:07:44 INFO  ---RUNTIME: Multi-Query Optimization took 18.082141876220703 ms
2022-09-21 20:07:44 INFO  Executing generated plans
2022-09-21 20:09:52 INFO  ---RUNTIME: Execution took 128897.03464508057 ms
2022-09-21 20:09:52 INFO  Done!
2022-09-21 20:09:52 INFO  # Finished -- repetition 5 of 7 
2022-09-21 20:09:52 INFO  # Optimization benchmark for operator_impact with args [['reviews', 'slow_loading', 'featurization_2', 'xgboost']] -- repetition 6 of 7
2022-09-21 20:09:52 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-21 20:09:52 INFO  Running instrumented original pipeline...
2022-09-21 20:09:53 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-21 20:09:53 INFO  ---RUNTIME: Importing and monkey-patching took 6.453275680541992 ms
2022-09-21 20:10:13 INFO  ---RUNTIME: Original pipeline execution took 20691.595554351807 ms (excluding imports and monkey-patching)
2022-09-21 20:10:13 INFO  Starting execution of 1 what-if analyses...
2022-09-21 20:10:13 INFO  Start plan generation for analysis OperatorImpact...
2022-09-21 20:10:13 INFO  ---RUNTIME: Plan generation took 5.1784515380859375 ms
2022-09-21 20:10:13 INFO  Estimated runtime of original DAG is 19483.670234680176ms
2022-09-21 20:10:13 INFO  Performing Multi-Query Optimization
2022-09-21 20:10:13 INFO  Estimated unoptimized what-if runtime is 138474.0159275674ms
2022-09-21 20:10:13 INFO  Estimated optimised what-if runtime is 106241.66986692684ms
2022-09-21 20:10:13 INFO  Estimated optimisation runtime saving is 32232.34606064057ms
2022-09-21 20:10:13 INFO  ---RUNTIME: Multi-Query Optimization took 125.66351890563965 ms
2022-09-21 20:10:13 INFO  Executing generated plans
2022-09-21 20:11:49 INFO  ---RUNTIME: Execution took 95551.1531829834 ms
2022-09-21 20:11:49 INFO  Done!
2022-09-21 20:11:49 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-21 20:11:49 INFO  Running instrumented original pipeline...
2022-09-21 20:11:49 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-21 20:11:49 INFO  ---RUNTIME: Importing and monkey-patching took 6.4258575439453125 ms
2022-09-21 20:12:09 INFO  ---RUNTIME: Original pipeline execution took 20127.986192703247 ms (excluding imports and monkey-patching)
2022-09-21 20:12:09 INFO  Starting execution of 1 what-if analyses...
2022-09-21 20:12:09 INFO  Start plan generation for analysis OperatorImpact...
2022-09-21 20:12:09 INFO  ---RUNTIME: Plan generation took 5.342960357666016 ms
2022-09-21 20:12:09 INFO  Estimated runtime of original DAG is 18862.58625984192ms
2022-09-21 20:12:09 WARNING Skipping Multi-Query Optimization (instead, only applying patches)
2022-09-21 20:12:09 INFO  Estimated unoptimised what-if runtime is 133998.05399706992ms
2022-09-21 20:12:09 INFO  ---RUNTIME: Multi-Query Optimization took 17.307043075561523 ms
2022-09-21 20:12:09 INFO  Executing generated plans
2022-09-21 20:14:49 INFO  ---RUNTIME: Execution took 160029.09207344055 ms
2022-09-21 20:14:49 INFO  Done!
2022-09-21 20:14:49 INFO  # Finished -- repetition 6 of 7 
2022-09-21 20:14:49 INFO  # Optimization benchmark for operator_impact with args [['reviews', 'slow_loading', 'featurization_2', 'xgboost']] -- repetition 7 of 7
2022-09-21 20:14:49 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-21 20:14:49 INFO  Running instrumented original pipeline...
2022-09-21 20:14:49 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-21 20:14:49 INFO  ---RUNTIME: Importing and monkey-patching took 6.081581115722656 ms
2022-09-21 20:15:09 INFO  ---RUNTIME: Original pipeline execution took 20186.073541641235 ms (excluding imports and monkey-patching)
2022-09-21 20:15:09 INFO  Starting execution of 1 what-if analyses...
2022-09-21 20:15:09 INFO  Start plan generation for analysis OperatorImpact...
2022-09-21 20:15:09 INFO  ---RUNTIME: Plan generation took 4.949331283569336 ms
2022-09-21 20:15:09 INFO  Estimated runtime of original DAG is 18999.366283416748ms
2022-09-21 20:15:09 INFO  Performing Multi-Query Optimization
2022-09-21 20:15:09 INFO  Estimated unoptimized what-if runtime is 135105.3762262088ms
2022-09-21 20:15:09 INFO  Estimated optimised what-if runtime is 106306.7823161147ms
2022-09-21 20:15:09 INFO  Estimated optimisation runtime saving is 28798.593910094118ms
2022-09-21 20:15:09 INFO  ---RUNTIME: Multi-Query Optimization took 121.92869186401367 ms
2022-09-21 20:15:09 INFO  Executing generated plans
2022-09-21 20:16:46 INFO  ---RUNTIME: Execution took 96215.40451049805 ms
2022-09-21 20:16:46 INFO  Done!
2022-09-21 20:16:46 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-21 20:16:46 INFO  Running instrumented original pipeline...
2022-09-21 20:16:46 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-21 20:16:46 INFO  ---RUNTIME: Importing and monkey-patching took 6.541013717651367 ms
2022-09-21 20:17:06 INFO  ---RUNTIME: Original pipeline execution took 20055.086612701416 ms (excluding imports and monkey-patching)
2022-09-21 20:17:06 INFO  Starting execution of 1 what-if analyses...
2022-09-21 20:17:06 INFO  Start plan generation for analysis OperatorImpact...
2022-09-21 20:17:06 INFO  ---RUNTIME: Plan generation took 4.9343109130859375 ms
2022-09-21 20:17:06 INFO  Estimated runtime of original DAG is 18827.759742736816ms
2022-09-21 20:17:06 WARNING Skipping Multi-Query Optimization (instead, only applying patches)
2022-09-21 20:17:06 INFO  Estimated unoptimised what-if runtime is 133733.66107367422ms
2022-09-21 20:17:06 INFO  ---RUNTIME: Multi-Query Optimization took 17.322540283203125 ms
2022-09-21 20:17:06 INFO  Executing generated plans
2022-09-21 20:19:20 INFO  ---RUNTIME: Execution took 134711.10224723816 ms
2022-09-21 20:19:20 INFO  Done!
2022-09-21 20:19:20 INFO  # Finished -- repetition 7 of 7 
2022-09-21 20:19:20 INFO  # Final results after all repetitions
2022-09-21 20:19:20 INFO     repetition  ... no_opt_what_if_execution_combined_model_training
0           0  ...                                     93058.213711
1           1  ...                                     92056.988478
2           2  ...                                     93516.999722
3           3  ...                                     80767.884016
4           4  ...                                     80714.803934
5           5  ...                                     80996.298313
6           6  ...                                     80704.338074

[7 rows x 26 columns]
taskset -c 160-167 PROTOCOL_BUFFERS_PYTHON_IMPLEMENTATION=python python3.9 benchmarks_end_to_end.py operator_impact reviews slow_loading featurization_2 neural_network
2022-09-21 20:19:22.903845: W tensorflow/stream_executor/platform/default/dso_loader.cc:64] Could not load dynamic library 'libcudart.so.11.0'; dlerror: libcudart.so.11.0: cannot open shared object file: No such file or directory; LD_LIBRARY_PATH: /home/sgrafbe/mlwhatif/venv/lib/python3.9/site-packages/cv2/../../lib64:
2022-09-21 20:19:22.903892: I tensorflow/stream_executor/cuda/cudart_stub.cc:29] Ignore above cudart dlerror if you do not have a GPU set up on your machine.
2022-09-21 20:19:24 INFO  Patching sys.argv with ['mlwhatif', 'reviews', 'slow_loading', 'featurization_2', 'neural_network']
2022-09-21 20:19:24 INFO  Running instrumented original pipeline...
2022-09-21 20:19:24 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-21 20:19:24 INFO  ---RUNTIME: Importing and monkey-patching took 94.63310241699219 ms
2022-09-21 20:19:29.938164: W tensorflow/stream_executor/platform/default/dso_loader.cc:64] Could not load dynamic library 'libcuda.so.1'; dlerror: libcuda.so.1: cannot open shared object file: No such file or directory; LD_LIBRARY_PATH: /home/sgrafbe/mlwhatif/venv/lib/python3.9/site-packages/cv2/../../lib64:
2022-09-21 20:19:29.938201: W tensorflow/stream_executor/cuda/cuda_driver.cc:326] failed call to cuInit: UNKNOWN ERROR (303)
2022-09-21 20:19:29.938225: I tensorflow/stream_executor/cuda/cuda_diagnostics.cc:156] kernel driver does not appear to be running on this host (wagyu): /proc/driver/nvidia/version does not exist
2022-09-21 20:19:29.938743: I tensorflow/core/platform/cpu_feature_guard.cc:142] This TensorFlow binary is optimized with oneAPI Deep Neural Network Library (oneDNN) to use the following CPU instructions in performance-critical operations:  AVX2 FMA
To enable them in other operations, rebuild TensorFlow with the appropriate compiler flags.
2022-09-21 20:19:30.555397: I tensorflow/compiler/mlir/mlir_graph_optimization_pass.cc:176] None of the MLIR Optimization Passes are enabled (registered 2)
2022-09-21 20:19:30.569373: I tensorflow/core/platform/profile_utils/cpu_utils.cc:114] CPU Frequency: 2595290000 Hz
2022-09-21 20:19:38 INFO  ---RUNTIME: Original pipeline execution took 14603.91902923584 ms (excluding imports and monkey-patching)
2022-09-21 20:19:38 INFO  Starting execution of 0 what-if analyses...
2022-09-21 20:19:38 INFO  Estimated runtime of original DAG is 13325.867891311646ms
2022-09-21 20:19:38 INFO  Performing Multi-Query Optimization
2022-09-21 20:19:38 INFO  Estimated unoptimized what-if runtime is 0ms
2022-09-21 20:19:38 INFO  Estimated optimised what-if runtime is 0ms
2022-09-21 20:19:38 INFO  Estimated optimisation runtime saving is 0ms
2022-09-21 20:19:38 INFO  ---RUNTIME: Multi-Query Optimization took 0.5373954772949219 ms
2022-09-21 20:19:38 INFO  Executing generated plans
2022-09-21 20:19:38 INFO  ---RUNTIME: Execution took 0.02574920654296875 ms
2022-09-21 20:19:38 INFO  Done!
2022-09-21 20:19:38 INFO  # Optimization benchmark for operator_impact with args [['reviews', 'slow_loading', 'featurization_2', 'neural_network']] -- repetition 1 of 7
2022-09-21 20:19:38 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-21 20:19:38 INFO  Running instrumented original pipeline...
2022-09-21 20:19:38 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-21 20:19:38 INFO  ---RUNTIME: Importing and monkey-patching took 5.326747894287109 ms
2022-09-21 20:19:53 INFO  ---RUNTIME: Original pipeline execution took 14258.13913345337 ms (excluding imports and monkey-patching)
2022-09-21 20:19:53 INFO  Starting execution of 1 what-if analyses...
2022-09-21 20:19:53 INFO  Start plan generation for analysis OperatorImpact...
2022-09-21 20:19:53 INFO  ---RUNTIME: Plan generation took 6.606340408325195 ms
2022-09-21 20:19:53 INFO  Estimated runtime of original DAG is 13065.905809402466ms
2022-09-21 20:19:53 INFO  Performing Multi-Query Optimization
2022-09-21 20:19:53 INFO  Estimated unoptimized what-if runtime is 92736.79402026319ms
2022-09-21 20:19:53 INFO  Estimated optimised what-if runtime is 64860.2195416763ms
2022-09-21 20:19:53 INFO  Estimated optimisation runtime saving is 27876.57447858689ms
2022-09-21 20:19:53 INFO  ---RUNTIME: Multi-Query Optimization took 126.07622146606445 ms
2022-09-21 20:19:53 INFO  Executing generated plans
2022-09-21 20:21:00 INFO  ---RUNTIME: Execution took 66851.62234306335 ms
2022-09-21 20:21:00 INFO  Done!
2022-09-21 20:21:00 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-21 20:21:00 INFO  Running instrumented original pipeline...
2022-09-21 20:21:00 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-21 20:21:00 INFO  ---RUNTIME: Importing and monkey-patching took 5.775928497314453 ms
2022-09-21 20:21:14 INFO  ---RUNTIME: Original pipeline execution took 14115.796327590942 ms (excluding imports and monkey-patching)
2022-09-21 20:21:14 INFO  Starting execution of 1 what-if analyses...
2022-09-21 20:21:14 INFO  Start plan generation for analysis OperatorImpact...
2022-09-21 20:21:14 INFO  ---RUNTIME: Plan generation took 5.05828857421875 ms
2022-09-21 20:21:14 INFO  Estimated runtime of original DAG is 12599.78437423706ms
2022-09-21 20:21:14 WARNING Skipping Multi-Query Optimization (instead, only applying patches)
2022-09-21 20:21:14 INFO  Estimated unoptimised what-if runtime is 89268.99096708467ms
2022-09-21 20:21:14 INFO  ---RUNTIME: Multi-Query Optimization took 17.059326171875 ms
2022-09-21 20:21:14 INFO  Executing generated plans
2022-09-21 20:22:51 INFO  ---RUNTIME: Execution took 96934.12375450134 ms
2022-09-21 20:22:51 INFO  Done!
2022-09-21 20:22:51 INFO  # Finished -- repetition 1 of 7 
2022-09-21 20:22:51 INFO  # Optimization benchmark for operator_impact with args [['reviews', 'slow_loading', 'featurization_2', 'neural_network']] -- repetition 2 of 7
2022-09-21 20:22:51 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-21 20:22:51 INFO  Running instrumented original pipeline...
2022-09-21 20:22:51 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-21 20:22:51 INFO  ---RUNTIME: Importing and monkey-patching took 6.1626434326171875 ms
2022-09-21 20:23:04 INFO  ---RUNTIME: Original pipeline execution took 13670.41039466858 ms (excluding imports and monkey-patching)
2022-09-21 20:23:04 INFO  Starting execution of 1 what-if analyses...
2022-09-21 20:23:04 INFO  Start plan generation for analysis OperatorImpact...
2022-09-21 20:23:04 INFO  ---RUNTIME: Plan generation took 5.029201507568359 ms
2022-09-21 20:23:04 INFO  Estimated runtime of original DAG is 12468.742609024048ms
2022-09-21 20:23:04 INFO  Performing Multi-Query Optimization
2022-09-21 20:23:04 INFO  Estimated unoptimized what-if runtime is 88474.11766787662ms
2022-09-21 20:23:04 INFO  Estimated optimised what-if runtime is 60905.779489318054ms
2022-09-21 20:23:04 INFO  Estimated optimisation runtime saving is 27568.338178558566ms
2022-09-21 20:23:04 INFO  ---RUNTIME: Multi-Query Optimization took 125.36787986755371 ms
2022-09-21 20:23:04 INFO  Executing generated plans
2022-09-21 20:24:10 INFO  ---RUNTIME: Execution took 65134.36985015869 ms
2022-09-21 20:24:10 INFO  Done!
2022-09-21 20:24:10 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-21 20:24:10 INFO  Running instrumented original pipeline...
2022-09-21 20:24:10 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-21 20:24:10 INFO  ---RUNTIME: Importing and monkey-patching took 6.129741668701172 ms
2022-09-21 20:24:23 INFO  ---RUNTIME: Original pipeline execution took 13754.539966583252 ms (excluding imports and monkey-patching)
2022-09-21 20:24:23 INFO  Starting execution of 1 what-if analyses...
2022-09-21 20:24:23 INFO  Start plan generation for analysis OperatorImpact...
2022-09-21 20:24:23 INFO  ---RUNTIME: Plan generation took 4.879951477050781 ms
2022-09-21 20:24:23 INFO  Estimated runtime of original DAG is 12560.797929763794ms
2022-09-21 20:24:23 WARNING Skipping Multi-Query Optimization (instead, only applying patches)
2022-09-21 20:24:23 INFO  Estimated unoptimised what-if runtime is 88978.98648772482ms
2022-09-21 20:24:23 INFO  ---RUNTIME: Multi-Query Optimization took 17.757892608642578 ms
2022-09-21 20:24:23 INFO  Executing generated plans
2022-09-21 20:26:02 INFO  ---RUNTIME: Execution took 98878.19170951843 ms
2022-09-21 20:26:02 INFO  Done!
2022-09-21 20:26:02 INFO  # Finished -- repetition 2 of 7 
2022-09-21 20:26:02 INFO  # Optimization benchmark for operator_impact with args [['reviews', 'slow_loading', 'featurization_2', 'neural_network']] -- repetition 3 of 7
2022-09-21 20:26:02 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-21 20:26:02 INFO  Running instrumented original pipeline...
2022-09-21 20:26:02 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-21 20:26:02 INFO  ---RUNTIME: Importing and monkey-patching took 7.271051406860352 ms
2022-09-21 20:26:16 INFO  ---RUNTIME: Original pipeline execution took 13956.368446350098 ms (excluding imports and monkey-patching)
2022-09-21 20:26:16 INFO  Starting execution of 1 what-if analyses...
2022-09-21 20:26:16 INFO  Start plan generation for analysis OperatorImpact...
2022-09-21 20:26:16 INFO  ---RUNTIME: Plan generation took 5.184412002563477 ms
2022-09-21 20:26:16 INFO  Estimated runtime of original DAG is 12722.434282302856ms
2022-09-21 20:26:16 INFO  Performing Multi-Query Optimization
2022-09-21 20:26:16 INFO  Estimated unoptimized what-if runtime is 90268.72554345455ms
2022-09-21 20:26:16 INFO  Estimated optimised what-if runtime is 62002.40756351704ms
2022-09-21 20:26:16 INFO  Estimated optimisation runtime saving is 28266.317979937514ms
2022-09-21 20:26:16 INFO  ---RUNTIME: Multi-Query Optimization took 126.92618370056152 ms
2022-09-21 20:26:16 INFO  Executing generated plans
2022-09-21 20:27:25 INFO  ---RUNTIME: Execution took 68511.12270355225 ms
2022-09-21 20:27:25 INFO  Done!
2022-09-21 20:27:25 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-21 20:27:25 INFO  Running instrumented original pipeline...
2022-09-21 20:27:25 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-21 20:27:25 INFO  ---RUNTIME: Importing and monkey-patching took 5.986690521240234 ms
2022-09-21 20:27:40 INFO  ---RUNTIME: Original pipeline execution took 14605.084419250488 ms (excluding imports and monkey-patching)
2022-09-21 20:27:40 INFO  Starting execution of 1 what-if analyses...
2022-09-21 20:27:40 INFO  Start plan generation for analysis OperatorImpact...
2022-09-21 20:27:40 INFO  ---RUNTIME: Plan generation took 5.253076553344727 ms
2022-09-21 20:27:40 INFO  Estimated runtime of original DAG is 12918.049097061157ms
2022-09-21 20:27:40 WARNING Skipping Multi-Query Optimization (instead, only applying patches)
2022-09-21 20:27:40 INFO  Estimated unoptimised what-if runtime is 91493.99537712423ms
2022-09-21 20:27:40 INFO  ---RUNTIME: Multi-Query Optimization took 17.16327667236328 ms
2022-09-21 20:27:40 INFO  Executing generated plans
2022-09-21 20:29:17 INFO  ---RUNTIME: Execution took 97462.13984489441 ms
2022-09-21 20:29:17 INFO  Done!
2022-09-21 20:29:17 INFO  # Finished -- repetition 3 of 7 
2022-09-21 20:29:17 INFO  # Optimization benchmark for operator_impact with args [['reviews', 'slow_loading', 'featurization_2', 'neural_network']] -- repetition 4 of 7
2022-09-21 20:29:17 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-21 20:29:17 INFO  Running instrumented original pipeline...
2022-09-21 20:29:17 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-21 20:29:17 INFO  ---RUNTIME: Importing and monkey-patching took 5.789995193481445 ms
2022-09-21 20:29:31 INFO  ---RUNTIME: Original pipeline execution took 14136.62338256836 ms (excluding imports and monkey-patching)
2022-09-21 20:29:31 INFO  Starting execution of 1 what-if analyses...
2022-09-21 20:29:31 INFO  Start plan generation for analysis OperatorImpact...
2022-09-21 20:29:31 INFO  ---RUNTIME: Plan generation took 5.890130996704102 ms
2022-09-21 20:29:31 INFO  Estimated runtime of original DAG is 12909.119606018066ms
2022-09-21 20:29:31 INFO  Performing Multi-Query Optimization
2022-09-21 20:29:31 INFO  Estimated unoptimized what-if runtime is 91592.58890542774ms
2022-09-21 20:29:31 INFO  Estimated optimised what-if runtime is 62645.26450253312ms
2022-09-21 20:29:31 INFO  Estimated optimisation runtime saving is 28947.324402894614ms
2022-09-21 20:29:31 INFO  ---RUNTIME: Multi-Query Optimization took 124.0072250366211 ms
2022-09-21 20:29:31 INFO  Executing generated plans
2022-09-21 20:30:36 INFO  ---RUNTIME: Execution took 64784.1682434082 ms
2022-09-21 20:30:36 INFO  Done!
2022-09-21 20:30:36 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-21 20:30:36 INFO  Running instrumented original pipeline...
2022-09-21 20:30:36 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-21 20:30:36 INFO  ---RUNTIME: Importing and monkey-patching took 6.130456924438477 ms
2022-09-21 20:30:51 INFO  ---RUNTIME: Original pipeline execution took 14938.752889633179 ms (excluding imports and monkey-patching)
2022-09-21 20:30:51 INFO  Starting execution of 1 what-if analyses...
2022-09-21 20:30:51 INFO  Start plan generation for analysis OperatorImpact...
2022-09-21 20:30:51 INFO  ---RUNTIME: Plan generation took 5.84101676940918 ms
2022-09-21 20:30:51 INFO  Estimated runtime of original DAG is 13717.770338058472ms
2022-09-21 20:30:51 WARNING Skipping Multi-Query Optimization (instead, only applying patches)
2022-09-21 20:30:51 INFO  Estimated unoptimised what-if runtime is 97115.01321974111ms
2022-09-21 20:30:51 INFO  ---RUNTIME: Multi-Query Optimization took 457.735538482666 ms
2022-09-21 20:30:51 INFO  Executing generated plans
2022-09-21 20:32:29 INFO  ---RUNTIME: Execution took 97598.14858436584 ms
2022-09-21 20:32:29 INFO  Done!
2022-09-21 20:32:29 INFO  # Finished -- repetition 4 of 7 
2022-09-21 20:32:29 INFO  # Optimization benchmark for operator_impact with args [['reviews', 'slow_loading', 'featurization_2', 'neural_network']] -- repetition 5 of 7
2022-09-21 20:32:29 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-21 20:32:29 INFO  Running instrumented original pipeline...
2022-09-21 20:32:29 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-21 20:32:29 INFO  ---RUNTIME: Importing and monkey-patching took 6.015300750732422 ms
2022-09-21 20:32:43 INFO  ---RUNTIME: Original pipeline execution took 13899.603605270386 ms (excluding imports and monkey-patching)
2022-09-21 20:32:43 INFO  Starting execution of 1 what-if analyses...
2022-09-21 20:32:43 INFO  Start plan generation for analysis OperatorImpact...
2022-09-21 20:32:43 INFO  ---RUNTIME: Plan generation took 5.080938339233398 ms
2022-09-21 20:32:43 INFO  Estimated runtime of original DAG is 12662.051677703857ms
2022-09-21 20:32:43 INFO  Performing Multi-Query Optimization
2022-09-21 20:32:43 INFO  Estimated unoptimized what-if runtime is 89825.56390307787ms
2022-09-21 20:32:43 INFO  Estimated optimised what-if runtime is 61668.324885486545ms
2022-09-21 20:32:43 INFO  Estimated optimisation runtime saving is 28157.239017591324ms
2022-09-21 20:32:43 INFO  ---RUNTIME: Multi-Query Optimization took 122.8485107421875 ms
2022-09-21 20:32:43 INFO  Executing generated plans
2022-09-21 20:33:48 INFO  ---RUNTIME: Execution took 64583.601236343384 ms
2022-09-21 20:33:48 INFO  Done!
2022-09-21 20:33:48 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-21 20:33:48 INFO  Running instrumented original pipeline...
2022-09-21 20:33:48 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-21 20:33:48 INFO  ---RUNTIME: Importing and monkey-patching took 6.591796875 ms
2022-09-21 20:34:02 INFO  ---RUNTIME: Original pipeline execution took 13955.943584442139 ms (excluding imports and monkey-patching)
2022-09-21 20:34:02 INFO  Starting execution of 1 what-if analyses...
2022-09-21 20:34:02 INFO  Start plan generation for analysis OperatorImpact...
2022-09-21 20:34:02 INFO  ---RUNTIME: Plan generation took 4.758596420288086 ms
2022-09-21 20:34:02 INFO  Estimated runtime of original DAG is 12733.624696731567ms
2022-09-21 20:34:02 WARNING Skipping Multi-Query Optimization (instead, only applying patches)
2022-09-21 20:34:02 INFO  Estimated unoptimised what-if runtime is 90220.84144602962ms
2022-09-21 20:34:02 INFO  ---RUNTIME: Multi-Query Optimization took 17.574310302734375 ms
2022-09-21 20:34:02 INFO  Executing generated plans
2022-09-21 20:35:40 INFO  ---RUNTIME: Execution took 98361.35149002075 ms
2022-09-21 20:35:40 INFO  Done!
2022-09-21 20:35:40 INFO  # Finished -- repetition 5 of 7 
2022-09-21 20:35:40 INFO  # Optimization benchmark for operator_impact with args [['reviews', 'slow_loading', 'featurization_2', 'neural_network']] -- repetition 6 of 7
2022-09-21 20:35:40 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-21 20:35:40 INFO  Running instrumented original pipeline...
2022-09-21 20:35:40 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-21 20:35:40 INFO  ---RUNTIME: Importing and monkey-patching took 5.984306335449219 ms
2022-09-21 20:35:55 INFO  ---RUNTIME: Original pipeline execution took 14577.125072479248 ms (excluding imports and monkey-patching)
2022-09-21 20:35:55 INFO  Starting execution of 1 what-if analyses...
2022-09-21 20:35:55 INFO  Start plan generation for analysis OperatorImpact...
2022-09-21 20:35:55 INFO  ---RUNTIME: Plan generation took 4.941701889038086 ms
2022-09-21 20:35:55 INFO  Estimated runtime of original DAG is 13353.898763656616ms
2022-09-21 20:35:55 INFO  Performing Multi-Query Optimization
2022-09-21 20:35:55 INFO  Estimated unoptimized what-if runtime is 94671.59706696136ms
2022-09-21 20:35:55 INFO  Estimated optimised what-if runtime is 62619.98033138296ms
2022-09-21 20:35:55 INFO  Estimated optimisation runtime saving is 32051.6167355784ms
2022-09-21 20:35:55 INFO  ---RUNTIME: Multi-Query Optimization took 124.05920028686523 ms
2022-09-21 20:35:55 INFO  Executing generated plans
2022-09-21 20:37:00 INFO  ---RUNTIME: Execution took 65441.82848930359 ms
2022-09-21 20:37:00 INFO  Done!
2022-09-21 20:37:00 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-21 20:37:00 INFO  Running instrumented original pipeline...
2022-09-21 20:37:01 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-21 20:37:01 INFO  ---RUNTIME: Importing and monkey-patching took 5.950689315795898 ms
2022-09-21 20:37:15 INFO  ---RUNTIME: Original pipeline execution took 14440.61279296875 ms (excluding imports and monkey-patching)
2022-09-21 20:37:15 INFO  Starting execution of 1 what-if analyses...
2022-09-21 20:37:15 INFO  Start plan generation for analysis OperatorImpact...
2022-09-21 20:37:15 INFO  ---RUNTIME: Plan generation took 4.853248596191406 ms
2022-09-21 20:37:15 INFO  Estimated runtime of original DAG is 12765.551805496216ms
2022-09-21 20:37:15 WARNING Skipping Multi-Query Optimization (instead, only applying patches)
2022-09-21 20:37:15 INFO  Estimated unoptimised what-if runtime is 90395.25160268846ms
2022-09-21 20:37:15 INFO  ---RUNTIME: Multi-Query Optimization took 17.740488052368164 ms
2022-09-21 20:37:15 INFO  Executing generated plans
2022-09-21 20:38:53 INFO  ---RUNTIME: Execution took 97995.62430381775 ms
2022-09-21 20:38:53 INFO  Done!
2022-09-21 20:38:53 INFO  # Finished -- repetition 6 of 7 
2022-09-21 20:38:53 INFO  # Optimization benchmark for operator_impact with args [['reviews', 'slow_loading', 'featurization_2', 'neural_network']] -- repetition 7 of 7
2022-09-21 20:38:53 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-21 20:38:53 INFO  Running instrumented original pipeline...
2022-09-21 20:38:53 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-21 20:38:53 INFO  ---RUNTIME: Importing and monkey-patching took 5.724668502807617 ms
2022-09-21 20:39:07 INFO  ---RUNTIME: Original pipeline execution took 13818.982601165771 ms (excluding imports and monkey-patching)
2022-09-21 20:39:07 INFO  Starting execution of 1 what-if analyses...
2022-09-21 20:39:07 INFO  Start plan generation for analysis OperatorImpact...
2022-09-21 20:39:07 INFO  ---RUNTIME: Plan generation took 4.761457443237305 ms
2022-09-21 20:39:07 INFO  Estimated runtime of original DAG is 12586.737632751465ms
2022-09-21 20:39:07 INFO  Performing Multi-Query Optimization
2022-09-21 20:39:07 INFO  Estimated unoptimized what-if runtime is 89284.80011713653ms
2022-09-21 20:39:07 INFO  Estimated optimised what-if runtime is 61266.54951497727ms
2022-09-21 20:39:07 INFO  Estimated optimisation runtime saving is 28018.250602159264ms
2022-09-21 20:39:07 INFO  ---RUNTIME: Multi-Query Optimization took 124.11379814147949 ms
2022-09-21 20:39:07 INFO  Executing generated plans
2022-09-21 20:40:12 INFO  ---RUNTIME: Execution took 65246.05321884155 ms
2022-09-21 20:40:12 INFO  Done!
2022-09-21 20:40:12 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-21 20:40:12 INFO  Running instrumented original pipeline...
2022-09-21 20:40:12 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-21 20:40:12 INFO  ---RUNTIME: Importing and monkey-patching took 6.031036376953125 ms
2022-09-21 20:40:26 INFO  ---RUNTIME: Original pipeline execution took 14139.612674713135 ms (excluding imports and monkey-patching)
2022-09-21 20:40:26 INFO  Starting execution of 1 what-if analyses...
2022-09-21 20:40:26 INFO  Start plan generation for analysis OperatorImpact...
2022-09-21 20:40:26 INFO  ---RUNTIME: Plan generation took 4.798173904418945 ms
2022-09-21 20:40:26 INFO  Estimated runtime of original DAG is 12917.109251022339ms
2022-09-21 20:40:26 WARNING Skipping Multi-Query Optimization (instead, only applying patches)
2022-09-21 20:40:26 INFO  Estimated unoptimised what-if runtime is 91445.7641441857ms
2022-09-21 20:40:26 INFO  ---RUNTIME: Multi-Query Optimization took 17.23170280456543 ms
2022-09-21 20:40:26 INFO  Executing generated plans
2022-09-21 20:42:06 INFO  ---RUNTIME: Execution took 99824.11766052246 ms
2022-09-21 20:42:06 INFO  Done!
2022-09-21 20:42:06 INFO  # Finished -- repetition 7 of 7 
2022-09-21 20:42:06 INFO  # Final results after all repetitions
2022-09-21 20:42:06 INFO     repetition  ... no_opt_what_if_execution_combined_model_training
0           0  ...                                     44336.515665
1           1  ...                                     45063.084602
2           2  ...                                     43893.287420
3           3  ...                                     44354.008436
4           4  ...                                     44408.021212
5           5  ...                                     44199.155807
6           6  ...                                     44428.195477

[7 rows x 26 columns]
taskset -c 160-167 PROTOCOL_BUFFERS_PYTHON_IMPLEMENTATION=python python3.9 benchmarks_end_to_end.py operator_impact reviews slow_loading featurization_3 logistic_regression
2022-09-21 20:42:09.613936: W tensorflow/stream_executor/platform/default/dso_loader.cc:64] Could not load dynamic library 'libcudart.so.11.0'; dlerror: libcudart.so.11.0: cannot open shared object file: No such file or directory; LD_LIBRARY_PATH: /home/sgrafbe/mlwhatif/venv/lib/python3.9/site-packages/cv2/../../lib64:
2022-09-21 20:42:09.613984: I tensorflow/stream_executor/cuda/cudart_stub.cc:29] Ignore above cudart dlerror if you do not have a GPU set up on your machine.
2022-09-21 20:42:11 INFO  Patching sys.argv with ['mlwhatif', 'reviews', 'slow_loading', 'featurization_3', 'logistic_regression']
2022-09-21 20:42:11 INFO  Running instrumented original pipeline...
2022-09-21 20:42:11 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-21 20:42:11 INFO  ---RUNTIME: Importing and monkey-patching took 105.00884056091309 ms
2022-09-21 20:42:58 INFO  ---RUNTIME: Original pipeline execution took 47023.24843406677 ms (excluding imports and monkey-patching)
2022-09-21 20:42:58 INFO  Starting execution of 0 what-if analyses...
2022-09-21 20:42:58 INFO  Estimated runtime of original DAG is 33088.693380355835ms
2022-09-21 20:42:58 INFO  Performing Multi-Query Optimization
2022-09-21 20:42:58 INFO  Estimated unoptimized what-if runtime is 0ms
2022-09-21 20:42:58 INFO  Estimated optimised what-if runtime is 0ms
2022-09-21 20:42:58 INFO  Estimated optimisation runtime saving is 0ms
2022-09-21 20:42:58 INFO  ---RUNTIME: Multi-Query Optimization took 0.579833984375 ms
2022-09-21 20:42:58 INFO  Executing generated plans
2022-09-21 20:42:58 INFO  ---RUNTIME: Execution took 0.024557113647460938 ms
2022-09-21 20:42:58 INFO  Done!
2022-09-21 20:42:58 INFO  # Optimization benchmark for operator_impact with args [['reviews', 'slow_loading', 'featurization_3', 'logistic_regression']] -- repetition 1 of 7
2022-09-21 20:42:58 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-21 20:42:58 INFO  Running instrumented original pipeline...
2022-09-21 20:42:58 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-21 20:42:58 INFO  ---RUNTIME: Importing and monkey-patching took 5.450010299682617 ms
2022-09-21 20:43:47 INFO  ---RUNTIME: Original pipeline execution took 48880.45883178711 ms (excluding imports and monkey-patching)
2022-09-21 20:43:47 INFO  Starting execution of 1 what-if analyses...
2022-09-21 20:43:47 INFO  Start plan generation for analysis OperatorImpact...
2022-09-21 20:43:47 INFO  ---RUNTIME: Plan generation took 7.098674774169922 ms
2022-09-21 20:43:47 INFO  Estimated runtime of original DAG is 33716.50695800781ms
2022-09-21 20:43:47 INFO  Performing Multi-Query Optimization
2022-09-21 20:43:47 INFO  Estimated unoptimized what-if runtime is 399007.63207173545ms
2022-09-21 20:43:47 INFO  Estimated optimised what-if runtime is 188457.99361464672ms
2022-09-21 20:43:47 INFO  Estimated optimisation runtime saving is 210549.63845708873ms
2022-09-21 20:43:47 INFO  ---RUNTIME: Multi-Query Optimization took 342.5266742706299 ms
2022-09-21 20:43:47 INFO  Executing generated plans
2022-09-21 20:46:52 INFO  ---RUNTIME: Execution took 184839.0758037567 ms
2022-09-21 20:46:52 INFO  Done!
2022-09-21 20:46:52 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-21 20:46:52 INFO  Running instrumented original pipeline...
2022-09-21 20:46:52 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-21 20:46:52 INFO  ---RUNTIME: Importing and monkey-patching took 6.45136833190918 ms
2022-09-21 20:47:37 INFO  ---RUNTIME: Original pipeline execution took 44833.18495750427 ms (excluding imports and monkey-patching)
2022-09-21 20:47:37 INFO  Starting execution of 1 what-if analyses...
2022-09-21 20:47:37 INFO  Start plan generation for analysis OperatorImpact...
2022-09-21 20:47:37 INFO  ---RUNTIME: Plan generation took 6.1492919921875 ms
2022-09-21 20:47:37 INFO  Estimated runtime of original DAG is 33168.23697090149ms
2022-09-21 20:47:37 WARNING Skipping Multi-Query Optimization (instead, only applying patches)
2022-09-21 20:47:37 INFO  Estimated unoptimised what-if runtime is 392297.8974948313ms
2022-09-21 20:47:37 INFO  ---RUNTIME: Multi-Query Optimization took 23.382186889648438 ms
2022-09-21 20:47:37 INFO  Executing generated plans
Traceback (most recent call last):
  File "/home/sgrafbe/mlwhatif/experiments/end_to_end/benchmarks_end_to_end.py", line 238, in <module>
    analysis_result_no_opt = PipelineAnalyzer \
  File "/home/sgrafbe/mlwhatif/mlwhatif/_pipeline_analyzer.py", line 93, in execute
    return singleton.run(notebook_path=self._notebook_path,
  File "/home/sgrafbe/mlwhatif/mlwhatif/execution/_pipeline_executor.py", line 149, in run
    self.run_what_if_analyses()
  File "/home/sgrafbe/mlwhatif/mlwhatif/execution/_pipeline_executor.py", line 181, in run_what_if_analyses
    DagExecutor(self).execute(what_if_dag)
  File "/home/sgrafbe/mlwhatif/mlwhatif/execution/_dag_executor.py", line 45, in execute
    self.traverse_graph_and_process_nodes(dag, execute_node)
  File "/home/sgrafbe/mlwhatif/mlwhatif/execution/_dag_executor.py", line 57, in traverse_graph_and_process_nodes
    result_node = func(node)
  File "/home/sgrafbe/mlwhatif/mlwhatif/execution/_dag_executor.py", line 40, in execute_node
    optimizer_info, result_df = capture_optimizer_info(executable_processing_func)
  File "/home/sgrafbe/mlwhatif/mlwhatif/execution/_stat_tracking.py", line 28, in capture_optimizer_info
    result = instrumented_function_call()
  File "/home/sgrafbe/mlwhatif/mlwhatif/monkeypatching/_patch_sklearn.py", line 1729, in processing_func
    transformed_data = wrap_in_mlinspect_array_if_necessary(transformed_data)
  File "/home/sgrafbe/mlwhatif/mlwhatif/monkeypatching/_monkey_patching_utils.py", line 229, in wrap_in_mlinspect_array_if_necessary
    df_object = MlinspectNdarray(df_object)
  File "/home/sgrafbe/mlwhatif/mlwhatif/monkeypatching/_mlinspect_ndarray.py", line 16, in __new__
    obj = numpy.asarray(input_array).view(cls)
  File "/home/sgrafbe/mlwhatif/venv/lib64/python3.9/site-packages/numpy/core/_asarray.py", line 83, in asarray
    return array(a, dtype, copy=False, order=order)
numpy.core._exceptions.MemoryError: Unable to allocate 3.72 GiB for an array with shape (35312,) and data type <U28286
taskset -c 160-167 PROTOCOL_BUFFERS_PYTHON_IMPLEMENTATION=python python3.9 benchmarks_end_to_end.py operator_impact reviews slow_loading featurization_3 xgboost
2022-09-21 20:47:58.137866: W tensorflow/stream_executor/platform/default/dso_loader.cc:64] Could not load dynamic library 'libcudart.so.11.0'; dlerror: libcudart.so.11.0: cannot open shared object file: No such file or directory; LD_LIBRARY_PATH: /home/sgrafbe/mlwhatif/venv/lib/python3.9/site-packages/cv2/../../lib64:
2022-09-21 20:47:58.137914: I tensorflow/stream_executor/cuda/cudart_stub.cc:29] Ignore above cudart dlerror if you do not have a GPU set up on your machine.
2022-09-21 20:47:59 INFO  Patching sys.argv with ['mlwhatif', 'reviews', 'slow_loading', 'featurization_3', 'xgboost']
2022-09-21 20:47:59 INFO  Running instrumented original pipeline...
2022-09-21 20:47:59 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-21 20:47:59 INFO  ---RUNTIME: Importing and monkey-patching took 112.72406578063965 ms
2022-09-21 20:48:57 INFO  ---RUNTIME: Original pipeline execution took 57215.182065963745 ms (excluding imports and monkey-patching)
2022-09-21 20:48:57 INFO  Starting execution of 0 what-if analyses...
2022-09-21 20:48:57 INFO  Estimated runtime of original DAG is 49409.602642059326ms
2022-09-21 20:48:57 INFO  Performing Multi-Query Optimization
2022-09-21 20:48:57 INFO  Estimated unoptimized what-if runtime is 0ms
2022-09-21 20:48:57 INFO  Estimated optimised what-if runtime is 0ms
2022-09-21 20:48:57 INFO  Estimated optimisation runtime saving is 0ms
2022-09-21 20:48:57 INFO  ---RUNTIME: Multi-Query Optimization took 0.7252693176269531 ms
2022-09-21 20:48:57 INFO  Executing generated plans
2022-09-21 20:48:57 INFO  ---RUNTIME: Execution took 0.0247955322265625 ms
2022-09-21 20:48:57 INFO  Done!
2022-09-21 20:48:57 INFO  # Optimization benchmark for operator_impact with args [['reviews', 'slow_loading', 'featurization_3', 'xgboost']] -- repetition 1 of 7
2022-09-21 20:48:57 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-21 20:48:57 INFO  Running instrumented original pipeline...
2022-09-21 20:48:57 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-21 20:48:57 INFO  ---RUNTIME: Importing and monkey-patching took 5.445718765258789 ms
2022-09-21 20:49:57 INFO  ---RUNTIME: Original pipeline execution took 60224.167585372925 ms (excluding imports and monkey-patching)
2022-09-21 20:49:57 INFO  Starting execution of 1 what-if analyses...
2022-09-21 20:49:57 INFO  Start plan generation for analysis OperatorImpact...
2022-09-21 20:49:57 INFO  ---RUNTIME: Plan generation took 6.684541702270508 ms
2022-09-21 20:49:57 INFO  Estimated runtime of original DAG is 49232.17177391052ms
2022-09-21 20:49:57 INFO  Performing Multi-Query Optimization
2022-09-21 20:49:57 INFO  Estimated unoptimized what-if runtime is 587673.5586299526ms
2022-09-21 20:49:57 INFO  Estimated optimised what-if runtime is 379559.9034528568ms
2022-09-21 20:49:57 INFO  Estimated optimisation runtime saving is 208113.6551770958ms
2022-09-21 20:49:57 INFO  ---RUNTIME: Multi-Query Optimization took 338.864803314209 ms
2022-09-21 20:49:57 INFO  Executing generated plans
2022-09-21 20:56:39 INFO  ---RUNTIME: Execution took 401358.6435317993 ms
2022-09-21 20:56:39 INFO  Done!
2022-09-21 20:56:39 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-21 20:56:39 INFO  Running instrumented original pipeline...
2022-09-21 20:56:39 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-21 20:56:39 INFO  ---RUNTIME: Importing and monkey-patching took 6.2656402587890625 ms
2022-09-21 20:57:49 INFO  ---RUNTIME: Original pipeline execution took 70456.72059059143 ms (excluding imports and monkey-patching)
2022-09-21 20:57:49 INFO  Starting execution of 1 what-if analyses...
2022-09-21 20:57:49 INFO  Start plan generation for analysis OperatorImpact...
2022-09-21 20:57:49 INFO  ---RUNTIME: Plan generation took 34.50417518615723 ms
2022-09-21 20:57:49 INFO  Estimated runtime of original DAG is 55482.784032821655ms
2022-09-21 20:57:49 WARNING Skipping Multi-Query Optimization (instead, only applying patches)
2022-09-21 20:57:49 INFO  Estimated unoptimised what-if runtime is 662984.2680091173ms
2022-09-21 20:57:49 INFO  ---RUNTIME: Multi-Query Optimization took 29.188871383666992 ms
2022-09-21 20:57:49 INFO  Executing generated plans
Traceback (most recent call last):
  File "/home/sgrafbe/mlwhatif/experiments/end_to_end/benchmarks_end_to_end.py", line 238, in <module>
    analysis_result_no_opt = PipelineAnalyzer \
  File "/home/sgrafbe/mlwhatif/mlwhatif/_pipeline_analyzer.py", line 93, in execute
    return singleton.run(notebook_path=self._notebook_path,
  File "/home/sgrafbe/mlwhatif/mlwhatif/execution/_pipeline_executor.py", line 149, in run
    self.run_what_if_analyses()
  File "/home/sgrafbe/mlwhatif/mlwhatif/execution/_pipeline_executor.py", line 181, in run_what_if_analyses
    DagExecutor(self).execute(what_if_dag)
  File "/home/sgrafbe/mlwhatif/mlwhatif/execution/_dag_executor.py", line 45, in execute
    self.traverse_graph_and_process_nodes(dag, execute_node)
  File "/home/sgrafbe/mlwhatif/mlwhatif/execution/_dag_executor.py", line 57, in traverse_graph_and_process_nodes
    result_node = func(node)
  File "/home/sgrafbe/mlwhatif/mlwhatif/execution/_dag_executor.py", line 40, in execute_node
    optimizer_info, result_df = capture_optimizer_info(executable_processing_func)
  File "/home/sgrafbe/mlwhatif/mlwhatif/execution/_stat_tracking.py", line 28, in capture_optimizer_info
    result = instrumented_function_call()
  File "/home/sgrafbe/mlwhatif/mlwhatif/monkeypatching/_patch_sklearn.py", line 1726, in processing_func
    input_df_copy = input_df.copy()
numpy.core._exceptions.MemoryError: Unable to allocate 3.89 GiB for an array with shape (35312,) and data type <U29600
taskset -c 160-167 PROTOCOL_BUFFERS_PYTHON_IMPLEMENTATION=python python3.9 benchmarks_end_to_end.py operator_impact reviews slow_loading featurization_3 neural_network
2022-09-21 20:59:13.786553: W tensorflow/stream_executor/platform/default/dso_loader.cc:64] Could not load dynamic library 'libcudart.so.11.0'; dlerror: libcudart.so.11.0: cannot open shared object file: No such file or directory; LD_LIBRARY_PATH: /home/sgrafbe/mlwhatif/venv/lib/python3.9/site-packages/cv2/../../lib64:
2022-09-21 20:59:13.786592: I tensorflow/stream_executor/cuda/cudart_stub.cc:29] Ignore above cudart dlerror if you do not have a GPU set up on your machine.
2022-09-21 20:59:15 INFO  Patching sys.argv with ['mlwhatif', 'reviews', 'slow_loading', 'featurization_3', 'neural_network']
2022-09-21 20:59:15 INFO  Running instrumented original pipeline...
2022-09-21 20:59:15 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-21 20:59:15 INFO  ---RUNTIME: Importing and monkey-patching took 147.25542068481445 ms
2022-09-21 20:59:39.177080: W tensorflow/stream_executor/platform/default/dso_loader.cc:64] Could not load dynamic library 'libcuda.so.1'; dlerror: libcuda.so.1: cannot open shared object file: No such file or directory; LD_LIBRARY_PATH: /home/sgrafbe/mlwhatif/venv/lib/python3.9/site-packages/cv2/../../lib64:
2022-09-21 20:59:39.177115: W tensorflow/stream_executor/cuda/cuda_driver.cc:326] failed call to cuInit: UNKNOWN ERROR (303)
2022-09-21 20:59:39.177144: I tensorflow/stream_executor/cuda/cuda_diagnostics.cc:156] kernel driver does not appear to be running on this host (wagyu): /proc/driver/nvidia/version does not exist
2022-09-21 20:59:39.177627: I tensorflow/core/platform/cpu_feature_guard.cc:142] This TensorFlow binary is optimized with oneAPI Deep Neural Network Library (oneDNN) to use the following CPU instructions in performance-critical operations:  AVX2 FMA
To enable them in other operations, rebuild TensorFlow with the appropriate compiler flags.
2022-09-21 20:59:39.837876: I tensorflow/compiler/mlir/mlir_graph_optimization_pass.cc:176] None of the MLIR Optimization Passes are enabled (registered 2)
2022-09-21 20:59:39.852397: I tensorflow/core/platform/profile_utils/cpu_utils.cc:114] CPU Frequency: 2595290000 Hz
2022-09-21 21:00:05 INFO  ---RUNTIME: Original pipeline execution took 49637.97211647034 ms (excluding imports and monkey-patching)
2022-09-21 21:00:05 INFO  Starting execution of 0 what-if analyses...
2022-09-21 21:00:05 INFO  Estimated runtime of original DAG is 42002.64835357666ms
2022-09-21 21:00:05 INFO  Performing Multi-Query Optimization
2022-09-21 21:00:05 INFO  Estimated unoptimized what-if runtime is 0ms
2022-09-21 21:00:05 INFO  Estimated optimised what-if runtime is 0ms
2022-09-21 21:00:05 INFO  Estimated optimisation runtime saving is 0ms
2022-09-21 21:00:05 INFO  ---RUNTIME: Multi-Query Optimization took 0.5936622619628906 ms
2022-09-21 21:00:05 INFO  Executing generated plans
2022-09-21 21:00:05 INFO  ---RUNTIME: Execution took 0.021219253540039062 ms
2022-09-21 21:00:05 INFO  Done!
2022-09-21 21:00:05 INFO  # Optimization benchmark for operator_impact with args [['reviews', 'slow_loading', 'featurization_3', 'neural_network']] -- repetition 1 of 7
2022-09-21 21:00:05 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-21 21:00:05 INFO  Running instrumented original pipeline...
2022-09-21 21:00:05 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-21 21:00:05 INFO  ---RUNTIME: Importing and monkey-patching took 5.71894645690918 ms
2022-09-21 21:00:56 INFO  ---RUNTIME: Original pipeline execution took 51327.84962654114 ms (excluding imports and monkey-patching)
2022-09-21 21:00:56 INFO  Starting execution of 1 what-if analyses...
2022-09-21 21:00:56 INFO  Start plan generation for analysis OperatorImpact...
2022-09-21 21:00:56 INFO  ---RUNTIME: Plan generation took 12.476682662963867 ms
2022-09-21 21:00:56 INFO  Estimated runtime of original DAG is 40984.64584350586ms
2022-09-21 21:00:56 INFO  Performing Multi-Query Optimization
2022-09-21 21:00:56 INFO  Estimated unoptimized what-if runtime is 487501.1321564182ms
2022-09-21 21:00:56 INFO  Estimated optimised what-if runtime is 279740.03850633674ms
2022-09-21 21:00:56 INFO  Estimated optimisation runtime saving is 207761.0936500815ms
2022-09-21 21:00:56 INFO  ---RUNTIME: Multi-Query Optimization took 172.61672019958496 ms
2022-09-21 21:00:56 INFO  Executing generated plans
2022-09-21 21:05:36 INFO  ---RUNTIME: Execution took 279735.0420951843 ms
2022-09-21 21:05:36 INFO  Done!
2022-09-21 21:05:36 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-21 21:05:36 INFO  Running instrumented original pipeline...
2022-09-21 21:05:36 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-21 21:05:36 INFO  ---RUNTIME: Importing and monkey-patching took 8.420944213867188 ms
2022-09-21 21:06:33 INFO  ---RUNTIME: Original pipeline execution took 56735.0172996521 ms (excluding imports and monkey-patching)
2022-09-21 21:06:33 INFO  Starting execution of 1 what-if analyses...
2022-09-21 21:06:33 INFO  Start plan generation for analysis OperatorImpact...
2022-09-21 21:06:33 INFO  ---RUNTIME: Plan generation took 5.980730056762695 ms
2022-09-21 21:06:33 INFO  Estimated runtime of original DAG is 42512.489318847656ms
2022-09-21 21:06:33 WARNING Skipping Multi-Query Optimization (instead, only applying patches)
2022-09-21 21:06:33 INFO  Estimated unoptimised what-if runtime is 505587.1540653702ms
2022-09-21 21:06:33 INFO  ---RUNTIME: Multi-Query Optimization took 23.793458938598633 ms
2022-09-21 21:06:33 INFO  Executing generated plans
Traceback (most recent call last):
  File "/home/sgrafbe/mlwhatif/experiments/end_to_end/benchmarks_end_to_end.py", line 238, in <module>
    analysis_result_no_opt = PipelineAnalyzer \
  File "/home/sgrafbe/mlwhatif/mlwhatif/_pipeline_analyzer.py", line 93, in execute
    return singleton.run(notebook_path=self._notebook_path,
  File "/home/sgrafbe/mlwhatif/mlwhatif/execution/_pipeline_executor.py", line 149, in run
    self.run_what_if_analyses()
  File "/home/sgrafbe/mlwhatif/mlwhatif/execution/_pipeline_executor.py", line 181, in run_what_if_analyses
    DagExecutor(self).execute(what_if_dag)
  File "/home/sgrafbe/mlwhatif/mlwhatif/execution/_dag_executor.py", line 45, in execute
    self.traverse_graph_and_process_nodes(dag, execute_node)
  File "/home/sgrafbe/mlwhatif/mlwhatif/execution/_dag_executor.py", line 57, in traverse_graph_and_process_nodes
    result_node = func(node)
  File "/home/sgrafbe/mlwhatif/mlwhatif/execution/_dag_executor.py", line 40, in execute_node
    optimizer_info, result_df = capture_optimizer_info(executable_processing_func)
  File "/home/sgrafbe/mlwhatif/mlwhatif/execution/_stat_tracking.py", line 28, in capture_optimizer_info
    result = instrumented_function_call()
  File "/home/sgrafbe/mlwhatif/mlwhatif/monkeypatching/_patch_sklearn.py", line 1729, in processing_func
    transformed_data = wrap_in_mlinspect_array_if_necessary(transformed_data)
  File "/home/sgrafbe/mlwhatif/mlwhatif/monkeypatching/_monkey_patching_utils.py", line 229, in wrap_in_mlinspect_array_if_necessary
    df_object = MlinspectNdarray(df_object)
  File "/home/sgrafbe/mlwhatif/mlwhatif/monkeypatching/_mlinspect_ndarray.py", line 16, in __new__
    obj = numpy.asarray(input_array).view(cls)
  File "/home/sgrafbe/mlwhatif/venv/lib64/python3.9/site-packages/numpy/core/_asarray.py", line 83, in asarray
    return array(a, dtype, copy=False, order=order)
numpy.core._exceptions.MemoryError: Unable to allocate 3.71 GiB for an array with shape (35312,) and data type <U28219
taskset -c 160-167 PROTOCOL_BUFFERS_PYTHON_IMPLEMENTATION=python python3.9 benchmarks_end_to_end.py operator_impact reviews slow_loading featurization_4 logistic_regression
2022-09-21 21:07:06.891140: W tensorflow/stream_executor/platform/default/dso_loader.cc:64] Could not load dynamic library 'libcudart.so.11.0'; dlerror: libcudart.so.11.0: cannot open shared object file: No such file or directory; LD_LIBRARY_PATH: /home/sgrafbe/mlwhatif/venv/lib/python3.9/site-packages/cv2/../../lib64:
2022-09-21 21:07:06.891182: I tensorflow/stream_executor/cuda/cudart_stub.cc:29] Ignore above cudart dlerror if you do not have a GPU set up on your machine.
2022-09-21 21:07:08 INFO  Patching sys.argv with ['mlwhatif', 'reviews', 'slow_loading', 'featurization_4', 'logistic_regression']
2022-09-21 21:07:08 INFO  Running instrumented original pipeline...
2022-09-21 21:07:08 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-21 21:07:08 INFO  ---RUNTIME: Importing and monkey-patching took 96.73547744750977 ms
2022-09-21 21:07:21 INFO  ---RUNTIME: Original pipeline execution took 13228.873252868652 ms (excluding imports and monkey-patching)
2022-09-21 21:07:21 INFO  Starting execution of 0 what-if analyses...
2022-09-21 21:07:21 INFO  Estimated runtime of original DAG is 9953.20439338684ms
2022-09-21 21:07:21 INFO  Performing Multi-Query Optimization
2022-09-21 21:07:21 INFO  Estimated unoptimized what-if runtime is 0ms
2022-09-21 21:07:21 INFO  Estimated optimised what-if runtime is 0ms
2022-09-21 21:07:21 INFO  Estimated optimisation runtime saving is 0ms
2022-09-21 21:07:21 INFO  ---RUNTIME: Multi-Query Optimization took 0.5359649658203125 ms
2022-09-21 21:07:21 INFO  Executing generated plans
2022-09-21 21:07:21 INFO  ---RUNTIME: Execution took 0.02384185791015625 ms
2022-09-21 21:07:21 INFO  Done!
2022-09-21 21:07:21 INFO  # Optimization benchmark for operator_impact with args [['reviews', 'slow_loading', 'featurization_4', 'logistic_regression']] -- repetition 1 of 7
2022-09-21 21:07:21 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-21 21:07:21 INFO  Running instrumented original pipeline...
2022-09-21 21:07:21 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-21 21:07:21 INFO  ---RUNTIME: Importing and monkey-patching took 6.104469299316406 ms
2022-09-21 21:07:34 INFO  ---RUNTIME: Original pipeline execution took 13300.540208816528 ms (excluding imports and monkey-patching)
2022-09-21 21:07:34 INFO  Starting execution of 1 what-if analyses...
2022-09-21 21:07:34 INFO  Start plan generation for analysis OperatorImpact...
2022-09-21 21:07:34 INFO  ---RUNTIME: Plan generation took 6.173372268676758 ms
2022-09-21 21:07:34 INFO  Estimated runtime of original DAG is 10056.639432907104ms
2022-09-21 21:07:34 INFO  Performing Multi-Query Optimization
2022-09-21 21:07:34 INFO  Estimated unoptimized what-if runtime is 71571.1796333441ms
2022-09-21 21:07:34 INFO  Estimated optimised what-if runtime is 26963.06219731984ms
2022-09-21 21:07:34 INFO  Estimated optimisation runtime saving is 44608.11743602426ms
2022-09-21 21:07:34 INFO  ---RUNTIME: Multi-Query Optimization took 147.0351219177246 ms
2022-09-21 21:07:34 INFO  Executing generated plans
2022-09-21 21:08:04 INFO  ---RUNTIME: Execution took 29440.478563308716 ms
2022-09-21 21:08:04 INFO  Done!
2022-09-21 21:08:04 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-21 21:08:04 INFO  Running instrumented original pipeline...
2022-09-21 21:08:04 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-21 21:08:04 INFO  ---RUNTIME: Importing and monkey-patching took 6.291389465332031 ms
2022-09-21 21:08:17 INFO  ---RUNTIME: Original pipeline execution took 13217.843770980835 ms (excluding imports and monkey-patching)
2022-09-21 21:08:17 INFO  Starting execution of 1 what-if analyses...
2022-09-21 21:08:17 INFO  Start plan generation for analysis OperatorImpact...
2022-09-21 21:08:17 INFO  ---RUNTIME: Plan generation took 5.262851715087891 ms
2022-09-21 21:08:17 INFO  Estimated runtime of original DAG is 9753.332614898682ms
2022-09-21 21:08:17 WARNING Skipping Multi-Query Optimization (instead, only applying patches)
2022-09-21 21:08:17 INFO  Estimated unoptimised what-if runtime is 69258.59222145325ms
2022-09-21 21:08:17 INFO  ---RUNTIME: Multi-Query Optimization took 18.197059631347656 ms
2022-09-21 21:08:17 INFO  Executing generated plans
2022-09-21 21:09:35 INFO  ---RUNTIME: Execution took 77995.36657333374 ms
2022-09-21 21:09:35 INFO  Done!
2022-09-21 21:09:35 INFO  # Finished -- repetition 1 of 7 
2022-09-21 21:09:35 INFO  # Optimization benchmark for operator_impact with args [['reviews', 'slow_loading', 'featurization_4', 'logistic_regression']] -- repetition 2 of 7
2022-09-21 21:09:35 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-21 21:09:35 INFO  Running instrumented original pipeline...
2022-09-21 21:09:35 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-21 21:09:35 INFO  ---RUNTIME: Importing and monkey-patching took 6.20579719543457 ms
2022-09-21 21:09:48 INFO  ---RUNTIME: Original pipeline execution took 13084.152221679688 ms (excluding imports and monkey-patching)
2022-09-21 21:09:48 INFO  Starting execution of 1 what-if analyses...
2022-09-21 21:09:48 INFO  Start plan generation for analysis OperatorImpact...
2022-09-21 21:09:48 INFO  ---RUNTIME: Plan generation took 5.262136459350586 ms
2022-09-21 21:09:48 INFO  Estimated runtime of original DAG is 9826.54857635498ms
2022-09-21 21:09:48 INFO  Performing Multi-Query Optimization
2022-09-21 21:09:48 INFO  Estimated unoptimized what-if runtime is 69872.42792723794ms
2022-09-21 21:09:48 INFO  Estimated optimised what-if runtime is 25996.50667419987ms
2022-09-21 21:09:48 INFO  Estimated optimisation runtime saving is 43875.92125303806ms
2022-09-21 21:09:48 INFO  ---RUNTIME: Multi-Query Optimization took 134.7033977508545 ms
2022-09-21 21:09:48 INFO  Executing generated plans
2022-09-21 21:10:17 INFO  ---RUNTIME: Execution took 28966.336250305176 ms
2022-09-21 21:10:17 INFO  Done!
2022-09-21 21:10:17 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-21 21:10:17 INFO  Running instrumented original pipeline...
2022-09-21 21:10:17 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-21 21:10:17 INFO  ---RUNTIME: Importing and monkey-patching took 6.021022796630859 ms
2022-09-21 21:10:30 INFO  ---RUNTIME: Original pipeline execution took 13110.219955444336 ms (excluding imports and monkey-patching)
2022-09-21 21:10:30 INFO  Starting execution of 1 what-if analyses...
2022-09-21 21:10:30 INFO  Start plan generation for analysis OperatorImpact...
2022-09-21 21:10:30 INFO  ---RUNTIME: Plan generation took 5.062580108642578 ms
2022-09-21 21:10:30 INFO  Estimated runtime of original DAG is 9644.903421401978ms
2022-09-21 21:10:30 WARNING Skipping Multi-Query Optimization (instead, only applying patches)
2022-09-21 21:10:30 INFO  Estimated unoptimised what-if runtime is 68507.50866319923ms
2022-09-21 21:10:30 INFO  ---RUNTIME: Multi-Query Optimization took 18.327951431274414 ms
2022-09-21 21:10:30 INFO  Executing generated plans
2022-09-21 21:11:49 INFO  ---RUNTIME: Execution took 78044.59929466248 ms
2022-09-21 21:11:49 INFO  Done!
2022-09-21 21:11:49 INFO  # Finished -- repetition 2 of 7 
2022-09-21 21:11:49 INFO  # Optimization benchmark for operator_impact with args [['reviews', 'slow_loading', 'featurization_4', 'logistic_regression']] -- repetition 3 of 7
2022-09-21 21:11:49 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-21 21:11:49 INFO  Running instrumented original pipeline...
2022-09-21 21:11:49 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-21 21:11:49 INFO  ---RUNTIME: Importing and monkey-patching took 6.34455680847168 ms
2022-09-21 21:12:02 INFO  ---RUNTIME: Original pipeline execution took 13414.267301559448 ms (excluding imports and monkey-patching)
2022-09-21 21:12:02 INFO  Starting execution of 1 what-if analyses...
2022-09-21 21:12:02 INFO  Start plan generation for analysis OperatorImpact...
2022-09-21 21:12:02 INFO  ---RUNTIME: Plan generation took 5.246877670288086 ms
2022-09-21 21:12:02 INFO  Estimated runtime of original DAG is 10082.417011260986ms
2022-09-21 21:12:02 INFO  Performing Multi-Query Optimization
2022-09-21 21:12:02 INFO  Estimated unoptimized what-if runtime is 71752.07841290854ms
2022-09-21 21:12:02 INFO  Estimated optimised what-if runtime is 27011.08008203171ms
2022-09-21 21:12:02 INFO  Estimated optimisation runtime saving is 44740.99833087683ms
2022-09-21 21:12:02 INFO  ---RUNTIME: Multi-Query Optimization took 134.52649116516113 ms
2022-09-21 21:12:02 INFO  Executing generated plans
2022-09-21 21:12:31 INFO  ---RUNTIME: Execution took 29363.211631774902 ms
2022-09-21 21:12:31 INFO  Done!
2022-09-21 21:12:31 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-21 21:12:31 INFO  Running instrumented original pipeline...
2022-09-21 21:12:31 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-21 21:12:31 INFO  ---RUNTIME: Importing and monkey-patching took 6.762981414794922 ms
2022-09-21 21:12:45 INFO  ---RUNTIME: Original pipeline execution took 13502.68816947937 ms (excluding imports and monkey-patching)
2022-09-21 21:12:45 INFO  Starting execution of 1 what-if analyses...
2022-09-21 21:12:45 INFO  Start plan generation for analysis OperatorImpact...
2022-09-21 21:12:45 INFO  ---RUNTIME: Plan generation took 5.080699920654297 ms
2022-09-21 21:12:45 INFO  Estimated runtime of original DAG is 9940.920114517212ms
2022-09-21 21:12:45 WARNING Skipping Multi-Query Optimization (instead, only applying patches)
2022-09-21 21:12:45 INFO  Estimated unoptimised what-if runtime is 70603.30570965877ms
2022-09-21 21:12:45 INFO  ---RUNTIME: Multi-Query Optimization took 18.247127532958984 ms
2022-09-21 21:12:45 INFO  Executing generated plans
2022-09-21 21:14:03 INFO  ---RUNTIME: Execution took 78026.3671875 ms
2022-09-21 21:14:03 INFO  Done!
2022-09-21 21:14:03 INFO  # Finished -- repetition 3 of 7 
2022-09-21 21:14:03 INFO  # Optimization benchmark for operator_impact with args [['reviews', 'slow_loading', 'featurization_4', 'logistic_regression']] -- repetition 4 of 7
2022-09-21 21:14:03 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-21 21:14:03 INFO  Running instrumented original pipeline...
2022-09-21 21:14:03 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-21 21:14:03 INFO  ---RUNTIME: Importing and monkey-patching took 6.272792816162109 ms
2022-09-21 21:14:16 INFO  ---RUNTIME: Original pipeline execution took 13153.321504592896 ms (excluding imports and monkey-patching)
2022-09-21 21:14:16 INFO  Starting execution of 1 what-if analyses...
2022-09-21 21:14:16 INFO  Start plan generation for analysis OperatorImpact...
2022-09-21 21:14:16 INFO  ---RUNTIME: Plan generation took 5.1670074462890625 ms
2022-09-21 21:14:16 INFO  Estimated runtime of original DAG is 9605.241298675537ms
2022-09-21 21:14:16 INFO  Performing Multi-Query Optimization
2022-09-21 21:14:16 INFO  Estimated unoptimized what-if runtime is 68342.64808233209ms
2022-09-21 21:14:16 INFO  Estimated optimised what-if runtime is 25499.727685075533ms
2022-09-21 21:14:16 INFO  Estimated optimisation runtime saving is 42842.92039725656ms
2022-09-21 21:14:16 INFO  ---RUNTIME: Multi-Query Optimization took 134.24301147460938 ms
2022-09-21 21:14:16 INFO  Executing generated plans
2022-09-21 21:14:45 INFO  ---RUNTIME: Execution took 29156.28409385681 ms
2022-09-21 21:14:45 INFO  Done!
2022-09-21 21:14:45 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-21 21:14:45 INFO  Running instrumented original pipeline...
2022-09-21 21:14:46 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-21 21:14:46 INFO  ---RUNTIME: Importing and monkey-patching took 6.383419036865234 ms
2022-09-21 21:14:59 INFO  ---RUNTIME: Original pipeline execution took 13496.31381034851 ms (excluding imports and monkey-patching)
2022-09-21 21:14:59 INFO  Starting execution of 1 what-if analyses...
2022-09-21 21:14:59 INFO  Start plan generation for analysis OperatorImpact...
2022-09-21 21:14:59 INFO  ---RUNTIME: Plan generation took 5.4950714111328125 ms
2022-09-21 21:14:59 INFO  Estimated runtime of original DAG is 10146.032810211182ms
2022-09-21 21:14:59 WARNING Skipping Multi-Query Optimization (instead, only applying patches)
2022-09-21 21:14:59 INFO  Estimated unoptimised what-if runtime is 72068.34646105519ms
2022-09-21 21:14:59 INFO  ---RUNTIME: Multi-Query Optimization took 19.18625831604004 ms
2022-09-21 21:14:59 INFO  Executing generated plans
2022-09-21 21:16:18 INFO  ---RUNTIME: Execution took 78573.33016395569 ms
2022-09-21 21:16:18 INFO  Done!
2022-09-21 21:16:18 INFO  # Finished -- repetition 4 of 7 
2022-09-21 21:16:18 INFO  # Optimization benchmark for operator_impact with args [['reviews', 'slow_loading', 'featurization_4', 'logistic_regression']] -- repetition 5 of 7
2022-09-21 21:16:18 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-21 21:16:18 INFO  Running instrumented original pipeline...
2022-09-21 21:16:18 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-21 21:16:18 INFO  ---RUNTIME: Importing and monkey-patching took 6.330966949462891 ms
2022-09-21 21:16:31 INFO  ---RUNTIME: Original pipeline execution took 13754.658222198486 ms (excluding imports and monkey-patching)
2022-09-21 21:16:31 INFO  Starting execution of 1 what-if analyses...
2022-09-21 21:16:31 INFO  Start plan generation for analysis OperatorImpact...
2022-09-21 21:16:31 INFO  ---RUNTIME: Plan generation took 5.124568939208984 ms
2022-09-21 21:16:31 INFO  Estimated runtime of original DAG is 10101.557970046997ms
2022-09-21 21:16:31 INFO  Performing Multi-Query Optimization
2022-09-21 21:16:32 INFO  Estimated unoptimized what-if runtime is 71895.87372848701ms
2022-09-21 21:16:32 INFO  Estimated optimised what-if runtime is 26937.6618346708ms
2022-09-21 21:16:32 INFO  Estimated optimisation runtime saving is 44958.21189381622ms
2022-09-21 21:16:32 INFO  ---RUNTIME: Multi-Query Optimization took 133.6362361907959 ms
2022-09-21 21:16:32 INFO  Executing generated plans
2022-09-21 21:17:01 INFO  ---RUNTIME: Execution took 29279.81972694397 ms
2022-09-21 21:17:01 INFO  Done!
2022-09-21 21:17:01 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-21 21:17:01 INFO  Running instrumented original pipeline...
2022-09-21 21:17:01 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-21 21:17:01 INFO  ---RUNTIME: Importing and monkey-patching took 6.972074508666992 ms
2022-09-21 21:17:14 INFO  ---RUNTIME: Original pipeline execution took 13275.286674499512 ms (excluding imports and monkey-patching)
2022-09-21 21:17:14 INFO  Starting execution of 1 what-if analyses...
2022-09-21 21:17:14 INFO  Start plan generation for analysis OperatorImpact...
2022-09-21 21:17:14 INFO  ---RUNTIME: Plan generation took 5.289554595947266 ms
2022-09-21 21:17:14 INFO  Estimated runtime of original DAG is 9957.624435424805ms
2022-09-21 21:17:14 WARNING Skipping Multi-Query Optimization (instead, only applying patches)
2022-09-21 21:17:14 INFO  Estimated unoptimised what-if runtime is 70671.56504823582ms
2022-09-21 21:17:14 INFO  ---RUNTIME: Multi-Query Optimization took 18.378496170043945 ms
2022-09-21 21:17:14 INFO  Executing generated plans
2022-09-21 21:18:33 INFO  ---RUNTIME: Execution took 78689.75973129272 ms
2022-09-21 21:18:33 INFO  Done!
2022-09-21 21:18:33 INFO  # Finished -- repetition 5 of 7 
2022-09-21 21:18:33 INFO  # Optimization benchmark for operator_impact with args [['reviews', 'slow_loading', 'featurization_4', 'logistic_regression']] -- repetition 6 of 7
2022-09-21 21:18:33 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-21 21:18:33 INFO  Running instrumented original pipeline...
2022-09-21 21:18:33 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-21 21:18:33 INFO  ---RUNTIME: Importing and monkey-patching took 7.329463958740234 ms
2022-09-21 21:18:46 INFO  ---RUNTIME: Original pipeline execution took 13379.557132720947 ms (excluding imports and monkey-patching)
2022-09-21 21:18:46 INFO  Starting execution of 1 what-if analyses...
2022-09-21 21:18:46 INFO  Start plan generation for analysis OperatorImpact...
2022-09-21 21:18:46 INFO  ---RUNTIME: Plan generation took 5.311012268066406 ms
2022-09-21 21:18:46 INFO  Estimated runtime of original DAG is 10054.43549156189ms
2022-09-21 21:18:46 INFO  Performing Multi-Query Optimization
2022-09-21 21:18:46 INFO  Estimated unoptimized what-if runtime is 71546.36902178616ms
2022-09-21 21:18:46 INFO  Estimated optimised what-if runtime is 26524.644787266894ms
2022-09-21 21:18:46 INFO  Estimated optimisation runtime saving is 45021.724234519264ms
2022-09-21 21:18:46 INFO  ---RUNTIME: Multi-Query Optimization took 132.48038291931152 ms
2022-09-21 21:18:46 INFO  Executing generated plans
2022-09-21 21:19:16 INFO  ---RUNTIME: Execution took 29241.68848991394 ms
2022-09-21 21:19:16 INFO  Done!
2022-09-21 21:19:16 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-21 21:19:16 INFO  Running instrumented original pipeline...
2022-09-21 21:19:16 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-21 21:19:16 INFO  ---RUNTIME: Importing and monkey-patching took 6.51097297668457 ms
2022-09-21 21:19:29 INFO  ---RUNTIME: Original pipeline execution took 13231.607437133789 ms (excluding imports and monkey-patching)
2022-09-21 21:19:29 INFO  Starting execution of 1 what-if analyses...
2022-09-21 21:19:29 INFO  Start plan generation for analysis OperatorImpact...
2022-09-21 21:19:29 INFO  ---RUNTIME: Plan generation took 5.22160530090332 ms
2022-09-21 21:19:29 INFO  Estimated runtime of original DAG is 9709.429025650024ms
2022-09-21 21:19:29 WARNING Skipping Multi-Query Optimization (instead, only applying patches)
2022-09-21 21:19:29 INFO  Estimated unoptimised what-if runtime is 68960.56960922225ms
2022-09-21 21:19:29 INFO  ---RUNTIME: Multi-Query Optimization took 18.616914749145508 ms
2022-09-21 21:19:29 INFO  Executing generated plans
2022-09-21 21:20:47 INFO  ---RUNTIME: Execution took 78558.80737304688 ms
2022-09-21 21:20:47 INFO  Done!
2022-09-21 21:20:47 INFO  # Finished -- repetition 6 of 7 
2022-09-21 21:20:47 INFO  # Optimization benchmark for operator_impact with args [['reviews', 'slow_loading', 'featurization_4', 'logistic_regression']] -- repetition 7 of 7
2022-09-21 21:20:47 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-21 21:20:47 INFO  Running instrumented original pipeline...
2022-09-21 21:20:47 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-21 21:20:47 INFO  ---RUNTIME: Importing and monkey-patching took 6.384611129760742 ms
2022-09-21 21:21:01 INFO  ---RUNTIME: Original pipeline execution took 13459.104299545288 ms (excluding imports and monkey-patching)
2022-09-21 21:21:01 INFO  Starting execution of 1 what-if analyses...
2022-09-21 21:21:01 INFO  Start plan generation for analysis OperatorImpact...
2022-09-21 21:21:01 INFO  ---RUNTIME: Plan generation took 5.101919174194336 ms
2022-09-21 21:21:01 INFO  Estimated runtime of original DAG is 9839.783430099487ms
2022-09-21 21:21:01 INFO  Performing Multi-Query Optimization
2022-09-21 21:21:01 INFO  Estimated unoptimized what-if runtime is 70013.58293788963ms
2022-09-21 21:21:01 INFO  Estimated optimised what-if runtime is 26077.308962801755ms
2022-09-21 21:21:01 INFO  Estimated optimisation runtime saving is 43936.273975087875ms
2022-09-21 21:21:01 INFO  ---RUNTIME: Multi-Query Optimization took 134.83285903930664 ms
2022-09-21 21:21:01 INFO  Executing generated plans
2022-09-21 21:21:31 INFO  ---RUNTIME: Execution took 29501.452445983887 ms
2022-09-21 21:21:31 INFO  Done!
2022-09-21 21:21:31 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-21 21:21:31 INFO  Running instrumented original pipeline...
2022-09-21 21:21:31 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-21 21:21:31 INFO  ---RUNTIME: Importing and monkey-patching took 6.401538848876953 ms
2022-09-21 21:21:44 INFO  ---RUNTIME: Original pipeline execution took 13361.177444458008 ms (excluding imports and monkey-patching)
2022-09-21 21:21:44 INFO  Starting execution of 1 what-if analyses...
2022-09-21 21:21:44 INFO  Start plan generation for analysis OperatorImpact...
2022-09-21 21:21:44 INFO  ---RUNTIME: Plan generation took 15.388250350952148 ms
2022-09-21 21:21:44 INFO  Estimated runtime of original DAG is 9756.901025772095ms
2022-09-21 21:21:44 WARNING Skipping Multi-Query Optimization (instead, only applying patches)
2022-09-21 21:21:44 INFO  Estimated unoptimised what-if runtime is 69302.7067500201ms
2022-09-21 21:21:44 INFO  ---RUNTIME: Multi-Query Optimization took 28.90157699584961 ms
2022-09-21 21:21:44 INFO  Executing generated plans
2022-09-21 21:23:03 INFO  ---RUNTIME: Execution took 78992.595911026 ms
2022-09-21 21:23:03 INFO  Done!
2022-09-21 21:23:03 INFO  # Finished -- repetition 7 of 7 
2022-09-21 21:23:03 INFO  # Final results after all repetitions
2022-09-21 21:23:03 INFO     repetition  ... no_opt_what_if_execution_combined_model_training
0           0  ...                                      1628.430605
1           1  ...                                      1603.667498
2           2  ...                                      1703.321695
3           3  ...                                      1768.717051
4           4  ...                                      1661.348581
5           5  ...                                      1825.798035
6           6  ...                                      1945.786953

[7 rows x 26 columns]
taskset -c 160-167 PROTOCOL_BUFFERS_PYTHON_IMPLEMENTATION=python python3.9 benchmarks_end_to_end.py operator_impact reviews slow_loading featurization_4 xgboost
2022-09-21 21:23:06.347711: W tensorflow/stream_executor/platform/default/dso_loader.cc:64] Could not load dynamic library 'libcudart.so.11.0'; dlerror: libcudart.so.11.0: cannot open shared object file: No such file or directory; LD_LIBRARY_PATH: /home/sgrafbe/mlwhatif/venv/lib/python3.9/site-packages/cv2/../../lib64:
2022-09-21 21:23:06.347755: I tensorflow/stream_executor/cuda/cudart_stub.cc:29] Ignore above cudart dlerror if you do not have a GPU set up on your machine.
2022-09-21 21:23:07 INFO  Patching sys.argv with ['mlwhatif', 'reviews', 'slow_loading', 'featurization_4', 'xgboost']
2022-09-21 21:23:07 INFO  Running instrumented original pipeline...
2022-09-21 21:23:07 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-21 21:23:07 INFO  ---RUNTIME: Importing and monkey-patching took 97.0463752746582 ms
2022-09-21 21:23:24 INFO  ---RUNTIME: Original pipeline execution took 17292.113304138184 ms (excluding imports and monkey-patching)
2022-09-21 21:23:24 INFO  Starting execution of 0 what-if analyses...
2022-09-21 21:23:24 INFO  Estimated runtime of original DAG is 13949.506998062134ms
2022-09-21 21:23:24 INFO  Performing Multi-Query Optimization
2022-09-21 21:23:24 INFO  Estimated unoptimized what-if runtime is 0ms
2022-09-21 21:23:24 INFO  Estimated optimised what-if runtime is 0ms
2022-09-21 21:23:24 INFO  Estimated optimisation runtime saving is 0ms
2022-09-21 21:23:24 INFO  ---RUNTIME: Multi-Query Optimization took 0.6556510925292969 ms
2022-09-21 21:23:24 INFO  Executing generated plans
2022-09-21 21:23:24 INFO  ---RUNTIME: Execution took 0.025033950805664062 ms
2022-09-21 21:23:24 INFO  Done!
2022-09-21 21:23:24 INFO  # Optimization benchmark for operator_impact with args [['reviews', 'slow_loading', 'featurization_4', 'xgboost']] -- repetition 1 of 7
2022-09-21 21:23:24 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-21 21:23:24 INFO  Running instrumented original pipeline...
2022-09-21 21:23:25 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-21 21:23:25 INFO  ---RUNTIME: Importing and monkey-patching took 5.802154541015625 ms
2022-09-21 21:23:42 INFO  ---RUNTIME: Original pipeline execution took 17744.10891532898 ms (excluding imports and monkey-patching)
2022-09-21 21:23:42 INFO  Starting execution of 1 what-if analyses...
2022-09-21 21:23:42 INFO  Start plan generation for analysis OperatorImpact...
2022-09-21 21:23:42 INFO  ---RUNTIME: Plan generation took 5.993843078613281 ms
2022-09-21 21:23:42 INFO  Estimated runtime of original DAG is 14400.186777114868ms
2022-09-21 21:23:42 INFO  Performing Multi-Query Optimization
2022-09-21 21:23:42 INFO  Estimated unoptimized what-if runtime is 102576.0060588462ms
2022-09-21 21:23:42 INFO  Estimated optimised what-if runtime is 58352.409109020875ms
2022-09-21 21:23:42 INFO  Estimated optimisation runtime saving is 44223.59694982532ms
2022-09-21 21:23:42 INFO  ---RUNTIME: Multi-Query Optimization took 135.054349899292 ms
2022-09-21 21:23:42 INFO  Executing generated plans
2022-09-21 21:24:41 INFO  ---RUNTIME: Execution took 58775.64024925232 ms
2022-09-21 21:24:41 INFO  Done!
2022-09-21 21:24:41 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-21 21:24:41 INFO  Running instrumented original pipeline...
2022-09-21 21:24:41 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-21 21:24:41 INFO  ---RUNTIME: Importing and monkey-patching took 6.442070007324219 ms
2022-09-21 21:24:59 INFO  ---RUNTIME: Original pipeline execution took 17480.48973083496 ms (excluding imports and monkey-patching)
2022-09-21 21:24:59 INFO  Starting execution of 1 what-if analyses...
2022-09-21 21:24:59 INFO  Start plan generation for analysis OperatorImpact...
2022-09-21 21:24:59 INFO  ---RUNTIME: Plan generation took 5.545854568481445 ms
2022-09-21 21:24:59 INFO  Estimated runtime of original DAG is 13836.72285079956ms
2022-09-21 21:24:59 WARNING Skipping Multi-Query Optimization (instead, only applying patches)
2022-09-21 21:24:59 INFO  Estimated unoptimised what-if runtime is 98389.95339959237ms
2022-09-21 21:24:59 INFO  ---RUNTIME: Multi-Query Optimization took 18.439054489135742 ms
2022-09-21 21:24:59 INFO  Executing generated plans
2022-09-21 21:26:46 INFO  ---RUNTIME: Execution took 107083.06789398193 ms
2022-09-21 21:26:46 INFO  Done!
2022-09-21 21:26:46 INFO  # Finished -- repetition 1 of 7 
2022-09-21 21:26:46 INFO  # Optimization benchmark for operator_impact with args [['reviews', 'slow_loading', 'featurization_4', 'xgboost']] -- repetition 2 of 7
2022-09-21 21:26:46 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-21 21:26:46 INFO  Running instrumented original pipeline...
2022-09-21 21:26:46 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-21 21:26:46 INFO  ---RUNTIME: Importing and monkey-patching took 5.913496017456055 ms
2022-09-21 21:27:03 INFO  ---RUNTIME: Original pipeline execution took 17387.727737426758 ms (excluding imports and monkey-patching)
2022-09-21 21:27:03 INFO  Starting execution of 1 what-if analyses...
2022-09-21 21:27:03 INFO  Start plan generation for analysis OperatorImpact...
2022-09-21 21:27:03 INFO  ---RUNTIME: Plan generation took 5.369663238525391 ms
2022-09-21 21:27:03 INFO  Estimated runtime of original DAG is 14007.814168930054ms
2022-09-21 21:27:03 INFO  Performing Multi-Query Optimization
2022-09-21 21:27:03 INFO  Estimated unoptimized what-if runtime is 99783.28927854828ms
2022-09-21 21:27:03 INFO  Estimated optimised what-if runtime is 55640.685358291885ms
2022-09-21 21:27:03 INFO  Estimated optimisation runtime saving is 44142.6039202564ms
2022-09-21 21:27:03 INFO  ---RUNTIME: Multi-Query Optimization took 132.39383697509766 ms
2022-09-21 21:27:03 INFO  Executing generated plans
2022-09-21 21:28:03 INFO  ---RUNTIME: Execution took 59337.63313293457 ms
2022-09-21 21:28:03 INFO  Done!
2022-09-21 21:28:03 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-21 21:28:03 INFO  Running instrumented original pipeline...
2022-09-21 21:28:03 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-21 21:28:03 INFO  ---RUNTIME: Importing and monkey-patching took 6.3076019287109375 ms
2022-09-21 21:28:21 INFO  ---RUNTIME: Original pipeline execution took 17929.79598045349 ms (excluding imports and monkey-patching)
2022-09-21 21:28:21 INFO  Starting execution of 1 what-if analyses...
2022-09-21 21:28:21 INFO  Start plan generation for analysis OperatorImpact...
2022-09-21 21:28:21 INFO  ---RUNTIME: Plan generation took 5.217313766479492 ms
2022-09-21 21:28:21 INFO  Estimated runtime of original DAG is 14240.500926971436ms
2022-09-21 21:28:21 WARNING Skipping Multi-Query Optimization (instead, only applying patches)
2022-09-21 21:28:21 INFO  Estimated unoptimised what-if runtime is 101291.86283195158ms
2022-09-21 21:28:21 INFO  ---RUNTIME: Multi-Query Optimization took 18.24188232421875 ms
2022-09-21 21:28:21 INFO  Executing generated plans
2022-09-21 21:30:09 INFO  ---RUNTIME: Execution took 108087.28313446045 ms
2022-09-21 21:30:09 INFO  Done!
2022-09-21 21:30:09 INFO  # Finished -- repetition 2 of 7 
2022-09-21 21:30:09 INFO  # Optimization benchmark for operator_impact with args [['reviews', 'slow_loading', 'featurization_4', 'xgboost']] -- repetition 3 of 7
2022-09-21 21:30:09 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-21 21:30:09 INFO  Running instrumented original pipeline...
2022-09-21 21:30:09 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-21 21:30:09 INFO  ---RUNTIME: Importing and monkey-patching took 6.657123565673828 ms
2022-09-21 21:30:26 INFO  ---RUNTIME: Original pipeline execution took 17287.710666656494 ms (excluding imports and monkey-patching)
2022-09-21 21:30:26 INFO  Starting execution of 1 what-if analyses...
2022-09-21 21:30:26 INFO  Start plan generation for analysis OperatorImpact...
2022-09-21 21:30:26 INFO  ---RUNTIME: Plan generation took 5.31768798828125 ms
2022-09-21 21:30:26 INFO  Estimated runtime of original DAG is 13811.66672706604ms
2022-09-21 21:30:26 INFO  Performing Multi-Query Optimization
2022-09-21 21:30:26 INFO  Estimated unoptimized what-if runtime is 98405.22623829432ms
2022-09-21 21:30:26 INFO  Estimated optimised what-if runtime is 52860.05578828763ms
2022-09-21 21:30:26 INFO  Estimated optimisation runtime saving is 45545.170450006684ms
2022-09-21 21:30:26 INFO  ---RUNTIME: Multi-Query Optimization took 132.05218315124512 ms
2022-09-21 21:30:26 INFO  Executing generated plans
2022-09-21 21:31:25 INFO  ---RUNTIME: Execution took 58390.82050323486 ms
2022-09-21 21:31:25 INFO  Done!
2022-09-21 21:31:25 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-21 21:31:25 INFO  Running instrumented original pipeline...
2022-09-21 21:31:25 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-21 21:31:25 INFO  ---RUNTIME: Importing and monkey-patching took 6.8492889404296875 ms
2022-09-21 21:31:43 INFO  ---RUNTIME: Original pipeline execution took 18072.415113449097 ms (excluding imports and monkey-patching)
2022-09-21 21:31:43 INFO  Starting execution of 1 what-if analyses...
2022-09-21 21:31:43 INFO  Start plan generation for analysis OperatorImpact...
2022-09-21 21:31:43 INFO  ---RUNTIME: Plan generation took 5.466699600219727 ms
2022-09-21 21:31:43 INFO  Estimated runtime of original DAG is 14401.601552963257ms
2022-09-21 21:31:43 WARNING Skipping Multi-Query Optimization (instead, only applying patches)
2022-09-21 21:31:43 INFO  Estimated unoptimised what-if runtime is 102392.2086301071ms
2022-09-21 21:31:43 INFO  ---RUNTIME: Multi-Query Optimization took 18.573284149169922 ms
2022-09-21 21:31:43 INFO  Executing generated plans
2022-09-21 21:33:30 INFO  ---RUNTIME: Execution took 106942.00587272644 ms
2022-09-21 21:33:30 INFO  Done!
2022-09-21 21:33:30 INFO  # Finished -- repetition 3 of 7 
2022-09-21 21:33:30 INFO  # Optimization benchmark for operator_impact with args [['reviews', 'slow_loading', 'featurization_4', 'xgboost']] -- repetition 4 of 7
2022-09-21 21:33:30 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-21 21:33:30 INFO  Running instrumented original pipeline...
2022-09-21 21:33:30 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-21 21:33:30 INFO  ---RUNTIME: Importing and monkey-patching took 6.4144134521484375 ms
2022-09-21 21:33:48 INFO  ---RUNTIME: Original pipeline execution took 18620.45931816101 ms (excluding imports and monkey-patching)
2022-09-21 21:33:48 INFO  Starting execution of 1 what-if analyses...
2022-09-21 21:33:48 INFO  Start plan generation for analysis OperatorImpact...
2022-09-21 21:33:48 INFO  ---RUNTIME: Plan generation took 5.170345306396484 ms
2022-09-21 21:33:48 INFO  Estimated runtime of original DAG is 14917.733907699585ms
2022-09-21 21:33:48 INFO  Performing Multi-Query Optimization
2022-09-21 21:33:48 INFO  Estimated unoptimized what-if runtime is 106222.83774142129ms
2022-09-21 21:33:48 INFO  Estimated optimised what-if runtime is 57484.178131555265ms
2022-09-21 21:33:48 INFO  Estimated optimisation runtime saving is 48738.65960986602ms
2022-09-21 21:33:48 INFO  ---RUNTIME: Multi-Query Optimization took 133.71849060058594 ms
2022-09-21 21:33:48 INFO  Executing generated plans
2022-09-21 21:34:47 INFO  ---RUNTIME: Execution took 58586.90333366394 ms
2022-09-21 21:34:47 INFO  Done!
2022-09-21 21:34:47 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-21 21:34:47 INFO  Running instrumented original pipeline...
2022-09-21 21:34:47 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-21 21:34:47 INFO  ---RUNTIME: Importing and monkey-patching took 7.113456726074219 ms
2022-09-21 21:35:05 INFO  ---RUNTIME: Original pipeline execution took 17943.819522857666 ms (excluding imports and monkey-patching)
2022-09-21 21:35:05 INFO  Starting execution of 1 what-if analyses...
2022-09-21 21:35:05 INFO  Start plan generation for analysis OperatorImpact...
2022-09-21 21:35:05 INFO  ---RUNTIME: Plan generation took 5.109548568725586 ms
2022-09-21 21:35:05 INFO  Estimated runtime of original DAG is 14556.759595870972ms
2022-09-21 21:35:05 WARNING Skipping Multi-Query Optimization (instead, only applying patches)
2022-09-21 21:35:05 INFO  Estimated unoptimised what-if runtime is 103515.2652153798ms
2022-09-21 21:35:05 INFO  ---RUNTIME: Multi-Query Optimization took 18.420696258544922 ms
2022-09-21 21:35:05 INFO  Executing generated plans
2022-09-21 21:36:53 INFO  ---RUNTIME: Execution took 108351.27091407776 ms
2022-09-21 21:36:53 INFO  Done!
2022-09-21 21:36:53 INFO  # Finished -- repetition 4 of 7 
2022-09-21 21:36:53 INFO  # Optimization benchmark for operator_impact with args [['reviews', 'slow_loading', 'featurization_4', 'xgboost']] -- repetition 5 of 7
2022-09-21 21:36:53 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-21 21:36:53 INFO  Running instrumented original pipeline...
2022-09-21 21:36:53 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-21 21:36:53 INFO  ---RUNTIME: Importing and monkey-patching took 6.452083587646484 ms
2022-09-21 21:37:10 INFO  ---RUNTIME: Original pipeline execution took 17020.543336868286 ms (excluding imports and monkey-patching)
2022-09-21 21:37:10 INFO  Starting execution of 1 what-if analyses...
2022-09-21 21:37:10 INFO  Start plan generation for analysis OperatorImpact...
2022-09-21 21:37:10 INFO  ---RUNTIME: Plan generation took 5.167484283447266 ms
2022-09-21 21:37:10 INFO  Estimated runtime of original DAG is 13423.849821090698ms
2022-09-21 21:37:10 INFO  Performing Multi-Query Optimization
2022-09-21 21:37:10 INFO  Estimated unoptimized what-if runtime is 95615.44159652673ms
2022-09-21 21:37:10 INFO  Estimated optimised what-if runtime is 51443.79309262869ms
2022-09-21 21:37:10 INFO  Estimated optimisation runtime saving is 44171.64850389803ms
2022-09-21 21:37:10 INFO  ---RUNTIME: Multi-Query Optimization took 132.94219970703125 ms
2022-09-21 21:37:10 INFO  Executing generated plans
2022-09-21 21:38:08 INFO  ---RUNTIME: Execution took 57064.499378204346 ms
2022-09-21 21:38:08 INFO  Done!
2022-09-21 21:38:08 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-21 21:38:08 INFO  Running instrumented original pipeline...
2022-09-21 21:38:08 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-21 21:38:08 INFO  ---RUNTIME: Importing and monkey-patching took 6.593942642211914 ms
2022-09-21 21:38:24 INFO  ---RUNTIME: Original pipeline execution took 16877.981901168823 ms (excluding imports and monkey-patching)
2022-09-21 21:38:24 INFO  Starting execution of 1 what-if analyses...
2022-09-21 21:38:24 INFO  Start plan generation for analysis OperatorImpact...
2022-09-21 21:38:24 INFO  ---RUNTIME: Plan generation took 5.451202392578125 ms
2022-09-21 21:38:24 INFO  Estimated runtime of original DAG is 13553.152084350586ms
2022-09-21 21:38:24 WARNING Skipping Multi-Query Optimization (instead, only applying patches)
2022-09-21 21:38:24 INFO  Estimated unoptimised what-if runtime is 96406.22361248896ms
2022-09-21 21:38:24 INFO  ---RUNTIME: Multi-Query Optimization took 18.24021339416504 ms
2022-09-21 21:38:24 INFO  Executing generated plans
2022-09-21 21:40:10 INFO  ---RUNTIME: Execution took 105728.93118858337 ms
2022-09-21 21:40:10 INFO  Done!
2022-09-21 21:40:10 INFO  # Finished -- repetition 5 of 7 
2022-09-21 21:40:10 INFO  # Optimization benchmark for operator_impact with args [['reviews', 'slow_loading', 'featurization_4', 'xgboost']] -- repetition 6 of 7
2022-09-21 21:40:10 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-21 21:40:10 INFO  Running instrumented original pipeline...
2022-09-21 21:40:10 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-21 21:40:10 INFO  ---RUNTIME: Importing and monkey-patching took 6.120204925537109 ms
2022-09-21 21:40:28 INFO  ---RUNTIME: Original pipeline execution took 17410.37130355835 ms (excluding imports and monkey-patching)
2022-09-21 21:40:28 INFO  Starting execution of 1 what-if analyses...
2022-09-21 21:40:28 INFO  Start plan generation for analysis OperatorImpact...
2022-09-21 21:40:28 INFO  ---RUNTIME: Plan generation took 5.401372909545898 ms
2022-09-21 21:40:28 INFO  Estimated runtime of original DAG is 14076.737403869629ms
2022-09-21 21:40:28 INFO  Performing Multi-Query Optimization
2022-09-21 21:40:28 INFO  Estimated unoptimized what-if runtime is 100258.05842011378ms
2022-09-21 21:40:28 INFO  Estimated optimised what-if runtime is 55463.186704271946ms
2022-09-21 21:40:28 INFO  Estimated optimisation runtime saving is 44794.87171584184ms
2022-09-21 21:40:28 INFO  ---RUNTIME: Multi-Query Optimization took 143.99051666259766 ms
2022-09-21 21:40:28 INFO  Executing generated plans
2022-09-21 21:41:27 INFO  ---RUNTIME: Execution took 59274.25289154053 ms
2022-09-21 21:41:27 INFO  Done!
2022-09-21 21:41:27 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-21 21:41:27 INFO  Running instrumented original pipeline...
2022-09-21 21:41:27 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-21 21:41:27 INFO  ---RUNTIME: Importing and monkey-patching took 6.783723831176758 ms
2022-09-21 21:41:45 INFO  ---RUNTIME: Original pipeline execution took 18055.10139465332 ms (excluding imports and monkey-patching)
2022-09-21 21:41:45 INFO  Starting execution of 1 what-if analyses...
2022-09-21 21:41:45 INFO  Start plan generation for analysis OperatorImpact...
2022-09-21 21:41:45 INFO  ---RUNTIME: Plan generation took 5.286455154418945 ms
2022-09-21 21:41:45 INFO  Estimated runtime of original DAG is 14351.44591331482ms
2022-09-21 21:41:45 WARNING Skipping Multi-Query Optimization (instead, only applying patches)
2022-09-21 21:41:45 INFO  Estimated unoptimised what-if runtime is 102108.51934891718ms
2022-09-21 21:41:45 INFO  ---RUNTIME: Multi-Query Optimization took 18.35465431213379 ms
2022-09-21 21:41:45 INFO  Executing generated plans
2022-09-21 21:43:33 INFO  ---RUNTIME: Execution took 107374.17793273926 ms
2022-09-21 21:43:33 INFO  Done!
2022-09-21 21:43:33 INFO  # Finished -- repetition 6 of 7 
2022-09-21 21:43:33 INFO  # Optimization benchmark for operator_impact with args [['reviews', 'slow_loading', 'featurization_4', 'xgboost']] -- repetition 7 of 7
2022-09-21 21:43:33 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-21 21:43:33 INFO  Running instrumented original pipeline...
2022-09-21 21:43:33 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-21 21:43:33 INFO  ---RUNTIME: Importing and monkey-patching took 6.494998931884766 ms
2022-09-21 21:43:50 INFO  ---RUNTIME: Original pipeline execution took 17496.62160873413 ms (excluding imports and monkey-patching)
2022-09-21 21:43:50 INFO  Starting execution of 1 what-if analyses...
2022-09-21 21:43:50 INFO  Start plan generation for analysis OperatorImpact...
2022-09-21 21:43:50 INFO  ---RUNTIME: Plan generation took 5.209207534790039 ms
2022-09-21 21:43:50 INFO  Estimated runtime of original DAG is 13790.945291519165ms
2022-09-21 21:43:50 INFO  Performing Multi-Query Optimization
2022-09-21 21:43:50 INFO  Estimated unoptimized what-if runtime is 98234.4862813734ms
2022-09-21 21:43:50 INFO  Estimated optimised what-if runtime is 53808.57648837905ms
2022-09-21 21:43:50 INFO  Estimated optimisation runtime saving is 44425.90979299436ms
2022-09-21 21:43:50 INFO  ---RUNTIME: Multi-Query Optimization took 133.6805820465088 ms
2022-09-21 21:43:50 INFO  Executing generated plans
2022-09-21 21:44:44 INFO  ---RUNTIME: Execution took 54044.00110244751 ms
2022-09-21 21:44:44 INFO  Done!
2022-09-21 21:44:44 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-21 21:44:44 INFO  Running instrumented original pipeline...
2022-09-21 21:44:44 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-21 21:44:44 INFO  ---RUNTIME: Importing and monkey-patching took 6.599903106689453 ms
2022-09-21 21:45:01 INFO  ---RUNTIME: Original pipeline execution took 16943.770170211792 ms (excluding imports and monkey-patching)
2022-09-21 21:45:01 INFO  Starting execution of 1 what-if analyses...
2022-09-21 21:45:01 INFO  Start plan generation for analysis OperatorImpact...
2022-09-21 21:45:01 INFO  ---RUNTIME: Plan generation took 5.350828170776367 ms
2022-09-21 21:45:01 INFO  Estimated runtime of original DAG is 13281.461000442505ms
2022-09-21 21:45:01 WARNING Skipping Multi-Query Optimization (instead, only applying patches)
2022-09-21 21:45:01 INFO  Estimated unoptimised what-if runtime is 94475.33086110157ms
2022-09-21 21:45:01 INFO  ---RUNTIME: Multi-Query Optimization took 18.565893173217773 ms
2022-09-21 21:45:01 INFO  Executing generated plans
2022-09-21 21:46:44 INFO  ---RUNTIME: Execution took 102718.27006340027 ms
2022-09-21 21:46:44 INFO  Done!
2022-09-21 21:46:44 INFO  # Finished -- repetition 7 of 7 
2022-09-21 21:46:44 INFO  # Final results after all repetitions
2022-09-21 21:46:44 INFO     repetition  ... no_opt_what_if_execution_combined_model_training
0           0  ...                                     29823.107958
1           1  ...                                     30424.797535
2           2  ...                                     30068.324804
3           3  ...                                     31017.939806
4           4  ...                                     27820.596933
5           5  ...                                     30524.573326
6           6  ...                                     26117.191553

[7 rows x 26 columns]
taskset -c 160-167 PROTOCOL_BUFFERS_PYTHON_IMPLEMENTATION=python python3.9 benchmarks_end_to_end.py operator_impact reviews slow_loading featurization_4 neural_network
2022-09-21 21:46:46.871707: W tensorflow/stream_executor/platform/default/dso_loader.cc:64] Could not load dynamic library 'libcudart.so.11.0'; dlerror: libcudart.so.11.0: cannot open shared object file: No such file or directory; LD_LIBRARY_PATH: /home/sgrafbe/mlwhatif/venv/lib/python3.9/site-packages/cv2/../../lib64:
2022-09-21 21:46:46.871751: I tensorflow/stream_executor/cuda/cudart_stub.cc:29] Ignore above cudart dlerror if you do not have a GPU set up on your machine.
2022-09-21 21:46:48 INFO  Patching sys.argv with ['mlwhatif', 'reviews', 'slow_loading', 'featurization_4', 'neural_network']
2022-09-21 21:46:48 INFO  Running instrumented original pipeline...
2022-09-21 21:46:48 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-21 21:46:48 INFO  ---RUNTIME: Importing and monkey-patching took 96.83895111083984 ms
2022-09-21 21:47:01.025292: W tensorflow/stream_executor/platform/default/dso_loader.cc:64] Could not load dynamic library 'libcuda.so.1'; dlerror: libcuda.so.1: cannot open shared object file: No such file or directory; LD_LIBRARY_PATH: /home/sgrafbe/mlwhatif/venv/lib/python3.9/site-packages/cv2/../../lib64:
2022-09-21 21:47:01.025332: W tensorflow/stream_executor/cuda/cuda_driver.cc:326] failed call to cuInit: UNKNOWN ERROR (303)
2022-09-21 21:47:01.025360: I tensorflow/stream_executor/cuda/cuda_diagnostics.cc:156] kernel driver does not appear to be running on this host (wagyu): /proc/driver/nvidia/version does not exist
2022-09-21 21:47:01.025994: I tensorflow/core/platform/cpu_feature_guard.cc:142] This TensorFlow binary is optimized with oneAPI Deep Neural Network Library (oneDNN) to use the following CPU instructions in performance-critical operations:  AVX2 FMA
To enable them in other operations, rebuild TensorFlow with the appropriate compiler flags.
2022-09-21 21:47:01.101477: I tensorflow/compiler/mlir/mlir_graph_optimization_pass.cc:176] None of the MLIR Optimization Passes are enabled (registered 2)
2022-09-21 21:47:01.113381: I tensorflow/core/platform/profile_utils/cpu_utils.cc:114] CPU Frequency: 2595290000 Hz
2022-09-21 21:47:05 INFO  ---RUNTIME: Original pipeline execution took 17066.844701766968 ms (excluding imports and monkey-patching)
2022-09-21 21:47:05 INFO  Starting execution of 0 what-if analyses...
2022-09-21 21:47:05 INFO  Estimated runtime of original DAG is 13762.773513793945ms
2022-09-21 21:47:05 INFO  Performing Multi-Query Optimization
2022-09-21 21:47:05 INFO  Estimated unoptimized what-if runtime is 0ms
2022-09-21 21:47:05 INFO  Estimated optimised what-if runtime is 0ms
2022-09-21 21:47:05 INFO  Estimated optimisation runtime saving is 0ms
2022-09-21 21:47:05 INFO  ---RUNTIME: Multi-Query Optimization took 0.4894733428955078 ms
2022-09-21 21:47:05 INFO  Executing generated plans
2022-09-21 21:47:05 INFO  ---RUNTIME: Execution took 0.014781951904296875 ms
2022-09-21 21:47:05 INFO  Done!
2022-09-21 21:47:05 INFO  # Optimization benchmark for operator_impact with args [['reviews', 'slow_loading', 'featurization_4', 'neural_network']] -- repetition 1 of 7
2022-09-21 21:47:05 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-21 21:47:05 INFO  Running instrumented original pipeline...
2022-09-21 21:47:05 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-21 21:47:05 INFO  ---RUNTIME: Importing and monkey-patching took 5.458593368530273 ms
2022-09-21 21:47:22 INFO  ---RUNTIME: Original pipeline execution took 16777.268648147583 ms (excluding imports and monkey-patching)
2022-09-21 21:47:22 INFO  Starting execution of 1 what-if analyses...
2022-09-21 21:47:22 INFO  Start plan generation for analysis OperatorImpact...
2022-09-21 21:47:22 INFO  ---RUNTIME: Plan generation took 5.506277084350586 ms
2022-09-21 21:47:22 INFO  Estimated runtime of original DAG is 13306.780815124512ms
2022-09-21 21:47:22 INFO  Performing Multi-Query Optimization
2022-09-21 21:47:22 INFO  Estimated unoptimized what-if runtime is 94782.58839617866ms
2022-09-21 21:47:22 INFO  Estimated optimised what-if runtime is 51094.72238423585ms
2022-09-21 21:47:22 INFO  Estimated optimisation runtime saving is 43687.86601194281ms
2022-09-21 21:47:22 INFO  ---RUNTIME: Multi-Query Optimization took 132.74407386779785 ms
2022-09-21 21:47:22 INFO  Executing generated plans
2022-09-21 21:48:16 INFO  ---RUNTIME: Execution took 54355.119466781616 ms
2022-09-21 21:48:16 INFO  Done!
2022-09-21 21:48:16 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-21 21:48:16 INFO  Running instrumented original pipeline...
2022-09-21 21:48:17 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-21 21:48:17 INFO  ---RUNTIME: Importing and monkey-patching took 6.175756454467773 ms
2022-09-21 21:48:33 INFO  ---RUNTIME: Original pipeline execution took 16983.816623687744 ms (excluding imports and monkey-patching)
2022-09-21 21:48:33 INFO  Starting execution of 1 what-if analyses...
2022-09-21 21:48:33 INFO  Start plan generation for analysis OperatorImpact...
2022-09-21 21:48:33 INFO  ---RUNTIME: Plan generation took 5.0716400146484375 ms
2022-09-21 21:48:33 INFO  Estimated runtime of original DAG is 13391.952753067017ms
2022-09-21 21:48:33 WARNING Skipping Multi-Query Optimization (instead, only applying patches)
2022-09-21 21:48:33 INFO  Estimated unoptimised what-if runtime is 95255.59208510365ms
2022-09-21 21:48:33 INFO  ---RUNTIME: Multi-Query Optimization took 18.33486557006836 ms
2022-09-21 21:48:33 INFO  Executing generated plans
2022-09-21 21:50:16 INFO  ---RUNTIME: Execution took 102780.60793876648 ms
2022-09-21 21:50:16 INFO  Done!
2022-09-21 21:50:16 INFO  # Finished -- repetition 1 of 7 
2022-09-21 21:50:16 INFO  # Optimization benchmark for operator_impact with args [['reviews', 'slow_loading', 'featurization_4', 'neural_network']] -- repetition 2 of 7
2022-09-21 21:50:16 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-21 21:50:16 INFO  Running instrumented original pipeline...
2022-09-21 21:50:16 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-21 21:50:16 INFO  ---RUNTIME: Importing and monkey-patching took 6.039619445800781 ms
2022-09-21 21:50:33 INFO  ---RUNTIME: Original pipeline execution took 16677.584886550903 ms (excluding imports and monkey-patching)
2022-09-21 21:50:33 INFO  Starting execution of 1 what-if analyses...
2022-09-21 21:50:33 INFO  Start plan generation for analysis OperatorImpact...
2022-09-21 21:50:33 INFO  ---RUNTIME: Plan generation took 5.09953498840332 ms
2022-09-21 21:50:33 INFO  Estimated runtime of original DAG is 13140.802145004272ms
2022-09-21 21:50:33 INFO  Performing Multi-Query Optimization
2022-09-21 21:50:33 INFO  Estimated unoptimized what-if runtime is 93615.77045737676ms
2022-09-21 21:50:33 INFO  Estimated optimised what-if runtime is 50506.3725532546ms
2022-09-21 21:50:33 INFO  Estimated optimisation runtime saving is 43109.397904122154ms
2022-09-21 21:50:33 INFO  ---RUNTIME: Multi-Query Optimization took 131.2885284423828 ms
2022-09-21 21:50:33 INFO  Executing generated plans
2022-09-21 21:51:27 INFO  ---RUNTIME: Execution took 54461.08627319336 ms
2022-09-21 21:51:27 INFO  Done!
2022-09-21 21:51:27 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-21 21:51:27 INFO  Running instrumented original pipeline...
2022-09-21 21:51:27 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-21 21:51:27 INFO  ---RUNTIME: Importing and monkey-patching took 5.953550338745117 ms
2022-09-21 21:51:44 INFO  ---RUNTIME: Original pipeline execution took 16881.566762924194 ms (excluding imports and monkey-patching)
2022-09-21 21:51:44 INFO  Starting execution of 1 what-if analyses...
2022-09-21 21:51:44 INFO  Start plan generation for analysis OperatorImpact...
2022-09-21 21:51:44 INFO  ---RUNTIME: Plan generation took 5.069732666015625 ms
2022-09-21 21:51:44 INFO  Estimated runtime of original DAG is 13254.143953323364ms
2022-09-21 21:51:44 WARNING Skipping Multi-Query Optimization (instead, only applying patches)
2022-09-21 21:51:44 INFO  Estimated unoptimised what-if runtime is 94296.83216042955ms
2022-09-21 21:51:44 INFO  ---RUNTIME: Multi-Query Optimization took 18.247604370117188 ms
2022-09-21 21:51:44 INFO  Executing generated plans
2022-09-21 21:53:27 INFO  ---RUNTIME: Execution took 102416.69249534607 ms
2022-09-21 21:53:27 INFO  Done!
2022-09-21 21:53:27 INFO  # Finished -- repetition 2 of 7 
2022-09-21 21:53:27 INFO  # Optimization benchmark for operator_impact with args [['reviews', 'slow_loading', 'featurization_4', 'neural_network']] -- repetition 3 of 7
2022-09-21 21:53:27 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-21 21:53:27 INFO  Running instrumented original pipeline...
2022-09-21 21:53:27 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-21 21:53:27 INFO  ---RUNTIME: Importing and monkey-patching took 6.086826324462891 ms
2022-09-21 21:53:44 INFO  ---RUNTIME: Original pipeline execution took 17172.380208969116 ms (excluding imports and monkey-patching)
2022-09-21 21:53:44 INFO  Starting execution of 1 what-if analyses...
2022-09-21 21:53:44 INFO  Start plan generation for analysis OperatorImpact...
2022-09-21 21:53:44 INFO  ---RUNTIME: Plan generation took 5.110502243041992 ms
2022-09-21 21:53:44 INFO  Estimated runtime of original DAG is 13570.058822631836ms
2022-09-21 21:53:44 INFO  Performing Multi-Query Optimization
2022-09-21 21:53:44 INFO  Estimated unoptimized what-if runtime is 96632.34315050981ms
2022-09-21 21:53:44 INFO  Estimated optimised what-if runtime is 51993.212082552775ms
2022-09-21 21:53:44 INFO  Estimated optimisation runtime saving is 44639.13106795704ms
2022-09-21 21:53:44 INFO  ---RUNTIME: Multi-Query Optimization took 133.9716911315918 ms
2022-09-21 21:53:44 INFO  Executing generated plans
2022-09-21 21:54:38 INFO  ---RUNTIME: Execution took 54611.87171936035 ms
2022-09-21 21:54:38 INFO  Done!
2022-09-21 21:54:38 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-21 21:54:38 INFO  Running instrumented original pipeline...
2022-09-21 21:54:38 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-21 21:54:39 INFO  ---RUNTIME: Importing and monkey-patching took 6.088495254516602 ms
2022-09-21 21:54:55 INFO  ---RUNTIME: Original pipeline execution took 16899.198293685913 ms (excluding imports and monkey-patching)
2022-09-21 21:54:55 INFO  Starting execution of 1 what-if analyses...
2022-09-21 21:54:55 INFO  Start plan generation for analysis OperatorImpact...
2022-09-21 21:54:55 INFO  ---RUNTIME: Plan generation took 5.012989044189453 ms
2022-09-21 21:54:55 INFO  Estimated runtime of original DAG is 13261.407136917114ms
2022-09-21 21:54:55 WARNING Skipping Multi-Query Optimization (instead, only applying patches)
2022-09-21 21:54:55 INFO  Estimated unoptimised what-if runtime is 94337.92929469704ms
2022-09-21 21:54:55 INFO  ---RUNTIME: Multi-Query Optimization took 18.488645553588867 ms
2022-09-21 21:54:55 INFO  Executing generated plans
2022-09-21 21:56:43 INFO  ---RUNTIME: Execution took 107884.7451210022 ms
2022-09-21 21:56:43 INFO  Done!
2022-09-21 21:56:43 INFO  # Finished -- repetition 3 of 7 
2022-09-21 21:56:43 INFO  # Optimization benchmark for operator_impact with args [['reviews', 'slow_loading', 'featurization_4', 'neural_network']] -- repetition 4 of 7
2022-09-21 21:56:43 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-21 21:56:43 INFO  Running instrumented original pipeline...
2022-09-21 21:56:43 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-21 21:56:43 INFO  ---RUNTIME: Importing and monkey-patching took 6.56580924987793 ms
2022-09-21 21:57:02 INFO  ---RUNTIME: Original pipeline execution took 18303.96032333374 ms (excluding imports and monkey-patching)
2022-09-21 21:57:02 INFO  Starting execution of 1 what-if analyses...
2022-09-21 21:57:02 INFO  Start plan generation for analysis OperatorImpact...
2022-09-21 21:57:02 INFO  ---RUNTIME: Plan generation took 11.338233947753906 ms
2022-09-21 21:57:02 INFO  Estimated runtime of original DAG is 14407.904624938965ms
2022-09-21 21:57:02 INFO  Performing Multi-Query Optimization
2022-09-21 21:57:02 INFO  Estimated unoptimized what-if runtime is 102723.55301000248ms
2022-09-21 21:57:02 INFO  Estimated optimised what-if runtime is 55297.501966195676ms
2022-09-21 21:57:02 INFO  Estimated optimisation runtime saving is 47426.0510438068ms
2022-09-21 21:57:02 INFO  ---RUNTIME: Multi-Query Optimization took 264.1301155090332 ms
2022-09-21 21:57:02 INFO  Executing generated plans
2022-09-21 21:58:01 INFO  ---RUNTIME: Execution took 59435.09578704834 ms
2022-09-21 21:58:01 INFO  Done!
2022-09-21 21:58:01 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-21 21:58:01 INFO  Running instrumented original pipeline...
2022-09-21 21:58:01 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-21 21:58:01 INFO  ---RUNTIME: Importing and monkey-patching took 6.1168670654296875 ms
2022-09-21 21:58:21 INFO  ---RUNTIME: Original pipeline execution took 19527.49752998352 ms (excluding imports and monkey-patching)
2022-09-21 21:58:21 INFO  Starting execution of 1 what-if analyses...
2022-09-21 21:58:21 INFO  Start plan generation for analysis OperatorImpact...
2022-09-21 21:58:21 INFO  ---RUNTIME: Plan generation took 5.068540573120117 ms
2022-09-21 21:58:21 INFO  Estimated runtime of original DAG is 15884.410619735718ms
2022-09-21 21:58:21 WARNING Skipping Multi-Query Optimization (instead, only applying patches)
2022-09-21 21:58:21 INFO  Estimated unoptimised what-if runtime is 112892.2965462784ms
2022-09-21 21:58:21 INFO  ---RUNTIME: Multi-Query Optimization took 18.042325973510742 ms
2022-09-21 21:58:21 INFO  Executing generated plans
2022-09-21 22:00:14 INFO  ---RUNTIME: Execution took 112784.25908088684 ms
2022-09-21 22:00:14 INFO  Done!
2022-09-21 22:00:14 INFO  # Finished -- repetition 4 of 7 
2022-09-21 22:00:14 INFO  # Optimization benchmark for operator_impact with args [['reviews', 'slow_loading', 'featurization_4', 'neural_network']] -- repetition 5 of 7
2022-09-21 22:00:14 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-21 22:00:14 INFO  Running instrumented original pipeline...
2022-09-21 22:00:14 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-21 22:00:14 INFO  ---RUNTIME: Importing and monkey-patching took 6.085395812988281 ms
2022-09-21 22:00:32 INFO  ---RUNTIME: Original pipeline execution took 18088.643789291382 ms (excluding imports and monkey-patching)
2022-09-21 22:00:32 INFO  Starting execution of 1 what-if analyses...
2022-09-21 22:00:32 INFO  Start plan generation for analysis OperatorImpact...
2022-09-21 22:00:32 INFO  ---RUNTIME: Plan generation took 4.978418350219727 ms
2022-09-21 22:00:32 INFO  Estimated runtime of original DAG is 14803.248405456543ms
2022-09-21 22:00:32 INFO  Performing Multi-Query Optimization
2022-09-21 22:00:32 INFO  Estimated unoptimized what-if runtime is 105489.964458382ms
2022-09-21 22:00:32 INFO  Estimated optimised what-if runtime is 57067.17070761493ms
2022-09-21 22:00:32 INFO  Estimated optimisation runtime saving is 48422.79375076707ms
2022-09-21 22:00:32 INFO  ---RUNTIME: Multi-Query Optimization took 132.19714164733887 ms
2022-09-21 22:00:32 INFO  Executing generated plans
2022-09-21 22:01:32 INFO  ---RUNTIME: Execution took 59640.095710754395 ms
2022-09-21 22:01:32 INFO  Done!
2022-09-21 22:01:32 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-21 22:01:32 INFO  Running instrumented original pipeline...
2022-09-21 22:01:32 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-21 22:01:32 INFO  ---RUNTIME: Importing and monkey-patching took 5.990743637084961 ms
2022-09-21 22:01:51 INFO  ---RUNTIME: Original pipeline execution took 19642.76123046875 ms (excluding imports and monkey-patching)
2022-09-21 22:01:51 INFO  Starting execution of 1 what-if analyses...
2022-09-21 22:01:51 INFO  Start plan generation for analysis OperatorImpact...
2022-09-21 22:01:51 INFO  ---RUNTIME: Plan generation took 8.541345596313477 ms
2022-09-21 22:01:51 INFO  Estimated runtime of original DAG is 15604.916095733643ms
2022-09-21 22:01:51 WARNING Skipping Multi-Query Optimization (instead, only applying patches)
2022-09-21 22:01:51 INFO  Estimated unoptimised what-if runtime is 110989.28005044417ms
2022-09-21 22:01:51 INFO  ---RUNTIME: Multi-Query Optimization took 35.89630126953125 ms
2022-09-21 22:01:51 INFO  Executing generated plans
2022-09-21 22:03:43 INFO  ---RUNTIME: Execution took 111685.07480621338 ms
2022-09-21 22:03:43 INFO  Done!
2022-09-21 22:03:43 INFO  # Finished -- repetition 5 of 7 
2022-09-21 22:03:43 INFO  # Optimization benchmark for operator_impact with args [['reviews', 'slow_loading', 'featurization_4', 'neural_network']] -- repetition 6 of 7
2022-09-21 22:03:43 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-21 22:03:43 INFO  Running instrumented original pipeline...
2022-09-21 22:03:43 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-21 22:03:43 INFO  ---RUNTIME: Importing and monkey-patching took 352.337121963501 ms
2022-09-21 22:04:01 INFO  ---RUNTIME: Original pipeline execution took 17997.294187545776 ms (excluding imports and monkey-patching)
2022-09-21 22:04:01 INFO  Starting execution of 1 what-if analyses...
2022-09-21 22:04:01 INFO  Start plan generation for analysis OperatorImpact...
2022-09-21 22:04:01 INFO  ---RUNTIME: Plan generation took 4.97889518737793 ms
2022-09-21 22:04:01 INFO  Estimated runtime of original DAG is 14672.199964523315ms
2022-09-21 22:04:01 INFO  Performing Multi-Query Optimization
2022-09-21 22:04:01 INFO  Estimated unoptimized what-if runtime is 104555.97808895854ms
2022-09-21 22:04:01 INFO  Estimated optimised what-if runtime is 55436.011275684374ms
2022-09-21 22:04:01 INFO  Estimated optimisation runtime saving is 49119.966813274164ms
2022-09-21 22:04:01 INFO  ---RUNTIME: Multi-Query Optimization took 132.82513618469238 ms
2022-09-21 22:04:01 INFO  Executing generated plans
2022-09-21 22:05:01 INFO  ---RUNTIME: Execution took 59212.7103805542 ms
2022-09-21 22:05:01 INFO  Done!
2022-09-21 22:05:01 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-21 22:05:01 INFO  Running instrumented original pipeline...
2022-09-21 22:05:01 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-21 22:05:01 INFO  ---RUNTIME: Importing and monkey-patching took 6.352424621582031 ms
2022-09-21 22:05:19 INFO  ---RUNTIME: Original pipeline execution took 18352.91361808777 ms (excluding imports and monkey-patching)
2022-09-21 22:05:19 INFO  Starting execution of 1 what-if analyses...
2022-09-21 22:05:19 INFO  Start plan generation for analysis OperatorImpact...
2022-09-21 22:05:19 INFO  ---RUNTIME: Plan generation took 6.425619125366211 ms
2022-09-21 22:05:19 INFO  Estimated runtime of original DAG is 13896.615028381348ms
2022-09-21 22:05:19 WARNING Skipping Multi-Query Optimization (instead, only applying patches)
2022-09-21 22:05:19 INFO  Estimated unoptimised what-if runtime is 98877.73820961692ms
2022-09-21 22:05:19 INFO  ---RUNTIME: Multi-Query Optimization took 17.81630516052246 ms
2022-09-21 22:05:19 INFO  Executing generated plans
2022-09-21 22:07:10 INFO  ---RUNTIME: Execution took 111195.52636146545 ms
2022-09-21 22:07:10 INFO  Done!
2022-09-21 22:07:10 INFO  # Finished -- repetition 6 of 7 
2022-09-21 22:07:10 INFO  # Optimization benchmark for operator_impact with args [['reviews', 'slow_loading', 'featurization_4', 'neural_network']] -- repetition 7 of 7
2022-09-21 22:07:10 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-21 22:07:10 INFO  Running instrumented original pipeline...
2022-09-21 22:07:10 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-21 22:07:10 INFO  ---RUNTIME: Importing and monkey-patching took 6.295204162597656 ms
2022-09-21 22:07:30 INFO  ---RUNTIME: Original pipeline execution took 19719.1801071167 ms (excluding imports and monkey-patching)
2022-09-21 22:07:30 INFO  Starting execution of 1 what-if analyses...
2022-09-21 22:07:30 INFO  Start plan generation for analysis OperatorImpact...
2022-09-21 22:07:30 INFO  ---RUNTIME: Plan generation took 4.974603652954102 ms
2022-09-21 22:07:30 INFO  Estimated runtime of original DAG is 15676.821231842041ms
2022-09-21 22:07:30 INFO  Performing Multi-Query Optimization
2022-09-21 22:07:30 INFO  Estimated unoptimized what-if runtime is 111756.82842139815ms
2022-09-21 22:07:30 INFO  Estimated optimised what-if runtime is 61847.05190508046ms
2022-09-21 22:07:30 INFO  Estimated optimisation runtime saving is 49909.776516317695ms
2022-09-21 22:07:30 INFO  ---RUNTIME: Multi-Query Optimization took 132.25936889648438 ms
2022-09-21 22:07:30 INFO  Executing generated plans
2022-09-21 22:08:30 INFO  ---RUNTIME: Execution took 59439.96214866638 ms
2022-09-21 22:08:30 INFO  Done!
2022-09-21 22:08:30 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-21 22:08:30 INFO  Running instrumented original pipeline...
2022-09-21 22:08:30 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-21 22:08:30 INFO  ---RUNTIME: Importing and monkey-patching took 9.453535079956055 ms
2022-09-21 22:08:48 INFO  ---RUNTIME: Original pipeline execution took 18434.862852096558 ms (excluding imports and monkey-patching)
2022-09-21 22:08:48 INFO  Starting execution of 1 what-if analyses...
2022-09-21 22:08:48 INFO  Start plan generation for analysis OperatorImpact...
2022-09-21 22:08:48 INFO  ---RUNTIME: Plan generation took 6.648778915405273 ms
2022-09-21 22:08:48 INFO  Estimated runtime of original DAG is 14763.172149658203ms
2022-09-21 22:08:48 WARNING Skipping Multi-Query Optimization (instead, only applying patches)
2022-09-21 22:08:48 INFO  Estimated unoptimised what-if runtime is 105071.98685797032ms
2022-09-21 22:08:48 INFO  ---RUNTIME: Multi-Query Optimization took 17.658710479736328 ms
2022-09-21 22:08:48 INFO  Executing generated plans
2022-09-21 22:10:38 INFO  ---RUNTIME: Execution took 109731.19235038757 ms
2022-09-21 22:10:38 INFO  Done!
2022-09-21 22:10:38 INFO  # Finished -- repetition 7 of 7 
2022-09-21 22:10:38 INFO  # Final results after all repetitions
2022-09-21 22:10:38 INFO     repetition  ... no_opt_what_if_execution_combined_model_training
0           0  ...                                     24461.592913
1           1  ...                                     24044.380426
2           2  ...                                     24226.703405
3           3  ...                                     27976.063967
4           4  ...                                     26233.540535
5           5  ...                                     23891.102552
6           6  ...                                     26607.785225

[7 rows x 26 columns]
taskset -c 160-167 PROTOCOL_BUFFERS_PYTHON_IMPLEMENTATION=python python3.9 benchmarks_end_to_end.py data_cleaning reviews slow_loading featurization_0 logistic_regression
2022-09-21 22:10:40.819397: W tensorflow/stream_executor/platform/default/dso_loader.cc:64] Could not load dynamic library 'libcudart.so.11.0'; dlerror: libcudart.so.11.0: cannot open shared object file: No such file or directory; LD_LIBRARY_PATH: /home/sgrafbe/mlwhatif/venv/lib/python3.9/site-packages/cv2/../../lib64:
2022-09-21 22:10:40.819438: I tensorflow/stream_executor/cuda/cudart_stub.cc:29] Ignore above cudart dlerror if you do not have a GPU set up on your machine.
2022-09-21 22:10:42 INFO  Patching sys.argv with ['mlwhatif', 'reviews', 'slow_loading', 'featurization_0', 'logistic_regression']
2022-09-21 22:10:42 INFO  Running instrumented original pipeline...
2022-09-21 22:10:42 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-21 22:10:42 INFO  ---RUNTIME: Importing and monkey-patching took 96.22454643249512 ms
2022-09-21 22:10:49 INFO  ---RUNTIME: Original pipeline execution took 7004.838705062866 ms (excluding imports and monkey-patching)
2022-09-21 22:10:49 INFO  Starting execution of 0 what-if analyses...
2022-09-21 22:10:49 INFO  Estimated runtime of original DAG is 5356.40811920166ms
2022-09-21 22:10:49 INFO  Performing Multi-Query Optimization
2022-09-21 22:10:49 INFO  Estimated unoptimized what-if runtime is 0ms
2022-09-21 22:10:49 INFO  Estimated optimised what-if runtime is 0ms
2022-09-21 22:10:49 INFO  Estimated optimisation runtime saving is 0ms
2022-09-21 22:10:49 INFO  ---RUNTIME: Multi-Query Optimization took 0.5657672882080078 ms
2022-09-21 22:10:49 INFO  Executing generated plans
2022-09-21 22:10:49 INFO  ---RUNTIME: Execution took 0.027894973754882812 ms
2022-09-21 22:10:49 INFO  Done!
2022-09-21 22:10:49 INFO  # Optimization benchmark for data_cleaning with args [['reviews', 'slow_loading', 'featurization_0', 'logistic_regression']] -- repetition 1 of 7
2022-09-21 22:10:49 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-21 22:10:49 INFO  Running instrumented original pipeline...
2022-09-21 22:10:49 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-21 22:10:49 INFO  ---RUNTIME: Importing and monkey-patching took 5.744695663452148 ms
2022-09-21 22:10:56 INFO  ---RUNTIME: Original pipeline execution took 7211.469650268555 ms (excluding imports and monkey-patching)
2022-09-21 22:10:56 INFO  Starting execution of 1 what-if analyses...
2022-09-21 22:10:56 INFO  Start plan generation for analysis DataCleaning...
2022-09-21 22:10:56 INFO  ---RUNTIME: Plan generation took 0.606536865234375 ms
2022-09-21 22:10:56 INFO  Estimated runtime of original DAG is 5510.144233703613ms
2022-09-21 22:10:56 INFO  Performing Multi-Query Optimization
2022-09-21 22:10:56 INFO  Estimated unoptimized what-if runtime is 110202.88467407227ms
2022-09-21 22:10:56 INFO  Estimated optimised what-if runtime is 19757.004499435425ms
2022-09-21 22:10:56 INFO  Estimated optimisation runtime saving is 90445.88017463684ms
2022-09-21 22:10:56 INFO  ---RUNTIME: Multi-Query Optimization took 94.1929817199707 ms
2022-09-21 22:10:56 INFO  Executing generated plans
2022-09-21 22:11:22 INFO  ---RUNTIME: Execution took 26494.145154953003 ms
2022-09-21 22:11:22 INFO  Done!
2022-09-21 22:11:22 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-21 22:11:22 INFO  Running instrumented original pipeline...
2022-09-21 22:11:23 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-21 22:11:23 INFO  ---RUNTIME: Importing and monkey-patching took 5.934000015258789 ms
2022-09-21 22:11:30 INFO  ---RUNTIME: Original pipeline execution took 7361.977100372314 ms (excluding imports and monkey-patching)
2022-09-21 22:11:30 INFO  Starting execution of 1 what-if analyses...
2022-09-21 22:11:30 INFO  Start plan generation for analysis DataCleaning...
2022-09-21 22:11:30 INFO  ---RUNTIME: Plan generation took 0.5712509155273438 ms
2022-09-21 22:11:30 INFO  Estimated runtime of original DAG is 5459.112167358398ms
2022-09-21 22:11:30 WARNING Skipping Multi-Query Optimization (instead, only applying patches)
2022-09-21 22:11:30 WARNING Columns ['review_id'] not present in train DAG after the train test split, only before!
2022-09-21 22:11:30 WARNING This could hint at data leakage!
2022-09-21 22:11:30 INFO  Estimated unoptimised what-if runtime is 109182.24334716797ms
2022-09-21 22:11:30 INFO  ---RUNTIME: Multi-Query Optimization took 43.52593421936035 ms
2022-09-21 22:11:30 INFO  Executing generated plans
2022-09-21 22:13:43 INFO  ---RUNTIME: Execution took 133077.52084732056 ms
2022-09-21 22:13:43 INFO  Done!
2022-09-21 22:13:43 INFO  # Finished -- repetition 1 of 7 
2022-09-21 22:13:43 INFO  # Optimization benchmark for data_cleaning with args [['reviews', 'slow_loading', 'featurization_0', 'logistic_regression']] -- repetition 2 of 7
2022-09-21 22:13:43 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-21 22:13:43 INFO  Running instrumented original pipeline...
2022-09-21 22:13:43 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-21 22:13:43 INFO  ---RUNTIME: Importing and monkey-patching took 7.035017013549805 ms
2022-09-21 22:13:50 INFO  ---RUNTIME: Original pipeline execution took 7043.5450077056885 ms (excluding imports and monkey-patching)
2022-09-21 22:13:50 INFO  Starting execution of 1 what-if analyses...
2022-09-21 22:13:50 INFO  Start plan generation for analysis DataCleaning...
2022-09-21 22:13:50 INFO  ---RUNTIME: Plan generation took 0.5857944488525391 ms
2022-09-21 22:13:50 INFO  Estimated runtime of original DAG is 5409.618377685547ms
2022-09-21 22:13:50 INFO  Performing Multi-Query Optimization
2022-09-21 22:13:50 INFO  Estimated unoptimized what-if runtime is 108192.36755371094ms
2022-09-21 22:13:50 INFO  Estimated optimised what-if runtime is 19098.17099571228ms
2022-09-21 22:13:50 INFO  Estimated optimisation runtime saving is 89094.19655799866ms
2022-09-21 22:13:50 INFO  ---RUNTIME: Multi-Query Optimization took 87.94140815734863 ms
2022-09-21 22:13:50 INFO  Executing generated plans
2022-09-21 22:14:17 INFO  ---RUNTIME: Execution took 26547.67870903015 ms
2022-09-21 22:14:17 INFO  Done!
2022-09-21 22:14:17 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-21 22:14:17 INFO  Running instrumented original pipeline...
2022-09-21 22:14:17 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-21 22:14:17 INFO  ---RUNTIME: Importing and monkey-patching took 6.295919418334961 ms
2022-09-21 22:14:24 INFO  ---RUNTIME: Original pipeline execution took 7342.489004135132 ms (excluding imports and monkey-patching)
2022-09-21 22:14:24 INFO  Starting execution of 1 what-if analyses...
2022-09-21 22:14:24 INFO  Start plan generation for analysis DataCleaning...
2022-09-21 22:14:24 INFO  ---RUNTIME: Plan generation took 0.545501708984375 ms
2022-09-21 22:14:24 INFO  Estimated runtime of original DAG is 5718.339920043945ms
2022-09-21 22:14:24 WARNING Skipping Multi-Query Optimization (instead, only applying patches)
2022-09-21 22:14:24 WARNING Columns ['review_id'] not present in train DAG after the train test split, only before!
2022-09-21 22:14:24 WARNING This could hint at data leakage!
2022-09-21 22:14:24 INFO  Estimated unoptimised what-if runtime is 114366.7984008789ms
2022-09-21 22:14:24 INFO  ---RUNTIME: Multi-Query Optimization took 23.40245246887207 ms
2022-09-21 22:14:24 INFO  Executing generated plans
2022-09-21 22:16:37 INFO  ---RUNTIME: Execution took 133419.15321350098 ms
2022-09-21 22:16:37 INFO  Done!
2022-09-21 22:16:37 INFO  # Finished -- repetition 2 of 7 
2022-09-21 22:16:37 INFO  # Optimization benchmark for data_cleaning with args [['reviews', 'slow_loading', 'featurization_0', 'logistic_regression']] -- repetition 3 of 7
2022-09-21 22:16:37 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-21 22:16:37 INFO  Running instrumented original pipeline...
2022-09-21 22:16:38 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-21 22:16:38 INFO  ---RUNTIME: Importing and monkey-patching took 6.258964538574219 ms
2022-09-21 22:16:44 INFO  ---RUNTIME: Original pipeline execution took 6980.942249298096 ms (excluding imports and monkey-patching)
2022-09-21 22:16:44 INFO  Starting execution of 1 what-if analyses...
2022-09-21 22:16:44 INFO  Start plan generation for analysis DataCleaning...
2022-09-21 22:16:44 INFO  ---RUNTIME: Plan generation took 0.5533695220947266 ms
2022-09-21 22:16:44 INFO  Estimated runtime of original DAG is 5350.394487380981ms
2022-09-21 22:16:44 INFO  Performing Multi-Query Optimization
2022-09-21 22:16:45 INFO  Estimated unoptimized what-if runtime is 107007.88974761963ms
2022-09-21 22:16:45 INFO  Estimated optimised what-if runtime is 19097.944736480713ms
2022-09-21 22:16:45 INFO  Estimated optimisation runtime saving is 87909.94501113892ms
2022-09-21 22:16:45 INFO  ---RUNTIME: Multi-Query Optimization took 94.86031532287598 ms
2022-09-21 22:16:45 INFO  Executing generated plans
2022-09-21 22:17:11 INFO  ---RUNTIME: Execution took 26819.576263427734 ms
2022-09-21 22:17:11 INFO  Done!
2022-09-21 22:17:11 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-21 22:17:11 INFO  Running instrumented original pipeline...
2022-09-21 22:17:11 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-21 22:17:11 INFO  ---RUNTIME: Importing and monkey-patching took 6.4544677734375 ms
2022-09-21 22:17:18 INFO  ---RUNTIME: Original pipeline execution took 7039.502382278442 ms (excluding imports and monkey-patching)
2022-09-21 22:17:18 INFO  Starting execution of 1 what-if analyses...
2022-09-21 22:17:18 INFO  Start plan generation for analysis DataCleaning...
2022-09-21 22:17:18 INFO  ---RUNTIME: Plan generation took 0.5700588226318359 ms
2022-09-21 22:17:18 INFO  Estimated runtime of original DAG is 5407.390832901001ms
2022-09-21 22:17:18 WARNING Skipping Multi-Query Optimization (instead, only applying patches)
2022-09-21 22:17:18 WARNING Columns ['review_id'] not present in train DAG after the train test split, only before!
2022-09-21 22:17:18 WARNING This could hint at data leakage!
2022-09-21 22:17:18 INFO  Estimated unoptimised what-if runtime is 108147.81665802002ms
2022-09-21 22:17:18 INFO  ---RUNTIME: Multi-Query Optimization took 24.875164031982422 ms
2022-09-21 22:17:18 INFO  Executing generated plans
2022-09-21 22:19:33 INFO  ---RUNTIME: Execution took 134848.7184047699 ms
2022-09-21 22:19:33 INFO  Done!
2022-09-21 22:19:33 INFO  # Finished -- repetition 3 of 7 
2022-09-21 22:19:33 INFO  # Optimization benchmark for data_cleaning with args [['reviews', 'slow_loading', 'featurization_0', 'logistic_regression']] -- repetition 4 of 7
2022-09-21 22:19:33 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-21 22:19:33 INFO  Running instrumented original pipeline...
2022-09-21 22:19:33 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-21 22:19:33 INFO  ---RUNTIME: Importing and monkey-patching took 6.319522857666016 ms
2022-09-21 22:19:41 INFO  ---RUNTIME: Original pipeline execution took 7294.026851654053 ms (excluding imports and monkey-patching)
2022-09-21 22:19:41 INFO  Starting execution of 1 what-if analyses...
2022-09-21 22:19:41 INFO  Start plan generation for analysis DataCleaning...
2022-09-21 22:19:41 INFO  ---RUNTIME: Plan generation took 0.5314350128173828 ms
2022-09-21 22:19:41 INFO  Estimated runtime of original DAG is 5497.986316680908ms
2022-09-21 22:19:41 INFO  Performing Multi-Query Optimization
2022-09-21 22:19:41 INFO  Estimated unoptimized what-if runtime is 109959.72633361816ms
2022-09-21 22:19:41 INFO  Estimated optimised what-if runtime is 19117.24853515625ms
2022-09-21 22:19:41 INFO  Estimated optimisation runtime saving is 90842.47779846191ms
2022-09-21 22:19:41 INFO  ---RUNTIME: Multi-Query Optimization took 87.21137046813965 ms
2022-09-21 22:19:41 INFO  Executing generated plans
2022-09-21 22:20:07 INFO  ---RUNTIME: Execution took 26710.631132125854 ms
2022-09-21 22:20:07 INFO  Done!
2022-09-21 22:20:07 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-21 22:20:07 INFO  Running instrumented original pipeline...
2022-09-21 22:20:07 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-21 22:20:07 INFO  ---RUNTIME: Importing and monkey-patching took 6.082296371459961 ms
2022-09-21 22:20:15 INFO  ---RUNTIME: Original pipeline execution took 7188.592195510864 ms (excluding imports and monkey-patching)
2022-09-21 22:20:15 INFO  Starting execution of 1 what-if analyses...
2022-09-21 22:20:15 INFO  Start plan generation for analysis DataCleaning...
2022-09-21 22:20:15 INFO  ---RUNTIME: Plan generation took 0.5333423614501953 ms
2022-09-21 22:20:15 INFO  Estimated runtime of original DAG is 5478.232860565186ms
2022-09-21 22:20:15 WARNING Skipping Multi-Query Optimization (instead, only applying patches)
2022-09-21 22:20:15 WARNING Columns ['review_id'] not present in train DAG after the train test split, only before!
2022-09-21 22:20:15 WARNING This could hint at data leakage!
2022-09-21 22:20:15 INFO  Estimated unoptimised what-if runtime is 109564.65721130371ms
2022-09-21 22:20:15 INFO  ---RUNTIME: Multi-Query Optimization took 22.381067276000977 ms
2022-09-21 22:20:15 INFO  Executing generated plans
2022-09-21 22:22:29 INFO  ---RUNTIME: Execution took 134278.7663936615 ms
2022-09-21 22:22:29 INFO  Done!
2022-09-21 22:22:29 INFO  # Finished -- repetition 4 of 7 
2022-09-21 22:22:29 INFO  # Optimization benchmark for data_cleaning with args [['reviews', 'slow_loading', 'featurization_0', 'logistic_regression']] -- repetition 5 of 7
2022-09-21 22:22:29 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-21 22:22:29 INFO  Running instrumented original pipeline...
2022-09-21 22:22:29 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-21 22:22:29 INFO  ---RUNTIME: Importing and monkey-patching took 6.427288055419922 ms
2022-09-21 22:22:36 INFO  ---RUNTIME: Original pipeline execution took 7019.995212554932 ms (excluding imports and monkey-patching)
2022-09-21 22:22:36 INFO  Starting execution of 1 what-if analyses...
2022-09-21 22:22:36 INFO  Start plan generation for analysis DataCleaning...
2022-09-21 22:22:36 INFO  ---RUNTIME: Plan generation took 0.5290508270263672 ms
2022-09-21 22:22:36 INFO  Estimated runtime of original DAG is 5367.859840393066ms
2022-09-21 22:22:36 INFO  Performing Multi-Query Optimization
2022-09-21 22:22:36 INFO  Estimated unoptimized what-if runtime is 107357.19680786133ms
2022-09-21 22:22:36 INFO  Estimated optimised what-if runtime is 19032.767057418823ms
2022-09-21 22:22:36 INFO  Estimated optimisation runtime saving is 88324.4297504425ms
2022-09-21 22:22:36 INFO  ---RUNTIME: Multi-Query Optimization took 88.12332153320312 ms
2022-09-21 22:22:36 INFO  Executing generated plans
2022-09-21 22:23:03 INFO  ---RUNTIME: Execution took 26535.844802856445 ms
2022-09-21 22:23:03 INFO  Done!
2022-09-21 22:23:03 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-21 22:23:03 INFO  Running instrumented original pipeline...
2022-09-21 22:23:03 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-21 22:23:03 INFO  ---RUNTIME: Importing and monkey-patching took 6.4449310302734375 ms
2022-09-21 22:23:10 INFO  ---RUNTIME: Original pipeline execution took 7127.023458480835 ms (excluding imports and monkey-patching)
2022-09-21 22:23:10 INFO  Starting execution of 1 what-if analyses...
2022-09-21 22:23:10 INFO  Start plan generation for analysis DataCleaning...
2022-09-21 22:23:10 INFO  ---RUNTIME: Plan generation took 0.5679130554199219 ms
2022-09-21 22:23:10 INFO  Estimated runtime of original DAG is 5485.668182373047ms
2022-09-21 22:23:10 WARNING Skipping Multi-Query Optimization (instead, only applying patches)
2022-09-21 22:23:10 WARNING Columns ['review_id'] not present in train DAG after the train test split, only before!
2022-09-21 22:23:10 WARNING This could hint at data leakage!
2022-09-21 22:23:10 INFO  Estimated unoptimised what-if runtime is 109713.36364746094ms
2022-09-21 22:23:10 INFO  ---RUNTIME: Multi-Query Optimization took 23.539066314697266 ms
2022-09-21 22:23:10 INFO  Executing generated plans
2022-09-21 22:25:24 INFO  ---RUNTIME: Execution took 133961.78269386292 ms
2022-09-21 22:25:24 INFO  Done!
2022-09-21 22:25:24 INFO  # Finished -- repetition 5 of 7 
2022-09-21 22:25:24 INFO  # Optimization benchmark for data_cleaning with args [['reviews', 'slow_loading', 'featurization_0', 'logistic_regression']] -- repetition 6 of 7
2022-09-21 22:25:24 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-21 22:25:24 INFO  Running instrumented original pipeline...
2022-09-21 22:25:24 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-21 22:25:24 INFO  ---RUNTIME: Importing and monkey-patching took 6.389379501342773 ms
2022-09-21 22:25:31 INFO  ---RUNTIME: Original pipeline execution took 7037.9319190979 ms (excluding imports and monkey-patching)
2022-09-21 22:25:31 INFO  Starting execution of 1 what-if analyses...
2022-09-21 22:25:31 INFO  Start plan generation for analysis DataCleaning...
2022-09-21 22:25:31 INFO  ---RUNTIME: Plan generation took 0.5357265472412109 ms
2022-09-21 22:25:31 INFO  Estimated runtime of original DAG is 5388.264417648315ms
2022-09-21 22:25:31 INFO  Performing Multi-Query Optimization
2022-09-21 22:25:31 INFO  Estimated unoptimized what-if runtime is 107765.28835296631ms
2022-09-21 22:25:31 INFO  Estimated optimised what-if runtime is 18946.631908416748ms
2022-09-21 22:25:31 INFO  Estimated optimisation runtime saving is 88818.65644454956ms
2022-09-21 22:25:31 INFO  ---RUNTIME: Multi-Query Optimization took 89.54644203186035 ms
2022-09-21 22:25:31 INFO  Executing generated plans
2022-09-21 22:25:57 INFO  ---RUNTIME: Execution took 26151.774406433105 ms
2022-09-21 22:25:57 INFO  Done!
2022-09-21 22:25:57 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-21 22:25:57 INFO  Running instrumented original pipeline...
2022-09-21 22:25:57 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-21 22:25:57 INFO  ---RUNTIME: Importing and monkey-patching took 6.029367446899414 ms
2022-09-21 22:26:04 INFO  ---RUNTIME: Original pipeline execution took 7428.48539352417 ms (excluding imports and monkey-patching)
2022-09-21 22:26:04 INFO  Starting execution of 1 what-if analyses...
2022-09-21 22:26:04 INFO  Start plan generation for analysis DataCleaning...
2022-09-21 22:26:04 INFO  ---RUNTIME: Plan generation took 0.5593299865722656 ms
2022-09-21 22:26:04 INFO  Estimated runtime of original DAG is 5475.331783294678ms
2022-09-21 22:26:04 WARNING Skipping Multi-Query Optimization (instead, only applying patches)
2022-09-21 22:26:04 WARNING Columns ['review_id'] not present in train DAG after the train test split, only before!
2022-09-21 22:26:04 WARNING This could hint at data leakage!
2022-09-21 22:26:04 INFO  Estimated unoptimised what-if runtime is 109506.63566589355ms
2022-09-21 22:26:04 INFO  ---RUNTIME: Multi-Query Optimization took 22.629261016845703 ms
2022-09-21 22:26:04 INFO  Executing generated plans
2022-09-21 22:28:18 INFO  ---RUNTIME: Execution took 133060.56761741638 ms
2022-09-21 22:28:18 INFO  Done!
2022-09-21 22:28:18 INFO  # Finished -- repetition 6 of 7 
2022-09-21 22:28:18 INFO  # Optimization benchmark for data_cleaning with args [['reviews', 'slow_loading', 'featurization_0', 'logistic_regression']] -- repetition 7 of 7
2022-09-21 22:28:18 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-21 22:28:18 INFO  Running instrumented original pipeline...
2022-09-21 22:28:18 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-21 22:28:18 INFO  ---RUNTIME: Importing and monkey-patching took 6.379365921020508 ms
2022-09-21 22:28:25 INFO  ---RUNTIME: Original pipeline execution took 7082.4644565582275 ms (excluding imports and monkey-patching)
2022-09-21 22:28:25 INFO  Starting execution of 1 what-if analyses...
2022-09-21 22:28:25 INFO  Start plan generation for analysis DataCleaning...
2022-09-21 22:28:25 INFO  ---RUNTIME: Plan generation took 0.5435943603515625 ms
2022-09-21 22:28:25 INFO  Estimated runtime of original DAG is 5395.163059234619ms
2022-09-21 22:28:25 INFO  Performing Multi-Query Optimization
2022-09-21 22:28:25 INFO  Estimated unoptimized what-if runtime is 107903.26118469238ms
2022-09-21 22:28:25 INFO  Estimated optimised what-if runtime is 19037.754774093628ms
2022-09-21 22:28:25 INFO  Estimated optimisation runtime saving is 88865.50641059875ms
2022-09-21 22:28:25 INFO  ---RUNTIME: Multi-Query Optimization took 87.37826347351074 ms
2022-09-21 22:28:25 INFO  Executing generated plans
2022-09-21 22:28:51 INFO  ---RUNTIME: Execution took 26178.501844406128 ms
2022-09-21 22:28:51 INFO  Done!
2022-09-21 22:28:51 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-21 22:28:51 INFO  Running instrumented original pipeline...
2022-09-21 22:28:51 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-21 22:28:51 INFO  ---RUNTIME: Importing and monkey-patching took 6.077289581298828 ms
2022-09-21 22:28:58 INFO  ---RUNTIME: Original pipeline execution took 7072.240591049194 ms (excluding imports and monkey-patching)
2022-09-21 22:28:58 INFO  Starting execution of 1 what-if analyses...
2022-09-21 22:28:58 INFO  Start plan generation for analysis DataCleaning...
2022-09-21 22:28:58 INFO  ---RUNTIME: Plan generation took 0.5064010620117188 ms
2022-09-21 22:28:58 INFO  Estimated runtime of original DAG is 5383.775472640991ms
2022-09-21 22:28:58 WARNING Skipping Multi-Query Optimization (instead, only applying patches)
2022-09-21 22:28:58 WARNING Columns ['review_id'] not present in train DAG after the train test split, only before!
2022-09-21 22:28:58 WARNING This could hint at data leakage!
2022-09-21 22:28:58 INFO  Estimated unoptimised what-if runtime is 107675.50945281982ms
2022-09-21 22:28:58 INFO  ---RUNTIME: Multi-Query Optimization took 22.42279052734375 ms
2022-09-21 22:28:58 INFO  Executing generated plans
2022-09-21 22:31:12 INFO  ---RUNTIME: Execution took 133937.39199638367 ms
2022-09-21 22:31:12 INFO  Done!
2022-09-21 22:31:12 INFO  # Finished -- repetition 7 of 7 
2022-09-21 22:31:12 INFO  # Final results after all repetitions
2022-09-21 22:31:12 INFO     repetition  ... no_opt_what_if_execution_combined_model_training
0           0  ...                                      3118.164778
1           1  ...                                      3076.282740
2           2  ...                                      3069.082022
3           3  ...                                      3111.235619
4           4  ...                                      3079.871893
5           5  ...                                      3051.133633
6           6  ...                                      3049.930811

[7 rows x 26 columns]
taskset -c 160-167 PROTOCOL_BUFFERS_PYTHON_IMPLEMENTATION=python python3.9 benchmarks_end_to_end.py data_cleaning reviews slow_loading featurization_0 xgboost
2022-09-21 22:31:14.637117: W tensorflow/stream_executor/platform/default/dso_loader.cc:64] Could not load dynamic library 'libcudart.so.11.0'; dlerror: libcudart.so.11.0: cannot open shared object file: No such file or directory; LD_LIBRARY_PATH: /home/sgrafbe/mlwhatif/venv/lib/python3.9/site-packages/cv2/../../lib64:
2022-09-21 22:31:14.637159: I tensorflow/stream_executor/cuda/cudart_stub.cc:29] Ignore above cudart dlerror if you do not have a GPU set up on your machine.
2022-09-21 22:31:15 INFO  Patching sys.argv with ['mlwhatif', 'reviews', 'slow_loading', 'featurization_0', 'xgboost']
2022-09-21 22:31:15 INFO  Running instrumented original pipeline...
2022-09-21 22:31:15 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-21 22:31:15 INFO  ---RUNTIME: Importing and monkey-patching took 95.41749954223633 ms
2022-09-21 22:31:26 INFO  ---RUNTIME: Original pipeline execution took 10862.843990325928 ms (excluding imports and monkey-patching)
2022-09-21 22:31:26 INFO  Starting execution of 0 what-if analyses...
2022-09-21 22:31:26 INFO  Estimated runtime of original DAG is 9203.577995300293ms
2022-09-21 22:31:26 INFO  Performing Multi-Query Optimization
2022-09-21 22:31:26 INFO  Estimated unoptimized what-if runtime is 0ms
2022-09-21 22:31:26 INFO  Estimated optimised what-if runtime is 0ms
2022-09-21 22:31:26 INFO  Estimated optimisation runtime saving is 0ms
2022-09-21 22:31:26 INFO  ---RUNTIME: Multi-Query Optimization took 0.518798828125 ms
2022-09-21 22:31:26 INFO  Executing generated plans
2022-09-21 22:31:26 INFO  ---RUNTIME: Execution took 0.025033950805664062 ms
2022-09-21 22:31:26 INFO  Done!
2022-09-21 22:31:26 INFO  # Optimization benchmark for data_cleaning with args [['reviews', 'slow_loading', 'featurization_0', 'xgboost']] -- repetition 1 of 7
2022-09-21 22:31:26 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-21 22:31:26 INFO  Running instrumented original pipeline...
2022-09-21 22:31:26 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-21 22:31:26 INFO  ---RUNTIME: Importing and monkey-patching took 5.560636520385742 ms
2022-09-21 22:31:34 INFO  ---RUNTIME: Original pipeline execution took 7646.054744720459 ms (excluding imports and monkey-patching)
2022-09-21 22:31:34 INFO  Starting execution of 1 what-if analyses...
2022-09-21 22:31:34 INFO  Start plan generation for analysis DataCleaning...
2022-09-21 22:31:34 INFO  ---RUNTIME: Plan generation took 0.5624294281005859 ms
2022-09-21 22:31:34 INFO  Estimated runtime of original DAG is 6033.3757400512695ms
2022-09-21 22:31:34 INFO  Performing Multi-Query Optimization
2022-09-21 22:31:34 INFO  Estimated unoptimized what-if runtime is 120667.51480102539ms
2022-09-21 22:31:34 INFO  Estimated optimised what-if runtime is 32474.052667617798ms
2022-09-21 22:31:34 INFO  Estimated optimisation runtime saving is 88193.4621334076ms
2022-09-21 22:31:34 INFO  ---RUNTIME: Multi-Query Optimization took 89.67280387878418 ms
2022-09-21 22:31:34 INFO  Executing generated plans
2022-09-21 22:32:14 INFO  ---RUNTIME: Execution took 39891.39771461487 ms
2022-09-21 22:32:14 INFO  Done!
2022-09-21 22:32:14 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-21 22:32:14 INFO  Running instrumented original pipeline...
2022-09-21 22:32:14 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-21 22:32:14 INFO  ---RUNTIME: Importing and monkey-patching took 5.852222442626953 ms
2022-09-21 22:32:22 INFO  ---RUNTIME: Original pipeline execution took 7850.483179092407 ms (excluding imports and monkey-patching)
2022-09-21 22:32:22 INFO  Starting execution of 1 what-if analyses...
2022-09-21 22:32:22 INFO  Start plan generation for analysis DataCleaning...
2022-09-21 22:32:22 INFO  ---RUNTIME: Plan generation took 0.5328655242919922 ms
2022-09-21 22:32:22 INFO  Estimated runtime of original DAG is 6062.636852264404ms
2022-09-21 22:32:22 WARNING Skipping Multi-Query Optimization (instead, only applying patches)
2022-09-21 22:32:22 WARNING Columns ['review_id'] not present in train DAG after the train test split, only before!
2022-09-21 22:32:22 WARNING This could hint at data leakage!
2022-09-21 22:32:22 INFO  Estimated unoptimised what-if runtime is 121252.73704528809ms
2022-09-21 22:32:22 INFO  ---RUNTIME: Multi-Query Optimization took 22.36151695251465 ms
2022-09-21 22:32:22 INFO  Executing generated plans
2022-09-21 22:34:47 INFO  ---RUNTIME: Execution took 145639.54520225525 ms
2022-09-21 22:34:47 INFO  Done!
2022-09-21 22:34:47 INFO  # Finished -- repetition 1 of 7 
2022-09-21 22:34:47 INFO  # Optimization benchmark for data_cleaning with args [['reviews', 'slow_loading', 'featurization_0', 'xgboost']] -- repetition 2 of 7
2022-09-21 22:34:47 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-21 22:34:47 INFO  Running instrumented original pipeline...
2022-09-21 22:34:48 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-21 22:34:48 INFO  ---RUNTIME: Importing and monkey-patching took 6.134510040283203 ms
2022-09-21 22:34:55 INFO  ---RUNTIME: Original pipeline execution took 7684.473752975464 ms (excluding imports and monkey-patching)
2022-09-21 22:34:55 INFO  Starting execution of 1 what-if analyses...
2022-09-21 22:34:55 INFO  Start plan generation for analysis DataCleaning...
2022-09-21 22:34:55 INFO  ---RUNTIME: Plan generation took 0.5438327789306641 ms
2022-09-21 22:34:55 INFO  Estimated runtime of original DAG is 6051.856279373169ms
2022-09-21 22:34:55 INFO  Performing Multi-Query Optimization
2022-09-21 22:34:55 INFO  Estimated unoptimized what-if runtime is 121037.12558746338ms
2022-09-21 22:34:55 INFO  Estimated optimised what-if runtime is 32447.45135307312ms
2022-09-21 22:34:55 INFO  Estimated optimisation runtime saving is 88589.67423439026ms
2022-09-21 22:34:55 INFO  ---RUNTIME: Multi-Query Optimization took 88.27495574951172 ms
2022-09-21 22:34:55 INFO  Executing generated plans
2022-09-21 22:35:35 INFO  ---RUNTIME: Execution took 40176.563024520874 ms
2022-09-21 22:35:35 INFO  Done!
2022-09-21 22:35:35 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-21 22:35:35 INFO  Running instrumented original pipeline...
2022-09-21 22:35:35 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-21 22:35:35 INFO  ---RUNTIME: Importing and monkey-patching took 6.226062774658203 ms
2022-09-21 22:35:43 INFO  ---RUNTIME: Original pipeline execution took 7691.670656204224 ms (excluding imports and monkey-patching)
2022-09-21 22:35:43 INFO  Starting execution of 1 what-if analyses...
2022-09-21 22:35:43 INFO  Start plan generation for analysis DataCleaning...
2022-09-21 22:35:43 INFO  ---RUNTIME: Plan generation took 0.5686283111572266 ms
2022-09-21 22:35:43 INFO  Estimated runtime of original DAG is 6064.6703243255615ms
2022-09-21 22:35:43 WARNING Skipping Multi-Query Optimization (instead, only applying patches)
2022-09-21 22:35:43 WARNING Columns ['review_id'] not present in train DAG after the train test split, only before!
2022-09-21 22:35:43 WARNING This could hint at data leakage!
2022-09-21 22:35:43 INFO  Estimated unoptimised what-if runtime is 121293.40648651123ms
2022-09-21 22:35:43 INFO  ---RUNTIME: Multi-Query Optimization took 22.79806137084961 ms
2022-09-21 22:35:43 INFO  Executing generated plans
2022-09-21 22:38:09 INFO  ---RUNTIME: Execution took 145482.74779319763 ms
2022-09-21 22:38:09 INFO  Done!
2022-09-21 22:38:09 INFO  # Finished -- repetition 2 of 7 
2022-09-21 22:38:09 INFO  # Optimization benchmark for data_cleaning with args [['reviews', 'slow_loading', 'featurization_0', 'xgboost']] -- repetition 3 of 7
2022-09-21 22:38:09 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-21 22:38:09 INFO  Running instrumented original pipeline...
2022-09-21 22:38:09 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-21 22:38:09 INFO  ---RUNTIME: Importing and monkey-patching took 6.217479705810547 ms
2022-09-21 22:38:16 INFO  ---RUNTIME: Original pipeline execution took 7678.0290603637695 ms (excluding imports and monkey-patching)
2022-09-21 22:38:16 INFO  Starting execution of 1 what-if analyses...
2022-09-21 22:38:16 INFO  Start plan generation for analysis DataCleaning...
2022-09-21 22:38:16 INFO  ---RUNTIME: Plan generation took 0.5438327789306641 ms
2022-09-21 22:38:16 INFO  Estimated runtime of original DAG is 6037.029266357422ms
2022-09-21 22:38:16 INFO  Performing Multi-Query Optimization
2022-09-21 22:38:16 INFO  Estimated unoptimized what-if runtime is 120740.58532714844ms
2022-09-21 22:38:16 INFO  Estimated optimised what-if runtime is 32543.35308074951ms
2022-09-21 22:38:16 INFO  Estimated optimisation runtime saving is 88197.23224639893ms
2022-09-21 22:38:16 INFO  ---RUNTIME: Multi-Query Optimization took 88.45353126525879 ms
2022-09-21 22:38:16 INFO  Executing generated plans
2022-09-21 22:38:56 INFO  ---RUNTIME: Execution took 39937.08419799805 ms
2022-09-21 22:38:56 INFO  Done!
2022-09-21 22:38:56 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-21 22:38:56 INFO  Running instrumented original pipeline...
2022-09-21 22:38:56 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-21 22:38:56 INFO  ---RUNTIME: Importing and monkey-patching took 6.541252136230469 ms
2022-09-21 22:39:04 INFO  ---RUNTIME: Original pipeline execution took 7658.763885498047 ms (excluding imports and monkey-patching)
2022-09-21 22:39:04 INFO  Starting execution of 1 what-if analyses...
2022-09-21 22:39:04 INFO  Start plan generation for analysis DataCleaning...
2022-09-21 22:39:04 INFO  ---RUNTIME: Plan generation took 0.5412101745605469 ms
2022-09-21 22:39:04 INFO  Estimated runtime of original DAG is 6037.1527671813965ms
2022-09-21 22:39:04 WARNING Skipping Multi-Query Optimization (instead, only applying patches)
2022-09-21 22:39:04 WARNING Columns ['review_id'] not present in train DAG after the train test split, only before!
2022-09-21 22:39:04 WARNING This could hint at data leakage!
2022-09-21 22:39:04 INFO  Estimated unoptimised what-if runtime is 120743.05534362793ms
2022-09-21 22:39:04 INFO  ---RUNTIME: Multi-Query Optimization took 22.783756256103516 ms
2022-09-21 22:39:04 INFO  Executing generated plans
2022-09-21 22:41:32 INFO  ---RUNTIME: Execution took 147447.76272773743 ms
2022-09-21 22:41:32 INFO  Done!
2022-09-21 22:41:32 INFO  # Finished -- repetition 3 of 7 
2022-09-21 22:41:32 INFO  # Optimization benchmark for data_cleaning with args [['reviews', 'slow_loading', 'featurization_0', 'xgboost']] -- repetition 4 of 7
2022-09-21 22:41:32 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-21 22:41:32 INFO  Running instrumented original pipeline...
2022-09-21 22:41:32 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-21 22:41:32 INFO  ---RUNTIME: Importing and monkey-patching took 6.156444549560547 ms
2022-09-21 22:41:39 INFO  ---RUNTIME: Original pipeline execution took 7770.763397216797 ms (excluding imports and monkey-patching)
2022-09-21 22:41:39 INFO  Starting execution of 1 what-if analyses...
2022-09-21 22:41:39 INFO  Start plan generation for analysis DataCleaning...
2022-09-21 22:41:39 INFO  ---RUNTIME: Plan generation took 0.5321502685546875 ms
2022-09-21 22:41:39 INFO  Estimated runtime of original DAG is 6096.643686294556ms
2022-09-21 22:41:39 INFO  Performing Multi-Query Optimization
2022-09-21 22:41:39 INFO  Estimated unoptimized what-if runtime is 121932.87372589111ms
2022-09-21 22:41:39 INFO  Estimated optimised what-if runtime is 31800.633907318115ms
2022-09-21 22:41:39 INFO  Estimated optimisation runtime saving is 90132.239818573ms
2022-09-21 22:41:39 INFO  ---RUNTIME: Multi-Query Optimization took 87.87703514099121 ms
2022-09-21 22:41:39 INFO  Executing generated plans
2022-09-21 22:42:19 INFO  ---RUNTIME: Execution took 39703.31144332886 ms
2022-09-21 22:42:19 INFO  Done!
2022-09-21 22:42:19 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-21 22:42:19 INFO  Running instrumented original pipeline...
2022-09-21 22:42:19 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-21 22:42:19 INFO  ---RUNTIME: Importing and monkey-patching took 6.49571418762207 ms
2022-09-21 22:42:27 INFO  ---RUNTIME: Original pipeline execution took 7839.925527572632 ms (excluding imports and monkey-patching)
2022-09-21 22:42:27 INFO  Starting execution of 1 what-if analyses...
2022-09-21 22:42:27 INFO  Start plan generation for analysis DataCleaning...
2022-09-21 22:42:27 INFO  ---RUNTIME: Plan generation took 0.5352497100830078 ms
2022-09-21 22:42:27 INFO  Estimated runtime of original DAG is 6179.007053375244ms
2022-09-21 22:42:27 WARNING Skipping Multi-Query Optimization (instead, only applying patches)
2022-09-21 22:42:27 WARNING Columns ['review_id'] not present in train DAG after the train test split, only before!
2022-09-21 22:42:27 WARNING This could hint at data leakage!
2022-09-21 22:42:27 INFO  Estimated unoptimised what-if runtime is 123580.14106750488ms
2022-09-21 22:42:27 INFO  ---RUNTIME: Multi-Query Optimization took 22.533655166625977 ms
2022-09-21 22:42:27 INFO  Executing generated plans
2022-09-21 22:44:53 INFO  ---RUNTIME: Execution took 145870.5883026123 ms
2022-09-21 22:44:53 INFO  Done!
2022-09-21 22:44:53 INFO  # Finished -- repetition 4 of 7 
2022-09-21 22:44:53 INFO  # Optimization benchmark for data_cleaning with args [['reviews', 'slow_loading', 'featurization_0', 'xgboost']] -- repetition 5 of 7
2022-09-21 22:44:53 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-21 22:44:53 INFO  Running instrumented original pipeline...
2022-09-21 22:44:53 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-21 22:44:53 INFO  ---RUNTIME: Importing and monkey-patching took 6.487369537353516 ms
2022-09-21 22:45:01 INFO  ---RUNTIME: Original pipeline execution took 7696.0015296936035 ms (excluding imports and monkey-patching)
2022-09-21 22:45:01 INFO  Starting execution of 1 what-if analyses...
2022-09-21 22:45:01 INFO  Start plan generation for analysis DataCleaning...
2022-09-21 22:45:01 INFO  ---RUNTIME: Plan generation took 0.5729198455810547 ms
2022-09-21 22:45:01 INFO  Estimated runtime of original DAG is 6027.913570404053ms
2022-09-21 22:45:01 INFO  Performing Multi-Query Optimization
2022-09-21 22:45:01 INFO  Estimated unoptimized what-if runtime is 120558.27140808105ms
2022-09-21 22:45:01 INFO  Estimated optimised what-if runtime is 32377.252101898193ms
2022-09-21 22:45:01 INFO  Estimated optimisation runtime saving is 88181.01930618286ms
2022-09-21 22:45:01 INFO  ---RUNTIME: Multi-Query Optimization took 88.67454528808594 ms
2022-09-21 22:45:01 INFO  Executing generated plans
2022-09-21 22:45:41 INFO  ---RUNTIME: Execution took 39867.05780029297 ms
2022-09-21 22:45:41 INFO  Done!
2022-09-21 22:45:41 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-21 22:45:41 INFO  Running instrumented original pipeline...
2022-09-21 22:45:41 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-21 22:45:41 INFO  ---RUNTIME: Importing and monkey-patching took 6.078958511352539 ms
2022-09-21 22:45:48 INFO  ---RUNTIME: Original pipeline execution took 7676.3505935668945 ms (excluding imports and monkey-patching)
2022-09-21 22:45:48 INFO  Starting execution of 1 what-if analyses...
2022-09-21 22:45:48 INFO  Start plan generation for analysis DataCleaning...
2022-09-21 22:45:48 INFO  ---RUNTIME: Plan generation took 0.5283355712890625 ms
2022-09-21 22:45:48 INFO  Estimated runtime of original DAG is 6029.332399368286ms
2022-09-21 22:45:48 WARNING Skipping Multi-Query Optimization (instead, only applying patches)
2022-09-21 22:45:48 WARNING Columns ['review_id'] not present in train DAG after the train test split, only before!
2022-09-21 22:45:48 WARNING This could hint at data leakage!
2022-09-21 22:45:48 INFO  Estimated unoptimised what-if runtime is 120586.64798736572ms
2022-09-21 22:45:48 INFO  ---RUNTIME: Multi-Query Optimization took 22.629261016845703 ms
2022-09-21 22:45:48 INFO  Executing generated plans
2022-09-21 22:48:14 INFO  ---RUNTIME: Execution took 145511.9915008545 ms
2022-09-21 22:48:14 INFO  Done!
2022-09-21 22:48:14 INFO  # Finished -- repetition 5 of 7 
2022-09-21 22:48:14 INFO  # Optimization benchmark for data_cleaning with args [['reviews', 'slow_loading', 'featurization_0', 'xgboost']] -- repetition 6 of 7
2022-09-21 22:48:14 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-21 22:48:14 INFO  Running instrumented original pipeline...
2022-09-21 22:48:14 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-21 22:48:14 INFO  ---RUNTIME: Importing and monkey-patching took 6.4105987548828125 ms
2022-09-21 22:48:21 INFO  ---RUNTIME: Original pipeline execution took 7668.190956115723 ms (excluding imports and monkey-patching)
2022-09-21 22:48:21 INFO  Starting execution of 1 what-if analyses...
2022-09-21 22:48:21 INFO  Start plan generation for analysis DataCleaning...
2022-09-21 22:48:21 INFO  ---RUNTIME: Plan generation took 0.5559921264648438 ms
2022-09-21 22:48:21 INFO  Estimated runtime of original DAG is 6017.10319519043ms
2022-09-21 22:48:21 INFO  Performing Multi-Query Optimization
2022-09-21 22:48:22 INFO  Estimated unoptimized what-if runtime is 120342.0639038086ms
2022-09-21 22:48:22 INFO  Estimated optimised what-if runtime is 32475.240468978882ms
2022-09-21 22:48:22 INFO  Estimated optimisation runtime saving is 87866.82343482971ms
2022-09-21 22:48:22 INFO  ---RUNTIME: Multi-Query Optimization took 86.49873733520508 ms
2022-09-21 22:48:22 INFO  Executing generated plans
2022-09-21 22:49:01 INFO  ---RUNTIME: Execution took 39861.3064289093 ms
2022-09-21 22:49:01 INFO  Done!
2022-09-21 22:49:01 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-21 22:49:01 INFO  Running instrumented original pipeline...
2022-09-21 22:49:02 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-21 22:49:02 INFO  ---RUNTIME: Importing and monkey-patching took 5.971431732177734 ms
2022-09-21 22:49:09 INFO  ---RUNTIME: Original pipeline execution took 7962.587833404541 ms (excluding imports and monkey-patching)
2022-09-21 22:49:09 INFO  Starting execution of 1 what-if analyses...
2022-09-21 22:49:09 INFO  Start plan generation for analysis DataCleaning...
2022-09-21 22:49:09 INFO  ---RUNTIME: Plan generation took 0.6561279296875 ms
2022-09-21 22:49:09 INFO  Estimated runtime of original DAG is 6006.163597106934ms
2022-09-21 22:49:09 WARNING Skipping Multi-Query Optimization (instead, only applying patches)
2022-09-21 22:49:09 WARNING Columns ['review_id'] not present in train DAG after the train test split, only before!
2022-09-21 22:49:09 WARNING This could hint at data leakage!
2022-09-21 22:49:09 INFO  Estimated unoptimised what-if runtime is 120123.27194213867ms
2022-09-21 22:49:09 INFO  ---RUNTIME: Multi-Query Optimization took 22.372007369995117 ms
2022-09-21 22:49:09 INFO  Executing generated plans
2022-09-21 22:51:40 INFO  ---RUNTIME: Execution took 150639.24145698547 ms
2022-09-21 22:51:40 INFO  Done!
2022-09-21 22:51:40 INFO  # Finished -- repetition 6 of 7 
2022-09-21 22:51:40 INFO  # Optimization benchmark for data_cleaning with args [['reviews', 'slow_loading', 'featurization_0', 'xgboost']] -- repetition 7 of 7
2022-09-21 22:51:40 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-21 22:51:40 INFO  Running instrumented original pipeline...
2022-09-21 22:51:40 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-21 22:51:40 INFO  ---RUNTIME: Importing and monkey-patching took 6.126642227172852 ms
2022-09-21 22:51:48 INFO  ---RUNTIME: Original pipeline execution took 7947.419881820679 ms (excluding imports and monkey-patching)
2022-09-21 22:51:48 INFO  Starting execution of 1 what-if analyses...
2022-09-21 22:51:48 INFO  Start plan generation for analysis DataCleaning...
2022-09-21 22:51:48 INFO  ---RUNTIME: Plan generation took 0.5471706390380859 ms
2022-09-21 22:51:48 INFO  Estimated runtime of original DAG is 6263.837575912476ms
2022-09-21 22:51:48 INFO  Performing Multi-Query Optimization
2022-09-21 22:51:48 INFO  Estimated unoptimized what-if runtime is 125276.75151824951ms
2022-09-21 22:51:48 INFO  Estimated optimised what-if runtime is 33236.082553863525ms
2022-09-21 22:51:48 INFO  Estimated optimisation runtime saving is 92040.66896438599ms
2022-09-21 22:51:48 INFO  ---RUNTIME: Multi-Query Optimization took 87.06116676330566 ms
2022-09-21 22:51:48 INFO  Executing generated plans
2022-09-21 22:52:28 INFO  ---RUNTIME: Execution took 40126.94597244263 ms
2022-09-21 22:52:28 INFO  Done!
2022-09-21 22:52:28 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-21 22:52:28 INFO  Running instrumented original pipeline...
2022-09-21 22:52:28 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-21 22:52:28 INFO  ---RUNTIME: Importing and monkey-patching took 5.986213684082031 ms
2022-09-21 22:52:36 INFO  ---RUNTIME: Original pipeline execution took 7838.862180709839 ms (excluding imports and monkey-patching)
2022-09-21 22:52:36 INFO  Starting execution of 1 what-if analyses...
2022-09-21 22:52:36 INFO  Start plan generation for analysis DataCleaning...
2022-09-21 22:52:36 INFO  ---RUNTIME: Plan generation took 0.5359649658203125 ms
2022-09-21 22:52:36 INFO  Estimated runtime of original DAG is 6155.422687530518ms
2022-09-21 22:52:36 WARNING Skipping Multi-Query Optimization (instead, only applying patches)
2022-09-21 22:52:36 WARNING Columns ['review_id'] not present in train DAG after the train test split, only before!
2022-09-21 22:52:36 WARNING This could hint at data leakage!
2022-09-21 22:52:36 INFO  Estimated unoptimised what-if runtime is 123108.45375061035ms
2022-09-21 22:52:36 INFO  ---RUNTIME: Multi-Query Optimization took 22.396564483642578 ms
2022-09-21 22:52:36 INFO  Executing generated plans
2022-09-21 22:55:06 INFO  ---RUNTIME: Execution took 150426.0835647583 ms
2022-09-21 22:55:06 INFO  Done!
2022-09-21 22:55:06 INFO  # Finished -- repetition 7 of 7 
2022-09-21 22:55:06 INFO  # Final results after all repetitions
2022-09-21 22:55:06 INFO     repetition  ... no_opt_what_if_execution_combined_model_training
0           0  ...                                     15988.763094
1           1  ...                                     16043.451548
2           2  ...                                     15689.880610
3           3  ...                                     16064.138889
4           4  ...                                     15775.136709
5           5  ...                                     16259.704828
6           6  ...                                     15950.436115

[7 rows x 26 columns]
taskset -c 160-167 PROTOCOL_BUFFERS_PYTHON_IMPLEMENTATION=python python3.9 benchmarks_end_to_end.py data_cleaning reviews slow_loading featurization_0 neural_network
2022-09-21 22:55:09.167294: W tensorflow/stream_executor/platform/default/dso_loader.cc:64] Could not load dynamic library 'libcudart.so.11.0'; dlerror: libcudart.so.11.0: cannot open shared object file: No such file or directory; LD_LIBRARY_PATH: /home/sgrafbe/mlwhatif/venv/lib/python3.9/site-packages/cv2/../../lib64:
2022-09-21 22:55:09.167335: I tensorflow/stream_executor/cuda/cudart_stub.cc:29] Ignore above cudart dlerror if you do not have a GPU set up on your machine.
2022-09-21 22:55:10 INFO  Patching sys.argv with ['mlwhatif', 'reviews', 'slow_loading', 'featurization_0', 'neural_network']
2022-09-21 22:55:10 INFO  Running instrumented original pipeline...
2022-09-21 22:55:10 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-21 22:55:10 INFO  ---RUNTIME: Importing and monkey-patching took 95.46923637390137 ms
2022-09-21 22:55:16.214760: W tensorflow/stream_executor/platform/default/dso_loader.cc:64] Could not load dynamic library 'libcuda.so.1'; dlerror: libcuda.so.1: cannot open shared object file: No such file or directory; LD_LIBRARY_PATH: /home/sgrafbe/mlwhatif/venv/lib/python3.9/site-packages/cv2/../../lib64:
2022-09-21 22:55:16.214800: W tensorflow/stream_executor/cuda/cuda_driver.cc:326] failed call to cuInit: UNKNOWN ERROR (303)
2022-09-21 22:55:16.214822: I tensorflow/stream_executor/cuda/cuda_diagnostics.cc:156] kernel driver does not appear to be running on this host (wagyu): /proc/driver/nvidia/version does not exist
2022-09-21 22:55:16.215307: I tensorflow/core/platform/cpu_feature_guard.cc:142] This TensorFlow binary is optimized with oneAPI Deep Neural Network Library (oneDNN) to use the following CPU instructions in performance-critical operations:  AVX2 FMA
To enable them in other operations, rebuild TensorFlow with the appropriate compiler flags.
2022-09-21 22:55:16.291846: I tensorflow/compiler/mlir/mlir_graph_optimization_pass.cc:176] None of the MLIR Optimization Passes are enabled (registered 2)
2022-09-21 22:55:16.304388: I tensorflow/core/platform/profile_utils/cpu_utils.cc:114] CPU Frequency: 2595290000 Hz
2022-09-21 22:55:21 INFO  ---RUNTIME: Original pipeline execution took 11082.249879837036 ms (excluding imports and monkey-patching)
2022-09-21 22:55:21 INFO  Starting execution of 0 what-if analyses...
2022-09-21 22:55:21 INFO  Estimated runtime of original DAG is 9438.068151473999ms
2022-09-21 22:55:21 INFO  Performing Multi-Query Optimization
2022-09-21 22:55:21 INFO  Estimated unoptimized what-if runtime is 0ms
2022-09-21 22:55:21 INFO  Estimated optimised what-if runtime is 0ms
2022-09-21 22:55:21 INFO  Estimated optimisation runtime saving is 0ms
2022-09-21 22:55:21 INFO  ---RUNTIME: Multi-Query Optimization took 0.5042552947998047 ms
2022-09-21 22:55:21 INFO  Executing generated plans
2022-09-21 22:55:21 INFO  ---RUNTIME: Execution took 0.020503997802734375 ms
2022-09-21 22:55:21 INFO  Done!
2022-09-21 22:55:21 INFO  # Optimization benchmark for data_cleaning with args [['reviews', 'slow_loading', 'featurization_0', 'neural_network']] -- repetition 1 of 7
2022-09-21 22:55:21 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-21 22:55:21 INFO  Running instrumented original pipeline...
2022-09-21 22:55:21 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-21 22:55:21 INFO  ---RUNTIME: Importing and monkey-patching took 5.514383316040039 ms
2022-09-21 22:55:32 INFO  ---RUNTIME: Original pipeline execution took 10671.994924545288 ms (excluding imports and monkey-patching)
2022-09-21 22:55:32 INFO  Starting execution of 1 what-if analyses...
2022-09-21 22:55:32 INFO  Start plan generation for analysis DataCleaning...
2022-09-21 22:55:32 INFO  ---RUNTIME: Plan generation took 0.5567073822021484 ms
2022-09-21 22:55:32 INFO  Estimated runtime of original DAG is 9020.046710968018ms
2022-09-21 22:55:32 INFO  Performing Multi-Query Optimization
2022-09-21 22:55:32 INFO  Estimated unoptimized what-if runtime is 180400.93421936035ms
2022-09-21 22:55:32 INFO  Estimated optimised what-if runtime is 89683.47573280334ms
2022-09-21 22:55:32 INFO  Estimated optimisation runtime saving is 90717.458486557ms
2022-09-21 22:55:32 INFO  ---RUNTIME: Multi-Query Optimization took 89.3104076385498 ms
2022-09-21 22:55:32 INFO  Executing generated plans
2022-09-21 22:57:11 INFO  ---RUNTIME: Execution took 98700.8445262909 ms
2022-09-21 22:57:11 INFO  Done!
2022-09-21 22:57:11 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-21 22:57:11 INFO  Running instrumented original pipeline...
2022-09-21 22:57:11 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-21 22:57:11 INFO  ---RUNTIME: Importing and monkey-patching took 6.159543991088867 ms
2022-09-21 22:57:21 INFO  ---RUNTIME: Original pipeline execution took 10485.986948013306 ms (excluding imports and monkey-patching)
2022-09-21 22:57:21 INFO  Starting execution of 1 what-if analyses...
2022-09-21 22:57:21 INFO  Start plan generation for analysis DataCleaning...
2022-09-21 22:57:21 INFO  ---RUNTIME: Plan generation took 0.5536079406738281 ms
2022-09-21 22:57:21 INFO  Estimated runtime of original DAG is 8817.103862762451ms
2022-09-21 22:57:21 WARNING Skipping Multi-Query Optimization (instead, only applying patches)
2022-09-21 22:57:21 WARNING Columns ['review_id'] not present in train DAG after the train test split, only before!
2022-09-21 22:57:21 WARNING This could hint at data leakage!
2022-09-21 22:57:21 INFO  Estimated unoptimised what-if runtime is 176342.07725524902ms
2022-09-21 22:57:21 INFO  ---RUNTIME: Multi-Query Optimization took 22.8426456451416 ms
2022-09-21 22:57:21 INFO  Executing generated plans
2022-09-21 23:00:47 INFO  ---RUNTIME: Execution took 205620.63646316528 ms
2022-09-21 23:00:47 INFO  Done!
2022-09-21 23:00:47 INFO  # Finished -- repetition 1 of 7 
2022-09-21 23:00:47 INFO  # Optimization benchmark for data_cleaning with args [['reviews', 'slow_loading', 'featurization_0', 'neural_network']] -- repetition 2 of 7
2022-09-21 23:00:47 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-21 23:00:47 INFO  Running instrumented original pipeline...
2022-09-21 23:00:47 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-21 23:00:47 INFO  ---RUNTIME: Importing and monkey-patching took 5.83958625793457 ms
2022-09-21 23:00:58 INFO  ---RUNTIME: Original pipeline execution took 10620.82552909851 ms (excluding imports and monkey-patching)
2022-09-21 23:00:58 INFO  Starting execution of 1 what-if analyses...
2022-09-21 23:00:58 INFO  Start plan generation for analysis DataCleaning...
2022-09-21 23:00:58 INFO  ---RUNTIME: Plan generation took 0.5776882171630859 ms
2022-09-21 23:00:58 INFO  Estimated runtime of original DAG is 8958.52518081665ms
2022-09-21 23:00:58 INFO  Performing Multi-Query Optimization
2022-09-21 23:00:58 INFO  Estimated unoptimized what-if runtime is 179170.503616333ms
2022-09-21 23:00:58 INFO  Estimated optimised what-if runtime is 89937.89744377136ms
2022-09-21 23:00:58 INFO  Estimated optimisation runtime saving is 89232.60617256165ms
2022-09-21 23:00:58 INFO  ---RUNTIME: Multi-Query Optimization took 87.71300315856934 ms
2022-09-21 23:00:58 INFO  Executing generated plans
2022-09-21 23:02:36 INFO  ---RUNTIME: Execution took 98792.42992401123 ms
2022-09-21 23:02:36 INFO  Done!
2022-09-21 23:02:36 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-21 23:02:36 INFO  Running instrumented original pipeline...
2022-09-21 23:02:37 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-21 23:02:37 INFO  ---RUNTIME: Importing and monkey-patching took 8.799076080322266 ms
2022-09-21 23:02:47 INFO  ---RUNTIME: Original pipeline execution took 10664.204597473145 ms (excluding imports and monkey-patching)
2022-09-21 23:02:47 INFO  Starting execution of 1 what-if analyses...
2022-09-21 23:02:47 INFO  Start plan generation for analysis DataCleaning...
2022-09-21 23:02:47 INFO  ---RUNTIME: Plan generation took 0.5059242248535156 ms
2022-09-21 23:02:47 INFO  Estimated runtime of original DAG is 9048.655033111572ms
2022-09-21 23:02:47 WARNING Skipping Multi-Query Optimization (instead, only applying patches)
2022-09-21 23:02:47 WARNING Columns ['review_id'] not present in train DAG after the train test split, only before!
2022-09-21 23:02:47 WARNING This could hint at data leakage!
2022-09-21 23:02:47 INFO  Estimated unoptimised what-if runtime is 180973.10066223145ms
2022-09-21 23:02:47 INFO  ---RUNTIME: Multi-Query Optimization took 24.361133575439453 ms
2022-09-21 23:02:47 INFO  Executing generated plans
2022-09-21 23:06:15 INFO  ---RUNTIME: Execution took 207378.48091125488 ms
2022-09-21 23:06:15 INFO  Done!
2022-09-21 23:06:15 INFO  # Finished -- repetition 2 of 7 
2022-09-21 23:06:15 INFO  # Optimization benchmark for data_cleaning with args [['reviews', 'slow_loading', 'featurization_0', 'neural_network']] -- repetition 3 of 7
2022-09-21 23:06:15 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-21 23:06:15 INFO  Running instrumented original pipeline...
2022-09-21 23:06:15 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-21 23:06:15 INFO  ---RUNTIME: Importing and monkey-patching took 5.946874618530273 ms
2022-09-21 23:06:25 INFO  ---RUNTIME: Original pipeline execution took 10725.925207138062 ms (excluding imports and monkey-patching)
2022-09-21 23:06:25 INFO  Starting execution of 1 what-if analyses...
2022-09-21 23:06:25 INFO  Start plan generation for analysis DataCleaning...
2022-09-21 23:06:25 INFO  ---RUNTIME: Plan generation took 0.5304813385009766 ms
2022-09-21 23:06:25 INFO  Estimated runtime of original DAG is 8950.629472732544ms
2022-09-21 23:06:25 INFO  Performing Multi-Query Optimization
2022-09-21 23:06:25 INFO  Estimated unoptimized what-if runtime is 179012.58945465088ms
2022-09-21 23:06:25 INFO  Estimated optimised what-if runtime is 88740.7763004303ms
2022-09-21 23:06:25 INFO  Estimated optimisation runtime saving is 90271.81315422058ms
2022-09-21 23:06:25 INFO  ---RUNTIME: Multi-Query Optimization took 87.73064613342285 ms
2022-09-21 23:06:25 INFO  Executing generated plans
2022-09-21 23:08:04 INFO  ---RUNTIME: Execution took 98166.66841506958 ms
2022-09-21 23:08:04 INFO  Done!
2022-09-21 23:08:04 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-21 23:08:04 INFO  Running instrumented original pipeline...
2022-09-21 23:08:04 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-21 23:08:04 INFO  ---RUNTIME: Importing and monkey-patching took 5.870580673217773 ms
2022-09-21 23:08:15 INFO  ---RUNTIME: Original pipeline execution took 11416.975498199463 ms (excluding imports and monkey-patching)
2022-09-21 23:08:15 INFO  Starting execution of 1 what-if analyses...
2022-09-21 23:08:15 INFO  Start plan generation for analysis DataCleaning...
2022-09-21 23:08:15 INFO  ---RUNTIME: Plan generation took 0.5624294281005859 ms
2022-09-21 23:08:15 INFO  Estimated runtime of original DAG is 9802.287101745605ms
2022-09-21 23:08:15 WARNING Skipping Multi-Query Optimization (instead, only applying patches)
2022-09-21 23:08:15 WARNING Columns ['review_id'] not present in train DAG after the train test split, only before!
2022-09-21 23:08:15 WARNING This could hint at data leakage!
2022-09-21 23:08:15 INFO  Estimated unoptimised what-if runtime is 196045.7420349121ms
2022-09-21 23:08:15 INFO  ---RUNTIME: Multi-Query Optimization took 22.704601287841797 ms
2022-09-21 23:08:15 INFO  Executing generated plans
2022-09-21 23:11:42 INFO  ---RUNTIME: Execution took 206832.60941505432 ms
2022-09-21 23:11:42 INFO  Done!
2022-09-21 23:11:42 INFO  # Finished -- repetition 3 of 7 
2022-09-21 23:11:42 INFO  # Optimization benchmark for data_cleaning with args [['reviews', 'slow_loading', 'featurization_0', 'neural_network']] -- repetition 4 of 7
2022-09-21 23:11:42 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-21 23:11:42 INFO  Running instrumented original pipeline...
2022-09-21 23:11:42 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-21 23:11:42 INFO  ---RUNTIME: Importing and monkey-patching took 6.257057189941406 ms
2022-09-21 23:11:53 INFO  ---RUNTIME: Original pipeline execution took 11042.624711990356 ms (excluding imports and monkey-patching)
2022-09-21 23:11:53 INFO  Starting execution of 1 what-if analyses...
2022-09-21 23:11:53 INFO  Start plan generation for analysis DataCleaning...
2022-09-21 23:11:53 INFO  ---RUNTIME: Plan generation took 2.0127296447753906 ms
2022-09-21 23:11:53 INFO  Estimated runtime of original DAG is 9322.921514511108ms
2022-09-21 23:11:53 INFO  Performing Multi-Query Optimization
2022-09-21 23:11:53 INFO  Estimated unoptimized what-if runtime is 186458.43029022217ms
2022-09-21 23:11:53 INFO  Estimated optimised what-if runtime is 96510.89334487915ms
2022-09-21 23:11:53 INFO  Estimated optimisation runtime saving is 89947.53694534302ms
2022-09-21 23:11:53 INFO  ---RUNTIME: Multi-Query Optimization took 86.75074577331543 ms
2022-09-21 23:11:53 INFO  Executing generated plans
2022-09-21 23:13:31 INFO  ---RUNTIME: Execution took 97674.65114593506 ms
2022-09-21 23:13:31 INFO  Done!
2022-09-21 23:13:31 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-21 23:13:31 INFO  Running instrumented original pipeline...
2022-09-21 23:13:31 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-21 23:13:31 INFO  ---RUNTIME: Importing and monkey-patching took 5.908012390136719 ms
2022-09-21 23:13:42 INFO  ---RUNTIME: Original pipeline execution took 10954.254388809204 ms (excluding imports and monkey-patching)
2022-09-21 23:13:42 INFO  Starting execution of 1 what-if analyses...
2022-09-21 23:13:42 INFO  Start plan generation for analysis DataCleaning...
2022-09-21 23:13:42 INFO  ---RUNTIME: Plan generation took 2.097606658935547 ms
2022-09-21 23:13:42 INFO  Estimated runtime of original DAG is 9272.250175476074ms
2022-09-21 23:13:42 WARNING Skipping Multi-Query Optimization (instead, only applying patches)
2022-09-21 23:13:42 WARNING Columns ['review_id'] not present in train DAG after the train test split, only before!
2022-09-21 23:13:42 WARNING This could hint at data leakage!
2022-09-21 23:13:42 INFO  Estimated unoptimised what-if runtime is 185445.00350952148ms
2022-09-21 23:13:42 INFO  ---RUNTIME: Multi-Query Optimization took 22.45783805847168 ms
2022-09-21 23:13:42 INFO  Executing generated plans
2022-09-21 23:17:08 INFO  ---RUNTIME: Execution took 206382.73763656616 ms
2022-09-21 23:17:08 INFO  Done!
2022-09-21 23:17:08 INFO  # Finished -- repetition 4 of 7 
2022-09-21 23:17:08 INFO  # Optimization benchmark for data_cleaning with args [['reviews', 'slow_loading', 'featurization_0', 'neural_network']] -- repetition 5 of 7
2022-09-21 23:17:08 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-21 23:17:08 INFO  Running instrumented original pipeline...
2022-09-21 23:17:08 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-21 23:17:08 INFO  ---RUNTIME: Importing and monkey-patching took 5.921602249145508 ms
2022-09-21 23:17:18 INFO  ---RUNTIME: Original pipeline execution took 10419.608116149902 ms (excluding imports and monkey-patching)
2022-09-21 23:17:18 INFO  Starting execution of 1 what-if analyses...
2022-09-21 23:17:18 INFO  Start plan generation for analysis DataCleaning...
2022-09-21 23:17:18 INFO  ---RUNTIME: Plan generation took 0.5166530609130859 ms
2022-09-21 23:17:18 INFO  Estimated runtime of original DAG is 8741.665840148926ms
2022-09-21 23:17:18 INFO  Performing Multi-Query Optimization
2022-09-21 23:17:19 INFO  Estimated unoptimized what-if runtime is 174833.31680297852ms
2022-09-21 23:17:19 INFO  Estimated optimised what-if runtime is 87265.77734947205ms
2022-09-21 23:17:19 INFO  Estimated optimisation runtime saving is 87567.53945350647ms
2022-09-21 23:17:19 INFO  ---RUNTIME: Multi-Query Optimization took 88.38105201721191 ms
2022-09-21 23:17:19 INFO  Executing generated plans
2022-09-21 23:18:57 INFO  ---RUNTIME: Execution took 98945.52946090698 ms
2022-09-21 23:18:57 INFO  Done!
2022-09-21 23:18:57 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-21 23:18:57 INFO  Running instrumented original pipeline...
2022-09-21 23:18:58 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-21 23:18:58 INFO  ---RUNTIME: Importing and monkey-patching took 6.159543991088867 ms
2022-09-21 23:19:08 INFO  ---RUNTIME: Original pipeline execution took 10746.540546417236 ms (excluding imports and monkey-patching)
2022-09-21 23:19:08 INFO  Starting execution of 1 what-if analyses...
2022-09-21 23:19:08 INFO  Start plan generation for analysis DataCleaning...
2022-09-21 23:19:08 INFO  ---RUNTIME: Plan generation took 0.7543563842773438 ms
2022-09-21 23:19:08 INFO  Estimated runtime of original DAG is 9117.968797683716ms
2022-09-21 23:19:08 WARNING Skipping Multi-Query Optimization (instead, only applying patches)
2022-09-21 23:19:08 WARNING Columns ['review_id'] not present in train DAG after the train test split, only before!
2022-09-21 23:19:08 WARNING This could hint at data leakage!
2022-09-21 23:19:08 INFO  Estimated unoptimised what-if runtime is 182359.37595367432ms
2022-09-21 23:19:08 INFO  ---RUNTIME: Multi-Query Optimization took 26.145458221435547 ms
2022-09-21 23:19:08 INFO  Executing generated plans
2022-09-21 23:22:35 INFO  ---RUNTIME: Execution took 206519.7308063507 ms
2022-09-21 23:22:35 INFO  Done!
2022-09-21 23:22:35 INFO  # Finished -- repetition 5 of 7 
2022-09-21 23:22:35 INFO  # Optimization benchmark for data_cleaning with args [['reviews', 'slow_loading', 'featurization_0', 'neural_network']] -- repetition 6 of 7
2022-09-21 23:22:35 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-21 23:22:35 INFO  Running instrumented original pipeline...
2022-09-21 23:22:35 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-21 23:22:35 INFO  ---RUNTIME: Importing and monkey-patching took 5.848884582519531 ms
2022-09-21 23:22:46 INFO  ---RUNTIME: Original pipeline execution took 10941.978931427002 ms (excluding imports and monkey-patching)
2022-09-21 23:22:46 INFO  Starting execution of 1 what-if analyses...
2022-09-21 23:22:46 INFO  Start plan generation for analysis DataCleaning...
2022-09-21 23:22:46 INFO  ---RUNTIME: Plan generation took 0.5595684051513672 ms
2022-09-21 23:22:46 INFO  Estimated runtime of original DAG is 9189.870357513428ms
2022-09-21 23:22:46 INFO  Performing Multi-Query Optimization
2022-09-21 23:22:46 INFO  Estimated unoptimized what-if runtime is 183797.40715026855ms
2022-09-21 23:22:46 INFO  Estimated optimised what-if runtime is 93827.48007774353ms
2022-09-21 23:22:46 INFO  Estimated optimisation runtime saving is 89969.92707252502ms
2022-09-21 23:22:46 INFO  ---RUNTIME: Multi-Query Optimization took 93.7197208404541 ms
2022-09-21 23:22:46 INFO  Executing generated plans
2022-09-21 23:24:24 INFO  ---RUNTIME: Execution took 98429.6703338623 ms
2022-09-21 23:24:24 INFO  Done!
2022-09-21 23:24:24 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-21 23:24:24 INFO  Running instrumented original pipeline...
2022-09-21 23:24:24 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-21 23:24:24 INFO  ---RUNTIME: Importing and monkey-patching took 6.484270095825195 ms
2022-09-21 23:24:35 INFO  ---RUNTIME: Original pipeline execution took 10689.745664596558 ms (excluding imports and monkey-patching)
2022-09-21 23:24:35 INFO  Starting execution of 1 what-if analyses...
2022-09-21 23:24:35 INFO  Start plan generation for analysis DataCleaning...
2022-09-21 23:24:35 INFO  ---RUNTIME: Plan generation took 0.5586147308349609 ms
2022-09-21 23:24:35 INFO  Estimated runtime of original DAG is 9061.81788444519ms
2022-09-21 23:24:35 WARNING Skipping Multi-Query Optimization (instead, only applying patches)
2022-09-21 23:24:35 WARNING Columns ['review_id'] not present in train DAG after the train test split, only before!
2022-09-21 23:24:35 WARNING This could hint at data leakage!
2022-09-21 23:24:35 INFO  Estimated unoptimised what-if runtime is 181236.3576889038ms
2022-09-21 23:24:35 INFO  ---RUNTIME: Multi-Query Optimization took 24.161577224731445 ms
2022-09-21 23:24:35 INFO  Executing generated plans
2022-09-21 23:28:01 INFO  ---RUNTIME: Execution took 205506.29377365112 ms
2022-09-21 23:28:01 INFO  Done!
2022-09-21 23:28:01 INFO  # Finished -- repetition 6 of 7 
2022-09-21 23:28:01 INFO  # Optimization benchmark for data_cleaning with args [['reviews', 'slow_loading', 'featurization_0', 'neural_network']] -- repetition 7 of 7
2022-09-21 23:28:01 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-21 23:28:01 INFO  Running instrumented original pipeline...
2022-09-21 23:28:01 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-21 23:28:01 INFO  ---RUNTIME: Importing and monkey-patching took 6.362676620483398 ms
2022-09-21 23:28:11 INFO  ---RUNTIME: Original pipeline execution took 10843.244791030884 ms (excluding imports and monkey-patching)
2022-09-21 23:28:11 INFO  Starting execution of 1 what-if analyses...
2022-09-21 23:28:11 INFO  Start plan generation for analysis DataCleaning...
2022-09-21 23:28:11 INFO  ---RUNTIME: Plan generation took 0.5333423614501953 ms
2022-09-21 23:28:11 INFO  Estimated runtime of original DAG is 9116.323709487915ms
2022-09-21 23:28:11 INFO  Performing Multi-Query Optimization
2022-09-21 23:28:11 INFO  Estimated unoptimized what-if runtime is 182326.4741897583ms
2022-09-21 23:28:11 INFO  Estimated optimised what-if runtime is 91588.49239349365ms
2022-09-21 23:28:11 INFO  Estimated optimisation runtime saving is 90737.98179626465ms
2022-09-21 23:28:11 INFO  ---RUNTIME: Multi-Query Optimization took 88.6228084564209 ms
2022-09-21 23:28:11 INFO  Executing generated plans
2022-09-21 23:29:50 INFO  ---RUNTIME: Execution took 98608.28757286072 ms
2022-09-21 23:29:50 INFO  Done!
2022-09-21 23:29:50 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-21 23:29:50 INFO  Running instrumented original pipeline...
2022-09-21 23:29:50 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-21 23:29:50 INFO  ---RUNTIME: Importing and monkey-patching took 6.25300407409668 ms
2022-09-21 23:30:01 INFO  ---RUNTIME: Original pipeline execution took 10525.346994400024 ms (excluding imports and monkey-patching)
2022-09-21 23:30:01 INFO  Starting execution of 1 what-if analyses...
2022-09-21 23:30:01 INFO  Start plan generation for analysis DataCleaning...
2022-09-21 23:30:01 INFO  ---RUNTIME: Plan generation took 0.5176067352294922 ms
2022-09-21 23:30:01 INFO  Estimated runtime of original DAG is 8807.99150466919ms
2022-09-21 23:30:01 WARNING Skipping Multi-Query Optimization (instead, only applying patches)
2022-09-21 23:30:01 WARNING Columns ['review_id'] not present in train DAG after the train test split, only before!
2022-09-21 23:30:01 WARNING This could hint at data leakage!
2022-09-21 23:30:01 INFO  Estimated unoptimised what-if runtime is 176159.8300933838ms
2022-09-21 23:30:01 INFO  ---RUNTIME: Multi-Query Optimization took 23.401975631713867 ms
2022-09-21 23:30:01 INFO  Executing generated plans
2022-09-21 23:33:28 INFO  ---RUNTIME: Execution took 207757.84492492676 ms
2022-09-21 23:33:28 INFO  Done!
2022-09-21 23:33:28 INFO  # Finished -- repetition 7 of 7 
2022-09-21 23:33:28 INFO  # Final results after all repetitions
2022-09-21 23:33:28 INFO     repetition  ... no_opt_what_if_execution_combined_model_training
0           0  ...                                     66931.440353
1           1  ...                                     66336.735249
2           2  ...                                     67376.388073
3           3  ...                                     65807.207108
4           4  ...                                     68054.915190
5           5  ...                                     67033.677578
6           6  ...                                     67958.401442

[7 rows x 26 columns]
taskset -c 160-167 PROTOCOL_BUFFERS_PYTHON_IMPLEMENTATION=python python3.9 benchmarks_end_to_end.py data_cleaning reviews slow_loading featurization_1 logistic_regression
2022-09-21 23:33:31.149039: W tensorflow/stream_executor/platform/default/dso_loader.cc:64] Could not load dynamic library 'libcudart.so.11.0'; dlerror: libcudart.so.11.0: cannot open shared object file: No such file or directory; LD_LIBRARY_PATH: /home/sgrafbe/mlwhatif/venv/lib/python3.9/site-packages/cv2/../../lib64:
2022-09-21 23:33:31.149083: I tensorflow/stream_executor/cuda/cudart_stub.cc:29] Ignore above cudart dlerror if you do not have a GPU set up on your machine.
2022-09-21 23:33:32 INFO  Patching sys.argv with ['mlwhatif', 'reviews', 'slow_loading', 'featurization_1', 'logistic_regression']
2022-09-21 23:33:32 INFO  Running instrumented original pipeline...
2022-09-21 23:33:32 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-21 23:33:32 INFO  ---RUNTIME: Importing and monkey-patching took 96.44079208374023 ms
2022-09-21 23:33:40 INFO  ---RUNTIME: Original pipeline execution took 7820.1799392700195 ms (excluding imports and monkey-patching)
2022-09-21 23:33:40 INFO  Starting execution of 0 what-if analyses...
2022-09-21 23:33:40 INFO  Estimated runtime of original DAG is 5551.914215087891ms
2022-09-21 23:33:40 INFO  Performing Multi-Query Optimization
2022-09-21 23:33:40 INFO  Estimated unoptimized what-if runtime is 0ms
2022-09-21 23:33:40 INFO  Estimated optimised what-if runtime is 0ms
2022-09-21 23:33:40 INFO  Estimated optimisation runtime saving is 0ms
2022-09-21 23:33:40 INFO  ---RUNTIME: Multi-Query Optimization took 0.5095005035400391 ms
2022-09-21 23:33:40 INFO  Executing generated plans
2022-09-21 23:33:40 INFO  ---RUNTIME: Execution took 0.02288818359375 ms
2022-09-21 23:33:40 INFO  Done!
2022-09-21 23:33:40 INFO  # Optimization benchmark for data_cleaning with args [['reviews', 'slow_loading', 'featurization_1', 'logistic_regression']] -- repetition 1 of 7
2022-09-21 23:33:40 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-21 23:33:40 INFO  Running instrumented original pipeline...
2022-09-21 23:33:40 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-21 23:33:40 INFO  ---RUNTIME: Importing and monkey-patching took 5.945682525634766 ms
2022-09-21 23:33:48 INFO  ---RUNTIME: Original pipeline execution took 7699.69630241394 ms (excluding imports and monkey-patching)
2022-09-21 23:33:48 INFO  Starting execution of 1 what-if analyses...
2022-09-21 23:33:48 INFO  Start plan generation for analysis DataCleaning...
2022-09-21 23:33:48 INFO  ---RUNTIME: Plan generation took 0.7023811340332031 ms
2022-09-21 23:33:48 INFO  Estimated runtime of original DAG is 5488.8951778411865ms
2022-09-21 23:33:48 INFO  Performing Multi-Query Optimization
2022-09-21 23:33:48 INFO  Estimated unoptimized what-if runtime is 109777.90355682373ms
2022-09-21 23:33:48 INFO  Estimated optimised what-if runtime is 20824.345111846924ms
2022-09-21 23:33:48 INFO  Estimated optimisation runtime saving is 88953.5584449768ms
2022-09-21 23:33:48 INFO  ---RUNTIME: Multi-Query Optimization took 102.7522087097168 ms
2022-09-21 23:33:48 INFO  Executing generated plans
2022-09-21 23:34:14 INFO  ---RUNTIME: Execution took 26655.595064163208 ms
2022-09-21 23:34:14 INFO  Done!
2022-09-21 23:34:14 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-21 23:34:14 INFO  Running instrumented original pipeline...
2022-09-21 23:34:14 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-21 23:34:14 INFO  ---RUNTIME: Importing and monkey-patching took 6.51097297668457 ms
2022-09-21 23:34:22 INFO  ---RUNTIME: Original pipeline execution took 7679.044008255005 ms (excluding imports and monkey-patching)
2022-09-21 23:34:22 INFO  Starting execution of 1 what-if analyses...
2022-09-21 23:34:22 INFO  Start plan generation for analysis DataCleaning...
2022-09-21 23:34:22 INFO  ---RUNTIME: Plan generation took 0.66375732421875 ms
2022-09-21 23:34:22 INFO  Estimated runtime of original DAG is 5458.688735961914ms
2022-09-21 23:34:22 WARNING Skipping Multi-Query Optimization (instead, only applying patches)
2022-09-21 23:34:22 WARNING Columns ['review_id'] not present in train DAG after the train test split, only before!
2022-09-21 23:34:22 WARNING This could hint at data leakage!
2022-09-21 23:34:22 INFO  Estimated unoptimised what-if runtime is 109173.77471923828ms
2022-09-21 23:34:22 INFO  ---RUNTIME: Multi-Query Optimization took 24.178028106689453 ms
2022-09-21 23:34:22 INFO  Executing generated plans
2022-09-21 23:36:36 INFO  ---RUNTIME: Execution took 134201.95627212524 ms
2022-09-21 23:36:36 INFO  Done!
2022-09-21 23:36:36 INFO  # Finished -- repetition 1 of 7 
2022-09-21 23:36:36 INFO  # Optimization benchmark for data_cleaning with args [['reviews', 'slow_loading', 'featurization_1', 'logistic_regression']] -- repetition 2 of 7
2022-09-21 23:36:36 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-21 23:36:36 INFO  Running instrumented original pipeline...
2022-09-21 23:36:36 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-21 23:36:36 INFO  ---RUNTIME: Importing and monkey-patching took 6.417036056518555 ms
2022-09-21 23:36:44 INFO  ---RUNTIME: Original pipeline execution took 7804.455995559692 ms (excluding imports and monkey-patching)
2022-09-21 23:36:44 INFO  Starting execution of 1 what-if analyses...
2022-09-21 23:36:44 INFO  Start plan generation for analysis DataCleaning...
2022-09-21 23:36:44 INFO  ---RUNTIME: Plan generation took 0.6647109985351562 ms
2022-09-21 23:36:44 INFO  Estimated runtime of original DAG is 5480.178594589233ms
2022-09-21 23:36:44 INFO  Performing Multi-Query Optimization
2022-09-21 23:36:44 INFO  Estimated unoptimized what-if runtime is 109603.57189178467ms
2022-09-21 23:36:44 INFO  Estimated optimised what-if runtime is 20059.487104415894ms
2022-09-21 23:36:44 INFO  Estimated optimisation runtime saving is 89544.08478736877ms
2022-09-21 23:36:44 INFO  ---RUNTIME: Multi-Query Optimization took 95.88241577148438 ms
2022-09-21 23:36:44 INFO  Executing generated plans
2022-09-21 23:37:11 INFO  ---RUNTIME: Execution took 26587.783336639404 ms
2022-09-21 23:37:11 INFO  Done!
2022-09-21 23:37:11 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-21 23:37:11 INFO  Running instrumented original pipeline...
2022-09-21 23:37:11 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-21 23:37:11 INFO  ---RUNTIME: Importing and monkey-patching took 7.125139236450195 ms
2022-09-21 23:37:18 INFO  ---RUNTIME: Original pipeline execution took 7623.24333190918 ms (excluding imports and monkey-patching)
2022-09-21 23:37:18 INFO  Starting execution of 1 what-if analyses...
2022-09-21 23:37:18 INFO  Start plan generation for analysis DataCleaning...
2022-09-21 23:37:18 INFO  ---RUNTIME: Plan generation took 0.7107257843017578 ms
2022-09-21 23:37:18 INFO  Estimated runtime of original DAG is 5411.764860153198ms
2022-09-21 23:37:18 WARNING Skipping Multi-Query Optimization (instead, only applying patches)
2022-09-21 23:37:18 WARNING Columns ['review_id'] not present in train DAG after the train test split, only before!
2022-09-21 23:37:18 WARNING This could hint at data leakage!
2022-09-21 23:37:18 INFO  Estimated unoptimised what-if runtime is 108235.29720306396ms
2022-09-21 23:37:18 INFO  ---RUNTIME: Multi-Query Optimization took 24.40166473388672 ms
2022-09-21 23:37:18 INFO  Executing generated plans
2022-09-21 23:39:32 INFO  ---RUNTIME: Execution took 133827.3696899414 ms
2022-09-21 23:39:32 INFO  Done!
2022-09-21 23:39:32 INFO  # Finished -- repetition 2 of 7 
2022-09-21 23:39:32 INFO  # Optimization benchmark for data_cleaning with args [['reviews', 'slow_loading', 'featurization_1', 'logistic_regression']] -- repetition 3 of 7
2022-09-21 23:39:32 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-21 23:39:32 INFO  Running instrumented original pipeline...
2022-09-21 23:39:32 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-21 23:39:32 INFO  ---RUNTIME: Importing and monkey-patching took 6.452798843383789 ms
2022-09-21 23:39:40 INFO  ---RUNTIME: Original pipeline execution took 7812.243938446045 ms (excluding imports and monkey-patching)
2022-09-21 23:39:40 INFO  Starting execution of 1 what-if analyses...
2022-09-21 23:39:40 INFO  Start plan generation for analysis DataCleaning...
2022-09-21 23:39:40 INFO  ---RUNTIME: Plan generation took 0.6611347198486328 ms
2022-09-21 23:39:40 INFO  Estimated runtime of original DAG is 5540.850639343262ms
2022-09-21 23:39:40 INFO  Performing Multi-Query Optimization
2022-09-21 23:39:40 INFO  Estimated unoptimized what-if runtime is 110817.01278686523ms
2022-09-21 23:39:40 INFO  Estimated optimised what-if runtime is 19616.345643997192ms
2022-09-21 23:39:40 INFO  Estimated optimisation runtime saving is 91200.66714286804ms
2022-09-21 23:39:40 INFO  ---RUNTIME: Multi-Query Optimization took 95.31211853027344 ms
2022-09-21 23:39:40 INFO  Executing generated plans
2022-09-21 23:40:07 INFO  ---RUNTIME: Execution took 26885.558128356934 ms
2022-09-21 23:40:07 INFO  Done!
2022-09-21 23:40:07 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-21 23:40:07 INFO  Running instrumented original pipeline...
2022-09-21 23:40:07 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-21 23:40:07 INFO  ---RUNTIME: Importing and monkey-patching took 6.051778793334961 ms
2022-09-21 23:40:15 INFO  ---RUNTIME: Original pipeline execution took 8051.347970962524 ms (excluding imports and monkey-patching)
2022-09-21 23:40:15 INFO  Starting execution of 1 what-if analyses...
2022-09-21 23:40:15 INFO  Start plan generation for analysis DataCleaning...
2022-09-21 23:40:15 INFO  ---RUNTIME: Plan generation took 0.7016658782958984 ms
2022-09-21 23:40:15 INFO  Estimated runtime of original DAG is 5537.400007247925ms
2022-09-21 23:40:15 WARNING Skipping Multi-Query Optimization (instead, only applying patches)
2022-09-21 23:40:15 WARNING Columns ['review_id'] not present in train DAG after the train test split, only before!
2022-09-21 23:40:15 WARNING This could hint at data leakage!
2022-09-21 23:40:15 INFO  Estimated unoptimised what-if runtime is 110748.0001449585ms
2022-09-21 23:40:15 INFO  ---RUNTIME: Multi-Query Optimization took 25.799274444580078 ms
2022-09-21 23:40:15 INFO  Executing generated plans
2022-09-21 23:42:31 INFO  ---RUNTIME: Execution took 135527.78553962708 ms
2022-09-21 23:42:31 INFO  Done!
2022-09-21 23:42:31 INFO  # Finished -- repetition 3 of 7 
2022-09-21 23:42:31 INFO  # Optimization benchmark for data_cleaning with args [['reviews', 'slow_loading', 'featurization_1', 'logistic_regression']] -- repetition 4 of 7
2022-09-21 23:42:31 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-21 23:42:31 INFO  Running instrumented original pipeline...
2022-09-21 23:42:31 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-21 23:42:31 INFO  ---RUNTIME: Importing and monkey-patching took 7.7762603759765625 ms
2022-09-21 23:42:38 INFO  ---RUNTIME: Original pipeline execution took 7735.4021072387695 ms (excluding imports and monkey-patching)
2022-09-21 23:42:38 INFO  Starting execution of 1 what-if analyses...
2022-09-21 23:42:38 INFO  Start plan generation for analysis DataCleaning...
2022-09-21 23:42:38 INFO  ---RUNTIME: Plan generation took 0.7040500640869141 ms
2022-09-21 23:42:38 INFO  Estimated runtime of original DAG is 5482.630252838135ms
2022-09-21 23:42:38 INFO  Performing Multi-Query Optimization
2022-09-21 23:42:38 INFO  Estimated unoptimized what-if runtime is 109652.6050567627ms
2022-09-21 23:42:38 INFO  Estimated optimised what-if runtime is 19535.353422164917ms
2022-09-21 23:42:38 INFO  Estimated optimisation runtime saving is 90117.25163459778ms
2022-09-21 23:42:38 INFO  ---RUNTIME: Multi-Query Optimization took 95.51429748535156 ms
2022-09-21 23:42:38 INFO  Executing generated plans
2022-09-21 23:43:05 INFO  ---RUNTIME: Execution took 26665.34376144409 ms
2022-09-21 23:43:05 INFO  Done!
2022-09-21 23:43:05 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-21 23:43:05 INFO  Running instrumented original pipeline...
2022-09-21 23:43:05 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-21 23:43:05 INFO  ---RUNTIME: Importing and monkey-patching took 6.150245666503906 ms
2022-09-21 23:43:13 INFO  ---RUNTIME: Original pipeline execution took 7796.8590259552 ms (excluding imports and monkey-patching)
2022-09-21 23:43:13 INFO  Starting execution of 1 what-if analyses...
2022-09-21 23:43:13 INFO  Start plan generation for analysis DataCleaning...
2022-09-21 23:43:13 INFO  ---RUNTIME: Plan generation took 0.6952285766601562 ms
2022-09-21 23:43:13 INFO  Estimated runtime of original DAG is 5507.701873779297ms
2022-09-21 23:43:13 WARNING Skipping Multi-Query Optimization (instead, only applying patches)
2022-09-21 23:43:13 WARNING Columns ['review_id'] not present in train DAG after the train test split, only before!
2022-09-21 23:43:13 WARNING This could hint at data leakage!
2022-09-21 23:43:13 INFO  Estimated unoptimised what-if runtime is 110154.03747558594ms
2022-09-21 23:43:13 INFO  ---RUNTIME: Multi-Query Optimization took 24.86133575439453 ms
2022-09-21 23:43:13 INFO  Executing generated plans
2022-09-21 23:45:27 INFO  ---RUNTIME: Execution took 134345.02935409546 ms
2022-09-21 23:45:27 INFO  Done!
2022-09-21 23:45:27 INFO  # Finished -- repetition 4 of 7 
2022-09-21 23:45:27 INFO  # Optimization benchmark for data_cleaning with args [['reviews', 'slow_loading', 'featurization_1', 'logistic_regression']] -- repetition 5 of 7
2022-09-21 23:45:27 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-21 23:45:27 INFO  Running instrumented original pipeline...
2022-09-21 23:45:27 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-21 23:45:27 INFO  ---RUNTIME: Importing and monkey-patching took 6.254911422729492 ms
2022-09-21 23:45:35 INFO  ---RUNTIME: Original pipeline execution took 7787.6386642456055 ms (excluding imports and monkey-patching)
2022-09-21 23:45:35 INFO  Starting execution of 1 what-if analyses...
2022-09-21 23:45:35 INFO  Start plan generation for analysis DataCleaning...
2022-09-21 23:45:35 INFO  ---RUNTIME: Plan generation took 0.6461143493652344 ms
2022-09-21 23:45:35 INFO  Estimated runtime of original DAG is 5519.705057144165ms
2022-09-21 23:45:35 INFO  Performing Multi-Query Optimization
2022-09-21 23:45:35 INFO  Estimated unoptimized what-if runtime is 110394.1011428833ms
2022-09-21 23:45:35 INFO  Estimated optimised what-if runtime is 20036.534309387207ms
2022-09-21 23:45:35 INFO  Estimated optimisation runtime saving is 90357.5668334961ms
2022-09-21 23:45:35 INFO  ---RUNTIME: Multi-Query Optimization took 96.54068946838379 ms
2022-09-21 23:45:35 INFO  Executing generated plans
2022-09-21 23:46:02 INFO  ---RUNTIME: Execution took 26374.79281425476 ms
2022-09-21 23:46:02 INFO  Done!
2022-09-21 23:46:02 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-21 23:46:02 INFO  Running instrumented original pipeline...
2022-09-21 23:46:02 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-21 23:46:02 INFO  ---RUNTIME: Importing and monkey-patching took 6.268024444580078 ms
2022-09-21 23:46:09 INFO  ---RUNTIME: Original pipeline execution took 7719.372510910034 ms (excluding imports and monkey-patching)
2022-09-21 23:46:09 INFO  Starting execution of 1 what-if analyses...
2022-09-21 23:46:09 INFO  Start plan generation for analysis DataCleaning...
2022-09-21 23:46:09 INFO  ---RUNTIME: Plan generation took 0.6420612335205078 ms
2022-09-21 23:46:09 INFO  Estimated runtime of original DAG is 5516.5746212005615ms
2022-09-21 23:46:09 WARNING Skipping Multi-Query Optimization (instead, only applying patches)
2022-09-21 23:46:09 WARNING Columns ['review_id'] not present in train DAG after the train test split, only before!
2022-09-21 23:46:09 WARNING This could hint at data leakage!
2022-09-21 23:46:09 INFO  Estimated unoptimised what-if runtime is 110331.49242401123ms
2022-09-21 23:46:09 INFO  ---RUNTIME: Multi-Query Optimization took 24.05691146850586 ms
2022-09-21 23:46:09 INFO  Executing generated plans
2022-09-21 23:48:24 INFO  ---RUNTIME: Execution took 134470.26228904724 ms
2022-09-21 23:48:24 INFO  Done!
2022-09-21 23:48:24 INFO  # Finished -- repetition 5 of 7 
2022-09-21 23:48:24 INFO  # Optimization benchmark for data_cleaning with args [['reviews', 'slow_loading', 'featurization_1', 'logistic_regression']] -- repetition 6 of 7
2022-09-21 23:48:24 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-21 23:48:24 INFO  Running instrumented original pipeline...
2022-09-21 23:48:24 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-21 23:48:24 INFO  ---RUNTIME: Importing and monkey-patching took 6.301164627075195 ms
2022-09-21 23:48:31 INFO  ---RUNTIME: Original pipeline execution took 7549.985408782959 ms (excluding imports and monkey-patching)
2022-09-21 23:48:31 INFO  Starting execution of 1 what-if analyses...
2022-09-21 23:48:31 INFO  Start plan generation for analysis DataCleaning...
2022-09-21 23:48:31 INFO  ---RUNTIME: Plan generation took 0.6608963012695312 ms
2022-09-21 23:48:31 INFO  Estimated runtime of original DAG is 5340.536594390869ms
2022-09-21 23:48:31 INFO  Performing Multi-Query Optimization
2022-09-21 23:48:32 INFO  Estimated unoptimized what-if runtime is 106810.73188781738ms
2022-09-21 23:48:32 INFO  Estimated optimised what-if runtime is 19382.219552993774ms
2022-09-21 23:48:32 INFO  Estimated optimisation runtime saving is 87428.51233482361ms
2022-09-21 23:48:32 INFO  ---RUNTIME: Multi-Query Optimization took 345.660924911499 ms
2022-09-21 23:48:32 INFO  Executing generated plans
2022-09-21 23:48:59 INFO  ---RUNTIME: Execution took 26917.473077774048 ms
2022-09-21 23:48:59 INFO  Done!
2022-09-21 23:48:59 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-21 23:48:59 INFO  Running instrumented original pipeline...
2022-09-21 23:48:59 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-21 23:48:59 INFO  ---RUNTIME: Importing and monkey-patching took 6.225347518920898 ms
2022-09-21 23:49:07 INFO  ---RUNTIME: Original pipeline execution took 7858.405113220215 ms (excluding imports and monkey-patching)
2022-09-21 23:49:07 INFO  Starting execution of 1 what-if analyses...
2022-09-21 23:49:07 INFO  Start plan generation for analysis DataCleaning...
2022-09-21 23:49:07 INFO  ---RUNTIME: Plan generation took 0.6077289581298828 ms
2022-09-21 23:49:07 INFO  Estimated runtime of original DAG is 5607.795476913452ms
2022-09-21 23:49:07 WARNING Skipping Multi-Query Optimization (instead, only applying patches)
2022-09-21 23:49:07 WARNING Columns ['review_id'] not present in train DAG after the train test split, only before!
2022-09-21 23:49:07 WARNING This could hint at data leakage!
2022-09-21 23:49:07 INFO  Estimated unoptimised what-if runtime is 112155.90953826904ms
2022-09-21 23:49:07 INFO  ---RUNTIME: Multi-Query Optimization took 25.014162063598633 ms
2022-09-21 23:49:07 INFO  Executing generated plans
2022-09-21 23:51:22 INFO  ---RUNTIME: Execution took 135199.66340065002 ms
2022-09-21 23:51:22 INFO  Done!
2022-09-21 23:51:22 INFO  # Finished -- repetition 6 of 7 
2022-09-21 23:51:22 INFO  # Optimization benchmark for data_cleaning with args [['reviews', 'slow_loading', 'featurization_1', 'logistic_regression']] -- repetition 7 of 7
2022-09-21 23:51:22 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-21 23:51:22 INFO  Running instrumented original pipeline...
2022-09-21 23:51:22 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-21 23:51:22 INFO  ---RUNTIME: Importing and monkey-patching took 6.302595138549805 ms
2022-09-21 23:51:30 INFO  ---RUNTIME: Original pipeline execution took 7792.273283004761 ms (excluding imports and monkey-patching)
2022-09-21 23:51:30 INFO  Starting execution of 1 what-if analyses...
2022-09-21 23:51:30 INFO  Start plan generation for analysis DataCleaning...
2022-09-21 23:51:30 INFO  ---RUNTIME: Plan generation took 0.6365776062011719 ms
2022-09-21 23:51:30 INFO  Estimated runtime of original DAG is 5505.565166473389ms
2022-09-21 23:51:30 INFO  Performing Multi-Query Optimization
2022-09-21 23:51:30 INFO  Estimated unoptimized what-if runtime is 110111.30332946777ms
2022-09-21 23:51:30 INFO  Estimated optimised what-if runtime is 20121.761798858643ms
2022-09-21 23:51:30 INFO  Estimated optimisation runtime saving is 89989.54153060913ms
2022-09-21 23:51:30 INFO  ---RUNTIME: Multi-Query Optimization took 93.56164932250977 ms
2022-09-21 23:51:30 INFO  Executing generated plans
2022-09-21 23:51:56 INFO  ---RUNTIME: Execution took 26378.066062927246 ms
2022-09-21 23:51:56 INFO  Done!
2022-09-21 23:51:56 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-21 23:51:56 INFO  Running instrumented original pipeline...
2022-09-21 23:51:56 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-21 23:51:56 INFO  ---RUNTIME: Importing and monkey-patching took 5.896091461181641 ms
2022-09-21 23:52:04 INFO  ---RUNTIME: Original pipeline execution took 7848.552465438843 ms (excluding imports and monkey-patching)
2022-09-21 23:52:04 INFO  Starting execution of 1 what-if analyses...
2022-09-21 23:52:04 INFO  Start plan generation for analysis DataCleaning...
2022-09-21 23:52:04 INFO  ---RUNTIME: Plan generation took 0.6144046783447266 ms
2022-09-21 23:52:04 INFO  Estimated runtime of original DAG is 5540.602445602417ms
2022-09-21 23:52:04 WARNING Skipping Multi-Query Optimization (instead, only applying patches)
2022-09-21 23:52:04 WARNING Columns ['review_id'] not present in train DAG after the train test split, only before!
2022-09-21 23:52:04 WARNING This could hint at data leakage!
2022-09-21 23:52:04 INFO  Estimated unoptimised what-if runtime is 110812.04891204834ms
2022-09-21 23:52:04 INFO  ---RUNTIME: Multi-Query Optimization took 23.78702163696289 ms
2022-09-21 23:52:04 INFO  Executing generated plans
2022-09-21 23:54:17 INFO  ---RUNTIME: Execution took 133063.3671283722 ms
2022-09-21 23:54:17 INFO  Done!
2022-09-21 23:54:17 INFO  # Finished -- repetition 7 of 7 
2022-09-21 23:54:17 INFO  # Final results after all repetitions
2022-09-21 23:54:17 INFO     repetition  ... no_opt_what_if_execution_combined_model_training
0           0  ...                                      2489.666700
1           1  ...                                      2457.246065
2           2  ...                                      2470.536709
3           3  ...                                      2448.591709
4           4  ...                                      2456.439734
5           5  ...                                      2493.187428
6           6  ...                                      2409.357548

[7 rows x 26 columns]
taskset -c 160-167 PROTOCOL_BUFFERS_PYTHON_IMPLEMENTATION=python python3.9 benchmarks_end_to_end.py data_cleaning reviews slow_loading featurization_1 xgboost
2022-09-21 23:54:19.640813: W tensorflow/stream_executor/platform/default/dso_loader.cc:64] Could not load dynamic library 'libcudart.so.11.0'; dlerror: libcudart.so.11.0: cannot open shared object file: No such file or directory; LD_LIBRARY_PATH: /home/sgrafbe/mlwhatif/venv/lib/python3.9/site-packages/cv2/../../lib64:
2022-09-21 23:54:19.640853: I tensorflow/stream_executor/cuda/cudart_stub.cc:29] Ignore above cudart dlerror if you do not have a GPU set up on your machine.
2022-09-21 23:54:20 INFO  Patching sys.argv with ['mlwhatif', 'reviews', 'slow_loading', 'featurization_1', 'xgboost']
2022-09-21 23:54:20 INFO  Running instrumented original pipeline...
2022-09-21 23:54:20 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-21 23:54:20 INFO  ---RUNTIME: Importing and monkey-patching took 95.83926200866699 ms
2022-09-21 23:54:29 INFO  ---RUNTIME: Original pipeline execution took 8515.764951705933 ms (excluding imports and monkey-patching)
2022-09-21 23:54:29 INFO  Starting execution of 0 what-if analyses...
2022-09-21 23:54:29 INFO  Estimated runtime of original DAG is 6275.405168533325ms
2022-09-21 23:54:29 INFO  Performing Multi-Query Optimization
2022-09-21 23:54:29 INFO  Estimated unoptimized what-if runtime is 0ms
2022-09-21 23:54:29 INFO  Estimated optimised what-if runtime is 0ms
2022-09-21 23:54:29 INFO  Estimated optimisation runtime saving is 0ms
2022-09-21 23:54:29 INFO  ---RUNTIME: Multi-Query Optimization took 0.5125999450683594 ms
2022-09-21 23:54:29 INFO  Executing generated plans
2022-09-21 23:54:29 INFO  ---RUNTIME: Execution took 0.024557113647460938 ms
2022-09-21 23:54:29 INFO  Done!
2022-09-21 23:54:29 INFO  # Optimization benchmark for data_cleaning with args [['reviews', 'slow_loading', 'featurization_1', 'xgboost']] -- repetition 1 of 7
2022-09-21 23:54:29 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-21 23:54:29 INFO  Running instrumented original pipeline...
2022-09-21 23:54:29 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-21 23:54:29 INFO  ---RUNTIME: Importing and monkey-patching took 6.183624267578125 ms
2022-09-21 23:54:37 INFO  ---RUNTIME: Original pipeline execution took 8413.0539894104 ms (excluding imports and monkey-patching)
2022-09-21 23:54:37 INFO  Starting execution of 1 what-if analyses...
2022-09-21 23:54:37 INFO  Start plan generation for analysis DataCleaning...
2022-09-21 23:54:37 INFO  ---RUNTIME: Plan generation took 0.7052421569824219 ms
2022-09-21 23:54:37 INFO  Estimated runtime of original DAG is 6192.510604858398ms
2022-09-21 23:54:37 INFO  Performing Multi-Query Optimization
2022-09-21 23:54:38 INFO  Estimated unoptimized what-if runtime is 123850.21209716797ms
2022-09-21 23:54:38 INFO  Estimated optimised what-if runtime is 36487.95557022095ms
2022-09-21 23:54:38 INFO  Estimated optimisation runtime saving is 87362.25652694702ms
2022-09-21 23:54:38 INFO  ---RUNTIME: Multi-Query Optimization took 253.30448150634766 ms
2022-09-21 23:54:38 INFO  Executing generated plans
2022-09-21 23:55:22 INFO  ---RUNTIME: Execution took 44181.40506744385 ms
2022-09-21 23:55:22 INFO  Done!
2022-09-21 23:55:22 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-21 23:55:22 INFO  Running instrumented original pipeline...
2022-09-21 23:55:22 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-21 23:55:22 INFO  ---RUNTIME: Importing and monkey-patching took 6.346940994262695 ms
2022-09-21 23:55:30 INFO  ---RUNTIME: Original pipeline execution took 8392.484188079834 ms (excluding imports and monkey-patching)
2022-09-21 23:55:30 INFO  Starting execution of 1 what-if analyses...
2022-09-21 23:55:30 INFO  Start plan generation for analysis DataCleaning...
2022-09-21 23:55:30 INFO  ---RUNTIME: Plan generation took 0.6735324859619141 ms
2022-09-21 23:55:30 INFO  Estimated runtime of original DAG is 6193.840742111206ms
2022-09-21 23:55:30 WARNING Skipping Multi-Query Optimization (instead, only applying patches)
2022-09-21 23:55:30 WARNING Columns ['review_id'] not present in train DAG after the train test split, only before!
2022-09-21 23:55:30 WARNING This could hint at data leakage!
2022-09-21 23:55:30 INFO  Estimated unoptimised what-if runtime is 123876.81484222412ms
2022-09-21 23:55:30 INFO  ---RUNTIME: Multi-Query Optimization took 24.47795867919922 ms
2022-09-21 23:55:30 INFO  Executing generated plans
2022-09-21 23:58:00 INFO  ---RUNTIME: Execution took 149490.84734916687 ms
2022-09-21 23:58:00 INFO  Done!
2022-09-21 23:58:00 INFO  # Finished -- repetition 1 of 7 
2022-09-21 23:58:00 INFO  # Optimization benchmark for data_cleaning with args [['reviews', 'slow_loading', 'featurization_1', 'xgboost']] -- repetition 2 of 7
2022-09-21 23:58:00 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-21 23:58:00 INFO  Running instrumented original pipeline...
2022-09-21 23:58:00 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-21 23:58:00 INFO  ---RUNTIME: Importing and monkey-patching took 6.393671035766602 ms
2022-09-21 23:58:08 INFO  ---RUNTIME: Original pipeline execution took 8427.345514297485 ms (excluding imports and monkey-patching)
2022-09-21 23:58:08 INFO  Starting execution of 1 what-if analyses...
2022-09-21 23:58:08 INFO  Start plan generation for analysis DataCleaning...
2022-09-21 23:58:08 INFO  ---RUNTIME: Plan generation took 0.6711483001708984 ms
2022-09-21 23:58:08 INFO  Estimated runtime of original DAG is 6209.215879440308ms
2022-09-21 23:58:08 INFO  Performing Multi-Query Optimization
2022-09-21 23:58:08 INFO  Estimated unoptimized what-if runtime is 124184.31758880615ms
2022-09-21 23:58:08 INFO  Estimated optimised what-if runtime is 36359.64608192444ms
2022-09-21 23:58:08 INFO  Estimated optimisation runtime saving is 87824.67150688171ms
2022-09-21 23:58:08 INFO  ---RUNTIME: Multi-Query Optimization took 119.05407905578613 ms
2022-09-21 23:58:08 INFO  Executing generated plans
2022-09-21 23:58:53 INFO  ---RUNTIME: Execution took 44527.348041534424 ms
2022-09-21 23:58:53 INFO  Done!
2022-09-21 23:58:53 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-21 23:58:53 INFO  Running instrumented original pipeline...
2022-09-21 23:58:53 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-21 23:58:53 INFO  ---RUNTIME: Importing and monkey-patching took 6.316423416137695 ms
2022-09-21 23:59:01 INFO  ---RUNTIME: Original pipeline execution took 8431.225061416626 ms (excluding imports and monkey-patching)
2022-09-21 23:59:01 INFO  Starting execution of 1 what-if analyses...
2022-09-21 23:59:01 INFO  Start plan generation for analysis DataCleaning...
2022-09-21 23:59:01 INFO  ---RUNTIME: Plan generation took 0.6721019744873047 ms
2022-09-21 23:59:01 INFO  Estimated runtime of original DAG is 6223.535060882568ms
2022-09-21 23:59:01 WARNING Skipping Multi-Query Optimization (instead, only applying patches)
2022-09-21 23:59:01 WARNING Columns ['review_id'] not present in train DAG after the train test split, only before!
2022-09-21 23:59:01 WARNING This could hint at data leakage!
2022-09-21 23:59:01 INFO  Estimated unoptimised what-if runtime is 124470.70121765137ms
2022-09-21 23:59:01 INFO  ---RUNTIME: Multi-Query Optimization took 24.163007736206055 ms
2022-09-21 23:59:01 INFO  Executing generated plans
2022-09-22 00:01:32 INFO  ---RUNTIME: Execution took 150553.51209640503 ms
2022-09-22 00:01:32 INFO  Done!
2022-09-22 00:01:32 INFO  # Finished -- repetition 2 of 7 
2022-09-22 00:01:32 INFO  # Optimization benchmark for data_cleaning with args [['reviews', 'slow_loading', 'featurization_1', 'xgboost']] -- repetition 3 of 7
2022-09-22 00:01:32 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-22 00:01:32 INFO  Running instrumented original pipeline...
2022-09-22 00:01:32 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-22 00:01:32 INFO  ---RUNTIME: Importing and monkey-patching took 6.285667419433594 ms
2022-09-22 00:01:40 INFO  ---RUNTIME: Original pipeline execution took 8504.146814346313 ms (excluding imports and monkey-patching)
2022-09-22 00:01:40 INFO  Starting execution of 1 what-if analyses...
2022-09-22 00:01:40 INFO  Start plan generation for analysis DataCleaning...
2022-09-22 00:01:40 INFO  ---RUNTIME: Plan generation took 0.6883144378662109 ms
2022-09-22 00:01:40 INFO  Estimated runtime of original DAG is 6165.03381729126ms
2022-09-22 00:01:40 INFO  Performing Multi-Query Optimization
2022-09-22 00:01:40 INFO  Estimated unoptimized what-if runtime is 123300.6763458252ms
2022-09-22 00:01:40 INFO  Estimated optimised what-if runtime is 36169.59571838379ms
2022-09-22 00:01:40 INFO  Estimated optimisation runtime saving is 87131.0806274414ms
2022-09-22 00:01:40 INFO  ---RUNTIME: Multi-Query Optimization took 95.36147117614746 ms
2022-09-22 00:01:40 INFO  Executing generated plans
2022-09-22 00:02:25 INFO  ---RUNTIME: Execution took 44188.12036514282 ms
2022-09-22 00:02:25 INFO  Done!
2022-09-22 00:02:25 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-22 00:02:25 INFO  Running instrumented original pipeline...
2022-09-22 00:02:25 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-22 00:02:25 INFO  ---RUNTIME: Importing and monkey-patching took 5.9986114501953125 ms
2022-09-22 00:02:33 INFO  ---RUNTIME: Original pipeline execution took 8786.673545837402 ms (excluding imports and monkey-patching)
2022-09-22 00:02:33 INFO  Starting execution of 1 what-if analyses...
2022-09-22 00:02:33 INFO  Start plan generation for analysis DataCleaning...
2022-09-22 00:02:33 INFO  ---RUNTIME: Plan generation took 0.659942626953125 ms
2022-09-22 00:02:33 INFO  Estimated runtime of original DAG is 6290.958642959595ms
2022-09-22 00:02:33 WARNING Skipping Multi-Query Optimization (instead, only applying patches)
2022-09-22 00:02:33 WARNING Columns ['review_id'] not present in train DAG after the train test split, only before!
2022-09-22 00:02:33 WARNING This could hint at data leakage!
2022-09-22 00:02:33 INFO  Estimated unoptimised what-if runtime is 125819.1728591919ms
2022-09-22 00:02:33 INFO  ---RUNTIME: Multi-Query Optimization took 24.49965476989746 ms
2022-09-22 00:02:33 INFO  Executing generated plans
2022-09-22 00:05:04 INFO  ---RUNTIME: Execution took 150561.61999702454 ms
2022-09-22 00:05:04 INFO  Done!
2022-09-22 00:05:04 INFO  # Finished -- repetition 3 of 7 
2022-09-22 00:05:04 INFO  # Optimization benchmark for data_cleaning with args [['reviews', 'slow_loading', 'featurization_1', 'xgboost']] -- repetition 4 of 7
2022-09-22 00:05:04 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-22 00:05:04 INFO  Running instrumented original pipeline...
2022-09-22 00:05:04 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-22 00:05:04 INFO  ---RUNTIME: Importing and monkey-patching took 6.252050399780273 ms
2022-09-22 00:05:13 INFO  ---RUNTIME: Original pipeline execution took 8533.265829086304 ms (excluding imports and monkey-patching)
2022-09-22 00:05:13 INFO  Starting execution of 1 what-if analyses...
2022-09-22 00:05:13 INFO  Start plan generation for analysis DataCleaning...
2022-09-22 00:05:13 INFO  ---RUNTIME: Plan generation took 0.7174015045166016 ms
2022-09-22 00:05:13 INFO  Estimated runtime of original DAG is 6245.736598968506ms
2022-09-22 00:05:13 INFO  Performing Multi-Query Optimization
2022-09-22 00:05:13 INFO  Estimated unoptimized what-if runtime is 124914.73197937012ms
2022-09-22 00:05:13 INFO  Estimated optimised what-if runtime is 36486.51480674744ms
2022-09-22 00:05:13 INFO  Estimated optimisation runtime saving is 88428.21717262268ms
2022-09-22 00:05:13 INFO  ---RUNTIME: Multi-Query Optimization took 95.6573486328125 ms
2022-09-22 00:05:13 INFO  Executing generated plans
2022-09-22 00:05:57 INFO  ---RUNTIME: Execution took 44252.47025489807 ms
2022-09-22 00:05:57 INFO  Done!
2022-09-22 00:05:57 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-22 00:05:57 INFO  Running instrumented original pipeline...
2022-09-22 00:05:57 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-22 00:05:57 INFO  ---RUNTIME: Importing and monkey-patching took 6.316423416137695 ms
2022-09-22 00:06:05 INFO  ---RUNTIME: Original pipeline execution took 8515.056848526001 ms (excluding imports and monkey-patching)
2022-09-22 00:06:05 INFO  Starting execution of 1 what-if analyses...
2022-09-22 00:06:05 INFO  Start plan generation for analysis DataCleaning...
2022-09-22 00:06:05 INFO  ---RUNTIME: Plan generation took 0.6735324859619141 ms
2022-09-22 00:06:05 INFO  Estimated runtime of original DAG is 6209.877252578735ms
2022-09-22 00:06:05 WARNING Skipping Multi-Query Optimization (instead, only applying patches)
2022-09-22 00:06:06 WARNING Columns ['review_id'] not present in train DAG after the train test split, only before!
2022-09-22 00:06:06 WARNING This could hint at data leakage!
2022-09-22 00:06:06 INFO  Estimated unoptimised what-if runtime is 124197.5450515747ms
2022-09-22 00:06:06 INFO  ---RUNTIME: Multi-Query Optimization took 23.57196807861328 ms
2022-09-22 00:06:06 INFO  Executing generated plans
2022-09-22 00:08:36 INFO  ---RUNTIME: Execution took 150225.0418663025 ms
2022-09-22 00:08:36 INFO  Done!
2022-09-22 00:08:36 INFO  # Finished -- repetition 4 of 7 
2022-09-22 00:08:36 INFO  # Optimization benchmark for data_cleaning with args [['reviews', 'slow_loading', 'featurization_1', 'xgboost']] -- repetition 5 of 7
2022-09-22 00:08:36 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-22 00:08:36 INFO  Running instrumented original pipeline...
2022-09-22 00:08:36 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-22 00:08:36 INFO  ---RUNTIME: Importing and monkey-patching took 6.366729736328125 ms
2022-09-22 00:08:44 INFO  ---RUNTIME: Original pipeline execution took 8490.448474884033 ms (excluding imports and monkey-patching)
2022-09-22 00:08:44 INFO  Starting execution of 1 what-if analyses...
2022-09-22 00:08:44 INFO  Start plan generation for analysis DataCleaning...
2022-09-22 00:08:44 INFO  ---RUNTIME: Plan generation took 0.6895065307617188 ms
2022-09-22 00:08:44 INFO  Estimated runtime of original DAG is 6263.373374938965ms
2022-09-22 00:08:44 INFO  Performing Multi-Query Optimization
2022-09-22 00:08:44 INFO  Estimated unoptimized what-if runtime is 125267.4674987793ms
2022-09-22 00:08:44 INFO  Estimated optimised what-if runtime is 36550.46725273132ms
2022-09-22 00:08:44 INFO  Estimated optimisation runtime saving is 88717.00024604797ms
2022-09-22 00:08:44 INFO  ---RUNTIME: Multi-Query Optimization took 94.96641159057617 ms
2022-09-22 00:08:44 INFO  Executing generated plans
2022-09-22 00:09:29 INFO  ---RUNTIME: Execution took 44212.00108528137 ms
2022-09-22 00:09:29 INFO  Done!
2022-09-22 00:09:29 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-22 00:09:29 INFO  Running instrumented original pipeline...
2022-09-22 00:09:29 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-22 00:09:29 INFO  ---RUNTIME: Importing and monkey-patching took 8.219003677368164 ms
2022-09-22 00:09:37 INFO  ---RUNTIME: Original pipeline execution took 8788.90585899353 ms (excluding imports and monkey-patching)
2022-09-22 00:09:37 INFO  Starting execution of 1 what-if analyses...
2022-09-22 00:09:37 INFO  Start plan generation for analysis DataCleaning...
2022-09-22 00:09:37 INFO  ---RUNTIME: Plan generation took 0.7138252258300781 ms
2022-09-22 00:09:37 INFO  Estimated runtime of original DAG is 6565.200328826904ms
2022-09-22 00:09:37 WARNING Skipping Multi-Query Optimization (instead, only applying patches)
2022-09-22 00:09:37 WARNING Columns ['review_id'] not present in train DAG after the train test split, only before!
2022-09-22 00:09:37 WARNING This could hint at data leakage!
2022-09-22 00:09:37 INFO  Estimated unoptimised what-if runtime is 131304.0065765381ms
2022-09-22 00:09:37 INFO  ---RUNTIME: Multi-Query Optimization took 24.40023422241211 ms
2022-09-22 00:09:37 INFO  Executing generated plans
2022-09-22 00:12:07 INFO  ---RUNTIME: Execution took 149767.4582004547 ms
2022-09-22 00:12:07 INFO  Done!
2022-09-22 00:12:07 INFO  # Finished -- repetition 5 of 7 
2022-09-22 00:12:07 INFO  # Optimization benchmark for data_cleaning with args [['reviews', 'slow_loading', 'featurization_1', 'xgboost']] -- repetition 6 of 7
2022-09-22 00:12:07 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-22 00:12:07 INFO  Running instrumented original pipeline...
2022-09-22 00:12:07 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-22 00:12:07 INFO  ---RUNTIME: Importing and monkey-patching took 6.051063537597656 ms
2022-09-22 00:12:16 INFO  ---RUNTIME: Original pipeline execution took 8835.135221481323 ms (excluding imports and monkey-patching)
2022-09-22 00:12:16 INFO  Starting execution of 1 what-if analyses...
2022-09-22 00:12:16 INFO  Start plan generation for analysis DataCleaning...
2022-09-22 00:12:16 INFO  ---RUNTIME: Plan generation took 0.7688999176025391 ms
2022-09-22 00:12:16 INFO  Estimated runtime of original DAG is 6262.181043624878ms
2022-09-22 00:12:16 INFO  Performing Multi-Query Optimization
2022-09-22 00:12:16 INFO  Estimated unoptimized what-if runtime is 125243.62087249756ms
2022-09-22 00:12:16 INFO  Estimated optimised what-if runtime is 36687.07489967346ms
2022-09-22 00:12:16 INFO  Estimated optimisation runtime saving is 88556.5459728241ms
2022-09-22 00:12:16 INFO  ---RUNTIME: Multi-Query Optimization took 94.90203857421875 ms
2022-09-22 00:12:16 INFO  Executing generated plans
2022-09-22 00:13:00 INFO  ---RUNTIME: Execution took 44330.20877838135 ms
2022-09-22 00:13:00 INFO  Done!
2022-09-22 00:13:00 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-22 00:13:00 INFO  Running instrumented original pipeline...
2022-09-22 00:13:00 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-22 00:13:00 INFO  ---RUNTIME: Importing and monkey-patching took 6.418943405151367 ms
2022-09-22 00:13:09 INFO  ---RUNTIME: Original pipeline execution took 8557.782411575317 ms (excluding imports and monkey-patching)
2022-09-22 00:13:09 INFO  Starting execution of 1 what-if analyses...
2022-09-22 00:13:09 INFO  Start plan generation for analysis DataCleaning...
2022-09-22 00:13:09 INFO  ---RUNTIME: Plan generation took 0.6630420684814453 ms
2022-09-22 00:13:09 INFO  Estimated runtime of original DAG is 6283.85591506958ms
2022-09-22 00:13:09 WARNING Skipping Multi-Query Optimization (instead, only applying patches)
2022-09-22 00:13:09 WARNING Columns ['review_id'] not present in train DAG after the train test split, only before!
2022-09-22 00:13:09 WARNING This could hint at data leakage!
2022-09-22 00:13:09 INFO  Estimated unoptimised what-if runtime is 125677.1183013916ms
2022-09-22 00:13:09 INFO  ---RUNTIME: Multi-Query Optimization took 24.21116828918457 ms
2022-09-22 00:13:09 INFO  Executing generated plans
2022-09-22 00:15:41 INFO  ---RUNTIME: Execution took 151693.25017929077 ms
2022-09-22 00:15:41 INFO  Done!
2022-09-22 00:15:41 INFO  # Finished -- repetition 6 of 7 
2022-09-22 00:15:41 INFO  # Optimization benchmark for data_cleaning with args [['reviews', 'slow_loading', 'featurization_1', 'xgboost']] -- repetition 7 of 7
2022-09-22 00:15:41 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-22 00:15:41 INFO  Running instrumented original pipeline...
2022-09-22 00:15:41 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-22 00:15:41 INFO  ---RUNTIME: Importing and monkey-patching took 6.484508514404297 ms
2022-09-22 00:15:50 INFO  ---RUNTIME: Original pipeline execution took 9042.78016090393 ms (excluding imports and monkey-patching)
2022-09-22 00:15:50 INFO  Starting execution of 1 what-if analyses...
2022-09-22 00:15:50 INFO  Start plan generation for analysis DataCleaning...
2022-09-22 00:15:50 INFO  ---RUNTIME: Plan generation took 0.7014274597167969 ms
2022-09-22 00:15:50 INFO  Estimated runtime of original DAG is 6763.65065574646ms
2022-09-22 00:15:50 INFO  Performing Multi-Query Optimization
2022-09-22 00:15:50 INFO  Estimated unoptimized what-if runtime is 135273.0131149292ms
2022-09-22 00:15:50 INFO  Estimated optimised what-if runtime is 36076.13110542297ms
2022-09-22 00:15:50 INFO  Estimated optimisation runtime saving is 99196.88200950623ms
2022-09-22 00:15:50 INFO  ---RUNTIME: Multi-Query Optimization took 95.7643985748291 ms
2022-09-22 00:15:50 INFO  Executing generated plans
2022-09-22 00:16:34 INFO  ---RUNTIME: Execution took 44388.0410194397 ms
2022-09-22 00:16:34 INFO  Done!
2022-09-22 00:16:34 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-22 00:16:34 INFO  Running instrumented original pipeline...
2022-09-22 00:16:34 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-22 00:16:34 INFO  ---RUNTIME: Importing and monkey-patching took 6.41179084777832 ms
2022-09-22 00:16:43 INFO  ---RUNTIME: Original pipeline execution took 8563.503503799438 ms (excluding imports and monkey-patching)
2022-09-22 00:16:43 INFO  Starting execution of 1 what-if analyses...
2022-09-22 00:16:43 INFO  Start plan generation for analysis DataCleaning...
2022-09-22 00:16:43 INFO  ---RUNTIME: Plan generation took 0.6711483001708984 ms
2022-09-22 00:16:43 INFO  Estimated runtime of original DAG is 6291.659355163574ms
2022-09-22 00:16:43 WARNING Skipping Multi-Query Optimization (instead, only applying patches)
2022-09-22 00:16:43 WARNING Columns ['review_id'] not present in train DAG after the train test split, only before!
2022-09-22 00:16:43 WARNING This could hint at data leakage!
2022-09-22 00:16:43 INFO  Estimated unoptimised what-if runtime is 125833.18710327148ms
2022-09-22 00:16:43 INFO  ---RUNTIME: Multi-Query Optimization took 23.751497268676758 ms
2022-09-22 00:16:43 INFO  Executing generated plans
2022-09-22 00:19:13 INFO  ---RUNTIME: Execution took 150241.28127098083 ms
2022-09-22 00:19:13 INFO  Done!
2022-09-22 00:19:13 INFO  # Finished -- repetition 7 of 7 
2022-09-22 00:19:13 INFO  # Final results after all repetitions
2022-09-22 00:19:13 INFO     repetition  ... no_opt_what_if_execution_combined_model_training
0           0  ...                                     19892.320633
1           1  ...                                     19982.785463
2           2  ...                                     19998.795271
3           3  ...                                     19869.838238
4           4  ...                                     19844.577312
5           5  ...                                     20129.267693
6           6  ...                                     19642.935276

[7 rows x 26 columns]
taskset -c 160-167 PROTOCOL_BUFFERS_PYTHON_IMPLEMENTATION=python python3.9 benchmarks_end_to_end.py data_cleaning reviews slow_loading featurization_1 neural_network
2022-09-22 00:19:15.813671: W tensorflow/stream_executor/platform/default/dso_loader.cc:64] Could not load dynamic library 'libcudart.so.11.0'; dlerror: libcudart.so.11.0: cannot open shared object file: No such file or directory; LD_LIBRARY_PATH: /home/sgrafbe/mlwhatif/venv/lib/python3.9/site-packages/cv2/../../lib64:
2022-09-22 00:19:15.813717: I tensorflow/stream_executor/cuda/cudart_stub.cc:29] Ignore above cudart dlerror if you do not have a GPU set up on your machine.
2022-09-22 00:19:17 INFO  Patching sys.argv with ['mlwhatif', 'reviews', 'slow_loading', 'featurization_1', 'neural_network']
2022-09-22 00:19:17 INFO  Running instrumented original pipeline...
2022-09-22 00:19:17 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-22 00:19:17 INFO  ---RUNTIME: Importing and monkey-patching took 95.69358825683594 ms
2022-09-22 00:19:23.789391: W tensorflow/stream_executor/platform/default/dso_loader.cc:64] Could not load dynamic library 'libcuda.so.1'; dlerror: libcuda.so.1: cannot open shared object file: No such file or directory; LD_LIBRARY_PATH: /home/sgrafbe/mlwhatif/venv/lib/python3.9/site-packages/cv2/../../lib64:
2022-09-22 00:19:23.789440: W tensorflow/stream_executor/cuda/cuda_driver.cc:326] failed call to cuInit: UNKNOWN ERROR (303)
2022-09-22 00:19:23.789466: I tensorflow/stream_executor/cuda/cuda_diagnostics.cc:156] kernel driver does not appear to be running on this host (wagyu): /proc/driver/nvidia/version does not exist
2022-09-22 00:19:23.790039: I tensorflow/core/platform/cpu_feature_guard.cc:142] This TensorFlow binary is optimized with oneAPI Deep Neural Network Library (oneDNN) to use the following CPU instructions in performance-critical operations:  AVX2 FMA
To enable them in other operations, rebuild TensorFlow with the appropriate compiler flags.
2022-09-22 00:19:23.860029: I tensorflow/compiler/mlir/mlir_graph_optimization_pass.cc:176] None of the MLIR Optimization Passes are enabled (registered 2)
2022-09-22 00:19:23.873372: I tensorflow/core/platform/profile_utils/cpu_utils.cc:114] CPU Frequency: 2595290000 Hz
2022-09-22 00:19:29 INFO  ---RUNTIME: Original pipeline execution took 12249.651908874512 ms (excluding imports and monkey-patching)
2022-09-22 00:19:29 INFO  Starting execution of 0 what-if analyses...
2022-09-22 00:19:29 INFO  Estimated runtime of original DAG is 10020.540237426758ms
2022-09-22 00:19:29 INFO  Performing Multi-Query Optimization
2022-09-22 00:19:29 INFO  Estimated unoptimized what-if runtime is 0ms
2022-09-22 00:19:29 INFO  Estimated optimised what-if runtime is 0ms
2022-09-22 00:19:29 INFO  Estimated optimisation runtime saving is 0ms
2022-09-22 00:19:29 INFO  ---RUNTIME: Multi-Query Optimization took 0.5078315734863281 ms
2022-09-22 00:19:29 INFO  Executing generated plans
2022-09-22 00:19:29 INFO  ---RUNTIME: Execution took 0.02193450927734375 ms
2022-09-22 00:19:29 INFO  Done!
2022-09-22 00:19:29 INFO  # Optimization benchmark for data_cleaning with args [['reviews', 'slow_loading', 'featurization_1', 'neural_network']] -- repetition 1 of 7
2022-09-22 00:19:29 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-22 00:19:29 INFO  Running instrumented original pipeline...
2022-09-22 00:19:29 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-22 00:19:29 INFO  ---RUNTIME: Importing and monkey-patching took 5.487918853759766 ms
2022-09-22 00:19:40 INFO  ---RUNTIME: Original pipeline execution took 11318.065166473389 ms (excluding imports and monkey-patching)
2022-09-22 00:19:40 INFO  Starting execution of 1 what-if analyses...
2022-09-22 00:19:40 INFO  Start plan generation for analysis DataCleaning...
2022-09-22 00:19:40 INFO  ---RUNTIME: Plan generation took 0.6260871887207031 ms
2022-09-22 00:19:40 INFO  Estimated runtime of original DAG is 8814.085245132446ms
2022-09-22 00:19:40 INFO  Performing Multi-Query Optimization
2022-09-22 00:19:40 INFO  Estimated unoptimized what-if runtime is 176281.70490264893ms
2022-09-22 00:19:40 INFO  Estimated optimised what-if runtime is 88974.00045394897ms
2022-09-22 00:19:40 INFO  Estimated optimisation runtime saving is 87307.70444869995ms
2022-09-22 00:19:40 INFO  ---RUNTIME: Multi-Query Optimization took 95.8702564239502 ms
2022-09-22 00:19:40 INFO  Executing generated plans
2022-09-22 00:21:20 INFO  ---RUNTIME: Execution took 99809.56530570984 ms
2022-09-22 00:21:20 INFO  Done!
2022-09-22 00:21:20 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-22 00:21:20 INFO  Running instrumented original pipeline...
2022-09-22 00:21:20 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-22 00:21:20 INFO  ---RUNTIME: Importing and monkey-patching took 6.316900253295898 ms
2022-09-22 00:21:32 INFO  ---RUNTIME: Original pipeline execution took 11413.706302642822 ms (excluding imports and monkey-patching)
2022-09-22 00:21:32 INFO  Starting execution of 1 what-if analyses...
2022-09-22 00:21:32 INFO  Start plan generation for analysis DataCleaning...
2022-09-22 00:21:32 INFO  ---RUNTIME: Plan generation took 0.5834102630615234 ms
2022-09-22 00:21:32 INFO  Estimated runtime of original DAG is 9024.74594116211ms
2022-09-22 00:21:32 WARNING Skipping Multi-Query Optimization (instead, only applying patches)
2022-09-22 00:21:32 WARNING Columns ['review_id'] not present in train DAG after the train test split, only before!
2022-09-22 00:21:32 WARNING This could hint at data leakage!
2022-09-22 00:21:32 INFO  Estimated unoptimised what-if runtime is 180494.9188232422ms
2022-09-22 00:21:32 INFO  ---RUNTIME: Multi-Query Optimization took 23.822784423828125 ms
2022-09-22 00:21:32 INFO  Executing generated plans
2022-09-22 00:24:58 INFO  ---RUNTIME: Execution took 206598.13404083252 ms
2022-09-22 00:24:58 INFO  Done!
2022-09-22 00:24:58 INFO  # Finished -- repetition 1 of 7 
2022-09-22 00:24:58 INFO  # Optimization benchmark for data_cleaning with args [['reviews', 'slow_loading', 'featurization_1', 'neural_network']] -- repetition 2 of 7
2022-09-22 00:24:58 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-22 00:24:58 INFO  Running instrumented original pipeline...
2022-09-22 00:24:58 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-22 00:24:58 INFO  ---RUNTIME: Importing and monkey-patching took 5.91731071472168 ms
2022-09-22 00:25:10 INFO  ---RUNTIME: Original pipeline execution took 11959.6529006958 ms (excluding imports and monkey-patching)
2022-09-22 00:25:10 INFO  Starting execution of 1 what-if analyses...
2022-09-22 00:25:10 INFO  Start plan generation for analysis DataCleaning...
2022-09-22 00:25:10 INFO  ---RUNTIME: Plan generation took 0.6148815155029297 ms
2022-09-22 00:25:10 INFO  Estimated runtime of original DAG is 9422.693967819214ms
2022-09-22 00:25:10 INFO  Performing Multi-Query Optimization
2022-09-22 00:25:10 INFO  Estimated unoptimized what-if runtime is 188453.87935638428ms
2022-09-22 00:25:10 INFO  Estimated optimised what-if runtime is 93723.93012046814ms
2022-09-22 00:25:10 INFO  Estimated optimisation runtime saving is 94729.94923591614ms
2022-09-22 00:25:10 INFO  ---RUNTIME: Multi-Query Optimization took 95.94345092773438 ms
2022-09-22 00:25:10 INFO  Executing generated plans
2022-09-22 00:26:50 INFO  ---RUNTIME: Execution took 99829.34045791626 ms
2022-09-22 00:26:50 INFO  Done!
2022-09-22 00:26:50 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-22 00:26:50 INFO  Running instrumented original pipeline...
2022-09-22 00:26:50 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-22 00:26:50 INFO  ---RUNTIME: Importing and monkey-patching took 5.890369415283203 ms
2022-09-22 00:27:01 INFO  ---RUNTIME: Original pipeline execution took 11209.716081619263 ms (excluding imports and monkey-patching)
2022-09-22 00:27:01 INFO  Starting execution of 1 what-if analyses...
2022-09-22 00:27:01 INFO  Start plan generation for analysis DataCleaning...
2022-09-22 00:27:01 INFO  ---RUNTIME: Plan generation took 0.5805492401123047 ms
2022-09-22 00:27:01 INFO  Estimated runtime of original DAG is 8946.528911590576ms
2022-09-22 00:27:01 WARNING Skipping Multi-Query Optimization (instead, only applying patches)
2022-09-22 00:27:01 WARNING Columns ['review_id'] not present in train DAG after the train test split, only before!
2022-09-22 00:27:01 WARNING This could hint at data leakage!
2022-09-22 00:27:01 INFO  Estimated unoptimised what-if runtime is 178930.57823181152ms
2022-09-22 00:27:01 INFO  ---RUNTIME: Multi-Query Optimization took 23.812294006347656 ms
2022-09-22 00:27:01 INFO  Executing generated plans
2022-09-22 00:30:29 INFO  ---RUNTIME: Execution took 208119.75026130676 ms
2022-09-22 00:30:29 INFO  Done!
2022-09-22 00:30:29 INFO  # Finished -- repetition 2 of 7 
2022-09-22 00:30:29 INFO  # Optimization benchmark for data_cleaning with args [['reviews', 'slow_loading', 'featurization_1', 'neural_network']] -- repetition 3 of 7
2022-09-22 00:30:29 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-22 00:30:29 INFO  Running instrumented original pipeline...
2022-09-22 00:30:29 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-22 00:30:29 INFO  ---RUNTIME: Importing and monkey-patching took 6.259679794311523 ms
2022-09-22 00:30:41 INFO  ---RUNTIME: Original pipeline execution took 11587.57996559143 ms (excluding imports and monkey-patching)
2022-09-22 00:30:41 INFO  Starting execution of 1 what-if analyses...
2022-09-22 00:30:41 INFO  Start plan generation for analysis DataCleaning...
2022-09-22 00:30:41 INFO  ---RUNTIME: Plan generation took 2.040863037109375 ms
2022-09-22 00:30:41 INFO  Estimated runtime of original DAG is 9128.37028503418ms
2022-09-22 00:30:41 INFO  Performing Multi-Query Optimization
2022-09-22 00:30:41 INFO  Estimated unoptimized what-if runtime is 182567.4057006836ms
2022-09-22 00:30:41 INFO  Estimated optimised what-if runtime is 94713.4301662445ms
2022-09-22 00:30:41 INFO  Estimated optimisation runtime saving is 87853.97553443909ms
2022-09-22 00:30:41 INFO  ---RUNTIME: Multi-Query Optimization took 93.54925155639648 ms
2022-09-22 00:30:41 INFO  Executing generated plans
2022-09-22 00:32:20 INFO  ---RUNTIME: Execution took 99199.90372657776 ms
2022-09-22 00:32:20 INFO  Done!
2022-09-22 00:32:20 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-22 00:32:20 INFO  Running instrumented original pipeline...
2022-09-22 00:32:20 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-22 00:32:20 INFO  ---RUNTIME: Importing and monkey-patching took 6.005048751831055 ms
2022-09-22 00:32:32 INFO  ---RUNTIME: Original pipeline execution took 11481.780290603638 ms (excluding imports and monkey-patching)
2022-09-22 00:32:32 INFO  Starting execution of 1 what-if analyses...
2022-09-22 00:32:32 INFO  Start plan generation for analysis DataCleaning...
2022-09-22 00:32:32 INFO  ---RUNTIME: Plan generation took 0.5440711975097656 ms
2022-09-22 00:32:32 INFO  Estimated runtime of original DAG is 9279.25992012024ms
2022-09-22 00:32:32 WARNING Skipping Multi-Query Optimization (instead, only applying patches)
2022-09-22 00:32:32 WARNING Columns ['review_id'] not present in train DAG after the train test split, only before!
2022-09-22 00:32:32 WARNING This could hint at data leakage!
2022-09-22 00:32:32 INFO  Estimated unoptimised what-if runtime is 185585.19840240479ms
2022-09-22 00:32:32 INFO  ---RUNTIME: Multi-Query Optimization took 23.78106117248535 ms
2022-09-22 00:32:32 INFO  Executing generated plans
2022-09-22 00:36:00 INFO  ---RUNTIME: Execution took 208001.20615959167 ms
2022-09-22 00:36:00 INFO  Done!
2022-09-22 00:36:00 INFO  # Finished -- repetition 3 of 7 
2022-09-22 00:36:00 INFO  # Optimization benchmark for data_cleaning with args [['reviews', 'slow_loading', 'featurization_1', 'neural_network']] -- repetition 4 of 7
2022-09-22 00:36:00 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-22 00:36:00 INFO  Running instrumented original pipeline...
2022-09-22 00:36:00 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-22 00:36:00 INFO  ---RUNTIME: Importing and monkey-patching took 5.993843078613281 ms
2022-09-22 00:36:12 INFO  ---RUNTIME: Original pipeline execution took 11793.51782798767 ms (excluding imports and monkey-patching)
2022-09-22 00:36:12 INFO  Starting execution of 1 what-if analyses...
2022-09-22 00:36:12 INFO  Start plan generation for analysis DataCleaning...
2022-09-22 00:36:12 INFO  ---RUNTIME: Plan generation took 0.5939006805419922 ms
2022-09-22 00:36:12 INFO  Estimated runtime of original DAG is 9301.271915435791ms
2022-09-22 00:36:12 INFO  Performing Multi-Query Optimization
2022-09-22 00:36:12 INFO  Estimated unoptimized what-if runtime is 186025.43830871582ms
2022-09-22 00:36:12 INFO  Estimated optimised what-if runtime is 91401.37481689453ms
2022-09-22 00:36:12 INFO  Estimated optimisation runtime saving is 94624.06349182129ms
2022-09-22 00:36:12 INFO  ---RUNTIME: Multi-Query Optimization took 96.1294174194336 ms
2022-09-22 00:36:12 INFO  Executing generated plans
2022-09-22 00:37:51 INFO  ---RUNTIME: Execution took 99105.60083389282 ms
2022-09-22 00:37:51 INFO  Done!
2022-09-22 00:37:51 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-22 00:37:51 INFO  Running instrumented original pipeline...
2022-09-22 00:37:51 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-22 00:37:51 INFO  ---RUNTIME: Importing and monkey-patching took 5.961179733276367 ms
2022-09-22 00:38:03 INFO  ---RUNTIME: Original pipeline execution took 12382.093667984009 ms (excluding imports and monkey-patching)
2022-09-22 00:38:03 INFO  Starting execution of 1 what-if analyses...
2022-09-22 00:38:03 INFO  Start plan generation for analysis DataCleaning...
2022-09-22 00:38:03 INFO  ---RUNTIME: Plan generation took 0.6074905395507812 ms
2022-09-22 00:38:03 INFO  Estimated runtime of original DAG is 10182.892322540283ms
2022-09-22 00:38:03 WARNING Skipping Multi-Query Optimization (instead, only applying patches)
2022-09-22 00:38:03 WARNING Columns ['review_id'] not present in train DAG after the train test split, only before!
2022-09-22 00:38:03 WARNING This could hint at data leakage!
2022-09-22 00:38:03 INFO  Estimated unoptimised what-if runtime is 203657.84645080566ms
2022-09-22 00:38:03 INFO  ---RUNTIME: Multi-Query Optimization took 24.033069610595703 ms
2022-09-22 00:38:03 INFO  Executing generated plans
2022-09-22 00:41:32 INFO  ---RUNTIME: Execution took 208839.44129943848 ms
2022-09-22 00:41:32 INFO  Done!
2022-09-22 00:41:32 INFO  # Finished -- repetition 4 of 7 
2022-09-22 00:41:32 INFO  # Optimization benchmark for data_cleaning with args [['reviews', 'slow_loading', 'featurization_1', 'neural_network']] -- repetition 5 of 7
2022-09-22 00:41:32 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-22 00:41:32 INFO  Running instrumented original pipeline...
2022-09-22 00:41:32 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-22 00:41:32 INFO  ---RUNTIME: Importing and monkey-patching took 6.462812423706055 ms
2022-09-22 00:41:43 INFO  ---RUNTIME: Original pipeline execution took 11355.018138885498 ms (excluding imports and monkey-patching)
2022-09-22 00:41:43 INFO  Starting execution of 1 what-if analyses...
2022-09-22 00:41:43 INFO  Start plan generation for analysis DataCleaning...
2022-09-22 00:41:43 INFO  ---RUNTIME: Plan generation took 0.5788803100585938 ms
2022-09-22 00:41:43 INFO  Estimated runtime of original DAG is 9000.096082687378ms
2022-09-22 00:41:43 INFO  Performing Multi-Query Optimization
2022-09-22 00:41:44 INFO  Estimated unoptimized what-if runtime is 180001.92165374756ms
2022-09-22 00:41:44 INFO  Estimated optimised what-if runtime is 88797.12986946106ms
2022-09-22 00:41:44 INFO  Estimated optimisation runtime saving is 91204.7917842865ms
2022-09-22 00:41:44 INFO  ---RUNTIME: Multi-Query Optimization took 453.2051086425781 ms
2022-09-22 00:41:44 INFO  Executing generated plans
2022-09-22 00:43:23 INFO  ---RUNTIME: Execution took 99346.06337547302 ms
2022-09-22 00:43:23 INFO  Done!
2022-09-22 00:43:23 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-22 00:43:23 INFO  Running instrumented original pipeline...
2022-09-22 00:43:23 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-22 00:43:23 INFO  ---RUNTIME: Importing and monkey-patching took 6.0176849365234375 ms
2022-09-22 00:43:35 INFO  ---RUNTIME: Original pipeline execution took 11367.881774902344 ms (excluding imports and monkey-patching)
2022-09-22 00:43:35 INFO  Starting execution of 1 what-if analyses...
2022-09-22 00:43:35 INFO  Start plan generation for analysis DataCleaning...
2022-09-22 00:43:35 INFO  ---RUNTIME: Plan generation took 0.6022453308105469 ms
2022-09-22 00:43:35 INFO  Estimated runtime of original DAG is 9106.483221054077ms
2022-09-22 00:43:35 WARNING Skipping Multi-Query Optimization (instead, only applying patches)
2022-09-22 00:43:35 WARNING Columns ['review_id'] not present in train DAG after the train test split, only before!
2022-09-22 00:43:35 WARNING This could hint at data leakage!
2022-09-22 00:43:35 INFO  Estimated unoptimised what-if runtime is 182129.66442108154ms
2022-09-22 00:43:35 INFO  ---RUNTIME: Multi-Query Optimization took 24.871826171875 ms
2022-09-22 00:43:35 INFO  Executing generated plans
2022-09-22 00:47:05 INFO  ---RUNTIME: Execution took 210587.9626274109 ms
2022-09-22 00:47:05 INFO  Done!
2022-09-22 00:47:05 INFO  # Finished -- repetition 5 of 7 
2022-09-22 00:47:05 INFO  # Optimization benchmark for data_cleaning with args [['reviews', 'slow_loading', 'featurization_1', 'neural_network']] -- repetition 6 of 7
2022-09-22 00:47:05 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-22 00:47:05 INFO  Running instrumented original pipeline...
2022-09-22 00:47:05 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-22 00:47:05 INFO  ---RUNTIME: Importing and monkey-patching took 5.976200103759766 ms
2022-09-22 00:47:17 INFO  ---RUNTIME: Original pipeline execution took 11485.166072845459 ms (excluding imports and monkey-patching)
2022-09-22 00:47:17 INFO  Starting execution of 1 what-if analyses...
2022-09-22 00:47:17 INFO  Start plan generation for analysis DataCleaning...
2022-09-22 00:47:17 INFO  ---RUNTIME: Plan generation took 0.6341934204101562 ms
2022-09-22 00:47:17 INFO  Estimated runtime of original DAG is 9081.012964248657ms
2022-09-22 00:47:17 INFO  Performing Multi-Query Optimization
2022-09-22 00:47:17 INFO  Estimated unoptimized what-if runtime is 181620.25928497314ms
2022-09-22 00:47:17 INFO  Estimated optimised what-if runtime is 91635.60271263123ms
2022-09-22 00:47:17 INFO  Estimated optimisation runtime saving is 89984.65657234192ms
2022-09-22 00:47:17 INFO  ---RUNTIME: Multi-Query Optimization took 96.16613388061523 ms
2022-09-22 00:47:17 INFO  Executing generated plans
2022-09-22 00:48:56 INFO  ---RUNTIME: Execution took 99334.15412902832 ms
2022-09-22 00:48:56 INFO  Done!
2022-09-22 00:48:56 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-22 00:48:56 INFO  Running instrumented original pipeline...
2022-09-22 00:48:56 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-22 00:48:56 INFO  ---RUNTIME: Importing and monkey-patching took 5.864858627319336 ms
2022-09-22 00:49:07 INFO  ---RUNTIME: Original pipeline execution took 11132.619380950928 ms (excluding imports and monkey-patching)
2022-09-22 00:49:07 INFO  Starting execution of 1 what-if analyses...
2022-09-22 00:49:07 INFO  Start plan generation for analysis DataCleaning...
2022-09-22 00:49:07 INFO  ---RUNTIME: Plan generation took 0.6091594696044922 ms
2022-09-22 00:49:07 INFO  Estimated runtime of original DAG is 8878.730773925781ms
2022-09-22 00:49:07 WARNING Skipping Multi-Query Optimization (instead, only applying patches)
2022-09-22 00:49:07 WARNING Columns ['review_id'] not present in train DAG after the train test split, only before!
2022-09-22 00:49:07 WARNING This could hint at data leakage!
2022-09-22 00:49:07 INFO  Estimated unoptimised what-if runtime is 177574.61547851562ms
2022-09-22 00:49:07 INFO  ---RUNTIME: Multi-Query Optimization took 23.77796173095703 ms
2022-09-22 00:49:07 INFO  Executing generated plans
2022-09-22 00:52:35 INFO  ---RUNTIME: Execution took 207633.46433639526 ms
2022-09-22 00:52:35 INFO  Done!
2022-09-22 00:52:35 INFO  # Finished -- repetition 6 of 7 
2022-09-22 00:52:35 INFO  # Optimization benchmark for data_cleaning with args [['reviews', 'slow_loading', 'featurization_1', 'neural_network']] -- repetition 7 of 7
2022-09-22 00:52:35 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-22 00:52:35 INFO  Running instrumented original pipeline...
2022-09-22 00:52:35 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-22 00:52:35 INFO  ---RUNTIME: Importing and monkey-patching took 5.894899368286133 ms
2022-09-22 00:52:46 INFO  ---RUNTIME: Original pipeline execution took 11439.796686172485 ms (excluding imports and monkey-patching)
2022-09-22 00:52:46 INFO  Starting execution of 1 what-if analyses...
2022-09-22 00:52:46 INFO  Start plan generation for analysis DataCleaning...
2022-09-22 00:52:46 INFO  ---RUNTIME: Plan generation took 0.5927085876464844 ms
2022-09-22 00:52:46 INFO  Estimated runtime of original DAG is 8759.248495101929ms
2022-09-22 00:52:46 INFO  Performing Multi-Query Optimization
2022-09-22 00:52:47 INFO  Estimated unoptimized what-if runtime is 175184.96990203857ms
2022-09-22 00:52:47 INFO  Estimated optimised what-if runtime is 86615.5138015747ms
2022-09-22 00:52:47 INFO  Estimated optimisation runtime saving is 88569.45610046387ms
2022-09-22 00:52:47 INFO  ---RUNTIME: Multi-Query Optimization took 96.3292121887207 ms
2022-09-22 00:52:47 INFO  Executing generated plans
2022-09-22 00:54:26 INFO  ---RUNTIME: Execution took 99523.4591960907 ms
2022-09-22 00:54:26 INFO  Done!
2022-09-22 00:54:26 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-22 00:54:26 INFO  Running instrumented original pipeline...
2022-09-22 00:54:26 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-22 00:54:26 INFO  ---RUNTIME: Importing and monkey-patching took 6.3800811767578125 ms
2022-09-22 00:54:37 INFO  ---RUNTIME: Original pipeline execution took 11248.556852340698 ms (excluding imports and monkey-patching)
2022-09-22 00:54:37 INFO  Starting execution of 1 what-if analyses...
2022-09-22 00:54:37 INFO  Start plan generation for analysis DataCleaning...
2022-09-22 00:54:37 INFO  ---RUNTIME: Plan generation took 0.5505084991455078 ms
2022-09-22 00:54:37 INFO  Estimated runtime of original DAG is 8976.940631866455ms
2022-09-22 00:54:37 WARNING Skipping Multi-Query Optimization (instead, only applying patches)
2022-09-22 00:54:37 WARNING Columns ['review_id'] not present in train DAG after the train test split, only before!
2022-09-22 00:54:37 WARNING This could hint at data leakage!
2022-09-22 00:54:37 INFO  Estimated unoptimised what-if runtime is 179538.8126373291ms
2022-09-22 00:54:37 INFO  ---RUNTIME: Multi-Query Optimization took 23.76413345336914 ms
2022-09-22 00:54:37 INFO  Executing generated plans
2022-09-22 00:58:04 INFO  ---RUNTIME: Execution took 206681.2219619751 ms
2022-09-22 00:58:04 INFO  Done!
2022-09-22 00:58:04 INFO  # Finished -- repetition 7 of 7 
2022-09-22 00:58:04 INFO  # Final results after all repetitions
2022-09-22 00:58:04 INFO     repetition  ... no_opt_what_if_execution_combined_model_training
0           0  ...                                     67776.614904
1           1  ...                                     68010.617733
2           2  ...                                     66086.982012
3           3  ...                                     67888.704538
4           4  ...                                     67286.761761
5           5  ...                                     67557.685137
6           6  ...                                     67316.399336

[7 rows x 26 columns]
taskset -c 160-167 PROTOCOL_BUFFERS_PYTHON_IMPLEMENTATION=python python3.9 benchmarks_end_to_end.py data_cleaning reviews slow_loading featurization_2 logistic_regression
2022-09-22 00:58:06.892436: W tensorflow/stream_executor/platform/default/dso_loader.cc:64] Could not load dynamic library 'libcudart.so.11.0'; dlerror: libcudart.so.11.0: cannot open shared object file: No such file or directory; LD_LIBRARY_PATH: /home/sgrafbe/mlwhatif/venv/lib/python3.9/site-packages/cv2/../../lib64:
2022-09-22 00:58:06.892481: I tensorflow/stream_executor/cuda/cudart_stub.cc:29] Ignore above cudart dlerror if you do not have a GPU set up on your machine.
2022-09-22 00:58:08 INFO  Patching sys.argv with ['mlwhatif', 'reviews', 'slow_loading', 'featurization_2', 'logistic_regression']
2022-09-22 00:58:08 INFO  Running instrumented original pipeline...
2022-09-22 00:58:08 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-22 00:58:08 INFO  ---RUNTIME: Importing and monkey-patching took 95.63422203063965 ms
2022-09-22 00:58:15 INFO  ---RUNTIME: Original pipeline execution took 7179.985046386719 ms (excluding imports and monkey-patching)
2022-09-22 00:58:15 INFO  Starting execution of 0 what-if analyses...
2022-09-22 00:58:15 INFO  Estimated runtime of original DAG is 5966.265916824341ms
2022-09-22 00:58:15 INFO  Performing Multi-Query Optimization
2022-09-22 00:58:15 INFO  Estimated unoptimized what-if runtime is 0ms
2022-09-22 00:58:15 INFO  Estimated optimised what-if runtime is 0ms
2022-09-22 00:58:15 INFO  Estimated optimisation runtime saving is 0ms
2022-09-22 00:58:15 INFO  ---RUNTIME: Multi-Query Optimization took 0.5896091461181641 ms
2022-09-22 00:58:15 INFO  Executing generated plans
2022-09-22 00:58:15 INFO  ---RUNTIME: Execution took 0.024318695068359375 ms
2022-09-22 00:58:15 INFO  Done!
2022-09-22 00:58:15 INFO  # Optimization benchmark for data_cleaning with args [['reviews', 'slow_loading', 'featurization_2', 'logistic_regression']] -- repetition 1 of 7
2022-09-22 00:58:15 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-22 00:58:15 INFO  Running instrumented original pipeline...
2022-09-22 00:58:15 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-22 00:58:15 INFO  ---RUNTIME: Importing and monkey-patching took 6.234169006347656 ms
2022-09-22 00:58:22 INFO  ---RUNTIME: Original pipeline execution took 7559.765577316284 ms (excluding imports and monkey-patching)
2022-09-22 00:58:22 INFO  Starting execution of 1 what-if analyses...
2022-09-22 00:58:22 INFO  Start plan generation for analysis DataCleaning...
2022-09-22 00:58:22 INFO  ---RUNTIME: Plan generation took 0.7567405700683594 ms
2022-09-22 00:58:22 INFO  Estimated runtime of original DAG is 6309.688091278076ms
2022-09-22 00:58:22 INFO  Performing Multi-Query Optimization
2022-09-22 00:58:23 INFO  Estimated unoptimized what-if runtime is 126193.76182556152ms
2022-09-22 00:58:23 INFO  Estimated optimised what-if runtime is 24819.199323654175ms
2022-09-22 00:58:23 INFO  Estimated optimisation runtime saving is 101374.56250190735ms
2022-09-22 00:58:23 INFO  ---RUNTIME: Multi-Query Optimization took 111.13381385803223 ms
2022-09-22 00:58:23 INFO  Executing generated plans
2022-09-22 00:58:54 INFO  ---RUNTIME: Execution took 31140.512943267822 ms
2022-09-22 00:58:54 INFO  Done!
2022-09-22 00:58:54 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-22 00:58:54 INFO  Running instrumented original pipeline...
2022-09-22 00:58:54 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-22 00:58:54 INFO  ---RUNTIME: Importing and monkey-patching took 6.181478500366211 ms
2022-09-22 00:59:01 INFO  ---RUNTIME: Original pipeline execution took 7392.086505889893 ms (excluding imports and monkey-patching)
2022-09-22 00:59:01 INFO  Starting execution of 1 what-if analyses...
2022-09-22 00:59:01 INFO  Start plan generation for analysis DataCleaning...
2022-09-22 00:59:01 INFO  ---RUNTIME: Plan generation took 0.6709098815917969 ms
2022-09-22 00:59:01 INFO  Estimated runtime of original DAG is 6125.31042098999ms
2022-09-22 00:59:01 WARNING Skipping Multi-Query Optimization (instead, only applying patches)
2022-09-22 00:59:01 WARNING Columns ['review_id'] not present in train DAG after the train test split, only before!
2022-09-22 00:59:01 WARNING This could hint at data leakage!
2022-09-22 00:59:01 INFO  Estimated unoptimised what-if runtime is 122506.2084197998ms
2022-09-22 00:59:01 INFO  ---RUNTIME: Multi-Query Optimization took 25.177955627441406 ms
2022-09-22 00:59:01 INFO  Executing generated plans
2022-09-22 01:01:28 INFO  ---RUNTIME: Execution took 146588.1028175354 ms
2022-09-22 01:01:28 INFO  Done!
2022-09-22 01:01:28 INFO  # Finished -- repetition 1 of 7 
2022-09-22 01:01:28 INFO  # Optimization benchmark for data_cleaning with args [['reviews', 'slow_loading', 'featurization_2', 'logistic_regression']] -- repetition 2 of 7
2022-09-22 01:01:28 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-22 01:01:28 INFO  Running instrumented original pipeline...
2022-09-22 01:01:28 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-22 01:01:28 INFO  ---RUNTIME: Importing and monkey-patching took 6.119966506958008 ms
2022-09-22 01:01:35 INFO  ---RUNTIME: Original pipeline execution took 7349.670171737671 ms (excluding imports and monkey-patching)
2022-09-22 01:01:35 INFO  Starting execution of 1 what-if analyses...
2022-09-22 01:01:35 INFO  Start plan generation for analysis DataCleaning...
2022-09-22 01:01:35 INFO  ---RUNTIME: Plan generation took 0.6501674652099609 ms
2022-09-22 01:01:35 INFO  Estimated runtime of original DAG is 6100.778579711914ms
2022-09-22 01:01:35 INFO  Performing Multi-Query Optimization
2022-09-22 01:01:35 INFO  Estimated unoptimized what-if runtime is 122015.57159423828ms
2022-09-22 01:01:35 INFO  Estimated optimised what-if runtime is 24343.351125717163ms
2022-09-22 01:01:35 INFO  Estimated optimisation runtime saving is 97672.22046852112ms
2022-09-22 01:01:35 INFO  ---RUNTIME: Multi-Query Optimization took 102.26678848266602 ms
2022-09-22 01:01:35 INFO  Executing generated plans
2022-09-22 01:02:06 INFO  ---RUNTIME: Execution took 31061.432361602783 ms
2022-09-22 01:02:06 INFO  Done!
2022-09-22 01:02:06 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-22 01:02:06 INFO  Running instrumented original pipeline...
2022-09-22 01:02:06 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-22 01:02:06 INFO  ---RUNTIME: Importing and monkey-patching took 5.773782730102539 ms
2022-09-22 01:02:14 INFO  ---RUNTIME: Original pipeline execution took 7384.251117706299 ms (excluding imports and monkey-patching)
2022-09-22 01:02:14 INFO  Starting execution of 1 what-if analyses...
2022-09-22 01:02:14 INFO  Start plan generation for analysis DataCleaning...
2022-09-22 01:02:14 INFO  ---RUNTIME: Plan generation took 0.6585121154785156 ms
2022-09-22 01:02:14 INFO  Estimated runtime of original DAG is 6153.351068496704ms
2022-09-22 01:02:14 WARNING Skipping Multi-Query Optimization (instead, only applying patches)
2022-09-22 01:02:14 WARNING Columns ['review_id'] not present in train DAG after the train test split, only before!
2022-09-22 01:02:14 WARNING This could hint at data leakage!
2022-09-22 01:02:14 INFO  Estimated unoptimised what-if runtime is 123067.02136993408ms
2022-09-22 01:02:14 INFO  ---RUNTIME: Multi-Query Optimization took 25.07472038269043 ms
2022-09-22 01:02:14 INFO  Executing generated plans
2022-09-22 01:04:40 INFO  ---RUNTIME: Execution took 146105.9787273407 ms
2022-09-22 01:04:40 INFO  Done!
2022-09-22 01:04:40 INFO  # Finished -- repetition 2 of 7 
2022-09-22 01:04:40 INFO  # Optimization benchmark for data_cleaning with args [['reviews', 'slow_loading', 'featurization_2', 'logistic_regression']] -- repetition 3 of 7
2022-09-22 01:04:40 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-22 01:04:40 INFO  Running instrumented original pipeline...
2022-09-22 01:04:40 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-22 01:04:40 INFO  ---RUNTIME: Importing and monkey-patching took 6.196737289428711 ms
2022-09-22 01:04:47 INFO  ---RUNTIME: Original pipeline execution took 7224.4555950164795 ms (excluding imports and monkey-patching)
2022-09-22 01:04:47 INFO  Starting execution of 1 what-if analyses...
2022-09-22 01:04:47 INFO  Start plan generation for analysis DataCleaning...
2022-09-22 01:04:47 INFO  ---RUNTIME: Plan generation took 0.7882118225097656 ms
2022-09-22 01:04:47 INFO  Estimated runtime of original DAG is 6018.869638442993ms
2022-09-22 01:04:47 INFO  Performing Multi-Query Optimization
2022-09-22 01:04:47 INFO  Estimated unoptimized what-if runtime is 120377.39276885986ms
2022-09-22 01:04:47 INFO  Estimated optimised what-if runtime is 23769.27900314331ms
2022-09-22 01:04:47 INFO  Estimated optimisation runtime saving is 96608.11376571655ms
2022-09-22 01:04:47 INFO  ---RUNTIME: Multi-Query Optimization took 343.62149238586426 ms
2022-09-22 01:04:47 INFO  Executing generated plans
2022-09-22 01:05:19 INFO  ---RUNTIME: Execution took 31478.392839431763 ms
2022-09-22 01:05:19 INFO  Done!
2022-09-22 01:05:19 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-22 01:05:19 INFO  Running instrumented original pipeline...
2022-09-22 01:05:19 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-22 01:05:19 INFO  ---RUNTIME: Importing and monkey-patching took 6.330013275146484 ms
2022-09-22 01:05:26 INFO  ---RUNTIME: Original pipeline execution took 7317.620515823364 ms (excluding imports and monkey-patching)
2022-09-22 01:05:26 INFO  Starting execution of 1 what-if analyses...
2022-09-22 01:05:26 INFO  Start plan generation for analysis DataCleaning...
2022-09-22 01:05:26 INFO  ---RUNTIME: Plan generation took 0.6892681121826172 ms
2022-09-22 01:05:26 INFO  Estimated runtime of original DAG is 6097.477674484253ms
2022-09-22 01:05:26 WARNING Skipping Multi-Query Optimization (instead, only applying patches)
2022-09-22 01:05:26 WARNING Columns ['review_id'] not present in train DAG after the train test split, only before!
2022-09-22 01:05:26 WARNING This could hint at data leakage!
2022-09-22 01:05:26 INFO  Estimated unoptimised what-if runtime is 121949.55348968506ms
2022-09-22 01:05:26 INFO  ---RUNTIME: Multi-Query Optimization took 24.975299835205078 ms
2022-09-22 01:05:26 INFO  Executing generated plans
2022-09-22 01:07:55 INFO  ---RUNTIME: Execution took 148289.78633880615 ms
2022-09-22 01:07:55 INFO  Done!
2022-09-22 01:07:55 INFO  # Finished -- repetition 3 of 7 
2022-09-22 01:07:55 INFO  # Optimization benchmark for data_cleaning with args [['reviews', 'slow_loading', 'featurization_2', 'logistic_regression']] -- repetition 4 of 7
2022-09-22 01:07:55 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-22 01:07:55 INFO  Running instrumented original pipeline...
2022-09-22 01:07:55 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-22 01:07:55 INFO  ---RUNTIME: Importing and monkey-patching took 6.436347961425781 ms
2022-09-22 01:08:02 INFO  ---RUNTIME: Original pipeline execution took 7369.5831298828125 ms (excluding imports and monkey-patching)
2022-09-22 01:08:02 INFO  Starting execution of 1 what-if analyses...
2022-09-22 01:08:02 INFO  Start plan generation for analysis DataCleaning...
2022-09-22 01:08:02 INFO  ---RUNTIME: Plan generation took 0.63323974609375 ms
2022-09-22 01:08:02 INFO  Estimated runtime of original DAG is 6126.699209213257ms
2022-09-22 01:08:02 INFO  Performing Multi-Query Optimization
2022-09-22 01:08:02 INFO  Estimated unoptimized what-if runtime is 122533.98418426514ms
2022-09-22 01:08:02 INFO  Estimated optimised what-if runtime is 23588.266372680664ms
2022-09-22 01:08:02 INFO  Estimated optimisation runtime saving is 98945.71781158447ms
2022-09-22 01:08:02 INFO  ---RUNTIME: Multi-Query Optimization took 101.67956352233887 ms
2022-09-22 01:08:02 INFO  Executing generated plans
2022-09-22 01:08:33 INFO  ---RUNTIME: Execution took 30920.57776451111 ms
2022-09-22 01:08:33 INFO  Done!
2022-09-22 01:08:33 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-22 01:08:33 INFO  Running instrumented original pipeline...
2022-09-22 01:08:33 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-22 01:08:33 INFO  ---RUNTIME: Importing and monkey-patching took 6.169557571411133 ms
2022-09-22 01:08:40 INFO  ---RUNTIME: Original pipeline execution took 7437.415361404419 ms (excluding imports and monkey-patching)
2022-09-22 01:08:40 INFO  Starting execution of 1 what-if analyses...
2022-09-22 01:08:40 INFO  Start plan generation for analysis DataCleaning...
2022-09-22 01:08:40 INFO  ---RUNTIME: Plan generation took 0.6358623504638672 ms
2022-09-22 01:08:40 INFO  Estimated runtime of original DAG is 6216.336965560913ms
2022-09-22 01:08:40 WARNING Skipping Multi-Query Optimization (instead, only applying patches)
2022-09-22 01:08:40 WARNING Columns ['review_id'] not present in train DAG after the train test split, only before!
2022-09-22 01:08:40 WARNING This could hint at data leakage!
2022-09-22 01:08:40 INFO  Estimated unoptimised what-if runtime is 124326.73931121826ms
2022-09-22 01:08:40 INFO  ---RUNTIME: Multi-Query Optimization took 28.17535400390625 ms
2022-09-22 01:08:40 INFO  Executing generated plans
2022-09-22 01:11:07 INFO  ---RUNTIME: Execution took 146710.0477218628 ms
2022-09-22 01:11:07 INFO  Done!
2022-09-22 01:11:07 INFO  # Finished -- repetition 4 of 7 
2022-09-22 01:11:07 INFO  # Optimization benchmark for data_cleaning with args [['reviews', 'slow_loading', 'featurization_2', 'logistic_regression']] -- repetition 5 of 7
2022-09-22 01:11:07 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-22 01:11:07 INFO  Running instrumented original pipeline...
2022-09-22 01:11:07 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-22 01:11:07 INFO  ---RUNTIME: Importing and monkey-patching took 6.08062744140625 ms
2022-09-22 01:11:15 INFO  ---RUNTIME: Original pipeline execution took 7371.7942237854 ms (excluding imports and monkey-patching)
2022-09-22 01:11:15 INFO  Starting execution of 1 what-if analyses...
2022-09-22 01:11:15 INFO  Start plan generation for analysis DataCleaning...
2022-09-22 01:11:15 INFO  ---RUNTIME: Plan generation took 0.6434917449951172 ms
2022-09-22 01:11:15 INFO  Estimated runtime of original DAG is 6099.344491958618ms
2022-09-22 01:11:15 INFO  Performing Multi-Query Optimization
2022-09-22 01:11:15 INFO  Estimated unoptimized what-if runtime is 121986.88983917236ms
2022-09-22 01:11:15 INFO  Estimated optimised what-if runtime is 24073.627948760986ms
2022-09-22 01:11:15 INFO  Estimated optimisation runtime saving is 97913.26189041138ms
2022-09-22 01:11:15 INFO  ---RUNTIME: Multi-Query Optimization took 100.54993629455566 ms
2022-09-22 01:11:15 INFO  Executing generated plans
2022-09-22 01:11:46 INFO  ---RUNTIME: Execution took 31280.09057044983 ms
2022-09-22 01:11:46 INFO  Done!
2022-09-22 01:11:46 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-22 01:11:46 INFO  Running instrumented original pipeline...
2022-09-22 01:11:46 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-22 01:11:46 INFO  ---RUNTIME: Importing and monkey-patching took 6.138324737548828 ms
2022-09-22 01:11:53 INFO  ---RUNTIME: Original pipeline execution took 7193.579912185669 ms (excluding imports and monkey-patching)
2022-09-22 01:11:53 INFO  Starting execution of 1 what-if analyses...
2022-09-22 01:11:53 INFO  Start plan generation for analysis DataCleaning...
2022-09-22 01:11:53 INFO  ---RUNTIME: Plan generation took 0.7498264312744141 ms
2022-09-22 01:11:53 INFO  Estimated runtime of original DAG is 5993.44277381897ms
2022-09-22 01:11:53 WARNING Skipping Multi-Query Optimization (instead, only applying patches)
2022-09-22 01:11:53 WARNING Columns ['review_id'] not present in train DAG after the train test split, only before!
2022-09-22 01:11:53 WARNING This could hint at data leakage!
2022-09-22 01:11:53 INFO  Estimated unoptimised what-if runtime is 119868.8554763794ms
2022-09-22 01:11:53 INFO  ---RUNTIME: Multi-Query Optimization took 26.45397186279297 ms
2022-09-22 01:11:53 INFO  Executing generated plans
2022-09-22 01:14:20 INFO  ---RUNTIME: Execution took 146915.15254974365 ms
2022-09-22 01:14:20 INFO  Done!
2022-09-22 01:14:20 INFO  # Finished -- repetition 5 of 7 
2022-09-22 01:14:20 INFO  # Optimization benchmark for data_cleaning with args [['reviews', 'slow_loading', 'featurization_2', 'logistic_regression']] -- repetition 6 of 7
2022-09-22 01:14:20 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-22 01:14:20 INFO  Running instrumented original pipeline...
2022-09-22 01:14:20 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-22 01:14:20 INFO  ---RUNTIME: Importing and monkey-patching took 6.110429763793945 ms
2022-09-22 01:14:27 INFO  ---RUNTIME: Original pipeline execution took 7167.439222335815 ms (excluding imports and monkey-patching)
2022-09-22 01:14:27 INFO  Starting execution of 1 what-if analyses...
2022-09-22 01:14:27 INFO  Start plan generation for analysis DataCleaning...
2022-09-22 01:14:27 INFO  ---RUNTIME: Plan generation took 0.6089210510253906 ms
2022-09-22 01:14:27 INFO  Estimated runtime of original DAG is 5966.397047042847ms
2022-09-22 01:14:27 INFO  Performing Multi-Query Optimization
2022-09-22 01:14:27 INFO  Estimated unoptimized what-if runtime is 119327.94094085693ms
2022-09-22 01:14:27 INFO  Estimated optimised what-if runtime is 23217.398643493652ms
2022-09-22 01:14:27 INFO  Estimated optimisation runtime saving is 96110.54229736328ms
2022-09-22 01:14:27 INFO  ---RUNTIME: Multi-Query Optimization took 99.5781421661377 ms
2022-09-22 01:14:27 INFO  Executing generated plans
2022-09-22 01:14:59 INFO  ---RUNTIME: Execution took 31358.109951019287 ms
2022-09-22 01:14:59 INFO  Done!
2022-09-22 01:14:59 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-22 01:14:59 INFO  Running instrumented original pipeline...
2022-09-22 01:14:59 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-22 01:14:59 INFO  ---RUNTIME: Importing and monkey-patching took 6.724357604980469 ms
2022-09-22 01:15:06 INFO  ---RUNTIME: Original pipeline execution took 7229.655742645264 ms (excluding imports and monkey-patching)
2022-09-22 01:15:06 INFO  Starting execution of 1 what-if analyses...
2022-09-22 01:15:06 INFO  Start plan generation for analysis DataCleaning...
2022-09-22 01:15:06 INFO  ---RUNTIME: Plan generation took 0.6191730499267578 ms
2022-09-22 01:15:06 INFO  Estimated runtime of original DAG is 6026.569843292236ms
2022-09-22 01:15:06 WARNING Skipping Multi-Query Optimization (instead, only applying patches)
2022-09-22 01:15:06 WARNING Columns ['review_id'] not present in train DAG after the train test split, only before!
2022-09-22 01:15:06 WARNING This could hint at data leakage!
2022-09-22 01:15:06 INFO  Estimated unoptimised what-if runtime is 120531.39686584473ms
2022-09-22 01:15:06 INFO  ---RUNTIME: Multi-Query Optimization took 24.860143661499023 ms
2022-09-22 01:15:06 INFO  Executing generated plans
2022-09-22 01:17:31 INFO  ---RUNTIME: Execution took 145501.4989376068 ms
2022-09-22 01:17:31 INFO  Done!
2022-09-22 01:17:32 INFO  # Finished -- repetition 6 of 7 
2022-09-22 01:17:32 INFO  # Optimization benchmark for data_cleaning with args [['reviews', 'slow_loading', 'featurization_2', 'logistic_regression']] -- repetition 7 of 7
2022-09-22 01:17:32 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-22 01:17:32 INFO  Running instrumented original pipeline...
2022-09-22 01:17:32 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-22 01:17:32 INFO  ---RUNTIME: Importing and monkey-patching took 6.010293960571289 ms
2022-09-22 01:17:39 INFO  ---RUNTIME: Original pipeline execution took 7430.327415466309 ms (excluding imports and monkey-patching)
2022-09-22 01:17:39 INFO  Starting execution of 1 what-if analyses...
2022-09-22 01:17:39 INFO  Start plan generation for analysis DataCleaning...
2022-09-22 01:17:39 INFO  ---RUNTIME: Plan generation took 0.6301403045654297 ms
2022-09-22 01:17:39 INFO  Estimated runtime of original DAG is 6183.362722396851ms
2022-09-22 01:17:39 INFO  Performing Multi-Query Optimization
2022-09-22 01:17:39 INFO  Estimated unoptimized what-if runtime is 123667.25444793701ms
2022-09-22 01:17:39 INFO  Estimated optimised what-if runtime is 23385.56671142578ms
2022-09-22 01:17:39 INFO  Estimated optimisation runtime saving is 100281.68773651123ms
2022-09-22 01:17:39 INFO  ---RUNTIME: Multi-Query Optimization took 100.13294219970703 ms
2022-09-22 01:17:39 INFO  Executing generated plans
2022-09-22 01:18:10 INFO  ---RUNTIME: Execution took 30966.08805656433 ms
2022-09-22 01:18:10 INFO  Done!
2022-09-22 01:18:10 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-22 01:18:10 INFO  Running instrumented original pipeline...
2022-09-22 01:18:10 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-22 01:18:10 INFO  ---RUNTIME: Importing and monkey-patching took 6.065845489501953 ms
2022-09-22 01:18:17 INFO  ---RUNTIME: Original pipeline execution took 7154.527902603149 ms (excluding imports and monkey-patching)
2022-09-22 01:18:17 INFO  Starting execution of 1 what-if analyses...
2022-09-22 01:18:17 INFO  Start plan generation for analysis DataCleaning...
2022-09-22 01:18:17 INFO  ---RUNTIME: Plan generation took 0.7028579711914062 ms
2022-09-22 01:18:17 INFO  Estimated runtime of original DAG is 5965.001821517944ms
2022-09-22 01:18:17 WARNING Skipping Multi-Query Optimization (instead, only applying patches)
2022-09-22 01:18:17 WARNING Columns ['review_id'] not present in train DAG after the train test split, only before!
2022-09-22 01:18:17 WARNING This could hint at data leakage!
2022-09-22 01:18:17 INFO  Estimated unoptimised what-if runtime is 119300.03643035889ms
2022-09-22 01:18:17 INFO  ---RUNTIME: Multi-Query Optimization took 26.32904052734375 ms
2022-09-22 01:18:17 INFO  Executing generated plans
2022-09-22 01:20:44 INFO  ---RUNTIME: Execution took 146627.7298927307 ms
2022-09-22 01:20:44 INFO  Done!
2022-09-22 01:20:44 INFO  # Finished -- repetition 7 of 7 
2022-09-22 01:20:44 INFO  # Final results after all repetitions
2022-09-22 01:20:44 INFO     repetition  ... no_opt_what_if_execution_combined_model_training
0           0  ...                                      2300.107479
1           1  ...                                      2292.477131
2           2  ...                                      2265.077114
3           3  ...                                      2250.459671
4           4  ...                                      2226.531744
5           5  ...                                      2191.668749
6           6  ...                                      2169.796467

[7 rows x 26 columns]
taskset -c 160-167 PROTOCOL_BUFFERS_PYTHON_IMPLEMENTATION=python python3.9 benchmarks_end_to_end.py data_cleaning reviews slow_loading featurization_2 xgboost
2022-09-22 01:20:46.434634: W tensorflow/stream_executor/platform/default/dso_loader.cc:64] Could not load dynamic library 'libcudart.so.11.0'; dlerror: libcudart.so.11.0: cannot open shared object file: No such file or directory; LD_LIBRARY_PATH: /home/sgrafbe/mlwhatif/venv/lib/python3.9/site-packages/cv2/../../lib64:
2022-09-22 01:20:46.434678: I tensorflow/stream_executor/cuda/cudart_stub.cc:29] Ignore above cudart dlerror if you do not have a GPU set up on your machine.
2022-09-22 01:20:47 INFO  Patching sys.argv with ['mlwhatif', 'reviews', 'slow_loading', 'featurization_2', 'xgboost']
2022-09-22 01:20:47 INFO  Running instrumented original pipeline...
2022-09-22 01:20:47 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-22 01:20:47 INFO  ---RUNTIME: Importing and monkey-patching took 95.58773040771484 ms
2022-09-22 01:21:07 INFO  ---RUNTIME: Original pipeline execution took 20095.361948013306 ms (excluding imports and monkey-patching)
2022-09-22 01:21:07 INFO  Starting execution of 0 what-if analyses...
2022-09-22 01:21:07 INFO  Estimated runtime of original DAG is 18832.20648765564ms
2022-09-22 01:21:07 INFO  Performing Multi-Query Optimization
2022-09-22 01:21:07 INFO  Estimated unoptimized what-if runtime is 0ms
2022-09-22 01:21:07 INFO  Estimated optimised what-if runtime is 0ms
2022-09-22 01:21:07 INFO  Estimated optimisation runtime saving is 0ms
2022-09-22 01:21:07 INFO  ---RUNTIME: Multi-Query Optimization took 0.5383491516113281 ms
2022-09-22 01:21:07 INFO  Executing generated plans
2022-09-22 01:21:07 INFO  ---RUNTIME: Execution took 0.025510787963867188 ms
2022-09-22 01:21:07 INFO  Done!
2022-09-22 01:21:07 INFO  # Optimization benchmark for data_cleaning with args [['reviews', 'slow_loading', 'featurization_2', 'xgboost']] -- repetition 1 of 7
2022-09-22 01:21:07 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-22 01:21:07 INFO  Running instrumented original pipeline...
2022-09-22 01:21:07 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-22 01:21:07 INFO  ---RUNTIME: Importing and monkey-patching took 5.553245544433594 ms
2022-09-22 01:21:27 INFO  ---RUNTIME: Original pipeline execution took 19658.07843208313 ms (excluding imports and monkey-patching)
2022-09-22 01:21:27 INFO  Starting execution of 1 what-if analyses...
2022-09-22 01:21:27 INFO  Start plan generation for analysis DataCleaning...
2022-09-22 01:21:27 INFO  ---RUNTIME: Plan generation took 0.6563663482666016 ms
2022-09-22 01:21:27 INFO  Estimated runtime of original DAG is 18494.40097808838ms
2022-09-22 01:21:27 INFO  Performing Multi-Query Optimization
2022-09-22 01:21:27 INFO  Estimated unoptimized what-if runtime is 369888.0195617676ms
2022-09-22 01:21:27 INFO  Estimated optimised what-if runtime is 275468.88995170593ms
2022-09-22 01:21:27 INFO  Estimated optimisation runtime saving is 94419.12961006165ms
2022-09-22 01:21:27 INFO  ---RUNTIME: Multi-Query Optimization took 103.12867164611816 ms
2022-09-22 01:21:27 INFO  Executing generated plans
2022-09-22 01:26:28 INFO  ---RUNTIME: Execution took 301165.07744789124 ms
2022-09-22 01:26:28 INFO  Done!
2022-09-22 01:26:28 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-22 01:26:28 INFO  Running instrumented original pipeline...
2022-09-22 01:26:28 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-22 01:26:28 INFO  ---RUNTIME: Importing and monkey-patching took 6.434917449951172 ms
2022-09-22 01:26:48 INFO  ---RUNTIME: Original pipeline execution took 20041.32914543152 ms (excluding imports and monkey-patching)
2022-09-22 01:26:48 INFO  Starting execution of 1 what-if analyses...
2022-09-22 01:26:48 INFO  Start plan generation for analysis DataCleaning...
2022-09-22 01:26:48 INFO  ---RUNTIME: Plan generation took 0.6935596466064453 ms
2022-09-22 01:26:48 INFO  Estimated runtime of original DAG is 18860.594272613525ms
2022-09-22 01:26:48 WARNING Skipping Multi-Query Optimization (instead, only applying patches)
2022-09-22 01:26:48 WARNING Columns ['review_id'] not present in train DAG after the train test split, only before!
2022-09-22 01:26:48 WARNING This could hint at data leakage!
2022-09-22 01:26:48 INFO  Estimated unoptimised what-if runtime is 377211.8854522705ms
2022-09-22 01:26:48 INFO  ---RUNTIME: Multi-Query Optimization took 25.486230850219727 ms
2022-09-22 01:26:48 INFO  Executing generated plans
2022-09-22 01:33:40 INFO  ---RUNTIME: Execution took 411208.7502479553 ms
2022-09-22 01:33:40 INFO  Done!
2022-09-22 01:33:40 INFO  # Finished -- repetition 1 of 7 
2022-09-22 01:33:40 INFO  # Optimization benchmark for data_cleaning with args [['reviews', 'slow_loading', 'featurization_2', 'xgboost']] -- repetition 2 of 7
2022-09-22 01:33:40 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-22 01:33:40 INFO  Running instrumented original pipeline...
2022-09-22 01:33:40 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-22 01:33:40 INFO  ---RUNTIME: Importing and monkey-patching took 6.399393081665039 ms
2022-09-22 01:33:59 INFO  ---RUNTIME: Original pipeline execution took 19730.09729385376 ms (excluding imports and monkey-patching)
2022-09-22 01:33:59 INFO  Starting execution of 1 what-if analyses...
2022-09-22 01:33:59 INFO  Start plan generation for analysis DataCleaning...
2022-09-22 01:33:59 INFO  ---RUNTIME: Plan generation took 0.6546974182128906 ms
2022-09-22 01:33:59 INFO  Estimated runtime of original DAG is 18544.421195983887ms
2022-09-22 01:33:59 INFO  Performing Multi-Query Optimization
2022-09-22 01:33:59 INFO  Estimated unoptimized what-if runtime is 370888.42391967773ms
2022-09-22 01:33:59 INFO  Estimated optimised what-if runtime is 276213.9627933502ms
2022-09-22 01:33:59 INFO  Estimated optimisation runtime saving is 94674.46112632751ms
2022-09-22 01:33:59 INFO  ---RUNTIME: Multi-Query Optimization took 103.22380065917969 ms
2022-09-22 01:33:59 INFO  Executing generated plans
2022-09-22 01:38:59 INFO  ---RUNTIME: Execution took 299557.8148365021 ms
2022-09-22 01:38:59 INFO  Done!
2022-09-22 01:38:59 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-22 01:38:59 INFO  Running instrumented original pipeline...
2022-09-22 01:38:59 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-22 01:38:59 INFO  ---RUNTIME: Importing and monkey-patching took 6.59489631652832 ms
2022-09-22 01:39:19 INFO  ---RUNTIME: Original pipeline execution took 19797.2571849823 ms (excluding imports and monkey-patching)
2022-09-22 01:39:19 INFO  Starting execution of 1 what-if analyses...
2022-09-22 01:39:19 INFO  Start plan generation for analysis DataCleaning...
2022-09-22 01:39:19 INFO  ---RUNTIME: Plan generation took 0.6546974182128906 ms
2022-09-22 01:39:19 INFO  Estimated runtime of original DAG is 18614.689350128174ms
2022-09-22 01:39:19 WARNING Skipping Multi-Query Optimization (instead, only applying patches)
2022-09-22 01:39:19 WARNING Columns ['review_id'] not present in train DAG after the train test split, only before!
2022-09-22 01:39:19 WARNING This could hint at data leakage!
2022-09-22 01:39:19 INFO  Estimated unoptimised what-if runtime is 372293.7870025635ms
2022-09-22 01:39:19 INFO  ---RUNTIME: Multi-Query Optimization took 24.899959564208984 ms
2022-09-22 01:39:19 INFO  Executing generated plans
2022-09-22 01:46:10 INFO  ---RUNTIME: Execution took 411081.1834335327 ms
2022-09-22 01:46:10 INFO  Done!
2022-09-22 01:46:10 INFO  # Finished -- repetition 2 of 7 
2022-09-22 01:46:10 INFO  # Optimization benchmark for data_cleaning with args [['reviews', 'slow_loading', 'featurization_2', 'xgboost']] -- repetition 3 of 7
2022-09-22 01:46:10 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-22 01:46:10 INFO  Running instrumented original pipeline...
2022-09-22 01:46:10 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-22 01:46:10 INFO  ---RUNTIME: Importing and monkey-patching took 6.226539611816406 ms
2022-09-22 01:46:30 INFO  ---RUNTIME: Original pipeline execution took 19663.59829902649 ms (excluding imports and monkey-patching)
2022-09-22 01:46:30 INFO  Starting execution of 1 what-if analyses...
2022-09-22 01:46:30 INFO  Start plan generation for analysis DataCleaning...
2022-09-22 01:46:30 INFO  ---RUNTIME: Plan generation took 0.6666183471679688 ms
2022-09-22 01:46:30 INFO  Estimated runtime of original DAG is 18489.779233932495ms
2022-09-22 01:46:30 INFO  Performing Multi-Query Optimization
2022-09-22 01:46:30 INFO  Estimated unoptimized what-if runtime is 369795.5846786499ms
2022-09-22 01:46:30 INFO  Estimated optimised what-if runtime is 275821.04659080505ms
2022-09-22 01:46:30 INFO  Estimated optimisation runtime saving is 93974.53808784485ms
2022-09-22 01:46:30 INFO  ---RUNTIME: Multi-Query Optimization took 300.5490303039551 ms
2022-09-22 01:46:30 INFO  Executing generated plans
2022-09-22 01:51:29 INFO  ---RUNTIME: Execution took 299443.4325695038 ms
2022-09-22 01:51:29 INFO  Done!
2022-09-22 01:51:29 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-22 01:51:29 INFO  Running instrumented original pipeline...
2022-09-22 01:51:29 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-22 01:51:29 INFO  ---RUNTIME: Importing and monkey-patching took 6.206035614013672 ms
2022-09-22 01:51:49 INFO  ---RUNTIME: Original pipeline execution took 19800.48155784607 ms (excluding imports and monkey-patching)
2022-09-22 01:51:49 INFO  Starting execution of 1 what-if analyses...
2022-09-22 01:51:49 INFO  Start plan generation for analysis DataCleaning...
2022-09-22 01:51:49 INFO  ---RUNTIME: Plan generation took 0.7069110870361328 ms
2022-09-22 01:51:49 INFO  Estimated runtime of original DAG is 18613.221406936646ms
2022-09-22 01:51:49 WARNING Skipping Multi-Query Optimization (instead, only applying patches)
2022-09-22 01:51:49 WARNING Columns ['review_id'] not present in train DAG after the train test split, only before!
2022-09-22 01:51:49 WARNING This could hint at data leakage!
2022-09-22 01:51:49 INFO  Estimated unoptimised what-if runtime is 372264.4281387329ms
2022-09-22 01:51:49 INFO  ---RUNTIME: Multi-Query Optimization took 24.684906005859375 ms
2022-09-22 01:51:49 INFO  Executing generated plans
2022-09-22 01:58:42 INFO  ---RUNTIME: Execution took 412886.77763938904 ms
2022-09-22 01:58:42 INFO  Done!
2022-09-22 01:58:42 INFO  # Finished -- repetition 3 of 7 
2022-09-22 01:58:42 INFO  # Optimization benchmark for data_cleaning with args [['reviews', 'slow_loading', 'featurization_2', 'xgboost']] -- repetition 4 of 7
2022-09-22 01:58:42 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-22 01:58:42 INFO  Running instrumented original pipeline...
2022-09-22 01:58:42 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-22 01:58:42 INFO  ---RUNTIME: Importing and monkey-patching took 6.122350692749023 ms
2022-09-22 01:59:02 INFO  ---RUNTIME: Original pipeline execution took 19811.97762489319 ms (excluding imports and monkey-patching)
2022-09-22 01:59:02 INFO  Starting execution of 1 what-if analyses...
2022-09-22 01:59:02 INFO  Start plan generation for analysis DataCleaning...
2022-09-22 01:59:02 INFO  ---RUNTIME: Plan generation took 0.6046295166015625 ms
2022-09-22 01:59:02 INFO  Estimated runtime of original DAG is 18624.67312812805ms
2022-09-22 01:59:02 INFO  Performing Multi-Query Optimization
2022-09-22 01:59:02 INFO  Estimated unoptimized what-if runtime is 372493.46256256104ms
2022-09-22 01:59:02 INFO  Estimated optimised what-if runtime is 277612.78343200684ms
2022-09-22 01:59:02 INFO  Estimated optimisation runtime saving is 94880.6791305542ms
2022-09-22 01:59:02 INFO  ---RUNTIME: Multi-Query Optimization took 100.27241706848145 ms
2022-09-22 01:59:02 INFO  Executing generated plans
2022-09-22 02:04:44 INFO  ---RUNTIME: Execution took 341953.64022254944 ms
2022-09-22 02:04:44 INFO  Done!
2022-09-22 02:04:44 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-22 02:04:44 INFO  Running instrumented original pipeline...
2022-09-22 02:04:44 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-22 02:04:44 INFO  ---RUNTIME: Importing and monkey-patching took 6.458282470703125 ms
2022-09-22 02:05:08 INFO  ---RUNTIME: Original pipeline execution took 23935.593605041504 ms (excluding imports and monkey-patching)
2022-09-22 02:05:08 INFO  Starting execution of 1 what-if analyses...
2022-09-22 02:05:08 INFO  Start plan generation for analysis DataCleaning...
2022-09-22 02:05:08 INFO  ---RUNTIME: Plan generation took 0.6844997406005859 ms
2022-09-22 02:05:08 INFO  Estimated runtime of original DAG is 22172.460556030273ms
2022-09-22 02:05:08 WARNING Skipping Multi-Query Optimization (instead, only applying patches)
2022-09-22 02:05:08 WARNING Columns ['review_id'] not present in train DAG after the train test split, only before!
2022-09-22 02:05:08 WARNING This could hint at data leakage!
2022-09-22 02:05:08 INFO  Estimated unoptimised what-if runtime is 443449.21112060547ms
2022-09-22 02:05:08 INFO  ---RUNTIME: Multi-Query Optimization took 24.66416358947754 ms
2022-09-22 02:05:08 INFO  Executing generated plans
2022-09-22 02:13:14 INFO  ---RUNTIME: Execution took 486253.80992889404 ms
2022-09-22 02:13:14 INFO  Done!
2022-09-22 02:13:14 INFO  # Finished -- repetition 4 of 7 
2022-09-22 02:13:14 INFO  # Optimization benchmark for data_cleaning with args [['reviews', 'slow_loading', 'featurization_2', 'xgboost']] -- repetition 5 of 7
2022-09-22 02:13:14 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-22 02:13:14 INFO  Running instrumented original pipeline...
2022-09-22 02:13:14 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-22 02:13:14 INFO  ---RUNTIME: Importing and monkey-patching took 8.498907089233398 ms
2022-09-22 02:13:37 INFO  ---RUNTIME: Original pipeline execution took 23127.25520133972 ms (excluding imports and monkey-patching)
2022-09-22 02:13:37 INFO  Starting execution of 1 what-if analyses...
2022-09-22 02:13:37 INFO  Start plan generation for analysis DataCleaning...
2022-09-22 02:13:37 INFO  ---RUNTIME: Plan generation took 0.8599758148193359 ms
2022-09-22 02:13:37 INFO  Estimated runtime of original DAG is 21403.393507003784ms
2022-09-22 02:13:37 INFO  Performing Multi-Query Optimization
2022-09-22 02:13:38 INFO  Estimated unoptimized what-if runtime is 428067.8701400757ms
2022-09-22 02:13:38 INFO  Estimated optimised what-if runtime is 288567.84415245056ms
2022-09-22 02:13:38 INFO  Estimated optimisation runtime saving is 139500.02598762512ms
2022-09-22 02:13:38 INFO  ---RUNTIME: Multi-Query Optimization took 184.80277061462402 ms
2022-09-22 02:13:38 INFO  Executing generated plans
2022-09-22 02:19:25 INFO  ---RUNTIME: Execution took 347596.8601703644 ms
2022-09-22 02:19:25 INFO  Done!
2022-09-22 02:19:25 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-22 02:19:25 INFO  Running instrumented original pipeline...
2022-09-22 02:19:25 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-22 02:19:25 INFO  ---RUNTIME: Importing and monkey-patching took 9.818077087402344 ms
2022-09-22 02:19:48 INFO  ---RUNTIME: Original pipeline execution took 23084.555625915527 ms (excluding imports and monkey-patching)
2022-09-22 02:19:48 INFO  Starting execution of 1 what-if analyses...
2022-09-22 02:19:48 INFO  Start plan generation for analysis DataCleaning...
2022-09-22 02:19:48 INFO  ---RUNTIME: Plan generation took 0.9765625 ms
2022-09-22 02:19:48 INFO  Estimated runtime of original DAG is 21455.45220375061ms
2022-09-22 02:19:48 WARNING Skipping Multi-Query Optimization (instead, only applying patches)
2022-09-22 02:19:48 WARNING Columns ['review_id'] not present in train DAG after the train test split, only before!
2022-09-22 02:19:48 WARNING This could hint at data leakage!
2022-09-22 02:19:48 INFO  Estimated unoptimised what-if runtime is 429109.0440750122ms
2022-09-22 02:19:48 INFO  ---RUNTIME: Multi-Query Optimization took 44.49272155761719 ms
2022-09-22 02:19:48 INFO  Executing generated plans
2022-09-22 02:27:58 INFO  ---RUNTIME: Execution took 489228.03473472595 ms
2022-09-22 02:27:58 INFO  Done!
2022-09-22 02:27:58 INFO  # Finished -- repetition 5 of 7 
2022-09-22 02:27:58 INFO  # Optimization benchmark for data_cleaning with args [['reviews', 'slow_loading', 'featurization_2', 'xgboost']] -- repetition 6 of 7
2022-09-22 02:27:58 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-22 02:27:58 INFO  Running instrumented original pipeline...
2022-09-22 02:27:58 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-22 02:27:58 INFO  ---RUNTIME: Importing and monkey-patching took 6.293296813964844 ms
2022-09-22 02:28:21 INFO  ---RUNTIME: Original pipeline execution took 23309.06057357788 ms (excluding imports and monkey-patching)
2022-09-22 02:28:21 INFO  Starting execution of 1 what-if analyses...
2022-09-22 02:28:21 INFO  Start plan generation for analysis DataCleaning...
2022-09-22 02:28:21 INFO  ---RUNTIME: Plan generation took 0.6096363067626953 ms
2022-09-22 02:28:21 INFO  Estimated runtime of original DAG is 22104.46524620056ms
2022-09-22 02:28:21 INFO  Performing Multi-Query Optimization
2022-09-22 02:28:21 INFO  Estimated unoptimized what-if runtime is 442089.30492401123ms
2022-09-22 02:28:21 INFO  Estimated optimised what-if runtime is 337848.0010032654ms
2022-09-22 02:28:21 INFO  Estimated optimisation runtime saving is 104241.30392074585ms
2022-09-22 02:28:21 INFO  ---RUNTIME: Multi-Query Optimization took 100.90398788452148 ms
2022-09-22 02:28:21 INFO  Executing generated plans
2022-09-22 02:34:07 INFO  ---RUNTIME: Execution took 346254.0497779846 ms
2022-09-22 02:34:07 INFO  Done!
2022-09-22 02:34:07 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-22 02:34:07 INFO  Running instrumented original pipeline...
2022-09-22 02:34:07 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-22 02:34:07 INFO  ---RUNTIME: Importing and monkey-patching took 11.348485946655273 ms
2022-09-22 02:34:30 INFO  ---RUNTIME: Original pipeline execution took 23235.094785690308 ms (excluding imports and monkey-patching)
2022-09-22 02:34:30 INFO  Starting execution of 1 what-if analyses...
2022-09-22 02:34:30 INFO  Start plan generation for analysis DataCleaning...
2022-09-22 02:34:30 INFO  ---RUNTIME: Plan generation took 0.7653236389160156 ms
2022-09-22 02:34:30 INFO  Estimated runtime of original DAG is 21879.194021224976ms
2022-09-22 02:34:30 WARNING Skipping Multi-Query Optimization (instead, only applying patches)
2022-09-22 02:34:31 WARNING Columns ['review_id'] not present in train DAG after the train test split, only before!
2022-09-22 02:34:31 WARNING This could hint at data leakage!
2022-09-22 02:34:31 INFO  Estimated unoptimised what-if runtime is 437583.8804244995ms
2022-09-22 02:34:31 INFO  ---RUNTIME: Multi-Query Optimization took 40.92812538146973 ms
2022-09-22 02:34:31 INFO  Executing generated plans
2022-09-22 02:42:36 INFO  ---RUNTIME: Execution took 485108.54864120483 ms
2022-09-22 02:42:36 INFO  Done!
2022-09-22 02:42:36 INFO  # Finished -- repetition 6 of 7 
2022-09-22 02:42:36 INFO  # Optimization benchmark for data_cleaning with args [['reviews', 'slow_loading', 'featurization_2', 'xgboost']] -- repetition 7 of 7
2022-09-22 02:42:36 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-22 02:42:36 INFO  Running instrumented original pipeline...
2022-09-22 02:42:36 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-22 02:42:36 INFO  ---RUNTIME: Importing and monkey-patching took 9.97781753540039 ms
2022-09-22 02:42:59 INFO  ---RUNTIME: Original pipeline execution took 23449.408054351807 ms (excluding imports and monkey-patching)
2022-09-22 02:42:59 INFO  Starting execution of 1 what-if analyses...
2022-09-22 02:42:59 INFO  Start plan generation for analysis DataCleaning...
2022-09-22 02:42:59 INFO  ---RUNTIME: Plan generation took 0.7276535034179688 ms
2022-09-22 02:42:59 INFO  Estimated runtime of original DAG is 21722.73349761963ms
2022-09-22 02:42:59 INFO  Performing Multi-Query Optimization
2022-09-22 02:42:59 INFO  Estimated unoptimized what-if runtime is 434454.6699523926ms
2022-09-22 02:42:59 INFO  Estimated optimised what-if runtime is 297264.8813724518ms
2022-09-22 02:42:59 INFO  Estimated optimisation runtime saving is 137189.7885799408ms
2022-09-22 02:42:59 INFO  ---RUNTIME: Multi-Query Optimization took 157.55486488342285 ms
2022-09-22 02:42:59 INFO  Executing generated plans
2022-09-22 02:48:48 INFO  ---RUNTIME: Execution took 348761.28029823303 ms
2022-09-22 02:48:48 INFO  Done!
2022-09-22 02:48:48 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-22 02:48:48 INFO  Running instrumented original pipeline...
2022-09-22 02:48:48 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-22 02:48:48 INFO  ---RUNTIME: Importing and monkey-patching took 10.951757431030273 ms
2022-09-22 02:49:09 INFO  ---RUNTIME: Original pipeline execution took 20758.26382637024 ms (excluding imports and monkey-patching)
2022-09-22 02:49:09 INFO  Starting execution of 1 what-if analyses...
2022-09-22 02:49:09 INFO  Start plan generation for analysis DataCleaning...
2022-09-22 02:49:09 INFO  ---RUNTIME: Plan generation took 0.7116794586181641 ms
2022-09-22 02:49:09 INFO  Estimated runtime of original DAG is 19195.518016815186ms
2022-09-22 02:49:09 WARNING Skipping Multi-Query Optimization (instead, only applying patches)
2022-09-22 02:49:09 WARNING Columns ['review_id'] not present in train DAG after the train test split, only before!
2022-09-22 02:49:09 WARNING This could hint at data leakage!
2022-09-22 02:49:09 INFO  Estimated unoptimised what-if runtime is 383910.3603363037ms
2022-09-22 02:49:09 INFO  ---RUNTIME: Multi-Query Optimization took 24.911880493164062 ms
2022-09-22 02:49:09 INFO  Executing generated plans
2022-09-22 02:57:15 INFO  ---RUNTIME: Execution took 486053.2834529877 ms
2022-09-22 02:57:15 INFO  Done!
2022-09-22 02:57:15 INFO  # Finished -- repetition 7 of 7 
2022-09-22 02:57:15 INFO  # Final results after all repetitions
2022-09-22 02:57:15 INFO     repetition  ... no_opt_what_if_execution_combined_model_training
0           0  ...                                    269739.021778
1           1  ...                                    270419.165611
2           2  ...                                    271304.792404
3           3  ...                                    319694.139957
4           4  ...                                    313389.268637
5           5  ...                                    312208.962440
6           6  ...                                    302444.624186

[7 rows x 26 columns]
taskset -c 160-167 PROTOCOL_BUFFERS_PYTHON_IMPLEMENTATION=python python3.9 benchmarks_end_to_end.py data_cleaning reviews slow_loading featurization_2 neural_network
2022-09-22 02:57:17.533680: W tensorflow/stream_executor/platform/default/dso_loader.cc:64] Could not load dynamic library 'libcudart.so.11.0'; dlerror: libcudart.so.11.0: cannot open shared object file: No such file or directory; LD_LIBRARY_PATH: /home/sgrafbe/mlwhatif/venv/lib/python3.9/site-packages/cv2/../../lib64:
2022-09-22 02:57:17.533727: I tensorflow/stream_executor/cuda/cudart_stub.cc:29] Ignore above cudart dlerror if you do not have a GPU set up on your machine.
2022-09-22 02:57:19 INFO  Patching sys.argv with ['mlwhatif', 'reviews', 'slow_loading', 'featurization_2', 'neural_network']
2022-09-22 02:57:19 INFO  Running instrumented original pipeline...
2022-09-22 02:57:19 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-22 02:57:19 INFO  ---RUNTIME: Importing and monkey-patching took 122.67041206359863 ms
2022-09-22 02:57:27.932978: W tensorflow/stream_executor/platform/default/dso_loader.cc:64] Could not load dynamic library 'libcuda.so.1'; dlerror: libcuda.so.1: cannot open shared object file: No such file or directory; LD_LIBRARY_PATH: /home/sgrafbe/mlwhatif/venv/lib/python3.9/site-packages/cv2/../../lib64:
2022-09-22 02:57:27.933023: W tensorflow/stream_executor/cuda/cuda_driver.cc:326] failed call to cuInit: UNKNOWN ERROR (303)
2022-09-22 02:57:27.933049: I tensorflow/stream_executor/cuda/cuda_diagnostics.cc:156] kernel driver does not appear to be running on this host (wagyu): /proc/driver/nvidia/version does not exist
2022-09-22 02:57:27.933641: I tensorflow/core/platform/cpu_feature_guard.cc:142] This TensorFlow binary is optimized with oneAPI Deep Neural Network Library (oneDNN) to use the following CPU instructions in performance-critical operations:  AVX2 FMA
To enable them in other operations, rebuild TensorFlow with the appropriate compiler flags.
2022-09-22 02:57:28.905896: I tensorflow/compiler/mlir/mlir_graph_optimization_pass.cc:176] None of the MLIR Optimization Passes are enabled (registered 2)
2022-09-22 02:57:28.921745: I tensorflow/core/platform/profile_utils/cpu_utils.cc:114] CPU Frequency: 2595290000 Hz
2022-09-22 02:57:37 INFO  ---RUNTIME: Original pipeline execution took 17758.742570877075 ms (excluding imports and monkey-patching)
2022-09-22 02:57:37 INFO  Starting execution of 0 what-if analyses...
2022-09-22 02:57:37 INFO  Estimated runtime of original DAG is 15994.08221244812ms
2022-09-22 02:57:37 INFO  Performing Multi-Query Optimization
2022-09-22 02:57:37 INFO  Estimated unoptimized what-if runtime is 0ms
2022-09-22 02:57:37 INFO  Estimated optimised what-if runtime is 0ms
2022-09-22 02:57:37 INFO  Estimated optimisation runtime saving is 0ms
2022-09-22 02:57:37 INFO  ---RUNTIME: Multi-Query Optimization took 0.5216598510742188 ms
2022-09-22 02:57:37 INFO  Executing generated plans
2022-09-22 02:57:37 INFO  ---RUNTIME: Execution took 0.030279159545898438 ms
2022-09-22 02:57:37 INFO  Done!
2022-09-22 02:57:37 INFO  # Optimization benchmark for data_cleaning with args [['reviews', 'slow_loading', 'featurization_2', 'neural_network']] -- repetition 1 of 7
2022-09-22 02:57:37 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-22 02:57:37 INFO  Running instrumented original pipeline...
2022-09-22 02:57:37 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-22 02:57:37 INFO  ---RUNTIME: Importing and monkey-patching took 5.458831787109375 ms
2022-09-22 02:57:55 INFO  ---RUNTIME: Original pipeline execution took 18328.0246257782 ms (excluding imports and monkey-patching)
2022-09-22 02:57:55 INFO  Starting execution of 1 what-if analyses...
2022-09-22 02:57:55 INFO  Start plan generation for analysis DataCleaning...
2022-09-22 02:57:55 INFO  ---RUNTIME: Plan generation took 1.4591217041015625 ms
2022-09-22 02:57:55 INFO  Estimated runtime of original DAG is 16565.27042388916ms
2022-09-22 02:57:55 INFO  Performing Multi-Query Optimization
2022-09-22 02:57:55 INFO  Estimated unoptimized what-if runtime is 331305.4084777832ms
2022-09-22 02:57:55 INFO  Estimated optimised what-if runtime is 201748.8374710083ms
2022-09-22 02:57:55 INFO  Estimated optimisation runtime saving is 129556.5710067749ms
2022-09-22 02:57:55 INFO  ---RUNTIME: Multi-Query Optimization took 101.04846954345703 ms
2022-09-22 02:57:55 INFO  Executing generated plans
2022-09-22 03:01:26 INFO  ---RUNTIME: Execution took 210329.78439331055 ms
2022-09-22 03:01:26 INFO  Done!
2022-09-22 03:01:26 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-22 03:01:26 INFO  Running instrumented original pipeline...
2022-09-22 03:01:26 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-22 03:01:26 INFO  ---RUNTIME: Importing and monkey-patching took 8.438587188720703 ms
2022-09-22 03:01:42 INFO  ---RUNTIME: Original pipeline execution took 16711.84492111206 ms (excluding imports and monkey-patching)
2022-09-22 03:01:42 INFO  Starting execution of 1 what-if analyses...
2022-09-22 03:01:42 INFO  Start plan generation for analysis DataCleaning...
2022-09-22 03:01:42 INFO  ---RUNTIME: Plan generation took 0.8943080902099609 ms
2022-09-22 03:01:42 INFO  Estimated runtime of original DAG is 15012.001514434814ms
2022-09-22 03:01:42 WARNING Skipping Multi-Query Optimization (instead, only applying patches)
2022-09-22 03:01:42 WARNING Columns ['review_id'] not present in train DAG after the train test split, only before!
2022-09-22 03:01:42 WARNING This could hint at data leakage!
2022-09-22 03:01:42 INFO  Estimated unoptimised what-if runtime is 300240.0302886963ms
2022-09-22 03:01:42 INFO  ---RUNTIME: Multi-Query Optimization took 54.3062686920166 ms
2022-09-22 03:01:42 INFO  Executing generated plans
2022-09-22 03:07:39 INFO  ---RUNTIME: Execution took 357108.6928844452 ms
2022-09-22 03:07:39 INFO  Done!
2022-09-22 03:07:39 INFO  # Finished -- repetition 1 of 7 
2022-09-22 03:07:39 INFO  # Optimization benchmark for data_cleaning with args [['reviews', 'slow_loading', 'featurization_2', 'neural_network']] -- repetition 2 of 7
2022-09-22 03:07:39 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-22 03:07:39 INFO  Running instrumented original pipeline...
2022-09-22 03:07:40 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-22 03:07:40 INFO  ---RUNTIME: Importing and monkey-patching took 6.1702728271484375 ms
2022-09-22 03:07:58 INFO  ---RUNTIME: Original pipeline execution took 18317.888498306274 ms (excluding imports and monkey-patching)
2022-09-22 03:07:58 INFO  Starting execution of 1 what-if analyses...
2022-09-22 03:07:58 INFO  Start plan generation for analysis DataCleaning...
2022-09-22 03:07:58 INFO  ---RUNTIME: Plan generation took 0.8099079132080078 ms
2022-09-22 03:07:58 INFO  Estimated runtime of original DAG is 17110.567808151245ms
2022-09-22 03:07:58 INFO  Performing Multi-Query Optimization
2022-09-22 03:07:58 INFO  Estimated unoptimized what-if runtime is 342211.3561630249ms
2022-09-22 03:07:58 INFO  Estimated optimised what-if runtime is 239286.61370277405ms
2022-09-22 03:07:58 INFO  Estimated optimisation runtime saving is 102924.74246025085ms
2022-09-22 03:07:58 INFO  ---RUNTIME: Multi-Query Optimization took 180.06396293640137 ms
2022-09-22 03:07:58 INFO  Executing generated plans
2022-09-22 03:11:28 INFO  ---RUNTIME: Execution took 210329.82182502747 ms
2022-09-22 03:11:28 INFO  Done!
2022-09-22 03:11:28 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-22 03:11:28 INFO  Running instrumented original pipeline...
2022-09-22 03:11:28 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-22 03:11:28 INFO  ---RUNTIME: Importing and monkey-patching took 8.902549743652344 ms
2022-09-22 03:11:46 INFO  ---RUNTIME: Original pipeline execution took 17496.37722969055 ms (excluding imports and monkey-patching)
2022-09-22 03:11:46 INFO  Starting execution of 1 what-if analyses...
2022-09-22 03:11:46 INFO  Start plan generation for analysis DataCleaning...
2022-09-22 03:11:46 INFO  ---RUNTIME: Plan generation took 1.7561912536621094 ms
2022-09-22 03:11:46 INFO  Estimated runtime of original DAG is 16273.784160614014ms
2022-09-22 03:11:46 WARNING Skipping Multi-Query Optimization (instead, only applying patches)
2022-09-22 03:11:46 WARNING Columns ['review_id'] not present in train DAG after the train test split, only before!
2022-09-22 03:11:46 WARNING This could hint at data leakage!
2022-09-22 03:11:46 INFO  Estimated unoptimised what-if runtime is 325475.6832122803ms
2022-09-22 03:11:46 INFO  ---RUNTIME: Multi-Query Optimization took 36.11588478088379 ms
2022-09-22 03:11:46 INFO  Executing generated plans
2022-09-22 03:17:41 INFO  ---RUNTIME: Execution took 355335.62326431274 ms
2022-09-22 03:17:41 INFO  Done!
2022-09-22 03:17:41 INFO  # Finished -- repetition 2 of 7 
2022-09-22 03:17:41 INFO  # Optimization benchmark for data_cleaning with args [['reviews', 'slow_loading', 'featurization_2', 'neural_network']] -- repetition 3 of 7
2022-09-22 03:17:41 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-22 03:17:41 INFO  Running instrumented original pipeline...
2022-09-22 03:17:41 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-22 03:17:41 INFO  ---RUNTIME: Importing and monkey-patching took 8.611679077148438 ms
2022-09-22 03:17:59 INFO  ---RUNTIME: Original pipeline execution took 17871.723175048828 ms (excluding imports and monkey-patching)
2022-09-22 03:17:59 INFO  Starting execution of 1 what-if analyses...
2022-09-22 03:17:59 INFO  Start plan generation for analysis DataCleaning...
2022-09-22 03:17:59 INFO  ---RUNTIME: Plan generation took 0.6113052368164062 ms
2022-09-22 03:17:59 INFO  Estimated runtime of original DAG is 15975.52514076233ms
2022-09-22 03:17:59 INFO  Performing Multi-Query Optimization
2022-09-22 03:17:59 INFO  Estimated unoptimized what-if runtime is 319510.5028152466ms
2022-09-22 03:17:59 INFO  Estimated optimised what-if runtime is 191449.50437545776ms
2022-09-22 03:17:59 INFO  Estimated optimisation runtime saving is 128060.99843978882ms
2022-09-22 03:17:59 INFO  ---RUNTIME: Multi-Query Optimization took 100.45480728149414 ms
2022-09-22 03:17:59 INFO  Executing generated plans
2022-09-22 03:21:18 INFO  ---RUNTIME: Execution took 198541.13221168518 ms
2022-09-22 03:21:18 INFO  Done!
2022-09-22 03:21:18 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-22 03:21:18 INFO  Running instrumented original pipeline...
2022-09-22 03:21:18 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-22 03:21:18 INFO  ---RUNTIME: Importing and monkey-patching took 5.953311920166016 ms
2022-09-22 03:21:32 INFO  ---RUNTIME: Original pipeline execution took 14274.345874786377 ms (excluding imports and monkey-patching)
2022-09-22 03:21:32 INFO  Starting execution of 1 what-if analyses...
2022-09-22 03:21:32 INFO  Start plan generation for analysis DataCleaning...
2022-09-22 03:21:32 INFO  ---RUNTIME: Plan generation took 1.3740062713623047 ms
2022-09-22 03:21:32 INFO  Estimated runtime of original DAG is 13035.310745239258ms
2022-09-22 03:21:32 WARNING Skipping Multi-Query Optimization (instead, only applying patches)
2022-09-22 03:21:32 WARNING Columns ['review_id'] not present in train DAG after the train test split, only before!
2022-09-22 03:21:32 WARNING This could hint at data leakage!
2022-09-22 03:21:32 INFO  Estimated unoptimised what-if runtime is 260706.21490478516ms
2022-09-22 03:21:32 INFO  ---RUNTIME: Multi-Query Optimization took 27.42767333984375 ms
2022-09-22 03:21:32 INFO  Executing generated plans
2022-09-22 03:26:20 INFO  ---RUNTIME: Execution took 287464.26653862 ms
2022-09-22 03:26:20 INFO  Done!
2022-09-22 03:26:20 INFO  # Finished -- repetition 3 of 7 
2022-09-22 03:26:20 INFO  # Optimization benchmark for data_cleaning with args [['reviews', 'slow_loading', 'featurization_2', 'neural_network']] -- repetition 4 of 7
2022-09-22 03:26:20 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-22 03:26:20 INFO  Running instrumented original pipeline...
2022-09-22 03:26:20 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-22 03:26:20 INFO  ---RUNTIME: Importing and monkey-patching took 6.2274932861328125 ms
2022-09-22 03:26:34 INFO  ---RUNTIME: Original pipeline execution took 14206.78186416626 ms (excluding imports and monkey-patching)
2022-09-22 03:26:34 INFO  Starting execution of 1 what-if analyses...
2022-09-22 03:26:34 INFO  Start plan generation for analysis DataCleaning...
2022-09-22 03:26:34 INFO  ---RUNTIME: Plan generation took 0.6694793701171875 ms
2022-09-22 03:26:34 INFO  Estimated runtime of original DAG is 13001.813411712646ms
2022-09-22 03:26:34 INFO  Performing Multi-Query Optimization
2022-09-22 03:26:34 INFO  Estimated unoptimized what-if runtime is 260036.26823425293ms
2022-09-22 03:26:34 INFO  Estimated optimised what-if runtime is 162819.93293762207ms
2022-09-22 03:26:34 INFO  Estimated optimisation runtime saving is 97216.33529663086ms
2022-09-22 03:26:34 INFO  ---RUNTIME: Multi-Query Optimization took 100.56567192077637 ms
2022-09-22 03:26:34 INFO  Executing generated plans
2022-09-22 03:29:22 INFO  ---RUNTIME: Execution took 168534.49845314026 ms
2022-09-22 03:29:22 INFO  Done!
2022-09-22 03:29:22 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-22 03:29:22 INFO  Running instrumented original pipeline...
2022-09-22 03:29:22 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-22 03:29:22 INFO  ---RUNTIME: Importing and monkey-patching took 6.086826324462891 ms
2022-09-22 03:29:36 INFO  ---RUNTIME: Original pipeline execution took 14055.78327178955 ms (excluding imports and monkey-patching)
2022-09-22 03:29:36 INFO  Starting execution of 1 what-if analyses...
2022-09-22 03:29:36 INFO  Start plan generation for analysis DataCleaning...
2022-09-22 03:29:36 INFO  ---RUNTIME: Plan generation took 1.4488697052001953 ms
2022-09-22 03:29:36 INFO  Estimated runtime of original DAG is 12874.403476715088ms
2022-09-22 03:29:36 WARNING Skipping Multi-Query Optimization (instead, only applying patches)
2022-09-22 03:29:37 WARNING Columns ['review_id'] not present in train DAG after the train test split, only before!
2022-09-22 03:29:37 WARNING This could hint at data leakage!
2022-09-22 03:29:37 INFO  Estimated unoptimised what-if runtime is 257488.06953430176ms
2022-09-22 03:29:37 INFO  ---RUNTIME: Multi-Query Optimization took 24.761199951171875 ms
2022-09-22 03:29:37 INFO  Executing generated plans
2022-09-22 03:34:23 INFO  ---RUNTIME: Execution took 286075.5934715271 ms
2022-09-22 03:34:23 INFO  Done!
2022-09-22 03:34:23 INFO  # Finished -- repetition 4 of 7 
2022-09-22 03:34:23 INFO  # Optimization benchmark for data_cleaning with args [['reviews', 'slow_loading', 'featurization_2', 'neural_network']] -- repetition 5 of 7
2022-09-22 03:34:23 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-22 03:34:23 INFO  Running instrumented original pipeline...
2022-09-22 03:34:23 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-22 03:34:23 INFO  ---RUNTIME: Importing and monkey-patching took 5.99217414855957 ms
2022-09-22 03:34:36 INFO  ---RUNTIME: Original pipeline execution took 13583.284616470337 ms (excluding imports and monkey-patching)
2022-09-22 03:34:36 INFO  Starting execution of 1 what-if analyses...
2022-09-22 03:34:36 INFO  Start plan generation for analysis DataCleaning...
2022-09-22 03:34:36 INFO  ---RUNTIME: Plan generation took 0.7219314575195312 ms
2022-09-22 03:34:36 INFO  Estimated runtime of original DAG is 12368.533372879028ms
2022-09-22 03:34:36 INFO  Performing Multi-Query Optimization
2022-09-22 03:34:36 INFO  Estimated unoptimized what-if runtime is 247370.66745758057ms
2022-09-22 03:34:36 INFO  Estimated optimised what-if runtime is 150309.05437469482ms
2022-09-22 03:34:36 INFO  Estimated optimisation runtime saving is 97061.61308288574ms
2022-09-22 03:34:36 INFO  ---RUNTIME: Multi-Query Optimization took 110.57209968566895 ms
2022-09-22 03:34:36 INFO  Executing generated plans
2022-09-22 03:37:26 INFO  ---RUNTIME: Execution took 169352.14948654175 ms
2022-09-22 03:37:26 INFO  Done!
2022-09-22 03:37:26 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-22 03:37:26 INFO  Running instrumented original pipeline...
2022-09-22 03:37:26 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-22 03:37:26 INFO  ---RUNTIME: Importing and monkey-patching took 6.023168563842773 ms
2022-09-22 03:37:40 INFO  ---RUNTIME: Original pipeline execution took 14151.464939117432 ms (excluding imports and monkey-patching)
2022-09-22 03:37:40 INFO  Starting execution of 1 what-if analyses...
2022-09-22 03:37:40 INFO  Start plan generation for analysis DataCleaning...
2022-09-22 03:37:40 INFO  ---RUNTIME: Plan generation took 1.5311241149902344 ms
2022-09-22 03:37:40 INFO  Estimated runtime of original DAG is 12936.86056137085ms
2022-09-22 03:37:40 WARNING Skipping Multi-Query Optimization (instead, only applying patches)
2022-09-22 03:37:40 WARNING Columns ['review_id'] not present in train DAG after the train test split, only before!
2022-09-22 03:37:40 WARNING This could hint at data leakage!
2022-09-22 03:37:40 INFO  Estimated unoptimised what-if runtime is 258737.211227417ms
2022-09-22 03:37:40 INFO  ---RUNTIME: Multi-Query Optimization took 25.07162094116211 ms
2022-09-22 03:37:40 INFO  Executing generated plans
2022-09-22 03:42:22 INFO  ---RUNTIME: Execution took 282401.46589279175 ms
2022-09-22 03:42:22 INFO  Done!
2022-09-22 03:42:22 INFO  # Finished -- repetition 5 of 7 
2022-09-22 03:42:22 INFO  # Optimization benchmark for data_cleaning with args [['reviews', 'slow_loading', 'featurization_2', 'neural_network']] -- repetition 6 of 7
2022-09-22 03:42:22 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-22 03:42:22 INFO  Running instrumented original pipeline...
2022-09-22 03:42:22 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-22 03:42:22 INFO  ---RUNTIME: Importing and monkey-patching took 6.19196891784668 ms
2022-09-22 03:42:36 INFO  ---RUNTIME: Original pipeline execution took 14146.734476089478 ms (excluding imports and monkey-patching)
2022-09-22 03:42:36 INFO  Starting execution of 1 what-if analyses...
2022-09-22 03:42:36 INFO  Start plan generation for analysis DataCleaning...
2022-09-22 03:42:36 INFO  ---RUNTIME: Plan generation took 0.6172657012939453 ms
2022-09-22 03:42:36 INFO  Estimated runtime of original DAG is 12939.554214477539ms
2022-09-22 03:42:36 INFO  Performing Multi-Query Optimization
2022-09-22 03:42:36 INFO  Estimated unoptimized what-if runtime is 258791.08428955078ms
2022-09-22 03:42:36 INFO  Estimated optimised what-if runtime is 162374.1912841797ms
2022-09-22 03:42:36 INFO  Estimated optimisation runtime saving is 96416.8930053711ms
2022-09-22 03:42:36 INFO  ---RUNTIME: Multi-Query Optimization took 99.95698928833008 ms
2022-09-22 03:42:36 INFO  Executing generated plans
2022-09-22 03:45:24 INFO  ---RUNTIME: Execution took 167942.08216667175 ms
2022-09-22 03:45:24 INFO  Done!
2022-09-22 03:45:24 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-22 03:45:24 INFO  Running instrumented original pipeline...
2022-09-22 03:45:24 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-22 03:45:24 INFO  ---RUNTIME: Importing and monkey-patching took 7.34710693359375 ms
2022-09-22 03:45:38 INFO  ---RUNTIME: Original pipeline execution took 13806.6246509552 ms (excluding imports and monkey-patching)
2022-09-22 03:45:38 INFO  Starting execution of 1 what-if analyses...
2022-09-22 03:45:38 INFO  Start plan generation for analysis DataCleaning...
2022-09-22 03:45:38 INFO  ---RUNTIME: Plan generation took 1.439809799194336 ms
2022-09-22 03:45:38 INFO  Estimated runtime of original DAG is 12571.540832519531ms
2022-09-22 03:45:38 WARNING Skipping Multi-Query Optimization (instead, only applying patches)
2022-09-22 03:45:38 WARNING Columns ['review_id'] not present in train DAG after the train test split, only before!
2022-09-22 03:45:38 WARNING This could hint at data leakage!
2022-09-22 03:45:38 INFO  Estimated unoptimised what-if runtime is 251430.81665039062ms
2022-09-22 03:45:38 INFO  ---RUNTIME: Multi-Query Optimization took 25.053024291992188 ms
2022-09-22 03:45:38 INFO  Executing generated plans
2022-09-22 03:50:24 INFO  ---RUNTIME: Execution took 285327.5537490845 ms
2022-09-22 03:50:24 INFO  Done!
2022-09-22 03:50:24 INFO  # Finished -- repetition 6 of 7 
2022-09-22 03:50:24 INFO  # Optimization benchmark for data_cleaning with args [['reviews', 'slow_loading', 'featurization_2', 'neural_network']] -- repetition 7 of 7
2022-09-22 03:50:24 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-22 03:50:24 INFO  Running instrumented original pipeline...
2022-09-22 03:50:24 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-22 03:50:24 INFO  ---RUNTIME: Importing and monkey-patching took 5.82122802734375 ms
2022-09-22 03:50:37 INFO  ---RUNTIME: Original pipeline execution took 13711.509227752686 ms (excluding imports and monkey-patching)
2022-09-22 03:50:37 INFO  Starting execution of 1 what-if analyses...
2022-09-22 03:50:37 INFO  Start plan generation for analysis DataCleaning...
2022-09-22 03:50:37 INFO  ---RUNTIME: Plan generation took 0.6444454193115234 ms
2022-09-22 03:50:37 INFO  Estimated runtime of original DAG is 12508.116722106934ms
2022-09-22 03:50:37 INFO  Performing Multi-Query Optimization
2022-09-22 03:50:37 INFO  Estimated unoptimized what-if runtime is 250162.33444213867ms
2022-09-22 03:50:37 INFO  Estimated optimised what-if runtime is 151818.5613155365ms
2022-09-22 03:50:37 INFO  Estimated optimisation runtime saving is 98343.77312660217ms
2022-09-22 03:50:37 INFO  ---RUNTIME: Multi-Query Optimization took 100.07905960083008 ms
2022-09-22 03:50:37 INFO  Executing generated plans
2022-09-22 03:53:25 INFO  ---RUNTIME: Execution took 167602.00381278992 ms
2022-09-22 03:53:25 INFO  Done!
2022-09-22 03:53:25 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-22 03:53:25 INFO  Running instrumented original pipeline...
2022-09-22 03:53:25 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-22 03:53:25 INFO  ---RUNTIME: Importing and monkey-patching took 6.35218620300293 ms
2022-09-22 03:53:39 INFO  ---RUNTIME: Original pipeline execution took 13780.805826187134 ms (excluding imports and monkey-patching)
2022-09-22 03:53:39 INFO  Starting execution of 1 what-if analyses...
2022-09-22 03:53:39 INFO  Start plan generation for analysis DataCleaning...
2022-09-22 03:53:39 INFO  ---RUNTIME: Plan generation took 1.4872550964355469 ms
2022-09-22 03:53:39 INFO  Estimated runtime of original DAG is 12566.816568374634ms
2022-09-22 03:53:39 WARNING Skipping Multi-Query Optimization (instead, only applying patches)
2022-09-22 03:53:39 WARNING Columns ['review_id'] not present in train DAG after the train test split, only before!
2022-09-22 03:53:39 WARNING This could hint at data leakage!
2022-09-22 03:53:39 INFO  Estimated unoptimised what-if runtime is 251336.33136749268ms
2022-09-22 03:53:39 INFO  ---RUNTIME: Multi-Query Optimization took 24.816274642944336 ms
2022-09-22 03:53:39 INFO  Executing generated plans
2022-09-22 03:58:23 INFO  ---RUNTIME: Execution took 284014.95575904846 ms
2022-09-22 03:58:23 INFO  Done!
2022-09-22 03:58:23 INFO  # Finished -- repetition 7 of 7 
2022-09-22 03:58:23 INFO  # Final results after all repetitions
2022-09-22 03:58:23 INFO     repetition  ... no_opt_what_if_execution_combined_model_training
0           0  ...                                    163671.535492
1           1  ...                                    167433.511734
2           2  ...                                    128545.426607
3           3  ...                                    127043.572903
4           4  ...                                    122408.658504
5           5  ...                                    124386.783600
6           6  ...                                    124468.485117

[7 rows x 26 columns]
taskset -c 160-167 PROTOCOL_BUFFERS_PYTHON_IMPLEMENTATION=python python3.9 benchmarks_end_to_end.py data_cleaning reviews slow_loading featurization_3 logistic_regression
2022-09-22 03:58:25.949206: W tensorflow/stream_executor/platform/default/dso_loader.cc:64] Could not load dynamic library 'libcudart.so.11.0'; dlerror: libcudart.so.11.0: cannot open shared object file: No such file or directory; LD_LIBRARY_PATH: /home/sgrafbe/mlwhatif/venv/lib/python3.9/site-packages/cv2/../../lib64:
2022-09-22 03:58:25.949253: I tensorflow/stream_executor/cuda/cudart_stub.cc:29] Ignore above cudart dlerror if you do not have a GPU set up on your machine.
2022-09-22 03:58:27 INFO  Patching sys.argv with ['mlwhatif', 'reviews', 'slow_loading', 'featurization_3', 'logistic_regression']
2022-09-22 03:58:27 INFO  Running instrumented original pipeline...
2022-09-22 03:58:27 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-22 03:58:27 INFO  ---RUNTIME: Importing and monkey-patching took 95.54696083068848 ms
2022-09-22 03:59:08 INFO  ---RUNTIME: Original pipeline execution took 41683.24971199036 ms (excluding imports and monkey-patching)
2022-09-22 03:59:08 INFO  Starting execution of 0 what-if analyses...
2022-09-22 03:59:08 INFO  Estimated runtime of original DAG is 34308.45618247986ms
2022-09-22 03:59:08 INFO  Performing Multi-Query Optimization
2022-09-22 03:59:08 INFO  Estimated unoptimized what-if runtime is 0ms
2022-09-22 03:59:08 INFO  Estimated optimised what-if runtime is 0ms
2022-09-22 03:59:08 INFO  Estimated optimisation runtime saving is 0ms
2022-09-22 03:59:08 INFO  ---RUNTIME: Multi-Query Optimization took 0.5736351013183594 ms
2022-09-22 03:59:08 INFO  Executing generated plans
2022-09-22 03:59:08 INFO  ---RUNTIME: Execution took 0.023365020751953125 ms
2022-09-22 03:59:08 INFO  Done!
2022-09-22 03:59:08 INFO  # Optimization benchmark for data_cleaning with args [['reviews', 'slow_loading', 'featurization_3', 'logistic_regression']] -- repetition 1 of 7
2022-09-22 03:59:08 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-22 03:59:08 INFO  Running instrumented original pipeline...
2022-09-22 03:59:08 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-22 03:59:09 INFO  ---RUNTIME: Importing and monkey-patching took 5.542516708374023 ms
2022-09-22 03:59:50 INFO  ---RUNTIME: Original pipeline execution took 41847.07689285278 ms (excluding imports and monkey-patching)
2022-09-22 03:59:50 INFO  Starting execution of 1 what-if analyses...
2022-09-22 03:59:50 INFO  Start plan generation for analysis DataCleaning...
2022-09-22 03:59:50 INFO  ---RUNTIME: Plan generation took 0.7655620574951172 ms
2022-09-22 03:59:50 INFO  Estimated runtime of original DAG is 34547.08981513977ms
2022-09-22 03:59:50 INFO  Performing Multi-Query Optimization
2022-09-22 03:59:51 INFO  Estimated unoptimized what-if runtime is 690941.7963027954ms
2022-09-22 03:59:51 INFO  Estimated optimised what-if runtime is 166249.78303909302ms
2022-09-22 03:59:51 INFO  Estimated optimisation runtime saving is 524692.0132637024ms
2022-09-22 03:59:51 INFO  ---RUNTIME: Multi-Query Optimization took 276.01099014282227 ms
2022-09-22 03:59:51 INFO  Executing generated plans
2022-09-22 04:01:58 INFO  ---RUNTIME: Execution took 127793.09368133545 ms
2022-09-22 04:01:58 INFO  Done!
2022-09-22 04:01:58 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-22 04:01:58 INFO  Running instrumented original pipeline...
2022-09-22 04:01:58 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-22 04:01:58 INFO  ---RUNTIME: Importing and monkey-patching took 6.215572357177734 ms
2022-09-22 04:02:41 INFO  ---RUNTIME: Original pipeline execution took 42139.82439041138 ms (excluding imports and monkey-patching)
2022-09-22 04:02:41 INFO  Starting execution of 1 what-if analyses...
2022-09-22 04:02:41 INFO  Start plan generation for analysis DataCleaning...
2022-09-22 04:02:41 INFO  ---RUNTIME: Plan generation took 0.7970333099365234 ms
2022-09-22 04:02:41 INFO  Estimated runtime of original DAG is 34689.88132476807ms
2022-09-22 04:02:41 WARNING Skipping Multi-Query Optimization (instead, only applying patches)
2022-09-22 04:02:41 WARNING Columns ['review_id'] not present in train DAG after the train test split, only before!
2022-09-22 04:02:41 WARNING This could hint at data leakage!
2022-09-22 04:02:41 INFO  Estimated unoptimised what-if runtime is 693797.6264953613ms
2022-09-22 04:02:41 INFO  ---RUNTIME: Multi-Query Optimization took 28.863191604614258 ms
2022-09-22 04:02:41 INFO  Executing generated plans
2022-09-22 04:13:27 INFO  ---RUNTIME: Execution took 646703.4714221954 ms
2022-09-22 04:13:27 INFO  Done!
2022-09-22 04:13:27 INFO  # Finished -- repetition 1 of 7 
2022-09-22 04:13:27 INFO  # Optimization benchmark for data_cleaning with args [['reviews', 'slow_loading', 'featurization_3', 'logistic_regression']] -- repetition 2 of 7
2022-09-22 04:13:27 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-22 04:13:27 INFO  Running instrumented original pipeline...
2022-09-22 04:13:27 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-22 04:13:27 INFO  ---RUNTIME: Importing and monkey-patching took 71.68936729431152 ms
2022-09-22 04:14:19 INFO  ---RUNTIME: Original pipeline execution took 51787.31656074524 ms (excluding imports and monkey-patching)
2022-09-22 04:14:19 INFO  Starting execution of 1 what-if analyses...
2022-09-22 04:14:19 INFO  Start plan generation for analysis DataCleaning...
2022-09-22 04:14:19 INFO  ---RUNTIME: Plan generation took 3.7031173706054688 ms
2022-09-22 04:14:19 INFO  Estimated runtime of original DAG is 37391.210079193115ms
2022-09-22 04:14:19 INFO  Performing Multi-Query Optimization
2022-09-22 04:14:19 INFO  Estimated unoptimized what-if runtime is 747824.2015838623ms
2022-09-22 04:14:19 INFO  Estimated optimised what-if runtime is 180212.86296844482ms
2022-09-22 04:14:19 INFO  Estimated optimisation runtime saving is 567611.3386154175ms
2022-09-22 04:14:19 INFO  ---RUNTIME: Multi-Query Optimization took 150.9096622467041 ms
2022-09-22 04:14:19 INFO  Executing generated plans
Traceback (most recent call last):
  File "/home/sgrafbe/mlwhatif/experiments/end_to_end/benchmarks_end_to_end.py", line 228, in <module>
    analysis_result_opt = PipelineAnalyzer \
  File "/home/sgrafbe/mlwhatif/mlwhatif/_pipeline_analyzer.py", line 93, in execute
    return singleton.run(notebook_path=self._notebook_path,
  File "/home/sgrafbe/mlwhatif/mlwhatif/execution/_pipeline_executor.py", line 149, in run
    self.run_what_if_analyses()
  File "/home/sgrafbe/mlwhatif/mlwhatif/execution/_pipeline_executor.py", line 178, in run_what_if_analyses
    DagExecutor(self).execute(self.analysis_results.combined_optimized_dag)
  File "/home/sgrafbe/mlwhatif/mlwhatif/execution/_dag_executor.py", line 45, in execute
    self.traverse_graph_and_process_nodes(dag, execute_node)
  File "/home/sgrafbe/mlwhatif/mlwhatif/execution/_dag_executor.py", line 57, in traverse_graph_and_process_nodes
    result_node = func(node)
  File "/home/sgrafbe/mlwhatif/mlwhatif/execution/_dag_executor.py", line 40, in execute_node
    optimizer_info, result_df = capture_optimizer_info(executable_processing_func)
  File "/home/sgrafbe/mlwhatif/mlwhatif/execution/_stat_tracking.py", line 28, in capture_optimizer_info
    result = instrumented_function_call()
  File "/home/sgrafbe/mlwhatif/mlwhatif/monkeypatching/_patch_sklearn.py", line 1729, in processing_func
    transformed_data = wrap_in_mlinspect_array_if_necessary(transformed_data)
  File "/home/sgrafbe/mlwhatif/mlwhatif/monkeypatching/_monkey_patching_utils.py", line 229, in wrap_in_mlinspect_array_if_necessary
    df_object = MlinspectNdarray(df_object)
  File "/home/sgrafbe/mlwhatif/mlwhatif/monkeypatching/_mlinspect_ndarray.py", line 16, in __new__
    obj = numpy.asarray(input_array).view(cls)
  File "/home/sgrafbe/mlwhatif/venv/lib64/python3.9/site-packages/numpy/core/_asarray.py", line 83, in asarray
    return array(a, dtype, copy=False, order=order)
numpy.core._exceptions.MemoryError: Unable to allocate 3.72 GiB for an array with shape (35312,) and data type <U28286
taskset -c 160-167 PROTOCOL_BUFFERS_PYTHON_IMPLEMENTATION=python python3.9 benchmarks_end_to_end.py data_cleaning reviews slow_loading featurization_3 xgboost
2022-09-22 04:15:02.982683: W tensorflow/stream_executor/platform/default/dso_loader.cc:64] Could not load dynamic library 'libcudart.so.11.0'; dlerror: libcudart.so.11.0: cannot open shared object file: No such file or directory; LD_LIBRARY_PATH: /home/sgrafbe/mlwhatif/venv/lib/python3.9/site-packages/cv2/../../lib64:
2022-09-22 04:15:02.982718: I tensorflow/stream_executor/cuda/cudart_stub.cc:29] Ignore above cudart dlerror if you do not have a GPU set up on your machine.
2022-09-22 04:15:05 INFO  Patching sys.argv with ['mlwhatif', 'reviews', 'slow_loading', 'featurization_3', 'xgboost']
2022-09-22 04:15:05 INFO  Running instrumented original pipeline...
2022-09-22 04:15:05 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-22 04:15:05 INFO  ---RUNTIME: Importing and monkey-patching took 163.90466690063477 ms
2022-09-22 04:16:02 INFO  ---RUNTIME: Original pipeline execution took 57322.174310684204 ms (excluding imports and monkey-patching)
2022-09-22 04:16:02 INFO  Starting execution of 0 what-if analyses...
2022-09-22 04:16:02 INFO  Estimated runtime of original DAG is 49303.441762924194ms
2022-09-22 04:16:02 INFO  Performing Multi-Query Optimization
2022-09-22 04:16:02 INFO  Estimated unoptimized what-if runtime is 0ms
2022-09-22 04:16:02 INFO  Estimated optimised what-if runtime is 0ms
2022-09-22 04:16:02 INFO  Estimated optimisation runtime saving is 0ms
2022-09-22 04:16:02 INFO  ---RUNTIME: Multi-Query Optimization took 0.60272216796875 ms
2022-09-22 04:16:02 INFO  Executing generated plans
2022-09-22 04:16:02 INFO  ---RUNTIME: Execution took 0.022172927856445312 ms
2022-09-22 04:16:02 INFO  Done!
2022-09-22 04:16:02 INFO  # Optimization benchmark for data_cleaning with args [['reviews', 'slow_loading', 'featurization_3', 'xgboost']] -- repetition 1 of 7
2022-09-22 04:16:02 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-22 04:16:02 INFO  Running instrumented original pipeline...
2022-09-22 04:16:02 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-22 04:16:02 INFO  ---RUNTIME: Importing and monkey-patching took 5.677700042724609 ms
2022-09-22 04:17:03 INFO  ---RUNTIME: Original pipeline execution took 60589.935541152954 ms (excluding imports and monkey-patching)
2022-09-22 04:17:03 INFO  Starting execution of 1 what-if analyses...
2022-09-22 04:17:03 INFO  Start plan generation for analysis DataCleaning...
2022-09-22 04:17:03 INFO  ---RUNTIME: Plan generation took 1.3303756713867188 ms
2022-09-22 04:17:03 INFO  Estimated runtime of original DAG is 49199.42283630371ms
2022-09-22 04:17:03 INFO  Performing Multi-Query Optimization
2022-09-22 04:17:03 INFO  Estimated unoptimized what-if runtime is 983988.4567260742ms
2022-09-22 04:17:03 INFO  Estimated optimised what-if runtime is 478921.7369556427ms
2022-09-22 04:17:03 INFO  Estimated optimisation runtime saving is 505066.7197704315ms
2022-09-22 04:17:03 INFO  ---RUNTIME: Multi-Query Optimization took 303.3146858215332 ms
2022-09-22 04:17:03 INFO  Executing generated plans
2022-09-22 04:25:45 INFO  ---RUNTIME: Execution took 521899.0263938904 ms
2022-09-22 04:25:45 INFO  Done!
2022-09-22 04:25:45 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-22 04:25:45 INFO  Running instrumented original pipeline...
2022-09-22 04:25:45 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-22 04:25:45 INFO  ---RUNTIME: Importing and monkey-patching took 6.376743316650391 ms
2022-09-22 04:26:54 INFO  ---RUNTIME: Original pipeline execution took 68795.53484916687 ms (excluding imports and monkey-patching)
2022-09-22 04:26:54 INFO  Starting execution of 1 what-if analyses...
2022-09-22 04:26:54 INFO  Start plan generation for analysis DataCleaning...
2022-09-22 04:26:54 INFO  ---RUNTIME: Plan generation took 0.9086132049560547 ms
2022-09-22 04:26:54 INFO  Estimated runtime of original DAG is 53578.92918586731ms
2022-09-22 04:26:54 WARNING Skipping Multi-Query Optimization (instead, only applying patches)
2022-09-22 04:26:54 WARNING Columns ['review_id'] not present in train DAG after the train test split, only before!
2022-09-22 04:26:54 WARNING This could hint at data leakage!
2022-09-22 04:26:54 INFO  Estimated unoptimised what-if runtime is 1071578.5837173462ms
2022-09-22 04:26:54 INFO  ---RUNTIME: Multi-Query Optimization took 29.323101043701172 ms
2022-09-22 04:26:54 INFO  Executing generated plans
2022-09-22 04:45:38 INFO  ---RUNTIME: Execution took 1124108.182668686 ms
2022-09-22 04:45:38 INFO  Done!
2022-09-22 04:45:38 INFO  # Finished -- repetition 1 of 7 
2022-09-22 04:45:38 INFO  # Optimization benchmark for data_cleaning with args [['reviews', 'slow_loading', 'featurization_3', 'xgboost']] -- repetition 2 of 7
2022-09-22 04:45:38 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-22 04:45:38 INFO  Running instrumented original pipeline...
2022-09-22 04:45:38 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-22 04:45:38 INFO  ---RUNTIME: Importing and monkey-patching took 7.24482536315918 ms
Traceback (most recent call last):
  File "/home/sgrafbe/mlwhatif/experiments/end_to_end/benchmarks_end_to_end.py", line 228, in <module>
    analysis_result_opt = PipelineAnalyzer \
  File "/home/sgrafbe/mlwhatif/mlwhatif/_pipeline_analyzer.py", line 93, in execute
    return singleton.run(notebook_path=self._notebook_path,
  File "/home/sgrafbe/mlwhatif/mlwhatif/execution/_pipeline_executor.py", line 110, in run
    self.run_instrumented_pipeline(notebook_path, python_code, python_path)
  File "/home/sgrafbe/mlwhatif/mlwhatif/execution/_pipeline_executor.py", line 205, in run_instrumented_pipeline
    exec(compile(parsed_modified_ast, filename=self.source_code_path, mode="exec"), self.script_scope)
  File "/home/sgrafbe/mlwhatif/experiments/end_to_end/run_pipeline.py", line 450, in <module>
    pipeline = pipeline.fit(train, train_labels)
  File "/home/sgrafbe/mlwhatif/venv/lib64/python3.9/site-packages/sklearn/pipeline.py", line 330, in fit
    Xt = self._fit(X, y, **fit_params_steps)
  File "/home/sgrafbe/mlwhatif/venv/lib64/python3.9/site-packages/sklearn/pipeline.py", line 292, in _fit
    X, fitted_transformer = fit_transform_one_cached(
  File "/home/sgrafbe/mlwhatif/venv/lib64/python3.9/site-packages/joblib/memory.py", line 349, in __call__
    return self.func(*args, **kwargs)
  File "/home/sgrafbe/mlwhatif/venv/lib64/python3.9/site-packages/sklearn/pipeline.py", line 740, in _fit_transform_one
    res = transformer.fit_transform(X, y, **fit_params)
  File "/home/sgrafbe/mlwhatif/mlwhatif/monkeypatching/_patch_sklearn.py", line 304, in patched_fit_transform
    result = original(self, *args, **kwargs)
  File "/home/sgrafbe/mlwhatif/venv/lib64/python3.9/site-packages/sklearn/compose/_column_transformer.py", line 531, in fit_transform
    result = self._fit_transform(X, y, _fit_transform_one)
  File "/home/sgrafbe/mlwhatif/venv/lib64/python3.9/site-packages/sklearn/compose/_column_transformer.py", line 458, in _fit_transform
    return Parallel(n_jobs=self.n_jobs)(
  File "/home/sgrafbe/mlwhatif/venv/lib64/python3.9/site-packages/joblib/parallel.py", line 1088, in __call__
    while self.dispatch_one_batch(iterator):
  File "/home/sgrafbe/mlwhatif/venv/lib64/python3.9/site-packages/joblib/parallel.py", line 901, in dispatch_one_batch
    self._dispatch(tasks)
  File "/home/sgrafbe/mlwhatif/venv/lib64/python3.9/site-packages/joblib/parallel.py", line 819, in _dispatch
    job = self._backend.apply_async(batch, callback=cb)
  File "/home/sgrafbe/mlwhatif/venv/lib64/python3.9/site-packages/joblib/_parallel_backends.py", line 208, in apply_async
    result = ImmediateResult(func)
  File "/home/sgrafbe/mlwhatif/venv/lib64/python3.9/site-packages/joblib/_parallel_backends.py", line 597, in __init__
    self.results = batch()
  File "/home/sgrafbe/mlwhatif/venv/lib64/python3.9/site-packages/joblib/parallel.py", line 288, in __call__
    return [func(*args, **kwargs)
  File "/home/sgrafbe/mlwhatif/venv/lib64/python3.9/site-packages/joblib/parallel.py", line 288, in <listcomp>
    return [func(*args, **kwargs)
  File "/home/sgrafbe/mlwhatif/venv/lib64/python3.9/site-packages/sklearn/pipeline.py", line 740, in _fit_transform_one
    res = transformer.fit_transform(X, y, **fit_params)
  File "/home/sgrafbe/mlwhatif/venv/lib64/python3.9/site-packages/sklearn/pipeline.py", line 367, in fit_transform
    Xt = self._fit(X, y, **fit_params_steps)
  File "/home/sgrafbe/mlwhatif/venv/lib64/python3.9/site-packages/sklearn/pipeline.py", line 292, in _fit
    X, fitted_transformer = fit_transform_one_cached(
  File "/home/sgrafbe/mlwhatif/venv/lib64/python3.9/site-packages/joblib/memory.py", line 349, in __call__
    return self.func(*args, **kwargs)
  File "/home/sgrafbe/mlwhatif/venv/lib64/python3.9/site-packages/sklearn/pipeline.py", line 740, in _fit_transform_one
    res = transformer.fit_transform(X, y, **fit_params)
  File "/home/sgrafbe/mlwhatif/mlwhatif/monkeypatching/_patch_sklearn.py", line 1751, in patched_fit_transform
    add_dag_node(dag_node, [input_info.dag_node], function_call_result)
  File "/home/sgrafbe/mlwhatif/mlwhatif/monkeypatching/_monkey_patching_utils.py", line 255, in add_dag_node
    function_call_result.function_result = wrap_in_mlinspect_array_if_necessary(
  File "/home/sgrafbe/mlwhatif/mlwhatif/monkeypatching/_monkey_patching_utils.py", line 229, in wrap_in_mlinspect_array_if_necessary
    df_object = MlinspectNdarray(df_object)
  File "/home/sgrafbe/mlwhatif/mlwhatif/monkeypatching/_mlinspect_ndarray.py", line 16, in __new__
    obj = numpy.asarray(input_array).view(cls)
  File "/home/sgrafbe/mlwhatif/venv/lib64/python3.9/site-packages/numpy/core/_asarray.py", line 83, in asarray
    return array(a, dtype, copy=False, order=order)
numpy.core._exceptions.MemoryError: Unable to allocate 3.72 GiB for an array with shape (35312,) and data type <U28286
taskset -c 160-167 PROTOCOL_BUFFERS_PYTHON_IMPLEMENTATION=python python3.9 benchmarks_end_to_end.py data_cleaning reviews slow_loading featurization_3 neural_network
2022-09-22 04:46:14.925226: W tensorflow/stream_executor/platform/default/dso_loader.cc:64] Could not load dynamic library 'libcudart.so.11.0'; dlerror: libcudart.so.11.0: cannot open shared object file: No such file or directory; LD_LIBRARY_PATH: /home/sgrafbe/mlwhatif/venv/lib/python3.9/site-packages/cv2/../../lib64:
2022-09-22 04:46:14.925262: I tensorflow/stream_executor/cuda/cudart_stub.cc:29] Ignore above cudart dlerror if you do not have a GPU set up on your machine.
2022-09-22 04:46:20 INFO  Patching sys.argv with ['mlwhatif', 'reviews', 'slow_loading', 'featurization_3', 'neural_network']
2022-09-22 04:46:20 INFO  Running instrumented original pipeline...
2022-09-22 04:46:20 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-22 04:46:20 INFO  ---RUNTIME: Importing and monkey-patching took 161.53621673583984 ms
2022-09-22 04:46:47.758344: W tensorflow/stream_executor/platform/default/dso_loader.cc:64] Could not load dynamic library 'libcuda.so.1'; dlerror: libcuda.so.1: cannot open shared object file: No such file or directory; LD_LIBRARY_PATH: /home/sgrafbe/mlwhatif/venv/lib/python3.9/site-packages/cv2/../../lib64:
2022-09-22 04:46:47.758389: W tensorflow/stream_executor/cuda/cuda_driver.cc:326] failed call to cuInit: UNKNOWN ERROR (303)
2022-09-22 04:46:47.758424: I tensorflow/stream_executor/cuda/cuda_diagnostics.cc:156] kernel driver does not appear to be running on this host (wagyu): /proc/driver/nvidia/version does not exist
2022-09-22 04:46:47.758984: I tensorflow/core/platform/cpu_feature_guard.cc:142] This TensorFlow binary is optimized with oneAPI Deep Neural Network Library (oneDNN) to use the following CPU instructions in performance-critical operations:  AVX2 FMA
To enable them in other operations, rebuild TensorFlow with the appropriate compiler flags.
2022-09-22 04:46:48.730023: I tensorflow/compiler/mlir/mlir_graph_optimization_pass.cc:176] None of the MLIR Optimization Passes are enabled (registered 2)
2022-09-22 04:46:48.744458: I tensorflow/core/platform/profile_utils/cpu_utils.cc:114] CPU Frequency: 2595290000 Hz
2022-09-22 04:47:13 INFO  ---RUNTIME: Original pipeline execution took 52967.49567985535 ms (excluding imports and monkey-patching)
2022-09-22 04:47:13 INFO  Starting execution of 0 what-if analyses...
2022-09-22 04:47:13 INFO  Estimated runtime of original DAG is 44918.17903518677ms
2022-09-22 04:47:13 INFO  Performing Multi-Query Optimization
2022-09-22 04:47:13 INFO  Estimated unoptimized what-if runtime is 0ms
2022-09-22 04:47:13 INFO  Estimated optimised what-if runtime is 0ms
2022-09-22 04:47:13 INFO  Estimated optimisation runtime saving is 0ms
2022-09-22 04:47:13 INFO  ---RUNTIME: Multi-Query Optimization took 0.5726814270019531 ms
2022-09-22 04:47:13 INFO  Executing generated plans
2022-09-22 04:47:13 INFO  ---RUNTIME: Execution took 0.015735626220703125 ms
2022-09-22 04:47:13 INFO  Done!
2022-09-22 04:47:13 INFO  # Optimization benchmark for data_cleaning with args [['reviews', 'slow_loading', 'featurization_3', 'neural_network']] -- repetition 1 of 7
2022-09-22 04:47:13 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-22 04:47:13 INFO  Running instrumented original pipeline...
2022-09-22 04:47:13 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-22 04:47:13 INFO  ---RUNTIME: Importing and monkey-patching took 5.392551422119141 ms
2022-09-22 04:48:08 INFO  ---RUNTIME: Original pipeline execution took 54888.76962661743 ms (excluding imports and monkey-patching)
2022-09-22 04:48:08 INFO  Starting execution of 1 what-if analyses...
2022-09-22 04:48:08 INFO  Start plan generation for analysis DataCleaning...
2022-09-22 04:48:08 INFO  ---RUNTIME: Plan generation took 1.7709732055664062 ms
2022-09-22 04:48:08 INFO  Estimated runtime of original DAG is 43026.641607284546ms
2022-09-22 04:48:08 INFO  Performing Multi-Query Optimization
2022-09-22 04:48:08 INFO  Estimated unoptimized what-if runtime is 860532.8321456909ms
2022-09-22 04:48:08 INFO  Estimated optimised what-if runtime is 309793.17450523376ms
2022-09-22 04:48:08 INFO  Estimated optimisation runtime saving is 550739.6576404572ms
2022-09-22 04:48:08 INFO  ---RUNTIME: Multi-Query Optimization took 120.55301666259766 ms
2022-09-22 04:48:08 INFO  Executing generated plans
2022-09-22 04:54:18 INFO  ---RUNTIME: Execution took 370095.81685066223 ms
2022-09-22 04:54:18 INFO  Done!
2022-09-22 04:54:18 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-22 04:54:18 INFO  Running instrumented original pipeline...
2022-09-22 04:54:19 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-22 04:54:19 INFO  ---RUNTIME: Importing and monkey-patching took 6.585597991943359 ms
2022-09-22 04:55:20 INFO  ---RUNTIME: Original pipeline execution took 61961.47131919861 ms (excluding imports and monkey-patching)
2022-09-22 04:55:20 INFO  Starting execution of 1 what-if analyses...
2022-09-22 04:55:20 INFO  Start plan generation for analysis DataCleaning...
2022-09-22 04:55:20 INFO  ---RUNTIME: Plan generation took 1.9037723541259766 ms
2022-09-22 04:55:20 INFO  Estimated runtime of original DAG is 47169.400215148926ms
2022-09-22 04:55:20 WARNING Skipping Multi-Query Optimization (instead, only applying patches)
2022-09-22 04:55:20 WARNING Columns ['review_id'] not present in train DAG after the train test split, only before!
2022-09-22 04:55:20 WARNING This could hint at data leakage!
2022-09-22 04:55:20 INFO  Estimated unoptimised what-if runtime is 943388.0043029785ms
2022-09-22 04:55:20 INFO  ---RUNTIME: Multi-Query Optimization took 29.12306785583496 ms
2022-09-22 04:55:20 INFO  Executing generated plans
Traceback (most recent call last):
  File "/home/sgrafbe/mlwhatif/experiments/end_to_end/benchmarks_end_to_end.py", line 238, in <module>
    analysis_result_no_opt = PipelineAnalyzer \
  File "/home/sgrafbe/mlwhatif/mlwhatif/_pipeline_analyzer.py", line 93, in execute
    return singleton.run(notebook_path=self._notebook_path,
  File "/home/sgrafbe/mlwhatif/mlwhatif/execution/_pipeline_executor.py", line 149, in run
    self.run_what_if_analyses()
  File "/home/sgrafbe/mlwhatif/mlwhatif/execution/_pipeline_executor.py", line 181, in run_what_if_analyses
    DagExecutor(self).execute(what_if_dag)
  File "/home/sgrafbe/mlwhatif/mlwhatif/execution/_dag_executor.py", line 45, in execute
    self.traverse_graph_and_process_nodes(dag, execute_node)
  File "/home/sgrafbe/mlwhatif/mlwhatif/execution/_dag_executor.py", line 57, in traverse_graph_and_process_nodes
    result_node = func(node)
  File "/home/sgrafbe/mlwhatif/mlwhatif/execution/_dag_executor.py", line 40, in execute_node
    optimizer_info, result_df = capture_optimizer_info(executable_processing_func)
  File "/home/sgrafbe/mlwhatif/mlwhatif/execution/_stat_tracking.py", line 28, in capture_optimizer_info
    result = instrumented_function_call()
  File "/home/sgrafbe/mlwhatif/mlwhatif/monkeypatching/_patch_sklearn.py", line 1729, in processing_func
    transformed_data = wrap_in_mlinspect_array_if_necessary(transformed_data)
  File "/home/sgrafbe/mlwhatif/mlwhatif/monkeypatching/_monkey_patching_utils.py", line 229, in wrap_in_mlinspect_array_if_necessary
    df_object = MlinspectNdarray(df_object)
  File "/home/sgrafbe/mlwhatif/mlwhatif/monkeypatching/_mlinspect_ndarray.py", line 16, in __new__
    obj = numpy.asarray(input_array).view(cls)
  File "/home/sgrafbe/mlwhatif/venv/lib64/python3.9/site-packages/numpy/core/_asarray.py", line 83, in asarray
    return array(a, dtype, copy=False, order=order)
numpy.core._exceptions.MemoryError: Unable to allocate 3.71 GiB for an array with shape (35312,) and data type <U28219
taskset -c 160-167 PROTOCOL_BUFFERS_PYTHON_IMPLEMENTATION=python python3.9 benchmarks_end_to_end.py data_cleaning reviews slow_loading featurization_4 logistic_regression
2022-09-22 04:55:51.201211: W tensorflow/stream_executor/platform/default/dso_loader.cc:64] Could not load dynamic library 'libcudart.so.11.0'; dlerror: libcudart.so.11.0: cannot open shared object file: No such file or directory; LD_LIBRARY_PATH: /home/sgrafbe/mlwhatif/venv/lib/python3.9/site-packages/cv2/../../lib64:
2022-09-22 04:55:51.201252: I tensorflow/stream_executor/cuda/cudart_stub.cc:29] Ignore above cudart dlerror if you do not have a GPU set up on your machine.
2022-09-22 04:55:52 INFO  Patching sys.argv with ['mlwhatif', 'reviews', 'slow_loading', 'featurization_4', 'logistic_regression']
2022-09-22 04:55:52 INFO  Running instrumented original pipeline...
2022-09-22 04:55:52 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-22 04:55:52 INFO  ---RUNTIME: Importing and monkey-patching took 96.53854370117188 ms
2022-09-22 04:56:05 INFO  ---RUNTIME: Original pipeline execution took 13154.0048122406 ms (excluding imports and monkey-patching)
2022-09-22 04:56:05 INFO  Starting execution of 0 what-if analyses...
2022-09-22 04:56:05 INFO  Estimated runtime of original DAG is 9858.196258544922ms
2022-09-22 04:56:05 INFO  Performing Multi-Query Optimization
2022-09-22 04:56:05 INFO  Estimated unoptimized what-if runtime is 0ms
2022-09-22 04:56:05 INFO  Estimated optimised what-if runtime is 0ms
2022-09-22 04:56:05 INFO  Estimated optimisation runtime saving is 0ms
2022-09-22 04:56:05 INFO  ---RUNTIME: Multi-Query Optimization took 0.5490779876708984 ms
2022-09-22 04:56:05 INFO  Executing generated plans
2022-09-22 04:56:05 INFO  ---RUNTIME: Execution took 0.021219253540039062 ms
2022-09-22 04:56:05 INFO  Done!
2022-09-22 04:56:05 INFO  # Optimization benchmark for data_cleaning with args [['reviews', 'slow_loading', 'featurization_4', 'logistic_regression']] -- repetition 1 of 7
2022-09-22 04:56:05 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-22 04:56:05 INFO  Running instrumented original pipeline...
2022-09-22 04:56:05 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-22 04:56:05 INFO  ---RUNTIME: Importing and monkey-patching took 6.100893020629883 ms
2022-09-22 04:56:18 INFO  ---RUNTIME: Original pipeline execution took 13019.800186157227 ms (excluding imports and monkey-patching)
2022-09-22 04:56:18 INFO  Starting execution of 1 what-if analyses...
2022-09-22 04:56:18 INFO  Start plan generation for analysis DataCleaning...
2022-09-22 04:56:18 INFO  ---RUNTIME: Plan generation took 0.6549358367919922 ms
2022-09-22 04:56:18 INFO  Estimated runtime of original DAG is 9741.173267364502ms
2022-09-22 04:56:18 INFO  Performing Multi-Query Optimization
2022-09-22 04:56:18 INFO  Estimated unoptimized what-if runtime is 194823.46534729004ms
2022-09-22 04:56:18 INFO  Estimated optimised what-if runtime is 41561.85793876648ms
2022-09-22 04:56:18 INFO  Estimated optimisation runtime saving is 153261.60740852356ms
2022-09-22 04:56:18 INFO  ---RUNTIME: Multi-Query Optimization took 108.5975170135498 ms
2022-09-22 04:56:18 INFO  Executing generated plans
2022-09-22 04:57:08 INFO  ---RUNTIME: Execution took 49528.28621864319 ms
2022-09-22 04:57:08 INFO  Done!
2022-09-22 04:57:08 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-22 04:57:08 INFO  Running instrumented original pipeline...
2022-09-22 04:57:08 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-22 04:57:08 INFO  ---RUNTIME: Importing and monkey-patching took 6.204128265380859 ms
2022-09-22 04:57:21 INFO  ---RUNTIME: Original pipeline execution took 13123.476028442383 ms (excluding imports and monkey-patching)
2022-09-22 04:57:21 INFO  Starting execution of 1 what-if analyses...
2022-09-22 04:57:21 INFO  Start plan generation for analysis DataCleaning...
2022-09-22 04:57:21 INFO  ---RUNTIME: Plan generation took 0.6341934204101562 ms
2022-09-22 04:57:21 INFO  Estimated runtime of original DAG is 9870.87631225586ms
2022-09-22 04:57:21 WARNING Skipping Multi-Query Optimization (instead, only applying patches)
2022-09-22 04:57:21 WARNING Columns ['review_id'] not present in train DAG after the train test split, only before!
2022-09-22 04:57:21 WARNING This could hint at data leakage!
2022-09-22 04:57:21 INFO  Estimated unoptimised what-if runtime is 197417.5262451172ms
2022-09-22 04:57:21 INFO  ---RUNTIME: Multi-Query Optimization took 25.827884674072266 ms
2022-09-22 04:57:21 INFO  Executing generated plans
2022-09-22 05:01:01 INFO  ---RUNTIME: Execution took 219927.64711380005 ms
2022-09-22 05:01:01 INFO  Done!
2022-09-22 05:01:01 INFO  # Finished -- repetition 1 of 7 
2022-09-22 05:01:01 INFO  # Optimization benchmark for data_cleaning with args [['reviews', 'slow_loading', 'featurization_4', 'logistic_regression']] -- repetition 2 of 7
2022-09-22 05:01:01 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-22 05:01:01 INFO  Running instrumented original pipeline...
2022-09-22 05:01:01 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-22 05:01:01 INFO  ---RUNTIME: Importing and monkey-patching took 5.8650970458984375 ms
2022-09-22 05:01:14 INFO  ---RUNTIME: Original pipeline execution took 12950.225353240967 ms (excluding imports and monkey-patching)
2022-09-22 05:01:14 INFO  Starting execution of 1 what-if analyses...
2022-09-22 05:01:14 INFO  Start plan generation for analysis DataCleaning...
2022-09-22 05:01:14 INFO  ---RUNTIME: Plan generation took 0.682830810546875 ms
2022-09-22 05:01:14 INFO  Estimated runtime of original DAG is 9689.7132396698ms
2022-09-22 05:01:14 INFO  Performing Multi-Query Optimization
2022-09-22 05:01:14 INFO  Estimated unoptimized what-if runtime is 193794.264793396ms
2022-09-22 05:01:14 INFO  Estimated optimised what-if runtime is 41596.95100784302ms
2022-09-22 05:01:14 INFO  Estimated optimisation runtime saving is 152197.31378555298ms
2022-09-22 05:01:14 INFO  ---RUNTIME: Multi-Query Optimization took 111.34743690490723 ms
2022-09-22 05:01:14 INFO  Executing generated plans
2022-09-22 05:02:04 INFO  ---RUNTIME: Execution took 50094.62070465088 ms
2022-09-22 05:02:04 INFO  Done!
2022-09-22 05:02:04 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-22 05:02:04 INFO  Running instrumented original pipeline...
2022-09-22 05:02:04 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-22 05:02:04 INFO  ---RUNTIME: Importing and monkey-patching took 6.316184997558594 ms
2022-09-22 05:02:17 INFO  ---RUNTIME: Original pipeline execution took 13048.038959503174 ms (excluding imports and monkey-patching)
2022-09-22 05:02:17 INFO  Starting execution of 1 what-if analyses...
2022-09-22 05:02:17 INFO  Start plan generation for analysis DataCleaning...
2022-09-22 05:02:17 INFO  ---RUNTIME: Plan generation took 0.6380081176757812 ms
2022-09-22 05:02:17 INFO  Estimated runtime of original DAG is 9637.80403137207ms
2022-09-22 05:02:17 WARNING Skipping Multi-Query Optimization (instead, only applying patches)
2022-09-22 05:02:17 WARNING Columns ['review_id'] not present in train DAG after the train test split, only before!
2022-09-22 05:02:17 WARNING This could hint at data leakage!
2022-09-22 05:02:17 INFO  Estimated unoptimised what-if runtime is 192756.0806274414ms
2022-09-22 05:02:17 INFO  ---RUNTIME: Multi-Query Optimization took 26.231765747070312 ms
2022-09-22 05:02:17 INFO  Executing generated plans
2022-09-22 05:05:56 INFO  ---RUNTIME: Execution took 218615.71288108826 ms
2022-09-22 05:05:56 INFO  Done!
2022-09-22 05:05:56 INFO  # Finished -- repetition 2 of 7 
2022-09-22 05:05:56 INFO  # Optimization benchmark for data_cleaning with args [['reviews', 'slow_loading', 'featurization_4', 'logistic_regression']] -- repetition 3 of 7
2022-09-22 05:05:56 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-22 05:05:56 INFO  Running instrumented original pipeline...
2022-09-22 05:05:56 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-22 05:05:56 INFO  ---RUNTIME: Importing and monkey-patching took 6.0901641845703125 ms
2022-09-22 05:06:09 INFO  ---RUNTIME: Original pipeline execution took 13397.21655845642 ms (excluding imports and monkey-patching)
2022-09-22 05:06:09 INFO  Starting execution of 1 what-if analyses...
2022-09-22 05:06:09 INFO  Start plan generation for analysis DataCleaning...
2022-09-22 05:06:09 INFO  ---RUNTIME: Plan generation took 0.6475448608398438 ms
2022-09-22 05:06:09 INFO  Estimated runtime of original DAG is 9944.525241851807ms
2022-09-22 05:06:09 INFO  Performing Multi-Query Optimization
2022-09-22 05:06:09 INFO  Estimated unoptimized what-if runtime is 198890.50483703613ms
2022-09-22 05:06:09 INFO  Estimated optimised what-if runtime is 42438.33661079407ms
2022-09-22 05:06:09 INFO  Estimated optimisation runtime saving is 156452.16822624207ms
2022-09-22 05:06:09 INFO  ---RUNTIME: Multi-Query Optimization took 106.25815391540527 ms
2022-09-22 05:06:09 INFO  Executing generated plans
2022-09-22 05:06:59 INFO  ---RUNTIME: Execution took 49617.494106292725 ms
2022-09-22 05:06:59 INFO  Done!
2022-09-22 05:06:59 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-22 05:06:59 INFO  Running instrumented original pipeline...
2022-09-22 05:06:59 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-22 05:06:59 INFO  ---RUNTIME: Importing and monkey-patching took 5.909919738769531 ms
2022-09-22 05:07:12 INFO  ---RUNTIME: Original pipeline execution took 13012.146949768066 ms (excluding imports and monkey-patching)
2022-09-22 05:07:12 INFO  Starting execution of 1 what-if analyses...
2022-09-22 05:07:12 INFO  Start plan generation for analysis DataCleaning...
2022-09-22 05:07:12 INFO  ---RUNTIME: Plan generation took 0.6444454193115234 ms
2022-09-22 05:07:12 INFO  Estimated runtime of original DAG is 9596.959590911865ms
2022-09-22 05:07:12 WARNING Skipping Multi-Query Optimization (instead, only applying patches)
2022-09-22 05:07:12 WARNING Columns ['review_id'] not present in train DAG after the train test split, only before!
2022-09-22 05:07:12 WARNING This could hint at data leakage!
2022-09-22 05:07:12 INFO  Estimated unoptimised what-if runtime is 191939.1918182373ms
2022-09-22 05:07:12 INFO  ---RUNTIME: Multi-Query Optimization took 25.79665184020996 ms
2022-09-22 05:07:12 INFO  Executing generated plans
2022-09-22 05:10:52 INFO  ---RUNTIME: Execution took 220161.8423461914 ms
2022-09-22 05:10:52 INFO  Done!
2022-09-22 05:10:52 INFO  # Finished -- repetition 3 of 7 
2022-09-22 05:10:52 INFO  # Optimization benchmark for data_cleaning with args [['reviews', 'slow_loading', 'featurization_4', 'logistic_regression']] -- repetition 4 of 7
2022-09-22 05:10:52 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-22 05:10:52 INFO  Running instrumented original pipeline...
2022-09-22 05:10:52 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-22 05:10:52 INFO  ---RUNTIME: Importing and monkey-patching took 6.401538848876953 ms
2022-09-22 05:11:05 INFO  ---RUNTIME: Original pipeline execution took 13054.89206314087 ms (excluding imports and monkey-patching)
2022-09-22 05:11:05 INFO  Starting execution of 1 what-if analyses...
2022-09-22 05:11:05 INFO  Start plan generation for analysis DataCleaning...
2022-09-22 05:11:05 INFO  ---RUNTIME: Plan generation took 0.6036758422851562 ms
2022-09-22 05:11:05 INFO  Estimated runtime of original DAG is 9785.440444946289ms
2022-09-22 05:11:05 INFO  Performing Multi-Query Optimization
2022-09-22 05:11:05 INFO  Estimated unoptimized what-if runtime is 195708.80889892578ms
2022-09-22 05:11:05 INFO  Estimated optimised what-if runtime is 42208.515882492065ms
2022-09-22 05:11:05 INFO  Estimated optimisation runtime saving is 153500.29301643372ms
2022-09-22 05:11:05 INFO  ---RUNTIME: Multi-Query Optimization took 104.99811172485352 ms
2022-09-22 05:11:05 INFO  Executing generated plans
2022-09-22 05:11:55 INFO  ---RUNTIME: Execution took 49230.61466217041 ms
2022-09-22 05:11:55 INFO  Done!
2022-09-22 05:11:55 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-22 05:11:55 INFO  Running instrumented original pipeline...
2022-09-22 05:11:55 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-22 05:11:55 INFO  ---RUNTIME: Importing and monkey-patching took 6.250619888305664 ms
2022-09-22 05:12:08 INFO  ---RUNTIME: Original pipeline execution took 13374.303102493286 ms (excluding imports and monkey-patching)
2022-09-22 05:12:08 INFO  Starting execution of 1 what-if analyses...
2022-09-22 05:12:08 INFO  Start plan generation for analysis DataCleaning...
2022-09-22 05:12:08 INFO  ---RUNTIME: Plan generation took 0.5939006805419922 ms
2022-09-22 05:12:08 INFO  Estimated runtime of original DAG is 9884.907245635986ms
2022-09-22 05:12:08 WARNING Skipping Multi-Query Optimization (instead, only applying patches)
2022-09-22 05:12:08 WARNING Columns ['review_id'] not present in train DAG after the train test split, only before!
2022-09-22 05:12:08 WARNING This could hint at data leakage!
2022-09-22 05:12:08 INFO  Estimated unoptimised what-if runtime is 197698.14491271973ms
2022-09-22 05:12:08 INFO  ---RUNTIME: Multi-Query Optimization took 25.69866180419922 ms
2022-09-22 05:12:08 INFO  Executing generated plans
2022-09-22 05:15:48 INFO  ---RUNTIME: Execution took 219617.25425720215 ms
2022-09-22 05:15:48 INFO  Done!
2022-09-22 05:15:48 INFO  # Finished -- repetition 4 of 7 
2022-09-22 05:15:48 INFO  # Optimization benchmark for data_cleaning with args [['reviews', 'slow_loading', 'featurization_4', 'logistic_regression']] -- repetition 5 of 7
2022-09-22 05:15:48 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-22 05:15:48 INFO  Running instrumented original pipeline...
2022-09-22 05:15:48 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-22 05:15:48 INFO  ---RUNTIME: Importing and monkey-patching took 6.155252456665039 ms
2022-09-22 05:16:01 INFO  ---RUNTIME: Original pipeline execution took 13137.317895889282 ms (excluding imports and monkey-patching)
2022-09-22 05:16:01 INFO  Starting execution of 1 what-if analyses...
2022-09-22 05:16:01 INFO  Start plan generation for analysis DataCleaning...
2022-09-22 05:16:01 INFO  ---RUNTIME: Plan generation took 0.6282329559326172 ms
2022-09-22 05:16:01 INFO  Estimated runtime of original DAG is 9680.204153060913ms
2022-09-22 05:16:01 INFO  Performing Multi-Query Optimization
2022-09-22 05:16:01 INFO  Estimated unoptimized what-if runtime is 193604.08306121826ms
2022-09-22 05:16:01 INFO  Estimated optimised what-if runtime is 41048.26545715332ms
2022-09-22 05:16:01 INFO  Estimated optimisation runtime saving is 152555.81760406494ms
2022-09-22 05:16:01 INFO  ---RUNTIME: Multi-Query Optimization took 107.08284378051758 ms
2022-09-22 05:16:01 INFO  Executing generated plans
2022-09-22 05:16:50 INFO  ---RUNTIME: Execution took 48927.374839782715 ms
2022-09-22 05:16:50 INFO  Done!
2022-09-22 05:16:50 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-22 05:16:50 INFO  Running instrumented original pipeline...
2022-09-22 05:16:50 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-22 05:16:50 INFO  ---RUNTIME: Importing and monkey-patching took 5.825519561767578 ms
2022-09-22 05:17:03 INFO  ---RUNTIME: Original pipeline execution took 12846.07744216919 ms (excluding imports and monkey-patching)
2022-09-22 05:17:03 INFO  Starting execution of 1 what-if analyses...
2022-09-22 05:17:03 INFO  Start plan generation for analysis DataCleaning...
2022-09-22 05:17:03 INFO  ---RUNTIME: Plan generation took 0.6616115570068359 ms
2022-09-22 05:17:03 INFO  Estimated runtime of original DAG is 9628.495454788208ms
2022-09-22 05:17:03 WARNING Skipping Multi-Query Optimization (instead, only applying patches)
2022-09-22 05:17:03 WARNING Columns ['review_id'] not present in train DAG after the train test split, only before!
2022-09-22 05:17:03 WARNING This could hint at data leakage!
2022-09-22 05:17:03 INFO  Estimated unoptimised what-if runtime is 192569.90909576416ms
2022-09-22 05:17:03 INFO  ---RUNTIME: Multi-Query Optimization took 25.94923973083496 ms
2022-09-22 05:17:03 INFO  Executing generated plans
2022-09-22 05:20:44 INFO  ---RUNTIME: Execution took 221554.68654632568 ms
2022-09-22 05:20:44 INFO  Done!
2022-09-22 05:20:44 INFO  # Finished -- repetition 5 of 7 
2022-09-22 05:20:44 INFO  # Optimization benchmark for data_cleaning with args [['reviews', 'slow_loading', 'featurization_4', 'logistic_regression']] -- repetition 6 of 7
2022-09-22 05:20:44 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-22 05:20:44 INFO  Running instrumented original pipeline...
2022-09-22 05:20:44 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-22 05:20:44 INFO  ---RUNTIME: Importing and monkey-patching took 6.195545196533203 ms
2022-09-22 05:20:58 INFO  ---RUNTIME: Original pipeline execution took 13548.223733901978 ms (excluding imports and monkey-patching)
2022-09-22 05:20:58 INFO  Starting execution of 1 what-if analyses...
2022-09-22 05:20:58 INFO  Start plan generation for analysis DataCleaning...
2022-09-22 05:20:58 INFO  ---RUNTIME: Plan generation took 0.6012916564941406 ms
2022-09-22 05:20:58 INFO  Estimated runtime of original DAG is 9987.234115600586ms
2022-09-22 05:20:58 INFO  Performing Multi-Query Optimization
2022-09-22 05:20:58 INFO  Estimated unoptimized what-if runtime is 199744.68231201172ms
2022-09-22 05:20:58 INFO  Estimated optimised what-if runtime is 43154.752016067505ms
2022-09-22 05:20:58 INFO  Estimated optimisation runtime saving is 156589.9302959442ms
2022-09-22 05:20:58 INFO  ---RUNTIME: Multi-Query Optimization took 106.97388648986816 ms
2022-09-22 05:20:58 INFO  Executing generated plans
2022-09-22 05:21:48 INFO  ---RUNTIME: Execution took 49719.59733963013 ms
2022-09-22 05:21:48 INFO  Done!
2022-09-22 05:21:48 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-22 05:21:48 INFO  Running instrumented original pipeline...
2022-09-22 05:21:48 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-22 05:21:48 INFO  ---RUNTIME: Importing and monkey-patching took 6.35218620300293 ms
2022-09-22 05:22:01 INFO  ---RUNTIME: Original pipeline execution took 13227.974653244019 ms (excluding imports and monkey-patching)
2022-09-22 05:22:01 INFO  Starting execution of 1 what-if analyses...
2022-09-22 05:22:01 INFO  Start plan generation for analysis DataCleaning...
2022-09-22 05:22:01 INFO  ---RUNTIME: Plan generation took 0.6577968597412109 ms
2022-09-22 05:22:01 INFO  Estimated runtime of original DAG is 9791.930675506592ms
2022-09-22 05:22:01 WARNING Skipping Multi-Query Optimization (instead, only applying patches)
2022-09-22 05:22:01 WARNING Columns ['review_id'] not present in train DAG after the train test split, only before!
2022-09-22 05:22:01 WARNING This could hint at data leakage!
2022-09-22 05:22:01 INFO  Estimated unoptimised what-if runtime is 195838.61351013184ms
2022-09-22 05:22:01 INFO  ---RUNTIME: Multi-Query Optimization took 26.04365348815918 ms
2022-09-22 05:22:01 INFO  Executing generated plans
2022-09-22 05:25:43 INFO  ---RUNTIME: Execution took 222178.5695552826 ms
2022-09-22 05:25:43 INFO  Done!
2022-09-22 05:25:43 INFO  # Finished -- repetition 6 of 7 
2022-09-22 05:25:43 INFO  # Optimization benchmark for data_cleaning with args [['reviews', 'slow_loading', 'featurization_4', 'logistic_regression']] -- repetition 7 of 7
2022-09-22 05:25:43 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-22 05:25:43 INFO  Running instrumented original pipeline...
2022-09-22 05:25:43 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-22 05:25:43 INFO  ---RUNTIME: Importing and monkey-patching took 5.900144577026367 ms
2022-09-22 05:25:56 INFO  ---RUNTIME: Original pipeline execution took 13331.136465072632 ms (excluding imports and monkey-patching)
2022-09-22 05:25:56 INFO  Starting execution of 1 what-if analyses...
2022-09-22 05:25:56 INFO  Start plan generation for analysis DataCleaning...
2022-09-22 05:25:56 INFO  ---RUNTIME: Plan generation took 0.6055831909179688 ms
2022-09-22 05:25:56 INFO  Estimated runtime of original DAG is 9844.165325164795ms
2022-09-22 05:25:56 INFO  Performing Multi-Query Optimization
2022-09-22 05:25:57 INFO  Estimated unoptimized what-if runtime is 196883.3065032959ms
2022-09-22 05:25:57 INFO  Estimated optimised what-if runtime is 41691.34497642517ms
2022-09-22 05:25:57 INFO  Estimated optimisation runtime saving is 155191.96152687073ms
2022-09-22 05:25:57 INFO  ---RUNTIME: Multi-Query Optimization took 105.10540008544922 ms
2022-09-22 05:25:57 INFO  Executing generated plans
2022-09-22 05:26:47 INFO  ---RUNTIME: Execution took 50018.9094543457 ms
2022-09-22 05:26:47 INFO  Done!
2022-09-22 05:26:47 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-22 05:26:47 INFO  Running instrumented original pipeline...
2022-09-22 05:26:47 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-22 05:26:47 INFO  ---RUNTIME: Importing and monkey-patching took 5.987405776977539 ms
2022-09-22 05:27:00 INFO  ---RUNTIME: Original pipeline execution took 13227.685689926147 ms (excluding imports and monkey-patching)
2022-09-22 05:27:00 INFO  Starting execution of 1 what-if analyses...
2022-09-22 05:27:00 INFO  Start plan generation for analysis DataCleaning...
2022-09-22 05:27:00 INFO  ---RUNTIME: Plan generation took 0.6835460662841797 ms
2022-09-22 05:27:00 INFO  Estimated runtime of original DAG is 9718.204975128174ms
2022-09-22 05:27:00 WARNING Skipping Multi-Query Optimization (instead, only applying patches)
2022-09-22 05:27:00 WARNING Columns ['review_id'] not present in train DAG after the train test split, only before!
2022-09-22 05:27:00 WARNING This could hint at data leakage!
2022-09-22 05:27:00 INFO  Estimated unoptimised what-if runtime is 194364.09950256348ms
2022-09-22 05:27:00 INFO  ---RUNTIME: Multi-Query Optimization took 28.28192710876465 ms
2022-09-22 05:27:00 INFO  Executing generated plans
2022-09-22 05:30:42 INFO  ---RUNTIME: Execution took 222272.31788635254 ms
2022-09-22 05:30:42 INFO  Done!
2022-09-22 05:30:42 INFO  # Finished -- repetition 7 of 7 
2022-09-22 05:30:42 INFO  # Final results after all repetitions
2022-09-22 05:30:42 INFO     repetition  ... no_opt_what_if_execution_combined_model_training
0           0  ...                                      3792.459488
1           1  ...                                      3711.216688
2           2  ...                                      3780.970573
3           3  ...                                      3752.429485
4           4  ...                                      3752.778530
5           5  ...                                      4571.783066
6           6  ...                                      4379.376173

[7 rows x 26 columns]
taskset -c 160-167 PROTOCOL_BUFFERS_PYTHON_IMPLEMENTATION=python python3.9 benchmarks_end_to_end.py data_cleaning reviews slow_loading featurization_4 xgboost
2022-09-22 05:30:45.132181: W tensorflow/stream_executor/platform/default/dso_loader.cc:64] Could not load dynamic library 'libcudart.so.11.0'; dlerror: libcudart.so.11.0: cannot open shared object file: No such file or directory; LD_LIBRARY_PATH: /home/sgrafbe/mlwhatif/venv/lib/python3.9/site-packages/cv2/../../lib64:
2022-09-22 05:30:45.132223: I tensorflow/stream_executor/cuda/cudart_stub.cc:29] Ignore above cudart dlerror if you do not have a GPU set up on your machine.
2022-09-22 05:30:46 INFO  Patching sys.argv with ['mlwhatif', 'reviews', 'slow_loading', 'featurization_4', 'xgboost']
2022-09-22 05:30:46 INFO  Running instrumented original pipeline...
2022-09-22 05:30:46 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-22 05:30:46 INFO  ---RUNTIME: Importing and monkey-patching took 94.91753578186035 ms
2022-09-22 05:31:04 INFO  ---RUNTIME: Original pipeline execution took 18258.183479309082 ms (excluding imports and monkey-patching)
2022-09-22 05:31:04 INFO  Starting execution of 0 what-if analyses...
2022-09-22 05:31:04 INFO  Estimated runtime of original DAG is 14963.030576705933ms
2022-09-22 05:31:04 INFO  Performing Multi-Query Optimization
2022-09-22 05:31:04 INFO  Estimated unoptimized what-if runtime is 0ms
2022-09-22 05:31:04 INFO  Estimated optimised what-if runtime is 0ms
2022-09-22 05:31:04 INFO  Estimated optimisation runtime saving is 0ms
2022-09-22 05:31:04 INFO  ---RUNTIME: Multi-Query Optimization took 0.5776882171630859 ms
2022-09-22 05:31:04 INFO  Executing generated plans
2022-09-22 05:31:04 INFO  ---RUNTIME: Execution took 0.026464462280273438 ms
2022-09-22 05:31:04 INFO  Done!
2022-09-22 05:31:04 INFO  # Optimization benchmark for data_cleaning with args [['reviews', 'slow_loading', 'featurization_4', 'xgboost']] -- repetition 1 of 7
2022-09-22 05:31:04 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-22 05:31:04 INFO  Running instrumented original pipeline...
2022-09-22 05:31:04 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-22 05:31:04 INFO  ---RUNTIME: Importing and monkey-patching took 5.71894645690918 ms
2022-09-22 05:31:22 INFO  ---RUNTIME: Original pipeline execution took 17794.557094573975 ms (excluding imports and monkey-patching)
2022-09-22 05:31:22 INFO  Starting execution of 1 what-if analyses...
2022-09-22 05:31:22 INFO  Start plan generation for analysis DataCleaning...
2022-09-22 05:31:22 INFO  ---RUNTIME: Plan generation took 0.6399154663085938 ms
2022-09-22 05:31:22 INFO  Estimated runtime of original DAG is 14432.0650100708ms
2022-09-22 05:31:22 INFO  Performing Multi-Query Optimization
2022-09-22 05:31:22 INFO  Estimated unoptimized what-if runtime is 288641.300201416ms
2022-09-22 05:31:22 INFO  Estimated optimised what-if runtime is 129581.06112480164ms
2022-09-22 05:31:22 INFO  Estimated optimisation runtime saving is 159060.23907661438ms
2022-09-22 05:31:22 INFO  ---RUNTIME: Multi-Query Optimization took 106.35209083557129 ms
2022-09-22 05:31:22 INFO  Executing generated plans
2022-09-22 05:33:35 INFO  ---RUNTIME: Execution took 132601.79591178894 ms
2022-09-22 05:33:35 INFO  Done!
2022-09-22 05:33:35 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-22 05:33:35 INFO  Running instrumented original pipeline...
2022-09-22 05:33:35 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-22 05:33:35 INFO  ---RUNTIME: Importing and monkey-patching took 6.506443023681641 ms
2022-09-22 05:33:52 INFO  ---RUNTIME: Original pipeline execution took 16985.878229141235 ms (excluding imports and monkey-patching)
2022-09-22 05:33:52 INFO  Starting execution of 1 what-if analyses...
2022-09-22 05:33:52 INFO  Start plan generation for analysis DataCleaning...
2022-09-22 05:33:52 INFO  ---RUNTIME: Plan generation took 0.7183551788330078 ms
2022-09-22 05:33:52 INFO  Estimated runtime of original DAG is 13700.09469985962ms
2022-09-22 05:33:52 WARNING Skipping Multi-Query Optimization (instead, only applying patches)
2022-09-22 05:33:52 WARNING Columns ['review_id'] not present in train DAG after the train test split, only before!
2022-09-22 05:33:52 WARNING This could hint at data leakage!
2022-09-22 05:33:52 INFO  Estimated unoptimised what-if runtime is 274001.8939971924ms
2022-09-22 05:33:52 INFO  ---RUNTIME: Multi-Query Optimization took 26.406049728393555 ms
2022-09-22 05:33:52 INFO  Executing generated plans
2022-09-22 05:39:02 INFO  ---RUNTIME: Execution took 309808.11190605164 ms
2022-09-22 05:39:02 INFO  Done!
2022-09-22 05:39:02 INFO  # Finished -- repetition 1 of 7 
2022-09-22 05:39:02 INFO  # Optimization benchmark for data_cleaning with args [['reviews', 'slow_loading', 'featurization_4', 'xgboost']] -- repetition 2 of 7
2022-09-22 05:39:02 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-22 05:39:02 INFO  Running instrumented original pipeline...
2022-09-22 05:39:02 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-22 05:39:02 INFO  ---RUNTIME: Importing and monkey-patching took 6.286859512329102 ms
2022-09-22 05:39:19 INFO  ---RUNTIME: Original pipeline execution took 17838.683366775513 ms (excluding imports and monkey-patching)
2022-09-22 05:39:19 INFO  Starting execution of 1 what-if analyses...
2022-09-22 05:39:19 INFO  Start plan generation for analysis DataCleaning...
2022-09-22 05:39:19 INFO  ---RUNTIME: Plan generation took 0.7092952728271484 ms
2022-09-22 05:39:19 INFO  Estimated runtime of original DAG is 14519.23394203186ms
2022-09-22 05:39:19 INFO  Performing Multi-Query Optimization
2022-09-22 05:39:20 INFO  Estimated unoptimized what-if runtime is 290384.6788406372ms
2022-09-22 05:39:20 INFO  Estimated optimised what-if runtime is 129872.4672794342ms
2022-09-22 05:39:20 INFO  Estimated optimisation runtime saving is 160512.211561203ms
2022-09-22 05:39:20 INFO  ---RUNTIME: Multi-Query Optimization took 106.3544750213623 ms
2022-09-22 05:39:20 INFO  Executing generated plans
2022-09-22 05:41:23 INFO  ---RUNTIME: Execution took 123261.474609375 ms
2022-09-22 05:41:23 INFO  Done!
2022-09-22 05:41:23 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-22 05:41:23 INFO  Running instrumented original pipeline...
2022-09-22 05:41:23 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-22 05:41:23 INFO  ---RUNTIME: Importing and monkey-patching took 6.388425827026367 ms
2022-09-22 05:41:40 INFO  ---RUNTIME: Original pipeline execution took 16821.675062179565 ms (excluding imports and monkey-patching)
2022-09-22 05:41:40 INFO  Starting execution of 1 what-if analyses...
2022-09-22 05:41:40 INFO  Start plan generation for analysis DataCleaning...
2022-09-22 05:41:40 INFO  ---RUNTIME: Plan generation took 0.7424354553222656 ms
2022-09-22 05:41:40 INFO  Estimated runtime of original DAG is 13328.556537628174ms
2022-09-22 05:41:40 WARNING Skipping Multi-Query Optimization (instead, only applying patches)
2022-09-22 05:41:40 WARNING Columns ['review_id'] not present in train DAG after the train test split, only before!
2022-09-22 05:41:40 WARNING This could hint at data leakage!
2022-09-22 05:41:40 INFO  Estimated unoptimised what-if runtime is 266571.1307525635ms
2022-09-22 05:41:40 INFO  ---RUNTIME: Multi-Query Optimization took 30.039548873901367 ms
2022-09-22 05:41:40 INFO  Executing generated plans
2022-09-22 05:46:47 INFO  ---RUNTIME: Execution took 307634.818315506 ms
2022-09-22 05:46:47 INFO  Done!
2022-09-22 05:46:47 INFO  # Finished -- repetition 2 of 7 
2022-09-22 05:46:47 INFO  # Optimization benchmark for data_cleaning with args [['reviews', 'slow_loading', 'featurization_4', 'xgboost']] -- repetition 3 of 7
2022-09-22 05:46:47 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-22 05:46:47 INFO  Running instrumented original pipeline...
2022-09-22 05:46:47 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-22 05:46:47 INFO  ---RUNTIME: Importing and monkey-patching took 5.88536262512207 ms
2022-09-22 05:47:04 INFO  ---RUNTIME: Original pipeline execution took 17021.97575569153 ms (excluding imports and monkey-patching)
2022-09-22 05:47:04 INFO  Starting execution of 1 what-if analyses...
2022-09-22 05:47:04 INFO  Start plan generation for analysis DataCleaning...
2022-09-22 05:47:04 INFO  ---RUNTIME: Plan generation took 0.6561279296875 ms
2022-09-22 05:47:04 INFO  Estimated runtime of original DAG is 13401.790380477905ms
2022-09-22 05:47:04 INFO  Performing Multi-Query Optimization
2022-09-22 05:47:04 INFO  Estimated unoptimized what-if runtime is 268035.8076095581ms
2022-09-22 05:47:04 INFO  Estimated optimised what-if runtime is 111478.10959815979ms
2022-09-22 05:47:04 INFO  Estimated optimisation runtime saving is 156557.69801139832ms
2022-09-22 05:47:04 INFO  ---RUNTIME: Multi-Query Optimization took 106.67061805725098 ms
2022-09-22 05:47:04 INFO  Executing generated plans
2022-09-22 05:49:10 INFO  ---RUNTIME: Execution took 125641.15786552429 ms
2022-09-22 05:49:10 INFO  Done!
2022-09-22 05:49:10 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-22 05:49:10 INFO  Running instrumented original pipeline...
2022-09-22 05:49:10 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-22 05:49:10 INFO  ---RUNTIME: Importing and monkey-patching took 6.474733352661133 ms
2022-09-22 05:49:28 INFO  ---RUNTIME: Original pipeline execution took 18021.321296691895 ms (excluding imports and monkey-patching)
2022-09-22 05:49:28 INFO  Starting execution of 1 what-if analyses...
2022-09-22 05:49:28 INFO  Start plan generation for analysis DataCleaning...
2022-09-22 05:49:28 INFO  ---RUNTIME: Plan generation took 0.6389617919921875 ms
2022-09-22 05:49:28 INFO  Estimated runtime of original DAG is 14458.414316177368ms
2022-09-22 05:49:28 WARNING Skipping Multi-Query Optimization (instead, only applying patches)
2022-09-22 05:49:28 WARNING Columns ['review_id'] not present in train DAG after the train test split, only before!
2022-09-22 05:49:28 WARNING This could hint at data leakage!
2022-09-22 05:49:28 INFO  Estimated unoptimised what-if runtime is 289168.28632354736ms
2022-09-22 05:49:28 INFO  ---RUNTIME: Multi-Query Optimization took 25.756359100341797 ms
2022-09-22 05:49:28 INFO  Executing generated plans
2022-09-22 05:54:29 INFO  ---RUNTIME: Execution took 300945.20449638367 ms
2022-09-22 05:54:29 INFO  Done!
2022-09-22 05:54:29 INFO  # Finished -- repetition 3 of 7 
2022-09-22 05:54:29 INFO  # Optimization benchmark for data_cleaning with args [['reviews', 'slow_loading', 'featurization_4', 'xgboost']] -- repetition 4 of 7
2022-09-22 05:54:29 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-22 05:54:29 INFO  Running instrumented original pipeline...
2022-09-22 05:54:29 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-22 05:54:29 INFO  ---RUNTIME: Importing and monkey-patching took 6.279230117797852 ms
2022-09-22 05:54:47 INFO  ---RUNTIME: Original pipeline execution took 17669.008255004883 ms (excluding imports and monkey-patching)
2022-09-22 05:54:47 INFO  Starting execution of 1 what-if analyses...
2022-09-22 05:54:47 INFO  Start plan generation for analysis DataCleaning...
2022-09-22 05:54:47 INFO  ---RUNTIME: Plan generation took 0.6577968597412109 ms
2022-09-22 05:54:47 INFO  Estimated runtime of original DAG is 14355.894565582275ms
2022-09-22 05:54:47 INFO  Performing Multi-Query Optimization
2022-09-22 05:54:47 INFO  Estimated unoptimized what-if runtime is 287117.8913116455ms
2022-09-22 05:54:47 INFO  Estimated optimised what-if runtime is 126456.68315887451ms
2022-09-22 05:54:47 INFO  Estimated optimisation runtime saving is 160661.208152771ms
2022-09-22 05:54:47 INFO  ---RUNTIME: Multi-Query Optimization took 107.91254043579102 ms
2022-09-22 05:54:47 INFO  Executing generated plans
2022-09-22 05:56:56 INFO  ---RUNTIME: Execution took 128583.53352546692 ms
2022-09-22 05:56:56 INFO  Done!
2022-09-22 05:56:56 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-22 05:56:56 INFO  Running instrumented original pipeline...
2022-09-22 05:56:56 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-22 05:56:56 INFO  ---RUNTIME: Importing and monkey-patching took 6.306648254394531 ms
2022-09-22 05:57:14 INFO  ---RUNTIME: Original pipeline execution took 18242.571592330933 ms (excluding imports and monkey-patching)
2022-09-22 05:57:14 INFO  Starting execution of 1 what-if analyses...
2022-09-22 05:57:14 INFO  Start plan generation for analysis DataCleaning...
2022-09-22 05:57:14 INFO  ---RUNTIME: Plan generation took 0.6680488586425781 ms
2022-09-22 05:57:14 INFO  Estimated runtime of original DAG is 14589.073181152344ms
2022-09-22 05:57:14 WARNING Skipping Multi-Query Optimization (instead, only applying patches)
2022-09-22 05:57:14 WARNING Columns ['review_id'] not present in train DAG after the train test split, only before!
2022-09-22 05:57:14 WARNING This could hint at data leakage!
2022-09-22 05:57:14 INFO  Estimated unoptimised what-if runtime is 291781.4636230469ms
2022-09-22 05:57:14 INFO  ---RUNTIME: Multi-Query Optimization took 26.122570037841797 ms
2022-09-22 05:57:14 INFO  Executing generated plans
2022-09-22 06:02:14 INFO  ---RUNTIME: Execution took 299833.8928222656 ms
2022-09-22 06:02:14 INFO  Done!
2022-09-22 06:02:14 INFO  # Finished -- repetition 4 of 7 
2022-09-22 06:02:14 INFO  # Optimization benchmark for data_cleaning with args [['reviews', 'slow_loading', 'featurization_4', 'xgboost']] -- repetition 5 of 7
2022-09-22 06:02:14 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-22 06:02:14 INFO  Running instrumented original pipeline...
2022-09-22 06:02:14 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-22 06:02:14 INFO  ---RUNTIME: Importing and monkey-patching took 6.252765655517578 ms
2022-09-22 06:02:30 INFO  ---RUNTIME: Original pipeline execution took 16668.365240097046 ms (excluding imports and monkey-patching)
2022-09-22 06:02:30 INFO  Starting execution of 1 what-if analyses...
2022-09-22 06:02:30 INFO  Start plan generation for analysis DataCleaning...
2022-09-22 06:02:30 INFO  ---RUNTIME: Plan generation took 0.6701946258544922 ms
2022-09-22 06:02:30 INFO  Estimated runtime of original DAG is 13033.46848487854ms
2022-09-22 06:02:30 INFO  Performing Multi-Query Optimization
2022-09-22 06:02:30 INFO  Estimated unoptimized what-if runtime is 260669.3696975708ms
2022-09-22 06:02:30 INFO  Estimated optimised what-if runtime is 105425.11582374573ms
2022-09-22 06:02:30 INFO  Estimated optimisation runtime saving is 155244.25387382507ms
2022-09-22 06:02:30 INFO  ---RUNTIME: Multi-Query Optimization took 106.8274974822998 ms
2022-09-22 06:02:30 INFO  Executing generated plans
2022-09-22 06:04:39 INFO  ---RUNTIME: Execution took 128486.8860244751 ms
2022-09-22 06:04:39 INFO  Done!
2022-09-22 06:04:39 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-22 06:04:39 INFO  Running instrumented original pipeline...
2022-09-22 06:04:39 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-22 06:04:39 INFO  ---RUNTIME: Importing and monkey-patching took 6.865024566650391 ms
2022-09-22 06:04:56 INFO  ---RUNTIME: Original pipeline execution took 17471.575498580933 ms (excluding imports and monkey-patching)
2022-09-22 06:04:56 INFO  Starting execution of 1 what-if analyses...
2022-09-22 06:04:56 INFO  Start plan generation for analysis DataCleaning...
2022-09-22 06:04:56 INFO  ---RUNTIME: Plan generation took 0.6773471832275391 ms
2022-09-22 06:04:56 INFO  Estimated runtime of original DAG is 14140.623092651367ms
2022-09-22 06:04:56 WARNING Skipping Multi-Query Optimization (instead, only applying patches)
2022-09-22 06:04:56 WARNING Columns ['review_id'] not present in train DAG after the train test split, only before!
2022-09-22 06:04:56 WARNING This could hint at data leakage!
2022-09-22 06:04:56 INFO  Estimated unoptimised what-if runtime is 282812.46185302734ms
2022-09-22 06:04:56 INFO  ---RUNTIME: Multi-Query Optimization took 26.332855224609375 ms
2022-09-22 06:04:56 INFO  Executing generated plans
2022-09-22 06:09:59 INFO  ---RUNTIME: Execution took 302739.7692203522 ms
2022-09-22 06:09:59 INFO  Done!
2022-09-22 06:09:59 INFO  # Finished -- repetition 5 of 7 
2022-09-22 06:09:59 INFO  # Optimization benchmark for data_cleaning with args [['reviews', 'slow_loading', 'featurization_4', 'xgboost']] -- repetition 6 of 7
2022-09-22 06:09:59 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-22 06:09:59 INFO  Running instrumented original pipeline...
2022-09-22 06:09:59 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-22 06:09:59 INFO  ---RUNTIME: Importing and monkey-patching took 6.004571914672852 ms
2022-09-22 06:10:17 INFO  ---RUNTIME: Original pipeline execution took 17705.848932266235 ms (excluding imports and monkey-patching)
2022-09-22 06:10:17 INFO  Starting execution of 1 what-if analyses...
2022-09-22 06:10:17 INFO  Start plan generation for analysis DataCleaning...
2022-09-22 06:10:17 INFO  ---RUNTIME: Plan generation took 0.67901611328125 ms
2022-09-22 06:10:17 INFO  Estimated runtime of original DAG is 14181.257963180542ms
2022-09-22 06:10:17 INFO  Performing Multi-Query Optimization
2022-09-22 06:10:17 INFO  Estimated unoptimized what-if runtime is 283625.15926361084ms
2022-09-22 06:10:17 INFO  Estimated optimised what-if runtime is 126135.24293899536ms
2022-09-22 06:10:17 INFO  Estimated optimisation runtime saving is 157489.91632461548ms
2022-09-22 06:10:17 INFO  ---RUNTIME: Multi-Query Optimization took 107.99956321716309 ms
2022-09-22 06:10:17 INFO  Executing generated plans
2022-09-22 06:12:17 INFO  ---RUNTIME: Execution took 120006.69717788696 ms
2022-09-22 06:12:17 INFO  Done!
2022-09-22 06:12:17 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-22 06:12:17 INFO  Running instrumented original pipeline...
2022-09-22 06:12:17 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-22 06:12:17 INFO  ---RUNTIME: Importing and monkey-patching took 5.980730056762695 ms
2022-09-22 06:12:35 INFO  ---RUNTIME: Original pipeline execution took 17582.61227607727 ms (excluding imports and monkey-patching)
2022-09-22 06:12:35 INFO  Starting execution of 1 what-if analyses...
2022-09-22 06:12:35 INFO  Start plan generation for analysis DataCleaning...
2022-09-22 06:12:35 INFO  ---RUNTIME: Plan generation took 0.7364749908447266 ms
2022-09-22 06:12:35 INFO  Estimated runtime of original DAG is 13848.443031311035ms
2022-09-22 06:12:35 WARNING Skipping Multi-Query Optimization (instead, only applying patches)
2022-09-22 06:12:35 WARNING Columns ['review_id'] not present in train DAG after the train test split, only before!
2022-09-22 06:12:35 WARNING This could hint at data leakage!
2022-09-22 06:12:35 INFO  Estimated unoptimised what-if runtime is 276968.8606262207ms
2022-09-22 06:12:35 INFO  ---RUNTIME: Multi-Query Optimization took 31.012296676635742 ms
2022-09-22 06:12:35 INFO  Executing generated plans
2022-09-22 06:17:37 INFO  ---RUNTIME: Execution took 302547.6682186127 ms
2022-09-22 06:17:37 INFO  Done!
2022-09-22 06:17:37 INFO  # Finished -- repetition 6 of 7 
2022-09-22 06:17:37 INFO  # Optimization benchmark for data_cleaning with args [['reviews', 'slow_loading', 'featurization_4', 'xgboost']] -- repetition 7 of 7
2022-09-22 06:17:37 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-22 06:17:37 INFO  Running instrumented original pipeline...
2022-09-22 06:17:38 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-22 06:17:38 INFO  ---RUNTIME: Importing and monkey-patching took 5.983591079711914 ms
2022-09-22 06:17:55 INFO  ---RUNTIME: Original pipeline execution took 17753.904104232788 ms (excluding imports and monkey-patching)
2022-09-22 06:17:55 INFO  Starting execution of 1 what-if analyses...
2022-09-22 06:17:55 INFO  Start plan generation for analysis DataCleaning...
2022-09-22 06:17:55 INFO  ---RUNTIME: Plan generation took 0.8471012115478516 ms
2022-09-22 06:17:55 INFO  Estimated runtime of original DAG is 14090.09575843811ms
2022-09-22 06:17:55 INFO  Performing Multi-Query Optimization
2022-09-22 06:17:55 INFO  Estimated unoptimized what-if runtime is 281801.9151687622ms
2022-09-22 06:17:55 INFO  Estimated optimised what-if runtime is 125558.65025520325ms
2022-09-22 06:17:55 INFO  Estimated optimisation runtime saving is 156243.26491355896ms
2022-09-22 06:17:55 INFO  ---RUNTIME: Multi-Query Optimization took 123.45719337463379 ms
2022-09-22 06:17:55 INFO  Executing generated plans
2022-09-22 06:19:55 INFO  ---RUNTIME: Execution took 119765.32483100891 ms
2022-09-22 06:19:55 INFO  Done!
2022-09-22 06:19:55 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-22 06:19:55 INFO  Running instrumented original pipeline...
2022-09-22 06:19:55 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-22 06:19:55 INFO  ---RUNTIME: Importing and monkey-patching took 6.391048431396484 ms
2022-09-22 06:20:12 INFO  ---RUNTIME: Original pipeline execution took 16682.42645263672 ms (excluding imports and monkey-patching)
2022-09-22 06:20:12 INFO  Starting execution of 1 what-if analyses...
2022-09-22 06:20:12 INFO  Start plan generation for analysis DataCleaning...
2022-09-22 06:20:12 INFO  ---RUNTIME: Plan generation took 0.7228851318359375 ms
2022-09-22 06:20:12 INFO  Estimated runtime of original DAG is 13031.428813934326ms
2022-09-22 06:20:12 WARNING Skipping Multi-Query Optimization (instead, only applying patches)
2022-09-22 06:20:12 WARNING Columns ['review_id'] not present in train DAG after the train test split, only before!
2022-09-22 06:20:12 WARNING This could hint at data leakage!
2022-09-22 06:20:12 INFO  Estimated unoptimised what-if runtime is 260628.57627868652ms
2022-09-22 06:20:12 INFO  ---RUNTIME: Multi-Query Optimization took 26.151657104492188 ms
2022-09-22 06:20:12 INFO  Executing generated plans
2022-09-22 06:25:16 INFO  ---RUNTIME: Execution took 304715.78001976013 ms
2022-09-22 06:25:16 INFO  Done!
2022-09-22 06:25:16 INFO  # Finished -- repetition 7 of 7 
2022-09-22 06:25:16 INFO  # Final results after all repetitions
2022-09-22 06:25:16 INFO     repetition  ... no_opt_what_if_execution_combined_model_training
0           0  ...                                     87742.377520
1           1  ...                                     84773.603201
2           2  ...                                     79290.419579
3           3  ...                                     78718.143225
4           4  ...                                     80904.809713
5           5  ...                                     80839.601278
6           6  ...                                     83526.323795

[7 rows x 26 columns]
taskset -c 160-167 PROTOCOL_BUFFERS_PYTHON_IMPLEMENTATION=python python3.9 benchmarks_end_to_end.py data_cleaning reviews slow_loading featurization_4 neural_network
2022-09-22 06:25:18.997727: W tensorflow/stream_executor/platform/default/dso_loader.cc:64] Could not load dynamic library 'libcudart.so.11.0'; dlerror: libcudart.so.11.0: cannot open shared object file: No such file or directory; LD_LIBRARY_PATH: /home/sgrafbe/mlwhatif/venv/lib/python3.9/site-packages/cv2/../../lib64:
2022-09-22 06:25:18.997771: I tensorflow/stream_executor/cuda/cudart_stub.cc:29] Ignore above cudart dlerror if you do not have a GPU set up on your machine.
2022-09-22 06:25:20 INFO  Patching sys.argv with ['mlwhatif', 'reviews', 'slow_loading', 'featurization_4', 'neural_network']
2022-09-22 06:25:20 INFO  Running instrumented original pipeline...
2022-09-22 06:25:20 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-22 06:25:20 INFO  ---RUNTIME: Importing and monkey-patching took 116.20831489562988 ms
2022-09-22 06:25:33.578236: W tensorflow/stream_executor/platform/default/dso_loader.cc:64] Could not load dynamic library 'libcuda.so.1'; dlerror: libcuda.so.1: cannot open shared object file: No such file or directory; LD_LIBRARY_PATH: /home/sgrafbe/mlwhatif/venv/lib/python3.9/site-packages/cv2/../../lib64:
2022-09-22 06:25:33.578270: W tensorflow/stream_executor/cuda/cuda_driver.cc:326] failed call to cuInit: UNKNOWN ERROR (303)
2022-09-22 06:25:33.578302: I tensorflow/stream_executor/cuda/cuda_diagnostics.cc:156] kernel driver does not appear to be running on this host (wagyu): /proc/driver/nvidia/version does not exist
2022-09-22 06:25:33.578865: I tensorflow/core/platform/cpu_feature_guard.cc:142] This TensorFlow binary is optimized with oneAPI Deep Neural Network Library (oneDNN) to use the following CPU instructions in performance-critical operations:  AVX2 FMA
To enable them in other operations, rebuild TensorFlow with the appropriate compiler flags.
2022-09-22 06:25:33.650975: I tensorflow/compiler/mlir/mlir_graph_optimization_pass.cc:176] None of the MLIR Optimization Passes are enabled (registered 2)
2022-09-22 06:25:33.663364: I tensorflow/core/platform/profile_utils/cpu_utils.cc:114] CPU Frequency: 2595290000 Hz
2022-09-22 06:25:37 INFO  ---RUNTIME: Original pipeline execution took 17435.507774353027 ms (excluding imports and monkey-patching)
2022-09-22 06:25:37 INFO  Starting execution of 0 what-if analyses...
2022-09-22 06:25:37 INFO  Estimated runtime of original DAG is 14130.918264389038ms
2022-09-22 06:25:37 INFO  Performing Multi-Query Optimization
2022-09-22 06:25:37 INFO  Estimated unoptimized what-if runtime is 0ms
2022-09-22 06:25:37 INFO  Estimated optimised what-if runtime is 0ms
2022-09-22 06:25:37 INFO  Estimated optimisation runtime saving is 0ms
2022-09-22 06:25:37 INFO  ---RUNTIME: Multi-Query Optimization took 0.6396770477294922 ms
2022-09-22 06:25:37 INFO  Executing generated plans
2022-09-22 06:25:37 INFO  ---RUNTIME: Execution took 0.026702880859375 ms
2022-09-22 06:25:37 INFO  Done!
2022-09-22 06:25:37 INFO  # Optimization benchmark for data_cleaning with args [['reviews', 'slow_loading', 'featurization_4', 'neural_network']] -- repetition 1 of 7
2022-09-22 06:25:37 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-22 06:25:37 INFO  Running instrumented original pipeline...
2022-09-22 06:25:37 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-22 06:25:37 INFO  ---RUNTIME: Importing and monkey-patching took 6.578922271728516 ms
2022-09-22 06:25:54 INFO  ---RUNTIME: Original pipeline execution took 16753.831386566162 ms (excluding imports and monkey-patching)
2022-09-22 06:25:54 INFO  Starting execution of 1 what-if analyses...
2022-09-22 06:25:54 INFO  Start plan generation for analysis DataCleaning...
2022-09-22 06:25:54 INFO  ---RUNTIME: Plan generation took 0.6237030029296875 ms
2022-09-22 06:25:54 INFO  Estimated runtime of original DAG is 13269.993305206299ms
2022-09-22 06:25:54 INFO  Performing Multi-Query Optimization
2022-09-22 06:25:54 INFO  Estimated unoptimized what-if runtime is 265399.866104126ms
2022-09-22 06:25:54 INFO  Estimated optimised what-if runtime is 112532.98306465149ms
2022-09-22 06:25:54 INFO  Estimated optimisation runtime saving is 152866.8830394745ms
2022-09-22 06:25:54 INFO  ---RUNTIME: Multi-Query Optimization took 105.41987419128418 ms
2022-09-22 06:25:54 INFO  Executing generated plans
2022-09-22 06:27:57 INFO  ---RUNTIME: Execution took 122400.38013458252 ms
2022-09-22 06:27:57 INFO  Done!
2022-09-22 06:27:57 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-22 06:27:57 INFO  Running instrumented original pipeline...
2022-09-22 06:27:57 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-22 06:27:57 INFO  ---RUNTIME: Importing and monkey-patching took 6.073713302612305 ms
2022-09-22 06:28:14 INFO  ---RUNTIME: Original pipeline execution took 17322.283506393433 ms (excluding imports and monkey-patching)
2022-09-22 06:28:14 INFO  Starting execution of 1 what-if analyses...
2022-09-22 06:28:14 INFO  Start plan generation for analysis DataCleaning...
2022-09-22 06:28:14 INFO  ---RUNTIME: Plan generation took 0.6096363067626953 ms
2022-09-22 06:28:14 INFO  Estimated runtime of original DAG is 13462.52417564392ms
2022-09-22 06:28:14 WARNING Skipping Multi-Query Optimization (instead, only applying patches)
2022-09-22 06:28:14 WARNING Columns ['review_id'] not present in train DAG after the train test split, only before!
2022-09-22 06:28:14 WARNING This could hint at data leakage!
2022-09-22 06:28:14 INFO  Estimated unoptimised what-if runtime is 269250.4835128784ms
2022-09-22 06:28:14 INFO  ---RUNTIME: Multi-Query Optimization took 25.710344314575195 ms
2022-09-22 06:28:14 INFO  Executing generated plans
2022-09-22 06:33:09 INFO  ---RUNTIME: Execution took 295000.1790523529 ms
2022-09-22 06:33:09 INFO  Done!
2022-09-22 06:33:09 INFO  # Finished -- repetition 1 of 7 
2022-09-22 06:33:09 INFO  # Optimization benchmark for data_cleaning with args [['reviews', 'slow_loading', 'featurization_4', 'neural_network']] -- repetition 2 of 7
2022-09-22 06:33:09 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-22 06:33:09 INFO  Running instrumented original pipeline...
2022-09-22 06:33:09 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-22 06:33:09 INFO  ---RUNTIME: Importing and monkey-patching took 6.93058967590332 ms
2022-09-22 06:33:26 INFO  ---RUNTIME: Original pipeline execution took 16836.69352531433 ms (excluding imports and monkey-patching)
2022-09-22 06:33:26 INFO  Starting execution of 1 what-if analyses...
2022-09-22 06:33:26 INFO  Start plan generation for analysis DataCleaning...
2022-09-22 06:33:26 INFO  ---RUNTIME: Plan generation took 0.6701946258544922 ms
2022-09-22 06:33:26 INFO  Estimated runtime of original DAG is 13347.529172897339ms
2022-09-22 06:33:26 INFO  Performing Multi-Query Optimization
2022-09-22 06:33:26 INFO  Estimated unoptimized what-if runtime is 266950.5834579468ms
2022-09-22 06:33:26 INFO  Estimated optimised what-if runtime is 111175.52542686462ms
2022-09-22 06:33:26 INFO  Estimated optimisation runtime saving is 155775.05803108215ms
2022-09-22 06:33:26 INFO  ---RUNTIME: Multi-Query Optimization took 104.19225692749023 ms
2022-09-22 06:33:26 INFO  Executing generated plans
2022-09-22 06:35:27 INFO  ---RUNTIME: Execution took 121382.8809261322 ms
2022-09-22 06:35:27 INFO  Done!
2022-09-22 06:35:27 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-22 06:35:27 INFO  Running instrumented original pipeline...
2022-09-22 06:35:28 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-22 06:35:28 INFO  ---RUNTIME: Importing and monkey-patching took 5.918025970458984 ms
2022-09-22 06:35:45 INFO  ---RUNTIME: Original pipeline execution took 17131.837844848633 ms (excluding imports and monkey-patching)
2022-09-22 06:35:45 INFO  Starting execution of 1 what-if analyses...
2022-09-22 06:35:45 INFO  Start plan generation for analysis DataCleaning...
2022-09-22 06:35:45 INFO  ---RUNTIME: Plan generation took 0.6778240203857422 ms
2022-09-22 06:35:45 INFO  Estimated runtime of original DAG is 13301.148176193237ms
2022-09-22 06:35:45 WARNING Skipping Multi-Query Optimization (instead, only applying patches)
2022-09-22 06:35:45 WARNING Columns ['review_id'] not present in train DAG after the train test split, only before!
2022-09-22 06:35:45 WARNING This could hint at data leakage!
2022-09-22 06:35:45 INFO  Estimated unoptimised what-if runtime is 266022.96352386475ms
2022-09-22 06:35:45 INFO  ---RUNTIME: Multi-Query Optimization took 26.398420333862305 ms
2022-09-22 06:35:45 INFO  Executing generated plans
2022-09-22 06:40:39 INFO  ---RUNTIME: Execution took 294277.3997783661 ms
2022-09-22 06:40:39 INFO  Done!
2022-09-22 06:40:39 INFO  # Finished -- repetition 2 of 7 
2022-09-22 06:40:39 INFO  # Optimization benchmark for data_cleaning with args [['reviews', 'slow_loading', 'featurization_4', 'neural_network']] -- repetition 3 of 7
2022-09-22 06:40:39 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-22 06:40:39 INFO  Running instrumented original pipeline...
2022-09-22 06:40:39 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-22 06:40:39 INFO  ---RUNTIME: Importing and monkey-patching took 5.844354629516602 ms
2022-09-22 06:40:56 INFO  ---RUNTIME: Original pipeline execution took 17049.886465072632 ms (excluding imports and monkey-patching)
2022-09-22 06:40:56 INFO  Starting execution of 1 what-if analyses...
2022-09-22 06:40:56 INFO  Start plan generation for analysis DataCleaning...
2022-09-22 06:40:56 INFO  ---RUNTIME: Plan generation took 0.6935596466064453 ms
2022-09-22 06:40:56 INFO  Estimated runtime of original DAG is 13466.336250305176ms
2022-09-22 06:40:56 INFO  Performing Multi-Query Optimization
2022-09-22 06:40:56 INFO  Estimated unoptimized what-if runtime is 269326.7250061035ms
2022-09-22 06:40:56 INFO  Estimated optimised what-if runtime is 117310.64200401306ms
2022-09-22 06:40:56 INFO  Estimated optimisation runtime saving is 152016.08300209045ms
2022-09-22 06:40:56 INFO  ---RUNTIME: Multi-Query Optimization took 128.50522994995117 ms
2022-09-22 06:40:56 INFO  Executing generated plans
2022-09-22 06:42:57 INFO  ---RUNTIME: Execution took 120948.05812835693 ms
2022-09-22 06:42:57 INFO  Done!
2022-09-22 06:42:57 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-22 06:42:57 INFO  Running instrumented original pipeline...
2022-09-22 06:42:57 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-22 06:42:57 INFO  ---RUNTIME: Importing and monkey-patching took 6.064891815185547 ms
2022-09-22 06:43:14 INFO  ---RUNTIME: Original pipeline execution took 17204.442262649536 ms (excluding imports and monkey-patching)
2022-09-22 06:43:14 INFO  Starting execution of 1 what-if analyses...
2022-09-22 06:43:14 INFO  Start plan generation for analysis DataCleaning...
2022-09-22 06:43:14 INFO  ---RUNTIME: Plan generation took 0.6394386291503906 ms
2022-09-22 06:43:14 INFO  Estimated runtime of original DAG is 13969.021081924438ms
2022-09-22 06:43:14 WARNING Skipping Multi-Query Optimization (instead, only applying patches)
2022-09-22 06:43:14 WARNING Columns ['review_id'] not present in train DAG after the train test split, only before!
2022-09-22 06:43:14 WARNING This could hint at data leakage!
2022-09-22 06:43:14 INFO  Estimated unoptimised what-if runtime is 279380.42163848877ms
2022-09-22 06:43:14 INFO  ---RUNTIME: Multi-Query Optimization took 25.587081909179688 ms
2022-09-22 06:43:14 INFO  Executing generated plans
2022-09-22 06:48:09 INFO  ---RUNTIME: Execution took 294469.9401855469 ms
2022-09-22 06:48:09 INFO  Done!
2022-09-22 06:48:09 INFO  # Finished -- repetition 3 of 7 
2022-09-22 06:48:09 INFO  # Optimization benchmark for data_cleaning with args [['reviews', 'slow_loading', 'featurization_4', 'neural_network']] -- repetition 4 of 7
2022-09-22 06:48:09 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-22 06:48:09 INFO  Running instrumented original pipeline...
2022-09-22 06:48:09 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-22 06:48:09 INFO  ---RUNTIME: Importing and monkey-patching took 5.967617034912109 ms
2022-09-22 06:48:26 INFO  ---RUNTIME: Original pipeline execution took 17031.474828720093 ms (excluding imports and monkey-patching)
2022-09-22 06:48:26 INFO  Starting execution of 1 what-if analyses...
2022-09-22 06:48:26 INFO  Start plan generation for analysis DataCleaning...
2022-09-22 06:48:26 INFO  ---RUNTIME: Plan generation took 0.6277561187744141 ms
2022-09-22 06:48:26 INFO  Estimated runtime of original DAG is 13313.691139221191ms
2022-09-22 06:48:26 INFO  Performing Multi-Query Optimization
2022-09-22 06:48:26 INFO  Estimated unoptimized what-if runtime is 266273.8227844238ms
2022-09-22 06:48:26 INFO  Estimated optimised what-if runtime is 112069.62132453918ms
2022-09-22 06:48:26 INFO  Estimated optimisation runtime saving is 154204.20145988464ms
2022-09-22 06:48:26 INFO  ---RUNTIME: Multi-Query Optimization took 106.27460479736328 ms
2022-09-22 06:48:26 INFO  Executing generated plans
2022-09-22 06:50:27 INFO  ---RUNTIME: Execution took 121058.27832221985 ms
2022-09-22 06:50:27 INFO  Done!
2022-09-22 06:50:27 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-22 06:50:27 INFO  Running instrumented original pipeline...
2022-09-22 06:50:28 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-22 06:50:28 INFO  ---RUNTIME: Importing and monkey-patching took 5.914211273193359 ms
2022-09-22 06:50:44 INFO  ---RUNTIME: Original pipeline execution took 17286.899089813232 ms (excluding imports and monkey-patching)
2022-09-22 06:50:44 INFO  Starting execution of 1 what-if analyses...
2022-09-22 06:50:44 INFO  Start plan generation for analysis DataCleaning...
2022-09-22 06:50:44 INFO  ---RUNTIME: Plan generation took 0.6449222564697266 ms
2022-09-22 06:50:44 INFO  Estimated runtime of original DAG is 13407.857179641724ms
2022-09-22 06:50:44 WARNING Skipping Multi-Query Optimization (instead, only applying patches)
2022-09-22 06:50:44 WARNING Columns ['review_id'] not present in train DAG after the train test split, only before!
2022-09-22 06:50:44 WARNING This could hint at data leakage!
2022-09-22 06:50:44 INFO  Estimated unoptimised what-if runtime is 268157.1435928345ms
2022-09-22 06:50:44 INFO  ---RUNTIME: Multi-Query Optimization took 25.928735733032227 ms
2022-09-22 06:50:44 INFO  Executing generated plans
2022-09-22 06:55:38 INFO  ---RUNTIME: Execution took 294079.824924469 ms
2022-09-22 06:55:38 INFO  Done!
2022-09-22 06:55:38 INFO  # Finished -- repetition 4 of 7 
2022-09-22 06:55:38 INFO  # Optimization benchmark for data_cleaning with args [['reviews', 'slow_loading', 'featurization_4', 'neural_network']] -- repetition 5 of 7
2022-09-22 06:55:38 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-22 06:55:38 INFO  Running instrumented original pipeline...
2022-09-22 06:55:38 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-22 06:55:38 INFO  ---RUNTIME: Importing and monkey-patching took 5.925893783569336 ms
2022-09-22 06:55:55 INFO  ---RUNTIME: Original pipeline execution took 16995.147943496704 ms (excluding imports and monkey-patching)
2022-09-22 06:55:55 INFO  Starting execution of 1 what-if analyses...
2022-09-22 06:55:55 INFO  Start plan generation for analysis DataCleaning...
2022-09-22 06:55:55 INFO  ---RUNTIME: Plan generation took 0.6265640258789062 ms
2022-09-22 06:55:55 INFO  Estimated runtime of original DAG is 13692.777872085571ms
2022-09-22 06:55:55 INFO  Performing Multi-Query Optimization
2022-09-22 06:55:55 INFO  Estimated unoptimized what-if runtime is 273855.5574417114ms
2022-09-22 06:55:55 INFO  Estimated optimised what-if runtime is 112856.858253479ms
2022-09-22 06:55:55 INFO  Estimated optimisation runtime saving is 160998.69918823242ms
2022-09-22 06:55:55 INFO  ---RUNTIME: Multi-Query Optimization took 104.41470146179199 ms
2022-09-22 06:55:55 INFO  Executing generated plans
2022-09-22 06:57:56 INFO  ---RUNTIME: Execution took 120936.48290634155 ms
2022-09-22 06:57:56 INFO  Done!
2022-09-22 06:57:56 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-22 06:57:56 INFO  Running instrumented original pipeline...
2022-09-22 06:57:56 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-22 06:57:56 INFO  ---RUNTIME: Importing and monkey-patching took 6.930351257324219 ms
2022-09-22 06:58:14 INFO  ---RUNTIME: Original pipeline execution took 17825.250148773193 ms (excluding imports and monkey-patching)
2022-09-22 06:58:14 INFO  Starting execution of 1 what-if analyses...
2022-09-22 06:58:14 INFO  Start plan generation for analysis DataCleaning...
2022-09-22 06:58:14 INFO  ---RUNTIME: Plan generation took 0.6368160247802734 ms
2022-09-22 06:58:14 INFO  Estimated runtime of original DAG is 13776.646137237549ms
2022-09-22 06:58:14 WARNING Skipping Multi-Query Optimization (instead, only applying patches)
2022-09-22 06:58:14 WARNING Columns ['review_id'] not present in train DAG after the train test split, only before!
2022-09-22 06:58:14 WARNING This could hint at data leakage!
2022-09-22 06:58:14 INFO  Estimated unoptimised what-if runtime is 275532.922744751ms
2022-09-22 06:58:14 INFO  ---RUNTIME: Multi-Query Optimization took 25.614500045776367 ms
2022-09-22 06:58:14 INFO  Executing generated plans
2022-09-22 07:03:10 INFO  ---RUNTIME: Execution took 295956.8922519684 ms
2022-09-22 07:03:10 INFO  Done!
2022-09-22 07:03:10 INFO  # Finished -- repetition 5 of 7 
2022-09-22 07:03:10 INFO  # Optimization benchmark for data_cleaning with args [['reviews', 'slow_loading', 'featurization_4', 'neural_network']] -- repetition 6 of 7
2022-09-22 07:03:10 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-22 07:03:10 INFO  Running instrumented original pipeline...
2022-09-22 07:03:10 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-22 07:03:10 INFO  ---RUNTIME: Importing and monkey-patching took 5.993843078613281 ms
2022-09-22 07:03:27 INFO  ---RUNTIME: Original pipeline execution took 16889.22142982483 ms (excluding imports and monkey-patching)
2022-09-22 07:03:27 INFO  Starting execution of 1 what-if analyses...
2022-09-22 07:03:27 INFO  Start plan generation for analysis DataCleaning...
2022-09-22 07:03:27 INFO  ---RUNTIME: Plan generation took 0.5407333374023438 ms
2022-09-22 07:03:27 INFO  Estimated runtime of original DAG is 13602.419376373291ms
2022-09-22 07:03:27 INFO  Performing Multi-Query Optimization
2022-09-22 07:03:27 INFO  Estimated unoptimized what-if runtime is 272048.3875274658ms
2022-09-22 07:03:27 INFO  Estimated optimised what-if runtime is 117289.08395767212ms
2022-09-22 07:03:27 INFO  Estimated optimisation runtime saving is 154759.3035697937ms
2022-09-22 07:03:27 INFO  ---RUNTIME: Multi-Query Optimization took 104.33220863342285 ms
2022-09-22 07:03:27 INFO  Executing generated plans
2022-09-22 07:05:28 INFO  ---RUNTIME: Execution took 121170.94707489014 ms
2022-09-22 07:05:28 INFO  Done!
2022-09-22 07:05:28 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-22 07:05:28 INFO  Running instrumented original pipeline...
2022-09-22 07:05:28 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-22 07:05:28 INFO  ---RUNTIME: Importing and monkey-patching took 6.020069122314453 ms
2022-09-22 07:05:46 INFO  ---RUNTIME: Original pipeline execution took 17491.174459457397 ms (excluding imports and monkey-patching)
2022-09-22 07:05:46 INFO  Starting execution of 1 what-if analyses...
2022-09-22 07:05:46 INFO  Start plan generation for analysis DataCleaning...
2022-09-22 07:05:46 INFO  ---RUNTIME: Plan generation took 0.6935596466064453 ms
2022-09-22 07:05:46 INFO  Estimated runtime of original DAG is 13461.446285247803ms
2022-09-22 07:05:46 WARNING Skipping Multi-Query Optimization (instead, only applying patches)
2022-09-22 07:05:46 WARNING Columns ['review_id'] not present in train DAG after the train test split, only before!
2022-09-22 07:05:46 WARNING This could hint at data leakage!
2022-09-22 07:05:46 INFO  Estimated unoptimised what-if runtime is 269228.92570495605ms
2022-09-22 07:05:46 INFO  ---RUNTIME: Multi-Query Optimization took 30.129194259643555 ms
2022-09-22 07:05:46 INFO  Executing generated plans
2022-09-22 07:10:41 INFO  ---RUNTIME: Execution took 295555.97972869873 ms
2022-09-22 07:10:41 INFO  Done!
2022-09-22 07:10:41 INFO  # Finished -- repetition 6 of 7 
2022-09-22 07:10:41 INFO  # Optimization benchmark for data_cleaning with args [['reviews', 'slow_loading', 'featurization_4', 'neural_network']] -- repetition 7 of 7
2022-09-22 07:10:41 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-22 07:10:41 INFO  Running instrumented original pipeline...
2022-09-22 07:10:42 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-22 07:10:42 INFO  ---RUNTIME: Importing and monkey-patching took 5.917787551879883 ms
2022-09-22 07:10:58 INFO  ---RUNTIME: Original pipeline execution took 16853.69849205017 ms (excluding imports and monkey-patching)
2022-09-22 07:10:58 INFO  Starting execution of 1 what-if analyses...
2022-09-22 07:10:58 INFO  Start plan generation for analysis DataCleaning...
2022-09-22 07:10:58 INFO  ---RUNTIME: Plan generation took 0.6349086761474609 ms
2022-09-22 07:10:58 INFO  Estimated runtime of original DAG is 13191.877603530884ms
2022-09-22 07:10:58 INFO  Performing Multi-Query Optimization
2022-09-22 07:10:58 INFO  Estimated unoptimized what-if runtime is 263837.5520706177ms
2022-09-22 07:10:58 INFO  Estimated optimised what-if runtime is 110796.90456390381ms
2022-09-22 07:10:58 INFO  Estimated optimisation runtime saving is 153040.64750671387ms
2022-09-22 07:10:58 INFO  ---RUNTIME: Multi-Query Optimization took 103.9896011352539 ms
2022-09-22 07:10:58 INFO  Executing generated plans
2022-09-22 07:13:00 INFO  ---RUNTIME: Execution took 121393.61238479614 ms
2022-09-22 07:13:00 INFO  Done!
2022-09-22 07:13:00 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-22 07:13:00 INFO  Running instrumented original pipeline...
2022-09-22 07:13:00 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-22 07:13:00 INFO  ---RUNTIME: Importing and monkey-patching took 5.903005599975586 ms
2022-09-22 07:13:17 INFO  ---RUNTIME: Original pipeline execution took 17381.237983703613 ms (excluding imports and monkey-patching)
2022-09-22 07:13:17 INFO  Starting execution of 1 what-if analyses...
2022-09-22 07:13:17 INFO  Start plan generation for analysis DataCleaning...
2022-09-22 07:13:17 INFO  ---RUNTIME: Plan generation took 0.7300376892089844 ms
2022-09-22 07:13:17 INFO  Estimated runtime of original DAG is 13470.927476882935ms
2022-09-22 07:13:17 WARNING Skipping Multi-Query Optimization (instead, only applying patches)
2022-09-22 07:13:17 WARNING Columns ['review_id'] not present in train DAG after the train test split, only before!
2022-09-22 07:13:17 WARNING This could hint at data leakage!
2022-09-22 07:13:17 INFO  Estimated unoptimised what-if runtime is 269418.5495376587ms
2022-09-22 07:13:17 INFO  ---RUNTIME: Multi-Query Optimization took 29.49833869934082 ms
2022-09-22 07:13:17 INFO  Executing generated plans
2022-09-22 07:18:12 INFO  ---RUNTIME: Execution took 295037.05978393555 ms
2022-09-22 07:18:12 INFO  Done!
2022-09-22 07:18:12 INFO  # Finished -- repetition 7 of 7 
2022-09-22 07:18:12 INFO  # Final results after all repetitions
2022-09-22 07:18:12 INFO     repetition  ... no_opt_what_if_execution_combined_model_training
0           0  ...                                     66734.494209
1           1  ...                                     66359.626532
2           2  ...                                     67531.955481
3           3  ...                                     66965.660810
4           4  ...                                     65880.389214
5           5  ...                                     66536.206961
6           6  ...                                     67033.101559

[7 rows x 26 columns]
