Variant name from 1-8: 13
Cores to use: 160-167
taskset -c 160-167 PROTOCOL_BUFFERS_PYTHON_IMPLEMENTATION=python python3.9 benchmarks_end_to_end.py data_cleaning reviews slow_loading featurization_0 logistic_regression
2022-09-21 14:34:48.810070: W tensorflow/stream_executor/platform/default/dso_loader.cc:64] Could not load dynamic library 'libcudart.so.11.0'; dlerror: libcudart.so.11.0: cannot open shared object file: No such file or directory; LD_LIBRARY_PATH: /home/sgrafbe/mlwhatif/venv/lib/python3.9/site-packages/cv2/../../lib64:
2022-09-21 14:34:48.810115: I tensorflow/stream_executor/cuda/cudart_stub.cc:29] Ignore above cudart dlerror if you do not have a GPU set up on your machine.
2022-09-21 14:34:50 INFO  Patching sys.argv with ['mlwhatif', 'reviews', 'slow_loading', 'featurization_0', 'logistic_regression']
2022-09-21 14:34:50 INFO  Running instrumented original pipeline...
2022-09-21 14:34:50 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-21 14:34:50 INFO  ---RUNTIME: Importing and monkey-patching took 95.39794921875 ms
2022-09-21 14:34:57 INFO  ---RUNTIME: Original pipeline execution took 6968.504428863525 ms (excluding imports and monkey-patching)
2022-09-21 14:34:57 INFO  Starting execution of 0 what-if analyses...
2022-09-21 14:34:57 INFO  Estimated runtime of original DAG is 5323.298215866089ms
2022-09-21 14:34:57 INFO  Performing Multi-Query Optimization
2022-09-21 14:34:57 INFO  Estimated unoptimized what-if runtime is 0ms
2022-09-21 14:34:57 INFO  Estimated optimised what-if runtime is 0ms
2022-09-21 14:34:57 INFO  Estimated optimisation runtime saving is 0ms
2022-09-21 14:34:57 INFO  ---RUNTIME: Multi-Query Optimization took 0.4849433898925781 ms
2022-09-21 14:34:57 INFO  Executing generated plans
2022-09-21 14:34:57 INFO  ---RUNTIME: Execution took 0.020503997802734375 ms
2022-09-21 14:34:57 INFO  Done!
2022-09-21 14:34:57 INFO  # Optimization benchmark for data_cleaning with args [['reviews', 'slow_loading', 'featurization_0', 'logistic_regression']] -- repetition 1 of 7
2022-09-21 14:34:57 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-21 14:34:57 INFO  Running instrumented original pipeline...
2022-09-21 14:34:57 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-21 14:34:57 INFO  ---RUNTIME: Importing and monkey-patching took 5.569696426391602 ms
2022-09-21 14:35:03 INFO  ---RUNTIME: Original pipeline execution took 6857.510328292847 ms (excluding imports and monkey-patching)
2022-09-21 14:35:03 INFO  Starting execution of 1 what-if analyses...
2022-09-21 14:35:03 INFO  Start plan generation for analysis DataCleaning...
2022-09-21 14:35:03 INFO  ---RUNTIME: Plan generation took 0.5354881286621094 ms
2022-09-21 14:35:03 INFO  Estimated runtime of original DAG is 5264.442443847656ms
2022-09-21 14:35:03 INFO  Performing Multi-Query Optimization
2022-09-21 14:35:04 INFO  Estimated unoptimized what-if runtime is 105288.84887695312ms
2022-09-21 14:35:04 INFO  Estimated optimised what-if runtime is 18691.31851196289ms
2022-09-21 14:35:04 INFO  Estimated optimisation runtime saving is 86597.53036499023ms
2022-09-21 14:35:04 INFO  ---RUNTIME: Multi-Query Optimization took 117.18320846557617 ms
2022-09-21 14:35:04 INFO  Executing generated plans
2022-09-21 14:35:29 INFO  ---RUNTIME: Execution took 25786.762952804565 ms
2022-09-21 14:35:29 INFO  Done!
2022-09-21 14:35:29 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-21 14:35:29 INFO  Running instrumented original pipeline...
2022-09-21 14:35:30 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-21 14:35:30 INFO  ---RUNTIME: Importing and monkey-patching took 5.779027938842773 ms
2022-09-21 14:35:36 INFO  ---RUNTIME: Original pipeline execution took 7040.711879730225 ms (excluding imports and monkey-patching)
2022-09-21 14:35:36 INFO  Starting execution of 1 what-if analyses...
2022-09-21 14:35:36 INFO  Start plan generation for analysis DataCleaning...
2022-09-21 14:35:36 INFO  ---RUNTIME: Plan generation took 0.5252361297607422 ms
2022-09-21 14:35:36 INFO  Estimated runtime of original DAG is 5273.53048324585ms
2022-09-21 14:35:36 WARNING Skipping Multi-Query Optimization (instead, only applying patches)
2022-09-21 14:35:36 WARNING Columns ['review_id'] not present in train DAG after the train test split, only before!
2022-09-21 14:35:36 WARNING This could hint at data leakage!
2022-09-21 14:35:36 INFO  Estimated unoptimised what-if runtime is 105470.60966491699ms
2022-09-21 14:35:36 INFO  ---RUNTIME: Multi-Query Optimization took 21.98505401611328 ms
2022-09-21 14:35:36 INFO  Executing generated plans
2022-09-21 14:37:47 INFO  ---RUNTIME: Execution took 130378.9644241333 ms
2022-09-21 14:37:47 INFO  Done!
2022-09-21 14:37:47 INFO  # Finished -- repetition 1 of 7 
2022-09-21 14:37:47 INFO  # Optimization benchmark for data_cleaning with args [['reviews', 'slow_loading', 'featurization_0', 'logistic_regression']] -- repetition 2 of 7
2022-09-21 14:37:47 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-21 14:37:47 INFO  Running instrumented original pipeline...
2022-09-21 14:37:47 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-21 14:37:47 INFO  ---RUNTIME: Importing and monkey-patching took 5.967855453491211 ms
2022-09-21 14:37:54 INFO  ---RUNTIME: Original pipeline execution took 6937.43109703064 ms (excluding imports and monkey-patching)
2022-09-21 14:37:54 INFO  Starting execution of 1 what-if analyses...
2022-09-21 14:37:54 INFO  Start plan generation for analysis DataCleaning...
2022-09-21 14:37:54 INFO  ---RUNTIME: Plan generation took 0.5924701690673828 ms
2022-09-21 14:37:54 INFO  Estimated runtime of original DAG is 5266.698598861694ms
2022-09-21 14:37:54 INFO  Performing Multi-Query Optimization
2022-09-21 14:37:54 INFO  Estimated unoptimized what-if runtime is 105333.97197723389ms
2022-09-21 14:37:54 INFO  Estimated optimised what-if runtime is 18568.769216537476ms
2022-09-21 14:37:54 INFO  Estimated optimisation runtime saving is 86765.20276069641ms
2022-09-21 14:37:54 INFO  ---RUNTIME: Multi-Query Optimization took 85.72793006896973 ms
2022-09-21 14:37:54 INFO  Executing generated plans
2022-09-21 14:38:20 INFO  ---RUNTIME: Execution took 25813.417673110962 ms
2022-09-21 14:38:20 INFO  Done!
2022-09-21 14:38:20 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-21 14:38:20 INFO  Running instrumented original pipeline...
2022-09-21 14:38:20 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-21 14:38:20 INFO  ---RUNTIME: Importing and monkey-patching took 5.766391754150391 ms
2022-09-21 14:38:27 INFO  ---RUNTIME: Original pipeline execution took 6917.319297790527 ms (excluding imports and monkey-patching)
2022-09-21 14:38:27 INFO  Starting execution of 1 what-if analyses...
2022-09-21 14:38:27 INFO  Start plan generation for analysis DataCleaning...
2022-09-21 14:38:27 INFO  ---RUNTIME: Plan generation took 0.5128383636474609 ms
2022-09-21 14:38:27 INFO  Estimated runtime of original DAG is 5296.400785446167ms
2022-09-21 14:38:27 WARNING Skipping Multi-Query Optimization (instead, only applying patches)
2022-09-21 14:38:27 WARNING Columns ['review_id'] not present in train DAG after the train test split, only before!
2022-09-21 14:38:27 WARNING This could hint at data leakage!
2022-09-21 14:38:27 INFO  Estimated unoptimised what-if runtime is 105928.01570892334ms
2022-09-21 14:38:27 INFO  ---RUNTIME: Multi-Query Optimization took 22.537708282470703 ms
2022-09-21 14:38:27 INFO  Executing generated plans
2022-09-21 14:40:38 INFO  ---RUNTIME: Execution took 131612.91599273682 ms
2022-09-21 14:40:38 INFO  Done!
2022-09-21 14:40:38 INFO  # Finished -- repetition 2 of 7 
2022-09-21 14:40:38 INFO  # Optimization benchmark for data_cleaning with args [['reviews', 'slow_loading', 'featurization_0', 'logistic_regression']] -- repetition 3 of 7
2022-09-21 14:40:38 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-21 14:40:38 INFO  Running instrumented original pipeline...
2022-09-21 14:40:38 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-21 14:40:38 INFO  ---RUNTIME: Importing and monkey-patching took 6.097555160522461 ms
2022-09-21 14:40:45 INFO  ---RUNTIME: Original pipeline execution took 6890.1426792144775 ms (excluding imports and monkey-patching)
2022-09-21 14:40:45 INFO  Starting execution of 1 what-if analyses...
2022-09-21 14:40:45 INFO  Start plan generation for analysis DataCleaning...
2022-09-21 14:40:45 INFO  ---RUNTIME: Plan generation took 0.5855560302734375 ms
2022-09-21 14:40:45 INFO  Estimated runtime of original DAG is 5255.585193634033ms
2022-09-21 14:40:45 INFO  Performing Multi-Query Optimization
2022-09-21 14:40:45 INFO  Estimated unoptimized what-if runtime is 105111.70387268066ms
2022-09-21 14:40:45 INFO  Estimated optimised what-if runtime is 18530.6339263916ms
2022-09-21 14:40:45 INFO  Estimated optimisation runtime saving is 86581.06994628906ms
2022-09-21 14:40:45 INFO  ---RUNTIME: Multi-Query Optimization took 85.76536178588867 ms
2022-09-21 14:40:45 INFO  Executing generated plans
2022-09-21 14:41:11 INFO  ---RUNTIME: Execution took 25611.597061157227 ms
2022-09-21 14:41:11 INFO  Done!
2022-09-21 14:41:11 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-21 14:41:11 INFO  Running instrumented original pipeline...
2022-09-21 14:41:11 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-21 14:41:11 INFO  ---RUNTIME: Importing and monkey-patching took 5.845308303833008 ms
2022-09-21 14:41:18 INFO  ---RUNTIME: Original pipeline execution took 6874.288320541382 ms (excluding imports and monkey-patching)
2022-09-21 14:41:18 INFO  Starting execution of 1 what-if analyses...
2022-09-21 14:41:18 INFO  Start plan generation for analysis DataCleaning...
2022-09-21 14:41:18 INFO  ---RUNTIME: Plan generation took 0.5128383636474609 ms
2022-09-21 14:41:18 INFO  Estimated runtime of original DAG is 5258.60595703125ms
2022-09-21 14:41:18 WARNING Skipping Multi-Query Optimization (instead, only applying patches)
2022-09-21 14:41:18 WARNING Columns ['review_id'] not present in train DAG after the train test split, only before!
2022-09-21 14:41:18 WARNING This could hint at data leakage!
2022-09-21 14:41:18 INFO  Estimated unoptimised what-if runtime is 105172.119140625ms
2022-09-21 14:41:18 INFO  ---RUNTIME: Multi-Query Optimization took 21.98958396911621 ms
2022-09-21 14:41:18 INFO  Executing generated plans
2022-09-21 14:43:28 INFO  ---RUNTIME: Execution took 130648.15759658813 ms
2022-09-21 14:43:28 INFO  Done!
2022-09-21 14:43:28 INFO  # Finished -- repetition 3 of 7 
2022-09-21 14:43:28 INFO  # Optimization benchmark for data_cleaning with args [['reviews', 'slow_loading', 'featurization_0', 'logistic_regression']] -- repetition 4 of 7
2022-09-21 14:43:28 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-21 14:43:28 INFO  Running instrumented original pipeline...
2022-09-21 14:43:28 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-21 14:43:28 INFO  ---RUNTIME: Importing and monkey-patching took 6.186723709106445 ms
2022-09-21 14:43:35 INFO  ---RUNTIME: Original pipeline execution took 7016.371250152588 ms (excluding imports and monkey-patching)
2022-09-21 14:43:35 INFO  Starting execution of 1 what-if analyses...
2022-09-21 14:43:35 INFO  Start plan generation for analysis DataCleaning...
2022-09-21 14:43:35 INFO  ---RUNTIME: Plan generation took 0.5309581756591797 ms
2022-09-21 14:43:35 INFO  Estimated runtime of original DAG is 5361.846923828125ms
2022-09-21 14:43:35 INFO  Performing Multi-Query Optimization
2022-09-21 14:43:36 INFO  Estimated unoptimized what-if runtime is 107236.9384765625ms
2022-09-21 14:43:36 INFO  Estimated optimised what-if runtime is 18661.707878112793ms
2022-09-21 14:43:36 INFO  Estimated optimisation runtime saving is 88575.2305984497ms
2022-09-21 14:43:36 INFO  ---RUNTIME: Multi-Query Optimization took 85.44278144836426 ms
2022-09-21 14:43:36 INFO  Executing generated plans
2022-09-21 14:44:01 INFO  ---RUNTIME: Execution took 25852.776050567627 ms
2022-09-21 14:44:01 INFO  Done!
2022-09-21 14:44:01 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-21 14:44:01 INFO  Running instrumented original pipeline...
2022-09-21 14:44:01 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-21 14:44:01 INFO  ---RUNTIME: Importing and monkey-patching took 6.023168563842773 ms
2022-09-21 14:44:08 INFO  ---RUNTIME: Original pipeline execution took 6971.375226974487 ms (excluding imports and monkey-patching)
2022-09-21 14:44:08 INFO  Starting execution of 1 what-if analyses...
2022-09-21 14:44:08 INFO  Start plan generation for analysis DataCleaning...
2022-09-21 14:44:08 INFO  ---RUNTIME: Plan generation took 0.5447864532470703 ms
2022-09-21 14:44:08 INFO  Estimated runtime of original DAG is 5311.930894851685ms
2022-09-21 14:44:08 WARNING Skipping Multi-Query Optimization (instead, only applying patches)
2022-09-21 14:44:08 WARNING Columns ['review_id'] not present in train DAG after the train test split, only before!
2022-09-21 14:44:08 WARNING This could hint at data leakage!
2022-09-21 14:44:08 INFO  Estimated unoptimised what-if runtime is 106238.61789703369ms
2022-09-21 14:44:08 INFO  ---RUNTIME: Multi-Query Optimization took 21.951913833618164 ms
2022-09-21 14:44:08 INFO  Executing generated plans
2022-09-21 14:46:19 INFO  ---RUNTIME: Execution took 130815.39583206177 ms
2022-09-21 14:46:19 INFO  Done!
2022-09-21 14:46:19 INFO  # Finished -- repetition 4 of 7 
2022-09-21 14:46:19 INFO  # Optimization benchmark for data_cleaning with args [['reviews', 'slow_loading', 'featurization_0', 'logistic_regression']] -- repetition 5 of 7
2022-09-21 14:46:19 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-21 14:46:19 INFO  Running instrumented original pipeline...
2022-09-21 14:46:19 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-21 14:46:19 INFO  ---RUNTIME: Importing and monkey-patching took 6.339788436889648 ms
2022-09-21 14:46:26 INFO  ---RUNTIME: Original pipeline execution took 6919.254302978516 ms (excluding imports and monkey-patching)
2022-09-21 14:46:26 INFO  Starting execution of 1 what-if analyses...
2022-09-21 14:46:26 INFO  Start plan generation for analysis DataCleaning...
2022-09-21 14:46:26 INFO  ---RUNTIME: Plan generation took 0.5650520324707031 ms
2022-09-21 14:46:26 INFO  Estimated runtime of original DAG is 5275.9850025177ms
2022-09-21 14:46:26 INFO  Performing Multi-Query Optimization
2022-09-21 14:46:26 INFO  Estimated unoptimized what-if runtime is 105519.700050354ms
2022-09-21 14:46:26 INFO  Estimated optimised what-if runtime is 18647.76301383972ms
2022-09-21 14:46:26 INFO  Estimated optimisation runtime saving is 86871.93703651428ms
2022-09-21 14:46:26 INFO  ---RUNTIME: Multi-Query Optimization took 85.79897880554199 ms
2022-09-21 14:46:26 INFO  Executing generated plans
2022-09-21 14:46:52 INFO  ---RUNTIME: Execution took 25818.150758743286 ms
2022-09-21 14:46:52 INFO  Done!
2022-09-21 14:46:52 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-21 14:46:52 INFO  Running instrumented original pipeline...
2022-09-21 14:46:52 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-21 14:46:52 INFO  ---RUNTIME: Importing and monkey-patching took 6.282806396484375 ms
2022-09-21 14:46:59 INFO  ---RUNTIME: Original pipeline execution took 6910.88342666626 ms (excluding imports and monkey-patching)
2022-09-21 14:46:59 INFO  Starting execution of 1 what-if analyses...
2022-09-21 14:46:59 INFO  Start plan generation for analysis DataCleaning...
2022-09-21 14:46:59 INFO  ---RUNTIME: Plan generation took 0.5207061767578125 ms
2022-09-21 14:46:59 INFO  Estimated runtime of original DAG is 5282.680511474609ms
2022-09-21 14:46:59 WARNING Skipping Multi-Query Optimization (instead, only applying patches)
2022-09-21 14:46:59 WARNING Columns ['review_id'] not present in train DAG after the train test split, only before!
2022-09-21 14:46:59 WARNING This could hint at data leakage!
2022-09-21 14:46:59 INFO  Estimated unoptimised what-if runtime is 105653.61022949219ms
2022-09-21 14:46:59 INFO  ---RUNTIME: Multi-Query Optimization took 22.001266479492188 ms
2022-09-21 14:46:59 INFO  Executing generated plans
2022-09-21 14:49:10 INFO  ---RUNTIME: Execution took 130598.46425056458 ms
2022-09-21 14:49:10 INFO  Done!
2022-09-21 14:49:10 INFO  # Finished -- repetition 5 of 7 
2022-09-21 14:49:10 INFO  # Optimization benchmark for data_cleaning with args [['reviews', 'slow_loading', 'featurization_0', 'logistic_regression']] -- repetition 6 of 7
2022-09-21 14:49:10 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-21 14:49:10 INFO  Running instrumented original pipeline...
2022-09-21 14:49:10 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-21 14:49:10 INFO  ---RUNTIME: Importing and monkey-patching took 6.281375885009766 ms
2022-09-21 14:49:17 INFO  ---RUNTIME: Original pipeline execution took 6986.728668212891 ms (excluding imports and monkey-patching)
2022-09-21 14:49:17 INFO  Starting execution of 1 what-if analyses...
2022-09-21 14:49:17 INFO  Start plan generation for analysis DataCleaning...
2022-09-21 14:49:17 INFO  ---RUNTIME: Plan generation took 0.568389892578125 ms
2022-09-21 14:49:17 INFO  Estimated runtime of original DAG is 5349.660873413086ms
2022-09-21 14:49:17 INFO  Performing Multi-Query Optimization
2022-09-21 14:49:17 INFO  Estimated unoptimized what-if runtime is 106993.21746826172ms
2022-09-21 14:49:17 INFO  Estimated optimised what-if runtime is 18780.75122833252ms
2022-09-21 14:49:17 INFO  Estimated optimisation runtime saving is 88212.4662399292ms
2022-09-21 14:49:17 INFO  ---RUNTIME: Multi-Query Optimization took 85.1140022277832 ms
2022-09-21 14:49:17 INFO  Executing generated plans
2022-09-21 14:49:42 INFO  ---RUNTIME: Execution took 25782.34076499939 ms
2022-09-21 14:49:42 INFO  Done!
2022-09-21 14:49:42 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-21 14:49:42 INFO  Running instrumented original pipeline...
2022-09-21 14:49:42 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-21 14:49:42 INFO  ---RUNTIME: Importing and monkey-patching took 6.633520126342773 ms
2022-09-21 14:49:50 INFO  ---RUNTIME: Original pipeline execution took 7487.332344055176 ms (excluding imports and monkey-patching)
2022-09-21 14:49:50 INFO  Starting execution of 1 what-if analyses...
2022-09-21 14:49:50 INFO  Start plan generation for analysis DataCleaning...
2022-09-21 14:49:50 INFO  ---RUNTIME: Plan generation took 0.5548000335693359 ms
2022-09-21 14:49:50 INFO  Estimated runtime of original DAG is 5551.800727844238ms
2022-09-21 14:49:50 WARNING Skipping Multi-Query Optimization (instead, only applying patches)
2022-09-21 14:49:50 WARNING Columns ['review_id'] not present in train DAG after the train test split, only before!
2022-09-21 14:49:50 WARNING This could hint at data leakage!
2022-09-21 14:49:50 INFO  Estimated unoptimised what-if runtime is 111036.01455688477ms
2022-09-21 14:49:50 INFO  ---RUNTIME: Multi-Query Optimization took 22.126436233520508 ms
2022-09-21 14:49:50 INFO  Executing generated plans
2022-09-21 14:52:02 INFO  ---RUNTIME: Execution took 132266.15071296692 ms
2022-09-21 14:52:02 INFO  Done!
2022-09-21 14:52:02 INFO  # Finished -- repetition 6 of 7 
2022-09-21 14:52:02 INFO  # Optimization benchmark for data_cleaning with args [['reviews', 'slow_loading', 'featurization_0', 'logistic_regression']] -- repetition 7 of 7
2022-09-21 14:52:02 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-21 14:52:02 INFO  Running instrumented original pipeline...
2022-09-21 14:52:02 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-21 14:52:02 INFO  ---RUNTIME: Importing and monkey-patching took 6.070613861083984 ms
2022-09-21 14:52:09 INFO  ---RUNTIME: Original pipeline execution took 7073.441028594971 ms (excluding imports and monkey-patching)
2022-09-21 14:52:09 INFO  Starting execution of 1 what-if analyses...
2022-09-21 14:52:09 INFO  Start plan generation for analysis DataCleaning...
2022-09-21 14:52:09 INFO  ---RUNTIME: Plan generation took 0.5652904510498047 ms
2022-09-21 14:52:09 INFO  Estimated runtime of original DAG is 5406.452178955078ms
2022-09-21 14:52:09 INFO  Performing Multi-Query Optimization
2022-09-21 14:52:09 INFO  Estimated unoptimized what-if runtime is 108129.04357910156ms
2022-09-21 14:52:09 INFO  Estimated optimised what-if runtime is 18819.89049911499ms
2022-09-21 14:52:09 INFO  Estimated optimisation runtime saving is 89309.15307998657ms
2022-09-21 14:52:09 INFO  ---RUNTIME: Multi-Query Optimization took 86.13896369934082 ms
2022-09-21 14:52:09 INFO  Executing generated plans
2022-09-21 14:52:35 INFO  ---RUNTIME: Execution took 25908.91742706299 ms
2022-09-21 14:52:35 INFO  Done!
2022-09-21 14:52:35 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-21 14:52:35 INFO  Running instrumented original pipeline...
2022-09-21 14:52:35 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-21 14:52:35 INFO  ---RUNTIME: Importing and monkey-patching took 6.236076354980469 ms
2022-09-21 14:52:43 INFO  ---RUNTIME: Original pipeline execution took 7289.056301116943 ms (excluding imports and monkey-patching)
2022-09-21 14:52:43 INFO  Starting execution of 1 what-if analyses...
2022-09-21 14:52:43 INFO  Start plan generation for analysis DataCleaning...
2022-09-21 14:52:43 INFO  ---RUNTIME: Plan generation took 0.5528926849365234 ms
2022-09-21 14:52:43 INFO  Estimated runtime of original DAG is 5614.6080493927ms
2022-09-21 14:52:43 WARNING Skipping Multi-Query Optimization (instead, only applying patches)
2022-09-21 14:52:43 WARNING Columns ['review_id'] not present in train DAG after the train test split, only before!
2022-09-21 14:52:43 WARNING This could hint at data leakage!
2022-09-21 14:52:43 INFO  Estimated unoptimised what-if runtime is 112292.160987854ms
2022-09-21 14:52:43 INFO  ---RUNTIME: Multi-Query Optimization took 22.052764892578125 ms
2022-09-21 14:52:43 INFO  Executing generated plans
2022-09-21 14:54:55 INFO  ---RUNTIME: Execution took 132724.28631782532 ms
2022-09-21 14:54:55 INFO  Done!
2022-09-21 14:54:55 INFO  # Finished -- repetition 7 of 7 
2022-09-21 14:54:55 INFO  # Final results after all repetitions
2022-09-21 14:54:55 INFO     repetition  ... no_opt_what_if_execution_combined_model_training
0           0  ...                                      3029.788017
1           1  ...                                      3050.882101
2           2  ...                                      3024.701834
3           3  ...                                      3019.636631
4           4  ...                                      3048.224688
5           5  ...                                      3013.479948
6           6  ...                                      3038.104296

[7 rows x 26 columns]
taskset -c 160-167 PROTOCOL_BUFFERS_PYTHON_IMPLEMENTATION=python python3.9 benchmarks_end_to_end.py data_cleaning reviews slow_loading featurization_0 xgboost
2022-09-21 14:54:57.981003: W tensorflow/stream_executor/platform/default/dso_loader.cc:64] Could not load dynamic library 'libcudart.so.11.0'; dlerror: libcudart.so.11.0: cannot open shared object file: No such file or directory; LD_LIBRARY_PATH: /home/sgrafbe/mlwhatif/venv/lib/python3.9/site-packages/cv2/../../lib64:
2022-09-21 14:54:57.981047: I tensorflow/stream_executor/cuda/cudart_stub.cc:29] Ignore above cudart dlerror if you do not have a GPU set up on your machine.
2022-09-21 14:54:59 INFO  Patching sys.argv with ['mlwhatif', 'reviews', 'slow_loading', 'featurization_0', 'xgboost']
2022-09-21 14:54:59 INFO  Running instrumented original pipeline...
2022-09-21 14:54:59 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-21 14:54:59 INFO  ---RUNTIME: Importing and monkey-patching took 94.95282173156738 ms
2022-09-21 14:55:06 INFO  ---RUNTIME: Original pipeline execution took 7643.486738204956 ms (excluding imports and monkey-patching)
2022-09-21 14:55:06 INFO  Starting execution of 0 what-if analyses...
2022-09-21 14:55:06 INFO  Estimated runtime of original DAG is 5997.203826904297ms
2022-09-21 14:55:06 INFO  Performing Multi-Query Optimization
2022-09-21 14:55:06 INFO  Estimated unoptimized what-if runtime is 0ms
2022-09-21 14:55:06 INFO  Estimated optimised what-if runtime is 0ms
2022-09-21 14:55:06 INFO  Estimated optimisation runtime saving is 0ms
2022-09-21 14:55:06 INFO  ---RUNTIME: Multi-Query Optimization took 0.4916191101074219 ms
2022-09-21 14:55:06 INFO  Executing generated plans
2022-09-21 14:55:06 INFO  ---RUNTIME: Execution took 0.02288818359375 ms
2022-09-21 14:55:06 INFO  Done!
2022-09-21 14:55:06 INFO  # Optimization benchmark for data_cleaning with args [['reviews', 'slow_loading', 'featurization_0', 'xgboost']] -- repetition 1 of 7
2022-09-21 14:55:06 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-21 14:55:06 INFO  Running instrumented original pipeline...
2022-09-21 14:55:06 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-21 14:55:06 INFO  ---RUNTIME: Importing and monkey-patching took 5.538702011108398 ms
2022-09-21 14:55:14 INFO  ---RUNTIME: Original pipeline execution took 7506.864786148071 ms (excluding imports and monkey-patching)
2022-09-21 14:55:14 INFO  Starting execution of 1 what-if analyses...
2022-09-21 14:55:14 INFO  Start plan generation for analysis DataCleaning...
2022-09-21 14:55:14 INFO  ---RUNTIME: Plan generation took 0.5540847778320312 ms
2022-09-21 14:55:14 INFO  Estimated runtime of original DAG is 5905.5495262146ms
2022-09-21 14:55:14 INFO  Performing Multi-Query Optimization
2022-09-21 14:55:14 INFO  Estimated unoptimized what-if runtime is 118110.99052429199ms
2022-09-21 14:55:14 INFO  Estimated optimised what-if runtime is 31583.492517471313ms
2022-09-21 14:55:14 INFO  Estimated optimisation runtime saving is 86527.49800682068ms
2022-09-21 14:55:14 INFO  ---RUNTIME: Multi-Query Optimization took 86.2581729888916 ms
2022-09-21 14:55:14 INFO  Executing generated plans
2022-09-21 14:55:53 INFO  ---RUNTIME: Execution took 39358.24203491211 ms
2022-09-21 14:55:53 INFO  Done!
2022-09-21 14:55:53 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-21 14:55:53 INFO  Running instrumented original pipeline...
2022-09-21 14:55:54 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-21 14:55:54 INFO  ---RUNTIME: Importing and monkey-patching took 5.83338737487793 ms
2022-09-21 14:56:01 INFO  ---RUNTIME: Original pipeline execution took 7813.338279724121 ms (excluding imports and monkey-patching)
2022-09-21 14:56:01 INFO  Starting execution of 1 what-if analyses...
2022-09-21 14:56:01 INFO  Start plan generation for analysis DataCleaning...
2022-09-21 14:56:01 INFO  ---RUNTIME: Plan generation took 0.5483627319335938 ms
2022-09-21 14:56:01 INFO  Estimated runtime of original DAG is 5999.811172485352ms
2022-09-21 14:56:01 WARNING Skipping Multi-Query Optimization (instead, only applying patches)
2022-09-21 14:56:01 WARNING Columns ['review_id'] not present in train DAG after the train test split, only before!
2022-09-21 14:56:01 WARNING This could hint at data leakage!
2022-09-21 14:56:01 INFO  Estimated unoptimised what-if runtime is 119996.22344970703ms
2022-09-21 14:56:01 INFO  ---RUNTIME: Multi-Query Optimization took 21.87371253967285 ms
2022-09-21 14:56:01 INFO  Executing generated plans
2022-09-21 14:58:26 INFO  ---RUNTIME: Execution took 144935.1668357849 ms
2022-09-21 14:58:26 INFO  Done!
2022-09-21 14:58:26 INFO  # Finished -- repetition 1 of 7 
2022-09-21 14:58:26 INFO  # Optimization benchmark for data_cleaning with args [['reviews', 'slow_loading', 'featurization_0', 'xgboost']] -- repetition 2 of 7
2022-09-21 14:58:26 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-21 14:58:26 INFO  Running instrumented original pipeline...
2022-09-21 14:58:26 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-21 14:58:26 INFO  ---RUNTIME: Importing and monkey-patching took 6.076812744140625 ms
2022-09-21 14:58:34 INFO  ---RUNTIME: Original pipeline execution took 7739.259719848633 ms (excluding imports and monkey-patching)
2022-09-21 14:58:34 INFO  Starting execution of 1 what-if analyses...
2022-09-21 14:58:34 INFO  Start plan generation for analysis DataCleaning...
2022-09-21 14:58:34 INFO  ---RUNTIME: Plan generation took 0.5345344543457031 ms
2022-09-21 14:58:34 INFO  Estimated runtime of original DAG is 6072.69811630249ms
2022-09-21 14:58:34 INFO  Performing Multi-Query Optimization
2022-09-21 14:58:34 INFO  Estimated unoptimized what-if runtime is 121453.9623260498ms
2022-09-21 14:58:34 INFO  Estimated optimised what-if runtime is 32075.8695602417ms
2022-09-21 14:58:34 INFO  Estimated optimisation runtime saving is 89378.0927658081ms
2022-09-21 14:58:34 INFO  ---RUNTIME: Multi-Query Optimization took 84.41853523254395 ms
2022-09-21 14:58:34 INFO  Executing generated plans
2022-09-21 14:59:14 INFO  ---RUNTIME: Execution took 39818.85623931885 ms
2022-09-21 14:59:14 INFO  Done!
2022-09-21 14:59:14 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-21 14:59:14 INFO  Running instrumented original pipeline...
2022-09-21 14:59:14 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-21 14:59:14 INFO  ---RUNTIME: Importing and monkey-patching took 5.876302719116211 ms
2022-09-21 14:59:22 INFO  ---RUNTIME: Original pipeline execution took 7797.729253768921 ms (excluding imports and monkey-patching)
2022-09-21 14:59:22 INFO  Starting execution of 1 what-if analyses...
2022-09-21 14:59:22 INFO  Start plan generation for analysis DataCleaning...
2022-09-21 14:59:22 INFO  ---RUNTIME: Plan generation took 0.5178451538085938 ms
2022-09-21 14:59:22 INFO  Estimated runtime of original DAG is 5954.639434814453ms
2022-09-21 14:59:22 WARNING Skipping Multi-Query Optimization (instead, only applying patches)
2022-09-21 14:59:22 WARNING Columns ['review_id'] not present in train DAG after the train test split, only before!
2022-09-21 14:59:22 WARNING This could hint at data leakage!
2022-09-21 14:59:22 INFO  Estimated unoptimised what-if runtime is 119092.78869628906ms
2022-09-21 14:59:22 INFO  ---RUNTIME: Multi-Query Optimization took 21.938085556030273 ms
2022-09-21 14:59:22 INFO  Executing generated plans
2022-09-21 15:01:48 INFO  ---RUNTIME: Execution took 146335.42370796204 ms
2022-09-21 15:01:48 INFO  Done!
2022-09-21 15:01:48 INFO  # Finished -- repetition 2 of 7 
2022-09-21 15:01:48 INFO  # Optimization benchmark for data_cleaning with args [['reviews', 'slow_loading', 'featurization_0', 'xgboost']] -- repetition 3 of 7
2022-09-21 15:01:48 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-21 15:01:48 INFO  Running instrumented original pipeline...
2022-09-21 15:01:48 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-21 15:01:48 INFO  ---RUNTIME: Importing and monkey-patching took 6.167173385620117 ms
2022-09-21 15:01:56 INFO  ---RUNTIME: Original pipeline execution took 8000.203847885132 ms (excluding imports and monkey-patching)
2022-09-21 15:01:56 INFO  Starting execution of 1 what-if analyses...
2022-09-21 15:01:56 INFO  Start plan generation for analysis DataCleaning...
2022-09-21 15:01:56 INFO  ---RUNTIME: Plan generation took 0.6952285766601562 ms
2022-09-21 15:01:56 INFO  Estimated runtime of original DAG is 6357.696056365967ms
2022-09-21 15:01:56 INFO  Performing Multi-Query Optimization
2022-09-21 15:01:56 INFO  Estimated unoptimized what-if runtime is 127153.92112731934ms
2022-09-21 15:01:56 INFO  Estimated optimised what-if runtime is 34642.908811569214ms
2022-09-21 15:01:56 INFO  Estimated optimisation runtime saving is 92511.01231575012ms
2022-09-21 15:01:56 INFO  ---RUNTIME: Multi-Query Optimization took 94.86961364746094 ms
2022-09-21 15:01:56 INFO  Executing generated plans
2022-09-21 15:02:36 INFO  ---RUNTIME: Execution took 40013.890743255615 ms
2022-09-21 15:02:36 INFO  Done!
2022-09-21 15:02:36 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-21 15:02:36 INFO  Running instrumented original pipeline...
2022-09-21 15:02:36 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-21 15:02:36 INFO  ---RUNTIME: Importing and monkey-patching took 6.208181381225586 ms
2022-09-21 15:02:44 INFO  ---RUNTIME: Original pipeline execution took 7583.105087280273 ms (excluding imports and monkey-patching)
2022-09-21 15:02:44 INFO  Starting execution of 1 what-if analyses...
2022-09-21 15:02:44 INFO  Start plan generation for analysis DataCleaning...
2022-09-21 15:02:44 INFO  ---RUNTIME: Plan generation took 0.5221366882324219 ms
2022-09-21 15:02:44 INFO  Estimated runtime of original DAG is 5965.0232791900635ms
2022-09-21 15:02:44 WARNING Skipping Multi-Query Optimization (instead, only applying patches)
2022-09-21 15:02:44 WARNING Columns ['review_id'] not present in train DAG after the train test split, only before!
2022-09-21 15:02:44 WARNING This could hint at data leakage!
2022-09-21 15:02:44 INFO  Estimated unoptimised what-if runtime is 119300.46558380127ms
2022-09-21 15:02:44 INFO  ---RUNTIME: Multi-Query Optimization took 21.840333938598633 ms
2022-09-21 15:02:44 INFO  Executing generated plans
2022-09-21 15:05:11 INFO  ---RUNTIME: Execution took 147252.14290618896 ms
2022-09-21 15:05:11 INFO  Done!
2022-09-21 15:05:11 INFO  # Finished -- repetition 3 of 7 
2022-09-21 15:05:11 INFO  # Optimization benchmark for data_cleaning with args [['reviews', 'slow_loading', 'featurization_0', 'xgboost']] -- repetition 4 of 7
2022-09-21 15:05:11 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-21 15:05:11 INFO  Running instrumented original pipeline...
2022-09-21 15:05:11 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-21 15:05:11 INFO  ---RUNTIME: Importing and monkey-patching took 5.982398986816406 ms
2022-09-21 15:05:19 INFO  ---RUNTIME: Original pipeline execution took 7754.10008430481 ms (excluding imports and monkey-patching)
2022-09-21 15:05:19 INFO  Starting execution of 1 what-if analyses...
2022-09-21 15:05:19 INFO  Start plan generation for analysis DataCleaning...
2022-09-21 15:05:19 INFO  ---RUNTIME: Plan generation took 0.5216598510742188 ms
2022-09-21 15:05:19 INFO  Estimated runtime of original DAG is 5958.526611328125ms
2022-09-21 15:05:19 INFO  Performing Multi-Query Optimization
2022-09-21 15:05:19 INFO  Estimated unoptimized what-if runtime is 119170.5322265625ms
2022-09-21 15:05:19 INFO  Estimated optimised what-if runtime is 31242.705583572388ms
2022-09-21 15:05:19 INFO  Estimated optimisation runtime saving is 87927.82664299011ms
2022-09-21 15:05:19 INFO  ---RUNTIME: Multi-Query Optimization took 84.03778076171875 ms
2022-09-21 15:05:19 INFO  Executing generated plans
2022-09-21 15:05:58 INFO  ---RUNTIME: Execution took 39581.315755844116 ms
2022-09-21 15:05:58 INFO  Done!
2022-09-21 15:05:58 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-21 15:05:58 INFO  Running instrumented original pipeline...
2022-09-21 15:05:58 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-21 15:05:58 INFO  ---RUNTIME: Importing and monkey-patching took 5.816459655761719 ms
2022-09-21 15:06:06 INFO  ---RUNTIME: Original pipeline execution took 7788.052320480347 ms (excluding imports and monkey-patching)
2022-09-21 15:06:06 INFO  Starting execution of 1 what-if analyses...
2022-09-21 15:06:06 INFO  Start plan generation for analysis DataCleaning...
2022-09-21 15:06:06 INFO  ---RUNTIME: Plan generation took 0.5402565002441406 ms
2022-09-21 15:06:06 INFO  Estimated runtime of original DAG is 6052.008390426636ms
2022-09-21 15:06:06 WARNING Skipping Multi-Query Optimization (instead, only applying patches)
2022-09-21 15:06:06 WARNING Columns ['review_id'] not present in train DAG after the train test split, only before!
2022-09-21 15:06:06 WARNING This could hint at data leakage!
2022-09-21 15:06:06 INFO  Estimated unoptimised what-if runtime is 121040.16780853271ms
2022-09-21 15:06:06 INFO  ---RUNTIME: Multi-Query Optimization took 21.65532112121582 ms
2022-09-21 15:06:06 INFO  Executing generated plans
2022-09-21 15:08:33 INFO  ---RUNTIME: Execution took 146670.72558403015 ms
2022-09-21 15:08:33 INFO  Done!
2022-09-21 15:08:33 INFO  # Finished -- repetition 4 of 7 
2022-09-21 15:08:33 INFO  # Optimization benchmark for data_cleaning with args [['reviews', 'slow_loading', 'featurization_0', 'xgboost']] -- repetition 5 of 7
2022-09-21 15:08:33 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-21 15:08:33 INFO  Running instrumented original pipeline...
2022-09-21 15:08:33 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-21 15:08:33 INFO  ---RUNTIME: Importing and monkey-patching took 5.991697311401367 ms
2022-09-21 15:08:41 INFO  ---RUNTIME: Original pipeline execution took 7707.973957061768 ms (excluding imports and monkey-patching)
2022-09-21 15:08:41 INFO  Starting execution of 1 what-if analyses...
2022-09-21 15:08:41 INFO  Start plan generation for analysis DataCleaning...
2022-09-21 15:08:41 INFO  ---RUNTIME: Plan generation took 0.5404949188232422 ms
2022-09-21 15:08:41 INFO  Estimated runtime of original DAG is 6085.756063461304ms
2022-09-21 15:08:41 INFO  Performing Multi-Query Optimization
2022-09-21 15:08:41 INFO  Estimated unoptimized what-if runtime is 121715.12126922607ms
2022-09-21 15:08:41 INFO  Estimated optimised what-if runtime is 31461.60078048706ms
2022-09-21 15:08:41 INFO  Estimated optimisation runtime saving is 90253.52048873901ms
2022-09-21 15:08:41 INFO  ---RUNTIME: Multi-Query Optimization took 84.89227294921875 ms
2022-09-21 15:08:41 INFO  Executing generated plans
2022-09-21 15:09:20 INFO  ---RUNTIME: Execution took 39612.8089427948 ms
2022-09-21 15:09:20 INFO  Done!
2022-09-21 15:09:20 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-21 15:09:20 INFO  Running instrumented original pipeline...
2022-09-21 15:09:20 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-21 15:09:20 INFO  ---RUNTIME: Importing and monkey-patching took 5.837917327880859 ms
2022-09-21 15:09:29 INFO  ---RUNTIME: Original pipeline execution took 8420.54271697998 ms (excluding imports and monkey-patching)
2022-09-21 15:09:29 INFO  Starting execution of 1 what-if analyses...
2022-09-21 15:09:29 INFO  Start plan generation for analysis DataCleaning...
2022-09-21 15:09:29 INFO  ---RUNTIME: Plan generation took 0.5156993865966797 ms
2022-09-21 15:09:29 INFO  Estimated runtime of original DAG is 6685.465097427368ms
2022-09-21 15:09:29 WARNING Skipping Multi-Query Optimization (instead, only applying patches)
2022-09-21 15:09:29 WARNING Columns ['review_id'] not present in train DAG after the train test split, only before!
2022-09-21 15:09:29 WARNING This could hint at data leakage!
2022-09-21 15:09:29 INFO  Estimated unoptimised what-if runtime is 133709.30194854736ms
2022-09-21 15:09:29 INFO  ---RUNTIME: Multi-Query Optimization took 21.89159393310547 ms
2022-09-21 15:09:29 INFO  Executing generated plans
2022-09-21 15:11:55 INFO  ---RUNTIME: Execution took 146276.27110481262 ms
2022-09-21 15:11:55 INFO  Done!
2022-09-21 15:11:55 INFO  # Finished -- repetition 5 of 7 
2022-09-21 15:11:55 INFO  # Optimization benchmark for data_cleaning with args [['reviews', 'slow_loading', 'featurization_0', 'xgboost']] -- repetition 6 of 7
2022-09-21 15:11:55 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-21 15:11:55 INFO  Running instrumented original pipeline...
2022-09-21 15:11:55 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-21 15:11:55 INFO  ---RUNTIME: Importing and monkey-patching took 5.972385406494141 ms
2022-09-21 15:12:03 INFO  ---RUNTIME: Original pipeline execution took 7725.111961364746 ms (excluding imports and monkey-patching)
2022-09-21 15:12:03 INFO  Starting execution of 1 what-if analyses...
2022-09-21 15:12:03 INFO  Start plan generation for analysis DataCleaning...
2022-09-21 15:12:03 INFO  ---RUNTIME: Plan generation took 0.5271434783935547 ms
2022-09-21 15:12:03 INFO  Estimated runtime of original DAG is 6103.239297866821ms
2022-09-21 15:12:03 INFO  Performing Multi-Query Optimization
2022-09-21 15:12:03 INFO  Estimated unoptimized what-if runtime is 122064.78595733643ms
2022-09-21 15:12:03 INFO  Estimated optimised what-if runtime is 31611.974954605103ms
2022-09-21 15:12:03 INFO  Estimated optimisation runtime saving is 90452.81100273132ms
2022-09-21 15:12:03 INFO  ---RUNTIME: Multi-Query Optimization took 82.48233795166016 ms
2022-09-21 15:12:03 INFO  Executing generated plans
2022-09-21 15:12:42 INFO  ---RUNTIME: Execution took 39458.94479751587 ms
2022-09-21 15:12:42 INFO  Done!
2022-09-21 15:12:42 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-21 15:12:42 INFO  Running instrumented original pipeline...
2022-09-21 15:12:43 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-21 15:12:43 INFO  ---RUNTIME: Importing and monkey-patching took 5.947113037109375 ms
2022-09-21 15:12:50 INFO  ---RUNTIME: Original pipeline execution took 8064.939975738525 ms (excluding imports and monkey-patching)
2022-09-21 15:12:50 INFO  Starting execution of 1 what-if analyses...
2022-09-21 15:12:50 INFO  Start plan generation for analysis DataCleaning...
2022-09-21 15:12:50 INFO  ---RUNTIME: Plan generation took 0.6439685821533203 ms
2022-09-21 15:12:50 INFO  Estimated runtime of original DAG is 5948.347091674805ms
2022-09-21 15:12:50 WARNING Skipping Multi-Query Optimization (instead, only applying patches)
2022-09-21 15:12:50 WARNING Columns ['review_id'] not present in train DAG after the train test split, only before!
2022-09-21 15:12:50 WARNING This could hint at data leakage!
2022-09-21 15:12:50 INFO  Estimated unoptimised what-if runtime is 118966.9418334961ms
2022-09-21 15:12:50 INFO  ---RUNTIME: Multi-Query Optimization took 21.425724029541016 ms
2022-09-21 15:12:50 INFO  Executing generated plans
2022-09-21 15:15:18 INFO  ---RUNTIME: Execution took 147780.5962562561 ms
2022-09-21 15:15:18 INFO  Done!
2022-09-21 15:15:18 INFO  # Finished -- repetition 6 of 7 
2022-09-21 15:15:18 INFO  # Optimization benchmark for data_cleaning with args [['reviews', 'slow_loading', 'featurization_0', 'xgboost']] -- repetition 7 of 7
2022-09-21 15:15:18 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-21 15:15:18 INFO  Running instrumented original pipeline...
2022-09-21 15:15:18 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-21 15:15:18 INFO  ---RUNTIME: Importing and monkey-patching took 5.941629409790039 ms
2022-09-21 15:15:26 INFO  ---RUNTIME: Original pipeline execution took 7850.103855133057 ms (excluding imports and monkey-patching)
2022-09-21 15:15:26 INFO  Starting execution of 1 what-if analyses...
2022-09-21 15:15:26 INFO  Start plan generation for analysis DataCleaning...
2022-09-21 15:15:26 INFO  ---RUNTIME: Plan generation took 0.5066394805908203 ms
2022-09-21 15:15:26 INFO  Estimated runtime of original DAG is 6069.725275039673ms
2022-09-21 15:15:26 INFO  Performing Multi-Query Optimization
2022-09-21 15:15:26 INFO  Estimated unoptimized what-if runtime is 121394.50550079346ms
2022-09-21 15:15:26 INFO  Estimated optimised what-if runtime is 31559.464693069458ms
2022-09-21 15:15:26 INFO  Estimated optimisation runtime saving is 89835.040807724ms
2022-09-21 15:15:26 INFO  ---RUNTIME: Multi-Query Optimization took 83.15157890319824 ms
2022-09-21 15:15:26 INFO  Executing generated plans
2022-09-21 15:16:06 INFO  ---RUNTIME: Execution took 39804.77023124695 ms
2022-09-21 15:16:06 INFO  Done!
2022-09-21 15:16:06 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-21 15:16:06 INFO  Running instrumented original pipeline...
2022-09-21 15:16:06 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-21 15:16:06 INFO  ---RUNTIME: Importing and monkey-patching took 5.964756011962891 ms
2022-09-21 15:16:14 INFO  ---RUNTIME: Original pipeline execution took 7527.235984802246 ms (excluding imports and monkey-patching)
2022-09-21 15:16:14 INFO  Starting execution of 1 what-if analyses...
2022-09-21 15:16:14 INFO  Start plan generation for analysis DataCleaning...
2022-09-21 15:16:14 INFO  ---RUNTIME: Plan generation took 0.5290508270263672 ms
2022-09-21 15:16:14 INFO  Estimated runtime of original DAG is 5884.909391403198ms
2022-09-21 15:16:14 WARNING Skipping Multi-Query Optimization (instead, only applying patches)
2022-09-21 15:16:14 WARNING Columns ['review_id'] not present in train DAG after the train test split, only before!
2022-09-21 15:16:14 WARNING This could hint at data leakage!
2022-09-21 15:16:14 INFO  Estimated unoptimised what-if runtime is 117698.18782806396ms
2022-09-21 15:16:14 INFO  ---RUNTIME: Multi-Query Optimization took 21.445751190185547 ms
2022-09-21 15:16:14 INFO  Executing generated plans
2022-09-21 15:18:41 INFO  ---RUNTIME: Execution took 147723.9065170288 ms
2022-09-21 15:18:41 INFO  Done!
2022-09-21 15:18:41 INFO  # Finished -- repetition 7 of 7 
2022-09-21 15:18:41 INFO  # Final results after all repetitions
2022-09-21 15:18:41 INFO     repetition  ... no_opt_what_if_execution_combined_model_training
0           0  ...                                     15848.994017
1           1  ...                                     15544.079542
2           2  ...                                     15484.636545
3           3  ...                                     15804.955244
4           4  ...                                     15700.545073
5           5  ...                                     15991.175890
6           6  ...                                     16028.923273

[7 rows x 26 columns]
taskset -c 160-167 PROTOCOL_BUFFERS_PYTHON_IMPLEMENTATION=python python3.9 benchmarks_end_to_end.py data_cleaning reviews slow_loading featurization_0 neural_network
2022-09-21 15:18:44.154052: W tensorflow/stream_executor/platform/default/dso_loader.cc:64] Could not load dynamic library 'libcudart.so.11.0'; dlerror: libcudart.so.11.0: cannot open shared object file: No such file or directory; LD_LIBRARY_PATH: /home/sgrafbe/mlwhatif/venv/lib/python3.9/site-packages/cv2/../../lib64:
2022-09-21 15:18:44.154098: I tensorflow/stream_executor/cuda/cudart_stub.cc:29] Ignore above cudart dlerror if you do not have a GPU set up on your machine.
2022-09-21 15:18:45 INFO  Patching sys.argv with ['mlwhatif', 'reviews', 'slow_loading', 'featurization_0', 'neural_network']
2022-09-21 15:18:45 INFO  Running instrumented original pipeline...
2022-09-21 15:18:45 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-21 15:18:45 INFO  ---RUNTIME: Importing and monkey-patching took 94.94805335998535 ms
2022-09-21 15:18:51.273397: W tensorflow/stream_executor/platform/default/dso_loader.cc:64] Could not load dynamic library 'libcuda.so.1'; dlerror: libcuda.so.1: cannot open shared object file: No such file or directory; LD_LIBRARY_PATH: /home/sgrafbe/mlwhatif/venv/lib/python3.9/site-packages/cv2/../../lib64:
2022-09-21 15:18:51.273437: W tensorflow/stream_executor/cuda/cuda_driver.cc:326] failed call to cuInit: UNKNOWN ERROR (303)
2022-09-21 15:18:51.273461: I tensorflow/stream_executor/cuda/cuda_diagnostics.cc:156] kernel driver does not appear to be running on this host (wagyu): /proc/driver/nvidia/version does not exist
2022-09-21 15:18:51.273981: I tensorflow/core/platform/cpu_feature_guard.cc:142] This TensorFlow binary is optimized with oneAPI Deep Neural Network Library (oneDNN) to use the following CPU instructions in performance-critical operations:  AVX2 FMA
To enable them in other operations, rebuild TensorFlow with the appropriate compiler flags.
2022-09-21 15:18:51.346741: I tensorflow/compiler/mlir/mlir_graph_optimization_pass.cc:176] None of the MLIR Optimization Passes are enabled (registered 2)
2022-09-21 15:18:51.358382: I tensorflow/core/platform/profile_utils/cpu_utils.cc:114] CPU Frequency: 2595290000 Hz
2022-09-21 15:18:56 INFO  ---RUNTIME: Original pipeline execution took 11043.766736984253 ms (excluding imports and monkey-patching)
2022-09-21 15:18:56 INFO  Starting execution of 0 what-if analyses...
2022-09-21 15:18:56 INFO  Estimated runtime of original DAG is 9172.29676246643ms
2022-09-21 15:18:56 INFO  Performing Multi-Query Optimization
2022-09-21 15:18:56 INFO  Estimated unoptimized what-if runtime is 0ms
2022-09-21 15:18:56 INFO  Estimated optimised what-if runtime is 0ms
2022-09-21 15:18:56 INFO  Estimated optimisation runtime saving is 0ms
2022-09-21 15:18:56 INFO  ---RUNTIME: Multi-Query Optimization took 0.5373954772949219 ms
2022-09-21 15:18:56 INFO  Executing generated plans
2022-09-21 15:18:56 INFO  ---RUNTIME: Execution took 0.023365020751953125 ms
2022-09-21 15:18:56 INFO  Done!
2022-09-21 15:18:56 INFO  # Optimization benchmark for data_cleaning with args [['reviews', 'slow_loading', 'featurization_0', 'neural_network']] -- repetition 1 of 7
2022-09-21 15:18:56 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-21 15:18:56 INFO  Running instrumented original pipeline...
2022-09-21 15:18:56 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-21 15:18:56 INFO  ---RUNTIME: Importing and monkey-patching took 6.031513214111328 ms
2022-09-21 15:19:07 INFO  ---RUNTIME: Original pipeline execution took 10635.557651519775 ms (excluding imports and monkey-patching)
2022-09-21 15:19:07 INFO  Starting execution of 1 what-if analyses...
2022-09-21 15:19:07 INFO  Start plan generation for analysis DataCleaning...
2022-09-21 15:19:07 INFO  ---RUNTIME: Plan generation took 0.5404949188232422 ms
2022-09-21 15:19:07 INFO  Estimated runtime of original DAG is 9017.786741256714ms
2022-09-21 15:19:07 INFO  Performing Multi-Query Optimization
2022-09-21 15:19:07 INFO  Estimated unoptimized what-if runtime is 180355.73482513428ms
2022-09-21 15:19:07 INFO  Estimated optimised what-if runtime is 91276.28350257874ms
2022-09-21 15:19:07 INFO  Estimated optimisation runtime saving is 89079.45132255554ms
2022-09-21 15:19:07 INFO  ---RUNTIME: Multi-Query Optimization took 87.11647987365723 ms
2022-09-21 15:19:07 INFO  Executing generated plans
2022-09-21 15:20:43 INFO  ---RUNTIME: Execution took 96555.08780479431 ms
2022-09-21 15:20:43 INFO  Done!
2022-09-21 15:20:43 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-21 15:20:43 INFO  Running instrumented original pipeline...
2022-09-21 15:20:43 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-21 15:20:43 INFO  ---RUNTIME: Importing and monkey-patching took 5.986690521240234 ms
2022-09-21 15:20:54 INFO  ---RUNTIME: Original pipeline execution took 10586.611986160278 ms (excluding imports and monkey-patching)
2022-09-21 15:20:54 INFO  Starting execution of 1 what-if analyses...
2022-09-21 15:20:54 INFO  Start plan generation for analysis DataCleaning...
2022-09-21 15:20:54 INFO  ---RUNTIME: Plan generation took 0.5605220794677734 ms
2022-09-21 15:20:54 INFO  Estimated runtime of original DAG is 9003.5982131958ms
2022-09-21 15:20:54 WARNING Skipping Multi-Query Optimization (instead, only applying patches)
2022-09-21 15:20:54 WARNING Columns ['review_id'] not present in train DAG after the train test split, only before!
2022-09-21 15:20:54 WARNING This could hint at data leakage!
2022-09-21 15:20:54 INFO  Estimated unoptimised what-if runtime is 180071.96426391602ms
2022-09-21 15:20:54 INFO  ---RUNTIME: Multi-Query Optimization took 23.005247116088867 ms
2022-09-21 15:20:54 INFO  Executing generated plans
2022-09-21 15:24:17 INFO  ---RUNTIME: Execution took 203480.90767860413 ms
2022-09-21 15:24:17 INFO  Done!
2022-09-21 15:24:17 INFO  # Finished -- repetition 1 of 7 
2022-09-21 15:24:17 INFO  # Optimization benchmark for data_cleaning with args [['reviews', 'slow_loading', 'featurization_0', 'neural_network']] -- repetition 2 of 7
2022-09-21 15:24:17 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-21 15:24:17 INFO  Running instrumented original pipeline...
2022-09-21 15:24:17 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-21 15:24:17 INFO  ---RUNTIME: Importing and monkey-patching took 6.281137466430664 ms
2022-09-21 15:24:28 INFO  ---RUNTIME: Original pipeline execution took 10524.146556854248 ms (excluding imports and monkey-patching)
2022-09-21 15:24:28 INFO  Starting execution of 1 what-if analyses...
2022-09-21 15:24:28 INFO  Start plan generation for analysis DataCleaning...
2022-09-21 15:24:28 INFO  ---RUNTIME: Plan generation took 0.5385875701904297 ms
2022-09-21 15:24:28 INFO  Estimated runtime of original DAG is 8807.602405548096ms
2022-09-21 15:24:28 INFO  Performing Multi-Query Optimization
2022-09-21 15:24:28 INFO  Estimated unoptimized what-if runtime is 176152.0481109619ms
2022-09-21 15:24:28 INFO  Estimated optimised what-if runtime is 87932.42621421814ms
2022-09-21 15:24:28 INFO  Estimated optimisation runtime saving is 88219.62189674377ms
2022-09-21 15:24:28 INFO  ---RUNTIME: Multi-Query Optimization took 85.49356460571289 ms
2022-09-21 15:24:28 INFO  Executing generated plans
2022-09-21 15:26:06 INFO  ---RUNTIME: Execution took 97705.49750328064 ms
2022-09-21 15:26:06 INFO  Done!
2022-09-21 15:26:06 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-21 15:26:06 INFO  Running instrumented original pipeline...
2022-09-21 15:26:06 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-21 15:26:06 INFO  ---RUNTIME: Importing and monkey-patching took 6.256341934204102 ms
2022-09-21 15:26:16 INFO  ---RUNTIME: Original pipeline execution took 10528.171062469482 ms (excluding imports and monkey-patching)
2022-09-21 15:26:16 INFO  Starting execution of 1 what-if analyses...
2022-09-21 15:26:16 INFO  Start plan generation for analysis DataCleaning...
2022-09-21 15:26:16 INFO  ---RUNTIME: Plan generation took 0.5197525024414062 ms
2022-09-21 15:26:16 INFO  Estimated runtime of original DAG is 8896.570205688477ms
2022-09-21 15:26:16 WARNING Skipping Multi-Query Optimization (instead, only applying patches)
2022-09-21 15:26:16 WARNING Columns ['review_id'] not present in train DAG after the train test split, only before!
2022-09-21 15:26:16 WARNING This could hint at data leakage!
2022-09-21 15:26:16 INFO  Estimated unoptimised what-if runtime is 177931.40411376953ms
2022-09-21 15:26:16 INFO  ---RUNTIME: Multi-Query Optimization took 23.65422248840332 ms
2022-09-21 15:26:16 INFO  Executing generated plans
2022-09-21 15:29:41 INFO  ---RUNTIME: Execution took 204307.20925331116 ms
2022-09-21 15:29:41 INFO  Done!
2022-09-21 15:29:41 INFO  # Finished -- repetition 2 of 7 
2022-09-21 15:29:41 INFO  # Optimization benchmark for data_cleaning with args [['reviews', 'slow_loading', 'featurization_0', 'neural_network']] -- repetition 3 of 7
2022-09-21 15:29:41 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-21 15:29:41 INFO  Running instrumented original pipeline...
2022-09-21 15:29:41 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-21 15:29:41 INFO  ---RUNTIME: Importing and monkey-patching took 6.317615509033203 ms
2022-09-21 15:29:52 INFO  ---RUNTIME: Original pipeline execution took 11094.331741333008 ms (excluding imports and monkey-patching)
2022-09-21 15:29:52 INFO  Starting execution of 1 what-if analyses...
2022-09-21 15:29:52 INFO  Start plan generation for analysis DataCleaning...
2022-09-21 15:29:52 INFO  ---RUNTIME: Plan generation took 0.5791187286376953 ms
2022-09-21 15:29:52 INFO  Estimated runtime of original DAG is 9424.830436706543ms
2022-09-21 15:29:52 INFO  Performing Multi-Query Optimization
2022-09-21 15:29:52 INFO  Estimated unoptimized what-if runtime is 188496.60873413086ms
2022-09-21 15:29:52 INFO  Estimated optimised what-if runtime is 88154.01887893677ms
2022-09-21 15:29:52 INFO  Estimated optimisation runtime saving is 100342.58985519409ms
2022-09-21 15:29:52 INFO  ---RUNTIME: Multi-Query Optimization took 92.76604652404785 ms
2022-09-21 15:29:52 INFO  Executing generated plans
2022-09-21 15:31:30 INFO  ---RUNTIME: Execution took 97716.84288978577 ms
2022-09-21 15:31:30 INFO  Done!
2022-09-21 15:31:30 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-21 15:31:30 INFO  Running instrumented original pipeline...
2022-09-21 15:31:30 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-21 15:31:30 INFO  ---RUNTIME: Importing and monkey-patching took 6.544351577758789 ms
2022-09-21 15:31:41 INFO  ---RUNTIME: Original pipeline execution took 11623.107194900513 ms (excluding imports and monkey-patching)
2022-09-21 15:31:41 INFO  Starting execution of 1 what-if analyses...
2022-09-21 15:31:41 INFO  Start plan generation for analysis DataCleaning...
2022-09-21 15:31:41 INFO  ---RUNTIME: Plan generation took 0.49185752868652344 ms
2022-09-21 15:31:41 INFO  Estimated runtime of original DAG is 10026.72266960144ms
2022-09-21 15:31:41 WARNING Skipping Multi-Query Optimization (instead, only applying patches)
2022-09-21 15:31:41 WARNING Columns ['review_id'] not present in train DAG after the train test split, only before!
2022-09-21 15:31:41 WARNING This could hint at data leakage!
2022-09-21 15:31:41 INFO  Estimated unoptimised what-if runtime is 200534.4533920288ms
2022-09-21 15:31:41 INFO  ---RUNTIME: Multi-Query Optimization took 22.170305252075195 ms
2022-09-21 15:31:41 INFO  Executing generated plans
2022-09-21 15:35:06 INFO  ---RUNTIME: Execution took 204339.16330337524 ms
2022-09-21 15:35:06 INFO  Done!
2022-09-21 15:35:06 INFO  # Finished -- repetition 3 of 7 
2022-09-21 15:35:06 INFO  # Optimization benchmark for data_cleaning with args [['reviews', 'slow_loading', 'featurization_0', 'neural_network']] -- repetition 4 of 7
2022-09-21 15:35:06 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-21 15:35:06 INFO  Running instrumented original pipeline...
2022-09-21 15:35:06 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-21 15:35:06 INFO  ---RUNTIME: Importing and monkey-patching took 5.918979644775391 ms
2022-09-21 15:35:17 INFO  ---RUNTIME: Original pipeline execution took 10995.569944381714 ms (excluding imports and monkey-patching)
2022-09-21 15:35:17 INFO  Starting execution of 1 what-if analyses...
2022-09-21 15:35:17 INFO  Start plan generation for analysis DataCleaning...
2022-09-21 15:35:17 INFO  ---RUNTIME: Plan generation took 2.1724700927734375 ms
2022-09-21 15:35:17 INFO  Estimated runtime of original DAG is 9206.495523452759ms
2022-09-21 15:35:17 INFO  Performing Multi-Query Optimization
2022-09-21 15:35:17 INFO  Estimated unoptimized what-if runtime is 184129.91046905518ms
2022-09-21 15:35:17 INFO  Estimated optimised what-if runtime is 94161.02981567383ms
2022-09-21 15:35:17 INFO  Estimated optimisation runtime saving is 89968.88065338135ms
2022-09-21 15:35:17 INFO  ---RUNTIME: Multi-Query Optimization took 86.43579483032227 ms
2022-09-21 15:35:17 INFO  Executing generated plans
2022-09-21 15:36:54 INFO  ---RUNTIME: Execution took 97834.24663543701 ms
2022-09-21 15:36:54 INFO  Done!
2022-09-21 15:36:54 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-21 15:36:54 INFO  Running instrumented original pipeline...
2022-09-21 15:36:54 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-21 15:36:54 INFO  ---RUNTIME: Importing and monkey-patching took 6.044626235961914 ms
2022-09-21 15:37:05 INFO  ---RUNTIME: Original pipeline execution took 10443.792581558228 ms (excluding imports and monkey-patching)
2022-09-21 15:37:05 INFO  Starting execution of 1 what-if analyses...
2022-09-21 15:37:05 INFO  Start plan generation for analysis DataCleaning...
2022-09-21 15:37:05 INFO  ---RUNTIME: Plan generation took 2.404928207397461 ms
2022-09-21 15:37:05 INFO  Estimated runtime of original DAG is 8756.82020187378ms
2022-09-21 15:37:05 WARNING Skipping Multi-Query Optimization (instead, only applying patches)
2022-09-21 15:37:05 WARNING Columns ['review_id'] not present in train DAG after the train test split, only before!
2022-09-21 15:37:05 WARNING This could hint at data leakage!
2022-09-21 15:37:05 INFO  Estimated unoptimised what-if runtime is 175136.4040374756ms
2022-09-21 15:37:05 INFO  ---RUNTIME: Multi-Query Optimization took 23.706912994384766 ms
2022-09-21 15:37:05 INFO  Executing generated plans
2022-09-21 15:40:31 INFO  ---RUNTIME: Execution took 206086.05575561523 ms
2022-09-21 15:40:31 INFO  Done!
2022-09-21 15:40:31 INFO  # Finished -- repetition 4 of 7 
2022-09-21 15:40:31 INFO  # Optimization benchmark for data_cleaning with args [['reviews', 'slow_loading', 'featurization_0', 'neural_network']] -- repetition 5 of 7
2022-09-21 15:40:31 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-21 15:40:31 INFO  Running instrumented original pipeline...
2022-09-21 15:40:31 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-21 15:40:31 INFO  ---RUNTIME: Importing and monkey-patching took 5.828619003295898 ms
2022-09-21 15:40:42 INFO  ---RUNTIME: Original pipeline execution took 10780.315399169922 ms (excluding imports and monkey-patching)
2022-09-21 15:40:42 INFO  Starting execution of 1 what-if analyses...
2022-09-21 15:40:42 INFO  Start plan generation for analysis DataCleaning...
2022-09-21 15:40:42 INFO  ---RUNTIME: Plan generation took 0.6194114685058594 ms
2022-09-21 15:40:42 INFO  Estimated runtime of original DAG is 9118.899583816528ms
2022-09-21 15:40:42 INFO  Performing Multi-Query Optimization
2022-09-21 15:40:42 INFO  Estimated unoptimized what-if runtime is 182377.99167633057ms
2022-09-21 15:40:42 INFO  Estimated optimised what-if runtime is 94121.41704559326ms
2022-09-21 15:40:42 INFO  Estimated optimisation runtime saving is 88256.5746307373ms
2022-09-21 15:40:42 INFO  ---RUNTIME: Multi-Query Optimization took 87.55850791931152 ms
2022-09-21 15:40:42 INFO  Executing generated plans
2022-09-21 15:42:19 INFO  ---RUNTIME: Execution took 96929.48627471924 ms
2022-09-21 15:42:19 INFO  Done!
2022-09-21 15:42:19 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-21 15:42:19 INFO  Running instrumented original pipeline...
2022-09-21 15:42:19 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-21 15:42:19 INFO  ---RUNTIME: Importing and monkey-patching took 6.491661071777344 ms
2022-09-21 15:42:30 INFO  ---RUNTIME: Original pipeline execution took 10726.177453994751 ms (excluding imports and monkey-patching)
2022-09-21 15:42:30 INFO  Starting execution of 1 what-if analyses...
2022-09-21 15:42:30 INFO  Start plan generation for analysis DataCleaning...
2022-09-21 15:42:30 INFO  ---RUNTIME: Plan generation took 0.5476474761962891 ms
2022-09-21 15:42:30 INFO  Estimated runtime of original DAG is 9108.985424041748ms
2022-09-21 15:42:30 WARNING Skipping Multi-Query Optimization (instead, only applying patches)
2022-09-21 15:42:30 WARNING Columns ['review_id'] not present in train DAG after the train test split, only before!
2022-09-21 15:42:30 WARNING This could hint at data leakage!
2022-09-21 15:42:30 INFO  Estimated unoptimised what-if runtime is 182179.70848083496ms
2022-09-21 15:42:30 INFO  ---RUNTIME: Multi-Query Optimization took 22.498130798339844 ms
2022-09-21 15:42:30 INFO  Executing generated plans
2022-09-21 15:45:54 INFO  ---RUNTIME: Execution took 204459.61332321167 ms
2022-09-21 15:45:54 INFO  Done!
2022-09-21 15:45:54 INFO  # Finished -- repetition 5 of 7 
2022-09-21 15:45:54 INFO  # Optimization benchmark for data_cleaning with args [['reviews', 'slow_loading', 'featurization_0', 'neural_network']] -- repetition 6 of 7
2022-09-21 15:45:54 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-21 15:45:54 INFO  Running instrumented original pipeline...
2022-09-21 15:45:54 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-21 15:45:54 INFO  ---RUNTIME: Importing and monkey-patching took 6.142139434814453 ms
2022-09-21 15:46:05 INFO  ---RUNTIME: Original pipeline execution took 10646.92234992981 ms (excluding imports and monkey-patching)
2022-09-21 15:46:05 INFO  Starting execution of 1 what-if analyses...
2022-09-21 15:46:05 INFO  Start plan generation for analysis DataCleaning...
2022-09-21 15:46:05 INFO  ---RUNTIME: Plan generation took 0.5671977996826172 ms
2022-09-21 15:46:05 INFO  Estimated runtime of original DAG is 8878.38888168335ms
2022-09-21 15:46:05 INFO  Performing Multi-Query Optimization
2022-09-21 15:46:05 INFO  Estimated unoptimized what-if runtime is 177567.777633667ms
2022-09-21 15:46:05 INFO  Estimated optimised what-if runtime is 87594.38610076904ms
2022-09-21 15:46:05 INFO  Estimated optimisation runtime saving is 89973.39153289795ms
2022-09-21 15:46:05 INFO  ---RUNTIME: Multi-Query Optimization took 86.73644065856934 ms
2022-09-21 15:46:05 INFO  Executing generated plans
2022-09-21 15:47:41 INFO  ---RUNTIME: Execution took 96703.85766029358 ms
2022-09-21 15:47:42 INFO  Done!
2022-09-21 15:47:42 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-21 15:47:42 INFO  Running instrumented original pipeline...
2022-09-21 15:47:42 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-21 15:47:42 INFO  ---RUNTIME: Importing and monkey-patching took 5.722999572753906 ms
2022-09-21 15:47:52 INFO  ---RUNTIME: Original pipeline execution took 10377.396583557129 ms (excluding imports and monkey-patching)
2022-09-21 15:47:52 INFO  Starting execution of 1 what-if analyses...
2022-09-21 15:47:52 INFO  Start plan generation for analysis DataCleaning...
2022-09-21 15:47:52 INFO  ---RUNTIME: Plan generation took 0.4982948303222656 ms
2022-09-21 15:47:52 INFO  Estimated runtime of original DAG is 8680.773258209229ms
2022-09-21 15:47:52 WARNING Skipping Multi-Query Optimization (instead, only applying patches)
2022-09-21 15:47:52 WARNING Columns ['review_id'] not present in train DAG after the train test split, only before!
2022-09-21 15:47:52 WARNING This could hint at data leakage!
2022-09-21 15:47:52 INFO  Estimated unoptimised what-if runtime is 173615.46516418457ms
2022-09-21 15:47:52 INFO  ---RUNTIME: Multi-Query Optimization took 22.98879623413086 ms
2022-09-21 15:47:52 INFO  Executing generated plans
2022-09-21 15:51:17 INFO  ---RUNTIME: Execution took 204954.48684692383 ms
2022-09-21 15:51:17 INFO  Done!
2022-09-21 15:51:17 INFO  # Finished -- repetition 6 of 7 
2022-09-21 15:51:17 INFO  # Optimization benchmark for data_cleaning with args [['reviews', 'slow_loading', 'featurization_0', 'neural_network']] -- repetition 7 of 7
2022-09-21 15:51:17 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-21 15:51:17 INFO  Running instrumented original pipeline...
2022-09-21 15:51:17 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-21 15:51:17 INFO  ---RUNTIME: Importing and monkey-patching took 6.531476974487305 ms
2022-09-21 15:51:27 INFO  ---RUNTIME: Original pipeline execution took 10376.848697662354 ms (excluding imports and monkey-patching)
2022-09-21 15:51:27 INFO  Starting execution of 1 what-if analyses...
2022-09-21 15:51:27 INFO  Start plan generation for analysis DataCleaning...
2022-09-21 15:51:27 INFO  ---RUNTIME: Plan generation took 0.5621910095214844 ms
2022-09-21 15:51:27 INFO  Estimated runtime of original DAG is 8717.274188995361ms
2022-09-21 15:51:27 INFO  Performing Multi-Query Optimization
2022-09-21 15:51:27 INFO  Estimated unoptimized what-if runtime is 174345.48377990723ms
2022-09-21 15:51:27 INFO  Estimated optimised what-if runtime is 84776.40318870544ms
2022-09-21 15:51:27 INFO  Estimated optimisation runtime saving is 89569.08059120178ms
2022-09-21 15:51:27 INFO  ---RUNTIME: Multi-Query Optimization took 84.91373062133789 ms
2022-09-21 15:51:27 INFO  Executing generated plans
2022-09-21 15:53:04 INFO  ---RUNTIME: Execution took 96676.69248580933 ms
2022-09-21 15:53:04 INFO  Done!
2022-09-21 15:53:04 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-21 15:53:04 INFO  Running instrumented original pipeline...
2022-09-21 15:53:04 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-21 15:53:04 INFO  ---RUNTIME: Importing and monkey-patching took 6.10041618347168 ms
2022-09-21 15:53:15 INFO  ---RUNTIME: Original pipeline execution took 10551.4497756958 ms (excluding imports and monkey-patching)
2022-09-21 15:53:15 INFO  Starting execution of 1 what-if analyses...
2022-09-21 15:53:15 INFO  Start plan generation for analysis DataCleaning...
2022-09-21 15:53:15 INFO  ---RUNTIME: Plan generation took 0.5118846893310547 ms
2022-09-21 15:53:15 INFO  Estimated runtime of original DAG is 8951.146125793457ms
2022-09-21 15:53:15 WARNING Skipping Multi-Query Optimization (instead, only applying patches)
2022-09-21 15:53:15 WARNING Columns ['review_id'] not present in train DAG after the train test split, only before!
2022-09-21 15:53:15 WARNING This could hint at data leakage!
2022-09-21 15:53:15 INFO  Estimated unoptimised what-if runtime is 179022.92251586914ms
2022-09-21 15:53:15 INFO  ---RUNTIME: Multi-Query Optimization took 23.613691329956055 ms
2022-09-21 15:53:15 INFO  Executing generated plans
2022-09-21 15:56:38 INFO  ---RUNTIME: Execution took 203391.93677902222 ms
2022-09-21 15:56:38 INFO  Done!
2022-09-21 15:56:38 INFO  # Finished -- repetition 7 of 7 
2022-09-21 15:56:38 INFO  # Final results after all repetitions
2022-09-21 15:56:38 INFO     repetition  ... no_opt_what_if_execution_combined_model_training
0           0  ...                                     65814.718246
1           1  ...                                     66752.756357
2           2  ...                                     65941.326141
3           3  ...                                     66543.270826
4           4  ...                                     66786.257744
5           5  ...                                     66145.511627
6           6  ...                                     64980.719566

[7 rows x 26 columns]
taskset -c 160-167 PROTOCOL_BUFFERS_PYTHON_IMPLEMENTATION=python python3.9 benchmarks_end_to_end.py data_cleaning reviews slow_loading featurization_1 logistic_regression
2022-09-21 15:56:40.715022: W tensorflow/stream_executor/platform/default/dso_loader.cc:64] Could not load dynamic library 'libcudart.so.11.0'; dlerror: libcudart.so.11.0: cannot open shared object file: No such file or directory; LD_LIBRARY_PATH: /home/sgrafbe/mlwhatif/venv/lib/python3.9/site-packages/cv2/../../lib64:
2022-09-21 15:56:40.715067: I tensorflow/stream_executor/cuda/cudart_stub.cc:29] Ignore above cudart dlerror if you do not have a GPU set up on your machine.
2022-09-21 15:56:41 INFO  Patching sys.argv with ['mlwhatif', 'reviews', 'slow_loading', 'featurization_1', 'logistic_regression']
2022-09-21 15:56:41 INFO  Running instrumented original pipeline...
2022-09-21 15:56:41 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-21 15:56:42 INFO  ---RUNTIME: Importing and monkey-patching took 94.34103965759277 ms
2022-09-21 15:56:49 INFO  ---RUNTIME: Original pipeline execution took 7546.498775482178 ms (excluding imports and monkey-patching)
2022-09-21 15:56:49 INFO  Starting execution of 0 what-if analyses...
2022-09-21 15:56:49 INFO  Estimated runtime of original DAG is 5332.647800445557ms
2022-09-21 15:56:49 INFO  Performing Multi-Query Optimization
2022-09-21 15:56:49 INFO  Estimated unoptimized what-if runtime is 0ms
2022-09-21 15:56:49 INFO  Estimated optimised what-if runtime is 0ms
2022-09-21 15:56:49 INFO  Estimated optimisation runtime saving is 0ms
2022-09-21 15:56:49 INFO  ---RUNTIME: Multi-Query Optimization took 0.4813671112060547 ms
2022-09-21 15:56:49 INFO  Executing generated plans
2022-09-21 15:56:49 INFO  ---RUNTIME: Execution took 0.023365020751953125 ms
2022-09-21 15:56:49 INFO  Done!
2022-09-21 15:56:49 INFO  # Optimization benchmark for data_cleaning with args [['reviews', 'slow_loading', 'featurization_1', 'logistic_regression']] -- repetition 1 of 7
2022-09-21 15:56:49 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-21 15:56:49 INFO  Running instrumented original pipeline...
2022-09-21 15:56:49 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-21 15:56:49 INFO  ---RUNTIME: Importing and monkey-patching took 5.379199981689453 ms
2022-09-21 15:56:57 INFO  ---RUNTIME: Original pipeline execution took 7712.236404418945 ms (excluding imports and monkey-patching)
2022-09-21 15:56:57 INFO  Starting execution of 1 what-if analyses...
2022-09-21 15:56:57 INFO  Start plan generation for analysis DataCleaning...
2022-09-21 15:56:57 INFO  ---RUNTIME: Plan generation took 0.7154941558837891 ms
2022-09-21 15:56:57 INFO  Estimated runtime of original DAG is 5443.371534347534ms
2022-09-21 15:56:57 INFO  Performing Multi-Query Optimization
2022-09-21 15:56:57 INFO  Estimated unoptimized what-if runtime is 108867.43068695068ms
2022-09-21 15:56:57 INFO  Estimated optimised what-if runtime is 19896.94905281067ms
2022-09-21 15:56:57 INFO  Estimated optimisation runtime saving is 88970.48163414001ms
2022-09-21 15:56:57 INFO  ---RUNTIME: Multi-Query Optimization took 95.93319892883301 ms
2022-09-21 15:56:57 INFO  Executing generated plans
2022-09-21 15:57:23 INFO  ---RUNTIME: Execution took 26544.432401657104 ms
2022-09-21 15:57:23 INFO  Done!
2022-09-21 15:57:23 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-21 15:57:23 INFO  Running instrumented original pipeline...
2022-09-21 15:57:23 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-21 15:57:23 INFO  ---RUNTIME: Importing and monkey-patching took 6.804704666137695 ms
2022-09-21 15:57:31 INFO  ---RUNTIME: Original pipeline execution took 7460.371494293213 ms (excluding imports and monkey-patching)
2022-09-21 15:57:31 INFO  Starting execution of 1 what-if analyses...
2022-09-21 15:57:31 INFO  Start plan generation for analysis DataCleaning...
2022-09-21 15:57:31 INFO  ---RUNTIME: Plan generation took 0.6749629974365234 ms
2022-09-21 15:57:31 INFO  Estimated runtime of original DAG is 5285.804748535156ms
2022-09-21 15:57:31 WARNING Skipping Multi-Query Optimization (instead, only applying patches)
2022-09-21 15:57:31 WARNING Columns ['review_id'] not present in train DAG after the train test split, only before!
2022-09-21 15:57:31 WARNING This could hint at data leakage!
2022-09-21 15:57:31 INFO  Estimated unoptimised what-if runtime is 105716.09497070312ms
2022-09-21 15:57:31 INFO  ---RUNTIME: Multi-Query Optimization took 23.49233627319336 ms
2022-09-21 15:57:31 INFO  Executing generated plans
2022-09-21 15:59:43 INFO  ---RUNTIME: Execution took 132091.57872200012 ms
2022-09-21 15:59:43 INFO  Done!
2022-09-21 15:59:43 INFO  # Finished -- repetition 1 of 7 
2022-09-21 15:59:43 INFO  # Optimization benchmark for data_cleaning with args [['reviews', 'slow_loading', 'featurization_1', 'logistic_regression']] -- repetition 2 of 7
2022-09-21 15:59:43 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-21 15:59:43 INFO  Running instrumented original pipeline...
2022-09-21 15:59:43 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-21 15:59:43 INFO  ---RUNTIME: Importing and monkey-patching took 6.437540054321289 ms
2022-09-21 15:59:51 INFO  ---RUNTIME: Original pipeline execution took 7667.45138168335 ms (excluding imports and monkey-patching)
2022-09-21 15:59:51 INFO  Starting execution of 1 what-if analyses...
2022-09-21 15:59:51 INFO  Start plan generation for analysis DataCleaning...
2022-09-21 15:59:51 INFO  ---RUNTIME: Plan generation took 0.6482601165771484 ms
2022-09-21 15:59:51 INFO  Estimated runtime of original DAG is 5479.372501373291ms
2022-09-21 15:59:51 INFO  Performing Multi-Query Optimization
2022-09-21 15:59:51 INFO  Estimated unoptimized what-if runtime is 109587.45002746582ms
2022-09-21 15:59:51 INFO  Estimated optimised what-if runtime is 19265.285968780518ms
2022-09-21 15:59:51 INFO  Estimated optimisation runtime saving is 90322.1640586853ms
2022-09-21 15:59:51 INFO  ---RUNTIME: Multi-Query Optimization took 91.28451347351074 ms
2022-09-21 15:59:51 INFO  Executing generated plans
2022-09-21 16:00:17 INFO  ---RUNTIME: Execution took 26118.871688842773 ms
2022-09-21 16:00:17 INFO  Done!
2022-09-21 16:00:17 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-21 16:00:17 INFO  Running instrumented original pipeline...
2022-09-21 16:00:17 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-21 16:00:17 INFO  ---RUNTIME: Importing and monkey-patching took 6.620168685913086 ms
2022-09-21 16:00:24 INFO  ---RUNTIME: Original pipeline execution took 7506.5577030181885 ms (excluding imports and monkey-patching)
2022-09-21 16:00:24 INFO  Starting execution of 1 what-if analyses...
2022-09-21 16:00:24 INFO  Start plan generation for analysis DataCleaning...
2022-09-21 16:00:24 INFO  ---RUNTIME: Plan generation took 0.6296634674072266 ms
2022-09-21 16:00:24 INFO  Estimated runtime of original DAG is 5326.34973526001ms
2022-09-21 16:00:24 WARNING Skipping Multi-Query Optimization (instead, only applying patches)
2022-09-21 16:00:24 WARNING Columns ['review_id'] not present in train DAG after the train test split, only before!
2022-09-21 16:00:24 WARNING This could hint at data leakage!
2022-09-21 16:00:24 INFO  Estimated unoptimised what-if runtime is 106526.9947052002ms
2022-09-21 16:00:24 INFO  ---RUNTIME: Multi-Query Optimization took 23.601055145263672 ms
2022-09-21 16:00:24 INFO  Executing generated plans
2022-09-21 16:02:36 INFO  ---RUNTIME: Execution took 131812.19792366028 ms
2022-09-21 16:02:36 INFO  Done!
2022-09-21 16:02:36 INFO  # Finished -- repetition 2 of 7 
2022-09-21 16:02:36 INFO  # Optimization benchmark for data_cleaning with args [['reviews', 'slow_loading', 'featurization_1', 'logistic_regression']] -- repetition 3 of 7
2022-09-21 16:02:36 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-21 16:02:36 INFO  Running instrumented original pipeline...
2022-09-21 16:02:36 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-21 16:02:36 INFO  ---RUNTIME: Importing and monkey-patching took 6.259441375732422 ms
2022-09-21 16:02:44 INFO  ---RUNTIME: Original pipeline execution took 7614.8669719696045 ms (excluding imports and monkey-patching)
2022-09-21 16:02:44 INFO  Starting execution of 1 what-if analyses...
2022-09-21 16:02:44 INFO  Start plan generation for analysis DataCleaning...
2022-09-21 16:02:44 INFO  ---RUNTIME: Plan generation took 0.6670951843261719 ms
2022-09-21 16:02:44 INFO  Estimated runtime of original DAG is 5417.060375213623ms
2022-09-21 16:02:44 INFO  Performing Multi-Query Optimization
2022-09-21 16:02:44 INFO  Estimated unoptimized what-if runtime is 108341.20750427246ms
2022-09-21 16:02:44 INFO  Estimated optimised what-if runtime is 19357.882738113403ms
2022-09-21 16:02:44 INFO  Estimated optimisation runtime saving is 88983.32476615906ms
2022-09-21 16:02:44 INFO  ---RUNTIME: Multi-Query Optimization took 92.27442741394043 ms
2022-09-21 16:02:44 INFO  Executing generated plans
2022-09-21 16:03:10 INFO  ---RUNTIME: Execution took 25762.7534866333 ms
2022-09-21 16:03:10 INFO  Done!
2022-09-21 16:03:10 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-21 16:03:10 INFO  Running instrumented original pipeline...
2022-09-21 16:03:10 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-21 16:03:10 INFO  ---RUNTIME: Importing and monkey-patching took 5.851507186889648 ms
2022-09-21 16:03:17 INFO  ---RUNTIME: Original pipeline execution took 7745.949745178223 ms (excluding imports and monkey-patching)
2022-09-21 16:03:17 INFO  Starting execution of 1 what-if analyses...
2022-09-21 16:03:17 INFO  Start plan generation for analysis DataCleaning...
2022-09-21 16:03:17 INFO  ---RUNTIME: Plan generation took 0.6930828094482422 ms
2022-09-21 16:03:18 INFO  Estimated runtime of original DAG is 5309.848070144653ms
2022-09-21 16:03:18 WARNING Skipping Multi-Query Optimization (instead, only applying patches)
2022-09-21 16:03:18 WARNING Columns ['review_id'] not present in train DAG after the train test split, only before!
2022-09-21 16:03:18 WARNING This could hint at data leakage!
2022-09-21 16:03:18 INFO  Estimated unoptimised what-if runtime is 106196.96140289307ms
2022-09-21 16:03:18 INFO  ---RUNTIME: Multi-Query Optimization took 23.25749397277832 ms
2022-09-21 16:03:18 INFO  Executing generated plans
2022-09-21 16:05:30 INFO  ---RUNTIME: Execution took 132027.272939682 ms
2022-09-21 16:05:30 INFO  Done!
2022-09-21 16:05:30 INFO  # Finished -- repetition 3 of 7 
2022-09-21 16:05:30 INFO  # Optimization benchmark for data_cleaning with args [['reviews', 'slow_loading', 'featurization_1', 'logistic_regression']] -- repetition 4 of 7
2022-09-21 16:05:30 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-21 16:05:30 INFO  Running instrumented original pipeline...
2022-09-21 16:05:30 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-21 16:05:30 INFO  ---RUNTIME: Importing and monkey-patching took 16.915082931518555 ms
2022-09-21 16:05:37 INFO  ---RUNTIME: Original pipeline execution took 7717.532157897949 ms (excluding imports and monkey-patching)
2022-09-21 16:05:37 INFO  Starting execution of 1 what-if analyses...
2022-09-21 16:05:37 INFO  Start plan generation for analysis DataCleaning...
2022-09-21 16:05:37 INFO  ---RUNTIME: Plan generation took 0.67138671875 ms
2022-09-21 16:05:37 INFO  Estimated runtime of original DAG is 5464.059829711914ms
2022-09-21 16:05:37 INFO  Performing Multi-Query Optimization
2022-09-21 16:05:37 INFO  Estimated unoptimized what-if runtime is 109281.19659423828ms
2022-09-21 16:05:37 INFO  Estimated optimised what-if runtime is 19362.756729125977ms
2022-09-21 16:05:37 INFO  Estimated optimisation runtime saving is 89918.4398651123ms
2022-09-21 16:05:37 INFO  ---RUNTIME: Multi-Query Optimization took 90.77692031860352 ms
2022-09-21 16:05:37 INFO  Executing generated plans
2022-09-21 16:06:03 INFO  ---RUNTIME: Execution took 25756.081104278564 ms
2022-09-21 16:06:03 INFO  Done!
2022-09-21 16:06:03 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-21 16:06:03 INFO  Running instrumented original pipeline...
2022-09-21 16:06:03 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-21 16:06:03 INFO  ---RUNTIME: Importing and monkey-patching took 6.102323532104492 ms
2022-09-21 16:06:11 INFO  ---RUNTIME: Original pipeline execution took 7581.13956451416 ms (excluding imports and monkey-patching)
2022-09-21 16:06:11 INFO  Starting execution of 1 what-if analyses...
2022-09-21 16:06:11 INFO  Start plan generation for analysis DataCleaning...
2022-09-21 16:06:11 INFO  ---RUNTIME: Plan generation took 0.69427490234375 ms
2022-09-21 16:06:11 INFO  Estimated runtime of original DAG is 5372.900485992432ms
2022-09-21 16:06:11 WARNING Skipping Multi-Query Optimization (instead, only applying patches)
2022-09-21 16:06:11 WARNING Columns ['review_id'] not present in train DAG after the train test split, only before!
2022-09-21 16:06:11 WARNING This could hint at data leakage!
2022-09-21 16:06:11 INFO  Estimated unoptimised what-if runtime is 107458.00971984863ms
2022-09-21 16:06:11 INFO  ---RUNTIME: Multi-Query Optimization took 23.562908172607422 ms
2022-09-21 16:06:11 INFO  Executing generated plans
2022-09-21 16:08:22 INFO  ---RUNTIME: Execution took 131110.6300354004 ms
2022-09-21 16:08:22 INFO  Done!
2022-09-21 16:08:22 INFO  # Finished -- repetition 4 of 7 
2022-09-21 16:08:22 INFO  # Optimization benchmark for data_cleaning with args [['reviews', 'slow_loading', 'featurization_1', 'logistic_regression']] -- repetition 5 of 7
2022-09-21 16:08:22 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-21 16:08:22 INFO  Running instrumented original pipeline...
2022-09-21 16:08:22 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-21 16:08:22 INFO  ---RUNTIME: Importing and monkey-patching took 6.223917007446289 ms
2022-09-21 16:08:30 INFO  ---RUNTIME: Original pipeline execution took 7634.014129638672 ms (excluding imports and monkey-patching)
2022-09-21 16:08:30 INFO  Starting execution of 1 what-if analyses...
2022-09-21 16:08:30 INFO  Start plan generation for analysis DataCleaning...
2022-09-21 16:08:30 INFO  ---RUNTIME: Plan generation took 0.70953369140625 ms
2022-09-21 16:08:30 INFO  Estimated runtime of original DAG is 5400.837421417236ms
2022-09-21 16:08:30 INFO  Performing Multi-Query Optimization
2022-09-21 16:08:30 INFO  Estimated unoptimized what-if runtime is 108016.74842834473ms
2022-09-21 16:08:30 INFO  Estimated optimised what-if runtime is 19210.65855026245ms
2022-09-21 16:08:30 INFO  Estimated optimisation runtime saving is 88806.08987808228ms
2022-09-21 16:08:30 INFO  ---RUNTIME: Multi-Query Optimization took 91.0038948059082 ms
2022-09-21 16:08:30 INFO  Executing generated plans
2022-09-21 16:08:55 INFO  ---RUNTIME: Execution took 25553.45606803894 ms
2022-09-21 16:08:55 INFO  Done!
2022-09-21 16:08:55 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-21 16:08:55 INFO  Running instrumented original pipeline...
2022-09-21 16:08:55 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-21 16:08:55 INFO  ---RUNTIME: Importing and monkey-patching took 6.115436553955078 ms
2022-09-21 16:09:03 INFO  ---RUNTIME: Original pipeline execution took 7573.3983516693115 ms (excluding imports and monkey-patching)
2022-09-21 16:09:03 INFO  Starting execution of 1 what-if analyses...
2022-09-21 16:09:03 INFO  Start plan generation for analysis DataCleaning...
2022-09-21 16:09:03 INFO  ---RUNTIME: Plan generation took 0.6811618804931641 ms
2022-09-21 16:09:03 INFO  Estimated runtime of original DAG is 5364.007472991943ms
2022-09-21 16:09:03 WARNING Skipping Multi-Query Optimization (instead, only applying patches)
2022-09-21 16:09:03 WARNING Columns ['review_id'] not present in train DAG after the train test split, only before!
2022-09-21 16:09:03 WARNING This could hint at data leakage!
2022-09-21 16:09:03 INFO  Estimated unoptimised what-if runtime is 107280.14945983887ms
2022-09-21 16:09:03 INFO  ---RUNTIME: Multi-Query Optimization took 23.2241153717041 ms
2022-09-21 16:09:03 INFO  Executing generated plans
2022-09-21 16:11:15 INFO  ---RUNTIME: Execution took 131961.66038513184 ms
2022-09-21 16:11:15 INFO  Done!
2022-09-21 16:11:15 INFO  # Finished -- repetition 5 of 7 
2022-09-21 16:11:15 INFO  # Optimization benchmark for data_cleaning with args [['reviews', 'slow_loading', 'featurization_1', 'logistic_regression']] -- repetition 6 of 7
2022-09-21 16:11:15 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-21 16:11:15 INFO  Running instrumented original pipeline...
2022-09-21 16:11:15 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-21 16:11:15 INFO  ---RUNTIME: Importing and monkey-patching took 6.284952163696289 ms
2022-09-21 16:11:22 INFO  ---RUNTIME: Original pipeline execution took 7562.741994857788 ms (excluding imports and monkey-patching)
2022-09-21 16:11:22 INFO  Starting execution of 1 what-if analyses...
2022-09-21 16:11:22 INFO  Start plan generation for analysis DataCleaning...
2022-09-21 16:11:22 INFO  ---RUNTIME: Plan generation took 0.6961822509765625 ms
2022-09-21 16:11:22 INFO  Estimated runtime of original DAG is 5346.619367599487ms
2022-09-21 16:11:22 INFO  Performing Multi-Query Optimization
2022-09-21 16:11:23 INFO  Estimated unoptimized what-if runtime is 106932.38735198975ms
2022-09-21 16:11:23 INFO  Estimated optimised what-if runtime is 19079.550981521606ms
2022-09-21 16:11:23 INFO  Estimated optimisation runtime saving is 87852.83637046814ms
2022-09-21 16:11:23 INFO  ---RUNTIME: Multi-Query Optimization took 357.9704761505127 ms
2022-09-21 16:11:23 INFO  Executing generated plans
2022-09-21 16:11:48 INFO  ---RUNTIME: Execution took 25719.178676605225 ms
2022-09-21 16:11:48 INFO  Done!
2022-09-21 16:11:48 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-21 16:11:48 INFO  Running instrumented original pipeline...
2022-09-21 16:11:48 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-21 16:11:48 INFO  ---RUNTIME: Importing and monkey-patching took 6.084680557250977 ms
2022-09-21 16:11:56 INFO  ---RUNTIME: Original pipeline execution took 7644.447803497314 ms (excluding imports and monkey-patching)
2022-09-21 16:11:56 INFO  Starting execution of 1 what-if analyses...
2022-09-21 16:11:56 INFO  Start plan generation for analysis DataCleaning...
2022-09-21 16:11:56 INFO  ---RUNTIME: Plan generation took 0.6625652313232422 ms
2022-09-21 16:11:56 INFO  Estimated runtime of original DAG is 5421.703577041626ms
2022-09-21 16:11:56 WARNING Skipping Multi-Query Optimization (instead, only applying patches)
2022-09-21 16:11:56 WARNING Columns ['review_id'] not present in train DAG after the train test split, only before!
2022-09-21 16:11:56 WARNING This could hint at data leakage!
2022-09-21 16:11:56 INFO  Estimated unoptimised what-if runtime is 108434.07154083252ms
2022-09-21 16:11:56 INFO  ---RUNTIME: Multi-Query Optimization took 23.220062255859375 ms
2022-09-21 16:11:56 INFO  Executing generated plans
2022-09-21 16:14:08 INFO  ---RUNTIME: Execution took 131802.0405769348 ms
2022-09-21 16:14:08 INFO  Done!
2022-09-21 16:14:08 INFO  # Finished -- repetition 6 of 7 
2022-09-21 16:14:08 INFO  # Optimization benchmark for data_cleaning with args [['reviews', 'slow_loading', 'featurization_1', 'logistic_regression']] -- repetition 7 of 7
2022-09-21 16:14:08 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-21 16:14:08 INFO  Running instrumented original pipeline...
2022-09-21 16:14:08 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-21 16:14:08 INFO  ---RUNTIME: Importing and monkey-patching took 6.092309951782227 ms
2022-09-21 16:14:15 INFO  ---RUNTIME: Original pipeline execution took 7570.431232452393 ms (excluding imports and monkey-patching)
2022-09-21 16:14:15 INFO  Starting execution of 1 what-if analyses...
2022-09-21 16:14:15 INFO  Start plan generation for analysis DataCleaning...
2022-09-21 16:14:15 INFO  ---RUNTIME: Plan generation took 0.7228851318359375 ms
2022-09-21 16:14:15 INFO  Estimated runtime of original DAG is 5354.796648025513ms
2022-09-21 16:14:15 INFO  Performing Multi-Query Optimization
2022-09-21 16:14:16 INFO  Estimated unoptimized what-if runtime is 107095.93296051025ms
2022-09-21 16:14:16 INFO  Estimated optimised what-if runtime is 19094.37584877014ms
2022-09-21 16:14:16 INFO  Estimated optimisation runtime saving is 88001.55711174011ms
2022-09-21 16:14:16 INFO  ---RUNTIME: Multi-Query Optimization took 90.05212783813477 ms
2022-09-21 16:14:16 INFO  Executing generated plans
2022-09-21 16:14:41 INFO  ---RUNTIME: Execution took 25693.199157714844 ms
2022-09-21 16:14:41 INFO  Done!
2022-09-21 16:14:41 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-21 16:14:41 INFO  Running instrumented original pipeline...
2022-09-21 16:14:41 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-21 16:14:41 INFO  ---RUNTIME: Importing and monkey-patching took 5.83195686340332 ms
2022-09-21 16:14:49 INFO  ---RUNTIME: Original pipeline execution took 7567.9638385772705 ms (excluding imports and monkey-patching)
2022-09-21 16:14:49 INFO  Starting execution of 1 what-if analyses...
2022-09-21 16:14:49 INFO  Start plan generation for analysis DataCleaning...
2022-09-21 16:14:49 INFO  ---RUNTIME: Plan generation took 0.6153583526611328 ms
2022-09-21 16:14:49 INFO  Estimated runtime of original DAG is 5326.321125030518ms
2022-09-21 16:14:49 WARNING Skipping Multi-Query Optimization (instead, only applying patches)
2022-09-21 16:14:49 WARNING Columns ['review_id'] not present in train DAG after the train test split, only before!
2022-09-21 16:14:49 WARNING This could hint at data leakage!
2022-09-21 16:14:49 INFO  Estimated unoptimised what-if runtime is 106526.42250061035ms
2022-09-21 16:14:49 INFO  ---RUNTIME: Multi-Query Optimization took 23.337125778198242 ms
2022-09-21 16:14:49 INFO  Executing generated plans
2022-09-21 16:17:00 INFO  ---RUNTIME: Execution took 131043.85542869568 ms
2022-09-21 16:17:00 INFO  Done!
2022-09-21 16:17:00 INFO  # Finished -- repetition 7 of 7 
2022-09-21 16:17:00 INFO  # Final results after all repetitions
2022-09-21 16:17:00 INFO     repetition  ... no_opt_what_if_execution_combined_model_training
0           0  ...                                      2422.198296
1           1  ...                                      2429.587126
2           2  ...                                      2363.937616
3           3  ...                                      2342.792273
4           4  ...                                      2343.885183
5           5  ...                                      2376.369238
6           6  ...                                      2353.238821

[7 rows x 26 columns]
taskset -c 160-167 PROTOCOL_BUFFERS_PYTHON_IMPLEMENTATION=python python3.9 benchmarks_end_to_end.py data_cleaning reviews slow_loading featurization_1 xgboost
2022-09-21 16:17:02.478516: W tensorflow/stream_executor/platform/default/dso_loader.cc:64] Could not load dynamic library 'libcudart.so.11.0'; dlerror: libcudart.so.11.0: cannot open shared object file: No such file or directory; LD_LIBRARY_PATH: /home/sgrafbe/mlwhatif/venv/lib/python3.9/site-packages/cv2/../../lib64:
2022-09-21 16:17:02.478562: I tensorflow/stream_executor/cuda/cudart_stub.cc:29] Ignore above cudart dlerror if you do not have a GPU set up on your machine.
2022-09-21 16:17:03 INFO  Patching sys.argv with ['mlwhatif', 'reviews', 'slow_loading', 'featurization_1', 'xgboost']
2022-09-21 16:17:03 INFO  Running instrumented original pipeline...
2022-09-21 16:17:03 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-21 16:17:03 INFO  ---RUNTIME: Importing and monkey-patching took 95.01075744628906 ms
2022-09-21 16:17:12 INFO  ---RUNTIME: Original pipeline execution took 8459.252119064331 ms (excluding imports and monkey-patching)
2022-09-21 16:17:12 INFO  Starting execution of 0 what-if analyses...
2022-09-21 16:17:12 INFO  Estimated runtime of original DAG is 6226.835012435913ms
2022-09-21 16:17:12 INFO  Performing Multi-Query Optimization
2022-09-21 16:17:12 INFO  Estimated unoptimized what-if runtime is 0ms
2022-09-21 16:17:12 INFO  Estimated optimised what-if runtime is 0ms
2022-09-21 16:17:12 INFO  Estimated optimisation runtime saving is 0ms
2022-09-21 16:17:12 INFO  ---RUNTIME: Multi-Query Optimization took 0.4870891571044922 ms
2022-09-21 16:17:12 INFO  Executing generated plans
2022-09-21 16:17:12 INFO  ---RUNTIME: Execution took 0.023126602172851562 ms
2022-09-21 16:17:12 INFO  Done!
2022-09-21 16:17:12 INFO  # Optimization benchmark for data_cleaning with args [['reviews', 'slow_loading', 'featurization_1', 'xgboost']] -- repetition 1 of 7
2022-09-21 16:17:12 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-21 16:17:12 INFO  Running instrumented original pipeline...
2022-09-21 16:17:12 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-21 16:17:12 INFO  ---RUNTIME: Importing and monkey-patching took 6.044864654541016 ms
2022-09-21 16:17:20 INFO  ---RUNTIME: Original pipeline execution took 8271.705150604248 ms (excluding imports and monkey-patching)
2022-09-21 16:17:20 INFO  Starting execution of 1 what-if analyses...
2022-09-21 16:17:20 INFO  Start plan generation for analysis DataCleaning...
2022-09-21 16:17:20 INFO  ---RUNTIME: Plan generation took 0.7739067077636719 ms
2022-09-21 16:17:20 INFO  Estimated runtime of original DAG is 6079.78630065918ms
2022-09-21 16:17:20 INFO  Performing Multi-Query Optimization
2022-09-21 16:17:20 INFO  Estimated unoptimized what-if runtime is 121595.7260131836ms
2022-09-21 16:17:20 INFO  Estimated optimised what-if runtime is 34762.46500015259ms
2022-09-21 16:17:20 INFO  Estimated optimisation runtime saving is 86833.261013031ms
2022-09-21 16:17:20 INFO  ---RUNTIME: Multi-Query Optimization took 252.65097618103027 ms
2022-09-21 16:17:20 INFO  Executing generated plans
2022-09-21 16:18:03 INFO  ---RUNTIME: Execution took 42940.72198867798 ms
2022-09-21 16:18:03 INFO  Done!
2022-09-21 16:18:03 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-21 16:18:03 INFO  Running instrumented original pipeline...
2022-09-21 16:18:03 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-21 16:18:03 INFO  ---RUNTIME: Importing and monkey-patching took 6.186008453369141 ms
2022-09-21 16:18:11 INFO  ---RUNTIME: Original pipeline execution took 8254.127025604248 ms (excluding imports and monkey-patching)
2022-09-21 16:18:11 INFO  Starting execution of 1 what-if analyses...
2022-09-21 16:18:11 INFO  Start plan generation for analysis DataCleaning...
2022-09-21 16:18:11 INFO  ---RUNTIME: Plan generation took 0.7166862487792969 ms
2022-09-21 16:18:11 INFO  Estimated runtime of original DAG is 6090.058326721191ms
2022-09-21 16:18:11 WARNING Skipping Multi-Query Optimization (instead, only applying patches)
2022-09-21 16:18:12 WARNING Columns ['review_id'] not present in train DAG after the train test split, only before!
2022-09-21 16:18:12 WARNING This could hint at data leakage!
2022-09-21 16:18:12 INFO  Estimated unoptimised what-if runtime is 121801.16653442383ms
2022-09-21 16:18:12 INFO  ---RUNTIME: Multi-Query Optimization took 23.273229598999023 ms
2022-09-21 16:18:12 INFO  Executing generated plans
2022-09-21 16:20:40 INFO  ---RUNTIME: Execution took 148351.92847251892 ms
2022-09-21 16:20:40 INFO  Done!
2022-09-21 16:20:40 INFO  # Finished -- repetition 1 of 7 
2022-09-21 16:20:40 INFO  # Optimization benchmark for data_cleaning with args [['reviews', 'slow_loading', 'featurization_1', 'xgboost']] -- repetition 2 of 7
2022-09-21 16:20:40 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-21 16:20:40 INFO  Running instrumented original pipeline...
2022-09-21 16:20:40 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-21 16:20:40 INFO  ---RUNTIME: Importing and monkey-patching took 6.059169769287109 ms
2022-09-21 16:20:48 INFO  ---RUNTIME: Original pipeline execution took 8478.605270385742 ms (excluding imports and monkey-patching)
2022-09-21 16:20:48 INFO  Starting execution of 1 what-if analyses...
2022-09-21 16:20:48 INFO  Start plan generation for analysis DataCleaning...
2022-09-21 16:20:48 INFO  ---RUNTIME: Plan generation took 0.7030963897705078 ms
2022-09-21 16:20:48 INFO  Estimated runtime of original DAG is 6300.081253051758ms
2022-09-21 16:20:48 INFO  Performing Multi-Query Optimization
2022-09-21 16:20:48 INFO  Estimated unoptimized what-if runtime is 126001.62506103516ms
2022-09-21 16:20:48 INFO  Estimated optimised what-if runtime is 34969.97690200806ms
2022-09-21 16:20:48 INFO  Estimated optimisation runtime saving is 91031.6481590271ms
2022-09-21 16:20:48 INFO  ---RUNTIME: Multi-Query Optimization took 92.32282638549805 ms
2022-09-21 16:20:48 INFO  Executing generated plans
2022-09-21 16:21:32 INFO  ---RUNTIME: Execution took 43838.855504989624 ms
2022-09-21 16:21:32 INFO  Done!
2022-09-21 16:21:32 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-21 16:21:32 INFO  Running instrumented original pipeline...
2022-09-21 16:21:32 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-21 16:21:32 INFO  ---RUNTIME: Importing and monkey-patching took 6.112575531005859 ms
2022-09-21 16:21:41 INFO  ---RUNTIME: Original pipeline execution took 8312.474489212036 ms (excluding imports and monkey-patching)
2022-09-21 16:21:41 INFO  Starting execution of 1 what-if analyses...
2022-09-21 16:21:41 INFO  Start plan generation for analysis DataCleaning...
2022-09-21 16:21:41 INFO  ---RUNTIME: Plan generation took 0.7023811340332031 ms
2022-09-21 16:21:41 INFO  Estimated runtime of original DAG is 6136.119604110718ms
2022-09-21 16:21:41 WARNING Skipping Multi-Query Optimization (instead, only applying patches)
2022-09-21 16:21:41 WARNING Columns ['review_id'] not present in train DAG after the train test split, only before!
2022-09-21 16:21:41 WARNING This could hint at data leakage!
2022-09-21 16:21:41 INFO  Estimated unoptimised what-if runtime is 122722.39208221436ms
2022-09-21 16:21:41 INFO  ---RUNTIME: Multi-Query Optimization took 23.144245147705078 ms
2022-09-21 16:21:41 INFO  Executing generated plans
2022-09-21 16:24:10 INFO  ---RUNTIME: Execution took 149231.58073425293 ms
2022-09-21 16:24:10 INFO  Done!
2022-09-21 16:24:10 INFO  # Finished -- repetition 2 of 7 
2022-09-21 16:24:10 INFO  # Optimization benchmark for data_cleaning with args [['reviews', 'slow_loading', 'featurization_1', 'xgboost']] -- repetition 3 of 7
2022-09-21 16:24:10 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-21 16:24:10 INFO  Running instrumented original pipeline...
2022-09-21 16:24:10 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-21 16:24:10 INFO  ---RUNTIME: Importing and monkey-patching took 6.185770034790039 ms
2022-09-21 16:24:18 INFO  ---RUNTIME: Original pipeline execution took 8298.17533493042 ms (excluding imports and monkey-patching)
2022-09-21 16:24:18 INFO  Starting execution of 1 what-if analyses...
2022-09-21 16:24:18 INFO  Start plan generation for analysis DataCleaning...
2022-09-21 16:24:18 INFO  ---RUNTIME: Plan generation took 0.7264614105224609 ms
2022-09-21 16:24:18 INFO  Estimated runtime of original DAG is 6113.35015296936ms
2022-09-21 16:24:18 INFO  Performing Multi-Query Optimization
2022-09-21 16:24:18 INFO  Estimated unoptimized what-if runtime is 122267.0030593872ms
2022-09-21 16:24:18 INFO  Estimated optimised what-if runtime is 34820.053577423096ms
2022-09-21 16:24:18 INFO  Estimated optimisation runtime saving is 87446.94948196411ms
2022-09-21 16:24:18 INFO  ---RUNTIME: Multi-Query Optimization took 92.11611747741699 ms
2022-09-21 16:24:18 INFO  Executing generated plans
2022-09-21 16:25:02 INFO  ---RUNTIME: Execution took 43883.18753242493 ms
2022-09-21 16:25:02 INFO  Done!
2022-09-21 16:25:02 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-21 16:25:02 INFO  Running instrumented original pipeline...
2022-09-21 16:25:02 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-21 16:25:02 INFO  ---RUNTIME: Importing and monkey-patching took 5.838871002197266 ms
2022-09-21 16:25:11 INFO  ---RUNTIME: Original pipeline execution took 8610.287189483643 ms (excluding imports and monkey-patching)
2022-09-21 16:25:11 INFO  Starting execution of 1 what-if analyses...
2022-09-21 16:25:11 INFO  Start plan generation for analysis DataCleaning...
2022-09-21 16:25:11 INFO  ---RUNTIME: Plan generation took 0.6849765777587891 ms
2022-09-21 16:25:11 INFO  Estimated runtime of original DAG is 6168.557405471802ms
2022-09-21 16:25:11 WARNING Skipping Multi-Query Optimization (instead, only applying patches)
2022-09-21 16:25:11 WARNING Columns ['review_id'] not present in train DAG after the train test split, only before!
2022-09-21 16:25:11 WARNING This could hint at data leakage!
2022-09-21 16:25:11 INFO  Estimated unoptimised what-if runtime is 123371.14810943604ms
2022-09-21 16:25:11 INFO  ---RUNTIME: Multi-Query Optimization took 23.231983184814453 ms
2022-09-21 16:25:11 INFO  Executing generated plans
2022-09-21 16:27:43 INFO  ---RUNTIME: Execution took 152487.29872703552 ms
2022-09-21 16:27:43 INFO  Done!
2022-09-21 16:27:43 INFO  # Finished -- repetition 3 of 7 
2022-09-21 16:27:43 INFO  # Optimization benchmark for data_cleaning with args [['reviews', 'slow_loading', 'featurization_1', 'xgboost']] -- repetition 4 of 7
2022-09-21 16:27:43 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-21 16:27:43 INFO  Running instrumented original pipeline...
2022-09-21 16:27:43 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-21 16:27:43 INFO  ---RUNTIME: Importing and monkey-patching took 6.151914596557617 ms
2022-09-21 16:27:52 INFO  ---RUNTIME: Original pipeline execution took 8706.46619796753 ms (excluding imports and monkey-patching)
2022-09-21 16:27:52 INFO  Starting execution of 1 what-if analyses...
2022-09-21 16:27:52 INFO  Start plan generation for analysis DataCleaning...
2022-09-21 16:27:52 INFO  ---RUNTIME: Plan generation took 1.3704299926757812 ms
2022-09-21 16:27:52 INFO  Estimated runtime of original DAG is 6473.851919174194ms
2022-09-21 16:27:52 INFO  Performing Multi-Query Optimization
2022-09-21 16:27:52 INFO  Estimated unoptimized what-if runtime is 129477.03838348389ms
2022-09-21 16:27:52 INFO  Estimated optimised what-if runtime is 36217.663049697876ms
2022-09-21 16:27:52 INFO  Estimated optimisation runtime saving is 93259.37533378601ms
2022-09-21 16:27:52 INFO  ---RUNTIME: Multi-Query Optimization took 148.64873886108398 ms
2022-09-21 16:27:52 INFO  Executing generated plans
2022-09-21 16:28:37 INFO  ---RUNTIME: Execution took 44825.44946670532 ms
2022-09-21 16:28:37 INFO  Done!
2022-09-21 16:28:37 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-21 16:28:37 INFO  Running instrumented original pipeline...
2022-09-21 16:28:37 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-21 16:28:37 INFO  ---RUNTIME: Importing and monkey-patching took 5.736351013183594 ms
2022-09-21 16:28:46 INFO  ---RUNTIME: Original pipeline execution took 8649.583578109741 ms (excluding imports and monkey-patching)
2022-09-21 16:28:46 INFO  Starting execution of 1 what-if analyses...
2022-09-21 16:28:46 INFO  Start plan generation for analysis DataCleaning...
2022-09-21 16:28:46 INFO  ---RUNTIME: Plan generation took 0.6825923919677734 ms
2022-09-21 16:28:46 INFO  Estimated runtime of original DAG is 6105.172395706177ms
2022-09-21 16:28:46 WARNING Skipping Multi-Query Optimization (instead, only applying patches)
2022-09-21 16:28:46 WARNING Columns ['review_id'] not present in train DAG after the train test split, only before!
2022-09-21 16:28:46 WARNING This could hint at data leakage!
2022-09-21 16:28:46 INFO  Estimated unoptimised what-if runtime is 122103.44791412354ms
2022-09-21 16:28:46 INFO  ---RUNTIME: Multi-Query Optimization took 23.171186447143555 ms
2022-09-21 16:28:46 INFO  Executing generated plans
2022-09-21 16:31:18 INFO  ---RUNTIME: Execution took 152638.9331817627 ms
2022-09-21 16:31:18 INFO  Done!
2022-09-21 16:31:18 INFO  # Finished -- repetition 4 of 7 
2022-09-21 16:31:18 INFO  # Optimization benchmark for data_cleaning with args [['reviews', 'slow_loading', 'featurization_1', 'xgboost']] -- repetition 5 of 7
2022-09-21 16:31:18 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-21 16:31:18 INFO  Running instrumented original pipeline...
2022-09-21 16:31:18 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-21 16:31:18 INFO  ---RUNTIME: Importing and monkey-patching took 6.0977935791015625 ms
2022-09-21 16:31:27 INFO  ---RUNTIME: Original pipeline execution took 8681.90050125122 ms (excluding imports and monkey-patching)
2022-09-21 16:31:27 INFO  Starting execution of 1 what-if analyses...
2022-09-21 16:31:27 INFO  Start plan generation for analysis DataCleaning...
2022-09-21 16:31:27 INFO  ---RUNTIME: Plan generation took 1.016855239868164 ms
2022-09-21 16:31:27 INFO  Estimated runtime of original DAG is 6475.59666633606ms
2022-09-21 16:31:27 INFO  Performing Multi-Query Optimization
2022-09-21 16:31:27 INFO  Estimated unoptimized what-if runtime is 129511.93332672119ms
2022-09-21 16:31:27 INFO  Estimated optimised what-if runtime is 35579.450368881226ms
2022-09-21 16:31:27 INFO  Estimated optimisation runtime saving is 93932.48295783997ms
2022-09-21 16:31:27 INFO  ---RUNTIME: Multi-Query Optimization took 138.5495662689209 ms
2022-09-21 16:31:27 INFO  Executing generated plans
2022-09-21 16:32:12 INFO  ---RUNTIME: Execution took 44425.07839202881 ms
2022-09-21 16:32:12 INFO  Done!
2022-09-21 16:32:12 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-21 16:32:12 INFO  Running instrumented original pipeline...
2022-09-21 16:32:12 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-21 16:32:12 INFO  ---RUNTIME: Importing and monkey-patching took 6.145477294921875 ms
2022-09-21 16:32:20 INFO  ---RUNTIME: Original pipeline execution took 8555.47285079956 ms (excluding imports and monkey-patching)
2022-09-21 16:32:20 INFO  Starting execution of 1 what-if analyses...
2022-09-21 16:32:20 INFO  Start plan generation for analysis DataCleaning...
2022-09-21 16:32:20 INFO  ---RUNTIME: Plan generation took 0.8456707000732422 ms
2022-09-21 16:32:20 INFO  Estimated runtime of original DAG is 6352.195262908936ms
2022-09-21 16:32:20 WARNING Skipping Multi-Query Optimization (instead, only applying patches)
2022-09-21 16:32:20 WARNING Columns ['review_id'] not present in train DAG after the train test split, only before!
2022-09-21 16:32:20 WARNING This could hint at data leakage!
2022-09-21 16:32:20 INFO  Estimated unoptimised what-if runtime is 127043.90525817871ms
2022-09-21 16:32:20 INFO  ---RUNTIME: Multi-Query Optimization took 33.62774848937988 ms
2022-09-21 16:32:20 INFO  Executing generated plans
2022-09-21 16:34:54 INFO  ---RUNTIME: Execution took 154204.24342155457 ms
2022-09-21 16:34:54 INFO  Done!
2022-09-21 16:34:54 INFO  # Finished -- repetition 5 of 7 
2022-09-21 16:34:54 INFO  # Optimization benchmark for data_cleaning with args [['reviews', 'slow_loading', 'featurization_1', 'xgboost']] -- repetition 6 of 7
2022-09-21 16:34:54 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-21 16:34:54 INFO  Running instrumented original pipeline...
2022-09-21 16:34:55 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-21 16:34:55 INFO  ---RUNTIME: Importing and monkey-patching took 8.247852325439453 ms
2022-09-21 16:35:04 INFO  ---RUNTIME: Original pipeline execution took 9125.646829605103 ms (excluding imports and monkey-patching)
2022-09-21 16:35:04 INFO  Starting execution of 1 what-if analyses...
2022-09-21 16:35:04 INFO  Start plan generation for analysis DataCleaning...
2022-09-21 16:35:04 INFO  ---RUNTIME: Plan generation took 1.2025833129882812 ms
2022-09-21 16:35:04 INFO  Estimated runtime of original DAG is 6518.420934677124ms
2022-09-21 16:35:04 INFO  Performing Multi-Query Optimization
2022-09-21 16:35:04 INFO  Estimated unoptimized what-if runtime is 130368.41869354248ms
2022-09-21 16:35:04 INFO  Estimated optimised what-if runtime is 37295.09735107422ms
2022-09-21 16:35:04 INFO  Estimated optimisation runtime saving is 93073.32134246826ms
2022-09-21 16:35:04 INFO  ---RUNTIME: Multi-Query Optimization took 128.68380546569824 ms
2022-09-21 16:35:04 INFO  Executing generated plans
2022-09-21 16:35:49 INFO  ---RUNTIME: Execution took 45305.545806884766 ms
2022-09-21 16:35:49 INFO  Done!
2022-09-21 16:35:49 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-21 16:35:49 INFO  Running instrumented original pipeline...
2022-09-21 16:35:49 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-21 16:35:49 INFO  ---RUNTIME: Importing and monkey-patching took 6.081819534301758 ms
2022-09-21 16:35:58 INFO  ---RUNTIME: Original pipeline execution took 8902.56118774414 ms (excluding imports and monkey-patching)
2022-09-21 16:35:58 INFO  Starting execution of 1 what-if analyses...
2022-09-21 16:35:58 INFO  Start plan generation for analysis DataCleaning...
2022-09-21 16:35:58 INFO  ---RUNTIME: Plan generation took 1.0750293731689453 ms
2022-09-21 16:35:58 INFO  Estimated runtime of original DAG is 6644.790887832642ms
2022-09-21 16:35:58 WARNING Skipping Multi-Query Optimization (instead, only applying patches)
2022-09-21 16:35:58 WARNING Columns ['review_id'] not present in train DAG after the train test split, only before!
2022-09-21 16:35:58 WARNING This could hint at data leakage!
2022-09-21 16:35:58 INFO  Estimated unoptimised what-if runtime is 132895.81775665283ms
2022-09-21 16:35:58 INFO  ---RUNTIME: Multi-Query Optimization took 33.287763595581055 ms
2022-09-21 16:35:58 INFO  Executing generated plans
2022-09-21 16:38:33 INFO  ---RUNTIME: Execution took 154934.81731414795 ms
2022-09-21 16:38:33 INFO  Done!
2022-09-21 16:38:33 INFO  # Finished -- repetition 6 of 7 
2022-09-21 16:38:33 INFO  # Optimization benchmark for data_cleaning with args [['reviews', 'slow_loading', 'featurization_1', 'xgboost']] -- repetition 7 of 7
2022-09-21 16:38:33 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-21 16:38:33 INFO  Running instrumented original pipeline...
2022-09-21 16:38:33 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-21 16:38:33 INFO  ---RUNTIME: Importing and monkey-patching took 6.194114685058594 ms
2022-09-21 16:38:41 INFO  ---RUNTIME: Original pipeline execution took 8504.907369613647 ms (excluding imports and monkey-patching)
2022-09-21 16:38:41 INFO  Starting execution of 1 what-if analyses...
2022-09-21 16:38:41 INFO  Start plan generation for analysis DataCleaning...
2022-09-21 16:38:41 INFO  ---RUNTIME: Plan generation took 0.713348388671875 ms
2022-09-21 16:38:41 INFO  Estimated runtime of original DAG is 6270.789861679077ms
2022-09-21 16:38:41 INFO  Performing Multi-Query Optimization
2022-09-21 16:38:41 INFO  Estimated unoptimized what-if runtime is 125415.79723358154ms
2022-09-21 16:38:41 INFO  Estimated optimised what-if runtime is 35616.46890640259ms
2022-09-21 16:38:41 INFO  Estimated optimisation runtime saving is 89799.32832717896ms
2022-09-21 16:38:41 INFO  ---RUNTIME: Multi-Query Optimization took 90.95001220703125 ms
2022-09-21 16:38:41 INFO  Executing generated plans
2022-09-21 16:39:26 INFO  ---RUNTIME: Execution took 44636.128187179565 ms
2022-09-21 16:39:26 INFO  Done!
2022-09-21 16:39:26 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-21 16:39:26 INFO  Running instrumented original pipeline...
2022-09-21 16:39:26 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-21 16:39:26 INFO  ---RUNTIME: Importing and monkey-patching took 5.803823471069336 ms
2022-09-21 16:39:35 INFO  ---RUNTIME: Original pipeline execution took 8622.945547103882 ms (excluding imports and monkey-patching)
2022-09-21 16:39:35 INFO  Starting execution of 1 what-if analyses...
2022-09-21 16:39:35 INFO  Start plan generation for analysis DataCleaning...
2022-09-21 16:39:35 INFO  ---RUNTIME: Plan generation took 0.7128715515136719 ms
2022-09-21 16:39:35 INFO  Estimated runtime of original DAG is 6270.685434341431ms
2022-09-21 16:39:35 WARNING Skipping Multi-Query Optimization (instead, only applying patches)
2022-09-21 16:39:35 WARNING Columns ['review_id'] not present in train DAG after the train test split, only before!
2022-09-21 16:39:35 WARNING This could hint at data leakage!
2022-09-21 16:39:35 INFO  Estimated unoptimised what-if runtime is 125413.70868682861ms
2022-09-21 16:39:35 INFO  ---RUNTIME: Multi-Query Optimization took 22.710323333740234 ms
2022-09-21 16:39:35 INFO  Executing generated plans
2022-09-21 16:42:08 INFO  ---RUNTIME: Execution took 152865.1099205017 ms
2022-09-21 16:42:08 INFO  Done!
2022-09-21 16:42:08 INFO  # Finished -- repetition 7 of 7 
2022-09-21 16:42:08 INFO  # Final results after all repetitions
2022-09-21 16:42:08 INFO     repetition  ... no_opt_what_if_execution_combined_model_training
0           0  ...                                     19526.815414
1           1  ...                                     19526.034594
2           2  ...                                     19677.181959
3           3  ...                                     19062.652826
4           4  ...                                     20352.255106
5           5  ...                                     19844.112873
6           6  ...                                     19152.068377

[7 rows x 26 columns]
taskset -c 160-167 PROTOCOL_BUFFERS_PYTHON_IMPLEMENTATION=python python3.9 benchmarks_end_to_end.py data_cleaning reviews slow_loading featurization_1 neural_network
2022-09-21 16:42:10.153990: W tensorflow/stream_executor/platform/default/dso_loader.cc:64] Could not load dynamic library 'libcudart.so.11.0'; dlerror: libcudart.so.11.0: cannot open shared object file: No such file or directory; LD_LIBRARY_PATH: /home/sgrafbe/mlwhatif/venv/lib/python3.9/site-packages/cv2/../../lib64:
2022-09-21 16:42:10.154034: I tensorflow/stream_executor/cuda/cudart_stub.cc:29] Ignore above cudart dlerror if you do not have a GPU set up on your machine.
2022-09-21 16:42:11 INFO  Patching sys.argv with ['mlwhatif', 'reviews', 'slow_loading', 'featurization_1', 'neural_network']
2022-09-21 16:42:11 INFO  Running instrumented original pipeline...
2022-09-21 16:42:11 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-21 16:42:11 INFO  ---RUNTIME: Importing and monkey-patching took 134.51910018920898 ms
2022-09-21 16:42:17.976777: W tensorflow/stream_executor/platform/default/dso_loader.cc:64] Could not load dynamic library 'libcuda.so.1'; dlerror: libcuda.so.1: cannot open shared object file: No such file or directory; LD_LIBRARY_PATH: /home/sgrafbe/mlwhatif/venv/lib/python3.9/site-packages/cv2/../../lib64:
2022-09-21 16:42:17.976810: W tensorflow/stream_executor/cuda/cuda_driver.cc:326] failed call to cuInit: UNKNOWN ERROR (303)
2022-09-21 16:42:17.976833: I tensorflow/stream_executor/cuda/cuda_diagnostics.cc:156] kernel driver does not appear to be running on this host (wagyu): /proc/driver/nvidia/version does not exist
2022-09-21 16:42:17.977441: I tensorflow/core/platform/cpu_feature_guard.cc:142] This TensorFlow binary is optimized with oneAPI Deep Neural Network Library (oneDNN) to use the following CPU instructions in performance-critical operations:  AVX2 FMA
To enable them in other operations, rebuild TensorFlow with the appropriate compiler flags.
2022-09-21 16:42:18.050305: I tensorflow/compiler/mlir/mlir_graph_optimization_pass.cc:176] None of the MLIR Optimization Passes are enabled (registered 2)
2022-09-21 16:42:18.063369: I tensorflow/core/platform/profile_utils/cpu_utils.cc:114] CPU Frequency: 2595290000 Hz
2022-09-21 16:42:23 INFO  ---RUNTIME: Original pipeline execution took 11736.361980438232 ms (excluding imports and monkey-patching)
2022-09-21 16:42:23 INFO  Starting execution of 0 what-if analyses...
2022-09-21 16:42:23 INFO  Estimated runtime of original DAG is 9464.312314987183ms
2022-09-21 16:42:23 INFO  Performing Multi-Query Optimization
2022-09-21 16:42:23 INFO  Estimated unoptimized what-if runtime is 0ms
2022-09-21 16:42:23 INFO  Estimated optimised what-if runtime is 0ms
2022-09-21 16:42:23 INFO  Estimated optimisation runtime saving is 0ms
2022-09-21 16:42:23 INFO  ---RUNTIME: Multi-Query Optimization took 0.5617141723632812 ms
2022-09-21 16:42:23 INFO  Executing generated plans
2022-09-21 16:42:23 INFO  ---RUNTIME: Execution took 0.023365020751953125 ms
2022-09-21 16:42:23 INFO  Done!
2022-09-21 16:42:23 INFO  # Optimization benchmark for data_cleaning with args [['reviews', 'slow_loading', 'featurization_1', 'neural_network']] -- repetition 1 of 7
2022-09-21 16:42:23 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-21 16:42:23 INFO  Running instrumented original pipeline...
2022-09-21 16:42:23 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-21 16:42:23 INFO  ---RUNTIME: Importing and monkey-patching took 5.457162857055664 ms
2022-09-21 16:42:34 INFO  ---RUNTIME: Original pipeline execution took 11163.84482383728 ms (excluding imports and monkey-patching)
2022-09-21 16:42:34 INFO  Starting execution of 1 what-if analyses...
2022-09-21 16:42:34 INFO  Start plan generation for analysis DataCleaning...
2022-09-21 16:42:34 INFO  ---RUNTIME: Plan generation took 0.5948543548583984 ms
2022-09-21 16:42:34 INFO  Estimated runtime of original DAG is 8984.668493270874ms
2022-09-21 16:42:34 INFO  Performing Multi-Query Optimization
2022-09-21 16:42:34 INFO  Estimated unoptimized what-if runtime is 179693.36986541748ms
2022-09-21 16:42:34 INFO  Estimated optimised what-if runtime is 92201.2357711792ms
2022-09-21 16:42:34 INFO  Estimated optimisation runtime saving is 87492.13409423828ms
2022-09-21 16:42:34 INFO  ---RUNTIME: Multi-Query Optimization took 92.59796142578125 ms
2022-09-21 16:42:34 INFO  Executing generated plans
2022-09-21 16:44:12 INFO  ---RUNTIME: Execution took 97462.49890327454 ms
2022-09-21 16:44:12 INFO  Done!
2022-09-21 16:44:12 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-21 16:44:12 INFO  Running instrumented original pipeline...
2022-09-21 16:44:12 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-21 16:44:12 INFO  ---RUNTIME: Importing and monkey-patching took 6.365537643432617 ms
2022-09-21 16:44:23 INFO  ---RUNTIME: Original pipeline execution took 11241.177797317505 ms (excluding imports and monkey-patching)
2022-09-21 16:44:23 INFO  Starting execution of 1 what-if analyses...
2022-09-21 16:44:23 INFO  Start plan generation for analysis DataCleaning...
2022-09-21 16:44:23 INFO  ---RUNTIME: Plan generation took 0.6704330444335938 ms
2022-09-21 16:44:23 INFO  Estimated runtime of original DAG is 9079.405784606934ms
2022-09-21 16:44:23 WARNING Skipping Multi-Query Optimization (instead, only applying patches)
2022-09-21 16:44:23 WARNING Columns ['review_id'] not present in train DAG after the train test split, only before!
2022-09-21 16:44:23 WARNING This could hint at data leakage!
2022-09-21 16:44:23 INFO  Estimated unoptimised what-if runtime is 181588.11569213867ms
2022-09-21 16:44:23 INFO  ---RUNTIME: Multi-Query Optimization took 23.739099502563477 ms
2022-09-21 16:44:23 INFO  Executing generated plans
2022-09-21 16:47:48 INFO  ---RUNTIME: Execution took 204778.5632610321 ms
2022-09-21 16:47:48 INFO  Done!
2022-09-21 16:47:48 INFO  # Finished -- repetition 1 of 7 
2022-09-21 16:47:48 INFO  # Optimization benchmark for data_cleaning with args [['reviews', 'slow_loading', 'featurization_1', 'neural_network']] -- repetition 2 of 7
2022-09-21 16:47:48 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-21 16:47:48 INFO  Running instrumented original pipeline...
2022-09-21 16:47:48 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-21 16:47:48 INFO  ---RUNTIME: Importing and monkey-patching took 6.595611572265625 ms
2022-09-21 16:47:59 INFO  ---RUNTIME: Original pipeline execution took 11483.771800994873 ms (excluding imports and monkey-patching)
2022-09-21 16:47:59 INFO  Starting execution of 1 what-if analyses...
2022-09-21 16:47:59 INFO  Start plan generation for analysis DataCleaning...
2022-09-21 16:47:59 INFO  ---RUNTIME: Plan generation took 0.5574226379394531 ms
2022-09-21 16:47:59 INFO  Estimated runtime of original DAG is 9316.278457641602ms
2022-09-21 16:47:59 INFO  Performing Multi-Query Optimization
2022-09-21 16:47:59 INFO  Estimated unoptimized what-if runtime is 186325.56915283203ms
2022-09-21 16:47:59 INFO  Estimated optimised what-if runtime is 98581.42113685608ms
2022-09-21 16:47:59 INFO  Estimated optimisation runtime saving is 87744.14801597595ms
2022-09-21 16:47:59 INFO  ---RUNTIME: Multi-Query Optimization took 91.45522117614746 ms
2022-09-21 16:47:59 INFO  Executing generated plans
2022-09-21 16:49:37 INFO  ---RUNTIME: Execution took 97437.30592727661 ms
2022-09-21 16:49:37 INFO  Done!
2022-09-21 16:49:37 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-21 16:49:37 INFO  Running instrumented original pipeline...
2022-09-21 16:49:37 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-21 16:49:37 INFO  ---RUNTIME: Importing and monkey-patching took 6.754875183105469 ms
2022-09-21 16:49:48 INFO  ---RUNTIME: Original pipeline execution took 11544.02470588684 ms (excluding imports and monkey-patching)
2022-09-21 16:49:48 INFO  Starting execution of 1 what-if analyses...
2022-09-21 16:49:48 INFO  Start plan generation for analysis DataCleaning...
2022-09-21 16:49:48 INFO  ---RUNTIME: Plan generation took 0.5631446838378906 ms
2022-09-21 16:49:48 INFO  Estimated runtime of original DAG is 9298.871755599976ms
2022-09-21 16:49:48 WARNING Skipping Multi-Query Optimization (instead, only applying patches)
2022-09-21 16:49:48 WARNING Columns ['review_id'] not present in train DAG after the train test split, only before!
2022-09-21 16:49:48 WARNING This could hint at data leakage!
2022-09-21 16:49:48 INFO  Estimated unoptimised what-if runtime is 185977.4351119995ms
2022-09-21 16:49:48 INFO  ---RUNTIME: Multi-Query Optimization took 23.339271545410156 ms
2022-09-21 16:49:48 INFO  Executing generated plans
2022-09-21 16:53:15 INFO  ---RUNTIME: Execution took 206512.85934448242 ms
2022-09-21 16:53:15 INFO  Done!
2022-09-21 16:53:15 INFO  # Finished -- repetition 2 of 7 
2022-09-21 16:53:15 INFO  # Optimization benchmark for data_cleaning with args [['reviews', 'slow_loading', 'featurization_1', 'neural_network']] -- repetition 3 of 7
2022-09-21 16:53:15 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-21 16:53:15 INFO  Running instrumented original pipeline...
2022-09-21 16:53:15 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-21 16:53:15 INFO  ---RUNTIME: Importing and monkey-patching took 6.224870681762695 ms
2022-09-21 16:53:26 INFO  ---RUNTIME: Original pipeline execution took 11155.745267868042 ms (excluding imports and monkey-patching)
2022-09-21 16:53:26 INFO  Starting execution of 1 what-if analyses...
2022-09-21 16:53:26 INFO  Start plan generation for analysis DataCleaning...
2022-09-21 16:53:26 INFO  ---RUNTIME: Plan generation took 0.61798095703125 ms
2022-09-21 16:53:26 INFO  Estimated runtime of original DAG is 8685.118913650513ms
2022-09-21 16:53:26 INFO  Performing Multi-Query Optimization
2022-09-21 16:53:26 INFO  Estimated unoptimized what-if runtime is 173702.37827301025ms
2022-09-21 16:53:26 INFO  Estimated optimised what-if runtime is 86581.5851688385ms
2022-09-21 16:53:26 INFO  Estimated optimisation runtime saving is 87120.79310417175ms
2022-09-21 16:53:26 INFO  ---RUNTIME: Multi-Query Optimization took 91.64881706237793 ms
2022-09-21 16:53:26 INFO  Executing generated plans
2022-09-21 16:55:05 INFO  ---RUNTIME: Execution took 98515.78903198242 ms
2022-09-21 16:55:05 INFO  Done!
2022-09-21 16:55:05 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-21 16:55:05 INFO  Running instrumented original pipeline...
2022-09-21 16:55:05 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-21 16:55:05 INFO  ---RUNTIME: Importing and monkey-patching took 5.893945693969727 ms
2022-09-21 16:55:16 INFO  ---RUNTIME: Original pipeline execution took 11397.65191078186 ms (excluding imports and monkey-patching)
2022-09-21 16:55:16 INFO  Starting execution of 1 what-if analyses...
2022-09-21 16:55:16 INFO  Start plan generation for analysis DataCleaning...
2022-09-21 16:55:16 INFO  ---RUNTIME: Plan generation took 0.6206035614013672 ms
2022-09-21 16:55:16 INFO  Estimated runtime of original DAG is 9199.779987335205ms
2022-09-21 16:55:16 WARNING Skipping Multi-Query Optimization (instead, only applying patches)
2022-09-21 16:55:16 WARNING Columns ['review_id'] not present in train DAG after the train test split, only before!
2022-09-21 16:55:16 WARNING This could hint at data leakage!
2022-09-21 16:55:16 INFO  Estimated unoptimised what-if runtime is 183995.5997467041ms
2022-09-21 16:55:16 INFO  ---RUNTIME: Multi-Query Optimization took 26.91197395324707 ms
2022-09-21 16:55:16 INFO  Executing generated plans
2022-09-21 16:58:45 INFO  ---RUNTIME: Execution took 208606.4522266388 ms
2022-09-21 16:58:45 INFO  Done!
2022-09-21 16:58:45 INFO  # Finished -- repetition 3 of 7 
2022-09-21 16:58:45 INFO  # Optimization benchmark for data_cleaning with args [['reviews', 'slow_loading', 'featurization_1', 'neural_network']] -- repetition 4 of 7
2022-09-21 16:58:45 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-21 16:58:45 INFO  Running instrumented original pipeline...
2022-09-21 16:58:45 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-21 16:58:45 INFO  ---RUNTIME: Importing and monkey-patching took 6.355762481689453 ms
2022-09-21 16:58:56 INFO  ---RUNTIME: Original pipeline execution took 11577.718734741211 ms (excluding imports and monkey-patching)
2022-09-21 16:58:56 INFO  Starting execution of 1 what-if analyses...
2022-09-21 16:58:56 INFO  Start plan generation for analysis DataCleaning...
2022-09-21 16:58:56 INFO  ---RUNTIME: Plan generation took 0.6239414215087891 ms
2022-09-21 16:58:56 INFO  Estimated runtime of original DAG is 9320.945024490356ms
2022-09-21 16:58:56 INFO  Performing Multi-Query Optimization
2022-09-21 16:58:56 INFO  Estimated unoptimized what-if runtime is 186418.90048980713ms
2022-09-21 16:58:56 INFO  Estimated optimised what-if runtime is 95087.32295036316ms
2022-09-21 16:58:56 INFO  Estimated optimisation runtime saving is 91331.57753944397ms
2022-09-21 16:58:56 INFO  ---RUNTIME: Multi-Query Optimization took 94.23208236694336 ms
2022-09-21 16:58:56 INFO  Executing generated plans
2022-09-21 17:00:33 INFO  ---RUNTIME: Execution took 96679.20398712158 ms
2022-09-21 17:00:33 INFO  Done!
2022-09-21 17:00:33 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-21 17:00:33 INFO  Running instrumented original pipeline...
2022-09-21 17:00:33 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-21 17:00:33 INFO  ---RUNTIME: Importing and monkey-patching took 5.975484848022461 ms
2022-09-21 17:00:45 INFO  ---RUNTIME: Original pipeline execution took 12050.085544586182 ms (excluding imports and monkey-patching)
2022-09-21 17:00:45 INFO  Starting execution of 1 what-if analyses...
2022-09-21 17:00:45 INFO  Start plan generation for analysis DataCleaning...
2022-09-21 17:00:45 INFO  ---RUNTIME: Plan generation took 0.6248950958251953 ms
2022-09-21 17:00:45 INFO  Estimated runtime of original DAG is 9160.18795967102ms
2022-09-21 17:00:45 WARNING Skipping Multi-Query Optimization (instead, only applying patches)
2022-09-21 17:00:45 WARNING Columns ['review_id'] not present in train DAG after the train test split, only before!
2022-09-21 17:00:45 WARNING This could hint at data leakage!
2022-09-21 17:00:45 INFO  Estimated unoptimised what-if runtime is 183203.7591934204ms
2022-09-21 17:00:45 INFO  ---RUNTIME: Multi-Query Optimization took 24.239063262939453 ms
2022-09-21 17:00:45 INFO  Executing generated plans
2022-09-21 17:04:11 INFO  ---RUNTIME: Execution took 206145.83659172058 ms
2022-09-21 17:04:11 INFO  Done!
2022-09-21 17:04:11 INFO  # Finished -- repetition 4 of 7 
2022-09-21 17:04:11 INFO  # Optimization benchmark for data_cleaning with args [['reviews', 'slow_loading', 'featurization_1', 'neural_network']] -- repetition 5 of 7
2022-09-21 17:04:11 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-21 17:04:11 INFO  Running instrumented original pipeline...
2022-09-21 17:04:11 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-21 17:04:11 INFO  ---RUNTIME: Importing and monkey-patching took 6.854057312011719 ms
2022-09-21 17:04:23 INFO  ---RUNTIME: Original pipeline execution took 11722.259521484375 ms (excluding imports and monkey-patching)
2022-09-21 17:04:23 INFO  Starting execution of 1 what-if analyses...
2022-09-21 17:04:23 INFO  Start plan generation for analysis DataCleaning...
2022-09-21 17:04:23 INFO  ---RUNTIME: Plan generation took 0.6096363067626953 ms
2022-09-21 17:04:23 INFO  Estimated runtime of original DAG is 9123.303174972534ms
2022-09-21 17:04:23 INFO  Performing Multi-Query Optimization
2022-09-21 17:04:23 INFO  Estimated unoptimized what-if runtime is 182466.06349945068ms
2022-09-21 17:04:23 INFO  Estimated optimised what-if runtime is 92067.0657157898ms
2022-09-21 17:04:23 INFO  Estimated optimisation runtime saving is 90398.99778366089ms
2022-09-21 17:04:23 INFO  ---RUNTIME: Multi-Query Optimization took 98.48308563232422 ms
2022-09-21 17:04:23 INFO  Executing generated plans
2022-09-21 17:06:01 INFO  ---RUNTIME: Execution took 97638.64612579346 ms
2022-09-21 17:06:01 INFO  Done!
2022-09-21 17:06:01 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-21 17:06:01 INFO  Running instrumented original pipeline...
2022-09-21 17:06:01 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-21 17:06:01 INFO  ---RUNTIME: Importing and monkey-patching took 6.416559219360352 ms
2022-09-21 17:06:13 INFO  ---RUNTIME: Original pipeline execution took 12008.29005241394 ms (excluding imports and monkey-patching)
2022-09-21 17:06:13 INFO  Starting execution of 1 what-if analyses...
2022-09-21 17:06:13 INFO  Start plan generation for analysis DataCleaning...
2022-09-21 17:06:13 INFO  ---RUNTIME: Plan generation took 0.5681514739990234 ms
2022-09-21 17:06:13 INFO  Estimated runtime of original DAG is 9807.477235794067ms
2022-09-21 17:06:13 WARNING Skipping Multi-Query Optimization (instead, only applying patches)
2022-09-21 17:06:13 WARNING Columns ['review_id'] not present in train DAG after the train test split, only before!
2022-09-21 17:06:13 WARNING This could hint at data leakage!
2022-09-21 17:06:13 INFO  Estimated unoptimised what-if runtime is 196149.54471588135ms
2022-09-21 17:06:13 INFO  ---RUNTIME: Multi-Query Optimization took 23.65899085998535 ms
2022-09-21 17:06:13 INFO  Executing generated plans
2022-09-21 17:09:37 INFO  ---RUNTIME: Execution took 203922.80888557434 ms
2022-09-21 17:09:37 INFO  Done!
2022-09-21 17:09:37 INFO  # Finished -- repetition 5 of 7 
2022-09-21 17:09:37 INFO  # Optimization benchmark for data_cleaning with args [['reviews', 'slow_loading', 'featurization_1', 'neural_network']] -- repetition 6 of 7
2022-09-21 17:09:37 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-21 17:09:37 INFO  Running instrumented original pipeline...
2022-09-21 17:09:37 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-21 17:09:37 INFO  ---RUNTIME: Importing and monkey-patching took 5.888700485229492 ms
2022-09-21 17:09:48 INFO  ---RUNTIME: Original pipeline execution took 11315.330505371094 ms (excluding imports and monkey-patching)
2022-09-21 17:09:48 INFO  Starting execution of 1 what-if analyses...
2022-09-21 17:09:48 INFO  Start plan generation for analysis DataCleaning...
2022-09-21 17:09:48 INFO  ---RUNTIME: Plan generation took 0.606536865234375 ms
2022-09-21 17:09:48 INFO  Estimated runtime of original DAG is 8979.66480255127ms
2022-09-21 17:09:48 INFO  Performing Multi-Query Optimization
2022-09-21 17:09:48 INFO  Estimated unoptimized what-if runtime is 179593.2960510254ms
2022-09-21 17:09:48 INFO  Estimated optimised what-if runtime is 88317.18182563782ms
2022-09-21 17:09:48 INFO  Estimated optimisation runtime saving is 91276.11422538757ms
2022-09-21 17:09:48 INFO  ---RUNTIME: Multi-Query Optimization took 102.88214683532715 ms
2022-09-21 17:09:48 INFO  Executing generated plans
2022-09-21 17:11:24 INFO  ---RUNTIME: Execution took 96178.9870262146 ms
2022-09-21 17:11:24 INFO  Done!
2022-09-21 17:11:24 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-21 17:11:24 INFO  Running instrumented original pipeline...
2022-09-21 17:11:24 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-21 17:11:24 INFO  ---RUNTIME: Importing and monkey-patching took 6.172657012939453 ms
2022-09-21 17:11:36 INFO  ---RUNTIME: Original pipeline execution took 11200.061082839966 ms (excluding imports and monkey-patching)
2022-09-21 17:11:36 INFO  Starting execution of 1 what-if analyses...
2022-09-21 17:11:36 INFO  Start plan generation for analysis DataCleaning...
2022-09-21 17:11:36 INFO  ---RUNTIME: Plan generation took 0.5848407745361328 ms
2022-09-21 17:11:36 INFO  Estimated runtime of original DAG is 8919.658422470093ms
2022-09-21 17:11:36 WARNING Skipping Multi-Query Optimization (instead, only applying patches)
2022-09-21 17:11:36 WARNING Columns ['review_id'] not present in train DAG after the train test split, only before!
2022-09-21 17:11:36 WARNING This could hint at data leakage!
2022-09-21 17:11:36 INFO  Estimated unoptimised what-if runtime is 178393.16844940186ms
2022-09-21 17:11:36 INFO  ---RUNTIME: Multi-Query Optimization took 22.97377586364746 ms
2022-09-21 17:11:36 INFO  Executing generated plans
2022-09-21 17:15:03 INFO  ---RUNTIME: Execution took 207310.0028038025 ms
2022-09-21 17:15:03 INFO  Done!
2022-09-21 17:15:03 INFO  # Finished -- repetition 6 of 7 
2022-09-21 17:15:03 INFO  # Optimization benchmark for data_cleaning with args [['reviews', 'slow_loading', 'featurization_1', 'neural_network']] -- repetition 7 of 7
2022-09-21 17:15:03 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-21 17:15:03 INFO  Running instrumented original pipeline...
2022-09-21 17:15:03 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-21 17:15:03 INFO  ---RUNTIME: Importing and monkey-patching took 6.644248962402344 ms
2022-09-21 17:15:15 INFO  ---RUNTIME: Original pipeline execution took 12011.584281921387 ms (excluding imports and monkey-patching)
2022-09-21 17:15:15 INFO  Starting execution of 1 what-if analyses...
2022-09-21 17:15:15 INFO  Start plan generation for analysis DataCleaning...
2022-09-21 17:15:15 INFO  ---RUNTIME: Plan generation took 2.4335384368896484 ms
2022-09-21 17:15:15 INFO  Estimated runtime of original DAG is 9750.822305679321ms
2022-09-21 17:15:15 INFO  Performing Multi-Query Optimization
2022-09-21 17:15:15 INFO  Estimated unoptimized what-if runtime is 195016.44611358643ms
2022-09-21 17:15:15 INFO  Estimated optimised what-if runtime is 97515.00606536865ms
2022-09-21 17:15:15 INFO  Estimated optimisation runtime saving is 97501.44004821777ms
2022-09-21 17:15:15 INFO  ---RUNTIME: Multi-Query Optimization took 91.31431579589844 ms
2022-09-21 17:15:15 INFO  Executing generated plans
2022-09-21 17:16:51 INFO  ---RUNTIME: Execution took 96483.28733444214 ms
2022-09-21 17:16:51 INFO  Done!
2022-09-21 17:16:51 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-21 17:16:51 INFO  Running instrumented original pipeline...
2022-09-21 17:16:52 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-21 17:16:52 INFO  ---RUNTIME: Importing and monkey-patching took 6.858110427856445 ms
2022-09-21 17:17:03 INFO  ---RUNTIME: Original pipeline execution took 11058.197975158691 ms (excluding imports and monkey-patching)
2022-09-21 17:17:03 INFO  Starting execution of 1 what-if analyses...
2022-09-21 17:17:03 INFO  Start plan generation for analysis DataCleaning...
2022-09-21 17:17:03 INFO  ---RUNTIME: Plan generation took 0.6575584411621094 ms
2022-09-21 17:17:03 INFO  Estimated runtime of original DAG is 8783.114433288574ms
2022-09-21 17:17:03 WARNING Skipping Multi-Query Optimization (instead, only applying patches)
2022-09-21 17:17:03 WARNING Columns ['review_id'] not present in train DAG after the train test split, only before!
2022-09-21 17:17:03 WARNING This could hint at data leakage!
2022-09-21 17:17:03 INFO  Estimated unoptimised what-if runtime is 175662.28866577148ms
2022-09-21 17:17:03 INFO  ---RUNTIME: Multi-Query Optimization took 25.179624557495117 ms
2022-09-21 17:17:03 INFO  Executing generated plans
2022-09-21 17:20:26 INFO  ---RUNTIME: Execution took 203839.35070037842 ms
2022-09-21 17:20:26 INFO  Done!
2022-09-21 17:20:26 INFO  # Finished -- repetition 7 of 7 
2022-09-21 17:20:26 INFO  # Final results after all repetitions
2022-09-21 17:20:26 INFO     repetition  ... no_opt_what_if_execution_combined_model_training
0           0  ...                                     66067.202806
1           1  ...                                     66072.028399
2           2  ...                                     70453.083754
3           3  ...                                     66980.322599
4           4  ...                                     64491.933346
5           5  ...                                     68078.641891
6           6  ...                                     63914.193869

[7 rows x 26 columns]
taskset -c 160-167 PROTOCOL_BUFFERS_PYTHON_IMPLEMENTATION=python python3.9 benchmarks_end_to_end.py data_cleaning reviews slow_loading featurization_2 logistic_regression
2022-09-21 17:20:29.301957: W tensorflow/stream_executor/platform/default/dso_loader.cc:64] Could not load dynamic library 'libcudart.so.11.0'; dlerror: libcudart.so.11.0: cannot open shared object file: No such file or directory; LD_LIBRARY_PATH: /home/sgrafbe/mlwhatif/venv/lib/python3.9/site-packages/cv2/../../lib64:
2022-09-21 17:20:29.301997: I tensorflow/stream_executor/cuda/cudart_stub.cc:29] Ignore above cudart dlerror if you do not have a GPU set up on your machine.
2022-09-21 17:20:30 INFO  Patching sys.argv with ['mlwhatif', 'reviews', 'slow_loading', 'featurization_2', 'logistic_regression']
2022-09-21 17:20:30 INFO  Running instrumented original pipeline...
2022-09-21 17:20:30 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-21 17:20:30 INFO  ---RUNTIME: Importing and monkey-patching took 105.16238212585449 ms
2022-09-21 17:20:38 INFO  ---RUNTIME: Original pipeline execution took 7297.729969024658 ms (excluding imports and monkey-patching)
2022-09-21 17:20:38 INFO  Starting execution of 0 what-if analyses...
2022-09-21 17:20:38 INFO  Estimated runtime of original DAG is 6084.052085876465ms
2022-09-21 17:20:38 INFO  Performing Multi-Query Optimization
2022-09-21 17:20:38 INFO  Estimated unoptimized what-if runtime is 0ms
2022-09-21 17:20:38 INFO  Estimated optimised what-if runtime is 0ms
2022-09-21 17:20:38 INFO  Estimated optimisation runtime saving is 0ms
2022-09-21 17:20:38 INFO  ---RUNTIME: Multi-Query Optimization took 0.6263256072998047 ms
2022-09-21 17:20:38 INFO  Executing generated plans
2022-09-21 17:20:38 INFO  ---RUNTIME: Execution took 0.025272369384765625 ms
2022-09-21 17:20:38 INFO  Done!
2022-09-21 17:20:38 INFO  # Optimization benchmark for data_cleaning with args [['reviews', 'slow_loading', 'featurization_2', 'logistic_regression']] -- repetition 1 of 7
2022-09-21 17:20:38 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-21 17:20:38 INFO  Running instrumented original pipeline...
2022-09-21 17:20:38 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-21 17:20:38 INFO  ---RUNTIME: Importing and monkey-patching took 5.469322204589844 ms
2022-09-21 17:20:45 INFO  ---RUNTIME: Original pipeline execution took 7302.538871765137 ms (excluding imports and monkey-patching)
2022-09-21 17:20:45 INFO  Starting execution of 1 what-if analyses...
2022-09-21 17:20:45 INFO  Start plan generation for analysis DataCleaning...
2022-09-21 17:20:45 INFO  ---RUNTIME: Plan generation took 0.7071495056152344 ms
2022-09-21 17:20:45 INFO  Estimated runtime of original DAG is 6112.65230178833ms
2022-09-21 17:20:45 INFO  Performing Multi-Query Optimization
2022-09-21 17:20:45 INFO  Estimated unoptimized what-if runtime is 122253.0460357666ms
2022-09-21 17:20:45 INFO  Estimated optimised what-if runtime is 24756.007432937622ms
2022-09-21 17:20:45 INFO  Estimated optimisation runtime saving is 97497.03860282898ms
2022-09-21 17:20:45 INFO  ---RUNTIME: Multi-Query Optimization took 106.87041282653809 ms
2022-09-21 17:20:45 INFO  Executing generated plans
2022-09-21 17:21:16 INFO  ---RUNTIME: Execution took 31178.656101226807 ms
2022-09-21 17:21:16 INFO  Done!
2022-09-21 17:21:16 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-21 17:21:16 INFO  Running instrumented original pipeline...
2022-09-21 17:21:16 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-21 17:21:16 INFO  ---RUNTIME: Importing and monkey-patching took 6.185770034790039 ms
2022-09-21 17:21:23 INFO  ---RUNTIME: Original pipeline execution took 7225.834608078003 ms (excluding imports and monkey-patching)
2022-09-21 17:21:23 INFO  Starting execution of 1 what-if analyses...
2022-09-21 17:21:23 INFO  Start plan generation for analysis DataCleaning...
2022-09-21 17:21:23 INFO  ---RUNTIME: Plan generation took 0.8091926574707031 ms
2022-09-21 17:21:23 INFO  Estimated runtime of original DAG is 6001.651048660278ms
2022-09-21 17:21:23 WARNING Skipping Multi-Query Optimization (instead, only applying patches)
2022-09-21 17:21:23 WARNING Columns ['review_id'] not present in train DAG after the train test split, only before!
2022-09-21 17:21:23 WARNING This could hint at data leakage!
2022-09-21 17:21:23 INFO  Estimated unoptimised what-if runtime is 120033.02097320557ms
2022-09-21 17:21:23 INFO  ---RUNTIME: Multi-Query Optimization took 27.804851531982422 ms
2022-09-21 17:21:23 INFO  Executing generated plans
2022-09-21 17:23:51 INFO  ---RUNTIME: Execution took 147475.1262664795 ms
2022-09-21 17:23:51 INFO  Done!
2022-09-21 17:23:51 INFO  # Finished -- repetition 1 of 7 
2022-09-21 17:23:51 INFO  # Optimization benchmark for data_cleaning with args [['reviews', 'slow_loading', 'featurization_2', 'logistic_regression']] -- repetition 2 of 7
2022-09-21 17:23:51 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-21 17:23:51 INFO  Running instrumented original pipeline...
2022-09-21 17:23:51 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-21 17:23:51 INFO  ---RUNTIME: Importing and monkey-patching took 6.231546401977539 ms
2022-09-21 17:23:58 INFO  ---RUNTIME: Original pipeline execution took 7338.970899581909 ms (excluding imports and monkey-patching)
2022-09-21 17:23:58 INFO  Starting execution of 1 what-if analyses...
2022-09-21 17:23:58 INFO  Start plan generation for analysis DataCleaning...
2022-09-21 17:23:58 INFO  ---RUNTIME: Plan generation took 0.6458759307861328 ms
2022-09-21 17:23:58 INFO  Estimated runtime of original DAG is 6063.55357170105ms
2022-09-21 17:23:58 INFO  Performing Multi-Query Optimization
2022-09-21 17:23:58 INFO  Estimated unoptimized what-if runtime is 121271.071434021ms
2022-09-21 17:23:58 INFO  Estimated optimised what-if runtime is 23378.270387649536ms
2022-09-21 17:23:58 INFO  Estimated optimisation runtime saving is 97892.80104637146ms
2022-09-21 17:23:58 INFO  ---RUNTIME: Multi-Query Optimization took 97.93615341186523 ms
2022-09-21 17:23:58 INFO  Executing generated plans
2022-09-21 17:24:29 INFO  ---RUNTIME: Execution took 30926.905155181885 ms
2022-09-21 17:24:29 INFO  Done!
2022-09-21 17:24:29 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-21 17:24:29 INFO  Running instrumented original pipeline...
2022-09-21 17:24:29 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-21 17:24:29 INFO  ---RUNTIME: Importing and monkey-patching took 5.997180938720703 ms
2022-09-21 17:24:37 INFO  ---RUNTIME: Original pipeline execution took 7528.5680294036865 ms (excluding imports and monkey-patching)
2022-09-21 17:24:37 INFO  Starting execution of 1 what-if analyses...
2022-09-21 17:24:37 INFO  Start plan generation for analysis DataCleaning...
2022-09-21 17:24:37 INFO  ---RUNTIME: Plan generation took 0.6468296051025391 ms
2022-09-21 17:24:37 INFO  Estimated runtime of original DAG is 6297.114133834839ms
2022-09-21 17:24:37 WARNING Skipping Multi-Query Optimization (instead, only applying patches)
2022-09-21 17:24:37 WARNING Columns ['review_id'] not present in train DAG after the train test split, only before!
2022-09-21 17:24:37 WARNING This could hint at data leakage!
2022-09-21 17:24:37 INFO  Estimated unoptimised what-if runtime is 125942.28267669678ms
2022-09-21 17:24:37 INFO  ---RUNTIME: Multi-Query Optimization took 24.410486221313477 ms
2022-09-21 17:24:37 INFO  Executing generated plans
2022-09-21 17:27:05 INFO  ---RUNTIME: Execution took 147680.53579330444 ms
2022-09-21 17:27:05 INFO  Done!
2022-09-21 17:27:05 INFO  # Finished -- repetition 2 of 7 
2022-09-21 17:27:05 INFO  # Optimization benchmark for data_cleaning with args [['reviews', 'slow_loading', 'featurization_2', 'logistic_regression']] -- repetition 3 of 7
2022-09-21 17:27:05 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-21 17:27:05 INFO  Running instrumented original pipeline...
2022-09-21 17:27:05 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-21 17:27:05 INFO  ---RUNTIME: Importing and monkey-patching took 6.276607513427734 ms
2022-09-21 17:27:12 INFO  ---RUNTIME: Original pipeline execution took 7417.9346561431885 ms (excluding imports and monkey-patching)
2022-09-21 17:27:12 INFO  Starting execution of 1 what-if analyses...
2022-09-21 17:27:12 INFO  Start plan generation for analysis DataCleaning...
2022-09-21 17:27:12 INFO  ---RUNTIME: Plan generation took 0.67901611328125 ms
2022-09-21 17:27:12 INFO  Estimated runtime of original DAG is 6164.133310317993ms
2022-09-21 17:27:12 INFO  Performing Multi-Query Optimization
2022-09-21 17:27:12 INFO  Estimated unoptimized what-if runtime is 123282.66620635986ms
2022-09-21 17:27:12 INFO  Estimated optimised what-if runtime is 23940.917015075684ms
2022-09-21 17:27:12 INFO  Estimated optimisation runtime saving is 99341.74919128418ms
2022-09-21 17:27:12 INFO  ---RUNTIME: Multi-Query Optimization took 319.71287727355957 ms
2022-09-21 17:27:12 INFO  Executing generated plans
2022-09-21 17:27:44 INFO  ---RUNTIME: Execution took 31338.029861450195 ms
2022-09-21 17:27:44 INFO  Done!
2022-09-21 17:27:44 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-21 17:27:44 INFO  Running instrumented original pipeline...
2022-09-21 17:27:44 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-21 17:27:44 INFO  ---RUNTIME: Importing and monkey-patching took 5.866527557373047 ms
2022-09-21 17:27:51 INFO  ---RUNTIME: Original pipeline execution took 7445.963382720947 ms (excluding imports and monkey-patching)
2022-09-21 17:27:51 INFO  Starting execution of 1 what-if analyses...
2022-09-21 17:27:51 INFO  Start plan generation for analysis DataCleaning...
2022-09-21 17:27:51 INFO  ---RUNTIME: Plan generation took 0.9257793426513672 ms
2022-09-21 17:27:51 INFO  Estimated runtime of original DAG is 6215.05331993103ms
2022-09-21 17:27:51 WARNING Skipping Multi-Query Optimization (instead, only applying patches)
2022-09-21 17:27:51 WARNING Columns ['review_id'] not present in train DAG after the train test split, only before!
2022-09-21 17:27:51 WARNING This could hint at data leakage!
2022-09-21 17:27:51 INFO  Estimated unoptimised what-if runtime is 124301.0663986206ms
2022-09-21 17:27:51 INFO  ---RUNTIME: Multi-Query Optimization took 26.484966278076172 ms
2022-09-21 17:27:51 INFO  Executing generated plans
2022-09-21 17:30:20 INFO  ---RUNTIME: Execution took 149198.17519187927 ms
2022-09-21 17:30:20 INFO  Done!
2022-09-21 17:30:20 INFO  # Finished -- repetition 3 of 7 
2022-09-21 17:30:20 INFO  # Optimization benchmark for data_cleaning with args [['reviews', 'slow_loading', 'featurization_2', 'logistic_regression']] -- repetition 4 of 7
2022-09-21 17:30:20 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-21 17:30:20 INFO  Running instrumented original pipeline...
2022-09-21 17:30:20 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-21 17:30:20 INFO  ---RUNTIME: Importing and monkey-patching took 7.070064544677734 ms
2022-09-21 17:30:28 INFO  ---RUNTIME: Original pipeline execution took 7750.050783157349 ms (excluding imports and monkey-patching)
2022-09-21 17:30:28 INFO  Starting execution of 1 what-if analyses...
2022-09-21 17:30:28 INFO  Start plan generation for analysis DataCleaning...
2022-09-21 17:30:28 INFO  ---RUNTIME: Plan generation took 0.6382465362548828 ms
2022-09-21 17:30:28 INFO  Estimated runtime of original DAG is 6484.399795532227ms
2022-09-21 17:30:28 INFO  Performing Multi-Query Optimization
2022-09-21 17:30:28 INFO  Estimated unoptimized what-if runtime is 129687.99591064453ms
2022-09-21 17:30:28 INFO  Estimated optimised what-if runtime is 24070.699453353882ms
2022-09-21 17:30:28 INFO  Estimated optimisation runtime saving is 105617.29645729065ms
2022-09-21 17:30:28 INFO  ---RUNTIME: Multi-Query Optimization took 103.50441932678223 ms
2022-09-21 17:30:28 INFO  Executing generated plans
2022-09-21 17:30:59 INFO  ---RUNTIME: Execution took 31176.34129524231 ms
2022-09-21 17:30:59 INFO  Done!
2022-09-21 17:30:59 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-21 17:30:59 INFO  Running instrumented original pipeline...
2022-09-21 17:30:59 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-21 17:30:59 INFO  ---RUNTIME: Importing and monkey-patching took 6.215810775756836 ms
2022-09-21 17:31:07 INFO  ---RUNTIME: Original pipeline execution took 7478.138446807861 ms (excluding imports and monkey-patching)
2022-09-21 17:31:07 INFO  Starting execution of 1 what-if analyses...
2022-09-21 17:31:07 INFO  Start plan generation for analysis DataCleaning...
2022-09-21 17:31:07 INFO  ---RUNTIME: Plan generation took 0.7381439208984375 ms
2022-09-21 17:31:07 INFO  Estimated runtime of original DAG is 6188.790559768677ms
2022-09-21 17:31:07 WARNING Skipping Multi-Query Optimization (instead, only applying patches)
2022-09-21 17:31:07 WARNING Columns ['review_id'] not present in train DAG after the train test split, only before!
2022-09-21 17:31:07 WARNING This could hint at data leakage!
2022-09-21 17:31:07 INFO  Estimated unoptimised what-if runtime is 123775.81119537354ms
2022-09-21 17:31:07 INFO  ---RUNTIME: Multi-Query Optimization took 25.098323822021484 ms
2022-09-21 17:31:07 INFO  Executing generated plans
2022-09-21 17:33:33 INFO  ---RUNTIME: Execution took 146196.63190841675 ms
2022-09-21 17:33:33 INFO  Done!
2022-09-21 17:33:33 INFO  # Finished -- repetition 4 of 7 
2022-09-21 17:33:33 INFO  # Optimization benchmark for data_cleaning with args [['reviews', 'slow_loading', 'featurization_2', 'logistic_regression']] -- repetition 5 of 7
2022-09-21 17:33:33 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-21 17:33:33 INFO  Running instrumented original pipeline...
2022-09-21 17:33:33 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-21 17:33:33 INFO  ---RUNTIME: Importing and monkey-patching took 6.132364273071289 ms
2022-09-21 17:33:40 INFO  ---RUNTIME: Original pipeline execution took 7158.642768859863 ms (excluding imports and monkey-patching)
2022-09-21 17:33:40 INFO  Starting execution of 1 what-if analyses...
2022-09-21 17:33:40 INFO  Start plan generation for analysis DataCleaning...
2022-09-21 17:33:40 INFO  ---RUNTIME: Plan generation took 0.6566047668457031 ms
2022-09-21 17:33:40 INFO  Estimated runtime of original DAG is 5933.587551116943ms
2022-09-21 17:33:40 INFO  Performing Multi-Query Optimization
2022-09-21 17:33:40 INFO  Estimated unoptimized what-if runtime is 118671.75102233887ms
2022-09-21 17:33:40 INFO  Estimated optimised what-if runtime is 23038.837909698486ms
2022-09-21 17:33:40 INFO  Estimated optimisation runtime saving is 95632.91311264038ms
2022-09-21 17:33:40 INFO  ---RUNTIME: Multi-Query Optimization took 97.88823127746582 ms
2022-09-21 17:33:40 INFO  Executing generated plans
2022-09-21 17:34:11 INFO  ---RUNTIME: Execution took 30723.763465881348 ms
2022-09-21 17:34:11 INFO  Done!
2022-09-21 17:34:11 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-21 17:34:11 INFO  Running instrumented original pipeline...
2022-09-21 17:34:11 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-21 17:34:11 INFO  ---RUNTIME: Importing and monkey-patching took 5.73420524597168 ms
2022-09-21 17:34:18 INFO  ---RUNTIME: Original pipeline execution took 7176.454305648804 ms (excluding imports and monkey-patching)
2022-09-21 17:34:18 INFO  Starting execution of 1 what-if analyses...
2022-09-21 17:34:18 INFO  Start plan generation for analysis DataCleaning...
2022-09-21 17:34:18 INFO  ---RUNTIME: Plan generation took 0.6849765777587891 ms
2022-09-21 17:34:18 INFO  Estimated runtime of original DAG is 5969.336748123169ms
2022-09-21 17:34:18 WARNING Skipping Multi-Query Optimization (instead, only applying patches)
2022-09-21 17:34:18 WARNING Columns ['review_id'] not present in train DAG after the train test split, only before!
2022-09-21 17:34:18 WARNING This could hint at data leakage!
2022-09-21 17:34:18 INFO  Estimated unoptimised what-if runtime is 119386.73496246338ms
2022-09-21 17:34:18 INFO  ---RUNTIME: Multi-Query Optimization took 24.447202682495117 ms
2022-09-21 17:34:18 INFO  Executing generated plans
2022-09-21 17:36:43 INFO  ---RUNTIME: Execution took 144894.7949409485 ms
2022-09-21 17:36:43 INFO  Done!
2022-09-21 17:36:43 INFO  # Finished -- repetition 5 of 7 
2022-09-21 17:36:43 INFO  # Optimization benchmark for data_cleaning with args [['reviews', 'slow_loading', 'featurization_2', 'logistic_regression']] -- repetition 6 of 7
2022-09-21 17:36:43 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-21 17:36:43 INFO  Running instrumented original pipeline...
2022-09-21 17:36:43 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-21 17:36:43 INFO  ---RUNTIME: Importing and monkey-patching took 6.156444549560547 ms
2022-09-21 17:36:50 INFO  ---RUNTIME: Original pipeline execution took 7192.6116943359375 ms (excluding imports and monkey-patching)
2022-09-21 17:36:50 INFO  Starting execution of 1 what-if analyses...
2022-09-21 17:36:50 INFO  Start plan generation for analysis DataCleaning...
2022-09-21 17:36:50 INFO  ---RUNTIME: Plan generation took 0.6668567657470703 ms
2022-09-21 17:36:50 INFO  Estimated runtime of original DAG is 5988.987445831299ms
2022-09-21 17:36:50 INFO  Performing Multi-Query Optimization
2022-09-21 17:36:51 INFO  Estimated unoptimized what-if runtime is 119779.74891662598ms
2022-09-21 17:36:51 INFO  Estimated optimised what-if runtime is 23162.855863571167ms
2022-09-21 17:36:51 INFO  Estimated optimisation runtime saving is 96616.89305305481ms
2022-09-21 17:36:51 INFO  ---RUNTIME: Multi-Query Optimization took 100.22377967834473 ms
2022-09-21 17:36:51 INFO  Executing generated plans
2022-09-21 17:37:21 INFO  ---RUNTIME: Execution took 30771.17943763733 ms
2022-09-21 17:37:21 INFO  Done!
2022-09-21 17:37:21 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-21 17:37:21 INFO  Running instrumented original pipeline...
2022-09-21 17:37:21 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-21 17:37:21 INFO  ---RUNTIME: Importing and monkey-patching took 6.079673767089844 ms
2022-09-21 17:37:29 INFO  ---RUNTIME: Original pipeline execution took 7218.417167663574 ms (excluding imports and monkey-patching)
2022-09-21 17:37:29 INFO  Starting execution of 1 what-if analyses...
2022-09-21 17:37:29 INFO  Start plan generation for analysis DataCleaning...
2022-09-21 17:37:29 INFO  ---RUNTIME: Plan generation took 0.6456375122070312 ms
2022-09-21 17:37:29 INFO  Estimated runtime of original DAG is 6012.470006942749ms
2022-09-21 17:37:29 WARNING Skipping Multi-Query Optimization (instead, only applying patches)
2022-09-21 17:37:29 WARNING Columns ['review_id'] not present in train DAG after the train test split, only before!
2022-09-21 17:37:29 WARNING This could hint at data leakage!
2022-09-21 17:37:29 INFO  Estimated unoptimised what-if runtime is 120249.40013885498ms
2022-09-21 17:37:29 INFO  ---RUNTIME: Multi-Query Optimization took 24.70684051513672 ms
2022-09-21 17:37:29 INFO  Executing generated plans
2022-09-21 17:39:51 INFO  ---RUNTIME: Execution took 142750.32138824463 ms
2022-09-21 17:39:51 INFO  Done!
2022-09-21 17:39:51 INFO  # Finished -- repetition 6 of 7 
2022-09-21 17:39:51 INFO  # Optimization benchmark for data_cleaning with args [['reviews', 'slow_loading', 'featurization_2', 'logistic_regression']] -- repetition 7 of 7
2022-09-21 17:39:51 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-21 17:39:51 INFO  Running instrumented original pipeline...
2022-09-21 17:39:51 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-21 17:39:51 INFO  ---RUNTIME: Importing and monkey-patching took 5.879878997802734 ms
2022-09-21 17:39:58 INFO  ---RUNTIME: Original pipeline execution took 7128.806591033936 ms (excluding imports and monkey-patching)
2022-09-21 17:39:58 INFO  Starting execution of 1 what-if analyses...
2022-09-21 17:39:58 INFO  Start plan generation for analysis DataCleaning...
2022-09-21 17:39:58 INFO  ---RUNTIME: Plan generation took 0.6616115570068359 ms
2022-09-21 17:39:58 INFO  Estimated runtime of original DAG is 5919.31939125061ms
2022-09-21 17:39:58 INFO  Performing Multi-Query Optimization
2022-09-21 17:39:59 INFO  Estimated unoptimized what-if runtime is 118386.3878250122ms
2022-09-21 17:39:59 INFO  Estimated optimised what-if runtime is 23099.43723678589ms
2022-09-21 17:39:59 INFO  Estimated optimisation runtime saving is 95286.95058822632ms
2022-09-21 17:39:59 INFO  ---RUNTIME: Multi-Query Optimization took 97.84817695617676 ms
2022-09-21 17:39:59 INFO  Executing generated plans
2022-09-21 17:40:29 INFO  ---RUNTIME: Execution took 30298.73824119568 ms
2022-09-21 17:40:29 INFO  Done!
2022-09-21 17:40:29 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-21 17:40:29 INFO  Running instrumented original pipeline...
2022-09-21 17:40:29 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-21 17:40:29 INFO  ---RUNTIME: Importing and monkey-patching took 5.916833877563477 ms
2022-09-21 17:40:36 INFO  ---RUNTIME: Original pipeline execution took 7049.605846405029 ms (excluding imports and monkey-patching)
2022-09-21 17:40:36 INFO  Starting execution of 1 what-if analyses...
2022-09-21 17:40:36 INFO  Start plan generation for analysis DataCleaning...
2022-09-21 17:40:36 INFO  ---RUNTIME: Plan generation took 0.751495361328125 ms
2022-09-21 17:40:36 INFO  Estimated runtime of original DAG is 5863.161563873291ms
2022-09-21 17:40:36 WARNING Skipping Multi-Query Optimization (instead, only applying patches)
2022-09-21 17:40:36 WARNING Columns ['review_id'] not present in train DAG after the train test split, only before!
2022-09-21 17:40:36 WARNING This could hint at data leakage!
2022-09-21 17:40:36 INFO  Estimated unoptimised what-if runtime is 117263.23127746582ms
2022-09-21 17:40:36 INFO  ---RUNTIME: Multi-Query Optimization took 24.288415908813477 ms
2022-09-21 17:40:36 INFO  Executing generated plans
2022-09-21 17:43:01 INFO  ---RUNTIME: Execution took 144656.65221214294 ms
2022-09-21 17:43:01 INFO  Done!
2022-09-21 17:43:01 INFO  # Finished -- repetition 7 of 7 
2022-09-21 17:43:01 INFO  # Final results after all repetitions
2022-09-21 17:43:01 INFO     repetition  ... no_opt_what_if_execution_combined_model_training
0           0  ...                                      2379.060745
1           1  ...                                      2265.572309
2           2  ...                                      2316.916704
3           3  ...                                      2140.147686
4           4  ...                                      2117.425442
5           5  ...                                      2080.656528
6           6  ...                                      2122.940779

[7 rows x 26 columns]
taskset -c 160-167 PROTOCOL_BUFFERS_PYTHON_IMPLEMENTATION=python python3.9 benchmarks_end_to_end.py data_cleaning reviews slow_loading featurization_2 xgboost
2022-09-21 17:43:03.185525: W tensorflow/stream_executor/platform/default/dso_loader.cc:64] Could not load dynamic library 'libcudart.so.11.0'; dlerror: libcudart.so.11.0: cannot open shared object file: No such file or directory; LD_LIBRARY_PATH: /home/sgrafbe/mlwhatif/venv/lib/python3.9/site-packages/cv2/../../lib64:
2022-09-21 17:43:03.185569: I tensorflow/stream_executor/cuda/cudart_stub.cc:29] Ignore above cudart dlerror if you do not have a GPU set up on your machine.
2022-09-21 17:43:04 INFO  Patching sys.argv with ['mlwhatif', 'reviews', 'slow_loading', 'featurization_2', 'xgboost']
2022-09-21 17:43:04 INFO  Running instrumented original pipeline...
2022-09-21 17:43:04 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-21 17:43:04 INFO  ---RUNTIME: Importing and monkey-patching took 95.40867805480957 ms
2022-09-21 17:43:24 INFO  ---RUNTIME: Original pipeline execution took 19923.844814300537 ms (excluding imports and monkey-patching)
2022-09-21 17:43:24 INFO  Starting execution of 0 what-if analyses...
2022-09-21 17:43:24 INFO  Estimated runtime of original DAG is 18686.33985519409ms
2022-09-21 17:43:24 INFO  Performing Multi-Query Optimization
2022-09-21 17:43:24 INFO  Estimated unoptimized what-if runtime is 0ms
2022-09-21 17:43:24 INFO  Estimated optimised what-if runtime is 0ms
2022-09-21 17:43:24 INFO  Estimated optimisation runtime saving is 0ms
2022-09-21 17:43:24 INFO  ---RUNTIME: Multi-Query Optimization took 0.5402565002441406 ms
2022-09-21 17:43:24 INFO  Executing generated plans
2022-09-21 17:43:24 INFO  ---RUNTIME: Execution took 0.024080276489257812 ms
2022-09-21 17:43:24 INFO  Done!
2022-09-21 17:43:24 INFO  # Optimization benchmark for data_cleaning with args [['reviews', 'slow_loading', 'featurization_2', 'xgboost']] -- repetition 1 of 7
2022-09-21 17:43:24 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-21 17:43:24 INFO  Running instrumented original pipeline...
2022-09-21 17:43:24 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-21 17:43:24 INFO  ---RUNTIME: Importing and monkey-patching took 5.519866943359375 ms
2022-09-21 17:43:44 INFO  ---RUNTIME: Original pipeline execution took 19775.09641647339 ms (excluding imports and monkey-patching)
2022-09-21 17:43:44 INFO  Starting execution of 1 what-if analyses...
2022-09-21 17:43:44 INFO  Start plan generation for analysis DataCleaning...
2022-09-21 17:43:44 INFO  ---RUNTIME: Plan generation took 0.6983280181884766 ms
2022-09-21 17:43:44 INFO  Estimated runtime of original DAG is 18588.9413356781ms
2022-09-21 17:43:44 INFO  Performing Multi-Query Optimization
2022-09-21 17:43:44 INFO  Estimated unoptimized what-if runtime is 371778.826713562ms
2022-09-21 17:43:44 INFO  Estimated optimised what-if runtime is 275769.49524879456ms
2022-09-21 17:43:44 INFO  Estimated optimisation runtime saving is 96009.33146476746ms
2022-09-21 17:43:44 INFO  ---RUNTIME: Multi-Query Optimization took 100.48913955688477 ms
2022-09-21 17:43:44 INFO  Executing generated plans
2022-09-21 17:48:43 INFO  ---RUNTIME: Execution took 299136.6786956787 ms
2022-09-21 17:48:43 INFO  Done!
2022-09-21 17:48:43 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-21 17:48:43 INFO  Running instrumented original pipeline...
2022-09-21 17:48:43 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-21 17:48:43 INFO  ---RUNTIME: Importing and monkey-patching took 6.440162658691406 ms
2022-09-21 17:49:03 INFO  ---RUNTIME: Original pipeline execution took 19818.798542022705 ms (excluding imports and monkey-patching)
2022-09-21 17:49:03 INFO  Starting execution of 1 what-if analyses...
2022-09-21 17:49:03 INFO  Start plan generation for analysis DataCleaning...
2022-09-21 17:49:03 INFO  ---RUNTIME: Plan generation took 0.6389617919921875 ms
2022-09-21 17:49:03 INFO  Estimated runtime of original DAG is 18623.387575149536ms
2022-09-21 17:49:03 WARNING Skipping Multi-Query Optimization (instead, only applying patches)
2022-09-21 17:49:03 WARNING Columns ['review_id'] not present in train DAG after the train test split, only before!
2022-09-21 17:49:03 WARNING This could hint at data leakage!
2022-09-21 17:49:03 INFO  Estimated unoptimised what-if runtime is 372467.7515029907ms
2022-09-21 17:49:03 INFO  ---RUNTIME: Multi-Query Optimization took 24.4600772857666 ms
2022-09-21 17:49:03 INFO  Executing generated plans
2022-09-21 17:55:55 INFO  ---RUNTIME: Execution took 412661.0007286072 ms
2022-09-21 17:55:55 INFO  Done!
2022-09-21 17:55:55 INFO  # Finished -- repetition 1 of 7 
2022-09-21 17:55:55 INFO  # Optimization benchmark for data_cleaning with args [['reviews', 'slow_loading', 'featurization_2', 'xgboost']] -- repetition 2 of 7
2022-09-21 17:55:55 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-21 17:55:55 INFO  Running instrumented original pipeline...
2022-09-21 17:55:56 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-21 17:55:56 INFO  ---RUNTIME: Importing and monkey-patching took 5.976676940917969 ms
2022-09-21 17:56:15 INFO  ---RUNTIME: Original pipeline execution took 19784.738063812256 ms (excluding imports and monkey-patching)
2022-09-21 17:56:15 INFO  Starting execution of 1 what-if analyses...
2022-09-21 17:56:15 INFO  Start plan generation for analysis DataCleaning...
2022-09-21 17:56:15 INFO  ---RUNTIME: Plan generation took 0.6558895111083984 ms
2022-09-21 17:56:15 INFO  Estimated runtime of original DAG is 18577.112913131714ms
2022-09-21 17:56:15 INFO  Performing Multi-Query Optimization
2022-09-21 17:56:15 INFO  Estimated unoptimized what-if runtime is 371542.2582626343ms
2022-09-21 17:56:15 INFO  Estimated optimised what-if runtime is 276145.6723213196ms
2022-09-21 17:56:15 INFO  Estimated optimisation runtime saving is 95396.5859413147ms
2022-09-21 17:56:15 INFO  ---RUNTIME: Multi-Query Optimization took 98.65736961364746 ms
2022-09-21 17:56:15 INFO  Executing generated plans
2022-09-21 18:01:14 INFO  ---RUNTIME: Execution took 298606.1534881592 ms
2022-09-21 18:01:14 INFO  Done!
2022-09-21 18:01:14 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-21 18:01:14 INFO  Running instrumented original pipeline...
2022-09-21 18:01:14 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-21 18:01:14 INFO  ---RUNTIME: Importing and monkey-patching took 6.155967712402344 ms
2022-09-21 18:01:34 INFO  ---RUNTIME: Original pipeline execution took 19727.43535041809 ms (excluding imports and monkey-patching)
2022-09-21 18:01:34 INFO  Starting execution of 1 what-if analyses...
2022-09-21 18:01:34 INFO  Start plan generation for analysis DataCleaning...
2022-09-21 18:01:34 INFO  ---RUNTIME: Plan generation took 0.6585121154785156 ms
2022-09-21 18:01:34 INFO  Estimated runtime of original DAG is 18518.27597618103ms
2022-09-21 18:01:34 WARNING Skipping Multi-Query Optimization (instead, only applying patches)
2022-09-21 18:01:34 WARNING Columns ['review_id'] not present in train DAG after the train test split, only before!
2022-09-21 18:01:34 WARNING This could hint at data leakage!
2022-09-21 18:01:34 INFO  Estimated unoptimised what-if runtime is 370365.5195236206ms
2022-09-21 18:01:34 INFO  ---RUNTIME: Multi-Query Optimization took 24.367570877075195 ms
2022-09-21 18:01:34 INFO  Executing generated plans
2022-09-21 18:09:34 INFO  ---RUNTIME: Execution took 480683.85124206543 ms
2022-09-21 18:09:34 INFO  Done!
2022-09-21 18:09:34 INFO  # Finished -- repetition 2 of 7 
2022-09-21 18:09:34 INFO  # Optimization benchmark for data_cleaning with args [['reviews', 'slow_loading', 'featurization_2', 'xgboost']] -- repetition 3 of 7
2022-09-21 18:09:34 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-21 18:09:34 INFO  Running instrumented original pipeline...
2022-09-21 18:09:35 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-21 18:09:35 INFO  ---RUNTIME: Importing and monkey-patching took 8.432388305664062 ms
2022-09-21 18:09:58 INFO  ---RUNTIME: Original pipeline execution took 23178.76958847046 ms (excluding imports and monkey-patching)
2022-09-21 18:09:58 INFO  Starting execution of 1 what-if analyses...
2022-09-21 18:09:58 INFO  Start plan generation for analysis DataCleaning...
2022-09-21 18:09:58 INFO  ---RUNTIME: Plan generation took 0.6234645843505859 ms
2022-09-21 18:09:58 INFO  Estimated runtime of original DAG is 21530.471324920654ms
2022-09-21 18:09:58 INFO  Performing Multi-Query Optimization
2022-09-21 18:09:58 INFO  Estimated unoptimized what-if runtime is 430609.4264984131ms
2022-09-21 18:09:58 INFO  Estimated optimised what-if runtime is 309950.1178264618ms
2022-09-21 18:09:58 INFO  Estimated optimisation runtime saving is 120659.3086719513ms
2022-09-21 18:09:58 INFO  ---RUNTIME: Multi-Query Optimization took 309.4899654388428 ms
2022-09-21 18:09:58 INFO  Executing generated plans
2022-09-21 18:15:44 INFO  ---RUNTIME: Execution took 345657.79972076416 ms
2022-09-21 18:15:44 INFO  Done!
2022-09-21 18:15:44 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-21 18:15:44 INFO  Running instrumented original pipeline...
2022-09-21 18:15:44 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-21 18:15:44 INFO  ---RUNTIME: Importing and monkey-patching took 10.733604431152344 ms
2022-09-21 18:16:07 INFO  ---RUNTIME: Original pipeline execution took 23500.839233398438 ms (excluding imports and monkey-patching)
2022-09-21 18:16:07 INFO  Starting execution of 1 what-if analyses...
2022-09-21 18:16:07 INFO  Start plan generation for analysis DataCleaning...
2022-09-21 18:16:07 INFO  ---RUNTIME: Plan generation took 1.0335445404052734 ms
2022-09-21 18:16:07 INFO  Estimated runtime of original DAG is 21646.3623046875ms
2022-09-21 18:16:07 WARNING Skipping Multi-Query Optimization (instead, only applying patches)
2022-09-21 18:16:07 WARNING Columns ['review_id'] not present in train DAG after the train test split, only before!
2022-09-21 18:16:07 WARNING This could hint at data leakage!
2022-09-21 18:16:07 INFO  Estimated unoptimised what-if runtime is 432927.24609375ms
2022-09-21 18:16:07 INFO  ---RUNTIME: Multi-Query Optimization took 42.32454299926758 ms
2022-09-21 18:16:07 INFO  Executing generated plans
2022-09-21 18:24:19 INFO  ---RUNTIME: Execution took 491782.42564201355 ms
2022-09-21 18:24:19 INFO  Done!
2022-09-21 18:24:19 INFO  # Finished -- repetition 3 of 7 
2022-09-21 18:24:19 INFO  # Optimization benchmark for data_cleaning with args [['reviews', 'slow_loading', 'featurization_2', 'xgboost']] -- repetition 4 of 7
2022-09-21 18:24:19 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-21 18:24:19 INFO  Running instrumented original pipeline...
2022-09-21 18:24:19 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-21 18:24:19 INFO  ---RUNTIME: Importing and monkey-patching took 6.252050399780273 ms
2022-09-21 18:24:43 INFO  ---RUNTIME: Original pipeline execution took 23795.615911483765 ms (excluding imports and monkey-patching)
2022-09-21 18:24:43 INFO  Starting execution of 1 what-if analyses...
2022-09-21 18:24:43 INFO  Start plan generation for analysis DataCleaning...
2022-09-21 18:24:43 INFO  ---RUNTIME: Plan generation took 0.6592273712158203 ms
2022-09-21 18:24:43 INFO  Estimated runtime of original DAG is 22320.25408744812ms
2022-09-21 18:24:43 INFO  Performing Multi-Query Optimization
2022-09-21 18:24:43 INFO  Estimated unoptimized what-if runtime is 446405.0817489624ms
2022-09-21 18:24:43 INFO  Estimated optimised what-if runtime is 329946.39587402344ms
2022-09-21 18:24:43 INFO  Estimated optimisation runtime saving is 116458.68587493896ms
2022-09-21 18:24:43 INFO  ---RUNTIME: Multi-Query Optimization took 99.15447235107422 ms
2022-09-21 18:24:43 INFO  Executing generated plans
2022-09-21 18:30:29 INFO  ---RUNTIME: Execution took 346394.3772315979 ms
2022-09-21 18:30:29 INFO  Done!
2022-09-21 18:30:29 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-21 18:30:29 INFO  Running instrumented original pipeline...
2022-09-21 18:30:29 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-21 18:30:29 INFO  ---RUNTIME: Importing and monkey-patching took 8.87441635131836 ms
2022-09-21 18:30:51 INFO  ---RUNTIME: Original pipeline execution took 22116.013288497925 ms (excluding imports and monkey-patching)
2022-09-21 18:30:51 INFO  Starting execution of 1 what-if analyses...
2022-09-21 18:30:51 INFO  Start plan generation for analysis DataCleaning...
2022-09-21 18:30:51 INFO  ---RUNTIME: Plan generation took 0.7183551788330078 ms
2022-09-21 18:30:51 INFO  Estimated runtime of original DAG is 20767.28630065918ms
2022-09-21 18:30:51 WARNING Skipping Multi-Query Optimization (instead, only applying patches)
2022-09-21 18:30:51 WARNING Columns ['review_id'] not present in train DAG after the train test split, only before!
2022-09-21 18:30:51 WARNING This could hint at data leakage!
2022-09-21 18:30:51 INFO  Estimated unoptimised what-if runtime is 415345.7260131836ms
2022-09-21 18:30:51 INFO  ---RUNTIME: Multi-Query Optimization took 24.831295013427734 ms
2022-09-21 18:30:51 INFO  Executing generated plans
