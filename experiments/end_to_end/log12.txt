Variant name from 1-8: 12
Cores to use: 128-135
taskset -c 128-135 PROTOCOL_BUFFERS_PYTHON_IMPLEMENTATION=python python3.9 benchmarks_end_to_end.py data_cleaning healthcare slow_loading featurization_0 logistic_regression
2022-09-21 14:34:41.147205: W tensorflow/stream_executor/platform/default/dso_loader.cc:64] Could not load dynamic library 'libcudart.so.11.0'; dlerror: libcudart.so.11.0: cannot open shared object file: No such file or directory; LD_LIBRARY_PATH: /home/sgrafbe/mlwhatif/venv/lib/python3.9/site-packages/cv2/../../lib64:
2022-09-21 14:34:41.147250: I tensorflow/stream_executor/cuda/cudart_stub.cc:29] Ignore above cudart dlerror if you do not have a GPU set up on your machine.
2022-09-21 14:34:42 INFO  Patching sys.argv with ['mlwhatif', 'healthcare', 'slow_loading', 'featurization_0', 'logistic_regression']
2022-09-21 14:34:42 INFO  Running instrumented original pipeline...
2022-09-21 14:34:42 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-21 14:34:42 INFO  ---RUNTIME: Importing and monkey-patching took 95.37339210510254 ms
2022-09-21 14:34:44 INFO  ---RUNTIME: Original pipeline execution took 2079.970121383667 ms (excluding imports and monkey-patching)
2022-09-21 14:34:44 INFO  Starting execution of 0 what-if analyses...
2022-09-21 14:34:44 INFO  Estimated runtime of original DAG is 1824.7807025909424ms
2022-09-21 14:34:44 INFO  Performing Multi-Query Optimization
2022-09-21 14:34:44 INFO  Estimated unoptimized what-if runtime is 0ms
2022-09-21 14:34:44 INFO  Estimated optimised what-if runtime is 0ms
2022-09-21 14:34:44 INFO  Estimated optimisation runtime saving is 0ms
2022-09-21 14:34:44 INFO  ---RUNTIME: Multi-Query Optimization took 0.4420280456542969 ms
2022-09-21 14:34:44 INFO  Executing generated plans
2022-09-21 14:34:44 INFO  ---RUNTIME: Execution took 0.019550323486328125 ms
2022-09-21 14:34:44 INFO  Done!
2022-09-21 14:34:44 INFO  # Optimization benchmark for data_cleaning with args [['healthcare', 'slow_loading', 'featurization_0', 'logistic_regression']] -- repetition 1 of 7
2022-09-21 14:34:44 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-21 14:34:44 INFO  Running instrumented original pipeline...
2022-09-21 14:34:44 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-21 14:34:44 INFO  ---RUNTIME: Importing and monkey-patching took 5.110740661621094 ms
2022-09-21 14:34:46 INFO  ---RUNTIME: Original pipeline execution took 1974.7443199157715 ms (excluding imports and monkey-patching)
2022-09-21 14:34:46 INFO  Starting execution of 1 what-if analyses...
2022-09-21 14:34:46 INFO  Start plan generation for analysis DataCleaning...
2022-09-21 14:34:46 INFO  ---RUNTIME: Plan generation took 0.6465911865234375 ms
2022-09-21 14:34:46 INFO  Estimated runtime of original DAG is 1751.8336772918701ms
2022-09-21 14:34:46 INFO  Performing Multi-Query Optimization
2022-09-21 14:34:46 INFO  Estimated unoptimized what-if runtime is 43801.7041683197ms
2022-09-21 14:34:46 INFO  Estimated optimised what-if runtime is 1831.9189548492432ms
2022-09-21 14:34:46 INFO  Estimated optimisation runtime saving is 41969.78521347046ms
2022-09-21 14:34:46 INFO  ---RUNTIME: Multi-Query Optimization took 112.49113082885742 ms
2022-09-21 14:34:46 INFO  Executing generated plans
2022-09-21 14:34:51 INFO  ---RUNTIME: Execution took 4741.703510284424 ms
2022-09-21 14:34:51 INFO  Done!
2022-09-21 14:34:51 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-21 14:34:51 INFO  Running instrumented original pipeline...
2022-09-21 14:34:51 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-21 14:34:51 INFO  ---RUNTIME: Importing and monkey-patching took 5.943059921264648 ms
2022-09-21 14:34:53 INFO  ---RUNTIME: Original pipeline execution took 1972.9735851287842 ms (excluding imports and monkey-patching)
2022-09-21 14:34:53 INFO  Starting execution of 1 what-if analyses...
2022-09-21 14:34:53 INFO  Start plan generation for analysis DataCleaning...
2022-09-21 14:34:53 INFO  ---RUNTIME: Plan generation took 0.7803440093994141 ms
2022-09-21 14:34:53 INFO  Estimated runtime of original DAG is 1749.4816780090332ms
2022-09-21 14:34:53 WARNING Skipping Multi-Query Optimization (instead, only applying patches)
2022-09-21 14:34:53 WARNING Columns ['full_name'] not present in train DAG after the train test split, only before!
2022-09-21 14:34:53 WARNING This could hint at data leakage!
2022-09-21 14:34:53 INFO  Estimated unoptimised what-if runtime is 43742.934226989746ms
2022-09-21 14:34:53 INFO  ---RUNTIME: Multi-Query Optimization took 24.384021759033203 ms
2022-09-21 14:34:53 INFO  Executing generated plans
2022-09-21 14:35:40 INFO  ---RUNTIME: Execution took 47428.03478240967 ms
2022-09-21 14:35:40 INFO  Done!
2022-09-21 14:35:40 INFO  # Finished -- repetition 1 of 7 
2022-09-21 14:35:40 INFO  # Optimization benchmark for data_cleaning with args [['healthcare', 'slow_loading', 'featurization_0', 'logistic_regression']] -- repetition 2 of 7
2022-09-21 14:35:40 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-21 14:35:40 INFO  Running instrumented original pipeline...
2022-09-21 14:35:40 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-21 14:35:40 INFO  ---RUNTIME: Importing and monkey-patching took 5.942583084106445 ms
2022-09-21 14:35:42 INFO  ---RUNTIME: Original pipeline execution took 1998.8322257995605 ms (excluding imports and monkey-patching)
2022-09-21 14:35:42 INFO  Starting execution of 1 what-if analyses...
2022-09-21 14:35:42 INFO  Start plan generation for analysis DataCleaning...
2022-09-21 14:35:42 INFO  ---RUNTIME: Plan generation took 0.629425048828125 ms
2022-09-21 14:35:42 INFO  Estimated runtime of original DAG is 1773.8637924194336ms
2022-09-21 14:35:42 INFO  Performing Multi-Query Optimization
2022-09-21 14:35:42 INFO  Estimated unoptimized what-if runtime is 44352.54144668579ms
2022-09-21 14:35:42 INFO  Estimated optimised what-if runtime is 1853.1732559204102ms
2022-09-21 14:35:42 INFO  Estimated optimisation runtime saving is 42499.36819076538ms
2022-09-21 14:35:42 INFO  ---RUNTIME: Multi-Query Optimization took 110.0618839263916 ms
2022-09-21 14:35:42 INFO  Executing generated plans
2022-09-21 14:35:47 INFO  ---RUNTIME: Execution took 4665.361404418945 ms
2022-09-21 14:35:47 INFO  Done!
2022-09-21 14:35:47 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-21 14:35:47 INFO  Running instrumented original pipeline...
2022-09-21 14:35:47 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-21 14:35:47 INFO  ---RUNTIME: Importing and monkey-patching took 5.892038345336914 ms
2022-09-21 14:35:49 INFO  ---RUNTIME: Original pipeline execution took 1977.9109954833984 ms (excluding imports and monkey-patching)
2022-09-21 14:35:49 INFO  Starting execution of 1 what-if analyses...
2022-09-21 14:35:49 INFO  Start plan generation for analysis DataCleaning...
2022-09-21 14:35:49 INFO  ---RUNTIME: Plan generation took 0.6191730499267578 ms
2022-09-21 14:35:49 INFO  Estimated runtime of original DAG is 1754.0311813354492ms
2022-09-21 14:35:49 WARNING Skipping Multi-Query Optimization (instead, only applying patches)
2022-09-21 14:35:49 WARNING Columns ['full_name'] not present in train DAG after the train test split, only before!
2022-09-21 14:35:49 WARNING This could hint at data leakage!
2022-09-21 14:35:49 INFO  Estimated unoptimised what-if runtime is 43856.62603378296ms
2022-09-21 14:35:49 INFO  ---RUNTIME: Multi-Query Optimization took 24.71923828125 ms
2022-09-21 14:35:49 INFO  Executing generated plans
2022-09-21 14:36:37 INFO  ---RUNTIME: Execution took 47636.83366775513 ms
2022-09-21 14:36:37 INFO  Done!
2022-09-21 14:36:37 INFO  # Finished -- repetition 2 of 7 
2022-09-21 14:36:37 INFO  # Optimization benchmark for data_cleaning with args [['healthcare', 'slow_loading', 'featurization_0', 'logistic_regression']] -- repetition 3 of 7
2022-09-21 14:36:37 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-21 14:36:37 INFO  Running instrumented original pipeline...
2022-09-21 14:36:37 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-21 14:36:37 INFO  ---RUNTIME: Importing and monkey-patching took 5.770683288574219 ms
2022-09-21 14:36:39 INFO  ---RUNTIME: Original pipeline execution took 1970.8192348480225 ms (excluding imports and monkey-patching)
2022-09-21 14:36:39 INFO  Starting execution of 1 what-if analyses...
2022-09-21 14:36:39 INFO  Start plan generation for analysis DataCleaning...
2022-09-21 14:36:39 INFO  ---RUNTIME: Plan generation took 0.6427764892578125 ms
2022-09-21 14:36:39 INFO  Estimated runtime of original DAG is 1748.460292816162ms
2022-09-21 14:36:39 INFO  Performing Multi-Query Optimization
2022-09-21 14:36:39 INFO  Estimated unoptimized what-if runtime is 43717.38815307617ms
2022-09-21 14:36:39 INFO  Estimated optimised what-if runtime is 1826.935052871704ms
2022-09-21 14:36:39 INFO  Estimated optimisation runtime saving is 41890.45310020447ms
2022-09-21 14:36:39 INFO  ---RUNTIME: Multi-Query Optimization took 110.60285568237305 ms
2022-09-21 14:36:39 INFO  Executing generated plans
2022-09-21 14:36:44 INFO  ---RUNTIME: Execution took 4746.630907058716 ms
2022-09-21 14:36:44 INFO  Done!
2022-09-21 14:36:44 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-21 14:36:44 INFO  Running instrumented original pipeline...
2022-09-21 14:36:44 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-21 14:36:44 INFO  ---RUNTIME: Importing and monkey-patching took 5.959510803222656 ms
2022-09-21 14:36:46 INFO  ---RUNTIME: Original pipeline execution took 1984.4443798065186 ms (excluding imports and monkey-patching)
2022-09-21 14:36:46 INFO  Starting execution of 1 what-if analyses...
2022-09-21 14:36:46 INFO  Start plan generation for analysis DataCleaning...
2022-09-21 14:36:46 INFO  ---RUNTIME: Plan generation took 0.6124973297119141 ms
2022-09-21 14:36:46 INFO  Estimated runtime of original DAG is 1761.6090774536133ms
2022-09-21 14:36:46 WARNING Skipping Multi-Query Optimization (instead, only applying patches)
2022-09-21 14:36:46 WARNING Columns ['full_name'] not present in train DAG after the train test split, only before!
2022-09-21 14:36:46 WARNING This could hint at data leakage!
2022-09-21 14:36:46 INFO  Estimated unoptimised what-if runtime is 44046.133518218994ms
2022-09-21 14:36:46 INFO  ---RUNTIME: Multi-Query Optimization took 24.684429168701172 ms
2022-09-21 14:36:46 INFO  Executing generated plans
2022-09-21 14:37:33 INFO  ---RUNTIME: Execution took 47856.027126312256 ms
2022-09-21 14:37:33 INFO  Done!
2022-09-21 14:37:33 INFO  # Finished -- repetition 3 of 7 
2022-09-21 14:37:33 INFO  # Optimization benchmark for data_cleaning with args [['healthcare', 'slow_loading', 'featurization_0', 'logistic_regression']] -- repetition 4 of 7
2022-09-21 14:37:33 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-21 14:37:33 INFO  Running instrumented original pipeline...
2022-09-21 14:37:33 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-21 14:37:33 INFO  ---RUNTIME: Importing and monkey-patching took 5.964994430541992 ms
2022-09-21 14:37:35 INFO  ---RUNTIME: Original pipeline execution took 1981.2123775482178 ms (excluding imports and monkey-patching)
2022-09-21 14:37:35 INFO  Starting execution of 1 what-if analyses...
2022-09-21 14:37:35 INFO  Start plan generation for analysis DataCleaning...
2022-09-21 14:37:35 INFO  ---RUNTIME: Plan generation took 0.9562969207763672 ms
2022-09-21 14:37:35 INFO  Estimated runtime of original DAG is 1758.7666511535645ms
2022-09-21 14:37:35 INFO  Performing Multi-Query Optimization
2022-09-21 14:37:36 INFO  Estimated unoptimized what-if runtime is 43975.03137588501ms
2022-09-21 14:37:36 INFO  Estimated optimised what-if runtime is 1836.3542556762695ms
2022-09-21 14:37:36 INFO  Estimated optimisation runtime saving is 42138.67712020874ms
2022-09-21 14:37:36 INFO  ---RUNTIME: Multi-Query Optimization took 109.28177833557129 ms
2022-09-21 14:37:36 INFO  Executing generated plans
2022-09-21 14:37:40 INFO  ---RUNTIME: Execution took 4911.997556686401 ms
2022-09-21 14:37:40 INFO  Done!
2022-09-21 14:37:40 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-21 14:37:40 INFO  Running instrumented original pipeline...
2022-09-21 14:37:41 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-21 14:37:41 INFO  ---RUNTIME: Importing and monkey-patching took 5.944252014160156 ms
2022-09-21 14:37:43 INFO  ---RUNTIME: Original pipeline execution took 2171.5548038482666 ms (excluding imports and monkey-patching)
2022-09-21 14:37:43 INFO  Starting execution of 1 what-if analyses...
2022-09-21 14:37:43 INFO  Start plan generation for analysis DataCleaning...
2022-09-21 14:37:43 INFO  ---RUNTIME: Plan generation took 0.6072521209716797 ms
2022-09-21 14:37:43 INFO  Estimated runtime of original DAG is 1783.5958003997803ms
2022-09-21 14:37:43 WARNING Skipping Multi-Query Optimization (instead, only applying patches)
2022-09-21 14:37:43 WARNING Columns ['full_name'] not present in train DAG after the train test split, only before!
2022-09-21 14:37:43 WARNING This could hint at data leakage!
2022-09-21 14:37:43 INFO  Estimated unoptimised what-if runtime is 44595.757246017456ms
2022-09-21 14:37:43 INFO  ---RUNTIME: Multi-Query Optimization took 24.80483055114746 ms
2022-09-21 14:37:43 INFO  Executing generated plans
2022-09-21 14:38:30 INFO  ---RUNTIME: Execution took 47695.730447769165 ms
2022-09-21 14:38:30 INFO  Done!
2022-09-21 14:38:30 INFO  # Finished -- repetition 4 of 7 
2022-09-21 14:38:30 INFO  # Optimization benchmark for data_cleaning with args [['healthcare', 'slow_loading', 'featurization_0', 'logistic_regression']] -- repetition 5 of 7
2022-09-21 14:38:30 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-21 14:38:30 INFO  Running instrumented original pipeline...
2022-09-21 14:38:30 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-21 14:38:30 INFO  ---RUNTIME: Importing and monkey-patching took 6.0138702392578125 ms
2022-09-21 14:38:32 INFO  ---RUNTIME: Original pipeline execution took 1977.870225906372 ms (excluding imports and monkey-patching)
2022-09-21 14:38:32 INFO  Starting execution of 1 what-if analyses...
2022-09-21 14:38:32 INFO  Start plan generation for analysis DataCleaning...
2022-09-21 14:38:32 INFO  ---RUNTIME: Plan generation took 0.9253025054931641 ms
2022-09-21 14:38:32 INFO  Estimated runtime of original DAG is 1755.5019855499268ms
2022-09-21 14:38:32 INFO  Performing Multi-Query Optimization
2022-09-21 14:38:32 INFO  Estimated unoptimized what-if runtime is 43893.426179885864ms
2022-09-21 14:38:32 INFO  Estimated optimised what-if runtime is 1834.1221809387207ms
2022-09-21 14:38:32 INFO  Estimated optimisation runtime saving is 42059.30399894714ms
2022-09-21 14:38:32 INFO  ---RUNTIME: Multi-Query Optimization took 109.48967933654785 ms
2022-09-21 14:38:32 INFO  Executing generated plans
2022-09-21 14:38:37 INFO  ---RUNTIME: Execution took 4897.50075340271 ms
2022-09-21 14:38:37 INFO  Done!
2022-09-21 14:38:37 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-21 14:38:37 INFO  Running instrumented original pipeline...
2022-09-21 14:38:37 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-21 14:38:37 INFO  ---RUNTIME: Importing and monkey-patching took 5.978584289550781 ms
2022-09-21 14:38:39 INFO  ---RUNTIME: Original pipeline execution took 1970.7400798797607 ms (excluding imports and monkey-patching)
2022-09-21 14:38:39 INFO  Starting execution of 1 what-if analyses...
2022-09-21 14:38:39 INFO  Start plan generation for analysis DataCleaning...
2022-09-21 14:38:39 INFO  ---RUNTIME: Plan generation took 0.6244182586669922 ms
2022-09-21 14:38:39 INFO  Estimated runtime of original DAG is 1748.2502460479736ms
2022-09-21 14:38:39 WARNING Skipping Multi-Query Optimization (instead, only applying patches)
2022-09-21 14:38:39 WARNING Columns ['full_name'] not present in train DAG after the train test split, only before!
2022-09-21 14:38:39 WARNING This could hint at data leakage!
2022-09-21 14:38:39 INFO  Estimated unoptimised what-if runtime is 43712.138414382935ms
2022-09-21 14:38:39 INFO  ---RUNTIME: Multi-Query Optimization took 25.210142135620117 ms
2022-09-21 14:38:39 INFO  Executing generated plans
2022-09-21 14:39:27 INFO  ---RUNTIME: Execution took 47497.610330581665 ms
2022-09-21 14:39:27 INFO  Done!
2022-09-21 14:39:27 INFO  # Finished -- repetition 5 of 7 
2022-09-21 14:39:27 INFO  # Optimization benchmark for data_cleaning with args [['healthcare', 'slow_loading', 'featurization_0', 'logistic_regression']] -- repetition 6 of 7
2022-09-21 14:39:27 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-21 14:39:27 INFO  Running instrumented original pipeline...
2022-09-21 14:39:27 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-21 14:39:27 INFO  ---RUNTIME: Importing and monkey-patching took 6.105184555053711 ms
2022-09-21 14:39:29 INFO  ---RUNTIME: Original pipeline execution took 1973.7520217895508 ms (excluding imports and monkey-patching)
2022-09-21 14:39:29 INFO  Starting execution of 1 what-if analyses...
2022-09-21 14:39:29 INFO  Start plan generation for analysis DataCleaning...
2022-09-21 14:39:29 INFO  ---RUNTIME: Plan generation took 0.6093978881835938 ms
2022-09-21 14:39:29 INFO  Estimated runtime of original DAG is 1751.7807483673096ms
2022-09-21 14:39:29 INFO  Performing Multi-Query Optimization
2022-09-21 14:39:29 INFO  Estimated unoptimized what-if runtime is 43800.47249794006ms
2022-09-21 14:39:29 INFO  Estimated optimised what-if runtime is 1830.5625915527344ms
2022-09-21 14:39:29 INFO  Estimated optimisation runtime saving is 41969.90990638733ms
2022-09-21 14:39:29 INFO  ---RUNTIME: Multi-Query Optimization took 303.0557632446289 ms
2022-09-21 14:39:29 INFO  Executing generated plans
2022-09-21 14:39:34 INFO  ---RUNTIME: Execution took 4954.05912399292 ms
2022-09-21 14:39:34 INFO  Done!
2022-09-21 14:39:34 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-21 14:39:34 INFO  Running instrumented original pipeline...
2022-09-21 14:39:34 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-21 14:39:34 INFO  ---RUNTIME: Importing and monkey-patching took 6.2961578369140625 ms
2022-09-21 14:39:36 INFO  ---RUNTIME: Original pipeline execution took 2022.1633911132812 ms (excluding imports and monkey-patching)
2022-09-21 14:39:36 INFO  Starting execution of 1 what-if analyses...
2022-09-21 14:39:36 INFO  Start plan generation for analysis DataCleaning...
2022-09-21 14:39:36 INFO  ---RUNTIME: Plan generation took 0.6306171417236328 ms
2022-09-21 14:39:36 INFO  Estimated runtime of original DAG is 1793.5962677001953ms
2022-09-21 14:39:36 WARNING Skipping Multi-Query Optimization (instead, only applying patches)
2022-09-21 14:39:36 WARNING Columns ['full_name'] not present in train DAG after the train test split, only before!
2022-09-21 14:39:36 WARNING This could hint at data leakage!
2022-09-21 14:39:36 INFO  Estimated unoptimised what-if runtime is 44845.940589904785ms
2022-09-21 14:39:36 INFO  ---RUNTIME: Multi-Query Optimization took 25.39849281311035 ms
2022-09-21 14:39:36 INFO  Executing generated plans
2022-09-21 14:40:25 INFO  ---RUNTIME: Execution took 48718.39928627014 ms
2022-09-21 14:40:25 INFO  Done!
2022-09-21 14:40:25 INFO  # Finished -- repetition 6 of 7 
2022-09-21 14:40:25 INFO  # Optimization benchmark for data_cleaning with args [['healthcare', 'slow_loading', 'featurization_0', 'logistic_regression']] -- repetition 7 of 7
2022-09-21 14:40:25 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-21 14:40:25 INFO  Running instrumented original pipeline...
2022-09-21 14:40:25 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-21 14:40:25 INFO  ---RUNTIME: Importing and monkey-patching took 6.4697265625 ms
2022-09-21 14:40:27 INFO  ---RUNTIME: Original pipeline execution took 2064.196825027466 ms (excluding imports and monkey-patching)
2022-09-21 14:40:27 INFO  Starting execution of 1 what-if analyses...
2022-09-21 14:40:27 INFO  Start plan generation for analysis DataCleaning...
2022-09-21 14:40:27 INFO  ---RUNTIME: Plan generation took 0.640869140625 ms
2022-09-21 14:40:27 INFO  Estimated runtime of original DAG is 1835.385799407959ms
2022-09-21 14:40:27 INFO  Performing Multi-Query Optimization
2022-09-21 14:40:27 INFO  Estimated unoptimized what-if runtime is 45890.67029953003ms
2022-09-21 14:40:27 INFO  Estimated optimised what-if runtime is 1914.818525314331ms
2022-09-21 14:40:27 INFO  Estimated optimisation runtime saving is 43975.8517742157ms
2022-09-21 14:40:27 INFO  ---RUNTIME: Multi-Query Optimization took 115.36121368408203 ms
2022-09-21 14:40:27 INFO  Executing generated plans
2022-09-21 14:40:32 INFO  ---RUNTIME: Execution took 5139.580965042114 ms
2022-09-21 14:40:32 INFO  Done!
2022-09-21 14:40:32 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-21 14:40:32 INFO  Running instrumented original pipeline...
2022-09-21 14:40:32 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-21 14:40:32 INFO  ---RUNTIME: Importing and monkey-patching took 6.346940994262695 ms
2022-09-21 14:40:34 INFO  ---RUNTIME: Original pipeline execution took 2065.1638507843018 ms (excluding imports and monkey-patching)
2022-09-21 14:40:34 INFO  Starting execution of 1 what-if analyses...
2022-09-21 14:40:34 INFO  Start plan generation for analysis DataCleaning...
2022-09-21 14:40:34 INFO  ---RUNTIME: Plan generation took 0.9827613830566406 ms
2022-09-21 14:40:34 INFO  Estimated runtime of original DAG is 1835.585355758667ms
2022-09-21 14:40:34 WARNING Skipping Multi-Query Optimization (instead, only applying patches)
2022-09-21 14:40:34 WARNING Columns ['full_name'] not present in train DAG after the train test split, only before!
2022-09-21 14:40:34 WARNING This could hint at data leakage!
2022-09-21 14:40:34 INFO  Estimated unoptimised what-if runtime is 45895.62773704529ms
2022-09-21 14:40:34 INFO  ---RUNTIME: Multi-Query Optimization took 25.316238403320312 ms
2022-09-21 14:40:34 INFO  Executing generated plans
2022-09-21 14:41:24 INFO  ---RUNTIME: Execution took 50023.87857437134 ms
2022-09-21 14:41:24 INFO  Done!
2022-09-21 14:41:24 INFO  # Finished -- repetition 7 of 7 
2022-09-21 14:41:24 INFO  # Final results after all repetitions
2022-09-21 14:41:24 INFO     repetition  ... no_opt_what_if_execution_combined_model_training
0           0  ...                                      2059.122324
1           1  ...                                      2125.074148
2           2  ...                                      2236.019850
3           3  ...                                      2263.045549
4           4  ...                                      2277.757645
5           5  ...                                      2419.397116
6           6  ...                                      2560.402393

[7 rows x 26 columns]
taskset -c 128-135 PROTOCOL_BUFFERS_PYTHON_IMPLEMENTATION=python python3.9 benchmarks_end_to_end.py data_cleaning healthcare slow_loading featurization_0 xgboost
2022-09-21 14:41:26.962724: W tensorflow/stream_executor/platform/default/dso_loader.cc:64] Could not load dynamic library 'libcudart.so.11.0'; dlerror: libcudart.so.11.0: cannot open shared object file: No such file or directory; LD_LIBRARY_PATH: /home/sgrafbe/mlwhatif/venv/lib/python3.9/site-packages/cv2/../../lib64:
2022-09-21 14:41:26.962767: I tensorflow/stream_executor/cuda/cudart_stub.cc:29] Ignore above cudart dlerror if you do not have a GPU set up on your machine.
2022-09-21 14:41:28 INFO  Patching sys.argv with ['mlwhatif', 'healthcare', 'slow_loading', 'featurization_0', 'xgboost']
2022-09-21 14:41:28 INFO  Running instrumented original pipeline...
2022-09-21 14:41:28 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-21 14:41:28 INFO  ---RUNTIME: Importing and monkey-patching took 98.16718101501465 ms
2022-09-21 14:41:30 INFO  ---RUNTIME: Original pipeline execution took 2367.4099445343018 ms (excluding imports and monkey-patching)
2022-09-21 14:41:30 INFO  Starting execution of 0 what-if analyses...
2022-09-21 14:41:30 INFO  Estimated runtime of original DAG is 2105.663776397705ms
2022-09-21 14:41:30 INFO  Performing Multi-Query Optimization
2022-09-21 14:41:30 INFO  Estimated unoptimized what-if runtime is 0ms
2022-09-21 14:41:30 INFO  Estimated optimised what-if runtime is 0ms
2022-09-21 14:41:30 INFO  Estimated optimisation runtime saving is 0ms
2022-09-21 14:41:30 INFO  ---RUNTIME: Multi-Query Optimization took 0.42176246643066406 ms
2022-09-21 14:41:30 INFO  Executing generated plans
2022-09-21 14:41:30 INFO  ---RUNTIME: Execution took 0.021219253540039062 ms
2022-09-21 14:41:30 INFO  Done!
2022-09-21 14:41:30 INFO  # Optimization benchmark for data_cleaning with args [['healthcare', 'slow_loading', 'featurization_0', 'xgboost']] -- repetition 1 of 7
2022-09-21 14:41:30 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-21 14:41:30 INFO  Running instrumented original pipeline...
2022-09-21 14:41:30 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-21 14:41:30 INFO  ---RUNTIME: Importing and monkey-patching took 5.084753036499023 ms
2022-09-21 14:41:32 INFO  ---RUNTIME: Original pipeline execution took 2217.7064418792725 ms (excluding imports and monkey-patching)
2022-09-21 14:41:32 INFO  Starting execution of 1 what-if analyses...
2022-09-21 14:41:32 INFO  Start plan generation for analysis DataCleaning...
2022-09-21 14:41:32 INFO  ---RUNTIME: Plan generation took 0.6573200225830078 ms
2022-09-21 14:41:32 INFO  Estimated runtime of original DAG is 1988.793134689331ms
2022-09-21 14:41:32 INFO  Performing Multi-Query Optimization
2022-09-21 14:41:33 INFO  Estimated unoptimized what-if runtime is 50822.63684272766ms
2022-09-21 14:41:33 INFO  Estimated optimised what-if runtime is 7590.888977050781ms
2022-09-21 14:41:33 INFO  Estimated optimisation runtime saving is 43231.74786567688ms
2022-09-21 14:41:33 INFO  ---RUNTIME: Multi-Query Optimization took 111.89627647399902 ms
2022-09-21 14:41:33 INFO  Executing generated plans
2022-09-21 14:41:43 INFO  ---RUNTIME: Execution took 10747.373819351196 ms
2022-09-21 14:41:43 INFO  Done!
2022-09-21 14:41:43 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-21 14:41:43 INFO  Running instrumented original pipeline...
2022-09-21 14:41:43 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-21 14:41:43 INFO  ---RUNTIME: Importing and monkey-patching took 6.371259689331055 ms
2022-09-21 14:41:45 INFO  ---RUNTIME: Original pipeline execution took 2171.414852142334 ms (excluding imports and monkey-patching)
2022-09-21 14:41:45 INFO  Starting execution of 1 what-if analyses...
2022-09-21 14:41:45 INFO  Start plan generation for analysis DataCleaning...
2022-09-21 14:41:45 INFO  ---RUNTIME: Plan generation took 0.705718994140625 ms
2022-09-21 14:41:45 INFO  Estimated runtime of original DAG is 1943.5358047485352ms
2022-09-21 14:41:45 WARNING Skipping Multi-Query Optimization (instead, only applying patches)
2022-09-21 14:41:46 WARNING Columns ['full_name'] not present in train DAG after the train test split, only before!
2022-09-21 14:41:46 WARNING This could hint at data leakage!
2022-09-21 14:41:46 INFO  Estimated unoptimised what-if runtime is 49689.27526473999ms
2022-09-21 14:41:46 INFO  ---RUNTIME: Multi-Query Optimization took 24.23882484436035 ms
2022-09-21 14:41:46 INFO  Executing generated plans
2022-09-21 14:42:39 INFO  ---RUNTIME: Execution took 53737.14804649353 ms
2022-09-21 14:42:39 INFO  Done!
2022-09-21 14:42:39 INFO  # Finished -- repetition 1 of 7 
2022-09-21 14:42:39 INFO  # Optimization benchmark for data_cleaning with args [['healthcare', 'slow_loading', 'featurization_0', 'xgboost']] -- repetition 2 of 7
2022-09-21 14:42:39 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-21 14:42:39 INFO  Running instrumented original pipeline...
2022-09-21 14:42:39 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-21 14:42:39 INFO  ---RUNTIME: Importing and monkey-patching took 6.333589553833008 ms
2022-09-21 14:42:41 INFO  ---RUNTIME: Original pipeline execution took 2227.376937866211 ms (excluding imports and monkey-patching)
2022-09-21 14:42:41 INFO  Starting execution of 1 what-if analyses...
2022-09-21 14:42:41 INFO  Start plan generation for analysis DataCleaning...
2022-09-21 14:42:41 INFO  ---RUNTIME: Plan generation took 0.6990432739257812 ms
2022-09-21 14:42:41 INFO  Estimated runtime of original DAG is 1995.483636856079ms
2022-09-21 14:42:41 INFO  Performing Multi-Query Optimization
2022-09-21 14:42:42 INFO  Estimated unoptimized what-if runtime is 50988.80362510681ms
2022-09-21 14:42:42 INFO  Estimated optimised what-if runtime is 7590.698719024658ms
2022-09-21 14:42:42 INFO  Estimated optimisation runtime saving is 43398.10490608215ms
2022-09-21 14:42:42 INFO  ---RUNTIME: Multi-Query Optimization took 110.8553409576416 ms
2022-09-21 14:42:42 INFO  Executing generated plans
2022-09-21 14:42:52 INFO  ---RUNTIME: Execution took 10707.7796459198 ms
2022-09-21 14:42:52 INFO  Done!
2022-09-21 14:42:52 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-21 14:42:52 INFO  Running instrumented original pipeline...
2022-09-21 14:42:52 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-21 14:42:52 INFO  ---RUNTIME: Importing and monkey-patching took 6.309032440185547 ms
2022-09-21 14:42:55 INFO  ---RUNTIME: Original pipeline execution took 2198.5790729522705 ms (excluding imports and monkey-patching)
2022-09-21 14:42:55 INFO  Starting execution of 1 what-if analyses...
2022-09-21 14:42:55 INFO  Start plan generation for analysis DataCleaning...
2022-09-21 14:42:55 INFO  ---RUNTIME: Plan generation took 0.6513595581054688 ms
2022-09-21 14:42:55 INFO  Estimated runtime of original DAG is 1972.5720882415771ms
2022-09-21 14:42:55 WARNING Skipping Multi-Query Optimization (instead, only applying patches)
2022-09-21 14:42:55 WARNING Columns ['full_name'] not present in train DAG after the train test split, only before!
2022-09-21 14:42:55 WARNING This could hint at data leakage!
2022-09-21 14:42:55 INFO  Estimated unoptimised what-if runtime is 50401.75700187683ms
2022-09-21 14:42:55 INFO  ---RUNTIME: Multi-Query Optimization took 24.317026138305664 ms
2022-09-21 14:42:55 INFO  Executing generated plans
2022-09-21 14:43:50 INFO  ---RUNTIME: Execution took 55336.732149124146 ms
2022-09-21 14:43:50 INFO  Done!
2022-09-21 14:43:50 INFO  # Finished -- repetition 2 of 7 
2022-09-21 14:43:50 INFO  # Optimization benchmark for data_cleaning with args [['healthcare', 'slow_loading', 'featurization_0', 'xgboost']] -- repetition 3 of 7
2022-09-21 14:43:50 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-21 14:43:50 INFO  Running instrumented original pipeline...
2022-09-21 14:43:50 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-21 14:43:50 INFO  ---RUNTIME: Importing and monkey-patching took 6.171226501464844 ms
2022-09-21 14:43:52 INFO  ---RUNTIME: Original pipeline execution took 2173.076391220093 ms (excluding imports and monkey-patching)
2022-09-21 14:43:52 INFO  Starting execution of 1 what-if analyses...
2022-09-21 14:43:52 INFO  Start plan generation for analysis DataCleaning...
2022-09-21 14:43:52 INFO  ---RUNTIME: Plan generation took 0.6959438323974609 ms
2022-09-21 14:43:52 INFO  Estimated runtime of original DAG is 1933.5236549377441ms
2022-09-21 14:43:52 INFO  Performing Multi-Query Optimization
2022-09-21 14:43:52 INFO  Estimated unoptimized what-if runtime is 49435.89735031128ms
2022-09-21 14:43:52 INFO  Estimated optimised what-if runtime is 7509.735345840454ms
2022-09-21 14:43:52 INFO  Estimated optimisation runtime saving is 41926.162004470825ms
2022-09-21 14:43:52 INFO  ---RUNTIME: Multi-Query Optimization took 110.54658889770508 ms
2022-09-21 14:43:52 INFO  Executing generated plans
2022-09-21 14:44:03 INFO  ---RUNTIME: Execution took 10856.842994689941 ms
2022-09-21 14:44:03 INFO  Done!
2022-09-21 14:44:03 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-21 14:44:03 INFO  Running instrumented original pipeline...
2022-09-21 14:44:03 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-21 14:44:03 INFO  ---RUNTIME: Importing and monkey-patching took 6.395101547241211 ms
2022-09-21 14:44:05 INFO  ---RUNTIME: Original pipeline execution took 2238.114595413208 ms (excluding imports and monkey-patching)
2022-09-21 14:44:05 INFO  Starting execution of 1 what-if analyses...
2022-09-21 14:44:05 INFO  Start plan generation for analysis DataCleaning...
2022-09-21 14:44:05 INFO  ---RUNTIME: Plan generation took 0.6361007690429688 ms
2022-09-21 14:44:05 INFO  Estimated runtime of original DAG is 2007.3950290679932ms
2022-09-21 14:44:05 WARNING Skipping Multi-Query Optimization (instead, only applying patches)
2022-09-21 14:44:05 WARNING Columns ['full_name'] not present in train DAG after the train test split, only before!
2022-09-21 14:44:05 WARNING This could hint at data leakage!
2022-09-21 14:44:05 INFO  Estimated unoptimised what-if runtime is 51301.708936691284ms
2022-09-21 14:44:05 INFO  ---RUNTIME: Multi-Query Optimization took 25.394201278686523 ms
2022-09-21 14:44:05 INFO  Executing generated plans
2022-09-21 14:45:05 INFO  ---RUNTIME: Execution took 59742.440938949585 ms
2022-09-21 14:45:05 INFO  Done!
2022-09-21 14:45:05 INFO  # Finished -- repetition 3 of 7 
2022-09-21 14:45:05 INFO  # Optimization benchmark for data_cleaning with args [['healthcare', 'slow_loading', 'featurization_0', 'xgboost']] -- repetition 4 of 7
2022-09-21 14:45:05 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-21 14:45:05 INFO  Running instrumented original pipeline...
2022-09-21 14:45:05 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-21 14:45:05 INFO  ---RUNTIME: Importing and monkey-patching took 6.325244903564453 ms
2022-09-21 14:45:07 INFO  ---RUNTIME: Original pipeline execution took 2229.2842864990234 ms (excluding imports and monkey-patching)
2022-09-21 14:45:07 INFO  Starting execution of 1 what-if analyses...
2022-09-21 14:45:07 INFO  Start plan generation for analysis DataCleaning...
2022-09-21 14:45:07 INFO  ---RUNTIME: Plan generation took 0.7255077362060547 ms
2022-09-21 14:45:07 INFO  Estimated runtime of original DAG is 1999.4454383850098ms
2022-09-21 14:45:07 INFO  Performing Multi-Query Optimization
2022-09-21 14:45:07 INFO  Estimated unoptimized what-if runtime is 51085.60562133789ms
2022-09-21 14:45:07 INFO  Estimated optimised what-if runtime is 7590.320825576782ms
2022-09-21 14:45:07 INFO  Estimated optimisation runtime saving is 43495.28479576111ms
2022-09-21 14:45:07 INFO  ---RUNTIME: Multi-Query Optimization took 135.9851360321045 ms
2022-09-21 14:45:07 INFO  Executing generated plans
2022-09-21 14:45:18 INFO  ---RUNTIME: Execution took 10781.603574752808 ms
2022-09-21 14:45:18 INFO  Done!
2022-09-21 14:45:18 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-21 14:45:18 INFO  Running instrumented original pipeline...
2022-09-21 14:45:18 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-21 14:45:18 INFO  ---RUNTIME: Importing and monkey-patching took 6.341695785522461 ms
2022-09-21 14:45:21 INFO  ---RUNTIME: Original pipeline execution took 2392.617702484131 ms (excluding imports and monkey-patching)
2022-09-21 14:45:21 INFO  Starting execution of 1 what-if analyses...
2022-09-21 14:45:21 INFO  Start plan generation for analysis DataCleaning...
2022-09-21 14:45:21 INFO  ---RUNTIME: Plan generation took 0.8211135864257812 ms
2022-09-21 14:45:21 INFO  Estimated runtime of original DAG is 1954.1327953338623ms
2022-09-21 14:45:21 WARNING Skipping Multi-Query Optimization (instead, only applying patches)
2022-09-21 14:45:21 WARNING Columns ['full_name'] not present in train DAG after the train test split, only before!
2022-09-21 14:45:21 WARNING This could hint at data leakage!
2022-09-21 14:45:21 INFO  Estimated unoptimised what-if runtime is 49940.223932266235ms
2022-09-21 14:45:21 INFO  ---RUNTIME: Multi-Query Optimization took 24.285316467285156 ms
2022-09-21 14:45:21 INFO  Executing generated plans
2022-09-21 14:46:15 INFO  ---RUNTIME: Execution took 54380.53560256958 ms
2022-09-21 14:46:15 INFO  Done!
2022-09-21 14:46:15 INFO  # Finished -- repetition 4 of 7 
2022-09-21 14:46:15 INFO  # Optimization benchmark for data_cleaning with args [['healthcare', 'slow_loading', 'featurization_0', 'xgboost']] -- repetition 5 of 7
2022-09-21 14:46:15 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-21 14:46:15 INFO  Running instrumented original pipeline...
2022-09-21 14:46:15 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-21 14:46:15 INFO  ---RUNTIME: Importing and monkey-patching took 6.215810775756836 ms
2022-09-21 14:46:17 INFO  ---RUNTIME: Original pipeline execution took 2186.3908767700195 ms (excluding imports and monkey-patching)
2022-09-21 14:46:17 INFO  Starting execution of 1 what-if analyses...
2022-09-21 14:46:17 INFO  Start plan generation for analysis DataCleaning...
2022-09-21 14:46:17 INFO  ---RUNTIME: Plan generation took 0.6561279296875 ms
2022-09-21 14:46:17 INFO  Estimated runtime of original DAG is 1960.5679512023926ms
2022-09-21 14:46:17 INFO  Performing Multi-Query Optimization
2022-09-21 14:46:17 INFO  Estimated unoptimized what-if runtime is 50108.437061309814ms
2022-09-21 14:46:17 INFO  Estimated optimised what-if runtime is 7517.336368560791ms
2022-09-21 14:46:17 INFO  Estimated optimisation runtime saving is 42591.10069274902ms
2022-09-21 14:46:17 INFO  ---RUNTIME: Multi-Query Optimization took 110.25118827819824 ms
2022-09-21 14:46:17 INFO  Executing generated plans
2022-09-21 14:46:28 INFO  ---RUNTIME: Execution took 10879.725933074951 ms
2022-09-21 14:46:28 INFO  Done!
2022-09-21 14:46:28 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-21 14:46:28 INFO  Running instrumented original pipeline...
2022-09-21 14:46:28 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-21 14:46:28 INFO  ---RUNTIME: Importing and monkey-patching took 6.151676177978516 ms
2022-09-21 14:46:30 INFO  ---RUNTIME: Original pipeline execution took 2174.079179763794 ms (excluding imports and monkey-patching)
2022-09-21 14:46:30 INFO  Starting execution of 1 what-if analyses...
2022-09-21 14:46:30 INFO  Start plan generation for analysis DataCleaning...
2022-09-21 14:46:30 INFO  ---RUNTIME: Plan generation took 0.6380081176757812 ms
2022-09-21 14:46:30 INFO  Estimated runtime of original DAG is 1948.7318992614746ms
2022-09-21 14:46:30 WARNING Skipping Multi-Query Optimization (instead, only applying patches)
2022-09-21 14:46:30 WARNING Columns ['full_name'] not present in train DAG after the train test split, only before!
2022-09-21 14:46:30 WARNING This could hint at data leakage!
2022-09-21 14:46:30 INFO  Estimated unoptimised what-if runtime is 49810.26840209961ms
2022-09-21 14:46:30 INFO  ---RUNTIME: Multi-Query Optimization took 24.280548095703125 ms
2022-09-21 14:46:30 INFO  Executing generated plans
2022-09-21 14:47:24 INFO  ---RUNTIME: Execution took 53885.42127609253 ms
2022-09-21 14:47:24 INFO  Done!
2022-09-21 14:47:24 INFO  # Finished -- repetition 5 of 7 
2022-09-21 14:47:24 INFO  # Optimization benchmark for data_cleaning with args [['healthcare', 'slow_loading', 'featurization_0', 'xgboost']] -- repetition 6 of 7
2022-09-21 14:47:24 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-21 14:47:24 INFO  Running instrumented original pipeline...
2022-09-21 14:47:24 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-21 14:47:24 INFO  ---RUNTIME: Importing and monkey-patching took 6.087541580200195 ms
2022-09-21 14:47:27 INFO  ---RUNTIME: Original pipeline execution took 2229.5165061950684 ms (excluding imports and monkey-patching)
2022-09-21 14:47:27 INFO  Starting execution of 1 what-if analyses...
2022-09-21 14:47:27 INFO  Start plan generation for analysis DataCleaning...
2022-09-21 14:47:27 INFO  ---RUNTIME: Plan generation took 0.6902217864990234 ms
2022-09-21 14:47:27 INFO  Estimated runtime of original DAG is 2003.8206577301025ms
2022-09-21 14:47:27 INFO  Performing Multi-Query Optimization
2022-09-21 14:47:27 INFO  Estimated unoptimized what-if runtime is 51184.78083610535ms
2022-09-21 14:47:27 INFO  Estimated optimised what-if runtime is 7536.606788635254ms
2022-09-21 14:47:27 INFO  Estimated optimisation runtime saving is 43648.17404747009ms
2022-09-21 14:47:27 INFO  ---RUNTIME: Multi-Query Optimization took 111.4203929901123 ms
2022-09-21 14:47:27 INFO  Executing generated plans
2022-09-21 14:47:38 INFO  ---RUNTIME: Execution took 10870.497226715088 ms
2022-09-21 14:47:38 INFO  Done!
2022-09-21 14:47:38 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-21 14:47:38 INFO  Running instrumented original pipeline...
2022-09-21 14:47:38 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-21 14:47:38 INFO  ---RUNTIME: Importing and monkey-patching took 6.193876266479492 ms
2022-09-21 14:47:40 INFO  ---RUNTIME: Original pipeline execution took 2171.5118885040283 ms (excluding imports and monkey-patching)
2022-09-21 14:47:40 INFO  Starting execution of 1 what-if analyses...
2022-09-21 14:47:40 INFO  Start plan generation for analysis DataCleaning...
2022-09-21 14:47:40 INFO  ---RUNTIME: Plan generation took 0.675201416015625 ms
2022-09-21 14:47:40 INFO  Estimated runtime of original DAG is 1942.523717880249ms
2022-09-21 14:47:40 WARNING Skipping Multi-Query Optimization (instead, only applying patches)
2022-09-21 14:47:40 WARNING Columns ['full_name'] not present in train DAG after the train test split, only before!
2022-09-21 14:47:40 WARNING This could hint at data leakage!
2022-09-21 14:47:40 INFO  Estimated unoptimised what-if runtime is 49661.014795303345ms
2022-09-21 14:47:40 INFO  ---RUNTIME: Multi-Query Optimization took 24.352073669433594 ms
2022-09-21 14:47:40 INFO  Executing generated plans
2022-09-21 14:48:34 INFO  ---RUNTIME: Execution took 54417.89102554321 ms
2022-09-21 14:48:34 INFO  Done!
2022-09-21 14:48:34 INFO  # Finished -- repetition 6 of 7 
2022-09-21 14:48:34 INFO  # Optimization benchmark for data_cleaning with args [['healthcare', 'slow_loading', 'featurization_0', 'xgboost']] -- repetition 7 of 7
2022-09-21 14:48:34 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-21 14:48:34 INFO  Running instrumented original pipeline...
2022-09-21 14:48:34 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-21 14:48:34 INFO  ---RUNTIME: Importing and monkey-patching took 6.463766098022461 ms
2022-09-21 14:48:36 INFO  ---RUNTIME: Original pipeline execution took 2255.0368309020996 ms (excluding imports and monkey-patching)
2022-09-21 14:48:36 INFO  Starting execution of 1 what-if analyses...
2022-09-21 14:48:36 INFO  Start plan generation for analysis DataCleaning...
2022-09-21 14:48:36 INFO  ---RUNTIME: Plan generation took 1.0635852813720703 ms
2022-09-21 14:48:36 INFO  Estimated runtime of original DAG is 2026.8409252166748ms
2022-09-21 14:48:36 INFO  Performing Multi-Query Optimization
2022-09-21 14:48:37 INFO  Estimated unoptimized what-if runtime is 51759.9241733551ms
2022-09-21 14:48:37 INFO  Estimated optimised what-if runtime is 7557.705402374268ms
2022-09-21 14:48:37 INFO  Estimated optimisation runtime saving is 44202.218770980835ms
2022-09-21 14:48:37 INFO  ---RUNTIME: Multi-Query Optimization took 109.79890823364258 ms
2022-09-21 14:48:37 INFO  Executing generated plans
2022-09-21 14:48:47 INFO  ---RUNTIME: Execution took 10869.359970092773 ms
2022-09-21 14:48:47 INFO  Done!
2022-09-21 14:48:47 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-21 14:48:47 INFO  Running instrumented original pipeline...
2022-09-21 14:48:47 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-21 14:48:47 INFO  ---RUNTIME: Importing and monkey-patching took 6.369352340698242 ms
2022-09-21 14:48:50 INFO  ---RUNTIME: Original pipeline execution took 2155.7369232177734 ms (excluding imports and monkey-patching)
2022-09-21 14:48:50 INFO  Starting execution of 1 what-if analyses...
2022-09-21 14:48:50 INFO  Start plan generation for analysis DataCleaning...
2022-09-21 14:48:50 INFO  ---RUNTIME: Plan generation took 0.6706714630126953 ms
2022-09-21 14:48:50 INFO  Estimated runtime of original DAG is 1925.2746105194092ms
2022-09-21 14:48:50 WARNING Skipping Multi-Query Optimization (instead, only applying patches)
2022-09-21 14:48:50 WARNING Columns ['full_name'] not present in train DAG after the train test split, only before!
2022-09-21 14:48:50 WARNING This could hint at data leakage!
2022-09-21 14:48:50 INFO  Estimated unoptimised what-if runtime is 49224.7588634491ms
2022-09-21 14:48:50 INFO  ---RUNTIME: Multi-Query Optimization took 24.530887603759766 ms
2022-09-21 14:48:50 INFO  Executing generated plans
2022-09-21 14:49:43 INFO  ---RUNTIME: Execution took 53527.96387672424 ms
2022-09-21 14:49:43 INFO  Done!
2022-09-21 14:49:43 INFO  # Finished -- repetition 7 of 7 
2022-09-21 14:49:43 INFO  # Final results after all repetitions
2022-09-21 14:49:43 INFO     repetition  ... no_opt_what_if_execution_combined_model_training
0           0  ...                                      8076.404810
1           1  ...                                      8272.409678
2           2  ...                                      8173.039198
3           3  ...                                      8275.475264
4           4  ...                                      8301.071644
5           5  ...                                      8353.011131
6           6  ...                                      8342.379332

[7 rows x 26 columns]
taskset -c 128-135 PROTOCOL_BUFFERS_PYTHON_IMPLEMENTATION=python python3.9 benchmarks_end_to_end.py data_cleaning healthcare slow_loading featurization_0 neural_network
2022-09-21 14:49:45.754458: W tensorflow/stream_executor/platform/default/dso_loader.cc:64] Could not load dynamic library 'libcudart.so.11.0'; dlerror: libcudart.so.11.0: cannot open shared object file: No such file or directory; LD_LIBRARY_PATH: /home/sgrafbe/mlwhatif/venv/lib/python3.9/site-packages/cv2/../../lib64:
2022-09-21 14:49:45.754506: I tensorflow/stream_executor/cuda/cudart_stub.cc:29] Ignore above cudart dlerror if you do not have a GPU set up on your machine.
2022-09-21 14:49:47 INFO  Patching sys.argv with ['mlwhatif', 'healthcare', 'slow_loading', 'featurization_0', 'neural_network']
2022-09-21 14:49:47 INFO  Running instrumented original pipeline...
2022-09-21 14:49:47 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-21 14:49:47 INFO  ---RUNTIME: Importing and monkey-patching took 95.3378677368164 ms
2022-09-21 14:49:49.180139: W tensorflow/stream_executor/platform/default/dso_loader.cc:64] Could not load dynamic library 'libcuda.so.1'; dlerror: libcuda.so.1: cannot open shared object file: No such file or directory; LD_LIBRARY_PATH: /home/sgrafbe/mlwhatif/venv/lib/python3.9/site-packages/cv2/../../lib64:
2022-09-21 14:49:49.180171: W tensorflow/stream_executor/cuda/cuda_driver.cc:326] failed call to cuInit: UNKNOWN ERROR (303)
2022-09-21 14:49:49.180194: I tensorflow/stream_executor/cuda/cuda_diagnostics.cc:156] kernel driver does not appear to be running on this host (wagyu): /proc/driver/nvidia/version does not exist
2022-09-21 14:49:49.180726: I tensorflow/core/platform/cpu_feature_guard.cc:142] This TensorFlow binary is optimized with oneAPI Deep Neural Network Library (oneDNN) to use the following CPU instructions in performance-critical operations:  AVX2 FMA
To enable them in other operations, rebuild TensorFlow with the appropriate compiler flags.
2022-09-21 14:49:49.244641: I tensorflow/compiler/mlir/mlir_graph_optimization_pass.cc:176] None of the MLIR Optimization Passes are enabled (registered 2)
2022-09-21 14:49:49.257377: I tensorflow/core/platform/profile_utils/cpu_utils.cc:114] CPU Frequency: 2595290000 Hz
2022-09-21 14:49:49 INFO  ---RUNTIME: Original pipeline execution took 2703.961133956909 ms (excluding imports and monkey-patching)
2022-09-21 14:49:49 INFO  Starting execution of 0 what-if analyses...
2022-09-21 14:49:49 INFO  Estimated runtime of original DAG is 2445.7950592041016ms
2022-09-21 14:49:49 INFO  Performing Multi-Query Optimization
2022-09-21 14:49:49 INFO  Estimated unoptimized what-if runtime is 0ms
2022-09-21 14:49:49 INFO  Estimated optimised what-if runtime is 0ms
2022-09-21 14:49:49 INFO  Estimated optimisation runtime saving is 0ms
2022-09-21 14:49:49 INFO  ---RUNTIME: Multi-Query Optimization took 0.43463706970214844 ms
2022-09-21 14:49:49 INFO  Executing generated plans
2022-09-21 14:49:49 INFO  ---RUNTIME: Execution took 0.021696090698242188 ms
2022-09-21 14:49:49 INFO  Done!
2022-09-21 14:49:49 INFO  # Optimization benchmark for data_cleaning with args [['healthcare', 'slow_loading', 'featurization_0', 'neural_network']] -- repetition 1 of 7
2022-09-21 14:49:49 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-21 14:49:49 INFO  Running instrumented original pipeline...
2022-09-21 14:49:49 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-21 14:49:49 INFO  ---RUNTIME: Importing and monkey-patching took 5.182504653930664 ms
2022-09-21 14:49:52 INFO  ---RUNTIME: Original pipeline execution took 2403.6688804626465 ms (excluding imports and monkey-patching)
2022-09-21 14:49:52 INFO  Starting execution of 1 what-if analyses...
2022-09-21 14:49:52 INFO  Start plan generation for analysis DataCleaning...
2022-09-21 14:49:52 INFO  ---RUNTIME: Plan generation took 2.763032913208008 ms
2022-09-21 14:49:52 INFO  Estimated runtime of original DAG is 2177.6063442230225ms
2022-09-21 14:49:52 INFO  Performing Multi-Query Optimization
2022-09-21 14:49:52 INFO  Estimated unoptimized what-if runtime is 56397.82643318176ms
2022-09-21 14:49:52 INFO  Estimated optimised what-if runtime is 13288.203239440918ms
2022-09-21 14:49:52 INFO  Estimated optimisation runtime saving is 43109.623193740845ms
2022-09-21 14:49:52 INFO  ---RUNTIME: Multi-Query Optimization took 110.93783378601074 ms
2022-09-21 14:49:52 INFO  Executing generated plans
2022-09-21 14:50:10 INFO  ---RUNTIME: Execution took 17904.162645339966 ms
2022-09-21 14:50:10 INFO  Done!
2022-09-21 14:50:10 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-21 14:50:10 INFO  Running instrumented original pipeline...
2022-09-21 14:50:10 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-21 14:50:10 INFO  ---RUNTIME: Importing and monkey-patching took 5.7048797607421875 ms
2022-09-21 14:50:12 INFO  ---RUNTIME: Original pipeline execution took 2354.6371459960938 ms (excluding imports and monkey-patching)
2022-09-21 14:50:12 INFO  Starting execution of 1 what-if analyses...
2022-09-21 14:50:12 INFO  Start plan generation for analysis DataCleaning...
2022-09-21 14:50:12 INFO  ---RUNTIME: Plan generation took 0.7317066192626953 ms
2022-09-21 14:50:12 INFO  Estimated runtime of original DAG is 2126.2969970703125ms
2022-09-21 14:50:12 WARNING Skipping Multi-Query Optimization (instead, only applying patches)
2022-09-21 14:50:12 WARNING Columns ['full_name'] not present in train DAG after the train test split, only before!
2022-09-21 14:50:12 WARNING This could hint at data leakage!
2022-09-21 14:50:12 INFO  Estimated unoptimised what-if runtime is 55155.00545501709ms
2022-09-21 14:50:12 INFO  ---RUNTIME: Multi-Query Optimization took 25.686025619506836 ms
2022-09-21 14:50:12 INFO  Executing generated plans
2022-09-21 14:51:15 INFO  ---RUNTIME: Execution took 62327.27551460266 ms
2022-09-21 14:51:15 INFO  Done!
2022-09-21 14:51:15 INFO  # Finished -- repetition 1 of 7 
2022-09-21 14:51:15 INFO  # Optimization benchmark for data_cleaning with args [['healthcare', 'slow_loading', 'featurization_0', 'neural_network']] -- repetition 2 of 7
2022-09-21 14:51:15 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-21 14:51:15 INFO  Running instrumented original pipeline...
2022-09-21 14:51:15 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-21 14:51:15 INFO  ---RUNTIME: Importing and monkey-patching took 6.017446517944336 ms
2022-09-21 14:51:17 INFO  ---RUNTIME: Original pipeline execution took 2361.69171333313 ms (excluding imports and monkey-patching)
2022-09-21 14:51:17 INFO  Starting execution of 1 what-if analyses...
2022-09-21 14:51:17 INFO  Start plan generation for analysis DataCleaning...
2022-09-21 14:51:17 INFO  ---RUNTIME: Plan generation took 0.7586479187011719 ms
2022-09-21 14:51:17 INFO  Estimated runtime of original DAG is 2135.7741355895996ms
2022-09-21 14:51:17 INFO  Performing Multi-Query Optimization
2022-09-21 14:51:17 INFO  Estimated unoptimized what-if runtime is 55398.354053497314ms
2022-09-21 14:51:17 INFO  Estimated optimised what-if runtime is 13407.46259689331ms
2022-09-21 14:51:17 INFO  Estimated optimisation runtime saving is 41990.891456604004ms
2022-09-21 14:51:17 INFO  ---RUNTIME: Multi-Query Optimization took 113.18206787109375 ms
2022-09-21 14:51:17 INFO  Executing generated plans
2022-09-21 14:51:36 INFO  ---RUNTIME: Execution took 18994.588375091553 ms
2022-09-21 14:51:36 INFO  Done!
2022-09-21 14:51:36 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-21 14:51:36 INFO  Running instrumented original pipeline...
2022-09-21 14:51:36 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-21 14:51:36 INFO  ---RUNTIME: Importing and monkey-patching took 6.130695343017578 ms
2022-09-21 14:51:38 INFO  ---RUNTIME: Original pipeline execution took 2439.755916595459 ms (excluding imports and monkey-patching)
2022-09-21 14:51:38 INFO  Starting execution of 1 what-if analyses...
2022-09-21 14:51:38 INFO  Start plan generation for analysis DataCleaning...
2022-09-21 14:51:38 INFO  ---RUNTIME: Plan generation took 0.7202625274658203 ms
2022-09-21 14:51:38 INFO  Estimated runtime of original DAG is 2205.509662628174ms
2022-09-21 14:51:38 WARNING Skipping Multi-Query Optimization (instead, only applying patches)
2022-09-21 14:51:38 WARNING Columns ['full_name'] not present in train DAG after the train test split, only before!
2022-09-21 14:51:38 WARNING This could hint at data leakage!
2022-09-21 14:51:38 INFO  Estimated unoptimised what-if runtime is 57165.97366333008ms
2022-09-21 14:51:38 INFO  ---RUNTIME: Multi-Query Optimization took 24.0933895111084 ms
2022-09-21 14:51:38 INFO  Executing generated plans
2022-09-21 14:52:41 INFO  ---RUNTIME: Execution took 62615.04149436951 ms
2022-09-21 14:52:41 INFO  Done!
2022-09-21 14:52:41 INFO  # Finished -- repetition 2 of 7 
2022-09-21 14:52:41 INFO  # Optimization benchmark for data_cleaning with args [['healthcare', 'slow_loading', 'featurization_0', 'neural_network']] -- repetition 3 of 7
2022-09-21 14:52:41 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-21 14:52:41 INFO  Running instrumented original pipeline...
2022-09-21 14:52:41 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-21 14:52:41 INFO  ---RUNTIME: Importing and monkey-patching took 6.392478942871094 ms
2022-09-21 14:52:44 INFO  ---RUNTIME: Original pipeline execution took 2726.8455028533936 ms (excluding imports and monkey-patching)
2022-09-21 14:52:44 INFO  Starting execution of 1 what-if analyses...
2022-09-21 14:52:44 INFO  Start plan generation for analysis DataCleaning...
2022-09-21 14:52:44 INFO  ---RUNTIME: Plan generation took 0.8058547973632812 ms
2022-09-21 14:52:44 INFO  Estimated runtime of original DAG is 2498.4219074249268ms
2022-09-21 14:52:44 INFO  Performing Multi-Query Optimization
2022-09-21 14:52:44 INFO  Estimated unoptimized what-if runtime is 64423.62570762634ms
2022-09-21 14:52:44 INFO  Estimated optimised what-if runtime is 13604.589462280273ms
2022-09-21 14:52:44 INFO  Estimated optimisation runtime saving is 50819.03624534607ms
2022-09-21 14:52:44 INFO  ---RUNTIME: Multi-Query Optimization took 112.22481727600098 ms
2022-09-21 14:52:44 INFO  Executing generated plans
2022-09-21 14:53:03 INFO  ---RUNTIME: Execution took 18808.382511138916 ms
2022-09-21 14:53:03 INFO  Done!
2022-09-21 14:53:03 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-21 14:53:03 INFO  Running instrumented original pipeline...
2022-09-21 14:53:03 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-21 14:53:03 INFO  ---RUNTIME: Importing and monkey-patching took 5.844354629516602 ms
2022-09-21 14:53:05 INFO  ---RUNTIME: Original pipeline execution took 2352.428674697876 ms (excluding imports and monkey-patching)
2022-09-21 14:53:05 INFO  Starting execution of 1 what-if analyses...
2022-09-21 14:53:05 INFO  Start plan generation for analysis DataCleaning...
2022-09-21 14:53:05 INFO  ---RUNTIME: Plan generation took 0.7214546203613281 ms
2022-09-21 14:53:05 INFO  Estimated runtime of original DAG is 2122.781991958618ms
2022-09-21 14:53:05 WARNING Skipping Multi-Query Optimization (instead, only applying patches)
2022-09-21 14:53:06 WARNING Columns ['full_name'] not present in train DAG after the train test split, only before!
2022-09-21 14:53:06 WARNING This could hint at data leakage!
2022-09-21 14:53:06 INFO  Estimated unoptimised what-if runtime is 55047.40929603577ms
2022-09-21 14:53:06 INFO  ---RUNTIME: Multi-Query Optimization took 628.6725997924805 ms
2022-09-21 14:53:06 INFO  Executing generated plans
2022-09-21 14:54:08 INFO  ---RUNTIME: Execution took 62331.82740211487 ms
2022-09-21 14:54:08 INFO  Done!
2022-09-21 14:54:08 INFO  # Finished -- repetition 3 of 7 
2022-09-21 14:54:08 INFO  # Optimization benchmark for data_cleaning with args [['healthcare', 'slow_loading', 'featurization_0', 'neural_network']] -- repetition 4 of 7
2022-09-21 14:54:08 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-21 14:54:08 INFO  Running instrumented original pipeline...
2022-09-21 14:54:08 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-21 14:54:08 INFO  ---RUNTIME: Importing and monkey-patching took 6.09898567199707 ms
2022-09-21 14:54:11 INFO  ---RUNTIME: Original pipeline execution took 2454.61106300354 ms (excluding imports and monkey-patching)
2022-09-21 14:54:11 INFO  Starting execution of 1 what-if analyses...
2022-09-21 14:54:11 INFO  Start plan generation for analysis DataCleaning...
2022-09-21 14:54:11 INFO  ---RUNTIME: Plan generation took 0.762939453125 ms
2022-09-21 14:54:11 INFO  Estimated runtime of original DAG is 2219.2513942718506ms
2022-09-21 14:54:11 INFO  Performing Multi-Query Optimization
2022-09-21 14:54:11 INFO  Estimated unoptimized what-if runtime is 57517.68517494202ms
2022-09-21 14:54:11 INFO  Estimated optimised what-if runtime is 13675.883293151855ms
2022-09-21 14:54:11 INFO  Estimated optimisation runtime saving is 43841.80188179016ms
2022-09-21 14:54:11 INFO  ---RUNTIME: Multi-Query Optimization took 112.99562454223633 ms
2022-09-21 14:54:11 INFO  Executing generated plans
2022-09-21 14:54:30 INFO  ---RUNTIME: Execution took 19030.85470199585 ms
2022-09-21 14:54:30 INFO  Done!
2022-09-21 14:54:30 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-21 14:54:30 INFO  Running instrumented original pipeline...
2022-09-21 14:54:30 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-21 14:54:30 INFO  ---RUNTIME: Importing and monkey-patching took 5.815267562866211 ms
2022-09-21 14:54:33 INFO  ---RUNTIME: Original pipeline execution took 3005.573272705078 ms (excluding imports and monkey-patching)
2022-09-21 14:54:33 INFO  Starting execution of 1 what-if analyses...
2022-09-21 14:54:33 INFO  Start plan generation for analysis DataCleaning...
2022-09-21 14:54:33 INFO  ---RUNTIME: Plan generation took 0.6589889526367188 ms
2022-09-21 14:54:33 INFO  Estimated runtime of original DAG is 2778.6788940429688ms
2022-09-21 14:54:33 WARNING Skipping Multi-Query Optimization (instead, only applying patches)
2022-09-21 14:54:33 WARNING Columns ['full_name'] not present in train DAG after the train test split, only before!
2022-09-21 14:54:33 WARNING This could hint at data leakage!
2022-09-21 14:54:33 INFO  Estimated unoptimised what-if runtime is 75050.09984970093ms
2022-09-21 14:54:33 INFO  ---RUNTIME: Multi-Query Optimization took 25.084495544433594 ms
2022-09-21 14:54:33 INFO  Executing generated plans
2022-09-21 14:55:35 INFO  ---RUNTIME: Execution took 62484.296560287476 ms
2022-09-21 14:55:35 INFO  Done!
2022-09-21 14:55:35 INFO  # Finished -- repetition 4 of 7 
2022-09-21 14:55:35 INFO  # Optimization benchmark for data_cleaning with args [['healthcare', 'slow_loading', 'featurization_0', 'neural_network']] -- repetition 5 of 7
2022-09-21 14:55:35 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-21 14:55:35 INFO  Running instrumented original pipeline...
2022-09-21 14:55:35 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-21 14:55:35 INFO  ---RUNTIME: Importing and monkey-patching took 5.972385406494141 ms
2022-09-21 14:55:38 INFO  ---RUNTIME: Original pipeline execution took 2353.25288772583 ms (excluding imports and monkey-patching)
2022-09-21 14:55:38 INFO  Starting execution of 1 what-if analyses...
2022-09-21 14:55:38 INFO  Start plan generation for analysis DataCleaning...
2022-09-21 14:55:38 INFO  ---RUNTIME: Plan generation took 0.7331371307373047 ms
2022-09-21 14:55:38 INFO  Estimated runtime of original DAG is 2124.8691082000732ms
2022-09-21 14:55:38 INFO  Performing Multi-Query Optimization
2022-09-21 14:55:38 INFO  Estimated unoptimized what-if runtime is 55077.10242271423ms
2022-09-21 14:55:38 INFO  Estimated optimised what-if runtime is 13160.76135635376ms
2022-09-21 14:55:38 INFO  Estimated optimisation runtime saving is 41916.34106636047ms
2022-09-21 14:55:38 INFO  ---RUNTIME: Multi-Query Optimization took 113.58356475830078 ms
2022-09-21 14:55:38 INFO  Executing generated plans
2022-09-21 14:55:57 INFO  ---RUNTIME: Execution took 19394.434690475464 ms
2022-09-21 14:55:57 INFO  Done!
2022-09-21 14:55:57 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-21 14:55:57 INFO  Running instrumented original pipeline...
2022-09-21 14:55:57 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-21 14:55:57 INFO  ---RUNTIME: Importing and monkey-patching took 5.95545768737793 ms
2022-09-21 14:55:59 INFO  ---RUNTIME: Original pipeline execution took 2379.974603652954 ms (excluding imports and monkey-patching)
2022-09-21 14:55:59 INFO  Starting execution of 1 what-if analyses...
2022-09-21 14:55:59 INFO  Start plan generation for analysis DataCleaning...
2022-09-21 14:55:59 INFO  ---RUNTIME: Plan generation took 2.3992061614990234 ms
2022-09-21 14:55:59 INFO  Estimated runtime of original DAG is 2147.5281715393066ms
2022-09-21 14:55:59 WARNING Skipping Multi-Query Optimization (instead, only applying patches)
2022-09-21 14:55:59 WARNING Columns ['full_name'] not present in train DAG after the train test split, only before!
2022-09-21 14:55:59 WARNING This could hint at data leakage!
2022-09-21 14:55:59 INFO  Estimated unoptimised what-if runtime is 55672.51110076904ms
2022-09-21 14:55:59 INFO  ---RUNTIME: Multi-Query Optimization took 24.187088012695312 ms
2022-09-21 14:55:59 INFO  Executing generated plans
2022-09-21 14:57:03 INFO  ---RUNTIME: Execution took 63376.66726112366 ms
2022-09-21 14:57:03 INFO  Done!
2022-09-21 14:57:03 INFO  # Finished -- repetition 5 of 7 
2022-09-21 14:57:03 INFO  # Optimization benchmark for data_cleaning with args [['healthcare', 'slow_loading', 'featurization_0', 'neural_network']] -- repetition 6 of 7
2022-09-21 14:57:03 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-21 14:57:03 INFO  Running instrumented original pipeline...
2022-09-21 14:57:03 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-21 14:57:03 INFO  ---RUNTIME: Importing and monkey-patching took 6.595611572265625 ms
2022-09-21 14:57:05 INFO  ---RUNTIME: Original pipeline execution took 2387.251615524292 ms (excluding imports and monkey-patching)
2022-09-21 14:57:05 INFO  Starting execution of 1 what-if analyses...
2022-09-21 14:57:05 INFO  Start plan generation for analysis DataCleaning...
2022-09-21 14:57:05 INFO  ---RUNTIME: Plan generation took 0.7567405700683594 ms
2022-09-21 14:57:05 INFO  Estimated runtime of original DAG is 2154.071569442749ms
2022-09-21 14:57:05 INFO  Performing Multi-Query Optimization
2022-09-21 14:57:06 INFO  Estimated unoptimized what-if runtime is 55823.3745098114ms
2022-09-21 14:57:06 INFO  Estimated optimised what-if runtime is 13321.415901184082ms
2022-09-21 14:57:06 INFO  Estimated optimisation runtime saving is 42501.95860862732ms
2022-09-21 14:57:06 INFO  ---RUNTIME: Multi-Query Optimization took 466.56298637390137 ms
2022-09-21 14:57:06 INFO  Executing generated plans
2022-09-21 14:57:25 INFO  ---RUNTIME: Execution took 19380.377531051636 ms
2022-09-21 14:57:25 INFO  Done!
2022-09-21 14:57:25 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-21 14:57:25 INFO  Running instrumented original pipeline...
2022-09-21 14:57:25 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-21 14:57:25 INFO  ---RUNTIME: Importing and monkey-patching took 6.402254104614258 ms
2022-09-21 14:57:28 INFO  ---RUNTIME: Original pipeline execution took 2482.898235321045 ms (excluding imports and monkey-patching)
2022-09-21 14:57:28 INFO  Starting execution of 1 what-if analyses...
2022-09-21 14:57:28 INFO  Start plan generation for analysis DataCleaning...
2022-09-21 14:57:28 INFO  ---RUNTIME: Plan generation took 0.7460117340087891 ms
2022-09-21 14:57:28 INFO  Estimated runtime of original DAG is 2247.253894805908ms
2022-09-21 14:57:28 WARNING Skipping Multi-Query Optimization (instead, only applying patches)
2022-09-21 14:57:28 WARNING Columns ['full_name'] not present in train DAG after the train test split, only before!
2022-09-21 14:57:28 WARNING This could hint at data leakage!
2022-09-21 14:57:28 INFO  Estimated unoptimised what-if runtime is 58215.776443481445ms
2022-09-21 14:57:28 INFO  ---RUNTIME: Multi-Query Optimization took 24.345874786376953 ms
2022-09-21 14:57:28 INFO  Executing generated plans
2022-09-21 14:58:31 INFO  ---RUNTIME: Execution took 62955.713510513306 ms
2022-09-21 14:58:31 INFO  Done!
2022-09-21 14:58:31 INFO  # Finished -- repetition 6 of 7 
2022-09-21 14:58:31 INFO  # Optimization benchmark for data_cleaning with args [['healthcare', 'slow_loading', 'featurization_0', 'neural_network']] -- repetition 7 of 7
2022-09-21 14:58:31 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-21 14:58:31 INFO  Running instrumented original pipeline...
2022-09-21 14:58:31 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-21 14:58:31 INFO  ---RUNTIME: Importing and monkey-patching took 6.497621536254883 ms
2022-09-21 14:58:33 INFO  ---RUNTIME: Original pipeline execution took 2364.682674407959 ms (excluding imports and monkey-patching)
2022-09-21 14:58:33 INFO  Starting execution of 1 what-if analyses...
2022-09-21 14:58:33 INFO  Start plan generation for analysis DataCleaning...
2022-09-21 14:58:33 INFO  ---RUNTIME: Plan generation took 0.7386207580566406 ms
2022-09-21 14:58:33 INFO  Estimated runtime of original DAG is 2137.2294425964355ms
2022-09-21 14:58:33 INFO  Performing Multi-Query Optimization
2022-09-21 14:58:33 INFO  Estimated unoptimized what-if runtime is 55414.70384597778ms
2022-09-21 14:58:33 INFO  Estimated optimised what-if runtime is 13346.271753311157ms
2022-09-21 14:58:33 INFO  Estimated optimisation runtime saving is 42068.432092666626ms
2022-09-21 14:58:33 INFO  ---RUNTIME: Multi-Query Optimization took 111.27376556396484 ms
2022-09-21 14:58:33 INFO  Executing generated plans
2022-09-21 14:58:52 INFO  ---RUNTIME: Execution took 19309.90433692932 ms
2022-09-21 14:58:52 INFO  Done!
2022-09-21 14:58:52 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-21 14:58:52 INFO  Running instrumented original pipeline...
2022-09-21 14:58:52 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-21 14:58:52 INFO  ---RUNTIME: Importing and monkey-patching took 6.008148193359375 ms
2022-09-21 14:58:55 INFO  ---RUNTIME: Original pipeline execution took 2366.830587387085 ms (excluding imports and monkey-patching)
2022-09-21 14:58:55 INFO  Starting execution of 1 what-if analyses...
2022-09-21 14:58:55 INFO  Start plan generation for analysis DataCleaning...
2022-09-21 14:58:55 INFO  ---RUNTIME: Plan generation took 0.7727146148681641 ms
2022-09-21 14:58:55 INFO  Estimated runtime of original DAG is 2141.29638671875ms
2022-09-21 14:58:55 WARNING Skipping Multi-Query Optimization (instead, only applying patches)
2022-09-21 14:58:55 WARNING Columns ['full_name'] not present in train DAG after the train test split, only before!
2022-09-21 14:58:55 WARNING This could hint at data leakage!
2022-09-21 14:58:55 INFO  Estimated unoptimised what-if runtime is 55497.05696105957ms
2022-09-21 14:58:55 INFO  ---RUNTIME: Multi-Query Optimization took 25.28667449951172 ms
2022-09-21 14:58:55 INFO  Executing generated plans
2022-09-21 14:59:58 INFO  ---RUNTIME: Execution took 63129.56190109253 ms
2022-09-21 14:59:58 INFO  Done!
2022-09-21 14:59:58 INFO  # Finished -- repetition 7 of 7 
2022-09-21 14:59:58 INFO  # Final results after all repetitions
2022-09-21 14:59:58 INFO     repetition  ... no_opt_what_if_execution_combined_model_training
0           0  ...                                     15485.198021
1           1  ...                                     15544.172287
2           2  ...                                     14501.628876
3           3  ...                                     15697.122335
4           4  ...                                     16555.349350
5           5  ...                                     14913.350344
6           6  ...                                     15251.138926

[7 rows x 26 columns]
taskset -c 128-135 PROTOCOL_BUFFERS_PYTHON_IMPLEMENTATION=python python3.9 benchmarks_end_to_end.py data_cleaning healthcare slow_loading featurization_1 logistic_regression
2022-09-21 15:00:00.858916: W tensorflow/stream_executor/platform/default/dso_loader.cc:64] Could not load dynamic library 'libcudart.so.11.0'; dlerror: libcudart.so.11.0: cannot open shared object file: No such file or directory; LD_LIBRARY_PATH: /home/sgrafbe/mlwhatif/venv/lib/python3.9/site-packages/cv2/../../lib64:
2022-09-21 15:00:00.858962: I tensorflow/stream_executor/cuda/cudart_stub.cc:29] Ignore above cudart dlerror if you do not have a GPU set up on your machine.
2022-09-21 15:00:02 INFO  Patching sys.argv with ['mlwhatif', 'healthcare', 'slow_loading', 'featurization_1', 'logistic_regression']
2022-09-21 15:00:02 INFO  Running instrumented original pipeline...
2022-09-21 15:00:02 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-21 15:00:02 INFO  ---RUNTIME: Importing and monkey-patching took 95.11208534240723 ms
2022-09-21 15:00:04 INFO  ---RUNTIME: Original pipeline execution took 2093.2860374450684 ms (excluding imports and monkey-patching)
2022-09-21 15:00:04 INFO  Starting execution of 0 what-if analyses...
2022-09-21 15:00:04 INFO  Estimated runtime of original DAG is 1804.898977279663ms
2022-09-21 15:00:04 INFO  Performing Multi-Query Optimization
2022-09-21 15:00:04 INFO  Estimated unoptimized what-if runtime is 0ms
2022-09-21 15:00:04 INFO  Estimated optimised what-if runtime is 0ms
2022-09-21 15:00:04 INFO  Estimated optimisation runtime saving is 0ms
2022-09-21 15:00:04 INFO  ---RUNTIME: Multi-Query Optimization took 0.4875659942626953 ms
2022-09-21 15:00:04 INFO  Executing generated plans
2022-09-21 15:00:04 INFO  ---RUNTIME: Execution took 0.022411346435546875 ms
2022-09-21 15:00:04 INFO  Done!
2022-09-21 15:00:04 INFO  # Optimization benchmark for data_cleaning with args [['healthcare', 'slow_loading', 'featurization_1', 'logistic_regression']] -- repetition 1 of 7
2022-09-21 15:00:04 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-21 15:00:04 INFO  Running instrumented original pipeline...
2022-09-21 15:00:04 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-21 15:00:04 INFO  ---RUNTIME: Importing and monkey-patching took 5.161523818969727 ms
2022-09-21 15:00:06 INFO  ---RUNTIME: Original pipeline execution took 2071.6946125030518 ms (excluding imports and monkey-patching)
2022-09-21 15:00:06 INFO  Starting execution of 1 what-if analyses...
2022-09-21 15:00:06 INFO  Start plan generation for analysis DataCleaning...
2022-09-21 15:00:06 INFO  ---RUNTIME: Plan generation took 0.7686614990234375 ms
2022-09-21 15:00:06 INFO  Estimated runtime of original DAG is 1816.4148330688477ms
2022-09-21 15:00:06 INFO  Performing Multi-Query Optimization
2022-09-21 15:00:06 INFO  Estimated unoptimized what-if runtime is 45417.3789024353ms
2022-09-21 15:00:06 INFO  Estimated optimised what-if runtime is 2006.1888694763184ms
2022-09-21 15:00:06 INFO  Estimated optimisation runtime saving is 43411.190032958984ms
2022-09-21 15:00:06 INFO  ---RUNTIME: Multi-Query Optimization took 121.05059623718262 ms
2022-09-21 15:00:06 INFO  Executing generated plans
2022-09-21 15:00:12 INFO  ---RUNTIME: Execution took 5848.023176193237 ms
2022-09-21 15:00:12 INFO  Done!
2022-09-21 15:00:12 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-21 15:00:12 INFO  Running instrumented original pipeline...
2022-09-21 15:00:12 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-21 15:00:12 INFO  ---RUNTIME: Importing and monkey-patching took 6.606817245483398 ms
2022-09-21 15:00:14 INFO  ---RUNTIME: Original pipeline execution took 2098.717212677002 ms (excluding imports and monkey-patching)
2022-09-21 15:00:14 INFO  Starting execution of 1 what-if analyses...
2022-09-21 15:00:14 INFO  Start plan generation for analysis DataCleaning...
2022-09-21 15:00:14 INFO  ---RUNTIME: Plan generation took 0.7708072662353516 ms
2022-09-21 15:00:14 INFO  Estimated runtime of original DAG is 1837.2271060943604ms
2022-09-21 15:00:14 WARNING Skipping Multi-Query Optimization (instead, only applying patches)
2022-09-21 15:00:14 WARNING Columns ['full_name'] not present in train DAG after the train test split, only before!
2022-09-21 15:00:14 WARNING This could hint at data leakage!
2022-09-21 15:00:14 INFO  Estimated unoptimised what-if runtime is 45937.71576881409ms
2022-09-21 15:00:14 INFO  ---RUNTIME: Multi-Query Optimization took 27.99510955810547 ms
2022-09-21 15:00:14 INFO  Executing generated plans
2022-09-21 15:01:04 INFO  ---RUNTIME: Execution took 49931.97011947632 ms
2022-09-21 15:01:04 INFO  Done!
2022-09-21 15:01:04 INFO  # Finished -- repetition 1 of 7 
2022-09-21 15:01:04 INFO  # Optimization benchmark for data_cleaning with args [['healthcare', 'slow_loading', 'featurization_1', 'logistic_regression']] -- repetition 2 of 7
2022-09-21 15:01:04 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-21 15:01:04 INFO  Running instrumented original pipeline...
2022-09-21 15:01:04 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-21 15:01:04 INFO  ---RUNTIME: Importing and monkey-patching took 6.299018859863281 ms
2022-09-21 15:01:06 INFO  ---RUNTIME: Original pipeline execution took 2082.298994064331 ms (excluding imports and monkey-patching)
2022-09-21 15:01:06 INFO  Starting execution of 1 what-if analyses...
2022-09-21 15:01:06 INFO  Start plan generation for analysis DataCleaning...
2022-09-21 15:01:06 INFO  ---RUNTIME: Plan generation took 0.7646083831787109 ms
2022-09-21 15:01:06 INFO  Estimated runtime of original DAG is 1822.591781616211ms
2022-09-21 15:01:06 INFO  Performing Multi-Query Optimization
2022-09-21 15:01:06 INFO  Estimated unoptimized what-if runtime is 45571.91562652588ms
2022-09-21 15:01:06 INFO  Estimated optimised what-if runtime is 2011.0077857971191ms
2022-09-21 15:01:06 INFO  Estimated optimisation runtime saving is 43560.90784072876ms
2022-09-21 15:01:06 INFO  ---RUNTIME: Multi-Query Optimization took 126.13296508789062 ms
2022-09-21 15:01:06 INFO  Executing generated plans
2022-09-21 15:01:12 INFO  ---RUNTIME: Execution took 5851.90749168396 ms
2022-09-21 15:01:12 INFO  Done!
2022-09-21 15:01:12 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-21 15:01:12 INFO  Running instrumented original pipeline...
2022-09-21 15:01:12 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-21 15:01:12 INFO  ---RUNTIME: Importing and monkey-patching took 6.134271621704102 ms
2022-09-21 15:01:14 INFO  ---RUNTIME: Original pipeline execution took 2011.448621749878 ms (excluding imports and monkey-patching)
2022-09-21 15:01:14 INFO  Starting execution of 1 what-if analyses...
2022-09-21 15:01:14 INFO  Start plan generation for analysis DataCleaning...
2022-09-21 15:01:14 INFO  ---RUNTIME: Plan generation took 0.7488727569580078 ms
2022-09-21 15:01:14 INFO  Estimated runtime of original DAG is 1760.3111267089844ms
2022-09-21 15:01:14 WARNING Skipping Multi-Query Optimization (instead, only applying patches)
2022-09-21 15:01:14 WARNING Columns ['full_name'] not present in train DAG after the train test split, only before!
2022-09-21 15:01:14 WARNING This could hint at data leakage!
2022-09-21 15:01:14 INFO  Estimated unoptimised what-if runtime is 44014.65034484863ms
2022-09-21 15:01:14 INFO  ---RUNTIME: Multi-Query Optimization took 26.596546173095703 ms
2022-09-21 15:01:14 INFO  Executing generated plans
2022-09-21 15:02:02 INFO  ---RUNTIME: Execution took 48367.0380115509 ms
2022-09-21 15:02:02 INFO  Done!
2022-09-21 15:02:02 INFO  # Finished -- repetition 2 of 7 
2022-09-21 15:02:02 INFO  # Optimization benchmark for data_cleaning with args [['healthcare', 'slow_loading', 'featurization_1', 'logistic_regression']] -- repetition 3 of 7
2022-09-21 15:02:02 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-21 15:02:02 INFO  Running instrumented original pipeline...
2022-09-21 15:02:02 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-21 15:02:02 INFO  ---RUNTIME: Importing and monkey-patching took 5.923032760620117 ms
2022-09-21 15:02:04 INFO  ---RUNTIME: Original pipeline execution took 2018.8994407653809 ms (excluding imports and monkey-patching)
2022-09-21 15:02:04 INFO  Starting execution of 1 what-if analyses...
2022-09-21 15:02:04 INFO  Start plan generation for analysis DataCleaning...
2022-09-21 15:02:04 INFO  ---RUNTIME: Plan generation took 0.7631778717041016 ms
2022-09-21 15:02:04 INFO  Estimated runtime of original DAG is 1767.580509185791ms
2022-09-21 15:02:04 INFO  Performing Multi-Query Optimization
2022-09-21 15:02:05 INFO  Estimated unoptimized what-if runtime is 44196.49791717529ms
2022-09-21 15:02:05 INFO  Estimated optimised what-if runtime is 1951.1160850524902ms
2022-09-21 15:02:05 INFO  Estimated optimisation runtime saving is 42245.3818321228ms
2022-09-21 15:02:05 INFO  ---RUNTIME: Multi-Query Optimization took 119.20571327209473 ms
2022-09-21 15:02:05 INFO  Executing generated plans
2022-09-21 15:02:10 INFO  ---RUNTIME: Execution took 5755.622625350952 ms
2022-09-21 15:02:10 INFO  Done!
2022-09-21 15:02:10 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-21 15:02:10 INFO  Running instrumented original pipeline...
2022-09-21 15:02:10 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-21 15:02:10 INFO  ---RUNTIME: Importing and monkey-patching took 6.170511245727539 ms
2022-09-21 15:02:12 INFO  ---RUNTIME: Original pipeline execution took 2031.067132949829 ms (excluding imports and monkey-patching)
2022-09-21 15:02:12 INFO  Starting execution of 1 what-if analyses...
2022-09-21 15:02:12 INFO  Start plan generation for analysis DataCleaning...
2022-09-21 15:02:12 INFO  ---RUNTIME: Plan generation took 0.7429122924804688 ms
2022-09-21 15:02:12 INFO  Estimated runtime of original DAG is 1779.4430255889893ms
2022-09-21 15:02:12 WARNING Skipping Multi-Query Optimization (instead, only applying patches)
2022-09-21 15:02:12 WARNING Columns ['full_name'] not present in train DAG after the train test split, only before!
2022-09-21 15:02:12 WARNING This could hint at data leakage!
2022-09-21 15:02:12 INFO  Estimated unoptimised what-if runtime is 44493.01791191101ms
2022-09-21 15:02:12 INFO  ---RUNTIME: Multi-Query Optimization took 26.058197021484375 ms
2022-09-21 15:02:12 INFO  Executing generated plans
2022-09-21 15:03:01 INFO  ---RUNTIME: Execution took 48536.45849227905 ms
2022-09-21 15:03:01 INFO  Done!
2022-09-21 15:03:01 INFO  # Finished -- repetition 3 of 7 
2022-09-21 15:03:01 INFO  # Optimization benchmark for data_cleaning with args [['healthcare', 'slow_loading', 'featurization_1', 'logistic_regression']] -- repetition 4 of 7
2022-09-21 15:03:01 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-21 15:03:01 INFO  Running instrumented original pipeline...
2022-09-21 15:03:01 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-21 15:03:01 INFO  ---RUNTIME: Importing and monkey-patching took 6.427764892578125 ms
2022-09-21 15:03:03 INFO  ---RUNTIME: Original pipeline execution took 2200.70481300354 ms (excluding imports and monkey-patching)
2022-09-21 15:03:03 INFO  Starting execution of 1 what-if analyses...
2022-09-21 15:03:03 INFO  Start plan generation for analysis DataCleaning...
2022-09-21 15:03:03 INFO  ---RUNTIME: Plan generation took 0.7255077362060547 ms
2022-09-21 15:03:03 INFO  Estimated runtime of original DAG is 1764.7483348846436ms
2022-09-21 15:03:03 INFO  Performing Multi-Query Optimization
2022-09-21 15:03:03 INFO  Estimated unoptimized what-if runtime is 44125.7107257843ms
2022-09-21 15:03:03 INFO  Estimated optimised what-if runtime is 1948.8372802734375ms
2022-09-21 15:03:03 INFO  Estimated optimisation runtime saving is 42176.873445510864ms
2022-09-21 15:03:03 INFO  ---RUNTIME: Multi-Query Optimization took 119.110107421875 ms
2022-09-21 15:03:03 INFO  Executing generated plans
2022-09-21 15:03:09 INFO  ---RUNTIME: Execution took 5747.910022735596 ms
2022-09-21 15:03:09 INFO  Done!
2022-09-21 15:03:09 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-21 15:03:09 INFO  Running instrumented original pipeline...
2022-09-21 15:03:09 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-21 15:03:09 INFO  ---RUNTIME: Importing and monkey-patching took 6.106138229370117 ms
2022-09-21 15:03:11 INFO  ---RUNTIME: Original pipeline execution took 2004.7693252563477 ms (excluding imports and monkey-patching)
2022-09-21 15:03:11 INFO  Starting execution of 1 what-if analyses...
2022-09-21 15:03:11 INFO  Start plan generation for analysis DataCleaning...
2022-09-21 15:03:11 INFO  ---RUNTIME: Plan generation took 0.7431507110595703 ms
2022-09-21 15:03:11 INFO  Estimated runtime of original DAG is 1752.3863315582275ms
2022-09-21 15:03:11 WARNING Skipping Multi-Query Optimization (instead, only applying patches)
2022-09-21 15:03:11 WARNING Columns ['full_name'] not present in train DAG after the train test split, only before!
2022-09-21 15:03:11 WARNING This could hint at data leakage!
2022-09-21 15:03:11 INFO  Estimated unoptimised what-if runtime is 43816.52331352234ms
2022-09-21 15:03:11 INFO  ---RUNTIME: Multi-Query Optimization took 26.115894317626953 ms
2022-09-21 15:03:11 INFO  Executing generated plans
2022-09-21 15:03:59 INFO  ---RUNTIME: Execution took 48257.23123550415 ms
2022-09-21 15:03:59 INFO  Done!
2022-09-21 15:03:59 INFO  # Finished -- repetition 4 of 7 
2022-09-21 15:03:59 INFO  # Optimization benchmark for data_cleaning with args [['healthcare', 'slow_loading', 'featurization_1', 'logistic_regression']] -- repetition 5 of 7
2022-09-21 15:03:59 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-21 15:03:59 INFO  Running instrumented original pipeline...
2022-09-21 15:03:59 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-21 15:03:59 INFO  ---RUNTIME: Importing and monkey-patching took 6.044149398803711 ms
2022-09-21 15:04:01 INFO  ---RUNTIME: Original pipeline execution took 2020.399808883667 ms (excluding imports and monkey-patching)
2022-09-21 15:04:01 INFO  Starting execution of 1 what-if analyses...
2022-09-21 15:04:01 INFO  Start plan generation for analysis DataCleaning...
2022-09-21 15:04:01 INFO  ---RUNTIME: Plan generation took 0.7481575012207031 ms
2022-09-21 15:04:01 INFO  Estimated runtime of original DAG is 1768.205165863037ms
2022-09-21 15:04:01 INFO  Performing Multi-Query Optimization
2022-09-21 15:04:01 INFO  Estimated unoptimized what-if runtime is 44212.03565597534ms
2022-09-21 15:04:01 INFO  Estimated optimised what-if runtime is 1950.852870941162ms
2022-09-21 15:04:01 INFO  Estimated optimisation runtime saving is 42261.18278503418ms
2022-09-21 15:04:01 INFO  ---RUNTIME: Multi-Query Optimization took 119.71282958984375 ms
2022-09-21 15:04:01 INFO  Executing generated plans
2022-09-21 15:04:07 INFO  ---RUNTIME: Execution took 5798.975229263306 ms
2022-09-21 15:04:07 INFO  Done!
2022-09-21 15:04:07 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-21 15:04:07 INFO  Running instrumented original pipeline...
2022-09-21 15:04:07 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-21 15:04:07 INFO  ---RUNTIME: Importing and monkey-patching took 6.140708923339844 ms
2022-09-21 15:04:09 INFO  ---RUNTIME: Original pipeline execution took 2208.190679550171 ms (excluding imports and monkey-patching)
2022-09-21 15:04:09 INFO  Starting execution of 1 what-if analyses...
2022-09-21 15:04:09 INFO  Start plan generation for analysis DataCleaning...
2022-09-21 15:04:09 INFO  ---RUNTIME: Plan generation took 0.9446144104003906 ms
2022-09-21 15:04:09 INFO  Estimated runtime of original DAG is 1955.1222324371338ms
2022-09-21 15:04:09 WARNING Skipping Multi-Query Optimization (instead, only applying patches)
2022-09-21 15:04:09 WARNING Columns ['full_name'] not present in train DAG after the train test split, only before!
2022-09-21 15:04:09 WARNING This could hint at data leakage!
2022-09-21 15:04:09 INFO  Estimated unoptimised what-if runtime is 48885.09106636047ms
2022-09-21 15:04:09 INFO  ---RUNTIME: Multi-Query Optimization took 26.356220245361328 ms
2022-09-21 15:04:09 INFO  Executing generated plans
2022-09-21 15:04:58 INFO  ---RUNTIME: Execution took 48832.99493789673 ms
2022-09-21 15:04:58 INFO  Done!
2022-09-21 15:04:58 INFO  # Finished -- repetition 5 of 7 
2022-09-21 15:04:58 INFO  # Optimization benchmark for data_cleaning with args [['healthcare', 'slow_loading', 'featurization_1', 'logistic_regression']] -- repetition 6 of 7
2022-09-21 15:04:58 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-21 15:04:58 INFO  Running instrumented original pipeline...
2022-09-21 15:04:58 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-21 15:04:58 INFO  ---RUNTIME: Importing and monkey-patching took 6.09135627746582 ms
2022-09-21 15:05:00 INFO  ---RUNTIME: Original pipeline execution took 2042.9801940917969 ms (excluding imports and monkey-patching)
2022-09-21 15:05:00 INFO  Starting execution of 1 what-if analyses...
2022-09-21 15:05:00 INFO  Start plan generation for analysis DataCleaning...
2022-09-21 15:05:00 INFO  ---RUNTIME: Plan generation took 0.7712841033935547 ms
2022-09-21 15:05:00 INFO  Estimated runtime of original DAG is 1791.8331623077393ms
2022-09-21 15:05:00 INFO  Performing Multi-Query Optimization
2022-09-21 15:05:00 INFO  Estimated unoptimized what-if runtime is 44802.73127555847ms
2022-09-21 15:05:00 INFO  Estimated optimised what-if runtime is 1973.4532833099365ms
2022-09-21 15:05:00 INFO  Estimated optimisation runtime saving is 42829.277992248535ms
2022-09-21 15:05:00 INFO  ---RUNTIME: Multi-Query Optimization took 119.10796165466309 ms
2022-09-21 15:05:00 INFO  Executing generated plans
2022-09-21 15:05:06 INFO  ---RUNTIME: Execution took 5837.065696716309 ms
2022-09-21 15:05:06 INFO  Done!
2022-09-21 15:05:06 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-21 15:05:06 INFO  Running instrumented original pipeline...
2022-09-21 15:05:06 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-21 15:05:06 INFO  ---RUNTIME: Importing and monkey-patching took 6.308078765869141 ms
2022-09-21 15:05:08 INFO  ---RUNTIME: Original pipeline execution took 2034.9655151367188 ms (excluding imports and monkey-patching)
2022-09-21 15:05:08 INFO  Starting execution of 1 what-if analyses...
2022-09-21 15:05:08 INFO  Start plan generation for analysis DataCleaning...
2022-09-21 15:05:08 INFO  ---RUNTIME: Plan generation took 0.7312297821044922 ms
2022-09-21 15:05:08 INFO  Estimated runtime of original DAG is 1784.4951152801514ms
2022-09-21 15:05:08 WARNING Skipping Multi-Query Optimization (instead, only applying patches)
2022-09-21 15:05:08 WARNING Columns ['full_name'] not present in train DAG after the train test split, only before!
2022-09-21 15:05:08 WARNING This could hint at data leakage!
2022-09-21 15:05:08 INFO  Estimated unoptimised what-if runtime is 44619.27008628845ms
2022-09-21 15:05:08 INFO  ---RUNTIME: Multi-Query Optimization took 26.31092071533203 ms
2022-09-21 15:05:08 INFO  Executing generated plans
2022-09-21 15:05:57 INFO  ---RUNTIME: Execution took 49075.76274871826 ms
2022-09-21 15:05:57 INFO  Done!
2022-09-21 15:05:57 INFO  # Finished -- repetition 6 of 7 
2022-09-21 15:05:57 INFO  # Optimization benchmark for data_cleaning with args [['healthcare', 'slow_loading', 'featurization_1', 'logistic_regression']] -- repetition 7 of 7
2022-09-21 15:05:57 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-21 15:05:57 INFO  Running instrumented original pipeline...
2022-09-21 15:05:58 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-21 15:05:58 INFO  ---RUNTIME: Importing and monkey-patching took 6.280183792114258 ms
2022-09-21 15:06:00 INFO  ---RUNTIME: Original pipeline execution took 2320.3136920928955 ms (excluding imports and monkey-patching)
2022-09-21 15:06:00 INFO  Starting execution of 1 what-if analyses...
2022-09-21 15:06:00 INFO  Start plan generation for analysis DataCleaning...
2022-09-21 15:06:00 INFO  ---RUNTIME: Plan generation took 0.7257461547851562 ms
2022-09-21 15:06:00 INFO  Estimated runtime of original DAG is 1846.2367057800293ms
2022-09-21 15:06:00 INFO  Performing Multi-Query Optimization
2022-09-21 15:06:00 INFO  Estimated unoptimized what-if runtime is 46162.882804870605ms
2022-09-21 15:06:00 INFO  Estimated optimised what-if runtime is 2038.5799407958984ms
2022-09-21 15:06:00 INFO  Estimated optimisation runtime saving is 44124.30286407471ms
2022-09-21 15:06:00 INFO  ---RUNTIME: Multi-Query Optimization took 127.80427932739258 ms
2022-09-21 15:06:00 INFO  Executing generated plans
2022-09-21 15:06:06 INFO  ---RUNTIME: Execution took 6111.782073974609 ms
2022-09-21 15:06:06 INFO  Done!
2022-09-21 15:06:06 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-21 15:06:06 INFO  Running instrumented original pipeline...
2022-09-21 15:06:06 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-21 15:06:06 INFO  ---RUNTIME: Importing and monkey-patching took 6.372928619384766 ms
2022-09-21 15:06:08 INFO  ---RUNTIME: Original pipeline execution took 2103.754997253418 ms (excluding imports and monkey-patching)
2022-09-21 15:06:08 INFO  Starting execution of 1 what-if analyses...
2022-09-21 15:06:08 INFO  Start plan generation for analysis DataCleaning...
2022-09-21 15:06:08 INFO  ---RUNTIME: Plan generation took 0.7534027099609375 ms
2022-09-21 15:06:08 INFO  Estimated runtime of original DAG is 1842.7510261535645ms
2022-09-21 15:06:08 WARNING Skipping Multi-Query Optimization (instead, only applying patches)
2022-09-21 15:06:08 WARNING Columns ['full_name'] not present in train DAG after the train test split, only before!
2022-09-21 15:06:08 WARNING This could hint at data leakage!
2022-09-21 15:06:08 INFO  Estimated unoptimised what-if runtime is 46076.00259780884ms
2022-09-21 15:06:08 INFO  ---RUNTIME: Multi-Query Optimization took 27.886390686035156 ms
2022-09-21 15:06:08 INFO  Executing generated plans
2022-09-21 15:06:58 INFO  ---RUNTIME: Execution took 50177.98161506653 ms
2022-09-21 15:06:58 INFO  Done!
2022-09-21 15:06:58 INFO  # Finished -- repetition 7 of 7 
2022-09-21 15:06:58 INFO  # Final results after all repetitions
2022-09-21 15:06:58 INFO     repetition  ... no_opt_what_if_execution_combined_model_training
0           0  ...                                      2901.135445
1           1  ...                                      2945.280790
2           2  ...                                      3006.596565
3           3  ...                                      3057.795763
4           4  ...                                      3066.050291
5           5  ...                                      3167.975426
6           6  ...                                      3330.153465

[7 rows x 26 columns]
taskset -c 128-135 PROTOCOL_BUFFERS_PYTHON_IMPLEMENTATION=python python3.9 benchmarks_end_to_end.py data_cleaning healthcare slow_loading featurization_1 xgboost
2022-09-21 15:07:01.014617: W tensorflow/stream_executor/platform/default/dso_loader.cc:64] Could not load dynamic library 'libcudart.so.11.0'; dlerror: libcudart.so.11.0: cannot open shared object file: No such file or directory; LD_LIBRARY_PATH: /home/sgrafbe/mlwhatif/venv/lib/python3.9/site-packages/cv2/../../lib64:
2022-09-21 15:07:01.014662: I tensorflow/stream_executor/cuda/cudart_stub.cc:29] Ignore above cudart dlerror if you do not have a GPU set up on your machine.
2022-09-21 15:07:02 INFO  Patching sys.argv with ['mlwhatif', 'healthcare', 'slow_loading', 'featurization_1', 'xgboost']
2022-09-21 15:07:02 INFO  Running instrumented original pipeline...
2022-09-21 15:07:02 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-21 15:07:02 INFO  ---RUNTIME: Importing and monkey-patching took 95.65114974975586 ms
2022-09-21 15:07:06 INFO  ---RUNTIME: Original pipeline execution took 4489.203691482544 ms (excluding imports and monkey-patching)
2022-09-21 15:07:06 INFO  Starting execution of 0 what-if analyses...
2022-09-21 15:07:06 INFO  Estimated runtime of original DAG is 4188.451051712036ms
2022-09-21 15:07:06 INFO  Performing Multi-Query Optimization
2022-09-21 15:07:06 INFO  Estimated unoptimized what-if runtime is 0ms
2022-09-21 15:07:06 INFO  Estimated optimised what-if runtime is 0ms
2022-09-21 15:07:06 INFO  Estimated optimisation runtime saving is 0ms
2022-09-21 15:07:06 INFO  ---RUNTIME: Multi-Query Optimization took 0.7238388061523438 ms
2022-09-21 15:07:06 INFO  Executing generated plans
2022-09-21 15:07:06 INFO  ---RUNTIME: Execution took 0.03361701965332031 ms
2022-09-21 15:07:06 INFO  Done!
2022-09-21 15:07:06 INFO  # Optimization benchmark for data_cleaning with args [['healthcare', 'slow_loading', 'featurization_1', 'xgboost']] -- repetition 1 of 7
2022-09-21 15:07:06 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-21 15:07:06 INFO  Running instrumented original pipeline...
2022-09-21 15:07:06 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-21 15:07:06 INFO  ---RUNTIME: Importing and monkey-patching took 5.161046981811523 ms
2022-09-21 15:07:09 INFO  ---RUNTIME: Original pipeline execution took 2233.6690425872803 ms (excluding imports and monkey-patching)
2022-09-21 15:07:09 INFO  Starting execution of 1 what-if analyses...
2022-09-21 15:07:09 INFO  Start plan generation for analysis DataCleaning...
2022-09-21 15:07:09 INFO  ---RUNTIME: Plan generation took 0.8759498596191406 ms
2022-09-21 15:07:09 INFO  Estimated runtime of original DAG is 1963.4997844696045ms
2022-09-21 15:07:09 INFO  Performing Multi-Query Optimization
2022-09-21 15:07:09 INFO  Estimated unoptimized what-if runtime is 50219.88892555237ms
2022-09-21 15:07:09 INFO  Estimated optimised what-if runtime is 7824.256896972656ms
2022-09-21 15:07:09 INFO  Estimated optimisation runtime saving is 42395.63202857971ms
2022-09-21 15:07:09 INFO  ---RUNTIME: Multi-Query Optimization took 127.1824836730957 ms
2022-09-21 15:07:09 INFO  Executing generated plans
2022-09-21 15:07:20 INFO  ---RUNTIME: Execution took 11417.227745056152 ms
2022-09-21 15:07:20 INFO  Done!
2022-09-21 15:07:20 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-21 15:07:20 INFO  Running instrumented original pipeline...
2022-09-21 15:07:20 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-21 15:07:20 INFO  ---RUNTIME: Importing and monkey-patching took 6.395816802978516 ms
2022-09-21 15:07:22 INFO  ---RUNTIME: Original pipeline execution took 2213.3686542510986 ms (excluding imports and monkey-patching)
2022-09-21 15:07:22 INFO  Starting execution of 1 what-if analyses...
2022-09-21 15:07:22 INFO  Start plan generation for analysis DataCleaning...
2022-09-21 15:07:22 INFO  ---RUNTIME: Plan generation took 0.7455348968505859 ms
2022-09-21 15:07:22 INFO  Estimated runtime of original DAG is 1959.9180221557617ms
2022-09-21 15:07:22 WARNING Skipping Multi-Query Optimization (instead, only applying patches)
2022-09-21 15:07:22 WARNING Columns ['full_name'] not present in train DAG after the train test split, only before!
2022-09-21 15:07:22 WARNING This could hint at data leakage!
2022-09-21 15:07:22 INFO  Estimated unoptimised what-if runtime is 50122.70450592041ms
2022-09-21 15:07:22 INFO  ---RUNTIME: Multi-Query Optimization took 26.621103286743164 ms
2022-09-21 15:07:22 INFO  Executing generated plans
2022-09-21 15:08:17 INFO  ---RUNTIME: Execution took 54140.09952545166 ms
2022-09-21 15:08:17 INFO  Done!
2022-09-21 15:08:17 INFO  # Finished -- repetition 1 of 7 
2022-09-21 15:08:17 INFO  # Optimization benchmark for data_cleaning with args [['healthcare', 'slow_loading', 'featurization_1', 'xgboost']] -- repetition 2 of 7
2022-09-21 15:08:17 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-21 15:08:17 INFO  Running instrumented original pipeline...
2022-09-21 15:08:17 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-21 15:08:17 INFO  ---RUNTIME: Importing and monkey-patching took 6.175994873046875 ms
2022-09-21 15:08:19 INFO  ---RUNTIME: Original pipeline execution took 2211.1501693725586 ms (excluding imports and monkey-patching)
2022-09-21 15:08:19 INFO  Starting execution of 1 what-if analyses...
2022-09-21 15:08:19 INFO  Start plan generation for analysis DataCleaning...
2022-09-21 15:08:19 INFO  ---RUNTIME: Plan generation took 0.7307529449462891 ms
2022-09-21 15:08:19 INFO  Estimated runtime of original DAG is 1950.942039489746ms
2022-09-21 15:08:19 INFO  Performing Multi-Query Optimization
2022-09-21 15:08:19 INFO  Estimated unoptimized what-if runtime is 49966.05968475342ms
2022-09-21 15:08:19 INFO  Estimated optimised what-if runtime is 8111.180543899536ms
2022-09-21 15:08:19 INFO  Estimated optimisation runtime saving is 41854.87914085388ms
2022-09-21 15:08:19 INFO  ---RUNTIME: Multi-Query Optimization took 120.91517448425293 ms
2022-09-21 15:08:19 INFO  Executing generated plans
2022-09-21 15:08:30 INFO  ---RUNTIME: Execution took 11287.960290908813 ms
2022-09-21 15:08:30 INFO  Done!
2022-09-21 15:08:30 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-21 15:08:30 INFO  Running instrumented original pipeline...
2022-09-21 15:08:30 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-21 15:08:30 INFO  ---RUNTIME: Importing and monkey-patching took 6.321907043457031 ms
2022-09-21 15:08:32 INFO  ---RUNTIME: Original pipeline execution took 2190.791606903076 ms (excluding imports and monkey-patching)
2022-09-21 15:08:32 INFO  Starting execution of 1 what-if analyses...
2022-09-21 15:08:32 INFO  Start plan generation for analysis DataCleaning...
2022-09-21 15:08:32 INFO  ---RUNTIME: Plan generation took 0.7550716400146484 ms
2022-09-21 15:08:32 INFO  Estimated runtime of original DAG is 1938.0731582641602ms
2022-09-21 15:08:32 WARNING Skipping Multi-Query Optimization (instead, only applying patches)
2022-09-21 15:08:32 WARNING Columns ['full_name'] not present in train DAG after the train test split, only before!
2022-09-21 15:08:32 WARNING This could hint at data leakage!
2022-09-21 15:08:32 INFO  Estimated unoptimised what-if runtime is 49556.71310424805ms
2022-09-21 15:08:32 INFO  ---RUNTIME: Multi-Query Optimization took 26.577472686767578 ms
2022-09-21 15:08:32 INFO  Executing generated plans
2022-09-21 15:09:27 INFO  ---RUNTIME: Execution took 54116.58430099487 ms
2022-09-21 15:09:27 INFO  Done!
2022-09-21 15:09:27 INFO  # Finished -- repetition 2 of 7 
2022-09-21 15:09:27 INFO  # Optimization benchmark for data_cleaning with args [['healthcare', 'slow_loading', 'featurization_1', 'xgboost']] -- repetition 3 of 7
2022-09-21 15:09:27 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-21 15:09:27 INFO  Running instrumented original pipeline...
2022-09-21 15:09:27 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-21 15:09:27 INFO  ---RUNTIME: Importing and monkey-patching took 6.082057952880859 ms
2022-09-21 15:09:29 INFO  ---RUNTIME: Original pipeline execution took 2198.105812072754 ms (excluding imports and monkey-patching)
2022-09-21 15:09:29 INFO  Starting execution of 1 what-if analyses...
2022-09-21 15:09:29 INFO  Start plan generation for analysis DataCleaning...
2022-09-21 15:09:29 INFO  ---RUNTIME: Plan generation took 0.7374286651611328 ms
2022-09-21 15:09:29 INFO  Estimated runtime of original DAG is 1944.5507526397705ms
2022-09-21 15:09:29 INFO  Performing Multi-Query Optimization
2022-09-21 15:09:29 INFO  Estimated unoptimized what-if runtime is 49736.51576042175ms
2022-09-21 15:09:29 INFO  Estimated optimised what-if runtime is 7742.2521114349365ms
2022-09-21 15:09:29 INFO  Estimated optimisation runtime saving is 41994.26364898682ms
2022-09-21 15:09:29 INFO  ---RUNTIME: Multi-Query Optimization took 120.47886848449707 ms
2022-09-21 15:09:29 INFO  Executing generated plans
2022-09-21 15:09:40 INFO  ---RUNTIME: Execution took 11416.596174240112 ms
2022-09-21 15:09:40 INFO  Done!
2022-09-21 15:09:40 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-21 15:09:40 INFO  Running instrumented original pipeline...
2022-09-21 15:09:40 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-21 15:09:40 INFO  ---RUNTIME: Importing and monkey-patching took 6.22248649597168 ms
2022-09-21 15:09:42 INFO  ---RUNTIME: Original pipeline execution took 2199.6541023254395 ms (excluding imports and monkey-patching)
2022-09-21 15:09:42 INFO  Starting execution of 1 what-if analyses...
2022-09-21 15:09:42 INFO  Start plan generation for analysis DataCleaning...
2022-09-21 15:09:42 INFO  ---RUNTIME: Plan generation took 0.728607177734375 ms
2022-09-21 15:09:42 INFO  Estimated runtime of original DAG is 1946.331262588501ms
2022-09-21 15:09:42 WARNING Skipping Multi-Query Optimization (instead, only applying patches)
2022-09-21 15:09:42 WARNING Columns ['full_name'] not present in train DAG after the train test split, only before!
2022-09-21 15:09:42 WARNING This could hint at data leakage!
2022-09-21 15:09:42 INFO  Estimated unoptimised what-if runtime is 49773.977518081665ms
2022-09-21 15:09:42 INFO  ---RUNTIME: Multi-Query Optimization took 26.60679817199707 ms
2022-09-21 15:09:42 INFO  Executing generated plans
2022-09-21 15:10:37 INFO  ---RUNTIME: Execution took 54250.74791908264 ms
2022-09-21 15:10:37 INFO  Done!
2022-09-21 15:10:37 INFO  # Finished -- repetition 3 of 7 
2022-09-21 15:10:37 INFO  # Optimization benchmark for data_cleaning with args [['healthcare', 'slow_loading', 'featurization_1', 'xgboost']] -- repetition 4 of 7
2022-09-21 15:10:37 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-21 15:10:37 INFO  Running instrumented original pipeline...
2022-09-21 15:10:37 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-21 15:10:37 INFO  ---RUNTIME: Importing and monkey-patching took 6.160259246826172 ms
2022-09-21 15:10:39 INFO  ---RUNTIME: Original pipeline execution took 2187.539577484131 ms (excluding imports and monkey-patching)
2022-09-21 15:10:39 INFO  Starting execution of 1 what-if analyses...
2022-09-21 15:10:39 INFO  Start plan generation for analysis DataCleaning...
2022-09-21 15:10:39 INFO  ---RUNTIME: Plan generation took 1.271963119506836 ms
2022-09-21 15:10:39 INFO  Estimated runtime of original DAG is 1934.2527389526367ms
2022-09-21 15:10:39 INFO  Performing Multi-Query Optimization
2022-09-21 15:10:39 INFO  Estimated unoptimized what-if runtime is 49463.32263946533ms
2022-09-21 15:10:39 INFO  Estimated optimised what-if runtime is 7656.173229217529ms
2022-09-21 15:10:39 INFO  Estimated optimisation runtime saving is 41807.1494102478ms
2022-09-21 15:10:39 INFO  ---RUNTIME: Multi-Query Optimization took 146.3925838470459 ms
2022-09-21 15:10:39 INFO  Executing generated plans
2022-09-21 15:10:51 INFO  ---RUNTIME: Execution took 11418.159484863281 ms
2022-09-21 15:10:51 INFO  Done!
2022-09-21 15:10:51 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-21 15:10:51 INFO  Running instrumented original pipeline...
2022-09-21 15:10:51 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-21 15:10:51 INFO  ---RUNTIME: Importing and monkey-patching took 6.44993782043457 ms
2022-09-21 15:10:53 INFO  ---RUNTIME: Original pipeline execution took 2407.717227935791 ms (excluding imports and monkey-patching)
2022-09-21 15:10:53 INFO  Starting execution of 1 what-if analyses...
2022-09-21 15:10:53 INFO  Start plan generation for analysis DataCleaning...
2022-09-21 15:10:53 INFO  ---RUNTIME: Plan generation took 0.7255077362060547 ms
2022-09-21 15:10:53 INFO  Estimated runtime of original DAG is 1959.059715270996ms
2022-09-21 15:10:53 WARNING Skipping Multi-Query Optimization (instead, only applying patches)
2022-09-21 15:10:53 WARNING Columns ['full_name'] not present in train DAG after the train test split, only before!
2022-09-21 15:10:53 WARNING This could hint at data leakage!
2022-09-21 15:10:53 INFO  Estimated unoptimised what-if runtime is 50076.06554031372ms
2022-09-21 15:10:53 INFO  ---RUNTIME: Multi-Query Optimization took 26.445388793945312 ms
2022-09-21 15:10:53 INFO  Executing generated plans
2022-09-21 15:11:47 INFO  ---RUNTIME: Execution took 53896.2607383728 ms
2022-09-21 15:11:47 INFO  Done!
2022-09-21 15:11:47 INFO  # Finished -- repetition 4 of 7 
2022-09-21 15:11:47 INFO  # Optimization benchmark for data_cleaning with args [['healthcare', 'slow_loading', 'featurization_1', 'xgboost']] -- repetition 5 of 7
2022-09-21 15:11:47 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-21 15:11:47 INFO  Running instrumented original pipeline...
2022-09-21 15:11:47 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-21 15:11:47 INFO  ---RUNTIME: Importing and monkey-patching took 6.084680557250977 ms
2022-09-21 15:11:49 INFO  ---RUNTIME: Original pipeline execution took 2204.5793533325195 ms (excluding imports and monkey-patching)
2022-09-21 15:11:49 INFO  Starting execution of 1 what-if analyses...
2022-09-21 15:11:49 INFO  Start plan generation for analysis DataCleaning...
2022-09-21 15:11:49 INFO  ---RUNTIME: Plan generation took 1.108407974243164 ms
2022-09-21 15:11:49 INFO  Estimated runtime of original DAG is 1948.0557441711426ms
2022-09-21 15:11:49 INFO  Performing Multi-Query Optimization
2022-09-21 15:11:49 INFO  Estimated unoptimized what-if runtime is 49819.63300704956ms
2022-09-21 15:11:49 INFO  Estimated optimised what-if runtime is 7732.525825500488ms
2022-09-21 15:11:49 INFO  Estimated optimisation runtime saving is 42087.10718154907ms
2022-09-21 15:11:49 INFO  ---RUNTIME: Multi-Query Optimization took 119.33469772338867 ms
2022-09-21 15:11:49 INFO  Executing generated plans
2022-09-21 15:12:01 INFO  ---RUNTIME: Execution took 11423.778772354126 ms
2022-09-21 15:12:01 INFO  Done!
2022-09-21 15:12:01 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-21 15:12:01 INFO  Running instrumented original pipeline...
2022-09-21 15:12:01 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-21 15:12:01 INFO  ---RUNTIME: Importing and monkey-patching took 5.96308708190918 ms
2022-09-21 15:12:03 INFO  ---RUNTIME: Original pipeline execution took 2195.798873901367 ms (excluding imports and monkey-patching)
2022-09-21 15:12:03 INFO  Starting execution of 1 what-if analyses...
2022-09-21 15:12:03 INFO  Start plan generation for analysis DataCleaning...
2022-09-21 15:12:03 INFO  ---RUNTIME: Plan generation took 0.8301734924316406 ms
2022-09-21 15:12:03 INFO  Estimated runtime of original DAG is 1941.6556358337402ms
2022-09-21 15:12:03 WARNING Skipping Multi-Query Optimization (instead, only applying patches)
2022-09-21 15:12:03 WARNING Columns ['full_name'] not present in train DAG after the train test split, only before!
2022-09-21 15:12:03 WARNING This could hint at data leakage!
2022-09-21 15:12:03 INFO  Estimated unoptimised what-if runtime is 49659.16109085083ms
2022-09-21 15:12:03 INFO  ---RUNTIME: Multi-Query Optimization took 32.26590156555176 ms
2022-09-21 15:12:03 INFO  Executing generated plans
2022-09-21 15:12:56 INFO  ---RUNTIME: Execution took 53576.929807662964 ms
2022-09-21 15:12:56 INFO  Done!
2022-09-21 15:12:56 INFO  # Finished -- repetition 5 of 7 
2022-09-21 15:12:56 INFO  # Optimization benchmark for data_cleaning with args [['healthcare', 'slow_loading', 'featurization_1', 'xgboost']] -- repetition 6 of 7
2022-09-21 15:12:56 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-21 15:12:56 INFO  Running instrumented original pipeline...
2022-09-21 15:12:56 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-21 15:12:56 INFO  ---RUNTIME: Importing and monkey-patching took 5.987644195556641 ms
2022-09-21 15:12:59 INFO  ---RUNTIME: Original pipeline execution took 2161.057949066162 ms (excluding imports and monkey-patching)
2022-09-21 15:12:59 INFO  Starting execution of 1 what-if analyses...
2022-09-21 15:12:59 INFO  Start plan generation for analysis DataCleaning...
2022-09-21 15:12:59 INFO  ---RUNTIME: Plan generation took 0.736236572265625 ms
2022-09-21 15:12:59 INFO  Estimated runtime of original DAG is 1909.1675281524658ms
2022-09-21 15:12:59 INFO  Performing Multi-Query Optimization
2022-09-21 15:12:59 INFO  Estimated unoptimized what-if runtime is 48843.61386299133ms
2022-09-21 15:12:59 INFO  Estimated optimised what-if runtime is 7665.969133377075ms
2022-09-21 15:12:59 INFO  Estimated optimisation runtime saving is 41177.64472961426ms
2022-09-21 15:12:59 INFO  ---RUNTIME: Multi-Query Optimization took 120.18227577209473 ms
2022-09-21 15:12:59 INFO  Executing generated plans
2022-09-21 15:13:10 INFO  ---RUNTIME: Execution took 11570.089101791382 ms
2022-09-21 15:13:10 INFO  Done!
2022-09-21 15:13:10 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-21 15:13:10 INFO  Running instrumented original pipeline...
2022-09-21 15:13:10 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-21 15:13:10 INFO  ---RUNTIME: Importing and monkey-patching took 6.587505340576172 ms
2022-09-21 15:13:12 INFO  ---RUNTIME: Original pipeline execution took 2200.941562652588 ms (excluding imports and monkey-patching)
2022-09-21 15:13:12 INFO  Starting execution of 1 what-if analyses...
2022-09-21 15:13:12 INFO  Start plan generation for analysis DataCleaning...
2022-09-21 15:13:12 INFO  ---RUNTIME: Plan generation took 0.7479190826416016 ms
2022-09-21 15:13:12 INFO  Estimated runtime of original DAG is 1943.3374404907227ms
2022-09-21 15:13:12 WARNING Skipping Multi-Query Optimization (instead, only applying patches)
2022-09-21 15:13:13 WARNING Columns ['full_name'] not present in train DAG after the train test split, only before!
2022-09-21 15:13:13 WARNING This could hint at data leakage!
2022-09-21 15:13:13 INFO  Estimated unoptimised what-if runtime is 49694.653034210205ms
2022-09-21 15:13:13 INFO  ---RUNTIME: Multi-Query Optimization took 26.99446678161621 ms
2022-09-21 15:13:13 INFO  Executing generated plans
2022-09-21 15:14:06 INFO  ---RUNTIME: Execution took 53926.19967460632 ms
2022-09-21 15:14:06 INFO  Done!
2022-09-21 15:14:06 INFO  # Finished -- repetition 6 of 7 
2022-09-21 15:14:06 INFO  # Optimization benchmark for data_cleaning with args [['healthcare', 'slow_loading', 'featurization_1', 'xgboost']] -- repetition 7 of 7
2022-09-21 15:14:06 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-21 15:14:06 INFO  Running instrumented original pipeline...
2022-09-21 15:14:06 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-21 15:14:06 INFO  ---RUNTIME: Importing and monkey-patching took 6.240606307983398 ms
2022-09-21 15:14:09 INFO  ---RUNTIME: Original pipeline execution took 2233.1254482269287 ms (excluding imports and monkey-patching)
2022-09-21 15:14:09 INFO  Starting execution of 1 what-if analyses...
2022-09-21 15:14:09 INFO  Start plan generation for analysis DataCleaning...
2022-09-21 15:14:09 INFO  ---RUNTIME: Plan generation took 0.7402896881103516 ms
2022-09-21 15:14:09 INFO  Estimated runtime of original DAG is 1980.1867008209229ms
2022-09-21 15:14:09 INFO  Performing Multi-Query Optimization
2022-09-21 15:14:09 INFO  Estimated unoptimized what-if runtime is 50627.93803215027ms
2022-09-21 15:14:09 INFO  Estimated optimised what-if runtime is 7781.8357944488525ms
2022-09-21 15:14:09 INFO  Estimated optimisation runtime saving is 42846.102237701416ms
2022-09-21 15:14:09 INFO  ---RUNTIME: Multi-Query Optimization took 121.82044982910156 ms
2022-09-21 15:14:09 INFO  Executing generated plans
2022-09-21 15:14:20 INFO  ---RUNTIME: Execution took 11419.143915176392 ms
2022-09-21 15:14:20 INFO  Done!
2022-09-21 15:14:20 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-21 15:14:20 INFO  Running instrumented original pipeline...
2022-09-21 15:14:20 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-21 15:14:21 INFO  ---RUNTIME: Importing and monkey-patching took 5.953073501586914 ms
2022-09-21 15:14:23 INFO  ---RUNTIME: Original pipeline execution took 2391.8697834014893 ms (excluding imports and monkey-patching)
2022-09-21 15:14:23 INFO  Starting execution of 1 what-if analyses...
2022-09-21 15:14:23 INFO  Start plan generation for analysis DataCleaning...
2022-09-21 15:14:23 INFO  ---RUNTIME: Plan generation took 0.7674694061279297 ms
2022-09-21 15:14:23 INFO  Estimated runtime of original DAG is 1919.971227645874ms
2022-09-21 15:14:23 WARNING Skipping Multi-Query Optimization (instead, only applying patches)
2022-09-21 15:14:23 WARNING Columns ['full_name'] not present in train DAG after the train test split, only before!
2022-09-21 15:14:23 WARNING This could hint at data leakage!
2022-09-21 15:14:23 INFO  Estimated unoptimised what-if runtime is 49111.91821098328ms
2022-09-21 15:14:23 INFO  ---RUNTIME: Multi-Query Optimization took 26.630878448486328 ms
2022-09-21 15:14:23 INFO  Executing generated plans
2022-09-21 15:15:16 INFO  ---RUNTIME: Execution took 53679.9418926239 ms
2022-09-21 15:15:16 INFO  Done!
2022-09-21 15:15:16 INFO  # Finished -- repetition 7 of 7 
2022-09-21 15:15:16 INFO  # Final results after all repetitions
2022-09-21 15:15:16 INFO     repetition  ... no_opt_what_if_execution_combined_model_training
0           0  ...                                      8533.485889
1           1  ...                                      8647.392035
2           2  ...                                      8681.433916
3           3  ...                                      8773.416519
4           4  ...                                      8739.969492
5           5  ...                                      8825.817347
6           6  ...                                      8877.439737

[7 rows x 26 columns]
taskset -c 128-135 PROTOCOL_BUFFERS_PYTHON_IMPLEMENTATION=python python3.9 benchmarks_end_to_end.py data_cleaning healthcare slow_loading featurization_1 neural_network
2022-09-21 15:15:18.893757: W tensorflow/stream_executor/platform/default/dso_loader.cc:64] Could not load dynamic library 'libcudart.so.11.0'; dlerror: libcudart.so.11.0: cannot open shared object file: No such file or directory; LD_LIBRARY_PATH: /home/sgrafbe/mlwhatif/venv/lib/python3.9/site-packages/cv2/../../lib64:
2022-09-21 15:15:18.893798: I tensorflow/stream_executor/cuda/cudart_stub.cc:29] Ignore above cudart dlerror if you do not have a GPU set up on your machine.
2022-09-21 15:15:20 INFO  Patching sys.argv with ['mlwhatif', 'healthcare', 'slow_loading', 'featurization_1', 'neural_network']
2022-09-21 15:15:20 INFO  Running instrumented original pipeline...
2022-09-21 15:15:20 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-21 15:15:20 INFO  ---RUNTIME: Importing and monkey-patching took 95.30806541442871 ms
2022-09-21 15:15:22.316938: W tensorflow/stream_executor/platform/default/dso_loader.cc:64] Could not load dynamic library 'libcuda.so.1'; dlerror: libcuda.so.1: cannot open shared object file: No such file or directory; LD_LIBRARY_PATH: /home/sgrafbe/mlwhatif/venv/lib/python3.9/site-packages/cv2/../../lib64:
2022-09-21 15:15:22.316970: W tensorflow/stream_executor/cuda/cuda_driver.cc:326] failed call to cuInit: UNKNOWN ERROR (303)
2022-09-21 15:15:22.316993: I tensorflow/stream_executor/cuda/cuda_diagnostics.cc:156] kernel driver does not appear to be running on this host (wagyu): /proc/driver/nvidia/version does not exist
2022-09-21 15:15:22.317447: I tensorflow/core/platform/cpu_feature_guard.cc:142] This TensorFlow binary is optimized with oneAPI Deep Neural Network Library (oneDNN) to use the following CPU instructions in performance-critical operations:  AVX2 FMA
To enable them in other operations, rebuild TensorFlow with the appropriate compiler flags.
2022-09-21 15:15:22.855900: I tensorflow/compiler/mlir/mlir_graph_optimization_pass.cc:176] None of the MLIR Optimization Passes are enabled (registered 2)
2022-09-21 15:15:22.869373: I tensorflow/core/platform/profile_utils/cpu_utils.cc:114] CPU Frequency: 2595290000 Hz
2022-09-21 15:15:23 INFO  ---RUNTIME: Original pipeline execution took 2879.3928623199463 ms (excluding imports and monkey-patching)
2022-09-21 15:15:23 INFO  Starting execution of 0 what-if analyses...
2022-09-21 15:15:23 INFO  Estimated runtime of original DAG is 2598.4323024749756ms
2022-09-21 15:15:23 INFO  Performing Multi-Query Optimization
2022-09-21 15:15:23 INFO  Estimated unoptimized what-if runtime is 0ms
2022-09-21 15:15:23 INFO  Estimated optimised what-if runtime is 0ms
2022-09-21 15:15:23 INFO  Estimated optimisation runtime saving is 0ms
2022-09-21 15:15:23 INFO  ---RUNTIME: Multi-Query Optimization took 0.5381107330322266 ms
2022-09-21 15:15:23 INFO  Executing generated plans
2022-09-21 15:15:23 INFO  ---RUNTIME: Execution took 0.0171661376953125 ms
2022-09-21 15:15:23 INFO  Done!
2022-09-21 15:15:23 INFO  # Optimization benchmark for data_cleaning with args [['healthcare', 'slow_loading', 'featurization_1', 'neural_network']] -- repetition 1 of 7
2022-09-21 15:15:23 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-21 15:15:23 INFO  Running instrumented original pipeline...
2022-09-21 15:15:23 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-21 15:15:23 INFO  ---RUNTIME: Importing and monkey-patching took 5.159139633178711 ms
2022-09-21 15:15:25 INFO  ---RUNTIME: Original pipeline execution took 2505.2504539489746 ms (excluding imports and monkey-patching)
2022-09-21 15:15:25 INFO  Starting execution of 1 what-if analyses...
2022-09-21 15:15:25 INFO  Start plan generation for analysis DataCleaning...
2022-09-21 15:15:25 INFO  ---RUNTIME: Plan generation took 0.8306503295898438 ms
2022-09-21 15:15:25 INFO  Estimated runtime of original DAG is 2252.0391941070557ms
2022-09-21 15:15:25 INFO  Performing Multi-Query Optimization
2022-09-21 15:15:25 INFO  Estimated unoptimized what-if runtime is 58894.33979988098ms
2022-09-21 15:15:25 INFO  Estimated optimised what-if runtime is 16681.22959136963ms
2022-09-21 15:15:25 INFO  Estimated optimisation runtime saving is 42213.11020851135ms
2022-09-21 15:15:25 INFO  ---RUNTIME: Multi-Query Optimization took 120.43190002441406 ms
2022-09-21 15:15:25 INFO  Executing generated plans
2022-09-21 15:15:48 INFO  ---RUNTIME: Execution took 22634.07564163208 ms
2022-09-21 15:15:48 INFO  Done!
2022-09-21 15:15:48 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-21 15:15:48 INFO  Running instrumented original pipeline...
2022-09-21 15:15:48 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-21 15:15:48 INFO  ---RUNTIME: Importing and monkey-patching took 6.554841995239258 ms
2022-09-21 15:15:51 INFO  ---RUNTIME: Original pipeline execution took 3295.924663543701 ms (excluding imports and monkey-patching)
2022-09-21 15:15:51 INFO  Starting execution of 1 what-if analyses...
2022-09-21 15:15:51 INFO  Start plan generation for analysis DataCleaning...
2022-09-21 15:15:51 INFO  ---RUNTIME: Plan generation took 1.8351078033447266 ms
2022-09-21 15:15:51 INFO  Estimated runtime of original DAG is 3039.417028427124ms
2022-09-21 15:15:51 WARNING Skipping Multi-Query Optimization (instead, only applying patches)
2022-09-21 15:15:51 WARNING Columns ['full_name'] not present in train DAG after the train test split, only before!
2022-09-21 15:15:51 WARNING This could hint at data leakage!
2022-09-21 15:15:51 INFO  Estimated unoptimised what-if runtime is 83349.05648231506ms
2022-09-21 15:15:51 INFO  ---RUNTIME: Multi-Query Optimization took 26.68023109436035 ms
2022-09-21 15:15:51 INFO  Executing generated plans
2022-09-21 15:16:57 INFO  ---RUNTIME: Execution took 65643.81289482117 ms
2022-09-21 15:16:57 INFO  Done!
2022-09-21 15:16:57 INFO  # Finished -- repetition 1 of 7 
2022-09-21 15:16:57 INFO  # Optimization benchmark for data_cleaning with args [['healthcare', 'slow_loading', 'featurization_1', 'neural_network']] -- repetition 2 of 7
2022-09-21 15:16:57 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-21 15:16:57 INFO  Running instrumented original pipeline...
2022-09-21 15:16:57 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-21 15:16:57 INFO  ---RUNTIME: Importing and monkey-patching took 6.212472915649414 ms
2022-09-21 15:17:00 INFO  ---RUNTIME: Original pipeline execution took 2844.2609310150146 ms (excluding imports and monkey-patching)
2022-09-21 15:17:00 INFO  Starting execution of 1 what-if analyses...
2022-09-21 15:17:00 INFO  Start plan generation for analysis DataCleaning...
2022-09-21 15:17:00 INFO  ---RUNTIME: Plan generation took 0.8909702301025391 ms
2022-09-21 15:17:00 INFO  Estimated runtime of original DAG is 2588.878393173218ms
2022-09-21 15:17:00 INFO  Performing Multi-Query Optimization
2022-09-21 15:17:00 INFO  Estimated unoptimized what-if runtime is 67292.5488948822ms
2022-09-21 15:17:00 INFO  Estimated optimised what-if runtime is 24902.244091033936ms
2022-09-21 15:17:00 INFO  Estimated optimisation runtime saving is 42390.30480384827ms
2022-09-21 15:17:00 INFO  ---RUNTIME: Multi-Query Optimization took 128.9498805999756 ms
2022-09-21 15:17:00 INFO  Executing generated plans
2022-09-21 15:17:23 INFO  ---RUNTIME: Execution took 23192.315578460693 ms
2022-09-21 15:17:23 INFO  Done!
2022-09-21 15:17:23 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-21 15:17:23 INFO  Running instrumented original pipeline...
2022-09-21 15:17:23 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-21 15:17:23 INFO  ---RUNTIME: Importing and monkey-patching took 6.254911422729492 ms
2022-09-21 15:17:26 INFO  ---RUNTIME: Original pipeline execution took 3354.1765213012695 ms (excluding imports and monkey-patching)
2022-09-21 15:17:26 INFO  Starting execution of 1 what-if analyses...
2022-09-21 15:17:26 INFO  Start plan generation for analysis DataCleaning...
2022-09-21 15:17:26 INFO  ---RUNTIME: Plan generation took 0.9100437164306641 ms
2022-09-21 15:17:26 INFO  Estimated runtime of original DAG is 3095.587730407715ms
2022-09-21 15:17:26 WARNING Skipping Multi-Query Optimization (instead, only applying patches)
2022-09-21 15:17:26 WARNING Columns ['full_name'] not present in train DAG after the train test split, only before!
2022-09-21 15:17:26 WARNING This could hint at data leakage!
2022-09-21 15:17:26 INFO  Estimated unoptimised what-if runtime is 84951.14946365356ms
2022-09-21 15:17:26 INFO  ---RUNTIME: Multi-Query Optimization took 28.928041458129883 ms
2022-09-21 15:17:26 INFO  Executing generated plans
2022-09-21 15:18:33 INFO  ---RUNTIME: Execution took 66588.69957923889 ms
2022-09-21 15:18:33 INFO  Done!
2022-09-21 15:18:33 INFO  # Finished -- repetition 2 of 7 
2022-09-21 15:18:33 INFO  # Optimization benchmark for data_cleaning with args [['healthcare', 'slow_loading', 'featurization_1', 'neural_network']] -- repetition 3 of 7
2022-09-21 15:18:33 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-21 15:18:33 INFO  Running instrumented original pipeline...
2022-09-21 15:18:33 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-21 15:18:33 INFO  ---RUNTIME: Importing and monkey-patching took 6.327629089355469 ms
2022-09-21 15:18:36 INFO  ---RUNTIME: Original pipeline execution took 2565.601110458374 ms (excluding imports and monkey-patching)
2022-09-21 15:18:36 INFO  Starting execution of 1 what-if analyses...
2022-09-21 15:18:36 INFO  Start plan generation for analysis DataCleaning...
2022-09-21 15:18:36 INFO  ---RUNTIME: Plan generation took 0.8983612060546875 ms
2022-09-21 15:18:36 INFO  Estimated runtime of original DAG is 2306.6325187683105ms
2022-09-21 15:18:36 INFO  Performing Multi-Query Optimization
2022-09-21 15:18:36 INFO  Estimated unoptimized what-if runtime is 60257.168769836426ms
2022-09-21 15:18:36 INFO  Estimated optimised what-if runtime is 16728.915452957153ms
2022-09-21 15:18:36 INFO  Estimated optimisation runtime saving is 43528.25331687927ms
2022-09-21 15:18:36 INFO  ---RUNTIME: Multi-Query Optimization took 120.17059326171875 ms
2022-09-21 15:18:36 INFO  Executing generated plans
2022-09-21 15:19:00 INFO  ---RUNTIME: Execution took 23880.74016571045 ms
2022-09-21 15:19:00 INFO  Done!
2022-09-21 15:19:00 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-21 15:19:00 INFO  Running instrumented original pipeline...
2022-09-21 15:19:00 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-21 15:19:00 INFO  ---RUNTIME: Importing and monkey-patching took 6.567478179931641 ms
2022-09-21 15:19:02 INFO  ---RUNTIME: Original pipeline execution took 2520.0295448303223 ms (excluding imports and monkey-patching)
2022-09-21 15:19:02 INFO  Starting execution of 1 what-if analyses...
2022-09-21 15:19:02 INFO  Start plan generation for analysis DataCleaning...
2022-09-21 15:19:02 INFO  ---RUNTIME: Plan generation took 0.8471012115478516 ms
2022-09-21 15:19:02 INFO  Estimated runtime of original DAG is 2258.488416671753ms
2022-09-21 15:19:02 WARNING Skipping Multi-Query Optimization (instead, only applying patches)
2022-09-21 15:19:02 WARNING Columns ['full_name'] not present in train DAG after the train test split, only before!
2022-09-21 15:19:02 WARNING This could hint at data leakage!
2022-09-21 15:19:02 INFO  Estimated unoptimised what-if runtime is 59073.59337806702ms
2022-09-21 15:19:02 INFO  ---RUNTIME: Multi-Query Optimization took 27.157068252563477 ms
2022-09-21 15:19:02 INFO  Executing generated plans
2022-09-21 15:20:09 INFO  ---RUNTIME: Execution took 66485.65816879272 ms
2022-09-21 15:20:09 INFO  Done!
2022-09-21 15:20:09 INFO  # Finished -- repetition 3 of 7 
2022-09-21 15:20:09 INFO  # Optimization benchmark for data_cleaning with args [['healthcare', 'slow_loading', 'featurization_1', 'neural_network']] -- repetition 4 of 7
2022-09-21 15:20:09 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-21 15:20:09 INFO  Running instrumented original pipeline...
2022-09-21 15:20:09 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-21 15:20:09 INFO  ---RUNTIME: Importing and monkey-patching took 6.181478500366211 ms
2022-09-21 15:20:11 INFO  ---RUNTIME: Original pipeline execution took 2489.532947540283 ms (excluding imports and monkey-patching)
2022-09-21 15:20:11 INFO  Starting execution of 1 what-if analyses...
2022-09-21 15:20:11 INFO  Start plan generation for analysis DataCleaning...
2022-09-21 15:20:11 INFO  ---RUNTIME: Plan generation took 0.946044921875 ms
2022-09-21 15:20:11 INFO  Estimated runtime of original DAG is 2231.858730316162ms
2022-09-21 15:20:11 INFO  Performing Multi-Query Optimization
2022-09-21 15:20:11 INFO  Estimated unoptimized what-if runtime is 58386.67678833008ms
2022-09-21 15:20:11 INFO  Estimated optimised what-if runtime is 16635.658025741577ms
2022-09-21 15:20:11 INFO  Estimated optimisation runtime saving is 41751.0187625885ms
2022-09-21 15:20:11 INFO  ---RUNTIME: Multi-Query Optimization took 121.16146087646484 ms
2022-09-21 15:20:11 INFO  Executing generated plans
2022-09-21 15:20:35 INFO  ---RUNTIME: Execution took 23994.873762130737 ms
2022-09-21 15:20:35 INFO  Done!
2022-09-21 15:20:35 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-21 15:20:35 INFO  Running instrumented original pipeline...
2022-09-21 15:20:35 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-21 15:20:35 INFO  ---RUNTIME: Importing and monkey-patching took 6.318092346191406 ms
2022-09-21 15:20:38 INFO  ---RUNTIME: Original pipeline execution took 2501.422643661499 ms (excluding imports and monkey-patching)
2022-09-21 15:20:38 INFO  Starting execution of 1 what-if analyses...
2022-09-21 15:20:38 INFO  Start plan generation for analysis DataCleaning...
2022-09-21 15:20:38 INFO  ---RUNTIME: Plan generation took 1.8029212951660156 ms
2022-09-21 15:20:38 INFO  Estimated runtime of original DAG is 2240.825653076172ms
2022-09-21 15:20:38 WARNING Skipping Multi-Query Optimization (instead, only applying patches)
2022-09-21 15:20:38 WARNING Columns ['full_name'] not present in train DAG after the train test split, only before!
2022-09-21 15:20:38 WARNING This could hint at data leakage!
2022-09-21 15:20:38 INFO  Estimated unoptimised what-if runtime is 58595.04699707031ms
2022-09-21 15:20:38 INFO  ---RUNTIME: Multi-Query Optimization took 26.369810104370117 ms
2022-09-21 15:20:38 INFO  Executing generated plans
2022-09-21 15:21:45 INFO  ---RUNTIME: Execution took 67210.80684661865 ms
2022-09-21 15:21:45 INFO  Done!
2022-09-21 15:21:45 INFO  # Finished -- repetition 4 of 7 
2022-09-21 15:21:45 INFO  # Optimization benchmark for data_cleaning with args [['healthcare', 'slow_loading', 'featurization_1', 'neural_network']] -- repetition 5 of 7
2022-09-21 15:21:45 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-21 15:21:45 INFO  Running instrumented original pipeline...
2022-09-21 15:21:45 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-21 15:21:45 INFO  ---RUNTIME: Importing and monkey-patching took 5.946874618530273 ms
2022-09-21 15:21:48 INFO  ---RUNTIME: Original pipeline execution took 2515.3236389160156 ms (excluding imports and monkey-patching)
2022-09-21 15:21:48 INFO  Starting execution of 1 what-if analyses...
2022-09-21 15:21:48 INFO  Start plan generation for analysis DataCleaning...
2022-09-21 15:21:48 INFO  ---RUNTIME: Plan generation took 0.8957386016845703 ms
2022-09-21 15:21:48 INFO  Estimated runtime of original DAG is 2260.0042819976807ms
2022-09-21 15:21:48 INFO  Performing Multi-Query Optimization
2022-09-21 15:21:48 INFO  Estimated unoptimized what-if runtime is 59093.09792518616ms
2022-09-21 15:21:48 INFO  Estimated optimised what-if runtime is 16717.84734725952ms
2022-09-21 15:21:48 INFO  Estimated optimisation runtime saving is 42375.250577926636ms
2022-09-21 15:21:48 INFO  ---RUNTIME: Multi-Query Optimization took 127.42209434509277 ms
2022-09-21 15:21:48 INFO  Executing generated plans
2022-09-21 15:22:11 INFO  ---RUNTIME: Execution took 23541.026830673218 ms
2022-09-21 15:22:11 INFO  Done!
2022-09-21 15:22:11 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-21 15:22:11 INFO  Running instrumented original pipeline...
2022-09-21 15:22:11 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-21 15:22:11 INFO  ---RUNTIME: Importing and monkey-patching took 6.0634613037109375 ms
2022-09-21 15:22:14 INFO  ---RUNTIME: Original pipeline execution took 2501.5218257904053 ms (excluding imports and monkey-patching)
2022-09-21 15:22:14 INFO  Starting execution of 1 what-if analyses...
2022-09-21 15:22:14 INFO  Start plan generation for analysis DataCleaning...
2022-09-21 15:22:14 INFO  ---RUNTIME: Plan generation took 0.8568763732910156 ms
2022-09-21 15:22:14 INFO  Estimated runtime of original DAG is 2244.2688941955566ms
2022-09-21 15:22:14 WARNING Skipping Multi-Query Optimization (instead, only applying patches)
2022-09-21 15:22:14 WARNING Columns ['full_name'] not present in train DAG after the train test split, only before!
2022-09-21 15:22:14 WARNING This could hint at data leakage!
2022-09-21 15:22:14 INFO  Estimated unoptimised what-if runtime is 58702.71444320679ms
2022-09-21 15:22:14 INFO  ---RUNTIME: Multi-Query Optimization took 26.803255081176758 ms
2022-09-21 15:22:14 INFO  Executing generated plans
2022-09-21 15:23:21 INFO  ---RUNTIME: Execution took 67193.04490089417 ms
2022-09-21 15:23:21 INFO  Done!
2022-09-21 15:23:21 INFO  # Finished -- repetition 5 of 7 
2022-09-21 15:23:21 INFO  # Optimization benchmark for data_cleaning with args [['healthcare', 'slow_loading', 'featurization_1', 'neural_network']] -- repetition 6 of 7
2022-09-21 15:23:21 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-21 15:23:21 INFO  Running instrumented original pipeline...
2022-09-21 15:23:21 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-21 15:23:21 INFO  ---RUNTIME: Importing and monkey-patching took 6.070613861083984 ms
2022-09-21 15:23:23 INFO  ---RUNTIME: Original pipeline execution took 2503.3745765686035 ms (excluding imports and monkey-patching)
2022-09-21 15:23:23 INFO  Starting execution of 1 what-if analyses...
2022-09-21 15:23:23 INFO  Start plan generation for analysis DataCleaning...
2022-09-21 15:23:23 INFO  ---RUNTIME: Plan generation took 0.9899139404296875 ms
2022-09-21 15:23:23 INFO  Estimated runtime of original DAG is 2244.8549270629883ms
2022-09-21 15:23:23 INFO  Performing Multi-Query Optimization
2022-09-21 15:23:24 INFO  Estimated unoptimized what-if runtime is 58740.355014801025ms
2022-09-21 15:23:24 INFO  Estimated optimised what-if runtime is 16791.480779647827ms
2022-09-21 15:23:24 INFO  Estimated optimisation runtime saving is 41948.8742351532ms
2022-09-21 15:23:24 INFO  ---RUNTIME: Multi-Query Optimization took 127.84981727600098 ms
2022-09-21 15:23:24 INFO  Executing generated plans
2022-09-21 15:23:48 INFO  ---RUNTIME: Execution took 24363.44051361084 ms
2022-09-21 15:23:48 INFO  Done!
2022-09-21 15:23:48 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-21 15:23:48 INFO  Running instrumented original pipeline...
2022-09-21 15:23:48 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-21 15:23:48 INFO  ---RUNTIME: Importing and monkey-patching took 5.900382995605469 ms
2022-09-21 15:23:50 INFO  ---RUNTIME: Original pipeline execution took 2481.309413909912 ms (excluding imports and monkey-patching)
2022-09-21 15:23:50 INFO  Starting execution of 1 what-if analyses...
2022-09-21 15:23:50 INFO  Start plan generation for analysis DataCleaning...
2022-09-21 15:23:50 INFO  ---RUNTIME: Plan generation took 0.8361339569091797 ms
2022-09-21 15:23:50 INFO  Estimated runtime of original DAG is 2227.8552055358887ms
2022-09-21 15:23:50 WARNING Skipping Multi-Query Optimization (instead, only applying patches)
2022-09-21 15:23:50 WARNING Columns ['full_name'] not present in train DAG after the train test split, only before!
2022-09-21 15:23:50 WARNING This could hint at data leakage!
2022-09-21 15:23:50 INFO  Estimated unoptimised what-if runtime is 58275.224685668945ms
2022-09-21 15:23:50 INFO  ---RUNTIME: Multi-Query Optimization took 27.262449264526367 ms
2022-09-21 15:23:50 INFO  Executing generated plans
2022-09-21 15:24:57 INFO  ---RUNTIME: Execution took 66869.69923973083 ms
2022-09-21 15:24:57 INFO  Done!
2022-09-21 15:24:57 INFO  # Finished -- repetition 6 of 7 
2022-09-21 15:24:57 INFO  # Optimization benchmark for data_cleaning with args [['healthcare', 'slow_loading', 'featurization_1', 'neural_network']] -- repetition 7 of 7
2022-09-21 15:24:57 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-21 15:24:57 INFO  Running instrumented original pipeline...
2022-09-21 15:24:57 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-21 15:24:57 INFO  ---RUNTIME: Importing and monkey-patching took 6.127119064331055 ms
2022-09-21 15:25:00 INFO  ---RUNTIME: Original pipeline execution took 2493.2119846343994 ms (excluding imports and monkey-patching)
2022-09-21 15:25:00 INFO  Starting execution of 1 what-if analyses...
2022-09-21 15:25:00 INFO  Start plan generation for analysis DataCleaning...
2022-09-21 15:25:00 INFO  ---RUNTIME: Plan generation took 0.8184909820556641 ms
2022-09-21 15:25:00 INFO  Estimated runtime of original DAG is 2238.051176071167ms
2022-09-21 15:25:00 INFO  Performing Multi-Query Optimization
2022-09-21 15:25:00 INFO  Estimated unoptimized what-if runtime is 58542.274713516235ms
2022-09-21 15:25:00 INFO  Estimated optimised what-if runtime is 16631.930112838745ms
2022-09-21 15:25:00 INFO  Estimated optimisation runtime saving is 41910.34460067749ms
2022-09-21 15:25:00 INFO  ---RUNTIME: Multi-Query Optimization took 121.33932113647461 ms
2022-09-21 15:25:00 INFO  Executing generated plans
2022-09-21 15:25:24 INFO  ---RUNTIME: Execution took 24153.52463722229 ms
2022-09-21 15:25:24 INFO  Done!
2022-09-21 15:25:24 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-21 15:25:24 INFO  Running instrumented original pipeline...
2022-09-21 15:25:24 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-21 15:25:24 INFO  ---RUNTIME: Importing and monkey-patching took 5.921840667724609 ms
2022-09-21 15:25:27 INFO  ---RUNTIME: Original pipeline execution took 2509.3345642089844 ms (excluding imports and monkey-patching)
2022-09-21 15:25:27 INFO  Starting execution of 1 what-if analyses...
2022-09-21 15:25:27 INFO  Start plan generation for analysis DataCleaning...
2022-09-21 15:25:27 INFO  ---RUNTIME: Plan generation took 0.9353160858154297 ms
2022-09-21 15:25:27 INFO  Estimated runtime of original DAG is 2252.1684169769287ms
2022-09-21 15:25:27 WARNING Skipping Multi-Query Optimization (instead, only applying patches)
2022-09-21 15:25:27 WARNING Columns ['full_name'] not present in train DAG after the train test split, only before!
2022-09-21 15:25:27 WARNING This could hint at data leakage!
2022-09-21 15:25:27 INFO  Estimated unoptimised what-if runtime is 58926.9015789032ms
2022-09-21 15:25:27 INFO  ---RUNTIME: Multi-Query Optimization took 27.817487716674805 ms
2022-09-21 15:25:27 INFO  Executing generated plans
2022-09-21 15:26:33 INFO  ---RUNTIME: Execution took 66826.94411277771 ms
2022-09-21 15:26:33 INFO  Done!
2022-09-21 15:26:33 INFO  # Finished -- repetition 7 of 7 
2022-09-21 15:26:33 INFO  # Final results after all repetitions
2022-09-21 15:26:33 INFO     repetition  ... no_opt_what_if_execution_combined_model_training
0           0  ...                                     18844.647884
1           1  ...                                     18813.030958
2           2  ...                                     19207.078934
3           3  ...                                     20103.031874
4           4  ...                                     19775.041103
5           5  ...                                     19026.695967
6           6  ...                                     19276.800871

[7 rows x 26 columns]
taskset -c 128-135 PROTOCOL_BUFFERS_PYTHON_IMPLEMENTATION=python python3.9 benchmarks_end_to_end.py data_cleaning healthcare slow_loading featurization_2 logistic_regression
2022-09-21 15:26:36.291210: W tensorflow/stream_executor/platform/default/dso_loader.cc:64] Could not load dynamic library 'libcudart.so.11.0'; dlerror: libcudart.so.11.0: cannot open shared object file: No such file or directory; LD_LIBRARY_PATH: /home/sgrafbe/mlwhatif/venv/lib/python3.9/site-packages/cv2/../../lib64:
2022-09-21 15:26:36.291253: I tensorflow/stream_executor/cuda/cudart_stub.cc:29] Ignore above cudart dlerror if you do not have a GPU set up on your machine.
2022-09-21 15:26:37 INFO  Patching sys.argv with ['mlwhatif', 'healthcare', 'slow_loading', 'featurization_2', 'logistic_regression']
2022-09-21 15:26:37 INFO  Running instrumented original pipeline...
2022-09-21 15:26:37 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-21 15:26:37 INFO  ---RUNTIME: Importing and monkey-patching took 95.31569480895996 ms
2022-09-21 15:26:39 INFO  ---RUNTIME: Original pipeline execution took 2081.383228302002 ms (excluding imports and monkey-patching)
2022-09-21 15:26:39 INFO  Starting execution of 0 what-if analyses...
2022-09-21 15:26:39 INFO  Estimated runtime of original DAG is 1818.6450004577637ms
2022-09-21 15:26:39 INFO  Performing Multi-Query Optimization
2022-09-21 15:26:39 INFO  Estimated unoptimized what-if runtime is 0ms
2022-09-21 15:26:39 INFO  Estimated optimised what-if runtime is 0ms
2022-09-21 15:26:39 INFO  Estimated optimisation runtime saving is 0ms
2022-09-21 15:26:39 INFO  ---RUNTIME: Multi-Query Optimization took 0.49185752868652344 ms
2022-09-21 15:26:39 INFO  Executing generated plans
2022-09-21 15:26:39 INFO  ---RUNTIME: Execution took 0.021696090698242188 ms
2022-09-21 15:26:39 INFO  Done!
2022-09-21 15:26:39 INFO  # Optimization benchmark for data_cleaning with args [['healthcare', 'slow_loading', 'featurization_2', 'logistic_regression']] -- repetition 1 of 7
2022-09-21 15:26:39 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-21 15:26:39 INFO  Running instrumented original pipeline...
2022-09-21 15:26:39 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-21 15:26:39 INFO  ---RUNTIME: Importing and monkey-patching took 5.086183547973633 ms
2022-09-21 15:26:41 INFO  ---RUNTIME: Original pipeline execution took 2000.7169246673584 ms (excluding imports and monkey-patching)
2022-09-21 15:26:41 INFO  Starting execution of 1 what-if analyses...
2022-09-21 15:26:41 INFO  Start plan generation for analysis DataCleaning...
2022-09-21 15:26:41 INFO  ---RUNTIME: Plan generation took 0.7874965667724609 ms
2022-09-21 15:26:41 INFO  Estimated runtime of original DAG is 1771.4076042175293ms
2022-09-21 15:26:41 INFO  Performing Multi-Query Optimization
2022-09-21 15:26:41 INFO  Estimated unoptimized what-if runtime is 44291.96071624756ms
2022-09-21 15:26:41 INFO  Estimated optimised what-if runtime is 2022.9213237762451ms
2022-09-21 15:26:41 INFO  Estimated optimisation runtime saving is 42269.03939247131ms
2022-09-21 15:26:41 INFO  ---RUNTIME: Multi-Query Optimization took 132.66277313232422 ms
2022-09-21 15:26:41 INFO  Executing generated plans
2022-09-21 15:26:47 INFO  ---RUNTIME: Execution took 5841.246843338013 ms
2022-09-21 15:26:47 INFO  Done!
2022-09-21 15:26:47 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-21 15:26:47 INFO  Running instrumented original pipeline...
2022-09-21 15:26:47 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-21 15:26:47 INFO  ---RUNTIME: Importing and monkey-patching took 6.14476203918457 ms
2022-09-21 15:26:49 INFO  ---RUNTIME: Original pipeline execution took 2001.2352466583252 ms (excluding imports and monkey-patching)
2022-09-21 15:26:49 INFO  Starting execution of 1 what-if analyses...
2022-09-21 15:26:49 INFO  Start plan generation for analysis DataCleaning...
2022-09-21 15:26:49 INFO  ---RUNTIME: Plan generation took 0.7803440093994141 ms
2022-09-21 15:26:49 INFO  Estimated runtime of original DAG is 1773.5884189605713ms
2022-09-21 15:26:49 WARNING Skipping Multi-Query Optimization (instead, only applying patches)
2022-09-21 15:26:49 WARNING Columns ['full_name'] not present in train DAG after the train test split, only before!
2022-09-21 15:26:49 WARNING This could hint at data leakage!
2022-09-21 15:26:49 INFO  Estimated unoptimised what-if runtime is 44346.235036849976ms
2022-09-21 15:26:49 INFO  ---RUNTIME: Multi-Query Optimization took 28.46240997314453 ms
2022-09-21 15:26:49 INFO  Executing generated plans
2022-09-21 15:27:38 INFO  ---RUNTIME: Execution took 48859.74669456482 ms
2022-09-21 15:27:38 INFO  Done!
2022-09-21 15:27:38 INFO  # Finished -- repetition 1 of 7 
2022-09-21 15:27:38 INFO  # Optimization benchmark for data_cleaning with args [['healthcare', 'slow_loading', 'featurization_2', 'logistic_regression']] -- repetition 2 of 7
2022-09-21 15:27:38 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-21 15:27:38 INFO  Running instrumented original pipeline...
2022-09-21 15:27:38 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-21 15:27:38 INFO  ---RUNTIME: Importing and monkey-patching took 5.927085876464844 ms
2022-09-21 15:27:40 INFO  ---RUNTIME: Original pipeline execution took 1983.8361740112305 ms (excluding imports and monkey-patching)
2022-09-21 15:27:40 INFO  Starting execution of 1 what-if analyses...
2022-09-21 15:27:40 INFO  Start plan generation for analysis DataCleaning...
2022-09-21 15:27:40 INFO  ---RUNTIME: Plan generation took 0.8144378662109375 ms
2022-09-21 15:27:40 INFO  Estimated runtime of original DAG is 1756.5345764160156ms
2022-09-21 15:27:40 INFO  Performing Multi-Query Optimization
2022-09-21 15:27:40 INFO  Estimated unoptimized what-if runtime is 43919.89040374756ms
2022-09-21 15:27:40 INFO  Estimated optimised what-if runtime is 1999.2549419403076ms
2022-09-21 15:27:40 INFO  Estimated optimisation runtime saving is 41920.63546180725ms
2022-09-21 15:27:40 INFO  ---RUNTIME: Multi-Query Optimization took 131.17527961730957 ms
2022-09-21 15:27:40 INFO  Executing generated plans
2022-09-21 15:27:46 INFO  ---RUNTIME: Execution took 5941.319465637207 ms
2022-09-21 15:27:46 INFO  Done!
2022-09-21 15:27:46 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-21 15:27:46 INFO  Running instrumented original pipeline...
2022-09-21 15:27:46 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-21 15:27:46 INFO  ---RUNTIME: Importing and monkey-patching took 5.859136581420898 ms
2022-09-21 15:27:48 INFO  ---RUNTIME: Original pipeline execution took 2224.7440814971924 ms (excluding imports and monkey-patching)
2022-09-21 15:27:48 INFO  Starting execution of 1 what-if analyses...
2022-09-21 15:27:48 INFO  Start plan generation for analysis DataCleaning...
2022-09-21 15:27:48 INFO  ---RUNTIME: Plan generation took 0.7669925689697266 ms
2022-09-21 15:27:48 INFO  Estimated runtime of original DAG is 1822.1733570098877ms
2022-09-21 15:27:48 WARNING Skipping Multi-Query Optimization (instead, only applying patches)
2022-09-21 15:27:48 WARNING Columns ['full_name'] not present in train DAG after the train test split, only before!
2022-09-21 15:27:48 WARNING This could hint at data leakage!
2022-09-21 15:27:48 INFO  Estimated unoptimised what-if runtime is 45561.060190200806ms
2022-09-21 15:27:48 INFO  ---RUNTIME: Multi-Query Optimization took 28.722524642944336 ms
2022-09-21 15:27:48 INFO  Executing generated plans
2022-09-21 15:28:37 INFO  ---RUNTIME: Execution took 48817.63577461243 ms
2022-09-21 15:28:37 INFO  Done!
2022-09-21 15:28:37 INFO  # Finished -- repetition 2 of 7 
2022-09-21 15:28:37 INFO  # Optimization benchmark for data_cleaning with args [['healthcare', 'slow_loading', 'featurization_2', 'logistic_regression']] -- repetition 3 of 7
2022-09-21 15:28:37 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-21 15:28:37 INFO  Running instrumented original pipeline...
2022-09-21 15:28:37 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-21 15:28:37 INFO  ---RUNTIME: Importing and monkey-patching took 5.912065505981445 ms
2022-09-21 15:28:39 INFO  ---RUNTIME: Original pipeline execution took 2023.5238075256348 ms (excluding imports and monkey-patching)
2022-09-21 15:28:39 INFO  Starting execution of 1 what-if analyses...
2022-09-21 15:28:39 INFO  Start plan generation for analysis DataCleaning...
2022-09-21 15:28:39 INFO  ---RUNTIME: Plan generation took 0.7822513580322266 ms
2022-09-21 15:28:39 INFO  Estimated runtime of original DAG is 1796.7610359191895ms
2022-09-21 15:28:39 INFO  Performing Multi-Query Optimization
2022-09-21 15:28:39 INFO  Estimated unoptimized what-if runtime is 44925.72498321533ms
2022-09-21 15:28:39 INFO  Estimated optimised what-if runtime is 2040.1690006256104ms
2022-09-21 15:28:39 INFO  Estimated optimisation runtime saving is 42885.55598258972ms
2022-09-21 15:28:39 INFO  ---RUNTIME: Multi-Query Optimization took 131.27541542053223 ms
2022-09-21 15:28:39 INFO  Executing generated plans
2022-09-21 15:28:45 INFO  ---RUNTIME: Execution took 5955.986022949219 ms
2022-09-21 15:28:45 INFO  Done!
2022-09-21 15:28:45 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-21 15:28:45 INFO  Running instrumented original pipeline...
2022-09-21 15:28:45 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-21 15:28:45 INFO  ---RUNTIME: Importing and monkey-patching took 5.953073501586914 ms
2022-09-21 15:28:47 INFO  ---RUNTIME: Original pipeline execution took 2019.2673206329346 ms (excluding imports and monkey-patching)
2022-09-21 15:28:47 INFO  Starting execution of 1 what-if analyses...
2022-09-21 15:28:47 INFO  Start plan generation for analysis DataCleaning...
2022-09-21 15:28:47 INFO  ---RUNTIME: Plan generation took 0.7717609405517578 ms
2022-09-21 15:28:47 INFO  Estimated runtime of original DAG is 1792.0141220092773ms
2022-09-21 15:28:47 WARNING Skipping Multi-Query Optimization (instead, only applying patches)
2022-09-21 15:28:47 WARNING Columns ['full_name'] not present in train DAG after the train test split, only before!
2022-09-21 15:28:47 WARNING This could hint at data leakage!
2022-09-21 15:28:47 INFO  Estimated unoptimised what-if runtime is 44806.82468414307ms
2022-09-21 15:28:47 INFO  ---RUNTIME: Multi-Query Optimization took 28.62095832824707 ms
2022-09-21 15:28:47 INFO  Executing generated plans
2022-09-21 15:29:37 INFO  ---RUNTIME: Execution took 49621.29020690918 ms
2022-09-21 15:29:37 INFO  Done!
2022-09-21 15:29:37 INFO  # Finished -- repetition 3 of 7 
2022-09-21 15:29:37 INFO  # Optimization benchmark for data_cleaning with args [['healthcare', 'slow_loading', 'featurization_2', 'logistic_regression']] -- repetition 4 of 7
2022-09-21 15:29:37 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-21 15:29:37 INFO  Running instrumented original pipeline...
2022-09-21 15:29:37 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-21 15:29:37 INFO  ---RUNTIME: Importing and monkey-patching took 5.771160125732422 ms
2022-09-21 15:29:39 INFO  ---RUNTIME: Original pipeline execution took 2026.144027709961 ms (excluding imports and monkey-patching)
2022-09-21 15:29:39 INFO  Starting execution of 1 what-if analyses...
2022-09-21 15:29:39 INFO  Start plan generation for analysis DataCleaning...
2022-09-21 15:29:39 INFO  ---RUNTIME: Plan generation took 0.8780956268310547 ms
2022-09-21 15:29:39 INFO  Estimated runtime of original DAG is 1792.393445968628ms
2022-09-21 15:29:39 INFO  Performing Multi-Query Optimization
2022-09-21 15:29:39 INFO  Estimated unoptimized what-if runtime is 44817.43502616882ms
2022-09-21 15:29:39 INFO  Estimated optimised what-if runtime is 2064.1400814056396ms
2022-09-21 15:29:39 INFO  Estimated optimisation runtime saving is 42753.29494476318ms
2022-09-21 15:29:39 INFO  ---RUNTIME: Multi-Query Optimization took 151.06892585754395 ms
2022-09-21 15:29:39 INFO  Executing generated plans
2022-09-21 15:29:45 INFO  ---RUNTIME: Execution took 5993.690013885498 ms
2022-09-21 15:29:45 INFO  Done!
2022-09-21 15:29:45 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-21 15:29:45 INFO  Running instrumented original pipeline...
2022-09-21 15:29:45 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-21 15:29:45 INFO  ---RUNTIME: Importing and monkey-patching took 6.077766418457031 ms
2022-09-21 15:29:47 INFO  ---RUNTIME: Original pipeline execution took 2031.0897827148438 ms (excluding imports and monkey-patching)
2022-09-21 15:29:47 INFO  Starting execution of 1 what-if analyses...
2022-09-21 15:29:47 INFO  Start plan generation for analysis DataCleaning...
2022-09-21 15:29:47 INFO  ---RUNTIME: Plan generation took 1.0857582092285156 ms
2022-09-21 15:29:47 INFO  Estimated runtime of original DAG is 1802.2124767303467ms
2022-09-21 15:29:47 WARNING Skipping Multi-Query Optimization (instead, only applying patches)
2022-09-21 15:29:47 WARNING Columns ['full_name'] not present in train DAG after the train test split, only before!
2022-09-21 15:29:47 WARNING This could hint at data leakage!
2022-09-21 15:29:47 INFO  Estimated unoptimised what-if runtime is 45061.89227104187ms
2022-09-21 15:29:47 INFO  ---RUNTIME: Multi-Query Optimization took 29.77728843688965 ms
2022-09-21 15:29:47 INFO  Executing generated plans
2022-09-21 15:30:37 INFO  ---RUNTIME: Execution took 49417.34480857849 ms
2022-09-21 15:30:37 INFO  Done!
2022-09-21 15:30:37 INFO  # Finished -- repetition 4 of 7 
2022-09-21 15:30:37 INFO  # Optimization benchmark for data_cleaning with args [['healthcare', 'slow_loading', 'featurization_2', 'logistic_regression']] -- repetition 5 of 7
2022-09-21 15:30:37 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-21 15:30:37 INFO  Running instrumented original pipeline...
2022-09-21 15:30:37 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-21 15:30:37 INFO  ---RUNTIME: Importing and monkey-patching took 5.894184112548828 ms
2022-09-21 15:30:39 INFO  ---RUNTIME: Original pipeline execution took 2032.1307182312012 ms (excluding imports and monkey-patching)
2022-09-21 15:30:39 INFO  Starting execution of 1 what-if analyses...
2022-09-21 15:30:39 INFO  Start plan generation for analysis DataCleaning...
2022-09-21 15:30:39 INFO  ---RUNTIME: Plan generation took 0.7760524749755859 ms
2022-09-21 15:30:39 INFO  Estimated runtime of original DAG is 1802.6516437530518ms
2022-09-21 15:30:39 INFO  Performing Multi-Query Optimization
2022-09-21 15:30:39 INFO  Estimated unoptimized what-if runtime is 45072.784185409546ms
2022-09-21 15:30:39 INFO  Estimated optimised what-if runtime is 2047.0561981201172ms
2022-09-21 15:30:39 INFO  Estimated optimisation runtime saving is 43025.72798728943ms
2022-09-21 15:30:39 INFO  ---RUNTIME: Multi-Query Optimization took 131.38484954833984 ms
2022-09-21 15:30:39 INFO  Executing generated plans
2022-09-21 15:30:45 INFO  ---RUNTIME: Execution took 5997.884750366211 ms
2022-09-21 15:30:45 INFO  Done!
2022-09-21 15:30:45 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-21 15:30:45 INFO  Running instrumented original pipeline...
2022-09-21 15:30:45 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-21 15:30:45 INFO  ---RUNTIME: Importing and monkey-patching took 6.209373474121094 ms
2022-09-21 15:30:47 INFO  ---RUNTIME: Original pipeline execution took 2314.4211769104004 ms (excluding imports and monkey-patching)
2022-09-21 15:30:47 INFO  Starting execution of 1 what-if analyses...
2022-09-21 15:30:47 INFO  Start plan generation for analysis DataCleaning...
2022-09-21 15:30:47 INFO  ---RUNTIME: Plan generation took 0.7991790771484375 ms
2022-09-21 15:30:47 INFO  Estimated runtime of original DAG is 1876.943826675415ms
2022-09-21 15:30:47 WARNING Skipping Multi-Query Optimization (instead, only applying patches)
2022-09-21 15:30:47 WARNING Columns ['full_name'] not present in train DAG after the train test split, only before!
2022-09-21 15:30:47 WARNING This could hint at data leakage!
2022-09-21 15:30:47 INFO  Estimated unoptimised what-if runtime is 46930.553674697876ms
2022-09-21 15:30:47 INFO  ---RUNTIME: Multi-Query Optimization took 30.483007431030273 ms
2022-09-21 15:30:47 INFO  Executing generated plans
2022-09-21 15:31:39 INFO  ---RUNTIME: Execution took 51380.81169128418 ms
2022-09-21 15:31:39 INFO  Done!
2022-09-21 15:31:39 INFO  # Finished -- repetition 5 of 7 
2022-09-21 15:31:39 INFO  # Optimization benchmark for data_cleaning with args [['healthcare', 'slow_loading', 'featurization_2', 'logistic_regression']] -- repetition 6 of 7
2022-09-21 15:31:39 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-21 15:31:39 INFO  Running instrumented original pipeline...
2022-09-21 15:31:39 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-21 15:31:39 INFO  ---RUNTIME: Importing and monkey-patching took 6.264209747314453 ms
2022-09-21 15:31:41 INFO  ---RUNTIME: Original pipeline execution took 2091.489791870117 ms (excluding imports and monkey-patching)
2022-09-21 15:31:41 INFO  Starting execution of 1 what-if analyses...
2022-09-21 15:31:41 INFO  Start plan generation for analysis DataCleaning...
2022-09-21 15:31:41 INFO  ---RUNTIME: Plan generation took 0.8113384246826172 ms
2022-09-21 15:31:41 INFO  Estimated runtime of original DAG is 1858.7300777435303ms
2022-09-21 15:31:41 INFO  Performing Multi-Query Optimization
2022-09-21 15:31:41 INFO  Estimated unoptimized what-if runtime is 46475.36015510559ms
2022-09-21 15:31:41 INFO  Estimated optimised what-if runtime is 2113.0576133728027ms
2022-09-21 15:31:41 INFO  Estimated optimisation runtime saving is 44362.30254173279ms
2022-09-21 15:31:41 INFO  ---RUNTIME: Multi-Query Optimization took 138.34476470947266 ms
2022-09-21 15:31:41 INFO  Executing generated plans
2022-09-21 15:31:47 INFO  ---RUNTIME: Execution took 6228.318691253662 ms
2022-09-21 15:31:47 INFO  Done!
2022-09-21 15:31:47 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-21 15:31:47 INFO  Running instrumented original pipeline...
2022-09-21 15:31:47 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-21 15:31:47 INFO  ---RUNTIME: Importing and monkey-patching took 6.249189376831055 ms
2022-09-21 15:31:49 INFO  ---RUNTIME: Original pipeline execution took 2102.146625518799 ms (excluding imports and monkey-patching)
2022-09-21 15:31:49 INFO  Starting execution of 1 what-if analyses...
2022-09-21 15:31:49 INFO  Start plan generation for analysis DataCleaning...
2022-09-21 15:31:49 INFO  ---RUNTIME: Plan generation took 0.8034706115722656 ms
2022-09-21 15:31:49 INFO  Estimated runtime of original DAG is 1867.0928478240967ms
2022-09-21 15:31:49 WARNING Skipping Multi-Query Optimization (instead, only applying patches)
2022-09-21 15:31:49 WARNING Columns ['full_name'] not present in train DAG after the train test split, only before!
2022-09-21 15:31:49 WARNING This could hint at data leakage!
2022-09-21 15:31:49 INFO  Estimated unoptimised what-if runtime is 46684.210538864136ms
2022-09-21 15:31:49 INFO  ---RUNTIME: Multi-Query Optimization took 30.0900936126709 ms
2022-09-21 15:31:49 INFO  Executing generated plans
2022-09-21 15:32:41 INFO  ---RUNTIME: Execution took 51305.80472946167 ms
2022-09-21 15:32:41 INFO  Done!
2022-09-21 15:32:41 INFO  # Finished -- repetition 6 of 7 
2022-09-21 15:32:41 INFO  # Optimization benchmark for data_cleaning with args [['healthcare', 'slow_loading', 'featurization_2', 'logistic_regression']] -- repetition 7 of 7
2022-09-21 15:32:41 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-21 15:32:41 INFO  Running instrumented original pipeline...
2022-09-21 15:32:41 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-21 15:32:41 INFO  ---RUNTIME: Importing and monkey-patching took 5.933284759521484 ms
2022-09-21 15:32:43 INFO  ---RUNTIME: Original pipeline execution took 2309.576988220215 ms (excluding imports and monkey-patching)
2022-09-21 15:32:43 INFO  Starting execution of 1 what-if analyses...
2022-09-21 15:32:43 INFO  Start plan generation for analysis DataCleaning...
2022-09-21 15:32:43 INFO  ---RUNTIME: Plan generation took 0.7779598236083984 ms
2022-09-21 15:32:43 INFO  Estimated runtime of original DAG is 1873.6870288848877ms
2022-09-21 15:32:43 INFO  Performing Multi-Query Optimization
2022-09-21 15:32:43 INFO  Estimated unoptimized what-if runtime is 46848.93345832825ms
2022-09-21 15:32:43 INFO  Estimated optimised what-if runtime is 2117.605209350586ms
2022-09-21 15:32:43 INFO  Estimated optimisation runtime saving is 44731.32824897766ms
2022-09-21 15:32:43 INFO  ---RUNTIME: Multi-Query Optimization took 131.15668296813965 ms
2022-09-21 15:32:43 INFO  Executing generated plans
2022-09-21 15:32:49 INFO  ---RUNTIME: Execution took 6114.973068237305 ms
2022-09-21 15:32:49 INFO  Done!
2022-09-21 15:32:49 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-21 15:32:49 INFO  Running instrumented original pipeline...
2022-09-21 15:32:49 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-21 15:32:49 INFO  ---RUNTIME: Importing and monkey-patching took 6.165027618408203 ms
2022-09-21 15:32:51 INFO  ---RUNTIME: Original pipeline execution took 2031.3820838928223 ms (excluding imports and monkey-patching)
2022-09-21 15:32:51 INFO  Starting execution of 1 what-if analyses...
2022-09-21 15:32:51 INFO  Start plan generation for analysis DataCleaning...
2022-09-21 15:32:51 INFO  ---RUNTIME: Plan generation took 0.7812976837158203 ms
2022-09-21 15:32:51 INFO  Estimated runtime of original DAG is 1802.3920059204102ms
2022-09-21 15:32:51 WARNING Skipping Multi-Query Optimization (instead, only applying patches)
2022-09-21 15:32:51 WARNING Columns ['full_name'] not present in train DAG after the train test split, only before!
2022-09-21 15:32:51 WARNING This could hint at data leakage!
2022-09-21 15:32:51 INFO  Estimated unoptimised what-if runtime is 45066.603660583496ms
2022-09-21 15:32:51 INFO  ---RUNTIME: Multi-Query Optimization took 28.385400772094727 ms
2022-09-21 15:32:51 INFO  Executing generated plans
2022-09-21 15:33:41 INFO  ---RUNTIME: Execution took 50007.79747962952 ms
2022-09-21 15:33:41 INFO  Done!
2022-09-21 15:33:41 INFO  # Finished -- repetition 7 of 7 
2022-09-21 15:33:41 INFO  # Final results after all repetitions
2022-09-21 15:33:41 INFO     repetition  ... no_opt_what_if_execution_combined_model_training
0           0  ...                                      3030.312300
1           1  ...                                      2989.404440
2           2  ...                                      3206.210136
3           3  ...                                      3188.961029
4           4  ...                                      3314.774752
5           5  ...                                      3350.991011
6           6  ...                                      3432.024717

[7 rows x 26 columns]
taskset -c 128-135 PROTOCOL_BUFFERS_PYTHON_IMPLEMENTATION=python python3.9 benchmarks_end_to_end.py data_cleaning healthcare slow_loading featurization_2 xgboost
2022-09-21 15:33:43.779275: W tensorflow/stream_executor/platform/default/dso_loader.cc:64] Could not load dynamic library 'libcudart.so.11.0'; dlerror: libcudart.so.11.0: cannot open shared object file: No such file or directory; LD_LIBRARY_PATH: /home/sgrafbe/mlwhatif/venv/lib/python3.9/site-packages/cv2/../../lib64:
2022-09-21 15:33:43.779324: I tensorflow/stream_executor/cuda/cudart_stub.cc:29] Ignore above cudart dlerror if you do not have a GPU set up on your machine.
2022-09-21 15:33:45 INFO  Patching sys.argv with ['mlwhatif', 'healthcare', 'slow_loading', 'featurization_2', 'xgboost']
2022-09-21 15:33:45 INFO  Running instrumented original pipeline...
2022-09-21 15:33:45 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-21 15:33:45 INFO  ---RUNTIME: Importing and monkey-patching took 95.71003913879395 ms
2022-09-21 15:33:48 INFO  ---RUNTIME: Original pipeline execution took 3413.2139682769775 ms (excluding imports and monkey-patching)
2022-09-21 15:33:48 INFO  Starting execution of 0 what-if analyses...
2022-09-21 15:33:48 INFO  Estimated runtime of original DAG is 3145.77579498291ms
2022-09-21 15:33:48 INFO  Performing Multi-Query Optimization
2022-09-21 15:33:48 INFO  Estimated unoptimized what-if runtime is 0ms
2022-09-21 15:33:48 INFO  Estimated optimised what-if runtime is 0ms
2022-09-21 15:33:48 INFO  Estimated optimisation runtime saving is 0ms
2022-09-21 15:33:48 INFO  ---RUNTIME: Multi-Query Optimization took 0.4951953887939453 ms
2022-09-21 15:33:48 INFO  Executing generated plans
2022-09-21 15:33:48 INFO  ---RUNTIME: Execution took 0.02288818359375 ms
2022-09-21 15:33:48 INFO  Done!
2022-09-21 15:33:48 INFO  # Optimization benchmark for data_cleaning with args [['healthcare', 'slow_loading', 'featurization_2', 'xgboost']] -- repetition 1 of 7
2022-09-21 15:33:48 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-21 15:33:48 INFO  Running instrumented original pipeline...
2022-09-21 15:33:48 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-21 15:33:48 INFO  ---RUNTIME: Importing and monkey-patching took 5.51915168762207 ms
2022-09-21 15:33:50 INFO  ---RUNTIME: Original pipeline execution took 2268.8560485839844 ms (excluding imports and monkey-patching)
2022-09-21 15:33:50 INFO  Starting execution of 1 what-if analyses...
2022-09-21 15:33:50 INFO  Start plan generation for analysis DataCleaning...
2022-09-21 15:33:50 INFO  ---RUNTIME: Plan generation took 0.8380413055419922 ms
2022-09-21 15:33:50 INFO  Estimated runtime of original DAG is 2025.1939296722412ms
2022-09-21 15:33:50 INFO  Performing Multi-Query Optimization
2022-09-21 15:33:51 INFO  Estimated unoptimized what-if runtime is 51735.62932014465ms
2022-09-21 15:33:51 INFO  Estimated optimised what-if runtime is 7813.782691955566ms
2022-09-21 15:33:51 INFO  Estimated optimisation runtime saving is 43921.84662818909ms
2022-09-21 15:33:51 INFO  ---RUNTIME: Multi-Query Optimization took 312.54076957702637 ms
2022-09-21 15:33:51 INFO  Executing generated plans
2022-09-21 15:34:03 INFO  ---RUNTIME: Execution took 11936.724424362183 ms
2022-09-21 15:34:03 INFO  Done!
2022-09-21 15:34:03 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-21 15:34:03 INFO  Running instrumented original pipeline...
2022-09-21 15:34:03 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-21 15:34:03 INFO  ---RUNTIME: Importing and monkey-patching took 7.026433944702148 ms
2022-09-21 15:34:05 INFO  ---RUNTIME: Original pipeline execution took 2229.794979095459 ms (excluding imports and monkey-patching)
2022-09-21 15:34:05 INFO  Starting execution of 1 what-if analyses...
2022-09-21 15:34:05 INFO  Start plan generation for analysis DataCleaning...
2022-09-21 15:34:05 INFO  ---RUNTIME: Plan generation took 0.9431838989257812 ms
2022-09-21 15:34:05 INFO  Estimated runtime of original DAG is 1982.4752807617188ms
2022-09-21 15:34:05 WARNING Skipping Multi-Query Optimization (instead, only applying patches)
2022-09-21 15:34:05 WARNING Columns ['full_name'] not present in train DAG after the train test split, only before!
2022-09-21 15:34:05 WARNING This could hint at data leakage!
2022-09-21 15:34:05 INFO  Estimated unoptimised what-if runtime is 50662.4116897583ms
2022-09-21 15:34:05 INFO  ---RUNTIME: Multi-Query Optimization took 34.425973892211914 ms
2022-09-21 15:34:05 INFO  Executing generated plans
2022-09-21 15:34:59 INFO  ---RUNTIME: Execution took 54300.64392089844 ms
2022-09-21 15:34:59 INFO  Done!
2022-09-21 15:34:59 INFO  # Finished -- repetition 1 of 7 
2022-09-21 15:34:59 INFO  # Optimization benchmark for data_cleaning with args [['healthcare', 'slow_loading', 'featurization_2', 'xgboost']] -- repetition 2 of 7
2022-09-21 15:34:59 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-21 15:34:59 INFO  Running instrumented original pipeline...
2022-09-21 15:34:59 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-21 15:34:59 INFO  ---RUNTIME: Importing and monkey-patching took 6.407022476196289 ms
2022-09-21 15:35:01 INFO  ---RUNTIME: Original pipeline execution took 2204.0305137634277 ms (excluding imports and monkey-patching)
2022-09-21 15:35:01 INFO  Starting execution of 1 what-if analyses...
2022-09-21 15:35:01 INFO  Start plan generation for analysis DataCleaning...
2022-09-21 15:35:01 INFO  ---RUNTIME: Plan generation took 1.2438297271728516 ms
2022-09-21 15:35:01 INFO  Estimated runtime of original DAG is 1962.4099731445312ms
2022-09-21 15:35:01 INFO  Performing Multi-Query Optimization
2022-09-21 15:35:01 INFO  Estimated unoptimized what-if runtime is 50167.33932495117ms
2022-09-21 15:35:01 INFO  Estimated optimised what-if runtime is 7749.845743179321ms
2022-09-21 15:35:01 INFO  Estimated optimisation runtime saving is 42417.49358177185ms
2022-09-21 15:35:01 INFO  ---RUNTIME: Multi-Query Optimization took 128.45826148986816 ms
2022-09-21 15:35:01 INFO  Executing generated plans
2022-09-21 15:35:13 INFO  ---RUNTIME: Execution took 11516.093015670776 ms
2022-09-21 15:35:13 INFO  Done!
2022-09-21 15:35:13 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-21 15:35:13 INFO  Running instrumented original pipeline...
2022-09-21 15:35:13 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-21 15:35:13 INFO  ---RUNTIME: Importing and monkey-patching took 6.387233734130859 ms
2022-09-21 15:35:15 INFO  ---RUNTIME: Original pipeline execution took 2435.2781772613525 ms (excluding imports and monkey-patching)
2022-09-21 15:35:15 INFO  Starting execution of 1 what-if analyses...
2022-09-21 15:35:15 INFO  Start plan generation for analysis DataCleaning...
2022-09-21 15:35:15 INFO  ---RUNTIME: Plan generation took 0.7712841033935547 ms
2022-09-21 15:35:15 INFO  Estimated runtime of original DAG is 2195.876359939575ms
2022-09-21 15:35:15 WARNING Skipping Multi-Query Optimization (instead, only applying patches)
2022-09-21 15:35:15 WARNING Columns ['full_name'] not present in train DAG after the train test split, only before!
2022-09-21 15:35:15 WARNING This could hint at data leakage!
2022-09-21 15:35:15 INFO  Estimated unoptimised what-if runtime is 56004.772901535034ms
2022-09-21 15:35:15 INFO  ---RUNTIME: Multi-Query Optimization took 28.289794921875 ms
2022-09-21 15:35:15 INFO  Executing generated plans
2022-09-21 15:36:10 INFO  ---RUNTIME: Execution took 54610.8136177063 ms
2022-09-21 15:36:10 INFO  Done!
2022-09-21 15:36:10 INFO  # Finished -- repetition 2 of 7 
2022-09-21 15:36:10 INFO  # Optimization benchmark for data_cleaning with args [['healthcare', 'slow_loading', 'featurization_2', 'xgboost']] -- repetition 3 of 7
2022-09-21 15:36:10 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-21 15:36:10 INFO  Running instrumented original pipeline...
2022-09-21 15:36:10 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-21 15:36:10 INFO  ---RUNTIME: Importing and monkey-patching took 6.317377090454102 ms
2022-09-21 15:36:12 INFO  ---RUNTIME: Original pipeline execution took 2196.9616413116455 ms (excluding imports and monkey-patching)
2022-09-21 15:36:12 INFO  Starting execution of 1 what-if analyses...
2022-09-21 15:36:12 INFO  Start plan generation for analysis DataCleaning...
2022-09-21 15:36:12 INFO  ---RUNTIME: Plan generation took 0.8194446563720703 ms
2022-09-21 15:36:12 INFO  Estimated runtime of original DAG is 1959.6471786499023ms
2022-09-21 15:36:12 INFO  Performing Multi-Query Optimization
2022-09-21 15:36:12 INFO  Estimated unoptimized what-if runtime is 50093.62745285034ms
2022-09-21 15:36:12 INFO  Estimated optimised what-if runtime is 7721.127510070801ms
2022-09-21 15:36:12 INFO  Estimated optimisation runtime saving is 42372.49994277954ms
2022-09-21 15:36:12 INFO  ---RUNTIME: Multi-Query Optimization took 128.0348300933838 ms
2022-09-21 15:36:12 INFO  Executing generated plans
2022-09-21 15:36:24 INFO  ---RUNTIME: Execution took 11543.267965316772 ms
2022-09-21 15:36:24 INFO  Done!
2022-09-21 15:36:24 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-21 15:36:24 INFO  Running instrumented original pipeline...
2022-09-21 15:36:24 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-21 15:36:24 INFO  ---RUNTIME: Importing and monkey-patching took 6.334066390991211 ms
2022-09-21 15:36:26 INFO  ---RUNTIME: Original pipeline execution took 2178.5075664520264 ms (excluding imports and monkey-patching)
2022-09-21 15:36:26 INFO  Starting execution of 1 what-if analyses...
2022-09-21 15:36:26 INFO  Start plan generation for analysis DataCleaning...
2022-09-21 15:36:26 INFO  ---RUNTIME: Plan generation took 0.8056163787841797 ms
2022-09-21 15:36:26 INFO  Estimated runtime of original DAG is 1939.896821975708ms
2022-09-21 15:36:26 WARNING Skipping Multi-Query Optimization (instead, only applying patches)
2022-09-21 15:36:26 WARNING Columns ['full_name'] not present in train DAG after the train test split, only before!
2022-09-21 15:36:26 WARNING This could hint at data leakage!
2022-09-21 15:36:26 INFO  Estimated unoptimised what-if runtime is 49601.914167404175ms
2022-09-21 15:36:26 INFO  ---RUNTIME: Multi-Query Optimization took 28.16176414489746 ms
2022-09-21 15:36:26 INFO  Executing generated plans
2022-09-21 15:37:21 INFO  ---RUNTIME: Execution took 54391.71266555786 ms
2022-09-21 15:37:21 INFO  Done!
2022-09-21 15:37:21 INFO  # Finished -- repetition 3 of 7 
2022-09-21 15:37:21 INFO  # Optimization benchmark for data_cleaning with args [['healthcare', 'slow_loading', 'featurization_2', 'xgboost']] -- repetition 4 of 7
2022-09-21 15:37:21 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-21 15:37:21 INFO  Running instrumented original pipeline...
2022-09-21 15:37:21 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-21 15:37:21 INFO  ---RUNTIME: Importing and monkey-patching took 6.241083145141602 ms
2022-09-21 15:37:23 INFO  ---RUNTIME: Original pipeline execution took 2151.453971862793 ms (excluding imports and monkey-patching)
2022-09-21 15:37:23 INFO  Starting execution of 1 what-if analyses...
2022-09-21 15:37:23 INFO  Start plan generation for analysis DataCleaning...
2022-09-21 15:37:23 INFO  ---RUNTIME: Plan generation took 0.8141994476318359 ms
2022-09-21 15:37:23 INFO  Estimated runtime of original DAG is 1913.7883186340332ms
2022-09-21 15:37:23 INFO  Performing Multi-Query Optimization
2022-09-21 15:37:23 INFO  Estimated unoptimized what-if runtime is 48944.07320022583ms
2022-09-21 15:37:23 INFO  Estimated optimised what-if runtime is 7660.856485366821ms
2022-09-21 15:37:23 INFO  Estimated optimisation runtime saving is 41283.21671485901ms
2022-09-21 15:37:23 INFO  ---RUNTIME: Multi-Query Optimization took 128.96037101745605 ms
2022-09-21 15:37:23 INFO  Executing generated plans
2022-09-21 15:37:34 INFO  ---RUNTIME: Execution took 11497.682332992554 ms
2022-09-21 15:37:34 INFO  Done!
2022-09-21 15:37:34 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-21 15:37:34 INFO  Running instrumented original pipeline...
2022-09-21 15:37:34 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-21 15:37:34 INFO  ---RUNTIME: Importing and monkey-patching took 6.482839584350586 ms
2022-09-21 15:37:37 INFO  ---RUNTIME: Original pipeline execution took 2169.9647903442383 ms (excluding imports and monkey-patching)
2022-09-21 15:37:37 INFO  Starting execution of 1 what-if analyses...
2022-09-21 15:37:37 INFO  Start plan generation for analysis DataCleaning...
2022-09-21 15:37:37 INFO  ---RUNTIME: Plan generation took 0.8103847503662109 ms
2022-09-21 15:37:37 INFO  Estimated runtime of original DAG is 1932.8887462615967ms
2022-09-21 15:37:37 WARNING Skipping Multi-Query Optimization (instead, only applying patches)
2022-09-21 15:37:37 WARNING Columns ['full_name'] not present in train DAG after the train test split, only before!
2022-09-21 15:37:37 WARNING This could hint at data leakage!
2022-09-21 15:37:37 INFO  Estimated unoptimised what-if runtime is 49426.278829574585ms
2022-09-21 15:37:37 INFO  ---RUNTIME: Multi-Query Optimization took 28.35392951965332 ms
2022-09-21 15:37:37 INFO  Executing generated plans
2022-09-21 15:38:31 INFO  ---RUNTIME: Execution took 54216.71509742737 ms
2022-09-21 15:38:31 INFO  Done!
2022-09-21 15:38:31 INFO  # Finished -- repetition 4 of 7 
2022-09-21 15:38:31 INFO  # Optimization benchmark for data_cleaning with args [['healthcare', 'slow_loading', 'featurization_2', 'xgboost']] -- repetition 5 of 7
2022-09-21 15:38:31 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-21 15:38:31 INFO  Running instrumented original pipeline...
2022-09-21 15:38:31 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-21 15:38:31 INFO  ---RUNTIME: Importing and monkey-patching took 6.512641906738281 ms
2022-09-21 15:38:33 INFO  ---RUNTIME: Original pipeline execution took 2164.1194820404053 ms (excluding imports and monkey-patching)
2022-09-21 15:38:33 INFO  Starting execution of 1 what-if analyses...
2022-09-21 15:38:33 INFO  Start plan generation for analysis DataCleaning...
2022-09-21 15:38:33 INFO  ---RUNTIME: Plan generation took 0.8232593536376953 ms
2022-09-21 15:38:33 INFO  Estimated runtime of original DAG is 1927.1864891052246ms
2022-09-21 15:38:33 INFO  Performing Multi-Query Optimization
2022-09-21 15:38:33 INFO  Estimated unoptimized what-if runtime is 49282.22751617432ms
2022-09-21 15:38:33 INFO  Estimated optimised what-if runtime is 7690.742492675781ms
2022-09-21 15:38:33 INFO  Estimated optimisation runtime saving is 41591.485023498535ms
2022-09-21 15:38:33 INFO  ---RUNTIME: Multi-Query Optimization took 352.72216796875 ms
2022-09-21 15:38:33 INFO  Executing generated plans
2022-09-21 15:38:45 INFO  ---RUNTIME: Execution took 11682.273864746094 ms
2022-09-21 15:38:45 INFO  Done!
2022-09-21 15:38:45 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-21 15:38:45 INFO  Running instrumented original pipeline...
2022-09-21 15:38:45 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-21 15:38:45 INFO  ---RUNTIME: Importing and monkey-patching took 6.238698959350586 ms
2022-09-21 15:38:47 INFO  ---RUNTIME: Original pipeline execution took 2185.1515769958496 ms (excluding imports and monkey-patching)
2022-09-21 15:38:47 INFO  Starting execution of 1 what-if analyses...
2022-09-21 15:38:47 INFO  Start plan generation for analysis DataCleaning...
2022-09-21 15:38:47 INFO  ---RUNTIME: Plan generation took 0.8170604705810547 ms
2022-09-21 15:38:47 INFO  Estimated runtime of original DAG is 1945.5533027648926ms
2022-09-21 15:38:47 WARNING Skipping Multi-Query Optimization (instead, only applying patches)
2022-09-21 15:38:47 WARNING Columns ['full_name'] not present in train DAG after the train test split, only before!
2022-09-21 15:38:47 WARNING This could hint at data leakage!
2022-09-21 15:38:47 INFO  Estimated unoptimised what-if runtime is 49747.66492843628ms
2022-09-21 15:38:47 INFO  ---RUNTIME: Multi-Query Optimization took 28.261184692382812 ms
2022-09-21 15:38:47 INFO  Executing generated plans
2022-09-21 15:39:41 INFO  ---RUNTIME: Execution took 54001.87706947327 ms
2022-09-21 15:39:41 INFO  Done!
2022-09-21 15:39:41 INFO  # Finished -- repetition 5 of 7 
2022-09-21 15:39:41 INFO  # Optimization benchmark for data_cleaning with args [['healthcare', 'slow_loading', 'featurization_2', 'xgboost']] -- repetition 6 of 7
2022-09-21 15:39:41 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-21 15:39:41 INFO  Running instrumented original pipeline...
2022-09-21 15:39:41 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-21 15:39:41 INFO  ---RUNTIME: Importing and monkey-patching took 6.397247314453125 ms
2022-09-21 15:39:43 INFO  ---RUNTIME: Original pipeline execution took 2166.9633388519287 ms (excluding imports and monkey-patching)
2022-09-21 15:39:43 INFO  Starting execution of 1 what-if analyses...
2022-09-21 15:39:43 INFO  Start plan generation for analysis DataCleaning...
2022-09-21 15:39:43 INFO  ---RUNTIME: Plan generation took 0.8113384246826172 ms
2022-09-21 15:39:43 INFO  Estimated runtime of original DAG is 1928.2505512237549ms
2022-09-21 15:39:43 INFO  Performing Multi-Query Optimization
2022-09-21 15:39:44 INFO  Estimated unoptimized what-if runtime is 49308.671712875366ms
2022-09-21 15:39:44 INFO  Estimated optimised what-if runtime is 7690.0794506073ms
2022-09-21 15:39:44 INFO  Estimated optimisation runtime saving is 41618.59226226807ms
2022-09-21 15:39:44 INFO  ---RUNTIME: Multi-Query Optimization took 128.74317169189453 ms
2022-09-21 15:39:44 INFO  Executing generated plans
2022-09-21 15:39:55 INFO  ---RUNTIME: Execution took 11563.047409057617 ms
2022-09-21 15:39:55 INFO  Done!
2022-09-21 15:39:55 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-21 15:39:55 INFO  Running instrumented original pipeline...
2022-09-21 15:39:55 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-21 15:39:55 INFO  ---RUNTIME: Importing and monkey-patching took 6.21485710144043 ms
2022-09-21 15:39:57 INFO  ---RUNTIME: Original pipeline execution took 2312.455177307129 ms (excluding imports and monkey-patching)
2022-09-21 15:39:57 INFO  Starting execution of 1 what-if analyses...
2022-09-21 15:39:57 INFO  Start plan generation for analysis DataCleaning...
2022-09-21 15:39:57 INFO  ---RUNTIME: Plan generation took 0.8106231689453125 ms
2022-09-21 15:39:57 INFO  Estimated runtime of original DAG is 2070.7240104675293ms
2022-09-21 15:39:57 WARNING Skipping Multi-Query Optimization (instead, only applying patches)
2022-09-21 15:39:57 WARNING Columns ['full_name'] not present in train DAG after the train test split, only before!
2022-09-21 15:39:57 WARNING This could hint at data leakage!
2022-09-21 15:39:57 INFO  Estimated unoptimised what-if runtime is 52868.916034698486ms
2022-09-21 15:39:57 INFO  ---RUNTIME: Multi-Query Optimization took 28.3048152923584 ms
2022-09-21 15:39:57 INFO  Executing generated plans
2022-09-21 15:40:52 INFO  ---RUNTIME: Execution took 55005.63025474548 ms
2022-09-21 15:40:52 INFO  Done!
2022-09-21 15:40:52 INFO  # Finished -- repetition 6 of 7 
2022-09-21 15:40:52 INFO  # Optimization benchmark for data_cleaning with args [['healthcare', 'slow_loading', 'featurization_2', 'xgboost']] -- repetition 7 of 7
2022-09-21 15:40:52 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-21 15:40:52 INFO  Running instrumented original pipeline...
2022-09-21 15:40:53 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-21 15:40:53 INFO  ---RUNTIME: Importing and monkey-patching took 6.096839904785156 ms
2022-09-21 15:40:55 INFO  ---RUNTIME: Original pipeline execution took 2170.1571941375732 ms (excluding imports and monkey-patching)
2022-09-21 15:40:55 INFO  Starting execution of 1 what-if analyses...
2022-09-21 15:40:55 INFO  Start plan generation for analysis DataCleaning...
2022-09-21 15:40:55 INFO  ---RUNTIME: Plan generation took 0.78582763671875 ms
2022-09-21 15:40:55 INFO  Estimated runtime of original DAG is 1932.11030960083ms
2022-09-21 15:40:55 INFO  Performing Multi-Query Optimization
2022-09-21 15:40:55 INFO  Estimated unoptimized what-if runtime is 49405.388832092285ms
2022-09-21 15:40:55 INFO  Estimated optimised what-if runtime is 7699.040412902832ms
2022-09-21 15:40:55 INFO  Estimated optimisation runtime saving is 41706.34841918945ms
2022-09-21 15:40:55 INFO  ---RUNTIME: Multi-Query Optimization took 128.17692756652832 ms
2022-09-21 15:40:55 INFO  Executing generated plans
2022-09-21 15:41:06 INFO  ---RUNTIME: Execution took 11695.73187828064 ms
2022-09-21 15:41:06 INFO  Done!
2022-09-21 15:41:06 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-21 15:41:06 INFO  Running instrumented original pipeline...
2022-09-21 15:41:07 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-21 15:41:07 INFO  ---RUNTIME: Importing and monkey-patching took 6.07609748840332 ms
2022-09-21 15:41:09 INFO  ---RUNTIME: Original pipeline execution took 2184.3881607055664 ms (excluding imports and monkey-patching)
2022-09-21 15:41:09 INFO  Starting execution of 1 what-if analyses...
2022-09-21 15:41:09 INFO  Start plan generation for analysis DataCleaning...
2022-09-21 15:41:09 INFO  ---RUNTIME: Plan generation took 0.8792877197265625 ms
2022-09-21 15:41:09 INFO  Estimated runtime of original DAG is 1943.5248374938965ms
2022-09-21 15:41:09 WARNING Skipping Multi-Query Optimization (instead, only applying patches)
2022-09-21 15:41:09 WARNING Columns ['full_name'] not present in train DAG after the train test split, only before!
2022-09-21 15:41:09 WARNING This could hint at data leakage!
2022-09-21 15:41:09 INFO  Estimated unoptimised what-if runtime is 49711.82203292847ms
2022-09-21 15:41:09 INFO  ---RUNTIME: Multi-Query Optimization took 28.36012840270996 ms
2022-09-21 15:41:09 INFO  Executing generated plans
2022-09-21 15:42:03 INFO  ---RUNTIME: Execution took 54206.16340637207 ms
2022-09-21 15:42:03 INFO  Done!
2022-09-21 15:42:03 INFO  # Finished -- repetition 7 of 7 
2022-09-21 15:42:03 INFO  # Final results after all repetitions
2022-09-21 15:42:03 INFO     repetition  ... no_opt_what_if_execution_combined_model_training
0           0  ...                                      8721.240044
1           1  ...                                      8743.942976
2           2  ...                                      8873.567104
3           3  ...                                      8990.459681
4           4  ...                                      8811.567307
5           5  ...                                      8976.271629
6           6  ...                                      8951.480389

[7 rows x 26 columns]
taskset -c 128-135 PROTOCOL_BUFFERS_PYTHON_IMPLEMENTATION=python python3.9 benchmarks_end_to_end.py data_cleaning healthcare slow_loading featurization_2 neural_network
2022-09-21 15:42:05.413707: W tensorflow/stream_executor/platform/default/dso_loader.cc:64] Could not load dynamic library 'libcudart.so.11.0'; dlerror: libcudart.so.11.0: cannot open shared object file: No such file or directory; LD_LIBRARY_PATH: /home/sgrafbe/mlwhatif/venv/lib/python3.9/site-packages/cv2/../../lib64:
2022-09-21 15:42:05.413752: I tensorflow/stream_executor/cuda/cudart_stub.cc:29] Ignore above cudart dlerror if you do not have a GPU set up on your machine.
2022-09-21 15:42:06 INFO  Patching sys.argv with ['mlwhatif', 'healthcare', 'slow_loading', 'featurization_2', 'neural_network']
2022-09-21 15:42:06 INFO  Running instrumented original pipeline...
2022-09-21 15:42:06 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-21 15:42:06 INFO  ---RUNTIME: Importing and monkey-patching took 95.07489204406738 ms
2022-09-21 15:42:08.786476: W tensorflow/stream_executor/platform/default/dso_loader.cc:64] Could not load dynamic library 'libcuda.so.1'; dlerror: libcuda.so.1: cannot open shared object file: No such file or directory; LD_LIBRARY_PATH: /home/sgrafbe/mlwhatif/venv/lib/python3.9/site-packages/cv2/../../lib64:
2022-09-21 15:42:08.786518: W tensorflow/stream_executor/cuda/cuda_driver.cc:326] failed call to cuInit: UNKNOWN ERROR (303)
2022-09-21 15:42:08.786541: I tensorflow/stream_executor/cuda/cuda_diagnostics.cc:156] kernel driver does not appear to be running on this host (wagyu): /proc/driver/nvidia/version does not exist
2022-09-21 15:42:08.787034: I tensorflow/core/platform/cpu_feature_guard.cc:142] This TensorFlow binary is optimized with oneAPI Deep Neural Network Library (oneDNN) to use the following CPU instructions in performance-critical operations:  AVX2 FMA
To enable them in other operations, rebuild TensorFlow with the appropriate compiler flags.
2022-09-21 15:42:09.325082: I tensorflow/compiler/mlir/mlir_graph_optimization_pass.cc:176] None of the MLIR Optimization Passes are enabled (registered 2)
2022-09-21 15:42:09.338374: I tensorflow/core/platform/profile_utils/cpu_utils.cc:114] CPU Frequency: 2595290000 Hz
2022-09-21 15:42:09 INFO  ---RUNTIME: Original pipeline execution took 2833.1692218780518 ms (excluding imports and monkey-patching)
2022-09-21 15:42:09 INFO  Starting execution of 0 what-if analyses...
2022-09-21 15:42:09 INFO  Estimated runtime of original DAG is 2573.9128589630127ms
2022-09-21 15:42:09 INFO  Performing Multi-Query Optimization
2022-09-21 15:42:09 INFO  Estimated unoptimized what-if runtime is 0ms
2022-09-21 15:42:09 INFO  Estimated optimised what-if runtime is 0ms
2022-09-21 15:42:09 INFO  Estimated optimisation runtime saving is 0ms
2022-09-21 15:42:09 INFO  ---RUNTIME: Multi-Query Optimization took 0.47326087951660156 ms
2022-09-21 15:42:09 INFO  Executing generated plans
2022-09-21 15:42:09 INFO  ---RUNTIME: Execution took 0.015735626220703125 ms
2022-09-21 15:42:09 INFO  Done!
2022-09-21 15:42:09 INFO  # Optimization benchmark for data_cleaning with args [['healthcare', 'slow_loading', 'featurization_2', 'neural_network']] -- repetition 1 of 7
2022-09-21 15:42:09 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-21 15:42:09 INFO  Running instrumented original pipeline...
2022-09-21 15:42:09 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-21 15:42:09 INFO  ---RUNTIME: Importing and monkey-patching took 5.118846893310547 ms
2022-09-21 15:42:12 INFO  ---RUNTIME: Original pipeline execution took 2477.7612686157227 ms (excluding imports and monkey-patching)
2022-09-21 15:42:12 INFO  Starting execution of 1 what-if analyses...
2022-09-21 15:42:12 INFO  Start plan generation for analysis DataCleaning...
2022-09-21 15:42:12 INFO  ---RUNTIME: Plan generation took 2.0003318786621094 ms
2022-09-21 15:42:12 INFO  Estimated runtime of original DAG is 2245.4123497009277ms
2022-09-21 15:42:12 INFO  Performing Multi-Query Optimization
2022-09-21 15:42:12 INFO  Estimated unoptimized what-if runtime is 58711.82584762573ms
2022-09-21 15:42:12 INFO  Estimated optimised what-if runtime is 16626.48892402649ms
2022-09-21 15:42:12 INFO  Estimated optimisation runtime saving is 42085.33692359924ms
2022-09-21 15:42:12 INFO  ---RUNTIME: Multi-Query Optimization took 129.32443618774414 ms
2022-09-21 15:42:12 INFO  Executing generated plans
2022-09-21 15:42:34 INFO  ---RUNTIME: Execution took 22562.023878097534 ms
2022-09-21 15:42:34 INFO  Done!
2022-09-21 15:42:34 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-21 15:42:34 INFO  Running instrumented original pipeline...
2022-09-21 15:42:34 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-21 15:42:34 INFO  ---RUNTIME: Importing and monkey-patching took 6.21795654296875 ms
2022-09-21 15:42:37 INFO  ---RUNTIME: Original pipeline execution took 2462.209463119507 ms (excluding imports and monkey-patching)
2022-09-21 15:42:37 INFO  Starting execution of 1 what-if analyses...
2022-09-21 15:42:37 INFO  Start plan generation for analysis DataCleaning...
2022-09-21 15:42:37 INFO  ---RUNTIME: Plan generation took 0.8363723754882812 ms
2022-09-21 15:42:37 INFO  Estimated runtime of original DAG is 2231.1882972717285ms
2022-09-21 15:42:37 WARNING Skipping Multi-Query Optimization (instead, only applying patches)
2022-09-21 15:42:37 WARNING Columns ['full_name'] not present in train DAG after the train test split, only before!
2022-09-21 15:42:37 WARNING This could hint at data leakage!
2022-09-21 15:42:37 INFO  Estimated unoptimised what-if runtime is 58348.9031791687ms
2022-09-21 15:42:37 INFO  ---RUNTIME: Multi-Query Optimization took 28.239965438842773 ms
2022-09-21 15:42:37 INFO  Executing generated plans
2022-09-21 15:43:42 INFO  ---RUNTIME: Execution took 65688.38286399841 ms
2022-09-21 15:43:42 INFO  Done!
2022-09-21 15:43:42 INFO  # Finished -- repetition 1 of 7 
2022-09-21 15:43:42 INFO  # Optimization benchmark for data_cleaning with args [['healthcare', 'slow_loading', 'featurization_2', 'neural_network']] -- repetition 2 of 7
2022-09-21 15:43:42 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-21 15:43:42 INFO  Running instrumented original pipeline...
2022-09-21 15:43:43 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-21 15:43:43 INFO  ---RUNTIME: Importing and monkey-patching took 6.088018417358398 ms
2022-09-21 15:43:45 INFO  ---RUNTIME: Original pipeline execution took 2759.047269821167 ms (excluding imports and monkey-patching)
2022-09-21 15:43:45 INFO  Starting execution of 1 what-if analyses...
2022-09-21 15:43:45 INFO  Start plan generation for analysis DataCleaning...
2022-09-21 15:43:45 INFO  ---RUNTIME: Plan generation took 0.9732246398925781 ms
2022-09-21 15:43:45 INFO  Estimated runtime of original DAG is 2239.5570278167725ms
2022-09-21 15:43:45 INFO  Performing Multi-Query Optimization
2022-09-21 15:43:45 INFO  Estimated unoptimized what-if runtime is 58584.83338356018ms
2022-09-21 15:43:45 INFO  Estimated optimised what-if runtime is 16778.36847305298ms
2022-09-21 15:43:45 INFO  Estimated optimisation runtime saving is 41806.4649105072ms
2022-09-21 15:43:45 INFO  ---RUNTIME: Multi-Query Optimization took 133.19635391235352 ms
2022-09-21 15:43:45 INFO  Executing generated plans
2022-09-21 15:44:08 INFO  ---RUNTIME: Execution took 23120.81217765808 ms
2022-09-21 15:44:08 INFO  Done!
2022-09-21 15:44:08 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-21 15:44:08 INFO  Running instrumented original pipeline...
2022-09-21 15:44:09 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-21 15:44:09 INFO  ---RUNTIME: Importing and monkey-patching took 6.155252456665039 ms
2022-09-21 15:44:11 INFO  ---RUNTIME: Original pipeline execution took 2455.3754329681396 ms (excluding imports and monkey-patching)
2022-09-21 15:44:11 INFO  Starting execution of 1 what-if analyses...
2022-09-21 15:44:11 INFO  Start plan generation for analysis DataCleaning...
2022-09-21 15:44:11 INFO  ---RUNTIME: Plan generation took 0.8664131164550781 ms
2022-09-21 15:44:11 INFO  Estimated runtime of original DAG is 2223.936080932617ms
2022-09-21 15:44:11 WARNING Skipping Multi-Query Optimization (instead, only applying patches)
2022-09-21 15:44:11 WARNING Columns ['full_name'] not present in train DAG after the train test split, only before!
2022-09-21 15:44:11 WARNING This could hint at data leakage!
2022-09-21 15:44:11 INFO  Estimated unoptimised what-if runtime is 58188.32731246948ms
2022-09-21 15:44:11 INFO  ---RUNTIME: Multi-Query Optimization took 28.252363204956055 ms
2022-09-21 15:44:11 INFO  Executing generated plans
2022-09-21 15:45:17 INFO  ---RUNTIME: Execution took 66520.94507217407 ms
2022-09-21 15:45:17 INFO  Done!
2022-09-21 15:45:17 INFO  # Finished -- repetition 2 of 7 
2022-09-21 15:45:17 INFO  # Optimization benchmark for data_cleaning with args [['healthcare', 'slow_loading', 'featurization_2', 'neural_network']] -- repetition 3 of 7
2022-09-21 15:45:17 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-21 15:45:17 INFO  Running instrumented original pipeline...
2022-09-21 15:45:18 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-21 15:45:18 INFO  ---RUNTIME: Importing and monkey-patching took 5.735158920288086 ms
2022-09-21 15:45:20 INFO  ---RUNTIME: Original pipeline execution took 2453.4029960632324 ms (excluding imports and monkey-patching)
2022-09-21 15:45:20 INFO  Starting execution of 1 what-if analyses...
2022-09-21 15:45:20 INFO  Start plan generation for analysis DataCleaning...
2022-09-21 15:45:20 INFO  ---RUNTIME: Plan generation took 0.8692741394042969 ms
2022-09-21 15:45:20 INFO  Estimated runtime of original DAG is 2225.3787517547607ms
2022-09-21 15:45:20 INFO  Performing Multi-Query Optimization
2022-09-21 15:45:20 INFO  Estimated unoptimized what-if runtime is 58239.10403251648ms
2022-09-21 15:45:20 INFO  Estimated optimised what-if runtime is 16746.384859085083ms
2022-09-21 15:45:20 INFO  Estimated optimisation runtime saving is 41492.7191734314ms
2022-09-21 15:45:20 INFO  ---RUNTIME: Multi-Query Optimization took 129.685640335083 ms
2022-09-21 15:45:20 INFO  Executing generated plans
2022-09-21 15:45:44 INFO  ---RUNTIME: Execution took 24061.561107635498 ms
2022-09-21 15:45:44 INFO  Done!
2022-09-21 15:45:44 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-21 15:45:44 INFO  Running instrumented original pipeline...
2022-09-21 15:45:44 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-21 15:45:44 INFO  ---RUNTIME: Importing and monkey-patching took 6.090641021728516 ms
2022-09-21 15:45:47 INFO  ---RUNTIME: Original pipeline execution took 2501.9853115081787 ms (excluding imports and monkey-patching)
2022-09-21 15:45:47 INFO  Starting execution of 1 what-if analyses...
2022-09-21 15:45:47 INFO  Start plan generation for analysis DataCleaning...
2022-09-21 15:45:47 INFO  ---RUNTIME: Plan generation took 0.8847713470458984 ms
2022-09-21 15:45:47 INFO  Estimated runtime of original DAG is 2270.153760910034ms
2022-09-21 15:45:47 WARNING Skipping Multi-Query Optimization (instead, only applying patches)
2022-09-21 15:45:47 WARNING Columns ['full_name'] not present in train DAG after the train test split, only before!
2022-09-21 15:45:47 WARNING This could hint at data leakage!
2022-09-21 15:45:47 INFO  Estimated unoptimised what-if runtime is 59301.98407173157ms
2022-09-21 15:45:47 INFO  ---RUNTIME: Multi-Query Optimization took 28.34606170654297 ms
2022-09-21 15:45:47 INFO  Executing generated plans
2022-09-21 15:46:54 INFO  ---RUNTIME: Execution took 66975.91066360474 ms
2022-09-21 15:46:54 INFO  Done!
2022-09-21 15:46:54 INFO  # Finished -- repetition 3 of 7 
2022-09-21 15:46:54 INFO  # Optimization benchmark for data_cleaning with args [['healthcare', 'slow_loading', 'featurization_2', 'neural_network']] -- repetition 4 of 7
2022-09-21 15:46:54 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-21 15:46:54 INFO  Running instrumented original pipeline...
2022-09-21 15:46:54 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-21 15:46:54 INFO  ---RUNTIME: Importing and monkey-patching took 5.978822708129883 ms
2022-09-21 15:46:56 INFO  ---RUNTIME: Original pipeline execution took 2492.6087856292725 ms (excluding imports and monkey-patching)
2022-09-21 15:46:56 INFO  Starting execution of 1 what-if analyses...
2022-09-21 15:46:56 INFO  Start plan generation for analysis DataCleaning...
2022-09-21 15:46:56 INFO  ---RUNTIME: Plan generation took 0.9694099426269531 ms
2022-09-21 15:46:56 INFO  Estimated runtime of original DAG is 2259.4292163848877ms
2022-09-21 15:46:56 INFO  Performing Multi-Query Optimization
2022-09-21 15:46:56 INFO  Estimated unoptimized what-if runtime is 59053.79033088684ms
2022-09-21 15:46:56 INFO  Estimated optimised what-if runtime is 16654.975652694702ms
2022-09-21 15:46:56 INFO  Estimated optimisation runtime saving is 42398.81467819214ms
2022-09-21 15:46:56 INFO  ---RUNTIME: Multi-Query Optimization took 138.32378387451172 ms
2022-09-21 15:46:56 INFO  Executing generated plans
2022-09-21 15:47:20 INFO  ---RUNTIME: Execution took 24020.85256576538 ms
2022-09-21 15:47:20 INFO  Done!
2022-09-21 15:47:20 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-21 15:47:20 INFO  Running instrumented original pipeline...
2022-09-21 15:47:20 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-21 15:47:20 INFO  ---RUNTIME: Importing and monkey-patching took 5.948305130004883 ms
2022-09-21 15:47:23 INFO  ---RUNTIME: Original pipeline execution took 2476.505994796753 ms (excluding imports and monkey-patching)
2022-09-21 15:47:23 INFO  Starting execution of 1 what-if analyses...
2022-09-21 15:47:23 INFO  Start plan generation for analysis DataCleaning...
2022-09-21 15:47:23 INFO  ---RUNTIME: Plan generation took 0.9834766387939453 ms
2022-09-21 15:47:23 INFO  Estimated runtime of original DAG is 2244.28129196167ms
2022-09-21 15:47:23 WARNING Skipping Multi-Query Optimization (instead, only applying patches)
2022-09-21 15:47:23 WARNING Columns ['full_name'] not present in train DAG after the train test split, only before!
2022-09-21 15:47:23 WARNING This could hint at data leakage!
2022-09-21 15:47:23 INFO  Estimated unoptimised what-if runtime is 58740.04316329956ms
2022-09-21 15:47:23 INFO  ---RUNTIME: Multi-Query Optimization took 30.026912689208984 ms
2022-09-21 15:47:23 INFO  Executing generated plans
2022-09-21 15:48:30 INFO  ---RUNTIME: Execution took 67157.19079971313 ms
2022-09-21 15:48:30 INFO  Done!
2022-09-21 15:48:30 INFO  # Finished -- repetition 4 of 7 
2022-09-21 15:48:30 INFO  # Optimization benchmark for data_cleaning with args [['healthcare', 'slow_loading', 'featurization_2', 'neural_network']] -- repetition 5 of 7
2022-09-21 15:48:30 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-21 15:48:30 INFO  Running instrumented original pipeline...
2022-09-21 15:48:30 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-21 15:48:30 INFO  ---RUNTIME: Importing and monkey-patching took 6.165981292724609 ms
2022-09-21 15:48:32 INFO  ---RUNTIME: Original pipeline execution took 2450.4075050354004 ms (excluding imports and monkey-patching)
2022-09-21 15:48:32 INFO  Starting execution of 1 what-if analyses...
2022-09-21 15:48:32 INFO  Start plan generation for analysis DataCleaning...
2022-09-21 15:48:32 INFO  ---RUNTIME: Plan generation took 0.9527206420898438 ms
2022-09-21 15:48:32 INFO  Estimated runtime of original DAG is 2217.700719833374ms
2022-09-21 15:48:32 INFO  Performing Multi-Query Optimization
2022-09-21 15:48:33 INFO  Estimated unoptimized what-if runtime is 57998.63886833191ms
2022-09-21 15:48:33 INFO  Estimated optimised what-if runtime is 16494.876623153687ms
2022-09-21 15:48:33 INFO  Estimated optimisation runtime saving is 41503.76224517822ms
2022-09-21 15:48:33 INFO  ---RUNTIME: Multi-Query Optimization took 497.21264839172363 ms
2022-09-21 15:48:33 INFO  Executing generated plans
2022-09-21 15:48:57 INFO  ---RUNTIME: Execution took 23645.64275741577 ms
2022-09-21 15:48:57 INFO  Done!
2022-09-21 15:48:57 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-21 15:48:57 INFO  Running instrumented original pipeline...
2022-09-21 15:48:57 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-21 15:48:57 INFO  ---RUNTIME: Importing and monkey-patching took 6.443262100219727 ms
2022-09-21 15:48:59 INFO  ---RUNTIME: Original pipeline execution took 2476.041078567505 ms (excluding imports and monkey-patching)
2022-09-21 15:48:59 INFO  Starting execution of 1 what-if analyses...
2022-09-21 15:48:59 INFO  Start plan generation for analysis DataCleaning...
2022-09-21 15:48:59 INFO  ---RUNTIME: Plan generation took 0.8749961853027344 ms
2022-09-21 15:48:59 INFO  Estimated runtime of original DAG is 2243.496894836426ms
2022-09-21 15:48:59 WARNING Skipping Multi-Query Optimization (instead, only applying patches)
2022-09-21 15:48:59 WARNING Columns ['full_name'] not present in train DAG after the train test split, only before!
2022-09-21 15:48:59 WARNING This could hint at data leakage!
2022-09-21 15:48:59 INFO  Estimated unoptimised what-if runtime is 58638.89265060425ms
2022-09-21 15:48:59 INFO  ---RUNTIME: Multi-Query Optimization took 28.058528900146484 ms
2022-09-21 15:48:59 INFO  Executing generated plans
2022-09-21 15:50:06 INFO  ---RUNTIME: Execution took 67292.23322868347 ms
2022-09-21 15:50:06 INFO  Done!
2022-09-21 15:50:06 INFO  # Finished -- repetition 5 of 7 
2022-09-21 15:50:06 INFO  # Optimization benchmark for data_cleaning with args [['healthcare', 'slow_loading', 'featurization_2', 'neural_network']] -- repetition 6 of 7
2022-09-21 15:50:06 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-21 15:50:06 INFO  Running instrumented original pipeline...
2022-09-21 15:50:06 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-21 15:50:06 INFO  ---RUNTIME: Importing and monkey-patching took 6.196498870849609 ms
2022-09-21 15:50:09 INFO  ---RUNTIME: Original pipeline execution took 2473.8292694091797 ms (excluding imports and monkey-patching)
2022-09-21 15:50:09 INFO  Starting execution of 1 what-if analyses...
2022-09-21 15:50:09 INFO  Start plan generation for analysis DataCleaning...
2022-09-21 15:50:09 INFO  ---RUNTIME: Plan generation took 0.9427070617675781 ms
2022-09-21 15:50:09 INFO  Estimated runtime of original DAG is 2240.705728530884ms
2022-09-21 15:50:09 INFO  Performing Multi-Query Optimization
2022-09-21 15:50:09 INFO  Estimated unoptimized what-if runtime is 58631.19626045227ms
2022-09-21 15:50:09 INFO  Estimated optimised what-if runtime is 16818.583726882935ms
2022-09-21 15:50:09 INFO  Estimated optimisation runtime saving is 41812.612533569336ms
2022-09-21 15:50:09 INFO  ---RUNTIME: Multi-Query Optimization took 130.8903694152832 ms
2022-09-21 15:50:09 INFO  Executing generated plans
2022-09-21 15:50:33 INFO  ---RUNTIME: Execution took 24271.958589553833 ms
2022-09-21 15:50:33 INFO  Done!
2022-09-21 15:50:33 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-21 15:50:33 INFO  Running instrumented original pipeline...
2022-09-21 15:50:33 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-21 15:50:33 INFO  ---RUNTIME: Importing and monkey-patching took 6.21795654296875 ms
2022-09-21 15:50:36 INFO  ---RUNTIME: Original pipeline execution took 2452.552318572998 ms (excluding imports and monkey-patching)
2022-09-21 15:50:36 INFO  Starting execution of 1 what-if analyses...
2022-09-21 15:50:36 INFO  Start plan generation for analysis DataCleaning...
2022-09-21 15:50:36 INFO  ---RUNTIME: Plan generation took 0.9074211120605469 ms
2022-09-21 15:50:36 INFO  Estimated runtime of original DAG is 2220.2603816986084ms
2022-09-21 15:50:36 WARNING Skipping Multi-Query Optimization (instead, only applying patches)
2022-09-21 15:50:36 WARNING Columns ['full_name'] not present in train DAG after the train test split, only before!
2022-09-21 15:50:36 WARNING This could hint at data leakage!
2022-09-21 15:50:36 INFO  Estimated unoptimised what-if runtime is 58064.53442573547ms
2022-09-21 15:50:36 INFO  ---RUNTIME: Multi-Query Optimization took 28.336286544799805 ms
2022-09-21 15:50:36 INFO  Executing generated plans
2022-09-21 15:51:43 INFO  ---RUNTIME: Execution took 66872.40529060364 ms
2022-09-21 15:51:43 INFO  Done!
2022-09-21 15:51:43 INFO  # Finished -- repetition 6 of 7 
2022-09-21 15:51:43 INFO  # Optimization benchmark for data_cleaning with args [['healthcare', 'slow_loading', 'featurization_2', 'neural_network']] -- repetition 7 of 7
2022-09-21 15:51:43 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-21 15:51:43 INFO  Running instrumented original pipeline...
2022-09-21 15:51:43 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-21 15:51:43 INFO  ---RUNTIME: Importing and monkey-patching took 6.215095520019531 ms
2022-09-21 15:51:45 INFO  ---RUNTIME: Original pipeline execution took 2466.8619632720947 ms (excluding imports and monkey-patching)
2022-09-21 15:51:45 INFO  Starting execution of 1 what-if analyses...
2022-09-21 15:51:45 INFO  Start plan generation for analysis DataCleaning...
2022-09-21 15:51:45 INFO  ---RUNTIME: Plan generation took 1.0943412780761719 ms
2022-09-21 15:51:45 INFO  Estimated runtime of original DAG is 2234.1856956481934ms
2022-09-21 15:51:45 INFO  Performing Multi-Query Optimization
2022-09-21 15:51:45 INFO  Estimated unoptimized what-if runtime is 58431.01644515991ms
2022-09-21 15:51:45 INFO  Estimated optimised what-if runtime is 16641.671419143677ms
2022-09-21 15:51:45 INFO  Estimated optimisation runtime saving is 41789.345026016235ms
2022-09-21 15:51:45 INFO  ---RUNTIME: Multi-Query Optimization took 130.3722858428955 ms
2022-09-21 15:51:45 INFO  Executing generated plans
2022-09-21 15:52:10 INFO  ---RUNTIME: Execution took 24396.560430526733 ms
2022-09-21 15:52:10 INFO  Done!
2022-09-21 15:52:10 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-21 15:52:10 INFO  Running instrumented original pipeline...
2022-09-21 15:52:10 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-21 15:52:10 INFO  ---RUNTIME: Importing and monkey-patching took 6.542205810546875 ms
2022-09-21 15:52:12 INFO  ---RUNTIME: Original pipeline execution took 2460.246801376343 ms (excluding imports and monkey-patching)
2022-09-21 15:52:12 INFO  Starting execution of 1 what-if analyses...
2022-09-21 15:52:12 INFO  Start plan generation for analysis DataCleaning...
2022-09-21 15:52:12 INFO  ---RUNTIME: Plan generation took 0.8797645568847656 ms
2022-09-21 15:52:12 INFO  Estimated runtime of original DAG is 2227.7114391326904ms
2022-09-21 15:52:12 WARNING Skipping Multi-Query Optimization (instead, only applying patches)
2022-09-21 15:52:12 WARNING Columns ['full_name'] not present in train DAG after the train test split, only before!
2022-09-21 15:52:12 WARNING This could hint at data leakage!
2022-09-21 15:52:12 INFO  Estimated unoptimised what-if runtime is 58261.120557785034ms
2022-09-21 15:52:12 INFO  ---RUNTIME: Multi-Query Optimization took 28.543949127197266 ms
2022-09-21 15:52:12 INFO  Executing generated plans
2022-09-21 15:53:20 INFO  ---RUNTIME: Execution took 68131.58679008484 ms
2022-09-21 15:53:20 INFO  Done!
2022-09-21 15:53:20 INFO  # Finished -- repetition 7 of 7 
2022-09-21 15:53:20 INFO  # Final results after all repetitions
2022-09-21 15:53:20 INFO     repetition  ... no_opt_what_if_execution_combined_model_training
0           0  ...                                     19441.753149
1           1  ...                                     20273.942471
2           2  ...                                     19424.189091
3           3  ...                                     19487.413168
4           4  ...                                     20460.755348
5           5  ...                                     20506.950378
6           6  ...                                     20821.188450

[7 rows x 26 columns]
taskset -c 128-135 PROTOCOL_BUFFERS_PYTHON_IMPLEMENTATION=python python3.9 benchmarks_end_to_end.py data_cleaning healthcare slow_loading featurization_3 logistic_regression
2022-09-21 15:53:23.282618: W tensorflow/stream_executor/platform/default/dso_loader.cc:64] Could not load dynamic library 'libcudart.so.11.0'; dlerror: libcudart.so.11.0: cannot open shared object file: No such file or directory; LD_LIBRARY_PATH: /home/sgrafbe/mlwhatif/venv/lib/python3.9/site-packages/cv2/../../lib64:
2022-09-21 15:53:23.282667: I tensorflow/stream_executor/cuda/cudart_stub.cc:29] Ignore above cudart dlerror if you do not have a GPU set up on your machine.
2022-09-21 15:53:24 INFO  Patching sys.argv with ['mlwhatif', 'healthcare', 'slow_loading', 'featurization_3', 'logistic_regression']
2022-09-21 15:53:24 INFO  Running instrumented original pipeline...
2022-09-21 15:53:24 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-21 15:53:24 INFO  ---RUNTIME: Importing and monkey-patching took 94.87771987915039 ms
2022-09-21 15:53:26 INFO  ---RUNTIME: Original pipeline execution took 2190.4654502868652 ms (excluding imports and monkey-patching)
2022-09-21 15:53:26 INFO  Starting execution of 0 what-if analyses...
2022-09-21 15:53:26 INFO  Estimated runtime of original DAG is 1852.1332740783691ms
2022-09-21 15:53:26 INFO  Performing Multi-Query Optimization
2022-09-21 15:53:26 INFO  Estimated unoptimized what-if runtime is 0ms
2022-09-21 15:53:26 INFO  Estimated optimised what-if runtime is 0ms
2022-09-21 15:53:26 INFO  Estimated optimisation runtime saving is 0ms
2022-09-21 15:53:26 INFO  ---RUNTIME: Multi-Query Optimization took 0.5004405975341797 ms
2022-09-21 15:53:26 INFO  Executing generated plans
2022-09-21 15:53:26 INFO  ---RUNTIME: Execution took 0.0209808349609375 ms
2022-09-21 15:53:26 INFO  Done!
2022-09-21 15:53:26 INFO  # Optimization benchmark for data_cleaning with args [['healthcare', 'slow_loading', 'featurization_3', 'logistic_regression']] -- repetition 1 of 7
2022-09-21 15:53:26 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-21 15:53:26 INFO  Running instrumented original pipeline...
2022-09-21 15:53:26 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-21 15:53:26 INFO  ---RUNTIME: Importing and monkey-patching took 5.115747451782227 ms
2022-09-21 15:53:28 INFO  ---RUNTIME: Original pipeline execution took 2100.841760635376 ms (excluding imports and monkey-patching)
2022-09-21 15:53:28 INFO  Starting execution of 1 what-if analyses...
2022-09-21 15:53:28 INFO  Start plan generation for analysis DataCleaning...
2022-09-21 15:53:28 INFO  ---RUNTIME: Plan generation took 0.9083747863769531 ms
2022-09-21 15:53:28 INFO  Estimated runtime of original DAG is 1791.5887832641602ms
2022-09-21 15:53:28 INFO  Performing Multi-Query Optimization
2022-09-21 15:53:29 INFO  Estimated unoptimized what-if runtime is 44794.970989227295ms
2022-09-21 15:53:29 INFO  Estimated optimised what-if runtime is 2029.8843383789062ms
2022-09-21 15:53:29 INFO  Estimated optimisation runtime saving is 42765.08665084839ms
2022-09-21 15:53:29 INFO  ---RUNTIME: Multi-Query Optimization took 313.9834403991699 ms
2022-09-21 15:53:29 INFO  Executing generated plans
2022-09-21 15:53:35 INFO  ---RUNTIME: Execution took 5906.49938583374 ms
2022-09-21 15:53:35 INFO  Done!
2022-09-21 15:53:35 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-21 15:53:35 INFO  Running instrumented original pipeline...
2022-09-21 15:53:35 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-21 15:53:35 INFO  ---RUNTIME: Importing and monkey-patching took 6.231784820556641 ms
2022-09-21 15:53:37 INFO  ---RUNTIME: Original pipeline execution took 2176.10239982605 ms (excluding imports and monkey-patching)
2022-09-21 15:53:37 INFO  Starting execution of 1 what-if analyses...
2022-09-21 15:53:37 INFO  Start plan generation for analysis DataCleaning...
2022-09-21 15:53:37 INFO  ---RUNTIME: Plan generation took 1.1758804321289062 ms
2022-09-21 15:53:37 INFO  Estimated runtime of original DAG is 1866.8782711029053ms
2022-09-21 15:53:37 WARNING Skipping Multi-Query Optimization (instead, only applying patches)
2022-09-21 15:53:37 WARNING Columns ['full_name'] not present in train DAG after the train test split, only before!
2022-09-21 15:53:37 WARNING This could hint at data leakage!
2022-09-21 15:53:37 INFO  Estimated unoptimised what-if runtime is 46677.21247673035ms
2022-09-21 15:53:37 INFO  ---RUNTIME: Multi-Query Optimization took 31.93378448486328 ms
2022-09-21 15:53:37 INFO  Executing generated plans
2022-09-21 15:54:26 INFO  ---RUNTIME: Execution took 48756.63352012634 ms
2022-09-21 15:54:26 INFO  Done!
2022-09-21 15:54:26 INFO  # Finished -- repetition 1 of 7 
2022-09-21 15:54:26 INFO  # Optimization benchmark for data_cleaning with args [['healthcare', 'slow_loading', 'featurization_3', 'logistic_regression']] -- repetition 2 of 7
2022-09-21 15:54:26 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-21 15:54:26 INFO  Running instrumented original pipeline...
2022-09-21 15:54:26 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-21 15:54:26 INFO  ---RUNTIME: Importing and monkey-patching took 5.949497222900391 ms
2022-09-21 15:54:28 INFO  ---RUNTIME: Original pipeline execution took 2102.2136211395264 ms (excluding imports and monkey-patching)
2022-09-21 15:54:28 INFO  Starting execution of 1 what-if analyses...
2022-09-21 15:54:28 INFO  Start plan generation for analysis DataCleaning...
2022-09-21 15:54:28 INFO  ---RUNTIME: Plan generation took 0.8924007415771484 ms
2022-09-21 15:54:28 INFO  Estimated runtime of original DAG is 1795.438289642334ms
2022-09-21 15:54:28 INFO  Performing Multi-Query Optimization
2022-09-21 15:54:28 INFO  Estimated unoptimized what-if runtime is 44891.27445220947ms
2022-09-21 15:54:28 INFO  Estimated optimised what-if runtime is 2029.510498046875ms
2022-09-21 15:54:28 INFO  Estimated optimisation runtime saving is 42861.7639541626ms
2022-09-21 15:54:28 INFO  ---RUNTIME: Multi-Query Optimization took 151.54099464416504 ms
2022-09-21 15:54:28 INFO  Executing generated plans
2022-09-21 15:54:34 INFO  ---RUNTIME: Execution took 6077.181100845337 ms
2022-09-21 15:54:34 INFO  Done!
2022-09-21 15:54:34 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-21 15:54:34 INFO  Running instrumented original pipeline...
2022-09-21 15:54:34 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-21 15:54:34 INFO  ---RUNTIME: Importing and monkey-patching took 5.88226318359375 ms
2022-09-21 15:54:36 INFO  ---RUNTIME: Original pipeline execution took 2305.6962490081787 ms (excluding imports and monkey-patching)
2022-09-21 15:54:36 INFO  Starting execution of 1 what-if analyses...
2022-09-21 15:54:36 INFO  Start plan generation for analysis DataCleaning...
2022-09-21 15:54:36 INFO  ---RUNTIME: Plan generation took 1.088857650756836 ms
2022-09-21 15:54:36 INFO  Estimated runtime of original DAG is 1796.8449592590332ms
2022-09-21 15:54:36 WARNING Skipping Multi-Query Optimization (instead, only applying patches)
2022-09-21 15:54:36 WARNING Columns ['full_name'] not present in train DAG after the train test split, only before!
2022-09-21 15:54:36 WARNING This could hint at data leakage!
2022-09-21 15:54:36 INFO  Estimated unoptimised what-if runtime is 44926.51128768921ms
2022-09-21 15:54:36 INFO  ---RUNTIME: Multi-Query Optimization took 32.3491096496582 ms
2022-09-21 15:54:36 INFO  Executing generated plans
2022-09-21 15:55:25 INFO  ---RUNTIME: Execution took 48986.49835586548 ms
2022-09-21 15:55:25 INFO  Done!
2022-09-21 15:55:25 INFO  # Finished -- repetition 2 of 7 
2022-09-21 15:55:25 INFO  # Optimization benchmark for data_cleaning with args [['healthcare', 'slow_loading', 'featurization_3', 'logistic_regression']] -- repetition 3 of 7
2022-09-21 15:55:25 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-21 15:55:25 INFO  Running instrumented original pipeline...
2022-09-21 15:55:25 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-21 15:55:25 INFO  ---RUNTIME: Importing and monkey-patching took 5.806684494018555 ms
2022-09-21 15:55:27 INFO  ---RUNTIME: Original pipeline execution took 2084.3141078948975 ms (excluding imports and monkey-patching)
2022-09-21 15:55:27 INFO  Starting execution of 1 what-if analyses...
2022-09-21 15:55:27 INFO  Start plan generation for analysis DataCleaning...
2022-09-21 15:55:27 INFO  ---RUNTIME: Plan generation took 0.8652210235595703 ms
2022-09-21 15:55:27 INFO  Estimated runtime of original DAG is 1775.052547454834ms
2022-09-21 15:55:27 INFO  Performing Multi-Query Optimization
2022-09-21 15:55:28 INFO  Estimated unoptimized what-if runtime is 44381.50644302368ms
2022-09-21 15:55:28 INFO  Estimated optimised what-if runtime is 2011.5447044372559ms
2022-09-21 15:55:28 INFO  Estimated optimisation runtime saving is 42369.961738586426ms
2022-09-21 15:55:28 INFO  ---RUNTIME: Multi-Query Optimization took 151.4148712158203 ms
2022-09-21 15:55:28 INFO  Executing generated plans
2022-09-21 15:55:34 INFO  ---RUNTIME: Execution took 6170.562028884888 ms
2022-09-21 15:55:34 INFO  Done!
2022-09-21 15:55:34 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-21 15:55:34 INFO  Running instrumented original pipeline...
2022-09-21 15:55:34 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-21 15:55:34 INFO  ---RUNTIME: Importing and monkey-patching took 5.926609039306641 ms
2022-09-21 15:55:36 INFO  ---RUNTIME: Original pipeline execution took 2069.9009895324707 ms (excluding imports and monkey-patching)
2022-09-21 15:55:36 INFO  Starting execution of 1 what-if analyses...
2022-09-21 15:55:36 INFO  Start plan generation for analysis DataCleaning...
2022-09-21 15:55:36 INFO  ---RUNTIME: Plan generation took 0.8711814880371094 ms
2022-09-21 15:55:36 INFO  Estimated runtime of original DAG is 1763.0159854888916ms
2022-09-21 15:55:36 WARNING Skipping Multi-Query Optimization (instead, only applying patches)
2022-09-21 15:55:36 WARNING Columns ['full_name'] not present in train DAG after the train test split, only before!
2022-09-21 15:55:36 WARNING This could hint at data leakage!
2022-09-21 15:55:36 INFO  Estimated unoptimised what-if runtime is 44080.59811592102ms
2022-09-21 15:55:36 INFO  ---RUNTIME: Multi-Query Optimization took 32.84931182861328 ms
2022-09-21 15:55:36 INFO  Executing generated plans
2022-09-21 15:56:25 INFO  ---RUNTIME: Execution took 49077.21424102783 ms
2022-09-21 15:56:25 INFO  Done!
2022-09-21 15:56:25 INFO  # Finished -- repetition 3 of 7 
2022-09-21 15:56:25 INFO  # Optimization benchmark for data_cleaning with args [['healthcare', 'slow_loading', 'featurization_3', 'logistic_regression']] -- repetition 4 of 7
2022-09-21 15:56:25 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-21 15:56:25 INFO  Running instrumented original pipeline...
2022-09-21 15:56:25 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-21 15:56:25 INFO  ---RUNTIME: Importing and monkey-patching took 5.832195281982422 ms
2022-09-21 15:56:27 INFO  ---RUNTIME: Original pipeline execution took 2061.6610050201416 ms (excluding imports and monkey-patching)
2022-09-21 15:56:27 INFO  Starting execution of 1 what-if analyses...
2022-09-21 15:56:27 INFO  Start plan generation for analysis DataCleaning...
2022-09-21 15:56:27 INFO  ---RUNTIME: Plan generation took 1.0607242584228516 ms
2022-09-21 15:56:27 INFO  Estimated runtime of original DAG is 1745.5322742462158ms
2022-09-21 15:56:27 INFO  Performing Multi-Query Optimization
2022-09-21 15:56:27 INFO  Estimated unoptimized what-if runtime is 43644.1605091095ms
2022-09-21 15:56:27 INFO  Estimated optimised what-if runtime is 2009.2589855194092ms
2022-09-21 15:56:27 INFO  Estimated optimisation runtime saving is 41634.90152359009ms
2022-09-21 15:56:27 INFO  ---RUNTIME: Multi-Query Optimization took 170.11022567749023 ms
2022-09-21 15:56:27 INFO  Executing generated plans
2022-09-21 15:56:33 INFO  ---RUNTIME: Execution took 6302.418231964111 ms
2022-09-21 15:56:33 INFO  Done!
2022-09-21 15:56:33 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-21 15:56:33 INFO  Running instrumented original pipeline...
2022-09-21 15:56:34 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-21 15:56:34 INFO  ---RUNTIME: Importing and monkey-patching took 6.113290786743164 ms
2022-09-21 15:56:36 INFO  ---RUNTIME: Original pipeline execution took 2095.0353145599365 ms (excluding imports and monkey-patching)
2022-09-21 15:56:36 INFO  Starting execution of 1 what-if analyses...
2022-09-21 15:56:36 INFO  Start plan generation for analysis DataCleaning...
2022-09-21 15:56:36 INFO  ---RUNTIME: Plan generation took 0.865936279296875 ms
2022-09-21 15:56:36 INFO  Estimated runtime of original DAG is 1787.6155376434326ms
2022-09-21 15:56:36 WARNING Skipping Multi-Query Optimization (instead, only applying patches)
2022-09-21 15:56:36 WARNING Columns ['full_name'] not present in train DAG after the train test split, only before!
2022-09-21 15:56:36 WARNING This could hint at data leakage!
2022-09-21 15:56:36 INFO  Estimated unoptimised what-if runtime is 44695.63841819763ms
2022-09-21 15:56:36 INFO  ---RUNTIME: Multi-Query Optimization took 32.790422439575195 ms
2022-09-21 15:56:36 INFO  Executing generated plans
2022-09-21 15:57:25 INFO  ---RUNTIME: Execution took 49270.00546455383 ms
2022-09-21 15:57:25 INFO  Done!
2022-09-21 15:57:25 INFO  # Finished -- repetition 4 of 7 
2022-09-21 15:57:25 INFO  # Optimization benchmark for data_cleaning with args [['healthcare', 'slow_loading', 'featurization_3', 'logistic_regression']] -- repetition 5 of 7
2022-09-21 15:57:25 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-21 15:57:25 INFO  Running instrumented original pipeline...
2022-09-21 15:57:25 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-21 15:57:25 INFO  ---RUNTIME: Importing and monkey-patching took 6.7195892333984375 ms
2022-09-21 15:57:27 INFO  ---RUNTIME: Original pipeline execution took 2279.3588638305664 ms (excluding imports and monkey-patching)
2022-09-21 15:57:27 INFO  Starting execution of 1 what-if analyses...
2022-09-21 15:57:27 INFO  Start plan generation for analysis DataCleaning...
2022-09-21 15:57:27 INFO  ---RUNTIME: Plan generation took 0.9059906005859375 ms
2022-09-21 15:57:27 INFO  Estimated runtime of original DAG is 1956.4590454101562ms
2022-09-21 15:57:27 INFO  Performing Multi-Query Optimization
2022-09-21 15:57:27 INFO  Estimated unoptimized what-if runtime is 48916.71180725098ms
2022-09-21 15:57:27 INFO  Estimated optimised what-if runtime is 2197.6921558380127ms
2022-09-21 15:57:27 INFO  Estimated optimisation runtime saving is 46719.019651412964ms
2022-09-21 15:57:27 INFO  ---RUNTIME: Multi-Query Optimization took 154.07824516296387 ms
2022-09-21 15:57:27 INFO  Executing generated plans
2022-09-21 15:57:34 INFO  ---RUNTIME: Execution took 6289.016962051392 ms
2022-09-21 15:57:34 INFO  Done!
2022-09-21 15:57:34 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-21 15:57:34 INFO  Running instrumented original pipeline...
2022-09-21 15:57:34 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-21 15:57:34 INFO  ---RUNTIME: Importing and monkey-patching took 6.067514419555664 ms
2022-09-21 15:57:36 INFO  ---RUNTIME: Original pipeline execution took 2074.2321014404297 ms (excluding imports and monkey-patching)
2022-09-21 15:57:36 INFO  Starting execution of 1 what-if analyses...
2022-09-21 15:57:36 INFO  Start plan generation for analysis DataCleaning...
2022-09-21 15:57:36 INFO  ---RUNTIME: Plan generation took 0.8661746978759766 ms
2022-09-21 15:57:36 INFO  Estimated runtime of original DAG is 1765.1996612548828ms
2022-09-21 15:57:36 WARNING Skipping Multi-Query Optimization (instead, only applying patches)
2022-09-21 15:57:36 WARNING Columns ['full_name'] not present in train DAG after the train test split, only before!
2022-09-21 15:57:36 WARNING This could hint at data leakage!
2022-09-21 15:57:36 INFO  Estimated unoptimised what-if runtime is 44135.321617126465ms
2022-09-21 15:57:36 INFO  ---RUNTIME: Multi-Query Optimization took 32.83834457397461 ms
2022-09-21 15:57:36 INFO  Executing generated plans
2022-09-21 15:58:25 INFO  ---RUNTIME: Execution took 49455.84678649902 ms
2022-09-21 15:58:25 INFO  Done!
2022-09-21 15:58:25 INFO  # Finished -- repetition 5 of 7 
2022-09-21 15:58:25 INFO  # Optimization benchmark for data_cleaning with args [['healthcare', 'slow_loading', 'featurization_3', 'logistic_regression']] -- repetition 6 of 7
2022-09-21 15:58:25 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-21 15:58:25 INFO  Running instrumented original pipeline...
2022-09-21 15:58:25 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-21 15:58:25 INFO  ---RUNTIME: Importing and monkey-patching took 6.688594818115234 ms
2022-09-21 15:58:27 INFO  ---RUNTIME: Original pipeline execution took 2145.078420639038 ms (excluding imports and monkey-patching)
2022-09-21 15:58:27 INFO  Starting execution of 1 what-if analyses...
2022-09-21 15:58:27 INFO  Start plan generation for analysis DataCleaning...
2022-09-21 15:58:27 INFO  ---RUNTIME: Plan generation took 1.0347366333007812 ms
2022-09-21 15:58:27 INFO  Estimated runtime of original DAG is 1821.6557502746582ms
2022-09-21 15:58:27 INFO  Performing Multi-Query Optimization
2022-09-21 15:58:28 INFO  Estimated unoptimized what-if runtime is 45547.24168777466ms
2022-09-21 15:58:28 INFO  Estimated optimised what-if runtime is 2083.5933685302734ms
2022-09-21 15:58:28 INFO  Estimated optimisation runtime saving is 43463.648319244385ms
2022-09-21 15:58:28 INFO  ---RUNTIME: Multi-Query Optimization took 160.3527069091797 ms
2022-09-21 15:58:28 INFO  Executing generated plans
2022-09-21 15:58:34 INFO  ---RUNTIME: Execution took 6367.406129837036 ms
2022-09-21 15:58:34 INFO  Done!
2022-09-21 15:58:34 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-21 15:58:34 INFO  Running instrumented original pipeline...
2022-09-21 15:58:34 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-21 15:58:34 INFO  ---RUNTIME: Importing and monkey-patching took 5.958318710327148 ms
2022-09-21 15:58:36 INFO  ---RUNTIME: Original pipeline execution took 2067.318916320801 ms (excluding imports and monkey-patching)
2022-09-21 15:58:36 INFO  Starting execution of 1 what-if analyses...
2022-09-21 15:58:36 INFO  Start plan generation for analysis DataCleaning...
2022-09-21 15:58:36 INFO  ---RUNTIME: Plan generation took 1.1754035949707031 ms
2022-09-21 15:58:36 INFO  Estimated runtime of original DAG is 1743.1912422180176ms
2022-09-21 15:58:36 WARNING Skipping Multi-Query Optimization (instead, only applying patches)
2022-09-21 15:58:36 WARNING Columns ['full_name'] not present in train DAG after the train test split, only before!
2022-09-21 15:58:36 WARNING This could hint at data leakage!
2022-09-21 15:58:36 INFO  Estimated unoptimised what-if runtime is 43584.95807647705ms
2022-09-21 15:58:36 INFO  ---RUNTIME: Multi-Query Optimization took 32.29784965515137 ms
2022-09-21 15:58:36 INFO  Executing generated plans
2022-09-21 15:59:26 INFO  ---RUNTIME: Execution took 49718.01447868347 ms
2022-09-21 15:59:26 INFO  Done!
2022-09-21 15:59:26 INFO  # Finished -- repetition 6 of 7 
2022-09-21 15:59:26 INFO  # Optimization benchmark for data_cleaning with args [['healthcare', 'slow_loading', 'featurization_3', 'logistic_regression']] -- repetition 7 of 7
2022-09-21 15:59:26 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-21 15:59:26 INFO  Running instrumented original pipeline...
2022-09-21 15:59:26 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-21 15:59:26 INFO  ---RUNTIME: Importing and monkey-patching took 5.8383941650390625 ms
2022-09-21 15:59:28 INFO  ---RUNTIME: Original pipeline execution took 2098.8423824310303 ms (excluding imports and monkey-patching)
2022-09-21 15:59:28 INFO  Starting execution of 1 what-if analyses...
2022-09-21 15:59:28 INFO  Start plan generation for analysis DataCleaning...
2022-09-21 15:59:28 INFO  ---RUNTIME: Plan generation took 0.8854866027832031 ms
2022-09-21 15:59:28 INFO  Estimated runtime of original DAG is 1790.5819416046143ms
2022-09-21 15:59:28 INFO  Performing Multi-Query Optimization
2022-09-21 15:59:28 INFO  Estimated unoptimized what-if runtime is 44769.75989341736ms
2022-09-21 15:59:28 INFO  Estimated optimised what-if runtime is 2024.4321823120117ms
2022-09-21 15:59:28 INFO  Estimated optimisation runtime saving is 42745.32771110535ms
2022-09-21 15:59:28 INFO  ---RUNTIME: Multi-Query Optimization took 150.50625801086426 ms
2022-09-21 15:59:28 INFO  Executing generated plans
2022-09-21 15:59:34 INFO  ---RUNTIME: Execution took 6479.506731033325 ms
2022-09-21 15:59:34 INFO  Done!
2022-09-21 15:59:34 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-21 15:59:34 INFO  Running instrumented original pipeline...
2022-09-21 15:59:34 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-21 15:59:34 INFO  ---RUNTIME: Importing and monkey-patching took 6.226301193237305 ms
2022-09-21 15:59:37 INFO  ---RUNTIME: Original pipeline execution took 2073.0910301208496 ms (excluding imports and monkey-patching)
2022-09-21 15:59:37 INFO  Starting execution of 1 what-if analyses...
2022-09-21 15:59:37 INFO  Start plan generation for analysis DataCleaning...
2022-09-21 15:59:37 INFO  ---RUNTIME: Plan generation took 0.8690357208251953 ms
2022-09-21 15:59:37 INFO  Estimated runtime of original DAG is 1760.6041431427002ms
2022-09-21 15:59:37 WARNING Skipping Multi-Query Optimization (instead, only applying patches)
2022-09-21 15:59:37 WARNING Columns ['full_name'] not present in train DAG after the train test split, only before!
2022-09-21 15:59:37 WARNING This could hint at data leakage!
2022-09-21 15:59:37 INFO  Estimated unoptimised what-if runtime is 44020.58672904968ms
2022-09-21 15:59:37 INFO  ---RUNTIME: Multi-Query Optimization took 32.21440315246582 ms
2022-09-21 15:59:37 INFO  Executing generated plans
2022-09-21 16:00:26 INFO  ---RUNTIME: Execution took 49256.343603134155 ms
2022-09-21 16:00:26 INFO  Done!
2022-09-21 16:00:26 INFO  # Finished -- repetition 7 of 7 
2022-09-21 16:00:26 INFO  # Final results after all repetitions
2022-09-21 16:00:26 INFO     repetition  ... no_opt_what_if_execution_combined_model_training
0           0  ...                                      3179.053068
1           1  ...                                      3356.371403
2           2  ...                                      3478.258133
3           3  ...                                      3547.184467
4           4  ...                                      3725.065947
5           5  ...                                      3672.765493
6           6  ...                                      3713.081837

[7 rows x 26 columns]
taskset -c 128-135 PROTOCOL_BUFFERS_PYTHON_IMPLEMENTATION=python python3.9 benchmarks_end_to_end.py data_cleaning healthcare slow_loading featurization_3 xgboost
2022-09-21 16:00:28.431166: W tensorflow/stream_executor/platform/default/dso_loader.cc:64] Could not load dynamic library 'libcudart.so.11.0'; dlerror: libcudart.so.11.0: cannot open shared object file: No such file or directory; LD_LIBRARY_PATH: /home/sgrafbe/mlwhatif/venv/lib/python3.9/site-packages/cv2/../../lib64:
2022-09-21 16:00:28.431209: I tensorflow/stream_executor/cuda/cudart_stub.cc:29] Ignore above cudart dlerror if you do not have a GPU set up on your machine.
2022-09-21 16:00:29 INFO  Patching sys.argv with ['mlwhatif', 'healthcare', 'slow_loading', 'featurization_3', 'xgboost']
2022-09-21 16:00:29 INFO  Running instrumented original pipeline...
2022-09-21 16:00:29 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-21 16:00:29 INFO  ---RUNTIME: Importing and monkey-patching took 95.98636627197266 ms
2022-09-21 16:00:45 INFO  ---RUNTIME: Original pipeline execution took 15324.605226516724 ms (excluding imports and monkey-patching)
2022-09-21 16:00:45 INFO  Starting execution of 0 what-if analyses...
2022-09-21 16:00:45 INFO  Estimated runtime of original DAG is 14967.275619506836ms
2022-09-21 16:00:45 INFO  Performing Multi-Query Optimization
2022-09-21 16:00:45 INFO  Estimated unoptimized what-if runtime is 0ms
2022-09-21 16:00:45 INFO  Estimated optimised what-if runtime is 0ms
2022-09-21 16:00:45 INFO  Estimated optimisation runtime saving is 0ms
2022-09-21 16:00:45 INFO  ---RUNTIME: Multi-Query Optimization took 0.5521774291992188 ms
2022-09-21 16:00:45 INFO  Executing generated plans
2022-09-21 16:00:45 INFO  ---RUNTIME: Execution took 0.021219253540039062 ms
2022-09-21 16:00:45 INFO  Done!
2022-09-21 16:00:45 INFO  # Optimization benchmark for data_cleaning with args [['healthcare', 'slow_loading', 'featurization_3', 'xgboost']] -- repetition 1 of 7
2022-09-21 16:00:45 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-21 16:00:45 INFO  Running instrumented original pipeline...
2022-09-21 16:00:45 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-21 16:00:45 INFO  ---RUNTIME: Importing and monkey-patching took 5.135297775268555 ms
2022-09-21 16:00:47 INFO  ---RUNTIME: Original pipeline execution took 2295.4049110412598 ms (excluding imports and monkey-patching)
2022-09-21 16:00:47 INFO  Starting execution of 1 what-if analyses...
2022-09-21 16:00:47 INFO  Start plan generation for analysis DataCleaning...
2022-09-21 16:00:47 INFO  ---RUNTIME: Plan generation took 0.9636878967285156 ms
2022-09-21 16:00:47 INFO  Estimated runtime of original DAG is 1970.0140953063965ms
2022-09-21 16:00:47 INFO  Performing Multi-Query Optimization
2022-09-21 16:00:47 INFO  Estimated unoptimized what-if runtime is 50376.094818115234ms
2022-09-21 16:00:47 INFO  Estimated optimised what-if runtime is 7857.833385467529ms
2022-09-21 16:00:47 INFO  Estimated optimisation runtime saving is 42518.261432647705ms
2022-09-21 16:00:47 INFO  ---RUNTIME: Multi-Query Optimization took 337.435245513916 ms
2022-09-21 16:00:47 INFO  Executing generated plans
2022-09-21 16:00:59 INFO  ---RUNTIME: Execution took 12026.531219482422 ms
2022-09-21 16:00:59 INFO  Done!
2022-09-21 16:00:59 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-21 16:00:59 INFO  Running instrumented original pipeline...
2022-09-21 16:00:59 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-21 16:00:59 INFO  ---RUNTIME: Importing and monkey-patching took 6.482601165771484 ms
2022-09-21 16:01:02 INFO  ---RUNTIME: Original pipeline execution took 2285.172700881958 ms (excluding imports and monkey-patching)
2022-09-21 16:01:02 INFO  Starting execution of 1 what-if analyses...
2022-09-21 16:01:02 INFO  Start plan generation for analysis DataCleaning...
2022-09-21 16:01:02 INFO  ---RUNTIME: Plan generation took 1.3146400451660156 ms
2022-09-21 16:01:02 INFO  Estimated runtime of original DAG is 1966.1083221435547ms
2022-09-21 16:01:02 WARNING Skipping Multi-Query Optimization (instead, only applying patches)
2022-09-21 16:01:02 WARNING Columns ['full_name'] not present in train DAG after the train test split, only before!
2022-09-21 16:01:02 WARNING This could hint at data leakage!
2022-09-21 16:01:02 INFO  Estimated unoptimised what-if runtime is 50273.42367172241ms
2022-09-21 16:01:02 INFO  ---RUNTIME: Multi-Query Optimization took 32.88912773132324 ms
2022-09-21 16:01:02 INFO  Executing generated plans
2022-09-21 16:01:57 INFO  ---RUNTIME: Execution took 54879.626512527466 ms
2022-09-21 16:01:57 INFO  Done!
2022-09-21 16:01:57 INFO  # Finished -- repetition 1 of 7 
2022-09-21 16:01:57 INFO  # Optimization benchmark for data_cleaning with args [['healthcare', 'slow_loading', 'featurization_3', 'xgboost']] -- repetition 2 of 7
2022-09-21 16:01:57 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-21 16:01:57 INFO  Running instrumented original pipeline...
2022-09-21 16:01:57 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-21 16:01:57 INFO  ---RUNTIME: Importing and monkey-patching took 6.501197814941406 ms
2022-09-21 16:01:59 INFO  ---RUNTIME: Original pipeline execution took 2354.76016998291 ms (excluding imports and monkey-patching)
2022-09-21 16:01:59 INFO  Starting execution of 1 what-if analyses...
2022-09-21 16:01:59 INFO  Start plan generation for analysis DataCleaning...
2022-09-21 16:01:59 INFO  ---RUNTIME: Plan generation took 0.9942054748535156 ms
2022-09-21 16:01:59 INFO  Estimated runtime of original DAG is 2027.9581546783447ms
2022-09-21 16:01:59 INFO  Performing Multi-Query Optimization
2022-09-21 16:01:59 INFO  Estimated unoptimized what-if runtime is 51838.43922615051ms
2022-09-21 16:01:59 INFO  Estimated optimised what-if runtime is 7984.361171722412ms
2022-09-21 16:01:59 INFO  Estimated optimisation runtime saving is 43854.0780544281ms
2022-09-21 16:01:59 INFO  ---RUNTIME: Multi-Query Optimization took 162.72735595703125 ms
2022-09-21 16:01:59 INFO  Executing generated plans
2022-09-21 16:02:11 INFO  ---RUNTIME: Execution took 12241.620779037476 ms
2022-09-21 16:02:11 INFO  Done!
2022-09-21 16:02:11 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-21 16:02:11 INFO  Running instrumented original pipeline...
2022-09-21 16:02:11 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-21 16:02:11 INFO  ---RUNTIME: Importing and monkey-patching took 6.007909774780273 ms
2022-09-21 16:02:14 INFO  ---RUNTIME: Original pipeline execution took 2356.7423820495605 ms (excluding imports and monkey-patching)
2022-09-21 16:02:14 INFO  Starting execution of 1 what-if analyses...
2022-09-21 16:02:14 INFO  Start plan generation for analysis DataCleaning...
2022-09-21 16:02:14 INFO  ---RUNTIME: Plan generation took 1.2879371643066406 ms
2022-09-21 16:02:14 INFO  Estimated runtime of original DAG is 2030.364751815796ms
2022-09-21 16:02:14 WARNING Skipping Multi-Query Optimization (instead, only applying patches)
2022-09-21 16:02:14 WARNING Columns ['full_name'] not present in train DAG after the train test split, only before!
2022-09-21 16:02:14 WARNING This could hint at data leakage!
2022-09-21 16:02:14 INFO  Estimated unoptimised what-if runtime is 51904.16741371155ms
2022-09-21 16:02:14 INFO  ---RUNTIME: Multi-Query Optimization took 34.65557098388672 ms
2022-09-21 16:02:14 INFO  Executing generated plans
2022-09-21 16:03:08 INFO  ---RUNTIME: Execution took 54695.250034332275 ms
2022-09-21 16:03:08 INFO  Done!
2022-09-21 16:03:08 INFO  # Finished -- repetition 2 of 7 
2022-09-21 16:03:08 INFO  # Optimization benchmark for data_cleaning with args [['healthcare', 'slow_loading', 'featurization_3', 'xgboost']] -- repetition 3 of 7
2022-09-21 16:03:08 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-21 16:03:08 INFO  Running instrumented original pipeline...
2022-09-21 16:03:08 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-21 16:03:08 INFO  ---RUNTIME: Importing and monkey-patching took 6.345272064208984 ms
2022-09-21 16:03:11 INFO  ---RUNTIME: Original pipeline execution took 2311.1326694488525 ms (excluding imports and monkey-patching)
2022-09-21 16:03:11 INFO  Starting execution of 1 what-if analyses...
2022-09-21 16:03:11 INFO  Start plan generation for analysis DataCleaning...
2022-09-21 16:03:11 INFO  ---RUNTIME: Plan generation took 0.9531974792480469 ms
2022-09-21 16:03:11 INFO  Estimated runtime of original DAG is 1993.8194751739502ms
2022-09-21 16:03:11 INFO  Performing Multi-Query Optimization
2022-09-21 16:03:11 INFO  Estimated unoptimized what-if runtime is 50967.09942817688ms
2022-09-21 16:03:11 INFO  Estimated optimised what-if runtime is 7851.385593414307ms
2022-09-21 16:03:11 INFO  Estimated optimisation runtime saving is 43115.71383476257ms
2022-09-21 16:03:11 INFO  ---RUNTIME: Multi-Query Optimization took 153.58924865722656 ms
2022-09-21 16:03:11 INFO  Executing generated plans
2022-09-21 16:03:22 INFO  ---RUNTIME: Execution took 11508.391857147217 ms
2022-09-21 16:03:22 INFO  Done!
2022-09-21 16:03:22 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-21 16:03:22 INFO  Running instrumented original pipeline...
2022-09-21 16:03:22 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-21 16:03:22 INFO  ---RUNTIME: Importing and monkey-patching took 6.227731704711914 ms
2022-09-21 16:03:25 INFO  ---RUNTIME: Original pipeline execution took 2294.671058654785 ms (excluding imports and monkey-patching)
2022-09-21 16:03:25 INFO  Starting execution of 1 what-if analyses...
2022-09-21 16:03:25 INFO  Start plan generation for analysis DataCleaning...
2022-09-21 16:03:25 INFO  ---RUNTIME: Plan generation took 1.2774467468261719 ms
2022-09-21 16:03:25 INFO  Estimated runtime of original DAG is 1976.872444152832ms
2022-09-21 16:03:25 WARNING Skipping Multi-Query Optimization (instead, only applying patches)
2022-09-21 16:03:25 WARNING Columns ['full_name'] not present in train DAG after the train test split, only before!
2022-09-21 16:03:25 WARNING This could hint at data leakage!
2022-09-21 16:03:25 INFO  Estimated unoptimised what-if runtime is 50556.188106536865ms
2022-09-21 16:03:25 INFO  ---RUNTIME: Multi-Query Optimization took 32.294273376464844 ms
2022-09-21 16:03:25 INFO  Executing generated plans
2022-09-21 16:04:21 INFO  ---RUNTIME: Execution took 56349.86233711243 ms
2022-09-21 16:04:21 INFO  Done!
2022-09-21 16:04:21 INFO  # Finished -- repetition 3 of 7 
2022-09-21 16:04:21 INFO  # Optimization benchmark for data_cleaning with args [['healthcare', 'slow_loading', 'featurization_3', 'xgboost']] -- repetition 4 of 7
2022-09-21 16:04:21 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-21 16:04:21 INFO  Running instrumented original pipeline...
2022-09-21 16:04:21 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-21 16:04:21 INFO  ---RUNTIME: Importing and monkey-patching took 6.194829940795898 ms
2022-09-21 16:04:23 INFO  ---RUNTIME: Original pipeline execution took 2297.8854179382324 ms (excluding imports and monkey-patching)
2022-09-21 16:04:23 INFO  Starting execution of 1 what-if analyses...
2022-09-21 16:04:23 INFO  Start plan generation for analysis DataCleaning...
2022-09-21 16:04:23 INFO  ---RUNTIME: Plan generation took 0.9548664093017578 ms
2022-09-21 16:04:23 INFO  Estimated runtime of original DAG is 1980.5102348327637ms
2022-09-21 16:04:23 INFO  Performing Multi-Query Optimization
2022-09-21 16:04:24 INFO  Estimated unoptimized what-if runtime is 50631.264209747314ms
2022-09-21 16:04:24 INFO  Estimated optimised what-if runtime is 7823.882579803467ms
2022-09-21 16:04:24 INFO  Estimated optimisation runtime saving is 42807.38162994385ms
2022-09-21 16:04:24 INFO  ---RUNTIME: Multi-Query Optimization took 152.9397964477539 ms
2022-09-21 16:04:24 INFO  Executing generated plans
2022-09-21 16:04:35 INFO  ---RUNTIME: Execution took 11575.950145721436 ms
2022-09-21 16:04:35 INFO  Done!
2022-09-21 16:04:35 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-21 16:04:35 INFO  Running instrumented original pipeline...
2022-09-21 16:04:35 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-21 16:04:35 INFO  ---RUNTIME: Importing and monkey-patching took 6.443023681640625 ms
2022-09-21 16:04:37 INFO  ---RUNTIME: Original pipeline execution took 2266.6850090026855 ms (excluding imports and monkey-patching)
2022-09-21 16:04:37 INFO  Starting execution of 1 what-if analyses...
2022-09-21 16:04:37 INFO  Start plan generation for analysis DataCleaning...
2022-09-21 16:04:37 INFO  ---RUNTIME: Plan generation took 0.9434223175048828 ms
2022-09-21 16:04:37 INFO  Estimated runtime of original DAG is 1948.8816261291504ms
2022-09-21 16:04:37 WARNING Skipping Multi-Query Optimization (instead, only applying patches)
2022-09-21 16:04:37 WARNING Columns ['full_name'] not present in train DAG after the train test split, only before!
2022-09-21 16:04:37 WARNING This could hint at data leakage!
2022-09-21 16:04:37 INFO  Estimated unoptimised what-if runtime is 49839.44606781006ms
2022-09-21 16:04:37 INFO  ---RUNTIME: Multi-Query Optimization took 32.70149230957031 ms
2022-09-21 16:04:37 INFO  Executing generated plans
2022-09-21 16:05:33 INFO  ---RUNTIME: Execution took 55276.40700340271 ms
2022-09-21 16:05:33 INFO  Done!
2022-09-21 16:05:33 INFO  # Finished -- repetition 4 of 7 
2022-09-21 16:05:33 INFO  # Optimization benchmark for data_cleaning with args [['healthcare', 'slow_loading', 'featurization_3', 'xgboost']] -- repetition 5 of 7
2022-09-21 16:05:33 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-21 16:05:33 INFO  Running instrumented original pipeline...
2022-09-21 16:05:33 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-21 16:05:33 INFO  ---RUNTIME: Importing and monkey-patching took 6.136178970336914 ms
2022-09-21 16:05:35 INFO  ---RUNTIME: Original pipeline execution took 2274.425983428955 ms (excluding imports and monkey-patching)
2022-09-21 16:05:35 INFO  Starting execution of 1 what-if analyses...
2022-09-21 16:05:35 INFO  Start plan generation for analysis DataCleaning...
2022-09-21 16:05:35 INFO  ---RUNTIME: Plan generation took 1.1284351348876953 ms
2022-09-21 16:05:35 INFO  Estimated runtime of original DAG is 1957.273006439209ms
2022-09-21 16:05:35 INFO  Performing Multi-Query Optimization
2022-09-21 16:05:35 INFO  Estimated unoptimized what-if runtime is 50058.24422836304ms
2022-09-21 16:05:35 INFO  Estimated optimised what-if runtime is 7840.7793045043945ms
2022-09-21 16:05:35 INFO  Estimated optimisation runtime saving is 42217.46492385864ms
2022-09-21 16:05:35 INFO  ---RUNTIME: Multi-Query Optimization took 154.51550483703613 ms
2022-09-21 16:05:35 INFO  Executing generated plans
2022-09-21 16:05:47 INFO  ---RUNTIME: Execution took 11657.860040664673 ms
2022-09-21 16:05:47 INFO  Done!
2022-09-21 16:05:47 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-21 16:05:47 INFO  Running instrumented original pipeline...
2022-09-21 16:05:47 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-21 16:05:47 INFO  ---RUNTIME: Importing and monkey-patching took 6.302356719970703 ms
2022-09-21 16:05:49 INFO  ---RUNTIME: Original pipeline execution took 2289.5185947418213 ms (excluding imports and monkey-patching)
2022-09-21 16:05:49 INFO  Starting execution of 1 what-if analyses...
2022-09-21 16:05:49 INFO  Start plan generation for analysis DataCleaning...
2022-09-21 16:05:49 INFO  ---RUNTIME: Plan generation took 1.0504722595214844 ms
2022-09-21 16:05:49 INFO  Estimated runtime of original DAG is 1969.5262908935547ms
2022-09-21 16:05:49 WARNING Skipping Multi-Query Optimization (instead, only applying patches)
2022-09-21 16:05:49 WARNING Columns ['full_name'] not present in train DAG after the train test split, only before!
2022-09-21 16:05:49 WARNING This could hint at data leakage!
2022-09-21 16:05:49 INFO  Estimated unoptimised what-if runtime is 50364.317417144775ms
2022-09-21 16:05:49 INFO  ---RUNTIME: Multi-Query Optimization took 32.77873992919922 ms
2022-09-21 16:05:49 INFO  Executing generated plans
2022-09-21 16:06:44 INFO  ---RUNTIME: Execution took 54672.001361846924 ms
2022-09-21 16:06:44 INFO  Done!
2022-09-21 16:06:44 INFO  # Finished -- repetition 5 of 7 
2022-09-21 16:06:44 INFO  # Optimization benchmark for data_cleaning with args [['healthcare', 'slow_loading', 'featurization_3', 'xgboost']] -- repetition 6 of 7
2022-09-21 16:06:44 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-21 16:06:44 INFO  Running instrumented original pipeline...
2022-09-21 16:06:44 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-21 16:06:44 INFO  ---RUNTIME: Importing and monkey-patching took 6.43157958984375 ms
2022-09-21 16:06:46 INFO  ---RUNTIME: Original pipeline execution took 2289.504051208496 ms (excluding imports and monkey-patching)
2022-09-21 16:06:46 INFO  Starting execution of 1 what-if analyses...
2022-09-21 16:06:46 INFO  Start plan generation for analysis DataCleaning...
2022-09-21 16:06:46 INFO  ---RUNTIME: Plan generation took 0.9825229644775391 ms
2022-09-21 16:06:46 INFO  Estimated runtime of original DAG is 1969.618797302246ms
2022-09-21 16:06:46 INFO  Performing Multi-Query Optimization
2022-09-21 16:06:46 INFO  Estimated unoptimized what-if runtime is 50375.90265274048ms
2022-09-21 16:06:46 INFO  Estimated optimised what-if runtime is 7903.853178024292ms
2022-09-21 16:06:46 INFO  Estimated optimisation runtime saving is 42472.04947471619ms
2022-09-21 16:06:46 INFO  ---RUNTIME: Multi-Query Optimization took 154.70242500305176 ms
2022-09-21 16:06:46 INFO  Executing generated plans
2022-09-21 16:06:59 INFO  ---RUNTIME: Execution took 12777.362585067749 ms
2022-09-21 16:06:59 INFO  Done!
2022-09-21 16:06:59 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-21 16:06:59 INFO  Running instrumented original pipeline...
2022-09-21 16:06:59 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-21 16:06:59 INFO  ---RUNTIME: Importing and monkey-patching took 6.8302154541015625 ms
2022-09-21 16:07:02 INFO  ---RUNTIME: Original pipeline execution took 2573.26340675354 ms (excluding imports and monkey-patching)
2022-09-21 16:07:02 INFO  Starting execution of 1 what-if analyses...
2022-09-21 16:07:02 INFO  Start plan generation for analysis DataCleaning...
2022-09-21 16:07:02 INFO  ---RUNTIME: Plan generation took 1.0936260223388672 ms
2022-09-21 16:07:02 INFO  Estimated runtime of original DAG is 2011.3146305084229ms
2022-09-21 16:07:02 WARNING Skipping Multi-Query Optimization (instead, only applying patches)
2022-09-21 16:07:02 WARNING Columns ['full_name'] not present in train DAG after the train test split, only before!
2022-09-21 16:07:02 WARNING This could hint at data leakage!
2022-09-21 16:07:02 INFO  Estimated unoptimised what-if runtime is 51425.339460372925ms
2022-09-21 16:07:02 INFO  ---RUNTIME: Multi-Query Optimization took 32.8364372253418 ms
2022-09-21 16:07:02 INFO  Executing generated plans
2022-09-21 16:07:56 INFO  ---RUNTIME: Execution took 54652.310609817505 ms
2022-09-21 16:07:56 INFO  Done!
2022-09-21 16:07:56 INFO  # Finished -- repetition 6 of 7 
2022-09-21 16:07:56 INFO  # Optimization benchmark for data_cleaning with args [['healthcare', 'slow_loading', 'featurization_3', 'xgboost']] -- repetition 7 of 7
2022-09-21 16:07:56 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-21 16:07:56 INFO  Running instrumented original pipeline...
2022-09-21 16:07:56 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-21 16:07:56 INFO  ---RUNTIME: Importing and monkey-patching took 6.184577941894531 ms
2022-09-21 16:07:59 INFO  ---RUNTIME: Original pipeline execution took 2259.0153217315674 ms (excluding imports and monkey-patching)
2022-09-21 16:07:59 INFO  Starting execution of 1 what-if analyses...
2022-09-21 16:07:59 INFO  Start plan generation for analysis DataCleaning...
2022-09-21 16:07:59 INFO  ---RUNTIME: Plan generation took 0.9503364562988281 ms
2022-09-21 16:07:59 INFO  Estimated runtime of original DAG is 1942.950963973999ms
2022-09-21 16:07:59 INFO  Performing Multi-Query Optimization
2022-09-21 16:07:59 INFO  Estimated unoptimized what-if runtime is 49701.160192489624ms
2022-09-21 16:07:59 INFO  Estimated optimised what-if runtime is 7829.862594604492ms
2022-09-21 16:07:59 INFO  Estimated optimisation runtime saving is 41871.29759788513ms
2022-09-21 16:07:59 INFO  ---RUNTIME: Multi-Query Optimization took 152.54569053649902 ms
2022-09-21 16:07:59 INFO  Executing generated plans
2022-09-21 16:08:11 INFO  ---RUNTIME: Execution took 11849.969625473022 ms
2022-09-21 16:08:11 INFO  Done!
2022-09-21 16:08:11 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-21 16:08:11 INFO  Running instrumented original pipeline...
2022-09-21 16:08:11 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-21 16:08:11 INFO  ---RUNTIME: Importing and monkey-patching took 6.466865539550781 ms
2022-09-21 16:08:13 INFO  ---RUNTIME: Original pipeline execution took 2271.3463306427 ms (excluding imports and monkey-patching)
2022-09-21 16:08:13 INFO  Starting execution of 1 what-if analyses...
2022-09-21 16:08:13 INFO  Start plan generation for analysis DataCleaning...
2022-09-21 16:08:13 INFO  ---RUNTIME: Plan generation took 0.9448528289794922 ms
2022-09-21 16:08:13 INFO  Estimated runtime of original DAG is 1952.9931545257568ms
2022-09-21 16:08:13 WARNING Skipping Multi-Query Optimization (instead, only applying patches)
2022-09-21 16:08:13 WARNING Columns ['full_name'] not present in train DAG after the train test split, only before!
2022-09-21 16:08:13 WARNING This could hint at data leakage!
2022-09-21 16:08:13 INFO  Estimated unoptimised what-if runtime is 49944.27561759949ms
2022-09-21 16:08:13 INFO  ---RUNTIME: Multi-Query Optimization took 32.80186653137207 ms
2022-09-21 16:08:13 INFO  Executing generated plans
2022-09-21 16:09:08 INFO  ---RUNTIME: Execution took 55002.82073020935 ms
2022-09-21 16:09:08 INFO  Done!
2022-09-21 16:09:08 INFO  # Finished -- repetition 7 of 7 
2022-09-21 16:09:08 INFO  # Final results after all repetitions
2022-09-21 16:09:08 INFO     repetition  ... no_opt_what_if_execution_combined_model_training
0           0  ...                                      8934.880018
1           1  ...                                      8683.799267
2           2  ...                                      8846.521378
3           3  ...                                      8911.996841
4           4  ...                                      8950.041056
5           5  ...                                      8934.585094
6           6  ...                                      9031.840324

[7 rows x 26 columns]
taskset -c 128-135 PROTOCOL_BUFFERS_PYTHON_IMPLEMENTATION=python python3.9 benchmarks_end_to_end.py data_cleaning healthcare slow_loading featurization_3 neural_network
2022-09-21 16:09:10.452029: W tensorflow/stream_executor/platform/default/dso_loader.cc:64] Could not load dynamic library 'libcudart.so.11.0'; dlerror: libcudart.so.11.0: cannot open shared object file: No such file or directory; LD_LIBRARY_PATH: /home/sgrafbe/mlwhatif/venv/lib/python3.9/site-packages/cv2/../../lib64:
2022-09-21 16:09:10.452077: I tensorflow/stream_executor/cuda/cudart_stub.cc:29] Ignore above cudart dlerror if you do not have a GPU set up on your machine.
2022-09-21 16:09:11 INFO  Patching sys.argv with ['mlwhatif', 'healthcare', 'slow_loading', 'featurization_3', 'neural_network']
2022-09-21 16:09:11 INFO  Running instrumented original pipeline...
2022-09-21 16:09:11 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-21 16:09:11 INFO  ---RUNTIME: Importing and monkey-patching took 96.03309631347656 ms
2022-09-21 16:09:13.918111: W tensorflow/stream_executor/platform/default/dso_loader.cc:64] Could not load dynamic library 'libcuda.so.1'; dlerror: libcuda.so.1: cannot open shared object file: No such file or directory; LD_LIBRARY_PATH: /home/sgrafbe/mlwhatif/venv/lib/python3.9/site-packages/cv2/../../lib64:
2022-09-21 16:09:13.918146: W tensorflow/stream_executor/cuda/cuda_driver.cc:326] failed call to cuInit: UNKNOWN ERROR (303)
2022-09-21 16:09:13.918167: I tensorflow/stream_executor/cuda/cuda_diagnostics.cc:156] kernel driver does not appear to be running on this host (wagyu): /proc/driver/nvidia/version does not exist
2022-09-21 16:09:13.918610: I tensorflow/core/platform/cpu_feature_guard.cc:142] This TensorFlow binary is optimized with oneAPI Deep Neural Network Library (oneDNN) to use the following CPU instructions in performance-critical operations:  AVX2 FMA
To enable them in other operations, rebuild TensorFlow with the appropriate compiler flags.
2022-09-21 16:09:14.468264: I tensorflow/compiler/mlir/mlir_graph_optimization_pass.cc:176] None of the MLIR Optimization Passes are enabled (registered 2)
2022-09-21 16:09:14.481375: I tensorflow/core/platform/profile_utils/cpu_utils.cc:114] CPU Frequency: 2595290000 Hz
2022-09-21 16:09:14 INFO  ---RUNTIME: Original pipeline execution took 2928.971529006958 ms (excluding imports and monkey-patching)
2022-09-21 16:09:14 INFO  Starting execution of 0 what-if analyses...
2022-09-21 16:09:14 INFO  Estimated runtime of original DAG is 2579.068660736084ms
2022-09-21 16:09:14 INFO  Performing Multi-Query Optimization
2022-09-21 16:09:14 INFO  Estimated unoptimized what-if runtime is 0ms
2022-09-21 16:09:14 INFO  Estimated optimised what-if runtime is 0ms
2022-09-21 16:09:14 INFO  Estimated optimisation runtime saving is 0ms
2022-09-21 16:09:14 INFO  ---RUNTIME: Multi-Query Optimization took 0.5745887756347656 ms
2022-09-21 16:09:14 INFO  Executing generated plans
2022-09-21 16:09:14 INFO  ---RUNTIME: Execution took 0.015735626220703125 ms
2022-09-21 16:09:14 INFO  Done!
2022-09-21 16:09:14 INFO  # Optimization benchmark for data_cleaning with args [['healthcare', 'slow_loading', 'featurization_3', 'neural_network']] -- repetition 1 of 7
2022-09-21 16:09:14 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-21 16:09:14 INFO  Running instrumented original pipeline...
2022-09-21 16:09:14 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-21 16:09:14 INFO  ---RUNTIME: Importing and monkey-patching took 5.210399627685547 ms
2022-09-21 16:09:17 INFO  ---RUNTIME: Original pipeline execution took 2603.9133071899414 ms (excluding imports and monkey-patching)
2022-09-21 16:09:17 INFO  Starting execution of 1 what-if analyses...
2022-09-21 16:09:17 INFO  Start plan generation for analysis DataCleaning...
2022-09-21 16:09:17 INFO  ---RUNTIME: Plan generation took 0.9570121765136719 ms
2022-09-21 16:09:17 INFO  Estimated runtime of original DAG is 2292.837619781494ms
2022-09-21 16:09:17 INFO  Performing Multi-Query Optimization
2022-09-21 16:09:17 INFO  Estimated unoptimized what-if runtime is 59920.433044433594ms
2022-09-21 16:09:17 INFO  Estimated optimised what-if runtime is 16838.560819625854ms
2022-09-21 16:09:17 INFO  Estimated optimisation runtime saving is 43081.87222480774ms
2022-09-21 16:09:17 INFO  ---RUNTIME: Multi-Query Optimization took 155.20572662353516 ms
2022-09-21 16:09:17 INFO  Executing generated plans
2022-09-21 16:09:41 INFO  ---RUNTIME: Execution took 23819.077491760254 ms
2022-09-21 16:09:41 INFO  Done!
2022-09-21 16:09:41 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-21 16:09:41 INFO  Running instrumented original pipeline...
2022-09-21 16:09:41 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-21 16:09:41 INFO  ---RUNTIME: Importing and monkey-patching took 5.876779556274414 ms
2022-09-21 16:09:43 INFO  ---RUNTIME: Original pipeline execution took 2601.1152267456055 ms (excluding imports and monkey-patching)
2022-09-21 16:09:43 INFO  Starting execution of 1 what-if analyses...
2022-09-21 16:09:43 INFO  Start plan generation for analysis DataCleaning...
2022-09-21 16:09:44 INFO  ---RUNTIME: Plan generation took 822.9413032531738 ms
2022-09-21 16:09:44 INFO  Estimated runtime of original DAG is 2287.6431941986084ms
2022-09-21 16:09:44 WARNING Skipping Multi-Query Optimization (instead, only applying patches)
2022-09-21 16:09:44 WARNING Columns ['full_name'] not present in train DAG after the train test split, only before!
2022-09-21 16:09:44 WARNING This could hint at data leakage!
2022-09-21 16:09:44 INFO  Estimated unoptimised what-if runtime is 59804.24523353577ms
2022-09-21 16:09:44 INFO  ---RUNTIME: Multi-Query Optimization took 32.2260856628418 ms
2022-09-21 16:09:44 INFO  Executing generated plans
2022-09-21 16:10:51 INFO  ---RUNTIME: Execution took 66763.62800598145 ms
2022-09-21 16:10:51 INFO  Done!
2022-09-21 16:10:51 INFO  # Finished -- repetition 1 of 7 
2022-09-21 16:10:51 INFO  # Optimization benchmark for data_cleaning with args [['healthcare', 'slow_loading', 'featurization_3', 'neural_network']] -- repetition 2 of 7
2022-09-21 16:10:51 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-21 16:10:51 INFO  Running instrumented original pipeline...
2022-09-21 16:10:51 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-21 16:10:51 INFO  ---RUNTIME: Importing and monkey-patching took 6.020307540893555 ms
2022-09-21 16:10:54 INFO  ---RUNTIME: Original pipeline execution took 2602.043867111206 ms (excluding imports and monkey-patching)
2022-09-21 16:10:54 INFO  Starting execution of 1 what-if analyses...
2022-09-21 16:10:54 INFO  Start plan generation for analysis DataCleaning...
2022-09-21 16:10:54 INFO  ---RUNTIME: Plan generation took 0.980377197265625 ms
2022-09-21 16:10:54 INFO  Estimated runtime of original DAG is 2287.9478931427ms
2022-09-21 16:10:54 INFO  Performing Multi-Query Optimization
2022-09-21 16:10:54 INFO  Estimated unoptimized what-if runtime is 59820.857763290405ms
2022-09-21 16:10:54 INFO  Estimated optimised what-if runtime is 16918.572425842285ms
2022-09-21 16:10:54 INFO  Estimated optimisation runtime saving is 42902.28533744812ms
2022-09-21 16:10:54 INFO  ---RUNTIME: Multi-Query Optimization took 422.5611686706543 ms
2022-09-21 16:10:54 INFO  Executing generated plans
2022-09-21 16:11:18 INFO  ---RUNTIME: Execution took 23868.46613883972 ms
2022-09-21 16:11:18 INFO  Done!
2022-09-21 16:11:18 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-21 16:11:18 INFO  Running instrumented original pipeline...
2022-09-21 16:11:18 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-21 16:11:18 INFO  ---RUNTIME: Importing and monkey-patching took 5.975961685180664 ms
2022-09-21 16:11:21 INFO  ---RUNTIME: Original pipeline execution took 2589.813709259033 ms (excluding imports and monkey-patching)
2022-09-21 16:11:21 INFO  Starting execution of 1 what-if analyses...
2022-09-21 16:11:21 INFO  Start plan generation for analysis DataCleaning...
2022-09-21 16:11:21 INFO  ---RUNTIME: Plan generation took 0.9386539459228516 ms
2022-09-21 16:11:21 INFO  Estimated runtime of original DAG is 2274.8711109161377ms
2022-09-21 16:11:21 WARNING Skipping Multi-Query Optimization (instead, only applying patches)
2022-09-21 16:11:21 WARNING Columns ['full_name'] not present in train DAG after the train test split, only before!
2022-09-21 16:11:21 WARNING This could hint at data leakage!
2022-09-21 16:11:21 INFO  Estimated unoptimised what-if runtime is 59489.696741104126ms
2022-09-21 16:11:21 INFO  ---RUNTIME: Multi-Query Optimization took 32.472848892211914 ms
2022-09-21 16:11:21 INFO  Executing generated plans
2022-09-21 16:12:29 INFO  ---RUNTIME: Execution took 68585.65759658813 ms
2022-09-21 16:12:29 INFO  Done!
2022-09-21 16:12:29 INFO  # Finished -- repetition 2 of 7 
2022-09-21 16:12:29 INFO  # Optimization benchmark for data_cleaning with args [['healthcare', 'slow_loading', 'featurization_3', 'neural_network']] -- repetition 3 of 7
2022-09-21 16:12:29 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-21 16:12:29 INFO  Running instrumented original pipeline...
2022-09-21 16:12:30 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-21 16:12:30 INFO  ---RUNTIME: Importing and monkey-patching took 6.106376647949219 ms
2022-09-21 16:12:32 INFO  ---RUNTIME: Original pipeline execution took 2933.8178634643555 ms (excluding imports and monkey-patching)
2022-09-21 16:12:32 INFO  Starting execution of 1 what-if analyses...
2022-09-21 16:12:32 INFO  Start plan generation for analysis DataCleaning...
2022-09-21 16:12:32 INFO  ---RUNTIME: Plan generation took 1.108407974243164 ms
2022-09-21 16:12:32 INFO  Estimated runtime of original DAG is 2276.9317626953125ms
2022-09-21 16:12:32 INFO  Performing Multi-Query Optimization
2022-09-21 16:12:32 INFO  Estimated unoptimized what-if runtime is 59546.988010406494ms
2022-09-21 16:12:32 INFO  Estimated optimised what-if runtime is 16960.30282974243ms
2022-09-21 16:12:32 INFO  Estimated optimisation runtime saving is 42586.68518066406ms
2022-09-21 16:12:32 INFO  ---RUNTIME: Multi-Query Optimization took 162.02807426452637 ms
2022-09-21 16:12:32 INFO  Executing generated plans
2022-09-21 16:12:57 INFO  ---RUNTIME: Execution took 24359.898805618286 ms
2022-09-21 16:12:57 INFO  Done!
2022-09-21 16:12:57 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-21 16:12:57 INFO  Running instrumented original pipeline...
2022-09-21 16:12:57 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-21 16:12:57 INFO  ---RUNTIME: Importing and monkey-patching took 5.9299468994140625 ms
2022-09-21 16:12:59 INFO  ---RUNTIME: Original pipeline execution took 2556.1888217926025 ms (excluding imports and monkey-patching)
2022-09-21 16:12:59 INFO  Starting execution of 1 what-if analyses...
2022-09-21 16:12:59 INFO  Start plan generation for analysis DataCleaning...
2022-09-21 16:12:59 INFO  ---RUNTIME: Plan generation took 1.0073184967041016 ms
2022-09-21 16:12:59 INFO  Estimated runtime of original DAG is 2243.833541870117ms
2022-09-21 16:12:59 WARNING Skipping Multi-Query Optimization (instead, only applying patches)
2022-09-21 16:12:59 WARNING Columns ['full_name'] not present in train DAG after the train test split, only before!
2022-09-21 16:12:59 WARNING This could hint at data leakage!
2022-09-21 16:12:59 INFO  Estimated unoptimised what-if runtime is 58693.36700439453ms
2022-09-21 16:12:59 INFO  ---RUNTIME: Multi-Query Optimization took 34.43789482116699 ms
2022-09-21 16:12:59 INFO  Executing generated plans
2022-09-21 16:14:07 INFO  ---RUNTIME: Execution took 67473.72961044312 ms
2022-09-21 16:14:07 INFO  Done!
2022-09-21 16:14:07 INFO  # Finished -- repetition 3 of 7 
2022-09-21 16:14:07 INFO  # Optimization benchmark for data_cleaning with args [['healthcare', 'slow_loading', 'featurization_3', 'neural_network']] -- repetition 4 of 7
2022-09-21 16:14:07 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-21 16:14:07 INFO  Running instrumented original pipeline...
2022-09-21 16:14:07 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-21 16:14:07 INFO  ---RUNTIME: Importing and monkey-patching took 5.880117416381836 ms
2022-09-21 16:14:09 INFO  ---RUNTIME: Original pipeline execution took 2553.3971786499023 ms (excluding imports and monkey-patching)
2022-09-21 16:14:09 INFO  Starting execution of 1 what-if analyses...
2022-09-21 16:14:09 INFO  Start plan generation for analysis DataCleaning...
2022-09-21 16:14:09 INFO  ---RUNTIME: Plan generation took 0.9529590606689453 ms
2022-09-21 16:14:09 INFO  Estimated runtime of original DAG is 2241.6062355041504ms
2022-09-21 16:14:09 INFO  Performing Multi-Query Optimization
2022-09-21 16:14:09 INFO  Estimated unoptimized what-if runtime is 58620.06330490112ms
2022-09-21 16:14:09 INFO  Estimated optimised what-if runtime is 16662.62125968933ms
2022-09-21 16:14:09 INFO  Estimated optimisation runtime saving is 41957.44204521179ms
2022-09-21 16:14:09 INFO  ---RUNTIME: Multi-Query Optimization took 153.2125473022461 ms
2022-09-21 16:14:09 INFO  Executing generated plans
2022-09-21 16:14:34 INFO  ---RUNTIME: Execution took 24781.237840652466 ms
2022-09-21 16:14:34 INFO  Done!
2022-09-21 16:14:34 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-21 16:14:34 INFO  Running instrumented original pipeline...
2022-09-21 16:14:34 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-21 16:14:34 INFO  ---RUNTIME: Importing and monkey-patching took 5.916357040405273 ms
2022-09-21 16:14:37 INFO  ---RUNTIME: Original pipeline execution took 2624.96280670166 ms (excluding imports and monkey-patching)
2022-09-21 16:14:37 INFO  Starting execution of 1 what-if analyses...
2022-09-21 16:14:37 INFO  Start plan generation for analysis DataCleaning...
2022-09-21 16:14:37 INFO  ---RUNTIME: Plan generation took 0.9126663208007812 ms
2022-09-21 16:14:37 INFO  Estimated runtime of original DAG is 2310.8551502227783ms
2022-09-21 16:14:37 WARNING Skipping Multi-Query Optimization (instead, only applying patches)
2022-09-21 16:14:37 WARNING Columns ['full_name'] not present in train DAG after the train test split, only before!
2022-09-21 16:14:37 WARNING This could hint at data leakage!
2022-09-21 16:14:37 INFO  Estimated unoptimised what-if runtime is 60374.160051345825ms
2022-09-21 16:14:37 INFO  ---RUNTIME: Multi-Query Optimization took 33.15877914428711 ms
2022-09-21 16:14:37 INFO  Executing generated plans
2022-09-21 16:15:44 INFO  ---RUNTIME: Execution took 67177.22249031067 ms
2022-09-21 16:15:44 INFO  Done!
2022-09-21 16:15:44 INFO  # Finished -- repetition 4 of 7 
2022-09-21 16:15:44 INFO  # Optimization benchmark for data_cleaning with args [['healthcare', 'slow_loading', 'featurization_3', 'neural_network']] -- repetition 5 of 7
2022-09-21 16:15:44 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-21 16:15:44 INFO  Running instrumented original pipeline...
2022-09-21 16:15:44 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-21 16:15:44 INFO  ---RUNTIME: Importing and monkey-patching took 6.328582763671875 ms
2022-09-21 16:15:47 INFO  ---RUNTIME: Original pipeline execution took 2547.290086746216 ms (excluding imports and monkey-patching)
2022-09-21 16:15:47 INFO  Starting execution of 1 what-if analyses...
2022-09-21 16:15:47 INFO  Start plan generation for analysis DataCleaning...
2022-09-21 16:15:47 INFO  ---RUNTIME: Plan generation took 2.118349075317383 ms
2022-09-21 16:15:47 INFO  Estimated runtime of original DAG is 2234.0667247772217ms
2022-09-21 16:15:47 INFO  Performing Multi-Query Optimization
2022-09-21 16:15:47 INFO  Estimated unoptimized what-if runtime is 58423.76208305359ms
2022-09-21 16:15:47 INFO  Estimated optimised what-if runtime is 16639.704704284668ms
2022-09-21 16:15:47 INFO  Estimated optimisation runtime saving is 41784.05737876892ms
2022-09-21 16:15:47 INFO  ---RUNTIME: Multi-Query Optimization took 152.4524688720703 ms
2022-09-21 16:15:47 INFO  Executing generated plans
2022-09-21 16:16:11 INFO  ---RUNTIME: Execution took 24050.14967918396 ms
2022-09-21 16:16:11 INFO  Done!
2022-09-21 16:16:11 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-21 16:16:11 INFO  Running instrumented original pipeline...
2022-09-21 16:16:11 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-21 16:16:11 INFO  ---RUNTIME: Importing and monkey-patching took 5.8612823486328125 ms
2022-09-21 16:16:13 INFO  ---RUNTIME: Original pipeline execution took 2603.652000427246 ms (excluding imports and monkey-patching)
2022-09-21 16:16:13 INFO  Starting execution of 1 what-if analyses...
2022-09-21 16:16:13 INFO  Start plan generation for analysis DataCleaning...
2022-09-21 16:16:13 INFO  ---RUNTIME: Plan generation took 0.9167194366455078 ms
2022-09-21 16:16:13 INFO  Estimated runtime of original DAG is 2290.0052070617676ms
2022-09-21 16:16:13 WARNING Skipping Multi-Query Optimization (instead, only applying patches)
2022-09-21 16:16:13 WARNING Columns ['full_name'] not present in train DAG after the train test split, only before!
2022-09-21 16:16:13 WARNING This could hint at data leakage!
2022-09-21 16:16:13 INFO  Estimated unoptimised what-if runtime is 59873.167514801025ms
2022-09-21 16:16:13 INFO  ---RUNTIME: Multi-Query Optimization took 32.65881538391113 ms
2022-09-21 16:16:13 INFO  Executing generated plans
2022-09-21 16:17:21 INFO  ---RUNTIME: Execution took 67847.0938205719 ms
2022-09-21 16:17:21 INFO  Done!
2022-09-21 16:17:21 INFO  # Finished -- repetition 5 of 7 
2022-09-21 16:17:21 INFO  # Optimization benchmark for data_cleaning with args [['healthcare', 'slow_loading', 'featurization_3', 'neural_network']] -- repetition 6 of 7
2022-09-21 16:17:21 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-21 16:17:21 INFO  Running instrumented original pipeline...
2022-09-21 16:17:21 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-21 16:17:21 INFO  ---RUNTIME: Importing and monkey-patching took 6.844043731689453 ms
2022-09-21 16:17:24 INFO  ---RUNTIME: Original pipeline execution took 2605.9086322784424 ms (excluding imports and monkey-patching)
2022-09-21 16:17:24 INFO  Starting execution of 1 what-if analyses...
2022-09-21 16:17:24 INFO  Start plan generation for analysis DataCleaning...
2022-09-21 16:17:24 INFO  ---RUNTIME: Plan generation took 0.9760856628417969 ms
2022-09-21 16:17:24 INFO  Estimated runtime of original DAG is 2284.7797870635986ms
2022-09-21 16:17:24 INFO  Performing Multi-Query Optimization
2022-09-21 16:17:24 INFO  Estimated unoptimized what-if runtime is 59852.768659591675ms
2022-09-21 16:17:24 INFO  Estimated optimised what-if runtime is 17458.810091018677ms
2022-09-21 16:17:24 INFO  Estimated optimisation runtime saving is 42393.958568573ms
2022-09-21 16:17:24 INFO  ---RUNTIME: Multi-Query Optimization took 154.62589263916016 ms
2022-09-21 16:17:24 INFO  Executing generated plans
2022-09-21 16:17:49 INFO  ---RUNTIME: Execution took 25070.436716079712 ms
2022-09-21 16:17:49 INFO  Done!
2022-09-21 16:17:49 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-21 16:17:49 INFO  Running instrumented original pipeline...
2022-09-21 16:17:49 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-21 16:17:49 INFO  ---RUNTIME: Importing and monkey-patching took 6.1702728271484375 ms
2022-09-21 16:17:52 INFO  ---RUNTIME: Original pipeline execution took 2602.822780609131 ms (excluding imports and monkey-patching)
2022-09-21 16:17:52 INFO  Starting execution of 1 what-if analyses...
2022-09-21 16:17:52 INFO  Start plan generation for analysis DataCleaning...
2022-09-21 16:17:52 INFO  ---RUNTIME: Plan generation took 2.9582977294921875 ms
2022-09-21 16:17:52 INFO  Estimated runtime of original DAG is 2283.050298690796ms
2022-09-21 16:17:52 WARNING Skipping Multi-Query Optimization (instead, only applying patches)
2022-09-21 16:17:52 WARNING Columns ['full_name'] not present in train DAG after the train test split, only before!
2022-09-21 16:17:52 WARNING This could hint at data leakage!
2022-09-21 16:17:52 INFO  Estimated unoptimised what-if runtime is 59663.27166557312ms
2022-09-21 16:17:52 INFO  ---RUNTIME: Multi-Query Optimization took 35.57634353637695 ms
2022-09-21 16:17:52 INFO  Executing generated plans
2022-09-21 16:19:01 INFO  ---RUNTIME: Execution took 68998.53301048279 ms
2022-09-21 16:19:01 INFO  Done!
2022-09-21 16:19:01 INFO  # Finished -- repetition 6 of 7 
2022-09-21 16:19:01 INFO  # Optimization benchmark for data_cleaning with args [['healthcare', 'slow_loading', 'featurization_3', 'neural_network']] -- repetition 7 of 7
2022-09-21 16:19:01 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-21 16:19:01 INFO  Running instrumented original pipeline...
2022-09-21 16:19:01 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-21 16:19:01 INFO  ---RUNTIME: Importing and monkey-patching took 6.140232086181641 ms
2022-09-21 16:19:03 INFO  ---RUNTIME: Original pipeline execution took 2663.0032062530518 ms (excluding imports and monkey-patching)
2022-09-21 16:19:03 INFO  Starting execution of 1 what-if analyses...
2022-09-21 16:19:03 INFO  Start plan generation for analysis DataCleaning...
2022-09-21 16:19:03 INFO  ---RUNTIME: Plan generation took 1.0638236999511719 ms
2022-09-21 16:19:03 INFO  Estimated runtime of original DAG is 2345.700740814209ms
2022-09-21 16:19:03 INFO  Performing Multi-Query Optimization
2022-09-21 16:19:04 INFO  Estimated unoptimized what-if runtime is 61323.58741760254ms
2022-09-21 16:19:04 INFO  Estimated optimised what-if runtime is 17464.606761932373ms
2022-09-21 16:19:04 INFO  Estimated optimisation runtime saving is 43858.980655670166ms
2022-09-21 16:19:04 INFO  ---RUNTIME: Multi-Query Optimization took 186.0370635986328 ms
2022-09-21 16:19:04 INFO  Executing generated plans
2022-09-21 16:19:29 INFO  ---RUNTIME: Execution took 25561.469793319702 ms
2022-09-21 16:19:29 INFO  Done!
2022-09-21 16:19:29 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-21 16:19:29 INFO  Running instrumented original pipeline...
2022-09-21 16:19:29 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-21 16:19:29 INFO  ---RUNTIME: Importing and monkey-patching took 8.585214614868164 ms
2022-09-21 16:19:32 INFO  ---RUNTIME: Original pipeline execution took 2612.8506660461426 ms (excluding imports and monkey-patching)
2022-09-21 16:19:32 INFO  Starting execution of 1 what-if analyses...
2022-09-21 16:19:32 INFO  Start plan generation for analysis DataCleaning...
2022-09-21 16:19:32 INFO  ---RUNTIME: Plan generation took 0.9670257568359375 ms
2022-09-21 16:19:32 INFO  Estimated runtime of original DAG is 2259.4375610351562ms
2022-09-21 16:19:32 WARNING Skipping Multi-Query Optimization (instead, only applying patches)
2022-09-21 16:19:32 WARNING Columns ['full_name'] not present in train DAG after the train test split, only before!
2022-09-21 16:19:32 WARNING This could hint at data leakage!
2022-09-21 16:19:32 INFO  Estimated unoptimised what-if runtime is 59123.29864501953ms
2022-09-21 16:19:32 INFO  ---RUNTIME: Multi-Query Optimization took 33.59270095825195 ms
2022-09-21 16:19:32 INFO  Executing generated plans
2022-09-21 16:20:41 INFO  ---RUNTIME: Execution took 69183.13145637512 ms
2022-09-21 16:20:41 INFO  Done!
2022-09-21 16:20:41 INFO  # Finished -- repetition 7 of 7 
2022-09-21 16:20:41 INFO  # Final results after all repetitions
2022-09-21 16:20:41 INFO     repetition  ... no_opt_what_if_execution_combined_model_training
0           0  ...                                     19550.234318
1           1  ...                                     20637.057543
2           2  ...                                     19325.495005
3           3  ...                                     19893.358946
4           4  ...                                     20575.310707
5           5  ...                                     20574.717283
6           6  ...                                     20629.387140

[7 rows x 26 columns]
taskset -c 128-135 PROTOCOL_BUFFERS_PYTHON_IMPLEMENTATION=python python3.9 benchmarks_end_to_end.py data_cleaning healthcare slow_loading featurization_4 logistic_regression
2022-09-21 16:20:44.267826: W tensorflow/stream_executor/platform/default/dso_loader.cc:64] Could not load dynamic library 'libcudart.so.11.0'; dlerror: libcudart.so.11.0: cannot open shared object file: No such file or directory; LD_LIBRARY_PATH: /home/sgrafbe/mlwhatif/venv/lib/python3.9/site-packages/cv2/../../lib64:
2022-09-21 16:20:44.267866: I tensorflow/stream_executor/cuda/cudart_stub.cc:29] Ignore above cudart dlerror if you do not have a GPU set up on your machine.
2022-09-21 16:20:45 INFO  Patching sys.argv with ['mlwhatif', 'healthcare', 'slow_loading', 'featurization_4', 'logistic_regression']
2022-09-21 16:20:45 INFO  Running instrumented original pipeline...
2022-09-21 16:20:45 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-21 16:20:45 INFO  ---RUNTIME: Importing and monkey-patching took 96.14443778991699 ms
2022-09-21 16:20:47 INFO  ---RUNTIME: Original pipeline execution took 2148.0507850646973 ms (excluding imports and monkey-patching)
2022-09-21 16:20:47 INFO  Starting execution of 0 what-if analyses...
2022-09-21 16:20:47 INFO  Estimated runtime of original DAG is 1845.9250926971436ms
2022-09-21 16:20:47 INFO  Performing Multi-Query Optimization
2022-09-21 16:20:47 INFO  Estimated unoptimized what-if runtime is 0ms
2022-09-21 16:20:47 INFO  Estimated optimised what-if runtime is 0ms
2022-09-21 16:20:47 INFO  Estimated optimisation runtime saving is 0ms
2022-09-21 16:20:47 INFO  ---RUNTIME: Multi-Query Optimization took 0.5252361297607422 ms
2022-09-21 16:20:47 INFO  Executing generated plans
2022-09-21 16:20:47 INFO  ---RUNTIME: Execution took 0.022649765014648438 ms
2022-09-21 16:20:47 INFO  Done!
2022-09-21 16:20:47 INFO  # Optimization benchmark for data_cleaning with args [['healthcare', 'slow_loading', 'featurization_4', 'logistic_regression']] -- repetition 1 of 7
2022-09-21 16:20:47 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-21 16:20:47 INFO  Running instrumented original pipeline...
2022-09-21 16:20:47 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-21 16:20:47 INFO  ---RUNTIME: Importing and monkey-patching took 5.195140838623047 ms
2022-09-21 16:20:49 INFO  ---RUNTIME: Original pipeline execution took 2108.614444732666 ms (excluding imports and monkey-patching)
2022-09-21 16:20:49 INFO  Starting execution of 1 what-if analyses...
2022-09-21 16:20:49 INFO  Start plan generation for analysis DataCleaning...
2022-09-21 16:20:49 INFO  ---RUNTIME: Plan generation took 0.7624626159667969 ms
2022-09-21 16:20:49 INFO  Estimated runtime of original DAG is 1839.0538692474365ms
2022-09-21 16:20:49 INFO  Performing Multi-Query Optimization
2022-09-21 16:20:50 INFO  Estimated unoptimized what-if runtime is 45991.6832447052ms
2022-09-21 16:20:50 INFO  Estimated optimised what-if runtime is 2071.57301902771ms
2022-09-21 16:20:50 INFO  Estimated optimisation runtime saving is 43920.11022567749ms
2022-09-21 16:20:50 INFO  ---RUNTIME: Multi-Query Optimization took 306.89120292663574 ms
2022-09-21 16:20:50 INFO  Executing generated plans
2022-09-21 16:20:56 INFO  ---RUNTIME: Execution took 5924.281358718872 ms
2022-09-21 16:20:56 INFO  Done!
2022-09-21 16:20:56 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-21 16:20:56 INFO  Running instrumented original pipeline...
2022-09-21 16:20:56 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-21 16:20:56 INFO  ---RUNTIME: Importing and monkey-patching took 6.875514984130859 ms
2022-09-21 16:20:58 INFO  ---RUNTIME: Original pipeline execution took 2068.354606628418 ms (excluding imports and monkey-patching)
2022-09-21 16:20:58 INFO  Starting execution of 1 what-if analyses...
2022-09-21 16:20:58 INFO  Start plan generation for analysis DataCleaning...
2022-09-21 16:20:58 INFO  ---RUNTIME: Plan generation took 0.8912086486816406 ms
2022-09-21 16:20:58 INFO  Estimated runtime of original DAG is 1774.8920917510986ms
2022-09-21 16:20:58 WARNING Skipping Multi-Query Optimization (instead, only applying patches)
2022-09-21 16:20:58 WARNING Columns ['full_name'] not present in train DAG after the train test split, only before!
2022-09-21 16:20:58 WARNING This could hint at data leakage!
2022-09-21 16:20:58 INFO  Estimated unoptimised what-if runtime is 44389.79744911194ms
2022-09-21 16:20:58 INFO  ---RUNTIME: Multi-Query Optimization took 35.19082069396973 ms
2022-09-21 16:20:58 INFO  Executing generated plans
2022-09-21 16:21:47 INFO  ---RUNTIME: Execution took 49568.43948364258 ms
2022-09-21 16:21:47 INFO  Done!
2022-09-21 16:21:47 INFO  # Finished -- repetition 1 of 7 
2022-09-21 16:21:47 INFO  # Optimization benchmark for data_cleaning with args [['healthcare', 'slow_loading', 'featurization_4', 'logistic_regression']] -- repetition 2 of 7
2022-09-21 16:21:47 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-21 16:21:47 INFO  Running instrumented original pipeline...
2022-09-21 16:21:47 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-21 16:21:47 INFO  ---RUNTIME: Importing and monkey-patching took 5.905628204345703 ms
2022-09-21 16:21:49 INFO  ---RUNTIME: Original pipeline execution took 2065.91796875 ms (excluding imports and monkey-patching)
2022-09-21 16:21:49 INFO  Starting execution of 1 what-if analyses...
2022-09-21 16:21:49 INFO  Start plan generation for analysis DataCleaning...
2022-09-21 16:21:49 INFO  ---RUNTIME: Plan generation took 0.7576942443847656 ms
2022-09-21 16:21:49 INFO  Estimated runtime of original DAG is 1793.0176258087158ms
2022-09-21 16:21:49 INFO  Performing Multi-Query Optimization
2022-09-21 16:21:49 INFO  Estimated unoptimized what-if runtime is 44840.508222579956ms
2022-09-21 16:21:49 INFO  Estimated optimised what-if runtime is 2022.1772193908691ms
2022-09-21 16:21:49 INFO  Estimated optimisation runtime saving is 42818.33100318909ms
2022-09-21 16:21:49 INFO  ---RUNTIME: Multi-Query Optimization took 136.3823413848877 ms
2022-09-21 16:21:49 INFO  Executing generated plans
2022-09-21 16:21:56 INFO  ---RUNTIME: Execution took 6175.098419189453 ms
2022-09-21 16:21:56 INFO  Done!
2022-09-21 16:21:56 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-21 16:21:56 INFO  Running instrumented original pipeline...
2022-09-21 16:21:56 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-21 16:21:56 INFO  ---RUNTIME: Importing and monkey-patching took 5.7811737060546875 ms
2022-09-21 16:21:58 INFO  ---RUNTIME: Original pipeline execution took 2282.3500633239746 ms (excluding imports and monkey-patching)
2022-09-21 16:21:58 INFO  Starting execution of 1 what-if analyses...
2022-09-21 16:21:58 INFO  Start plan generation for analysis DataCleaning...
2022-09-21 16:21:58 INFO  ---RUNTIME: Plan generation took 0.743865966796875 ms
2022-09-21 16:21:58 INFO  Estimated runtime of original DAG is 1791.1815643310547ms
2022-09-21 16:21:58 WARNING Skipping Multi-Query Optimization (instead, only applying patches)
2022-09-21 16:21:58 WARNING Columns ['full_name'] not present in train DAG after the train test split, only before!
2022-09-21 16:21:58 WARNING This could hint at data leakage!
2022-09-21 16:21:58 INFO  Estimated unoptimised what-if runtime is 44797.03140258789ms
2022-09-21 16:21:58 INFO  ---RUNTIME: Multi-Query Optimization took 29.1903018951416 ms
2022-09-21 16:21:58 INFO  Executing generated plans
2022-09-21 16:22:48 INFO  ---RUNTIME: Execution took 49873.99673461914 ms
2022-09-21 16:22:48 INFO  Done!
2022-09-21 16:22:48 INFO  # Finished -- repetition 2 of 7 
2022-09-21 16:22:48 INFO  # Optimization benchmark for data_cleaning with args [['healthcare', 'slow_loading', 'featurization_4', 'logistic_regression']] -- repetition 3 of 7
2022-09-21 16:22:48 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-21 16:22:48 INFO  Running instrumented original pipeline...
2022-09-21 16:22:48 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-21 16:22:48 INFO  ---RUNTIME: Importing and monkey-patching took 5.834341049194336 ms
2022-09-21 16:22:50 INFO  ---RUNTIME: Original pipeline execution took 2069.201707839966 ms (excluding imports and monkey-patching)
2022-09-21 16:22:50 INFO  Starting execution of 1 what-if analyses...
2022-09-21 16:22:50 INFO  Start plan generation for analysis DataCleaning...
2022-09-21 16:22:50 INFO  ---RUNTIME: Plan generation took 0.7562637329101562 ms
2022-09-21 16:22:50 INFO  Estimated runtime of original DAG is 1797.3551750183105ms
2022-09-21 16:22:50 INFO  Performing Multi-Query Optimization
2022-09-21 16:22:50 INFO  Estimated unoptimized what-if runtime is 44949.15580749512ms
2022-09-21 16:22:50 INFO  Estimated optimised what-if runtime is 2029.9015045166016ms
2022-09-21 16:22:50 INFO  Estimated optimisation runtime saving is 42919.254302978516ms
2022-09-21 16:22:50 INFO  ---RUNTIME: Multi-Query Optimization took 136.72184944152832 ms
2022-09-21 16:22:50 INFO  Executing generated plans
2022-09-21 16:22:56 INFO  ---RUNTIME: Execution took 6127.347946166992 ms
2022-09-21 16:22:56 INFO  Done!
2022-09-21 16:22:56 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-21 16:22:56 INFO  Running instrumented original pipeline...
2022-09-21 16:22:56 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-21 16:22:56 INFO  ---RUNTIME: Importing and monkey-patching took 6.867885589599609 ms
2022-09-21 16:22:58 INFO  ---RUNTIME: Original pipeline execution took 2071.7556476593018 ms (excluding imports and monkey-patching)
2022-09-21 16:22:58 INFO  Starting execution of 1 what-if analyses...
2022-09-21 16:22:58 INFO  Start plan generation for analysis DataCleaning...
2022-09-21 16:22:58 INFO  ---RUNTIME: Plan generation took 0.8831024169921875 ms
2022-09-21 16:22:58 INFO  Estimated runtime of original DAG is 1778.7673473358154ms
2022-09-21 16:22:58 WARNING Skipping Multi-Query Optimization (instead, only applying patches)
2022-09-21 16:22:58 WARNING Columns ['full_name'] not present in train DAG after the train test split, only before!
2022-09-21 16:22:58 WARNING This could hint at data leakage!
2022-09-21 16:22:58 INFO  Estimated unoptimised what-if runtime is 44486.86909675598ms
2022-09-21 16:22:58 INFO  ---RUNTIME: Multi-Query Optimization took 35.835981369018555 ms
2022-09-21 16:22:58 INFO  Executing generated plans
2022-09-21 16:23:48 INFO  ---RUNTIME: Execution took 49763.532638549805 ms
2022-09-21 16:23:48 INFO  Done!
2022-09-21 16:23:48 INFO  # Finished -- repetition 3 of 7 
2022-09-21 16:23:48 INFO  # Optimization benchmark for data_cleaning with args [['healthcare', 'slow_loading', 'featurization_4', 'logistic_regression']] -- repetition 4 of 7
2022-09-21 16:23:48 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-21 16:23:48 INFO  Running instrumented original pipeline...
2022-09-21 16:23:48 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-21 16:23:48 INFO  ---RUNTIME: Importing and monkey-patching took 5.621433258056641 ms
2022-09-21 16:23:50 INFO  ---RUNTIME: Original pipeline execution took 2076.9248008728027 ms (excluding imports and monkey-patching)
2022-09-21 16:23:50 INFO  Starting execution of 1 what-if analyses...
2022-09-21 16:23:50 INFO  Start plan generation for analysis DataCleaning...
2022-09-21 16:23:50 INFO  ---RUNTIME: Plan generation took 0.7581710815429688 ms
2022-09-21 16:23:50 INFO  Estimated runtime of original DAG is 1804.7475814819336ms
2022-09-21 16:23:50 INFO  Performing Multi-Query Optimization
2022-09-21 16:23:50 INFO  Estimated unoptimized what-if runtime is 45133.76426696777ms
2022-09-21 16:23:50 INFO  Estimated optimised what-if runtime is 2034.116268157959ms
2022-09-21 16:23:50 INFO  Estimated optimisation runtime saving is 43099.647998809814ms
2022-09-21 16:23:50 INFO  ---RUNTIME: Multi-Query Optimization took 135.74767112731934 ms
2022-09-21 16:23:50 INFO  Executing generated plans
2022-09-21 16:23:56 INFO  ---RUNTIME: Execution took 6068.515777587891 ms
2022-09-21 16:23:56 INFO  Done!
2022-09-21 16:23:56 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-21 16:23:56 INFO  Running instrumented original pipeline...
2022-09-21 16:23:56 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-21 16:23:56 INFO  ---RUNTIME: Importing and monkey-patching took 5.995512008666992 ms
2022-09-21 16:23:58 INFO  ---RUNTIME: Original pipeline execution took 2077.8098106384277 ms (excluding imports and monkey-patching)
2022-09-21 16:23:58 INFO  Starting execution of 1 what-if analyses...
2022-09-21 16:23:58 INFO  Start plan generation for analysis DataCleaning...
2022-09-21 16:23:58 INFO  ---RUNTIME: Plan generation took 0.7488727569580078 ms
2022-09-21 16:23:58 INFO  Estimated runtime of original DAG is 1804.1727542877197ms
2022-09-21 16:23:58 WARNING Skipping Multi-Query Optimization (instead, only applying patches)
2022-09-21 16:23:58 WARNING Columns ['full_name'] not present in train DAG after the train test split, only before!
2022-09-21 16:23:58 WARNING This could hint at data leakage!
2022-09-21 16:23:58 INFO  Estimated unoptimised what-if runtime is 45119.47512626648ms
2022-09-21 16:23:58 INFO  ---RUNTIME: Multi-Query Optimization took 29.07705307006836 ms
2022-09-21 16:23:59 INFO  Executing generated plans
2022-09-21 16:24:48 INFO  ---RUNTIME: Execution took 49666.24617576599 ms
2022-09-21 16:24:48 INFO  Done!
2022-09-21 16:24:48 INFO  # Finished -- repetition 4 of 7 
2022-09-21 16:24:48 INFO  # Optimization benchmark for data_cleaning with args [['healthcare', 'slow_loading', 'featurization_4', 'logistic_regression']] -- repetition 5 of 7
2022-09-21 16:24:48 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-21 16:24:48 INFO  Running instrumented original pipeline...
2022-09-21 16:24:48 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-21 16:24:48 INFO  ---RUNTIME: Importing and monkey-patching took 6.005287170410156 ms
2022-09-21 16:24:50 INFO  ---RUNTIME: Original pipeline execution took 2055.3934574127197 ms (excluding imports and monkey-patching)
2022-09-21 16:24:50 INFO  Starting execution of 1 what-if analyses...
2022-09-21 16:24:50 INFO  Start plan generation for analysis DataCleaning...
2022-09-21 16:24:50 INFO  ---RUNTIME: Plan generation took 0.7548332214355469 ms
2022-09-21 16:24:50 INFO  Estimated runtime of original DAG is 1784.6195697784424ms
2022-09-21 16:24:50 INFO  Performing Multi-Query Optimization
2022-09-21 16:24:50 INFO  Estimated unoptimized what-if runtime is 44630.738496780396ms
2022-09-21 16:24:50 INFO  Estimated optimised what-if runtime is 2015.381097793579ms
2022-09-21 16:24:50 INFO  Estimated optimisation runtime saving is 42615.35739898682ms
2022-09-21 16:24:50 INFO  ---RUNTIME: Multi-Query Optimization took 136.86513900756836 ms
2022-09-21 16:24:50 INFO  Executing generated plans
2022-09-21 16:24:57 INFO  ---RUNTIME: Execution took 6164.258718490601 ms
2022-09-21 16:24:57 INFO  Done!
2022-09-21 16:24:57 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-21 16:24:57 INFO  Running instrumented original pipeline...
2022-09-21 16:24:57 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-21 16:24:57 INFO  ---RUNTIME: Importing and monkey-patching took 6.18743896484375 ms
2022-09-21 16:24:59 INFO  ---RUNTIME: Original pipeline execution took 2064.5360946655273 ms (excluding imports and monkey-patching)
2022-09-21 16:24:59 INFO  Starting execution of 1 what-if analyses...
2022-09-21 16:24:59 INFO  Start plan generation for analysis DataCleaning...
2022-09-21 16:24:59 INFO  ---RUNTIME: Plan generation took 0.7455348968505859 ms
2022-09-21 16:24:59 INFO  Estimated runtime of original DAG is 1791.0878658294678ms
2022-09-21 16:24:59 WARNING Skipping Multi-Query Optimization (instead, only applying patches)
2022-09-21 16:24:59 WARNING Columns ['full_name'] not present in train DAG after the train test split, only before!
2022-09-21 16:24:59 WARNING This could hint at data leakage!
2022-09-21 16:24:59 INFO  Estimated unoptimised what-if runtime is 44792.24133491516ms
2022-09-21 16:24:59 INFO  ---RUNTIME: Multi-Query Optimization took 29.236555099487305 ms
2022-09-21 16:24:59 INFO  Executing generated plans
2022-09-21 16:25:48 INFO  ---RUNTIME: Execution took 49803.95269393921 ms
2022-09-21 16:25:48 INFO  Done!
2022-09-21 16:25:48 INFO  # Finished -- repetition 5 of 7 
2022-09-21 16:25:48 INFO  # Optimization benchmark for data_cleaning with args [['healthcare', 'slow_loading', 'featurization_4', 'logistic_regression']] -- repetition 6 of 7
2022-09-21 16:25:48 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-21 16:25:48 INFO  Running instrumented original pipeline...
2022-09-21 16:25:48 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-21 16:25:48 INFO  ---RUNTIME: Importing and monkey-patching took 5.972146987915039 ms
2022-09-21 16:25:51 INFO  ---RUNTIME: Original pipeline execution took 2046.2448596954346 ms (excluding imports and monkey-patching)
2022-09-21 16:25:51 INFO  Starting execution of 1 what-if analyses...
2022-09-21 16:25:51 INFO  Start plan generation for analysis DataCleaning...
2022-09-21 16:25:51 INFO  ---RUNTIME: Plan generation took 0.7538795471191406 ms
2022-09-21 16:25:51 INFO  Estimated runtime of original DAG is 1772.9194164276123ms
2022-09-21 16:25:51 INFO  Performing Multi-Query Optimization
2022-09-21 16:25:51 INFO  Estimated unoptimized what-if runtime is 44338.303327560425ms
2022-09-21 16:25:51 INFO  Estimated optimised what-if runtime is 2005.4047107696533ms
2022-09-21 16:25:51 INFO  Estimated optimisation runtime saving is 42332.89861679077ms
2022-09-21 16:25:51 INFO  ---RUNTIME: Multi-Query Optimization took 138.25559616088867 ms
2022-09-21 16:25:51 INFO  Executing generated plans
2022-09-21 16:25:57 INFO  ---RUNTIME: Execution took 6372.6966381073 ms
2022-09-21 16:25:57 INFO  Done!
2022-09-21 16:25:57 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-21 16:25:57 INFO  Running instrumented original pipeline...
2022-09-21 16:25:57 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-21 16:25:57 INFO  ---RUNTIME: Importing and monkey-patching took 6.130218505859375 ms
2022-09-21 16:25:59 INFO  ---RUNTIME: Original pipeline execution took 2032.438039779663 ms (excluding imports and monkey-patching)
2022-09-21 16:25:59 INFO  Starting execution of 1 what-if analyses...
2022-09-21 16:25:59 INFO  Start plan generation for analysis DataCleaning...
2022-09-21 16:25:59 INFO  ---RUNTIME: Plan generation took 1.049041748046875 ms
2022-09-21 16:25:59 INFO  Estimated runtime of original DAG is 1761.1572742462158ms
2022-09-21 16:25:59 WARNING Skipping Multi-Query Optimization (instead, only applying patches)
2022-09-21 16:25:59 WARNING Columns ['full_name'] not present in train DAG after the train test split, only before!
2022-09-21 16:25:59 WARNING This could hint at data leakage!
2022-09-21 16:25:59 INFO  Estimated unoptimised what-if runtime is 44044.135332107544ms
2022-09-21 16:25:59 INFO  ---RUNTIME: Multi-Query Optimization took 29.093027114868164 ms
2022-09-21 16:25:59 INFO  Executing generated plans
2022-09-21 16:26:48 INFO  ---RUNTIME: Execution took 48881.601333618164 ms
2022-09-21 16:26:48 INFO  Done!
2022-09-21 16:26:48 INFO  # Finished -- repetition 6 of 7 
2022-09-21 16:26:48 INFO  # Optimization benchmark for data_cleaning with args [['healthcare', 'slow_loading', 'featurization_4', 'logistic_regression']] -- repetition 7 of 7
2022-09-21 16:26:48 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-21 16:26:48 INFO  Running instrumented original pipeline...
2022-09-21 16:26:48 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-21 16:26:48 INFO  ---RUNTIME: Importing and monkey-patching took 6.115436553955078 ms
2022-09-21 16:26:50 INFO  ---RUNTIME: Original pipeline execution took 2037.7068519592285 ms (excluding imports and monkey-patching)
2022-09-21 16:26:50 INFO  Starting execution of 1 what-if analyses...
2022-09-21 16:26:50 INFO  Start plan generation for analysis DataCleaning...
2022-09-21 16:26:50 INFO  ---RUNTIME: Plan generation took 0.7371902465820312 ms
2022-09-21 16:26:50 INFO  Estimated runtime of original DAG is 1765.6886577606201ms
2022-09-21 16:26:50 INFO  Performing Multi-Query Optimization
2022-09-21 16:26:50 INFO  Estimated unoptimized what-if runtime is 44157.43136405945ms
2022-09-21 16:26:50 INFO  Estimated optimised what-if runtime is 1996.772289276123ms
2022-09-21 16:26:50 INFO  Estimated optimisation runtime saving is 42160.659074783325ms
2022-09-21 16:26:50 INFO  ---RUNTIME: Multi-Query Optimization took 136.68537139892578 ms
2022-09-21 16:26:50 INFO  Executing generated plans
2022-09-21 16:26:57 INFO  ---RUNTIME: Execution took 6537.087440490723 ms
2022-09-21 16:26:57 INFO  Done!
2022-09-21 16:26:57 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-21 16:26:57 INFO  Running instrumented original pipeline...
2022-09-21 16:26:57 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-21 16:26:57 INFO  ---RUNTIME: Importing and monkey-patching took 6.318569183349609 ms
2022-09-21 16:26:59 INFO  ---RUNTIME: Original pipeline execution took 2074.828624725342 ms (excluding imports and monkey-patching)
2022-09-21 16:26:59 INFO  Starting execution of 1 what-if analyses...
2022-09-21 16:26:59 INFO  Start plan generation for analysis DataCleaning...
2022-09-21 16:26:59 INFO  ---RUNTIME: Plan generation took 0.7827281951904297 ms
2022-09-21 16:26:59 INFO  Estimated runtime of original DAG is 1801.1963367462158ms
2022-09-21 16:26:59 WARNING Skipping Multi-Query Optimization (instead, only applying patches)
2022-09-21 16:26:59 WARNING Columns ['full_name'] not present in train DAG after the train test split, only before!
2022-09-21 16:26:59 WARNING This could hint at data leakage!
2022-09-21 16:26:59 INFO  Estimated unoptimised what-if runtime is 45045.342206954956ms
2022-09-21 16:26:59 INFO  ---RUNTIME: Multi-Query Optimization took 29.651880264282227 ms
2022-09-21 16:26:59 INFO  Executing generated plans
2022-09-21 16:27:48 INFO  ---RUNTIME: Execution took 48835.48140525818 ms
2022-09-21 16:27:48 INFO  Done!
2022-09-21 16:27:48 INFO  # Finished -- repetition 7 of 7 
2022-09-21 16:27:48 INFO  # Final results after all repetitions
2022-09-21 16:27:48 INFO     repetition  ... no_opt_what_if_execution_combined_model_training
0           0  ...                                      3297.181129
1           1  ...                                      3353.353500
2           2  ...                                      3556.807041
3           3  ...                                      3400.288343
4           4  ...                                      3455.270052
5           5  ...                                      3472.004890
6           6  ...                                      3479.120493

[7 rows x 26 columns]
taskset -c 128-135 PROTOCOL_BUFFERS_PYTHON_IMPLEMENTATION=python python3.9 benchmarks_end_to_end.py data_cleaning healthcare slow_loading featurization_4 xgboost
2022-09-21 16:27:50.149450: W tensorflow/stream_executor/platform/default/dso_loader.cc:64] Could not load dynamic library 'libcudart.so.11.0'; dlerror: libcudart.so.11.0: cannot open shared object file: No such file or directory; LD_LIBRARY_PATH: /home/sgrafbe/mlwhatif/venv/lib/python3.9/site-packages/cv2/../../lib64:
2022-09-21 16:27:50.149494: I tensorflow/stream_executor/cuda/cudart_stub.cc:29] Ignore above cudart dlerror if you do not have a GPU set up on your machine.
2022-09-21 16:27:51 INFO  Patching sys.argv with ['mlwhatif', 'healthcare', 'slow_loading', 'featurization_4', 'xgboost']
2022-09-21 16:27:51 INFO  Running instrumented original pipeline...
2022-09-21 16:27:51 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-21 16:27:51 INFO  ---RUNTIME: Importing and monkey-patching took 95.04246711730957 ms
2022-09-21 16:27:57 INFO  ---RUNTIME: Original pipeline execution took 6438.778877258301 ms (excluding imports and monkey-patching)
2022-09-21 16:27:57 INFO  Starting execution of 0 what-if analyses...
2022-09-21 16:27:57 INFO  Estimated runtime of original DAG is 6117.915391921997ms
2022-09-21 16:27:57 INFO  Performing Multi-Query Optimization
2022-09-21 16:27:57 INFO  Estimated unoptimized what-if runtime is 0ms
2022-09-21 16:27:57 INFO  Estimated optimised what-if runtime is 0ms
2022-09-21 16:27:57 INFO  Estimated optimisation runtime saving is 0ms
2022-09-21 16:27:57 INFO  ---RUNTIME: Multi-Query Optimization took 0.7557868957519531 ms
2022-09-21 16:27:57 INFO  Executing generated plans
2022-09-21 16:27:57 INFO  ---RUNTIME: Execution took 0.028133392333984375 ms
2022-09-21 16:27:57 INFO  Done!
2022-09-21 16:27:57 INFO  # Optimization benchmark for data_cleaning with args [['healthcare', 'slow_loading', 'featurization_4', 'xgboost']] -- repetition 1 of 7
2022-09-21 16:27:57 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-21 16:27:57 INFO  Running instrumented original pipeline...
2022-09-21 16:27:57 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-21 16:27:57 INFO  ---RUNTIME: Importing and monkey-patching took 5.068540573120117 ms
2022-09-21 16:28:00 INFO  ---RUNTIME: Original pipeline execution took 2238.5473251342773 ms (excluding imports and monkey-patching)
2022-09-21 16:28:00 INFO  Starting execution of 1 what-if analyses...
2022-09-21 16:28:00 INFO  Start plan generation for analysis DataCleaning...
2022-09-21 16:28:00 INFO  ---RUNTIME: Plan generation took 0.7824897766113281 ms
2022-09-21 16:28:00 INFO  Estimated runtime of original DAG is 1955.2147388458252ms
2022-09-21 16:28:00 INFO  Performing Multi-Query Optimization
2022-09-21 16:28:00 INFO  Estimated unoptimized what-if runtime is 50048.35820198059ms
2022-09-21 16:28:00 INFO  Estimated optimised what-if runtime is 7998.729944229126ms
2022-09-21 16:28:00 INFO  Estimated optimisation runtime saving is 42049.628257751465ms
2022-09-21 16:28:00 INFO  ---RUNTIME: Multi-Query Optimization took 294.7678565979004 ms
2022-09-21 16:28:00 INFO  Executing generated plans
2022-09-21 16:28:12 INFO  ---RUNTIME: Execution took 11748.049020767212 ms
2022-09-21 16:28:12 INFO  Done!
2022-09-21 16:28:12 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-21 16:28:12 INFO  Running instrumented original pipeline...
2022-09-21 16:28:12 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-21 16:28:12 INFO  ---RUNTIME: Importing and monkey-patching took 6.526708602905273 ms
2022-09-21 16:28:14 INFO  ---RUNTIME: Original pipeline execution took 2230.5502891540527 ms (excluding imports and monkey-patching)
2022-09-21 16:28:14 INFO  Starting execution of 1 what-if analyses...
2022-09-21 16:28:14 INFO  Start plan generation for analysis DataCleaning...
2022-09-21 16:28:14 INFO  ---RUNTIME: Plan generation took 0.7746219635009766 ms
2022-09-21 16:28:14 INFO  Estimated runtime of original DAG is 1951.4188766479492ms
2022-09-21 16:28:14 WARNING Skipping Multi-Query Optimization (instead, only applying patches)
2022-09-21 16:28:14 WARNING Columns ['full_name'] not present in train DAG after the train test split, only before!
2022-09-21 16:28:14 WARNING This could hint at data leakage!
2022-09-21 16:28:14 INFO  Estimated unoptimised what-if runtime is 49954.641819000244ms
2022-09-21 16:28:14 INFO  ---RUNTIME: Multi-Query Optimization took 29.213905334472656 ms
2022-09-21 16:28:14 INFO  Executing generated plans
2022-09-21 16:29:09 INFO  ---RUNTIME: Execution took 54813.41505050659 ms
2022-09-21 16:29:09 INFO  Done!
2022-09-21 16:29:09 INFO  # Finished -- repetition 1 of 7 
2022-09-21 16:29:09 INFO  # Optimization benchmark for data_cleaning with args [['healthcare', 'slow_loading', 'featurization_4', 'xgboost']] -- repetition 2 of 7
2022-09-21 16:29:09 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-21 16:29:09 INFO  Running instrumented original pipeline...
2022-09-21 16:29:09 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-21 16:29:09 INFO  ---RUNTIME: Importing and monkey-patching took 6.1511993408203125 ms
2022-09-21 16:29:11 INFO  ---RUNTIME: Original pipeline execution took 2271.995782852173 ms (excluding imports and monkey-patching)
2022-09-21 16:29:11 INFO  Starting execution of 1 what-if analyses...
2022-09-21 16:29:11 INFO  Start plan generation for analysis DataCleaning...
2022-09-21 16:29:11 INFO  ---RUNTIME: Plan generation took 0.7908344268798828 ms
2022-09-21 16:29:11 INFO  Estimated runtime of original DAG is 1995.866060256958ms
2022-09-21 16:29:11 INFO  Performing Multi-Query Optimization
2022-09-21 16:29:11 INFO  Estimated unoptimized what-if runtime is 51080.010652542114ms
2022-09-21 16:29:11 INFO  Estimated optimised what-if runtime is 8110.343217849731ms
2022-09-21 16:29:11 INFO  Estimated optimisation runtime saving is 42969.66743469238ms
2022-09-21 16:29:11 INFO  ---RUNTIME: Multi-Query Optimization took 135.10656356811523 ms
2022-09-21 16:29:11 INFO  Executing generated plans
2022-09-21 16:29:23 INFO  ---RUNTIME: Execution took 11664.863109588623 ms
2022-09-21 16:29:23 INFO  Done!
2022-09-21 16:29:23 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-21 16:29:23 INFO  Running instrumented original pipeline...
2022-09-21 16:29:23 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-21 16:29:23 INFO  ---RUNTIME: Importing and monkey-patching took 5.918741226196289 ms
2022-09-21 16:29:25 INFO  ---RUNTIME: Original pipeline execution took 2431.443452835083 ms (excluding imports and monkey-patching)
2022-09-21 16:29:25 INFO  Starting execution of 1 what-if analyses...
2022-09-21 16:29:25 INFO  Start plan generation for analysis DataCleaning...
2022-09-21 16:29:25 INFO  ---RUNTIME: Plan generation took 0.7493495941162109 ms
2022-09-21 16:29:25 INFO  Estimated runtime of original DAG is 1973.1159210205078ms
2022-09-21 16:29:25 WARNING Skipping Multi-Query Optimization (instead, only applying patches)
2022-09-21 16:29:25 WARNING Columns ['full_name'] not present in train DAG after the train test split, only before!
2022-09-21 16:29:25 WARNING This could hint at data leakage!
2022-09-21 16:29:25 INFO  Estimated unoptimised what-if runtime is 50502.891540527344ms
2022-09-21 16:29:25 INFO  ---RUNTIME: Multi-Query Optimization took 29.342174530029297 ms
2022-09-21 16:29:25 INFO  Executing generated plans
2022-09-21 16:30:20 INFO  ---RUNTIME: Execution took 54226.238489151 ms
2022-09-21 16:30:20 INFO  Done!
2022-09-21 16:30:20 INFO  # Finished -- repetition 2 of 7 
2022-09-21 16:30:20 INFO  # Optimization benchmark for data_cleaning with args [['healthcare', 'slow_loading', 'featurization_4', 'xgboost']] -- repetition 3 of 7
2022-09-21 16:30:20 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-21 16:30:20 INFO  Running instrumented original pipeline...
2022-09-21 16:30:20 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-21 16:30:20 INFO  ---RUNTIME: Importing and monkey-patching took 6.144046783447266 ms
2022-09-21 16:30:22 INFO  ---RUNTIME: Original pipeline execution took 2245.534658432007 ms (excluding imports and monkey-patching)
2022-09-21 16:30:22 INFO  Starting execution of 1 what-if analyses...
2022-09-21 16:30:22 INFO  Start plan generation for analysis DataCleaning...
2022-09-21 16:30:22 INFO  ---RUNTIME: Plan generation took 1.1715888977050781 ms
2022-09-21 16:30:22 INFO  Estimated runtime of original DAG is 1967.5421714782715ms
2022-09-21 16:30:22 INFO  Performing Multi-Query Optimization
2022-09-21 16:30:22 INFO  Estimated unoptimized what-if runtime is 50374.701499938965ms
2022-09-21 16:30:22 INFO  Estimated optimised what-if runtime is 8094.177722930908ms
2022-09-21 16:30:22 INFO  Estimated optimisation runtime saving is 42280.52377700806ms
2022-09-21 16:30:22 INFO  ---RUNTIME: Multi-Query Optimization took 138.72575759887695 ms
2022-09-21 16:30:22 INFO  Executing generated plans
2022-09-21 16:30:34 INFO  ---RUNTIME: Execution took 11839.586019515991 ms
2022-09-21 16:30:34 INFO  Done!
2022-09-21 16:30:34 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-21 16:30:34 INFO  Running instrumented original pipeline...
2022-09-21 16:30:34 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-21 16:30:34 INFO  ---RUNTIME: Importing and monkey-patching took 6.211519241333008 ms
2022-09-21 16:30:36 INFO  ---RUNTIME: Original pipeline execution took 2222.0046520233154 ms (excluding imports and monkey-patching)
2022-09-21 16:30:36 INFO  Starting execution of 1 what-if analyses...
2022-09-21 16:30:36 INFO  Start plan generation for analysis DataCleaning...
2022-09-21 16:30:36 INFO  ---RUNTIME: Plan generation took 0.7574558258056641 ms
2022-09-21 16:30:36 INFO  Estimated runtime of original DAG is 1945.4848766326904ms
2022-09-21 16:30:36 WARNING Skipping Multi-Query Optimization (instead, only applying patches)
2022-09-21 16:30:36 WARNING Columns ['full_name'] not present in train DAG after the train test split, only before!
2022-09-21 16:30:36 WARNING This could hint at data leakage!
2022-09-21 16:30:36 INFO  Estimated unoptimised what-if runtime is 49808.77375602722ms
2022-09-21 16:30:36 INFO  ---RUNTIME: Multi-Query Optimization took 30.55286407470703 ms
2022-09-21 16:30:36 INFO  Executing generated plans
2022-09-21 16:31:31 INFO  ---RUNTIME: Execution took 54843.96767616272 ms
2022-09-21 16:31:31 INFO  Done!
2022-09-21 16:31:31 INFO  # Finished -- repetition 3 of 7 
2022-09-21 16:31:31 INFO  # Optimization benchmark for data_cleaning with args [['healthcare', 'slow_loading', 'featurization_4', 'xgboost']] -- repetition 4 of 7
2022-09-21 16:31:31 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-21 16:31:31 INFO  Running instrumented original pipeline...
2022-09-21 16:31:31 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-21 16:31:31 INFO  ---RUNTIME: Importing and monkey-patching took 5.846500396728516 ms
2022-09-21 16:31:33 INFO  ---RUNTIME: Original pipeline execution took 2237.0433807373047 ms (excluding imports and monkey-patching)
2022-09-21 16:31:33 INFO  Starting execution of 1 what-if analyses...
2022-09-21 16:31:33 INFO  Start plan generation for analysis DataCleaning...
2022-09-21 16:31:33 INFO  ---RUNTIME: Plan generation took 0.7433891296386719 ms
2022-09-21 16:31:33 INFO  Estimated runtime of original DAG is 1962.1155261993408ms
2022-09-21 16:31:33 INFO  Performing Multi-Query Optimization
2022-09-21 16:31:33 INFO  Estimated unoptimized what-if runtime is 50237.38169670105ms
2022-09-21 16:31:33 INFO  Estimated optimised what-if runtime is 8078.556537628174ms
2022-09-21 16:31:33 INFO  Estimated optimisation runtime saving is 42158.825159072876ms
2022-09-21 16:31:33 INFO  ---RUNTIME: Multi-Query Optimization took 136.46531105041504 ms
2022-09-21 16:31:33 INFO  Executing generated plans
2022-09-21 16:31:45 INFO  ---RUNTIME: Execution took 11725.23283958435 ms
2022-09-21 16:31:45 INFO  Done!
2022-09-21 16:31:45 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-21 16:31:45 INFO  Running instrumented original pipeline...
2022-09-21 16:31:45 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-21 16:31:45 INFO  ---RUNTIME: Importing and monkey-patching took 5.965709686279297 ms
2022-09-21 16:31:47 INFO  ---RUNTIME: Original pipeline execution took 2226.386785507202 ms (excluding imports and monkey-patching)
2022-09-21 16:31:47 INFO  Starting execution of 1 what-if analyses...
2022-09-21 16:31:47 INFO  Start plan generation for analysis DataCleaning...
2022-09-21 16:31:47 INFO  ---RUNTIME: Plan generation took 0.7901191711425781 ms
2022-09-21 16:31:47 INFO  Estimated runtime of original DAG is 1950.3474235534668ms
2022-09-21 16:31:47 WARNING Skipping Multi-Query Optimization (instead, only applying patches)
2022-09-21 16:31:47 WARNING Columns ['full_name'] not present in train DAG after the train test split, only before!
2022-09-21 16:31:47 WARNING This could hint at data leakage!
2022-09-21 16:31:47 INFO  Estimated unoptimised what-if runtime is 49932.297229766846ms
2022-09-21 16:31:47 INFO  ---RUNTIME: Multi-Query Optimization took 29.59752082824707 ms
2022-09-21 16:31:47 INFO  Executing generated plans
2022-09-21 16:32:41 INFO  ---RUNTIME: Execution took 54179.948568344116 ms
2022-09-21 16:32:41 INFO  Done!
2022-09-21 16:32:41 INFO  # Finished -- repetition 4 of 7 
2022-09-21 16:32:41 INFO  # Optimization benchmark for data_cleaning with args [['healthcare', 'slow_loading', 'featurization_4', 'xgboost']] -- repetition 5 of 7
2022-09-21 16:32:41 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-21 16:32:41 INFO  Running instrumented original pipeline...
2022-09-21 16:32:42 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-21 16:32:42 INFO  ---RUNTIME: Importing and monkey-patching took 6.339311599731445 ms
2022-09-21 16:32:44 INFO  ---RUNTIME: Original pipeline execution took 2256.941080093384 ms (excluding imports and monkey-patching)
2022-09-21 16:32:44 INFO  Starting execution of 1 what-if analyses...
2022-09-21 16:32:44 INFO  Start plan generation for analysis DataCleaning...
2022-09-21 16:32:44 INFO  ---RUNTIME: Plan generation took 0.7724761962890625 ms
2022-09-21 16:32:44 INFO  Estimated runtime of original DAG is 1980.0221920013428ms
2022-09-21 16:32:44 INFO  Performing Multi-Query Optimization
2022-09-21 16:32:44 INFO  Estimated unoptimized what-if runtime is 50681.341886520386ms
2022-09-21 16:32:44 INFO  Estimated optimised what-if runtime is 8080.216646194458ms
2022-09-21 16:32:44 INFO  Estimated optimisation runtime saving is 42601.12524032593ms
2022-09-21 16:32:44 INFO  ---RUNTIME: Multi-Query Optimization took 134.31668281555176 ms
2022-09-21 16:32:44 INFO  Executing generated plans
2022-09-21 16:32:57 INFO  ---RUNTIME: Execution took 12757.300615310669 ms
2022-09-21 16:32:57 INFO  Done!
2022-09-21 16:32:57 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-21 16:32:57 INFO  Running instrumented original pipeline...
2022-09-21 16:32:57 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-21 16:32:57 INFO  ---RUNTIME: Importing and monkey-patching took 6.363153457641602 ms
2022-09-21 16:32:59 INFO  ---RUNTIME: Original pipeline execution took 2262.105941772461 ms (excluding imports and monkey-patching)
2022-09-21 16:32:59 INFO  Starting execution of 1 what-if analyses...
2022-09-21 16:32:59 INFO  Start plan generation for analysis DataCleaning...
2022-09-21 16:32:59 INFO  ---RUNTIME: Plan generation took 0.7376670837402344 ms
2022-09-21 16:32:59 INFO  Estimated runtime of original DAG is 1966.8660163879395ms
2022-09-21 16:32:59 WARNING Skipping Multi-Query Optimization (instead, only applying patches)
2022-09-21 16:32:59 WARNING Columns ['full_name'] not present in train DAG after the train test split, only before!
2022-09-21 16:32:59 WARNING This could hint at data leakage!
2022-09-21 16:32:59 INFO  Estimated unoptimised what-if runtime is 50370.67651748657ms
2022-09-21 16:32:59 INFO  ---RUNTIME: Multi-Query Optimization took 29.55007553100586 ms
2022-09-21 16:32:59 INFO  Executing generated plans
2022-09-21 16:33:54 INFO  ---RUNTIME: Execution took 55094.28930282593 ms
2022-09-21 16:33:54 INFO  Done!
2022-09-21 16:33:54 INFO  # Finished -- repetition 5 of 7 
2022-09-21 16:33:54 INFO  # Optimization benchmark for data_cleaning with args [['healthcare', 'slow_loading', 'featurization_4', 'xgboost']] -- repetition 6 of 7
2022-09-21 16:33:54 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-21 16:33:54 INFO  Running instrumented original pipeline...
2022-09-21 16:33:54 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-21 16:33:54 INFO  ---RUNTIME: Importing and monkey-patching took 6.034612655639648 ms
2022-09-21 16:33:56 INFO  ---RUNTIME: Original pipeline execution took 2217.170238494873 ms (excluding imports and monkey-patching)
2022-09-21 16:33:56 INFO  Starting execution of 1 what-if analyses...
2022-09-21 16:33:56 INFO  Start plan generation for analysis DataCleaning...
2022-09-21 16:33:56 INFO  ---RUNTIME: Plan generation took 0.7793903350830078 ms
2022-09-21 16:33:56 INFO  Estimated runtime of original DAG is 1941.847562789917ms
2022-09-21 16:33:56 INFO  Performing Multi-Query Optimization
2022-09-21 16:33:56 INFO  Estimated unoptimized what-if runtime is 49719.3329334259ms
2022-09-21 16:33:56 INFO  Estimated optimised what-if runtime is 8004.597187042236ms
2022-09-21 16:33:56 INFO  Estimated optimisation runtime saving is 41714.73574638367ms
2022-09-21 16:33:56 INFO  ---RUNTIME: Multi-Query Optimization took 134.50098037719727 ms
2022-09-21 16:33:56 INFO  Executing generated plans
2022-09-21 16:34:08 INFO  ---RUNTIME: Execution took 11842.028141021729 ms
2022-09-21 16:34:08 INFO  Done!
2022-09-21 16:34:08 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-21 16:34:08 INFO  Running instrumented original pipeline...
2022-09-21 16:34:08 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-21 16:34:08 INFO  ---RUNTIME: Importing and monkey-patching took 6.123781204223633 ms
2022-09-21 16:34:11 INFO  ---RUNTIME: Original pipeline execution took 2248.744487762451 ms (excluding imports and monkey-patching)
2022-09-21 16:34:11 INFO  Starting execution of 1 what-if analyses...
2022-09-21 16:34:11 INFO  Start plan generation for analysis DataCleaning...
2022-09-21 16:34:11 INFO  ---RUNTIME: Plan generation took 0.9248256683349609 ms
2022-09-21 16:34:11 INFO  Estimated runtime of original DAG is 1973.642110824585ms
2022-09-21 16:34:11 WARNING Skipping Multi-Query Optimization (instead, only applying patches)
2022-09-21 16:34:11 WARNING Columns ['full_name'] not present in train DAG after the train test split, only before!
2022-09-21 16:34:11 WARNING This could hint at data leakage!
2022-09-21 16:34:11 INFO  Estimated unoptimised what-if runtime is 50523.36049079895ms
2022-09-21 16:34:11 INFO  ---RUNTIME: Multi-Query Optimization took 29.986858367919922 ms
2022-09-21 16:34:11 INFO  Executing generated plans
2022-09-21 16:35:05 INFO  ---RUNTIME: Execution took 54656.34059906006 ms
2022-09-21 16:35:05 INFO  Done!
2022-09-21 16:35:05 INFO  # Finished -- repetition 6 of 7 
2022-09-21 16:35:05 INFO  # Optimization benchmark for data_cleaning with args [['healthcare', 'slow_loading', 'featurization_4', 'xgboost']] -- repetition 7 of 7
2022-09-21 16:35:05 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-21 16:35:05 INFO  Running instrumented original pipeline...
2022-09-21 16:35:05 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-21 16:35:05 INFO  ---RUNTIME: Importing and monkey-patching took 6.361961364746094 ms
2022-09-21 16:35:07 INFO  ---RUNTIME: Original pipeline execution took 2222.618818283081 ms (excluding imports and monkey-patching)
2022-09-21 16:35:07 INFO  Starting execution of 1 what-if analyses...
2022-09-21 16:35:07 INFO  Start plan generation for analysis DataCleaning...
2022-09-21 16:35:07 INFO  ---RUNTIME: Plan generation took 0.7710456848144531 ms
2022-09-21 16:35:07 INFO  Estimated runtime of original DAG is 1950.8907794952393ms
2022-09-21 16:35:07 INFO  Performing Multi-Query Optimization
2022-09-21 16:35:08 INFO  Estimated unoptimized what-if runtime is 49954.148054122925ms
2022-09-21 16:35:08 INFO  Estimated optimised what-if runtime is 8056.664228439331ms
2022-09-21 16:35:08 INFO  Estimated optimisation runtime saving is 41897.483825683594ms
2022-09-21 16:35:08 INFO  ---RUNTIME: Multi-Query Optimization took 135.939359664917 ms
2022-09-21 16:35:08 INFO  Executing generated plans
2022-09-21 16:35:20 INFO  ---RUNTIME: Execution took 12174.758195877075 ms
2022-09-21 16:35:20 INFO  Done!
2022-09-21 16:35:20 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-21 16:35:20 INFO  Running instrumented original pipeline...
2022-09-21 16:35:20 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-21 16:35:20 INFO  ---RUNTIME: Importing and monkey-patching took 5.907297134399414 ms
2022-09-21 16:35:22 INFO  ---RUNTIME: Original pipeline execution took 2225.3077030181885 ms (excluding imports and monkey-patching)
2022-09-21 16:35:22 INFO  Starting execution of 1 what-if analyses...
2022-09-21 16:35:22 INFO  Start plan generation for analysis DataCleaning...
2022-09-21 16:35:22 INFO  ---RUNTIME: Plan generation took 0.7536411285400391 ms
2022-09-21 16:35:22 INFO  Estimated runtime of original DAG is 1952.850103378296ms
2022-09-21 16:35:22 WARNING Skipping Multi-Query Optimization (instead, only applying patches)
2022-09-21 16:35:22 WARNING Columns ['full_name'] not present in train DAG after the train test split, only before!
2022-09-21 16:35:22 WARNING This could hint at data leakage!
2022-09-21 16:35:22 INFO  Estimated unoptimised what-if runtime is 50006.3111782074ms
2022-09-21 16:35:22 INFO  ---RUNTIME: Multi-Query Optimization took 29.379606246948242 ms
2022-09-21 16:35:22 INFO  Executing generated plans
2022-09-21 16:36:16 INFO  ---RUNTIME: Execution took 54344.70796585083 ms
2022-09-21 16:36:16 INFO  Done!
2022-09-21 16:36:16 INFO  # Finished -- repetition 7 of 7 
2022-09-21 16:36:16 INFO  # Final results after all repetitions
2022-09-21 16:36:16 INFO     repetition  ... no_opt_what_if_execution_combined_model_training
0           0  ...                                      9098.690033
1           1  ...                                      9087.940454
2           2  ...                                      9372.287750
3           3  ...                                      8987.984896
4           4  ...                                      9249.748945
5           5  ...                                      9177.520990
6           6  ...                                      9211.240768

[7 rows x 26 columns]
taskset -c 128-135 PROTOCOL_BUFFERS_PYTHON_IMPLEMENTATION=python python3.9 benchmarks_end_to_end.py data_cleaning healthcare slow_loading featurization_4 neural_network
2022-09-21 16:36:18.867137: W tensorflow/stream_executor/platform/default/dso_loader.cc:64] Could not load dynamic library 'libcudart.so.11.0'; dlerror: libcudart.so.11.0: cannot open shared object file: No such file or directory; LD_LIBRARY_PATH: /home/sgrafbe/mlwhatif/venv/lib/python3.9/site-packages/cv2/../../lib64:
2022-09-21 16:36:18.867181: I tensorflow/stream_executor/cuda/cudart_stub.cc:29] Ignore above cudart dlerror if you do not have a GPU set up on your machine.
2022-09-21 16:36:20 INFO  Patching sys.argv with ['mlwhatif', 'healthcare', 'slow_loading', 'featurization_4', 'neural_network']
2022-09-21 16:36:20 INFO  Running instrumented original pipeline...
2022-09-21 16:36:20 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-21 16:36:20 INFO  ---RUNTIME: Importing and monkey-patching took 95.07274627685547 ms
2022-09-21 16:36:22.338179: W tensorflow/stream_executor/platform/default/dso_loader.cc:64] Could not load dynamic library 'libcuda.so.1'; dlerror: libcuda.so.1: cannot open shared object file: No such file or directory; LD_LIBRARY_PATH: /home/sgrafbe/mlwhatif/venv/lib/python3.9/site-packages/cv2/../../lib64:
2022-09-21 16:36:22.338212: W tensorflow/stream_executor/cuda/cuda_driver.cc:326] failed call to cuInit: UNKNOWN ERROR (303)
2022-09-21 16:36:22.338233: I tensorflow/stream_executor/cuda/cuda_diagnostics.cc:156] kernel driver does not appear to be running on this host (wagyu): /proc/driver/nvidia/version does not exist
2022-09-21 16:36:22.338670: I tensorflow/core/platform/cpu_feature_guard.cc:142] This TensorFlow binary is optimized with oneAPI Deep Neural Network Library (oneDNN) to use the following CPU instructions in performance-critical operations:  AVX2 FMA
To enable them in other operations, rebuild TensorFlow with the appropriate compiler flags.
2022-09-21 16:36:22.402999: I tensorflow/compiler/mlir/mlir_graph_optimization_pass.cc:176] None of the MLIR Optimization Passes are enabled (registered 2)
2022-09-21 16:36:22.415426: I tensorflow/core/platform/profile_utils/cpu_utils.cc:114] CPU Frequency: 2595290000 Hz
2022-09-21 16:36:23 INFO  ---RUNTIME: Original pipeline execution took 2832.9262733459473 ms (excluding imports and monkey-patching)
2022-09-21 16:36:23 INFO  Starting execution of 0 what-if analyses...
2022-09-21 16:36:23 INFO  Estimated runtime of original DAG is 2526.3168811798096ms
2022-09-21 16:36:23 INFO  Performing Multi-Query Optimization
2022-09-21 16:36:23 INFO  Estimated unoptimized what-if runtime is 0ms
2022-09-21 16:36:23 INFO  Estimated optimised what-if runtime is 0ms
2022-09-21 16:36:23 INFO  Estimated optimisation runtime saving is 0ms
2022-09-21 16:36:23 INFO  ---RUNTIME: Multi-Query Optimization took 0.5140304565429688 ms
2022-09-21 16:36:23 INFO  Executing generated plans
2022-09-21 16:36:23 INFO  ---RUNTIME: Execution took 0.014781951904296875 ms
2022-09-21 16:36:23 INFO  Done!
2022-09-21 16:36:23 INFO  # Optimization benchmark for data_cleaning with args [['healthcare', 'slow_loading', 'featurization_4', 'neural_network']] -- repetition 1 of 7
2022-09-21 16:36:23 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-21 16:36:23 INFO  Running instrumented original pipeline...
2022-09-21 16:36:23 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-21 16:36:23 INFO  ---RUNTIME: Importing and monkey-patching took 5.191564559936523 ms
2022-09-21 16:36:25 INFO  ---RUNTIME: Original pipeline execution took 2424.419403076172 ms (excluding imports and monkey-patching)
2022-09-21 16:36:25 INFO  Starting execution of 1 what-if analyses...
2022-09-21 16:36:25 INFO  Start plan generation for analysis DataCleaning...
2022-09-21 16:36:25 INFO  ---RUNTIME: Plan generation took 0.8020401000976562 ms
2022-09-21 16:36:25 INFO  Estimated runtime of original DAG is 2152.2676944732666ms
2022-09-21 16:36:25 INFO  Performing Multi-Query Optimization
2022-09-21 16:36:25 INFO  Estimated unoptimized what-if runtime is 55820.13297080994ms
2022-09-21 16:36:25 INFO  Estimated optimised what-if runtime is 13649.273157119751ms
2022-09-21 16:36:25 INFO  Estimated optimisation runtime saving is 42170.859813690186ms
2022-09-21 16:36:25 INFO  ---RUNTIME: Multi-Query Optimization took 137.4835968017578 ms
2022-09-21 16:36:25 INFO  Executing generated plans
2022-09-21 16:36:44 INFO  ---RUNTIME: Execution took 18983.824014663696 ms
2022-09-21 16:36:44 INFO  Done!
2022-09-21 16:36:44 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-21 16:36:44 INFO  Running instrumented original pipeline...
2022-09-21 16:36:44 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-21 16:36:44 INFO  ---RUNTIME: Importing and monkey-patching took 6.163120269775391 ms
2022-09-21 16:36:47 INFO  ---RUNTIME: Original pipeline execution took 2566.4334297180176 ms (excluding imports and monkey-patching)
2022-09-21 16:36:47 INFO  Starting execution of 1 what-if analyses...
2022-09-21 16:36:47 INFO  Start plan generation for analysis DataCleaning...
2022-09-21 16:36:47 INFO  ---RUNTIME: Plan generation took 0.8296966552734375 ms
2022-09-21 16:36:47 INFO  Estimated runtime of original DAG is 2285.1059436798096ms
2022-09-21 16:36:47 WARNING Skipping Multi-Query Optimization (instead, only applying patches)
2022-09-21 16:36:47 WARNING Columns ['full_name'] not present in train DAG after the train test split, only before!
2022-09-21 16:36:47 WARNING This could hint at data leakage!
2022-09-21 16:36:47 INFO  Estimated unoptimised what-if runtime is 59330.20997047424ms
2022-09-21 16:36:47 INFO  ---RUNTIME: Multi-Query Optimization took 28.231382369995117 ms
2022-09-21 16:36:47 INFO  Executing generated plans
2022-09-21 16:37:52 INFO  ---RUNTIME: Execution took 64849.926471710205 ms
2022-09-21 16:37:52 INFO  Done!
2022-09-21 16:37:52 INFO  # Finished -- repetition 1 of 7 
2022-09-21 16:37:52 INFO  # Optimization benchmark for data_cleaning with args [['healthcare', 'slow_loading', 'featurization_4', 'neural_network']] -- repetition 2 of 7
2022-09-21 16:37:52 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-21 16:37:52 INFO  Running instrumented original pipeline...
2022-09-21 16:37:52 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-21 16:37:52 INFO  ---RUNTIME: Importing and monkey-patching took 6.182670593261719 ms
2022-09-21 16:37:54 INFO  ---RUNTIME: Original pipeline execution took 2444.9727535247803 ms (excluding imports and monkey-patching)
2022-09-21 16:37:54 INFO  Starting execution of 1 what-if analyses...
2022-09-21 16:37:54 INFO  Start plan generation for analysis DataCleaning...
2022-09-21 16:37:54 INFO  ---RUNTIME: Plan generation took 277.482271194458 ms
2022-09-21 16:37:54 INFO  Estimated runtime of original DAG is 2169.922351837158ms
2022-09-21 16:37:54 INFO  Performing Multi-Query Optimization
2022-09-21 16:37:54 INFO  Estimated unoptimized what-if runtime is 56235.47410964966ms
2022-09-21 16:37:54 INFO  Estimated optimised what-if runtime is 13509.833812713623ms
2022-09-21 16:37:54 INFO  Estimated optimisation runtime saving is 42725.640296936035ms
2022-09-21 16:37:54 INFO  ---RUNTIME: Multi-Query Optimization took 133.79669189453125 ms
2022-09-21 16:37:54 INFO  Executing generated plans
2022-09-21 16:38:14 INFO  ---RUNTIME: Execution took 20020.004987716675 ms
2022-09-21 16:38:14 INFO  Done!
2022-09-21 16:38:14 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-21 16:38:14 INFO  Running instrumented original pipeline...
2022-09-21 16:38:14 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-21 16:38:14 INFO  ---RUNTIME: Importing and monkey-patching took 6.834983825683594 ms
2022-09-21 16:38:18 INFO  ---RUNTIME: Original pipeline execution took 3100.597143173218 ms (excluding imports and monkey-patching)
2022-09-21 16:38:18 INFO  Starting execution of 1 what-if analyses...
2022-09-21 16:38:18 INFO  Start plan generation for analysis DataCleaning...
2022-09-21 16:38:18 INFO  ---RUNTIME: Plan generation took 0.7839202880859375 ms
2022-09-21 16:38:18 INFO  Estimated runtime of original DAG is 2816.683530807495ms
2022-09-21 16:38:18 WARNING Skipping Multi-Query Optimization (instead, only applying patches)
2022-09-21 16:38:18 WARNING Columns ['full_name'] not present in train DAG after the train test split, only before!
2022-09-21 16:38:18 WARNING This could hint at data leakage!
2022-09-21 16:38:18 INFO  Estimated unoptimised what-if runtime is 73004.99081611633ms
2022-09-21 16:38:18 INFO  ---RUNTIME: Multi-Query Optimization took 29.311656951904297 ms
2022-09-21 16:38:18 INFO  Executing generated plans
2022-09-21 16:39:22 INFO  ---RUNTIME: Execution took 64337.926387786865 ms
2022-09-21 16:39:22 INFO  Done!
2022-09-21 16:39:22 INFO  # Finished -- repetition 2 of 7 
2022-09-21 16:39:22 INFO  # Optimization benchmark for data_cleaning with args [['healthcare', 'slow_loading', 'featurization_4', 'neural_network']] -- repetition 3 of 7
2022-09-21 16:39:22 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-21 16:39:22 INFO  Running instrumented original pipeline...
2022-09-21 16:39:22 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-21 16:39:22 INFO  ---RUNTIME: Importing and monkey-patching took 6.300449371337891 ms
2022-09-21 16:39:24 INFO  ---RUNTIME: Original pipeline execution took 2416.667699813843 ms (excluding imports and monkey-patching)
2022-09-21 16:39:24 INFO  Starting execution of 1 what-if analyses...
2022-09-21 16:39:24 INFO  Start plan generation for analysis DataCleaning...
2022-09-21 16:39:24 INFO  ---RUNTIME: Plan generation took 0.8423328399658203 ms
2022-09-21 16:39:24 INFO  Estimated runtime of original DAG is 2141.4031982421875ms
2022-09-21 16:39:24 INFO  Performing Multi-Query Optimization
2022-09-21 16:39:24 INFO  Estimated unoptimized what-if runtime is 55529.81233596802ms
2022-09-21 16:39:24 INFO  Estimated optimised what-if runtime is 13492.513656616211ms
2022-09-21 16:39:24 INFO  Estimated optimisation runtime saving is 42037.29867935181ms
2022-09-21 16:39:24 INFO  ---RUNTIME: Multi-Query Optimization took 135.9705924987793 ms
2022-09-21 16:39:24 INFO  Executing generated plans
2022-09-21 16:39:45 INFO  ---RUNTIME: Execution took 20753.36480140686 ms
2022-09-21 16:39:45 INFO  Done!
2022-09-21 16:39:45 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-21 16:39:45 INFO  Running instrumented original pipeline...
2022-09-21 16:39:45 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-21 16:39:45 INFO  ---RUNTIME: Importing and monkey-patching took 6.241321563720703 ms
2022-09-21 16:39:48 INFO  ---RUNTIME: Original pipeline execution took 2427.622079849243 ms (excluding imports and monkey-patching)
2022-09-21 16:39:48 INFO  Starting execution of 1 what-if analyses...
2022-09-21 16:39:48 INFO  Start plan generation for analysis DataCleaning...
2022-09-21 16:39:48 INFO  ---RUNTIME: Plan generation took 2.457857131958008 ms
2022-09-21 16:39:48 INFO  Estimated runtime of original DAG is 2150.171995162964ms
2022-09-21 16:39:48 WARNING Skipping Multi-Query Optimization (instead, only applying patches)
2022-09-21 16:39:48 WARNING Columns ['full_name'] not present in train DAG after the train test split, only before!
2022-09-21 16:39:48 WARNING This could hint at data leakage!
2022-09-21 16:39:48 INFO  Estimated unoptimised what-if runtime is 55763.91673088074ms
2022-09-21 16:39:48 INFO  ---RUNTIME: Multi-Query Optimization took 28.374433517456055 ms
2022-09-21 16:39:48 INFO  Executing generated plans
2022-09-21 16:40:51 INFO  ---RUNTIME: Execution took 63778.228998184204 ms
2022-09-21 16:40:51 INFO  Done!
2022-09-21 16:40:51 INFO  # Finished -- repetition 3 of 7 
2022-09-21 16:40:51 INFO  # Optimization benchmark for data_cleaning with args [['healthcare', 'slow_loading', 'featurization_4', 'neural_network']] -- repetition 4 of 7
2022-09-21 16:40:51 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-21 16:40:51 INFO  Running instrumented original pipeline...
2022-09-21 16:40:52 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-21 16:40:52 INFO  ---RUNTIME: Importing and monkey-patching took 6.300210952758789 ms
2022-09-21 16:40:54 INFO  ---RUNTIME: Original pipeline execution took 2411.764144897461 ms (excluding imports and monkey-patching)
2022-09-21 16:40:54 INFO  Starting execution of 1 what-if analyses...
2022-09-21 16:40:54 INFO  Start plan generation for analysis DataCleaning...
2022-09-21 16:40:54 INFO  ---RUNTIME: Plan generation took 0.8699893951416016 ms
2022-09-21 16:40:54 INFO  Estimated runtime of original DAG is 2136.425256729126ms
2022-09-21 16:40:54 INFO  Performing Multi-Query Optimization
2022-09-21 16:40:54 INFO  Estimated unoptimized what-if runtime is 55401.48568153381ms
2022-09-21 16:40:54 INFO  Estimated optimised what-if runtime is 13456.624269485474ms
2022-09-21 16:40:54 INFO  Estimated optimisation runtime saving is 41944.86141204834ms
2022-09-21 16:40:54 INFO  ---RUNTIME: Multi-Query Optimization took 135.91361045837402 ms
2022-09-21 16:40:54 INFO  Executing generated plans
2022-09-21 16:41:15 INFO  ---RUNTIME: Execution took 20744.200229644775 ms
2022-09-21 16:41:15 INFO  Done!
2022-09-21 16:41:15 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-21 16:41:15 INFO  Running instrumented original pipeline...
2022-09-21 16:41:15 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-21 16:41:15 INFO  ---RUNTIME: Importing and monkey-patching took 6.233692169189453 ms
2022-09-21 16:41:17 INFO  ---RUNTIME: Original pipeline execution took 2416.1882400512695 ms (excluding imports and monkey-patching)
2022-09-21 16:41:17 INFO  Starting execution of 1 what-if analyses...
2022-09-21 16:41:17 INFO  Start plan generation for analysis DataCleaning...
2022-09-21 16:41:17 INFO  ---RUNTIME: Plan generation took 2.6798248291015625 ms
2022-09-21 16:41:17 INFO  Estimated runtime of original DAG is 2140.0914192199707ms
2022-09-21 16:41:17 WARNING Skipping Multi-Query Optimization (instead, only applying patches)
2022-09-21 16:41:17 WARNING Columns ['full_name'] not present in train DAG after the train test split, only before!
2022-09-21 16:41:17 WARNING This could hint at data leakage!
2022-09-21 16:41:17 INFO  Estimated unoptimised what-if runtime is 55501.26791000366ms
2022-09-21 16:41:17 INFO  ---RUNTIME: Multi-Query Optimization took 28.530359268188477 ms
2022-09-21 16:41:17 INFO  Executing generated plans
2022-09-21 16:42:21 INFO  ---RUNTIME: Execution took 64060.636043548584 ms
2022-09-21 16:42:21 INFO  Done!
2022-09-21 16:42:21 INFO  # Finished -- repetition 4 of 7 
2022-09-21 16:42:21 INFO  # Optimization benchmark for data_cleaning with args [['healthcare', 'slow_loading', 'featurization_4', 'neural_network']] -- repetition 5 of 7
2022-09-21 16:42:21 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-21 16:42:21 INFO  Running instrumented original pipeline...
2022-09-21 16:42:21 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-21 16:42:21 INFO  ---RUNTIME: Importing and monkey-patching took 6.211519241333008 ms
2022-09-21 16:42:24 INFO  ---RUNTIME: Original pipeline execution took 2453.648805618286 ms (excluding imports and monkey-patching)
2022-09-21 16:42:24 INFO  Starting execution of 1 what-if analyses...
2022-09-21 16:42:24 INFO  Start plan generation for analysis DataCleaning...
2022-09-21 16:42:24 INFO  ---RUNTIME: Plan generation took 1.3480186462402344 ms
2022-09-21 16:42:24 INFO  Estimated runtime of original DAG is 2167.9911613464355ms
2022-09-21 16:42:24 INFO  Performing Multi-Query Optimization
2022-09-21 16:42:24 INFO  Estimated unoptimized what-if runtime is 56299.37505722046ms
2022-09-21 16:42:24 INFO  Estimated optimised what-if runtime is 14124.67646598816ms
2022-09-21 16:42:24 INFO  Estimated optimisation runtime saving is 42174.6985912323ms
2022-09-21 16:42:24 INFO  ---RUNTIME: Multi-Query Optimization took 146.05045318603516 ms
2022-09-21 16:42:24 INFO  Executing generated plans
2022-09-21 16:42:44 INFO  ---RUNTIME: Execution took 20267.977476119995 ms
2022-09-21 16:42:44 INFO  Done!
2022-09-21 16:42:44 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-21 16:42:44 INFO  Running instrumented original pipeline...
2022-09-21 16:42:45 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-21 16:42:45 INFO  ---RUNTIME: Importing and monkey-patching took 6.138086318969727 ms
2022-09-21 16:42:47 INFO  ---RUNTIME: Original pipeline execution took 3058.5052967071533 ms (excluding imports and monkey-patching)
2022-09-21 16:42:47 INFO  Starting execution of 1 what-if analyses...
2022-09-21 16:42:47 INFO  Start plan generation for analysis DataCleaning...
2022-09-21 16:42:47 INFO  ---RUNTIME: Plan generation took 0.8492469787597656 ms
2022-09-21 16:42:47 INFO  Estimated runtime of original DAG is 2135.8911991119385ms
2022-09-21 16:42:47 WARNING Skipping Multi-Query Optimization (instead, only applying patches)
2022-09-21 16:42:47 WARNING Columns ['full_name'] not present in train DAG after the train test split, only before!
2022-09-21 16:42:47 WARNING This could hint at data leakage!
2022-09-21 16:42:47 INFO  Estimated unoptimised what-if runtime is 55403.85985374451ms
2022-09-21 16:42:47 INFO  ---RUNTIME: Multi-Query Optimization took 29.284238815307617 ms
2022-09-21 16:42:47 INFO  Executing generated plans
2022-09-21 16:43:51 INFO  ---RUNTIME: Execution took 63665.260791778564 ms
2022-09-21 16:43:51 INFO  Done!
2022-09-21 16:43:51 INFO  # Finished -- repetition 5 of 7 
2022-09-21 16:43:51 INFO  # Optimization benchmark for data_cleaning with args [['healthcare', 'slow_loading', 'featurization_4', 'neural_network']] -- repetition 6 of 7
2022-09-21 16:43:51 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-21 16:43:51 INFO  Running instrumented original pipeline...
2022-09-21 16:43:51 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-21 16:43:51 INFO  ---RUNTIME: Importing and monkey-patching took 5.9452056884765625 ms
2022-09-21 16:43:53 INFO  ---RUNTIME: Original pipeline execution took 2442.810297012329 ms (excluding imports and monkey-patching)
2022-09-21 16:43:53 INFO  Starting execution of 1 what-if analyses...
2022-09-21 16:43:53 INFO  Start plan generation for analysis DataCleaning...
2022-09-21 16:43:53 INFO  ---RUNTIME: Plan generation took 2.5644302368164062 ms
2022-09-21 16:43:53 INFO  Estimated runtime of original DAG is 2167.3285961151123ms
2022-09-21 16:43:53 INFO  Performing Multi-Query Optimization
2022-09-21 16:43:54 INFO  Estimated unoptimized what-if runtime is 56166.51892662048ms
2022-09-21 16:43:54 INFO  Estimated optimised what-if runtime is 13460.06441116333ms
2022-09-21 16:43:54 INFO  Estimated optimisation runtime saving is 42706.45451545715ms
2022-09-21 16:43:54 INFO  ---RUNTIME: Multi-Query Optimization took 142.36044883728027 ms
2022-09-21 16:43:54 INFO  Executing generated plans
2022-09-21 16:44:14 INFO  ---RUNTIME: Execution took 20674.365997314453 ms
2022-09-21 16:44:14 INFO  Done!
2022-09-21 16:44:14 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-21 16:44:14 INFO  Running instrumented original pipeline...
2022-09-21 16:44:14 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-21 16:44:14 INFO  ---RUNTIME: Importing and monkey-patching took 6.289243698120117 ms
2022-09-21 16:44:17 INFO  ---RUNTIME: Original pipeline execution took 2508.8250637054443 ms (excluding imports and monkey-patching)
2022-09-21 16:44:17 INFO  Starting execution of 1 what-if analyses...
2022-09-21 16:44:17 INFO  Start plan generation for analysis DataCleaning...
2022-09-21 16:44:17 INFO  ---RUNTIME: Plan generation took 0.9481906890869141 ms
2022-09-21 16:44:17 INFO  Estimated runtime of original DAG is 2225.5074977874756ms
2022-09-21 16:44:17 WARNING Skipping Multi-Query Optimization (instead, only applying patches)
2022-09-21 16:44:17 WARNING Columns ['full_name'] not present in train DAG after the train test split, only before!
2022-09-21 16:44:17 WARNING This could hint at data leakage!
2022-09-21 16:44:17 INFO  Estimated unoptimised what-if runtime is 57710.514307022095ms
2022-09-21 16:44:17 INFO  ---RUNTIME: Multi-Query Optimization took 34.74259376525879 ms
2022-09-21 16:44:17 INFO  Executing generated plans
2022-09-21 16:45:22 INFO  ---RUNTIME: Execution took 65350.83198547363 ms
2022-09-21 16:45:22 INFO  Done!
2022-09-21 16:45:22 INFO  # Finished -- repetition 6 of 7 
2022-09-21 16:45:22 INFO  # Optimization benchmark for data_cleaning with args [['healthcare', 'slow_loading', 'featurization_4', 'neural_network']] -- repetition 7 of 7
2022-09-21 16:45:22 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-21 16:45:22 INFO  Running instrumented original pipeline...
2022-09-21 16:45:22 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-21 16:45:22 INFO  ---RUNTIME: Importing and monkey-patching took 6.513118743896484 ms
2022-09-21 16:45:25 INFO  ---RUNTIME: Original pipeline execution took 2571.784734725952 ms (excluding imports and monkey-patching)
2022-09-21 16:45:25 INFO  Starting execution of 1 what-if analyses...
2022-09-21 16:45:25 INFO  Start plan generation for analysis DataCleaning...
2022-09-21 16:45:25 INFO  ---RUNTIME: Plan generation took 0.9734630584716797 ms
2022-09-21 16:45:25 INFO  Estimated runtime of original DAG is 2276.186943054199ms
2022-09-21 16:45:25 INFO  Performing Multi-Query Optimization
2022-09-21 16:45:25 INFO  Estimated unoptimized what-if runtime is 59088.26923370361ms
2022-09-21 16:45:25 INFO  Estimated optimised what-if runtime is 14741.13130569458ms
2022-09-21 16:45:25 INFO  Estimated optimisation runtime saving is 44347.13792800903ms
2022-09-21 16:45:25 INFO  ---RUNTIME: Multi-Query Optimization took 166.05639457702637 ms
2022-09-21 16:45:25 INFO  Executing generated plans
2022-09-21 16:45:45 INFO  ---RUNTIME: Execution took 20596.32420539856 ms
2022-09-21 16:45:45 INFO  Done!
2022-09-21 16:45:45 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-21 16:45:45 INFO  Running instrumented original pipeline...
2022-09-21 16:45:46 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-21 16:45:46 INFO  ---RUNTIME: Importing and monkey-patching took 5.902767181396484 ms
2022-09-21 16:45:49 INFO  ---RUNTIME: Original pipeline execution took 3179.1648864746094 ms (excluding imports and monkey-patching)
2022-09-21 16:45:49 INFO  Starting execution of 1 what-if analyses...
2022-09-21 16:45:49 INFO  Start plan generation for analysis DataCleaning...
2022-09-21 16:45:49 INFO  ---RUNTIME: Plan generation took 0.8237361907958984 ms
2022-09-21 16:45:49 INFO  Estimated runtime of original DAG is 2903.2485485076904ms
2022-09-21 16:45:49 WARNING Skipping Multi-Query Optimization (instead, only applying patches)
2022-09-21 16:45:49 WARNING Columns ['full_name'] not present in train DAG after the train test split, only before!
2022-09-21 16:45:49 WARNING This could hint at data leakage!
2022-09-21 16:45:49 INFO  Estimated unoptimised what-if runtime is 74630.60450553894ms
2022-09-21 16:45:49 INFO  ---RUNTIME: Multi-Query Optimization took 29.37150001525879 ms
2022-09-21 16:45:49 INFO  Executing generated plans
2022-09-21 16:46:52 INFO  ---RUNTIME: Execution took 63593.49608421326 ms
2022-09-21 16:46:52 INFO  Done!
2022-09-21 16:46:52 INFO  # Finished -- repetition 7 of 7 
2022-09-21 16:46:52 INFO  # Final results after all repetitions
2022-09-21 16:46:52 INFO     repetition  ... no_opt_what_if_execution_combined_model_training
0           0  ...                                     16921.807051
1           1  ...                                     16660.904169
2           2  ...                                     15586.069107
3           3  ...                                     16317.386627
4           4  ...                                     16412.270308
5           5  ...                                     17300.479412
6           6  ...                                     16237.921715

[7 rows x 26 columns]
taskset -c 128-135 PROTOCOL_BUFFERS_PYTHON_IMPLEMENTATION=python python3.9 benchmarks_end_to_end.py operator_impact healthcare slow_loading featurization_0 logistic_regression
2022-09-21 16:46:55.282723: W tensorflow/stream_executor/platform/default/dso_loader.cc:64] Could not load dynamic library 'libcudart.so.11.0'; dlerror: libcudart.so.11.0: cannot open shared object file: No such file or directory; LD_LIBRARY_PATH: /home/sgrafbe/mlwhatif/venv/lib/python3.9/site-packages/cv2/../../lib64:
2022-09-21 16:46:55.282768: I tensorflow/stream_executor/cuda/cudart_stub.cc:29] Ignore above cudart dlerror if you do not have a GPU set up on your machine.
2022-09-21 16:46:56 INFO  Patching sys.argv with ['mlwhatif', 'healthcare', 'slow_loading', 'featurization_0', 'logistic_regression']
2022-09-21 16:46:56 INFO  Running instrumented original pipeline...
2022-09-21 16:46:56 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-21 16:46:56 INFO  ---RUNTIME: Importing and monkey-patching took 94.61545944213867 ms
2022-09-21 16:46:58 INFO  ---RUNTIME: Original pipeline execution took 2050.6904125213623 ms (excluding imports and monkey-patching)
2022-09-21 16:46:58 INFO  Starting execution of 0 what-if analyses...
2022-09-21 16:46:58 INFO  Estimated runtime of original DAG is 1800.7194995880127ms
2022-09-21 16:46:58 INFO  Performing Multi-Query Optimization
2022-09-21 16:46:58 INFO  Estimated unoptimized what-if runtime is 0ms
2022-09-21 16:46:58 INFO  Estimated optimised what-if runtime is 0ms
2022-09-21 16:46:58 INFO  Estimated optimisation runtime saving is 0ms
2022-09-21 16:46:58 INFO  ---RUNTIME: Multi-Query Optimization took 0.4284381866455078 ms
2022-09-21 16:46:58 INFO  Executing generated plans
2022-09-21 16:46:58 INFO  ---RUNTIME: Execution took 0.02193450927734375 ms
2022-09-21 16:46:58 INFO  Done!
2022-09-21 16:46:58 INFO  # Optimization benchmark for operator_impact with args [['healthcare', 'slow_loading', 'featurization_0', 'logistic_regression']] -- repetition 1 of 7
2022-09-21 16:46:58 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-21 16:46:58 INFO  Running instrumented original pipeline...
2022-09-21 16:46:58 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-21 16:46:58 INFO  ---RUNTIME: Importing and monkey-patching took 5.165338516235352 ms
2022-09-21 16:47:00 INFO  ---RUNTIME: Original pipeline execution took 1958.6601257324219 ms (excluding imports and monkey-patching)
2022-09-21 16:47:00 INFO  Starting execution of 1 what-if analyses...
2022-09-21 16:47:00 INFO  Start plan generation for analysis OperatorImpact...
2022-09-21 16:47:00 INFO  ---RUNTIME: Plan generation took 4.561424255371094 ms
2022-09-21 16:47:00 INFO  Estimated runtime of original DAG is 1738.3513450622559ms
2022-09-21 16:47:00 INFO  Performing Multi-Query Optimization
2022-09-21 16:47:00 INFO  Estimated unoptimized what-if runtime is 3497.7372161273297ms
2022-09-21 16:47:00 INFO  Estimated optimised what-if runtime is 1770.203160417491ms
2022-09-21 16:47:00 INFO  Estimated optimisation runtime saving is 1727.5340557098386ms
2022-09-21 16:47:00 INFO  ---RUNTIME: Multi-Query Optimization took 12.29095458984375 ms
2022-09-21 16:47:00 INFO  Executing generated plans
2022-09-21 16:47:02 INFO  ---RUNTIME: Execution took 1805.3820133209229 ms
2022-09-21 16:47:02 INFO  Done!
2022-09-21 16:47:02 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-21 16:47:02 INFO  Running instrumented original pipeline...
2022-09-21 16:47:02 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-21 16:47:02 INFO  ---RUNTIME: Importing and monkey-patching took 5.795001983642578 ms
2022-09-21 16:47:04 INFO  ---RUNTIME: Original pipeline execution took 2106.226921081543 ms (excluding imports and monkey-patching)
2022-09-21 16:47:04 INFO  Starting execution of 1 what-if analyses...
2022-09-21 16:47:04 INFO  Start plan generation for analysis OperatorImpact...
2022-09-21 16:47:04 INFO  ---RUNTIME: Plan generation took 4.029750823974609 ms
2022-09-21 16:47:04 INFO  Estimated runtime of original DAG is 1729.029655456543ms
2022-09-21 16:47:04 WARNING Skipping Multi-Query Optimization (instead, only applying patches)
2022-09-21 16:47:04 INFO  Estimated unoptimised what-if runtime is 3478.90401790882ms
2022-09-21 16:47:04 INFO  ---RUNTIME: Multi-Query Optimization took 6.524562835693359 ms
2022-09-21 16:47:04 INFO  Executing generated plans
2022-09-21 16:47:08 INFO  ---RUNTIME: Execution took 3471.956729888916 ms
2022-09-21 16:47:08 INFO  Done!
2022-09-21 16:47:08 INFO  # Finished -- repetition 1 of 7 
2022-09-21 16:47:08 INFO  # Optimization benchmark for operator_impact with args [['healthcare', 'slow_loading', 'featurization_0', 'logistic_regression']] -- repetition 2 of 7
2022-09-21 16:47:08 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-21 16:47:08 INFO  Running instrumented original pipeline...
2022-09-21 16:47:08 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-21 16:47:08 INFO  ---RUNTIME: Importing and monkey-patching took 5.882501602172852 ms
2022-09-21 16:47:09 INFO  ---RUNTIME: Original pipeline execution took 1939.3792152404785 ms (excluding imports and monkey-patching)
2022-09-21 16:47:09 INFO  Starting execution of 1 what-if analyses...
2022-09-21 16:47:09 INFO  Start plan generation for analysis OperatorImpact...
2022-09-21 16:47:09 INFO  ---RUNTIME: Plan generation took 4.143953323364258 ms
2022-09-21 16:47:09 INFO  Estimated runtime of original DAG is 1718.233585357666ms
2022-09-21 16:47:09 INFO  Performing Multi-Query Optimization
2022-09-21 16:47:09 INFO  Estimated unoptimized what-if runtime is 3458.018172198329ms
2022-09-21 16:47:09 INFO  Estimated optimised what-if runtime is 1750.8615140257216ms
2022-09-21 16:47:09 INFO  Estimated optimisation runtime saving is 1707.1566581726074ms
2022-09-21 16:47:09 INFO  ---RUNTIME: Multi-Query Optimization took 12.433528900146484 ms
2022-09-21 16:47:09 INFO  Executing generated plans
2022-09-21 16:47:11 INFO  ---RUNTIME: Execution took 1764.2908096313477 ms
2022-09-21 16:47:11 INFO  Done!
2022-09-21 16:47:11 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-21 16:47:11 INFO  Running instrumented original pipeline...
2022-09-21 16:47:11 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-21 16:47:11 INFO  ---RUNTIME: Importing and monkey-patching took 6.0825347900390625 ms
2022-09-21 16:47:13 INFO  ---RUNTIME: Original pipeline execution took 1950.7479667663574 ms (excluding imports and monkey-patching)
2022-09-21 16:47:13 INFO  Starting execution of 1 what-if analyses...
2022-09-21 16:47:13 INFO  Start plan generation for analysis OperatorImpact...
2022-09-21 16:47:13 INFO  ---RUNTIME: Plan generation took 4.1828155517578125 ms
2022-09-21 16:47:13 INFO  Estimated runtime of original DAG is 1725.961446762085ms
2022-09-21 16:47:13 WARNING Skipping Multi-Query Optimization (instead, only applying patches)
2022-09-21 16:47:13 INFO  Estimated unoptimised what-if runtime is 3473.4229531781425ms
2022-09-21 16:47:13 INFO  ---RUNTIME: Multi-Query Optimization took 6.552934646606445 ms
2022-09-21 16:47:13 INFO  Executing generated plans
2022-09-21 16:47:17 INFO  ---RUNTIME: Execution took 3486.9987964630127 ms
2022-09-21 16:47:17 INFO  Done!
2022-09-21 16:47:17 INFO  # Finished -- repetition 2 of 7 
2022-09-21 16:47:17 INFO  # Optimization benchmark for operator_impact with args [['healthcare', 'slow_loading', 'featurization_0', 'logistic_regression']] -- repetition 3 of 7
2022-09-21 16:47:17 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-21 16:47:17 INFO  Running instrumented original pipeline...
2022-09-21 16:47:17 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-21 16:47:17 INFO  ---RUNTIME: Importing and monkey-patching took 5.593776702880859 ms
2022-09-21 16:47:19 INFO  ---RUNTIME: Original pipeline execution took 1954.6153545379639 ms (excluding imports and monkey-patching)
2022-09-21 16:47:19 INFO  Starting execution of 1 what-if analyses...
2022-09-21 16:47:19 INFO  Start plan generation for analysis OperatorImpact...
2022-09-21 16:47:19 INFO  ---RUNTIME: Plan generation took 3.9865970611572266 ms
2022-09-21 16:47:19 INFO  Estimated runtime of original DAG is 1735.0413799285889ms
2022-09-21 16:47:19 INFO  Performing Multi-Query Optimization
2022-09-21 16:47:19 INFO  Estimated unoptimized what-if runtime is 3490.658459170111ms
2022-09-21 16:47:19 INFO  Estimated optimised what-if runtime is 1766.2166924312194ms
2022-09-21 16:47:19 INFO  Estimated optimisation runtime saving is 1724.4417667388918ms
2022-09-21 16:47:19 INFO  ---RUNTIME: Multi-Query Optimization took 12.26806640625 ms
2022-09-21 16:47:19 INFO  Executing generated plans
2022-09-21 16:47:20 INFO  ---RUNTIME: Execution took 1762.2039318084717 ms
2022-09-21 16:47:20 INFO  Done!
2022-09-21 16:47:20 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-21 16:47:20 INFO  Running instrumented original pipeline...
2022-09-21 16:47:20 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-21 16:47:21 INFO  ---RUNTIME: Importing and monkey-patching took 5.8765411376953125 ms
2022-09-21 16:47:22 INFO  ---RUNTIME: Original pipeline execution took 1948.9009380340576 ms (excluding imports and monkey-patching)
2022-09-21 16:47:22 INFO  Starting execution of 1 what-if analyses...
2022-09-21 16:47:22 INFO  Start plan generation for analysis OperatorImpact...
2022-09-21 16:47:22 INFO  ---RUNTIME: Plan generation took 4.1790008544921875 ms
2022-09-21 16:47:22 INFO  Estimated runtime of original DAG is 1729.0985584259033ms
2022-09-21 16:47:22 WARNING Skipping Multi-Query Optimization (instead, only applying patches)
2022-09-21 16:47:22 INFO  Estimated unoptimised what-if runtime is 3478.8093468238567ms
2022-09-21 16:47:22 INFO  ---RUNTIME: Multi-Query Optimization took 6.515979766845703 ms
2022-09-21 16:47:22 INFO  Executing generated plans
2022-09-21 16:47:26 INFO  ---RUNTIME: Execution took 3520.7760334014893 ms
2022-09-21 16:47:26 INFO  Done!
2022-09-21 16:47:26 INFO  # Finished -- repetition 3 of 7 
2022-09-21 16:47:26 INFO  # Optimization benchmark for operator_impact with args [['healthcare', 'slow_loading', 'featurization_0', 'logistic_regression']] -- repetition 4 of 7
2022-09-21 16:47:26 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-21 16:47:26 INFO  Running instrumented original pipeline...
2022-09-21 16:47:26 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-21 16:47:26 INFO  ---RUNTIME: Importing and monkey-patching took 5.658149719238281 ms
2022-09-21 16:47:28 INFO  ---RUNTIME: Original pipeline execution took 1973.2191562652588 ms (excluding imports and monkey-patching)
2022-09-21 16:47:28 INFO  Starting execution of 1 what-if analyses...
2022-09-21 16:47:28 INFO  Start plan generation for analysis OperatorImpact...
2022-09-21 16:47:28 INFO  ---RUNTIME: Plan generation took 4.038333892822266 ms
2022-09-21 16:47:28 INFO  Estimated runtime of original DAG is 1754.091501235962ms
2022-09-21 16:47:28 INFO  Performing Multi-Query Optimization
2022-09-21 16:47:28 INFO  Estimated unoptimized what-if runtime is 3528.843121693051ms
2022-09-21 16:47:28 INFO  Estimated optimised what-if runtime is 1785.391764805234ms
2022-09-21 16:47:28 INFO  Estimated optimisation runtime saving is 1743.4513568878172ms
2022-09-21 16:47:28 INFO  ---RUNTIME: Multi-Query Optimization took 12.031078338623047 ms
2022-09-21 16:47:28 INFO  Executing generated plans
2022-09-21 16:47:30 INFO  ---RUNTIME: Execution took 1764.939546585083 ms
2022-09-21 16:47:30 INFO  Done!
2022-09-21 16:47:30 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-21 16:47:30 INFO  Running instrumented original pipeline...
2022-09-21 16:47:30 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-21 16:47:30 INFO  ---RUNTIME: Importing and monkey-patching took 5.785942077636719 ms
2022-09-21 16:47:32 INFO  ---RUNTIME: Original pipeline execution took 2115.9934997558594 ms (excluding imports and monkey-patching)
2022-09-21 16:47:32 INFO  Starting execution of 1 what-if analyses...
2022-09-21 16:47:32 INFO  Start plan generation for analysis OperatorImpact...
2022-09-21 16:47:32 INFO  ---RUNTIME: Plan generation took 4.024744033813477 ms
2022-09-21 16:47:32 INFO  Estimated runtime of original DAG is 1714.1566276550293ms
2022-09-21 16:47:32 WARNING Skipping Multi-Query Optimization (instead, only applying patches)
2022-09-21 16:47:32 INFO  Estimated unoptimised what-if runtime is 3448.755047239106ms
2022-09-21 16:47:32 INFO  ---RUNTIME: Multi-Query Optimization took 6.462812423706055 ms
2022-09-21 16:47:32 INFO  Executing generated plans
2022-09-21 16:47:35 INFO  ---RUNTIME: Execution took 3485.448122024536 ms
2022-09-21 16:47:35 INFO  Done!
2022-09-21 16:47:35 INFO  # Finished -- repetition 4 of 7 
2022-09-21 16:47:35 INFO  # Optimization benchmark for operator_impact with args [['healthcare', 'slow_loading', 'featurization_0', 'logistic_regression']] -- repetition 5 of 7
2022-09-21 16:47:35 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-21 16:47:35 INFO  Running instrumented original pipeline...
2022-09-21 16:47:35 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-21 16:47:35 INFO  ---RUNTIME: Importing and monkey-patching took 6.621837615966797 ms
2022-09-21 16:47:37 INFO  ---RUNTIME: Original pipeline execution took 1952.9080390930176 ms (excluding imports and monkey-patching)
2022-09-21 16:47:37 INFO  Starting execution of 1 what-if analyses...
2022-09-21 16:47:37 INFO  Start plan generation for analysis OperatorImpact...
2022-09-21 16:47:37 INFO  ---RUNTIME: Plan generation took 4.133939743041992 ms
2022-09-21 16:47:37 INFO  Estimated runtime of original DAG is 1730.8502197265625ms
2022-09-21 16:47:37 INFO  Performing Multi-Query Optimization
2022-09-21 16:47:37 INFO  Estimated unoptimized what-if runtime is 3482.360699259001ms
2022-09-21 16:47:37 INFO  Estimated optimised what-if runtime is 1762.1458555090014ms
2022-09-21 16:47:37 INFO  Estimated optimisation runtime saving is 1720.2148437499998ms
2022-09-21 16:47:37 INFO  ---RUNTIME: Multi-Query Optimization took 12.09259033203125 ms
2022-09-21 16:47:37 INFO  Executing generated plans
2022-09-21 16:47:39 INFO  ---RUNTIME: Execution took 1785.841703414917 ms
2022-09-21 16:47:39 INFO  Done!
2022-09-21 16:47:39 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-21 16:47:39 INFO  Running instrumented original pipeline...
2022-09-21 16:47:39 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-21 16:47:39 INFO  ---RUNTIME: Importing and monkey-patching took 5.501747131347656 ms
2022-09-21 16:47:41 INFO  ---RUNTIME: Original pipeline execution took 1940.201759338379 ms (excluding imports and monkey-patching)
2022-09-21 16:47:41 INFO  Starting execution of 1 what-if analyses...
2022-09-21 16:47:41 INFO  Start plan generation for analysis OperatorImpact...
2022-09-21 16:47:41 INFO  ---RUNTIME: Plan generation took 4.04810905456543 ms
2022-09-21 16:47:41 INFO  Estimated runtime of original DAG is 1719.282627105713ms
2022-09-21 16:47:41 WARNING Skipping Multi-Query Optimization (instead, only applying patches)
2022-09-21 16:47:41 INFO  Estimated unoptimised what-if runtime is 3459.4582426136935ms
2022-09-21 16:47:41 INFO  ---RUNTIME: Multi-Query Optimization took 6.43610954284668 ms
2022-09-21 16:47:41 INFO  Executing generated plans
2022-09-21 16:47:45 INFO  ---RUNTIME: Execution took 3511.950731277466 ms
2022-09-21 16:47:45 INFO  Done!
2022-09-21 16:47:45 INFO  # Finished -- repetition 5 of 7 
2022-09-21 16:47:45 INFO  # Optimization benchmark for operator_impact with args [['healthcare', 'slow_loading', 'featurization_0', 'logistic_regression']] -- repetition 6 of 7
2022-09-21 16:47:45 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-21 16:47:45 INFO  Running instrumented original pipeline...
2022-09-21 16:47:45 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-21 16:47:45 INFO  ---RUNTIME: Importing and monkey-patching took 5.45191764831543 ms
2022-09-21 16:47:47 INFO  ---RUNTIME: Original pipeline execution took 1959.32936668396 ms (excluding imports and monkey-patching)
2022-09-21 16:47:47 INFO  Starting execution of 1 what-if analyses...
2022-09-21 16:47:47 INFO  Start plan generation for analysis OperatorImpact...
2022-09-21 16:47:47 INFO  ---RUNTIME: Plan generation took 3.9882659912109375 ms
2022-09-21 16:47:47 INFO  Estimated runtime of original DAG is 1741.9862747192383ms
2022-09-21 16:47:47 INFO  Performing Multi-Query Optimization
2022-09-21 16:47:47 INFO  Estimated unoptimized what-if runtime is 3504.2845282061344ms
2022-09-21 16:47:47 INFO  Estimated optimised what-if runtime is 1772.7610144121893ms
2022-09-21 16:47:47 INFO  Estimated optimisation runtime saving is 1731.523513793945ms
2022-09-21 16:47:47 INFO  ---RUNTIME: Multi-Query Optimization took 12.174606323242188 ms
2022-09-21 16:47:47 INFO  Executing generated plans
2022-09-21 16:47:48 INFO  ---RUNTIME: Execution took 1777.1847248077393 ms
2022-09-21 16:47:48 INFO  Done!
2022-09-21 16:47:48 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-21 16:47:48 INFO  Running instrumented original pipeline...
2022-09-21 16:47:48 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-21 16:47:48 INFO  ---RUNTIME: Importing and monkey-patching took 5.608558654785156 ms
2022-09-21 16:47:50 INFO  ---RUNTIME: Original pipeline execution took 1941.997766494751 ms (excluding imports and monkey-patching)
2022-09-21 16:47:50 INFO  Starting execution of 1 what-if analyses...
2022-09-21 16:47:50 INFO  Start plan generation for analysis OperatorImpact...
2022-09-21 16:47:50 INFO  ---RUNTIME: Plan generation took 4.221916198730469 ms
2022-09-21 16:47:50 INFO  Estimated runtime of original DAG is 1721.247673034668ms
2022-09-21 16:47:50 WARNING Skipping Multi-Query Optimization (instead, only applying patches)
2022-09-21 16:47:50 INFO  Estimated unoptimised what-if runtime is 3463.6776340418846ms
2022-09-21 16:47:50 INFO  ---RUNTIME: Multi-Query Optimization took 6.614923477172852 ms
2022-09-21 16:47:50 INFO  Executing generated plans
2022-09-21 16:47:54 INFO  ---RUNTIME: Execution took 3485.7985973358154 ms
2022-09-21 16:47:54 INFO  Done!
2022-09-21 16:47:54 INFO  # Finished -- repetition 6 of 7 
2022-09-21 16:47:54 INFO  # Optimization benchmark for operator_impact with args [['healthcare', 'slow_loading', 'featurization_0', 'logistic_regression']] -- repetition 7 of 7
2022-09-21 16:47:54 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-21 16:47:54 INFO  Running instrumented original pipeline...
2022-09-21 16:47:54 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-21 16:47:54 INFO  ---RUNTIME: Importing and monkey-patching took 5.587339401245117 ms
2022-09-21 16:47:56 INFO  ---RUNTIME: Original pipeline execution took 1936.410665512085 ms (excluding imports and monkey-patching)
2022-09-21 16:47:56 INFO  Starting execution of 1 what-if analyses...
2022-09-21 16:47:56 INFO  Start plan generation for analysis OperatorImpact...
2022-09-21 16:47:56 INFO  ---RUNTIME: Plan generation took 4.029273986816406 ms
2022-09-21 16:47:56 INFO  Estimated runtime of original DAG is 1718.5475826263428ms
2022-09-21 16:47:56 INFO  Performing Multi-Query Optimization
2022-09-21 16:47:56 INFO  Estimated unoptimized what-if runtime is 3457.678549865197ms
2022-09-21 16:47:56 INFO  Estimated optimised what-if runtime is 1749.7262888941275ms
2022-09-21 16:47:56 INFO  Estimated optimisation runtime saving is 1707.9522609710696ms
2022-09-21 16:47:56 INFO  ---RUNTIME: Multi-Query Optimization took 11.997222900390625 ms
2022-09-21 16:47:56 INFO  Executing generated plans
2022-09-21 16:47:58 INFO  ---RUNTIME: Execution took 1774.8310565948486 ms
2022-09-21 16:47:58 INFO  Done!
2022-09-21 16:47:58 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-21 16:47:58 INFO  Running instrumented original pipeline...
2022-09-21 16:47:58 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-21 16:47:58 INFO  ---RUNTIME: Importing and monkey-patching took 5.535125732421875 ms
2022-09-21 16:47:59 INFO  ---RUNTIME: Original pipeline execution took 1951.505422592163 ms (excluding imports and monkey-patching)
2022-09-21 16:47:59 INFO  Starting execution of 1 what-if analyses...
2022-09-21 16:47:59 INFO  Start plan generation for analysis OperatorImpact...
2022-09-21 16:47:59 INFO  ---RUNTIME: Plan generation took 4.411220550537109 ms
2022-09-21 16:47:59 INFO  Estimated runtime of original DAG is 1729.5989990234375ms
2022-09-21 16:47:59 WARNING Skipping Multi-Query Optimization (instead, only applying patches)
2022-09-21 16:47:59 INFO  Estimated unoptimised what-if runtime is 3479.9023603570877ms
2022-09-21 16:47:59 INFO  ---RUNTIME: Multi-Query Optimization took 6.622552871704102 ms
2022-09-21 16:47:59 INFO  Executing generated plans
2022-09-21 16:48:03 INFO  ---RUNTIME: Execution took 3760.300397872925 ms
2022-09-21 16:48:03 INFO  Done!
2022-09-21 16:48:03 INFO  # Finished -- repetition 7 of 7 
2022-09-21 16:48:03 INFO  # Final results after all repetitions
2022-09-21 16:48:03 INFO     repetition  ... no_opt_what_if_execution_combined_model_training
0           0  ...                                         2.998114
1           1  ...                                         2.925158
2           2  ...                                         2.903223
3           3  ...                                         2.995729
4           4  ...                                         2.892494
5           5  ...                                         2.919912
6           6  ...                                         2.941847

[7 rows x 26 columns]
taskset -c 128-135 PROTOCOL_BUFFERS_PYTHON_IMPLEMENTATION=python python3.9 benchmarks_end_to_end.py operator_impact healthcare slow_loading featurization_0 xgboost
2022-09-21 16:48:05.724462: W tensorflow/stream_executor/platform/default/dso_loader.cc:64] Could not load dynamic library 'libcudart.so.11.0'; dlerror: libcudart.so.11.0: cannot open shared object file: No such file or directory; LD_LIBRARY_PATH: /home/sgrafbe/mlwhatif/venv/lib/python3.9/site-packages/cv2/../../lib64:
2022-09-21 16:48:05.724507: I tensorflow/stream_executor/cuda/cudart_stub.cc:29] Ignore above cudart dlerror if you do not have a GPU set up on your machine.
2022-09-21 16:48:06 INFO  Patching sys.argv with ['mlwhatif', 'healthcare', 'slow_loading', 'featurization_0', 'xgboost']
2022-09-21 16:48:06 INFO  Running instrumented original pipeline...
2022-09-21 16:48:06 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-21 16:48:07 INFO  ---RUNTIME: Importing and monkey-patching took 102.85592079162598 ms
2022-09-21 16:48:10 INFO  ---RUNTIME: Original pipeline execution took 3141.8991088867188 ms (excluding imports and monkey-patching)
2022-09-21 16:48:10 INFO  Starting execution of 0 what-if analyses...
2022-09-21 16:48:10 INFO  Estimated runtime of original DAG is 2886.754274368286ms
2022-09-21 16:48:10 INFO  Performing Multi-Query Optimization
2022-09-21 16:48:10 INFO  Estimated unoptimized what-if runtime is 0ms
2022-09-21 16:48:10 INFO  Estimated optimised what-if runtime is 0ms
2022-09-21 16:48:10 INFO  Estimated optimisation runtime saving is 0ms
2022-09-21 16:48:10 INFO  ---RUNTIME: Multi-Query Optimization took 0.4329681396484375 ms
2022-09-21 16:48:10 INFO  Executing generated plans
2022-09-21 16:48:10 INFO  ---RUNTIME: Execution took 0.019788742065429688 ms
2022-09-21 16:48:10 INFO  Done!
2022-09-21 16:48:10 INFO  # Optimization benchmark for operator_impact with args [['healthcare', 'slow_loading', 'featurization_0', 'xgboost']] -- repetition 1 of 7
2022-09-21 16:48:10 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-21 16:48:10 INFO  Running instrumented original pipeline...
2022-09-21 16:48:10 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-21 16:48:10 INFO  ---RUNTIME: Importing and monkey-patching took 5.082368850708008 ms
2022-09-21 16:48:12 INFO  ---RUNTIME: Original pipeline execution took 2172.452688217163 ms (excluding imports and monkey-patching)
2022-09-21 16:48:12 INFO  Starting execution of 1 what-if analyses...
2022-09-21 16:48:12 INFO  Start plan generation for analysis OperatorImpact...
2022-09-21 16:48:12 INFO  ---RUNTIME: Plan generation took 4.870891571044922 ms
2022-09-21 16:48:12 INFO  Estimated runtime of original DAG is 1949.9499797821045ms
2022-09-21 16:48:12 INFO  Performing Multi-Query Optimization
2022-09-21 16:48:12 INFO  Estimated unoptimized what-if runtime is 4302.042337121635ms
2022-09-21 16:48:12 INFO  Estimated optimised what-if runtime is 2548.1024701019815ms
2022-09-21 16:48:12 INFO  Estimated optimisation runtime saving is 1753.9398670196533ms
2022-09-21 16:48:12 INFO  ---RUNTIME: Multi-Query Optimization took 12.173175811767578 ms
2022-09-21 16:48:12 INFO  Executing generated plans
2022-09-21 16:48:14 INFO  ---RUNTIME: Execution took 2141.720771789551 ms
2022-09-21 16:48:14 INFO  Done!
2022-09-21 16:48:14 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-21 16:48:14 INFO  Running instrumented original pipeline...
2022-09-21 16:48:14 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-21 16:48:14 INFO  ---RUNTIME: Importing and monkey-patching took 5.752325057983398 ms
2022-09-21 16:48:16 INFO  ---RUNTIME: Original pipeline execution took 2309.245824813843 ms (excluding imports and monkey-patching)
2022-09-21 16:48:16 INFO  Starting execution of 1 what-if analyses...
2022-09-21 16:48:16 INFO  Start plan generation for analysis OperatorImpact...
2022-09-21 16:48:16 INFO  ---RUNTIME: Plan generation took 4.070520401000977 ms
2022-09-21 16:48:16 INFO  Estimated runtime of original DAG is 1927.3951053619385ms
2022-09-21 16:48:16 WARNING Skipping Multi-Query Optimization (instead, only applying patches)
2022-09-21 16:48:16 INFO  Estimated unoptimised what-if runtime is 4253.598185243278ms
2022-09-21 16:48:16 INFO  ---RUNTIME: Multi-Query Optimization took 6.566047668457031 ms
2022-09-21 16:48:16 INFO  Executing generated plans
2022-09-21 16:48:20 INFO  ---RUNTIME: Execution took 3874.269723892212 ms
2022-09-21 16:48:20 INFO  Done!
2022-09-21 16:48:20 INFO  # Finished -- repetition 1 of 7 
2022-09-21 16:48:20 INFO  # Optimization benchmark for operator_impact with args [['healthcare', 'slow_loading', 'featurization_0', 'xgboost']] -- repetition 2 of 7
2022-09-21 16:48:20 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-21 16:48:20 INFO  Running instrumented original pipeline...
2022-09-21 16:48:20 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-21 16:48:20 INFO  ---RUNTIME: Importing and monkey-patching took 6.722450256347656 ms
2022-09-21 16:48:22 INFO  ---RUNTIME: Original pipeline execution took 2141.4527893066406 ms (excluding imports and monkey-patching)
2022-09-21 16:48:22 INFO  Starting execution of 1 what-if analyses...
2022-09-21 16:48:22 INFO  Start plan generation for analysis OperatorImpact...
2022-09-21 16:48:22 INFO  ---RUNTIME: Plan generation took 4.16874885559082 ms
2022-09-21 16:48:22 INFO  Estimated runtime of original DAG is 1917.820692062378ms
2022-09-21 16:48:22 INFO  Performing Multi-Query Optimization
2022-09-21 16:48:22 INFO  Estimated unoptimized what-if runtime is 4233.5583933468515ms
2022-09-21 16:48:22 INFO  Estimated optimised what-if runtime is 2509.6609362240492ms
2022-09-21 16:48:22 INFO  Estimated optimisation runtime saving is 1723.8974571228023ms
2022-09-21 16:48:22 INFO  ---RUNTIME: Multi-Query Optimization took 11.990070343017578 ms
2022-09-21 16:48:22 INFO  Executing generated plans
2022-09-21 16:48:25 INFO  ---RUNTIME: Execution took 2144.8636054992676 ms
2022-09-21 16:48:25 INFO  Done!
2022-09-21 16:48:25 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-21 16:48:25 INFO  Running instrumented original pipeline...
2022-09-21 16:48:25 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-21 16:48:25 INFO  ---RUNTIME: Importing and monkey-patching took 6.042718887329102 ms
2022-09-21 16:48:27 INFO  ---RUNTIME: Original pipeline execution took 2180.5014610290527 ms (excluding imports and monkey-patching)
2022-09-21 16:48:27 INFO  Starting execution of 1 what-if analyses...
2022-09-21 16:48:27 INFO  Start plan generation for analysis OperatorImpact...
2022-09-21 16:48:27 INFO  ---RUNTIME: Plan generation took 4.157304763793945 ms
2022-09-21 16:48:27 INFO  Estimated runtime of original DAG is 1957.1897983551025ms
2022-09-21 16:48:27 WARNING Skipping Multi-Query Optimization (instead, only applying patches)
2022-09-21 16:48:27 INFO  Estimated unoptimised what-if runtime is 4312.218818171272ms
2022-09-21 16:48:27 INFO  ---RUNTIME: Multi-Query Optimization took 6.459951400756836 ms
2022-09-21 16:48:27 INFO  Executing generated plans
2022-09-21 16:48:31 INFO  ---RUNTIME: Execution took 3895.564556121826 ms
2022-09-21 16:48:31 INFO  Done!
2022-09-21 16:48:31 INFO  # Finished -- repetition 2 of 7 
2022-09-21 16:48:31 INFO  # Optimization benchmark for operator_impact with args [['healthcare', 'slow_loading', 'featurization_0', 'xgboost']] -- repetition 3 of 7
2022-09-21 16:48:31 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-21 16:48:31 INFO  Running instrumented original pipeline...
2022-09-21 16:48:31 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-21 16:48:31 INFO  ---RUNTIME: Importing and monkey-patching took 5.691051483154297 ms
2022-09-21 16:48:33 INFO  ---RUNTIME: Original pipeline execution took 2178.9703369140625 ms (excluding imports and monkey-patching)
2022-09-21 16:48:33 INFO  Starting execution of 1 what-if analyses...
2022-09-21 16:48:33 INFO  Start plan generation for analysis OperatorImpact...
2022-09-21 16:48:33 INFO  ---RUNTIME: Plan generation took 4.198789596557617 ms
2022-09-21 16:48:33 INFO  Estimated runtime of original DAG is 1956.528663635254ms
2022-09-21 16:48:33 INFO  Performing Multi-Query Optimization
2022-09-21 16:48:33 INFO  Estimated unoptimized what-if runtime is 4314.395978532988ms
2022-09-21 16:48:33 INFO  Estimated optimised what-if runtime is 2553.4587646352834ms
2022-09-21 16:48:33 INFO  Estimated optimisation runtime saving is 1760.9372138977046ms
2022-09-21 16:48:33 INFO  ---RUNTIME: Multi-Query Optimization took 12.293100357055664 ms
2022-09-21 16:48:33 INFO  Executing generated plans
2022-09-21 16:48:35 INFO  ---RUNTIME: Execution took 2148.857355117798 ms
2022-09-21 16:48:35 INFO  Done!
2022-09-21 16:48:35 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-21 16:48:35 INFO  Running instrumented original pipeline...
2022-09-21 16:48:35 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-21 16:48:35 INFO  ---RUNTIME: Importing and monkey-patching took 5.617856979370117 ms
2022-09-21 16:48:37 INFO  ---RUNTIME: Original pipeline execution took 2157.3543548583984 ms (excluding imports and monkey-patching)
2022-09-21 16:48:37 INFO  Starting execution of 1 what-if analyses...
2022-09-21 16:48:37 INFO  Start plan generation for analysis OperatorImpact...
2022-09-21 16:48:37 INFO  ---RUNTIME: Plan generation took 4.145622253417969 ms
2022-09-21 16:48:37 INFO  Estimated runtime of original DAG is 1933.9244365692139ms
2022-09-21 16:48:37 WARNING Skipping Multi-Query Optimization (instead, only applying patches)
2022-09-21 16:48:37 INFO  Estimated unoptimised what-if runtime is 4265.535325839603ms
2022-09-21 16:48:37 INFO  ---RUNTIME: Multi-Query Optimization took 6.508827209472656 ms
2022-09-21 16:48:37 INFO  Executing generated plans
2022-09-21 16:48:41 INFO  ---RUNTIME: Execution took 3890.9709453582764 ms
2022-09-21 16:48:41 INFO  Done!
2022-09-21 16:48:41 INFO  # Finished -- repetition 3 of 7 
2022-09-21 16:48:41 INFO  # Optimization benchmark for operator_impact with args [['healthcare', 'slow_loading', 'featurization_0', 'xgboost']] -- repetition 4 of 7
2022-09-21 16:48:41 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-21 16:48:41 INFO  Running instrumented original pipeline...
2022-09-21 16:48:41 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-21 16:48:41 INFO  ---RUNTIME: Importing and monkey-patching took 5.8841705322265625 ms
2022-09-21 16:48:43 INFO  ---RUNTIME: Original pipeline execution took 2144.3560123443604 ms (excluding imports and monkey-patching)
2022-09-21 16:48:43 INFO  Starting execution of 1 what-if analyses...
2022-09-21 16:48:43 INFO  Start plan generation for analysis OperatorImpact...
2022-09-21 16:48:43 INFO  ---RUNTIME: Plan generation took 4.101991653442383 ms
2022-09-21 16:48:43 INFO  Estimated runtime of original DAG is 1919.0118312835693ms
2022-09-21 16:48:43 INFO  Performing Multi-Query Optimization
2022-09-21 16:48:43 INFO  Estimated unoptimized what-if runtime is 4237.1583848164ms
2022-09-21 16:48:43 INFO  Estimated optimised what-if runtime is 2512.7972035572448ms
2022-09-21 16:48:43 INFO  Estimated optimisation runtime saving is 1724.3611812591553ms
2022-09-21 16:48:43 INFO  ---RUNTIME: Multi-Query Optimization took 12.00103759765625 ms
2022-09-21 16:48:43 INFO  Executing generated plans
2022-09-21 16:48:46 INFO  ---RUNTIME: Execution took 2352.213144302368 ms
2022-09-21 16:48:46 INFO  Done!
2022-09-21 16:48:46 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-21 16:48:46 INFO  Running instrumented original pipeline...
2022-09-21 16:48:46 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-21 16:48:46 INFO  ---RUNTIME: Importing and monkey-patching took 5.659818649291992 ms
2022-09-21 16:48:48 INFO  ---RUNTIME: Original pipeline execution took 2155.86519241333 ms (excluding imports and monkey-patching)
2022-09-21 16:48:48 INFO  Starting execution of 1 what-if analyses...
2022-09-21 16:48:48 INFO  Start plan generation for analysis OperatorImpact...
2022-09-21 16:48:48 INFO  ---RUNTIME: Plan generation took 4.177331924438477 ms
2022-09-21 16:48:48 INFO  Estimated runtime of original DAG is 1932.4147701263428ms
2022-09-21 16:48:48 WARNING Skipping Multi-Query Optimization (instead, only applying patches)
2022-09-21 16:48:48 INFO  Estimated unoptimised what-if runtime is 4260.910261088404ms
2022-09-21 16:48:48 INFO  ---RUNTIME: Multi-Query Optimization took 6.506204605102539 ms
2022-09-21 16:48:48 INFO  Executing generated plans
2022-09-21 16:48:52 INFO  ---RUNTIME: Execution took 3898.9882469177246 ms
2022-09-21 16:48:52 INFO  Done!
2022-09-21 16:48:52 INFO  # Finished -- repetition 4 of 7 
2022-09-21 16:48:52 INFO  # Optimization benchmark for operator_impact with args [['healthcare', 'slow_loading', 'featurization_0', 'xgboost']] -- repetition 5 of 7
2022-09-21 16:48:52 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-21 16:48:52 INFO  Running instrumented original pipeline...
2022-09-21 16:48:52 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-21 16:48:52 INFO  ---RUNTIME: Importing and monkey-patching took 5.767107009887695 ms
2022-09-21 16:48:54 INFO  ---RUNTIME: Original pipeline execution took 2144.437074661255 ms (excluding imports and monkey-patching)
2022-09-21 16:48:54 INFO  Starting execution of 1 what-if analyses...
2022-09-21 16:48:54 INFO  Start plan generation for analysis OperatorImpact...
2022-09-21 16:48:54 INFO  ---RUNTIME: Plan generation took 4.073381423950195 ms
2022-09-21 16:48:54 INFO  Estimated runtime of original DAG is 1921.3964939117432ms
2022-09-21 16:48:54 INFO  Performing Multi-Query Optimization
2022-09-21 16:48:54 INFO  Estimated unoptimized what-if runtime is 4240.628311551851ms
2022-09-21 16:48:54 INFO  Estimated optimised what-if runtime is 2513.117620862764ms
2022-09-21 16:48:54 INFO  Estimated optimisation runtime saving is 1727.510690689087ms
2022-09-21 16:48:54 INFO  ---RUNTIME: Multi-Query Optimization took 11.970043182373047 ms
2022-09-21 16:48:54 INFO  Executing generated plans
2022-09-21 16:48:56 INFO  ---RUNTIME: Execution took 2154.789924621582 ms
2022-09-21 16:48:56 INFO  Done!
2022-09-21 16:48:56 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-21 16:48:56 INFO  Running instrumented original pipeline...
2022-09-21 16:48:56 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-21 16:48:56 INFO  ---RUNTIME: Importing and monkey-patching took 5.454778671264648 ms
2022-09-21 16:48:58 INFO  ---RUNTIME: Original pipeline execution took 2154.5329093933105 ms (excluding imports and monkey-patching)
2022-09-21 16:48:58 INFO  Starting execution of 1 what-if analyses...
2022-09-21 16:48:58 INFO  Start plan generation for analysis OperatorImpact...
2022-09-21 16:48:58 INFO  ---RUNTIME: Plan generation took 4.150390625 ms
2022-09-21 16:48:58 INFO  Estimated runtime of original DAG is 1931.5135478973389ms
2022-09-21 16:48:58 WARNING Skipping Multi-Query Optimization (instead, only applying patches)
2022-09-21 16:48:58 INFO  Estimated unoptimised what-if runtime is 4262.792044672473ms
2022-09-21 16:48:58 INFO  ---RUNTIME: Multi-Query Optimization took 6.445646286010742 ms
2022-09-21 16:48:58 INFO  Executing generated plans
2022-09-21 16:49:02 INFO  ---RUNTIME: Execution took 3887.712001800537 ms
2022-09-21 16:49:02 INFO  Done!
2022-09-21 16:49:02 INFO  # Finished -- repetition 5 of 7 
2022-09-21 16:49:02 INFO  # Optimization benchmark for operator_impact with args [['healthcare', 'slow_loading', 'featurization_0', 'xgboost']] -- repetition 6 of 7
2022-09-21 16:49:02 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-21 16:49:02 INFO  Running instrumented original pipeline...
2022-09-21 16:49:02 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-21 16:49:02 INFO  ---RUNTIME: Importing and monkey-patching took 5.517244338989258 ms
2022-09-21 16:49:04 INFO  ---RUNTIME: Original pipeline execution took 2146.8560695648193 ms (excluding imports and monkey-patching)
2022-09-21 16:49:04 INFO  Starting execution of 1 what-if analyses...
2022-09-21 16:49:04 INFO  Start plan generation for analysis OperatorImpact...
2022-09-21 16:49:04 INFO  ---RUNTIME: Plan generation took 4.138469696044922 ms
2022-09-21 16:49:04 INFO  Estimated runtime of original DAG is 1925.0876903533936ms
2022-09-21 16:49:04 INFO  Performing Multi-Query Optimization
2022-09-21 16:49:04 INFO  Estimated unoptimized what-if runtime is 4249.9684317358615ms
2022-09-21 16:49:04 INFO  Estimated optimised what-if runtime is 2519.7345240362765ms
2022-09-21 16:49:04 INFO  Estimated optimisation runtime saving is 1730.233907699585ms
2022-09-21 16:49:04 INFO  ---RUNTIME: Multi-Query Optimization took 12.136459350585938 ms
2022-09-21 16:49:04 INFO  Executing generated plans
2022-09-21 16:49:06 INFO  ---RUNTIME: Execution took 2150.977611541748 ms
2022-09-21 16:49:06 INFO  Done!
2022-09-21 16:49:06 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-21 16:49:06 INFO  Running instrumented original pipeline...
2022-09-21 16:49:06 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-21 16:49:06 INFO  ---RUNTIME: Importing and monkey-patching took 5.424737930297852 ms
2022-09-21 16:49:09 INFO  ---RUNTIME: Original pipeline execution took 2170.9442138671875 ms (excluding imports and monkey-patching)
2022-09-21 16:49:09 INFO  Starting execution of 1 what-if analyses...
2022-09-21 16:49:09 INFO  Start plan generation for analysis OperatorImpact...
2022-09-21 16:49:09 INFO  ---RUNTIME: Plan generation took 4.035711288452148 ms
2022-09-21 16:49:09 INFO  Estimated runtime of original DAG is 1949.8603343963623ms
2022-09-21 16:49:09 WARNING Skipping Multi-Query Optimization (instead, only applying patches)
2022-09-21 16:49:09 INFO  Estimated unoptimised what-if runtime is 4295.902611469401ms
2022-09-21 16:49:09 INFO  ---RUNTIME: Multi-Query Optimization took 6.45756721496582 ms
2022-09-21 16:49:09 INFO  Executing generated plans
2022-09-21 16:49:12 INFO  ---RUNTIME: Execution took 3904.355049133301 ms
2022-09-21 16:49:12 INFO  Done!
2022-09-21 16:49:12 INFO  # Finished -- repetition 6 of 7 
2022-09-21 16:49:12 INFO  # Optimization benchmark for operator_impact with args [['healthcare', 'slow_loading', 'featurization_0', 'xgboost']] -- repetition 7 of 7
2022-09-21 16:49:12 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-21 16:49:12 INFO  Running instrumented original pipeline...
2022-09-21 16:49:12 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-21 16:49:13 INFO  ---RUNTIME: Importing and monkey-patching took 5.768299102783203 ms
2022-09-21 16:49:15 INFO  ---RUNTIME: Original pipeline execution took 2160.404920578003 ms (excluding imports and monkey-patching)
2022-09-21 16:49:15 INFO  Starting execution of 1 what-if analyses...
2022-09-21 16:49:15 INFO  Start plan generation for analysis OperatorImpact...
2022-09-21 16:49:15 INFO  ---RUNTIME: Plan generation took 4.106044769287109 ms
2022-09-21 16:49:15 INFO  Estimated runtime of original DAG is 1938.4877681732178ms
2022-09-21 16:49:15 INFO  Performing Multi-Query Optimization
2022-09-21 16:49:15 INFO  Estimated unoptimized what-if runtime is 4273.556466760307ms
2022-09-21 16:49:15 INFO  Estimated optimised what-if runtime is 2528.351302804618ms
2022-09-21 16:49:15 INFO  Estimated optimisation runtime saving is 1745.2051639556885ms
2022-09-21 16:49:15 INFO  ---RUNTIME: Multi-Query Optimization took 11.904001235961914 ms
2022-09-21 16:49:15 INFO  Executing generated plans
2022-09-21 16:49:17 INFO  ---RUNTIME: Execution took 2153.3756256103516 ms
2022-09-21 16:49:17 INFO  Done!
2022-09-21 16:49:17 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-21 16:49:17 INFO  Running instrumented original pipeline...
2022-09-21 16:49:17 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-21 16:49:17 INFO  ---RUNTIME: Importing and monkey-patching took 5.865573883056641 ms
2022-09-21 16:49:19 INFO  ---RUNTIME: Original pipeline execution took 2362.0781898498535 ms (excluding imports and monkey-patching)
2022-09-21 16:49:19 INFO  Starting execution of 1 what-if analyses...
2022-09-21 16:49:19 INFO  Start plan generation for analysis OperatorImpact...
2022-09-21 16:49:19 INFO  ---RUNTIME: Plan generation took 4.1446685791015625 ms
2022-09-21 16:49:19 INFO  Estimated runtime of original DAG is 1927.074670791626ms
2022-09-21 16:49:19 WARNING Skipping Multi-Query Optimization (instead, only applying patches)
2022-09-21 16:49:19 INFO  Estimated unoptimised what-if runtime is 4253.654396945032ms
2022-09-21 16:49:19 INFO  ---RUNTIME: Multi-Query Optimization took 6.510734558105469 ms
2022-09-21 16:49:19 INFO  Executing generated plans
2022-09-21 16:49:23 INFO  ---RUNTIME: Execution took 3917.978048324585 ms
2022-09-21 16:49:23 INFO  Done!
2022-09-21 16:49:23 INFO  # Finished -- repetition 7 of 7 
2022-09-21 16:49:23 INFO  # Final results after all repetitions
2022-09-21 16:49:23 INFO     repetition  ... no_opt_what_if_execution_combined_model_training
0           0  ...                                       376.209974
1           1  ...                                       374.270916
2           2  ...                                       376.202822
3           3  ...                                       374.550819
4           4  ...                                       372.471333
5           5  ...                                       374.081612
6           6  ...                                       374.714851

[7 rows x 26 columns]
taskset -c 128-135 PROTOCOL_BUFFERS_PYTHON_IMPLEMENTATION=python python3.9 benchmarks_end_to_end.py operator_impact healthcare slow_loading featurization_0 neural_network
2022-09-21 16:49:25.611968: W tensorflow/stream_executor/platform/default/dso_loader.cc:64] Could not load dynamic library 'libcudart.so.11.0'; dlerror: libcudart.so.11.0: cannot open shared object file: No such file or directory; LD_LIBRARY_PATH: /home/sgrafbe/mlwhatif/venv/lib/python3.9/site-packages/cv2/../../lib64:
2022-09-21 16:49:25.612017: I tensorflow/stream_executor/cuda/cudart_stub.cc:29] Ignore above cudart dlerror if you do not have a GPU set up on your machine.
2022-09-21 16:49:26 INFO  Patching sys.argv with ['mlwhatif', 'healthcare', 'slow_loading', 'featurization_0', 'neural_network']
2022-09-21 16:49:26 INFO  Running instrumented original pipeline...
2022-09-21 16:49:26 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-21 16:49:26 INFO  ---RUNTIME: Importing and monkey-patching took 95.18599510192871 ms
2022-09-21 16:49:28.946934: W tensorflow/stream_executor/platform/default/dso_loader.cc:64] Could not load dynamic library 'libcuda.so.1'; dlerror: libcuda.so.1: cannot open shared object file: No such file or directory; LD_LIBRARY_PATH: /home/sgrafbe/mlwhatif/venv/lib/python3.9/site-packages/cv2/../../lib64:
2022-09-21 16:49:28.946969: W tensorflow/stream_executor/cuda/cuda_driver.cc:326] failed call to cuInit: UNKNOWN ERROR (303)
2022-09-21 16:49:28.946990: I tensorflow/stream_executor/cuda/cuda_diagnostics.cc:156] kernel driver does not appear to be running on this host (wagyu): /proc/driver/nvidia/version does not exist
2022-09-21 16:49:28.947534: I tensorflow/core/platform/cpu_feature_guard.cc:142] This TensorFlow binary is optimized with oneAPI Deep Neural Network Library (oneDNN) to use the following CPU instructions in performance-critical operations:  AVX2 FMA
To enable them in other operations, rebuild TensorFlow with the appropriate compiler flags.
2022-09-21 16:49:29.011870: I tensorflow/compiler/mlir/mlir_graph_optimization_pass.cc:176] None of the MLIR Optimization Passes are enabled (registered 2)
2022-09-21 16:49:29.024374: I tensorflow/core/platform/profile_utils/cpu_utils.cc:114] CPU Frequency: 2595290000 Hz
2022-09-21 16:49:29 INFO  ---RUNTIME: Original pipeline execution took 2696.831464767456 ms (excluding imports and monkey-patching)
2022-09-21 16:49:29 INFO  Starting execution of 0 what-if analyses...
2022-09-21 16:49:29 INFO  Estimated runtime of original DAG is 2444.7684288024902ms
2022-09-21 16:49:29 INFO  Performing Multi-Query Optimization
2022-09-21 16:49:29 INFO  Estimated unoptimized what-if runtime is 0ms
2022-09-21 16:49:29 INFO  Estimated optimised what-if runtime is 0ms
2022-09-21 16:49:29 INFO  Estimated optimisation runtime saving is 0ms
2022-09-21 16:49:29 INFO  ---RUNTIME: Multi-Query Optimization took 0.4131793975830078 ms
2022-09-21 16:49:29 INFO  Executing generated plans
2022-09-21 16:49:29 INFO  ---RUNTIME: Execution took 0.01430511474609375 ms
2022-09-21 16:49:29 INFO  Done!
2022-09-21 16:49:29 INFO  # Optimization benchmark for operator_impact with args [['healthcare', 'slow_loading', 'featurization_0', 'neural_network']] -- repetition 1 of 7
2022-09-21 16:49:29 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-21 16:49:29 INFO  Running instrumented original pipeline...
2022-09-21 16:49:29 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-21 16:49:29 INFO  ---RUNTIME: Importing and monkey-patching took 5.097627639770508 ms
2022-09-21 16:49:31 INFO  ---RUNTIME: Original pipeline execution took 2362.596273422241 ms (excluding imports and monkey-patching)
2022-09-21 16:49:31 INFO  Starting execution of 1 what-if analyses...
2022-09-21 16:49:31 INFO  Start plan generation for analysis OperatorImpact...
2022-09-21 16:49:31 INFO  ---RUNTIME: Plan generation took 5.836009979248047 ms
2022-09-21 16:49:31 INFO  Estimated runtime of original DAG is 2140.969753265381ms
2022-09-21 16:49:31 INFO  Performing Multi-Query Optimization
2022-09-21 16:49:32 INFO  Estimated unoptimized what-if runtime is 5079.529473699373ms
2022-09-21 16:49:32 INFO  Estimated optimised what-if runtime is 3326.6241048944407ms
2022-09-21 16:49:32 INFO  Estimated optimisation runtime saving is 1752.905368804932ms
2022-09-21 16:49:32 INFO  ---RUNTIME: Multi-Query Optimization took 11.935710906982422 ms
2022-09-21 16:49:32 INFO  Executing generated plans
2022-09-21 16:49:34 INFO  ---RUNTIME: Execution took 2599.367141723633 ms
2022-09-21 16:49:34 INFO  Done!
2022-09-21 16:49:34 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-21 16:49:34 INFO  Running instrumented original pipeline...
2022-09-21 16:49:34 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-21 16:49:34 INFO  ---RUNTIME: Importing and monkey-patching took 5.686759948730469 ms
2022-09-21 16:49:37 INFO  ---RUNTIME: Original pipeline execution took 2553.3926486968994 ms (excluding imports and monkey-patching)
2022-09-21 16:49:37 INFO  Starting execution of 1 what-if analyses...
2022-09-21 16:49:37 INFO  Start plan generation for analysis OperatorImpact...
2022-09-21 16:49:37 INFO  ---RUNTIME: Plan generation took 4.092931747436523 ms
2022-09-21 16:49:37 INFO  Estimated runtime of original DAG is 2328.200340270996ms
2022-09-21 16:49:37 WARNING Skipping Multi-Query Optimization (instead, only applying patches)
2022-09-21 16:49:37 INFO  Estimated unoptimised what-if runtime is 5850.6208576005065ms
2022-09-21 16:49:37 INFO  ---RUNTIME: Multi-Query Optimization took 6.569147109985352 ms
2022-09-21 16:49:37 INFO  Executing generated plans
2022-09-21 16:49:41 INFO  ---RUNTIME: Execution took 4300.456762313843 ms
2022-09-21 16:49:41 INFO  Done!
2022-09-21 16:49:41 INFO  # Finished -- repetition 1 of 7 
2022-09-21 16:49:41 INFO  # Optimization benchmark for operator_impact with args [['healthcare', 'slow_loading', 'featurization_0', 'neural_network']] -- repetition 2 of 7
2022-09-21 16:49:41 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-21 16:49:41 INFO  Running instrumented original pipeline...
2022-09-21 16:49:41 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-21 16:49:41 INFO  ---RUNTIME: Importing and monkey-patching took 6.0977935791015625 ms
2022-09-21 16:49:43 INFO  ---RUNTIME: Original pipeline execution took 2334.2537879943848 ms (excluding imports and monkey-patching)
2022-09-21 16:49:43 INFO  Starting execution of 1 what-if analyses...
2022-09-21 16:49:43 INFO  Start plan generation for analysis OperatorImpact...
2022-09-21 16:49:43 INFO  ---RUNTIME: Plan generation took 4.379987716674805 ms
2022-09-21 16:49:43 INFO  Estimated runtime of original DAG is 2107.4085235595703ms
2022-09-21 16:49:43 INFO  Performing Multi-Query Optimization
2022-09-21 16:49:43 INFO  Estimated unoptimized what-if runtime is 5014.645333947807ms
2022-09-21 16:49:43 INFO  Estimated optimised what-if runtime is 3296.3864762207554ms
2022-09-21 16:49:43 INFO  Estimated optimisation runtime saving is 1718.2588577270512ms
2022-09-21 16:49:43 INFO  ---RUNTIME: Multi-Query Optimization took 12.279510498046875 ms
2022-09-21 16:49:43 INFO  Executing generated plans
2022-09-21 16:49:46 INFO  ---RUNTIME: Execution took 2897.836685180664 ms
2022-09-21 16:49:46 INFO  Done!
2022-09-21 16:49:46 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-21 16:49:46 INFO  Running instrumented original pipeline...
2022-09-21 16:49:46 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-21 16:49:46 INFO  ---RUNTIME: Importing and monkey-patching took 6.34765625 ms
2022-09-21 16:49:49 INFO  ---RUNTIME: Original pipeline execution took 2348.9627838134766 ms (excluding imports and monkey-patching)
2022-09-21 16:49:49 INFO  Starting execution of 1 what-if analyses...
2022-09-21 16:49:49 INFO  Start plan generation for analysis OperatorImpact...
2022-09-21 16:49:49 INFO  ---RUNTIME: Plan generation took 4.195451736450195 ms
2022-09-21 16:49:49 INFO  Estimated runtime of original DAG is 2123.210906982422ms
2022-09-21 16:49:49 WARNING Skipping Multi-Query Optimization (instead, only applying patches)
2022-09-21 16:49:49 INFO  Estimated unoptimised what-if runtime is 5041.422796249388ms
2022-09-21 16:49:49 INFO  ---RUNTIME: Multi-Query Optimization took 6.54292106628418 ms
2022-09-21 16:49:49 INFO  Executing generated plans
2022-09-21 16:49:53 INFO  ---RUNTIME: Execution took 4348.22678565979 ms
2022-09-21 16:49:53 INFO  Done!
2022-09-21 16:49:53 INFO  # Finished -- repetition 2 of 7 
2022-09-21 16:49:53 INFO  # Optimization benchmark for operator_impact with args [['healthcare', 'slow_loading', 'featurization_0', 'neural_network']] -- repetition 3 of 7
2022-09-21 16:49:53 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-21 16:49:53 INFO  Running instrumented original pipeline...
2022-09-21 16:49:53 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-21 16:49:53 INFO  ---RUNTIME: Importing and monkey-patching took 5.846261978149414 ms
2022-09-21 16:49:55 INFO  ---RUNTIME: Original pipeline execution took 2340.9526348114014 ms (excluding imports and monkey-patching)
2022-09-21 16:49:55 INFO  Starting execution of 1 what-if analyses...
2022-09-21 16:49:55 INFO  Start plan generation for analysis OperatorImpact...
2022-09-21 16:49:55 INFO  ---RUNTIME: Plan generation took 4.185676574707031 ms
2022-09-21 16:49:55 INFO  Estimated runtime of original DAG is 2116.5828704833984ms
2022-09-21 16:49:55 INFO  Performing Multi-Query Optimization
2022-09-21 16:49:55 INFO  Estimated unoptimized what-if runtime is 5034.228184305388ms
2022-09-21 16:49:55 INFO  Estimated optimised what-if runtime is 3307.4072385656423ms
2022-09-21 16:49:55 INFO  Estimated optimisation runtime saving is 1726.8209457397456ms
2022-09-21 16:49:55 INFO  ---RUNTIME: Multi-Query Optimization took 11.99483871459961 ms
2022-09-21 16:49:55 INFO  Executing generated plans
2022-09-21 16:49:58 INFO  ---RUNTIME: Execution took 2850.172996520996 ms
2022-09-21 16:49:58 INFO  Done!
2022-09-21 16:49:58 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-21 16:49:58 INFO  Running instrumented original pipeline...
2022-09-21 16:49:58 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-21 16:49:58 INFO  ---RUNTIME: Importing and monkey-patching took 5.601644515991211 ms
2022-09-21 16:50:01 INFO  ---RUNTIME: Original pipeline execution took 2406.6150188446045 ms (excluding imports and monkey-patching)
2022-09-21 16:50:01 INFO  Starting execution of 1 what-if analyses...
2022-09-21 16:50:01 INFO  Start plan generation for analysis OperatorImpact...
2022-09-21 16:50:01 INFO  ---RUNTIME: Plan generation took 4.271745681762695 ms
2022-09-21 16:50:01 INFO  Estimated runtime of original DAG is 2180.7315349578857ms
2022-09-21 16:50:01 WARNING Skipping Multi-Query Optimization (instead, only applying patches)
2022-09-21 16:50:01 INFO  Estimated unoptimised what-if runtime is 5173.956166464706ms
2022-09-21 16:50:01 INFO  ---RUNTIME: Multi-Query Optimization took 6.590127944946289 ms
2022-09-21 16:50:01 INFO  Executing generated plans
2022-09-21 16:50:05 INFO  ---RUNTIME: Execution took 4294.705390930176 ms
2022-09-21 16:50:05 INFO  Done!
2022-09-21 16:50:05 INFO  # Finished -- repetition 3 of 7 
2022-09-21 16:50:05 INFO  # Optimization benchmark for operator_impact with args [['healthcare', 'slow_loading', 'featurization_0', 'neural_network']] -- repetition 4 of 7
2022-09-21 16:50:05 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-21 16:50:05 INFO  Running instrumented original pipeline...
2022-09-21 16:50:05 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-21 16:50:05 INFO  ---RUNTIME: Importing and monkey-patching took 6.212472915649414 ms
2022-09-21 16:50:07 INFO  ---RUNTIME: Original pipeline execution took 2340.169906616211 ms (excluding imports and monkey-patching)
2022-09-21 16:50:07 INFO  Starting execution of 1 what-if analyses...
2022-09-21 16:50:07 INFO  Start plan generation for analysis OperatorImpact...
2022-09-21 16:50:07 INFO  ---RUNTIME: Plan generation took 4.29844856262207 ms
2022-09-21 16:50:07 INFO  Estimated runtime of original DAG is 2112.2066974639893ms
2022-09-21 16:50:07 INFO  Performing Multi-Query Optimization
2022-09-21 16:50:07 INFO  Estimated unoptimized what-if runtime is 5025.089147995257ms
2022-09-21 16:50:07 INFO  Estimated optimised what-if runtime is 3302.446964691425ms
2022-09-21 16:50:07 INFO  Estimated optimisation runtime saving is 1722.642183303832ms
2022-09-21 16:50:07 INFO  ---RUNTIME: Multi-Query Optimization took 12.049198150634766 ms
2022-09-21 16:50:07 INFO  Executing generated plans
2022-09-21 16:50:10 INFO  ---RUNTIME: Execution took 2858.038902282715 ms
2022-09-21 16:50:10 INFO  Done!
2022-09-21 16:50:10 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-21 16:50:10 INFO  Running instrumented original pipeline...
2022-09-21 16:50:10 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-21 16:50:10 INFO  ---RUNTIME: Importing and monkey-patching took 5.644321441650391 ms
2022-09-21 16:50:12 INFO  ---RUNTIME: Original pipeline execution took 2358.405113220215 ms (excluding imports and monkey-patching)
2022-09-21 16:50:12 INFO  Starting execution of 1 what-if analyses...
2022-09-21 16:50:12 INFO  Start plan generation for analysis OperatorImpact...
2022-09-21 16:50:12 INFO  ---RUNTIME: Plan generation took 4.154682159423828 ms
2022-09-21 16:50:12 INFO  Estimated runtime of original DAG is 2132.9946517944336ms
2022-09-21 16:50:12 WARNING Skipping Multi-Query Optimization (instead, only applying patches)
2022-09-21 16:50:12 INFO  Estimated unoptimised what-if runtime is 5063.165711534434ms
2022-09-21 16:50:12 INFO  ---RUNTIME: Multi-Query Optimization took 6.463050842285156 ms
2022-09-21 16:50:12 INFO  Executing generated plans
2022-09-21 16:50:17 INFO  ---RUNTIME: Execution took 4332.756280899048 ms
2022-09-21 16:50:17 INFO  Done!
2022-09-21 16:50:17 INFO  # Finished -- repetition 4 of 7 
2022-09-21 16:50:17 INFO  # Optimization benchmark for operator_impact with args [['healthcare', 'slow_loading', 'featurization_0', 'neural_network']] -- repetition 5 of 7
2022-09-21 16:50:17 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-21 16:50:17 INFO  Running instrumented original pipeline...
2022-09-21 16:50:17 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-21 16:50:17 INFO  ---RUNTIME: Importing and monkey-patching took 5.611896514892578 ms
2022-09-21 16:50:19 INFO  ---RUNTIME: Original pipeline execution took 2661.4890098571777 ms (excluding imports and monkey-patching)
2022-09-21 16:50:19 INFO  Starting execution of 1 what-if analyses...
2022-09-21 16:50:19 INFO  Start plan generation for analysis OperatorImpact...
2022-09-21 16:50:19 INFO  ---RUNTIME: Plan generation took 4.049539566040039 ms
2022-09-21 16:50:19 INFO  Estimated runtime of original DAG is 2434.941291809082ms
2022-09-21 16:50:19 INFO  Performing Multi-Query Optimization
2022-09-21 16:50:20 INFO  Estimated unoptimized what-if runtime is 6289.1163686226155ms
2022-09-21 16:50:20 INFO  Estimated optimised what-if runtime is 4544.206843705014ms
2022-09-21 16:50:20 INFO  Estimated optimisation runtime saving is 1744.9095249176016ms
2022-09-21 16:50:20 INFO  ---RUNTIME: Multi-Query Optimization took 12.125730514526367 ms
2022-09-21 16:50:20 INFO  Executing generated plans
2022-09-21 16:50:22 INFO  ---RUNTIME: Execution took 2571.1026191711426 ms
2022-09-21 16:50:22 INFO  Done!
2022-09-21 16:50:22 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-21 16:50:22 INFO  Running instrumented original pipeline...
2022-09-21 16:50:22 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-21 16:50:22 INFO  ---RUNTIME: Importing and monkey-patching took 5.947589874267578 ms
2022-09-21 16:50:24 INFO  ---RUNTIME: Original pipeline execution took 2332.0391178131104 ms (excluding imports and monkey-patching)
2022-09-21 16:50:24 INFO  Starting execution of 1 what-if analyses...
2022-09-21 16:50:24 INFO  Start plan generation for analysis OperatorImpact...
2022-09-21 16:50:24 INFO  ---RUNTIME: Plan generation took 4.196882247924805 ms
2022-09-21 16:50:24 INFO  Estimated runtime of original DAG is 2106.7090034484863ms
2022-09-21 16:50:24 WARNING Skipping Multi-Query Optimization (instead, only applying patches)
2022-09-21 16:50:24 INFO  Estimated unoptimised what-if runtime is 5008.262140175392ms
2022-09-21 16:50:24 INFO  ---RUNTIME: Multi-Query Optimization took 7.918119430541992 ms
2022-09-21 16:50:24 INFO  Executing generated plans
2022-09-21 16:50:29 INFO  ---RUNTIME: Execution took 4321.287631988525 ms
2022-09-21 16:50:29 INFO  Done!
2022-09-21 16:50:29 INFO  # Finished -- repetition 5 of 7 
2022-09-21 16:50:29 INFO  # Optimization benchmark for operator_impact with args [['healthcare', 'slow_loading', 'featurization_0', 'neural_network']] -- repetition 6 of 7
2022-09-21 16:50:29 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-21 16:50:29 INFO  Running instrumented original pipeline...
2022-09-21 16:50:29 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-21 16:50:29 INFO  ---RUNTIME: Importing and monkey-patching took 6.213903427124023 ms
2022-09-21 16:50:32 INFO  ---RUNTIME: Original pipeline execution took 2819.091320037842 ms (excluding imports and monkey-patching)
2022-09-21 16:50:32 INFO  Starting execution of 1 what-if analyses...
2022-09-21 16:50:32 INFO  Start plan generation for analysis OperatorImpact...
2022-09-21 16:50:32 INFO  ---RUNTIME: Plan generation took 4.557132720947266 ms
2022-09-21 16:50:32 INFO  Estimated runtime of original DAG is 2581.200122833252ms
2022-09-21 16:50:32 INFO  Performing Multi-Query Optimization
2022-09-21 16:50:32 INFO  Estimated unoptimized what-if runtime is 6726.023877900222ms
2022-09-21 16:50:32 INFO  Estimated optimised what-if runtime is 4904.994691651443ms
2022-09-21 16:50:32 INFO  Estimated optimisation runtime saving is 1821.0291862487793ms
2022-09-21 16:50:32 INFO  ---RUNTIME: Multi-Query Optimization took 14.290332794189453 ms
2022-09-21 16:50:32 INFO  Executing generated plans
2022-09-21 16:50:34 INFO  ---RUNTIME: Execution took 2641.2909030914307 ms
2022-09-21 16:50:34 INFO  Done!
2022-09-21 16:50:34 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-21 16:50:34 INFO  Running instrumented original pipeline...
2022-09-21 16:50:34 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-21 16:50:34 INFO  ---RUNTIME: Importing and monkey-patching took 5.587577819824219 ms
2022-09-21 16:50:37 INFO  ---RUNTIME: Original pipeline execution took 2361.785888671875 ms (excluding imports and monkey-patching)
2022-09-21 16:50:37 INFO  Starting execution of 1 what-if analyses...
2022-09-21 16:50:37 INFO  Start plan generation for analysis OperatorImpact...
2022-09-21 16:50:37 INFO  ---RUNTIME: Plan generation took 4.457712173461914 ms
2022-09-21 16:50:37 INFO  Estimated runtime of original DAG is 2133.967638015747ms
2022-09-21 16:50:37 WARNING Skipping Multi-Query Optimization (instead, only applying patches)
2022-09-21 16:50:37 INFO  Estimated unoptimised what-if runtime is 5084.153532981873ms
2022-09-21 16:50:37 INFO  ---RUNTIME: Multi-Query Optimization took 6.815910339355469 ms
2022-09-21 16:50:37 INFO  Executing generated plans
2022-09-21 16:50:41 INFO  ---RUNTIME: Execution took 4423.88391494751 ms
2022-09-21 16:50:41 INFO  Done!
2022-09-21 16:50:41 INFO  # Finished -- repetition 6 of 7 
2022-09-21 16:50:41 INFO  # Optimization benchmark for operator_impact with args [['healthcare', 'slow_loading', 'featurization_0', 'neural_network']] -- repetition 7 of 7
2022-09-21 16:50:41 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-21 16:50:41 INFO  Running instrumented original pipeline...
2022-09-21 16:50:41 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-21 16:50:41 INFO  ---RUNTIME: Importing and monkey-patching took 5.60450553894043 ms
2022-09-21 16:50:44 INFO  ---RUNTIME: Original pipeline execution took 2698.4448432922363 ms (excluding imports and monkey-patching)
2022-09-21 16:50:44 INFO  Starting execution of 1 what-if analyses...
2022-09-21 16:50:44 INFO  Start plan generation for analysis OperatorImpact...
2022-09-21 16:50:44 INFO  ---RUNTIME: Plan generation took 4.269599914550781 ms
2022-09-21 16:50:44 INFO  Estimated runtime of original DAG is 2471.949577331543ms
2022-09-21 16:50:44 INFO  Performing Multi-Query Optimization
2022-09-21 16:50:44 INFO  Estimated unoptimized what-if runtime is 6411.8422023181265ms
2022-09-21 16:50:44 INFO  Estimated optimised what-if runtime is 4653.596734178477ms
2022-09-21 16:50:44 INFO  Estimated optimisation runtime saving is 1758.2454681396493ms
2022-09-21 16:50:44 INFO  ---RUNTIME: Multi-Query Optimization took 11.97361946105957 ms
2022-09-21 16:50:44 INFO  Executing generated plans
2022-09-21 16:50:46 INFO  ---RUNTIME: Execution took 2590.855598449707 ms
2022-09-21 16:50:46 INFO  Done!
2022-09-21 16:50:46 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-21 16:50:46 INFO  Running instrumented original pipeline...
2022-09-21 16:50:46 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-21 16:50:46 INFO  ---RUNTIME: Importing and monkey-patching took 5.882024765014648 ms
2022-09-21 16:50:49 INFO  ---RUNTIME: Original pipeline execution took 2356.674909591675 ms (excluding imports and monkey-patching)
2022-09-21 16:50:49 INFO  Starting execution of 1 what-if analyses...
2022-09-21 16:50:49 INFO  Start plan generation for analysis OperatorImpact...
2022-09-21 16:50:49 INFO  ---RUNTIME: Plan generation took 5.816936492919922 ms
2022-09-21 16:50:49 INFO  Estimated runtime of original DAG is 2121.946334838867ms
2022-09-21 16:50:49 WARNING Skipping Multi-Query Optimization (instead, only applying patches)
2022-09-21 16:50:49 INFO  Estimated unoptimised what-if runtime is 5038.130128794703ms
2022-09-21 16:50:49 INFO  ---RUNTIME: Multi-Query Optimization took 6.469488143920898 ms
2022-09-21 16:50:49 INFO  Executing generated plans
2022-09-21 16:50:53 INFO  ---RUNTIME: Execution took 4372.790575027466 ms
2022-09-21 16:50:53 INFO  Done!
2022-09-21 16:50:53 INFO  # Finished -- repetition 7 of 7 
2022-09-21 16:50:53 INFO  # Final results after all repetitions
2022-09-21 16:50:53 INFO     repetition  ... no_opt_what_if_execution_combined_model_training
0           0  ...                                       681.545019
1           1  ...                                       678.757429
2           2  ...                                       678.235054
3           3  ...                                       669.755697
4           4  ...                                       681.105852
5           5  ...                                       683.661699
6           6  ...                                       683.104038

[7 rows x 26 columns]
taskset -c 128-135 PROTOCOL_BUFFERS_PYTHON_IMPLEMENTATION=python python3.9 benchmarks_end_to_end.py operator_impact healthcare slow_loading featurization_1 logistic_regression
2022-09-21 16:50:55.929067: W tensorflow/stream_executor/platform/default/dso_loader.cc:64] Could not load dynamic library 'libcudart.so.11.0'; dlerror: libcudart.so.11.0: cannot open shared object file: No such file or directory; LD_LIBRARY_PATH: /home/sgrafbe/mlwhatif/venv/lib/python3.9/site-packages/cv2/../../lib64:
2022-09-21 16:50:55.929114: I tensorflow/stream_executor/cuda/cudart_stub.cc:29] Ignore above cudart dlerror if you do not have a GPU set up on your machine.
2022-09-21 16:50:57 INFO  Patching sys.argv with ['mlwhatif', 'healthcare', 'slow_loading', 'featurization_1', 'logistic_regression']
2022-09-21 16:50:57 INFO  Running instrumented original pipeline...
2022-09-21 16:50:57 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-21 16:50:57 INFO  ---RUNTIME: Importing and monkey-patching took 95.2904224395752 ms
2022-09-21 16:50:59 INFO  ---RUNTIME: Original pipeline execution took 2154.6785831451416 ms (excluding imports and monkey-patching)
2022-09-21 16:50:59 INFO  Starting execution of 0 what-if analyses...
2022-09-21 16:50:59 INFO  Estimated runtime of original DAG is 1865.2989864349365ms
2022-09-21 16:50:59 INFO  Performing Multi-Query Optimization
2022-09-21 16:50:59 INFO  Estimated unoptimized what-if runtime is 0ms
2022-09-21 16:50:59 INFO  Estimated optimised what-if runtime is 0ms
2022-09-21 16:50:59 INFO  Estimated optimisation runtime saving is 0ms
2022-09-21 16:50:59 INFO  ---RUNTIME: Multi-Query Optimization took 0.46563148498535156 ms
2022-09-21 16:50:59 INFO  Executing generated plans
2022-09-21 16:50:59 INFO  ---RUNTIME: Execution took 0.0247955322265625 ms
2022-09-21 16:50:59 INFO  Done!
2022-09-21 16:50:59 INFO  # Optimization benchmark for operator_impact with args [['healthcare', 'slow_loading', 'featurization_1', 'logistic_regression']] -- repetition 1 of 7
2022-09-21 16:50:59 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-21 16:50:59 INFO  Running instrumented original pipeline...
2022-09-21 16:50:59 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-21 16:50:59 INFO  ---RUNTIME: Importing and monkey-patching took 5.33294677734375 ms
2022-09-21 16:51:01 INFO  ---RUNTIME: Original pipeline execution took 2063.6062622070312 ms (excluding imports and monkey-patching)
2022-09-21 16:51:01 INFO  Starting execution of 1 what-if analyses...
2022-09-21 16:51:01 INFO  Start plan generation for analysis OperatorImpact...
2022-09-21 16:51:01 INFO  ---RUNTIME: Plan generation took 4.891395568847656 ms
2022-09-21 16:51:01 INFO  Estimated runtime of original DAG is 1805.2687644958496ms
2022-09-21 16:51:01 INFO  Performing Multi-Query Optimization
2022-09-21 16:51:01 INFO  Estimated unoptimized what-if runtime is 9053.269396979233ms
2022-09-21 16:51:01 INFO  Estimated optimised what-if runtime is 1863.7249576634372ms
2022-09-21 16:51:01 INFO  Estimated optimisation runtime saving is 7189.544439315796ms
2022-09-21 16:51:01 INFO  ---RUNTIME: Multi-Query Optimization took 18.938064575195312 ms
2022-09-21 16:51:01 INFO  Executing generated plans
Traceback (most recent call last):
  File "/home/sgrafbe/mlwhatif/experiments/end_to_end/benchmarks_end_to_end.py", line 228, in <module>
    analysis_result_opt = PipelineAnalyzer \
  File "/home/sgrafbe/mlwhatif/mlwhatif/_pipeline_analyzer.py", line 93, in execute
    return singleton.run(notebook_path=self._notebook_path,
  File "/home/sgrafbe/mlwhatif/mlwhatif/execution/_pipeline_executor.py", line 149, in run
    self.run_what_if_analyses()
  File "/home/sgrafbe/mlwhatif/mlwhatif/execution/_pipeline_executor.py", line 178, in run_what_if_analyses
    DagExecutor(self).execute(self.analysis_results.combined_optimized_dag)
  File "/home/sgrafbe/mlwhatif/mlwhatif/execution/_dag_executor.py", line 45, in execute
    self.traverse_graph_and_process_nodes(dag, execute_node)
  File "/home/sgrafbe/mlwhatif/mlwhatif/execution/_dag_executor.py", line 57, in traverse_graph_and_process_nodes
    result_node = func(node)
  File "/home/sgrafbe/mlwhatif/mlwhatif/execution/_dag_executor.py", line 40, in execute_node
    optimizer_info, result_df = capture_optimizer_info(executable_processing_func)
  File "/home/sgrafbe/mlwhatif/mlwhatif/execution/_stat_tracking.py", line 28, in capture_optimizer_info
    result = instrumented_function_call()
  File "/home/sgrafbe/mlwhatif/mlwhatif/monkeypatching/_patch_sklearn.py", line 1498, in processing_func
    transformed_data = transformer.fit_transform(input_df, *args[1:], **kwargs)
  File "/home/sgrafbe/mlwhatif/venv/lib64/python3.9/site-packages/sklearn/preprocessing/_encoders.py", line 410, in fit_transform
    return super().fit_transform(X, y)
  File "/home/sgrafbe/mlwhatif/venv/lib64/python3.9/site-packages/sklearn/base.py", line 693, in fit_transform
    return self.fit(X, y, **fit_params).transform(X)
  File "/home/sgrafbe/mlwhatif/venv/lib64/python3.9/site-packages/sklearn/preprocessing/_encoders.py", line 385, in fit
    self._fit(X, handle_unknown=self.handle_unknown)
  File "/home/sgrafbe/mlwhatif/venv/lib64/python3.9/site-packages/sklearn/preprocessing/_encoders.py", line 74, in _fit
    X_list, n_samples, n_features = self._check_X(X)
  File "/home/sgrafbe/mlwhatif/venv/lib64/python3.9/site-packages/sklearn/preprocessing/_encoders.py", line 60, in _check_X
    Xi = check_array(Xi, ensure_2d=False, dtype=None,
  File "/home/sgrafbe/mlwhatif/venv/lib64/python3.9/site-packages/sklearn/utils/validation.py", line 72, in inner_f
    return f(**kwargs)
  File "/home/sgrafbe/mlwhatif/venv/lib64/python3.9/site-packages/sklearn/utils/validation.py", line 644, in check_array
    _assert_all_finite(array,
  File "/home/sgrafbe/mlwhatif/venv/lib64/python3.9/site-packages/sklearn/utils/validation.py", line 104, in _assert_all_finite
    raise ValueError("Input contains NaN")
ValueError: Input contains NaN
taskset -c 128-135 PROTOCOL_BUFFERS_PYTHON_IMPLEMENTATION=python python3.9 benchmarks_end_to_end.py operator_impact healthcare slow_loading featurization_1 xgboost
2022-09-21 16:51:05.266313: W tensorflow/stream_executor/platform/default/dso_loader.cc:64] Could not load dynamic library 'libcudart.so.11.0'; dlerror: libcudart.so.11.0: cannot open shared object file: No such file or directory; LD_LIBRARY_PATH: /home/sgrafbe/mlwhatif/venv/lib/python3.9/site-packages/cv2/../../lib64:
2022-09-21 16:51:05.266359: I tensorflow/stream_executor/cuda/cudart_stub.cc:29] Ignore above cudart dlerror if you do not have a GPU set up on your machine.
2022-09-21 16:51:06 INFO  Patching sys.argv with ['mlwhatif', 'healthcare', 'slow_loading', 'featurization_1', 'xgboost']
2022-09-21 16:51:06 INFO  Running instrumented original pipeline...
2022-09-21 16:51:06 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-21 16:51:06 INFO  ---RUNTIME: Importing and monkey-patching took 98.95801544189453 ms
2022-09-21 16:51:09 INFO  ---RUNTIME: Original pipeline execution took 2464.5767211914062 ms (excluding imports and monkey-patching)
2022-09-21 16:51:09 INFO  Starting execution of 0 what-if analyses...
2022-09-21 16:51:09 INFO  Estimated runtime of original DAG is 2161.731243133545ms
2022-09-21 16:51:09 INFO  Performing Multi-Query Optimization
2022-09-21 16:51:09 INFO  Estimated unoptimized what-if runtime is 0ms
2022-09-21 16:51:09 INFO  Estimated optimised what-if runtime is 0ms
2022-09-21 16:51:09 INFO  Estimated optimisation runtime saving is 0ms
2022-09-21 16:51:09 INFO  ---RUNTIME: Multi-Query Optimization took 0.5178451538085938 ms
2022-09-21 16:51:09 INFO  Executing generated plans
2022-09-21 16:51:09 INFO  ---RUNTIME: Execution took 0.02384185791015625 ms
2022-09-21 16:51:09 INFO  Done!
2022-09-21 16:51:09 INFO  # Optimization benchmark for operator_impact with args [['healthcare', 'slow_loading', 'featurization_1', 'xgboost']] -- repetition 1 of 7
2022-09-21 16:51:09 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-21 16:51:09 INFO  Running instrumented original pipeline...
2022-09-21 16:51:09 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-21 16:51:09 INFO  ---RUNTIME: Importing and monkey-patching took 5.148410797119141 ms
2022-09-21 16:51:11 INFO  ---RUNTIME: Original pipeline execution took 2321.509838104248 ms (excluding imports and monkey-patching)
2022-09-21 16:51:11 INFO  Starting execution of 1 what-if analyses...
2022-09-21 16:51:11 INFO  Start plan generation for analysis OperatorImpact...
2022-09-21 16:51:11 INFO  ---RUNTIME: Plan generation took 5.223751068115234 ms
2022-09-21 16:51:11 INFO  Estimated runtime of original DAG is 2051.9137382507324ms
2022-09-21 16:51:11 INFO  Performing Multi-Query Optimization
2022-09-21 16:51:11 INFO  Estimated unoptimized what-if runtime is 10666.433650049672ms
2022-09-21 16:51:11 INFO  Estimated optimised what-if runtime is 3228.1409082741584ms
2022-09-21 16:51:11 INFO  Estimated optimisation runtime saving is 7438.292741775514ms
2022-09-21 16:51:11 INFO  ---RUNTIME: Multi-Query Optimization took 18.772602081298828 ms
2022-09-21 16:51:11 INFO  Executing generated plans
Traceback (most recent call last):
  File "/home/sgrafbe/mlwhatif/experiments/end_to_end/benchmarks_end_to_end.py", line 228, in <module>
    analysis_result_opt = PipelineAnalyzer \
  File "/home/sgrafbe/mlwhatif/mlwhatif/_pipeline_analyzer.py", line 93, in execute
    return singleton.run(notebook_path=self._notebook_path,
  File "/home/sgrafbe/mlwhatif/mlwhatif/execution/_pipeline_executor.py", line 149, in run
    self.run_what_if_analyses()
  File "/home/sgrafbe/mlwhatif/mlwhatif/execution/_pipeline_executor.py", line 178, in run_what_if_analyses
    DagExecutor(self).execute(self.analysis_results.combined_optimized_dag)
  File "/home/sgrafbe/mlwhatif/mlwhatif/execution/_dag_executor.py", line 45, in execute
    self.traverse_graph_and_process_nodes(dag, execute_node)
  File "/home/sgrafbe/mlwhatif/mlwhatif/execution/_dag_executor.py", line 57, in traverse_graph_and_process_nodes
    result_node = func(node)
  File "/home/sgrafbe/mlwhatif/mlwhatif/execution/_dag_executor.py", line 40, in execute_node
    optimizer_info, result_df = capture_optimizer_info(executable_processing_func)
  File "/home/sgrafbe/mlwhatif/mlwhatif/execution/_stat_tracking.py", line 28, in capture_optimizer_info
    result = instrumented_function_call()
  File "/home/sgrafbe/mlwhatif/mlwhatif/monkeypatching/_patch_sklearn.py", line 1498, in processing_func
    transformed_data = transformer.fit_transform(input_df, *args[1:], **kwargs)
  File "/home/sgrafbe/mlwhatif/venv/lib64/python3.9/site-packages/sklearn/preprocessing/_encoders.py", line 410, in fit_transform
    return super().fit_transform(X, y)
  File "/home/sgrafbe/mlwhatif/venv/lib64/python3.9/site-packages/sklearn/base.py", line 693, in fit_transform
    return self.fit(X, y, **fit_params).transform(X)
  File "/home/sgrafbe/mlwhatif/venv/lib64/python3.9/site-packages/sklearn/preprocessing/_encoders.py", line 385, in fit
    self._fit(X, handle_unknown=self.handle_unknown)
  File "/home/sgrafbe/mlwhatif/venv/lib64/python3.9/site-packages/sklearn/preprocessing/_encoders.py", line 74, in _fit
    X_list, n_samples, n_features = self._check_X(X)
  File "/home/sgrafbe/mlwhatif/venv/lib64/python3.9/site-packages/sklearn/preprocessing/_encoders.py", line 60, in _check_X
    Xi = check_array(Xi, ensure_2d=False, dtype=None,
  File "/home/sgrafbe/mlwhatif/venv/lib64/python3.9/site-packages/sklearn/utils/validation.py", line 72, in inner_f
    return f(**kwargs)
  File "/home/sgrafbe/mlwhatif/venv/lib64/python3.9/site-packages/sklearn/utils/validation.py", line 644, in check_array
    _assert_all_finite(array,
  File "/home/sgrafbe/mlwhatif/venv/lib64/python3.9/site-packages/sklearn/utils/validation.py", line 104, in _assert_all_finite
    raise ValueError("Input contains NaN")
ValueError: Input contains NaN
taskset -c 128-135 PROTOCOL_BUFFERS_PYTHON_IMPLEMENTATION=python python3.9 benchmarks_end_to_end.py operator_impact healthcare slow_loading featurization_1 neural_network
2022-09-21 16:51:15.135766: W tensorflow/stream_executor/platform/default/dso_loader.cc:64] Could not load dynamic library 'libcudart.so.11.0'; dlerror: libcudart.so.11.0: cannot open shared object file: No such file or directory; LD_LIBRARY_PATH: /home/sgrafbe/mlwhatif/venv/lib/python3.9/site-packages/cv2/../../lib64:
2022-09-21 16:51:15.135807: I tensorflow/stream_executor/cuda/cudart_stub.cc:29] Ignore above cudart dlerror if you do not have a GPU set up on your machine.
2022-09-21 16:51:16 INFO  Patching sys.argv with ['mlwhatif', 'healthcare', 'slow_loading', 'featurization_1', 'neural_network']
2022-09-21 16:51:16 INFO  Running instrumented original pipeline...
2022-09-21 16:51:16 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-21 16:51:16 INFO  ---RUNTIME: Importing and monkey-patching took 95.27826309204102 ms
2022-09-21 16:51:18.588087: W tensorflow/stream_executor/platform/default/dso_loader.cc:64] Could not load dynamic library 'libcuda.so.1'; dlerror: libcuda.so.1: cannot open shared object file: No such file or directory; LD_LIBRARY_PATH: /home/sgrafbe/mlwhatif/venv/lib/python3.9/site-packages/cv2/../../lib64:
2022-09-21 16:51:18.588123: W tensorflow/stream_executor/cuda/cuda_driver.cc:326] failed call to cuInit: UNKNOWN ERROR (303)
2022-09-21 16:51:18.588144: I tensorflow/stream_executor/cuda/cuda_diagnostics.cc:156] kernel driver does not appear to be running on this host (wagyu): /proc/driver/nvidia/version does not exist
2022-09-21 16:51:18.588616: I tensorflow/core/platform/cpu_feature_guard.cc:142] This TensorFlow binary is optimized with oneAPI Deep Neural Network Library (oneDNN) to use the following CPU instructions in performance-critical operations:  AVX2 FMA
To enable them in other operations, rebuild TensorFlow with the appropriate compiler flags.
2022-09-21 16:51:19.138981: I tensorflow/compiler/mlir/mlir_graph_optimization_pass.cc:176] None of the MLIR Optimization Passes are enabled (registered 2)
2022-09-21 16:51:19.152376: I tensorflow/core/platform/profile_utils/cpu_utils.cc:114] CPU Frequency: 2595290000 Hz
2022-09-21 16:51:19 INFO  ---RUNTIME: Original pipeline execution took 2913.2742881774902 ms (excluding imports and monkey-patching)
2022-09-21 16:51:19 INFO  Starting execution of 0 what-if analyses...
2022-09-21 16:51:19 INFO  Estimated runtime of original DAG is 2608.8268756866455ms
2022-09-21 16:51:19 INFO  Performing Multi-Query Optimization
2022-09-21 16:51:19 INFO  Estimated unoptimized what-if runtime is 0ms
2022-09-21 16:51:19 INFO  Estimated optimised what-if runtime is 0ms
2022-09-21 16:51:19 INFO  Estimated optimisation runtime saving is 0ms
2022-09-21 16:51:19 INFO  ---RUNTIME: Multi-Query Optimization took 0.5142688751220703 ms
2022-09-21 16:51:19 INFO  Executing generated plans
2022-09-21 16:51:19 INFO  ---RUNTIME: Execution took 0.016450881958007812 ms
2022-09-21 16:51:19 INFO  Done!
2022-09-21 16:51:19 INFO  # Optimization benchmark for operator_impact with args [['healthcare', 'slow_loading', 'featurization_1', 'neural_network']] -- repetition 1 of 7
2022-09-21 16:51:19 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-21 16:51:19 INFO  Running instrumented original pipeline...
2022-09-21 16:51:19 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-21 16:51:19 INFO  ---RUNTIME: Importing and monkey-patching took 5.850076675415039 ms
2022-09-21 16:51:22 INFO  ---RUNTIME: Original pipeline execution took 2584.3253135681152 ms (excluding imports and monkey-patching)
2022-09-21 16:51:22 INFO  Starting execution of 1 what-if analyses...
2022-09-21 16:51:22 INFO  Start plan generation for analysis OperatorImpact...
2022-09-21 16:51:22 INFO  ---RUNTIME: Plan generation took 5.157709121704102 ms
2022-09-21 16:51:22 INFO  Estimated runtime of original DAG is 2301.6209602355957ms
2022-09-21 16:51:22 INFO  Performing Multi-Query Optimization
2022-09-21 16:51:22 INFO  Estimated unoptimized what-if runtime is 12575.64904443149ms
2022-09-21 16:51:22 INFO  Estimated optimised what-if runtime is 5419.8470329416205ms
2022-09-21 16:51:22 INFO  Estimated optimisation runtime saving is 7155.802011489869ms
2022-09-21 16:51:22 INFO  ---RUNTIME: Multi-Query Optimization took 18.816709518432617 ms
2022-09-21 16:51:22 INFO  Executing generated plans
Traceback (most recent call last):
  File "/home/sgrafbe/mlwhatif/experiments/end_to_end/benchmarks_end_to_end.py", line 228, in <module>
    analysis_result_opt = PipelineAnalyzer \
  File "/home/sgrafbe/mlwhatif/mlwhatif/_pipeline_analyzer.py", line 93, in execute
    return singleton.run(notebook_path=self._notebook_path,
  File "/home/sgrafbe/mlwhatif/mlwhatif/execution/_pipeline_executor.py", line 149, in run
    self.run_what_if_analyses()
  File "/home/sgrafbe/mlwhatif/mlwhatif/execution/_pipeline_executor.py", line 178, in run_what_if_analyses
    DagExecutor(self).execute(self.analysis_results.combined_optimized_dag)
  File "/home/sgrafbe/mlwhatif/mlwhatif/execution/_dag_executor.py", line 45, in execute
    self.traverse_graph_and_process_nodes(dag, execute_node)
  File "/home/sgrafbe/mlwhatif/mlwhatif/execution/_dag_executor.py", line 57, in traverse_graph_and_process_nodes
    result_node = func(node)
  File "/home/sgrafbe/mlwhatif/mlwhatif/execution/_dag_executor.py", line 40, in execute_node
    optimizer_info, result_df = capture_optimizer_info(executable_processing_func)
  File "/home/sgrafbe/mlwhatif/mlwhatif/execution/_stat_tracking.py", line 28, in capture_optimizer_info
    result = instrumented_function_call()
  File "/home/sgrafbe/mlwhatif/mlwhatif/monkeypatching/_patch_sklearn.py", line 1498, in processing_func
    transformed_data = transformer.fit_transform(input_df, *args[1:], **kwargs)
  File "/home/sgrafbe/mlwhatif/venv/lib64/python3.9/site-packages/sklearn/preprocessing/_encoders.py", line 410, in fit_transform
    return super().fit_transform(X, y)
  File "/home/sgrafbe/mlwhatif/venv/lib64/python3.9/site-packages/sklearn/base.py", line 693, in fit_transform
    return self.fit(X, y, **fit_params).transform(X)
  File "/home/sgrafbe/mlwhatif/venv/lib64/python3.9/site-packages/sklearn/preprocessing/_encoders.py", line 385, in fit
    self._fit(X, handle_unknown=self.handle_unknown)
  File "/home/sgrafbe/mlwhatif/venv/lib64/python3.9/site-packages/sklearn/preprocessing/_encoders.py", line 74, in _fit
    X_list, n_samples, n_features = self._check_X(X)
  File "/home/sgrafbe/mlwhatif/venv/lib64/python3.9/site-packages/sklearn/preprocessing/_encoders.py", line 60, in _check_X
    Xi = check_array(Xi, ensure_2d=False, dtype=None,
  File "/home/sgrafbe/mlwhatif/venv/lib64/python3.9/site-packages/sklearn/utils/validation.py", line 72, in inner_f
    return f(**kwargs)
  File "/home/sgrafbe/mlwhatif/venv/lib64/python3.9/site-packages/sklearn/utils/validation.py", line 644, in check_array
    _assert_all_finite(array,
  File "/home/sgrafbe/mlwhatif/venv/lib64/python3.9/site-packages/sklearn/utils/validation.py", line 104, in _assert_all_finite
    raise ValueError("Input contains NaN")
ValueError: Input contains NaN
taskset -c 128-135 PROTOCOL_BUFFERS_PYTHON_IMPLEMENTATION=python python3.9 benchmarks_end_to_end.py operator_impact healthcare slow_loading featurization_2 logistic_regression
2022-09-21 16:51:25.833413: W tensorflow/stream_executor/platform/default/dso_loader.cc:64] Could not load dynamic library 'libcudart.so.11.0'; dlerror: libcudart.so.11.0: cannot open shared object file: No such file or directory; LD_LIBRARY_PATH: /home/sgrafbe/mlwhatif/venv/lib/python3.9/site-packages/cv2/../../lib64:
2022-09-21 16:51:25.833459: I tensorflow/stream_executor/cuda/cudart_stub.cc:29] Ignore above cudart dlerror if you do not have a GPU set up on your machine.
2022-09-21 16:51:27 INFO  Patching sys.argv with ['mlwhatif', 'healthcare', 'slow_loading', 'featurization_2', 'logistic_regression']
2022-09-21 16:51:27 INFO  Running instrumented original pipeline...
2022-09-21 16:51:27 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-21 16:51:27 INFO  ---RUNTIME: Importing and monkey-patching took 95.50929069519043 ms
2022-09-21 16:51:29 INFO  ---RUNTIME: Original pipeline execution took 2114.530563354492 ms (excluding imports and monkey-patching)
2022-09-21 16:51:29 INFO  Starting execution of 0 what-if analyses...
2022-09-21 16:51:29 INFO  Estimated runtime of original DAG is 1857.1696281433105ms
2022-09-21 16:51:29 INFO  Performing Multi-Query Optimization
2022-09-21 16:51:29 INFO  Estimated unoptimized what-if runtime is 0ms
2022-09-21 16:51:29 INFO  Estimated optimised what-if runtime is 0ms
2022-09-21 16:51:29 INFO  Estimated optimisation runtime saving is 0ms
2022-09-21 16:51:29 INFO  ---RUNTIME: Multi-Query Optimization took 0.45371055603027344 ms
2022-09-21 16:51:29 INFO  Executing generated plans
2022-09-21 16:51:29 INFO  ---RUNTIME: Execution took 0.021457672119140625 ms
2022-09-21 16:51:29 INFO  Done!
2022-09-21 16:51:29 INFO  # Optimization benchmark for operator_impact with args [['healthcare', 'slow_loading', 'featurization_2', 'logistic_regression']] -- repetition 1 of 7
2022-09-21 16:51:29 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-21 16:51:29 INFO  Running instrumented original pipeline...
2022-09-21 16:51:29 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-21 16:51:29 INFO  ---RUNTIME: Importing and monkey-patching took 5.157232284545898 ms
2022-09-21 16:51:31 INFO  ---RUNTIME: Original pipeline execution took 2019.031286239624 ms (excluding imports and monkey-patching)
2022-09-21 16:51:31 INFO  Starting execution of 1 what-if analyses...
2022-09-21 16:51:31 INFO  Start plan generation for analysis OperatorImpact...
2022-09-21 16:51:31 INFO  ---RUNTIME: Plan generation took 5.234956741333008 ms
2022-09-21 16:51:31 INFO  Estimated runtime of original DAG is 1794.9416637420654ms
2022-09-21 16:51:31 INFO  Performing Multi-Query Optimization
2022-09-21 16:51:31 INFO  Estimated unoptimized what-if runtime is 12602.486169749292ms
2022-09-21 16:51:31 INFO  Estimated optimised what-if runtime is 1887.1059779463142ms
2022-09-21 16:51:31 INFO  Estimated optimisation runtime saving is 10715.380191802979ms
2022-09-21 16:51:31 INFO  ---RUNTIME: Multi-Query Optimization took 24.878263473510742 ms
2022-09-21 16:51:31 INFO  Executing generated plans
2022-09-21 16:51:33 INFO  ---RUNTIME: Execution took 1902.9066562652588 ms
2022-09-21 16:51:33 INFO  Done!
2022-09-21 16:51:33 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-21 16:51:33 INFO  Running instrumented original pipeline...
2022-09-21 16:51:33 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-21 16:51:33 INFO  ---RUNTIME: Importing and monkey-patching took 6.083965301513672 ms
2022-09-21 16:51:35 INFO  ---RUNTIME: Original pipeline execution took 2174.520969390869 ms (excluding imports and monkey-patching)
2022-09-21 16:51:35 INFO  Starting execution of 1 what-if analyses...
2022-09-21 16:51:35 INFO  Start plan generation for analysis OperatorImpact...
2022-09-21 16:51:35 INFO  ---RUNTIME: Plan generation took 4.825353622436523 ms
2022-09-21 16:51:35 INFO  Estimated runtime of original DAG is 1790.1077270507812ms
2022-09-21 16:51:35 WARNING Skipping Multi-Query Optimization (instead, only applying patches)
2022-09-21 16:51:35 INFO  Estimated unoptimised what-if runtime is 12568.181136558796ms
2022-09-21 16:51:35 INFO  ---RUNTIME: Multi-Query Optimization took 9.303808212280273 ms
2022-09-21 16:51:35 INFO  Executing generated plans
2022-09-21 16:51:48 INFO  ---RUNTIME: Execution took 12799.375057220459 ms
2022-09-21 16:51:48 INFO  Done!
2022-09-21 16:51:48 INFO  # Finished -- repetition 1 of 7 
2022-09-21 16:51:48 INFO  # Optimization benchmark for operator_impact with args [['healthcare', 'slow_loading', 'featurization_2', 'logistic_regression']] -- repetition 2 of 7
2022-09-21 16:51:48 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-21 16:51:48 INFO  Running instrumented original pipeline...
2022-09-21 16:51:48 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-21 16:51:48 INFO  ---RUNTIME: Importing and monkey-patching took 5.838871002197266 ms
2022-09-21 16:51:50 INFO  ---RUNTIME: Original pipeline execution took 2012.8562450408936 ms (excluding imports and monkey-patching)
2022-09-21 16:51:50 INFO  Starting execution of 1 what-if analyses...
2022-09-21 16:51:50 INFO  Start plan generation for analysis OperatorImpact...
2022-09-21 16:51:50 INFO  ---RUNTIME: Plan generation took 4.829883575439453 ms
2022-09-21 16:51:50 INFO  Estimated runtime of original DAG is 1785.7303619384766ms
2022-09-21 16:51:50 INFO  Performing Multi-Query Optimization
2022-09-21 16:51:50 INFO  Estimated unoptimized what-if runtime is 12538.424486949527ms
2022-09-21 16:51:50 INFO  Estimated optimised what-if runtime is 1879.0392826343407ms
2022-09-21 16:51:50 INFO  Estimated optimisation runtime saving is 10659.385204315186ms
2022-09-21 16:51:50 INFO  ---RUNTIME: Multi-Query Optimization took 24.851560592651367 ms
2022-09-21 16:51:50 INFO  Executing generated plans
2022-09-21 16:51:52 INFO  ---RUNTIME: Execution took 2037.3282432556152 ms
2022-09-21 16:51:52 INFO  Done!
2022-09-21 16:51:52 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-21 16:51:52 INFO  Running instrumented original pipeline...
2022-09-21 16:51:52 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-21 16:51:52 INFO  ---RUNTIME: Importing and monkey-patching took 5.848407745361328 ms
2022-09-21 16:51:54 INFO  ---RUNTIME: Original pipeline execution took 2041.184902191162 ms (excluding imports and monkey-patching)
2022-09-21 16:51:54 INFO  Starting execution of 1 what-if analyses...
2022-09-21 16:51:54 INFO  Start plan generation for analysis OperatorImpact...
2022-09-21 16:51:54 INFO  ---RUNTIME: Plan generation took 4.590034484863281 ms
2022-09-21 16:51:54 INFO  Estimated runtime of original DAG is 1816.3998126983643ms
2022-09-21 16:51:54 WARNING Skipping Multi-Query Optimization (instead, only applying patches)
2022-09-21 16:51:54 INFO  Estimated unoptimised what-if runtime is 12752.530827193425ms
2022-09-21 16:51:54 INFO  ---RUNTIME: Multi-Query Optimization took 9.18436050415039 ms
2022-09-21 16:51:54 INFO  Executing generated plans
2022-09-21 16:52:07 INFO  ---RUNTIME: Execution took 12754.605770111084 ms
2022-09-21 16:52:07 INFO  Done!
2022-09-21 16:52:07 INFO  # Finished -- repetition 2 of 7 
2022-09-21 16:52:07 INFO  # Optimization benchmark for operator_impact with args [['healthcare', 'slow_loading', 'featurization_2', 'logistic_regression']] -- repetition 3 of 7
2022-09-21 16:52:07 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-21 16:52:07 INFO  Running instrumented original pipeline...
2022-09-21 16:52:07 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-21 16:52:07 INFO  ---RUNTIME: Importing and monkey-patching took 5.851268768310547 ms
2022-09-21 16:52:09 INFO  ---RUNTIME: Original pipeline execution took 2059.2010021209717 ms (excluding imports and monkey-patching)
2022-09-21 16:52:09 INFO  Starting execution of 1 what-if analyses...
2022-09-21 16:52:09 INFO  Start plan generation for analysis OperatorImpact...
2022-09-21 16:52:09 INFO  ---RUNTIME: Plan generation took 5.227804183959961 ms
2022-09-21 16:52:09 INFO  Estimated runtime of original DAG is 1830.7676315307617ms
2022-09-21 16:52:09 INFO  Performing Multi-Query Optimization
2022-09-21 16:52:09 INFO  Estimated unoptimized what-if runtime is 12853.56764793396ms
2022-09-21 16:52:09 INFO  Estimated optimised what-if runtime is 1923.8853931427004ms
2022-09-21 16:52:09 INFO  Estimated optimisation runtime saving is 10929.68225479126ms
2022-09-21 16:52:09 INFO  ---RUNTIME: Multi-Query Optimization took 24.604082107543945 ms
2022-09-21 16:52:09 INFO  Executing generated plans
2022-09-21 16:52:11 INFO  ---RUNTIME: Execution took 1895.8392143249512 ms
2022-09-21 16:52:11 INFO  Done!
2022-09-21 16:52:11 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-21 16:52:11 INFO  Running instrumented original pipeline...
2022-09-21 16:52:11 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-21 16:52:11 INFO  ---RUNTIME: Importing and monkey-patching took 5.495309829711914 ms
2022-09-21 16:52:13 INFO  ---RUNTIME: Original pipeline execution took 2028.733730316162 ms (excluding imports and monkey-patching)
2022-09-21 16:52:13 INFO  Starting execution of 1 what-if analyses...
2022-09-21 16:52:13 INFO  Start plan generation for analysis OperatorImpact...
2022-09-21 16:52:13 INFO  ---RUNTIME: Plan generation took 4.621982574462891 ms
2022-09-21 16:52:13 INFO  Estimated runtime of original DAG is 1803.8926124572754ms
2022-09-21 16:52:13 WARNING Skipping Multi-Query Optimization (instead, only applying patches)
2022-09-21 16:52:13 INFO  Estimated unoptimised what-if runtime is 12664.482693014474ms
2022-09-21 16:52:13 INFO  ---RUNTIME: Multi-Query Optimization took 9.033203125 ms
2022-09-21 16:52:13 INFO  Executing generated plans
2022-09-21 16:52:26 INFO  ---RUNTIME: Execution took 12848.078489303589 ms
2022-09-21 16:52:26 INFO  Done!
2022-09-21 16:52:26 INFO  # Finished -- repetition 3 of 7 
2022-09-21 16:52:26 INFO  # Optimization benchmark for operator_impact with args [['healthcare', 'slow_loading', 'featurization_2', 'logistic_regression']] -- repetition 4 of 7
2022-09-21 16:52:26 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-21 16:52:26 INFO  Running instrumented original pipeline...
2022-09-21 16:52:26 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-21 16:52:26 INFO  ---RUNTIME: Importing and monkey-patching took 5.91588020324707 ms
2022-09-21 16:52:28 INFO  ---RUNTIME: Original pipeline execution took 2018.143892288208 ms (excluding imports and monkey-patching)
2022-09-21 16:52:28 INFO  Starting execution of 1 what-if analyses...
2022-09-21 16:52:28 INFO  Start plan generation for analysis OperatorImpact...
2022-09-21 16:52:28 INFO  ---RUNTIME: Plan generation took 4.630565643310547 ms
2022-09-21 16:52:28 INFO  Estimated runtime of original DAG is 1791.0223007202148ms
2022-09-21 16:52:28 INFO  Performing Multi-Query Optimization
2022-09-21 16:52:28 INFO  Estimated unoptimized what-if runtime is 12574.18640317588ms
2022-09-21 16:52:28 INFO  Estimated optimised what-if runtime is 1881.187755486061ms
2022-09-21 16:52:28 INFO  Estimated optimisation runtime saving is 10692.99864768982ms
2022-09-21 16:52:28 INFO  ---RUNTIME: Multi-Query Optimization took 24.35755729675293 ms
2022-09-21 16:52:28 INFO  Executing generated plans
2022-09-21 16:52:29 INFO  ---RUNTIME: Execution took 1893.1639194488525 ms
2022-09-21 16:52:29 INFO  Done!
2022-09-21 16:52:29 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-21 16:52:29 INFO  Running instrumented original pipeline...
2022-09-21 16:52:29 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-21 16:52:30 INFO  ---RUNTIME: Importing and monkey-patching took 5.718231201171875 ms
2022-09-21 16:52:31 INFO  ---RUNTIME: Original pipeline execution took 2010.0915431976318 ms (excluding imports and monkey-patching)
2022-09-21 16:52:31 INFO  Starting execution of 1 what-if analyses...
2022-09-21 16:52:31 INFO  Start plan generation for analysis OperatorImpact...
2022-09-21 16:52:31 INFO  ---RUNTIME: Plan generation took 4.64940071105957 ms
2022-09-21 16:52:31 INFO  Estimated runtime of original DAG is 1785.154104232788ms
2022-09-21 16:52:31 WARNING Skipping Multi-Query Optimization (instead, only applying patches)
2022-09-21 16:52:31 INFO  Estimated unoptimised what-if runtime is 12533.002931496192ms
2022-09-21 16:52:31 INFO  ---RUNTIME: Multi-Query Optimization took 9.516716003417969 ms
2022-09-21 16:52:31 INFO  Executing generated plans
2022-09-21 16:52:44 INFO  ---RUNTIME: Execution took 12779.200553894043 ms
2022-09-21 16:52:44 INFO  Done!
2022-09-21 16:52:44 INFO  # Finished -- repetition 4 of 7 
2022-09-21 16:52:44 INFO  # Optimization benchmark for operator_impact with args [['healthcare', 'slow_loading', 'featurization_2', 'logistic_regression']] -- repetition 5 of 7
2022-09-21 16:52:44 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-21 16:52:44 INFO  Running instrumented original pipeline...
2022-09-21 16:52:44 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-21 16:52:44 INFO  ---RUNTIME: Importing and monkey-patching took 5.549192428588867 ms
2022-09-21 16:52:46 INFO  ---RUNTIME: Original pipeline execution took 2002.6628971099854 ms (excluding imports and monkey-patching)
2022-09-21 16:52:46 INFO  Starting execution of 1 what-if analyses...
2022-09-21 16:52:46 INFO  Start plan generation for analysis OperatorImpact...
2022-09-21 16:52:46 INFO  ---RUNTIME: Plan generation took 5.611419677734375 ms
2022-09-21 16:52:46 INFO  Estimated runtime of original DAG is 1768.8934803009033ms
2022-09-21 16:52:46 INFO  Performing Multi-Query Optimization
2022-09-21 16:52:46 INFO  Estimated unoptimized what-if runtime is 12423.629114545625ms
2022-09-21 16:52:46 INFO  Estimated optimised what-if runtime is 1869.5865368020943ms
2022-09-21 16:52:46 INFO  Estimated optimisation runtime saving is 10554.04257774353ms
2022-09-21 16:52:46 INFO  ---RUNTIME: Multi-Query Optimization took 27.89139747619629 ms
2022-09-21 16:52:46 INFO  Executing generated plans
2022-09-21 16:52:48 INFO  ---RUNTIME: Execution took 1893.7413692474365 ms
2022-09-21 16:52:48 INFO  Done!
2022-09-21 16:52:48 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-21 16:52:48 INFO  Running instrumented original pipeline...
2022-09-21 16:52:48 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-21 16:52:48 INFO  ---RUNTIME: Importing and monkey-patching took 6.275415420532227 ms
2022-09-21 16:52:50 INFO  ---RUNTIME: Original pipeline execution took 2069.485902786255 ms (excluding imports and monkey-patching)
2022-09-21 16:52:50 INFO  Starting execution of 1 what-if analyses...
2022-09-21 16:52:50 INFO  Start plan generation for analysis OperatorImpact...
2022-09-21 16:52:50 INFO  ---RUNTIME: Plan generation took 5.22613525390625 ms
2022-09-21 16:52:50 INFO  Estimated runtime of original DAG is 1834.9881172180176ms
2022-09-21 16:52:50 WARNING Skipping Multi-Query Optimization (instead, only applying patches)
2022-09-21 16:52:50 INFO  Estimated unoptimised what-if runtime is 12882.983382816972ms
2022-09-21 16:52:50 INFO  ---RUNTIME: Multi-Query Optimization took 9.258747100830078 ms
2022-09-21 16:52:50 INFO  Executing generated plans
2022-09-21 16:53:03 INFO  ---RUNTIME: Execution took 12676.630973815918 ms
2022-09-21 16:53:03 INFO  Done!
2022-09-21 16:53:03 INFO  # Finished -- repetition 5 of 7 
2022-09-21 16:53:03 INFO  # Optimization benchmark for operator_impact with args [['healthcare', 'slow_loading', 'featurization_2', 'logistic_regression']] -- repetition 6 of 7
2022-09-21 16:53:03 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-21 16:53:03 INFO  Running instrumented original pipeline...
2022-09-21 16:53:03 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-21 16:53:03 INFO  ---RUNTIME: Importing and monkey-patching took 5.604982376098633 ms
2022-09-21 16:53:05 INFO  ---RUNTIME: Original pipeline execution took 2046.642780303955 ms (excluding imports and monkey-patching)
2022-09-21 16:53:05 INFO  Starting execution of 1 what-if analyses...
2022-09-21 16:53:05 INFO  Start plan generation for analysis OperatorImpact...
2022-09-21 16:53:05 INFO  ---RUNTIME: Plan generation took 4.657983779907227 ms
2022-09-21 16:53:05 INFO  Estimated runtime of original DAG is 1821.0086822509766ms
2022-09-21 16:53:05 INFO  Performing Multi-Query Optimization
2022-09-21 16:53:05 INFO  Estimated unoptimized what-if runtime is 12784.314598708317ms
2022-09-21 16:53:05 INFO  Estimated optimised what-if runtime is 1911.7872377921794ms
2022-09-21 16:53:05 INFO  Estimated optimisation runtime saving is 10872.527360916138ms
2022-09-21 16:53:05 INFO  ---RUNTIME: Multi-Query Optimization took 24.306535720825195 ms
2022-09-21 16:53:05 INFO  Executing generated plans
2022-09-21 16:53:07 INFO  ---RUNTIME: Execution took 1882.833480834961 ms
2022-09-21 16:53:07 INFO  Done!
2022-09-21 16:53:07 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-21 16:53:07 INFO  Running instrumented original pipeline...
2022-09-21 16:53:07 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-21 16:53:07 INFO  ---RUNTIME: Importing and monkey-patching took 5.882501602172852 ms
2022-09-21 16:53:09 INFO  ---RUNTIME: Original pipeline execution took 2201.066732406616 ms (excluding imports and monkey-patching)
2022-09-21 16:53:09 INFO  Starting execution of 1 what-if analyses...
2022-09-21 16:53:09 INFO  Start plan generation for analysis OperatorImpact...
2022-09-21 16:53:09 INFO  ---RUNTIME: Plan generation took 4.659414291381836 ms
2022-09-21 16:53:09 INFO  Estimated runtime of original DAG is 1767.9619789123535ms
2022-09-21 16:53:09 WARNING Skipping Multi-Query Optimization (instead, only applying patches)
2022-09-21 16:53:09 INFO  Estimated unoptimised what-if runtime is 12412.814185537141ms
2022-09-21 16:53:09 INFO  ---RUNTIME: Multi-Query Optimization took 9.127378463745117 ms
2022-09-21 16:53:09 INFO  Executing generated plans
2022-09-21 16:53:22 INFO  ---RUNTIME: Execution took 12505.38444519043 ms
2022-09-21 16:53:22 INFO  Done!
2022-09-21 16:53:22 INFO  # Finished -- repetition 6 of 7 
2022-09-21 16:53:22 INFO  # Optimization benchmark for operator_impact with args [['healthcare', 'slow_loading', 'featurization_2', 'logistic_regression']] -- repetition 7 of 7
2022-09-21 16:53:22 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-21 16:53:22 INFO  Running instrumented original pipeline...
2022-09-21 16:53:22 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-21 16:53:22 INFO  ---RUNTIME: Importing and monkey-patching took 5.505561828613281 ms
2022-09-21 16:53:24 INFO  ---RUNTIME: Original pipeline execution took 1982.3698997497559 ms (excluding imports and monkey-patching)
2022-09-21 16:53:24 INFO  Starting execution of 1 what-if analyses...
2022-09-21 16:53:24 INFO  Start plan generation for analysis OperatorImpact...
2022-09-21 16:53:24 INFO  ---RUNTIME: Plan generation took 4.623889923095703 ms
2022-09-21 16:53:24 INFO  Estimated runtime of original DAG is 1756.8120956420898ms
2022-09-21 16:53:24 INFO  Performing Multi-Query Optimization
2022-09-21 16:53:24 INFO  Estimated unoptimized what-if runtime is 12334.607038826778ms
2022-09-21 16:53:24 INFO  Estimated optimised what-if runtime is 1846.7249015281939ms
2022-09-21 16:53:24 INFO  Estimated optimisation runtime saving is 10487.882137298584ms
2022-09-21 16:53:24 INFO  ---RUNTIME: Multi-Query Optimization took 24.46150779724121 ms
2022-09-21 16:53:24 INFO  Executing generated plans
2022-09-21 16:53:26 INFO  ---RUNTIME: Execution took 1866.0311698913574 ms
2022-09-21 16:53:26 INFO  Done!
2022-09-21 16:53:26 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-21 16:53:26 INFO  Running instrumented original pipeline...
2022-09-21 16:53:26 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-21 16:53:26 INFO  ---RUNTIME: Importing and monkey-patching took 5.556344985961914 ms
2022-09-21 16:53:28 INFO  ---RUNTIME: Original pipeline execution took 2013.6630535125732 ms (excluding imports and monkey-patching)
2022-09-21 16:53:28 INFO  Starting execution of 1 what-if analyses...
2022-09-21 16:53:28 INFO  Start plan generation for analysis OperatorImpact...
2022-09-21 16:53:28 INFO  ---RUNTIME: Plan generation took 4.858493804931641 ms
2022-09-21 16:53:28 INFO  Estimated runtime of original DAG is 1784.7020626068115ms
2022-09-21 16:53:28 WARNING Skipping Multi-Query Optimization (instead, only applying patches)
2022-09-21 16:53:28 INFO  Estimated unoptimised what-if runtime is 12530.751550608667ms
2022-09-21 16:53:28 INFO  ---RUNTIME: Multi-Query Optimization took 9.526491165161133 ms
2022-09-21 16:53:28 INFO  Executing generated plans
2022-09-21 16:53:40 INFO  ---RUNTIME: Execution took 12666.743516921997 ms
2022-09-21 16:53:40 INFO  Done!
2022-09-21 16:53:40 INFO  # Finished -- repetition 7 of 7 
2022-09-21 16:53:40 INFO  # Final results after all repetitions
2022-09-21 16:53:40 INFO     repetition  ... no_opt_what_if_execution_combined_model_training
0           0  ...                                         9.089708
1           1  ...                                         9.101868
2           2  ...                                         9.168863
3           3  ...                                         8.907080
4           4  ...                                         8.851767
5           5  ...                                         9.035826
6           6  ...                                         9.083748

[7 rows x 26 columns]
taskset -c 128-135 PROTOCOL_BUFFERS_PYTHON_IMPLEMENTATION=python python3.9 benchmarks_end_to_end.py operator_impact healthcare slow_loading featurization_2 xgboost
2022-09-21 16:53:42.716486: W tensorflow/stream_executor/platform/default/dso_loader.cc:64] Could not load dynamic library 'libcudart.so.11.0'; dlerror: libcudart.so.11.0: cannot open shared object file: No such file or directory; LD_LIBRARY_PATH: /home/sgrafbe/mlwhatif/venv/lib/python3.9/site-packages/cv2/../../lib64:
2022-09-21 16:53:42.716529: I tensorflow/stream_executor/cuda/cudart_stub.cc:29] Ignore above cudart dlerror if you do not have a GPU set up on your machine.
2022-09-21 16:53:43 INFO  Patching sys.argv with ['mlwhatif', 'healthcare', 'slow_loading', 'featurization_2', 'xgboost']
2022-09-21 16:53:43 INFO  Running instrumented original pipeline...
2022-09-21 16:53:44 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-21 16:53:44 INFO  ---RUNTIME: Importing and monkey-patching took 95.27254104614258 ms
2022-09-21 16:53:46 INFO  ---RUNTIME: Original pipeline execution took 2649.829864501953 ms (excluding imports and monkey-patching)
2022-09-21 16:53:46 INFO  Starting execution of 0 what-if analyses...
2022-09-21 16:53:46 INFO  Estimated runtime of original DAG is 2392.4877643585205ms
2022-09-21 16:53:46 INFO  Performing Multi-Query Optimization
2022-09-21 16:53:46 INFO  Estimated unoptimized what-if runtime is 0ms
2022-09-21 16:53:46 INFO  Estimated optimised what-if runtime is 0ms
2022-09-21 16:53:46 INFO  Estimated optimisation runtime saving is 0ms
2022-09-21 16:53:46 INFO  ---RUNTIME: Multi-Query Optimization took 0.4761219024658203 ms
2022-09-21 16:53:46 INFO  Executing generated plans
2022-09-21 16:53:46 INFO  ---RUNTIME: Execution took 0.022411346435546875 ms
2022-09-21 16:53:46 INFO  Done!
2022-09-21 16:53:46 INFO  # Optimization benchmark for operator_impact with args [['healthcare', 'slow_loading', 'featurization_2', 'xgboost']] -- repetition 1 of 7
2022-09-21 16:53:46 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-21 16:53:46 INFO  Running instrumented original pipeline...
2022-09-21 16:53:46 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-21 16:53:46 INFO  ---RUNTIME: Importing and monkey-patching took 5.260944366455078 ms
2022-09-21 16:53:48 INFO  ---RUNTIME: Original pipeline execution took 2185.523271560669 ms (excluding imports and monkey-patching)
2022-09-21 16:53:48 INFO  Starting execution of 1 what-if analyses...
2022-09-21 16:53:48 INFO  Start plan generation for analysis OperatorImpact...
2022-09-21 16:53:48 INFO  ---RUNTIME: Plan generation took 5.475521087646484 ms
2022-09-21 16:53:48 INFO  Estimated runtime of original DAG is 1956.1750888824463ms
2022-09-21 16:53:48 INFO  Performing Multi-Query Optimization
2022-09-21 16:53:48 INFO  Estimated unoptimized what-if runtime is 14115.863958720503ms
2022-09-21 16:53:48 INFO  Estimated optimised what-if runtime is 3550.73253286296ms
2022-09-21 16:53:48 INFO  Estimated optimisation runtime saving is 10565.131425857544ms
2022-09-21 16:53:48 INFO  ---RUNTIME: Multi-Query Optimization took 24.8873233795166 ms
2022-09-21 16:53:48 INFO  Executing generated plans
2022-09-21 16:53:52 INFO  ---RUNTIME: Execution took 3163.4533405303955 ms
2022-09-21 16:53:52 INFO  Done!
2022-09-21 16:53:52 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-21 16:53:52 INFO  Running instrumented original pipeline...
2022-09-21 16:53:52 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-21 16:53:52 INFO  ---RUNTIME: Importing and monkey-patching took 6.273508071899414 ms
2022-09-21 16:53:54 INFO  ---RUNTIME: Original pipeline execution took 2345.3261852264404 ms (excluding imports and monkey-patching)
2022-09-21 16:53:54 INFO  Starting execution of 1 what-if analyses...
2022-09-21 16:53:54 INFO  Start plan generation for analysis OperatorImpact...
2022-09-21 16:53:54 INFO  ---RUNTIME: Plan generation took 5.003929138183594 ms
2022-09-21 16:53:54 INFO  Estimated runtime of original DAG is 1954.9667835235596ms
2022-09-21 16:53:54 WARNING Skipping Multi-Query Optimization (instead, only applying patches)
2022-09-21 16:53:54 INFO  Estimated unoptimised what-if runtime is 14109.585474277364ms
2022-09-21 16:53:54 INFO  ---RUNTIME: Multi-Query Optimization took 9.169816970825195 ms
2022-09-21 16:53:54 INFO  Executing generated plans
2022-09-21 16:54:08 INFO  ---RUNTIME: Execution took 13798.185586929321 ms
2022-09-21 16:54:08 INFO  Done!
2022-09-21 16:54:08 INFO  # Finished -- repetition 1 of 7 
2022-09-21 16:54:08 INFO  # Optimization benchmark for operator_impact with args [['healthcare', 'slow_loading', 'featurization_2', 'xgboost']] -- repetition 2 of 7
2022-09-21 16:54:08 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-21 16:54:08 INFO  Running instrumented original pipeline...
2022-09-21 16:54:08 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-21 16:54:08 INFO  ---RUNTIME: Importing and monkey-patching took 6.028175354003906 ms
2022-09-21 16:54:10 INFO  ---RUNTIME: Original pipeline execution took 2165.703535079956 ms (excluding imports and monkey-patching)
2022-09-21 16:54:10 INFO  Starting execution of 1 what-if analyses...
2022-09-21 16:54:10 INFO  Start plan generation for analysis OperatorImpact...
2022-09-21 16:54:10 INFO  ---RUNTIME: Plan generation took 4.787921905517578 ms
2022-09-21 16:54:10 INFO  Estimated runtime of original DAG is 1936.8278980255127ms
2022-09-21 16:54:10 INFO  Performing Multi-Query Optimization
2022-09-21 16:54:10 INFO  Estimated unoptimized what-if runtime is 13976.61946148708ms
2022-09-21 16:54:10 INFO  Estimated optimised what-if runtime is 3519.010284851338ms
2022-09-21 16:54:10 INFO  Estimated optimisation runtime saving is 10457.609176635742ms
2022-09-21 16:54:10 INFO  ---RUNTIME: Multi-Query Optimization took 24.564027786254883 ms
2022-09-21 16:54:10 INFO  Executing generated plans
2022-09-21 16:54:13 INFO  ---RUNTIME: Execution took 3204.416513442993 ms
2022-09-21 16:54:13 INFO  Done!
2022-09-21 16:54:13 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-21 16:54:13 INFO  Running instrumented original pipeline...
2022-09-21 16:54:13 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-21 16:54:13 INFO  ---RUNTIME: Importing and monkey-patching took 5.867481231689453 ms
2022-09-21 16:54:15 INFO  ---RUNTIME: Original pipeline execution took 2192.8906440734863 ms (excluding imports and monkey-patching)
2022-09-21 16:54:15 INFO  Starting execution of 1 what-if analyses...
2022-09-21 16:54:15 INFO  Start plan generation for analysis OperatorImpact...
2022-09-21 16:54:15 INFO  ---RUNTIME: Plan generation took 4.918813705444336 ms
2022-09-21 16:54:15 INFO  Estimated runtime of original DAG is 1962.536096572876ms
2022-09-21 16:54:15 WARNING Skipping Multi-Query Optimization (instead, only applying patches)
2022-09-21 16:54:15 INFO  Estimated unoptimised what-if runtime is 14155.65697324687ms
2022-09-21 16:54:15 INFO  ---RUNTIME: Multi-Query Optimization took 10.208845138549805 ms
2022-09-21 16:54:15 INFO  Executing generated plans
2022-09-21 16:54:29 INFO  ---RUNTIME: Execution took 13883.556604385376 ms
2022-09-21 16:54:29 INFO  Done!
2022-09-21 16:54:29 INFO  # Finished -- repetition 2 of 7 
2022-09-21 16:54:29 INFO  # Optimization benchmark for operator_impact with args [['healthcare', 'slow_loading', 'featurization_2', 'xgboost']] -- repetition 3 of 7
2022-09-21 16:54:29 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-21 16:54:29 INFO  Running instrumented original pipeline...
2022-09-21 16:54:29 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-21 16:54:29 INFO  ---RUNTIME: Importing and monkey-patching took 6.071805953979492 ms
2022-09-21 16:54:31 INFO  ---RUNTIME: Original pipeline execution took 2184.596300125122 ms (excluding imports and monkey-patching)
2022-09-21 16:54:31 INFO  Starting execution of 1 what-if analyses...
2022-09-21 16:54:31 INFO  Start plan generation for analysis OperatorImpact...
2022-09-21 16:54:31 INFO  ---RUNTIME: Plan generation took 5.126237869262695 ms
2022-09-21 16:54:31 INFO  Estimated runtime of original DAG is 1958.942174911499ms
2022-09-21 16:54:31 INFO  Performing Multi-Query Optimization
2022-09-21 16:54:31 INFO  Estimated unoptimized what-if runtime is 14131.362440668303ms
2022-09-21 16:54:31 INFO  Estimated optimised what-if runtime is 3542.169334970671ms
2022-09-21 16:54:31 INFO  Estimated optimisation runtime saving is 10589.193105697632ms
2022-09-21 16:54:31 INFO  ---RUNTIME: Multi-Query Optimization took 24.333953857421875 ms
2022-09-21 16:54:31 INFO  Executing generated plans
2022-09-21 16:54:35 INFO  ---RUNTIME: Execution took 3136.6636753082275 ms
2022-09-21 16:54:35 INFO  Done!
2022-09-21 16:54:35 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-21 16:54:35 INFO  Running instrumented original pipeline...
2022-09-21 16:54:35 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-21 16:54:35 INFO  ---RUNTIME: Importing and monkey-patching took 5.5713653564453125 ms
2022-09-21 16:54:37 INFO  ---RUNTIME: Original pipeline execution took 2182.4820041656494 ms (excluding imports and monkey-patching)
2022-09-21 16:54:37 INFO  Starting execution of 1 what-if analyses...
2022-09-21 16:54:37 INFO  Start plan generation for analysis OperatorImpact...
2022-09-21 16:54:37 INFO  ---RUNTIME: Plan generation took 4.683494567871094 ms
2022-09-21 16:54:37 INFO  Estimated runtime of original DAG is 1951.0509967803955ms
2022-09-21 16:54:37 WARNING Skipping Multi-Query Optimization (instead, only applying patches)
2022-09-21 16:54:37 INFO  Estimated unoptimised what-if runtime is 14079.682595154334ms
2022-09-21 16:54:37 INFO  ---RUNTIME: Multi-Query Optimization took 9.220361709594727 ms
2022-09-21 16:54:37 INFO  Executing generated plans
2022-09-21 16:54:51 INFO  ---RUNTIME: Execution took 14078.760623931885 ms
2022-09-21 16:54:51 INFO  Done!
2022-09-21 16:54:51 INFO  # Finished -- repetition 3 of 7 
2022-09-21 16:54:51 INFO  # Optimization benchmark for operator_impact with args [['healthcare', 'slow_loading', 'featurization_2', 'xgboost']] -- repetition 4 of 7
2022-09-21 16:54:51 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-21 16:54:51 INFO  Running instrumented original pipeline...
2022-09-21 16:54:51 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-21 16:54:51 INFO  ---RUNTIME: Importing and monkey-patching took 5.853414535522461 ms
2022-09-21 16:54:53 INFO  ---RUNTIME: Original pipeline execution took 2181.908369064331 ms (excluding imports and monkey-patching)
2022-09-21 16:54:53 INFO  Starting execution of 1 what-if analyses...
2022-09-21 16:54:53 INFO  Start plan generation for analysis OperatorImpact...
2022-09-21 16:54:53 INFO  ---RUNTIME: Plan generation took 4.788875579833984 ms
2022-09-21 16:54:53 INFO  Estimated runtime of original DAG is 1949.3937492370605ms
2022-09-21 16:54:53 INFO  Performing Multi-Query Optimization
2022-09-21 16:54:53 INFO  Estimated unoptimized what-if runtime is 14066.154414209826ms
2022-09-21 16:54:53 INFO  Estimated optimised what-if runtime is 3538.288765940173ms
2022-09-21 16:54:53 INFO  Estimated optimisation runtime saving is 10527.865648269653ms
2022-09-21 16:54:53 INFO  ---RUNTIME: Multi-Query Optimization took 24.792194366455078 ms
2022-09-21 16:54:53 INFO  Executing generated plans
2022-09-21 16:54:56 INFO  ---RUNTIME: Execution took 3136.033535003662 ms
2022-09-21 16:54:56 INFO  Done!
2022-09-21 16:54:56 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-21 16:54:56 INFO  Running instrumented original pipeline...
2022-09-21 16:54:56 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-21 16:54:56 INFO  ---RUNTIME: Importing and monkey-patching took 5.755424499511719 ms
2022-09-21 16:54:58 INFO  ---RUNTIME: Original pipeline execution took 2189.2950534820557 ms (excluding imports and monkey-patching)
2022-09-21 16:54:58 INFO  Starting execution of 1 what-if analyses...
2022-09-21 16:54:58 INFO  Start plan generation for analysis OperatorImpact...
2022-09-21 16:54:58 INFO  ---RUNTIME: Plan generation took 4.8046112060546875 ms
2022-09-21 16:54:58 INFO  Estimated runtime of original DAG is 1951.5705108642578ms
2022-09-21 16:54:58 WARNING Skipping Multi-Query Optimization (instead, only applying patches)
2022-09-21 16:54:58 INFO  Estimated unoptimised what-if runtime is 14084.04043625141ms
2022-09-21 16:54:58 INFO  ---RUNTIME: Multi-Query Optimization took 9.550094604492188 ms
2022-09-21 16:54:58 INFO  Executing generated plans
2022-09-21 16:55:12 INFO  ---RUNTIME: Execution took 13781.399965286255 ms
2022-09-21 16:55:12 INFO  Done!
2022-09-21 16:55:12 INFO  # Finished -- repetition 4 of 7 
2022-09-21 16:55:12 INFO  # Optimization benchmark for operator_impact with args [['healthcare', 'slow_loading', 'featurization_2', 'xgboost']] -- repetition 5 of 7
2022-09-21 16:55:12 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-21 16:55:12 INFO  Running instrumented original pipeline...
2022-09-21 16:55:12 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-21 16:55:12 INFO  ---RUNTIME: Importing and monkey-patching took 6.143093109130859 ms
2022-09-21 16:55:14 INFO  ---RUNTIME: Original pipeline execution took 2168.334484100342 ms (excluding imports and monkey-patching)
2022-09-21 16:55:14 INFO  Starting execution of 1 what-if analyses...
2022-09-21 16:55:14 INFO  Start plan generation for analysis OperatorImpact...
2022-09-21 16:55:14 INFO  ---RUNTIME: Plan generation took 4.85539436340332 ms
2022-09-21 16:55:14 INFO  Estimated runtime of original DAG is 1938.222885131836ms
2022-09-21 16:55:14 INFO  Performing Multi-Query Optimization
2022-09-21 16:55:14 INFO  Estimated unoptimized what-if runtime is 13986.15093477841ms
2022-09-21 16:55:14 INFO  Estimated optimised what-if runtime is 3520.487024866302ms
2022-09-21 16:55:14 INFO  Estimated optimisation runtime saving is 10465.66390991211ms
2022-09-21 16:55:14 INFO  ---RUNTIME: Multi-Query Optimization took 24.829387664794922 ms
2022-09-21 16:55:14 INFO  Executing generated plans
2022-09-21 16:55:18 INFO  ---RUNTIME: Execution took 3228.602409362793 ms
2022-09-21 16:55:18 INFO  Done!
2022-09-21 16:55:18 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-21 16:55:18 INFO  Running instrumented original pipeline...
2022-09-21 16:55:18 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-21 16:55:18 INFO  ---RUNTIME: Importing and monkey-patching took 5.903005599975586 ms
2022-09-21 16:55:20 INFO  ---RUNTIME: Original pipeline execution took 2177.6201725006104 ms (excluding imports and monkey-patching)
2022-09-21 16:55:20 INFO  Starting execution of 1 what-if analyses...
2022-09-21 16:55:20 INFO  Start plan generation for analysis OperatorImpact...
2022-09-21 16:55:20 INFO  ---RUNTIME: Plan generation took 5.028724670410156 ms
2022-09-21 16:55:20 INFO  Estimated runtime of original DAG is 1947.2100734710693ms
2022-09-21 16:55:20 WARNING Skipping Multi-Query Optimization (instead, only applying patches)
2022-09-21 16:55:20 INFO  Estimated unoptimised what-if runtime is 14049.710612461484ms
2022-09-21 16:55:20 INFO  ---RUNTIME: Multi-Query Optimization took 9.167671203613281 ms
2022-09-21 16:55:20 INFO  Executing generated plans
2022-09-21 16:55:34 INFO  ---RUNTIME: Execution took 13933.19845199585 ms
2022-09-21 16:55:34 INFO  Done!
2022-09-21 16:55:34 INFO  # Finished -- repetition 5 of 7 
2022-09-21 16:55:34 INFO  # Optimization benchmark for operator_impact with args [['healthcare', 'slow_loading', 'featurization_2', 'xgboost']] -- repetition 6 of 7
2022-09-21 16:55:34 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-21 16:55:34 INFO  Running instrumented original pipeline...
2022-09-21 16:55:34 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-21 16:55:34 INFO  ---RUNTIME: Importing and monkey-patching took 5.818367004394531 ms
2022-09-21 16:55:36 INFO  ---RUNTIME: Original pipeline execution took 2174.417018890381 ms (excluding imports and monkey-patching)
2022-09-21 16:55:36 INFO  Starting execution of 1 what-if analyses...
2022-09-21 16:55:36 INFO  Start plan generation for analysis OperatorImpact...
2022-09-21 16:55:36 INFO  ---RUNTIME: Plan generation took 4.70280647277832 ms
2022-09-21 16:55:36 INFO  Estimated runtime of original DAG is 1944.5242881774902ms
2022-09-21 16:55:36 INFO  Performing Multi-Query Optimization
2022-09-21 16:55:36 INFO  Estimated unoptimized what-if runtime is 14027.741479051523ms
2022-09-21 16:55:36 INFO  Estimated optimised what-if runtime is 3517.775820863658ms
2022-09-21 16:55:36 INFO  Estimated optimisation runtime saving is 10509.965658187866ms
2022-09-21 16:55:36 INFO  ---RUNTIME: Multi-Query Optimization took 24.353981018066406 ms
2022-09-21 16:55:36 INFO  Executing generated plans
2022-09-21 16:55:39 INFO  ---RUNTIME: Execution took 3154.82234954834 ms
2022-09-21 16:55:39 INFO  Done!
2022-09-21 16:55:39 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-21 16:55:39 INFO  Running instrumented original pipeline...
2022-09-21 16:55:39 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-21 16:55:39 INFO  ---RUNTIME: Importing and monkey-patching took 5.9909820556640625 ms
2022-09-21 16:55:42 INFO  ---RUNTIME: Original pipeline execution took 2403.090238571167 ms (excluding imports and monkey-patching)
2022-09-21 16:55:42 INFO  Starting execution of 1 what-if analyses...
2022-09-21 16:55:42 INFO  Start plan generation for analysis OperatorImpact...
2022-09-21 16:55:42 INFO  ---RUNTIME: Plan generation took 4.668235778808594 ms
2022-09-21 16:55:42 INFO  Estimated runtime of original DAG is 1961.165189743042ms
2022-09-21 16:55:42 WARNING Skipping Multi-Query Optimization (instead, only applying patches)
2022-09-21 16:55:42 INFO  Estimated unoptimised what-if runtime is 14147.671817088949ms
2022-09-21 16:55:42 INFO  ---RUNTIME: Multi-Query Optimization took 9.26518440246582 ms
2022-09-21 16:55:42 INFO  Executing generated plans
2022-09-21 16:55:55 INFO  ---RUNTIME: Execution took 13870.755672454834 ms
2022-09-21 16:55:56 INFO  Done!
2022-09-21 16:55:56 INFO  # Finished -- repetition 6 of 7 
2022-09-21 16:55:56 INFO  # Optimization benchmark for operator_impact with args [['healthcare', 'slow_loading', 'featurization_2', 'xgboost']] -- repetition 7 of 7
2022-09-21 16:55:56 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-21 16:55:56 INFO  Running instrumented original pipeline...
2022-09-21 16:55:56 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-21 16:55:56 INFO  ---RUNTIME: Importing and monkey-patching took 5.946159362792969 ms
2022-09-21 16:55:58 INFO  ---RUNTIME: Original pipeline execution took 2186.6297721862793 ms (excluding imports and monkey-patching)
2022-09-21 16:55:58 INFO  Starting execution of 1 what-if analyses...
2022-09-21 16:55:58 INFO  Start plan generation for analysis OperatorImpact...
2022-09-21 16:55:58 INFO  ---RUNTIME: Plan generation took 4.740238189697266 ms
2022-09-21 16:55:58 INFO  Estimated runtime of original DAG is 1955.9648036956787ms
2022-09-21 16:55:58 INFO  Performing Multi-Query Optimization
2022-09-21 16:55:58 INFO  Estimated unoptimized what-if runtime is 14110.430846543148ms
2022-09-21 16:55:58 INFO  Estimated optimised what-if runtime is 3538.949380249812ms
2022-09-21 16:55:58 INFO  Estimated optimisation runtime saving is 10571.481466293335ms
2022-09-21 16:55:58 INFO  ---RUNTIME: Multi-Query Optimization took 24.94525909423828 ms
2022-09-21 16:55:58 INFO  Executing generated plans
2022-09-21 16:56:01 INFO  ---RUNTIME: Execution took 3147.5040912628174 ms
2022-09-21 16:56:01 INFO  Done!
2022-09-21 16:56:01 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-21 16:56:01 INFO  Running instrumented original pipeline...
2022-09-21 16:56:01 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-21 16:56:01 INFO  ---RUNTIME: Importing and monkey-patching took 5.604982376098633 ms
2022-09-21 16:56:03 INFO  ---RUNTIME: Original pipeline execution took 2175.5998134613037 ms (excluding imports and monkey-patching)
2022-09-21 16:56:03 INFO  Starting execution of 1 what-if analyses...
2022-09-21 16:56:03 INFO  Start plan generation for analysis OperatorImpact...
2022-09-21 16:56:03 INFO  ---RUNTIME: Plan generation took 4.649877548217773 ms
2022-09-21 16:56:03 INFO  Estimated runtime of original DAG is 1945.9936618804932ms
2022-09-21 16:56:03 WARNING Skipping Multi-Query Optimization (instead, only applying patches)
2022-09-21 16:56:03 INFO  Estimated unoptimised what-if runtime is 14039.267137132842ms
2022-09-21 16:56:03 INFO  ---RUNTIME: Multi-Query Optimization took 9.50765609741211 ms
2022-09-21 16:56:03 INFO  Executing generated plans
2022-09-21 16:56:17 INFO  ---RUNTIME: Execution took 13842.14472770691 ms
2022-09-21 16:56:17 INFO  Done!
2022-09-21 16:56:17 INFO  # Finished -- repetition 7 of 7 
2022-09-21 16:56:17 INFO  # Final results after all repetitions
2022-09-21 16:56:17 INFO     repetition  ... no_opt_what_if_execution_combined_model_training
0           0  ...                                      1318.544149
1           1  ...                                      1311.508417
2           2  ...                                      1314.261436
3           3  ...                                      1312.273979
4           4  ...                                      1319.923639
5           5  ...                                      1315.300703
6           6  ...                                      1313.487291

[7 rows x 26 columns]
taskset -c 128-135 PROTOCOL_BUFFERS_PYTHON_IMPLEMENTATION=python python3.9 benchmarks_end_to_end.py operator_impact healthcare slow_loading featurization_2 neural_network
2022-09-21 16:56:19.417729: W tensorflow/stream_executor/platform/default/dso_loader.cc:64] Could not load dynamic library 'libcudart.so.11.0'; dlerror: libcudart.so.11.0: cannot open shared object file: No such file or directory; LD_LIBRARY_PATH: /home/sgrafbe/mlwhatif/venv/lib/python3.9/site-packages/cv2/../../lib64:
2022-09-21 16:56:19.417774: I tensorflow/stream_executor/cuda/cudart_stub.cc:29] Ignore above cudart dlerror if you do not have a GPU set up on your machine.
2022-09-21 16:56:20 INFO  Patching sys.argv with ['mlwhatif', 'healthcare', 'slow_loading', 'featurization_2', 'neural_network']
2022-09-21 16:56:20 INFO  Running instrumented original pipeline...
2022-09-21 16:56:20 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-21 16:56:20 INFO  ---RUNTIME: Importing and monkey-patching took 95.38531303405762 ms
2022-09-21 16:56:22.780897: W tensorflow/stream_executor/platform/default/dso_loader.cc:64] Could not load dynamic library 'libcuda.so.1'; dlerror: libcuda.so.1: cannot open shared object file: No such file or directory; LD_LIBRARY_PATH: /home/sgrafbe/mlwhatif/venv/lib/python3.9/site-packages/cv2/../../lib64:
2022-09-21 16:56:22.780931: W tensorflow/stream_executor/cuda/cuda_driver.cc:326] failed call to cuInit: UNKNOWN ERROR (303)
2022-09-21 16:56:22.780951: I tensorflow/stream_executor/cuda/cuda_diagnostics.cc:156] kernel driver does not appear to be running on this host (wagyu): /proc/driver/nvidia/version does not exist
2022-09-21 16:56:22.781477: I tensorflow/core/platform/cpu_feature_guard.cc:142] This TensorFlow binary is optimized with oneAPI Deep Neural Network Library (oneDNN) to use the following CPU instructions in performance-critical operations:  AVX2 FMA
To enable them in other operations, rebuild TensorFlow with the appropriate compiler flags.
2022-09-21 16:56:23.321720: I tensorflow/compiler/mlir/mlir_graph_optimization_pass.cc:176] None of the MLIR Optimization Passes are enabled (registered 2)
2022-09-21 16:56:23.335371: I tensorflow/core/platform/profile_utils/cpu_utils.cc:114] CPU Frequency: 2595290000 Hz
2022-09-21 16:56:23 INFO  ---RUNTIME: Original pipeline execution took 2841.3455486297607 ms (excluding imports and monkey-patching)
2022-09-21 16:56:23 INFO  Starting execution of 0 what-if analyses...
2022-09-21 16:56:23 INFO  Estimated runtime of original DAG is 2579.9686908721924ms
2022-09-21 16:56:23 INFO  Performing Multi-Query Optimization
2022-09-21 16:56:23 INFO  Estimated unoptimized what-if runtime is 0ms
2022-09-21 16:56:23 INFO  Estimated optimised what-if runtime is 0ms
2022-09-21 16:56:23 INFO  Estimated optimisation runtime saving is 0ms
2022-09-21 16:56:23 INFO  ---RUNTIME: Multi-Query Optimization took 0.4830360412597656 ms
2022-09-21 16:56:23 INFO  Executing generated plans
2022-09-21 16:56:23 INFO  ---RUNTIME: Execution took 0.01621246337890625 ms
2022-09-21 16:56:23 INFO  Done!
2022-09-21 16:56:23 INFO  # Optimization benchmark for operator_impact with args [['healthcare', 'slow_loading', 'featurization_2', 'neural_network']] -- repetition 1 of 7
2022-09-21 16:56:23 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-21 16:56:23 INFO  Running instrumented original pipeline...
2022-09-21 16:56:23 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-21 16:56:23 INFO  ---RUNTIME: Importing and monkey-patching took 5.159854888916016 ms
2022-09-21 16:56:26 INFO  ---RUNTIME: Original pipeline execution took 2495.16224861145 ms (excluding imports and monkey-patching)
2022-09-21 16:56:26 INFO  Starting execution of 1 what-if analyses...
2022-09-21 16:56:26 INFO  Start plan generation for analysis OperatorImpact...
2022-09-21 16:56:26 INFO  ---RUNTIME: Plan generation took 6.043195724487305 ms
2022-09-21 16:56:26 INFO  Estimated runtime of original DAG is 2262.873888015747ms
2022-09-21 16:56:26 INFO  Performing Multi-Query Optimization
2022-09-21 16:56:26 INFO  Estimated unoptimized what-if runtime is 16881.695450585463ms
2022-09-21 16:56:26 INFO  Estimated optimised what-if runtime is 6280.553282540418ms
2022-09-21 16:56:26 INFO  Estimated optimisation runtime saving is 10601.142168045044ms
2022-09-21 16:56:26 INFO  ---RUNTIME: Multi-Query Optimization took 24.341344833374023 ms
2022-09-21 16:56:26 INFO  Executing generated plans
2022-09-21 16:56:31 INFO  ---RUNTIME: Execution took 5516.740083694458 ms
2022-09-21 16:56:31 INFO  Done!
2022-09-21 16:56:31 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-21 16:56:31 INFO  Running instrumented original pipeline...
2022-09-21 16:56:31 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-21 16:56:31 INFO  ---RUNTIME: Importing and monkey-patching took 6.587505340576172 ms
2022-09-21 16:56:34 INFO  ---RUNTIME: Original pipeline execution took 2919.7793006896973 ms (excluding imports and monkey-patching)
2022-09-21 16:56:34 INFO  Starting execution of 1 what-if analyses...
2022-09-21 16:56:34 INFO  Start plan generation for analysis OperatorImpact...
2022-09-21 16:56:34 INFO  ---RUNTIME: Plan generation took 4.897117614746094 ms
2022-09-21 16:56:34 INFO  Estimated runtime of original DAG is 2373.203992843628ms
2022-09-21 16:56:34 WARNING Skipping Multi-Query Optimization (instead, only applying patches)
2022-09-21 16:56:34 INFO  Estimated unoptimised what-if runtime is 17679.273047940485ms
2022-09-21 16:56:34 INFO  ---RUNTIME: Multi-Query Optimization took 9.322166442871094 ms
2022-09-21 16:56:34 INFO  Executing generated plans
2022-09-21 16:56:50 INFO  ---RUNTIME: Execution took 16364.144086837769 ms
2022-09-21 16:56:50 INFO  Done!
2022-09-21 16:56:50 INFO  # Finished -- repetition 1 of 7 
2022-09-21 16:56:50 INFO  # Optimization benchmark for operator_impact with args [['healthcare', 'slow_loading', 'featurization_2', 'neural_network']] -- repetition 2 of 7
2022-09-21 16:56:50 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-21 16:56:50 INFO  Running instrumented original pipeline...
2022-09-21 16:56:50 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-21 16:56:50 INFO  ---RUNTIME: Importing and monkey-patching took 6.036281585693359 ms
2022-09-21 16:56:53 INFO  ---RUNTIME: Original pipeline execution took 2510.917901992798 ms (excluding imports and monkey-patching)
2022-09-21 16:56:53 INFO  Starting execution of 1 what-if analyses...
2022-09-21 16:56:53 INFO  Start plan generation for analysis OperatorImpact...
2022-09-21 16:56:53 INFO  ---RUNTIME: Plan generation took 4.981040954589844 ms
2022-09-21 16:56:53 INFO  Estimated runtime of original DAG is 2279.9477577209473ms
2022-09-21 16:56:53 INFO  Performing Multi-Query Optimization
2022-09-21 16:56:53 INFO  Estimated unoptimized what-if runtime is 17014.766947976474ms
2022-09-21 16:56:53 INFO  Estimated optimised what-if runtime is 6350.589768639926ms
2022-09-21 16:56:53 INFO  Estimated optimisation runtime saving is 10664.177179336548ms
2022-09-21 16:56:53 INFO  ---RUNTIME: Multi-Query Optimization took 25.19536018371582 ms
2022-09-21 16:56:53 INFO  Executing generated plans
2022-09-21 16:56:59 INFO  ---RUNTIME: Execution took 5958.2977294921875 ms
2022-09-21 16:56:59 INFO  Done!
2022-09-21 16:56:59 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-21 16:56:59 INFO  Running instrumented original pipeline...
2022-09-21 16:56:59 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-21 16:56:59 INFO  ---RUNTIME: Importing and monkey-patching took 6.330013275146484 ms
2022-09-21 16:57:01 INFO  ---RUNTIME: Original pipeline execution took 2505.323648452759 ms (excluding imports and monkey-patching)
2022-09-21 16:57:01 INFO  Starting execution of 1 what-if analyses...
2022-09-21 16:57:01 INFO  Start plan generation for analysis OperatorImpact...
2022-09-21 16:57:01 INFO  ---RUNTIME: Plan generation took 4.85539436340332 ms
2022-09-21 16:57:01 INFO  Estimated runtime of original DAG is 2269.1943645477295ms
2022-09-21 16:57:01 WARNING Skipping Multi-Query Optimization (instead, only applying patches)
2022-09-21 16:57:01 INFO  Estimated unoptimised what-if runtime is 16929.252116433505ms
2022-09-21 16:57:01 INFO  ---RUNTIME: Multi-Query Optimization took 10.223627090454102 ms
2022-09-21 16:57:01 INFO  Executing generated plans
2022-09-21 16:57:18 INFO  ---RUNTIME: Execution took 16478.382110595703 ms
2022-09-21 16:57:18 INFO  Done!
2022-09-21 16:57:18 INFO  # Finished -- repetition 2 of 7 
2022-09-21 16:57:18 INFO  # Optimization benchmark for operator_impact with args [['healthcare', 'slow_loading', 'featurization_2', 'neural_network']] -- repetition 3 of 7
2022-09-21 16:57:18 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-21 16:57:18 INFO  Running instrumented original pipeline...
2022-09-21 16:57:18 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-21 16:57:18 INFO  ---RUNTIME: Importing and monkey-patching took 5.973339080810547 ms
2022-09-21 16:57:20 INFO  ---RUNTIME: Original pipeline execution took 2501.899480819702 ms (excluding imports and monkey-patching)
2022-09-21 16:57:20 INFO  Starting execution of 1 what-if analyses...
2022-09-21 16:57:20 INFO  Start plan generation for analysis OperatorImpact...
2022-09-21 16:57:20 INFO  ---RUNTIME: Plan generation took 4.961252212524414 ms
2022-09-21 16:57:20 INFO  Estimated runtime of original DAG is 2268.773078918457ms
2022-09-21 16:57:20 INFO  Performing Multi-Query Optimization
2022-09-21 16:57:20 INFO  Estimated unoptimized what-if runtime is 16912.06693156012ms
2022-09-21 16:57:20 INFO  Estimated optimised what-if runtime is 6243.6752270007955ms
2022-09-21 16:57:20 INFO  Estimated optimisation runtime saving is 10668.391704559323ms
2022-09-21 16:57:20 INFO  ---RUNTIME: Multi-Query Optimization took 24.991989135742188 ms
2022-09-21 16:57:20 INFO  Executing generated plans
2022-09-21 16:57:26 INFO  ---RUNTIME: Execution took 5639.751672744751 ms
2022-09-21 16:57:26 INFO  Done!
2022-09-21 16:57:26 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-21 16:57:26 INFO  Running instrumented original pipeline...
2022-09-21 16:57:26 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-21 16:57:26 INFO  ---RUNTIME: Importing and monkey-patching took 5.8422088623046875 ms
2022-09-21 16:57:29 INFO  ---RUNTIME: Original pipeline execution took 2946.528673171997 ms (excluding imports and monkey-patching)
2022-09-21 16:57:29 INFO  Starting execution of 1 what-if analyses...
2022-09-21 16:57:29 INFO  Start plan generation for analysis OperatorImpact...
2022-09-21 16:57:29 INFO  ---RUNTIME: Plan generation took 4.796504974365234 ms
2022-09-21 16:57:29 INFO  Estimated runtime of original DAG is 2708.951473236084ms
2022-09-21 16:57:29 WARNING Skipping Multi-Query Optimization (instead, only applying patches)
2022-09-21 16:57:29 INFO  Estimated unoptimised what-if runtime is 20771.82565393119ms
2022-09-21 16:57:29 INFO  ---RUNTIME: Multi-Query Optimization took 10.130643844604492 ms
2022-09-21 16:57:29 INFO  Executing generated plans
2022-09-21 16:57:46 INFO  ---RUNTIME: Execution took 16688.142776489258 ms
2022-09-21 16:57:46 INFO  Done!
2022-09-21 16:57:46 INFO  # Finished -- repetition 3 of 7 
2022-09-21 16:57:46 INFO  # Optimization benchmark for operator_impact with args [['healthcare', 'slow_loading', 'featurization_2', 'neural_network']] -- repetition 4 of 7
2022-09-21 16:57:46 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-21 16:57:46 INFO  Running instrumented original pipeline...
2022-09-21 16:57:46 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-21 16:57:46 INFO  ---RUNTIME: Importing and monkey-patching took 5.813121795654297 ms
2022-09-21 16:57:48 INFO  ---RUNTIME: Original pipeline execution took 2548.3176708221436 ms (excluding imports and monkey-patching)
2022-09-21 16:57:48 INFO  Starting execution of 1 what-if analyses...
2022-09-21 16:57:48 INFO  Start plan generation for analysis OperatorImpact...
2022-09-21 16:57:48 INFO  ---RUNTIME: Plan generation took 5.892038345336914 ms
2022-09-21 16:57:48 INFO  Estimated runtime of original DAG is 2308.734655380249ms
2022-09-21 16:57:48 INFO  Performing Multi-Query Optimization
2022-09-21 16:57:48 INFO  Estimated unoptimized what-if runtime is 17261.834252291712ms
2022-09-21 16:57:48 INFO  Estimated optimised what-if runtime is 6553.118336611778ms
2022-09-21 16:57:48 INFO  Estimated optimisation runtime saving is 10708.715915679933ms
2022-09-21 16:57:48 INFO  ---RUNTIME: Multi-Query Optimization took 30.81798553466797 ms
2022-09-21 16:57:48 INFO  Executing generated plans
2022-09-21 16:57:54 INFO  ---RUNTIME: Execution took 5784.473419189453 ms
2022-09-21 16:57:54 INFO  Done!
2022-09-21 16:57:54 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-21 16:57:54 INFO  Running instrumented original pipeline...
2022-09-21 16:57:54 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-21 16:57:54 INFO  ---RUNTIME: Importing and monkey-patching took 5.683660507202148 ms
2022-09-21 16:57:57 INFO  ---RUNTIME: Original pipeline execution took 2529.184341430664 ms (excluding imports and monkey-patching)
2022-09-21 16:57:57 INFO  Starting execution of 1 what-if analyses...
2022-09-21 16:57:57 INFO  Start plan generation for analysis OperatorImpact...
2022-09-21 16:57:57 INFO  ---RUNTIME: Plan generation took 5.4683685302734375 ms
2022-09-21 16:57:57 INFO  Estimated runtime of original DAG is 2296.243667602539ms
2022-09-21 16:57:57 WARNING Skipping Multi-Query Optimization (instead, only applying patches)
2022-09-21 16:57:57 INFO  Estimated unoptimised what-if runtime is 17122.404820343545ms
2022-09-21 16:57:57 INFO  ---RUNTIME: Multi-Query Optimization took 9.24539566040039 ms
2022-09-21 16:57:57 INFO  Executing generated plans
2022-09-21 16:58:14 INFO  ---RUNTIME: Execution took 17127.119302749634 ms
2022-09-21 16:58:14 INFO  Done!
2022-09-21 16:58:14 INFO  # Finished -- repetition 4 of 7 
2022-09-21 16:58:14 INFO  # Optimization benchmark for operator_impact with args [['healthcare', 'slow_loading', 'featurization_2', 'neural_network']] -- repetition 5 of 7
2022-09-21 16:58:14 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-21 16:58:14 INFO  Running instrumented original pipeline...
2022-09-21 16:58:14 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-21 16:58:14 INFO  ---RUNTIME: Importing and monkey-patching took 5.981683731079102 ms
2022-09-21 16:58:16 INFO  ---RUNTIME: Original pipeline execution took 2529.970645904541 ms (excluding imports and monkey-patching)
2022-09-21 16:58:16 INFO  Starting execution of 1 what-if analyses...
2022-09-21 16:58:16 INFO  Start plan generation for analysis OperatorImpact...
2022-09-21 16:58:16 INFO  ---RUNTIME: Plan generation took 5.183935165405273 ms
2022-09-21 16:58:16 INFO  Estimated runtime of original DAG is 2287.2560024261475ms
2022-09-21 16:58:16 INFO  Performing Multi-Query Optimization
2022-09-21 16:58:16 INFO  Estimated unoptimized what-if runtime is 17090.846439887737ms
2022-09-21 16:58:16 INFO  Estimated optimised what-if runtime is 6451.306721259806ms
2022-09-21 16:58:16 INFO  Estimated optimisation runtime saving is 10639.53971862793ms
2022-09-21 16:58:16 INFO  ---RUNTIME: Multi-Query Optimization took 26.84950828552246 ms
2022-09-21 16:58:16 INFO  Executing generated plans
2022-09-21 16:58:22 INFO  ---RUNTIME: Execution took 5864.38775062561 ms
2022-09-21 16:58:22 INFO  Done!
2022-09-21 16:58:22 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-21 16:58:22 INFO  Running instrumented original pipeline...
2022-09-21 16:58:22 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-21 16:58:22 INFO  ---RUNTIME: Importing and monkey-patching took 6.062984466552734 ms
2022-09-21 16:58:25 INFO  ---RUNTIME: Original pipeline execution took 2566.281795501709 ms (excluding imports and monkey-patching)
2022-09-21 16:58:25 INFO  Starting execution of 1 what-if analyses...
2022-09-21 16:58:25 INFO  Start plan generation for analysis OperatorImpact...
2022-09-21 16:58:25 INFO  ---RUNTIME: Plan generation took 5.179643630981445 ms
2022-09-21 16:58:25 INFO  Estimated runtime of original DAG is 2329.3418884277344ms
2022-09-21 16:58:25 WARNING Skipping Multi-Query Optimization (instead, only applying patches)
2022-09-21 16:58:25 INFO  Estimated unoptimised what-if runtime is 17388.946568554846ms
2022-09-21 16:58:25 INFO  ---RUNTIME: Multi-Query Optimization took 10.518789291381836 ms
2022-09-21 16:58:25 INFO  Executing generated plans
2022-09-21 16:58:42 INFO  ---RUNTIME: Execution took 16908.204317092896 ms
2022-09-21 16:58:42 INFO  Done!
2022-09-21 16:58:42 INFO  # Finished -- repetition 5 of 7 
2022-09-21 16:58:42 INFO  # Optimization benchmark for operator_impact with args [['healthcare', 'slow_loading', 'featurization_2', 'neural_network']] -- repetition 6 of 7
2022-09-21 16:58:42 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-21 16:58:42 INFO  Running instrumented original pipeline...
2022-09-21 16:58:42 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-21 16:58:42 INFO  ---RUNTIME: Importing and monkey-patching took 9.0179443359375 ms
2022-09-21 16:58:44 INFO  ---RUNTIME: Original pipeline execution took 2622.9424476623535 ms (excluding imports and monkey-patching)
2022-09-21 16:58:44 INFO  Starting execution of 1 what-if analyses...
2022-09-21 16:58:44 INFO  Start plan generation for analysis OperatorImpact...
2022-09-21 16:58:44 INFO  ---RUNTIME: Plan generation took 5.931615829467773 ms
2022-09-21 16:58:44 INFO  Estimated runtime of original DAG is 2366.2002086639404ms
2022-09-21 16:58:44 INFO  Performing Multi-Query Optimization
2022-09-21 16:58:44 INFO  Estimated unoptimized what-if runtime is 17654.458672424844ms
2022-09-21 16:58:44 INFO  Estimated optimised what-if runtime is 6573.979527374793ms
2022-09-21 16:58:44 INFO  Estimated optimisation runtime saving is 11080.47914505005ms
2022-09-21 16:58:44 INFO  ---RUNTIME: Multi-Query Optimization took 30.082225799560547 ms
2022-09-21 16:58:44 INFO  Executing generated plans
2022-09-21 16:58:50 INFO  ---RUNTIME: Execution took 5938.730478286743 ms
2022-09-21 16:58:50 INFO  Done!
2022-09-21 16:58:50 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-21 16:58:50 INFO  Running instrumented original pipeline...
2022-09-21 16:58:50 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-21 16:58:50 INFO  ---RUNTIME: Importing and monkey-patching took 5.990743637084961 ms
2022-09-21 16:58:53 INFO  ---RUNTIME: Original pipeline execution took 2922.3525524139404 ms (excluding imports and monkey-patching)
2022-09-21 16:58:53 INFO  Starting execution of 1 what-if analyses...
2022-09-21 16:58:53 INFO  Start plan generation for analysis OperatorImpact...
2022-09-21 16:58:53 INFO  ---RUNTIME: Plan generation took 4.7245025634765625 ms
2022-09-21 16:58:53 INFO  Estimated runtime of original DAG is 2686.683177947998ms
2022-09-21 16:58:53 WARNING Skipping Multi-Query Optimization (instead, only applying patches)
2022-09-21 16:58:53 INFO  Estimated unoptimised what-if runtime is 20622.358327898488ms
2022-09-21 16:58:53 INFO  ---RUNTIME: Multi-Query Optimization took 9.896039962768555 ms
2022-09-21 16:58:53 INFO  Executing generated plans
2022-09-21 16:59:10 INFO  ---RUNTIME: Execution took 16765.665769577026 ms
2022-09-21 16:59:10 INFO  Done!
2022-09-21 16:59:10 INFO  # Finished -- repetition 6 of 7 
2022-09-21 16:59:10 INFO  # Optimization benchmark for operator_impact with args [['healthcare', 'slow_loading', 'featurization_2', 'neural_network']] -- repetition 7 of 7
2022-09-21 16:59:10 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-21 16:59:10 INFO  Running instrumented original pipeline...
2022-09-21 16:59:10 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-21 16:59:10 INFO  ---RUNTIME: Importing and monkey-patching took 5.956888198852539 ms
2022-09-21 16:59:13 INFO  ---RUNTIME: Original pipeline execution took 2607.7017784118652 ms (excluding imports and monkey-patching)
2022-09-21 16:59:13 INFO  Starting execution of 1 what-if analyses...
2022-09-21 16:59:13 INFO  Start plan generation for analysis OperatorImpact...
2022-09-21 16:59:13 INFO  ---RUNTIME: Plan generation took 5.946159362792969 ms
2022-09-21 16:59:13 INFO  Estimated runtime of original DAG is 2365.1883602142334ms
2022-09-21 16:59:13 INFO  Performing Multi-Query Optimization
2022-09-21 16:59:13 INFO  Estimated unoptimized what-if runtime is 17655.890831454046ms
2022-09-21 16:59:13 INFO  Estimated optimised what-if runtime is 6604.024538500558ms
2022-09-21 16:59:13 INFO  Estimated optimisation runtime saving is 11051.866292953488ms
2022-09-21 16:59:13 INFO  ---RUNTIME: Multi-Query Optimization took 30.422687530517578 ms
2022-09-21 16:59:13 INFO  Executing generated plans
2022-09-21 16:59:19 INFO  ---RUNTIME: Execution took 5804.880619049072 ms
2022-09-21 16:59:19 INFO  Done!
2022-09-21 16:59:19 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-21 16:59:19 INFO  Running instrumented original pipeline...
2022-09-21 16:59:19 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-21 16:59:19 INFO  ---RUNTIME: Importing and monkey-patching took 6.020069122314453 ms
2022-09-21 16:59:21 INFO  ---RUNTIME: Original pipeline execution took 2588.608741760254 ms (excluding imports and monkey-patching)
2022-09-21 16:59:21 INFO  Starting execution of 1 what-if analyses...
2022-09-21 16:59:21 INFO  Start plan generation for analysis OperatorImpact...
2022-09-21 16:59:21 INFO  ---RUNTIME: Plan generation took 4.759311676025391 ms
2022-09-21 16:59:21 INFO  Estimated runtime of original DAG is 2349.152088165283ms
2022-09-21 16:59:21 WARNING Skipping Multi-Query Optimization (instead, only applying patches)
2022-09-21 16:59:21 INFO  Estimated unoptimised what-if runtime is 17513.4733866001ms
2022-09-21 16:59:21 INFO  ---RUNTIME: Multi-Query Optimization took 9.989500045776367 ms
2022-09-21 16:59:21 INFO  Executing generated plans
2022-09-21 16:59:38 INFO  ---RUNTIME: Execution took 16687.3517036438 ms
2022-09-21 16:59:38 INFO  Done!
2022-09-21 16:59:38 INFO  # Finished -- repetition 7 of 7 
2022-09-21 16:59:38 INFO  # Final results after all repetitions
2022-09-21 16:59:38 INFO     repetition  ... no_opt_what_if_execution_combined_model_training
0           0  ...                                      3349.524260
1           1  ...                                      3501.104355
2           2  ...                                      3147.693157
3           3  ...                                      3884.325027
4           4  ...                                      3614.772081
5           5  ...                                      3160.570145
6           6  ...                                      3552.984953

[7 rows x 26 columns]
taskset -c 128-135 PROTOCOL_BUFFERS_PYTHON_IMPLEMENTATION=python python3.9 benchmarks_end_to_end.py operator_impact healthcare slow_loading featurization_3 logistic_regression
2022-09-21 16:59:40.554609: W tensorflow/stream_executor/platform/default/dso_loader.cc:64] Could not load dynamic library 'libcudart.so.11.0'; dlerror: libcudart.so.11.0: cannot open shared object file: No such file or directory; LD_LIBRARY_PATH: /home/sgrafbe/mlwhatif/venv/lib/python3.9/site-packages/cv2/../../lib64:
2022-09-21 16:59:40.554651: I tensorflow/stream_executor/cuda/cudart_stub.cc:29] Ignore above cudart dlerror if you do not have a GPU set up on your machine.
2022-09-21 16:59:41 INFO  Patching sys.argv with ['mlwhatif', 'healthcare', 'slow_loading', 'featurization_3', 'logistic_regression']
2022-09-21 16:59:41 INFO  Running instrumented original pipeline...
2022-09-21 16:59:41 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-21 16:59:41 INFO  ---RUNTIME: Importing and monkey-patching took 95.6721305847168 ms
2022-09-21 16:59:44 INFO  ---RUNTIME: Original pipeline execution took 2193.68839263916 ms (excluding imports and monkey-patching)
2022-09-21 16:59:44 INFO  Starting execution of 0 what-if analyses...
2022-09-21 16:59:44 INFO  Estimated runtime of original DAG is 1824.5999813079834ms
2022-09-21 16:59:44 INFO  Performing Multi-Query Optimization
2022-09-21 16:59:44 INFO  Estimated unoptimized what-if runtime is 0ms
2022-09-21 16:59:44 INFO  Estimated optimised what-if runtime is 0ms
2022-09-21 16:59:44 INFO  Estimated optimisation runtime saving is 0ms
2022-09-21 16:59:44 INFO  ---RUNTIME: Multi-Query Optimization took 0.5164146423339844 ms
2022-09-21 16:59:44 INFO  Executing generated plans
2022-09-21 16:59:44 INFO  ---RUNTIME: Execution took 0.022649765014648438 ms
2022-09-21 16:59:44 INFO  Done!
2022-09-21 16:59:44 INFO  # Optimization benchmark for operator_impact with args [['healthcare', 'slow_loading', 'featurization_3', 'logistic_regression']] -- repetition 1 of 7
2022-09-21 16:59:44 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-21 16:59:44 INFO  Running instrumented original pipeline...
2022-09-21 16:59:44 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-21 16:59:44 INFO  ---RUNTIME: Importing and monkey-patching took 5.16510009765625 ms
2022-09-21 16:59:46 INFO  ---RUNTIME: Original pipeline execution took 2122.1764087677 ms (excluding imports and monkey-patching)
2022-09-21 16:59:46 INFO  Starting execution of 1 what-if analyses...
2022-09-21 16:59:46 INFO  Start plan generation for analysis OperatorImpact...
2022-09-21 16:59:46 INFO  ---RUNTIME: Plan generation took 6.136178970336914 ms
2022-09-21 16:59:46 INFO  Estimated runtime of original DAG is 1789.2961502075195ms
2022-09-21 16:59:46 INFO  Performing Multi-Query Optimization
2022-09-21 16:59:46 INFO  Estimated unoptimized what-if runtime is 21514.7674239915ms
2022-09-21 16:59:46 INFO  Estimated optimised what-if runtime is 1919.558779124556ms
2022-09-21 16:59:46 INFO  Estimated optimisation runtime saving is 19595.208644866943ms
2022-09-21 16:59:46 INFO  ---RUNTIME: Multi-Query Optimization took 44.65770721435547 ms
2022-09-21 16:59:46 INFO  Executing generated plans
2022-09-21 16:59:48 INFO  ---RUNTIME: Execution took 1918.961763381958 ms
2022-09-21 16:59:48 INFO  Done!
2022-09-21 16:59:48 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-21 16:59:48 INFO  Running instrumented original pipeline...
2022-09-21 16:59:48 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-21 16:59:48 INFO  ---RUNTIME: Importing and monkey-patching took 6.34455680847168 ms
2022-09-21 16:59:50 INFO  ---RUNTIME: Original pipeline execution took 2270.5516815185547 ms (excluding imports and monkey-patching)
2022-09-21 16:59:50 INFO  Starting execution of 1 what-if analyses...
2022-09-21 16:59:50 INFO  Start plan generation for analysis OperatorImpact...
2022-09-21 16:59:50 INFO  ---RUNTIME: Plan generation took 5.5389404296875 ms
2022-09-21 16:59:50 INFO  Estimated runtime of original DAG is 1780.6494235992432ms
2022-09-21 16:59:50 WARNING Skipping Multi-Query Optimization (instead, only applying patches)
2022-09-21 16:59:50 INFO  Estimated unoptimised what-if runtime is 21411.41990710949ms
2022-09-21 16:59:50 INFO  ---RUNTIME: Multi-Query Optimization took 12.984991073608398 ms
2022-09-21 16:59:50 INFO  Executing generated plans
2022-09-21 17:00:12 INFO  ---RUNTIME: Execution took 21925.46796798706 ms
2022-09-21 17:00:12 INFO  Done!
2022-09-21 17:00:12 INFO  # Finished -- repetition 1 of 7 
2022-09-21 17:00:12 INFO  # Optimization benchmark for operator_impact with args [['healthcare', 'slow_loading', 'featurization_3', 'logistic_regression']] -- repetition 2 of 7
2022-09-21 17:00:12 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-21 17:00:12 INFO  Running instrumented original pipeline...
2022-09-21 17:00:12 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-21 17:00:12 INFO  ---RUNTIME: Importing and monkey-patching took 6.054401397705078 ms
2022-09-21 17:00:14 INFO  ---RUNTIME: Original pipeline execution took 2120.7032203674316 ms (excluding imports and monkey-patching)
2022-09-21 17:00:14 INFO  Starting execution of 1 what-if analyses...
2022-09-21 17:00:14 INFO  Start plan generation for analysis OperatorImpact...
2022-09-21 17:00:14 INFO  ---RUNTIME: Plan generation took 5.531787872314453 ms
2022-09-21 17:00:14 INFO  Estimated runtime of original DAG is 1788.285493850708ms
2022-09-21 17:00:14 INFO  Performing Multi-Query Optimization
2022-09-21 17:00:14 INFO  Estimated unoptimized what-if runtime is 21501.928926336353ms
2022-09-21 17:00:14 INFO  Estimated optimised what-if runtime is 1916.841865408009ms
2022-09-21 17:00:14 INFO  Estimated optimisation runtime saving is 19585.087060928345ms
2022-09-21 17:00:14 INFO  ---RUNTIME: Multi-Query Optimization took 43.80083084106445 ms
2022-09-21 17:00:14 INFO  Executing generated plans
2022-09-21 17:00:16 INFO  ---RUNTIME: Execution took 1911.444902420044 ms
2022-09-21 17:00:16 INFO  Done!
2022-09-21 17:00:16 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-21 17:00:16 INFO  Running instrumented original pipeline...
2022-09-21 17:00:16 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-21 17:00:16 INFO  ---RUNTIME: Importing and monkey-patching took 5.725622177124023 ms
2022-09-21 17:00:18 INFO  ---RUNTIME: Original pipeline execution took 2111.7446422576904 ms (excluding imports and monkey-patching)
2022-09-21 17:00:18 INFO  Starting execution of 1 what-if analyses...
2022-09-21 17:00:18 INFO  Start plan generation for analysis OperatorImpact...
2022-09-21 17:00:18 INFO  ---RUNTIME: Plan generation took 5.443572998046875 ms
2022-09-21 17:00:18 INFO  Estimated runtime of original DAG is 1780.3468704223633ms
2022-09-21 17:00:18 WARNING Skipping Multi-Query Optimization (instead, only applying patches)
2022-09-21 17:00:18 INFO  Estimated unoptimised what-if runtime is 21406.049625626925ms
2022-09-21 17:00:18 INFO  ---RUNTIME: Multi-Query Optimization took 13.255596160888672 ms
2022-09-21 17:00:18 INFO  Executing generated plans
2022-09-21 17:00:40 INFO  ---RUNTIME: Execution took 21554.592609405518 ms
2022-09-21 17:00:40 INFO  Done!
2022-09-21 17:00:40 INFO  # Finished -- repetition 2 of 7 
2022-09-21 17:00:40 INFO  # Optimization benchmark for operator_impact with args [['healthcare', 'slow_loading', 'featurization_3', 'logistic_regression']] -- repetition 3 of 7
2022-09-21 17:00:40 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-21 17:00:40 INFO  Running instrumented original pipeline...
2022-09-21 17:00:40 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-21 17:00:40 INFO  ---RUNTIME: Importing and monkey-patching took 5.73277473449707 ms
2022-09-21 17:00:42 INFO  ---RUNTIME: Original pipeline execution took 2280.776023864746 ms (excluding imports and monkey-patching)
2022-09-21 17:00:42 INFO  Starting execution of 1 what-if analyses...
2022-09-21 17:00:42 INFO  Start plan generation for analysis OperatorImpact...
2022-09-21 17:00:42 INFO  ---RUNTIME: Plan generation took 5.41377067565918 ms
2022-09-21 17:00:42 INFO  Estimated runtime of original DAG is 1752.6593208312988ms
2022-09-21 17:00:42 INFO  Performing Multi-Query Optimization
2022-09-21 17:00:42 INFO  Estimated unoptimized what-if runtime is 21074.817495510495ms
2022-09-21 17:00:42 INFO  Estimated optimised what-if runtime is 1882.0730020259994ms
2022-09-21 17:00:42 INFO  Estimated optimisation runtime saving is 19192.744493484497ms
2022-09-21 17:00:42 INFO  ---RUNTIME: Multi-Query Optimization took 44.3720817565918 ms
2022-09-21 17:00:42 INFO  Executing generated plans
2022-09-21 17:00:44 INFO  ---RUNTIME: Execution took 1887.5455856323242 ms
2022-09-21 17:00:44 INFO  Done!
2022-09-21 17:00:44 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-21 17:00:44 INFO  Running instrumented original pipeline...
2022-09-21 17:00:44 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-21 17:00:44 INFO  ---RUNTIME: Importing and monkey-patching took 5.722284317016602 ms
2022-09-21 17:00:46 INFO  ---RUNTIME: Original pipeline execution took 2097.9578495025635 ms (excluding imports and monkey-patching)
2022-09-21 17:00:46 INFO  Starting execution of 1 what-if analyses...
2022-09-21 17:00:46 INFO  Start plan generation for analysis OperatorImpact...
2022-09-21 17:00:46 INFO  ---RUNTIME: Plan generation took 5.469799041748047 ms
2022-09-21 17:00:46 INFO  Estimated runtime of original DAG is 1764.6334171295166ms
2022-09-21 17:00:46 WARNING Skipping Multi-Query Optimization (instead, only applying patches)
2022-09-21 17:00:46 INFO  Estimated unoptimised what-if runtime is 21218.346176476312ms
2022-09-21 17:00:46 INFO  ---RUNTIME: Multi-Query Optimization took 13.181924819946289 ms
2022-09-21 17:00:46 INFO  Executing generated plans
2022-09-21 17:01:08 INFO  ---RUNTIME: Execution took 21494.312047958374 ms
2022-09-21 17:01:08 INFO  Done!
2022-09-21 17:01:08 INFO  # Finished -- repetition 3 of 7 
2022-09-21 17:01:08 INFO  # Optimization benchmark for operator_impact with args [['healthcare', 'slow_loading', 'featurization_3', 'logistic_regression']] -- repetition 4 of 7
2022-09-21 17:01:08 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-21 17:01:08 INFO  Running instrumented original pipeline...
2022-09-21 17:01:08 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-21 17:01:08 INFO  ---RUNTIME: Importing and monkey-patching took 5.9452056884765625 ms
2022-09-21 17:01:10 INFO  ---RUNTIME: Original pipeline execution took 2092.6012992858887 ms (excluding imports and monkey-patching)
2022-09-21 17:01:10 INFO  Starting execution of 1 what-if analyses...
2022-09-21 17:01:10 INFO  Start plan generation for analysis OperatorImpact...
2022-09-21 17:01:10 INFO  ---RUNTIME: Plan generation took 5.584955215454102 ms
2022-09-21 17:01:10 INFO  Estimated runtime of original DAG is 1759.850025177002ms
2022-09-21 17:01:10 INFO  Performing Multi-Query Optimization
2022-09-21 17:01:10 INFO  Estimated unoptimized what-if runtime is 21160.892193070773ms
2022-09-21 17:01:10 INFO  Estimated optimised what-if runtime is 1888.869468919162ms
2022-09-21 17:01:10 INFO  Estimated optimisation runtime saving is 19272.02272415161ms
2022-09-21 17:01:10 INFO  ---RUNTIME: Multi-Query Optimization took 43.92528533935547 ms
2022-09-21 17:01:10 INFO  Executing generated plans
2022-09-21 17:01:12 INFO  ---RUNTIME: Execution took 1877.52366065979 ms
2022-09-21 17:01:12 INFO  Done!
2022-09-21 17:01:12 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-21 17:01:12 INFO  Running instrumented original pipeline...
2022-09-21 17:01:12 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-21 17:01:12 INFO  ---RUNTIME: Importing and monkey-patching took 5.668878555297852 ms
2022-09-21 17:01:14 INFO  ---RUNTIME: Original pipeline execution took 2098.1082916259766 ms (excluding imports and monkey-patching)
2022-09-21 17:01:14 INFO  Starting execution of 1 what-if analyses...
2022-09-21 17:01:14 INFO  Start plan generation for analysis OperatorImpact...
2022-09-21 17:01:14 INFO  ---RUNTIME: Plan generation took 5.745887756347656 ms
2022-09-21 17:01:14 INFO  Estimated runtime of original DAG is 1765.871286392212ms
2022-09-21 17:01:14 WARNING Skipping Multi-Query Optimization (instead, only applying patches)
2022-09-21 17:01:14 INFO  Estimated unoptimised what-if runtime is 21233.10446245917ms
2022-09-21 17:01:14 INFO  ---RUNTIME: Multi-Query Optimization took 12.850046157836914 ms
2022-09-21 17:01:14 INFO  Executing generated plans
2022-09-21 17:01:35 INFO  ---RUNTIME: Execution took 21458.29176902771 ms
2022-09-21 17:01:35 INFO  Done!
2022-09-21 17:01:35 INFO  # Finished -- repetition 4 of 7 
2022-09-21 17:01:35 INFO  # Optimization benchmark for operator_impact with args [['healthcare', 'slow_loading', 'featurization_3', 'logistic_regression']] -- repetition 5 of 7
2022-09-21 17:01:35 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-21 17:01:35 INFO  Running instrumented original pipeline...
2022-09-21 17:01:35 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-21 17:01:35 INFO  ---RUNTIME: Importing and monkey-patching took 5.858898162841797 ms
2022-09-21 17:01:37 INFO  ---RUNTIME: Original pipeline execution took 2111.374616622925 ms (excluding imports and monkey-patching)
2022-09-21 17:01:37 INFO  Starting execution of 1 what-if analyses...
2022-09-21 17:01:37 INFO  Start plan generation for analysis OperatorImpact...
2022-09-21 17:01:37 INFO  ---RUNTIME: Plan generation took 5.851030349731445 ms
2022-09-21 17:01:37 INFO  Estimated runtime of original DAG is 1758.6569786071777ms
2022-09-21 17:01:37 INFO  Performing Multi-Query Optimization
2022-09-21 17:01:38 INFO  Estimated unoptimized what-if runtime is 21146.065694710305ms
2022-09-21 17:01:38 INFO  Estimated optimised what-if runtime is 1886.4106959310066ms
2022-09-21 17:01:38 INFO  Estimated optimisation runtime saving is 19259.654998779297ms
2022-09-21 17:01:38 INFO  ---RUNTIME: Multi-Query Optimization took 237.78438568115234 ms
2022-09-21 17:01:38 INFO  Executing generated plans
2022-09-21 17:01:39 INFO  ---RUNTIME: Execution took 1950.3426551818848 ms
2022-09-21 17:01:39 INFO  Done!
2022-09-21 17:01:39 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-21 17:01:39 INFO  Running instrumented original pipeline...
2022-09-21 17:01:40 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-21 17:01:40 INFO  ---RUNTIME: Importing and monkey-patching took 5.692720413208008 ms
2022-09-21 17:01:42 INFO  ---RUNTIME: Original pipeline execution took 2082.760810852051 ms (excluding imports and monkey-patching)
2022-09-21 17:01:42 INFO  Starting execution of 1 what-if analyses...
2022-09-21 17:01:42 INFO  Start plan generation for analysis OperatorImpact...
2022-09-21 17:01:42 INFO  ---RUNTIME: Plan generation took 5.515098571777344 ms
2022-09-21 17:01:42 INFO  Estimated runtime of original DAG is 1749.5441436767578ms
2022-09-21 17:01:42 WARNING Skipping Multi-Query Optimization (instead, only applying patches)
2022-09-21 17:01:42 INFO  Estimated unoptimised what-if runtime is 21037.395767507882ms
2022-09-21 17:01:42 INFO  ---RUNTIME: Multi-Query Optimization took 13.135671615600586 ms
2022-09-21 17:01:42 INFO  Executing generated plans
2022-09-21 17:02:03 INFO  ---RUNTIME: Execution took 21496.18887901306 ms
2022-09-21 17:02:03 INFO  Done!
2022-09-21 17:02:03 INFO  # Finished -- repetition 5 of 7 
2022-09-21 17:02:03 INFO  # Optimization benchmark for operator_impact with args [['healthcare', 'slow_loading', 'featurization_3', 'logistic_regression']] -- repetition 6 of 7
2022-09-21 17:02:03 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-21 17:02:03 INFO  Running instrumented original pipeline...
2022-09-21 17:02:03 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-21 17:02:03 INFO  ---RUNTIME: Importing and monkey-patching took 6.469249725341797 ms
2022-09-21 17:02:05 INFO  ---RUNTIME: Original pipeline execution took 2096.388339996338 ms (excluding imports and monkey-patching)
2022-09-21 17:02:05 INFO  Starting execution of 1 what-if analyses...
2022-09-21 17:02:05 INFO  Start plan generation for analysis OperatorImpact...
2022-09-21 17:02:05 INFO  ---RUNTIME: Plan generation took 5.596637725830078 ms
2022-09-21 17:02:05 INFO  Estimated runtime of original DAG is 1759.4716548919678ms
2022-09-21 17:02:05 INFO  Performing Multi-Query Optimization
2022-09-21 17:02:05 INFO  Estimated unoptimized what-if runtime is 21156.36257303172ms
2022-09-21 17:02:05 INFO  Estimated optimised what-if runtime is 1888.633052233991ms
2022-09-21 17:02:05 INFO  Estimated optimisation runtime saving is 19267.72952079773ms
2022-09-21 17:02:05 INFO  ---RUNTIME: Multi-Query Optimization took 44.145822525024414 ms
2022-09-21 17:02:05 INFO  Executing generated plans
2022-09-21 17:02:07 INFO  ---RUNTIME: Execution took 1883.7625980377197 ms
2022-09-21 17:02:07 INFO  Done!
2022-09-21 17:02:07 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-21 17:02:07 INFO  Running instrumented original pipeline...
2022-09-21 17:02:07 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-21 17:02:07 INFO  ---RUNTIME: Importing and monkey-patching took 5.754947662353516 ms
2022-09-21 17:02:09 INFO  ---RUNTIME: Original pipeline execution took 2098.078489303589 ms (excluding imports and monkey-patching)
2022-09-21 17:02:09 INFO  Starting execution of 1 what-if analyses...
2022-09-21 17:02:09 INFO  Start plan generation for analysis OperatorImpact...
2022-09-21 17:02:09 INFO  ---RUNTIME: Plan generation took 5.412101745605469 ms
2022-09-21 17:02:09 INFO  Estimated runtime of original DAG is 1766.4318084716797ms
2022-09-21 17:02:09 WARNING Skipping Multi-Query Optimization (instead, only applying patches)
2022-09-21 17:02:09 INFO  Estimated unoptimised what-if runtime is 21239.638823476333ms
2022-09-21 17:02:09 INFO  ---RUNTIME: Multi-Query Optimization took 13.144254684448242 ms
2022-09-21 17:02:09 INFO  Executing generated plans
2022-09-21 17:02:31 INFO  ---RUNTIME: Execution took 21570.171117782593 ms
2022-09-21 17:02:31 INFO  Done!
2022-09-21 17:02:31 INFO  # Finished -- repetition 6 of 7 
2022-09-21 17:02:31 INFO  # Optimization benchmark for operator_impact with args [['healthcare', 'slow_loading', 'featurization_3', 'logistic_regression']] -- repetition 7 of 7
2022-09-21 17:02:31 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-21 17:02:31 INFO  Running instrumented original pipeline...
2022-09-21 17:02:31 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-21 17:02:31 INFO  ---RUNTIME: Importing and monkey-patching took 5.8879852294921875 ms
2022-09-21 17:02:33 INFO  ---RUNTIME: Original pipeline execution took 2104.3689250946045 ms (excluding imports and monkey-patching)
2022-09-21 17:02:33 INFO  Starting execution of 1 what-if analyses...
2022-09-21 17:02:33 INFO  Start plan generation for analysis OperatorImpact...
2022-09-21 17:02:33 INFO  ---RUNTIME: Plan generation took 5.518674850463867 ms
2022-09-21 17:02:33 INFO  Estimated runtime of original DAG is 1772.017240524292ms
2022-09-21 17:02:33 INFO  Performing Multi-Query Optimization
2022-09-21 17:02:33 INFO  Estimated unoptimized what-if runtime is 21306.715832085443ms
2022-09-21 17:02:33 INFO  Estimated optimised what-if runtime is 1900.671110482051ms
2022-09-21 17:02:33 INFO  Estimated optimisation runtime saving is 19406.044721603394ms
2022-09-21 17:02:33 INFO  ---RUNTIME: Multi-Query Optimization took 43.740272521972656 ms
2022-09-21 17:02:33 INFO  Executing generated plans
2022-09-21 17:02:35 INFO  ---RUNTIME: Execution took 1887.922763824463 ms
2022-09-21 17:02:35 INFO  Done!
2022-09-21 17:02:35 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-21 17:02:35 INFO  Running instrumented original pipeline...
2022-09-21 17:02:35 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-21 17:02:35 INFO  ---RUNTIME: Importing and monkey-patching took 5.705833435058594 ms
2022-09-21 17:02:37 INFO  ---RUNTIME: Original pipeline execution took 2105.9024333953857 ms (excluding imports and monkey-patching)
2022-09-21 17:02:37 INFO  Starting execution of 1 what-if analyses...
2022-09-21 17:02:37 INFO  Start plan generation for analysis OperatorImpact...
2022-09-21 17:02:37 INFO  ---RUNTIME: Plan generation took 5.526304244995117 ms
2022-09-21 17:02:37 INFO  Estimated runtime of original DAG is 1770.1177597045898ms
2022-09-21 17:02:37 WARNING Skipping Multi-Query Optimization (instead, only applying patches)
2022-09-21 17:02:37 INFO  Estimated unoptimised what-if runtime is 21286.496728042075ms
2022-09-21 17:02:37 INFO  ---RUNTIME: Multi-Query Optimization took 13.362646102905273 ms
2022-09-21 17:02:37 INFO  Executing generated plans
2022-09-21 17:02:59 INFO  ---RUNTIME: Execution took 21613.261222839355 ms
2022-09-21 17:02:59 INFO  Done!
2022-09-21 17:02:59 INFO  # Finished -- repetition 7 of 7 
2022-09-21 17:02:59 INFO  # Final results after all repetitions
2022-09-21 17:02:59 INFO     repetition  ... no_opt_what_if_execution_combined_model_training
0           0  ...                                        14.380217
1           1  ...                                        24.871349
2           2  ...                                        14.347315
3           3  ...                                        14.166117
4           4  ...                                        14.173985
5           5  ...                                        14.218092
6           6  ...                                        14.354467

[7 rows x 26 columns]
taskset -c 128-135 PROTOCOL_BUFFERS_PYTHON_IMPLEMENTATION=python python3.9 benchmarks_end_to_end.py operator_impact healthcare slow_loading featurization_3 xgboost
2022-09-21 17:03:01.158727: W tensorflow/stream_executor/platform/default/dso_loader.cc:64] Could not load dynamic library 'libcudart.so.11.0'; dlerror: libcudart.so.11.0: cannot open shared object file: No such file or directory; LD_LIBRARY_PATH: /home/sgrafbe/mlwhatif/venv/lib/python3.9/site-packages/cv2/../../lib64:
2022-09-21 17:03:01.158774: I tensorflow/stream_executor/cuda/cudart_stub.cc:29] Ignore above cudart dlerror if you do not have a GPU set up on your machine.
2022-09-21 17:03:02 INFO  Patching sys.argv with ['mlwhatif', 'healthcare', 'slow_loading', 'featurization_3', 'xgboost']
2022-09-21 17:03:02 INFO  Running instrumented original pipeline...
2022-09-21 17:03:02 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-21 17:03:02 INFO  ---RUNTIME: Importing and monkey-patching took 95.2146053314209 ms
2022-09-21 17:03:13 INFO  ---RUNTIME: Original pipeline execution took 10544.474124908447 ms (excluding imports and monkey-patching)
2022-09-21 17:03:13 INFO  Starting execution of 0 what-if analyses...
2022-09-21 17:03:13 INFO  Estimated runtime of original DAG is 10189.467430114746ms
2022-09-21 17:03:13 INFO  Performing Multi-Query Optimization
2022-09-21 17:03:13 INFO  Estimated unoptimized what-if runtime is 0ms
2022-09-21 17:03:13 INFO  Estimated optimised what-if runtime is 0ms
2022-09-21 17:03:13 INFO  Estimated optimisation runtime saving is 0ms
2022-09-21 17:03:13 INFO  ---RUNTIME: Multi-Query Optimization took 0.5724430084228516 ms
2022-09-21 17:03:13 INFO  Executing generated plans
2022-09-21 17:03:13 INFO  ---RUNTIME: Execution took 0.024080276489257812 ms
2022-09-21 17:03:13 INFO  Done!
2022-09-21 17:03:13 INFO  # Optimization benchmark for operator_impact with args [['healthcare', 'slow_loading', 'featurization_3', 'xgboost']] -- repetition 1 of 7
2022-09-21 17:03:13 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-21 17:03:13 INFO  Running instrumented original pipeline...
2022-09-21 17:03:13 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-21 17:03:13 INFO  ---RUNTIME: Importing and monkey-patching took 5.146503448486328 ms
2022-09-21 17:03:15 INFO  ---RUNTIME: Original pipeline execution took 2275.238513946533 ms (excluding imports and monkey-patching)
2022-09-21 17:03:15 INFO  Starting execution of 1 what-if analyses...
2022-09-21 17:03:15 INFO  Start plan generation for analysis OperatorImpact...
2022-09-21 17:03:15 INFO  ---RUNTIME: Plan generation took 6.174802780151367 ms
2022-09-21 17:03:15 INFO  Estimated runtime of original DAG is 1952.8141021728516ms
2022-09-21 17:03:15 INFO  Performing Multi-Query Optimization
2022-09-21 17:03:15 INFO  Estimated unoptimized what-if runtime is 23861.785179993203ms
2022-09-21 17:03:15 INFO  Estimated optimised what-if runtime is 4524.358994385292ms
2022-09-21 17:03:15 INFO  Estimated optimisation runtime saving is 19337.42618560791ms
2022-09-21 17:03:15 INFO  ---RUNTIME: Multi-Query Optimization took 43.85709762573242 ms
2022-09-21 17:03:15 INFO  Executing generated plans
2022-09-21 17:03:19 INFO  ---RUNTIME: Execution took 4166.597366333008 ms
2022-09-21 17:03:19 INFO  Done!
2022-09-21 17:03:19 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-21 17:03:19 INFO  Running instrumented original pipeline...
2022-09-21 17:03:19 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-21 17:03:19 INFO  ---RUNTIME: Importing and monkey-patching took 6.047487258911133 ms
2022-09-21 17:03:21 INFO  ---RUNTIME: Original pipeline execution took 2452.719211578369 ms (excluding imports and monkey-patching)
2022-09-21 17:03:21 INFO  Starting execution of 1 what-if analyses...
2022-09-21 17:03:21 INFO  Start plan generation for analysis OperatorImpact...
2022-09-21 17:03:21 INFO  ---RUNTIME: Plan generation took 5.41377067565918 ms
2022-09-21 17:03:21 INFO  Estimated runtime of original DAG is 1970.5805778503418ms
2022-09-21 17:03:21 WARNING Skipping Multi-Query Optimization (instead, only applying patches)
2022-09-21 17:03:21 INFO  Estimated unoptimised what-if runtime is 24072.401688016693ms
2022-09-21 17:03:21 INFO  ---RUNTIME: Multi-Query Optimization took 12.783527374267578 ms
2022-09-21 17:03:21 INFO  Executing generated plans
2022-09-21 17:03:45 INFO  ---RUNTIME: Execution took 23727.591514587402 ms
2022-09-21 17:03:45 INFO  Done!
2022-09-21 17:03:45 INFO  # Finished -- repetition 1 of 7 
2022-09-21 17:03:45 INFO  # Optimization benchmark for operator_impact with args [['healthcare', 'slow_loading', 'featurization_3', 'xgboost']] -- repetition 2 of 7
2022-09-21 17:03:45 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-21 17:03:45 INFO  Running instrumented original pipeline...
2022-09-21 17:03:45 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-21 17:03:45 INFO  ---RUNTIME: Importing and monkey-patching took 5.87916374206543 ms
2022-09-21 17:03:48 INFO  ---RUNTIME: Original pipeline execution took 2278.604745864868 ms (excluding imports and monkey-patching)
2022-09-21 17:03:48 INFO  Starting execution of 1 what-if analyses...
2022-09-21 17:03:48 INFO  Start plan generation for analysis OperatorImpact...
2022-09-21 17:03:48 INFO  ---RUNTIME: Plan generation took 5.567789077758789 ms
2022-09-21 17:03:48 INFO  Estimated runtime of original DAG is 1956.3837051391602ms
2022-09-21 17:03:48 INFO  Performing Multi-Query Optimization
2022-09-21 17:03:48 INFO  Estimated unoptimized what-if runtime is 23901.558590757435ms
2022-09-21 17:03:48 INFO  Estimated optimised what-if runtime is 4510.4603298779175ms
2022-09-21 17:03:48 INFO  Estimated optimisation runtime saving is 19391.098260879517ms
2022-09-21 17:03:48 INFO  ---RUNTIME: Multi-Query Optimization took 43.590545654296875 ms
2022-09-21 17:03:48 INFO  Executing generated plans
2022-09-21 17:03:52 INFO  ---RUNTIME: Execution took 4120.070457458496 ms
2022-09-21 17:03:52 INFO  Done!
2022-09-21 17:03:52 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-21 17:03:52 INFO  Running instrumented original pipeline...
2022-09-21 17:03:52 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-21 17:03:52 INFO  ---RUNTIME: Importing and monkey-patching took 5.6514739990234375 ms
2022-09-21 17:03:54 INFO  ---RUNTIME: Original pipeline execution took 2273.2362747192383 ms (excluding imports and monkey-patching)
2022-09-21 17:03:54 INFO  Starting execution of 1 what-if analyses...
2022-09-21 17:03:54 INFO  Start plan generation for analysis OperatorImpact...
2022-09-21 17:03:54 INFO  ---RUNTIME: Plan generation took 5.867719650268555 ms
2022-09-21 17:03:54 INFO  Estimated runtime of original DAG is 1946.2347030639648ms
2022-09-21 17:03:54 WARNING Skipping Multi-Query Optimization (instead, only applying patches)
2022-09-21 17:03:54 INFO  Estimated unoptimised what-if runtime is 23778.710824867776ms
2022-09-21 17:03:54 INFO  ---RUNTIME: Multi-Query Optimization took 12.897014617919922 ms
2022-09-21 17:03:54 INFO  Executing generated plans
2022-09-21 17:04:18 INFO  ---RUNTIME: Execution took 23998.30651283264 ms
2022-09-21 17:04:18 INFO  Done!
2022-09-21 17:04:18 INFO  # Finished -- repetition 2 of 7 
2022-09-21 17:04:18 INFO  # Optimization benchmark for operator_impact with args [['healthcare', 'slow_loading', 'featurization_3', 'xgboost']] -- repetition 3 of 7
2022-09-21 17:04:18 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-21 17:04:18 INFO  Running instrumented original pipeline...
2022-09-21 17:04:18 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-21 17:04:18 INFO  ---RUNTIME: Importing and monkey-patching took 5.727529525756836 ms
2022-09-21 17:04:20 INFO  ---RUNTIME: Original pipeline execution took 2473.9081859588623 ms (excluding imports and monkey-patching)
2022-09-21 17:04:20 INFO  Starting execution of 1 what-if analyses...
2022-09-21 17:04:20 INFO  Start plan generation for analysis OperatorImpact...
2022-09-21 17:04:20 INFO  ---RUNTIME: Plan generation took 5.656242370605469 ms
2022-09-21 17:04:20 INFO  Estimated runtime of original DAG is 1976.7465591430664ms
2022-09-21 17:04:20 INFO  Performing Multi-Query Optimization
2022-09-21 17:04:21 INFO  Estimated unoptimized what-if runtime is 24146.372281271837ms
2022-09-21 17:04:21 INFO  Estimated optimised what-if runtime is 4535.580598074814ms
2022-09-21 17:04:21 INFO  Estimated optimisation runtime saving is 19610.79168319702ms
2022-09-21 17:04:21 INFO  ---RUNTIME: Multi-Query Optimization took 43.0750846862793 ms
2022-09-21 17:04:21 INFO  Executing generated plans
2022-09-21 17:04:25 INFO  ---RUNTIME: Execution took 4139.804124832153 ms
2022-09-21 17:04:25 INFO  Done!
2022-09-21 17:04:25 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-21 17:04:25 INFO  Running instrumented original pipeline...
2022-09-21 17:04:25 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-21 17:04:25 INFO  ---RUNTIME: Importing and monkey-patching took 5.90062141418457 ms
2022-09-21 17:04:27 INFO  ---RUNTIME: Original pipeline execution took 2272.70770072937 ms (excluding imports and monkey-patching)
2022-09-21 17:04:27 INFO  Starting execution of 1 what-if analyses...
2022-09-21 17:04:27 INFO  Start plan generation for analysis OperatorImpact...
2022-09-21 17:04:27 INFO  ---RUNTIME: Plan generation took 5.453348159790039 ms
2022-09-21 17:04:27 INFO  Estimated runtime of original DAG is 1945.2791213989258ms
2022-09-21 17:04:27 WARNING Skipping Multi-Query Optimization (instead, only applying patches)
2022-09-21 17:04:27 INFO  Estimated unoptimised what-if runtime is 23770.425109205575ms
2022-09-21 17:04:27 INFO  ---RUNTIME: Multi-Query Optimization took 12.685060501098633 ms
2022-09-21 17:04:27 INFO  Executing generated plans
2022-09-21 17:04:51 INFO  ---RUNTIME: Execution took 23876.12771987915 ms
2022-09-21 17:04:51 INFO  Done!
2022-09-21 17:04:51 INFO  # Finished -- repetition 3 of 7 
2022-09-21 17:04:51 INFO  # Optimization benchmark for operator_impact with args [['healthcare', 'slow_loading', 'featurization_3', 'xgboost']] -- repetition 4 of 7
2022-09-21 17:04:51 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-21 17:04:51 INFO  Running instrumented original pipeline...
2022-09-21 17:04:51 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-21 17:04:51 INFO  ---RUNTIME: Importing and monkey-patching took 6.271839141845703 ms
2022-09-21 17:04:53 INFO  ---RUNTIME: Original pipeline execution took 2278.499126434326 ms (excluding imports and monkey-patching)
2022-09-21 17:04:53 INFO  Starting execution of 1 what-if analyses...
2022-09-21 17:04:53 INFO  Start plan generation for analysis OperatorImpact...
2022-09-21 17:04:53 INFO  ---RUNTIME: Plan generation took 5.545616149902344 ms
2022-09-21 17:04:53 INFO  Estimated runtime of original DAG is 1954.3490409851074ms
2022-09-21 17:04:53 INFO  Performing Multi-Query Optimization
2022-09-21 17:04:53 INFO  Estimated unoptimized what-if runtime is 23875.161743986195ms
2022-09-21 17:04:53 INFO  Estimated optimised what-if runtime is 4498.742915021963ms
2022-09-21 17:04:53 INFO  Estimated optimisation runtime saving is 19376.418828964233ms
2022-09-21 17:04:53 INFO  ---RUNTIME: Multi-Query Optimization took 43.392181396484375 ms
2022-09-21 17:04:53 INFO  Executing generated plans
2022-09-21 17:04:57 INFO  ---RUNTIME: Execution took 4175.307750701904 ms
2022-09-21 17:04:57 INFO  Done!
2022-09-21 17:04:57 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-21 17:04:57 INFO  Running instrumented original pipeline...
2022-09-21 17:04:57 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-21 17:04:57 INFO  ---RUNTIME: Importing and monkey-patching took 5.938053131103516 ms
2022-09-21 17:05:00 INFO  ---RUNTIME: Original pipeline execution took 2332.387685775757 ms (excluding imports and monkey-patching)
2022-09-21 17:05:00 INFO  Starting execution of 1 what-if analyses...
2022-09-21 17:05:00 INFO  Start plan generation for analysis OperatorImpact...
2022-09-21 17:05:00 INFO  ---RUNTIME: Plan generation took 5.869626998901367 ms
2022-09-21 17:05:00 INFO  Estimated runtime of original DAG is 2008.5039138793945ms
2022-09-21 17:05:00 WARNING Skipping Multi-Query Optimization (instead, only applying patches)
2022-09-21 17:05:00 INFO  Estimated unoptimised what-if runtime is 24529.340086312128ms
2022-09-21 17:05:00 INFO  ---RUNTIME: Multi-Query Optimization took 12.707948684692383 ms
2022-09-21 17:05:00 INFO  Executing generated plans
2022-09-21 17:05:24 INFO  ---RUNTIME: Execution took 24306.1466217041 ms
2022-09-21 17:05:24 INFO  Done!
2022-09-21 17:05:24 INFO  # Finished -- repetition 4 of 7 
2022-09-21 17:05:24 INFO  # Optimization benchmark for operator_impact with args [['healthcare', 'slow_loading', 'featurization_3', 'xgboost']] -- repetition 5 of 7
2022-09-21 17:05:24 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-21 17:05:24 INFO  Running instrumented original pipeline...
2022-09-21 17:05:24 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-21 17:05:24 INFO  ---RUNTIME: Importing and monkey-patching took 5.78761100769043 ms
2022-09-21 17:05:27 INFO  ---RUNTIME: Original pipeline execution took 2525.9337425231934 ms (excluding imports and monkey-patching)
2022-09-21 17:05:27 INFO  Starting execution of 1 what-if analyses...
2022-09-21 17:05:27 INFO  Start plan generation for analysis OperatorImpact...
2022-09-21 17:05:27 INFO  ---RUNTIME: Plan generation took 5.791664123535156 ms
2022-09-21 17:05:27 INFO  Estimated runtime of original DAG is 1973.0000495910645ms
2022-09-21 17:05:27 INFO  Performing Multi-Query Optimization
2022-09-21 17:05:27 INFO  Estimated unoptimized what-if runtime is 24101.620553279747ms
2022-09-21 17:05:27 INFO  Estimated optimised what-if runtime is 4529.713509822715ms
2022-09-21 17:05:27 INFO  Estimated optimisation runtime saving is 19571.90704345703ms
2022-09-21 17:05:27 INFO  ---RUNTIME: Multi-Query Optimization took 43.154001235961914 ms
2022-09-21 17:05:27 INFO  Executing generated plans
2022-09-21 17:05:31 INFO  ---RUNTIME: Execution took 4253.332138061523 ms
2022-09-21 17:05:31 INFO  Done!
2022-09-21 17:05:31 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-21 17:05:31 INFO  Running instrumented original pipeline...
2022-09-21 17:05:31 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-21 17:05:31 INFO  ---RUNTIME: Importing and monkey-patching took 5.709171295166016 ms
2022-09-21 17:05:33 INFO  ---RUNTIME: Original pipeline execution took 2330.311059951782 ms (excluding imports and monkey-patching)
2022-09-21 17:05:33 INFO  Starting execution of 1 what-if analyses...
2022-09-21 17:05:33 INFO  Start plan generation for analysis OperatorImpact...
2022-09-21 17:05:33 INFO  ---RUNTIME: Plan generation took 5.4168701171875 ms
2022-09-21 17:05:33 INFO  Estimated runtime of original DAG is 1990.6542301177979ms
2022-09-21 17:05:33 WARNING Skipping Multi-Query Optimization (instead, only applying patches)
2022-09-21 17:05:33 INFO  Estimated unoptimised what-if runtime is 24330.863729838667ms
2022-09-21 17:05:33 INFO  ---RUNTIME: Multi-Query Optimization took 12.660980224609375 ms
2022-09-21 17:05:33 INFO  Executing generated plans
2022-09-21 17:05:57 INFO  ---RUNTIME: Execution took 24053.05051803589 ms
2022-09-21 17:05:57 INFO  Done!
2022-09-21 17:05:57 INFO  # Finished -- repetition 5 of 7 
2022-09-21 17:05:57 INFO  # Optimization benchmark for operator_impact with args [['healthcare', 'slow_loading', 'featurization_3', 'xgboost']] -- repetition 6 of 7
2022-09-21 17:05:57 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-21 17:05:57 INFO  Running instrumented original pipeline...
2022-09-21 17:05:57 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-21 17:05:57 INFO  ---RUNTIME: Importing and monkey-patching took 5.804777145385742 ms
2022-09-21 17:06:00 INFO  ---RUNTIME: Original pipeline execution took 2312.314748764038 ms (excluding imports and monkey-patching)
2022-09-21 17:06:00 INFO  Starting execution of 1 what-if analyses...
2022-09-21 17:06:00 INFO  Start plan generation for analysis OperatorImpact...
2022-09-21 17:06:00 INFO  ---RUNTIME: Plan generation took 6.71076774597168 ms
2022-09-21 17:06:00 INFO  Estimated runtime of original DAG is 1986.9499206542969ms
2022-09-21 17:06:00 INFO  Performing Multi-Query Optimization
2022-09-21 17:06:00 INFO  Estimated unoptimized what-if runtime is 24300.66512288718ms
2022-09-21 17:06:00 INFO  Estimated optimised what-if runtime is 4737.287265678932ms
2022-09-21 17:06:00 INFO  Estimated optimisation runtime saving is 19563.37785720825ms
2022-09-21 17:06:00 INFO  ---RUNTIME: Multi-Query Optimization took 46.27823829650879 ms
2022-09-21 17:06:00 INFO  Executing generated plans
2022-09-21 17:06:04 INFO  ---RUNTIME: Execution took 4191.238164901733 ms
2022-09-21 17:06:04 INFO  Done!
2022-09-21 17:06:04 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-21 17:06:04 INFO  Running instrumented original pipeline...
2022-09-21 17:06:04 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-21 17:06:04 INFO  ---RUNTIME: Importing and monkey-patching took 6.674766540527344 ms
2022-09-21 17:06:06 INFO  ---RUNTIME: Original pipeline execution took 2289.903163909912 ms (excluding imports and monkey-patching)
2022-09-21 17:06:06 INFO  Starting execution of 1 what-if analyses...
2022-09-21 17:06:06 INFO  Start plan generation for analysis OperatorImpact...
2022-09-21 17:06:06 INFO  ---RUNTIME: Plan generation took 5.827903747558594 ms
2022-09-21 17:06:06 INFO  Estimated runtime of original DAG is 1956.486463546753ms
2022-09-21 17:06:06 WARNING Skipping Multi-Query Optimization (instead, only applying patches)
2022-09-21 17:06:06 INFO  Estimated unoptimised what-if runtime is 23911.023677628615ms
2022-09-21 17:06:06 INFO  ---RUNTIME: Multi-Query Optimization took 12.798070907592773 ms
2022-09-21 17:06:06 INFO  Executing generated plans
2022-09-21 17:06:30 INFO  ---RUNTIME: Execution took 24170.676708221436 ms
2022-09-21 17:06:30 INFO  Done!
2022-09-21 17:06:30 INFO  # Finished -- repetition 6 of 7 
2022-09-21 17:06:30 INFO  # Optimization benchmark for operator_impact with args [['healthcare', 'slow_loading', 'featurization_3', 'xgboost']] -- repetition 7 of 7
2022-09-21 17:06:30 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-21 17:06:30 INFO  Running instrumented original pipeline...
2022-09-21 17:06:30 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-21 17:06:30 INFO  ---RUNTIME: Importing and monkey-patching took 5.946159362792969 ms
2022-09-21 17:06:33 INFO  ---RUNTIME: Original pipeline execution took 2303.222179412842 ms (excluding imports and monkey-patching)
2022-09-21 17:06:33 INFO  Starting execution of 1 what-if analyses...
2022-09-21 17:06:33 INFO  Start plan generation for analysis OperatorImpact...
2022-09-21 17:06:33 INFO  ---RUNTIME: Plan generation took 5.444765090942383 ms
2022-09-21 17:06:33 INFO  Estimated runtime of original DAG is 1978.78098487854ms
2022-09-21 17:06:33 INFO  Performing Multi-Query Optimization
2022-09-21 17:06:33 INFO  Estimated unoptimized what-if runtime is 24176.031119247964ms
2022-09-21 17:06:33 INFO  Estimated optimised what-if runtime is 4571.911818405678ms
2022-09-21 17:06:33 INFO  Estimated optimisation runtime saving is 19604.119300842285ms
2022-09-21 17:06:33 INFO  ---RUNTIME: Multi-Query Optimization took 43.72406005859375 ms
2022-09-21 17:06:33 INFO  Executing generated plans
2022-09-21 17:06:37 INFO  ---RUNTIME: Execution took 4166.361570358276 ms
2022-09-21 17:06:37 INFO  Done!
2022-09-21 17:06:37 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-21 17:06:37 INFO  Running instrumented original pipeline...
2022-09-21 17:06:37 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-21 17:06:37 INFO  ---RUNTIME: Importing and monkey-patching took 6.233453750610352 ms
2022-09-21 17:06:39 INFO  ---RUNTIME: Original pipeline execution took 2504.2452812194824 ms (excluding imports and monkey-patching)
2022-09-21 17:06:39 INFO  Starting execution of 1 what-if analyses...
2022-09-21 17:06:39 INFO  Start plan generation for analysis OperatorImpact...
2022-09-21 17:06:39 INFO  ---RUNTIME: Plan generation took 5.381584167480469 ms
2022-09-21 17:06:39 INFO  Estimated runtime of original DAG is 1970.8137512207031ms
2022-09-21 17:06:39 WARNING Skipping Multi-Query Optimization (instead, only applying patches)
2022-09-21 17:06:39 INFO  Estimated unoptimised what-if runtime is 24072.575597927487ms
2022-09-21 17:06:39 INFO  ---RUNTIME: Multi-Query Optimization took 12.699127197265625 ms
2022-09-21 17:06:39 INFO  Executing generated plans
2022-09-21 17:07:04 INFO  ---RUNTIME: Execution took 24295.083045959473 ms
2022-09-21 17:07:04 INFO  Done!
2022-09-21 17:07:04 INFO  # Finished -- repetition 7 of 7 
2022-09-21 17:07:04 INFO  # Final results after all repetitions
2022-09-21 17:07:04 INFO     repetition  ... no_opt_what_if_execution_combined_model_training
0           0  ...                                      2299.506903
1           1  ...                                      2401.848316
2           2  ...                                      2435.382366
3           3  ...                                      2727.599859
4           4  ...                                      2366.823196
5           5  ...                                      2430.434227
6           6  ...                                      2313.810110

[7 rows x 26 columns]
taskset -c 128-135 PROTOCOL_BUFFERS_PYTHON_IMPLEMENTATION=python python3.9 benchmarks_end_to_end.py operator_impact healthcare slow_loading featurization_3 neural_network
2022-09-21 17:07:06.172933: W tensorflow/stream_executor/platform/default/dso_loader.cc:64] Could not load dynamic library 'libcudart.so.11.0'; dlerror: libcudart.so.11.0: cannot open shared object file: No such file or directory; LD_LIBRARY_PATH: /home/sgrafbe/mlwhatif/venv/lib/python3.9/site-packages/cv2/../../lib64:
2022-09-21 17:07:06.172979: I tensorflow/stream_executor/cuda/cudart_stub.cc:29] Ignore above cudart dlerror if you do not have a GPU set up on your machine.
2022-09-21 17:07:07 INFO  Patching sys.argv with ['mlwhatif', 'healthcare', 'slow_loading', 'featurization_3', 'neural_network']
2022-09-21 17:07:07 INFO  Running instrumented original pipeline...
2022-09-21 17:07:07 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-21 17:07:07 INFO  ---RUNTIME: Importing and monkey-patching took 94.35677528381348 ms
2022-09-21 17:07:09.643536: W tensorflow/stream_executor/platform/default/dso_loader.cc:64] Could not load dynamic library 'libcuda.so.1'; dlerror: libcuda.so.1: cannot open shared object file: No such file or directory; LD_LIBRARY_PATH: /home/sgrafbe/mlwhatif/venv/lib/python3.9/site-packages/cv2/../../lib64:
2022-09-21 17:07:09.643582: W tensorflow/stream_executor/cuda/cuda_driver.cc:326] failed call to cuInit: UNKNOWN ERROR (303)
2022-09-21 17:07:09.643605: I tensorflow/stream_executor/cuda/cuda_diagnostics.cc:156] kernel driver does not appear to be running on this host (wagyu): /proc/driver/nvidia/version does not exist
2022-09-21 17:07:09.644079: I tensorflow/core/platform/cpu_feature_guard.cc:142] This TensorFlow binary is optimized with oneAPI Deep Neural Network Library (oneDNN) to use the following CPU instructions in performance-critical operations:  AVX2 FMA
To enable them in other operations, rebuild TensorFlow with the appropriate compiler flags.
2022-09-21 17:07:10.199879: I tensorflow/compiler/mlir/mlir_graph_optimization_pass.cc:176] None of the MLIR Optimization Passes are enabled (registered 2)
2022-09-21 17:07:10.213374: I tensorflow/core/platform/profile_utils/cpu_utils.cc:114] CPU Frequency: 2595290000 Hz
2022-09-21 17:07:10 INFO  ---RUNTIME: Original pipeline execution took 2949.1190910339355 ms (excluding imports and monkey-patching)
2022-09-21 17:07:10 INFO  Starting execution of 0 what-if analyses...
2022-09-21 17:07:10 INFO  Estimated runtime of original DAG is 2593.686580657959ms
2022-09-21 17:07:10 INFO  Performing Multi-Query Optimization
2022-09-21 17:07:10 INFO  Estimated unoptimized what-if runtime is 0ms
2022-09-21 17:07:10 INFO  Estimated optimised what-if runtime is 0ms
2022-09-21 17:07:10 INFO  Estimated optimisation runtime saving is 0ms
2022-09-21 17:07:10 INFO  ---RUNTIME: Multi-Query Optimization took 0.5397796630859375 ms
2022-09-21 17:07:10 INFO  Executing generated plans
2022-09-21 17:07:10 INFO  ---RUNTIME: Execution took 0.015974044799804688 ms
2022-09-21 17:07:10 INFO  Done!
2022-09-21 17:07:10 INFO  # Optimization benchmark for operator_impact with args [['healthcare', 'slow_loading', 'featurization_3', 'neural_network']] -- repetition 1 of 7
2022-09-21 17:07:10 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-21 17:07:10 INFO  Running instrumented original pipeline...
2022-09-21 17:07:10 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-21 17:07:10 INFO  ---RUNTIME: Importing and monkey-patching took 5.096673965454102 ms
2022-09-21 17:07:13 INFO  ---RUNTIME: Original pipeline execution took 2595.487356185913 ms (excluding imports and monkey-patching)
2022-09-21 17:07:13 INFO  Starting execution of 1 what-if analyses...
2022-09-21 17:07:13 INFO  Start plan generation for analysis OperatorImpact...
2022-09-21 17:07:13 INFO  ---RUNTIME: Plan generation took 6.053924560546875 ms
2022-09-21 17:07:13 INFO  Estimated runtime of original DAG is 2268.327236175537ms
2022-09-21 17:07:13 INFO  Performing Multi-Query Optimization
2022-09-21 17:07:13 INFO  Estimated unoptimized what-if runtime is 28261.855488810044ms
2022-09-21 17:07:13 INFO  Estimated optimised what-if runtime is 8728.835230860213ms
2022-09-21 17:07:13 INFO  Estimated optimisation runtime saving is 19533.02025794983ms
2022-09-21 17:07:13 INFO  ---RUNTIME: Multi-Query Optimization took 43.94960403442383 ms
2022-09-21 17:07:13 INFO  Executing generated plans
2022-09-21 17:07:21 INFO  ---RUNTIME: Execution took 8372.353315353394 ms
2022-09-21 17:07:21 INFO  Done!
2022-09-21 17:07:21 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-21 17:07:21 INFO  Running instrumented original pipeline...
2022-09-21 17:07:21 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-21 17:07:21 INFO  ---RUNTIME: Importing and monkey-patching took 5.91588020324707 ms
2022-09-21 17:07:24 INFO  ---RUNTIME: Original pipeline execution took 2926.903486251831 ms (excluding imports and monkey-patching)
2022-09-21 17:07:24 INFO  Starting execution of 1 what-if analyses...
2022-09-21 17:07:24 INFO  Start plan generation for analysis OperatorImpact...
2022-09-21 17:07:24 INFO  ---RUNTIME: Plan generation took 5.559444427490234 ms
2022-09-21 17:07:24 INFO  Estimated runtime of original DAG is 2604.269027709961ms
2022-09-21 17:07:24 WARNING Skipping Multi-Query Optimization (instead, only applying patches)
2022-09-21 17:07:24 INFO  Estimated unoptimised what-if runtime is 33067.10979034161ms
2022-09-21 17:07:24 INFO  ---RUNTIME: Multi-Query Optimization took 13.527154922485352 ms
2022-09-21 17:07:24 INFO  Executing generated plans
2022-09-21 17:07:51 INFO  ---RUNTIME: Execution took 27572.473287582397 ms
2022-09-21 17:07:51 INFO  Done!
2022-09-21 17:07:51 INFO  # Finished -- repetition 1 of 7 
2022-09-21 17:07:51 INFO  # Optimization benchmark for operator_impact with args [['healthcare', 'slow_loading', 'featurization_3', 'neural_network']] -- repetition 2 of 7
2022-09-21 17:07:51 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-21 17:07:52 INFO  Running instrumented original pipeline...
2022-09-21 17:07:52 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-21 17:07:52 INFO  ---RUNTIME: Importing and monkey-patching took 5.645036697387695 ms
2022-09-21 17:07:54 INFO  ---RUNTIME: Original pipeline execution took 2553.243398666382 ms (excluding imports and monkey-patching)
2022-09-21 17:07:54 INFO  Starting execution of 1 what-if analyses...
2022-09-21 17:07:54 INFO  Start plan generation for analysis OperatorImpact...
2022-09-21 17:07:54 INFO  ---RUNTIME: Plan generation took 5.636692047119141 ms
2022-09-21 17:07:54 INFO  Estimated runtime of original DAG is 2229.4461727142334ms
2022-09-21 17:07:54 INFO  Performing Multi-Query Optimization
2022-09-21 17:07:54 INFO  Estimated unoptimized what-if runtime is 27796.12449119831ms
2022-09-21 17:07:54 INFO  Estimated optimised what-if runtime is 8697.796377642397ms
2022-09-21 17:07:54 INFO  Estimated optimisation runtime saving is 19098.328113555912ms
2022-09-21 17:07:54 INFO  ---RUNTIME: Multi-Query Optimization took 44.33083534240723 ms
2022-09-21 17:07:54 INFO  Executing generated plans
2022-09-21 17:08:02 INFO  ---RUNTIME: Execution took 8264.821290969849 ms
2022-09-21 17:08:02 INFO  Done!
2022-09-21 17:08:02 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-21 17:08:02 INFO  Running instrumented original pipeline...
2022-09-21 17:08:02 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-21 17:08:02 INFO  ---RUNTIME: Importing and monkey-patching took 6.545305252075195 ms
2022-09-21 17:08:05 INFO  ---RUNTIME: Original pipeline execution took 2555.0434589385986 ms (excluding imports and monkey-patching)
2022-09-21 17:08:05 INFO  Starting execution of 1 what-if analyses...
2022-09-21 17:08:05 INFO  Start plan generation for analysis OperatorImpact...
2022-09-21 17:08:05 INFO  ---RUNTIME: Plan generation took 6.361722946166992 ms
2022-09-21 17:08:05 INFO  Estimated runtime of original DAG is 2232.7325344085693ms
2022-09-21 17:08:05 WARNING Skipping Multi-Query Optimization (instead, only applying patches)
2022-09-21 17:08:05 INFO  Estimated unoptimised what-if runtime is 27828.06970908724ms
2022-09-21 17:08:05 INFO  ---RUNTIME: Multi-Query Optimization took 12.857198715209961 ms
2022-09-21 17:08:05 INFO  Executing generated plans
2022-09-21 17:08:33 INFO  ---RUNTIME: Execution took 28000.783920288086 ms
2022-09-21 17:08:33 INFO  Done!
2022-09-21 17:08:33 INFO  # Finished -- repetition 2 of 7 
2022-09-21 17:08:33 INFO  # Optimization benchmark for operator_impact with args [['healthcare', 'slow_loading', 'featurization_3', 'neural_network']] -- repetition 3 of 7
2022-09-21 17:08:33 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-21 17:08:33 INFO  Running instrumented original pipeline...
2022-09-21 17:08:33 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-21 17:08:33 INFO  ---RUNTIME: Importing and monkey-patching took 6.2847137451171875 ms
2022-09-21 17:08:36 INFO  ---RUNTIME: Original pipeline execution took 3008.3184242248535 ms (excluding imports and monkey-patching)
2022-09-21 17:08:36 INFO  Starting execution of 1 what-if analyses...
2022-09-21 17:08:36 INFO  Start plan generation for analysis OperatorImpact...
2022-09-21 17:08:36 INFO  ---RUNTIME: Plan generation took 5.903720855712891 ms
2022-09-21 17:08:36 INFO  Estimated runtime of original DAG is 2316.098928451538ms
2022-09-21 17:08:36 INFO  Performing Multi-Query Optimization
2022-09-21 17:08:36 INFO  Estimated unoptimized what-if runtime is 28861.799175163796ms
2022-09-21 17:08:36 INFO  Estimated optimised what-if runtime is 8946.78896131186ms
2022-09-21 17:08:36 INFO  Estimated optimisation runtime saving is 19915.010213851936ms
2022-09-21 17:08:36 INFO  ---RUNTIME: Multi-Query Optimization took 47.29127883911133 ms
2022-09-21 17:08:36 INFO  Executing generated plans
2022-09-21 17:08:45 INFO  ---RUNTIME: Execution took 8504.16612625122 ms
2022-09-21 17:08:45 INFO  Done!
2022-09-21 17:08:45 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-21 17:08:45 INFO  Running instrumented original pipeline...
2022-09-21 17:08:45 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-21 17:08:45 INFO  ---RUNTIME: Importing and monkey-patching took 6.58869743347168 ms
2022-09-21 17:08:47 INFO  ---RUNTIME: Original pipeline execution took 2652.167320251465 ms (excluding imports and monkey-patching)
2022-09-21 17:08:47 INFO  Starting execution of 1 what-if analyses...
2022-09-21 17:08:47 INFO  Start plan generation for analysis OperatorImpact...
2022-09-21 17:08:47 INFO  ---RUNTIME: Plan generation took 5.555391311645508 ms
2022-09-21 17:08:47 INFO  Estimated runtime of original DAG is 2321.6590881347656ms
2022-09-21 17:08:47 WARNING Skipping Multi-Query Optimization (instead, only applying patches)
2022-09-21 17:08:47 INFO  Estimated unoptimised what-if runtime is 28924.96378668423ms
2022-09-21 17:08:47 INFO  ---RUNTIME: Multi-Query Optimization took 13.584613800048828 ms
2022-09-21 17:08:47 INFO  Executing generated plans
2022-09-21 17:09:15 INFO  ---RUNTIME: Execution took 27914.071083068848 ms
2022-09-21 17:09:15 INFO  Done!
2022-09-21 17:09:15 INFO  # Finished -- repetition 3 of 7 
2022-09-21 17:09:15 INFO  # Optimization benchmark for operator_impact with args [['healthcare', 'slow_loading', 'featurization_3', 'neural_network']] -- repetition 4 of 7
2022-09-21 17:09:15 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-21 17:09:15 INFO  Running instrumented original pipeline...
2022-09-21 17:09:15 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-21 17:09:15 INFO  ---RUNTIME: Importing and monkey-patching took 5.672693252563477 ms
2022-09-21 17:09:18 INFO  ---RUNTIME: Original pipeline execution took 2546.424388885498 ms (excluding imports and monkey-patching)
2022-09-21 17:09:18 INFO  Starting execution of 1 what-if analyses...
2022-09-21 17:09:18 INFO  Start plan generation for analysis OperatorImpact...
2022-09-21 17:09:18 INFO  ---RUNTIME: Plan generation took 6.139278411865234 ms
2022-09-21 17:09:18 INFO  Estimated runtime of original DAG is 2225.421667098999ms
2022-09-21 17:09:18 INFO  Performing Multi-Query Optimization
2022-09-21 17:09:18 INFO  Estimated unoptimized what-if runtime is 27742.36126850391ms
2022-09-21 17:09:18 INFO  Estimated optimised what-if runtime is 8658.543548090705ms
2022-09-21 17:09:18 INFO  Estimated optimisation runtime saving is 19083.817720413208ms
2022-09-21 17:09:18 INFO  ---RUNTIME: Multi-Query Optimization took 46.5695858001709 ms
2022-09-21 17:09:18 INFO  Executing generated plans
2022-09-21 17:09:26 INFO  ---RUNTIME: Execution took 8338.85383605957 ms
2022-09-21 17:09:26 INFO  Done!
2022-09-21 17:09:26 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-21 17:09:26 INFO  Running instrumented original pipeline...
2022-09-21 17:09:26 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-21 17:09:26 INFO  ---RUNTIME: Importing and monkey-patching took 5.656719207763672 ms
2022-09-21 17:09:29 INFO  ---RUNTIME: Original pipeline execution took 2558.5944652557373 ms (excluding imports and monkey-patching)
2022-09-21 17:09:29 INFO  Starting execution of 1 what-if analyses...
2022-09-21 17:09:29 INFO  Start plan generation for analysis OperatorImpact...
2022-09-21 17:09:29 INFO  ---RUNTIME: Plan generation took 5.462884902954102 ms
2022-09-21 17:09:29 INFO  Estimated runtime of original DAG is 2232.313394546509ms
2022-09-21 17:09:29 WARNING Skipping Multi-Query Optimization (instead, only applying patches)
2022-09-21 17:09:29 INFO  Estimated unoptimised what-if runtime is 27819.682343252774ms
2022-09-21 17:09:29 INFO  ---RUNTIME: Multi-Query Optimization took 12.885570526123047 ms
2022-09-21 17:09:29 INFO  Executing generated plans
2022-09-21 17:09:57 INFO  ---RUNTIME: Execution took 27962.2163772583 ms
2022-09-21 17:09:57 INFO  Done!
2022-09-21 17:09:57 INFO  # Finished -- repetition 4 of 7 
2022-09-21 17:09:57 INFO  # Optimization benchmark for operator_impact with args [['healthcare', 'slow_loading', 'featurization_3', 'neural_network']] -- repetition 5 of 7
2022-09-21 17:09:57 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-21 17:09:57 INFO  Running instrumented original pipeline...
2022-09-21 17:09:57 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-21 17:09:57 INFO  ---RUNTIME: Importing and monkey-patching took 6.301641464233398 ms
2022-09-21 17:09:59 INFO  ---RUNTIME: Original pipeline execution took 2752.4447441101074 ms (excluding imports and monkey-patching)
2022-09-21 17:09:59 INFO  Starting execution of 1 what-if analyses...
2022-09-21 17:09:59 INFO  Start plan generation for analysis OperatorImpact...
2022-09-21 17:09:59 INFO  ---RUNTIME: Plan generation took 12.0697021484375 ms
2022-09-21 17:09:59 INFO  Estimated runtime of original DAG is 2420.5400943756104ms
2022-09-21 17:09:59 INFO  Performing Multi-Query Optimization
2022-09-21 17:09:59 INFO  Estimated unoptimized what-if runtime is 30503.099431662726ms
2022-09-21 17:09:59 INFO  Estimated optimised what-if runtime is 11460.71218457716ms
2022-09-21 17:09:59 INFO  Estimated optimisation runtime saving is 19042.387247085564ms
2022-09-21 17:09:59 INFO  ---RUNTIME: Multi-Query Optimization took 76.14707946777344 ms
2022-09-21 17:09:59 INFO  Executing generated plans
2022-09-21 17:10:10 INFO  ---RUNTIME: Execution took 10177.690505981445 ms
2022-09-21 17:10:10 INFO  Done!
2022-09-21 17:10:10 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-21 17:10:10 INFO  Running instrumented original pipeline...
2022-09-21 17:10:10 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-21 17:10:10 INFO  ---RUNTIME: Importing and monkey-patching took 5.707740783691406 ms
2022-09-21 17:10:12 INFO  ---RUNTIME: Original pipeline execution took 2533.4525108337402 ms (excluding imports and monkey-patching)
2022-09-21 17:10:12 INFO  Starting execution of 1 what-if analyses...
2022-09-21 17:10:12 INFO  Start plan generation for analysis OperatorImpact...
2022-09-21 17:10:12 INFO  ---RUNTIME: Plan generation took 5.683183670043945 ms
2022-09-21 17:10:12 INFO  Estimated runtime of original DAG is 2208.4527015686035ms
2022-09-21 17:10:12 WARNING Skipping Multi-Query Optimization (instead, only applying patches)
2022-09-21 17:10:12 INFO  Estimated unoptimised what-if runtime is 27537.57671734382ms
2022-09-21 17:10:12 INFO  ---RUNTIME: Multi-Query Optimization took 13.065814971923828 ms
2022-09-21 17:10:12 INFO  Executing generated plans
2022-09-21 17:10:44 INFO  ---RUNTIME: Execution took 31811.713218688965 ms
2022-09-21 17:10:44 INFO  Done!
2022-09-21 17:10:44 INFO  # Finished -- repetition 5 of 7 
2022-09-21 17:10:44 INFO  # Optimization benchmark for operator_impact with args [['healthcare', 'slow_loading', 'featurization_3', 'neural_network']] -- repetition 6 of 7
2022-09-21 17:10:44 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-21 17:10:44 INFO  Running instrumented original pipeline...
2022-09-21 17:10:44 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-21 17:10:44 INFO  ---RUNTIME: Importing and monkey-patching took 6.087779998779297 ms
2022-09-21 17:10:47 INFO  ---RUNTIME: Original pipeline execution took 3125.9305477142334 ms (excluding imports and monkey-patching)
2022-09-21 17:10:47 INFO  Starting execution of 1 what-if analyses...
2022-09-21 17:10:47 INFO  Start plan generation for analysis OperatorImpact...
2022-09-21 17:10:47 INFO  ---RUNTIME: Plan generation took 8.33749771118164 ms
2022-09-21 17:10:47 INFO  Estimated runtime of original DAG is 2791.506767272949ms
2022-09-21 17:10:47 INFO  Performing Multi-Query Optimization
2022-09-21 17:10:47 INFO  Estimated unoptimized what-if runtime is 34855.8413078045ms
2022-09-21 17:10:47 INFO  Estimated optimised what-if runtime is 11195.236115620059ms
2022-09-21 17:10:47 INFO  Estimated optimisation runtime saving is 23660.60519218444ms
2022-09-21 17:10:47 INFO  ---RUNTIME: Multi-Query Optimization took 73.03452491760254 ms
2022-09-21 17:10:47 INFO  Executing generated plans
2022-09-21 17:10:57 INFO  ---RUNTIME: Execution took 9730.307579040527 ms
2022-09-21 17:10:57 INFO  Done!
2022-09-21 17:10:57 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-21 17:10:57 INFO  Running instrumented original pipeline...
2022-09-21 17:10:57 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-21 17:10:57 INFO  ---RUNTIME: Importing and monkey-patching took 6.065607070922852 ms
2022-09-21 17:11:01 INFO  ---RUNTIME: Original pipeline execution took 4180.767059326172 ms (excluding imports and monkey-patching)
2022-09-21 17:11:01 INFO  Starting execution of 1 what-if analyses...
2022-09-21 17:11:01 INFO  Start plan generation for analysis OperatorImpact...
2022-09-21 17:11:01 INFO  ---RUNTIME: Plan generation took 5.588769912719727 ms
2022-09-21 17:11:01 INFO  Estimated runtime of original DAG is 3753.3345222473145ms
2022-09-21 17:11:01 WARNING Skipping Multi-Query Optimization (instead, only applying patches)
2022-09-21 17:11:01 INFO  Estimated unoptimised what-if runtime is 48582.78228825536ms
2022-09-21 17:11:01 INFO  ---RUNTIME: Multi-Query Optimization took 13.321161270141602 ms
2022-09-21 17:11:01 INFO  Executing generated plans
2022-09-21 17:11:33 INFO  ---RUNTIME: Execution took 31918.429613113403 ms
2022-09-21 17:11:33 INFO  Done!
2022-09-21 17:11:33 INFO  # Finished -- repetition 6 of 7 
2022-09-21 17:11:33 INFO  # Optimization benchmark for operator_impact with args [['healthcare', 'slow_loading', 'featurization_3', 'neural_network']] -- repetition 7 of 7
2022-09-21 17:11:33 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-21 17:11:33 INFO  Running instrumented original pipeline...
2022-09-21 17:11:33 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-21 17:11:33 INFO  ---RUNTIME: Importing and monkey-patching took 5.695104598999023 ms
2022-09-21 17:11:36 INFO  ---RUNTIME: Original pipeline execution took 2928.330898284912 ms (excluding imports and monkey-patching)
2022-09-21 17:11:36 INFO  Starting execution of 1 what-if analyses...
2022-09-21 17:11:36 INFO  Start plan generation for analysis OperatorImpact...
2022-09-21 17:11:36 INFO  ---RUNTIME: Plan generation took 5.954742431640625 ms
2022-09-21 17:11:36 INFO  Estimated runtime of original DAG is 2607.228994369507ms
2022-09-21 17:11:36 INFO  Performing Multi-Query Optimization
2022-09-21 17:11:36 INFO  Estimated unoptimized what-if runtime is 33039.28073685745ms
2022-09-21 17:11:36 INFO  Estimated optimised what-if runtime is 13572.140062266384ms
2022-09-21 17:11:36 INFO  Estimated optimisation runtime saving is 19467.140674591064ms
2022-09-21 17:11:36 INFO  ---RUNTIME: Multi-Query Optimization took 46.22530937194824 ms
2022-09-21 17:11:36 INFO  Executing generated plans
2022-09-21 17:11:46 INFO  ---RUNTIME: Execution took 10083.458185195923 ms
2022-09-21 17:11:46 INFO  Done!
2022-09-21 17:11:46 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-21 17:11:46 INFO  Running instrumented original pipeline...
2022-09-21 17:11:46 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-21 17:11:46 INFO  ---RUNTIME: Importing and monkey-patching took 9.119749069213867 ms
2022-09-21 17:11:49 INFO  ---RUNTIME: Original pipeline execution took 2692.8112506866455 ms (excluding imports and monkey-patching)
2022-09-21 17:11:49 INFO  Starting execution of 1 what-if analyses...
2022-09-21 17:11:49 INFO  Start plan generation for analysis OperatorImpact...
2022-09-21 17:11:49 INFO  ---RUNTIME: Plan generation took 5.624532699584961 ms
2022-09-21 17:11:49 INFO  Estimated runtime of original DAG is 2334.273099899292ms
2022-09-21 17:11:49 WARNING Skipping Multi-Query Optimization (instead, only applying patches)
2022-09-21 17:11:49 INFO  Estimated unoptimised what-if runtime is 29046.534508672255ms
2022-09-21 17:11:49 INFO  ---RUNTIME: Multi-Query Optimization took 13.541698455810547 ms
2022-09-21 17:11:49 INFO  Executing generated plans
2022-09-21 17:12:21 INFO  ---RUNTIME: Execution took 32579.103708267212 ms
2022-09-21 17:12:21 INFO  Done!
2022-09-21 17:12:21 INFO  # Finished -- repetition 7 of 7 
2022-09-21 17:12:21 INFO  # Final results after all repetitions
2022-09-21 17:12:21 INFO     repetition  ... no_opt_what_if_execution_combined_model_training
0           0  ...                                      5546.754360
1           1  ...                                      5562.978268
2           2  ...                                      5917.337656
3           3  ...                                      6098.842144
4           4  ...                                      7018.129349
5           5  ...                                      7508.505583
6           6  ...                                      8322.911739

[7 rows x 26 columns]
taskset -c 128-135 PROTOCOL_BUFFERS_PYTHON_IMPLEMENTATION=python python3.9 benchmarks_end_to_end.py operator_impact healthcare slow_loading featurization_4 logistic_regression
2022-09-21 17:12:24.203668: W tensorflow/stream_executor/platform/default/dso_loader.cc:64] Could not load dynamic library 'libcudart.so.11.0'; dlerror: libcudart.so.11.0: cannot open shared object file: No such file or directory; LD_LIBRARY_PATH: /home/sgrafbe/mlwhatif/venv/lib/python3.9/site-packages/cv2/../../lib64:
2022-09-21 17:12:24.203711: I tensorflow/stream_executor/cuda/cudart_stub.cc:29] Ignore above cudart dlerror if you do not have a GPU set up on your machine.
2022-09-21 17:12:26 INFO  Patching sys.argv with ['mlwhatif', 'healthcare', 'slow_loading', 'featurization_4', 'logistic_regression']
2022-09-21 17:12:26 INFO  Running instrumented original pipeline...
2022-09-21 17:12:26 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-21 17:12:26 INFO  ---RUNTIME: Importing and monkey-patching took 162.42456436157227 ms
2022-09-21 17:12:28 INFO  ---RUNTIME: Original pipeline execution took 2229.3474674224854 ms (excluding imports and monkey-patching)
2022-09-21 17:12:28 INFO  Starting execution of 0 what-if analyses...
2022-09-21 17:12:28 INFO  Estimated runtime of original DAG is 1870.954990386963ms
2022-09-21 17:12:28 INFO  Performing Multi-Query Optimization
2022-09-21 17:12:28 INFO  Estimated unoptimized what-if runtime is 0ms
2022-09-21 17:12:28 INFO  Estimated optimised what-if runtime is 0ms
2022-09-21 17:12:28 INFO  Estimated optimisation runtime saving is 0ms
2022-09-21 17:12:28 INFO  ---RUNTIME: Multi-Query Optimization took 0.5164146423339844 ms
2022-09-21 17:12:28 INFO  Executing generated plans
2022-09-21 17:12:28 INFO  ---RUNTIME: Execution took 0.022649765014648438 ms
2022-09-21 17:12:28 INFO  Done!
2022-09-21 17:12:28 INFO  # Optimization benchmark for operator_impact with args [['healthcare', 'slow_loading', 'featurization_4', 'logistic_regression']] -- repetition 1 of 7
2022-09-21 17:12:28 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-21 17:12:28 INFO  Running instrumented original pipeline...
2022-09-21 17:12:28 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-21 17:12:28 INFO  ---RUNTIME: Importing and monkey-patching took 5.100011825561523 ms
2022-09-21 17:12:31 INFO  ---RUNTIME: Original pipeline execution took 2337.0726108551025 ms (excluding imports and monkey-patching)
2022-09-21 17:12:31 INFO  Starting execution of 1 what-if analyses...
2022-09-21 17:12:31 INFO  Start plan generation for analysis OperatorImpact...
2022-09-21 17:12:31 INFO  ---RUNTIME: Plan generation took 8.54945182800293 ms
2022-09-21 17:12:31 INFO  Estimated runtime of original DAG is 1973.7756252288818ms
2022-09-21 17:12:31 INFO  Performing Multi-Query Optimization
2022-09-21 17:12:31 INFO  Estimated unoptimized what-if runtime is 13898.805242571336ms
2022-09-21 17:12:31 INFO  Estimated optimised what-if runtime is 2145.7115230889153ms
2022-09-21 17:12:31 INFO  Estimated optimisation runtime saving is 11753.09371948242ms
2022-09-21 17:12:31 INFO  ---RUNTIME: Multi-Query Optimization took 42.11235046386719 ms
2022-09-21 17:12:31 INFO  Executing generated plans
Traceback (most recent call last):
  File "/home/sgrafbe/mlwhatif/experiments/end_to_end/benchmarks_end_to_end.py", line 228, in <module>
    analysis_result_opt = PipelineAnalyzer \
  File "/home/sgrafbe/mlwhatif/mlwhatif/_pipeline_analyzer.py", line 93, in execute
    return singleton.run(notebook_path=self._notebook_path,
  File "/home/sgrafbe/mlwhatif/mlwhatif/execution/_pipeline_executor.py", line 149, in run
    self.run_what_if_analyses()
  File "/home/sgrafbe/mlwhatif/mlwhatif/execution/_pipeline_executor.py", line 178, in run_what_if_analyses
    DagExecutor(self).execute(self.analysis_results.combined_optimized_dag)
  File "/home/sgrafbe/mlwhatif/mlwhatif/execution/_dag_executor.py", line 45, in execute
    self.traverse_graph_and_process_nodes(dag, execute_node)
  File "/home/sgrafbe/mlwhatif/mlwhatif/execution/_dag_executor.py", line 57, in traverse_graph_and_process_nodes
    result_node = func(node)
  File "/home/sgrafbe/mlwhatif/mlwhatif/execution/_dag_executor.py", line 40, in execute_node
    optimizer_info, result_df = capture_optimizer_info(executable_processing_func)
  File "/home/sgrafbe/mlwhatif/mlwhatif/execution/_stat_tracking.py", line 28, in capture_optimizer_info
    result = instrumented_function_call()
  File "/home/sgrafbe/mlwhatif/mlwhatif/monkeypatching/_patch_sklearn.py", line 1498, in processing_func
    transformed_data = transformer.fit_transform(input_df, *args[1:], **kwargs)
  File "/home/sgrafbe/mlwhatif/venv/lib64/python3.9/site-packages/sklearn/preprocessing/_encoders.py", line 410, in fit_transform
    return super().fit_transform(X, y)
  File "/home/sgrafbe/mlwhatif/venv/lib64/python3.9/site-packages/sklearn/base.py", line 693, in fit_transform
    return self.fit(X, y, **fit_params).transform(X)
  File "/home/sgrafbe/mlwhatif/venv/lib64/python3.9/site-packages/sklearn/preprocessing/_encoders.py", line 385, in fit
    self._fit(X, handle_unknown=self.handle_unknown)
  File "/home/sgrafbe/mlwhatif/venv/lib64/python3.9/site-packages/sklearn/preprocessing/_encoders.py", line 74, in _fit
    X_list, n_samples, n_features = self._check_X(X)
  File "/home/sgrafbe/mlwhatif/venv/lib64/python3.9/site-packages/sklearn/preprocessing/_encoders.py", line 60, in _check_X
    Xi = check_array(Xi, ensure_2d=False, dtype=None,
  File "/home/sgrafbe/mlwhatif/venv/lib64/python3.9/site-packages/sklearn/utils/validation.py", line 72, in inner_f
    return f(**kwargs)
  File "/home/sgrafbe/mlwhatif/venv/lib64/python3.9/site-packages/sklearn/utils/validation.py", line 644, in check_array
    _assert_all_finite(array,
  File "/home/sgrafbe/mlwhatif/venv/lib64/python3.9/site-packages/sklearn/utils/validation.py", line 104, in _assert_all_finite
    raise ValueError("Input contains NaN")
ValueError: Input contains NaN
taskset -c 128-135 PROTOCOL_BUFFERS_PYTHON_IMPLEMENTATION=python python3.9 benchmarks_end_to_end.py operator_impact healthcare slow_loading featurization_4 xgboost
2022-09-21 17:12:35.211485: W tensorflow/stream_executor/platform/default/dso_loader.cc:64] Could not load dynamic library 'libcudart.so.11.0'; dlerror: libcudart.so.11.0: cannot open shared object file: No such file or directory; LD_LIBRARY_PATH: /home/sgrafbe/mlwhatif/venv/lib/python3.9/site-packages/cv2/../../lib64:
2022-09-21 17:12:35.211532: I tensorflow/stream_executor/cuda/cudart_stub.cc:29] Ignore above cudart dlerror if you do not have a GPU set up on your machine.
2022-09-21 17:12:36 INFO  Patching sys.argv with ['mlwhatif', 'healthcare', 'slow_loading', 'featurization_4', 'xgboost']
2022-09-21 17:12:36 INFO  Running instrumented original pipeline...
2022-09-21 17:12:36 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-21 17:12:37 INFO  ---RUNTIME: Importing and monkey-patching took 161.3161563873291 ms
2022-09-21 17:12:39 INFO  ---RUNTIME: Original pipeline execution took 2811.854362487793 ms (excluding imports and monkey-patching)
2022-09-21 17:12:39 INFO  Starting execution of 0 what-if analyses...
2022-09-21 17:12:39 INFO  Estimated runtime of original DAG is 2447.481393814087ms
2022-09-21 17:12:39 INFO  Performing Multi-Query Optimization
2022-09-21 17:12:39 INFO  Estimated unoptimized what-if runtime is 0ms
2022-09-21 17:12:39 INFO  Estimated optimised what-if runtime is 0ms
2022-09-21 17:12:39 INFO  Estimated optimisation runtime saving is 0ms
2022-09-21 17:12:39 INFO  ---RUNTIME: Multi-Query Optimization took 0.4665851593017578 ms
2022-09-21 17:12:39 INFO  Executing generated plans
2022-09-21 17:12:39 INFO  ---RUNTIME: Execution took 0.02193450927734375 ms
2022-09-21 17:12:39 INFO  Done!
2022-09-21 17:12:39 INFO  # Optimization benchmark for operator_impact with args [['healthcare', 'slow_loading', 'featurization_4', 'xgboost']] -- repetition 1 of 7
2022-09-21 17:12:39 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-21 17:12:39 INFO  Running instrumented original pipeline...
2022-09-21 17:12:39 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-21 17:12:39 INFO  ---RUNTIME: Importing and monkey-patching took 5.097389221191406 ms
2022-09-21 17:12:42 INFO  ---RUNTIME: Original pipeline execution took 2340.2743339538574 ms (excluding imports and monkey-patching)
2022-09-21 17:12:42 INFO  Starting execution of 1 what-if analyses...
2022-09-21 17:12:42 INFO  Start plan generation for analysis OperatorImpact...
2022-09-21 17:12:42 INFO  ---RUNTIME: Plan generation took 5.303144454956055 ms
2022-09-21 17:12:42 INFO  Estimated runtime of original DAG is 2062.0014667510986ms
2022-09-21 17:12:42 INFO  Performing Multi-Query Optimization
2022-09-21 17:12:42 INFO  Estimated unoptimized what-if runtime is 14886.893975323645ms
2022-09-21 17:12:42 INFO  Estimated optimised what-if runtime is 3741.9926996888794ms
2022-09-21 17:12:42 INFO  Estimated optimisation runtime saving is 11144.901275634766ms
2022-09-21 17:12:42 INFO  ---RUNTIME: Multi-Query Optimization took 25.725841522216797 ms
2022-09-21 17:12:42 INFO  Executing generated plans
Traceback (most recent call last):
  File "/home/sgrafbe/mlwhatif/experiments/end_to_end/benchmarks_end_to_end.py", line 228, in <module>
    analysis_result_opt = PipelineAnalyzer \
  File "/home/sgrafbe/mlwhatif/mlwhatif/_pipeline_analyzer.py", line 93, in execute
    return singleton.run(notebook_path=self._notebook_path,
  File "/home/sgrafbe/mlwhatif/mlwhatif/execution/_pipeline_executor.py", line 149, in run
    self.run_what_if_analyses()
  File "/home/sgrafbe/mlwhatif/mlwhatif/execution/_pipeline_executor.py", line 178, in run_what_if_analyses
    DagExecutor(self).execute(self.analysis_results.combined_optimized_dag)
  File "/home/sgrafbe/mlwhatif/mlwhatif/execution/_dag_executor.py", line 45, in execute
    self.traverse_graph_and_process_nodes(dag, execute_node)
  File "/home/sgrafbe/mlwhatif/mlwhatif/execution/_dag_executor.py", line 57, in traverse_graph_and_process_nodes
    result_node = func(node)
  File "/home/sgrafbe/mlwhatif/mlwhatif/execution/_dag_executor.py", line 40, in execute_node
    optimizer_info, result_df = capture_optimizer_info(executable_processing_func)
  File "/home/sgrafbe/mlwhatif/mlwhatif/execution/_stat_tracking.py", line 28, in capture_optimizer_info
    result = instrumented_function_call()
  File "/home/sgrafbe/mlwhatif/mlwhatif/monkeypatching/_patch_sklearn.py", line 1498, in processing_func
    transformed_data = transformer.fit_transform(input_df, *args[1:], **kwargs)
  File "/home/sgrafbe/mlwhatif/venv/lib64/python3.9/site-packages/sklearn/preprocessing/_encoders.py", line 410, in fit_transform
    return super().fit_transform(X, y)
  File "/home/sgrafbe/mlwhatif/venv/lib64/python3.9/site-packages/sklearn/base.py", line 693, in fit_transform
    return self.fit(X, y, **fit_params).transform(X)
  File "/home/sgrafbe/mlwhatif/venv/lib64/python3.9/site-packages/sklearn/preprocessing/_encoders.py", line 385, in fit
    self._fit(X, handle_unknown=self.handle_unknown)
  File "/home/sgrafbe/mlwhatif/venv/lib64/python3.9/site-packages/sklearn/preprocessing/_encoders.py", line 74, in _fit
    X_list, n_samples, n_features = self._check_X(X)
  File "/home/sgrafbe/mlwhatif/venv/lib64/python3.9/site-packages/sklearn/preprocessing/_encoders.py", line 60, in _check_X
    Xi = check_array(Xi, ensure_2d=False, dtype=None,
  File "/home/sgrafbe/mlwhatif/venv/lib64/python3.9/site-packages/sklearn/utils/validation.py", line 72, in inner_f
    return f(**kwargs)
  File "/home/sgrafbe/mlwhatif/venv/lib64/python3.9/site-packages/sklearn/utils/validation.py", line 644, in check_array
    _assert_all_finite(array,
  File "/home/sgrafbe/mlwhatif/venv/lib64/python3.9/site-packages/sklearn/utils/validation.py", line 104, in _assert_all_finite
    raise ValueError("Input contains NaN")
ValueError: Input contains NaN
taskset -c 128-135 PROTOCOL_BUFFERS_PYTHON_IMPLEMENTATION=python python3.9 benchmarks_end_to_end.py operator_impact healthcare slow_loading featurization_4 neural_network
2022-09-21 17:12:45.805243: W tensorflow/stream_executor/platform/default/dso_loader.cc:64] Could not load dynamic library 'libcudart.so.11.0'; dlerror: libcudart.so.11.0: cannot open shared object file: No such file or directory; LD_LIBRARY_PATH: /home/sgrafbe/mlwhatif/venv/lib/python3.9/site-packages/cv2/../../lib64:
2022-09-21 17:12:45.805301: I tensorflow/stream_executor/cuda/cudart_stub.cc:29] Ignore above cudart dlerror if you do not have a GPU set up on your machine.
2022-09-21 17:12:47 INFO  Patching sys.argv with ['mlwhatif', 'healthcare', 'slow_loading', 'featurization_4', 'neural_network']
2022-09-21 17:12:47 INFO  Running instrumented original pipeline...
2022-09-21 17:12:47 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-21 17:12:47 INFO  ---RUNTIME: Importing and monkey-patching took 160.45641899108887 ms
2022-09-21 17:12:50.045907: W tensorflow/stream_executor/platform/default/dso_loader.cc:64] Could not load dynamic library 'libcuda.so.1'; dlerror: libcuda.so.1: cannot open shared object file: No such file or directory; LD_LIBRARY_PATH: /home/sgrafbe/mlwhatif/venv/lib/python3.9/site-packages/cv2/../../lib64:
2022-09-21 17:12:50.045943: W tensorflow/stream_executor/cuda/cuda_driver.cc:326] failed call to cuInit: UNKNOWN ERROR (303)
2022-09-21 17:12:50.045964: I tensorflow/stream_executor/cuda/cuda_diagnostics.cc:156] kernel driver does not appear to be running on this host (wagyu): /proc/driver/nvidia/version does not exist
2022-09-21 17:12:50.046405: I tensorflow/core/platform/cpu_feature_guard.cc:142] This TensorFlow binary is optimized with oneAPI Deep Neural Network Library (oneDNN) to use the following CPU instructions in performance-critical operations:  AVX2 FMA
To enable them in other operations, rebuild TensorFlow with the appropriate compiler flags.
2022-09-21 17:12:50.124951: I tensorflow/compiler/mlir/mlir_graph_optimization_pass.cc:176] None of the MLIR Optimization Passes are enabled (registered 2)
2022-09-21 17:12:50.137376: I tensorflow/core/platform/profile_utils/cpu_utils.cc:114] CPU Frequency: 2595290000 Hz
2022-09-21 17:12:50 INFO  ---RUNTIME: Original pipeline execution took 3401.2598991394043 ms (excluding imports and monkey-patching)
2022-09-21 17:12:50 INFO  Starting execution of 0 what-if analyses...
2022-09-21 17:12:50 INFO  Estimated runtime of original DAG is 3020.5512046813965ms
2022-09-21 17:12:50 INFO  Performing Multi-Query Optimization
2022-09-21 17:12:50 INFO  Estimated unoptimized what-if runtime is 0ms
2022-09-21 17:12:50 INFO  Estimated optimised what-if runtime is 0ms
2022-09-21 17:12:50 INFO  Estimated optimisation runtime saving is 0ms
2022-09-21 17:12:50 INFO  ---RUNTIME: Multi-Query Optimization took 0.4749298095703125 ms
2022-09-21 17:12:50 INFO  Executing generated plans
2022-09-21 17:12:50 INFO  ---RUNTIME: Execution took 0.0152587890625 ms
2022-09-21 17:12:50 INFO  Done!
2022-09-21 17:12:50 INFO  # Optimization benchmark for operator_impact with args [['healthcare', 'slow_loading', 'featurization_4', 'neural_network']] -- repetition 1 of 7
2022-09-21 17:12:50 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-21 17:12:50 INFO  Running instrumented original pipeline...
2022-09-21 17:12:50 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-21 17:12:50 INFO  ---RUNTIME: Importing and monkey-patching took 5.055665969848633 ms
2022-09-21 17:12:53 INFO  ---RUNTIME: Original pipeline execution took 2448.835849761963 ms (excluding imports and monkey-patching)
2022-09-21 17:12:53 INFO  Starting execution of 1 what-if analyses...
2022-09-21 17:12:53 INFO  Start plan generation for analysis OperatorImpact...
2022-09-21 17:12:53 INFO  ---RUNTIME: Plan generation took 5.879640579223633 ms
2022-09-21 17:12:53 INFO  Estimated runtime of original DAG is 2174.088954925537ms
2022-09-21 17:12:53 INFO  Performing Multi-Query Optimization
2022-09-21 17:12:53 INFO  Estimated unoptimized what-if runtime is 16049.91008988742ms
2022-09-21 17:12:53 INFO  Estimated optimised what-if runtime is 5337.178966916842ms
2022-09-21 17:12:53 INFO  Estimated optimisation runtime saving is 10712.731122970577ms
2022-09-21 17:12:53 INFO  ---RUNTIME: Multi-Query Optimization took 25.70509910583496 ms
2022-09-21 17:12:53 INFO  Executing generated plans
Traceback (most recent call last):
  File "/home/sgrafbe/mlwhatif/experiments/end_to_end/benchmarks_end_to_end.py", line 228, in <module>
    analysis_result_opt = PipelineAnalyzer \
  File "/home/sgrafbe/mlwhatif/mlwhatif/_pipeline_analyzer.py", line 93, in execute
    return singleton.run(notebook_path=self._notebook_path,
  File "/home/sgrafbe/mlwhatif/mlwhatif/execution/_pipeline_executor.py", line 149, in run
    self.run_what_if_analyses()
  File "/home/sgrafbe/mlwhatif/mlwhatif/execution/_pipeline_executor.py", line 178, in run_what_if_analyses
    DagExecutor(self).execute(self.analysis_results.combined_optimized_dag)
  File "/home/sgrafbe/mlwhatif/mlwhatif/execution/_dag_executor.py", line 45, in execute
    self.traverse_graph_and_process_nodes(dag, execute_node)
  File "/home/sgrafbe/mlwhatif/mlwhatif/execution/_dag_executor.py", line 57, in traverse_graph_and_process_nodes
    result_node = func(node)
  File "/home/sgrafbe/mlwhatif/mlwhatif/execution/_dag_executor.py", line 40, in execute_node
    optimizer_info, result_df = capture_optimizer_info(executable_processing_func)
  File "/home/sgrafbe/mlwhatif/mlwhatif/execution/_stat_tracking.py", line 28, in capture_optimizer_info
    result = instrumented_function_call()
  File "/home/sgrafbe/mlwhatif/mlwhatif/monkeypatching/_patch_sklearn.py", line 1498, in processing_func
    transformed_data = transformer.fit_transform(input_df, *args[1:], **kwargs)
  File "/home/sgrafbe/mlwhatif/venv/lib64/python3.9/site-packages/sklearn/preprocessing/_encoders.py", line 410, in fit_transform
    return super().fit_transform(X, y)
  File "/home/sgrafbe/mlwhatif/venv/lib64/python3.9/site-packages/sklearn/base.py", line 693, in fit_transform
    return self.fit(X, y, **fit_params).transform(X)
  File "/home/sgrafbe/mlwhatif/venv/lib64/python3.9/site-packages/sklearn/preprocessing/_encoders.py", line 385, in fit
    self._fit(X, handle_unknown=self.handle_unknown)
  File "/home/sgrafbe/mlwhatif/venv/lib64/python3.9/site-packages/sklearn/preprocessing/_encoders.py", line 74, in _fit
    X_list, n_samples, n_features = self._check_X(X)
  File "/home/sgrafbe/mlwhatif/venv/lib64/python3.9/site-packages/sklearn/preprocessing/_encoders.py", line 60, in _check_X
    Xi = check_array(Xi, ensure_2d=False, dtype=None,
  File "/home/sgrafbe/mlwhatif/venv/lib64/python3.9/site-packages/sklearn/utils/validation.py", line 72, in inner_f
    return f(**kwargs)
  File "/home/sgrafbe/mlwhatif/venv/lib64/python3.9/site-packages/sklearn/utils/validation.py", line 644, in check_array
    _assert_all_finite(array,
  File "/home/sgrafbe/mlwhatif/venv/lib64/python3.9/site-packages/sklearn/utils/validation.py", line 104, in _assert_all_finite
    raise ValueError("Input contains NaN")
ValueError: Input contains NaN
