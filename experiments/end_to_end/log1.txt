Variant name from 0-15: 1
Cores to use: 32-39
PROTOCOL_BUFFERS_PYTHON_IMPLEMENTATION=python taskset -c 32-39 python3.9 benchmarks_end_to_end.py feature_importance reviews fast_loading featurization_0 logistic_regression
2022-09-24 21:31:57.589324: W tensorflow/stream_executor/platform/default/dso_loader.cc:64] Could not load dynamic library 'libcudart.so.11.0'; dlerror: libcudart.so.11.0: cannot open shared object file: No such file or directory; LD_LIBRARY_PATH: /home/sgrafbe/mlwhatif/venv/lib/python3.9/site-packages/cv2/../../lib64:
2022-09-24 21:31:57.589370: I tensorflow/stream_executor/cuda/cudart_stub.cc:29] Ignore above cudart dlerror if you do not have a GPU set up on your machine.
2022-09-24 21:31:58 INFO  Patching sys.argv with ['mlwhatif', 'reviews', 'fast_loading', 'featurization_0', 'logistic_regression']
2022-09-24 21:31:58 INFO  Running instrumented original pipeline...
2022-09-24 21:31:58 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-24 21:31:59 INFO  ---RUNTIME: Importing and monkey-patching took 120.61476707458496 ms
2022-09-24 21:32:04 INFO  ---RUNTIME: Original pipeline execution took 5148.045778274536 ms (excluding imports and monkey-patching)
2022-09-24 21:32:04 INFO  Starting execution of 0 what-if analyses...
2022-09-24 21:32:04 INFO  Estimated runtime of original DAG is 4834.446668624878ms
2022-09-24 21:32:04 INFO  Performing Multi-Query Optimization
2022-09-24 21:32:04 INFO  Estimated unoptimized what-if runtime is 0ms
2022-09-24 21:32:04 INFO  Estimated optimised what-if runtime is 0ms
2022-09-24 21:32:04 INFO  Estimated optimisation runtime saving is 0ms
2022-09-24 21:32:04 INFO  ---RUNTIME: Multi-Query Optimization took 0.5004405975341797 ms
2022-09-24 21:32:04 INFO  Executing generated plans
2022-09-24 21:32:04 INFO  ---RUNTIME: Execution took 0.0286102294921875 ms
2022-09-24 21:32:04 INFO  Done!
2022-09-24 21:32:04 INFO  # Optimization benchmark for feature_importance with args [['reviews', 'fast_loading', 'featurization_0', 'logistic_regression']] -- repetition 1 of 7
2022-09-24 21:32:04 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-24 21:32:04 INFO  Running instrumented original pipeline...
2022-09-24 21:32:04 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-24 21:32:04 INFO  ---RUNTIME: Importing and monkey-patching took 5.740880966186523 ms
2022-09-24 21:32:09 INFO  ---RUNTIME: Original pipeline execution took 5239.713907241821 ms (excluding imports and monkey-patching)
2022-09-24 21:32:09 INFO  Starting execution of 1 what-if analyses...
2022-09-24 21:32:09 INFO  Start plan generation for analysis PermutationFeatureImportance...
2022-09-24 21:32:09 INFO  ---RUNTIME: Plan generation took 0.19502639770507812 ms
2022-09-24 21:32:09 INFO  Estimated runtime of original DAG is 4803.194284439087ms
2022-09-24 21:32:09 INFO  Performing Multi-Query Optimization
2022-09-24 21:32:09 INFO  Estimated unoptimized what-if runtime is 24015.971422195435ms
2022-09-24 21:32:09 INFO  Estimated optimised what-if runtime is 6111.936807632446ms
2022-09-24 21:32:09 INFO  Estimated optimisation runtime saving is 17904.03461456299ms
2022-09-24 21:32:09 INFO  ---RUNTIME: Multi-Query Optimization took 9.762287139892578 ms
2022-09-24 21:32:09 INFO  Executing generated plans
2022-09-24 21:32:15 INFO  ---RUNTIME: Execution took 6242.388010025024 ms
2022-09-24 21:32:15 INFO  Done!
2022-09-24 21:32:15 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-24 21:32:15 INFO  Running instrumented original pipeline...
2022-09-24 21:32:15 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-24 21:32:15 INFO  ---RUNTIME: Importing and monkey-patching took 6.346225738525391 ms
2022-09-24 21:32:20 INFO  ---RUNTIME: Original pipeline execution took 5097.217559814453 ms (excluding imports and monkey-patching)
2022-09-24 21:32:20 INFO  Starting execution of 1 what-if analyses...
2022-09-24 21:32:20 INFO  Start plan generation for analysis PermutationFeatureImportance...
2022-09-24 21:32:20 INFO  ---RUNTIME: Plan generation took 0.13327598571777344 ms
2022-09-24 21:32:20 INFO  Estimated runtime of original DAG is 4812.341928482056ms
2022-09-24 21:32:20 WARNING Skipping Multi-Query Optimization (instead, only applying patches)
2022-09-24 21:32:20 INFO  Estimated unoptimised what-if runtime is 24061.70964241028ms
2022-09-24 21:32:20 INFO  ---RUNTIME: Multi-Query Optimization took 3.858327865600586 ms
2022-09-24 21:32:20 INFO  Executing generated plans
2022-09-24 21:32:45 INFO  ---RUNTIME: Execution took 24560.16731262207 ms
2022-09-24 21:32:45 INFO  Done!
2022-09-24 21:32:45 INFO  # Finished -- repetition 1 of 7 
2022-09-24 21:32:45 INFO  # Optimization benchmark for feature_importance with args [['reviews', 'fast_loading', 'featurization_0', 'logistic_regression']] -- repetition 2 of 7
2022-09-24 21:32:45 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-24 21:32:45 INFO  Running instrumented original pipeline...
2022-09-24 21:32:45 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-24 21:32:45 INFO  ---RUNTIME: Importing and monkey-patching took 6.349325180053711 ms
2022-09-24 21:32:50 INFO  ---RUNTIME: Original pipeline execution took 5108.0920696258545 ms (excluding imports and monkey-patching)
2022-09-24 21:32:50 INFO  Starting execution of 1 what-if analyses...
2022-09-24 21:32:50 INFO  Start plan generation for analysis PermutationFeatureImportance...
2022-09-24 21:32:50 INFO  ---RUNTIME: Plan generation took 0.12969970703125 ms
2022-09-24 21:32:50 INFO  Estimated runtime of original DAG is 4829.075336456299ms
2022-09-24 21:32:50 INFO  Performing Multi-Query Optimization
2022-09-24 21:32:50 INFO  Estimated unoptimized what-if runtime is 24145.376682281494ms
2022-09-24 21:32:50 INFO  Estimated optimised what-if runtime is 6149.622917175293ms
2022-09-24 21:32:50 INFO  Estimated optimisation runtime saving is 17995.7537651062ms
2022-09-24 21:32:50 INFO  ---RUNTIME: Multi-Query Optimization took 9.575605392456055 ms
2022-09-24 21:32:50 INFO  Executing generated plans
2022-09-24 21:32:56 INFO  ---RUNTIME: Execution took 6239.7706508636475 ms
2022-09-24 21:32:56 INFO  Done!
2022-09-24 21:32:56 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-24 21:32:56 INFO  Running instrumented original pipeline...
2022-09-24 21:32:56 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-24 21:32:56 INFO  ---RUNTIME: Importing and monkey-patching took 6.1550140380859375 ms
2022-09-24 21:33:01 INFO  ---RUNTIME: Original pipeline execution took 5114.427328109741 ms (excluding imports and monkey-patching)
2022-09-24 21:33:01 INFO  Starting execution of 1 what-if analyses...
2022-09-24 21:33:01 INFO  Start plan generation for analysis PermutationFeatureImportance...
2022-09-24 21:33:01 INFO  ---RUNTIME: Plan generation took 0.11706352233886719 ms
2022-09-24 21:33:01 INFO  Estimated runtime of original DAG is 4825.214385986328ms
2022-09-24 21:33:01 WARNING Skipping Multi-Query Optimization (instead, only applying patches)
2022-09-24 21:33:01 INFO  Estimated unoptimised what-if runtime is 24126.07192993164ms
2022-09-24 21:33:01 INFO  ---RUNTIME: Multi-Query Optimization took 4.772663116455078 ms
2022-09-24 21:33:01 INFO  Executing generated plans
2022-09-24 21:33:26 INFO  ---RUNTIME: Execution took 24557.677268981934 ms
2022-09-24 21:33:26 INFO  Done!
2022-09-24 21:33:26 INFO  # Finished -- repetition 2 of 7 
2022-09-24 21:33:26 INFO  # Optimization benchmark for feature_importance with args [['reviews', 'fast_loading', 'featurization_0', 'logistic_regression']] -- repetition 3 of 7
2022-09-24 21:33:26 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-24 21:33:26 INFO  Running instrumented original pipeline...
2022-09-24 21:33:26 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-24 21:33:26 INFO  ---RUNTIME: Importing and monkey-patching took 6.380796432495117 ms
2022-09-24 21:33:31 INFO  ---RUNTIME: Original pipeline execution took 5123.411417007446 ms (excluding imports and monkey-patching)
2022-09-24 21:33:31 INFO  Starting execution of 1 what-if analyses...
2022-09-24 21:33:31 INFO  Start plan generation for analysis PermutationFeatureImportance...
2022-09-24 21:33:31 INFO  ---RUNTIME: Plan generation took 0.12421607971191406 ms
2022-09-24 21:33:31 INFO  Estimated runtime of original DAG is 4838.454961776733ms
2022-09-24 21:33:31 INFO  Performing Multi-Query Optimization
2022-09-24 21:33:31 INFO  Estimated unoptimized what-if runtime is 24192.274808883667ms
2022-09-24 21:33:31 INFO  Estimated optimised what-if runtime is 6141.3233280181885ms
2022-09-24 21:33:31 INFO  Estimated optimisation runtime saving is 18050.95148086548ms
2022-09-24 21:33:31 INFO  ---RUNTIME: Multi-Query Optimization took 9.586811065673828 ms
2022-09-24 21:33:31 INFO  Executing generated plans
2022-09-24 21:33:37 INFO  ---RUNTIME: Execution took 6252.760410308838 ms
2022-09-24 21:33:37 INFO  Done!
2022-09-24 21:33:37 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-24 21:33:37 INFO  Running instrumented original pipeline...
2022-09-24 21:33:37 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-24 21:33:37 INFO  ---RUNTIME: Importing and monkey-patching took 6.326913833618164 ms
2022-09-24 21:33:42 INFO  ---RUNTIME: Original pipeline execution took 5105.9019565582275 ms (excluding imports and monkey-patching)
2022-09-24 21:33:42 INFO  Starting execution of 1 what-if analyses...
2022-09-24 21:33:42 INFO  Start plan generation for analysis PermutationFeatureImportance...
2022-09-24 21:33:42 INFO  ---RUNTIME: Plan generation took 0.11730194091796875 ms
2022-09-24 21:33:42 INFO  Estimated runtime of original DAG is 4823.68540763855ms
2022-09-24 21:33:42 WARNING Skipping Multi-Query Optimization (instead, only applying patches)
2022-09-24 21:33:42 INFO  Estimated unoptimised what-if runtime is 24118.42703819275ms
2022-09-24 21:33:42 INFO  ---RUNTIME: Multi-Query Optimization took 3.7941932678222656 ms
2022-09-24 21:33:42 INFO  Executing generated plans
2022-09-24 21:34:07 INFO  ---RUNTIME: Execution took 24577.31604576111 ms
2022-09-24 21:34:07 INFO  Done!
2022-09-24 21:34:07 INFO  # Finished -- repetition 3 of 7 
2022-09-24 21:34:07 INFO  # Optimization benchmark for feature_importance with args [['reviews', 'fast_loading', 'featurization_0', 'logistic_regression']] -- repetition 4 of 7
2022-09-24 21:34:07 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-24 21:34:07 INFO  Running instrumented original pipeline...
2022-09-24 21:34:07 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-24 21:34:07 INFO  ---RUNTIME: Importing and monkey-patching took 6.004095077514648 ms
2022-09-24 21:34:12 INFO  ---RUNTIME: Original pipeline execution took 5122.162103652954 ms (excluding imports and monkey-patching)
2022-09-24 21:34:12 INFO  Starting execution of 1 what-if analyses...
2022-09-24 21:34:12 INFO  Start plan generation for analysis PermutationFeatureImportance...
2022-09-24 21:34:12 INFO  ---RUNTIME: Plan generation took 0.12755393981933594 ms
2022-09-24 21:34:12 INFO  Estimated runtime of original DAG is 4838.6290073394775ms
2022-09-24 21:34:12 INFO  Performing Multi-Query Optimization
2022-09-24 21:34:12 INFO  Estimated unoptimized what-if runtime is 24193.145036697388ms
2022-09-24 21:34:12 INFO  Estimated optimised what-if runtime is 6149.185419082642ms
2022-09-24 21:34:12 INFO  Estimated optimisation runtime saving is 18043.959617614746ms
2022-09-24 21:34:12 INFO  ---RUNTIME: Multi-Query Optimization took 9.564399719238281 ms
2022-09-24 21:34:12 INFO  Executing generated plans
2022-09-24 21:34:18 INFO  ---RUNTIME: Execution took 6232.618093490601 ms
2022-09-24 21:34:18 INFO  Done!
2022-09-24 21:34:18 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-24 21:34:18 INFO  Running instrumented original pipeline...
2022-09-24 21:34:18 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-24 21:34:18 INFO  ---RUNTIME: Importing and monkey-patching took 5.925655364990234 ms
2022-09-24 21:34:24 INFO  ---RUNTIME: Original pipeline execution took 5299.611568450928 ms (excluding imports and monkey-patching)
2022-09-24 21:34:24 INFO  Starting execution of 1 what-if analyses...
2022-09-24 21:34:24 INFO  Start plan generation for analysis PermutationFeatureImportance...
2022-09-24 21:34:24 INFO  ---RUNTIME: Plan generation took 0.10657310485839844 ms
2022-09-24 21:34:24 INFO  Estimated runtime of original DAG is 5017.346620559692ms
2022-09-24 21:34:24 WARNING Skipping Multi-Query Optimization (instead, only applying patches)
2022-09-24 21:34:24 INFO  Estimated unoptimised what-if runtime is 25086.733102798462ms
2022-09-24 21:34:24 INFO  ---RUNTIME: Multi-Query Optimization took 3.719806671142578 ms
2022-09-24 21:34:24 INFO  Executing generated plans
2022-09-24 21:34:48 INFO  ---RUNTIME: Execution took 24623.197317123413 ms
2022-09-24 21:34:48 INFO  Done!
2022-09-24 21:34:48 INFO  # Finished -- repetition 4 of 7 
2022-09-24 21:34:48 INFO  # Optimization benchmark for feature_importance with args [['reviews', 'fast_loading', 'featurization_0', 'logistic_regression']] -- repetition 5 of 7
2022-09-24 21:34:48 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-24 21:34:48 INFO  Running instrumented original pipeline...
2022-09-24 21:34:48 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-24 21:34:48 INFO  ---RUNTIME: Importing and monkey-patching took 5.913019180297852 ms
2022-09-24 21:34:53 INFO  ---RUNTIME: Original pipeline execution took 5114.083528518677 ms (excluding imports and monkey-patching)
2022-09-24 21:34:53 INFO  Starting execution of 1 what-if analyses...
2022-09-24 21:34:53 INFO  Start plan generation for analysis PermutationFeatureImportance...
2022-09-24 21:34:53 INFO  ---RUNTIME: Plan generation took 0.09846687316894531 ms
2022-09-24 21:34:53 INFO  Estimated runtime of original DAG is 4832.720756530762ms
2022-09-24 21:34:53 INFO  Performing Multi-Query Optimization
2022-09-24 21:34:53 INFO  Estimated unoptimized what-if runtime is 24163.60378265381ms
2022-09-24 21:34:53 INFO  Estimated optimised what-if runtime is 6156.635046005249ms
2022-09-24 21:34:53 INFO  Estimated optimisation runtime saving is 18006.96873664856ms
2022-09-24 21:34:53 INFO  ---RUNTIME: Multi-Query Optimization took 9.974479675292969 ms
2022-09-24 21:34:53 INFO  Executing generated plans
2022-09-24 21:35:00 INFO  ---RUNTIME: Execution took 6275.799751281738 ms
2022-09-24 21:35:00 INFO  Done!
2022-09-24 21:35:00 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-24 21:35:00 INFO  Running instrumented original pipeline...
2022-09-24 21:35:00 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-24 21:35:00 INFO  ---RUNTIME: Importing and monkey-patching took 6.149768829345703 ms
2022-09-24 21:35:05 INFO  ---RUNTIME: Original pipeline execution took 5117.246627807617 ms (excluding imports and monkey-patching)
2022-09-24 21:35:05 INFO  Starting execution of 1 what-if analyses...
2022-09-24 21:35:05 INFO  Start plan generation for analysis PermutationFeatureImportance...
2022-09-24 21:35:05 INFO  ---RUNTIME: Plan generation took 0.11658668518066406 ms
2022-09-24 21:35:05 INFO  Estimated runtime of original DAG is 4832.330226898193ms
2022-09-24 21:35:05 WARNING Skipping Multi-Query Optimization (instead, only applying patches)
2022-09-24 21:35:05 INFO  Estimated unoptimised what-if runtime is 24161.651134490967ms
2022-09-24 21:35:05 INFO  ---RUNTIME: Multi-Query Optimization took 3.7505626678466797 ms
2022-09-24 21:35:05 INFO  Executing generated plans
2022-09-24 21:35:30 INFO  ---RUNTIME: Execution took 24617.568254470825 ms
2022-09-24 21:35:30 INFO  Done!
2022-09-24 21:35:30 INFO  # Finished -- repetition 5 of 7 
2022-09-24 21:35:30 INFO  # Optimization benchmark for feature_importance with args [['reviews', 'fast_loading', 'featurization_0', 'logistic_regression']] -- repetition 6 of 7
2022-09-24 21:35:30 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-24 21:35:30 INFO  Running instrumented original pipeline...
2022-09-24 21:35:30 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-24 21:35:30 INFO  ---RUNTIME: Importing and monkey-patching took 6.122350692749023 ms
2022-09-24 21:35:35 INFO  ---RUNTIME: Original pipeline execution took 5102.1013259887695 ms (excluding imports and monkey-patching)
2022-09-24 21:35:35 INFO  Starting execution of 1 what-if analyses...
2022-09-24 21:35:35 INFO  Start plan generation for analysis PermutationFeatureImportance...
2022-09-24 21:35:35 INFO  ---RUNTIME: Plan generation took 0.10514259338378906 ms
2022-09-24 21:35:35 INFO  Estimated runtime of original DAG is 4817.281723022461ms
2022-09-24 21:35:35 INFO  Performing Multi-Query Optimization
2022-09-24 21:35:35 INFO  Estimated unoptimized what-if runtime is 24086.408615112305ms
2022-09-24 21:35:35 INFO  Estimated optimised what-if runtime is 6122.653961181641ms
2022-09-24 21:35:35 INFO  Estimated optimisation runtime saving is 17963.754653930664ms
2022-09-24 21:35:35 INFO  ---RUNTIME: Multi-Query Optimization took 10.215520858764648 ms
2022-09-24 21:35:35 INFO  Executing generated plans
2022-09-24 21:35:41 INFO  ---RUNTIME: Execution took 6244.852066040039 ms
2022-09-24 21:35:41 INFO  Done!
2022-09-24 21:35:41 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-24 21:35:41 INFO  Running instrumented original pipeline...
2022-09-24 21:35:41 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-24 21:35:41 INFO  ---RUNTIME: Importing and monkey-patching took 5.857944488525391 ms
2022-09-24 21:35:46 INFO  ---RUNTIME: Original pipeline execution took 5093.136310577393 ms (excluding imports and monkey-patching)
2022-09-24 21:35:46 INFO  Starting execution of 1 what-if analyses...
2022-09-24 21:35:46 INFO  Start plan generation for analysis PermutationFeatureImportance...
2022-09-24 21:35:46 INFO  ---RUNTIME: Plan generation took 0.10275840759277344 ms
2022-09-24 21:35:46 INFO  Estimated runtime of original DAG is 4812.047243118286ms
2022-09-24 21:35:46 WARNING Skipping Multi-Query Optimization (instead, only applying patches)
2022-09-24 21:35:46 INFO  Estimated unoptimised what-if runtime is 24060.23621559143ms
2022-09-24 21:35:46 INFO  ---RUNTIME: Multi-Query Optimization took 3.6973953247070312 ms
2022-09-24 21:35:46 INFO  Executing generated plans
2022-09-24 21:36:11 INFO  ---RUNTIME: Execution took 24558.912992477417 ms
2022-09-24 21:36:11 INFO  Done!
2022-09-24 21:36:11 INFO  # Finished -- repetition 6 of 7 
2022-09-24 21:36:11 INFO  # Optimization benchmark for feature_importance with args [['reviews', 'fast_loading', 'featurization_0', 'logistic_regression']] -- repetition 7 of 7
2022-09-24 21:36:11 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-24 21:36:11 INFO  Running instrumented original pipeline...
2022-09-24 21:36:11 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-24 21:36:11 INFO  ---RUNTIME: Importing and monkey-patching took 6.265163421630859 ms
2022-09-24 21:36:16 INFO  ---RUNTIME: Original pipeline execution took 5100.714445114136 ms (excluding imports and monkey-patching)
2022-09-24 21:36:16 INFO  Starting execution of 1 what-if analyses...
2022-09-24 21:36:16 INFO  Start plan generation for analysis PermutationFeatureImportance...
2022-09-24 21:36:16 INFO  ---RUNTIME: Plan generation took 0.11944770812988281 ms
2022-09-24 21:36:16 INFO  Estimated runtime of original DAG is 4817.739725112915ms
2022-09-24 21:36:16 INFO  Performing Multi-Query Optimization
2022-09-24 21:36:16 INFO  Estimated unoptimized what-if runtime is 24088.698625564575ms
2022-09-24 21:36:16 INFO  Estimated optimised what-if runtime is 6123.364448547363ms
2022-09-24 21:36:16 INFO  Estimated optimisation runtime saving is 17965.334177017212ms
2022-09-24 21:36:16 INFO  ---RUNTIME: Multi-Query Optimization took 10.351419448852539 ms
2022-09-24 21:36:16 INFO  Executing generated plans
2022-09-24 21:36:22 INFO  ---RUNTIME: Execution took 6241.524696350098 ms
2022-09-24 21:36:22 INFO  Done!
2022-09-24 21:36:22 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-24 21:36:22 INFO  Running instrumented original pipeline...
2022-09-24 21:36:22 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-24 21:36:22 INFO  ---RUNTIME: Importing and monkey-patching took 5.887508392333984 ms
2022-09-24 21:36:27 INFO  ---RUNTIME: Original pipeline execution took 5109.415769577026 ms (excluding imports and monkey-patching)
2022-09-24 21:36:27 INFO  Starting execution of 1 what-if analyses...
2022-09-24 21:36:27 INFO  Start plan generation for analysis PermutationFeatureImportance...
2022-09-24 21:36:27 INFO  ---RUNTIME: Plan generation took 0.09560585021972656 ms
2022-09-24 21:36:27 INFO  Estimated runtime of original DAG is 4826.629400253296ms
2022-09-24 21:36:27 WARNING Skipping Multi-Query Optimization (instead, only applying patches)
2022-09-24 21:36:27 INFO  Estimated unoptimised what-if runtime is 24133.14700126648ms
2022-09-24 21:36:27 INFO  ---RUNTIME: Multi-Query Optimization took 3.759145736694336 ms
2022-09-24 21:36:27 INFO  Executing generated plans
2022-09-24 21:36:52 INFO  ---RUNTIME: Execution took 24616.466999053955 ms
2022-09-24 21:36:52 INFO  Done!
2022-09-24 21:36:52 INFO  # Finished -- repetition 7 of 7 
2022-09-24 21:36:52 INFO  # Final results after all repetitions
2022-09-24 21:36:52 INFO     repetition  ... no_opt_what_if_execution_combined_model_training
0           0  ...                                       797.072172
1           1  ...                                       794.012308
2           2  ...                                       793.817997
3           3  ...                                       793.398380
4           4  ...                                       789.132357
5           5  ...                                       790.005207
6           6  ...                                       798.754930

[7 rows x 26 columns]
PROTOCOL_BUFFERS_PYTHON_IMPLEMENTATION=python taskset -c 32-39 python3.9 benchmarks_end_to_end.py feature_importance reviews fast_loading featurization_0 xgboost
2022-09-24 21:36:54.345770: W tensorflow/stream_executor/platform/default/dso_loader.cc:64] Could not load dynamic library 'libcudart.so.11.0'; dlerror: libcudart.so.11.0: cannot open shared object file: No such file or directory; LD_LIBRARY_PATH: /home/sgrafbe/mlwhatif/venv/lib/python3.9/site-packages/cv2/../../lib64:
2022-09-24 21:36:54.345817: I tensorflow/stream_executor/cuda/cudart_stub.cc:29] Ignore above cudart dlerror if you do not have a GPU set up on your machine.
2022-09-24 21:36:55 INFO  Patching sys.argv with ['mlwhatif', 'reviews', 'fast_loading', 'featurization_0', 'xgboost']
2022-09-24 21:36:55 INFO  Running instrumented original pipeline...
2022-09-24 21:36:55 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-24 21:36:55 INFO  ---RUNTIME: Importing and monkey-patching took 121.37389183044434 ms
2022-09-24 21:37:02 INFO  ---RUNTIME: Original pipeline execution took 7224.904775619507 ms (excluding imports and monkey-patching)
2022-09-24 21:37:02 INFO  Starting execution of 0 what-if analyses...
2022-09-24 21:37:02 INFO  Estimated runtime of original DAG is 6910.237550735474ms
2022-09-24 21:37:02 INFO  Performing Multi-Query Optimization
2022-09-24 21:37:02 INFO  Estimated unoptimized what-if runtime is 0ms
2022-09-24 21:37:02 INFO  Estimated optimised what-if runtime is 0ms
2022-09-24 21:37:02 INFO  Estimated optimisation runtime saving is 0ms
2022-09-24 21:37:02 INFO  ---RUNTIME: Multi-Query Optimization took 0.47969818115234375 ms
2022-09-24 21:37:02 INFO  Executing generated plans
2022-09-24 21:37:02 INFO  ---RUNTIME: Execution took 0.027179718017578125 ms
2022-09-24 21:37:02 INFO  Done!
2022-09-24 21:37:02 INFO  # Optimization benchmark for feature_importance with args [['reviews', 'fast_loading', 'featurization_0', 'xgboost']] -- repetition 1 of 7
2022-09-24 21:37:02 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-24 21:37:02 INFO  Running instrumented original pipeline...
2022-09-24 21:37:03 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-24 21:37:03 INFO  ---RUNTIME: Importing and monkey-patching took 5.771636962890625 ms
2022-09-24 21:37:10 INFO  ---RUNTIME: Original pipeline execution took 7309.4799518585205 ms (excluding imports and monkey-patching)
2022-09-24 21:37:10 INFO  Starting execution of 1 what-if analyses...
2022-09-24 21:37:10 INFO  Start plan generation for analysis PermutationFeatureImportance...
2022-09-24 21:37:10 INFO  ---RUNTIME: Plan generation took 0.18548965454101562 ms
2022-09-24 21:37:10 INFO  Estimated runtime of original DAG is 6865.007400512695ms
2022-09-24 21:37:10 INFO  Performing Multi-Query Optimization
2022-09-24 21:37:10 INFO  Estimated unoptimized what-if runtime is 34325.03700256348ms
2022-09-24 21:37:10 INFO  Estimated optimised what-if runtime is 9373.605489730835ms
2022-09-24 21:37:10 INFO  Estimated optimisation runtime saving is 24951.43151283264ms
2022-09-24 21:37:10 INFO  ---RUNTIME: Multi-Query Optimization took 9.794950485229492 ms
2022-09-24 21:37:10 INFO  Executing generated plans
2022-09-24 21:37:19 INFO  ---RUNTIME: Execution took 9420.931100845337 ms
2022-09-24 21:37:19 INFO  Done!
2022-09-24 21:37:19 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-24 21:37:19 INFO  Running instrumented original pipeline...
2022-09-24 21:37:19 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-24 21:37:19 INFO  ---RUNTIME: Importing and monkey-patching took 6.077051162719727 ms
2022-09-24 21:37:26 INFO  ---RUNTIME: Original pipeline execution took 7140.845537185669 ms (excluding imports and monkey-patching)
2022-09-24 21:37:26 INFO  Starting execution of 1 what-if analyses...
2022-09-24 21:37:26 INFO  Start plan generation for analysis PermutationFeatureImportance...
2022-09-24 21:37:26 INFO  ---RUNTIME: Plan generation took 0.1304149627685547 ms
2022-09-24 21:37:26 INFO  Estimated runtime of original DAG is 6860.119819641113ms
2022-09-24 21:37:26 WARNING Skipping Multi-Query Optimization (instead, only applying patches)
2022-09-24 21:37:26 INFO  Estimated unoptimised what-if runtime is 34300.59909820557ms
2022-09-24 21:37:26 INFO  ---RUNTIME: Multi-Query Optimization took 3.8089752197265625 ms
2022-09-24 21:37:26 INFO  Executing generated plans
2022-09-24 21:38:01 INFO  ---RUNTIME: Execution took 34543.7867641449 ms
2022-09-24 21:38:01 INFO  Done!
2022-09-24 21:38:01 INFO  # Finished -- repetition 1 of 7 
2022-09-24 21:38:01 INFO  # Optimization benchmark for feature_importance with args [['reviews', 'fast_loading', 'featurization_0', 'xgboost']] -- repetition 2 of 7
2022-09-24 21:38:01 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-24 21:38:01 INFO  Running instrumented original pipeline...
2022-09-24 21:38:01 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-24 21:38:01 INFO  ---RUNTIME: Importing and monkey-patching took 6.751537322998047 ms
2022-09-24 21:38:08 INFO  ---RUNTIME: Original pipeline execution took 7143.7108516693115 ms (excluding imports and monkey-patching)
2022-09-24 21:38:08 INFO  Starting execution of 1 what-if analyses...
2022-09-24 21:38:08 INFO  Start plan generation for analysis PermutationFeatureImportance...
2022-09-24 21:38:08 INFO  ---RUNTIME: Plan generation took 0.1354217529296875 ms
2022-09-24 21:38:08 INFO  Estimated runtime of original DAG is 6859.906911849976ms
2022-09-24 21:38:08 INFO  Performing Multi-Query Optimization
2022-09-24 21:38:08 INFO  Estimated unoptimized what-if runtime is 34299.53455924988ms
2022-09-24 21:38:08 INFO  Estimated optimised what-if runtime is 9355.546236038208ms
2022-09-24 21:38:08 INFO  Estimated optimisation runtime saving is 24943.98832321167ms
2022-09-24 21:38:08 INFO  ---RUNTIME: Multi-Query Optimization took 9.580135345458984 ms
2022-09-24 21:38:08 INFO  Executing generated plans
2022-09-24 21:38:17 INFO  ---RUNTIME: Execution took 9414.337873458862 ms
2022-09-24 21:38:17 INFO  Done!
2022-09-24 21:38:18 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-24 21:38:18 INFO  Running instrumented original pipeline...
2022-09-24 21:38:18 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-24 21:38:18 INFO  ---RUNTIME: Importing and monkey-patching took 6.001949310302734 ms
2022-09-24 21:38:25 INFO  ---RUNTIME: Original pipeline execution took 7141.67594909668 ms (excluding imports and monkey-patching)
2022-09-24 21:38:25 INFO  Starting execution of 1 what-if analyses...
2022-09-24 21:38:25 INFO  Start plan generation for analysis PermutationFeatureImportance...
2022-09-24 21:38:25 INFO  ---RUNTIME: Plan generation took 0.10156631469726562 ms
2022-09-24 21:38:25 INFO  Estimated runtime of original DAG is 6856.2986850738525ms
2022-09-24 21:38:25 WARNING Skipping Multi-Query Optimization (instead, only applying patches)
2022-09-24 21:38:25 INFO  Estimated unoptimised what-if runtime is 34281.49342536926ms
2022-09-24 21:38:25 INFO  ---RUNTIME: Multi-Query Optimization took 4.539251327514648 ms
2022-09-24 21:38:25 INFO  Executing generated plans
2022-09-24 21:38:59 INFO  ---RUNTIME: Execution took 34539.12854194641 ms
2022-09-24 21:38:59 INFO  Done!
2022-09-24 21:38:59 INFO  # Finished -- repetition 2 of 7 
2022-09-24 21:38:59 INFO  # Optimization benchmark for feature_importance with args [['reviews', 'fast_loading', 'featurization_0', 'xgboost']] -- repetition 3 of 7
2022-09-24 21:38:59 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-24 21:38:59 INFO  Running instrumented original pipeline...
2022-09-24 21:38:59 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-24 21:38:59 INFO  ---RUNTIME: Importing and monkey-patching took 6.310224533081055 ms
2022-09-24 21:39:06 INFO  ---RUNTIME: Original pipeline execution took 7133.023023605347 ms (excluding imports and monkey-patching)
2022-09-24 21:39:06 INFO  Starting execution of 1 what-if analyses...
2022-09-24 21:39:06 INFO  Start plan generation for analysis PermutationFeatureImportance...
2022-09-24 21:39:06 INFO  ---RUNTIME: Plan generation took 0.11777877807617188 ms
2022-09-24 21:39:06 INFO  Estimated runtime of original DAG is 6849.828243255615ms
2022-09-24 21:39:06 INFO  Performing Multi-Query Optimization
2022-09-24 21:39:06 INFO  Estimated unoptimized what-if runtime is 34249.141216278076ms
2022-09-24 21:39:06 INFO  Estimated optimised what-if runtime is 9330.857276916504ms
2022-09-24 21:39:06 INFO  Estimated optimisation runtime saving is 24918.283939361572ms
2022-09-24 21:39:06 INFO  ---RUNTIME: Multi-Query Optimization took 9.534358978271484 ms
2022-09-24 21:39:06 INFO  Executing generated plans
2022-09-24 21:39:16 INFO  ---RUNTIME: Execution took 9420.064926147461 ms
2022-09-24 21:39:16 INFO  Done!
2022-09-24 21:39:16 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-24 21:39:16 INFO  Running instrumented original pipeline...
2022-09-24 21:39:16 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-24 21:39:16 INFO  ---RUNTIME: Importing and monkey-patching took 6.208896636962891 ms
2022-09-24 21:39:23 INFO  ---RUNTIME: Original pipeline execution took 7129.0178298950195 ms (excluding imports and monkey-patching)
2022-09-24 21:39:23 INFO  Starting execution of 1 what-if analyses...
2022-09-24 21:39:23 INFO  Start plan generation for analysis PermutationFeatureImportance...
2022-09-24 21:39:23 INFO  ---RUNTIME: Plan generation took 0.11515617370605469 ms
2022-09-24 21:39:23 INFO  Estimated runtime of original DAG is 6843.770265579224ms
2022-09-24 21:39:23 WARNING Skipping Multi-Query Optimization (instead, only applying patches)
2022-09-24 21:39:23 INFO  Estimated unoptimised what-if runtime is 34218.85132789612ms
2022-09-24 21:39:23 INFO  ---RUNTIME: Multi-Query Optimization took 4.490852355957031 ms
2022-09-24 21:39:23 INFO  Executing generated plans
2022-09-24 21:39:58 INFO  ---RUNTIME: Execution took 34589.269161224365 ms
2022-09-24 21:39:58 INFO  Done!
2022-09-24 21:39:58 INFO  # Finished -- repetition 3 of 7 
2022-09-24 21:39:58 INFO  # Optimization benchmark for feature_importance with args [['reviews', 'fast_loading', 'featurization_0', 'xgboost']] -- repetition 4 of 7
2022-09-24 21:39:58 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-24 21:39:58 INFO  Running instrumented original pipeline...
2022-09-24 21:39:58 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-24 21:39:58 INFO  ---RUNTIME: Importing and monkey-patching took 6.379604339599609 ms
2022-09-24 21:40:05 INFO  ---RUNTIME: Original pipeline execution took 7141.542911529541 ms (excluding imports and monkey-patching)
2022-09-24 21:40:05 INFO  Starting execution of 1 what-if analyses...
2022-09-24 21:40:05 INFO  Start plan generation for analysis PermutationFeatureImportance...
2022-09-24 21:40:05 INFO  ---RUNTIME: Plan generation took 0.11277198791503906 ms
2022-09-24 21:40:05 INFO  Estimated runtime of original DAG is 6858.255863189697ms
2022-09-24 21:40:05 INFO  Performing Multi-Query Optimization
2022-09-24 21:40:05 INFO  Estimated unoptimized what-if runtime is 34291.279315948486ms
2022-09-24 21:40:05 INFO  Estimated optimised what-if runtime is 9348.127126693726ms
2022-09-24 21:40:05 INFO  Estimated optimisation runtime saving is 24943.15218925476ms
2022-09-24 21:40:05 INFO  ---RUNTIME: Multi-Query Optimization took 9.488344192504883 ms
2022-09-24 21:40:05 INFO  Executing generated plans
2022-09-24 21:40:14 INFO  ---RUNTIME: Execution took 9421.362400054932 ms
2022-09-24 21:40:14 INFO  Done!
2022-09-24 21:40:14 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-24 21:40:14 INFO  Running instrumented original pipeline...
2022-09-24 21:40:14 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-24 21:40:14 INFO  ---RUNTIME: Importing and monkey-patching took 5.920886993408203 ms
2022-09-24 21:40:21 INFO  ---RUNTIME: Original pipeline execution took 7155.055284500122 ms (excluding imports and monkey-patching)
2022-09-24 21:40:21 INFO  Starting execution of 1 what-if analyses...
2022-09-24 21:40:21 INFO  Start plan generation for analysis PermutationFeatureImportance...
2022-09-24 21:40:21 INFO  ---RUNTIME: Plan generation took 0.11205673217773438 ms
2022-09-24 21:40:21 INFO  Estimated runtime of original DAG is 6870.417594909668ms
2022-09-24 21:40:21 WARNING Skipping Multi-Query Optimization (instead, only applying patches)
2022-09-24 21:40:22 INFO  Estimated unoptimised what-if runtime is 34352.08797454834ms
2022-09-24 21:40:22 INFO  ---RUNTIME: Multi-Query Optimization took 202.4531364440918 ms
2022-09-24 21:40:22 INFO  Executing generated plans
2022-09-24 21:40:56 INFO  ---RUNTIME: Execution took 34659.157276153564 ms
2022-09-24 21:40:56 INFO  Done!
2022-09-24 21:40:56 INFO  # Finished -- repetition 4 of 7 
2022-09-24 21:40:56 INFO  # Optimization benchmark for feature_importance with args [['reviews', 'fast_loading', 'featurization_0', 'xgboost']] -- repetition 5 of 7
2022-09-24 21:40:56 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-24 21:40:56 INFO  Running instrumented original pipeline...
2022-09-24 21:40:56 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-24 21:40:56 INFO  ---RUNTIME: Importing and monkey-patching took 6.187677383422852 ms
2022-09-24 21:41:03 INFO  ---RUNTIME: Original pipeline execution took 7140.701770782471 ms (excluding imports and monkey-patching)
2022-09-24 21:41:03 INFO  Starting execution of 1 what-if analyses...
2022-09-24 21:41:03 INFO  Start plan generation for analysis PermutationFeatureImportance...
2022-09-24 21:41:03 INFO  ---RUNTIME: Plan generation took 0.11491775512695312 ms
2022-09-24 21:41:03 INFO  Estimated runtime of original DAG is 6855.989456176758ms
2022-09-24 21:41:03 INFO  Performing Multi-Query Optimization
2022-09-24 21:41:03 INFO  Estimated unoptimized what-if runtime is 34279.94728088379ms
2022-09-24 21:41:03 INFO  Estimated optimised what-if runtime is 9348.120212554932ms
2022-09-24 21:41:03 INFO  Estimated optimisation runtime saving is 24931.827068328857ms
2022-09-24 21:41:03 INFO  ---RUNTIME: Multi-Query Optimization took 10.012626647949219 ms
2022-09-24 21:41:03 INFO  Executing generated plans
2022-09-24 21:41:13 INFO  ---RUNTIME: Execution took 9424.38817024231 ms
2022-09-24 21:41:13 INFO  Done!
2022-09-24 21:41:13 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-24 21:41:13 INFO  Running instrumented original pipeline...
2022-09-24 21:41:13 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-24 21:41:13 INFO  ---RUNTIME: Importing and monkey-patching took 6.387948989868164 ms
2022-09-24 21:41:20 INFO  ---RUNTIME: Original pipeline execution took 7122.546434402466 ms (excluding imports and monkey-patching)
2022-09-24 21:41:20 INFO  Starting execution of 1 what-if analyses...
2022-09-24 21:41:20 INFO  Start plan generation for analysis PermutationFeatureImportance...
2022-09-24 21:41:20 INFO  ---RUNTIME: Plan generation took 0.10085105895996094 ms
2022-09-24 21:41:20 INFO  Estimated runtime of original DAG is 6838.78231048584ms
2022-09-24 21:41:20 WARNING Skipping Multi-Query Optimization (instead, only applying patches)
2022-09-24 21:41:20 INFO  Estimated unoptimised what-if runtime is 34193.9115524292ms
2022-09-24 21:41:20 INFO  ---RUNTIME: Multi-Query Optimization took 3.7102699279785156 ms
2022-09-24 21:41:20 INFO  Executing generated plans
2022-09-24 21:41:55 INFO  ---RUNTIME: Execution took 34575.602531433105 ms
2022-09-24 21:41:55 INFO  Done!
2022-09-24 21:41:55 INFO  # Finished -- repetition 5 of 7 
2022-09-24 21:41:55 INFO  # Optimization benchmark for feature_importance with args [['reviews', 'fast_loading', 'featurization_0', 'xgboost']] -- repetition 6 of 7
2022-09-24 21:41:55 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-24 21:41:55 INFO  Running instrumented original pipeline...
2022-09-24 21:41:55 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-24 21:41:55 INFO  ---RUNTIME: Importing and monkey-patching took 6.360054016113281 ms
2022-09-24 21:42:02 INFO  ---RUNTIME: Original pipeline execution took 7149.878025054932 ms (excluding imports and monkey-patching)
2022-09-24 21:42:02 INFO  Starting execution of 1 what-if analyses...
2022-09-24 21:42:02 INFO  Start plan generation for analysis PermutationFeatureImportance...
2022-09-24 21:42:02 INFO  ---RUNTIME: Plan generation took 0.1266002655029297 ms
2022-09-24 21:42:02 INFO  Estimated runtime of original DAG is 6863.239526748657ms
2022-09-24 21:42:02 INFO  Performing Multi-Query Optimization
2022-09-24 21:42:02 INFO  Estimated unoptimized what-if runtime is 34316.197633743286ms
2022-09-24 21:42:02 INFO  Estimated optimised what-if runtime is 9365.871906280518ms
2022-09-24 21:42:02 INFO  Estimated optimisation runtime saving is 24950.32572746277ms
2022-09-24 21:42:02 INFO  ---RUNTIME: Multi-Query Optimization took 10.396480560302734 ms
2022-09-24 21:42:02 INFO  Executing generated plans
2022-09-24 21:42:11 INFO  ---RUNTIME: Execution took 9438.748121261597 ms
2022-09-24 21:42:11 INFO  Done!
2022-09-24 21:42:11 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-24 21:42:11 INFO  Running instrumented original pipeline...
2022-09-24 21:42:11 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-24 21:42:11 INFO  ---RUNTIME: Importing and monkey-patching took 5.947351455688477 ms
2022-09-24 21:42:18 INFO  ---RUNTIME: Original pipeline execution took 7140.260696411133 ms (excluding imports and monkey-patching)
2022-09-24 21:42:18 INFO  Starting execution of 1 what-if analyses...
2022-09-24 21:42:18 INFO  Start plan generation for analysis PermutationFeatureImportance...
2022-09-24 21:42:18 INFO  ---RUNTIME: Plan generation took 0.09560585021972656 ms
2022-09-24 21:42:18 INFO  Estimated runtime of original DAG is 6854.632139205933ms
2022-09-24 21:42:18 WARNING Skipping Multi-Query Optimization (instead, only applying patches)
2022-09-24 21:42:18 INFO  Estimated unoptimised what-if runtime is 34273.16069602966ms
2022-09-24 21:42:18 INFO  ---RUNTIME: Multi-Query Optimization took 3.7126541137695312 ms
2022-09-24 21:42:18 INFO  Executing generated plans
2022-09-24 21:42:53 INFO  ---RUNTIME: Execution took 34646.257638931274 ms
2022-09-24 21:42:53 INFO  Done!
2022-09-24 21:42:53 INFO  # Finished -- repetition 6 of 7 
2022-09-24 21:42:53 INFO  # Optimization benchmark for feature_importance with args [['reviews', 'fast_loading', 'featurization_0', 'xgboost']] -- repetition 7 of 7
2022-09-24 21:42:53 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-24 21:42:53 INFO  Running instrumented original pipeline...
2022-09-24 21:42:53 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-24 21:42:53 INFO  ---RUNTIME: Importing and monkey-patching took 6.458044052124023 ms
2022-09-24 21:43:00 INFO  ---RUNTIME: Original pipeline execution took 7142.982959747314 ms (excluding imports and monkey-patching)
2022-09-24 21:43:00 INFO  Starting execution of 1 what-if analyses...
2022-09-24 21:43:00 INFO  Start plan generation for analysis PermutationFeatureImportance...
2022-09-24 21:43:00 INFO  ---RUNTIME: Plan generation took 0.11754035949707031 ms
2022-09-24 21:43:00 INFO  Estimated runtime of original DAG is 6855.350017547607ms
2022-09-24 21:43:00 INFO  Performing Multi-Query Optimization
2022-09-24 21:43:00 INFO  Estimated unoptimized what-if runtime is 34276.75008773804ms
2022-09-24 21:43:00 INFO  Estimated optimised what-if runtime is 9354.925632476807ms
2022-09-24 21:43:00 INFO  Estimated optimisation runtime saving is 24921.82445526123ms
2022-09-24 21:43:00 INFO  ---RUNTIME: Multi-Query Optimization took 10.5133056640625 ms
2022-09-24 21:43:00 INFO  Executing generated plans
2022-09-24 21:43:10 INFO  ---RUNTIME: Execution took 9430.937767028809 ms
2022-09-24 21:43:10 INFO  Done!
2022-09-24 21:43:10 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-24 21:43:10 INFO  Running instrumented original pipeline...
2022-09-24 21:43:10 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-24 21:43:10 INFO  ---RUNTIME: Importing and monkey-patching took 6.0558319091796875 ms
2022-09-24 21:43:17 INFO  ---RUNTIME: Original pipeline execution took 7149.471282958984 ms (excluding imports and monkey-patching)
2022-09-24 21:43:17 INFO  Starting execution of 1 what-if analyses...
2022-09-24 21:43:17 INFO  Start plan generation for analysis PermutationFeatureImportance...
2022-09-24 21:43:17 INFO  ---RUNTIME: Plan generation took 0.12421607971191406 ms
2022-09-24 21:43:17 INFO  Estimated runtime of original DAG is 6862.208127975464ms
2022-09-24 21:43:17 WARNING Skipping Multi-Query Optimization (instead, only applying patches)
2022-09-24 21:43:17 INFO  Estimated unoptimised what-if runtime is 34311.04063987732ms
2022-09-24 21:43:17 INFO  ---RUNTIME: Multi-Query Optimization took 3.8847923278808594 ms
2022-09-24 21:43:17 INFO  Executing generated plans
2022-09-24 21:43:52 INFO  ---RUNTIME: Execution took 35005.86414337158 ms
2022-09-24 21:43:52 INFO  Done!
2022-09-24 21:43:52 INFO  # Finished -- repetition 7 of 7 
2022-09-24 21:43:52 INFO  # Final results after all repetitions
2022-09-24 21:43:52 INFO     repetition  ... no_opt_what_if_execution_combined_model_training
0           0  ...                                      9426.185131
1           1  ...                                      9409.587860
2           2  ...                                      9410.171032
3           3  ...                                      9414.723158
4           4  ...                                      9407.619953
5           5  ...                                      9416.886568
6           6  ...                                      9533.552647

[7 rows x 26 columns]
PROTOCOL_BUFFERS_PYTHON_IMPLEMENTATION=python taskset -c 32-39 python3.9 benchmarks_end_to_end.py feature_importance reviews fast_loading featurization_0 neural_network
2022-09-24 21:43:54.400479: W tensorflow/stream_executor/platform/default/dso_loader.cc:64] Could not load dynamic library 'libcudart.so.11.0'; dlerror: libcudart.so.11.0: cannot open shared object file: No such file or directory; LD_LIBRARY_PATH: /home/sgrafbe/mlwhatif/venv/lib/python3.9/site-packages/cv2/../../lib64:
2022-09-24 21:43:54.400526: I tensorflow/stream_executor/cuda/cudart_stub.cc:29] Ignore above cudart dlerror if you do not have a GPU set up on your machine.
2022-09-24 21:43:55 INFO  Patching sys.argv with ['mlwhatif', 'reviews', 'fast_loading', 'featurization_0', 'neural_network']
2022-09-24 21:43:55 INFO  Running instrumented original pipeline...
2022-09-24 21:43:55 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-24 21:43:55 INFO  ---RUNTIME: Importing and monkey-patching took 133.69464874267578 ms
2022-09-24 21:43:59.741489: W tensorflow/stream_executor/platform/default/dso_loader.cc:64] Could not load dynamic library 'libcuda.so.1'; dlerror: libcuda.so.1: cannot open shared object file: No such file or directory; LD_LIBRARY_PATH: /home/sgrafbe/mlwhatif/venv/lib/python3.9/site-packages/cv2/../../lib64:
2022-09-24 21:43:59.741528: W tensorflow/stream_executor/cuda/cuda_driver.cc:326] failed call to cuInit: UNKNOWN ERROR (303)
2022-09-24 21:43:59.741549: I tensorflow/stream_executor/cuda/cuda_diagnostics.cc:156] kernel driver does not appear to be running on this host (angus): /proc/driver/nvidia/version does not exist
2022-09-24 21:43:59.742041: I tensorflow/core/platform/cpu_feature_guard.cc:142] This TensorFlow binary is optimized with oneAPI Deep Neural Network Library (oneDNN) to use the following CPU instructions in performance-critical operations:  AVX2 FMA
To enable them in other operations, rebuild TensorFlow with the appropriate compiler flags.
2022-09-24 21:43:59.968766: I tensorflow/compiler/mlir/mlir_graph_optimization_pass.cc:176] None of the MLIR Optimization Passes are enabled (registered 2)
2022-09-24 21:43:59.981182: I tensorflow/core/platform/profile_utils/cpu_utils.cc:114] CPU Frequency: 2595130000 Hz
2022-09-24 21:44:05 INFO  ---RUNTIME: Original pipeline execution took 9455.884456634521 ms (excluding imports and monkey-patching)
2022-09-24 21:44:05 INFO  Starting execution of 0 what-if analyses...
2022-09-24 21:44:05 INFO  Estimated runtime of original DAG is 9128.0517578125ms
2022-09-24 21:44:05 INFO  Performing Multi-Query Optimization
2022-09-24 21:44:05 INFO  Estimated unoptimized what-if runtime is 0ms
2022-09-24 21:44:05 INFO  Estimated optimised what-if runtime is 0ms
2022-09-24 21:44:05 INFO  Estimated optimisation runtime saving is 0ms
2022-09-24 21:44:05 INFO  ---RUNTIME: Multi-Query Optimization took 0.4508495330810547 ms
2022-09-24 21:44:05 INFO  Executing generated plans
2022-09-24 21:44:05 INFO  ---RUNTIME: Execution took 0.0171661376953125 ms
2022-09-24 21:44:05 INFO  Done!
2022-09-24 21:44:05 INFO  # Optimization benchmark for feature_importance with args [['reviews', 'fast_loading', 'featurization_0', 'neural_network']] -- repetition 1 of 7
2022-09-24 21:44:05 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-24 21:44:05 INFO  Running instrumented original pipeline...
2022-09-24 21:44:05 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-24 21:44:05 INFO  ---RUNTIME: Importing and monkey-patching took 5.365610122680664 ms
2022-09-24 21:44:14 INFO  ---RUNTIME: Original pipeline execution took 8905.115604400635 ms (excluding imports and monkey-patching)
2022-09-24 21:44:14 INFO  Starting execution of 1 what-if analyses...
2022-09-24 21:44:14 INFO  Start plan generation for analysis PermutationFeatureImportance...
2022-09-24 21:44:14 INFO  ---RUNTIME: Plan generation took 0.1957416534423828 ms
2022-09-24 21:44:14 INFO  Estimated runtime of original DAG is 8609.070539474487ms
2022-09-24 21:44:14 INFO  Performing Multi-Query Optimization
2022-09-24 21:44:14 INFO  Estimated unoptimized what-if runtime is 43045.35269737244ms
2022-09-24 21:44:14 INFO  Estimated optimised what-if runtime is 11677.649736404419ms
2022-09-24 21:44:14 INFO  Estimated optimisation runtime saving is 31367.702960968018ms
2022-09-24 21:44:14 INFO  ---RUNTIME: Multi-Query Optimization took 11.709928512573242 ms
2022-09-24 21:44:14 INFO  Executing generated plans
2022-09-24 21:44:25 INFO  ---RUNTIME: Execution took 11694.205045700073 ms
2022-09-24 21:44:25 INFO  Done!
2022-09-24 21:44:25 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-24 21:44:25 INFO  Running instrumented original pipeline...
2022-09-24 21:44:25 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-24 21:44:25 INFO  ---RUNTIME: Importing and monkey-patching took 7.245779037475586 ms
2022-09-24 21:44:34 INFO  ---RUNTIME: Original pipeline execution took 9026.29017829895 ms (excluding imports and monkey-patching)
2022-09-24 21:44:34 INFO  Starting execution of 1 what-if analyses...
2022-09-24 21:44:34 INFO  Start plan generation for analysis PermutationFeatureImportance...
2022-09-24 21:44:34 INFO  ---RUNTIME: Plan generation took 0.13494491577148438 ms
2022-09-24 21:44:34 INFO  Estimated runtime of original DAG is 8737.773180007935ms
2022-09-24 21:44:34 WARNING Skipping Multi-Query Optimization (instead, only applying patches)
2022-09-24 21:44:34 INFO  Estimated unoptimised what-if runtime is 43688.86590003967ms
2022-09-24 21:44:34 INFO  ---RUNTIME: Multi-Query Optimization took 3.911256790161133 ms
2022-09-24 21:44:34 INFO  Executing generated plans
2022-09-24 21:45:18 INFO  ---RUNTIME: Execution took 43784.19542312622 ms
2022-09-24 21:45:18 INFO  Done!
2022-09-24 21:45:18 INFO  # Finished -- repetition 1 of 7 
2022-09-24 21:45:18 INFO  # Optimization benchmark for feature_importance with args [['reviews', 'fast_loading', 'featurization_0', 'neural_network']] -- repetition 2 of 7
2022-09-24 21:45:18 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-24 21:45:18 INFO  Running instrumented original pipeline...
2022-09-24 21:45:19 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-24 21:45:19 INFO  ---RUNTIME: Importing and monkey-patching took 6.783246994018555 ms
2022-09-24 21:45:28 INFO  ---RUNTIME: Original pipeline execution took 9294.43907737732 ms (excluding imports and monkey-patching)
2022-09-24 21:45:28 INFO  Starting execution of 1 what-if analyses...
2022-09-24 21:45:28 INFO  Start plan generation for analysis PermutationFeatureImportance...
2022-09-24 21:45:28 INFO  ---RUNTIME: Plan generation took 0.1277923583984375 ms
2022-09-24 21:45:28 INFO  Estimated runtime of original DAG is 8724.653244018555ms
2022-09-24 21:45:28 INFO  Performing Multi-Query Optimization
2022-09-24 21:45:28 INFO  Estimated unoptimized what-if runtime is 43623.26622009277ms
2022-09-24 21:45:28 INFO  Estimated optimised what-if runtime is 11617.533683776855ms
2022-09-24 21:45:28 INFO  Estimated optimisation runtime saving is 32005.732536315918ms
2022-09-24 21:45:28 INFO  ---RUNTIME: Multi-Query Optimization took 11.16323471069336 ms
2022-09-24 21:45:28 INFO  Executing generated plans
2022-09-24 21:45:39 INFO  ---RUNTIME: Execution took 11549.023389816284 ms
2022-09-24 21:45:39 INFO  Done!
2022-09-24 21:45:39 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-24 21:45:39 INFO  Running instrumented original pipeline...
2022-09-24 21:45:39 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-24 21:45:39 INFO  ---RUNTIME: Importing and monkey-patching took 5.950212478637695 ms
2022-09-24 21:45:48 INFO  ---RUNTIME: Original pipeline execution took 9043.432235717773 ms (excluding imports and monkey-patching)
2022-09-24 21:45:48 INFO  Starting execution of 1 what-if analyses...
2022-09-24 21:45:48 INFO  Start plan generation for analysis PermutationFeatureImportance...
2022-09-24 21:45:48 INFO  ---RUNTIME: Plan generation took 0.13756752014160156 ms
2022-09-24 21:45:48 INFO  Estimated runtime of original DAG is 8755.438804626465ms
2022-09-24 21:45:48 WARNING Skipping Multi-Query Optimization (instead, only applying patches)
2022-09-24 21:45:48 INFO  Estimated unoptimised what-if runtime is 43777.194023132324ms
2022-09-24 21:45:48 INFO  ---RUNTIME: Multi-Query Optimization took 3.8216114044189453 ms
2022-09-24 21:45:48 INFO  Executing generated plans
2022-09-24 21:46:32 INFO  ---RUNTIME: Execution took 43364.920139312744 ms
2022-09-24 21:46:32 INFO  Done!
2022-09-24 21:46:32 INFO  # Finished -- repetition 2 of 7 
2022-09-24 21:46:32 INFO  # Optimization benchmark for feature_importance with args [['reviews', 'fast_loading', 'featurization_0', 'neural_network']] -- repetition 3 of 7
2022-09-24 21:46:32 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-24 21:46:32 INFO  Running instrumented original pipeline...
2022-09-24 21:46:32 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-24 21:46:32 INFO  ---RUNTIME: Importing and monkey-patching took 6.212949752807617 ms
2022-09-24 21:46:40 INFO  ---RUNTIME: Original pipeline execution took 8794.720888137817 ms (excluding imports and monkey-patching)
2022-09-24 21:46:40 INFO  Starting execution of 1 what-if analyses...
2022-09-24 21:46:40 INFO  Start plan generation for analysis PermutationFeatureImportance...
2022-09-24 21:46:40 INFO  ---RUNTIME: Plan generation took 0.1266002655029297 ms
2022-09-24 21:46:40 INFO  Estimated runtime of original DAG is 8501.601696014404ms
2022-09-24 21:46:40 INFO  Performing Multi-Query Optimization
2022-09-24 21:46:40 INFO  Estimated unoptimized what-if runtime is 42508.00848007202ms
2022-09-24 21:46:40 INFO  Estimated optimised what-if runtime is 11385.573387145996ms
2022-09-24 21:46:40 INFO  Estimated optimisation runtime saving is 31122.435092926025ms
2022-09-24 21:46:40 INFO  ---RUNTIME: Multi-Query Optimization took 9.29880142211914 ms
2022-09-24 21:46:40 INFO  Executing generated plans
2022-09-24 21:46:52 INFO  ---RUNTIME: Execution took 11419.976949691772 ms
2022-09-24 21:46:52 INFO  Done!
2022-09-24 21:46:52 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-24 21:46:52 INFO  Running instrumented original pipeline...
2022-09-24 21:46:52 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-24 21:46:52 INFO  ---RUNTIME: Importing and monkey-patching took 6.645441055297852 ms
2022-09-24 21:47:01 INFO  ---RUNTIME: Original pipeline execution took 8868.4823513031 ms (excluding imports and monkey-patching)
2022-09-24 21:47:01 INFO  Starting execution of 1 what-if analyses...
2022-09-24 21:47:01 INFO  Start plan generation for analysis PermutationFeatureImportance...
2022-09-24 21:47:01 INFO  ---RUNTIME: Plan generation took 0.10180473327636719 ms
2022-09-24 21:47:01 INFO  Estimated runtime of original DAG is 8569.589614868164ms
2022-09-24 21:47:01 WARNING Skipping Multi-Query Optimization (instead, only applying patches)
2022-09-24 21:47:01 INFO  Estimated unoptimised what-if runtime is 42847.94807434082ms
2022-09-24 21:47:01 INFO  ---RUNTIME: Multi-Query Optimization took 5.009174346923828 ms
2022-09-24 21:47:01 INFO  Executing generated plans
2022-09-24 21:47:45 INFO  ---RUNTIME: Execution took 44316.96271896362 ms
2022-09-24 21:47:45 INFO  Done!
2022-09-24 21:47:45 INFO  # Finished -- repetition 3 of 7 
2022-09-24 21:47:45 INFO  # Optimization benchmark for feature_importance with args [['reviews', 'fast_loading', 'featurization_0', 'neural_network']] -- repetition 4 of 7
2022-09-24 21:47:45 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-24 21:47:45 INFO  Running instrumented original pipeline...
2022-09-24 21:47:45 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-24 21:47:45 INFO  ---RUNTIME: Importing and monkey-patching took 6.038427352905273 ms
2022-09-24 21:47:54 INFO  ---RUNTIME: Original pipeline execution took 8693.037271499634 ms (excluding imports and monkey-patching)
2022-09-24 21:47:54 INFO  Starting execution of 1 what-if analyses...
2022-09-24 21:47:54 INFO  Start plan generation for analysis PermutationFeatureImportance...
2022-09-24 21:47:54 INFO  ---RUNTIME: Plan generation took 0.10251998901367188 ms
2022-09-24 21:47:54 INFO  Estimated runtime of original DAG is 8409.632444381714ms
2022-09-24 21:47:54 INFO  Performing Multi-Query Optimization
2022-09-24 21:47:54 INFO  Estimated unoptimized what-if runtime is 42048.16222190857ms
2022-09-24 21:47:54 INFO  Estimated optimised what-if runtime is 11546.760559082031ms
2022-09-24 21:47:54 INFO  Estimated optimisation runtime saving is 30501.401662826538ms
2022-09-24 21:47:54 INFO  ---RUNTIME: Multi-Query Optimization took 9.600639343261719 ms
2022-09-24 21:47:54 INFO  Executing generated plans
2022-09-24 21:48:06 INFO  ---RUNTIME: Execution took 12175.914287567139 ms
2022-09-24 21:48:06 INFO  Done!
2022-09-24 21:48:06 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-24 21:48:06 INFO  Running instrumented original pipeline...
2022-09-24 21:48:06 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-24 21:48:06 INFO  ---RUNTIME: Importing and monkey-patching took 6.722927093505859 ms
2022-09-24 21:48:15 INFO  ---RUNTIME: Original pipeline execution took 9013.502359390259 ms (excluding imports and monkey-patching)
2022-09-24 21:48:15 INFO  Starting execution of 1 what-if analyses...
2022-09-24 21:48:15 INFO  Start plan generation for analysis PermutationFeatureImportance...
2022-09-24 21:48:15 INFO  ---RUNTIME: Plan generation took 0.11086463928222656 ms
2022-09-24 21:48:15 INFO  Estimated runtime of original DAG is 8722.554683685303ms
2022-09-24 21:48:15 WARNING Skipping Multi-Query Optimization (instead, only applying patches)
2022-09-24 21:48:15 INFO  Estimated unoptimised what-if runtime is 43612.773418426514ms
2022-09-24 21:48:15 INFO  ---RUNTIME: Multi-Query Optimization took 3.6585330963134766 ms
2022-09-24 21:48:15 INFO  Executing generated plans
2022-09-24 21:48:58 INFO  ---RUNTIME: Execution took 43289.955377578735 ms
2022-09-24 21:48:58 INFO  Done!
2022-09-24 21:48:58 INFO  # Finished -- repetition 4 of 7 
2022-09-24 21:48:58 INFO  # Optimization benchmark for feature_importance with args [['reviews', 'fast_loading', 'featurization_0', 'neural_network']] -- repetition 5 of 7
2022-09-24 21:48:58 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-24 21:48:58 INFO  Running instrumented original pipeline...
2022-09-24 21:48:58 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-24 21:48:58 INFO  ---RUNTIME: Importing and monkey-patching took 7.3337554931640625 ms
2022-09-24 21:49:08 INFO  ---RUNTIME: Original pipeline execution took 9461.983442306519 ms (excluding imports and monkey-patching)
2022-09-24 21:49:08 INFO  Starting execution of 1 what-if analyses...
2022-09-24 21:49:08 INFO  Start plan generation for analysis PermutationFeatureImportance...
2022-09-24 21:49:08 INFO  ---RUNTIME: Plan generation took 0.12755393981933594 ms
2022-09-24 21:49:08 INFO  Estimated runtime of original DAG is 9169.845342636108ms
2022-09-24 21:49:08 INFO  Performing Multi-Query Optimization
2022-09-24 21:49:08 INFO  Estimated unoptimized what-if runtime is 45849.22671318054ms
2022-09-24 21:49:08 INFO  Estimated optimised what-if runtime is 12136.034727096558ms
2022-09-24 21:49:08 INFO  Estimated optimisation runtime saving is 33713.191986083984ms
2022-09-24 21:49:08 INFO  ---RUNTIME: Multi-Query Optimization took 11.176586151123047 ms
2022-09-24 21:49:08 INFO  Executing generated plans
2022-09-24 21:49:19 INFO  ---RUNTIME: Execution took 11584.486961364746 ms
2022-09-24 21:49:19 INFO  Done!
2022-09-24 21:49:19 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-24 21:49:19 INFO  Running instrumented original pipeline...
2022-09-24 21:49:19 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-24 21:49:19 INFO  ---RUNTIME: Importing and monkey-patching took 5.897283554077148 ms
2022-09-24 21:49:28 INFO  ---RUNTIME: Original pipeline execution took 8839.37954902649 ms (excluding imports and monkey-patching)
2022-09-24 21:49:28 INFO  Starting execution of 1 what-if analyses...
2022-09-24 21:49:28 INFO  Start plan generation for analysis PermutationFeatureImportance...
2022-09-24 21:49:28 INFO  ---RUNTIME: Plan generation took 0.10609626770019531 ms
2022-09-24 21:49:28 INFO  Estimated runtime of original DAG is 8545.6383228302ms
2022-09-24 21:49:28 WARNING Skipping Multi-Query Optimization (instead, only applying patches)
2022-09-24 21:49:28 INFO  Estimated unoptimised what-if runtime is 42728.191614151ms
2022-09-24 21:49:28 INFO  ---RUNTIME: Multi-Query Optimization took 3.6287307739257812 ms
2022-09-24 21:49:28 INFO  Executing generated plans
2022-09-24 21:50:12 INFO  ---RUNTIME: Execution took 43753.05938720703 ms
2022-09-24 21:50:12 INFO  Done!
2022-09-24 21:50:12 INFO  # Finished -- repetition 5 of 7 
2022-09-24 21:50:12 INFO  # Optimization benchmark for feature_importance with args [['reviews', 'fast_loading', 'featurization_0', 'neural_network']] -- repetition 6 of 7
2022-09-24 21:50:12 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-24 21:50:12 INFO  Running instrumented original pipeline...
2022-09-24 21:50:12 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-24 21:50:12 INFO  ---RUNTIME: Importing and monkey-patching took 6.943941116333008 ms
2022-09-24 21:50:21 INFO  ---RUNTIME: Original pipeline execution took 8705.338954925537 ms (excluding imports and monkey-patching)
2022-09-24 21:50:21 INFO  Starting execution of 1 what-if analyses...
2022-09-24 21:50:21 INFO  Start plan generation for analysis PermutationFeatureImportance...
2022-09-24 21:50:21 INFO  ---RUNTIME: Plan generation took 0.1583099365234375 ms
2022-09-24 21:50:21 INFO  Estimated runtime of original DAG is 8401.885986328125ms
2022-09-24 21:50:21 INFO  Performing Multi-Query Optimization
2022-09-24 21:50:21 INFO  Estimated unoptimized what-if runtime is 42009.429931640625ms
2022-09-24 21:50:21 INFO  Estimated optimised what-if runtime is 11359.325885772705ms
2022-09-24 21:50:21 INFO  Estimated optimisation runtime saving is 30650.10404586792ms
2022-09-24 21:50:21 INFO  ---RUNTIME: Multi-Query Optimization took 9.693622589111328 ms
2022-09-24 21:50:21 INFO  Executing generated plans
2022-09-24 21:50:32 INFO  ---RUNTIME: Execution took 11650.779724121094 ms
2022-09-24 21:50:32 INFO  Done!
2022-09-24 21:50:32 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-24 21:50:32 INFO  Running instrumented original pipeline...
2022-09-24 21:50:32 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-24 21:50:32 INFO  ---RUNTIME: Importing and monkey-patching took 6.701231002807617 ms
2022-09-24 21:50:41 INFO  ---RUNTIME: Original pipeline execution took 9043.128728866577 ms (excluding imports and monkey-patching)
2022-09-24 21:50:41 INFO  Starting execution of 1 what-if analyses...
2022-09-24 21:50:41 INFO  Start plan generation for analysis PermutationFeatureImportance...
2022-09-24 21:50:41 INFO  ---RUNTIME: Plan generation took 0.10228157043457031 ms
2022-09-24 21:50:41 INFO  Estimated runtime of original DAG is 8748.9013671875ms
2022-09-24 21:50:41 WARNING Skipping Multi-Query Optimization (instead, only applying patches)
2022-09-24 21:50:41 INFO  Estimated unoptimised what-if runtime is 43744.5068359375ms
2022-09-24 21:50:41 INFO  ---RUNTIME: Multi-Query Optimization took 5.170106887817383 ms
2022-09-24 21:50:41 INFO  Executing generated plans
2022-09-24 21:51:25 INFO  ---RUNTIME: Execution took 43891.534090042114 ms
2022-09-24 21:51:25 INFO  Done!
2022-09-24 21:51:25 INFO  # Finished -- repetition 6 of 7 
2022-09-24 21:51:25 INFO  # Optimization benchmark for feature_importance with args [['reviews', 'fast_loading', 'featurization_0', 'neural_network']] -- repetition 7 of 7
2022-09-24 21:51:25 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-24 21:51:25 INFO  Running instrumented original pipeline...
2022-09-24 21:51:25 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-24 21:51:25 INFO  ---RUNTIME: Importing and monkey-patching took 6.385326385498047 ms
2022-09-24 21:51:34 INFO  ---RUNTIME: Original pipeline execution took 9014.330625534058 ms (excluding imports and monkey-patching)
2022-09-24 21:51:34 INFO  Starting execution of 1 what-if analyses...
2022-09-24 21:51:34 INFO  Start plan generation for analysis PermutationFeatureImportance...
2022-09-24 21:51:34 INFO  ---RUNTIME: Plan generation took 0.17189979553222656 ms
2022-09-24 21:51:34 INFO  Estimated runtime of original DAG is 8716.81547164917ms
2022-09-24 21:51:34 INFO  Performing Multi-Query Optimization
2022-09-24 21:51:34 INFO  Estimated unoptimized what-if runtime is 43584.07735824585ms
2022-09-24 21:51:34 INFO  Estimated optimised what-if runtime is 12051.473379135132ms
2022-09-24 21:51:34 INFO  Estimated optimisation runtime saving is 31532.603979110718ms
2022-09-24 21:51:34 INFO  ---RUNTIME: Multi-Query Optimization took 10.65826416015625 ms
2022-09-24 21:51:34 INFO  Executing generated plans
2022-09-24 21:51:46 INFO  ---RUNTIME: Execution took 11738.46960067749 ms
2022-09-24 21:51:46 INFO  Done!
2022-09-24 21:51:46 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-24 21:51:46 INFO  Running instrumented original pipeline...
2022-09-24 21:51:46 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-24 21:51:46 INFO  ---RUNTIME: Importing and monkey-patching took 5.9947967529296875 ms
2022-09-24 21:51:55 INFO  ---RUNTIME: Original pipeline execution took 8534.536123275757 ms (excluding imports and monkey-patching)
2022-09-24 21:51:55 INFO  Starting execution of 1 what-if analyses...
2022-09-24 21:51:55 INFO  Start plan generation for analysis PermutationFeatureImportance...
2022-09-24 21:51:55 INFO  ---RUNTIME: Plan generation took 0.09679794311523438 ms
2022-09-24 21:51:55 INFO  Estimated runtime of original DAG is 8246.20771408081ms
2022-09-24 21:51:55 WARNING Skipping Multi-Query Optimization (instead, only applying patches)
2022-09-24 21:51:55 INFO  Estimated unoptimised what-if runtime is 41231.03857040405ms
2022-09-24 21:51:55 INFO  ---RUNTIME: Multi-Query Optimization took 3.5991668701171875 ms
2022-09-24 21:51:55 INFO  Executing generated plans
2022-09-24 21:52:37 INFO  ---RUNTIME: Execution took 42370.29218673706 ms
2022-09-24 21:52:37 INFO  Done!
2022-09-24 21:52:37 INFO  # Finished -- repetition 7 of 7 
2022-09-24 21:52:37 INFO  # Final results after all repetitions
2022-09-24 21:52:37 INFO     repetition  ... no_opt_what_if_execution_combined_model_training
0           0  ...                                     17398.448706
1           1  ...                                     17200.345993
2           2  ...                                     17652.304888
3           3  ...                                     16959.136009
4           4  ...                                     17002.104521
5           5  ...                                     17770.339727
6           6  ...                                     16451.284170

[7 rows x 26 columns]
PROTOCOL_BUFFERS_PYTHON_IMPLEMENTATION=python taskset -c 32-39 python3.9 benchmarks_end_to_end.py feature_importance reviews fast_loading featurization_1 logistic_regression
2022-09-24 21:52:39.933619: W tensorflow/stream_executor/platform/default/dso_loader.cc:64] Could not load dynamic library 'libcudart.so.11.0'; dlerror: libcudart.so.11.0: cannot open shared object file: No such file or directory; LD_LIBRARY_PATH: /home/sgrafbe/mlwhatif/venv/lib/python3.9/site-packages/cv2/../../lib64:
2022-09-24 21:52:39.933666: I tensorflow/stream_executor/cuda/cudart_stub.cc:29] Ignore above cudart dlerror if you do not have a GPU set up on your machine.
2022-09-24 21:52:41 INFO  Patching sys.argv with ['mlwhatif', 'reviews', 'fast_loading', 'featurization_1', 'logistic_regression']
2022-09-24 21:52:41 INFO  Running instrumented original pipeline...
2022-09-24 21:52:41 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-24 21:52:41 INFO  ---RUNTIME: Importing and monkey-patching took 121.10733985900879 ms
2022-09-24 21:52:46 INFO  ---RUNTIME: Original pipeline execution took 5232.426643371582 ms (excluding imports and monkey-patching)
2022-09-24 21:52:46 INFO  Starting execution of 0 what-if analyses...
2022-09-24 21:52:46 INFO  Estimated runtime of original DAG is 4900.256872177124ms
2022-09-24 21:52:46 INFO  Performing Multi-Query Optimization
2022-09-24 21:52:46 INFO  Estimated unoptimized what-if runtime is 0ms
2022-09-24 21:52:46 INFO  Estimated optimised what-if runtime is 0ms
2022-09-24 21:52:46 INFO  Estimated optimisation runtime saving is 0ms
2022-09-24 21:52:46 INFO  ---RUNTIME: Multi-Query Optimization took 0.5171298980712891 ms
2022-09-24 21:52:46 INFO  Executing generated plans
2022-09-24 21:52:46 INFO  ---RUNTIME: Execution took 0.027418136596679688 ms
2022-09-24 21:52:46 INFO  Done!
2022-09-24 21:52:46 INFO  # Optimization benchmark for feature_importance with args [['reviews', 'fast_loading', 'featurization_1', 'logistic_regression']] -- repetition 1 of 7
2022-09-24 21:52:46 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-24 21:52:46 INFO  Running instrumented original pipeline...
2022-09-24 21:52:46 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-24 21:52:46 INFO  ---RUNTIME: Importing and monkey-patching took 5.807638168334961 ms
2022-09-24 21:52:51 INFO  ---RUNTIME: Original pipeline execution took 5368.747234344482 ms (excluding imports and monkey-patching)
2022-09-24 21:52:51 INFO  Starting execution of 1 what-if analyses...
2022-09-24 21:52:51 INFO  Start plan generation for analysis PermutationFeatureImportance...
2022-09-24 21:52:51 INFO  ---RUNTIME: Plan generation took 0.19812583923339844 ms
2022-09-24 21:52:51 INFO  Estimated runtime of original DAG is 4869.852304458618ms
2022-09-24 21:52:51 INFO  Performing Multi-Query Optimization
2022-09-24 21:52:51 INFO  Estimated unoptimized what-if runtime is 24349.26152229309ms
2022-09-24 21:52:51 INFO  Estimated optimised what-if runtime is 6199.900388717651ms
2022-09-24 21:52:51 INFO  Estimated optimisation runtime saving is 18149.36113357544ms
2022-09-24 21:52:51 INFO  ---RUNTIME: Multi-Query Optimization took 20.875930786132812 ms
2022-09-24 21:52:51 INFO  Executing generated plans
2022-09-24 21:52:58 INFO  ---RUNTIME: Execution took 6279.949426651001 ms
2022-09-24 21:52:58 INFO  Done!
2022-09-24 21:52:58 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-24 21:52:58 INFO  Running instrumented original pipeline...
2022-09-24 21:52:58 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-24 21:52:58 INFO  ---RUNTIME: Importing and monkey-patching took 6.017923355102539 ms
2022-09-24 21:53:03 INFO  ---RUNTIME: Original pipeline execution took 5238.462209701538 ms (excluding imports and monkey-patching)
2022-09-24 21:53:03 INFO  Starting execution of 1 what-if analyses...
2022-09-24 21:53:03 INFO  Start plan generation for analysis PermutationFeatureImportance...
2022-09-24 21:53:03 INFO  ---RUNTIME: Plan generation took 0.12373924255371094 ms
2022-09-24 21:53:03 INFO  Estimated runtime of original DAG is 4902.355670928955ms
2022-09-24 21:53:03 WARNING Skipping Multi-Query Optimization (instead, only applying patches)
2022-09-24 21:53:03 INFO  Estimated unoptimised what-if runtime is 24511.778354644775ms
2022-09-24 21:53:03 INFO  ---RUNTIME: Multi-Query Optimization took 4.940032958984375 ms
2022-09-24 21:53:03 INFO  Executing generated plans
2022-09-24 21:53:28 INFO  ---RUNTIME: Execution took 24773.823499679565 ms
2022-09-24 21:53:28 INFO  Done!
2022-09-24 21:53:28 INFO  # Finished -- repetition 1 of 7 
2022-09-24 21:53:28 INFO  # Optimization benchmark for feature_importance with args [['reviews', 'fast_loading', 'featurization_1', 'logistic_regression']] -- repetition 2 of 7
2022-09-24 21:53:28 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-24 21:53:28 INFO  Running instrumented original pipeline...
2022-09-24 21:53:28 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-24 21:53:28 INFO  ---RUNTIME: Importing and monkey-patching took 6.325006484985352 ms
2022-09-24 21:53:33 INFO  ---RUNTIME: Original pipeline execution took 5166.987180709839 ms (excluding imports and monkey-patching)
2022-09-24 21:53:33 INFO  Starting execution of 1 what-if analyses...
2022-09-24 21:53:33 INFO  Start plan generation for analysis PermutationFeatureImportance...
2022-09-24 21:53:33 INFO  ---RUNTIME: Plan generation took 0.1251697540283203 ms
2022-09-24 21:53:33 INFO  Estimated runtime of original DAG is 4879.0740966796875ms
2022-09-24 21:53:33 INFO  Performing Multi-Query Optimization
2022-09-24 21:53:33 INFO  Estimated unoptimized what-if runtime is 24395.370483398438ms
2022-09-24 21:53:33 INFO  Estimated optimised what-if runtime is 6209.653377532959ms
2022-09-24 21:53:33 INFO  Estimated optimisation runtime saving is 18185.71710586548ms
2022-09-24 21:53:33 INFO  ---RUNTIME: Multi-Query Optimization took 10.091781616210938 ms
2022-09-24 21:53:33 INFO  Executing generated plans
2022-09-24 21:53:39 INFO  ---RUNTIME: Execution took 6269.432067871094 ms
2022-09-24 21:53:39 INFO  Done!
2022-09-24 21:53:39 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-24 21:53:39 INFO  Running instrumented original pipeline...
2022-09-24 21:53:39 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-24 21:53:39 INFO  ---RUNTIME: Importing and monkey-patching took 6.985187530517578 ms
2022-09-24 21:53:44 INFO  ---RUNTIME: Original pipeline execution took 5169.782876968384 ms (excluding imports and monkey-patching)
2022-09-24 21:53:44 INFO  Starting execution of 1 what-if analyses...
2022-09-24 21:53:44 INFO  Start plan generation for analysis PermutationFeatureImportance...
2022-09-24 21:53:44 INFO  ---RUNTIME: Plan generation took 0.12540817260742188 ms
2022-09-24 21:53:44 INFO  Estimated runtime of original DAG is 4875.643253326416ms
2022-09-24 21:53:44 WARNING Skipping Multi-Query Optimization (instead, only applying patches)
2022-09-24 21:53:44 INFO  Estimated unoptimised what-if runtime is 24378.21626663208ms
2022-09-24 21:53:44 INFO  ---RUNTIME: Multi-Query Optimization took 3.9751529693603516 ms
2022-09-24 21:53:44 INFO  Executing generated plans
2022-09-24 21:54:09 INFO  ---RUNTIME: Execution took 24641.36242866516 ms
2022-09-24 21:54:09 INFO  Done!
2022-09-24 21:54:09 INFO  # Finished -- repetition 2 of 7 
2022-09-24 21:54:09 INFO  # Optimization benchmark for feature_importance with args [['reviews', 'fast_loading', 'featurization_1', 'logistic_regression']] -- repetition 3 of 7
2022-09-24 21:54:09 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-24 21:54:09 INFO  Running instrumented original pipeline...
2022-09-24 21:54:09 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-24 21:54:09 INFO  ---RUNTIME: Importing and monkey-patching took 6.372928619384766 ms
2022-09-24 21:54:14 INFO  ---RUNTIME: Original pipeline execution took 5191.486835479736 ms (excluding imports and monkey-patching)
2022-09-24 21:54:14 INFO  Starting execution of 1 what-if analyses...
2022-09-24 21:54:14 INFO  Start plan generation for analysis PermutationFeatureImportance...
2022-09-24 21:54:14 INFO  ---RUNTIME: Plan generation took 0.1125335693359375 ms
2022-09-24 21:54:14 INFO  Estimated runtime of original DAG is 4873.298406600952ms
2022-09-24 21:54:14 INFO  Performing Multi-Query Optimization
2022-09-24 21:54:14 INFO  Estimated unoptimized what-if runtime is 24366.49203300476ms
2022-09-24 21:54:14 INFO  Estimated optimised what-if runtime is 6213.186264038086ms
2022-09-24 21:54:14 INFO  Estimated optimisation runtime saving is 18153.305768966675ms
2022-09-24 21:54:14 INFO  ---RUNTIME: Multi-Query Optimization took 10.698318481445312 ms
2022-09-24 21:54:14 INFO  Executing generated plans
2022-09-24 21:54:21 INFO  ---RUNTIME: Execution took 6286.621570587158 ms
2022-09-24 21:54:21 INFO  Done!
2022-09-24 21:54:21 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-24 21:54:21 INFO  Running instrumented original pipeline...
2022-09-24 21:54:21 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-24 21:54:21 INFO  ---RUNTIME: Importing and monkey-patching took 5.910396575927734 ms
2022-09-24 21:54:26 INFO  ---RUNTIME: Original pipeline execution took 5209.10120010376 ms (excluding imports and monkey-patching)
2022-09-24 21:54:26 INFO  Starting execution of 1 what-if analyses...
2022-09-24 21:54:26 INFO  Start plan generation for analysis PermutationFeatureImportance...
2022-09-24 21:54:26 INFO  ---RUNTIME: Plan generation took 0.14066696166992188 ms
2022-09-24 21:54:26 INFO  Estimated runtime of original DAG is 4916.337251663208ms
2022-09-24 21:54:26 WARNING Skipping Multi-Query Optimization (instead, only applying patches)
2022-09-24 21:54:26 INFO  Estimated unoptimised what-if runtime is 24581.68625831604ms
2022-09-24 21:54:26 INFO  ---RUNTIME: Multi-Query Optimization took 3.9587020874023438 ms
2022-09-24 21:54:26 INFO  Executing generated plans
2022-09-24 21:54:50 INFO  ---RUNTIME: Execution took 24683.079481124878 ms
2022-09-24 21:54:50 INFO  Done!
2022-09-24 21:54:51 INFO  # Finished -- repetition 3 of 7 
2022-09-24 21:54:51 INFO  # Optimization benchmark for feature_importance with args [['reviews', 'fast_loading', 'featurization_1', 'logistic_regression']] -- repetition 4 of 7
2022-09-24 21:54:51 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-24 21:54:51 INFO  Running instrumented original pipeline...
2022-09-24 21:54:51 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-24 21:54:51 INFO  ---RUNTIME: Importing and monkey-patching took 6.150007247924805 ms
2022-09-24 21:54:56 INFO  ---RUNTIME: Original pipeline execution took 5213.265657424927 ms (excluding imports and monkey-patching)
2022-09-24 21:54:56 INFO  Starting execution of 1 what-if analyses...
2022-09-24 21:54:56 INFO  Start plan generation for analysis PermutationFeatureImportance...
2022-09-24 21:54:56 INFO  ---RUNTIME: Plan generation took 0.10776519775390625 ms
2022-09-24 21:54:56 INFO  Estimated runtime of original DAG is 4909.408807754517ms
2022-09-24 21:54:56 INFO  Performing Multi-Query Optimization
2022-09-24 21:54:56 INFO  Estimated unoptimized what-if runtime is 24547.044038772583ms
2022-09-24 21:54:56 INFO  Estimated optimised what-if runtime is 6252.317190170288ms
2022-09-24 21:54:56 INFO  Estimated optimisation runtime saving is 18294.726848602295ms
2022-09-24 21:54:56 INFO  ---RUNTIME: Multi-Query Optimization took 11.125802993774414 ms
2022-09-24 21:54:56 INFO  Executing generated plans
2022-09-24 21:55:02 INFO  ---RUNTIME: Execution took 6277.965784072876 ms
2022-09-24 21:55:02 INFO  Done!
2022-09-24 21:55:02 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-24 21:55:02 INFO  Running instrumented original pipeline...
2022-09-24 21:55:02 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-24 21:55:02 INFO  ---RUNTIME: Importing and monkey-patching took 5.919694900512695 ms
2022-09-24 21:55:07 INFO  ---RUNTIME: Original pipeline execution took 5391.501903533936 ms (excluding imports and monkey-patching)
2022-09-24 21:55:07 INFO  Starting execution of 1 what-if analyses...
2022-09-24 21:55:07 INFO  Start plan generation for analysis PermutationFeatureImportance...
2022-09-24 21:55:07 INFO  ---RUNTIME: Plan generation took 0.1239776611328125 ms
2022-09-24 21:55:07 INFO  Estimated runtime of original DAG is 4896.938323974609ms
2022-09-24 21:55:07 WARNING Skipping Multi-Query Optimization (instead, only applying patches)
2022-09-24 21:55:07 INFO  Estimated unoptimised what-if runtime is 24484.691619873047ms
2022-09-24 21:55:07 INFO  ---RUNTIME: Multi-Query Optimization took 3.941774368286133 ms
2022-09-24 21:55:07 INFO  Executing generated plans
2022-09-24 21:55:32 INFO  ---RUNTIME: Execution took 24691.020965576172 ms
2022-09-24 21:55:32 INFO  Done!
2022-09-24 21:55:32 INFO  # Finished -- repetition 4 of 7 
2022-09-24 21:55:32 INFO  # Optimization benchmark for feature_importance with args [['reviews', 'fast_loading', 'featurization_1', 'logistic_regression']] -- repetition 5 of 7
2022-09-24 21:55:32 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-24 21:55:32 INFO  Running instrumented original pipeline...
2022-09-24 21:55:32 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-24 21:55:32 INFO  ---RUNTIME: Importing and monkey-patching took 6.467580795288086 ms
2022-09-24 21:55:37 INFO  ---RUNTIME: Original pipeline execution took 5207.437515258789 ms (excluding imports and monkey-patching)
2022-09-24 21:55:37 INFO  Starting execution of 1 what-if analyses...
2022-09-24 21:55:37 INFO  Start plan generation for analysis PermutationFeatureImportance...
2022-09-24 21:55:37 INFO  ---RUNTIME: Plan generation took 0.10752677917480469 ms
2022-09-24 21:55:37 INFO  Estimated runtime of original DAG is 4916.693449020386ms
2022-09-24 21:55:37 INFO  Performing Multi-Query Optimization
2022-09-24 21:55:37 INFO  Estimated unoptimized what-if runtime is 24583.46724510193ms
2022-09-24 21:55:37 INFO  Estimated optimised what-if runtime is 6260.989427566528ms
2022-09-24 21:55:37 INFO  Estimated optimisation runtime saving is 18322.4778175354ms
2022-09-24 21:55:37 INFO  ---RUNTIME: Multi-Query Optimization took 10.031700134277344 ms
2022-09-24 21:55:37 INFO  Executing generated plans
2022-09-24 21:55:44 INFO  ---RUNTIME: Execution took 6285.080909729004 ms
2022-09-24 21:55:44 INFO  Done!
2022-09-24 21:55:44 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-24 21:55:44 INFO  Running instrumented original pipeline...
2022-09-24 21:55:44 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-24 21:55:44 INFO  ---RUNTIME: Importing and monkey-patching took 5.918264389038086 ms
2022-09-24 21:55:49 INFO  ---RUNTIME: Original pipeline execution took 5196.2175369262695 ms (excluding imports and monkey-patching)
2022-09-24 21:55:49 INFO  Starting execution of 1 what-if analyses...
2022-09-24 21:55:49 INFO  Start plan generation for analysis PermutationFeatureImportance...
2022-09-24 21:55:49 INFO  ---RUNTIME: Plan generation took 0.09751319885253906 ms
2022-09-24 21:55:49 INFO  Estimated runtime of original DAG is 4904.04486656189ms
2022-09-24 21:55:49 WARNING Skipping Multi-Query Optimization (instead, only applying patches)
2022-09-24 21:55:49 INFO  Estimated unoptimised what-if runtime is 24520.22433280945ms
2022-09-24 21:55:49 INFO  ---RUNTIME: Multi-Query Optimization took 4.718542098999023 ms
2022-09-24 21:55:49 INFO  Executing generated plans
2022-09-24 21:56:14 INFO  ---RUNTIME: Execution took 24736.937522888184 ms
2022-09-24 21:56:14 INFO  Done!
2022-09-24 21:56:14 INFO  # Finished -- repetition 5 of 7 
2022-09-24 21:56:14 INFO  # Optimization benchmark for feature_importance with args [['reviews', 'fast_loading', 'featurization_1', 'logistic_regression']] -- repetition 6 of 7
2022-09-24 21:56:14 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-24 21:56:14 INFO  Running instrumented original pipeline...
2022-09-24 21:56:14 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-24 21:56:14 INFO  ---RUNTIME: Importing and monkey-patching took 6.325006484985352 ms
2022-09-24 21:56:19 INFO  ---RUNTIME: Original pipeline execution took 5219.204902648926 ms (excluding imports and monkey-patching)
2022-09-24 21:56:19 INFO  Starting execution of 1 what-if analyses...
2022-09-24 21:56:19 INFO  Start plan generation for analysis PermutationFeatureImportance...
2022-09-24 21:56:19 INFO  ---RUNTIME: Plan generation took 0.12111663818359375 ms
2022-09-24 21:56:19 INFO  Estimated runtime of original DAG is 4922.373294830322ms
2022-09-24 21:56:19 INFO  Performing Multi-Query Optimization
2022-09-24 21:56:19 INFO  Estimated unoptimized what-if runtime is 24611.86647415161ms
2022-09-24 21:56:19 INFO  Estimated optimised what-if runtime is 6297.045469284058ms
2022-09-24 21:56:19 INFO  Estimated optimisation runtime saving is 18314.821004867554ms
2022-09-24 21:56:19 INFO  ---RUNTIME: Multi-Query Optimization took 10.094881057739258 ms
2022-09-24 21:56:19 INFO  Executing generated plans
2022-09-24 21:56:25 INFO  ---RUNTIME: Execution took 6270.166397094727 ms
2022-09-24 21:56:25 INFO  Done!
2022-09-24 21:56:25 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-24 21:56:25 INFO  Running instrumented original pipeline...
2022-09-24 21:56:25 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-24 21:56:25 INFO  ---RUNTIME: Importing and monkey-patching took 5.9070587158203125 ms
2022-09-24 21:56:30 INFO  ---RUNTIME: Original pipeline execution took 5221.282958984375 ms (excluding imports and monkey-patching)
2022-09-24 21:56:30 INFO  Starting execution of 1 what-if analyses...
2022-09-24 21:56:30 INFO  Start plan generation for analysis PermutationFeatureImportance...
2022-09-24 21:56:30 INFO  ---RUNTIME: Plan generation took 0.10395050048828125 ms
2022-09-24 21:56:30 INFO  Estimated runtime of original DAG is 4931.737422943115ms
2022-09-24 21:56:30 WARNING Skipping Multi-Query Optimization (instead, only applying patches)
2022-09-24 21:56:30 INFO  Estimated unoptimised what-if runtime is 24658.687114715576ms
2022-09-24 21:56:30 INFO  ---RUNTIME: Multi-Query Optimization took 3.9215087890625 ms
2022-09-24 21:56:30 INFO  Executing generated plans
2022-09-24 21:56:55 INFO  ---RUNTIME: Execution took 24653.839826583862 ms
2022-09-24 21:56:55 INFO  Done!
2022-09-24 21:56:55 INFO  # Finished -- repetition 6 of 7 
2022-09-24 21:56:55 INFO  # Optimization benchmark for feature_importance with args [['reviews', 'fast_loading', 'featurization_1', 'logistic_regression']] -- repetition 7 of 7
2022-09-24 21:56:55 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-24 21:56:55 INFO  Running instrumented original pipeline...
2022-09-24 21:56:55 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-24 21:56:55 INFO  ---RUNTIME: Importing and monkey-patching took 6.292104721069336 ms
2022-09-24 21:57:00 INFO  ---RUNTIME: Original pipeline execution took 5195.914030075073 ms (excluding imports and monkey-patching)
2022-09-24 21:57:00 INFO  Starting execution of 1 what-if analyses...
2022-09-24 21:57:00 INFO  Start plan generation for analysis PermutationFeatureImportance...
2022-09-24 21:57:00 INFO  ---RUNTIME: Plan generation took 0.11301040649414062 ms
2022-09-24 21:57:00 INFO  Estimated runtime of original DAG is 4902.327060699463ms
2022-09-24 21:57:00 INFO  Performing Multi-Query Optimization
2022-09-24 21:57:00 INFO  Estimated unoptimized what-if runtime is 24511.635303497314ms
2022-09-24 21:57:00 INFO  Estimated optimised what-if runtime is 6241.91951751709ms
2022-09-24 21:57:00 INFO  Estimated optimisation runtime saving is 18269.715785980225ms
2022-09-24 21:57:00 INFO  ---RUNTIME: Multi-Query Optimization took 10.807991027832031 ms
2022-09-24 21:57:00 INFO  Executing generated plans
2022-09-24 21:57:07 INFO  ---RUNTIME: Execution took 6328.310251235962 ms
2022-09-24 21:57:07 INFO  Done!
2022-09-24 21:57:07 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-24 21:57:07 INFO  Running instrumented original pipeline...
2022-09-24 21:57:07 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-24 21:57:07 INFO  ---RUNTIME: Importing and monkey-patching took 6.0062408447265625 ms
2022-09-24 21:57:12 INFO  ---RUNTIME: Original pipeline execution took 5194.514989852905 ms (excluding imports and monkey-patching)
2022-09-24 21:57:12 INFO  Starting execution of 1 what-if analyses...
2022-09-24 21:57:12 INFO  Start plan generation for analysis PermutationFeatureImportance...
2022-09-24 21:57:12 INFO  ---RUNTIME: Plan generation took 0.10085105895996094 ms
2022-09-24 21:57:12 INFO  Estimated runtime of original DAG is 4901.2908935546875ms
2022-09-24 21:57:12 WARNING Skipping Multi-Query Optimization (instead, only applying patches)
2022-09-24 21:57:12 INFO  Estimated unoptimised what-if runtime is 24506.454467773438ms
2022-09-24 21:57:12 INFO  ---RUNTIME: Multi-Query Optimization took 3.9353370666503906 ms
2022-09-24 21:57:12 INFO  Executing generated plans
2022-09-24 21:57:37 INFO  ---RUNTIME: Execution took 24693.195581436157 ms
2022-09-24 21:57:37 INFO  Done!
2022-09-24 21:57:37 INFO  # Finished -- repetition 7 of 7 
2022-09-24 21:57:37 INFO  # Final results after all repetitions
2022-09-24 21:57:37 INFO     repetition  ... no_opt_what_if_execution_combined_model_training
0           0  ...                                       595.140219
1           1  ...                                       592.882633
2           2  ...                                       594.001532
3           3  ...                                       597.118139
4           4  ...                                       598.212719
5           5  ...                                       594.210148
6           6  ...                                       587.538242

[7 rows x 26 columns]
PROTOCOL_BUFFERS_PYTHON_IMPLEMENTATION=python taskset -c 32-39 python3.9 benchmarks_end_to_end.py feature_importance reviews fast_loading featurization_1 xgboost
2022-09-24 21:57:39.204991: W tensorflow/stream_executor/platform/default/dso_loader.cc:64] Could not load dynamic library 'libcudart.so.11.0'; dlerror: libcudart.so.11.0: cannot open shared object file: No such file or directory; LD_LIBRARY_PATH: /home/sgrafbe/mlwhatif/venv/lib/python3.9/site-packages/cv2/../../lib64:
2022-09-24 21:57:39.205039: I tensorflow/stream_executor/cuda/cudart_stub.cc:29] Ignore above cudart dlerror if you do not have a GPU set up on your machine.
2022-09-24 21:57:40 INFO  Patching sys.argv with ['mlwhatif', 'reviews', 'fast_loading', 'featurization_1', 'xgboost']
2022-09-24 21:57:40 INFO  Running instrumented original pipeline...
2022-09-24 21:57:40 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-24 21:57:40 INFO  ---RUNTIME: Importing and monkey-patching took 122.91955947875977 ms
2022-09-24 21:57:48 INFO  ---RUNTIME: Original pipeline execution took 7945.915699005127 ms (excluding imports and monkey-patching)
2022-09-24 21:57:48 INFO  Starting execution of 0 what-if analyses...
2022-09-24 21:57:48 INFO  Estimated runtime of original DAG is 7605.052471160889ms
2022-09-24 21:57:48 INFO  Performing Multi-Query Optimization
2022-09-24 21:57:48 INFO  Estimated unoptimized what-if runtime is 0ms
2022-09-24 21:57:48 INFO  Estimated optimised what-if runtime is 0ms
2022-09-24 21:57:48 INFO  Estimated optimisation runtime saving is 0ms
2022-09-24 21:57:48 INFO  ---RUNTIME: Multi-Query Optimization took 0.5030632019042969 ms
2022-09-24 21:57:48 INFO  Executing generated plans
2022-09-24 21:57:48 INFO  ---RUNTIME: Execution took 0.03170967102050781 ms
2022-09-24 21:57:48 INFO  Done!
2022-09-24 21:57:48 INFO  # Optimization benchmark for feature_importance with args [['reviews', 'fast_loading', 'featurization_1', 'xgboost']] -- repetition 1 of 7
2022-09-24 21:57:48 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-24 21:57:48 INFO  Running instrumented original pipeline...
2022-09-24 21:57:48 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-24 21:57:48 INFO  ---RUNTIME: Importing and monkey-patching took 5.715370178222656 ms
2022-09-24 21:57:56 INFO  ---RUNTIME: Original pipeline execution took 8022.629976272583 ms (excluding imports and monkey-patching)
2022-09-24 21:57:56 INFO  Starting execution of 1 what-if analyses...
2022-09-24 21:57:56 INFO  Start plan generation for analysis PermutationFeatureImportance...
2022-09-24 21:57:56 INFO  ---RUNTIME: Plan generation took 0.18477439880371094 ms
2022-09-24 21:57:56 INFO  Estimated runtime of original DAG is 7559.176921844482ms
2022-09-24 21:57:56 INFO  Performing Multi-Query Optimization
2022-09-24 21:57:56 INFO  Estimated unoptimized what-if runtime is 37795.88460922241ms
2022-09-24 21:57:56 INFO  Estimated optimised what-if runtime is 10099.713325500488ms
2022-09-24 21:57:56 INFO  Estimated optimisation runtime saving is 27696.171283721924ms
2022-09-24 21:57:56 INFO  ---RUNTIME: Multi-Query Optimization took 10.245084762573242 ms
2022-09-24 21:57:56 INFO  Executing generated plans
2022-09-24 21:58:06 INFO  ---RUNTIME: Execution took 10217.638492584229 ms
2022-09-24 21:58:06 INFO  Done!
2022-09-24 21:58:06 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-24 21:58:06 INFO  Running instrumented original pipeline...
2022-09-24 21:58:06 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-24 21:58:06 INFO  ---RUNTIME: Importing and monkey-patching took 6.064176559448242 ms
2022-09-24 21:58:14 INFO  ---RUNTIME: Original pipeline execution took 7870.622634887695 ms (excluding imports and monkey-patching)
2022-09-24 21:58:14 INFO  Starting execution of 1 what-if analyses...
2022-09-24 21:58:14 INFO  Start plan generation for analysis PermutationFeatureImportance...
2022-09-24 21:58:14 INFO  ---RUNTIME: Plan generation took 0.141143798828125 ms
2022-09-24 21:58:14 INFO  Estimated runtime of original DAG is 7563.353776931763ms
2022-09-24 21:58:14 WARNING Skipping Multi-Query Optimization (instead, only applying patches)
2022-09-24 21:58:14 INFO  Estimated unoptimised what-if runtime is 37816.76888465881ms
2022-09-24 21:58:14 INFO  ---RUNTIME: Multi-Query Optimization took 5.005121231079102 ms
2022-09-24 21:58:14 INFO  Executing generated plans
2022-09-24 21:58:52 INFO  ---RUNTIME: Execution took 38149.147510528564 ms
2022-09-24 21:58:52 INFO  Done!
2022-09-24 21:58:52 INFO  # Finished -- repetition 1 of 7 
2022-09-24 21:58:52 INFO  # Optimization benchmark for feature_importance with args [['reviews', 'fast_loading', 'featurization_1', 'xgboost']] -- repetition 2 of 7
2022-09-24 21:58:52 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-24 21:58:52 INFO  Running instrumented original pipeline...
2022-09-24 21:58:52 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-24 21:58:52 INFO  ---RUNTIME: Importing and monkey-patching took 6.27899169921875 ms
2022-09-24 21:59:00 INFO  ---RUNTIME: Original pipeline execution took 7856.433868408203 ms (excluding imports and monkey-patching)
2022-09-24 21:59:00 INFO  Starting execution of 1 what-if analyses...
2022-09-24 21:59:00 INFO  Start plan generation for analysis PermutationFeatureImportance...
2022-09-24 21:59:00 INFO  ---RUNTIME: Plan generation took 0.13113021850585938 ms
2022-09-24 21:59:00 INFO  Estimated runtime of original DAG is 7550.887584686279ms
2022-09-24 21:59:00 INFO  Performing Multi-Query Optimization
2022-09-24 21:59:00 INFO  Estimated unoptimized what-if runtime is 37754.4379234314ms
2022-09-24 21:59:00 INFO  Estimated optimised what-if runtime is 10077.948093414307ms
2022-09-24 21:59:00 INFO  Estimated optimisation runtime saving is 27676.48983001709ms
2022-09-24 21:59:00 INFO  ---RUNTIME: Multi-Query Optimization took 10.12730598449707 ms
2022-09-24 21:59:00 INFO  Executing generated plans
2022-09-24 21:59:10 INFO  ---RUNTIME: Execution took 10195.050954818726 ms
2022-09-24 21:59:10 INFO  Done!
2022-09-24 21:59:10 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-24 21:59:10 INFO  Running instrumented original pipeline...
2022-09-24 21:59:10 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-24 21:59:10 INFO  ---RUNTIME: Importing and monkey-patching took 5.913019180297852 ms
2022-09-24 21:59:18 INFO  ---RUNTIME: Original pipeline execution took 7871.880531311035 ms (excluding imports and monkey-patching)
2022-09-24 21:59:18 INFO  Starting execution of 1 what-if analyses...
2022-09-24 21:59:18 INFO  Start plan generation for analysis PermutationFeatureImportance...
2022-09-24 21:59:18 INFO  ---RUNTIME: Plan generation took 0.1049041748046875 ms
2022-09-24 21:59:18 INFO  Estimated runtime of original DAG is 7563.367128372192ms
2022-09-24 21:59:18 WARNING Skipping Multi-Query Optimization (instead, only applying patches)
2022-09-24 21:59:18 INFO  Estimated unoptimised what-if runtime is 37816.83564186096ms
2022-09-24 21:59:18 INFO  ---RUNTIME: Multi-Query Optimization took 4.0035247802734375 ms
2022-09-24 21:59:18 INFO  Executing generated plans
2022-09-24 21:59:57 INFO  ---RUNTIME: Execution took 38195.41621208191 ms
2022-09-24 21:59:57 INFO  Done!
2022-09-24 21:59:57 INFO  # Finished -- repetition 2 of 7 
2022-09-24 21:59:57 INFO  # Optimization benchmark for feature_importance with args [['reviews', 'fast_loading', 'featurization_1', 'xgboost']] -- repetition 3 of 7
2022-09-24 21:59:57 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-24 21:59:57 INFO  Running instrumented original pipeline...
2022-09-24 21:59:57 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-24 21:59:57 INFO  ---RUNTIME: Importing and monkey-patching took 6.345272064208984 ms
2022-09-24 22:00:04 INFO  ---RUNTIME: Original pipeline execution took 7856.834173202515 ms (excluding imports and monkey-patching)
2022-09-24 22:00:04 INFO  Starting execution of 1 what-if analyses...
2022-09-24 22:00:04 INFO  Start plan generation for analysis PermutationFeatureImportance...
2022-09-24 22:00:04 INFO  ---RUNTIME: Plan generation took 0.1418590545654297 ms
2022-09-24 22:00:04 INFO  Estimated runtime of original DAG is 7550.23193359375ms
2022-09-24 22:00:04 INFO  Performing Multi-Query Optimization
2022-09-24 22:00:04 INFO  Estimated unoptimized what-if runtime is 37751.15966796875ms
2022-09-24 22:00:04 INFO  Estimated optimised what-if runtime is 10073.787927627563ms
2022-09-24 22:00:04 INFO  Estimated optimisation runtime saving is 27677.371740341187ms
2022-09-24 22:00:04 INFO  ---RUNTIME: Multi-Query Optimization took 10.823965072631836 ms
2022-09-24 22:00:04 INFO  Executing generated plans
2022-09-24 22:00:15 INFO  ---RUNTIME: Execution took 10206.358671188354 ms
2022-09-24 22:00:15 INFO  Done!
2022-09-24 22:00:15 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-24 22:00:15 INFO  Running instrumented original pipeline...
2022-09-24 22:00:15 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-24 22:00:15 INFO  ---RUNTIME: Importing and monkey-patching took 6.019353866577148 ms
2022-09-24 22:00:23 INFO  ---RUNTIME: Original pipeline execution took 7871.704578399658 ms (excluding imports and monkey-patching)
2022-09-24 22:00:23 INFO  Starting execution of 1 what-if analyses...
2022-09-24 22:00:23 INFO  Start plan generation for analysis PermutationFeatureImportance...
2022-09-24 22:00:23 INFO  ---RUNTIME: Plan generation took 0.10347366333007812 ms
2022-09-24 22:00:23 INFO  Estimated runtime of original DAG is 7564.008712768555ms
2022-09-24 22:00:23 WARNING Skipping Multi-Query Optimization (instead, only applying patches)
2022-09-24 22:00:23 INFO  Estimated unoptimised what-if runtime is 37820.04356384277ms
2022-09-24 22:00:23 INFO  ---RUNTIME: Multi-Query Optimization took 4.0740966796875 ms
2022-09-24 22:00:23 INFO  Executing generated plans
2022-09-24 22:01:01 INFO  ---RUNTIME: Execution took 38180.02724647522 ms
2022-09-24 22:01:01 INFO  Done!
2022-09-24 22:01:01 INFO  # Finished -- repetition 3 of 7 
2022-09-24 22:01:01 INFO  # Optimization benchmark for feature_importance with args [['reviews', 'fast_loading', 'featurization_1', 'xgboost']] -- repetition 4 of 7
2022-09-24 22:01:01 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-24 22:01:01 INFO  Running instrumented original pipeline...
2022-09-24 22:01:01 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-24 22:01:01 INFO  ---RUNTIME: Importing and monkey-patching took 6.378173828125 ms
2022-09-24 22:01:09 INFO  ---RUNTIME: Original pipeline execution took 7866.221189498901 ms (excluding imports and monkey-patching)
2022-09-24 22:01:09 INFO  Starting execution of 1 what-if analyses...
2022-09-24 22:01:09 INFO  Start plan generation for analysis PermutationFeatureImportance...
2022-09-24 22:01:09 INFO  ---RUNTIME: Plan generation took 0.12087821960449219 ms
2022-09-24 22:01:09 INFO  Estimated runtime of original DAG is 7556.936740875244ms
2022-09-24 22:01:09 INFO  Performing Multi-Query Optimization
2022-09-24 22:01:09 INFO  Estimated unoptimized what-if runtime is 37784.68370437622ms
2022-09-24 22:01:09 INFO  Estimated optimised what-if runtime is 10079.225063323975ms
2022-09-24 22:01:09 INFO  Estimated optimisation runtime saving is 27705.458641052246ms
2022-09-24 22:01:09 INFO  ---RUNTIME: Multi-Query Optimization took 11.417388916015625 ms
2022-09-24 22:01:09 INFO  Executing generated plans
2022-09-24 22:01:19 INFO  ---RUNTIME: Execution took 10199.718236923218 ms
2022-09-24 22:01:19 INFO  Done!
2022-09-24 22:01:19 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-24 22:01:19 INFO  Running instrumented original pipeline...
2022-09-24 22:01:19 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-24 22:01:19 INFO  ---RUNTIME: Importing and monkey-patching took 5.889415740966797 ms
2022-09-24 22:01:27 INFO  ---RUNTIME: Original pipeline execution took 8064.074277877808 ms (excluding imports and monkey-patching)
2022-09-24 22:01:27 INFO  Starting execution of 1 what-if analyses...
2022-09-24 22:01:27 INFO  Start plan generation for analysis PermutationFeatureImportance...
2022-09-24 22:01:27 INFO  ---RUNTIME: Plan generation took 0.12254714965820312 ms
2022-09-24 22:01:27 INFO  Estimated runtime of original DAG is 7557.746887207031ms
2022-09-24 22:01:27 WARNING Skipping Multi-Query Optimization (instead, only applying patches)
2022-09-24 22:01:27 INFO  Estimated unoptimised what-if runtime is 37788.734436035156ms
2022-09-24 22:01:27 INFO  ---RUNTIME: Multi-Query Optimization took 4.736185073852539 ms
2022-09-24 22:01:27 INFO  Executing generated plans
2022-09-24 22:02:05 INFO  ---RUNTIME: Execution took 38192.036628723145 ms
2022-09-24 22:02:05 INFO  Done!
2022-09-24 22:02:05 INFO  # Finished -- repetition 4 of 7 
2022-09-24 22:02:05 INFO  # Optimization benchmark for feature_importance with args [['reviews', 'fast_loading', 'featurization_1', 'xgboost']] -- repetition 5 of 7
2022-09-24 22:02:05 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-24 22:02:05 INFO  Running instrumented original pipeline...
2022-09-24 22:02:05 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-24 22:02:05 INFO  ---RUNTIME: Importing and monkey-patching took 6.188154220581055 ms
2022-09-24 22:02:13 INFO  ---RUNTIME: Original pipeline execution took 7883.688926696777 ms (excluding imports and monkey-patching)
2022-09-24 22:02:13 INFO  Starting execution of 1 what-if analyses...
2022-09-24 22:02:13 INFO  Start plan generation for analysis PermutationFeatureImportance...
2022-09-24 22:02:13 INFO  ---RUNTIME: Plan generation took 0.11968612670898438 ms
2022-09-24 22:02:13 INFO  Estimated runtime of original DAG is 7573.119878768921ms
2022-09-24 22:02:13 INFO  Performing Multi-Query Optimization
2022-09-24 22:02:13 INFO  Estimated unoptimized what-if runtime is 37865.599393844604ms
2022-09-24 22:02:13 INFO  Estimated optimised what-if runtime is 10115.15736579895ms
2022-09-24 22:02:13 INFO  Estimated optimisation runtime saving is 27750.442028045654ms
2022-09-24 22:02:13 INFO  ---RUNTIME: Multi-Query Optimization took 10.167837142944336 ms
2022-09-24 22:02:13 INFO  Executing generated plans
2022-09-24 22:02:23 INFO  ---RUNTIME: Execution took 10209.879875183105 ms
2022-09-24 22:02:23 INFO  Done!
2022-09-24 22:02:23 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-24 22:02:23 INFO  Running instrumented original pipeline...
2022-09-24 22:02:23 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-24 22:02:23 INFO  ---RUNTIME: Importing and monkey-patching took 6.236553192138672 ms
2022-09-24 22:02:31 INFO  ---RUNTIME: Original pipeline execution took 7862.3716831207275 ms (excluding imports and monkey-patching)
2022-09-24 22:02:31 INFO  Starting execution of 1 what-if analyses...
2022-09-24 22:02:31 INFO  Start plan generation for analysis PermutationFeatureImportance...
2022-09-24 22:02:31 INFO  ---RUNTIME: Plan generation took 0.10919570922851562 ms
2022-09-24 22:02:31 INFO  Estimated runtime of original DAG is 7552.691221237183ms
2022-09-24 22:02:31 WARNING Skipping Multi-Query Optimization (instead, only applying patches)
2022-09-24 22:02:31 INFO  Estimated unoptimised what-if runtime is 37763.45610618591ms
2022-09-24 22:02:31 INFO  ---RUNTIME: Multi-Query Optimization took 3.998994827270508 ms
2022-09-24 22:02:31 INFO  Executing generated plans
2022-09-24 22:03:09 INFO  ---RUNTIME: Execution took 38198.76313209534 ms
2022-09-24 22:03:09 INFO  Done!
2022-09-24 22:03:09 INFO  # Finished -- repetition 5 of 7 
2022-09-24 22:03:09 INFO  # Optimization benchmark for feature_importance with args [['reviews', 'fast_loading', 'featurization_1', 'xgboost']] -- repetition 6 of 7
2022-09-24 22:03:09 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-24 22:03:09 INFO  Running instrumented original pipeline...
2022-09-24 22:03:09 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-24 22:03:09 INFO  ---RUNTIME: Importing and monkey-patching took 6.498813629150391 ms
2022-09-24 22:03:17 INFO  ---RUNTIME: Original pipeline execution took 7857.239246368408 ms (excluding imports and monkey-patching)
2022-09-24 22:03:17 INFO  Starting execution of 1 what-if analyses...
2022-09-24 22:03:17 INFO  Start plan generation for analysis PermutationFeatureImportance...
2022-09-24 22:03:17 INFO  ---RUNTIME: Plan generation took 0.11730194091796875 ms
2022-09-24 22:03:17 INFO  Estimated runtime of original DAG is 7546.117782592773ms
2022-09-24 22:03:17 INFO  Performing Multi-Query Optimization
2022-09-24 22:03:17 INFO  Estimated unoptimized what-if runtime is 37730.58891296387ms
2022-09-24 22:03:17 INFO  Estimated optimised what-if runtime is 10063.615083694458ms
2022-09-24 22:03:17 INFO  Estimated optimisation runtime saving is 27666.97382926941ms
2022-09-24 22:03:17 INFO  ---RUNTIME: Multi-Query Optimization took 10.74075698852539 ms
2022-09-24 22:03:17 INFO  Executing generated plans
2022-09-24 22:03:27 INFO  ---RUNTIME: Execution took 10194.220542907715 ms
2022-09-24 22:03:27 INFO  Done!
2022-09-24 22:03:27 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-24 22:03:27 INFO  Running instrumented original pipeline...
2022-09-24 22:03:27 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-24 22:03:27 INFO  ---RUNTIME: Importing and monkey-patching took 6.46209716796875 ms
2022-09-24 22:03:35 INFO  ---RUNTIME: Original pipeline execution took 7890.5956745147705 ms (excluding imports and monkey-patching)
2022-09-24 22:03:35 INFO  Starting execution of 1 what-if analyses...
2022-09-24 22:03:35 INFO  Start plan generation for analysis PermutationFeatureImportance...
2022-09-24 22:03:35 INFO  ---RUNTIME: Plan generation took 0.10156631469726562 ms
2022-09-24 22:03:35 INFO  Estimated runtime of original DAG is 7582.009077072144ms
2022-09-24 22:03:35 WARNING Skipping Multi-Query Optimization (instead, only applying patches)
2022-09-24 22:03:35 INFO  Estimated unoptimised what-if runtime is 37910.04538536072ms
2022-09-24 22:03:35 INFO  ---RUNTIME: Multi-Query Optimization took 3.983020782470703 ms
2022-09-24 22:03:35 INFO  Executing generated plans
2022-09-24 22:04:14 INFO  ---RUNTIME: Execution took 38209.237575531006 ms
2022-09-24 22:04:14 INFO  Done!
2022-09-24 22:04:14 INFO  # Finished -- repetition 6 of 7 
2022-09-24 22:04:14 INFO  # Optimization benchmark for feature_importance with args [['reviews', 'fast_loading', 'featurization_1', 'xgboost']] -- repetition 7 of 7
2022-09-24 22:04:14 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-24 22:04:14 INFO  Running instrumented original pipeline...
2022-09-24 22:04:14 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-24 22:04:14 INFO  ---RUNTIME: Importing and monkey-patching took 6.37507438659668 ms
2022-09-24 22:04:21 INFO  ---RUNTIME: Original pipeline execution took 7873.113632202148 ms (excluding imports and monkey-patching)
2022-09-24 22:04:21 INFO  Starting execution of 1 what-if analyses...
2022-09-24 22:04:21 INFO  Start plan generation for analysis PermutationFeatureImportance...
2022-09-24 22:04:21 INFO  ---RUNTIME: Plan generation took 0.1239776611328125 ms
2022-09-24 22:04:21 INFO  Estimated runtime of original DAG is 7560.835838317871ms
2022-09-24 22:04:21 INFO  Performing Multi-Query Optimization
2022-09-24 22:04:21 INFO  Estimated unoptimized what-if runtime is 37804.179191589355ms
2022-09-24 22:04:21 INFO  Estimated optimised what-if runtime is 10101.676225662231ms
2022-09-24 22:04:21 INFO  Estimated optimisation runtime saving is 27702.502965927124ms
2022-09-24 22:04:21 INFO  ---RUNTIME: Multi-Query Optimization took 11.579036712646484 ms
2022-09-24 22:04:21 INFO  Executing generated plans
2022-09-24 22:04:32 INFO  ---RUNTIME: Execution took 10211.282730102539 ms
2022-09-24 22:04:32 INFO  Done!
2022-09-24 22:04:32 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-24 22:04:32 INFO  Running instrumented original pipeline...
2022-09-24 22:04:32 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-24 22:04:32 INFO  ---RUNTIME: Importing and monkey-patching took 6.019115447998047 ms
2022-09-24 22:04:40 INFO  ---RUNTIME: Original pipeline execution took 7903.277158737183 ms (excluding imports and monkey-patching)
2022-09-24 22:04:40 INFO  Starting execution of 1 what-if analyses...
2022-09-24 22:04:40 INFO  Start plan generation for analysis PermutationFeatureImportance...
2022-09-24 22:04:40 INFO  ---RUNTIME: Plan generation took 0.1125335693359375 ms
2022-09-24 22:04:40 INFO  Estimated runtime of original DAG is 7594.25950050354ms
2022-09-24 22:04:40 WARNING Skipping Multi-Query Optimization (instead, only applying patches)
2022-09-24 22:04:40 INFO  Estimated unoptimised what-if runtime is 37971.2975025177ms
2022-09-24 22:04:40 INFO  ---RUNTIME: Multi-Query Optimization took 4.004955291748047 ms
2022-09-24 22:04:40 INFO  Executing generated plans
2022-09-24 22:05:18 INFO  ---RUNTIME: Execution took 38193.0570602417 ms
2022-09-24 22:05:18 INFO  Done!
2022-09-24 22:05:18 INFO  # Finished -- repetition 7 of 7 
2022-09-24 22:05:18 INFO  # Final results after all repetitions
2022-09-24 22:05:18 INFO     repetition  ... no_opt_what_if_execution_combined_model_training
0           0  ...                                     12717.718601
1           1  ...                                     12720.869541
2           2  ...                                     12708.669901
3           3  ...                                     12708.309889
4           4  ...                                     12700.124264
5           5  ...                                     12689.085722
6           6  ...                                     12719.139099

[7 rows x 26 columns]
PROTOCOL_BUFFERS_PYTHON_IMPLEMENTATION=python taskset -c 32-39 python3.9 benchmarks_end_to_end.py feature_importance reviews fast_loading featurization_1 neural_network
2022-09-24 22:05:20.476573: W tensorflow/stream_executor/platform/default/dso_loader.cc:64] Could not load dynamic library 'libcudart.so.11.0'; dlerror: libcudart.so.11.0: cannot open shared object file: No such file or directory; LD_LIBRARY_PATH: /home/sgrafbe/mlwhatif/venv/lib/python3.9/site-packages/cv2/../../lib64:
2022-09-24 22:05:20.476620: I tensorflow/stream_executor/cuda/cudart_stub.cc:29] Ignore above cudart dlerror if you do not have a GPU set up on your machine.
2022-09-24 22:05:21 INFO  Patching sys.argv with ['mlwhatif', 'reviews', 'fast_loading', 'featurization_1', 'neural_network']
2022-09-24 22:05:21 INFO  Running instrumented original pipeline...
2022-09-24 22:05:21 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-24 22:05:21 INFO  ---RUNTIME: Importing and monkey-patching took 121.43135070800781 ms
2022-09-24 22:05:25.614866: W tensorflow/stream_executor/platform/default/dso_loader.cc:64] Could not load dynamic library 'libcuda.so.1'; dlerror: libcuda.so.1: cannot open shared object file: No such file or directory; LD_LIBRARY_PATH: /home/sgrafbe/mlwhatif/venv/lib/python3.9/site-packages/cv2/../../lib64:
2022-09-24 22:05:25.614902: W tensorflow/stream_executor/cuda/cuda_driver.cc:326] failed call to cuInit: UNKNOWN ERROR (303)
2022-09-24 22:05:25.614924: I tensorflow/stream_executor/cuda/cuda_diagnostics.cc:156] kernel driver does not appear to be running on this host (angus): /proc/driver/nvidia/version does not exist
2022-09-24 22:05:25.615451: I tensorflow/core/platform/cpu_feature_guard.cc:142] This TensorFlow binary is optimized with oneAPI Deep Neural Network Library (oneDNN) to use the following CPU instructions in performance-critical operations:  AVX2 FMA
To enable them in other operations, rebuild TensorFlow with the appropriate compiler flags.
2022-09-24 22:05:25.844439: I tensorflow/compiler/mlir/mlir_graph_optimization_pass.cc:176] None of the MLIR Optimization Passes are enabled (registered 2)
2022-09-24 22:05:25.857188: I tensorflow/core/platform/profile_utils/cpu_utils.cc:114] CPU Frequency: 2595130000 Hz
2022-09-24 22:05:30 INFO  ---RUNTIME: Original pipeline execution took 8992.489576339722 ms (excluding imports and monkey-patching)
2022-09-24 22:05:30 INFO  Starting execution of 0 what-if analyses...
2022-09-24 22:05:30 INFO  Estimated runtime of original DAG is 8667.448997497559ms
2022-09-24 22:05:30 INFO  Performing Multi-Query Optimization
2022-09-24 22:05:30 INFO  Estimated unoptimized what-if runtime is 0ms
2022-09-24 22:05:30 INFO  Estimated optimised what-if runtime is 0ms
2022-09-24 22:05:30 INFO  Estimated optimisation runtime saving is 0ms
2022-09-24 22:05:30 INFO  ---RUNTIME: Multi-Query Optimization took 0.48422813415527344 ms
2022-09-24 22:05:30 INFO  Executing generated plans
2022-09-24 22:05:30 INFO  ---RUNTIME: Execution took 0.021696090698242188 ms
2022-09-24 22:05:30 INFO  Done!
2022-09-24 22:05:30 INFO  # Optimization benchmark for feature_importance with args [['reviews', 'fast_loading', 'featurization_1', 'neural_network']] -- repetition 1 of 7
2022-09-24 22:05:30 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-24 22:05:30 INFO  Running instrumented original pipeline...
2022-09-24 22:05:30 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-24 22:05:30 INFO  ---RUNTIME: Importing and monkey-patching took 5.396842956542969 ms
2022-09-24 22:05:39 INFO  ---RUNTIME: Original pipeline execution took 8679.495334625244 ms (excluding imports and monkey-patching)
2022-09-24 22:05:39 INFO  Starting execution of 1 what-if analyses...
2022-09-24 22:05:39 INFO  Start plan generation for analysis PermutationFeatureImportance...
2022-09-24 22:05:39 INFO  ---RUNTIME: Plan generation took 0.19550323486328125 ms
2022-09-24 22:05:39 INFO  Estimated runtime of original DAG is 8389.390468597412ms
2022-09-24 22:05:39 INFO  Performing Multi-Query Optimization
2022-09-24 22:05:39 INFO  Estimated unoptimized what-if runtime is 41946.95234298706ms
2022-09-24 22:05:39 INFO  Estimated optimised what-if runtime is 11407.99856185913ms
2022-09-24 22:05:39 INFO  Estimated optimisation runtime saving is 30538.95378112793ms
2022-09-24 22:05:39 INFO  ---RUNTIME: Multi-Query Optimization took 11.394739151000977 ms
2022-09-24 22:05:39 INFO  Executing generated plans
2022-09-24 22:05:50 INFO  ---RUNTIME: Execution took 11230.839967727661 ms
2022-09-24 22:05:50 INFO  Done!
2022-09-24 22:05:50 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-24 22:05:50 INFO  Running instrumented original pipeline...
2022-09-24 22:05:50 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-24 22:05:50 INFO  ---RUNTIME: Importing and monkey-patching took 6.237268447875977 ms
2022-09-24 22:05:59 INFO  ---RUNTIME: Original pipeline execution took 8806.304454803467 ms (excluding imports and monkey-patching)
2022-09-24 22:05:59 INFO  Starting execution of 1 what-if analyses...
2022-09-24 22:05:59 INFO  Start plan generation for analysis PermutationFeatureImportance...
2022-09-24 22:05:59 INFO  ---RUNTIME: Plan generation took 0.12969970703125 ms
2022-09-24 22:05:59 INFO  Estimated runtime of original DAG is 8513.635873794556ms
2022-09-24 22:05:59 WARNING Skipping Multi-Query Optimization (instead, only applying patches)
2022-09-24 22:05:59 INFO  Estimated unoptimised what-if runtime is 42568.17936897278ms
2022-09-24 22:05:59 INFO  ---RUNTIME: Multi-Query Optimization took 3.904581069946289 ms
2022-09-24 22:05:59 INFO  Executing generated plans
2022-09-24 22:06:41 INFO  ---RUNTIME: Execution took 41878.098011016846 ms
2022-09-24 22:06:41 INFO  Done!
2022-09-24 22:06:41 INFO  # Finished -- repetition 1 of 7 
2022-09-24 22:06:41 INFO  # Optimization benchmark for feature_importance with args [['reviews', 'fast_loading', 'featurization_1', 'neural_network']] -- repetition 2 of 7
2022-09-24 22:06:41 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-24 22:06:41 INFO  Running instrumented original pipeline...
2022-09-24 22:06:41 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-24 22:06:41 INFO  ---RUNTIME: Importing and monkey-patching took 6.122112274169922 ms
2022-09-24 22:06:50 INFO  ---RUNTIME: Original pipeline execution took 8868.064165115356 ms (excluding imports and monkey-patching)
2022-09-24 22:06:50 INFO  Starting execution of 1 what-if analyses...
2022-09-24 22:06:50 INFO  Start plan generation for analysis PermutationFeatureImportance...
2022-09-24 22:06:50 INFO  ---RUNTIME: Plan generation took 0.1068115234375 ms
2022-09-24 22:06:50 INFO  Estimated runtime of original DAG is 8578.61351966858ms
2022-09-24 22:06:50 INFO  Performing Multi-Query Optimization
2022-09-24 22:06:50 INFO  Estimated unoptimized what-if runtime is 42893.067598342896ms
2022-09-24 22:06:50 INFO  Estimated optimised what-if runtime is 11404.749393463135ms
2022-09-24 22:06:50 INFO  Estimated optimisation runtime saving is 31488.31820487976ms
2022-09-24 22:06:50 INFO  ---RUNTIME: Multi-Query Optimization took 11.101961135864258 ms
2022-09-24 22:06:50 INFO  Executing generated plans
2022-09-24 22:07:01 INFO  ---RUNTIME: Execution took 11343.825101852417 ms
2022-09-24 22:07:01 INFO  Done!
2022-09-24 22:07:01 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-24 22:07:01 INFO  Running instrumented original pipeline...
2022-09-24 22:07:01 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-24 22:07:01 INFO  ---RUNTIME: Importing and monkey-patching took 6.041765213012695 ms
2022-09-24 22:07:10 INFO  ---RUNTIME: Original pipeline execution took 8648.787260055542 ms (excluding imports and monkey-patching)
2022-09-24 22:07:10 INFO  Starting execution of 1 what-if analyses...
2022-09-24 22:07:10 INFO  Start plan generation for analysis PermutationFeatureImportance...
2022-09-24 22:07:10 INFO  ---RUNTIME: Plan generation took 0.1342296600341797 ms
2022-09-24 22:07:10 INFO  Estimated runtime of original DAG is 8352.341413497925ms
2022-09-24 22:07:10 WARNING Skipping Multi-Query Optimization (instead, only applying patches)
2022-09-24 22:07:10 INFO  Estimated unoptimised what-if runtime is 41761.707067489624ms
2022-09-24 22:07:10 INFO  ---RUNTIME: Multi-Query Optimization took 3.9288997650146484 ms
2022-09-24 22:07:10 INFO  Executing generated plans
2022-09-24 22:07:53 INFO  ---RUNTIME: Execution took 43495.43070793152 ms
2022-09-24 22:07:53 INFO  Done!
2022-09-24 22:07:53 INFO  # Finished -- repetition 2 of 7 
2022-09-24 22:07:53 INFO  # Optimization benchmark for feature_importance with args [['reviews', 'fast_loading', 'featurization_1', 'neural_network']] -- repetition 3 of 7
2022-09-24 22:07:53 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-24 22:07:53 INFO  Running instrumented original pipeline...
2022-09-24 22:07:53 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-24 22:07:53 INFO  ---RUNTIME: Importing and monkey-patching took 6.50334358215332 ms
2022-09-24 22:08:03 INFO  ---RUNTIME: Original pipeline execution took 9435.128927230835 ms (excluding imports and monkey-patching)
2022-09-24 22:08:03 INFO  Starting execution of 1 what-if analyses...
2022-09-24 22:08:03 INFO  Start plan generation for analysis PermutationFeatureImportance...
2022-09-24 22:08:03 INFO  ---RUNTIME: Plan generation took 0.10943412780761719 ms
2022-09-24 22:08:03 INFO  Estimated runtime of original DAG is 9120.89228630066ms
2022-09-24 22:08:03 INFO  Performing Multi-Query Optimization
2022-09-24 22:08:03 INFO  Estimated unoptimized what-if runtime is 45604.461431503296ms
2022-09-24 22:08:03 INFO  Estimated optimised what-if runtime is 12308.166027069092ms
2022-09-24 22:08:03 INFO  Estimated optimisation runtime saving is 33296.295404434204ms
2022-09-24 22:08:03 INFO  ---RUNTIME: Multi-Query Optimization took 11.725902557373047 ms
2022-09-24 22:08:03 INFO  Executing generated plans
2022-09-24 22:08:15 INFO  ---RUNTIME: Execution took 11699.603796005249 ms
2022-09-24 22:08:15 INFO  Done!
2022-09-24 22:08:15 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-24 22:08:15 INFO  Running instrumented original pipeline...
2022-09-24 22:08:15 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-24 22:08:15 INFO  ---RUNTIME: Importing and monkey-patching took 6.183385848999023 ms
2022-09-24 22:08:24 INFO  ---RUNTIME: Original pipeline execution took 9466.15481376648 ms (excluding imports and monkey-patching)
2022-09-24 22:08:24 INFO  Starting execution of 1 what-if analyses...
2022-09-24 22:08:24 INFO  Start plan generation for analysis PermutationFeatureImportance...
2022-09-24 22:08:24 INFO  ---RUNTIME: Plan generation took 0.12040138244628906 ms
2022-09-24 22:08:24 INFO  Estimated runtime of original DAG is 9171.363115310669ms
2022-09-24 22:08:24 WARNING Skipping Multi-Query Optimization (instead, only applying patches)
2022-09-24 22:08:24 INFO  Estimated unoptimised what-if runtime is 45856.815576553345ms
2022-09-24 22:08:24 INFO  ---RUNTIME: Multi-Query Optimization took 4.039287567138672 ms
2022-09-24 22:08:24 INFO  Executing generated plans
2022-09-24 22:09:08 INFO  ---RUNTIME: Execution took 44258.79096984863 ms
2022-09-24 22:09:08 INFO  Done!
2022-09-24 22:09:08 INFO  # Finished -- repetition 3 of 7 
2022-09-24 22:09:08 INFO  # Optimization benchmark for feature_importance with args [['reviews', 'fast_loading', 'featurization_1', 'neural_network']] -- repetition 4 of 7
2022-09-24 22:09:08 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-24 22:09:08 INFO  Running instrumented original pipeline...
2022-09-24 22:09:08 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-24 22:09:08 INFO  ---RUNTIME: Importing and monkey-patching took 6.840229034423828 ms
2022-09-24 22:09:17 INFO  ---RUNTIME: Original pipeline execution took 8631.128549575806 ms (excluding imports and monkey-patching)
2022-09-24 22:09:17 INFO  Starting execution of 1 what-if analyses...
2022-09-24 22:09:17 INFO  Start plan generation for analysis PermutationFeatureImportance...
2022-09-24 22:09:17 INFO  ---RUNTIME: Plan generation took 0.118255615234375 ms
2022-09-24 22:09:17 INFO  Estimated runtime of original DAG is 8331.254243850708ms
2022-09-24 22:09:17 INFO  Performing Multi-Query Optimization
2022-09-24 22:09:17 INFO  Estimated unoptimized what-if runtime is 41656.27121925354ms
2022-09-24 22:09:17 INFO  Estimated optimised what-if runtime is 11245.785474777222ms
2022-09-24 22:09:17 INFO  Estimated optimisation runtime saving is 30410.48574447632ms
2022-09-24 22:09:17 INFO  ---RUNTIME: Multi-Query Optimization took 9.881734848022461 ms
2022-09-24 22:09:17 INFO  Executing generated plans
2022-09-24 22:09:30 INFO  ---RUNTIME: Execution took 12533.91170501709 ms
2022-09-24 22:09:30 INFO  Done!
2022-09-24 22:09:30 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-24 22:09:30 INFO  Running instrumented original pipeline...
2022-09-24 22:09:30 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-24 22:09:30 INFO  ---RUNTIME: Importing and monkey-patching took 6.701946258544922 ms
2022-09-24 22:09:39 INFO  ---RUNTIME: Original pipeline execution took 9443.644046783447 ms (excluding imports and monkey-patching)
2022-09-24 22:09:39 INFO  Starting execution of 1 what-if analyses...
2022-09-24 22:09:39 INFO  Start plan generation for analysis PermutationFeatureImportance...
2022-09-24 22:09:39 INFO  ---RUNTIME: Plan generation took 0.12135505676269531 ms
2022-09-24 22:09:39 INFO  Estimated runtime of original DAG is 9134.856462478638ms
2022-09-24 22:09:39 WARNING Skipping Multi-Query Optimization (instead, only applying patches)
2022-09-24 22:09:39 INFO  Estimated unoptimised what-if runtime is 45674.28231239319ms
2022-09-24 22:09:39 INFO  ---RUNTIME: Multi-Query Optimization took 4.3487548828125 ms
2022-09-24 22:09:39 INFO  Executing generated plans
2022-09-24 22:10:23 INFO  ---RUNTIME: Execution took 43589.44582939148 ms
2022-09-24 22:10:23 INFO  Done!
2022-09-24 22:10:23 INFO  # Finished -- repetition 4 of 7 
2022-09-24 22:10:23 INFO  # Optimization benchmark for feature_importance with args [['reviews', 'fast_loading', 'featurization_1', 'neural_network']] -- repetition 5 of 7
2022-09-24 22:10:23 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-24 22:10:23 INFO  Running instrumented original pipeline...
2022-09-24 22:10:23 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-24 22:10:23 INFO  ---RUNTIME: Importing and monkey-patching took 6.309747695922852 ms
2022-09-24 22:10:32 INFO  ---RUNTIME: Original pipeline execution took 9307.633638381958 ms (excluding imports and monkey-patching)
2022-09-24 22:10:32 INFO  Starting execution of 1 what-if analyses...
2022-09-24 22:10:32 INFO  Start plan generation for analysis PermutationFeatureImportance...
2022-09-24 22:10:32 INFO  ---RUNTIME: Plan generation took 0.1239776611328125 ms
2022-09-24 22:10:32 INFO  Estimated runtime of original DAG is 8593.08934211731ms
2022-09-24 22:10:32 INFO  Performing Multi-Query Optimization
2022-09-24 22:10:32 INFO  Estimated unoptimized what-if runtime is 42965.44671058655ms
2022-09-24 22:10:32 INFO  Estimated optimised what-if runtime is 11742.19298362732ms
2022-09-24 22:10:32 INFO  Estimated optimisation runtime saving is 31223.25372695923ms
2022-09-24 22:10:32 INFO  ---RUNTIME: Multi-Query Optimization took 10.49494743347168 ms
2022-09-24 22:10:32 INFO  Executing generated plans
2022-09-24 22:10:44 INFO  ---RUNTIME: Execution took 11876.624345779419 ms
2022-09-24 22:10:44 INFO  Done!
2022-09-24 22:10:44 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-24 22:10:44 INFO  Running instrumented original pipeline...
2022-09-24 22:10:44 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-24 22:10:44 INFO  ---RUNTIME: Importing and monkey-patching took 6.8111419677734375 ms
2022-09-24 22:10:53 INFO  ---RUNTIME: Original pipeline execution took 8656.972169876099 ms (excluding imports and monkey-patching)
2022-09-24 22:10:53 INFO  Starting execution of 1 what-if analyses...
2022-09-24 22:10:53 INFO  Start plan generation for analysis PermutationFeatureImportance...
2022-09-24 22:10:53 INFO  ---RUNTIME: Plan generation took 0.11658668518066406 ms
2022-09-24 22:10:53 INFO  Estimated runtime of original DAG is 8362.526416778564ms
2022-09-24 22:10:53 WARNING Skipping Multi-Query Optimization (instead, only applying patches)
2022-09-24 22:10:53 INFO  Estimated unoptimised what-if runtime is 41812.63208389282ms
2022-09-24 22:10:53 INFO  ---RUNTIME: Multi-Query Optimization took 3.897428512573242 ms
2022-09-24 22:10:53 INFO  Executing generated plans
2022-09-24 22:11:37 INFO  ---RUNTIME: Execution took 44231.39476776123 ms
2022-09-24 22:11:37 INFO  Done!
2022-09-24 22:11:37 INFO  # Finished -- repetition 5 of 7 
2022-09-24 22:11:37 INFO  # Optimization benchmark for feature_importance with args [['reviews', 'fast_loading', 'featurization_1', 'neural_network']] -- repetition 6 of 7
2022-09-24 22:11:37 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-24 22:11:37 INFO  Running instrumented original pipeline...
2022-09-24 22:11:37 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-24 22:11:37 INFO  ---RUNTIME: Importing and monkey-patching took 5.942344665527344 ms
2022-09-24 22:11:46 INFO  ---RUNTIME: Original pipeline execution took 8861.610174179077 ms (excluding imports and monkey-patching)
2022-09-24 22:11:46 INFO  Starting execution of 1 what-if analyses...
2022-09-24 22:11:46 INFO  Start plan generation for analysis PermutationFeatureImportance...
2022-09-24 22:11:46 INFO  ---RUNTIME: Plan generation took 0.10776519775390625 ms
2022-09-24 22:11:46 INFO  Estimated runtime of original DAG is 8553.720474243164ms
2022-09-24 22:11:46 INFO  Performing Multi-Query Optimization
2022-09-24 22:11:46 INFO  Estimated unoptimized what-if runtime is 42768.60237121582ms
2022-09-24 22:11:46 INFO  Estimated optimised what-if runtime is 11442.659616470337ms
2022-09-24 22:11:46 INFO  Estimated optimisation runtime saving is 31325.942754745483ms
2022-09-24 22:11:46 INFO  ---RUNTIME: Multi-Query Optimization took 9.77635383605957 ms
2022-09-24 22:11:46 INFO  Executing generated plans
2022-09-24 22:11:57 INFO  ---RUNTIME: Execution took 11521.190643310547 ms
2022-09-24 22:11:57 INFO  Done!
2022-09-24 22:11:57 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-24 22:11:57 INFO  Running instrumented original pipeline...
2022-09-24 22:11:57 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-24 22:11:57 INFO  ---RUNTIME: Importing and monkey-patching took 6.799459457397461 ms
2022-09-24 22:12:06 INFO  ---RUNTIME: Original pipeline execution took 8881.633758544922 ms (excluding imports and monkey-patching)
2022-09-24 22:12:06 INFO  Starting execution of 1 what-if analyses...
2022-09-24 22:12:06 INFO  Start plan generation for analysis PermutationFeatureImportance...
2022-09-24 22:12:06 INFO  ---RUNTIME: Plan generation took 0.11515617370605469 ms
2022-09-24 22:12:06 INFO  Estimated runtime of original DAG is 8568.449258804321ms
2022-09-24 22:12:06 WARNING Skipping Multi-Query Optimization (instead, only applying patches)
2022-09-24 22:12:06 INFO  Estimated unoptimised what-if runtime is 42842.24629402161ms
2022-09-24 22:12:06 INFO  ---RUNTIME: Multi-Query Optimization took 4.221439361572266 ms
2022-09-24 22:12:06 INFO  Executing generated plans
2022-09-24 22:12:51 INFO  ---RUNTIME: Execution took 44648.17452430725 ms
2022-09-24 22:12:51 INFO  Done!
2022-09-24 22:12:51 INFO  # Finished -- repetition 6 of 7 
2022-09-24 22:12:51 INFO  # Optimization benchmark for feature_importance with args [['reviews', 'fast_loading', 'featurization_1', 'neural_network']] -- repetition 7 of 7
2022-09-24 22:12:51 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-24 22:12:51 INFO  Running instrumented original pipeline...
2022-09-24 22:12:51 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-24 22:12:51 INFO  ---RUNTIME: Importing and monkey-patching took 6.317377090454102 ms
2022-09-24 22:13:00 INFO  ---RUNTIME: Original pipeline execution took 9097.324848175049 ms (excluding imports and monkey-patching)
2022-09-24 22:13:00 INFO  Starting execution of 1 what-if analyses...
2022-09-24 22:13:00 INFO  Start plan generation for analysis PermutationFeatureImportance...
2022-09-24 22:13:00 INFO  ---RUNTIME: Plan generation took 0.1068115234375 ms
2022-09-24 22:13:00 INFO  Estimated runtime of original DAG is 8795.058488845825ms
2022-09-24 22:13:00 INFO  Performing Multi-Query Optimization
2022-09-24 22:13:00 INFO  Estimated unoptimized what-if runtime is 43975.292444229126ms
2022-09-24 22:13:00 INFO  Estimated optimised what-if runtime is 11769.503593444824ms
2022-09-24 22:13:00 INFO  Estimated optimisation runtime saving is 32205.7888507843ms
2022-09-24 22:13:00 INFO  ---RUNTIME: Multi-Query Optimization took 9.768009185791016 ms
2022-09-24 22:13:00 INFO  Executing generated plans
2022-09-24 22:13:11 INFO  ---RUNTIME: Execution took 11531.508207321167 ms
2022-09-24 22:13:11 INFO  Done!
2022-09-24 22:13:11 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-24 22:13:11 INFO  Running instrumented original pipeline...
2022-09-24 22:13:11 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-24 22:13:11 INFO  ---RUNTIME: Importing and monkey-patching took 5.902290344238281 ms
2022-09-24 22:13:20 INFO  ---RUNTIME: Original pipeline execution took 8855.493783950806 ms (excluding imports and monkey-patching)
2022-09-24 22:13:20 INFO  Starting execution of 1 what-if analyses...
2022-09-24 22:13:20 INFO  Start plan generation for analysis PermutationFeatureImportance...
2022-09-24 22:13:20 INFO  ---RUNTIME: Plan generation took 0.11134147644042969 ms
2022-09-24 22:13:20 INFO  Estimated runtime of original DAG is 8555.73058128357ms
2022-09-24 22:13:20 WARNING Skipping Multi-Query Optimization (instead, only applying patches)
2022-09-24 22:13:20 INFO  Estimated unoptimised what-if runtime is 42778.65290641785ms
2022-09-24 22:13:20 INFO  ---RUNTIME: Multi-Query Optimization took 3.7717819213867188 ms
2022-09-24 22:13:20 INFO  Executing generated plans
2022-09-24 22:14:04 INFO  ---RUNTIME: Execution took 43460.46209335327 ms
2022-09-24 22:14:04 INFO  Done!
2022-09-24 22:14:04 INFO  # Finished -- repetition 7 of 7 
2022-09-24 22:14:04 INFO  # Final results after all repetitions
2022-09-24 22:14:04 INFO     repetition  ... no_opt_what_if_execution_combined_model_training
0           0  ...                                     16070.780516
1           1  ...                                     16951.701403
2           2  ...                                     17983.195305
3           3  ...                                     17226.868868
4           4  ...                                     16881.888866
5           5  ...                                     17733.195543
6           6  ...                                     16851.930857

[7 rows x 26 columns]
PROTOCOL_BUFFERS_PYTHON_IMPLEMENTATION=python taskset -c 32-39 python3.9 benchmarks_end_to_end.py feature_importance reviews fast_loading featurization_2 logistic_regression
2022-09-24 22:14:06.792404: W tensorflow/stream_executor/platform/default/dso_loader.cc:64] Could not load dynamic library 'libcudart.so.11.0'; dlerror: libcudart.so.11.0: cannot open shared object file: No such file or directory; LD_LIBRARY_PATH: /home/sgrafbe/mlwhatif/venv/lib/python3.9/site-packages/cv2/../../lib64:
2022-09-24 22:14:06.792447: I tensorflow/stream_executor/cuda/cudart_stub.cc:29] Ignore above cudart dlerror if you do not have a GPU set up on your machine.
2022-09-24 22:14:08 INFO  Patching sys.argv with ['mlwhatif', 'reviews', 'fast_loading', 'featurization_2', 'logistic_regression']
2022-09-24 22:14:08 INFO  Running instrumented original pipeline...
2022-09-24 22:14:08 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-24 22:14:08 INFO  ---RUNTIME: Importing and monkey-patching took 131.3037872314453 ms
2022-09-24 22:14:14 INFO  ---RUNTIME: Original pipeline execution took 6214.552640914917 ms (excluding imports and monkey-patching)
2022-09-24 22:14:14 INFO  Starting execution of 0 what-if analyses...
2022-09-24 22:14:14 INFO  Estimated runtime of original DAG is 5863.5094165802ms
2022-09-24 22:14:14 INFO  Performing Multi-Query Optimization
2022-09-24 22:14:14 INFO  Estimated unoptimized what-if runtime is 0ms
2022-09-24 22:14:14 INFO  Estimated optimised what-if runtime is 0ms
2022-09-24 22:14:14 INFO  Estimated optimisation runtime saving is 0ms
2022-09-24 22:14:14 INFO  ---RUNTIME: Multi-Query Optimization took 0.6451606750488281 ms
2022-09-24 22:14:14 INFO  Executing generated plans
2022-09-24 22:14:14 INFO  ---RUNTIME: Execution took 0.0286102294921875 ms
2022-09-24 22:14:14 INFO  Done!
2022-09-24 22:14:14 INFO  # Optimization benchmark for feature_importance with args [['reviews', 'fast_loading', 'featurization_2', 'logistic_regression']] -- repetition 1 of 7
2022-09-24 22:14:14 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-24 22:14:14 INFO  Running instrumented original pipeline...
2022-09-24 22:14:14 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-24 22:14:14 INFO  ---RUNTIME: Importing and monkey-patching took 6.213665008544922 ms
2022-09-24 22:14:20 INFO  ---RUNTIME: Original pipeline execution took 6402.379512786865 ms (excluding imports and monkey-patching)
2022-09-24 22:14:20 INFO  Starting execution of 1 what-if analyses...
2022-09-24 22:14:20 INFO  Start plan generation for analysis PermutationFeatureImportance...
2022-09-24 22:14:20 INFO  ---RUNTIME: Plan generation took 0.2665519714355469 ms
2022-09-24 22:14:20 INFO  Estimated runtime of original DAG is 5910.32075881958ms
2022-09-24 22:14:20 INFO  Performing Multi-Query Optimization
2022-09-24 22:14:20 INFO  Estimated unoptimized what-if runtime is 29551.6037940979ms
2022-09-24 22:14:20 INFO  Estimated optimised what-if runtime is 7665.545225143433ms
2022-09-24 22:14:20 INFO  Estimated optimisation runtime saving is 21886.058568954468ms
2022-09-24 22:14:20 INFO  ---RUNTIME: Multi-Query Optimization took 11.385679244995117 ms
2022-09-24 22:14:20 INFO  Executing generated plans
2022-09-24 22:14:28 INFO  ---RUNTIME: Execution took 7465.281248092651 ms
2022-09-24 22:14:28 INFO  Done!
2022-09-24 22:14:28 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-24 22:14:28 INFO  Running instrumented original pipeline...
2022-09-24 22:14:28 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-24 22:14:28 INFO  ---RUNTIME: Importing and monkey-patching took 6.487131118774414 ms
2022-09-24 22:14:34 INFO  ---RUNTIME: Original pipeline execution took 6018.285751342773 ms (excluding imports and monkey-patching)
2022-09-24 22:14:34 INFO  Starting execution of 1 what-if analyses...
2022-09-24 22:14:34 INFO  Start plan generation for analysis PermutationFeatureImportance...
2022-09-24 22:14:34 INFO  ---RUNTIME: Plan generation took 0.1277923583984375 ms
2022-09-24 22:14:34 INFO  Estimated runtime of original DAG is 5693.283319473267ms
2022-09-24 22:14:34 WARNING Skipping Multi-Query Optimization (instead, only applying patches)
2022-09-24 22:14:34 INFO  Estimated unoptimised what-if runtime is 28466.416597366333ms
2022-09-24 22:14:34 INFO  ---RUNTIME: Multi-Query Optimization took 4.194974899291992 ms
2022-09-24 22:14:34 INFO  Executing generated plans
2022-09-24 22:15:03 INFO  ---RUNTIME: Execution took 28604.092597961426 ms
2022-09-24 22:15:03 INFO  Done!
2022-09-24 22:15:03 INFO  # Finished -- repetition 1 of 7 
2022-09-24 22:15:03 INFO  # Optimization benchmark for feature_importance with args [['reviews', 'fast_loading', 'featurization_2', 'logistic_regression']] -- repetition 2 of 7
2022-09-24 22:15:03 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-24 22:15:03 INFO  Running instrumented original pipeline...
2022-09-24 22:15:03 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-24 22:15:03 INFO  ---RUNTIME: Importing and monkey-patching took 6.3037872314453125 ms
2022-09-24 22:15:09 INFO  ---RUNTIME: Original pipeline execution took 6041.959047317505 ms (excluding imports and monkey-patching)
2022-09-24 22:15:09 INFO  Starting execution of 1 what-if analyses...
2022-09-24 22:15:09 INFO  Start plan generation for analysis PermutationFeatureImportance...
2022-09-24 22:15:09 INFO  ---RUNTIME: Plan generation took 0.13399124145507812 ms
2022-09-24 22:15:09 INFO  Estimated runtime of original DAG is 5731.574296951294ms
2022-09-24 22:15:09 INFO  Performing Multi-Query Optimization
2022-09-24 22:15:09 INFO  Estimated unoptimized what-if runtime is 28657.87148475647ms
2022-09-24 22:15:09 INFO  Estimated optimised what-if runtime is 7399.317979812622ms
2022-09-24 22:15:09 INFO  Estimated optimisation runtime saving is 21258.553504943848ms
2022-09-24 22:15:09 INFO  ---RUNTIME: Multi-Query Optimization took 10.668754577636719 ms
2022-09-24 22:15:09 INFO  Executing generated plans
2022-09-24 22:15:16 INFO  ---RUNTIME: Execution took 7399.240493774414 ms
2022-09-24 22:15:16 INFO  Done!
2022-09-24 22:15:16 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-24 22:15:16 INFO  Running instrumented original pipeline...
2022-09-24 22:15:16 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-24 22:15:16 INFO  ---RUNTIME: Importing and monkey-patching took 6.031990051269531 ms
2022-09-24 22:15:22 INFO  ---RUNTIME: Original pipeline execution took 5926.812410354614 ms (excluding imports and monkey-patching)
2022-09-24 22:15:22 INFO  Starting execution of 1 what-if analyses...
2022-09-24 22:15:22 INFO  Start plan generation for analysis PermutationFeatureImportance...
2022-09-24 22:15:22 INFO  ---RUNTIME: Plan generation took 0.14519691467285156 ms
2022-09-24 22:15:22 INFO  Estimated runtime of original DAG is 5620.805978775024ms
2022-09-24 22:15:22 WARNING Skipping Multi-Query Optimization (instead, only applying patches)
2022-09-24 22:15:22 INFO  Estimated unoptimised what-if runtime is 28104.029893875122ms
2022-09-24 22:15:22 INFO  ---RUNTIME: Multi-Query Optimization took 4.956960678100586 ms
2022-09-24 22:15:22 INFO  Executing generated plans
2022-09-24 22:15:51 INFO  ---RUNTIME: Execution took 28856.865644454956 ms
2022-09-24 22:15:51 INFO  Done!
2022-09-24 22:15:51 INFO  # Finished -- repetition 2 of 7 
2022-09-24 22:15:51 INFO  # Optimization benchmark for feature_importance with args [['reviews', 'fast_loading', 'featurization_2', 'logistic_regression']] -- repetition 3 of 7
2022-09-24 22:15:51 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-24 22:15:51 INFO  Running instrumented original pipeline...
2022-09-24 22:15:51 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-24 22:15:51 INFO  ---RUNTIME: Importing and monkey-patching took 6.045103073120117 ms
2022-09-24 22:15:57 INFO  ---RUNTIME: Original pipeline execution took 6083.6896896362305 ms (excluding imports and monkey-patching)
2022-09-24 22:15:57 INFO  Starting execution of 1 what-if analyses...
2022-09-24 22:15:57 INFO  Start plan generation for analysis PermutationFeatureImportance...
2022-09-24 22:15:57 INFO  ---RUNTIME: Plan generation took 0.13208389282226562 ms
2022-09-24 22:15:57 INFO  Estimated runtime of original DAG is 5771.576881408691ms
2022-09-24 22:15:57 INFO  Performing Multi-Query Optimization
2022-09-24 22:15:57 INFO  Estimated unoptimized what-if runtime is 28857.884407043457ms
2022-09-24 22:15:57 INFO  Estimated optimised what-if runtime is 7396.889209747314ms
2022-09-24 22:15:57 INFO  Estimated optimisation runtime saving is 21460.995197296143ms
2022-09-24 22:15:57 INFO  ---RUNTIME: Multi-Query Optimization took 10.817527770996094 ms
2022-09-24 22:15:57 INFO  Executing generated plans
2022-09-24 22:16:04 INFO  ---RUNTIME: Execution took 7465.852975845337 ms
2022-09-24 22:16:04 INFO  Done!
2022-09-24 22:16:04 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-24 22:16:04 INFO  Running instrumented original pipeline...
2022-09-24 22:16:04 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-24 22:16:04 INFO  ---RUNTIME: Importing and monkey-patching took 5.809783935546875 ms
2022-09-24 22:16:10 INFO  ---RUNTIME: Original pipeline execution took 5925.305604934692 ms (excluding imports and monkey-patching)
2022-09-24 22:16:10 INFO  Starting execution of 1 what-if analyses...
2022-09-24 22:16:10 INFO  Start plan generation for analysis PermutationFeatureImportance...
2022-09-24 22:16:10 INFO  ---RUNTIME: Plan generation took 0.11610984802246094 ms
2022-09-24 22:16:10 INFO  Estimated runtime of original DAG is 5620.2239990234375ms
2022-09-24 22:16:10 WARNING Skipping Multi-Query Optimization (instead, only applying patches)
2022-09-24 22:16:10 INFO  Estimated unoptimised what-if runtime is 28101.119995117188ms
2022-09-24 22:16:10 INFO  ---RUNTIME: Multi-Query Optimization took 4.670619964599609 ms
2022-09-24 22:16:10 INFO  Executing generated plans
2022-09-24 22:16:39 INFO  ---RUNTIME: Execution took 28761.8567943573 ms
2022-09-24 22:16:39 INFO  Done!
2022-09-24 22:16:39 INFO  # Finished -- repetition 3 of 7 
2022-09-24 22:16:39 INFO  # Optimization benchmark for feature_importance with args [['reviews', 'fast_loading', 'featurization_2', 'logistic_regression']] -- repetition 4 of 7
2022-09-24 22:16:39 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-24 22:16:39 INFO  Running instrumented original pipeline...
2022-09-24 22:16:39 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-24 22:16:39 INFO  ---RUNTIME: Importing and monkey-patching took 6.868600845336914 ms
2022-09-24 22:16:45 INFO  ---RUNTIME: Original pipeline execution took 5888.880252838135 ms (excluding imports and monkey-patching)
2022-09-24 22:16:45 INFO  Starting execution of 1 what-if analyses...
2022-09-24 22:16:45 INFO  Start plan generation for analysis PermutationFeatureImportance...
2022-09-24 22:16:45 INFO  ---RUNTIME: Plan generation took 0.12135505676269531 ms
2022-09-24 22:16:45 INFO  Estimated runtime of original DAG is 5577.605485916138ms
2022-09-24 22:16:45 INFO  Performing Multi-Query Optimization
2022-09-24 22:16:45 INFO  Estimated unoptimized what-if runtime is 27888.02742958069ms
2022-09-24 22:16:45 INFO  Estimated optimised what-if runtime is 7242.2215938568115ms
2022-09-24 22:16:45 INFO  Estimated optimisation runtime saving is 20645.805835723877ms
2022-09-24 22:16:45 INFO  ---RUNTIME: Multi-Query Optimization took 11.488199234008789 ms
2022-09-24 22:16:45 INFO  Executing generated plans
2022-09-24 22:16:52 INFO  ---RUNTIME: Execution took 7426.950216293335 ms
2022-09-24 22:16:52 INFO  Done!
2022-09-24 22:16:52 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-24 22:16:52 INFO  Running instrumented original pipeline...
2022-09-24 22:16:53 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-24 22:16:53 INFO  ---RUNTIME: Importing and monkey-patching took 6.681680679321289 ms
2022-09-24 22:16:59 INFO  ---RUNTIME: Original pipeline execution took 6160.998344421387 ms (excluding imports and monkey-patching)
2022-09-24 22:16:59 INFO  Starting execution of 1 what-if analyses...
2022-09-24 22:16:59 INFO  Start plan generation for analysis PermutationFeatureImportance...
2022-09-24 22:16:59 INFO  ---RUNTIME: Plan generation took 0.10156631469726562 ms
2022-09-24 22:16:59 INFO  Estimated runtime of original DAG is 5642.461538314819ms
2022-09-24 22:16:59 WARNING Skipping Multi-Query Optimization (instead, only applying patches)
2022-09-24 22:16:59 INFO  Estimated unoptimised what-if runtime is 28212.307691574097ms
2022-09-24 22:16:59 INFO  ---RUNTIME: Multi-Query Optimization took 4.063129425048828 ms
2022-09-24 22:16:59 INFO  Executing generated plans
2022-09-24 22:17:28 INFO  ---RUNTIME: Execution took 29210.872888565063 ms
2022-09-24 22:17:28 INFO  Done!
2022-09-24 22:17:28 INFO  # Finished -- repetition 4 of 7 
2022-09-24 22:17:28 INFO  # Optimization benchmark for feature_importance with args [['reviews', 'fast_loading', 'featurization_2', 'logistic_regression']] -- repetition 5 of 7
2022-09-24 22:17:28 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-24 22:17:28 INFO  Running instrumented original pipeline...
2022-09-24 22:17:28 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-24 22:17:28 INFO  ---RUNTIME: Importing and monkey-patching took 6.612062454223633 ms
2022-09-24 22:17:34 INFO  ---RUNTIME: Original pipeline execution took 6006.993532180786 ms (excluding imports and monkey-patching)
2022-09-24 22:17:34 INFO  Starting execution of 1 what-if analyses...
2022-09-24 22:17:34 INFO  Start plan generation for analysis PermutationFeatureImportance...
2022-09-24 22:17:34 INFO  ---RUNTIME: Plan generation took 0.11515617370605469 ms
2022-09-24 22:17:34 INFO  Estimated runtime of original DAG is 5702.139377593994ms
2022-09-24 22:17:34 INFO  Performing Multi-Query Optimization
2022-09-24 22:17:34 INFO  Estimated unoptimized what-if runtime is 28510.69688796997ms
2022-09-24 22:17:34 INFO  Estimated optimised what-if runtime is 7401.5161991119385ms
2022-09-24 22:17:34 INFO  Estimated optimisation runtime saving is 21109.180688858032ms
2022-09-24 22:17:34 INFO  ---RUNTIME: Multi-Query Optimization took 10.559797286987305 ms
2022-09-24 22:17:34 INFO  Executing generated plans
2022-09-24 22:17:41 INFO  ---RUNTIME: Execution took 7356.9817543029785 ms
2022-09-24 22:17:41 INFO  Done!
2022-09-24 22:17:41 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-24 22:17:41 INFO  Running instrumented original pipeline...
2022-09-24 22:17:41 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-24 22:17:41 INFO  ---RUNTIME: Importing and monkey-patching took 6.367921829223633 ms
2022-09-24 22:17:47 INFO  ---RUNTIME: Original pipeline execution took 5971.001386642456 ms (excluding imports and monkey-patching)
2022-09-24 22:17:47 INFO  Starting execution of 1 what-if analyses...
2022-09-24 22:17:47 INFO  Start plan generation for analysis PermutationFeatureImportance...
2022-09-24 22:17:47 INFO  ---RUNTIME: Plan generation took 0.11157989501953125 ms
2022-09-24 22:17:47 INFO  Estimated runtime of original DAG is 5661.82017326355ms
2022-09-24 22:17:47 WARNING Skipping Multi-Query Optimization (instead, only applying patches)
2022-09-24 22:17:47 INFO  Estimated unoptimised what-if runtime is 28309.10086631775ms
2022-09-24 22:17:47 INFO  ---RUNTIME: Multi-Query Optimization took 4.081964492797852 ms
2022-09-24 22:17:47 INFO  Executing generated plans
2022-09-24 22:18:16 INFO  ---RUNTIME: Execution took 28635.169982910156 ms
2022-09-24 22:18:16 INFO  Done!
2022-09-24 22:18:16 INFO  # Finished -- repetition 5 of 7 
2022-09-24 22:18:16 INFO  # Optimization benchmark for feature_importance with args [['reviews', 'fast_loading', 'featurization_2', 'logistic_regression']] -- repetition 6 of 7
2022-09-24 22:18:16 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-24 22:18:16 INFO  Running instrumented original pipeline...
2022-09-24 22:18:16 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-24 22:18:16 INFO  ---RUNTIME: Importing and monkey-patching took 7.034540176391602 ms
2022-09-24 22:18:22 INFO  ---RUNTIME: Original pipeline execution took 6020.2836990356445 ms (excluding imports and monkey-patching)
2022-09-24 22:18:22 INFO  Starting execution of 1 what-if analyses...
2022-09-24 22:18:22 INFO  Start plan generation for analysis PermutationFeatureImportance...
2022-09-24 22:18:22 INFO  ---RUNTIME: Plan generation took 0.12111663818359375 ms
2022-09-24 22:18:22 INFO  Estimated runtime of original DAG is 5699.294567108154ms
2022-09-24 22:18:22 INFO  Performing Multi-Query Optimization
2022-09-24 22:18:22 INFO  Estimated unoptimized what-if runtime is 28496.47283554077ms
2022-09-24 22:18:22 INFO  Estimated optimised what-if runtime is 7325.183629989624ms
2022-09-24 22:18:22 INFO  Estimated optimisation runtime saving is 21171.289205551147ms
2022-09-24 22:18:22 INFO  ---RUNTIME: Multi-Query Optimization took 10.657548904418945 ms
2022-09-24 22:18:22 INFO  Executing generated plans
2022-09-24 22:18:29 INFO  ---RUNTIME: Execution took 7217.731475830078 ms
2022-09-24 22:18:29 INFO  Done!
2022-09-24 22:18:29 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-24 22:18:29 INFO  Running instrumented original pipeline...
2022-09-24 22:18:29 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-24 22:18:29 INFO  ---RUNTIME: Importing and monkey-patching took 5.978584289550781 ms
2022-09-24 22:18:35 INFO  ---RUNTIME: Original pipeline execution took 5824.663162231445 ms (excluding imports and monkey-patching)
2022-09-24 22:18:35 INFO  Starting execution of 1 what-if analyses...
2022-09-24 22:18:35 INFO  Start plan generation for analysis PermutationFeatureImportance...
2022-09-24 22:18:35 INFO  ---RUNTIME: Plan generation took 0.10371208190917969 ms
2022-09-24 22:18:35 INFO  Estimated runtime of original DAG is 5517.98677444458ms
2022-09-24 22:18:35 WARNING Skipping Multi-Query Optimization (instead, only applying patches)
2022-09-24 22:18:35 INFO  Estimated unoptimised what-if runtime is 27589.9338722229ms
2022-09-24 22:18:35 INFO  ---RUNTIME: Multi-Query Optimization took 4.126787185668945 ms
2022-09-24 22:18:35 INFO  Executing generated plans
2022-09-24 22:19:03 INFO  ---RUNTIME: Execution took 27950.605392456055 ms
2022-09-24 22:19:03 INFO  Done!
2022-09-24 22:19:03 INFO  # Finished -- repetition 6 of 7 
2022-09-24 22:19:03 INFO  # Optimization benchmark for feature_importance with args [['reviews', 'fast_loading', 'featurization_2', 'logistic_regression']] -- repetition 7 of 7
2022-09-24 22:19:03 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-24 22:19:03 INFO  Running instrumented original pipeline...
2022-09-24 22:19:03 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-24 22:19:03 INFO  ---RUNTIME: Importing and monkey-patching took 7.762670516967773 ms
2022-09-24 22:19:09 INFO  ---RUNTIME: Original pipeline execution took 5831.047534942627 ms (excluding imports and monkey-patching)
2022-09-24 22:19:09 INFO  Starting execution of 1 what-if analyses...
2022-09-24 22:19:09 INFO  Start plan generation for analysis PermutationFeatureImportance...
2022-09-24 22:19:09 INFO  ---RUNTIME: Plan generation took 0.1323223114013672 ms
2022-09-24 22:19:09 INFO  Estimated runtime of original DAG is 5523.831129074097ms
2022-09-24 22:19:09 INFO  Performing Multi-Query Optimization
2022-09-24 22:19:09 INFO  Estimated unoptimized what-if runtime is 27619.155645370483ms
2022-09-24 22:19:09 INFO  Estimated optimised what-if runtime is 7153.269290924072ms
2022-09-24 22:19:09 INFO  Estimated optimisation runtime saving is 20465.88635444641ms
2022-09-24 22:19:09 INFO  ---RUNTIME: Multi-Query Optimization took 10.859966278076172 ms
2022-09-24 22:19:09 INFO  Executing generated plans
2022-09-24 22:19:16 INFO  ---RUNTIME: Execution took 7222.11766242981 ms
2022-09-24 22:19:16 INFO  Done!
2022-09-24 22:19:16 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-24 22:19:16 INFO  Running instrumented original pipeline...
2022-09-24 22:19:16 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-24 22:19:16 INFO  ---RUNTIME: Importing and monkey-patching took 5.96165657043457 ms
2022-09-24 22:19:22 INFO  ---RUNTIME: Original pipeline execution took 5834.162950515747 ms (excluding imports and monkey-patching)
2022-09-24 22:19:22 INFO  Starting execution of 1 what-if analyses...
2022-09-24 22:19:22 INFO  Start plan generation for analysis PermutationFeatureImportance...
2022-09-24 22:19:22 INFO  ---RUNTIME: Plan generation took 0.110626220703125 ms
2022-09-24 22:19:22 INFO  Estimated runtime of original DAG is 5526.617527008057ms
2022-09-24 22:19:22 WARNING Skipping Multi-Query Optimization (instead, only applying patches)
2022-09-24 22:19:22 INFO  Estimated unoptimised what-if runtime is 27633.087635040283ms
2022-09-24 22:19:22 INFO  ---RUNTIME: Multi-Query Optimization took 4.164934158325195 ms
2022-09-24 22:19:22 INFO  Executing generated plans
2022-09-24 22:19:50 INFO  ---RUNTIME: Execution took 27914.076328277588 ms
2022-09-24 22:19:50 INFO  Done!
2022-09-24 22:19:50 INFO  # Finished -- repetition 7 of 7 
2022-09-24 22:19:50 INFO  # Final results after all repetitions
2022-09-24 22:19:50 INFO     repetition  ... no_opt_what_if_execution_combined_model_training
0           0  ...                                       543.704033
1           1  ...                                       536.337614
2           2  ...                                       525.851250
3           3  ...                                       541.849613
4           4  ...                                       551.950455
5           5  ...                                       493.457317
6           6  ...                                       490.813732

[7 rows x 26 columns]
PROTOCOL_BUFFERS_PYTHON_IMPLEMENTATION=python taskset -c 32-39 python3.9 benchmarks_end_to_end.py feature_importance reviews fast_loading featurization_2 xgboost
2022-09-24 22:19:52.624155: W tensorflow/stream_executor/platform/default/dso_loader.cc:64] Could not load dynamic library 'libcudart.so.11.0'; dlerror: libcudart.so.11.0: cannot open shared object file: No such file or directory; LD_LIBRARY_PATH: /home/sgrafbe/mlwhatif/venv/lib/python3.9/site-packages/cv2/../../lib64:
2022-09-24 22:19:52.624201: I tensorflow/stream_executor/cuda/cudart_stub.cc:29] Ignore above cudart dlerror if you do not have a GPU set up on your machine.
2022-09-24 22:19:53 INFO  Patching sys.argv with ['mlwhatif', 'reviews', 'fast_loading', 'featurization_2', 'xgboost']
2022-09-24 22:19:53 INFO  Running instrumented original pipeline...
2022-09-24 22:19:53 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-24 22:19:54 INFO  ---RUNTIME: Importing and monkey-patching took 123.66032600402832 ms
2022-09-24 22:20:34 INFO  ---RUNTIME: Original pipeline execution took 40136.77358627319 ms (excluding imports and monkey-patching)
2022-09-24 22:20:34 INFO  Starting execution of 0 what-if analyses...
2022-09-24 22:20:34 INFO  Estimated runtime of original DAG is 39792.07706451416ms
2022-09-24 22:20:34 INFO  Performing Multi-Query Optimization
2022-09-24 22:20:34 INFO  Estimated unoptimized what-if runtime is 0ms
2022-09-24 22:20:34 INFO  Estimated optimised what-if runtime is 0ms
2022-09-24 22:20:34 INFO  Estimated optimisation runtime saving is 0ms
2022-09-24 22:20:34 INFO  ---RUNTIME: Multi-Query Optimization took 0.5269050598144531 ms
2022-09-24 22:20:34 INFO  Executing generated plans
2022-09-24 22:20:34 INFO  ---RUNTIME: Execution took 0.027179718017578125 ms
2022-09-24 22:20:34 INFO  Done!
2022-09-24 22:20:34 INFO  # Optimization benchmark for feature_importance with args [['reviews', 'fast_loading', 'featurization_2', 'xgboost']] -- repetition 1 of 7
2022-09-24 22:20:34 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-24 22:20:34 INFO  Running instrumented original pipeline...
2022-09-24 22:20:34 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-24 22:20:34 INFO  ---RUNTIME: Importing and monkey-patching took 6.117105484008789 ms
2022-09-24 22:21:14 INFO  ---RUNTIME: Original pipeline execution took 40214.32876586914 ms (excluding imports and monkey-patching)
2022-09-24 22:21:14 INFO  Starting execution of 1 what-if analyses...
2022-09-24 22:21:14 INFO  Start plan generation for analysis PermutationFeatureImportance...
2022-09-24 22:21:14 INFO  ---RUNTIME: Plan generation took 0.2167224884033203 ms
2022-09-24 22:21:14 INFO  Estimated runtime of original DAG is 39748.39401245117ms
2022-09-24 22:21:14 INFO  Performing Multi-Query Optimization
2022-09-24 22:21:14 INFO  Estimated unoptimized what-if runtime is 198741.97006225586ms
2022-09-24 22:21:14 INFO  Estimated optimised what-if runtime is 42701.69973373413ms
2022-09-24 22:21:14 INFO  Estimated optimisation runtime saving is 156040.27032852173ms
2022-09-24 22:21:14 INFO  ---RUNTIME: Multi-Query Optimization took 10.746479034423828 ms
2022-09-24 22:21:14 INFO  Executing generated plans
2022-09-24 22:21:57 INFO  ---RUNTIME: Execution took 42736.22131347656 ms
2022-09-24 22:21:57 INFO  Done!
2022-09-24 22:21:57 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-24 22:21:57 INFO  Running instrumented original pipeline...
2022-09-24 22:21:57 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-24 22:21:57 INFO  ---RUNTIME: Importing and monkey-patching took 6.686925888061523 ms
2022-09-24 22:22:37 INFO  ---RUNTIME: Original pipeline execution took 40023.87976646423 ms (excluding imports and monkey-patching)
2022-09-24 22:22:37 INFO  Starting execution of 1 what-if analyses...
2022-09-24 22:22:37 INFO  Start plan generation for analysis PermutationFeatureImportance...
2022-09-24 22:22:37 INFO  ---RUNTIME: Plan generation took 0.1442432403564453 ms
2022-09-24 22:22:37 INFO  Estimated runtime of original DAG is 39715.235471725464ms
2022-09-24 22:22:37 WARNING Skipping Multi-Query Optimization (instead, only applying patches)
2022-09-24 22:22:37 INFO  Estimated unoptimised what-if runtime is 198576.17735862732ms
2022-09-24 22:22:37 INFO  ---RUNTIME: Multi-Query Optimization took 4.343748092651367 ms
2022-09-24 22:22:37 INFO  Executing generated plans
2022-09-24 22:25:56 INFO  ---RUNTIME: Execution took 198891.24131202698 ms
2022-09-24 22:25:56 INFO  Done!
2022-09-24 22:25:56 INFO  # Finished -- repetition 1 of 7 
2022-09-24 22:25:56 INFO  # Optimization benchmark for feature_importance with args [['reviews', 'fast_loading', 'featurization_2', 'xgboost']] -- repetition 2 of 7
2022-09-24 22:25:56 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-24 22:25:56 INFO  Running instrumented original pipeline...
2022-09-24 22:25:56 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-24 22:25:56 INFO  ---RUNTIME: Importing and monkey-patching took 6.49261474609375 ms
2022-09-24 22:26:36 INFO  ---RUNTIME: Original pipeline execution took 40082.93652534485 ms (excluding imports and monkey-patching)
2022-09-24 22:26:36 INFO  Starting execution of 1 what-if analyses...
2022-09-24 22:26:36 INFO  Start plan generation for analysis PermutationFeatureImportance...
2022-09-24 22:26:36 INFO  ---RUNTIME: Plan generation took 0.14662742614746094 ms
2022-09-24 22:26:36 INFO  Estimated runtime of original DAG is 39778.74445915222ms
2022-09-24 22:26:36 INFO  Performing Multi-Query Optimization
2022-09-24 22:26:36 INFO  Estimated unoptimized what-if runtime is 198893.7222957611ms
2022-09-24 22:26:36 INFO  Estimated optimised what-if runtime is 42767.462968826294ms
2022-09-24 22:26:36 INFO  Estimated optimisation runtime saving is 156126.2593269348ms
2022-09-24 22:26:36 INFO  ---RUNTIME: Multi-Query Optimization took 10.959625244140625 ms
2022-09-24 22:26:36 INFO  Executing generated plans
2022-09-24 22:27:19 INFO  ---RUNTIME: Execution took 42917.86861419678 ms
2022-09-24 22:27:19 INFO  Done!
2022-09-24 22:27:19 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-24 22:27:19 INFO  Running instrumented original pipeline...
2022-09-24 22:27:19 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-24 22:27:19 INFO  ---RUNTIME: Importing and monkey-patching took 6.352663040161133 ms
2022-09-24 22:27:59 INFO  ---RUNTIME: Original pipeline execution took 40213.60397338867 ms (excluding imports and monkey-patching)
2022-09-24 22:27:59 INFO  Starting execution of 1 what-if analyses...
2022-09-24 22:27:59 INFO  Start plan generation for analysis PermutationFeatureImportance...
2022-09-24 22:27:59 INFO  ---RUNTIME: Plan generation took 0.12755393981933594 ms
2022-09-24 22:27:59 INFO  Estimated runtime of original DAG is 39899.00779724121ms
2022-09-24 22:27:59 WARNING Skipping Multi-Query Optimization (instead, only applying patches)
2022-09-24 22:27:59 INFO  Estimated unoptimised what-if runtime is 199495.03898620605ms
2022-09-24 22:27:59 INFO  ---RUNTIME: Multi-Query Optimization took 4.264593124389648 ms
2022-09-24 22:27:59 INFO  Executing generated plans
2022-09-24 22:31:19 INFO  ---RUNTIME: Execution took 199655.85827827454 ms
2022-09-24 22:31:19 INFO  Done!
2022-09-24 22:31:19 INFO  # Finished -- repetition 2 of 7 
2022-09-24 22:31:19 INFO  # Optimization benchmark for feature_importance with args [['reviews', 'fast_loading', 'featurization_2', 'xgboost']] -- repetition 3 of 7
2022-09-24 22:31:19 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-24 22:31:19 INFO  Running instrumented original pipeline...
2022-09-24 22:31:19 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-24 22:31:19 INFO  ---RUNTIME: Importing and monkey-patching took 6.2961578369140625 ms
2022-09-24 22:31:59 INFO  ---RUNTIME: Original pipeline execution took 40190.242528915405 ms (excluding imports and monkey-patching)
2022-09-24 22:31:59 INFO  Starting execution of 1 what-if analyses...
2022-09-24 22:31:59 INFO  Start plan generation for analysis PermutationFeatureImportance...
2022-09-24 22:31:59 INFO  ---RUNTIME: Plan generation took 0.1430511474609375 ms
2022-09-24 22:31:59 INFO  Estimated runtime of original DAG is 39879.49013710022ms
2022-09-24 22:31:59 INFO  Performing Multi-Query Optimization
2022-09-24 22:31:59 INFO  Estimated unoptimized what-if runtime is 199397.4506855011ms
2022-09-24 22:31:59 INFO  Estimated optimised what-if runtime is 42824.52440261841ms
2022-09-24 22:31:59 INFO  Estimated optimisation runtime saving is 156572.9262828827ms
2022-09-24 22:31:59 INFO  ---RUNTIME: Multi-Query Optimization took 11.160850524902344 ms
2022-09-24 22:31:59 INFO  Executing generated plans
2022-09-24 22:32:42 INFO  ---RUNTIME: Execution took 42810.24765968323 ms
2022-09-24 22:32:42 INFO  Done!
2022-09-24 22:32:42 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-24 22:32:42 INFO  Running instrumented original pipeline...
2022-09-24 22:32:42 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-24 22:32:42 INFO  ---RUNTIME: Importing and monkey-patching took 6.287813186645508 ms
2022-09-24 22:33:22 INFO  ---RUNTIME: Original pipeline execution took 40168.66493225098 ms (excluding imports and monkey-patching)
2022-09-24 22:33:22 INFO  Starting execution of 1 what-if analyses...
2022-09-24 22:33:22 INFO  Start plan generation for analysis PermutationFeatureImportance...
2022-09-24 22:33:22 INFO  ---RUNTIME: Plan generation took 0.13184547424316406 ms
2022-09-24 22:33:22 INFO  Estimated runtime of original DAG is 39860.416650772095ms
2022-09-24 22:33:22 WARNING Skipping Multi-Query Optimization (instead, only applying patches)
2022-09-24 22:33:22 INFO  Estimated unoptimised what-if runtime is 199302.08325386047ms
2022-09-24 22:33:22 INFO  ---RUNTIME: Multi-Query Optimization took 4.148244857788086 ms
2022-09-24 22:33:22 INFO  Executing generated plans
2022-09-24 22:36:41 INFO  ---RUNTIME: Execution took 199565.99974632263 ms
2022-09-24 22:36:41 INFO  Done!
2022-09-24 22:36:41 INFO  # Finished -- repetition 3 of 7 
2022-09-24 22:36:41 INFO  # Optimization benchmark for feature_importance with args [['reviews', 'fast_loading', 'featurization_2', 'xgboost']] -- repetition 4 of 7
2022-09-24 22:36:41 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-24 22:36:41 INFO  Running instrumented original pipeline...
2022-09-24 22:36:41 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-24 22:36:41 INFO  ---RUNTIME: Importing and monkey-patching took 6.447792053222656 ms
2022-09-24 22:37:21 INFO  ---RUNTIME: Original pipeline execution took 40121.49381637573 ms (excluding imports and monkey-patching)
2022-09-24 22:37:21 INFO  Starting execution of 1 what-if analyses...
2022-09-24 22:37:21 INFO  Start plan generation for analysis PermutationFeatureImportance...
2022-09-24 22:37:21 INFO  ---RUNTIME: Plan generation took 0.12612342834472656 ms
2022-09-24 22:37:21 INFO  Estimated runtime of original DAG is 39806.60033226013ms
2022-09-24 22:37:21 INFO  Performing Multi-Query Optimization
2022-09-24 22:37:21 INFO  Estimated unoptimized what-if runtime is 199033.00166130066ms
2022-09-24 22:37:21 INFO  Estimated optimised what-if runtime is 42740.68760871887ms
2022-09-24 22:37:21 INFO  Estimated optimisation runtime saving is 156292.3140525818ms
2022-09-24 22:37:21 INFO  ---RUNTIME: Multi-Query Optimization took 10.490894317626953 ms
2022-09-24 22:37:21 INFO  Executing generated plans
2022-09-24 22:38:04 INFO  ---RUNTIME: Execution took 43003.477334976196 ms
2022-09-24 22:38:04 INFO  Done!
2022-09-24 22:38:04 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-24 22:38:05 INFO  Running instrumented original pipeline...
2022-09-24 22:38:05 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-24 22:38:05 INFO  ---RUNTIME: Importing and monkey-patching took 6.210565567016602 ms
2022-09-24 22:38:45 INFO  ---RUNTIME: Original pipeline execution took 40185.93645095825 ms (excluding imports and monkey-patching)
2022-09-24 22:38:45 INFO  Starting execution of 1 what-if analyses...
2022-09-24 22:38:45 INFO  Start plan generation for analysis PermutationFeatureImportance...
2022-09-24 22:38:45 INFO  ---RUNTIME: Plan generation took 0.12040138244628906 ms
2022-09-24 22:38:45 INFO  Estimated runtime of original DAG is 39877.864599227905ms
2022-09-24 22:38:45 WARNING Skipping Multi-Query Optimization (instead, only applying patches)
2022-09-24 22:38:45 INFO  Estimated unoptimised what-if runtime is 199389.32299613953ms
2022-09-24 22:38:45 INFO  ---RUNTIME: Multi-Query Optimization took 4.200220108032227 ms
2022-09-24 22:38:45 INFO  Executing generated plans
2022-09-24 22:42:04 INFO  ---RUNTIME: Execution took 199558.93635749817 ms
2022-09-24 22:42:04 INFO  Done!
2022-09-24 22:42:04 INFO  # Finished -- repetition 4 of 7 
2022-09-24 22:42:04 INFO  # Optimization benchmark for feature_importance with args [['reviews', 'fast_loading', 'featurization_2', 'xgboost']] -- repetition 5 of 7
2022-09-24 22:42:04 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-24 22:42:04 INFO  Running instrumented original pipeline...
2022-09-24 22:42:04 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-24 22:42:04 INFO  ---RUNTIME: Importing and monkey-patching took 6.269216537475586 ms
2022-09-24 22:42:44 INFO  ---RUNTIME: Original pipeline execution took 40095.80874443054 ms (excluding imports and monkey-patching)
2022-09-24 22:42:44 INFO  Starting execution of 1 what-if analyses...
2022-09-24 22:42:44 INFO  Start plan generation for analysis PermutationFeatureImportance...
2022-09-24 22:42:44 INFO  ---RUNTIME: Plan generation took 0.12230873107910156 ms
2022-09-24 22:42:44 INFO  Estimated runtime of original DAG is 39788.62452507019ms
2022-09-24 22:42:44 INFO  Performing Multi-Query Optimization
2022-09-24 22:42:44 INFO  Estimated unoptimized what-if runtime is 198943.12262535095ms
2022-09-24 22:42:44 INFO  Estimated optimised what-if runtime is 42738.03353309631ms
2022-09-24 22:42:44 INFO  Estimated optimisation runtime saving is 156205.08909225464ms
2022-09-24 22:42:44 INFO  ---RUNTIME: Multi-Query Optimization took 10.380268096923828 ms
2022-09-24 22:42:44 INFO  Executing generated plans
2022-09-24 22:43:27 INFO  ---RUNTIME: Execution took 42863.00086975098 ms
2022-09-24 22:43:27 INFO  Done!
2022-09-24 22:43:27 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-24 22:43:27 INFO  Running instrumented original pipeline...
2022-09-24 22:43:27 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-24 22:43:27 INFO  ---RUNTIME: Importing and monkey-patching took 6.224870681762695 ms
2022-09-24 22:44:07 INFO  ---RUNTIME: Original pipeline execution took 40183.15005302429 ms (excluding imports and monkey-patching)
2022-09-24 22:44:07 INFO  Starting execution of 1 what-if analyses...
2022-09-24 22:44:07 INFO  Start plan generation for analysis PermutationFeatureImportance...
2022-09-24 22:44:07 INFO  ---RUNTIME: Plan generation took 0.12135505676269531 ms
2022-09-24 22:44:07 INFO  Estimated runtime of original DAG is 39874.51767921448ms
2022-09-24 22:44:07 WARNING Skipping Multi-Query Optimization (instead, only applying patches)
2022-09-24 22:44:07 INFO  Estimated unoptimised what-if runtime is 199372.5883960724ms
2022-09-24 22:44:07 INFO  ---RUNTIME: Multi-Query Optimization took 4.100322723388672 ms
2022-09-24 22:44:07 INFO  Executing generated plans
2022-09-24 22:47:27 INFO  ---RUNTIME: Execution took 199554.81886863708 ms
2022-09-24 22:47:27 INFO  Done!
2022-09-24 22:47:27 INFO  # Finished -- repetition 5 of 7 
2022-09-24 22:47:27 INFO  # Optimization benchmark for feature_importance with args [['reviews', 'fast_loading', 'featurization_2', 'xgboost']] -- repetition 6 of 7
2022-09-24 22:47:27 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-24 22:47:27 INFO  Running instrumented original pipeline...
2022-09-24 22:47:27 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-24 22:47:27 INFO  ---RUNTIME: Importing and monkey-patching took 6.168365478515625 ms
2022-09-24 22:48:07 INFO  ---RUNTIME: Original pipeline execution took 40171.154499053955 ms (excluding imports and monkey-patching)
2022-09-24 22:48:07 INFO  Starting execution of 1 what-if analyses...
2022-09-24 22:48:07 INFO  Start plan generation for analysis PermutationFeatureImportance...
2022-09-24 22:48:07 INFO  ---RUNTIME: Plan generation took 0.12755393981933594 ms
2022-09-24 22:48:07 INFO  Estimated runtime of original DAG is 39866.91236495972ms
2022-09-24 22:48:07 INFO  Performing Multi-Query Optimization
2022-09-24 22:48:07 INFO  Estimated unoptimized what-if runtime is 199334.56182479858ms
2022-09-24 22:48:07 INFO  Estimated optimised what-if runtime is 42823.09317588806ms
2022-09-24 22:48:07 INFO  Estimated optimisation runtime saving is 156511.46864891052ms
2022-09-24 22:48:07 INFO  ---RUNTIME: Multi-Query Optimization took 10.730266571044922 ms
2022-09-24 22:48:07 INFO  Executing generated plans
2022-09-24 22:48:50 INFO  ---RUNTIME: Execution took 42848.4103679657 ms
2022-09-24 22:48:50 INFO  Done!
2022-09-24 22:48:50 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-24 22:48:50 INFO  Running instrumented original pipeline...
2022-09-24 22:48:50 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-24 22:48:50 INFO  ---RUNTIME: Importing and monkey-patching took 6.421089172363281 ms
2022-09-24 22:49:30 INFO  ---RUNTIME: Original pipeline execution took 40160.31908988953 ms (excluding imports and monkey-patching)
2022-09-24 22:49:30 INFO  Starting execution of 1 what-if analyses...
2022-09-24 22:49:30 INFO  Start plan generation for analysis PermutationFeatureImportance...
2022-09-24 22:49:30 INFO  ---RUNTIME: Plan generation took 0.11205673217773438 ms
2022-09-24 22:49:30 INFO  Estimated runtime of original DAG is 39853.28674316406ms
2022-09-24 22:49:30 WARNING Skipping Multi-Query Optimization (instead, only applying patches)
2022-09-24 22:49:30 INFO  Estimated unoptimised what-if runtime is 199266.4337158203ms
2022-09-24 22:49:30 INFO  ---RUNTIME: Multi-Query Optimization took 4.126071929931641 ms
2022-09-24 22:49:30 INFO  Executing generated plans
2022-09-24 22:52:50 INFO  ---RUNTIME: Execution took 199777.4567604065 ms
2022-09-24 22:52:50 INFO  Done!
2022-09-24 22:52:50 INFO  # Finished -- repetition 6 of 7 
2022-09-24 22:52:50 INFO  # Optimization benchmark for feature_importance with args [['reviews', 'fast_loading', 'featurization_2', 'xgboost']] -- repetition 7 of 7
2022-09-24 22:52:50 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-24 22:52:50 INFO  Running instrumented original pipeline...
2022-09-24 22:52:50 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-24 22:52:50 INFO  ---RUNTIME: Importing and monkey-patching took 6.617546081542969 ms
2022-09-24 22:53:30 INFO  ---RUNTIME: Original pipeline execution took 40163.214683532715 ms (excluding imports and monkey-patching)
2022-09-24 22:53:30 INFO  Starting execution of 1 what-if analyses...
2022-09-24 22:53:30 INFO  Start plan generation for analysis PermutationFeatureImportance...
2022-09-24 22:53:30 INFO  ---RUNTIME: Plan generation took 0.11873245239257812 ms
2022-09-24 22:53:30 INFO  Estimated runtime of original DAG is 39857.10048675537ms
2022-09-24 22:53:30 INFO  Performing Multi-Query Optimization
2022-09-24 22:53:30 INFO  Estimated unoptimized what-if runtime is 199285.50243377686ms
2022-09-24 22:53:30 INFO  Estimated optimised what-if runtime is 42814.348459243774ms
2022-09-24 22:53:30 INFO  Estimated optimisation runtime saving is 156471.15397453308ms
2022-09-24 22:53:30 INFO  ---RUNTIME: Multi-Query Optimization took 10.544538497924805 ms
2022-09-24 22:53:30 INFO  Executing generated plans
2022-09-24 22:54:13 INFO  ---RUNTIME: Execution took 42852.91385650635 ms
2022-09-24 22:54:13 INFO  Done!
2022-09-24 22:54:13 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-24 22:54:13 INFO  Running instrumented original pipeline...
2022-09-24 22:54:13 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-24 22:54:13 INFO  ---RUNTIME: Importing and monkey-patching took 6.13093376159668 ms
2022-09-24 22:54:53 INFO  ---RUNTIME: Original pipeline execution took 40119.64464187622 ms (excluding imports and monkey-patching)
2022-09-24 22:54:53 INFO  Starting execution of 1 what-if analyses...
2022-09-24 22:54:53 INFO  Start plan generation for analysis PermutationFeatureImportance...
2022-09-24 22:54:53 INFO  ---RUNTIME: Plan generation took 0.11849403381347656 ms
2022-09-24 22:54:53 INFO  Estimated runtime of original DAG is 39812.323808670044ms
2022-09-24 22:54:53 WARNING Skipping Multi-Query Optimization (instead, only applying patches)
2022-09-24 22:54:53 INFO  Estimated unoptimised what-if runtime is 199061.61904335022ms
2022-09-24 22:54:53 INFO  ---RUNTIME: Multi-Query Optimization took 4.094600677490234 ms
2022-09-24 22:54:53 INFO  Executing generated plans
2022-09-24 22:58:13 INFO  ---RUNTIME: Execution took 199792.96135902405 ms
2022-09-24 22:58:13 INFO  Done!
2022-09-24 22:58:13 INFO  # Finished -- repetition 7 of 7 
2022-09-24 22:58:13 INFO  # Final results after all repetitions
2022-09-24 22:58:13 INFO     repetition  ... no_opt_what_if_execution_combined_model_training
0           0  ...                                    169821.510792
1           1  ...                                    170520.353794
2           2  ...                                    170420.255423
3           3  ...                                    170534.426212
4           4  ...                                    170513.077736
5           5  ...                                    170661.674023
6           6  ...                                    170733.614922

[7 rows x 26 columns]
PROTOCOL_BUFFERS_PYTHON_IMPLEMENTATION=python taskset -c 32-39 python3.9 benchmarks_end_to_end.py feature_importance reviews fast_loading featurization_2 neural_network
2022-09-24 22:58:15.682712: W tensorflow/stream_executor/platform/default/dso_loader.cc:64] Could not load dynamic library 'libcudart.so.11.0'; dlerror: libcudart.so.11.0: cannot open shared object file: No such file or directory; LD_LIBRARY_PATH: /home/sgrafbe/mlwhatif/venv/lib/python3.9/site-packages/cv2/../../lib64:
2022-09-24 22:58:15.682761: I tensorflow/stream_executor/cuda/cudart_stub.cc:29] Ignore above cudart dlerror if you do not have a GPU set up on your machine.
2022-09-24 22:58:16 INFO  Patching sys.argv with ['mlwhatif', 'reviews', 'fast_loading', 'featurization_2', 'neural_network']
2022-09-24 22:58:16 INFO  Running instrumented original pipeline...
2022-09-24 22:58:17 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-24 22:58:17 INFO  ---RUNTIME: Importing and monkey-patching took 122.70569801330566 ms
2022-09-24 22:58:21.403110: W tensorflow/stream_executor/platform/default/dso_loader.cc:64] Could not load dynamic library 'libcuda.so.1'; dlerror: libcuda.so.1: cannot open shared object file: No such file or directory; LD_LIBRARY_PATH: /home/sgrafbe/mlwhatif/venv/lib/python3.9/site-packages/cv2/../../lib64:
2022-09-24 22:58:21.403146: W tensorflow/stream_executor/cuda/cuda_driver.cc:326] failed call to cuInit: UNKNOWN ERROR (303)
2022-09-24 22:58:21.403174: I tensorflow/stream_executor/cuda/cuda_diagnostics.cc:156] kernel driver does not appear to be running on this host (angus): /proc/driver/nvidia/version does not exist
2022-09-24 22:58:21.403701: I tensorflow/core/platform/cpu_feature_guard.cc:142] This TensorFlow binary is optimized with oneAPI Deep Neural Network Library (oneDNN) to use the following CPU instructions in performance-critical operations:  AVX2 FMA
To enable them in other operations, rebuild TensorFlow with the appropriate compiler flags.
2022-09-24 22:58:22.021869: I tensorflow/compiler/mlir/mlir_graph_optimization_pass.cc:176] None of the MLIR Optimization Passes are enabled (registered 2)
2022-09-24 22:58:22.036187: I tensorflow/core/platform/profile_utils/cpu_utils.cc:114] CPU Frequency: 2595130000 Hz
2022-09-24 22:58:29 INFO  ---RUNTIME: Original pipeline execution took 12738.010883331299 ms (excluding imports and monkey-patching)
2022-09-24 22:58:29 INFO  Starting execution of 0 what-if analyses...
2022-09-24 22:58:29 INFO  Estimated runtime of original DAG is 12401.187658309937ms
2022-09-24 22:58:29 INFO  Performing Multi-Query Optimization
2022-09-24 22:58:29 INFO  Estimated unoptimized what-if runtime is 0ms
2022-09-24 22:58:29 INFO  Estimated optimised what-if runtime is 0ms
2022-09-24 22:58:29 INFO  Estimated optimisation runtime saving is 0ms
2022-09-24 22:58:29 INFO  ---RUNTIME: Multi-Query Optimization took 0.4971027374267578 ms
2022-09-24 22:58:29 INFO  Executing generated plans
2022-09-24 22:58:29 INFO  ---RUNTIME: Execution took 0.022649765014648438 ms
2022-09-24 22:58:29 INFO  Done!
2022-09-24 22:58:29 INFO  # Optimization benchmark for feature_importance with args [['reviews', 'fast_loading', 'featurization_2', 'neural_network']] -- repetition 1 of 7
2022-09-24 22:58:29 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-24 22:58:29 INFO  Running instrumented original pipeline...
2022-09-24 22:58:29 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-24 22:58:29 INFO  ---RUNTIME: Importing and monkey-patching took 5.439281463623047 ms
2022-09-24 22:58:42 INFO  ---RUNTIME: Original pipeline execution took 12425.34852027893 ms (excluding imports and monkey-patching)
2022-09-24 22:58:42 INFO  Starting execution of 1 what-if analyses...
2022-09-24 22:58:42 INFO  Start plan generation for analysis PermutationFeatureImportance...
2022-09-24 22:58:42 INFO  ---RUNTIME: Plan generation took 0.22220611572265625 ms
2022-09-24 22:58:42 INFO  Estimated runtime of original DAG is 12118.74532699585ms
2022-09-24 22:58:42 INFO  Performing Multi-Query Optimization
2022-09-24 22:58:42 INFO  Estimated unoptimized what-if runtime is 60593.72663497925ms
2022-09-24 22:58:42 INFO  Estimated optimised what-if runtime is 16883.277893066406ms
2022-09-24 22:58:42 INFO  Estimated optimisation runtime saving is 43710.44874191284ms
2022-09-24 22:58:42 INFO  ---RUNTIME: Multi-Query Optimization took 10.74838638305664 ms
2022-09-24 22:58:42 INFO  Executing generated plans
2022-09-24 22:58:58 INFO  ---RUNTIME: Execution took 16539.762020111084 ms
2022-09-24 22:58:58 INFO  Done!
2022-09-24 22:58:58 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-24 22:58:58 INFO  Running instrumented original pipeline...
2022-09-24 22:58:59 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-24 22:58:59 INFO  ---RUNTIME: Importing and monkey-patching took 5.842924118041992 ms
2022-09-24 22:59:11 INFO  ---RUNTIME: Original pipeline execution took 12574.38039779663 ms (excluding imports and monkey-patching)
2022-09-24 22:59:11 INFO  Starting execution of 1 what-if analyses...
2022-09-24 22:59:11 INFO  Start plan generation for analysis PermutationFeatureImportance...
2022-09-24 22:59:11 INFO  ---RUNTIME: Plan generation took 0.13518333435058594 ms
2022-09-24 22:59:11 INFO  Estimated runtime of original DAG is 12044.476509094238ms
2022-09-24 22:59:11 WARNING Skipping Multi-Query Optimization (instead, only applying patches)
2022-09-24 22:59:11 INFO  Estimated unoptimised what-if runtime is 60222.38254547119ms
2022-09-24 22:59:11 INFO  ---RUNTIME: Multi-Query Optimization took 4.180192947387695 ms
2022-09-24 22:59:11 INFO  Executing generated plans
2022-09-24 23:00:12 INFO  ---RUNTIME: Execution took 61449.21922683716 ms
2022-09-24 23:00:12 INFO  Done!
2022-09-24 23:00:12 INFO  # Finished -- repetition 1 of 7 
2022-09-24 23:00:12 INFO  # Optimization benchmark for feature_importance with args [['reviews', 'fast_loading', 'featurization_2', 'neural_network']] -- repetition 2 of 7
2022-09-24 23:00:12 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-24 23:00:12 INFO  Running instrumented original pipeline...
2022-09-24 23:00:12 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-24 23:00:12 INFO  ---RUNTIME: Importing and monkey-patching took 6.170034408569336 ms
2022-09-24 23:00:25 INFO  ---RUNTIME: Original pipeline execution took 12272.013902664185 ms (excluding imports and monkey-patching)
2022-09-24 23:00:25 INFO  Starting execution of 1 what-if analyses...
2022-09-24 23:00:25 INFO  Start plan generation for analysis PermutationFeatureImportance...
2022-09-24 23:00:25 INFO  ---RUNTIME: Plan generation took 0.11777877807617188 ms
2022-09-24 23:00:25 INFO  Estimated runtime of original DAG is 11962.569952011108ms
2022-09-24 23:00:25 INFO  Performing Multi-Query Optimization
2022-09-24 23:00:25 INFO  Estimated unoptimized what-if runtime is 59812.84976005554ms
2022-09-24 23:00:25 INFO  Estimated optimised what-if runtime is 16529.858350753784ms
2022-09-24 23:00:25 INFO  Estimated optimisation runtime saving is 43282.99140930176ms
2022-09-24 23:00:25 INFO  ---RUNTIME: Multi-Query Optimization took 10.903120040893555 ms
2022-09-24 23:00:25 INFO  Executing generated plans
2022-09-24 23:00:41 INFO  ---RUNTIME: Execution took 16556.443691253662 ms
2022-09-24 23:00:41 INFO  Done!
2022-09-24 23:00:41 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-24 23:00:41 INFO  Running instrumented original pipeline...
2022-09-24 23:00:41 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-24 23:00:41 INFO  ---RUNTIME: Importing and monkey-patching took 6.225109100341797 ms
2022-09-24 23:00:54 INFO  ---RUNTIME: Original pipeline execution took 12571.11120223999 ms (excluding imports and monkey-patching)
2022-09-24 23:00:54 INFO  Starting execution of 1 what-if analyses...
2022-09-24 23:00:54 INFO  Start plan generation for analysis PermutationFeatureImportance...
2022-09-24 23:00:54 INFO  ---RUNTIME: Plan generation took 0.12540817260742188 ms
2022-09-24 23:00:54 INFO  Estimated runtime of original DAG is 12252.817630767822ms
2022-09-24 23:00:54 WARNING Skipping Multi-Query Optimization (instead, only applying patches)
2022-09-24 23:00:54 INFO  Estimated unoptimised what-if runtime is 61264.08815383911ms
2022-09-24 23:00:54 INFO  ---RUNTIME: Multi-Query Optimization took 4.184961318969727 ms
2022-09-24 23:00:54 INFO  Executing generated plans
2022-09-24 23:01:55 INFO  ---RUNTIME: Execution took 61608.646631240845 ms
2022-09-24 23:01:55 INFO  Done!
2022-09-24 23:01:55 INFO  # Finished -- repetition 2 of 7 
2022-09-24 23:01:55 INFO  # Optimization benchmark for feature_importance with args [['reviews', 'fast_loading', 'featurization_2', 'neural_network']] -- repetition 3 of 7
2022-09-24 23:01:55 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-24 23:01:55 INFO  Running instrumented original pipeline...
2022-09-24 23:01:55 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-24 23:01:55 INFO  ---RUNTIME: Importing and monkey-patching took 6.384611129760742 ms
2022-09-24 23:02:08 INFO  ---RUNTIME: Original pipeline execution took 12942.064762115479 ms (excluding imports and monkey-patching)
2022-09-24 23:02:08 INFO  Starting execution of 1 what-if analyses...
2022-09-24 23:02:08 INFO  Start plan generation for analysis PermutationFeatureImportance...
2022-09-24 23:02:08 INFO  ---RUNTIME: Plan generation took 0.11157989501953125 ms
2022-09-24 23:02:08 INFO  Estimated runtime of original DAG is 12630.30743598938ms
2022-09-24 23:02:08 INFO  Performing Multi-Query Optimization
2022-09-24 23:02:08 INFO  Estimated unoptimized what-if runtime is 63151.5371799469ms
2022-09-24 23:02:08 INFO  Estimated optimised what-if runtime is 19051.525354385376ms
2022-09-24 23:02:08 INFO  Estimated optimisation runtime saving is 44100.01182556152ms
2022-09-24 23:02:08 INFO  ---RUNTIME: Multi-Query Optimization took 11.252164840698242 ms
2022-09-24 23:02:08 INFO  Executing generated plans
2022-09-24 23:02:25 INFO  ---RUNTIME: Execution took 16971.558332443237 ms
2022-09-24 23:02:25 INFO  Done!
2022-09-24 23:02:25 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-24 23:02:25 INFO  Running instrumented original pipeline...
2022-09-24 23:02:25 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-24 23:02:25 INFO  ---RUNTIME: Importing and monkey-patching took 5.77855110168457 ms
2022-09-24 23:02:38 INFO  ---RUNTIME: Original pipeline execution took 12524.971008300781 ms (excluding imports and monkey-patching)
2022-09-24 23:02:38 INFO  Starting execution of 1 what-if analyses...
2022-09-24 23:02:38 INFO  Start plan generation for analysis PermutationFeatureImportance...
2022-09-24 23:02:38 INFO  ---RUNTIME: Plan generation took 0.11849403381347656 ms
2022-09-24 23:02:38 INFO  Estimated runtime of original DAG is 12205.252170562744ms
2022-09-24 23:02:38 WARNING Skipping Multi-Query Optimization (instead, only applying patches)
2022-09-24 23:02:38 INFO  Estimated unoptimised what-if runtime is 61026.26085281372ms
2022-09-24 23:02:38 INFO  ---RUNTIME: Multi-Query Optimization took 4.227399826049805 ms
2022-09-24 23:02:38 INFO  Executing generated plans
2022-09-24 23:03:39 INFO  ---RUNTIME: Execution took 61483.15906524658 ms
2022-09-24 23:03:39 INFO  Done!
2022-09-24 23:03:39 INFO  # Finished -- repetition 3 of 7 
2022-09-24 23:03:39 INFO  # Optimization benchmark for feature_importance with args [['reviews', 'fast_loading', 'featurization_2', 'neural_network']] -- repetition 4 of 7
2022-09-24 23:03:39 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-24 23:03:39 INFO  Running instrumented original pipeline...
2022-09-24 23:03:39 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-24 23:03:39 INFO  ---RUNTIME: Importing and monkey-patching took 6.402492523193359 ms
2022-09-24 23:03:52 INFO  ---RUNTIME: Original pipeline execution took 12557.602405548096 ms (excluding imports and monkey-patching)
2022-09-24 23:03:52 INFO  Starting execution of 1 what-if analyses...
2022-09-24 23:03:52 INFO  Start plan generation for analysis PermutationFeatureImportance...
2022-09-24 23:03:52 INFO  ---RUNTIME: Plan generation took 0.12969970703125 ms
2022-09-24 23:03:52 INFO  Estimated runtime of original DAG is 12236.323356628418ms
2022-09-24 23:03:52 INFO  Performing Multi-Query Optimization
2022-09-24 23:03:52 INFO  Estimated unoptimized what-if runtime is 61181.61678314209ms
2022-09-24 23:03:52 INFO  Estimated optimised what-if runtime is 16691.568851470947ms
2022-09-24 23:03:52 INFO  Estimated optimisation runtime saving is 44490.04793167114ms
2022-09-24 23:03:52 INFO  ---RUNTIME: Multi-Query Optimization took 10.605335235595703 ms
2022-09-24 23:03:52 INFO  Executing generated plans
2022-09-24 23:04:09 INFO  ---RUNTIME: Execution took 16586.17877960205 ms
2022-09-24 23:04:09 INFO  Done!
2022-09-24 23:04:09 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-24 23:04:09 INFO  Running instrumented original pipeline...
2022-09-24 23:04:09 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-24 23:04:09 INFO  ---RUNTIME: Importing and monkey-patching took 6.192207336425781 ms
2022-09-24 23:04:21 INFO  ---RUNTIME: Original pipeline execution took 12650.423765182495 ms (excluding imports and monkey-patching)
2022-09-24 23:04:21 INFO  Starting execution of 1 what-if analyses...
2022-09-24 23:04:21 INFO  Start plan generation for analysis PermutationFeatureImportance...
2022-09-24 23:04:21 INFO  ---RUNTIME: Plan generation took 0.12183189392089844 ms
2022-09-24 23:04:21 INFO  Estimated runtime of original DAG is 12329.793453216553ms
2022-09-24 23:04:21 WARNING Skipping Multi-Query Optimization (instead, only applying patches)
2022-09-24 23:04:21 INFO  Estimated unoptimised what-if runtime is 61648.967266082764ms
2022-09-24 23:04:21 INFO  ---RUNTIME: Multi-Query Optimization took 4.2324066162109375 ms
2022-09-24 23:04:21 INFO  Executing generated plans
2022-09-24 23:05:23 INFO  ---RUNTIME: Execution took 61705.46245574951 ms
2022-09-24 23:05:23 INFO  Done!
2022-09-24 23:05:23 INFO  # Finished -- repetition 4 of 7 
2022-09-24 23:05:23 INFO  # Optimization benchmark for feature_importance with args [['reviews', 'fast_loading', 'featurization_2', 'neural_network']] -- repetition 5 of 7
2022-09-24 23:05:23 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-24 23:05:23 INFO  Running instrumented original pipeline...
2022-09-24 23:05:23 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-24 23:05:23 INFO  ---RUNTIME: Importing and monkey-patching took 6.445407867431641 ms
2022-09-24 23:05:36 INFO  ---RUNTIME: Original pipeline execution took 12555.476903915405 ms (excluding imports and monkey-patching)
2022-09-24 23:05:36 INFO  Starting execution of 1 what-if analyses...
2022-09-24 23:05:36 INFO  Start plan generation for analysis PermutationFeatureImportance...
2022-09-24 23:05:36 INFO  ---RUNTIME: Plan generation took 0.12040138244628906 ms
2022-09-24 23:05:36 INFO  Estimated runtime of original DAG is 12237.186193466187ms
2022-09-24 23:05:36 INFO  Performing Multi-Query Optimization
2022-09-24 23:05:36 INFO  Estimated unoptimized what-if runtime is 61185.93096733093ms
2022-09-24 23:05:36 INFO  Estimated optimised what-if runtime is 17048.048496246338ms
2022-09-24 23:05:36 INFO  Estimated optimisation runtime saving is 44137.882471084595ms
2022-09-24 23:05:36 INFO  ---RUNTIME: Multi-Query Optimization took 11.665582656860352 ms
2022-09-24 23:05:36 INFO  Executing generated plans
2022-09-24 23:05:53 INFO  ---RUNTIME: Execution took 17528.213500976562 ms
2022-09-24 23:05:53 INFO  Done!
2022-09-24 23:05:53 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-24 23:05:53 INFO  Running instrumented original pipeline...
2022-09-24 23:05:53 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-24 23:05:53 INFO  ---RUNTIME: Importing and monkey-patching took 6.343364715576172 ms
2022-09-24 23:06:06 INFO  ---RUNTIME: Original pipeline execution took 12555.040836334229 ms (excluding imports and monkey-patching)
2022-09-24 23:06:06 INFO  Starting execution of 1 what-if analyses...
2022-09-24 23:06:06 INFO  Start plan generation for analysis PermutationFeatureImportance...
2022-09-24 23:06:06 INFO  ---RUNTIME: Plan generation took 0.1385211944580078 ms
2022-09-24 23:06:06 INFO  Estimated runtime of original DAG is 12233.74342918396ms
2022-09-24 23:06:06 WARNING Skipping Multi-Query Optimization (instead, only applying patches)
2022-09-24 23:06:06 INFO  Estimated unoptimised what-if runtime is 61168.7171459198ms
2022-09-24 23:06:06 INFO  ---RUNTIME: Multi-Query Optimization took 4.211187362670898 ms
2022-09-24 23:06:06 INFO  Executing generated plans
2022-09-24 23:07:08 INFO  ---RUNTIME: Execution took 61805.97019195557 ms
2022-09-24 23:07:08 INFO  Done!
2022-09-24 23:07:08 INFO  # Finished -- repetition 5 of 7 
2022-09-24 23:07:08 INFO  # Optimization benchmark for feature_importance with args [['reviews', 'fast_loading', 'featurization_2', 'neural_network']] -- repetition 6 of 7
2022-09-24 23:07:08 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-24 23:07:08 INFO  Running instrumented original pipeline...
2022-09-24 23:07:08 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-24 23:07:08 INFO  ---RUNTIME: Importing and monkey-patching took 6.709098815917969 ms
2022-09-24 23:07:20 INFO  ---RUNTIME: Original pipeline execution took 12579.083681106567 ms (excluding imports and monkey-patching)
2022-09-24 23:07:20 INFO  Starting execution of 1 what-if analyses...
2022-09-24 23:07:20 INFO  Start plan generation for analysis PermutationFeatureImportance...
2022-09-24 23:07:20 INFO  ---RUNTIME: Plan generation took 0.12826919555664062 ms
2022-09-24 23:07:20 INFO  Estimated runtime of original DAG is 12255.953788757324ms
2022-09-24 23:07:20 INFO  Performing Multi-Query Optimization
2022-09-24 23:07:20 INFO  Estimated unoptimized what-if runtime is 61279.76894378662ms
2022-09-24 23:07:20 INFO  Estimated optimised what-if runtime is 16744.850158691406ms
2022-09-24 23:07:20 INFO  Estimated optimisation runtime saving is 44534.918785095215ms
2022-09-24 23:07:20 INFO  ---RUNTIME: Multi-Query Optimization took 10.610818862915039 ms
2022-09-24 23:07:20 INFO  Executing generated plans
2022-09-24 23:07:37 INFO  ---RUNTIME: Execution took 17185.658931732178 ms
2022-09-24 23:07:37 INFO  Done!
2022-09-24 23:07:37 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-24 23:07:37 INFO  Running instrumented original pipeline...
2022-09-24 23:07:37 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-24 23:07:37 INFO  ---RUNTIME: Importing and monkey-patching took 5.801916122436523 ms
2022-09-24 23:07:50 INFO  ---RUNTIME: Original pipeline execution took 12562.707662582397 ms (excluding imports and monkey-patching)
2022-09-24 23:07:50 INFO  Starting execution of 1 what-if analyses...
2022-09-24 23:07:50 INFO  Start plan generation for analysis PermutationFeatureImportance...
2022-09-24 23:07:50 INFO  ---RUNTIME: Plan generation took 0.11444091796875 ms
2022-09-24 23:07:50 INFO  Estimated runtime of original DAG is 12241.504669189453ms
2022-09-24 23:07:50 WARNING Skipping Multi-Query Optimization (instead, only applying patches)
2022-09-24 23:07:50 INFO  Estimated unoptimised what-if runtime is 61207.523345947266ms
2022-09-24 23:07:50 INFO  ---RUNTIME: Multi-Query Optimization took 5.026578903198242 ms
2022-09-24 23:07:50 INFO  Executing generated plans
2022-09-24 23:08:52 INFO  ---RUNTIME: Execution took 62027.37379074097 ms
2022-09-24 23:08:52 INFO  Done!
2022-09-24 23:08:52 INFO  # Finished -- repetition 6 of 7 
2022-09-24 23:08:52 INFO  # Optimization benchmark for feature_importance with args [['reviews', 'fast_loading', 'featurization_2', 'neural_network']] -- repetition 7 of 7
2022-09-24 23:08:52 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-24 23:08:52 INFO  Running instrumented original pipeline...
2022-09-24 23:08:52 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-24 23:08:52 INFO  ---RUNTIME: Importing and monkey-patching took 5.991697311401367 ms
2022-09-24 23:09:05 INFO  ---RUNTIME: Original pipeline execution took 12556.45751953125 ms (excluding imports and monkey-patching)
2022-09-24 23:09:05 INFO  Starting execution of 1 what-if analyses...
2022-09-24 23:09:05 INFO  Start plan generation for analysis PermutationFeatureImportance...
2022-09-24 23:09:05 INFO  ---RUNTIME: Plan generation took 0.1392364501953125 ms
2022-09-24 23:09:05 INFO  Estimated runtime of original DAG is 12234.92956161499ms
2022-09-24 23:09:05 INFO  Performing Multi-Query Optimization
2022-09-24 23:09:05 INFO  Estimated unoptimized what-if runtime is 61174.64780807495ms
2022-09-24 23:09:05 INFO  Estimated optimised what-if runtime is 16788.99383544922ms
2022-09-24 23:09:05 INFO  Estimated optimisation runtime saving is 44385.65397262573ms
2022-09-24 23:09:05 INFO  ---RUNTIME: Multi-Query Optimization took 11.858224868774414 ms
2022-09-24 23:09:05 INFO  Executing generated plans
2022-09-24 23:09:21 INFO  ---RUNTIME: Execution took 16863.155126571655 ms
2022-09-24 23:09:21 INFO  Done!
2022-09-24 23:09:21 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-24 23:09:21 INFO  Running instrumented original pipeline...
2022-09-24 23:09:21 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-24 23:09:21 INFO  ---RUNTIME: Importing and monkey-patching took 5.949497222900391 ms
2022-09-24 23:09:34 INFO  ---RUNTIME: Original pipeline execution took 12540.170907974243 ms (excluding imports and monkey-patching)
2022-09-24 23:09:34 INFO  Starting execution of 1 what-if analyses...
2022-09-24 23:09:34 INFO  Start plan generation for analysis PermutationFeatureImportance...
2022-09-24 23:09:34 INFO  ---RUNTIME: Plan generation took 0.12278556823730469 ms
2022-09-24 23:09:34 INFO  Estimated runtime of original DAG is 12217.336893081665ms
2022-09-24 23:09:34 WARNING Skipping Multi-Query Optimization (instead, only applying patches)
2022-09-24 23:09:34 INFO  Estimated unoptimised what-if runtime is 61086.684465408325ms
2022-09-24 23:09:34 INFO  ---RUNTIME: Multi-Query Optimization took 4.214763641357422 ms
2022-09-24 23:09:34 INFO  Executing generated plans
2022-09-24 23:10:35 INFO  ---RUNTIME: Execution took 61497.398853302 ms
2022-09-24 23:10:35 INFO  Done!
2022-09-24 23:10:35 INFO  # Finished -- repetition 7 of 7 
2022-09-24 23:10:35 INFO  # Final results after all repetitions
2022-09-24 23:10:35 INFO     repetition  ... no_opt_what_if_execution_combined_model_training
0           0  ...                                     29862.396717
1           1  ...                                     30066.641808
2           2  ...                                     30096.808910
3           3  ...                                     30132.159472
4           4  ...                                     30343.634367
5           5  ...                                     30430.639505
6           6  ...                                     29522.925854

[7 rows x 26 columns]
PROTOCOL_BUFFERS_PYTHON_IMPLEMENTATION=python taskset -c 32-39 python3.9 benchmarks_end_to_end.py feature_importance reviews fast_loading featurization_3 logistic_regression
2022-09-24 23:10:38.623562: W tensorflow/stream_executor/platform/default/dso_loader.cc:64] Could not load dynamic library 'libcudart.so.11.0'; dlerror: libcudart.so.11.0: cannot open shared object file: No such file or directory; LD_LIBRARY_PATH: /home/sgrafbe/mlwhatif/venv/lib/python3.9/site-packages/cv2/../../lib64:
2022-09-24 23:10:38.623608: I tensorflow/stream_executor/cuda/cudart_stub.cc:29] Ignore above cudart dlerror if you do not have a GPU set up on your machine.
2022-09-24 23:10:39 INFO  Patching sys.argv with ['mlwhatif', 'reviews', 'fast_loading', 'featurization_3', 'logistic_regression']
2022-09-24 23:10:39 INFO  Running instrumented original pipeline...
2022-09-24 23:10:39 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-24 23:10:40 INFO  ---RUNTIME: Importing and monkey-patching took 121.3688850402832 ms
2022-09-24 23:10:49 INFO  ---RUNTIME: Original pipeline execution took 9684.85140800476 ms (excluding imports and monkey-patching)
2022-09-24 23:10:49 INFO  Starting execution of 0 what-if analyses...
2022-09-24 23:10:49 INFO  Estimated runtime of original DAG is 9280.494451522827ms
2022-09-24 23:10:49 INFO  Performing Multi-Query Optimization
2022-09-24 23:10:49 INFO  Estimated unoptimized what-if runtime is 0ms
2022-09-24 23:10:49 INFO  Estimated optimised what-if runtime is 0ms
2022-09-24 23:10:49 INFO  Estimated optimisation runtime saving is 0ms
2022-09-24 23:10:49 INFO  ---RUNTIME: Multi-Query Optimization took 0.5788803100585938 ms
2022-09-24 23:10:49 INFO  Executing generated plans
2022-09-24 23:10:49 INFO  ---RUNTIME: Execution took 0.026941299438476562 ms
2022-09-24 23:10:49 INFO  Done!
2022-09-24 23:10:49 INFO  # Optimization benchmark for feature_importance with args [['reviews', 'fast_loading', 'featurization_3', 'logistic_regression']] -- repetition 1 of 7
2022-09-24 23:10:49 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-24 23:10:49 INFO  Running instrumented original pipeline...
2022-09-24 23:10:49 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-24 23:10:49 INFO  ---RUNTIME: Importing and monkey-patching took 5.720615386962891 ms
2022-09-24 23:10:59 INFO  ---RUNTIME: Original pipeline execution took 9708.045959472656 ms (excluding imports and monkey-patching)
2022-09-24 23:10:59 INFO  Starting execution of 1 what-if analyses...
2022-09-24 23:10:59 INFO  Start plan generation for analysis PermutationFeatureImportance...
2022-09-24 23:10:59 INFO  ---RUNTIME: Plan generation took 0.25153160095214844 ms
2022-09-24 23:10:59 INFO  Estimated runtime of original DAG is 9135.509252548218ms
2022-09-24 23:10:59 INFO  Performing Multi-Query Optimization
2022-09-24 23:10:59 INFO  Estimated unoptimized what-if runtime is 45677.54626274109ms
2022-09-24 23:10:59 INFO  Estimated optimised what-if runtime is 12609.416246414185ms
2022-09-24 23:10:59 INFO  Estimated optimisation runtime saving is 33068.130016326904ms
2022-09-24 23:10:59 INFO  ---RUNTIME: Multi-Query Optimization took 17.256975173950195 ms
2022-09-24 23:10:59 INFO  Executing generated plans
2022-09-24 23:11:12 INFO  ---RUNTIME: Execution took 12665.319204330444 ms
2022-09-24 23:11:12 INFO  Done!
2022-09-24 23:11:12 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-24 23:11:12 INFO  Running instrumented original pipeline...
2022-09-24 23:11:12 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-24 23:11:12 INFO  ---RUNTIME: Importing and monkey-patching took 6.090402603149414 ms
2022-09-24 23:11:21 INFO  ---RUNTIME: Original pipeline execution took 9475.774049758911 ms (excluding imports and monkey-patching)
2022-09-24 23:11:21 INFO  Starting execution of 1 what-if analyses...
2022-09-24 23:11:21 INFO  Start plan generation for analysis PermutationFeatureImportance...
2022-09-24 23:11:21 INFO  ---RUNTIME: Plan generation took 0.1342296600341797 ms
2022-09-24 23:11:21 INFO  Estimated runtime of original DAG is 9111.804485321045ms
2022-09-24 23:11:21 WARNING Skipping Multi-Query Optimization (instead, only applying patches)
2022-09-24 23:11:21 INFO  Estimated unoptimised what-if runtime is 45559.022426605225ms
2022-09-24 23:11:21 INFO  ---RUNTIME: Multi-Query Optimization took 4.738807678222656 ms
2022-09-24 23:11:21 INFO  Executing generated plans
2022-09-24 23:12:07 INFO  ---RUNTIME: Execution took 45836.98916435242 ms
2022-09-24 23:12:07 INFO  Done!
2022-09-24 23:12:07 INFO  # Finished -- repetition 1 of 7 
2022-09-24 23:12:07 INFO  # Optimization benchmark for feature_importance with args [['reviews', 'fast_loading', 'featurization_3', 'logistic_regression']] -- repetition 2 of 7
2022-09-24 23:12:07 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-24 23:12:07 INFO  Running instrumented original pipeline...
2022-09-24 23:12:07 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-24 23:12:07 INFO  ---RUNTIME: Importing and monkey-patching took 5.947351455688477 ms
2022-09-24 23:12:16 INFO  ---RUNTIME: Original pipeline execution took 9473.09398651123 ms (excluding imports and monkey-patching)
2022-09-24 23:12:16 INFO  Starting execution of 1 what-if analyses...
2022-09-24 23:12:16 INFO  Start plan generation for analysis PermutationFeatureImportance...
2022-09-24 23:12:16 INFO  ---RUNTIME: Plan generation took 0.1342296600341797 ms
2022-09-24 23:12:16 INFO  Estimated runtime of original DAG is 9113.006353378296ms
2022-09-24 23:12:16 INFO  Performing Multi-Query Optimization
2022-09-24 23:12:16 INFO  Estimated unoptimized what-if runtime is 45565.03176689148ms
2022-09-24 23:12:16 INFO  Estimated optimised what-if runtime is 12566.97392463684ms
2022-09-24 23:12:16 INFO  Estimated optimisation runtime saving is 32998.05784225464ms
2022-09-24 23:12:16 INFO  ---RUNTIME: Multi-Query Optimization took 17.21024513244629 ms
2022-09-24 23:12:16 INFO  Executing generated plans
2022-09-24 23:12:29 INFO  ---RUNTIME: Execution took 12639.094829559326 ms
2022-09-24 23:12:29 INFO  Done!
2022-09-24 23:12:29 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-24 23:12:29 INFO  Running instrumented original pipeline...
2022-09-24 23:12:29 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-24 23:12:29 INFO  ---RUNTIME: Importing and monkey-patching took 6.063938140869141 ms
2022-09-24 23:12:39 INFO  ---RUNTIME: Original pipeline execution took 9560.573816299438 ms (excluding imports and monkey-patching)
2022-09-24 23:12:39 INFO  Starting execution of 1 what-if analyses...
2022-09-24 23:12:39 INFO  Start plan generation for analysis PermutationFeatureImportance...
2022-09-24 23:12:39 INFO  ---RUNTIME: Plan generation took 0.11682510375976562 ms
2022-09-24 23:12:39 INFO  Estimated runtime of original DAG is 9200.978994369507ms
2022-09-24 23:12:39 WARNING Skipping Multi-Query Optimization (instead, only applying patches)
2022-09-24 23:12:39 INFO  Estimated unoptimised what-if runtime is 46004.894971847534ms
2022-09-24 23:12:39 INFO  ---RUNTIME: Multi-Query Optimization took 4.821062088012695 ms
2022-09-24 23:12:39 INFO  Executing generated plans
2022-09-24 23:13:24 INFO  ---RUNTIME: Execution took 45716.702699661255 ms
2022-09-24 23:13:24 INFO  Done!
2022-09-24 23:13:24 INFO  # Finished -- repetition 2 of 7 
2022-09-24 23:13:24 INFO  # Optimization benchmark for feature_importance with args [['reviews', 'fast_loading', 'featurization_3', 'logistic_regression']] -- repetition 3 of 7
2022-09-24 23:13:24 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-24 23:13:24 INFO  Running instrumented original pipeline...
2022-09-24 23:13:25 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-24 23:13:25 INFO  ---RUNTIME: Importing and monkey-patching took 6.084203720092773 ms
2022-09-24 23:13:34 INFO  ---RUNTIME: Original pipeline execution took 9519.392013549805 ms (excluding imports and monkey-patching)
2022-09-24 23:13:34 INFO  Starting execution of 1 what-if analyses...
2022-09-24 23:13:34 INFO  Start plan generation for analysis PermutationFeatureImportance...
2022-09-24 23:13:34 INFO  ---RUNTIME: Plan generation took 0.12564659118652344 ms
2022-09-24 23:13:34 INFO  Estimated runtime of original DAG is 9159.099578857422ms
2022-09-24 23:13:34 INFO  Performing Multi-Query Optimization
2022-09-24 23:13:34 INFO  Estimated unoptimized what-if runtime is 45795.49789428711ms
2022-09-24 23:13:34 INFO  Estimated optimised what-if runtime is 12599.443435668945ms
2022-09-24 23:13:34 INFO  Estimated optimisation runtime saving is 33196.054458618164ms
2022-09-24 23:13:34 INFO  ---RUNTIME: Multi-Query Optimization took 17.368078231811523 ms
2022-09-24 23:13:34 INFO  Executing generated plans
2022-09-24 23:13:47 INFO  ---RUNTIME: Execution took 12635.119438171387 ms
2022-09-24 23:13:47 INFO  Done!
2022-09-24 23:13:47 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-24 23:13:47 INFO  Running instrumented original pipeline...
2022-09-24 23:13:47 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-24 23:13:47 INFO  ---RUNTIME: Importing and monkey-patching took 5.927324295043945 ms
2022-09-24 23:13:56 INFO  ---RUNTIME: Original pipeline execution took 9545.343160629272 ms (excluding imports and monkey-patching)
2022-09-24 23:13:56 INFO  Starting execution of 1 what-if analyses...
2022-09-24 23:13:56 INFO  Start plan generation for analysis PermutationFeatureImportance...
2022-09-24 23:13:56 INFO  ---RUNTIME: Plan generation took 0.12350082397460938 ms
2022-09-24 23:13:56 INFO  Estimated runtime of original DAG is 9185.279130935669ms
2022-09-24 23:13:56 WARNING Skipping Multi-Query Optimization (instead, only applying patches)
2022-09-24 23:13:56 INFO  Estimated unoptimised what-if runtime is 45926.395654678345ms
2022-09-24 23:13:56 INFO  ---RUNTIME: Multi-Query Optimization took 5.576610565185547 ms
2022-09-24 23:13:56 INFO  Executing generated plans
2022-09-24 23:14:42 INFO  ---RUNTIME: Execution took 45815.6373500824 ms
2022-09-24 23:14:42 INFO  Done!
2022-09-24 23:14:42 INFO  # Finished -- repetition 3 of 7 
2022-09-24 23:14:42 INFO  # Optimization benchmark for feature_importance with args [['reviews', 'fast_loading', 'featurization_3', 'logistic_regression']] -- repetition 4 of 7
2022-09-24 23:14:42 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-24 23:14:42 INFO  Running instrumented original pipeline...
2022-09-24 23:14:42 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-24 23:14:42 INFO  ---RUNTIME: Importing and monkey-patching took 6.032705307006836 ms
2022-09-24 23:14:52 INFO  ---RUNTIME: Original pipeline execution took 9552.793025970459 ms (excluding imports and monkey-patching)
2022-09-24 23:14:52 INFO  Starting execution of 1 what-if analyses...
2022-09-24 23:14:52 INFO  Start plan generation for analysis PermutationFeatureImportance...
2022-09-24 23:14:52 INFO  ---RUNTIME: Plan generation took 0.1316070556640625 ms
2022-09-24 23:14:52 INFO  Estimated runtime of original DAG is 9191.913366317749ms
2022-09-24 23:14:52 INFO  Performing Multi-Query Optimization
2022-09-24 23:14:52 INFO  Estimated unoptimized what-if runtime is 45959.566831588745ms
2022-09-24 23:14:52 INFO  Estimated optimised what-if runtime is 12644.784450531006ms
2022-09-24 23:14:52 INFO  Estimated optimisation runtime saving is 33314.78238105774ms
2022-09-24 23:14:52 INFO  ---RUNTIME: Multi-Query Optimization took 12.561559677124023 ms
2022-09-24 23:14:52 INFO  Executing generated plans
2022-09-24 23:15:05 INFO  ---RUNTIME: Execution took 12954.352378845215 ms
2022-09-24 23:15:05 INFO  Done!
2022-09-24 23:15:05 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-24 23:15:05 INFO  Running instrumented original pipeline...
2022-09-24 23:15:05 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-24 23:15:05 INFO  ---RUNTIME: Importing and monkey-patching took 5.691766738891602 ms
2022-09-24 23:15:14 INFO  ---RUNTIME: Original pipeline execution took 9581.609725952148 ms (excluding imports and monkey-patching)
2022-09-24 23:15:14 INFO  Starting execution of 1 what-if analyses...
2022-09-24 23:15:14 INFO  Start plan generation for analysis PermutationFeatureImportance...
2022-09-24 23:15:14 INFO  ---RUNTIME: Plan generation took 0.10085105895996094 ms
2022-09-24 23:15:14 INFO  Estimated runtime of original DAG is 9220.449686050415ms
2022-09-24 23:15:14 WARNING Skipping Multi-Query Optimization (instead, only applying patches)
2022-09-24 23:15:14 INFO  Estimated unoptimised what-if runtime is 46102.248430252075ms
2022-09-24 23:15:14 INFO  ---RUNTIME: Multi-Query Optimization took 9.853363037109375 ms
2022-09-24 23:15:14 INFO  Executing generated plans
2022-09-24 23:16:00 INFO  ---RUNTIME: Execution took 46077.39472389221 ms
2022-09-24 23:16:00 INFO  Done!
2022-09-24 23:16:00 INFO  # Finished -- repetition 4 of 7 
2022-09-24 23:16:00 INFO  # Optimization benchmark for feature_importance with args [['reviews', 'fast_loading', 'featurization_3', 'logistic_regression']] -- repetition 5 of 7
2022-09-24 23:16:00 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-24 23:16:00 INFO  Running instrumented original pipeline...
2022-09-24 23:16:00 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-24 23:16:00 INFO  ---RUNTIME: Importing and monkey-patching took 6.3190460205078125 ms
2022-09-24 23:16:10 INFO  ---RUNTIME: Original pipeline execution took 9569.224119186401 ms (excluding imports and monkey-patching)
2022-09-24 23:16:10 INFO  Starting execution of 1 what-if analyses...
2022-09-24 23:16:10 INFO  Start plan generation for analysis PermutationFeatureImportance...
2022-09-24 23:16:10 INFO  ---RUNTIME: Plan generation took 0.12826919555664062 ms
2022-09-24 23:16:10 INFO  Estimated runtime of original DAG is 9207.757234573364ms
2022-09-24 23:16:10 INFO  Performing Multi-Query Optimization
2022-09-24 23:16:10 INFO  Estimated unoptimized what-if runtime is 46038.78617286682ms
2022-09-24 23:16:10 INFO  Estimated optimised what-if runtime is 12694.80562210083ms
2022-09-24 23:16:10 INFO  Estimated optimisation runtime saving is 33343.98055076599ms
2022-09-24 23:16:10 INFO  ---RUNTIME: Multi-Query Optimization took 12.516021728515625 ms
2022-09-24 23:16:10 INFO  Executing generated plans
2022-09-24 23:16:23 INFO  ---RUNTIME: Execution took 12673.25234413147 ms
2022-09-24 23:16:23 INFO  Done!
2022-09-24 23:16:23 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-24 23:16:23 INFO  Running instrumented original pipeline...
2022-09-24 23:16:23 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-24 23:16:23 INFO  ---RUNTIME: Importing and monkey-patching took 5.944013595581055 ms
2022-09-24 23:16:32 INFO  ---RUNTIME: Original pipeline execution took 9560.066223144531 ms (excluding imports and monkey-patching)
2022-09-24 23:16:32 INFO  Starting execution of 1 what-if analyses...
2022-09-24 23:16:32 INFO  Start plan generation for analysis PermutationFeatureImportance...
2022-09-24 23:16:32 INFO  ---RUNTIME: Plan generation took 0.11920928955078125 ms
2022-09-24 23:16:32 INFO  Estimated runtime of original DAG is 9197.715759277344ms
2022-09-24 23:16:32 WARNING Skipping Multi-Query Optimization (instead, only applying patches)
2022-09-24 23:16:32 INFO  Estimated unoptimised what-if runtime is 45988.57879638672ms
2022-09-24 23:16:32 INFO  ---RUNTIME: Multi-Query Optimization took 4.744052886962891 ms
2022-09-24 23:16:32 INFO  Executing generated plans
2022-09-24 23:17:18 INFO  ---RUNTIME: Execution took 46038.93160820007 ms
2022-09-24 23:17:18 INFO  Done!
2022-09-24 23:17:18 INFO  # Finished -- repetition 5 of 7 
2022-09-24 23:17:18 INFO  # Optimization benchmark for feature_importance with args [['reviews', 'fast_loading', 'featurization_3', 'logistic_regression']] -- repetition 6 of 7
2022-09-24 23:17:18 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-24 23:17:18 INFO  Running instrumented original pipeline...
2022-09-24 23:17:18 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-24 23:17:18 INFO  ---RUNTIME: Importing and monkey-patching took 5.919933319091797 ms
2022-09-24 23:17:28 INFO  ---RUNTIME: Original pipeline execution took 9492.908477783203 ms (excluding imports and monkey-patching)
2022-09-24 23:17:28 INFO  Starting execution of 1 what-if analyses...
2022-09-24 23:17:28 INFO  Start plan generation for analysis PermutationFeatureImportance...
2022-09-24 23:17:28 INFO  ---RUNTIME: Plan generation took 0.12445449829101562 ms
2022-09-24 23:17:28 INFO  Estimated runtime of original DAG is 9131.199359893799ms
2022-09-24 23:17:28 INFO  Performing Multi-Query Optimization
2022-09-24 23:17:28 INFO  Estimated unoptimized what-if runtime is 45655.996799468994ms
2022-09-24 23:17:28 INFO  Estimated optimised what-if runtime is 12560.793399810791ms
2022-09-24 23:17:28 INFO  Estimated optimisation runtime saving is 33095.2033996582ms
2022-09-24 23:17:28 INFO  ---RUNTIME: Multi-Query Optimization took 17.207860946655273 ms
2022-09-24 23:17:28 INFO  Executing generated plans
2022-09-24 23:17:41 INFO  ---RUNTIME: Execution took 12572.171926498413 ms
2022-09-24 23:17:41 INFO  Done!
2022-09-24 23:17:41 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-24 23:17:41 INFO  Running instrumented original pipeline...
2022-09-24 23:17:41 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-24 23:17:41 INFO  ---RUNTIME: Importing and monkey-patching took 5.7926177978515625 ms
2022-09-24 23:17:50 INFO  ---RUNTIME: Original pipeline execution took 9572.10922241211 ms (excluding imports and monkey-patching)
2022-09-24 23:17:50 INFO  Starting execution of 1 what-if analyses...
2022-09-24 23:17:50 INFO  Start plan generation for analysis PermutationFeatureImportance...
2022-09-24 23:17:50 INFO  ---RUNTIME: Plan generation took 0.10967254638671875 ms
2022-09-24 23:17:50 INFO  Estimated runtime of original DAG is 9212.135314941406ms
2022-09-24 23:17:50 WARNING Skipping Multi-Query Optimization (instead, only applying patches)
2022-09-24 23:17:50 INFO  Estimated unoptimised what-if runtime is 46060.67657470703ms
2022-09-24 23:17:50 INFO  ---RUNTIME: Multi-Query Optimization took 4.888772964477539 ms
2022-09-24 23:17:50 INFO  Executing generated plans
2022-09-24 23:18:36 INFO  ---RUNTIME: Execution took 45909.78240966797 ms
2022-09-24 23:18:36 INFO  Done!
2022-09-24 23:18:36 INFO  # Finished -- repetition 6 of 7 
2022-09-24 23:18:36 INFO  # Optimization benchmark for feature_importance with args [['reviews', 'fast_loading', 'featurization_3', 'logistic_regression']] -- repetition 7 of 7
2022-09-24 23:18:36 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-24 23:18:36 INFO  Running instrumented original pipeline...
2022-09-24 23:18:36 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-24 23:18:36 INFO  ---RUNTIME: Importing and monkey-patching took 6.117105484008789 ms
2022-09-24 23:18:46 INFO  ---RUNTIME: Original pipeline execution took 9516.090393066406 ms (excluding imports and monkey-patching)
2022-09-24 23:18:46 INFO  Starting execution of 1 what-if analyses...
2022-09-24 23:18:46 INFO  Start plan generation for analysis PermutationFeatureImportance...
2022-09-24 23:18:46 INFO  ---RUNTIME: Plan generation took 0.11897087097167969 ms
2022-09-24 23:18:46 INFO  Estimated runtime of original DAG is 9153.088331222534ms
2022-09-24 23:18:46 INFO  Performing Multi-Query Optimization
2022-09-24 23:18:46 INFO  Estimated unoptimized what-if runtime is 45765.44165611267ms
2022-09-24 23:18:46 INFO  Estimated optimised what-if runtime is 12609.842777252197ms
2022-09-24 23:18:46 INFO  Estimated optimisation runtime saving is 33155.59887886047ms
2022-09-24 23:18:46 INFO  ---RUNTIME: Multi-Query Optimization took 17.818212509155273 ms
2022-09-24 23:18:46 INFO  Executing generated plans
2022-09-24 23:18:58 INFO  ---RUNTIME: Execution took 12655.028104782104 ms
2022-09-24 23:18:58 INFO  Done!
2022-09-24 23:18:58 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-24 23:18:58 INFO  Running instrumented original pipeline...
2022-09-24 23:18:58 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-24 23:18:58 INFO  ---RUNTIME: Importing and monkey-patching took 5.800008773803711 ms
2022-09-24 23:19:08 INFO  ---RUNTIME: Original pipeline execution took 9557.161331176758 ms (excluding imports and monkey-patching)
2022-09-24 23:19:08 INFO  Starting execution of 1 what-if analyses...
2022-09-24 23:19:08 INFO  Start plan generation for analysis PermutationFeatureImportance...
2022-09-24 23:19:08 INFO  ---RUNTIME: Plan generation took 0.1621246337890625 ms
2022-09-24 23:19:08 INFO  Estimated runtime of original DAG is 9198.565244674683ms
2022-09-24 23:19:08 WARNING Skipping Multi-Query Optimization (instead, only applying patches)
2022-09-24 23:19:08 INFO  Estimated unoptimised what-if runtime is 45992.82622337341ms
2022-09-24 23:19:08 INFO  ---RUNTIME: Multi-Query Optimization took 5.574464797973633 ms
2022-09-24 23:19:08 INFO  Executing generated plans
2022-09-24 23:19:54 INFO  ---RUNTIME: Execution took 45896.23475074768 ms
2022-09-24 23:19:54 INFO  Done!
2022-09-24 23:19:54 INFO  # Finished -- repetition 7 of 7 
2022-09-24 23:19:54 INFO  # Final results after all repetitions
2022-09-24 23:19:54 INFO     repetition  ... no_opt_what_if_execution_combined_model_training
0           0  ...                                       447.850943
1           1  ...                                       444.473743
2           2  ...                                       439.329863
3           3  ...                                       448.400021
4           4  ...                                       462.620497
5           5  ...                                       436.758757
6           6  ...                                       440.079927

[7 rows x 26 columns]
PROTOCOL_BUFFERS_PYTHON_IMPLEMENTATION=python taskset -c 32-39 python3.9 benchmarks_end_to_end.py feature_importance reviews fast_loading featurization_3 xgboost
2022-09-24 23:19:56.804484: W tensorflow/stream_executor/platform/default/dso_loader.cc:64] Could not load dynamic library 'libcudart.so.11.0'; dlerror: libcudart.so.11.0: cannot open shared object file: No such file or directory; LD_LIBRARY_PATH: /home/sgrafbe/mlwhatif/venv/lib/python3.9/site-packages/cv2/../../lib64:
2022-09-24 23:19:56.804533: I tensorflow/stream_executor/cuda/cudart_stub.cc:29] Ignore above cudart dlerror if you do not have a GPU set up on your machine.
2022-09-24 23:19:58 INFO  Patching sys.argv with ['mlwhatif', 'reviews', 'fast_loading', 'featurization_3', 'xgboost']
2022-09-24 23:19:58 INFO  Running instrumented original pipeline...
2022-09-24 23:19:58 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-24 23:19:58 INFO  ---RUNTIME: Importing and monkey-patching took 121.88076972961426 ms
2022-09-24 23:20:41 INFO  ---RUNTIME: Original pipeline execution took 43296.037673950195 ms (excluding imports and monkey-patching)
2022-09-24 23:20:41 INFO  Starting execution of 0 what-if analyses...
2022-09-24 23:20:41 INFO  Estimated runtime of original DAG is 42896.81553840637ms
2022-09-24 23:20:41 INFO  Performing Multi-Query Optimization
2022-09-24 23:20:41 INFO  Estimated unoptimized what-if runtime is 0ms
2022-09-24 23:20:41 INFO  Estimated optimised what-if runtime is 0ms
2022-09-24 23:20:41 INFO  Estimated optimisation runtime saving is 0ms
2022-09-24 23:20:41 INFO  ---RUNTIME: Multi-Query Optimization took 0.5507469177246094 ms
2022-09-24 23:20:41 INFO  Executing generated plans
2022-09-24 23:20:41 INFO  ---RUNTIME: Execution took 0.024080276489257812 ms
2022-09-24 23:20:41 INFO  Done!
2022-09-24 23:20:41 INFO  # Optimization benchmark for feature_importance with args [['reviews', 'fast_loading', 'featurization_3', 'xgboost']] -- repetition 1 of 7
2022-09-24 23:20:41 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-24 23:20:41 INFO  Running instrumented original pipeline...
2022-09-24 23:20:41 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-24 23:20:41 INFO  ---RUNTIME: Importing and monkey-patching took 5.888700485229492 ms
2022-09-24 23:21:25 INFO  ---RUNTIME: Original pipeline execution took 43490.90838432312 ms (excluding imports and monkey-patching)
2022-09-24 23:21:25 INFO  Starting execution of 1 what-if analyses...
2022-09-24 23:21:25 INFO  Start plan generation for analysis PermutationFeatureImportance...
2022-09-24 23:21:25 INFO  ---RUNTIME: Plan generation took 0.2658367156982422 ms
2022-09-24 23:21:25 INFO  Estimated runtime of original DAG is 42936.76209449768ms
2022-09-24 23:21:25 INFO  Performing Multi-Query Optimization
2022-09-24 23:21:25 INFO  Estimated unoptimized what-if runtime is 214683.8104724884ms
2022-09-24 23:21:25 INFO  Estimated optimised what-if runtime is 47749.11117553711ms
2022-09-24 23:21:25 INFO  Estimated optimisation runtime saving is 166934.6992969513ms
2022-09-24 23:21:25 INFO  ---RUNTIME: Multi-Query Optimization took 17.548799514770508 ms
2022-09-24 23:21:25 INFO  Executing generated plans
2022-09-24 23:22:12 INFO  ---RUNTIME: Execution took 47700.87504386902 ms
2022-09-24 23:22:12 INFO  Done!
2022-09-24 23:22:12 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-24 23:22:12 INFO  Running instrumented original pipeline...
2022-09-24 23:22:12 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-24 23:22:12 INFO  ---RUNTIME: Importing and monkey-patching took 6.131887435913086 ms
2022-09-24 23:22:56 INFO  ---RUNTIME: Original pipeline execution took 43390.023946762085 ms (excluding imports and monkey-patching)
2022-09-24 23:22:56 INFO  Starting execution of 1 what-if analyses...
2022-09-24 23:22:56 INFO  Start plan generation for analysis PermutationFeatureImportance...
2022-09-24 23:22:56 INFO  ---RUNTIME: Plan generation took 0.13828277587890625 ms
2022-09-24 23:22:56 INFO  Estimated runtime of original DAG is 43023.25510978699ms
2022-09-24 23:22:56 WARNING Skipping Multi-Query Optimization (instead, only applying patches)
2022-09-24 23:22:56 INFO  Estimated unoptimised what-if runtime is 215116.27554893494ms
2022-09-24 23:22:56 INFO  ---RUNTIME: Multi-Query Optimization took 5.649089813232422 ms
2022-09-24 23:22:56 INFO  Executing generated plans
2022-09-24 23:26:30 INFO  ---RUNTIME: Execution took 214601.09090805054 ms
2022-09-24 23:26:30 INFO  Done!
2022-09-24 23:26:30 INFO  # Finished -- repetition 1 of 7 
2022-09-24 23:26:30 INFO  # Optimization benchmark for feature_importance with args [['reviews', 'fast_loading', 'featurization_3', 'xgboost']] -- repetition 2 of 7
2022-09-24 23:26:30 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-24 23:26:30 INFO  Running instrumented original pipeline...
2022-09-24 23:26:30 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-24 23:26:30 INFO  ---RUNTIME: Importing and monkey-patching took 6.236076354980469 ms
2022-09-24 23:27:14 INFO  ---RUNTIME: Original pipeline execution took 43291.15295410156 ms (excluding imports and monkey-patching)
2022-09-24 23:27:14 INFO  Starting execution of 1 what-if analyses...
2022-09-24 23:27:14 INFO  Start plan generation for analysis PermutationFeatureImportance...
2022-09-24 23:27:14 INFO  ---RUNTIME: Plan generation took 0.1704692840576172 ms
2022-09-24 23:27:14 INFO  Estimated runtime of original DAG is 42930.37462234497ms
2022-09-24 23:27:14 INFO  Performing Multi-Query Optimization
2022-09-24 23:27:14 INFO  Estimated unoptimized what-if runtime is 214651.87311172485ms
2022-09-24 23:27:14 INFO  Estimated optimised what-if runtime is 47730.55696487427ms
2022-09-24 23:27:14 INFO  Estimated optimisation runtime saving is 166921.3161468506ms
2022-09-24 23:27:14 INFO  ---RUNTIME: Multi-Query Optimization took 20.784616470336914 ms
2022-09-24 23:27:14 INFO  Executing generated plans
2022-09-24 23:28:01 INFO  ---RUNTIME: Execution took 47713.97042274475 ms
2022-09-24 23:28:01 INFO  Done!
2022-09-24 23:28:01 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-24 23:28:01 INFO  Running instrumented original pipeline...
2022-09-24 23:28:01 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-24 23:28:01 INFO  ---RUNTIME: Importing and monkey-patching took 6.212711334228516 ms
2022-09-24 23:28:45 INFO  ---RUNTIME: Original pipeline execution took 43304.42929267883 ms (excluding imports and monkey-patching)
2022-09-24 23:28:45 INFO  Starting execution of 1 what-if analyses...
2022-09-24 23:28:45 INFO  Start plan generation for analysis PermutationFeatureImportance...
2022-09-24 23:28:45 INFO  ---RUNTIME: Plan generation took 0.1437664031982422 ms
2022-09-24 23:28:45 INFO  Estimated runtime of original DAG is 42941.09320640564ms
2022-09-24 23:28:45 WARNING Skipping Multi-Query Optimization (instead, only applying patches)
2022-09-24 23:28:45 INFO  Estimated unoptimised what-if runtime is 214705.4660320282ms
2022-09-24 23:28:45 INFO  ---RUNTIME: Multi-Query Optimization took 6.347894668579102 ms
2022-09-24 23:28:45 INFO  Executing generated plans
2022-09-24 23:32:19 INFO  ---RUNTIME: Execution took 214395.97487449646 ms
2022-09-24 23:32:19 INFO  Done!
2022-09-24 23:32:19 INFO  # Finished -- repetition 2 of 7 
2022-09-24 23:32:19 INFO  # Optimization benchmark for feature_importance with args [['reviews', 'fast_loading', 'featurization_3', 'xgboost']] -- repetition 3 of 7
2022-09-24 23:32:19 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-24 23:32:19 INFO  Running instrumented original pipeline...
2022-09-24 23:32:19 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-24 23:32:19 INFO  ---RUNTIME: Importing and monkey-patching took 6.201028823852539 ms
2022-09-24 23:33:02 INFO  ---RUNTIME: Original pipeline execution took 43262.07184791565 ms (excluding imports and monkey-patching)
2022-09-24 23:33:02 INFO  Starting execution of 1 what-if analyses...
2022-09-24 23:33:02 INFO  Start plan generation for analysis PermutationFeatureImportance...
2022-09-24 23:33:02 INFO  ---RUNTIME: Plan generation took 0.1354217529296875 ms
2022-09-24 23:33:02 INFO  Estimated runtime of original DAG is 42898.73552322388ms
2022-09-24 23:33:02 INFO  Performing Multi-Query Optimization
2022-09-24 23:33:02 INFO  Estimated unoptimized what-if runtime is 214493.67761611938ms
2022-09-24 23:33:02 INFO  Estimated optimised what-if runtime is 47676.77712440491ms
2022-09-24 23:33:02 INFO  Estimated optimisation runtime saving is 166816.90049171448ms
2022-09-24 23:33:02 INFO  ---RUNTIME: Multi-Query Optimization took 18.102407455444336 ms
2022-09-24 23:33:02 INFO  Executing generated plans
2022-09-24 23:33:50 INFO  ---RUNTIME: Execution took 47623.329401016235 ms
2022-09-24 23:33:50 INFO  Done!
2022-09-24 23:33:50 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-24 23:33:50 INFO  Running instrumented original pipeline...
2022-09-24 23:33:50 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-24 23:33:50 INFO  ---RUNTIME: Importing and monkey-patching took 6.178140640258789 ms
2022-09-24 23:34:34 INFO  ---RUNTIME: Original pipeline execution took 43518.12553405762 ms (excluding imports and monkey-patching)
2022-09-24 23:34:34 INFO  Starting execution of 1 what-if analyses...
2022-09-24 23:34:34 INFO  Start plan generation for analysis PermutationFeatureImportance...
2022-09-24 23:34:34 INFO  ---RUNTIME: Plan generation took 0.1366138458251953 ms
2022-09-24 23:34:34 INFO  Estimated runtime of original DAG is 43155.399560928345ms
2022-09-24 23:34:34 WARNING Skipping Multi-Query Optimization (instead, only applying patches)
2022-09-24 23:34:34 INFO  Estimated unoptimised what-if runtime is 215776.99780464172ms
2022-09-24 23:34:34 INFO  ---RUNTIME: Multi-Query Optimization took 9.128808975219727 ms
2022-09-24 23:34:34 INFO  Executing generated plans
2022-09-24 23:38:12 INFO  ---RUNTIME: Execution took 218232.7437400818 ms
2022-09-24 23:38:12 INFO  Done!
2022-09-24 23:38:12 INFO  # Finished -- repetition 3 of 7 
2022-09-24 23:38:12 INFO  # Optimization benchmark for feature_importance with args [['reviews', 'fast_loading', 'featurization_3', 'xgboost']] -- repetition 4 of 7
2022-09-24 23:38:12 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-24 23:38:12 INFO  Running instrumented original pipeline...
2022-09-24 23:38:12 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-24 23:38:12 INFO  ---RUNTIME: Importing and monkey-patching took 6.263256072998047 ms
2022-09-24 23:38:56 INFO  ---RUNTIME: Original pipeline execution took 44039.302110672 ms (excluding imports and monkey-patching)
2022-09-24 23:38:56 INFO  Starting execution of 1 what-if analyses...
2022-09-24 23:38:56 INFO  Start plan generation for analysis PermutationFeatureImportance...
2022-09-24 23:38:56 INFO  ---RUNTIME: Plan generation took 0.16880035400390625 ms
2022-09-24 23:38:56 INFO  Estimated runtime of original DAG is 43668.41101646423ms
2022-09-24 23:38:56 INFO  Performing Multi-Query Optimization
2022-09-24 23:38:56 INFO  Estimated unoptimized what-if runtime is 218342.05508232117ms
2022-09-24 23:38:56 INFO  Estimated optimised what-if runtime is 48562.800884246826ms
2022-09-24 23:38:56 INFO  Estimated optimisation runtime saving is 169779.25419807434ms
2022-09-24 23:38:56 INFO  ---RUNTIME: Multi-Query Optimization took 13.195276260375977 ms
2022-09-24 23:38:56 INFO  Executing generated plans
2022-09-24 23:39:45 INFO  ---RUNTIME: Execution took 48742.32721328735 ms
2022-09-24 23:39:45 INFO  Done!
2022-09-24 23:39:45 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-24 23:39:45 INFO  Running instrumented original pipeline...
2022-09-24 23:39:45 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-24 23:39:45 INFO  ---RUNTIME: Importing and monkey-patching took 6.530523300170898 ms
2022-09-24 23:40:29 INFO  ---RUNTIME: Original pipeline execution took 44128.910541534424 ms (excluding imports and monkey-patching)
2022-09-24 23:40:29 INFO  Starting execution of 1 what-if analyses...
2022-09-24 23:40:29 INFO  Start plan generation for analysis PermutationFeatureImportance...
2022-09-24 23:40:29 INFO  ---RUNTIME: Plan generation took 0.11873245239257812 ms
2022-09-24 23:40:29 INFO  Estimated runtime of original DAG is 43761.70015335083ms
2022-09-24 23:40:29 WARNING Skipping Multi-Query Optimization (instead, only applying patches)
2022-09-24 23:40:29 INFO  Estimated unoptimised what-if runtime is 218808.50076675415ms
2022-09-24 23:40:29 INFO  ---RUNTIME: Multi-Query Optimization took 10.181903839111328 ms
2022-09-24 23:40:29 INFO  Executing generated plans
2022-09-24 23:44:06 INFO  ---RUNTIME: Execution took 217633.23664665222 ms
2022-09-24 23:44:06 INFO  Done!
2022-09-24 23:44:07 INFO  # Finished -- repetition 4 of 7 
2022-09-24 23:44:07 INFO  # Optimization benchmark for feature_importance with args [['reviews', 'fast_loading', 'featurization_3', 'xgboost']] -- repetition 5 of 7
2022-09-24 23:44:07 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-24 23:44:07 INFO  Running instrumented original pipeline...
2022-09-24 23:44:07 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-24 23:44:07 INFO  ---RUNTIME: Importing and monkey-patching took 6.89387321472168 ms
2022-09-24 23:44:51 INFO  ---RUNTIME: Original pipeline execution took 43969.81120109558 ms (excluding imports and monkey-patching)
2022-09-24 23:44:51 INFO  Starting execution of 1 what-if analyses...
2022-09-24 23:44:51 INFO  Start plan generation for analysis PermutationFeatureImportance...
2022-09-24 23:44:51 INFO  ---RUNTIME: Plan generation took 0.12874603271484375 ms
2022-09-24 23:44:51 INFO  Estimated runtime of original DAG is 43600.22068023682ms
2022-09-24 23:44:51 INFO  Performing Multi-Query Optimization
2022-09-24 23:44:51 INFO  Estimated unoptimized what-if runtime is 218001.10340118408ms
2022-09-24 23:44:51 INFO  Estimated optimised what-if runtime is 48337.14509010315ms
2022-09-24 23:44:51 INFO  Estimated optimisation runtime saving is 169663.95831108093ms
2022-09-24 23:44:51 INFO  ---RUNTIME: Multi-Query Optimization took 12.994766235351562 ms
2022-09-24 23:44:51 INFO  Executing generated plans
2022-09-24 23:45:39 INFO  ---RUNTIME: Execution took 48566.52545928955 ms
2022-09-24 23:45:39 INFO  Done!
2022-09-24 23:45:39 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-24 23:45:39 INFO  Running instrumented original pipeline...
2022-09-24 23:45:39 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-24 23:45:39 INFO  ---RUNTIME: Importing and monkey-patching took 6.195068359375 ms
2022-09-24 23:46:23 INFO  ---RUNTIME: Original pipeline execution took 44172.33085632324 ms (excluding imports and monkey-patching)
2022-09-24 23:46:23 INFO  Starting execution of 1 what-if analyses...
2022-09-24 23:46:23 INFO  Start plan generation for analysis PermutationFeatureImportance...
2022-09-24 23:46:23 INFO  ---RUNTIME: Plan generation took 0.1342296600341797 ms
2022-09-24 23:46:23 INFO  Estimated runtime of original DAG is 43802.98352241516ms
2022-09-24 23:46:23 WARNING Skipping Multi-Query Optimization (instead, only applying patches)
2022-09-24 23:46:23 INFO  Estimated unoptimised what-if runtime is 219014.9176120758ms
2022-09-24 23:46:23 INFO  ---RUNTIME: Multi-Query Optimization took 5.495309829711914 ms
2022-09-24 23:46:23 INFO  Executing generated plans
2022-09-24 23:50:02 INFO  ---RUNTIME: Execution took 218493.70169639587 ms
2022-09-24 23:50:02 INFO  Done!
2022-09-24 23:50:02 INFO  # Finished -- repetition 5 of 7 
2022-09-24 23:50:02 INFO  # Optimization benchmark for feature_importance with args [['reviews', 'fast_loading', 'featurization_3', 'xgboost']] -- repetition 6 of 7
2022-09-24 23:50:02 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-24 23:50:02 INFO  Running instrumented original pipeline...
2022-09-24 23:50:02 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-24 23:50:02 INFO  ---RUNTIME: Importing and monkey-patching took 7.341861724853516 ms
2022-09-24 23:50:46 INFO  ---RUNTIME: Original pipeline execution took 44306.2047958374 ms (excluding imports and monkey-patching)
2022-09-24 23:50:46 INFO  Starting execution of 1 what-if analyses...
2022-09-24 23:50:46 INFO  Start plan generation for analysis PermutationFeatureImportance...
2022-09-24 23:50:46 INFO  ---RUNTIME: Plan generation took 0.13136863708496094 ms
2022-09-24 23:50:46 INFO  Estimated runtime of original DAG is 43934.90695953369ms
2022-09-24 23:50:46 INFO  Performing Multi-Query Optimization
2022-09-24 23:50:46 INFO  Estimated unoptimized what-if runtime is 219674.53479766846ms
2022-09-24 23:50:46 INFO  Estimated optimised what-if runtime is 48691.54858589172ms
2022-09-24 23:50:46 INFO  Estimated optimisation runtime saving is 170982.98621177673ms
2022-09-24 23:50:46 INFO  ---RUNTIME: Multi-Query Optimization took 14.69564437866211 ms
2022-09-24 23:50:46 INFO  Executing generated plans
2022-09-24 23:51:34 INFO  ---RUNTIME: Execution took 48283.42652320862 ms
2022-09-24 23:51:34 INFO  Done!
2022-09-24 23:51:35 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-24 23:51:35 INFO  Running instrumented original pipeline...
2022-09-24 23:51:35 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-24 23:51:35 INFO  ---RUNTIME: Importing and monkey-patching took 6.170749664306641 ms
2022-09-24 23:52:18 INFO  ---RUNTIME: Original pipeline execution took 43902.08649635315 ms (excluding imports and monkey-patching)
2022-09-24 23:52:18 INFO  Starting execution of 1 what-if analyses...
2022-09-24 23:52:18 INFO  Start plan generation for analysis PermutationFeatureImportance...
2022-09-24 23:52:18 INFO  ---RUNTIME: Plan generation took 0.1347064971923828 ms
2022-09-24 23:52:18 INFO  Estimated runtime of original DAG is 43540.71927070618ms
2022-09-24 23:52:18 WARNING Skipping Multi-Query Optimization (instead, only applying patches)
2022-09-24 23:52:18 INFO  Estimated unoptimised what-if runtime is 217703.59635353088ms
2022-09-24 23:52:18 INFO  ---RUNTIME: Multi-Query Optimization took 6.7424774169921875 ms
2022-09-24 23:52:18 INFO  Executing generated plans
2022-09-24 23:55:55 INFO  ---RUNTIME: Execution took 216948.18830490112 ms
2022-09-24 23:55:55 INFO  Done!
2022-09-24 23:55:55 INFO  # Finished -- repetition 6 of 7 
2022-09-24 23:55:55 INFO  # Optimization benchmark for feature_importance with args [['reviews', 'fast_loading', 'featurization_3', 'xgboost']] -- repetition 7 of 7
2022-09-24 23:55:55 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-24 23:55:55 INFO  Running instrumented original pipeline...
2022-09-24 23:55:55 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-24 23:55:55 INFO  ---RUNTIME: Importing and monkey-patching took 6.122350692749023 ms
2022-09-24 23:56:39 INFO  ---RUNTIME: Original pipeline execution took 43144.82402801514 ms (excluding imports and monkey-patching)
2022-09-24 23:56:39 INFO  Starting execution of 1 what-if analyses...
2022-09-24 23:56:39 INFO  Start plan generation for analysis PermutationFeatureImportance...
2022-09-24 23:56:39 INFO  ---RUNTIME: Plan generation took 0.12612342834472656 ms
2022-09-24 23:56:39 INFO  Estimated runtime of original DAG is 42788.13195228577ms
2022-09-24 23:56:39 INFO  Performing Multi-Query Optimization
2022-09-24 23:56:39 INFO  Estimated unoptimized what-if runtime is 213940.65976142883ms
2022-09-24 23:56:39 INFO  Estimated optimised what-if runtime is 47581.69174194336ms
2022-09-24 23:56:39 INFO  Estimated optimisation runtime saving is 166358.96801948547ms
2022-09-24 23:56:39 INFO  ---RUNTIME: Multi-Query Optimization took 17.8372859954834 ms
2022-09-24 23:56:39 INFO  Executing generated plans
2022-09-24 23:57:26 INFO  ---RUNTIME: Execution took 47597.18179702759 ms
2022-09-24 23:57:26 INFO  Done!
2022-09-24 23:57:26 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-24 23:57:26 INFO  Running instrumented original pipeline...
2022-09-24 23:57:26 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-24 23:57:26 INFO  ---RUNTIME: Importing and monkey-patching took 6.546497344970703 ms
2022-09-24 23:58:10 INFO  ---RUNTIME: Original pipeline execution took 43411.805629730225 ms (excluding imports and monkey-patching)
2022-09-24 23:58:10 INFO  Starting execution of 1 what-if analyses...
2022-09-24 23:58:10 INFO  Start plan generation for analysis PermutationFeatureImportance...
2022-09-24 23:58:10 INFO  ---RUNTIME: Plan generation took 0.12421607971191406 ms
2022-09-24 23:58:10 INFO  Estimated runtime of original DAG is 43056.09750747681ms
2022-09-24 23:58:10 WARNING Skipping Multi-Query Optimization (instead, only applying patches)
2022-09-24 23:58:10 INFO  Estimated unoptimised what-if runtime is 215280.48753738403ms
2022-09-24 23:58:10 INFO  ---RUNTIME: Multi-Query Optimization took 5.401849746704102 ms
2022-09-24 23:58:10 INFO  Executing generated plans
2022-09-25 00:01:44 INFO  ---RUNTIME: Execution took 214657.5117111206 ms
2022-09-25 00:01:44 INFO  Done!
2022-09-25 00:01:44 INFO  # Finished -- repetition 7 of 7 
2022-09-25 00:01:44 INFO  # Final results after all repetitions
2022-09-25 00:01:44 INFO     repetition  ... no_opt_what_if_execution_combined_model_training
0           0  ...                                    167526.599407
1           1  ...                                    167378.334045
2           2  ...                                    170114.949942
3           3  ...                                    169642.945766
4           4  ...                                    169982.426882
5           5  ...                                    169091.374874
6           6  ...                                    167395.542622

[7 rows x 26 columns]
PROTOCOL_BUFFERS_PYTHON_IMPLEMENTATION=python taskset -c 32-39 python3.9 benchmarks_end_to_end.py feature_importance reviews fast_loading featurization_3 neural_network
2022-09-25 00:01:47.174012: W tensorflow/stream_executor/platform/default/dso_loader.cc:64] Could not load dynamic library 'libcudart.so.11.0'; dlerror: libcudart.so.11.0: cannot open shared object file: No such file or directory; LD_LIBRARY_PATH: /home/sgrafbe/mlwhatif/venv/lib/python3.9/site-packages/cv2/../../lib64:
2022-09-25 00:01:47.174058: I tensorflow/stream_executor/cuda/cudart_stub.cc:29] Ignore above cudart dlerror if you do not have a GPU set up on your machine.
2022-09-25 00:01:48 INFO  Patching sys.argv with ['mlwhatif', 'reviews', 'fast_loading', 'featurization_3', 'neural_network']
2022-09-25 00:01:48 INFO  Running instrumented original pipeline...
2022-09-25 00:01:48 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-25 00:01:48 INFO  ---RUNTIME: Importing and monkey-patching took 121.46663665771484 ms
2022-09-25 00:01:54.814381: W tensorflow/stream_executor/platform/default/dso_loader.cc:64] Could not load dynamic library 'libcuda.so.1'; dlerror: libcuda.so.1: cannot open shared object file: No such file or directory; LD_LIBRARY_PATH: /home/sgrafbe/mlwhatif/venv/lib/python3.9/site-packages/cv2/../../lib64:
2022-09-25 00:01:54.814422: W tensorflow/stream_executor/cuda/cuda_driver.cc:326] failed call to cuInit: UNKNOWN ERROR (303)
2022-09-25 00:01:54.814444: I tensorflow/stream_executor/cuda/cuda_diagnostics.cc:156] kernel driver does not appear to be running on this host (angus): /proc/driver/nvidia/version does not exist
2022-09-25 00:01:54.814925: I tensorflow/core/platform/cpu_feature_guard.cc:142] This TensorFlow binary is optimized with oneAPI Deep Neural Network Library (oneDNN) to use the following CPU instructions in performance-critical operations:  AVX2 FMA
To enable them in other operations, rebuild TensorFlow with the appropriate compiler flags.
2022-09-25 00:01:55.422263: I tensorflow/compiler/mlir/mlir_graph_optimization_pass.cc:176] None of the MLIR Optimization Passes are enabled (registered 2)
2022-09-25 00:01:55.436180: I tensorflow/core/platform/profile_utils/cpu_utils.cc:114] CPU Frequency: 2595130000 Hz
2022-09-25 00:02:05 INFO  ---RUNTIME: Original pipeline execution took 16582.499742507935 ms (excluding imports and monkey-patching)
2022-09-25 00:02:05 INFO  Starting execution of 0 what-if analyses...
2022-09-25 00:02:05 INFO  Estimated runtime of original DAG is 16202.216625213623ms
2022-09-25 00:02:05 INFO  Performing Multi-Query Optimization
2022-09-25 00:02:05 INFO  Estimated unoptimized what-if runtime is 0ms
2022-09-25 00:02:05 INFO  Estimated optimised what-if runtime is 0ms
2022-09-25 00:02:05 INFO  Estimated optimisation runtime saving is 0ms
2022-09-25 00:02:05 INFO  ---RUNTIME: Multi-Query Optimization took 0.5381107330322266 ms
2022-09-25 00:02:05 INFO  Executing generated plans
2022-09-25 00:02:05 INFO  ---RUNTIME: Execution took 0.021457672119140625 ms
2022-09-25 00:02:05 INFO  Done!
2022-09-25 00:02:05 INFO  # Optimization benchmark for feature_importance with args [['reviews', 'fast_loading', 'featurization_3', 'neural_network']] -- repetition 1 of 7
2022-09-25 00:02:05 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-25 00:02:05 INFO  Running instrumented original pipeline...
2022-09-25 00:02:05 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-25 00:02:05 INFO  ---RUNTIME: Importing and monkey-patching took 5.362510681152344 ms
2022-09-25 00:02:21 INFO  ---RUNTIME: Original pipeline execution took 16109.05122756958 ms (excluding imports and monkey-patching)
2022-09-25 00:02:21 INFO  Starting execution of 1 what-if analyses...
2022-09-25 00:02:21 INFO  Start plan generation for analysis PermutationFeatureImportance...
2022-09-25 00:02:21 INFO  ---RUNTIME: Plan generation took 0.25773048400878906 ms
2022-09-25 00:02:21 INFO  Estimated runtime of original DAG is 15748.000383377075ms
2022-09-25 00:02:21 INFO  Performing Multi-Query Optimization
2022-09-25 00:02:21 INFO  Estimated unoptimized what-if runtime is 78740.00191688538ms
2022-09-25 00:02:21 INFO  Estimated optimised what-if runtime is 22308.24089050293ms
2022-09-25 00:02:21 INFO  Estimated optimisation runtime saving is 56431.761026382446ms
2022-09-25 00:02:21 INFO  ---RUNTIME: Multi-Query Optimization took 18.28789710998535 ms
2022-09-25 00:02:21 INFO  Executing generated plans
2022-09-25 00:02:43 INFO  ---RUNTIME: Execution took 21809.70287322998 ms
2022-09-25 00:02:43 INFO  Done!
2022-09-25 00:02:43 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-25 00:02:43 INFO  Running instrumented original pipeline...
2022-09-25 00:02:43 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-25 00:02:43 INFO  ---RUNTIME: Importing and monkey-patching took 6.259918212890625 ms
2022-09-25 00:02:59 INFO  ---RUNTIME: Original pipeline execution took 16389.429807662964 ms (excluding imports and monkey-patching)
2022-09-25 00:02:59 INFO  Starting execution of 1 what-if analyses...
2022-09-25 00:02:59 INFO  Start plan generation for analysis PermutationFeatureImportance...
2022-09-25 00:02:59 INFO  ---RUNTIME: Plan generation took 0.13017654418945312 ms
2022-09-25 00:02:59 INFO  Estimated runtime of original DAG is 16040.66801071167ms
2022-09-25 00:02:59 WARNING Skipping Multi-Query Optimization (instead, only applying patches)
2022-09-25 00:02:59 INFO  Estimated unoptimised what-if runtime is 80203.34005355835ms
2022-09-25 00:02:59 INFO  ---RUNTIME: Multi-Query Optimization took 10.682344436645508 ms
2022-09-25 00:02:59 INFO  Executing generated plans
2022-09-25 00:04:19 INFO  ---RUNTIME: Execution took 79669.21043395996 ms
2022-09-25 00:04:19 INFO  Done!
2022-09-25 00:04:19 INFO  # Finished -- repetition 1 of 7 
2022-09-25 00:04:19 INFO  # Optimization benchmark for feature_importance with args [['reviews', 'fast_loading', 'featurization_3', 'neural_network']] -- repetition 2 of 7
2022-09-25 00:04:19 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-25 00:04:19 INFO  Running instrumented original pipeline...
2022-09-25 00:04:19 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-25 00:04:19 INFO  ---RUNTIME: Importing and monkey-patching took 5.898714065551758 ms
2022-09-25 00:04:35 INFO  ---RUNTIME: Original pipeline execution took 16044.745206832886 ms (excluding imports and monkey-patching)
2022-09-25 00:04:35 INFO  Starting execution of 1 what-if analyses...
2022-09-25 00:04:35 INFO  Start plan generation for analysis PermutationFeatureImportance...
2022-09-25 00:04:35 INFO  ---RUNTIME: Plan generation took 0.1404285430908203 ms
2022-09-25 00:04:35 INFO  Estimated runtime of original DAG is 15697.101831436157ms
2022-09-25 00:04:35 INFO  Performing Multi-Query Optimization
2022-09-25 00:04:35 INFO  Estimated unoptimized what-if runtime is 78485.50915718079ms
2022-09-25 00:04:35 INFO  Estimated optimised what-if runtime is 22295.7661151886ms
2022-09-25 00:04:35 INFO  Estimated optimisation runtime saving is 56189.74304199219ms
2022-09-25 00:04:35 INFO  ---RUNTIME: Multi-Query Optimization took 12.523651123046875 ms
2022-09-25 00:04:35 INFO  Executing generated plans
2022-09-25 00:04:57 INFO  ---RUNTIME: Execution took 21794.824361801147 ms
2022-09-25 00:04:57 INFO  Done!
2022-09-25 00:04:57 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-25 00:04:57 INFO  Running instrumented original pipeline...
2022-09-25 00:04:57 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-25 00:04:57 INFO  ---RUNTIME: Importing and monkey-patching took 5.633115768432617 ms
2022-09-25 00:05:13 INFO  ---RUNTIME: Original pipeline execution took 16161.27896308899 ms (excluding imports and monkey-patching)
2022-09-25 00:05:13 INFO  Starting execution of 1 what-if analyses...
2022-09-25 00:05:13 INFO  Start plan generation for analysis PermutationFeatureImportance...
2022-09-25 00:05:13 INFO  ---RUNTIME: Plan generation took 0.1201629638671875 ms
2022-09-25 00:05:13 INFO  Estimated runtime of original DAG is 15810.059785842896ms
2022-09-25 00:05:13 WARNING Skipping Multi-Query Optimization (instead, only applying patches)
2022-09-25 00:05:13 INFO  Estimated unoptimised what-if runtime is 79050.29892921448ms
2022-09-25 00:05:13 INFO  ---RUNTIME: Multi-Query Optimization took 4.755973815917969 ms
2022-09-25 00:05:13 INFO  Executing generated plans
2022-09-25 00:06:33 INFO  ---RUNTIME: Execution took 79785.61234474182 ms
2022-09-25 00:06:33 INFO  Done!
2022-09-25 00:06:33 INFO  # Finished -- repetition 2 of 7 
2022-09-25 00:06:33 INFO  # Optimization benchmark for feature_importance with args [['reviews', 'fast_loading', 'featurization_3', 'neural_network']] -- repetition 3 of 7
2022-09-25 00:06:33 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-25 00:06:33 INFO  Running instrumented original pipeline...
2022-09-25 00:06:33 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-25 00:06:33 INFO  ---RUNTIME: Importing and monkey-patching took 6.453752517700195 ms
2022-09-25 00:06:49 INFO  ---RUNTIME: Original pipeline execution took 16210.319519042969 ms (excluding imports and monkey-patching)
2022-09-25 00:06:49 INFO  Starting execution of 1 what-if analyses...
2022-09-25 00:06:49 INFO  Start plan generation for analysis PermutationFeatureImportance...
2022-09-25 00:06:49 INFO  ---RUNTIME: Plan generation took 0.1323223114013672 ms
2022-09-25 00:06:49 INFO  Estimated runtime of original DAG is 15853.55806350708ms
2022-09-25 00:06:49 INFO  Performing Multi-Query Optimization
2022-09-25 00:06:49 INFO  Estimated unoptimized what-if runtime is 79267.7903175354ms
2022-09-25 00:06:49 INFO  Estimated optimised what-if runtime is 22607.819318771362ms
2022-09-25 00:06:49 INFO  Estimated optimisation runtime saving is 56659.97099876404ms
2022-09-25 00:06:49 INFO  ---RUNTIME: Multi-Query Optimization took 12.22085952758789 ms
2022-09-25 00:06:49 INFO  Executing generated plans
2022-09-25 00:07:12 INFO  ---RUNTIME: Execution took 22679.829597473145 ms
2022-09-25 00:07:12 INFO  Done!
2022-09-25 00:07:12 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-25 00:07:12 INFO  Running instrumented original pipeline...
2022-09-25 00:07:12 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-25 00:07:12 INFO  ---RUNTIME: Importing and monkey-patching took 5.9909820556640625 ms
2022-09-25 00:07:28 INFO  ---RUNTIME: Original pipeline execution took 16296.01001739502 ms (excluding imports and monkey-patching)
2022-09-25 00:07:28 INFO  Starting execution of 1 what-if analyses...
2022-09-25 00:07:28 INFO  Start plan generation for analysis PermutationFeatureImportance...
2022-09-25 00:07:28 INFO  ---RUNTIME: Plan generation took 0.13518333435058594 ms
2022-09-25 00:07:28 INFO  Estimated runtime of original DAG is 15948.571920394897ms
2022-09-25 00:07:28 WARNING Skipping Multi-Query Optimization (instead, only applying patches)
2022-09-25 00:07:28 INFO  Estimated unoptimised what-if runtime is 79742.85960197449ms
2022-09-25 00:07:28 INFO  ---RUNTIME: Multi-Query Optimization took 4.7588348388671875 ms
2022-09-25 00:07:28 INFO  Executing generated plans
2022-09-25 00:08:48 INFO  ---RUNTIME: Execution took 79700.17290115356 ms
2022-09-25 00:08:48 INFO  Done!
2022-09-25 00:08:48 INFO  # Finished -- repetition 3 of 7 
2022-09-25 00:08:48 INFO  # Optimization benchmark for feature_importance with args [['reviews', 'fast_loading', 'featurization_3', 'neural_network']] -- repetition 4 of 7
2022-09-25 00:08:48 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-25 00:08:48 INFO  Running instrumented original pipeline...
2022-09-25 00:08:48 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-25 00:08:48 INFO  ---RUNTIME: Importing and monkey-patching took 6.16765022277832 ms
2022-09-25 00:09:04 INFO  ---RUNTIME: Original pipeline execution took 16438.86923789978 ms (excluding imports and monkey-patching)
2022-09-25 00:09:04 INFO  Starting execution of 1 what-if analyses...
2022-09-25 00:09:04 INFO  Start plan generation for analysis PermutationFeatureImportance...
2022-09-25 00:09:04 INFO  ---RUNTIME: Plan generation took 0.13780593872070312 ms
2022-09-25 00:09:04 INFO  Estimated runtime of original DAG is 16084.835052490234ms
2022-09-25 00:09:04 INFO  Performing Multi-Query Optimization
2022-09-25 00:09:04 INFO  Estimated unoptimized what-if runtime is 80424.17526245117ms
2022-09-25 00:09:04 INFO  Estimated optimised what-if runtime is 22542.776584625244ms
2022-09-25 00:09:04 INFO  Estimated optimisation runtime saving is 57881.39867782593ms
2022-09-25 00:09:04 INFO  ---RUNTIME: Multi-Query Optimization took 12.369632720947266 ms
2022-09-25 00:09:04 INFO  Executing generated plans
2022-09-25 00:09:26 INFO  ---RUNTIME: Execution took 21912.865161895752 ms
2022-09-25 00:09:26 INFO  Done!
2022-09-25 00:09:26 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-25 00:09:26 INFO  Running instrumented original pipeline...
2022-09-25 00:09:26 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-25 00:09:26 INFO  ---RUNTIME: Importing and monkey-patching took 5.992412567138672 ms
2022-09-25 00:09:42 INFO  ---RUNTIME: Original pipeline execution took 16136.818885803223 ms (excluding imports and monkey-patching)
2022-09-25 00:09:42 INFO  Starting execution of 1 what-if analyses...
2022-09-25 00:09:42 INFO  Start plan generation for analysis PermutationFeatureImportance...
2022-09-25 00:09:42 INFO  ---RUNTIME: Plan generation took 0.10251998901367188 ms
2022-09-25 00:09:42 INFO  Estimated runtime of original DAG is 15775.77829360962ms
2022-09-25 00:09:42 WARNING Skipping Multi-Query Optimization (instead, only applying patches)
2022-09-25 00:09:42 INFO  Estimated unoptimised what-if runtime is 78878.8914680481ms
2022-09-25 00:09:42 INFO  ---RUNTIME: Multi-Query Optimization took 4.725217819213867 ms
2022-09-25 00:09:42 INFO  Executing generated plans
2022-09-25 00:11:02 INFO  ---RUNTIME: Execution took 80103.84368896484 ms
2022-09-25 00:11:02 INFO  Done!
2022-09-25 00:11:02 INFO  # Finished -- repetition 4 of 7 
2022-09-25 00:11:02 INFO  # Optimization benchmark for feature_importance with args [['reviews', 'fast_loading', 'featurization_3', 'neural_network']] -- repetition 5 of 7
2022-09-25 00:11:02 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-25 00:11:02 INFO  Running instrumented original pipeline...
2022-09-25 00:11:02 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-25 00:11:02 INFO  ---RUNTIME: Importing and monkey-patching took 6.067752838134766 ms
2022-09-25 00:11:19 INFO  ---RUNTIME: Original pipeline execution took 16350.96526145935 ms (excluding imports and monkey-patching)
2022-09-25 00:11:19 INFO  Starting execution of 1 what-if analyses...
2022-09-25 00:11:19 INFO  Start plan generation for analysis PermutationFeatureImportance...
2022-09-25 00:11:19 INFO  ---RUNTIME: Plan generation took 0.12683868408203125 ms
2022-09-25 00:11:19 INFO  Estimated runtime of original DAG is 15986.969947814941ms
2022-09-25 00:11:19 INFO  Performing Multi-Query Optimization
2022-09-25 00:11:19 INFO  Estimated unoptimized what-if runtime is 79934.8497390747ms
2022-09-25 00:11:19 INFO  Estimated optimised what-if runtime is 22590.03257751465ms
2022-09-25 00:11:19 INFO  Estimated optimisation runtime saving is 57344.81716156006ms
2022-09-25 00:11:19 INFO  ---RUNTIME: Multi-Query Optimization took 18.555402755737305 ms
2022-09-25 00:11:19 INFO  Executing generated plans
2022-09-25 00:11:41 INFO  ---RUNTIME: Execution took 22328.123092651367 ms
2022-09-25 00:11:41 INFO  Done!
2022-09-25 00:11:41 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-25 00:11:41 INFO  Running instrumented original pipeline...
2022-09-25 00:11:42 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-25 00:11:42 INFO  ---RUNTIME: Importing and monkey-patching took 6.05463981628418 ms
2022-09-25 00:11:58 INFO  ---RUNTIME: Original pipeline execution took 16978.92951965332 ms (excluding imports and monkey-patching)
2022-09-25 00:11:58 INFO  Starting execution of 1 what-if analyses...
2022-09-25 00:11:58 INFO  Start plan generation for analysis PermutationFeatureImportance...
2022-09-25 00:11:58 INFO  ---RUNTIME: Plan generation took 0.11086463928222656 ms
2022-09-25 00:11:58 INFO  Estimated runtime of original DAG is 16114.61591720581ms
2022-09-25 00:11:58 WARNING Skipping Multi-Query Optimization (instead, only applying patches)
2022-09-25 00:11:58 INFO  Estimated unoptimised what-if runtime is 80573.07958602905ms
2022-09-25 00:11:58 INFO  ---RUNTIME: Multi-Query Optimization took 4.559040069580078 ms
2022-09-25 00:11:58 INFO  Executing generated plans
2022-09-25 00:13:18 INFO  ---RUNTIME: Execution took 79953.65619659424 ms
2022-09-25 00:13:18 INFO  Done!
2022-09-25 00:13:18 INFO  # Finished -- repetition 5 of 7 
2022-09-25 00:13:18 INFO  # Optimization benchmark for feature_importance with args [['reviews', 'fast_loading', 'featurization_3', 'neural_network']] -- repetition 6 of 7
2022-09-25 00:13:18 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-25 00:13:18 INFO  Running instrumented original pipeline...
2022-09-25 00:13:18 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-25 00:13:18 INFO  ---RUNTIME: Importing and monkey-patching took 6.177425384521484 ms
2022-09-25 00:13:34 INFO  ---RUNTIME: Original pipeline execution took 16293.395280838013 ms (excluding imports and monkey-patching)
2022-09-25 00:13:34 INFO  Starting execution of 1 what-if analyses...
2022-09-25 00:13:34 INFO  Start plan generation for analysis PermutationFeatureImportance...
2022-09-25 00:13:34 INFO  ---RUNTIME: Plan generation took 0.1068115234375 ms
2022-09-25 00:13:34 INFO  Estimated runtime of original DAG is 15924.05366897583ms
2022-09-25 00:13:34 INFO  Performing Multi-Query Optimization
2022-09-25 00:13:34 INFO  Estimated unoptimized what-if runtime is 79620.26834487915ms
2022-09-25 00:13:34 INFO  Estimated optimised what-if runtime is 22381.906032562256ms
2022-09-25 00:13:34 INFO  Estimated optimisation runtime saving is 57238.362312316895ms
2022-09-25 00:13:34 INFO  ---RUNTIME: Multi-Query Optimization took 19.5314884185791 ms
2022-09-25 00:13:34 INFO  Executing generated plans
2022-09-25 00:13:57 INFO  ---RUNTIME: Execution took 22335.921049118042 ms
2022-09-25 00:13:57 INFO  Done!
2022-09-25 00:13:57 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-25 00:13:57 INFO  Running instrumented original pipeline...
2022-09-25 00:13:57 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-25 00:13:57 INFO  ---RUNTIME: Importing and monkey-patching took 5.776882171630859 ms
2022-09-25 00:14:13 INFO  ---RUNTIME: Original pipeline execution took 16262.44831085205 ms (excluding imports and monkey-patching)
2022-09-25 00:14:13 INFO  Starting execution of 1 what-if analyses...
2022-09-25 00:14:13 INFO  Start plan generation for analysis PermutationFeatureImportance...
2022-09-25 00:14:13 INFO  ---RUNTIME: Plan generation took 0.10657310485839844 ms
2022-09-25 00:14:13 INFO  Estimated runtime of original DAG is 15898.322582244873ms
2022-09-25 00:14:13 WARNING Skipping Multi-Query Optimization (instead, only applying patches)
2022-09-25 00:14:13 INFO  Estimated unoptimised what-if runtime is 79491.61291122437ms
2022-09-25 00:14:13 INFO  ---RUNTIME: Multi-Query Optimization took 4.777669906616211 ms
2022-09-25 00:14:13 INFO  Executing generated plans
2022-09-25 00:15:33 INFO  ---RUNTIME: Execution took 80063.71068954468 ms
2022-09-25 00:15:33 INFO  Done!
2022-09-25 00:15:33 INFO  # Finished -- repetition 6 of 7 
2022-09-25 00:15:33 INFO  # Optimization benchmark for feature_importance with args [['reviews', 'fast_loading', 'featurization_3', 'neural_network']] -- repetition 7 of 7
2022-09-25 00:15:33 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-25 00:15:33 INFO  Running instrumented original pipeline...
2022-09-25 00:15:33 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-25 00:15:33 INFO  ---RUNTIME: Importing and monkey-patching took 6.114721298217773 ms
2022-09-25 00:15:49 INFO  ---RUNTIME: Original pipeline execution took 16257.326602935791 ms (excluding imports and monkey-patching)
2022-09-25 00:15:49 INFO  Starting execution of 1 what-if analyses...
2022-09-25 00:15:49 INFO  Start plan generation for analysis PermutationFeatureImportance...
2022-09-25 00:15:49 INFO  ---RUNTIME: Plan generation took 0.10728836059570312 ms
2022-09-25 00:15:49 INFO  Estimated runtime of original DAG is 15858.633041381836ms
2022-09-25 00:15:49 INFO  Performing Multi-Query Optimization
2022-09-25 00:15:49 INFO  Estimated unoptimized what-if runtime is 79293.16520690918ms
2022-09-25 00:15:49 INFO  Estimated optimised what-if runtime is 22547.80149459839ms
2022-09-25 00:15:49 INFO  Estimated optimisation runtime saving is 56745.36371231079ms
2022-09-25 00:15:49 INFO  ---RUNTIME: Multi-Query Optimization took 12.02249526977539 ms
2022-09-25 00:15:49 INFO  Executing generated plans
2022-09-25 00:16:12 INFO  ---RUNTIME: Execution took 22346.071481704712 ms
2022-09-25 00:16:12 INFO  Done!
2022-09-25 00:16:12 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-25 00:16:12 INFO  Running instrumented original pipeline...
2022-09-25 00:16:12 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-25 00:16:12 INFO  ---RUNTIME: Importing and monkey-patching took 5.693197250366211 ms
2022-09-25 00:16:28 INFO  ---RUNTIME: Original pipeline execution took 16228.941440582275 ms (excluding imports and monkey-patching)
2022-09-25 00:16:28 INFO  Starting execution of 1 what-if analyses...
2022-09-25 00:16:28 INFO  Start plan generation for analysis PermutationFeatureImportance...
2022-09-25 00:16:28 INFO  ---RUNTIME: Plan generation took 0.14662742614746094 ms
2022-09-25 00:16:28 INFO  Estimated runtime of original DAG is 15867.03610420227ms
2022-09-25 00:16:28 WARNING Skipping Multi-Query Optimization (instead, only applying patches)
2022-09-25 00:16:28 INFO  Estimated unoptimised what-if runtime is 79335.18052101135ms
2022-09-25 00:16:28 INFO  ---RUNTIME: Multi-Query Optimization took 4.7664642333984375 ms
2022-09-25 00:16:28 INFO  Executing generated plans
2022-09-25 00:17:48 INFO  ---RUNTIME: Execution took 80205.0302028656 ms
2022-09-25 00:17:48 INFO  Done!
2022-09-25 00:17:48 INFO  # Finished -- repetition 7 of 7 
2022-09-25 00:17:48 INFO  # Final results after all repetitions
2022-09-25 00:17:48 INFO     repetition  ... no_opt_what_if_execution_combined_model_training
0           0  ...                                     29734.947681
1           1  ...                                     29802.677393
2           2  ...                                     29875.583649
3           3  ...                                     29601.597786
4           4  ...                                     29477.891684
5           5  ...                                     30025.236845
6           6  ...                                     30017.684698

[7 rows x 26 columns]
PROTOCOL_BUFFERS_PYTHON_IMPLEMENTATION=python taskset -c 32-39 python3.9 benchmarks_end_to_end.py feature_importance reviews fast_loading featurization_4 logistic_regression
2022-09-25 00:17:51.715525: W tensorflow/stream_executor/platform/default/dso_loader.cc:64] Could not load dynamic library 'libcudart.so.11.0'; dlerror: libcudart.so.11.0: cannot open shared object file: No such file or directory; LD_LIBRARY_PATH: /home/sgrafbe/mlwhatif/venv/lib/python3.9/site-packages/cv2/../../lib64:
2022-09-25 00:17:51.715572: I tensorflow/stream_executor/cuda/cudart_stub.cc:29] Ignore above cudart dlerror if you do not have a GPU set up on your machine.
2022-09-25 00:17:53 INFO  Patching sys.argv with ['mlwhatif', 'reviews', 'fast_loading', 'featurization_4', 'logistic_regression']
2022-09-25 00:17:53 INFO  Running instrumented original pipeline...
2022-09-25 00:17:53 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-25 00:17:53 INFO  ---RUNTIME: Importing and monkey-patching took 122.81346321105957 ms
2022-09-25 00:18:03 INFO  ---RUNTIME: Original pipeline execution took 9938.813924789429 ms (excluding imports and monkey-patching)
2022-09-25 00:18:03 INFO  Starting execution of 0 what-if analyses...
2022-09-25 00:18:03 INFO  Estimated runtime of original DAG is 9579.925298690796ms
2022-09-25 00:18:03 INFO  Performing Multi-Query Optimization
2022-09-25 00:18:03 INFO  Estimated unoptimized what-if runtime is 0ms
2022-09-25 00:18:03 INFO  Estimated optimised what-if runtime is 0ms
2022-09-25 00:18:03 INFO  Estimated optimisation runtime saving is 0ms
2022-09-25 00:18:03 INFO  ---RUNTIME: Multi-Query Optimization took 0.5450248718261719 ms
2022-09-25 00:18:03 INFO  Executing generated plans
2022-09-25 00:18:03 INFO  ---RUNTIME: Execution took 0.030755996704101562 ms
2022-09-25 00:18:03 INFO  Done!
2022-09-25 00:18:03 INFO  # Optimization benchmark for feature_importance with args [['reviews', 'fast_loading', 'featurization_4', 'logistic_regression']] -- repetition 1 of 7
2022-09-25 00:18:03 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-25 00:18:03 INFO  Running instrumented original pipeline...
2022-09-25 00:18:03 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-25 00:18:03 INFO  ---RUNTIME: Importing and monkey-patching took 5.408287048339844 ms
2022-09-25 00:18:12 INFO  ---RUNTIME: Original pipeline execution took 9700.206995010376 ms (excluding imports and monkey-patching)
2022-09-25 00:18:12 INFO  Starting execution of 1 what-if analyses...
2022-09-25 00:18:12 INFO  Start plan generation for analysis PermutationFeatureImportance...
2022-09-25 00:18:12 INFO  ---RUNTIME: Plan generation took 0.21266937255859375 ms
2022-09-25 00:18:12 INFO  Estimated runtime of original DAG is 9368.730783462524ms
2022-09-25 00:18:12 INFO  Performing Multi-Query Optimization
2022-09-25 00:18:12 INFO  Estimated unoptimized what-if runtime is 46843.65391731262ms
2022-09-25 00:18:12 INFO  Estimated optimised what-if runtime is 9577.691555023193ms
2022-09-25 00:18:12 INFO  Estimated optimisation runtime saving is 37265.96236228943ms
2022-09-25 00:18:12 INFO  ---RUNTIME: Multi-Query Optimization took 11.445999145507812 ms
2022-09-25 00:18:12 INFO  Executing generated plans
2022-09-25 00:18:22 INFO  ---RUNTIME: Execution took 9573.845624923706 ms
2022-09-25 00:18:22 INFO  Done!
2022-09-25 00:18:22 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-25 00:18:22 INFO  Running instrumented original pipeline...
2022-09-25 00:18:22 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-25 00:18:22 INFO  ---RUNTIME: Importing and monkey-patching took 6.084442138671875 ms
2022-09-25 00:18:32 INFO  ---RUNTIME: Original pipeline execution took 9877.320289611816 ms (excluding imports and monkey-patching)
2022-09-25 00:18:32 INFO  Starting execution of 1 what-if analyses...
2022-09-25 00:18:32 INFO  Start plan generation for analysis PermutationFeatureImportance...
2022-09-25 00:18:32 INFO  ---RUNTIME: Plan generation took 0.14328956604003906 ms
2022-09-25 00:18:32 INFO  Estimated runtime of original DAG is 9548.583030700684ms
2022-09-25 00:18:32 WARNING Skipping Multi-Query Optimization (instead, only applying patches)
2022-09-25 00:18:32 INFO  Estimated unoptimised what-if runtime is 47742.91515350342ms
2022-09-25 00:18:32 INFO  ---RUNTIME: Multi-Query Optimization took 4.412174224853516 ms
2022-09-25 00:18:32 INFO  Executing generated plans
2022-09-25 00:19:19 INFO  ---RUNTIME: Execution took 46892.974853515625 ms
2022-09-25 00:19:19 INFO  Done!
2022-09-25 00:19:19 INFO  # Finished -- repetition 1 of 7 
2022-09-25 00:19:19 INFO  # Optimization benchmark for feature_importance with args [['reviews', 'fast_loading', 'featurization_4', 'logistic_regression']] -- repetition 2 of 7
2022-09-25 00:19:19 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-25 00:19:19 INFO  Running instrumented original pipeline...
2022-09-25 00:19:19 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-25 00:19:19 INFO  ---RUNTIME: Importing and monkey-patching took 6.306171417236328 ms
2022-09-25 00:19:28 INFO  ---RUNTIME: Original pipeline execution took 9610.734701156616 ms (excluding imports and monkey-patching)
2022-09-25 00:19:28 INFO  Starting execution of 1 what-if analyses...
2022-09-25 00:19:28 INFO  Start plan generation for analysis PermutationFeatureImportance...
2022-09-25 00:19:28 INFO  ---RUNTIME: Plan generation took 0.13113021850585938 ms
2022-09-25 00:19:28 INFO  Estimated runtime of original DAG is 9285.356760025024ms
2022-09-25 00:19:28 INFO  Performing Multi-Query Optimization
2022-09-25 00:19:28 INFO  Estimated unoptimized what-if runtime is 46426.78380012512ms
2022-09-25 00:19:28 INFO  Estimated optimised what-if runtime is 9505.364418029785ms
2022-09-25 00:19:28 INFO  Estimated optimisation runtime saving is 36921.41938209534ms
2022-09-25 00:19:28 INFO  ---RUNTIME: Multi-Query Optimization took 11.111259460449219 ms
2022-09-25 00:19:28 INFO  Executing generated plans
2022-09-25 00:19:38 INFO  ---RUNTIME: Execution took 9505.256652832031 ms
2022-09-25 00:19:38 INFO  Done!
2022-09-25 00:19:38 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-25 00:19:38 INFO  Running instrumented original pipeline...
2022-09-25 00:19:38 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-25 00:19:38 INFO  ---RUNTIME: Importing and monkey-patching took 6.056070327758789 ms
2022-09-25 00:19:48 INFO  ---RUNTIME: Original pipeline execution took 9991.594791412354 ms (excluding imports and monkey-patching)
2022-09-25 00:19:48 INFO  Starting execution of 1 what-if analyses...
2022-09-25 00:19:48 INFO  Start plan generation for analysis PermutationFeatureImportance...
2022-09-25 00:19:48 INFO  ---RUNTIME: Plan generation took 0.16617774963378906 ms
2022-09-25 00:19:48 INFO  Estimated runtime of original DAG is 9434.447765350342ms
2022-09-25 00:19:48 WARNING Skipping Multi-Query Optimization (instead, only applying patches)
2022-09-25 00:19:48 INFO  Estimated unoptimised what-if runtime is 47172.23882675171ms
2022-09-25 00:19:48 INFO  ---RUNTIME: Multi-Query Optimization took 14.690399169921875 ms
2022-09-25 00:19:48 INFO  Executing generated plans
2022-09-25 00:20:35 INFO  ---RUNTIME: Execution took 46984.82799530029 ms
2022-09-25 00:20:35 INFO  Done!
2022-09-25 00:20:35 INFO  # Finished -- repetition 2 of 7 
2022-09-25 00:20:35 INFO  # Optimization benchmark for feature_importance with args [['reviews', 'fast_loading', 'featurization_4', 'logistic_regression']] -- repetition 3 of 7
2022-09-25 00:20:35 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-25 00:20:35 INFO  Running instrumented original pipeline...
2022-09-25 00:20:35 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-25 00:20:35 INFO  ---RUNTIME: Importing and monkey-patching took 6.179332733154297 ms
2022-09-25 00:20:45 INFO  ---RUNTIME: Original pipeline execution took 9617.24328994751 ms (excluding imports and monkey-patching)
2022-09-25 00:20:45 INFO  Starting execution of 1 what-if analyses...
2022-09-25 00:20:45 INFO  Start plan generation for analysis PermutationFeatureImportance...
2022-09-25 00:20:45 INFO  ---RUNTIME: Plan generation took 0.1266002655029297 ms
2022-09-25 00:20:45 INFO  Estimated runtime of original DAG is 9288.440942764282ms
2022-09-25 00:20:45 INFO  Performing Multi-Query Optimization
2022-09-25 00:20:45 INFO  Estimated unoptimized what-if runtime is 46442.20471382141ms
2022-09-25 00:20:45 INFO  Estimated optimised what-if runtime is 9511.645078659058ms
2022-09-25 00:20:45 INFO  Estimated optimisation runtime saving is 36930.55963516235ms
2022-09-25 00:20:45 INFO  ---RUNTIME: Multi-Query Optimization took 10.98775863647461 ms
2022-09-25 00:20:45 INFO  Executing generated plans
2022-09-25 00:20:54 INFO  ---RUNTIME: Execution took 9592.765092849731 ms
2022-09-25 00:20:54 INFO  Done!
2022-09-25 00:20:54 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-25 00:20:54 INFO  Running instrumented original pipeline...
2022-09-25 00:20:54 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-25 00:20:54 INFO  ---RUNTIME: Importing and monkey-patching took 6.257057189941406 ms
2022-09-25 00:21:04 INFO  ---RUNTIME: Original pipeline execution took 9682.121515274048 ms (excluding imports and monkey-patching)
2022-09-25 00:21:04 INFO  Starting execution of 1 what-if analyses...
2022-09-25 00:21:04 INFO  Start plan generation for analysis PermutationFeatureImportance...
2022-09-25 00:21:04 INFO  ---RUNTIME: Plan generation took 0.14090538024902344 ms
2022-09-25 00:21:04 INFO  Estimated runtime of original DAG is 9353.82890701294ms
2022-09-25 00:21:04 WARNING Skipping Multi-Query Optimization (instead, only applying patches)
2022-09-25 00:21:04 INFO  Estimated unoptimised what-if runtime is 46769.1445350647ms
2022-09-25 00:21:04 INFO  ---RUNTIME: Multi-Query Optimization took 4.31060791015625 ms
2022-09-25 00:21:04 INFO  Executing generated plans
2022-09-25 00:21:51 INFO  ---RUNTIME: Execution took 47059.23628807068 ms
2022-09-25 00:21:51 INFO  Done!
2022-09-25 00:21:51 INFO  # Finished -- repetition 3 of 7 
2022-09-25 00:21:51 INFO  # Optimization benchmark for feature_importance with args [['reviews', 'fast_loading', 'featurization_4', 'logistic_regression']] -- repetition 4 of 7
2022-09-25 00:21:51 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-25 00:21:51 INFO  Running instrumented original pipeline...
2022-09-25 00:21:51 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-25 00:21:51 INFO  ---RUNTIME: Importing and monkey-patching took 6.186246871948242 ms
2022-09-25 00:22:01 INFO  ---RUNTIME: Original pipeline execution took 9876.446962356567 ms (excluding imports and monkey-patching)
2022-09-25 00:22:01 INFO  Starting execution of 1 what-if analyses...
2022-09-25 00:22:01 INFO  Start plan generation for analysis PermutationFeatureImportance...
2022-09-25 00:22:01 INFO  ---RUNTIME: Plan generation took 0.10275840759277344 ms
2022-09-25 00:22:01 INFO  Estimated runtime of original DAG is 9550.242900848389ms
2022-09-25 00:22:01 INFO  Performing Multi-Query Optimization
2022-09-25 00:22:01 INFO  Estimated unoptimized what-if runtime is 47751.21450424194ms
2022-09-25 00:22:01 INFO  Estimated optimised what-if runtime is 9781.98766708374ms
2022-09-25 00:22:01 INFO  Estimated optimisation runtime saving is 37969.2268371582ms
2022-09-25 00:22:01 INFO  ---RUNTIME: Multi-Query Optimization took 10.942935943603516 ms
2022-09-25 00:22:01 INFO  Executing generated plans
2022-09-25 00:22:11 INFO  ---RUNTIME: Execution took 9751.718759536743 ms
2022-09-25 00:22:11 INFO  Done!
2022-09-25 00:22:11 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-25 00:22:11 INFO  Running instrumented original pipeline...
2022-09-25 00:22:11 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-25 00:22:11 INFO  ---RUNTIME: Importing and monkey-patching took 5.960941314697266 ms
2022-09-25 00:22:20 INFO  ---RUNTIME: Original pipeline execution took 9707.350969314575 ms (excluding imports and monkey-patching)
2022-09-25 00:22:20 INFO  Starting execution of 1 what-if analyses...
2022-09-25 00:22:20 INFO  Start plan generation for analysis PermutationFeatureImportance...
2022-09-25 00:22:20 INFO  ---RUNTIME: Plan generation took 0.11014938354492188 ms
2022-09-25 00:22:20 INFO  Estimated runtime of original DAG is 9381.09564781189ms
2022-09-25 00:22:20 WARNING Skipping Multi-Query Optimization (instead, only applying patches)
2022-09-25 00:22:20 INFO  Estimated unoptimised what-if runtime is 46905.47823905945ms
2022-09-25 00:22:20 INFO  ---RUNTIME: Multi-Query Optimization took 4.533529281616211 ms
2022-09-25 00:22:20 INFO  Executing generated plans
2022-09-25 00:23:07 INFO  ---RUNTIME: Execution took 46920.65620422363 ms
2022-09-25 00:23:07 INFO  Done!
2022-09-25 00:23:07 INFO  # Finished -- repetition 4 of 7 
2022-09-25 00:23:07 INFO  # Optimization benchmark for feature_importance with args [['reviews', 'fast_loading', 'featurization_4', 'logistic_regression']] -- repetition 5 of 7
2022-09-25 00:23:07 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-25 00:23:07 INFO  Running instrumented original pipeline...
2022-09-25 00:23:07 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-25 00:23:07 INFO  ---RUNTIME: Importing and monkey-patching took 6.824254989624023 ms
2022-09-25 00:23:17 INFO  ---RUNTIME: Original pipeline execution took 9603.479623794556 ms (excluding imports and monkey-patching)
2022-09-25 00:23:17 INFO  Starting execution of 1 what-if analyses...
2022-09-25 00:23:17 INFO  Start plan generation for analysis PermutationFeatureImportance...
2022-09-25 00:23:17 INFO  ---RUNTIME: Plan generation took 0.12159347534179688 ms
2022-09-25 00:23:17 INFO  Estimated runtime of original DAG is 9276.424407958984ms
2022-09-25 00:23:17 INFO  Performing Multi-Query Optimization
2022-09-25 00:23:17 INFO  Estimated unoptimized what-if runtime is 46382.12203979492ms
2022-09-25 00:23:17 INFO  Estimated optimised what-if runtime is 9511.428594589233ms
2022-09-25 00:23:17 INFO  Estimated optimisation runtime saving is 36870.69344520569ms
2022-09-25 00:23:17 INFO  ---RUNTIME: Multi-Query Optimization took 11.273622512817383 ms
2022-09-25 00:23:17 INFO  Executing generated plans
2022-09-25 00:23:27 INFO  ---RUNTIME: Execution took 9829.984664916992 ms
2022-09-25 00:23:27 INFO  Done!
2022-09-25 00:23:27 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-25 00:23:27 INFO  Running instrumented original pipeline...
2022-09-25 00:23:27 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-25 00:23:27 INFO  ---RUNTIME: Importing and monkey-patching took 5.764484405517578 ms
2022-09-25 00:23:36 INFO  ---RUNTIME: Original pipeline execution took 9582.943677902222 ms (excluding imports and monkey-patching)
2022-09-25 00:23:36 INFO  Starting execution of 1 what-if analyses...
2022-09-25 00:23:36 INFO  Start plan generation for analysis PermutationFeatureImportance...
2022-09-25 00:23:36 INFO  ---RUNTIME: Plan generation took 0.133514404296875 ms
2022-09-25 00:23:36 INFO  Estimated runtime of original DAG is 9256.13260269165ms
2022-09-25 00:23:36 WARNING Skipping Multi-Query Optimization (instead, only applying patches)
2022-09-25 00:23:36 INFO  Estimated unoptimised what-if runtime is 46280.66301345825ms
2022-09-25 00:23:36 INFO  ---RUNTIME: Multi-Query Optimization took 4.238128662109375 ms
2022-09-25 00:23:36 INFO  Executing generated plans
2022-09-25 00:24:23 INFO  ---RUNTIME: Execution took 46792.20199584961 ms
2022-09-25 00:24:23 INFO  Done!
2022-09-25 00:24:23 INFO  # Finished -- repetition 5 of 7 
2022-09-25 00:24:23 INFO  # Optimization benchmark for feature_importance with args [['reviews', 'fast_loading', 'featurization_4', 'logistic_regression']] -- repetition 6 of 7
2022-09-25 00:24:23 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-25 00:24:23 INFO  Running instrumented original pipeline...
2022-09-25 00:24:23 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-25 00:24:23 INFO  ---RUNTIME: Importing and monkey-patching took 5.861043930053711 ms
2022-09-25 00:24:33 INFO  ---RUNTIME: Original pipeline execution took 9589.097261428833 ms (excluding imports and monkey-patching)
2022-09-25 00:24:33 INFO  Starting execution of 1 what-if analyses...
2022-09-25 00:24:33 INFO  Start plan generation for analysis PermutationFeatureImportance...
2022-09-25 00:24:33 INFO  ---RUNTIME: Plan generation took 0.11348724365234375 ms
2022-09-25 00:24:33 INFO  Estimated runtime of original DAG is 9264.785051345825ms
2022-09-25 00:24:33 INFO  Performing Multi-Query Optimization
2022-09-25 00:24:33 INFO  Estimated unoptimized what-if runtime is 46323.925256729126ms
2022-09-25 00:24:33 INFO  Estimated optimised what-if runtime is 9476.500272750854ms
2022-09-25 00:24:33 INFO  Estimated optimisation runtime saving is 36847.42498397827ms
2022-09-25 00:24:33 INFO  ---RUNTIME: Multi-Query Optimization took 10.826587677001953 ms
2022-09-25 00:24:33 INFO  Executing generated plans
2022-09-25 00:24:42 INFO  ---RUNTIME: Execution took 9536.674737930298 ms
2022-09-25 00:24:42 INFO  Done!
2022-09-25 00:24:42 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-25 00:24:42 INFO  Running instrumented original pipeline...
2022-09-25 00:24:42 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-25 00:24:42 INFO  ---RUNTIME: Importing and monkey-patching took 5.858659744262695 ms
2022-09-25 00:24:52 INFO  ---RUNTIME: Original pipeline execution took 9540.838956832886 ms (excluding imports and monkey-patching)
2022-09-25 00:24:52 INFO  Starting execution of 1 what-if analyses...
2022-09-25 00:24:52 INFO  Start plan generation for analysis PermutationFeatureImportance...
2022-09-25 00:24:52 INFO  ---RUNTIME: Plan generation took 0.10800361633300781 ms
2022-09-25 00:24:52 INFO  Estimated runtime of original DAG is 9215.29245376587ms
2022-09-25 00:24:52 WARNING Skipping Multi-Query Optimization (instead, only applying patches)
2022-09-25 00:24:52 INFO  Estimated unoptimised what-if runtime is 46076.462268829346ms
2022-09-25 00:24:52 INFO  ---RUNTIME: Multi-Query Optimization took 4.2018890380859375 ms
2022-09-25 00:24:52 INFO  Executing generated plans
2022-09-25 00:25:39 INFO  ---RUNTIME: Execution took 46926.4976978302 ms
2022-09-25 00:25:39 INFO  Done!
2022-09-25 00:25:39 INFO  # Finished -- repetition 6 of 7 
2022-09-25 00:25:39 INFO  # Optimization benchmark for feature_importance with args [['reviews', 'fast_loading', 'featurization_4', 'logistic_regression']] -- repetition 7 of 7
2022-09-25 00:25:39 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-25 00:25:39 INFO  Running instrumented original pipeline...
2022-09-25 00:25:39 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-25 00:25:39 INFO  ---RUNTIME: Importing and monkey-patching took 6.175518035888672 ms
2022-09-25 00:25:49 INFO  ---RUNTIME: Original pipeline execution took 9693.409442901611 ms (excluding imports and monkey-patching)
2022-09-25 00:25:49 INFO  Starting execution of 1 what-if analyses...
2022-09-25 00:25:49 INFO  Start plan generation for analysis PermutationFeatureImportance...
2022-09-25 00:25:49 INFO  ---RUNTIME: Plan generation took 0.118255615234375 ms
2022-09-25 00:25:49 INFO  Estimated runtime of original DAG is 9363.817691802979ms
2022-09-25 00:25:49 INFO  Performing Multi-Query Optimization
2022-09-25 00:25:49 INFO  Estimated unoptimized what-if runtime is 46819.08845901489ms
2022-09-25 00:25:49 INFO  Estimated optimised what-if runtime is 9583.392143249512ms
2022-09-25 00:25:49 INFO  Estimated optimisation runtime saving is 37235.69631576538ms
2022-09-25 00:25:49 INFO  ---RUNTIME: Multi-Query Optimization took 11.065483093261719 ms
2022-09-25 00:25:49 INFO  Executing generated plans
2022-09-25 00:25:58 INFO  ---RUNTIME: Execution took 9735.541105270386 ms
2022-09-25 00:25:58 INFO  Done!
2022-09-25 00:25:58 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-25 00:25:58 INFO  Running instrumented original pipeline...
2022-09-25 00:25:58 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-25 00:25:58 INFO  ---RUNTIME: Importing and monkey-patching took 6.3114166259765625 ms
2022-09-25 00:26:08 INFO  ---RUNTIME: Original pipeline execution took 9727.591037750244 ms (excluding imports and monkey-patching)
2022-09-25 00:26:08 INFO  Starting execution of 1 what-if analyses...
2022-09-25 00:26:08 INFO  Start plan generation for analysis PermutationFeatureImportance...
2022-09-25 00:26:08 INFO  ---RUNTIME: Plan generation took 0.12230873107910156 ms
2022-09-25 00:26:08 INFO  Estimated runtime of original DAG is 9398.31829071045ms
2022-09-25 00:26:08 WARNING Skipping Multi-Query Optimization (instead, only applying patches)
2022-09-25 00:26:08 INFO  Estimated unoptimised what-if runtime is 46991.591453552246ms
2022-09-25 00:26:08 INFO  ---RUNTIME: Multi-Query Optimization took 4.231929779052734 ms
2022-09-25 00:26:08 INFO  Executing generated plans
2022-09-25 00:26:55 INFO  ---RUNTIME: Execution took 46754.677057266235 ms
2022-09-25 00:26:55 INFO  Done!
2022-09-25 00:26:55 INFO  # Finished -- repetition 7 of 7 
2022-09-25 00:26:55 INFO  # Final results after all repetitions
2022-09-25 00:26:55 INFO     repetition  ... no_opt_what_if_execution_combined_model_training
0           0  ...                                       871.755123
1           1  ...                                       867.123365
2           2  ...                                       866.131306
3           3  ...                                       865.638494
4           4  ...                                       844.021559
5           5  ...                                       853.476763
6           6  ...                                       848.731279

[7 rows x 26 columns]
PROTOCOL_BUFFERS_PYTHON_IMPLEMENTATION=python taskset -c 32-39 python3.9 benchmarks_end_to_end.py feature_importance reviews fast_loading featurization_4 xgboost
2022-09-25 00:26:57.649972: W tensorflow/stream_executor/platform/default/dso_loader.cc:64] Could not load dynamic library 'libcudart.so.11.0'; dlerror: libcudart.so.11.0: cannot open shared object file: No such file or directory; LD_LIBRARY_PATH: /home/sgrafbe/mlwhatif/venv/lib/python3.9/site-packages/cv2/../../lib64:
2022-09-25 00:26:57.650016: I tensorflow/stream_executor/cuda/cudart_stub.cc:29] Ignore above cudart dlerror if you do not have a GPU set up on your machine.
2022-09-25 00:26:58 INFO  Patching sys.argv with ['mlwhatif', 'reviews', 'fast_loading', 'featurization_4', 'xgboost']
2022-09-25 00:26:58 INFO  Running instrumented original pipeline...
2022-09-25 00:26:58 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-25 00:26:59 INFO  ---RUNTIME: Importing and monkey-patching took 122.73097038269043 ms
2022-09-25 00:27:20 INFO  ---RUNTIME: Original pipeline execution took 21865.915060043335 ms (excluding imports and monkey-patching)
2022-09-25 00:27:20 INFO  Starting execution of 0 what-if analyses...
2022-09-25 00:27:20 INFO  Estimated runtime of original DAG is 21495.550870895386ms
2022-09-25 00:27:20 INFO  Performing Multi-Query Optimization
2022-09-25 00:27:20 INFO  Estimated unoptimized what-if runtime is 0ms
2022-09-25 00:27:20 INFO  Estimated optimised what-if runtime is 0ms
2022-09-25 00:27:20 INFO  Estimated optimisation runtime saving is 0ms
2022-09-25 00:27:20 INFO  ---RUNTIME: Multi-Query Optimization took 0.5247592926025391 ms
2022-09-25 00:27:20 INFO  Executing generated plans
2022-09-25 00:27:20 INFO  ---RUNTIME: Execution took 0.02574920654296875 ms
2022-09-25 00:27:20 INFO  Done!
2022-09-25 00:27:20 INFO  # Optimization benchmark for feature_importance with args [['reviews', 'fast_loading', 'featurization_4', 'xgboost']] -- repetition 1 of 7
2022-09-25 00:27:20 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-25 00:27:20 INFO  Running instrumented original pipeline...
2022-09-25 00:27:20 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-25 00:27:20 INFO  ---RUNTIME: Importing and monkey-patching took 5.518913269042969 ms
2022-09-25 00:27:42 INFO  ---RUNTIME: Original pipeline execution took 21611.51075363159 ms (excluding imports and monkey-patching)
2022-09-25 00:27:42 INFO  Starting execution of 1 what-if analyses...
2022-09-25 00:27:42 INFO  Start plan generation for analysis PermutationFeatureImportance...
2022-09-25 00:27:42 INFO  ---RUNTIME: Plan generation took 0.23293495178222656 ms
2022-09-25 00:27:42 INFO  Estimated runtime of original DAG is 21287.41407394409ms
2022-09-25 00:27:42 INFO  Performing Multi-Query Optimization
2022-09-25 00:27:42 INFO  Estimated unoptimized what-if runtime is 106437.07036972046ms
2022-09-25 00:27:42 INFO  Estimated optimised what-if runtime is 22763.6079788208ms
2022-09-25 00:27:42 INFO  Estimated optimisation runtime saving is 83673.46239089966ms
2022-09-25 00:27:42 INFO  ---RUNTIME: Multi-Query Optimization took 11.411666870117188 ms
2022-09-25 00:27:42 INFO  Executing generated plans
2022-09-25 00:28:05 INFO  ---RUNTIME: Execution took 22869.07696723938 ms
2022-09-25 00:28:05 INFO  Done!
2022-09-25 00:28:05 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-25 00:28:05 INFO  Running instrumented original pipeline...
2022-09-25 00:28:05 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-25 00:28:05 INFO  ---RUNTIME: Importing and monkey-patching took 6.348848342895508 ms
2022-09-25 00:28:27 INFO  ---RUNTIME: Original pipeline execution took 21806.715488433838 ms (excluding imports and monkey-patching)
2022-09-25 00:28:27 INFO  Starting execution of 1 what-if analyses...
2022-09-25 00:28:27 INFO  Start plan generation for analysis PermutationFeatureImportance...
2022-09-25 00:28:27 INFO  ---RUNTIME: Plan generation took 0.13780593872070312 ms
2022-09-25 00:28:27 INFO  Estimated runtime of original DAG is 21460.444450378418ms
2022-09-25 00:28:27 WARNING Skipping Multi-Query Optimization (instead, only applying patches)
2022-09-25 00:28:27 INFO  Estimated unoptimised what-if runtime is 107302.22225189209ms
2022-09-25 00:28:27 INFO  ---RUNTIME: Multi-Query Optimization took 4.2858123779296875 ms
2022-09-25 00:28:27 INFO  Executing generated plans
2022-09-25 00:30:14 INFO  ---RUNTIME: Execution took 106926.34916305542 ms
2022-09-25 00:30:14 INFO  Done!
2022-09-25 00:30:14 INFO  # Finished -- repetition 1 of 7 
2022-09-25 00:30:14 INFO  # Optimization benchmark for feature_importance with args [['reviews', 'fast_loading', 'featurization_4', 'xgboost']] -- repetition 2 of 7
2022-09-25 00:30:14 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-25 00:30:14 INFO  Running instrumented original pipeline...
2022-09-25 00:30:14 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-25 00:30:14 INFO  ---RUNTIME: Importing and monkey-patching took 6.345987319946289 ms
2022-09-25 00:30:35 INFO  ---RUNTIME: Original pipeline execution took 21660.34722328186 ms (excluding imports and monkey-patching)
2022-09-25 00:30:35 INFO  Starting execution of 1 what-if analyses...
2022-09-25 00:30:35 INFO  Start plan generation for analysis PermutationFeatureImportance...
2022-09-25 00:30:35 INFO  ---RUNTIME: Plan generation took 0.14090538024902344 ms
2022-09-25 00:30:35 INFO  Estimated runtime of original DAG is 21341.28189086914ms
2022-09-25 00:30:35 INFO  Performing Multi-Query Optimization
2022-09-25 00:30:35 INFO  Estimated unoptimized what-if runtime is 106706.4094543457ms
2022-09-25 00:30:35 INFO  Estimated optimised what-if runtime is 22811.91396713257ms
2022-09-25 00:30:35 INFO  Estimated optimisation runtime saving is 83894.49548721313ms
2022-09-25 00:30:35 INFO  ---RUNTIME: Multi-Query Optimization took 11.453866958618164 ms
2022-09-25 00:30:35 INFO  Executing generated plans
2022-09-25 00:30:58 INFO  ---RUNTIME: Execution took 22866.33849143982 ms
2022-09-25 00:30:58 INFO  Done!
2022-09-25 00:30:58 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-25 00:30:58 INFO  Running instrumented original pipeline...
2022-09-25 00:30:58 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-25 00:30:58 INFO  ---RUNTIME: Importing and monkey-patching took 5.887508392333984 ms
2022-09-25 00:31:20 INFO  ---RUNTIME: Original pipeline execution took 21937.042951583862 ms (excluding imports and monkey-patching)
2022-09-25 00:31:20 INFO  Starting execution of 1 what-if analyses...
2022-09-25 00:31:20 INFO  Start plan generation for analysis PermutationFeatureImportance...
2022-09-25 00:31:20 INFO  ---RUNTIME: Plan generation took 0.13446807861328125 ms
2022-09-25 00:31:20 INFO  Estimated runtime of original DAG is 21613.817930221558ms
2022-09-25 00:31:20 WARNING Skipping Multi-Query Optimization (instead, only applying patches)
2022-09-25 00:31:20 INFO  Estimated unoptimised what-if runtime is 108069.08965110779ms
2022-09-25 00:31:20 INFO  ---RUNTIME: Multi-Query Optimization took 4.197597503662109 ms
2022-09-25 00:31:20 INFO  Executing generated plans
2022-09-25 00:33:08 INFO  ---RUNTIME: Execution took 107509.69815254211 ms
2022-09-25 00:33:08 INFO  Done!
2022-09-25 00:33:08 INFO  # Finished -- repetition 2 of 7 
2022-09-25 00:33:08 INFO  # Optimization benchmark for feature_importance with args [['reviews', 'fast_loading', 'featurization_4', 'xgboost']] -- repetition 3 of 7
2022-09-25 00:33:08 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-25 00:33:08 INFO  Running instrumented original pipeline...
2022-09-25 00:33:08 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-25 00:33:08 INFO  ---RUNTIME: Importing and monkey-patching took 6.456851959228516 ms
2022-09-25 00:33:29 INFO  ---RUNTIME: Original pipeline execution took 21599.15018081665 ms (excluding imports and monkey-patching)
2022-09-25 00:33:29 INFO  Starting execution of 1 what-if analyses...
2022-09-25 00:33:29 INFO  Start plan generation for analysis PermutationFeatureImportance...
2022-09-25 00:33:29 INFO  ---RUNTIME: Plan generation took 0.12969970703125 ms
2022-09-25 00:33:29 INFO  Estimated runtime of original DAG is 21274.020195007324ms
2022-09-25 00:33:29 INFO  Performing Multi-Query Optimization
2022-09-25 00:33:29 INFO  Estimated unoptimized what-if runtime is 106370.10097503662ms
2022-09-25 00:33:29 INFO  Estimated optimised what-if runtime is 22699.85294342041ms
2022-09-25 00:33:29 INFO  Estimated optimisation runtime saving is 83670.24803161621ms
2022-09-25 00:33:29 INFO  ---RUNTIME: Multi-Query Optimization took 11.220455169677734 ms
2022-09-25 00:33:29 INFO  Executing generated plans
2022-09-25 00:33:52 INFO  ---RUNTIME: Execution took 22746.045112609863 ms
2022-09-25 00:33:52 INFO  Done!
2022-09-25 00:33:52 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-25 00:33:52 INFO  Running instrumented original pipeline...
2022-09-25 00:33:52 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-25 00:33:52 INFO  ---RUNTIME: Importing and monkey-patching took 6.457090377807617 ms
2022-09-25 00:34:14 INFO  ---RUNTIME: Original pipeline execution took 21694.86927986145 ms (excluding imports and monkey-patching)
2022-09-25 00:34:14 INFO  Starting execution of 1 what-if analyses...
2022-09-25 00:34:14 INFO  Start plan generation for analysis PermutationFeatureImportance...
2022-09-25 00:34:14 INFO  ---RUNTIME: Plan generation took 0.13303756713867188 ms
2022-09-25 00:34:14 INFO  Estimated runtime of original DAG is 21374.32312965393ms
2022-09-25 00:34:14 WARNING Skipping Multi-Query Optimization (instead, only applying patches)
2022-09-25 00:34:14 INFO  Estimated unoptimised what-if runtime is 106871.61564826965ms
2022-09-25 00:34:14 INFO  ---RUNTIME: Multi-Query Optimization took 4.2400360107421875 ms
2022-09-25 00:34:14 INFO  Executing generated plans
2022-09-25 00:36:01 INFO  ---RUNTIME: Execution took 106699.26691055298 ms
2022-09-25 00:36:01 INFO  Done!
2022-09-25 00:36:01 INFO  # Finished -- repetition 3 of 7 
2022-09-25 00:36:01 INFO  # Optimization benchmark for feature_importance with args [['reviews', 'fast_loading', 'featurization_4', 'xgboost']] -- repetition 4 of 7
2022-09-25 00:36:01 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-25 00:36:01 INFO  Running instrumented original pipeline...
2022-09-25 00:36:01 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-25 00:36:01 INFO  ---RUNTIME: Importing and monkey-patching took 6.400346755981445 ms
2022-09-25 00:36:22 INFO  ---RUNTIME: Original pipeline execution took 21745.35608291626 ms (excluding imports and monkey-patching)
2022-09-25 00:36:22 INFO  Starting execution of 1 what-if analyses...
2022-09-25 00:36:22 INFO  Start plan generation for analysis PermutationFeatureImportance...
2022-09-25 00:36:22 INFO  ---RUNTIME: Plan generation took 0.10895729064941406 ms
2022-09-25 00:36:22 INFO  Estimated runtime of original DAG is 21421.761989593506ms
2022-09-25 00:36:22 INFO  Performing Multi-Query Optimization
2022-09-25 00:36:22 INFO  Estimated unoptimized what-if runtime is 107108.80994796753ms
2022-09-25 00:36:22 INFO  Estimated optimised what-if runtime is 22860.405445098877ms
2022-09-25 00:36:22 INFO  Estimated optimisation runtime saving is 84248.40450286865ms
2022-09-25 00:36:22 INFO  ---RUNTIME: Multi-Query Optimization took 10.805606842041016 ms
2022-09-25 00:36:22 INFO  Executing generated plans
2022-09-25 00:36:45 INFO  ---RUNTIME: Execution took 22631.42490386963 ms
2022-09-25 00:36:45 INFO  Done!
2022-09-25 00:36:45 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-25 00:36:45 INFO  Running instrumented original pipeline...
2022-09-25 00:36:45 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-25 00:36:45 INFO  ---RUNTIME: Importing and monkey-patching took 6.014823913574219 ms
2022-09-25 00:37:07 INFO  ---RUNTIME: Original pipeline execution took 21570.46127319336 ms (excluding imports and monkey-patching)
2022-09-25 00:37:07 INFO  Starting execution of 1 what-if analyses...
2022-09-25 00:37:07 INFO  Start plan generation for analysis PermutationFeatureImportance...
2022-09-25 00:37:07 INFO  ---RUNTIME: Plan generation took 0.1327991485595703 ms
2022-09-25 00:37:07 INFO  Estimated runtime of original DAG is 21244.95768547058ms
2022-09-25 00:37:07 WARNING Skipping Multi-Query Optimization (instead, only applying patches)
2022-09-25 00:37:07 INFO  Estimated unoptimised what-if runtime is 106224.7884273529ms
2022-09-25 00:37:07 INFO  ---RUNTIME: Multi-Query Optimization took 4.503488540649414 ms
2022-09-25 00:37:07 INFO  Executing generated plans
2022-09-25 00:38:53 INFO  ---RUNTIME: Execution took 106567.32106208801 ms
2022-09-25 00:38:53 INFO  Done!
2022-09-25 00:38:53 INFO  # Finished -- repetition 4 of 7 
2022-09-25 00:38:53 INFO  # Optimization benchmark for feature_importance with args [['reviews', 'fast_loading', 'featurization_4', 'xgboost']] -- repetition 5 of 7
2022-09-25 00:38:53 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-25 00:38:53 INFO  Running instrumented original pipeline...
2022-09-25 00:38:53 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-25 00:38:53 INFO  ---RUNTIME: Importing and monkey-patching took 6.336450576782227 ms
2022-09-25 00:39:15 INFO  ---RUNTIME: Original pipeline execution took 21512.07399368286 ms (excluding imports and monkey-patching)
2022-09-25 00:39:15 INFO  Starting execution of 1 what-if analyses...
2022-09-25 00:39:15 INFO  Start plan generation for analysis PermutationFeatureImportance...
2022-09-25 00:39:15 INFO  ---RUNTIME: Plan generation took 0.13494491577148438 ms
2022-09-25 00:39:15 INFO  Estimated runtime of original DAG is 21189.59403038025ms
2022-09-25 00:39:15 INFO  Performing Multi-Query Optimization
2022-09-25 00:39:15 INFO  Estimated unoptimized what-if runtime is 105947.97015190125ms
2022-09-25 00:39:15 INFO  Estimated optimised what-if runtime is 22590.360164642334ms
2022-09-25 00:39:15 INFO  Estimated optimisation runtime saving is 83357.60998725891ms
2022-09-25 00:39:15 INFO  ---RUNTIME: Multi-Query Optimization took 11.2152099609375 ms
2022-09-25 00:39:15 INFO  Executing generated plans
2022-09-25 00:39:37 INFO  ---RUNTIME: Execution took 22645.336866378784 ms
2022-09-25 00:39:37 INFO  Done!
2022-09-25 00:39:37 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-25 00:39:37 INFO  Running instrumented original pipeline...
2022-09-25 00:39:38 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-25 00:39:38 INFO  ---RUNTIME: Importing and monkey-patching took 5.842685699462891 ms
2022-09-25 00:39:59 INFO  ---RUNTIME: Original pipeline execution took 21753.19266319275 ms (excluding imports and monkey-patching)
2022-09-25 00:39:59 INFO  Starting execution of 1 what-if analyses...
2022-09-25 00:39:59 INFO  Start plan generation for analysis PermutationFeatureImportance...
2022-09-25 00:39:59 INFO  ---RUNTIME: Plan generation took 0.13446807861328125 ms
2022-09-25 00:39:59 INFO  Estimated runtime of original DAG is 21194.753885269165ms
2022-09-25 00:39:59 WARNING Skipping Multi-Query Optimization (instead, only applying patches)
2022-09-25 00:39:59 INFO  Estimated unoptimised what-if runtime is 105973.76942634583ms
2022-09-25 00:39:59 INFO  ---RUNTIME: Multi-Query Optimization took 4.224300384521484 ms
2022-09-25 00:39:59 INFO  Executing generated plans
2022-09-25 00:41:46 INFO  ---RUNTIME: Execution took 106684.46063995361 ms
2022-09-25 00:41:46 INFO  Done!
2022-09-25 00:41:46 INFO  # Finished -- repetition 5 of 7 
2022-09-25 00:41:46 INFO  # Optimization benchmark for feature_importance with args [['reviews', 'fast_loading', 'featurization_4', 'xgboost']] -- repetition 6 of 7
2022-09-25 00:41:46 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-25 00:41:46 INFO  Running instrumented original pipeline...
2022-09-25 00:41:46 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-25 00:41:46 INFO  ---RUNTIME: Importing and monkey-patching took 6.331443786621094 ms
2022-09-25 00:42:07 INFO  ---RUNTIME: Original pipeline execution took 21598.652124404907 ms (excluding imports and monkey-patching)
2022-09-25 00:42:07 INFO  Starting execution of 1 what-if analyses...
2022-09-25 00:42:07 INFO  Start plan generation for analysis PermutationFeatureImportance...
2022-09-25 00:42:07 INFO  ---RUNTIME: Plan generation took 0.14328956604003906 ms
2022-09-25 00:42:07 INFO  Estimated runtime of original DAG is 21273.397207260132ms
2022-09-25 00:42:07 INFO  Performing Multi-Query Optimization
2022-09-25 00:42:07 INFO  Estimated unoptimized what-if runtime is 106366.98603630066ms
2022-09-25 00:42:07 INFO  Estimated optimised what-if runtime is 22687.032222747803ms
2022-09-25 00:42:07 INFO  Estimated optimisation runtime saving is 83679.95381355286ms
2022-09-25 00:42:07 INFO  ---RUNTIME: Multi-Query Optimization took 10.907888412475586 ms
2022-09-25 00:42:07 INFO  Executing generated plans
2022-09-25 00:42:30 INFO  ---RUNTIME: Execution took 22680.61637878418 ms
2022-09-25 00:42:30 INFO  Done!
2022-09-25 00:42:30 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-25 00:42:30 INFO  Running instrumented original pipeline...
2022-09-25 00:42:30 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-25 00:42:30 INFO  ---RUNTIME: Importing and monkey-patching took 6.316423416137695 ms
2022-09-25 00:42:52 INFO  ---RUNTIME: Original pipeline execution took 21574.877738952637 ms (excluding imports and monkey-patching)
2022-09-25 00:42:52 INFO  Starting execution of 1 what-if analyses...
2022-09-25 00:42:52 INFO  Start plan generation for analysis PermutationFeatureImportance...
2022-09-25 00:42:52 INFO  ---RUNTIME: Plan generation took 0.14328956604003906 ms
2022-09-25 00:42:52 INFO  Estimated runtime of original DAG is 21249.54342842102ms
2022-09-25 00:42:52 WARNING Skipping Multi-Query Optimization (instead, only applying patches)
2022-09-25 00:42:52 INFO  Estimated unoptimised what-if runtime is 106247.7171421051ms
2022-09-25 00:42:52 INFO  ---RUNTIME: Multi-Query Optimization took 4.262447357177734 ms
2022-09-25 00:42:52 INFO  Executing generated plans
2022-09-25 00:44:38 INFO  ---RUNTIME: Execution took 106702.35633850098 ms
2022-09-25 00:44:38 INFO  Done!
2022-09-25 00:44:39 INFO  # Finished -- repetition 6 of 7 
2022-09-25 00:44:39 INFO  # Optimization benchmark for feature_importance with args [['reviews', 'fast_loading', 'featurization_4', 'xgboost']] -- repetition 7 of 7
2022-09-25 00:44:39 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-25 00:44:39 INFO  Running instrumented original pipeline...
2022-09-25 00:44:39 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-25 00:44:39 INFO  ---RUNTIME: Importing and monkey-patching took 6.678342819213867 ms
2022-09-25 00:45:00 INFO  ---RUNTIME: Original pipeline execution took 21613.228797912598 ms (excluding imports and monkey-patching)
2022-09-25 00:45:00 INFO  Starting execution of 1 what-if analyses...
2022-09-25 00:45:00 INFO  Start plan generation for analysis PermutationFeatureImportance...
2022-09-25 00:45:00 INFO  ---RUNTIME: Plan generation took 0.13899803161621094 ms
2022-09-25 00:45:00 INFO  Estimated runtime of original DAG is 21284.021139144897ms
2022-09-25 00:45:00 INFO  Performing Multi-Query Optimization
2022-09-25 00:45:00 INFO  Estimated unoptimized what-if runtime is 106420.10569572449ms
2022-09-25 00:45:00 INFO  Estimated optimised what-if runtime is 22696.85173034668ms
2022-09-25 00:45:00 INFO  Estimated optimisation runtime saving is 83723.25396537781ms
2022-09-25 00:45:00 INFO  ---RUNTIME: Multi-Query Optimization took 11.29913330078125 ms
2022-09-25 00:45:00 INFO  Executing generated plans
2022-09-25 00:45:23 INFO  ---RUNTIME: Execution took 22930.42778968811 ms
2022-09-25 00:45:23 INFO  Done!
2022-09-25 00:45:23 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-25 00:45:23 INFO  Running instrumented original pipeline...
2022-09-25 00:45:23 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-25 00:45:23 INFO  ---RUNTIME: Importing and monkey-patching took 5.851507186889648 ms
2022-09-25 00:45:45 INFO  ---RUNTIME: Original pipeline execution took 21623.76117706299 ms (excluding imports and monkey-patching)
2022-09-25 00:45:45 INFO  Starting execution of 1 what-if analyses...
2022-09-25 00:45:45 INFO  Start plan generation for analysis PermutationFeatureImportance...
2022-09-25 00:45:45 INFO  ---RUNTIME: Plan generation took 0.1373291015625 ms
2022-09-25 00:45:45 INFO  Estimated runtime of original DAG is 21297.5115776062ms
2022-09-25 00:45:45 WARNING Skipping Multi-Query Optimization (instead, only applying patches)
2022-09-25 00:45:45 INFO  Estimated unoptimised what-if runtime is 106487.557888031ms
2022-09-25 00:45:45 INFO  ---RUNTIME: Multi-Query Optimization took 4.246711730957031 ms
2022-09-25 00:45:45 INFO  Executing generated plans
2022-09-25 00:47:32 INFO  ---RUNTIME: Execution took 106988.8825416565 ms
2022-09-25 00:47:32 INFO  Done!
2022-09-25 00:47:32 INFO  # Finished -- repetition 7 of 7 
2022-09-25 00:47:32 INFO  # Final results after all repetitions
2022-09-25 00:47:32 INFO     repetition  ... no_opt_what_if_execution_combined_model_training
0           0  ...                                     59676.425695
1           1  ...                                     59674.612761
2           2  ...                                     59559.788704
3           3  ...                                     59591.785908
4           4  ...                                     59665.966272
5           5  ...                                     59567.692757
6           6  ...                                     59718.205690

[7 rows x 26 columns]
PROTOCOL_BUFFERS_PYTHON_IMPLEMENTATION=python taskset -c 32-39 python3.9 benchmarks_end_to_end.py feature_importance reviews fast_loading featurization_4 neural_network
2022-09-25 00:47:34.519979: W tensorflow/stream_executor/platform/default/dso_loader.cc:64] Could not load dynamic library 'libcudart.so.11.0'; dlerror: libcudart.so.11.0: cannot open shared object file: No such file or directory; LD_LIBRARY_PATH: /home/sgrafbe/mlwhatif/venv/lib/python3.9/site-packages/cv2/../../lib64:
2022-09-25 00:47:34.520026: I tensorflow/stream_executor/cuda/cudart_stub.cc:29] Ignore above cudart dlerror if you do not have a GPU set up on your machine.
2022-09-25 00:47:35 INFO  Patching sys.argv with ['mlwhatif', 'reviews', 'fast_loading', 'featurization_4', 'neural_network']
2022-09-25 00:47:35 INFO  Running instrumented original pipeline...
2022-09-25 00:47:35 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-25 00:47:35 INFO  ---RUNTIME: Importing and monkey-patching took 122.51424789428711 ms
2022-09-25 00:47:45.736057: W tensorflow/stream_executor/platform/default/dso_loader.cc:64] Could not load dynamic library 'libcuda.so.1'; dlerror: libcuda.so.1: cannot open shared object file: No such file or directory; LD_LIBRARY_PATH: /home/sgrafbe/mlwhatif/venv/lib/python3.9/site-packages/cv2/../../lib64:
2022-09-25 00:47:45.736105: W tensorflow/stream_executor/cuda/cuda_driver.cc:326] failed call to cuInit: UNKNOWN ERROR (303)
2022-09-25 00:47:45.736128: I tensorflow/stream_executor/cuda/cuda_diagnostics.cc:156] kernel driver does not appear to be running on this host (angus): /proc/driver/nvidia/version does not exist
2022-09-25 00:47:45.736624: I tensorflow/core/platform/cpu_feature_guard.cc:142] This TensorFlow binary is optimized with oneAPI Deep Neural Network Library (oneDNN) to use the following CPU instructions in performance-critical operations:  AVX2 FMA
To enable them in other operations, rebuild TensorFlow with the appropriate compiler flags.
2022-09-25 00:47:45.807617: I tensorflow/compiler/mlir/mlir_graph_optimization_pass.cc:176] None of the MLIR Optimization Passes are enabled (registered 2)
2022-09-25 00:47:45.819230: I tensorflow/core/platform/profile_utils/cpu_utils.cc:114] CPU Frequency: 2595130000 Hz
2022-09-25 00:47:49 INFO  ---RUNTIME: Original pipeline execution took 13776.88717842102 ms (excluding imports and monkey-patching)
2022-09-25 00:47:49 INFO  Starting execution of 0 what-if analyses...
2022-09-25 00:47:49 INFO  Estimated runtime of original DAG is 13427.207469940186ms
2022-09-25 00:47:49 INFO  Performing Multi-Query Optimization
2022-09-25 00:47:49 INFO  Estimated unoptimized what-if runtime is 0ms
2022-09-25 00:47:49 INFO  Estimated optimised what-if runtime is 0ms
2022-09-25 00:47:49 INFO  Estimated optimisation runtime saving is 0ms
2022-09-25 00:47:49 INFO  ---RUNTIME: Multi-Query Optimization took 0.5488395690917969 ms
2022-09-25 00:47:49 INFO  Executing generated plans
2022-09-25 00:47:49 INFO  ---RUNTIME: Execution took 0.023365020751953125 ms
2022-09-25 00:47:49 INFO  Done!
2022-09-25 00:47:49 INFO  # Optimization benchmark for feature_importance with args [['reviews', 'fast_loading', 'featurization_4', 'neural_network']] -- repetition 1 of 7
2022-09-25 00:47:49 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-25 00:47:49 INFO  Running instrumented original pipeline...
2022-09-25 00:47:49 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-25 00:47:49 INFO  ---RUNTIME: Importing and monkey-patching took 5.466938018798828 ms
2022-09-25 00:48:03 INFO  ---RUNTIME: Original pipeline execution took 13753.761291503906 ms (excluding imports and monkey-patching)
2022-09-25 00:48:03 INFO  Starting execution of 1 what-if analyses...
2022-09-25 00:48:03 INFO  Start plan generation for analysis PermutationFeatureImportance...
2022-09-25 00:48:03 INFO  ---RUNTIME: Plan generation took 0.18024444580078125 ms
2022-09-25 00:48:03 INFO  Estimated runtime of original DAG is 13438.472986221313ms
2022-09-25 00:48:03 INFO  Performing Multi-Query Optimization
2022-09-25 00:48:03 INFO  Estimated unoptimized what-if runtime is 67192.36493110657ms
2022-09-25 00:48:03 INFO  Estimated optimised what-if runtime is 15207.289218902588ms
2022-09-25 00:48:03 INFO  Estimated optimisation runtime saving is 51985.07571220398ms
2022-09-25 00:48:03 INFO  ---RUNTIME: Multi-Query Optimization took 11.620283126831055 ms
2022-09-25 00:48:03 INFO  Executing generated plans
2022-09-25 00:48:18 INFO  ---RUNTIME: Execution took 14835.067749023438 ms
2022-09-25 00:48:18 INFO  Done!
2022-09-25 00:48:18 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-25 00:48:18 INFO  Running instrumented original pipeline...
2022-09-25 00:48:18 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-25 00:48:18 INFO  ---RUNTIME: Importing and monkey-patching took 6.208658218383789 ms
2022-09-25 00:48:31 INFO  ---RUNTIME: Original pipeline execution took 13500.108242034912 ms (excluding imports and monkey-patching)
2022-09-25 00:48:31 INFO  Starting execution of 1 what-if analyses...
2022-09-25 00:48:31 INFO  Start plan generation for analysis PermutationFeatureImportance...
2022-09-25 00:48:31 INFO  ---RUNTIME: Plan generation took 0.10609626770019531 ms
2022-09-25 00:48:31 INFO  Estimated runtime of original DAG is 13190.086364746094ms
2022-09-25 00:48:31 WARNING Skipping Multi-Query Optimization (instead, only applying patches)
2022-09-25 00:48:31 INFO  Estimated unoptimised what-if runtime is 65950.43182373047ms
2022-09-25 00:48:31 INFO  ---RUNTIME: Multi-Query Optimization took 4.249334335327148 ms
2022-09-25 00:48:31 INFO  Executing generated plans
2022-09-25 00:49:36 INFO  ---RUNTIME: Execution took 64753.89504432678 ms
2022-09-25 00:49:36 INFO  Done!
2022-09-25 00:49:36 INFO  # Finished -- repetition 1 of 7 
2022-09-25 00:49:36 INFO  # Optimization benchmark for feature_importance with args [['reviews', 'fast_loading', 'featurization_4', 'neural_network']] -- repetition 2 of 7
2022-09-25 00:49:36 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-25 00:49:36 INFO  Running instrumented original pipeline...
2022-09-25 00:49:36 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-25 00:49:36 INFO  ---RUNTIME: Importing and monkey-patching took 5.984306335449219 ms
2022-09-25 00:49:50 INFO  ---RUNTIME: Original pipeline execution took 13444.939374923706 ms (excluding imports and monkey-patching)
2022-09-25 00:49:50 INFO  Starting execution of 1 what-if analyses...
2022-09-25 00:49:50 INFO  Start plan generation for analysis PermutationFeatureImportance...
2022-09-25 00:49:50 INFO  ---RUNTIME: Plan generation took 0.11157989501953125 ms
2022-09-25 00:49:50 INFO  Estimated runtime of original DAG is 13122.91407585144ms
2022-09-25 00:49:50 INFO  Performing Multi-Query Optimization
2022-09-25 00:49:50 INFO  Estimated unoptimized what-if runtime is 65614.5703792572ms
2022-09-25 00:49:50 INFO  Estimated optimised what-if runtime is 14854.414463043213ms
2022-09-25 00:49:50 INFO  Estimated optimisation runtime saving is 50760.15591621399ms
2022-09-25 00:49:50 INFO  ---RUNTIME: Multi-Query Optimization took 11.139154434204102 ms
2022-09-25 00:49:50 INFO  Executing generated plans
2022-09-25 00:50:04 INFO  ---RUNTIME: Execution took 14532.774448394775 ms
2022-09-25 00:50:04 INFO  Done!
2022-09-25 00:50:04 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-25 00:50:04 INFO  Running instrumented original pipeline...
2022-09-25 00:50:04 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-25 00:50:04 INFO  ---RUNTIME: Importing and monkey-patching took 6.242990493774414 ms
2022-09-25 00:50:17 INFO  ---RUNTIME: Original pipeline execution took 13085.79134941101 ms (excluding imports and monkey-patching)
2022-09-25 00:50:17 INFO  Starting execution of 1 what-if analyses...
2022-09-25 00:50:17 INFO  Start plan generation for analysis PermutationFeatureImportance...
2022-09-25 00:50:17 INFO  ---RUNTIME: Plan generation took 0.12278556823730469 ms
2022-09-25 00:50:17 INFO  Estimated runtime of original DAG is 12773.273706436157ms
2022-09-25 00:50:17 WARNING Skipping Multi-Query Optimization (instead, only applying patches)
2022-09-25 00:50:17 INFO  Estimated unoptimised what-if runtime is 63866.368532180786ms
2022-09-25 00:50:17 INFO  ---RUNTIME: Multi-Query Optimization took 4.212379455566406 ms
2022-09-25 00:50:17 INFO  Executing generated plans
2022-09-25 00:51:23 INFO  ---RUNTIME: Execution took 65656.29935264587 ms
2022-09-25 00:51:23 INFO  Done!
2022-09-25 00:51:23 INFO  # Finished -- repetition 2 of 7 
2022-09-25 00:51:23 INFO  # Optimization benchmark for feature_importance with args [['reviews', 'fast_loading', 'featurization_4', 'neural_network']] -- repetition 3 of 7
2022-09-25 00:51:23 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-25 00:51:23 INFO  Running instrumented original pipeline...
2022-09-25 00:51:23 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-25 00:51:23 INFO  ---RUNTIME: Importing and monkey-patching took 6.120204925537109 ms
2022-09-25 00:51:36 INFO  ---RUNTIME: Original pipeline execution took 13380.502700805664 ms (excluding imports and monkey-patching)
2022-09-25 00:51:36 INFO  Starting execution of 1 what-if analyses...
2022-09-25 00:51:36 INFO  Start plan generation for analysis PermutationFeatureImportance...
2022-09-25 00:51:36 INFO  ---RUNTIME: Plan generation took 0.11301040649414062 ms
2022-09-25 00:51:36 INFO  Estimated runtime of original DAG is 13070.790529251099ms
2022-09-25 00:51:36 INFO  Performing Multi-Query Optimization
2022-09-25 00:51:36 INFO  Estimated unoptimized what-if runtime is 65353.95264625549ms
2022-09-25 00:51:36 INFO  Estimated optimised what-if runtime is 14841.726779937744ms
2022-09-25 00:51:36 INFO  Estimated optimisation runtime saving is 50512.22586631775ms
2022-09-25 00:51:36 INFO  ---RUNTIME: Multi-Query Optimization took 10.778665542602539 ms
2022-09-25 00:51:36 INFO  Executing generated plans
2022-09-25 00:51:51 INFO  ---RUNTIME: Execution took 14790.41862487793 ms
2022-09-25 00:51:51 INFO  Done!
2022-09-25 00:51:51 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-25 00:51:51 INFO  Running instrumented original pipeline...
2022-09-25 00:51:51 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-25 00:51:51 INFO  ---RUNTIME: Importing and monkey-patching took 5.713224411010742 ms
2022-09-25 00:52:05 INFO  ---RUNTIME: Original pipeline execution took 13674.950361251831 ms (excluding imports and monkey-patching)
2022-09-25 00:52:05 INFO  Starting execution of 1 what-if analyses...
2022-09-25 00:52:05 INFO  Start plan generation for analysis PermutationFeatureImportance...
2022-09-25 00:52:05 INFO  ---RUNTIME: Plan generation took 0.11610984802246094 ms
2022-09-25 00:52:05 INFO  Estimated runtime of original DAG is 13365.309715270996ms
2022-09-25 00:52:05 WARNING Skipping Multi-Query Optimization (instead, only applying patches)
2022-09-25 00:52:05 INFO  Estimated unoptimised what-if runtime is 66826.54857635498ms
2022-09-25 00:52:05 INFO  ---RUNTIME: Multi-Query Optimization took 5.581140518188477 ms
2022-09-25 00:52:05 INFO  Executing generated plans
2022-09-25 00:53:11 INFO  ---RUNTIME: Execution took 65916.20469093323 ms
2022-09-25 00:53:11 INFO  Done!
2022-09-25 00:53:11 INFO  # Finished -- repetition 3 of 7 
2022-09-25 00:53:11 INFO  # Optimization benchmark for feature_importance with args [['reviews', 'fast_loading', 'featurization_4', 'neural_network']] -- repetition 4 of 7
2022-09-25 00:53:11 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-25 00:53:11 INFO  Running instrumented original pipeline...
2022-09-25 00:53:11 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-25 00:53:11 INFO  ---RUNTIME: Importing and monkey-patching took 6.052732467651367 ms
2022-09-25 00:53:24 INFO  ---RUNTIME: Original pipeline execution took 13376.952409744263 ms (excluding imports and monkey-patching)
2022-09-25 00:53:24 INFO  Starting execution of 1 what-if analyses...
2022-09-25 00:53:24 INFO  Start plan generation for analysis PermutationFeatureImportance...
2022-09-25 00:53:24 INFO  ---RUNTIME: Plan generation took 0.1354217529296875 ms
2022-09-25 00:53:24 INFO  Estimated runtime of original DAG is 13063.45272064209ms
2022-09-25 00:53:24 INFO  Performing Multi-Query Optimization
2022-09-25 00:53:24 INFO  Estimated unoptimized what-if runtime is 65317.26360321045ms
2022-09-25 00:53:24 INFO  Estimated optimised what-if runtime is 14785.479545593262ms
2022-09-25 00:53:24 INFO  Estimated optimisation runtime saving is 50531.78405761719ms
2022-09-25 00:53:24 INFO  ---RUNTIME: Multi-Query Optimization took 11.173486709594727 ms
2022-09-25 00:53:24 INFO  Executing generated plans
2022-09-25 00:53:39 INFO  ---RUNTIME: Execution took 15180.025100708008 ms
2022-09-25 00:53:39 INFO  Done!
2022-09-25 00:53:39 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-25 00:53:39 INFO  Running instrumented original pipeline...
2022-09-25 00:53:39 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-25 00:53:39 INFO  ---RUNTIME: Importing and monkey-patching took 5.860328674316406 ms
2022-09-25 00:53:52 INFO  ---RUNTIME: Original pipeline execution took 12987.361192703247 ms (excluding imports and monkey-patching)
2022-09-25 00:53:52 INFO  Starting execution of 1 what-if analyses...
2022-09-25 00:53:52 INFO  Start plan generation for analysis PermutationFeatureImportance...
2022-09-25 00:53:52 INFO  ---RUNTIME: Plan generation took 0.1087188720703125 ms
2022-09-25 00:53:52 INFO  Estimated runtime of original DAG is 12671.151876449585ms
2022-09-25 00:53:52 WARNING Skipping Multi-Query Optimization (instead, only applying patches)
2022-09-25 00:53:52 INFO  Estimated unoptimised what-if runtime is 63355.759382247925ms
2022-09-25 00:53:52 INFO  ---RUNTIME: Multi-Query Optimization took 4.219293594360352 ms
2022-09-25 00:53:52 INFO  Executing generated plans
2022-09-25 00:54:57 INFO  ---RUNTIME: Execution took 64788.64884376526 ms
2022-09-25 00:54:57 INFO  Done!
2022-09-25 00:54:57 INFO  # Finished -- repetition 4 of 7 
2022-09-25 00:54:57 INFO  # Optimization benchmark for feature_importance with args [['reviews', 'fast_loading', 'featurization_4', 'neural_network']] -- repetition 5 of 7
2022-09-25 00:54:57 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-25 00:54:57 INFO  Running instrumented original pipeline...
2022-09-25 00:54:57 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-25 00:54:57 INFO  ---RUNTIME: Importing and monkey-patching took 6.454706192016602 ms
2022-09-25 00:55:11 INFO  ---RUNTIME: Original pipeline execution took 13447.061777114868 ms (excluding imports and monkey-patching)
2022-09-25 00:55:11 INFO  Starting execution of 1 what-if analyses...
2022-09-25 00:55:11 INFO  Start plan generation for analysis PermutationFeatureImportance...
2022-09-25 00:55:11 INFO  ---RUNTIME: Plan generation took 0.09965896606445312 ms
2022-09-25 00:55:11 INFO  Estimated runtime of original DAG is 13131.916046142578ms
2022-09-25 00:55:11 INFO  Performing Multi-Query Optimization
2022-09-25 00:55:11 INFO  Estimated unoptimized what-if runtime is 65659.58023071289ms
2022-09-25 00:55:11 INFO  Estimated optimised what-if runtime is 14917.683362960815ms
2022-09-25 00:55:11 INFO  Estimated optimisation runtime saving is 50741.896867752075ms
2022-09-25 00:55:11 INFO  ---RUNTIME: Multi-Query Optimization took 10.642766952514648 ms
2022-09-25 00:55:11 INFO  Executing generated plans
2022-09-25 00:55:25 INFO  ---RUNTIME: Execution took 14545.269250869751 ms
2022-09-25 00:55:25 INFO  Done!
2022-09-25 00:55:25 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-25 00:55:25 INFO  Running instrumented original pipeline...
2022-09-25 00:55:25 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-25 00:55:25 INFO  ---RUNTIME: Importing and monkey-patching took 5.93113899230957 ms
2022-09-25 00:55:38 INFO  ---RUNTIME: Original pipeline execution took 13233.375072479248 ms (excluding imports and monkey-patching)
2022-09-25 00:55:38 INFO  Starting execution of 1 what-if analyses...
2022-09-25 00:55:38 INFO  Start plan generation for analysis PermutationFeatureImportance...
2022-09-25 00:55:38 INFO  ---RUNTIME: Plan generation took 0.10538101196289062 ms
2022-09-25 00:55:38 INFO  Estimated runtime of original DAG is 12917.817115783691ms
2022-09-25 00:55:38 WARNING Skipping Multi-Query Optimization (instead, only applying patches)
2022-09-25 00:55:38 INFO  Estimated unoptimised what-if runtime is 64589.08557891846ms
2022-09-25 00:55:38 INFO  ---RUNTIME: Multi-Query Optimization took 4.166364669799805 ms
2022-09-25 00:55:38 INFO  Executing generated plans
2022-09-25 00:56:44 INFO  ---RUNTIME: Execution took 65944.58150863647 ms
2022-09-25 00:56:44 INFO  Done!
2022-09-25 00:56:44 INFO  # Finished -- repetition 5 of 7 
2022-09-25 00:56:44 INFO  # Optimization benchmark for feature_importance with args [['reviews', 'fast_loading', 'featurization_4', 'neural_network']] -- repetition 6 of 7
2022-09-25 00:56:44 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-25 00:56:44 INFO  Running instrumented original pipeline...
2022-09-25 00:56:44 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-25 00:56:44 INFO  ---RUNTIME: Importing and monkey-patching took 5.825996398925781 ms
2022-09-25 00:56:57 INFO  ---RUNTIME: Original pipeline execution took 13079.992771148682 ms (excluding imports and monkey-patching)
2022-09-25 00:56:57 INFO  Starting execution of 1 what-if analyses...
2022-09-25 00:56:57 INFO  Start plan generation for analysis PermutationFeatureImportance...
2022-09-25 00:56:57 INFO  ---RUNTIME: Plan generation took 0.13399124145507812 ms
2022-09-25 00:56:57 INFO  Estimated runtime of original DAG is 12767.467260360718ms
2022-09-25 00:56:57 INFO  Performing Multi-Query Optimization
2022-09-25 00:56:57 INFO  Estimated unoptimized what-if runtime is 63837.33630180359ms
2022-09-25 00:56:57 INFO  Estimated optimised what-if runtime is 14497.980117797852ms
2022-09-25 00:56:57 INFO  Estimated optimisation runtime saving is 49339.35618400574ms
2022-09-25 00:56:57 INFO  ---RUNTIME: Multi-Query Optimization took 12.631893157958984 ms
2022-09-25 00:56:57 INFO  Executing generated plans
2022-09-25 00:57:12 INFO  ---RUNTIME: Execution took 14594.724655151367 ms
2022-09-25 00:57:12 INFO  Done!
2022-09-25 00:57:12 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-25 00:57:12 INFO  Running instrumented original pipeline...
2022-09-25 00:57:12 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-25 00:57:12 INFO  ---RUNTIME: Importing and monkey-patching took 6.22868537902832 ms
2022-09-25 00:57:26 INFO  ---RUNTIME: Original pipeline execution took 13549.300193786621 ms (excluding imports and monkey-patching)
2022-09-25 00:57:26 INFO  Starting execution of 1 what-if analyses...
2022-09-25 00:57:26 INFO  Start plan generation for analysis PermutationFeatureImportance...
2022-09-25 00:57:26 INFO  ---RUNTIME: Plan generation took 0.102996826171875 ms
2022-09-25 00:57:26 INFO  Estimated runtime of original DAG is 13229.22420501709ms
2022-09-25 00:57:26 WARNING Skipping Multi-Query Optimization (instead, only applying patches)
2022-09-25 00:57:26 INFO  Estimated unoptimised what-if runtime is 66146.12102508545ms
2022-09-25 00:57:26 INFO  ---RUNTIME: Multi-Query Optimization took 4.292011260986328 ms
2022-09-25 00:57:26 INFO  Executing generated plans
2022-09-25 00:58:31 INFO  ---RUNTIME: Execution took 64886.07931137085 ms
2022-09-25 00:58:31 INFO  Done!
2022-09-25 00:58:31 INFO  # Finished -- repetition 6 of 7 
2022-09-25 00:58:31 INFO  # Optimization benchmark for feature_importance with args [['reviews', 'fast_loading', 'featurization_4', 'neural_network']] -- repetition 7 of 7
2022-09-25 00:58:31 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-25 00:58:31 INFO  Running instrumented original pipeline...
2022-09-25 00:58:31 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-25 00:58:31 INFO  ---RUNTIME: Importing and monkey-patching took 6.149053573608398 ms
2022-09-25 00:58:44 INFO  ---RUNTIME: Original pipeline execution took 13342.661619186401 ms (excluding imports and monkey-patching)
2022-09-25 00:58:44 INFO  Starting execution of 1 what-if analyses...
2022-09-25 00:58:44 INFO  Start plan generation for analysis PermutationFeatureImportance...
2022-09-25 00:58:44 INFO  ---RUNTIME: Plan generation took 0.10633468627929688 ms
2022-09-25 00:58:44 INFO  Estimated runtime of original DAG is 13030.648946762085ms
2022-09-25 00:58:44 INFO  Performing Multi-Query Optimization
2022-09-25 00:58:44 INFO  Estimated unoptimized what-if runtime is 65153.244733810425ms
2022-09-25 00:58:44 INFO  Estimated optimised what-if runtime is 14736.299991607666ms
2022-09-25 00:58:44 INFO  Estimated optimisation runtime saving is 50416.94474220276ms
2022-09-25 00:58:44 INFO  ---RUNTIME: Multi-Query Optimization took 10.702848434448242 ms
2022-09-25 00:58:44 INFO  Executing generated plans
2022-09-25 00:58:59 INFO  ---RUNTIME: Execution took 14929.336071014404 ms
2022-09-25 00:58:59 INFO  Done!
2022-09-25 00:58:59 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-25 00:58:59 INFO  Running instrumented original pipeline...
2022-09-25 00:58:59 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-25 00:58:59 INFO  ---RUNTIME: Importing and monkey-patching took 5.841255187988281 ms
2022-09-25 00:59:12 INFO  ---RUNTIME: Original pipeline execution took 13229.645729064941 ms (excluding imports and monkey-patching)
2022-09-25 00:59:12 INFO  Starting execution of 1 what-if analyses...
2022-09-25 00:59:12 INFO  Start plan generation for analysis PermutationFeatureImportance...
2022-09-25 00:59:12 INFO  ---RUNTIME: Plan generation took 0.13828277587890625 ms
2022-09-25 00:59:12 INFO  Estimated runtime of original DAG is 12917.87600517273ms
2022-09-25 00:59:12 WARNING Skipping Multi-Query Optimization (instead, only applying patches)
2022-09-25 00:59:12 INFO  Estimated unoptimised what-if runtime is 64589.38002586365ms
2022-09-25 00:59:12 INFO  ---RUNTIME: Multi-Query Optimization took 5.911111831665039 ms
2022-09-25 00:59:12 INFO  Executing generated plans
2022-09-25 01:00:17 INFO  ---RUNTIME: Execution took 65321.06900215149 ms
2022-09-25 01:00:17 INFO  Done!
2022-09-25 01:00:17 INFO  # Finished -- repetition 7 of 7 
2022-09-25 01:00:17 INFO  # Final results after all repetitions
2022-09-25 01:00:17 INFO     repetition  ... no_opt_what_if_execution_combined_model_training
0           0  ...                                     16412.580013
1           1  ...                                     16452.178478
2           2  ...                                     16317.553520
3           3  ...                                     16137.397766
4           4  ...                                     16168.655634
5           5  ...                                     16026.384354
6           6  ...                                     16493.034363

[7 rows x 26 columns]
PROTOCOL_BUFFERS_PYTHON_IMPLEMENTATION=python taskset -c 32-39 python3.9 benchmarks_end_to_end.py data_corruption reviews fast_loading featurization_0 logistic_regression
2022-09-25 01:00:20.472941: W tensorflow/stream_executor/platform/default/dso_loader.cc:64] Could not load dynamic library 'libcudart.so.11.0'; dlerror: libcudart.so.11.0: cannot open shared object file: No such file or directory; LD_LIBRARY_PATH: /home/sgrafbe/mlwhatif/venv/lib/python3.9/site-packages/cv2/../../lib64:
2022-09-25 01:00:20.472987: I tensorflow/stream_executor/cuda/cudart_stub.cc:29] Ignore above cudart dlerror if you do not have a GPU set up on your machine.
2022-09-25 01:00:21 INFO  Patching sys.argv with ['mlwhatif', 'reviews', 'fast_loading', 'featurization_0', 'logistic_regression']
2022-09-25 01:00:21 INFO  Running instrumented original pipeline...
2022-09-25 01:00:21 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-25 01:00:21 INFO  ---RUNTIME: Importing and monkey-patching took 121.92082405090332 ms
2022-09-25 01:00:27 INFO  ---RUNTIME: Original pipeline execution took 5206.592559814453 ms (excluding imports and monkey-patching)
2022-09-25 01:00:27 INFO  Starting execution of 0 what-if analyses...
2022-09-25 01:00:27 INFO  Estimated runtime of original DAG is 4891.910552978516ms
2022-09-25 01:00:27 INFO  Performing Multi-Query Optimization
2022-09-25 01:00:27 INFO  Estimated unoptimized what-if runtime is 0ms
2022-09-25 01:00:27 INFO  Estimated optimised what-if runtime is 0ms
2022-09-25 01:00:27 INFO  Estimated optimisation runtime saving is 0ms
2022-09-25 01:00:27 INFO  ---RUNTIME: Multi-Query Optimization took 0.5288124084472656 ms
2022-09-25 01:00:27 INFO  Executing generated plans
2022-09-25 01:00:27 INFO  ---RUNTIME: Execution took 0.029325485229492188 ms
2022-09-25 01:00:27 INFO  Done!
2022-09-25 01:00:27 INFO  # Optimization benchmark for data_corruption with args [['reviews', 'fast_loading', 'featurization_0', 'logistic_regression']] -- repetition 1 of 7
2022-09-25 01:00:27 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-25 01:00:27 INFO  Running instrumented original pipeline...
2022-09-25 01:00:27 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-25 01:00:27 INFO  ---RUNTIME: Importing and monkey-patching took 5.803108215332031 ms
2022-09-25 01:00:32 INFO  ---RUNTIME: Original pipeline execution took 5325.12354850769 ms (excluding imports and monkey-patching)
2022-09-25 01:00:32 INFO  Starting execution of 1 what-if analyses...
2022-09-25 01:00:32 INFO  Start plan generation for analysis DataCorruption...
2022-09-25 01:00:32 INFO  ---RUNTIME: Plan generation took 0.48661231994628906 ms
2022-09-25 01:00:32 INFO  Estimated runtime of original DAG is 4871.937274932861ms
2022-09-25 01:00:32 INFO  Performing Multi-Query Optimization
2022-09-25 01:00:32 INFO  Estimated unoptimized what-if runtime is 121798.43187332153ms
2022-09-25 01:00:32 INFO  Estimated optimised what-if runtime is 11533.676147460938ms
2022-09-25 01:00:32 INFO  Estimated optimisation runtime saving is 110264.7557258606ms
2022-09-25 01:00:32 INFO  ---RUNTIME: Multi-Query Optimization took 59.603214263916016 ms
2022-09-25 01:00:32 INFO  Executing generated plans
2022-09-25 01:00:48 INFO  ---RUNTIME: Execution took 16450.90389251709 ms
2022-09-25 01:00:48 INFO  Done!
2022-09-25 01:00:48 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-25 01:00:48 INFO  Running instrumented original pipeline...
2022-09-25 01:00:49 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-25 01:00:49 INFO  ---RUNTIME: Importing and monkey-patching took 6.246089935302734 ms
2022-09-25 01:00:54 INFO  ---RUNTIME: Original pipeline execution took 5197.491645812988 ms (excluding imports and monkey-patching)
2022-09-25 01:00:54 INFO  Starting execution of 1 what-if analyses...
2022-09-25 01:00:54 INFO  Start plan generation for analysis DataCorruption...
2022-09-25 01:00:54 INFO  ---RUNTIME: Plan generation took 0.4858970642089844 ms
2022-09-25 01:00:54 INFO  Estimated runtime of original DAG is 4895.465135574341ms
2022-09-25 01:00:54 WARNING Skipping Multi-Query Optimization (instead, only applying patches)
2022-09-25 01:00:54 INFO  Estimated unoptimised what-if runtime is 122386.62838935852ms
2022-09-25 01:00:54 INFO  ---RUNTIME: Multi-Query Optimization took 18.11695098876953 ms
2022-09-25 01:00:54 INFO  Executing generated plans
2022-09-25 01:03:10 INFO  ---RUNTIME: Execution took 136332.08966255188 ms
2022-09-25 01:03:10 INFO  Done!
2022-09-25 01:03:10 INFO  # Finished -- repetition 1 of 7 
2022-09-25 01:03:10 INFO  # Optimization benchmark for data_corruption with args [['reviews', 'fast_loading', 'featurization_0', 'logistic_regression']] -- repetition 2 of 7
2022-09-25 01:03:10 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-25 01:03:10 INFO  Running instrumented original pipeline...
2022-09-25 01:03:10 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-25 01:03:10 INFO  ---RUNTIME: Importing and monkey-patching took 6.851673126220703 ms
2022-09-25 01:03:15 INFO  ---RUNTIME: Original pipeline execution took 5156.264066696167 ms (excluding imports and monkey-patching)
2022-09-25 01:03:15 INFO  Starting execution of 1 what-if analyses...
2022-09-25 01:03:15 INFO  Start plan generation for analysis DataCorruption...
2022-09-25 01:03:15 INFO  ---RUNTIME: Plan generation took 0.45490264892578125 ms
2022-09-25 01:03:15 INFO  Estimated runtime of original DAG is 4850.079298019409ms
2022-09-25 01:03:15 INFO  Performing Multi-Query Optimization
2022-09-25 01:03:15 INFO  Estimated unoptimized what-if runtime is 121251.98245048523ms
2022-09-25 01:03:15 INFO  Estimated optimised what-if runtime is 11454.648494720459ms
2022-09-25 01:03:15 INFO  Estimated optimisation runtime saving is 109797.33395576477ms
2022-09-25 01:03:15 INFO  ---RUNTIME: Multi-Query Optimization took 69.80085372924805 ms
2022-09-25 01:03:15 INFO  Executing generated plans
2022-09-25 01:03:32 INFO  ---RUNTIME: Execution took 16340.979099273682 ms
2022-09-25 01:03:32 INFO  Done!
2022-09-25 01:03:32 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-25 01:03:32 INFO  Running instrumented original pipeline...
2022-09-25 01:03:32 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-25 01:03:32 INFO  ---RUNTIME: Importing and monkey-patching took 6.096839904785156 ms
2022-09-25 01:03:37 INFO  ---RUNTIME: Original pipeline execution took 5140.689849853516 ms (excluding imports and monkey-patching)
2022-09-25 01:03:37 INFO  Starting execution of 1 what-if analyses...
2022-09-25 01:03:37 INFO  Start plan generation for analysis DataCorruption...
2022-09-25 01:03:37 INFO  ---RUNTIME: Plan generation took 0.4363059997558594 ms
2022-09-25 01:03:37 INFO  Estimated runtime of original DAG is 4852.31351852417ms
2022-09-25 01:03:37 WARNING Skipping Multi-Query Optimization (instead, only applying patches)
2022-09-25 01:03:37 INFO  Estimated unoptimised what-if runtime is 121307.83796310425ms
2022-09-25 01:03:37 INFO  ---RUNTIME: Multi-Query Optimization took 38.80953788757324 ms
2022-09-25 01:03:37 INFO  Executing generated plans
2022-09-25 01:05:53 INFO  ---RUNTIME: Execution took 136433.33864212036 ms
2022-09-25 01:05:53 INFO  Done!
2022-09-25 01:05:53 INFO  # Finished -- repetition 2 of 7 
2022-09-25 01:05:53 INFO  # Optimization benchmark for data_corruption with args [['reviews', 'fast_loading', 'featurization_0', 'logistic_regression']] -- repetition 3 of 7
2022-09-25 01:05:53 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-25 01:05:53 INFO  Running instrumented original pipeline...
2022-09-25 01:05:53 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-25 01:05:53 INFO  ---RUNTIME: Importing and monkey-patching took 6.402730941772461 ms
2022-09-25 01:05:58 INFO  ---RUNTIME: Original pipeline execution took 5139.589786529541 ms (excluding imports and monkey-patching)
2022-09-25 01:05:58 INFO  Starting execution of 1 what-if analyses...
2022-09-25 01:05:58 INFO  Start plan generation for analysis DataCorruption...
2022-09-25 01:05:58 INFO  ---RUNTIME: Plan generation took 0.5042552947998047 ms
2022-09-25 01:05:58 INFO  Estimated runtime of original DAG is 4856.186628341675ms
2022-09-25 01:05:58 INFO  Performing Multi-Query Optimization
2022-09-25 01:05:58 INFO  Estimated unoptimized what-if runtime is 121404.66570854187ms
2022-09-25 01:05:58 INFO  Estimated optimised what-if runtime is 11487.771034240723ms
2022-09-25 01:05:58 INFO  Estimated optimisation runtime saving is 109916.89467430115ms
2022-09-25 01:05:58 INFO  ---RUNTIME: Multi-Query Optimization took 58.97212028503418 ms
2022-09-25 01:05:58 INFO  Executing generated plans
2022-09-25 01:06:15 INFO  ---RUNTIME: Execution took 16423.06399345398 ms
2022-09-25 01:06:15 INFO  Done!
2022-09-25 01:06:15 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-25 01:06:15 INFO  Running instrumented original pipeline...
2022-09-25 01:06:15 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-25 01:06:15 INFO  ---RUNTIME: Importing and monkey-patching took 5.969047546386719 ms
2022-09-25 01:06:20 INFO  ---RUNTIME: Original pipeline execution took 5167.502880096436 ms (excluding imports and monkey-patching)
2022-09-25 01:06:20 INFO  Starting execution of 1 what-if analyses...
2022-09-25 01:06:20 INFO  Start plan generation for analysis DataCorruption...
2022-09-25 01:06:20 INFO  ---RUNTIME: Plan generation took 0.4379749298095703 ms
2022-09-25 01:06:20 INFO  Estimated runtime of original DAG is 4884.918689727783ms
2022-09-25 01:06:20 WARNING Skipping Multi-Query Optimization (instead, only applying patches)
2022-09-25 01:06:20 INFO  Estimated unoptimised what-if runtime is 122122.96724319458ms
2022-09-25 01:06:20 INFO  ---RUNTIME: Multi-Query Optimization took 221.23265266418457 ms
2022-09-25 01:06:20 INFO  Executing generated plans
2022-09-25 01:08:37 INFO  ---RUNTIME: Execution took 136422.07598686218 ms
2022-09-25 01:08:37 INFO  Done!
2022-09-25 01:08:37 INFO  # Finished -- repetition 3 of 7 
2022-09-25 01:08:37 INFO  # Optimization benchmark for data_corruption with args [['reviews', 'fast_loading', 'featurization_0', 'logistic_regression']] -- repetition 4 of 7
2022-09-25 01:08:37 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-25 01:08:37 INFO  Running instrumented original pipeline...
2022-09-25 01:08:37 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-25 01:08:37 INFO  ---RUNTIME: Importing and monkey-patching took 6.094217300415039 ms
2022-09-25 01:08:42 INFO  ---RUNTIME: Original pipeline execution took 5159.105539321899 ms (excluding imports and monkey-patching)
2022-09-25 01:08:42 INFO  Starting execution of 1 what-if analyses...
2022-09-25 01:08:42 INFO  Start plan generation for analysis DataCorruption...
2022-09-25 01:08:42 INFO  ---RUNTIME: Plan generation took 0.47326087951660156 ms
2022-09-25 01:08:42 INFO  Estimated runtime of original DAG is 4874.59921836853ms
2022-09-25 01:08:42 INFO  Performing Multi-Query Optimization
2022-09-25 01:08:42 INFO  Estimated unoptimized what-if runtime is 121864.98045921326ms
2022-09-25 01:08:42 INFO  Estimated optimised what-if runtime is 11486.030578613281ms
2022-09-25 01:08:42 INFO  Estimated optimisation runtime saving is 110378.94988059998ms
2022-09-25 01:08:42 INFO  ---RUNTIME: Multi-Query Optimization took 59.76462364196777 ms
2022-09-25 01:08:42 INFO  Executing generated plans
2022-09-25 01:08:58 INFO  ---RUNTIME: Execution took 16295.934200286865 ms
2022-09-25 01:08:58 INFO  Done!
2022-09-25 01:08:58 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-25 01:08:58 INFO  Running instrumented original pipeline...
2022-09-25 01:08:58 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-25 01:08:58 INFO  ---RUNTIME: Importing and monkey-patching took 6.350278854370117 ms
2022-09-25 01:09:03 INFO  ---RUNTIME: Original pipeline execution took 5146.466970443726 ms (excluding imports and monkey-patching)
2022-09-25 01:09:03 INFO  Starting execution of 1 what-if analyses...
2022-09-25 01:09:03 INFO  Start plan generation for analysis DataCorruption...
2022-09-25 01:09:03 INFO  ---RUNTIME: Plan generation took 0.4410743713378906 ms
2022-09-25 01:09:03 INFO  Estimated runtime of original DAG is 4862.890243530273ms
2022-09-25 01:09:03 WARNING Skipping Multi-Query Optimization (instead, only applying patches)
2022-09-25 01:09:03 INFO  Estimated unoptimised what-if runtime is 121572.25608825684ms
2022-09-25 01:09:03 INFO  ---RUNTIME: Multi-Query Optimization took 17.887353897094727 ms
2022-09-25 01:09:03 INFO  Executing generated plans
2022-09-25 01:11:19 INFO  ---RUNTIME: Execution took 135933.72344970703 ms
2022-09-25 01:11:19 INFO  Done!
2022-09-25 01:11:19 INFO  # Finished -- repetition 4 of 7 
2022-09-25 01:11:19 INFO  # Optimization benchmark for data_corruption with args [['reviews', 'fast_loading', 'featurization_0', 'logistic_regression']] -- repetition 5 of 7
2022-09-25 01:11:19 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-25 01:11:19 INFO  Running instrumented original pipeline...
2022-09-25 01:11:19 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-25 01:11:19 INFO  ---RUNTIME: Importing and monkey-patching took 6.266117095947266 ms
2022-09-25 01:11:25 INFO  ---RUNTIME: Original pipeline execution took 5121.040105819702 ms (excluding imports and monkey-patching)
2022-09-25 01:11:25 INFO  Starting execution of 1 what-if analyses...
2022-09-25 01:11:25 INFO  Start plan generation for analysis DataCorruption...
2022-09-25 01:11:25 INFO  ---RUNTIME: Plan generation took 0.4544258117675781 ms
2022-09-25 01:11:25 INFO  Estimated runtime of original DAG is 4834.884405136108ms
2022-09-25 01:11:25 INFO  Performing Multi-Query Optimization
2022-09-25 01:11:25 INFO  Estimated unoptimized what-if runtime is 120872.11012840271ms
2022-09-25 01:11:25 INFO  Estimated optimised what-if runtime is 11473.90365600586ms
2022-09-25 01:11:25 INFO  Estimated optimisation runtime saving is 109398.20647239685ms
2022-09-25 01:11:25 INFO  ---RUNTIME: Multi-Query Optimization took 58.9909553527832 ms
2022-09-25 01:11:25 INFO  Executing generated plans
2022-09-25 01:11:41 INFO  ---RUNTIME: Execution took 16258.156776428223 ms
2022-09-25 01:11:41 INFO  Done!
2022-09-25 01:11:41 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-25 01:11:41 INFO  Running instrumented original pipeline...
2022-09-25 01:11:41 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-25 01:11:41 INFO  ---RUNTIME: Importing and monkey-patching took 5.865812301635742 ms
2022-09-25 01:11:46 INFO  ---RUNTIME: Original pipeline execution took 5122.945308685303 ms (excluding imports and monkey-patching)
2022-09-25 01:11:46 INFO  Starting execution of 1 what-if analyses...
2022-09-25 01:11:46 INFO  Start plan generation for analysis DataCorruption...
2022-09-25 01:11:46 INFO  ---RUNTIME: Plan generation took 0.40984153747558594 ms
2022-09-25 01:11:46 INFO  Estimated runtime of original DAG is 4840.1477336883545ms
2022-09-25 01:11:46 WARNING Skipping Multi-Query Optimization (instead, only applying patches)
2022-09-25 01:11:46 INFO  Estimated unoptimised what-if runtime is 121003.69334220886ms
2022-09-25 01:11:46 INFO  ---RUNTIME: Multi-Query Optimization took 17.828941345214844 ms
2022-09-25 01:11:46 INFO  Executing generated plans
2022-09-25 01:14:02 INFO  ---RUNTIME: Execution took 135580.45411109924 ms
2022-09-25 01:14:02 INFO  Done!
2022-09-25 01:14:02 INFO  # Finished -- repetition 5 of 7 
2022-09-25 01:14:02 INFO  # Optimization benchmark for data_corruption with args [['reviews', 'fast_loading', 'featurization_0', 'logistic_regression']] -- repetition 6 of 7
2022-09-25 01:14:02 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-25 01:14:02 INFO  Running instrumented original pipeline...
2022-09-25 01:14:02 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-25 01:14:02 INFO  ---RUNTIME: Importing and monkey-patching took 6.460905075073242 ms
2022-09-25 01:14:07 INFO  ---RUNTIME: Original pipeline execution took 5131.834268569946 ms (excluding imports and monkey-patching)
2022-09-25 01:14:07 INFO  Starting execution of 1 what-if analyses...
2022-09-25 01:14:07 INFO  Start plan generation for analysis DataCorruption...
2022-09-25 01:14:07 INFO  ---RUNTIME: Plan generation took 0.4322528839111328 ms
2022-09-25 01:14:07 INFO  Estimated runtime of original DAG is 4850.626230239868ms
2022-09-25 01:14:07 INFO  Performing Multi-Query Optimization
2022-09-25 01:14:07 INFO  Estimated unoptimized what-if runtime is 121265.6557559967ms
2022-09-25 01:14:07 INFO  Estimated optimised what-if runtime is 11571.93636894226ms
2022-09-25 01:14:07 INFO  Estimated optimisation runtime saving is 109693.71938705444ms
2022-09-25 01:14:07 INFO  ---RUNTIME: Multi-Query Optimization took 59.75174903869629 ms
2022-09-25 01:14:07 INFO  Executing generated plans
2022-09-25 01:14:23 INFO  ---RUNTIME: Execution took 16313.563585281372 ms
2022-09-25 01:14:23 INFO  Done!
2022-09-25 01:14:23 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-25 01:14:23 INFO  Running instrumented original pipeline...
2022-09-25 01:14:23 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-25 01:14:23 INFO  ---RUNTIME: Importing and monkey-patching took 6.1092376708984375 ms
2022-09-25 01:14:28 INFO  ---RUNTIME: Original pipeline execution took 5115.172624588013 ms (excluding imports and monkey-patching)
2022-09-25 01:14:28 INFO  Starting execution of 1 what-if analyses...
2022-09-25 01:14:28 INFO  Start plan generation for analysis DataCorruption...
2022-09-25 01:14:28 INFO  ---RUNTIME: Plan generation took 1.2521743774414062 ms
2022-09-25 01:14:28 INFO  Estimated runtime of original DAG is 4831.920623779297ms
2022-09-25 01:14:28 WARNING Skipping Multi-Query Optimization (instead, only applying patches)
2022-09-25 01:14:28 INFO  Estimated unoptimised what-if runtime is 120798.01559448242ms
2022-09-25 01:14:28 INFO  ---RUNTIME: Multi-Query Optimization took 17.193078994750977 ms
2022-09-25 01:14:28 INFO  Executing generated plans
2022-09-25 01:16:44 INFO  ---RUNTIME: Execution took 135682.28936195374 ms
2022-09-25 01:16:44 INFO  Done!
2022-09-25 01:16:44 INFO  # Finished -- repetition 6 of 7 
2022-09-25 01:16:44 INFO  # Optimization benchmark for data_corruption with args [['reviews', 'fast_loading', 'featurization_0', 'logistic_regression']] -- repetition 7 of 7
2022-09-25 01:16:44 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-25 01:16:44 INFO  Running instrumented original pipeline...
2022-09-25 01:16:44 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-25 01:16:44 INFO  ---RUNTIME: Importing and monkey-patching took 6.168842315673828 ms
2022-09-25 01:16:49 INFO  ---RUNTIME: Original pipeline execution took 5194.510459899902 ms (excluding imports and monkey-patching)
2022-09-25 01:16:49 INFO  Starting execution of 1 what-if analyses...
2022-09-25 01:16:49 INFO  Start plan generation for analysis DataCorruption...
2022-09-25 01:16:49 INFO  ---RUNTIME: Plan generation took 1.3191699981689453 ms
2022-09-25 01:16:49 INFO  Estimated runtime of original DAG is 4910.040616989136ms
2022-09-25 01:16:49 INFO  Performing Multi-Query Optimization
2022-09-25 01:16:49 INFO  Estimated unoptimized what-if runtime is 122751.0154247284ms
2022-09-25 01:16:49 INFO  Estimated optimised what-if runtime is 11603.41763496399ms
2022-09-25 01:16:49 INFO  Estimated optimisation runtime saving is 111147.5977897644ms
2022-09-25 01:16:49 INFO  ---RUNTIME: Multi-Query Optimization took 266.3843631744385 ms
2022-09-25 01:16:49 INFO  Executing generated plans
2022-09-25 01:17:06 INFO  ---RUNTIME: Execution took 16349.115133285522 ms
2022-09-25 01:17:06 INFO  Done!
2022-09-25 01:17:06 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-25 01:17:06 INFO  Running instrumented original pipeline...
2022-09-25 01:17:06 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-25 01:17:06 INFO  ---RUNTIME: Importing and monkey-patching took 5.564212799072266 ms
2022-09-25 01:17:11 INFO  ---RUNTIME: Original pipeline execution took 5132.495880126953 ms (excluding imports and monkey-patching)
2022-09-25 01:17:11 INFO  Starting execution of 1 what-if analyses...
2022-09-25 01:17:11 INFO  Start plan generation for analysis DataCorruption...
2022-09-25 01:17:11 INFO  ---RUNTIME: Plan generation took 0.4169940948486328 ms
2022-09-25 01:17:11 INFO  Estimated runtime of original DAG is 4846.63200378418ms
2022-09-25 01:17:11 WARNING Skipping Multi-Query Optimization (instead, only applying patches)
2022-09-25 01:17:11 INFO  Estimated unoptimised what-if runtime is 121165.80009460449ms
2022-09-25 01:17:11 INFO  ---RUNTIME: Multi-Query Optimization took 16.951560974121094 ms
2022-09-25 01:17:11 INFO  Executing generated plans
2022-09-25 01:19:27 INFO  ---RUNTIME: Execution took 135911.5333557129 ms
2022-09-25 01:19:27 INFO  Done!
2022-09-25 01:19:27 INFO  # Finished -- repetition 7 of 7 
2022-09-25 01:19:27 INFO  # Final results after all repetitions
2022-09-25 01:19:27 INFO     repetition  ... no_opt_what_if_execution_combined_model_training
0           0  ...                                      3973.711491
1           1  ...                                      3958.429813
2           2  ...                                      3952.619791
3           3  ...                                      3906.716347
4           4  ...                                      3920.152426
5           5  ...                                      3931.637049
6           6  ...                                      3923.069477

[7 rows x 26 columns]
PROTOCOL_BUFFERS_PYTHON_IMPLEMENTATION=python taskset -c 32-39 python3.9 benchmarks_end_to_end.py data_corruption reviews fast_loading featurization_0 xgboost
2022-09-25 01:19:29.571197: W tensorflow/stream_executor/platform/default/dso_loader.cc:64] Could not load dynamic library 'libcudart.so.11.0'; dlerror: libcudart.so.11.0: cannot open shared object file: No such file or directory; LD_LIBRARY_PATH: /home/sgrafbe/mlwhatif/venv/lib/python3.9/site-packages/cv2/../../lib64:
2022-09-25 01:19:29.571240: I tensorflow/stream_executor/cuda/cudart_stub.cc:29] Ignore above cudart dlerror if you do not have a GPU set up on your machine.
2022-09-25 01:19:30 INFO  Patching sys.argv with ['mlwhatif', 'reviews', 'fast_loading', 'featurization_0', 'xgboost']
2022-09-25 01:19:30 INFO  Running instrumented original pipeline...
2022-09-25 01:19:30 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-25 01:19:31 INFO  ---RUNTIME: Importing and monkey-patching took 121.8268871307373 ms
2022-09-25 01:19:38 INFO  ---RUNTIME: Original pipeline execution took 7302.74510383606 ms (excluding imports and monkey-patching)
2022-09-25 01:19:38 INFO  Starting execution of 0 what-if analyses...
2022-09-25 01:19:38 INFO  Estimated runtime of original DAG is 6979.888916015625ms
2022-09-25 01:19:38 INFO  Performing Multi-Query Optimization
2022-09-25 01:19:38 INFO  Estimated unoptimized what-if runtime is 0ms
2022-09-25 01:19:38 INFO  Estimated optimised what-if runtime is 0ms
2022-09-25 01:19:38 INFO  Estimated optimisation runtime saving is 0ms
2022-09-25 01:19:38 INFO  ---RUNTIME: Multi-Query Optimization took 0.4870891571044922 ms
2022-09-25 01:19:38 INFO  Executing generated plans
2022-09-25 01:19:38 INFO  ---RUNTIME: Execution took 0.02574920654296875 ms
2022-09-25 01:19:38 INFO  Done!
2022-09-25 01:19:38 INFO  # Optimization benchmark for data_corruption with args [['reviews', 'fast_loading', 'featurization_0', 'xgboost']] -- repetition 1 of 7
2022-09-25 01:19:38 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-25 01:19:38 INFO  Running instrumented original pipeline...
2022-09-25 01:19:38 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-25 01:19:38 INFO  ---RUNTIME: Importing and monkey-patching took 5.817174911499023 ms
2022-09-25 01:19:45 INFO  ---RUNTIME: Original pipeline execution took 7325.2058029174805 ms (excluding imports and monkey-patching)
2022-09-25 01:19:45 INFO  Starting execution of 1 what-if analyses...
2022-09-25 01:19:45 INFO  Start plan generation for analysis DataCorruption...
2022-09-25 01:19:45 INFO  ---RUNTIME: Plan generation took 0.5071163177490234 ms
2022-09-25 01:19:45 INFO  Estimated runtime of original DAG is 6876.449823379517ms
2022-09-25 01:19:45 INFO  Performing Multi-Query Optimization
2022-09-25 01:19:45 INFO  Estimated unoptimized what-if runtime is 171911.24558448792ms
2022-09-25 01:19:45 INFO  Estimated optimised what-if runtime is 20646.402597427368ms
2022-09-25 01:19:45 INFO  Estimated optimisation runtime saving is 151264.84298706055ms
2022-09-25 01:19:45 INFO  ---RUNTIME: Multi-Query Optimization took 59.59677696228027 ms
2022-09-25 01:19:45 INFO  Executing generated plans
2022-09-25 01:20:11 INFO  ---RUNTIME: Execution took 25514.442443847656 ms
2022-09-25 01:20:11 INFO  Done!
2022-09-25 01:20:11 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-25 01:20:11 INFO  Running instrumented original pipeline...
2022-09-25 01:20:11 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-25 01:20:11 INFO  ---RUNTIME: Importing and monkey-patching took 6.489753723144531 ms
2022-09-25 01:20:18 INFO  ---RUNTIME: Original pipeline execution took 7235.644340515137 ms (excluding imports and monkey-patching)
2022-09-25 01:20:18 INFO  Starting execution of 1 what-if analyses...
2022-09-25 01:20:18 INFO  Start plan generation for analysis DataCorruption...
2022-09-25 01:20:18 INFO  ---RUNTIME: Plan generation took 0.5002021789550781 ms
2022-09-25 01:20:18 INFO  Estimated runtime of original DAG is 6949.630975723267ms
2022-09-25 01:20:18 WARNING Skipping Multi-Query Optimization (instead, only applying patches)
2022-09-25 01:20:18 INFO  Estimated unoptimised what-if runtime is 173740.77439308167ms
2022-09-25 01:20:18 INFO  ---RUNTIME: Multi-Query Optimization took 18.235445022583008 ms
2022-09-25 01:20:18 INFO  Executing generated plans
2022-09-25 01:23:24 INFO  ---RUNTIME: Execution took 185971.03786468506 ms
2022-09-25 01:23:24 INFO  Done!
2022-09-25 01:23:24 INFO  # Finished -- repetition 1 of 7 
2022-09-25 01:23:24 INFO  # Optimization benchmark for data_corruption with args [['reviews', 'fast_loading', 'featurization_0', 'xgboost']] -- repetition 2 of 7
2022-09-25 01:23:24 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-25 01:23:24 INFO  Running instrumented original pipeline...
2022-09-25 01:23:24 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-25 01:23:24 INFO  ---RUNTIME: Importing and monkey-patching took 6.422281265258789 ms
2022-09-25 01:23:31 INFO  ---RUNTIME: Original pipeline execution took 7179.756879806519 ms (excluding imports and monkey-patching)
2022-09-25 01:23:31 INFO  Starting execution of 1 what-if analyses...
2022-09-25 01:23:31 INFO  Start plan generation for analysis DataCorruption...
2022-09-25 01:23:31 INFO  ---RUNTIME: Plan generation took 0.4744529724121094 ms
2022-09-25 01:23:31 INFO  Estimated runtime of original DAG is 6899.23357963562ms
2022-09-25 01:23:31 INFO  Performing Multi-Query Optimization
2022-09-25 01:23:31 INFO  Estimated unoptimized what-if runtime is 172480.8394908905ms
2022-09-25 01:23:31 INFO  Estimated optimised what-if runtime is 20720.03221511841ms
2022-09-25 01:23:31 INFO  Estimated optimisation runtime saving is 151760.8072757721ms
2022-09-25 01:23:31 INFO  ---RUNTIME: Multi-Query Optimization took 58.775901794433594 ms
2022-09-25 01:23:31 INFO  Executing generated plans
2022-09-25 01:23:56 INFO  ---RUNTIME: Execution took 25303.014516830444 ms
2022-09-25 01:23:56 INFO  Done!
2022-09-25 01:23:57 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-25 01:23:57 INFO  Running instrumented original pipeline...
2022-09-25 01:23:57 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-25 01:23:57 INFO  ---RUNTIME: Importing and monkey-patching took 6.484508514404297 ms
2022-09-25 01:24:04 INFO  ---RUNTIME: Original pipeline execution took 7147.685289382935 ms (excluding imports and monkey-patching)
2022-09-25 01:24:04 INFO  Starting execution of 1 what-if analyses...
2022-09-25 01:24:04 INFO  Start plan generation for analysis DataCorruption...
2022-09-25 01:24:04 INFO  ---RUNTIME: Plan generation took 0.4780292510986328 ms
2022-09-25 01:24:04 INFO  Estimated runtime of original DAG is 6860.250473022461ms
2022-09-25 01:24:04 WARNING Skipping Multi-Query Optimization (instead, only applying patches)
2022-09-25 01:24:04 INFO  Estimated unoptimised what-if runtime is 171506.26182556152ms
2022-09-25 01:24:04 INFO  ---RUNTIME: Multi-Query Optimization took 17.728328704833984 ms
2022-09-25 01:24:04 INFO  Executing generated plans
2022-09-25 01:27:09 INFO  ---RUNTIME: Execution took 185443.35269927979 ms
2022-09-25 01:27:09 INFO  Done!
2022-09-25 01:27:09 INFO  # Finished -- repetition 2 of 7 
2022-09-25 01:27:09 INFO  # Optimization benchmark for data_corruption with args [['reviews', 'fast_loading', 'featurization_0', 'xgboost']] -- repetition 3 of 7
2022-09-25 01:27:09 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-25 01:27:09 INFO  Running instrumented original pipeline...
2022-09-25 01:27:09 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-25 01:27:09 INFO  ---RUNTIME: Importing and monkey-patching took 6.422758102416992 ms
2022-09-25 01:27:16 INFO  ---RUNTIME: Original pipeline execution took 7142.7507400512695 ms (excluding imports and monkey-patching)
2022-09-25 01:27:16 INFO  Starting execution of 1 what-if analyses...
2022-09-25 01:27:16 INFO  Start plan generation for analysis DataCorruption...
2022-09-25 01:27:16 INFO  ---RUNTIME: Plan generation took 0.4734992980957031 ms
2022-09-25 01:27:16 INFO  Estimated runtime of original DAG is 6851.455926895142ms
2022-09-25 01:27:16 INFO  Performing Multi-Query Optimization
2022-09-25 01:27:16 INFO  Estimated unoptimized what-if runtime is 171286.39817237854ms
2022-09-25 01:27:16 INFO  Estimated optimised what-if runtime is 20515.535593032837ms
2022-09-25 01:27:16 INFO  Estimated optimisation runtime saving is 150770.8625793457ms
2022-09-25 01:27:16 INFO  ---RUNTIME: Multi-Query Optimization took 59.92293357849121 ms
2022-09-25 01:27:16 INFO  Executing generated plans
2022-09-25 01:27:42 INFO  ---RUNTIME: Execution took 25320.786714553833 ms
2022-09-25 01:27:42 INFO  Done!
2022-09-25 01:27:42 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-25 01:27:42 INFO  Running instrumented original pipeline...
2022-09-25 01:27:42 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-25 01:27:42 INFO  ---RUNTIME: Importing and monkey-patching took 6.04701042175293 ms
2022-09-25 01:27:49 INFO  ---RUNTIME: Original pipeline execution took 7134.430646896362 ms (excluding imports and monkey-patching)
2022-09-25 01:27:49 INFO  Starting execution of 1 what-if analyses...
2022-09-25 01:27:49 INFO  Start plan generation for analysis DataCorruption...
2022-09-25 01:27:49 INFO  ---RUNTIME: Plan generation took 0.4570484161376953 ms
2022-09-25 01:27:49 INFO  Estimated runtime of original DAG is 6846.562385559082ms
2022-09-25 01:27:49 WARNING Skipping Multi-Query Optimization (instead, only applying patches)
2022-09-25 01:27:49 INFO  Estimated unoptimised what-if runtime is 171164.05963897705ms
2022-09-25 01:27:49 INFO  ---RUNTIME: Multi-Query Optimization took 228.7766933441162 ms
2022-09-25 01:27:49 INFO  Executing generated plans
2022-09-25 01:30:55 INFO  ---RUNTIME: Execution took 185847.83554077148 ms
2022-09-25 01:30:55 INFO  Done!
2022-09-25 01:30:55 INFO  # Finished -- repetition 3 of 7 
2022-09-25 01:30:55 INFO  # Optimization benchmark for data_corruption with args [['reviews', 'fast_loading', 'featurization_0', 'xgboost']] -- repetition 4 of 7
2022-09-25 01:30:55 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-25 01:30:55 INFO  Running instrumented original pipeline...
2022-09-25 01:30:55 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-25 01:30:55 INFO  ---RUNTIME: Importing and monkey-patching took 6.232023239135742 ms
2022-09-25 01:31:02 INFO  ---RUNTIME: Original pipeline execution took 7144.513130187988 ms (excluding imports and monkey-patching)
2022-09-25 01:31:02 INFO  Starting execution of 1 what-if analyses...
2022-09-25 01:31:02 INFO  Start plan generation for analysis DataCorruption...
2022-09-25 01:31:02 INFO  ---RUNTIME: Plan generation took 0.4730224609375 ms
2022-09-25 01:31:02 INFO  Estimated runtime of original DAG is 6855.093002319336ms
2022-09-25 01:31:02 INFO  Performing Multi-Query Optimization
2022-09-25 01:31:02 INFO  Estimated unoptimized what-if runtime is 171377.3250579834ms
2022-09-25 01:31:02 INFO  Estimated optimised what-if runtime is 20524.293899536133ms
2022-09-25 01:31:02 INFO  Estimated optimisation runtime saving is 150853.03115844727ms
2022-09-25 01:31:02 INFO  ---RUNTIME: Multi-Query Optimization took 59.557437896728516 ms
2022-09-25 01:31:02 INFO  Executing generated plans
2022-09-25 01:31:28 INFO  ---RUNTIME: Execution took 25389.56332206726 ms
2022-09-25 01:31:28 INFO  Done!
2022-09-25 01:31:28 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-25 01:31:28 INFO  Running instrumented original pipeline...
2022-09-25 01:31:28 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-25 01:31:28 INFO  ---RUNTIME: Importing and monkey-patching took 6.132841110229492 ms
2022-09-25 01:31:35 INFO  ---RUNTIME: Original pipeline execution took 7141.606330871582 ms (excluding imports and monkey-patching)
2022-09-25 01:31:35 INFO  Starting execution of 1 what-if analyses...
2022-09-25 01:31:35 INFO  Start plan generation for analysis DataCorruption...
2022-09-25 01:31:35 INFO  ---RUNTIME: Plan generation took 0.4324913024902344 ms
2022-09-25 01:31:35 INFO  Estimated runtime of original DAG is 6854.964733123779ms
2022-09-25 01:31:35 WARNING Skipping Multi-Query Optimization (instead, only applying patches)
2022-09-25 01:31:35 INFO  Estimated unoptimised what-if runtime is 171374.11832809448ms
2022-09-25 01:31:35 INFO  ---RUNTIME: Multi-Query Optimization took 17.858505249023438 ms
2022-09-25 01:31:35 INFO  Executing generated plans
2022-09-25 01:34:41 INFO  ---RUNTIME: Execution took 185793.80869865417 ms
2022-09-25 01:34:41 INFO  Done!
2022-09-25 01:34:41 INFO  # Finished -- repetition 4 of 7 
2022-09-25 01:34:41 INFO  # Optimization benchmark for data_corruption with args [['reviews', 'fast_loading', 'featurization_0', 'xgboost']] -- repetition 5 of 7
2022-09-25 01:34:41 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-25 01:34:41 INFO  Running instrumented original pipeline...
2022-09-25 01:34:41 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-25 01:34:41 INFO  ---RUNTIME: Importing and monkey-patching took 6.508588790893555 ms
2022-09-25 01:34:48 INFO  ---RUNTIME: Original pipeline execution took 7133.781671524048 ms (excluding imports and monkey-patching)
2022-09-25 01:34:48 INFO  Starting execution of 1 what-if analyses...
2022-09-25 01:34:48 INFO  Start plan generation for analysis DataCorruption...
2022-09-25 01:34:48 INFO  ---RUNTIME: Plan generation took 0.44417381286621094 ms
2022-09-25 01:34:48 INFO  Estimated runtime of original DAG is 6845.988512039185ms
2022-09-25 01:34:48 INFO  Performing Multi-Query Optimization
2022-09-25 01:34:48 INFO  Estimated unoptimized what-if runtime is 171149.7128009796ms
2022-09-25 01:34:48 INFO  Estimated optimised what-if runtime is 20428.02906036377ms
2022-09-25 01:34:48 INFO  Estimated optimisation runtime saving is 150721.68374061584ms
2022-09-25 01:34:48 INFO  ---RUNTIME: Multi-Query Optimization took 59.055328369140625 ms
2022-09-25 01:34:48 INFO  Executing generated plans
2022-09-25 01:35:13 INFO  ---RUNTIME: Execution took 25384.24849510193 ms
2022-09-25 01:35:13 INFO  Done!
2022-09-25 01:35:13 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-25 01:35:13 INFO  Running instrumented original pipeline...
2022-09-25 01:35:13 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-25 01:35:13 INFO  ---RUNTIME: Importing and monkey-patching took 6.127357482910156 ms
2022-09-25 01:35:20 INFO  ---RUNTIME: Original pipeline execution took 7153.311967849731 ms (excluding imports and monkey-patching)
2022-09-25 01:35:20 INFO  Starting execution of 1 what-if analyses...
2022-09-25 01:35:20 INFO  Start plan generation for analysis DataCorruption...
2022-09-25 01:35:20 INFO  ---RUNTIME: Plan generation took 1.3213157653808594 ms
2022-09-25 01:35:20 INFO  Estimated runtime of original DAG is 6867.260217666626ms
2022-09-25 01:35:20 WARNING Skipping Multi-Query Optimization (instead, only applying patches)
2022-09-25 01:35:20 INFO  Estimated unoptimised what-if runtime is 171681.50544166565ms
2022-09-25 01:35:20 INFO  ---RUNTIME: Multi-Query Optimization took 17.000436782836914 ms
2022-09-25 01:35:20 INFO  Executing generated plans
2022-09-25 01:38:25 INFO  ---RUNTIME: Execution took 185032.32288360596 ms
2022-09-25 01:38:25 INFO  Done!
2022-09-25 01:38:25 INFO  # Finished -- repetition 5 of 7 
2022-09-25 01:38:25 INFO  # Optimization benchmark for data_corruption with args [['reviews', 'fast_loading', 'featurization_0', 'xgboost']] -- repetition 6 of 7
2022-09-25 01:38:25 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-25 01:38:25 INFO  Running instrumented original pipeline...
2022-09-25 01:38:25 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-25 01:38:25 INFO  ---RUNTIME: Importing and monkey-patching took 6.384849548339844 ms
2022-09-25 01:38:33 INFO  ---RUNTIME: Original pipeline execution took 7132.281303405762 ms (excluding imports and monkey-patching)
2022-09-25 01:38:33 INFO  Starting execution of 1 what-if analyses...
2022-09-25 01:38:33 INFO  Start plan generation for analysis DataCorruption...
2022-09-25 01:38:33 INFO  ---RUNTIME: Plan generation took 1.2853145599365234 ms
2022-09-25 01:38:33 INFO  Estimated runtime of original DAG is 6845.232963562012ms
2022-09-25 01:38:33 INFO  Performing Multi-Query Optimization
2022-09-25 01:38:33 INFO  Estimated unoptimized what-if runtime is 171130.8240890503ms
2022-09-25 01:38:33 INFO  Estimated optimised what-if runtime is 20607.264757156372ms
2022-09-25 01:38:33 INFO  Estimated optimisation runtime saving is 150523.55933189392ms
2022-09-25 01:38:33 INFO  ---RUNTIME: Multi-Query Optimization took 57.57474899291992 ms
2022-09-25 01:38:33 INFO  Executing generated plans
2022-09-25 01:38:58 INFO  ---RUNTIME: Execution took 25221.74096107483 ms
2022-09-25 01:38:58 INFO  Done!
2022-09-25 01:38:58 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-25 01:38:58 INFO  Running instrumented original pipeline...
2022-09-25 01:38:58 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-25 01:38:58 INFO  ---RUNTIME: Importing and monkey-patching took 6.235837936401367 ms
2022-09-25 01:39:05 INFO  ---RUNTIME: Original pipeline execution took 7096.487283706665 ms (excluding imports and monkey-patching)
2022-09-25 01:39:05 INFO  Starting execution of 1 what-if analyses...
2022-09-25 01:39:05 INFO  Start plan generation for analysis DataCorruption...
2022-09-25 01:39:05 INFO  ---RUNTIME: Plan generation took 0.48351287841796875 ms
2022-09-25 01:39:05 INFO  Estimated runtime of original DAG is 6812.407970428467ms
2022-09-25 01:39:05 WARNING Skipping Multi-Query Optimization (instead, only applying patches)
2022-09-25 01:39:05 INFO  Estimated unoptimised what-if runtime is 170310.19926071167ms
2022-09-25 01:39:05 INFO  ---RUNTIME: Multi-Query Optimization took 17.007827758789062 ms
2022-09-25 01:39:05 INFO  Executing generated plans
2022-09-25 01:42:10 INFO  ---RUNTIME: Execution took 184680.19318580627 ms
2022-09-25 01:42:10 INFO  Done!
2022-09-25 01:42:10 INFO  # Finished -- repetition 6 of 7 
2022-09-25 01:42:10 INFO  # Optimization benchmark for data_corruption with args [['reviews', 'fast_loading', 'featurization_0', 'xgboost']] -- repetition 7 of 7
2022-09-25 01:42:10 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-25 01:42:10 INFO  Running instrumented original pipeline...
2022-09-25 01:42:10 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-25 01:42:10 INFO  ---RUNTIME: Importing and monkey-patching took 6.356239318847656 ms
2022-09-25 01:42:17 INFO  ---RUNTIME: Original pipeline execution took 7101.030349731445 ms (excluding imports and monkey-patching)
2022-09-25 01:42:17 INFO  Starting execution of 1 what-if analyses...
2022-09-25 01:42:17 INFO  Start plan generation for analysis DataCorruption...
2022-09-25 01:42:17 INFO  ---RUNTIME: Plan generation took 216.25041961669922 ms
2022-09-25 01:42:17 INFO  Estimated runtime of original DAG is 6818.107604980469ms
2022-09-25 01:42:17 INFO  Performing Multi-Query Optimization
2022-09-25 01:42:17 INFO  Estimated unoptimized what-if runtime is 170452.69012451172ms
2022-09-25 01:42:17 INFO  Estimated optimised what-if runtime is 20400.837898254395ms
2022-09-25 01:42:17 INFO  Estimated optimisation runtime saving is 150051.85222625732ms
2022-09-25 01:42:17 INFO  ---RUNTIME: Multi-Query Optimization took 57.28578567504883 ms
2022-09-25 01:42:17 INFO  Executing generated plans
2022-09-25 01:42:42 INFO  ---RUNTIME: Execution took 25266.772031784058 ms
2022-09-25 01:42:42 INFO  Done!
2022-09-25 01:42:42 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-25 01:42:42 INFO  Running instrumented original pipeline...
2022-09-25 01:42:42 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-25 01:42:42 INFO  ---RUNTIME: Importing and monkey-patching took 6.187915802001953 ms
2022-09-25 01:42:49 INFO  ---RUNTIME: Original pipeline execution took 7104.980707168579 ms (excluding imports and monkey-patching)
2022-09-25 01:42:49 INFO  Starting execution of 1 what-if analyses...
2022-09-25 01:42:49 INFO  Start plan generation for analysis DataCorruption...
2022-09-25 01:42:49 INFO  ---RUNTIME: Plan generation took 0.4398822784423828 ms
2022-09-25 01:42:49 INFO  Estimated runtime of original DAG is 6815.639019012451ms
2022-09-25 01:42:49 WARNING Skipping Multi-Query Optimization (instead, only applying patches)
2022-09-25 01:42:49 INFO  Estimated unoptimised what-if runtime is 170390.97547531128ms
2022-09-25 01:42:49 INFO  ---RUNTIME: Multi-Query Optimization took 16.957759857177734 ms
2022-09-25 01:42:49 INFO  Executing generated plans
2022-09-25 01:45:54 INFO  ---RUNTIME: Execution took 184402.6153087616 ms
2022-09-25 01:45:54 INFO  Done!
2022-09-25 01:45:54 INFO  # Finished -- repetition 7 of 7 
2022-09-25 01:45:54 INFO  # Final results after all repetitions
2022-09-25 01:45:54 INFO     repetition  ... no_opt_what_if_execution_combined_model_training
0           0  ...                                     47159.973621
1           1  ...                                     47073.148966
2           2  ...                                     47168.998003
3           3  ...                                     47138.887405
4           4  ...                                     46863.308430
5           5  ...                                     46980.820179
6           6  ...                                     46657.059908

[7 rows x 26 columns]
PROTOCOL_BUFFERS_PYTHON_IMPLEMENTATION=python taskset -c 32-39 python3.9 benchmarks_end_to_end.py data_corruption reviews fast_loading featurization_0 neural_network
2022-09-25 01:45:56.537967: W tensorflow/stream_executor/platform/default/dso_loader.cc:64] Could not load dynamic library 'libcudart.so.11.0'; dlerror: libcudart.so.11.0: cannot open shared object file: No such file or directory; LD_LIBRARY_PATH: /home/sgrafbe/mlwhatif/venv/lib/python3.9/site-packages/cv2/../../lib64:
2022-09-25 01:45:56.538011: I tensorflow/stream_executor/cuda/cudart_stub.cc:29] Ignore above cudart dlerror if you do not have a GPU set up on your machine.
2022-09-25 01:45:57 INFO  Patching sys.argv with ['mlwhatif', 'reviews', 'fast_loading', 'featurization_0', 'neural_network']
2022-09-25 01:45:57 INFO  Running instrumented original pipeline...
2022-09-25 01:45:57 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-25 01:45:58 INFO  ---RUNTIME: Importing and monkey-patching took 121.71244621276855 ms
2022-09-25 01:46:01.721685: W tensorflow/stream_executor/platform/default/dso_loader.cc:64] Could not load dynamic library 'libcuda.so.1'; dlerror: libcuda.so.1: cannot open shared object file: No such file or directory; LD_LIBRARY_PATH: /home/sgrafbe/mlwhatif/venv/lib/python3.9/site-packages/cv2/../../lib64:
2022-09-25 01:46:01.721722: W tensorflow/stream_executor/cuda/cuda_driver.cc:326] failed call to cuInit: UNKNOWN ERROR (303)
2022-09-25 01:46:01.721745: I tensorflow/stream_executor/cuda/cuda_diagnostics.cc:156] kernel driver does not appear to be running on this host (angus): /proc/driver/nvidia/version does not exist
2022-09-25 01:46:01.722287: I tensorflow/core/platform/cpu_feature_guard.cc:142] This TensorFlow binary is optimized with oneAPI Deep Neural Network Library (oneDNN) to use the following CPU instructions in performance-critical operations:  AVX2 FMA
To enable them in other operations, rebuild TensorFlow with the appropriate compiler flags.
2022-09-25 01:46:01.959896: I tensorflow/compiler/mlir/mlir_graph_optimization_pass.cc:176] None of the MLIR Optimization Passes are enabled (registered 2)
2022-09-25 01:46:01.972187: I tensorflow/core/platform/profile_utils/cpu_utils.cc:114] CPU Frequency: 2595130000 Hz
2022-09-25 01:46:06 INFO  ---RUNTIME: Original pipeline execution took 8982.300758361816 ms (excluding imports and monkey-patching)
2022-09-25 01:46:06 INFO  Starting execution of 0 what-if analyses...
2022-09-25 01:46:06 INFO  Estimated runtime of original DAG is 8656.673908233643ms
2022-09-25 01:46:06 INFO  Performing Multi-Query Optimization
2022-09-25 01:46:06 INFO  Estimated unoptimized what-if runtime is 0ms
2022-09-25 01:46:06 INFO  Estimated optimised what-if runtime is 0ms
2022-09-25 01:46:06 INFO  Estimated optimisation runtime saving is 0ms
2022-09-25 01:46:06 INFO  ---RUNTIME: Multi-Query Optimization took 0.4513263702392578 ms
2022-09-25 01:46:06 INFO  Executing generated plans
2022-09-25 01:46:06 INFO  ---RUNTIME: Execution took 0.022649765014648438 ms
2022-09-25 01:46:06 INFO  Done!
2022-09-25 01:46:06 INFO  # Optimization benchmark for data_corruption with args [['reviews', 'fast_loading', 'featurization_0', 'neural_network']] -- repetition 1 of 7
2022-09-25 01:46:06 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-25 01:46:06 INFO  Running instrumented original pipeline...
2022-09-25 01:46:06 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-25 01:46:07 INFO  ---RUNTIME: Importing and monkey-patching took 5.425691604614258 ms
2022-09-25 01:46:15 INFO  ---RUNTIME: Original pipeline execution took 8536.33713722229 ms (excluding imports and monkey-patching)
2022-09-25 01:46:15 INFO  Starting execution of 1 what-if analyses...
2022-09-25 01:46:15 INFO  Start plan generation for analysis DataCorruption...
2022-09-25 01:46:15 INFO  ---RUNTIME: Plan generation took 2.0856857299804688 ms
2022-09-25 01:46:15 INFO  Estimated runtime of original DAG is 8245.381832122803ms
2022-09-25 01:46:15 INFO  Performing Multi-Query Optimization
2022-09-25 01:46:15 INFO  Estimated unoptimized what-if runtime is 206134.54580307007ms
2022-09-25 01:46:15 INFO  Estimated optimised what-if runtime is 24099.977493286133ms
2022-09-25 01:46:15 INFO  Estimated optimisation runtime saving is 182034.56830978394ms
2022-09-25 01:46:15 INFO  ---RUNTIME: Multi-Query Optimization took 62.06941604614258 ms
2022-09-25 01:46:15 INFO  Executing generated plans
2022-09-25 01:46:44 INFO  ---RUNTIME: Execution took 28884.387016296387 ms
2022-09-25 01:46:44 INFO  Done!
2022-09-25 01:46:44 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-25 01:46:44 INFO  Running instrumented original pipeline...
2022-09-25 01:46:44 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-25 01:46:44 INFO  ---RUNTIME: Importing and monkey-patching took 6.133079528808594 ms
2022-09-25 01:46:52 INFO  ---RUNTIME: Original pipeline execution took 8526.538372039795 ms (excluding imports and monkey-patching)
2022-09-25 01:46:52 INFO  Starting execution of 1 what-if analyses...
2022-09-25 01:46:52 INFO  Start plan generation for analysis DataCorruption...
2022-09-25 01:46:52 INFO  ---RUNTIME: Plan generation took 0.5035400390625 ms
2022-09-25 01:46:52 INFO  Estimated runtime of original DAG is 8237.228631973267ms
2022-09-25 01:46:52 WARNING Skipping Multi-Query Optimization (instead, only applying patches)
2022-09-25 01:46:53 INFO  Estimated unoptimised what-if runtime is 205930.71579933167ms
2022-09-25 01:46:53 INFO  ---RUNTIME: Multi-Query Optimization took 17.292499542236328 ms
2022-09-25 01:46:53 INFO  Executing generated plans
2022-09-25 01:50:34 INFO  ---RUNTIME: Execution took 221785.55917739868 ms
2022-09-25 01:50:34 INFO  Done!
2022-09-25 01:50:34 INFO  # Finished -- repetition 1 of 7 
2022-09-25 01:50:34 INFO  # Optimization benchmark for data_corruption with args [['reviews', 'fast_loading', 'featurization_0', 'neural_network']] -- repetition 2 of 7
2022-09-25 01:50:34 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-25 01:50:34 INFO  Running instrumented original pipeline...
2022-09-25 01:50:34 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-25 01:50:34 INFO  ---RUNTIME: Importing and monkey-patching took 8.079290390014648 ms
2022-09-25 01:50:43 INFO  ---RUNTIME: Original pipeline execution took 8642.616748809814 ms (excluding imports and monkey-patching)
2022-09-25 01:50:43 INFO  Starting execution of 1 what-if analyses...
2022-09-25 01:50:43 INFO  Start plan generation for analysis DataCorruption...
2022-09-25 01:50:43 INFO  ---RUNTIME: Plan generation took 0.42700767517089844 ms
2022-09-25 01:50:43 INFO  Estimated runtime of original DAG is 8351.875066757202ms
2022-09-25 01:50:43 INFO  Performing Multi-Query Optimization
2022-09-25 01:50:43 INFO  Estimated unoptimized what-if runtime is 208796.87666893005ms
2022-09-25 01:50:43 INFO  Estimated optimised what-if runtime is 24723.45781326294ms
2022-09-25 01:50:43 INFO  Estimated optimisation runtime saving is 184073.4188556671ms
2022-09-25 01:50:43 INFO  ---RUNTIME: Multi-Query Optimization took 59.95965003967285 ms
2022-09-25 01:50:43 INFO  Executing generated plans
2022-09-25 01:51:12 INFO  ---RUNTIME: Execution took 28575.047731399536 ms
2022-09-25 01:51:12 INFO  Done!
2022-09-25 01:51:12 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-25 01:51:12 INFO  Running instrumented original pipeline...
2022-09-25 01:51:12 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-25 01:51:12 INFO  ---RUNTIME: Importing and monkey-patching took 6.607532501220703 ms
2022-09-25 01:51:20 INFO  ---RUNTIME: Original pipeline execution took 8861.52195930481 ms (excluding imports and monkey-patching)
2022-09-25 01:51:20 INFO  Starting execution of 1 what-if analyses...
2022-09-25 01:51:20 INFO  Start plan generation for analysis DataCorruption...
2022-09-25 01:51:20 INFO  ---RUNTIME: Plan generation took 1.941680908203125 ms
2022-09-25 01:51:20 INFO  Estimated runtime of original DAG is 8560.615539550781ms
2022-09-25 01:51:20 WARNING Skipping Multi-Query Optimization (instead, only applying patches)
2022-09-25 01:51:20 INFO  Estimated unoptimised what-if runtime is 214015.38848876953ms
2022-09-25 01:51:20 INFO  ---RUNTIME: Multi-Query Optimization took 17.464637756347656 ms
2022-09-25 01:51:20 INFO  Executing generated plans
2022-09-25 01:55:02 INFO  ---RUNTIME: Execution took 221549.58963394165 ms
2022-09-25 01:55:02 INFO  Done!
2022-09-25 01:55:02 INFO  # Finished -- repetition 2 of 7 
2022-09-25 01:55:02 INFO  # Optimization benchmark for data_corruption with args [['reviews', 'fast_loading', 'featurization_0', 'neural_network']] -- repetition 3 of 7
2022-09-25 01:55:02 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-25 01:55:02 INFO  Running instrumented original pipeline...
2022-09-25 01:55:02 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-25 01:55:02 INFO  ---RUNTIME: Importing and monkey-patching took 5.93256950378418 ms
2022-09-25 01:55:11 INFO  ---RUNTIME: Original pipeline execution took 8554.443359375 ms (excluding imports and monkey-patching)
2022-09-25 01:55:11 INFO  Starting execution of 1 what-if analyses...
2022-09-25 01:55:11 INFO  Start plan generation for analysis DataCorruption...
2022-09-25 01:55:11 INFO  ---RUNTIME: Plan generation took 0.47326087951660156 ms
2022-09-25 01:55:11 INFO  Estimated runtime of original DAG is 8253.541469573975ms
2022-09-25 01:55:11 INFO  Performing Multi-Query Optimization
2022-09-25 01:55:11 INFO  Estimated unoptimized what-if runtime is 206338.53673934937ms
2022-09-25 01:55:11 INFO  Estimated optimised what-if runtime is 24321.342706680298ms
2022-09-25 01:55:11 INFO  Estimated optimisation runtime saving is 182017.19403266907ms
2022-09-25 01:55:11 INFO  ---RUNTIME: Multi-Query Optimization took 60.099124908447266 ms
2022-09-25 01:55:11 INFO  Executing generated plans
2022-09-25 01:55:40 INFO  ---RUNTIME: Execution took 29283.697605133057 ms
2022-09-25 01:55:40 INFO  Done!
2022-09-25 01:55:40 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-25 01:55:40 INFO  Running instrumented original pipeline...
2022-09-25 01:55:40 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-25 01:55:40 INFO  ---RUNTIME: Importing and monkey-patching took 7.476329803466797 ms
2022-09-25 01:55:49 INFO  ---RUNTIME: Original pipeline execution took 8727.334022521973 ms (excluding imports and monkey-patching)
2022-09-25 01:55:49 INFO  Starting execution of 1 what-if analyses...
2022-09-25 01:55:49 INFO  Start plan generation for analysis DataCorruption...
2022-09-25 01:55:49 INFO  ---RUNTIME: Plan generation took 0.4360675811767578 ms
2022-09-25 01:55:49 INFO  Estimated runtime of original DAG is 8419.741868972778ms
2022-09-25 01:55:49 WARNING Skipping Multi-Query Optimization (instead, only applying patches)
2022-09-25 01:55:49 INFO  Estimated unoptimised what-if runtime is 210493.54672431946ms
2022-09-25 01:55:49 INFO  ---RUNTIME: Multi-Query Optimization took 17.670154571533203 ms
2022-09-25 01:55:49 INFO  Executing generated plans
2022-09-25 01:59:30 INFO  ---RUNTIME: Execution took 221768.84174346924 ms
2022-09-25 01:59:30 INFO  Done!
2022-09-25 01:59:31 INFO  # Finished -- repetition 3 of 7 
2022-09-25 01:59:31 INFO  # Optimization benchmark for data_corruption with args [['reviews', 'fast_loading', 'featurization_0', 'neural_network']] -- repetition 4 of 7
2022-09-25 01:59:31 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-25 01:59:31 INFO  Running instrumented original pipeline...
2022-09-25 01:59:31 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-25 01:59:31 INFO  ---RUNTIME: Importing and monkey-patching took 6.401777267456055 ms
2022-09-25 01:59:40 INFO  ---RUNTIME: Original pipeline execution took 8982.843160629272 ms (excluding imports and monkey-patching)
2022-09-25 01:59:40 INFO  Starting execution of 1 what-if analyses...
2022-09-25 01:59:40 INFO  Start plan generation for analysis DataCorruption...
2022-09-25 01:59:40 INFO  ---RUNTIME: Plan generation took 0.4303455352783203 ms
2022-09-25 01:59:40 INFO  Estimated runtime of original DAG is 8687.998056411743ms
2022-09-25 01:59:40 INFO  Performing Multi-Query Optimization
2022-09-25 01:59:40 INFO  Estimated unoptimized what-if runtime is 217199.95141029358ms
2022-09-25 01:59:40 INFO  Estimated optimised what-if runtime is 24850.754499435425ms
2022-09-25 01:59:40 INFO  Estimated optimisation runtime saving is 192349.19691085815ms
2022-09-25 01:59:40 INFO  ---RUNTIME: Multi-Query Optimization took 59.18264389038086 ms
2022-09-25 01:59:40 INFO  Executing generated plans
2022-09-25 02:00:08 INFO  ---RUNTIME: Execution took 28802.921772003174 ms
2022-09-25 02:00:08 INFO  Done!
2022-09-25 02:00:08 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-25 02:00:08 INFO  Running instrumented original pipeline...
2022-09-25 02:00:08 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-25 02:00:08 INFO  ---RUNTIME: Importing and monkey-patching took 6.898403167724609 ms
2022-09-25 02:00:17 INFO  ---RUNTIME: Original pipeline execution took 8690.868616104126 ms (excluding imports and monkey-patching)
2022-09-25 02:00:17 INFO  Starting execution of 1 what-if analyses...
2022-09-25 02:00:17 INFO  Start plan generation for analysis DataCorruption...
2022-09-25 02:00:17 INFO  ---RUNTIME: Plan generation took 0.4563331604003906 ms
2022-09-25 02:00:17 INFO  Estimated runtime of original DAG is 8388.699293136597ms
2022-09-25 02:00:17 WARNING Skipping Multi-Query Optimization (instead, only applying patches)
2022-09-25 02:00:17 INFO  Estimated unoptimised what-if runtime is 209717.48232841492ms
2022-09-25 02:00:17 INFO  ---RUNTIME: Multi-Query Optimization took 18.09382438659668 ms
2022-09-25 02:00:17 INFO  Executing generated plans
2022-09-25 02:03:59 INFO  ---RUNTIME: Execution took 221745.73230743408 ms
2022-09-25 02:03:59 INFO  Done!
2022-09-25 02:03:59 INFO  # Finished -- repetition 4 of 7 
2022-09-25 02:03:59 INFO  # Optimization benchmark for data_corruption with args [['reviews', 'fast_loading', 'featurization_0', 'neural_network']] -- repetition 5 of 7
2022-09-25 02:03:59 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-25 02:03:59 INFO  Running instrumented original pipeline...
2022-09-25 02:03:59 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-25 02:03:59 INFO  ---RUNTIME: Importing and monkey-patching took 5.954265594482422 ms
2022-09-25 02:04:08 INFO  ---RUNTIME: Original pipeline execution took 9020.561218261719 ms (excluding imports and monkey-patching)
2022-09-25 02:04:08 INFO  Starting execution of 1 what-if analyses...
2022-09-25 02:04:08 INFO  Start plan generation for analysis DataCorruption...
2022-09-25 02:04:08 INFO  ---RUNTIME: Plan generation took 0.47206878662109375 ms
2022-09-25 02:04:08 INFO  Estimated runtime of original DAG is 8285.56227684021ms
2022-09-25 02:04:08 INFO  Performing Multi-Query Optimization
2022-09-25 02:04:08 INFO  Estimated unoptimized what-if runtime is 207139.05692100525ms
2022-09-25 02:04:08 INFO  Estimated optimised what-if runtime is 24515.3489112854ms
2022-09-25 02:04:08 INFO  Estimated optimisation runtime saving is 182623.70800971985ms
2022-09-25 02:04:08 INFO  ---RUNTIME: Multi-Query Optimization took 60.62722206115723 ms
2022-09-25 02:04:08 INFO  Executing generated plans
2022-09-25 02:04:37 INFO  ---RUNTIME: Execution took 28625.471353530884 ms
2022-09-25 02:04:37 INFO  Done!
2022-09-25 02:04:37 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-25 02:04:37 INFO  Running instrumented original pipeline...
2022-09-25 02:04:37 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-25 02:04:37 INFO  ---RUNTIME: Importing and monkey-patching took 6.23011589050293 ms
2022-09-25 02:04:45 INFO  ---RUNTIME: Original pipeline execution took 8575.82950592041 ms (excluding imports and monkey-patching)
2022-09-25 02:04:45 INFO  Starting execution of 1 what-if analyses...
2022-09-25 02:04:45 INFO  Start plan generation for analysis DataCorruption...
2022-09-25 02:04:45 INFO  ---RUNTIME: Plan generation took 0.5295276641845703 ms
2022-09-25 02:04:45 INFO  Estimated runtime of original DAG is 8278.27262878418ms
2022-09-25 02:04:45 WARNING Skipping Multi-Query Optimization (instead, only applying patches)
2022-09-25 02:04:45 INFO  Estimated unoptimised what-if runtime is 206956.8157196045ms
2022-09-25 02:04:45 INFO  ---RUNTIME: Multi-Query Optimization took 17.79651641845703 ms
2022-09-25 02:04:45 INFO  Executing generated plans
2022-09-25 02:08:27 INFO  ---RUNTIME: Execution took 222224.64418411255 ms
2022-09-25 02:08:27 INFO  Done!
2022-09-25 02:08:27 INFO  # Finished -- repetition 5 of 7 
2022-09-25 02:08:27 INFO  # Optimization benchmark for data_corruption with args [['reviews', 'fast_loading', 'featurization_0', 'neural_network']] -- repetition 6 of 7
2022-09-25 02:08:27 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-25 02:08:27 INFO  Running instrumented original pipeline...
2022-09-25 02:08:28 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-25 02:08:28 INFO  ---RUNTIME: Importing and monkey-patching took 6.467580795288086 ms
2022-09-25 02:08:37 INFO  ---RUNTIME: Original pipeline execution took 9060.279369354248 ms (excluding imports and monkey-patching)
2022-09-25 02:08:37 INFO  Starting execution of 1 what-if analyses...
2022-09-25 02:08:37 INFO  Start plan generation for analysis DataCorruption...
2022-09-25 02:08:37 INFO  ---RUNTIME: Plan generation took 1.8544197082519531 ms
2022-09-25 02:08:37 INFO  Estimated runtime of original DAG is 8770.297765731812ms
2022-09-25 02:08:37 INFO  Performing Multi-Query Optimization
2022-09-25 02:08:37 INFO  Estimated unoptimized what-if runtime is 219257.4441432953ms
2022-09-25 02:08:37 INFO  Estimated optimised what-if runtime is 24400.77257156372ms
2022-09-25 02:08:37 INFO  Estimated optimisation runtime saving is 194856.67157173157ms
2022-09-25 02:08:37 INFO  ---RUNTIME: Multi-Query Optimization took 58.45808982849121 ms
2022-09-25 02:08:37 INFO  Executing generated plans
2022-09-25 02:09:05 INFO  ---RUNTIME: Execution took 28819.07343864441 ms
2022-09-25 02:09:05 INFO  Done!
2022-09-25 02:09:05 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-25 02:09:05 INFO  Running instrumented original pipeline...
2022-09-25 02:09:05 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-25 02:09:05 INFO  ---RUNTIME: Importing and monkey-patching took 6.190061569213867 ms
2022-09-25 02:09:14 INFO  ---RUNTIME: Original pipeline execution took 8686.381578445435 ms (excluding imports and monkey-patching)
2022-09-25 02:09:14 INFO  Starting execution of 1 what-if analyses...
2022-09-25 02:09:14 INFO  Start plan generation for analysis DataCorruption...
2022-09-25 02:09:14 INFO  ---RUNTIME: Plan generation took 0.44536590576171875 ms
2022-09-25 02:09:14 INFO  Estimated runtime of original DAG is 8383.366823196411ms
2022-09-25 02:09:14 WARNING Skipping Multi-Query Optimization (instead, only applying patches)
2022-09-25 02:09:14 INFO  Estimated unoptimised what-if runtime is 209584.17057991028ms
2022-09-25 02:09:14 INFO  ---RUNTIME: Multi-Query Optimization took 18.88728141784668 ms
2022-09-25 02:09:14 INFO  Executing generated plans
2022-09-25 02:12:57 INFO  ---RUNTIME: Execution took 222446.00129127502 ms
2022-09-25 02:12:57 INFO  Done!
2022-09-25 02:12:57 INFO  # Finished -- repetition 6 of 7 
2022-09-25 02:12:57 INFO  # Optimization benchmark for data_corruption with args [['reviews', 'fast_loading', 'featurization_0', 'neural_network']] -- repetition 7 of 7
2022-09-25 02:12:57 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-25 02:12:57 INFO  Running instrumented original pipeline...
2022-09-25 02:12:57 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-25 02:12:57 INFO  ---RUNTIME: Importing and monkey-patching took 6.773471832275391 ms
2022-09-25 02:13:05 INFO  ---RUNTIME: Original pipeline execution took 8568.3434009552 ms (excluding imports and monkey-patching)
2022-09-25 02:13:05 INFO  Starting execution of 1 what-if analyses...
2022-09-25 02:13:05 INFO  Start plan generation for analysis DataCorruption...
2022-09-25 02:13:05 INFO  ---RUNTIME: Plan generation took 0.4436969757080078 ms
2022-09-25 02:13:05 INFO  Estimated runtime of original DAG is 8268.663167953491ms
2022-09-25 02:13:05 INFO  Performing Multi-Query Optimization
2022-09-25 02:13:05 INFO  Estimated unoptimized what-if runtime is 206716.57919883728ms
2022-09-25 02:13:05 INFO  Estimated optimised what-if runtime is 23940.706729888916ms
2022-09-25 02:13:05 INFO  Estimated optimisation runtime saving is 182775.87246894836ms
2022-09-25 02:13:05 INFO  ---RUNTIME: Multi-Query Optimization took 59.595346450805664 ms
2022-09-25 02:13:05 INFO  Executing generated plans
2022-09-25 02:13:34 INFO  ---RUNTIME: Execution took 29158.21123123169 ms
2022-09-25 02:13:34 INFO  Done!
2022-09-25 02:13:34 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-25 02:13:34 INFO  Running instrumented original pipeline...
2022-09-25 02:13:34 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-25 02:13:34 INFO  ---RUNTIME: Importing and monkey-patching took 5.975961685180664 ms
2022-09-25 02:13:43 INFO  ---RUNTIME: Original pipeline execution took 8605.097532272339 ms (excluding imports and monkey-patching)
2022-09-25 02:13:43 INFO  Starting execution of 1 what-if analyses...
2022-09-25 02:13:43 INFO  Start plan generation for analysis DataCorruption...
2022-09-25 02:13:43 INFO  ---RUNTIME: Plan generation took 0.45418739318847656 ms
2022-09-25 02:13:43 INFO  Estimated runtime of original DAG is 8306.408882141113ms
2022-09-25 02:13:43 WARNING Skipping Multi-Query Optimization (instead, only applying patches)
2022-09-25 02:13:43 INFO  Estimated unoptimised what-if runtime is 207660.22205352783ms
2022-09-25 02:13:43 INFO  ---RUNTIME: Multi-Query Optimization took 18.20540428161621 ms
2022-09-25 02:13:43 INFO  Executing generated plans
2022-09-25 02:17:32 INFO  ---RUNTIME: Execution took 229428.49278450012 ms
2022-09-25 02:17:32 INFO  Done!
2022-09-25 02:17:32 INFO  # Finished -- repetition 7 of 7 
2022-09-25 02:17:32 INFO  # Final results after all repetitions
2022-09-25 02:17:32 INFO     repetition  ... no_opt_what_if_execution_combined_model_training
0           0  ...                                     80123.604774
1           1  ...                                     80016.464949
2           2  ...                                     80125.354052
3           3  ...                                     79499.366522
4           4  ...                                     80379.586697
5           5  ...                                     80460.997343
6           6  ...                                     83904.635429

[7 rows x 26 columns]
PROTOCOL_BUFFERS_PYTHON_IMPLEMENTATION=python taskset -c 32-39 python3.9 benchmarks_end_to_end.py data_corruption reviews fast_loading featurization_1 logistic_regression
2022-09-25 02:17:35.407644: W tensorflow/stream_executor/platform/default/dso_loader.cc:64] Could not load dynamic library 'libcudart.so.11.0'; dlerror: libcudart.so.11.0: cannot open shared object file: No such file or directory; LD_LIBRARY_PATH: /home/sgrafbe/mlwhatif/venv/lib/python3.9/site-packages/cv2/../../lib64:
2022-09-25 02:17:35.407690: I tensorflow/stream_executor/cuda/cudart_stub.cc:29] Ignore above cudart dlerror if you do not have a GPU set up on your machine.
2022-09-25 02:17:36 INFO  Patching sys.argv with ['mlwhatif', 'reviews', 'fast_loading', 'featurization_1', 'logistic_regression']
2022-09-25 02:17:36 INFO  Running instrumented original pipeline...
2022-09-25 02:17:36 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-25 02:17:36 INFO  ---RUNTIME: Importing and monkey-patching took 122.44629859924316 ms
2022-09-25 02:17:42 INFO  ---RUNTIME: Original pipeline execution took 5483.388185501099 ms (excluding imports and monkey-patching)
2022-09-25 02:17:42 INFO  Starting execution of 0 what-if analyses...
2022-09-25 02:17:42 INFO  Estimated runtime of original DAG is 5142.213821411133ms
2022-09-25 02:17:42 INFO  Performing Multi-Query Optimization
2022-09-25 02:17:42 INFO  Estimated unoptimized what-if runtime is 0ms
2022-09-25 02:17:42 INFO  Estimated optimised what-if runtime is 0ms
2022-09-25 02:17:42 INFO  Estimated optimisation runtime saving is 0ms
2022-09-25 02:17:42 INFO  ---RUNTIME: Multi-Query Optimization took 0.5598068237304688 ms
2022-09-25 02:17:42 INFO  Executing generated plans
2022-09-25 02:17:42 INFO  ---RUNTIME: Execution took 0.03552436828613281 ms
2022-09-25 02:17:42 INFO  Done!
2022-09-25 02:17:42 INFO  # Optimization benchmark for data_corruption with args [['reviews', 'fast_loading', 'featurization_1', 'logistic_regression']] -- repetition 1 of 7
2022-09-25 02:17:42 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-25 02:17:42 INFO  Running instrumented original pipeline...
2022-09-25 02:17:42 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-25 02:17:42 INFO  ---RUNTIME: Importing and monkey-patching took 6.506919860839844 ms
2022-09-25 02:17:47 INFO  ---RUNTIME: Original pipeline execution took 5462.141036987305 ms (excluding imports and monkey-patching)
2022-09-25 02:17:47 INFO  Starting execution of 1 what-if analyses...
2022-09-25 02:17:47 INFO  Start plan generation for analysis DataCorruption...
2022-09-25 02:17:47 INFO  ---RUNTIME: Plan generation took 0.5085468292236328 ms
2022-09-25 02:17:47 INFO  Estimated runtime of original DAG is 4956.538915634155ms
2022-09-25 02:17:47 INFO  Performing Multi-Query Optimization
2022-09-25 02:17:47 INFO  Estimated unoptimized what-if runtime is 123913.47289085388ms
2022-09-25 02:17:47 INFO  Estimated optimised what-if runtime is 11653.059244155884ms
2022-09-25 02:17:47 INFO  Estimated optimisation runtime saving is 112260.413646698ms
2022-09-25 02:17:47 INFO  ---RUNTIME: Multi-Query Optimization took 63.550710678100586 ms
2022-09-25 02:17:47 INFO  Executing generated plans
2022-09-25 02:18:04 INFO  ---RUNTIME: Execution took 16972.396850585938 ms
2022-09-25 02:18:04 INFO  Done!
2022-09-25 02:18:04 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-25 02:18:04 INFO  Running instrumented original pipeline...
2022-09-25 02:18:04 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-25 02:18:04 INFO  ---RUNTIME: Importing and monkey-patching took 6.221294403076172 ms
2022-09-25 02:18:10 INFO  ---RUNTIME: Original pipeline execution took 5364.426374435425 ms (excluding imports and monkey-patching)
2022-09-25 02:18:10 INFO  Starting execution of 1 what-if analyses...
2022-09-25 02:18:10 INFO  Start plan generation for analysis DataCorruption...
2022-09-25 02:18:10 INFO  ---RUNTIME: Plan generation took 0.49686431884765625 ms
2022-09-25 02:18:10 INFO  Estimated runtime of original DAG is 5061.644554138184ms
2022-09-25 02:18:10 WARNING Skipping Multi-Query Optimization (instead, only applying patches)
2022-09-25 02:18:10 INFO  Estimated unoptimised what-if runtime is 126541.11385345459ms
2022-09-25 02:18:10 INFO  ---RUNTIME: Multi-Query Optimization took 19.040346145629883 ms
2022-09-25 02:18:10 INFO  Executing generated plans
2022-09-25 02:20:29 INFO  ---RUNTIME: Execution took 138875.12874603271 ms
2022-09-25 02:20:29 INFO  Done!
2022-09-25 02:20:29 INFO  # Finished -- repetition 1 of 7 
2022-09-25 02:20:29 INFO  # Optimization benchmark for data_corruption with args [['reviews', 'fast_loading', 'featurization_1', 'logistic_regression']] -- repetition 2 of 7
2022-09-25 02:20:29 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-25 02:20:29 INFO  Running instrumented original pipeline...
2022-09-25 02:20:29 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-25 02:20:29 INFO  ---RUNTIME: Importing and monkey-patching took 6.253480911254883 ms
2022-09-25 02:20:34 INFO  ---RUNTIME: Original pipeline execution took 5204.294681549072 ms (excluding imports and monkey-patching)
2022-09-25 02:20:34 INFO  Starting execution of 1 what-if analyses...
2022-09-25 02:20:34 INFO  Start plan generation for analysis DataCorruption...
2022-09-25 02:20:34 INFO  ---RUNTIME: Plan generation took 0.4723072052001953 ms
2022-09-25 02:20:34 INFO  Estimated runtime of original DAG is 4916.276454925537ms
2022-09-25 02:20:34 INFO  Performing Multi-Query Optimization
2022-09-25 02:20:34 INFO  Estimated unoptimized what-if runtime is 122906.91137313843ms
2022-09-25 02:20:34 INFO  Estimated optimised what-if runtime is 11803.95770072937ms
2022-09-25 02:20:34 INFO  Estimated optimisation runtime saving is 111102.95367240906ms
2022-09-25 02:20:34 INFO  ---RUNTIME: Multi-Query Optimization took 63.73786926269531 ms
2022-09-25 02:20:34 INFO  Executing generated plans
2022-09-25 02:20:50 INFO  ---RUNTIME: Execution took 16515.942573547363 ms
2022-09-25 02:20:50 INFO  Done!
2022-09-25 02:20:50 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-25 02:20:50 INFO  Running instrumented original pipeline...
2022-09-25 02:20:50 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-25 02:20:50 INFO  ---RUNTIME: Importing and monkey-patching took 5.995512008666992 ms
2022-09-25 02:20:56 INFO  ---RUNTIME: Original pipeline execution took 5158.954381942749 ms (excluding imports and monkey-patching)
2022-09-25 02:20:56 INFO  Starting execution of 1 what-if analyses...
2022-09-25 02:20:56 INFO  Start plan generation for analysis DataCorruption...
2022-09-25 02:20:56 INFO  ---RUNTIME: Plan generation took 0.457763671875 ms
2022-09-25 02:20:56 INFO  Estimated runtime of original DAG is 4865.492820739746ms
2022-09-25 02:20:56 WARNING Skipping Multi-Query Optimization (instead, only applying patches)
2022-09-25 02:20:56 INFO  Estimated unoptimised what-if runtime is 121637.32051849365ms
2022-09-25 02:20:56 INFO  ---RUNTIME: Multi-Query Optimization took 19.72341537475586 ms
2022-09-25 02:20:56 INFO  Executing generated plans
2022-09-25 02:23:17 INFO  ---RUNTIME: Execution took 141420.39728164673 ms
2022-09-25 02:23:17 INFO  Done!
2022-09-25 02:23:17 INFO  # Finished -- repetition 2 of 7 
2022-09-25 02:23:17 INFO  # Optimization benchmark for data_corruption with args [['reviews', 'fast_loading', 'featurization_1', 'logistic_regression']] -- repetition 3 of 7
2022-09-25 02:23:17 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-25 02:23:17 INFO  Running instrumented original pipeline...
2022-09-25 02:23:17 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-25 02:23:17 INFO  ---RUNTIME: Importing and monkey-patching took 6.254911422729492 ms
2022-09-25 02:23:22 INFO  ---RUNTIME: Original pipeline execution took 5215.0397300720215 ms (excluding imports and monkey-patching)
2022-09-25 02:23:22 INFO  Starting execution of 1 what-if analyses...
2022-09-25 02:23:22 INFO  Start plan generation for analysis DataCorruption...
2022-09-25 02:23:22 INFO  ---RUNTIME: Plan generation took 1.363992691040039 ms
2022-09-25 02:23:22 INFO  Estimated runtime of original DAG is 4883.370637893677ms
2022-09-25 02:23:22 INFO  Performing Multi-Query Optimization
2022-09-25 02:23:22 INFO  Estimated unoptimized what-if runtime is 122084.26594734192ms
2022-09-25 02:23:22 INFO  Estimated optimised what-if runtime is 11759.80520248413ms
2022-09-25 02:23:22 INFO  Estimated optimisation runtime saving is 110324.46074485779ms
2022-09-25 02:23:22 INFO  ---RUNTIME: Multi-Query Optimization took 105.17215728759766 ms
2022-09-25 02:23:22 INFO  Executing generated plans
2022-09-25 02:23:39 INFO  ---RUNTIME: Execution took 16733.832120895386 ms
2022-09-25 02:23:39 INFO  Done!
2022-09-25 02:23:39 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-25 02:23:39 INFO  Running instrumented original pipeline...
2022-09-25 02:23:39 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-25 02:23:39 INFO  ---RUNTIME: Importing and monkey-patching took 5.960941314697266 ms
2022-09-25 02:23:44 INFO  ---RUNTIME: Original pipeline execution took 5269.171476364136 ms (excluding imports and monkey-patching)
2022-09-25 02:23:44 INFO  Starting execution of 1 what-if analyses...
2022-09-25 02:23:44 INFO  Start plan generation for analysis DataCorruption...
2022-09-25 02:23:44 INFO  ---RUNTIME: Plan generation took 0.4761219024658203 ms
2022-09-25 02:23:44 INFO  Estimated runtime of original DAG is 4972.752571105957ms
2022-09-25 02:23:44 WARNING Skipping Multi-Query Optimization (instead, only applying patches)
2022-09-25 02:23:44 INFO  Estimated unoptimised what-if runtime is 124318.81427764893ms
2022-09-25 02:23:44 INFO  ---RUNTIME: Multi-Query Optimization took 18.77140998840332 ms
2022-09-25 02:23:44 INFO  Executing generated plans
2022-09-25 02:26:04 INFO  ---RUNTIME: Execution took 139590.50941467285 ms
2022-09-25 02:26:04 INFO  Done!
2022-09-25 02:26:04 INFO  # Finished -- repetition 3 of 7 
2022-09-25 02:26:04 INFO  # Optimization benchmark for data_corruption with args [['reviews', 'fast_loading', 'featurization_1', 'logistic_regression']] -- repetition 4 of 7
2022-09-25 02:26:04 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-25 02:26:04 INFO  Running instrumented original pipeline...
2022-09-25 02:26:04 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-25 02:26:04 INFO  ---RUNTIME: Importing and monkey-patching took 6.213665008544922 ms
2022-09-25 02:26:09 INFO  ---RUNTIME: Original pipeline execution took 5282.634496688843 ms (excluding imports and monkey-patching)
2022-09-25 02:26:09 INFO  Starting execution of 1 what-if analyses...
2022-09-25 02:26:09 INFO  Start plan generation for analysis DataCorruption...
2022-09-25 02:26:09 INFO  ---RUNTIME: Plan generation took 0.48065185546875 ms
2022-09-25 02:26:09 INFO  Estimated runtime of original DAG is 4949.099779129028ms
2022-09-25 02:26:09 INFO  Performing Multi-Query Optimization
2022-09-25 02:26:09 INFO  Estimated unoptimized what-if runtime is 123727.49447822571ms
2022-09-25 02:26:09 INFO  Estimated optimised what-if runtime is 11911.748170852661ms
2022-09-25 02:26:09 INFO  Estimated optimisation runtime saving is 111815.74630737305ms
2022-09-25 02:26:09 INFO  ---RUNTIME: Multi-Query Optimization took 63.25793266296387 ms
2022-09-25 02:26:09 INFO  Executing generated plans
2022-09-25 02:26:26 INFO  ---RUNTIME: Execution took 16712.446451187134 ms
2022-09-25 02:26:26 INFO  Done!
2022-09-25 02:26:26 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-25 02:26:26 INFO  Running instrumented original pipeline...
2022-09-25 02:26:26 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-25 02:26:26 INFO  ---RUNTIME: Importing and monkey-patching took 6.472110748291016 ms
2022-09-25 02:26:31 INFO  ---RUNTIME: Original pipeline execution took 5157.600402832031 ms (excluding imports and monkey-patching)
2022-09-25 02:26:31 INFO  Starting execution of 1 what-if analyses...
2022-09-25 02:26:31 INFO  Start plan generation for analysis DataCorruption...
2022-09-25 02:26:31 INFO  ---RUNTIME: Plan generation took 0.4558563232421875 ms
2022-09-25 02:26:31 INFO  Estimated runtime of original DAG is 4863.085508346558ms
2022-09-25 02:26:31 WARNING Skipping Multi-Query Optimization (instead, only applying patches)
2022-09-25 02:26:31 INFO  Estimated unoptimised what-if runtime is 121577.13770866394ms
2022-09-25 02:26:31 INFO  ---RUNTIME: Multi-Query Optimization took 19.16980743408203 ms
2022-09-25 02:26:31 INFO  Executing generated plans
2022-09-25 02:28:52 INFO  ---RUNTIME: Execution took 140672.80650138855 ms
2022-09-25 02:28:52 INFO  Done!
2022-09-25 02:28:52 INFO  # Finished -- repetition 4 of 7 
2022-09-25 02:28:52 INFO  # Optimization benchmark for data_corruption with args [['reviews', 'fast_loading', 'featurization_1', 'logistic_regression']] -- repetition 5 of 7
2022-09-25 02:28:52 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-25 02:28:52 INFO  Running instrumented original pipeline...
2022-09-25 02:28:52 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-25 02:28:52 INFO  ---RUNTIME: Importing and monkey-patching took 6.481647491455078 ms
2022-09-25 02:28:57 INFO  ---RUNTIME: Original pipeline execution took 5376.744508743286 ms (excluding imports and monkey-patching)
2022-09-25 02:28:57 INFO  Starting execution of 1 what-if analyses...
2022-09-25 02:28:57 INFO  Start plan generation for analysis DataCorruption...
2022-09-25 02:28:57 INFO  ---RUNTIME: Plan generation took 0.4582405090332031 ms
2022-09-25 02:28:57 INFO  Estimated runtime of original DAG is 5067.992448806763ms
2022-09-25 02:28:57 INFO  Performing Multi-Query Optimization
2022-09-25 02:28:57 INFO  Estimated unoptimized what-if runtime is 126699.81122016907ms
2022-09-25 02:28:57 INFO  Estimated optimised what-if runtime is 11864.791870117188ms
2022-09-25 02:28:57 INFO  Estimated optimisation runtime saving is 114835.01935005188ms
2022-09-25 02:28:57 INFO  ---RUNTIME: Multi-Query Optimization took 77.56757736206055 ms
2022-09-25 02:28:57 INFO  Executing generated plans
2022-09-25 02:29:14 INFO  ---RUNTIME: Execution took 16962.50557899475 ms
2022-09-25 02:29:14 INFO  Done!
2022-09-25 02:29:14 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-25 02:29:14 INFO  Running instrumented original pipeline...
2022-09-25 02:29:14 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-25 02:29:14 INFO  ---RUNTIME: Importing and monkey-patching took 6.441831588745117 ms
2022-09-25 02:29:20 INFO  ---RUNTIME: Original pipeline execution took 5232.579469680786 ms (excluding imports and monkey-patching)
2022-09-25 02:29:20 INFO  Starting execution of 1 what-if analyses...
2022-09-25 02:29:20 INFO  Start plan generation for analysis DataCorruption...
2022-09-25 02:29:20 INFO  ---RUNTIME: Plan generation took 1.2903213500976562 ms
2022-09-25 02:29:20 INFO  Estimated runtime of original DAG is 4910.143136978149ms
2022-09-25 02:29:20 WARNING Skipping Multi-Query Optimization (instead, only applying patches)
2022-09-25 02:29:20 INFO  Estimated unoptimised what-if runtime is 122753.57842445374ms
2022-09-25 02:29:20 INFO  ---RUNTIME: Multi-Query Optimization took 18.16534996032715 ms
2022-09-25 02:29:20 INFO  Executing generated plans
2022-09-25 02:31:39 INFO  ---RUNTIME: Execution took 139710.61635017395 ms
2022-09-25 02:31:39 INFO  Done!
2022-09-25 02:31:39 INFO  # Finished -- repetition 5 of 7 
2022-09-25 02:31:39 INFO  # Optimization benchmark for data_corruption with args [['reviews', 'fast_loading', 'featurization_1', 'logistic_regression']] -- repetition 6 of 7
2022-09-25 02:31:39 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-25 02:31:39 INFO  Running instrumented original pipeline...
2022-09-25 02:31:39 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-25 02:31:39 INFO  ---RUNTIME: Importing and monkey-patching took 6.453514099121094 ms
2022-09-25 02:31:45 INFO  ---RUNTIME: Original pipeline execution took 5214.283466339111 ms (excluding imports and monkey-patching)
2022-09-25 02:31:45 INFO  Starting execution of 1 what-if analyses...
2022-09-25 02:31:45 INFO  Start plan generation for analysis DataCorruption...
2022-09-25 02:31:45 INFO  ---RUNTIME: Plan generation took 0.4611015319824219 ms
2022-09-25 02:31:45 INFO  Estimated runtime of original DAG is 4914.711952209473ms
2022-09-25 02:31:45 INFO  Performing Multi-Query Optimization
2022-09-25 02:31:45 INFO  Estimated unoptimized what-if runtime is 122867.79880523682ms
2022-09-25 02:31:45 INFO  Estimated optimised what-if runtime is 11709.765195846558ms
2022-09-25 02:31:45 INFO  Estimated optimisation runtime saving is 111158.03360939026ms
2022-09-25 02:31:45 INFO  ---RUNTIME: Multi-Query Optimization took 66.17903709411621 ms
2022-09-25 02:31:45 INFO  Executing generated plans
2022-09-25 02:32:02 INFO  ---RUNTIME: Execution took 16807.70230293274 ms
2022-09-25 02:32:02 INFO  Done!
2022-09-25 02:32:02 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-25 02:32:02 INFO  Running instrumented original pipeline...
2022-09-25 02:32:02 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-25 02:32:02 INFO  ---RUNTIME: Importing and monkey-patching took 6.407260894775391 ms
2022-09-25 02:32:07 INFO  ---RUNTIME: Original pipeline execution took 5199.331760406494 ms (excluding imports and monkey-patching)
2022-09-25 02:32:07 INFO  Starting execution of 1 what-if analyses...
2022-09-25 02:32:07 INFO  Start plan generation for analysis DataCorruption...
2022-09-25 02:32:07 INFO  ---RUNTIME: Plan generation took 0.4239082336425781 ms
2022-09-25 02:32:07 INFO  Estimated runtime of original DAG is 4907.825708389282ms
2022-09-25 02:32:07 WARNING Skipping Multi-Query Optimization (instead, only applying patches)
2022-09-25 02:32:07 INFO  Estimated unoptimised what-if runtime is 122695.64270973206ms
2022-09-25 02:32:07 INFO  ---RUNTIME: Multi-Query Optimization took 18.790721893310547 ms
2022-09-25 02:32:07 INFO  Executing generated plans
2022-09-25 02:34:28 INFO  ---RUNTIME: Execution took 140732.02848434448 ms
2022-09-25 02:34:28 INFO  Done!
2022-09-25 02:34:28 INFO  # Finished -- repetition 6 of 7 
2022-09-25 02:34:28 INFO  # Optimization benchmark for data_corruption with args [['reviews', 'fast_loading', 'featurization_1', 'logistic_regression']] -- repetition 7 of 7
2022-09-25 02:34:28 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-25 02:34:28 INFO  Running instrumented original pipeline...
2022-09-25 02:34:28 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-25 02:34:28 INFO  ---RUNTIME: Importing and monkey-patching took 6.043434143066406 ms
2022-09-25 02:34:33 INFO  ---RUNTIME: Original pipeline execution took 5559.229373931885 ms (excluding imports and monkey-patching)
2022-09-25 02:34:33 INFO  Starting execution of 1 what-if analyses...
2022-09-25 02:34:33 INFO  Start plan generation for analysis DataCorruption...
2022-09-25 02:34:33 INFO  ---RUNTIME: Plan generation took 0.3933906555175781 ms
2022-09-25 02:34:33 INFO  Estimated runtime of original DAG is 5035.052299499512ms
2022-09-25 02:34:33 INFO  Performing Multi-Query Optimization
2022-09-25 02:34:33 INFO  Estimated unoptimized what-if runtime is 125876.3074874878ms
2022-09-25 02:34:33 INFO  Estimated optimised what-if runtime is 11939.130544662476ms
2022-09-25 02:34:33 INFO  Estimated optimisation runtime saving is 113937.17694282532ms
2022-09-25 02:34:33 INFO  ---RUNTIME: Multi-Query Optimization took 62.10207939147949 ms
2022-09-25 02:34:33 INFO  Executing generated plans
2022-09-25 02:34:50 INFO  ---RUNTIME: Execution took 16855.27801513672 ms
2022-09-25 02:34:50 INFO  Done!
2022-09-25 02:34:50 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-25 02:34:50 INFO  Running instrumented original pipeline...
2022-09-25 02:34:50 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-25 02:34:50 INFO  ---RUNTIME: Importing and monkey-patching took 5.790948867797852 ms
2022-09-25 02:34:55 INFO  ---RUNTIME: Original pipeline execution took 5245.525598526001 ms (excluding imports and monkey-patching)
2022-09-25 02:34:55 INFO  Starting execution of 1 what-if analyses...
2022-09-25 02:34:55 INFO  Start plan generation for analysis DataCorruption...
2022-09-25 02:34:55 INFO  ---RUNTIME: Plan generation took 0.4572868347167969 ms
2022-09-25 02:34:55 INFO  Estimated runtime of original DAG is 4941.083192825317ms
2022-09-25 02:34:55 WARNING Skipping Multi-Query Optimization (instead, only applying patches)
2022-09-25 02:34:55 INFO  Estimated unoptimised what-if runtime is 123527.07982063293ms
2022-09-25 02:34:55 INFO  ---RUNTIME: Multi-Query Optimization took 21.188974380493164 ms
2022-09-25 02:34:55 INFO  Executing generated plans
2022-09-25 02:37:14 INFO  ---RUNTIME: Execution took 138954.79226112366 ms
2022-09-25 02:37:14 INFO  Done!
2022-09-25 02:37:14 INFO  # Finished -- repetition 7 of 7 
2022-09-25 02:37:14 INFO  # Final results after all repetitions
2022-09-25 02:37:14 INFO     repetition  ... no_opt_what_if_execution_combined_model_training
0           0  ...                                      3328.184366
1           1  ...                                      3579.938889
2           2  ...                                      3406.795025
3           3  ...                                      3478.156805
4           4  ...                                      3442.497015
5           5  ...                                      3553.575039
6           6  ...                                      3426.034689

[7 rows x 26 columns]
PROTOCOL_BUFFERS_PYTHON_IMPLEMENTATION=python taskset -c 32-39 python3.9 benchmarks_end_to_end.py data_corruption reviews fast_loading featurization_1 xgboost
2022-09-25 02:37:16.974650: W tensorflow/stream_executor/platform/default/dso_loader.cc:64] Could not load dynamic library 'libcudart.so.11.0'; dlerror: libcudart.so.11.0: cannot open shared object file: No such file or directory; LD_LIBRARY_PATH: /home/sgrafbe/mlwhatif/venv/lib/python3.9/site-packages/cv2/../../lib64:
2022-09-25 02:37:16.974698: I tensorflow/stream_executor/cuda/cudart_stub.cc:29] Ignore above cudart dlerror if you do not have a GPU set up on your machine.
2022-09-25 02:37:18 INFO  Patching sys.argv with ['mlwhatif', 'reviews', 'fast_loading', 'featurization_1', 'xgboost']
2022-09-25 02:37:18 INFO  Running instrumented original pipeline...
2022-09-25 02:37:18 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-25 02:37:18 INFO  ---RUNTIME: Importing and monkey-patching took 134.49740409851074 ms
2022-09-25 02:37:26 INFO  ---RUNTIME: Original pipeline execution took 8357.402086257935 ms (excluding imports and monkey-patching)
2022-09-25 02:37:26 INFO  Starting execution of 0 what-if analyses...
2022-09-25 02:37:26 INFO  Estimated runtime of original DAG is 8014.790058135986ms
2022-09-25 02:37:26 INFO  Performing Multi-Query Optimization
2022-09-25 02:37:26 INFO  Estimated unoptimized what-if runtime is 0ms
2022-09-25 02:37:26 INFO  Estimated optimised what-if runtime is 0ms
2022-09-25 02:37:26 INFO  Estimated optimisation runtime saving is 0ms
2022-09-25 02:37:26 INFO  ---RUNTIME: Multi-Query Optimization took 0.5018711090087891 ms
2022-09-25 02:37:26 INFO  Executing generated plans
2022-09-25 02:37:26 INFO  ---RUNTIME: Execution took 0.025987625122070312 ms
2022-09-25 02:37:26 INFO  Done!
2022-09-25 02:37:26 INFO  # Optimization benchmark for data_corruption with args [['reviews', 'fast_loading', 'featurization_1', 'xgboost']] -- repetition 1 of 7
2022-09-25 02:37:26 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-25 02:37:26 INFO  Running instrumented original pipeline...
2022-09-25 02:37:26 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-25 02:37:26 INFO  ---RUNTIME: Importing and monkey-patching took 5.70368766784668 ms
2022-09-25 02:37:35 INFO  ---RUNTIME: Original pipeline execution took 8344.723224639893 ms (excluding imports and monkey-patching)
2022-09-25 02:37:35 INFO  Starting execution of 1 what-if analyses...
2022-09-25 02:37:35 INFO  Start plan generation for analysis DataCorruption...
2022-09-25 02:37:35 INFO  ---RUNTIME: Plan generation took 0.4258155822753906 ms
2022-09-25 02:37:35 INFO  Estimated runtime of original DAG is 7895.569324493408ms
2022-09-25 02:37:35 INFO  Performing Multi-Query Optimization
2022-09-25 02:37:35 INFO  Estimated unoptimized what-if runtime is 197389.2331123352ms
2022-09-25 02:37:35 INFO  Estimated optimised what-if runtime is 22654.947996139526ms
2022-09-25 02:37:35 INFO  Estimated optimisation runtime saving is 174734.28511619568ms
2022-09-25 02:37:35 INFO  ---RUNTIME: Multi-Query Optimization took 69.39339637756348 ms
2022-09-25 02:37:35 INFO  Executing generated plans
2022-09-25 02:38:01 INFO  ---RUNTIME: Execution took 26505.882024765015 ms
2022-09-25 02:38:01 INFO  Done!
2022-09-25 02:38:01 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-25 02:38:01 INFO  Running instrumented original pipeline...
2022-09-25 02:38:01 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-25 02:38:01 INFO  ---RUNTIME: Importing and monkey-patching took 6.381511688232422 ms
2022-09-25 02:38:09 INFO  ---RUNTIME: Original pipeline execution took 7834.766387939453 ms (excluding imports and monkey-patching)
2022-09-25 02:38:09 INFO  Starting execution of 1 what-if analyses...
2022-09-25 02:38:09 INFO  Start plan generation for analysis DataCorruption...
2022-09-25 02:38:09 INFO  ---RUNTIME: Plan generation took 0.47707557678222656 ms
2022-09-25 02:38:09 INFO  Estimated runtime of original DAG is 7540.646076202393ms
2022-09-25 02:38:09 WARNING Skipping Multi-Query Optimization (instead, only applying patches)
2022-09-25 02:38:09 INFO  Estimated unoptimised what-if runtime is 188516.1519050598ms
2022-09-25 02:38:09 INFO  ---RUNTIME: Multi-Query Optimization took 19.18196678161621 ms
2022-09-25 02:38:09 INFO  Executing generated plans
2022-09-25 02:41:37 INFO  ---RUNTIME: Execution took 208245.98288536072 ms
2022-09-25 02:41:37 INFO  Done!
2022-09-25 02:41:37 INFO  # Finished -- repetition 1 of 7 
2022-09-25 02:41:37 INFO  # Optimization benchmark for data_corruption with args [['reviews', 'fast_loading', 'featurization_1', 'xgboost']] -- repetition 2 of 7
2022-09-25 02:41:37 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-25 02:41:37 INFO  Running instrumented original pipeline...
2022-09-25 02:41:37 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-25 02:41:37 INFO  ---RUNTIME: Importing and monkey-patching took 6.144285202026367 ms
2022-09-25 02:41:46 INFO  ---RUNTIME: Original pipeline execution took 8198.019742965698 ms (excluding imports and monkey-patching)
2022-09-25 02:41:46 INFO  Starting execution of 1 what-if analyses...
2022-09-25 02:41:46 INFO  Start plan generation for analysis DataCorruption...
2022-09-25 02:41:46 INFO  ---RUNTIME: Plan generation took 0.4265308380126953 ms
2022-09-25 02:41:46 INFO  Estimated runtime of original DAG is 7896.389961242676ms
2022-09-25 02:41:46 INFO  Performing Multi-Query Optimization
2022-09-25 02:41:46 INFO  Estimated unoptimized what-if runtime is 197409.7490310669ms
2022-09-25 02:41:46 INFO  Estimated optimised what-if runtime is 21885.969400405884ms
2022-09-25 02:41:46 INFO  Estimated optimisation runtime saving is 175523.779630661ms
2022-09-25 02:41:46 INFO  ---RUNTIME: Multi-Query Optimization took 63.050031661987305 ms
2022-09-25 02:41:46 INFO  Executing generated plans
2022-09-25 02:42:12 INFO  ---RUNTIME: Execution took 26353.82580757141 ms
2022-09-25 02:42:12 INFO  Done!
2022-09-25 02:42:12 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-25 02:42:12 INFO  Running instrumented original pipeline...
2022-09-25 02:42:12 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-25 02:42:12 INFO  ---RUNTIME: Importing and monkey-patching took 7.052898406982422 ms
2022-09-25 02:42:20 INFO  ---RUNTIME: Original pipeline execution took 8125.594139099121 ms (excluding imports and monkey-patching)
2022-09-25 02:42:20 INFO  Starting execution of 1 what-if analyses...
2022-09-25 02:42:20 INFO  Start plan generation for analysis DataCorruption...
2022-09-25 02:42:20 INFO  ---RUNTIME: Plan generation took 1.2984275817871094 ms
2022-09-25 02:42:20 INFO  Estimated runtime of original DAG is 7823.000907897949ms
2022-09-25 02:42:20 WARNING Skipping Multi-Query Optimization (instead, only applying patches)
2022-09-25 02:42:20 INFO  Estimated unoptimised what-if runtime is 195575.02269744873ms
2022-09-25 02:42:20 INFO  ---RUNTIME: Multi-Query Optimization took 18.384456634521484 ms
2022-09-25 02:42:20 INFO  Executing generated plans
2022-09-25 02:45:47 INFO  ---RUNTIME: Execution took 206660.16912460327 ms
2022-09-25 02:45:47 INFO  Done!
2022-09-25 02:45:47 INFO  # Finished -- repetition 2 of 7 
2022-09-25 02:45:47 INFO  # Optimization benchmark for data_corruption with args [['reviews', 'fast_loading', 'featurization_1', 'xgboost']] -- repetition 3 of 7
2022-09-25 02:45:47 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-25 02:45:47 INFO  Running instrumented original pipeline...
2022-09-25 02:45:47 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-25 02:45:47 INFO  ---RUNTIME: Importing and monkey-patching took 6.619691848754883 ms
2022-09-25 02:45:55 INFO  ---RUNTIME: Original pipeline execution took 7868.097305297852 ms (excluding imports and monkey-patching)
2022-09-25 02:45:55 INFO  Starting execution of 1 what-if analyses...
2022-09-25 02:45:55 INFO  Start plan generation for analysis DataCorruption...
2022-09-25 02:45:55 INFO  ---RUNTIME: Plan generation took 0.4379749298095703 ms
2022-09-25 02:45:55 INFO  Estimated runtime of original DAG is 7576.140403747559ms
2022-09-25 02:45:55 INFO  Performing Multi-Query Optimization
2022-09-25 02:45:55 INFO  Estimated unoptimized what-if runtime is 189403.51009368896ms
2022-09-25 02:45:55 INFO  Estimated optimised what-if runtime is 21971.52829170227ms
2022-09-25 02:45:55 INFO  Estimated optimisation runtime saving is 167431.9818019867ms
2022-09-25 02:45:55 INFO  ---RUNTIME: Multi-Query Optimization took 66.30158424377441 ms
2022-09-25 02:45:55 INFO  Executing generated plans
2022-09-25 02:46:21 INFO  ---RUNTIME: Execution took 26645.992279052734 ms
2022-09-25 02:46:21 INFO  Done!
2022-09-25 02:46:21 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-25 02:46:21 INFO  Running instrumented original pipeline...
2022-09-25 02:46:22 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-25 02:46:22 INFO  ---RUNTIME: Importing and monkey-patching took 5.847692489624023 ms
2022-09-25 02:46:30 INFO  ---RUNTIME: Original pipeline execution took 8254.178285598755 ms (excluding imports and monkey-patching)
2022-09-25 02:46:30 INFO  Starting execution of 1 what-if analyses...
2022-09-25 02:46:30 INFO  Start plan generation for analysis DataCorruption...
2022-09-25 02:46:30 INFO  ---RUNTIME: Plan generation took 0.3955364227294922 ms
2022-09-25 02:46:30 INFO  Estimated runtime of original DAG is 7783.131122589111ms
2022-09-25 02:46:30 WARNING Skipping Multi-Query Optimization (instead, only applying patches)
2022-09-25 02:46:30 INFO  Estimated unoptimised what-if runtime is 194578.27806472778ms
2022-09-25 02:46:30 INFO  ---RUNTIME: Multi-Query Optimization took 18.90707015991211 ms
2022-09-25 02:46:30 INFO  Executing generated plans
2022-09-25 02:49:56 INFO  ---RUNTIME: Execution took 206308.7248802185 ms
2022-09-25 02:49:56 INFO  Done!
2022-09-25 02:49:56 INFO  # Finished -- repetition 3 of 7 
2022-09-25 02:49:56 INFO  # Optimization benchmark for data_corruption with args [['reviews', 'fast_loading', 'featurization_1', 'xgboost']] -- repetition 4 of 7
2022-09-25 02:49:56 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-25 02:49:56 INFO  Running instrumented original pipeline...
2022-09-25 02:49:56 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-25 02:49:56 INFO  ---RUNTIME: Importing and monkey-patching took 6.9408416748046875 ms
2022-09-25 02:50:04 INFO  ---RUNTIME: Original pipeline execution took 8238.37924003601 ms (excluding imports and monkey-patching)
2022-09-25 02:50:04 INFO  Starting execution of 1 what-if analyses...
2022-09-25 02:50:04 INFO  Start plan generation for analysis DataCorruption...
2022-09-25 02:50:04 INFO  ---RUNTIME: Plan generation took 1.386404037475586 ms
2022-09-25 02:50:04 INFO  Estimated runtime of original DAG is 7941.199541091919ms
2022-09-25 02:50:04 INFO  Performing Multi-Query Optimization
2022-09-25 02:50:04 INFO  Estimated unoptimized what-if runtime is 198529.98852729797ms
2022-09-25 02:50:04 INFO  Estimated optimised what-if runtime is 22005.186796188354ms
2022-09-25 02:50:04 INFO  Estimated optimisation runtime saving is 176524.80173110962ms
2022-09-25 02:50:04 INFO  ---RUNTIME: Multi-Query Optimization took 62.099456787109375 ms
2022-09-25 02:50:04 INFO  Executing generated plans
2022-09-25 02:50:31 INFO  ---RUNTIME: Execution took 27051.07879638672 ms
2022-09-25 02:50:31 INFO  Done!
2022-09-25 02:50:31 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-25 02:50:31 INFO  Running instrumented original pipeline...
2022-09-25 02:50:31 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-25 02:50:31 INFO  ---RUNTIME: Importing and monkey-patching took 6.158113479614258 ms
2022-09-25 02:50:39 INFO  ---RUNTIME: Original pipeline execution took 7959.203243255615 ms (excluding imports and monkey-patching)
2022-09-25 02:50:39 INFO  Starting execution of 1 what-if analyses...
2022-09-25 02:50:39 INFO  Start plan generation for analysis DataCorruption...
2022-09-25 02:50:39 INFO  ---RUNTIME: Plan generation took 0.47898292541503906 ms
2022-09-25 02:50:39 INFO  Estimated runtime of original DAG is 7662.000417709351ms
2022-09-25 02:50:39 WARNING Skipping Multi-Query Optimization (instead, only applying patches)
2022-09-25 02:50:39 INFO  Estimated unoptimised what-if runtime is 191550.01044273376ms
2022-09-25 02:50:39 INFO  ---RUNTIME: Multi-Query Optimization took 19.014596939086914 ms
2022-09-25 02:50:39 INFO  Executing generated plans
2022-09-25 02:54:06 INFO  ---RUNTIME: Execution took 206950.79946517944 ms
2022-09-25 02:54:06 INFO  Done!
2022-09-25 02:54:06 INFO  # Finished -- repetition 4 of 7 
2022-09-25 02:54:06 INFO  # Optimization benchmark for data_corruption with args [['reviews', 'fast_loading', 'featurization_1', 'xgboost']] -- repetition 5 of 7
2022-09-25 02:54:06 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-25 02:54:06 INFO  Running instrumented original pipeline...
2022-09-25 02:54:06 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-25 02:54:06 INFO  ---RUNTIME: Importing and monkey-patching took 6.133079528808594 ms
2022-09-25 02:54:14 INFO  ---RUNTIME: Original pipeline execution took 7804.4984340667725 ms (excluding imports and monkey-patching)
2022-09-25 02:54:14 INFO  Starting execution of 1 what-if analyses...
2022-09-25 02:54:14 INFO  Start plan generation for analysis DataCorruption...
2022-09-25 02:54:14 INFO  ---RUNTIME: Plan generation took 0.4391670227050781 ms
2022-09-25 02:54:14 INFO  Estimated runtime of original DAG is 7511.460781097412ms
2022-09-25 02:54:14 INFO  Performing Multi-Query Optimization
2022-09-25 02:54:14 INFO  Estimated unoptimized what-if runtime is 187786.5195274353ms
2022-09-25 02:54:14 INFO  Estimated optimised what-if runtime is 21353.13630104065ms
2022-09-25 02:54:14 INFO  Estimated optimisation runtime saving is 166433.38322639465ms
2022-09-25 02:54:14 INFO  ---RUNTIME: Multi-Query Optimization took 70.31655311584473 ms
2022-09-25 02:54:14 INFO  Executing generated plans
2022-09-25 02:54:41 INFO  ---RUNTIME: Execution took 26722.153425216675 ms
2022-09-25 02:54:41 INFO  Done!
2022-09-25 02:54:41 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-25 02:54:41 INFO  Running instrumented original pipeline...
2022-09-25 02:54:41 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-25 02:54:41 INFO  ---RUNTIME: Importing and monkey-patching took 5.816459655761719 ms
2022-09-25 02:54:49 INFO  ---RUNTIME: Original pipeline execution took 7844.209909439087 ms (excluding imports and monkey-patching)
2022-09-25 02:54:49 INFO  Starting execution of 1 what-if analyses...
2022-09-25 02:54:49 INFO  Start plan generation for analysis DataCorruption...
2022-09-25 02:54:49 INFO  ---RUNTIME: Plan generation took 0.4296302795410156 ms
2022-09-25 02:54:49 INFO  Estimated runtime of original DAG is 7554.734468460083ms
2022-09-25 02:54:49 WARNING Skipping Multi-Query Optimization (instead, only applying patches)
2022-09-25 02:54:49 INFO  Estimated unoptimised what-if runtime is 188868.36171150208ms
2022-09-25 02:54:49 INFO  ---RUNTIME: Multi-Query Optimization took 18.95761489868164 ms
2022-09-25 02:54:49 INFO  Executing generated plans
2022-09-25 02:58:12 INFO  ---RUNTIME: Execution took 203585.8416557312 ms
2022-09-25 02:58:12 INFO  Done!
2022-09-25 02:58:12 INFO  # Finished -- repetition 5 of 7 
2022-09-25 02:58:12 INFO  # Optimization benchmark for data_corruption with args [['reviews', 'fast_loading', 'featurization_1', 'xgboost']] -- repetition 6 of 7
2022-09-25 02:58:12 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-25 02:58:12 INFO  Running instrumented original pipeline...
2022-09-25 02:58:12 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-25 02:58:12 INFO  ---RUNTIME: Importing and monkey-patching took 6.101131439208984 ms
2022-09-25 02:58:20 INFO  ---RUNTIME: Original pipeline execution took 7894.6967124938965 ms (excluding imports and monkey-patching)
2022-09-25 02:58:20 INFO  Starting execution of 1 what-if analyses...
2022-09-25 02:58:20 INFO  Start plan generation for analysis DataCorruption...
2022-09-25 02:58:20 INFO  ---RUNTIME: Plan generation took 1.279592514038086 ms
2022-09-25 02:58:20 INFO  Estimated runtime of original DAG is 7600.502967834473ms
2022-09-25 02:58:20 INFO  Performing Multi-Query Optimization
2022-09-25 02:58:20 INFO  Estimated unoptimized what-if runtime is 190012.57419586182ms
2022-09-25 02:58:20 INFO  Estimated optimised what-if runtime is 21310.869216918945ms
2022-09-25 02:58:20 INFO  Estimated optimisation runtime saving is 168701.70497894287ms
2022-09-25 02:58:20 INFO  ---RUNTIME: Multi-Query Optimization took 64.13960456848145 ms
2022-09-25 02:58:20 INFO  Executing generated plans
2022-09-25 02:58:47 INFO  ---RUNTIME: Execution took 26347.666025161743 ms
2022-09-25 02:58:47 INFO  Done!
2022-09-25 02:58:47 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-25 02:58:47 INFO  Running instrumented original pipeline...
2022-09-25 02:58:47 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-25 02:58:47 INFO  ---RUNTIME: Importing and monkey-patching took 6.125211715698242 ms
2022-09-25 02:58:55 INFO  ---RUNTIME: Original pipeline execution took 7907.999753952026 ms (excluding imports and monkey-patching)
2022-09-25 02:58:55 INFO  Starting execution of 1 what-if analyses...
2022-09-25 02:58:55 INFO  Start plan generation for analysis DataCorruption...
2022-09-25 02:58:55 INFO  ---RUNTIME: Plan generation took 0.4248619079589844 ms
2022-09-25 02:58:55 INFO  Estimated runtime of original DAG is 7609.742164611816ms
2022-09-25 02:58:55 WARNING Skipping Multi-Query Optimization (instead, only applying patches)
2022-09-25 02:58:55 INFO  Estimated unoptimised what-if runtime is 190243.5541152954ms
2022-09-25 02:58:55 INFO  ---RUNTIME: Multi-Query Optimization took 18.44620704650879 ms
2022-09-25 02:58:55 INFO  Executing generated plans
2022-09-25 03:02:18 INFO  ---RUNTIME: Execution took 203721.20308876038 ms
2022-09-25 03:02:18 INFO  Done!
2022-09-25 03:02:18 INFO  # Finished -- repetition 6 of 7 
2022-09-25 03:02:18 INFO  # Optimization benchmark for data_corruption with args [['reviews', 'fast_loading', 'featurization_1', 'xgboost']] -- repetition 7 of 7
2022-09-25 03:02:18 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-25 03:02:18 INFO  Running instrumented original pipeline...
2022-09-25 03:02:18 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-25 03:02:18 INFO  ---RUNTIME: Importing and monkey-patching took 6.217241287231445 ms
2022-09-25 03:02:26 INFO  ---RUNTIME: Original pipeline execution took 7829.982757568359 ms (excluding imports and monkey-patching)
2022-09-25 03:02:26 INFO  Starting execution of 1 what-if analyses...
2022-09-25 03:02:26 INFO  Start plan generation for analysis DataCorruption...
2022-09-25 03:02:26 INFO  ---RUNTIME: Plan generation took 0.45418739318847656 ms
2022-09-25 03:02:26 INFO  Estimated runtime of original DAG is 7535.930156707764ms
2022-09-25 03:02:26 INFO  Performing Multi-Query Optimization
2022-09-25 03:02:26 INFO  Estimated unoptimized what-if runtime is 188398.2539176941ms
2022-09-25 03:02:26 INFO  Estimated optimised what-if runtime is 21208.67681503296ms
2022-09-25 03:02:26 INFO  Estimated optimisation runtime saving is 167189.57710266113ms
2022-09-25 03:02:26 INFO  ---RUNTIME: Multi-Query Optimization took 63.684701919555664 ms
2022-09-25 03:02:26 INFO  Executing generated plans
2022-09-25 03:02:53 INFO  ---RUNTIME: Execution took 26199.131965637207 ms
2022-09-25 03:02:53 INFO  Done!
2022-09-25 03:02:53 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-25 03:02:53 INFO  Running instrumented original pipeline...
2022-09-25 03:02:53 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-25 03:02:53 INFO  ---RUNTIME: Importing and monkey-patching took 5.916833877563477 ms
2022-09-25 03:03:00 INFO  ---RUNTIME: Original pipeline execution took 7844.056844711304 ms (excluding imports and monkey-patching)
2022-09-25 03:03:00 INFO  Starting execution of 1 what-if analyses...
2022-09-25 03:03:00 INFO  Start plan generation for analysis DataCorruption...
2022-09-25 03:03:00 INFO  ---RUNTIME: Plan generation took 0.4248619079589844 ms
2022-09-25 03:03:00 INFO  Estimated runtime of original DAG is 7544.704914093018ms
2022-09-25 03:03:00 WARNING Skipping Multi-Query Optimization (instead, only applying patches)
2022-09-25 03:03:00 INFO  Estimated unoptimised what-if runtime is 188617.62285232544ms
2022-09-25 03:03:00 INFO  ---RUNTIME: Multi-Query Optimization took 18.92876625061035 ms
2022-09-25 03:03:00 INFO  Executing generated plans
2022-09-25 03:06:24 INFO  ---RUNTIME: Execution took 203834.19275283813 ms
2022-09-25 03:06:24 INFO  Done!
2022-09-25 03:06:24 INFO  # Finished -- repetition 7 of 7 
2022-09-25 03:06:24 INFO  # Final results after all repetitions
2022-09-25 03:06:24 INFO     repetition  ... no_opt_what_if_execution_combined_model_training
0           0  ...                                     65006.009102
1           1  ...                                     64587.786674
2           2  ...                                     64757.085562
3           3  ...                                     64758.777380
4           4  ...                                     63485.767841
5           5  ...                                     63560.021162
6           6  ...                                     63633.645535

[7 rows x 26 columns]
PROTOCOL_BUFFERS_PYTHON_IMPLEMENTATION=python taskset -c 32-39 python3.9 benchmarks_end_to_end.py data_corruption reviews fast_loading featurization_1 neural_network
2022-09-25 03:06:26.913219: W tensorflow/stream_executor/platform/default/dso_loader.cc:64] Could not load dynamic library 'libcudart.so.11.0'; dlerror: libcudart.so.11.0: cannot open shared object file: No such file or directory; LD_LIBRARY_PATH: /home/sgrafbe/mlwhatif/venv/lib/python3.9/site-packages/cv2/../../lib64:
2022-09-25 03:06:26.913262: I tensorflow/stream_executor/cuda/cudart_stub.cc:29] Ignore above cudart dlerror if you do not have a GPU set up on your machine.
2022-09-25 03:06:28 INFO  Patching sys.argv with ['mlwhatif', 'reviews', 'fast_loading', 'featurization_1', 'neural_network']
2022-09-25 03:06:28 INFO  Running instrumented original pipeline...
2022-09-25 03:06:28 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-25 03:06:28 INFO  ---RUNTIME: Importing and monkey-patching took 122.61676788330078 ms
2022-09-25 03:06:32.152660: W tensorflow/stream_executor/platform/default/dso_loader.cc:64] Could not load dynamic library 'libcuda.so.1'; dlerror: libcuda.so.1: cannot open shared object file: No such file or directory; LD_LIBRARY_PATH: /home/sgrafbe/mlwhatif/venv/lib/python3.9/site-packages/cv2/../../lib64:
2022-09-25 03:06:32.152694: W tensorflow/stream_executor/cuda/cuda_driver.cc:326] failed call to cuInit: UNKNOWN ERROR (303)
2022-09-25 03:06:32.152716: I tensorflow/stream_executor/cuda/cuda_diagnostics.cc:156] kernel driver does not appear to be running on this host (angus): /proc/driver/nvidia/version does not exist
2022-09-25 03:06:32.153195: I tensorflow/core/platform/cpu_feature_guard.cc:142] This TensorFlow binary is optimized with oneAPI Deep Neural Network Library (oneDNN) to use the following CPU instructions in performance-critical operations:  AVX2 FMA
To enable them in other operations, rebuild TensorFlow with the appropriate compiler flags.
2022-09-25 03:06:32.382557: I tensorflow/compiler/mlir/mlir_graph_optimization_pass.cc:176] None of the MLIR Optimization Passes are enabled (registered 2)
2022-09-25 03:06:32.394177: I tensorflow/core/platform/profile_utils/cpu_utils.cc:114] CPU Frequency: 2595130000 Hz
2022-09-25 03:06:37 INFO  ---RUNTIME: Original pipeline execution took 9042.741537094116 ms (excluding imports and monkey-patching)
2022-09-25 03:06:37 INFO  Starting execution of 0 what-if analyses...
2022-09-25 03:06:37 INFO  Estimated runtime of original DAG is 8713.935613632202ms
2022-09-25 03:06:37 INFO  Performing Multi-Query Optimization
2022-09-25 03:06:37 INFO  Estimated unoptimized what-if runtime is 0ms
2022-09-25 03:06:37 INFO  Estimated optimised what-if runtime is 0ms
2022-09-25 03:06:37 INFO  Estimated optimisation runtime saving is 0ms
2022-09-25 03:06:37 INFO  ---RUNTIME: Multi-Query Optimization took 0.7107257843017578 ms
2022-09-25 03:06:37 INFO  Executing generated plans
2022-09-25 03:06:37 INFO  ---RUNTIME: Execution took 0.0209808349609375 ms
2022-09-25 03:06:37 INFO  Done!
2022-09-25 03:06:37 INFO  # Optimization benchmark for data_corruption with args [['reviews', 'fast_loading', 'featurization_1', 'neural_network']] -- repetition 1 of 7
2022-09-25 03:06:37 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-25 03:06:37 INFO  Running instrumented original pipeline...
2022-09-25 03:06:37 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-25 03:06:37 INFO  ---RUNTIME: Importing and monkey-patching took 8.541345596313477 ms
2022-09-25 03:06:46 INFO  ---RUNTIME: Original pipeline execution took 8709.034442901611 ms (excluding imports and monkey-patching)
2022-09-25 03:06:46 INFO  Starting execution of 1 what-if analyses...
2022-09-25 03:06:46 INFO  Start plan generation for analysis DataCorruption...
2022-09-25 03:06:46 INFO  ---RUNTIME: Plan generation took 2.377748489379883 ms
2022-09-25 03:06:46 INFO  Estimated runtime of original DAG is 8394.402503967285ms
2022-09-25 03:06:46 INFO  Performing Multi-Query Optimization
2022-09-25 03:06:46 INFO  Estimated unoptimized what-if runtime is 209860.06259918213ms
2022-09-25 03:06:46 INFO  Estimated optimised what-if runtime is 24409.072637557983ms
2022-09-25 03:06:46 INFO  Estimated optimisation runtime saving is 185450.98996162415ms
2022-09-25 03:06:46 INFO  ---RUNTIME: Multi-Query Optimization took 63.83919715881348 ms
2022-09-25 03:06:46 INFO  Executing generated plans
2022-09-25 03:07:15 INFO  ---RUNTIME: Execution took 29395.677089691162 ms
2022-09-25 03:07:15 INFO  Done!
2022-09-25 03:07:15 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-25 03:07:15 INFO  Running instrumented original pipeline...
2022-09-25 03:07:15 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-25 03:07:15 INFO  ---RUNTIME: Importing and monkey-patching took 6.021261215209961 ms
2022-09-25 03:07:24 INFO  ---RUNTIME: Original pipeline execution took 8595.701694488525 ms (excluding imports and monkey-patching)
2022-09-25 03:07:24 INFO  Starting execution of 1 what-if analyses...
2022-09-25 03:07:24 INFO  Start plan generation for analysis DataCorruption...
2022-09-25 03:07:24 INFO  ---RUNTIME: Plan generation took 0.4448890686035156 ms
2022-09-25 03:07:24 INFO  Estimated runtime of original DAG is 8300.961971282959ms
2022-09-25 03:07:24 WARNING Skipping Multi-Query Optimization (instead, only applying patches)
2022-09-25 03:07:24 INFO  Estimated unoptimised what-if runtime is 207524.04928207397ms
2022-09-25 03:07:24 INFO  ---RUNTIME: Multi-Query Optimization took 18.805265426635742 ms
2022-09-25 03:07:24 INFO  Executing generated plans
2022-09-25 03:11:07 INFO  ---RUNTIME: Execution took 223278.70512008667 ms
2022-09-25 03:11:07 INFO  Done!
2022-09-25 03:11:07 INFO  # Finished -- repetition 1 of 7 
2022-09-25 03:11:07 INFO  # Optimization benchmark for data_corruption with args [['reviews', 'fast_loading', 'featurization_1', 'neural_network']] -- repetition 2 of 7
2022-09-25 03:11:07 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-25 03:11:07 INFO  Running instrumented original pipeline...
2022-09-25 03:11:07 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-25 03:11:07 INFO  ---RUNTIME: Importing and monkey-patching took 5.978584289550781 ms
2022-09-25 03:11:16 INFO  ---RUNTIME: Original pipeline execution took 8551.100492477417 ms (excluding imports and monkey-patching)
2022-09-25 03:11:16 INFO  Starting execution of 1 what-if analyses...
2022-09-25 03:11:16 INFO  Start plan generation for analysis DataCorruption...
2022-09-25 03:11:16 INFO  ---RUNTIME: Plan generation took 0.43201446533203125 ms
2022-09-25 03:11:16 INFO  Estimated runtime of original DAG is 8258.914232254028ms
2022-09-25 03:11:16 INFO  Performing Multi-Query Optimization
2022-09-25 03:11:16 INFO  Estimated unoptimized what-if runtime is 206472.8558063507ms
2022-09-25 03:11:16 INFO  Estimated optimised what-if runtime is 24094.056606292725ms
2022-09-25 03:11:16 INFO  Estimated optimisation runtime saving is 182378.79920005798ms
2022-09-25 03:11:16 INFO  ---RUNTIME: Multi-Query Optimization took 64.96906280517578 ms
2022-09-25 03:11:16 INFO  Executing generated plans
2022-09-25 03:11:44 INFO  ---RUNTIME: Execution took 28702.40616798401 ms
2022-09-25 03:11:44 INFO  Done!
2022-09-25 03:11:44 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-25 03:11:44 INFO  Running instrumented original pipeline...
2022-09-25 03:11:45 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-25 03:11:45 INFO  ---RUNTIME: Importing and monkey-patching took 5.858182907104492 ms
2022-09-25 03:11:53 INFO  ---RUNTIME: Original pipeline execution took 8820.280075073242 ms (excluding imports and monkey-patching)
2022-09-25 03:11:53 INFO  Starting execution of 1 what-if analyses...
2022-09-25 03:11:53 INFO  Start plan generation for analysis DataCorruption...
2022-09-25 03:11:53 INFO  ---RUNTIME: Plan generation took 0.4253387451171875 ms
2022-09-25 03:11:53 INFO  Estimated runtime of original DAG is 8226.866722106934ms
2022-09-25 03:11:53 WARNING Skipping Multi-Query Optimization (instead, only applying patches)
2022-09-25 03:11:53 INFO  Estimated unoptimised what-if runtime is 205671.66805267334ms
2022-09-25 03:11:53 INFO  ---RUNTIME: Multi-Query Optimization took 18.848657608032227 ms
2022-09-25 03:11:53 INFO  Executing generated plans
2022-09-25 03:15:34 INFO  ---RUNTIME: Execution took 221013.7095451355 ms
2022-09-25 03:15:34 INFO  Done!
2022-09-25 03:15:34 INFO  # Finished -- repetition 2 of 7 
2022-09-25 03:15:34 INFO  # Optimization benchmark for data_corruption with args [['reviews', 'fast_loading', 'featurization_1', 'neural_network']] -- repetition 3 of 7
2022-09-25 03:15:34 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-25 03:15:34 INFO  Running instrumented original pipeline...
2022-09-25 03:15:34 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-25 03:15:34 INFO  ---RUNTIME: Importing and monkey-patching took 6.369829177856445 ms
2022-09-25 03:15:43 INFO  ---RUNTIME: Original pipeline execution took 8541.498184204102 ms (excluding imports and monkey-patching)
2022-09-25 03:15:43 INFO  Starting execution of 1 what-if analyses...
2022-09-25 03:15:43 INFO  Start plan generation for analysis DataCorruption...
2022-09-25 03:15:43 INFO  ---RUNTIME: Plan generation took 0.4355907440185547 ms
2022-09-25 03:15:43 INFO  Estimated runtime of original DAG is 8248.345136642456ms
2022-09-25 03:15:43 INFO  Performing Multi-Query Optimization
2022-09-25 03:15:43 INFO  Estimated unoptimized what-if runtime is 206208.6284160614ms
2022-09-25 03:15:43 INFO  Estimated optimised what-if runtime is 24082.25178718567ms
2022-09-25 03:15:43 INFO  Estimated optimisation runtime saving is 182126.37662887573ms
2022-09-25 03:15:43 INFO  ---RUNTIME: Multi-Query Optimization took 383.1450939178467 ms
2022-09-25 03:15:43 INFO  Executing generated plans
2022-09-25 03:16:12 INFO  ---RUNTIME: Execution took 28694.737911224365 ms
2022-09-25 03:16:12 INFO  Done!
2022-09-25 03:16:12 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-25 03:16:12 INFO  Running instrumented original pipeline...
2022-09-25 03:16:12 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-25 03:16:12 INFO  ---RUNTIME: Importing and monkey-patching took 6.026268005371094 ms
2022-09-25 03:16:21 INFO  ---RUNTIME: Original pipeline execution took 8663.670063018799 ms (excluding imports and monkey-patching)
2022-09-25 03:16:21 INFO  Starting execution of 1 what-if analyses...
2022-09-25 03:16:21 INFO  Start plan generation for analysis DataCorruption...
2022-09-25 03:16:21 INFO  ---RUNTIME: Plan generation took 0.4341602325439453 ms
2022-09-25 03:16:21 INFO  Estimated runtime of original DAG is 8360.242128372192ms
2022-09-25 03:16:21 WARNING Skipping Multi-Query Optimization (instead, only applying patches)
2022-09-25 03:16:21 INFO  Estimated unoptimised what-if runtime is 209006.0532093048ms
2022-09-25 03:16:21 INFO  ---RUNTIME: Multi-Query Optimization took 19.0887451171875 ms
2022-09-25 03:16:21 INFO  Executing generated plans
2022-09-25 03:20:02 INFO  ---RUNTIME: Execution took 220941.97511672974 ms
2022-09-25 03:20:02 INFO  Done!
2022-09-25 03:20:02 INFO  # Finished -- repetition 3 of 7 
2022-09-25 03:20:02 INFO  # Optimization benchmark for data_corruption with args [['reviews', 'fast_loading', 'featurization_1', 'neural_network']] -- repetition 4 of 7
2022-09-25 03:20:02 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-25 03:20:02 INFO  Running instrumented original pipeline...
2022-09-25 03:20:02 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-25 03:20:02 INFO  ---RUNTIME: Importing and monkey-patching took 6.092071533203125 ms
2022-09-25 03:20:10 INFO  ---RUNTIME: Original pipeline execution took 8943.441152572632 ms (excluding imports and monkey-patching)
2022-09-25 03:20:10 INFO  Starting execution of 1 what-if analyses...
2022-09-25 03:20:10 INFO  Start plan generation for analysis DataCorruption...
2022-09-25 03:20:10 INFO  ---RUNTIME: Plan generation took 0.43702125549316406 ms
2022-09-25 03:20:10 INFO  Estimated runtime of original DAG is 8650.61092376709ms
2022-09-25 03:20:10 INFO  Performing Multi-Query Optimization
2022-09-25 03:20:11 INFO  Estimated unoptimized what-if runtime is 216265.27309417725ms
2022-09-25 03:20:11 INFO  Estimated optimised what-if runtime is 24498.963356018066ms
2022-09-25 03:20:11 INFO  Estimated optimisation runtime saving is 191766.30973815918ms
2022-09-25 03:20:11 INFO  ---RUNTIME: Multi-Query Optimization took 64.35275077819824 ms
2022-09-25 03:20:11 INFO  Executing generated plans
2022-09-25 03:20:39 INFO  ---RUNTIME: Execution took 28786.5629196167 ms
2022-09-25 03:20:39 INFO  Done!
2022-09-25 03:20:39 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-25 03:20:39 INFO  Running instrumented original pipeline...
2022-09-25 03:20:39 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-25 03:20:39 INFO  ---RUNTIME: Importing and monkey-patching took 6.554603576660156 ms
2022-09-25 03:20:48 INFO  ---RUNTIME: Original pipeline execution took 8538.622379302979 ms (excluding imports and monkey-patching)
2022-09-25 03:20:48 INFO  Starting execution of 1 what-if analyses...
2022-09-25 03:20:48 INFO  Start plan generation for analysis DataCorruption...
2022-09-25 03:20:48 INFO  ---RUNTIME: Plan generation took 0.469207763671875 ms
2022-09-25 03:20:48 INFO  Estimated runtime of original DAG is 8243.792057037354ms
2022-09-25 03:20:48 WARNING Skipping Multi-Query Optimization (instead, only applying patches)
2022-09-25 03:20:48 INFO  Estimated unoptimised what-if runtime is 206094.80142593384ms
2022-09-25 03:20:48 INFO  ---RUNTIME: Multi-Query Optimization took 21.108627319335938 ms
2022-09-25 03:20:48 INFO  Executing generated plans
2022-09-25 03:24:29 INFO  ---RUNTIME: Execution took 220893.26190948486 ms
2022-09-25 03:24:29 INFO  Done!
2022-09-25 03:24:29 INFO  # Finished -- repetition 4 of 7 
2022-09-25 03:24:29 INFO  # Optimization benchmark for data_corruption with args [['reviews', 'fast_loading', 'featurization_1', 'neural_network']] -- repetition 5 of 7
2022-09-25 03:24:29 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-25 03:24:29 INFO  Running instrumented original pipeline...
2022-09-25 03:24:29 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-25 03:24:29 INFO  ---RUNTIME: Importing and monkey-patching took 8.525371551513672 ms
2022-09-25 03:24:38 INFO  ---RUNTIME: Original pipeline execution took 8949.742555618286 ms (excluding imports and monkey-patching)
2022-09-25 03:24:38 INFO  Starting execution of 1 what-if analyses...
2022-09-25 03:24:38 INFO  Start plan generation for analysis DataCorruption...
2022-09-25 03:24:38 INFO  ---RUNTIME: Plan generation took 0.4189014434814453 ms
2022-09-25 03:24:38 INFO  Estimated runtime of original DAG is 8272.268772125244ms
2022-09-25 03:24:38 INFO  Performing Multi-Query Optimization
2022-09-25 03:24:38 INFO  Estimated unoptimized what-if runtime is 206806.7193031311ms
2022-09-25 03:24:38 INFO  Estimated optimised what-if runtime is 24514.659881591797ms
2022-09-25 03:24:38 INFO  Estimated optimisation runtime saving is 182292.0594215393ms
2022-09-25 03:24:38 INFO  ---RUNTIME: Multi-Query Optimization took 62.50762939453125 ms
2022-09-25 03:24:38 INFO  Executing generated plans
2022-09-25 03:25:07 INFO  ---RUNTIME: Execution took 28763.37242126465 ms
2022-09-25 03:25:07 INFO  Done!
2022-09-25 03:25:07 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-25 03:25:07 INFO  Running instrumented original pipeline...
2022-09-25 03:25:07 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-25 03:25:07 INFO  ---RUNTIME: Importing and monkey-patching took 6.114482879638672 ms
2022-09-25 03:25:15 INFO  ---RUNTIME: Original pipeline execution took 8613.355875015259 ms (excluding imports and monkey-patching)
2022-09-25 03:25:15 INFO  Starting execution of 1 what-if analyses...
2022-09-25 03:25:15 INFO  Start plan generation for analysis DataCorruption...
2022-09-25 03:25:15 INFO  ---RUNTIME: Plan generation took 0.40149688720703125 ms
2022-09-25 03:25:15 INFO  Estimated runtime of original DAG is 8310.37974357605ms
2022-09-25 03:25:15 WARNING Skipping Multi-Query Optimization (instead, only applying patches)
2022-09-25 03:25:15 INFO  Estimated unoptimised what-if runtime is 207759.49358940125ms
2022-09-25 03:25:15 INFO  ---RUNTIME: Multi-Query Optimization took 18.628835678100586 ms
2022-09-25 03:25:15 INFO  Executing generated plans
2022-09-25 03:28:56 INFO  ---RUNTIME: Execution took 221151.68285369873 ms
2022-09-25 03:28:56 INFO  Done!
2022-09-25 03:28:56 INFO  # Finished -- repetition 5 of 7 
2022-09-25 03:28:56 INFO  # Optimization benchmark for data_corruption with args [['reviews', 'fast_loading', 'featurization_1', 'neural_network']] -- repetition 6 of 7
2022-09-25 03:28:56 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-25 03:28:56 INFO  Running instrumented original pipeline...
2022-09-25 03:28:56 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-25 03:28:56 INFO  ---RUNTIME: Importing and monkey-patching took 6.067991256713867 ms
2022-09-25 03:29:05 INFO  ---RUNTIME: Original pipeline execution took 8980.807542800903 ms (excluding imports and monkey-patching)
2022-09-25 03:29:05 INFO  Starting execution of 1 what-if analyses...
2022-09-25 03:29:05 INFO  Start plan generation for analysis DataCorruption...
2022-09-25 03:29:05 INFO  ---RUNTIME: Plan generation took 0.4227161407470703 ms
2022-09-25 03:29:05 INFO  Estimated runtime of original DAG is 8683.573007583618ms
2022-09-25 03:29:05 INFO  Performing Multi-Query Optimization
2022-09-25 03:29:05 INFO  Estimated unoptimized what-if runtime is 217089.32518959045ms
2022-09-25 03:29:05 INFO  Estimated optimised what-if runtime is 24479.11787033081ms
2022-09-25 03:29:05 INFO  Estimated optimisation runtime saving is 192610.20731925964ms
2022-09-25 03:29:05 INFO  ---RUNTIME: Multi-Query Optimization took 62.515974044799805 ms
2022-09-25 03:29:05 INFO  Executing generated plans
2022-09-25 03:29:34 INFO  ---RUNTIME: Execution took 28718.75548362732 ms
2022-09-25 03:29:34 INFO  Done!
2022-09-25 03:29:34 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-25 03:29:34 INFO  Running instrumented original pipeline...
2022-09-25 03:29:34 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-25 03:29:34 INFO  ---RUNTIME: Importing and monkey-patching took 6.437778472900391 ms
2022-09-25 03:29:43 INFO  ---RUNTIME: Original pipeline execution took 8503.714323043823 ms (excluding imports and monkey-patching)
2022-09-25 03:29:43 INFO  Starting execution of 1 what-if analyses...
2022-09-25 03:29:43 INFO  Start plan generation for analysis DataCorruption...
2022-09-25 03:29:43 INFO  ---RUNTIME: Plan generation took 0.43392181396484375 ms
2022-09-25 03:29:43 INFO  Estimated runtime of original DAG is 8209.10382270813ms
2022-09-25 03:29:43 WARNING Skipping Multi-Query Optimization (instead, only applying patches)
2022-09-25 03:29:43 INFO  Estimated unoptimised what-if runtime is 205227.59556770325ms
2022-09-25 03:29:43 INFO  ---RUNTIME: Multi-Query Optimization took 19.52958106994629 ms
2022-09-25 03:29:43 INFO  Executing generated plans
2022-09-25 03:33:25 INFO  ---RUNTIME: Execution took 222170.49980163574 ms
2022-09-25 03:33:25 INFO  Done!
2022-09-25 03:33:25 INFO  # Finished -- repetition 6 of 7 
2022-09-25 03:33:25 INFO  # Optimization benchmark for data_corruption with args [['reviews', 'fast_loading', 'featurization_1', 'neural_network']] -- repetition 7 of 7
2022-09-25 03:33:25 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-25 03:33:25 INFO  Running instrumented original pipeline...
2022-09-25 03:33:25 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-25 03:33:25 INFO  ---RUNTIME: Importing and monkey-patching took 6.258726119995117 ms
2022-09-25 03:33:33 INFO  ---RUNTIME: Original pipeline execution took 8541.950702667236 ms (excluding imports and monkey-patching)
2022-09-25 03:33:33 INFO  Starting execution of 1 what-if analyses...
2022-09-25 03:33:33 INFO  Start plan generation for analysis DataCorruption...
2022-09-25 03:33:33 INFO  ---RUNTIME: Plan generation took 0.3933906555175781 ms
2022-09-25 03:33:33 INFO  Estimated runtime of original DAG is 8252.734422683716ms
2022-09-25 03:33:33 INFO  Performing Multi-Query Optimization
2022-09-25 03:33:34 INFO  Estimated unoptimized what-if runtime is 206318.3605670929ms
2022-09-25 03:33:34 INFO  Estimated optimised what-if runtime is 24051.568269729614ms
2022-09-25 03:33:34 INFO  Estimated optimisation runtime saving is 182266.79229736328ms
2022-09-25 03:33:34 INFO  ---RUNTIME: Multi-Query Optimization took 62.72172927856445 ms
2022-09-25 03:33:34 INFO  Executing generated plans
2022-09-25 03:34:02 INFO  ---RUNTIME: Execution took 28920.430898666382 ms
2022-09-25 03:34:02 INFO  Done!
2022-09-25 03:34:02 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-25 03:34:02 INFO  Running instrumented original pipeline...
2022-09-25 03:34:03 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-25 03:34:03 INFO  ---RUNTIME: Importing and monkey-patching took 7.445096969604492 ms
2022-09-25 03:34:11 INFO  ---RUNTIME: Original pipeline execution took 8684.615135192871 ms (excluding imports and monkey-patching)
2022-09-25 03:34:11 INFO  Starting execution of 1 what-if analyses...
2022-09-25 03:34:11 INFO  Start plan generation for analysis DataCorruption...
2022-09-25 03:34:11 INFO  ---RUNTIME: Plan generation took 0.400543212890625 ms
2022-09-25 03:34:11 INFO  Estimated runtime of original DAG is 8382.04050064087ms
2022-09-25 03:34:11 WARNING Skipping Multi-Query Optimization (instead, only applying patches)
2022-09-25 03:34:11 INFO  Estimated unoptimised what-if runtime is 209551.01251602173ms
2022-09-25 03:34:11 INFO  ---RUNTIME: Multi-Query Optimization took 19.743680953979492 ms
2022-09-25 03:34:11 INFO  Executing generated plans
2022-09-25 03:37:53 INFO  ---RUNTIME: Execution took 221812.08109855652 ms
2022-09-25 03:37:53 INFO  Done!
2022-09-25 03:37:53 INFO  # Finished -- repetition 7 of 7 
2022-09-25 03:37:53 INFO  # Final results after all repetitions
2022-09-25 03:37:53 INFO     repetition  ... no_opt_what_if_execution_combined_model_training
0           0  ...                                     80690.293550
1           1  ...                                     79606.782436
2           2  ...                                     79467.220306
3           3  ...                                     79404.825926
4           4  ...                                     79342.757940
5           5  ...                                     79679.271698
6           6  ...                                     79711.697340

[7 rows x 26 columns]
PROTOCOL_BUFFERS_PYTHON_IMPLEMENTATION=python taskset -c 32-39 python3.9 benchmarks_end_to_end.py data_corruption reviews fast_loading featurization_2 logistic_regression
2022-09-25 03:37:55.976045: W tensorflow/stream_executor/platform/default/dso_loader.cc:64] Could not load dynamic library 'libcudart.so.11.0'; dlerror: libcudart.so.11.0: cannot open shared object file: No such file or directory; LD_LIBRARY_PATH: /home/sgrafbe/mlwhatif/venv/lib/python3.9/site-packages/cv2/../../lib64:
2022-09-25 03:37:55.976098: I tensorflow/stream_executor/cuda/cudart_stub.cc:29] Ignore above cudart dlerror if you do not have a GPU set up on your machine.
2022-09-25 03:37:57 INFO  Patching sys.argv with ['mlwhatif', 'reviews', 'fast_loading', 'featurization_2', 'logistic_regression']
2022-09-25 03:37:57 INFO  Running instrumented original pipeline...
2022-09-25 03:37:57 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-25 03:37:57 INFO  ---RUNTIME: Importing and monkey-patching took 121.49810791015625 ms
2022-09-25 03:38:03 INFO  ---RUNTIME: Original pipeline execution took 5880.500316619873 ms (excluding imports and monkey-patching)
2022-09-25 03:38:03 INFO  Starting execution of 0 what-if analyses...
2022-09-25 03:38:03 INFO  Estimated runtime of original DAG is 5546.2000370025635ms
2022-09-25 03:38:03 INFO  Performing Multi-Query Optimization
2022-09-25 03:38:03 INFO  Estimated unoptimized what-if runtime is 0ms
2022-09-25 03:38:03 INFO  Estimated optimised what-if runtime is 0ms
2022-09-25 03:38:03 INFO  Estimated optimisation runtime saving is 0ms
2022-09-25 03:38:03 INFO  ---RUNTIME: Multi-Query Optimization took 0.5850791931152344 ms
2022-09-25 03:38:03 INFO  Executing generated plans
2022-09-25 03:38:03 INFO  ---RUNTIME: Execution took 0.024318695068359375 ms
2022-09-25 03:38:03 INFO  Done!
2022-09-25 03:38:03 INFO  # Optimization benchmark for data_corruption with args [['reviews', 'fast_loading', 'featurization_2', 'logistic_regression']] -- repetition 1 of 7
2022-09-25 03:38:03 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-25 03:38:03 INFO  Running instrumented original pipeline...
2022-09-25 03:38:03 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-25 03:38:03 INFO  ---RUNTIME: Importing and monkey-patching took 5.846261978149414 ms
2022-09-25 03:38:09 INFO  ---RUNTIME: Original pipeline execution took 5990.447282791138 ms (excluding imports and monkey-patching)
2022-09-25 03:38:09 INFO  Starting execution of 1 what-if analyses...
2022-09-25 03:38:09 INFO  Start plan generation for analysis DataCorruption...
2022-09-25 03:38:09 INFO  ---RUNTIME: Plan generation took 0.46515464782714844 ms
2022-09-25 03:38:09 INFO  Estimated runtime of original DAG is 5517.847061157227ms
2022-09-25 03:38:09 INFO  Performing Multi-Query Optimization
2022-09-25 03:38:09 INFO  Estimated unoptimized what-if runtime is 137946.17652893066ms
2022-09-25 03:38:09 INFO  Estimated optimised what-if runtime is 13867.473602294922ms
2022-09-25 03:38:09 INFO  Estimated optimisation runtime saving is 124078.70292663574ms
2022-09-25 03:38:09 INFO  ---RUNTIME: Multi-Query Optimization took 67.05784797668457 ms
2022-09-25 03:38:09 INFO  Executing generated plans
2022-09-25 03:38:27 INFO  ---RUNTIME: Execution took 18192.038774490356 ms
2022-09-25 03:38:27 INFO  Done!
2022-09-25 03:38:27 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-25 03:38:27 INFO  Running instrumented original pipeline...
2022-09-25 03:38:27 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-25 03:38:27 INFO  ---RUNTIME: Importing and monkey-patching took 6.19959831237793 ms
2022-09-25 03:38:33 INFO  ---RUNTIME: Original pipeline execution took 5838.928461074829 ms (excluding imports and monkey-patching)
2022-09-25 03:38:33 INFO  Starting execution of 1 what-if analyses...
2022-09-25 03:38:33 INFO  Start plan generation for analysis DataCorruption...
2022-09-25 03:38:33 INFO  ---RUNTIME: Plan generation took 0.4658699035644531 ms
2022-09-25 03:38:33 INFO  Estimated runtime of original DAG is 5537.032127380371ms
2022-09-25 03:38:33 WARNING Skipping Multi-Query Optimization (instead, only applying patches)
2022-09-25 03:38:33 INFO  Estimated unoptimised what-if runtime is 138425.80318450928ms
2022-09-25 03:38:33 INFO  ---RUNTIME: Multi-Query Optimization took 19.418001174926758 ms
2022-09-25 03:38:33 INFO  Executing generated plans
2022-09-25 03:41:05 INFO  ---RUNTIME: Execution took 151673.5064983368 ms
2022-09-25 03:41:05 INFO  Done!
2022-09-25 03:41:05 INFO  # Finished -- repetition 1 of 7 
2022-09-25 03:41:05 INFO  # Optimization benchmark for data_corruption with args [['reviews', 'fast_loading', 'featurization_2', 'logistic_regression']] -- repetition 2 of 7
2022-09-25 03:41:05 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-25 03:41:05 INFO  Running instrumented original pipeline...
2022-09-25 03:41:05 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-25 03:41:05 INFO  ---RUNTIME: Importing and monkey-patching took 6.209135055541992 ms
2022-09-25 03:41:10 INFO  ---RUNTIME: Original pipeline execution took 5764.343976974487 ms (excluding imports and monkey-patching)
2022-09-25 03:41:10 INFO  Starting execution of 1 what-if analyses...
2022-09-25 03:41:10 INFO  Start plan generation for analysis DataCorruption...
2022-09-25 03:41:10 INFO  ---RUNTIME: Plan generation took 0.4496574401855469 ms
2022-09-25 03:41:10 INFO  Estimated runtime of original DAG is 5465.707778930664ms
2022-09-25 03:41:10 INFO  Performing Multi-Query Optimization
2022-09-25 03:41:10 INFO  Estimated unoptimized what-if runtime is 136642.6944732666ms
2022-09-25 03:41:10 INFO  Estimated optimised what-if runtime is 13784.296751022339ms
2022-09-25 03:41:10 INFO  Estimated optimisation runtime saving is 122858.39772224426ms
2022-09-25 03:41:10 INFO  ---RUNTIME: Multi-Query Optimization took 66.26725196838379 ms
2022-09-25 03:41:10 INFO  Executing generated plans
2022-09-25 03:41:29 INFO  ---RUNTIME: Execution took 18314.343452453613 ms
2022-09-25 03:41:29 INFO  Done!
2022-09-25 03:41:29 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-25 03:41:29 INFO  Running instrumented original pipeline...
2022-09-25 03:41:29 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-25 03:41:29 INFO  ---RUNTIME: Importing and monkey-patching took 6.011247634887695 ms
2022-09-25 03:41:35 INFO  ---RUNTIME: Original pipeline execution took 5798.680305480957 ms (excluding imports and monkey-patching)
2022-09-25 03:41:35 INFO  Starting execution of 1 what-if analyses...
2022-09-25 03:41:35 INFO  Start plan generation for analysis DataCorruption...
2022-09-25 03:41:35 INFO  ---RUNTIME: Plan generation took 0.4227161407470703 ms
2022-09-25 03:41:35 INFO  Estimated runtime of original DAG is 5499.415874481201ms
2022-09-25 03:41:35 WARNING Skipping Multi-Query Optimization (instead, only applying patches)
2022-09-25 03:41:35 INFO  Estimated unoptimised what-if runtime is 137485.39686203003ms
2022-09-25 03:41:35 INFO  ---RUNTIME: Multi-Query Optimization took 19.52838897705078 ms
2022-09-25 03:41:35 INFO  Executing generated plans
2022-09-25 03:44:06 INFO  ---RUNTIME: Execution took 151595.82567214966 ms
2022-09-25 03:44:06 INFO  Done!
2022-09-25 03:44:06 INFO  # Finished -- repetition 2 of 7 
2022-09-25 03:44:06 INFO  # Optimization benchmark for data_corruption with args [['reviews', 'fast_loading', 'featurization_2', 'logistic_regression']] -- repetition 3 of 7
2022-09-25 03:44:06 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-25 03:44:06 INFO  Running instrumented original pipeline...
2022-09-25 03:44:06 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-25 03:44:06 INFO  ---RUNTIME: Importing and monkey-patching took 6.200551986694336 ms
2022-09-25 03:44:12 INFO  ---RUNTIME: Original pipeline execution took 5793.968439102173 ms (excluding imports and monkey-patching)
2022-09-25 03:44:12 INFO  Starting execution of 1 what-if analyses...
2022-09-25 03:44:12 INFO  Start plan generation for analysis DataCorruption...
2022-09-25 03:44:12 INFO  ---RUNTIME: Plan generation took 0.5249977111816406 ms
2022-09-25 03:44:12 INFO  Estimated runtime of original DAG is 5489.975452423096ms
2022-09-25 03:44:12 INFO  Performing Multi-Query Optimization
2022-09-25 03:44:12 INFO  Estimated unoptimized what-if runtime is 137249.3863105774ms
2022-09-25 03:44:12 INFO  Estimated optimised what-if runtime is 13789.090871810913ms
2022-09-25 03:44:12 INFO  Estimated optimisation runtime saving is 123460.29543876648ms
2022-09-25 03:44:12 INFO  ---RUNTIME: Multi-Query Optimization took 264.8758888244629 ms
2022-09-25 03:44:12 INFO  Executing generated plans
2022-09-25 03:44:31 INFO  ---RUNTIME: Execution took 18358.36172103882 ms
2022-09-25 03:44:31 INFO  Done!
2022-09-25 03:44:31 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-25 03:44:31 INFO  Running instrumented original pipeline...
2022-09-25 03:44:31 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-25 03:44:31 INFO  ---RUNTIME: Importing and monkey-patching took 5.755186080932617 ms
2022-09-25 03:44:36 INFO  ---RUNTIME: Original pipeline execution took 5828.5510540008545 ms (excluding imports and monkey-patching)
2022-09-25 03:44:36 INFO  Starting execution of 1 what-if analyses...
2022-09-25 03:44:36 INFO  Start plan generation for analysis DataCorruption...
2022-09-25 03:44:36 INFO  ---RUNTIME: Plan generation took 0.4317760467529297 ms
2022-09-25 03:44:36 INFO  Estimated runtime of original DAG is 5524.8212814331055ms
2022-09-25 03:44:36 WARNING Skipping Multi-Query Optimization (instead, only applying patches)
2022-09-25 03:44:36 INFO  Estimated unoptimised what-if runtime is 138120.53203582764ms
2022-09-25 03:44:36 INFO  ---RUNTIME: Multi-Query Optimization took 19.526958465576172 ms
2022-09-25 03:44:36 INFO  Executing generated plans
2022-09-25 03:47:09 INFO  ---RUNTIME: Execution took 152457.80563354492 ms
2022-09-25 03:47:09 INFO  Done!
2022-09-25 03:47:09 INFO  # Finished -- repetition 3 of 7 
2022-09-25 03:47:09 INFO  # Optimization benchmark for data_corruption with args [['reviews', 'fast_loading', 'featurization_2', 'logistic_regression']] -- repetition 4 of 7
2022-09-25 03:47:09 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-25 03:47:09 INFO  Running instrumented original pipeline...
2022-09-25 03:47:09 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-25 03:47:09 INFO  ---RUNTIME: Importing and monkey-patching took 6.356000900268555 ms
2022-09-25 03:47:15 INFO  ---RUNTIME: Original pipeline execution took 5857.901096343994 ms (excluding imports and monkey-patching)
2022-09-25 03:47:15 INFO  Starting execution of 1 what-if analyses...
2022-09-25 03:47:15 INFO  Start plan generation for analysis DataCorruption...
2022-09-25 03:47:15 INFO  ---RUNTIME: Plan generation took 0.4336833953857422 ms
2022-09-25 03:47:15 INFO  Estimated runtime of original DAG is 5552.068471908569ms
2022-09-25 03:47:15 INFO  Performing Multi-Query Optimization
2022-09-25 03:47:15 INFO  Estimated unoptimized what-if runtime is 138801.71179771423ms
2022-09-25 03:47:15 INFO  Estimated optimised what-if runtime is 13853.085994720459ms
2022-09-25 03:47:15 INFO  Estimated optimisation runtime saving is 124948.62580299377ms
2022-09-25 03:47:15 INFO  ---RUNTIME: Multi-Query Optimization took 66.18881225585938 ms
2022-09-25 03:47:15 INFO  Executing generated plans
2022-09-25 03:47:33 INFO  ---RUNTIME: Execution took 18337.26406097412 ms
2022-09-25 03:47:33 INFO  Done!
2022-09-25 03:47:33 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-25 03:47:33 INFO  Running instrumented original pipeline...
2022-09-25 03:47:33 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-25 03:47:33 INFO  ---RUNTIME: Importing and monkey-patching took 6.300926208496094 ms
2022-09-25 03:47:39 INFO  ---RUNTIME: Original pipeline execution took 6234.448671340942 ms (excluding imports and monkey-patching)
2022-09-25 03:47:39 INFO  Starting execution of 1 what-if analyses...
2022-09-25 03:47:39 INFO  Start plan generation for analysis DataCorruption...
2022-09-25 03:47:39 INFO  ---RUNTIME: Plan generation took 0.47016143798828125 ms
2022-09-25 03:47:39 INFO  Estimated runtime of original DAG is 5912.236928939819ms
2022-09-25 03:47:39 WARNING Skipping Multi-Query Optimization (instead, only applying patches)
2022-09-25 03:47:40 INFO  Estimated unoptimised what-if runtime is 147805.92322349548ms
2022-09-25 03:47:40 INFO  ---RUNTIME: Multi-Query Optimization took 20.804643630981445 ms
2022-09-25 03:47:40 INFO  Executing generated plans
2022-09-25 03:50:15 INFO  ---RUNTIME: Execution took 155762.0849609375 ms
2022-09-25 03:50:15 INFO  Done!
2022-09-25 03:50:15 INFO  # Finished -- repetition 4 of 7 
2022-09-25 03:50:15 INFO  # Optimization benchmark for data_corruption with args [['reviews', 'fast_loading', 'featurization_2', 'logistic_regression']] -- repetition 5 of 7
2022-09-25 03:50:15 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-25 03:50:15 INFO  Running instrumented original pipeline...
2022-09-25 03:50:15 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-25 03:50:15 INFO  ---RUNTIME: Importing and monkey-patching took 6.210565567016602 ms
2022-09-25 03:50:21 INFO  ---RUNTIME: Original pipeline execution took 5873.713493347168 ms (excluding imports and monkey-patching)
2022-09-25 03:50:21 INFO  Starting execution of 1 what-if analyses...
2022-09-25 03:50:21 INFO  Start plan generation for analysis DataCorruption...
2022-09-25 03:50:21 INFO  ---RUNTIME: Plan generation took 0.4420280456542969 ms
2022-09-25 03:50:21 INFO  Estimated runtime of original DAG is 5571.680545806885ms
2022-09-25 03:50:21 INFO  Performing Multi-Query Optimization
2022-09-25 03:50:21 INFO  Estimated unoptimized what-if runtime is 139292.01364517212ms
2022-09-25 03:50:21 INFO  Estimated optimised what-if runtime is 13908.120393753052ms
2022-09-25 03:50:21 INFO  Estimated optimisation runtime saving is 125383.89325141907ms
2022-09-25 03:50:21 INFO  ---RUNTIME: Multi-Query Optimization took 66.34855270385742 ms
2022-09-25 03:50:21 INFO  Executing generated plans
2022-09-25 03:50:40 INFO  ---RUNTIME: Execution took 19045.260906219482 ms
2022-09-25 03:50:40 INFO  Done!
2022-09-25 03:50:40 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-25 03:50:40 INFO  Running instrumented original pipeline...
2022-09-25 03:50:40 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-25 03:50:40 INFO  ---RUNTIME: Importing and monkey-patching took 6.883859634399414 ms
2022-09-25 03:50:47 INFO  ---RUNTIME: Original pipeline execution took 6232.117176055908 ms (excluding imports and monkey-patching)
2022-09-25 03:50:47 INFO  Starting execution of 1 what-if analyses...
2022-09-25 03:50:47 INFO  Start plan generation for analysis DataCorruption...
2022-09-25 03:50:47 INFO  ---RUNTIME: Plan generation took 0.4775524139404297 ms
2022-09-25 03:50:47 INFO  Estimated runtime of original DAG is 5904.700517654419ms
2022-09-25 03:50:47 WARNING Skipping Multi-Query Optimization (instead, only applying patches)
2022-09-25 03:50:47 INFO  Estimated unoptimised what-if runtime is 147617.51294136047ms
2022-09-25 03:50:47 INFO  ---RUNTIME: Multi-Query Optimization took 19.997596740722656 ms
2022-09-25 03:50:47 INFO  Executing generated plans
2022-09-25 03:53:22 INFO  ---RUNTIME: Execution took 155413.17296028137 ms
2022-09-25 03:53:22 INFO  Done!
2022-09-25 03:53:22 INFO  # Finished -- repetition 5 of 7 
2022-09-25 03:53:22 INFO  # Optimization benchmark for data_corruption with args [['reviews', 'fast_loading', 'featurization_2', 'logistic_regression']] -- repetition 6 of 7
2022-09-25 03:53:22 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-25 03:53:22 INFO  Running instrumented original pipeline...
2022-09-25 03:53:22 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-25 03:53:22 INFO  ---RUNTIME: Importing and monkey-patching took 7.010698318481445 ms
2022-09-25 03:53:28 INFO  ---RUNTIME: Original pipeline execution took 6246.238946914673 ms (excluding imports and monkey-patching)
2022-09-25 03:53:28 INFO  Starting execution of 1 what-if analyses...
2022-09-25 03:53:28 INFO  Start plan generation for analysis DataCorruption...
2022-09-25 03:53:28 INFO  ---RUNTIME: Plan generation took 0.4906654357910156 ms
2022-09-25 03:53:28 INFO  Estimated runtime of original DAG is 5928.173303604126ms
2022-09-25 03:53:28 INFO  Performing Multi-Query Optimization
2022-09-25 03:53:28 INFO  Estimated unoptimized what-if runtime is 148204.33259010315ms
2022-09-25 03:53:28 INFO  Estimated optimised what-if runtime is 14739.120483398438ms
2022-09-25 03:53:28 INFO  Estimated optimisation runtime saving is 133465.2121067047ms
2022-09-25 03:53:28 INFO  ---RUNTIME: Multi-Query Optimization took 72.27540016174316 ms
2022-09-25 03:53:28 INFO  Executing generated plans
2022-09-25 03:53:47 INFO  ---RUNTIME: Execution took 19068.99619102478 ms
2022-09-25 03:53:47 INFO  Done!
2022-09-25 03:53:47 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-25 03:53:47 INFO  Running instrumented original pipeline...
2022-09-25 03:53:47 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-25 03:53:47 INFO  ---RUNTIME: Importing and monkey-patching took 9.232759475708008 ms
2022-09-25 03:53:53 INFO  ---RUNTIME: Original pipeline execution took 5843.717575073242 ms (excluding imports and monkey-patching)
2022-09-25 03:53:53 INFO  Starting execution of 1 what-if analyses...
2022-09-25 03:53:53 INFO  Start plan generation for analysis DataCorruption...
2022-09-25 03:53:53 INFO  ---RUNTIME: Plan generation took 0.4417896270751953 ms
2022-09-25 03:53:53 INFO  Estimated runtime of original DAG is 5535.598278045654ms
2022-09-25 03:53:53 WARNING Skipping Multi-Query Optimization (instead, only applying patches)
2022-09-25 03:53:53 INFO  Estimated unoptimised what-if runtime is 138389.95695114136ms
2022-09-25 03:53:53 INFO  ---RUNTIME: Multi-Query Optimization took 19.443273544311523 ms
2022-09-25 03:53:53 INFO  Executing generated plans
2022-09-25 03:56:29 INFO  ---RUNTIME: Execution took 155422.1634864807 ms
2022-09-25 03:56:29 INFO  Done!
2022-09-25 03:56:29 INFO  # Finished -- repetition 6 of 7 
2022-09-25 03:56:29 INFO  # Optimization benchmark for data_corruption with args [['reviews', 'fast_loading', 'featurization_2', 'logistic_regression']] -- repetition 7 of 7
2022-09-25 03:56:29 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-25 03:56:29 INFO  Running instrumented original pipeline...
2022-09-25 03:56:29 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-25 03:56:29 INFO  ---RUNTIME: Importing and monkey-patching took 6.218433380126953 ms
2022-09-25 03:56:35 INFO  ---RUNTIME: Original pipeline execution took 6160.225868225098 ms (excluding imports and monkey-patching)
2022-09-25 03:56:35 INFO  Starting execution of 1 what-if analyses...
2022-09-25 03:56:35 INFO  Start plan generation for analysis DataCorruption...
2022-09-25 03:56:35 INFO  ---RUNTIME: Plan generation took 0.47469139099121094 ms
2022-09-25 03:56:35 INFO  Estimated runtime of original DAG is 5841.674327850342ms
2022-09-25 03:56:35 INFO  Performing Multi-Query Optimization
2022-09-25 03:56:35 INFO  Estimated unoptimized what-if runtime is 146041.85819625854ms
2022-09-25 03:56:35 INFO  Estimated optimised what-if runtime is 14573.203802108765ms
2022-09-25 03:56:35 INFO  Estimated optimisation runtime saving is 131468.65439414978ms
2022-09-25 03:56:35 INFO  ---RUNTIME: Multi-Query Optimization took 73.35758209228516 ms
2022-09-25 03:56:35 INFO  Executing generated plans
2022-09-25 03:56:54 INFO  ---RUNTIME: Execution took 18645.128965377808 ms
2022-09-25 03:56:54 INFO  Done!
2022-09-25 03:56:54 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-25 03:56:54 INFO  Running instrumented original pipeline...
2022-09-25 03:56:54 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-25 03:56:54 INFO  ---RUNTIME: Importing and monkey-patching took 5.815267562866211 ms
2022-09-25 03:57:00 INFO  ---RUNTIME: Original pipeline execution took 5854.283332824707 ms (excluding imports and monkey-patching)
2022-09-25 03:57:00 INFO  Starting execution of 1 what-if analyses...
2022-09-25 03:57:00 INFO  Start plan generation for analysis DataCorruption...
2022-09-25 03:57:00 INFO  ---RUNTIME: Plan generation took 0.45371055603027344 ms
2022-09-25 03:57:00 INFO  Estimated runtime of original DAG is 5551.848649978638ms
2022-09-25 03:57:00 WARNING Skipping Multi-Query Optimization (instead, only applying patches)
2022-09-25 03:57:00 INFO  Estimated unoptimised what-if runtime is 138796.21624946594ms
2022-09-25 03:57:00 INFO  ---RUNTIME: Multi-Query Optimization took 19.623517990112305 ms
2022-09-25 03:57:00 INFO  Executing generated plans
2022-09-25 03:59:35 INFO  ---RUNTIME: Execution took 155711.49587631226 ms
2022-09-25 03:59:35 INFO  Done!
2022-09-25 03:59:35 INFO  # Finished -- repetition 7 of 7 
2022-09-25 03:59:35 INFO  # Final results after all repetitions
2022-09-25 03:59:35 INFO     repetition  ... no_opt_what_if_execution_combined_model_training
0           0  ...                                      2594.753027
1           1  ...                                      2528.252125
2           2  ...                                      2523.693085
3           3  ...                                      2691.698790
4           4  ...                                      2765.841961
5           5  ...                                      2687.651634
6           6  ...                                      2609.646082

[7 rows x 26 columns]
PROTOCOL_BUFFERS_PYTHON_IMPLEMENTATION=python taskset -c 32-39 python3.9 benchmarks_end_to_end.py data_corruption reviews fast_loading featurization_2 xgboost
2022-09-25 03:59:37.996829: W tensorflow/stream_executor/platform/default/dso_loader.cc:64] Could not load dynamic library 'libcudart.so.11.0'; dlerror: libcudart.so.11.0: cannot open shared object file: No such file or directory; LD_LIBRARY_PATH: /home/sgrafbe/mlwhatif/venv/lib/python3.9/site-packages/cv2/../../lib64:
2022-09-25 03:59:37.996871: I tensorflow/stream_executor/cuda/cudart_stub.cc:29] Ignore above cudart dlerror if you do not have a GPU set up on your machine.
2022-09-25 03:59:39 INFO  Patching sys.argv with ['mlwhatif', 'reviews', 'fast_loading', 'featurization_2', 'xgboost']
2022-09-25 03:59:39 INFO  Running instrumented original pipeline...
2022-09-25 03:59:39 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-25 03:59:39 INFO  ---RUNTIME: Importing and monkey-patching took 136.08789443969727 ms
2022-09-25 04:00:20 INFO  ---RUNTIME: Original pipeline execution took 40779.720067977905 ms (excluding imports and monkey-patching)
2022-09-25 04:00:20 INFO  Starting execution of 0 what-if analyses...
2022-09-25 04:00:20 INFO  Estimated runtime of original DAG is 40422.513008117676ms
2022-09-25 04:00:20 INFO  Performing Multi-Query Optimization
2022-09-25 04:00:20 INFO  Estimated unoptimized what-if runtime is 0ms
2022-09-25 04:00:20 INFO  Estimated optimised what-if runtime is 0ms
2022-09-25 04:00:20 INFO  Estimated optimisation runtime saving is 0ms
2022-09-25 04:00:20 INFO  ---RUNTIME: Multi-Query Optimization took 0.5385875701904297 ms
2022-09-25 04:00:20 INFO  Executing generated plans
2022-09-25 04:00:20 INFO  ---RUNTIME: Execution took 0.024318695068359375 ms
2022-09-25 04:00:20 INFO  Done!
2022-09-25 04:00:20 INFO  # Optimization benchmark for data_corruption with args [['reviews', 'fast_loading', 'featurization_2', 'xgboost']] -- repetition 1 of 7
2022-09-25 04:00:20 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-25 04:00:20 INFO  Running instrumented original pipeline...
2022-09-25 04:00:20 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-25 04:00:20 INFO  ---RUNTIME: Importing and monkey-patching took 7.114171981811523 ms
2022-09-25 04:01:00 INFO  ---RUNTIME: Original pipeline execution took 40702.30960845947 ms (excluding imports and monkey-patching)
2022-09-25 04:01:00 INFO  Starting execution of 1 what-if analyses...
2022-09-25 04:01:00 INFO  Start plan generation for analysis DataCorruption...
2022-09-25 04:01:00 INFO  ---RUNTIME: Plan generation took 0.4277229309082031 ms
2022-09-25 04:01:00 INFO  Estimated runtime of original DAG is 40225.385665893555ms
2022-09-25 04:01:00 INFO  Performing Multi-Query Optimization
2022-09-25 04:01:00 INFO  Estimated unoptimized what-if runtime is 1005634.6416473389ms
2022-09-25 04:01:00 INFO  Estimated optimised what-if runtime is 57403.780937194824ms
2022-09-25 04:01:00 INFO  Estimated optimisation runtime saving is 948230.860710144ms
2022-09-25 04:01:00 INFO  ---RUNTIME: Multi-Query Optimization took 70.00017166137695 ms
2022-09-25 04:01:00 INFO  Executing generated plans
2022-09-25 04:02:02 INFO  ---RUNTIME: Execution took 61160.70747375488 ms
2022-09-25 04:02:02 INFO  Done!
2022-09-25 04:02:02 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-25 04:02:02 INFO  Running instrumented original pipeline...
2022-09-25 04:02:02 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-25 04:02:02 INFO  ---RUNTIME: Importing and monkey-patching took 6.534337997436523 ms
2022-09-25 04:02:43 INFO  ---RUNTIME: Original pipeline execution took 41144.28186416626 ms (excluding imports and monkey-patching)
2022-09-25 04:02:43 INFO  Starting execution of 1 what-if analyses...
2022-09-25 04:02:43 INFO  Start plan generation for analysis DataCorruption...
2022-09-25 04:02:43 INFO  ---RUNTIME: Plan generation took 0.4649162292480469 ms
2022-09-25 04:02:43 INFO  Estimated runtime of original DAG is 40829.3023109436ms
2022-09-25 04:02:43 WARNING Skipping Multi-Query Optimization (instead, only applying patches)
2022-09-25 04:02:43 INFO  Estimated unoptimised what-if runtime is 1020732.5577735901ms
2022-09-25 04:02:43 INFO  ---RUNTIME: Multi-Query Optimization took 19.269704818725586 ms
2022-09-25 04:02:43 INFO  Executing generated plans
2022-09-25 04:19:34 INFO  ---RUNTIME: Execution took 1010718.0778980255 ms
2022-09-25 04:19:34 INFO  Done!
2022-09-25 04:19:34 INFO  # Finished -- repetition 1 of 7 
2022-09-25 04:19:34 INFO  # Optimization benchmark for data_corruption with args [['reviews', 'fast_loading', 'featurization_2', 'xgboost']] -- repetition 2 of 7
2022-09-25 04:19:34 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-25 04:19:34 INFO  Running instrumented original pipeline...
2022-09-25 04:19:34 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-25 04:19:34 INFO  ---RUNTIME: Importing and monkey-patching took 6.340265274047852 ms
2022-09-25 04:20:13 INFO  ---RUNTIME: Original pipeline execution took 39945.199966430664 ms (excluding imports and monkey-patching)
2022-09-25 04:20:13 INFO  Starting execution of 1 what-if analyses...
2022-09-25 04:20:13 INFO  Start plan generation for analysis DataCorruption...
2022-09-25 04:20:13 INFO  ---RUNTIME: Plan generation took 0.4551410675048828 ms
2022-09-25 04:20:13 INFO  Estimated runtime of original DAG is 39643.895864486694ms
2022-09-25 04:20:13 INFO  Performing Multi-Query Optimization
2022-09-25 04:20:14 INFO  Estimated unoptimized what-if runtime is 991097.3966121674ms
2022-09-25 04:20:14 INFO  Estimated optimised what-if runtime is 55992.92182922363ms
2022-09-25 04:20:14 INFO  Estimated optimisation runtime saving is 935104.4747829437ms
2022-09-25 04:20:14 INFO  ---RUNTIME: Multi-Query Optimization took 66.56908988952637 ms
2022-09-25 04:20:14 INFO  Executing generated plans
2022-09-25 04:21:14 INFO  ---RUNTIME: Execution took 60282.80162811279 ms
2022-09-25 04:21:14 INFO  Done!
2022-09-25 04:21:14 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-25 04:21:14 INFO  Running instrumented original pipeline...
2022-09-25 04:21:14 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-25 04:21:14 INFO  ---RUNTIME: Importing and monkey-patching took 6.258249282836914 ms
2022-09-25 04:21:54 INFO  ---RUNTIME: Original pipeline execution took 39919.72374916077 ms (excluding imports and monkey-patching)
2022-09-25 04:21:54 INFO  Starting execution of 1 what-if analyses...
2022-09-25 04:21:54 INFO  Start plan generation for analysis DataCorruption...
2022-09-25 04:21:54 INFO  ---RUNTIME: Plan generation took 0.4341602325439453 ms
2022-09-25 04:21:54 INFO  Estimated runtime of original DAG is 39619.898080825806ms
2022-09-25 04:21:54 WARNING Skipping Multi-Query Optimization (instead, only applying patches)
2022-09-25 04:21:54 INFO  Estimated unoptimised what-if runtime is 990497.4520206451ms
2022-09-25 04:21:54 INFO  ---RUNTIME: Multi-Query Optimization took 19.14501190185547 ms
2022-09-25 04:21:54 INFO  Executing generated plans
2022-09-25 04:38:40 INFO  ---RUNTIME: Execution took 1006030.6890010834 ms
2022-09-25 04:38:40 INFO  Done!
2022-09-25 04:38:40 INFO  # Finished -- repetition 2 of 7 
2022-09-25 04:38:40 INFO  # Optimization benchmark for data_corruption with args [['reviews', 'fast_loading', 'featurization_2', 'xgboost']] -- repetition 3 of 7
2022-09-25 04:38:40 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-25 04:38:40 INFO  Running instrumented original pipeline...
2022-09-25 04:38:40 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-25 04:38:40 INFO  ---RUNTIME: Importing and monkey-patching took 6.293058395385742 ms
2022-09-25 04:39:20 INFO  ---RUNTIME: Original pipeline execution took 39956.36987686157 ms (excluding imports and monkey-patching)
2022-09-25 04:39:20 INFO  Starting execution of 1 what-if analyses...
2022-09-25 04:39:20 INFO  Start plan generation for analysis DataCorruption...
2022-09-25 04:39:20 INFO  ---RUNTIME: Plan generation took 0.5195140838623047 ms
2022-09-25 04:39:20 INFO  Estimated runtime of original DAG is 39654.50716018677ms
2022-09-25 04:39:20 INFO  Performing Multi-Query Optimization
2022-09-25 04:39:20 INFO  Estimated unoptimized what-if runtime is 991362.6790046692ms
2022-09-25 04:39:20 INFO  Estimated optimised what-if runtime is 55994.39334869385ms
2022-09-25 04:39:20 INFO  Estimated optimisation runtime saving is 935368.2856559753ms
2022-09-25 04:39:20 INFO  ---RUNTIME: Multi-Query Optimization took 243.8223361968994 ms
2022-09-25 04:39:20 INFO  Executing generated plans
2022-09-25 04:40:20 INFO  ---RUNTIME: Execution took 60139.845848083496 ms
2022-09-25 04:40:20 INFO  Done!
2022-09-25 04:40:20 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-25 04:40:20 INFO  Running instrumented original pipeline...
2022-09-25 04:40:20 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-25 04:40:20 INFO  ---RUNTIME: Importing and monkey-patching took 6.132841110229492 ms
2022-09-25 04:41:00 INFO  ---RUNTIME: Original pipeline execution took 39950.68883895874 ms (excluding imports and monkey-patching)
2022-09-25 04:41:00 INFO  Starting execution of 1 what-if analyses...
2022-09-25 04:41:00 INFO  Start plan generation for analysis DataCorruption...
2022-09-25 04:41:00 INFO  ---RUNTIME: Plan generation took 0.41985511779785156 ms
2022-09-25 04:41:00 INFO  Estimated runtime of original DAG is 39647.53270149231ms
2022-09-25 04:41:00 WARNING Skipping Multi-Query Optimization (instead, only applying patches)
2022-09-25 04:41:00 INFO  Estimated unoptimised what-if runtime is 991188.3175373077ms
2022-09-25 04:41:00 INFO  ---RUNTIME: Multi-Query Optimization took 19.182920455932617 ms
2022-09-25 04:41:00 INFO  Executing generated plans
2022-09-25 04:57:57 INFO  ---RUNTIME: Execution took 1016656.3110351562 ms
2022-09-25 04:57:57 INFO  Done!
2022-09-25 04:57:57 INFO  # Finished -- repetition 3 of 7 
2022-09-25 04:57:57 INFO  # Optimization benchmark for data_corruption with args [['reviews', 'fast_loading', 'featurization_2', 'xgboost']] -- repetition 4 of 7
2022-09-25 04:57:57 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-25 04:57:57 INFO  Running instrumented original pipeline...
2022-09-25 04:57:57 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-25 04:57:57 INFO  ---RUNTIME: Importing and monkey-patching took 6.333827972412109 ms
2022-09-25 04:58:38 INFO  ---RUNTIME: Original pipeline execution took 40689.98193740845 ms (excluding imports and monkey-patching)
2022-09-25 04:58:38 INFO  Starting execution of 1 what-if analyses...
2022-09-25 04:58:38 INFO  Start plan generation for analysis DataCorruption...
2022-09-25 04:58:38 INFO  ---RUNTIME: Plan generation took 0.4792213439941406 ms
2022-09-25 04:58:38 INFO  Estimated runtime of original DAG is 40387.502670288086ms
2022-09-25 04:58:38 INFO  Performing Multi-Query Optimization
2022-09-25 04:58:38 INFO  Estimated unoptimized what-if runtime is 1009687.5667572021ms
2022-09-25 04:58:38 INFO  Estimated optimised what-if runtime is 57260.46872138977ms
2022-09-25 04:58:38 INFO  Estimated optimisation runtime saving is 952427.0980358124ms
2022-09-25 04:58:38 INFO  ---RUNTIME: Multi-Query Optimization took 71.44403457641602 ms
2022-09-25 04:58:38 INFO  Executing generated plans
2022-09-25 04:59:39 INFO  ---RUNTIME: Execution took 61308.077812194824 ms
2022-09-25 04:59:39 INFO  Done!
2022-09-25 04:59:39 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-25 04:59:39 INFO  Running instrumented original pipeline...
2022-09-25 04:59:39 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-25 04:59:39 INFO  ---RUNTIME: Importing and monkey-patching took 6.2656402587890625 ms
2022-09-25 05:00:20 INFO  ---RUNTIME: Original pipeline execution took 40601.62448883057 ms (excluding imports and monkey-patching)
2022-09-25 05:00:20 INFO  Starting execution of 1 what-if analyses...
2022-09-25 05:00:20 INFO  Start plan generation for analysis DataCorruption...
2022-09-25 05:00:20 INFO  ---RUNTIME: Plan generation took 0.43320655822753906 ms
2022-09-25 05:00:20 INFO  Estimated runtime of original DAG is 40285.760164260864ms
2022-09-25 05:00:20 WARNING Skipping Multi-Query Optimization (instead, only applying patches)
2022-09-25 05:00:20 INFO  Estimated unoptimised what-if runtime is 1007144.0041065216ms
2022-09-25 05:00:20 INFO  ---RUNTIME: Multi-Query Optimization took 20.2178955078125 ms
2022-09-25 05:00:20 INFO  Executing generated plans
2022-09-25 05:17:29 INFO  ---RUNTIME: Execution took 1029769.35505867 ms
2022-09-25 05:17:29 INFO  Done!
2022-09-25 05:17:29 INFO  # Finished -- repetition 4 of 7 
2022-09-25 05:17:29 INFO  # Optimization benchmark for data_corruption with args [['reviews', 'fast_loading', 'featurization_2', 'xgboost']] -- repetition 5 of 7
2022-09-25 05:17:29 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-25 05:17:29 INFO  Running instrumented original pipeline...
2022-09-25 05:17:29 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-25 05:17:29 INFO  ---RUNTIME: Importing and monkey-patching took 6.19959831237793 ms
2022-09-25 05:18:10 INFO  ---RUNTIME: Original pipeline execution took 40738.157987594604 ms (excluding imports and monkey-patching)
2022-09-25 05:18:10 INFO  Starting execution of 1 what-if analyses...
2022-09-25 05:18:10 INFO  Start plan generation for analysis DataCorruption...
2022-09-25 05:18:10 INFO  ---RUNTIME: Plan generation took 0.4940032958984375 ms
2022-09-25 05:18:10 INFO  Estimated runtime of original DAG is 40435.81700325012ms
2022-09-25 05:18:10 INFO  Performing Multi-Query Optimization
2022-09-25 05:18:10 INFO  Estimated unoptimized what-if runtime is 1010895.425081253ms
2022-09-25 05:18:10 INFO  Estimated optimised what-if runtime is 57863.02471160889ms
2022-09-25 05:18:10 INFO  Estimated optimisation runtime saving is 953032.4003696442ms
2022-09-25 05:18:10 INFO  ---RUNTIME: Multi-Query Optimization took 71.71297073364258 ms
2022-09-25 05:18:10 INFO  Executing generated plans
2022-09-25 05:19:11 INFO  ---RUNTIME: Execution took 60948.95100593567 ms
2022-09-25 05:19:11 INFO  Done!
2022-09-25 05:19:11 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-25 05:19:11 INFO  Running instrumented original pipeline...
2022-09-25 05:19:11 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-25 05:19:11 INFO  ---RUNTIME: Importing and monkey-patching took 6.981372833251953 ms
2022-09-25 05:19:53 INFO  ---RUNTIME: Original pipeline execution took 41955.302715301514 ms (excluding imports and monkey-patching)
2022-09-25 05:19:53 INFO  Starting execution of 1 what-if analyses...
2022-09-25 05:19:53 INFO  Start plan generation for analysis DataCorruption...
2022-09-25 05:19:53 INFO  ---RUNTIME: Plan generation took 0.44727325439453125 ms
2022-09-25 05:19:53 INFO  Estimated runtime of original DAG is 41639.35446739197ms
2022-09-25 05:19:53 WARNING Skipping Multi-Query Optimization (instead, only applying patches)
2022-09-25 05:19:53 INFO  Estimated unoptimised what-if runtime is 1040983.8616847992ms
2022-09-25 05:19:53 INFO  ---RUNTIME: Multi-Query Optimization took 21.144390106201172 ms
2022-09-25 05:19:53 INFO  Executing generated plans
2022-09-25 05:36:42 INFO  ---RUNTIME: Execution took 1008842.3001766205 ms
2022-09-25 05:36:42 INFO  Done!
2022-09-25 05:36:42 INFO  # Finished -- repetition 5 of 7 
2022-09-25 05:36:42 INFO  # Optimization benchmark for data_corruption with args [['reviews', 'fast_loading', 'featurization_2', 'xgboost']] -- repetition 6 of 7
2022-09-25 05:36:42 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-25 05:36:42 INFO  Running instrumented original pipeline...
2022-09-25 05:36:42 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-25 05:36:42 INFO  ---RUNTIME: Importing and monkey-patching took 6.0939788818359375 ms
2022-09-25 05:37:22 INFO  ---RUNTIME: Original pipeline execution took 39910.53748130798 ms (excluding imports and monkey-patching)
2022-09-25 05:37:22 INFO  Starting execution of 1 what-if analyses...
2022-09-25 05:37:22 INFO  Start plan generation for analysis DataCorruption...
2022-09-25 05:37:22 INFO  ---RUNTIME: Plan generation took 0.4329681396484375 ms
2022-09-25 05:37:22 INFO  Estimated runtime of original DAG is 39608.10995101929ms
2022-09-25 05:37:22 INFO  Performing Multi-Query Optimization
2022-09-25 05:37:22 INFO  Estimated unoptimized what-if runtime is 990202.7487754822ms
2022-09-25 05:37:22 INFO  Estimated optimised what-if runtime is 55853.44862937927ms
2022-09-25 05:37:22 INFO  Estimated optimisation runtime saving is 934349.3001461029ms
2022-09-25 05:37:22 INFO  ---RUNTIME: Multi-Query Optimization took 65.948486328125 ms
2022-09-25 05:37:22 INFO  Executing generated plans
2022-09-25 05:38:22 INFO  ---RUNTIME: Execution took 60016.01266860962 ms
2022-09-25 05:38:22 INFO  Done!
2022-09-25 05:38:22 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-25 05:38:22 INFO  Running instrumented original pipeline...
2022-09-25 05:38:22 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-25 05:38:22 INFO  ---RUNTIME: Importing and monkey-patching took 6.270408630371094 ms
2022-09-25 05:39:02 INFO  ---RUNTIME: Original pipeline execution took 39950.5615234375 ms (excluding imports and monkey-patching)
2022-09-25 05:39:02 INFO  Starting execution of 1 what-if analyses...
2022-09-25 05:39:02 INFO  Start plan generation for analysis DataCorruption...
2022-09-25 05:39:02 INFO  ---RUNTIME: Plan generation took 0.42748451232910156 ms
2022-09-25 05:39:02 INFO  Estimated runtime of original DAG is 39648.38218688965ms
2022-09-25 05:39:02 WARNING Skipping Multi-Query Optimization (instead, only applying patches)
2022-09-25 05:39:02 INFO  Estimated unoptimised what-if runtime is 991209.5546722412ms
2022-09-25 05:39:02 INFO  ---RUNTIME: Multi-Query Optimization took 19.184350967407227 ms
2022-09-25 05:39:02 INFO  Executing generated plans
2022-09-25 05:55:47 INFO  ---RUNTIME: Execution took 1004873.6321926117 ms
2022-09-25 05:55:47 INFO  Done!
2022-09-25 05:55:47 INFO  # Finished -- repetition 6 of 7 
2022-09-25 05:55:47 INFO  # Optimization benchmark for data_corruption with args [['reviews', 'fast_loading', 'featurization_2', 'xgboost']] -- repetition 7 of 7
2022-09-25 05:55:47 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-25 05:55:47 INFO  Running instrumented original pipeline...
2022-09-25 05:55:47 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-25 05:55:47 INFO  ---RUNTIME: Importing and monkey-patching took 6.503582000732422 ms
2022-09-25 05:56:27 INFO  ---RUNTIME: Original pipeline execution took 39937.251806259155 ms (excluding imports and monkey-patching)
2022-09-25 05:56:27 INFO  Starting execution of 1 what-if analyses...
2022-09-25 05:56:27 INFO  Start plan generation for analysis DataCorruption...
2022-09-25 05:56:27 INFO  ---RUNTIME: Plan generation took 0.4334449768066406 ms
2022-09-25 05:56:27 INFO  Estimated runtime of original DAG is 39636.04712486267ms
2022-09-25 05:56:27 INFO  Performing Multi-Query Optimization
2022-09-25 05:56:27 INFO  Estimated unoptimized what-if runtime is 990901.1781215668ms
2022-09-25 05:56:27 INFO  Estimated optimised what-if runtime is 55920.24755477905ms
2022-09-25 05:56:27 INFO  Estimated optimisation runtime saving is 934980.9305667877ms
2022-09-25 05:56:27 INFO  ---RUNTIME: Multi-Query Optimization took 65.85359573364258 ms
2022-09-25 05:56:27 INFO  Executing generated plans
2022-09-25 05:57:27 INFO  ---RUNTIME: Execution took 60051.29337310791 ms
2022-09-25 05:57:27 INFO  Done!
2022-09-25 05:57:27 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-25 05:57:27 INFO  Running instrumented original pipeline...
2022-09-25 05:57:27 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-25 05:57:27 INFO  ---RUNTIME: Importing and monkey-patching took 6.125450134277344 ms
2022-09-25 05:58:07 INFO  ---RUNTIME: Original pipeline execution took 39969.135761260986 ms (excluding imports and monkey-patching)
2022-09-25 05:58:07 INFO  Starting execution of 1 what-if analyses...
2022-09-25 05:58:07 INFO  Start plan generation for analysis DataCorruption...
2022-09-25 05:58:07 INFO  ---RUNTIME: Plan generation took 0.42748451232910156 ms
2022-09-25 05:58:07 INFO  Estimated runtime of original DAG is 39667.184591293335ms
2022-09-25 05:58:07 WARNING Skipping Multi-Query Optimization (instead, only applying patches)
2022-09-25 05:58:07 INFO  Estimated unoptimised what-if runtime is 991679.6147823334ms
2022-09-25 05:58:07 INFO  ---RUNTIME: Multi-Query Optimization took 19.173145294189453 ms
2022-09-25 05:58:07 INFO  Executing generated plans
2022-09-25 06:14:58 INFO  ---RUNTIME: Execution took 1011295.548915863 ms
2022-09-25 06:14:58 INFO  Done!
2022-09-25 06:14:58 INFO  # Finished -- repetition 7 of 7 
2022-09-25 06:14:58 INFO  # Final results after all repetitions
2022-09-25 06:14:58 INFO     repetition  ... no_opt_what_if_execution_combined_model_training
0           0  ...                                    852121.390343
1           1  ...                                    849123.751640
2           2  ...                                    856993.906021
3           3  ...                                    866587.604046
4           4  ...                                    850126.276493
5           5  ...                                    847838.629484
6           6  ...                                    853319.336891

[7 rows x 26 columns]
PROTOCOL_BUFFERS_PYTHON_IMPLEMENTATION=python taskset -c 32-39 python3.9 benchmarks_end_to_end.py data_corruption reviews fast_loading featurization_2 neural_network
2022-09-25 06:15:00.941032: W tensorflow/stream_executor/platform/default/dso_loader.cc:64] Could not load dynamic library 'libcudart.so.11.0'; dlerror: libcudart.so.11.0: cannot open shared object file: No such file or directory; LD_LIBRARY_PATH: /home/sgrafbe/mlwhatif/venv/lib/python3.9/site-packages/cv2/../../lib64:
2022-09-25 06:15:00.941080: I tensorflow/stream_executor/cuda/cudart_stub.cc:29] Ignore above cudart dlerror if you do not have a GPU set up on your machine.
2022-09-25 06:15:02 INFO  Patching sys.argv with ['mlwhatif', 'reviews', 'fast_loading', 'featurization_2', 'neural_network']
2022-09-25 06:15:02 INFO  Running instrumented original pipeline...
2022-09-25 06:15:02 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-25 06:15:02 INFO  ---RUNTIME: Importing and monkey-patching took 121.13785743713379 ms
2022-09-25 06:15:06.863203: W tensorflow/stream_executor/platform/default/dso_loader.cc:64] Could not load dynamic library 'libcuda.so.1'; dlerror: libcuda.so.1: cannot open shared object file: No such file or directory; LD_LIBRARY_PATH: /home/sgrafbe/mlwhatif/venv/lib/python3.9/site-packages/cv2/../../lib64:
2022-09-25 06:15:06.863239: W tensorflow/stream_executor/cuda/cuda_driver.cc:326] failed call to cuInit: UNKNOWN ERROR (303)
2022-09-25 06:15:06.863261: I tensorflow/stream_executor/cuda/cuda_diagnostics.cc:156] kernel driver does not appear to be running on this host (angus): /proc/driver/nvidia/version does not exist
2022-09-25 06:15:06.863731: I tensorflow/core/platform/cpu_feature_guard.cc:142] This TensorFlow binary is optimized with oneAPI Deep Neural Network Library (oneDNN) to use the following CPU instructions in performance-critical operations:  AVX2 FMA
To enable them in other operations, rebuild TensorFlow with the appropriate compiler flags.
2022-09-25 06:15:07.472042: I tensorflow/compiler/mlir/mlir_graph_optimization_pass.cc:176] None of the MLIR Optimization Passes are enabled (registered 2)
2022-09-25 06:15:07.486179: I tensorflow/core/platform/profile_utils/cpu_utils.cc:114] CPU Frequency: 2595130000 Hz
2022-09-25 06:15:15 INFO  ---RUNTIME: Original pipeline execution took 13429.109811782837 ms (excluding imports and monkey-patching)
2022-09-25 06:15:15 INFO  Starting execution of 0 what-if analyses...
2022-09-25 06:15:15 INFO  Estimated runtime of original DAG is 13080.344676971436ms
2022-09-25 06:15:15 INFO  Performing Multi-Query Optimization
2022-09-25 06:15:15 INFO  Estimated unoptimized what-if runtime is 0ms
2022-09-25 06:15:15 INFO  Estimated optimised what-if runtime is 0ms
2022-09-25 06:15:15 INFO  Estimated optimisation runtime saving is 0ms
2022-09-25 06:15:15 INFO  ---RUNTIME: Multi-Query Optimization took 0.4966259002685547 ms
2022-09-25 06:15:15 INFO  Executing generated plans
2022-09-25 06:15:15 INFO  ---RUNTIME: Execution took 0.022649765014648438 ms
2022-09-25 06:15:15 INFO  Done!
2022-09-25 06:15:15 INFO  # Optimization benchmark for data_corruption with args [['reviews', 'fast_loading', 'featurization_2', 'neural_network']] -- repetition 1 of 7
2022-09-25 06:15:15 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-25 06:15:15 INFO  Running instrumented original pipeline...
2022-09-25 06:15:15 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-25 06:15:15 INFO  ---RUNTIME: Importing and monkey-patching took 5.454778671264648 ms
2022-09-25 06:15:28 INFO  ---RUNTIME: Original pipeline execution took 12244.983673095703 ms (excluding imports and monkey-patching)
2022-09-25 06:15:28 INFO  Starting execution of 1 what-if analyses...
2022-09-25 06:15:28 INFO  Start plan generation for analysis DataCorruption...
2022-09-25 06:15:28 INFO  ---RUNTIME: Plan generation took 0.46706199645996094 ms
2022-09-25 06:15:28 INFO  Estimated runtime of original DAG is 11941.140413284302ms
2022-09-25 06:15:28 INFO  Performing Multi-Query Optimization
2022-09-25 06:15:28 INFO  Estimated unoptimized what-if runtime is 298528.51033210754ms
2022-09-25 06:15:28 INFO  Estimated optimised what-if runtime is 37551.03063583374ms
2022-09-25 06:15:28 INFO  Estimated optimisation runtime saving is 260977.4796962738ms
2022-09-25 06:15:28 INFO  ---RUNTIME: Multi-Query Optimization took 67.01898574829102 ms
2022-09-25 06:15:28 INFO  Executing generated plans
2022-09-25 06:16:13 INFO  ---RUNTIME: Execution took 45461.336851119995 ms
2022-09-25 06:16:13 INFO  Done!
2022-09-25 06:16:13 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-25 06:16:13 INFO  Running instrumented original pipeline...
2022-09-25 06:16:13 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-25 06:16:13 INFO  ---RUNTIME: Importing and monkey-patching took 6.530523300170898 ms
2022-09-25 06:16:27 INFO  ---RUNTIME: Original pipeline execution took 13669.384002685547 ms (excluding imports and monkey-patching)
2022-09-25 06:16:27 INFO  Starting execution of 1 what-if analyses...
2022-09-25 06:16:27 INFO  Start plan generation for analysis DataCorruption...
2022-09-25 06:16:27 INFO  ---RUNTIME: Plan generation took 0.4837512969970703 ms
2022-09-25 06:16:27 INFO  Estimated runtime of original DAG is 13342.721223831177ms
2022-09-25 06:16:27 WARNING Skipping Multi-Query Optimization (instead, only applying patches)
2022-09-25 06:16:27 INFO  Estimated unoptimised what-if runtime is 333568.0305957794ms
2022-09-25 06:16:27 INFO  ---RUNTIME: Multi-Query Optimization took 21.944522857666016 ms
2022-09-25 06:16:27 INFO  Executing generated plans
2022-09-25 06:22:02 INFO  ---RUNTIME: Execution took 334876.37734413147 ms
2022-09-25 06:22:02 INFO  Done!
2022-09-25 06:22:02 INFO  # Finished -- repetition 1 of 7 
2022-09-25 06:22:02 INFO  # Optimization benchmark for data_corruption with args [['reviews', 'fast_loading', 'featurization_2', 'neural_network']] -- repetition 2 of 7
2022-09-25 06:22:02 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-25 06:22:02 INFO  Running instrumented original pipeline...
2022-09-25 06:22:02 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-25 06:22:02 INFO  ---RUNTIME: Importing and monkey-patching took 6.422996520996094 ms
2022-09-25 06:22:15 INFO  ---RUNTIME: Original pipeline execution took 12929.753541946411 ms (excluding imports and monkey-patching)
2022-09-25 06:22:15 INFO  Starting execution of 1 what-if analyses...
2022-09-25 06:22:15 INFO  Start plan generation for analysis DataCorruption...
2022-09-25 06:22:15 INFO  ---RUNTIME: Plan generation took 1.2352466583251953 ms
2022-09-25 06:22:15 INFO  Estimated runtime of original DAG is 12599.710941314697ms
2022-09-25 06:22:15 INFO  Performing Multi-Query Optimization
2022-09-25 06:22:15 INFO  Estimated unoptimized what-if runtime is 314992.77353286743ms
2022-09-25 06:22:15 INFO  Estimated optimised what-if runtime is 41329.689502716064ms
2022-09-25 06:22:15 INFO  Estimated optimisation runtime saving is 273663.08403015137ms
2022-09-25 06:22:15 INFO  ---RUNTIME: Multi-Query Optimization took 408.3056449890137 ms
2022-09-25 06:22:15 INFO  Executing generated plans
2022-09-25 06:22:58 INFO  ---RUNTIME: Execution took 43076.038122177124 ms
2022-09-25 06:22:58 INFO  Done!
2022-09-25 06:22:58 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-25 06:22:58 INFO  Running instrumented original pipeline...
2022-09-25 06:22:58 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-25 06:22:58 INFO  ---RUNTIME: Importing and monkey-patching took 6.341457366943359 ms
2022-09-25 06:23:11 INFO  ---RUNTIME: Original pipeline execution took 12850.698471069336 ms (excluding imports and monkey-patching)
2022-09-25 06:23:11 INFO  Starting execution of 1 what-if analyses...
2022-09-25 06:23:11 INFO  Start plan generation for analysis DataCorruption...
2022-09-25 06:23:11 INFO  ---RUNTIME: Plan generation took 0.42891502380371094 ms
2022-09-25 06:23:11 INFO  Estimated runtime of original DAG is 12534.53016281128ms
2022-09-25 06:23:11 WARNING Skipping Multi-Query Optimization (instead, only applying patches)
2022-09-25 06:23:11 INFO  Estimated unoptimised what-if runtime is 313363.254070282ms
2022-09-25 06:23:11 INFO  ---RUNTIME: Multi-Query Optimization took 20.4775333404541 ms
2022-09-25 06:23:11 INFO  Executing generated plans
2022-09-25 06:28:46 INFO  ---RUNTIME: Execution took 335099.79128837585 ms
2022-09-25 06:28:46 INFO  Done!
2022-09-25 06:28:46 INFO  # Finished -- repetition 2 of 7 
2022-09-25 06:28:46 INFO  # Optimization benchmark for data_corruption with args [['reviews', 'fast_loading', 'featurization_2', 'neural_network']] -- repetition 3 of 7
2022-09-25 06:28:46 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-25 06:28:46 INFO  Running instrumented original pipeline...
2022-09-25 06:28:46 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-25 06:28:46 INFO  ---RUNTIME: Importing and monkey-patching took 6.211042404174805 ms
2022-09-25 06:28:59 INFO  ---RUNTIME: Original pipeline execution took 12849.396467208862 ms (excluding imports and monkey-patching)
2022-09-25 06:28:59 INFO  Starting execution of 1 what-if analyses...
2022-09-25 06:28:59 INFO  Start plan generation for analysis DataCorruption...
2022-09-25 06:28:59 INFO  ---RUNTIME: Plan generation took 0.5052089691162109 ms
2022-09-25 06:28:59 INFO  Estimated runtime of original DAG is 12531.667947769165ms
2022-09-25 06:28:59 INFO  Performing Multi-Query Optimization
2022-09-25 06:28:59 INFO  Estimated unoptimized what-if runtime is 313291.6986942291ms
2022-09-25 06:28:59 INFO  Estimated optimised what-if runtime is 41747.75815010071ms
2022-09-25 06:28:59 INFO  Estimated optimisation runtime saving is 271543.9405441284ms
2022-09-25 06:28:59 INFO  ---RUNTIME: Multi-Query Optimization took 74.36656951904297 ms
2022-09-25 06:28:59 INFO  Executing generated plans
2022-09-25 06:29:42 INFO  ---RUNTIME: Execution took 43419.37160491943 ms
2022-09-25 06:29:42 INFO  Done!
2022-09-25 06:29:42 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-25 06:29:42 INFO  Running instrumented original pipeline...
2022-09-25 06:29:42 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-25 06:29:42 INFO  ---RUNTIME: Importing and monkey-patching took 6.083488464355469 ms
2022-09-25 06:29:56 INFO  ---RUNTIME: Original pipeline execution took 13106.215000152588 ms (excluding imports and monkey-patching)
2022-09-25 06:29:56 INFO  Starting execution of 1 what-if analyses...
2022-09-25 06:29:56 INFO  Start plan generation for analysis DataCorruption...
2022-09-25 06:29:56 INFO  ---RUNTIME: Plan generation took 1.5501976013183594 ms
2022-09-25 06:29:56 INFO  Estimated runtime of original DAG is 12786.436319351196ms
2022-09-25 06:29:56 WARNING Skipping Multi-Query Optimization (instead, only applying patches)
2022-09-25 06:29:56 INFO  Estimated unoptimised what-if runtime is 319660.9079837799ms
2022-09-25 06:29:56 INFO  ---RUNTIME: Multi-Query Optimization took 22.24588394165039 ms
2022-09-25 06:29:56 INFO  Executing generated plans
2022-09-25 06:35:32 INFO  ---RUNTIME: Execution took 336683.19725990295 ms
2022-09-25 06:35:32 INFO  Done!
2022-09-25 06:35:32 INFO  # Finished -- repetition 3 of 7 
2022-09-25 06:35:32 INFO  # Optimization benchmark for data_corruption with args [['reviews', 'fast_loading', 'featurization_2', 'neural_network']] -- repetition 4 of 7
2022-09-25 06:35:32 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-25 06:35:32 INFO  Running instrumented original pipeline...
2022-09-25 06:35:32 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-25 06:35:32 INFO  ---RUNTIME: Importing and monkey-patching took 6.325960159301758 ms
2022-09-25 06:35:46 INFO  ---RUNTIME: Original pipeline execution took 13758.194923400879 ms (excluding imports and monkey-patching)
2022-09-25 06:35:46 INFO  Starting execution of 1 what-if analyses...
2022-09-25 06:35:46 INFO  Start plan generation for analysis DataCorruption...
2022-09-25 06:35:46 INFO  ---RUNTIME: Plan generation took 0.46133995056152344 ms
2022-09-25 06:35:46 INFO  Estimated runtime of original DAG is 13419.800281524658ms
2022-09-25 06:35:46 INFO  Performing Multi-Query Optimization
2022-09-25 06:35:46 INFO  Estimated unoptimized what-if runtime is 335495.00703811646ms
2022-09-25 06:35:46 INFO  Estimated optimised what-if runtime is 43529.00791168213ms
2022-09-25 06:35:46 INFO  Estimated optimisation runtime saving is 291965.9991264343ms
2022-09-25 06:35:46 INFO  ---RUNTIME: Multi-Query Optimization took 72.85380363464355 ms
2022-09-25 06:35:46 INFO  Executing generated plans
2022-09-25 06:36:31 INFO  ---RUNTIME: Execution took 45358.930587768555 ms
2022-09-25 06:36:31 INFO  Done!
2022-09-25 06:36:32 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-25 06:36:32 INFO  Running instrumented original pipeline...
2022-09-25 06:36:32 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-25 06:36:32 INFO  ---RUNTIME: Importing and monkey-patching took 6.083011627197266 ms
2022-09-25 06:36:44 INFO  ---RUNTIME: Original pipeline execution took 12528.371572494507 ms (excluding imports and monkey-patching)
2022-09-25 06:36:44 INFO  Starting execution of 1 what-if analyses...
2022-09-25 06:36:44 INFO  Start plan generation for analysis DataCorruption...
2022-09-25 06:36:44 INFO  ---RUNTIME: Plan generation took 0.5719661712646484 ms
2022-09-25 06:36:44 INFO  Estimated runtime of original DAG is 12196.439266204834ms
2022-09-25 06:36:44 WARNING Skipping Multi-Query Optimization (instead, only applying patches)
2022-09-25 06:36:44 INFO  Estimated unoptimised what-if runtime is 304910.98165512085ms
2022-09-25 06:36:44 INFO  ---RUNTIME: Multi-Query Optimization took 21.564722061157227 ms
2022-09-25 06:36:44 INFO  Executing generated plans
2022-09-25 06:42:16 INFO  ---RUNTIME: Execution took 332341.8390750885 ms
2022-09-25 06:42:16 INFO  Done!
2022-09-25 06:42:16 INFO  # Finished -- repetition 4 of 7 
2022-09-25 06:42:16 INFO  # Optimization benchmark for data_corruption with args [['reviews', 'fast_loading', 'featurization_2', 'neural_network']] -- repetition 5 of 7
2022-09-25 06:42:16 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-25 06:42:16 INFO  Running instrumented original pipeline...
2022-09-25 06:42:16 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-25 06:42:16 INFO  ---RUNTIME: Importing and monkey-patching took 6.39796257019043 ms
2022-09-25 06:42:29 INFO  ---RUNTIME: Original pipeline execution took 12713.298559188843 ms (excluding imports and monkey-patching)
2022-09-25 06:42:29 INFO  Starting execution of 1 what-if analyses...
2022-09-25 06:42:29 INFO  Start plan generation for analysis DataCorruption...
2022-09-25 06:42:29 INFO  ---RUNTIME: Plan generation took 1.3549327850341797 ms
2022-09-25 06:42:29 INFO  Estimated runtime of original DAG is 12398.973941802979ms
2022-09-25 06:42:29 INFO  Performing Multi-Query Optimization
2022-09-25 06:42:29 INFO  Estimated unoptimized what-if runtime is 309974.34854507446ms
2022-09-25 06:42:29 INFO  Estimated optimised what-if runtime is 37713.502407073975ms
2022-09-25 06:42:29 INFO  Estimated optimisation runtime saving is 272260.8461380005ms
2022-09-25 06:42:29 INFO  ---RUNTIME: Multi-Query Optimization took 66.21909141540527 ms
2022-09-25 06:42:29 INFO  Executing generated plans
2022-09-25 06:43:13 INFO  ---RUNTIME: Execution took 43628.06439399719 ms
2022-09-25 06:43:13 INFO  Done!
2022-09-25 06:43:13 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-25 06:43:13 INFO  Running instrumented original pipeline...
2022-09-25 06:43:13 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-25 06:43:13 INFO  ---RUNTIME: Importing and monkey-patching took 7.561683654785156 ms
2022-09-25 06:43:26 INFO  ---RUNTIME: Original pipeline execution took 13043.49160194397 ms (excluding imports and monkey-patching)
2022-09-25 06:43:26 INFO  Starting execution of 1 what-if analyses...
2022-09-25 06:43:26 INFO  Start plan generation for analysis DataCorruption...
2022-09-25 06:43:26 INFO  ---RUNTIME: Plan generation took 0.4553794860839844 ms
2022-09-25 06:43:26 INFO  Estimated runtime of original DAG is 12716.082334518433ms
2022-09-25 06:43:26 WARNING Skipping Multi-Query Optimization (instead, only applying patches)
2022-09-25 06:43:26 INFO  Estimated unoptimised what-if runtime is 317902.0583629608ms
2022-09-25 06:43:26 INFO  ---RUNTIME: Multi-Query Optimization took 20.461559295654297 ms
2022-09-25 06:43:26 INFO  Executing generated plans
2022-09-25 06:48:42 INFO  ---RUNTIME: Execution took 315612.4629974365 ms
2022-09-25 06:48:42 INFO  Done!
2022-09-25 06:48:42 INFO  # Finished -- repetition 5 of 7 
2022-09-25 06:48:42 INFO  # Optimization benchmark for data_corruption with args [['reviews', 'fast_loading', 'featurization_2', 'neural_network']] -- repetition 6 of 7
2022-09-25 06:48:42 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-25 06:48:42 INFO  Running instrumented original pipeline...
2022-09-25 06:48:42 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-25 06:48:42 INFO  ---RUNTIME: Importing and monkey-patching took 6.169319152832031 ms
2022-09-25 06:48:54 INFO  ---RUNTIME: Original pipeline execution took 12633.131265640259 ms (excluding imports and monkey-patching)
2022-09-25 06:48:54 INFO  Starting execution of 1 what-if analyses...
2022-09-25 06:48:54 INFO  Start plan generation for analysis DataCorruption...
2022-09-25 06:48:54 INFO  ---RUNTIME: Plan generation took 0.423431396484375 ms
2022-09-25 06:48:54 INFO  Estimated runtime of original DAG is 12323.030233383179ms
2022-09-25 06:48:54 INFO  Performing Multi-Query Optimization
2022-09-25 06:48:54 INFO  Estimated unoptimized what-if runtime is 308075.75583457947ms
2022-09-25 06:48:54 INFO  Estimated optimised what-if runtime is 37650.10738372803ms
2022-09-25 06:48:54 INFO  Estimated optimisation runtime saving is 270425.64845085144ms
2022-09-25 06:48:54 INFO  ---RUNTIME: Multi-Query Optimization took 66.35332107543945 ms
2022-09-25 06:48:54 INFO  Executing generated plans
2022-09-25 06:49:35 INFO  ---RUNTIME: Execution took 40974.22218322754 ms
2022-09-25 06:49:35 INFO  Done!
2022-09-25 06:49:35 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-25 06:49:35 INFO  Running instrumented original pipeline...
2022-09-25 06:49:35 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-25 06:49:35 INFO  ---RUNTIME: Importing and monkey-patching took 5.867481231689453 ms
2022-09-25 06:49:48 INFO  ---RUNTIME: Original pipeline execution took 12202.230453491211 ms (excluding imports and monkey-patching)
2022-09-25 06:49:48 INFO  Starting execution of 1 what-if analyses...
2022-09-25 06:49:48 INFO  Start plan generation for analysis DataCorruption...
2022-09-25 06:49:48 INFO  ---RUNTIME: Plan generation took 0.4611015319824219 ms
2022-09-25 06:49:48 INFO  Estimated runtime of original DAG is 11887.440919876099ms
2022-09-25 06:49:48 WARNING Skipping Multi-Query Optimization (instead, only applying patches)
2022-09-25 06:49:48 INFO  Estimated unoptimised what-if runtime is 297186.02299690247ms
2022-09-25 06:49:48 INFO  ---RUNTIME: Multi-Query Optimization took 20.5538272857666 ms
2022-09-25 06:49:48 INFO  Executing generated plans
2022-09-25 06:55:01 INFO  ---RUNTIME: Execution took 313835.6568813324 ms
2022-09-25 06:55:01 INFO  Done!
2022-09-25 06:55:01 INFO  # Finished -- repetition 6 of 7 
2022-09-25 06:55:01 INFO  # Optimization benchmark for data_corruption with args [['reviews', 'fast_loading', 'featurization_2', 'neural_network']] -- repetition 7 of 7
2022-09-25 06:55:01 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-25 06:55:01 INFO  Running instrumented original pipeline...
2022-09-25 06:55:01 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-25 06:55:01 INFO  ---RUNTIME: Importing and monkey-patching took 5.825996398925781 ms
2022-09-25 06:55:14 INFO  ---RUNTIME: Original pipeline execution took 12142.08436012268 ms (excluding imports and monkey-patching)
2022-09-25 06:55:14 INFO  Starting execution of 1 what-if analyses...
2022-09-25 06:55:14 INFO  Start plan generation for analysis DataCorruption...
2022-09-25 06:55:14 INFO  ---RUNTIME: Plan generation took 0.41604042053222656 ms
2022-09-25 06:55:14 INFO  Estimated runtime of original DAG is 11824.01704788208ms
2022-09-25 06:55:14 INFO  Performing Multi-Query Optimization
2022-09-25 06:55:14 INFO  Estimated unoptimized what-if runtime is 295600.426197052ms
2022-09-25 06:55:14 INFO  Estimated optimised what-if runtime is 37122.570514678955ms
2022-09-25 06:55:14 INFO  Estimated optimisation runtime saving is 258477.85568237305ms
2022-09-25 06:55:14 INFO  ---RUNTIME: Multi-Query Optimization took 66.48921966552734 ms
2022-09-25 06:55:14 INFO  Executing generated plans
2022-09-25 06:55:55 INFO  ---RUNTIME: Execution took 41656.166553497314 ms
2022-09-25 06:55:55 INFO  Done!
2022-09-25 06:55:55 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-25 06:55:55 INFO  Running instrumented original pipeline...
2022-09-25 06:55:55 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-25 06:55:55 INFO  ---RUNTIME: Importing and monkey-patching took 6.165981292724609 ms
2022-09-25 06:56:07 INFO  ---RUNTIME: Original pipeline execution took 12214.446067810059 ms (excluding imports and monkey-patching)
2022-09-25 06:56:07 INFO  Starting execution of 1 what-if analyses...
2022-09-25 06:56:07 INFO  Start plan generation for analysis DataCorruption...
2022-09-25 06:56:07 INFO  ---RUNTIME: Plan generation took 0.41222572326660156 ms
2022-09-25 06:56:07 INFO  Estimated runtime of original DAG is 11902.842044830322ms
2022-09-25 06:56:07 WARNING Skipping Multi-Query Optimization (instead, only applying patches)
2022-09-25 06:56:08 INFO  Estimated unoptimised what-if runtime is 297571.05112075806ms
2022-09-25 06:56:08 INFO  ---RUNTIME: Multi-Query Optimization took 20.45273780822754 ms
2022-09-25 06:56:08 INFO  Executing generated plans
2022-09-25 07:01:20 INFO  ---RUNTIME: Execution took 312386.81077957153 ms
2022-09-25 07:01:20 INFO  Done!
2022-09-25 07:01:20 INFO  # Finished -- repetition 7 of 7 
2022-09-25 07:01:20 INFO  # Final results after all repetitions
2022-09-25 07:01:20 INFO     repetition  ... no_opt_what_if_execution_combined_model_training
0           0  ...                                    159828.832388
1           1  ...                                    160648.481607
2           2  ...                                    160577.158689
3           3  ...                                    157901.107550
4           4  ...                                    147302.366734
5           5  ...                                    145841.664553
6           6  ...                                    145134.398460

[7 rows x 26 columns]
PROTOCOL_BUFFERS_PYTHON_IMPLEMENTATION=python taskset -c 32-39 python3.9 benchmarks_end_to_end.py data_corruption reviews fast_loading featurization_3 logistic_regression
2022-09-25 07:01:22.976746: W tensorflow/stream_executor/platform/default/dso_loader.cc:64] Could not load dynamic library 'libcudart.so.11.0'; dlerror: libcudart.so.11.0: cannot open shared object file: No such file or directory; LD_LIBRARY_PATH: /home/sgrafbe/mlwhatif/venv/lib/python3.9/site-packages/cv2/../../lib64:
2022-09-25 07:01:22.976792: I tensorflow/stream_executor/cuda/cudart_stub.cc:29] Ignore above cudart dlerror if you do not have a GPU set up on your machine.
2022-09-25 07:01:24 INFO  Patching sys.argv with ['mlwhatif', 'reviews', 'fast_loading', 'featurization_3', 'logistic_regression']
2022-09-25 07:01:24 INFO  Running instrumented original pipeline...
2022-09-25 07:01:24 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-25 07:01:24 INFO  ---RUNTIME: Importing and monkey-patching took 122.18141555786133 ms
2022-09-25 07:01:33 INFO  ---RUNTIME: Original pipeline execution took 9591.69602394104 ms (excluding imports and monkey-patching)
2022-09-25 07:01:33 INFO  Starting execution of 0 what-if analyses...
2022-09-25 07:01:33 INFO  Estimated runtime of original DAG is 9211.790561676025ms
2022-09-25 07:01:33 INFO  Performing Multi-Query Optimization
2022-09-25 07:01:33 INFO  Estimated unoptimized what-if runtime is 0ms
2022-09-25 07:01:33 INFO  Estimated optimised what-if runtime is 0ms
2022-09-25 07:01:33 INFO  Estimated optimisation runtime saving is 0ms
2022-09-25 07:01:33 INFO  ---RUNTIME: Multi-Query Optimization took 0.5667209625244141 ms
2022-09-25 07:01:33 INFO  Executing generated plans
2022-09-25 07:01:33 INFO  ---RUNTIME: Execution took 0.028848648071289062 ms
2022-09-25 07:01:33 INFO  Done!
2022-09-25 07:01:33 INFO  # Optimization benchmark for data_corruption with args [['reviews', 'fast_loading', 'featurization_3', 'logistic_regression']] -- repetition 1 of 7
2022-09-25 07:01:33 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-25 07:01:33 INFO  Running instrumented original pipeline...
2022-09-25 07:01:34 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-25 07:01:34 INFO  ---RUNTIME: Importing and monkey-patching took 5.7220458984375 ms
2022-09-25 07:01:43 INFO  ---RUNTIME: Original pipeline execution took 9663.200378417969 ms (excluding imports and monkey-patching)
2022-09-25 07:01:43 INFO  Starting execution of 1 what-if analyses...
2022-09-25 07:01:43 INFO  Start plan generation for analysis DataCorruption...
2022-09-25 07:01:43 INFO  ---RUNTIME: Plan generation took 4.927396774291992 ms
2022-09-25 07:01:43 INFO  Estimated runtime of original DAG is 9131.063222885132ms
2022-09-25 07:01:43 INFO  Performing Multi-Query Optimization
2022-09-25 07:01:43 INFO  Estimated unoptimized what-if runtime is 228276.5805721283ms
2022-09-25 07:01:43 INFO  Estimated optimised what-if runtime is 26587.519884109497ms
2022-09-25 07:01:43 INFO  Estimated optimisation runtime saving is 201689.0606880188ms
2022-09-25 07:01:43 INFO  ---RUNTIME: Multi-Query Optimization took 76.59459114074707 ms
2022-09-25 07:01:43 INFO  Executing generated plans
2022-09-25 07:02:16 INFO  ---RUNTIME: Execution took 32480.701684951782 ms
2022-09-25 07:02:16 INFO  Done!
2022-09-25 07:02:16 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-25 07:02:16 INFO  Running instrumented original pipeline...
2022-09-25 07:02:16 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-25 07:02:16 INFO  ---RUNTIME: Importing and monkey-patching took 6.094694137573242 ms
2022-09-25 07:02:25 INFO  ---RUNTIME: Original pipeline execution took 9436.761856079102 ms (excluding imports and monkey-patching)
2022-09-25 07:02:25 INFO  Starting execution of 1 what-if analyses...
2022-09-25 07:02:25 INFO  Start plan generation for analysis DataCorruption...
2022-09-25 07:02:25 INFO  ---RUNTIME: Plan generation took 1.256704330444336 ms
2022-09-25 07:02:25 INFO  Estimated runtime of original DAG is 9099.547386169434ms
2022-09-25 07:02:25 WARNING Skipping Multi-Query Optimization (instead, only applying patches)
2022-09-25 07:02:25 INFO  Estimated unoptimised what-if runtime is 227488.68465423584ms
2022-09-25 07:02:25 INFO  ---RUNTIME: Multi-Query Optimization took 27.702808380126953 ms
2022-09-25 07:02:25 INFO  Executing generated plans
2022-09-25 07:06:28 INFO  ---RUNTIME: Execution took 242533.89358520508 ms
2022-09-25 07:06:28 INFO  Done!
2022-09-25 07:06:28 INFO  # Finished -- repetition 1 of 7 
2022-09-25 07:06:28 INFO  # Optimization benchmark for data_corruption with args [['reviews', 'fast_loading', 'featurization_3', 'logistic_regression']] -- repetition 2 of 7
2022-09-25 07:06:28 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-25 07:06:28 INFO  Running instrumented original pipeline...
2022-09-25 07:06:28 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-25 07:06:28 INFO  ---RUNTIME: Importing and monkey-patching took 5.921602249145508 ms
2022-09-25 07:06:37 INFO  ---RUNTIME: Original pipeline execution took 9430.460929870605 ms (excluding imports and monkey-patching)
2022-09-25 07:06:37 INFO  Starting execution of 1 what-if analyses...
2022-09-25 07:06:37 INFO  Start plan generation for analysis DataCorruption...
2022-09-25 07:06:37 INFO  ---RUNTIME: Plan generation took 0.4246234893798828 ms
2022-09-25 07:06:37 INFO  Estimated runtime of original DAG is 9090.201139450073ms
2022-09-25 07:06:37 INFO  Performing Multi-Query Optimization
2022-09-25 07:06:37 INFO  Estimated unoptimized what-if runtime is 227255.02848625183ms
2022-09-25 07:06:37 INFO  Estimated optimised what-if runtime is 26516.831159591675ms
2022-09-25 07:06:37 INFO  Estimated optimisation runtime saving is 200738.19732666016ms
2022-09-25 07:06:37 INFO  ---RUNTIME: Multi-Query Optimization took 82.04030990600586 ms
2022-09-25 07:06:37 INFO  Executing generated plans
2022-09-25 07:07:10 INFO  ---RUNTIME: Execution took 32486.512660980225 ms
2022-09-25 07:07:10 INFO  Done!
2022-09-25 07:07:10 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-25 07:07:10 INFO  Running instrumented original pipeline...
2022-09-25 07:07:10 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-25 07:07:10 INFO  ---RUNTIME: Importing and monkey-patching took 6.211042404174805 ms
2022-09-25 07:07:19 INFO  ---RUNTIME: Original pipeline execution took 9482.058763504028 ms (excluding imports and monkey-patching)
2022-09-25 07:07:19 INFO  Starting execution of 1 what-if analyses...
2022-09-25 07:07:19 INFO  Start plan generation for analysis DataCorruption...
2022-09-25 07:07:19 INFO  ---RUNTIME: Plan generation took 0.4334449768066406 ms
2022-09-25 07:07:19 INFO  Estimated runtime of original DAG is 9144.092559814453ms
2022-09-25 07:07:19 WARNING Skipping Multi-Query Optimization (instead, only applying patches)
2022-09-25 07:07:19 INFO  Estimated unoptimised what-if runtime is 228602.31399536133ms
2022-09-25 07:07:19 INFO  ---RUNTIME: Multi-Query Optimization took 27.40955352783203 ms
2022-09-25 07:07:19 INFO  Executing generated plans
2022-09-25 07:11:22 INFO  ---RUNTIME: Execution took 242719.9821472168 ms
2022-09-25 07:11:22 INFO  Done!
2022-09-25 07:11:22 INFO  # Finished -- repetition 2 of 7 
2022-09-25 07:11:22 INFO  # Optimization benchmark for data_corruption with args [['reviews', 'fast_loading', 'featurization_3', 'logistic_regression']] -- repetition 3 of 7
2022-09-25 07:11:22 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-25 07:11:22 INFO  Running instrumented original pipeline...
2022-09-25 07:11:22 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-25 07:11:22 INFO  ---RUNTIME: Importing and monkey-patching took 6.159543991088867 ms
2022-09-25 07:11:32 INFO  ---RUNTIME: Original pipeline execution took 9732.99765586853 ms (excluding imports and monkey-patching)
2022-09-25 07:11:32 INFO  Starting execution of 1 what-if analyses...
2022-09-25 07:11:32 INFO  Start plan generation for analysis DataCorruption...
2022-09-25 07:11:32 INFO  ---RUNTIME: Plan generation took 5.062103271484375 ms
2022-09-25 07:11:32 INFO  Estimated runtime of original DAG is 9403.860092163086ms
2022-09-25 07:11:32 INFO  Performing Multi-Query Optimization
2022-09-25 07:11:32 INFO  Estimated unoptimized what-if runtime is 235096.50230407715ms
2022-09-25 07:11:32 INFO  Estimated optimised what-if runtime is 26842.44203567505ms
2022-09-25 07:11:32 INFO  Estimated optimisation runtime saving is 208254.0602684021ms
2022-09-25 07:11:32 INFO  ---RUNTIME: Multi-Query Optimization took 82.06033706665039 ms
2022-09-25 07:11:32 INFO  Executing generated plans
2022-09-25 07:12:04 INFO  ---RUNTIME: Execution took 32545.91393470764 ms
2022-09-25 07:12:04 INFO  Done!
2022-09-25 07:12:05 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-25 07:12:05 INFO  Running instrumented original pipeline...
2022-09-25 07:12:05 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-25 07:12:05 INFO  ---RUNTIME: Importing and monkey-patching took 5.606174468994141 ms
2022-09-25 07:12:14 INFO  ---RUNTIME: Original pipeline execution took 9459.572792053223 ms (excluding imports and monkey-patching)
2022-09-25 07:12:14 INFO  Starting execution of 1 what-if analyses...
2022-09-25 07:12:14 INFO  Start plan generation for analysis DataCorruption...
2022-09-25 07:12:14 INFO  ---RUNTIME: Plan generation took 0.4565715789794922 ms
2022-09-25 07:12:14 INFO  Estimated runtime of original DAG is 9126.261949539185ms
2022-09-25 07:12:14 WARNING Skipping Multi-Query Optimization (instead, only applying patches)
2022-09-25 07:12:14 INFO  Estimated unoptimised what-if runtime is 228156.5487384796ms
2022-09-25 07:12:14 INFO  ---RUNTIME: Multi-Query Optimization took 30.990123748779297 ms
2022-09-25 07:12:14 INFO  Executing generated plans
2022-09-25 07:16:17 INFO  ---RUNTIME: Execution took 242885.93673706055 ms
2022-09-25 07:16:17 INFO  Done!
2022-09-25 07:16:17 INFO  # Finished -- repetition 3 of 7 
2022-09-25 07:16:17 INFO  # Optimization benchmark for data_corruption with args [['reviews', 'fast_loading', 'featurization_3', 'logistic_regression']] -- repetition 4 of 7
2022-09-25 07:16:17 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-25 07:16:17 INFO  Running instrumented original pipeline...
2022-09-25 07:16:17 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-25 07:16:17 INFO  ---RUNTIME: Importing and monkey-patching took 6.097316741943359 ms
2022-09-25 07:16:26 INFO  ---RUNTIME: Original pipeline execution took 9474.046230316162 ms (excluding imports and monkey-patching)
2022-09-25 07:16:26 INFO  Starting execution of 1 what-if analyses...
2022-09-25 07:16:26 INFO  Start plan generation for analysis DataCorruption...
2022-09-25 07:16:26 INFO  ---RUNTIME: Plan generation took 0.47779083251953125 ms
2022-09-25 07:16:26 INFO  Estimated runtime of original DAG is 9139.183521270752ms
2022-09-25 07:16:26 INFO  Performing Multi-Query Optimization
2022-09-25 07:16:27 INFO  Estimated unoptimized what-if runtime is 228479.5880317688ms
2022-09-25 07:16:27 INFO  Estimated optimised what-if runtime is 26594.603061676025ms
2022-09-25 07:16:27 INFO  Estimated optimisation runtime saving is 201884.98497009277ms
2022-09-25 07:16:27 INFO  ---RUNTIME: Multi-Query Optimization took 81.77375793457031 ms
2022-09-25 07:16:27 INFO  Executing generated plans
2022-09-25 07:16:59 INFO  ---RUNTIME: Execution took 32415.401220321655 ms
2022-09-25 07:16:59 INFO  Done!
2022-09-25 07:16:59 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-25 07:16:59 INFO  Running instrumented original pipeline...
2022-09-25 07:16:59 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-25 07:16:59 INFO  ---RUNTIME: Importing and monkey-patching took 6.150245666503906 ms
2022-09-25 07:17:08 INFO  ---RUNTIME: Original pipeline execution took 9444.836139678955 ms (excluding imports and monkey-patching)
2022-09-25 07:17:08 INFO  Starting execution of 1 what-if analyses...
2022-09-25 07:17:08 INFO  Start plan generation for analysis DataCorruption...
2022-09-25 07:17:08 INFO  ---RUNTIME: Plan generation took 0.4220008850097656 ms
2022-09-25 07:17:08 INFO  Estimated runtime of original DAG is 9112.337589263916ms
2022-09-25 07:17:08 WARNING Skipping Multi-Query Optimization (instead, only applying patches)
2022-09-25 07:17:08 INFO  Estimated unoptimised what-if runtime is 227808.4397315979ms
2022-09-25 07:17:08 INFO  ---RUNTIME: Multi-Query Optimization took 28.86795997619629 ms
2022-09-25 07:17:08 INFO  Executing generated plans
2022-09-25 07:21:11 INFO  ---RUNTIME: Execution took 242827.66890525818 ms
2022-09-25 07:21:11 INFO  Done!
2022-09-25 07:21:11 INFO  # Finished -- repetition 4 of 7 
2022-09-25 07:21:11 INFO  # Optimization benchmark for data_corruption with args [['reviews', 'fast_loading', 'featurization_3', 'logistic_regression']] -- repetition 5 of 7
2022-09-25 07:21:11 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-25 07:21:11 INFO  Running instrumented original pipeline...
2022-09-25 07:21:11 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-25 07:21:11 INFO  ---RUNTIME: Importing and monkey-patching took 6.225347518920898 ms
2022-09-25 07:21:21 INFO  ---RUNTIME: Original pipeline execution took 9434.114217758179 ms (excluding imports and monkey-patching)
2022-09-25 07:21:21 INFO  Starting execution of 1 what-if analyses...
2022-09-25 07:21:21 INFO  Start plan generation for analysis DataCorruption...
2022-09-25 07:21:21 INFO  ---RUNTIME: Plan generation took 0.4291534423828125 ms
2022-09-25 07:21:21 INFO  Estimated runtime of original DAG is 9097.585201263428ms
2022-09-25 07:21:21 INFO  Performing Multi-Query Optimization
2022-09-25 07:21:21 INFO  Estimated unoptimized what-if runtime is 227439.6300315857ms
2022-09-25 07:21:21 INFO  Estimated optimised what-if runtime is 26513.150215148926ms
2022-09-25 07:21:21 INFO  Estimated optimisation runtime saving is 200926.47981643677ms
2022-09-25 07:21:21 INFO  ---RUNTIME: Multi-Query Optimization took 81.17389678955078 ms
2022-09-25 07:21:21 INFO  Executing generated plans
2022-09-25 07:21:53 INFO  ---RUNTIME: Execution took 32509.288549423218 ms
2022-09-25 07:21:53 INFO  Done!
2022-09-25 07:21:53 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-25 07:21:53 INFO  Running instrumented original pipeline...
2022-09-25 07:21:53 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-25 07:21:53 INFO  ---RUNTIME: Importing and monkey-patching took 5.908966064453125 ms
2022-09-25 07:22:03 INFO  ---RUNTIME: Original pipeline execution took 9708.944082260132 ms (excluding imports and monkey-patching)
2022-09-25 07:22:03 INFO  Starting execution of 1 what-if analyses...
2022-09-25 07:22:03 INFO  Start plan generation for analysis DataCorruption...
2022-09-25 07:22:03 INFO  ---RUNTIME: Plan generation took 5.106449127197266 ms
2022-09-25 07:22:03 INFO  Estimated runtime of original DAG is 9380.159139633179ms
2022-09-25 07:22:03 WARNING Skipping Multi-Query Optimization (instead, only applying patches)
2022-09-25 07:22:03 INFO  Estimated unoptimised what-if runtime is 234503.97849082947ms
2022-09-25 07:22:03 INFO  ---RUNTIME: Multi-Query Optimization took 27.2829532623291 ms
2022-09-25 07:22:03 INFO  Executing generated plans
2022-09-25 07:26:06 INFO  ---RUNTIME: Execution took 243062.109708786 ms
2022-09-25 07:26:06 INFO  Done!
2022-09-25 07:26:06 INFO  # Finished -- repetition 5 of 7 
2022-09-25 07:26:06 INFO  # Optimization benchmark for data_corruption with args [['reviews', 'fast_loading', 'featurization_3', 'logistic_regression']] -- repetition 6 of 7
2022-09-25 07:26:06 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-25 07:26:06 INFO  Running instrumented original pipeline...
2022-09-25 07:26:06 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-25 07:26:06 INFO  ---RUNTIME: Importing and monkey-patching took 5.9986114501953125 ms
2022-09-25 07:26:16 INFO  ---RUNTIME: Original pipeline execution took 9505.360126495361 ms (excluding imports and monkey-patching)
2022-09-25 07:26:16 INFO  Starting execution of 1 what-if analyses...
2022-09-25 07:26:16 INFO  Start plan generation for analysis DataCorruption...
2022-09-25 07:26:16 INFO  ---RUNTIME: Plan generation took 0.47326087951660156 ms
2022-09-25 07:26:16 INFO  Estimated runtime of original DAG is 9161.53621673584ms
2022-09-25 07:26:16 INFO  Performing Multi-Query Optimization
2022-09-25 07:26:16 INFO  Estimated unoptimized what-if runtime is 229038.405418396ms
2022-09-25 07:26:16 INFO  Estimated optimised what-if runtime is 26636.54613494873ms
2022-09-25 07:26:16 INFO  Estimated optimisation runtime saving is 202401.85928344727ms
2022-09-25 07:26:16 INFO  ---RUNTIME: Multi-Query Optimization took 81.55441284179688 ms
2022-09-25 07:26:16 INFO  Executing generated plans
2022-09-25 07:26:48 INFO  ---RUNTIME: Execution took 32540.578365325928 ms
2022-09-25 07:26:48 INFO  Done!
2022-09-25 07:26:48 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-25 07:26:48 INFO  Running instrumented original pipeline...
2022-09-25 07:26:49 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-25 07:26:49 INFO  ---RUNTIME: Importing and monkey-patching took 6.0138702392578125 ms
2022-09-25 07:26:58 INFO  ---RUNTIME: Original pipeline execution took 9461.238622665405 ms (excluding imports and monkey-patching)
2022-09-25 07:26:58 INFO  Starting execution of 1 what-if analyses...
2022-09-25 07:26:58 INFO  Start plan generation for analysis DataCorruption...
2022-09-25 07:26:58 INFO  ---RUNTIME: Plan generation took 0.46253204345703125 ms
2022-09-25 07:26:58 INFO  Estimated runtime of original DAG is 9128.412008285522ms
2022-09-25 07:26:58 WARNING Skipping Multi-Query Optimization (instead, only applying patches)
2022-09-25 07:26:58 INFO  Estimated unoptimised what-if runtime is 228210.30020713806ms
2022-09-25 07:26:58 INFO  ---RUNTIME: Multi-Query Optimization took 29.137372970581055 ms
2022-09-25 07:26:58 INFO  Executing generated plans
2022-09-25 07:31:01 INFO  ---RUNTIME: Execution took 243210.54410934448 ms
2022-09-25 07:31:01 INFO  Done!
2022-09-25 07:31:01 INFO  # Finished -- repetition 6 of 7 
2022-09-25 07:31:01 INFO  # Optimization benchmark for data_corruption with args [['reviews', 'fast_loading', 'featurization_3', 'logistic_regression']] -- repetition 7 of 7
2022-09-25 07:31:01 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-25 07:31:01 INFO  Running instrumented original pipeline...
2022-09-25 07:31:01 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-25 07:31:01 INFO  ---RUNTIME: Importing and monkey-patching took 6.026744842529297 ms
2022-09-25 07:31:11 INFO  ---RUNTIME: Original pipeline execution took 9453.599214553833 ms (excluding imports and monkey-patching)
2022-09-25 07:31:11 INFO  Starting execution of 1 what-if analyses...
2022-09-25 07:31:11 INFO  Start plan generation for analysis DataCorruption...
2022-09-25 07:31:11 INFO  ---RUNTIME: Plan generation took 0.4208087921142578 ms
2022-09-25 07:31:11 INFO  Estimated runtime of original DAG is 9113.74568939209ms
2022-09-25 07:31:11 INFO  Performing Multi-Query Optimization
2022-09-25 07:31:11 INFO  Estimated unoptimized what-if runtime is 227843.64223480225ms
2022-09-25 07:31:11 INFO  Estimated optimised what-if runtime is 26572.16763496399ms
2022-09-25 07:31:11 INFO  Estimated optimisation runtime saving is 201271.47459983826ms
2022-09-25 07:31:11 INFO  ---RUNTIME: Multi-Query Optimization took 81.2215805053711 ms
2022-09-25 07:31:11 INFO  Executing generated plans
2022-09-25 07:31:43 INFO  ---RUNTIME: Execution took 32456.220865249634 ms
2022-09-25 07:31:43 INFO  Done!
2022-09-25 07:31:43 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-25 07:31:43 INFO  Running instrumented original pipeline...
2022-09-25 07:31:43 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-25 07:31:43 INFO  ---RUNTIME: Importing and monkey-patching took 6.240367889404297 ms
2022-09-25 07:31:53 INFO  ---RUNTIME: Original pipeline execution took 9466.27163887024 ms (excluding imports and monkey-patching)
2022-09-25 07:31:53 INFO  Starting execution of 1 what-if analyses...
2022-09-25 07:31:53 INFO  Start plan generation for analysis DataCorruption...
2022-09-25 07:31:53 INFO  ---RUNTIME: Plan generation took 0.4248619079589844 ms
2022-09-25 07:31:53 INFO  Estimated runtime of original DAG is 9134.7975730896ms
2022-09-25 07:31:53 WARNING Skipping Multi-Query Optimization (instead, only applying patches)
2022-09-25 07:31:53 INFO  Estimated unoptimised what-if runtime is 228369.93932724ms
2022-09-25 07:31:53 INFO  ---RUNTIME: Multi-Query Optimization took 26.876449584960938 ms
2022-09-25 07:31:53 INFO  Executing generated plans
2022-09-25 07:35:55 INFO  ---RUNTIME: Execution took 242636.2338066101 ms
2022-09-25 07:35:55 INFO  Done!
2022-09-25 07:35:55 INFO  # Finished -- repetition 7 of 7 
2022-09-25 07:35:56 INFO  # Final results after all repetitions
2022-09-25 07:35:56 INFO     repetition  ... no_opt_what_if_execution_combined_model_training
0           0  ...                                      2373.994350
1           1  ...                                      2445.069313
2           2  ...                                      2326.523542
3           3  ...                                      2365.480900
4           4  ...                                      2316.602468
5           5  ...                                      2340.231180
6           6  ...                                      2353.275776

[7 rows x 26 columns]
PROTOCOL_BUFFERS_PYTHON_IMPLEMENTATION=python taskset -c 32-39 python3.9 benchmarks_end_to_end.py data_corruption reviews fast_loading featurization_3 xgboost
2022-09-25 07:35:58.439145: W tensorflow/stream_executor/platform/default/dso_loader.cc:64] Could not load dynamic library 'libcudart.so.11.0'; dlerror: libcudart.so.11.0: cannot open shared object file: No such file or directory; LD_LIBRARY_PATH: /home/sgrafbe/mlwhatif/venv/lib/python3.9/site-packages/cv2/../../lib64:
2022-09-25 07:35:58.439192: I tensorflow/stream_executor/cuda/cudart_stub.cc:29] Ignore above cudart dlerror if you do not have a GPU set up on your machine.
2022-09-25 07:35:59 INFO  Patching sys.argv with ['mlwhatif', 'reviews', 'fast_loading', 'featurization_3', 'xgboost']
2022-09-25 07:35:59 INFO  Running instrumented original pipeline...
2022-09-25 07:35:59 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-25 07:35:59 INFO  ---RUNTIME: Importing and monkey-patching took 122.63226509094238 ms
2022-09-25 07:36:43 INFO  ---RUNTIME: Original pipeline execution took 43343.597650527954 ms (excluding imports and monkey-patching)
2022-09-25 07:36:43 INFO  Starting execution of 0 what-if analyses...
2022-09-25 07:36:43 INFO  Estimated runtime of original DAG is 42969.80285644531ms
2022-09-25 07:36:43 INFO  Performing Multi-Query Optimization
2022-09-25 07:36:43 INFO  Estimated unoptimized what-if runtime is 0ms
2022-09-25 07:36:43 INFO  Estimated optimised what-if runtime is 0ms
2022-09-25 07:36:43 INFO  Estimated optimisation runtime saving is 0ms
2022-09-25 07:36:43 INFO  ---RUNTIME: Multi-Query Optimization took 0.560760498046875 ms
2022-09-25 07:36:43 INFO  Executing generated plans
2022-09-25 07:36:43 INFO  ---RUNTIME: Execution took 0.024557113647460938 ms
2022-09-25 07:36:43 INFO  Done!
2022-09-25 07:36:43 INFO  # Optimization benchmark for data_corruption with args [['reviews', 'fast_loading', 'featurization_3', 'xgboost']] -- repetition 1 of 7
2022-09-25 07:36:43 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-25 07:36:43 INFO  Running instrumented original pipeline...
2022-09-25 07:36:43 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-25 07:36:43 INFO  ---RUNTIME: Importing and monkey-patching took 5.682945251464844 ms
2022-09-25 07:37:26 INFO  ---RUNTIME: Original pipeline execution took 43428.26247215271 ms (excluding imports and monkey-patching)
2022-09-25 07:37:26 INFO  Starting execution of 1 what-if analyses...
2022-09-25 07:37:26 INFO  Start plan generation for analysis DataCorruption...
2022-09-25 07:37:26 INFO  ---RUNTIME: Plan generation took 5.0792694091796875 ms
2022-09-25 07:37:26 INFO  Estimated runtime of original DAG is 42899.16229248047ms
2022-09-25 07:37:26 INFO  Performing Multi-Query Optimization
2022-09-25 07:37:26 INFO  Estimated unoptimized what-if runtime is 1072479.0573120117ms
2022-09-25 07:37:26 INFO  Estimated optimised what-if runtime is 68633.24356079102ms
2022-09-25 07:37:26 INFO  Estimated optimisation runtime saving is 1003845.8137512207ms
2022-09-25 07:37:26 INFO  ---RUNTIME: Multi-Query Optimization took 77.84175872802734 ms
2022-09-25 07:37:26 INFO  Executing generated plans
2022-09-25 07:38:40 INFO  ---RUNTIME: Execution took 73876.8424987793 ms
2022-09-25 07:38:40 INFO  Done!
2022-09-25 07:38:40 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-25 07:38:40 INFO  Running instrumented original pipeline...
2022-09-25 07:38:40 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-25 07:38:40 INFO  ---RUNTIME: Importing and monkey-patching took 6.328821182250977 ms
2022-09-25 07:39:23 INFO  ---RUNTIME: Original pipeline execution took 43109.17067527771 ms (excluding imports and monkey-patching)
2022-09-25 07:39:23 INFO  Starting execution of 1 what-if analyses...
2022-09-25 07:39:23 INFO  Start plan generation for analysis DataCorruption...
2022-09-25 07:39:23 INFO  ---RUNTIME: Plan generation took 1.18255615234375 ms
2022-09-25 07:39:23 INFO  Estimated runtime of original DAG is 42768.26882362366ms
2022-09-25 07:39:23 WARNING Skipping Multi-Query Optimization (instead, only applying patches)
2022-09-25 07:39:23 INFO  Estimated unoptimised what-if runtime is 1069206.7205905914ms
2022-09-25 07:39:23 INFO  ---RUNTIME: Multi-Query Optimization took 27.489185333251953 ms
2022-09-25 07:39:23 INFO  Executing generated plans
2022-09-25 07:57:27 INFO  ---RUNTIME: Execution took 1084179.1331768036 ms
2022-09-25 07:57:27 INFO  Done!
2022-09-25 07:57:27 INFO  # Finished -- repetition 1 of 7 
2022-09-25 07:57:27 INFO  # Optimization benchmark for data_corruption with args [['reviews', 'fast_loading', 'featurization_3', 'xgboost']] -- repetition 2 of 7
2022-09-25 07:57:27 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-25 07:57:27 INFO  Running instrumented original pipeline...
2022-09-25 07:57:27 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-25 07:57:27 INFO  ---RUNTIME: Importing and monkey-patching took 6.019830703735352 ms
2022-09-25 07:58:11 INFO  ---RUNTIME: Original pipeline execution took 43098.703384399414 ms (excluding imports and monkey-patching)
2022-09-25 07:58:11 INFO  Starting execution of 1 what-if analyses...
2022-09-25 07:58:11 INFO  Start plan generation for analysis DataCorruption...
2022-09-25 07:58:11 INFO  ---RUNTIME: Plan generation took 1.2018680572509766 ms
2022-09-25 07:58:11 INFO  Estimated runtime of original DAG is 42762.76445388794ms
2022-09-25 07:58:11 INFO  Performing Multi-Query Optimization
2022-09-25 07:58:11 INFO  Estimated unoptimized what-if runtime is 1069069.1113471985ms
2022-09-25 07:58:11 INFO  Estimated optimised what-if runtime is 68207.09013938904ms
2022-09-25 07:58:11 INFO  Estimated optimisation runtime saving is 1000862.0212078094ms
2022-09-25 07:58:11 INFO  ---RUNTIME: Multi-Query Optimization took 82.58867263793945 ms
2022-09-25 07:58:11 INFO  Executing generated plans
2022-09-25 07:59:25 INFO  ---RUNTIME: Execution took 73884.84978675842 ms
2022-09-25 07:59:25 INFO  Done!
2022-09-25 07:59:25 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-25 07:59:25 INFO  Running instrumented original pipeline...
2022-09-25 07:59:25 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-25 07:59:25 INFO  ---RUNTIME: Importing and monkey-patching took 6.097078323364258 ms
2022-09-25 08:00:08 INFO  ---RUNTIME: Original pipeline execution took 43039.20125961304 ms (excluding imports and monkey-patching)
2022-09-25 08:00:08 INFO  Starting execution of 1 what-if analyses...
2022-09-25 08:00:08 INFO  Start plan generation for analysis DataCorruption...
2022-09-25 08:00:08 INFO  ---RUNTIME: Plan generation took 1.2197494506835938 ms
2022-09-25 08:00:08 INFO  Estimated runtime of original DAG is 42701.565742492676ms
2022-09-25 08:00:08 WARNING Skipping Multi-Query Optimization (instead, only applying patches)
2022-09-25 08:00:08 INFO  Estimated unoptimised what-if runtime is 1067539.143562317ms
2022-09-25 08:00:08 INFO  ---RUNTIME: Multi-Query Optimization took 27.37879753112793 ms
2022-09-25 08:00:08 INFO  Executing generated plans
2022-09-25 08:18:10 INFO  ---RUNTIME: Execution took 1082579.068660736 ms
2022-09-25 08:18:10 INFO  Done!
2022-09-25 08:18:10 INFO  # Finished -- repetition 2 of 7 
2022-09-25 08:18:10 INFO  # Optimization benchmark for data_corruption with args [['reviews', 'fast_loading', 'featurization_3', 'xgboost']] -- repetition 3 of 7
2022-09-25 08:18:10 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-25 08:18:10 INFO  Running instrumented original pipeline...
2022-09-25 08:18:10 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-25 08:18:10 INFO  ---RUNTIME: Importing and monkey-patching took 6.227016448974609 ms
2022-09-25 08:18:53 INFO  ---RUNTIME: Original pipeline execution took 43022.20344543457 ms (excluding imports and monkey-patching)
2022-09-25 08:18:53 INFO  Starting execution of 1 what-if analyses...
2022-09-25 08:18:53 INFO  Start plan generation for analysis DataCorruption...
2022-09-25 08:18:53 INFO  ---RUNTIME: Plan generation took 1.5759468078613281 ms
2022-09-25 08:18:53 INFO  Estimated runtime of original DAG is 42688.27772140503ms
2022-09-25 08:18:53 INFO  Performing Multi-Query Optimization
2022-09-25 08:18:54 INFO  Estimated unoptimized what-if runtime is 1067206.9430351257ms
2022-09-25 08:18:54 INFO  Estimated optimised what-if runtime is 67780.95316886902ms
2022-09-25 08:18:54 INFO  Estimated optimisation runtime saving is 999425.9898662567ms
2022-09-25 08:18:54 INFO  ---RUNTIME: Multi-Query Optimization took 337.63694763183594 ms
2022-09-25 08:18:54 INFO  Executing generated plans
2022-09-25 08:20:07 INFO  ---RUNTIME: Execution took 73664.1492843628 ms
2022-09-25 08:20:07 INFO  Done!
2022-09-25 08:20:07 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-25 08:20:07 INFO  Running instrumented original pipeline...
2022-09-25 08:20:07 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-25 08:20:07 INFO  ---RUNTIME: Importing and monkey-patching took 5.98597526550293 ms
2022-09-25 08:20:50 INFO  ---RUNTIME: Original pipeline execution took 43000.540256500244 ms (excluding imports and monkey-patching)
2022-09-25 08:20:50 INFO  Starting execution of 1 what-if analyses...
2022-09-25 08:20:50 INFO  Start plan generation for analysis DataCorruption...
2022-09-25 08:20:50 INFO  ---RUNTIME: Plan generation took 1.3363361358642578 ms
2022-09-25 08:20:50 INFO  Estimated runtime of original DAG is 42668.8015460968ms
2022-09-25 08:20:50 WARNING Skipping Multi-Query Optimization (instead, only applying patches)
2022-09-25 08:20:50 INFO  Estimated unoptimised what-if runtime is 1066720.03865242ms
2022-09-25 08:20:50 INFO  ---RUNTIME: Multi-Query Optimization took 26.554584503173828 ms
2022-09-25 08:20:50 INFO  Executing generated plans
2022-09-25 08:38:53 INFO  ---RUNTIME: Execution took 1082930.6111335754 ms
2022-09-25 08:38:53 INFO  Done!
2022-09-25 08:38:53 INFO  # Finished -- repetition 3 of 7 
2022-09-25 08:38:53 INFO  # Optimization benchmark for data_corruption with args [['reviews', 'fast_loading', 'featurization_3', 'xgboost']] -- repetition 4 of 7
2022-09-25 08:38:53 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-25 08:38:53 INFO  Running instrumented original pipeline...
2022-09-25 08:38:53 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-25 08:38:53 INFO  ---RUNTIME: Importing and monkey-patching took 6.196022033691406 ms
2022-09-25 08:39:36 INFO  ---RUNTIME: Original pipeline execution took 43103.291511535645 ms (excluding imports and monkey-patching)
2022-09-25 08:39:36 INFO  Starting execution of 1 what-if analyses...
2022-09-25 08:39:36 INFO  Start plan generation for analysis DataCorruption...
2022-09-25 08:39:36 INFO  ---RUNTIME: Plan generation took 1.1870861053466797 ms
2022-09-25 08:39:36 INFO  Estimated runtime of original DAG is 42766.53981208801ms
2022-09-25 08:39:36 INFO  Performing Multi-Query Optimization
2022-09-25 08:39:37 INFO  Estimated unoptimized what-if runtime is 1069163.4953022003ms
2022-09-25 08:39:37 INFO  Estimated optimised what-if runtime is 68063.04001808167ms
2022-09-25 08:39:37 INFO  Estimated optimisation runtime saving is 1001100.4552841187ms
2022-09-25 08:39:37 INFO  ---RUNTIME: Multi-Query Optimization took 81.27784729003906 ms
2022-09-25 08:39:37 INFO  Executing generated plans
2022-09-25 08:40:50 INFO  ---RUNTIME: Execution took 73858.14452171326 ms
2022-09-25 08:40:50 INFO  Done!
2022-09-25 08:40:50 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-25 08:40:50 INFO  Running instrumented original pipeline...
2022-09-25 08:40:50 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-25 08:40:50 INFO  ---RUNTIME: Importing and monkey-patching took 6.128549575805664 ms
2022-09-25 08:41:34 INFO  ---RUNTIME: Original pipeline execution took 43082.51333236694 ms (excluding imports and monkey-patching)
2022-09-25 08:41:34 INFO  Starting execution of 1 what-if analyses...
2022-09-25 08:41:34 INFO  Start plan generation for analysis DataCorruption...
2022-09-25 08:41:34 INFO  ---RUNTIME: Plan generation took 4.976034164428711 ms
2022-09-25 08:41:34 INFO  Estimated runtime of original DAG is 42746.36435508728ms
2022-09-25 08:41:34 WARNING Skipping Multi-Query Optimization (instead, only applying patches)
2022-09-25 08:41:34 INFO  Estimated unoptimised what-if runtime is 1068659.108877182ms
2022-09-25 08:41:34 INFO  ---RUNTIME: Multi-Query Optimization took 22.040605545043945 ms
2022-09-25 08:41:34 INFO  Executing generated plans
2022-09-25 08:59:35 INFO  ---RUNTIME: Execution took 1081804.2895793915 ms
2022-09-25 08:59:35 INFO  Done!
2022-09-25 08:59:35 INFO  # Finished -- repetition 4 of 7 
2022-09-25 08:59:35 INFO  # Optimization benchmark for data_corruption with args [['reviews', 'fast_loading', 'featurization_3', 'xgboost']] -- repetition 5 of 7
2022-09-25 08:59:35 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-25 08:59:35 INFO  Running instrumented original pipeline...
2022-09-25 08:59:35 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-25 08:59:35 INFO  ---RUNTIME: Importing and monkey-patching took 6.151437759399414 ms
2022-09-25 09:00:19 INFO  ---RUNTIME: Original pipeline execution took 43096.65131568909 ms (excluding imports and monkey-patching)
2022-09-25 09:00:19 INFO  Starting execution of 1 what-if analyses...
2022-09-25 09:00:19 INFO  Start plan generation for analysis DataCorruption...
2022-09-25 09:00:19 INFO  ---RUNTIME: Plan generation took 5.08427619934082 ms
2022-09-25 09:00:19 INFO  Estimated runtime of original DAG is 42763.824701309204ms
2022-09-25 09:00:19 INFO  Performing Multi-Query Optimization
2022-09-25 09:00:19 INFO  Estimated unoptimized what-if runtime is 1069095.61753273ms
2022-09-25 09:00:19 INFO  Estimated optimised what-if runtime is 68062.57462501526ms
2022-09-25 09:00:19 INFO  Estimated optimisation runtime saving is 1001033.0429077148ms
2022-09-25 09:00:19 INFO  ---RUNTIME: Multi-Query Optimization took 76.50375366210938 ms
2022-09-25 09:00:19 INFO  Executing generated plans
2022-09-25 09:01:32 INFO  ---RUNTIME: Execution took 73638.37671279907 ms
2022-09-25 09:01:32 INFO  Done!
2022-09-25 09:01:32 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-25 09:01:32 INFO  Running instrumented original pipeline...
2022-09-25 09:01:32 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-25 09:01:32 INFO  ---RUNTIME: Importing and monkey-patching took 6.102561950683594 ms
2022-09-25 09:02:15 INFO  ---RUNTIME: Original pipeline execution took 43111.923933029175 ms (excluding imports and monkey-patching)
2022-09-25 09:02:15 INFO  Starting execution of 1 what-if analyses...
2022-09-25 09:02:15 INFO  Start plan generation for analysis DataCorruption...
2022-09-25 09:02:15 INFO  ---RUNTIME: Plan generation took 3.173351287841797 ms
2022-09-25 09:02:15 INFO  Estimated runtime of original DAG is 42779.99687194824ms
2022-09-25 09:02:15 WARNING Skipping Multi-Query Optimization (instead, only applying patches)
2022-09-25 09:02:16 INFO  Estimated unoptimised what-if runtime is 1069499.921798706ms
2022-09-25 09:02:16 INFO  ---RUNTIME: Multi-Query Optimization took 288.2568836212158 ms
2022-09-25 09:02:16 INFO  Executing generated plans
2022-09-25 09:20:19 INFO  ---RUNTIME: Execution took 1082995.0728416443 ms
2022-09-25 09:20:19 INFO  Done!
2022-09-25 09:20:19 INFO  # Finished -- repetition 5 of 7 
2022-09-25 09:20:19 INFO  # Optimization benchmark for data_corruption with args [['reviews', 'fast_loading', 'featurization_3', 'xgboost']] -- repetition 6 of 7
2022-09-25 09:20:19 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-25 09:20:19 INFO  Running instrumented original pipeline...
2022-09-25 09:20:19 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-25 09:20:19 INFO  ---RUNTIME: Importing and monkey-patching took 5.984306335449219 ms
2022-09-25 09:21:02 INFO  ---RUNTIME: Original pipeline execution took 43043.69044303894 ms (excluding imports and monkey-patching)
2022-09-25 09:21:02 INFO  Starting execution of 1 what-if analyses...
2022-09-25 09:21:02 INFO  Start plan generation for analysis DataCorruption...
2022-09-25 09:21:02 INFO  ---RUNTIME: Plan generation took 2.135753631591797 ms
2022-09-25 09:21:02 INFO  Estimated runtime of original DAG is 42707.47709274292ms
2022-09-25 09:21:02 INFO  Performing Multi-Query Optimization
2022-09-25 09:21:02 INFO  Estimated unoptimized what-if runtime is 1067686.927318573ms
2022-09-25 09:21:02 INFO  Estimated optimised what-if runtime is 68047.03307151794ms
2022-09-25 09:21:02 INFO  Estimated optimisation runtime saving is 999639.894247055ms
2022-09-25 09:21:02 INFO  ---RUNTIME: Multi-Query Optimization took 83.63771438598633 ms
2022-09-25 09:21:02 INFO  Executing generated plans
2022-09-25 09:22:15 INFO  ---RUNTIME: Execution took 73627.19583511353 ms
2022-09-25 09:22:15 INFO  Done!
2022-09-25 09:22:16 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-25 09:22:16 INFO  Running instrumented original pipeline...
2022-09-25 09:22:16 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-25 09:22:16 INFO  ---RUNTIME: Importing and monkey-patching took 6.679058074951172 ms
2022-09-25 09:22:59 INFO  ---RUNTIME: Original pipeline execution took 43086.66157722473 ms (excluding imports and monkey-patching)
2022-09-25 09:22:59 INFO  Starting execution of 1 what-if analyses...
2022-09-25 09:22:59 INFO  Start plan generation for analysis DataCorruption...
2022-09-25 09:22:59 INFO  ---RUNTIME: Plan generation took 1.722574234008789 ms
2022-09-25 09:22:59 INFO  Estimated runtime of original DAG is 42752.56395339966ms
2022-09-25 09:22:59 WARNING Skipping Multi-Query Optimization (instead, only applying patches)
2022-09-25 09:22:59 INFO  Estimated unoptimised what-if runtime is 1068814.0988349915ms
2022-09-25 09:22:59 INFO  ---RUNTIME: Multi-Query Optimization took 29.018163681030273 ms
2022-09-25 09:22:59 INFO  Executing generated plans
2022-09-25 09:41:02 INFO  ---RUNTIME: Execution took 1083085.7145786285 ms
2022-09-25 09:41:02 INFO  Done!
2022-09-25 09:41:02 INFO  # Finished -- repetition 6 of 7 
2022-09-25 09:41:02 INFO  # Optimization benchmark for data_corruption with args [['reviews', 'fast_loading', 'featurization_3', 'xgboost']] -- repetition 7 of 7
2022-09-25 09:41:02 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-25 09:41:02 INFO  Running instrumented original pipeline...
2022-09-25 09:41:02 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-25 09:41:02 INFO  ---RUNTIME: Importing and monkey-patching took 6.419658660888672 ms
2022-09-25 09:41:45 INFO  ---RUNTIME: Original pipeline execution took 43037.861347198486 ms (excluding imports and monkey-patching)
2022-09-25 09:41:45 INFO  Starting execution of 1 what-if analyses...
2022-09-25 09:41:45 INFO  Start plan generation for analysis DataCorruption...
2022-09-25 09:41:45 INFO  ---RUNTIME: Plan generation took 1.7292499542236328 ms
2022-09-25 09:41:45 INFO  Estimated runtime of original DAG is 42703.529596328735ms
2022-09-25 09:41:45 INFO  Performing Multi-Query Optimization
2022-09-25 09:41:45 INFO  Estimated unoptimized what-if runtime is 1067588.2399082184ms
2022-09-25 09:41:45 INFO  Estimated optimised what-if runtime is 68101.68933868408ms
2022-09-25 09:41:45 INFO  Estimated optimisation runtime saving is 999486.5505695343ms
2022-09-25 09:41:45 INFO  ---RUNTIME: Multi-Query Optimization took 82.37528800964355 ms
2022-09-25 09:41:45 INFO  Executing generated plans
2022-09-25 09:42:59 INFO  ---RUNTIME: Execution took 73588.06157112122 ms
2022-09-25 09:42:59 INFO  Done!
2022-09-25 09:42:59 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-25 09:42:59 INFO  Running instrumented original pipeline...
2022-09-25 09:42:59 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-25 09:42:59 INFO  ---RUNTIME: Importing and monkey-patching took 6.033420562744141 ms
2022-09-25 09:43:42 INFO  ---RUNTIME: Original pipeline execution took 43074.67198371887 ms (excluding imports and monkey-patching)
2022-09-25 09:43:42 INFO  Starting execution of 1 what-if analyses...
2022-09-25 09:43:42 INFO  Start plan generation for analysis DataCorruption...
2022-09-25 09:43:42 INFO  ---RUNTIME: Plan generation took 1.1250972747802734 ms
2022-09-25 09:43:42 INFO  Estimated runtime of original DAG is 42740.6439781189ms
2022-09-25 09:43:42 WARNING Skipping Multi-Query Optimization (instead, only applying patches)
2022-09-25 09:43:42 INFO  Estimated unoptimised what-if runtime is 1068516.0994529724ms
2022-09-25 09:43:42 INFO  ---RUNTIME: Multi-Query Optimization took 26.31664276123047 ms
2022-09-25 09:43:42 INFO  Executing generated plans
2022-09-25 10:01:45 INFO  ---RUNTIME: Execution took 1082852.5745868683 ms
2022-09-25 10:01:45 INFO  Done!
2022-09-25 10:01:45 INFO  # Finished -- repetition 7 of 7 
2022-09-25 10:01:45 INFO  # Final results after all repetitions
2022-09-25 10:01:45 INFO     repetition  ... no_opt_what_if_execution_combined_model_training
0           0  ...                                    835824.666739
1           1  ...                                    834729.868412
2           2  ...                                    834884.145975
3           3  ...                                    834421.171427
4           4  ...                                    835407.258987
5           5  ...                                    835198.417902
6           6  ...                                    834945.901632

[7 rows x 26 columns]
PROTOCOL_BUFFERS_PYTHON_IMPLEMENTATION=python taskset -c 32-39 python3.9 benchmarks_end_to_end.py data_corruption reviews fast_loading featurization_3 neural_network
2022-09-25 10:01:47.377739: W tensorflow/stream_executor/platform/default/dso_loader.cc:64] Could not load dynamic library 'libcudart.so.11.0'; dlerror: libcudart.so.11.0: cannot open shared object file: No such file or directory; LD_LIBRARY_PATH: /home/sgrafbe/mlwhatif/venv/lib/python3.9/site-packages/cv2/../../lib64:
2022-09-25 10:01:47.377785: I tensorflow/stream_executor/cuda/cudart_stub.cc:29] Ignore above cudart dlerror if you do not have a GPU set up on your machine.
2022-09-25 10:01:48 INFO  Patching sys.argv with ['mlwhatif', 'reviews', 'fast_loading', 'featurization_3', 'neural_network']
2022-09-25 10:01:48 INFO  Running instrumented original pipeline...
2022-09-25 10:01:48 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-25 10:01:48 INFO  ---RUNTIME: Importing and monkey-patching took 121.76394462585449 ms
2022-09-25 10:01:54.964936: W tensorflow/stream_executor/platform/default/dso_loader.cc:64] Could not load dynamic library 'libcuda.so.1'; dlerror: libcuda.so.1: cannot open shared object file: No such file or directory; LD_LIBRARY_PATH: /home/sgrafbe/mlwhatif/venv/lib/python3.9/site-packages/cv2/../../lib64:
2022-09-25 10:01:54.964976: W tensorflow/stream_executor/cuda/cuda_driver.cc:326] failed call to cuInit: UNKNOWN ERROR (303)
2022-09-25 10:01:54.964996: I tensorflow/stream_executor/cuda/cuda_diagnostics.cc:156] kernel driver does not appear to be running on this host (angus): /proc/driver/nvidia/version does not exist
2022-09-25 10:01:54.965531: I tensorflow/core/platform/cpu_feature_guard.cc:142] This TensorFlow binary is optimized with oneAPI Deep Neural Network Library (oneDNN) to use the following CPU instructions in performance-critical operations:  AVX2 FMA
To enable them in other operations, rebuild TensorFlow with the appropriate compiler flags.
2022-09-25 10:01:55.585543: I tensorflow/compiler/mlir/mlir_graph_optimization_pass.cc:176] None of the MLIR Optimization Passes are enabled (registered 2)
2022-09-25 10:01:55.599221: I tensorflow/core/platform/profile_utils/cpu_utils.cc:114] CPU Frequency: 2595130000 Hz
2022-09-25 10:02:05 INFO  ---RUNTIME: Original pipeline execution took 16349.546670913696 ms (excluding imports and monkey-patching)
2022-09-25 10:02:05 INFO  Starting execution of 0 what-if analyses...
2022-09-25 10:02:05 INFO  Estimated runtime of original DAG is 15971.378564834595ms
2022-09-25 10:02:05 INFO  Performing Multi-Query Optimization
2022-09-25 10:02:05 INFO  Estimated unoptimized what-if runtime is 0ms
2022-09-25 10:02:05 INFO  Estimated optimised what-if runtime is 0ms
2022-09-25 10:02:05 INFO  Estimated optimisation runtime saving is 0ms
2022-09-25 10:02:05 INFO  ---RUNTIME: Multi-Query Optimization took 0.5438327789306641 ms
2022-09-25 10:02:05 INFO  Executing generated plans
2022-09-25 10:02:05 INFO  ---RUNTIME: Execution took 0.023603439331054688 ms
2022-09-25 10:02:05 INFO  Done!
2022-09-25 10:02:05 INFO  # Optimization benchmark for data_corruption with args [['reviews', 'fast_loading', 'featurization_3', 'neural_network']] -- repetition 1 of 7
2022-09-25 10:02:05 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-25 10:02:05 INFO  Running instrumented original pipeline...
2022-09-25 10:02:05 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-25 10:02:05 INFO  ---RUNTIME: Importing and monkey-patching took 5.369424819946289 ms
2022-09-25 10:02:21 INFO  ---RUNTIME: Original pipeline execution took 15960.492134094238 ms (excluding imports and monkey-patching)
2022-09-25 10:02:21 INFO  Starting execution of 1 what-if analyses...
2022-09-25 10:02:21 INFO  Start plan generation for analysis DataCorruption...
2022-09-25 10:02:21 INFO  ---RUNTIME: Plan generation took 6.103992462158203 ms
2022-09-25 10:02:21 INFO  Estimated runtime of original DAG is 15616.981744766235ms
2022-09-25 10:02:21 INFO  Performing Multi-Query Optimization
2022-09-25 10:02:21 INFO  Estimated unoptimized what-if runtime is 390424.5436191559ms
2022-09-25 10:02:21 INFO  Estimated optimised what-if runtime is 50953.21083068848ms
2022-09-25 10:02:21 INFO  Estimated optimisation runtime saving is 339471.3327884674ms
2022-09-25 10:02:21 INFO  ---RUNTIME: Multi-Query Optimization took 78.63354682922363 ms
2022-09-25 10:02:21 INFO  Executing generated plans
2022-09-25 10:03:17 INFO  ---RUNTIME: Execution took 56305.98855018616 ms
2022-09-25 10:03:17 INFO  Done!
2022-09-25 10:03:17 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-25 10:03:17 INFO  Running instrumented original pipeline...
2022-09-25 10:03:17 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-25 10:03:17 INFO  ---RUNTIME: Importing and monkey-patching took 6.256818771362305 ms
2022-09-25 10:03:33 INFO  ---RUNTIME: Original pipeline execution took 15954.796075820923 ms (excluding imports and monkey-patching)
2022-09-25 10:03:33 INFO  Starting execution of 1 what-if analyses...
2022-09-25 10:03:33 INFO  Start plan generation for analysis DataCorruption...
2022-09-25 10:03:33 INFO  ---RUNTIME: Plan generation took 0.38933753967285156 ms
2022-09-25 10:03:33 INFO  Estimated runtime of original DAG is 15617.786169052124ms
2022-09-25 10:03:33 WARNING Skipping Multi-Query Optimization (instead, only applying patches)
2022-09-25 10:03:33 INFO  Estimated unoptimised what-if runtime is 390444.6542263031ms
2022-09-25 10:03:33 INFO  ---RUNTIME: Multi-Query Optimization took 22.596120834350586 ms
2022-09-25 10:03:33 INFO  Executing generated plans
2022-09-25 10:10:20 INFO  ---RUNTIME: Execution took 406741.1308288574 ms
2022-09-25 10:10:20 INFO  Done!
2022-09-25 10:10:20 INFO  # Finished -- repetition 1 of 7 
2022-09-25 10:10:20 INFO  # Optimization benchmark for data_corruption with args [['reviews', 'fast_loading', 'featurization_3', 'neural_network']] -- repetition 2 of 7
2022-09-25 10:10:20 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-25 10:10:20 INFO  Running instrumented original pipeline...
2022-09-25 10:10:20 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-25 10:10:20 INFO  ---RUNTIME: Importing and monkey-patching took 6.152629852294922 ms
2022-09-25 10:10:36 INFO  ---RUNTIME: Original pipeline execution took 15924.60823059082 ms (excluding imports and monkey-patching)
2022-09-25 10:10:36 INFO  Starting execution of 1 what-if analyses...
2022-09-25 10:10:36 INFO  Start plan generation for analysis DataCorruption...
2022-09-25 10:10:36 INFO  ---RUNTIME: Plan generation took 395.36070823669434 ms
2022-09-25 10:10:36 INFO  Estimated runtime of original DAG is 15577.695846557617ms
2022-09-25 10:10:36 INFO  Performing Multi-Query Optimization
2022-09-25 10:10:36 INFO  Estimated unoptimized what-if runtime is 389442.39616394043ms
2022-09-25 10:10:36 INFO  Estimated optimised what-if runtime is 51154.51383590698ms
2022-09-25 10:10:36 INFO  Estimated optimisation runtime saving is 338287.88232803345ms
2022-09-25 10:10:36 INFO  ---RUNTIME: Multi-Query Optimization took 78.19485664367676 ms
2022-09-25 10:10:36 INFO  Executing generated plans
2022-09-25 10:11:31 INFO  ---RUNTIME: Execution took 54961.098194122314 ms
2022-09-25 10:11:31 INFO  Done!
2022-09-25 10:11:31 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-25 10:11:31 INFO  Running instrumented original pipeline...
2022-09-25 10:11:31 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-25 10:11:31 INFO  ---RUNTIME: Importing and monkey-patching took 6.11114501953125 ms
2022-09-25 10:11:47 INFO  ---RUNTIME: Original pipeline execution took 15963.283061981201 ms (excluding imports and monkey-patching)
2022-09-25 10:11:47 INFO  Starting execution of 1 what-if analyses...
2022-09-25 10:11:47 INFO  Start plan generation for analysis DataCorruption...
2022-09-25 10:11:47 INFO  ---RUNTIME: Plan generation took 0.40650367736816406 ms
2022-09-25 10:11:47 INFO  Estimated runtime of original DAG is 15613.762140274048ms
2022-09-25 10:11:47 WARNING Skipping Multi-Query Optimization (instead, only applying patches)
2022-09-25 10:11:47 INFO  Estimated unoptimised what-if runtime is 390344.0535068512ms
2022-09-25 10:11:47 INFO  ---RUNTIME: Multi-Query Optimization took 22.973060607910156 ms
2022-09-25 10:11:47 INFO  Executing generated plans
2022-09-25 10:18:34 INFO  ---RUNTIME: Execution took 406412.69755363464 ms
2022-09-25 10:18:34 INFO  Done!
2022-09-25 10:18:34 INFO  # Finished -- repetition 2 of 7 
2022-09-25 10:18:34 INFO  # Optimization benchmark for data_corruption with args [['reviews', 'fast_loading', 'featurization_3', 'neural_network']] -- repetition 3 of 7
2022-09-25 10:18:34 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-25 10:18:34 INFO  Running instrumented original pipeline...
2022-09-25 10:18:34 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-25 10:18:34 INFO  ---RUNTIME: Importing and monkey-patching took 6.212472915649414 ms
2022-09-25 10:18:50 INFO  ---RUNTIME: Original pipeline execution took 16005.396366119385 ms (excluding imports and monkey-patching)
2022-09-25 10:18:50 INFO  Starting execution of 1 what-if analyses...
2022-09-25 10:18:50 INFO  Start plan generation for analysis DataCorruption...
2022-09-25 10:18:50 INFO  ---RUNTIME: Plan generation took 0.39839744567871094 ms
2022-09-25 10:18:50 INFO  Estimated runtime of original DAG is 15657.56607055664ms
2022-09-25 10:18:50 INFO  Performing Multi-Query Optimization
2022-09-25 10:18:50 INFO  Estimated unoptimized what-if runtime is 391439.151763916ms
2022-09-25 10:18:50 INFO  Estimated optimised what-if runtime is 51214.53094482422ms
2022-09-25 10:18:50 INFO  Estimated optimisation runtime saving is 340224.6208190918ms
2022-09-25 10:18:50 INFO  ---RUNTIME: Multi-Query Optimization took 76.79486274719238 ms
2022-09-25 10:18:50 INFO  Executing generated plans
2022-09-25 10:19:45 INFO  ---RUNTIME: Execution took 54946.614027023315 ms
2022-09-25 10:19:45 INFO  Done!
2022-09-25 10:19:45 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-25 10:19:45 INFO  Running instrumented original pipeline...
2022-09-25 10:19:45 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-25 10:19:45 INFO  ---RUNTIME: Importing and monkey-patching took 5.9108734130859375 ms
2022-09-25 10:20:01 INFO  ---RUNTIME: Original pipeline execution took 16476.991653442383 ms (excluding imports and monkey-patching)
2022-09-25 10:20:01 INFO  Starting execution of 1 what-if analyses...
2022-09-25 10:20:01 INFO  Start plan generation for analysis DataCorruption...
2022-09-25 10:20:01 INFO  ---RUNTIME: Plan generation took 0.39958953857421875 ms
2022-09-25 10:20:01 INFO  Estimated runtime of original DAG is 15668.158054351807ms
2022-09-25 10:20:01 WARNING Skipping Multi-Query Optimization (instead, only applying patches)
2022-09-25 10:20:01 INFO  Estimated unoptimised what-if runtime is 391703.95135879517ms
2022-09-25 10:20:01 INFO  ---RUNTIME: Multi-Query Optimization took 22.54652976989746 ms
2022-09-25 10:20:01 INFO  Executing generated plans
2022-09-25 10:26:56 INFO  ---RUNTIME: Execution took 414674.9415397644 ms
2022-09-25 10:26:56 INFO  Done!
2022-09-25 10:26:56 INFO  # Finished -- repetition 3 of 7 
2022-09-25 10:26:56 INFO  # Optimization benchmark for data_corruption with args [['reviews', 'fast_loading', 'featurization_3', 'neural_network']] -- repetition 4 of 7
2022-09-25 10:26:56 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-25 10:26:56 INFO  Running instrumented original pipeline...
2022-09-25 10:26:56 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-25 10:26:56 INFO  ---RUNTIME: Importing and monkey-patching took 6.137847900390625 ms
2022-09-25 10:27:13 INFO  ---RUNTIME: Original pipeline execution took 16963.172435760498 ms (excluding imports and monkey-patching)
2022-09-25 10:27:13 INFO  Starting execution of 1 what-if analyses...
2022-09-25 10:27:13 INFO  Start plan generation for analysis DataCorruption...
2022-09-25 10:27:13 INFO  ---RUNTIME: Plan generation took 0.3979206085205078 ms
2022-09-25 10:27:13 INFO  Estimated runtime of original DAG is 16601.166009902954ms
2022-09-25 10:27:13 INFO  Performing Multi-Query Optimization
2022-09-25 10:27:13 INFO  Estimated unoptimized what-if runtime is 415029.15024757385ms
2022-09-25 10:27:13 INFO  Estimated optimised what-if runtime is 52875.4563331604ms
2022-09-25 10:27:13 INFO  Estimated optimisation runtime saving is 362153.69391441345ms
2022-09-25 10:27:13 INFO  ---RUNTIME: Multi-Query Optimization took 76.62463188171387 ms
2022-09-25 10:27:13 INFO  Executing generated plans
2022-09-25 10:28:10 INFO  ---RUNTIME: Execution took 57075.151681900024 ms
2022-09-25 10:28:10 INFO  Done!
2022-09-25 10:28:10 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-25 10:28:10 INFO  Running instrumented original pipeline...
2022-09-25 10:28:10 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-25 10:28:10 INFO  ---RUNTIME: Importing and monkey-patching took 6.741523742675781 ms
2022-09-25 10:28:27 INFO  ---RUNTIME: Original pipeline execution took 16950.03652572632 ms (excluding imports and monkey-patching)
2022-09-25 10:28:27 INFO  Starting execution of 1 what-if analyses...
2022-09-25 10:28:27 INFO  Start plan generation for analysis DataCorruption...
2022-09-25 10:28:27 INFO  ---RUNTIME: Plan generation took 0.40841102600097656 ms
2022-09-25 10:28:27 INFO  Estimated runtime of original DAG is 16579.184532165527ms
2022-09-25 10:28:27 WARNING Skipping Multi-Query Optimization (instead, only applying patches)
2022-09-25 10:28:27 INFO  Estimated unoptimised what-if runtime is 414479.6133041382ms
2022-09-25 10:28:27 INFO  ---RUNTIME: Multi-Query Optimization took 22.116899490356445 ms
2022-09-25 10:28:27 INFO  Executing generated plans
2022-09-25 10:35:29 INFO  ---RUNTIME: Execution took 422398.5502719879 ms
2022-09-25 10:35:29 INFO  Done!
2022-09-25 10:35:30 INFO  # Finished -- repetition 4 of 7 
2022-09-25 10:35:30 INFO  # Optimization benchmark for data_corruption with args [['reviews', 'fast_loading', 'featurization_3', 'neural_network']] -- repetition 5 of 7
2022-09-25 10:35:30 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-25 10:35:30 INFO  Running instrumented original pipeline...
2022-09-25 10:35:30 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-25 10:35:30 INFO  ---RUNTIME: Importing and monkey-patching took 6.477594375610352 ms
2022-09-25 10:35:46 INFO  ---RUNTIME: Original pipeline execution took 16656.527280807495 ms (excluding imports and monkey-patching)
2022-09-25 10:35:46 INFO  Starting execution of 1 what-if analyses...
2022-09-25 10:35:46 INFO  Start plan generation for analysis DataCorruption...
2022-09-25 10:35:46 INFO  ---RUNTIME: Plan generation took 0.4303455352783203 ms
2022-09-25 10:35:46 INFO  Estimated runtime of original DAG is 16291.191816329956ms
2022-09-25 10:35:46 INFO  Performing Multi-Query Optimization
2022-09-25 10:35:46 INFO  Estimated unoptimized what-if runtime is 407279.7954082489ms
2022-09-25 10:35:46 INFO  Estimated optimised what-if runtime is 53529.691219329834ms
2022-09-25 10:35:46 INFO  Estimated optimisation runtime saving is 353750.10418891907ms
2022-09-25 10:35:46 INFO  ---RUNTIME: Multi-Query Optimization took 83.85777473449707 ms
2022-09-25 10:35:46 INFO  Executing generated plans
2022-09-25 10:36:43 INFO  ---RUNTIME: Execution took 56732.425689697266 ms
2022-09-25 10:36:43 INFO  Done!
2022-09-25 10:36:43 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-25 10:36:43 INFO  Running instrumented original pipeline...
2022-09-25 10:36:43 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-25 10:36:43 INFO  ---RUNTIME: Importing and monkey-patching took 6.382465362548828 ms
2022-09-25 10:37:00 INFO  ---RUNTIME: Original pipeline execution took 17273.89430999756 ms (excluding imports and monkey-patching)
2022-09-25 10:37:00 INFO  Starting execution of 1 what-if analyses...
2022-09-25 10:37:00 INFO  Start plan generation for analysis DataCorruption...
2022-09-25 10:37:00 INFO  ---RUNTIME: Plan generation took 7.531881332397461 ms
2022-09-25 10:37:00 INFO  Estimated runtime of original DAG is 16908.72287750244ms
2022-09-25 10:37:00 WARNING Skipping Multi-Query Optimization (instead, only applying patches)
2022-09-25 10:37:00 INFO  Estimated unoptimised what-if runtime is 422718.07193756104ms
2022-09-25 10:37:00 INFO  ---RUNTIME: Multi-Query Optimization took 22.395610809326172 ms
2022-09-25 10:37:00 INFO  Executing generated plans
2022-09-25 10:44:03 INFO  ---RUNTIME: Execution took 422440.6363964081 ms
2022-09-25 10:44:03 INFO  Done!
2022-09-25 10:44:03 INFO  # Finished -- repetition 5 of 7 
2022-09-25 10:44:03 INFO  # Optimization benchmark for data_corruption with args [['reviews', 'fast_loading', 'featurization_3', 'neural_network']] -- repetition 6 of 7
2022-09-25 10:44:03 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-25 10:44:03 INFO  Running instrumented original pipeline...
2022-09-25 10:44:03 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-25 10:44:03 INFO  ---RUNTIME: Importing and monkey-patching took 6.382226943969727 ms
2022-09-25 10:44:19 INFO  ---RUNTIME: Original pipeline execution took 16626.99031829834 ms (excluding imports and monkey-patching)
2022-09-25 10:44:19 INFO  Starting execution of 1 what-if analyses...
2022-09-25 10:44:19 INFO  Start plan generation for analysis DataCorruption...
2022-09-25 10:44:19 INFO  ---RUNTIME: Plan generation took 0.4425048828125 ms
2022-09-25 10:44:19 INFO  Estimated runtime of original DAG is 16271.437168121338ms
2022-09-25 10:44:19 INFO  Performing Multi-Query Optimization
2022-09-25 10:44:20 INFO  Estimated unoptimized what-if runtime is 406785.92920303345ms
2022-09-25 10:44:20 INFO  Estimated optimised what-if runtime is 54910.28571128845ms
2022-09-25 10:44:20 INFO  Estimated optimisation runtime saving is 351875.643491745ms
2022-09-25 10:44:20 INFO  ---RUNTIME: Multi-Query Optimization took 82.94439315795898 ms
2022-09-25 10:44:20 INFO  Executing generated plans
2022-09-25 10:45:17 INFO  ---RUNTIME: Execution took 57850.11291503906 ms
2022-09-25 10:45:17 INFO  Done!
2022-09-25 10:45:17 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-25 10:45:17 INFO  Running instrumented original pipeline...
2022-09-25 10:45:17 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-25 10:45:18 INFO  ---RUNTIME: Importing and monkey-patching took 6.203889846801758 ms
2022-09-25 10:45:34 INFO  ---RUNTIME: Original pipeline execution took 16586.01999282837 ms (excluding imports and monkey-patching)
2022-09-25 10:45:34 INFO  Starting execution of 1 what-if analyses...
2022-09-25 10:45:34 INFO  Start plan generation for analysis DataCorruption...
2022-09-25 10:45:34 INFO  ---RUNTIME: Plan generation took 0.4649162292480469 ms
2022-09-25 10:45:34 INFO  Estimated runtime of original DAG is 16217.782735824585ms
2022-09-25 10:45:34 WARNING Skipping Multi-Query Optimization (instead, only applying patches)
2022-09-25 10:45:34 INFO  Estimated unoptimised what-if runtime is 405444.5683956146ms
2022-09-25 10:45:34 INFO  ---RUNTIME: Multi-Query Optimization took 28.51557731628418 ms
2022-09-25 10:45:34 INFO  Executing generated plans
2022-09-25 10:52:36 INFO  ---RUNTIME: Execution took 421649.37949180603 ms
2022-09-25 10:52:36 INFO  Done!
2022-09-25 10:52:36 INFO  # Finished -- repetition 6 of 7 
2022-09-25 10:52:36 INFO  # Optimization benchmark for data_corruption with args [['reviews', 'fast_loading', 'featurization_3', 'neural_network']] -- repetition 7 of 7
2022-09-25 10:52:36 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-25 10:52:36 INFO  Running instrumented original pipeline...
2022-09-25 10:52:36 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-25 10:52:36 INFO  ---RUNTIME: Importing and monkey-patching took 6.334066390991211 ms
2022-09-25 10:52:53 INFO  ---RUNTIME: Original pipeline execution took 16983.500719070435 ms (excluding imports and monkey-patching)
2022-09-25 10:52:53 INFO  Starting execution of 1 what-if analyses...
2022-09-25 10:52:53 INFO  Start plan generation for analysis DataCorruption...
2022-09-25 10:52:53 INFO  ---RUNTIME: Plan generation took 0.4069805145263672 ms
2022-09-25 10:52:53 INFO  Estimated runtime of original DAG is 16635.660409927368ms
2022-09-25 10:52:53 INFO  Performing Multi-Query Optimization
2022-09-25 10:52:53 INFO  Estimated unoptimized what-if runtime is 415891.5102481842ms
2022-09-25 10:52:53 INFO  Estimated optimised what-if runtime is 52878.87787818909ms
2022-09-25 10:52:53 INFO  Estimated optimisation runtime saving is 363012.6323699951ms
2022-09-25 10:52:53 INFO  ---RUNTIME: Multi-Query Optimization took 76.88665390014648 ms
2022-09-25 10:52:53 INFO  Executing generated plans
2022-09-25 10:53:50 INFO  ---RUNTIME: Execution took 57146.28267288208 ms
2022-09-25 10:53:50 INFO  Done!
2022-09-25 10:53:50 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-25 10:53:50 INFO  Running instrumented original pipeline...
2022-09-25 10:53:50 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-25 10:53:50 INFO  ---RUNTIME: Importing and monkey-patching took 6.546497344970703 ms
2022-09-25 10:54:07 INFO  ---RUNTIME: Original pipeline execution took 16519.421100616455 ms (excluding imports and monkey-patching)
2022-09-25 10:54:07 INFO  Starting execution of 1 what-if analyses...
2022-09-25 10:54:07 INFO  Start plan generation for analysis DataCorruption...
2022-09-25 10:54:07 INFO  ---RUNTIME: Plan generation took 0.4467964172363281 ms
2022-09-25 10:54:07 INFO  Estimated runtime of original DAG is 16160.245895385742ms
2022-09-25 10:54:07 WARNING Skipping Multi-Query Optimization (instead, only applying patches)
2022-09-25 10:54:07 INFO  Estimated unoptimised what-if runtime is 404006.14738464355ms
2022-09-25 10:54:07 INFO  ---RUNTIME: Multi-Query Optimization took 27.542829513549805 ms
2022-09-25 10:54:07 INFO  Executing generated plans
2022-09-25 11:01:09 INFO  ---RUNTIME: Execution took 421927.83856391907 ms
2022-09-25 11:01:09 INFO  Done!
2022-09-25 11:01:09 INFO  # Finished -- repetition 7 of 7 
2022-09-25 11:01:09 INFO  # Final results after all repetitions
2022-09-25 11:01:09 INFO     repetition  ... no_opt_what_if_execution_combined_model_training
0           0  ...                                    146979.486942
1           1  ...                                    144935.275555
2           2  ...                                    150375.406265
3           3  ...                                    153780.808926
4           4  ...                                    154085.819960
5           5  ...                                    154491.221189
6           6  ...                                    152889.031410

[7 rows x 26 columns]
PROTOCOL_BUFFERS_PYTHON_IMPLEMENTATION=python taskset -c 32-39 python3.9 benchmarks_end_to_end.py data_corruption reviews fast_loading featurization_4 logistic_regression
2022-09-25 11:01:11.814872: W tensorflow/stream_executor/platform/default/dso_loader.cc:64] Could not load dynamic library 'libcudart.so.11.0'; dlerror: libcudart.so.11.0: cannot open shared object file: No such file or directory; LD_LIBRARY_PATH: /home/sgrafbe/mlwhatif/venv/lib/python3.9/site-packages/cv2/../../lib64:
2022-09-25 11:01:11.814914: I tensorflow/stream_executor/cuda/cudart_stub.cc:29] Ignore above cudart dlerror if you do not have a GPU set up on your machine.
2022-09-25 11:01:13 INFO  Patching sys.argv with ['mlwhatif', 'reviews', 'fast_loading', 'featurization_4', 'logistic_regression']
2022-09-25 11:01:13 INFO  Running instrumented original pipeline...
2022-09-25 11:01:13 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-25 11:01:13 INFO  ---RUNTIME: Importing and monkey-patching took 122.86710739135742 ms
2022-09-25 11:01:23 INFO  ---RUNTIME: Original pipeline execution took 9892.672061920166 ms (excluding imports and monkey-patching)
2022-09-25 11:01:23 INFO  Starting execution of 0 what-if analyses...
2022-09-25 11:01:23 INFO  Estimated runtime of original DAG is 9547.795057296753ms
2022-09-25 11:01:23 INFO  Performing Multi-Query Optimization
2022-09-25 11:01:23 INFO  Estimated unoptimized what-if runtime is 0ms
2022-09-25 11:01:23 INFO  Estimated optimised what-if runtime is 0ms
2022-09-25 11:01:23 INFO  Estimated optimisation runtime saving is 0ms
2022-09-25 11:01:23 INFO  ---RUNTIME: Multi-Query Optimization took 0.5381107330322266 ms
2022-09-25 11:01:23 INFO  Executing generated plans
2022-09-25 11:01:23 INFO  ---RUNTIME: Execution took 0.052928924560546875 ms
2022-09-25 11:01:23 INFO  Done!
2022-09-25 11:01:23 INFO  # Optimization benchmark for data_corruption with args [['reviews', 'fast_loading', 'featurization_4', 'logistic_regression']] -- repetition 1 of 7
2022-09-25 11:01:23 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-25 11:01:23 INFO  Running instrumented original pipeline...
2022-09-25 11:01:23 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-25 11:01:23 INFO  ---RUNTIME: Importing and monkey-patching took 6.2198638916015625 ms
2022-09-25 11:01:32 INFO  ---RUNTIME: Original pipeline execution took 9656.327724456787 ms (excluding imports and monkey-patching)
2022-09-25 11:01:32 INFO  Starting execution of 1 what-if analyses...
2022-09-25 11:01:32 INFO  Start plan generation for analysis DataCorruption...
2022-09-25 11:01:32 INFO  ---RUNTIME: Plan generation took 0.6971359252929688 ms
2022-09-25 11:01:32 INFO  Estimated runtime of original DAG is 9324.33295249939ms
2022-09-25 11:01:32 INFO  Performing Multi-Query Optimization
2022-09-25 11:01:32 INFO  Estimated unoptimized what-if runtime is 233108.32381248474ms
2022-09-25 11:01:32 INFO  Estimated optimised what-if runtime is 10437.570810317993ms
2022-09-25 11:01:32 INFO  Estimated optimisation runtime saving is 222670.75300216675ms
2022-09-25 11:01:32 INFO  ---RUNTIME: Multi-Query Optimization took 71.5329647064209 ms
2022-09-25 11:01:32 INFO  Executing generated plans
2022-09-25 11:01:47 INFO  ---RUNTIME: Execution took 14486.1741065979 ms
2022-09-25 11:01:47 INFO  Done!
2022-09-25 11:01:47 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-25 11:01:47 INFO  Running instrumented original pipeline...
2022-09-25 11:01:47 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-25 11:01:47 INFO  ---RUNTIME: Importing and monkey-patching took 6.481170654296875 ms
2022-09-25 11:01:57 INFO  ---RUNTIME: Original pipeline execution took 9982.310771942139 ms (excluding imports and monkey-patching)
2022-09-25 11:01:57 INFO  Starting execution of 1 what-if analyses...
2022-09-25 11:01:57 INFO  Start plan generation for analysis DataCorruption...
2022-09-25 11:01:57 INFO  ---RUNTIME: Plan generation took 0.5228519439697266 ms
2022-09-25 11:01:57 INFO  Estimated runtime of original DAG is 9463.374614715576ms
2022-09-25 11:01:57 WARNING Skipping Multi-Query Optimization (instead, only applying patches)
2022-09-25 11:01:57 INFO  Estimated unoptimised what-if runtime is 236584.3653678894ms
2022-09-25 11:01:57 INFO  ---RUNTIME: Multi-Query Optimization took 22.511005401611328 ms
2022-09-25 11:01:57 INFO  Executing generated plans
2022-09-25 11:06:08 INFO  ---RUNTIME: Execution took 250696.35200500488 ms
2022-09-25 11:06:08 INFO  Done!
2022-09-25 11:06:08 INFO  # Finished -- repetition 1 of 7 
2022-09-25 11:06:08 INFO  # Optimization benchmark for data_corruption with args [['reviews', 'fast_loading', 'featurization_4', 'logistic_regression']] -- repetition 2 of 7
2022-09-25 11:06:08 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-25 11:06:08 INFO  Running instrumented original pipeline...
2022-09-25 11:06:08 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-25 11:06:08 INFO  ---RUNTIME: Importing and monkey-patching took 6.450653076171875 ms
2022-09-25 11:06:17 INFO  ---RUNTIME: Original pipeline execution took 9581.422328948975 ms (excluding imports and monkey-patching)
2022-09-25 11:06:17 INFO  Starting execution of 1 what-if analyses...
2022-09-25 11:06:17 INFO  Start plan generation for analysis DataCorruption...
2022-09-25 11:06:17 INFO  ---RUNTIME: Plan generation took 0.7586479187011719 ms
2022-09-25 11:06:17 INFO  Estimated runtime of original DAG is 9254.99439239502ms
2022-09-25 11:06:17 INFO  Performing Multi-Query Optimization
2022-09-25 11:06:17 INFO  Estimated unoptimized what-if runtime is 231374.8598098755ms
2022-09-25 11:06:17 INFO  Estimated optimised what-if runtime is 10399.141550064087ms
2022-09-25 11:06:17 INFO  Estimated optimisation runtime saving is 220975.7182598114ms
2022-09-25 11:06:17 INFO  ---RUNTIME: Multi-Query Optimization took 69.18191909790039 ms
2022-09-25 11:06:17 INFO  Executing generated plans
2022-09-25 11:06:32 INFO  ---RUNTIME: Execution took 15054.003238677979 ms
2022-09-25 11:06:32 INFO  Done!
2022-09-25 11:06:32 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-25 11:06:32 INFO  Running instrumented original pipeline...
2022-09-25 11:06:32 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-25 11:06:32 INFO  ---RUNTIME: Importing and monkey-patching took 5.914926528930664 ms
2022-09-25 11:06:42 INFO  ---RUNTIME: Original pipeline execution took 9461.76815032959 ms (excluding imports and monkey-patching)
2022-09-25 11:06:42 INFO  Starting execution of 1 what-if analyses...
2022-09-25 11:06:42 INFO  Start plan generation for analysis DataCorruption...
2022-09-25 11:06:42 INFO  ---RUNTIME: Plan generation took 0.42557716369628906 ms
2022-09-25 11:06:42 INFO  Estimated runtime of original DAG is 9143.219232559204ms
2022-09-25 11:06:42 WARNING Skipping Multi-Query Optimization (instead, only applying patches)
2022-09-25 11:06:42 INFO  Estimated unoptimised what-if runtime is 228580.4808139801ms
2022-09-25 11:06:42 INFO  ---RUNTIME: Multi-Query Optimization took 20.48039436340332 ms
2022-09-25 11:06:42 INFO  Executing generated plans
2022-09-25 11:10:54 INFO  ---RUNTIME: Execution took 251966.8734073639 ms
2022-09-25 11:10:54 INFO  Done!
2022-09-25 11:10:54 INFO  # Finished -- repetition 2 of 7 
2022-09-25 11:10:54 INFO  # Optimization benchmark for data_corruption with args [['reviews', 'fast_loading', 'featurization_4', 'logistic_regression']] -- repetition 3 of 7
2022-09-25 11:10:54 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-25 11:10:54 INFO  Running instrumented original pipeline...
2022-09-25 11:10:54 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-25 11:10:54 INFO  ---RUNTIME: Importing and monkey-patching took 6.570577621459961 ms
2022-09-25 11:11:04 INFO  ---RUNTIME: Original pipeline execution took 9955.664873123169 ms (excluding imports and monkey-patching)
2022-09-25 11:11:04 INFO  Starting execution of 1 what-if analyses...
2022-09-25 11:11:04 INFO  Start plan generation for analysis DataCorruption...
2022-09-25 11:11:04 INFO  ---RUNTIME: Plan generation took 0.5154609680175781 ms
2022-09-25 11:11:04 INFO  Estimated runtime of original DAG is 9407.707929611206ms
2022-09-25 11:11:04 INFO  Performing Multi-Query Optimization
2022-09-25 11:11:04 INFO  Estimated unoptimized what-if runtime is 235192.69824028015ms
2022-09-25 11:11:04 INFO  Estimated optimised what-if runtime is 10645.842790603638ms
2022-09-25 11:11:04 INFO  Estimated optimisation runtime saving is 224546.8554496765ms
2022-09-25 11:11:04 INFO  ---RUNTIME: Multi-Query Optimization took 77.43120193481445 ms
2022-09-25 11:11:04 INFO  Executing generated plans
2022-09-25 11:11:19 INFO  ---RUNTIME: Execution took 15165.234088897705 ms
2022-09-25 11:11:19 INFO  Done!
2022-09-25 11:11:19 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-25 11:11:19 INFO  Running instrumented original pipeline...
2022-09-25 11:11:19 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-25 11:11:19 INFO  ---RUNTIME: Importing and monkey-patching took 6.134033203125 ms
2022-09-25 11:11:29 INFO  ---RUNTIME: Original pipeline execution took 10067.3508644104 ms (excluding imports and monkey-patching)
2022-09-25 11:11:29 INFO  Starting execution of 1 what-if analyses...
2022-09-25 11:11:29 INFO  Start plan generation for analysis DataCorruption...
2022-09-25 11:11:29 INFO  ---RUNTIME: Plan generation took 0.44155120849609375 ms
2022-09-25 11:11:29 INFO  Estimated runtime of original DAG is 9749.88317489624ms
2022-09-25 11:11:29 WARNING Skipping Multi-Query Optimization (instead, only applying patches)
2022-09-25 11:11:29 INFO  Estimated unoptimised what-if runtime is 243747.079372406ms
2022-09-25 11:11:29 INFO  ---RUNTIME: Multi-Query Optimization took 20.438194274902344 ms
2022-09-25 11:11:29 INFO  Executing generated plans
2022-09-25 11:15:38 INFO  ---RUNTIME: Execution took 249202.20398902893 ms
2022-09-25 11:15:38 INFO  Done!
2022-09-25 11:15:38 INFO  # Finished -- repetition 3 of 7 
2022-09-25 11:15:38 INFO  # Optimization benchmark for data_corruption with args [['reviews', 'fast_loading', 'featurization_4', 'logistic_regression']] -- repetition 4 of 7
2022-09-25 11:15:38 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-25 11:15:38 INFO  Running instrumented original pipeline...
2022-09-25 11:15:38 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-25 11:15:38 INFO  ---RUNTIME: Importing and monkey-patching took 6.031513214111328 ms
2022-09-25 11:15:48 INFO  ---RUNTIME: Original pipeline execution took 9797.66869544983 ms (excluding imports and monkey-patching)
2022-09-25 11:15:48 INFO  Starting execution of 1 what-if analyses...
2022-09-25 11:15:48 INFO  Start plan generation for analysis DataCorruption...
2022-09-25 11:15:48 INFO  ---RUNTIME: Plan generation took 0.43010711669921875 ms
2022-09-25 11:15:48 INFO  Estimated runtime of original DAG is 9474.833965301514ms
2022-09-25 11:15:48 INFO  Performing Multi-Query Optimization
2022-09-25 11:15:48 INFO  Estimated unoptimized what-if runtime is 236870.84913253784ms
2022-09-25 11:15:48 INFO  Estimated optimised what-if runtime is 10602.234363555908ms
2022-09-25 11:15:48 INFO  Estimated optimisation runtime saving is 226268.61476898193ms
2022-09-25 11:15:48 INFO  ---RUNTIME: Multi-Query Optimization took 68.84503364562988 ms
2022-09-25 11:15:48 INFO  Executing generated plans
2022-09-25 11:16:03 INFO  ---RUNTIME: Execution took 14593.742847442627 ms
2022-09-25 11:16:03 INFO  Done!
2022-09-25 11:16:03 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-25 11:16:03 INFO  Running instrumented original pipeline...
2022-09-25 11:16:03 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-25 11:16:03 INFO  ---RUNTIME: Importing and monkey-patching took 6.356716156005859 ms
2022-09-25 11:16:13 INFO  ---RUNTIME: Original pipeline execution took 9756.75082206726 ms (excluding imports and monkey-patching)
2022-09-25 11:16:13 INFO  Starting execution of 1 what-if analyses...
2022-09-25 11:16:13 INFO  Start plan generation for analysis DataCorruption...
2022-09-25 11:16:13 INFO  ---RUNTIME: Plan generation took 0.39839744567871094 ms
2022-09-25 11:16:13 INFO  Estimated runtime of original DAG is 9433.40802192688ms
2022-09-25 11:16:13 WARNING Skipping Multi-Query Optimization (instead, only applying patches)
2022-09-25 11:16:13 INFO  Estimated unoptimised what-if runtime is 235835.200548172ms
2022-09-25 11:16:13 INFO  ---RUNTIME: Multi-Query Optimization took 42.214393615722656 ms
2022-09-25 11:16:13 INFO  Executing generated plans
2022-09-25 11:20:17 INFO  ---RUNTIME: Execution took 244681.72812461853 ms
2022-09-25 11:20:17 INFO  Done!
2022-09-25 11:20:17 INFO  # Finished -- repetition 4 of 7 
2022-09-25 11:20:17 INFO  # Optimization benchmark for data_corruption with args [['reviews', 'fast_loading', 'featurization_4', 'logistic_regression']] -- repetition 5 of 7
2022-09-25 11:20:17 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-25 11:20:17 INFO  Running instrumented original pipeline...
2022-09-25 11:20:17 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-25 11:20:17 INFO  ---RUNTIME: Importing and monkey-patching took 5.805015563964844 ms
2022-09-25 11:20:27 INFO  ---RUNTIME: Original pipeline execution took 9452.386856079102 ms (excluding imports and monkey-patching)
2022-09-25 11:20:27 INFO  Starting execution of 1 what-if analyses...
2022-09-25 11:20:27 INFO  Start plan generation for analysis DataCorruption...
2022-09-25 11:20:27 INFO  ---RUNTIME: Plan generation took 0.4363059997558594 ms
2022-09-25 11:20:27 INFO  Estimated runtime of original DAG is 9140.541315078735ms
2022-09-25 11:20:27 INFO  Performing Multi-Query Optimization
2022-09-25 11:20:27 INFO  Estimated unoptimized what-if runtime is 228513.53287696838ms
2022-09-25 11:20:27 INFO  Estimated optimised what-if runtime is 10276.190996170044ms
2022-09-25 11:20:27 INFO  Estimated optimisation runtime saving is 218237.34188079834ms
2022-09-25 11:20:27 INFO  ---RUNTIME: Multi-Query Optimization took 68.84193420410156 ms
2022-09-25 11:20:27 INFO  Executing generated plans
2022-09-25 11:20:41 INFO  ---RUNTIME: Execution took 14208.920240402222 ms
2022-09-25 11:20:41 INFO  Done!
2022-09-25 11:20:41 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-25 11:20:41 INFO  Running instrumented original pipeline...
2022-09-25 11:20:41 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-25 11:20:41 INFO  ---RUNTIME: Importing and monkey-patching took 6.7310333251953125 ms
2022-09-25 11:20:51 INFO  ---RUNTIME: Original pipeline execution took 9654.15620803833 ms (excluding imports and monkey-patching)
2022-09-25 11:20:51 INFO  Starting execution of 1 what-if analyses...
2022-09-25 11:20:51 INFO  Start plan generation for analysis DataCorruption...
2022-09-25 11:20:51 INFO  ---RUNTIME: Plan generation took 0.3902912139892578 ms
2022-09-25 11:20:51 INFO  Estimated runtime of original DAG is 9342.53478050232ms
2022-09-25 11:20:51 WARNING Skipping Multi-Query Optimization (instead, only applying patches)
2022-09-25 11:20:51 INFO  Estimated unoptimised what-if runtime is 233563.36951255798ms
2022-09-25 11:20:51 INFO  ---RUNTIME: Multi-Query Optimization took 19.99807357788086 ms
2022-09-25 11:20:51 INFO  Executing generated plans
2022-09-25 11:24:54 INFO  ---RUNTIME: Execution took 242893.23830604553 ms
2022-09-25 11:24:54 INFO  Done!
2022-09-25 11:24:54 INFO  # Finished -- repetition 5 of 7 
2022-09-25 11:24:54 INFO  # Optimization benchmark for data_corruption with args [['reviews', 'fast_loading', 'featurization_4', 'logistic_regression']] -- repetition 6 of 7
2022-09-25 11:24:54 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-25 11:24:54 INFO  Running instrumented original pipeline...
2022-09-25 11:24:54 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-25 11:24:54 INFO  ---RUNTIME: Importing and monkey-patching took 6.146430969238281 ms
2022-09-25 11:25:03 INFO  ---RUNTIME: Original pipeline execution took 9434.152364730835 ms (excluding imports and monkey-patching)
2022-09-25 11:25:03 INFO  Starting execution of 1 what-if analyses...
2022-09-25 11:25:03 INFO  Start plan generation for analysis DataCorruption...
2022-09-25 11:25:03 INFO  ---RUNTIME: Plan generation took 0.42939186096191406 ms
2022-09-25 11:25:03 INFO  Estimated runtime of original DAG is 9121.989250183105ms
2022-09-25 11:25:03 INFO  Performing Multi-Query Optimization
2022-09-25 11:25:03 INFO  Estimated unoptimized what-if runtime is 228049.73125457764ms
2022-09-25 11:25:03 INFO  Estimated optimised what-if runtime is 10209.526300430298ms
2022-09-25 11:25:03 INFO  Estimated optimisation runtime saving is 217840.20495414734ms
2022-09-25 11:25:03 INFO  ---RUNTIME: Multi-Query Optimization took 68.33148002624512 ms
2022-09-25 11:25:03 INFO  Executing generated plans
2022-09-25 11:25:17 INFO  ---RUNTIME: Execution took 14202.366828918457 ms
2022-09-25 11:25:17 INFO  Done!
2022-09-25 11:25:17 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-25 11:25:17 INFO  Running instrumented original pipeline...
2022-09-25 11:25:17 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-25 11:25:17 INFO  ---RUNTIME: Importing and monkey-patching took 5.987644195556641 ms
2022-09-25 11:25:27 INFO  ---RUNTIME: Original pipeline execution took 9675.437211990356 ms (excluding imports and monkey-patching)
2022-09-25 11:25:27 INFO  Starting execution of 1 what-if analyses...
2022-09-25 11:25:27 INFO  Start plan generation for analysis DataCorruption...
2022-09-25 11:25:27 INFO  ---RUNTIME: Plan generation took 0.41103363037109375 ms
2022-09-25 11:25:27 INFO  Estimated runtime of original DAG is 9363.49606513977ms
2022-09-25 11:25:27 WARNING Skipping Multi-Query Optimization (instead, only applying patches)
2022-09-25 11:25:27 INFO  Estimated unoptimised what-if runtime is 234087.40162849426ms
2022-09-25 11:25:27 INFO  ---RUNTIME: Multi-Query Optimization took 20.05600929260254 ms
2022-09-25 11:25:27 INFO  Executing generated plans
2022-09-25 11:29:30 INFO  ---RUNTIME: Execution took 242663.8605594635 ms
2022-09-25 11:29:30 INFO  Done!
2022-09-25 11:29:30 INFO  # Finished -- repetition 6 of 7 
2022-09-25 11:29:30 INFO  # Optimization benchmark for data_corruption with args [['reviews', 'fast_loading', 'featurization_4', 'logistic_regression']] -- repetition 7 of 7
2022-09-25 11:29:30 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-25 11:29:30 INFO  Running instrumented original pipeline...
2022-09-25 11:29:30 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-25 11:29:30 INFO  ---RUNTIME: Importing and monkey-patching took 5.776405334472656 ms
2022-09-25 11:29:39 INFO  ---RUNTIME: Original pipeline execution took 9365.113973617554 ms (excluding imports and monkey-patching)
2022-09-25 11:29:39 INFO  Starting execution of 1 what-if analyses...
2022-09-25 11:29:39 INFO  Start plan generation for analysis DataCorruption...
2022-09-25 11:29:39 INFO  ---RUNTIME: Plan generation took 0.4413127899169922 ms
2022-09-25 11:29:39 INFO  Estimated runtime of original DAG is 9053.430318832397ms
2022-09-25 11:29:39 INFO  Performing Multi-Query Optimization
2022-09-25 11:29:39 INFO  Estimated unoptimized what-if runtime is 226335.75797080994ms
2022-09-25 11:29:39 INFO  Estimated optimised what-if runtime is 10202.951669692993ms
2022-09-25 11:29:39 INFO  Estimated optimisation runtime saving is 216132.80630111694ms
2022-09-25 11:29:39 INFO  ---RUNTIME: Multi-Query Optimization took 68.47286224365234 ms
2022-09-25 11:29:39 INFO  Executing generated plans
2022-09-25 11:29:54 INFO  ---RUNTIME: Execution took 14700.999975204468 ms
2022-09-25 11:29:54 INFO  Done!
2022-09-25 11:29:54 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-25 11:29:54 INFO  Running instrumented original pipeline...
2022-09-25 11:29:54 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-25 11:29:54 INFO  ---RUNTIME: Importing and monkey-patching took 6.158113479614258 ms
2022-09-25 11:30:03 INFO  ---RUNTIME: Original pipeline execution took 9483.79921913147 ms (excluding imports and monkey-patching)
2022-09-25 11:30:03 INFO  Starting execution of 1 what-if analyses...
2022-09-25 11:30:03 INFO  Start plan generation for analysis DataCorruption...
2022-09-25 11:30:03 INFO  ---RUNTIME: Plan generation took 0.4382133483886719 ms
2022-09-25 11:30:03 INFO  Estimated runtime of original DAG is 9165.280103683472ms
2022-09-25 11:30:03 WARNING Skipping Multi-Query Optimization (instead, only applying patches)
2022-09-25 11:30:03 INFO  Estimated unoptimised what-if runtime is 229132.0025920868ms
2022-09-25 11:30:03 INFO  ---RUNTIME: Multi-Query Optimization took 19.492149353027344 ms
2022-09-25 11:30:03 INFO  Executing generated plans
2022-09-25 11:34:09 INFO  ---RUNTIME: Execution took 245399.52206611633 ms
2022-09-25 11:34:09 INFO  Done!
2022-09-25 11:34:09 INFO  # Finished -- repetition 7 of 7 
2022-09-25 11:34:09 INFO  # Final results after all repetitions
2022-09-25 11:34:09 INFO     repetition  ... no_opt_what_if_execution_combined_model_training
0           0  ...                                      4743.698835
1           1  ...                                      4713.027477
2           2  ...                                      4681.231022
3           3  ...                                      4658.393383
4           4  ...                                      4527.636528
5           5  ...                                      4560.626030
6           6  ...                                      4568.103790

[7 rows x 26 columns]
PROTOCOL_BUFFERS_PYTHON_IMPLEMENTATION=python taskset -c 32-39 python3.9 benchmarks_end_to_end.py data_corruption reviews fast_loading featurization_4 xgboost
2022-09-25 11:34:11.762475: W tensorflow/stream_executor/platform/default/dso_loader.cc:64] Could not load dynamic library 'libcudart.so.11.0'; dlerror: libcudart.so.11.0: cannot open shared object file: No such file or directory; LD_LIBRARY_PATH: /home/sgrafbe/mlwhatif/venv/lib/python3.9/site-packages/cv2/../../lib64:
2022-09-25 11:34:11.762520: I tensorflow/stream_executor/cuda/cudart_stub.cc:29] Ignore above cudart dlerror if you do not have a GPU set up on your machine.
2022-09-25 11:34:13 INFO  Patching sys.argv with ['mlwhatif', 'reviews', 'fast_loading', 'featurization_4', 'xgboost']
2022-09-25 11:34:13 INFO  Running instrumented original pipeline...
2022-09-25 11:34:13 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-25 11:34:13 INFO  ---RUNTIME: Importing and monkey-patching took 136.91186904907227 ms
2022-09-25 11:34:35 INFO  ---RUNTIME: Original pipeline execution took 22032.72819519043 ms (excluding imports and monkey-patching)
2022-09-25 11:34:35 INFO  Starting execution of 0 what-if analyses...
2022-09-25 11:34:35 INFO  Estimated runtime of original DAG is 21664.488554000854ms
2022-09-25 11:34:35 INFO  Performing Multi-Query Optimization
2022-09-25 11:34:35 INFO  Estimated unoptimized what-if runtime is 0ms
2022-09-25 11:34:35 INFO  Estimated optimised what-if runtime is 0ms
2022-09-25 11:34:35 INFO  Estimated optimisation runtime saving is 0ms
2022-09-25 11:34:35 INFO  ---RUNTIME: Multi-Query Optimization took 0.5357265472412109 ms
2022-09-25 11:34:35 INFO  Executing generated plans
2022-09-25 11:34:35 INFO  ---RUNTIME: Execution took 0.028848648071289062 ms
2022-09-25 11:34:35 INFO  Done!
2022-09-25 11:34:35 INFO  # Optimization benchmark for data_corruption with args [['reviews', 'fast_loading', 'featurization_4', 'xgboost']] -- repetition 1 of 7
2022-09-25 11:34:35 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-25 11:34:35 INFO  Running instrumented original pipeline...
2022-09-25 11:34:35 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-25 11:34:35 INFO  ---RUNTIME: Importing and monkey-patching took 5.382537841796875 ms
2022-09-25 11:34:56 INFO  ---RUNTIME: Original pipeline execution took 21733.729600906372 ms (excluding imports and monkey-patching)
2022-09-25 11:34:56 INFO  Starting execution of 1 what-if analyses...
2022-09-25 11:34:56 INFO  Start plan generation for analysis DataCorruption...
2022-09-25 11:34:56 INFO  ---RUNTIME: Plan generation took 0.7812976837158203 ms
2022-09-25 11:34:56 INFO  Estimated runtime of original DAG is 21418.24173927307ms
2022-09-25 11:34:56 INFO  Performing Multi-Query Optimization
2022-09-25 11:34:57 INFO  Estimated unoptimized what-if runtime is 535456.0434818268ms
2022-09-25 11:34:57 INFO  Estimated optimised what-if runtime is 29740.542888641357ms
2022-09-25 11:34:57 INFO  Estimated optimisation runtime saving is 505715.5005931854ms
2022-09-25 11:34:57 INFO  ---RUNTIME: Multi-Query Optimization took 68.7558650970459 ms
2022-09-25 11:34:57 INFO  Executing generated plans
2022-09-25 11:35:30 INFO  ---RUNTIME: Execution took 33892.92645454407 ms
2022-09-25 11:35:30 INFO  Done!
2022-09-25 11:35:30 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-25 11:35:30 INFO  Running instrumented original pipeline...
2022-09-25 11:35:31 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-25 11:35:31 INFO  ---RUNTIME: Importing and monkey-patching took 5.815744400024414 ms
2022-09-25 11:35:52 INFO  ---RUNTIME: Original pipeline execution took 21971.036195755005 ms (excluding imports and monkey-patching)
2022-09-25 11:35:52 INFO  Starting execution of 1 what-if analyses...
2022-09-25 11:35:52 INFO  Start plan generation for analysis DataCorruption...
2022-09-25 11:35:52 INFO  ---RUNTIME: Plan generation took 0.45037269592285156 ms
2022-09-25 11:35:52 INFO  Estimated runtime of original DAG is 21468.429803848267ms
2022-09-25 11:35:52 WARNING Skipping Multi-Query Optimization (instead, only applying patches)
2022-09-25 11:35:52 INFO  Estimated unoptimised what-if runtime is 536710.7450962067ms
2022-09-25 11:35:52 INFO  ---RUNTIME: Multi-Query Optimization took 20.074844360351562 ms
2022-09-25 11:35:52 INFO  Executing generated plans
2022-09-25 11:45:03 INFO  ---RUNTIME: Execution took 550794.3136692047 ms
2022-09-25 11:45:03 INFO  Done!
2022-09-25 11:45:03 INFO  # Finished -- repetition 1 of 7 
2022-09-25 11:45:03 INFO  # Optimization benchmark for data_corruption with args [['reviews', 'fast_loading', 'featurization_4', 'xgboost']] -- repetition 2 of 7
2022-09-25 11:45:03 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-25 11:45:03 INFO  Running instrumented original pipeline...
2022-09-25 11:45:03 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-25 11:45:03 INFO  ---RUNTIME: Importing and monkey-patching took 6.147146224975586 ms
2022-09-25 11:45:25 INFO  ---RUNTIME: Original pipeline execution took 21817.317247390747 ms (excluding imports and monkey-patching)
2022-09-25 11:45:25 INFO  Starting execution of 1 what-if analyses...
2022-09-25 11:45:25 INFO  Start plan generation for analysis DataCorruption...
2022-09-25 11:45:25 INFO  ---RUNTIME: Plan generation took 0.7255077362060547 ms
2022-09-25 11:45:25 INFO  Estimated runtime of original DAG is 21506.043434143066ms
2022-09-25 11:45:25 INFO  Performing Multi-Query Optimization
2022-09-25 11:45:25 INFO  Estimated unoptimized what-if runtime is 537651.0858535767ms
2022-09-25 11:45:25 INFO  Estimated optimised what-if runtime is 29661.034107208252ms
2022-09-25 11:45:25 INFO  Estimated optimisation runtime saving is 507990.0517463684ms
2022-09-25 11:45:25 INFO  ---RUNTIME: Multi-Query Optimization took 68.11141967773438 ms
2022-09-25 11:45:25 INFO  Executing generated plans
2022-09-25 11:45:59 INFO  ---RUNTIME: Execution took 33894.299030303955 ms
2022-09-25 11:45:59 INFO  Done!
2022-09-25 11:45:59 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-25 11:45:59 INFO  Running instrumented original pipeline...
2022-09-25 11:45:59 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-25 11:45:59 INFO  ---RUNTIME: Importing and monkey-patching took 5.875110626220703 ms
2022-09-25 11:46:21 INFO  ---RUNTIME: Original pipeline execution took 21734.23433303833 ms (excluding imports and monkey-patching)
2022-09-25 11:46:21 INFO  Starting execution of 1 what-if analyses...
2022-09-25 11:46:21 INFO  Start plan generation for analysis DataCorruption...
2022-09-25 11:46:21 INFO  ---RUNTIME: Plan generation took 0.4718303680419922 ms
2022-09-25 11:46:21 INFO  Estimated runtime of original DAG is 21404.005765914917ms
2022-09-25 11:46:21 WARNING Skipping Multi-Query Optimization (instead, only applying patches)
2022-09-25 11:46:21 INFO  Estimated unoptimised what-if runtime is 535100.1441478729ms
2022-09-25 11:46:21 INFO  ---RUNTIME: Multi-Query Optimization took 20.162105560302734 ms
2022-09-25 11:46:21 INFO  Executing generated plans
2022-09-25 11:55:29 INFO  ---RUNTIME: Execution took 548026.8399715424 ms
2022-09-25 11:55:29 INFO  Done!
2022-09-25 11:55:29 INFO  # Finished -- repetition 2 of 7 
2022-09-25 11:55:29 INFO  # Optimization benchmark for data_corruption with args [['reviews', 'fast_loading', 'featurization_4', 'xgboost']] -- repetition 3 of 7
2022-09-25 11:55:29 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-25 11:55:29 INFO  Running instrumented original pipeline...
2022-09-25 11:55:29 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-25 11:55:29 INFO  ---RUNTIME: Importing and monkey-patching took 5.772590637207031 ms
2022-09-25 11:55:51 INFO  ---RUNTIME: Original pipeline execution took 21780.837297439575 ms (excluding imports and monkey-patching)
2022-09-25 11:55:51 INFO  Starting execution of 1 what-if analyses...
2022-09-25 11:55:51 INFO  Start plan generation for analysis DataCorruption...
2022-09-25 11:55:51 INFO  ---RUNTIME: Plan generation took 0.4754066467285156 ms
2022-09-25 11:55:51 INFO  Estimated runtime of original DAG is 21256.39295578003ms
2022-09-25 11:55:51 INFO  Performing Multi-Query Optimization
2022-09-25 11:55:51 INFO  Estimated unoptimized what-if runtime is 531409.8238945007ms
2022-09-25 11:55:51 INFO  Estimated optimised what-if runtime is 29305.06944656372ms
2022-09-25 11:55:51 INFO  Estimated optimisation runtime saving is 502104.754447937ms
2022-09-25 11:55:51 INFO  ---RUNTIME: Multi-Query Optimization took 67.37828254699707 ms
2022-09-25 11:55:51 INFO  Executing generated plans
2022-09-25 11:56:24 INFO  ---RUNTIME: Execution took 33463.31596374512 ms
2022-09-25 11:56:24 INFO  Done!
2022-09-25 11:56:24 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-25 11:56:24 INFO  Running instrumented original pipeline...
2022-09-25 11:56:24 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-25 11:56:24 INFO  ---RUNTIME: Importing and monkey-patching took 5.977869033813477 ms
2022-09-25 11:56:46 INFO  ---RUNTIME: Original pipeline execution took 21693.789958953857 ms (excluding imports and monkey-patching)
2022-09-25 11:56:46 INFO  Starting execution of 1 what-if analyses...
2022-09-25 11:56:46 INFO  Start plan generation for analysis DataCorruption...
2022-09-25 11:56:46 INFO  ---RUNTIME: Plan generation took 0.4456043243408203 ms
2022-09-25 11:56:46 INFO  Estimated runtime of original DAG is 21381.62350654602ms
2022-09-25 11:56:46 WARNING Skipping Multi-Query Optimization (instead, only applying patches)
2022-09-25 11:56:46 INFO  Estimated unoptimised what-if runtime is 534540.5876636505ms
2022-09-25 11:56:46 INFO  ---RUNTIME: Multi-Query Optimization took 19.83642578125 ms
2022-09-25 11:56:46 INFO  Executing generated plans
2022-09-25 12:05:53 INFO  ---RUNTIME: Execution took 547400.1641273499 ms
2022-09-25 12:05:53 INFO  Done!
2022-09-25 12:05:53 INFO  # Finished -- repetition 3 of 7 
2022-09-25 12:05:53 INFO  # Optimization benchmark for data_corruption with args [['reviews', 'fast_loading', 'featurization_4', 'xgboost']] -- repetition 4 of 7
2022-09-25 12:05:53 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-25 12:05:53 INFO  Running instrumented original pipeline...
2022-09-25 12:05:53 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-25 12:05:53 INFO  ---RUNTIME: Importing and monkey-patching took 5.809783935546875 ms
2022-09-25 12:06:15 INFO  ---RUNTIME: Original pipeline execution took 21694.908142089844 ms (excluding imports and monkey-patching)
2022-09-25 12:06:15 INFO  Starting execution of 1 what-if analyses...
2022-09-25 12:06:15 INFO  Start plan generation for analysis DataCorruption...
2022-09-25 12:06:15 INFO  ---RUNTIME: Plan generation took 0.4711151123046875 ms
2022-09-25 12:06:15 INFO  Estimated runtime of original DAG is 21384.72843170166ms
2022-09-25 12:06:15 INFO  Performing Multi-Query Optimization
2022-09-25 12:06:15 INFO  Estimated unoptimized what-if runtime is 534618.2107925415ms
2022-09-25 12:06:15 INFO  Estimated optimised what-if runtime is 29520.10178565979ms
2022-09-25 12:06:15 INFO  Estimated optimisation runtime saving is 505098.1090068817ms
2022-09-25 12:06:15 INFO  ---RUNTIME: Multi-Query Optimization took 67.25454330444336 ms
2022-09-25 12:06:15 INFO  Executing generated plans
2022-09-25 12:06:48 INFO  ---RUNTIME: Execution took 33313.41528892517 ms
2022-09-25 12:06:48 INFO  Done!
2022-09-25 12:06:48 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-25 12:06:48 INFO  Running instrumented original pipeline...
2022-09-25 12:06:48 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-25 12:06:48 INFO  ---RUNTIME: Importing and monkey-patching took 6.087303161621094 ms
2022-09-25 12:07:10 INFO  ---RUNTIME: Original pipeline execution took 21757.98225402832 ms (excluding imports and monkey-patching)
2022-09-25 12:07:10 INFO  Starting execution of 1 what-if analyses...
2022-09-25 12:07:10 INFO  Start plan generation for analysis DataCorruption...
2022-09-25 12:07:10 INFO  ---RUNTIME: Plan generation took 0.45299530029296875 ms
2022-09-25 12:07:10 INFO  Estimated runtime of original DAG is 21445.026636123657ms
2022-09-25 12:07:10 WARNING Skipping Multi-Query Optimization (instead, only applying patches)
2022-09-25 12:07:10 INFO  Estimated unoptimised what-if runtime is 536125.6659030914ms
2022-09-25 12:07:10 INFO  ---RUNTIME: Multi-Query Optimization took 19.71888542175293 ms
2022-09-25 12:07:10 INFO  Executing generated plans
2022-09-25 12:16:17 INFO  ---RUNTIME: Execution took 546814.3727779388 ms
2022-09-25 12:16:17 INFO  Done!
2022-09-25 12:16:17 INFO  # Finished -- repetition 4 of 7 
2022-09-25 12:16:17 INFO  # Optimization benchmark for data_corruption with args [['reviews', 'fast_loading', 'featurization_4', 'xgboost']] -- repetition 5 of 7
2022-09-25 12:16:17 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-25 12:16:17 INFO  Running instrumented original pipeline...
2022-09-25 12:16:17 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-25 12:16:17 INFO  ---RUNTIME: Importing and monkey-patching took 6.551980972290039 ms
2022-09-25 12:16:39 INFO  ---RUNTIME: Original pipeline execution took 21498.6093044281 ms (excluding imports and monkey-patching)
2022-09-25 12:16:39 INFO  Starting execution of 1 what-if analyses...
2022-09-25 12:16:39 INFO  Start plan generation for analysis DataCorruption...
2022-09-25 12:16:39 INFO  ---RUNTIME: Plan generation took 0.45990943908691406 ms
2022-09-25 12:16:39 INFO  Estimated runtime of original DAG is 21188.756704330444ms
2022-09-25 12:16:39 INFO  Performing Multi-Query Optimization
2022-09-25 12:16:39 INFO  Estimated unoptimized what-if runtime is 529718.9176082611ms
2022-09-25 12:16:39 INFO  Estimated optimised what-if runtime is 29383.734226226807ms
2022-09-25 12:16:39 INFO  Estimated optimisation runtime saving is 500335.1833820343ms
2022-09-25 12:16:39 INFO  ---RUNTIME: Multi-Query Optimization took 66.87736511230469 ms
2022-09-25 12:16:39 INFO  Executing generated plans
2022-09-25 12:17:12 INFO  ---RUNTIME: Execution took 33599.754095077515 ms
2022-09-25 12:17:12 INFO  Done!
2022-09-25 12:17:12 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-25 12:17:12 INFO  Running instrumented original pipeline...
2022-09-25 12:17:12 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-25 12:17:12 INFO  ---RUNTIME: Importing and monkey-patching took 6.604909896850586 ms
2022-09-25 12:17:34 INFO  ---RUNTIME: Original pipeline execution took 21713.223218917847 ms (excluding imports and monkey-patching)
2022-09-25 12:17:34 INFO  Starting execution of 1 what-if analyses...
2022-09-25 12:17:34 INFO  Start plan generation for analysis DataCorruption...
2022-09-25 12:17:34 INFO  ---RUNTIME: Plan generation took 0.5879402160644531 ms
2022-09-25 12:17:34 INFO  Estimated runtime of original DAG is 21402.836561203003ms
2022-09-25 12:17:34 WARNING Skipping Multi-Query Optimization (instead, only applying patches)
2022-09-25 12:17:34 INFO  Estimated unoptimised what-if runtime is 535070.9140300751ms
2022-09-25 12:17:34 INFO  ---RUNTIME: Multi-Query Optimization took 19.353151321411133 ms
2022-09-25 12:17:34 INFO  Executing generated plans
2022-09-25 12:26:41 INFO  ---RUNTIME: Execution took 546993.6435222626 ms
2022-09-25 12:26:41 INFO  Done!
2022-09-25 12:26:41 INFO  # Finished -- repetition 5 of 7 
2022-09-25 12:26:41 INFO  # Optimization benchmark for data_corruption with args [['reviews', 'fast_loading', 'featurization_4', 'xgboost']] -- repetition 6 of 7
2022-09-25 12:26:41 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-25 12:26:41 INFO  Running instrumented original pipeline...
2022-09-25 12:26:41 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-25 12:26:41 INFO  ---RUNTIME: Importing and monkey-patching took 5.875825881958008 ms
2022-09-25 12:27:03 INFO  ---RUNTIME: Original pipeline execution took 21620.627641677856 ms (excluding imports and monkey-patching)
2022-09-25 12:27:03 INFO  Starting execution of 1 what-if analyses...
2022-09-25 12:27:03 INFO  Start plan generation for analysis DataCorruption...
2022-09-25 12:27:03 INFO  ---RUNTIME: Plan generation took 0.4608631134033203 ms
2022-09-25 12:27:03 INFO  Estimated runtime of original DAG is 21306.03790283203ms
2022-09-25 12:27:03 INFO  Performing Multi-Query Optimization
2022-09-25 12:27:03 INFO  Estimated unoptimized what-if runtime is 532650.9475708008ms
2022-09-25 12:27:03 INFO  Estimated optimised what-if runtime is 29441.014051437378ms
2022-09-25 12:27:03 INFO  Estimated optimisation runtime saving is 503209.9335193634ms
2022-09-25 12:27:03 INFO  ---RUNTIME: Multi-Query Optimization took 67.05403327941895 ms
2022-09-25 12:27:03 INFO  Executing generated plans
2022-09-25 12:27:36 INFO  ---RUNTIME: Execution took 33308.9964389801 ms
2022-09-25 12:27:36 INFO  Done!
2022-09-25 12:27:36 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-25 12:27:36 INFO  Running instrumented original pipeline...
2022-09-25 12:27:36 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-25 12:27:36 INFO  ---RUNTIME: Importing and monkey-patching took 6.11114501953125 ms
2022-09-25 12:27:58 INFO  ---RUNTIME: Original pipeline execution took 21837.68343925476 ms (excluding imports and monkey-patching)
2022-09-25 12:27:58 INFO  Starting execution of 1 what-if analyses...
2022-09-25 12:27:58 INFO  Start plan generation for analysis DataCorruption...
2022-09-25 12:27:58 INFO  ---RUNTIME: Plan generation took 0.42724609375 ms
2022-09-25 12:27:58 INFO  Estimated runtime of original DAG is 21523.80132675171ms
2022-09-25 12:27:58 WARNING Skipping Multi-Query Optimization (instead, only applying patches)
2022-09-25 12:27:58 INFO  Estimated unoptimised what-if runtime is 538095.0331687927ms
2022-09-25 12:27:58 INFO  ---RUNTIME: Multi-Query Optimization took 19.799232482910156 ms
2022-09-25 12:27:58 INFO  Executing generated plans
2022-09-25 12:37:05 INFO  ---RUNTIME: Execution took 546901.3650417328 ms
2022-09-25 12:37:05 INFO  Done!
2022-09-25 12:37:05 INFO  # Finished -- repetition 6 of 7 
2022-09-25 12:37:05 INFO  # Optimization benchmark for data_corruption with args [['reviews', 'fast_loading', 'featurization_4', 'xgboost']] -- repetition 7 of 7
2022-09-25 12:37:05 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-25 12:37:05 INFO  Running instrumented original pipeline...
2022-09-25 12:37:05 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-25 12:37:05 INFO  ---RUNTIME: Importing and monkey-patching took 6.2808990478515625 ms
2022-09-25 12:37:26 INFO  ---RUNTIME: Original pipeline execution took 21605.068922042847 ms (excluding imports and monkey-patching)
2022-09-25 12:37:26 INFO  Starting execution of 1 what-if analyses...
2022-09-25 12:37:26 INFO  Start plan generation for analysis DataCorruption...
2022-09-25 12:37:26 INFO  ---RUNTIME: Plan generation took 0.4494190216064453 ms
2022-09-25 12:37:26 INFO  Estimated runtime of original DAG is 21291.744470596313ms
2022-09-25 12:37:26 INFO  Performing Multi-Query Optimization
2022-09-25 12:37:27 INFO  Estimated unoptimized what-if runtime is 532293.6117649078ms
2022-09-25 12:37:27 INFO  Estimated optimised what-if runtime is 29439.99695777893ms
2022-09-25 12:37:27 INFO  Estimated optimisation runtime saving is 502853.6148071289ms
2022-09-25 12:37:27 INFO  ---RUNTIME: Multi-Query Optimization took 67.08335876464844 ms
2022-09-25 12:37:27 INFO  Executing generated plans
2022-09-25 12:38:00 INFO  ---RUNTIME: Execution took 33372.286319732666 ms
2022-09-25 12:38:00 INFO  Done!
2022-09-25 12:38:00 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-25 12:38:00 INFO  Running instrumented original pipeline...
2022-09-25 12:38:00 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-25 12:38:00 INFO  ---RUNTIME: Importing and monkey-patching took 6.087064743041992 ms
2022-09-25 12:38:22 INFO  ---RUNTIME: Original pipeline execution took 21683.885097503662 ms (excluding imports and monkey-patching)
2022-09-25 12:38:22 INFO  Starting execution of 1 what-if analyses...
2022-09-25 12:38:22 INFO  Start plan generation for analysis DataCorruption...
2022-09-25 12:38:22 INFO  ---RUNTIME: Plan generation took 0.438690185546875 ms
2022-09-25 12:38:22 INFO  Estimated runtime of original DAG is 21370.50437927246ms
2022-09-25 12:38:22 WARNING Skipping Multi-Query Optimization (instead, only applying patches)
2022-09-25 12:38:22 INFO  Estimated unoptimised what-if runtime is 534262.6094818115ms
2022-09-25 12:38:22 INFO  ---RUNTIME: Multi-Query Optimization took 19.780874252319336 ms
2022-09-25 12:38:22 INFO  Executing generated plans
2022-09-25 12:47:28 INFO  ---RUNTIME: Execution took 546728.6050319672 ms
2022-09-25 12:47:28 INFO  Done!
2022-09-25 12:47:28 INFO  # Finished -- repetition 7 of 7 
2022-09-25 12:47:28 INFO  # Final results after all repetitions
2022-09-25 12:47:28 INFO     repetition  ... no_opt_what_if_execution_combined_model_training
0           0  ...                                    302374.577761
1           1  ...                                    301116.321325
2           2  ...                                    300905.351162
3           3  ...                                    300984.143734
4           4  ...                                    301059.299707
5           5  ...                                    300976.411581
6           6  ...                                    301070.773602

[7 rows x 26 columns]
PROTOCOL_BUFFERS_PYTHON_IMPLEMENTATION=python taskset -c 32-39 python3.9 benchmarks_end_to_end.py data_corruption reviews fast_loading featurization_4 neural_network
2022-09-25 12:47:31.101749: W tensorflow/stream_executor/platform/default/dso_loader.cc:64] Could not load dynamic library 'libcudart.so.11.0'; dlerror: libcudart.so.11.0: cannot open shared object file: No such file or directory; LD_LIBRARY_PATH: /home/sgrafbe/mlwhatif/venv/lib/python3.9/site-packages/cv2/../../lib64:
2022-09-25 12:47:31.101798: I tensorflow/stream_executor/cuda/cudart_stub.cc:29] Ignore above cudart dlerror if you do not have a GPU set up on your machine.
2022-09-25 12:47:32 INFO  Patching sys.argv with ['mlwhatif', 'reviews', 'fast_loading', 'featurization_4', 'neural_network']
2022-09-25 12:47:32 INFO  Running instrumented original pipeline...
2022-09-25 12:47:32 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-25 12:47:32 INFO  ---RUNTIME: Importing and monkey-patching took 122.05815315246582 ms
2022-09-25 12:47:42.485286: W tensorflow/stream_executor/platform/default/dso_loader.cc:64] Could not load dynamic library 'libcuda.so.1'; dlerror: libcuda.so.1: cannot open shared object file: No such file or directory; LD_LIBRARY_PATH: /home/sgrafbe/mlwhatif/venv/lib/python3.9/site-packages/cv2/../../lib64:
2022-09-25 12:47:42.485321: W tensorflow/stream_executor/cuda/cuda_driver.cc:326] failed call to cuInit: UNKNOWN ERROR (303)
2022-09-25 12:47:42.485348: I tensorflow/stream_executor/cuda/cuda_diagnostics.cc:156] kernel driver does not appear to be running on this host (angus): /proc/driver/nvidia/version does not exist
2022-09-25 12:47:42.485827: I tensorflow/core/platform/cpu_feature_guard.cc:142] This TensorFlow binary is optimized with oneAPI Deep Neural Network Library (oneDNN) to use the following CPU instructions in performance-critical operations:  AVX2 FMA
To enable them in other operations, rebuild TensorFlow with the appropriate compiler flags.
2022-09-25 12:47:42.561498: I tensorflow/compiler/mlir/mlir_graph_optimization_pass.cc:176] None of the MLIR Optimization Passes are enabled (registered 2)
2022-09-25 12:47:42.573179: I tensorflow/core/platform/profile_utils/cpu_utils.cc:114] CPU Frequency: 2595130000 Hz
2022-09-25 12:47:46 INFO  ---RUNTIME: Original pipeline execution took 13993.536949157715 ms (excluding imports and monkey-patching)
2022-09-25 12:47:46 INFO  Starting execution of 0 what-if analyses...
2022-09-25 12:47:46 INFO  Estimated runtime of original DAG is 13638.36646080017ms
2022-09-25 12:47:46 INFO  Performing Multi-Query Optimization
2022-09-25 12:47:46 INFO  Estimated unoptimized what-if runtime is 0ms
2022-09-25 12:47:46 INFO  Estimated optimised what-if runtime is 0ms
2022-09-25 12:47:46 INFO  Estimated optimisation runtime saving is 0ms
2022-09-25 12:47:46 INFO  ---RUNTIME: Multi-Query Optimization took 0.5307197570800781 ms
2022-09-25 12:47:46 INFO  Executing generated plans
2022-09-25 12:47:46 INFO  ---RUNTIME: Execution took 0.02288818359375 ms
2022-09-25 12:47:46 INFO  Done!
2022-09-25 12:47:46 INFO  # Optimization benchmark for data_corruption with args [['reviews', 'fast_loading', 'featurization_4', 'neural_network']] -- repetition 1 of 7
2022-09-25 12:47:46 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-25 12:47:46 INFO  Running instrumented original pipeline...
2022-09-25 12:47:46 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-25 12:47:46 INFO  ---RUNTIME: Importing and monkey-patching took 5.823850631713867 ms
2022-09-25 12:47:59 INFO  ---RUNTIME: Original pipeline execution took 13383.684873580933 ms (excluding imports and monkey-patching)
2022-09-25 12:47:59 INFO  Starting execution of 1 what-if analyses...
2022-09-25 12:47:59 INFO  Start plan generation for analysis DataCorruption...
2022-09-25 12:47:59 INFO  ---RUNTIME: Plan generation took 0.38313865661621094 ms
2022-09-25 12:47:59 INFO  Estimated runtime of original DAG is 13059.563159942627ms
2022-09-25 12:47:59 INFO  Performing Multi-Query Optimization
2022-09-25 12:47:59 INFO  Estimated unoptimized what-if runtime is 326489.0789985657ms
2022-09-25 12:47:59 INFO  Estimated optimised what-if runtime is 24730.085849761963ms
2022-09-25 12:47:59 INFO  Estimated optimisation runtime saving is 301758.9931488037ms
2022-09-25 12:47:59 INFO  ---RUNTIME: Multi-Query Optimization took 70.7850456237793 ms
2022-09-25 12:47:59 INFO  Executing generated plans
2022-09-25 12:48:27 INFO  ---RUNTIME: Execution took 27214.358806610107 ms
2022-09-25 12:48:27 INFO  Done!
2022-09-25 12:48:27 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-25 12:48:27 INFO  Running instrumented original pipeline...
2022-09-25 12:48:27 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-25 12:48:27 INFO  ---RUNTIME: Importing and monkey-patching took 6.35981559753418 ms
2022-09-25 12:48:40 INFO  ---RUNTIME: Original pipeline execution took 13441.331624984741 ms (excluding imports and monkey-patching)
2022-09-25 12:48:40 INFO  Starting execution of 1 what-if analyses...
2022-09-25 12:48:40 INFO  Start plan generation for analysis DataCorruption...
2022-09-25 12:48:40 INFO  ---RUNTIME: Plan generation took 0.5161762237548828 ms
2022-09-25 12:48:40 INFO  Estimated runtime of original DAG is 13118.556261062622ms
2022-09-25 12:48:40 WARNING Skipping Multi-Query Optimization (instead, only applying patches)
2022-09-25 12:48:40 INFO  Estimated unoptimised what-if runtime is 327963.90652656555ms
2022-09-25 12:48:40 INFO  ---RUNTIME: Multi-Query Optimization took 21.121740341186523 ms
2022-09-25 12:48:40 INFO  Executing generated plans
2022-09-25 12:54:17 INFO  ---RUNTIME: Execution took 337046.55146598816 ms
2022-09-25 12:54:17 INFO  Done!
2022-09-25 12:54:17 INFO  # Finished -- repetition 1 of 7 
2022-09-25 12:54:17 INFO  # Optimization benchmark for data_corruption with args [['reviews', 'fast_loading', 'featurization_4', 'neural_network']] -- repetition 2 of 7
2022-09-25 12:54:17 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-25 12:54:17 INFO  Running instrumented original pipeline...
2022-09-25 12:54:17 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-25 12:54:17 INFO  ---RUNTIME: Importing and monkey-patching took 6.170034408569336 ms
2022-09-25 12:54:30 INFO  ---RUNTIME: Original pipeline execution took 13156.247615814209 ms (excluding imports and monkey-patching)
2022-09-25 12:54:30 INFO  Starting execution of 1 what-if analyses...
2022-09-25 12:54:30 INFO  Start plan generation for analysis DataCorruption...
2022-09-25 12:54:30 INFO  ---RUNTIME: Plan generation took 0.4475116729736328 ms
2022-09-25 12:54:30 INFO  Estimated runtime of original DAG is 12835.833072662354ms
2022-09-25 12:54:30 INFO  Performing Multi-Query Optimization
2022-09-25 12:54:30 INFO  Estimated unoptimized what-if runtime is 320895.82681655884ms
2022-09-25 12:54:30 INFO  Estimated optimised what-if runtime is 23332.101106643677ms
2022-09-25 12:54:30 INFO  Estimated optimisation runtime saving is 297563.72570991516ms
2022-09-25 12:54:30 INFO  ---RUNTIME: Multi-Query Optimization took 70.71900367736816 ms
2022-09-25 12:54:30 INFO  Executing generated plans
2022-09-25 12:54:57 INFO  ---RUNTIME: Execution took 27046.010971069336 ms
2022-09-25 12:54:57 INFO  Done!
2022-09-25 12:54:58 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-25 12:54:58 INFO  Running instrumented original pipeline...
2022-09-25 12:54:58 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-25 12:54:58 INFO  ---RUNTIME: Importing and monkey-patching took 9.415864944458008 ms
2022-09-25 12:55:11 INFO  ---RUNTIME: Original pipeline execution took 13586.40170097351 ms (excluding imports and monkey-patching)
2022-09-25 12:55:11 INFO  Starting execution of 1 what-if analyses...
2022-09-25 12:55:11 INFO  Start plan generation for analysis DataCorruption...
2022-09-25 12:55:11 INFO  ---RUNTIME: Plan generation took 0.4184246063232422 ms
2022-09-25 12:55:11 INFO  Estimated runtime of original DAG is 12963.888168334961ms
2022-09-25 12:55:11 WARNING Skipping Multi-Query Optimization (instead, only applying patches)
2022-09-25 12:55:11 INFO  Estimated unoptimised what-if runtime is 324097.204208374ms
2022-09-25 12:55:11 INFO  ---RUNTIME: Multi-Query Optimization took 21.797657012939453 ms
2022-09-25 12:55:11 INFO  Executing generated plans
2022-09-25 13:00:48 INFO  ---RUNTIME: Execution took 337322.5157260895 ms
2022-09-25 13:00:48 INFO  Done!
2022-09-25 13:00:48 INFO  # Finished -- repetition 2 of 7 
2022-09-25 13:00:48 INFO  # Optimization benchmark for data_corruption with args [['reviews', 'fast_loading', 'featurization_4', 'neural_network']] -- repetition 3 of 7
2022-09-25 13:00:48 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-25 13:00:48 INFO  Running instrumented original pipeline...
2022-09-25 13:00:49 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-25 13:00:49 INFO  ---RUNTIME: Importing and monkey-patching took 7.346630096435547 ms
2022-09-25 13:01:02 INFO  ---RUNTIME: Original pipeline execution took 13307.896614074707 ms (excluding imports and monkey-patching)
2022-09-25 13:01:02 INFO  Starting execution of 1 what-if analyses...
2022-09-25 13:01:02 INFO  Start plan generation for analysis DataCorruption...
2022-09-25 13:01:02 INFO  ---RUNTIME: Plan generation took 0.43702125549316406 ms
2022-09-25 13:01:02 INFO  Estimated runtime of original DAG is 12979.289054870605ms
2022-09-25 13:01:02 INFO  Performing Multi-Query Optimization
2022-09-25 13:01:02 INFO  Estimated unoptimized what-if runtime is 324482.22637176514ms
2022-09-25 13:01:02 INFO  Estimated optimised what-if runtime is 23644.440412521362ms
2022-09-25 13:01:02 INFO  Estimated optimisation runtime saving is 300837.7859592438ms
2022-09-25 13:01:02 INFO  ---RUNTIME: Multi-Query Optimization took 72.47066497802734 ms
2022-09-25 13:01:02 INFO  Executing generated plans
2022-09-25 13:01:29 INFO  ---RUNTIME: Execution took 27443.968296051025 ms
2022-09-25 13:01:29 INFO  Done!
2022-09-25 13:01:29 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-25 13:01:29 INFO  Running instrumented original pipeline...
2022-09-25 13:01:29 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-25 13:01:29 INFO  ---RUNTIME: Importing and monkey-patching took 6.247997283935547 ms
2022-09-25 13:01:43 INFO  ---RUNTIME: Original pipeline execution took 13234.972953796387 ms (excluding imports and monkey-patching)
2022-09-25 13:01:43 INFO  Starting execution of 1 what-if analyses...
2022-09-25 13:01:43 INFO  Start plan generation for analysis DataCorruption...
2022-09-25 13:01:43 INFO  ---RUNTIME: Plan generation took 2.1588802337646484 ms
2022-09-25 13:01:43 INFO  Estimated runtime of original DAG is 12913.7544631958ms
2022-09-25 13:01:43 WARNING Skipping Multi-Query Optimization (instead, only applying patches)
2022-09-25 13:01:43 INFO  Estimated unoptimised what-if runtime is 322843.861579895ms
2022-09-25 13:01:43 INFO  ---RUNTIME: Multi-Query Optimization took 19.85025405883789 ms
2022-09-25 13:01:43 INFO  Executing generated plans
2022-09-25 13:07:20 INFO  ---RUNTIME: Execution took 337659.5706939697 ms
2022-09-25 13:07:20 INFO  Done!
2022-09-25 13:07:20 INFO  # Finished -- repetition 3 of 7 
2022-09-25 13:07:20 INFO  # Optimization benchmark for data_corruption with args [['reviews', 'fast_loading', 'featurization_4', 'neural_network']] -- repetition 4 of 7
2022-09-25 13:07:20 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-25 13:07:20 INFO  Running instrumented original pipeline...
2022-09-25 13:07:20 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-25 13:07:20 INFO  ---RUNTIME: Importing and monkey-patching took 5.975484848022461 ms
2022-09-25 13:07:34 INFO  ---RUNTIME: Original pipeline execution took 13224.971294403076 ms (excluding imports and monkey-patching)
2022-09-25 13:07:34 INFO  Starting execution of 1 what-if analyses...
2022-09-25 13:07:34 INFO  Start plan generation for analysis DataCorruption...
2022-09-25 13:07:34 INFO  ---RUNTIME: Plan generation took 0.47969818115234375 ms
2022-09-25 13:07:34 INFO  Estimated runtime of original DAG is 12900.09093284607ms
2022-09-25 13:07:34 INFO  Performing Multi-Query Optimization
2022-09-25 13:07:34 INFO  Estimated unoptimized what-if runtime is 322502.27332115173ms
2022-09-25 13:07:34 INFO  Estimated optimised what-if runtime is 24245.188236236572ms
2022-09-25 13:07:34 INFO  Estimated optimisation runtime saving is 298257.08508491516ms
2022-09-25 13:07:34 INFO  ---RUNTIME: Multi-Query Optimization took 71.19965553283691 ms
2022-09-25 13:07:34 INFO  Executing generated plans
2022-09-25 13:08:01 INFO  ---RUNTIME: Execution took 27299.73840713501 ms
2022-09-25 13:08:01 INFO  Done!
2022-09-25 13:08:01 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-25 13:08:01 INFO  Running instrumented original pipeline...
2022-09-25 13:08:01 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-25 13:08:01 INFO  ---RUNTIME: Importing and monkey-patching took 6.348848342895508 ms
2022-09-25 13:08:14 INFO  ---RUNTIME: Original pipeline execution took 13149.465799331665 ms (excluding imports and monkey-patching)
2022-09-25 13:08:14 INFO  Starting execution of 1 what-if analyses...
2022-09-25 13:08:14 INFO  Start plan generation for analysis DataCorruption...
2022-09-25 13:08:14 INFO  ---RUNTIME: Plan generation took 0.4048347473144531 ms
2022-09-25 13:08:14 INFO  Estimated runtime of original DAG is 12830.52396774292ms
2022-09-25 13:08:14 WARNING Skipping Multi-Query Optimization (instead, only applying patches)
2022-09-25 13:08:14 INFO  Estimated unoptimised what-if runtime is 320763.099193573ms
2022-09-25 13:08:14 INFO  ---RUNTIME: Multi-Query Optimization took 20.40696144104004 ms
2022-09-25 13:08:14 INFO  Executing generated plans
2022-09-25 13:13:51 INFO  ---RUNTIME: Execution took 336889.15038108826 ms
2022-09-25 13:13:51 INFO  Done!
2022-09-25 13:13:51 INFO  # Finished -- repetition 4 of 7 
2022-09-25 13:13:51 INFO  # Optimization benchmark for data_corruption with args [['reviews', 'fast_loading', 'featurization_4', 'neural_network']] -- repetition 5 of 7
2022-09-25 13:13:51 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-25 13:13:51 INFO  Running instrumented original pipeline...
2022-09-25 13:13:51 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-25 13:13:51 INFO  ---RUNTIME: Importing and monkey-patching took 6.304025650024414 ms
2022-09-25 13:14:05 INFO  ---RUNTIME: Original pipeline execution took 13582.294940948486 ms (excluding imports and monkey-patching)
2022-09-25 13:14:05 INFO  Starting execution of 1 what-if analyses...
2022-09-25 13:14:05 INFO  Start plan generation for analysis DataCorruption...
2022-09-25 13:14:05 INFO  ---RUNTIME: Plan generation took 0.44798851013183594 ms
2022-09-25 13:14:05 INFO  Estimated runtime of original DAG is 13258.978128433228ms
2022-09-25 13:14:05 INFO  Performing Multi-Query Optimization
2022-09-25 13:14:05 INFO  Estimated unoptimized what-if runtime is 331474.4532108307ms
2022-09-25 13:14:05 INFO  Estimated optimised what-if runtime is 23853.291034698486ms
2022-09-25 13:14:05 INFO  Estimated optimisation runtime saving is 307621.1621761322ms
2022-09-25 13:14:05 INFO  ---RUNTIME: Multi-Query Optimization took 69.17381286621094 ms
2022-09-25 13:14:05 INFO  Executing generated plans
2022-09-25 13:14:32 INFO  ---RUNTIME: Execution took 26902.86111831665 ms
2022-09-25 13:14:32 INFO  Done!
2022-09-25 13:14:32 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-25 13:14:32 INFO  Running instrumented original pipeline...
2022-09-25 13:14:32 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-25 13:14:32 INFO  ---RUNTIME: Importing and monkey-patching took 6.398439407348633 ms
2022-09-25 13:14:45 INFO  ---RUNTIME: Original pipeline execution took 13251.590013504028 ms (excluding imports and monkey-patching)
2022-09-25 13:14:45 INFO  Starting execution of 1 what-if analyses...
2022-09-25 13:14:45 INFO  Start plan generation for analysis DataCorruption...
2022-09-25 13:14:45 INFO  ---RUNTIME: Plan generation took 0.4372596740722656 ms
2022-09-25 13:14:45 INFO  Estimated runtime of original DAG is 12923.95806312561ms
2022-09-25 13:14:45 WARNING Skipping Multi-Query Optimization (instead, only applying patches)
2022-09-25 13:14:45 INFO  Estimated unoptimised what-if runtime is 323098.95157814026ms
2022-09-25 13:14:45 INFO  ---RUNTIME: Multi-Query Optimization took 369.962215423584 ms
2022-09-25 13:14:45 INFO  Executing generated plans
2022-09-25 13:20:21 INFO  ---RUNTIME: Execution took 336253.2560825348 ms
2022-09-25 13:20:21 INFO  Done!
2022-09-25 13:20:21 INFO  # Finished -- repetition 5 of 7 
2022-09-25 13:20:21 INFO  # Optimization benchmark for data_corruption with args [['reviews', 'fast_loading', 'featurization_4', 'neural_network']] -- repetition 6 of 7
2022-09-25 13:20:21 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-25 13:20:21 INFO  Running instrumented original pipeline...
2022-09-25 13:20:22 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-25 13:20:22 INFO  ---RUNTIME: Importing and monkey-patching took 6.063222885131836 ms
2022-09-25 13:20:35 INFO  ---RUNTIME: Original pipeline execution took 13072.272539138794 ms (excluding imports and monkey-patching)
2022-09-25 13:20:35 INFO  Starting execution of 1 what-if analyses...
2022-09-25 13:20:35 INFO  Start plan generation for analysis DataCorruption...
2022-09-25 13:20:35 INFO  ---RUNTIME: Plan generation took 0.43010711669921875 ms
2022-09-25 13:20:35 INFO  Estimated runtime of original DAG is 12745.522260665894ms
2022-09-25 13:20:35 INFO  Performing Multi-Query Optimization
2022-09-25 13:20:35 INFO  Estimated unoptimized what-if runtime is 318638.05651664734ms
2022-09-25 13:20:35 INFO  Estimated optimised what-if runtime is 23292.532920837402ms
2022-09-25 13:20:35 INFO  Estimated optimisation runtime saving is 295345.52359580994ms
2022-09-25 13:20:35 INFO  ---RUNTIME: Multi-Query Optimization took 68.2058334350586 ms
2022-09-25 13:20:35 INFO  Executing generated plans
2022-09-25 13:21:01 INFO  ---RUNTIME: Execution took 26785.52508354187 ms
2022-09-25 13:21:01 INFO  Done!
2022-09-25 13:21:01 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-25 13:21:01 INFO  Running instrumented original pipeline...
2022-09-25 13:21:02 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-25 13:21:02 INFO  ---RUNTIME: Importing and monkey-patching took 5.910158157348633 ms
2022-09-25 13:21:15 INFO  ---RUNTIME: Original pipeline execution took 13563.289880752563 ms (excluding imports and monkey-patching)
2022-09-25 13:21:15 INFO  Starting execution of 1 what-if analyses...
2022-09-25 13:21:15 INFO  Start plan generation for analysis DataCorruption...
2022-09-25 13:21:15 INFO  ---RUNTIME: Plan generation took 0.44798851013183594 ms
2022-09-25 13:21:15 INFO  Estimated runtime of original DAG is 12860.919713973999ms
2022-09-25 13:21:15 WARNING Skipping Multi-Query Optimization (instead, only applying patches)
2022-09-25 13:21:15 INFO  Estimated unoptimised what-if runtime is 321522.99284935ms
2022-09-25 13:21:15 INFO  ---RUNTIME: Multi-Query Optimization took 20.886659622192383 ms
2022-09-25 13:21:15 INFO  Executing generated plans
2022-09-25 13:26:51 INFO  ---RUNTIME: Execution took 335697.44300842285 ms
2022-09-25 13:26:51 INFO  Done!
2022-09-25 13:26:51 INFO  # Finished -- repetition 6 of 7 
2022-09-25 13:26:51 INFO  # Optimization benchmark for data_corruption with args [['reviews', 'fast_loading', 'featurization_4', 'neural_network']] -- repetition 7 of 7
2022-09-25 13:26:51 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-25 13:26:51 INFO  Running instrumented original pipeline...
2022-09-25 13:26:51 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-25 13:26:51 INFO  ---RUNTIME: Importing and monkey-patching took 6.4373016357421875 ms
2022-09-25 13:27:04 INFO  ---RUNTIME: Original pipeline execution took 13243.791103363037 ms (excluding imports and monkey-patching)
2022-09-25 13:27:04 INFO  Starting execution of 1 what-if analyses...
2022-09-25 13:27:04 INFO  Start plan generation for analysis DataCorruption...
2022-09-25 13:27:04 INFO  ---RUNTIME: Plan generation took 0.4699230194091797 ms
2022-09-25 13:27:04 INFO  Estimated runtime of original DAG is 12919.249773025513ms
2022-09-25 13:27:04 INFO  Performing Multi-Query Optimization
2022-09-25 13:27:04 INFO  Estimated unoptimized what-if runtime is 322981.2443256378ms
2022-09-25 13:27:04 INFO  Estimated optimised what-if runtime is 22961.86852455139ms
2022-09-25 13:27:04 INFO  Estimated optimisation runtime saving is 300019.3758010864ms
2022-09-25 13:27:04 INFO  ---RUNTIME: Multi-Query Optimization took 69.05555725097656 ms
2022-09-25 13:27:04 INFO  Executing generated plans
2022-09-25 13:27:31 INFO  ---RUNTIME: Execution took 27034.04188156128 ms
2022-09-25 13:27:31 INFO  Done!
2022-09-25 13:27:31 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-25 13:27:31 INFO  Running instrumented original pipeline...
2022-09-25 13:27:31 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-25 13:27:31 INFO  ---RUNTIME: Importing and monkey-patching took 5.927801132202148 ms
2022-09-25 13:27:44 INFO  ---RUNTIME: Original pipeline execution took 13187.756776809692 ms (excluding imports and monkey-patching)
2022-09-25 13:27:44 INFO  Starting execution of 1 what-if analyses...
2022-09-25 13:27:44 INFO  Start plan generation for analysis DataCorruption...
2022-09-25 13:27:44 INFO  ---RUNTIME: Plan generation took 0.5731582641601562 ms
2022-09-25 13:27:44 INFO  Estimated runtime of original DAG is 12868.361949920654ms
2022-09-25 13:27:44 WARNING Skipping Multi-Query Optimization (instead, only applying patches)
2022-09-25 13:27:44 INFO  Estimated unoptimised what-if runtime is 321709.04874801636ms
2022-09-25 13:27:44 INFO  ---RUNTIME: Multi-Query Optimization took 22.37248420715332 ms
2022-09-25 13:27:44 INFO  Executing generated plans
2022-09-25 13:33:19 INFO  ---RUNTIME: Execution took 334317.30675697327 ms
2022-09-25 13:33:19 INFO  Done!
2022-09-25 13:33:19 INFO  # Finished -- repetition 7 of 7 
2022-09-25 13:33:19 INFO  # Final results after all repetitions
2022-09-25 13:33:19 INFO     repetition  ... no_opt_what_if_execution_combined_model_training
0           0  ...                                     82601.058006
1           1  ...                                     82240.696430
2           2  ...                                     82585.042715
3           3  ...                                     82651.252031
4           4  ...                                     81728.050232
5           5  ...                                     81398.319721
6           6  ...                                     81209.524632

[7 rows x 26 columns]
