Variant name from 1-8: 1
Cores to use: 32-40
taskset -c 32-40 PROTOCOL_BUFFERS_PYTHON_IMPLEMENTATION=python python3.9 benchmarks_end_to_end.py data_corruption reviews fast_loading featurization_0 logistic_regression
2022-09-20 20:14:02.359685: W tensorflow/stream_executor/platform/default/dso_loader.cc:64] Could not load dynamic library 'libcudart.so.11.0'; dlerror: libcudart.so.11.0: cannot open shared object file: No such file or directory; LD_LIBRARY_PATH: /home/sgrafbe/mlwhatif/venv/lib/python3.9/site-packages/cv2/../../lib64:
2022-09-20 20:14:02.359731: I tensorflow/stream_executor/cuda/cudart_stub.cc:29] Ignore above cudart dlerror if you do not have a GPU set up on your machine.
2022-09-20 20:14:03 INFO  Patching sys.argv with ['mlwhatif', 'reviews', 'fast_loading', 'featurization_0', 'logistic_regression']
2022-09-20 20:14:03 INFO  Running instrumented original pipeline...
2022-09-20 20:14:03 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-20 20:14:03 INFO  ---RUNTIME: Importing and monkey-patching took 120.80597877502441 ms
2022-09-20 20:14:10 INFO  ---RUNTIME: Original pipeline execution took 6521.729230880737 ms (excluding imports and monkey-patching)
2022-09-20 20:14:10 INFO  Starting execution of 0 what-if analyses...
2022-09-20 20:14:10 INFO  Estimated runtime of original DAG is 4847.131729125977ms
2022-09-20 20:14:10 INFO  Performing Multi-Query Optimization
2022-09-20 20:14:10 INFO  Estimated unoptimized what-if runtime is 0ms
2022-09-20 20:14:10 INFO  Estimated optimised what-if runtime is 0ms
2022-09-20 20:14:10 INFO  Estimated optimisation runtime saving is 0ms
2022-09-20 20:14:10 INFO  ---RUNTIME: Multi-Query Optimization took 0.5319118499755859 ms
2022-09-20 20:14:10 INFO  Executing generated plans
2022-09-20 20:14:10 INFO  ---RUNTIME: Execution took 0.026702880859375 ms
2022-09-20 20:14:10 INFO  Done!
2022-09-20 20:14:10 INFO  # Optimization benchmark for data_corruption with args [['reviews', 'fast_loading', 'featurization_0', 'logistic_regression']] -- repetition 1 of 7
2022-09-20 20:14:10 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-20 20:14:10 INFO  Running instrumented original pipeline...
2022-09-20 20:14:10 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-20 20:14:10 INFO  ---RUNTIME: Importing and monkey-patching took 5.927801132202148 ms
2022-09-20 20:14:16 INFO  ---RUNTIME: Original pipeline execution took 6627.259969711304 ms (excluding imports and monkey-patching)
2022-09-20 20:14:16 INFO  Starting execution of 1 what-if analyses...
2022-09-20 20:14:16 INFO  Start plan generation for analysis DataCorruption...
2022-09-20 20:14:16 INFO  ---RUNTIME: Plan generation took 0.4723072052001953 ms
2022-09-20 20:14:16 INFO  Estimated runtime of original DAG is 4795.357227325439ms
2022-09-20 20:14:16 INFO  Performing Multi-Query Optimization
2022-09-20 20:14:17 INFO  Estimated unoptimized what-if runtime is 119883.93068313599ms
2022-09-20 20:14:17 INFO  Estimated optimised what-if runtime is 11360.210657119751ms
2022-09-20 20:14:17 INFO  Estimated optimisation runtime saving is 108523.72002601624ms
2022-09-20 20:14:17 INFO  ---RUNTIME: Multi-Query Optimization took 59.357404708862305 ms
2022-09-20 20:14:17 INFO  Executing generated plans
2022-09-20 20:14:34 INFO  ---RUNTIME: Execution took 17369.09794807434 ms
2022-09-20 20:14:34 INFO  Done!
2022-09-20 20:14:34 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-20 20:14:34 INFO  Running instrumented original pipeline...
2022-09-20 20:14:34 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-20 20:14:34 INFO  ---RUNTIME: Importing and monkey-patching took 6.473779678344727 ms
2022-09-20 20:14:40 INFO  ---RUNTIME: Original pipeline execution took 6459.384918212891 ms (excluding imports and monkey-patching)
2022-09-20 20:14:40 INFO  Starting execution of 1 what-if analyses...
2022-09-20 20:14:40 INFO  Start plan generation for analysis DataCorruption...
2022-09-20 20:14:40 INFO  ---RUNTIME: Plan generation took 0.46372413635253906 ms
2022-09-20 20:14:40 INFO  Estimated runtime of original DAG is 4799.283266067505ms
2022-09-20 20:14:40 WARNING Skipping Multi-Query Optimization (instead, only combine execution DAGs)
2022-09-20 20:14:41 INFO  Estimated unoptimised what-if runtime is 119982.08165168762ms
2022-09-20 20:14:41 INFO  ---RUNTIME: Multi-Query Optimization took 128.07321548461914 ms
2022-09-20 20:14:41 INFO  Executing generated plans
2022-09-20 20:17:16 INFO  ---RUNTIME: Execution took 155073.8832950592 ms
2022-09-20 20:17:16 INFO  Done!
2022-09-20 20:17:16 INFO  # Finished -- repetition 1 of 7 
2022-09-20 20:17:16 INFO  # Optimization benchmark for data_corruption with args [['reviews', 'fast_loading', 'featurization_0', 'logistic_regression']] -- repetition 2 of 7
2022-09-20 20:17:16 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-20 20:17:16 INFO  Running instrumented original pipeline...
2022-09-20 20:17:16 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-20 20:17:16 INFO  ---RUNTIME: Importing and monkey-patching took 6.456851959228516 ms
2022-09-20 20:17:22 INFO  ---RUNTIME: Original pipeline execution took 6482.48815536499 ms (excluding imports and monkey-patching)
2022-09-20 20:17:22 INFO  Starting execution of 1 what-if analyses...
2022-09-20 20:17:22 INFO  Start plan generation for analysis DataCorruption...
2022-09-20 20:17:22 INFO  ---RUNTIME: Plan generation took 0.4620552062988281 ms
2022-09-20 20:17:22 INFO  Estimated runtime of original DAG is 4815.155744552612ms
2022-09-20 20:17:22 INFO  Performing Multi-Query Optimization
2022-09-20 20:17:22 INFO  Estimated unoptimized what-if runtime is 120378.89361381531ms
2022-09-20 20:17:22 INFO  Estimated optimised what-if runtime is 11338.784217834473ms
2022-09-20 20:17:22 INFO  Estimated optimisation runtime saving is 109040.10939598083ms
2022-09-20 20:17:22 INFO  ---RUNTIME: Multi-Query Optimization took 57.83963203430176 ms
2022-09-20 20:17:22 INFO  Executing generated plans
2022-09-20 20:17:39 INFO  ---RUNTIME: Execution took 17273.083686828613 ms
2022-09-20 20:17:39 INFO  Done!
2022-09-20 20:17:39 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-20 20:17:39 INFO  Running instrumented original pipeline...
2022-09-20 20:17:39 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-20 20:17:39 INFO  ---RUNTIME: Importing and monkey-patching took 5.771160125732422 ms
2022-09-20 20:17:46 INFO  ---RUNTIME: Original pipeline execution took 6485.180377960205 ms (excluding imports and monkey-patching)
2022-09-20 20:17:46 INFO  Starting execution of 1 what-if analyses...
2022-09-20 20:17:46 INFO  Start plan generation for analysis DataCorruption...
2022-09-20 20:17:46 INFO  ---RUNTIME: Plan generation took 0.44274330139160156 ms
2022-09-20 20:17:46 INFO  Estimated runtime of original DAG is 4795.475482940674ms
2022-09-20 20:17:46 WARNING Skipping Multi-Query Optimization (instead, only combine execution DAGs)
2022-09-20 20:17:46 INFO  Estimated unoptimised what-if runtime is 119886.88707351685ms
2022-09-20 20:17:46 INFO  ---RUNTIME: Multi-Query Optimization took 363.6913299560547 ms
2022-09-20 20:17:46 INFO  Executing generated plans
2022-09-20 20:20:22 INFO  ---RUNTIME: Execution took 155299.92079734802 ms
2022-09-20 20:20:22 INFO  Done!
2022-09-20 20:20:22 INFO  # Finished -- repetition 2 of 7 
2022-09-20 20:20:22 INFO  # Optimization benchmark for data_corruption with args [['reviews', 'fast_loading', 'featurization_0', 'logistic_regression']] -- repetition 3 of 7
2022-09-20 20:20:22 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-20 20:20:22 INFO  Running instrumented original pipeline...
2022-09-20 20:20:22 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-20 20:20:22 INFO  ---RUNTIME: Importing and monkey-patching took 6.373882293701172 ms
2022-09-20 20:20:28 INFO  ---RUNTIME: Original pipeline execution took 6579.389810562134 ms (excluding imports and monkey-patching)
2022-09-20 20:20:28 INFO  Starting execution of 1 what-if analyses...
2022-09-20 20:20:28 INFO  Start plan generation for analysis DataCorruption...
2022-09-20 20:20:28 INFO  ---RUNTIME: Plan generation took 0.43892860412597656 ms
2022-09-20 20:20:28 INFO  Estimated runtime of original DAG is 4873.117923736572ms
2022-09-20 20:20:28 INFO  Performing Multi-Query Optimization
2022-09-20 20:20:28 INFO  Estimated unoptimized what-if runtime is 121827.9480934143ms
2022-09-20 20:20:28 INFO  Estimated optimised what-if runtime is 11425.006628036499ms
2022-09-20 20:20:28 INFO  Estimated optimisation runtime saving is 110402.94146537781ms
2022-09-20 20:20:28 INFO  ---RUNTIME: Multi-Query Optimization took 57.961463928222656 ms
2022-09-20 20:20:28 INFO  Executing generated plans
2022-09-20 20:20:46 INFO  ---RUNTIME: Execution took 17330.913543701172 ms
2022-09-20 20:20:46 INFO  Done!
2022-09-20 20:20:46 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-20 20:20:46 INFO  Running instrumented original pipeline...
2022-09-20 20:20:46 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-20 20:20:46 INFO  ---RUNTIME: Importing and monkey-patching took 5.831718444824219 ms
2022-09-20 20:20:52 INFO  ---RUNTIME: Original pipeline execution took 6521.503686904907 ms (excluding imports and monkey-patching)
2022-09-20 20:20:52 INFO  Starting execution of 1 what-if analyses...
2022-09-20 20:20:52 INFO  Start plan generation for analysis DataCorruption...
2022-09-20 20:20:52 INFO  ---RUNTIME: Plan generation took 0.45228004455566406 ms
2022-09-20 20:20:52 INFO  Estimated runtime of original DAG is 4826.038837432861ms
2022-09-20 20:20:52 WARNING Skipping Multi-Query Optimization (instead, only combine execution DAGs)
2022-09-20 20:20:52 INFO  Estimated unoptimised what-if runtime is 120650.97093582153ms
2022-09-20 20:20:52 INFO  ---RUNTIME: Multi-Query Optimization took 126.41024589538574 ms
2022-09-20 20:20:52 INFO  Executing generated plans
2022-09-20 20:23:27 INFO  ---RUNTIME: Execution took 154987.6058101654 ms
2022-09-20 20:23:27 INFO  Done!
2022-09-20 20:23:27 INFO  # Finished -- repetition 3 of 7 
2022-09-20 20:23:27 INFO  # Optimization benchmark for data_corruption with args [['reviews', 'fast_loading', 'featurization_0', 'logistic_regression']] -- repetition 4 of 7
2022-09-20 20:23:27 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-20 20:23:27 INFO  Running instrumented original pipeline...
2022-09-20 20:23:27 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-20 20:23:27 INFO  ---RUNTIME: Importing and monkey-patching took 7.333040237426758 ms
2022-09-20 20:23:34 INFO  ---RUNTIME: Original pipeline execution took 6539.583206176758 ms (excluding imports and monkey-patching)
2022-09-20 20:23:34 INFO  Starting execution of 1 what-if analyses...
2022-09-20 20:23:34 INFO  Start plan generation for analysis DataCorruption...
2022-09-20 20:23:34 INFO  ---RUNTIME: Plan generation took 0.43654441833496094 ms
2022-09-20 20:23:34 INFO  Estimated runtime of original DAG is 4835.216045379639ms
2022-09-20 20:23:34 INFO  Performing Multi-Query Optimization
2022-09-20 20:23:34 INFO  Estimated unoptimized what-if runtime is 120880.40113449097ms
2022-09-20 20:23:34 INFO  Estimated optimised what-if runtime is 11333.499431610107ms
2022-09-20 20:23:34 INFO  Estimated optimisation runtime saving is 109546.90170288086ms
2022-09-20 20:23:34 INFO  ---RUNTIME: Multi-Query Optimization took 320.42646408081055 ms
2022-09-20 20:23:34 INFO  Executing generated plans
2022-09-20 20:23:52 INFO  ---RUNTIME: Execution took 17438.01522254944 ms
2022-09-20 20:23:52 INFO  Done!
2022-09-20 20:23:52 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-20 20:23:52 INFO  Running instrumented original pipeline...
2022-09-20 20:23:52 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-20 20:23:52 INFO  ---RUNTIME: Importing and monkey-patching took 6.2427520751953125 ms
2022-09-20 20:23:58 INFO  ---RUNTIME: Original pipeline execution took 6564.182996749878 ms (excluding imports and monkey-patching)
2022-09-20 20:23:58 INFO  Starting execution of 1 what-if analyses...
2022-09-20 20:23:58 INFO  Start plan generation for analysis DataCorruption...
2022-09-20 20:23:58 INFO  ---RUNTIME: Plan generation took 0.4506111145019531 ms
2022-09-20 20:23:58 INFO  Estimated runtime of original DAG is 4841.907739639282ms
2022-09-20 20:23:58 WARNING Skipping Multi-Query Optimization (instead, only combine execution DAGs)
2022-09-20 20:23:58 INFO  Estimated unoptimised what-if runtime is 121047.69349098206ms
2022-09-20 20:23:58 INFO  ---RUNTIME: Multi-Query Optimization took 127.09236145019531 ms
2022-09-20 20:23:58 INFO  Executing generated plans
2022-09-20 20:26:33 INFO  ---RUNTIME: Execution took 154857.76376724243 ms
2022-09-20 20:26:33 INFO  Done!
2022-09-20 20:26:33 INFO  # Finished -- repetition 4 of 7 
2022-09-20 20:26:33 INFO  # Optimization benchmark for data_corruption with args [['reviews', 'fast_loading', 'featurization_0', 'logistic_regression']] -- repetition 5 of 7
2022-09-20 20:26:33 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-20 20:26:33 INFO  Running instrumented original pipeline...
2022-09-20 20:26:33 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-20 20:26:33 INFO  ---RUNTIME: Importing and monkey-patching took 6.716728210449219 ms
2022-09-20 20:26:40 INFO  ---RUNTIME: Original pipeline execution took 6608.158349990845 ms (excluding imports and monkey-patching)
2022-09-20 20:26:40 INFO  Starting execution of 1 what-if analyses...
2022-09-20 20:26:40 INFO  Start plan generation for analysis DataCorruption...
2022-09-20 20:26:40 INFO  ---RUNTIME: Plan generation took 0.46133995056152344 ms
2022-09-20 20:26:40 INFO  Estimated runtime of original DAG is 4882.921934127808ms
2022-09-20 20:26:40 INFO  Performing Multi-Query Optimization
2022-09-20 20:26:40 INFO  Estimated unoptimized what-if runtime is 122073.04835319519ms
2022-09-20 20:26:40 INFO  Estimated optimised what-if runtime is 11418.803930282593ms
2022-09-20 20:26:40 INFO  Estimated optimisation runtime saving is 110654.2444229126ms
2022-09-20 20:26:40 INFO  ---RUNTIME: Multi-Query Optimization took 58.003902435302734 ms
2022-09-20 20:26:40 INFO  Executing generated plans
2022-09-20 20:26:57 INFO  ---RUNTIME: Execution took 17467.8852558136 ms
2022-09-20 20:26:57 INFO  Done!
2022-09-20 20:26:57 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-20 20:26:57 INFO  Running instrumented original pipeline...
2022-09-20 20:26:57 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-20 20:26:57 INFO  ---RUNTIME: Importing and monkey-patching took 5.852699279785156 ms
2022-09-20 20:27:04 INFO  ---RUNTIME: Original pipeline execution took 6537.475347518921 ms (excluding imports and monkey-patching)
2022-09-20 20:27:04 INFO  Starting execution of 1 what-if analyses...
2022-09-20 20:27:04 INFO  Start plan generation for analysis DataCorruption...
2022-09-20 20:27:04 INFO  ---RUNTIME: Plan generation took 0.4317760467529297 ms
2022-09-20 20:27:04 INFO  Estimated runtime of original DAG is 4833.043336868286ms
2022-09-20 20:27:04 WARNING Skipping Multi-Query Optimization (instead, only combine execution DAGs)
2022-09-20 20:27:04 INFO  Estimated unoptimised what-if runtime is 120826.08342170715ms
2022-09-20 20:27:04 INFO  ---RUNTIME: Multi-Query Optimization took 125.76174736022949 ms
2022-09-20 20:27:04 INFO  Executing generated plans
2022-09-20 20:29:39 INFO  ---RUNTIME: Execution took 154946.12884521484 ms
2022-09-20 20:29:39 INFO  Done!
2022-09-20 20:29:39 INFO  # Finished -- repetition 5 of 7 
2022-09-20 20:29:39 INFO  # Optimization benchmark for data_corruption with args [['reviews', 'fast_loading', 'featurization_0', 'logistic_regression']] -- repetition 6 of 7
2022-09-20 20:29:39 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-20 20:29:39 INFO  Running instrumented original pipeline...
2022-09-20 20:29:39 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-20 20:29:39 INFO  ---RUNTIME: Importing and monkey-patching took 6.801366806030273 ms
2022-09-20 20:29:46 INFO  ---RUNTIME: Original pipeline execution took 6867.630481719971 ms (excluding imports and monkey-patching)
2022-09-20 20:29:46 INFO  Starting execution of 1 what-if analyses...
2022-09-20 20:29:46 INFO  Start plan generation for analysis DataCorruption...
2022-09-20 20:29:46 INFO  ---RUNTIME: Plan generation took 0.4405975341796875 ms
2022-09-20 20:29:46 INFO  Estimated runtime of original DAG is 4850.731372833252ms
2022-09-20 20:29:46 INFO  Performing Multi-Query Optimization
2022-09-20 20:29:46 INFO  Estimated unoptimized what-if runtime is 121268.2843208313ms
2022-09-20 20:29:46 INFO  Estimated optimised what-if runtime is 11391.47400856018ms
2022-09-20 20:29:46 INFO  Estimated optimisation runtime saving is 109876.81031227112ms
2022-09-20 20:29:46 INFO  ---RUNTIME: Multi-Query Optimization took 58.12406539916992 ms
2022-09-20 20:29:46 INFO  Executing generated plans
2022-09-20 20:30:03 INFO  ---RUNTIME: Execution took 17498.629808425903 ms
2022-09-20 20:30:03 INFO  Done!
2022-09-20 20:30:03 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-20 20:30:03 INFO  Running instrumented original pipeline...
2022-09-20 20:30:03 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-20 20:30:03 INFO  ---RUNTIME: Importing and monkey-patching took 6.024837493896484 ms
2022-09-20 20:30:10 INFO  ---RUNTIME: Original pipeline execution took 6614.985227584839 ms (excluding imports and monkey-patching)
2022-09-20 20:30:10 INFO  Starting execution of 1 what-if analyses...
2022-09-20 20:30:10 INFO  Start plan generation for analysis DataCorruption...
2022-09-20 20:30:10 INFO  ---RUNTIME: Plan generation took 0.3879070281982422 ms
2022-09-20 20:30:10 INFO  Estimated runtime of original DAG is 4890.404462814331ms
2022-09-20 20:30:10 WARNING Skipping Multi-Query Optimization (instead, only combine execution DAGs)
2022-09-20 20:30:10 INFO  Estimated unoptimised what-if runtime is 122260.11157035828ms
2022-09-20 20:30:10 INFO  ---RUNTIME: Multi-Query Optimization took 126.65820121765137 ms
2022-09-20 20:30:10 INFO  Executing generated plans
2022-09-20 20:32:45 INFO  ---RUNTIME: Execution took 155355.06892204285 ms
2022-09-20 20:32:45 INFO  Done!
2022-09-20 20:32:45 INFO  # Finished -- repetition 6 of 7 
2022-09-20 20:32:45 INFO  # Optimization benchmark for data_corruption with args [['reviews', 'fast_loading', 'featurization_0', 'logistic_regression']] -- repetition 7 of 7
2022-09-20 20:32:45 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-20 20:32:45 INFO  Running instrumented original pipeline...
2022-09-20 20:32:46 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-20 20:32:46 INFO  ---RUNTIME: Importing and monkey-patching took 6.722927093505859 ms
2022-09-20 20:32:52 INFO  ---RUNTIME: Original pipeline execution took 6633.313894271851 ms (excluding imports and monkey-patching)
2022-09-20 20:32:52 INFO  Starting execution of 1 what-if analyses...
2022-09-20 20:32:52 INFO  Start plan generation for analysis DataCorruption...
2022-09-20 20:32:52 INFO  ---RUNTIME: Plan generation took 0.43702125549316406 ms
2022-09-20 20:32:52 INFO  Estimated runtime of original DAG is 4898.800849914551ms
2022-09-20 20:32:52 INFO  Performing Multi-Query Optimization
2022-09-20 20:32:52 INFO  Estimated unoptimized what-if runtime is 122470.02124786377ms
2022-09-20 20:32:52 INFO  Estimated optimised what-if runtime is 11459.381818771362ms
2022-09-20 20:32:52 INFO  Estimated optimisation runtime saving is 111010.6394290924ms
2022-09-20 20:32:52 INFO  ---RUNTIME: Multi-Query Optimization took 58.35890769958496 ms
2022-09-20 20:32:52 INFO  Executing generated plans
2022-09-20 20:33:10 INFO  ---RUNTIME: Execution took 17386.823415756226 ms
2022-09-20 20:33:10 INFO  Done!
2022-09-20 20:33:10 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-20 20:33:10 INFO  Running instrumented original pipeline...
2022-09-20 20:33:10 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-20 20:33:10 INFO  ---RUNTIME: Importing and monkey-patching took 6.087779998779297 ms
2022-09-20 20:33:16 INFO  ---RUNTIME: Original pipeline execution took 6609.186410903931 ms (excluding imports and monkey-patching)
2022-09-20 20:33:16 INFO  Starting execution of 1 what-if analyses...
2022-09-20 20:33:16 INFO  Start plan generation for analysis DataCorruption...
2022-09-20 20:33:16 INFO  ---RUNTIME: Plan generation took 0.4477500915527344 ms
2022-09-20 20:33:16 INFO  Estimated runtime of original DAG is 4881.795883178711ms
2022-09-20 20:33:16 WARNING Skipping Multi-Query Optimization (instead, only combine execution DAGs)
2022-09-20 20:33:16 INFO  Estimated unoptimised what-if runtime is 122044.89707946777ms
2022-09-20 20:33:16 INFO  ---RUNTIME: Multi-Query Optimization took 126.82127952575684 ms
2022-09-20 20:33:16 INFO  Executing generated plans
2022-09-20 20:35:51 INFO  ---RUNTIME: Execution took 155117.57898330688 ms
2022-09-20 20:35:51 INFO  Done!
2022-09-20 20:35:51 INFO  # Finished -- repetition 7 of 7 
2022-09-20 20:35:51 INFO  # Final results after all repetitions
2022-09-20 20:35:51 INFO     repetition  ... no_opt_what_if_execution_combined_model_training
0           0  ...                                      4008.618355
1           1  ...                                      4012.737989
2           2  ...                                      4004.566193
3           3  ...                                      3985.567808
4           4  ...                                      3989.024878
5           5  ...                                      3995.451450
6           6  ...                                      4007.062674

[7 rows x 26 columns]
taskset -c 32-40 PROTOCOL_BUFFERS_PYTHON_IMPLEMENTATION=python python3.9 benchmarks_end_to_end.py data_corruption reviews fast_loading featurization_0 xgboost
2022-09-20 20:35:54.346339: W tensorflow/stream_executor/platform/default/dso_loader.cc:64] Could not load dynamic library 'libcudart.so.11.0'; dlerror: libcudart.so.11.0: cannot open shared object file: No such file or directory; LD_LIBRARY_PATH: /home/sgrafbe/mlwhatif/venv/lib/python3.9/site-packages/cv2/../../lib64:
2022-09-20 20:35:54.346383: I tensorflow/stream_executor/cuda/cudart_stub.cc:29] Ignore above cudart dlerror if you do not have a GPU set up on your machine.
2022-09-20 20:35:55 INFO  Patching sys.argv with ['mlwhatif', 'reviews', 'fast_loading', 'featurization_0', 'xgboost']
2022-09-20 20:35:55 INFO  Running instrumented original pipeline...
2022-09-20 20:35:55 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-20 20:35:55 INFO  ---RUNTIME: Importing and monkey-patching took 121.77467346191406 ms
2022-09-20 20:37:19 INFO  ---RUNTIME: Original pipeline execution took 83881.81495666504 ms (excluding imports and monkey-patching)
2022-09-20 20:37:19 INFO  Starting execution of 0 what-if analyses...
2022-09-20 20:37:19 INFO  Estimated runtime of original DAG is 82227.78487205505ms
2022-09-20 20:37:19 INFO  Performing Multi-Query Optimization
2022-09-20 20:37:19 INFO  Estimated unoptimized what-if runtime is 0ms
2022-09-20 20:37:19 INFO  Estimated optimised what-if runtime is 0ms
2022-09-20 20:37:19 INFO  Estimated optimisation runtime saving is 0ms
2022-09-20 20:37:19 INFO  ---RUNTIME: Multi-Query Optimization took 0.5223751068115234 ms
2022-09-20 20:37:19 INFO  Executing generated plans
2022-09-20 20:37:19 INFO  ---RUNTIME: Execution took 0.026702880859375 ms
2022-09-20 20:37:19 INFO  Done!
2022-09-20 20:37:19 INFO  # Optimization benchmark for data_corruption with args [['reviews', 'fast_loading', 'featurization_0', 'xgboost']] -- repetition 1 of 7
2022-09-20 20:37:19 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-20 20:37:19 INFO  Running instrumented original pipeline...
2022-09-20 20:37:19 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-20 20:37:19 INFO  ---RUNTIME: Importing and monkey-patching took 5.824804306030273 ms
2022-09-20 20:37:45 INFO  ---RUNTIME: Original pipeline execution took 25472.99814224243 ms (excluding imports and monkey-patching)
2022-09-20 20:37:45 INFO  Starting execution of 1 what-if analyses...
2022-09-20 20:37:45 INFO  Start plan generation for analysis DataCorruption...
2022-09-20 20:37:45 INFO  ---RUNTIME: Plan generation took 0.42819976806640625 ms
2022-09-20 20:37:45 INFO  Estimated runtime of original DAG is 23696.76685333252ms
2022-09-20 20:37:45 INFO  Performing Multi-Query Optimization
2022-09-20 20:37:45 INFO  Estimated unoptimized what-if runtime is 592419.171333313ms
2022-09-20 20:37:45 INFO  Estimated optimised what-if runtime is 31259.0115070343ms
2022-09-20 20:37:45 INFO  Estimated optimisation runtime saving is 561160.1598262787ms
2022-09-20 20:37:45 INFO  ---RUNTIME: Multi-Query Optimization took 58.80928039550781 ms
2022-09-20 20:37:45 INFO  Executing generated plans
2022-09-20 20:38:04 INFO  ---RUNTIME: Execution took 18864.866495132446 ms
2022-09-20 20:38:04 INFO  Done!
2022-09-20 20:38:04 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-20 20:38:04 INFO  Running instrumented original pipeline...
2022-09-20 20:38:04 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-20 20:38:04 INFO  ---RUNTIME: Importing and monkey-patching took 6.007194519042969 ms
2022-09-20 20:38:11 INFO  ---RUNTIME: Original pipeline execution took 7047.935485839844 ms (excluding imports and monkey-patching)
2022-09-20 20:38:11 INFO  Starting execution of 1 what-if analyses...
2022-09-20 20:38:11 INFO  Start plan generation for analysis DataCorruption...
2022-09-20 20:38:11 INFO  ---RUNTIME: Plan generation took 0.4520416259765625 ms
2022-09-20 20:38:11 INFO  Estimated runtime of original DAG is 5422.2307205200195ms
2022-09-20 20:38:11 WARNING Skipping Multi-Query Optimization (instead, only combine execution DAGs)
2022-09-20 20:38:11 INFO  Estimated unoptimised what-if runtime is 135555.7680130005ms
2022-09-20 20:38:11 INFO  ---RUNTIME: Multi-Query Optimization took 123.95191192626953 ms
2022-09-20 20:38:11 INFO  Executing generated plans
2022-09-20 20:41:13 INFO  ---RUNTIME: Execution took 182336.9016647339 ms
2022-09-20 20:41:13 INFO  Done!
2022-09-20 20:41:13 INFO  # Finished -- repetition 1 of 7 
2022-09-20 20:41:13 INFO  # Optimization benchmark for data_corruption with args [['reviews', 'fast_loading', 'featurization_0', 'xgboost']] -- repetition 2 of 7
2022-09-20 20:41:13 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-20 20:41:13 INFO  Running instrumented original pipeline...
2022-09-20 20:41:13 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-20 20:41:13 INFO  ---RUNTIME: Importing and monkey-patching took 6.551027297973633 ms
2022-09-20 20:42:01 INFO  ---RUNTIME: Original pipeline execution took 47870.98670005798 ms (excluding imports and monkey-patching)
2022-09-20 20:42:01 INFO  Starting execution of 1 what-if analyses...
2022-09-20 20:42:01 INFO  Start plan generation for analysis DataCorruption...
2022-09-20 20:42:01 INFO  ---RUNTIME: Plan generation took 0.6036758422851562 ms
2022-09-20 20:42:01 INFO  Estimated runtime of original DAG is 46220.648765563965ms
2022-09-20 20:42:01 INFO  Performing Multi-Query Optimization
2022-09-20 20:42:01 INFO  Estimated unoptimized what-if runtime is 1155516.2191390991ms
2022-09-20 20:42:01 INFO  Estimated optimised what-if runtime is 54581.45546913147ms
2022-09-20 20:42:01 INFO  Estimated optimisation runtime saving is 1100934.7636699677ms
2022-09-20 20:42:01 INFO  ---RUNTIME: Multi-Query Optimization took 79.77533340454102 ms
2022-09-20 20:42:01 INFO  Executing generated plans
2022-09-20 20:42:24 INFO  ---RUNTIME: Execution took 22733.15191268921 ms
2022-09-20 20:42:24 INFO  Done!
2022-09-20 20:42:24 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-20 20:42:24 INFO  Running instrumented original pipeline...
2022-09-20 20:42:24 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-20 20:42:24 INFO  ---RUNTIME: Importing and monkey-patching took 6.279706954956055 ms
2022-09-20 20:43:15 INFO  ---RUNTIME: Original pipeline execution took 51258.42618942261 ms (excluding imports and monkey-patching)
2022-09-20 20:43:15 INFO  Starting execution of 1 what-if analyses...
2022-09-20 20:43:15 INFO  Start plan generation for analysis DataCorruption...
2022-09-20 20:43:15 INFO  ---RUNTIME: Plan generation took 0.4813671112060547 ms
2022-09-20 20:43:15 INFO  Estimated runtime of original DAG is 49495.27335166931ms
2022-09-20 20:43:15 WARNING Skipping Multi-Query Optimization (instead, only combine execution DAGs)
2022-09-20 20:43:15 INFO  Estimated unoptimised what-if runtime is 1237381.8337917328ms
2022-09-20 20:43:15 INFO  ---RUNTIME: Multi-Query Optimization took 359.50303077697754 ms
2022-09-20 20:43:15 INFO  Executing generated plans
2022-09-20 20:46:09 INFO  ---RUNTIME: Execution took 173785.0694656372 ms
2022-09-20 20:46:09 INFO  Done!
2022-09-20 20:46:09 INFO  # Finished -- repetition 2 of 7 
2022-09-20 20:46:09 INFO  # Optimization benchmark for data_corruption with args [['reviews', 'fast_loading', 'featurization_0', 'xgboost']] -- repetition 3 of 7
2022-09-20 20:46:09 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-20 20:46:09 INFO  Running instrumented original pipeline...
2022-09-20 20:46:09 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-20 20:46:09 INFO  ---RUNTIME: Importing and monkey-patching took 6.373882293701172 ms
2022-09-20 20:46:17 INFO  ---RUNTIME: Original pipeline execution took 7311.052322387695 ms (excluding imports and monkey-patching)
2022-09-20 20:46:17 INFO  Starting execution of 1 what-if analyses...
2022-09-20 20:46:17 INFO  Start plan generation for analysis DataCorruption...
2022-09-20 20:46:17 INFO  ---RUNTIME: Plan generation took 0.4868507385253906 ms
2022-09-20 20:46:17 INFO  Estimated runtime of original DAG is 5623.101711273193ms
2022-09-20 20:46:17 INFO  Performing Multi-Query Optimization
2022-09-20 20:46:17 INFO  Estimated unoptimized what-if runtime is 140577.54278182983ms
2022-09-20 20:46:17 INFO  Estimated optimised what-if runtime is 13194.44465637207ms
2022-09-20 20:46:17 INFO  Estimated optimisation runtime saving is 127383.09812545776ms
2022-09-20 20:46:17 INFO  ---RUNTIME: Multi-Query Optimization took 58.3338737487793 ms
2022-09-20 20:46:17 INFO  Executing generated plans
2022-09-20 20:46:36 INFO  ---RUNTIME: Execution took 19241.01209640503 ms
2022-09-20 20:46:36 INFO  Done!
2022-09-20 20:46:36 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-20 20:46:36 INFO  Running instrumented original pipeline...
2022-09-20 20:46:36 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-20 20:46:36 INFO  ---RUNTIME: Importing and monkey-patching took 5.988597869873047 ms
2022-09-20 20:46:43 INFO  ---RUNTIME: Original pipeline execution took 7262.2315883636475 ms (excluding imports and monkey-patching)
2022-09-20 20:46:43 INFO  Starting execution of 1 what-if analyses...
2022-09-20 20:46:43 INFO  Start plan generation for analysis DataCorruption...
2022-09-20 20:46:43 INFO  ---RUNTIME: Plan generation took 0.44226646423339844 ms
2022-09-20 20:46:43 INFO  Estimated runtime of original DAG is 5436.65623664856ms
2022-09-20 20:46:43 WARNING Skipping Multi-Query Optimization (instead, only combine execution DAGs)
2022-09-20 20:46:43 INFO  Estimated unoptimised what-if runtime is 135916.405916214ms
2022-09-20 20:46:43 INFO  ---RUNTIME: Multi-Query Optimization took 123.97933006286621 ms
2022-09-20 20:46:43 INFO  Executing generated plans
2022-09-20 20:49:34 INFO  ---RUNTIME: Execution took 170481.76288604736 ms
2022-09-20 20:49:34 INFO  Done!
2022-09-20 20:49:34 INFO  # Finished -- repetition 3 of 7 
2022-09-20 20:49:34 INFO  # Optimization benchmark for data_corruption with args [['reviews', 'fast_loading', 'featurization_0', 'xgboost']] -- repetition 4 of 7
2022-09-20 20:49:34 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-20 20:49:34 INFO  Running instrumented original pipeline...
2022-09-20 20:49:34 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-20 20:49:34 INFO  ---RUNTIME: Importing and monkey-patching took 8.306264877319336 ms
2022-09-20 20:49:43 INFO  ---RUNTIME: Original pipeline execution took 8908.40744972229 ms (excluding imports and monkey-patching)
2022-09-20 20:49:43 INFO  Starting execution of 1 what-if analyses...
2022-09-20 20:49:43 INFO  Start plan generation for analysis DataCorruption...
2022-09-20 20:49:43 INFO  ---RUNTIME: Plan generation took 0.5853176116943359 ms
2022-09-20 20:49:43 INFO  Estimated runtime of original DAG is 6736.440658569336ms
2022-09-20 20:49:43 INFO  Performing Multi-Query Optimization
2022-09-20 20:49:43 INFO  Estimated unoptimized what-if runtime is 168411.0164642334ms
2022-09-20 20:49:43 INFO  Estimated optimised what-if runtime is 15836.809396743774ms
2022-09-20 20:49:43 INFO  Estimated optimisation runtime saving is 152574.20706748962ms
2022-09-20 20:49:43 INFO  ---RUNTIME: Multi-Query Optimization took 79.04911041259766 ms
2022-09-20 20:49:43 INFO  Executing generated plans
2022-09-20 20:50:03 INFO  ---RUNTIME: Execution took 20487.682819366455 ms
2022-09-20 20:50:03 INFO  Done!
2022-09-20 20:50:03 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-20 20:50:03 INFO  Running instrumented original pipeline...
2022-09-20 20:50:04 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-20 20:50:04 INFO  ---RUNTIME: Importing and monkey-patching took 6.029844284057617 ms
2022-09-20 20:50:11 INFO  ---RUNTIME: Original pipeline execution took 7399.654150009155 ms (excluding imports and monkey-patching)
2022-09-20 20:50:11 INFO  Starting execution of 1 what-if analyses...
2022-09-20 20:50:11 INFO  Start plan generation for analysis DataCorruption...
2022-09-20 20:50:11 INFO  ---RUNTIME: Plan generation took 0.4737377166748047 ms
2022-09-20 20:50:11 INFO  Estimated runtime of original DAG is 5457.420349121094ms
2022-09-20 20:50:11 WARNING Skipping Multi-Query Optimization (instead, only combine execution DAGs)
2022-09-20 20:50:11 INFO  Estimated unoptimised what-if runtime is 136435.50872802734ms
2022-09-20 20:50:11 INFO  ---RUNTIME: Multi-Query Optimization took 125.59676170349121 ms
2022-09-20 20:50:11 INFO  Executing generated plans
2022-09-20 20:53:01 INFO  ---RUNTIME: Execution took 170439.33749198914 ms
2022-09-20 20:53:01 INFO  Done!
2022-09-20 20:53:01 INFO  # Finished -- repetition 4 of 7 
2022-09-20 20:53:01 INFO  # Optimization benchmark for data_corruption with args [['reviews', 'fast_loading', 'featurization_0', 'xgboost']] -- repetition 5 of 7
2022-09-20 20:53:01 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-20 20:53:01 INFO  Running instrumented original pipeline...
2022-09-20 20:53:01 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-20 20:53:01 INFO  ---RUNTIME: Importing and monkey-patching took 6.984233856201172 ms
2022-09-20 20:53:13 INFO  ---RUNTIME: Original pipeline execution took 12192.52896308899 ms (excluding imports and monkey-patching)
2022-09-20 20:53:13 INFO  Starting execution of 1 what-if analyses...
2022-09-20 20:53:13 INFO  Start plan generation for analysis DataCorruption...
2022-09-20 20:53:13 INFO  ---RUNTIME: Plan generation took 0.4601478576660156 ms
2022-09-20 20:53:13 INFO  Estimated runtime of original DAG is 10494.836330413818ms
2022-09-20 20:53:13 INFO  Performing Multi-Query Optimization
2022-09-20 20:53:13 INFO  Estimated unoptimized what-if runtime is 262370.90826034546ms
2022-09-20 20:53:13 INFO  Estimated optimised what-if runtime is 18391.926288604736ms
2022-09-20 20:53:13 INFO  Estimated optimisation runtime saving is 243978.98197174072ms
2022-09-20 20:53:13 INFO  ---RUNTIME: Multi-Query Optimization took 58.962106704711914 ms
2022-09-20 20:53:13 INFO  Executing generated plans
2022-09-20 20:53:38 INFO  ---RUNTIME: Execution took 24873.41332435608 ms
2022-09-20 20:53:38 INFO  Done!
2022-09-20 20:53:38 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-20 20:53:38 INFO  Running instrumented original pipeline...
2022-09-20 20:53:38 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-20 20:53:38 INFO  ---RUNTIME: Importing and monkey-patching took 5.944490432739258 ms
2022-09-20 20:53:54 INFO  ---RUNTIME: Original pipeline execution took 15880.91778755188 ms (excluding imports and monkey-patching)
2022-09-20 20:53:54 INFO  Starting execution of 1 what-if analyses...
2022-09-20 20:53:54 INFO  Start plan generation for analysis DataCorruption...
2022-09-20 20:53:54 INFO  ---RUNTIME: Plan generation took 0.3955364227294922 ms
2022-09-20 20:53:54 INFO  Estimated runtime of original DAG is 14030.321598052979ms
2022-09-20 20:53:54 WARNING Skipping Multi-Query Optimization (instead, only combine execution DAGs)
2022-09-20 20:53:54 INFO  Estimated unoptimised what-if runtime is 350758.03995132446ms
2022-09-20 20:53:54 INFO  ---RUNTIME: Multi-Query Optimization took 125.47659873962402 ms
2022-09-20 20:53:54 INFO  Executing generated plans
2022-09-20 20:56:56 INFO  ---RUNTIME: Execution took 181631.51097297668 ms
2022-09-20 20:56:56 INFO  Done!
2022-09-20 20:56:56 INFO  # Finished -- repetition 5 of 7 
2022-09-20 20:56:56 INFO  # Optimization benchmark for data_corruption with args [['reviews', 'fast_loading', 'featurization_0', 'xgboost']] -- repetition 6 of 7
2022-09-20 20:56:56 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-20 20:56:56 INFO  Running instrumented original pipeline...
2022-09-20 20:56:56 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-20 20:56:56 INFO  ---RUNTIME: Importing and monkey-patching took 6.703615188598633 ms
2022-09-20 20:58:10 INFO  ---RUNTIME: Original pipeline execution took 74165.60888290405 ms (excluding imports and monkey-patching)
2022-09-20 20:58:10 INFO  Starting execution of 1 what-if analyses...
2022-09-20 20:58:10 INFO  Start plan generation for analysis DataCorruption...
2022-09-20 20:58:10 INFO  ---RUNTIME: Plan generation took 0.46324729919433594 ms
2022-09-20 20:58:10 INFO  Estimated runtime of original DAG is 72110.06236076355ms
2022-09-20 20:58:10 INFO  Performing Multi-Query Optimization
2022-09-20 20:58:11 INFO  Estimated unoptimized what-if runtime is 1802751.5590190887ms
2022-09-20 20:58:11 INFO  Estimated optimised what-if runtime is 79559.73505973816ms
2022-09-20 20:58:11 INFO  Estimated optimisation runtime saving is 1723191.8239593506ms
2022-09-20 20:58:11 INFO  ---RUNTIME: Multi-Query Optimization took 334.9900245666504 ms
2022-09-20 20:58:11 INFO  Executing generated plans
2022-09-20 20:58:29 INFO  ---RUNTIME: Execution took 18968.60361099243 ms
2022-09-20 20:58:29 INFO  Done!
2022-09-20 20:58:29 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-20 20:58:29 INFO  Running instrumented original pipeline...
2022-09-20 20:58:30 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-20 20:58:30 INFO  ---RUNTIME: Importing and monkey-patching took 5.825519561767578 ms
2022-09-20 20:58:37 INFO  ---RUNTIME: Original pipeline execution took 7114.129543304443 ms (excluding imports and monkey-patching)
2022-09-20 20:58:37 INFO  Starting execution of 1 what-if analyses...
2022-09-20 20:58:37 INFO  Start plan generation for analysis DataCorruption...
2022-09-20 20:58:37 INFO  ---RUNTIME: Plan generation took 0.39505958557128906 ms
2022-09-20 20:58:37 INFO  Estimated runtime of original DAG is 5413.901090621948ms
2022-09-20 20:58:37 WARNING Skipping Multi-Query Optimization (instead, only combine execution DAGs)
2022-09-20 20:58:37 INFO  Estimated unoptimised what-if runtime is 135347.5272655487ms
2022-09-20 20:58:37 INFO  ---RUNTIME: Multi-Query Optimization took 126.35564804077148 ms
2022-09-20 20:58:37 INFO  Executing generated plans
2022-09-20 21:02:39 INFO  ---RUNTIME: Execution took 241980.3237915039 ms
2022-09-20 21:02:39 INFO  Done!
2022-09-20 21:02:39 INFO  # Finished -- repetition 6 of 7 
2022-09-20 21:02:39 INFO  # Optimization benchmark for data_corruption with args [['reviews', 'fast_loading', 'featurization_0', 'xgboost']] -- repetition 7 of 7
2022-09-20 21:02:39 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-20 21:02:39 INFO  Running instrumented original pipeline...
2022-09-20 21:02:39 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-20 21:02:39 INFO  ---RUNTIME: Importing and monkey-patching took 6.6509246826171875 ms
2022-09-20 21:02:46 INFO  ---RUNTIME: Original pipeline execution took 7134.943962097168 ms (excluding imports and monkey-patching)
2022-09-20 21:02:46 INFO  Starting execution of 1 what-if analyses...
2022-09-20 21:02:46 INFO  Start plan generation for analysis DataCorruption...
2022-09-20 21:02:46 INFO  ---RUNTIME: Plan generation took 0.4477500915527344 ms
2022-09-20 21:02:46 INFO  Estimated runtime of original DAG is 5441.913366317749ms
2022-09-20 21:02:46 INFO  Performing Multi-Query Optimization
2022-09-20 21:02:46 INFO  Estimated unoptimized what-if runtime is 136047.83415794373ms
2022-09-20 21:02:46 INFO  Estimated optimised what-if runtime is 13010.02049446106ms
2022-09-20 21:02:46 INFO  Estimated optimisation runtime saving is 123037.81366348267ms
2022-09-20 21:02:46 INFO  ---RUNTIME: Multi-Query Optimization took 58.21561813354492 ms
2022-09-20 21:02:46 INFO  Executing generated plans
2022-09-20 21:03:05 INFO  ---RUNTIME: Execution took 19364.482641220093 ms
2022-09-20 21:03:05 INFO  Done!
2022-09-20 21:03:05 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-20 21:03:05 INFO  Running instrumented original pipeline...
2022-09-20 21:03:05 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-20 21:03:05 INFO  ---RUNTIME: Importing and monkey-patching took 5.730390548706055 ms
2022-09-20 21:03:21 INFO  ---RUNTIME: Original pipeline execution took 15308.983564376831 ms (excluding imports and monkey-patching)
2022-09-20 21:03:21 INFO  Starting execution of 1 what-if analyses...
2022-09-20 21:03:21 INFO  Start plan generation for analysis DataCorruption...
2022-09-20 21:03:21 INFO  ---RUNTIME: Plan generation took 0.4131793975830078 ms
2022-09-20 21:03:21 INFO  Estimated runtime of original DAG is 13620.051622390747ms
2022-09-20 21:03:21 WARNING Skipping Multi-Query Optimization (instead, only combine execution DAGs)
2022-09-20 21:03:21 INFO  Estimated unoptimised what-if runtime is 340501.2905597687ms
2022-09-20 21:03:21 INFO  ---RUNTIME: Multi-Query Optimization took 125.25677680969238 ms
2022-09-20 21:03:21 INFO  Executing generated plans
2022-09-20 21:06:24 INFO  ---RUNTIME: Execution took 182918.84469985962 ms
2022-09-20 21:06:24 INFO  Done!
2022-09-20 21:06:24 INFO  # Finished -- repetition 7 of 7 
2022-09-20 21:06:24 INFO  # Final results after all repetitions
2022-09-20 21:06:24 INFO     repetition  ... no_opt_what_if_execution_combined_model_training
0           0  ...                                     29428.494453
1           1  ...                                     20273.875713
2           2  ...                                     18449.445009
3           3  ...                                     17625.481844
4           4  ...                                     29286.291838
5           5  ...                                     86203.153133
6           6  ...                                     26181.592464

[7 rows x 26 columns]
taskset -c 32-40 PROTOCOL_BUFFERS_PYTHON_IMPLEMENTATION=python python3.9 benchmarks_end_to_end.py data_corruption reviews fast_loading featurization_0 neural_network
2022-09-20 21:06:26.619249: W tensorflow/stream_executor/platform/default/dso_loader.cc:64] Could not load dynamic library 'libcudart.so.11.0'; dlerror: libcudart.so.11.0: cannot open shared object file: No such file or directory; LD_LIBRARY_PATH: /home/sgrafbe/mlwhatif/venv/lib/python3.9/site-packages/cv2/../../lib64:
2022-09-20 21:06:26.619295: I tensorflow/stream_executor/cuda/cudart_stub.cc:29] Ignore above cudart dlerror if you do not have a GPU set up on your machine.
2022-09-20 21:06:27 INFO  Patching sys.argv with ['mlwhatif', 'reviews', 'fast_loading', 'featurization_0', 'neural_network']
2022-09-20 21:06:27 INFO  Running instrumented original pipeline...
2022-09-20 21:06:27 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-20 21:06:28 INFO  ---RUNTIME: Importing and monkey-patching took 122.22790718078613 ms
2022-09-20 21:06:33.116420: W tensorflow/stream_executor/platform/default/dso_loader.cc:64] Could not load dynamic library 'libcuda.so.1'; dlerror: libcuda.so.1: cannot open shared object file: No such file or directory; LD_LIBRARY_PATH: /home/sgrafbe/mlwhatif/venv/lib/python3.9/site-packages/cv2/../../lib64:
2022-09-20 21:06:33.116458: W tensorflow/stream_executor/cuda/cuda_driver.cc:326] failed call to cuInit: UNKNOWN ERROR (303)
2022-09-20 21:06:33.116482: I tensorflow/stream_executor/cuda/cuda_diagnostics.cc:156] kernel driver does not appear to be running on this host (angus): /proc/driver/nvidia/version does not exist
2022-09-20 21:06:33.116994: I tensorflow/core/platform/cpu_feature_guard.cc:142] This TensorFlow binary is optimized with oneAPI Deep Neural Network Library (oneDNN) to use the following CPU instructions in performance-critical operations:  AVX2 FMA
To enable them in other operations, rebuild TensorFlow with the appropriate compiler flags.
2022-09-20 21:06:33.375193: I tensorflow/compiler/mlir/mlir_graph_optimization_pass.cc:176] None of the MLIR Optimization Passes are enabled (registered 2)
2022-09-20 21:06:33.387183: I tensorflow/core/platform/profile_utils/cpu_utils.cc:114] CPU Frequency: 2595130000 Hz
2022-09-20 21:06:38 INFO  ---RUNTIME: Original pipeline execution took 10281.552076339722 ms (excluding imports and monkey-patching)
2022-09-20 21:06:38 INFO  Starting execution of 0 what-if analyses...
2022-09-20 21:06:38 INFO  Estimated runtime of original DAG is 8611.064434051514ms
2022-09-20 21:06:38 INFO  Performing Multi-Query Optimization
2022-09-20 21:06:38 INFO  Estimated unoptimized what-if runtime is 0ms
2022-09-20 21:06:38 INFO  Estimated optimised what-if runtime is 0ms
2022-09-20 21:06:38 INFO  Estimated optimisation runtime saving is 0ms
2022-09-20 21:06:38 INFO  ---RUNTIME: Multi-Query Optimization took 0.5183219909667969 ms
2022-09-20 21:06:38 INFO  Executing generated plans
2022-09-20 21:06:38 INFO  ---RUNTIME: Execution took 0.0247955322265625 ms
2022-09-20 21:06:38 INFO  Done!
2022-09-20 21:06:38 INFO  # Optimization benchmark for data_corruption with args [['reviews', 'fast_loading', 'featurization_0', 'neural_network']] -- repetition 1 of 7
2022-09-20 21:06:38 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-20 21:06:38 INFO  Running instrumented original pipeline...
2022-09-20 21:06:38 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-20 21:06:38 INFO  ---RUNTIME: Importing and monkey-patching took 5.384206771850586 ms
2022-09-20 21:06:48 INFO  ---RUNTIME: Original pipeline execution took 9675.004005432129 ms (excluding imports and monkey-patching)
2022-09-20 21:06:48 INFO  Starting execution of 1 what-if analyses...
2022-09-20 21:06:48 INFO  Start plan generation for analysis DataCorruption...
2022-09-20 21:06:48 INFO  ---RUNTIME: Plan generation took 0.4570484161376953 ms
2022-09-20 21:06:48 INFO  Estimated runtime of original DAG is 8065.264463424683ms
2022-09-20 21:06:48 INFO  Performing Multi-Query Optimization
2022-09-20 21:06:48 INFO  Estimated unoptimized what-if runtime is 201631.61158561707ms
2022-09-20 21:06:48 INFO  Estimated optimised what-if runtime is 24400.002002716064ms
2022-09-20 21:06:48 INFO  Estimated optimisation runtime saving is 177231.609582901ms
2022-09-20 21:06:48 INFO  ---RUNTIME: Multi-Query Optimization took 58.0897331237793 ms
2022-09-20 21:06:48 INFO  Executing generated plans
2022-09-20 21:07:18 INFO  ---RUNTIME: Execution took 30449.30362701416 ms
2022-09-20 21:07:18 INFO  Done!
2022-09-20 21:07:18 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-20 21:07:18 INFO  Running instrumented original pipeline...
2022-09-20 21:07:18 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-20 21:07:18 INFO  ---RUNTIME: Importing and monkey-patching took 6.062984466552734 ms
2022-09-20 21:07:28 INFO  ---RUNTIME: Original pipeline execution took 9985.377311706543 ms (excluding imports and monkey-patching)
2022-09-20 21:07:28 INFO  Starting execution of 1 what-if analyses...
2022-09-20 21:07:28 INFO  Start plan generation for analysis DataCorruption...
2022-09-20 21:07:28 INFO  ---RUNTIME: Plan generation took 0.4355907440185547 ms
2022-09-20 21:07:28 INFO  Estimated runtime of original DAG is 8356.688261032104ms
2022-09-20 21:07:28 WARNING Skipping Multi-Query Optimization (instead, only combine execution DAGs)
2022-09-20 21:07:28 INFO  Estimated unoptimised what-if runtime is 208917.2065258026ms
2022-09-20 21:07:28 INFO  ---RUNTIME: Multi-Query Optimization took 124.37248229980469 ms
2022-09-20 21:07:28 INFO  Executing generated plans
2022-09-20 21:11:37 INFO  ---RUNTIME: Execution took 248385.55002212524 ms
2022-09-20 21:11:37 INFO  Done!
2022-09-20 21:11:37 INFO  # Finished -- repetition 1 of 7 
2022-09-20 21:11:37 INFO  # Optimization benchmark for data_corruption with args [['reviews', 'fast_loading', 'featurization_0', 'neural_network']] -- repetition 2 of 7
2022-09-20 21:11:37 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-20 21:11:37 INFO  Running instrumented original pipeline...
2022-09-20 21:11:37 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-20 21:11:37 INFO  ---RUNTIME: Importing and monkey-patching took 5.757808685302734 ms
2022-09-20 21:11:46 INFO  ---RUNTIME: Original pipeline execution took 9861.011743545532 ms (excluding imports and monkey-patching)
2022-09-20 21:11:46 INFO  Starting execution of 1 what-if analyses...
2022-09-20 21:11:46 INFO  Start plan generation for analysis DataCorruption...
2022-09-20 21:11:46 INFO  ---RUNTIME: Plan generation took 0.41484832763671875 ms
2022-09-20 21:11:46 INFO  Estimated runtime of original DAG is 8200.554370880127ms
2022-09-20 21:11:46 INFO  Performing Multi-Query Optimization
2022-09-20 21:11:46 INFO  Estimated unoptimized what-if runtime is 205013.85927200317ms
2022-09-20 21:11:46 INFO  Estimated optimised what-if runtime is 24748.04973602295ms
2022-09-20 21:11:46 INFO  Estimated optimisation runtime saving is 180265.80953598022ms
2022-09-20 21:11:46 INFO  ---RUNTIME: Multi-Query Optimization took 58.02583694458008 ms
2022-09-20 21:11:46 INFO  Executing generated plans
2022-09-20 21:12:17 INFO  ---RUNTIME: Execution took 30618.20387840271 ms
2022-09-20 21:12:17 INFO  Done!
2022-09-20 21:12:17 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-20 21:12:17 INFO  Running instrumented original pipeline...
2022-09-20 21:12:17 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-20 21:12:17 INFO  ---RUNTIME: Importing and monkey-patching took 5.957603454589844 ms
2022-09-20 21:12:27 INFO  ---RUNTIME: Original pipeline execution took 9877.39372253418 ms (excluding imports and monkey-patching)
2022-09-20 21:12:27 INFO  Starting execution of 1 what-if analyses...
2022-09-20 21:12:27 INFO  Start plan generation for analysis DataCorruption...
2022-09-20 21:12:27 INFO  ---RUNTIME: Plan generation took 0.4222393035888672 ms
2022-09-20 21:12:27 INFO  Estimated runtime of original DAG is 8201.942205429077ms
2022-09-20 21:12:27 WARNING Skipping Multi-Query Optimization (instead, only combine execution DAGs)
2022-09-20 21:12:27 INFO  Estimated unoptimised what-if runtime is 205048.55513572693ms
2022-09-20 21:12:27 INFO  ---RUNTIME: Multi-Query Optimization took 132.781982421875 ms
2022-09-20 21:12:27 INFO  Executing generated plans
2022-09-20 21:16:38 INFO  ---RUNTIME: Execution took 250430.06253242493 ms
2022-09-20 21:16:38 INFO  Done!
2022-09-20 21:16:38 INFO  # Finished -- repetition 2 of 7 
2022-09-20 21:16:38 INFO  # Optimization benchmark for data_corruption with args [['reviews', 'fast_loading', 'featurization_0', 'neural_network']] -- repetition 3 of 7
2022-09-20 21:16:38 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-20 21:16:38 INFO  Running instrumented original pipeline...
2022-09-20 21:16:38 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-20 21:16:38 INFO  ---RUNTIME: Importing and monkey-patching took 5.812644958496094 ms
2022-09-20 21:16:48 INFO  ---RUNTIME: Original pipeline execution took 9999.143123626709 ms (excluding imports and monkey-patching)
2022-09-20 21:16:48 INFO  Starting execution of 1 what-if analyses...
2022-09-20 21:16:48 INFO  Start plan generation for analysis DataCorruption...
2022-09-20 21:16:48 INFO  ---RUNTIME: Plan generation took 0.40030479431152344 ms
2022-09-20 21:16:48 INFO  Estimated runtime of original DAG is 8319.120168685913ms
2022-09-20 21:16:48 INFO  Performing Multi-Query Optimization
2022-09-20 21:16:48 INFO  Estimated unoptimized what-if runtime is 207978.00421714783ms
2022-09-20 21:16:48 INFO  Estimated optimised what-if runtime is 24860.087156295776ms
2022-09-20 21:16:48 INFO  Estimated optimisation runtime saving is 183117.91706085205ms
2022-09-20 21:16:48 INFO  ---RUNTIME: Multi-Query Optimization took 57.14559555053711 ms
2022-09-20 21:16:48 INFO  Executing generated plans
2022-09-20 21:17:17 INFO  ---RUNTIME: Execution took 29869.757890701294 ms
2022-09-20 21:17:17 INFO  Done!
2022-09-20 21:17:18 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-20 21:17:18 INFO  Running instrumented original pipeline...
2022-09-20 21:17:18 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-20 21:17:18 INFO  ---RUNTIME: Importing and monkey-patching took 6.291866302490234 ms
2022-09-20 21:17:27 INFO  ---RUNTIME: Original pipeline execution took 9937.402486801147 ms (excluding imports and monkey-patching)
2022-09-20 21:17:27 INFO  Starting execution of 1 what-if analyses...
2022-09-20 21:17:27 INFO  Start plan generation for analysis DataCorruption...
2022-09-20 21:17:27 INFO  ---RUNTIME: Plan generation took 0.42700767517089844 ms
2022-09-20 21:17:27 INFO  Estimated runtime of original DAG is 8276.484966278076ms
2022-09-20 21:17:27 WARNING Skipping Multi-Query Optimization (instead, only combine execution DAGs)
2022-09-20 21:17:28 INFO  Estimated unoptimised what-if runtime is 206912.1241569519ms
2022-09-20 21:17:28 INFO  ---RUNTIME: Multi-Query Optimization took 122.69330024719238 ms
2022-09-20 21:17:28 INFO  Executing generated plans
2022-09-20 21:21:41 INFO  ---RUNTIME: Execution took 253865.39602279663 ms
2022-09-20 21:21:41 INFO  Done!
2022-09-20 21:21:41 INFO  # Finished -- repetition 3 of 7 
2022-09-20 21:21:41 INFO  # Optimization benchmark for data_corruption with args [['reviews', 'fast_loading', 'featurization_0', 'neural_network']] -- repetition 4 of 7
2022-09-20 21:21:41 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-20 21:21:41 INFO  Running instrumented original pipeline...
2022-09-20 21:21:41 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-20 21:21:41 INFO  ---RUNTIME: Importing and monkey-patching took 5.916833877563477 ms
2022-09-20 21:21:51 INFO  ---RUNTIME: Original pipeline execution took 9987.136363983154 ms (excluding imports and monkey-patching)
2022-09-20 21:21:51 INFO  Starting execution of 1 what-if analyses...
2022-09-20 21:21:51 INFO  Start plan generation for analysis DataCorruption...
2022-09-20 21:21:51 INFO  ---RUNTIME: Plan generation took 0.4398822784423828 ms
2022-09-20 21:21:51 INFO  Estimated runtime of original DAG is 8286.740064620972ms
2022-09-20 21:21:51 INFO  Performing Multi-Query Optimization
2022-09-20 21:21:51 INFO  Estimated unoptimized what-if runtime is 207168.5016155243ms
2022-09-20 21:21:51 INFO  Estimated optimised what-if runtime is 24418.654680252075ms
2022-09-20 21:21:51 INFO  Estimated optimisation runtime saving is 182749.84693527222ms
2022-09-20 21:21:51 INFO  ---RUNTIME: Multi-Query Optimization took 57.87920951843262 ms
2022-09-20 21:21:51 INFO  Executing generated plans
2022-09-20 21:22:22 INFO  ---RUNTIME: Execution took 30901.982307434082 ms
2022-09-20 21:22:22 INFO  Done!
2022-09-20 21:22:22 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-20 21:22:22 INFO  Running instrumented original pipeline...
2022-09-20 21:22:22 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-20 21:22:22 INFO  ---RUNTIME: Importing and monkey-patching took 6.070613861083984 ms
2022-09-20 21:22:33 INFO  ---RUNTIME: Original pipeline execution took 10134.597063064575 ms (excluding imports and monkey-patching)
2022-09-20 21:22:33 INFO  Starting execution of 1 what-if analyses...
2022-09-20 21:22:33 INFO  Start plan generation for analysis DataCorruption...
2022-09-20 21:22:33 INFO  ---RUNTIME: Plan generation took 0.46443939208984375 ms
2022-09-20 21:22:33 INFO  Estimated runtime of original DAG is 8383.602380752563ms
2022-09-20 21:22:33 WARNING Skipping Multi-Query Optimization (instead, only combine execution DAGs)
2022-09-20 21:22:33 INFO  Estimated unoptimised what-if runtime is 209590.0595188141ms
2022-09-20 21:22:33 INFO  ---RUNTIME: Multi-Query Optimization took 126.35612487792969 ms
2022-09-20 21:22:33 INFO  Executing generated plans
2022-09-20 21:26:46 INFO  ---RUNTIME: Execution took 253049.35383796692 ms
2022-09-20 21:26:46 INFO  Done!
2022-09-20 21:26:46 INFO  # Finished -- repetition 4 of 7 
2022-09-20 21:26:46 INFO  # Optimization benchmark for data_corruption with args [['reviews', 'fast_loading', 'featurization_0', 'neural_network']] -- repetition 5 of 7
2022-09-20 21:26:46 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-20 21:26:46 INFO  Running instrumented original pipeline...
2022-09-20 21:26:46 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-20 21:26:46 INFO  ---RUNTIME: Importing and monkey-patching took 5.824804306030273 ms
2022-09-20 21:26:56 INFO  ---RUNTIME: Original pipeline execution took 10437.203407287598 ms (excluding imports and monkey-patching)
2022-09-20 21:26:56 INFO  Starting execution of 1 what-if analyses...
2022-09-20 21:26:56 INFO  Start plan generation for analysis DataCorruption...
2022-09-20 21:26:56 INFO  ---RUNTIME: Plan generation took 0.3902912139892578 ms
2022-09-20 21:26:56 INFO  Estimated runtime of original DAG is 8748.4450340271ms
2022-09-20 21:26:56 INFO  Performing Multi-Query Optimization
2022-09-20 21:26:56 INFO  Estimated unoptimized what-if runtime is 218711.1258506775ms
2022-09-20 21:26:56 INFO  Estimated optimised what-if runtime is 25070.69420814514ms
2022-09-20 21:26:56 INFO  Estimated optimisation runtime saving is 193640.43164253235ms
2022-09-20 21:26:56 INFO  ---RUNTIME: Multi-Query Optimization took 59.339046478271484 ms
2022-09-20 21:26:56 INFO  Executing generated plans
2022-09-20 21:27:26 INFO  ---RUNTIME: Execution took 30004.802942276 ms
2022-09-20 21:27:26 INFO  Done!
2022-09-20 21:27:26 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-20 21:27:26 INFO  Running instrumented original pipeline...
2022-09-20 21:27:26 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-20 21:27:26 INFO  ---RUNTIME: Importing and monkey-patching took 6.16145133972168 ms
2022-09-20 21:27:36 INFO  ---RUNTIME: Original pipeline execution took 9924.13306236267 ms (excluding imports and monkey-patching)
2022-09-20 21:27:36 INFO  Starting execution of 1 what-if analyses...
2022-09-20 21:27:36 INFO  Start plan generation for analysis DataCorruption...
2022-09-20 21:27:36 INFO  ---RUNTIME: Plan generation took 0.4127025604248047 ms
2022-09-20 21:27:36 INFO  Estimated runtime of original DAG is 8232.771158218384ms
2022-09-20 21:27:36 WARNING Skipping Multi-Query Optimization (instead, only combine execution DAGs)
2022-09-20 21:27:36 INFO  Estimated unoptimised what-if runtime is 205819.2789554596ms
2022-09-20 21:27:36 INFO  ---RUNTIME: Multi-Query Optimization took 125.00357627868652 ms
2022-09-20 21:27:36 INFO  Executing generated plans
2022-09-20 21:31:49 INFO  ---RUNTIME: Execution took 252449.31364059448 ms
2022-09-20 21:31:49 INFO  Done!
2022-09-20 21:31:49 INFO  # Finished -- repetition 5 of 7 
2022-09-20 21:31:49 INFO  # Optimization benchmark for data_corruption with args [['reviews', 'fast_loading', 'featurization_0', 'neural_network']] -- repetition 6 of 7
2022-09-20 21:31:49 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-20 21:31:49 INFO  Running instrumented original pipeline...
2022-09-20 21:31:49 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-20 21:31:49 INFO  ---RUNTIME: Importing and monkey-patching took 6.519794464111328 ms
2022-09-20 21:31:59 INFO  ---RUNTIME: Original pipeline execution took 10369.81987953186 ms (excluding imports and monkey-patching)
2022-09-20 21:31:59 INFO  Starting execution of 1 what-if analyses...
2022-09-20 21:31:59 INFO  Start plan generation for analysis DataCorruption...
2022-09-20 21:31:59 INFO  ---RUNTIME: Plan generation took 0.42700767517089844 ms
2022-09-20 21:31:59 INFO  Estimated runtime of original DAG is 8656.73828125ms
2022-09-20 21:31:59 INFO  Performing Multi-Query Optimization
2022-09-20 21:31:59 INFO  Estimated unoptimized what-if runtime is 216418.45703125ms
2022-09-20 21:31:59 INFO  Estimated optimised what-if runtime is 25588.032007217407ms
2022-09-20 21:31:59 INFO  Estimated optimisation runtime saving is 190830.4250240326ms
2022-09-20 21:31:59 INFO  ---RUNTIME: Multi-Query Optimization took 63.875436782836914 ms
2022-09-20 21:31:59 INFO  Executing generated plans
2022-09-20 21:32:29 INFO  ---RUNTIME: Execution took 30244.374752044678 ms
2022-09-20 21:32:29 INFO  Done!
2022-09-20 21:32:29 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-20 21:32:29 INFO  Running instrumented original pipeline...
2022-09-20 21:32:29 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-20 21:32:30 INFO  ---RUNTIME: Importing and monkey-patching took 6.655454635620117 ms
2022-09-20 21:32:39 INFO  ---RUNTIME: Original pipeline execution took 9988.027572631836 ms (excluding imports and monkey-patching)
2022-09-20 21:32:39 INFO  Starting execution of 1 what-if analyses...
2022-09-20 21:32:39 INFO  Start plan generation for analysis DataCorruption...
2022-09-20 21:32:39 INFO  ---RUNTIME: Plan generation took 0.40435791015625 ms
2022-09-20 21:32:39 INFO  Estimated runtime of original DAG is 8296.233892440796ms
2022-09-20 21:32:39 WARNING Skipping Multi-Query Optimization (instead, only combine execution DAGs)
2022-09-20 21:32:40 INFO  Estimated unoptimised what-if runtime is 207405.8473110199ms
2022-09-20 21:32:40 INFO  ---RUNTIME: Multi-Query Optimization took 1000.739574432373 ms
2022-09-20 21:32:40 INFO  Executing generated plans
2022-09-20 21:36:54 INFO  ---RUNTIME: Execution took 253098.60253334045 ms
2022-09-20 21:36:54 INFO  Done!
2022-09-20 21:36:54 INFO  # Finished -- repetition 6 of 7 
2022-09-20 21:36:54 INFO  # Optimization benchmark for data_corruption with args [['reviews', 'fast_loading', 'featurization_0', 'neural_network']] -- repetition 7 of 7
2022-09-20 21:36:54 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-20 21:36:54 INFO  Running instrumented original pipeline...
2022-09-20 21:36:54 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-20 21:36:54 INFO  ---RUNTIME: Importing and monkey-patching took 6.403207778930664 ms
2022-09-20 21:37:04 INFO  ---RUNTIME: Original pipeline execution took 10104.36749458313 ms (excluding imports and monkey-patching)
2022-09-20 21:37:04 INFO  Starting execution of 1 what-if analyses...
2022-09-20 21:37:04 INFO  Start plan generation for analysis DataCorruption...
2022-09-20 21:37:04 INFO  ---RUNTIME: Plan generation took 0.4787445068359375 ms
2022-09-20 21:37:04 INFO  Estimated runtime of original DAG is 8390.510320663452ms
2022-09-20 21:37:04 INFO  Performing Multi-Query Optimization
2022-09-20 21:37:04 INFO  Estimated unoptimized what-if runtime is 209762.7580165863ms
2022-09-20 21:37:04 INFO  Estimated optimised what-if runtime is 25909.785747528076ms
2022-09-20 21:37:04 INFO  Estimated optimisation runtime saving is 183852.97226905823ms
2022-09-20 21:37:04 INFO  ---RUNTIME: Multi-Query Optimization took 63.44485282897949 ms
2022-09-20 21:37:04 INFO  Executing generated plans
2022-09-20 21:37:34 INFO  ---RUNTIME: Execution took 30660.37082672119 ms
2022-09-20 21:37:34 INFO  Done!
2022-09-20 21:37:34 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-20 21:37:34 INFO  Running instrumented original pipeline...
2022-09-20 21:37:34 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-20 21:37:34 INFO  ---RUNTIME: Importing and monkey-patching took 6.032705307006836 ms
2022-09-20 21:37:45 INFO  ---RUNTIME: Original pipeline execution took 10996.833324432373 ms (excluding imports and monkey-patching)
2022-09-20 21:37:45 INFO  Starting execution of 1 what-if analyses...
2022-09-20 21:37:45 INFO  Start plan generation for analysis DataCorruption...
2022-09-20 21:37:45 INFO  ---RUNTIME: Plan generation took 0.4596710205078125 ms
2022-09-20 21:37:45 INFO  Estimated runtime of original DAG is 8408.405780792236ms
2022-09-20 21:37:45 WARNING Skipping Multi-Query Optimization (instead, only combine execution DAGs)
2022-09-20 21:37:46 INFO  Estimated unoptimised what-if runtime is 210210.1445198059ms
2022-09-20 21:37:46 INFO  ---RUNTIME: Multi-Query Optimization took 123.81148338317871 ms
2022-09-20 21:37:46 INFO  Executing generated plans
2022-09-20 21:42:00 INFO  ---RUNTIME: Execution took 254076.5733718872 ms
2022-09-20 21:42:00 INFO  Done!
2022-09-20 21:42:00 INFO  # Finished -- repetition 7 of 7 
2022-09-20 21:42:00 INFO  # Final results after all repetitions
2022-09-20 21:42:00 INFO     repetition  ... no_opt_what_if_execution_combined_model_training
0           0  ...                                     83658.315420
1           1  ...                                     84915.795803
2           2  ...                                     86868.000746
3           3  ...                                     88189.835310
4           4  ...                                     89532.370329
5           5  ...                                     89542.664289
6           6  ...                                     91340.197563

[7 rows x 26 columns]
taskset -c 32-40 PROTOCOL_BUFFERS_PYTHON_IMPLEMENTATION=python python3.9 benchmarks_end_to_end.py data_corruption reviews fast_loading featurization_1 logistic_regression
2022-09-20 21:42:03.076956: W tensorflow/stream_executor/platform/default/dso_loader.cc:64] Could not load dynamic library 'libcudart.so.11.0'; dlerror: libcudart.so.11.0: cannot open shared object file: No such file or directory; LD_LIBRARY_PATH: /home/sgrafbe/mlwhatif/venv/lib/python3.9/site-packages/cv2/../../lib64:
2022-09-20 21:42:03.077004: I tensorflow/stream_executor/cuda/cudart_stub.cc:29] Ignore above cudart dlerror if you do not have a GPU set up on your machine.
2022-09-20 21:42:04 INFO  Patching sys.argv with ['mlwhatif', 'reviews', 'fast_loading', 'featurization_1', 'logistic_regression']
2022-09-20 21:42:04 INFO  Running instrumented original pipeline...
2022-09-20 21:42:04 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-20 21:42:04 INFO  ---RUNTIME: Importing and monkey-patching took 123.15225601196289 ms
2022-09-20 21:42:11 INFO  ---RUNTIME: Original pipeline execution took 7143.489599227905 ms (excluding imports and monkey-patching)
2022-09-20 21:42:11 INFO  Starting execution of 0 what-if analyses...
2022-09-20 21:42:11 INFO  Estimated runtime of original DAG is 4883.0015659332275ms
2022-09-20 21:42:11 INFO  Performing Multi-Query Optimization
2022-09-20 21:42:11 INFO  Estimated unoptimized what-if runtime is 0ms
2022-09-20 21:42:11 INFO  Estimated optimised what-if runtime is 0ms
2022-09-20 21:42:11 INFO  Estimated optimisation runtime saving is 0ms
2022-09-20 21:42:11 INFO  ---RUNTIME: Multi-Query Optimization took 0.5121231079101562 ms
2022-09-20 21:42:11 INFO  Executing generated plans
2022-09-20 21:42:11 INFO  ---RUNTIME: Execution took 0.028371810913085938 ms
2022-09-20 21:42:11 INFO  Done!
2022-09-20 21:42:11 INFO  # Optimization benchmark for data_corruption with args [['reviews', 'fast_loading', 'featurization_1', 'logistic_regression']] -- repetition 1 of 7
2022-09-20 21:42:11 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-20 21:42:11 INFO  Running instrumented original pipeline...
2022-09-20 21:42:11 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-20 21:42:11 INFO  ---RUNTIME: Importing and monkey-patching took 6.157636642456055 ms
2022-09-20 21:42:18 INFO  ---RUNTIME: Original pipeline execution took 7193.090200424194 ms (excluding imports and monkey-patching)
2022-09-20 21:42:18 INFO  Starting execution of 1 what-if analyses...
2022-09-20 21:42:18 INFO  Start plan generation for analysis DataCorruption...
2022-09-20 21:42:18 INFO  ---RUNTIME: Plan generation took 0.5748271942138672 ms
2022-09-20 21:42:18 INFO  Estimated runtime of original DAG is 4846.988916397095ms
2022-09-20 21:42:18 INFO  Performing Multi-Query Optimization
2022-09-20 21:42:18 INFO  Estimated unoptimized what-if runtime is 121174.72290992737ms
2022-09-20 21:42:18 INFO  Estimated optimised what-if runtime is 11495.439529418945ms
2022-09-20 21:42:18 INFO  Estimated optimisation runtime saving is 109679.28338050842ms
2022-09-20 21:42:18 INFO  ---RUNTIME: Multi-Query Optimization took 62.0877742767334 ms
2022-09-20 21:42:18 INFO  Executing generated plans
2022-09-20 21:42:36 INFO  ---RUNTIME: Execution took 17545.67050933838 ms
2022-09-20 21:42:36 INFO  Done!
2022-09-20 21:42:36 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-20 21:42:36 INFO  Running instrumented original pipeline...
2022-09-20 21:42:36 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-20 21:42:36 INFO  ---RUNTIME: Importing and monkey-patching took 6.37507438659668 ms
2022-09-20 21:42:43 INFO  ---RUNTIME: Original pipeline execution took 7029.12712097168 ms (excluding imports and monkey-patching)
2022-09-20 21:42:43 INFO  Starting execution of 1 what-if analyses...
2022-09-20 21:42:43 INFO  Start plan generation for analysis DataCorruption...
2022-09-20 21:42:43 INFO  ---RUNTIME: Plan generation took 0.5793571472167969 ms
2022-09-20 21:42:43 INFO  Estimated runtime of original DAG is 4851.681470870972ms
2022-09-20 21:42:43 WARNING Skipping Multi-Query Optimization (instead, only combine execution DAGs)
2022-09-20 21:42:43 INFO  Estimated unoptimised what-if runtime is 121292.03677177429ms
2022-09-20 21:42:43 INFO  ---RUNTIME: Multi-Query Optimization took 135.0553035736084 ms
2022-09-20 21:42:43 INFO  Executing generated plans
2022-09-20 21:45:18 INFO  ---RUNTIME: Execution took 154569.19479370117 ms
2022-09-20 21:45:18 INFO  Done!
2022-09-20 21:45:18 INFO  # Finished -- repetition 1 of 7 
2022-09-20 21:45:18 INFO  # Optimization benchmark for data_corruption with args [['reviews', 'fast_loading', 'featurization_1', 'logistic_regression']] -- repetition 2 of 7
2022-09-20 21:45:18 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-20 21:45:18 INFO  Running instrumented original pipeline...
2022-09-20 21:45:18 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-20 21:45:18 INFO  ---RUNTIME: Importing and monkey-patching took 6.5250396728515625 ms
2022-09-20 21:45:25 INFO  ---RUNTIME: Original pipeline execution took 7095.461368560791 ms (excluding imports and monkey-patching)
2022-09-20 21:45:25 INFO  Starting execution of 1 what-if analyses...
2022-09-20 21:45:25 INFO  Start plan generation for analysis DataCorruption...
2022-09-20 21:45:25 INFO  ---RUNTIME: Plan generation took 0.553131103515625 ms
2022-09-20 21:45:25 INFO  Estimated runtime of original DAG is 4858.649730682373ms
2022-09-20 21:45:25 INFO  Performing Multi-Query Optimization
2022-09-20 21:45:25 INFO  Estimated unoptimized what-if runtime is 121466.24326705933ms
2022-09-20 21:45:25 INFO  Estimated optimised what-if runtime is 11555.611610412598ms
2022-09-20 21:45:25 INFO  Estimated optimisation runtime saving is 109910.63165664673ms
2022-09-20 21:45:25 INFO  ---RUNTIME: Multi-Query Optimization took 61.94567680358887 ms
2022-09-20 21:45:25 INFO  Executing generated plans
2022-09-20 21:45:42 INFO  ---RUNTIME: Execution took 17463.72079849243 ms
2022-09-20 21:45:42 INFO  Done!
2022-09-20 21:45:42 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-20 21:45:42 INFO  Running instrumented original pipeline...
2022-09-20 21:45:42 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-20 21:45:42 INFO  ---RUNTIME: Importing and monkey-patching took 5.737543106079102 ms
2022-09-20 21:45:49 INFO  ---RUNTIME: Original pipeline execution took 7098.685264587402 ms (excluding imports and monkey-patching)
2022-09-20 21:45:49 INFO  Starting execution of 1 what-if analyses...
2022-09-20 21:45:49 INFO  Start plan generation for analysis DataCorruption...
2022-09-20 21:45:49 INFO  ---RUNTIME: Plan generation took 0.5197525024414062 ms
2022-09-20 21:45:49 INFO  Estimated runtime of original DAG is 4847.426652908325ms
2022-09-20 21:45:49 WARNING Skipping Multi-Query Optimization (instead, only combine execution DAGs)
2022-09-20 21:45:50 INFO  Estimated unoptimised what-if runtime is 121185.66632270813ms
2022-09-20 21:45:50 INFO  ---RUNTIME: Multi-Query Optimization took 338.5324478149414 ms
2022-09-20 21:45:50 INFO  Executing generated plans
2022-09-20 21:48:25 INFO  ---RUNTIME: Execution took 155057.64937400818 ms
2022-09-20 21:48:25 INFO  Done!
2022-09-20 21:48:25 INFO  # Finished -- repetition 2 of 7 
2022-09-20 21:48:25 INFO  # Optimization benchmark for data_corruption with args [['reviews', 'fast_loading', 'featurization_1', 'logistic_regression']] -- repetition 3 of 7
2022-09-20 21:48:25 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-20 21:48:25 INFO  Running instrumented original pipeline...
2022-09-20 21:48:25 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-20 21:48:25 INFO  ---RUNTIME: Importing and monkey-patching took 6.253480911254883 ms
2022-09-20 21:48:32 INFO  ---RUNTIME: Original pipeline execution took 7151.1969566345215 ms (excluding imports and monkey-patching)
2022-09-20 21:48:32 INFO  Starting execution of 1 what-if analyses...
2022-09-20 21:48:32 INFO  Start plan generation for analysis DataCorruption...
2022-09-20 21:48:32 INFO  ---RUNTIME: Plan generation took 0.5328655242919922 ms
2022-09-20 21:48:32 INFO  Estimated runtime of original DAG is 4899.392604827881ms
2022-09-20 21:48:32 INFO  Performing Multi-Query Optimization
2022-09-20 21:48:32 INFO  Estimated unoptimized what-if runtime is 122484.81512069702ms
2022-09-20 21:48:32 INFO  Estimated optimised what-if runtime is 11584.938764572144ms
2022-09-20 21:48:32 INFO  Estimated optimisation runtime saving is 110899.87635612488ms
2022-09-20 21:48:32 INFO  ---RUNTIME: Multi-Query Optimization took 61.62095069885254 ms
2022-09-20 21:48:32 INFO  Executing generated plans
2022-09-20 21:48:50 INFO  ---RUNTIME: Execution took 17605.674028396606 ms
2022-09-20 21:48:50 INFO  Done!
2022-09-20 21:48:50 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-20 21:48:50 INFO  Running instrumented original pipeline...
2022-09-20 21:48:50 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-20 21:48:50 INFO  ---RUNTIME: Importing and monkey-patching took 5.954265594482422 ms
2022-09-20 21:48:57 INFO  ---RUNTIME: Original pipeline execution took 7146.750926971436 ms (excluding imports and monkey-patching)
2022-09-20 21:48:57 INFO  Starting execution of 1 what-if analyses...
2022-09-20 21:48:57 INFO  Start plan generation for analysis DataCorruption...
2022-09-20 21:48:57 INFO  ---RUNTIME: Plan generation took 0.5576610565185547 ms
2022-09-20 21:48:57 INFO  Estimated runtime of original DAG is 4885.524749755859ms
2022-09-20 21:48:57 WARNING Skipping Multi-Query Optimization (instead, only combine execution DAGs)
2022-09-20 21:48:57 INFO  Estimated unoptimised what-if runtime is 122138.11874389648ms
2022-09-20 21:48:57 INFO  ---RUNTIME: Multi-Query Optimization took 135.56671142578125 ms
2022-09-20 21:48:57 INFO  Executing generated plans
2022-09-20 21:51:32 INFO  ---RUNTIME: Execution took 154952.28099822998 ms
2022-09-20 21:51:32 INFO  Done!
2022-09-20 21:51:32 INFO  # Finished -- repetition 3 of 7 
2022-09-20 21:51:32 INFO  # Optimization benchmark for data_corruption with args [['reviews', 'fast_loading', 'featurization_1', 'logistic_regression']] -- repetition 4 of 7
2022-09-20 21:51:32 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-20 21:51:32 INFO  Running instrumented original pipeline...
2022-09-20 21:51:32 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-20 21:51:32 INFO  ---RUNTIME: Importing and monkey-patching took 6.130456924438477 ms
2022-09-20 21:51:39 INFO  ---RUNTIME: Original pipeline execution took 7517.274856567383 ms (excluding imports and monkey-patching)
2022-09-20 21:51:39 INFO  Starting execution of 1 what-if analyses...
2022-09-20 21:51:39 INFO  Start plan generation for analysis DataCorruption...
2022-09-20 21:51:39 INFO  ---RUNTIME: Plan generation took 0.5257129669189453 ms
2022-09-20 21:51:39 INFO  Estimated runtime of original DAG is 4934.842586517334ms
2022-09-20 21:51:39 INFO  Performing Multi-Query Optimization
2022-09-20 21:51:40 INFO  Estimated unoptimized what-if runtime is 123371.06466293335ms
2022-09-20 21:51:40 INFO  Estimated optimised what-if runtime is 11645.899295806885ms
2022-09-20 21:51:40 INFO  Estimated optimisation runtime saving is 111725.16536712646ms
2022-09-20 21:51:40 INFO  ---RUNTIME: Multi-Query Optimization took 61.80000305175781 ms
2022-09-20 21:51:40 INFO  Executing generated plans
2022-09-20 21:51:57 INFO  ---RUNTIME: Execution took 17753.579139709473 ms
2022-09-20 21:51:57 INFO  Done!
2022-09-20 21:51:57 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-20 21:51:57 INFO  Running instrumented original pipeline...
2022-09-20 21:51:57 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-20 21:51:57 INFO  ---RUNTIME: Importing and monkey-patching took 6.227016448974609 ms
2022-09-20 21:52:05 INFO  ---RUNTIME: Original pipeline execution took 7217.134475708008 ms (excluding imports and monkey-patching)
2022-09-20 21:52:05 INFO  Starting execution of 1 what-if analyses...
2022-09-20 21:52:05 INFO  Start plan generation for analysis DataCorruption...
2022-09-20 21:52:05 INFO  ---RUNTIME: Plan generation took 0.5745887756347656 ms
2022-09-20 21:52:05 INFO  Estimated runtime of original DAG is 4913.038492202759ms
2022-09-20 21:52:05 WARNING Skipping Multi-Query Optimization (instead, only combine execution DAGs)
2022-09-20 21:52:05 INFO  Estimated unoptimised what-if runtime is 122825.96230506897ms
2022-09-20 21:52:05 INFO  ---RUNTIME: Multi-Query Optimization took 137.85457611083984 ms
2022-09-20 21:52:05 INFO  Executing generated plans
2022-09-20 21:54:40 INFO  ---RUNTIME: Execution took 155443.98951530457 ms
2022-09-20 21:54:40 INFO  Done!
2022-09-20 21:54:40 INFO  # Finished -- repetition 4 of 7 
2022-09-20 21:54:40 INFO  # Optimization benchmark for data_corruption with args [['reviews', 'fast_loading', 'featurization_1', 'logistic_regression']] -- repetition 5 of 7
2022-09-20 21:54:40 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-20 21:54:40 INFO  Running instrumented original pipeline...
2022-09-20 21:54:40 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-20 21:54:40 INFO  ---RUNTIME: Importing and monkey-patching took 7.4310302734375 ms
2022-09-20 21:54:47 INFO  ---RUNTIME: Original pipeline execution took 7218.634843826294 ms (excluding imports and monkey-patching)
2022-09-20 21:54:47 INFO  Starting execution of 1 what-if analyses...
2022-09-20 21:54:47 INFO  Start plan generation for analysis DataCorruption...
2022-09-20 21:54:47 INFO  ---RUNTIME: Plan generation took 0.5426406860351562 ms
2022-09-20 21:54:47 INFO  Estimated runtime of original DAG is 4944.4591999053955ms
2022-09-20 21:54:47 INFO  Performing Multi-Query Optimization
2022-09-20 21:54:47 INFO  Estimated unoptimized what-if runtime is 123611.47999763489ms
2022-09-20 21:54:47 INFO  Estimated optimised what-if runtime is 11673.316478729248ms
2022-09-20 21:54:47 INFO  Estimated optimisation runtime saving is 111938.16351890564ms
2022-09-20 21:54:47 INFO  ---RUNTIME: Multi-Query Optimization took 62.19220161437988 ms
2022-09-20 21:54:47 INFO  Executing generated plans
2022-09-20 21:55:05 INFO  ---RUNTIME: Execution took 17576.05743408203 ms
2022-09-20 21:55:05 INFO  Done!
2022-09-20 21:55:05 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-20 21:55:05 INFO  Running instrumented original pipeline...
2022-09-20 21:55:05 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-20 21:55:05 INFO  ---RUNTIME: Importing and monkey-patching took 6.432294845581055 ms
2022-09-20 21:55:12 INFO  ---RUNTIME: Original pipeline execution took 7137.33434677124 ms (excluding imports and monkey-patching)
2022-09-20 21:55:12 INFO  Starting execution of 1 what-if analyses...
2022-09-20 21:55:12 INFO  Start plan generation for analysis DataCorruption...
2022-09-20 21:55:12 INFO  ---RUNTIME: Plan generation took 0.5629062652587891 ms
2022-09-20 21:55:12 INFO  Estimated runtime of original DAG is 4885.708332061768ms
2022-09-20 21:55:12 WARNING Skipping Multi-Query Optimization (instead, only combine execution DAGs)
2022-09-20 21:55:12 INFO  Estimated unoptimised what-if runtime is 122142.70830154419ms
2022-09-20 21:55:12 INFO  ---RUNTIME: Multi-Query Optimization took 135.9844207763672 ms
2022-09-20 21:55:12 INFO  Executing generated plans
2022-09-20 21:57:48 INFO  ---RUNTIME: Execution took 155725.21495819092 ms
2022-09-20 21:57:48 INFO  Done!
2022-09-20 21:57:48 INFO  # Finished -- repetition 5 of 7 
2022-09-20 21:57:48 INFO  # Optimization benchmark for data_corruption with args [['reviews', 'fast_loading', 'featurization_1', 'logistic_regression']] -- repetition 6 of 7
2022-09-20 21:57:48 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-20 21:57:48 INFO  Running instrumented original pipeline...
2022-09-20 21:57:48 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-20 21:57:48 INFO  ---RUNTIME: Importing and monkey-patching took 6.442785263061523 ms
2022-09-20 21:57:55 INFO  ---RUNTIME: Original pipeline execution took 7258.414030075073 ms (excluding imports and monkey-patching)
2022-09-20 21:57:55 INFO  Starting execution of 1 what-if analyses...
2022-09-20 21:57:55 INFO  Start plan generation for analysis DataCorruption...
2022-09-20 21:57:55 INFO  ---RUNTIME: Plan generation took 0.5354881286621094 ms
2022-09-20 21:57:55 INFO  Estimated runtime of original DAG is 4961.06219291687ms
2022-09-20 21:57:55 INFO  Performing Multi-Query Optimization
2022-09-20 21:57:55 INFO  Estimated unoptimized what-if runtime is 124026.55482292175ms
2022-09-20 21:57:55 INFO  Estimated optimised what-if runtime is 11674.508094787598ms
2022-09-20 21:57:55 INFO  Estimated optimisation runtime saving is 112352.04672813416ms
2022-09-20 21:57:55 INFO  ---RUNTIME: Multi-Query Optimization took 62.11113929748535 ms
2022-09-20 21:57:55 INFO  Executing generated plans
2022-09-20 21:58:13 INFO  ---RUNTIME: Execution took 17745.24974822998 ms
2022-09-20 21:58:13 INFO  Done!
2022-09-20 21:58:13 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-20 21:58:13 INFO  Running instrumented original pipeline...
2022-09-20 21:58:13 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-20 21:58:13 INFO  ---RUNTIME: Importing and monkey-patching took 5.740880966186523 ms
2022-09-20 21:58:20 INFO  ---RUNTIME: Original pipeline execution took 7261.5931034088135 ms (excluding imports and monkey-patching)
2022-09-20 21:58:20 INFO  Starting execution of 1 what-if analyses...
2022-09-20 21:58:20 INFO  Start plan generation for analysis DataCorruption...
2022-09-20 21:58:20 INFO  ---RUNTIME: Plan generation took 0.5233287811279297 ms
2022-09-20 21:58:20 INFO  Estimated runtime of original DAG is 4943.667650222778ms
2022-09-20 21:58:20 WARNING Skipping Multi-Query Optimization (instead, only combine execution DAGs)
2022-09-20 21:58:21 INFO  Estimated unoptimised what-if runtime is 123591.69125556946ms
2022-09-20 21:58:21 INFO  ---RUNTIME: Multi-Query Optimization took 136.97004318237305 ms
2022-09-20 21:58:21 INFO  Executing generated plans
2022-09-20 22:00:56 INFO  ---RUNTIME: Execution took 155306.39600753784 ms
2022-09-20 22:00:56 INFO  Done!
2022-09-20 22:00:56 INFO  # Finished -- repetition 6 of 7 
2022-09-20 22:00:56 INFO  # Optimization benchmark for data_corruption with args [['reviews', 'fast_loading', 'featurization_1', 'logistic_regression']] -- repetition 7 of 7
2022-09-20 22:00:56 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-20 22:00:56 INFO  Running instrumented original pipeline...
2022-09-20 22:00:56 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-20 22:00:56 INFO  ---RUNTIME: Importing and monkey-patching took 6.874799728393555 ms
2022-09-20 22:01:03 INFO  ---RUNTIME: Original pipeline execution took 7249.969959259033 ms (excluding imports and monkey-patching)
2022-09-20 22:01:03 INFO  Starting execution of 1 what-if analyses...
2022-09-20 22:01:03 INFO  Start plan generation for analysis DataCorruption...
2022-09-20 22:01:03 INFO  ---RUNTIME: Plan generation took 0.5521774291992188 ms
2022-09-20 22:01:03 INFO  Estimated runtime of original DAG is 4947.531461715698ms
2022-09-20 22:01:03 INFO  Performing Multi-Query Optimization
2022-09-20 22:01:03 INFO  Estimated unoptimized what-if runtime is 123688.28654289246ms
2022-09-20 22:01:03 INFO  Estimated optimised what-if runtime is 11671.397686004639ms
2022-09-20 22:01:03 INFO  Estimated optimisation runtime saving is 112016.88885688782ms
2022-09-20 22:01:03 INFO  ---RUNTIME: Multi-Query Optimization took 62.22796440124512 ms
2022-09-20 22:01:03 INFO  Executing generated plans
2022-09-20 22:01:21 INFO  ---RUNTIME: Execution took 17705.28554916382 ms
2022-09-20 22:01:21 INFO  Done!
2022-09-20 22:01:21 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-20 22:01:21 INFO  Running instrumented original pipeline...
2022-09-20 22:01:21 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-20 22:01:21 INFO  ---RUNTIME: Importing and monkey-patching took 5.987405776977539 ms
2022-09-20 22:01:28 INFO  ---RUNTIME: Original pipeline execution took 7211.01713180542 ms (excluding imports and monkey-patching)
2022-09-20 22:01:28 INFO  Starting execution of 1 what-if analyses...
2022-09-20 22:01:28 INFO  Start plan generation for analysis DataCorruption...
2022-09-20 22:01:28 INFO  ---RUNTIME: Plan generation took 0.5452632904052734 ms
2022-09-20 22:01:28 INFO  Estimated runtime of original DAG is 4933.946371078491ms
2022-09-20 22:01:28 WARNING Skipping Multi-Query Optimization (instead, only combine execution DAGs)
2022-09-20 22:01:28 INFO  Estimated unoptimised what-if runtime is 123348.65927696228ms
2022-09-20 22:01:28 INFO  ---RUNTIME: Multi-Query Optimization took 136.26909255981445 ms
2022-09-20 22:01:28 INFO  Executing generated plans
2022-09-20 22:04:04 INFO  ---RUNTIME: Execution took 155756.35313987732 ms
2022-09-20 22:04:04 INFO  Done!
2022-09-20 22:04:04 INFO  # Finished -- repetition 7 of 7 
2022-09-20 22:04:04 INFO  # Final results after all repetitions
2022-09-20 22:04:04 INFO     repetition  ... no_opt_what_if_execution_combined_model_training
0           0  ...                                      2855.494738
1           1  ...                                      2865.893841
2           2  ...                                      2866.585970
3           3  ...                                      2853.004217
4           4  ...                                      2849.973679
5           5  ...                                      2863.956213
6           6  ...                                      2855.971098

[7 rows x 26 columns]
taskset -c 32-40 PROTOCOL_BUFFERS_PYTHON_IMPLEMENTATION=python python3.9 benchmarks_end_to_end.py data_corruption reviews fast_loading featurization_1 xgboost
2022-09-20 22:04:06.934052: W tensorflow/stream_executor/platform/default/dso_loader.cc:64] Could not load dynamic library 'libcudart.so.11.0'; dlerror: libcudart.so.11.0: cannot open shared object file: No such file or directory; LD_LIBRARY_PATH: /home/sgrafbe/mlwhatif/venv/lib/python3.9/site-packages/cv2/../../lib64:
2022-09-20 22:04:06.934105: I tensorflow/stream_executor/cuda/cudart_stub.cc:29] Ignore above cudart dlerror if you do not have a GPU set up on your machine.
2022-09-20 22:04:08 INFO  Patching sys.argv with ['mlwhatif', 'reviews', 'fast_loading', 'featurization_1', 'xgboost']
2022-09-20 22:04:08 INFO  Running instrumented original pipeline...
2022-09-20 22:04:08 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-20 22:04:08 INFO  ---RUNTIME: Importing and monkey-patching took 122.2848892211914 ms
2022-09-20 22:04:31 INFO  ---RUNTIME: Original pipeline execution took 22941.153287887573 ms (excluding imports and monkey-patching)
2022-09-20 22:04:31 INFO  Starting execution of 0 what-if analyses...
2022-09-20 22:04:31 INFO  Estimated runtime of original DAG is 20684.67116355896ms
2022-09-20 22:04:31 INFO  Performing Multi-Query Optimization
2022-09-20 22:04:31 INFO  Estimated unoptimized what-if runtime is 0ms
2022-09-20 22:04:31 INFO  Estimated optimised what-if runtime is 0ms
2022-09-20 22:04:31 INFO  Estimated optimisation runtime saving is 0ms
2022-09-20 22:04:31 INFO  ---RUNTIME: Multi-Query Optimization took 0.5381107330322266 ms
2022-09-20 22:04:31 INFO  Executing generated plans
2022-09-20 22:04:31 INFO  ---RUNTIME: Execution took 0.025987625122070312 ms
2022-09-20 22:04:31 INFO  Done!
2022-09-20 22:04:31 INFO  # Optimization benchmark for data_corruption with args [['reviews', 'fast_loading', 'featurization_1', 'xgboost']] -- repetition 1 of 7
2022-09-20 22:04:31 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-20 22:04:31 INFO  Running instrumented original pipeline...
2022-09-20 22:04:31 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-20 22:04:31 INFO  ---RUNTIME: Importing and monkey-patching took 6.265163421630859 ms
2022-09-20 22:04:39 INFO  ---RUNTIME: Original pipeline execution took 7956.489324569702 ms (excluding imports and monkey-patching)
2022-09-20 22:04:39 INFO  Starting execution of 1 what-if analyses...
2022-09-20 22:04:39 INFO  Start plan generation for analysis DataCorruption...
2022-09-20 22:04:39 INFO  ---RUNTIME: Plan generation took 0.5669593811035156 ms
2022-09-20 22:04:39 INFO  Estimated runtime of original DAG is 5594.08712387085ms
2022-09-20 22:04:39 INFO  Performing Multi-Query Optimization
2022-09-20 22:04:39 INFO  Estimated unoptimized what-if runtime is 139852.17809677124ms
2022-09-20 22:04:39 INFO  Estimated optimised what-if runtime is 13390.640258789062ms
2022-09-20 22:04:39 INFO  Estimated optimisation runtime saving is 126461.53783798218ms
2022-09-20 22:04:39 INFO  ---RUNTIME: Multi-Query Optimization took 62.610626220703125 ms
2022-09-20 22:04:39 INFO  Executing generated plans
2022-09-20 22:04:59 INFO  ---RUNTIME: Execution took 19844.06805038452 ms
2022-09-20 22:04:59 INFO  Done!
2022-09-20 22:04:59 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-20 22:04:59 INFO  Running instrumented original pipeline...
2022-09-20 22:04:59 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-20 22:04:59 INFO  ---RUNTIME: Importing and monkey-patching took 6.08372688293457 ms
2022-09-20 22:05:13 INFO  ---RUNTIME: Original pipeline execution took 14270.360469818115 ms (excluding imports and monkey-patching)
2022-09-20 22:05:13 INFO  Starting execution of 1 what-if analyses...
2022-09-20 22:05:13 INFO  Start plan generation for analysis DataCorruption...
2022-09-20 22:05:13 INFO  ---RUNTIME: Plan generation took 0.55694580078125 ms
2022-09-20 22:05:13 INFO  Estimated runtime of original DAG is 12038.913011550903ms
2022-09-20 22:05:13 WARNING Skipping Multi-Query Optimization (instead, only combine execution DAGs)
2022-09-20 22:05:13 INFO  Estimated unoptimised what-if runtime is 300972.8252887726ms
2022-09-20 22:05:13 INFO  ---RUNTIME: Multi-Query Optimization took 134.26899909973145 ms
2022-09-20 22:05:13 INFO  Executing generated plans
2022-09-20 22:08:12 INFO  ---RUNTIME: Execution took 178852.02717781067 ms
2022-09-20 22:08:12 INFO  Done!
2022-09-20 22:08:12 INFO  # Finished -- repetition 1 of 7 
2022-09-20 22:08:12 INFO  # Optimization benchmark for data_corruption with args [['reviews', 'fast_loading', 'featurization_1', 'xgboost']] -- repetition 2 of 7
2022-09-20 22:08:12 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-20 22:08:12 INFO  Running instrumented original pipeline...
2022-09-20 22:08:12 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-20 22:08:12 INFO  ---RUNTIME: Importing and monkey-patching took 6.663084030151367 ms
2022-09-20 22:08:20 INFO  ---RUNTIME: Original pipeline execution took 8019.437313079834 ms (excluding imports and monkey-patching)
2022-09-20 22:08:20 INFO  Starting execution of 1 what-if analyses...
2022-09-20 22:08:20 INFO  Start plan generation for analysis DataCorruption...
2022-09-20 22:08:20 INFO  ---RUNTIME: Plan generation took 0.5631446838378906 ms
2022-09-20 22:08:20 INFO  Estimated runtime of original DAG is 5740.2918338775635ms
2022-09-20 22:08:20 INFO  Performing Multi-Query Optimization
2022-09-20 22:08:20 INFO  Estimated unoptimized what-if runtime is 143507.2958469391ms
2022-09-20 22:08:20 INFO  Estimated optimised what-if runtime is 14483.523607254028ms
2022-09-20 22:08:20 INFO  Estimated optimisation runtime saving is 129023.77223968506ms
2022-09-20 22:08:20 INFO  ---RUNTIME: Multi-Query Optimization took 62.14427947998047 ms
2022-09-20 22:08:20 INFO  Executing generated plans
2022-09-20 22:09:11 INFO  ---RUNTIME: Execution took 50749.096155166626 ms
2022-09-20 22:09:11 INFO  Done!
2022-09-20 22:09:11 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-20 22:09:11 INFO  Running instrumented original pipeline...
2022-09-20 22:09:11 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-20 22:09:11 INFO  ---RUNTIME: Importing and monkey-patching took 6.300210952758789 ms
2022-09-20 22:09:36 INFO  ---RUNTIME: Original pipeline execution took 25427.701473236084 ms (excluding imports and monkey-patching)
2022-09-20 22:09:36 INFO  Starting execution of 1 what-if analyses...
2022-09-20 22:09:36 INFO  Start plan generation for analysis DataCorruption...
2022-09-20 22:09:36 INFO  ---RUNTIME: Plan generation took 0.5929470062255859 ms
2022-09-20 22:09:36 INFO  Estimated runtime of original DAG is 23152.13370323181ms
2022-09-20 22:09:36 WARNING Skipping Multi-Query Optimization (instead, only combine execution DAGs)
2022-09-20 22:09:37 INFO  Estimated unoptimised what-if runtime is 578803.3425807953ms
2022-09-20 22:09:37 INFO  ---RUNTIME: Multi-Query Optimization took 352.9319763183594 ms
2022-09-20 22:09:37 INFO  Executing generated plans
2022-09-20 22:12:47 INFO  ---RUNTIME: Execution took 190092.00859069824 ms
2022-09-20 22:12:47 INFO  Done!
2022-09-20 22:12:47 INFO  # Finished -- repetition 2 of 7 
2022-09-20 22:12:47 INFO  # Optimization benchmark for data_corruption with args [['reviews', 'fast_loading', 'featurization_1', 'xgboost']] -- repetition 3 of 7
2022-09-20 22:12:47 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-20 22:12:47 INFO  Running instrumented original pipeline...
2022-09-20 22:12:47 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-20 22:12:47 INFO  ---RUNTIME: Importing and monkey-patching took 6.499767303466797 ms
2022-09-20 22:13:03 INFO  ---RUNTIME: Original pipeline execution took 16494.69041824341 ms (excluding imports and monkey-patching)
2022-09-20 22:13:03 INFO  Starting execution of 1 what-if analyses...
2022-09-20 22:13:03 INFO  Start plan generation for analysis DataCorruption...
2022-09-20 22:13:03 INFO  ---RUNTIME: Plan generation took 0.5087852478027344 ms
2022-09-20 22:13:03 INFO  Estimated runtime of original DAG is 14187.953233718872ms
2022-09-20 22:13:03 INFO  Performing Multi-Query Optimization
2022-09-20 22:13:03 INFO  Estimated unoptimized what-if runtime is 354698.8308429718ms
2022-09-20 22:13:03 INFO  Estimated optimised what-if runtime is 22541.776418685913ms
2022-09-20 22:13:03 INFO  Estimated optimisation runtime saving is 332157.0544242859ms
2022-09-20 22:13:03 INFO  ---RUNTIME: Multi-Query Optimization took 62.253713607788086 ms
2022-09-20 22:13:03 INFO  Executing generated plans
2022-09-20 22:14:07 INFO  ---RUNTIME: Execution took 64198.50039482117 ms
2022-09-20 22:14:07 INFO  Done!
2022-09-20 22:14:07 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-20 22:14:07 INFO  Running instrumented original pipeline...
2022-09-20 22:14:08 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-20 22:14:08 INFO  ---RUNTIME: Importing and monkey-patching took 6.8149566650390625 ms
2022-09-20 22:15:32 INFO  ---RUNTIME: Original pipeline execution took 84419.59738731384 ms (excluding imports and monkey-patching)
2022-09-20 22:15:32 INFO  Starting execution of 1 what-if analyses...
2022-09-20 22:15:32 INFO  Start plan generation for analysis DataCorruption...
2022-09-20 22:15:32 INFO  ---RUNTIME: Plan generation took 0.5888938903808594 ms
2022-09-20 22:15:32 INFO  Estimated runtime of original DAG is 82119.58193778992ms
2022-09-20 22:15:32 WARNING Skipping Multi-Query Optimization (instead, only combine execution DAGs)
2022-09-20 22:15:32 INFO  Estimated unoptimised what-if runtime is 2052989.548444748ms
2022-09-20 22:15:32 INFO  ---RUNTIME: Multi-Query Optimization took 137.06159591674805 ms
2022-09-20 22:15:32 INFO  Executing generated plans
2022-09-20 22:18:36 INFO  ---RUNTIME: Execution took 183661.77773475647 ms
2022-09-20 22:18:36 INFO  Done!
2022-09-20 22:18:36 INFO  # Finished -- repetition 3 of 7 
2022-09-20 22:18:36 INFO  # Optimization benchmark for data_corruption with args [['reviews', 'fast_loading', 'featurization_1', 'xgboost']] -- repetition 4 of 7
2022-09-20 22:18:36 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-20 22:18:36 INFO  Running instrumented original pipeline...
2022-09-20 22:18:36 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-20 22:18:36 INFO  ---RUNTIME: Importing and monkey-patching took 6.552696228027344 ms
2022-09-20 22:18:44 INFO  ---RUNTIME: Original pipeline execution took 8691.400289535522 ms (excluding imports and monkey-patching)
2022-09-20 22:18:44 INFO  Starting execution of 1 what-if analyses...
2022-09-20 22:18:44 INFO  Start plan generation for analysis DataCorruption...
2022-09-20 22:18:44 INFO  ---RUNTIME: Plan generation took 0.5342960357666016 ms
2022-09-20 22:18:44 INFO  Estimated runtime of original DAG is 6101.338863372803ms
2022-09-20 22:18:44 INFO  Performing Multi-Query Optimization
2022-09-20 22:18:45 INFO  Estimated unoptimized what-if runtime is 152533.47158432007ms
2022-09-20 22:18:45 INFO  Estimated optimised what-if runtime is 13788.969278335571ms
2022-09-20 22:18:45 INFO  Estimated optimisation runtime saving is 138744.5023059845ms
2022-09-20 22:18:45 INFO  ---RUNTIME: Multi-Query Optimization took 62.70575523376465 ms
2022-09-20 22:18:45 INFO  Executing generated plans
2022-09-20 22:19:05 INFO  ---RUNTIME: Execution took 20000.179767608643 ms
2022-09-20 22:19:05 INFO  Done!
2022-09-20 22:19:05 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-20 22:19:05 INFO  Running instrumented original pipeline...
2022-09-20 22:19:05 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-20 22:19:05 INFO  ---RUNTIME: Importing and monkey-patching took 5.765676498413086 ms
2022-09-20 22:19:12 INFO  ---RUNTIME: Original pipeline execution took 7941.7619705200195 ms (excluding imports and monkey-patching)
2022-09-20 22:19:12 INFO  Starting execution of 1 what-if analyses...
2022-09-20 22:19:12 INFO  Start plan generation for analysis DataCorruption...
2022-09-20 22:19:12 INFO  ---RUNTIME: Plan generation took 0.5218982696533203 ms
2022-09-20 22:19:12 INFO  Estimated runtime of original DAG is 5625.636100769043ms
2022-09-20 22:19:12 WARNING Skipping Multi-Query Optimization (instead, only combine execution DAGs)
2022-09-20 22:19:13 INFO  Estimated unoptimised what-if runtime is 140640.90251922607ms
2022-09-20 22:19:13 INFO  ---RUNTIME: Multi-Query Optimization took 138.13042640686035 ms
2022-09-20 22:19:13 INFO  Executing generated plans
2022-09-20 22:22:14 INFO  ---RUNTIME: Execution took 181171.37241363525 ms
2022-09-20 22:22:14 INFO  Done!
2022-09-20 22:22:14 INFO  # Finished -- repetition 4 of 7 
2022-09-20 22:22:14 INFO  # Optimization benchmark for data_corruption with args [['reviews', 'fast_loading', 'featurization_1', 'xgboost']] -- repetition 5 of 7
2022-09-20 22:22:14 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-20 22:22:14 INFO  Running instrumented original pipeline...
2022-09-20 22:22:14 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-20 22:22:14 INFO  ---RUNTIME: Importing and monkey-patching took 6.475210189819336 ms
2022-09-20 22:22:27 INFO  ---RUNTIME: Original pipeline execution took 13325.680017471313 ms (excluding imports and monkey-patching)
2022-09-20 22:22:27 INFO  Starting execution of 1 what-if analyses...
2022-09-20 22:22:27 INFO  Start plan generation for analysis DataCorruption...
2022-09-20 22:22:27 INFO  ---RUNTIME: Plan generation took 0.5872249603271484 ms
2022-09-20 22:22:27 INFO  Estimated runtime of original DAG is 10978.682041168213ms
2022-09-20 22:22:27 INFO  Performing Multi-Query Optimization
2022-09-20 22:22:27 INFO  Estimated unoptimized what-if runtime is 274467.0510292053ms
2022-09-20 22:22:27 INFO  Estimated optimised what-if runtime is 18721.47035598755ms
2022-09-20 22:22:27 INFO  Estimated optimisation runtime saving is 255745.58067321777ms
2022-09-20 22:22:27 INFO  ---RUNTIME: Multi-Query Optimization took 62.64948844909668 ms
2022-09-20 22:22:27 INFO  Executing generated plans
2022-09-20 22:22:47 INFO  ---RUNTIME: Execution took 19636.272192001343 ms
2022-09-20 22:22:47 INFO  Done!
2022-09-20 22:22:47 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-20 22:22:47 INFO  Running instrumented original pipeline...
2022-09-20 22:22:47 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-20 22:22:47 INFO  ---RUNTIME: Importing and monkey-patching took 6.165266036987305 ms
2022-09-20 22:23:17 INFO  ---RUNTIME: Original pipeline execution took 29693.106174468994 ms (excluding imports and monkey-patching)
2022-09-20 22:23:17 INFO  Starting execution of 1 what-if analyses...
2022-09-20 22:23:17 INFO  Start plan generation for analysis DataCorruption...
2022-09-20 22:23:17 INFO  ---RUNTIME: Plan generation took 0.591278076171875 ms
2022-09-20 22:23:17 INFO  Estimated runtime of original DAG is 27387.75396347046ms
2022-09-20 22:23:17 WARNING Skipping Multi-Query Optimization (instead, only combine execution DAGs)
2022-09-20 22:23:17 INFO  Estimated unoptimised what-if runtime is 684693.8490867615ms
2022-09-20 22:23:17 INFO  ---RUNTIME: Multi-Query Optimization took 137.26520538330078 ms
2022-09-20 22:23:17 INFO  Executing generated plans
2022-09-20 22:26:19 INFO  ---RUNTIME: Execution took 182175.18401145935 ms
2022-09-20 22:26:19 INFO  Done!
2022-09-20 22:26:19 INFO  # Finished -- repetition 5 of 7 
2022-09-20 22:26:19 INFO  # Optimization benchmark for data_corruption with args [['reviews', 'fast_loading', 'featurization_1', 'xgboost']] -- repetition 6 of 7
2022-09-20 22:26:19 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-20 22:26:19 INFO  Running instrumented original pipeline...
2022-09-20 22:26:19 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-20 22:26:19 INFO  ---RUNTIME: Importing and monkey-patching took 6.5898895263671875 ms
2022-09-20 22:26:33 INFO  ---RUNTIME: Original pipeline execution took 13988.095045089722 ms (excluding imports and monkey-patching)
2022-09-20 22:26:33 INFO  Starting execution of 1 what-if analyses...
2022-09-20 22:26:33 INFO  Start plan generation for analysis DataCorruption...
2022-09-20 22:26:33 INFO  ---RUNTIME: Plan generation took 0.5838871002197266 ms
2022-09-20 22:26:33 INFO  Estimated runtime of original DAG is 11649.20711517334ms
2022-09-20 22:26:33 INFO  Performing Multi-Query Optimization
2022-09-20 22:26:33 INFO  Estimated unoptimized what-if runtime is 291230.1778793335ms
2022-09-20 22:26:33 INFO  Estimated optimised what-if runtime is 19782.705783843994ms
2022-09-20 22:26:33 INFO  Estimated optimisation runtime saving is 271447.4720954895ms
2022-09-20 22:26:33 INFO  ---RUNTIME: Multi-Query Optimization took 62.41607666015625 ms
2022-09-20 22:26:33 INFO  Executing generated plans
2022-09-20 22:27:16 INFO  ---RUNTIME: Execution took 43330.6188583374 ms
2022-09-20 22:27:16 INFO  Done!
2022-09-20 22:27:16 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-20 22:27:16 INFO  Running instrumented original pipeline...
2022-09-20 22:27:16 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-20 22:27:16 INFO  ---RUNTIME: Importing and monkey-patching took 6.330728530883789 ms
2022-09-20 22:27:51 INFO  ---RUNTIME: Original pipeline execution took 34415.18330574036 ms (excluding imports and monkey-patching)
2022-09-20 22:27:51 INFO  Starting execution of 1 what-if analyses...
2022-09-20 22:27:51 INFO  Start plan generation for analysis DataCorruption...
2022-09-20 22:27:51 INFO  ---RUNTIME: Plan generation took 0.5779266357421875 ms
2022-09-20 22:27:51 INFO  Estimated runtime of original DAG is 32081.313371658325ms
2022-09-20 22:27:51 WARNING Skipping Multi-Query Optimization (instead, only combine execution DAGs)
2022-09-20 22:27:51 INFO  Estimated unoptimised what-if runtime is 802032.8342914581ms
2022-09-20 22:27:51 INFO  ---RUNTIME: Multi-Query Optimization took 136.65771484375 ms
2022-09-20 22:27:51 INFO  Executing generated plans
2022-09-20 22:32:37 INFO  ---RUNTIME: Execution took 286359.88306999207 ms
2022-09-20 22:32:37 INFO  Done!
2022-09-20 22:32:37 INFO  # Finished -- repetition 6 of 7 
2022-09-20 22:32:37 INFO  # Optimization benchmark for data_corruption with args [['reviews', 'fast_loading', 'featurization_1', 'xgboost']] -- repetition 7 of 7
2022-09-20 22:32:37 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-20 22:32:37 INFO  Running instrumented original pipeline...
2022-09-20 22:32:37 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-20 22:32:37 INFO  ---RUNTIME: Importing and monkey-patching took 6.638765335083008 ms
2022-09-20 22:32:45 INFO  ---RUNTIME: Original pipeline execution took 8074.667453765869 ms (excluding imports and monkey-patching)
2022-09-20 22:32:45 INFO  Starting execution of 1 what-if analyses...
2022-09-20 22:32:45 INFO  Start plan generation for analysis DataCorruption...
2022-09-20 22:32:45 INFO  ---RUNTIME: Plan generation took 0.5884170532226562 ms
2022-09-20 22:32:45 INFO  Estimated runtime of original DAG is 5763.083696365356ms
2022-09-20 22:32:45 INFO  Performing Multi-Query Optimization
2022-09-20 22:32:45 INFO  Estimated unoptimized what-if runtime is 144077.0924091339ms
2022-09-20 22:32:45 INFO  Estimated optimised what-if runtime is 14102.320194244385ms
2022-09-20 22:32:45 INFO  Estimated optimisation runtime saving is 129974.77221488953ms
2022-09-20 22:32:45 INFO  ---RUNTIME: Multi-Query Optimization took 62.39056587219238 ms
2022-09-20 22:32:45 INFO  Executing generated plans
2022-09-20 22:33:21 INFO  ---RUNTIME: Execution took 35267.68779754639 ms
2022-09-20 22:33:21 INFO  Done!
2022-09-20 22:33:21 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-20 22:33:21 INFO  Running instrumented original pipeline...
2022-09-20 22:33:21 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-20 22:33:21 INFO  ---RUNTIME: Importing and monkey-patching took 6.343603134155273 ms
2022-09-20 22:33:29 INFO  ---RUNTIME: Original pipeline execution took 7970.861196517944 ms (excluding imports and monkey-patching)
2022-09-20 22:33:29 INFO  Starting execution of 1 what-if analyses...
2022-09-20 22:33:29 INFO  Start plan generation for analysis DataCorruption...
2022-09-20 22:33:29 INFO  ---RUNTIME: Plan generation took 0.4925727844238281 ms
2022-09-20 22:33:29 INFO  Estimated runtime of original DAG is 5665.97843170166ms
2022-09-20 22:33:29 WARNING Skipping Multi-Query Optimization (instead, only combine execution DAGs)
2022-09-20 22:33:29 INFO  Estimated unoptimised what-if runtime is 141649.4607925415ms
2022-09-20 22:33:29 INFO  ---RUNTIME: Multi-Query Optimization took 134.89198684692383 ms
2022-09-20 22:33:29 INFO  Executing generated plans
2022-09-20 22:36:25 INFO  ---RUNTIME: Execution took 176690.64807891846 ms
2022-09-20 22:36:25 INFO  Done!
2022-09-20 22:36:25 INFO  # Finished -- repetition 7 of 7 
2022-09-20 22:36:25 INFO  # Final results after all repetitions
2022-09-20 22:36:25 INFO     repetition  ... no_opt_what_if_execution_combined_model_training
0           0  ...                                     22073.587179
1           1  ...                                     29003.438473
2           2  ...                                     23938.463449
3           3  ...                                     22068.585634
4           4  ...                                     22267.578602
5           5  ...                                    126717.191935
6           6  ...                                     22207.507372

[7 rows x 26 columns]
taskset -c 32-40 PROTOCOL_BUFFERS_PYTHON_IMPLEMENTATION=python python3.9 benchmarks_end_to_end.py data_corruption reviews fast_loading featurization_1 neural_network
2022-09-20 22:36:28.236612: W tensorflow/stream_executor/platform/default/dso_loader.cc:64] Could not load dynamic library 'libcudart.so.11.0'; dlerror: libcudart.so.11.0: cannot open shared object file: No such file or directory; LD_LIBRARY_PATH: /home/sgrafbe/mlwhatif/venv/lib/python3.9/site-packages/cv2/../../lib64:
2022-09-20 22:36:28.236661: I tensorflow/stream_executor/cuda/cudart_stub.cc:29] Ignore above cudart dlerror if you do not have a GPU set up on your machine.
2022-09-20 22:36:29 INFO  Patching sys.argv with ['mlwhatif', 'reviews', 'fast_loading', 'featurization_1', 'neural_network']
2022-09-20 22:36:29 INFO  Running instrumented original pipeline...
2022-09-20 22:36:29 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-20 22:36:29 INFO  ---RUNTIME: Importing and monkey-patching took 121.91915512084961 ms
2022-09-20 22:36:35.301602: W tensorflow/stream_executor/platform/default/dso_loader.cc:64] Could not load dynamic library 'libcuda.so.1'; dlerror: libcuda.so.1: cannot open shared object file: No such file or directory; LD_LIBRARY_PATH: /home/sgrafbe/mlwhatif/venv/lib/python3.9/site-packages/cv2/../../lib64:
2022-09-20 22:36:35.301645: W tensorflow/stream_executor/cuda/cuda_driver.cc:326] failed call to cuInit: UNKNOWN ERROR (303)
2022-09-20 22:36:35.301669: I tensorflow/stream_executor/cuda/cuda_diagnostics.cc:156] kernel driver does not appear to be running on this host (angus): /proc/driver/nvidia/version does not exist
2022-09-20 22:36:35.302169: I tensorflow/core/platform/cpu_feature_guard.cc:142] This TensorFlow binary is optimized with oneAPI Deep Neural Network Library (oneDNN) to use the following CPU instructions in performance-critical operations:  AVX2 FMA
To enable them in other operations, rebuild TensorFlow with the appropriate compiler flags.
2022-09-20 22:36:35.536871: I tensorflow/compiler/mlir/mlir_graph_optimization_pass.cc:176] None of the MLIR Optimization Passes are enabled (registered 2)
2022-09-20 22:36:35.549181: I tensorflow/core/platform/profile_utils/cpu_utils.cc:114] CPU Frequency: 2595130000 Hz
2022-09-20 22:36:40 INFO  ---RUNTIME: Original pipeline execution took 10973.155498504639 ms (excluding imports and monkey-patching)
2022-09-20 22:36:40 INFO  Starting execution of 0 what-if analyses...
2022-09-20 22:36:40 INFO  Estimated runtime of original DAG is 8733.477354049683ms
2022-09-20 22:36:40 INFO  Performing Multi-Query Optimization
2022-09-20 22:36:40 INFO  Estimated unoptimized what-if runtime is 0ms
2022-09-20 22:36:40 INFO  Estimated optimised what-if runtime is 0ms
2022-09-20 22:36:40 INFO  Estimated optimisation runtime saving is 0ms
2022-09-20 22:36:40 INFO  ---RUNTIME: Multi-Query Optimization took 0.4756450653076172 ms
2022-09-20 22:36:40 INFO  Executing generated plans
2022-09-20 22:36:40 INFO  ---RUNTIME: Execution took 0.022172927856445312 ms
2022-09-20 22:36:40 INFO  Done!
2022-09-20 22:36:40 INFO  # Optimization benchmark for data_corruption with args [['reviews', 'fast_loading', 'featurization_1', 'neural_network']] -- repetition 1 of 7
2022-09-20 22:36:40 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-20 22:36:40 INFO  Running instrumented original pipeline...
2022-09-20 22:36:40 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-20 22:36:40 INFO  ---RUNTIME: Importing and monkey-patching took 5.402803421020508 ms
2022-09-20 22:36:51 INFO  ---RUNTIME: Original pipeline execution took 10467.894077301025 ms (excluding imports and monkey-patching)
2022-09-20 22:36:51 INFO  Starting execution of 1 what-if analyses...
2022-09-20 22:36:51 INFO  Start plan generation for analysis DataCorruption...
2022-09-20 22:36:51 INFO  ---RUNTIME: Plan generation took 0.4241466522216797 ms
2022-09-20 22:36:51 INFO  Estimated runtime of original DAG is 8304.20470237732ms
2022-09-20 22:36:51 INFO  Performing Multi-Query Optimization
2022-09-20 22:36:51 INFO  Estimated unoptimized what-if runtime is 207605.11755943298ms
2022-09-20 22:36:51 INFO  Estimated optimised what-if runtime is 24525.47550201416ms
2022-09-20 22:36:51 INFO  Estimated optimisation runtime saving is 183079.64205741882ms
2022-09-20 22:36:51 INFO  ---RUNTIME: Multi-Query Optimization took 63.24601173400879 ms
2022-09-20 22:36:51 INFO  Executing generated plans
2022-09-20 22:37:22 INFO  ---RUNTIME: Execution took 30961.694955825806 ms
2022-09-20 22:37:22 INFO  Done!
2022-09-20 22:37:22 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-20 22:37:22 INFO  Running instrumented original pipeline...
2022-09-20 22:37:22 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-20 22:37:22 INFO  ---RUNTIME: Importing and monkey-patching took 6.448507308959961 ms
2022-09-20 22:37:33 INFO  ---RUNTIME: Original pipeline execution took 11411.343574523926 ms (excluding imports and monkey-patching)
2022-09-20 22:37:33 INFO  Starting execution of 1 what-if analyses...
2022-09-20 22:37:33 INFO  Start plan generation for analysis DataCorruption...
2022-09-20 22:37:33 INFO  ---RUNTIME: Plan generation took 2.2525787353515625 ms
2022-09-20 22:37:33 INFO  Estimated runtime of original DAG is 9088.934421539307ms
2022-09-20 22:37:33 WARNING Skipping Multi-Query Optimization (instead, only combine execution DAGs)
2022-09-20 22:37:33 INFO  Estimated unoptimised what-if runtime is 227223.36053848267ms
2022-09-20 22:37:33 INFO  ---RUNTIME: Multi-Query Optimization took 140.6838893890381 ms
2022-09-20 22:37:33 INFO  Executing generated plans
2022-09-20 22:41:39 INFO  ---RUNTIME: Execution took 246238.74497413635 ms
2022-09-20 22:41:39 INFO  Done!
2022-09-20 22:41:39 INFO  # Finished -- repetition 1 of 7 
2022-09-20 22:41:39 INFO  # Optimization benchmark for data_corruption with args [['reviews', 'fast_loading', 'featurization_1', 'neural_network']] -- repetition 2 of 7
2022-09-20 22:41:39 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-20 22:41:39 INFO  Running instrumented original pipeline...
2022-09-20 22:41:39 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-20 22:41:39 INFO  ---RUNTIME: Importing and monkey-patching took 5.759239196777344 ms
2022-09-20 22:41:50 INFO  ---RUNTIME: Original pipeline execution took 10450.454711914062 ms (excluding imports and monkey-patching)
2022-09-20 22:41:50 INFO  Starting execution of 1 what-if analyses...
2022-09-20 22:41:50 INFO  Start plan generation for analysis DataCorruption...
2022-09-20 22:41:50 INFO  ---RUNTIME: Plan generation took 0.4363059997558594 ms
2022-09-20 22:41:50 INFO  Estimated runtime of original DAG is 8235.941171646118ms
2022-09-20 22:41:50 INFO  Performing Multi-Query Optimization
2022-09-20 22:41:50 INFO  Estimated unoptimized what-if runtime is 205898.52929115295ms
2022-09-20 22:41:50 INFO  Estimated optimised what-if runtime is 24083.580255508423ms
2022-09-20 22:41:50 INFO  Estimated optimisation runtime saving is 181814.94903564453ms
2022-09-20 22:41:50 INFO  ---RUNTIME: Multi-Query Optimization took 63.70830535888672 ms
2022-09-20 22:41:50 INFO  Executing generated plans
2022-09-20 22:42:21 INFO  ---RUNTIME: Execution took 30668.476819992065 ms
2022-09-20 22:42:21 INFO  Done!
2022-09-20 22:42:21 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-20 22:42:21 INFO  Running instrumented original pipeline...
2022-09-20 22:42:21 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-20 22:42:21 INFO  ---RUNTIME: Importing and monkey-patching took 6.639957427978516 ms
2022-09-20 22:42:31 INFO  ---RUNTIME: Original pipeline execution took 10595.976829528809 ms (excluding imports and monkey-patching)
2022-09-20 22:42:31 INFO  Starting execution of 1 what-if analyses...
2022-09-20 22:42:31 INFO  Start plan generation for analysis DataCorruption...
2022-09-20 22:42:31 INFO  ---RUNTIME: Plan generation took 0.4253387451171875 ms
2022-09-20 22:42:31 INFO  Estimated runtime of original DAG is 8348.507404327393ms
2022-09-20 22:42:31 WARNING Skipping Multi-Query Optimization (instead, only combine execution DAGs)
2022-09-20 22:42:31 INFO  Estimated unoptimised what-if runtime is 208712.6851081848ms
2022-09-20 22:42:31 INFO  ---RUNTIME: Multi-Query Optimization took 135.70761680603027 ms
2022-09-20 22:42:31 INFO  Executing generated plans
2022-09-20 22:46:40 INFO  ---RUNTIME: Execution took 248694.13423538208 ms
2022-09-20 22:46:40 INFO  Done!
2022-09-20 22:46:40 INFO  # Finished -- repetition 2 of 7 
2022-09-20 22:46:40 INFO  # Optimization benchmark for data_corruption with args [['reviews', 'fast_loading', 'featurization_1', 'neural_network']] -- repetition 3 of 7
2022-09-20 22:46:40 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-20 22:46:40 INFO  Running instrumented original pipeline...
2022-09-20 22:46:40 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-20 22:46:40 INFO  ---RUNTIME: Importing and monkey-patching took 6.315946578979492 ms
2022-09-20 22:46:51 INFO  ---RUNTIME: Original pipeline execution took 10614.71438407898 ms (excluding imports and monkey-patching)
2022-09-20 22:46:51 INFO  Starting execution of 1 what-if analyses...
2022-09-20 22:46:51 INFO  Start plan generation for analysis DataCorruption...
2022-09-20 22:46:51 INFO  ---RUNTIME: Plan generation took 0.40650367736816406 ms
2022-09-20 22:46:51 INFO  Estimated runtime of original DAG is 8360.628366470337ms
2022-09-20 22:46:51 INFO  Performing Multi-Query Optimization
2022-09-20 22:46:51 INFO  Estimated unoptimized what-if runtime is 209015.70916175842ms
2022-09-20 22:46:51 INFO  Estimated optimised what-if runtime is 24514.481782913208ms
2022-09-20 22:46:51 INFO  Estimated optimisation runtime saving is 184501.22737884521ms
2022-09-20 22:46:51 INFO  ---RUNTIME: Multi-Query Optimization took 62.26372718811035 ms
2022-09-20 22:46:51 INFO  Executing generated plans
2022-09-20 22:47:21 INFO  ---RUNTIME: Execution took 30047.60694503784 ms
2022-09-20 22:47:21 INFO  Done!
2022-09-20 22:47:21 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-20 22:47:21 INFO  Running instrumented original pipeline...
2022-09-20 22:47:21 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-20 22:47:21 INFO  ---RUNTIME: Importing and monkey-patching took 5.922555923461914 ms
2022-09-20 22:47:31 INFO  ---RUNTIME: Original pipeline execution took 10615.559816360474 ms (excluding imports and monkey-patching)
2022-09-20 22:47:31 INFO  Starting execution of 1 what-if analyses...
2022-09-20 22:47:31 INFO  Start plan generation for analysis DataCorruption...
2022-09-20 22:47:31 INFO  ---RUNTIME: Plan generation took 0.39196014404296875 ms
2022-09-20 22:47:31 INFO  Estimated runtime of original DAG is 8372.795343399048ms
2022-09-20 22:47:31 WARNING Skipping Multi-Query Optimization (instead, only combine execution DAGs)
2022-09-20 22:47:32 INFO  Estimated unoptimised what-if runtime is 209319.8835849762ms
2022-09-20 22:47:32 INFO  ---RUNTIME: Multi-Query Optimization took 935.1446628570557 ms
2022-09-20 22:47:32 INFO  Executing generated plans
2022-09-20 22:51:40 INFO  ---RUNTIME: Execution took 247840.0857448578 ms
2022-09-20 22:51:40 INFO  Done!
2022-09-20 22:51:40 INFO  # Finished -- repetition 3 of 7 
2022-09-20 22:51:40 INFO  # Optimization benchmark for data_corruption with args [['reviews', 'fast_loading', 'featurization_1', 'neural_network']] -- repetition 4 of 7
2022-09-20 22:51:40 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-20 22:51:40 INFO  Running instrumented original pipeline...
2022-09-20 22:51:40 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-20 22:51:40 INFO  ---RUNTIME: Importing and monkey-patching took 6.328105926513672 ms
2022-09-20 22:51:51 INFO  ---RUNTIME: Original pipeline execution took 11210.178852081299 ms (excluding imports and monkey-patching)
2022-09-20 22:51:51 INFO  Starting execution of 1 what-if analyses...
2022-09-20 22:51:51 INFO  Start plan generation for analysis DataCorruption...
2022-09-20 22:51:51 INFO  ---RUNTIME: Plan generation took 2.032756805419922 ms
2022-09-20 22:51:51 INFO  Estimated runtime of original DAG is 8930.198669433594ms
2022-09-20 22:51:51 INFO  Performing Multi-Query Optimization
2022-09-20 22:51:52 INFO  Estimated unoptimized what-if runtime is 223254.96673583984ms
2022-09-20 22:51:52 INFO  Estimated optimised what-if runtime is 25329.374313354492ms
2022-09-20 22:51:52 INFO  Estimated optimisation runtime saving is 197925.59242248535ms
2022-09-20 22:51:52 INFO  ---RUNTIME: Multi-Query Optimization took 62.807559967041016 ms
2022-09-20 22:51:52 INFO  Executing generated plans
2022-09-20 22:52:22 INFO  ---RUNTIME: Execution took 30363.243579864502 ms
2022-09-20 22:52:22 INFO  Done!
2022-09-20 22:52:22 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-20 22:52:22 INFO  Running instrumented original pipeline...
2022-09-20 22:52:22 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-20 22:52:22 INFO  ---RUNTIME: Importing and monkey-patching took 6.206989288330078 ms
2022-09-20 22:52:33 INFO  ---RUNTIME: Original pipeline execution took 10788.82884979248 ms (excluding imports and monkey-patching)
2022-09-20 22:52:33 INFO  Starting execution of 1 what-if analyses...
2022-09-20 22:52:33 INFO  Start plan generation for analysis DataCorruption...
2022-09-20 22:52:33 INFO  ---RUNTIME: Plan generation took 0.42724609375 ms
2022-09-20 22:52:33 INFO  Estimated runtime of original DAG is 8422.065019607544ms
2022-09-20 22:52:33 WARNING Skipping Multi-Query Optimization (instead, only combine execution DAGs)
2022-09-20 22:52:33 INFO  Estimated unoptimised what-if runtime is 210551.6254901886ms
2022-09-20 22:52:33 INFO  ---RUNTIME: Multi-Query Optimization took 136.4274024963379 ms
2022-09-20 22:52:33 INFO  Executing generated plans
2022-09-20 22:56:40 INFO  ---RUNTIME: Execution took 247669.37637329102 ms
2022-09-20 22:56:40 INFO  Done!
2022-09-20 22:56:40 INFO  # Finished -- repetition 4 of 7 
2022-09-20 22:56:40 INFO  # Optimization benchmark for data_corruption with args [['reviews', 'fast_loading', 'featurization_1', 'neural_network']] -- repetition 5 of 7
2022-09-20 22:56:40 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-20 22:56:40 INFO  Running instrumented original pipeline...
2022-09-20 22:56:41 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-20 22:56:41 INFO  ---RUNTIME: Importing and monkey-patching took 6.426811218261719 ms
2022-09-20 22:56:51 INFO  ---RUNTIME: Original pipeline execution took 10656.62145614624 ms (excluding imports and monkey-patching)
2022-09-20 22:56:51 INFO  Starting execution of 1 what-if analyses...
2022-09-20 22:56:51 INFO  Start plan generation for analysis DataCorruption...
2022-09-20 22:56:51 INFO  ---RUNTIME: Plan generation took 0.4200935363769531 ms
2022-09-20 22:56:51 INFO  Estimated runtime of original DAG is 8383.316993713379ms
2022-09-20 22:56:51 INFO  Performing Multi-Query Optimization
2022-09-20 22:56:51 INFO  Estimated unoptimized what-if runtime is 209582.92484283447ms
2022-09-20 22:56:51 INFO  Estimated optimised what-if runtime is 24497.12562561035ms
2022-09-20 22:56:51 INFO  Estimated optimisation runtime saving is 185085.79921722412ms
2022-09-20 22:56:51 INFO  ---RUNTIME: Multi-Query Optimization took 62.419891357421875 ms
2022-09-20 22:56:51 INFO  Executing generated plans
2022-09-20 22:57:21 INFO  ---RUNTIME: Execution took 30153.459548950195 ms
2022-09-20 22:57:21 INFO  Done!
2022-09-20 22:57:21 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-20 22:57:21 INFO  Running instrumented original pipeline...
2022-09-20 22:57:21 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-20 22:57:21 INFO  ---RUNTIME: Importing and monkey-patching took 5.883693695068359 ms
2022-09-20 22:57:33 INFO  ---RUNTIME: Original pipeline execution took 11412.669897079468 ms (excluding imports and monkey-patching)
2022-09-20 22:57:33 INFO  Starting execution of 1 what-if analyses...
2022-09-20 22:57:33 INFO  Start plan generation for analysis DataCorruption...
2022-09-20 22:57:33 INFO  ---RUNTIME: Plan generation took 0.408172607421875 ms
2022-09-20 22:57:33 INFO  Estimated runtime of original DAG is 9154.369592666626ms
2022-09-20 22:57:33 WARNING Skipping Multi-Query Optimization (instead, only combine execution DAGs)
2022-09-20 22:57:33 INFO  Estimated unoptimised what-if runtime is 228859.23981666565ms
2022-09-20 22:57:33 INFO  ---RUNTIME: Multi-Query Optimization took 136.95740699768066 ms
2022-09-20 22:57:33 INFO  Executing generated plans
2022-09-20 23:01:41 INFO  ---RUNTIME: Execution took 248394.49191093445 ms
2022-09-20 23:01:41 INFO  Done!
2022-09-20 23:01:41 INFO  # Finished -- repetition 5 of 7 
2022-09-20 23:01:41 INFO  # Optimization benchmark for data_corruption with args [['reviews', 'fast_loading', 'featurization_1', 'neural_network']] -- repetition 6 of 7
2022-09-20 23:01:41 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-20 23:01:41 INFO  Running instrumented original pipeline...
2022-09-20 23:01:41 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-20 23:01:41 INFO  ---RUNTIME: Importing and monkey-patching took 6.220340728759766 ms
2022-09-20 23:01:53 INFO  ---RUNTIME: Original pipeline execution took 11349.438667297363 ms (excluding imports and monkey-patching)
2022-09-20 23:01:53 INFO  Starting execution of 1 what-if analyses...
2022-09-20 23:01:53 INFO  Start plan generation for analysis DataCorruption...
2022-09-20 23:01:53 INFO  ---RUNTIME: Plan generation took 0.38313865661621094 ms
2022-09-20 23:01:53 INFO  Estimated runtime of original DAG is 9063.97795677185ms
2022-09-20 23:01:53 INFO  Performing Multi-Query Optimization
2022-09-20 23:01:53 INFO  Estimated unoptimized what-if runtime is 226599.44891929626ms
2022-09-20 23:01:53 INFO  Estimated optimised what-if runtime is 25114.695072174072ms
2022-09-20 23:01:53 INFO  Estimated optimisation runtime saving is 201484.7538471222ms
2022-09-20 23:01:53 INFO  ---RUNTIME: Multi-Query Optimization took 62.59417533874512 ms
2022-09-20 23:01:53 INFO  Executing generated plans
2022-09-20 23:02:23 INFO  ---RUNTIME: Execution took 30246.021270751953 ms
2022-09-20 23:02:23 INFO  Done!
2022-09-20 23:02:23 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-20 23:02:23 INFO  Running instrumented original pipeline...
2022-09-20 23:02:23 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-20 23:02:23 INFO  ---RUNTIME: Importing and monkey-patching took 6.446599960327148 ms
2022-09-20 23:02:34 INFO  ---RUNTIME: Original pipeline execution took 10819.604873657227 ms (excluding imports and monkey-patching)
2022-09-20 23:02:34 INFO  Starting execution of 1 what-if analyses...
2022-09-20 23:02:34 INFO  Start plan generation for analysis DataCorruption...
2022-09-20 23:02:34 INFO  ---RUNTIME: Plan generation took 0.41937828063964844 ms
2022-09-20 23:02:34 INFO  Estimated runtime of original DAG is 8444.546699523926ms
2022-09-20 23:02:34 WARNING Skipping Multi-Query Optimization (instead, only combine execution DAGs)
2022-09-20 23:02:34 INFO  Estimated unoptimised what-if runtime is 211113.66748809814ms
2022-09-20 23:02:34 INFO  ---RUNTIME: Multi-Query Optimization took 138.35859298706055 ms
2022-09-20 23:02:34 INFO  Executing generated plans
2022-09-20 23:06:42 INFO  ---RUNTIME: Execution took 247709.49721336365 ms
2022-09-20 23:06:42 INFO  Done!
2022-09-20 23:06:42 INFO  # Finished -- repetition 6 of 7 
2022-09-20 23:06:42 INFO  # Optimization benchmark for data_corruption with args [['reviews', 'fast_loading', 'featurization_1', 'neural_network']] -- repetition 7 of 7
2022-09-20 23:06:42 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-20 23:06:42 INFO  Running instrumented original pipeline...
2022-09-20 23:06:42 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-20 23:06:42 INFO  ---RUNTIME: Importing and monkey-patching took 6.0367584228515625 ms
2022-09-20 23:06:52 INFO  ---RUNTIME: Original pipeline execution took 10694.587469100952 ms (excluding imports and monkey-patching)
2022-09-20 23:06:52 INFO  Starting execution of 1 what-if analyses...
2022-09-20 23:06:52 INFO  Start plan generation for analysis DataCorruption...
2022-09-20 23:06:52 INFO  ---RUNTIME: Plan generation took 0.3986358642578125 ms
2022-09-20 23:06:52 INFO  Estimated runtime of original DAG is 8416.696548461914ms
2022-09-20 23:06:52 INFO  Performing Multi-Query Optimization
2022-09-20 23:06:52 INFO  Estimated unoptimized what-if runtime is 210417.41371154785ms
2022-09-20 23:06:52 INFO  Estimated optimised what-if runtime is 24819.02050971985ms
2022-09-20 23:06:52 INFO  Estimated optimisation runtime saving is 185598.393201828ms
2022-09-20 23:06:52 INFO  ---RUNTIME: Multi-Query Optimization took 63.513755798339844 ms
2022-09-20 23:06:52 INFO  Executing generated plans
2022-09-20 23:07:22 INFO  ---RUNTIME: Execution took 30026.07822418213 ms
2022-09-20 23:07:22 INFO  Done!
2022-09-20 23:07:23 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-20 23:07:23 INFO  Running instrumented original pipeline...
2022-09-20 23:07:23 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-20 23:07:23 INFO  ---RUNTIME: Importing and monkey-patching took 5.8746337890625 ms
2022-09-20 23:07:33 INFO  ---RUNTIME: Original pipeline execution took 10537.183284759521 ms (excluding imports and monkey-patching)
2022-09-20 23:07:33 INFO  Starting execution of 1 what-if analyses...
2022-09-20 23:07:33 INFO  Start plan generation for analysis DataCorruption...
2022-09-20 23:07:33 INFO  ---RUNTIME: Plan generation took 0.37026405334472656 ms
2022-09-20 23:07:33 INFO  Estimated runtime of original DAG is 8269.056558609009ms
2022-09-20 23:07:33 WARNING Skipping Multi-Query Optimization (instead, only combine execution DAGs)
2022-09-20 23:07:33 INFO  Estimated unoptimised what-if runtime is 206726.41396522522ms
2022-09-20 23:07:33 INFO  ---RUNTIME: Multi-Query Optimization took 133.41522216796875 ms
2022-09-20 23:07:33 INFO  Executing generated plans
2022-09-20 23:11:40 INFO  ---RUNTIME: Execution took 247273.43082427979 ms
2022-09-20 23:11:40 INFO  Done!
2022-09-20 23:11:40 INFO  # Finished -- repetition 7 of 7 
2022-09-20 23:11:40 INFO  # Final results after all repetitions
2022-09-20 23:11:40 INFO     repetition  ... no_opt_what_if_execution_combined_model_training
0           0  ...                                     81455.893755
1           1  ...                                     82117.453098
2           2  ...                                     81645.896673
3           3  ...                                     83287.632942
4           4  ...                                     82918.889999
5           5  ...                                     82843.125105
6           6  ...                                     81545.338631

[7 rows x 26 columns]
taskset -c 32-40 PROTOCOL_BUFFERS_PYTHON_IMPLEMENTATION=python python3.9 benchmarks_end_to_end.py data_corruption reviews fast_loading featurization_2 logistic_regression
2022-09-20 23:11:44.062167: W tensorflow/stream_executor/platform/default/dso_loader.cc:64] Could not load dynamic library 'libcudart.so.11.0'; dlerror: libcudart.so.11.0: cannot open shared object file: No such file or directory; LD_LIBRARY_PATH: /home/sgrafbe/mlwhatif/venv/lib/python3.9/site-packages/cv2/../../lib64:
2022-09-20 23:11:44.062212: I tensorflow/stream_executor/cuda/cudart_stub.cc:29] Ignore above cudart dlerror if you do not have a GPU set up on your machine.
2022-09-20 23:11:45 INFO  Patching sys.argv with ['mlwhatif', 'reviews', 'fast_loading', 'featurization_2', 'logistic_regression']
2022-09-20 23:11:45 INFO  Running instrumented original pipeline...
2022-09-20 23:11:45 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-20 23:11:45 INFO  ---RUNTIME: Importing and monkey-patching took 122.23315238952637 ms
2022-09-20 23:11:52 INFO  ---RUNTIME: Original pipeline execution took 6713.075160980225 ms (excluding imports and monkey-patching)
2022-09-20 23:11:52 INFO  Starting execution of 0 what-if analyses...
2022-09-20 23:11:52 INFO  Estimated runtime of original DAG is 5505.645036697388ms
2022-09-20 23:11:52 INFO  Performing Multi-Query Optimization
2022-09-20 23:11:52 INFO  Estimated unoptimized what-if runtime is 0ms
2022-09-20 23:11:52 INFO  Estimated optimised what-if runtime is 0ms
2022-09-20 23:11:52 INFO  Estimated optimisation runtime saving is 0ms
2022-09-20 23:11:52 INFO  ---RUNTIME: Multi-Query Optimization took 0.6070137023925781 ms
2022-09-20 23:11:52 INFO  Executing generated plans
2022-09-20 23:11:52 INFO  ---RUNTIME: Execution took 0.026226043701171875 ms
2022-09-20 23:11:52 INFO  Done!
2022-09-20 23:11:52 INFO  # Optimization benchmark for data_corruption with args [['reviews', 'fast_loading', 'featurization_2', 'logistic_regression']] -- repetition 1 of 7
2022-09-20 23:11:52 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-20 23:11:52 INFO  Running instrumented original pipeline...
2022-09-20 23:11:52 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-20 23:11:52 INFO  ---RUNTIME: Importing and monkey-patching took 5.489587783813477 ms
2022-09-20 23:11:58 INFO  ---RUNTIME: Original pipeline execution took 6812.806844711304 ms (excluding imports and monkey-patching)
2022-09-20 23:11:58 INFO  Starting execution of 1 what-if analyses...
2022-09-20 23:11:58 INFO  Start plan generation for analysis DataCorruption...
2022-09-20 23:11:58 INFO  ---RUNTIME: Plan generation took 0.461578369140625 ms
2022-09-20 23:11:58 INFO  Estimated runtime of original DAG is 5642.66037940979ms
2022-09-20 23:11:58 INFO  Performing Multi-Query Optimization
2022-09-20 23:11:59 INFO  Estimated unoptimized what-if runtime is 141066.50948524475ms
2022-09-20 23:11:59 INFO  Estimated optimised what-if runtime is 13780.186414718628ms
2022-09-20 23:11:59 INFO  Estimated optimisation runtime saving is 127286.32307052612ms
2022-09-20 23:11:59 INFO  ---RUNTIME: Multi-Query Optimization took 66.51067733764648 ms
2022-09-20 23:11:59 INFO  Executing generated plans
2022-09-20 23:12:18 INFO  ---RUNTIME: Execution took 19215.040683746338 ms
2022-09-20 23:12:18 INFO  Done!
2022-09-20 23:12:18 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-20 23:12:18 INFO  Running instrumented original pipeline...
2022-09-20 23:12:18 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-20 23:12:18 INFO  ---RUNTIME: Importing and monkey-patching took 6.259679794311523 ms
2022-09-20 23:12:24 INFO  ---RUNTIME: Original pipeline execution took 6638.121128082275 ms (excluding imports and monkey-patching)
2022-09-20 23:12:24 INFO  Starting execution of 1 what-if analyses...
2022-09-20 23:12:24 INFO  Start plan generation for analysis DataCorruption...
2022-09-20 23:12:24 INFO  ---RUNTIME: Plan generation took 0.45871734619140625 ms
2022-09-20 23:12:24 INFO  Estimated runtime of original DAG is 5453.1426429748535ms
2022-09-20 23:12:24 WARNING Skipping Multi-Query Optimization (instead, only combine execution DAGs)
2022-09-20 23:12:25 INFO  Estimated unoptimised what-if runtime is 136328.56607437134ms
2022-09-20 23:12:25 INFO  ---RUNTIME: Multi-Query Optimization took 144.41514015197754 ms
2022-09-20 23:12:25 INFO  Executing generated plans
2022-09-20 23:15:18 INFO  ---RUNTIME: Execution took 173689.02325630188 ms
2022-09-20 23:15:18 INFO  Done!
2022-09-20 23:15:18 INFO  # Finished -- repetition 1 of 7 
2022-09-20 23:15:18 INFO  # Optimization benchmark for data_corruption with args [['reviews', 'fast_loading', 'featurization_2', 'logistic_regression']] -- repetition 2 of 7
2022-09-20 23:15:18 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-20 23:15:18 INFO  Running instrumented original pipeline...
2022-09-20 23:15:18 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-20 23:15:18 INFO  ---RUNTIME: Importing and monkey-patching took 6.161212921142578 ms
2022-09-20 23:15:25 INFO  ---RUNTIME: Original pipeline execution took 6737.414121627808 ms (excluding imports and monkey-patching)
2022-09-20 23:15:25 INFO  Starting execution of 1 what-if analyses...
2022-09-20 23:15:25 INFO  Start plan generation for analysis DataCorruption...
2022-09-20 23:15:25 INFO  ---RUNTIME: Plan generation took 0.4773139953613281 ms
2022-09-20 23:15:25 INFO  Estimated runtime of original DAG is 5542.377233505249ms
2022-09-20 23:15:25 INFO  Performing Multi-Query Optimization
2022-09-20 23:15:25 INFO  Estimated unoptimized what-if runtime is 138559.43083763123ms
2022-09-20 23:15:25 INFO  Estimated optimised what-if runtime is 13728.731632232666ms
2022-09-20 23:15:25 INFO  Estimated optimisation runtime saving is 124830.69920539856ms
2022-09-20 23:15:25 INFO  ---RUNTIME: Multi-Query Optimization took 66.15209579467773 ms
2022-09-20 23:15:25 INFO  Executing generated plans
2022-09-20 23:15:44 INFO  ---RUNTIME: Execution took 19217.650175094604 ms
2022-09-20 23:15:44 INFO  Done!
2022-09-20 23:15:44 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-20 23:15:44 INFO  Running instrumented original pipeline...
2022-09-20 23:15:44 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-20 23:15:44 INFO  ---RUNTIME: Importing and monkey-patching took 6.213665008544922 ms
2022-09-20 23:15:51 INFO  ---RUNTIME: Original pipeline execution took 6947.399854660034 ms (excluding imports and monkey-patching)
2022-09-20 23:15:51 INFO  Starting execution of 1 what-if analyses...
2022-09-20 23:15:51 INFO  Start plan generation for analysis DataCorruption...
2022-09-20 23:15:51 INFO  ---RUNTIME: Plan generation took 0.4725456237792969 ms
2022-09-20 23:15:51 INFO  Estimated runtime of original DAG is 5758.805513381958ms
2022-09-20 23:15:51 WARNING Skipping Multi-Query Optimization (instead, only combine execution DAGs)
2022-09-20 23:15:51 INFO  Estimated unoptimised what-if runtime is 143970.13783454895ms
2022-09-20 23:15:51 INFO  ---RUNTIME: Multi-Query Optimization took 144.86384391784668 ms
2022-09-20 23:15:51 INFO  Executing generated plans
2022-09-20 23:18:46 INFO  ---RUNTIME: Execution took 174123.62265586853 ms
2022-09-20 23:18:46 INFO  Done!
2022-09-20 23:18:46 INFO  # Finished -- repetition 2 of 7 
2022-09-20 23:18:46 INFO  # Optimization benchmark for data_corruption with args [['reviews', 'fast_loading', 'featurization_2', 'logistic_regression']] -- repetition 3 of 7
2022-09-20 23:18:46 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-20 23:18:46 INFO  Running instrumented original pipeline...
2022-09-20 23:18:46 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-20 23:18:46 INFO  ---RUNTIME: Importing and monkey-patching took 6.195545196533203 ms
2022-09-20 23:18:52 INFO  ---RUNTIME: Original pipeline execution took 6811.520338058472 ms (excluding imports and monkey-patching)
2022-09-20 23:18:52 INFO  Starting execution of 1 what-if analyses...
2022-09-20 23:18:52 INFO  Start plan generation for analysis DataCorruption...
2022-09-20 23:18:52 INFO  ---RUNTIME: Plan generation took 0.47278404235839844 ms
2022-09-20 23:18:52 INFO  Estimated runtime of original DAG is 5604.3701171875ms
2022-09-20 23:18:52 INFO  Performing Multi-Query Optimization
2022-09-20 23:18:52 INFO  Estimated unoptimized what-if runtime is 140109.2529296875ms
2022-09-20 23:18:52 INFO  Estimated optimised what-if runtime is 13777.975082397461ms
2022-09-20 23:18:52 INFO  Estimated optimisation runtime saving is 126331.27784729004ms
2022-09-20 23:18:52 INFO  ---RUNTIME: Multi-Query Optimization took 65.99020957946777 ms
2022-09-20 23:18:52 INFO  Executing generated plans
2022-09-20 23:19:12 INFO  ---RUNTIME: Execution took 19292.293071746826 ms
2022-09-20 23:19:12 INFO  Done!
2022-09-20 23:19:12 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-20 23:19:12 INFO  Running instrumented original pipeline...
2022-09-20 23:19:12 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-20 23:19:12 INFO  ---RUNTIME: Importing and monkey-patching took 5.717039108276367 ms
2022-09-20 23:19:19 INFO  ---RUNTIME: Original pipeline execution took 6764.887094497681 ms (excluding imports and monkey-patching)
2022-09-20 23:19:19 INFO  Starting execution of 1 what-if analyses...
2022-09-20 23:19:19 INFO  Start plan generation for analysis DataCorruption...
2022-09-20 23:19:19 INFO  ---RUNTIME: Plan generation took 0.423431396484375 ms
2022-09-20 23:19:19 INFO  Estimated runtime of original DAG is 5567.280054092407ms
2022-09-20 23:19:19 WARNING Skipping Multi-Query Optimization (instead, only combine execution DAGs)
2022-09-20 23:19:19 INFO  Estimated unoptimised what-if runtime is 139182.00135231018ms
2022-09-20 23:19:19 INFO  ---RUNTIME: Multi-Query Optimization took 142.02427864074707 ms
2022-09-20 23:19:19 INFO  Executing generated plans
2022-09-20 23:22:13 INFO  ---RUNTIME: Execution took 174152.98008918762 ms
2022-09-20 23:22:13 INFO  Done!
2022-09-20 23:22:13 INFO  # Finished -- repetition 3 of 7 
2022-09-20 23:22:13 INFO  # Optimization benchmark for data_corruption with args [['reviews', 'fast_loading', 'featurization_2', 'logistic_regression']] -- repetition 4 of 7
2022-09-20 23:22:13 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-20 23:22:13 INFO  Running instrumented original pipeline...
2022-09-20 23:22:13 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-20 23:22:13 INFO  ---RUNTIME: Importing and monkey-patching took 6.106138229370117 ms
2022-09-20 23:22:20 INFO  ---RUNTIME: Original pipeline execution took 6788.985729217529 ms (excluding imports and monkey-patching)
2022-09-20 23:22:20 INFO  Starting execution of 1 what-if analyses...
2022-09-20 23:22:20 INFO  Start plan generation for analysis DataCorruption...
2022-09-20 23:22:20 INFO  ---RUNTIME: Plan generation took 0.4475116729736328 ms
2022-09-20 23:22:20 INFO  Estimated runtime of original DAG is 5587.76593208313ms
2022-09-20 23:22:20 INFO  Performing Multi-Query Optimization
2022-09-20 23:22:20 INFO  Estimated unoptimized what-if runtime is 139694.14830207825ms
2022-09-20 23:22:20 INFO  Estimated optimised what-if runtime is 13731.932878494263ms
2022-09-20 23:22:20 INFO  Estimated optimisation runtime saving is 125962.21542358398ms
2022-09-20 23:22:20 INFO  ---RUNTIME: Multi-Query Optimization took 66.19048118591309 ms
2022-09-20 23:22:20 INFO  Executing generated plans
2022-09-20 23:22:39 INFO  ---RUNTIME: Execution took 19477.559089660645 ms
2022-09-20 23:22:39 INFO  Done!
2022-09-20 23:22:39 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-20 23:22:39 INFO  Running instrumented original pipeline...
2022-09-20 23:22:39 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-20 23:22:39 INFO  ---RUNTIME: Importing and monkey-patching took 6.133556365966797 ms
2022-09-20 23:22:46 INFO  ---RUNTIME: Original pipeline execution took 6742.344379425049 ms (excluding imports and monkey-patching)
2022-09-20 23:22:46 INFO  Starting execution of 1 what-if analyses...
2022-09-20 23:22:46 INFO  Start plan generation for analysis DataCorruption...
2022-09-20 23:22:46 INFO  ---RUNTIME: Plan generation took 0.4239082336425781 ms
2022-09-20 23:22:46 INFO  Estimated runtime of original DAG is 5550.39119720459ms
2022-09-20 23:22:46 WARNING Skipping Multi-Query Optimization (instead, only combine execution DAGs)
2022-09-20 23:22:46 INFO  Estimated unoptimised what-if runtime is 138759.77993011475ms
2022-09-20 23:22:46 INFO  ---RUNTIME: Multi-Query Optimization took 142.5330638885498 ms
2022-09-20 23:22:46 INFO  Executing generated plans
2022-09-20 23:25:40 INFO  ---RUNTIME: Execution took 173700.62637329102 ms
2022-09-20 23:25:40 INFO  Done!
2022-09-20 23:25:40 INFO  # Finished -- repetition 4 of 7 
2022-09-20 23:25:40 INFO  # Optimization benchmark for data_corruption with args [['reviews', 'fast_loading', 'featurization_2', 'logistic_regression']] -- repetition 5 of 7
2022-09-20 23:25:40 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-20 23:25:40 INFO  Running instrumented original pipeline...
2022-09-20 23:25:40 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-20 23:25:40 INFO  ---RUNTIME: Importing and monkey-patching took 6.278514862060547 ms
2022-09-20 23:25:47 INFO  ---RUNTIME: Original pipeline execution took 6778.4624099731445 ms (excluding imports and monkey-patching)
2022-09-20 23:25:47 INFO  Starting execution of 1 what-if analyses...
2022-09-20 23:25:47 INFO  Start plan generation for analysis DataCorruption...
2022-09-20 23:25:47 INFO  ---RUNTIME: Plan generation took 0.4763603210449219 ms
2022-09-20 23:25:47 INFO  Estimated runtime of original DAG is 5576.678991317749ms
2022-09-20 23:25:47 INFO  Performing Multi-Query Optimization
2022-09-20 23:25:47 INFO  Estimated unoptimized what-if runtime is 139416.97478294373ms
2022-09-20 23:25:47 INFO  Estimated optimised what-if runtime is 13720.25990486145ms
2022-09-20 23:25:47 INFO  Estimated optimisation runtime saving is 125696.71487808228ms
2022-09-20 23:25:47 INFO  ---RUNTIME: Multi-Query Optimization took 308.1052303314209 ms
2022-09-20 23:25:47 INFO  Executing generated plans
2022-09-20 23:26:06 INFO  ---RUNTIME: Execution took 19359.615564346313 ms
2022-09-20 23:26:06 INFO  Done!
2022-09-20 23:26:06 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-20 23:26:06 INFO  Running instrumented original pipeline...
2022-09-20 23:26:06 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-20 23:26:06 INFO  ---RUNTIME: Importing and monkey-patching took 6.097316741943359 ms
2022-09-20 23:26:13 INFO  ---RUNTIME: Original pipeline execution took 6771.125078201294 ms (excluding imports and monkey-patching)
2022-09-20 23:26:13 INFO  Starting execution of 1 what-if analyses...
2022-09-20 23:26:13 INFO  Start plan generation for analysis DataCorruption...
2022-09-20 23:26:13 INFO  ---RUNTIME: Plan generation took 0.42700767517089844 ms
2022-09-20 23:26:13 INFO  Estimated runtime of original DAG is 5564.052581787109ms
2022-09-20 23:26:13 WARNING Skipping Multi-Query Optimization (instead, only combine execution DAGs)
2022-09-20 23:26:13 INFO  Estimated unoptimised what-if runtime is 139101.31454467773ms
2022-09-20 23:26:13 INFO  ---RUNTIME: Multi-Query Optimization took 145.0636386871338 ms
2022-09-20 23:26:13 INFO  Executing generated plans
2022-09-20 23:29:07 INFO  ---RUNTIME: Execution took 173325.37651062012 ms
2022-09-20 23:29:07 INFO  Done!
2022-09-20 23:29:07 INFO  # Finished -- repetition 5 of 7 
2022-09-20 23:29:07 INFO  # Optimization benchmark for data_corruption with args [['reviews', 'fast_loading', 'featurization_2', 'logistic_regression']] -- repetition 6 of 7
2022-09-20 23:29:07 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-20 23:29:07 INFO  Running instrumented original pipeline...
2022-09-20 23:29:07 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-20 23:29:07 INFO  ---RUNTIME: Importing and monkey-patching took 6.412506103515625 ms
2022-09-20 23:29:13 INFO  ---RUNTIME: Original pipeline execution took 6779.219627380371 ms (excluding imports and monkey-patching)
2022-09-20 23:29:13 INFO  Starting execution of 1 what-if analyses...
2022-09-20 23:29:13 INFO  Start plan generation for analysis DataCorruption...
2022-09-20 23:29:13 INFO  ---RUNTIME: Plan generation took 0.457763671875 ms
2022-09-20 23:29:13 INFO  Estimated runtime of original DAG is 5584.640026092529ms
2022-09-20 23:29:13 INFO  Performing Multi-Query Optimization
2022-09-20 23:29:13 INFO  Estimated unoptimized what-if runtime is 139616.00065231323ms
2022-09-20 23:29:13 INFO  Estimated optimised what-if runtime is 13750.211477279663ms
2022-09-20 23:29:13 INFO  Estimated optimisation runtime saving is 125865.78917503357ms
2022-09-20 23:29:13 INFO  ---RUNTIME: Multi-Query Optimization took 65.7961368560791 ms
2022-09-20 23:29:13 INFO  Executing generated plans
2022-09-20 23:29:33 INFO  ---RUNTIME: Execution took 19311.14101409912 ms
2022-09-20 23:29:33 INFO  Done!
2022-09-20 23:29:33 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-20 23:29:33 INFO  Running instrumented original pipeline...
2022-09-20 23:29:33 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-20 23:29:33 INFO  ---RUNTIME: Importing and monkey-patching took 5.727291107177734 ms
2022-09-20 23:29:40 INFO  ---RUNTIME: Original pipeline execution took 6745.866060256958 ms (excluding imports and monkey-patching)
2022-09-20 23:29:40 INFO  Starting execution of 1 what-if analyses...
2022-09-20 23:29:40 INFO  Start plan generation for analysis DataCorruption...
2022-09-20 23:29:40 INFO  ---RUNTIME: Plan generation took 0.4012584686279297 ms
2022-09-20 23:29:40 INFO  Estimated runtime of original DAG is 5546.239614486694ms
2022-09-20 23:29:40 WARNING Skipping Multi-Query Optimization (instead, only combine execution DAGs)
2022-09-20 23:29:40 INFO  Estimated unoptimised what-if runtime is 138655.99036216736ms
2022-09-20 23:29:40 INFO  ---RUNTIME: Multi-Query Optimization took 144.3772315979004 ms
2022-09-20 23:29:40 INFO  Executing generated plans
2022-09-20 23:32:34 INFO  ---RUNTIME: Execution took 174465.0158882141 ms
2022-09-20 23:32:34 INFO  Done!
2022-09-20 23:32:34 INFO  # Finished -- repetition 6 of 7 
2022-09-20 23:32:34 INFO  # Optimization benchmark for data_corruption with args [['reviews', 'fast_loading', 'featurization_2', 'logistic_regression']] -- repetition 7 of 7
2022-09-20 23:32:34 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-20 23:32:34 INFO  Running instrumented original pipeline...
2022-09-20 23:32:34 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-20 23:32:34 INFO  ---RUNTIME: Importing and monkey-patching took 6.320714950561523 ms
2022-09-20 23:32:41 INFO  ---RUNTIME: Original pipeline execution took 6849.822044372559 ms (excluding imports and monkey-patching)
2022-09-20 23:32:41 INFO  Starting execution of 1 what-if analyses...
2022-09-20 23:32:41 INFO  Start plan generation for analysis DataCorruption...
2022-09-20 23:32:41 INFO  ---RUNTIME: Plan generation took 0.47850608825683594 ms
2022-09-20 23:32:41 INFO  Estimated runtime of original DAG is 5634.397029876709ms
2022-09-20 23:32:41 INFO  Performing Multi-Query Optimization
2022-09-20 23:32:41 INFO  Estimated unoptimized what-if runtime is 140859.92574691772ms
2022-09-20 23:32:41 INFO  Estimated optimised what-if runtime is 13825.487613677979ms
2022-09-20 23:32:41 INFO  Estimated optimisation runtime saving is 127034.43813323975ms
2022-09-20 23:32:41 INFO  ---RUNTIME: Multi-Query Optimization took 66.04814529418945 ms
2022-09-20 23:32:41 INFO  Executing generated plans
2022-09-20 23:33:00 INFO  ---RUNTIME: Execution took 19221.567630767822 ms
2022-09-20 23:33:00 INFO  Done!
2022-09-20 23:33:00 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-20 23:33:00 INFO  Running instrumented original pipeline...
2022-09-20 23:33:00 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-20 23:33:00 INFO  ---RUNTIME: Importing and monkey-patching took 6.425619125366211 ms
2022-09-20 23:33:07 INFO  ---RUNTIME: Original pipeline execution took 6779.669523239136 ms (excluding imports and monkey-patching)
2022-09-20 23:33:07 INFO  Starting execution of 1 what-if analyses...
2022-09-20 23:33:07 INFO  Start plan generation for analysis DataCorruption...
2022-09-20 23:33:07 INFO  ---RUNTIME: Plan generation took 0.4241466522216797 ms
2022-09-20 23:33:07 INFO  Estimated runtime of original DAG is 5582.084894180298ms
2022-09-20 23:33:07 WARNING Skipping Multi-Query Optimization (instead, only combine execution DAGs)
2022-09-20 23:33:07 INFO  Estimated unoptimised what-if runtime is 139552.12235450745ms
2022-09-20 23:33:07 INFO  ---RUNTIME: Multi-Query Optimization took 144.85621452331543 ms
2022-09-20 23:33:07 INFO  Executing generated plans
2022-09-20 23:36:01 INFO  ---RUNTIME: Execution took 173503.2684803009 ms
2022-09-20 23:36:01 INFO  Done!
2022-09-20 23:36:01 INFO  # Finished -- repetition 7 of 7 
2022-09-20 23:36:01 INFO  # Final results after all repetitions
2022-09-20 23:36:01 INFO     repetition  ... no_opt_what_if_execution_combined_model_training
0           0  ...                                      2618.115664
1           1  ...                                      2630.405903
2           2  ...                                      2606.517315
3           3  ...                                      2586.107254
4           4  ...                                      2564.920425
5           5  ...                                      2612.006187
6           6  ...                                      2579.009056

[7 rows x 26 columns]
taskset -c 32-40 PROTOCOL_BUFFERS_PYTHON_IMPLEMENTATION=python python3.9 benchmarks_end_to_end.py data_corruption reviews fast_loading featurization_2 xgboost
2022-09-20 23:36:03.650048: W tensorflow/stream_executor/platform/default/dso_loader.cc:64] Could not load dynamic library 'libcudart.so.11.0'; dlerror: libcudart.so.11.0: cannot open shared object file: No such file or directory; LD_LIBRARY_PATH: /home/sgrafbe/mlwhatif/venv/lib/python3.9/site-packages/cv2/../../lib64:
2022-09-20 23:36:03.650102: I tensorflow/stream_executor/cuda/cudart_stub.cc:29] Ignore above cudart dlerror if you do not have a GPU set up on your machine.
2022-09-20 23:36:04 INFO  Patching sys.argv with ['mlwhatif', 'reviews', 'fast_loading', 'featurization_2', 'xgboost']
2022-09-20 23:36:04 INFO  Running instrumented original pipeline...
2022-09-20 23:36:04 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-20 23:36:05 INFO  ---RUNTIME: Importing and monkey-patching took 122.79081344604492 ms
2022-09-20 23:37:17 INFO  ---RUNTIME: Original pipeline execution took 72266.83831214905 ms (excluding imports and monkey-patching)
2022-09-20 23:37:17 INFO  Starting execution of 0 what-if analyses...
2022-09-20 23:37:17 INFO  Estimated runtime of original DAG is 71002.46119499207ms
2022-09-20 23:37:17 INFO  Performing Multi-Query Optimization
2022-09-20 23:37:17 INFO  Estimated unoptimized what-if runtime is 0ms
2022-09-20 23:37:17 INFO  Estimated optimised what-if runtime is 0ms
2022-09-20 23:37:17 INFO  Estimated optimisation runtime saving is 0ms
2022-09-20 23:37:17 INFO  ---RUNTIME: Multi-Query Optimization took 0.6849765777587891 ms
2022-09-20 23:37:17 INFO  Executing generated plans
2022-09-20 23:37:17 INFO  ---RUNTIME: Execution took 0.030994415283203125 ms
2022-09-20 23:37:17 INFO  Done!
2022-09-20 23:37:17 INFO  # Optimization benchmark for data_corruption with args [['reviews', 'fast_loading', 'featurization_2', 'xgboost']] -- repetition 1 of 7
2022-09-20 23:37:17 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-20 23:37:17 INFO  Running instrumented original pipeline...
2022-09-20 23:37:17 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-20 23:37:17 INFO  ---RUNTIME: Importing and monkey-patching took 8.030414581298828 ms
2022-09-20 23:38:07 INFO  ---RUNTIME: Original pipeline execution took 50572.081327438354 ms (excluding imports and monkey-patching)
2022-09-20 23:38:07 INFO  Starting execution of 1 what-if analyses...
2022-09-20 23:38:07 INFO  Start plan generation for analysis DataCorruption...
2022-09-20 23:38:07 INFO  ---RUNTIME: Plan generation took 0.6308555603027344 ms
2022-09-20 23:38:07 INFO  Estimated runtime of original DAG is 48788.36154937744ms
2022-09-20 23:38:07 INFO  Performing Multi-Query Optimization
2022-09-20 23:38:08 INFO  Estimated unoptimized what-if runtime is 1219709.038734436ms
2022-09-20 23:38:08 INFO  Estimated optimised what-if runtime is 62097.46956825256ms
2022-09-20 23:38:08 INFO  Estimated optimisation runtime saving is 1157611.5691661835ms
2022-09-20 23:38:08 INFO  ---RUNTIME: Multi-Query Optimization took 90.99364280700684 ms
2022-09-20 23:38:08 INFO  Executing generated plans
2022-09-20 23:38:57 INFO  ---RUNTIME: Execution took 49257.83085823059 ms
2022-09-20 23:38:57 INFO  Done!
2022-09-20 23:38:57 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-20 23:38:57 INFO  Running instrumented original pipeline...
2022-09-20 23:38:57 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-20 23:38:57 INFO  ---RUNTIME: Importing and monkey-patching took 6.263256072998047 ms
2022-09-20 23:40:05 INFO  ---RUNTIME: Original pipeline execution took 68076.18403434753 ms (excluding imports and monkey-patching)
2022-09-20 23:40:05 INFO  Starting execution of 1 what-if analyses...
2022-09-20 23:40:05 INFO  Start plan generation for analysis DataCorruption...
2022-09-20 23:40:05 INFO  ---RUNTIME: Plan generation took 0.484466552734375 ms
2022-09-20 23:40:05 INFO  Estimated runtime of original DAG is 66857.7971458435ms
2022-09-20 23:40:05 WARNING Skipping Multi-Query Optimization (instead, only combine execution DAGs)
2022-09-20 23:40:05 INFO  Estimated unoptimised what-if runtime is 1671444.9286460876ms
2022-09-20 23:40:05 INFO  ---RUNTIME: Multi-Query Optimization took 145.48206329345703 ms
2022-09-20 23:40:05 INFO  Executing generated plans
2022-09-21 00:04:27 INFO  ---RUNTIME: Execution took 1462342.0042991638 ms
2022-09-21 00:04:27 INFO  Done!
2022-09-21 00:04:27 INFO  # Finished -- repetition 1 of 7 
2022-09-21 00:04:27 INFO  # Optimization benchmark for data_corruption with args [['reviews', 'fast_loading', 'featurization_2', 'xgboost']] -- repetition 2 of 7
2022-09-21 00:04:27 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-21 00:04:27 INFO  Running instrumented original pipeline...
2022-09-21 00:04:27 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-21 00:04:27 INFO  ---RUNTIME: Importing and monkey-patching took 7.550716400146484 ms
2022-09-21 00:05:33 INFO  ---RUNTIME: Original pipeline execution took 65729.89225387573 ms (excluding imports and monkey-patching)
2022-09-21 00:05:33 INFO  Starting execution of 1 what-if analyses...
2022-09-21 00:05:33 INFO  Start plan generation for analysis DataCorruption...
2022-09-21 00:05:33 INFO  ---RUNTIME: Plan generation took 0.7350444793701172 ms
2022-09-21 00:05:33 INFO  Estimated runtime of original DAG is 64110.04853248596ms
2022-09-21 00:05:33 INFO  Performing Multi-Query Optimization
2022-09-21 00:05:33 INFO  Estimated unoptimized what-if runtime is 1602751.213312149ms
2022-09-21 00:05:33 INFO  Estimated optimised what-if runtime is 76708.77504348755ms
2022-09-21 00:05:33 INFO  Estimated optimisation runtime saving is 1526042.4382686615ms
2022-09-21 00:05:33 INFO  ---RUNTIME: Multi-Query Optimization took 93.21784973144531 ms
2022-09-21 00:05:33 INFO  Executing generated plans
2022-09-21 00:06:50 INFO  ---RUNTIME: Execution took 76405.95650672913 ms
2022-09-21 00:06:50 INFO  Done!
2022-09-21 00:06:50 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-21 00:06:50 INFO  Running instrumented original pipeline...
2022-09-21 00:06:50 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-21 00:06:50 INFO  ---RUNTIME: Importing and monkey-patching took 9.793758392333984 ms
2022-09-21 00:07:46 INFO  ---RUNTIME: Original pipeline execution took 56567.750692367554 ms (excluding imports and monkey-patching)
2022-09-21 00:07:46 INFO  Starting execution of 1 what-if analyses...
2022-09-21 00:07:46 INFO  Start plan generation for analysis DataCorruption...
2022-09-21 00:07:46 INFO  ---RUNTIME: Plan generation took 0.7948875427246094 ms
2022-09-21 00:07:46 INFO  Estimated runtime of original DAG is 54929.402112960815ms
2022-09-21 00:07:46 WARNING Skipping Multi-Query Optimization (instead, only combine execution DAGs)
2022-09-21 00:07:46 INFO  Estimated unoptimised what-if runtime is 1373235.0528240204ms
2022-09-21 00:07:46 INFO  ---RUNTIME: Multi-Query Optimization took 210.58320999145508 ms
2022-09-21 00:07:46 INFO  Executing generated plans
2022-09-21 00:31:53 INFO  ---RUNTIME: Execution took 1446444.8235034943 ms
2022-09-21 00:31:53 INFO  Done!
2022-09-21 00:31:53 INFO  # Finished -- repetition 2 of 7 
2022-09-21 00:31:53 INFO  # Optimization benchmark for data_corruption with args [['reviews', 'fast_loading', 'featurization_2', 'xgboost']] -- repetition 3 of 7
2022-09-21 00:31:53 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-21 00:31:53 INFO  Running instrumented original pipeline...
2022-09-21 00:31:53 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-21 00:31:53 INFO  ---RUNTIME: Importing and monkey-patching took 8.439779281616211 ms
2022-09-21 00:32:36 INFO  ---RUNTIME: Original pipeline execution took 42823.26316833496 ms (excluding imports and monkey-patching)
2022-09-21 00:32:36 INFO  Starting execution of 1 what-if analyses...
2022-09-21 00:32:36 INFO  Start plan generation for analysis DataCorruption...
2022-09-21 00:32:36 INFO  ---RUNTIME: Plan generation took 0.6778240203857422 ms
2022-09-21 00:32:36 INFO  Estimated runtime of original DAG is 41199.89609718323ms
2022-09-21 00:32:36 INFO  Performing Multi-Query Optimization
2022-09-21 00:32:36 INFO  Estimated unoptimized what-if runtime is 1029997.4024295807ms
2022-09-21 00:32:36 INFO  Estimated optimised what-if runtime is 54321.54178619385ms
2022-09-21 00:32:36 INFO  Estimated optimisation runtime saving is 975675.8606433868ms
2022-09-21 00:32:36 INFO  ---RUNTIME: Multi-Query Optimization took 88.90461921691895 ms
2022-09-21 00:32:36 INFO  Executing generated plans
2022-09-21 00:33:53 INFO  ---RUNTIME: Execution took 77271.075963974 ms
2022-09-21 00:33:53 INFO  Done!
2022-09-21 00:33:53 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-21 00:33:53 INFO  Running instrumented original pipeline...
2022-09-21 00:33:53 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-21 00:33:53 INFO  ---RUNTIME: Importing and monkey-patching took 8.511066436767578 ms
2022-09-21 00:34:32 INFO  ---RUNTIME: Original pipeline execution took 39148.16737174988 ms (excluding imports and monkey-patching)
2022-09-21 00:34:32 INFO  Starting execution of 1 what-if analyses...
2022-09-21 00:34:32 INFO  Start plan generation for analysis DataCorruption...
2022-09-21 00:34:32 INFO  ---RUNTIME: Plan generation took 0.5824565887451172 ms
2022-09-21 00:34:32 INFO  Estimated runtime of original DAG is 37617.38443374634ms
2022-09-21 00:34:32 WARNING Skipping Multi-Query Optimization (instead, only combine execution DAGs)
2022-09-21 00:34:33 INFO  Estimated unoptimised what-if runtime is 940434.6108436584ms
2022-09-21 00:34:33 INFO  ---RUNTIME: Multi-Query Optimization took 200.93703269958496 ms
2022-09-21 00:34:33 INFO  Executing generated plans
2022-09-21 00:50:09 INFO  ---RUNTIME: Execution took 936238.7268543243 ms
2022-09-21 00:50:09 INFO  Done!
2022-09-21 00:50:09 INFO  # Finished -- repetition 3 of 7 
2022-09-21 00:50:09 INFO  # Optimization benchmark for data_corruption with args [['reviews', 'fast_loading', 'featurization_2', 'xgboost']] -- repetition 4 of 7
2022-09-21 00:50:09 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-21 00:50:09 INFO  Running instrumented original pipeline...
2022-09-21 00:50:09 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-21 00:50:09 INFO  ---RUNTIME: Importing and monkey-patching took 6.41942024230957 ms
2022-09-21 00:50:28 INFO  ---RUNTIME: Original pipeline execution took 19288.132905960083 ms (excluding imports and monkey-patching)
2022-09-21 00:50:28 INFO  Starting execution of 1 what-if analyses...
2022-09-21 00:50:28 INFO  Start plan generation for analysis DataCorruption...
2022-09-21 00:50:28 INFO  ---RUNTIME: Plan generation took 0.4677772521972656 ms
2022-09-21 00:50:28 INFO  Estimated runtime of original DAG is 18050.852298736572ms
2022-09-21 00:50:28 INFO  Performing Multi-Query Optimization
2022-09-21 00:50:28 INFO  Estimated unoptimized what-if runtime is 451271.3074684143ms
2022-09-21 00:50:28 INFO  Estimated optimised what-if runtime is 27424.976587295532ms
2022-09-21 00:50:28 INFO  Estimated optimisation runtime saving is 423846.3308811188ms
2022-09-21 00:50:28 INFO  ---RUNTIME: Multi-Query Optimization took 67.23523139953613 ms
2022-09-21 00:50:28 INFO  Executing generated plans
2022-09-21 00:51:01 INFO  ---RUNTIME: Execution took 32376.112699508667 ms
2022-09-21 00:51:01 INFO  Done!
2022-09-21 00:51:01 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-21 00:51:01 INFO  Running instrumented original pipeline...
2022-09-21 00:51:01 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-21 00:51:01 INFO  ---RUNTIME: Importing and monkey-patching took 5.863666534423828 ms
2022-09-21 00:51:21 INFO  ---RUNTIME: Original pipeline execution took 20159.499406814575 ms (excluding imports and monkey-patching)
2022-09-21 00:51:21 INFO  Starting execution of 1 what-if analyses...
2022-09-21 00:51:21 INFO  Start plan generation for analysis DataCorruption...
2022-09-21 00:51:21 INFO  ---RUNTIME: Plan generation took 0.4458427429199219 ms
2022-09-21 00:51:21 INFO  Estimated runtime of original DAG is 18919.711112976074ms
2022-09-21 00:51:21 WARNING Skipping Multi-Query Optimization (instead, only combine execution DAGs)
2022-09-21 00:51:21 INFO  Estimated unoptimised what-if runtime is 472992.77782440186ms
2022-09-21 00:51:21 INFO  ---RUNTIME: Multi-Query Optimization took 143.95618438720703 ms
2022-09-21 00:51:21 INFO  Executing generated plans
2022-09-21 01:04:03 INFO  ---RUNTIME: Execution took 761638.3910179138 ms
2022-09-21 01:04:03 INFO  Done!
2022-09-21 01:04:03 INFO  # Finished -- repetition 4 of 7 
2022-09-21 01:04:03 INFO  # Optimization benchmark for data_corruption with args [['reviews', 'fast_loading', 'featurization_2', 'xgboost']] -- repetition 5 of 7
2022-09-21 01:04:03 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-21 01:04:03 INFO  Running instrumented original pipeline...
2022-09-21 01:04:03 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-21 01:04:03 INFO  ---RUNTIME: Importing and monkey-patching took 6.753206253051758 ms
2022-09-21 01:04:53 INFO  ---RUNTIME: Original pipeline execution took 50824.48077201843 ms (excluding imports and monkey-patching)
2022-09-21 01:04:53 INFO  Starting execution of 1 what-if analyses...
2022-09-21 01:04:53 INFO  Start plan generation for analysis DataCorruption...
2022-09-21 01:04:53 INFO  ---RUNTIME: Plan generation took 0.5214214324951172 ms
2022-09-21 01:04:53 INFO  Estimated runtime of original DAG is 49565.56844711304ms
2022-09-21 01:04:53 INFO  Performing Multi-Query Optimization
2022-09-21 01:04:53 INFO  Estimated unoptimized what-if runtime is 1239139.211177826ms
2022-09-21 01:04:53 INFO  Estimated optimised what-if runtime is 59195.608377456665ms
2022-09-21 01:04:53 INFO  Estimated optimisation runtime saving is 1179943.6028003693ms
2022-09-21 01:04:53 INFO  ---RUNTIME: Multi-Query Optimization took 73.13847541809082 ms
2022-09-21 01:04:53 INFO  Executing generated plans
2022-09-21 01:06:04 INFO  ---RUNTIME: Execution took 70134.62615013123 ms
2022-09-21 01:06:04 INFO  Done!
2022-09-21 01:06:04 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-21 01:06:04 INFO  Running instrumented original pipeline...
2022-09-21 01:06:04 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-21 01:06:04 INFO  ---RUNTIME: Importing and monkey-patching took 6.097555160522461 ms
2022-09-21 01:06:28 INFO  ---RUNTIME: Original pipeline execution took 24705.7204246521 ms (excluding imports and monkey-patching)
2022-09-21 01:06:28 INFO  Starting execution of 1 what-if analyses...
2022-09-21 01:06:28 INFO  Start plan generation for analysis DataCorruption...
2022-09-21 01:06:28 INFO  ---RUNTIME: Plan generation took 0.4324913024902344 ms
2022-09-21 01:06:28 INFO  Estimated runtime of original DAG is 23216.402053833008ms
2022-09-21 01:06:28 WARNING Skipping Multi-Query Optimization (instead, only combine execution DAGs)
2022-09-21 01:06:28 INFO  Estimated unoptimised what-if runtime is 580410.0513458252ms
2022-09-21 01:06:28 INFO  ---RUNTIME: Multi-Query Optimization took 143.9652442932129 ms
2022-09-21 01:06:28 INFO  Executing generated plans
2022-09-21 01:18:51 INFO  ---RUNTIME: Execution took 742909.1203212738 ms
2022-09-21 01:18:51 INFO  Done!
2022-09-21 01:18:51 INFO  # Finished -- repetition 5 of 7 
2022-09-21 01:18:51 INFO  # Optimization benchmark for data_corruption with args [['reviews', 'fast_loading', 'featurization_2', 'xgboost']] -- repetition 6 of 7
2022-09-21 01:18:51 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-21 01:18:51 INFO  Running instrumented original pipeline...
2022-09-21 01:18:51 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-21 01:18:51 INFO  ---RUNTIME: Importing and monkey-patching took 6.403207778930664 ms
2022-09-21 01:19:14 INFO  ---RUNTIME: Original pipeline execution took 23007.405996322632 ms (excluding imports and monkey-patching)
2022-09-21 01:19:14 INFO  Starting execution of 1 what-if analyses...
2022-09-21 01:19:14 INFO  Start plan generation for analysis DataCorruption...
2022-09-21 01:19:14 INFO  ---RUNTIME: Plan generation took 0.4780292510986328 ms
2022-09-21 01:19:14 INFO  Estimated runtime of original DAG is 21689.66245651245ms
2022-09-21 01:19:14 INFO  Performing Multi-Query Optimization
2022-09-21 01:19:14 INFO  Estimated unoptimized what-if runtime is 542241.5614128113ms
2022-09-21 01:19:14 INFO  Estimated optimised what-if runtime is 31864.458560943604ms
2022-09-21 01:19:14 INFO  Estimated optimisation runtime saving is 510377.1028518677ms
2022-09-21 01:19:14 INFO  ---RUNTIME: Multi-Query Optimization took 72.54409790039062 ms
2022-09-21 01:19:14 INFO  Executing generated plans
2022-09-21 01:19:53 INFO  ---RUNTIME: Execution took 38856.215715408325 ms
2022-09-21 01:19:53 INFO  Done!
2022-09-21 01:19:53 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-21 01:19:53 INFO  Running instrumented original pipeline...
2022-09-21 01:19:53 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-21 01:19:53 INFO  ---RUNTIME: Importing and monkey-patching took 6.210088729858398 ms
2022-09-21 01:20:23 INFO  ---RUNTIME: Original pipeline execution took 29907.850742340088 ms (excluding imports and monkey-patching)
2022-09-21 01:20:23 INFO  Starting execution of 1 what-if analyses...
2022-09-21 01:20:23 INFO  Start plan generation for analysis DataCorruption...
2022-09-21 01:20:23 INFO  ---RUNTIME: Plan generation took 0.7078647613525391 ms
2022-09-21 01:20:23 INFO  Estimated runtime of original DAG is 28606.36258125305ms
2022-09-21 01:20:23 WARNING Skipping Multi-Query Optimization (instead, only combine execution DAGs)
2022-09-21 01:20:23 INFO  Estimated unoptimised what-if runtime is 715159.0645313263ms
2022-09-21 01:20:23 INFO  ---RUNTIME: Multi-Query Optimization took 155.9426784515381 ms
2022-09-21 01:20:23 INFO  Executing generated plans
2022-09-21 01:33:22 INFO  ---RUNTIME: Execution took 778116.4619922638 ms
2022-09-21 01:33:22 INFO  Done!
2022-09-21 01:33:22 INFO  # Finished -- repetition 6 of 7 
2022-09-21 01:33:22 INFO  # Optimization benchmark for data_corruption with args [['reviews', 'fast_loading', 'featurization_2', 'xgboost']] -- repetition 7 of 7
2022-09-21 01:33:22 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-21 01:33:22 INFO  Running instrumented original pipeline...
2022-09-21 01:33:22 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-21 01:33:22 INFO  ---RUNTIME: Importing and monkey-patching took 6.217002868652344 ms
2022-09-21 01:34:02 INFO  ---RUNTIME: Original pipeline execution took 40192.82603263855 ms (excluding imports and monkey-patching)
2022-09-21 01:34:02 INFO  Starting execution of 1 what-if analyses...
2022-09-21 01:34:02 INFO  Start plan generation for analysis DataCorruption...
2022-09-21 01:34:02 INFO  ---RUNTIME: Plan generation took 0.6585121154785156 ms
2022-09-21 01:34:02 INFO  Estimated runtime of original DAG is 38943.554162979126ms
2022-09-21 01:34:02 INFO  Performing Multi-Query Optimization
2022-09-21 01:34:02 INFO  Estimated unoptimized what-if runtime is 973588.8540744781ms
2022-09-21 01:34:02 INFO  Estimated optimised what-if runtime is 49589.112758636475ms
2022-09-21 01:34:02 INFO  Estimated optimisation runtime saving is 923999.7413158417ms
2022-09-21 01:34:02 INFO  ---RUNTIME: Multi-Query Optimization took 89.39933776855469 ms
2022-09-21 01:34:02 INFO  Executing generated plans
2022-09-21 01:34:42 INFO  ---RUNTIME: Execution took 40245.1069355011 ms
2022-09-21 01:34:42 INFO  Done!
2022-09-21 01:34:42 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-21 01:34:42 INFO  Running instrumented original pipeline...
2022-09-21 01:34:42 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-21 01:34:42 INFO  ---RUNTIME: Importing and monkey-patching took 7.256507873535156 ms
2022-09-21 01:35:06 INFO  ---RUNTIME: Original pipeline execution took 24188.120126724243 ms (excluding imports and monkey-patching)
2022-09-21 01:35:06 INFO  Starting execution of 1 what-if analyses...
2022-09-21 01:35:06 INFO  Start plan generation for analysis DataCorruption...
2022-09-21 01:35:06 INFO  ---RUNTIME: Plan generation took 0.4639625549316406 ms
2022-09-21 01:35:06 INFO  Estimated runtime of original DAG is 22828.245639801025ms
2022-09-21 01:35:06 WARNING Skipping Multi-Query Optimization (instead, only combine execution DAGs)
2022-09-21 01:35:06 INFO  Estimated unoptimised what-if runtime is 570706.1409950256ms
2022-09-21 01:35:06 INFO  ---RUNTIME: Multi-Query Optimization took 153.95092964172363 ms
2022-09-21 01:35:06 INFO  Executing generated plans
2022-09-21 01:49:38 INFO  ---RUNTIME: Execution took 871178.9786815643 ms
2022-09-21 01:49:38 INFO  Done!
2022-09-21 01:49:38 INFO  # Finished -- repetition 7 of 7 
2022-09-21 01:49:38 INFO  # Final results after all repetitions
2022-09-21 01:49:38 INFO     repetition  ... no_opt_what_if_execution_combined_model_training
0           0  ...                                     1.268668e+06
1           1  ...                                     1.267838e+06
2           2  ...                                     7.260746e+05
3           3  ...                                     5.861416e+05
4           4  ...                                     5.694914e+05
5           5  ...                                     6.035738e+05
6           6  ...                                     6.921124e+05

[7 rows x 26 columns]
taskset -c 32-40 PROTOCOL_BUFFERS_PYTHON_IMPLEMENTATION=python python3.9 benchmarks_end_to_end.py data_corruption reviews fast_loading featurization_2 neural_network
2022-09-21 01:49:40.492825: W tensorflow/stream_executor/platform/default/dso_loader.cc:64] Could not load dynamic library 'libcudart.so.11.0'; dlerror: libcudart.so.11.0: cannot open shared object file: No such file or directory; LD_LIBRARY_PATH: /home/sgrafbe/mlwhatif/venv/lib/python3.9/site-packages/cv2/../../lib64:
2022-09-21 01:49:40.492876: I tensorflow/stream_executor/cuda/cudart_stub.cc:29] Ignore above cudart dlerror if you do not have a GPU set up on your machine.
2022-09-21 01:49:41 INFO  Patching sys.argv with ['mlwhatif', 'reviews', 'fast_loading', 'featurization_2', 'neural_network']
2022-09-21 01:49:41 INFO  Running instrumented original pipeline...
2022-09-21 01:49:41 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-21 01:49:41 INFO  ---RUNTIME: Importing and monkey-patching took 121.98758125305176 ms
2022-09-21 01:49:47.062253: W tensorflow/stream_executor/platform/default/dso_loader.cc:64] Could not load dynamic library 'libcuda.so.1'; dlerror: libcuda.so.1: cannot open shared object file: No such file or directory; LD_LIBRARY_PATH: /home/sgrafbe/mlwhatif/venv/lib/python3.9/site-packages/cv2/../../lib64:
2022-09-21 01:49:47.062293: W tensorflow/stream_executor/cuda/cuda_driver.cc:326] failed call to cuInit: UNKNOWN ERROR (303)
2022-09-21 01:49:47.062318: I tensorflow/stream_executor/cuda/cuda_diagnostics.cc:156] kernel driver does not appear to be running on this host (angus): /proc/driver/nvidia/version does not exist
2022-09-21 01:49:47.062861: I tensorflow/core/platform/cpu_feature_guard.cc:142] This TensorFlow binary is optimized with oneAPI Deep Neural Network Library (oneDNN) to use the following CPU instructions in performance-critical operations:  AVX2 FMA
To enable them in other operations, rebuild TensorFlow with the appropriate compiler flags.
2022-09-21 01:49:47.686841: I tensorflow/compiler/mlir/mlir_graph_optimization_pass.cc:176] None of the MLIR Optimization Passes are enabled (registered 2)
2022-09-21 01:49:47.701179: I tensorflow/core/platform/profile_utils/cpu_utils.cc:114] CPU Frequency: 2595130000 Hz
2022-09-21 01:49:54 INFO  ---RUNTIME: Original pipeline execution took 13020.784616470337 ms (excluding imports and monkey-patching)
2022-09-21 01:49:54 INFO  Starting execution of 0 what-if analyses...
2022-09-21 01:49:54 INFO  Estimated runtime of original DAG is 11789.864540100098ms
2022-09-21 01:49:54 INFO  Performing Multi-Query Optimization
2022-09-21 01:49:54 INFO  Estimated unoptimized what-if runtime is 0ms
2022-09-21 01:49:54 INFO  Estimated optimised what-if runtime is 0ms
2022-09-21 01:49:54 INFO  Estimated optimisation runtime saving is 0ms
2022-09-21 01:49:54 INFO  ---RUNTIME: Multi-Query Optimization took 0.5266666412353516 ms
2022-09-21 01:49:54 INFO  Executing generated plans
2022-09-21 01:49:54 INFO  ---RUNTIME: Execution took 0.023603439331054688 ms
2022-09-21 01:49:54 INFO  Done!
2022-09-21 01:49:54 INFO  # Optimization benchmark for data_corruption with args [['reviews', 'fast_loading', 'featurization_2', 'neural_network']] -- repetition 1 of 7
2022-09-21 01:49:54 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-21 01:49:54 INFO  Running instrumented original pipeline...
2022-09-21 01:49:54 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-21 01:49:54 INFO  ---RUNTIME: Importing and monkey-patching took 5.33294677734375 ms
2022-09-21 01:50:08 INFO  ---RUNTIME: Original pipeline execution took 13259.80257987976 ms (excluding imports and monkey-patching)
2022-09-21 01:50:08 INFO  Starting execution of 1 what-if analyses...
2022-09-21 01:50:08 INFO  Start plan generation for analysis DataCorruption...
2022-09-21 01:50:08 INFO  ---RUNTIME: Plan generation took 0.4913806915283203 ms
2022-09-21 01:50:08 INFO  Estimated runtime of original DAG is 12059.163570404053ms
2022-09-21 01:50:08 INFO  Performing Multi-Query Optimization
2022-09-21 01:50:08 INFO  Estimated unoptimized what-if runtime is 301479.0892601013ms
2022-09-21 01:50:08 INFO  Estimated optimised what-if runtime is 39003.96633148193ms
2022-09-21 01:50:08 INFO  Estimated optimisation runtime saving is 262475.1229286194ms
2022-09-21 01:50:08 INFO  ---RUNTIME: Multi-Query Optimization took 66.85996055603027 ms
2022-09-21 01:50:08 INFO  Executing generated plans
2022-09-21 01:50:50 INFO  ---RUNTIME: Execution took 42248.56495857239 ms
2022-09-21 01:50:50 INFO  Done!
2022-09-21 01:50:50 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-21 01:50:50 INFO  Running instrumented original pipeline...
2022-09-21 01:50:50 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-21 01:50:50 INFO  ---RUNTIME: Importing and monkey-patching took 6.4525604248046875 ms
2022-09-21 01:51:04 INFO  ---RUNTIME: Original pipeline execution took 14347.389221191406 ms (excluding imports and monkey-patching)
2022-09-21 01:51:04 INFO  Starting execution of 1 what-if analyses...
2022-09-21 01:51:04 INFO  Start plan generation for analysis DataCorruption...
2022-09-21 01:51:04 INFO  ---RUNTIME: Plan generation took 0.4737377166748047 ms
2022-09-21 01:51:04 INFO  Estimated runtime of original DAG is 12733.795166015625ms
2022-09-21 01:51:04 WARNING Skipping Multi-Query Optimization (instead, only combine execution DAGs)
2022-09-21 01:51:05 INFO  Estimated unoptimised what-if runtime is 318344.8791503906ms
2022-09-21 01:51:05 INFO  ---RUNTIME: Multi-Query Optimization took 142.5037384033203 ms
2022-09-21 01:51:05 INFO  Executing generated plans
2022-09-21 01:56:56 INFO  ---RUNTIME: Execution took 351682.147026062 ms
2022-09-21 01:56:56 INFO  Done!
2022-09-21 01:56:56 INFO  # Finished -- repetition 1 of 7 
2022-09-21 01:56:56 INFO  # Optimization benchmark for data_corruption with args [['reviews', 'fast_loading', 'featurization_2', 'neural_network']] -- repetition 2 of 7
2022-09-21 01:56:56 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-21 01:56:56 INFO  Running instrumented original pipeline...
2022-09-21 01:56:57 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-21 01:56:57 INFO  ---RUNTIME: Importing and monkey-patching took 5.879640579223633 ms
2022-09-21 01:57:11 INFO  ---RUNTIME: Original pipeline execution took 14493.139743804932 ms (excluding imports and monkey-patching)
2022-09-21 01:57:11 INFO  Starting execution of 1 what-if analyses...
2022-09-21 01:57:11 INFO  Start plan generation for analysis DataCorruption...
2022-09-21 01:57:11 INFO  ---RUNTIME: Plan generation took 1.3914108276367188 ms
2022-09-21 01:57:11 INFO  Estimated runtime of original DAG is 12424.484252929688ms
2022-09-21 01:57:11 INFO  Performing Multi-Query Optimization
2022-09-21 01:57:11 INFO  Estimated unoptimized what-if runtime is 310612.1063232422ms
2022-09-21 01:57:11 INFO  Estimated optimised what-if runtime is 40060.627937316895ms
2022-09-21 01:57:11 INFO  Estimated optimisation runtime saving is 270551.4783859253ms
2022-09-21 01:57:11 INFO  ---RUNTIME: Multi-Query Optimization took 65.62399864196777 ms
2022-09-21 01:57:11 INFO  Executing generated plans
2022-09-21 01:57:54 INFO  ---RUNTIME: Execution took 43386.23762130737 ms
2022-09-21 01:57:54 INFO  Done!
2022-09-21 01:57:54 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-21 01:57:54 INFO  Running instrumented original pipeline...
2022-09-21 01:57:54 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-21 01:57:54 INFO  ---RUNTIME: Importing and monkey-patching took 6.415605545043945 ms
2022-09-21 01:58:08 INFO  ---RUNTIME: Original pipeline execution took 13598.490238189697 ms (excluding imports and monkey-patching)
2022-09-21 01:58:08 INFO  Starting execution of 1 what-if analyses...
2022-09-21 01:58:08 INFO  Start plan generation for analysis DataCorruption...
2022-09-21 01:58:08 INFO  ---RUNTIME: Plan generation took 0.4620552062988281 ms
2022-09-21 01:58:08 INFO  Estimated runtime of original DAG is 12332.825660705566ms
2022-09-21 01:58:08 WARNING Skipping Multi-Query Optimization (instead, only combine execution DAGs)
2022-09-21 01:58:08 INFO  Estimated unoptimised what-if runtime is 308320.64151763916ms
2022-09-21 01:58:08 INFO  ---RUNTIME: Multi-Query Optimization took 143.24545860290527 ms
2022-09-21 01:58:08 INFO  Executing generated plans
2022-09-21 02:03:56 INFO  ---RUNTIME: Execution took 348439.1944408417 ms
2022-09-21 02:03:56 INFO  Done!
2022-09-21 02:03:56 INFO  # Finished -- repetition 2 of 7 
2022-09-21 02:03:56 INFO  # Optimization benchmark for data_corruption with args [['reviews', 'fast_loading', 'featurization_2', 'neural_network']] -- repetition 3 of 7
2022-09-21 02:03:56 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-21 02:03:56 INFO  Running instrumented original pipeline...
2022-09-21 02:03:56 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-21 02:03:56 INFO  ---RUNTIME: Importing and monkey-patching took 5.923986434936523 ms
2022-09-21 02:04:10 INFO  ---RUNTIME: Original pipeline execution took 13503.145933151245 ms (excluding imports and monkey-patching)
2022-09-21 02:04:10 INFO  Starting execution of 1 what-if analyses...
2022-09-21 02:04:10 INFO  Start plan generation for analysis DataCorruption...
2022-09-21 02:04:10 INFO  ---RUNTIME: Plan generation took 0.45490264892578125 ms
2022-09-21 02:04:10 INFO  Estimated runtime of original DAG is 12231.26745223999ms
2022-09-21 02:04:10 INFO  Performing Multi-Query Optimization
2022-09-21 02:04:10 INFO  Estimated unoptimized what-if runtime is 305781.68630599976ms
2022-09-21 02:04:10 INFO  Estimated optimised what-if runtime is 40259.56058502197ms
2022-09-21 02:04:10 INFO  Estimated optimisation runtime saving is 265522.1257209778ms
2022-09-21 02:04:10 INFO  ---RUNTIME: Multi-Query Optimization took 65.96159934997559 ms
2022-09-21 02:04:10 INFO  Executing generated plans
2022-09-21 02:04:54 INFO  ---RUNTIME: Execution took 44063.06290626526 ms
2022-09-21 02:04:54 INFO  Done!
2022-09-21 02:04:54 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-21 02:04:54 INFO  Running instrumented original pipeline...
2022-09-21 02:04:54 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-21 02:04:54 INFO  ---RUNTIME: Importing and monkey-patching took 5.89299201965332 ms
2022-09-21 02:05:07 INFO  ---RUNTIME: Original pipeline execution took 13363.24405670166 ms (excluding imports and monkey-patching)
2022-09-21 02:05:07 INFO  Starting execution of 1 what-if analyses...
2022-09-21 02:05:07 INFO  Start plan generation for analysis DataCorruption...
2022-09-21 02:05:07 INFO  ---RUNTIME: Plan generation took 0.45037269592285156 ms
2022-09-21 02:05:07 INFO  Estimated runtime of original DAG is 12114.48359489441ms
2022-09-21 02:05:07 WARNING Skipping Multi-Query Optimization (instead, only combine execution DAGs)
2022-09-21 02:05:08 INFO  Estimated unoptimised what-if runtime is 302862.08987236023ms
2022-09-21 02:05:08 INFO  ---RUNTIME: Multi-Query Optimization took 144.35815811157227 ms
2022-09-21 02:05:08 INFO  Executing generated plans
2022-09-21 02:10:56 INFO  ---RUNTIME: Execution took 348162.24813461304 ms
2022-09-21 02:10:56 INFO  Done!
2022-09-21 02:10:56 INFO  # Finished -- repetition 3 of 7 
2022-09-21 02:10:56 INFO  # Optimization benchmark for data_corruption with args [['reviews', 'fast_loading', 'featurization_2', 'neural_network']] -- repetition 4 of 7
2022-09-21 02:10:56 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-21 02:10:56 INFO  Running instrumented original pipeline...
2022-09-21 02:10:56 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-21 02:10:56 INFO  ---RUNTIME: Importing and monkey-patching took 6.58416748046875 ms
2022-09-21 02:11:09 INFO  ---RUNTIME: Original pipeline execution took 13725.16417503357 ms (excluding imports and monkey-patching)
2022-09-21 02:11:09 INFO  Starting execution of 1 what-if analyses...
2022-09-21 02:11:09 INFO  Start plan generation for analysis DataCorruption...
2022-09-21 02:11:09 INFO  ---RUNTIME: Plan generation took 1.7430782318115234 ms
2022-09-21 02:11:09 INFO  Estimated runtime of original DAG is 12458.603143692017ms
2022-09-21 02:11:09 INFO  Performing Multi-Query Optimization
2022-09-21 02:11:10 INFO  Estimated unoptimized what-if runtime is 311465.0785923004ms
2022-09-21 02:11:10 INFO  Estimated optimised what-if runtime is 39374.37105178833ms
2022-09-21 02:11:10 INFO  Estimated optimisation runtime saving is 272090.7075405121ms
2022-09-21 02:11:10 INFO  ---RUNTIME: Multi-Query Optimization took 65.00744819641113 ms
2022-09-21 02:11:10 INFO  Executing generated plans
2022-09-21 02:11:57 INFO  ---RUNTIME: Execution took 47682.767391204834 ms
2022-09-21 02:11:57 INFO  Done!
2022-09-21 02:11:57 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-21 02:11:57 INFO  Running instrumented original pipeline...
2022-09-21 02:11:57 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-21 02:11:57 INFO  ---RUNTIME: Importing and monkey-patching took 6.047487258911133 ms
2022-09-21 02:12:11 INFO  ---RUNTIME: Original pipeline execution took 13722.51296043396 ms (excluding imports and monkey-patching)
2022-09-21 02:12:11 INFO  Starting execution of 1 what-if analyses...
2022-09-21 02:12:11 INFO  Start plan generation for analysis DataCorruption...
2022-09-21 02:12:11 INFO  ---RUNTIME: Plan generation took 0.49996376037597656 ms
2022-09-21 02:12:11 INFO  Estimated runtime of original DAG is 12456.62784576416ms
2022-09-21 02:12:11 WARNING Skipping Multi-Query Optimization (instead, only combine execution DAGs)
2022-09-21 02:12:11 INFO  Estimated unoptimised what-if runtime is 311415.696144104ms
2022-09-21 02:12:11 INFO  ---RUNTIME: Multi-Query Optimization took 145.5364227294922 ms
2022-09-21 02:12:11 INFO  Executing generated plans
2022-09-21 02:18:04 INFO  ---RUNTIME: Execution took 353208.2061767578 ms
2022-09-21 02:18:04 INFO  Done!
2022-09-21 02:18:04 INFO  # Finished -- repetition 4 of 7 
2022-09-21 02:18:04 INFO  # Optimization benchmark for data_corruption with args [['reviews', 'fast_loading', 'featurization_2', 'neural_network']] -- repetition 5 of 7
2022-09-21 02:18:04 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-21 02:18:04 INFO  Running instrumented original pipeline...
2022-09-21 02:18:04 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-21 02:18:04 INFO  ---RUNTIME: Importing and monkey-patching took 6.875276565551758 ms
2022-09-21 02:18:18 INFO  ---RUNTIME: Original pipeline execution took 13831.920146942139 ms (excluding imports and monkey-patching)
2022-09-21 02:18:18 INFO  Starting execution of 1 what-if analyses...
2022-09-21 02:18:18 INFO  Start plan generation for analysis DataCorruption...
2022-09-21 02:18:18 INFO  ---RUNTIME: Plan generation took 0.4687309265136719 ms
2022-09-21 02:18:18 INFO  Estimated runtime of original DAG is 12556.750059127808ms
2022-09-21 02:18:18 INFO  Performing Multi-Query Optimization
2022-09-21 02:18:18 INFO  Estimated unoptimized what-if runtime is 313918.7514781952ms
2022-09-21 02:18:18 INFO  Estimated optimised what-if runtime is 40192.82793998718ms
2022-09-21 02:18:18 INFO  Estimated optimisation runtime saving is 273725.923538208ms
2022-09-21 02:18:18 INFO  ---RUNTIME: Multi-Query Optimization took 65.28139114379883 ms
2022-09-21 02:18:18 INFO  Executing generated plans
2022-09-21 02:19:01 INFO  ---RUNTIME: Execution took 43277.79674530029 ms
2022-09-21 02:19:01 INFO  Done!
2022-09-21 02:19:01 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-21 02:19:01 INFO  Running instrumented original pipeline...
2022-09-21 02:19:02 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-21 02:19:02 INFO  ---RUNTIME: Importing and monkey-patching took 5.746126174926758 ms
2022-09-21 02:19:15 INFO  ---RUNTIME: Original pipeline execution took 13746.282577514648 ms (excluding imports and monkey-patching)
2022-09-21 02:19:15 INFO  Starting execution of 1 what-if analyses...
2022-09-21 02:19:15 INFO  Start plan generation for analysis DataCorruption...
2022-09-21 02:19:15 INFO  ---RUNTIME: Plan generation took 0.46372413635253906 ms
2022-09-21 02:19:15 INFO  Estimated runtime of original DAG is 12481.979846954346ms
2022-09-21 02:19:15 WARNING Skipping Multi-Query Optimization (instead, only combine execution DAGs)
2022-09-21 02:19:15 INFO  Estimated unoptimised what-if runtime is 312049.49617385864ms
2022-09-21 02:19:15 INFO  ---RUNTIME: Multi-Query Optimization took 141.07561111450195 ms
2022-09-21 02:19:15 INFO  Executing generated plans
2022-09-21 02:25:06 INFO  ---RUNTIME: Execution took 350858.2742214203 ms
2022-09-21 02:25:06 INFO  Done!
2022-09-21 02:25:06 INFO  # Finished -- repetition 5 of 7 
2022-09-21 02:25:06 INFO  # Optimization benchmark for data_corruption with args [['reviews', 'fast_loading', 'featurization_2', 'neural_network']] -- repetition 6 of 7
2022-09-21 02:25:06 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-21 02:25:06 INFO  Running instrumented original pipeline...
2022-09-21 02:25:06 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-21 02:25:06 INFO  ---RUNTIME: Importing and monkey-patching took 6.468772888183594 ms
2022-09-21 02:25:21 INFO  ---RUNTIME: Original pipeline execution took 14622.164249420166 ms (excluding imports and monkey-patching)
2022-09-21 02:25:21 INFO  Starting execution of 1 what-if analyses...
2022-09-21 02:25:21 INFO  Start plan generation for analysis DataCorruption...
2022-09-21 02:25:21 INFO  ---RUNTIME: Plan generation took 0.4258155822753906 ms
2022-09-21 02:25:21 INFO  Estimated runtime of original DAG is 13359.50231552124ms
2022-09-21 02:25:21 INFO  Performing Multi-Query Optimization
2022-09-21 02:25:21 INFO  Estimated unoptimized what-if runtime is 333987.557888031ms
2022-09-21 02:25:21 INFO  Estimated optimised what-if runtime is 65813.29655647278ms
2022-09-21 02:25:21 INFO  Estimated optimisation runtime saving is 268174.2613315582ms
2022-09-21 02:25:21 INFO  ---RUNTIME: Multi-Query Optimization took 65.44828414916992 ms
2022-09-21 02:25:21 INFO  Executing generated plans
2022-09-21 02:26:04 INFO  ---RUNTIME: Execution took 43037.052154541016 ms
2022-09-21 02:26:04 INFO  Done!
2022-09-21 02:26:04 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-21 02:26:04 INFO  Running instrumented original pipeline...
2022-09-21 02:26:04 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-21 02:26:04 INFO  ---RUNTIME: Importing and monkey-patching took 6.413698196411133 ms
2022-09-21 02:26:18 INFO  ---RUNTIME: Original pipeline execution took 13615.625381469727 ms (excluding imports and monkey-patching)
2022-09-21 02:26:18 INFO  Starting execution of 1 what-if analyses...
2022-09-21 02:26:18 INFO  Start plan generation for analysis DataCorruption...
2022-09-21 02:26:18 INFO  ---RUNTIME: Plan generation took 0.48089027404785156 ms
2022-09-21 02:26:18 INFO  Estimated runtime of original DAG is 12315.31834602356ms
2022-09-21 02:26:18 WARNING Skipping Multi-Query Optimization (instead, only combine execution DAGs)
2022-09-21 02:26:18 INFO  Estimated unoptimised what-if runtime is 307882.958650589ms
2022-09-21 02:26:18 INFO  ---RUNTIME: Multi-Query Optimization took 143.57519149780273 ms
2022-09-21 02:26:18 INFO  Executing generated plans
2022-09-21 02:32:05 INFO  ---RUNTIME: Execution took 347580.1749229431 ms
2022-09-21 02:32:05 INFO  Done!
2022-09-21 02:32:05 INFO  # Finished -- repetition 6 of 7 
2022-09-21 02:32:05 INFO  # Optimization benchmark for data_corruption with args [['reviews', 'fast_loading', 'featurization_2', 'neural_network']] -- repetition 7 of 7
2022-09-21 02:32:05 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-21 02:32:05 INFO  Running instrumented original pipeline...
2022-09-21 02:32:05 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-21 02:32:05 INFO  ---RUNTIME: Importing and monkey-patching took 6.309032440185547 ms
2022-09-21 02:32:20 INFO  ---RUNTIME: Original pipeline execution took 14568.968057632446 ms (excluding imports and monkey-patching)
2022-09-21 02:32:20 INFO  Starting execution of 1 what-if analyses...
2022-09-21 02:32:20 INFO  Start plan generation for analysis DataCorruption...
2022-09-21 02:32:20 INFO  ---RUNTIME: Plan generation took 1.6274452209472656 ms
2022-09-21 02:32:20 INFO  Estimated runtime of original DAG is 13285.775899887085ms
2022-09-21 02:32:20 INFO  Performing Multi-Query Optimization
2022-09-21 02:32:20 INFO  Estimated unoptimized what-if runtime is 332144.3974971771ms
2022-09-21 02:32:20 INFO  Estimated optimised what-if runtime is 57816.049098968506ms
2022-09-21 02:32:20 INFO  Estimated optimisation runtime saving is 274328.3483982086ms
2022-09-21 02:32:20 INFO  ---RUNTIME: Multi-Query Optimization took 126.18136405944824 ms
2022-09-21 02:32:20 INFO  Executing generated plans
2022-09-21 02:33:21 INFO  ---RUNTIME: Execution took 61209.975481033325 ms
2022-09-21 02:33:21 INFO  Done!
2022-09-21 02:33:21 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-21 02:33:21 INFO  Running instrumented original pipeline...
2022-09-21 02:33:21 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-21 02:33:21 INFO  ---RUNTIME: Importing and monkey-patching took 6.815671920776367 ms
2022-09-21 02:33:41 INFO  ---RUNTIME: Original pipeline execution took 19205.89590072632 ms (excluding imports and monkey-patching)
2022-09-21 02:33:41 INFO  Starting execution of 1 what-if analyses...
2022-09-21 02:33:41 INFO  Start plan generation for analysis DataCorruption...
2022-09-21 02:33:41 INFO  ---RUNTIME: Plan generation took 0.5755424499511719 ms
2022-09-21 02:33:41 INFO  Estimated runtime of original DAG is 17580.034732818604ms
2022-09-21 02:33:41 WARNING Skipping Multi-Query Optimization (instead, only combine execution DAGs)
2022-09-21 02:33:41 INFO  Estimated unoptimised what-if runtime is 439500.8683204651ms
2022-09-21 02:33:41 INFO  ---RUNTIME: Multi-Query Optimization took 196.8851089477539 ms
2022-09-21 02:33:41 INFO  Executing generated plans
2022-09-21 02:40:25 INFO  ---RUNTIME: Execution took 403851.60994529724 ms
2022-09-21 02:40:25 INFO  Done!
2022-09-21 02:40:25 INFO  # Finished -- repetition 7 of 7 
2022-09-21 02:40:25 INFO  # Final results after all repetitions
2022-09-21 02:40:25 INFO     repetition  ... no_opt_what_if_execution_combined_model_training
0           0  ...                                    151887.954235
1           1  ...                                    150799.246311
2           2  ...                                    152765.423775
3           3  ...                                    151224.480152
4           4  ...                                    151009.562731
5           5  ...                                    152159.846306
6           6  ...                                    164284.538269

[7 rows x 26 columns]
taskset -c 32-40 PROTOCOL_BUFFERS_PYTHON_IMPLEMENTATION=python python3.9 benchmarks_end_to_end.py data_corruption reviews fast_loading featurization_3 logistic_regression
2022-09-21 02:40:28.736718: W tensorflow/stream_executor/platform/default/dso_loader.cc:64] Could not load dynamic library 'libcudart.so.11.0'; dlerror: libcudart.so.11.0: cannot open shared object file: No such file or directory; LD_LIBRARY_PATH: /home/sgrafbe/mlwhatif/venv/lib/python3.9/site-packages/cv2/../../lib64:
2022-09-21 02:40:28.736761: I tensorflow/stream_executor/cuda/cudart_stub.cc:29] Ignore above cudart dlerror if you do not have a GPU set up on your machine.
2022-09-21 02:40:30 INFO  Patching sys.argv with ['mlwhatif', 'reviews', 'fast_loading', 'featurization_3', 'logistic_regression']
2022-09-21 02:40:30 INFO  Running instrumented original pipeline...
2022-09-21 02:40:30 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-21 02:40:30 INFO  ---RUNTIME: Importing and monkey-patching took 122.06506729125977 ms
2022-09-21 02:41:17 INFO  ---RUNTIME: Original pipeline execution took 47730.881214141846 ms (excluding imports and monkey-patching)
2022-09-21 02:41:17 INFO  Starting execution of 0 what-if analyses...
2022-09-21 02:41:17 INFO  Estimated runtime of original DAG is 34963.62495422363ms
2022-09-21 02:41:17 INFO  Performing Multi-Query Optimization
2022-09-21 02:41:17 INFO  Estimated unoptimized what-if runtime is 0ms
2022-09-21 02:41:17 INFO  Estimated optimised what-if runtime is 0ms
2022-09-21 02:41:17 INFO  Estimated optimisation runtime saving is 0ms
2022-09-21 02:41:17 INFO  ---RUNTIME: Multi-Query Optimization took 0.5826950073242188 ms
2022-09-21 02:41:17 INFO  Executing generated plans
2022-09-21 02:41:17 INFO  ---RUNTIME: Execution took 0.02384185791015625 ms
2022-09-21 02:41:17 INFO  Done!
2022-09-21 02:41:17 INFO  # Optimization benchmark for data_corruption with args [['reviews', 'fast_loading', 'featurization_3', 'logistic_regression']] -- repetition 1 of 7
2022-09-21 02:41:17 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-21 02:41:17 INFO  Running instrumented original pipeline...
2022-09-21 02:41:18 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-21 02:41:18 INFO  ---RUNTIME: Importing and monkey-patching took 5.843400955200195 ms
2022-09-21 02:42:06 INFO  ---RUNTIME: Original pipeline execution took 48580.72781562805 ms (excluding imports and monkey-patching)
2022-09-21 02:42:06 INFO  Starting execution of 1 what-if analyses...
2022-09-21 02:42:06 INFO  Start plan generation for analysis DataCorruption...
2022-09-21 02:42:06 INFO  ---RUNTIME: Plan generation took 0.4467964172363281 ms
2022-09-21 02:42:06 INFO  Estimated runtime of original DAG is 34905.667304992676ms
2022-09-21 02:42:06 INFO  Performing Multi-Query Optimization
2022-09-21 02:42:06 INFO  Estimated unoptimized what-if runtime is 872641.6826248169ms
2022-09-21 02:42:06 INFO  Estimated optimised what-if runtime is 119554.88967895508ms
2022-09-21 02:42:06 INFO  Estimated optimisation runtime saving is 753086.7929458618ms
2022-09-21 02:42:06 INFO  ---RUNTIME: Multi-Query Optimization took 77.5139331817627 ms
2022-09-21 02:42:06 INFO  Executing generated plans
Traceback (most recent call last):
  File "/home/sgrafbe/mlwhatif/experiments/end_to_end/benchmarks_end_to_end.py", line 228, in <module>
    analysis_result_opt = PipelineAnalyzer \
  File "/home/sgrafbe/mlwhatif/mlwhatif/_pipeline_analyzer.py", line 93, in execute
    return singleton.run(notebook_path=self._notebook_path,
  File "/home/sgrafbe/mlwhatif/mlwhatif/execution/_pipeline_executor.py", line 145, in run
    self.run_what_if_analyses()
  File "/home/sgrafbe/mlwhatif/mlwhatif/execution/_pipeline_executor.py", line 173, in run_what_if_analyses
    DagExecutor(self).execute(self.analysis_results.combined_optimized_dag)
  File "/home/sgrafbe/mlwhatif/mlwhatif/execution/_dag_executor.py", line 45, in execute
    self.traverse_graph_and_process_nodes(dag, execute_node)
  File "/home/sgrafbe/mlwhatif/mlwhatif/execution/_dag_executor.py", line 57, in traverse_graph_and_process_nodes
    result_node = func(node)
  File "/home/sgrafbe/mlwhatif/mlwhatif/execution/_dag_executor.py", line 40, in execute_node
    optimizer_info, result_df = capture_optimizer_info(executable_processing_func)
  File "/home/sgrafbe/mlwhatif/mlwhatif/execution/_stat_tracking.py", line 28, in capture_optimizer_info
    result = instrumented_function_call()
  File "/home/sgrafbe/mlwhatif/mlwhatif/monkeypatching/_patch_sklearn.py", line 1729, in processing_func
    transformed_data = wrap_in_mlinspect_array_if_necessary(transformed_data)
  File "/home/sgrafbe/mlwhatif/mlwhatif/monkeypatching/_monkey_patching_utils.py", line 229, in wrap_in_mlinspect_array_if_necessary
    df_object = MlinspectNdarray(df_object)
  File "/home/sgrafbe/mlwhatif/mlwhatif/monkeypatching/_mlinspect_ndarray.py", line 16, in __new__
    obj = numpy.asarray(input_array).view(cls)
  File "/home/sgrafbe/mlwhatif/venv/lib64/python3.9/site-packages/numpy/core/_asarray.py", line 83, in asarray
    return array(a, dtype, copy=False, order=order)
numpy.core._exceptions.MemoryError: Unable to allocate 3.71 GiB for an array with shape (35312,) and data type <U28219
taskset -c 32-40 PROTOCOL_BUFFERS_PYTHON_IMPLEMENTATION=python python3.9 benchmarks_end_to_end.py data_corruption reviews fast_loading featurization_3 xgboost
2022-09-21 02:42:44.680150: W tensorflow/stream_executor/platform/default/dso_loader.cc:64] Could not load dynamic library 'libcudart.so.11.0'; dlerror: libcudart.so.11.0: cannot open shared object file: No such file or directory; LD_LIBRARY_PATH: /home/sgrafbe/mlwhatif/venv/lib/python3.9/site-packages/cv2/../../lib64:
2022-09-21 02:42:44.680188: I tensorflow/stream_executor/cuda/cudart_stub.cc:29] Ignore above cudart dlerror if you do not have a GPU set up on your machine.
2022-09-21 02:42:46 INFO  Patching sys.argv with ['mlwhatif', 'reviews', 'fast_loading', 'featurization_3', 'xgboost']
2022-09-21 02:42:46 INFO  Running instrumented original pipeline...
2022-09-21 02:42:47 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-21 02:42:47 INFO  ---RUNTIME: Importing and monkey-patching took 203.7951946258545 ms
Traceback (most recent call last):
  File "/home/sgrafbe/mlwhatif/experiments/end_to_end/benchmarks_end_to_end.py", line 185, in <module>
    _ = PipelineAnalyzer \
  File "/home/sgrafbe/mlwhatif/mlwhatif/_pipeline_analyzer.py", line 93, in execute
    return singleton.run(notebook_path=self._notebook_path,
  File "/home/sgrafbe/mlwhatif/mlwhatif/execution/_pipeline_executor.py", line 110, in run
    self.run_instrumented_pipeline(notebook_path, python_code, python_path)
  File "/home/sgrafbe/mlwhatif/mlwhatif/execution/_pipeline_executor.py", line 197, in run_instrumented_pipeline
    exec(compile(parsed_modified_ast, filename=self.source_code_path, mode="exec"), self.script_scope)
  File "/home/sgrafbe/mlwhatif/experiments/end_to_end/run_pipeline.py", line 450, in <module>
    pipeline = pipeline.fit(train, train_labels)
  File "/home/sgrafbe/mlwhatif/venv/lib64/python3.9/site-packages/sklearn/pipeline.py", line 330, in fit
    Xt = self._fit(X, y, **fit_params_steps)
  File "/home/sgrafbe/mlwhatif/venv/lib64/python3.9/site-packages/sklearn/pipeline.py", line 292, in _fit
    X, fitted_transformer = fit_transform_one_cached(
  File "/home/sgrafbe/mlwhatif/venv/lib64/python3.9/site-packages/joblib/memory.py", line 349, in __call__
    return self.func(*args, **kwargs)
  File "/home/sgrafbe/mlwhatif/venv/lib64/python3.9/site-packages/sklearn/pipeline.py", line 740, in _fit_transform_one
    res = transformer.fit_transform(X, y, **fit_params)
  File "/home/sgrafbe/mlwhatif/mlwhatif/monkeypatching/_patch_sklearn.py", line 304, in patched_fit_transform
    result = original(self, *args, **kwargs)
  File "/home/sgrafbe/mlwhatif/venv/lib64/python3.9/site-packages/sklearn/compose/_column_transformer.py", line 531, in fit_transform
    result = self._fit_transform(X, y, _fit_transform_one)
  File "/home/sgrafbe/mlwhatif/venv/lib64/python3.9/site-packages/sklearn/compose/_column_transformer.py", line 458, in _fit_transform
    return Parallel(n_jobs=self.n_jobs)(
  File "/home/sgrafbe/mlwhatif/venv/lib64/python3.9/site-packages/joblib/parallel.py", line 1046, in __call__
    while self.dispatch_one_batch(iterator):
  File "/home/sgrafbe/mlwhatif/venv/lib64/python3.9/site-packages/joblib/parallel.py", line 861, in dispatch_one_batch
    self._dispatch(tasks)
  File "/home/sgrafbe/mlwhatif/venv/lib64/python3.9/site-packages/joblib/parallel.py", line 779, in _dispatch
    job = self._backend.apply_async(batch, callback=cb)
  File "/home/sgrafbe/mlwhatif/venv/lib64/python3.9/site-packages/joblib/_parallel_backends.py", line 208, in apply_async
    result = ImmediateResult(func)
  File "/home/sgrafbe/mlwhatif/venv/lib64/python3.9/site-packages/joblib/_parallel_backends.py", line 572, in __init__
    self.results = batch()
  File "/home/sgrafbe/mlwhatif/venv/lib64/python3.9/site-packages/joblib/parallel.py", line 262, in __call__
    return [func(*args, **kwargs)
  File "/home/sgrafbe/mlwhatif/venv/lib64/python3.9/site-packages/joblib/parallel.py", line 262, in <listcomp>
    return [func(*args, **kwargs)
  File "/home/sgrafbe/mlwhatif/venv/lib64/python3.9/site-packages/sklearn/pipeline.py", line 740, in _fit_transform_one
    res = transformer.fit_transform(X, y, **fit_params)
  File "/home/sgrafbe/mlwhatif/venv/lib64/python3.9/site-packages/sklearn/pipeline.py", line 367, in fit_transform
    Xt = self._fit(X, y, **fit_params_steps)
  File "/home/sgrafbe/mlwhatif/venv/lib64/python3.9/site-packages/sklearn/pipeline.py", line 292, in _fit
    X, fitted_transformer = fit_transform_one_cached(
  File "/home/sgrafbe/mlwhatif/venv/lib64/python3.9/site-packages/joblib/memory.py", line 349, in __call__
    return self.func(*args, **kwargs)
  File "/home/sgrafbe/mlwhatif/venv/lib64/python3.9/site-packages/sklearn/pipeline.py", line 740, in _fit_transform_one
    res = transformer.fit_transform(X, y, **fit_params)
  File "/home/sgrafbe/mlwhatif/mlwhatif/monkeypatching/_patch_sklearn.py", line 1751, in patched_fit_transform
    add_dag_node(dag_node, [input_info.dag_node], function_call_result)
  File "/home/sgrafbe/mlwhatif/mlwhatif/monkeypatching/_monkey_patching_utils.py", line 255, in add_dag_node
    function_call_result.function_result = wrap_in_mlinspect_array_if_necessary(
  File "/home/sgrafbe/mlwhatif/mlwhatif/monkeypatching/_monkey_patching_utils.py", line 229, in wrap_in_mlinspect_array_if_necessary
    df_object = MlinspectNdarray(df_object)
  File "/home/sgrafbe/mlwhatif/mlwhatif/monkeypatching/_mlinspect_ndarray.py", line 16, in __new__
    obj = numpy.asarray(input_array).view(cls)
  File "/home/sgrafbe/mlwhatif/venv/lib64/python3.9/site-packages/numpy/core/_asarray.py", line 83, in asarray
    return array(a, dtype, copy=False, order=order)
numpy.core._exceptions.MemoryError: Unable to allocate 3.71 GiB for an array with shape (35312,) and data type <U28219
taskset -c 32-40 PROTOCOL_BUFFERS_PYTHON_IMPLEMENTATION=python python3.9 benchmarks_end_to_end.py data_corruption reviews fast_loading featurization_3 neural_network
2022-09-21 02:43:12.611773: W tensorflow/stream_executor/platform/default/dso_loader.cc:64] Could not load dynamic library 'libcudart.so.11.0'; dlerror: libcudart.so.11.0: cannot open shared object file: No such file or directory; LD_LIBRARY_PATH: /home/sgrafbe/mlwhatif/venv/lib/python3.9/site-packages/cv2/../../lib64:
2022-09-21 02:43:12.611817: I tensorflow/stream_executor/cuda/cudart_stub.cc:29] Ignore above cudart dlerror if you do not have a GPU set up on your machine.
2022-09-21 02:43:13 INFO  Patching sys.argv with ['mlwhatif', 'reviews', 'fast_loading', 'featurization_3', 'neural_network']
2022-09-21 02:43:13 INFO  Running instrumented original pipeline...
2022-09-21 02:43:13 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-21 02:43:14 INFO  ---RUNTIME: Importing and monkey-patching took 122.61462211608887 ms
2022-09-21 02:43:35.889759: W tensorflow/stream_executor/platform/default/dso_loader.cc:64] Could not load dynamic library 'libcuda.so.1'; dlerror: libcuda.so.1: cannot open shared object file: No such file or directory; LD_LIBRARY_PATH: /home/sgrafbe/mlwhatif/venv/lib/python3.9/site-packages/cv2/../../lib64:
2022-09-21 02:43:35.889796: W tensorflow/stream_executor/cuda/cuda_driver.cc:326] failed call to cuInit: UNKNOWN ERROR (303)
2022-09-21 02:43:35.889820: I tensorflow/stream_executor/cuda/cuda_diagnostics.cc:156] kernel driver does not appear to be running on this host (angus): /proc/driver/nvidia/version does not exist
2022-09-21 02:43:35.890344: I tensorflow/core/platform/cpu_feature_guard.cc:142] This TensorFlow binary is optimized with oneAPI Deep Neural Network Library (oneDNN) to use the following CPU instructions in performance-critical operations:  AVX2 FMA
To enable them in other operations, rebuild TensorFlow with the appropriate compiler flags.
2022-09-21 02:43:36.517371: I tensorflow/compiler/mlir/mlir_graph_optimization_pass.cc:176] None of the MLIR Optimization Passes are enabled (registered 2)
2022-09-21 02:43:36.531176: I tensorflow/core/platform/profile_utils/cpu_utils.cc:114] CPU Frequency: 2595130000 Hz
2022-09-21 02:44:00 INFO  ---RUNTIME: Original pipeline execution took 46454.39434051514 ms (excluding imports and monkey-patching)
2022-09-21 02:44:00 INFO  Starting execution of 0 what-if analyses...
2022-09-21 02:44:00 INFO  Estimated runtime of original DAG is 39176.10764503479ms
2022-09-21 02:44:00 INFO  Performing Multi-Query Optimization
2022-09-21 02:44:00 INFO  Estimated unoptimized what-if runtime is 0ms
2022-09-21 02:44:00 INFO  Estimated optimised what-if runtime is 0ms
2022-09-21 02:44:00 INFO  Estimated optimisation runtime saving is 0ms
2022-09-21 02:44:00 INFO  ---RUNTIME: Multi-Query Optimization took 0.5686283111572266 ms
2022-09-21 02:44:00 INFO  Executing generated plans
2022-09-21 02:44:00 INFO  ---RUNTIME: Execution took 0.023603439331054688 ms
2022-09-21 02:44:00 INFO  Done!
2022-09-21 02:44:00 INFO  # Optimization benchmark for data_corruption with args [['reviews', 'fast_loading', 'featurization_3', 'neural_network']] -- repetition 1 of 7
2022-09-21 02:44:00 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-21 02:44:00 INFO  Running instrumented original pipeline...
2022-09-21 02:44:00 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-21 02:44:00 INFO  ---RUNTIME: Importing and monkey-patching took 5.393028259277344 ms
2022-09-21 02:44:51 INFO  ---RUNTIME: Original pipeline execution took 50906.57925605774 ms (excluding imports and monkey-patching)
2022-09-21 02:44:51 INFO  Starting execution of 1 what-if analyses...
2022-09-21 02:44:51 INFO  Start plan generation for analysis DataCorruption...
2022-09-21 02:44:51 INFO  ---RUNTIME: Plan generation took 0.4200935363769531 ms
2022-09-21 02:44:51 INFO  Estimated runtime of original DAG is 40761.799335479736ms
2022-09-21 02:44:51 INFO  Performing Multi-Query Optimization
2022-09-21 02:44:51 INFO  Estimated unoptimized what-if runtime is 1019044.9833869934ms
2022-09-21 02:44:51 INFO  Estimated optimised what-if runtime is 142953.44066619873ms
2022-09-21 02:44:51 INFO  Estimated optimisation runtime saving is 876091.5427207947ms
2022-09-21 02:44:51 INFO  ---RUNTIME: Multi-Query Optimization took 78.47881317138672 ms
2022-09-21 02:44:51 INFO  Executing generated plans
2022-09-21 02:46:16 INFO  ---RUNTIME: Execution took 84523.99277687073 ms
2022-09-21 02:46:16 INFO  Done!
2022-09-21 02:46:16 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-21 02:46:16 INFO  Running instrumented original pipeline...
2022-09-21 02:46:16 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-21 02:46:16 INFO  ---RUNTIME: Importing and monkey-patching took 6.295442581176758 ms
2022-09-21 02:47:14 INFO  ---RUNTIME: Original pipeline execution took 58012.665033340454 ms (excluding imports and monkey-patching)
2022-09-21 02:47:14 INFO  Starting execution of 1 what-if analyses...
2022-09-21 02:47:14 INFO  Start plan generation for analysis DataCorruption...
2022-09-21 02:47:14 INFO  ---RUNTIME: Plan generation took 0.5280971527099609 ms
2022-09-21 02:47:14 INFO  Estimated runtime of original DAG is 43426.56707763672ms
2022-09-21 02:47:14 WARNING Skipping Multi-Query Optimization (instead, only combine execution DAGs)
2022-09-21 02:47:14 INFO  Estimated unoptimised what-if runtime is 1085664.176940918ms
2022-09-21 02:47:14 INFO  ---RUNTIME: Multi-Query Optimization took 176.25904083251953 ms
2022-09-21 02:47:14 INFO  Executing generated plans
./run-benchmarks--end-to-end.sh: line 43: 1458458 Killed                  PROTOCOL_BUFFERS_PYTHON_IMPLEMENTATION=python taskset -c "$core_num" python3.9 benchmarks_end_to_end.py "$scenario" "$dataset" "$data_loading" "$featurization" "$model"
taskset -c 32-40 PROTOCOL_BUFFERS_PYTHON_IMPLEMENTATION=python python3.9 benchmarks_end_to_end.py data_corruption reviews fast_loading featurization_4 logistic_regression
2022-09-21 02:49:38.273352: W tensorflow/stream_executor/platform/default/dso_loader.cc:64] Could not load dynamic library 'libcudart.so.11.0'; dlerror: libcudart.so.11.0: cannot open shared object file: No such file or directory; LD_LIBRARY_PATH: /home/sgrafbe/mlwhatif/venv/lib/python3.9/site-packages/cv2/../../lib64:
2022-09-21 02:49:38.273387: I tensorflow/stream_executor/cuda/cudart_stub.cc:29] Ignore above cudart dlerror if you do not have a GPU set up on your machine.
2022-09-21 02:49:40 INFO  Patching sys.argv with ['mlwhatif', 'reviews', 'fast_loading', 'featurization_4', 'logistic_regression']
2022-09-21 02:49:40 INFO  Running instrumented original pipeline...
2022-09-21 02:49:40 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-21 02:49:40 INFO  ---RUNTIME: Importing and monkey-patching took 249.21226501464844 ms
2022-09-21 02:49:54 INFO  ---RUNTIME: Original pipeline execution took 13077.807903289795 ms (excluding imports and monkey-patching)
2022-09-21 02:49:54 INFO  Starting execution of 0 what-if analyses...
2022-09-21 02:49:54 INFO  Estimated runtime of original DAG is 9583.111763000488ms
2022-09-21 02:49:54 INFO  Performing Multi-Query Optimization
2022-09-21 02:49:54 INFO  Estimated unoptimized what-if runtime is 0ms
2022-09-21 02:49:54 INFO  Estimated optimised what-if runtime is 0ms
2022-09-21 02:49:54 INFO  Estimated optimisation runtime saving is 0ms
2022-09-21 02:49:54 INFO  ---RUNTIME: Multi-Query Optimization took 0.5359649658203125 ms
2022-09-21 02:49:54 INFO  Executing generated plans
2022-09-21 02:49:54 INFO  ---RUNTIME: Execution took 0.02384185791015625 ms
2022-09-21 02:49:54 INFO  Done!
2022-09-21 02:49:54 INFO  # Optimization benchmark for data_corruption with args [['reviews', 'fast_loading', 'featurization_4', 'logistic_regression']] -- repetition 1 of 7
2022-09-21 02:49:54 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-21 02:49:54 INFO  Running instrumented original pipeline...
2022-09-21 02:49:54 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-21 02:49:54 INFO  ---RUNTIME: Importing and monkey-patching took 5.588293075561523 ms
2022-09-21 02:50:07 INFO  ---RUNTIME: Original pipeline execution took 13634.059190750122 ms (excluding imports and monkey-patching)
2022-09-21 02:50:07 INFO  Starting execution of 1 what-if analyses...
2022-09-21 02:50:07 INFO  Start plan generation for analysis DataCorruption...
2022-09-21 02:50:07 INFO  ---RUNTIME: Plan generation took 0.47898292541503906 ms
2022-09-21 02:50:07 INFO  Estimated runtime of original DAG is 10033.31470489502ms
2022-09-21 02:50:07 INFO  Performing Multi-Query Optimization
2022-09-21 02:50:07 INFO  Estimated unoptimized what-if runtime is 250832.8676223755ms
2022-09-21 02:50:07 INFO  Estimated optimised what-if runtime is 11493.68953704834ms
2022-09-21 02:50:07 INFO  Estimated optimisation runtime saving is 239339.17808532715ms
2022-09-21 02:50:07 INFO  ---RUNTIME: Multi-Query Optimization took 69.44608688354492 ms
2022-09-21 02:50:07 INFO  Executing generated plans
2022-09-21 02:50:24 INFO  ---RUNTIME: Execution took 16455.873489379883 ms
2022-09-21 02:50:24 INFO  Done!
2022-09-21 02:50:24 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-21 02:50:24 INFO  Running instrumented original pipeline...
2022-09-21 02:50:24 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-21 02:50:24 INFO  ---RUNTIME: Importing and monkey-patching took 5.92803955078125 ms
2022-09-21 02:50:37 INFO  ---RUNTIME: Original pipeline execution took 13101.499557495117 ms (excluding imports and monkey-patching)
2022-09-21 02:50:37 INFO  Starting execution of 1 what-if analyses...
2022-09-21 02:50:37 INFO  Start plan generation for analysis DataCorruption...
2022-09-21 02:50:37 INFO  ---RUNTIME: Plan generation took 0.44417381286621094 ms
2022-09-21 02:50:37 INFO  Estimated runtime of original DAG is 9477.405786514282ms
2022-09-21 02:50:37 WARNING Skipping Multi-Query Optimization (instead, only combine execution DAGs)
2022-09-21 02:50:37 INFO  Estimated unoptimised what-if runtime is 236935.14466285706ms
2022-09-21 02:50:37 INFO  ---RUNTIME: Multi-Query Optimization took 150.6521701812744 ms
2022-09-21 02:50:37 INFO  Executing generated plans
2022-09-21 02:55:03 INFO  ---RUNTIME: Execution took 266311.4719390869 ms
2022-09-21 02:55:03 INFO  Done!
2022-09-21 02:55:03 INFO  # Finished -- repetition 1 of 7 
2022-09-21 02:55:03 INFO  # Optimization benchmark for data_corruption with args [['reviews', 'fast_loading', 'featurization_4', 'logistic_regression']] -- repetition 2 of 7
2022-09-21 02:55:03 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-21 02:55:03 INFO  Running instrumented original pipeline...
2022-09-21 02:55:03 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-21 02:55:03 INFO  ---RUNTIME: Importing and monkey-patching took 5.760431289672852 ms
2022-09-21 02:55:16 INFO  ---RUNTIME: Original pipeline execution took 12601.617097854614 ms (excluding imports and monkey-patching)
2022-09-21 02:55:16 INFO  Starting execution of 1 what-if analyses...
2022-09-21 02:55:16 INFO  Start plan generation for analysis DataCorruption...
2022-09-21 02:55:16 INFO  ---RUNTIME: Plan generation took 0.4963874816894531 ms
2022-09-21 02:55:16 INFO  Estimated runtime of original DAG is 9263.019323348999ms
2022-09-21 02:55:16 INFO  Performing Multi-Query Optimization
2022-09-21 02:55:16 INFO  Estimated unoptimized what-if runtime is 231575.48308372498ms
2022-09-21 02:55:16 INFO  Estimated optimised what-if runtime is 10309.94987487793ms
2022-09-21 02:55:16 INFO  Estimated optimisation runtime saving is 221265.53320884705ms
2022-09-21 02:55:16 INFO  ---RUNTIME: Multi-Query Optimization took 69.0605640411377 ms
2022-09-21 02:55:16 INFO  Executing generated plans
2022-09-21 02:55:31 INFO  ---RUNTIME: Execution took 15321.198225021362 ms
2022-09-21 02:55:31 INFO  Done!
2022-09-21 02:55:31 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-21 02:55:31 INFO  Running instrumented original pipeline...
2022-09-21 02:55:31 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-21 02:55:31 INFO  ---RUNTIME: Importing and monkey-patching took 5.770683288574219 ms
2022-09-21 02:55:44 INFO  ---RUNTIME: Original pipeline execution took 12931.946277618408 ms (excluding imports and monkey-patching)
2022-09-21 02:55:44 INFO  Starting execution of 1 what-if analyses...
2022-09-21 02:55:44 INFO  Start plan generation for analysis DataCorruption...
2022-09-21 02:55:44 INFO  ---RUNTIME: Plan generation took 0.4391670227050781 ms
2022-09-21 02:55:44 INFO  Estimated runtime of original DAG is 9306.87665939331ms
2022-09-21 02:55:44 WARNING Skipping Multi-Query Optimization (instead, only combine execution DAGs)
2022-09-21 02:55:44 INFO  Estimated unoptimised what-if runtime is 232671.91648483276ms
2022-09-21 02:55:44 INFO  ---RUNTIME: Multi-Query Optimization took 151.3347625732422 ms
2022-09-21 02:55:44 INFO  Executing generated plans
2022-09-21 03:00:12 INFO  ---RUNTIME: Execution took 267624.10736083984 ms
2022-09-21 03:00:12 INFO  Done!
2022-09-21 03:00:12 INFO  # Finished -- repetition 2 of 7 
2022-09-21 03:00:12 INFO  # Optimization benchmark for data_corruption with args [['reviews', 'fast_loading', 'featurization_4', 'logistic_regression']] -- repetition 3 of 7
2022-09-21 03:00:12 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-21 03:00:12 INFO  Running instrumented original pipeline...
2022-09-21 03:00:12 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-21 03:00:12 INFO  ---RUNTIME: Importing and monkey-patching took 6.566047668457031 ms
2022-09-21 03:00:25 INFO  ---RUNTIME: Original pipeline execution took 12915.869235992432 ms (excluding imports and monkey-patching)
2022-09-21 03:00:25 INFO  Starting execution of 1 what-if analyses...
2022-09-21 03:00:25 INFO  Start plan generation for analysis DataCorruption...
2022-09-21 03:00:25 INFO  ---RUNTIME: Plan generation took 0.4470348358154297 ms
2022-09-21 03:00:25 INFO  Estimated runtime of original DAG is 9269.651174545288ms
2022-09-21 03:00:25 INFO  Performing Multi-Query Optimization
2022-09-21 03:00:25 INFO  Estimated unoptimized what-if runtime is 231741.2793636322ms
2022-09-21 03:00:25 INFO  Estimated optimised what-if runtime is 10347.677230834961ms
2022-09-21 03:00:25 INFO  Estimated optimisation runtime saving is 221393.60213279724ms
2022-09-21 03:00:25 INFO  ---RUNTIME: Multi-Query Optimization took 68.55297088623047 ms
2022-09-21 03:00:25 INFO  Executing generated plans
2022-09-21 03:00:40 INFO  ---RUNTIME: Execution took 15393.547534942627 ms
2022-09-21 03:00:40 INFO  Done!
2022-09-21 03:00:40 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-21 03:00:40 INFO  Running instrumented original pipeline...
2022-09-21 03:00:40 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-21 03:00:40 INFO  ---RUNTIME: Importing and monkey-patching took 5.760908126831055 ms
2022-09-21 03:00:53 INFO  ---RUNTIME: Original pipeline execution took 12888.373613357544 ms (excluding imports and monkey-patching)
2022-09-21 03:00:53 INFO  Starting execution of 1 what-if analyses...
2022-09-21 03:00:53 INFO  Start plan generation for analysis DataCorruption...
2022-09-21 03:00:53 INFO  ---RUNTIME: Plan generation took 0.47087669372558594 ms
2022-09-21 03:00:53 INFO  Estimated runtime of original DAG is 9261.587858200073ms
2022-09-21 03:00:53 WARNING Skipping Multi-Query Optimization (instead, only combine execution DAGs)
2022-09-21 03:00:53 INFO  Estimated unoptimised what-if runtime is 231539.69645500183ms
2022-09-21 03:00:53 INFO  ---RUNTIME: Multi-Query Optimization took 152.8494358062744 ms
2022-09-21 03:00:53 INFO  Executing generated plans
2022-09-21 03:05:28 INFO  ---RUNTIME: Execution took 274213.58847618103 ms
2022-09-21 03:05:28 INFO  Done!
2022-09-21 03:05:28 INFO  # Finished -- repetition 3 of 7 
2022-09-21 03:05:28 INFO  # Optimization benchmark for data_corruption with args [['reviews', 'fast_loading', 'featurization_4', 'logistic_regression']] -- repetition 4 of 7
2022-09-21 03:05:28 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-21 03:05:28 INFO  Running instrumented original pipeline...
2022-09-21 03:05:28 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-21 03:05:28 INFO  ---RUNTIME: Importing and monkey-patching took 6.391763687133789 ms
2022-09-21 03:05:41 INFO  ---RUNTIME: Original pipeline execution took 12895.401239395142 ms (excluding imports and monkey-patching)
2022-09-21 03:05:41 INFO  Starting execution of 1 what-if analyses...
2022-09-21 03:05:41 INFO  Start plan generation for analysis DataCorruption...
2022-09-21 03:05:41 INFO  ---RUNTIME: Plan generation took 0.4200935363769531 ms
2022-09-21 03:05:41 INFO  Estimated runtime of original DAG is 9524.473905563354ms
2022-09-21 03:05:41 INFO  Performing Multi-Query Optimization
2022-09-21 03:05:41 INFO  Estimated unoptimized what-if runtime is 238111.84763908386ms
2022-09-21 03:05:41 INFO  Estimated optimised what-if runtime is 10648.550987243652ms
2022-09-21 03:05:41 INFO  Estimated optimisation runtime saving is 227463.2966518402ms
2022-09-21 03:05:41 INFO  ---RUNTIME: Multi-Query Optimization took 68.359375 ms
2022-09-21 03:05:41 INFO  Executing generated plans
2022-09-21 03:05:56 INFO  ---RUNTIME: Execution took 15432.366371154785 ms
2022-09-21 03:05:56 INFO  Done!
2022-09-21 03:05:56 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-21 03:05:56 INFO  Running instrumented original pipeline...
2022-09-21 03:05:56 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-21 03:05:56 INFO  ---RUNTIME: Importing and monkey-patching took 5.746364593505859 ms
2022-09-21 03:06:09 INFO  ---RUNTIME: Original pipeline execution took 12955.761432647705 ms (excluding imports and monkey-patching)
2022-09-21 03:06:09 INFO  Starting execution of 1 what-if analyses...
2022-09-21 03:06:09 INFO  Start plan generation for analysis DataCorruption...
2022-09-21 03:06:09 INFO  ---RUNTIME: Plan generation took 0.44989585876464844 ms
2022-09-21 03:06:09 INFO  Estimated runtime of original DAG is 9306.543827056885ms
2022-09-21 03:06:09 WARNING Skipping Multi-Query Optimization (instead, only combine execution DAGs)
2022-09-21 03:06:09 INFO  Estimated unoptimised what-if runtime is 232663.59567642212ms
2022-09-21 03:06:09 INFO  ---RUNTIME: Multi-Query Optimization took 154.0694236755371 ms
2022-09-21 03:06:09 INFO  Executing generated plans
2022-09-21 03:10:42 INFO  ---RUNTIME: Execution took 273241.66655540466 ms
2022-09-21 03:10:42 INFO  Done!
2022-09-21 03:10:43 INFO  # Finished -- repetition 4 of 7 
2022-09-21 03:10:43 INFO  # Optimization benchmark for data_corruption with args [['reviews', 'fast_loading', 'featurization_4', 'logistic_regression']] -- repetition 5 of 7
2022-09-21 03:10:43 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-21 03:10:43 INFO  Running instrumented original pipeline...
2022-09-21 03:10:43 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-21 03:10:43 INFO  ---RUNTIME: Importing and monkey-patching took 5.797624588012695 ms
2022-09-21 03:10:55 INFO  ---RUNTIME: Original pipeline execution took 12927.916526794434 ms (excluding imports and monkey-patching)
2022-09-21 03:10:55 INFO  Starting execution of 1 what-if analyses...
2022-09-21 03:10:55 INFO  Start plan generation for analysis DataCorruption...
2022-09-21 03:10:55 INFO  ---RUNTIME: Plan generation took 0.4062652587890625 ms
2022-09-21 03:10:55 INFO  Estimated runtime of original DAG is 9270.330429077148ms
2022-09-21 03:10:55 INFO  Performing Multi-Query Optimization
2022-09-21 03:10:56 INFO  Estimated unoptimized what-if runtime is 231758.2607269287ms
2022-09-21 03:10:56 INFO  Estimated optimised what-if runtime is 10396.410465240479ms
2022-09-21 03:10:56 INFO  Estimated optimisation runtime saving is 221361.85026168823ms
2022-09-21 03:10:56 INFO  ---RUNTIME: Multi-Query Optimization took 68.38774681091309 ms
2022-09-21 03:10:56 INFO  Executing generated plans
2022-09-21 03:11:11 INFO  ---RUNTIME: Execution took 15367.2456741333 ms
2022-09-21 03:11:11 INFO  Done!
2022-09-21 03:11:11 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-21 03:11:11 INFO  Running instrumented original pipeline...
2022-09-21 03:11:11 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-21 03:11:11 INFO  ---RUNTIME: Importing and monkey-patching took 6.062030792236328 ms
2022-09-21 03:11:24 INFO  ---RUNTIME: Original pipeline execution took 12995.960712432861 ms (excluding imports and monkey-patching)
2022-09-21 03:11:24 INFO  Starting execution of 1 what-if analyses...
2022-09-21 03:11:24 INFO  Start plan generation for analysis DataCorruption...
2022-09-21 03:11:24 INFO  ---RUNTIME: Plan generation took 0.3998279571533203 ms
2022-09-21 03:11:24 INFO  Estimated runtime of original DAG is 9621.922254562378ms
2022-09-21 03:11:24 WARNING Skipping Multi-Query Optimization (instead, only combine execution DAGs)
2022-09-21 03:11:24 INFO  Estimated unoptimised what-if runtime is 240548.05636405945ms
2022-09-21 03:11:24 INFO  ---RUNTIME: Multi-Query Optimization took 152.46057510375977 ms
2022-09-21 03:11:24 INFO  Executing generated plans
2022-09-21 03:15:52 INFO  ---RUNTIME: Execution took 268127.79355049133 ms
2022-09-21 03:15:52 INFO  Done!
2022-09-21 03:15:52 INFO  # Finished -- repetition 5 of 7 
2022-09-21 03:15:52 INFO  # Optimization benchmark for data_corruption with args [['reviews', 'fast_loading', 'featurization_4', 'logistic_regression']] -- repetition 6 of 7
2022-09-21 03:15:52 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-21 03:15:52 INFO  Running instrumented original pipeline...
2022-09-21 03:15:52 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-21 03:15:52 INFO  ---RUNTIME: Importing and monkey-patching took 6.158113479614258 ms
2022-09-21 03:16:05 INFO  ---RUNTIME: Original pipeline execution took 12656.409978866577 ms (excluding imports and monkey-patching)
2022-09-21 03:16:05 INFO  Starting execution of 1 what-if analyses...
2022-09-21 03:16:05 INFO  Start plan generation for analysis DataCorruption...
2022-09-21 03:16:05 INFO  ---RUNTIME: Plan generation took 0.47659873962402344 ms
2022-09-21 03:16:05 INFO  Estimated runtime of original DAG is 9304.096221923828ms
2022-09-21 03:16:05 INFO  Performing Multi-Query Optimization
2022-09-21 03:16:05 INFO  Estimated unoptimized what-if runtime is 232602.4055480957ms
2022-09-21 03:16:05 INFO  Estimated optimised what-if runtime is 10432.796716690063ms
2022-09-21 03:16:05 INFO  Estimated optimisation runtime saving is 222169.60883140564ms
2022-09-21 03:16:05 INFO  ---RUNTIME: Multi-Query Optimization took 69.38505172729492 ms
2022-09-21 03:16:05 INFO  Executing generated plans
2022-09-21 03:16:20 INFO  ---RUNTIME: Execution took 15388.79418373108 ms
2022-09-21 03:16:20 INFO  Done!
2022-09-21 03:16:20 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-21 03:16:20 INFO  Running instrumented original pipeline...
2022-09-21 03:16:20 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-21 03:16:20 INFO  ---RUNTIME: Importing and monkey-patching took 5.671501159667969 ms
2022-09-21 03:16:33 INFO  ---RUNTIME: Original pipeline execution took 12593.228101730347 ms (excluding imports and monkey-patching)
2022-09-21 03:16:33 INFO  Starting execution of 1 what-if analyses...
2022-09-21 03:16:33 INFO  Start plan generation for analysis DataCorruption...
2022-09-21 03:16:33 INFO  ---RUNTIME: Plan generation took 0.41031837463378906 ms
2022-09-21 03:16:33 INFO  Estimated runtime of original DAG is 9269.601345062256ms
2022-09-21 03:16:33 WARNING Skipping Multi-Query Optimization (instead, only combine execution DAGs)
2022-09-21 03:16:33 INFO  Estimated unoptimised what-if runtime is 231740.0336265564ms
2022-09-21 03:16:33 INFO  ---RUNTIME: Multi-Query Optimization took 444.75603103637695 ms
2022-09-21 03:16:33 INFO  Executing generated plans
2022-09-21 03:20:59 INFO  ---RUNTIME: Execution took 265989.9101257324 ms
2022-09-21 03:20:59 INFO  Done!
2022-09-21 03:20:59 INFO  # Finished -- repetition 6 of 7 
2022-09-21 03:20:59 INFO  # Optimization benchmark for data_corruption with args [['reviews', 'fast_loading', 'featurization_4', 'logistic_regression']] -- repetition 7 of 7
2022-09-21 03:20:59 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-21 03:20:59 INFO  Running instrumented original pipeline...
2022-09-21 03:20:59 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-21 03:20:59 INFO  ---RUNTIME: Importing and monkey-patching took 5.734920501708984 ms
2022-09-21 03:21:12 INFO  ---RUNTIME: Original pipeline execution took 12965.01612663269 ms (excluding imports and monkey-patching)
2022-09-21 03:21:12 INFO  Starting execution of 1 what-if analyses...
2022-09-21 03:21:12 INFO  Start plan generation for analysis DataCorruption...
2022-09-21 03:21:12 INFO  ---RUNTIME: Plan generation took 0.5650520324707031 ms
2022-09-21 03:21:12 INFO  Estimated runtime of original DAG is 9553.484201431274ms
2022-09-21 03:21:12 INFO  Performing Multi-Query Optimization
2022-09-21 03:21:12 INFO  Estimated unoptimized what-if runtime is 238837.10503578186ms
2022-09-21 03:21:12 INFO  Estimated optimised what-if runtime is 10658.98084640503ms
2022-09-21 03:21:12 INFO  Estimated optimisation runtime saving is 228178.12418937683ms
2022-09-21 03:21:12 INFO  ---RUNTIME: Multi-Query Optimization took 68.36557388305664 ms
2022-09-21 03:21:12 INFO  Executing generated plans
2022-09-21 03:21:28 INFO  ---RUNTIME: Execution took 15494.43507194519 ms
2022-09-21 03:21:28 INFO  Done!
2022-09-21 03:21:28 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-21 03:21:28 INFO  Running instrumented original pipeline...
2022-09-21 03:21:28 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-21 03:21:28 INFO  ---RUNTIME: Importing and monkey-patching took 5.753278732299805 ms
2022-09-21 03:21:41 INFO  ---RUNTIME: Original pipeline execution took 12988.049745559692 ms (excluding imports and monkey-patching)
2022-09-21 03:21:41 INFO  Starting execution of 1 what-if analyses...
2022-09-21 03:21:41 INFO  Start plan generation for analysis DataCorruption...
2022-09-21 03:21:41 INFO  ---RUNTIME: Plan generation took 0.44608116149902344 ms
2022-09-21 03:21:41 INFO  Estimated runtime of original DAG is 9328.420639038086ms
2022-09-21 03:21:41 WARNING Skipping Multi-Query Optimization (instead, only combine execution DAGs)
2022-09-21 03:21:41 INFO  Estimated unoptimised what-if runtime is 233210.51597595215ms
2022-09-21 03:21:41 INFO  ---RUNTIME: Multi-Query Optimization took 153.9762020111084 ms
2022-09-21 03:21:41 INFO  Executing generated plans
2022-09-21 03:26:08 INFO  ---RUNTIME: Execution took 267215.13843536377 ms
2022-09-21 03:26:08 INFO  Done!
2022-09-21 03:26:08 INFO  # Finished -- repetition 7 of 7 
2022-09-21 03:26:08 INFO  # Final results after all repetitions
2022-09-21 03:26:08 INFO     repetition  ... no_opt_what_if_execution_combined_model_training
0           0  ...                                      4733.204842
1           1  ...                                      4521.001339
2           2  ...                                      4481.895924
3           3  ...                                      4520.371914
4           4  ...                                      4545.601130
5           5  ...                                      4487.232924
6           6  ...                                      4523.676395

[7 rows x 26 columns]
taskset -c 32-40 PROTOCOL_BUFFERS_PYTHON_IMPLEMENTATION=python python3.9 benchmarks_end_to_end.py data_corruption reviews fast_loading featurization_4 xgboost
2022-09-21 03:26:11.099854: W tensorflow/stream_executor/platform/default/dso_loader.cc:64] Could not load dynamic library 'libcudart.so.11.0'; dlerror: libcudart.so.11.0: cannot open shared object file: No such file or directory; LD_LIBRARY_PATH: /home/sgrafbe/mlwhatif/venv/lib/python3.9/site-packages/cv2/../../lib64:
2022-09-21 03:26:11.099904: I tensorflow/stream_executor/cuda/cudart_stub.cc:29] Ignore above cudart dlerror if you do not have a GPU set up on your machine.
2022-09-21 03:26:12 INFO  Patching sys.argv with ['mlwhatif', 'reviews', 'fast_loading', 'featurization_4', 'xgboost']
2022-09-21 03:26:12 INFO  Running instrumented original pipeline...
2022-09-21 03:26:12 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-21 03:26:12 INFO  ---RUNTIME: Importing and monkey-patching took 122.08890914916992 ms
2022-09-21 03:26:36 INFO  ---RUNTIME: Original pipeline execution took 23739.36367034912 ms (excluding imports and monkey-patching)
2022-09-21 03:26:36 INFO  Starting execution of 0 what-if analyses...
2022-09-21 03:26:36 INFO  Estimated runtime of original DAG is 20457.839727401733ms
2022-09-21 03:26:36 INFO  Performing Multi-Query Optimization
2022-09-21 03:26:36 INFO  Estimated unoptimized what-if runtime is 0ms
2022-09-21 03:26:36 INFO  Estimated optimised what-if runtime is 0ms
2022-09-21 03:26:36 INFO  Estimated optimisation runtime saving is 0ms
2022-09-21 03:26:36 INFO  ---RUNTIME: Multi-Query Optimization took 0.5462169647216797 ms
2022-09-21 03:26:36 INFO  Executing generated plans
2022-09-21 03:26:36 INFO  ---RUNTIME: Execution took 0.024080276489257812 ms
2022-09-21 03:26:36 INFO  Done!
2022-09-21 03:26:36 INFO  # Optimization benchmark for data_corruption with args [['reviews', 'fast_loading', 'featurization_4', 'xgboost']] -- repetition 1 of 7
2022-09-21 03:26:36 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-21 03:26:36 INFO  Running instrumented original pipeline...
2022-09-21 03:26:36 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-21 03:26:36 INFO  ---RUNTIME: Importing and monkey-patching took 5.372285842895508 ms
2022-09-21 03:26:51 INFO  ---RUNTIME: Original pipeline execution took 15547.837257385254 ms (excluding imports and monkey-patching)
2022-09-21 03:26:51 INFO  Starting execution of 1 what-if analyses...
2022-09-21 03:26:51 INFO  Start plan generation for analysis DataCorruption...
2022-09-21 03:26:51 INFO  ---RUNTIME: Plan generation took 0.4391670227050781 ms
2022-09-21 03:26:51 INFO  Estimated runtime of original DAG is 12125.341892242432ms
2022-09-21 03:26:51 INFO  Performing Multi-Query Optimization
2022-09-21 03:26:51 INFO  Estimated unoptimized what-if runtime is 303133.5473060608ms
2022-09-21 03:26:51 INFO  Estimated optimised what-if runtime is 14344.139337539673ms
2022-09-21 03:26:51 INFO  Estimated optimisation runtime saving is 288789.4079685211ms
2022-09-21 03:26:51 INFO  ---RUNTIME: Multi-Query Optimization took 68.7563419342041 ms
2022-09-21 03:26:51 INFO  Executing generated plans
2022-09-21 03:27:11 INFO  ---RUNTIME: Execution took 19614.354848861694 ms
2022-09-21 03:27:11 INFO  Done!
2022-09-21 03:27:11 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-21 03:27:11 INFO  Running instrumented original pipeline...
2022-09-21 03:27:11 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-21 03:27:11 INFO  ---RUNTIME: Importing and monkey-patching took 6.261348724365234 ms
2022-09-21 03:27:27 INFO  ---RUNTIME: Original pipeline execution took 15765.774726867676 ms (excluding imports and monkey-patching)
2022-09-21 03:27:27 INFO  Starting execution of 1 what-if analyses...
2022-09-21 03:27:27 INFO  Start plan generation for analysis DataCorruption...
2022-09-21 03:27:27 INFO  ---RUNTIME: Plan generation took 0.4177093505859375 ms
2022-09-21 03:27:27 INFO  Estimated runtime of original DAG is 12323.500633239746ms
2022-09-21 03:27:27 WARNING Skipping Multi-Query Optimization (instead, only combine execution DAGs)
2022-09-21 03:27:27 INFO  Estimated unoptimised what-if runtime is 308087.51583099365ms
2022-09-21 03:27:27 INFO  ---RUNTIME: Multi-Query Optimization took 150.30717849731445 ms
2022-09-21 03:27:27 INFO  Executing generated plans
2022-09-21 03:33:12 INFO  ---RUNTIME: Execution took 345120.55468559265 ms
2022-09-21 03:33:12 INFO  Done!
2022-09-21 03:33:12 INFO  # Finished -- repetition 1 of 7 
2022-09-21 03:33:12 INFO  # Optimization benchmark for data_corruption with args [['reviews', 'fast_loading', 'featurization_4', 'xgboost']] -- repetition 2 of 7
2022-09-21 03:33:12 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-21 03:33:12 INFO  Running instrumented original pipeline...
2022-09-21 03:33:12 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-21 03:33:12 INFO  ---RUNTIME: Importing and monkey-patching took 6.272554397583008 ms
2022-09-21 03:34:19 INFO  ---RUNTIME: Original pipeline execution took 66630.78331947327 ms (excluding imports and monkey-patching)
2022-09-21 03:34:19 INFO  Starting execution of 1 what-if analyses...
2022-09-21 03:34:19 INFO  Start plan generation for analysis DataCorruption...
2022-09-21 03:34:19 INFO  ---RUNTIME: Plan generation took 0.5328655242919922 ms
2022-09-21 03:34:19 INFO  Estimated runtime of original DAG is 63355.02004623413ms
2022-09-21 03:34:19 INFO  Performing Multi-Query Optimization
2022-09-21 03:34:19 INFO  Estimated unoptimized what-if runtime is 1583875.5011558533ms
2022-09-21 03:34:19 INFO  Estimated optimised what-if runtime is 65557.36923217773ms
2022-09-21 03:34:19 INFO  Estimated optimisation runtime saving is 1518318.1319236755ms
2022-09-21 03:34:19 INFO  ---RUNTIME: Multi-Query Optimization took 69.12875175476074 ms
2022-09-21 03:34:19 INFO  Executing generated plans
2022-09-21 03:34:39 INFO  ---RUNTIME: Execution took 19753.962755203247 ms
2022-09-21 03:34:39 INFO  Done!
2022-09-21 03:34:39 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-21 03:34:39 INFO  Running instrumented original pipeline...
2022-09-21 03:34:39 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-21 03:34:39 INFO  ---RUNTIME: Importing and monkey-patching took 5.903482437133789 ms
2022-09-21 03:34:55 INFO  ---RUNTIME: Original pipeline execution took 16105.173587799072 ms (excluding imports and monkey-patching)
2022-09-21 03:34:55 INFO  Starting execution of 1 what-if analyses...
2022-09-21 03:34:55 INFO  Start plan generation for analysis DataCorruption...
2022-09-21 03:34:55 INFO  ---RUNTIME: Plan generation took 0.49042701721191406 ms
2022-09-21 03:34:55 INFO  Estimated runtime of original DAG is 12559.021711349487ms
2022-09-21 03:34:55 WARNING Skipping Multi-Query Optimization (instead, only combine execution DAGs)
2022-09-21 03:34:55 INFO  Estimated unoptimised what-if runtime is 313975.5427837372ms
2022-09-21 03:34:55 INFO  ---RUNTIME: Multi-Query Optimization took 152.2085666656494 ms
2022-09-21 03:34:55 INFO  Executing generated plans
2022-09-21 03:41:02 INFO  ---RUNTIME: Execution took 366768.9919471741 ms
2022-09-21 03:41:02 INFO  Done!
2022-09-21 03:41:02 INFO  # Finished -- repetition 2 of 7 
2022-09-21 03:41:02 INFO  # Optimization benchmark for data_corruption with args [['reviews', 'fast_loading', 'featurization_4', 'xgboost']] -- repetition 3 of 7
2022-09-21 03:41:02 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-21 03:41:02 INFO  Running instrumented original pipeline...
2022-09-21 03:41:02 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-21 03:41:02 INFO  ---RUNTIME: Importing and monkey-patching took 6.315946578979492 ms
2022-09-21 03:41:21 INFO  ---RUNTIME: Original pipeline execution took 19459.7589969635 ms (excluding imports and monkey-patching)
2022-09-21 03:41:21 INFO  Starting execution of 1 what-if analyses...
2022-09-21 03:41:21 INFO  Start plan generation for analysis DataCorruption...
2022-09-21 03:41:21 INFO  ---RUNTIME: Plan generation took 0.45680999755859375 ms
2022-09-21 03:41:21 INFO  Estimated runtime of original DAG is 15843.003749847412ms
2022-09-21 03:41:21 INFO  Performing Multi-Query Optimization
2022-09-21 03:41:21 INFO  Estimated unoptimized what-if runtime is 396075.0937461853ms
2022-09-21 03:41:21 INFO  Estimated optimised what-if runtime is 17977.577209472656ms
2022-09-21 03:41:21 INFO  Estimated optimisation runtime saving is 378097.51653671265ms
2022-09-21 03:41:21 INFO  ---RUNTIME: Multi-Query Optimization took 68.05610656738281 ms
2022-09-21 03:41:21 INFO  Executing generated plans
2022-09-21 03:41:41 INFO  ---RUNTIME: Execution took 19776.05438232422 ms
2022-09-21 03:41:41 INFO  Done!
2022-09-21 03:41:41 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-21 03:41:41 INFO  Running instrumented original pipeline...
2022-09-21 03:41:41 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-21 03:41:41 INFO  ---RUNTIME: Importing and monkey-patching took 5.744218826293945 ms
2022-09-21 03:42:04 INFO  ---RUNTIME: Original pipeline execution took 22840.574502944946 ms (excluding imports and monkey-patching)
2022-09-21 03:42:04 INFO  Starting execution of 1 what-if analyses...
2022-09-21 03:42:04 INFO  Start plan generation for analysis DataCorruption...
2022-09-21 03:42:04 INFO  ---RUNTIME: Plan generation took 0.48065185546875 ms
2022-09-21 03:42:04 INFO  Estimated runtime of original DAG is 19283.161878585815ms
2022-09-21 03:42:04 WARNING Skipping Multi-Query Optimization (instead, only combine execution DAGs)
2022-09-21 03:42:04 INFO  Estimated unoptimised what-if runtime is 482079.0469646454ms
2022-09-21 03:42:04 INFO  ---RUNTIME: Multi-Query Optimization took 151.05819702148438 ms
2022-09-21 03:42:04 INFO  Executing generated plans
2022-09-21 03:47:53 INFO  ---RUNTIME: Execution took 349102.237701416 ms
2022-09-21 03:47:53 INFO  Done!
2022-09-21 03:47:53 INFO  # Finished -- repetition 3 of 7 
2022-09-21 03:47:53 INFO  # Optimization benchmark for data_corruption with args [['reviews', 'fast_loading', 'featurization_4', 'xgboost']] -- repetition 4 of 7
2022-09-21 03:47:53 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-21 03:47:53 INFO  Running instrumented original pipeline...
2022-09-21 03:47:53 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-21 03:47:53 INFO  ---RUNTIME: Importing and monkey-patching took 6.366968154907227 ms
2022-09-21 03:48:09 INFO  ---RUNTIME: Original pipeline execution took 16193.203449249268 ms (excluding imports and monkey-patching)
2022-09-21 03:48:09 INFO  Starting execution of 1 what-if analyses...
2022-09-21 03:48:09 INFO  Start plan generation for analysis DataCorruption...
2022-09-21 03:48:09 INFO  ---RUNTIME: Plan generation took 0.41961669921875 ms
2022-09-21 03:48:09 INFO  Estimated runtime of original DAG is 12858.43276977539ms
2022-09-21 03:48:09 INFO  Performing Multi-Query Optimization
2022-09-21 03:48:09 INFO  Estimated unoptimized what-if runtime is 321460.81924438477ms
2022-09-21 03:48:09 INFO  Estimated optimised what-if runtime is 15168.792963027954ms
2022-09-21 03:48:09 INFO  Estimated optimisation runtime saving is 306292.0262813568ms
2022-09-21 03:48:09 INFO  ---RUNTIME: Multi-Query Optimization took 67.43359565734863 ms
2022-09-21 03:48:09 INFO  Executing generated plans
2022-09-21 03:48:29 INFO  ---RUNTIME: Execution took 19786.12756729126 ms
2022-09-21 03:48:29 INFO  Done!
2022-09-21 03:48:29 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-21 03:48:29 INFO  Running instrumented original pipeline...
2022-09-21 03:48:29 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-21 03:48:29 INFO  ---RUNTIME: Importing and monkey-patching took 6.117105484008789 ms
2022-09-21 03:48:45 INFO  ---RUNTIME: Original pipeline execution took 16099.363803863525 ms (excluding imports and monkey-patching)
2022-09-21 03:48:45 INFO  Starting execution of 1 what-if analyses...
2022-09-21 03:48:45 INFO  Start plan generation for analysis DataCorruption...
2022-09-21 03:48:45 INFO  ---RUNTIME: Plan generation took 0.44417381286621094 ms
2022-09-21 03:48:45 INFO  Estimated runtime of original DAG is 12519.869804382324ms
2022-09-21 03:48:45 WARNING Skipping Multi-Query Optimization (instead, only combine execution DAGs)
2022-09-21 03:48:45 INFO  Estimated unoptimised what-if runtime is 312996.7451095581ms
2022-09-21 03:48:45 INFO  ---RUNTIME: Multi-Query Optimization took 150.3317356109619 ms
2022-09-21 03:48:45 INFO  Executing generated plans
2022-09-21 03:55:07 INFO  ---RUNTIME: Execution took 381747.84779548645 ms
2022-09-21 03:55:07 INFO  Done!
2022-09-21 03:55:07 INFO  # Finished -- repetition 4 of 7 
2022-09-21 03:55:07 INFO  # Optimization benchmark for data_corruption with args [['reviews', 'fast_loading', 'featurization_4', 'xgboost']] -- repetition 5 of 7
2022-09-21 03:55:07 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-21 03:55:07 INFO  Running instrumented original pipeline...
2022-09-21 03:55:07 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-21 03:55:07 INFO  ---RUNTIME: Importing and monkey-patching took 5.841970443725586 ms
2022-09-21 03:55:29 INFO  ---RUNTIME: Original pipeline execution took 21705.084085464478 ms (excluding imports and monkey-patching)
2022-09-21 03:55:29 INFO  Starting execution of 1 what-if analyses...
2022-09-21 03:55:29 INFO  Start plan generation for analysis DataCorruption...
2022-09-21 03:55:29 INFO  ---RUNTIME: Plan generation took 0.5803108215332031 ms
2022-09-21 03:55:29 INFO  Estimated runtime of original DAG is 17382.70664215088ms
2022-09-21 03:55:29 INFO  Performing Multi-Query Optimization
2022-09-21 03:55:29 INFO  Estimated unoptimized what-if runtime is 434567.666053772ms
2022-09-21 03:55:29 INFO  Estimated optimised what-if runtime is 21700.133085250854ms
2022-09-21 03:55:29 INFO  Estimated optimisation runtime saving is 412867.5329685211ms
2022-09-21 03:55:29 INFO  ---RUNTIME: Multi-Query Optimization took 94.2084789276123 ms
2022-09-21 03:55:29 INFO  Executing generated plans
2022-09-21 03:56:02 INFO  ---RUNTIME: Execution took 32926.997900009155 ms
2022-09-21 03:56:02 INFO  Done!
2022-09-21 03:56:02 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-21 03:56:02 INFO  Running instrumented original pipeline...
2022-09-21 03:56:02 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-21 03:56:02 INFO  ---RUNTIME: Importing and monkey-patching took 8.147239685058594 ms
2022-09-21 03:57:20 INFO  ---RUNTIME: Original pipeline execution took 78438.26460838318 ms (excluding imports and monkey-patching)
2022-09-21 03:57:20 INFO  Starting execution of 1 what-if analyses...
2022-09-21 03:57:20 INFO  Start plan generation for analysis DataCorruption...
2022-09-21 03:57:20 INFO  ---RUNTIME: Plan generation took 0.6747245788574219 ms
2022-09-21 03:57:20 INFO  Estimated runtime of original DAG is 73977.9725074768ms
2022-09-21 03:57:20 WARNING Skipping Multi-Query Optimization (instead, only combine execution DAGs)
2022-09-21 03:57:21 INFO  Estimated unoptimised what-if runtime is 1849449.3126869202ms
2022-09-21 03:57:21 INFO  ---RUNTIME: Multi-Query Optimization took 205.94215393066406 ms
2022-09-21 03:57:21 INFO  Executing generated plans
2022-09-21 04:04:04 INFO  ---RUNTIME: Execution took 403198.1680393219 ms
2022-09-21 04:04:04 INFO  Done!
2022-09-21 04:04:04 INFO  # Finished -- repetition 5 of 7 
2022-09-21 04:04:04 INFO  # Optimization benchmark for data_corruption with args [['reviews', 'fast_loading', 'featurization_4', 'xgboost']] -- repetition 6 of 7
2022-09-21 04:04:04 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-21 04:04:04 INFO  Running instrumented original pipeline...
2022-09-21 04:04:04 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-21 04:04:04 INFO  ---RUNTIME: Importing and monkey-patching took 8.31747055053711 ms
2022-09-21 04:04:30 INFO  ---RUNTIME: Original pipeline execution took 26427.417039871216 ms (excluding imports and monkey-patching)
2022-09-21 04:04:30 INFO  Starting execution of 1 what-if analyses...
2022-09-21 04:04:30 INFO  Start plan generation for analysis DataCorruption...
2022-09-21 04:04:30 INFO  ---RUNTIME: Plan generation took 0.6494522094726562 ms
2022-09-21 04:04:30 INFO  Estimated runtime of original DAG is 22667.332649230957ms
2022-09-21 04:04:30 INFO  Performing Multi-Query Optimization
2022-09-21 04:04:30 INFO  Estimated unoptimized what-if runtime is 566683.3162307739ms
2022-09-21 04:04:30 INFO  Estimated optimised what-if runtime is 25818.767786026ms
2022-09-21 04:04:30 INFO  Estimated optimisation runtime saving is 540864.5484447479ms
2022-09-21 04:04:30 INFO  ---RUNTIME: Multi-Query Optimization took 91.87006950378418 ms
2022-09-21 04:04:30 INFO  Executing generated plans
2022-09-21 04:04:52 INFO  ---RUNTIME: Execution took 21722.190380096436 ms
2022-09-21 04:04:52 INFO  Done!
2022-09-21 04:04:52 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-21 04:04:52 INFO  Running instrumented original pipeline...
2022-09-21 04:04:52 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-21 04:04:52 INFO  ---RUNTIME: Importing and monkey-patching took 7.477760314941406 ms
2022-09-21 04:05:09 INFO  ---RUNTIME: Original pipeline execution took 16929.638862609863 ms (excluding imports and monkey-patching)
2022-09-21 04:05:09 INFO  Starting execution of 1 what-if analyses...
2022-09-21 04:05:09 INFO  Start plan generation for analysis DataCorruption...
2022-09-21 04:05:09 INFO  ---RUNTIME: Plan generation took 0.6806850433349609 ms
2022-09-21 04:05:09 INFO  Estimated runtime of original DAG is 13515.12360572815ms
2022-09-21 04:05:09 WARNING Skipping Multi-Query Optimization (instead, only combine execution DAGs)
2022-09-21 04:05:10 INFO  Estimated unoptimised what-if runtime is 337878.09014320374ms
2022-09-21 04:05:10 INFO  ---RUNTIME: Multi-Query Optimization took 662.9562377929688 ms
2022-09-21 04:05:10 INFO  Executing generated plans
2022-09-21 04:11:27 INFO  ---RUNTIME: Execution took 377799.2241382599 ms
2022-09-21 04:11:27 INFO  Done!
2022-09-21 04:11:27 INFO  # Finished -- repetition 6 of 7 
2022-09-21 04:11:27 INFO  # Optimization benchmark for data_corruption with args [['reviews', 'fast_loading', 'featurization_4', 'xgboost']] -- repetition 7 of 7
2022-09-21 04:11:27 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-21 04:11:27 INFO  Running instrumented original pipeline...
2022-09-21 04:11:28 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-21 04:11:28 INFO  ---RUNTIME: Importing and monkey-patching took 8.276939392089844 ms
2022-09-21 04:11:47 INFO  ---RUNTIME: Original pipeline execution took 19329.605102539062 ms (excluding imports and monkey-patching)
2022-09-21 04:11:47 INFO  Starting execution of 1 what-if analyses...
2022-09-21 04:11:47 INFO  Start plan generation for analysis DataCorruption...
2022-09-21 04:11:47 INFO  ---RUNTIME: Plan generation took 0.5307197570800781 ms
2022-09-21 04:11:47 INFO  Estimated runtime of original DAG is 15642.090320587158ms
2022-09-21 04:11:47 INFO  Performing Multi-Query Optimization
2022-09-21 04:11:47 INFO  Estimated unoptimized what-if runtime is 391052.25801467896ms
2022-09-21 04:11:47 INFO  Estimated optimised what-if runtime is 18460.368394851685ms
2022-09-21 04:11:47 INFO  Estimated optimisation runtime saving is 372591.88961982727ms
2022-09-21 04:11:47 INFO  ---RUNTIME: Multi-Query Optimization took 67.87657737731934 ms
2022-09-21 04:11:47 INFO  Executing generated plans
2022-09-21 04:12:08 INFO  ---RUNTIME: Execution took 21391.319513320923 ms
2022-09-21 04:12:08 INFO  Done!
2022-09-21 04:12:08 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-21 04:12:08 INFO  Running instrumented original pipeline...
2022-09-21 04:12:08 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-21 04:12:08 INFO  ---RUNTIME: Importing and monkey-patching took 6.268739700317383 ms
2022-09-21 04:12:26 INFO  ---RUNTIME: Original pipeline execution took 17838.905334472656 ms (excluding imports and monkey-patching)
2022-09-21 04:12:26 INFO  Starting execution of 1 what-if analyses...
2022-09-21 04:12:26 INFO  Start plan generation for analysis DataCorruption...
2022-09-21 04:12:26 INFO  ---RUNTIME: Plan generation took 0.4494190216064453 ms
2022-09-21 04:12:26 INFO  Estimated runtime of original DAG is 13833.160877227783ms
2022-09-21 04:12:26 WARNING Skipping Multi-Query Optimization (instead, only combine execution DAGs)
2022-09-21 04:12:26 INFO  Estimated unoptimised what-if runtime is 345829.0219306946ms
2022-09-21 04:12:26 INFO  ---RUNTIME: Multi-Query Optimization took 151.0937213897705 ms
2022-09-21 04:12:26 INFO  Executing generated plans
2022-09-21 04:19:59 INFO  ---RUNTIME: Execution took 452457.52596855164 ms
2022-09-21 04:19:59 INFO  Done!
2022-09-21 04:19:59 INFO  # Finished -- repetition 7 of 7 
2022-09-21 04:19:59 INFO  # Final results after all repetitions
2022-09-21 04:19:59 INFO     repetition  ... no_opt_what_if_execution_combined_model_training
0           0  ...                                     80851.067781
1           1  ...                                    103095.731020
2           2  ...                                     85623.881578
3           3  ...                                    114092.853785
4           4  ...                                    137374.497890
5           5  ...                                    113498.826742
6           6  ...                                    186847.103119

[7 rows x 26 columns]
taskset -c 32-40 PROTOCOL_BUFFERS_PYTHON_IMPLEMENTATION=python python3.9 benchmarks_end_to_end.py data_corruption reviews fast_loading featurization_4 neural_network
2022-09-21 04:20:01.628808: W tensorflow/stream_executor/platform/default/dso_loader.cc:64] Could not load dynamic library 'libcudart.so.11.0'; dlerror: libcudart.so.11.0: cannot open shared object file: No such file or directory; LD_LIBRARY_PATH: /home/sgrafbe/mlwhatif/venv/lib/python3.9/site-packages/cv2/../../lib64:
2022-09-21 04:20:01.628857: I tensorflow/stream_executor/cuda/cudart_stub.cc:29] Ignore above cudart dlerror if you do not have a GPU set up on your machine.
2022-09-21 04:20:03 INFO  Patching sys.argv with ['mlwhatif', 'reviews', 'fast_loading', 'featurization_4', 'neural_network']
2022-09-21 04:20:03 INFO  Running instrumented original pipeline...
2022-09-21 04:20:03 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-21 04:20:03 INFO  ---RUNTIME: Importing and monkey-patching took 160.0942611694336 ms
2022-09-21 04:20:16.282591: W tensorflow/stream_executor/platform/default/dso_loader.cc:64] Could not load dynamic library 'libcuda.so.1'; dlerror: libcuda.so.1: cannot open shared object file: No such file or directory; LD_LIBRARY_PATH: /home/sgrafbe/mlwhatif/venv/lib/python3.9/site-packages/cv2/../../lib64:
2022-09-21 04:20:16.282628: W tensorflow/stream_executor/cuda/cuda_driver.cc:326] failed call to cuInit: UNKNOWN ERROR (303)
2022-09-21 04:20:16.282651: I tensorflow/stream_executor/cuda/cuda_diagnostics.cc:156] kernel driver does not appear to be running on this host (angus): /proc/driver/nvidia/version does not exist
2022-09-21 04:20:16.283250: I tensorflow/core/platform/cpu_feature_guard.cc:142] This TensorFlow binary is optimized with oneAPI Deep Neural Network Library (oneDNN) to use the following CPU instructions in performance-critical operations:  AVX2 FMA
To enable them in other operations, rebuild TensorFlow with the appropriate compiler flags.
2022-09-21 04:20:16.535632: I tensorflow/compiler/mlir/mlir_graph_optimization_pass.cc:176] None of the MLIR Optimization Passes are enabled (registered 2)
2022-09-21 04:20:16.548194: I tensorflow/core/platform/profile_utils/cpu_utils.cc:114] CPU Frequency: 2595130000 Hz
2022-09-21 04:20:20 INFO  ---RUNTIME: Original pipeline execution took 17082.72886276245 ms (excluding imports and monkey-patching)
2022-09-21 04:20:20 INFO  Starting execution of 0 what-if analyses...
2022-09-21 04:20:20 INFO  Estimated runtime of original DAG is 13767.914772033691ms
2022-09-21 04:20:20 INFO  Performing Multi-Query Optimization
2022-09-21 04:20:20 INFO  Estimated unoptimized what-if runtime is 0ms
2022-09-21 04:20:20 INFO  Estimated optimised what-if runtime is 0ms
2022-09-21 04:20:20 INFO  Estimated optimisation runtime saving is 0ms
2022-09-21 04:20:20 INFO  ---RUNTIME: Multi-Query Optimization took 0.5702972412109375 ms
2022-09-21 04:20:20 INFO  Executing generated plans
2022-09-21 04:20:20 INFO  ---RUNTIME: Execution took 0.02288818359375 ms
2022-09-21 04:20:20 INFO  Done!
2022-09-21 04:20:20 INFO  # Optimization benchmark for data_corruption with args [['reviews', 'fast_loading', 'featurization_4', 'neural_network']] -- repetition 1 of 7
2022-09-21 04:20:20 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-21 04:20:20 INFO  Running instrumented original pipeline...
2022-09-21 04:20:20 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-21 04:20:20 INFO  ---RUNTIME: Importing and monkey-patching took 5.376577377319336 ms
2022-09-21 04:20:36 INFO  ---RUNTIME: Original pipeline execution took 16340.158462524414 ms (excluding imports and monkey-patching)
2022-09-21 04:20:36 INFO  Starting execution of 1 what-if analyses...
2022-09-21 04:20:36 INFO  Start plan generation for analysis DataCorruption...
2022-09-21 04:20:36 INFO  ---RUNTIME: Plan generation took 0.3952980041503906 ms
2022-09-21 04:20:36 INFO  Estimated runtime of original DAG is 12896.076202392578ms
2022-09-21 04:20:36 INFO  Performing Multi-Query Optimization
2022-09-21 04:20:36 INFO  Estimated unoptimized what-if runtime is 322401.90505981445ms
2022-09-21 04:20:36 INFO  Estimated optimised what-if runtime is 24085.00337600708ms
2022-09-21 04:20:36 INFO  Estimated optimisation runtime saving is 298316.9016838074ms
2022-09-21 04:20:36 INFO  ---RUNTIME: Multi-Query Optimization took 69.56028938293457 ms
2022-09-21 04:20:36 INFO  Executing generated plans
2022-09-21 04:21:04 INFO  ---RUNTIME: Execution took 27989.39847946167 ms
2022-09-21 04:21:04 INFO  Done!
2022-09-21 04:21:04 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-21 04:21:04 INFO  Running instrumented original pipeline...
2022-09-21 04:21:05 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-21 04:21:05 INFO  ---RUNTIME: Importing and monkey-patching took 5.875587463378906 ms
2022-09-21 04:21:21 INFO  ---RUNTIME: Original pipeline execution took 16484.259605407715 ms (excluding imports and monkey-patching)
2022-09-21 04:21:21 INFO  Starting execution of 1 what-if analyses...
2022-09-21 04:21:21 INFO  Start plan generation for analysis DataCorruption...
2022-09-21 04:21:21 INFO  ---RUNTIME: Plan generation took 0.4553794860839844 ms
2022-09-21 04:21:21 INFO  Estimated runtime of original DAG is 12979.115724563599ms
2022-09-21 04:21:21 WARNING Skipping Multi-Query Optimization (instead, only combine execution DAGs)
2022-09-21 04:21:21 INFO  Estimated unoptimised what-if runtime is 324477.89311408997ms
2022-09-21 04:21:21 INFO  ---RUNTIME: Multi-Query Optimization took 363.3716106414795 ms
2022-09-21 04:21:21 INFO  Executing generated plans
2022-09-21 04:27:42 INFO  ---RUNTIME: Execution took 380603.70683670044 ms
2022-09-21 04:27:42 INFO  Done!
2022-09-21 04:27:42 INFO  # Finished -- repetition 1 of 7 
2022-09-21 04:27:42 INFO  # Optimization benchmark for data_corruption with args [['reviews', 'fast_loading', 'featurization_4', 'neural_network']] -- repetition 2 of 7
2022-09-21 04:27:42 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-21 04:27:42 INFO  Running instrumented original pipeline...
2022-09-21 04:27:42 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-21 04:27:42 INFO  ---RUNTIME: Importing and monkey-patching took 5.786418914794922 ms
2022-09-21 04:27:58 INFO  ---RUNTIME: Original pipeline execution took 16158.054113388062 ms (excluding imports and monkey-patching)
2022-09-21 04:27:58 INFO  Starting execution of 1 what-if analyses...
2022-09-21 04:27:58 INFO  Start plan generation for analysis DataCorruption...
2022-09-21 04:27:58 INFO  ---RUNTIME: Plan generation took 0.4363059997558594 ms
2022-09-21 04:27:58 INFO  Estimated runtime of original DAG is 12848.855257034302ms
2022-09-21 04:27:58 INFO  Performing Multi-Query Optimization
2022-09-21 04:27:58 INFO  Estimated unoptimized what-if runtime is 321221.38142585754ms
2022-09-21 04:27:58 INFO  Estimated optimised what-if runtime is 23578.304052352905ms
2022-09-21 04:27:58 INFO  Estimated optimisation runtime saving is 297643.07737350464ms
2022-09-21 04:27:58 INFO  ---RUNTIME: Multi-Query Optimization took 69.43178176879883 ms
2022-09-21 04:27:58 INFO  Executing generated plans
2022-09-21 04:28:27 INFO  ---RUNTIME: Execution took 28707.428455352783 ms
2022-09-21 04:28:27 INFO  Done!
2022-09-21 04:28:27 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-21 04:28:27 INFO  Running instrumented original pipeline...
2022-09-21 04:28:27 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-21 04:28:27 INFO  ---RUNTIME: Importing and monkey-patching took 6.479024887084961 ms
2022-09-21 04:28:43 INFO  ---RUNTIME: Original pipeline execution took 16296.497106552124 ms (excluding imports and monkey-patching)
2022-09-21 04:28:43 INFO  Starting execution of 1 what-if analyses...
2022-09-21 04:28:43 INFO  Start plan generation for analysis DataCorruption...
2022-09-21 04:28:43 INFO  ---RUNTIME: Plan generation took 0.3437995910644531 ms
2022-09-21 04:28:43 INFO  Estimated runtime of original DAG is 12998.90112876892ms
2022-09-21 04:28:43 WARNING Skipping Multi-Query Optimization (instead, only combine execution DAGs)
2022-09-21 04:28:43 INFO  Estimated unoptimised what-if runtime is 324972.528219223ms
2022-09-21 04:28:43 INFO  ---RUNTIME: Multi-Query Optimization took 153.20062637329102 ms
2022-09-21 04:28:43 INFO  Executing generated plans
2022-09-21 04:35:00 INFO  ---RUNTIME: Execution took 376466.23516082764 ms
2022-09-21 04:35:00 INFO  Done!
2022-09-21 04:35:00 INFO  # Finished -- repetition 2 of 7 
2022-09-21 04:35:00 INFO  # Optimization benchmark for data_corruption with args [['reviews', 'fast_loading', 'featurization_4', 'neural_network']] -- repetition 3 of 7
2022-09-21 04:35:00 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-21 04:35:00 INFO  Running instrumented original pipeline...
2022-09-21 04:35:00 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-21 04:35:00 INFO  ---RUNTIME: Importing and monkey-patching took 6.421566009521484 ms
2022-09-21 04:35:17 INFO  ---RUNTIME: Original pipeline execution took 16900.37178993225 ms (excluding imports and monkey-patching)
2022-09-21 04:35:17 INFO  Starting execution of 1 what-if analyses...
2022-09-21 04:35:17 INFO  Start plan generation for analysis DataCorruption...
2022-09-21 04:35:17 INFO  ---RUNTIME: Plan generation took 0.4036426544189453 ms
2022-09-21 04:35:17 INFO  Estimated runtime of original DAG is 12792.540073394775ms
2022-09-21 04:35:17 INFO  Performing Multi-Query Optimization
2022-09-21 04:35:17 INFO  Estimated unoptimized what-if runtime is 319813.5018348694ms
2022-09-21 04:35:17 INFO  Estimated optimised what-if runtime is 23276.602745056152ms
2022-09-21 04:35:17 INFO  Estimated optimisation runtime saving is 296536.89908981323ms
2022-09-21 04:35:17 INFO  ---RUNTIME: Multi-Query Optimization took 69.07320022583008 ms
2022-09-21 04:35:17 INFO  Executing generated plans
2022-09-21 04:35:45 INFO  ---RUNTIME: Execution took 28525.249004364014 ms
2022-09-21 04:35:45 INFO  Done!
2022-09-21 04:35:45 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-21 04:35:45 INFO  Running instrumented original pipeline...
2022-09-21 04:35:45 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-21 04:35:45 INFO  ---RUNTIME: Importing and monkey-patching took 6.448984146118164 ms
2022-09-21 04:36:02 INFO  ---RUNTIME: Original pipeline execution took 16633.60548019409 ms (excluding imports and monkey-patching)
2022-09-21 04:36:02 INFO  Starting execution of 1 what-if analyses...
2022-09-21 04:36:02 INFO  Start plan generation for analysis DataCorruption...
2022-09-21 04:36:02 INFO  ---RUNTIME: Plan generation took 0.4127025604248047 ms
2022-09-21 04:36:02 INFO  Estimated runtime of original DAG is 12846.269369125366ms
2022-09-21 04:36:02 WARNING Skipping Multi-Query Optimization (instead, only combine execution DAGs)
2022-09-21 04:36:02 INFO  Estimated unoptimised what-if runtime is 321156.73422813416ms
2022-09-21 04:36:02 INFO  ---RUNTIME: Multi-Query Optimization took 154.6788215637207 ms
2022-09-21 04:36:02 INFO  Executing generated plans
2022-09-21 04:42:17 INFO  ---RUNTIME: Execution took 375100.99363327026 ms
2022-09-21 04:42:17 INFO  Done!
2022-09-21 04:42:17 INFO  # Finished -- repetition 3 of 7 
2022-09-21 04:42:17 INFO  # Optimization benchmark for data_corruption with args [['reviews', 'fast_loading', 'featurization_4', 'neural_network']] -- repetition 4 of 7
2022-09-21 04:42:17 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-21 04:42:17 INFO  Running instrumented original pipeline...
2022-09-21 04:42:17 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-21 04:42:17 INFO  ---RUNTIME: Importing and monkey-patching took 6.500720977783203 ms
2022-09-21 04:42:34 INFO  ---RUNTIME: Original pipeline execution took 16807.272911071777 ms (excluding imports and monkey-patching)
2022-09-21 04:42:34 INFO  Starting execution of 1 what-if analyses...
2022-09-21 04:42:34 INFO  Start plan generation for analysis DataCorruption...
2022-09-21 04:42:34 INFO  ---RUNTIME: Plan generation took 0.44035911560058594 ms
2022-09-21 04:42:34 INFO  Estimated runtime of original DAG is 12671.00715637207ms
2022-09-21 04:42:34 INFO  Performing Multi-Query Optimization
2022-09-21 04:42:34 INFO  Estimated unoptimized what-if runtime is 316775.17890930176ms
2022-09-21 04:42:34 INFO  Estimated optimised what-if runtime is 23220.6552028656ms
2022-09-21 04:42:34 INFO  Estimated optimisation runtime saving is 293554.52370643616ms
2022-09-21 04:42:34 INFO  ---RUNTIME: Multi-Query Optimization took 69.40650939941406 ms
2022-09-21 04:42:34 INFO  Executing generated plans
2022-09-21 04:43:03 INFO  ---RUNTIME: Execution took 28988.887786865234 ms
2022-09-21 04:43:03 INFO  Done!
2022-09-21 04:43:03 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-21 04:43:03 INFO  Running instrumented original pipeline...
2022-09-21 04:43:03 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-21 04:43:03 INFO  ---RUNTIME: Importing and monkey-patching took 6.095647811889648 ms
2022-09-21 04:43:20 INFO  ---RUNTIME: Original pipeline execution took 16643.664121627808 ms (excluding imports and monkey-patching)
2022-09-21 04:43:20 INFO  Starting execution of 1 what-if analyses...
2022-09-21 04:43:20 INFO  Start plan generation for analysis DataCorruption...
2022-09-21 04:43:20 INFO  ---RUNTIME: Plan generation took 0.4494190216064453 ms
2022-09-21 04:43:20 INFO  Estimated runtime of original DAG is 13191.545009613037ms
2022-09-21 04:43:20 WARNING Skipping Multi-Query Optimization (instead, only combine execution DAGs)
2022-09-21 04:43:20 INFO  Estimated unoptimised what-if runtime is 329788.6252403259ms
2022-09-21 04:43:20 INFO  ---RUNTIME: Multi-Query Optimization took 154.18386459350586 ms
2022-09-21 04:43:20 INFO  Executing generated plans
2022-09-21 04:49:24 INFO  ---RUNTIME: Execution took 364247.3337650299 ms
2022-09-21 04:49:24 INFO  Done!
2022-09-21 04:49:24 INFO  # Finished -- repetition 4 of 7 
2022-09-21 04:49:24 INFO  # Optimization benchmark for data_corruption with args [['reviews', 'fast_loading', 'featurization_4', 'neural_network']] -- repetition 5 of 7
2022-09-21 04:49:24 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-21 04:49:24 INFO  Running instrumented original pipeline...
2022-09-21 04:49:24 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-21 04:49:24 INFO  ---RUNTIME: Importing and monkey-patching took 6.240367889404297 ms
2022-09-21 04:49:41 INFO  ---RUNTIME: Original pipeline execution took 16766.65163040161 ms (excluding imports and monkey-patching)
2022-09-21 04:49:41 INFO  Starting execution of 1 what-if analyses...
2022-09-21 04:49:41 INFO  Start plan generation for analysis DataCorruption...
2022-09-21 04:49:41 INFO  ---RUNTIME: Plan generation took 0.4220008850097656 ms
2022-09-21 04:49:41 INFO  Estimated runtime of original DAG is 13429.259300231934ms
2022-09-21 04:49:41 INFO  Performing Multi-Query Optimization
2022-09-21 04:49:41 INFO  Estimated unoptimized what-if runtime is 335731.48250579834ms
2022-09-21 04:49:41 INFO  Estimated optimised what-if runtime is 42657.846212387085ms
2022-09-21 04:49:41 INFO  Estimated optimisation runtime saving is 293073.63629341125ms
2022-09-21 04:49:41 INFO  ---RUNTIME: Multi-Query Optimization took 71.43187522888184 ms
2022-09-21 04:49:41 INFO  Executing generated plans
2022-09-21 04:50:09 INFO  ---RUNTIME: Execution took 28171.19550704956 ms
2022-09-21 04:50:09 INFO  Done!
2022-09-21 04:50:09 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-21 04:50:09 INFO  Running instrumented original pipeline...
2022-09-21 04:50:09 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-21 04:50:09 INFO  ---RUNTIME: Importing and monkey-patching took 6.248235702514648 ms
2022-09-21 04:50:26 INFO  ---RUNTIME: Original pipeline execution took 16873.956203460693 ms (excluding imports and monkey-patching)
2022-09-21 04:50:26 INFO  Starting execution of 1 what-if analyses...
2022-09-21 04:50:26 INFO  Start plan generation for analysis DataCorruption...
2022-09-21 04:50:26 INFO  ---RUNTIME: Plan generation took 0.40221214294433594 ms
2022-09-21 04:50:26 INFO  Estimated runtime of original DAG is 13061.378240585327ms
2022-09-21 04:50:26 WARNING Skipping Multi-Query Optimization (instead, only combine execution DAGs)
2022-09-21 04:50:26 INFO  Estimated unoptimised what-if runtime is 326534.4560146332ms
2022-09-21 04:50:26 INFO  ---RUNTIME: Multi-Query Optimization took 154.48665618896484 ms
2022-09-21 04:50:26 INFO  Executing generated plans
2022-09-21 04:56:29 INFO  ---RUNTIME: Execution took 362691.3630962372 ms
2022-09-21 04:56:29 INFO  Done!
2022-09-21 04:56:29 INFO  # Finished -- repetition 5 of 7 
2022-09-21 04:56:29 INFO  # Optimization benchmark for data_corruption with args [['reviews', 'fast_loading', 'featurization_4', 'neural_network']] -- repetition 6 of 7
2022-09-21 04:56:29 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-21 04:56:29 INFO  Running instrumented original pipeline...
2022-09-21 04:56:29 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-21 04:56:29 INFO  ---RUNTIME: Importing and monkey-patching took 5.844831466674805 ms
2022-09-21 04:56:45 INFO  ---RUNTIME: Original pipeline execution took 16274.693965911865 ms (excluding imports and monkey-patching)
2022-09-21 04:56:45 INFO  Starting execution of 1 what-if analyses...
2022-09-21 04:56:45 INFO  Start plan generation for analysis DataCorruption...
2022-09-21 04:56:45 INFO  ---RUNTIME: Plan generation took 0.3948211669921875 ms
2022-09-21 04:56:45 INFO  Estimated runtime of original DAG is 12862.825155258179ms
2022-09-21 04:56:45 INFO  Performing Multi-Query Optimization
2022-09-21 04:56:45 INFO  Estimated unoptimized what-if runtime is 321570.62888145447ms
2022-09-21 04:56:45 INFO  Estimated optimised what-if runtime is 23946.22302055359ms
2022-09-21 04:56:45 INFO  Estimated optimisation runtime saving is 297624.4058609009ms
2022-09-21 04:56:45 INFO  ---RUNTIME: Multi-Query Optimization took 70.55449485778809 ms
2022-09-21 04:56:45 INFO  Executing generated plans
2022-09-21 04:57:14 INFO  ---RUNTIME: Execution took 28588.039875030518 ms
2022-09-21 04:57:14 INFO  Done!
2022-09-21 04:57:14 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-21 04:57:14 INFO  Running instrumented original pipeline...
2022-09-21 04:57:14 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-21 04:57:14 INFO  ---RUNTIME: Importing and monkey-patching took 5.963325500488281 ms
2022-09-21 04:57:30 INFO  ---RUNTIME: Original pipeline execution took 16265.884637832642 ms (excluding imports and monkey-patching)
2022-09-21 04:57:30 INFO  Starting execution of 1 what-if analyses...
2022-09-21 04:57:30 INFO  Start plan generation for analysis DataCorruption...
2022-09-21 04:57:30 INFO  ---RUNTIME: Plan generation took 0.42724609375 ms
2022-09-21 04:57:30 INFO  Estimated runtime of original DAG is 12843.305110931396ms
2022-09-21 04:57:30 WARNING Skipping Multi-Query Optimization (instead, only combine execution DAGs)
2022-09-21 04:57:30 INFO  Estimated unoptimised what-if runtime is 321082.6277732849ms
2022-09-21 04:57:30 INFO  ---RUNTIME: Multi-Query Optimization took 153.1538963317871 ms
2022-09-21 04:57:30 INFO  Executing generated plans
2022-09-21 05:03:34 INFO  ---RUNTIME: Execution took 363551.1739253998 ms
2022-09-21 05:03:34 INFO  Done!
2022-09-21 05:03:34 INFO  # Finished -- repetition 6 of 7 
2022-09-21 05:03:34 INFO  # Optimization benchmark for data_corruption with args [['reviews', 'fast_loading', 'featurization_4', 'neural_network']] -- repetition 7 of 7
2022-09-21 05:03:34 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-21 05:03:34 INFO  Running instrumented original pipeline...
2022-09-21 05:03:34 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-21 05:03:34 INFO  ---RUNTIME: Importing and monkey-patching took 5.980014801025391 ms
2022-09-21 05:03:50 INFO  ---RUNTIME: Original pipeline execution took 16100.67367553711 ms (excluding imports and monkey-patching)
2022-09-21 05:03:50 INFO  Starting execution of 1 what-if analyses...
2022-09-21 05:03:50 INFO  Start plan generation for analysis DataCorruption...
2022-09-21 05:03:50 INFO  ---RUNTIME: Plan generation took 0.4162788391113281 ms
2022-09-21 05:03:50 INFO  Estimated runtime of original DAG is 12730.132579803467ms
2022-09-21 05:03:50 INFO  Performing Multi-Query Optimization
2022-09-21 05:03:50 INFO  Estimated unoptimized what-if runtime is 318253.31449508667ms
2022-09-21 05:03:50 INFO  Estimated optimised what-if runtime is 23377.904176712036ms
2022-09-21 05:03:50 INFO  Estimated optimisation runtime saving is 294875.41031837463ms
2022-09-21 05:03:50 INFO  ---RUNTIME: Multi-Query Optimization took 70.75905799865723 ms
2022-09-21 05:03:50 INFO  Executing generated plans
2022-09-21 05:04:18 INFO  ---RUNTIME: Execution took 28057.67250061035 ms
2022-09-21 05:04:18 INFO  Done!
2022-09-21 05:04:18 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-21 05:04:18 INFO  Running instrumented original pipeline...
2022-09-21 05:04:19 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-21 05:04:19 INFO  ---RUNTIME: Importing and monkey-patching took 5.983114242553711 ms
2022-09-21 05:04:35 INFO  ---RUNTIME: Original pipeline execution took 16951.322078704834 ms (excluding imports and monkey-patching)
2022-09-21 05:04:35 INFO  Starting execution of 1 what-if analyses...
2022-09-21 05:04:35 INFO  Start plan generation for analysis DataCorruption...
2022-09-21 05:04:35 INFO  ---RUNTIME: Plan generation took 0.4837512969970703 ms
2022-09-21 05:04:35 INFO  Estimated runtime of original DAG is 12883.553981781006ms
2022-09-21 05:04:35 WARNING Skipping Multi-Query Optimization (instead, only combine execution DAGs)
2022-09-21 05:04:35 INFO  Estimated unoptimised what-if runtime is 322088.84954452515ms
2022-09-21 05:04:35 INFO  ---RUNTIME: Multi-Query Optimization took 157.07826614379883 ms
2022-09-21 05:04:35 INFO  Executing generated plans
2022-09-21 05:10:38 INFO  ---RUNTIME: Execution took 362566.64657592773 ms
2022-09-21 05:10:38 INFO  Done!
2022-09-21 05:10:38 INFO  # Finished -- repetition 7 of 7 
2022-09-21 05:10:38 INFO  # Final results after all repetitions
2022-09-21 05:10:38 INFO     repetition  ... no_opt_what_if_execution_combined_model_training
0           0  ...                                     88445.870161
1           1  ...                                     86210.796356
2           2  ...                                     85620.244503
3           3  ...                                     85641.751289
4           4  ...                                     84817.991257
5           5  ...                                     86983.541489
6           6  ...                                     87069.174051

[7 rows x 26 columns]
taskset -c 32-40 PROTOCOL_BUFFERS_PYTHON_IMPLEMENTATION=python python3.9 benchmarks_end_to_end.py feature_importance reviews fast_loading featurization_0 logistic_regression
2022-09-21 05:10:41.480525: W tensorflow/stream_executor/platform/default/dso_loader.cc:64] Could not load dynamic library 'libcudart.so.11.0'; dlerror: libcudart.so.11.0: cannot open shared object file: No such file or directory; LD_LIBRARY_PATH: /home/sgrafbe/mlwhatif/venv/lib/python3.9/site-packages/cv2/../../lib64:
2022-09-21 05:10:41.480574: I tensorflow/stream_executor/cuda/cudart_stub.cc:29] Ignore above cudart dlerror if you do not have a GPU set up on your machine.
2022-09-21 05:10:42 INFO  Patching sys.argv with ['mlwhatif', 'reviews', 'fast_loading', 'featurization_0', 'logistic_regression']
2022-09-21 05:10:42 INFO  Running instrumented original pipeline...
2022-09-21 05:10:42 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-21 05:10:42 INFO  ---RUNTIME: Importing and monkey-patching took 120.86224555969238 ms
2022-09-21 05:10:49 INFO  ---RUNTIME: Original pipeline execution took 6559.07416343689 ms (excluding imports and monkey-patching)
2022-09-21 05:10:49 INFO  Starting execution of 0 what-if analyses...
2022-09-21 05:10:49 INFO  Estimated runtime of original DAG is 4884.304761886597ms
2022-09-21 05:10:49 INFO  Performing Multi-Query Optimization
2022-09-21 05:10:49 INFO  Estimated unoptimized what-if runtime is 0ms
2022-09-21 05:10:49 INFO  Estimated optimised what-if runtime is 0ms
2022-09-21 05:10:49 INFO  Estimated optimisation runtime saving is 0ms
2022-09-21 05:10:49 INFO  ---RUNTIME: Multi-Query Optimization took 0.5097389221191406 ms
2022-09-21 05:10:49 INFO  Executing generated plans
2022-09-21 05:10:49 INFO  ---RUNTIME: Execution took 0.025987625122070312 ms
2022-09-21 05:10:49 INFO  Done!
2022-09-21 05:10:49 INFO  # Optimization benchmark for feature_importance with args [['reviews', 'fast_loading', 'featurization_0', 'logistic_regression']] -- repetition 1 of 7
2022-09-21 05:10:49 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-21 05:10:49 INFO  Running instrumented original pipeline...
2022-09-21 05:10:49 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-21 05:10:49 INFO  ---RUNTIME: Importing and monkey-patching took 5.684852600097656 ms
2022-09-21 05:10:56 INFO  ---RUNTIME: Original pipeline execution took 6607.064962387085 ms (excluding imports and monkey-patching)
2022-09-21 05:10:56 INFO  Starting execution of 1 what-if analyses...
2022-09-21 05:10:56 INFO  Start plan generation for analysis PermutationFeatureImportance...
2022-09-21 05:10:56 INFO  ---RUNTIME: Plan generation took 0.17952919006347656 ms
2022-09-21 05:10:56 INFO  Estimated runtime of original DAG is 4808.985471725464ms
2022-09-21 05:10:56 INFO  Performing Multi-Query Optimization
2022-09-21 05:10:56 INFO  Estimated unoptimized what-if runtime is 24044.92735862732ms
2022-09-21 05:10:56 INFO  Estimated optimised what-if runtime is 6125.514268875122ms
2022-09-21 05:10:56 INFO  Estimated optimisation runtime saving is 17919.413089752197ms
2022-09-21 05:10:56 INFO  ---RUNTIME: Multi-Query Optimization took 9.416580200195312 ms
2022-09-21 05:10:56 INFO  Executing generated plans
2022-09-21 05:11:03 INFO  ---RUNTIME: Execution took 7040.212154388428 ms
2022-09-21 05:11:03 INFO  Done!
2022-09-21 05:11:03 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-21 05:11:03 INFO  Running instrumented original pipeline...
2022-09-21 05:11:03 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-21 05:11:03 INFO  ---RUNTIME: Importing and monkey-patching took 5.967855453491211 ms
2022-09-21 05:11:09 INFO  ---RUNTIME: Original pipeline execution took 6475.423097610474 ms (excluding imports and monkey-patching)
2022-09-21 05:11:09 INFO  Starting execution of 1 what-if analyses...
2022-09-21 05:11:09 INFO  Start plan generation for analysis PermutationFeatureImportance...
2022-09-21 05:11:09 INFO  ---RUNTIME: Plan generation took 0.12803077697753906 ms
2022-09-21 05:11:09 INFO  Estimated runtime of original DAG is 4821.402788162231ms
2022-09-21 05:11:09 WARNING Skipping Multi-Query Optimization (instead, only combine execution DAGs)
2022-09-21 05:11:09 INFO  Estimated unoptimised what-if runtime is 24107.013940811157ms
2022-09-21 05:11:09 INFO  ---RUNTIME: Multi-Query Optimization took 13.266324996948242 ms
2022-09-21 05:11:09 INFO  Executing generated plans
2022-09-21 05:11:38 INFO  ---RUNTIME: Execution took 28480.95393180847 ms
2022-09-21 05:11:38 INFO  Done!
2022-09-21 05:11:38 INFO  # Finished -- repetition 1 of 7 
2022-09-21 05:11:38 INFO  # Optimization benchmark for feature_importance with args [['reviews', 'fast_loading', 'featurization_0', 'logistic_regression']] -- repetition 2 of 7
2022-09-21 05:11:38 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-21 05:11:38 INFO  Running instrumented original pipeline...
2022-09-21 05:11:38 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-21 05:11:38 INFO  ---RUNTIME: Importing and monkey-patching took 6.1893463134765625 ms
2022-09-21 05:11:44 INFO  ---RUNTIME: Original pipeline execution took 6464.778184890747 ms (excluding imports and monkey-patching)
2022-09-21 05:11:44 INFO  Starting execution of 1 what-if analyses...
2022-09-21 05:11:44 INFO  Start plan generation for analysis PermutationFeatureImportance...
2022-09-21 05:11:44 INFO  ---RUNTIME: Plan generation took 0.12135505676269531 ms
2022-09-21 05:11:44 INFO  Estimated runtime of original DAG is 4802.011728286743ms
2022-09-21 05:11:44 INFO  Performing Multi-Query Optimization
2022-09-21 05:11:44 INFO  Estimated unoptimized what-if runtime is 24010.058641433716ms
2022-09-21 05:11:44 INFO  Estimated optimised what-if runtime is 6103.203773498535ms
2022-09-21 05:11:44 INFO  Estimated optimisation runtime saving is 17906.85486793518ms
2022-09-21 05:11:44 INFO  ---RUNTIME: Multi-Query Optimization took 9.387493133544922 ms
2022-09-21 05:11:44 INFO  Executing generated plans
2022-09-21 05:11:51 INFO  ---RUNTIME: Execution took 7055.411577224731 ms
2022-09-21 05:11:51 INFO  Done!
2022-09-21 05:11:51 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-21 05:11:51 INFO  Running instrumented original pipeline...
2022-09-21 05:11:51 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-21 05:11:51 INFO  ---RUNTIME: Importing and monkey-patching took 6.031513214111328 ms
2022-09-21 05:11:58 INFO  ---RUNTIME: Original pipeline execution took 6500.815629959106 ms (excluding imports and monkey-patching)
2022-09-21 05:11:58 INFO  Starting execution of 1 what-if analyses...
2022-09-21 05:11:58 INFO  Start plan generation for analysis PermutationFeatureImportance...
2022-09-21 05:11:58 INFO  ---RUNTIME: Plan generation took 0.12445449829101562 ms
2022-09-21 05:11:58 INFO  Estimated runtime of original DAG is 4824.8419761657715ms
2022-09-21 05:11:58 WARNING Skipping Multi-Query Optimization (instead, only combine execution DAGs)
2022-09-21 05:11:58 INFO  Estimated unoptimised what-if runtime is 24124.209880828857ms
2022-09-21 05:11:58 INFO  ---RUNTIME: Multi-Query Optimization took 13.392448425292969 ms
2022-09-21 05:11:58 INFO  Executing generated plans
2022-09-21 05:12:26 INFO  ---RUNTIME: Execution took 28483.856439590454 ms
2022-09-21 05:12:26 INFO  Done!
2022-09-21 05:12:26 INFO  # Finished -- repetition 2 of 7 
2022-09-21 05:12:26 INFO  # Optimization benchmark for feature_importance with args [['reviews', 'fast_loading', 'featurization_0', 'logistic_regression']] -- repetition 3 of 7
2022-09-21 05:12:26 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-21 05:12:26 INFO  Running instrumented original pipeline...
2022-09-21 05:12:26 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-21 05:12:26 INFO  ---RUNTIME: Importing and monkey-patching took 5.752325057983398 ms
2022-09-21 05:12:33 INFO  ---RUNTIME: Original pipeline execution took 6558.189630508423 ms (excluding imports and monkey-patching)
2022-09-21 05:12:33 INFO  Starting execution of 1 what-if analyses...
2022-09-21 05:12:33 INFO  Start plan generation for analysis PermutationFeatureImportance...
2022-09-21 05:12:33 INFO  ---RUNTIME: Plan generation took 0.12612342834472656 ms
2022-09-21 05:12:33 INFO  Estimated runtime of original DAG is 4846.517324447632ms
2022-09-21 05:12:33 INFO  Performing Multi-Query Optimization
2022-09-21 05:12:33 INFO  Estimated unoptimized what-if runtime is 24232.58662223816ms
2022-09-21 05:12:33 INFO  Estimated optimised what-if runtime is 6148.418664932251ms
2022-09-21 05:12:33 INFO  Estimated optimisation runtime saving is 18084.16795730591ms
2022-09-21 05:12:33 INFO  ---RUNTIME: Multi-Query Optimization took 9.502649307250977 ms
2022-09-21 05:12:33 INFO  Executing generated plans
2022-09-21 05:12:40 INFO  ---RUNTIME: Execution took 7078.630208969116 ms
2022-09-21 05:12:40 INFO  Done!
2022-09-21 05:12:40 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-21 05:12:40 INFO  Running instrumented original pipeline...
2022-09-21 05:12:40 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-21 05:12:40 INFO  ---RUNTIME: Importing and monkey-patching took 5.739450454711914 ms
2022-09-21 05:12:46 INFO  ---RUNTIME: Original pipeline execution took 6513.031244277954 ms (excluding imports and monkey-patching)
2022-09-21 05:12:46 INFO  Starting execution of 1 what-if analyses...
2022-09-21 05:12:46 INFO  Start plan generation for analysis PermutationFeatureImportance...
2022-09-21 05:12:46 INFO  ---RUNTIME: Plan generation took 0.10633468627929688 ms
2022-09-21 05:12:46 INFO  Estimated runtime of original DAG is 4816.026210784912ms
2022-09-21 05:12:46 WARNING Skipping Multi-Query Optimization (instead, only combine execution DAGs)
2022-09-21 05:12:46 INFO  Estimated unoptimised what-if runtime is 24080.13105392456ms
2022-09-21 05:12:46 INFO  ---RUNTIME: Multi-Query Optimization took 13.210773468017578 ms
2022-09-21 05:12:46 INFO  Executing generated plans
2022-09-21 05:13:15 INFO  ---RUNTIME: Execution took 28580.981254577637 ms
2022-09-21 05:13:15 INFO  Done!
2022-09-21 05:13:15 INFO  # Finished -- repetition 3 of 7 
2022-09-21 05:13:15 INFO  # Optimization benchmark for feature_importance with args [['reviews', 'fast_loading', 'featurization_0', 'logistic_regression']] -- repetition 4 of 7
2022-09-21 05:13:15 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-21 05:13:15 INFO  Running instrumented original pipeline...
2022-09-21 05:13:15 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-21 05:13:15 INFO  ---RUNTIME: Importing and monkey-patching took 5.683422088623047 ms
2022-09-21 05:13:22 INFO  ---RUNTIME: Original pipeline execution took 6792.553424835205 ms (excluding imports and monkey-patching)
2022-09-21 05:13:22 INFO  Starting execution of 1 what-if analyses...
2022-09-21 05:13:22 INFO  Start plan generation for analysis PermutationFeatureImportance...
2022-09-21 05:13:22 INFO  ---RUNTIME: Plan generation took 0.10085105895996094 ms
2022-09-21 05:13:22 INFO  Estimated runtime of original DAG is 4849.825382232666ms
2022-09-21 05:13:22 INFO  Performing Multi-Query Optimization
2022-09-21 05:13:22 INFO  Estimated unoptimized what-if runtime is 24249.12691116333ms
2022-09-21 05:13:22 INFO  Estimated optimised what-if runtime is 6159.479856491089ms
2022-09-21 05:13:22 INFO  Estimated optimisation runtime saving is 18089.64705467224ms
2022-09-21 05:13:22 INFO  ---RUNTIME: Multi-Query Optimization took 9.231805801391602 ms
2022-09-21 05:13:22 INFO  Executing generated plans
2022-09-21 05:13:29 INFO  ---RUNTIME: Execution took 7148.139953613281 ms
2022-09-21 05:13:29 INFO  Done!
2022-09-21 05:13:29 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-21 05:13:29 INFO  Running instrumented original pipeline...
2022-09-21 05:13:29 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-21 05:13:29 INFO  ---RUNTIME: Importing and monkey-patching took 5.839109420776367 ms
2022-09-21 05:13:35 INFO  ---RUNTIME: Original pipeline execution took 6588.083505630493 ms (excluding imports and monkey-patching)
2022-09-21 05:13:35 INFO  Starting execution of 1 what-if analyses...
2022-09-21 05:13:35 INFO  Start plan generation for analysis PermutationFeatureImportance...
2022-09-21 05:13:35 INFO  ---RUNTIME: Plan generation took 0.09751319885253906 ms
2022-09-21 05:13:35 INFO  Estimated runtime of original DAG is 4867.543697357178ms
2022-09-21 05:13:35 WARNING Skipping Multi-Query Optimization (instead, only combine execution DAGs)
2022-09-21 05:13:35 INFO  Estimated unoptimised what-if runtime is 24337.71848678589ms
2022-09-21 05:13:35 INFO  ---RUNTIME: Multi-Query Optimization took 13.29803466796875 ms
2022-09-21 05:13:35 INFO  Executing generated plans
2022-09-21 05:14:04 INFO  ---RUNTIME: Execution took 28862.895011901855 ms
2022-09-21 05:14:04 INFO  Done!
2022-09-21 05:14:04 INFO  # Finished -- repetition 4 of 7 
2022-09-21 05:14:04 INFO  # Optimization benchmark for feature_importance with args [['reviews', 'fast_loading', 'featurization_0', 'logistic_regression']] -- repetition 5 of 7
2022-09-21 05:14:04 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-21 05:14:04 INFO  Running instrumented original pipeline...
2022-09-21 05:14:04 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-21 05:14:04 INFO  ---RUNTIME: Importing and monkey-patching took 5.748987197875977 ms
2022-09-21 05:14:11 INFO  ---RUNTIME: Original pipeline execution took 6624.108552932739 ms (excluding imports and monkey-patching)
2022-09-21 05:14:11 INFO  Starting execution of 1 what-if analyses...
2022-09-21 05:14:11 INFO  Start plan generation for analysis PermutationFeatureImportance...
2022-09-21 05:14:11 INFO  ---RUNTIME: Plan generation took 0.22745132446289062 ms
2022-09-21 05:14:11 INFO  Estimated runtime of original DAG is 4889.99342918396ms
2022-09-21 05:14:11 INFO  Performing Multi-Query Optimization
2022-09-21 05:14:11 INFO  Estimated unoptimized what-if runtime is 24449.9671459198ms
2022-09-21 05:14:11 INFO  Estimated optimised what-if runtime is 6205.420970916748ms
2022-09-21 05:14:11 INFO  Estimated optimisation runtime saving is 18244.54617500305ms
2022-09-21 05:14:11 INFO  ---RUNTIME: Multi-Query Optimization took 14.481544494628906 ms
2022-09-21 05:14:11 INFO  Executing generated plans
2022-09-21 05:14:18 INFO  ---RUNTIME: Execution took 7177.836656570435 ms
2022-09-21 05:14:18 INFO  Done!
2022-09-21 05:14:18 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-21 05:14:18 INFO  Running instrumented original pipeline...
2022-09-21 05:14:18 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-21 05:14:18 INFO  ---RUNTIME: Importing and monkey-patching took 6.092548370361328 ms
2022-09-21 05:14:25 INFO  ---RUNTIME: Original pipeline execution took 6541.191816329956 ms (excluding imports and monkey-patching)
2022-09-21 05:14:25 INFO  Starting execution of 1 what-if analyses...
2022-09-21 05:14:25 INFO  Start plan generation for analysis PermutationFeatureImportance...
2022-09-21 05:14:25 INFO  ---RUNTIME: Plan generation took 0.1499652862548828 ms
2022-09-21 05:14:25 INFO  Estimated runtime of original DAG is 4830.754280090332ms
2022-09-21 05:14:25 WARNING Skipping Multi-Query Optimization (instead, only combine execution DAGs)
2022-09-21 05:14:25 INFO  Estimated unoptimised what-if runtime is 24153.77140045166ms
2022-09-21 05:14:25 INFO  ---RUNTIME: Multi-Query Optimization took 20.25461196899414 ms
2022-09-21 05:14:25 INFO  Executing generated plans
2022-09-21 05:14:53 INFO  ---RUNTIME: Execution took 28552.57773399353 ms
2022-09-21 05:14:53 INFO  Done!
2022-09-21 05:14:53 INFO  # Finished -- repetition 5 of 7 
2022-09-21 05:14:53 INFO  # Optimization benchmark for feature_importance with args [['reviews', 'fast_loading', 'featurization_0', 'logistic_regression']] -- repetition 6 of 7
2022-09-21 05:14:53 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-21 05:14:53 INFO  Running instrumented original pipeline...
2022-09-21 05:14:53 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-21 05:14:53 INFO  ---RUNTIME: Importing and monkey-patching took 5.77235221862793 ms
2022-09-21 05:15:00 INFO  ---RUNTIME: Original pipeline execution took 6599.884033203125 ms (excluding imports and monkey-patching)
2022-09-21 05:15:00 INFO  Starting execution of 1 what-if analyses...
2022-09-21 05:15:00 INFO  Start plan generation for analysis PermutationFeatureImportance...
2022-09-21 05:15:00 INFO  ---RUNTIME: Plan generation took 0.11777877807617188 ms
2022-09-21 05:15:00 INFO  Estimated runtime of original DAG is 4888.30304145813ms
2022-09-21 05:15:00 INFO  Performing Multi-Query Optimization
2022-09-21 05:15:00 INFO  Estimated unoptimized what-if runtime is 24441.51520729065ms
2022-09-21 05:15:00 INFO  Estimated optimised what-if runtime is 6247.314453125ms
2022-09-21 05:15:00 INFO  Estimated optimisation runtime saving is 18194.20075416565ms
2022-09-21 05:15:00 INFO  ---RUNTIME: Multi-Query Optimization took 9.40084457397461 ms
2022-09-21 05:15:00 INFO  Executing generated plans
2022-09-21 05:15:07 INFO  ---RUNTIME: Execution took 7123.735189437866 ms
2022-09-21 05:15:07 INFO  Done!
2022-09-21 05:15:07 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-21 05:15:07 INFO  Running instrumented original pipeline...
2022-09-21 05:15:07 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-21 05:15:07 INFO  ---RUNTIME: Importing and monkey-patching took 5.777835845947266 ms
2022-09-21 05:15:14 INFO  ---RUNTIME: Original pipeline execution took 6719.656705856323 ms (excluding imports and monkey-patching)
2022-09-21 05:15:14 INFO  Starting execution of 1 what-if analyses...
2022-09-21 05:15:14 INFO  Start plan generation for analysis PermutationFeatureImportance...
2022-09-21 05:15:14 INFO  ---RUNTIME: Plan generation took 0.12087821960449219 ms
2022-09-21 05:15:14 INFO  Estimated runtime of original DAG is 5027.129411697388ms
2022-09-21 05:15:14 WARNING Skipping Multi-Query Optimization (instead, only combine execution DAGs)
2022-09-21 05:15:14 INFO  Estimated unoptimised what-if runtime is 25135.64705848694ms
2022-09-21 05:15:14 INFO  ---RUNTIME: Multi-Query Optimization took 13.300657272338867 ms
2022-09-21 05:15:14 INFO  Executing generated plans
2022-09-21 05:15:44 INFO  ---RUNTIME: Execution took 30345.722675323486 ms
2022-09-21 05:15:44 INFO  Done!
2022-09-21 05:15:44 INFO  # Finished -- repetition 6 of 7 
2022-09-21 05:15:44 INFO  # Optimization benchmark for feature_importance with args [['reviews', 'fast_loading', 'featurization_0', 'logistic_regression']] -- repetition 7 of 7
2022-09-21 05:15:44 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-21 05:15:44 INFO  Running instrumented original pipeline...
2022-09-21 05:15:44 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-21 05:15:44 INFO  ---RUNTIME: Importing and monkey-patching took 6.656169891357422 ms
2022-09-21 05:15:51 INFO  ---RUNTIME: Original pipeline execution took 6917.1435832977295 ms (excluding imports and monkey-patching)
2022-09-21 05:15:51 INFO  Starting execution of 1 what-if analyses...
2022-09-21 05:15:51 INFO  Start plan generation for analysis PermutationFeatureImportance...
2022-09-21 05:15:51 INFO  ---RUNTIME: Plan generation took 0.10824203491210938 ms
2022-09-21 05:15:51 INFO  Estimated runtime of original DAG is 5121.185064315796ms
2022-09-21 05:15:51 INFO  Performing Multi-Query Optimization
2022-09-21 05:15:51 INFO  Estimated unoptimized what-if runtime is 25605.92532157898ms
2022-09-21 05:15:51 INFO  Estimated optimised what-if runtime is 6502.777576446533ms
2022-09-21 05:15:51 INFO  Estimated optimisation runtime saving is 19103.147745132446ms
2022-09-21 05:15:51 INFO  ---RUNTIME: Multi-Query Optimization took 10.812044143676758 ms
2022-09-21 05:15:51 INFO  Executing generated plans
2022-09-21 05:15:59 INFO  ---RUNTIME: Execution took 7514.406442642212 ms
2022-09-21 05:15:59 INFO  Done!
2022-09-21 05:15:59 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-21 05:15:59 INFO  Running instrumented original pipeline...
2022-09-21 05:15:59 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-21 05:15:59 INFO  ---RUNTIME: Importing and monkey-patching took 6.497383117675781 ms
2022-09-21 05:16:06 INFO  ---RUNTIME: Original pipeline execution took 6909.121751785278 ms (excluding imports and monkey-patching)
2022-09-21 05:16:06 INFO  Starting execution of 1 what-if analyses...
2022-09-21 05:16:06 INFO  Start plan generation for analysis PermutationFeatureImportance...
2022-09-21 05:16:06 INFO  ---RUNTIME: Plan generation took 0.12040138244628906 ms
2022-09-21 05:16:06 INFO  Estimated runtime of original DAG is 5146.386623382568ms
2022-09-21 05:16:06 WARNING Skipping Multi-Query Optimization (instead, only combine execution DAGs)
2022-09-21 05:16:06 INFO  Estimated unoptimised what-if runtime is 25731.93311691284ms
2022-09-21 05:16:06 INFO  ---RUNTIME: Multi-Query Optimization took 14.09602165222168 ms
2022-09-21 05:16:06 INFO  Executing generated plans
2022-09-21 05:16:35 INFO  ---RUNTIME: Execution took 29880.000114440918 ms
2022-09-21 05:16:35 INFO  Done!
2022-09-21 05:16:35 INFO  # Finished -- repetition 7 of 7 
2022-09-21 05:16:35 INFO  # Final results after all repetitions
2022-09-21 05:16:35 INFO     repetition  ... no_opt_what_if_execution_combined_model_training
0           0  ...                                       841.992617
1           1  ...                                       841.793537
2           2  ...                                       841.087580
3           3  ...                                       869.827747
4           4  ...                                       865.749836
5           5  ...                                       866.334438
6           6  ...                                       886.469126

[7 rows x 26 columns]
taskset -c 32-40 PROTOCOL_BUFFERS_PYTHON_IMPLEMENTATION=python python3.9 benchmarks_end_to_end.py feature_importance reviews fast_loading featurization_0 xgboost
2022-09-21 05:16:38.518967: W tensorflow/stream_executor/platform/default/dso_loader.cc:64] Could not load dynamic library 'libcudart.so.11.0'; dlerror: libcudart.so.11.0: cannot open shared object file: No such file or directory; LD_LIBRARY_PATH: /home/sgrafbe/mlwhatif/venv/lib/python3.9/site-packages/cv2/../../lib64:
2022-09-21 05:16:38.519009: I tensorflow/stream_executor/cuda/cudart_stub.cc:29] Ignore above cudart dlerror if you do not have a GPU set up on your machine.
2022-09-21 05:16:39 INFO  Patching sys.argv with ['mlwhatif', 'reviews', 'fast_loading', 'featurization_0', 'xgboost']
2022-09-21 05:16:39 INFO  Running instrumented original pipeline...
2022-09-21 05:16:39 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-21 05:16:40 INFO  ---RUNTIME: Importing and monkey-patching took 131.47544860839844 ms
2022-09-21 05:16:47 INFO  ---RUNTIME: Original pipeline execution took 7784.6174240112305 ms (excluding imports and monkey-patching)
2022-09-21 05:16:47 INFO  Starting execution of 0 what-if analyses...
2022-09-21 05:16:47 INFO  Estimated runtime of original DAG is 5951.8609046936035ms
2022-09-21 05:16:47 INFO  Performing Multi-Query Optimization
2022-09-21 05:16:47 INFO  Estimated unoptimized what-if runtime is 0ms
2022-09-21 05:16:47 INFO  Estimated optimised what-if runtime is 0ms
2022-09-21 05:16:47 INFO  Estimated optimisation runtime saving is 0ms
2022-09-21 05:16:47 INFO  ---RUNTIME: Multi-Query Optimization took 0.5486011505126953 ms
2022-09-21 05:16:47 INFO  Executing generated plans
2022-09-21 05:16:47 INFO  ---RUNTIME: Execution took 0.024318695068359375 ms
2022-09-21 05:16:47 INFO  Done!
2022-09-21 05:16:47 INFO  # Optimization benchmark for feature_importance with args [['reviews', 'fast_loading', 'featurization_0', 'xgboost']] -- repetition 1 of 7
2022-09-21 05:16:47 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-21 05:16:47 INFO  Running instrumented original pipeline...
2022-09-21 05:16:48 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-21 05:16:48 INFO  ---RUNTIME: Importing and monkey-patching took 5.599737167358398 ms
2022-09-21 05:16:55 INFO  ---RUNTIME: Original pipeline execution took 7306.879758834839 ms (excluding imports and monkey-patching)
2022-09-21 05:16:55 INFO  Starting execution of 1 what-if analyses...
2022-09-21 05:16:55 INFO  Start plan generation for analysis PermutationFeatureImportance...
2022-09-21 05:16:55 INFO  ---RUNTIME: Plan generation took 0.14710426330566406 ms
2022-09-21 05:16:55 INFO  Estimated runtime of original DAG is 5496.146440505981ms
2022-09-21 05:16:55 INFO  Performing Multi-Query Optimization
2022-09-21 05:16:55 INFO  Estimated unoptimized what-if runtime is 27480.732202529907ms
2022-09-21 05:16:55 INFO  Estimated optimised what-if runtime is 6968.397617340088ms
2022-09-21 05:16:55 INFO  Estimated optimisation runtime saving is 20512.33458518982ms
2022-09-21 05:16:55 INFO  ---RUNTIME: Multi-Query Optimization took 9.60230827331543 ms
2022-09-21 05:16:55 INFO  Executing generated plans
2022-09-21 05:17:03 INFO  ---RUNTIME: Execution took 8040.354251861572 ms
2022-09-21 05:17:03 INFO  Done!
2022-09-21 05:17:03 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-21 05:17:03 INFO  Running instrumented original pipeline...
2022-09-21 05:17:03 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-21 05:17:03 INFO  ---RUNTIME: Importing and monkey-patching took 6.111860275268555 ms
2022-09-21 05:17:10 INFO  ---RUNTIME: Original pipeline execution took 7173.975467681885 ms (excluding imports and monkey-patching)
2022-09-21 05:17:10 INFO  Starting execution of 1 what-if analyses...
2022-09-21 05:17:10 INFO  Start plan generation for analysis PermutationFeatureImportance...
2022-09-21 05:17:10 INFO  ---RUNTIME: Plan generation took 0.1380443572998047 ms
2022-09-21 05:17:10 INFO  Estimated runtime of original DAG is 5527.7698040008545ms
2022-09-21 05:17:10 WARNING Skipping Multi-Query Optimization (instead, only combine execution DAGs)
2022-09-21 05:17:10 INFO  Estimated unoptimised what-if runtime is 27638.849020004272ms
2022-09-21 05:17:10 INFO  ---RUNTIME: Multi-Query Optimization took 14.150142669677734 ms
2022-09-21 05:17:10 INFO  Executing generated plans
2022-09-21 05:18:18 INFO  ---RUNTIME: Execution took 68269.96684074402 ms
2022-09-21 05:18:18 INFO  Done!
2022-09-21 05:18:18 INFO  # Finished -- repetition 1 of 7 
2022-09-21 05:18:18 INFO  # Optimization benchmark for feature_importance with args [['reviews', 'fast_loading', 'featurization_0', 'xgboost']] -- repetition 2 of 7
2022-09-21 05:18:18 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-21 05:18:18 INFO  Running instrumented original pipeline...
2022-09-21 05:18:18 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-21 05:18:18 INFO  ---RUNTIME: Importing and monkey-patching took 6.237030029296875 ms
2022-09-21 05:18:25 INFO  ---RUNTIME: Original pipeline execution took 7056.092739105225 ms (excluding imports and monkey-patching)
2022-09-21 05:18:25 INFO  Starting execution of 1 what-if analyses...
2022-09-21 05:18:25 INFO  Start plan generation for analysis PermutationFeatureImportance...
2022-09-21 05:18:25 INFO  ---RUNTIME: Plan generation took 0.11849403381347656 ms
2022-09-21 05:18:25 INFO  Estimated runtime of original DAG is 5400.940656661987ms
2022-09-21 05:18:25 INFO  Performing Multi-Query Optimization
2022-09-21 05:18:25 INFO  Estimated unoptimized what-if runtime is 27004.703283309937ms
2022-09-21 05:18:25 INFO  Estimated optimised what-if runtime is 6864.441394805908ms
2022-09-21 05:18:25 INFO  Estimated optimisation runtime saving is 20140.26188850403ms
2022-09-21 05:18:25 INFO  ---RUNTIME: Multi-Query Optimization took 9.307146072387695 ms
2022-09-21 05:18:25 INFO  Executing generated plans
2022-09-21 05:18:33 INFO  ---RUNTIME: Execution took 7725.071907043457 ms
2022-09-21 05:18:33 INFO  Done!
2022-09-21 05:18:33 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-21 05:18:33 INFO  Running instrumented original pipeline...
2022-09-21 05:18:33 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-21 05:18:33 INFO  ---RUNTIME: Importing and monkey-patching took 5.824089050292969 ms
2022-09-21 05:18:40 INFO  ---RUNTIME: Original pipeline execution took 7042.3455238342285 ms (excluding imports and monkey-patching)
2022-09-21 05:18:40 INFO  Starting execution of 1 what-if analyses...
2022-09-21 05:18:40 INFO  Start plan generation for analysis PermutationFeatureImportance...
2022-09-21 05:18:40 INFO  ---RUNTIME: Plan generation took 0.1125335693359375 ms
2022-09-21 05:18:40 INFO  Estimated runtime of original DAG is 5372.560977935791ms
2022-09-21 05:18:40 WARNING Skipping Multi-Query Optimization (instead, only combine execution DAGs)
2022-09-21 05:18:40 INFO  Estimated unoptimised what-if runtime is 26862.804889678955ms
2022-09-21 05:18:40 INFO  ---RUNTIME: Multi-Query Optimization took 13.300657272338867 ms
2022-09-21 05:18:40 INFO  Executing generated plans
2022-09-21 05:19:51 INFO  ---RUNTIME: Execution took 70896.20447158813 ms
2022-09-21 05:19:51 INFO  Done!
2022-09-21 05:19:51 INFO  # Finished -- repetition 2 of 7 
2022-09-21 05:19:51 INFO  # Optimization benchmark for feature_importance with args [['reviews', 'fast_loading', 'featurization_0', 'xgboost']] -- repetition 3 of 7
2022-09-21 05:19:51 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-21 05:19:51 INFO  Running instrumented original pipeline...
2022-09-21 05:19:51 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-21 05:19:51 INFO  ---RUNTIME: Importing and monkey-patching took 6.181001663208008 ms
2022-09-21 05:19:58 INFO  ---RUNTIME: Original pipeline execution took 7141.086578369141 ms (excluding imports and monkey-patching)
2022-09-21 05:19:58 INFO  Starting execution of 1 what-if analyses...
2022-09-21 05:19:58 INFO  Start plan generation for analysis PermutationFeatureImportance...
2022-09-21 05:19:58 INFO  ---RUNTIME: Plan generation took 0.11348724365234375 ms
2022-09-21 05:19:58 INFO  Estimated runtime of original DAG is 5464.918851852417ms
2022-09-21 05:19:58 INFO  Performing Multi-Query Optimization
2022-09-21 05:19:58 INFO  Estimated unoptimized what-if runtime is 27324.594259262085ms
2022-09-21 05:19:58 INFO  Estimated optimised what-if runtime is 6925.105333328247ms
2022-09-21 05:19:58 INFO  Estimated optimisation runtime saving is 20399.488925933838ms
2022-09-21 05:19:58 INFO  ---RUNTIME: Multi-Query Optimization took 9.300708770751953 ms
2022-09-21 05:19:58 INFO  Executing generated plans
2022-09-21 05:20:06 INFO  ---RUNTIME: Execution took 7793.193101882935 ms
2022-09-21 05:20:06 INFO  Done!
2022-09-21 05:20:06 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-21 05:20:06 INFO  Running instrumented original pipeline...
2022-09-21 05:20:06 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-21 05:20:06 INFO  ---RUNTIME: Importing and monkey-patching took 5.605936050415039 ms
2022-09-21 05:20:13 INFO  ---RUNTIME: Original pipeline execution took 7108.999013900757 ms (excluding imports and monkey-patching)
2022-09-21 05:20:13 INFO  Starting execution of 1 what-if analyses...
2022-09-21 05:20:13 INFO  Start plan generation for analysis PermutationFeatureImportance...
2022-09-21 05:20:13 INFO  ---RUNTIME: Plan generation took 0.09942054748535156 ms
2022-09-21 05:20:13 INFO  Estimated runtime of original DAG is 5430.339813232422ms
2022-09-21 05:20:13 WARNING Skipping Multi-Query Optimization (instead, only combine execution DAGs)
2022-09-21 05:20:13 INFO  Estimated unoptimised what-if runtime is 27151.69906616211ms
2022-09-21 05:20:13 INFO  ---RUNTIME: Multi-Query Optimization took 13.237476348876953 ms
2022-09-21 05:20:13 INFO  Executing generated plans
2022-09-21 05:20:44 INFO  ---RUNTIME: Execution took 31352.20241546631 ms
2022-09-21 05:20:44 INFO  Done!
2022-09-21 05:20:44 INFO  # Finished -- repetition 3 of 7 
2022-09-21 05:20:44 INFO  # Optimization benchmark for feature_importance with args [['reviews', 'fast_loading', 'featurization_0', 'xgboost']] -- repetition 4 of 7
2022-09-21 05:20:44 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-21 05:20:44 INFO  Running instrumented original pipeline...
2022-09-21 05:20:44 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-21 05:20:44 INFO  ---RUNTIME: Importing and monkey-patching took 6.200313568115234 ms
2022-09-21 05:20:52 INFO  ---RUNTIME: Original pipeline execution took 7391.145944595337 ms (excluding imports and monkey-patching)
2022-09-21 05:20:52 INFO  Starting execution of 1 what-if analyses...
2022-09-21 05:20:52 INFO  Start plan generation for analysis PermutationFeatureImportance...
2022-09-21 05:20:52 INFO  ---RUNTIME: Plan generation took 0.09584426879882812 ms
2022-09-21 05:20:52 INFO  Estimated runtime of original DAG is 5457.971811294556ms
2022-09-21 05:20:52 INFO  Performing Multi-Query Optimization
2022-09-21 05:20:52 INFO  Estimated unoptimized what-if runtime is 27289.85905647278ms
2022-09-21 05:20:52 INFO  Estimated optimised what-if runtime is 6957.119941711426ms
2022-09-21 05:20:52 INFO  Estimated optimisation runtime saving is 20332.739114761353ms
2022-09-21 05:20:52 INFO  ---RUNTIME: Multi-Query Optimization took 9.297370910644531 ms
2022-09-21 05:20:52 INFO  Executing generated plans
2022-09-21 05:21:00 INFO  ---RUNTIME: Execution took 7846.92120552063 ms
2022-09-21 05:21:00 INFO  Done!
2022-09-21 05:21:00 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-21 05:21:00 INFO  Running instrumented original pipeline...
2022-09-21 05:21:00 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-21 05:21:00 INFO  ---RUNTIME: Importing and monkey-patching took 5.718231201171875 ms
2022-09-21 05:21:07 INFO  ---RUNTIME: Original pipeline execution took 7154.948472976685 ms (excluding imports and monkey-patching)
2022-09-21 05:21:07 INFO  Starting execution of 1 what-if analyses...
2022-09-21 05:21:07 INFO  Start plan generation for analysis PermutationFeatureImportance...
2022-09-21 05:21:07 INFO  ---RUNTIME: Plan generation took 0.09632110595703125 ms
2022-09-21 05:21:07 INFO  Estimated runtime of original DAG is 5450.897455215454ms
2022-09-21 05:21:07 WARNING Skipping Multi-Query Optimization (instead, only combine execution DAGs)
2022-09-21 05:21:07 INFO  Estimated unoptimised what-if runtime is 27254.48727607727ms
2022-09-21 05:21:07 INFO  ---RUNTIME: Multi-Query Optimization took 13.204813003540039 ms
2022-09-21 05:21:07 INFO  Executing generated plans
2022-09-21 05:21:38 INFO  ---RUNTIME: Execution took 31497.111558914185 ms
2022-09-21 05:21:38 INFO  Done!
2022-09-21 05:21:38 INFO  # Finished -- repetition 4 of 7 
2022-09-21 05:21:38 INFO  # Optimization benchmark for feature_importance with args [['reviews', 'fast_loading', 'featurization_0', 'xgboost']] -- repetition 5 of 7
2022-09-21 05:21:38 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-21 05:21:38 INFO  Running instrumented original pipeline...
2022-09-21 05:21:38 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-21 05:21:38 INFO  ---RUNTIME: Importing and monkey-patching took 6.150007247924805 ms
2022-09-21 05:21:46 INFO  ---RUNTIME: Original pipeline execution took 7220.508098602295 ms (excluding imports and monkey-patching)
2022-09-21 05:21:46 INFO  Starting execution of 1 what-if analyses...
2022-09-21 05:21:46 INFO  Start plan generation for analysis PermutationFeatureImportance...
2022-09-21 05:21:46 INFO  ---RUNTIME: Plan generation took 0.12230873107910156 ms
2022-09-21 05:21:46 INFO  Estimated runtime of original DAG is 5486.862421035767ms
2022-09-21 05:21:46 INFO  Performing Multi-Query Optimization
2022-09-21 05:21:46 INFO  Estimated unoptimized what-if runtime is 27434.312105178833ms
2022-09-21 05:21:46 INFO  Estimated optimised what-if runtime is 6958.163022994995ms
2022-09-21 05:21:46 INFO  Estimated optimisation runtime saving is 20476.149082183838ms
2022-09-21 05:21:46 INFO  ---RUNTIME: Multi-Query Optimization took 9.382009506225586 ms
2022-09-21 05:21:46 INFO  Executing generated plans
2022-09-21 05:21:53 INFO  ---RUNTIME: Execution took 7875.293016433716 ms
2022-09-21 05:21:53 INFO  Done!
2022-09-21 05:21:53 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-21 05:21:53 INFO  Running instrumented original pipeline...
2022-09-21 05:21:53 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-21 05:21:53 INFO  ---RUNTIME: Importing and monkey-patching took 5.71131706237793 ms
2022-09-21 05:22:01 INFO  ---RUNTIME: Original pipeline execution took 7191.398143768311 ms (excluding imports and monkey-patching)
2022-09-21 05:22:01 INFO  Starting execution of 1 what-if analyses...
2022-09-21 05:22:01 INFO  Start plan generation for analysis PermutationFeatureImportance...
2022-09-21 05:22:01 INFO  ---RUNTIME: Plan generation took 0.09465217590332031 ms
2022-09-21 05:22:01 INFO  Estimated runtime of original DAG is 5472.636699676514ms
2022-09-21 05:22:01 WARNING Skipping Multi-Query Optimization (instead, only combine execution DAGs)
2022-09-21 05:22:01 INFO  Estimated unoptimised what-if runtime is 27363.18349838257ms
2022-09-21 05:22:01 INFO  ---RUNTIME: Multi-Query Optimization took 13.098955154418945 ms
2022-09-21 05:22:01 INFO  Executing generated plans
2022-09-21 05:22:32 INFO  ---RUNTIME: Execution took 31474.308252334595 ms
2022-09-21 05:22:32 INFO  Done!
2022-09-21 05:22:32 INFO  # Finished -- repetition 5 of 7 
2022-09-21 05:22:32 INFO  # Optimization benchmark for feature_importance with args [['reviews', 'fast_loading', 'featurization_0', 'xgboost']] -- repetition 6 of 7
2022-09-21 05:22:32 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-21 05:22:32 INFO  Running instrumented original pipeline...
2022-09-21 05:22:32 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-21 05:22:32 INFO  ---RUNTIME: Importing and monkey-patching took 5.6972503662109375 ms
2022-09-21 05:22:40 INFO  ---RUNTIME: Original pipeline execution took 7703.623294830322 ms (excluding imports and monkey-patching)
2022-09-21 05:22:40 INFO  Starting execution of 1 what-if analyses...
2022-09-21 05:22:40 INFO  Start plan generation for analysis PermutationFeatureImportance...
2022-09-21 05:22:40 INFO  ---RUNTIME: Plan generation took 0.1323223114013672 ms
2022-09-21 05:22:40 INFO  Estimated runtime of original DAG is 5881.120681762695ms
2022-09-21 05:22:40 INFO  Performing Multi-Query Optimization
2022-09-21 05:22:40 INFO  Estimated unoptimized what-if runtime is 29405.603408813477ms
2022-09-21 05:22:40 INFO  Estimated optimised what-if runtime is 7439.078807830811ms
2022-09-21 05:22:40 INFO  Estimated optimisation runtime saving is 21966.524600982666ms
2022-09-21 05:22:40 INFO  ---RUNTIME: Multi-Query Optimization took 10.073184967041016 ms
2022-09-21 05:22:40 INFO  Executing generated plans
2022-09-21 05:22:50 INFO  ---RUNTIME: Execution took 9833.241939544678 ms
2022-09-21 05:22:50 INFO  Done!
2022-09-21 05:22:50 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-21 05:22:50 INFO  Running instrumented original pipeline...
2022-09-21 05:22:50 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-21 05:22:50 INFO  ---RUNTIME: Importing and monkey-patching took 6.718158721923828 ms
2022-09-21 05:24:03 INFO  ---RUNTIME: Original pipeline execution took 73026.66878700256 ms (excluding imports and monkey-patching)
2022-09-21 05:24:03 INFO  Starting execution of 1 what-if analyses...
2022-09-21 05:24:03 INFO  Start plan generation for analysis PermutationFeatureImportance...
2022-09-21 05:24:03 INFO  ---RUNTIME: Plan generation took 0.15592575073242188 ms
2022-09-21 05:24:03 INFO  Estimated runtime of original DAG is 71214.10536766052ms
2022-09-21 05:24:03 WARNING Skipping Multi-Query Optimization (instead, only combine execution DAGs)
2022-09-21 05:24:03 INFO  Estimated unoptimised what-if runtime is 356070.5268383026ms
2022-09-21 05:24:03 INFO  ---RUNTIME: Multi-Query Optimization took 14.100790023803711 ms
2022-09-21 05:24:03 INFO  Executing generated plans
2022-09-21 05:25:32 INFO  ---RUNTIME: Execution took 89061.7504119873 ms
2022-09-21 05:25:32 INFO  Done!
2022-09-21 05:25:32 INFO  # Finished -- repetition 6 of 7 
2022-09-21 05:25:32 INFO  # Optimization benchmark for feature_importance with args [['reviews', 'fast_loading', 'featurization_0', 'xgboost']] -- repetition 7 of 7
2022-09-21 05:25:32 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-21 05:25:32 INFO  Running instrumented original pipeline...
2022-09-21 05:25:32 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-21 05:25:32 INFO  ---RUNTIME: Importing and monkey-patching took 6.376743316650391 ms
2022-09-21 05:25:39 INFO  ---RUNTIME: Original pipeline execution took 7119.821786880493 ms (excluding imports and monkey-patching)
2022-09-21 05:25:39 INFO  Starting execution of 1 what-if analyses...
2022-09-21 05:25:39 INFO  Start plan generation for analysis PermutationFeatureImportance...
2022-09-21 05:25:39 INFO  ---RUNTIME: Plan generation took 0.12230873107910156 ms
2022-09-21 05:25:39 INFO  Estimated runtime of original DAG is 5433.158159255981ms
2022-09-21 05:25:39 INFO  Performing Multi-Query Optimization
2022-09-21 05:25:39 INFO  Estimated unoptimized what-if runtime is 27165.790796279907ms
2022-09-21 05:25:39 INFO  Estimated optimised what-if runtime is 6893.460035324097ms
2022-09-21 05:25:39 INFO  Estimated optimisation runtime saving is 20272.33076095581ms
2022-09-21 05:25:39 INFO  ---RUNTIME: Multi-Query Optimization took 9.458541870117188 ms
2022-09-21 05:25:39 INFO  Executing generated plans
2022-09-21 05:25:47 INFO  ---RUNTIME: Execution took 7751.588582992554 ms
2022-09-21 05:25:47 INFO  Done!
2022-09-21 05:25:47 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-21 05:25:47 INFO  Running instrumented original pipeline...
2022-09-21 05:25:47 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-21 05:25:47 INFO  ---RUNTIME: Importing and monkey-patching took 5.719900131225586 ms
2022-09-21 05:25:54 INFO  ---RUNTIME: Original pipeline execution took 7043.152570724487 ms (excluding imports and monkey-patching)
2022-09-21 05:25:54 INFO  Starting execution of 1 what-if analyses...
2022-09-21 05:25:54 INFO  Start plan generation for analysis PermutationFeatureImportance...
2022-09-21 05:25:54 INFO  ---RUNTIME: Plan generation took 0.10466575622558594 ms
2022-09-21 05:25:54 INFO  Estimated runtime of original DAG is 5354.94327545166ms
2022-09-21 05:25:54 WARNING Skipping Multi-Query Optimization (instead, only combine execution DAGs)
2022-09-21 05:25:54 INFO  Estimated unoptimised what-if runtime is 26774.7163772583ms
2022-09-21 05:25:54 INFO  ---RUNTIME: Multi-Query Optimization took 13.018369674682617 ms
2022-09-21 05:25:54 INFO  Executing generated plans
2022-09-21 05:26:25 INFO  ---RUNTIME: Execution took 31118.75867843628 ms
2022-09-21 05:26:25 INFO  Done!
2022-09-21 05:26:25 INFO  # Finished -- repetition 7 of 7 
2022-09-21 05:26:25 INFO  # Final results after all repetitions
2022-09-21 05:26:25 INFO     repetition  ... no_opt_what_if_execution_combined_model_training
0           0  ...                                     40060.637712
1           1  ...                                     43304.581642
2           2  ...                                      3633.255482
3           3  ...                                      3659.995317
4           4  ...                                      3776.012182
5           5  ...                                     61277.210474
6           6  ...                                      3573.092222

[7 rows x 26 columns]
taskset -c 32-40 PROTOCOL_BUFFERS_PYTHON_IMPLEMENTATION=python python3.9 benchmarks_end_to_end.py feature_importance reviews fast_loading featurization_0 neural_network
2022-09-21 05:26:27.608626: W tensorflow/stream_executor/platform/default/dso_loader.cc:64] Could not load dynamic library 'libcudart.so.11.0'; dlerror: libcudart.so.11.0: cannot open shared object file: No such file or directory; LD_LIBRARY_PATH: /home/sgrafbe/mlwhatif/venv/lib/python3.9/site-packages/cv2/../../lib64:
2022-09-21 05:26:27.608677: I tensorflow/stream_executor/cuda/cudart_stub.cc:29] Ignore above cudart dlerror if you do not have a GPU set up on your machine.
2022-09-21 05:26:28 INFO  Patching sys.argv with ['mlwhatif', 'reviews', 'fast_loading', 'featurization_0', 'neural_network']
2022-09-21 05:26:28 INFO  Running instrumented original pipeline...
2022-09-21 05:26:28 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-21 05:26:29 INFO  ---RUNTIME: Importing and monkey-patching took 121.04606628417969 ms
2022-09-21 05:26:34.094152: W tensorflow/stream_executor/platform/default/dso_loader.cc:64] Could not load dynamic library 'libcuda.so.1'; dlerror: libcuda.so.1: cannot open shared object file: No such file or directory; LD_LIBRARY_PATH: /home/sgrafbe/mlwhatif/venv/lib/python3.9/site-packages/cv2/../../lib64:
2022-09-21 05:26:34.094191: W tensorflow/stream_executor/cuda/cuda_driver.cc:326] failed call to cuInit: UNKNOWN ERROR (303)
2022-09-21 05:26:34.094216: I tensorflow/stream_executor/cuda/cuda_diagnostics.cc:156] kernel driver does not appear to be running on this host (angus): /proc/driver/nvidia/version does not exist
2022-09-21 05:26:34.094736: I tensorflow/core/platform/cpu_feature_guard.cc:142] This TensorFlow binary is optimized with oneAPI Deep Neural Network Library (oneDNN) to use the following CPU instructions in performance-critical operations:  AVX2 FMA
To enable them in other operations, rebuild TensorFlow with the appropriate compiler flags.
2022-09-21 05:26:34.349370: I tensorflow/compiler/mlir/mlir_graph_optimization_pass.cc:176] None of the MLIR Optimization Passes are enabled (registered 2)
2022-09-21 05:26:34.361189: I tensorflow/core/platform/profile_utils/cpu_utils.cc:114] CPU Frequency: 2595130000 Hz
2022-09-21 05:26:39 INFO  ---RUNTIME: Original pipeline execution took 10085.267305374146 ms (excluding imports and monkey-patching)
2022-09-21 05:26:39 INFO  Starting execution of 0 what-if analyses...
2022-09-21 05:26:39 INFO  Estimated runtime of original DAG is 8417.802333831787ms
2022-09-21 05:26:39 INFO  Performing Multi-Query Optimization
2022-09-21 05:26:39 INFO  Estimated unoptimized what-if runtime is 0ms
2022-09-21 05:26:39 INFO  Estimated optimised what-if runtime is 0ms
2022-09-21 05:26:39 INFO  Estimated optimisation runtime saving is 0ms
2022-09-21 05:26:39 INFO  ---RUNTIME: Multi-Query Optimization took 0.5025863647460938 ms
2022-09-21 05:26:39 INFO  Executing generated plans
2022-09-21 05:26:39 INFO  ---RUNTIME: Execution took 0.024557113647460938 ms
2022-09-21 05:26:39 INFO  Done!
2022-09-21 05:26:39 INFO  # Optimization benchmark for feature_importance with args [['reviews', 'fast_loading', 'featurization_0', 'neural_network']] -- repetition 1 of 7
2022-09-21 05:26:39 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-21 05:26:39 INFO  Running instrumented original pipeline...
2022-09-21 05:26:39 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-21 05:26:39 INFO  ---RUNTIME: Importing and monkey-patching took 5.43522834777832 ms
2022-09-21 05:26:48 INFO  ---RUNTIME: Original pipeline execution took 9824.303150177002 ms (excluding imports and monkey-patching)
2022-09-21 05:26:48 INFO  Starting execution of 1 what-if analyses...
2022-09-21 05:26:48 INFO  Start plan generation for analysis PermutationFeatureImportance...
2022-09-21 05:26:48 INFO  ---RUNTIME: Plan generation took 0.19168853759765625 ms
2022-09-21 05:26:48 INFO  Estimated runtime of original DAG is 8187.695264816284ms
2022-09-21 05:26:48 INFO  Performing Multi-Query Optimization
2022-09-21 05:26:48 INFO  Estimated unoptimized what-if runtime is 40938.47632408142ms
2022-09-21 05:26:48 INFO  Estimated optimised what-if runtime is 11020.605325698853ms
2022-09-21 05:26:48 INFO  Estimated optimisation runtime saving is 29917.87099838257ms
2022-09-21 05:26:48 INFO  ---RUNTIME: Multi-Query Optimization took 9.39631462097168 ms
2022-09-21 05:26:48 INFO  Executing generated plans
2022-09-21 05:27:00 INFO  ---RUNTIME: Execution took 11880.63383102417 ms
2022-09-21 05:27:00 INFO  Done!
2022-09-21 05:27:00 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-21 05:27:00 INFO  Running instrumented original pipeline...
2022-09-21 05:27:00 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-21 05:27:00 INFO  ---RUNTIME: Importing and monkey-patching took 6.314277648925781 ms
2022-09-21 05:27:10 INFO  ---RUNTIME: Original pipeline execution took 10120.107889175415 ms (excluding imports and monkey-patching)
2022-09-21 05:27:10 INFO  Starting execution of 1 what-if analyses...
2022-09-21 05:27:10 INFO  Start plan generation for analysis PermutationFeatureImportance...
2022-09-21 05:27:10 INFO  ---RUNTIME: Plan generation took 0.12612342834472656 ms
2022-09-21 05:27:10 INFO  Estimated runtime of original DAG is 8220.468997955322ms
2022-09-21 05:27:10 WARNING Skipping Multi-Query Optimization (instead, only combine execution DAGs)
2022-09-21 05:27:10 INFO  Estimated unoptimised what-if runtime is 41102.34498977661ms
2022-09-21 05:27:10 INFO  ---RUNTIME: Multi-Query Optimization took 14.693021774291992 ms
2022-09-21 05:27:10 INFO  Executing generated plans
2022-09-21 05:27:57 INFO  ---RUNTIME: Execution took 46194.92959976196 ms
2022-09-21 05:27:57 INFO  Done!
2022-09-21 05:27:57 INFO  # Finished -- repetition 1 of 7 
2022-09-21 05:27:57 INFO  # Optimization benchmark for feature_importance with args [['reviews', 'fast_loading', 'featurization_0', 'neural_network']] -- repetition 2 of 7
2022-09-21 05:27:57 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-21 05:27:57 INFO  Running instrumented original pipeline...
2022-09-21 05:27:57 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-21 05:27:57 INFO  ---RUNTIME: Importing and monkey-patching took 5.928993225097656 ms
2022-09-21 05:28:07 INFO  ---RUNTIME: Original pipeline execution took 9996.605396270752 ms (excluding imports and monkey-patching)
2022-09-21 05:28:07 INFO  Starting execution of 1 what-if analyses...
2022-09-21 05:28:07 INFO  Start plan generation for analysis PermutationFeatureImportance...
2022-09-21 05:28:07 INFO  ---RUNTIME: Plan generation took 0.10657310485839844 ms
2022-09-21 05:28:07 INFO  Estimated runtime of original DAG is 8366.4071559906ms
2022-09-21 05:28:07 INFO  Performing Multi-Query Optimization
2022-09-21 05:28:07 INFO  Estimated unoptimized what-if runtime is 41832.035779953ms
2022-09-21 05:28:07 INFO  Estimated optimised what-if runtime is 11208.653926849365ms
2022-09-21 05:28:07 INFO  Estimated optimisation runtime saving is 30623.381853103638ms
2022-09-21 05:28:07 INFO  ---RUNTIME: Multi-Query Optimization took 9.180545806884766 ms
2022-09-21 05:28:07 INFO  Executing generated plans
2022-09-21 05:28:19 INFO  ---RUNTIME: Execution took 12139.22643661499 ms
2022-09-21 05:28:19 INFO  Done!
2022-09-21 05:28:19 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-21 05:28:19 INFO  Running instrumented original pipeline...
2022-09-21 05:28:19 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-21 05:28:19 INFO  ---RUNTIME: Importing and monkey-patching took 5.80286979675293 ms
2022-09-21 05:28:29 INFO  ---RUNTIME: Original pipeline execution took 10161.80944442749 ms (excluding imports and monkey-patching)
2022-09-21 05:28:29 INFO  Starting execution of 1 what-if analyses...
2022-09-21 05:28:29 INFO  Start plan generation for analysis PermutationFeatureImportance...
2022-09-21 05:28:29 INFO  ---RUNTIME: Plan generation took 0.12922286987304688 ms
2022-09-21 05:28:29 INFO  Estimated runtime of original DAG is 8478.218078613281ms
2022-09-21 05:28:29 WARNING Skipping Multi-Query Optimization (instead, only combine execution DAGs)
2022-09-21 05:28:29 INFO  Estimated unoptimised what-if runtime is 42391.090393066406ms
2022-09-21 05:28:29 INFO  ---RUNTIME: Multi-Query Optimization took 13.712882995605469 ms
2022-09-21 05:28:29 INFO  Executing generated plans
2022-09-21 05:29:15 INFO  ---RUNTIME: Execution took 46022.19104766846 ms
2022-09-21 05:29:15 INFO  Done!
2022-09-21 05:29:15 INFO  # Finished -- repetition 2 of 7 
2022-09-21 05:29:15 INFO  # Optimization benchmark for feature_importance with args [['reviews', 'fast_loading', 'featurization_0', 'neural_network']] -- repetition 3 of 7
2022-09-21 05:29:15 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-21 05:29:15 INFO  Running instrumented original pipeline...
2022-09-21 05:29:15 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-21 05:29:15 INFO  ---RUNTIME: Importing and monkey-patching took 5.954504013061523 ms
2022-09-21 05:29:25 INFO  ---RUNTIME: Original pipeline execution took 9852.694272994995 ms (excluding imports and monkey-patching)
2022-09-21 05:29:25 INFO  Starting execution of 1 what-if analyses...
2022-09-21 05:29:25 INFO  Start plan generation for analysis PermutationFeatureImportance...
2022-09-21 05:29:25 INFO  ---RUNTIME: Plan generation took 0.09799003601074219 ms
2022-09-21 05:29:25 INFO  Estimated runtime of original DAG is 8168.232440948486ms
2022-09-21 05:29:25 INFO  Performing Multi-Query Optimization
2022-09-21 05:29:25 INFO  Estimated unoptimized what-if runtime is 40841.16220474243ms
2022-09-21 05:29:25 INFO  Estimated optimised what-if runtime is 11008.00609588623ms
2022-09-21 05:29:25 INFO  Estimated optimisation runtime saving is 29833.1561088562ms
2022-09-21 05:29:25 INFO  ---RUNTIME: Multi-Query Optimization took 10.350704193115234 ms
2022-09-21 05:29:25 INFO  Executing generated plans
2022-09-21 05:29:37 INFO  ---RUNTIME: Execution took 11881.484746932983 ms
2022-09-21 05:29:37 INFO  Done!
2022-09-21 05:29:37 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-21 05:29:37 INFO  Running instrumented original pipeline...
2022-09-21 05:29:37 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-21 05:29:37 INFO  ---RUNTIME: Importing and monkey-patching took 5.911350250244141 ms
2022-09-21 05:29:47 INFO  ---RUNTIME: Original pipeline execution took 10363.925695419312 ms (excluding imports and monkey-patching)
2022-09-21 05:29:47 INFO  Starting execution of 1 what-if analyses...
2022-09-21 05:29:47 INFO  Start plan generation for analysis PermutationFeatureImportance...
2022-09-21 05:29:47 INFO  ---RUNTIME: Plan generation took 0.10657310485839844 ms
2022-09-21 05:29:47 INFO  Estimated runtime of original DAG is 8716.488122940063ms
2022-09-21 05:29:47 WARNING Skipping Multi-Query Optimization (instead, only combine execution DAGs)
2022-09-21 05:29:47 INFO  Estimated unoptimised what-if runtime is 43582.44061470032ms
2022-09-21 05:29:47 INFO  ---RUNTIME: Multi-Query Optimization took 13.021230697631836 ms
2022-09-21 05:29:47 INFO  Executing generated plans
2022-09-21 05:30:36 INFO  ---RUNTIME: Execution took 48403.88607978821 ms
2022-09-21 05:30:36 INFO  Done!
2022-09-21 05:30:36 INFO  # Finished -- repetition 3 of 7 
2022-09-21 05:30:36 INFO  # Optimization benchmark for feature_importance with args [['reviews', 'fast_loading', 'featurization_0', 'neural_network']] -- repetition 4 of 7
2022-09-21 05:30:36 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-21 05:30:36 INFO  Running instrumented original pipeline...
2022-09-21 05:30:36 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-21 05:30:36 INFO  ---RUNTIME: Importing and monkey-patching took 6.447792053222656 ms
2022-09-21 05:30:47 INFO  ---RUNTIME: Original pipeline execution took 10901.81279182434 ms (excluding imports and monkey-patching)
2022-09-21 05:30:47 INFO  Starting execution of 1 what-if analyses...
2022-09-21 05:30:47 INFO  Start plan generation for analysis PermutationFeatureImportance...
2022-09-21 05:30:47 INFO  ---RUNTIME: Plan generation took 0.1068115234375 ms
2022-09-21 05:30:47 INFO  Estimated runtime of original DAG is 9181.852340698242ms
2022-09-21 05:30:47 INFO  Performing Multi-Query Optimization
2022-09-21 05:30:47 INFO  Estimated unoptimized what-if runtime is 45909.26170349121ms
2022-09-21 05:30:47 INFO  Estimated optimised what-if runtime is 12299.311637878418ms
2022-09-21 05:30:47 INFO  Estimated optimisation runtime saving is 33609.95006561279ms
2022-09-21 05:30:47 INFO  ---RUNTIME: Multi-Query Optimization took 9.955883026123047 ms
2022-09-21 05:30:47 INFO  Executing generated plans
2022-09-21 05:30:59 INFO  ---RUNTIME: Execution took 12835.501194000244 ms
2022-09-21 05:30:59 INFO  Done!
2022-09-21 05:30:59 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-21 05:30:59 INFO  Running instrumented original pipeline...
2022-09-21 05:30:59 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-21 05:30:59 INFO  ---RUNTIME: Importing and monkey-patching took 5.890846252441406 ms
2022-09-21 05:31:10 INFO  ---RUNTIME: Original pipeline execution took 10621.55818939209 ms (excluding imports and monkey-patching)
2022-09-21 05:31:10 INFO  Starting execution of 1 what-if analyses...
2022-09-21 05:31:10 INFO  Start plan generation for analysis PermutationFeatureImportance...
2022-09-21 05:31:10 INFO  ---RUNTIME: Plan generation took 0.11301040649414062 ms
2022-09-21 05:31:10 INFO  Estimated runtime of original DAG is 8860.485792160034ms
2022-09-21 05:31:10 WARNING Skipping Multi-Query Optimization (instead, only combine execution DAGs)
2022-09-21 05:31:10 INFO  Estimated unoptimised what-if runtime is 44302.42896080017ms
2022-09-21 05:31:10 INFO  ---RUNTIME: Multi-Query Optimization took 14.732837677001953 ms
2022-09-21 05:31:10 INFO  Executing generated plans
2022-09-21 05:31:57 INFO  ---RUNTIME: Execution took 46533.334732055664 ms
2022-09-21 05:31:57 INFO  Done!
2022-09-21 05:31:57 INFO  # Finished -- repetition 4 of 7 
2022-09-21 05:31:57 INFO  # Optimization benchmark for feature_importance with args [['reviews', 'fast_loading', 'featurization_0', 'neural_network']] -- repetition 5 of 7
2022-09-21 05:31:57 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-21 05:31:57 INFO  Running instrumented original pipeline...
2022-09-21 05:31:57 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-21 05:31:57 INFO  ---RUNTIME: Importing and monkey-patching took 5.92803955078125 ms
2022-09-21 05:32:06 INFO  ---RUNTIME: Original pipeline execution took 9922.672033309937 ms (excluding imports and monkey-patching)
2022-09-21 05:32:06 INFO  Starting execution of 1 what-if analyses...
2022-09-21 05:32:06 INFO  Start plan generation for analysis PermutationFeatureImportance...
2022-09-21 05:32:06 INFO  ---RUNTIME: Plan generation took 0.133514404296875 ms
2022-09-21 05:32:06 INFO  Estimated runtime of original DAG is 8236.072063446045ms
2022-09-21 05:32:06 INFO  Performing Multi-Query Optimization
2022-09-21 05:32:06 INFO  Estimated unoptimized what-if runtime is 41180.360317230225ms
2022-09-21 05:32:06 INFO  Estimated optimised what-if runtime is 11069.324254989624ms
2022-09-21 05:32:06 INFO  Estimated optimisation runtime saving is 30111.0360622406ms
2022-09-21 05:32:06 INFO  ---RUNTIME: Multi-Query Optimization took 9.190797805786133 ms
2022-09-21 05:32:06 INFO  Executing generated plans
2022-09-21 05:32:18 INFO  ---RUNTIME: Execution took 11844.987154006958 ms
2022-09-21 05:32:18 INFO  Done!
2022-09-21 05:32:18 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-21 05:32:18 INFO  Running instrumented original pipeline...
2022-09-21 05:32:18 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-21 05:32:18 INFO  ---RUNTIME: Importing and monkey-patching took 5.802154541015625 ms
2022-09-21 05:32:28 INFO  ---RUNTIME: Original pipeline execution took 9933.947801589966 ms (excluding imports and monkey-patching)
2022-09-21 05:32:28 INFO  Starting execution of 1 what-if analyses...
2022-09-21 05:32:28 INFO  Start plan generation for analysis PermutationFeatureImportance...
2022-09-21 05:32:28 INFO  ---RUNTIME: Plan generation took 0.09179115295410156 ms
2022-09-21 05:32:28 INFO  Estimated runtime of original DAG is 8285.290956497192ms
2022-09-21 05:32:28 WARNING Skipping Multi-Query Optimization (instead, only combine execution DAGs)
2022-09-21 05:32:28 INFO  Estimated unoptimised what-if runtime is 41426.45478248596ms
2022-09-21 05:32:28 INFO  ---RUNTIME: Multi-Query Optimization took 14.51420783996582 ms
2022-09-21 05:32:28 INFO  Executing generated plans
2022-09-21 05:33:14 INFO  ---RUNTIME: Execution took 45700.26254653931 ms
2022-09-21 05:33:14 INFO  Done!
2022-09-21 05:33:14 INFO  # Finished -- repetition 5 of 7 
2022-09-21 05:33:14 INFO  # Optimization benchmark for feature_importance with args [['reviews', 'fast_loading', 'featurization_0', 'neural_network']] -- repetition 6 of 7
2022-09-21 05:33:14 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-21 05:33:14 INFO  Running instrumented original pipeline...
2022-09-21 05:33:14 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-21 05:33:14 INFO  ---RUNTIME: Importing and monkey-patching took 6.102085113525391 ms
2022-09-21 05:33:24 INFO  ---RUNTIME: Original pipeline execution took 10081.927299499512 ms (excluding imports and monkey-patching)
2022-09-21 05:33:24 INFO  Starting execution of 1 what-if analyses...
2022-09-21 05:33:24 INFO  Start plan generation for analysis PermutationFeatureImportance...
2022-09-21 05:33:24 INFO  ---RUNTIME: Plan generation took 0.10418891906738281 ms
2022-09-21 05:33:24 INFO  Estimated runtime of original DAG is 8397.148847579956ms
2022-09-21 05:33:24 INFO  Performing Multi-Query Optimization
2022-09-21 05:33:24 INFO  Estimated unoptimized what-if runtime is 41985.74423789978ms
2022-09-21 05:33:24 INFO  Estimated optimised what-if runtime is 11320.904970169067ms
2022-09-21 05:33:24 INFO  Estimated optimisation runtime saving is 30664.839267730713ms
2022-09-21 05:33:24 INFO  ---RUNTIME: Multi-Query Optimization took 10.73598861694336 ms
2022-09-21 05:33:24 INFO  Executing generated plans
2022-09-21 05:33:36 INFO  ---RUNTIME: Execution took 11904.934406280518 ms
2022-09-21 05:33:36 INFO  Done!
2022-09-21 05:33:36 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-21 05:33:36 INFO  Running instrumented original pipeline...
2022-09-21 05:33:36 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-21 05:33:36 INFO  ---RUNTIME: Importing and monkey-patching took 6.067514419555664 ms
2022-09-21 05:33:46 INFO  ---RUNTIME: Original pipeline execution took 9893.709182739258 ms (excluding imports and monkey-patching)
2022-09-21 05:33:46 INFO  Starting execution of 1 what-if analyses...
2022-09-21 05:33:46 INFO  Start plan generation for analysis PermutationFeatureImportance...
2022-09-21 05:33:46 INFO  ---RUNTIME: Plan generation took 0.1087188720703125 ms
2022-09-21 05:33:46 INFO  Estimated runtime of original DAG is 8246.183395385742ms
2022-09-21 05:33:46 WARNING Skipping Multi-Query Optimization (instead, only combine execution DAGs)
2022-09-21 05:33:46 INFO  Estimated unoptimised what-if runtime is 41230.91697692871ms
2022-09-21 05:33:46 INFO  ---RUNTIME: Multi-Query Optimization took 13.121843338012695 ms
2022-09-21 05:33:46 INFO  Executing generated plans
2022-09-21 05:34:32 INFO  ---RUNTIME: Execution took 45793.61033439636 ms
2022-09-21 05:34:32 INFO  Done!
2022-09-21 05:34:32 INFO  # Finished -- repetition 6 of 7 
2022-09-21 05:34:32 INFO  # Optimization benchmark for feature_importance with args [['reviews', 'fast_loading', 'featurization_0', 'neural_network']] -- repetition 7 of 7
2022-09-21 05:34:32 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-21 05:34:32 INFO  Running instrumented original pipeline...
2022-09-21 05:34:32 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-21 05:34:32 INFO  ---RUNTIME: Importing and monkey-patching took 5.835294723510742 ms
2022-09-21 05:34:42 INFO  ---RUNTIME: Original pipeline execution took 10046.579360961914 ms (excluding imports and monkey-patching)
2022-09-21 05:34:42 INFO  Starting execution of 1 what-if analyses...
2022-09-21 05:34:42 INFO  Start plan generation for analysis PermutationFeatureImportance...
2022-09-21 05:34:42 INFO  ---RUNTIME: Plan generation took 0.1220703125 ms
2022-09-21 05:34:42 INFO  Estimated runtime of original DAG is 8352.894306182861ms
2022-09-21 05:34:42 INFO  Performing Multi-Query Optimization
2022-09-21 05:34:42 INFO  Estimated unoptimized what-if runtime is 41764.47153091431ms
2022-09-21 05:34:42 INFO  Estimated optimised what-if runtime is 11212.446928024292ms
2022-09-21 05:34:42 INFO  Estimated optimisation runtime saving is 30552.024602890015ms
2022-09-21 05:34:42 INFO  ---RUNTIME: Multi-Query Optimization took 9.171485900878906 ms
2022-09-21 05:34:42 INFO  Executing generated plans
2022-09-21 05:34:54 INFO  ---RUNTIME: Execution took 11956.688404083252 ms
2022-09-21 05:34:54 INFO  Done!
2022-09-21 05:34:54 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-21 05:34:54 INFO  Running instrumented original pipeline...
2022-09-21 05:34:54 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-21 05:34:54 INFO  ---RUNTIME: Importing and monkey-patching took 5.782604217529297 ms
2022-09-21 05:35:04 INFO  ---RUNTIME: Original pipeline execution took 10342.201471328735 ms (excluding imports and monkey-patching)
2022-09-21 05:35:04 INFO  Starting execution of 1 what-if analyses...
2022-09-21 05:35:04 INFO  Start plan generation for analysis PermutationFeatureImportance...
2022-09-21 05:35:04 INFO  ---RUNTIME: Plan generation took 0.08988380432128906 ms
2022-09-21 05:35:04 INFO  Estimated runtime of original DAG is 8684.021711349487ms
2022-09-21 05:35:04 WARNING Skipping Multi-Query Optimization (instead, only combine execution DAGs)
2022-09-21 05:35:04 INFO  Estimated unoptimised what-if runtime is 43420.10855674744ms
2022-09-21 05:35:04 INFO  ---RUNTIME: Multi-Query Optimization took 13.051271438598633 ms
2022-09-21 05:35:04 INFO  Executing generated plans
2022-09-21 05:35:50 INFO  ---RUNTIME: Execution took 45702.69513130188 ms
2022-09-21 05:35:50 INFO  Done!
2022-09-21 05:35:50 INFO  # Finished -- repetition 7 of 7 
2022-09-21 05:35:50 INFO  # Final results after all repetitions
2022-09-21 05:35:50 INFO     repetition  ... no_opt_what_if_execution_combined_model_training
0           0  ...                                     16242.542028
1           1  ...                                     16435.082436
2           2  ...                                     17521.720171
3           3  ...                                     16116.337299
4           4  ...                                     16192.457199
5           5  ...                                     16326.927423
6           6  ...                                     16068.270206

[7 rows x 26 columns]
taskset -c 32-40 PROTOCOL_BUFFERS_PYTHON_IMPLEMENTATION=python python3.9 benchmarks_end_to_end.py feature_importance reviews fast_loading featurization_1 logistic_regression
2022-09-21 05:35:52.768455: W tensorflow/stream_executor/platform/default/dso_loader.cc:64] Could not load dynamic library 'libcudart.so.11.0'; dlerror: libcudart.so.11.0: cannot open shared object file: No such file or directory; LD_LIBRARY_PATH: /home/sgrafbe/mlwhatif/venv/lib/python3.9/site-packages/cv2/../../lib64:
2022-09-21 05:35:52.768507: I tensorflow/stream_executor/cuda/cudart_stub.cc:29] Ignore above cudart dlerror if you do not have a GPU set up on your machine.
2022-09-21 05:35:54 INFO  Patching sys.argv with ['mlwhatif', 'reviews', 'fast_loading', 'featurization_1', 'logistic_regression']
2022-09-21 05:35:54 INFO  Running instrumented original pipeline...
2022-09-21 05:35:54 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-21 05:35:54 INFO  ---RUNTIME: Importing and monkey-patching took 121.46258354187012 ms
2022-09-21 05:36:01 INFO  ---RUNTIME: Original pipeline execution took 7137.351751327515 ms (excluding imports and monkey-patching)
2022-09-21 05:36:01 INFO  Starting execution of 0 what-if analyses...
2022-09-21 05:36:01 INFO  Estimated runtime of original DAG is 4862.178087234497ms
2022-09-21 05:36:01 INFO  Performing Multi-Query Optimization
2022-09-21 05:36:01 INFO  Estimated unoptimized what-if runtime is 0ms
2022-09-21 05:36:01 INFO  Estimated optimised what-if runtime is 0ms
2022-09-21 05:36:01 INFO  Estimated optimisation runtime saving is 0ms
2022-09-21 05:36:01 INFO  ---RUNTIME: Multi-Query Optimization took 0.5319118499755859 ms
2022-09-21 05:36:01 INFO  Executing generated plans
2022-09-21 05:36:01 INFO  ---RUNTIME: Execution took 0.025987625122070312 ms
2022-09-21 05:36:01 INFO  Done!
2022-09-21 05:36:01 INFO  # Optimization benchmark for feature_importance with args [['reviews', 'fast_loading', 'featurization_1', 'logistic_regression']] -- repetition 1 of 7
2022-09-21 05:36:01 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-21 05:36:01 INFO  Running instrumented original pipeline...
2022-09-21 05:36:01 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-21 05:36:01 INFO  ---RUNTIME: Importing and monkey-patching took 6.094932556152344 ms
2022-09-21 05:36:08 INFO  ---RUNTIME: Original pipeline execution took 7230.5262088775635 ms (excluding imports and monkey-patching)
2022-09-21 05:36:08 INFO  Starting execution of 1 what-if analyses...
2022-09-21 05:36:08 INFO  Start plan generation for analysis PermutationFeatureImportance...
2022-09-21 05:36:08 INFO  ---RUNTIME: Plan generation took 0.30732154846191406 ms
2022-09-21 05:36:08 INFO  Estimated runtime of original DAG is 4823.834180831909ms
2022-09-21 05:36:08 INFO  Performing Multi-Query Optimization
2022-09-21 05:36:08 INFO  Estimated unoptimized what-if runtime is 24119.170904159546ms
2022-09-21 05:36:08 INFO  Estimated optimised what-if runtime is 6150.1195430755615ms
2022-09-21 05:36:08 INFO  Estimated optimisation runtime saving is 17969.051361083984ms
2022-09-21 05:36:08 INFO  ---RUNTIME: Multi-Query Optimization took 10.193586349487305 ms
2022-09-21 05:36:08 INFO  Executing generated plans
2022-09-21 05:36:15 INFO  ---RUNTIME: Execution took 7034.048080444336 ms
2022-09-21 05:36:15 INFO  Done!
2022-09-21 05:36:15 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-21 05:36:15 INFO  Running instrumented original pipeline...
2022-09-21 05:36:15 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-21 05:36:15 INFO  ---RUNTIME: Importing and monkey-patching took 5.982875823974609 ms
2022-09-21 05:36:22 INFO  ---RUNTIME: Original pipeline execution took 7032.2089195251465 ms (excluding imports and monkey-patching)
2022-09-21 05:36:22 INFO  Starting execution of 1 what-if analyses...
2022-09-21 05:36:22 INFO  Start plan generation for analysis PermutationFeatureImportance...
2022-09-21 05:36:22 INFO  ---RUNTIME: Plan generation took 0.23293495178222656 ms
2022-09-21 05:36:22 INFO  Estimated runtime of original DAG is 4839.004039764404ms
2022-09-21 05:36:22 WARNING Skipping Multi-Query Optimization (instead, only combine execution DAGs)
2022-09-21 05:36:22 INFO  Estimated unoptimised what-if runtime is 24195.02019882202ms
2022-09-21 05:36:22 INFO  ---RUNTIME: Multi-Query Optimization took 14.83011245727539 ms
2022-09-21 05:36:22 INFO  Executing generated plans
2022-09-21 05:36:50 INFO  ---RUNTIME: Execution took 28243.37387084961 ms
2022-09-21 05:36:50 INFO  Done!
2022-09-21 05:36:50 INFO  # Finished -- repetition 1 of 7 
2022-09-21 05:36:50 INFO  # Optimization benchmark for feature_importance with args [['reviews', 'fast_loading', 'featurization_1', 'logistic_regression']] -- repetition 2 of 7
2022-09-21 05:36:50 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-21 05:36:50 INFO  Running instrumented original pipeline...
2022-09-21 05:36:50 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-21 05:36:50 INFO  ---RUNTIME: Importing and monkey-patching took 6.161689758300781 ms
2022-09-21 05:36:57 INFO  ---RUNTIME: Original pipeline execution took 7039.641618728638 ms (excluding imports and monkey-patching)
2022-09-21 05:36:57 INFO  Starting execution of 1 what-if analyses...
2022-09-21 05:36:57 INFO  Start plan generation for analysis PermutationFeatureImportance...
2022-09-21 05:36:57 INFO  ---RUNTIME: Plan generation took 0.2117156982421875 ms
2022-09-21 05:36:57 INFO  Estimated runtime of original DAG is 4836.828231811523ms
2022-09-21 05:36:57 INFO  Performing Multi-Query Optimization
2022-09-21 05:36:57 INFO  Estimated unoptimized what-if runtime is 24184.141159057617ms
2022-09-21 05:36:57 INFO  Estimated optimised what-if runtime is 6153.1822681427ms
2022-09-21 05:36:57 INFO  Estimated optimisation runtime saving is 18030.958890914917ms
2022-09-21 05:36:57 INFO  ---RUNTIME: Multi-Query Optimization took 10.195732116699219 ms
2022-09-21 05:36:57 INFO  Executing generated plans
2022-09-21 05:37:04 INFO  ---RUNTIME: Execution took 7012.182235717773 ms
2022-09-21 05:37:04 INFO  Done!
2022-09-21 05:37:04 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-21 05:37:04 INFO  Running instrumented original pipeline...
2022-09-21 05:37:05 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-21 05:37:05 INFO  ---RUNTIME: Importing and monkey-patching took 5.760908126831055 ms
2022-09-21 05:37:12 INFO  ---RUNTIME: Original pipeline execution took 7030.233860015869 ms (excluding imports and monkey-patching)
2022-09-21 05:37:12 INFO  Starting execution of 1 what-if analyses...
2022-09-21 05:37:12 INFO  Start plan generation for analysis PermutationFeatureImportance...
2022-09-21 05:37:12 INFO  ---RUNTIME: Plan generation took 0.20503997802734375 ms
2022-09-21 05:37:12 INFO  Estimated runtime of original DAG is 4830.354928970337ms
2022-09-21 05:37:12 WARNING Skipping Multi-Query Optimization (instead, only combine execution DAGs)
2022-09-21 05:37:12 INFO  Estimated unoptimised what-if runtime is 24151.774644851685ms
2022-09-21 05:37:12 INFO  ---RUNTIME: Multi-Query Optimization took 14.530420303344727 ms
2022-09-21 05:37:12 INFO  Executing generated plans
2022-09-21 05:37:40 INFO  ---RUNTIME: Execution took 28236.593008041382 ms
2022-09-21 05:37:40 INFO  Done!
2022-09-21 05:37:40 INFO  # Finished -- repetition 2 of 7 
2022-09-21 05:37:40 INFO  # Optimization benchmark for feature_importance with args [['reviews', 'fast_loading', 'featurization_1', 'logistic_regression']] -- repetition 3 of 7
2022-09-21 05:37:40 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-21 05:37:40 INFO  Running instrumented original pipeline...
2022-09-21 05:37:40 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-21 05:37:40 INFO  ---RUNTIME: Importing and monkey-patching took 6.068706512451172 ms
2022-09-21 05:37:47 INFO  ---RUNTIME: Original pipeline execution took 7061.527490615845 ms (excluding imports and monkey-patching)
2022-09-21 05:37:47 INFO  Starting execution of 1 what-if analyses...
2022-09-21 05:37:47 INFO  Start plan generation for analysis PermutationFeatureImportance...
2022-09-21 05:37:47 INFO  ---RUNTIME: Plan generation took 0.22220611572265625 ms
2022-09-21 05:37:47 INFO  Estimated runtime of original DAG is 4841.0539627075195ms
2022-09-21 05:37:47 INFO  Performing Multi-Query Optimization
2022-09-21 05:37:47 INFO  Estimated unoptimized what-if runtime is 24205.269813537598ms
2022-09-21 05:37:47 INFO  Estimated optimised what-if runtime is 6166.637182235718ms
2022-09-21 05:37:47 INFO  Estimated optimisation runtime saving is 18038.63263130188ms
2022-09-21 05:37:47 INFO  ---RUNTIME: Multi-Query Optimization took 10.261058807373047 ms
2022-09-21 05:37:47 INFO  Executing generated plans
2022-09-21 05:37:54 INFO  ---RUNTIME: Execution took 7042.432069778442 ms
2022-09-21 05:37:54 INFO  Done!
2022-09-21 05:37:54 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-21 05:37:54 INFO  Running instrumented original pipeline...
2022-09-21 05:37:54 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-21 05:37:54 INFO  ---RUNTIME: Importing and monkey-patching took 5.679845809936523 ms
2022-09-21 05:38:01 INFO  ---RUNTIME: Original pipeline execution took 7059.77725982666 ms (excluding imports and monkey-patching)
2022-09-21 05:38:01 INFO  Starting execution of 1 what-if analyses...
2022-09-21 05:38:01 INFO  Start plan generation for analysis PermutationFeatureImportance...
2022-09-21 05:38:01 INFO  ---RUNTIME: Plan generation took 0.2472400665283203 ms
2022-09-21 05:38:01 INFO  Estimated runtime of original DAG is 4844.0961837768555ms
2022-09-21 05:38:01 WARNING Skipping Multi-Query Optimization (instead, only combine execution DAGs)
2022-09-21 05:38:01 INFO  Estimated unoptimised what-if runtime is 24220.480918884277ms
2022-09-21 05:38:01 INFO  ---RUNTIME: Multi-Query Optimization took 14.52779769897461 ms
2022-09-21 05:38:01 INFO  Executing generated plans
2022-09-21 05:38:30 INFO  ---RUNTIME: Execution took 28888.288736343384 ms
2022-09-21 05:38:30 INFO  Done!
2022-09-21 05:38:30 INFO  # Finished -- repetition 3 of 7 
2022-09-21 05:38:30 INFO  # Optimization benchmark for feature_importance with args [['reviews', 'fast_loading', 'featurization_1', 'logistic_regression']] -- repetition 4 of 7
2022-09-21 05:38:30 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-21 05:38:30 INFO  Running instrumented original pipeline...
2022-09-21 05:38:30 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-21 05:38:30 INFO  ---RUNTIME: Importing and monkey-patching took 6.376981735229492 ms
2022-09-21 05:38:37 INFO  ---RUNTIME: Original pipeline execution took 7443.820476531982 ms (excluding imports and monkey-patching)
2022-09-21 05:38:37 INFO  Starting execution of 1 what-if analyses...
2022-09-21 05:38:37 INFO  Start plan generation for analysis PermutationFeatureImportance...
2022-09-21 05:38:37 INFO  ---RUNTIME: Plan generation took 0.19621849060058594 ms
2022-09-21 05:38:37 INFO  Estimated runtime of original DAG is 4910.181283950806ms
2022-09-21 05:38:37 INFO  Performing Multi-Query Optimization
2022-09-21 05:38:37 INFO  Estimated unoptimized what-if runtime is 24550.90641975403ms
2022-09-21 05:38:37 INFO  Estimated optimised what-if runtime is 6425.119400024414ms
2022-09-21 05:38:37 INFO  Estimated optimisation runtime saving is 18125.787019729614ms
2022-09-21 05:38:37 INFO  ---RUNTIME: Multi-Query Optimization took 9.929895401000977 ms
2022-09-21 05:38:37 INFO  Executing generated plans
2022-09-21 05:38:45 INFO  ---RUNTIME: Execution took 7448.639869689941 ms
2022-09-21 05:38:45 INFO  Done!
2022-09-21 05:38:45 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-21 05:38:45 INFO  Running instrumented original pipeline...
2022-09-21 05:38:45 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-21 05:38:45 INFO  ---RUNTIME: Importing and monkey-patching took 7.100105285644531 ms
2022-09-21 05:38:52 INFO  ---RUNTIME: Original pipeline execution took 7290.847539901733 ms (excluding imports and monkey-patching)
2022-09-21 05:38:52 INFO  Starting execution of 1 what-if analyses...
2022-09-21 05:38:52 INFO  Start plan generation for analysis PermutationFeatureImportance...
2022-09-21 05:38:52 INFO  ---RUNTIME: Plan generation took 0.2117156982421875 ms
2022-09-21 05:38:52 INFO  Estimated runtime of original DAG is 4959.329128265381ms
2022-09-21 05:38:52 WARNING Skipping Multi-Query Optimization (instead, only combine execution DAGs)
2022-09-21 05:38:52 INFO  Estimated unoptimised what-if runtime is 24796.645641326904ms
2022-09-21 05:38:52 INFO  ---RUNTIME: Multi-Query Optimization took 14.387845993041992 ms
2022-09-21 05:38:52 INFO  Executing generated plans
2022-09-21 05:39:21 INFO  ---RUNTIME: Execution took 29080.201864242554 ms
2022-09-21 05:39:21 INFO  Done!
2022-09-21 05:39:21 INFO  # Finished -- repetition 4 of 7 
2022-09-21 05:39:21 INFO  # Optimization benchmark for feature_importance with args [['reviews', 'fast_loading', 'featurization_1', 'logistic_regression']] -- repetition 5 of 7
2022-09-21 05:39:21 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-21 05:39:21 INFO  Running instrumented original pipeline...
2022-09-21 05:39:21 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-21 05:39:21 INFO  ---RUNTIME: Importing and monkey-patching took 5.890369415283203 ms
2022-09-21 05:39:29 INFO  ---RUNTIME: Original pipeline execution took 7341.153144836426 ms (excluding imports and monkey-patching)
2022-09-21 05:39:29 INFO  Starting execution of 1 what-if analyses...
2022-09-21 05:39:29 INFO  Start plan generation for analysis PermutationFeatureImportance...
2022-09-21 05:39:29 INFO  ---RUNTIME: Plan generation took 0.2067089080810547 ms
2022-09-21 05:39:29 INFO  Estimated runtime of original DAG is 5006.838083267212ms
2022-09-21 05:39:29 INFO  Performing Multi-Query Optimization
2022-09-21 05:39:29 INFO  Estimated unoptimized what-if runtime is 25034.19041633606ms
2022-09-21 05:39:29 INFO  Estimated optimised what-if runtime is 6539.257764816284ms
2022-09-21 05:39:29 INFO  Estimated optimisation runtime saving is 18494.932651519775ms
2022-09-21 05:39:29 INFO  ---RUNTIME: Multi-Query Optimization took 10.392189025878906 ms
2022-09-21 05:39:29 INFO  Executing generated plans
2022-09-21 05:39:36 INFO  ---RUNTIME: Execution took 7340.929746627808 ms
2022-09-21 05:39:36 INFO  Done!
2022-09-21 05:39:36 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-21 05:39:36 INFO  Running instrumented original pipeline...
2022-09-21 05:39:36 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-21 05:39:36 INFO  ---RUNTIME: Importing and monkey-patching took 6.103992462158203 ms
2022-09-21 05:39:43 INFO  ---RUNTIME: Original pipeline execution took 7385.985612869263 ms (excluding imports and monkey-patching)
2022-09-21 05:39:43 INFO  Starting execution of 1 what-if analyses...
2022-09-21 05:39:43 INFO  Start plan generation for analysis PermutationFeatureImportance...
2022-09-21 05:39:43 INFO  ---RUNTIME: Plan generation took 0.21338462829589844 ms
2022-09-21 05:39:43 INFO  Estimated runtime of original DAG is 4911.59462928772ms
2022-09-21 05:39:43 WARNING Skipping Multi-Query Optimization (instead, only combine execution DAGs)
2022-09-21 05:39:43 INFO  Estimated unoptimised what-if runtime is 24557.9731464386ms
2022-09-21 05:39:43 INFO  ---RUNTIME: Multi-Query Optimization took 14.585018157958984 ms
2022-09-21 05:39:43 INFO  Executing generated plans
2022-09-21 05:40:12 INFO  ---RUNTIME: Execution took 28137.385845184326 ms
2022-09-21 05:40:12 INFO  Done!
2022-09-21 05:40:12 INFO  # Finished -- repetition 5 of 7 
2022-09-21 05:40:12 INFO  # Optimization benchmark for feature_importance with args [['reviews', 'fast_loading', 'featurization_1', 'logistic_regression']] -- repetition 6 of 7
2022-09-21 05:40:12 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-21 05:40:12 INFO  Running instrumented original pipeline...
2022-09-21 05:40:12 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-21 05:40:12 INFO  ---RUNTIME: Importing and monkey-patching took 6.061792373657227 ms
2022-09-21 05:40:20 INFO  ---RUNTIME: Original pipeline execution took 7979.597806930542 ms (excluding imports and monkey-patching)
2022-09-21 05:40:20 INFO  Starting execution of 1 what-if analyses...
2022-09-21 05:40:20 INFO  Start plan generation for analysis PermutationFeatureImportance...
2022-09-21 05:40:20 INFO  ---RUNTIME: Plan generation took 0.21982192993164062 ms
2022-09-21 05:40:20 INFO  Estimated runtime of original DAG is 5432.5597286224365ms
2022-09-21 05:40:20 INFO  Performing Multi-Query Optimization
2022-09-21 05:40:20 INFO  Estimated unoptimized what-if runtime is 27162.798643112183ms
2022-09-21 05:40:20 INFO  Estimated optimised what-if runtime is 6953.990936279297ms
2022-09-21 05:40:20 INFO  Estimated optimisation runtime saving is 20208.807706832886ms
2022-09-21 05:40:20 INFO  ---RUNTIME: Multi-Query Optimization took 10.018587112426758 ms
2022-09-21 05:40:20 INFO  Executing generated plans
2022-09-21 05:40:27 INFO  ---RUNTIME: Execution took 7290.15040397644 ms
2022-09-21 05:40:27 INFO  Done!
2022-09-21 05:40:27 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-21 05:40:27 INFO  Running instrumented original pipeline...
2022-09-21 05:40:27 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-21 05:40:27 INFO  ---RUNTIME: Importing and monkey-patching took 5.793333053588867 ms
2022-09-21 05:40:34 INFO  ---RUNTIME: Original pipeline execution took 7437.830686569214 ms (excluding imports and monkey-patching)
2022-09-21 05:40:34 INFO  Starting execution of 1 what-if analyses...
2022-09-21 05:40:34 INFO  Start plan generation for analysis PermutationFeatureImportance...
2022-09-21 05:40:34 INFO  ---RUNTIME: Plan generation took 0.2129077911376953 ms
2022-09-21 05:40:34 INFO  Estimated runtime of original DAG is 4887.288570404053ms
2022-09-21 05:40:34 WARNING Skipping Multi-Query Optimization (instead, only combine execution DAGs)
2022-09-21 05:40:34 INFO  Estimated unoptimised what-if runtime is 24436.442852020264ms
2022-09-21 05:40:34 INFO  ---RUNTIME: Multi-Query Optimization took 14.321565628051758 ms
2022-09-21 05:40:34 INFO  Executing generated plans
2022-09-21 05:41:03 INFO  ---RUNTIME: Execution took 28417.941570281982 ms
2022-09-21 05:41:03 INFO  Done!
2022-09-21 05:41:03 INFO  # Finished -- repetition 6 of 7 
2022-09-21 05:41:03 INFO  # Optimization benchmark for feature_importance with args [['reviews', 'fast_loading', 'featurization_1', 'logistic_regression']] -- repetition 7 of 7
2022-09-21 05:41:03 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-21 05:41:03 INFO  Running instrumented original pipeline...
2022-09-21 05:41:03 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-21 05:41:03 INFO  ---RUNTIME: Importing and monkey-patching took 6.148338317871094 ms
2022-09-21 05:41:10 INFO  ---RUNTIME: Original pipeline execution took 7177.168846130371 ms (excluding imports and monkey-patching)
2022-09-21 05:41:10 INFO  Starting execution of 1 what-if analyses...
2022-09-21 05:41:10 INFO  Start plan generation for analysis PermutationFeatureImportance...
2022-09-21 05:41:10 INFO  ---RUNTIME: Plan generation took 0.1418590545654297 ms
2022-09-21 05:41:10 INFO  Estimated runtime of original DAG is 4902.17137336731ms
2022-09-21 05:41:10 INFO  Performing Multi-Query Optimization
2022-09-21 05:41:10 INFO  Estimated unoptimized what-if runtime is 24510.856866836548ms
2022-09-21 05:41:10 INFO  Estimated optimised what-if runtime is 6450.742721557617ms
2022-09-21 05:41:10 INFO  Estimated optimisation runtime saving is 18060.11414527893ms
2022-09-21 05:41:10 INFO  ---RUNTIME: Multi-Query Optimization took 13.416528701782227 ms
2022-09-21 05:41:10 INFO  Executing generated plans
2022-09-21 05:41:18 INFO  ---RUNTIME: Execution took 7863.988399505615 ms
2022-09-21 05:41:18 INFO  Done!
2022-09-21 05:41:18 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-21 05:41:18 INFO  Running instrumented original pipeline...
2022-09-21 05:41:18 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-21 05:41:18 INFO  ---RUNTIME: Importing and monkey-patching took 5.696296691894531 ms
2022-09-21 05:41:26 INFO  ---RUNTIME: Original pipeline execution took 7729.2320728302 ms (excluding imports and monkey-patching)
2022-09-21 05:41:26 INFO  Starting execution of 1 what-if analyses...
2022-09-21 05:41:26 INFO  Start plan generation for analysis PermutationFeatureImportance...
2022-09-21 05:41:26 INFO  ---RUNTIME: Plan generation took 0.2281665802001953 ms
2022-09-21 05:41:26 INFO  Estimated runtime of original DAG is 5056.0760498046875ms
2022-09-21 05:41:26 WARNING Skipping Multi-Query Optimization (instead, only combine execution DAGs)
2022-09-21 05:41:26 INFO  Estimated unoptimised what-if runtime is 25280.380249023438ms
2022-09-21 05:41:26 INFO  ---RUNTIME: Multi-Query Optimization took 14.440059661865234 ms
2022-09-21 05:41:26 INFO  Executing generated plans
2022-09-21 05:41:54 INFO  ---RUNTIME: Execution took 28859.803438186646 ms
2022-09-21 05:41:54 INFO  Done!
2022-09-21 05:41:54 INFO  # Finished -- repetition 7 of 7 
2022-09-21 05:41:54 INFO  # Final results after all repetitions
2022-09-21 05:41:54 INFO     repetition  ... no_opt_what_if_execution_combined_model_training
0           0  ...                                       514.617205
1           1  ...                                       522.187471
2           2  ...                                       560.650349
3           3  ...                                       523.935318
4           4  ...                                       516.060114
5           5  ...                                       514.479876
6           6  ...                                       513.061285

[7 rows x 26 columns]
taskset -c 32-40 PROTOCOL_BUFFERS_PYTHON_IMPLEMENTATION=python python3.9 benchmarks_end_to_end.py feature_importance reviews fast_loading featurization_1 xgboost
2022-09-21 05:41:57.214452: W tensorflow/stream_executor/platform/default/dso_loader.cc:64] Could not load dynamic library 'libcudart.so.11.0'; dlerror: libcudart.so.11.0: cannot open shared object file: No such file or directory; LD_LIBRARY_PATH: /home/sgrafbe/mlwhatif/venv/lib/python3.9/site-packages/cv2/../../lib64:
2022-09-21 05:41:57.214497: I tensorflow/stream_executor/cuda/cudart_stub.cc:29] Ignore above cudart dlerror if you do not have a GPU set up on your machine.
2022-09-21 05:41:58 INFO  Patching sys.argv with ['mlwhatif', 'reviews', 'fast_loading', 'featurization_1', 'xgboost']
2022-09-21 05:41:58 INFO  Running instrumented original pipeline...
2022-09-21 05:41:58 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-21 05:41:58 INFO  ---RUNTIME: Importing and monkey-patching took 121.27304077148438 ms
2022-09-21 05:42:07 INFO  ---RUNTIME: Original pipeline execution took 9184.299230575562 ms (excluding imports and monkey-patching)
2022-09-21 05:42:07 INFO  Starting execution of 0 what-if analyses...
2022-09-21 05:42:07 INFO  Estimated runtime of original DAG is 6934.618949890137ms
2022-09-21 05:42:07 INFO  Performing Multi-Query Optimization
2022-09-21 05:42:07 INFO  Estimated unoptimized what-if runtime is 0ms
2022-09-21 05:42:07 INFO  Estimated optimised what-if runtime is 0ms
2022-09-21 05:42:07 INFO  Estimated optimisation runtime saving is 0ms
2022-09-21 05:42:07 INFO  ---RUNTIME: Multi-Query Optimization took 0.4897117614746094 ms
2022-09-21 05:42:07 INFO  Executing generated plans
2022-09-21 05:42:07 INFO  ---RUNTIME: Execution took 0.023603439331054688 ms
2022-09-21 05:42:07 INFO  Done!
2022-09-21 05:42:07 INFO  # Optimization benchmark for feature_importance with args [['reviews', 'fast_loading', 'featurization_1', 'xgboost']] -- repetition 1 of 7
2022-09-21 05:42:07 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-21 05:42:07 INFO  Running instrumented original pipeline...
2022-09-21 05:42:08 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-21 05:42:08 INFO  ---RUNTIME: Importing and monkey-patching took 6.252527236938477 ms
2022-09-21 05:42:16 INFO  ---RUNTIME: Original pipeline execution took 8721.756935119629 ms (excluding imports and monkey-patching)
2022-09-21 05:42:16 INFO  Starting execution of 1 what-if analyses...
2022-09-21 05:42:16 INFO  Start plan generation for analysis PermutationFeatureImportance...
2022-09-21 05:42:16 INFO  ---RUNTIME: Plan generation took 0.31495094299316406 ms
2022-09-21 05:42:16 INFO  Estimated runtime of original DAG is 6102.392673492432ms
2022-09-21 05:42:16 INFO  Performing Multi-Query Optimization
2022-09-21 05:42:16 INFO  Estimated unoptimized what-if runtime is 30511.96336746216ms
2022-09-21 05:42:16 INFO  Estimated optimised what-if runtime is 7619.081020355225ms
2022-09-21 05:42:16 INFO  Estimated optimisation runtime saving is 22892.882347106934ms
2022-09-21 05:42:16 INFO  ---RUNTIME: Multi-Query Optimization took 9.994029998779297 ms
2022-09-21 05:42:16 INFO  Executing generated plans
2022-09-21 05:42:24 INFO  ---RUNTIME: Execution took 8159.666299819946 ms
2022-09-21 05:42:24 INFO  Done!
2022-09-21 05:42:24 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-21 05:42:24 INFO  Running instrumented original pipeline...
2022-09-21 05:42:24 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-21 05:42:24 INFO  ---RUNTIME: Importing and monkey-patching took 6.110668182373047 ms
2022-09-21 05:42:32 INFO  ---RUNTIME: Original pipeline execution took 7963.6712074279785 ms (excluding imports and monkey-patching)
2022-09-21 05:42:32 INFO  Starting execution of 1 what-if analyses...
2022-09-21 05:42:32 INFO  Start plan generation for analysis PermutationFeatureImportance...
2022-09-21 05:42:32 INFO  ---RUNTIME: Plan generation took 0.24271011352539062 ms
2022-09-21 05:42:32 INFO  Estimated runtime of original DAG is 5699.578523635864ms
2022-09-21 05:42:32 WARNING Skipping Multi-Query Optimization (instead, only combine execution DAGs)
2022-09-21 05:42:32 INFO  Estimated unoptimised what-if runtime is 28497.89261817932ms
2022-09-21 05:42:32 INFO  ---RUNTIME: Multi-Query Optimization took 14.37687873840332 ms
2022-09-21 05:42:32 INFO  Executing generated plans
2022-09-21 05:43:05 INFO  ---RUNTIME: Execution took 32536.67449951172 ms
2022-09-21 05:43:05 INFO  Done!
2022-09-21 05:43:05 INFO  # Finished -- repetition 1 of 7 
2022-09-21 05:43:05 INFO  # Optimization benchmark for feature_importance with args [['reviews', 'fast_loading', 'featurization_1', 'xgboost']] -- repetition 2 of 7
2022-09-21 05:43:05 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-21 05:43:05 INFO  Running instrumented original pipeline...
2022-09-21 05:43:05 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-21 05:43:05 INFO  ---RUNTIME: Importing and monkey-patching took 6.0901641845703125 ms
2022-09-21 05:43:13 INFO  ---RUNTIME: Original pipeline execution took 8591.886758804321 ms (excluding imports and monkey-patching)
2022-09-21 05:43:13 INFO  Starting execution of 1 what-if analyses...
2022-09-21 05:43:13 INFO  Start plan generation for analysis PermutationFeatureImportance...
2022-09-21 05:43:13 INFO  ---RUNTIME: Plan generation took 0.23317337036132812 ms
2022-09-21 05:43:13 INFO  Estimated runtime of original DAG is 5985.198259353638ms
2022-09-21 05:43:13 INFO  Performing Multi-Query Optimization
2022-09-21 05:43:13 INFO  Estimated unoptimized what-if runtime is 29925.99129676819ms
2022-09-21 05:43:13 INFO  Estimated optimised what-if runtime is 7471.919298171997ms
2022-09-21 05:43:13 INFO  Estimated optimisation runtime saving is 22454.07199859619ms
2022-09-21 05:43:13 INFO  ---RUNTIME: Multi-Query Optimization took 10.006427764892578 ms
2022-09-21 05:43:13 INFO  Executing generated plans
2022-09-21 05:43:22 INFO  ---RUNTIME: Execution took 8138.7670040130615 ms
2022-09-21 05:43:22 INFO  Done!
2022-09-21 05:43:22 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-21 05:43:22 INFO  Running instrumented original pipeline...
2022-09-21 05:43:22 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-21 05:43:22 INFO  ---RUNTIME: Importing and monkey-patching took 6.084680557250977 ms
2022-09-21 05:43:30 INFO  ---RUNTIME: Original pipeline execution took 8042.711496353149 ms (excluding imports and monkey-patching)
2022-09-21 05:43:30 INFO  Starting execution of 1 what-if analyses...
2022-09-21 05:43:30 INFO  Start plan generation for analysis PermutationFeatureImportance...
2022-09-21 05:43:30 INFO  ---RUNTIME: Plan generation took 0.26535987854003906 ms
2022-09-21 05:43:30 INFO  Estimated runtime of original DAG is 5598.377466201782ms
2022-09-21 05:43:30 WARNING Skipping Multi-Query Optimization (instead, only combine execution DAGs)
2022-09-21 05:43:30 INFO  Estimated unoptimised what-if runtime is 27991.88733100891ms
2022-09-21 05:43:30 INFO  ---RUNTIME: Multi-Query Optimization took 14.21046257019043 ms
2022-09-21 05:43:30 INFO  Executing generated plans
2022-09-21 05:44:02 INFO  ---RUNTIME: Execution took 32512.136220932007 ms
2022-09-21 05:44:02 INFO  Done!
2022-09-21 05:44:02 INFO  # Finished -- repetition 2 of 7 
2022-09-21 05:44:02 INFO  # Optimization benchmark for feature_importance with args [['reviews', 'fast_loading', 'featurization_1', 'xgboost']] -- repetition 3 of 7
2022-09-21 05:44:02 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-21 05:44:02 INFO  Running instrumented original pipeline...
2022-09-21 05:44:02 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-21 05:44:02 INFO  ---RUNTIME: Importing and monkey-patching took 6.106376647949219 ms
2022-09-21 05:44:11 INFO  ---RUNTIME: Original pipeline execution took 8586.18974685669 ms (excluding imports and monkey-patching)
2022-09-21 05:44:11 INFO  Starting execution of 1 what-if analyses...
2022-09-21 05:44:11 INFO  Start plan generation for analysis PermutationFeatureImportance...
2022-09-21 05:44:11 INFO  ---RUNTIME: Plan generation took 0.22649765014648438 ms
2022-09-21 05:44:11 INFO  Estimated runtime of original DAG is 5988.612174987793ms
2022-09-21 05:44:11 INFO  Performing Multi-Query Optimization
2022-09-21 05:44:11 INFO  Estimated unoptimized what-if runtime is 29943.060874938965ms
2022-09-21 05:44:11 INFO  Estimated optimised what-if runtime is 7517.810106277466ms
2022-09-21 05:44:11 INFO  Estimated optimisation runtime saving is 22425.2507686615ms
2022-09-21 05:44:11 INFO  ---RUNTIME: Multi-Query Optimization took 10.033130645751953 ms
2022-09-21 05:44:11 INFO  Executing generated plans
2022-09-21 05:44:19 INFO  ---RUNTIME: Execution took 8158.87188911438 ms
2022-09-21 05:44:19 INFO  Done!
2022-09-21 05:44:19 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-21 05:44:19 INFO  Running instrumented original pipeline...
2022-09-21 05:44:19 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-21 05:44:19 INFO  ---RUNTIME: Importing and monkey-patching took 5.995750427246094 ms
2022-09-21 05:44:27 INFO  ---RUNTIME: Original pipeline execution took 7999.905347824097 ms (excluding imports and monkey-patching)
2022-09-21 05:44:27 INFO  Starting execution of 1 what-if analyses...
2022-09-21 05:44:27 INFO  Start plan generation for analysis PermutationFeatureImportance...
2022-09-21 05:44:27 INFO  ---RUNTIME: Plan generation took 0.23865699768066406 ms
2022-09-21 05:44:27 INFO  Estimated runtime of original DAG is 5774.7368812561035ms
2022-09-21 05:44:27 WARNING Skipping Multi-Query Optimization (instead, only combine execution DAGs)
2022-09-21 05:44:27 INFO  Estimated unoptimised what-if runtime is 28873.684406280518ms
2022-09-21 05:44:27 INFO  ---RUNTIME: Multi-Query Optimization took 14.14179801940918 ms
2022-09-21 05:44:27 INFO  Executing generated plans
2022-09-21 05:44:59 INFO  ---RUNTIME: Execution took 32388.82565498352 ms
2022-09-21 05:44:59 INFO  Done!
2022-09-21 05:44:59 INFO  # Finished -- repetition 3 of 7 
2022-09-21 05:44:59 INFO  # Optimization benchmark for feature_importance with args [['reviews', 'fast_loading', 'featurization_1', 'xgboost']] -- repetition 4 of 7
2022-09-21 05:44:59 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-21 05:44:59 INFO  Running instrumented original pipeline...
2022-09-21 05:45:00 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-21 05:45:00 INFO  ---RUNTIME: Importing and monkey-patching took 6.314992904663086 ms
2022-09-21 05:45:08 INFO  ---RUNTIME: Original pipeline execution took 8948.964834213257 ms (excluding imports and monkey-patching)
2022-09-21 05:45:08 INFO  Starting execution of 1 what-if analyses...
2022-09-21 05:45:08 INFO  Start plan generation for analysis PermutationFeatureImportance...
2022-09-21 05:45:08 INFO  ---RUNTIME: Plan generation took 0.2219676971435547 ms
2022-09-21 05:45:08 INFO  Estimated runtime of original DAG is 6066.061019897461ms
2022-09-21 05:45:08 INFO  Performing Multi-Query Optimization
2022-09-21 05:45:08 INFO  Estimated unoptimized what-if runtime is 30330.305099487305ms
2022-09-21 05:45:08 INFO  Estimated optimised what-if runtime is 7840.733766555786ms
2022-09-21 05:45:08 INFO  Estimated optimisation runtime saving is 22489.57133293152ms
2022-09-21 05:45:08 INFO  ---RUNTIME: Multi-Query Optimization took 9.910106658935547 ms
2022-09-21 05:45:08 INFO  Executing generated plans
2022-09-21 05:45:16 INFO  ---RUNTIME: Execution took 8167.919874191284 ms
2022-09-21 05:45:16 INFO  Done!
2022-09-21 05:45:16 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-21 05:45:16 INFO  Running instrumented original pipeline...
2022-09-21 05:45:16 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-21 05:45:16 INFO  ---RUNTIME: Importing and monkey-patching took 5.742073059082031 ms
2022-09-21 05:45:24 INFO  ---RUNTIME: Original pipeline execution took 7915.019989013672 ms (excluding imports and monkey-patching)
2022-09-21 05:45:24 INFO  Starting execution of 1 what-if analyses...
2022-09-21 05:45:24 INFO  Start plan generation for analysis PermutationFeatureImportance...
2022-09-21 05:45:24 INFO  ---RUNTIME: Plan generation took 0.21266937255859375 ms
2022-09-21 05:45:24 INFO  Estimated runtime of original DAG is 5628.4661293029785ms
2022-09-21 05:45:24 WARNING Skipping Multi-Query Optimization (instead, only combine execution DAGs)
2022-09-21 05:45:24 INFO  Estimated unoptimised what-if runtime is 28142.330646514893ms
2022-09-21 05:45:24 INFO  ---RUNTIME: Multi-Query Optimization took 14.247894287109375 ms
2022-09-21 05:45:24 INFO  Executing generated plans
2022-09-21 05:45:57 INFO  ---RUNTIME: Execution took 32237.21694946289 ms
2022-09-21 05:45:57 INFO  Done!
2022-09-21 05:45:57 INFO  # Finished -- repetition 4 of 7 
2022-09-21 05:45:57 INFO  # Optimization benchmark for feature_importance with args [['reviews', 'fast_loading', 'featurization_1', 'xgboost']] -- repetition 5 of 7
2022-09-21 05:45:57 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-21 05:45:57 INFO  Running instrumented original pipeline...
2022-09-21 05:45:57 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-21 05:45:57 INFO  ---RUNTIME: Importing and monkey-patching took 5.8383941650390625 ms
2022-09-21 05:46:05 INFO  ---RUNTIME: Original pipeline execution took 7912.280082702637 ms (excluding imports and monkey-patching)
2022-09-21 05:46:05 INFO  Starting execution of 1 what-if analyses...
2022-09-21 05:46:05 INFO  Start plan generation for analysis PermutationFeatureImportance...
2022-09-21 05:46:05 INFO  ---RUNTIME: Plan generation took 0.23984909057617188 ms
2022-09-21 05:46:05 INFO  Estimated runtime of original DAG is 5622.150421142578ms
2022-09-21 05:46:05 INFO  Performing Multi-Query Optimization
2022-09-21 05:46:05 INFO  Estimated unoptimized what-if runtime is 28110.75210571289ms
2022-09-21 05:46:05 INFO  Estimated optimised what-if runtime is 7126.519203186035ms
2022-09-21 05:46:05 INFO  Estimated optimisation runtime saving is 20984.232902526855ms
2022-09-21 05:46:05 INFO  ---RUNTIME: Multi-Query Optimization took 10.114908218383789 ms
2022-09-21 05:46:05 INFO  Executing generated plans
2022-09-21 05:46:13 INFO  ---RUNTIME: Execution took 8021.557092666626 ms
2022-09-21 05:46:13 INFO  Done!
2022-09-21 05:46:13 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-21 05:46:13 INFO  Running instrumented original pipeline...
2022-09-21 05:46:13 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-21 05:46:13 INFO  ---RUNTIME: Importing and monkey-patching took 5.661964416503906 ms
2022-09-21 05:46:20 INFO  ---RUNTIME: Original pipeline execution took 7864.235877990723 ms (excluding imports and monkey-patching)
2022-09-21 05:46:20 INFO  Starting execution of 1 what-if analyses...
2022-09-21 05:46:20 INFO  Start plan generation for analysis PermutationFeatureImportance...
2022-09-21 05:46:20 INFO  ---RUNTIME: Plan generation took 0.21028518676757812 ms
2022-09-21 05:46:20 INFO  Estimated runtime of original DAG is 5607.995986938477ms
2022-09-21 05:46:20 WARNING Skipping Multi-Query Optimization (instead, only combine execution DAGs)
2022-09-21 05:46:20 INFO  Estimated unoptimised what-if runtime is 28039.979934692383ms
2022-09-21 05:46:20 INFO  ---RUNTIME: Multi-Query Optimization took 14.212369918823242 ms
2022-09-21 05:46:20 INFO  Executing generated plans
2022-09-21 05:46:53 INFO  ---RUNTIME: Execution took 32362.295150756836 ms
2022-09-21 05:46:53 INFO  Done!
2022-09-21 05:46:53 INFO  # Finished -- repetition 5 of 7 
2022-09-21 05:46:53 INFO  # Optimization benchmark for feature_importance with args [['reviews', 'fast_loading', 'featurization_1', 'xgboost']] -- repetition 6 of 7
2022-09-21 05:46:53 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-21 05:46:53 INFO  Running instrumented original pipeline...
2022-09-21 05:46:53 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-21 05:46:53 INFO  ---RUNTIME: Importing and monkey-patching took 5.764007568359375 ms
2022-09-21 05:47:01 INFO  ---RUNTIME: Original pipeline execution took 7797.751665115356 ms (excluding imports and monkey-patching)
2022-09-21 05:47:01 INFO  Starting execution of 1 what-if analyses...
2022-09-21 05:47:01 INFO  Start plan generation for analysis PermutationFeatureImportance...
2022-09-21 05:47:01 INFO  ---RUNTIME: Plan generation took 0.2219676971435547 ms
2022-09-21 05:47:01 INFO  Estimated runtime of original DAG is 5549.165725708008ms
2022-09-21 05:47:01 INFO  Performing Multi-Query Optimization
2022-09-21 05:47:01 INFO  Estimated unoptimized what-if runtime is 27745.82862854004ms
2022-09-21 05:47:01 INFO  Estimated optimised what-if runtime is 7050.623655319214ms
2022-09-21 05:47:01 INFO  Estimated optimisation runtime saving is 20695.204973220825ms
2022-09-21 05:47:01 INFO  ---RUNTIME: Multi-Query Optimization took 9.982824325561523 ms
2022-09-21 05:47:01 INFO  Executing generated plans
2022-09-21 05:47:09 INFO  ---RUNTIME: Execution took 7994.345188140869 ms
2022-09-21 05:47:09 INFO  Done!
2022-09-21 05:47:09 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-21 05:47:09 INFO  Running instrumented original pipeline...
2022-09-21 05:47:09 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-21 05:47:09 INFO  ---RUNTIME: Importing and monkey-patching took 6.052970886230469 ms
2022-09-21 05:47:16 INFO  ---RUNTIME: Original pipeline execution took 7803.75075340271 ms (excluding imports and monkey-patching)
2022-09-21 05:47:16 INFO  Starting execution of 1 what-if analyses...
2022-09-21 05:47:16 INFO  Start plan generation for analysis PermutationFeatureImportance...
2022-09-21 05:47:16 INFO  ---RUNTIME: Plan generation took 0.2613067626953125 ms
2022-09-21 05:47:16 INFO  Estimated runtime of original DAG is 5549.26872253418ms
2022-09-21 05:47:16 WARNING Skipping Multi-Query Optimization (instead, only combine execution DAGs)
2022-09-21 05:47:16 INFO  Estimated unoptimised what-if runtime is 27746.3436126709ms
2022-09-21 05:47:16 INFO  ---RUNTIME: Multi-Query Optimization took 14.065027236938477 ms
2022-09-21 05:47:16 INFO  Executing generated plans
2022-09-21 05:47:56 INFO  ---RUNTIME: Execution took 39325.21915435791 ms
2022-09-21 05:47:56 INFO  Done!
2022-09-21 05:47:56 INFO  # Finished -- repetition 6 of 7 
2022-09-21 05:47:56 INFO  # Optimization benchmark for feature_importance with args [['reviews', 'fast_loading', 'featurization_1', 'xgboost']] -- repetition 7 of 7
2022-09-21 05:47:56 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-21 05:47:56 INFO  Running instrumented original pipeline...
2022-09-21 05:47:56 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-21 05:47:56 INFO  ---RUNTIME: Importing and monkey-patching took 5.811214447021484 ms
2022-09-21 05:48:04 INFO  ---RUNTIME: Original pipeline execution took 8320.389747619629 ms (excluding imports and monkey-patching)
2022-09-21 05:48:04 INFO  Starting execution of 1 what-if analyses...
2022-09-21 05:48:04 INFO  Start plan generation for analysis PermutationFeatureImportance...
2022-09-21 05:48:04 INFO  ---RUNTIME: Plan generation took 0.15234947204589844 ms
2022-09-21 05:48:04 INFO  Estimated runtime of original DAG is 5934.633731842041ms
2022-09-21 05:48:04 INFO  Performing Multi-Query Optimization
2022-09-21 05:48:04 INFO  Estimated unoptimized what-if runtime is 29673.168659210205ms
2022-09-21 05:48:04 INFO  Estimated optimised what-if runtime is 7517.209053039551ms
2022-09-21 05:48:04 INFO  Estimated optimisation runtime saving is 22155.959606170654ms
2022-09-21 05:48:04 INFO  ---RUNTIME: Multi-Query Optimization took 10.835647583007812 ms
2022-09-21 05:48:04 INFO  Executing generated plans
2022-09-21 05:48:13 INFO  ---RUNTIME: Execution took 8493.98159980774 ms
2022-09-21 05:48:13 INFO  Done!
2022-09-21 05:48:13 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-21 05:48:13 INFO  Running instrumented original pipeline...
2022-09-21 05:48:13 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-21 05:48:13 INFO  ---RUNTIME: Importing and monkey-patching took 5.822420120239258 ms
2022-09-21 05:48:21 INFO  ---RUNTIME: Original pipeline execution took 8382.453680038452 ms (excluding imports and monkey-patching)
2022-09-21 05:48:21 INFO  Starting execution of 1 what-if analyses...
2022-09-21 05:48:21 INFO  Start plan generation for analysis PermutationFeatureImportance...
2022-09-21 05:48:21 INFO  ---RUNTIME: Plan generation took 0.22721290588378906 ms
2022-09-21 05:48:21 INFO  Estimated runtime of original DAG is 5699.907541275024ms
2022-09-21 05:48:21 WARNING Skipping Multi-Query Optimization (instead, only combine execution DAGs)
2022-09-21 05:48:21 INFO  Estimated unoptimised what-if runtime is 28499.537706375122ms
2022-09-21 05:48:21 INFO  ---RUNTIME: Multi-Query Optimization took 14.218568801879883 ms
2022-09-21 05:48:21 INFO  Executing generated plans
2022-09-21 05:49:42 INFO  ---RUNTIME: Execution took 80563.59958648682 ms
2022-09-21 05:49:42 INFO  Done!
2022-09-21 05:49:42 INFO  # Finished -- repetition 7 of 7 
2022-09-21 05:49:42 INFO  # Final results after all repetitions
2022-09-21 05:49:42 INFO     repetition  ... no_opt_what_if_execution_combined_model_training
0           0  ...                                      4492.876291
1           1  ...                                      4476.815224
2           2  ...                                      4348.852873
3           3  ...                                      4268.457651
4           4  ...                                      4322.646379
5           5  ...                                     11316.370964
6           6  ...                                     51995.922089

[7 rows x 26 columns]
taskset -c 32-40 PROTOCOL_BUFFERS_PYTHON_IMPLEMENTATION=python python3.9 benchmarks_end_to_end.py feature_importance reviews fast_loading featurization_1 neural_network
2022-09-21 05:49:44.429824: W tensorflow/stream_executor/platform/default/dso_loader.cc:64] Could not load dynamic library 'libcudart.so.11.0'; dlerror: libcudart.so.11.0: cannot open shared object file: No such file or directory; LD_LIBRARY_PATH: /home/sgrafbe/mlwhatif/venv/lib/python3.9/site-packages/cv2/../../lib64:
2022-09-21 05:49:44.429867: I tensorflow/stream_executor/cuda/cudart_stub.cc:29] Ignore above cudart dlerror if you do not have a GPU set up on your machine.
2022-09-21 05:49:45 INFO  Patching sys.argv with ['mlwhatif', 'reviews', 'fast_loading', 'featurization_1', 'neural_network']
2022-09-21 05:49:45 INFO  Running instrumented original pipeline...
2022-09-21 05:49:45 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-21 05:49:45 INFO  ---RUNTIME: Importing and monkey-patching took 122.45035171508789 ms
2022-09-21 05:49:51.488804: W tensorflow/stream_executor/platform/default/dso_loader.cc:64] Could not load dynamic library 'libcuda.so.1'; dlerror: libcuda.so.1: cannot open shared object file: No such file or directory; LD_LIBRARY_PATH: /home/sgrafbe/mlwhatif/venv/lib/python3.9/site-packages/cv2/../../lib64:
2022-09-21 05:49:51.488850: W tensorflow/stream_executor/cuda/cuda_driver.cc:326] failed call to cuInit: UNKNOWN ERROR (303)
2022-09-21 05:49:51.488873: I tensorflow/stream_executor/cuda/cuda_diagnostics.cc:156] kernel driver does not appear to be running on this host (angus): /proc/driver/nvidia/version does not exist
2022-09-21 05:49:51.489372: I tensorflow/core/platform/cpu_feature_guard.cc:142] This TensorFlow binary is optimized with oneAPI Deep Neural Network Library (oneDNN) to use the following CPU instructions in performance-critical operations:  AVX2 FMA
To enable them in other operations, rebuild TensorFlow with the appropriate compiler flags.
2022-09-21 05:49:51.721320: I tensorflow/compiler/mlir/mlir_graph_optimization_pass.cc:176] None of the MLIR Optimization Passes are enabled (registered 2)
2022-09-21 05:49:51.733238: I tensorflow/core/platform/profile_utils/cpu_utils.cc:114] CPU Frequency: 2595130000 Hz
2022-09-21 05:49:57 INFO  ---RUNTIME: Original pipeline execution took 11493.5781955719 ms (excluding imports and monkey-patching)
2022-09-21 05:49:57 INFO  Starting execution of 0 what-if analyses...
2022-09-21 05:49:57 INFO  Estimated runtime of original DAG is 9251.57380104065ms
2022-09-21 05:49:57 INFO  Performing Multi-Query Optimization
2022-09-21 05:49:57 INFO  Estimated unoptimized what-if runtime is 0ms
2022-09-21 05:49:57 INFO  Estimated optimised what-if runtime is 0ms
2022-09-21 05:49:57 INFO  Estimated optimisation runtime saving is 0ms
2022-09-21 05:49:57 INFO  ---RUNTIME: Multi-Query Optimization took 0.5135536193847656 ms
2022-09-21 05:49:57 INFO  Executing generated plans
2022-09-21 05:49:57 INFO  ---RUNTIME: Execution took 0.025272369384765625 ms
2022-09-21 05:49:57 INFO  Done!
2022-09-21 05:49:57 INFO  # Optimization benchmark for feature_importance with args [['reviews', 'fast_loading', 'featurization_1', 'neural_network']] -- repetition 1 of 7
2022-09-21 05:49:57 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-21 05:49:57 INFO  Running instrumented original pipeline...
2022-09-21 05:49:57 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-21 05:49:57 INFO  ---RUNTIME: Importing and monkey-patching took 5.796194076538086 ms
2022-09-21 05:50:07 INFO  ---RUNTIME: Original pipeline execution took 10590.148210525513 ms (excluding imports and monkey-patching)
2022-09-21 05:50:07 INFO  Starting execution of 1 what-if analyses...
2022-09-21 05:50:07 INFO  Start plan generation for analysis PermutationFeatureImportance...
2022-09-21 05:50:07 INFO  ---RUNTIME: Plan generation took 0.209808349609375 ms
2022-09-21 05:50:07 INFO  Estimated runtime of original DAG is 8395.891666412354ms
2022-09-21 05:50:07 INFO  Performing Multi-Query Optimization
2022-09-21 05:50:07 INFO  Estimated unoptimized what-if runtime is 41979.45833206177ms
2022-09-21 05:50:07 INFO  Estimated optimised what-if runtime is 11478.569507598877ms
2022-09-21 05:50:07 INFO  Estimated optimisation runtime saving is 30500.88882446289ms
2022-09-21 05:50:07 INFO  ---RUNTIME: Multi-Query Optimization took 10.26606559753418 ms
2022-09-21 05:50:07 INFO  Executing generated plans
2022-09-21 05:50:19 INFO  ---RUNTIME: Execution took 12009.280920028687 ms
2022-09-21 05:50:19 INFO  Done!
2022-09-21 05:50:19 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-21 05:50:19 INFO  Running instrumented original pipeline...
2022-09-21 05:50:19 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-21 05:50:20 INFO  ---RUNTIME: Importing and monkey-patching took 6.125450134277344 ms
2022-09-21 05:50:30 INFO  ---RUNTIME: Original pipeline execution took 10727.63705253601 ms (excluding imports and monkey-patching)
2022-09-21 05:50:30 INFO  Starting execution of 1 what-if analyses...
2022-09-21 05:50:30 INFO  Start plan generation for analysis PermutationFeatureImportance...
2022-09-21 05:50:30 INFO  ---RUNTIME: Plan generation took 0.11849403381347656 ms
2022-09-21 05:50:30 INFO  Estimated runtime of original DAG is 8302.897214889526ms
2022-09-21 05:50:30 WARNING Skipping Multi-Query Optimization (instead, only combine execution DAGs)
2022-09-21 05:50:30 INFO  Estimated unoptimised what-if runtime is 41514.48607444763ms
2022-09-21 05:50:30 INFO  ---RUNTIME: Multi-Query Optimization took 14.232397079467773 ms
2022-09-21 05:50:30 INFO  Executing generated plans
2022-09-21 05:51:17 INFO  ---RUNTIME: Execution took 47178.13849449158 ms
2022-09-21 05:51:17 INFO  Done!
2022-09-21 05:51:17 INFO  # Finished -- repetition 1 of 7 
2022-09-21 05:51:17 INFO  # Optimization benchmark for feature_importance with args [['reviews', 'fast_loading', 'featurization_1', 'neural_network']] -- repetition 2 of 7
2022-09-21 05:51:17 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-21 05:51:17 INFO  Running instrumented original pipeline...
2022-09-21 05:51:17 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-21 05:51:17 INFO  ---RUNTIME: Importing and monkey-patching took 5.901098251342773 ms
2022-09-21 05:51:28 INFO  ---RUNTIME: Original pipeline execution took 10699.937343597412 ms (excluding imports and monkey-patching)
2022-09-21 05:51:28 INFO  Starting execution of 1 what-if analyses...
2022-09-21 05:51:28 INFO  Start plan generation for analysis PermutationFeatureImportance...
2022-09-21 05:51:28 INFO  ---RUNTIME: Plan generation took 0.11324882507324219 ms
2022-09-21 05:51:28 INFO  Estimated runtime of original DAG is 8462.604522705078ms
2022-09-21 05:51:28 INFO  Performing Multi-Query Optimization
2022-09-21 05:51:28 INFO  Estimated unoptimized what-if runtime is 42313.02261352539ms
2022-09-21 05:51:28 INFO  Estimated optimised what-if runtime is 11548.588991165161ms
2022-09-21 05:51:28 INFO  Estimated optimisation runtime saving is 30764.43362236023ms
2022-09-21 05:51:28 INFO  ---RUNTIME: Multi-Query Optimization took 11.288166046142578 ms
2022-09-21 05:51:28 INFO  Executing generated plans
2022-09-21 05:51:40 INFO  ---RUNTIME: Execution took 12211.13657951355 ms
2022-09-21 05:51:40 INFO  Done!
2022-09-21 05:51:40 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-21 05:51:40 INFO  Running instrumented original pipeline...
2022-09-21 05:51:40 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-21 05:51:40 INFO  ---RUNTIME: Importing and monkey-patching took 6.486415863037109 ms
2022-09-21 05:51:51 INFO  ---RUNTIME: Original pipeline execution took 10536.76962852478 ms (excluding imports and monkey-patching)
2022-09-21 05:51:51 INFO  Starting execution of 1 what-if analyses...
2022-09-21 05:51:51 INFO  Start plan generation for analysis PermutationFeatureImportance...
2022-09-21 05:51:51 INFO  ---RUNTIME: Plan generation took 0.12469291687011719 ms
2022-09-21 05:51:51 INFO  Estimated runtime of original DAG is 8318.10450553894ms
2022-09-21 05:51:51 WARNING Skipping Multi-Query Optimization (instead, only combine execution DAGs)
2022-09-21 05:51:51 INFO  Estimated unoptimised what-if runtime is 41590.5225276947ms
2022-09-21 05:51:51 INFO  ---RUNTIME: Multi-Query Optimization took 14.103412628173828 ms
2022-09-21 05:51:51 INFO  Executing generated plans
2022-09-21 05:52:38 INFO  ---RUNTIME: Execution took 47553.17735671997 ms
2022-09-21 05:52:38 INFO  Done!
2022-09-21 05:52:38 INFO  # Finished -- repetition 2 of 7 
2022-09-21 05:52:38 INFO  # Optimization benchmark for feature_importance with args [['reviews', 'fast_loading', 'featurization_1', 'neural_network']] -- repetition 3 of 7
2022-09-21 05:52:38 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-21 05:52:38 INFO  Running instrumented original pipeline...
2022-09-21 05:52:38 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-21 05:52:38 INFO  ---RUNTIME: Importing and monkey-patching took 5.92494010925293 ms
2022-09-21 05:52:49 INFO  ---RUNTIME: Original pipeline execution took 10677.74510383606 ms (excluding imports and monkey-patching)
2022-09-21 05:52:49 INFO  Starting execution of 1 what-if analyses...
2022-09-21 05:52:49 INFO  Start plan generation for analysis PermutationFeatureImportance...
2022-09-21 05:52:49 INFO  ---RUNTIME: Plan generation took 0.10776519775390625 ms
2022-09-21 05:52:49 INFO  Estimated runtime of original DAG is 8430.825233459473ms
2022-09-21 05:52:49 INFO  Performing Multi-Query Optimization
2022-09-21 05:52:49 INFO  Estimated unoptimized what-if runtime is 42154.12616729736ms
2022-09-21 05:52:49 INFO  Estimated optimised what-if runtime is 11293.549537658691ms
2022-09-21 05:52:49 INFO  Estimated optimisation runtime saving is 30860.576629638672ms
2022-09-21 05:52:49 INFO  ---RUNTIME: Multi-Query Optimization took 9.768247604370117 ms
2022-09-21 05:52:49 INFO  Executing generated plans
2022-09-21 05:53:02 INFO  ---RUNTIME: Execution took 12369.25220489502 ms
2022-09-21 05:53:02 INFO  Done!
2022-09-21 05:53:02 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-21 05:53:02 INFO  Running instrumented original pipeline...
2022-09-21 05:53:02 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-21 05:53:02 INFO  ---RUNTIME: Importing and monkey-patching took 6.0577392578125 ms
2022-09-21 05:53:13 INFO  ---RUNTIME: Original pipeline execution took 11017.593145370483 ms (excluding imports and monkey-patching)
2022-09-21 05:53:13 INFO  Starting execution of 1 what-if analyses...
2022-09-21 05:53:13 INFO  Start plan generation for analysis PermutationFeatureImportance...
2022-09-21 05:53:13 INFO  ---RUNTIME: Plan generation took 0.10609626770019531 ms
2022-09-21 05:53:13 INFO  Estimated runtime of original DAG is 8382.798671722412ms
2022-09-21 05:53:13 WARNING Skipping Multi-Query Optimization (instead, only combine execution DAGs)
2022-09-21 05:53:13 INFO  Estimated unoptimised what-if runtime is 41913.99335861206ms
2022-09-21 05:53:13 INFO  ---RUNTIME: Multi-Query Optimization took 16.175031661987305 ms
2022-09-21 05:53:13 INFO  Executing generated plans
2022-09-21 05:54:00 INFO  ---RUNTIME: Execution took 47454.078674316406 ms
2022-09-21 05:54:00 INFO  Done!
2022-09-21 05:54:00 INFO  # Finished -- repetition 3 of 7 
2022-09-21 05:54:00 INFO  # Optimization benchmark for feature_importance with args [['reviews', 'fast_loading', 'featurization_1', 'neural_network']] -- repetition 4 of 7
2022-09-21 05:54:00 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-21 05:54:00 INFO  Running instrumented original pipeline...
2022-09-21 05:54:00 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-21 05:54:00 INFO  ---RUNTIME: Importing and monkey-patching took 6.29734992980957 ms
2022-09-21 05:54:11 INFO  ---RUNTIME: Original pipeline execution took 11370.865106582642 ms (excluding imports and monkey-patching)
2022-09-21 05:54:11 INFO  Starting execution of 1 what-if analyses...
2022-09-21 05:54:11 INFO  Start plan generation for analysis PermutationFeatureImportance...
2022-09-21 05:54:11 INFO  ---RUNTIME: Plan generation took 0.10156631469726562 ms
2022-09-21 05:54:11 INFO  Estimated runtime of original DAG is 8970.36862373352ms
2022-09-21 05:54:11 INFO  Performing Multi-Query Optimization
2022-09-21 05:54:11 INFO  Estimated unoptimized what-if runtime is 44851.8431186676ms
2022-09-21 05:54:11 INFO  Estimated optimised what-if runtime is 11888.846397399902ms
2022-09-21 05:54:11 INFO  Estimated optimisation runtime saving is 32962.9967212677ms
2022-09-21 05:54:11 INFO  ---RUNTIME: Multi-Query Optimization took 9.644746780395508 ms
2022-09-21 05:54:11 INFO  Executing generated plans
2022-09-21 05:54:24 INFO  ---RUNTIME: Execution took 12293.593645095825 ms
2022-09-21 05:54:24 INFO  Done!
2022-09-21 05:54:24 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-21 05:54:24 INFO  Running instrumented original pipeline...
2022-09-21 05:54:24 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-21 05:54:24 INFO  ---RUNTIME: Importing and monkey-patching took 6.05010986328125 ms
2022-09-21 05:54:34 INFO  ---RUNTIME: Original pipeline execution took 10697.362422943115 ms (excluding imports and monkey-patching)
2022-09-21 05:54:34 INFO  Starting execution of 1 what-if analyses...
2022-09-21 05:54:34 INFO  Start plan generation for analysis PermutationFeatureImportance...
2022-09-21 05:54:34 INFO  ---RUNTIME: Plan generation took 0.1270771026611328 ms
2022-09-21 05:54:34 INFO  Estimated runtime of original DAG is 8386.077404022217ms
2022-09-21 05:54:34 WARNING Skipping Multi-Query Optimization (instead, only combine execution DAGs)
2022-09-21 05:54:34 INFO  Estimated unoptimised what-if runtime is 41930.387020111084ms
2022-09-21 05:54:34 INFO  ---RUNTIME: Multi-Query Optimization took 15.500545501708984 ms
2022-09-21 05:54:34 INFO  Executing generated plans
2022-09-21 05:55:21 INFO  ---RUNTIME: Execution took 47073.15897941589 ms
2022-09-21 05:55:21 INFO  Done!
2022-09-21 05:55:22 INFO  # Finished -- repetition 4 of 7 
2022-09-21 05:55:22 INFO  # Optimization benchmark for feature_importance with args [['reviews', 'fast_loading', 'featurization_1', 'neural_network']] -- repetition 5 of 7
2022-09-21 05:55:22 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-21 05:55:22 INFO  Running instrumented original pipeline...
2022-09-21 05:55:22 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-21 05:55:22 INFO  ---RUNTIME: Importing and monkey-patching took 5.93876838684082 ms
2022-09-21 05:55:32 INFO  ---RUNTIME: Original pipeline execution took 10777.234315872192 ms (excluding imports and monkey-patching)
2022-09-21 05:55:32 INFO  Starting execution of 1 what-if analyses...
2022-09-21 05:55:32 INFO  Start plan generation for analysis PermutationFeatureImportance...
2022-09-21 05:55:32 INFO  ---RUNTIME: Plan generation took 0.10514259338378906 ms
2022-09-21 05:55:32 INFO  Estimated runtime of original DAG is 8492.968082427979ms
2022-09-21 05:55:32 INFO  Performing Multi-Query Optimization
2022-09-21 05:55:32 INFO  Estimated unoptimized what-if runtime is 42464.84041213989ms
2022-09-21 05:55:32 INFO  Estimated optimised what-if runtime is 11485.422849655151ms
2022-09-21 05:55:32 INFO  Estimated optimisation runtime saving is 30979.41756248474ms
2022-09-21 05:55:32 INFO  ---RUNTIME: Multi-Query Optimization took 9.679079055786133 ms
2022-09-21 05:55:32 INFO  Executing generated plans
2022-09-21 05:55:44 INFO  ---RUNTIME: Execution took 12124.906063079834 ms
2022-09-21 05:55:44 INFO  Done!
2022-09-21 05:55:44 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-21 05:55:44 INFO  Running instrumented original pipeline...
2022-09-21 05:55:44 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-21 05:55:44 INFO  ---RUNTIME: Importing and monkey-patching took 5.841493606567383 ms
2022-09-21 05:55:55 INFO  ---RUNTIME: Original pipeline execution took 10554.064989089966 ms (excluding imports and monkey-patching)
2022-09-21 05:55:55 INFO  Starting execution of 1 what-if analyses...
2022-09-21 05:55:55 INFO  Start plan generation for analysis PermutationFeatureImportance...
2022-09-21 05:55:55 INFO  ---RUNTIME: Plan generation took 0.09512901306152344 ms
2022-09-21 05:55:55 INFO  Estimated runtime of original DAG is 8281.129837036133ms
2022-09-21 05:55:55 WARNING Skipping Multi-Query Optimization (instead, only combine execution DAGs)
2022-09-21 05:55:55 INFO  Estimated unoptimised what-if runtime is 41405.649185180664ms
2022-09-21 05:55:55 INFO  ---RUNTIME: Multi-Query Optimization took 15.475988388061523 ms
2022-09-21 05:55:55 INFO  Executing generated plans
2022-09-21 05:56:42 INFO  ---RUNTIME: Execution took 46867.73371696472 ms
2022-09-21 05:56:42 INFO  Done!
2022-09-21 05:56:42 INFO  # Finished -- repetition 5 of 7 
2022-09-21 05:56:42 INFO  # Optimization benchmark for feature_importance with args [['reviews', 'fast_loading', 'featurization_1', 'neural_network']] -- repetition 6 of 7
2022-09-21 05:56:42 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-21 05:56:42 INFO  Running instrumented original pipeline...
2022-09-21 05:56:42 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-21 05:56:42 INFO  ---RUNTIME: Importing and monkey-patching took 5.868196487426758 ms
2022-09-21 05:56:53 INFO  ---RUNTIME: Original pipeline execution took 10733.87622833252 ms (excluding imports and monkey-patching)
2022-09-21 05:56:53 INFO  Starting execution of 1 what-if analyses...
2022-09-21 05:56:53 INFO  Start plan generation for analysis PermutationFeatureImportance...
2022-09-21 05:56:53 INFO  ---RUNTIME: Plan generation took 0.10180473327636719 ms
2022-09-21 05:56:53 INFO  Estimated runtime of original DAG is 8446.47765159607ms
2022-09-21 05:56:53 INFO  Performing Multi-Query Optimization
2022-09-21 05:56:53 INFO  Estimated unoptimized what-if runtime is 42232.38825798035ms
2022-09-21 05:56:53 INFO  Estimated optimised what-if runtime is 11379.361867904663ms
2022-09-21 05:56:53 INFO  Estimated optimisation runtime saving is 30853.026390075684ms
2022-09-21 05:56:53 INFO  ---RUNTIME: Multi-Query Optimization took 11.496543884277344 ms
2022-09-21 05:56:53 INFO  Executing generated plans
2022-09-21 05:57:05 INFO  ---RUNTIME: Execution took 12199.634790420532 ms
2022-09-21 05:57:05 INFO  Done!
2022-09-21 05:57:05 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-21 05:57:05 INFO  Running instrumented original pipeline...
2022-09-21 05:57:05 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-21 05:57:05 INFO  ---RUNTIME: Importing and monkey-patching took 5.9661865234375 ms
2022-09-21 05:57:15 INFO  ---RUNTIME: Original pipeline execution took 10640.629291534424 ms (excluding imports and monkey-patching)
2022-09-21 05:57:15 INFO  Starting execution of 1 what-if analyses...
2022-09-21 05:57:15 INFO  Start plan generation for analysis PermutationFeatureImportance...
2022-09-21 05:57:15 INFO  ---RUNTIME: Plan generation took 0.10919570922851562 ms
2022-09-21 05:57:15 INFO  Estimated runtime of original DAG is 8378.587245941162ms
2022-09-21 05:57:15 WARNING Skipping Multi-Query Optimization (instead, only combine execution DAGs)
2022-09-21 05:57:15 INFO  Estimated unoptimised what-if runtime is 41892.93622970581ms
2022-09-21 05:57:15 INFO  ---RUNTIME: Multi-Query Optimization took 14.48369026184082 ms
2022-09-21 05:57:15 INFO  Executing generated plans
2022-09-21 05:58:02 INFO  ---RUNTIME: Execution took 46778.53083610535 ms
2022-09-21 05:58:02 INFO  Done!
2022-09-21 05:58:02 INFO  # Finished -- repetition 6 of 7 
2022-09-21 05:58:02 INFO  # Optimization benchmark for feature_importance with args [['reviews', 'fast_loading', 'featurization_1', 'neural_network']] -- repetition 7 of 7
2022-09-21 05:58:02 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-21 05:58:02 INFO  Running instrumented original pipeline...
2022-09-21 05:58:02 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-21 05:58:02 INFO  ---RUNTIME: Importing and monkey-patching took 6.064653396606445 ms
2022-09-21 05:58:13 INFO  ---RUNTIME: Original pipeline execution took 10809.604167938232 ms (excluding imports and monkey-patching)
2022-09-21 05:58:13 INFO  Starting execution of 1 what-if analyses...
2022-09-21 05:58:13 INFO  Start plan generation for analysis PermutationFeatureImportance...
2022-09-21 05:58:13 INFO  ---RUNTIME: Plan generation took 0.102996826171875 ms
2022-09-21 05:58:13 INFO  Estimated runtime of original DAG is 8521.271467208862ms
2022-09-21 05:58:13 INFO  Performing Multi-Query Optimization
2022-09-21 05:58:13 INFO  Estimated unoptimized what-if runtime is 42606.35733604431ms
2022-09-21 05:58:13 INFO  Estimated optimised what-if runtime is 11508.544206619263ms
2022-09-21 05:58:13 INFO  Estimated optimisation runtime saving is 31097.81312942505ms
2022-09-21 05:58:13 INFO  ---RUNTIME: Multi-Query Optimization took 11.223316192626953 ms
2022-09-21 05:58:13 INFO  Executing generated plans
2022-09-21 05:58:25 INFO  ---RUNTIME: Execution took 12201.984167098999 ms
2022-09-21 05:58:25 INFO  Done!
2022-09-21 05:58:25 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-21 05:58:25 INFO  Running instrumented original pipeline...
2022-09-21 05:58:26 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-21 05:58:26 INFO  ---RUNTIME: Importing and monkey-patching took 5.91731071472168 ms
2022-09-21 05:58:37 INFO  ---RUNTIME: Original pipeline execution took 11272.597074508667 ms (excluding imports and monkey-patching)
2022-09-21 05:58:37 INFO  Starting execution of 1 what-if analyses...
2022-09-21 05:58:37 INFO  Start plan generation for analysis PermutationFeatureImportance...
2022-09-21 05:58:37 INFO  ---RUNTIME: Plan generation took 0.11372566223144531 ms
2022-09-21 05:58:37 INFO  Estimated runtime of original DAG is 8513.487815856934ms
2022-09-21 05:58:37 WARNING Skipping Multi-Query Optimization (instead, only combine execution DAGs)
2022-09-21 05:58:37 INFO  Estimated unoptimised what-if runtime is 42567.43907928467ms
2022-09-21 05:58:37 INFO  ---RUNTIME: Multi-Query Optimization took 14.840364456176758 ms
2022-09-21 05:58:37 INFO  Executing generated plans
2022-09-21 05:59:23 INFO  ---RUNTIME: Execution took 46232.45811462402 ms
2022-09-21 05:59:23 INFO  Done!
2022-09-21 05:59:23 INFO  # Finished -- repetition 7 of 7 
2022-09-21 05:59:23 INFO  # Final results after all repetitions
2022-09-21 05:59:23 INFO     repetition  ... no_opt_what_if_execution_combined_model_training
0           0  ...                                     16507.721186
1           1  ...                                     17163.589478
2           2  ...                                     16977.076530
3           3  ...                                     17232.276440
4           4  ...                                     17020.146608
5           5  ...                                     16931.387186
6           6  ...                                     16283.209562

[7 rows x 26 columns]
taskset -c 32-40 PROTOCOL_BUFFERS_PYTHON_IMPLEMENTATION=python python3.9 benchmarks_end_to_end.py feature_importance reviews fast_loading featurization_2 logistic_regression
2022-09-21 05:59:25.902408: W tensorflow/stream_executor/platform/default/dso_loader.cc:64] Could not load dynamic library 'libcudart.so.11.0'; dlerror: libcudart.so.11.0: cannot open shared object file: No such file or directory; LD_LIBRARY_PATH: /home/sgrafbe/mlwhatif/venv/lib/python3.9/site-packages/cv2/../../lib64:
2022-09-21 05:59:25.902453: I tensorflow/stream_executor/cuda/cudart_stub.cc:29] Ignore above cudart dlerror if you do not have a GPU set up on your machine.
2022-09-21 05:59:27 INFO  Patching sys.argv with ['mlwhatif', 'reviews', 'fast_loading', 'featurization_2', 'logistic_regression']
2022-09-21 05:59:27 INFO  Running instrumented original pipeline...
2022-09-21 05:59:27 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-21 05:59:27 INFO  ---RUNTIME: Importing and monkey-patching took 120.59569358825684 ms
2022-09-21 05:59:34 INFO  ---RUNTIME: Original pipeline execution took 6696.223497390747 ms (excluding imports and monkey-patching)
2022-09-21 05:59:34 INFO  Starting execution of 0 what-if analyses...
2022-09-21 05:59:34 INFO  Estimated runtime of original DAG is 5492.616891860962ms
2022-09-21 05:59:34 INFO  Performing Multi-Query Optimization
2022-09-21 05:59:34 INFO  Estimated unoptimized what-if runtime is 0ms
2022-09-21 05:59:34 INFO  Estimated optimised what-if runtime is 0ms
2022-09-21 05:59:34 INFO  Estimated optimisation runtime saving is 0ms
2022-09-21 05:59:34 INFO  ---RUNTIME: Multi-Query Optimization took 0.5841255187988281 ms
2022-09-21 05:59:34 INFO  Executing generated plans
2022-09-21 05:59:34 INFO  ---RUNTIME: Execution took 0.025033950805664062 ms
2022-09-21 05:59:34 INFO  Done!
2022-09-21 05:59:34 INFO  # Optimization benchmark for feature_importance with args [['reviews', 'fast_loading', 'featurization_2', 'logistic_regression']] -- repetition 1 of 7
2022-09-21 05:59:34 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-21 05:59:34 INFO  Running instrumented original pipeline...
2022-09-21 05:59:34 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-21 05:59:34 INFO  ---RUNTIME: Importing and monkey-patching took 5.452632904052734 ms
2022-09-21 05:59:40 INFO  ---RUNTIME: Original pipeline execution took 6817.108392715454 ms (excluding imports and monkey-patching)
2022-09-21 05:59:40 INFO  Starting execution of 1 what-if analyses...
2022-09-21 05:59:40 INFO  Start plan generation for analysis PermutationFeatureImportance...
2022-09-21 05:59:40 INFO  ---RUNTIME: Plan generation took 0.1823902130126953 ms
2022-09-21 05:59:40 INFO  Estimated runtime of original DAG is 5624.6018409729ms
2022-09-21 05:59:40 INFO  Performing Multi-Query Optimization
2022-09-21 05:59:40 INFO  Estimated unoptimized what-if runtime is 28123.009204864502ms
2022-09-21 05:59:40 INFO  Estimated optimised what-if runtime is 7195.38950920105ms
2022-09-21 05:59:40 INFO  Estimated optimisation runtime saving is 20927.619695663452ms
2022-09-21 05:59:40 INFO  ---RUNTIME: Multi-Query Optimization took 10.682821273803711 ms
2022-09-21 05:59:40 INFO  Executing generated plans
2022-09-21 05:59:48 INFO  ---RUNTIME: Execution took 7937.232732772827 ms
2022-09-21 05:59:48 INFO  Done!
2022-09-21 05:59:48 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-21 05:59:48 INFO  Running instrumented original pipeline...
2022-09-21 05:59:48 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-21 05:59:48 INFO  ---RUNTIME: Importing and monkey-patching took 6.109476089477539 ms
2022-09-21 05:59:55 INFO  ---RUNTIME: Original pipeline execution took 6630.475759506226 ms (excluding imports and monkey-patching)
2022-09-21 05:59:55 INFO  Starting execution of 1 what-if analyses...
2022-09-21 05:59:55 INFO  Start plan generation for analysis PermutationFeatureImportance...
2022-09-21 05:59:55 INFO  ---RUNTIME: Plan generation took 0.12993812561035156 ms
2022-09-21 05:59:55 INFO  Estimated runtime of original DAG is 5431.646823883057ms
2022-09-21 05:59:55 WARNING Skipping Multi-Query Optimization (instead, only combine execution DAGs)
2022-09-21 05:59:55 INFO  Estimated unoptimised what-if runtime is 27158.234119415283ms
2022-09-21 05:59:55 INFO  ---RUNTIME: Multi-Query Optimization took 15.668869018554688 ms
2022-09-21 05:59:55 INFO  Executing generated plans
2022-09-21 06:00:27 INFO  ---RUNTIME: Execution took 31698.11511039734 ms
2022-09-21 06:00:27 INFO  Done!
2022-09-21 06:00:27 INFO  # Finished -- repetition 1 of 7 
2022-09-21 06:00:27 INFO  # Optimization benchmark for feature_importance with args [['reviews', 'fast_loading', 'featurization_2', 'logistic_regression']] -- repetition 2 of 7
2022-09-21 06:00:27 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-21 06:00:27 INFO  Running instrumented original pipeline...
2022-09-21 06:00:27 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-21 06:00:27 INFO  ---RUNTIME: Importing and monkey-patching took 6.240606307983398 ms
2022-09-21 06:00:33 INFO  ---RUNTIME: Original pipeline execution took 6653.339385986328 ms (excluding imports and monkey-patching)
2022-09-21 06:00:33 INFO  Starting execution of 1 what-if analyses...
2022-09-21 06:00:33 INFO  Start plan generation for analysis PermutationFeatureImportance...
2022-09-21 06:00:33 INFO  ---RUNTIME: Plan generation took 0.1327991485595703 ms
2022-09-21 06:00:33 INFO  Estimated runtime of original DAG is 5456.037521362305ms
2022-09-21 06:00:33 INFO  Performing Multi-Query Optimization
2022-09-21 06:00:33 INFO  Estimated unoptimized what-if runtime is 27280.187606811523ms
2022-09-21 06:00:33 INFO  Estimated optimised what-if runtime is 7019.101858139038ms
2022-09-21 06:00:33 INFO  Estimated optimisation runtime saving is 20261.085748672485ms
2022-09-21 06:00:33 INFO  ---RUNTIME: Multi-Query Optimization took 10.716915130615234 ms
2022-09-21 06:00:33 INFO  Executing generated plans
2022-09-21 06:00:41 INFO  ---RUNTIME: Execution took 7907.784461975098 ms
2022-09-21 06:00:41 INFO  Done!
2022-09-21 06:00:41 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-21 06:00:41 INFO  Running instrumented original pipeline...
2022-09-21 06:00:41 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-21 06:00:41 INFO  ---RUNTIME: Importing and monkey-patching took 5.745172500610352 ms
2022-09-21 06:00:48 INFO  ---RUNTIME: Original pipeline execution took 6637.808322906494 ms (excluding imports and monkey-patching)
2022-09-21 06:00:48 INFO  Starting execution of 1 what-if analyses...
2022-09-21 06:00:48 INFO  Start plan generation for analysis PermutationFeatureImportance...
2022-09-21 06:00:48 INFO  ---RUNTIME: Plan generation took 0.10251998901367188 ms
2022-09-21 06:00:48 INFO  Estimated runtime of original DAG is 5436.593294143677ms
2022-09-21 06:00:48 WARNING Skipping Multi-Query Optimization (instead, only combine execution DAGs)
2022-09-21 06:00:48 INFO  Estimated unoptimised what-if runtime is 27182.966470718384ms
2022-09-21 06:00:48 INFO  ---RUNTIME: Multi-Query Optimization took 15.185117721557617 ms
2022-09-21 06:00:48 INFO  Executing generated plans
2022-09-21 06:01:20 INFO  ---RUNTIME: Execution took 31646.570920944214 ms
2022-09-21 06:01:20 INFO  Done!
2022-09-21 06:01:20 INFO  # Finished -- repetition 2 of 7 
2022-09-21 06:01:20 INFO  # Optimization benchmark for feature_importance with args [['reviews', 'fast_loading', 'featurization_2', 'logistic_regression']] -- repetition 3 of 7
2022-09-21 06:01:20 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-21 06:01:20 INFO  Running instrumented original pipeline...
2022-09-21 06:01:20 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-21 06:01:20 INFO  ---RUNTIME: Importing and monkey-patching took 6.109952926635742 ms
2022-09-21 06:01:26 INFO  ---RUNTIME: Original pipeline execution took 6692.183494567871 ms (excluding imports and monkey-patching)
2022-09-21 06:01:26 INFO  Starting execution of 1 what-if analyses...
2022-09-21 06:01:26 INFO  Start plan generation for analysis PermutationFeatureImportance...
2022-09-21 06:01:26 INFO  ---RUNTIME: Plan generation took 0.12493133544921875 ms
2022-09-21 06:01:26 INFO  Estimated runtime of original DAG is 5482.427597045898ms
2022-09-21 06:01:26 INFO  Performing Multi-Query Optimization
2022-09-21 06:01:26 INFO  Estimated unoptimized what-if runtime is 27412.137985229492ms
2022-09-21 06:01:26 INFO  Estimated optimised what-if runtime is 7043.485403060913ms
2022-09-21 06:01:26 INFO  Estimated optimisation runtime saving is 20368.65258216858ms
2022-09-21 06:01:26 INFO  ---RUNTIME: Multi-Query Optimization took 10.652542114257812 ms
2022-09-21 06:01:26 INFO  Executing generated plans
2022-09-21 06:01:34 INFO  ---RUNTIME: Execution took 7921.256065368652 ms
2022-09-21 06:01:34 INFO  Done!
2022-09-21 06:01:34 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-21 06:01:34 INFO  Running instrumented original pipeline...
2022-09-21 06:01:34 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-21 06:01:34 INFO  ---RUNTIME: Importing and monkey-patching took 5.572080612182617 ms
2022-09-21 06:01:41 INFO  ---RUNTIME: Original pipeline execution took 6647.077560424805 ms (excluding imports and monkey-patching)
2022-09-21 06:01:41 INFO  Starting execution of 1 what-if analyses...
2022-09-21 06:01:41 INFO  Start plan generation for analysis PermutationFeatureImportance...
2022-09-21 06:01:41 INFO  ---RUNTIME: Plan generation took 0.09703636169433594 ms
2022-09-21 06:01:41 INFO  Estimated runtime of original DAG is 5454.604625701904ms
2022-09-21 06:01:41 WARNING Skipping Multi-Query Optimization (instead, only combine execution DAGs)
2022-09-21 06:01:41 INFO  Estimated unoptimised what-if runtime is 27273.02312850952ms
2022-09-21 06:01:41 INFO  ---RUNTIME: Multi-Query Optimization took 15.360832214355469 ms
2022-09-21 06:01:41 INFO  Executing generated plans
2022-09-21 06:02:13 INFO  ---RUNTIME: Execution took 31973.957061767578 ms
2022-09-21 06:02:13 INFO  Done!
2022-09-21 06:02:13 INFO  # Finished -- repetition 3 of 7 
2022-09-21 06:02:13 INFO  # Optimization benchmark for feature_importance with args [['reviews', 'fast_loading', 'featurization_2', 'logistic_regression']] -- repetition 4 of 7
2022-09-21 06:02:13 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-21 06:02:13 INFO  Running instrumented original pipeline...
2022-09-21 06:02:13 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-21 06:02:13 INFO  ---RUNTIME: Importing and monkey-patching took 5.850791931152344 ms
2022-09-21 06:02:20 INFO  ---RUNTIME: Original pipeline execution took 7324.8724937438965 ms (excluding imports and monkey-patching)
2022-09-21 06:02:20 INFO  Starting execution of 1 what-if analyses...
2022-09-21 06:02:20 INFO  Start plan generation for analysis PermutationFeatureImportance...
2022-09-21 06:02:20 INFO  ---RUNTIME: Plan generation took 0.11444091796875 ms
2022-09-21 06:02:20 INFO  Estimated runtime of original DAG is 5707.445383071899ms
2022-09-21 06:02:20 INFO  Performing Multi-Query Optimization
2022-09-21 06:02:20 INFO  Estimated unoptimized what-if runtime is 28537.226915359497ms
2022-09-21 06:02:20 INFO  Estimated optimised what-if runtime is 7283.798694610596ms
2022-09-21 06:02:20 INFO  Estimated optimisation runtime saving is 21253.4282207489ms
2022-09-21 06:02:20 INFO  ---RUNTIME: Multi-Query Optimization took 10.458707809448242 ms
2022-09-21 06:02:20 INFO  Executing generated plans
2022-09-21 06:02:28 INFO  ---RUNTIME: Execution took 8246.487617492676 ms
2022-09-21 06:02:28 INFO  Done!
2022-09-21 06:02:28 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-21 06:02:28 INFO  Running instrumented original pipeline...
2022-09-21 06:02:28 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-21 06:02:28 INFO  ---RUNTIME: Importing and monkey-patching took 5.700349807739258 ms
2022-09-21 06:02:35 INFO  ---RUNTIME: Original pipeline execution took 6756.731748580933 ms (excluding imports and monkey-patching)
2022-09-21 06:02:35 INFO  Starting execution of 1 what-if analyses...
2022-09-21 06:02:35 INFO  Start plan generation for analysis PermutationFeatureImportance...
2022-09-21 06:02:35 INFO  ---RUNTIME: Plan generation took 0.09703636169433594 ms
2022-09-21 06:02:35 INFO  Estimated runtime of original DAG is 5541.46933555603ms
2022-09-21 06:02:35 WARNING Skipping Multi-Query Optimization (instead, only combine execution DAGs)
2022-09-21 06:02:35 INFO  Estimated unoptimised what-if runtime is 27707.34667778015ms
2022-09-21 06:02:35 INFO  ---RUNTIME: Multi-Query Optimization took 15.015363693237305 ms
2022-09-21 06:02:35 INFO  Executing generated plans
2022-09-21 06:03:08 INFO  ---RUNTIME: Execution took 32767.15922355652 ms
2022-09-21 06:03:08 INFO  Done!
2022-09-21 06:03:08 INFO  # Finished -- repetition 4 of 7 
2022-09-21 06:03:08 INFO  # Optimization benchmark for feature_importance with args [['reviews', 'fast_loading', 'featurization_2', 'logistic_regression']] -- repetition 5 of 7
2022-09-21 06:03:08 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-21 06:03:08 INFO  Running instrumented original pipeline...
2022-09-21 06:03:08 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-21 06:03:08 INFO  ---RUNTIME: Importing and monkey-patching took 6.170034408569336 ms
2022-09-21 06:03:15 INFO  ---RUNTIME: Original pipeline execution took 6765.296459197998 ms (excluding imports and monkey-patching)
2022-09-21 06:03:15 INFO  Starting execution of 1 what-if analyses...
2022-09-21 06:03:15 INFO  Start plan generation for analysis PermutationFeatureImportance...
2022-09-21 06:03:15 INFO  ---RUNTIME: Plan generation took 0.12230873107910156 ms
2022-09-21 06:03:15 INFO  Estimated runtime of original DAG is 5557.254791259766ms
2022-09-21 06:03:15 INFO  Performing Multi-Query Optimization
2022-09-21 06:03:15 INFO  Estimated unoptimized what-if runtime is 27786.273956298828ms
2022-09-21 06:03:15 INFO  Estimated optimised what-if runtime is 7138.491868972778ms
2022-09-21 06:03:15 INFO  Estimated optimisation runtime saving is 20647.78208732605ms
2022-09-21 06:03:15 INFO  ---RUNTIME: Multi-Query Optimization took 10.470151901245117 ms
2022-09-21 06:03:15 INFO  Executing generated plans
2022-09-21 06:03:23 INFO  ---RUNTIME: Execution took 8355.197668075562 ms
2022-09-21 06:03:23 INFO  Done!
2022-09-21 06:03:23 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-21 06:03:23 INFO  Running instrumented original pipeline...
2022-09-21 06:03:23 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-21 06:03:23 INFO  ---RUNTIME: Importing and monkey-patching took 5.712985992431641 ms
2022-09-21 06:03:30 INFO  ---RUNTIME: Original pipeline execution took 6750.895261764526 ms (excluding imports and monkey-patching)
2022-09-21 06:03:30 INFO  Starting execution of 1 what-if analyses...
2022-09-21 06:03:30 INFO  Start plan generation for analysis PermutationFeatureImportance...
2022-09-21 06:03:30 INFO  ---RUNTIME: Plan generation took 0.09989738464355469 ms
2022-09-21 06:03:30 INFO  Estimated runtime of original DAG is 5530.266523361206ms
2022-09-21 06:03:30 WARNING Skipping Multi-Query Optimization (instead, only combine execution DAGs)
2022-09-21 06:03:30 INFO  Estimated unoptimised what-if runtime is 27651.33261680603ms
2022-09-21 06:03:30 INFO  ---RUNTIME: Multi-Query Optimization took 14.77813720703125 ms
2022-09-21 06:03:30 INFO  Executing generated plans
2022-09-21 06:04:02 INFO  ---RUNTIME: Execution took 32509.3891620636 ms
2022-09-21 06:04:02 INFO  Done!
2022-09-21 06:04:02 INFO  # Finished -- repetition 5 of 7 
2022-09-21 06:04:02 INFO  # Optimization benchmark for feature_importance with args [['reviews', 'fast_loading', 'featurization_2', 'logistic_regression']] -- repetition 6 of 7
2022-09-21 06:04:02 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-21 06:04:02 INFO  Running instrumented original pipeline...
2022-09-21 06:04:02 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-21 06:04:02 INFO  ---RUNTIME: Importing and monkey-patching took 6.065607070922852 ms
2022-09-21 06:04:09 INFO  ---RUNTIME: Original pipeline execution took 6935.264110565186 ms (excluding imports and monkey-patching)
2022-09-21 06:04:09 INFO  Starting execution of 1 what-if analyses...
2022-09-21 06:04:09 INFO  Start plan generation for analysis PermutationFeatureImportance...
2022-09-21 06:04:09 INFO  ---RUNTIME: Plan generation took 0.12230873107910156 ms
2022-09-21 06:04:09 INFO  Estimated runtime of original DAG is 5583.789587020874ms
2022-09-21 06:04:09 INFO  Performing Multi-Query Optimization
2022-09-21 06:04:09 INFO  Estimated unoptimized what-if runtime is 27918.94793510437ms
2022-09-21 06:04:09 INFO  Estimated optimised what-if runtime is 7149.341583251953ms
2022-09-21 06:04:09 INFO  Estimated optimisation runtime saving is 20769.606351852417ms
2022-09-21 06:04:09 INFO  ---RUNTIME: Multi-Query Optimization took 10.499715805053711 ms
2022-09-21 06:04:09 INFO  Executing generated plans
2022-09-21 06:04:18 INFO  ---RUNTIME: Execution took 8152.600526809692 ms
2022-09-21 06:04:18 INFO  Done!
2022-09-21 06:04:18 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-21 06:04:18 INFO  Running instrumented original pipeline...
2022-09-21 06:04:18 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-21 06:04:18 INFO  ---RUNTIME: Importing and monkey-patching took 5.679130554199219 ms
2022-09-21 06:04:24 INFO  ---RUNTIME: Original pipeline execution took 6898.156404495239 ms (excluding imports and monkey-patching)
2022-09-21 06:04:24 INFO  Starting execution of 1 what-if analyses...
2022-09-21 06:04:24 INFO  Start plan generation for analysis PermutationFeatureImportance...
2022-09-21 06:04:24 INFO  ---RUNTIME: Plan generation took 0.10085105895996094 ms
2022-09-21 06:04:24 INFO  Estimated runtime of original DAG is 5656.085968017578ms
2022-09-21 06:04:24 WARNING Skipping Multi-Query Optimization (instead, only combine execution DAGs)
2022-09-21 06:04:24 INFO  Estimated unoptimised what-if runtime is 28280.42984008789ms
2022-09-21 06:04:24 INFO  ---RUNTIME: Multi-Query Optimization took 14.997482299804688 ms
2022-09-21 06:04:24 INFO  Executing generated plans
2022-09-21 06:04:57 INFO  ---RUNTIME: Execution took 32197.937965393066 ms
2022-09-21 06:04:57 INFO  Done!
2022-09-21 06:04:57 INFO  # Finished -- repetition 6 of 7 
2022-09-21 06:04:57 INFO  # Optimization benchmark for feature_importance with args [['reviews', 'fast_loading', 'featurization_2', 'logistic_regression']] -- repetition 7 of 7
2022-09-21 06:04:57 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-21 06:04:57 INFO  Running instrumented original pipeline...
2022-09-21 06:04:57 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-21 06:04:57 INFO  ---RUNTIME: Importing and monkey-patching took 7.872819900512695 ms
2022-09-21 06:05:04 INFO  ---RUNTIME: Original pipeline execution took 7031.209468841553 ms (excluding imports and monkey-patching)
2022-09-21 06:05:04 INFO  Starting execution of 1 what-if analyses...
2022-09-21 06:05:04 INFO  Start plan generation for analysis PermutationFeatureImportance...
2022-09-21 06:05:04 INFO  ---RUNTIME: Plan generation took 0.12636184692382812 ms
2022-09-21 06:05:04 INFO  Estimated runtime of original DAG is 5799.631834030151ms
2022-09-21 06:05:04 INFO  Performing Multi-Query Optimization
2022-09-21 06:05:04 INFO  Estimated unoptimized what-if runtime is 28998.159170150757ms
2022-09-21 06:05:04 INFO  Estimated optimised what-if runtime is 7366.739273071289ms
2022-09-21 06:05:04 INFO  Estimated optimisation runtime saving is 21631.419897079468ms
2022-09-21 06:05:04 INFO  ---RUNTIME: Multi-Query Optimization took 10.475873947143555 ms
2022-09-21 06:05:04 INFO  Executing generated plans
2022-09-21 06:05:12 INFO  ---RUNTIME: Execution took 8130.154609680176 ms
2022-09-21 06:05:12 INFO  Done!
2022-09-21 06:05:12 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-21 06:05:12 INFO  Running instrumented original pipeline...
2022-09-21 06:05:12 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-21 06:05:12 INFO  ---RUNTIME: Importing and monkey-patching took 5.621194839477539 ms
2022-09-21 06:05:19 INFO  ---RUNTIME: Original pipeline execution took 7276.51047706604 ms (excluding imports and monkey-patching)
2022-09-21 06:05:19 INFO  Starting execution of 1 what-if analyses...
2022-09-21 06:05:19 INFO  Start plan generation for analysis PermutationFeatureImportance...
2022-09-21 06:05:19 INFO  ---RUNTIME: Plan generation took 0.09965896606445312 ms
2022-09-21 06:05:19 INFO  Estimated runtime of original DAG is 5915.187120437622ms
2022-09-21 06:05:19 WARNING Skipping Multi-Query Optimization (instead, only combine execution DAGs)
2022-09-21 06:05:19 INFO  Estimated unoptimised what-if runtime is 29575.93560218811ms
2022-09-21 06:05:19 INFO  ---RUNTIME: Multi-Query Optimization took 14.953136444091797 ms
2022-09-21 06:05:19 INFO  Executing generated plans
2022-09-21 06:05:51 INFO  ---RUNTIME: Execution took 31983.59751701355 ms
2022-09-21 06:05:51 INFO  Done!
2022-09-21 06:05:51 INFO  # Finished -- repetition 7 of 7 
2022-09-21 06:05:51 INFO  # Final results after all repetitions
2022-09-21 06:05:51 INFO     repetition  ... no_opt_what_if_execution_combined_model_training
0           0  ...                                       524.463177
1           1  ...                                       514.517069
2           2  ...                                       523.112535
3           3  ...                                       520.749569
4           4  ...                                       513.654947
5           5  ...                                       727.822304
6           6  ...                                       518.582582

[7 rows x 26 columns]
taskset -c 32-40 PROTOCOL_BUFFERS_PYTHON_IMPLEMENTATION=python python3.9 benchmarks_end_to_end.py feature_importance reviews fast_loading featurization_2 xgboost
2022-09-21 06:05:53.840932: W tensorflow/stream_executor/platform/default/dso_loader.cc:64] Could not load dynamic library 'libcudart.so.11.0'; dlerror: libcudart.so.11.0: cannot open shared object file: No such file or directory; LD_LIBRARY_PATH: /home/sgrafbe/mlwhatif/venv/lib/python3.9/site-packages/cv2/../../lib64:
2022-09-21 06:05:53.840980: I tensorflow/stream_executor/cuda/cudart_stub.cc:29] Ignore above cudart dlerror if you do not have a GPU set up on your machine.
2022-09-21 06:05:55 INFO  Patching sys.argv with ['mlwhatif', 'reviews', 'fast_loading', 'featurization_2', 'xgboost']
2022-09-21 06:05:55 INFO  Running instrumented original pipeline...
2022-09-21 06:05:55 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-21 06:05:55 INFO  ---RUNTIME: Importing and monkey-patching took 151.4894962310791 ms
2022-09-21 06:06:29 INFO  ---RUNTIME: Original pipeline execution took 33822.45421409607 ms (excluding imports and monkey-patching)
2022-09-21 06:06:29 INFO  Starting execution of 0 what-if analyses...
2022-09-21 06:06:29 INFO  Estimated runtime of original DAG is 32469.331979751587ms
2022-09-21 06:06:29 INFO  Performing Multi-Query Optimization
2022-09-21 06:06:29 INFO  Estimated unoptimized what-if runtime is 0ms
2022-09-21 06:06:29 INFO  Estimated optimised what-if runtime is 0ms
2022-09-21 06:06:29 INFO  Estimated optimisation runtime saving is 0ms
2022-09-21 06:06:29 INFO  ---RUNTIME: Multi-Query Optimization took 0.5345344543457031 ms
2022-09-21 06:06:29 INFO  Executing generated plans
2022-09-21 06:06:29 INFO  ---RUNTIME: Execution took 0.026226043701171875 ms
2022-09-21 06:06:29 INFO  Done!
2022-09-21 06:06:29 INFO  # Optimization benchmark for feature_importance with args [['reviews', 'fast_loading', 'featurization_2', 'xgboost']] -- repetition 1 of 7
2022-09-21 06:06:29 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-21 06:06:29 INFO  Running instrumented original pipeline...
2022-09-21 06:06:29 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-21 06:06:29 INFO  ---RUNTIME: Importing and monkey-patching took 5.401134490966797 ms
2022-09-21 06:07:03 INFO  ---RUNTIME: Original pipeline execution took 34406.50749206543 ms (excluding imports and monkey-patching)
2022-09-21 06:07:03 INFO  Starting execution of 1 what-if analyses...
2022-09-21 06:07:03 INFO  Start plan generation for analysis PermutationFeatureImportance...
2022-09-21 06:07:03 INFO  ---RUNTIME: Plan generation took 0.29277801513671875 ms
2022-09-21 06:07:03 INFO  Estimated runtime of original DAG is 33030.083656311035ms
2022-09-21 06:07:03 INFO  Performing Multi-Query Optimization
2022-09-21 06:07:03 INFO  Estimated unoptimized what-if runtime is 165150.41828155518ms
2022-09-21 06:07:03 INFO  Estimated optimised what-if runtime is 35448.13346862793ms
2022-09-21 06:07:03 INFO  Estimated optimisation runtime saving is 129702.28481292725ms
2022-09-21 06:07:03 INFO  ---RUNTIME: Multi-Query Optimization took 14.680862426757812 ms
2022-09-21 06:07:03 INFO  Executing generated plans
2022-09-21 06:07:52 INFO  ---RUNTIME: Execution took 48170.9406375885 ms
2022-09-21 06:07:52 INFO  Done!
2022-09-21 06:07:52 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-21 06:07:52 INFO  Running instrumented original pipeline...
2022-09-21 06:07:52 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-21 06:07:52 INFO  ---RUNTIME: Importing and monkey-patching took 6.160974502563477 ms
2022-09-21 06:08:33 INFO  ---RUNTIME: Original pipeline execution took 41149.68800544739 ms (excluding imports and monkey-patching)
2022-09-21 06:08:33 INFO  Starting execution of 1 what-if analyses...
2022-09-21 06:08:33 INFO  Start plan generation for analysis PermutationFeatureImportance...
2022-09-21 06:08:33 INFO  ---RUNTIME: Plan generation took 0.1289844512939453 ms
2022-09-21 06:08:33 INFO  Estimated runtime of original DAG is 39962.252616882324ms
2022-09-21 06:08:33 WARNING Skipping Multi-Query Optimization (instead, only combine execution DAGs)
2022-09-21 06:08:33 INFO  Estimated unoptimised what-if runtime is 199811.26308441162ms
2022-09-21 06:08:33 INFO  ---RUNTIME: Multi-Query Optimization took 15.504598617553711 ms
2022-09-21 06:08:33 INFO  Executing generated plans
2022-09-21 06:11:55 INFO  ---RUNTIME: Execution took 202173.8519668579 ms
2022-09-21 06:11:55 INFO  Done!
2022-09-21 06:11:55 INFO  # Finished -- repetition 1 of 7 
2022-09-21 06:11:55 INFO  # Optimization benchmark for feature_importance with args [['reviews', 'fast_loading', 'featurization_2', 'xgboost']] -- repetition 2 of 7
2022-09-21 06:11:55 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-21 06:11:55 INFO  Running instrumented original pipeline...
2022-09-21 06:11:55 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-21 06:11:55 INFO  ---RUNTIME: Importing and monkey-patching took 6.284236907958984 ms
2022-09-21 06:12:27 INFO  ---RUNTIME: Original pipeline execution took 31754.100561141968 ms (excluding imports and monkey-patching)
2022-09-21 06:12:27 INFO  Starting execution of 1 what-if analyses...
2022-09-21 06:12:27 INFO  Start plan generation for analysis PermutationFeatureImportance...
2022-09-21 06:12:27 INFO  ---RUNTIME: Plan generation took 0.13566017150878906 ms
2022-09-21 06:12:27 INFO  Estimated runtime of original DAG is 30531.555891036987ms
2022-09-21 06:12:27 INFO  Performing Multi-Query Optimization
2022-09-21 06:12:27 INFO  Estimated unoptimized what-if runtime is 152657.77945518494ms
2022-09-21 06:12:27 INFO  Estimated optimised what-if runtime is 32398.495197296143ms
2022-09-21 06:12:27 INFO  Estimated optimisation runtime saving is 120259.2842578888ms
2022-09-21 06:12:27 INFO  ---RUNTIME: Multi-Query Optimization took 11.001825332641602 ms
2022-09-21 06:12:27 INFO  Executing generated plans
2022-09-21 06:13:15 INFO  ---RUNTIME: Execution took 48032.03320503235 ms
2022-09-21 06:13:15 INFO  Done!
2022-09-21 06:13:15 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-21 06:13:15 INFO  Running instrumented original pipeline...
2022-09-21 06:13:15 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-21 06:13:15 INFO  ---RUNTIME: Importing and monkey-patching took 6.197690963745117 ms
2022-09-21 06:13:55 INFO  ---RUNTIME: Original pipeline execution took 40086.3516330719 ms (excluding imports and monkey-patching)
2022-09-21 06:13:55 INFO  Starting execution of 1 what-if analyses...
2022-09-21 06:13:55 INFO  Start plan generation for analysis PermutationFeatureImportance...
2022-09-21 06:13:55 INFO  ---RUNTIME: Plan generation took 0.1380443572998047 ms
2022-09-21 06:13:55 INFO  Estimated runtime of original DAG is 38880.0904750824ms
2022-09-21 06:13:55 WARNING Skipping Multi-Query Optimization (instead, only combine execution DAGs)
2022-09-21 06:13:55 INFO  Estimated unoptimised what-if runtime is 194400.452375412ms
2022-09-21 06:13:55 INFO  ---RUNTIME: Multi-Query Optimization took 16.250133514404297 ms
2022-09-21 06:13:55 INFO  Executing generated plans
2022-09-21 06:17:55 INFO  ---RUNTIME: Execution took 240461.9975090027 ms
2022-09-21 06:17:55 INFO  Done!
2022-09-21 06:17:55 INFO  # Finished -- repetition 2 of 7 
2022-09-21 06:17:55 INFO  # Optimization benchmark for feature_importance with args [['reviews', 'fast_loading', 'featurization_2', 'xgboost']] -- repetition 3 of 7
2022-09-21 06:17:55 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-21 06:17:55 INFO  Running instrumented original pipeline...
2022-09-21 06:17:55 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-21 06:17:55 INFO  ---RUNTIME: Importing and monkey-patching took 6.238460540771484 ms
2022-09-21 06:18:38 INFO  ---RUNTIME: Original pipeline execution took 42799.126863479614 ms (excluding imports and monkey-patching)
2022-09-21 06:18:38 INFO  Starting execution of 1 what-if analyses...
2022-09-21 06:18:38 INFO  Start plan generation for analysis PermutationFeatureImportance...
2022-09-21 06:18:38 INFO  ---RUNTIME: Plan generation took 0.12612342834472656 ms
2022-09-21 06:18:38 INFO  Estimated runtime of original DAG is 41588.515281677246ms
2022-09-21 06:18:38 INFO  Performing Multi-Query Optimization
2022-09-21 06:18:38 INFO  Estimated unoptimized what-if runtime is 207942.57640838623ms
2022-09-21 06:18:38 INFO  Estimated optimised what-if runtime is 43458.402156829834ms
2022-09-21 06:18:38 INFO  Estimated optimisation runtime saving is 164484.1742515564ms
2022-09-21 06:18:38 INFO  ---RUNTIME: Multi-Query Optimization took 10.944843292236328 ms
2022-09-21 06:18:38 INFO  Executing generated plans
2022-09-21 06:19:41 INFO  ---RUNTIME: Execution took 62514.819622039795 ms
2022-09-21 06:19:41 INFO  Done!
2022-09-21 06:19:41 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-21 06:19:41 INFO  Running instrumented original pipeline...
2022-09-21 06:19:41 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-21 06:19:41 INFO  ---RUNTIME: Importing and monkey-patching took 6.283760070800781 ms
2022-09-21 06:20:17 INFO  ---RUNTIME: Original pipeline execution took 36729.85625267029 ms (excluding imports and monkey-patching)
2022-09-21 06:20:17 INFO  Starting execution of 1 what-if analyses...
2022-09-21 06:20:17 INFO  Start plan generation for analysis PermutationFeatureImportance...
2022-09-21 06:20:17 INFO  ---RUNTIME: Plan generation took 0.1392364501953125 ms
2022-09-21 06:20:17 INFO  Estimated runtime of original DAG is 35522.372245788574ms
2022-09-21 06:20:17 WARNING Skipping Multi-Query Optimization (instead, only combine execution DAGs)
2022-09-21 06:20:17 INFO  Estimated unoptimised what-if runtime is 177611.86122894287ms
2022-09-21 06:20:17 INFO  ---RUNTIME: Multi-Query Optimization took 15.220880508422852 ms
2022-09-21 06:20:17 INFO  Executing generated plans
2022-09-21 06:21:48 INFO  ---RUNTIME: Execution took 91043.45345497131 ms
2022-09-21 06:21:48 INFO  Done!
2022-09-21 06:21:48 INFO  # Finished -- repetition 3 of 7 
2022-09-21 06:21:48 INFO  # Optimization benchmark for feature_importance with args [['reviews', 'fast_loading', 'featurization_2', 'xgboost']] -- repetition 4 of 7
2022-09-21 06:21:48 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-21 06:21:48 INFO  Running instrumented original pipeline...
2022-09-21 06:21:49 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-21 06:21:49 INFO  ---RUNTIME: Importing and monkey-patching took 5.853176116943359 ms
2022-09-21 06:22:08 INFO  ---RUNTIME: Original pipeline execution took 19983.44111442566 ms (excluding imports and monkey-patching)
2022-09-21 06:22:08 INFO  Starting execution of 1 what-if analyses...
2022-09-21 06:22:08 INFO  Start plan generation for analysis PermutationFeatureImportance...
2022-09-21 06:22:08 INFO  ---RUNTIME: Plan generation took 0.13136863708496094 ms
2022-09-21 06:22:08 INFO  Estimated runtime of original DAG is 18493.06321144104ms
2022-09-21 06:22:08 INFO  Performing Multi-Query Optimization
2022-09-21 06:22:08 INFO  Estimated unoptimized what-if runtime is 92465.3160572052ms
2022-09-21 06:22:08 INFO  Estimated optimised what-if runtime is 20487.24341392517ms
2022-09-21 06:22:08 INFO  Estimated optimisation runtime saving is 71978.07264328003ms
2022-09-21 06:22:08 INFO  ---RUNTIME: Multi-Query Optimization took 10.457515716552734 ms
2022-09-21 06:22:08 INFO  Executing generated plans
2022-09-21 06:22:29 INFO  ---RUNTIME: Execution took 20390.217065811157 ms
2022-09-21 06:22:29 INFO  Done!
2022-09-21 06:22:29 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-21 06:22:29 INFO  Running instrumented original pipeline...
2022-09-21 06:22:29 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-21 06:22:29 INFO  ---RUNTIME: Importing and monkey-patching took 6.230354309082031 ms
2022-09-21 06:22:48 INFO  ---RUNTIME: Original pipeline execution took 19421.38147354126 ms (excluding imports and monkey-patching)
2022-09-21 06:22:48 INFO  Starting execution of 1 what-if analyses...
2022-09-21 06:22:48 INFO  Start plan generation for analysis PermutationFeatureImportance...
2022-09-21 06:22:48 INFO  ---RUNTIME: Plan generation took 0.11706352233886719 ms
2022-09-21 06:22:48 INFO  Estimated runtime of original DAG is 18204.609870910645ms
2022-09-21 06:22:48 WARNING Skipping Multi-Query Optimization (instead, only combine execution DAGs)
2022-09-21 06:22:48 INFO  Estimated unoptimised what-if runtime is 91023.04935455322ms
2022-09-21 06:22:48 INFO  ---RUNTIME: Multi-Query Optimization took 15.388250350952148 ms
2022-09-21 06:22:48 INFO  Executing generated plans
2022-09-21 06:24:27 INFO  ---RUNTIME: Execution took 99121.43158912659 ms
2022-09-21 06:24:27 INFO  Done!
2022-09-21 06:24:27 INFO  # Finished -- repetition 4 of 7 
2022-09-21 06:24:27 INFO  # Optimization benchmark for feature_importance with args [['reviews', 'fast_loading', 'featurization_2', 'xgboost']] -- repetition 5 of 7
2022-09-21 06:24:27 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-21 06:24:27 INFO  Running instrumented original pipeline...
2022-09-21 06:24:28 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-21 06:24:28 INFO  ---RUNTIME: Importing and monkey-patching took 6.194591522216797 ms
2022-09-21 06:24:47 INFO  ---RUNTIME: Original pipeline execution took 19879.32252883911 ms (excluding imports and monkey-patching)
2022-09-21 06:24:47 INFO  Starting execution of 1 what-if analyses...
2022-09-21 06:24:47 INFO  Start plan generation for analysis PermutationFeatureImportance...
2022-09-21 06:24:47 INFO  ---RUNTIME: Plan generation took 0.11181831359863281 ms
2022-09-21 06:24:47 INFO  Estimated runtime of original DAG is 18676.28049850464ms
2022-09-21 06:24:47 INFO  Performing Multi-Query Optimization
2022-09-21 06:24:47 INFO  Estimated unoptimized what-if runtime is 93381.4024925232ms
2022-09-21 06:24:47 INFO  Estimated optimised what-if runtime is 20462.692975997925ms
2022-09-21 06:24:47 INFO  Estimated optimisation runtime saving is 72918.70951652527ms
2022-09-21 06:24:47 INFO  ---RUNTIME: Multi-Query Optimization took 10.467290878295898 ms
2022-09-21 06:24:47 INFO  Executing generated plans
2022-09-21 06:25:08 INFO  ---RUNTIME: Execution took 20282.98592567444 ms
2022-09-21 06:25:08 INFO  Done!
2022-09-21 06:25:08 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-21 06:25:08 INFO  Running instrumented original pipeline...
2022-09-21 06:25:08 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-21 06:25:08 INFO  ---RUNTIME: Importing and monkey-patching took 5.99217414855957 ms
2022-09-21 06:25:27 INFO  ---RUNTIME: Original pipeline execution took 19834.57350730896 ms (excluding imports and monkey-patching)
2022-09-21 06:25:27 INFO  Starting execution of 1 what-if analyses...
2022-09-21 06:25:27 INFO  Start plan generation for analysis PermutationFeatureImportance...
2022-09-21 06:25:27 INFO  ---RUNTIME: Plan generation took 0.11563301086425781 ms
2022-09-21 06:25:27 INFO  Estimated runtime of original DAG is 18624.433755874634ms
2022-09-21 06:25:27 WARNING Skipping Multi-Query Optimization (instead, only combine execution DAGs)
2022-09-21 06:25:28 INFO  Estimated unoptimised what-if runtime is 93122.16877937317ms
2022-09-21 06:25:28 INFO  ---RUNTIME: Multi-Query Optimization took 15.092849731445312 ms
2022-09-21 06:25:28 INFO  Executing generated plans
2022-09-21 06:27:02 INFO  ---RUNTIME: Execution took 94331.22229576111 ms
2022-09-21 06:27:02 INFO  Done!
2022-09-21 06:27:02 INFO  # Finished -- repetition 5 of 7 
2022-09-21 06:27:02 INFO  # Optimization benchmark for feature_importance with args [['reviews', 'fast_loading', 'featurization_2', 'xgboost']] -- repetition 6 of 7
2022-09-21 06:27:02 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-21 06:27:02 INFO  Running instrumented original pipeline...
2022-09-21 06:27:02 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-21 06:27:02 INFO  ---RUNTIME: Importing and monkey-patching took 5.9814453125 ms
2022-09-21 06:27:20 INFO  ---RUNTIME: Original pipeline execution took 18406.33726119995 ms (excluding imports and monkey-patching)
2022-09-21 06:27:20 INFO  Starting execution of 1 what-if analyses...
2022-09-21 06:27:20 INFO  Start plan generation for analysis PermutationFeatureImportance...
2022-09-21 06:27:20 INFO  ---RUNTIME: Plan generation took 0.12540817260742188 ms
2022-09-21 06:27:20 INFO  Estimated runtime of original DAG is 17197.95250892639ms
2022-09-21 06:27:20 INFO  Performing Multi-Query Optimization
2022-09-21 06:27:20 INFO  Estimated unoptimized what-if runtime is 85989.76254463196ms
2022-09-21 06:27:20 INFO  Estimated optimised what-if runtime is 18998.703241348267ms
2022-09-21 06:27:20 INFO  Estimated optimisation runtime saving is 66991.05930328369ms
2022-09-21 06:27:20 INFO  ---RUNTIME: Multi-Query Optimization took 10.654687881469727 ms
2022-09-21 06:27:20 INFO  Executing generated plans
2022-09-21 06:27:41 INFO  ---RUNTIME: Execution took 20647.107362747192 ms
2022-09-21 06:27:41 INFO  Done!
2022-09-21 06:27:41 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-21 06:27:41 INFO  Running instrumented original pipeline...
2022-09-21 06:27:41 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-21 06:27:41 INFO  ---RUNTIME: Importing and monkey-patching took 5.563259124755859 ms
2022-09-21 06:28:00 INFO  ---RUNTIME: Original pipeline execution took 18995.124578475952 ms (excluding imports and monkey-patching)
2022-09-21 06:28:00 INFO  Starting execution of 1 what-if analyses...
2022-09-21 06:28:00 INFO  Start plan generation for analysis PermutationFeatureImportance...
2022-09-21 06:28:00 INFO  ---RUNTIME: Plan generation took 0.13828277587890625 ms
2022-09-21 06:28:00 INFO  Estimated runtime of original DAG is 17789.87407684326ms
2022-09-21 06:28:00 WARNING Skipping Multi-Query Optimization (instead, only combine execution DAGs)
2022-09-21 06:28:00 INFO  Estimated unoptimised what-if runtime is 88949.37038421631ms
2022-09-21 06:28:00 INFO  ---RUNTIME: Multi-Query Optimization took 14.986753463745117 ms
2022-09-21 06:28:00 INFO  Executing generated plans
2022-09-21 06:33:13 INFO  ---RUNTIME: Execution took 312573.105096817 ms
2022-09-21 06:33:13 INFO  Done!
2022-09-21 06:33:13 INFO  # Finished -- repetition 6 of 7 
2022-09-21 06:33:13 INFO  # Optimization benchmark for feature_importance with args [['reviews', 'fast_loading', 'featurization_2', 'xgboost']] -- repetition 7 of 7
2022-09-21 06:33:13 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-21 06:33:13 INFO  Running instrumented original pipeline...
2022-09-21 06:33:13 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-21 06:33:13 INFO  ---RUNTIME: Importing and monkey-patching took 8.43501091003418 ms
2022-09-21 06:34:19 INFO  ---RUNTIME: Original pipeline execution took 66829.97941970825 ms (excluding imports and monkey-patching)
2022-09-21 06:34:19 INFO  Starting execution of 1 what-if analyses...
2022-09-21 06:34:19 INFO  Start plan generation for analysis PermutationFeatureImportance...
2022-09-21 06:34:19 INFO  ---RUNTIME: Plan generation took 0.13828277587890625 ms
2022-09-21 06:34:19 INFO  Estimated runtime of original DAG is 65243.13187599182ms
2022-09-21 06:34:19 INFO  Performing Multi-Query Optimization
2022-09-21 06:34:19 INFO  Estimated unoptimized what-if runtime is 326215.6593799591ms
2022-09-21 06:34:19 INFO  Estimated optimised what-if runtime is 67121.70362472534ms
2022-09-21 06:34:19 INFO  Estimated optimisation runtime saving is 259093.95575523376ms
2022-09-21 06:34:19 INFO  ---RUNTIME: Multi-Query Optimization took 10.693073272705078 ms
2022-09-21 06:34:19 INFO  Executing generated plans
2022-09-21 06:35:40 INFO  ---RUNTIME: Execution took 80526.66735649109 ms
2022-09-21 06:35:40 INFO  Done!
2022-09-21 06:35:40 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-21 06:35:40 INFO  Running instrumented original pipeline...
2022-09-21 06:35:40 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-21 06:35:40 INFO  ---RUNTIME: Importing and monkey-patching took 11.426687240600586 ms
2022-09-21 06:36:28 INFO  ---RUNTIME: Original pipeline execution took 47658.24747085571 ms (excluding imports and monkey-patching)
2022-09-21 06:36:28 INFO  Starting execution of 1 what-if analyses...
2022-09-21 06:36:28 INFO  Start plan generation for analysis PermutationFeatureImportance...
2022-09-21 06:36:28 INFO  ---RUNTIME: Plan generation took 0.1366138458251953 ms
2022-09-21 06:36:28 INFO  Estimated runtime of original DAG is 46008.91613960266ms
2022-09-21 06:36:28 WARNING Skipping Multi-Query Optimization (instead, only combine execution DAGs)
2022-09-21 06:36:28 INFO  Estimated unoptimised what-if runtime is 230044.5806980133ms
2022-09-21 06:36:28 INFO  ---RUNTIME: Multi-Query Optimization took 20.832538604736328 ms
2022-09-21 06:36:28 INFO  Executing generated plans
2022-09-21 06:41:26 INFO  ---RUNTIME: Execution took 297920.73225975037 ms
2022-09-21 06:41:26 INFO  Done!
2022-09-21 06:41:26 INFO  # Finished -- repetition 7 of 7 
2022-09-21 06:41:26 INFO  # Final results after all repetitions
2022-09-21 06:41:26 INFO     repetition  ... no_opt_what_if_execution_combined_model_training
0           0  ...                                    170658.071756
1           1  ...                                    208188.070297
2           2  ...                                     59793.682575
3           3  ...                                     67632.494450
4           4  ...                                     63056.969404
5           5  ...                                    277407.574177
6           6  ...                                    262675.309896

[7 rows x 26 columns]
taskset -c 32-40 PROTOCOL_BUFFERS_PYTHON_IMPLEMENTATION=python python3.9 benchmarks_end_to_end.py feature_importance reviews fast_loading featurization_2 neural_network
2022-09-21 06:41:29.141699: W tensorflow/stream_executor/platform/default/dso_loader.cc:64] Could not load dynamic library 'libcudart.so.11.0'; dlerror: libcudart.so.11.0: cannot open shared object file: No such file or directory; LD_LIBRARY_PATH: /home/sgrafbe/mlwhatif/venv/lib/python3.9/site-packages/cv2/../../lib64:
2022-09-21 06:41:29.141752: I tensorflow/stream_executor/cuda/cudart_stub.cc:29] Ignore above cudart dlerror if you do not have a GPU set up on your machine.
2022-09-21 06:41:30 INFO  Patching sys.argv with ['mlwhatif', 'reviews', 'fast_loading', 'featurization_2', 'neural_network']
2022-09-21 06:41:30 INFO  Running instrumented original pipeline...
2022-09-21 06:41:30 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-21 06:41:30 INFO  ---RUNTIME: Importing and monkey-patching took 159.6534252166748 ms
2022-09-21 06:41:37.381718: W tensorflow/stream_executor/platform/default/dso_loader.cc:64] Could not load dynamic library 'libcuda.so.1'; dlerror: libcuda.so.1: cannot open shared object file: No such file or directory; LD_LIBRARY_PATH: /home/sgrafbe/mlwhatif/venv/lib/python3.9/site-packages/cv2/../../lib64:
2022-09-21 06:41:37.381770: W tensorflow/stream_executor/cuda/cuda_driver.cc:326] failed call to cuInit: UNKNOWN ERROR (303)
2022-09-21 06:41:37.381796: I tensorflow/stream_executor/cuda/cuda_diagnostics.cc:156] kernel driver does not appear to be running on this host (angus): /proc/driver/nvidia/version does not exist
2022-09-21 06:41:37.382381: I tensorflow/core/platform/cpu_feature_guard.cc:142] This TensorFlow binary is optimized with oneAPI Deep Neural Network Library (oneDNN) to use the following CPU instructions in performance-critical operations:  AVX2 FMA
To enable them in other operations, rebuild TensorFlow with the appropriate compiler flags.
2022-09-21 06:41:38.385286: I tensorflow/compiler/mlir/mlir_graph_optimization_pass.cc:176] None of the MLIR Optimization Passes are enabled (registered 2)
2022-09-21 06:41:38.404262: I tensorflow/core/platform/profile_utils/cpu_utils.cc:114] CPU Frequency: 2595130000 Hz
2022-09-21 06:41:49 INFO  ---RUNTIME: Original pipeline execution took 18485.034465789795 ms (excluding imports and monkey-patching)
2022-09-21 06:41:49 INFO  Starting execution of 0 what-if analyses...
2022-09-21 06:41:49 INFO  Estimated runtime of original DAG is 16947.77774810791ms
2022-09-21 06:41:49 INFO  Performing Multi-Query Optimization
2022-09-21 06:41:49 INFO  Estimated unoptimized what-if runtime is 0ms
2022-09-21 06:41:49 INFO  Estimated optimised what-if runtime is 0ms
2022-09-21 06:41:49 INFO  Estimated optimisation runtime saving is 0ms
2022-09-21 06:41:49 INFO  ---RUNTIME: Multi-Query Optimization took 0.5135536193847656 ms
2022-09-21 06:41:49 INFO  Executing generated plans
2022-09-21 06:41:49 INFO  ---RUNTIME: Execution took 0.016450881958007812 ms
2022-09-21 06:41:49 INFO  Done!
2022-09-21 06:41:49 INFO  # Optimization benchmark for feature_importance with args [['reviews', 'fast_loading', 'featurization_2', 'neural_network']] -- repetition 1 of 7
2022-09-21 06:41:49 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-21 06:41:49 INFO  Running instrumented original pipeline...
2022-09-21 06:41:49 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-21 06:41:49 INFO  ---RUNTIME: Importing and monkey-patching took 6.425380706787109 ms
2022-09-21 06:42:05 INFO  ---RUNTIME: Original pipeline execution took 15754.995584487915 ms (excluding imports and monkey-patching)
2022-09-21 06:42:05 INFO  Starting execution of 1 what-if analyses...
2022-09-21 06:42:05 INFO  Start plan generation for analysis PermutationFeatureImportance...
2022-09-21 06:42:05 INFO  ---RUNTIME: Plan generation took 0.22721290588378906 ms
2022-09-21 06:42:05 INFO  Estimated runtime of original DAG is 14231.481552124023ms
2022-09-21 06:42:05 INFO  Performing Multi-Query Optimization
2022-09-21 06:42:05 INFO  Estimated unoptimized what-if runtime is 71157.40776062012ms
2022-09-21 06:42:05 INFO  Estimated optimised what-if runtime is 18747.33805656433ms
2022-09-21 06:42:05 INFO  Estimated optimisation runtime saving is 52410.069704055786ms
2022-09-21 06:42:05 INFO  ---RUNTIME: Multi-Query Optimization took 11.317253112792969 ms
2022-09-21 06:42:05 INFO  Executing generated plans
2022-09-21 06:42:24 INFO  ---RUNTIME: Execution took 19588.830709457397 ms
2022-09-21 06:42:24 INFO  Done!
2022-09-21 06:42:24 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-21 06:42:24 INFO  Running instrumented original pipeline...
2022-09-21 06:42:24 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-21 06:42:24 INFO  ---RUNTIME: Importing and monkey-patching took 6.189823150634766 ms
2022-09-21 06:42:41 INFO  ---RUNTIME: Original pipeline execution took 16825.16622543335 ms (excluding imports and monkey-patching)
2022-09-21 06:42:41 INFO  Starting execution of 1 what-if analyses...
2022-09-21 06:42:41 INFO  Start plan generation for analysis PermutationFeatureImportance...
2022-09-21 06:42:41 INFO  ---RUNTIME: Plan generation took 0.1373291015625 ms
2022-09-21 06:42:41 INFO  Estimated runtime of original DAG is 15366.602659225464ms
2022-09-21 06:42:41 WARNING Skipping Multi-Query Optimization (instead, only combine execution DAGs)
2022-09-21 06:42:41 INFO  Estimated unoptimised what-if runtime is 76833.01329612732ms
2022-09-21 06:42:41 INFO  ---RUNTIME: Multi-Query Optimization took 15.669584274291992 ms
2022-09-21 06:42:41 INFO  Executing generated plans
2022-09-21 06:43:54 INFO  ---RUNTIME: Execution took 73175.01831054688 ms
2022-09-21 06:43:54 INFO  Done!
2022-09-21 06:43:54 INFO  # Finished -- repetition 1 of 7 
2022-09-21 06:43:54 INFO  # Optimization benchmark for feature_importance with args [['reviews', 'fast_loading', 'featurization_2', 'neural_network']] -- repetition 2 of 7
2022-09-21 06:43:54 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-21 06:43:54 INFO  Running instrumented original pipeline...
2022-09-21 06:43:54 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-21 06:43:54 INFO  ---RUNTIME: Importing and monkey-patching took 7.2650909423828125 ms
2022-09-21 06:44:12 INFO  ---RUNTIME: Original pipeline execution took 17889.575481414795 ms (excluding imports and monkey-patching)
2022-09-21 06:44:12 INFO  Starting execution of 1 what-if analyses...
2022-09-21 06:44:12 INFO  Start plan generation for analysis PermutationFeatureImportance...
2022-09-21 06:44:12 INFO  ---RUNTIME: Plan generation took 0.186920166015625 ms
2022-09-21 06:44:12 INFO  Estimated runtime of original DAG is 16284.622192382812ms
2022-09-21 06:44:12 INFO  Performing Multi-Query Optimization
2022-09-21 06:44:12 INFO  Estimated unoptimized what-if runtime is 81423.11096191406ms
2022-09-21 06:44:12 INFO  Estimated optimised what-if runtime is 22423.837661743164ms
2022-09-21 06:44:12 INFO  Estimated optimisation runtime saving is 58999.2733001709ms
2022-09-21 06:44:12 INFO  ---RUNTIME: Multi-Query Optimization took 14.897584915161133 ms
2022-09-21 06:44:12 INFO  Executing generated plans
2022-09-21 06:44:34 INFO  ---RUNTIME: Execution took 22064.17155265808 ms
2022-09-21 06:44:34 INFO  Done!
2022-09-21 06:44:34 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-21 06:44:34 INFO  Running instrumented original pipeline...
2022-09-21 06:44:34 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-21 06:44:34 INFO  ---RUNTIME: Importing and monkey-patching took 5.757570266723633 ms
2022-09-21 06:44:51 INFO  ---RUNTIME: Original pipeline execution took 16534.799337387085 ms (excluding imports and monkey-patching)
2022-09-21 06:44:51 INFO  Starting execution of 1 what-if analyses...
2022-09-21 06:44:51 INFO  Start plan generation for analysis PermutationFeatureImportance...
2022-09-21 06:44:51 INFO  ---RUNTIME: Plan generation took 0.11396408081054688 ms
2022-09-21 06:44:51 INFO  Estimated runtime of original DAG is 15228.218078613281ms
2022-09-21 06:44:51 WARNING Skipping Multi-Query Optimization (instead, only combine execution DAGs)
2022-09-21 06:44:51 INFO  Estimated unoptimised what-if runtime is 76141.0903930664ms
2022-09-21 06:44:51 INFO  ---RUNTIME: Multi-Query Optimization took 15.458106994628906 ms
2022-09-21 06:44:51 INFO  Executing generated plans
2022-09-21 06:46:01 INFO  ---RUNTIME: Execution took 69909.26885604858 ms
2022-09-21 06:46:01 INFO  Done!
2022-09-21 06:46:01 INFO  # Finished -- repetition 2 of 7 
2022-09-21 06:46:01 INFO  # Optimization benchmark for feature_importance with args [['reviews', 'fast_loading', 'featurization_2', 'neural_network']] -- repetition 3 of 7
2022-09-21 06:46:01 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-21 06:46:01 INFO  Running instrumented original pipeline...
2022-09-21 06:46:01 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-21 06:46:01 INFO  ---RUNTIME: Importing and monkey-patching took 5.8574676513671875 ms
2022-09-21 06:46:19 INFO  ---RUNTIME: Original pipeline execution took 18232.438564300537 ms (excluding imports and monkey-patching)
2022-09-21 06:46:19 INFO  Starting execution of 1 what-if analyses...
2022-09-21 06:46:19 INFO  Start plan generation for analysis PermutationFeatureImportance...
2022-09-21 06:46:19 INFO  ---RUNTIME: Plan generation took 0.12469291687011719 ms
2022-09-21 06:46:19 INFO  Estimated runtime of original DAG is 16937.755823135376ms
2022-09-21 06:46:19 INFO  Performing Multi-Query Optimization
2022-09-21 06:46:19 INFO  Estimated unoptimized what-if runtime is 84688.77911567688ms
2022-09-21 06:46:19 INFO  Estimated optimised what-if runtime is 23855.6706905365ms
2022-09-21 06:46:19 INFO  Estimated optimisation runtime saving is 60833.10842514038ms
2022-09-21 06:46:19 INFO  ---RUNTIME: Multi-Query Optimization took 14.71853256225586 ms
2022-09-21 06:46:19 INFO  Executing generated plans
2022-09-21 06:46:44 INFO  ---RUNTIME: Execution took 25259.023427963257 ms
2022-09-21 06:46:44 INFO  Done!
2022-09-21 06:46:44 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-21 06:46:44 INFO  Running instrumented original pipeline...
2022-09-21 06:46:45 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-21 06:46:45 INFO  ---RUNTIME: Importing and monkey-patching took 8.096933364868164 ms
2022-09-21 06:47:04 INFO  ---RUNTIME: Original pipeline execution took 19439.675092697144 ms (excluding imports and monkey-patching)
2022-09-21 06:47:04 INFO  Starting execution of 1 what-if analyses...
2022-09-21 06:47:04 INFO  Start plan generation for analysis PermutationFeatureImportance...
2022-09-21 06:47:04 INFO  ---RUNTIME: Plan generation took 0.16927719116210938 ms
2022-09-21 06:47:04 INFO  Estimated runtime of original DAG is 17247.073888778687ms
2022-09-21 06:47:04 WARNING Skipping Multi-Query Optimization (instead, only combine execution DAGs)
2022-09-21 06:47:04 INFO  Estimated unoptimised what-if runtime is 86235.36944389343ms
2022-09-21 06:47:04 INFO  ---RUNTIME: Multi-Query Optimization took 27.396678924560547 ms
2022-09-21 06:47:04 INFO  Executing generated plans
2022-09-21 06:48:11 INFO  ---RUNTIME: Execution took 67073.99773597717 ms
2022-09-21 06:48:11 INFO  Done!
2022-09-21 06:48:11 INFO  # Finished -- repetition 3 of 7 
2022-09-21 06:48:11 INFO  # Optimization benchmark for feature_importance with args [['reviews', 'fast_loading', 'featurization_2', 'neural_network']] -- repetition 4 of 7
2022-09-21 06:48:11 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-21 06:48:11 INFO  Running instrumented original pipeline...
2022-09-21 06:48:11 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-21 06:48:11 INFO  ---RUNTIME: Importing and monkey-patching took 5.986690521240234 ms
2022-09-21 06:48:24 INFO  ---RUNTIME: Original pipeline execution took 13479.411840438843 ms (excluding imports and monkey-patching)
2022-09-21 06:48:24 INFO  Starting execution of 1 what-if analyses...
2022-09-21 06:48:24 INFO  Start plan generation for analysis PermutationFeatureImportance...
2022-09-21 06:48:24 INFO  ---RUNTIME: Plan generation took 0.12469291687011719 ms
2022-09-21 06:48:24 INFO  Estimated runtime of original DAG is 12285.057067871094ms
2022-09-21 06:48:24 INFO  Performing Multi-Query Optimization
2022-09-21 06:48:24 INFO  Estimated unoptimized what-if runtime is 61425.28533935547ms
2022-09-21 06:48:24 INFO  Estimated optimised what-if runtime is 17060.54735183716ms
2022-09-21 06:48:24 INFO  Estimated optimisation runtime saving is 44364.73798751831ms
2022-09-21 06:48:24 INFO  ---RUNTIME: Multi-Query Optimization took 11.249303817749023 ms
2022-09-21 06:48:24 INFO  Executing generated plans
2022-09-21 06:48:42 INFO  ---RUNTIME: Execution took 17441.555500030518 ms
2022-09-21 06:48:42 INFO  Done!
2022-09-21 06:48:42 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-21 06:48:42 INFO  Running instrumented original pipeline...
2022-09-21 06:48:42 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-21 06:48:42 INFO  ---RUNTIME: Importing and monkey-patching took 6.175756454467773 ms
2022-09-21 06:48:56 INFO  ---RUNTIME: Original pipeline execution took 14598.820447921753 ms (excluding imports and monkey-patching)
2022-09-21 06:48:56 INFO  Starting execution of 1 what-if analyses...
2022-09-21 06:48:56 INFO  Start plan generation for analysis PermutationFeatureImportance...
2022-09-21 06:48:56 INFO  ---RUNTIME: Plan generation took 0.1323223114013672 ms
2022-09-21 06:48:56 INFO  Estimated runtime of original DAG is 13278.159379959106ms
2022-09-21 06:48:56 WARNING Skipping Multi-Query Optimization (instead, only combine execution DAGs)
2022-09-21 06:48:56 INFO  Estimated unoptimised what-if runtime is 66390.79689979553ms
2022-09-21 06:48:56 INFO  ---RUNTIME: Multi-Query Optimization took 16.29185676574707 ms
2022-09-21 06:48:56 INFO  Executing generated plans
2022-09-21 06:50:05 INFO  ---RUNTIME: Execution took 68259.14144515991 ms
2022-09-21 06:50:05 INFO  Done!
2022-09-21 06:50:05 INFO  # Finished -- repetition 4 of 7 
2022-09-21 06:50:05 INFO  # Optimization benchmark for feature_importance with args [['reviews', 'fast_loading', 'featurization_2', 'neural_network']] -- repetition 5 of 7
2022-09-21 06:50:05 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-21 06:50:05 INFO  Running instrumented original pipeline...
2022-09-21 06:50:05 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-21 06:50:05 INFO  ---RUNTIME: Importing and monkey-patching took 5.7773590087890625 ms
2022-09-21 06:50:18 INFO  ---RUNTIME: Original pipeline execution took 13424.484968185425 ms (excluding imports and monkey-patching)
2022-09-21 06:50:18 INFO  Starting execution of 1 what-if analyses...
2022-09-21 06:50:18 INFO  Start plan generation for analysis PermutationFeatureImportance...
2022-09-21 06:50:18 INFO  ---RUNTIME: Plan generation took 0.10609626770019531 ms
2022-09-21 06:50:18 INFO  Estimated runtime of original DAG is 12216.809034347534ms
2022-09-21 06:50:18 INFO  Performing Multi-Query Optimization
2022-09-21 06:50:18 INFO  Estimated unoptimized what-if runtime is 61084.04517173767ms
2022-09-21 06:50:18 INFO  Estimated optimised what-if runtime is 16973.981857299805ms
2022-09-21 06:50:18 INFO  Estimated optimisation runtime saving is 44110.063314437866ms
2022-09-21 06:50:18 INFO  ---RUNTIME: Multi-Query Optimization took 10.930061340332031 ms
2022-09-21 06:50:18 INFO  Executing generated plans
2022-09-21 06:50:36 INFO  ---RUNTIME: Execution took 17375.139713287354 ms
2022-09-21 06:50:36 INFO  Done!
2022-09-21 06:50:36 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-21 06:50:36 INFO  Running instrumented original pipeline...
2022-09-21 06:50:36 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-21 06:50:36 INFO  ---RUNTIME: Importing and monkey-patching took 5.640745162963867 ms
2022-09-21 06:50:51 INFO  ---RUNTIME: Original pipeline execution took 15047.317028045654 ms (excluding imports and monkey-patching)
2022-09-21 06:50:51 INFO  Starting execution of 1 what-if analyses...
2022-09-21 06:50:51 INFO  Start plan generation for analysis PermutationFeatureImportance...
2022-09-21 06:50:51 INFO  ---RUNTIME: Plan generation took 0.12302398681640625 ms
2022-09-21 06:50:51 INFO  Estimated runtime of original DAG is 13800.624370574951ms
2022-09-21 06:50:51 WARNING Skipping Multi-Query Optimization (instead, only combine execution DAGs)
2022-09-21 06:50:51 INFO  Estimated unoptimised what-if runtime is 69003.12185287476ms
2022-09-21 06:50:51 INFO  ---RUNTIME: Multi-Query Optimization took 16.54505729675293 ms
2022-09-21 06:50:51 INFO  Executing generated plans
2022-09-21 06:51:58 INFO  ---RUNTIME: Execution took 67669.7256565094 ms
2022-09-21 06:51:58 INFO  Done!
2022-09-21 06:51:58 INFO  # Finished -- repetition 5 of 7 
2022-09-21 06:51:58 INFO  # Optimization benchmark for feature_importance with args [['reviews', 'fast_loading', 'featurization_2', 'neural_network']] -- repetition 6 of 7
2022-09-21 06:51:58 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-21 06:51:58 INFO  Running instrumented original pipeline...
2022-09-21 06:51:58 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-21 06:51:58 INFO  ---RUNTIME: Importing and monkey-patching took 6.129741668701172 ms
2022-09-21 06:52:12 INFO  ---RUNTIME: Original pipeline execution took 13568.098545074463 ms (excluding imports and monkey-patching)
2022-09-21 06:52:12 INFO  Starting execution of 1 what-if analyses...
2022-09-21 06:52:12 INFO  Start plan generation for analysis PermutationFeatureImportance...
2022-09-21 06:52:12 INFO  ---RUNTIME: Plan generation took 0.12040138244628906 ms
2022-09-21 06:52:12 INFO  Estimated runtime of original DAG is 12347.674131393433ms
2022-09-21 06:52:12 INFO  Performing Multi-Query Optimization
2022-09-21 06:52:12 INFO  Estimated unoptimized what-if runtime is 61738.37065696716ms
2022-09-21 06:52:12 INFO  Estimated optimised what-if runtime is 17041.355848312378ms
2022-09-21 06:52:12 INFO  Estimated optimisation runtime saving is 44697.014808654785ms
2022-09-21 06:52:12 INFO  ---RUNTIME: Multi-Query Optimization took 11.064529418945312 ms
2022-09-21 06:52:12 INFO  Executing generated plans
2022-09-21 06:52:29 INFO  ---RUNTIME: Execution took 17555.070161819458 ms
2022-09-21 06:52:29 INFO  Done!
2022-09-21 06:52:29 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-21 06:52:29 INFO  Running instrumented original pipeline...
2022-09-21 06:52:29 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-21 06:52:29 INFO  ---RUNTIME: Importing and monkey-patching took 5.635499954223633 ms
2022-09-21 06:52:43 INFO  ---RUNTIME: Original pipeline execution took 13814.356803894043 ms (excluding imports and monkey-patching)
2022-09-21 06:52:43 INFO  Starting execution of 1 what-if analyses...
2022-09-21 06:52:43 INFO  Start plan generation for analysis PermutationFeatureImportance...
2022-09-21 06:52:43 INFO  ---RUNTIME: Plan generation took 0.11396408081054688 ms
2022-09-21 06:52:43 INFO  Estimated runtime of original DAG is 12586.233139038086ms
2022-09-21 06:52:43 WARNING Skipping Multi-Query Optimization (instead, only combine execution DAGs)
2022-09-21 06:52:43 INFO  Estimated unoptimised what-if runtime is 62931.16569519043ms
2022-09-21 06:52:43 INFO  ---RUNTIME: Multi-Query Optimization took 16.88241958618164 ms
2022-09-21 06:52:43 INFO  Executing generated plans
2022-09-21 06:53:51 INFO  ---RUNTIME: Execution took 67678.42197418213 ms
2022-09-21 06:53:51 INFO  Done!
2022-09-21 06:53:51 INFO  # Finished -- repetition 6 of 7 
2022-09-21 06:53:51 INFO  # Optimization benchmark for feature_importance with args [['reviews', 'fast_loading', 'featurization_2', 'neural_network']] -- repetition 7 of 7
2022-09-21 06:53:51 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-21 06:53:51 INFO  Running instrumented original pipeline...
2022-09-21 06:53:51 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-21 06:53:51 INFO  ---RUNTIME: Importing and monkey-patching took 7.111549377441406 ms
2022-09-21 06:54:04 INFO  ---RUNTIME: Original pipeline execution took 13551.637887954712 ms (excluding imports and monkey-patching)
2022-09-21 06:54:04 INFO  Starting execution of 1 what-if analyses...
2022-09-21 06:54:04 INFO  Start plan generation for analysis PermutationFeatureImportance...
2022-09-21 06:54:04 INFO  ---RUNTIME: Plan generation took 0.102996826171875 ms
2022-09-21 06:54:04 INFO  Estimated runtime of original DAG is 12304.643154144287ms
2022-09-21 06:54:04 INFO  Performing Multi-Query Optimization
2022-09-21 06:54:05 INFO  Estimated unoptimized what-if runtime is 61523.215770721436ms
2022-09-21 06:54:05 INFO  Estimated optimised what-if runtime is 16893.131971359253ms
2022-09-21 06:54:05 INFO  Estimated optimisation runtime saving is 44630.08379936218ms
2022-09-21 06:54:05 INFO  ---RUNTIME: Multi-Query Optimization took 10.893821716308594 ms
2022-09-21 06:54:05 INFO  Executing generated plans
2022-09-21 06:54:22 INFO  ---RUNTIME: Execution took 17263.90051841736 ms
2022-09-21 06:54:22 INFO  Done!
2022-09-21 06:54:22 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-21 06:54:22 INFO  Running instrumented original pipeline...
2022-09-21 06:54:22 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-21 06:54:22 INFO  ---RUNTIME: Importing and monkey-patching took 5.710601806640625 ms
2022-09-21 06:54:35 INFO  ---RUNTIME: Original pipeline execution took 13545.886278152466 ms (excluding imports and monkey-patching)
2022-09-21 06:54:35 INFO  Starting execution of 1 what-if analyses...
2022-09-21 06:54:35 INFO  Start plan generation for analysis PermutationFeatureImportance...
2022-09-21 06:54:35 INFO  ---RUNTIME: Plan generation took 0.12540817260742188 ms
2022-09-21 06:54:35 INFO  Estimated runtime of original DAG is 12352.814674377441ms
2022-09-21 06:54:35 WARNING Skipping Multi-Query Optimization (instead, only combine execution DAGs)
2022-09-21 06:54:35 INFO  Estimated unoptimised what-if runtime is 61764.07337188721ms
2022-09-21 06:54:35 INFO  ---RUNTIME: Multi-Query Optimization took 14.964103698730469 ms
2022-09-21 06:54:35 INFO  Executing generated plans
2022-09-21 06:55:42 INFO  ---RUNTIME: Execution took 67063.99774551392 ms
2022-09-21 06:55:42 INFO  Done!
2022-09-21 06:55:42 INFO  # Finished -- repetition 7 of 7 
2022-09-21 06:55:42 INFO  # Final results after all repetitions
2022-09-21 06:55:42 INFO     repetition  ... no_opt_what_if_execution_combined_model_training
0           0  ...                                     33964.911222
1           1  ...                                     30462.824821
2           2  ...                                     31735.751867
3           3  ...                                     31897.336245
4           4  ...                                     30605.151892
5           5  ...                                     31547.070265
6           6  ...                                     31776.598692

[7 rows x 26 columns]
taskset -c 32-40 PROTOCOL_BUFFERS_PYTHON_IMPLEMENTATION=python python3.9 benchmarks_end_to_end.py feature_importance reviews fast_loading featurization_3 logistic_regression
2022-09-21 06:55:45.448420: W tensorflow/stream_executor/platform/default/dso_loader.cc:64] Could not load dynamic library 'libcudart.so.11.0'; dlerror: libcudart.so.11.0: cannot open shared object file: No such file or directory; LD_LIBRARY_PATH: /home/sgrafbe/mlwhatif/venv/lib/python3.9/site-packages/cv2/../../lib64:
2022-09-21 06:55:45.448468: I tensorflow/stream_executor/cuda/cudart_stub.cc:29] Ignore above cudart dlerror if you do not have a GPU set up on your machine.
2022-09-21 06:55:46 INFO  Patching sys.argv with ['mlwhatif', 'reviews', 'fast_loading', 'featurization_3', 'logistic_regression']
2022-09-21 06:55:46 INFO  Running instrumented original pipeline...
2022-09-21 06:55:46 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-21 06:55:46 INFO  ---RUNTIME: Importing and monkey-patching took 129.5788288116455 ms
2022-09-21 06:56:27 INFO  ---RUNTIME: Original pipeline execution took 40402.57668495178 ms (excluding imports and monkey-patching)
2022-09-21 06:56:27 INFO  Starting execution of 0 what-if analyses...
2022-09-21 06:56:27 INFO  Estimated runtime of original DAG is 33071.27118110657ms
2022-09-21 06:56:27 INFO  Performing Multi-Query Optimization
2022-09-21 06:56:27 INFO  Estimated unoptimized what-if runtime is 0ms
2022-09-21 06:56:27 INFO  Estimated optimised what-if runtime is 0ms
2022-09-21 06:56:27 INFO  Estimated optimisation runtime saving is 0ms
2022-09-21 06:56:27 INFO  ---RUNTIME: Multi-Query Optimization took 0.6105899810791016 ms
2022-09-21 06:56:27 INFO  Executing generated plans
2022-09-21 06:56:27 INFO  ---RUNTIME: Execution took 0.031948089599609375 ms
2022-09-21 06:56:27 INFO  Done!
2022-09-21 06:56:27 INFO  # Optimization benchmark for feature_importance with args [['reviews', 'fast_loading', 'featurization_3', 'logistic_regression']] -- repetition 1 of 7
2022-09-21 06:56:27 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-21 06:56:27 INFO  Running instrumented original pipeline...
2022-09-21 06:56:27 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-21 06:56:27 INFO  ---RUNTIME: Importing and monkey-patching took 5.667924880981445 ms
2022-09-21 06:57:08 INFO  ---RUNTIME: Original pipeline execution took 41277.98676490784 ms (excluding imports and monkey-patching)
2022-09-21 06:57:08 INFO  Starting execution of 1 what-if analyses...
2022-09-21 06:57:08 INFO  Start plan generation for analysis PermutationFeatureImportance...
2022-09-21 06:57:08 INFO  ---RUNTIME: Plan generation took 0.2155303955078125 ms
2022-09-21 06:57:08 INFO  Estimated runtime of original DAG is 33749.04370307922ms
2022-09-21 06:57:08 INFO  Performing Multi-Query Optimization
2022-09-21 06:57:08 INFO  Estimated unoptimized what-if runtime is 168745.21851539612ms
2022-09-21 06:57:08 INFO  Estimated optimised what-if runtime is 50441.571950912476ms
2022-09-21 06:57:08 INFO  Estimated optimisation runtime saving is 118303.64656448364ms
2022-09-21 06:57:08 INFO  ---RUNTIME: Multi-Query Optimization took 12.546777725219727 ms
2022-09-21 06:57:08 INFO  Executing generated plans
2022-09-21 06:57:38 INFO  ---RUNTIME: Execution took 29822.33715057373 ms
2022-09-21 06:57:38 INFO  Done!
2022-09-21 06:57:38 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-21 06:57:38 INFO  Running instrumented original pipeline...
2022-09-21 06:57:38 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-21 06:57:38 INFO  ---RUNTIME: Importing and monkey-patching took 6.390810012817383 ms
2022-09-21 06:58:20 INFO  ---RUNTIME: Original pipeline execution took 42532.835721969604 ms (excluding imports and monkey-patching)
2022-09-21 06:58:20 INFO  Starting execution of 1 what-if analyses...
2022-09-21 06:58:20 INFO  Start plan generation for analysis PermutationFeatureImportance...
2022-09-21 06:58:20 INFO  ---RUNTIME: Plan generation took 0.15473365783691406 ms
2022-09-21 06:58:20 INFO  Estimated runtime of original DAG is 34365.94009399414ms
2022-09-21 06:58:20 WARNING Skipping Multi-Query Optimization (instead, only combine execution DAGs)
2022-09-21 06:58:20 INFO  Estimated unoptimised what-if runtime is 171829.7004699707ms
2022-09-21 06:58:20 INFO  ---RUNTIME: Multi-Query Optimization took 18.93901824951172 ms
2022-09-21 06:58:20 INFO  Executing generated plans
2022-09-21 07:01:22 INFO  ---RUNTIME: Execution took 181461.35663986206 ms
2022-09-21 07:01:22 INFO  Done!
2022-09-21 07:01:22 INFO  # Finished -- repetition 1 of 7 
2022-09-21 07:01:22 INFO  # Optimization benchmark for feature_importance with args [['reviews', 'fast_loading', 'featurization_3', 'logistic_regression']] -- repetition 2 of 7
2022-09-21 07:01:22 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-21 07:01:22 INFO  Running instrumented original pipeline...
2022-09-21 07:01:22 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-21 07:01:22 INFO  ---RUNTIME: Importing and monkey-patching took 6.1931610107421875 ms
2022-09-21 07:02:14 INFO  ---RUNTIME: Original pipeline execution took 51615.77820777893 ms (excluding imports and monkey-patching)
2022-09-21 07:02:14 INFO  Starting execution of 1 what-if analyses...
2022-09-21 07:02:14 INFO  Start plan generation for analysis PermutationFeatureImportance...
2022-09-21 07:02:14 INFO  ---RUNTIME: Plan generation took 0.15401840209960938 ms
2022-09-21 07:02:14 INFO  Estimated runtime of original DAG is 35983.10613632202ms
2022-09-21 07:02:14 INFO  Performing Multi-Query Optimization
2022-09-21 07:02:14 INFO  Estimated unoptimized what-if runtime is 179915.5306816101ms
2022-09-21 07:02:14 INFO  Estimated optimised what-if runtime is 54090.94524383545ms
2022-09-21 07:02:14 INFO  Estimated optimisation runtime saving is 125824.58543777466ms
2022-09-21 07:02:14 INFO  ---RUNTIME: Multi-Query Optimization took 13.222694396972656 ms
2022-09-21 07:02:14 INFO  Executing generated plans
2022-09-21 07:02:53 INFO  ---RUNTIME: Execution took 39500.3023147583 ms
2022-09-21 07:02:53 INFO  Done!
2022-09-21 07:02:53 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-21 07:02:53 INFO  Running instrumented original pipeline...
2022-09-21 07:02:53 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-21 07:02:53 INFO  ---RUNTIME: Importing and monkey-patching took 6.388187408447266 ms
2022-09-21 07:03:38 INFO  ---RUNTIME: Original pipeline execution took 45013.2212638855 ms (excluding imports and monkey-patching)
2022-09-21 07:03:38 INFO  Starting execution of 1 what-if analyses...
2022-09-21 07:03:38 INFO  Start plan generation for analysis PermutationFeatureImportance...
2022-09-21 07:03:38 INFO  ---RUNTIME: Plan generation took 0.1800060272216797 ms
2022-09-21 07:03:38 INFO  Estimated runtime of original DAG is 35280.298948287964ms
2022-09-21 07:03:38 WARNING Skipping Multi-Query Optimization (instead, only combine execution DAGs)
2022-09-21 07:03:38 INFO  Estimated unoptimised what-if runtime is 176401.49474143982ms
2022-09-21 07:03:38 INFO  ---RUNTIME: Multi-Query Optimization took 19.099950790405273 ms
2022-09-21 07:03:38 INFO  Executing generated plans
Traceback (most recent call last):
  File "/home/sgrafbe/mlwhatif/experiments/end_to_end/benchmarks_end_to_end.py", line 238, in <module>
    analysis_result_no_opt = PipelineAnalyzer \
  File "/home/sgrafbe/mlwhatif/mlwhatif/_pipeline_analyzer.py", line 93, in execute
    return singleton.run(notebook_path=self._notebook_path,
  File "/home/sgrafbe/mlwhatif/mlwhatif/execution/_pipeline_executor.py", line 145, in run
    self.run_what_if_analyses()
  File "/home/sgrafbe/mlwhatif/mlwhatif/execution/_pipeline_executor.py", line 173, in run_what_if_analyses
    DagExecutor(self).execute(self.analysis_results.combined_optimized_dag)
  File "/home/sgrafbe/mlwhatif/mlwhatif/execution/_dag_executor.py", line 45, in execute
    self.traverse_graph_and_process_nodes(dag, execute_node)
  File "/home/sgrafbe/mlwhatif/mlwhatif/execution/_dag_executor.py", line 57, in traverse_graph_and_process_nodes
    result_node = func(node)
  File "/home/sgrafbe/mlwhatif/mlwhatif/execution/_dag_executor.py", line 40, in execute_node
    optimizer_info, result_df = capture_optimizer_info(executable_processing_func)
  File "/home/sgrafbe/mlwhatif/mlwhatif/execution/_stat_tracking.py", line 28, in capture_optimizer_info
    result = instrumented_function_call()
  File "/home/sgrafbe/mlwhatif/mlwhatif/monkeypatching/_patch_sklearn.py", line 1729, in processing_func
    transformed_data = wrap_in_mlinspect_array_if_necessary(transformed_data)
  File "/home/sgrafbe/mlwhatif/mlwhatif/monkeypatching/_monkey_patching_utils.py", line 229, in wrap_in_mlinspect_array_if_necessary
    df_object = MlinspectNdarray(df_object)
  File "/home/sgrafbe/mlwhatif/mlwhatif/monkeypatching/_mlinspect_ndarray.py", line 16, in __new__
    obj = numpy.asarray(input_array).view(cls)
  File "/home/sgrafbe/mlwhatif/venv/lib64/python3.9/site-packages/numpy/core/_asarray.py", line 83, in asarray
    return array(a, dtype, copy=False, order=order)
numpy.core._exceptions.MemoryError: Unable to allocate 3.89 GiB for an array with shape (35312,) and data type <U29600
taskset -c 32-40 PROTOCOL_BUFFERS_PYTHON_IMPLEMENTATION=python python3.9 benchmarks_end_to_end.py feature_importance reviews fast_loading featurization_3 xgboost
2022-09-21 07:04:30.473205: W tensorflow/stream_executor/platform/default/dso_loader.cc:64] Could not load dynamic library 'libcudart.so.11.0'; dlerror: libcudart.so.11.0: cannot open shared object file: No such file or directory; LD_LIBRARY_PATH: /home/sgrafbe/mlwhatif/venv/lib/python3.9/site-packages/cv2/../../lib64:
2022-09-21 07:04:30.473253: I tensorflow/stream_executor/cuda/cudart_stub.cc:29] Ignore above cudart dlerror if you do not have a GPU set up on your machine.
2022-09-21 07:04:31 INFO  Patching sys.argv with ['mlwhatif', 'reviews', 'fast_loading', 'featurization_3', 'xgboost']
2022-09-21 07:04:31 INFO  Running instrumented original pipeline...
2022-09-21 07:04:31 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-21 07:04:31 INFO  ---RUNTIME: Importing and monkey-patching took 122.42531776428223 ms
2022-09-21 07:06:10 INFO  ---RUNTIME: Original pipeline execution took 98308.94470214844 ms (excluding imports and monkey-patching)
2022-09-21 07:06:10 INFO  Starting execution of 0 what-if analyses...
2022-09-21 07:06:10 INFO  Estimated runtime of original DAG is 90911.47470474243ms
2022-09-21 07:06:10 INFO  Performing Multi-Query Optimization
2022-09-21 07:06:10 INFO  Estimated unoptimized what-if runtime is 0ms
2022-09-21 07:06:10 INFO  Estimated optimised what-if runtime is 0ms
2022-09-21 07:06:10 INFO  Estimated optimisation runtime saving is 0ms
2022-09-21 07:06:10 INFO  ---RUNTIME: Multi-Query Optimization took 0.6201267242431641 ms
2022-09-21 07:06:10 INFO  Executing generated plans
2022-09-21 07:06:10 INFO  ---RUNTIME: Execution took 0.026941299438476562 ms
2022-09-21 07:06:10 INFO  Done!
2022-09-21 07:06:10 INFO  # Optimization benchmark for feature_importance with args [['reviews', 'fast_loading', 'featurization_3', 'xgboost']] -- repetition 1 of 7
2022-09-21 07:06:10 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-21 07:06:10 INFO  Running instrumented original pipeline...
2022-09-21 07:06:10 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-21 07:06:10 INFO  ---RUNTIME: Importing and monkey-patching took 5.866765975952148 ms
2022-09-21 07:08:09 INFO  ---RUNTIME: Original pipeline execution took 118921.00691795349 ms (excluding imports and monkey-patching)
2022-09-21 07:08:09 INFO  Starting execution of 1 what-if analyses...
2022-09-21 07:08:09 INFO  Start plan generation for analysis PermutationFeatureImportance...
2022-09-21 07:08:09 INFO  ---RUNTIME: Plan generation took 0.26035308837890625 ms
2022-09-21 07:08:09 INFO  Estimated runtime of original DAG is 104564.98742103577ms
2022-09-21 07:08:09 INFO  Performing Multi-Query Optimization
2022-09-21 07:08:09 INFO  Estimated unoptimized what-if runtime is 522824.93710517883ms
2022-09-21 07:08:09 INFO  Estimated optimised what-if runtime is 124383.45217704773ms
2022-09-21 07:08:09 INFO  Estimated optimisation runtime saving is 398441.4849281311ms
2022-09-21 07:08:09 INFO  ---RUNTIME: Multi-Query Optimization took 12.776851654052734 ms
2022-09-21 07:08:09 INFO  Executing generated plans
2022-09-21 07:09:35 INFO  ---RUNTIME: Execution took 86637.93468475342 ms
2022-09-21 07:09:35 INFO  Done!
2022-09-21 07:09:35 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-21 07:09:35 INFO  Running instrumented original pipeline...
2022-09-21 07:09:35 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-21 07:09:35 INFO  ---RUNTIME: Importing and monkey-patching took 6.494760513305664 ms
2022-09-21 07:11:02 INFO  ---RUNTIME: Original pipeline execution took 87036.41986846924 ms (excluding imports and monkey-patching)
2022-09-21 07:11:02 INFO  Starting execution of 1 what-if analyses...
2022-09-21 07:11:02 INFO  Start plan generation for analysis PermutationFeatureImportance...
2022-09-21 07:11:02 INFO  ---RUNTIME: Plan generation took 0.14400482177734375 ms
2022-09-21 07:11:02 INFO  Estimated runtime of original DAG is 71074.99074935913ms
2022-09-21 07:11:02 WARNING Skipping Multi-Query Optimization (instead, only combine execution DAGs)
2022-09-21 07:11:02 INFO  Estimated unoptimised what-if runtime is 355374.95374679565ms
2022-09-21 07:11:02 INFO  ---RUNTIME: Multi-Query Optimization took 19.364356994628906 ms
2022-09-21 07:11:02 INFO  Executing generated plans
Traceback (most recent call last):
  File "/home/sgrafbe/mlwhatif/experiments/end_to_end/benchmarks_end_to_end.py", line 238, in <module>
    analysis_result_no_opt = PipelineAnalyzer \
  File "/home/sgrafbe/mlwhatif/mlwhatif/_pipeline_analyzer.py", line 93, in execute
    return singleton.run(notebook_path=self._notebook_path,
  File "/home/sgrafbe/mlwhatif/mlwhatif/execution/_pipeline_executor.py", line 145, in run
    self.run_what_if_analyses()
  File "/home/sgrafbe/mlwhatif/mlwhatif/execution/_pipeline_executor.py", line 173, in run_what_if_analyses
    DagExecutor(self).execute(self.analysis_results.combined_optimized_dag)
  File "/home/sgrafbe/mlwhatif/mlwhatif/execution/_dag_executor.py", line 45, in execute
    self.traverse_graph_and_process_nodes(dag, execute_node)
  File "/home/sgrafbe/mlwhatif/mlwhatif/execution/_dag_executor.py", line 57, in traverse_graph_and_process_nodes
    result_node = func(node)
  File "/home/sgrafbe/mlwhatif/mlwhatif/execution/_dag_executor.py", line 40, in execute_node
    optimizer_info, result_df = capture_optimizer_info(executable_processing_func)
  File "/home/sgrafbe/mlwhatif/mlwhatif/execution/_stat_tracking.py", line 28, in capture_optimizer_info
    result = instrumented_function_call()
  File "/home/sgrafbe/mlwhatif/mlwhatif/monkeypatching/_patch_sklearn.py", line 1729, in processing_func
    transformed_data = wrap_in_mlinspect_array_if_necessary(transformed_data)
  File "/home/sgrafbe/mlwhatif/mlwhatif/monkeypatching/_monkey_patching_utils.py", line 229, in wrap_in_mlinspect_array_if_necessary
    df_object = MlinspectNdarray(df_object)
  File "/home/sgrafbe/mlwhatif/mlwhatif/monkeypatching/_mlinspect_ndarray.py", line 16, in __new__
    obj = numpy.asarray(input_array).view(cls)
  File "/home/sgrafbe/mlwhatif/venv/lib64/python3.9/site-packages/numpy/core/_asarray.py", line 83, in asarray
    return array(a, dtype, copy=False, order=order)
numpy.core._exceptions.MemoryError: Unable to allocate 3.71 GiB for an array with shape (35312,) and data type <U28219
taskset -c 32-40 PROTOCOL_BUFFERS_PYTHON_IMPLEMENTATION=python python3.9 benchmarks_end_to_end.py feature_importance reviews fast_loading featurization_3 neural_network
2022-09-21 07:13:55.890887: W tensorflow/stream_executor/platform/default/dso_loader.cc:64] Could not load dynamic library 'libcudart.so.11.0'; dlerror: libcudart.so.11.0: cannot open shared object file: No such file or directory; LD_LIBRARY_PATH: /home/sgrafbe/mlwhatif/venv/lib/python3.9/site-packages/cv2/../../lib64:
2022-09-21 07:13:55.890935: I tensorflow/stream_executor/cuda/cudart_stub.cc:29] Ignore above cudart dlerror if you do not have a GPU set up on your machine.
2022-09-21 07:13:57 INFO  Patching sys.argv with ['mlwhatif', 'reviews', 'fast_loading', 'featurization_3', 'neural_network']
2022-09-21 07:13:57 INFO  Running instrumented original pipeline...
2022-09-21 07:13:57 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-21 07:13:57 INFO  ---RUNTIME: Importing and monkey-patching took 122.47347831726074 ms
2022-09-21 07:14:18.843164: W tensorflow/stream_executor/platform/default/dso_loader.cc:64] Could not load dynamic library 'libcuda.so.1'; dlerror: libcuda.so.1: cannot open shared object file: No such file or directory; LD_LIBRARY_PATH: /home/sgrafbe/mlwhatif/venv/lib/python3.9/site-packages/cv2/../../lib64:
2022-09-21 07:14:18.843203: W tensorflow/stream_executor/cuda/cuda_driver.cc:326] failed call to cuInit: UNKNOWN ERROR (303)
2022-09-21 07:14:18.843226: I tensorflow/stream_executor/cuda/cuda_diagnostics.cc:156] kernel driver does not appear to be running on this host (angus): /proc/driver/nvidia/version does not exist
2022-09-21 07:14:18.843740: I tensorflow/core/platform/cpu_feature_guard.cc:142] This TensorFlow binary is optimized with oneAPI Deep Neural Network Library (oneDNN) to use the following CPU instructions in performance-critical operations:  AVX2 FMA
To enable them in other operations, rebuild TensorFlow with the appropriate compiler flags.
2022-09-21 07:14:19.483191: I tensorflow/compiler/mlir/mlir_graph_optimization_pass.cc:176] None of the MLIR Optimization Passes are enabled (registered 2)
2022-09-21 07:14:19.497181: I tensorflow/core/platform/profile_utils/cpu_utils.cc:114] CPU Frequency: 2595130000 Hz
2022-09-21 07:14:43 INFO  ---RUNTIME: Original pipeline execution took 46080.52897453308 ms (excluding imports and monkey-patching)
2022-09-21 07:14:43 INFO  Starting execution of 0 what-if analyses...
2022-09-21 07:14:43 INFO  Estimated runtime of original DAG is 38863.20877075195ms
2022-09-21 07:14:43 INFO  Performing Multi-Query Optimization
2022-09-21 07:14:43 INFO  Estimated unoptimized what-if runtime is 0ms
2022-09-21 07:14:43 INFO  Estimated optimised what-if runtime is 0ms
2022-09-21 07:14:43 INFO  Estimated optimisation runtime saving is 0ms
2022-09-21 07:14:43 INFO  ---RUNTIME: Multi-Query Optimization took 0.5879402160644531 ms
2022-09-21 07:14:43 INFO  Executing generated plans
2022-09-21 07:14:43 INFO  ---RUNTIME: Execution took 0.022172927856445312 ms
2022-09-21 07:14:43 INFO  Done!
2022-09-21 07:14:43 INFO  # Optimization benchmark for feature_importance with args [['reviews', 'fast_loading', 'featurization_3', 'neural_network']] -- repetition 1 of 7
2022-09-21 07:14:43 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-21 07:14:43 INFO  Running instrumented original pipeline...
2022-09-21 07:14:43 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-21 07:14:43 INFO  ---RUNTIME: Importing and monkey-patching took 5.340814590454102 ms
2022-09-21 07:15:31 INFO  ---RUNTIME: Original pipeline execution took 48108.57081413269 ms (excluding imports and monkey-patching)
2022-09-21 07:15:31 INFO  Starting execution of 1 what-if analyses...
2022-09-21 07:15:31 INFO  Start plan generation for analysis PermutationFeatureImportance...
2022-09-21 07:15:31 INFO  ---RUNTIME: Plan generation took 0.24557113647460938 ms
2022-09-21 07:15:31 INFO  Estimated runtime of original DAG is 38309.09609794617ms
2022-09-21 07:15:31 INFO  Performing Multi-Query Optimization
2022-09-21 07:15:31 INFO  Estimated unoptimized what-if runtime is 191545.48048973083ms
2022-09-21 07:15:31 INFO  Estimated optimised what-if runtime is 57428.20930480957ms
2022-09-21 07:15:31 INFO  Estimated optimisation runtime saving is 134117.27118492126ms
2022-09-21 07:15:31 INFO  ---RUNTIME: Multi-Query Optimization took 12.910604476928711 ms
2022-09-21 07:15:31 INFO  Executing generated plans
2022-09-21 07:16:17 INFO  ---RUNTIME: Execution took 46141.17169380188 ms
2022-09-21 07:16:17 INFO  Done!
2022-09-21 07:16:17 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-21 07:16:17 INFO  Running instrumented original pipeline...
2022-09-21 07:16:17 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-21 07:16:17 INFO  ---RUNTIME: Importing and monkey-patching took 5.953550338745117 ms
2022-09-21 07:17:16 INFO  ---RUNTIME: Original pipeline execution took 59039.3500328064 ms (excluding imports and monkey-patching)
2022-09-21 07:17:16 INFO  Starting execution of 1 what-if analyses...
2022-09-21 07:17:16 INFO  Start plan generation for analysis PermutationFeatureImportance...
2022-09-21 07:17:16 INFO  ---RUNTIME: Plan generation took 0.14328956604003906 ms
2022-09-21 07:17:16 INFO  Estimated runtime of original DAG is 42196.26975059509ms
2022-09-21 07:17:16 WARNING Skipping Multi-Query Optimization (instead, only combine execution DAGs)
2022-09-21 07:17:16 INFO  Estimated unoptimised what-if runtime is 210981.34875297546ms
2022-09-21 07:17:16 INFO  ---RUNTIME: Multi-Query Optimization took 19.199848175048828 ms
2022-09-21 07:17:16 INFO  Executing generated plans
./run-benchmarks--end-to-end.sh: line 43: 1586696 Killed                  PROTOCOL_BUFFERS_PYTHON_IMPLEMENTATION=python taskset -c "$core_num" python3.9 benchmarks_end_to_end.py "$scenario" "$dataset" "$data_loading" "$featurization" "$model"
taskset -c 32-40 PROTOCOL_BUFFERS_PYTHON_IMPLEMENTATION=python python3.9 benchmarks_end_to_end.py feature_importance reviews fast_loading featurization_4 logistic_regression
2022-09-21 07:18:16.362861: W tensorflow/stream_executor/platform/default/dso_loader.cc:64] Could not load dynamic library 'libcudart.so.11.0'; dlerror: libcudart.so.11.0: cannot open shared object file: No such file or directory; LD_LIBRARY_PATH: /home/sgrafbe/mlwhatif/venv/lib/python3.9/site-packages/cv2/../../lib64:
2022-09-21 07:18:16.362893: I tensorflow/stream_executor/cuda/cudart_stub.cc:29] Ignore above cudart dlerror if you do not have a GPU set up on your machine.
2022-09-21 07:18:18 INFO  Patching sys.argv with ['mlwhatif', 'reviews', 'fast_loading', 'featurization_4', 'logistic_regression']
2022-09-21 07:18:18 INFO  Running instrumented original pipeline...
2022-09-21 07:18:18 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-21 07:18:18 INFO  ---RUNTIME: Importing and monkey-patching took 217.66352653503418 ms
2022-09-21 07:18:32 INFO  ---RUNTIME: Original pipeline execution took 13221.524238586426 ms (excluding imports and monkey-patching)
2022-09-21 07:18:32 INFO  Starting execution of 0 what-if analyses...
2022-09-21 07:18:32 INFO  Estimated runtime of original DAG is 9650.974750518799ms
2022-09-21 07:18:32 INFO  Performing Multi-Query Optimization
2022-09-21 07:18:32 INFO  Estimated unoptimized what-if runtime is 0ms
2022-09-21 07:18:32 INFO  Estimated optimised what-if runtime is 0ms
2022-09-21 07:18:32 INFO  Estimated optimisation runtime saving is 0ms
2022-09-21 07:18:32 INFO  ---RUNTIME: Multi-Query Optimization took 0.5426406860351562 ms
2022-09-21 07:18:32 INFO  Executing generated plans
2022-09-21 07:18:32 INFO  ---RUNTIME: Execution took 0.026226043701171875 ms
2022-09-21 07:18:32 INFO  Done!
2022-09-21 07:18:32 INFO  # Optimization benchmark for feature_importance with args [['reviews', 'fast_loading', 'featurization_4', 'logistic_regression']] -- repetition 1 of 7
2022-09-21 07:18:32 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-21 07:18:32 INFO  Running instrumented original pipeline...
2022-09-21 07:18:32 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-21 07:18:32 INFO  ---RUNTIME: Importing and monkey-patching took 5.498409271240234 ms
2022-09-21 07:18:45 INFO  ---RUNTIME: Original pipeline execution took 12843.529462814331 ms (excluding imports and monkey-patching)
2022-09-21 07:18:45 INFO  Starting execution of 1 what-if analyses...
2022-09-21 07:18:45 INFO  Start plan generation for analysis PermutationFeatureImportance...
2022-09-21 07:18:45 INFO  ---RUNTIME: Plan generation took 0.22268295288085938 ms
2022-09-21 07:18:45 INFO  Estimated runtime of original DAG is 9590.290069580078ms
2022-09-21 07:18:45 INFO  Performing Multi-Query Optimization
2022-09-21 07:18:45 INFO  Estimated unoptimized what-if runtime is 47951.45034790039ms
2022-09-21 07:18:45 INFO  Estimated optimised what-if runtime is 9794.706344604492ms
2022-09-21 07:18:45 INFO  Estimated optimisation runtime saving is 38156.7440032959ms
2022-09-21 07:18:45 INFO  ---RUNTIME: Multi-Query Optimization took 10.773420333862305 ms
2022-09-21 07:18:45 INFO  Executing generated plans
2022-09-21 07:18:55 INFO  ---RUNTIME: Execution took 10603.305339813232 ms
2022-09-21 07:18:55 INFO  Done!
2022-09-21 07:18:55 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-21 07:18:55 INFO  Running instrumented original pipeline...
2022-09-21 07:18:55 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-21 07:18:55 INFO  ---RUNTIME: Importing and monkey-patching took 6.174802780151367 ms
2022-09-21 07:19:08 INFO  ---RUNTIME: Original pipeline execution took 12675.297260284424 ms (excluding imports and monkey-patching)
2022-09-21 07:19:08 INFO  Starting execution of 1 what-if analyses...
2022-09-21 07:19:08 INFO  Start plan generation for analysis PermutationFeatureImportance...
2022-09-21 07:19:08 INFO  ---RUNTIME: Plan generation took 0.095367431640625 ms
2022-09-21 07:19:08 INFO  Estimated runtime of original DAG is 9228.440284729004ms
2022-09-21 07:19:08 WARNING Skipping Multi-Query Optimization (instead, only combine execution DAGs)
2022-09-21 07:19:08 INFO  Estimated unoptimised what-if runtime is 46142.20142364502ms
2022-09-21 07:19:08 INFO  ---RUNTIME: Multi-Query Optimization took 15.500068664550781 ms
2022-09-21 07:19:08 INFO  Executing generated plans
2022-09-21 07:19:59 INFO  ---RUNTIME: Execution took 51186.50245666504 ms
2022-09-21 07:19:59 INFO  Done!
2022-09-21 07:19:59 INFO  # Finished -- repetition 1 of 7 
2022-09-21 07:19:59 INFO  # Optimization benchmark for feature_importance with args [['reviews', 'fast_loading', 'featurization_4', 'logistic_regression']] -- repetition 2 of 7
2022-09-21 07:19:59 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-21 07:19:59 INFO  Running instrumented original pipeline...
2022-09-21 07:19:59 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-21 07:19:59 INFO  ---RUNTIME: Importing and monkey-patching took 5.794048309326172 ms
2022-09-21 07:20:12 INFO  ---RUNTIME: Original pipeline execution took 12970.160484313965 ms (excluding imports and monkey-patching)
2022-09-21 07:20:12 INFO  Starting execution of 1 what-if analyses...
2022-09-21 07:20:12 INFO  Start plan generation for analysis PermutationFeatureImportance...
2022-09-21 07:20:12 INFO  ---RUNTIME: Plan generation took 0.16307830810546875 ms
2022-09-21 07:20:12 INFO  Estimated runtime of original DAG is 9654.18529510498ms
2022-09-21 07:20:12 INFO  Performing Multi-Query Optimization
2022-09-21 07:20:12 INFO  Estimated unoptimized what-if runtime is 48270.9264755249ms
2022-09-21 07:20:12 INFO  Estimated optimised what-if runtime is 9870.195388793945ms
2022-09-21 07:20:12 INFO  Estimated optimisation runtime saving is 38400.73108673096ms
2022-09-21 07:20:12 INFO  ---RUNTIME: Multi-Query Optimization took 12.222051620483398 ms
2022-09-21 07:20:12 INFO  Executing generated plans
2022-09-21 07:20:24 INFO  ---RUNTIME: Execution took 11602.754831314087 ms
2022-09-21 07:20:24 INFO  Done!
2022-09-21 07:20:24 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-21 07:20:24 INFO  Running instrumented original pipeline...
2022-09-21 07:20:24 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-21 07:20:24 INFO  ---RUNTIME: Importing and monkey-patching took 5.771875381469727 ms
2022-09-21 07:20:37 INFO  ---RUNTIME: Original pipeline execution took 13290.947914123535 ms (excluding imports and monkey-patching)
2022-09-21 07:20:37 INFO  Starting execution of 1 what-if analyses...
2022-09-21 07:20:37 INFO  Start plan generation for analysis PermutationFeatureImportance...
2022-09-21 07:20:37 INFO  ---RUNTIME: Plan generation took 0.13256072998046875 ms
2022-09-21 07:20:37 INFO  Estimated runtime of original DAG is 9821.919679641724ms
2022-09-21 07:20:37 WARNING Skipping Multi-Query Optimization (instead, only combine execution DAGs)
2022-09-21 07:20:37 INFO  Estimated unoptimised what-if runtime is 49109.59839820862ms
2022-09-21 07:20:37 INFO  ---RUNTIME: Multi-Query Optimization took 15.80953598022461 ms
2022-09-21 07:20:37 INFO  Executing generated plans
2022-09-21 07:21:28 INFO  ---RUNTIME: Execution took 51283.29873085022 ms
2022-09-21 07:21:28 INFO  Done!
2022-09-21 07:21:28 INFO  # Finished -- repetition 2 of 7 
2022-09-21 07:21:28 INFO  # Optimization benchmark for feature_importance with args [['reviews', 'fast_loading', 'featurization_4', 'logistic_regression']] -- repetition 3 of 7
2022-09-21 07:21:28 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-21 07:21:28 INFO  Running instrumented original pipeline...
2022-09-21 07:21:28 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-21 07:21:28 INFO  ---RUNTIME: Importing and monkey-patching took 5.964517593383789 ms
2022-09-21 07:21:41 INFO  ---RUNTIME: Original pipeline execution took 12980.433464050293 ms (excluding imports and monkey-patching)
2022-09-21 07:21:41 INFO  Starting execution of 1 what-if analyses...
2022-09-21 07:21:41 INFO  Start plan generation for analysis PermutationFeatureImportance...
2022-09-21 07:21:41 INFO  ---RUNTIME: Plan generation took 0.09632110595703125 ms
2022-09-21 07:21:41 INFO  Estimated runtime of original DAG is 9436.301946640015ms
2022-09-21 07:21:41 INFO  Performing Multi-Query Optimization
2022-09-21 07:21:41 INFO  Estimated unoptimized what-if runtime is 47181.50973320007ms
2022-09-21 07:21:41 INFO  Estimated optimised what-if runtime is 9635.913848876953ms
2022-09-21 07:21:41 INFO  Estimated optimisation runtime saving is 37545.59588432312ms
2022-09-21 07:21:41 INFO  ---RUNTIME: Multi-Query Optimization took 10.876893997192383 ms
2022-09-21 07:21:41 INFO  Executing generated plans
2022-09-21 07:21:52 INFO  ---RUNTIME: Execution took 10703.301668167114 ms
2022-09-21 07:21:52 INFO  Done!
2022-09-21 07:21:52 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-21 07:21:52 INFO  Running instrumented original pipeline...
2022-09-21 07:21:52 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-21 07:21:52 INFO  ---RUNTIME: Importing and monkey-patching took 5.716085433959961 ms
2022-09-21 07:22:05 INFO  ---RUNTIME: Original pipeline execution took 13091.047286987305 ms (excluding imports and monkey-patching)
2022-09-21 07:22:05 INFO  Starting execution of 1 what-if analyses...
2022-09-21 07:22:05 INFO  Start plan generation for analysis PermutationFeatureImportance...
2022-09-21 07:22:05 INFO  ---RUNTIME: Plan generation took 0.09846687316894531 ms
2022-09-21 07:22:05 INFO  Estimated runtime of original DAG is 9606.916427612305ms
2022-09-21 07:22:05 WARNING Skipping Multi-Query Optimization (instead, only combine execution DAGs)
2022-09-21 07:22:05 INFO  Estimated unoptimised what-if runtime is 48034.58213806152ms
2022-09-21 07:22:05 INFO  ---RUNTIME: Multi-Query Optimization took 15.783548355102539 ms
2022-09-21 07:22:05 INFO  Executing generated plans
2022-09-21 07:22:57 INFO  ---RUNTIME: Execution took 52415.00163078308 ms
2022-09-21 07:22:57 INFO  Done!
2022-09-21 07:22:57 INFO  # Finished -- repetition 3 of 7 
2022-09-21 07:22:57 INFO  # Optimization benchmark for feature_importance with args [['reviews', 'fast_loading', 'featurization_4', 'logistic_regression']] -- repetition 4 of 7
2022-09-21 07:22:57 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-21 07:22:57 INFO  Running instrumented original pipeline...
2022-09-21 07:22:58 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-21 07:22:58 INFO  ---RUNTIME: Importing and monkey-patching took 5.928754806518555 ms
2022-09-21 07:23:10 INFO  ---RUNTIME: Original pipeline execution took 12685.811281204224 ms (excluding imports and monkey-patching)
2022-09-21 07:23:10 INFO  Starting execution of 1 what-if analyses...
2022-09-21 07:23:10 INFO  Start plan generation for analysis PermutationFeatureImportance...
2022-09-21 07:23:10 INFO  ---RUNTIME: Plan generation took 0.09560585021972656 ms
2022-09-21 07:23:10 INFO  Estimated runtime of original DAG is 9376.888513565063ms
2022-09-21 07:23:10 INFO  Performing Multi-Query Optimization
2022-09-21 07:23:10 INFO  Estimated unoptimized what-if runtime is 46884.44256782532ms
2022-09-21 07:23:10 INFO  Estimated optimised what-if runtime is 9617.057800292969ms
2022-09-21 07:23:10 INFO  Estimated optimisation runtime saving is 37267.38476753235ms
2022-09-21 07:23:10 INFO  ---RUNTIME: Multi-Query Optimization took 10.643720626831055 ms
2022-09-21 07:23:10 INFO  Executing generated plans
2022-09-21 07:23:21 INFO  ---RUNTIME: Execution took 10926.948070526123 ms
2022-09-21 07:23:21 INFO  Done!
2022-09-21 07:23:21 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-21 07:23:21 INFO  Running instrumented original pipeline...
2022-09-21 07:23:21 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-21 07:23:21 INFO  ---RUNTIME: Importing and monkey-patching took 5.636692047119141 ms
2022-09-21 07:23:34 INFO  ---RUNTIME: Original pipeline execution took 12803.998231887817 ms (excluding imports and monkey-patching)
2022-09-21 07:23:34 INFO  Starting execution of 1 what-if analyses...
2022-09-21 07:23:34 INFO  Start plan generation for analysis PermutationFeatureImportance...
2022-09-21 07:23:34 INFO  ---RUNTIME: Plan generation took 0.12826919555664062 ms
2022-09-21 07:23:34 INFO  Estimated runtime of original DAG is 9473.81591796875ms
2022-09-21 07:23:34 WARNING Skipping Multi-Query Optimization (instead, only combine execution DAGs)
2022-09-21 07:23:34 INFO  Estimated unoptimised what-if runtime is 47369.07958984375ms
2022-09-21 07:23:34 INFO  ---RUNTIME: Multi-Query Optimization took 15.597820281982422 ms
2022-09-21 07:23:34 INFO  Executing generated plans
2022-09-21 07:24:26 INFO  ---RUNTIME: Execution took 51958.81271362305 ms
2022-09-21 07:24:26 INFO  Done!
2022-09-21 07:24:26 INFO  # Finished -- repetition 4 of 7 
2022-09-21 07:24:26 INFO  # Optimization benchmark for feature_importance with args [['reviews', 'fast_loading', 'featurization_4', 'logistic_regression']] -- repetition 5 of 7
2022-09-21 07:24:26 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-21 07:24:26 INFO  Running instrumented original pipeline...
2022-09-21 07:24:26 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-21 07:24:26 INFO  ---RUNTIME: Importing and monkey-patching took 6.308555603027344 ms
2022-09-21 07:24:39 INFO  ---RUNTIME: Original pipeline execution took 12906.12268447876 ms (excluding imports and monkey-patching)
2022-09-21 07:24:39 INFO  Starting execution of 1 what-if analyses...
2022-09-21 07:24:39 INFO  Start plan generation for analysis PermutationFeatureImportance...
2022-09-21 07:24:39 INFO  ---RUNTIME: Plan generation took 0.09489059448242188 ms
2022-09-21 07:24:39 INFO  Estimated runtime of original DAG is 9323.85277748108ms
2022-09-21 07:24:39 INFO  Performing Multi-Query Optimization
2022-09-21 07:24:39 INFO  Estimated unoptimized what-if runtime is 46619.263887405396ms
2022-09-21 07:24:39 INFO  Estimated optimised what-if runtime is 9562.591314315796ms
2022-09-21 07:24:39 INFO  Estimated optimisation runtime saving is 37056.6725730896ms
2022-09-21 07:24:39 INFO  ---RUNTIME: Multi-Query Optimization took 10.664701461791992 ms
2022-09-21 07:24:39 INFO  Executing generated plans
2022-09-21 07:24:49 INFO  ---RUNTIME: Execution took 10491.625785827637 ms
2022-09-21 07:24:49 INFO  Done!
2022-09-21 07:24:49 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-21 07:24:49 INFO  Running instrumented original pipeline...
2022-09-21 07:24:49 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-21 07:24:49 INFO  ---RUNTIME: Importing and monkey-patching took 5.625247955322266 ms
2022-09-21 07:25:02 INFO  ---RUNTIME: Original pipeline execution took 13058.944463729858 ms (excluding imports and monkey-patching)
2022-09-21 07:25:02 INFO  Starting execution of 1 what-if analyses...
2022-09-21 07:25:02 INFO  Start plan generation for analysis PermutationFeatureImportance...
2022-09-21 07:25:02 INFO  ---RUNTIME: Plan generation took 0.09918212890625 ms
2022-09-21 07:25:02 INFO  Estimated runtime of original DAG is 9502.017498016357ms
2022-09-21 07:25:02 WARNING Skipping Multi-Query Optimization (instead, only combine execution DAGs)
2022-09-21 07:25:02 INFO  Estimated unoptimised what-if runtime is 47510.08749008179ms
2022-09-21 07:25:02 INFO  ---RUNTIME: Multi-Query Optimization took 15.69223403930664 ms
2022-09-21 07:25:02 INFO  Executing generated plans
2022-09-21 07:25:55 INFO  ---RUNTIME: Execution took 52151.56102180481 ms
2022-09-21 07:25:55 INFO  Done!
2022-09-21 07:25:55 INFO  # Finished -- repetition 5 of 7 
2022-09-21 07:25:55 INFO  # Optimization benchmark for feature_importance with args [['reviews', 'fast_loading', 'featurization_4', 'logistic_regression']] -- repetition 6 of 7
2022-09-21 07:25:55 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-21 07:25:55 INFO  Running instrumented original pipeline...
2022-09-21 07:25:55 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-21 07:25:55 INFO  ---RUNTIME: Importing and monkey-patching took 5.684137344360352 ms
2022-09-21 07:26:08 INFO  ---RUNTIME: Original pipeline execution took 13515.12622833252 ms (excluding imports and monkey-patching)
2022-09-21 07:26:08 INFO  Starting execution of 1 what-if analyses...
2022-09-21 07:26:08 INFO  Start plan generation for analysis PermutationFeatureImportance...
2022-09-21 07:26:08 INFO  ---RUNTIME: Plan generation took 0.10061264038085938 ms
2022-09-21 07:26:08 INFO  Estimated runtime of original DAG is 10019.862413406372ms
2022-09-21 07:26:08 INFO  Performing Multi-Query Optimization
2022-09-21 07:26:08 INFO  Estimated unoptimized what-if runtime is 50099.31206703186ms
2022-09-21 07:26:08 INFO  Estimated optimised what-if runtime is 10310.123682022095ms
2022-09-21 07:26:08 INFO  Estimated optimisation runtime saving is 39789.188385009766ms
2022-09-21 07:26:08 INFO  ---RUNTIME: Multi-Query Optimization took 11.85297966003418 ms
2022-09-21 07:26:08 INFO  Executing generated plans
2022-09-21 07:26:20 INFO  ---RUNTIME: Execution took 11547.688722610474 ms
2022-09-21 07:26:20 INFO  Done!
2022-09-21 07:26:20 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-21 07:26:20 INFO  Running instrumented original pipeline...
2022-09-21 07:26:20 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-21 07:26:20 INFO  ---RUNTIME: Importing and monkey-patching took 5.697727203369141 ms
2022-09-21 07:26:33 INFO  ---RUNTIME: Original pipeline execution took 13166.011095046997 ms (excluding imports and monkey-patching)
2022-09-21 07:26:33 INFO  Starting execution of 1 what-if analyses...
2022-09-21 07:26:33 INFO  Start plan generation for analysis PermutationFeatureImportance...
2022-09-21 07:26:33 INFO  ---RUNTIME: Plan generation took 0.10061264038085938 ms
2022-09-21 07:26:33 INFO  Estimated runtime of original DAG is 9520.384788513184ms
2022-09-21 07:26:33 WARNING Skipping Multi-Query Optimization (instead, only combine execution DAGs)
2022-09-21 07:26:33 INFO  Estimated unoptimised what-if runtime is 47601.92394256592ms
2022-09-21 07:26:33 INFO  ---RUNTIME: Multi-Query Optimization took 15.604496002197266 ms
2022-09-21 07:26:33 INFO  Executing generated plans
2022-09-21 07:27:25 INFO  ---RUNTIME: Execution took 51946.465253829956 ms
2022-09-21 07:27:25 INFO  Done!
2022-09-21 07:27:25 INFO  # Finished -- repetition 6 of 7 
2022-09-21 07:27:25 INFO  # Optimization benchmark for feature_importance with args [['reviews', 'fast_loading', 'featurization_4', 'logistic_regression']] -- repetition 7 of 7
2022-09-21 07:27:25 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-21 07:27:25 INFO  Running instrumented original pipeline...
2022-09-21 07:27:25 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-21 07:27:25 INFO  ---RUNTIME: Importing and monkey-patching took 6.327152252197266 ms
2022-09-21 07:27:38 INFO  ---RUNTIME: Original pipeline execution took 12883.67509841919 ms (excluding imports and monkey-patching)
2022-09-21 07:27:38 INFO  Starting execution of 1 what-if analyses...
2022-09-21 07:27:38 INFO  Start plan generation for analysis PermutationFeatureImportance...
2022-09-21 07:27:38 INFO  ---RUNTIME: Plan generation took 0.12350082397460938 ms
2022-09-21 07:27:38 INFO  Estimated runtime of original DAG is 9475.11076927185ms
2022-09-21 07:27:38 INFO  Performing Multi-Query Optimization
2022-09-21 07:27:38 INFO  Estimated unoptimized what-if runtime is 47375.55384635925ms
2022-09-21 07:27:38 INFO  Estimated optimised what-if runtime is 9716.804027557373ms
2022-09-21 07:27:38 INFO  Estimated optimisation runtime saving is 37658.74981880188ms
2022-09-21 07:27:38 INFO  ---RUNTIME: Multi-Query Optimization took 10.803699493408203 ms
2022-09-21 07:27:38 INFO  Executing generated plans
2022-09-21 07:27:48 INFO  ---RUNTIME: Execution took 10641.373634338379 ms
2022-09-21 07:27:48 INFO  Done!
2022-09-21 07:27:48 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-21 07:27:48 INFO  Running instrumented original pipeline...
2022-09-21 07:27:49 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-21 07:27:49 INFO  ---RUNTIME: Importing and monkey-patching took 5.785465240478516 ms
2022-09-21 07:28:01 INFO  ---RUNTIME: Original pipeline execution took 13026.927471160889 ms (excluding imports and monkey-patching)
2022-09-21 07:28:01 INFO  Starting execution of 1 what-if analyses...
2022-09-21 07:28:01 INFO  Start plan generation for analysis PermutationFeatureImportance...
2022-09-21 07:28:01 INFO  ---RUNTIME: Plan generation took 0.09369850158691406 ms
2022-09-21 07:28:01 INFO  Estimated runtime of original DAG is 9384.034633636475ms
2022-09-21 07:28:01 WARNING Skipping Multi-Query Optimization (instead, only combine execution DAGs)
2022-09-21 07:28:01 INFO  Estimated unoptimised what-if runtime is 46920.17316818237ms
2022-09-21 07:28:01 INFO  ---RUNTIME: Multi-Query Optimization took 15.515565872192383 ms
2022-09-21 07:28:01 INFO  Executing generated plans
2022-09-21 07:28:54 INFO  ---RUNTIME: Execution took 52348.22154045105 ms
2022-09-21 07:28:54 INFO  Done!
2022-09-21 07:28:54 INFO  # Finished -- repetition 7 of 7 
2022-09-21 07:28:54 INFO  # Final results after all repetitions
2022-09-21 07:28:54 INFO     repetition  ... no_opt_what_if_execution_combined_model_training
0           0  ...                                       894.587040
1           1  ...                                       890.860081
2           2  ...                                      1014.009237
3           3  ...                                      1063.036919
4           4  ...                                      1018.877506
5           5  ...                                      1018.560886
6           6  ...                                       912.533283

[7 rows x 26 columns]
taskset -c 32-40 PROTOCOL_BUFFERS_PYTHON_IMPLEMENTATION=python python3.9 benchmarks_end_to_end.py feature_importance reviews fast_loading featurization_4 xgboost
2022-09-21 07:28:56.512992: W tensorflow/stream_executor/platform/default/dso_loader.cc:64] Could not load dynamic library 'libcudart.so.11.0'; dlerror: libcudart.so.11.0: cannot open shared object file: No such file or directory; LD_LIBRARY_PATH: /home/sgrafbe/mlwhatif/venv/lib/python3.9/site-packages/cv2/../../lib64:
2022-09-21 07:28:56.513035: I tensorflow/stream_executor/cuda/cudart_stub.cc:29] Ignore above cudart dlerror if you do not have a GPU set up on your machine.
2022-09-21 07:28:57 INFO  Patching sys.argv with ['mlwhatif', 'reviews', 'fast_loading', 'featurization_4', 'xgboost']
2022-09-21 07:28:57 INFO  Running instrumented original pipeline...
2022-09-21 07:28:57 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-21 07:28:57 INFO  ---RUNTIME: Importing and monkey-patching took 120.68819999694824 ms
2022-09-21 07:29:14 INFO  ---RUNTIME: Original pipeline execution took 16957.96847343445 ms (excluding imports and monkey-patching)
2022-09-21 07:29:14 INFO  Starting execution of 0 what-if analyses...
2022-09-21 07:29:14 INFO  Estimated runtime of original DAG is 13676.39422416687ms
2022-09-21 07:29:14 INFO  Performing Multi-Query Optimization
2022-09-21 07:29:14 INFO  Estimated unoptimized what-if runtime is 0ms
2022-09-21 07:29:14 INFO  Estimated optimised what-if runtime is 0ms
2022-09-21 07:29:14 INFO  Estimated optimisation runtime saving is 0ms
2022-09-21 07:29:14 INFO  ---RUNTIME: Multi-Query Optimization took 0.5180835723876953 ms
2022-09-21 07:29:14 INFO  Executing generated plans
2022-09-21 07:29:14 INFO  ---RUNTIME: Execution took 0.024080276489257812 ms
2022-09-21 07:29:14 INFO  Done!
2022-09-21 07:29:14 INFO  # Optimization benchmark for feature_importance with args [['reviews', 'fast_loading', 'featurization_4', 'xgboost']] -- repetition 1 of 7
2022-09-21 07:29:14 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-21 07:29:14 INFO  Running instrumented original pipeline...
2022-09-21 07:29:14 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-21 07:29:14 INFO  ---RUNTIME: Importing and monkey-patching took 5.426645278930664 ms
2022-09-21 07:29:32 INFO  ---RUNTIME: Original pipeline execution took 17402.69660949707 ms (excluding imports and monkey-patching)
2022-09-21 07:29:32 INFO  Starting execution of 1 what-if analyses...
2022-09-21 07:29:32 INFO  Start plan generation for analysis PermutationFeatureImportance...
2022-09-21 07:29:32 INFO  ---RUNTIME: Plan generation took 0.21910667419433594 ms
2022-09-21 07:29:32 INFO  Estimated runtime of original DAG is 13819.129467010498ms
2022-09-21 07:29:32 INFO  Performing Multi-Query Optimization
2022-09-21 07:29:32 INFO  Estimated unoptimized what-if runtime is 69095.64733505249ms
2022-09-21 07:29:32 INFO  Estimated optimised what-if runtime is 14253.387928009033ms
2022-09-21 07:29:32 INFO  Estimated optimisation runtime saving is 54842.25940704346ms
2022-09-21 07:29:32 INFO  ---RUNTIME: Multi-Query Optimization took 10.86282730102539 ms
2022-09-21 07:29:32 INFO  Executing generated plans
2022-09-21 07:29:47 INFO  ---RUNTIME: Execution took 15301.417589187622 ms
2022-09-21 07:29:47 INFO  Done!
2022-09-21 07:29:47 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-21 07:29:47 INFO  Running instrumented original pipeline...
2022-09-21 07:29:47 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-21 07:29:47 INFO  ---RUNTIME: Importing and monkey-patching took 6.255388259887695 ms
2022-09-21 07:30:04 INFO  ---RUNTIME: Original pipeline execution took 17095.35574913025 ms (excluding imports and monkey-patching)
2022-09-21 07:30:04 INFO  Starting execution of 1 what-if analyses...
2022-09-21 07:30:04 INFO  Start plan generation for analysis PermutationFeatureImportance...
2022-09-21 07:30:04 INFO  ---RUNTIME: Plan generation took 0.11205673217773438 ms
2022-09-21 07:30:04 INFO  Estimated runtime of original DAG is 13508.88204574585ms
2022-09-21 07:30:04 WARNING Skipping Multi-Query Optimization (instead, only combine execution DAGs)
2022-09-21 07:30:04 INFO  Estimated unoptimised what-if runtime is 67544.41022872925ms
2022-09-21 07:30:04 INFO  ---RUNTIME: Multi-Query Optimization took 15.872001647949219 ms
2022-09-21 07:30:04 INFO  Executing generated plans
2022-09-21 07:31:19 INFO  ---RUNTIME: Execution took 74315.18888473511 ms
2022-09-21 07:31:19 INFO  Done!
2022-09-21 07:31:19 INFO  # Finished -- repetition 1 of 7 
2022-09-21 07:31:19 INFO  # Optimization benchmark for feature_importance with args [['reviews', 'fast_loading', 'featurization_4', 'xgboost']] -- repetition 2 of 7
2022-09-21 07:31:19 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-21 07:31:19 INFO  Running instrumented original pipeline...
2022-09-21 07:31:19 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-21 07:31:19 INFO  ---RUNTIME: Importing and monkey-patching took 6.033658981323242 ms
2022-09-21 07:31:36 INFO  ---RUNTIME: Original pipeline execution took 17054.791688919067 ms (excluding imports and monkey-patching)
2022-09-21 07:31:36 INFO  Starting execution of 1 what-if analyses...
2022-09-21 07:31:36 INFO  Start plan generation for analysis PermutationFeatureImportance...
2022-09-21 07:31:36 INFO  ---RUNTIME: Plan generation took 0.12826919555664062 ms
2022-09-21 07:31:36 INFO  Estimated runtime of original DAG is 13625.887632369995ms
2022-09-21 07:31:36 INFO  Performing Multi-Query Optimization
2022-09-21 07:31:36 INFO  Estimated unoptimized what-if runtime is 68129.43816184998ms
2022-09-21 07:31:36 INFO  Estimated optimised what-if runtime is 13993.42966079712ms
2022-09-21 07:31:36 INFO  Estimated optimisation runtime saving is 54136.00850105286ms
2022-09-21 07:31:36 INFO  ---RUNTIME: Multi-Query Optimization took 11.352777481079102 ms
2022-09-21 07:31:36 INFO  Executing generated plans
2022-09-21 07:31:51 INFO  ---RUNTIME: Execution took 15843.204736709595 ms
2022-09-21 07:31:51 INFO  Done!
2022-09-21 07:31:51 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-21 07:31:51 INFO  Running instrumented original pipeline...
2022-09-21 07:31:52 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-21 07:31:52 INFO  ---RUNTIME: Importing and monkey-patching took 5.720376968383789 ms
2022-09-21 07:32:09 INFO  ---RUNTIME: Original pipeline execution took 17159.152030944824 ms (excluding imports and monkey-patching)
2022-09-21 07:32:09 INFO  Starting execution of 1 what-if analyses...
2022-09-21 07:32:09 INFO  Start plan generation for analysis PermutationFeatureImportance...
2022-09-21 07:32:09 INFO  ---RUNTIME: Plan generation took 0.1285076141357422 ms
2022-09-21 07:32:09 INFO  Estimated runtime of original DAG is 13743.215084075928ms
2022-09-21 07:32:09 WARNING Skipping Multi-Query Optimization (instead, only combine execution DAGs)
2022-09-21 07:32:09 INFO  Estimated unoptimised what-if runtime is 68716.07542037964ms
2022-09-21 07:32:09 INFO  ---RUNTIME: Multi-Query Optimization took 15.82479476928711 ms
2022-09-21 07:32:09 INFO  Executing generated plans
2022-09-21 07:33:29 INFO  ---RUNTIME: Execution took 80738.10291290283 ms
2022-09-21 07:33:29 INFO  Done!
2022-09-21 07:33:29 INFO  # Finished -- repetition 2 of 7 
2022-09-21 07:33:29 INFO  # Optimization benchmark for feature_importance with args [['reviews', 'fast_loading', 'featurization_4', 'xgboost']] -- repetition 3 of 7
2022-09-21 07:33:29 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-21 07:33:29 INFO  Running instrumented original pipeline...
2022-09-21 07:33:29 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-21 07:33:29 INFO  ---RUNTIME: Importing and monkey-patching took 6.387233734130859 ms
2022-09-21 07:33:46 INFO  ---RUNTIME: Original pipeline execution took 16478.274822235107 ms (excluding imports and monkey-patching)
2022-09-21 07:33:46 INFO  Starting execution of 1 what-if analyses...
2022-09-21 07:33:46 INFO  Start plan generation for analysis PermutationFeatureImportance...
2022-09-21 07:33:46 INFO  ---RUNTIME: Plan generation took 0.11038780212402344 ms
2022-09-21 07:33:46 INFO  Estimated runtime of original DAG is 12946.340799331665ms
2022-09-21 07:33:46 INFO  Performing Multi-Query Optimization
2022-09-21 07:33:46 INFO  Estimated unoptimized what-if runtime is 64731.703996658325ms
2022-09-21 07:33:46 INFO  Estimated optimised what-if runtime is 13360.95666885376ms
2022-09-21 07:33:46 INFO  Estimated optimisation runtime saving is 51370.747327804565ms
2022-09-21 07:33:46 INFO  ---RUNTIME: Multi-Query Optimization took 10.994672775268555 ms
2022-09-21 07:33:46 INFO  Executing generated plans
2022-09-21 07:34:00 INFO  ---RUNTIME: Execution took 14412.886381149292 ms
2022-09-21 07:34:00 INFO  Done!
2022-09-21 07:34:00 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-21 07:34:00 INFO  Running instrumented original pipeline...
2022-09-21 07:34:00 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-21 07:34:00 INFO  ---RUNTIME: Importing and monkey-patching took 5.652666091918945 ms
2022-09-21 07:34:17 INFO  ---RUNTIME: Original pipeline execution took 16712.94331550598 ms (excluding imports and monkey-patching)
2022-09-21 07:34:17 INFO  Starting execution of 1 what-if analyses...
2022-09-21 07:34:17 INFO  Start plan generation for analysis PermutationFeatureImportance...
2022-09-21 07:34:17 INFO  ---RUNTIME: Plan generation took 0.1010894775390625 ms
2022-09-21 07:34:17 INFO  Estimated runtime of original DAG is 13167.46187210083ms
2022-09-21 07:34:17 WARNING Skipping Multi-Query Optimization (instead, only combine execution DAGs)
2022-09-21 07:34:17 INFO  Estimated unoptimised what-if runtime is 65837.30936050415ms
2022-09-21 07:34:17 INFO  ---RUNTIME: Multi-Query Optimization took 15.761613845825195 ms
2022-09-21 07:34:17 INFO  Executing generated plans
2022-09-21 07:35:28 INFO  ---RUNTIME: Execution took 70865.24248123169 ms
2022-09-21 07:35:28 INFO  Done!
2022-09-21 07:35:28 INFO  # Finished -- repetition 3 of 7 
2022-09-21 07:35:28 INFO  # Optimization benchmark for feature_importance with args [['reviews', 'fast_loading', 'featurization_4', 'xgboost']] -- repetition 4 of 7
2022-09-21 07:35:28 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-21 07:35:28 INFO  Running instrumented original pipeline...
2022-09-21 07:35:28 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-21 07:35:28 INFO  ---RUNTIME: Importing and monkey-patching took 5.73277473449707 ms
2022-09-21 07:36:13 INFO  ---RUNTIME: Original pipeline execution took 44840.04831314087 ms (excluding imports and monkey-patching)
2022-09-21 07:36:13 INFO  Starting execution of 1 what-if analyses...
2022-09-21 07:36:13 INFO  Start plan generation for analysis PermutationFeatureImportance...
2022-09-21 07:36:13 INFO  ---RUNTIME: Plan generation took 0.1385211944580078 ms
2022-09-21 07:36:13 INFO  Estimated runtime of original DAG is 41557.94358253479ms
2022-09-21 07:36:13 INFO  Performing Multi-Query Optimization
2022-09-21 07:36:13 INFO  Estimated unoptimized what-if runtime is 207789.71791267395ms
2022-09-21 07:36:13 INFO  Estimated optimised what-if runtime is 41945.52206993103ms
2022-09-21 07:36:13 INFO  Estimated optimisation runtime saving is 165844.19584274292ms
2022-09-21 07:36:13 INFO  ---RUNTIME: Multi-Query Optimization took 10.934829711914062 ms
2022-09-21 07:36:13 INFO  Executing generated plans
2022-09-21 07:36:28 INFO  ---RUNTIME: Execution took 15249.324560165405 ms
2022-09-21 07:36:28 INFO  Done!
2022-09-21 07:36:28 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-21 07:36:28 INFO  Running instrumented original pipeline...
2022-09-21 07:36:28 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-21 07:36:28 INFO  ---RUNTIME: Importing and monkey-patching took 5.732536315917969 ms
2022-09-21 07:36:45 INFO  ---RUNTIME: Original pipeline execution took 16993.157863616943 ms (excluding imports and monkey-patching)
2022-09-21 07:36:45 INFO  Starting execution of 1 what-if analyses...
2022-09-21 07:36:45 INFO  Start plan generation for analysis PermutationFeatureImportance...
2022-09-21 07:36:45 INFO  ---RUNTIME: Plan generation took 0.10704994201660156 ms
2022-09-21 07:36:45 INFO  Estimated runtime of original DAG is 13668.014526367188ms
2022-09-21 07:36:45 WARNING Skipping Multi-Query Optimization (instead, only combine execution DAGs)
2022-09-21 07:36:45 INFO  Estimated unoptimised what-if runtime is 68340.07263183594ms
2022-09-21 07:36:45 INFO  ---RUNTIME: Multi-Query Optimization took 16.282081604003906 ms
2022-09-21 07:36:45 INFO  Executing generated plans
2022-09-21 07:37:59 INFO  ---RUNTIME: Execution took 73777.89545059204 ms
2022-09-21 07:37:59 INFO  Done!
2022-09-21 07:37:59 INFO  # Finished -- repetition 4 of 7 
2022-09-21 07:37:59 INFO  # Optimization benchmark for feature_importance with args [['reviews', 'fast_loading', 'featurization_4', 'xgboost']] -- repetition 5 of 7
2022-09-21 07:37:59 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-21 07:37:59 INFO  Running instrumented original pipeline...
2022-09-21 07:37:59 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-21 07:37:59 INFO  ---RUNTIME: Importing and monkey-patching took 6.699800491333008 ms
2022-09-21 07:38:16 INFO  ---RUNTIME: Original pipeline execution took 17316.96653366089 ms (excluding imports and monkey-patching)
2022-09-21 07:38:16 INFO  Starting execution of 1 what-if analyses...
2022-09-21 07:38:16 INFO  Start plan generation for analysis PermutationFeatureImportance...
2022-09-21 07:38:16 INFO  ---RUNTIME: Plan generation took 0.13756752014160156 ms
2022-09-21 07:38:16 INFO  Estimated runtime of original DAG is 13661.699056625366ms
2022-09-21 07:38:16 INFO  Performing Multi-Query Optimization
2022-09-21 07:38:16 INFO  Estimated unoptimized what-if runtime is 68308.49528312683ms
2022-09-21 07:38:16 INFO  Estimated optimised what-if runtime is 14055.31930923462ms
2022-09-21 07:38:16 INFO  Estimated optimisation runtime saving is 54253.17597389221ms
2022-09-21 07:38:16 INFO  ---RUNTIME: Multi-Query Optimization took 10.944128036499023 ms
2022-09-21 07:38:16 INFO  Executing generated plans
2022-09-21 07:38:31 INFO  ---RUNTIME: Execution took 15077.402591705322 ms
2022-09-21 07:38:31 INFO  Done!
2022-09-21 07:38:31 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-21 07:38:31 INFO  Running instrumented original pipeline...
2022-09-21 07:38:31 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-21 07:38:31 INFO  ---RUNTIME: Importing and monkey-patching took 5.810260772705078 ms
2022-09-21 07:38:48 INFO  ---RUNTIME: Original pipeline execution took 17179.749965667725 ms (excluding imports and monkey-patching)
2022-09-21 07:38:48 INFO  Starting execution of 1 what-if analyses...
2022-09-21 07:38:48 INFO  Start plan generation for analysis PermutationFeatureImportance...
2022-09-21 07:38:48 INFO  ---RUNTIME: Plan generation took 0.09894371032714844 ms
2022-09-21 07:38:48 INFO  Estimated runtime of original DAG is 13553.532123565674ms
2022-09-21 07:38:48 WARNING Skipping Multi-Query Optimization (instead, only combine execution DAGs)
2022-09-21 07:38:49 INFO  Estimated unoptimised what-if runtime is 67767.66061782837ms
2022-09-21 07:38:49 INFO  ---RUNTIME: Multi-Query Optimization took 15.952110290527344 ms
2022-09-21 07:38:49 INFO  Executing generated plans
2022-09-21 07:40:01 INFO  ---RUNTIME: Execution took 72310.1589679718 ms
2022-09-21 07:40:01 INFO  Done!
2022-09-21 07:40:01 INFO  # Finished -- repetition 5 of 7 
2022-09-21 07:40:01 INFO  # Optimization benchmark for feature_importance with args [['reviews', 'fast_loading', 'featurization_4', 'xgboost']] -- repetition 6 of 7
2022-09-21 07:40:01 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-21 07:40:01 INFO  Running instrumented original pipeline...
2022-09-21 07:40:01 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-21 07:40:01 INFO  ---RUNTIME: Importing and monkey-patching took 6.611347198486328 ms
2022-09-21 07:40:17 INFO  ---RUNTIME: Original pipeline execution took 16373.66533279419 ms (excluding imports and monkey-patching)
2022-09-21 07:40:17 INFO  Starting execution of 1 what-if analyses...
2022-09-21 07:40:17 INFO  Start plan generation for analysis PermutationFeatureImportance...
2022-09-21 07:40:17 INFO  ---RUNTIME: Plan generation took 0.12493133544921875 ms
2022-09-21 07:40:17 INFO  Estimated runtime of original DAG is 13008.107900619507ms
2022-09-21 07:40:17 INFO  Performing Multi-Query Optimization
2022-09-21 07:40:17 INFO  Estimated unoptimized what-if runtime is 65040.539503097534ms
2022-09-21 07:40:17 INFO  Estimated optimised what-if runtime is 13439.855098724365ms
2022-09-21 07:40:17 INFO  Estimated optimisation runtime saving is 51600.68440437317ms
2022-09-21 07:40:17 INFO  ---RUNTIME: Multi-Query Optimization took 10.981559753417969 ms
2022-09-21 07:40:17 INFO  Executing generated plans
2022-09-21 07:40:31 INFO  ---RUNTIME: Execution took 14039.091348648071 ms
2022-09-21 07:40:31 INFO  Done!
2022-09-21 07:40:31 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-21 07:40:31 INFO  Running instrumented original pipeline...
2022-09-21 07:40:31 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-21 07:40:31 INFO  ---RUNTIME: Importing and monkey-patching took 5.852222442626953 ms
2022-09-21 07:40:48 INFO  ---RUNTIME: Original pipeline execution took 16707.250118255615 ms (excluding imports and monkey-patching)
2022-09-21 07:40:48 INFO  Starting execution of 1 what-if analyses...
2022-09-21 07:40:48 INFO  Start plan generation for analysis PermutationFeatureImportance...
2022-09-21 07:40:48 INFO  ---RUNTIME: Plan generation took 0.10061264038085938 ms
2022-09-21 07:40:48 INFO  Estimated runtime of original DAG is 12975.341796875ms
2022-09-21 07:40:48 WARNING Skipping Multi-Query Optimization (instead, only combine execution DAGs)
2022-09-21 07:40:48 INFO  Estimated unoptimised what-if runtime is 64876.708984375ms
2022-09-21 07:40:48 INFO  ---RUNTIME: Multi-Query Optimization took 15.724420547485352 ms
2022-09-21 07:40:48 INFO  Executing generated plans
2022-09-21 07:41:59 INFO  ---RUNTIME: Execution took 70860.60547828674 ms
2022-09-21 07:41:59 INFO  Done!
2022-09-21 07:41:59 INFO  # Finished -- repetition 6 of 7 
2022-09-21 07:41:59 INFO  # Optimization benchmark for feature_importance with args [['reviews', 'fast_loading', 'featurization_4', 'xgboost']] -- repetition 7 of 7
2022-09-21 07:41:59 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-21 07:41:59 INFO  Running instrumented original pipeline...
2022-09-21 07:41:59 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-21 07:41:59 INFO  ---RUNTIME: Importing and monkey-patching took 6.7901611328125 ms
2022-09-21 07:42:15 INFO  ---RUNTIME: Original pipeline execution took 16105.618715286255 ms (excluding imports and monkey-patching)
2022-09-21 07:42:15 INFO  Starting execution of 1 what-if analyses...
2022-09-21 07:42:15 INFO  Start plan generation for analysis PermutationFeatureImportance...
2022-09-21 07:42:15 INFO  ---RUNTIME: Plan generation took 0.1239776611328125 ms
2022-09-21 07:42:15 INFO  Estimated runtime of original DAG is 12762.078762054443ms
2022-09-21 07:42:15 INFO  Performing Multi-Query Optimization
2022-09-21 07:42:15 INFO  Estimated unoptimized what-if runtime is 63810.39381027222ms
2022-09-21 07:42:15 INFO  Estimated optimised what-if runtime is 13143.983602523804ms
2022-09-21 07:42:15 INFO  Estimated optimisation runtime saving is 50666.41020774841ms
2022-09-21 07:42:15 INFO  ---RUNTIME: Multi-Query Optimization took 11.067628860473633 ms
2022-09-21 07:42:15 INFO  Executing generated plans
2022-09-21 07:42:29 INFO  ---RUNTIME: Execution took 14093.461513519287 ms
2022-09-21 07:42:29 INFO  Done!
2022-09-21 07:42:29 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-21 07:42:29 INFO  Running instrumented original pipeline...
2022-09-21 07:42:29 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-21 07:42:29 INFO  ---RUNTIME: Importing and monkey-patching took 5.711555480957031 ms
2022-09-21 07:42:46 INFO  ---RUNTIME: Original pipeline execution took 16927.504777908325 ms (excluding imports and monkey-patching)
2022-09-21 07:42:46 INFO  Starting execution of 1 what-if analyses...
2022-09-21 07:42:46 INFO  Start plan generation for analysis PermutationFeatureImportance...
2022-09-21 07:42:46 INFO  ---RUNTIME: Plan generation took 0.1010894775390625 ms
2022-09-21 07:42:46 INFO  Estimated runtime of original DAG is 13288.636207580566ms
2022-09-21 07:42:46 WARNING Skipping Multi-Query Optimization (instead, only combine execution DAGs)
2022-09-21 07:42:46 INFO  Estimated unoptimised what-if runtime is 66443.18103790283ms
2022-09-21 07:42:46 INFO  ---RUNTIME: Multi-Query Optimization took 15.899658203125 ms
2022-09-21 07:42:46 INFO  Executing generated plans
2022-09-21 07:43:59 INFO  ---RUNTIME: Execution took 73053.02453041077 ms
2022-09-21 07:43:59 INFO  Done!
2022-09-21 07:43:59 INFO  # Finished -- repetition 7 of 7 
2022-09-21 07:43:59 INFO  # Final results after all repetitions
2022-09-21 07:43:59 INFO     repetition  ... no_opt_what_if_execution_combined_model_training
0           0  ...                                     20327.486277
1           1  ...                                     26641.182899
2           2  ...                                     17886.625767
3           3  ...                                     20734.588861
4           4  ...                                     19485.483408
5           5  ...                                     18662.357330
6           6  ...                                     19913.303375

[7 rows x 26 columns]
taskset -c 32-40 PROTOCOL_BUFFERS_PYTHON_IMPLEMENTATION=python python3.9 benchmarks_end_to_end.py feature_importance reviews fast_loading featurization_4 neural_network
2022-09-21 07:44:02.019405: W tensorflow/stream_executor/platform/default/dso_loader.cc:64] Could not load dynamic library 'libcudart.so.11.0'; dlerror: libcudart.so.11.0: cannot open shared object file: No such file or directory; LD_LIBRARY_PATH: /home/sgrafbe/mlwhatif/venv/lib/python3.9/site-packages/cv2/../../lib64:
2022-09-21 07:44:02.019449: I tensorflow/stream_executor/cuda/cudart_stub.cc:29] Ignore above cudart dlerror if you do not have a GPU set up on your machine.
2022-09-21 07:44:03 INFO  Patching sys.argv with ['mlwhatif', 'reviews', 'fast_loading', 'featurization_4', 'neural_network']
2022-09-21 07:44:03 INFO  Running instrumented original pipeline...
2022-09-21 07:44:03 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-21 07:44:03 INFO  ---RUNTIME: Importing and monkey-patching took 125.457763671875 ms
2022-09-21 07:44:16.670672: W tensorflow/stream_executor/platform/default/dso_loader.cc:64] Could not load dynamic library 'libcuda.so.1'; dlerror: libcuda.so.1: cannot open shared object file: No such file or directory; LD_LIBRARY_PATH: /home/sgrafbe/mlwhatif/venv/lib/python3.9/site-packages/cv2/../../lib64:
2022-09-21 07:44:16.670709: W tensorflow/stream_executor/cuda/cuda_driver.cc:326] failed call to cuInit: UNKNOWN ERROR (303)
2022-09-21 07:44:16.670732: I tensorflow/stream_executor/cuda/cuda_diagnostics.cc:156] kernel driver does not appear to be running on this host (angus): /proc/driver/nvidia/version does not exist
2022-09-21 07:44:16.671461: I tensorflow/core/platform/cpu_feature_guard.cc:142] This TensorFlow binary is optimized with oneAPI Deep Neural Network Library (oneDNN) to use the following CPU instructions in performance-critical operations:  AVX2 FMA
To enable them in other operations, rebuild TensorFlow with the appropriate compiler flags.
2022-09-21 07:44:16.994116: I tensorflow/compiler/mlir/mlir_graph_optimization_pass.cc:176] None of the MLIR Optimization Passes are enabled (registered 2)
2022-09-21 07:44:17.006234: I tensorflow/core/platform/profile_utils/cpu_utils.cc:114] CPU Frequency: 2595130000 Hz
2022-09-21 07:44:21 INFO  ---RUNTIME: Original pipeline execution took 17775.739908218384 ms (excluding imports and monkey-patching)
2022-09-21 07:44:21 INFO  Starting execution of 0 what-if analyses...
2022-09-21 07:44:21 INFO  Estimated runtime of original DAG is 14219.589710235596ms
2022-09-21 07:44:21 INFO  Performing Multi-Query Optimization
2022-09-21 07:44:21 INFO  Estimated unoptimized what-if runtime is 0ms
2022-09-21 07:44:21 INFO  Estimated optimised what-if runtime is 0ms
2022-09-21 07:44:21 INFO  Estimated optimisation runtime saving is 0ms
2022-09-21 07:44:21 INFO  ---RUNTIME: Multi-Query Optimization took 0.5502700805664062 ms
2022-09-21 07:44:21 INFO  Executing generated plans
2022-09-21 07:44:21 INFO  ---RUNTIME: Execution took 0.0209808349609375 ms
2022-09-21 07:44:21 INFO  Done!
2022-09-21 07:44:21 INFO  # Optimization benchmark for feature_importance with args [['reviews', 'fast_loading', 'featurization_4', 'neural_network']] -- repetition 1 of 7
2022-09-21 07:44:21 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-21 07:44:21 INFO  Running instrumented original pipeline...
2022-09-21 07:44:21 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-21 07:44:21 INFO  ---RUNTIME: Importing and monkey-patching took 5.584716796875 ms
2022-09-21 07:44:38 INFO  ---RUNTIME: Original pipeline execution took 17313.00711631775 ms (excluding imports and monkey-patching)
2022-09-21 07:44:38 INFO  Starting execution of 1 what-if analyses...
2022-09-21 07:44:38 INFO  Start plan generation for analysis PermutationFeatureImportance...
2022-09-21 07:44:38 INFO  ---RUNTIME: Plan generation took 0.24700164794921875 ms
2022-09-21 07:44:38 INFO  Estimated runtime of original DAG is 13495.345830917358ms
2022-09-21 07:44:38 INFO  Performing Multi-Query Optimization
2022-09-21 07:44:38 INFO  Estimated unoptimized what-if runtime is 67476.72915458679ms
2022-09-21 07:44:38 INFO  Estimated optimised what-if runtime is 15451.854705810547ms
2022-09-21 07:44:38 INFO  Estimated optimisation runtime saving is 52024.874448776245ms
2022-09-21 07:44:38 INFO  ---RUNTIME: Multi-Query Optimization took 11.010408401489258 ms
2022-09-21 07:44:38 INFO  Executing generated plans
2022-09-21 07:44:55 INFO  ---RUNTIME: Execution took 16398.276567459106 ms
2022-09-21 07:44:55 INFO  Done!
2022-09-21 07:44:55 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-21 07:44:55 INFO  Running instrumented original pipeline...
2022-09-21 07:44:55 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-21 07:44:55 INFO  ---RUNTIME: Importing and monkey-patching took 6.48808479309082 ms
2022-09-21 07:45:12 INFO  ---RUNTIME: Original pipeline execution took 17176.594257354736 ms (excluding imports and monkey-patching)
2022-09-21 07:45:12 INFO  Starting execution of 1 what-if analyses...
2022-09-21 07:45:12 INFO  Start plan generation for analysis PermutationFeatureImportance...
2022-09-21 07:45:12 INFO  ---RUNTIME: Plan generation took 0.12636184692382812 ms
2022-09-21 07:45:12 INFO  Estimated runtime of original DAG is 13747.806549072266ms
2022-09-21 07:45:12 WARNING Skipping Multi-Query Optimization (instead, only combine execution DAGs)
2022-09-21 07:45:12 INFO  Estimated unoptimised what-if runtime is 68739.03274536133ms
2022-09-21 07:45:12 INFO  ---RUNTIME: Multi-Query Optimization took 16.391992568969727 ms
2022-09-21 07:45:12 INFO  Executing generated plans
2022-09-21 07:46:25 INFO  ---RUNTIME: Execution took 72952.62718200684 ms
2022-09-21 07:46:25 INFO  Done!
2022-09-21 07:46:25 INFO  # Finished -- repetition 1 of 7 
2022-09-21 07:46:25 INFO  # Optimization benchmark for feature_importance with args [['reviews', 'fast_loading', 'featurization_4', 'neural_network']] -- repetition 2 of 7
2022-09-21 07:46:25 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-21 07:46:25 INFO  Running instrumented original pipeline...
2022-09-21 07:46:25 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-21 07:46:25 INFO  ---RUNTIME: Importing and monkey-patching took 6.468057632446289 ms
2022-09-21 07:46:41 INFO  ---RUNTIME: Original pipeline execution took 16331.297397613525 ms (excluding imports and monkey-patching)
2022-09-21 07:46:41 INFO  Starting execution of 1 what-if analyses...
2022-09-21 07:46:41 INFO  Start plan generation for analysis PermutationFeatureImportance...
2022-09-21 07:46:41 INFO  ---RUNTIME: Plan generation took 0.14019012451171875 ms
2022-09-21 07:46:41 INFO  Estimated runtime of original DAG is 13030.972242355347ms
2022-09-21 07:46:41 INFO  Performing Multi-Query Optimization
2022-09-21 07:46:41 INFO  Estimated unoptimized what-if runtime is 65154.86121177673ms
2022-09-21 07:46:41 INFO  Estimated optimised what-if runtime is 16189.32318687439ms
2022-09-21 07:46:41 INFO  Estimated optimisation runtime saving is 48965.538024902344ms
2022-09-21 07:46:41 INFO  ---RUNTIME: Multi-Query Optimization took 12.07733154296875 ms
2022-09-21 07:46:41 INFO  Executing generated plans
2022-09-21 07:46:57 INFO  ---RUNTIME: Execution took 15888.482809066772 ms
2022-09-21 07:46:57 INFO  Done!
2022-09-21 07:46:57 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-21 07:46:57 INFO  Running instrumented original pipeline...
2022-09-21 07:46:57 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-21 07:46:57 INFO  ---RUNTIME: Importing and monkey-patching took 6.626367568969727 ms
2022-09-21 07:47:13 INFO  ---RUNTIME: Original pipeline execution took 16345.674991607666 ms (excluding imports and monkey-patching)
2022-09-21 07:47:13 INFO  Starting execution of 1 what-if analyses...
2022-09-21 07:47:13 INFO  Start plan generation for analysis PermutationFeatureImportance...
2022-09-21 07:47:13 INFO  ---RUNTIME: Plan generation took 0.10156631469726562 ms
2022-09-21 07:47:13 INFO  Estimated runtime of original DAG is 12732.842922210693ms
2022-09-21 07:47:13 WARNING Skipping Multi-Query Optimization (instead, only combine execution DAGs)
2022-09-21 07:47:13 INFO  Estimated unoptimised what-if runtime is 63664.21461105347ms
2022-09-21 07:47:13 INFO  ---RUNTIME: Multi-Query Optimization took 16.475200653076172 ms
2022-09-21 07:47:13 INFO  Executing generated plans
2022-09-21 07:48:24 INFO  ---RUNTIME: Execution took 70325.89793205261 ms
2022-09-21 07:48:24 INFO  Done!
2022-09-21 07:48:24 INFO  # Finished -- repetition 2 of 7 
2022-09-21 07:48:24 INFO  # Optimization benchmark for feature_importance with args [['reviews', 'fast_loading', 'featurization_4', 'neural_network']] -- repetition 3 of 7
2022-09-21 07:48:24 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-21 07:48:24 INFO  Running instrumented original pipeline...
2022-09-21 07:48:24 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-21 07:48:24 INFO  ---RUNTIME: Importing and monkey-patching took 5.951881408691406 ms
2022-09-21 07:48:41 INFO  ---RUNTIME: Original pipeline execution took 17046.895265579224 ms (excluding imports and monkey-patching)
2022-09-21 07:48:41 INFO  Starting execution of 1 what-if analyses...
2022-09-21 07:48:41 INFO  Start plan generation for analysis PermutationFeatureImportance...
2022-09-21 07:48:41 INFO  ---RUNTIME: Plan generation took 0.12636184692382812 ms
2022-09-21 07:48:41 INFO  Estimated runtime of original DAG is 13105.817079544067ms
2022-09-21 07:48:41 INFO  Performing Multi-Query Optimization
2022-09-21 07:48:41 INFO  Estimated unoptimized what-if runtime is 65529.08539772034ms
2022-09-21 07:48:41 INFO  Estimated optimised what-if runtime is 15006.516933441162ms
2022-09-21 07:48:41 INFO  Estimated optimisation runtime saving is 50522.568464279175ms
2022-09-21 07:48:41 INFO  ---RUNTIME: Multi-Query Optimization took 10.859012603759766 ms
2022-09-21 07:48:41 INFO  Executing generated plans
2022-09-21 07:48:56 INFO  ---RUNTIME: Execution took 15417.4222946167 ms
2022-09-21 07:48:56 INFO  Done!
2022-09-21 07:48:56 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-21 07:48:56 INFO  Running instrumented original pipeline...
2022-09-21 07:48:56 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-21 07:48:56 INFO  ---RUNTIME: Importing and monkey-patching took 6.178140640258789 ms
2022-09-21 07:49:13 INFO  ---RUNTIME: Original pipeline execution took 16432.086944580078 ms (excluding imports and monkey-patching)
2022-09-21 07:49:13 INFO  Starting execution of 1 what-if analyses...
2022-09-21 07:49:13 INFO  Start plan generation for analysis PermutationFeatureImportance...
2022-09-21 07:49:13 INFO  ---RUNTIME: Plan generation took 0.09989738464355469 ms
2022-09-21 07:49:13 INFO  Estimated runtime of original DAG is 12791.317701339722ms
2022-09-21 07:49:13 WARNING Skipping Multi-Query Optimization (instead, only combine execution DAGs)
2022-09-21 07:49:13 INFO  Estimated unoptimised what-if runtime is 63956.58850669861ms
2022-09-21 07:49:13 INFO  ---RUNTIME: Multi-Query Optimization took 15.670299530029297 ms
2022-09-21 07:49:13 INFO  Executing generated plans
2022-09-21 07:50:22 INFO  ---RUNTIME: Execution took 69024.17373657227 ms
2022-09-21 07:50:22 INFO  Done!
2022-09-21 07:50:22 INFO  # Finished -- repetition 3 of 7 
2022-09-21 07:50:22 INFO  # Optimization benchmark for feature_importance with args [['reviews', 'fast_loading', 'featurization_4', 'neural_network']] -- repetition 4 of 7
2022-09-21 07:50:22 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-21 07:50:22 INFO  Running instrumented original pipeline...
2022-09-21 07:50:22 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-21 07:50:22 INFO  ---RUNTIME: Importing and monkey-patching took 5.858659744262695 ms
2022-09-21 07:50:38 INFO  ---RUNTIME: Original pipeline execution took 16464.18857574463 ms (excluding imports and monkey-patching)
2022-09-21 07:50:38 INFO  Starting execution of 1 what-if analyses...
2022-09-21 07:50:38 INFO  Start plan generation for analysis PermutationFeatureImportance...
2022-09-21 07:50:38 INFO  ---RUNTIME: Plan generation took 0.1289844512939453 ms
2022-09-21 07:50:38 INFO  Estimated runtime of original DAG is 12744.785785675049ms
2022-09-21 07:50:38 INFO  Performing Multi-Query Optimization
2022-09-21 07:50:38 INFO  Estimated unoptimized what-if runtime is 63723.928928375244ms
2022-09-21 07:50:38 INFO  Estimated optimised what-if runtime is 14677.817106246948ms
2022-09-21 07:50:38 INFO  Estimated optimisation runtime saving is 49046.111822128296ms
2022-09-21 07:50:38 INFO  ---RUNTIME: Multi-Query Optimization took 11.11602783203125 ms
2022-09-21 07:50:38 INFO  Executing generated plans
2022-09-21 07:50:54 INFO  ---RUNTIME: Execution took 15701.934099197388 ms
2022-09-21 07:50:54 INFO  Done!
2022-09-21 07:50:54 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-21 07:50:54 INFO  Running instrumented original pipeline...
2022-09-21 07:50:54 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-21 07:50:54 INFO  ---RUNTIME: Importing and monkey-patching took 6.651878356933594 ms
2022-09-21 07:51:11 INFO  ---RUNTIME: Original pipeline execution took 16636.568546295166 ms (excluding imports and monkey-patching)
2022-09-21 07:51:11 INFO  Starting execution of 1 what-if analyses...
2022-09-21 07:51:11 INFO  Start plan generation for analysis PermutationFeatureImportance...
2022-09-21 07:51:11 INFO  ---RUNTIME: Plan generation took 0.10204315185546875 ms
2022-09-21 07:51:11 INFO  Estimated runtime of original DAG is 13294.87943649292ms
2022-09-21 07:51:11 WARNING Skipping Multi-Query Optimization (instead, only combine execution DAGs)
2022-09-21 07:51:11 INFO  Estimated unoptimised what-if runtime is 66474.3971824646ms
2022-09-21 07:51:11 INFO  ---RUNTIME: Multi-Query Optimization took 16.263961791992188 ms
2022-09-21 07:51:11 INFO  Executing generated plans
2022-09-21 07:52:21 INFO  ---RUNTIME: Execution took 69923.42352867126 ms
2022-09-21 07:52:21 INFO  Done!
2022-09-21 07:52:21 INFO  # Finished -- repetition 4 of 7 
2022-09-21 07:52:21 INFO  # Optimization benchmark for feature_importance with args [['reviews', 'fast_loading', 'featurization_4', 'neural_network']] -- repetition 5 of 7
2022-09-21 07:52:21 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-21 07:52:21 INFO  Running instrumented original pipeline...
2022-09-21 07:52:21 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-21 07:52:21 INFO  ---RUNTIME: Importing and monkey-patching took 6.405353546142578 ms
2022-09-21 07:52:38 INFO  ---RUNTIME: Original pipeline execution took 17160.060167312622 ms (excluding imports and monkey-patching)
2022-09-21 07:52:38 INFO  Starting execution of 1 what-if analyses...
2022-09-21 07:52:38 INFO  Start plan generation for analysis PermutationFeatureImportance...
2022-09-21 07:52:38 INFO  ---RUNTIME: Plan generation took 0.1087188720703125 ms
2022-09-21 07:52:38 INFO  Estimated runtime of original DAG is 13790.744066238403ms
2022-09-21 07:52:38 INFO  Performing Multi-Query Optimization
2022-09-21 07:52:38 INFO  Estimated unoptimized what-if runtime is 68953.72033119202ms
2022-09-21 07:52:38 INFO  Estimated optimised what-if runtime is 15703.28426361084ms
2022-09-21 07:52:38 INFO  Estimated optimisation runtime saving is 53250.43606758118ms
2022-09-21 07:52:38 INFO  ---RUNTIME: Multi-Query Optimization took 13.503551483154297 ms
2022-09-21 07:52:38 INFO  Executing generated plans
2022-09-21 07:52:53 INFO  ---RUNTIME: Execution took 15594.38705444336 ms
2022-09-21 07:52:53 INFO  Done!
2022-09-21 07:52:53 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-21 07:52:53 INFO  Running instrumented original pipeline...
2022-09-21 07:52:53 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-21 07:52:53 INFO  ---RUNTIME: Importing and monkey-patching took 6.165504455566406 ms
2022-09-21 07:53:10 INFO  ---RUNTIME: Original pipeline execution took 16715.126991271973 ms (excluding imports and monkey-patching)
2022-09-21 07:53:10 INFO  Starting execution of 1 what-if analyses...
2022-09-21 07:53:10 INFO  Start plan generation for analysis PermutationFeatureImportance...
2022-09-21 07:53:10 INFO  ---RUNTIME: Plan generation took 0.15234947204589844 ms
2022-09-21 07:53:10 INFO  Estimated runtime of original DAG is 13349.988460540771ms
2022-09-21 07:53:10 WARNING Skipping Multi-Query Optimization (instead, only combine execution DAGs)
2022-09-21 07:53:10 INFO  Estimated unoptimised what-if runtime is 66749.94230270386ms
2022-09-21 07:53:10 INFO  ---RUNTIME: Multi-Query Optimization took 16.87455177307129 ms
2022-09-21 07:53:10 INFO  Executing generated plans
2022-09-21 07:54:18 INFO  ---RUNTIME: Execution took 67924.4556427002 ms
2022-09-21 07:54:18 INFO  Done!
2022-09-21 07:54:18 INFO  # Finished -- repetition 5 of 7 
2022-09-21 07:54:18 INFO  # Optimization benchmark for feature_importance with args [['reviews', 'fast_loading', 'featurization_4', 'neural_network']] -- repetition 6 of 7
2022-09-21 07:54:18 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-21 07:54:18 INFO  Running instrumented original pipeline...
2022-09-21 07:54:18 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-21 07:54:18 INFO  ---RUNTIME: Importing and monkey-patching took 5.8307647705078125 ms
2022-09-21 07:54:35 INFO  ---RUNTIME: Original pipeline execution took 16522.1905708313 ms (excluding imports and monkey-patching)
2022-09-21 07:54:35 INFO  Starting execution of 1 what-if analyses...
2022-09-21 07:54:35 INFO  Start plan generation for analysis PermutationFeatureImportance...
2022-09-21 07:54:35 INFO  ---RUNTIME: Plan generation took 0.1327991485595703 ms
2022-09-21 07:54:35 INFO  Estimated runtime of original DAG is 13166.306495666504ms
2022-09-21 07:54:35 INFO  Performing Multi-Query Optimization
2022-09-21 07:54:35 INFO  Estimated unoptimized what-if runtime is 65831.53247833252ms
2022-09-21 07:54:35 INFO  Estimated optimised what-if runtime is 15171.65493965149ms
2022-09-21 07:54:35 INFO  Estimated optimisation runtime saving is 50659.87753868103ms
2022-09-21 07:54:35 INFO  ---RUNTIME: Multi-Query Optimization took 11.13581657409668 ms
2022-09-21 07:54:35 INFO  Executing generated plans
2022-09-21 07:54:50 INFO  ---RUNTIME: Execution took 15621.016263961792 ms
2022-09-21 07:54:50 INFO  Done!
2022-09-21 07:54:50 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-21 07:54:50 INFO  Running instrumented original pipeline...
2022-09-21 07:54:51 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-21 07:54:51 INFO  ---RUNTIME: Importing and monkey-patching took 6.100654602050781 ms
2022-09-21 07:55:06 INFO  ---RUNTIME: Original pipeline execution took 16286.89956665039 ms (excluding imports and monkey-patching)
2022-09-21 07:55:06 INFO  Starting execution of 1 what-if analyses...
2022-09-21 07:55:06 INFO  Start plan generation for analysis PermutationFeatureImportance...
2022-09-21 07:55:06 INFO  ---RUNTIME: Plan generation took 0.1010894775390625 ms
2022-09-21 07:55:06 INFO  Estimated runtime of original DAG is 12544.377565383911ms
2022-09-21 07:55:06 WARNING Skipping Multi-Query Optimization (instead, only combine execution DAGs)
2022-09-21 07:55:06 INFO  Estimated unoptimised what-if runtime is 62721.887826919556ms
2022-09-21 07:55:06 INFO  ---RUNTIME: Multi-Query Optimization took 16.280651092529297 ms
2022-09-21 07:55:06 INFO  Executing generated plans
2022-09-21 07:56:15 INFO  ---RUNTIME: Execution took 68103.77669334412 ms
2022-09-21 07:56:15 INFO  Done!
2022-09-21 07:56:15 INFO  # Finished -- repetition 6 of 7 
2022-09-21 07:56:15 INFO  # Optimization benchmark for feature_importance with args [['reviews', 'fast_loading', 'featurization_4', 'neural_network']] -- repetition 7 of 7
2022-09-21 07:56:15 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-21 07:56:15 INFO  Running instrumented original pipeline...
2022-09-21 07:56:15 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-21 07:56:15 INFO  ---RUNTIME: Importing and monkey-patching took 5.960941314697266 ms
2022-09-21 07:56:31 INFO  ---RUNTIME: Original pipeline execution took 16455.3964138031 ms (excluding imports and monkey-patching)
2022-09-21 07:56:31 INFO  Starting execution of 1 what-if analyses...
2022-09-21 07:56:31 INFO  Start plan generation for analysis PermutationFeatureImportance...
2022-09-21 07:56:31 INFO  ---RUNTIME: Plan generation took 0.10418891906738281 ms
2022-09-21 07:56:31 INFO  Estimated runtime of original DAG is 12633.506536483765ms
2022-09-21 07:56:31 INFO  Performing Multi-Query Optimization
2022-09-21 07:56:31 INFO  Estimated unoptimized what-if runtime is 63167.53268241882ms
2022-09-21 07:56:31 INFO  Estimated optimised what-if runtime is 14505.52773475647ms
2022-09-21 07:56:31 INFO  Estimated optimisation runtime saving is 48662.00494766235ms
2022-09-21 07:56:31 INFO  ---RUNTIME: Multi-Query Optimization took 12.26186752319336 ms
2022-09-21 07:56:31 INFO  Executing generated plans
2022-09-21 07:56:46 INFO  ---RUNTIME: Execution took 15321.486711502075 ms
2022-09-21 07:56:46 INFO  Done!
2022-09-21 07:56:46 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-21 07:56:46 INFO  Running instrumented original pipeline...
2022-09-21 07:56:46 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-21 07:56:46 INFO  ---RUNTIME: Importing and monkey-patching took 5.779504776000977 ms
2022-09-21 07:57:02 INFO  ---RUNTIME: Original pipeline execution took 15960.541248321533 ms (excluding imports and monkey-patching)
2022-09-21 07:57:02 INFO  Starting execution of 1 what-if analyses...
2022-09-21 07:57:02 INFO  Start plan generation for analysis PermutationFeatureImportance...
2022-09-21 07:57:02 INFO  ---RUNTIME: Plan generation took 0.0972747802734375 ms
2022-09-21 07:57:02 INFO  Estimated runtime of original DAG is 12636.309146881104ms
2022-09-21 07:57:02 WARNING Skipping Multi-Query Optimization (instead, only combine execution DAGs)
2022-09-21 07:57:02 INFO  Estimated unoptimised what-if runtime is 63181.54573440552ms
2022-09-21 07:57:02 INFO  ---RUNTIME: Multi-Query Optimization took 16.863584518432617 ms
2022-09-21 07:57:02 INFO  Executing generated plans
2022-09-21 07:58:12 INFO  ---RUNTIME: Execution took 69724.1461277008 ms
2022-09-21 07:58:12 INFO  Done!
2022-09-21 07:58:12 INFO  # Finished -- repetition 7 of 7 
2022-09-21 07:58:12 INFO  # Final results after all repetitions
2022-09-21 07:58:12 INFO     repetition  ... no_opt_what_if_execution_combined_model_training
0           0  ...                                     19152.242422
1           1  ...                                     17279.943228
2           2  ...                                     16320.552826
3           3  ...                                     17628.650904
4           4  ...                                     17137.377977
5           5  ...                                     16319.065094
6           6  ...                                     17288.956404

[7 rows x 26 columns]
taskset -c 32-40 PROTOCOL_BUFFERS_PYTHON_IMPLEMENTATION=python python3.9 benchmarks_end_to_end.py data_cleaning reviews fast_loading featurization_0 logistic_regression
2022-09-21 07:58:15.311118: W tensorflow/stream_executor/platform/default/dso_loader.cc:64] Could not load dynamic library 'libcudart.so.11.0'; dlerror: libcudart.so.11.0: cannot open shared object file: No such file or directory; LD_LIBRARY_PATH: /home/sgrafbe/mlwhatif/venv/lib/python3.9/site-packages/cv2/../../lib64:
2022-09-21 07:58:15.311159: I tensorflow/stream_executor/cuda/cudart_stub.cc:29] Ignore above cudart dlerror if you do not have a GPU set up on your machine.
2022-09-21 07:58:16 INFO  Patching sys.argv with ['mlwhatif', 'reviews', 'fast_loading', 'featurization_0', 'logistic_regression']
2022-09-21 07:58:16 INFO  Running instrumented original pipeline...
2022-09-21 07:58:16 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-21 07:58:16 INFO  ---RUNTIME: Importing and monkey-patching took 122.73311614990234 ms
2022-09-21 07:58:23 INFO  ---RUNTIME: Original pipeline execution took 7051.015377044678 ms (excluding imports and monkey-patching)
2022-09-21 07:58:23 INFO  Starting execution of 0 what-if analyses...
2022-09-21 07:58:23 INFO  Estimated runtime of original DAG is 5256.409406661987ms
2022-09-21 07:58:23 INFO  Performing Multi-Query Optimization
2022-09-21 07:58:23 INFO  Estimated unoptimized what-if runtime is 0ms
2022-09-21 07:58:23 INFO  Estimated optimised what-if runtime is 0ms
2022-09-21 07:58:23 INFO  Estimated optimisation runtime saving is 0ms
2022-09-21 07:58:23 INFO  ---RUNTIME: Multi-Query Optimization took 0.7376670837402344 ms
2022-09-21 07:58:23 INFO  Executing generated plans
2022-09-21 07:58:23 INFO  ---RUNTIME: Execution took 0.03457069396972656 ms
2022-09-21 07:58:23 INFO  Done!
2022-09-21 07:58:23 INFO  # Optimization benchmark for data_cleaning with args [['reviews', 'fast_loading', 'featurization_0', 'logistic_regression']] -- repetition 1 of 7
2022-09-21 07:58:23 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-21 07:58:23 INFO  Running instrumented original pipeline...
2022-09-21 07:58:24 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-21 07:58:24 INFO  ---RUNTIME: Importing and monkey-patching took 6.150007247924805 ms
2022-09-21 07:58:30 INFO  ---RUNTIME: Original pipeline execution took 6649.71137046814 ms (excluding imports and monkey-patching)
2022-09-21 07:58:30 INFO  Starting execution of 1 what-if analyses...
2022-09-21 07:58:30 INFO  Start plan generation for analysis DataCleaning...
2022-09-21 07:58:30 INFO  ---RUNTIME: Plan generation took 0.5478858947753906 ms
2022-09-21 07:58:30 INFO  Estimated runtime of original DAG is 4834.009170532227ms
2022-09-21 07:58:30 INFO  Performing Multi-Query Optimization
2022-09-21 07:58:30 INFO  Estimated unoptimized what-if runtime is 96680.18341064453ms
2022-09-21 07:58:30 INFO  Estimated optimised what-if runtime is 18228.928327560425ms
2022-09-21 07:58:30 INFO  Estimated optimisation runtime saving is 78451.2550830841ms
2022-09-21 07:58:30 INFO  ---RUNTIME: Multi-Query Optimization took 87.06498146057129 ms
2022-09-21 07:58:30 INFO  Executing generated plans
2022-09-21 07:58:56 INFO  ---RUNTIME: Execution took 25647.164344787598 ms
2022-09-21 07:58:56 INFO  Done!
2022-09-21 07:58:56 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-21 07:58:56 INFO  Running instrumented original pipeline...
2022-09-21 07:58:56 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-21 07:58:56 INFO  ---RUNTIME: Importing and monkey-patching took 6.183385848999023 ms
2022-09-21 07:59:02 INFO  ---RUNTIME: Original pipeline execution took 6483.026742935181 ms (excluding imports and monkey-patching)
2022-09-21 07:59:02 INFO  Starting execution of 1 what-if analyses...
2022-09-21 07:59:02 INFO  Start plan generation for analysis DataCleaning...
2022-09-21 07:59:02 INFO  ---RUNTIME: Plan generation took 0.5753040313720703 ms
2022-09-21 07:59:02 INFO  Estimated runtime of original DAG is 4803.7073612213135ms
2022-09-21 07:59:02 WARNING Skipping Multi-Query Optimization (instead, only combine execution DAGs)
2022-09-21 07:59:02 WARNING Columns ['review_id'] not present in train DAG after the train test split, only before!
2022-09-21 07:59:02 WARNING This could hint at data leakage!
2022-09-21 07:59:02 INFO  Estimated unoptimised what-if runtime is 96074.14722442627ms
2022-09-21 07:59:02 INFO  ---RUNTIME: Multi-Query Optimization took 98.14906120300293 ms
2022-09-21 07:59:02 INFO  Executing generated plans
2022-09-21 08:01:03 INFO  ---RUNTIME: Execution took 120276.70097351074 ms
2022-09-21 08:01:03 INFO  Done!
2022-09-21 08:01:03 INFO  # Finished -- repetition 1 of 7 
2022-09-21 08:01:03 INFO  # Optimization benchmark for data_cleaning with args [['reviews', 'fast_loading', 'featurization_0', 'logistic_regression']] -- repetition 2 of 7
2022-09-21 08:01:03 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-21 08:01:03 INFO  Running instrumented original pipeline...
2022-09-21 08:01:03 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-21 08:01:03 INFO  ---RUNTIME: Importing and monkey-patching took 6.28972053527832 ms
2022-09-21 08:01:09 INFO  ---RUNTIME: Original pipeline execution took 6446.491003036499 ms (excluding imports and monkey-patching)
2022-09-21 08:01:09 INFO  Starting execution of 1 what-if analyses...
2022-09-21 08:01:09 INFO  Start plan generation for analysis DataCleaning...
2022-09-21 08:01:09 INFO  ---RUNTIME: Plan generation took 0.5481243133544922 ms
2022-09-21 08:01:09 INFO  Estimated runtime of original DAG is 4794.553279876709ms
2022-09-21 08:01:09 INFO  Performing Multi-Query Optimization
2022-09-21 08:01:09 INFO  Estimated unoptimized what-if runtime is 95891.06559753418ms
2022-09-21 08:01:09 INFO  Estimated optimised what-if runtime is 18067.30365753174ms
2022-09-21 08:01:09 INFO  Estimated optimisation runtime saving is 77823.76194000244ms
2022-09-21 08:01:09 INFO  ---RUNTIME: Multi-Query Optimization took 86.44700050354004 ms
2022-09-21 08:01:09 INFO  Executing generated plans
2022-09-21 08:01:34 INFO  ---RUNTIME: Execution took 25326.76100730896 ms
2022-09-21 08:01:34 INFO  Done!
2022-09-21 08:01:34 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-21 08:01:34 INFO  Running instrumented original pipeline...
2022-09-21 08:01:35 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-21 08:01:35 INFO  ---RUNTIME: Importing and monkey-patching took 5.94782829284668 ms
2022-09-21 08:01:41 INFO  ---RUNTIME: Original pipeline execution took 6445.583343505859 ms (excluding imports and monkey-patching)
2022-09-21 08:01:41 INFO  Starting execution of 1 what-if analyses...
2022-09-21 08:01:41 INFO  Start plan generation for analysis DataCleaning...
2022-09-21 08:01:41 INFO  ---RUNTIME: Plan generation took 0.5004405975341797 ms
2022-09-21 08:01:41 INFO  Estimated runtime of original DAG is 4799.443244934082ms
2022-09-21 08:01:41 WARNING Skipping Multi-Query Optimization (instead, only combine execution DAGs)
2022-09-21 08:01:41 WARNING Columns ['review_id'] not present in train DAG after the train test split, only before!
2022-09-21 08:01:41 WARNING This could hint at data leakage!
2022-09-21 08:01:41 INFO  Estimated unoptimised what-if runtime is 95988.86489868164ms
2022-09-21 08:01:41 INFO  ---RUNTIME: Multi-Query Optimization took 97.65052795410156 ms
2022-09-21 08:01:41 INFO  Executing generated plans
2022-09-21 08:03:41 INFO  ---RUNTIME: Execution took 120441.86639785767 ms
2022-09-21 08:03:41 INFO  Done!
2022-09-21 08:03:41 INFO  # Finished -- repetition 2 of 7 
2022-09-21 08:03:41 INFO  # Optimization benchmark for data_cleaning with args [['reviews', 'fast_loading', 'featurization_0', 'logistic_regression']] -- repetition 3 of 7
2022-09-21 08:03:41 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-21 08:03:41 INFO  Running instrumented original pipeline...
2022-09-21 08:03:42 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-21 08:03:42 INFO  ---RUNTIME: Importing and monkey-patching took 6.177663803100586 ms
2022-09-21 08:03:48 INFO  ---RUNTIME: Original pipeline execution took 6497.5597858428955 ms (excluding imports and monkey-patching)
2022-09-21 08:03:48 INFO  Starting execution of 1 what-if analyses...
2022-09-21 08:03:48 INFO  Start plan generation for analysis DataCleaning...
2022-09-21 08:03:48 INFO  ---RUNTIME: Plan generation took 0.5412101745605469 ms
2022-09-21 08:03:48 INFO  Estimated runtime of original DAG is 4833.599328994751ms
2022-09-21 08:03:48 INFO  Performing Multi-Query Optimization
2022-09-21 08:03:48 INFO  Estimated unoptimized what-if runtime is 96671.98657989502ms
2022-09-21 08:03:48 INFO  Estimated optimised what-if runtime is 18095.197916030884ms
2022-09-21 08:03:48 INFO  Estimated optimisation runtime saving is 78576.78866386414ms
2022-09-21 08:03:48 INFO  ---RUNTIME: Multi-Query Optimization took 86.49420738220215 ms
2022-09-21 08:03:48 INFO  Executing generated plans
2022-09-21 08:04:14 INFO  ---RUNTIME: Execution took 25455.052375793457 ms
2022-09-21 08:04:14 INFO  Done!
2022-09-21 08:04:14 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-21 08:04:14 INFO  Running instrumented original pipeline...
2022-09-21 08:04:14 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-21 08:04:14 INFO  ---RUNTIME: Importing and monkey-patching took 6.151437759399414 ms
2022-09-21 08:04:20 INFO  ---RUNTIME: Original pipeline execution took 6479.491233825684 ms (excluding imports and monkey-patching)
2022-09-21 08:04:20 INFO  Starting execution of 1 what-if analyses...
2022-09-21 08:04:20 INFO  Start plan generation for analysis DataCleaning...
2022-09-21 08:04:20 INFO  ---RUNTIME: Plan generation took 0.5180835723876953 ms
2022-09-21 08:04:20 INFO  Estimated runtime of original DAG is 4826.377630233765ms
2022-09-21 08:04:20 WARNING Skipping Multi-Query Optimization (instead, only combine execution DAGs)
2022-09-21 08:04:20 WARNING Columns ['review_id'] not present in train DAG after the train test split, only before!
2022-09-21 08:04:20 WARNING This could hint at data leakage!
2022-09-21 08:04:20 INFO  Estimated unoptimised what-if runtime is 96527.5526046753ms
2022-09-21 08:04:20 INFO  ---RUNTIME: Multi-Query Optimization took 100.10409355163574 ms
2022-09-21 08:04:20 INFO  Executing generated plans
2022-09-21 08:06:20 INFO  ---RUNTIME: Execution took 119912.35780715942 ms
2022-09-21 08:06:20 INFO  Done!
2022-09-21 08:06:20 INFO  # Finished -- repetition 3 of 7 
2022-09-21 08:06:20 INFO  # Optimization benchmark for data_cleaning with args [['reviews', 'fast_loading', 'featurization_0', 'logistic_regression']] -- repetition 4 of 7
2022-09-21 08:06:20 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-21 08:06:20 INFO  Running instrumented original pipeline...
2022-09-21 08:06:20 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-21 08:06:20 INFO  ---RUNTIME: Importing and monkey-patching took 6.426095962524414 ms
2022-09-21 08:06:27 INFO  ---RUNTIME: Original pipeline execution took 6653.772354125977 ms (excluding imports and monkey-patching)
2022-09-21 08:06:27 INFO  Starting execution of 1 what-if analyses...
2022-09-21 08:06:27 INFO  Start plan generation for analysis DataCleaning...
2022-09-21 08:06:27 INFO  ---RUNTIME: Plan generation took 0.5316734313964844 ms
2022-09-21 08:06:27 INFO  Estimated runtime of original DAG is 4990.653038024902ms
2022-09-21 08:06:27 INFO  Performing Multi-Query Optimization
2022-09-21 08:06:27 INFO  Estimated unoptimized what-if runtime is 99813.06076049805ms
2022-09-21 08:06:27 INFO  Estimated optimised what-if runtime is 19371.67763710022ms
2022-09-21 08:06:27 INFO  Estimated optimisation runtime saving is 80441.38312339783ms
2022-09-21 08:06:27 INFO  ---RUNTIME: Multi-Query Optimization took 86.04168891906738 ms
2022-09-21 08:06:27 INFO  Executing generated plans
2022-09-21 08:06:52 INFO  ---RUNTIME: Execution took 25499.318838119507 ms
2022-09-21 08:06:52 INFO  Done!
2022-09-21 08:06:52 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-21 08:06:52 INFO  Running instrumented original pipeline...
2022-09-21 08:06:52 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-21 08:06:52 INFO  ---RUNTIME: Importing and monkey-patching took 6.326198577880859 ms
2022-09-21 08:06:59 INFO  ---RUNTIME: Original pipeline execution took 6481.137752532959 ms (excluding imports and monkey-patching)
2022-09-21 08:06:59 INFO  Starting execution of 1 what-if analyses...
2022-09-21 08:06:59 INFO  Start plan generation for analysis DataCleaning...
2022-09-21 08:06:59 INFO  ---RUNTIME: Plan generation took 0.5657672882080078 ms
2022-09-21 08:06:59 INFO  Estimated runtime of original DAG is 4812.628746032715ms
2022-09-21 08:06:59 WARNING Skipping Multi-Query Optimization (instead, only combine execution DAGs)
2022-09-21 08:06:59 WARNING Columns ['review_id'] not present in train DAG after the train test split, only before!
2022-09-21 08:06:59 WARNING This could hint at data leakage!
2022-09-21 08:06:59 INFO  Estimated unoptimised what-if runtime is 96252.5749206543ms
2022-09-21 08:06:59 INFO  ---RUNTIME: Multi-Query Optimization took 99.03478622436523 ms
2022-09-21 08:06:59 INFO  Executing generated plans
2022-09-21 08:08:59 INFO  ---RUNTIME: Execution took 120489.72773551941 ms
2022-09-21 08:08:59 INFO  Done!
2022-09-21 08:08:59 INFO  # Finished -- repetition 4 of 7 
2022-09-21 08:08:59 INFO  # Optimization benchmark for data_cleaning with args [['reviews', 'fast_loading', 'featurization_0', 'logistic_regression']] -- repetition 5 of 7
2022-09-21 08:08:59 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-21 08:08:59 INFO  Running instrumented original pipeline...
2022-09-21 08:08:59 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-21 08:08:59 INFO  ---RUNTIME: Importing and monkey-patching took 6.204843521118164 ms
2022-09-21 08:09:06 INFO  ---RUNTIME: Original pipeline execution took 6596.5142250061035 ms (excluding imports and monkey-patching)
2022-09-21 08:09:06 INFO  Starting execution of 1 what-if analyses...
2022-09-21 08:09:06 INFO  Start plan generation for analysis DataCleaning...
2022-09-21 08:09:06 INFO  ---RUNTIME: Plan generation took 0.5621910095214844 ms
2022-09-21 08:09:06 INFO  Estimated runtime of original DAG is 4894.325017929077ms
2022-09-21 08:09:06 INFO  Performing Multi-Query Optimization
2022-09-21 08:09:06 INFO  Estimated unoptimized what-if runtime is 97886.50035858154ms
2022-09-21 08:09:06 INFO  Estimated optimised what-if runtime is 18400.304317474365ms
2022-09-21 08:09:06 INFO  Estimated optimisation runtime saving is 79486.19604110718ms
2022-09-21 08:09:06 INFO  ---RUNTIME: Multi-Query Optimization took 86.5330696105957 ms
2022-09-21 08:09:06 INFO  Executing generated plans
2022-09-21 08:09:32 INFO  ---RUNTIME: Execution took 25709.86533164978 ms
2022-09-21 08:09:32 INFO  Done!
2022-09-21 08:09:32 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-21 08:09:32 INFO  Running instrumented original pipeline...
2022-09-21 08:09:32 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-21 08:09:32 INFO  ---RUNTIME: Importing and monkey-patching took 6.35981559753418 ms
2022-09-21 08:09:38 INFO  ---RUNTIME: Original pipeline execution took 6568.631410598755 ms (excluding imports and monkey-patching)
2022-09-21 08:09:38 INFO  Starting execution of 1 what-if analyses...
2022-09-21 08:09:38 INFO  Start plan generation for analysis DataCleaning...
2022-09-21 08:09:38 INFO  ---RUNTIME: Plan generation took 0.5269050598144531 ms
2022-09-21 08:09:38 INFO  Estimated runtime of original DAG is 4836.91668510437ms
2022-09-21 08:09:38 WARNING Skipping Multi-Query Optimization (instead, only combine execution DAGs)
2022-09-21 08:09:38 WARNING Columns ['review_id'] not present in train DAG after the train test split, only before!
2022-09-21 08:09:38 WARNING This could hint at data leakage!
2022-09-21 08:09:38 INFO  Estimated unoptimised what-if runtime is 96738.3337020874ms
2022-09-21 08:09:38 INFO  ---RUNTIME: Multi-Query Optimization took 100.05450248718262 ms
2022-09-21 08:09:38 INFO  Executing generated plans
2022-09-21 08:11:46 INFO  ---RUNTIME: Execution took 127153.96308898926 ms
2022-09-21 08:11:46 INFO  Done!
2022-09-21 08:11:46 INFO  # Finished -- repetition 5 of 7 
2022-09-21 08:11:46 INFO  # Optimization benchmark for data_cleaning with args [['reviews', 'fast_loading', 'featurization_0', 'logistic_regression']] -- repetition 6 of 7
2022-09-21 08:11:46 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-21 08:11:46 INFO  Running instrumented original pipeline...
2022-09-21 08:11:46 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-21 08:11:46 INFO  ---RUNTIME: Importing and monkey-patching took 6.411075592041016 ms
2022-09-21 08:11:52 INFO  ---RUNTIME: Original pipeline execution took 6577.163457870483 ms (excluding imports and monkey-patching)
2022-09-21 08:11:52 INFO  Starting execution of 1 what-if analyses...
2022-09-21 08:11:52 INFO  Start plan generation for analysis DataCleaning...
2022-09-21 08:11:52 INFO  ---RUNTIME: Plan generation took 0.5357265472412109 ms
2022-09-21 08:11:52 INFO  Estimated runtime of original DAG is 4876.827239990234ms
2022-09-21 08:11:52 INFO  Performing Multi-Query Optimization
2022-09-21 08:11:52 INFO  Estimated unoptimized what-if runtime is 97536.54479980469ms
2022-09-21 08:11:52 INFO  Estimated optimised what-if runtime is 18203.863620758057ms
2022-09-21 08:11:52 INFO  Estimated optimisation runtime saving is 79332.68117904663ms
2022-09-21 08:11:52 INFO  ---RUNTIME: Multi-Query Optimization took 88.00196647644043 ms
2022-09-21 08:11:52 INFO  Executing generated plans
2022-09-21 08:12:19 INFO  ---RUNTIME: Execution took 27064.675092697144 ms
2022-09-21 08:12:19 INFO  Done!
2022-09-21 08:12:19 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-21 08:12:19 INFO  Running instrumented original pipeline...
2022-09-21 08:12:19 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-21 08:12:19 INFO  ---RUNTIME: Importing and monkey-patching took 6.234169006347656 ms
2022-09-21 08:12:26 INFO  ---RUNTIME: Original pipeline execution took 6463.8965129852295 ms (excluding imports and monkey-patching)
2022-09-21 08:12:26 INFO  Starting execution of 1 what-if analyses...
2022-09-21 08:12:26 INFO  Start plan generation for analysis DataCleaning...
2022-09-21 08:12:26 INFO  ---RUNTIME: Plan generation took 0.6358623504638672 ms
2022-09-21 08:12:26 INFO  Estimated runtime of original DAG is 4786.315202713013ms
2022-09-21 08:12:26 WARNING Skipping Multi-Query Optimization (instead, only combine execution DAGs)
2022-09-21 08:12:26 WARNING Columns ['review_id'] not present in train DAG after the train test split, only before!
2022-09-21 08:12:26 WARNING This could hint at data leakage!
2022-09-21 08:12:26 INFO  Estimated unoptimised what-if runtime is 95726.30405426025ms
2022-09-21 08:12:26 INFO  ---RUNTIME: Multi-Query Optimization took 135.0414752960205 ms
2022-09-21 08:12:26 INFO  Executing generated plans
2022-09-21 08:14:33 INFO  ---RUNTIME: Execution took 126960.9363079071 ms
2022-09-21 08:14:33 INFO  Done!
2022-09-21 08:14:33 INFO  # Finished -- repetition 6 of 7 
2022-09-21 08:14:33 INFO  # Optimization benchmark for data_cleaning with args [['reviews', 'fast_loading', 'featurization_0', 'logistic_regression']] -- repetition 7 of 7
2022-09-21 08:14:33 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-21 08:14:33 INFO  Running instrumented original pipeline...
2022-09-21 08:14:33 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-21 08:14:33 INFO  ---RUNTIME: Importing and monkey-patching took 6.4983367919921875 ms
2022-09-21 08:14:39 INFO  ---RUNTIME: Original pipeline execution took 6499.214649200439 ms (excluding imports and monkey-patching)
2022-09-21 08:14:39 INFO  Starting execution of 1 what-if analyses...
2022-09-21 08:14:39 INFO  Start plan generation for analysis DataCleaning...
2022-09-21 08:14:39 INFO  ---RUNTIME: Plan generation took 0.5855560302734375 ms
2022-09-21 08:14:39 INFO  Estimated runtime of original DAG is 4814.452171325684ms
2022-09-21 08:14:39 INFO  Performing Multi-Query Optimization
2022-09-21 08:14:40 INFO  Estimated unoptimized what-if runtime is 96289.04342651367ms
2022-09-21 08:14:40 INFO  Estimated optimised what-if runtime is 18104.7945022583ms
2022-09-21 08:14:40 INFO  Estimated optimisation runtime saving is 78184.24892425537ms
2022-09-21 08:14:40 INFO  ---RUNTIME: Multi-Query Optimization took 371.1285591125488 ms
2022-09-21 08:14:40 INFO  Executing generated plans
2022-09-21 08:15:05 INFO  ---RUNTIME: Execution took 25459.884881973267 ms
2022-09-21 08:15:05 INFO  Done!
2022-09-21 08:15:05 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-21 08:15:05 INFO  Running instrumented original pipeline...
2022-09-21 08:15:05 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-21 08:15:05 INFO  ---RUNTIME: Importing and monkey-patching took 5.835056304931641 ms
2022-09-21 08:15:12 INFO  ---RUNTIME: Original pipeline execution took 6592.772006988525 ms (excluding imports and monkey-patching)
2022-09-21 08:15:12 INFO  Starting execution of 1 what-if analyses...
2022-09-21 08:15:12 INFO  Start plan generation for analysis DataCleaning...
2022-09-21 08:15:12 INFO  ---RUNTIME: Plan generation took 0.5004405975341797 ms
2022-09-21 08:15:12 INFO  Estimated runtime of original DAG is 4887.426853179932ms
2022-09-21 08:15:12 WARNING Skipping Multi-Query Optimization (instead, only combine execution DAGs)
2022-09-21 08:15:12 WARNING Columns ['review_id'] not present in train DAG after the train test split, only before!
2022-09-21 08:15:12 WARNING This could hint at data leakage!
2022-09-21 08:15:12 INFO  Estimated unoptimised what-if runtime is 97748.53706359863ms
2022-09-21 08:15:12 INFO  ---RUNTIME: Multi-Query Optimization took 99.5321273803711 ms
2022-09-21 08:15:12 INFO  Executing generated plans
2022-09-21 08:17:20 INFO  ---RUNTIME: Execution took 128493.21961402893 ms
2022-09-21 08:17:20 INFO  Done!
2022-09-21 08:17:21 INFO  # Finished -- repetition 7 of 7 
2022-09-21 08:17:21 INFO  # Final results after all repetitions
2022-09-21 08:17:21 INFO     repetition  ... no_opt_what_if_execution_combined_model_training
0           0  ...                                      3211.625814
1           1  ...                                      3112.558842
2           2  ...                                      3153.600216
3           3  ...                                      3131.345272
4           4  ...                                      3202.380419
5           5  ...                                      3101.677895
6           6  ...                                      4122.464180

[7 rows x 26 columns]
taskset -c 32-40 PROTOCOL_BUFFERS_PYTHON_IMPLEMENTATION=python python3.9 benchmarks_end_to_end.py data_cleaning reviews fast_loading featurization_0 xgboost
2022-09-21 08:17:24.373404: W tensorflow/stream_executor/platform/default/dso_loader.cc:64] Could not load dynamic library 'libcudart.so.11.0'; dlerror: libcudart.so.11.0: cannot open shared object file: No such file or directory; LD_LIBRARY_PATH: /home/sgrafbe/mlwhatif/venv/lib/python3.9/site-packages/cv2/../../lib64:
2022-09-21 08:17:24.373449: I tensorflow/stream_executor/cuda/cudart_stub.cc:29] Ignore above cudart dlerror if you do not have a GPU set up on your machine.
2022-09-21 08:17:26 INFO  Patching sys.argv with ['mlwhatif', 'reviews', 'fast_loading', 'featurization_0', 'xgboost']
2022-09-21 08:17:26 INFO  Running instrumented original pipeline...
2022-09-21 08:17:26 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-21 08:17:26 INFO  ---RUNTIME: Importing and monkey-patching took 165.54665565490723 ms
2022-09-21 08:17:35 INFO  ---RUNTIME: Original pipeline execution took 9021.324634552002 ms (excluding imports and monkey-patching)
2022-09-21 08:17:35 INFO  Starting execution of 0 what-if analyses...
2022-09-21 08:17:35 INFO  Estimated runtime of original DAG is 6764.446020126343ms
2022-09-21 08:17:35 INFO  Performing Multi-Query Optimization
2022-09-21 08:17:35 INFO  Estimated unoptimized what-if runtime is 0ms
2022-09-21 08:17:35 INFO  Estimated optimised what-if runtime is 0ms
2022-09-21 08:17:35 INFO  Estimated optimisation runtime saving is 0ms
2022-09-21 08:17:35 INFO  ---RUNTIME: Multi-Query Optimization took 0.5323886871337891 ms
2022-09-21 08:17:35 INFO  Executing generated plans
2022-09-21 08:17:35 INFO  ---RUNTIME: Execution took 0.026941299438476562 ms
2022-09-21 08:17:35 INFO  Done!
2022-09-21 08:17:35 INFO  # Optimization benchmark for data_cleaning with args [['reviews', 'fast_loading', 'featurization_0', 'xgboost']] -- repetition 1 of 7
2022-09-21 08:17:35 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-21 08:17:35 INFO  Running instrumented original pipeline...
2022-09-21 08:17:35 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-21 08:17:35 INFO  ---RUNTIME: Importing and monkey-patching took 5.759239196777344 ms
2022-09-21 08:17:42 INFO  ---RUNTIME: Original pipeline execution took 7175.717830657959 ms (excluding imports and monkey-patching)
2022-09-21 08:17:42 INFO  Starting execution of 1 what-if analyses...
2022-09-21 08:17:42 INFO  Start plan generation for analysis DataCleaning...
2022-09-21 08:17:42 INFO  ---RUNTIME: Plan generation took 0.5435943603515625 ms
2022-09-21 08:17:42 INFO  Estimated runtime of original DAG is 5393.380641937256ms
2022-09-21 08:17:42 INFO  Performing Multi-Query Optimization
2022-09-21 08:17:42 INFO  Estimated unoptimized what-if runtime is 107867.61283874512ms
2022-09-21 08:17:42 INFO  Estimated optimised what-if runtime is 30227.08535194397ms
2022-09-21 08:17:42 INFO  Estimated optimisation runtime saving is 77640.52748680115ms
2022-09-21 08:17:42 INFO  ---RUNTIME: Multi-Query Optimization took 87.17679977416992 ms
2022-09-21 08:17:42 INFO  Executing generated plans
2022-09-21 08:18:23 INFO  ---RUNTIME: Execution took 40625.715255737305 ms
2022-09-21 08:18:23 INFO  Done!
2022-09-21 08:18:23 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-21 08:18:23 INFO  Running instrumented original pipeline...
2022-09-21 08:18:23 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-21 08:18:23 INFO  ---RUNTIME: Importing and monkey-patching took 6.408214569091797 ms
2022-09-21 08:18:30 INFO  ---RUNTIME: Original pipeline execution took 7013.991117477417 ms (excluding imports and monkey-patching)
2022-09-21 08:18:30 INFO  Starting execution of 1 what-if analyses...
2022-09-21 08:18:30 INFO  Start plan generation for analysis DataCleaning...
2022-09-21 08:18:30 INFO  ---RUNTIME: Plan generation took 0.5643367767333984 ms
2022-09-21 08:18:30 INFO  Estimated runtime of original DAG is 5394.202709197998ms
2022-09-21 08:18:30 WARNING Skipping Multi-Query Optimization (instead, only combine execution DAGs)
2022-09-21 08:18:30 WARNING Columns ['review_id'] not present in train DAG after the train test split, only before!
2022-09-21 08:18:30 WARNING This could hint at data leakage!
2022-09-21 08:18:30 INFO  Estimated unoptimised what-if runtime is 107884.05418395996ms
2022-09-21 08:18:30 INFO  ---RUNTIME: Multi-Query Optimization took 99.51448440551758 ms
2022-09-21 08:18:30 INFO  Executing generated plans
2022-09-21 08:20:49 INFO  ---RUNTIME: Execution took 139530.61294555664 ms
2022-09-21 08:20:49 INFO  Done!
2022-09-21 08:20:49 INFO  # Finished -- repetition 1 of 7 
2022-09-21 08:20:49 INFO  # Optimization benchmark for data_cleaning with args [['reviews', 'fast_loading', 'featurization_0', 'xgboost']] -- repetition 2 of 7
2022-09-21 08:20:49 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-21 08:20:49 INFO  Running instrumented original pipeline...
2022-09-21 08:20:49 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-21 08:20:49 INFO  ---RUNTIME: Importing and monkey-patching took 6.567478179931641 ms
2022-09-21 08:20:56 INFO  ---RUNTIME: Original pipeline execution took 7049.986839294434 ms (excluding imports and monkey-patching)
2022-09-21 08:20:56 INFO  Starting execution of 1 what-if analyses...
2022-09-21 08:20:56 INFO  Start plan generation for analysis DataCleaning...
2022-09-21 08:20:56 INFO  ---RUNTIME: Plan generation took 0.5347728729248047 ms
2022-09-21 08:20:56 INFO  Estimated runtime of original DAG is 5381.0389041900635ms
2022-09-21 08:20:56 INFO  Performing Multi-Query Optimization
2022-09-21 08:20:57 INFO  Estimated unoptimized what-if runtime is 107620.77808380127ms
2022-09-21 08:20:57 INFO  Estimated optimised what-if runtime is 29838.228464126587ms
2022-09-21 08:20:57 INFO  Estimated optimisation runtime saving is 77782.54961967468ms
2022-09-21 08:20:57 INFO  ---RUNTIME: Multi-Query Optimization took 85.1442813873291 ms
2022-09-21 08:20:57 INFO  Executing generated plans
2022-09-21 08:21:45 INFO  ---RUNTIME: Execution took 48891.84808731079 ms
2022-09-21 08:21:45 INFO  Done!
2022-09-21 08:21:45 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-21 08:21:45 INFO  Running instrumented original pipeline...
2022-09-21 08:21:45 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-21 08:21:45 INFO  ---RUNTIME: Importing and monkey-patching took 6.522417068481445 ms
2022-09-21 08:21:53 INFO  ---RUNTIME: Original pipeline execution took 7995.723485946655 ms (excluding imports and monkey-patching)
2022-09-21 08:21:53 INFO  Starting execution of 1 what-if analyses...
2022-09-21 08:21:53 INFO  Start plan generation for analysis DataCleaning...
2022-09-21 08:21:53 INFO  ---RUNTIME: Plan generation took 0.5521774291992188 ms
2022-09-21 08:21:53 INFO  Estimated runtime of original DAG is 5789.581298828125ms
2022-09-21 08:21:53 WARNING Skipping Multi-Query Optimization (instead, only combine execution DAGs)
2022-09-21 08:21:53 WARNING Columns ['review_id'] not present in train DAG after the train test split, only before!
2022-09-21 08:21:53 WARNING This could hint at data leakage!
2022-09-21 08:21:54 INFO  Estimated unoptimised what-if runtime is 115791.6259765625ms
2022-09-21 08:21:54 INFO  ---RUNTIME: Multi-Query Optimization took 98.13857078552246 ms
2022-09-21 08:21:54 INFO  Executing generated plans
2022-09-21 08:24:12 INFO  ---RUNTIME: Execution took 138438.18306922913 ms
2022-09-21 08:24:12 INFO  Done!
2022-09-21 08:24:12 INFO  # Finished -- repetition 2 of 7 
2022-09-21 08:24:12 INFO  # Optimization benchmark for data_cleaning with args [['reviews', 'fast_loading', 'featurization_0', 'xgboost']] -- repetition 3 of 7
2022-09-21 08:24:12 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-21 08:24:12 INFO  Running instrumented original pipeline...
2022-09-21 08:24:12 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-21 08:24:12 INFO  ---RUNTIME: Importing and monkey-patching took 6.201028823852539 ms
2022-09-21 08:24:24 INFO  ---RUNTIME: Original pipeline execution took 11591.084003448486 ms (excluding imports and monkey-patching)
2022-09-21 08:24:24 INFO  Starting execution of 1 what-if analyses...
2022-09-21 08:24:24 INFO  Start plan generation for analysis DataCleaning...
2022-09-21 08:24:24 INFO  ---RUNTIME: Plan generation took 0.5755424499511719 ms
2022-09-21 08:24:24 INFO  Estimated runtime of original DAG is 9891.688108444214ms
2022-09-21 08:24:24 INFO  Performing Multi-Query Optimization
2022-09-21 08:24:24 INFO  Estimated unoptimized what-if runtime is 197833.76216888428ms
2022-09-21 08:24:24 INFO  Estimated optimised what-if runtime is 119333.67609977722ms
2022-09-21 08:24:24 INFO  Estimated optimisation runtime saving is 78500.08606910706ms
2022-09-21 08:24:24 INFO  ---RUNTIME: Multi-Query Optimization took 86.29989624023438 ms
2022-09-21 08:24:24 INFO  Executing generated plans
2022-09-21 08:25:01 INFO  ---RUNTIME: Execution took 37793.09844970703 ms
2022-09-21 08:25:01 INFO  Done!
2022-09-21 08:25:01 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-21 08:25:01 INFO  Running instrumented original pipeline...
2022-09-21 08:25:01 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-21 08:25:02 INFO  ---RUNTIME: Importing and monkey-patching took 5.77998161315918 ms
2022-09-21 08:25:34 INFO  ---RUNTIME: Original pipeline execution took 32704.54692840576 ms (excluding imports and monkey-patching)
2022-09-21 08:25:34 INFO  Starting execution of 1 what-if analyses...
2022-09-21 08:25:34 INFO  Start plan generation for analysis DataCleaning...
2022-09-21 08:25:34 INFO  ---RUNTIME: Plan generation took 0.560760498046875 ms
2022-09-21 08:25:34 INFO  Estimated runtime of original DAG is 30998.695135116577ms
2022-09-21 08:25:34 WARNING Skipping Multi-Query Optimization (instead, only combine execution DAGs)
2022-09-21 08:25:34 WARNING Columns ['review_id'] not present in train DAG after the train test split, only before!
2022-09-21 08:25:34 WARNING This could hint at data leakage!
2022-09-21 08:25:34 INFO  Estimated unoptimised what-if runtime is 619973.9027023315ms
2022-09-21 08:25:34 INFO  ---RUNTIME: Multi-Query Optimization took 98.99497032165527 ms
2022-09-21 08:25:34 INFO  Executing generated plans
2022-09-21 08:27:48 INFO  ---RUNTIME: Execution took 133282.50694274902 ms
2022-09-21 08:27:48 INFO  Done!
2022-09-21 08:27:48 INFO  # Finished -- repetition 3 of 7 
2022-09-21 08:27:48 INFO  # Optimization benchmark for data_cleaning with args [['reviews', 'fast_loading', 'featurization_0', 'xgboost']] -- repetition 4 of 7
2022-09-21 08:27:48 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-21 08:27:48 INFO  Running instrumented original pipeline...
2022-09-21 08:27:48 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-21 08:27:48 INFO  ---RUNTIME: Importing and monkey-patching took 6.85882568359375 ms
2022-09-21 08:27:55 INFO  ---RUNTIME: Original pipeline execution took 7100.216627120972 ms (excluding imports and monkey-patching)
2022-09-21 08:27:55 INFO  Starting execution of 1 what-if analyses...
2022-09-21 08:27:55 INFO  Start plan generation for analysis DataCleaning...
2022-09-21 08:27:55 INFO  ---RUNTIME: Plan generation took 0.5311965942382812 ms
2022-09-21 08:27:55 INFO  Estimated runtime of original DAG is 5431.002378463745ms
2022-09-21 08:27:55 INFO  Performing Multi-Query Optimization
2022-09-21 08:27:55 INFO  Estimated unoptimized what-if runtime is 108620.0475692749ms
2022-09-21 08:27:55 INFO  Estimated optimised what-if runtime is 30476.84621810913ms
2022-09-21 08:27:55 INFO  Estimated optimisation runtime saving is 78143.20135116577ms
2022-09-21 08:27:55 INFO  ---RUNTIME: Multi-Query Optimization took 85.92772483825684 ms
2022-09-21 08:27:55 INFO  Executing generated plans
2022-09-21 08:29:42 INFO  ---RUNTIME: Execution took 107254.64296340942 ms
2022-09-21 08:29:42 INFO  Done!
2022-09-21 08:29:42 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-21 08:29:42 INFO  Running instrumented original pipeline...
2022-09-21 08:29:42 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-21 08:29:42 INFO  ---RUNTIME: Importing and monkey-patching took 6.779909133911133 ms
2022-09-21 08:30:03 INFO  ---RUNTIME: Original pipeline execution took 20958.556413650513 ms (excluding imports and monkey-patching)
2022-09-21 08:30:03 INFO  Starting execution of 1 what-if analyses...
2022-09-21 08:30:03 INFO  Start plan generation for analysis DataCleaning...
2022-09-21 08:30:03 INFO  ---RUNTIME: Plan generation took 0.6456375122070312 ms
2022-09-21 08:30:03 INFO  Estimated runtime of original DAG is 19295.098066329956ms
2022-09-21 08:30:03 WARNING Skipping Multi-Query Optimization (instead, only combine execution DAGs)
2022-09-21 08:30:03 WARNING Columns ['review_id'] not present in train DAG after the train test split, only before!
2022-09-21 08:30:03 WARNING This could hint at data leakage!
2022-09-21 08:30:03 INFO  Estimated unoptimised what-if runtime is 385901.9613265991ms
2022-09-21 08:30:03 INFO  ---RUNTIME: Multi-Query Optimization took 107.18107223510742 ms
2022-09-21 08:30:03 INFO  Executing generated plans
2022-09-21 08:32:17 INFO  ---RUNTIME: Execution took 133440.19174575806 ms
2022-09-21 08:32:17 INFO  Done!
2022-09-21 08:32:17 INFO  # Finished -- repetition 4 of 7 
2022-09-21 08:32:17 INFO  # Optimization benchmark for data_cleaning with args [['reviews', 'fast_loading', 'featurization_0', 'xgboost']] -- repetition 5 of 7
2022-09-21 08:32:17 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-21 08:32:17 INFO  Running instrumented original pipeline...
2022-09-21 08:32:17 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-21 08:32:17 INFO  ---RUNTIME: Importing and monkey-patching took 9.270429611206055 ms
2022-09-21 08:32:24 INFO  ---RUNTIME: Original pipeline execution took 7441.00284576416 ms (excluding imports and monkey-patching)
2022-09-21 08:32:24 INFO  Starting execution of 1 what-if analyses...
2022-09-21 08:32:24 INFO  Start plan generation for analysis DataCleaning...
2022-09-21 08:32:24 INFO  ---RUNTIME: Plan generation took 0.5695819854736328 ms
2022-09-21 08:32:24 INFO  Estimated runtime of original DAG is 5458.9245319366455ms
2022-09-21 08:32:24 INFO  Performing Multi-Query Optimization
2022-09-21 08:32:24 INFO  Estimated unoptimized what-if runtime is 109178.49063873291ms
2022-09-21 08:32:24 INFO  Estimated optimised what-if runtime is 30420.982122421265ms
2022-09-21 08:32:24 INFO  Estimated optimisation runtime saving is 78757.50851631165ms
2022-09-21 08:32:24 INFO  ---RUNTIME: Multi-Query Optimization took 86.66419982910156 ms
2022-09-21 08:32:24 INFO  Executing generated plans
2022-09-21 08:33:04 INFO  ---RUNTIME: Execution took 39878.326416015625 ms
2022-09-21 08:33:04 INFO  Done!
2022-09-21 08:33:04 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-21 08:33:04 INFO  Running instrumented original pipeline...
2022-09-21 08:33:04 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-21 08:33:04 INFO  ---RUNTIME: Importing and monkey-patching took 7.386684417724609 ms
2022-09-21 08:33:11 INFO  ---RUNTIME: Original pipeline execution took 7403.404235839844 ms (excluding imports and monkey-patching)
2022-09-21 08:33:11 INFO  Starting execution of 1 what-if analyses...
2022-09-21 08:33:11 INFO  Start plan generation for analysis DataCleaning...
2022-09-21 08:33:11 INFO  ---RUNTIME: Plan generation took 0.5228519439697266 ms
2022-09-21 08:33:11 INFO  Estimated runtime of original DAG is 5679.121017456055ms
2022-09-21 08:33:11 WARNING Skipping Multi-Query Optimization (instead, only combine execution DAGs)
2022-09-21 08:33:11 WARNING Columns ['review_id'] not present in train DAG after the train test split, only before!
2022-09-21 08:33:11 WARNING This could hint at data leakage!
2022-09-21 08:33:11 INFO  Estimated unoptimised what-if runtime is 113582.4203491211ms
2022-09-21 08:33:11 INFO  ---RUNTIME: Multi-Query Optimization took 98.13690185546875 ms
2022-09-21 08:33:11 INFO  Executing generated plans
2022-09-21 08:35:26 INFO  ---RUNTIME: Execution took 134603.2874584198 ms
2022-09-21 08:35:26 INFO  Done!
2022-09-21 08:35:26 INFO  # Finished -- repetition 5 of 7 
2022-09-21 08:35:26 INFO  # Optimization benchmark for data_cleaning with args [['reviews', 'fast_loading', 'featurization_0', 'xgboost']] -- repetition 6 of 7
2022-09-21 08:35:26 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-21 08:35:26 INFO  Running instrumented original pipeline...
2022-09-21 08:35:26 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-21 08:35:26 INFO  ---RUNTIME: Importing and monkey-patching took 6.441593170166016 ms
2022-09-21 08:35:33 INFO  ---RUNTIME: Original pipeline execution took 7172.55973815918 ms (excluding imports and monkey-patching)
2022-09-21 08:35:33 INFO  Starting execution of 1 what-if analyses...
2022-09-21 08:35:33 INFO  Start plan generation for analysis DataCleaning...
2022-09-21 08:35:33 INFO  ---RUNTIME: Plan generation took 0.5259513854980469 ms
2022-09-21 08:35:33 INFO  Estimated runtime of original DAG is 5454.68282699585ms
2022-09-21 08:35:33 INFO  Performing Multi-Query Optimization
2022-09-21 08:35:33 INFO  Estimated unoptimized what-if runtime is 109093.65653991699ms
2022-09-21 08:35:33 INFO  Estimated optimised what-if runtime is 30289.346933364868ms
2022-09-21 08:35:33 INFO  Estimated optimisation runtime saving is 78804.30960655212ms
2022-09-21 08:35:33 INFO  ---RUNTIME: Multi-Query Optimization took 84.76805686950684 ms
2022-09-21 08:35:33 INFO  Executing generated plans
2022-09-21 08:36:12 INFO  ---RUNTIME: Execution took 38215.08240699768 ms
2022-09-21 08:36:12 INFO  Done!
2022-09-21 08:36:12 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-21 08:36:12 INFO  Running instrumented original pipeline...
2022-09-21 08:36:12 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-21 08:36:12 INFO  ---RUNTIME: Importing and monkey-patching took 6.306171417236328 ms
2022-09-21 08:37:32 INFO  ---RUNTIME: Original pipeline execution took 79908.11562538147 ms (excluding imports and monkey-patching)
2022-09-21 08:37:32 INFO  Starting execution of 1 what-if analyses...
2022-09-21 08:37:32 INFO  Start plan generation for analysis DataCleaning...
2022-09-21 08:37:32 INFO  ---RUNTIME: Plan generation took 0.568389892578125 ms
2022-09-21 08:37:32 INFO  Estimated runtime of original DAG is 78198.76742362976ms
2022-09-21 08:37:32 WARNING Skipping Multi-Query Optimization (instead, only combine execution DAGs)
2022-09-21 08:37:32 WARNING Columns ['review_id'] not present in train DAG after the train test split, only before!
2022-09-21 08:37:32 WARNING This could hint at data leakage!
2022-09-21 08:37:32 INFO  Estimated unoptimised what-if runtime is 1563975.3484725952ms
2022-09-21 08:37:32 INFO  ---RUNTIME: Multi-Query Optimization took 99.7922420501709 ms
2022-09-21 08:37:32 INFO  Executing generated plans
2022-09-21 08:39:44 INFO  ---RUNTIME: Execution took 132565.09137153625 ms
2022-09-21 08:39:44 INFO  Done!
2022-09-21 08:39:44 INFO  # Finished -- repetition 6 of 7 
2022-09-21 08:39:44 INFO  # Optimization benchmark for data_cleaning with args [['reviews', 'fast_loading', 'featurization_0', 'xgboost']] -- repetition 7 of 7
2022-09-21 08:39:44 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-21 08:39:44 INFO  Running instrumented original pipeline...
2022-09-21 08:39:44 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-21 08:39:44 INFO  ---RUNTIME: Importing and monkey-patching took 6.465673446655273 ms
2022-09-21 08:39:51 INFO  ---RUNTIME: Original pipeline execution took 7116.786003112793 ms (excluding imports and monkey-patching)
2022-09-21 08:39:51 INFO  Starting execution of 1 what-if analyses...
2022-09-21 08:39:51 INFO  Start plan generation for analysis DataCleaning...
2022-09-21 08:39:51 INFO  ---RUNTIME: Plan generation took 0.5230903625488281 ms
2022-09-21 08:39:51 INFO  Estimated runtime of original DAG is 5458.199024200439ms
2022-09-21 08:39:51 INFO  Performing Multi-Query Optimization
2022-09-21 08:39:51 INFO  Estimated unoptimized what-if runtime is 109163.98048400879ms
2022-09-21 08:39:51 INFO  Estimated optimised what-if runtime is 30549.31139945984ms
2022-09-21 08:39:51 INFO  Estimated optimisation runtime saving is 78614.66908454895ms
2022-09-21 08:39:51 INFO  ---RUNTIME: Multi-Query Optimization took 84.8536491394043 ms
2022-09-21 08:39:51 INFO  Executing generated plans
2022-09-21 08:41:48 INFO  ---RUNTIME: Execution took 116304.762840271 ms
2022-09-21 08:41:48 INFO  Done!
2022-09-21 08:41:48 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-21 08:41:48 INFO  Running instrumented original pipeline...
2022-09-21 08:41:48 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-21 08:41:48 INFO  ---RUNTIME: Importing and monkey-patching took 6.024599075317383 ms
2022-09-21 08:43:12 INFO  ---RUNTIME: Original pipeline execution took 83965.87657928467 ms (excluding imports and monkey-patching)
2022-09-21 08:43:12 INFO  Starting execution of 1 what-if analyses...
2022-09-21 08:43:12 INFO  Start plan generation for analysis DataCleaning...
2022-09-21 08:43:12 INFO  ---RUNTIME: Plan generation took 0.5717277526855469 ms
2022-09-21 08:43:12 INFO  Estimated runtime of original DAG is 81955.02305030823ms
2022-09-21 08:43:12 WARNING Skipping Multi-Query Optimization (instead, only combine execution DAGs)
2022-09-21 08:43:12 WARNING Columns ['review_id'] not present in train DAG after the train test split, only before!
2022-09-21 08:43:12 WARNING This could hint at data leakage!
2022-09-21 08:43:12 INFO  Estimated unoptimised what-if runtime is 1639100.4610061646ms
2022-09-21 08:43:12 INFO  ---RUNTIME: Multi-Query Optimization took 98.44803810119629 ms
2022-09-21 08:43:12 INFO  Executing generated plans
2022-09-21 08:45:27 INFO  ---RUNTIME: Execution took 135695.7230567932 ms
2022-09-21 08:45:27 INFO  Done!
2022-09-21 08:45:27 INFO  # Finished -- repetition 7 of 7 
2022-09-21 08:45:27 INFO  # Final results after all repetitions
2022-09-21 08:45:27 INFO     repetition  ... no_opt_what_if_execution_combined_model_training
0           0  ...                                     14481.323719
1           1  ...                                     14682.039261
2           2  ...                                     15125.223875
3           3  ...                                     14765.025139
4           4  ...                                     14862.199306
5           5  ...                                     14941.783667
6           6  ...                                     18599.812031

[7 rows x 26 columns]
taskset -c 32-40 PROTOCOL_BUFFERS_PYTHON_IMPLEMENTATION=python python3.9 benchmarks_end_to_end.py data_cleaning reviews fast_loading featurization_0 neural_network
2022-09-21 08:45:30.179848: W tensorflow/stream_executor/platform/default/dso_loader.cc:64] Could not load dynamic library 'libcudart.so.11.0'; dlerror: libcudart.so.11.0: cannot open shared object file: No such file or directory; LD_LIBRARY_PATH: /home/sgrafbe/mlwhatif/venv/lib/python3.9/site-packages/cv2/../../lib64:
2022-09-21 08:45:30.179897: I tensorflow/stream_executor/cuda/cudart_stub.cc:29] Ignore above cudart dlerror if you do not have a GPU set up on your machine.
2022-09-21 08:45:31 INFO  Patching sys.argv with ['mlwhatif', 'reviews', 'fast_loading', 'featurization_0', 'neural_network']
2022-09-21 08:45:31 INFO  Running instrumented original pipeline...
2022-09-21 08:45:31 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-21 08:45:31 INFO  ---RUNTIME: Importing and monkey-patching took 121.33264541625977 ms
2022-09-21 08:45:36.595172: W tensorflow/stream_executor/platform/default/dso_loader.cc:64] Could not load dynamic library 'libcuda.so.1'; dlerror: libcuda.so.1: cannot open shared object file: No such file or directory; LD_LIBRARY_PATH: /home/sgrafbe/mlwhatif/venv/lib/python3.9/site-packages/cv2/../../lib64:
2022-09-21 08:45:36.595210: W tensorflow/stream_executor/cuda/cuda_driver.cc:326] failed call to cuInit: UNKNOWN ERROR (303)
2022-09-21 08:45:36.595232: I tensorflow/stream_executor/cuda/cuda_diagnostics.cc:156] kernel driver does not appear to be running on this host (angus): /proc/driver/nvidia/version does not exist
2022-09-21 08:45:36.595734: I tensorflow/core/platform/cpu_feature_guard.cc:142] This TensorFlow binary is optimized with oneAPI Deep Neural Network Library (oneDNN) to use the following CPU instructions in performance-critical operations:  AVX2 FMA
To enable them in other operations, rebuild TensorFlow with the appropriate compiler flags.
2022-09-21 08:45:36.838351: I tensorflow/compiler/mlir/mlir_graph_optimization_pass.cc:176] None of the MLIR Optimization Passes are enabled (registered 2)
2022-09-21 08:45:36.850183: I tensorflow/core/platform/profile_utils/cpu_utils.cc:114] CPU Frequency: 2595130000 Hz
2022-09-21 08:45:41 INFO  ---RUNTIME: Original pipeline execution took 10315.63115119934 ms (excluding imports and monkey-patching)
2022-09-21 08:45:41 INFO  Starting execution of 0 what-if analyses...
2022-09-21 08:45:41 INFO  Estimated runtime of original DAG is 8643.742799758911ms
2022-09-21 08:45:41 INFO  Performing Multi-Query Optimization
2022-09-21 08:45:41 INFO  Estimated unoptimized what-if runtime is 0ms
2022-09-21 08:45:41 INFO  Estimated optimised what-if runtime is 0ms
2022-09-21 08:45:41 INFO  Estimated optimisation runtime saving is 0ms
2022-09-21 08:45:41 INFO  ---RUNTIME: Multi-Query Optimization took 0.4730224609375 ms
2022-09-21 08:45:41 INFO  Executing generated plans
2022-09-21 08:45:41 INFO  ---RUNTIME: Execution took 0.02193450927734375 ms
2022-09-21 08:45:41 INFO  Done!
2022-09-21 08:45:41 INFO  # Optimization benchmark for data_cleaning with args [['reviews', 'fast_loading', 'featurization_0', 'neural_network']] -- repetition 1 of 7
2022-09-21 08:45:41 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-21 08:45:41 INFO  Running instrumented original pipeline...
2022-09-21 08:45:41 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-21 08:45:41 INFO  ---RUNTIME: Importing and monkey-patching took 5.316495895385742 ms
2022-09-21 08:45:51 INFO  ---RUNTIME: Original pipeline execution took 9823.32444190979 ms (excluding imports and monkey-patching)
2022-09-21 08:45:51 INFO  Starting execution of 1 what-if analyses...
2022-09-21 08:45:51 INFO  Start plan generation for analysis DataCleaning...
2022-09-21 08:45:51 INFO  ---RUNTIME: Plan generation took 0.5626678466796875 ms
2022-09-21 08:45:51 INFO  Estimated runtime of original DAG is 8211.363077163696ms
2022-09-21 08:45:51 INFO  Performing Multi-Query Optimization
2022-09-21 08:45:51 INFO  Estimated unoptimized what-if runtime is 164227.26154327393ms
2022-09-21 08:45:51 INFO  Estimated optimised what-if runtime is 86884.08350944519ms
2022-09-21 08:45:51 INFO  Estimated optimisation runtime saving is 77343.17803382874ms
2022-09-21 08:45:51 INFO  ---RUNTIME: Multi-Query Optimization took 86.6844654083252 ms
2022-09-21 08:45:51 INFO  Executing generated plans
2022-09-21 08:47:27 INFO  ---RUNTIME: Execution took 95477.43582725525 ms
2022-09-21 08:47:27 INFO  Done!
2022-09-21 08:47:27 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-21 08:47:27 INFO  Running instrumented original pipeline...
2022-09-21 08:47:27 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-21 08:47:27 INFO  ---RUNTIME: Importing and monkey-patching took 6.05463981628418 ms
2022-09-21 08:47:37 INFO  ---RUNTIME: Original pipeline execution took 9884.04631614685 ms (excluding imports and monkey-patching)
2022-09-21 08:47:37 INFO  Starting execution of 1 what-if analyses...
2022-09-21 08:47:37 INFO  Start plan generation for analysis DataCleaning...
2022-09-21 08:47:37 INFO  ---RUNTIME: Plan generation took 0.5967617034912109 ms
2022-09-21 08:47:37 INFO  Estimated runtime of original DAG is 8273.508310317993ms
2022-09-21 08:47:37 WARNING Skipping Multi-Query Optimization (instead, only combine execution DAGs)
2022-09-21 08:47:37 WARNING Columns ['review_id'] not present in train DAG after the train test split, only before!
2022-09-21 08:47:37 WARNING This could hint at data leakage!
2022-09-21 08:47:37 INFO  Estimated unoptimised what-if runtime is 165470.16620635986ms
2022-09-21 08:47:37 INFO  ---RUNTIME: Multi-Query Optimization took 98.40130805969238 ms
2022-09-21 08:47:37 INFO  Executing generated plans
2022-09-21 08:50:47 INFO  ---RUNTIME: Execution took 189783.3206653595 ms
2022-09-21 08:50:47 INFO  Done!
2022-09-21 08:50:47 INFO  # Finished -- repetition 1 of 7 
2022-09-21 08:50:47 INFO  # Optimization benchmark for data_cleaning with args [['reviews', 'fast_loading', 'featurization_0', 'neural_network']] -- repetition 2 of 7
2022-09-21 08:50:47 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-21 08:50:47 INFO  Running instrumented original pipeline...
2022-09-21 08:50:47 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-21 08:50:47 INFO  ---RUNTIME: Importing and monkey-patching took 5.889177322387695 ms
2022-09-21 08:50:57 INFO  ---RUNTIME: Original pipeline execution took 9958.574056625366 ms (excluding imports and monkey-patching)
2022-09-21 08:50:57 INFO  Starting execution of 1 what-if analyses...
2022-09-21 08:50:57 INFO  Start plan generation for analysis DataCleaning...
2022-09-21 08:50:57 INFO  ---RUNTIME: Plan generation took 0.5259513854980469 ms
2022-09-21 08:50:57 INFO  Estimated runtime of original DAG is 8296.855449676514ms
2022-09-21 08:50:57 INFO  Performing Multi-Query Optimization
2022-09-21 08:50:57 INFO  Estimated unoptimized what-if runtime is 165937.10899353027ms
2022-09-21 08:50:57 INFO  Estimated optimised what-if runtime is 88487.71643638611ms
2022-09-21 08:50:57 INFO  Estimated optimisation runtime saving is 77449.39255714417ms
2022-09-21 08:50:57 INFO  ---RUNTIME: Multi-Query Optimization took 86.47346496582031 ms
2022-09-21 08:50:57 INFO  Executing generated plans
2022-09-21 08:52:32 INFO  ---RUNTIME: Execution took 95218.95098686218 ms
2022-09-21 08:52:32 INFO  Done!
2022-09-21 08:52:32 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-21 08:52:32 INFO  Running instrumented original pipeline...
2022-09-21 08:52:32 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-21 08:52:32 INFO  ---RUNTIME: Importing and monkey-patching took 6.209373474121094 ms
2022-09-21 08:52:42 INFO  ---RUNTIME: Original pipeline execution took 10000.826120376587 ms (excluding imports and monkey-patching)
2022-09-21 08:52:42 INFO  Starting execution of 1 what-if analyses...
2022-09-21 08:52:42 INFO  Start plan generation for analysis DataCleaning...
2022-09-21 08:52:42 INFO  ---RUNTIME: Plan generation took 0.5261898040771484 ms
2022-09-21 08:52:42 INFO  Estimated runtime of original DAG is 8379.030466079712ms
2022-09-21 08:52:42 WARNING Skipping Multi-Query Optimization (instead, only combine execution DAGs)
2022-09-21 08:52:42 WARNING Columns ['review_id'] not present in train DAG after the train test split, only before!
2022-09-21 08:52:42 WARNING This could hint at data leakage!
2022-09-21 08:52:42 INFO  Estimated unoptimised what-if runtime is 167580.60932159424ms
2022-09-21 08:52:42 INFO  ---RUNTIME: Multi-Query Optimization took 100.0056266784668 ms
2022-09-21 08:52:42 INFO  Executing generated plans
2022-09-21 08:55:52 INFO  ---RUNTIME: Execution took 189739.26639556885 ms
2022-09-21 08:55:52 INFO  Done!
2022-09-21 08:55:52 INFO  # Finished -- repetition 2 of 7 
2022-09-21 08:55:52 INFO  # Optimization benchmark for data_cleaning with args [['reviews', 'fast_loading', 'featurization_0', 'neural_network']] -- repetition 3 of 7
2022-09-21 08:55:52 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-21 08:55:52 INFO  Running instrumented original pipeline...
2022-09-21 08:55:52 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-21 08:55:52 INFO  ---RUNTIME: Importing and monkey-patching took 5.737066268920898 ms
2022-09-21 08:56:02 INFO  ---RUNTIME: Original pipeline execution took 10000.41937828064 ms (excluding imports and monkey-patching)
2022-09-21 08:56:02 INFO  Starting execution of 1 what-if analyses...
2022-09-21 08:56:02 INFO  Start plan generation for analysis DataCleaning...
2022-09-21 08:56:02 INFO  ---RUNTIME: Plan generation took 0.5040168762207031 ms
2022-09-21 08:56:02 INFO  Estimated runtime of original DAG is 8337.820768356323ms
2022-09-21 08:56:02 INFO  Performing Multi-Query Optimization
2022-09-21 08:56:02 INFO  Estimated unoptimized what-if runtime is 166756.41536712646ms
2022-09-21 08:56:02 INFO  Estimated optimised what-if runtime is 89048.39658737183ms
2022-09-21 08:56:02 INFO  Estimated optimisation runtime saving is 77708.01877975464ms
2022-09-21 08:56:02 INFO  ---RUNTIME: Multi-Query Optimization took 84.52963829040527 ms
2022-09-21 08:56:02 INFO  Executing generated plans
2022-09-21 08:57:38 INFO  ---RUNTIME: Execution took 96197.27897644043 ms
2022-09-21 08:57:38 INFO  Done!
2022-09-21 08:57:38 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-21 08:57:38 INFO  Running instrumented original pipeline...
2022-09-21 08:57:38 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-21 08:57:38 INFO  ---RUNTIME: Importing and monkey-patching took 5.828142166137695 ms
2022-09-21 08:57:48 INFO  ---RUNTIME: Original pipeline execution took 9974.95174407959 ms (excluding imports and monkey-patching)
2022-09-21 08:57:48 INFO  Starting execution of 1 what-if analyses...
2022-09-21 08:57:48 INFO  Start plan generation for analysis DataCleaning...
2022-09-21 08:57:48 INFO  ---RUNTIME: Plan generation took 0.5712509155273438 ms
2022-09-21 08:57:48 INFO  Estimated runtime of original DAG is 8313.009977340698ms
2022-09-21 08:57:48 WARNING Skipping Multi-Query Optimization (instead, only combine execution DAGs)
2022-09-21 08:57:48 WARNING Columns ['review_id'] not present in train DAG after the train test split, only before!
2022-09-21 08:57:48 WARNING This could hint at data leakage!
2022-09-21 08:57:48 INFO  Estimated unoptimised what-if runtime is 166260.19954681396ms
2022-09-21 08:57:48 INFO  ---RUNTIME: Multi-Query Optimization took 97.43690490722656 ms
2022-09-21 08:57:48 INFO  Executing generated plans
2022-09-21 09:01:03 INFO  ---RUNTIME: Execution took 195084.30933952332 ms
2022-09-21 09:01:03 INFO  Done!
2022-09-21 09:01:03 INFO  # Finished -- repetition 3 of 7 
2022-09-21 09:01:03 INFO  # Optimization benchmark for data_cleaning with args [['reviews', 'fast_loading', 'featurization_0', 'neural_network']] -- repetition 4 of 7
2022-09-21 09:01:03 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-21 09:01:03 INFO  Running instrumented original pipeline...
2022-09-21 09:01:03 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-21 09:01:03 INFO  ---RUNTIME: Importing and monkey-patching took 5.979776382446289 ms
2022-09-21 09:01:13 INFO  ---RUNTIME: Original pipeline execution took 9972.171545028687 ms (excluding imports and monkey-patching)
2022-09-21 09:01:13 INFO  Starting execution of 1 what-if analyses...
2022-09-21 09:01:13 INFO  Start plan generation for analysis DataCleaning...
2022-09-21 09:01:13 INFO  ---RUNTIME: Plan generation took 0.5688667297363281 ms
2022-09-21 09:01:13 INFO  Estimated runtime of original DAG is 8262.069702148438ms
2022-09-21 09:01:13 INFO  Performing Multi-Query Optimization
2022-09-21 09:01:13 INFO  Estimated unoptimized what-if runtime is 165241.39404296875ms
2022-09-21 09:01:13 INFO  Estimated optimised what-if runtime is 86462.4285697937ms
2022-09-21 09:01:13 INFO  Estimated optimisation runtime saving is 78778.96547317505ms
2022-09-21 09:01:13 INFO  ---RUNTIME: Multi-Query Optimization took 87.51273155212402 ms
2022-09-21 09:01:13 INFO  Executing generated plans
2022-09-21 09:02:52 INFO  ---RUNTIME: Execution took 98770.32780647278 ms
2022-09-21 09:02:52 INFO  Done!
2022-09-21 09:02:52 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-21 09:02:52 INFO  Running instrumented original pipeline...
2022-09-21 09:02:52 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-21 09:02:52 INFO  ---RUNTIME: Importing and monkey-patching took 5.788087844848633 ms
2022-09-21 09:03:02 INFO  ---RUNTIME: Original pipeline execution took 10186.081409454346 ms (excluding imports and monkey-patching)
2022-09-21 09:03:02 INFO  Starting execution of 1 what-if analyses...
2022-09-21 09:03:02 INFO  Start plan generation for analysis DataCleaning...
2022-09-21 09:03:02 INFO  ---RUNTIME: Plan generation took 0.5102157592773438 ms
2022-09-21 09:03:02 INFO  Estimated runtime of original DAG is 8513.646125793457ms
2022-09-21 09:03:02 WARNING Skipping Multi-Query Optimization (instead, only combine execution DAGs)
2022-09-21 09:03:02 WARNING Columns ['review_id'] not present in train DAG after the train test split, only before!
2022-09-21 09:03:02 WARNING This could hint at data leakage!
2022-09-21 09:03:02 INFO  Estimated unoptimised what-if runtime is 170272.92251586914ms
2022-09-21 09:03:02 INFO  ---RUNTIME: Multi-Query Optimization took 97.86415100097656 ms
2022-09-21 09:03:02 INFO  Executing generated plans
2022-09-21 09:06:19 INFO  ---RUNTIME: Execution took 196423.27857017517 ms
2022-09-21 09:06:19 INFO  Done!
2022-09-21 09:06:19 INFO  # Finished -- repetition 4 of 7 
2022-09-21 09:06:19 INFO  # Optimization benchmark for data_cleaning with args [['reviews', 'fast_loading', 'featurization_0', 'neural_network']] -- repetition 5 of 7
2022-09-21 09:06:19 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-21 09:06:19 INFO  Running instrumented original pipeline...
2022-09-21 09:06:19 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-21 09:06:19 INFO  ---RUNTIME: Importing and monkey-patching took 6.1321258544921875 ms
2022-09-21 09:06:29 INFO  ---RUNTIME: Original pipeline execution took 9913.217544555664 ms (excluding imports and monkey-patching)
2022-09-21 09:06:29 INFO  Starting execution of 1 what-if analyses...
2022-09-21 09:06:29 INFO  Start plan generation for analysis DataCleaning...
2022-09-21 09:06:29 INFO  ---RUNTIME: Plan generation took 0.5068778991699219 ms
2022-09-21 09:06:29 INFO  Estimated runtime of original DAG is 8237.997770309448ms
2022-09-21 09:06:29 INFO  Performing Multi-Query Optimization
2022-09-21 09:06:29 INFO  Estimated unoptimized what-if runtime is 164759.95540618896ms
2022-09-21 09:06:29 INFO  Estimated optimised what-if runtime is 87025.58302879333ms
2022-09-21 09:06:29 INFO  Estimated optimisation runtime saving is 77734.37237739563ms
2022-09-21 09:06:29 INFO  ---RUNTIME: Multi-Query Optimization took 85.65521240234375 ms
2022-09-21 09:06:29 INFO  Executing generated plans
2022-09-21 09:08:07 INFO  ---RUNTIME: Execution took 98574.47910308838 ms
2022-09-21 09:08:07 INFO  Done!
2022-09-21 09:08:07 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-21 09:08:07 INFO  Running instrumented original pipeline...
2022-09-21 09:08:07 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-21 09:08:07 INFO  ---RUNTIME: Importing and monkey-patching took 6.079673767089844 ms
2022-09-21 09:08:17 INFO  ---RUNTIME: Original pipeline execution took 10023.221492767334 ms (excluding imports and monkey-patching)
2022-09-21 09:08:17 INFO  Starting execution of 1 what-if analyses...
2022-09-21 09:08:17 INFO  Start plan generation for analysis DataCleaning...
2022-09-21 09:08:17 INFO  ---RUNTIME: Plan generation took 0.5986690521240234 ms
2022-09-21 09:08:17 INFO  Estimated runtime of original DAG is 8309.20672416687ms
2022-09-21 09:08:17 WARNING Skipping Multi-Query Optimization (instead, only combine execution DAGs)
2022-09-21 09:08:17 WARNING Columns ['review_id'] not present in train DAG after the train test split, only before!
2022-09-21 09:08:17 WARNING This could hint at data leakage!
2022-09-21 09:08:17 INFO  Estimated unoptimised what-if runtime is 166184.1344833374ms
2022-09-21 09:08:17 INFO  ---RUNTIME: Multi-Query Optimization took 104.87508773803711 ms
2022-09-21 09:08:17 INFO  Executing generated plans
2022-09-21 09:11:33 INFO  ---RUNTIME: Execution took 195220.5924987793 ms
2022-09-21 09:11:33 INFO  Done!
2022-09-21 09:11:33 INFO  # Finished -- repetition 5 of 7 
2022-09-21 09:11:33 INFO  # Optimization benchmark for data_cleaning with args [['reviews', 'fast_loading', 'featurization_0', 'neural_network']] -- repetition 6 of 7
2022-09-21 09:11:33 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-21 09:11:33 INFO  Running instrumented original pipeline...
2022-09-21 09:11:33 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-21 09:11:33 INFO  ---RUNTIME: Importing and monkey-patching took 5.722999572753906 ms
2022-09-21 09:11:43 INFO  ---RUNTIME: Original pipeline execution took 9834.057807922363 ms (excluding imports and monkey-patching)
2022-09-21 09:11:43 INFO  Starting execution of 1 what-if analyses...
2022-09-21 09:11:43 INFO  Start plan generation for analysis DataCleaning...
2022-09-21 09:11:43 INFO  ---RUNTIME: Plan generation took 0.5385875701904297 ms
2022-09-21 09:11:43 INFO  Estimated runtime of original DAG is 8166.829586029053ms
2022-09-21 09:11:43 INFO  Performing Multi-Query Optimization
2022-09-21 09:11:43 INFO  Estimated unoptimized what-if runtime is 163336.59172058105ms
2022-09-21 09:11:43 INFO  Estimated optimised what-if runtime is 84859.80772972107ms
2022-09-21 09:11:43 INFO  Estimated optimisation runtime saving is 78476.78399085999ms
2022-09-21 09:11:43 INFO  ---RUNTIME: Multi-Query Optimization took 84.96451377868652 ms
2022-09-21 09:11:43 INFO  Executing generated plans
2022-09-21 09:13:21 INFO  ---RUNTIME: Execution took 98114.89534378052 ms
2022-09-21 09:13:21 INFO  Done!
2022-09-21 09:13:21 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-21 09:13:21 INFO  Running instrumented original pipeline...
2022-09-21 09:13:21 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-21 09:13:21 INFO  ---RUNTIME: Importing and monkey-patching took 7.981300354003906 ms
2022-09-21 09:13:34 INFO  ---RUNTIME: Original pipeline execution took 13496.983528137207 ms (excluding imports and monkey-patching)
2022-09-21 09:13:34 INFO  Starting execution of 1 what-if analyses...
2022-09-21 09:13:34 INFO  Start plan generation for analysis DataCleaning...
2022-09-21 09:13:34 INFO  ---RUNTIME: Plan generation took 0.6842613220214844 ms
2022-09-21 09:13:34 INFO  Estimated runtime of original DAG is 11374.940156936646ms
2022-09-21 09:13:34 WARNING Skipping Multi-Query Optimization (instead, only combine execution DAGs)
2022-09-21 09:13:34 WARNING Columns ['review_id'] not present in train DAG after the train test split, only before!
2022-09-21 09:13:34 WARNING This could hint at data leakage!
2022-09-21 09:13:34 INFO  Estimated unoptimised what-if runtime is 227498.8031387329ms
2022-09-21 09:13:34 INFO  ---RUNTIME: Multi-Query Optimization took 136.6724967956543 ms
2022-09-21 09:13:34 INFO  Executing generated plans
2022-09-21 09:16:49 INFO  ---RUNTIME: Execution took 195093.78838539124 ms
2022-09-21 09:16:49 INFO  Done!
2022-09-21 09:16:49 INFO  # Finished -- repetition 6 of 7 
2022-09-21 09:16:49 INFO  # Optimization benchmark for data_cleaning with args [['reviews', 'fast_loading', 'featurization_0', 'neural_network']] -- repetition 7 of 7
2022-09-21 09:16:49 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-21 09:16:49 INFO  Running instrumented original pipeline...
2022-09-21 09:16:50 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-21 09:16:50 INFO  ---RUNTIME: Importing and monkey-patching took 7.412910461425781 ms
2022-09-21 09:17:01 INFO  ---RUNTIME: Original pipeline execution took 11671.691417694092 ms (excluding imports and monkey-patching)
2022-09-21 09:17:01 INFO  Starting execution of 1 what-if analyses...
2022-09-21 09:17:01 INFO  Start plan generation for analysis DataCleaning...
2022-09-21 09:17:01 INFO  ---RUNTIME: Plan generation took 2.312898635864258 ms
2022-09-21 09:17:01 INFO  Estimated runtime of original DAG is 9556.083917617798ms
2022-09-21 09:17:01 INFO  Performing Multi-Query Optimization
2022-09-21 09:17:01 INFO  Estimated unoptimized what-if runtime is 191121.67835235596ms
2022-09-21 09:17:01 INFO  Estimated optimised what-if runtime is 97945.5795288086ms
2022-09-21 09:17:01 INFO  Estimated optimisation runtime saving is 93176.09882354736ms
2022-09-21 09:17:01 INFO  ---RUNTIME: Multi-Query Optimization took 84.41519737243652 ms
2022-09-21 09:17:01 INFO  Executing generated plans
2022-09-21 09:18:36 INFO  ---RUNTIME: Execution took 94547.4443435669 ms
2022-09-21 09:18:36 INFO  Done!
2022-09-21 09:18:36 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-21 09:18:36 INFO  Running instrumented original pipeline...
2022-09-21 09:18:36 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-21 09:18:36 INFO  ---RUNTIME: Importing and monkey-patching took 5.843400955200195 ms
2022-09-21 09:18:46 INFO  ---RUNTIME: Original pipeline execution took 9785.42184829712 ms (excluding imports and monkey-patching)
2022-09-21 09:18:46 INFO  Starting execution of 1 what-if analyses...
2022-09-21 09:18:46 INFO  Start plan generation for analysis DataCleaning...
2022-09-21 09:18:46 INFO  ---RUNTIME: Plan generation took 0.5590915679931641 ms
2022-09-21 09:18:46 INFO  Estimated runtime of original DAG is 8117.858409881592ms
2022-09-21 09:18:46 WARNING Skipping Multi-Query Optimization (instead, only combine execution DAGs)
2022-09-21 09:18:46 WARNING Columns ['review_id'] not present in train DAG after the train test split, only before!
2022-09-21 09:18:46 WARNING This could hint at data leakage!
2022-09-21 09:18:46 INFO  Estimated unoptimised what-if runtime is 162357.16819763184ms
2022-09-21 09:18:46 INFO  ---RUNTIME: Multi-Query Optimization took 98.21724891662598 ms
2022-09-21 09:18:46 INFO  Executing generated plans
2022-09-21 09:22:01 INFO  ---RUNTIME: Execution took 194809.87858772278 ms
2022-09-21 09:22:01 INFO  Done!
2022-09-21 09:22:01 INFO  # Finished -- repetition 7 of 7 
2022-09-21 09:22:01 INFO  # Final results after all repetitions
2022-09-21 09:22:01 INFO     repetition  ... no_opt_what_if_execution_combined_model_training
0           0  ...                                     65378.857613
1           1  ...                                     65823.228836
2           2  ...                                     68968.662024
3           3  ...                                     68584.630966
4           4  ...                                     64747.122049
5           5  ...                                     68654.390335
6           6  ...                                     64661.769867

[7 rows x 26 columns]
taskset -c 32-40 PROTOCOL_BUFFERS_PYTHON_IMPLEMENTATION=python python3.9 benchmarks_end_to_end.py data_cleaning reviews fast_loading featurization_1 logistic_regression
2022-09-21 09:22:03.726700: W tensorflow/stream_executor/platform/default/dso_loader.cc:64] Could not load dynamic library 'libcudart.so.11.0'; dlerror: libcudart.so.11.0: cannot open shared object file: No such file or directory; LD_LIBRARY_PATH: /home/sgrafbe/mlwhatif/venv/lib/python3.9/site-packages/cv2/../../lib64:
2022-09-21 09:22:03.726748: I tensorflow/stream_executor/cuda/cudart_stub.cc:29] Ignore above cudart dlerror if you do not have a GPU set up on your machine.
2022-09-21 09:22:05 INFO  Patching sys.argv with ['mlwhatif', 'reviews', 'fast_loading', 'featurization_1', 'logistic_regression']
2022-09-21 09:22:05 INFO  Running instrumented original pipeline...
2022-09-21 09:22:05 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-21 09:22:05 INFO  ---RUNTIME: Importing and monkey-patching took 121.69551849365234 ms
2022-09-21 09:22:12 INFO  ---RUNTIME: Original pipeline execution took 7148.547649383545 ms (excluding imports and monkey-patching)
2022-09-21 09:22:12 INFO  Starting execution of 0 what-if analyses...
2022-09-21 09:22:12 INFO  Estimated runtime of original DAG is 4865.566253662109ms
2022-09-21 09:22:12 INFO  Performing Multi-Query Optimization
2022-09-21 09:22:12 INFO  Estimated unoptimized what-if runtime is 0ms
2022-09-21 09:22:12 INFO  Estimated optimised what-if runtime is 0ms
2022-09-21 09:22:12 INFO  Estimated optimisation runtime saving is 0ms
2022-09-21 09:22:12 INFO  ---RUNTIME: Multi-Query Optimization took 0.5128383636474609 ms
2022-09-21 09:22:12 INFO  Executing generated plans
2022-09-21 09:22:12 INFO  ---RUNTIME: Execution took 0.0247955322265625 ms
2022-09-21 09:22:12 INFO  Done!
2022-09-21 09:22:12 INFO  # Optimization benchmark for data_cleaning with args [['reviews', 'fast_loading', 'featurization_1', 'logistic_regression']] -- repetition 1 of 7
2022-09-21 09:22:12 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-21 09:22:12 INFO  Running instrumented original pipeline...
2022-09-21 09:22:12 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-21 09:22:12 INFO  ---RUNTIME: Importing and monkey-patching took 6.138086318969727 ms
2022-09-21 09:22:19 INFO  ---RUNTIME: Original pipeline execution took 7231.720685958862 ms (excluding imports and monkey-patching)
2022-09-21 09:22:19 INFO  Starting execution of 1 what-if analyses...
2022-09-21 09:22:19 INFO  Start plan generation for analysis DataCleaning...
2022-09-21 09:22:19 INFO  ---RUNTIME: Plan generation took 0.6873607635498047 ms
2022-09-21 09:22:19 INFO  Estimated runtime of original DAG is 4847.476005554199ms
2022-09-21 09:22:19 INFO  Performing Multi-Query Optimization
2022-09-21 09:22:19 INFO  Estimated unoptimized what-if runtime is 96949.52011108398ms
2022-09-21 09:22:19 INFO  Estimated optimised what-if runtime is 18767.544269561768ms
2022-09-21 09:22:19 INFO  Estimated optimisation runtime saving is 78181.97584152222ms
2022-09-21 09:22:19 INFO  ---RUNTIME: Multi-Query Optimization took 95.2451229095459 ms
2022-09-21 09:22:19 INFO  Executing generated plans
2022-09-21 09:22:47 INFO  ---RUNTIME: Execution took 27722.732067108154 ms
2022-09-21 09:22:47 INFO  Done!
2022-09-21 09:22:47 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-21 09:22:47 INFO  Running instrumented original pipeline...
2022-09-21 09:22:47 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-21 09:22:47 INFO  ---RUNTIME: Importing and monkey-patching took 7.912158966064453 ms
2022-09-21 09:22:55 INFO  ---RUNTIME: Original pipeline execution took 8506.217002868652 ms (excluding imports and monkey-patching)
2022-09-21 09:22:55 INFO  Starting execution of 1 what-if analyses...
2022-09-21 09:22:55 INFO  Start plan generation for analysis DataCleaning...
2022-09-21 09:22:55 INFO  ---RUNTIME: Plan generation took 0.7882118225097656 ms
2022-09-21 09:22:55 INFO  Estimated runtime of original DAG is 5905.32660484314ms
2022-09-21 09:22:55 WARNING Skipping Multi-Query Optimization (instead, only combine execution DAGs)
2022-09-21 09:22:55 WARNING Columns ['review_id'] not present in train DAG after the train test split, only before!
2022-09-21 09:22:55 WARNING This could hint at data leakage!
2022-09-21 09:22:55 INFO  Estimated unoptimised what-if runtime is 118106.5320968628ms
2022-09-21 09:22:55 INFO  ---RUNTIME: Multi-Query Optimization took 108.0312728881836 ms
2022-09-21 09:22:55 INFO  Executing generated plans
2022-09-21 09:24:57 INFO  ---RUNTIME: Execution took 121745.89252471924 ms
2022-09-21 09:24:57 INFO  Done!
2022-09-21 09:24:57 INFO  # Finished -- repetition 1 of 7 
2022-09-21 09:24:57 INFO  # Optimization benchmark for data_cleaning with args [['reviews', 'fast_loading', 'featurization_1', 'logistic_regression']] -- repetition 2 of 7
2022-09-21 09:24:57 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-21 09:24:57 INFO  Running instrumented original pipeline...
2022-09-21 09:24:57 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-21 09:24:57 INFO  ---RUNTIME: Importing and monkey-patching took 6.161212921142578 ms
2022-09-21 09:25:04 INFO  ---RUNTIME: Original pipeline execution took 7214.014530181885 ms (excluding imports and monkey-patching)
2022-09-21 09:25:04 INFO  Starting execution of 1 what-if analyses...
2022-09-21 09:25:04 INFO  Start plan generation for analysis DataCleaning...
2022-09-21 09:25:04 INFO  ---RUNTIME: Plan generation took 0.7698535919189453 ms
2022-09-21 09:25:04 INFO  Estimated runtime of original DAG is 4919.105768203735ms
2022-09-21 09:25:04 INFO  Performing Multi-Query Optimization
2022-09-21 09:25:05 INFO  Estimated unoptimized what-if runtime is 98382.1153640747ms
2022-09-21 09:25:05 INFO  Estimated optimised what-if runtime is 19856.810569763184ms
2022-09-21 09:25:05 INFO  Estimated optimisation runtime saving is 78525.30479431152ms
2022-09-21 09:25:05 INFO  ---RUNTIME: Multi-Query Optimization took 92.75388717651367 ms
2022-09-21 09:25:05 INFO  Executing generated plans
2022-09-21 09:25:30 INFO  ---RUNTIME: Execution took 25106.47416114807 ms
2022-09-21 09:25:30 INFO  Done!
2022-09-21 09:25:30 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-21 09:25:30 INFO  Running instrumented original pipeline...
2022-09-21 09:25:30 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-21 09:25:30 INFO  ---RUNTIME: Importing and monkey-patching took 5.733251571655273 ms
2022-09-21 09:25:37 INFO  ---RUNTIME: Original pipeline execution took 7060.3673458099365 ms (excluding imports and monkey-patching)
2022-09-21 09:25:37 INFO  Starting execution of 1 what-if analyses...
2022-09-21 09:25:37 INFO  Start plan generation for analysis DataCleaning...
2022-09-21 09:25:37 INFO  ---RUNTIME: Plan generation took 0.6494522094726562 ms
2022-09-21 09:25:37 INFO  Estimated runtime of original DAG is 4828.764915466309ms
2022-09-21 09:25:37 WARNING Skipping Multi-Query Optimization (instead, only combine execution DAGs)
2022-09-21 09:25:37 WARNING Columns ['review_id'] not present in train DAG after the train test split, only before!
2022-09-21 09:25:37 WARNING This could hint at data leakage!
2022-09-21 09:25:37 INFO  Estimated unoptimised what-if runtime is 96575.29830932617ms
2022-09-21 09:25:37 INFO  ---RUNTIME: Multi-Query Optimization took 303.5116195678711 ms
2022-09-21 09:25:37 INFO  Executing generated plans
2022-09-21 09:27:38 INFO  ---RUNTIME: Execution took 121106.87375068665 ms
2022-09-21 09:27:38 INFO  Done!
2022-09-21 09:27:38 INFO  # Finished -- repetition 2 of 7 
2022-09-21 09:27:38 INFO  # Optimization benchmark for data_cleaning with args [['reviews', 'fast_loading', 'featurization_1', 'logistic_regression']] -- repetition 3 of 7
2022-09-21 09:27:38 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-21 09:27:38 INFO  Running instrumented original pipeline...
2022-09-21 09:27:38 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-21 09:27:38 INFO  ---RUNTIME: Importing and monkey-patching took 6.860971450805664 ms
2022-09-21 09:27:46 INFO  ---RUNTIME: Original pipeline execution took 7489.885568618774 ms (excluding imports and monkey-patching)
2022-09-21 09:27:46 INFO  Starting execution of 1 what-if analyses...
2022-09-21 09:27:46 INFO  Start plan generation for analysis DataCleaning...
2022-09-21 09:27:46 INFO  ---RUNTIME: Plan generation took 0.8304119110107422 ms
2022-09-21 09:27:46 INFO  Estimated runtime of original DAG is 5115.969896316528ms
2022-09-21 09:27:46 INFO  Performing Multi-Query Optimization
2022-09-21 09:27:46 INFO  Estimated unoptimized what-if runtime is 102319.39792633057ms
2022-09-21 09:27:46 INFO  Estimated optimised what-if runtime is 20549.086332321167ms
2022-09-21 09:27:46 INFO  Estimated optimisation runtime saving is 81770.3115940094ms
2022-09-21 09:27:46 INFO  ---RUNTIME: Multi-Query Optimization took 99.01142120361328 ms
2022-09-21 09:27:46 INFO  Executing generated plans
2022-09-21 09:28:13 INFO  ---RUNTIME: Execution took 27684.30256843567 ms
2022-09-21 09:28:13 INFO  Done!
2022-09-21 09:28:13 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-21 09:28:13 INFO  Running instrumented original pipeline...
2022-09-21 09:28:13 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-21 09:28:13 INFO  ---RUNTIME: Importing and monkey-patching took 8.800029754638672 ms
2022-09-21 09:28:21 INFO  ---RUNTIME: Original pipeline execution took 7247.952938079834 ms (excluding imports and monkey-patching)
2022-09-21 09:28:21 INFO  Starting execution of 1 what-if analyses...
2022-09-21 09:28:21 INFO  Start plan generation for analysis DataCleaning...
2022-09-21 09:28:21 INFO  ---RUNTIME: Plan generation took 0.7417201995849609 ms
2022-09-21 09:28:21 INFO  Estimated runtime of original DAG is 4930.246353149414ms
2022-09-21 09:28:21 WARNING Skipping Multi-Query Optimization (instead, only combine execution DAGs)
2022-09-21 09:28:21 WARNING Columns ['review_id'] not present in train DAG after the train test split, only before!
2022-09-21 09:28:21 WARNING This could hint at data leakage!
2022-09-21 09:28:21 INFO  Estimated unoptimised what-if runtime is 98604.92706298828ms
2022-09-21 09:28:21 INFO  ---RUNTIME: Multi-Query Optimization took 106.49514198303223 ms
2022-09-21 09:28:21 INFO  Executing generated plans
2022-09-21 09:30:23 INFO  ---RUNTIME: Execution took 122114.32647705078 ms
2022-09-21 09:30:23 INFO  Done!
2022-09-21 09:30:23 INFO  # Finished -- repetition 3 of 7 
2022-09-21 09:30:23 INFO  # Optimization benchmark for data_cleaning with args [['reviews', 'fast_loading', 'featurization_1', 'logistic_regression']] -- repetition 4 of 7
2022-09-21 09:30:23 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-21 09:30:23 INFO  Running instrumented original pipeline...
2022-09-21 09:30:23 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-21 09:30:23 INFO  ---RUNTIME: Importing and monkey-patching took 6.546497344970703 ms
2022-09-21 09:30:30 INFO  ---RUNTIME: Original pipeline execution took 7160.568475723267 ms (excluding imports and monkey-patching)
2022-09-21 09:30:30 INFO  Starting execution of 1 what-if analyses...
2022-09-21 09:30:30 INFO  Start plan generation for analysis DataCleaning...
2022-09-21 09:30:30 INFO  ---RUNTIME: Plan generation took 0.7178783416748047 ms
2022-09-21 09:30:30 INFO  Estimated runtime of original DAG is 4881.427526473999ms
2022-09-21 09:30:30 INFO  Performing Multi-Query Optimization
2022-09-21 09:30:30 INFO  Estimated unoptimized what-if runtime is 97628.55052947998ms
2022-09-21 09:30:30 INFO  Estimated optimised what-if runtime is 18803.36618423462ms
2022-09-21 09:30:30 INFO  Estimated optimisation runtime saving is 78825.18434524536ms
2022-09-21 09:30:30 INFO  ---RUNTIME: Multi-Query Optimization took 94.5897102355957 ms
2022-09-21 09:30:30 INFO  Executing generated plans
2022-09-21 09:30:55 INFO  ---RUNTIME: Execution took 25194.057941436768 ms
2022-09-21 09:30:55 INFO  Done!
2022-09-21 09:30:55 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-21 09:30:55 INFO  Running instrumented original pipeline...
2022-09-21 09:30:55 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-21 09:30:55 INFO  ---RUNTIME: Importing and monkey-patching took 6.094217300415039 ms
2022-09-21 09:31:03 INFO  ---RUNTIME: Original pipeline execution took 7439.133882522583 ms (excluding imports and monkey-patching)
2022-09-21 09:31:03 INFO  Starting execution of 1 what-if analyses...
2022-09-21 09:31:03 INFO  Start plan generation for analysis DataCleaning...
2022-09-21 09:31:03 INFO  ---RUNTIME: Plan generation took 0.7092952728271484 ms
2022-09-21 09:31:03 INFO  Estimated runtime of original DAG is 4870.2661991119385ms
2022-09-21 09:31:03 WARNING Skipping Multi-Query Optimization (instead, only combine execution DAGs)
2022-09-21 09:31:03 WARNING Columns ['review_id'] not present in train DAG after the train test split, only before!
2022-09-21 09:31:03 WARNING This could hint at data leakage!
2022-09-21 09:31:03 INFO  Estimated unoptimised what-if runtime is 97405.32398223877ms
2022-09-21 09:31:03 INFO  ---RUNTIME: Multi-Query Optimization took 109.00712013244629 ms
2022-09-21 09:31:03 INFO  Executing generated plans
2022-09-21 09:33:05 INFO  ---RUNTIME: Execution took 122300.36067962646 ms
2022-09-21 09:33:05 INFO  Done!
2022-09-21 09:33:05 INFO  # Finished -- repetition 4 of 7 
2022-09-21 09:33:05 INFO  # Optimization benchmark for data_cleaning with args [['reviews', 'fast_loading', 'featurization_1', 'logistic_regression']] -- repetition 5 of 7
2022-09-21 09:33:05 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-21 09:33:05 INFO  Running instrumented original pipeline...
2022-09-21 09:33:05 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-21 09:33:05 INFO  ---RUNTIME: Importing and monkey-patching took 6.637334823608398 ms
2022-09-21 09:33:13 INFO  ---RUNTIME: Original pipeline execution took 7632.472038269043 ms (excluding imports and monkey-patching)
2022-09-21 09:33:13 INFO  Starting execution of 1 what-if analyses...
2022-09-21 09:33:13 INFO  Start plan generation for analysis DataCleaning...
2022-09-21 09:33:13 INFO  ---RUNTIME: Plan generation took 0.728607177734375 ms
2022-09-21 09:33:13 INFO  Estimated runtime of original DAG is 5170.0921058654785ms
2022-09-21 09:33:13 INFO  Performing Multi-Query Optimization
2022-09-21 09:33:13 INFO  Estimated unoptimized what-if runtime is 103401.84211730957ms
2022-09-21 09:33:13 INFO  Estimated optimised what-if runtime is 19891.719579696655ms
2022-09-21 09:33:13 INFO  Estimated optimisation runtime saving is 83510.12253761292ms
2022-09-21 09:33:13 INFO  ---RUNTIME: Multi-Query Optimization took 102.3244857788086 ms
2022-09-21 09:33:13 INFO  Executing generated plans
2022-09-21 09:33:40 INFO  ---RUNTIME: Execution took 26624.716758728027 ms
2022-09-21 09:33:40 INFO  Done!
2022-09-21 09:33:40 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-21 09:33:40 INFO  Running instrumented original pipeline...
2022-09-21 09:33:40 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-21 09:33:40 INFO  ---RUNTIME: Importing and monkey-patching took 6.453514099121094 ms
2022-09-21 09:33:47 INFO  ---RUNTIME: Original pipeline execution took 7305.102348327637 ms (excluding imports and monkey-patching)
2022-09-21 09:33:47 INFO  Starting execution of 1 what-if analyses...
2022-09-21 09:33:47 INFO  Start plan generation for analysis DataCleaning...
2022-09-21 09:33:47 INFO  ---RUNTIME: Plan generation took 0.6892681121826172 ms
2022-09-21 09:33:47 INFO  Estimated runtime of original DAG is 4941.269636154175ms
2022-09-21 09:33:47 WARNING Skipping Multi-Query Optimization (instead, only combine execution DAGs)
2022-09-21 09:33:47 WARNING Columns ['review_id'] not present in train DAG after the train test split, only before!
2022-09-21 09:33:47 WARNING This could hint at data leakage!
2022-09-21 09:33:47 INFO  Estimated unoptimised what-if runtime is 98825.3927230835ms
2022-09-21 09:33:47 INFO  ---RUNTIME: Multi-Query Optimization took 121.76179885864258 ms
2022-09-21 09:33:47 INFO  Executing generated plans
2022-09-21 09:35:50 INFO  ---RUNTIME: Execution took 122958.15563201904 ms
2022-09-21 09:35:50 INFO  Done!
2022-09-21 09:35:50 INFO  # Finished -- repetition 5 of 7 
2022-09-21 09:35:50 INFO  # Optimization benchmark for data_cleaning with args [['reviews', 'fast_loading', 'featurization_1', 'logistic_regression']] -- repetition 6 of 7
2022-09-21 09:35:50 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-21 09:35:50 INFO  Running instrumented original pipeline...
2022-09-21 09:35:50 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-21 09:35:50 INFO  ---RUNTIME: Importing and monkey-patching took 6.707191467285156 ms
2022-09-21 09:35:57 INFO  ---RUNTIME: Original pipeline execution took 7331.844806671143 ms (excluding imports and monkey-patching)
2022-09-21 09:35:57 INFO  Starting execution of 1 what-if analyses...
2022-09-21 09:35:57 INFO  Start plan generation for analysis DataCleaning...
2022-09-21 09:35:57 INFO  ---RUNTIME: Plan generation took 0.7014274597167969 ms
2022-09-21 09:35:57 INFO  Estimated runtime of original DAG is 4960.184097290039ms
2022-09-21 09:35:57 INFO  Performing Multi-Query Optimization
2022-09-21 09:35:57 INFO  Estimated unoptimized what-if runtime is 99203.68194580078ms
2022-09-21 09:35:57 INFO  Estimated optimised what-if runtime is 19524.755001068115ms
2022-09-21 09:35:57 INFO  Estimated optimisation runtime saving is 79678.92694473267ms
2022-09-21 09:35:57 INFO  ---RUNTIME: Multi-Query Optimization took 110.48769950866699 ms
2022-09-21 09:35:57 INFO  Executing generated plans
2022-09-21 09:36:23 INFO  ---RUNTIME: Execution took 25399.641752243042 ms
2022-09-21 09:36:23 INFO  Done!
2022-09-21 09:36:23 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-21 09:36:23 INFO  Running instrumented original pipeline...
2022-09-21 09:36:23 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-21 09:36:23 INFO  ---RUNTIME: Importing and monkey-patching took 6.921529769897461 ms
2022-09-21 09:36:30 INFO  ---RUNTIME: Original pipeline execution took 7179.826974868774 ms (excluding imports and monkey-patching)
2022-09-21 09:36:30 INFO  Starting execution of 1 what-if analyses...
2022-09-21 09:36:30 INFO  Start plan generation for analysis DataCleaning...
2022-09-21 09:36:30 INFO  ---RUNTIME: Plan generation took 0.6823539733886719 ms
2022-09-21 09:36:30 INFO  Estimated runtime of original DAG is 4893.969297409058ms
2022-09-21 09:36:30 WARNING Skipping Multi-Query Optimization (instead, only combine execution DAGs)
2022-09-21 09:36:30 WARNING Columns ['review_id'] not present in train DAG after the train test split, only before!
2022-09-21 09:36:30 WARNING This could hint at data leakage!
2022-09-21 09:36:30 INFO  Estimated unoptimised what-if runtime is 97879.38594818115ms
2022-09-21 09:36:30 INFO  ---RUNTIME: Multi-Query Optimization took 379.92405891418457 ms
2022-09-21 09:36:30 INFO  Executing generated plans
2022-09-21 09:38:33 INFO  ---RUNTIME: Execution took 122818.08257102966 ms
2022-09-21 09:38:33 INFO  Done!
2022-09-21 09:38:33 INFO  # Finished -- repetition 6 of 7 
2022-09-21 09:38:33 INFO  # Optimization benchmark for data_cleaning with args [['reviews', 'fast_loading', 'featurization_1', 'logistic_regression']] -- repetition 7 of 7
2022-09-21 09:38:33 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-21 09:38:33 INFO  Running instrumented original pipeline...
2022-09-21 09:38:33 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-21 09:38:33 INFO  ---RUNTIME: Importing and monkey-patching took 6.26063346862793 ms
2022-09-21 09:38:41 INFO  ---RUNTIME: Original pipeline execution took 7517.569541931152 ms (excluding imports and monkey-patching)
2022-09-21 09:38:41 INFO  Starting execution of 1 what-if analyses...
2022-09-21 09:38:41 INFO  Start plan generation for analysis DataCleaning...
2022-09-21 09:38:41 INFO  ---RUNTIME: Plan generation took 0.6401538848876953 ms
2022-09-21 09:38:41 INFO  Estimated runtime of original DAG is 5091.939210891724ms
2022-09-21 09:38:41 INFO  Performing Multi-Query Optimization
2022-09-21 09:38:41 INFO  Estimated unoptimized what-if runtime is 101838.78421783447ms
2022-09-21 09:38:41 INFO  Estimated optimised what-if runtime is 20151.582717895508ms
2022-09-21 09:38:41 INFO  Estimated optimisation runtime saving is 81687.20149993896ms
2022-09-21 09:38:41 INFO  ---RUNTIME: Multi-Query Optimization took 114.70365524291992 ms
2022-09-21 09:38:41 INFO  Executing generated plans
2022-09-21 09:39:07 INFO  ---RUNTIME: Execution took 25788.963556289673 ms
2022-09-21 09:39:07 INFO  Done!
2022-09-21 09:39:07 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-21 09:39:07 INFO  Running instrumented original pipeline...
2022-09-21 09:39:07 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-21 09:39:07 INFO  ---RUNTIME: Importing and monkey-patching took 6.437540054321289 ms
2022-09-21 09:39:14 INFO  ---RUNTIME: Original pipeline execution took 7265.977382659912 ms (excluding imports and monkey-patching)
2022-09-21 09:39:14 INFO  Starting execution of 1 what-if analyses...
2022-09-21 09:39:14 INFO  Start plan generation for analysis DataCleaning...
2022-09-21 09:39:14 INFO  ---RUNTIME: Plan generation took 0.6537437438964844 ms
2022-09-21 09:39:14 INFO  Estimated runtime of original DAG is 4924.102544784546ms
2022-09-21 09:39:14 WARNING Skipping Multi-Query Optimization (instead, only combine execution DAGs)
2022-09-21 09:39:14 WARNING Columns ['review_id'] not present in train DAG after the train test split, only before!
2022-09-21 09:39:14 WARNING This could hint at data leakage!
2022-09-21 09:39:14 INFO  Estimated unoptimised what-if runtime is 98482.05089569092ms
2022-09-21 09:39:14 INFO  ---RUNTIME: Multi-Query Optimization took 144.0873146057129 ms
2022-09-21 09:39:14 INFO  Executing generated plans
2022-09-21 09:41:16 INFO  ---RUNTIME: Execution took 121780.85470199585 ms
2022-09-21 09:41:16 INFO  Done!
2022-09-21 09:41:16 INFO  # Finished -- repetition 7 of 7 
2022-09-21 09:41:16 INFO  # Final results after all repetitions
2022-09-21 09:41:16 INFO     repetition  ... no_opt_what_if_execution_combined_model_training
0           0  ...                                      2482.943535
1           1  ...                                      2595.325232
2           2  ...                                      2500.669956
3           3  ...                                      2787.602186
4           4  ...                                      2510.576725
5           5  ...                                      2548.596382
6           6  ...                                      2495.509624

[7 rows x 26 columns]
taskset -c 32-40 PROTOCOL_BUFFERS_PYTHON_IMPLEMENTATION=python python3.9 benchmarks_end_to_end.py data_cleaning reviews fast_loading featurization_1 xgboost
2022-09-21 09:41:18.837751: W tensorflow/stream_executor/platform/default/dso_loader.cc:64] Could not load dynamic library 'libcudart.so.11.0'; dlerror: libcudart.so.11.0: cannot open shared object file: No such file or directory; LD_LIBRARY_PATH: /home/sgrafbe/mlwhatif/venv/lib/python3.9/site-packages/cv2/../../lib64:
2022-09-21 09:41:18.837799: I tensorflow/stream_executor/cuda/cudart_stub.cc:29] Ignore above cudart dlerror if you do not have a GPU set up on your machine.
2022-09-21 09:41:20 INFO  Patching sys.argv with ['mlwhatif', 'reviews', 'fast_loading', 'featurization_1', 'xgboost']
2022-09-21 09:41:20 INFO  Running instrumented original pipeline...
2022-09-21 09:41:20 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-21 09:41:20 INFO  ---RUNTIME: Importing and monkey-patching took 122.43890762329102 ms
2022-09-21 09:42:44 INFO  ---RUNTIME: Original pipeline execution took 84498.12364578247 ms (excluding imports and monkey-patching)
2022-09-21 09:42:44 INFO  Starting execution of 0 what-if analyses...
2022-09-21 09:42:44 INFO  Estimated runtime of original DAG is 82233.99591445923ms
2022-09-21 09:42:44 INFO  Performing Multi-Query Optimization
2022-09-21 09:42:44 INFO  Estimated unoptimized what-if runtime is 0ms
2022-09-21 09:42:44 INFO  Estimated optimised what-if runtime is 0ms
2022-09-21 09:42:44 INFO  Estimated optimisation runtime saving is 0ms
2022-09-21 09:42:44 INFO  ---RUNTIME: Multi-Query Optimization took 0.5118846893310547 ms
2022-09-21 09:42:44 INFO  Executing generated plans
2022-09-21 09:42:44 INFO  ---RUNTIME: Execution took 0.025033950805664062 ms
2022-09-21 09:42:44 INFO  Done!
2022-09-21 09:42:44 INFO  # Optimization benchmark for data_cleaning with args [['reviews', 'fast_loading', 'featurization_1', 'xgboost']] -- repetition 1 of 7
2022-09-21 09:42:44 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-21 09:42:44 INFO  Running instrumented original pipeline...
2022-09-21 09:42:44 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-21 09:42:44 INFO  ---RUNTIME: Importing and monkey-patching took 6.110906600952148 ms
2022-09-21 09:42:54 INFO  ---RUNTIME: Original pipeline execution took 9386.850833892822 ms (excluding imports and monkey-patching)
2022-09-21 09:42:54 INFO  Starting execution of 1 what-if analyses...
2022-09-21 09:42:54 INFO  Start plan generation for analysis DataCleaning...
2022-09-21 09:42:54 INFO  ---RUNTIME: Plan generation took 0.8530616760253906 ms
2022-09-21 09:42:54 INFO  Estimated runtime of original DAG is 6902.135372161865ms
2022-09-21 09:42:54 INFO  Performing Multi-Query Optimization
2022-09-21 09:42:54 INFO  Estimated unoptimized what-if runtime is 138042.7074432373ms
2022-09-21 09:42:54 INFO  Estimated optimised what-if runtime is 57590.537548065186ms
2022-09-21 09:42:54 INFO  Estimated optimisation runtime saving is 80452.16989517212ms
2022-09-21 09:42:54 INFO  ---RUNTIME: Multi-Query Optimization took 101.99832916259766 ms
2022-09-21 09:42:54 INFO  Executing generated plans
2022-09-21 09:43:49 INFO  ---RUNTIME: Execution took 55110.92448234558 ms
2022-09-21 09:43:49 INFO  Done!
2022-09-21 09:43:49 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-21 09:43:49 INFO  Running instrumented original pipeline...
2022-09-21 09:43:49 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-21 09:43:49 INFO  ---RUNTIME: Importing and monkey-patching took 7.288932800292969 ms
2022-09-21 09:43:57 INFO  ---RUNTIME: Original pipeline execution took 8394.737720489502 ms (excluding imports and monkey-patching)
2022-09-21 09:43:57 INFO  Starting execution of 1 what-if analyses...
2022-09-21 09:43:57 INFO  Start plan generation for analysis DataCleaning...
2022-09-21 09:43:57 INFO  ---RUNTIME: Plan generation took 0.7388591766357422 ms
2022-09-21 09:43:57 INFO  Estimated runtime of original DAG is 5912.1599197387695ms
2022-09-21 09:43:57 WARNING Skipping Multi-Query Optimization (instead, only combine execution DAGs)
2022-09-21 09:43:57 WARNING Columns ['review_id'] not present in train DAG after the train test split, only before!
2022-09-21 09:43:57 WARNING This could hint at data leakage!
2022-09-21 09:43:57 INFO  Estimated unoptimised what-if runtime is 118243.19839477539ms
2022-09-21 09:43:57 INFO  ---RUNTIME: Multi-Query Optimization took 104.34150695800781 ms
2022-09-21 09:43:57 INFO  Executing generated plans
2022-09-21 09:46:54 INFO  ---RUNTIME: Execution took 176267.1730518341 ms
2022-09-21 09:46:54 INFO  Done!
2022-09-21 09:46:54 INFO  # Finished -- repetition 1 of 7 
2022-09-21 09:46:54 INFO  # Optimization benchmark for data_cleaning with args [['reviews', 'fast_loading', 'featurization_1', 'xgboost']] -- repetition 2 of 7
2022-09-21 09:46:54 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-21 09:46:54 INFO  Running instrumented original pipeline...
2022-09-21 09:46:54 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-21 09:46:54 INFO  ---RUNTIME: Importing and monkey-patching took 6.41322135925293 ms
2022-09-21 09:47:01 INFO  ---RUNTIME: Original pipeline execution took 7802.942752838135 ms (excluding imports and monkey-patching)
2022-09-21 09:47:01 INFO  Starting execution of 1 what-if analyses...
2022-09-21 09:47:01 INFO  Start plan generation for analysis DataCleaning...
2022-09-21 09:47:01 INFO  ---RUNTIME: Plan generation took 0.7359981536865234 ms
2022-09-21 09:47:01 INFO  Estimated runtime of original DAG is 5584.415435791016ms
2022-09-21 09:47:01 INFO  Performing Multi-Query Optimization
2022-09-21 09:47:02 INFO  Estimated unoptimized what-if runtime is 111688.30871582031ms
2022-09-21 09:47:02 INFO  Estimated optimised what-if runtime is 33677.30116844177ms
2022-09-21 09:47:02 INFO  Estimated optimisation runtime saving is 78011.00754737854ms
2022-09-21 09:47:02 INFO  ---RUNTIME: Multi-Query Optimization took 92.03362464904785 ms
2022-09-21 09:47:02 INFO  Executing generated plans
2022-09-21 09:47:43 INFO  ---RUNTIME: Execution took 41929.73709106445 ms
2022-09-21 09:47:43 INFO  Done!
2022-09-21 09:47:43 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-21 09:47:43 INFO  Running instrumented original pipeline...
2022-09-21 09:47:44 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-21 09:47:44 INFO  ---RUNTIME: Importing and monkey-patching took 5.768060684204102 ms
2022-09-21 09:48:22 INFO  ---RUNTIME: Original pipeline execution took 38851.36604309082 ms (excluding imports and monkey-patching)
2022-09-21 09:48:22 INFO  Starting execution of 1 what-if analyses...
2022-09-21 09:48:22 INFO  Start plan generation for analysis DataCleaning...
2022-09-21 09:48:22 INFO  ---RUNTIME: Plan generation took 0.7433891296386719 ms
2022-09-21 09:48:22 INFO  Estimated runtime of original DAG is 36626.02424621582ms
2022-09-21 09:48:22 WARNING Skipping Multi-Query Optimization (instead, only combine execution DAGs)
2022-09-21 09:48:22 WARNING Columns ['review_id'] not present in train DAG after the train test split, only before!
2022-09-21 09:48:22 WARNING This could hint at data leakage!
2022-09-21 09:48:23 INFO  Estimated unoptimised what-if runtime is 732520.4849243164ms
2022-09-21 09:48:23 INFO  ---RUNTIME: Multi-Query Optimization took 323.78077507019043 ms
2022-09-21 09:48:23 INFO  Executing generated plans
2022-09-21 09:51:21 INFO  ---RUNTIME: Execution took 178050.3466129303 ms
2022-09-21 09:51:21 INFO  Done!
2022-09-21 09:51:21 INFO  # Finished -- repetition 2 of 7 
2022-09-21 09:51:21 INFO  # Optimization benchmark for data_cleaning with args [['reviews', 'fast_loading', 'featurization_1', 'xgboost']] -- repetition 3 of 7
2022-09-21 09:51:21 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-21 09:51:21 INFO  Running instrumented original pipeline...
2022-09-21 09:51:21 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-21 09:51:21 INFO  ---RUNTIME: Importing and monkey-patching took 6.344318389892578 ms
2022-09-21 09:51:29 INFO  ---RUNTIME: Original pipeline execution took 7866.517782211304 ms (excluding imports and monkey-patching)
2022-09-21 09:51:29 INFO  Starting execution of 1 what-if analyses...
2022-09-21 09:51:29 INFO  Start plan generation for analysis DataCleaning...
2022-09-21 09:51:29 INFO  ---RUNTIME: Plan generation took 0.7658004760742188 ms
2022-09-21 09:51:29 INFO  Estimated runtime of original DAG is 5612.346172332764ms
2022-09-21 09:51:29 INFO  Performing Multi-Query Optimization
2022-09-21 09:51:29 INFO  Estimated unoptimized what-if runtime is 112246.92344665527ms
2022-09-21 09:51:29 INFO  Estimated optimised what-if runtime is 33872.93529510498ms
2022-09-21 09:51:29 INFO  Estimated optimisation runtime saving is 78373.9881515503ms
2022-09-21 09:51:29 INFO  ---RUNTIME: Multi-Query Optimization took 90.77811241149902 ms
2022-09-21 09:51:29 INFO  Executing generated plans
2022-09-21 09:52:10 INFO  ---RUNTIME: Execution took 41181.37431144714 ms
2022-09-21 09:52:10 INFO  Done!
2022-09-21 09:52:10 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-21 09:52:10 INFO  Running instrumented original pipeline...
2022-09-21 09:52:10 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-21 09:52:10 INFO  ---RUNTIME: Importing and monkey-patching took 5.79071044921875 ms
2022-09-21 09:52:23 INFO  ---RUNTIME: Original pipeline execution took 13170.554399490356 ms (excluding imports and monkey-patching)
2022-09-21 09:52:23 INFO  Starting execution of 1 what-if analyses...
2022-09-21 09:52:23 INFO  Start plan generation for analysis DataCleaning...
2022-09-21 09:52:23 INFO  ---RUNTIME: Plan generation took 0.6818771362304688 ms
2022-09-21 09:52:23 INFO  Estimated runtime of original DAG is 10927.084922790527ms
2022-09-21 09:52:23 WARNING Skipping Multi-Query Optimization (instead, only combine execution DAGs)
2022-09-21 09:52:23 WARNING Columns ['review_id'] not present in train DAG after the train test split, only before!
2022-09-21 09:52:23 WARNING This could hint at data leakage!
2022-09-21 09:52:23 INFO  Estimated unoptimised what-if runtime is 218541.69845581055ms
2022-09-21 09:52:23 INFO  ---RUNTIME: Multi-Query Optimization took 104.88057136535645 ms
2022-09-21 09:52:23 INFO  Executing generated plans
2022-09-21 09:54:40 INFO  ---RUNTIME: Execution took 136574.49436187744 ms
2022-09-21 09:54:40 INFO  Done!
2022-09-21 09:54:40 INFO  # Finished -- repetition 3 of 7 
2022-09-21 09:54:40 INFO  # Optimization benchmark for data_cleaning with args [['reviews', 'fast_loading', 'featurization_1', 'xgboost']] -- repetition 4 of 7
2022-09-21 09:54:40 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-21 09:54:40 INFO  Running instrumented original pipeline...
2022-09-21 09:54:40 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-21 09:54:40 INFO  ---RUNTIME: Importing and monkey-patching took 7.343053817749023 ms
2022-09-21 09:54:48 INFO  ---RUNTIME: Original pipeline execution took 8002.028465270996 ms (excluding imports and monkey-patching)
2022-09-21 09:54:48 INFO  Starting execution of 1 what-if analyses...
2022-09-21 09:54:48 INFO  Start plan generation for analysis DataCleaning...
2022-09-21 09:54:48 INFO  ---RUNTIME: Plan generation took 0.7619857788085938 ms
2022-09-21 09:54:48 INFO  Estimated runtime of original DAG is 5710.193634033203ms
2022-09-21 09:54:48 INFO  Performing Multi-Query Optimization
2022-09-21 09:54:48 INFO  Estimated unoptimized what-if runtime is 114203.87268066406ms
2022-09-21 09:54:48 INFO  Estimated optimised what-if runtime is 34237.69688606262ms
2022-09-21 09:54:48 INFO  Estimated optimisation runtime saving is 79966.17579460144ms
2022-09-21 09:54:48 INFO  ---RUNTIME: Multi-Query Optimization took 92.55599975585938 ms
2022-09-21 09:54:48 INFO  Executing generated plans
2022-09-21 09:55:30 INFO  ---RUNTIME: Execution took 42101.95231437683 ms
2022-09-21 09:55:30 INFO  Done!
2022-09-21 09:55:30 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-21 09:55:30 INFO  Running instrumented original pipeline...
2022-09-21 09:55:30 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-21 09:55:30 INFO  ---RUNTIME: Importing and monkey-patching took 7.0133209228515625 ms
2022-09-21 09:56:17 INFO  ---RUNTIME: Original pipeline execution took 47375.415325164795 ms (excluding imports and monkey-patching)
2022-09-21 09:56:17 INFO  Starting execution of 1 what-if analyses...
2022-09-21 09:56:17 INFO  Start plan generation for analysis DataCleaning...
2022-09-21 09:56:17 INFO  ---RUNTIME: Plan generation took 0.7693767547607422 ms
2022-09-21 09:56:17 INFO  Estimated runtime of original DAG is 44843.10746192932ms
2022-09-21 09:56:17 WARNING Skipping Multi-Query Optimization (instead, only combine execution DAGs)
2022-09-21 09:56:17 WARNING Columns ['review_id'] not present in train DAG after the train test split, only before!
2022-09-21 09:56:17 WARNING This could hint at data leakage!
2022-09-21 09:56:17 INFO  Estimated unoptimised what-if runtime is 896862.1492385864ms
2022-09-21 09:56:17 INFO  ---RUNTIME: Multi-Query Optimization took 107.43260383605957 ms
2022-09-21 09:56:17 INFO  Executing generated plans
2022-09-21 09:59:30 INFO  ---RUNTIME: Execution took 192081.9947719574 ms
2022-09-21 09:59:30 INFO  Done!
2022-09-21 09:59:30 INFO  # Finished -- repetition 4 of 7 
2022-09-21 09:59:30 INFO  # Optimization benchmark for data_cleaning with args [['reviews', 'fast_loading', 'featurization_1', 'xgboost']] -- repetition 5 of 7
2022-09-21 09:59:30 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-21 09:59:30 INFO  Running instrumented original pipeline...
2022-09-21 09:59:30 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-21 09:59:30 INFO  ---RUNTIME: Importing and monkey-patching took 6.939411163330078 ms
2022-09-21 09:59:38 INFO  ---RUNTIME: Original pipeline execution took 8010.740041732788 ms (excluding imports and monkey-patching)
2022-09-21 09:59:38 INFO  Starting execution of 1 what-if analyses...
2022-09-21 09:59:38 INFO  Start plan generation for analysis DataCleaning...
2022-09-21 09:59:38 INFO  ---RUNTIME: Plan generation took 0.7154941558837891 ms
2022-09-21 09:59:38 INFO  Estimated runtime of original DAG is 5714.494228363037ms
2022-09-21 09:59:38 INFO  Performing Multi-Query Optimization
2022-09-21 09:59:38 INFO  Estimated unoptimized what-if runtime is 114289.88456726074ms
2022-09-21 09:59:38 INFO  Estimated optimised what-if runtime is 33447.075605392456ms
2022-09-21 09:59:38 INFO  Estimated optimisation runtime saving is 80842.80896186829ms
2022-09-21 09:59:38 INFO  ---RUNTIME: Multi-Query Optimization took 91.24040603637695 ms
2022-09-21 09:59:38 INFO  Executing generated plans
2022-09-21 10:00:25 INFO  ---RUNTIME: Execution took 47310.42981147766 ms
2022-09-21 10:00:25 INFO  Done!
2022-09-21 10:00:25 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-21 10:00:25 INFO  Running instrumented original pipeline...
2022-09-21 10:00:25 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-21 10:00:25 INFO  ---RUNTIME: Importing and monkey-patching took 9.601354598999023 ms
2022-09-21 10:01:25 INFO  ---RUNTIME: Original pipeline execution took 59903.16939353943 ms (excluding imports and monkey-patching)
2022-09-21 10:01:25 INFO  Starting execution of 1 what-if analyses...
2022-09-21 10:01:25 INFO  Start plan generation for analysis DataCleaning...
2022-09-21 10:01:25 INFO  ---RUNTIME: Plan generation took 0.8444786071777344 ms
2022-09-21 10:01:25 INFO  Estimated runtime of original DAG is 57572.21794128418ms
2022-09-21 10:01:25 WARNING Skipping Multi-Query Optimization (instead, only combine execution DAGs)
2022-09-21 10:01:25 WARNING Columns ['review_id'] not present in train DAG after the train test split, only before!
2022-09-21 10:01:25 WARNING This could hint at data leakage!
2022-09-21 10:01:25 INFO  Estimated unoptimised what-if runtime is 1151444.3588256836ms
2022-09-21 10:01:25 INFO  ---RUNTIME: Multi-Query Optimization took 106.38546943664551 ms
2022-09-21 10:01:25 INFO  Executing generated plans
2022-09-21 10:03:42 INFO  ---RUNTIME: Execution took 137228.7163734436 ms
2022-09-21 10:03:42 INFO  Done!
2022-09-21 10:03:42 INFO  # Finished -- repetition 5 of 7 
2022-09-21 10:03:42 INFO  # Optimization benchmark for data_cleaning with args [['reviews', 'fast_loading', 'featurization_1', 'xgboost']] -- repetition 6 of 7
2022-09-21 10:03:42 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-21 10:03:42 INFO  Running instrumented original pipeline...
2022-09-21 10:03:42 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-21 10:03:42 INFO  ---RUNTIME: Importing and monkey-patching took 6.667613983154297 ms
2022-09-21 10:04:31 INFO  ---RUNTIME: Original pipeline execution took 49174.415588378906 ms (excluding imports and monkey-patching)
2022-09-21 10:04:31 INFO  Starting execution of 1 what-if analyses...
2022-09-21 10:04:31 INFO  Start plan generation for analysis DataCleaning...
2022-09-21 10:04:31 INFO  ---RUNTIME: Plan generation took 0.7734298706054688 ms
2022-09-21 10:04:31 INFO  Estimated runtime of original DAG is 46862.63704299927ms
2022-09-21 10:04:31 INFO  Performing Multi-Query Optimization
2022-09-21 10:04:32 INFO  Estimated unoptimized what-if runtime is 937252.7408599854ms
2022-09-21 10:04:32 INFO  Estimated optimised what-if runtime is 857587.3565673828ms
2022-09-21 10:04:32 INFO  Estimated optimisation runtime saving is 79665.38429260254ms
2022-09-21 10:04:32 INFO  ---RUNTIME: Multi-Query Optimization took 92.10038185119629 ms
2022-09-21 10:04:32 INFO  Executing generated plans
2022-09-21 10:06:55 INFO  ---RUNTIME: Execution took 143381.34384155273 ms
2022-09-21 10:06:55 INFO  Done!
2022-09-21 10:06:55 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-21 10:06:55 INFO  Running instrumented original pipeline...
2022-09-21 10:06:55 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-21 10:06:55 INFO  ---RUNTIME: Importing and monkey-patching took 6.5765380859375 ms
2022-09-21 10:07:03 INFO  ---RUNTIME: Original pipeline execution took 7942.0976638793945 ms (excluding imports and monkey-patching)
2022-09-21 10:07:03 INFO  Starting execution of 1 what-if analyses...
2022-09-21 10:07:03 INFO  Start plan generation for analysis DataCleaning...
2022-09-21 10:07:03 INFO  ---RUNTIME: Plan generation took 0.6749629974365234 ms
2022-09-21 10:07:03 INFO  Estimated runtime of original DAG is 5683.602333068848ms
2022-09-21 10:07:03 WARNING Skipping Multi-Query Optimization (instead, only combine execution DAGs)
2022-09-21 10:07:03 WARNING Columns ['review_id'] not present in train DAG after the train test split, only before!
2022-09-21 10:07:03 WARNING This could hint at data leakage!
2022-09-21 10:07:03 INFO  Estimated unoptimised what-if runtime is 113672.04666137695ms
2022-09-21 10:07:03 INFO  ---RUNTIME: Multi-Query Optimization took 376.91807746887207 ms
2022-09-21 10:07:03 INFO  Executing generated plans
2022-09-21 10:09:20 INFO  ---RUNTIME: Execution took 136894.9477672577 ms
2022-09-21 10:09:20 INFO  Done!
2022-09-21 10:09:20 INFO  # Finished -- repetition 6 of 7 
2022-09-21 10:09:20 INFO  # Optimization benchmark for data_cleaning with args [['reviews', 'fast_loading', 'featurization_1', 'xgboost']] -- repetition 7 of 7
2022-09-21 10:09:20 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-21 10:09:20 INFO  Running instrumented original pipeline...
2022-09-21 10:09:20 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-21 10:09:20 INFO  ---RUNTIME: Importing and monkey-patching took 6.4411163330078125 ms
2022-09-21 10:09:28 INFO  ---RUNTIME: Original pipeline execution took 7959.1224193573 ms (excluding imports and monkey-patching)
2022-09-21 10:09:28 INFO  Starting execution of 1 what-if analyses...
2022-09-21 10:09:28 INFO  Start plan generation for analysis DataCleaning...
2022-09-21 10:09:28 INFO  ---RUNTIME: Plan generation took 0.70953369140625 ms
2022-09-21 10:09:28 INFO  Estimated runtime of original DAG is 5649.211645126343ms
2022-09-21 10:09:28 INFO  Performing Multi-Query Optimization
2022-09-21 10:09:28 INFO  Estimated unoptimized what-if runtime is 112984.23290252686ms
2022-09-21 10:09:28 INFO  Estimated optimised what-if runtime is 33996.753215789795ms
2022-09-21 10:09:28 INFO  Estimated optimisation runtime saving is 78987.47968673706ms
2022-09-21 10:09:28 INFO  ---RUNTIME: Multi-Query Optimization took 90.52824974060059 ms
2022-09-21 10:09:28 INFO  Executing generated plans
2022-09-21 10:10:10 INFO  ---RUNTIME: Execution took 42055.60922622681 ms
2022-09-21 10:10:10 INFO  Done!
2022-09-21 10:10:10 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-21 10:10:10 INFO  Running instrumented original pipeline...
2022-09-21 10:10:10 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-21 10:10:10 INFO  ---RUNTIME: Importing and monkey-patching took 6.398916244506836 ms
2022-09-21 10:10:18 INFO  ---RUNTIME: Original pipeline execution took 7952.9101848602295 ms (excluding imports and monkey-patching)
2022-09-21 10:10:18 INFO  Starting execution of 1 what-if analyses...
2022-09-21 10:10:18 INFO  Start plan generation for analysis DataCleaning...
2022-09-21 10:10:18 INFO  ---RUNTIME: Plan generation took 0.7121562957763672 ms
2022-09-21 10:10:18 INFO  Estimated runtime of original DAG is 5639.559268951416ms
2022-09-21 10:10:18 WARNING Skipping Multi-Query Optimization (instead, only combine execution DAGs)
2022-09-21 10:10:18 WARNING Columns ['review_id'] not present in train DAG after the train test split, only before!
2022-09-21 10:10:18 WARNING This could hint at data leakage!
2022-09-21 10:10:18 INFO  Estimated unoptimised what-if runtime is 112791.18537902832ms
2022-09-21 10:10:18 INFO  ---RUNTIME: Multi-Query Optimization took 105.34381866455078 ms
2022-09-21 10:10:18 INFO  Executing generated plans
2022-09-21 10:12:35 INFO  ---RUNTIME: Execution took 137001.55353546143 ms
2022-09-21 10:12:35 INFO  Done!
2022-09-21 10:12:35 INFO  # Finished -- repetition 7 of 7 
2022-09-21 10:12:35 INFO  # Final results after all repetitions
2022-09-21 10:12:35 INFO     repetition  ... no_opt_what_if_execution_combined_model_training
0           0  ...                                     56452.480316
1           1  ...                                     58875.420094
2           2  ...                                     18135.063648
3           3  ...                                     72954.228163
4           4  ...                                     19035.365582
5           5  ...                                     18939.231396
6           6  ...                                     18767.261744

[7 rows x 26 columns]
taskset -c 32-40 PROTOCOL_BUFFERS_PYTHON_IMPLEMENTATION=python python3.9 benchmarks_end_to_end.py data_cleaning reviews fast_loading featurization_1 neural_network
2022-09-21 10:12:38.194534: W tensorflow/stream_executor/platform/default/dso_loader.cc:64] Could not load dynamic library 'libcudart.so.11.0'; dlerror: libcudart.so.11.0: cannot open shared object file: No such file or directory; LD_LIBRARY_PATH: /home/sgrafbe/mlwhatif/venv/lib/python3.9/site-packages/cv2/../../lib64:
2022-09-21 10:12:38.194583: I tensorflow/stream_executor/cuda/cudart_stub.cc:29] Ignore above cudart dlerror if you do not have a GPU set up on your machine.
2022-09-21 10:12:39 INFO  Patching sys.argv with ['mlwhatif', 'reviews', 'fast_loading', 'featurization_1', 'neural_network']
2022-09-21 10:12:39 INFO  Running instrumented original pipeline...
2022-09-21 10:12:39 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-21 10:12:39 INFO  ---RUNTIME: Importing and monkey-patching took 131.33597373962402 ms
2022-09-21 10:12:45.270034: W tensorflow/stream_executor/platform/default/dso_loader.cc:64] Could not load dynamic library 'libcuda.so.1'; dlerror: libcuda.so.1: cannot open shared object file: No such file or directory; LD_LIBRARY_PATH: /home/sgrafbe/mlwhatif/venv/lib/python3.9/site-packages/cv2/../../lib64:
2022-09-21 10:12:45.270075: W tensorflow/stream_executor/cuda/cuda_driver.cc:326] failed call to cuInit: UNKNOWN ERROR (303)
2022-09-21 10:12:45.270103: I tensorflow/stream_executor/cuda/cuda_diagnostics.cc:156] kernel driver does not appear to be running on this host (angus): /proc/driver/nvidia/version does not exist
2022-09-21 10:12:45.270634: I tensorflow/core/platform/cpu_feature_guard.cc:142] This TensorFlow binary is optimized with oneAPI Deep Neural Network Library (oneDNN) to use the following CPU instructions in performance-critical operations:  AVX2 FMA
To enable them in other operations, rebuild TensorFlow with the appropriate compiler flags.
2022-09-21 10:12:45.511330: I tensorflow/compiler/mlir/mlir_graph_optimization_pass.cc:176] None of the MLIR Optimization Passes are enabled (registered 2)
2022-09-21 10:12:45.523179: I tensorflow/core/platform/profile_utils/cpu_utils.cc:114] CPU Frequency: 2595130000 Hz
2022-09-21 10:12:50 INFO  ---RUNTIME: Original pipeline execution took 10678.10320854187 ms (excluding imports and monkey-patching)
2022-09-21 10:12:50 INFO  Starting execution of 0 what-if analyses...
2022-09-21 10:12:50 INFO  Estimated runtime of original DAG is 8414.132356643677ms
2022-09-21 10:12:50 INFO  Performing Multi-Query Optimization
2022-09-21 10:12:50 INFO  Estimated unoptimized what-if runtime is 0ms
2022-09-21 10:12:50 INFO  Estimated optimised what-if runtime is 0ms
2022-09-21 10:12:50 INFO  Estimated optimisation runtime saving is 0ms
2022-09-21 10:12:50 INFO  ---RUNTIME: Multi-Query Optimization took 0.5071163177490234 ms
2022-09-21 10:12:50 INFO  Executing generated plans
2022-09-21 10:12:50 INFO  ---RUNTIME: Execution took 0.023365020751953125 ms
2022-09-21 10:12:50 INFO  Done!
2022-09-21 10:12:50 INFO  # Optimization benchmark for data_cleaning with args [['reviews', 'fast_loading', 'featurization_1', 'neural_network']] -- repetition 1 of 7
2022-09-21 10:12:50 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-21 10:12:50 INFO  Running instrumented original pipeline...
2022-09-21 10:12:50 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-21 10:12:50 INFO  ---RUNTIME: Importing and monkey-patching took 5.254030227661133 ms
2022-09-21 10:13:00 INFO  ---RUNTIME: Original pipeline execution took 10408.782243728638 ms (excluding imports and monkey-patching)
2022-09-21 10:13:00 INFO  Starting execution of 1 what-if analyses...
2022-09-21 10:13:00 INFO  Start plan generation for analysis DataCleaning...
2022-09-21 10:13:00 INFO  ---RUNTIME: Plan generation took 0.6444454193115234 ms
2022-09-21 10:13:00 INFO  Estimated runtime of original DAG is 8205.136060714722ms
2022-09-21 10:13:00 INFO  Performing Multi-Query Optimization
2022-09-21 10:13:00 INFO  Estimated unoptimized what-if runtime is 164102.72121429443ms
2022-09-21 10:13:00 INFO  Estimated optimised what-if runtime is 86207.69715309143ms
2022-09-21 10:13:00 INFO  Estimated optimisation runtime saving is 77895.024061203ms
2022-09-21 10:13:00 INFO  ---RUNTIME: Multi-Query Optimization took 92.94795989990234 ms
2022-09-21 10:13:00 INFO  Executing generated plans
2022-09-21 10:14:35 INFO  ---RUNTIME: Execution took 95008.81695747375 ms
2022-09-21 10:14:35 INFO  Done!
2022-09-21 10:14:35 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-21 10:14:35 INFO  Running instrumented original pipeline...
2022-09-21 10:14:35 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-21 10:14:35 INFO  ---RUNTIME: Importing and monkey-patching took 5.972862243652344 ms
2022-09-21 10:14:46 INFO  ---RUNTIME: Original pipeline execution took 10449.95641708374 ms (excluding imports and monkey-patching)
2022-09-21 10:14:46 INFO  Starting execution of 1 what-if analyses...
2022-09-21 10:14:46 INFO  Start plan generation for analysis DataCleaning...
2022-09-21 10:14:46 INFO  ---RUNTIME: Plan generation took 0.6623268127441406 ms
2022-09-21 10:14:46 INFO  Estimated runtime of original DAG is 8267.855644226074ms
2022-09-21 10:14:46 WARNING Skipping Multi-Query Optimization (instead, only combine execution DAGs)
2022-09-21 10:14:46 WARNING Columns ['review_id'] not present in train DAG after the train test split, only before!
2022-09-21 10:14:46 WARNING This could hint at data leakage!
2022-09-21 10:14:46 INFO  Estimated unoptimised what-if runtime is 165357.11288452148ms
2022-09-21 10:14:46 INFO  ---RUNTIME: Multi-Query Optimization took 104.59589958190918 ms
2022-09-21 10:14:46 INFO  Executing generated plans
2022-09-21 10:17:56 INFO  ---RUNTIME: Execution took 190382.3425769806 ms
2022-09-21 10:17:56 INFO  Done!
2022-09-21 10:17:56 INFO  # Finished -- repetition 1 of 7 
2022-09-21 10:17:56 INFO  # Optimization benchmark for data_cleaning with args [['reviews', 'fast_loading', 'featurization_1', 'neural_network']] -- repetition 2 of 7
2022-09-21 10:17:56 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-21 10:17:56 INFO  Running instrumented original pipeline...
2022-09-21 10:17:56 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-21 10:17:56 INFO  ---RUNTIME: Importing and monkey-patching took 6.438970565795898 ms
2022-09-21 10:18:07 INFO  ---RUNTIME: Original pipeline execution took 10519.234657287598 ms (excluding imports and monkey-patching)
2022-09-21 10:18:07 INFO  Starting execution of 1 what-if analyses...
2022-09-21 10:18:07 INFO  Start plan generation for analysis DataCleaning...
2022-09-21 10:18:07 INFO  ---RUNTIME: Plan generation took 0.5838871002197266 ms
2022-09-21 10:18:07 INFO  Estimated runtime of original DAG is 8292.577028274536ms
2022-09-21 10:18:07 INFO  Performing Multi-Query Optimization
2022-09-21 10:18:07 INFO  Estimated unoptimized what-if runtime is 165851.54056549072ms
2022-09-21 10:18:07 INFO  Estimated optimised what-if runtime is 88090.58880805969ms
2022-09-21 10:18:07 INFO  Estimated optimisation runtime saving is 77760.95175743103ms
2022-09-21 10:18:07 INFO  ---RUNTIME: Multi-Query Optimization took 93.61624717712402 ms
2022-09-21 10:18:07 INFO  Executing generated plans
2022-09-21 10:19:42 INFO  ---RUNTIME: Execution took 95486.54747009277 ms
2022-09-21 10:19:42 INFO  Done!
2022-09-21 10:19:42 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-21 10:19:42 INFO  Running instrumented original pipeline...
2022-09-21 10:19:42 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-21 10:19:42 INFO  ---RUNTIME: Importing and monkey-patching took 5.998134613037109 ms
2022-09-21 10:19:53 INFO  ---RUNTIME: Original pipeline execution took 11070.883750915527 ms (excluding imports and monkey-patching)
2022-09-21 10:19:53 INFO  Starting execution of 1 what-if analyses...
2022-09-21 10:19:53 INFO  Start plan generation for analysis DataCleaning...
2022-09-21 10:19:53 INFO  ---RUNTIME: Plan generation took 0.6144046783447266 ms
2022-09-21 10:19:53 INFO  Estimated runtime of original DAG is 8843.16372871399ms
2022-09-21 10:19:53 WARNING Skipping Multi-Query Optimization (instead, only combine execution DAGs)
2022-09-21 10:19:53 WARNING Columns ['review_id'] not present in train DAG after the train test split, only before!
2022-09-21 10:19:53 WARNING This could hint at data leakage!
2022-09-21 10:19:54 INFO  Estimated unoptimised what-if runtime is 176863.27457427979ms
2022-09-21 10:19:54 INFO  ---RUNTIME: Multi-Query Optimization took 104.9046516418457 ms
2022-09-21 10:19:54 INFO  Executing generated plans
2022-09-21 10:23:09 INFO  ---RUNTIME: Execution took 195268.4245109558 ms
2022-09-21 10:23:09 INFO  Done!
2022-09-21 10:23:09 INFO  # Finished -- repetition 2 of 7 
2022-09-21 10:23:09 INFO  # Optimization benchmark for data_cleaning with args [['reviews', 'fast_loading', 'featurization_1', 'neural_network']] -- repetition 3 of 7
2022-09-21 10:23:09 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-21 10:23:09 INFO  Running instrumented original pipeline...
2022-09-21 10:23:09 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-21 10:23:09 INFO  ---RUNTIME: Importing and monkey-patching took 5.935430526733398 ms
2022-09-21 10:23:19 INFO  ---RUNTIME: Original pipeline execution took 10548.105955123901 ms (excluding imports and monkey-patching)
2022-09-21 10:23:19 INFO  Starting execution of 1 what-if analyses...
2022-09-21 10:23:19 INFO  Start plan generation for analysis DataCleaning...
2022-09-21 10:23:19 INFO  ---RUNTIME: Plan generation took 0.5974769592285156 ms
2022-09-21 10:23:19 INFO  Estimated runtime of original DAG is 8290.158748626709ms
2022-09-21 10:23:19 INFO  Performing Multi-Query Optimization
2022-09-21 10:23:19 INFO  Estimated unoptimized what-if runtime is 165803.17497253418ms
2022-09-21 10:23:19 INFO  Estimated optimised what-if runtime is 87368.11089515686ms
2022-09-21 10:23:19 INFO  Estimated optimisation runtime saving is 78435.06407737732ms
2022-09-21 10:23:19 INFO  ---RUNTIME: Multi-Query Optimization took 89.59388732910156 ms
2022-09-21 10:23:19 INFO  Executing generated plans
2022-09-21 10:24:56 INFO  ---RUNTIME: Execution took 96820.26791572571 ms
2022-09-21 10:24:56 INFO  Done!
2022-09-21 10:24:56 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-21 10:24:56 INFO  Running instrumented original pipeline...
2022-09-21 10:24:56 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-21 10:24:56 INFO  ---RUNTIME: Importing and monkey-patching took 7.35020637512207 ms
2022-09-21 10:25:10 INFO  ---RUNTIME: Original pipeline execution took 13464.547395706177 ms (excluding imports and monkey-patching)
2022-09-21 10:25:10 INFO  Starting execution of 1 what-if analyses...
2022-09-21 10:25:10 INFO  Start plan generation for analysis DataCleaning...
2022-09-21 10:25:10 INFO  ---RUNTIME: Plan generation took 0.7364749908447266 ms
2022-09-21 10:25:10 INFO  Estimated runtime of original DAG is 10589.780807495117ms
2022-09-21 10:25:10 WARNING Skipping Multi-Query Optimization (instead, only combine execution DAGs)
2022-09-21 10:25:10 WARNING Columns ['review_id'] not present in train DAG after the train test split, only before!
2022-09-21 10:25:10 WARNING This could hint at data leakage!
2022-09-21 10:25:10 INFO  Estimated unoptimised what-if runtime is 211795.61614990234ms
2022-09-21 10:25:10 INFO  ---RUNTIME: Multi-Query Optimization took 138.0174160003662 ms
2022-09-21 10:25:10 INFO  Executing generated plans
2022-09-21 10:28:27 INFO  ---RUNTIME: Execution took 196694.9393749237 ms
2022-09-21 10:28:27 INFO  Done!
2022-09-21 10:28:27 INFO  # Finished -- repetition 3 of 7 
2022-09-21 10:28:27 INFO  # Optimization benchmark for data_cleaning with args [['reviews', 'fast_loading', 'featurization_1', 'neural_network']] -- repetition 4 of 7
2022-09-21 10:28:27 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-21 10:28:27 INFO  Running instrumented original pipeline...
2022-09-21 10:28:27 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-21 10:28:27 INFO  ---RUNTIME: Importing and monkey-patching took 7.047891616821289 ms
2022-09-21 10:28:40 INFO  ---RUNTIME: Original pipeline execution took 13327.476263046265 ms (excluding imports and monkey-patching)
2022-09-21 10:28:40 INFO  Starting execution of 1 what-if analyses...
2022-09-21 10:28:40 INFO  Start plan generation for analysis DataCleaning...
2022-09-21 10:28:40 INFO  ---RUNTIME: Plan generation took 0.7483959197998047 ms
2022-09-21 10:28:40 INFO  Estimated runtime of original DAG is 10492.746591567993ms
2022-09-21 10:28:40 INFO  Performing Multi-Query Optimization
2022-09-21 10:28:41 INFO  Estimated unoptimized what-if runtime is 209854.93183135986ms
2022-09-21 10:28:41 INFO  Estimated optimised what-if runtime is 113990.14854431152ms
2022-09-21 10:28:41 INFO  Estimated optimisation runtime saving is 95864.78328704834ms
2022-09-21 10:28:41 INFO  ---RUNTIME: Multi-Query Optimization took 784.2612266540527 ms
2022-09-21 10:28:41 INFO  Executing generated plans
2022-09-21 10:30:21 INFO  ---RUNTIME: Execution took 100586.51041984558 ms
2022-09-21 10:30:21 INFO  Done!
2022-09-21 10:30:21 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-21 10:30:21 INFO  Running instrumented original pipeline...
2022-09-21 10:30:21 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-21 10:30:21 INFO  ---RUNTIME: Importing and monkey-patching took 6.070137023925781 ms
2022-09-21 10:30:32 INFO  ---RUNTIME: Original pipeline execution took 10539.82925415039 ms (excluding imports and monkey-patching)
2022-09-21 10:30:32 INFO  Starting execution of 1 what-if analyses...
2022-09-21 10:30:32 INFO  Start plan generation for analysis DataCleaning...
2022-09-21 10:30:32 INFO  ---RUNTIME: Plan generation took 0.5714893341064453 ms
2022-09-21 10:30:32 INFO  Estimated runtime of original DAG is 8233.917474746704ms
2022-09-21 10:30:32 WARNING Skipping Multi-Query Optimization (instead, only combine execution DAGs)
2022-09-21 10:30:32 WARNING Columns ['review_id'] not present in train DAG after the train test split, only before!
2022-09-21 10:30:32 WARNING This could hint at data leakage!
2022-09-21 10:30:32 INFO  Estimated unoptimised what-if runtime is 164678.34949493408ms
2022-09-21 10:30:32 INFO  ---RUNTIME: Multi-Query Optimization took 105.18860816955566 ms
2022-09-21 10:30:32 INFO  Executing generated plans
2022-09-21 10:33:51 INFO  ---RUNTIME: Execution took 198679.63242530823 ms
2022-09-21 10:33:51 INFO  Done!
2022-09-21 10:33:51 INFO  # Finished -- repetition 4 of 7 
2022-09-21 10:33:51 INFO  # Optimization benchmark for data_cleaning with args [['reviews', 'fast_loading', 'featurization_1', 'neural_network']] -- repetition 5 of 7
2022-09-21 10:33:51 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-21 10:33:51 INFO  Running instrumented original pipeline...
2022-09-21 10:33:51 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-21 10:33:51 INFO  ---RUNTIME: Importing and monkey-patching took 5.926370620727539 ms
2022-09-21 10:34:02 INFO  ---RUNTIME: Original pipeline execution took 11108.958959579468 ms (excluding imports and monkey-patching)
2022-09-21 10:34:02 INFO  Starting execution of 1 what-if analyses...
2022-09-21 10:34:02 INFO  Start plan generation for analysis DataCleaning...
2022-09-21 10:34:02 INFO  ---RUNTIME: Plan generation took 0.5981922149658203 ms
2022-09-21 10:34:02 INFO  Estimated runtime of original DAG is 8826.682806015015ms
2022-09-21 10:34:02 INFO  Performing Multi-Query Optimization
2022-09-21 10:34:02 INFO  Estimated unoptimized what-if runtime is 176533.6561203003ms
2022-09-21 10:34:02 INFO  Estimated optimised what-if runtime is 98141.23439788818ms
2022-09-21 10:34:02 INFO  Estimated optimisation runtime saving is 78392.42172241211ms
2022-09-21 10:34:02 INFO  ---RUNTIME: Multi-Query Optimization took 94.95997428894043 ms
2022-09-21 10:34:02 INFO  Executing generated plans
2022-09-21 10:35:42 INFO  ---RUNTIME: Execution took 100101.45497322083 ms
2022-09-21 10:35:42 INFO  Done!
2022-09-21 10:35:42 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-21 10:35:42 INFO  Running instrumented original pipeline...
2022-09-21 10:35:42 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-21 10:35:42 INFO  ---RUNTIME: Importing and monkey-patching took 6.11567497253418 ms
2022-09-21 10:35:53 INFO  ---RUNTIME: Original pipeline execution took 10792.695999145508 ms (excluding imports and monkey-patching)
2022-09-21 10:35:53 INFO  Starting execution of 1 what-if analyses...
2022-09-21 10:35:53 INFO  Start plan generation for analysis DataCleaning...
2022-09-21 10:35:53 INFO  ---RUNTIME: Plan generation took 2.328634262084961 ms
2022-09-21 10:35:53 INFO  Estimated runtime of original DAG is 8291.635036468506ms
2022-09-21 10:35:53 WARNING Skipping Multi-Query Optimization (instead, only combine execution DAGs)
2022-09-21 10:35:53 WARNING Columns ['review_id'] not present in train DAG after the train test split, only before!
2022-09-21 10:35:53 WARNING This could hint at data leakage!
2022-09-21 10:35:53 INFO  Estimated unoptimised what-if runtime is 165832.70072937012ms
2022-09-21 10:35:53 INFO  ---RUNTIME: Multi-Query Optimization took 104.10404205322266 ms
2022-09-21 10:35:53 INFO  Executing generated plans
