Variant name from 1-8: 1
Cores to use: 32-39
taskset -c 32-39 PROTOCOL_BUFFERS_PYTHON_IMPLEMENTATION=python python3.9 benchmarks_end_to_end.py feature_importance reviews fast_loading featurization_0 logistic_regression
2022-09-21 18:41:49.551840: W tensorflow/stream_executor/platform/default/dso_loader.cc:64] Could not load dynamic library 'libcudart.so.11.0'; dlerror: libcudart.so.11.0: cannot open shared object file: No such file or directory; LD_LIBRARY_PATH: /home/sgrafbe/mlwhatif/venv/lib/python3.9/site-packages/cv2/../../lib64:
2022-09-21 18:41:49.551889: I tensorflow/stream_executor/cuda/cudart_stub.cc:29] Ignore above cudart dlerror if you do not have a GPU set up on your machine.
2022-09-21 18:41:50 INFO  Patching sys.argv with ['mlwhatif', 'reviews', 'fast_loading', 'featurization_0', 'logistic_regression']
2022-09-21 18:41:50 INFO  Running instrumented original pipeline...
2022-09-21 18:41:50 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-21 18:41:50 INFO  ---RUNTIME: Importing and monkey-patching took 120.60928344726562 ms
2022-09-21 18:41:57 INFO  ---RUNTIME: Original pipeline execution took 6462.746620178223 ms (excluding imports and monkey-patching)
2022-09-21 18:41:57 INFO  Starting execution of 0 what-if analyses...
2022-09-21 18:41:57 INFO  Estimated runtime of original DAG is 4796.215534210205ms
2022-09-21 18:41:57 INFO  Performing Multi-Query Optimization
2022-09-21 18:41:57 INFO  Estimated unoptimized what-if runtime is 0ms
2022-09-21 18:41:57 INFO  Estimated optimised what-if runtime is 0ms
2022-09-21 18:41:57 INFO  Estimated optimisation runtime saving is 0ms
2022-09-21 18:41:57 INFO  ---RUNTIME: Multi-Query Optimization took 0.4985332489013672 ms
2022-09-21 18:41:57 INFO  Executing generated plans
2022-09-21 18:41:57 INFO  ---RUNTIME: Execution took 0.0286102294921875 ms
2022-09-21 18:41:57 INFO  Done!
2022-09-21 18:41:57 INFO  # Optimization benchmark for feature_importance with args [['reviews', 'fast_loading', 'featurization_0', 'logistic_regression']] -- repetition 1 of 7
2022-09-21 18:41:57 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-21 18:41:57 INFO  Running instrumented original pipeline...
2022-09-21 18:41:57 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-21 18:41:57 INFO  ---RUNTIME: Importing and monkey-patching took 5.701541900634766 ms
2022-09-21 18:42:03 INFO  ---RUNTIME: Original pipeline execution took 6578.164100646973 ms (excluding imports and monkey-patching)
2022-09-21 18:42:03 INFO  Starting execution of 1 what-if analyses...
2022-09-21 18:42:03 INFO  Start plan generation for analysis PermutationFeatureImportance...
2022-09-21 18:42:03 INFO  ---RUNTIME: Plan generation took 0.1842975616455078 ms
2022-09-21 18:42:03 INFO  Estimated runtime of original DAG is 4794.236183166504ms
2022-09-21 18:42:03 INFO  Performing Multi-Query Optimization
2022-09-21 18:42:04 INFO  Estimated unoptimized what-if runtime is 23971.18091583252ms
2022-09-21 18:42:04 INFO  Estimated optimised what-if runtime is 6096.113443374634ms
2022-09-21 18:42:04 INFO  Estimated optimisation runtime saving is 17875.067472457886ms
2022-09-21 18:42:04 INFO  ---RUNTIME: Multi-Query Optimization took 9.513139724731445 ms
2022-09-21 18:42:04 INFO  Executing generated plans
2022-09-21 18:42:10 INFO  ---RUNTIME: Execution took 6966.026306152344 ms
2022-09-21 18:42:10 INFO  Done!
2022-09-21 18:42:10 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-21 18:42:10 INFO  Running instrumented original pipeline...
2022-09-21 18:42:11 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-21 18:42:11 INFO  ---RUNTIME: Importing and monkey-patching took 6.078481674194336 ms
2022-09-21 18:42:17 INFO  ---RUNTIME: Original pipeline execution took 6417.609214782715 ms (excluding imports and monkey-patching)
2022-09-21 18:42:17 INFO  Starting execution of 1 what-if analyses...
2022-09-21 18:42:17 INFO  Start plan generation for analysis PermutationFeatureImportance...
2022-09-21 18:42:17 INFO  ---RUNTIME: Plan generation took 0.1289844512939453 ms
2022-09-21 18:42:17 INFO  Estimated runtime of original DAG is 4792.28138923645ms
2022-09-21 18:42:17 WARNING Skipping Multi-Query Optimization (instead, only applying patches)
2022-09-21 18:42:17 INFO  Estimated unoptimised what-if runtime is 23961.40694618225ms
2022-09-21 18:42:17 INFO  ---RUNTIME: Multi-Query Optimization took 3.7746429443359375 ms
2022-09-21 18:42:17 INFO  Executing generated plans
2022-09-21 18:42:45 INFO  ---RUNTIME: Execution took 28342.942237854004 ms
2022-09-21 18:42:45 INFO  Done!
2022-09-21 18:42:45 INFO  # Finished -- repetition 1 of 7 
2022-09-21 18:42:45 INFO  # Optimization benchmark for feature_importance with args [['reviews', 'fast_loading', 'featurization_0', 'logistic_regression']] -- repetition 2 of 7
2022-09-21 18:42:45 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-21 18:42:45 INFO  Running instrumented original pipeline...
2022-09-21 18:42:45 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-21 18:42:45 INFO  ---RUNTIME: Importing and monkey-patching took 6.086111068725586 ms
2022-09-21 18:42:52 INFO  ---RUNTIME: Original pipeline execution took 6460.465431213379 ms (excluding imports and monkey-patching)
2022-09-21 18:42:52 INFO  Starting execution of 1 what-if analyses...
2022-09-21 18:42:52 INFO  Start plan generation for analysis PermutationFeatureImportance...
2022-09-21 18:42:52 INFO  ---RUNTIME: Plan generation took 0.12135505676269531 ms
2022-09-21 18:42:52 INFO  Estimated runtime of original DAG is 4818.6094760894775ms
2022-09-21 18:42:52 INFO  Performing Multi-Query Optimization
2022-09-21 18:42:52 INFO  Estimated unoptimized what-if runtime is 24093.047380447388ms
2022-09-21 18:42:52 INFO  Estimated optimised what-if runtime is 6115.145921707153ms
2022-09-21 18:42:52 INFO  Estimated optimisation runtime saving is 17977.901458740234ms
2022-09-21 18:42:52 INFO  ---RUNTIME: Multi-Query Optimization took 9.461164474487305 ms
2022-09-21 18:42:52 INFO  Executing generated plans
2022-09-21 18:42:59 INFO  ---RUNTIME: Execution took 6996.057510375977 ms
2022-09-21 18:42:59 INFO  Done!
2022-09-21 18:42:59 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-21 18:42:59 INFO  Running instrumented original pipeline...
2022-09-21 18:42:59 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-21 18:42:59 INFO  ---RUNTIME: Importing and monkey-patching took 5.658626556396484 ms
2022-09-21 18:43:05 INFO  ---RUNTIME: Original pipeline execution took 6429.024219512939 ms (excluding imports and monkey-patching)
2022-09-21 18:43:05 INFO  Starting execution of 1 what-if analyses...
2022-09-21 18:43:05 INFO  Start plan generation for analysis PermutationFeatureImportance...
2022-09-21 18:43:05 INFO  ---RUNTIME: Plan generation took 0.12993812561035156 ms
2022-09-21 18:43:05 INFO  Estimated runtime of original DAG is 4792.307138442993ms
2022-09-21 18:43:05 WARNING Skipping Multi-Query Optimization (instead, only applying patches)
2022-09-21 18:43:05 INFO  Estimated unoptimised what-if runtime is 23961.535692214966ms
2022-09-21 18:43:05 INFO  ---RUNTIME: Multi-Query Optimization took 3.734588623046875 ms
2022-09-21 18:43:05 INFO  Executing generated plans
2022-09-21 18:43:34 INFO  ---RUNTIME: Execution took 28518.5284614563 ms
2022-09-21 18:43:34 INFO  Done!
2022-09-21 18:43:34 INFO  # Finished -- repetition 2 of 7 
2022-09-21 18:43:34 INFO  # Optimization benchmark for feature_importance with args [['reviews', 'fast_loading', 'featurization_0', 'logistic_regression']] -- repetition 3 of 7
2022-09-21 18:43:34 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-21 18:43:34 INFO  Running instrumented original pipeline...
2022-09-21 18:43:34 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-21 18:43:34 INFO  ---RUNTIME: Importing and monkey-patching took 6.067991256713867 ms
2022-09-21 18:43:40 INFO  ---RUNTIME: Original pipeline execution took 6469.426870346069 ms (excluding imports and monkey-patching)
2022-09-21 18:43:40 INFO  Starting execution of 1 what-if analyses...
2022-09-21 18:43:40 INFO  Start plan generation for analysis PermutationFeatureImportance...
2022-09-21 18:43:40 INFO  ---RUNTIME: Plan generation took 0.1304149627685547 ms
2022-09-21 18:43:40 INFO  Estimated runtime of original DAG is 4805.824041366577ms
2022-09-21 18:43:40 INFO  Performing Multi-Query Optimization
2022-09-21 18:43:40 INFO  Estimated unoptimized what-if runtime is 24029.120206832886ms
2022-09-21 18:43:40 INFO  Estimated optimised what-if runtime is 6109.8387241363525ms
2022-09-21 18:43:40 INFO  Estimated optimisation runtime saving is 17919.281482696533ms
2022-09-21 18:43:40 INFO  ---RUNTIME: Multi-Query Optimization took 9.513378143310547 ms
2022-09-21 18:43:40 INFO  Executing generated plans
2022-09-21 18:43:47 INFO  ---RUNTIME: Execution took 7017.909049987793 ms
2022-09-21 18:43:47 INFO  Done!
2022-09-21 18:43:47 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-21 18:43:47 INFO  Running instrumented original pipeline...
2022-09-21 18:43:47 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-21 18:43:47 INFO  ---RUNTIME: Importing and monkey-patching took 5.650758743286133 ms
2022-09-21 18:43:54 INFO  ---RUNTIME: Original pipeline execution took 6465.841770172119 ms (excluding imports and monkey-patching)
2022-09-21 18:43:54 INFO  Starting execution of 1 what-if analyses...
2022-09-21 18:43:54 INFO  Start plan generation for analysis PermutationFeatureImportance...
2022-09-21 18:43:54 INFO  ---RUNTIME: Plan generation took 0.10585784912109375 ms
2022-09-21 18:43:54 INFO  Estimated runtime of original DAG is 4816.954135894775ms
2022-09-21 18:43:54 WARNING Skipping Multi-Query Optimization (instead, only applying patches)
2022-09-21 18:43:54 INFO  Estimated unoptimised what-if runtime is 24084.770679473877ms
2022-09-21 18:43:54 INFO  ---RUNTIME: Multi-Query Optimization took 3.6666393280029297 ms
2022-09-21 18:43:54 INFO  Executing generated plans
2022-09-21 18:44:22 INFO  ---RUNTIME: Execution took 28526.397943496704 ms
2022-09-21 18:44:22 INFO  Done!
2022-09-21 18:44:22 INFO  # Finished -- repetition 3 of 7 
2022-09-21 18:44:22 INFO  # Optimization benchmark for feature_importance with args [['reviews', 'fast_loading', 'featurization_0', 'logistic_regression']] -- repetition 4 of 7
2022-09-21 18:44:22 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-21 18:44:22 INFO  Running instrumented original pipeline...
2022-09-21 18:44:22 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-21 18:44:22 INFO  ---RUNTIME: Importing and monkey-patching took 6.13713264465332 ms
2022-09-21 18:44:29 INFO  ---RUNTIME: Original pipeline execution took 6454.7693729400635 ms (excluding imports and monkey-patching)
2022-09-21 18:44:29 INFO  Starting execution of 1 what-if analyses...
2022-09-21 18:44:29 INFO  Start plan generation for analysis PermutationFeatureImportance...
2022-09-21 18:44:29 INFO  ---RUNTIME: Plan generation took 0.12040138244628906 ms
2022-09-21 18:44:29 INFO  Estimated runtime of original DAG is 4798.689842224121ms
2022-09-21 18:44:29 INFO  Performing Multi-Query Optimization
2022-09-21 18:44:29 INFO  Estimated unoptimized what-if runtime is 23993.449211120605ms
2022-09-21 18:44:29 INFO  Estimated optimised what-if runtime is 6091.934442520142ms
2022-09-21 18:44:29 INFO  Estimated optimisation runtime saving is 17901.514768600464ms
2022-09-21 18:44:29 INFO  ---RUNTIME: Multi-Query Optimization took 9.362459182739258 ms
2022-09-21 18:44:29 INFO  Executing generated plans
2022-09-21 18:44:36 INFO  ---RUNTIME: Execution took 7003.096342086792 ms
2022-09-21 18:44:36 INFO  Done!
2022-09-21 18:44:36 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-21 18:44:36 INFO  Running instrumented original pipeline...
2022-09-21 18:44:36 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-21 18:44:36 INFO  ---RUNTIME: Importing and monkey-patching took 5.864143371582031 ms
2022-09-21 18:44:42 INFO  ---RUNTIME: Original pipeline execution took 6757.610082626343 ms (excluding imports and monkey-patching)
2022-09-21 18:44:42 INFO  Starting execution of 1 what-if analyses...
2022-09-21 18:44:42 INFO  Start plan generation for analysis PermutationFeatureImportance...
2022-09-21 18:44:42 INFO  ---RUNTIME: Plan generation took 0.10633468627929688 ms
2022-09-21 18:44:42 INFO  Estimated runtime of original DAG is 4816.734552383423ms
2022-09-21 18:44:42 WARNING Skipping Multi-Query Optimization (instead, only applying patches)
2022-09-21 18:44:42 INFO  Estimated unoptimised what-if runtime is 24083.672761917114ms
2022-09-21 18:44:42 INFO  ---RUNTIME: Multi-Query Optimization took 3.6373138427734375 ms
2022-09-21 18:44:42 INFO  Executing generated plans
2022-09-21 18:45:11 INFO  ---RUNTIME: Execution took 28877.542972564697 ms
2022-09-21 18:45:11 INFO  Done!
2022-09-21 18:45:11 INFO  # Finished -- repetition 4 of 7 
2022-09-21 18:45:11 INFO  # Optimization benchmark for feature_importance with args [['reviews', 'fast_loading', 'featurization_0', 'logistic_regression']] -- repetition 5 of 7
2022-09-21 18:45:11 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-21 18:45:11 INFO  Running instrumented original pipeline...
2022-09-21 18:45:11 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-21 18:45:11 INFO  ---RUNTIME: Importing and monkey-patching took 6.2732696533203125 ms
2022-09-21 18:45:18 INFO  ---RUNTIME: Original pipeline execution took 6535.576581954956 ms (excluding imports and monkey-patching)
2022-09-21 18:45:18 INFO  Starting execution of 1 what-if analyses...
2022-09-21 18:45:18 INFO  Start plan generation for analysis PermutationFeatureImportance...
2022-09-21 18:45:18 INFO  ---RUNTIME: Plan generation took 0.11968612670898438 ms
2022-09-21 18:45:18 INFO  Estimated runtime of original DAG is 4839.272499084473ms
2022-09-21 18:45:18 INFO  Performing Multi-Query Optimization
2022-09-21 18:45:18 INFO  Estimated unoptimized what-if runtime is 24196.362495422363ms
2022-09-21 18:45:18 INFO  Estimated optimised what-if runtime is 6138.995885848999ms
2022-09-21 18:45:18 INFO  Estimated optimisation runtime saving is 18057.366609573364ms
2022-09-21 18:45:18 INFO  ---RUNTIME: Multi-Query Optimization took 9.349822998046875 ms
2022-09-21 18:45:18 INFO  Executing generated plans
2022-09-21 18:45:25 INFO  ---RUNTIME: Execution took 7184.463739395142 ms
2022-09-21 18:45:25 INFO  Done!
2022-09-21 18:45:25 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-21 18:45:25 INFO  Running instrumented original pipeline...
2022-09-21 18:45:25 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-21 18:45:25 INFO  ---RUNTIME: Importing and monkey-patching took 5.849599838256836 ms
2022-09-21 18:45:32 INFO  ---RUNTIME: Original pipeline execution took 6582.740068435669 ms (excluding imports and monkey-patching)
2022-09-21 18:45:32 INFO  Starting execution of 1 what-if analyses...
2022-09-21 18:45:32 INFO  Start plan generation for analysis PermutationFeatureImportance...
2022-09-21 18:45:32 INFO  ---RUNTIME: Plan generation took 0.10061264038085938 ms
2022-09-21 18:45:32 INFO  Estimated runtime of original DAG is 4894.015789031982ms
2022-09-21 18:45:32 WARNING Skipping Multi-Query Optimization (instead, only applying patches)
2022-09-21 18:45:32 INFO  Estimated unoptimised what-if runtime is 24470.078945159912ms
2022-09-21 18:45:32 INFO  ---RUNTIME: Multi-Query Optimization took 3.673076629638672 ms
2022-09-21 18:45:32 INFO  Executing generated plans
2022-09-21 18:46:01 INFO  ---RUNTIME: Execution took 28917.449474334717 ms
2022-09-21 18:46:01 INFO  Done!
2022-09-21 18:46:01 INFO  # Finished -- repetition 5 of 7 
2022-09-21 18:46:01 INFO  # Optimization benchmark for feature_importance with args [['reviews', 'fast_loading', 'featurization_0', 'logistic_regression']] -- repetition 6 of 7
2022-09-21 18:46:01 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-21 18:46:01 INFO  Running instrumented original pipeline...
2022-09-21 18:46:01 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-21 18:46:01 INFO  ---RUNTIME: Importing and monkey-patching took 6.143331527709961 ms
2022-09-21 18:46:07 INFO  ---RUNTIME: Original pipeline execution took 6531.324148178101 ms (excluding imports and monkey-patching)
2022-09-21 18:46:07 INFO  Starting execution of 1 what-if analyses...
2022-09-21 18:46:07 INFO  Start plan generation for analysis PermutationFeatureImportance...
2022-09-21 18:46:07 INFO  ---RUNTIME: Plan generation took 0.1220703125 ms
2022-09-21 18:46:07 INFO  Estimated runtime of original DAG is 4856.303930282593ms
2022-09-21 18:46:07 INFO  Performing Multi-Query Optimization
2022-09-21 18:46:07 INFO  Estimated unoptimized what-if runtime is 24281.519651412964ms
2022-09-21 18:46:07 INFO  Estimated optimised what-if runtime is 6153.059005737305ms
2022-09-21 18:46:07 INFO  Estimated optimisation runtime saving is 18128.46064567566ms
2022-09-21 18:46:07 INFO  ---RUNTIME: Multi-Query Optimization took 9.616374969482422 ms
2022-09-21 18:46:07 INFO  Executing generated plans
2022-09-21 18:46:14 INFO  ---RUNTIME: Execution took 7110.568523406982 ms
2022-09-21 18:46:14 INFO  Done!
2022-09-21 18:46:14 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-21 18:46:14 INFO  Running instrumented original pipeline...
2022-09-21 18:46:14 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-21 18:46:14 INFO  ---RUNTIME: Importing and monkey-patching took 5.749702453613281 ms
2022-09-21 18:46:21 INFO  ---RUNTIME: Original pipeline execution took 6512.189865112305 ms (excluding imports and monkey-patching)
2022-09-21 18:46:21 INFO  Starting execution of 1 what-if analyses...
2022-09-21 18:46:21 INFO  Start plan generation for analysis PermutationFeatureImportance...
2022-09-21 18:46:21 INFO  ---RUNTIME: Plan generation took 0.10466575622558594 ms
2022-09-21 18:46:21 INFO  Estimated runtime of original DAG is 4852.11968421936ms
2022-09-21 18:46:21 WARNING Skipping Multi-Query Optimization (instead, only applying patches)
2022-09-21 18:46:21 INFO  Estimated unoptimised what-if runtime is 24260.5984210968ms
2022-09-21 18:46:21 INFO  ---RUNTIME: Multi-Query Optimization took 3.6661624908447266 ms
2022-09-21 18:46:21 INFO  Executing generated plans
2022-09-21 18:46:50 INFO  ---RUNTIME: Execution took 28753.345251083374 ms
2022-09-21 18:46:50 INFO  Done!
2022-09-21 18:46:50 INFO  # Finished -- repetition 6 of 7 
2022-09-21 18:46:50 INFO  # Optimization benchmark for feature_importance with args [['reviews', 'fast_loading', 'featurization_0', 'logistic_regression']] -- repetition 7 of 7
2022-09-21 18:46:50 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-21 18:46:50 INFO  Running instrumented original pipeline...
2022-09-21 18:46:50 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-21 18:46:50 INFO  ---RUNTIME: Importing and monkey-patching took 6.178855895996094 ms
2022-09-21 18:46:56 INFO  ---RUNTIME: Original pipeline execution took 6473.818063735962 ms (excluding imports and monkey-patching)
2022-09-21 18:46:56 INFO  Starting execution of 1 what-if analyses...
2022-09-21 18:46:56 INFO  Start plan generation for analysis PermutationFeatureImportance...
2022-09-21 18:46:56 INFO  ---RUNTIME: Plan generation took 0.12087821960449219 ms
2022-09-21 18:46:56 INFO  Estimated runtime of original DAG is 4819.02289390564ms
2022-09-21 18:46:56 INFO  Performing Multi-Query Optimization
2022-09-21 18:46:56 INFO  Estimated unoptimized what-if runtime is 24095.1144695282ms
2022-09-21 18:46:56 INFO  Estimated optimised what-if runtime is 6116.1675453186035ms
2022-09-21 18:46:56 INFO  Estimated optimisation runtime saving is 17978.946924209595ms
2022-09-21 18:46:56 INFO  ---RUNTIME: Multi-Query Optimization took 9.323358535766602 ms
2022-09-21 18:46:56 INFO  Executing generated plans
2022-09-21 18:47:03 INFO  ---RUNTIME: Execution took 7048.225164413452 ms
2022-09-21 18:47:03 INFO  Done!
2022-09-21 18:47:03 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-21 18:47:03 INFO  Running instrumented original pipeline...
2022-09-21 18:47:03 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-21 18:47:03 INFO  ---RUNTIME: Importing and monkey-patching took 5.75566291809082 ms
2022-09-21 18:47:10 INFO  ---RUNTIME: Original pipeline execution took 6517.963171005249 ms (excluding imports and monkey-patching)
2022-09-21 18:47:10 INFO  Starting execution of 1 what-if analyses...
2022-09-21 18:47:10 INFO  Start plan generation for analysis PermutationFeatureImportance...
2022-09-21 18:47:10 INFO  ---RUNTIME: Plan generation took 0.10609626770019531 ms
2022-09-21 18:47:10 INFO  Estimated runtime of original DAG is 4863.192796707153ms
2022-09-21 18:47:10 WARNING Skipping Multi-Query Optimization (instead, only applying patches)
2022-09-21 18:47:10 INFO  Estimated unoptimised what-if runtime is 24315.963983535767ms
2022-09-21 18:47:10 INFO  ---RUNTIME: Multi-Query Optimization took 3.773212432861328 ms
2022-09-21 18:47:10 INFO  Executing generated plans
2022-09-21 18:47:38 INFO  ---RUNTIME: Execution took 28750.335454940796 ms
2022-09-21 18:47:38 INFO  Done!
2022-09-21 18:47:38 INFO  # Finished -- repetition 7 of 7 
2022-09-21 18:47:38 INFO  # Final results after all repetitions
2022-09-21 18:47:38 INFO     repetition  ... no_opt_what_if_execution_combined_model_training
0           0  ...                                       792.530775
1           1  ...                                       790.246964
2           2  ...                                       794.160128
3           3  ...                                       795.786381
4           4  ...                                       794.743776
5           5  ...                                       791.028976
6           6  ...                                       795.556068

[7 rows x 26 columns]
taskset -c 32-39 PROTOCOL_BUFFERS_PYTHON_IMPLEMENTATION=python python3.9 benchmarks_end_to_end.py feature_importance reviews fast_loading featurization_0 xgboost
2022-09-21 18:47:41.188922: W tensorflow/stream_executor/platform/default/dso_loader.cc:64] Could not load dynamic library 'libcudart.so.11.0'; dlerror: libcudart.so.11.0: cannot open shared object file: No such file or directory; LD_LIBRARY_PATH: /home/sgrafbe/mlwhatif/venv/lib/python3.9/site-packages/cv2/../../lib64:
2022-09-21 18:47:41.188971: I tensorflow/stream_executor/cuda/cudart_stub.cc:29] Ignore above cudart dlerror if you do not have a GPU set up on your machine.
2022-09-21 18:47:42 INFO  Patching sys.argv with ['mlwhatif', 'reviews', 'fast_loading', 'featurization_0', 'xgboost']
2022-09-21 18:47:42 INFO  Running instrumented original pipeline...
2022-09-21 18:47:42 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-21 18:47:42 INFO  ---RUNTIME: Importing and monkey-patching took 122.25174903869629 ms
2022-09-21 18:47:49 INFO  ---RUNTIME: Original pipeline execution took 7206.70223236084 ms (excluding imports and monkey-patching)
2022-09-21 18:47:49 INFO  Starting execution of 0 what-if analyses...
2022-09-21 18:47:49 INFO  Estimated runtime of original DAG is 5548.480749130249ms
2022-09-21 18:47:49 INFO  Performing Multi-Query Optimization
2022-09-21 18:47:49 INFO  Estimated unoptimized what-if runtime is 0ms
2022-09-21 18:47:49 INFO  Estimated optimised what-if runtime is 0ms
2022-09-21 18:47:49 INFO  Estimated optimisation runtime saving is 0ms
2022-09-21 18:47:49 INFO  ---RUNTIME: Multi-Query Optimization took 0.51116943359375 ms
2022-09-21 18:47:49 INFO  Executing generated plans
2022-09-21 18:47:49 INFO  ---RUNTIME: Execution took 0.028848648071289062 ms
2022-09-21 18:47:49 INFO  Done!
2022-09-21 18:47:49 INFO  # Optimization benchmark for feature_importance with args [['reviews', 'fast_loading', 'featurization_0', 'xgboost']] -- repetition 1 of 7
2022-09-21 18:47:49 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-21 18:47:49 INFO  Running instrumented original pipeline...
2022-09-21 18:47:50 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-21 18:47:50 INFO  ---RUNTIME: Importing and monkey-patching took 5.849599838256836 ms
2022-09-21 18:47:57 INFO  ---RUNTIME: Original pipeline execution took 7222.520351409912 ms (excluding imports and monkey-patching)
2022-09-21 18:47:57 INFO  Starting execution of 1 what-if analyses...
2022-09-21 18:47:57 INFO  Start plan generation for analysis PermutationFeatureImportance...
2022-09-21 18:47:57 INFO  ---RUNTIME: Plan generation took 0.21266937255859375 ms
2022-09-21 18:47:57 INFO  Estimated runtime of original DAG is 5424.304485321045ms
2022-09-21 18:47:57 INFO  Performing Multi-Query Optimization
2022-09-21 18:47:57 INFO  Estimated unoptimized what-if runtime is 27121.522426605225ms
2022-09-21 18:47:57 INFO  Estimated optimised what-if runtime is 6915.292978286743ms
2022-09-21 18:47:57 INFO  Estimated optimisation runtime saving is 20206.22944831848ms
2022-09-21 18:47:57 INFO  ---RUNTIME: Multi-Query Optimization took 9.435415267944336 ms
2022-09-21 18:47:57 INFO  Executing generated plans
2022-09-21 18:48:05 INFO  ---RUNTIME: Execution took 7955.870866775513 ms
2022-09-21 18:48:05 INFO  Done!
2022-09-21 18:48:05 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-21 18:48:05 INFO  Running instrumented original pipeline...
2022-09-21 18:48:05 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-21 18:48:05 INFO  ---RUNTIME: Importing and monkey-patching took 9.21177864074707 ms
2022-09-21 18:48:14 INFO  ---RUNTIME: Original pipeline execution took 9324.130058288574 ms (excluding imports and monkey-patching)
2022-09-21 18:48:14 INFO  Starting execution of 1 what-if analyses...
2022-09-21 18:48:14 INFO  Start plan generation for analysis PermutationFeatureImportance...
2022-09-21 18:48:14 INFO  ---RUNTIME: Plan generation took 0.12993812561035156 ms
2022-09-21 18:48:14 INFO  Estimated runtime of original DAG is 7669.371128082275ms
2022-09-21 18:48:14 WARNING Skipping Multi-Query Optimization (instead, only applying patches)
2022-09-21 18:48:14 INFO  Estimated unoptimised what-if runtime is 38346.85564041138ms
2022-09-21 18:48:14 INFO  ---RUNTIME: Multi-Query Optimization took 3.824949264526367 ms
2022-09-21 18:48:14 INFO  Executing generated plans
2022-09-21 18:48:46 INFO  ---RUNTIME: Execution took 32563.74168395996 ms
2022-09-21 18:48:46 INFO  Done!
2022-09-21 18:48:46 INFO  # Finished -- repetition 1 of 7 
2022-09-21 18:48:46 INFO  # Optimization benchmark for feature_importance with args [['reviews', 'fast_loading', 'featurization_0', 'xgboost']] -- repetition 2 of 7
2022-09-21 18:48:46 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-21 18:48:46 INFO  Running instrumented original pipeline...
2022-09-21 18:48:46 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-21 18:48:46 INFO  ---RUNTIME: Importing and monkey-patching took 6.104707717895508 ms
2022-09-21 18:48:54 INFO  ---RUNTIME: Original pipeline execution took 7377.544403076172 ms (excluding imports and monkey-patching)
2022-09-21 18:48:54 INFO  Starting execution of 1 what-if analyses...
2022-09-21 18:48:54 INFO  Start plan generation for analysis PermutationFeatureImportance...
2022-09-21 18:48:54 INFO  ---RUNTIME: Plan generation took 0.12755393981933594 ms
2022-09-21 18:48:54 INFO  Estimated runtime of original DAG is 5627.915382385254ms
2022-09-21 18:48:54 INFO  Performing Multi-Query Optimization
2022-09-21 18:48:54 INFO  Estimated unoptimized what-if runtime is 28139.57691192627ms
2022-09-21 18:48:54 INFO  Estimated optimised what-if runtime is 7127.709865570068ms
2022-09-21 18:48:54 INFO  Estimated optimisation runtime saving is 21011.8670463562ms
2022-09-21 18:48:54 INFO  ---RUNTIME: Multi-Query Optimization took 9.41610336303711 ms
2022-09-21 18:48:54 INFO  Executing generated plans
2022-09-21 18:49:02 INFO  ---RUNTIME: Execution took 8215.205669403076 ms
2022-09-21 18:49:02 INFO  Done!
2022-09-21 18:49:02 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-21 18:49:02 INFO  Running instrumented original pipeline...
2022-09-21 18:49:02 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-21 18:49:02 INFO  ---RUNTIME: Importing and monkey-patching took 5.769252777099609 ms
2022-09-21 18:49:09 INFO  ---RUNTIME: Original pipeline execution took 7077.274560928345 ms (excluding imports and monkey-patching)
2022-09-21 18:49:09 INFO  Starting execution of 1 what-if analyses...
2022-09-21 18:49:09 INFO  Start plan generation for analysis PermutationFeatureImportance...
2022-09-21 18:49:09 INFO  ---RUNTIME: Plan generation took 0.12087821960449219 ms
2022-09-21 18:49:09 INFO  Estimated runtime of original DAG is 5449.593782424927ms
2022-09-21 18:49:09 WARNING Skipping Multi-Query Optimization (instead, only applying patches)
2022-09-21 18:49:09 INFO  Estimated unoptimised what-if runtime is 27247.968912124634ms
2022-09-21 18:49:09 INFO  ---RUNTIME: Multi-Query Optimization took 3.851652145385742 ms
2022-09-21 18:49:09 INFO  Executing generated plans
2022-09-21 18:49:42 INFO  ---RUNTIME: Execution took 33178.29704284668 ms
2022-09-21 18:49:42 INFO  Done!
2022-09-21 18:49:42 INFO  # Finished -- repetition 2 of 7 
2022-09-21 18:49:42 INFO  # Optimization benchmark for feature_importance with args [['reviews', 'fast_loading', 'featurization_0', 'xgboost']] -- repetition 3 of 7
2022-09-21 18:49:42 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-21 18:49:42 INFO  Running instrumented original pipeline...
2022-09-21 18:49:42 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-21 18:49:42 INFO  ---RUNTIME: Importing and monkey-patching took 6.1130523681640625 ms
2022-09-21 18:49:50 INFO  ---RUNTIME: Original pipeline execution took 7369.58909034729 ms (excluding imports and monkey-patching)
2022-09-21 18:49:50 INFO  Starting execution of 1 what-if analyses...
2022-09-21 18:49:50 INFO  Start plan generation for analysis PermutationFeatureImportance...
2022-09-21 18:49:50 INFO  ---RUNTIME: Plan generation took 0.1285076141357422 ms
2022-09-21 18:49:50 INFO  Estimated runtime of original DAG is 5556.0243129730225ms
2022-09-21 18:49:50 INFO  Performing Multi-Query Optimization
2022-09-21 18:49:50 INFO  Estimated unoptimized what-if runtime is 27780.121564865112ms
2022-09-21 18:49:50 INFO  Estimated optimised what-if runtime is 7057.987689971924ms
2022-09-21 18:49:50 INFO  Estimated optimisation runtime saving is 20722.13387489319ms
2022-09-21 18:49:50 INFO  ---RUNTIME: Multi-Query Optimization took 9.660959243774414 ms
2022-09-21 18:49:50 INFO  Executing generated plans
2022-09-21 18:49:58 INFO  ---RUNTIME: Execution took 8088.302373886108 ms
2022-09-21 18:49:58 INFO  Done!
2022-09-21 18:49:58 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-21 18:49:58 INFO  Running instrumented original pipeline...
2022-09-21 18:49:58 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-21 18:49:58 INFO  ---RUNTIME: Importing and monkey-patching took 6.116628646850586 ms
2022-09-21 18:50:05 INFO  ---RUNTIME: Original pipeline execution took 7535.945892333984 ms (excluding imports and monkey-patching)
2022-09-21 18:50:05 INFO  Starting execution of 1 what-if analyses...
2022-09-21 18:50:05 INFO  Start plan generation for analysis PermutationFeatureImportance...
2022-09-21 18:50:05 INFO  ---RUNTIME: Plan generation took 0.1251697540283203 ms
2022-09-21 18:50:05 INFO  Estimated runtime of original DAG is 5896.478176116943ms
2022-09-21 18:50:05 WARNING Skipping Multi-Query Optimization (instead, only applying patches)
2022-09-21 18:50:05 INFO  Estimated unoptimised what-if runtime is 29482.390880584717ms
2022-09-21 18:50:05 INFO  ---RUNTIME: Multi-Query Optimization took 3.7224292755126953 ms
2022-09-21 18:50:05 INFO  Executing generated plans
2022-09-21 18:50:39 INFO  ---RUNTIME: Execution took 33191.349267959595 ms
2022-09-21 18:50:39 INFO  Done!
2022-09-21 18:50:39 INFO  # Finished -- repetition 3 of 7 
2022-09-21 18:50:39 INFO  # Optimization benchmark for feature_importance with args [['reviews', 'fast_loading', 'featurization_0', 'xgboost']] -- repetition 4 of 7
2022-09-21 18:50:39 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-21 18:50:39 INFO  Running instrumented original pipeline...
2022-09-21 18:50:39 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-21 18:50:39 INFO  ---RUNTIME: Importing and monkey-patching took 5.993127822875977 ms
2022-09-21 18:50:46 INFO  ---RUNTIME: Original pipeline execution took 7375.041484832764 ms (excluding imports and monkey-patching)
2022-09-21 18:50:46 INFO  Starting execution of 1 what-if analyses...
2022-09-21 18:50:46 INFO  Start plan generation for analysis PermutationFeatureImportance...
2022-09-21 18:50:46 INFO  ---RUNTIME: Plan generation took 0.13518333435058594 ms
2022-09-21 18:50:46 INFO  Estimated runtime of original DAG is 5591.77827835083ms
2022-09-21 18:50:46 INFO  Performing Multi-Query Optimization
2022-09-21 18:50:46 INFO  Estimated unoptimized what-if runtime is 27958.89139175415ms
2022-09-21 18:50:46 INFO  Estimated optimised what-if runtime is 7088.740348815918ms
2022-09-21 18:50:46 INFO  Estimated optimisation runtime saving is 20870.151042938232ms
2022-09-21 18:50:46 INFO  ---RUNTIME: Multi-Query Optimization took 9.405374526977539 ms
2022-09-21 18:50:46 INFO  Executing generated plans
2022-09-21 18:50:54 INFO  ---RUNTIME: Execution took 7994.389295578003 ms
2022-09-21 18:50:54 INFO  Done!
2022-09-21 18:50:54 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-21 18:50:54 INFO  Running instrumented original pipeline...
2022-09-21 18:50:54 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-21 18:50:54 INFO  ---RUNTIME: Importing and monkey-patching took 8.046388626098633 ms
2022-09-21 18:51:02 INFO  ---RUNTIME: Original pipeline execution took 8116.214990615845 ms (excluding imports and monkey-patching)
2022-09-21 18:51:02 INFO  Starting execution of 1 what-if analyses...
2022-09-21 18:51:02 INFO  Start plan generation for analysis PermutationFeatureImportance...
2022-09-21 18:51:02 INFO  ---RUNTIME: Plan generation took 0.10561943054199219 ms
2022-09-21 18:51:02 INFO  Estimated runtime of original DAG is 5824.824571609497ms
2022-09-21 18:51:02 WARNING Skipping Multi-Query Optimization (instead, only applying patches)
2022-09-21 18:51:02 INFO  Estimated unoptimised what-if runtime is 29124.122858047485ms
2022-09-21 18:51:02 INFO  ---RUNTIME: Multi-Query Optimization took 3.656148910522461 ms
2022-09-21 18:51:02 INFO  Executing generated plans
2022-09-21 18:51:36 INFO  ---RUNTIME: Execution took 33534.11817550659 ms
2022-09-21 18:51:36 INFO  Done!
2022-09-21 18:51:36 INFO  # Finished -- repetition 4 of 7 
2022-09-21 18:51:36 INFO  # Optimization benchmark for feature_importance with args [['reviews', 'fast_loading', 'featurization_0', 'xgboost']] -- repetition 5 of 7
2022-09-21 18:51:36 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-21 18:51:36 INFO  Running instrumented original pipeline...
2022-09-21 18:51:36 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-21 18:51:36 INFO  ---RUNTIME: Importing and monkey-patching took 6.338596343994141 ms
2022-09-21 18:51:43 INFO  ---RUNTIME: Original pipeline execution took 7242.282152175903 ms (excluding imports and monkey-patching)
2022-09-21 18:51:43 INFO  Starting execution of 1 what-if analyses...
2022-09-21 18:51:43 INFO  Start plan generation for analysis PermutationFeatureImportance...
2022-09-21 18:51:43 INFO  ---RUNTIME: Plan generation took 0.15020370483398438 ms
2022-09-21 18:51:43 INFO  Estimated runtime of original DAG is 5553.697347640991ms
2022-09-21 18:51:43 INFO  Performing Multi-Query Optimization
2022-09-21 18:51:43 INFO  Estimated unoptimized what-if runtime is 27768.486738204956ms
2022-09-21 18:51:43 INFO  Estimated optimised what-if runtime is 7057.836532592773ms
2022-09-21 18:51:43 INFO  Estimated optimisation runtime saving is 20710.650205612183ms
2022-09-21 18:51:43 INFO  ---RUNTIME: Multi-Query Optimization took 9.453535079956055 ms
2022-09-21 18:51:43 INFO  Executing generated plans
2022-09-21 18:51:51 INFO  ---RUNTIME: Execution took 8627.059936523438 ms
2022-09-21 18:51:51 INFO  Done!
2022-09-21 18:51:51 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-21 18:51:51 INFO  Running instrumented original pipeline...
2022-09-21 18:51:52 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-21 18:51:52 INFO  ---RUNTIME: Importing and monkey-patching took 5.9413909912109375 ms
2022-09-21 18:51:59 INFO  ---RUNTIME: Original pipeline execution took 7415.29655456543 ms (excluding imports and monkey-patching)
2022-09-21 18:51:59 INFO  Starting execution of 1 what-if analyses...
2022-09-21 18:51:59 INFO  Start plan generation for analysis PermutationFeatureImportance...
2022-09-21 18:51:59 INFO  ---RUNTIME: Plan generation took 0.12087821960449219 ms
2022-09-21 18:51:59 INFO  Estimated runtime of original DAG is 5727.421998977661ms
2022-09-21 18:51:59 WARNING Skipping Multi-Query Optimization (instead, only applying patches)
2022-09-21 18:51:59 INFO  Estimated unoptimised what-if runtime is 28637.109994888306ms
2022-09-21 18:51:59 INFO  ---RUNTIME: Multi-Query Optimization took 3.7157535552978516 ms
2022-09-21 18:51:59 INFO  Executing generated plans
2022-09-21 18:52:32 INFO  ---RUNTIME: Execution took 33301.299810409546 ms
2022-09-21 18:52:32 INFO  Done!
2022-09-21 18:52:32 INFO  # Finished -- repetition 5 of 7 
2022-09-21 18:52:32 INFO  # Optimization benchmark for feature_importance with args [['reviews', 'fast_loading', 'featurization_0', 'xgboost']] -- repetition 6 of 7
2022-09-21 18:52:32 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-21 18:52:32 INFO  Running instrumented original pipeline...
2022-09-21 18:52:32 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-21 18:52:32 INFO  ---RUNTIME: Importing and monkey-patching took 6.251811981201172 ms
2022-09-21 18:52:40 INFO  ---RUNTIME: Original pipeline execution took 7949.677467346191 ms (excluding imports and monkey-patching)
2022-09-21 18:52:40 INFO  Starting execution of 1 what-if analyses...
2022-09-21 18:52:40 INFO  Start plan generation for analysis PermutationFeatureImportance...
2022-09-21 18:52:40 INFO  ---RUNTIME: Plan generation took 0.12564659118652344 ms
2022-09-21 18:52:40 INFO  Estimated runtime of original DAG is 6081.268548965454ms
2022-09-21 18:52:40 INFO  Performing Multi-Query Optimization
2022-09-21 18:52:40 INFO  Estimated unoptimized what-if runtime is 30406.34274482727ms
2022-09-21 18:52:40 INFO  Estimated optimised what-if runtime is 7585.190296173096ms
2022-09-21 18:52:40 INFO  Estimated optimisation runtime saving is 22821.152448654175ms
2022-09-21 18:52:40 INFO  ---RUNTIME: Multi-Query Optimization took 9.54890251159668 ms
2022-09-21 18:52:40 INFO  Executing generated plans
2022-09-21 18:52:48 INFO  ---RUNTIME: Execution took 8142.912149429321 ms
2022-09-21 18:52:48 INFO  Done!
2022-09-21 18:52:48 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-21 18:52:48 INFO  Running instrumented original pipeline...
2022-09-21 18:52:48 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-21 18:52:48 INFO  ---RUNTIME: Importing and monkey-patching took 5.831003189086914 ms
2022-09-21 18:52:56 INFO  ---RUNTIME: Original pipeline execution took 7411.468267440796 ms (excluding imports and monkey-patching)
2022-09-21 18:52:56 INFO  Starting execution of 1 what-if analyses...
2022-09-21 18:52:56 INFO  Start plan generation for analysis PermutationFeatureImportance...
2022-09-21 18:52:56 INFO  ---RUNTIME: Plan generation took 0.102996826171875 ms
2022-09-21 18:52:56 INFO  Estimated runtime of original DAG is 5615.726709365845ms
2022-09-21 18:52:56 WARNING Skipping Multi-Query Optimization (instead, only applying patches)
2022-09-21 18:52:56 INFO  Estimated unoptimised what-if runtime is 28078.633546829224ms
2022-09-21 18:52:56 INFO  ---RUNTIME: Multi-Query Optimization took 3.7605762481689453 ms
2022-09-21 18:52:56 INFO  Executing generated plans
2022-09-21 18:53:29 INFO  ---RUNTIME: Execution took 33527.859687805176 ms
2022-09-21 18:53:29 INFO  Done!
2022-09-21 18:53:29 INFO  # Finished -- repetition 6 of 7 
2022-09-21 18:53:29 INFO  # Optimization benchmark for feature_importance with args [['reviews', 'fast_loading', 'featurization_0', 'xgboost']] -- repetition 7 of 7
2022-09-21 18:53:29 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-21 18:53:29 INFO  Running instrumented original pipeline...
2022-09-21 18:53:29 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-21 18:53:29 INFO  ---RUNTIME: Importing and monkey-patching took 6.256580352783203 ms
2022-09-21 18:53:37 INFO  ---RUNTIME: Original pipeline execution took 7333.537340164185 ms (excluding imports and monkey-patching)
2022-09-21 18:53:37 INFO  Starting execution of 1 what-if analyses...
2022-09-21 18:53:37 INFO  Start plan generation for analysis PermutationFeatureImportance...
2022-09-21 18:53:37 INFO  ---RUNTIME: Plan generation took 0.1270771026611328 ms
2022-09-21 18:53:37 INFO  Estimated runtime of original DAG is 5478.050708770752ms
2022-09-21 18:53:37 INFO  Performing Multi-Query Optimization
2022-09-21 18:53:37 INFO  Estimated unoptimized what-if runtime is 27390.25354385376ms
2022-09-21 18:53:37 INFO  Estimated optimised what-if runtime is 6948.044061660767ms
2022-09-21 18:53:37 INFO  Estimated optimisation runtime saving is 20442.209482192993ms
2022-09-21 18:53:37 INFO  ---RUNTIME: Multi-Query Optimization took 9.461402893066406 ms
2022-09-21 18:53:37 INFO  Executing generated plans
2022-09-21 18:53:45 INFO  ---RUNTIME: Execution took 8041.835069656372 ms
2022-09-21 18:53:45 INFO  Done!
2022-09-21 18:53:45 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-21 18:53:45 INFO  Running instrumented original pipeline...
2022-09-21 18:53:45 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-21 18:53:45 INFO  ---RUNTIME: Importing and monkey-patching took 5.791902542114258 ms
2022-09-21 18:53:52 INFO  ---RUNTIME: Original pipeline execution took 7408.124685287476 ms (excluding imports and monkey-patching)
2022-09-21 18:53:52 INFO  Starting execution of 1 what-if analyses...
2022-09-21 18:53:52 INFO  Start plan generation for analysis PermutationFeatureImportance...
2022-09-21 18:53:52 INFO  ---RUNTIME: Plan generation took 0.09608268737792969 ms
2022-09-21 18:53:52 INFO  Estimated runtime of original DAG is 5467.455148696899ms
2022-09-21 18:53:52 WARNING Skipping Multi-Query Optimization (instead, only applying patches)
2022-09-21 18:53:52 INFO  Estimated unoptimised what-if runtime is 27337.275743484497ms
2022-09-21 18:53:52 INFO  ---RUNTIME: Multi-Query Optimization took 3.6437511444091797 ms
2022-09-21 18:53:52 INFO  Executing generated plans
2022-09-21 18:54:29 INFO  ---RUNTIME: Execution took 37139.72806930542 ms
2022-09-21 18:54:29 INFO  Done!
2022-09-21 18:54:29 INFO  # Finished -- repetition 7 of 7 
2022-09-21 18:54:29 INFO  # Final results after all repetitions
2022-09-21 18:54:29 INFO     repetition  ... no_opt_what_if_execution_combined_model_training
0           0  ...                                      3735.353470
1           1  ...                                      3711.089373
2           2  ...                                      3871.097803
3           3  ...                                      3916.791201
4           4  ...                                      3905.534267
5           5  ...                                      3848.903179
6           6  ...                                      8472.364664

[7 rows x 26 columns]
taskset -c 32-39 PROTOCOL_BUFFERS_PYTHON_IMPLEMENTATION=python python3.9 benchmarks_end_to_end.py feature_importance reviews fast_loading featurization_0 neural_network
2022-09-21 18:54:31.998835: W tensorflow/stream_executor/platform/default/dso_loader.cc:64] Could not load dynamic library 'libcudart.so.11.0'; dlerror: libcudart.so.11.0: cannot open shared object file: No such file or directory; LD_LIBRARY_PATH: /home/sgrafbe/mlwhatif/venv/lib/python3.9/site-packages/cv2/../../lib64:
2022-09-21 18:54:31.998878: I tensorflow/stream_executor/cuda/cudart_stub.cc:29] Ignore above cudart dlerror if you do not have a GPU set up on your machine.
2022-09-21 18:54:33 INFO  Patching sys.argv with ['mlwhatif', 'reviews', 'fast_loading', 'featurization_0', 'neural_network']
2022-09-21 18:54:33 INFO  Running instrumented original pipeline...
2022-09-21 18:54:33 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-21 18:54:33 INFO  ---RUNTIME: Importing and monkey-patching took 132.09915161132812 ms
2022-09-21 18:54:38.776437: W tensorflow/stream_executor/platform/default/dso_loader.cc:64] Could not load dynamic library 'libcuda.so.1'; dlerror: libcuda.so.1: cannot open shared object file: No such file or directory; LD_LIBRARY_PATH: /home/sgrafbe/mlwhatif/venv/lib/python3.9/site-packages/cv2/../../lib64:
2022-09-21 18:54:38.776478: W tensorflow/stream_executor/cuda/cuda_driver.cc:326] failed call to cuInit: UNKNOWN ERROR (303)
2022-09-21 18:54:38.776503: I tensorflow/stream_executor/cuda/cuda_diagnostics.cc:156] kernel driver does not appear to be running on this host (angus): /proc/driver/nvidia/version does not exist
2022-09-21 18:54:38.777040: I tensorflow/core/platform/cpu_feature_guard.cc:142] This TensorFlow binary is optimized with oneAPI Deep Neural Network Library (oneDNN) to use the following CPU instructions in performance-critical operations:  AVX2 FMA
To enable them in other operations, rebuild TensorFlow with the appropriate compiler flags.
2022-09-21 18:54:39.007563: I tensorflow/compiler/mlir/mlir_graph_optimization_pass.cc:176] None of the MLIR Optimization Passes are enabled (registered 2)
2022-09-21 18:54:39.019197: I tensorflow/core/platform/profile_utils/cpu_utils.cc:114] CPU Frequency: 2595130000 Hz
2022-09-21 18:54:44 INFO  ---RUNTIME: Original pipeline execution took 10854.969263076782 ms (excluding imports and monkey-patching)
2022-09-21 18:54:44 INFO  Starting execution of 0 what-if analyses...
2022-09-21 18:54:44 INFO  Estimated runtime of original DAG is 9090.840578079224ms
2022-09-21 18:54:44 INFO  Performing Multi-Query Optimization
2022-09-21 18:54:44 INFO  Estimated unoptimized what-if runtime is 0ms
2022-09-21 18:54:44 INFO  Estimated optimised what-if runtime is 0ms
2022-09-21 18:54:44 INFO  Estimated optimisation runtime saving is 0ms
2022-09-21 18:54:44 INFO  ---RUNTIME: Multi-Query Optimization took 0.46634674072265625 ms
2022-09-21 18:54:44 INFO  Executing generated plans
2022-09-21 18:54:44 INFO  ---RUNTIME: Execution took 0.024557113647460938 ms
2022-09-21 18:54:44 INFO  Done!
2022-09-21 18:54:44 INFO  # Optimization benchmark for feature_importance with args [['reviews', 'fast_loading', 'featurization_0', 'neural_network']] -- repetition 1 of 7
2022-09-21 18:54:44 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-21 18:54:44 INFO  Running instrumented original pipeline...
2022-09-21 18:54:44 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-21 18:54:44 INFO  ---RUNTIME: Importing and monkey-patching took 6.011247634887695 ms
2022-09-21 18:54:54 INFO  ---RUNTIME: Original pipeline execution took 10336.301803588867 ms (excluding imports and monkey-patching)
2022-09-21 18:54:54 INFO  Starting execution of 1 what-if analyses...
2022-09-21 18:54:54 INFO  Start plan generation for analysis PermutationFeatureImportance...
2022-09-21 18:54:54 INFO  ---RUNTIME: Plan generation took 0.19049644470214844 ms
2022-09-21 18:54:54 INFO  Estimated runtime of original DAG is 8715.836763381958ms
2022-09-21 18:54:54 INFO  Performing Multi-Query Optimization
2022-09-21 18:54:54 INFO  Estimated unoptimized what-if runtime is 43579.18381690979ms
2022-09-21 18:54:54 INFO  Estimated optimised what-if runtime is 11553.570747375488ms
2022-09-21 18:54:54 INFO  Estimated optimisation runtime saving is 32025.6130695343ms
2022-09-21 18:54:54 INFO  ---RUNTIME: Multi-Query Optimization took 9.297370910644531 ms
2022-09-21 18:54:54 INFO  Executing generated plans
2022-09-21 18:55:07 INFO  ---RUNTIME: Execution took 12303.072929382324 ms
2022-09-21 18:55:07 INFO  Done!
2022-09-21 18:55:07 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-21 18:55:07 INFO  Running instrumented original pipeline...
2022-09-21 18:55:07 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-21 18:55:07 INFO  ---RUNTIME: Importing and monkey-patching took 6.485462188720703 ms
2022-09-21 18:55:17 INFO  ---RUNTIME: Original pipeline execution took 10587.743759155273 ms (excluding imports and monkey-patching)
2022-09-21 18:55:17 INFO  Starting execution of 1 what-if analyses...
2022-09-21 18:55:17 INFO  Start plan generation for analysis PermutationFeatureImportance...
2022-09-21 18:55:17 INFO  ---RUNTIME: Plan generation took 0.12373924255371094 ms
2022-09-21 18:55:17 INFO  Estimated runtime of original DAG is 8758.196592330933ms
2022-09-21 18:55:17 WARNING Skipping Multi-Query Optimization (instead, only applying patches)
2022-09-21 18:55:17 INFO  Estimated unoptimised what-if runtime is 43790.98296165466ms
2022-09-21 18:55:17 INFO  ---RUNTIME: Multi-Query Optimization took 5.153656005859375 ms
2022-09-21 18:55:17 INFO  Executing generated plans
2022-09-21 18:56:04 INFO  ---RUNTIME: Execution took 47286.006450653076 ms
2022-09-21 18:56:04 INFO  Done!
2022-09-21 18:56:04 INFO  # Finished -- repetition 1 of 7 
2022-09-21 18:56:04 INFO  # Optimization benchmark for feature_importance with args [['reviews', 'fast_loading', 'featurization_0', 'neural_network']] -- repetition 2 of 7
2022-09-21 18:56:04 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-21 18:56:04 INFO  Running instrumented original pipeline...
2022-09-21 18:56:04 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-21 18:56:04 INFO  ---RUNTIME: Importing and monkey-patching took 5.91588020324707 ms
2022-09-21 18:56:14 INFO  ---RUNTIME: Original pipeline execution took 10008.65626335144 ms (excluding imports and monkey-patching)
2022-09-21 18:56:14 INFO  Starting execution of 1 what-if analyses...
2022-09-21 18:56:14 INFO  Start plan generation for analysis PermutationFeatureImportance...
2022-09-21 18:56:14 INFO  ---RUNTIME: Plan generation took 0.11992454528808594 ms
2022-09-21 18:56:14 INFO  Estimated runtime of original DAG is 8328.644275665283ms
2022-09-21 18:56:14 INFO  Performing Multi-Query Optimization
2022-09-21 18:56:14 INFO  Estimated unoptimized what-if runtime is 41643.221378326416ms
2022-09-21 18:56:14 INFO  Estimated optimised what-if runtime is 11142.119884490967ms
2022-09-21 18:56:14 INFO  Estimated optimisation runtime saving is 30501.10149383545ms
2022-09-21 18:56:14 INFO  ---RUNTIME: Multi-Query Optimization took 9.19795036315918 ms
2022-09-21 18:56:14 INFO  Executing generated plans
2022-09-21 18:56:27 INFO  ---RUNTIME: Execution took 12279.983758926392 ms
2022-09-21 18:56:27 INFO  Done!
2022-09-21 18:56:27 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-21 18:56:27 INFO  Running instrumented original pipeline...
2022-09-21 18:56:27 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-21 18:56:27 INFO  ---RUNTIME: Importing and monkey-patching took 6.451845169067383 ms
2022-09-21 18:56:37 INFO  ---RUNTIME: Original pipeline execution took 10159.663438796997 ms (excluding imports and monkey-patching)
2022-09-21 18:56:37 INFO  Starting execution of 1 what-if analyses...
2022-09-21 18:56:37 INFO  Start plan generation for analysis PermutationFeatureImportance...
2022-09-21 18:56:37 INFO  ---RUNTIME: Plan generation took 0.11944770812988281 ms
2022-09-21 18:56:37 INFO  Estimated runtime of original DAG is 8502.759218215942ms
2022-09-21 18:56:37 WARNING Skipping Multi-Query Optimization (instead, only applying patches)
2022-09-21 18:56:37 INFO  Estimated unoptimised what-if runtime is 42513.79609107971ms
2022-09-21 18:56:37 INFO  ---RUNTIME: Multi-Query Optimization took 3.902435302734375 ms
2022-09-21 18:56:37 INFO  Executing generated plans
2022-09-21 18:57:25 INFO  ---RUNTIME: Execution took 47852.277517318726 ms
2022-09-21 18:57:25 INFO  Done!
2022-09-21 18:57:25 INFO  # Finished -- repetition 2 of 7 
2022-09-21 18:57:25 INFO  # Optimization benchmark for feature_importance with args [['reviews', 'fast_loading', 'featurization_0', 'neural_network']] -- repetition 3 of 7
2022-09-21 18:57:25 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-21 18:57:25 INFO  Running instrumented original pipeline...
2022-09-21 18:57:25 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-21 18:57:25 INFO  ---RUNTIME: Importing and monkey-patching took 5.964756011962891 ms
2022-09-21 18:57:35 INFO  ---RUNTIME: Original pipeline execution took 10421.398639678955 ms (excluding imports and monkey-patching)
2022-09-21 18:57:35 INFO  Starting execution of 1 what-if analyses...
2022-09-21 18:57:35 INFO  Start plan generation for analysis PermutationFeatureImportance...
2022-09-21 18:57:35 INFO  ---RUNTIME: Plan generation took 0.1251697540283203 ms
2022-09-21 18:57:35 INFO  Estimated runtime of original DAG is 8778.452634811401ms
2022-09-21 18:57:35 INFO  Performing Multi-Query Optimization
2022-09-21 18:57:35 INFO  Estimated unoptimized what-if runtime is 43892.26317405701ms
2022-09-21 18:57:35 INFO  Estimated optimised what-if runtime is 11633.810997009277ms
2022-09-21 18:57:35 INFO  Estimated optimisation runtime saving is 32258.45217704773ms
2022-09-21 18:57:35 INFO  ---RUNTIME: Multi-Query Optimization took 9.104728698730469 ms
2022-09-21 18:57:35 INFO  Executing generated plans
2022-09-21 18:57:48 INFO  ---RUNTIME: Execution took 12405.378341674805 ms
2022-09-21 18:57:48 INFO  Done!
2022-09-21 18:57:48 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-21 18:57:48 INFO  Running instrumented original pipeline...
2022-09-21 18:57:48 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-21 18:57:48 INFO  ---RUNTIME: Importing and monkey-patching took 5.859613418579102 ms
2022-09-21 18:57:58 INFO  ---RUNTIME: Original pipeline execution took 10548.285484313965 ms (excluding imports and monkey-patching)
2022-09-21 18:57:58 INFO  Starting execution of 1 what-if analyses...
2022-09-21 18:57:58 INFO  Start plan generation for analysis PermutationFeatureImportance...
2022-09-21 18:57:58 INFO  ---RUNTIME: Plan generation took 0.09584426879882812 ms
2022-09-21 18:57:58 INFO  Estimated runtime of original DAG is 8457.87262916565ms
2022-09-21 18:57:58 WARNING Skipping Multi-Query Optimization (instead, only applying patches)
2022-09-21 18:57:58 INFO  Estimated unoptimised what-if runtime is 42289.36314582825ms
2022-09-21 18:57:58 INFO  ---RUNTIME: Multi-Query Optimization took 3.5643577575683594 ms
2022-09-21 18:57:58 INFO  Executing generated plans
2022-09-21 18:58:45 INFO  ---RUNTIME: Execution took 47227.62870788574 ms
2022-09-21 18:58:45 INFO  Done!
2022-09-21 18:58:45 INFO  # Finished -- repetition 3 of 7 
2022-09-21 18:58:45 INFO  # Optimization benchmark for feature_importance with args [['reviews', 'fast_loading', 'featurization_0', 'neural_network']] -- repetition 4 of 7
2022-09-21 18:58:45 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-21 18:58:45 INFO  Running instrumented original pipeline...
2022-09-21 18:58:45 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-21 18:58:45 INFO  ---RUNTIME: Importing and monkey-patching took 6.200551986694336 ms
2022-09-21 18:58:56 INFO  ---RUNTIME: Original pipeline execution took 10461.654424667358 ms (excluding imports and monkey-patching)
2022-09-21 18:58:56 INFO  Starting execution of 1 what-if analyses...
2022-09-21 18:58:56 INFO  Start plan generation for analysis PermutationFeatureImportance...
2022-09-21 18:58:56 INFO  ---RUNTIME: Plan generation took 0.10943412780761719 ms
2022-09-21 18:58:56 INFO  Estimated runtime of original DAG is 8775.827169418335ms
2022-09-21 18:58:56 INFO  Performing Multi-Query Optimization
2022-09-21 18:58:56 INFO  Estimated unoptimized what-if runtime is 43879.135847091675ms
2022-09-21 18:58:56 INFO  Estimated optimised what-if runtime is 11755.397081375122ms
2022-09-21 18:58:56 INFO  Estimated optimisation runtime saving is 32123.738765716553ms
2022-09-21 18:58:56 INFO  ---RUNTIME: Multi-Query Optimization took 10.029077529907227 ms
2022-09-21 18:58:56 INFO  Executing generated plans
2022-09-21 18:59:08 INFO  ---RUNTIME: Execution took 12634.25064086914 ms
2022-09-21 18:59:08 INFO  Done!
2022-09-21 18:59:08 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-21 18:59:08 INFO  Running instrumented original pipeline...
2022-09-21 18:59:09 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-21 18:59:09 INFO  ---RUNTIME: Importing and monkey-patching took 6.520509719848633 ms
2022-09-21 18:59:19 INFO  ---RUNTIME: Original pipeline execution took 10319.526195526123 ms (excluding imports and monkey-patching)
2022-09-21 18:59:19 INFO  Starting execution of 1 what-if analyses...
2022-09-21 18:59:19 INFO  Start plan generation for analysis PermutationFeatureImportance...
2022-09-21 18:59:19 INFO  ---RUNTIME: Plan generation took 0.10323524475097656 ms
2022-09-21 18:59:19 INFO  Estimated runtime of original DAG is 8657.839298248291ms
2022-09-21 18:59:19 WARNING Skipping Multi-Query Optimization (instead, only applying patches)
2022-09-21 18:59:19 INFO  Estimated unoptimised what-if runtime is 43289.196491241455ms
2022-09-21 18:59:19 INFO  ---RUNTIME: Multi-Query Optimization took 3.582477569580078 ms
2022-09-21 18:59:19 INFO  Executing generated plans
2022-09-21 19:00:06 INFO  ---RUNTIME: Execution took 47468.863010406494 ms
2022-09-21 19:00:06 INFO  Done!
2022-09-21 19:00:06 INFO  # Finished -- repetition 4 of 7 
2022-09-21 19:00:06 INFO  # Optimization benchmark for feature_importance with args [['reviews', 'fast_loading', 'featurization_0', 'neural_network']] -- repetition 5 of 7
2022-09-21 19:00:06 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-21 19:00:06 INFO  Running instrumented original pipeline...
2022-09-21 19:00:06 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-21 19:00:06 INFO  ---RUNTIME: Importing and monkey-patching took 6.441831588745117 ms
2022-09-21 19:00:17 INFO  ---RUNTIME: Original pipeline execution took 10381.526231765747 ms (excluding imports and monkey-patching)
2022-09-21 19:00:17 INFO  Starting execution of 1 what-if analyses...
2022-09-21 19:00:17 INFO  Start plan generation for analysis PermutationFeatureImportance...
2022-09-21 19:00:17 INFO  ---RUNTIME: Plan generation took 0.10943412780761719 ms
2022-09-21 19:00:17 INFO  Estimated runtime of original DAG is 8716.63212776184ms
2022-09-21 19:00:17 INFO  Performing Multi-Query Optimization
2022-09-21 19:00:17 INFO  Estimated unoptimized what-if runtime is 43583.160638809204ms
2022-09-21 19:00:17 INFO  Estimated optimised what-if runtime is 11623.854160308838ms
2022-09-21 19:00:17 INFO  Estimated optimisation runtime saving is 31959.306478500366ms
2022-09-21 19:00:17 INFO  ---RUNTIME: Multi-Query Optimization took 10.722875595092773 ms
2022-09-21 19:00:17 INFO  Executing generated plans
2022-09-21 19:00:29 INFO  ---RUNTIME: Execution took 12243.067264556885 ms
2022-09-21 19:00:29 INFO  Done!
2022-09-21 19:00:29 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-21 19:00:29 INFO  Running instrumented original pipeline...
2022-09-21 19:00:29 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-21 19:00:29 INFO  ---RUNTIME: Importing and monkey-patching took 5.853891372680664 ms
2022-09-21 19:00:39 INFO  ---RUNTIME: Original pipeline execution took 10084.869384765625 ms (excluding imports and monkey-patching)
2022-09-21 19:00:39 INFO  Starting execution of 1 what-if analyses...
2022-09-21 19:00:39 INFO  Start plan generation for analysis PermutationFeatureImportance...
2022-09-21 19:00:39 INFO  ---RUNTIME: Plan generation took 0.09870529174804688 ms
2022-09-21 19:00:39 INFO  Estimated runtime of original DAG is 8364.746570587158ms
2022-09-21 19:00:39 WARNING Skipping Multi-Query Optimization (instead, only applying patches)
2022-09-21 19:00:39 INFO  Estimated unoptimised what-if runtime is 41823.73285293579ms
2022-09-21 19:00:39 INFO  ---RUNTIME: Multi-Query Optimization took 3.5009384155273438 ms
2022-09-21 19:00:39 INFO  Executing generated plans
2022-09-21 19:01:28 INFO  ---RUNTIME: Execution took 48614.59016799927 ms
2022-09-21 19:01:28 INFO  Done!
2022-09-21 19:01:28 INFO  # Finished -- repetition 5 of 7 
2022-09-21 19:01:28 INFO  # Optimization benchmark for feature_importance with args [['reviews', 'fast_loading', 'featurization_0', 'neural_network']] -- repetition 6 of 7
2022-09-21 19:01:28 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-21 19:01:28 INFO  Running instrumented original pipeline...
2022-09-21 19:01:28 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-21 19:01:28 INFO  ---RUNTIME: Importing and monkey-patching took 7.189512252807617 ms
2022-09-21 19:01:38 INFO  ---RUNTIME: Original pipeline execution took 10205.016613006592 ms (excluding imports and monkey-patching)
2022-09-21 19:01:38 INFO  Starting execution of 1 what-if analyses...
2022-09-21 19:01:38 INFO  Start plan generation for analysis PermutationFeatureImportance...
2022-09-21 19:01:38 INFO  ---RUNTIME: Plan generation took 0.141143798828125 ms
2022-09-21 19:01:38 INFO  Estimated runtime of original DAG is 8482.082605361938ms
2022-09-21 19:01:38 INFO  Performing Multi-Query Optimization
2022-09-21 19:01:38 INFO  Estimated unoptimized what-if runtime is 42410.41302680969ms
2022-09-21 19:01:38 INFO  Estimated optimised what-if runtime is 11573.56071472168ms
2022-09-21 19:01:38 INFO  Estimated optimisation runtime saving is 30836.852312088013ms
2022-09-21 19:01:38 INFO  ---RUNTIME: Multi-Query Optimization took 11.468172073364258 ms
2022-09-21 19:01:38 INFO  Executing generated plans
2022-09-21 19:01:51 INFO  ---RUNTIME: Execution took 12747.809886932373 ms
2022-09-21 19:01:51 INFO  Done!
2022-09-21 19:01:51 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-21 19:01:51 INFO  Running instrumented original pipeline...
2022-09-21 19:01:51 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-21 19:01:51 INFO  ---RUNTIME: Importing and monkey-patching took 6.183862686157227 ms
2022-09-21 19:02:01 INFO  ---RUNTIME: Original pipeline execution took 10271.560192108154 ms (excluding imports and monkey-patching)
2022-09-21 19:02:01 INFO  Starting execution of 1 what-if analyses...
2022-09-21 19:02:01 INFO  Start plan generation for analysis PermutationFeatureImportance...
2022-09-21 19:02:01 INFO  ---RUNTIME: Plan generation took 0.11444091796875 ms
2022-09-21 19:02:01 INFO  Estimated runtime of original DAG is 8628.169298171997ms
2022-09-21 19:02:01 WARNING Skipping Multi-Query Optimization (instead, only applying patches)
2022-09-21 19:02:01 INFO  Estimated unoptimised what-if runtime is 43140.846490859985ms
2022-09-21 19:02:01 INFO  ---RUNTIME: Multi-Query Optimization took 3.633260726928711 ms
2022-09-21 19:02:01 INFO  Executing generated plans
2022-09-21 19:02:49 INFO  ---RUNTIME: Execution took 47573.63677024841 ms
2022-09-21 19:02:49 INFO  Done!
2022-09-21 19:02:49 INFO  # Finished -- repetition 6 of 7 
2022-09-21 19:02:49 INFO  # Optimization benchmark for feature_importance with args [['reviews', 'fast_loading', 'featurization_0', 'neural_network']] -- repetition 7 of 7
2022-09-21 19:02:49 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-21 19:02:49 INFO  Running instrumented original pipeline...
2022-09-21 19:02:49 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-21 19:02:49 INFO  ---RUNTIME: Importing and monkey-patching took 6.337404251098633 ms
2022-09-21 19:02:59 INFO  ---RUNTIME: Original pipeline execution took 10253.129720687866 ms (excluding imports and monkey-patching)
2022-09-21 19:02:59 INFO  Starting execution of 1 what-if analyses...
2022-09-21 19:02:59 INFO  Start plan generation for analysis PermutationFeatureImportance...
2022-09-21 19:02:59 INFO  ---RUNTIME: Plan generation took 0.12683868408203125 ms
2022-09-21 19:02:59 INFO  Estimated runtime of original DAG is 8539.385318756104ms
2022-09-21 19:02:59 INFO  Performing Multi-Query Optimization
2022-09-21 19:02:59 INFO  Estimated unoptimized what-if runtime is 42696.92659378052ms
2022-09-21 19:02:59 INFO  Estimated optimised what-if runtime is 11364.093780517578ms
2022-09-21 19:02:59 INFO  Estimated optimisation runtime saving is 31332.83281326294ms
2022-09-21 19:02:59 INFO  ---RUNTIME: Multi-Query Optimization took 10.970592498779297 ms
2022-09-21 19:02:59 INFO  Executing generated plans
2022-09-21 19:03:11 INFO  ---RUNTIME: Execution took 12493.428230285645 ms
2022-09-21 19:03:11 INFO  Done!
2022-09-21 19:03:11 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-21 19:03:11 INFO  Running instrumented original pipeline...
2022-09-21 19:03:11 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-21 19:03:11 INFO  ---RUNTIME: Importing and monkey-patching took 5.88679313659668 ms
2022-09-21 19:03:21 INFO  ---RUNTIME: Original pipeline execution took 9998.319625854492 ms (excluding imports and monkey-patching)
2022-09-21 19:03:21 INFO  Starting execution of 1 what-if analyses...
2022-09-21 19:03:21 INFO  Start plan generation for analysis PermutationFeatureImportance...
2022-09-21 19:03:21 INFO  ---RUNTIME: Plan generation took 0.10609626770019531 ms
2022-09-21 19:03:21 INFO  Estimated runtime of original DAG is 8291.296482086182ms
2022-09-21 19:03:21 WARNING Skipping Multi-Query Optimization (instead, only applying patches)
2022-09-21 19:03:21 INFO  Estimated unoptimised what-if runtime is 41456.48241043091ms
2022-09-21 19:03:21 INFO  ---RUNTIME: Multi-Query Optimization took 3.530740737915039 ms
2022-09-21 19:03:21 INFO  Executing generated plans
2022-09-21 19:04:07 INFO  ---RUNTIME: Execution took 46048.48647117615 ms
2022-09-21 19:04:07 INFO  Done!
2022-09-21 19:04:07 INFO  # Finished -- repetition 7 of 7 
2022-09-21 19:04:07 INFO  # Final results after all repetitions
2022-09-21 19:04:07 INFO     repetition  ... no_opt_what_if_execution_combined_model_training
0           0  ...                                     16664.043665
1           1  ...                                     17460.762739
2           2  ...                                     16412.789583
3           3  ...                                     16957.491159
4           4  ...                                     17914.914131
5           5  ...                                     16338.899851
6           6  ...                                     15921.774864

[7 rows x 26 columns]
taskset -c 32-39 PROTOCOL_BUFFERS_PYTHON_IMPLEMENTATION=python python3.9 benchmarks_end_to_end.py feature_importance reviews fast_loading featurization_1 logistic_regression
2022-09-21 19:04:10.301140: W tensorflow/stream_executor/platform/default/dso_loader.cc:64] Could not load dynamic library 'libcudart.so.11.0'; dlerror: libcudart.so.11.0: cannot open shared object file: No such file or directory; LD_LIBRARY_PATH: /home/sgrafbe/mlwhatif/venv/lib/python3.9/site-packages/cv2/../../lib64:
2022-09-21 19:04:10.301186: I tensorflow/stream_executor/cuda/cudart_stub.cc:29] Ignore above cudart dlerror if you do not have a GPU set up on your machine.
2022-09-21 19:04:11 INFO  Patching sys.argv with ['mlwhatif', 'reviews', 'fast_loading', 'featurization_1', 'logistic_regression']
2022-09-21 19:04:11 INFO  Running instrumented original pipeline...
2022-09-21 19:04:11 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-21 19:04:11 INFO  ---RUNTIME: Importing and monkey-patching took 121.07634544372559 ms
2022-09-21 19:04:18 INFO  ---RUNTIME: Original pipeline execution took 7120.249509811401 ms (excluding imports and monkey-patching)
2022-09-21 19:04:18 INFO  Starting execution of 0 what-if analyses...
2022-09-21 19:04:18 INFO  Estimated runtime of original DAG is 4873.385190963745ms
2022-09-21 19:04:18 INFO  Performing Multi-Query Optimization
2022-09-21 19:04:18 INFO  Estimated unoptimized what-if runtime is 0ms
2022-09-21 19:04:18 INFO  Estimated optimised what-if runtime is 0ms
2022-09-21 19:04:18 INFO  Estimated optimisation runtime saving is 0ms
2022-09-21 19:04:18 INFO  ---RUNTIME: Multi-Query Optimization took 0.5056858062744141 ms
2022-09-21 19:04:18 INFO  Executing generated plans
2022-09-21 19:04:18 INFO  ---RUNTIME: Execution took 0.026702880859375 ms
2022-09-21 19:04:18 INFO  Done!
2022-09-21 19:04:18 INFO  # Optimization benchmark for feature_importance with args [['reviews', 'fast_loading', 'featurization_1', 'logistic_regression']] -- repetition 1 of 7
2022-09-21 19:04:18 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-21 19:04:18 INFO  Running instrumented original pipeline...
2022-09-21 19:04:19 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-21 19:04:19 INFO  ---RUNTIME: Importing and monkey-patching took 6.124019622802734 ms
2022-09-21 19:04:26 INFO  ---RUNTIME: Original pipeline execution took 7312.981843948364 ms (excluding imports and monkey-patching)
2022-09-21 19:04:26 INFO  Starting execution of 1 what-if analyses...
2022-09-21 19:04:26 INFO  Start plan generation for analysis PermutationFeatureImportance...
2022-09-21 19:04:26 INFO  ---RUNTIME: Plan generation took 0.2872943878173828 ms
2022-09-21 19:04:26 INFO  Estimated runtime of original DAG is 4882.899045944214ms
2022-09-21 19:04:26 INFO  Performing Multi-Query Optimization
2022-09-21 19:04:26 INFO  Estimated unoptimized what-if runtime is 24414.49522972107ms
2022-09-21 19:04:26 INFO  Estimated optimised what-if runtime is 6211.119890213013ms
2022-09-21 19:04:26 INFO  Estimated optimisation runtime saving is 18203.375339508057ms
2022-09-21 19:04:26 INFO  ---RUNTIME: Multi-Query Optimization took 10.230541229248047 ms
2022-09-21 19:04:26 INFO  Executing generated plans
2022-09-21 19:04:33 INFO  ---RUNTIME: Execution took 7097.823143005371 ms
2022-09-21 19:04:33 INFO  Done!
2022-09-21 19:04:33 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-21 19:04:33 INFO  Running instrumented original pipeline...
2022-09-21 19:04:33 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-21 19:04:33 INFO  ---RUNTIME: Importing and monkey-patching took 5.917787551879883 ms
2022-09-21 19:04:40 INFO  ---RUNTIME: Original pipeline execution took 7089.015483856201 ms (excluding imports and monkey-patching)
2022-09-21 19:04:40 INFO  Starting execution of 1 what-if analyses...
2022-09-21 19:04:40 INFO  Start plan generation for analysis PermutationFeatureImportance...
2022-09-21 19:04:40 INFO  ---RUNTIME: Plan generation took 0.23174285888671875 ms
2022-09-21 19:04:40 INFO  Estimated runtime of original DAG is 4877.588987350464ms
2022-09-21 19:04:40 WARNING Skipping Multi-Query Optimization (instead, only applying patches)
2022-09-21 19:04:40 INFO  Estimated unoptimised what-if runtime is 24387.94493675232ms
2022-09-21 19:04:40 INFO  ---RUNTIME: Multi-Query Optimization took 4.018306732177734 ms
2022-09-21 19:04:40 INFO  Executing generated plans
2022-09-21 19:05:09 INFO  ---RUNTIME: Execution took 28796.881914138794 ms
2022-09-21 19:05:09 INFO  Done!
2022-09-21 19:05:09 INFO  # Finished -- repetition 1 of 7 
2022-09-21 19:05:09 INFO  # Optimization benchmark for feature_importance with args [['reviews', 'fast_loading', 'featurization_1', 'logistic_regression']] -- repetition 2 of 7
2022-09-21 19:05:09 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-21 19:05:09 INFO  Running instrumented original pipeline...
2022-09-21 19:05:09 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-21 19:05:09 INFO  ---RUNTIME: Importing and monkey-patching took 6.161928176879883 ms
2022-09-21 19:05:16 INFO  ---RUNTIME: Original pipeline execution took 7078.971862792969 ms (excluding imports and monkey-patching)
2022-09-21 19:05:16 INFO  Starting execution of 1 what-if analyses...
2022-09-21 19:05:16 INFO  Start plan generation for analysis PermutationFeatureImportance...
2022-09-21 19:05:16 INFO  ---RUNTIME: Plan generation took 0.23055076599121094 ms
2022-09-21 19:05:16 INFO  Estimated runtime of original DAG is 4871.475696563721ms
2022-09-21 19:05:16 INFO  Performing Multi-Query Optimization
2022-09-21 19:05:16 INFO  Estimated unoptimized what-if runtime is 24357.378482818604ms
2022-09-21 19:05:16 INFO  Estimated optimised what-if runtime is 6202.638149261475ms
2022-09-21 19:05:16 INFO  Estimated optimisation runtime saving is 18154.74033355713ms
2022-09-21 19:05:16 INFO  ---RUNTIME: Multi-Query Optimization took 10.00833511352539 ms
2022-09-21 19:05:16 INFO  Executing generated plans
2022-09-21 19:05:23 INFO  ---RUNTIME: Execution took 7139.2457485198975 ms
2022-09-21 19:05:23 INFO  Done!
2022-09-21 19:05:23 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-21 19:05:23 INFO  Running instrumented original pipeline...
2022-09-21 19:05:23 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-21 19:05:23 INFO  ---RUNTIME: Importing and monkey-patching took 6.050348281860352 ms
2022-09-21 19:05:30 INFO  ---RUNTIME: Original pipeline execution took 7111.667633056641 ms (excluding imports and monkey-patching)
2022-09-21 19:05:30 INFO  Starting execution of 1 what-if analyses...
2022-09-21 19:05:30 INFO  Start plan generation for analysis PermutationFeatureImportance...
2022-09-21 19:05:30 INFO  ---RUNTIME: Plan generation took 0.2353191375732422 ms
2022-09-21 19:05:30 INFO  Estimated runtime of original DAG is 4863.311767578125ms
2022-09-21 19:05:30 WARNING Skipping Multi-Query Optimization (instead, only applying patches)
2022-09-21 19:05:30 INFO  Estimated unoptimised what-if runtime is 24316.558837890625ms
2022-09-21 19:05:30 INFO  ---RUNTIME: Multi-Query Optimization took 3.958463668823242 ms
2022-09-21 19:05:30 INFO  Executing generated plans
2022-09-21 19:05:59 INFO  ---RUNTIME: Execution took 28819.252729415894 ms
2022-09-21 19:05:59 INFO  Done!
2022-09-21 19:05:59 INFO  # Finished -- repetition 2 of 7 
2022-09-21 19:05:59 INFO  # Optimization benchmark for feature_importance with args [['reviews', 'fast_loading', 'featurization_1', 'logistic_regression']] -- repetition 3 of 7
2022-09-21 19:05:59 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-21 19:05:59 INFO  Running instrumented original pipeline...
2022-09-21 19:05:59 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-21 19:05:59 INFO  ---RUNTIME: Importing and monkey-patching took 6.103038787841797 ms
2022-09-21 19:06:06 INFO  ---RUNTIME: Original pipeline execution took 7165.256500244141 ms (excluding imports and monkey-patching)
2022-09-21 19:06:06 INFO  Starting execution of 1 what-if analyses...
2022-09-21 19:06:06 INFO  Start plan generation for analysis PermutationFeatureImportance...
2022-09-21 19:06:06 INFO  ---RUNTIME: Plan generation took 0.24366378784179688 ms
2022-09-21 19:06:06 INFO  Estimated runtime of original DAG is 4924.783229827881ms
2022-09-21 19:06:06 INFO  Performing Multi-Query Optimization
2022-09-21 19:06:06 INFO  Estimated unoptimized what-if runtime is 24623.916149139404ms
2022-09-21 19:06:06 INFO  Estimated optimised what-if runtime is 6259.582281112671ms
2022-09-21 19:06:06 INFO  Estimated optimisation runtime saving is 18364.333868026733ms
2022-09-21 19:06:06 INFO  ---RUNTIME: Multi-Query Optimization took 10.015249252319336 ms
2022-09-21 19:06:06 INFO  Executing generated plans
2022-09-21 19:06:13 INFO  ---RUNTIME: Execution took 7052.134990692139 ms
2022-09-21 19:06:13 INFO  Done!
2022-09-21 19:06:13 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-21 19:06:13 INFO  Running instrumented original pipeline...
2022-09-21 19:06:13 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-21 19:06:13 INFO  ---RUNTIME: Importing and monkey-patching took 5.705118179321289 ms
2022-09-21 19:06:20 INFO  ---RUNTIME: Original pipeline execution took 7138.285160064697 ms (excluding imports and monkey-patching)
2022-09-21 19:06:20 INFO  Starting execution of 1 what-if analyses...
2022-09-21 19:06:20 INFO  Start plan generation for analysis PermutationFeatureImportance...
2022-09-21 19:06:20 INFO  ---RUNTIME: Plan generation took 0.2205371856689453 ms
2022-09-21 19:06:20 INFO  Estimated runtime of original DAG is 4927.279472351074ms
2022-09-21 19:06:20 WARNING Skipping Multi-Query Optimization (instead, only applying patches)
2022-09-21 19:06:20 INFO  Estimated unoptimised what-if runtime is 24636.39736175537ms
2022-09-21 19:06:20 INFO  ---RUNTIME: Multi-Query Optimization took 3.8628578186035156 ms
2022-09-21 19:06:20 INFO  Executing generated plans
2022-09-21 19:06:49 INFO  ---RUNTIME: Execution took 28812.279224395752 ms
2022-09-21 19:06:49 INFO  Done!
2022-09-21 19:06:49 INFO  # Finished -- repetition 3 of 7 
2022-09-21 19:06:49 INFO  # Optimization benchmark for feature_importance with args [['reviews', 'fast_loading', 'featurization_1', 'logistic_regression']] -- repetition 4 of 7
2022-09-21 19:06:49 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-21 19:06:49 INFO  Running instrumented original pipeline...
2022-09-21 19:06:49 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-21 19:06:49 INFO  ---RUNTIME: Importing and monkey-patching took 6.210088729858398 ms
2022-09-21 19:06:57 INFO  ---RUNTIME: Original pipeline execution took 7413.048505783081 ms (excluding imports and monkey-patching)
2022-09-21 19:06:57 INFO  Starting execution of 1 what-if analyses...
2022-09-21 19:06:57 INFO  Start plan generation for analysis PermutationFeatureImportance...
2022-09-21 19:06:57 INFO  ---RUNTIME: Plan generation took 0.232696533203125 ms
2022-09-21 19:06:57 INFO  Estimated runtime of original DAG is 4878.02529335022ms
2022-09-21 19:06:57 INFO  Performing Multi-Query Optimization
2022-09-21 19:06:57 INFO  Estimated unoptimized what-if runtime is 24390.1264667511ms
2022-09-21 19:06:57 INFO  Estimated optimised what-if runtime is 6215.91329574585ms
2022-09-21 19:06:57 INFO  Estimated optimisation runtime saving is 18174.21317100525ms
2022-09-21 19:06:57 INFO  ---RUNTIME: Multi-Query Optimization took 9.839534759521484 ms
2022-09-21 19:06:57 INFO  Executing generated plans
2022-09-21 19:07:04 INFO  ---RUNTIME: Execution took 7227.7679443359375 ms
2022-09-21 19:07:04 INFO  Done!
2022-09-21 19:07:04 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-21 19:07:04 INFO  Running instrumented original pipeline...
2022-09-21 19:07:04 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-21 19:07:04 INFO  ---RUNTIME: Importing and monkey-patching took 5.629062652587891 ms
2022-09-21 19:07:11 INFO  ---RUNTIME: Original pipeline execution took 7239.733934402466 ms (excluding imports and monkey-patching)
2022-09-21 19:07:11 INFO  Starting execution of 1 what-if analyses...
2022-09-21 19:07:11 INFO  Start plan generation for analysis PermutationFeatureImportance...
2022-09-21 19:07:11 INFO  ---RUNTIME: Plan generation took 0.2777576446533203 ms
2022-09-21 19:07:11 INFO  Estimated runtime of original DAG is 4931.1511516571045ms
2022-09-21 19:07:11 WARNING Skipping Multi-Query Optimization (instead, only applying patches)
2022-09-21 19:07:11 INFO  Estimated unoptimised what-if runtime is 24655.755758285522ms
2022-09-21 19:07:11 INFO  ---RUNTIME: Multi-Query Optimization took 5.832910537719727 ms
2022-09-21 19:07:11 INFO  Executing generated plans
2022-09-21 19:07:40 INFO  ---RUNTIME: Execution took 29134.595155715942 ms
2022-09-21 19:07:40 INFO  Done!
2022-09-21 19:07:40 INFO  # Finished -- repetition 4 of 7 
2022-09-21 19:07:40 INFO  # Optimization benchmark for feature_importance with args [['reviews', 'fast_loading', 'featurization_1', 'logistic_regression']] -- repetition 5 of 7
2022-09-21 19:07:40 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-21 19:07:40 INFO  Running instrumented original pipeline...
2022-09-21 19:07:40 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-21 19:07:40 INFO  ---RUNTIME: Importing and monkey-patching took 6.268978118896484 ms
2022-09-21 19:07:47 INFO  ---RUNTIME: Original pipeline execution took 7178.6370277404785 ms (excluding imports and monkey-patching)
2022-09-21 19:07:47 INFO  Starting execution of 1 what-if analyses...
2022-09-21 19:07:47 INFO  Start plan generation for analysis PermutationFeatureImportance...
2022-09-21 19:07:47 INFO  ---RUNTIME: Plan generation took 0.22172927856445312 ms
2022-09-21 19:07:47 INFO  Estimated runtime of original DAG is 4918.9112186431885ms
2022-09-21 19:07:47 INFO  Performing Multi-Query Optimization
2022-09-21 19:07:47 INFO  Estimated unoptimized what-if runtime is 24594.556093215942ms
2022-09-21 19:07:47 INFO  Estimated optimised what-if runtime is 6251.827239990234ms
2022-09-21 19:07:47 INFO  Estimated optimisation runtime saving is 18342.728853225708ms
2022-09-21 19:07:47 INFO  ---RUNTIME: Multi-Query Optimization took 10.034799575805664 ms
2022-09-21 19:07:47 INFO  Executing generated plans
2022-09-21 19:07:55 INFO  ---RUNTIME: Execution took 7177.006244659424 ms
2022-09-21 19:07:55 INFO  Done!
2022-09-21 19:07:55 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-21 19:07:55 INFO  Running instrumented original pipeline...
2022-09-21 19:07:55 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-21 19:07:55 INFO  ---RUNTIME: Importing and monkey-patching took 5.774736404418945 ms
2022-09-21 19:08:02 INFO  ---RUNTIME: Original pipeline execution took 7201.9829750061035 ms (excluding imports and monkey-patching)
2022-09-21 19:08:02 INFO  Starting execution of 1 what-if analyses...
2022-09-21 19:08:02 INFO  Start plan generation for analysis PermutationFeatureImportance...
2022-09-21 19:08:02 INFO  ---RUNTIME: Plan generation took 0.232696533203125 ms
2022-09-21 19:08:02 INFO  Estimated runtime of original DAG is 4929.996013641357ms
2022-09-21 19:08:02 WARNING Skipping Multi-Query Optimization (instead, only applying patches)
2022-09-21 19:08:02 INFO  Estimated unoptimised what-if runtime is 24649.980068206787ms
2022-09-21 19:08:02 INFO  ---RUNTIME: Multi-Query Optimization took 3.995180130004883 ms
2022-09-21 19:08:02 INFO  Executing generated plans
2022-09-21 19:08:31 INFO  ---RUNTIME: Execution took 28972.498893737793 ms
2022-09-21 19:08:31 INFO  Done!
2022-09-21 19:08:31 INFO  # Finished -- repetition 5 of 7 
2022-09-21 19:08:31 INFO  # Optimization benchmark for feature_importance with args [['reviews', 'fast_loading', 'featurization_1', 'logistic_regression']] -- repetition 6 of 7
2022-09-21 19:08:31 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-21 19:08:31 INFO  Running instrumented original pipeline...
2022-09-21 19:08:31 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-21 19:08:31 INFO  ---RUNTIME: Importing and monkey-patching took 6.047725677490234 ms
2022-09-21 19:08:38 INFO  ---RUNTIME: Original pipeline execution took 7171.571493148804 ms (excluding imports and monkey-patching)
2022-09-21 19:08:38 INFO  Starting execution of 1 what-if analyses...
2022-09-21 19:08:38 INFO  Start plan generation for analysis PermutationFeatureImportance...
2022-09-21 19:08:38 INFO  ---RUNTIME: Plan generation took 0.2593994140625 ms
2022-09-21 19:08:38 INFO  Estimated runtime of original DAG is 4935.819864273071ms
2022-09-21 19:08:38 INFO  Performing Multi-Query Optimization
2022-09-21 19:08:38 INFO  Estimated unoptimized what-if runtime is 24679.099321365356ms
2022-09-21 19:08:38 INFO  Estimated optimised what-if runtime is 6273.642539978027ms
2022-09-21 19:08:38 INFO  Estimated optimisation runtime saving is 18405.45678138733ms
2022-09-21 19:08:38 INFO  ---RUNTIME: Multi-Query Optimization took 15.506744384765625 ms
2022-09-21 19:08:38 INFO  Executing generated plans
2022-09-21 19:08:45 INFO  ---RUNTIME: Execution took 7143.424510955811 ms
2022-09-21 19:08:45 INFO  Done!
2022-09-21 19:08:45 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-21 19:08:45 INFO  Running instrumented original pipeline...
2022-09-21 19:08:45 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-21 19:08:45 INFO  ---RUNTIME: Importing and monkey-patching took 5.754232406616211 ms
2022-09-21 19:08:52 INFO  ---RUNTIME: Original pipeline execution took 7149.89447593689 ms (excluding imports and monkey-patching)
2022-09-21 19:08:52 INFO  Starting execution of 1 what-if analyses...
2022-09-21 19:08:52 INFO  Start plan generation for analysis PermutationFeatureImportance...
2022-09-21 19:08:52 INFO  ---RUNTIME: Plan generation took 0.21076202392578125 ms
2022-09-21 19:08:52 INFO  Estimated runtime of original DAG is 4911.904811859131ms
2022-09-21 19:08:52 WARNING Skipping Multi-Query Optimization (instead, only applying patches)
2022-09-21 19:08:52 INFO  Estimated unoptimised what-if runtime is 24559.524059295654ms
2022-09-21 19:08:52 INFO  ---RUNTIME: Multi-Query Optimization took 3.827333450317383 ms
2022-09-21 19:08:52 INFO  Executing generated plans
2022-09-21 19:09:21 INFO  ---RUNTIME: Execution took 28822.272539138794 ms
2022-09-21 19:09:21 INFO  Done!
2022-09-21 19:09:21 INFO  # Finished -- repetition 6 of 7 
2022-09-21 19:09:21 INFO  # Optimization benchmark for feature_importance with args [['reviews', 'fast_loading', 'featurization_1', 'logistic_regression']] -- repetition 7 of 7
2022-09-21 19:09:21 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-21 19:09:21 INFO  Running instrumented original pipeline...
2022-09-21 19:09:21 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-21 19:09:21 INFO  ---RUNTIME: Importing and monkey-patching took 6.19816780090332 ms
2022-09-21 19:09:28 INFO  ---RUNTIME: Original pipeline execution took 7097.591400146484 ms (excluding imports and monkey-patching)
2022-09-21 19:09:28 INFO  Starting execution of 1 what-if analyses...
2022-09-21 19:09:28 INFO  Start plan generation for analysis PermutationFeatureImportance...
2022-09-21 19:09:28 INFO  ---RUNTIME: Plan generation took 0.12469291687011719 ms
2022-09-21 19:09:28 INFO  Estimated runtime of original DAG is 4890.534162521362ms
2022-09-21 19:09:28 INFO  Performing Multi-Query Optimization
2022-09-21 19:09:28 INFO  Estimated unoptimized what-if runtime is 24452.67081260681ms
2022-09-21 19:09:28 INFO  Estimated optimised what-if runtime is 6225.525140762329ms
2022-09-21 19:09:28 INFO  Estimated optimisation runtime saving is 18227.145671844482ms
2022-09-21 19:09:28 INFO  ---RUNTIME: Multi-Query Optimization took 10.111808776855469 ms
2022-09-21 19:09:28 INFO  Executing generated plans
2022-09-21 19:09:35 INFO  ---RUNTIME: Execution took 7140.326499938965 ms
2022-09-21 19:09:35 INFO  Done!
2022-09-21 19:09:35 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-21 19:09:35 INFO  Running instrumented original pipeline...
2022-09-21 19:09:35 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-21 19:09:35 INFO  ---RUNTIME: Importing and monkey-patching took 5.762577056884766 ms
2022-09-21 19:09:42 INFO  ---RUNTIME: Original pipeline execution took 7154.613018035889 ms (excluding imports and monkey-patching)
2022-09-21 19:09:42 INFO  Starting execution of 1 what-if analyses...
2022-09-21 19:09:42 INFO  Start plan generation for analysis PermutationFeatureImportance...
2022-09-21 19:09:42 INFO  ---RUNTIME: Plan generation took 0.10061264038085938 ms
2022-09-21 19:09:42 INFO  Estimated runtime of original DAG is 4889.295339584351ms
2022-09-21 19:09:42 WARNING Skipping Multi-Query Optimization (instead, only applying patches)
2022-09-21 19:09:42 INFO  Estimated unoptimised what-if runtime is 24446.476697921753ms
2022-09-21 19:09:42 INFO  ---RUNTIME: Multi-Query Optimization took 3.9217472076416016 ms
2022-09-21 19:09:42 INFO  Executing generated plans
2022-09-21 19:10:12 INFO  ---RUNTIME: Execution took 29384.866952896118 ms
2022-09-21 19:10:12 INFO  Done!
2022-09-21 19:10:12 INFO  # Finished -- repetition 7 of 7 
2022-09-21 19:10:12 INFO  # Final results after all repetitions
2022-09-21 19:10:12 INFO     repetition  ... no_opt_what_if_execution_combined_model_training
0           0  ...                                       591.701269
1           1  ...                                       591.205359
2           2  ...                                       587.585449
3           3  ...                                       588.556051
4           4  ...                                       591.159821
5           5  ...                                       589.134693
6           6  ...                                       597.677231

[7 rows x 26 columns]
taskset -c 32-39 PROTOCOL_BUFFERS_PYTHON_IMPLEMENTATION=python python3.9 benchmarks_end_to_end.py feature_importance reviews fast_loading featurization_1 xgboost
2022-09-21 19:10:15.865701: W tensorflow/stream_executor/platform/default/dso_loader.cc:64] Could not load dynamic library 'libcudart.so.11.0'; dlerror: libcudart.so.11.0: cannot open shared object file: No such file or directory; LD_LIBRARY_PATH: /home/sgrafbe/mlwhatif/venv/lib/python3.9/site-packages/cv2/../../lib64:
2022-09-21 19:10:15.865759: I tensorflow/stream_executor/cuda/cudart_stub.cc:29] Ignore above cudart dlerror if you do not have a GPU set up on your machine.
2022-09-21 19:10:17 INFO  Patching sys.argv with ['mlwhatif', 'reviews', 'fast_loading', 'featurization_1', 'xgboost']
2022-09-21 19:10:17 INFO  Running instrumented original pipeline...
2022-09-21 19:10:17 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-21 19:10:18 INFO  ---RUNTIME: Importing and monkey-patching took 148.40340614318848 ms
2022-09-21 19:10:26 INFO  ---RUNTIME: Original pipeline execution took 8261.914491653442 ms (excluding imports and monkey-patching)
2022-09-21 19:10:26 INFO  Starting execution of 0 what-if analyses...
2022-09-21 19:10:26 INFO  Estimated runtime of original DAG is 5979.37798500061ms
2022-09-21 19:10:26 INFO  Performing Multi-Query Optimization
2022-09-21 19:10:26 INFO  Estimated unoptimized what-if runtime is 0ms
2022-09-21 19:10:26 INFO  Estimated optimised what-if runtime is 0ms
2022-09-21 19:10:26 INFO  Estimated optimisation runtime saving is 0ms
2022-09-21 19:10:26 INFO  ---RUNTIME: Multi-Query Optimization took 0.4935264587402344 ms
2022-09-21 19:10:26 INFO  Executing generated plans
2022-09-21 19:10:26 INFO  ---RUNTIME: Execution took 0.024318695068359375 ms
2022-09-21 19:10:26 INFO  Done!
2022-09-21 19:10:26 INFO  # Optimization benchmark for feature_importance with args [['reviews', 'fast_loading', 'featurization_1', 'xgboost']] -- repetition 1 of 7
2022-09-21 19:10:26 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-21 19:10:26 INFO  Running instrumented original pipeline...
2022-09-21 19:10:26 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-21 19:10:26 INFO  ---RUNTIME: Importing and monkey-patching took 6.1244964599609375 ms
2022-09-21 19:10:34 INFO  ---RUNTIME: Original pipeline execution took 8309.705018997192 ms (excluding imports and monkey-patching)
2022-09-21 19:10:34 INFO  Starting execution of 1 what-if analyses...
2022-09-21 19:10:34 INFO  Start plan generation for analysis PermutationFeatureImportance...
2022-09-21 19:10:34 INFO  ---RUNTIME: Plan generation took 0.29850006103515625 ms
2022-09-21 19:10:34 INFO  Estimated runtime of original DAG is 5862.706661224365ms
2022-09-21 19:10:34 INFO  Performing Multi-Query Optimization
2022-09-21 19:10:34 INFO  Estimated unoptimized what-if runtime is 29313.533306121826ms
2022-09-21 19:10:34 INFO  Estimated optimised what-if runtime is 7379.0106773376465ms
2022-09-21 19:10:34 INFO  Estimated optimisation runtime saving is 21934.52262878418ms
2022-09-21 19:10:34 INFO  ---RUNTIME: Multi-Query Optimization took 9.924173355102539 ms
2022-09-21 19:10:34 INFO  Executing generated plans
2022-09-21 19:10:43 INFO  ---RUNTIME: Execution took 8399.569988250732 ms
2022-09-21 19:10:43 INFO  Done!
2022-09-21 19:10:43 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-21 19:10:43 INFO  Running instrumented original pipeline...
2022-09-21 19:10:43 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-21 19:10:43 INFO  ---RUNTIME: Importing and monkey-patching took 6.237506866455078 ms
2022-09-21 19:10:51 INFO  ---RUNTIME: Original pipeline execution took 8184.563398361206 ms (excluding imports and monkey-patching)
2022-09-21 19:10:51 INFO  Starting execution of 1 what-if analyses...
2022-09-21 19:10:51 INFO  Start plan generation for analysis PermutationFeatureImportance...
2022-09-21 19:10:51 INFO  ---RUNTIME: Plan generation took 0.23436546325683594 ms
2022-09-21 19:10:51 INFO  Estimated runtime of original DAG is 5760.408639907837ms
2022-09-21 19:10:51 WARNING Skipping Multi-Query Optimization (instead, only applying patches)
2022-09-21 19:10:51 INFO  Estimated unoptimised what-if runtime is 28802.043199539185ms
2022-09-21 19:10:51 INFO  ---RUNTIME: Multi-Query Optimization took 3.937959671020508 ms
2022-09-21 19:10:51 INFO  Executing generated plans
2022-09-21 19:11:26 INFO  ---RUNTIME: Execution took 35475.191593170166 ms
2022-09-21 19:11:26 INFO  Done!
2022-09-21 19:11:26 INFO  # Finished -- repetition 1 of 7 
2022-09-21 19:11:26 INFO  # Optimization benchmark for feature_importance with args [['reviews', 'fast_loading', 'featurization_1', 'xgboost']] -- repetition 2 of 7
2022-09-21 19:11:26 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-21 19:11:26 INFO  Running instrumented original pipeline...
2022-09-21 19:11:26 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-21 19:11:26 INFO  ---RUNTIME: Importing and monkey-patching took 9.799480438232422 ms
2022-09-21 19:11:35 INFO  ---RUNTIME: Original pipeline execution took 8419.692754745483 ms (excluding imports and monkey-patching)
2022-09-21 19:11:35 INFO  Starting execution of 1 what-if analyses...
2022-09-21 19:11:35 INFO  Start plan generation for analysis PermutationFeatureImportance...
2022-09-21 19:11:35 INFO  ---RUNTIME: Plan generation took 0.2353191375732422 ms
2022-09-21 19:11:35 INFO  Estimated runtime of original DAG is 6145.101070404053ms
2022-09-21 19:11:35 INFO  Performing Multi-Query Optimization
2022-09-21 19:11:35 INFO  Estimated unoptimized what-if runtime is 30725.505352020264ms
2022-09-21 19:11:35 INFO  Estimated optimised what-if runtime is 7860.548496246338ms
2022-09-21 19:11:35 INFO  Estimated optimisation runtime saving is 22864.956855773926ms
2022-09-21 19:11:35 INFO  ---RUNTIME: Multi-Query Optimization took 9.974956512451172 ms
2022-09-21 19:11:35 INFO  Executing generated plans
2022-09-21 19:11:43 INFO  ---RUNTIME: Execution took 8402.060985565186 ms
2022-09-21 19:11:43 INFO  Done!
2022-09-21 19:11:43 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-21 19:11:43 INFO  Running instrumented original pipeline...
2022-09-21 19:11:43 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-21 19:11:43 INFO  ---RUNTIME: Importing and monkey-patching took 6.118059158325195 ms
2022-09-21 19:11:51 INFO  ---RUNTIME: Original pipeline execution took 8271.286725997925 ms (excluding imports and monkey-patching)
2022-09-21 19:11:51 INFO  Starting execution of 1 what-if analyses...
2022-09-21 19:11:51 INFO  Start plan generation for analysis PermutationFeatureImportance...
2022-09-21 19:11:51 INFO  ---RUNTIME: Plan generation took 0.24509429931640625 ms
2022-09-21 19:11:51 INFO  Estimated runtime of original DAG is 5697.954893112183ms
2022-09-21 19:11:51 WARNING Skipping Multi-Query Optimization (instead, only applying patches)
2022-09-21 19:11:51 INFO  Estimated unoptimised what-if runtime is 28489.774465560913ms
2022-09-21 19:11:51 INFO  ---RUNTIME: Multi-Query Optimization took 3.951549530029297 ms
2022-09-21 19:11:51 INFO  Executing generated plans
2022-09-21 19:12:25 INFO  ---RUNTIME: Execution took 34100.23641586304 ms
2022-09-21 19:12:25 INFO  Done!
2022-09-21 19:12:25 INFO  # Finished -- repetition 2 of 7 
2022-09-21 19:12:25 INFO  # Optimization benchmark for feature_importance with args [['reviews', 'fast_loading', 'featurization_1', 'xgboost']] -- repetition 3 of 7
2022-09-21 19:12:25 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-21 19:12:25 INFO  Running instrumented original pipeline...
2022-09-21 19:12:25 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-21 19:12:25 INFO  ---RUNTIME: Importing and monkey-patching took 6.276607513427734 ms
2022-09-21 19:12:34 INFO  ---RUNTIME: Original pipeline execution took 8704.490184783936 ms (excluding imports and monkey-patching)
2022-09-21 19:12:34 INFO  Starting execution of 1 what-if analyses...
2022-09-21 19:12:34 INFO  Start plan generation for analysis PermutationFeatureImportance...
2022-09-21 19:12:34 INFO  ---RUNTIME: Plan generation took 0.591278076171875 ms
2022-09-21 19:12:34 INFO  Estimated runtime of original DAG is 6427.125692367554ms
2022-09-21 19:12:34 INFO  Performing Multi-Query Optimization
2022-09-21 19:12:34 INFO  Estimated unoptimized what-if runtime is 32135.62846183777ms
2022-09-21 19:12:34 INFO  Estimated optimised what-if runtime is 8425.893783569336ms
2022-09-21 19:12:34 INFO  Estimated optimisation runtime saving is 23709.734678268433ms
2022-09-21 19:12:34 INFO  ---RUNTIME: Multi-Query Optimization took 14.629840850830078 ms
2022-09-21 19:12:34 INFO  Executing generated plans
2022-09-21 19:12:43 INFO  ---RUNTIME: Execution took 8994.953870773315 ms
2022-09-21 19:12:43 INFO  Done!
2022-09-21 19:12:43 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-21 19:12:43 INFO  Running instrumented original pipeline...
2022-09-21 19:12:43 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-21 19:12:43 INFO  ---RUNTIME: Importing and monkey-patching took 8.43501091003418 ms
2022-09-21 19:12:51 INFO  ---RUNTIME: Original pipeline execution took 8199.814796447754 ms (excluding imports and monkey-patching)
2022-09-21 19:12:51 INFO  Starting execution of 1 what-if analyses...
2022-09-21 19:12:51 INFO  Start plan generation for analysis PermutationFeatureImportance...
2022-09-21 19:12:51 INFO  ---RUNTIME: Plan generation took 0.44083595275878906 ms
2022-09-21 19:12:51 INFO  Estimated runtime of original DAG is 5914.680242538452ms
2022-09-21 19:12:51 WARNING Skipping Multi-Query Optimization (instead, only applying patches)
2022-09-21 19:12:51 INFO  Estimated unoptimised what-if runtime is 29573.40121269226ms
2022-09-21 19:12:51 INFO  ---RUNTIME: Multi-Query Optimization took 5.511760711669922 ms
2022-09-21 19:12:51 INFO  Executing generated plans
2022-09-21 19:13:26 INFO  ---RUNTIME: Execution took 34260.29634475708 ms
2022-09-21 19:13:26 INFO  Done!
2022-09-21 19:13:26 INFO  # Finished -- repetition 3 of 7 
2022-09-21 19:13:26 INFO  # Optimization benchmark for feature_importance with args [['reviews', 'fast_loading', 'featurization_1', 'xgboost']] -- repetition 4 of 7
2022-09-21 19:13:26 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-21 19:13:26 INFO  Running instrumented original pipeline...
2022-09-21 19:13:26 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-21 19:13:26 INFO  ---RUNTIME: Importing and monkey-patching took 6.133079528808594 ms
2022-09-21 19:13:34 INFO  ---RUNTIME: Original pipeline execution took 8562.289237976074 ms (excluding imports and monkey-patching)
2022-09-21 19:13:34 INFO  Starting execution of 1 what-if analyses...
2022-09-21 19:13:34 INFO  Start plan generation for analysis PermutationFeatureImportance...
2022-09-21 19:13:34 INFO  ---RUNTIME: Plan generation took 0.23293495178222656 ms
2022-09-21 19:13:34 INFO  Estimated runtime of original DAG is 6016.155481338501ms
2022-09-21 19:13:34 INFO  Performing Multi-Query Optimization
2022-09-21 19:13:34 INFO  Estimated unoptimized what-if runtime is 30080.777406692505ms
2022-09-21 19:13:34 INFO  Estimated optimised what-if runtime is 7554.011344909668ms
2022-09-21 19:13:34 INFO  Estimated optimisation runtime saving is 22526.766061782837ms
2022-09-21 19:13:34 INFO  ---RUNTIME: Multi-Query Optimization took 9.687185287475586 ms
2022-09-21 19:13:34 INFO  Executing generated plans
2022-09-21 19:13:43 INFO  ---RUNTIME: Execution took 8838.77682685852 ms
2022-09-21 19:13:43 INFO  Done!
2022-09-21 19:13:43 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-21 19:13:43 INFO  Running instrumented original pipeline...
2022-09-21 19:13:43 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-21 19:13:43 INFO  ---RUNTIME: Importing and monkey-patching took 9.756088256835938 ms
2022-09-21 19:13:52 INFO  ---RUNTIME: Original pipeline execution took 9007.956504821777 ms (excluding imports and monkey-patching)
2022-09-21 19:13:52 INFO  Starting execution of 1 what-if analyses...
2022-09-21 19:13:52 INFO  Start plan generation for analysis PermutationFeatureImportance...
2022-09-21 19:13:52 INFO  ---RUNTIME: Plan generation took 0.3421306610107422 ms
2022-09-21 19:13:52 INFO  Estimated runtime of original DAG is 6625.318765640259ms
2022-09-21 19:13:52 WARNING Skipping Multi-Query Optimization (instead, only applying patches)
2022-09-21 19:13:52 INFO  Estimated unoptimised what-if runtime is 33126.593828201294ms
2022-09-21 19:13:52 INFO  ---RUNTIME: Multi-Query Optimization took 6.870031356811523 ms
2022-09-21 19:13:52 INFO  Executing generated plans
2022-09-21 19:14:27 INFO  ---RUNTIME: Execution took 35105.03101348877 ms
2022-09-21 19:14:27 INFO  Done!
2022-09-21 19:14:27 INFO  # Finished -- repetition 4 of 7 
2022-09-21 19:14:27 INFO  # Optimization benchmark for feature_importance with args [['reviews', 'fast_loading', 'featurization_1', 'xgboost']] -- repetition 5 of 7
2022-09-21 19:14:27 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-21 19:14:27 INFO  Running instrumented original pipeline...
2022-09-21 19:14:27 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-21 19:14:27 INFO  ---RUNTIME: Importing and monkey-patching took 6.175994873046875 ms
2022-09-21 19:14:36 INFO  ---RUNTIME: Original pipeline execution took 8458.862781524658 ms (excluding imports and monkey-patching)
2022-09-21 19:14:36 INFO  Starting execution of 1 what-if analyses...
2022-09-21 19:14:36 INFO  Start plan generation for analysis PermutationFeatureImportance...
2022-09-21 19:14:36 INFO  ---RUNTIME: Plan generation took 0.3714561462402344 ms
2022-09-21 19:14:36 INFO  Estimated runtime of original DAG is 6103.219270706177ms
2022-09-21 19:14:36 INFO  Performing Multi-Query Optimization
2022-09-21 19:14:36 INFO  Estimated unoptimized what-if runtime is 30516.096353530884ms
2022-09-21 19:14:36 INFO  Estimated optimised what-if runtime is 7690.651416778564ms
2022-09-21 19:14:36 INFO  Estimated optimisation runtime saving is 22825.44493675232ms
2022-09-21 19:14:36 INFO  ---RUNTIME: Multi-Query Optimization took 15.467405319213867 ms
2022-09-21 19:14:36 INFO  Executing generated plans
2022-09-21 19:14:44 INFO  ---RUNTIME: Execution took 8444.745779037476 ms
2022-09-21 19:14:44 INFO  Done!
2022-09-21 19:14:44 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-21 19:14:44 INFO  Running instrumented original pipeline...
2022-09-21 19:14:44 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-21 19:14:44 INFO  ---RUNTIME: Importing and monkey-patching took 5.805015563964844 ms
2022-09-21 19:14:53 INFO  ---RUNTIME: Original pipeline execution took 8668.492317199707 ms (excluding imports and monkey-patching)
2022-09-21 19:14:53 INFO  Starting execution of 1 what-if analyses...
2022-09-21 19:14:53 INFO  Start plan generation for analysis PermutationFeatureImportance...
2022-09-21 19:14:53 INFO  ---RUNTIME: Plan generation took 0.3261566162109375 ms
2022-09-21 19:14:53 INFO  Estimated runtime of original DAG is 6382.4098110198975ms
2022-09-21 19:14:53 WARNING Skipping Multi-Query Optimization (instead, only applying patches)
2022-09-21 19:14:53 INFO  Estimated unoptimised what-if runtime is 31912.049055099487ms
2022-09-21 19:14:53 INFO  ---RUNTIME: Multi-Query Optimization took 5.791187286376953 ms
2022-09-21 19:14:53 INFO  Executing generated plans
2022-09-21 19:15:28 INFO  ---RUNTIME: Execution took 35496.19650840759 ms
2022-09-21 19:15:28 INFO  Done!
2022-09-21 19:15:28 INFO  # Finished -- repetition 5 of 7 
2022-09-21 19:15:28 INFO  # Optimization benchmark for feature_importance with args [['reviews', 'fast_loading', 'featurization_1', 'xgboost']] -- repetition 6 of 7
2022-09-21 19:15:28 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-21 19:15:28 INFO  Running instrumented original pipeline...
2022-09-21 19:15:28 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-21 19:15:28 INFO  ---RUNTIME: Importing and monkey-patching took 6.364107131958008 ms
2022-09-21 19:15:37 INFO  ---RUNTIME: Original pipeline execution took 8379.228591918945 ms (excluding imports and monkey-patching)
2022-09-21 19:15:37 INFO  Starting execution of 1 what-if analyses...
2022-09-21 19:15:37 INFO  Start plan generation for analysis PermutationFeatureImportance...
2022-09-21 19:15:37 INFO  ---RUNTIME: Plan generation took 0.225067138671875 ms
2022-09-21 19:15:37 INFO  Estimated runtime of original DAG is 5857.964277267456ms
2022-09-21 19:15:37 INFO  Performing Multi-Query Optimization
2022-09-21 19:15:37 INFO  Estimated unoptimized what-if runtime is 29289.82138633728ms
2022-09-21 19:15:37 INFO  Estimated optimised what-if runtime is 7389.3773555755615ms
2022-09-21 19:15:37 INFO  Estimated optimisation runtime saving is 21900.44403076172ms
2022-09-21 19:15:37 INFO  ---RUNTIME: Multi-Query Optimization took 10.057687759399414 ms
2022-09-21 19:15:37 INFO  Executing generated plans
2022-09-21 19:15:45 INFO  ---RUNTIME: Execution took 8592.081546783447 ms
2022-09-21 19:15:45 INFO  Done!
2022-09-21 19:15:45 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-21 19:15:45 INFO  Running instrumented original pipeline...
2022-09-21 19:15:45 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-21 19:15:45 INFO  ---RUNTIME: Importing and monkey-patching took 8.663415908813477 ms
2022-09-21 19:15:53 INFO  ---RUNTIME: Original pipeline execution took 8106.620788574219 ms (excluding imports and monkey-patching)
2022-09-21 19:15:53 INFO  Starting execution of 1 what-if analyses...
2022-09-21 19:15:53 INFO  Start plan generation for analysis PermutationFeatureImportance...
2022-09-21 19:15:53 INFO  ---RUNTIME: Plan generation took 0.2186298370361328 ms
2022-09-21 19:15:53 INFO  Estimated runtime of original DAG is 5828.5369873046875ms
2022-09-21 19:15:53 WARNING Skipping Multi-Query Optimization (instead, only applying patches)
2022-09-21 19:15:53 INFO  Estimated unoptimised what-if runtime is 29142.684936523438ms
2022-09-21 19:15:53 INFO  ---RUNTIME: Multi-Query Optimization took 3.8442611694335938 ms
2022-09-21 19:15:53 INFO  Executing generated plans
2022-09-21 19:16:29 INFO  ---RUNTIME: Execution took 35606.72450065613 ms
2022-09-21 19:16:29 INFO  Done!
2022-09-21 19:16:29 INFO  # Finished -- repetition 6 of 7 
2022-09-21 19:16:29 INFO  # Optimization benchmark for feature_importance with args [['reviews', 'fast_loading', 'featurization_1', 'xgboost']] -- repetition 7 of 7
2022-09-21 19:16:29 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-21 19:16:29 INFO  Running instrumented original pipeline...
2022-09-21 19:16:29 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-21 19:16:29 INFO  ---RUNTIME: Importing and monkey-patching took 6.42085075378418 ms
2022-09-21 19:16:37 INFO  ---RUNTIME: Original pipeline execution took 8160.550594329834 ms (excluding imports and monkey-patching)
2022-09-21 19:16:37 INFO  Starting execution of 1 what-if analyses...
2022-09-21 19:16:37 INFO  Start plan generation for analysis PermutationFeatureImportance...
2022-09-21 19:16:37 INFO  ---RUNTIME: Plan generation took 0.11730194091796875 ms
2022-09-21 19:16:37 INFO  Estimated runtime of original DAG is 5913.814067840576ms
2022-09-21 19:16:37 INFO  Performing Multi-Query Optimization
2022-09-21 19:16:37 INFO  Estimated unoptimized what-if runtime is 29569.07033920288ms
2022-09-21 19:16:37 INFO  Estimated optimised what-if runtime is 7441.930294036865ms
2022-09-21 19:16:37 INFO  Estimated optimisation runtime saving is 22127.140045166016ms
2022-09-21 19:16:37 INFO  ---RUNTIME: Multi-Query Optimization took 9.857892990112305 ms
2022-09-21 19:16:37 INFO  Executing generated plans
2022-09-21 19:16:46 INFO  ---RUNTIME: Execution took 8495.808839797974 ms
2022-09-21 19:16:46 INFO  Done!
2022-09-21 19:16:46 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-21 19:16:46 INFO  Running instrumented original pipeline...
2022-09-21 19:16:46 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-21 19:16:46 INFO  ---RUNTIME: Importing and monkey-patching took 5.758047103881836 ms
2022-09-21 19:16:54 INFO  ---RUNTIME: Original pipeline execution took 8320.00708580017 ms (excluding imports and monkey-patching)
2022-09-21 19:16:54 INFO  Starting execution of 1 what-if analyses...
2022-09-21 19:16:54 INFO  Start plan generation for analysis PermutationFeatureImportance...
2022-09-21 19:16:54 INFO  ---RUNTIME: Plan generation took 0.10180473327636719 ms
2022-09-21 19:16:54 INFO  Estimated runtime of original DAG is 5935.690402984619ms
2022-09-21 19:16:54 WARNING Skipping Multi-Query Optimization (instead, only applying patches)
2022-09-21 19:16:54 INFO  Estimated unoptimised what-if runtime is 29678.452014923096ms
2022-09-21 19:16:54 INFO  ---RUNTIME: Multi-Query Optimization took 3.9544105529785156 ms
2022-09-21 19:16:54 INFO  Executing generated plans
2022-09-21 19:17:29 INFO  ---RUNTIME: Execution took 35423.75707626343 ms
2022-09-21 19:17:29 INFO  Done!
2022-09-21 19:17:30 INFO  # Finished -- repetition 7 of 7 
2022-09-21 19:17:30 INFO  # Final results after all repetitions
2022-09-21 19:17:30 INFO     repetition  ... no_opt_what_if_execution_combined_model_training
0           0  ...                                      5085.674763
1           1  ...                                      4751.953840
2           2  ...                                      5289.229393
3           3  ...                                      4817.277431
4           4  ...                                      4782.442808
5           5  ...                                      4970.106125
6           6  ...                                      4893.397331

[7 rows x 26 columns]
taskset -c 32-39 PROTOCOL_BUFFERS_PYTHON_IMPLEMENTATION=python python3.9 benchmarks_end_to_end.py feature_importance reviews fast_loading featurization_1 neural_network
2022-09-21 19:17:32.575919: W tensorflow/stream_executor/platform/default/dso_loader.cc:64] Could not load dynamic library 'libcudart.so.11.0'; dlerror: libcudart.so.11.0: cannot open shared object file: No such file or directory; LD_LIBRARY_PATH: /home/sgrafbe/mlwhatif/venv/lib/python3.9/site-packages/cv2/../../lib64:
2022-09-21 19:17:32.575969: I tensorflow/stream_executor/cuda/cudart_stub.cc:29] Ignore above cudart dlerror if you do not have a GPU set up on your machine.
2022-09-21 19:17:33 INFO  Patching sys.argv with ['mlwhatif', 'reviews', 'fast_loading', 'featurization_1', 'neural_network']
2022-09-21 19:17:33 INFO  Running instrumented original pipeline...
2022-09-21 19:17:33 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-21 19:17:34 INFO  ---RUNTIME: Importing and monkey-patching took 120.73636054992676 ms
2022-09-21 19:17:39.973550: W tensorflow/stream_executor/platform/default/dso_loader.cc:64] Could not load dynamic library 'libcuda.so.1'; dlerror: libcuda.so.1: cannot open shared object file: No such file or directory; LD_LIBRARY_PATH: /home/sgrafbe/mlwhatif/venv/lib/python3.9/site-packages/cv2/../../lib64:
2022-09-21 19:17:39.973597: W tensorflow/stream_executor/cuda/cuda_driver.cc:326] failed call to cuInit: UNKNOWN ERROR (303)
2022-09-21 19:17:39.973623: I tensorflow/stream_executor/cuda/cuda_diagnostics.cc:156] kernel driver does not appear to be running on this host (angus): /proc/driver/nvidia/version does not exist
2022-09-21 19:17:39.974257: I tensorflow/core/platform/cpu_feature_guard.cc:142] This TensorFlow binary is optimized with oneAPI Deep Neural Network Library (oneDNN) to use the following CPU instructions in performance-critical operations:  AVX2 FMA
To enable them in other operations, rebuild TensorFlow with the appropriate compiler flags.
2022-09-21 19:17:40.211514: I tensorflow/compiler/mlir/mlir_graph_optimization_pass.cc:176] None of the MLIR Optimization Passes are enabled (registered 2)
2022-09-21 19:17:40.223186: I tensorflow/core/platform/profile_utils/cpu_utils.cc:114] CPU Frequency: 2595130000 Hz
2022-09-21 19:17:45 INFO  ---RUNTIME: Original pipeline execution took 11538.494348526001 ms (excluding imports and monkey-patching)
2022-09-21 19:17:45 INFO  Starting execution of 0 what-if analyses...
2022-09-21 19:17:45 INFO  Estimated runtime of original DAG is 9057.504415512085ms
2022-09-21 19:17:45 INFO  Performing Multi-Query Optimization
2022-09-21 19:17:45 INFO  Estimated unoptimized what-if runtime is 0ms
2022-09-21 19:17:45 INFO  Estimated optimised what-if runtime is 0ms
2022-09-21 19:17:45 INFO  Estimated optimisation runtime saving is 0ms
2022-09-21 19:17:45 INFO  ---RUNTIME: Multi-Query Optimization took 0.49591064453125 ms
2022-09-21 19:17:45 INFO  Executing generated plans
2022-09-21 19:17:45 INFO  ---RUNTIME: Execution took 0.02193450927734375 ms
2022-09-21 19:17:45 INFO  Done!
2022-09-21 19:17:45 INFO  # Optimization benchmark for feature_importance with args [['reviews', 'fast_loading', 'featurization_1', 'neural_network']] -- repetition 1 of 7
2022-09-21 19:17:45 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-21 19:17:45 INFO  Running instrumented original pipeline...
2022-09-21 19:17:45 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-21 19:17:45 INFO  ---RUNTIME: Importing and monkey-patching took 5.769252777099609 ms
2022-09-21 19:17:56 INFO  ---RUNTIME: Original pipeline execution took 10897.97830581665 ms (excluding imports and monkey-patching)
2022-09-21 19:17:56 INFO  Starting execution of 1 what-if analyses...
2022-09-21 19:17:56 INFO  Start plan generation for analysis PermutationFeatureImportance...
2022-09-21 19:17:56 INFO  ---RUNTIME: Plan generation took 0.2148151397705078 ms
2022-09-21 19:17:56 INFO  Estimated runtime of original DAG is 8312.089920043945ms
2022-09-21 19:17:56 INFO  Performing Multi-Query Optimization
2022-09-21 19:17:56 INFO  Estimated unoptimized what-if runtime is 41560.44960021973ms
2022-09-21 19:17:56 INFO  Estimated optimised what-if runtime is 11241.39380455017ms
2022-09-21 19:17:56 INFO  Estimated optimisation runtime saving is 30319.055795669556ms
2022-09-21 19:17:56 INFO  ---RUNTIME: Multi-Query Optimization took 9.987592697143555 ms
2022-09-21 19:17:56 INFO  Executing generated plans
2022-09-21 19:18:08 INFO  ---RUNTIME: Execution took 12327.919721603394 ms
2022-09-21 19:18:08 INFO  Done!
2022-09-21 19:18:08 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-21 19:18:08 INFO  Running instrumented original pipeline...
2022-09-21 19:18:08 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-21 19:18:08 INFO  ---RUNTIME: Importing and monkey-patching took 6.3648223876953125 ms
2022-09-21 19:18:19 INFO  ---RUNTIME: Original pipeline execution took 10966.476440429688 ms (excluding imports and monkey-patching)
2022-09-21 19:18:19 INFO  Starting execution of 1 what-if analyses...
2022-09-21 19:18:19 INFO  Start plan generation for analysis PermutationFeatureImportance...
2022-09-21 19:18:19 INFO  ---RUNTIME: Plan generation took 0.1289844512939453 ms
2022-09-21 19:18:19 INFO  Estimated runtime of original DAG is 8483.40129852295ms
2022-09-21 19:18:19 WARNING Skipping Multi-Query Optimization (instead, only applying patches)
2022-09-21 19:18:19 INFO  Estimated unoptimised what-if runtime is 42417.006492614746ms
2022-09-21 19:18:19 INFO  ---RUNTIME: Multi-Query Optimization took 4.123449325561523 ms
2022-09-21 19:18:19 INFO  Executing generated plans
2022-09-21 19:19:07 INFO  ---RUNTIME: Execution took 47710.158586502075 ms
2022-09-21 19:19:07 INFO  Done!
2022-09-21 19:19:07 INFO  # Finished -- repetition 1 of 7 
2022-09-21 19:19:07 INFO  # Optimization benchmark for feature_importance with args [['reviews', 'fast_loading', 'featurization_1', 'neural_network']] -- repetition 2 of 7
2022-09-21 19:19:07 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-21 19:19:07 INFO  Running instrumented original pipeline...
2022-09-21 19:19:07 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-21 19:19:07 INFO  ---RUNTIME: Importing and monkey-patching took 6.649971008300781 ms
2022-09-21 19:19:18 INFO  ---RUNTIME: Original pipeline execution took 11266.902923583984 ms (excluding imports and monkey-patching)
2022-09-21 19:19:18 INFO  Starting execution of 1 what-if analyses...
2022-09-21 19:19:18 INFO  Start plan generation for analysis PermutationFeatureImportance...
2022-09-21 19:19:18 INFO  ---RUNTIME: Plan generation took 0.10132789611816406 ms
2022-09-21 19:19:18 INFO  Estimated runtime of original DAG is 8772.753953933716ms
2022-09-21 19:19:18 INFO  Performing Multi-Query Optimization
2022-09-21 19:19:18 INFO  Estimated unoptimized what-if runtime is 43863.76976966858ms
2022-09-21 19:19:18 INFO  Estimated optimised what-if runtime is 11652.168989181519ms
2022-09-21 19:19:18 INFO  Estimated optimisation runtime saving is 32211.60078048706ms
2022-09-21 19:19:18 INFO  ---RUNTIME: Multi-Query Optimization took 11.193990707397461 ms
2022-09-21 19:19:18 INFO  Executing generated plans
2022-09-21 19:19:30 INFO  ---RUNTIME: Execution took 12242.239236831665 ms
2022-09-21 19:19:30 INFO  Done!
2022-09-21 19:19:31 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-21 19:19:31 INFO  Running instrumented original pipeline...
2022-09-21 19:19:31 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-21 19:19:31 INFO  ---RUNTIME: Importing and monkey-patching took 5.980491638183594 ms
2022-09-21 19:19:41 INFO  ---RUNTIME: Original pipeline execution took 10751.290559768677 ms (excluding imports and monkey-patching)
2022-09-21 19:19:41 INFO  Starting execution of 1 what-if analyses...
2022-09-21 19:19:41 INFO  Start plan generation for analysis PermutationFeatureImportance...
2022-09-21 19:19:41 INFO  ---RUNTIME: Plan generation took 0.12564659118652344 ms
2022-09-21 19:19:41 INFO  Estimated runtime of original DAG is 8457.570791244507ms
2022-09-21 19:19:41 WARNING Skipping Multi-Query Optimization (instead, only applying patches)
2022-09-21 19:19:41 INFO  Estimated unoptimised what-if runtime is 42287.853956222534ms
2022-09-21 19:19:41 INFO  ---RUNTIME: Multi-Query Optimization took 3.850698471069336 ms
2022-09-21 19:19:41 INFO  Executing generated plans
2022-09-21 19:20:29 INFO  ---RUNTIME: Execution took 47779.28805351257 ms
2022-09-21 19:20:29 INFO  Done!
2022-09-21 19:20:29 INFO  # Finished -- repetition 2 of 7 
2022-09-21 19:20:29 INFO  # Optimization benchmark for feature_importance with args [['reviews', 'fast_loading', 'featurization_1', 'neural_network']] -- repetition 3 of 7
2022-09-21 19:20:29 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-21 19:20:29 INFO  Running instrumented original pipeline...
2022-09-21 19:20:29 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-21 19:20:29 INFO  ---RUNTIME: Importing and monkey-patching took 6.8302154541015625 ms
2022-09-21 19:20:41 INFO  ---RUNTIME: Original pipeline execution took 11570.730924606323 ms (excluding imports and monkey-patching)
2022-09-21 19:20:41 INFO  Starting execution of 1 what-if analyses...
2022-09-21 19:20:41 INFO  Start plan generation for analysis PermutationFeatureImportance...
2022-09-21 19:20:41 INFO  ---RUNTIME: Plan generation took 0.11205673217773438 ms
2022-09-21 19:20:41 INFO  Estimated runtime of original DAG is 9209.053754806519ms
2022-09-21 19:20:41 INFO  Performing Multi-Query Optimization
2022-09-21 19:20:41 INFO  Estimated unoptimized what-if runtime is 46045.26877403259ms
2022-09-21 19:20:41 INFO  Estimated optimised what-if runtime is 12129.380941390991ms
2022-09-21 19:20:41 INFO  Estimated optimisation runtime saving is 33915.8878326416ms
2022-09-21 19:20:41 INFO  ---RUNTIME: Multi-Query Optimization took 9.591102600097656 ms
2022-09-21 19:20:41 INFO  Executing generated plans
2022-09-21 19:20:53 INFO  ---RUNTIME: Execution took 12292.21773147583 ms
2022-09-21 19:20:53 INFO  Done!
2022-09-21 19:20:53 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-21 19:20:53 INFO  Running instrumented original pipeline...
2022-09-21 19:20:53 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-21 19:20:53 INFO  ---RUNTIME: Importing and monkey-patching took 6.0977935791015625 ms
2022-09-21 19:21:04 INFO  ---RUNTIME: Original pipeline execution took 11186.643362045288 ms (excluding imports and monkey-patching)
2022-09-21 19:21:04 INFO  Starting execution of 1 what-if analyses...
2022-09-21 19:21:04 INFO  Start plan generation for analysis PermutationFeatureImportance...
2022-09-21 19:21:04 INFO  ---RUNTIME: Plan generation took 1.9519329071044922 ms
2022-09-21 19:21:04 INFO  Estimated runtime of original DAG is 8882.47013092041ms
2022-09-21 19:21:04 WARNING Skipping Multi-Query Optimization (instead, only applying patches)
2022-09-21 19:21:04 INFO  Estimated unoptimised what-if runtime is 44412.35065460205ms
2022-09-21 19:21:04 INFO  ---RUNTIME: Multi-Query Optimization took 3.6995410919189453 ms
2022-09-21 19:21:04 INFO  Executing generated plans
2022-09-21 19:21:52 INFO  ---RUNTIME: Execution took 47373.8431930542 ms
2022-09-21 19:21:52 INFO  Done!
2022-09-21 19:21:52 INFO  # Finished -- repetition 3 of 7 
2022-09-21 19:21:52 INFO  # Optimization benchmark for feature_importance with args [['reviews', 'fast_loading', 'featurization_1', 'neural_network']] -- repetition 4 of 7
2022-09-21 19:21:52 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-21 19:21:52 INFO  Running instrumented original pipeline...
2022-09-21 19:21:52 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-21 19:21:52 INFO  ---RUNTIME: Importing and monkey-patching took 6.124734878540039 ms
2022-09-21 19:22:02 INFO  ---RUNTIME: Original pipeline execution took 10911.141395568848 ms (excluding imports and monkey-patching)
2022-09-21 19:22:02 INFO  Starting execution of 1 what-if analyses...
2022-09-21 19:22:02 INFO  Start plan generation for analysis PermutationFeatureImportance...
2022-09-21 19:22:02 INFO  ---RUNTIME: Plan generation took 0.10967254638671875 ms
2022-09-21 19:22:02 INFO  Estimated runtime of original DAG is 8669.259071350098ms
2022-09-21 19:22:02 INFO  Performing Multi-Query Optimization
2022-09-21 19:22:02 INFO  Estimated unoptimized what-if runtime is 43346.29535675049ms
2022-09-21 19:22:02 INFO  Estimated optimised what-if runtime is 13033.33306312561ms
2022-09-21 19:22:02 INFO  Estimated optimisation runtime saving is 30312.962293624878ms
2022-09-21 19:22:02 INFO  ---RUNTIME: Multi-Query Optimization took 9.647607803344727 ms
2022-09-21 19:22:02 INFO  Executing generated plans
2022-09-21 19:22:16 INFO  ---RUNTIME: Execution took 13116.36233329773 ms
2022-09-21 19:22:16 INFO  Done!
2022-09-21 19:22:16 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-21 19:22:16 INFO  Running instrumented original pipeline...
2022-09-21 19:22:16 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-21 19:22:16 INFO  ---RUNTIME: Importing and monkey-patching took 6.413459777832031 ms
2022-09-21 19:22:27 INFO  ---RUNTIME: Original pipeline execution took 11117.955446243286 ms (excluding imports and monkey-patching)
2022-09-21 19:22:27 INFO  Starting execution of 1 what-if analyses...
2022-09-21 19:22:27 INFO  Start plan generation for analysis PermutationFeatureImportance...
2022-09-21 19:22:27 INFO  ---RUNTIME: Plan generation took 0.10466575622558594 ms
2022-09-21 19:22:27 INFO  Estimated runtime of original DAG is 8725.600242614746ms
2022-09-21 19:22:27 WARNING Skipping Multi-Query Optimization (instead, only applying patches)
2022-09-21 19:22:27 INFO  Estimated unoptimised what-if runtime is 43628.00121307373ms
2022-09-21 19:22:27 INFO  ---RUNTIME: Multi-Query Optimization took 3.782033920288086 ms
2022-09-21 19:22:27 INFO  Executing generated plans
2022-09-21 19:23:15 INFO  ---RUNTIME: Execution took 47863.20924758911 ms
2022-09-21 19:23:15 INFO  Done!
2022-09-21 19:23:15 INFO  # Finished -- repetition 4 of 7 
2022-09-21 19:23:15 INFO  # Optimization benchmark for feature_importance with args [['reviews', 'fast_loading', 'featurization_1', 'neural_network']] -- repetition 5 of 7
2022-09-21 19:23:15 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-21 19:23:15 INFO  Running instrumented original pipeline...
2022-09-21 19:23:15 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-21 19:23:15 INFO  ---RUNTIME: Importing and monkey-patching took 5.962133407592773 ms
2022-09-21 19:23:26 INFO  ---RUNTIME: Original pipeline execution took 11161.189079284668 ms (excluding imports and monkey-patching)
2022-09-21 19:23:26 INFO  Starting execution of 1 what-if analyses...
2022-09-21 19:23:26 INFO  Start plan generation for analysis PermutationFeatureImportance...
2022-09-21 19:23:26 INFO  ---RUNTIME: Plan generation took 0.11396408081054688 ms
2022-09-21 19:23:26 INFO  Estimated runtime of original DAG is 8879.837989807129ms
2022-09-21 19:23:26 INFO  Performing Multi-Query Optimization
2022-09-21 19:23:26 INFO  Estimated unoptimized what-if runtime is 44399.189949035645ms
2022-09-21 19:23:26 INFO  Estimated optimised what-if runtime is 11821.050643920898ms
2022-09-21 19:23:26 INFO  Estimated optimisation runtime saving is 32578.139305114746ms
2022-09-21 19:23:26 INFO  ---RUNTIME: Multi-Query Optimization took 12.116670608520508 ms
2022-09-21 19:23:26 INFO  Executing generated plans
2022-09-21 19:23:38 INFO  ---RUNTIME: Execution took 12327.084064483643 ms
2022-09-21 19:23:38 INFO  Done!
2022-09-21 19:23:38 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-21 19:23:38 INFO  Running instrumented original pipeline...
2022-09-21 19:23:38 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-21 19:23:38 INFO  ---RUNTIME: Importing and monkey-patching took 5.964517593383789 ms
2022-09-21 19:23:49 INFO  ---RUNTIME: Original pipeline execution took 10629.801750183105 ms (excluding imports and monkey-patching)
2022-09-21 19:23:49 INFO  Starting execution of 1 what-if analyses...
2022-09-21 19:23:49 INFO  Start plan generation for analysis PermutationFeatureImportance...
2022-09-21 19:23:49 INFO  ---RUNTIME: Plan generation took 0.1251697540283203 ms
2022-09-21 19:23:49 INFO  Estimated runtime of original DAG is 8400.858163833618ms
2022-09-21 19:23:49 WARNING Skipping Multi-Query Optimization (instead, only applying patches)
2022-09-21 19:23:49 INFO  Estimated unoptimised what-if runtime is 42004.29081916809ms
2022-09-21 19:23:49 INFO  ---RUNTIME: Multi-Query Optimization took 4.097461700439453 ms
2022-09-21 19:23:49 INFO  Executing generated plans
2022-09-21 19:24:38 INFO  ---RUNTIME: Execution took 49050.36544799805 ms
2022-09-21 19:24:38 INFO  Done!
2022-09-21 19:24:38 INFO  # Finished -- repetition 5 of 7 
2022-09-21 19:24:38 INFO  # Optimization benchmark for feature_importance with args [['reviews', 'fast_loading', 'featurization_1', 'neural_network']] -- repetition 6 of 7
2022-09-21 19:24:38 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-21 19:24:38 INFO  Running instrumented original pipeline...
2022-09-21 19:24:38 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-21 19:24:38 INFO  ---RUNTIME: Importing and monkey-patching took 5.905866622924805 ms
2022-09-21 19:24:49 INFO  ---RUNTIME: Original pipeline execution took 10941.524028778076 ms (excluding imports and monkey-patching)
2022-09-21 19:24:49 INFO  Starting execution of 1 what-if analyses...
2022-09-21 19:24:49 INFO  Start plan generation for analysis PermutationFeatureImportance...
2022-09-21 19:24:49 INFO  ---RUNTIME: Plan generation took 0.11682510375976562 ms
2022-09-21 19:24:49 INFO  Estimated runtime of original DAG is 8688.705205917358ms
2022-09-21 19:24:49 INFO  Performing Multi-Query Optimization
2022-09-21 19:24:49 INFO  Estimated unoptimized what-if runtime is 43443.52602958679ms
2022-09-21 19:24:49 INFO  Estimated optimised what-if runtime is 11519.707441329956ms
2022-09-21 19:24:49 INFO  Estimated optimisation runtime saving is 31923.818588256836ms
2022-09-21 19:24:49 INFO  ---RUNTIME: Multi-Query Optimization took 9.670019149780273 ms
2022-09-21 19:24:49 INFO  Executing generated plans
2022-09-21 19:25:01 INFO  ---RUNTIME: Execution took 12461.2717628479 ms
2022-09-21 19:25:01 INFO  Done!
2022-09-21 19:25:01 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-21 19:25:01 INFO  Running instrumented original pipeline...
2022-09-21 19:25:01 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-21 19:25:01 INFO  ---RUNTIME: Importing and monkey-patching took 6.046533584594727 ms
2022-09-21 19:25:12 INFO  ---RUNTIME: Original pipeline execution took 10797.67107963562 ms (excluding imports and monkey-patching)
2022-09-21 19:25:12 INFO  Starting execution of 1 what-if analyses...
2022-09-21 19:25:12 INFO  Start plan generation for analysis PermutationFeatureImportance...
2022-09-21 19:25:12 INFO  ---RUNTIME: Plan generation took 0.11515617370605469 ms
2022-09-21 19:25:12 INFO  Estimated runtime of original DAG is 8509.915590286255ms
2022-09-21 19:25:12 WARNING Skipping Multi-Query Optimization (instead, only applying patches)
2022-09-21 19:25:12 INFO  Estimated unoptimised what-if runtime is 42549.577951431274ms
2022-09-21 19:25:12 INFO  ---RUNTIME: Multi-Query Optimization took 3.797769546508789 ms
2022-09-21 19:25:12 INFO  Executing generated plans
2022-09-21 19:26:01 INFO  ---RUNTIME: Execution took 48749.33910369873 ms
2022-09-21 19:26:01 INFO  Done!
2022-09-21 19:26:01 INFO  # Finished -- repetition 6 of 7 
2022-09-21 19:26:01 INFO  # Optimization benchmark for feature_importance with args [['reviews', 'fast_loading', 'featurization_1', 'neural_network']] -- repetition 7 of 7
2022-09-21 19:26:01 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-21 19:26:01 INFO  Running instrumented original pipeline...
2022-09-21 19:26:01 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-21 19:26:01 INFO  ---RUNTIME: Importing and monkey-patching took 6.371974945068359 ms
2022-09-21 19:26:12 INFO  ---RUNTIME: Original pipeline execution took 10795.738697052002 ms (excluding imports and monkey-patching)
2022-09-21 19:26:12 INFO  Starting execution of 1 what-if analyses...
2022-09-21 19:26:12 INFO  Start plan generation for analysis PermutationFeatureImportance...
2022-09-21 19:26:12 INFO  ---RUNTIME: Plan generation took 0.12326240539550781 ms
2022-09-21 19:26:12 INFO  Estimated runtime of original DAG is 8552.716732025146ms
2022-09-21 19:26:12 INFO  Performing Multi-Query Optimization
2022-09-21 19:26:12 INFO  Estimated unoptimized what-if runtime is 42763.58366012573ms
2022-09-21 19:26:12 INFO  Estimated optimised what-if runtime is 11677.444219589233ms
2022-09-21 19:26:12 INFO  Estimated optimisation runtime saving is 31086.1394405365ms
2022-09-21 19:26:12 INFO  ---RUNTIME: Multi-Query Optimization took 9.976625442504883 ms
2022-09-21 19:26:12 INFO  Executing generated plans
2022-09-21 19:26:24 INFO  ---RUNTIME: Execution took 12495.314121246338 ms
2022-09-21 19:26:24 INFO  Done!
2022-09-21 19:26:24 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-21 19:26:24 INFO  Running instrumented original pipeline...
2022-09-21 19:26:24 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-21 19:26:24 INFO  ---RUNTIME: Importing and monkey-patching took 5.7525634765625 ms
2022-09-21 19:26:35 INFO  ---RUNTIME: Original pipeline execution took 11116.614580154419 ms (excluding imports and monkey-patching)
2022-09-21 19:26:35 INFO  Starting execution of 1 what-if analyses...
2022-09-21 19:26:35 INFO  Start plan generation for analysis PermutationFeatureImportance...
2022-09-21 19:26:35 INFO  ---RUNTIME: Plan generation took 0.09560585021972656 ms
2022-09-21 19:26:35 INFO  Estimated runtime of original DAG is 8846.434354782104ms
2022-09-21 19:26:35 WARNING Skipping Multi-Query Optimization (instead, only applying patches)
2022-09-21 19:26:35 INFO  Estimated unoptimised what-if runtime is 44232.17177391052ms
2022-09-21 19:26:35 INFO  ---RUNTIME: Multi-Query Optimization took 4.153728485107422 ms
2022-09-21 19:26:35 INFO  Executing generated plans
2022-09-21 19:27:23 INFO  ---RUNTIME: Execution took 47534.939765930176 ms
2022-09-21 19:27:23 INFO  Done!
2022-09-21 19:27:23 INFO  # Finished -- repetition 7 of 7 
2022-09-21 19:27:23 INFO  # Final results after all repetitions
2022-09-21 19:27:23 INFO     repetition  ... no_opt_what_if_execution_combined_model_training
0           0  ...                                     17001.430750
1           1  ...                                     16819.572210
2           2  ...                                     16458.103418
3           3  ...                                     17488.399744
4           4  ...                                     18277.026415
5           5  ...                                     17190.087080
6           6  ...                                     16771.878004

[7 rows x 26 columns]
taskset -c 32-39 PROTOCOL_BUFFERS_PYTHON_IMPLEMENTATION=python python3.9 benchmarks_end_to_end.py feature_importance reviews fast_loading featurization_2 logistic_regression
2022-09-21 19:27:25.852748: W tensorflow/stream_executor/platform/default/dso_loader.cc:64] Could not load dynamic library 'libcudart.so.11.0'; dlerror: libcudart.so.11.0: cannot open shared object file: No such file or directory; LD_LIBRARY_PATH: /home/sgrafbe/mlwhatif/venv/lib/python3.9/site-packages/cv2/../../lib64:
2022-09-21 19:27:25.852792: I tensorflow/stream_executor/cuda/cudart_stub.cc:29] Ignore above cudart dlerror if you do not have a GPU set up on your machine.
2022-09-21 19:27:27 INFO  Patching sys.argv with ['mlwhatif', 'reviews', 'fast_loading', 'featurization_2', 'logistic_regression']
2022-09-21 19:27:27 INFO  Running instrumented original pipeline...
2022-09-21 19:27:27 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-21 19:27:27 INFO  ---RUNTIME: Importing and monkey-patching took 130.74970245361328 ms
2022-09-21 19:27:34 INFO  ---RUNTIME: Original pipeline execution took 7088.373422622681 ms (excluding imports and monkey-patching)
2022-09-21 19:27:34 INFO  Starting execution of 0 what-if analyses...
2022-09-21 19:27:34 INFO  Estimated runtime of original DAG is 5799.072027206421ms
2022-09-21 19:27:34 INFO  Performing Multi-Query Optimization
2022-09-21 19:27:34 INFO  Estimated unoptimized what-if runtime is 0ms
2022-09-21 19:27:34 INFO  Estimated optimised what-if runtime is 0ms
2022-09-21 19:27:34 INFO  Estimated optimisation runtime saving is 0ms
2022-09-21 19:27:34 INFO  ---RUNTIME: Multi-Query Optimization took 0.640869140625 ms
2022-09-21 19:27:34 INFO  Executing generated plans
2022-09-21 19:27:34 INFO  ---RUNTIME: Execution took 0.03266334533691406 ms
2022-09-21 19:27:34 INFO  Done!
2022-09-21 19:27:34 INFO  # Optimization benchmark for feature_importance with args [['reviews', 'fast_loading', 'featurization_2', 'logistic_regression']] -- repetition 1 of 7
2022-09-21 19:27:34 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-21 19:27:34 INFO  Running instrumented original pipeline...
2022-09-21 19:27:34 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-21 19:27:34 INFO  ---RUNTIME: Importing and monkey-patching took 6.018877029418945 ms
2022-09-21 19:27:41 INFO  ---RUNTIME: Original pipeline execution took 6846.072435379028 ms (excluding imports and monkey-patching)
2022-09-21 19:27:41 INFO  Starting execution of 1 what-if analyses...
2022-09-21 19:27:41 INFO  Start plan generation for analysis PermutationFeatureImportance...
2022-09-21 19:27:41 INFO  ---RUNTIME: Plan generation took 0.2200603485107422 ms
2022-09-21 19:27:41 INFO  Estimated runtime of original DAG is 5641.2928104400635ms
2022-09-21 19:27:41 INFO  Performing Multi-Query Optimization
2022-09-21 19:27:41 INFO  Estimated unoptimized what-if runtime is 28206.464052200317ms
2022-09-21 19:27:41 INFO  Estimated optimised what-if runtime is 7219.478130340576ms
2022-09-21 19:27:41 INFO  Estimated optimisation runtime saving is 20986.98592185974ms
2022-09-21 19:27:41 INFO  ---RUNTIME: Multi-Query Optimization took 10.817766189575195 ms
2022-09-21 19:27:41 INFO  Executing generated plans
2022-09-21 19:27:49 INFO  ---RUNTIME: Execution took 8122.196912765503 ms
2022-09-21 19:27:49 INFO  Done!
2022-09-21 19:27:49 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-21 19:27:49 INFO  Running instrumented original pipeline...
2022-09-21 19:27:49 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-21 19:27:49 INFO  ---RUNTIME: Importing and monkey-patching took 6.014347076416016 ms
2022-09-21 19:27:56 INFO  ---RUNTIME: Original pipeline execution took 6840.490341186523 ms (excluding imports and monkey-patching)
2022-09-21 19:27:56 INFO  Starting execution of 1 what-if analyses...
2022-09-21 19:27:56 INFO  Start plan generation for analysis PermutationFeatureImportance...
2022-09-21 19:27:56 INFO  ---RUNTIME: Plan generation took 0.1442432403564453 ms
2022-09-21 19:27:56 INFO  Estimated runtime of original DAG is 5618.894577026367ms
2022-09-21 19:27:56 WARNING Skipping Multi-Query Optimization (instead, only applying patches)
2022-09-21 19:27:56 INFO  Estimated unoptimised what-if runtime is 28094.472885131836ms
2022-09-21 19:27:56 INFO  ---RUNTIME: Multi-Query Optimization took 4.3010711669921875 ms
2022-09-21 19:27:56 INFO  Executing generated plans
2022-09-21 19:28:28 INFO  ---RUNTIME: Execution took 32424.18622970581 ms
2022-09-21 19:28:28 INFO  Done!
2022-09-21 19:28:28 INFO  # Finished -- repetition 1 of 7 
2022-09-21 19:28:28 INFO  # Optimization benchmark for feature_importance with args [['reviews', 'fast_loading', 'featurization_2', 'logistic_regression']] -- repetition 2 of 7
2022-09-21 19:28:28 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-21 19:28:28 INFO  Running instrumented original pipeline...
2022-09-21 19:28:28 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-21 19:28:28 INFO  ---RUNTIME: Importing and monkey-patching took 6.156206130981445 ms
2022-09-21 19:28:35 INFO  ---RUNTIME: Original pipeline execution took 6904.492139816284 ms (excluding imports and monkey-patching)
2022-09-21 19:28:35 INFO  Starting execution of 1 what-if analyses...
2022-09-21 19:28:35 INFO  Start plan generation for analysis PermutationFeatureImportance...
2022-09-21 19:28:35 INFO  ---RUNTIME: Plan generation took 0.1347064971923828 ms
2022-09-21 19:28:35 INFO  Estimated runtime of original DAG is 5621.368646621704ms
2022-09-21 19:28:35 INFO  Performing Multi-Query Optimization
2022-09-21 19:28:35 INFO  Estimated unoptimized what-if runtime is 28106.84323310852ms
2022-09-21 19:28:35 INFO  Estimated optimised what-if runtime is 7191.538572311401ms
2022-09-21 19:28:35 INFO  Estimated optimisation runtime saving is 20915.30466079712ms
2022-09-21 19:28:35 INFO  ---RUNTIME: Multi-Query Optimization took 10.610103607177734 ms
2022-09-21 19:28:35 INFO  Executing generated plans
2022-09-21 19:28:43 INFO  ---RUNTIME: Execution took 8129.064321517944 ms
2022-09-21 19:28:43 INFO  Done!
2022-09-21 19:28:43 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-21 19:28:43 INFO  Running instrumented original pipeline...
2022-09-21 19:28:43 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-21 19:28:43 INFO  ---RUNTIME: Importing and monkey-patching took 6.194114685058594 ms
2022-09-21 19:28:50 INFO  ---RUNTIME: Original pipeline execution took 6711.0350131988525 ms (excluding imports and monkey-patching)
2022-09-21 19:28:50 INFO  Starting execution of 1 what-if analyses...
2022-09-21 19:28:50 INFO  Start plan generation for analysis PermutationFeatureImportance...
2022-09-21 19:28:50 INFO  ---RUNTIME: Plan generation took 0.12183189392089844 ms
2022-09-21 19:28:50 INFO  Estimated runtime of original DAG is 5489.938020706177ms
2022-09-21 19:28:50 WARNING Skipping Multi-Query Optimization (instead, only applying patches)
2022-09-21 19:28:50 INFO  Estimated unoptimised what-if runtime is 27449.690103530884ms
2022-09-21 19:28:50 INFO  ---RUNTIME: Multi-Query Optimization took 4.14586067199707 ms
2022-09-21 19:28:50 INFO  Executing generated plans
2022-09-21 19:29:23 INFO  ---RUNTIME: Execution took 33069.74244117737 ms
2022-09-21 19:29:23 INFO  Done!
2022-09-21 19:29:23 INFO  # Finished -- repetition 2 of 7 
2022-09-21 19:29:23 INFO  # Optimization benchmark for feature_importance with args [['reviews', 'fast_loading', 'featurization_2', 'logistic_regression']] -- repetition 3 of 7
2022-09-21 19:29:23 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-21 19:29:23 INFO  Running instrumented original pipeline...
2022-09-21 19:29:23 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-21 19:29:23 INFO  ---RUNTIME: Importing and monkey-patching took 6.942510604858398 ms
2022-09-21 19:29:30 INFO  ---RUNTIME: Original pipeline execution took 6788.968801498413 ms (excluding imports and monkey-patching)
2022-09-21 19:29:30 INFO  Starting execution of 1 what-if analyses...
2022-09-21 19:29:30 INFO  Start plan generation for analysis PermutationFeatureImportance...
2022-09-21 19:29:30 INFO  ---RUNTIME: Plan generation took 0.12373924255371094 ms
2022-09-21 19:29:30 INFO  Estimated runtime of original DAG is 5564.929962158203ms
2022-09-21 19:29:30 INFO  Performing Multi-Query Optimization
2022-09-21 19:29:30 INFO  Estimated unoptimized what-if runtime is 27824.649810791016ms
2022-09-21 19:29:30 INFO  Estimated optimised what-if runtime is 7144.952058792114ms
2022-09-21 19:29:30 INFO  Estimated optimisation runtime saving is 20679.6977519989ms
2022-09-21 19:29:30 INFO  ---RUNTIME: Multi-Query Optimization took 10.757684707641602 ms
2022-09-21 19:29:30 INFO  Executing generated plans
2022-09-21 19:29:38 INFO  ---RUNTIME: Execution took 8168.598890304565 ms
2022-09-21 19:29:38 INFO  Done!
2022-09-21 19:29:38 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-21 19:29:38 INFO  Running instrumented original pipeline...
2022-09-21 19:29:38 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-21 19:29:38 INFO  ---RUNTIME: Importing and monkey-patching took 5.735635757446289 ms
2022-09-21 19:29:45 INFO  ---RUNTIME: Original pipeline execution took 6853.537082672119 ms (excluding imports and monkey-patching)
2022-09-21 19:29:45 INFO  Starting execution of 1 what-if analyses...
2022-09-21 19:29:45 INFO  Start plan generation for analysis PermutationFeatureImportance...
2022-09-21 19:29:45 INFO  ---RUNTIME: Plan generation took 0.10848045349121094 ms
2022-09-21 19:29:45 INFO  Estimated runtime of original DAG is 5629.159212112427ms
2022-09-21 19:29:45 WARNING Skipping Multi-Query Optimization (instead, only applying patches)
2022-09-21 19:29:45 INFO  Estimated unoptimised what-if runtime is 28145.796060562134ms
2022-09-21 19:29:45 INFO  ---RUNTIME: Multi-Query Optimization took 4.284143447875977 ms
2022-09-21 19:29:45 INFO  Executing generated plans
2022-09-21 19:30:17 INFO  ---RUNTIME: Execution took 32491.475582122803 ms
2022-09-21 19:30:17 INFO  Done!
2022-09-21 19:30:17 INFO  # Finished -- repetition 3 of 7 
2022-09-21 19:30:17 INFO  # Optimization benchmark for feature_importance with args [['reviews', 'fast_loading', 'featurization_2', 'logistic_regression']] -- repetition 4 of 7
2022-09-21 19:30:17 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-21 19:30:17 INFO  Running instrumented original pipeline...
2022-09-21 19:30:17 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-21 19:30:17 INFO  ---RUNTIME: Importing and monkey-patching took 6.217241287231445 ms
2022-09-21 19:30:24 INFO  ---RUNTIME: Original pipeline execution took 6655.516624450684 ms (excluding imports and monkey-patching)
2022-09-21 19:30:24 INFO  Starting execution of 1 what-if analyses...
2022-09-21 19:30:24 INFO  Start plan generation for analysis PermutationFeatureImportance...
2022-09-21 19:30:24 INFO  ---RUNTIME: Plan generation took 0.12040138244628906 ms
2022-09-21 19:30:24 INFO  Estimated runtime of original DAG is 5435.056924819946ms
2022-09-21 19:30:24 INFO  Performing Multi-Query Optimization
2022-09-21 19:30:24 INFO  Estimated unoptimized what-if runtime is 27175.28462409973ms
2022-09-21 19:30:24 INFO  Estimated optimised what-if runtime is 7009.172677993774ms
2022-09-21 19:30:24 INFO  Estimated optimisation runtime saving is 20166.111946105957ms
2022-09-21 19:30:24 INFO  ---RUNTIME: Multi-Query Optimization took 10.536670684814453 ms
2022-09-21 19:30:24 INFO  Executing generated plans
2022-09-21 19:30:32 INFO  ---RUNTIME: Execution took 8261.964797973633 ms
2022-09-21 19:30:32 INFO  Done!
2022-09-21 19:30:32 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-21 19:30:32 INFO  Running instrumented original pipeline...
2022-09-21 19:30:32 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-21 19:30:32 INFO  ---RUNTIME: Importing and monkey-patching took 5.837917327880859 ms
2022-09-21 19:30:39 INFO  ---RUNTIME: Original pipeline execution took 6764.830589294434 ms (excluding imports and monkey-patching)
2022-09-21 19:30:39 INFO  Starting execution of 1 what-if analyses...
2022-09-21 19:30:39 INFO  Start plan generation for analysis PermutationFeatureImportance...
2022-09-21 19:30:39 INFO  ---RUNTIME: Plan generation took 0.1087188720703125 ms
2022-09-21 19:30:39 INFO  Estimated runtime of original DAG is 5535.868883132935ms
2022-09-21 19:30:39 WARNING Skipping Multi-Query Optimization (instead, only applying patches)
2022-09-21 19:30:39 INFO  Estimated unoptimised what-if runtime is 27679.344415664673ms
2022-09-21 19:30:39 INFO  ---RUNTIME: Multi-Query Optimization took 4.091024398803711 ms
2022-09-21 19:30:39 INFO  Executing generated plans
2022-09-21 19:31:12 INFO  ---RUNTIME: Execution took 32415.749311447144 ms
2022-09-21 19:31:12 INFO  Done!
2022-09-21 19:31:12 INFO  # Finished -- repetition 4 of 7 
2022-09-21 19:31:12 INFO  # Optimization benchmark for feature_importance with args [['reviews', 'fast_loading', 'featurization_2', 'logistic_regression']] -- repetition 5 of 7
2022-09-21 19:31:12 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-21 19:31:12 INFO  Running instrumented original pipeline...
2022-09-21 19:31:12 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-21 19:31:12 INFO  ---RUNTIME: Importing and monkey-patching took 6.518840789794922 ms
2022-09-21 19:31:18 INFO  ---RUNTIME: Original pipeline execution took 6786.951780319214 ms (excluding imports and monkey-patching)
2022-09-21 19:31:18 INFO  Starting execution of 1 what-if analyses...
2022-09-21 19:31:18 INFO  Start plan generation for analysis PermutationFeatureImportance...
2022-09-21 19:31:18 INFO  ---RUNTIME: Plan generation took 0.13566017150878906 ms
2022-09-21 19:31:18 INFO  Estimated runtime of original DAG is 5559.666633605957ms
2022-09-21 19:31:18 INFO  Performing Multi-Query Optimization
2022-09-21 19:31:18 INFO  Estimated unoptimized what-if runtime is 27798.333168029785ms
2022-09-21 19:31:18 INFO  Estimated optimised what-if runtime is 7145.426273345947ms
2022-09-21 19:31:18 INFO  Estimated optimisation runtime saving is 20652.906894683838ms
2022-09-21 19:31:18 INFO  ---RUNTIME: Multi-Query Optimization took 10.790824890136719 ms
2022-09-21 19:31:18 INFO  Executing generated plans
2022-09-21 19:31:26 INFO  ---RUNTIME: Execution took 8090.740919113159 ms
2022-09-21 19:31:26 INFO  Done!
2022-09-21 19:31:27 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-21 19:31:27 INFO  Running instrumented original pipeline...
2022-09-21 19:31:27 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-21 19:31:27 INFO  ---RUNTIME: Importing and monkey-patching took 5.977392196655273 ms
2022-09-21 19:31:33 INFO  ---RUNTIME: Original pipeline execution took 6788.5236740112305 ms (excluding imports and monkey-patching)
2022-09-21 19:31:33 INFO  Starting execution of 1 what-if analyses...
2022-09-21 19:31:33 INFO  Start plan generation for analysis PermutationFeatureImportance...
2022-09-21 19:31:33 INFO  ---RUNTIME: Plan generation took 0.10013580322265625 ms
2022-09-21 19:31:33 INFO  Estimated runtime of original DAG is 5553.020000457764ms
2022-09-21 19:31:33 WARNING Skipping Multi-Query Optimization (instead, only applying patches)
2022-09-21 19:31:33 INFO  Estimated unoptimised what-if runtime is 27765.10000228882ms
2022-09-21 19:31:33 INFO  ---RUNTIME: Multi-Query Optimization took 4.238367080688477 ms
2022-09-21 19:31:33 INFO  Executing generated plans
2022-09-21 19:32:06 INFO  ---RUNTIME: Execution took 32271.328687667847 ms
2022-09-21 19:32:06 INFO  Done!
2022-09-21 19:32:06 INFO  # Finished -- repetition 5 of 7 
2022-09-21 19:32:06 INFO  # Optimization benchmark for feature_importance with args [['reviews', 'fast_loading', 'featurization_2', 'logistic_regression']] -- repetition 6 of 7
2022-09-21 19:32:06 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-21 19:32:06 INFO  Running instrumented original pipeline...
2022-09-21 19:32:06 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-21 19:32:06 INFO  ---RUNTIME: Importing and monkey-patching took 6.162405014038086 ms
2022-09-21 19:32:12 INFO  ---RUNTIME: Original pipeline execution took 6740.501880645752 ms (excluding imports and monkey-patching)
2022-09-21 19:32:12 INFO  Starting execution of 1 what-if analyses...
2022-09-21 19:32:12 INFO  Start plan generation for analysis PermutationFeatureImportance...
2022-09-21 19:32:12 INFO  ---RUNTIME: Plan generation took 0.12874603271484375 ms
2022-09-21 19:32:12 INFO  Estimated runtime of original DAG is 5513.7529373168945ms
2022-09-21 19:32:12 INFO  Performing Multi-Query Optimization
2022-09-21 19:32:12 INFO  Estimated unoptimized what-if runtime is 27568.764686584473ms
2022-09-21 19:32:12 INFO  Estimated optimised what-if runtime is 7082.533359527588ms
2022-09-21 19:32:12 INFO  Estimated optimisation runtime saving is 20486.231327056885ms
2022-09-21 19:32:12 INFO  ---RUNTIME: Multi-Query Optimization took 10.544300079345703 ms
2022-09-21 19:32:12 INFO  Executing generated plans
2022-09-21 19:32:20 INFO  ---RUNTIME: Execution took 8009.727716445923 ms
2022-09-21 19:32:20 INFO  Done!
2022-09-21 19:32:20 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-21 19:32:20 INFO  Running instrumented original pipeline...
2022-09-21 19:32:20 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-21 19:32:20 INFO  ---RUNTIME: Importing and monkey-patching took 5.72967529296875 ms
2022-09-21 19:32:27 INFO  ---RUNTIME: Original pipeline execution took 6719.91491317749 ms (excluding imports and monkey-patching)
2022-09-21 19:32:27 INFO  Starting execution of 1 what-if analyses...
2022-09-21 19:32:27 INFO  Start plan generation for analysis PermutationFeatureImportance...
2022-09-21 19:32:27 INFO  ---RUNTIME: Plan generation took 0.1323223114013672 ms
2022-09-21 19:32:27 INFO  Estimated runtime of original DAG is 5490.346670150757ms
2022-09-21 19:32:27 WARNING Skipping Multi-Query Optimization (instead, only applying patches)
2022-09-21 19:32:27 INFO  Estimated unoptimised what-if runtime is 27451.733350753784ms
2022-09-21 19:32:27 INFO  ---RUNTIME: Multi-Query Optimization took 4.118204116821289 ms
2022-09-21 19:32:27 INFO  Executing generated plans
2022-09-21 19:32:59 INFO  ---RUNTIME: Execution took 31895.71762084961 ms
2022-09-21 19:32:59 INFO  Done!
2022-09-21 19:32:59 INFO  # Finished -- repetition 6 of 7 
2022-09-21 19:32:59 INFO  # Optimization benchmark for feature_importance with args [['reviews', 'fast_loading', 'featurization_2', 'logistic_regression']] -- repetition 7 of 7
2022-09-21 19:32:59 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-21 19:32:59 INFO  Running instrumented original pipeline...
2022-09-21 19:32:59 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-21 19:32:59 INFO  ---RUNTIME: Importing and monkey-patching took 5.837202072143555 ms
2022-09-21 19:33:06 INFO  ---RUNTIME: Original pipeline execution took 6721.062660217285 ms (excluding imports and monkey-patching)
2022-09-21 19:33:06 INFO  Starting execution of 1 what-if analyses...
2022-09-21 19:33:06 INFO  Start plan generation for analysis PermutationFeatureImportance...
2022-09-21 19:33:06 INFO  ---RUNTIME: Plan generation took 0.09870529174804688 ms
2022-09-21 19:33:06 INFO  Estimated runtime of original DAG is 5490.943908691406ms
2022-09-21 19:33:06 INFO  Performing Multi-Query Optimization
2022-09-21 19:33:06 INFO  Estimated unoptimized what-if runtime is 27454.71954345703ms
2022-09-21 19:33:06 INFO  Estimated optimised what-if runtime is 7063.344717025757ms
2022-09-21 19:33:06 INFO  Estimated optimisation runtime saving is 20391.374826431274ms
2022-09-21 19:33:06 INFO  ---RUNTIME: Multi-Query Optimization took 10.608673095703125 ms
2022-09-21 19:33:06 INFO  Executing generated plans
2022-09-21 19:33:14 INFO  ---RUNTIME: Execution took 7961.606979370117 ms
2022-09-21 19:33:14 INFO  Done!
2022-09-21 19:33:14 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-21 19:33:14 INFO  Running instrumented original pipeline...
2022-09-21 19:33:14 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-21 19:33:14 INFO  ---RUNTIME: Importing and monkey-patching took 5.803346633911133 ms
2022-09-21 19:33:20 INFO  ---RUNTIME: Original pipeline execution took 6705.397605895996 ms (excluding imports and monkey-patching)
2022-09-21 19:33:20 INFO  Starting execution of 1 what-if analyses...
2022-09-21 19:33:20 INFO  Start plan generation for analysis PermutationFeatureImportance...
2022-09-21 19:33:20 INFO  ---RUNTIME: Plan generation took 0.13375282287597656 ms
2022-09-21 19:33:20 INFO  Estimated runtime of original DAG is 5478.271484375ms
2022-09-21 19:33:20 WARNING Skipping Multi-Query Optimization (instead, only applying patches)
2022-09-21 19:33:20 INFO  Estimated unoptimised what-if runtime is 27391.357421875ms
2022-09-21 19:33:20 INFO  ---RUNTIME: Multi-Query Optimization took 4.25267219543457 ms
2022-09-21 19:33:20 INFO  Executing generated plans
2022-09-21 19:33:52 INFO  ---RUNTIME: Execution took 31859.37452316284 ms
2022-09-21 19:33:52 INFO  Done!
2022-09-21 19:33:52 INFO  # Finished -- repetition 7 of 7 
2022-09-21 19:33:52 INFO  # Final results after all repetitions
2022-09-21 19:33:52 INFO     repetition  ... no_opt_what_if_execution_combined_model_training
0           0  ...                                       539.939880
1           1  ...                                       573.333979
2           2  ...                                       557.881832
3           3  ...                                       492.032528
4           4  ...                                       497.212172
5           5  ...                                       506.489992
6           6  ...                                       498.689175

[7 rows x 26 columns]
taskset -c 32-39 PROTOCOL_BUFFERS_PYTHON_IMPLEMENTATION=python python3.9 benchmarks_end_to_end.py feature_importance reviews fast_loading featurization_2 xgboost
2022-09-21 19:33:55.077898: W tensorflow/stream_executor/platform/default/dso_loader.cc:64] Could not load dynamic library 'libcudart.so.11.0'; dlerror: libcudart.so.11.0: cannot open shared object file: No such file or directory; LD_LIBRARY_PATH: /home/sgrafbe/mlwhatif/venv/lib/python3.9/site-packages/cv2/../../lib64:
2022-09-21 19:33:55.077947: I tensorflow/stream_executor/cuda/cudart_stub.cc:29] Ignore above cudart dlerror if you do not have a GPU set up on your machine.
2022-09-21 19:33:56 INFO  Patching sys.argv with ['mlwhatif', 'reviews', 'fast_loading', 'featurization_2', 'xgboost']
2022-09-21 19:33:56 INFO  Running instrumented original pipeline...
2022-09-21 19:33:56 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-21 19:33:56 INFO  ---RUNTIME: Importing and monkey-patching took 121.98853492736816 ms
2022-09-21 19:34:40 INFO  ---RUNTIME: Original pipeline execution took 43716.456174850464 ms (excluding imports and monkey-patching)
2022-09-21 19:34:40 INFO  Starting execution of 0 what-if analyses...
2022-09-21 19:34:40 INFO  Estimated runtime of original DAG is 42522.12953567505ms
2022-09-21 19:34:40 INFO  Performing Multi-Query Optimization
2022-09-21 19:34:40 INFO  Estimated unoptimized what-if runtime is 0ms
2022-09-21 19:34:40 INFO  Estimated optimised what-if runtime is 0ms
2022-09-21 19:34:40 INFO  Estimated optimisation runtime saving is 0ms
2022-09-21 19:34:40 INFO  ---RUNTIME: Multi-Query Optimization took 0.5314350128173828 ms
2022-09-21 19:34:40 INFO  Executing generated plans
2022-09-21 19:34:40 INFO  ---RUNTIME: Execution took 0.02574920654296875 ms
2022-09-21 19:34:40 INFO  Done!
2022-09-21 19:34:40 INFO  # Optimization benchmark for feature_importance with args [['reviews', 'fast_loading', 'featurization_2', 'xgboost']] -- repetition 1 of 7
2022-09-21 19:34:40 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-21 19:34:40 INFO  Running instrumented original pipeline...
2022-09-21 19:34:40 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-21 19:34:40 INFO  ---RUNTIME: Importing and monkey-patching took 5.4569244384765625 ms
2022-09-21 19:35:09 INFO  ---RUNTIME: Original pipeline execution took 29166.74757003784 ms (excluding imports and monkey-patching)
2022-09-21 19:35:09 INFO  Starting execution of 1 what-if analyses...
2022-09-21 19:35:09 INFO  Start plan generation for analysis PermutationFeatureImportance...
2022-09-21 19:35:09 INFO  ---RUNTIME: Plan generation took 0.20360946655273438 ms
2022-09-21 19:35:09 INFO  Estimated runtime of original DAG is 27820.371866226196ms
2022-09-21 19:35:09 INFO  Performing Multi-Query Optimization
2022-09-21 19:35:09 INFO  Estimated unoptimized what-if runtime is 139101.85933113098ms
2022-09-21 19:35:09 INFO  Estimated optimised what-if runtime is 29653.192043304443ms
2022-09-21 19:35:09 INFO  Estimated optimisation runtime saving is 109448.66728782654ms
2022-09-21 19:35:09 INFO  ---RUNTIME: Multi-Query Optimization took 10.742425918579102 ms
2022-09-21 19:35:09 INFO  Executing generated plans
2022-09-21 19:35:43 INFO  ---RUNTIME: Execution took 33647.34363555908 ms
2022-09-21 19:35:43 INFO  Done!
2022-09-21 19:35:43 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-21 19:35:43 INFO  Running instrumented original pipeline...
2022-09-21 19:35:43 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-21 19:35:43 INFO  ---RUNTIME: Importing and monkey-patching took 6.134748458862305 ms
2022-09-21 19:36:46 INFO  ---RUNTIME: Original pipeline execution took 63294.514179229736 ms (excluding imports and monkey-patching)
2022-09-21 19:36:46 INFO  Starting execution of 1 what-if analyses...
2022-09-21 19:36:46 INFO  Start plan generation for analysis PermutationFeatureImportance...
2022-09-21 19:36:46 INFO  ---RUNTIME: Plan generation took 0.14209747314453125 ms
2022-09-21 19:36:46 INFO  Estimated runtime of original DAG is 62100.10099411011ms
2022-09-21 19:36:46 WARNING Skipping Multi-Query Optimization (instead, only applying patches)
2022-09-21 19:36:46 INFO  Estimated unoptimised what-if runtime is 310500.50497055054ms
2022-09-21 19:36:46 INFO  ---RUNTIME: Multi-Query Optimization took 4.250526428222656 ms
2022-09-21 19:36:46 INFO  Executing generated plans
2022-09-21 19:38:33 INFO  ---RUNTIME: Execution took 106764.03498649597 ms
2022-09-21 19:38:33 INFO  Done!
2022-09-21 19:38:33 INFO  # Finished -- repetition 1 of 7 
2022-09-21 19:38:33 INFO  # Optimization benchmark for feature_importance with args [['reviews', 'fast_loading', 'featurization_2', 'xgboost']] -- repetition 2 of 7
2022-09-21 19:38:33 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-21 19:38:33 INFO  Running instrumented original pipeline...
2022-09-21 19:38:33 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-21 19:38:33 INFO  ---RUNTIME: Importing and monkey-patching took 5.970001220703125 ms
2022-09-21 19:38:52 INFO  ---RUNTIME: Original pipeline execution took 19583.752870559692 ms (excluding imports and monkey-patching)
2022-09-21 19:38:52 INFO  Starting execution of 1 what-if analyses...
2022-09-21 19:38:52 INFO  Start plan generation for analysis PermutationFeatureImportance...
2022-09-21 19:38:52 INFO  ---RUNTIME: Plan generation took 0.1678466796875 ms
2022-09-21 19:38:52 INFO  Estimated runtime of original DAG is 18386.356592178345ms
2022-09-21 19:38:52 INFO  Performing Multi-Query Optimization
2022-09-21 19:38:52 INFO  Estimated unoptimized what-if runtime is 91931.78296089172ms
2022-09-21 19:38:52 INFO  Estimated optimised what-if runtime is 20219.13433074951ms
2022-09-21 19:38:52 INFO  Estimated optimisation runtime saving is 71712.64863014221ms
2022-09-21 19:38:52 INFO  ---RUNTIME: Multi-Query Optimization took 10.635614395141602 ms
2022-09-21 19:38:52 INFO  Executing generated plans
2022-09-21 19:39:13 INFO  ---RUNTIME: Execution took 20908.833503723145 ms
2022-09-21 19:39:13 INFO  Done!
2022-09-21 19:39:13 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-21 19:39:13 INFO  Running instrumented original pipeline...
2022-09-21 19:39:13 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-21 19:39:13 INFO  ---RUNTIME: Importing and monkey-patching took 5.687236785888672 ms
2022-09-21 19:39:32 INFO  ---RUNTIME: Original pipeline execution took 19221.22859954834 ms (excluding imports and monkey-patching)
2022-09-21 19:39:32 INFO  Starting execution of 1 what-if analyses...
2022-09-21 19:39:32 INFO  Start plan generation for analysis PermutationFeatureImportance...
2022-09-21 19:39:32 INFO  ---RUNTIME: Plan generation took 0.1316070556640625 ms
2022-09-21 19:39:32 INFO  Estimated runtime of original DAG is 18020.931720733643ms
2022-09-21 19:39:32 WARNING Skipping Multi-Query Optimization (instead, only applying patches)
2022-09-21 19:39:32 INFO  Estimated unoptimised what-if runtime is 90104.65860366821ms
2022-09-21 19:39:32 INFO  ---RUNTIME: Multi-Query Optimization took 4.208564758300781 ms
2022-09-21 19:39:32 INFO  Executing generated plans
2022-09-21 19:41:16 INFO  ---RUNTIME: Execution took 103706.50005340576 ms
2022-09-21 19:41:16 INFO  Done!
2022-09-21 19:41:16 INFO  # Finished -- repetition 2 of 7 
2022-09-21 19:41:16 INFO  # Optimization benchmark for feature_importance with args [['reviews', 'fast_loading', 'featurization_2', 'xgboost']] -- repetition 3 of 7
2022-09-21 19:41:16 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-21 19:41:16 INFO  Running instrumented original pipeline...
2022-09-21 19:41:16 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-21 19:41:16 INFO  ---RUNTIME: Importing and monkey-patching took 8.28862190246582 ms
2022-09-21 19:41:43 INFO  ---RUNTIME: Original pipeline execution took 26404.511213302612 ms (excluding imports and monkey-patching)
2022-09-21 19:41:43 INFO  Starting execution of 1 what-if analyses...
2022-09-21 19:41:43 INFO  Start plan generation for analysis PermutationFeatureImportance...
2022-09-21 19:41:43 INFO  ---RUNTIME: Plan generation took 0.17261505126953125 ms
2022-09-21 19:41:43 INFO  Estimated runtime of original DAG is 24561.35082244873ms
2022-09-21 19:41:43 INFO  Performing Multi-Query Optimization
2022-09-21 19:41:43 INFO  Estimated unoptimized what-if runtime is 122806.75411224365ms
2022-09-21 19:41:43 INFO  Estimated optimised what-if runtime is 27050.08816719055ms
2022-09-21 19:41:43 INFO  Estimated optimisation runtime saving is 95756.6659450531ms
2022-09-21 19:41:43 INFO  ---RUNTIME: Multi-Query Optimization took 16.342878341674805 ms
2022-09-21 19:41:43 INFO  Executing generated plans
2022-09-21 19:42:10 INFO  ---RUNTIME: Execution took 27890.830516815186 ms
2022-09-21 19:42:10 INFO  Done!
2022-09-21 19:42:10 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-21 19:42:10 INFO  Running instrumented original pipeline...
2022-09-21 19:42:10 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-21 19:42:10 INFO  ---RUNTIME: Importing and monkey-patching took 8.778810501098633 ms
2022-09-21 19:42:36 INFO  ---RUNTIME: Original pipeline execution took 25955.91974258423 ms (excluding imports and monkey-patching)
2022-09-21 19:42:36 INFO  Starting execution of 1 what-if analyses...
2022-09-21 19:42:36 INFO  Start plan generation for analysis PermutationFeatureImportance...
2022-09-21 19:42:36 INFO  ---RUNTIME: Plan generation took 0.13375282287597656 ms
2022-09-21 19:42:36 INFO  Estimated runtime of original DAG is 24282.72294998169ms
2022-09-21 19:42:36 WARNING Skipping Multi-Query Optimization (instead, only applying patches)
2022-09-21 19:42:36 INFO  Estimated unoptimised what-if runtime is 121413.61474990845ms
2022-09-21 19:42:36 INFO  ---RUNTIME: Multi-Query Optimization took 6.971120834350586 ms
2022-09-21 19:42:36 INFO  Executing generated plans
2022-09-21 19:44:35 INFO  ---RUNTIME: Execution took 118475.59571266174 ms
2022-09-21 19:44:35 INFO  Done!
2022-09-21 19:44:35 INFO  # Finished -- repetition 3 of 7 
2022-09-21 19:44:35 INFO  # Optimization benchmark for feature_importance with args [['reviews', 'fast_loading', 'featurization_2', 'xgboost']] -- repetition 4 of 7
2022-09-21 19:44:35 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-21 19:44:35 INFO  Running instrumented original pipeline...
2022-09-21 19:44:35 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-21 19:44:35 INFO  ---RUNTIME: Importing and monkey-patching took 6.4544677734375 ms
2022-09-21 19:44:58 INFO  ---RUNTIME: Original pipeline execution took 23264.034271240234 ms (excluding imports and monkey-patching)
2022-09-21 19:44:58 INFO  Starting execution of 1 what-if analyses...
2022-09-21 19:44:58 INFO  Start plan generation for analysis PermutationFeatureImportance...
2022-09-21 19:44:58 INFO  ---RUNTIME: Plan generation took 0.12373924255371094 ms
2022-09-21 19:44:58 INFO  Estimated runtime of original DAG is 21449.91946220398ms
2022-09-21 19:44:58 INFO  Performing Multi-Query Optimization
2022-09-21 19:44:58 INFO  Estimated unoptimized what-if runtime is 107249.5973110199ms
2022-09-21 19:44:58 INFO  Estimated optimised what-if runtime is 23279.51407432556ms
2022-09-21 19:44:58 INFO  Estimated optimisation runtime saving is 83970.08323669434ms
2022-09-21 19:44:58 INFO  ---RUNTIME: Multi-Query Optimization took 10.593414306640625 ms
2022-09-21 19:44:58 INFO  Executing generated plans
2022-09-21 19:45:29 INFO  ---RUNTIME: Execution took 30934.180736541748 ms
2022-09-21 19:45:29 INFO  Done!
2022-09-21 19:45:29 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-21 19:45:29 INFO  Running instrumented original pipeline...
2022-09-21 19:45:29 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-21 19:45:29 INFO  ---RUNTIME: Importing and monkey-patching took 8.073091506958008 ms
2022-09-21 19:45:55 INFO  ---RUNTIME: Original pipeline execution took 25976.160049438477 ms (excluding imports and monkey-patching)
2022-09-21 19:45:55 INFO  Starting execution of 1 what-if analyses...
2022-09-21 19:45:55 INFO  Start plan generation for analysis PermutationFeatureImportance...
2022-09-21 19:45:55 INFO  ---RUNTIME: Plan generation took 0.17452239990234375 ms
2022-09-21 19:45:55 INFO  Estimated runtime of original DAG is 24167.503833770752ms
2022-09-21 19:45:55 WARNING Skipping Multi-Query Optimization (instead, only applying patches)
2022-09-21 19:45:55 INFO  Estimated unoptimised what-if runtime is 120837.51916885376ms
2022-09-21 19:45:55 INFO  ---RUNTIME: Multi-Query Optimization took 7.996559143066406 ms
2022-09-21 19:45:55 INFO  Executing generated plans
2022-09-21 19:48:08 INFO  ---RUNTIME: Execution took 133255.21802902222 ms
2022-09-21 19:48:08 INFO  Done!
2022-09-21 19:48:08 INFO  # Finished -- repetition 4 of 7 
2022-09-21 19:48:08 INFO  # Optimization benchmark for feature_importance with args [['reviews', 'fast_loading', 'featurization_2', 'xgboost']] -- repetition 5 of 7
2022-09-21 19:48:08 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-21 19:48:08 INFO  Running instrumented original pipeline...
2022-09-21 19:48:08 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-21 19:48:08 INFO  ---RUNTIME: Importing and monkey-patching took 10.286092758178711 ms
2022-09-21 19:48:34 INFO  ---RUNTIME: Original pipeline execution took 25540.692806243896 ms (excluding imports and monkey-patching)
2022-09-21 19:48:34 INFO  Starting execution of 1 what-if analyses...
2022-09-21 19:48:34 INFO  Start plan generation for analysis PermutationFeatureImportance...
2022-09-21 19:48:34 INFO  ---RUNTIME: Plan generation took 0.171661376953125 ms
2022-09-21 19:48:34 INFO  Estimated runtime of original DAG is 23813.77601623535ms
2022-09-21 19:48:34 INFO  Performing Multi-Query Optimization
2022-09-21 19:48:34 INFO  Estimated unoptimized what-if runtime is 119068.88008117676ms
2022-09-21 19:48:34 INFO  Estimated optimised what-if runtime is 26340.4438495636ms
2022-09-21 19:48:34 INFO  Estimated optimisation runtime saving is 92728.43623161316ms
2022-09-21 19:48:34 INFO  ---RUNTIME: Multi-Query Optimization took 16.63517951965332 ms
2022-09-21 19:48:34 INFO  Executing generated plans
2022-09-21 19:48:59 INFO  ---RUNTIME: Execution took 25445.388555526733 ms
2022-09-21 19:48:59 INFO  Done!
2022-09-21 19:48:59 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-21 19:48:59 INFO  Running instrumented original pipeline...
2022-09-21 19:49:00 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-21 19:49:00 INFO  ---RUNTIME: Importing and monkey-patching took 7.359743118286133 ms
2022-09-21 19:49:26 INFO  ---RUNTIME: Original pipeline execution took 26946.972608566284 ms (excluding imports and monkey-patching)
2022-09-21 19:49:26 INFO  Starting execution of 1 what-if analyses...
2022-09-21 19:49:26 INFO  Start plan generation for analysis PermutationFeatureImportance...
2022-09-21 19:49:26 INFO  ---RUNTIME: Plan generation took 0.2162456512451172 ms
2022-09-21 19:49:26 INFO  Estimated runtime of original DAG is 25693.23706626892ms
2022-09-21 19:49:26 WARNING Skipping Multi-Query Optimization (instead, only applying patches)
2022-09-21 19:49:26 INFO  Estimated unoptimised what-if runtime is 128466.1853313446ms
2022-09-21 19:49:26 INFO  ---RUNTIME: Multi-Query Optimization took 5.501508712768555 ms
2022-09-21 19:49:26 INFO  Executing generated plans
2022-09-21 19:51:23 INFO  ---RUNTIME: Execution took 116928.23791503906 ms
2022-09-21 19:51:23 INFO  Done!
2022-09-21 19:51:23 INFO  # Finished -- repetition 5 of 7 
2022-09-21 19:51:23 INFO  # Optimization benchmark for feature_importance with args [['reviews', 'fast_loading', 'featurization_2', 'xgboost']] -- repetition 6 of 7
2022-09-21 19:51:23 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-21 19:51:23 INFO  Running instrumented original pipeline...
2022-09-21 19:51:23 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-21 19:51:23 INFO  ---RUNTIME: Importing and monkey-patching took 5.968332290649414 ms
2022-09-21 19:51:49 INFO  ---RUNTIME: Original pipeline execution took 25323.012590408325 ms (excluding imports and monkey-patching)
2022-09-21 19:51:49 INFO  Starting execution of 1 what-if analyses...
2022-09-21 19:51:49 INFO  Start plan generation for analysis PermutationFeatureImportance...
2022-09-21 19:51:49 INFO  ---RUNTIME: Plan generation took 0.1499652862548828 ms
2022-09-21 19:51:49 INFO  Estimated runtime of original DAG is 23684.444189071655ms
2022-09-21 19:51:49 INFO  Performing Multi-Query Optimization
2022-09-21 19:51:49 INFO  Estimated unoptimized what-if runtime is 118422.22094535828ms
2022-09-21 19:51:49 INFO  Estimated optimised what-if runtime is 26508.339405059814ms
2022-09-21 19:51:49 INFO  Estimated optimisation runtime saving is 91913.88154029846ms
2022-09-21 19:51:49 INFO  ---RUNTIME: Multi-Query Optimization took 16.6018009185791 ms
2022-09-21 19:51:49 INFO  Executing generated plans
2022-09-21 19:52:16 INFO  ---RUNTIME: Execution took 27634.241580963135 ms
2022-09-21 19:52:16 INFO  Done!
2022-09-21 19:52:16 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-21 19:52:16 INFO  Running instrumented original pipeline...
2022-09-21 19:52:16 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-21 19:52:16 INFO  ---RUNTIME: Importing and monkey-patching took 8.77237319946289 ms
2022-09-21 19:52:42 INFO  ---RUNTIME: Original pipeline execution took 25979.22992706299 ms (excluding imports and monkey-patching)
2022-09-21 19:52:42 INFO  Starting execution of 1 what-if analyses...
2022-09-21 19:52:42 INFO  Start plan generation for analysis PermutationFeatureImportance...
2022-09-21 19:52:42 INFO  ---RUNTIME: Plan generation took 0.1633167266845703 ms
2022-09-21 19:52:42 INFO  Estimated runtime of original DAG is 24224.24840927124ms
2022-09-21 19:52:42 WARNING Skipping Multi-Query Optimization (instead, only applying patches)
2022-09-21 19:52:42 INFO  Estimated unoptimised what-if runtime is 121121.2420463562ms
2022-09-21 19:52:42 INFO  ---RUNTIME: Multi-Query Optimization took 8.040904998779297 ms
2022-09-21 19:52:42 INFO  Executing generated plans
2022-09-21 19:54:37 INFO  ---RUNTIME: Execution took 114496.53649330139 ms
2022-09-21 19:54:37 INFO  Done!
2022-09-21 19:54:37 INFO  # Finished -- repetition 6 of 7 
2022-09-21 19:54:37 INFO  # Optimization benchmark for feature_importance with args [['reviews', 'fast_loading', 'featurization_2', 'xgboost']] -- repetition 7 of 7
2022-09-21 19:54:37 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-21 19:54:37 INFO  Running instrumented original pipeline...
2022-09-21 19:54:37 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-21 19:54:37 INFO  ---RUNTIME: Importing and monkey-patching took 9.285926818847656 ms
2022-09-21 19:55:03 INFO  ---RUNTIME: Original pipeline execution took 25943.308353424072 ms (excluding imports and monkey-patching)
2022-09-21 19:55:03 INFO  Starting execution of 1 what-if analyses...
2022-09-21 19:55:03 INFO  Start plan generation for analysis PermutationFeatureImportance...
2022-09-21 19:55:03 INFO  ---RUNTIME: Plan generation took 0.30159950256347656 ms
2022-09-21 19:55:03 INFO  Estimated runtime of original DAG is 24316.360473632812ms
2022-09-21 19:55:03 INFO  Performing Multi-Query Optimization
2022-09-21 19:55:03 INFO  Estimated unoptimized what-if runtime is 121581.80236816406ms
2022-09-21 19:55:03 INFO  Estimated optimised what-if runtime is 26726.91512107849ms
2022-09-21 19:55:03 INFO  Estimated optimisation runtime saving is 94854.88724708557ms
2022-09-21 19:55:03 INFO  ---RUNTIME: Multi-Query Optimization took 16.434907913208008 ms
2022-09-21 19:55:03 INFO  Executing generated plans
2022-09-21 19:55:28 INFO  ---RUNTIME: Execution took 24750.678539276123 ms
2022-09-21 19:55:28 INFO  Done!
2022-09-21 19:55:28 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-21 19:55:28 INFO  Running instrumented original pipeline...
2022-09-21 19:55:28 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-21 19:55:28 INFO  ---RUNTIME: Importing and monkey-patching took 8.175134658813477 ms
2022-09-21 19:55:51 INFO  ---RUNTIME: Original pipeline execution took 23254.297494888306 ms (excluding imports and monkey-patching)
2022-09-21 19:55:51 INFO  Starting execution of 1 what-if analyses...
2022-09-21 19:55:51 INFO  Start plan generation for analysis PermutationFeatureImportance...
2022-09-21 19:55:51 INFO  ---RUNTIME: Plan generation took 0.16808509826660156 ms
2022-09-21 19:55:51 INFO  Estimated runtime of original DAG is 21877.620697021484ms
2022-09-21 19:55:51 WARNING Skipping Multi-Query Optimization (instead, only applying patches)
2022-09-21 19:55:51 INFO  Estimated unoptimised what-if runtime is 109388.10348510742ms
2022-09-21 19:55:51 INFO  ---RUNTIME: Multi-Query Optimization took 8.532047271728516 ms
2022-09-21 19:55:51 INFO  Executing generated plans
2022-09-21 19:57:49 INFO  ---RUNTIME: Execution took 118644.73176002502 ms
2022-09-21 19:57:49 INFO  Done!
2022-09-21 19:57:49 INFO  # Finished -- repetition 7 of 7 
2022-09-21 19:57:50 INFO  # Final results after all repetitions
2022-09-21 19:57:50 INFO     repetition  ... no_opt_what_if_execution_combined_model_training
0           0  ...                                     75476.516962
1           1  ...                                     70072.539806
2           2  ...                                     74675.879240
3           3  ...                                     87481.200695
4           4  ...                                     76937.478304
5           5  ...                                     72198.197842
6           6  ...                                     77396.345377

[7 rows x 26 columns]
taskset -c 32-39 PROTOCOL_BUFFERS_PYTHON_IMPLEMENTATION=python python3.9 benchmarks_end_to_end.py feature_importance reviews fast_loading featurization_2 neural_network
2022-09-21 19:57:53.617615: W tensorflow/stream_executor/platform/default/dso_loader.cc:64] Could not load dynamic library 'libcudart.so.11.0'; dlerror: libcudart.so.11.0: cannot open shared object file: No such file or directory; LD_LIBRARY_PATH: /home/sgrafbe/mlwhatif/venv/lib/python3.9/site-packages/cv2/../../lib64:
2022-09-21 19:57:53.617682: I tensorflow/stream_executor/cuda/cudart_stub.cc:29] Ignore above cudart dlerror if you do not have a GPU set up on your machine.
2022-09-21 19:57:55 INFO  Patching sys.argv with ['mlwhatif', 'reviews', 'fast_loading', 'featurization_2', 'neural_network']
2022-09-21 19:57:55 INFO  Running instrumented original pipeline...
2022-09-21 19:57:55 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-21 19:57:55 INFO  ---RUNTIME: Importing and monkey-patching took 185.56976318359375 ms
2022-09-21 19:58:04.041812: W tensorflow/stream_executor/platform/default/dso_loader.cc:64] Could not load dynamic library 'libcuda.so.1'; dlerror: libcuda.so.1: cannot open shared object file: No such file or directory; LD_LIBRARY_PATH: /home/sgrafbe/mlwhatif/venv/lib/python3.9/site-packages/cv2/../../lib64:
2022-09-21 19:58:04.041857: W tensorflow/stream_executor/cuda/cuda_driver.cc:326] failed call to cuInit: UNKNOWN ERROR (303)
2022-09-21 19:58:04.041882: I tensorflow/stream_executor/cuda/cuda_diagnostics.cc:156] kernel driver does not appear to be running on this host (angus): /proc/driver/nvidia/version does not exist
2022-09-21 19:58:04.042426: I tensorflow/core/platform/cpu_feature_guard.cc:142] This TensorFlow binary is optimized with oneAPI Deep Neural Network Library (oneDNN) to use the following CPU instructions in performance-critical operations:  AVX2 FMA
To enable them in other operations, rebuild TensorFlow with the appropriate compiler flags.
2022-09-21 19:58:05.034581: I tensorflow/compiler/mlir/mlir_graph_optimization_pass.cc:176] None of the MLIR Optimization Passes are enabled (registered 2)
2022-09-21 19:58:05.052289: I tensorflow/core/platform/profile_utils/cpu_utils.cc:114] CPU Frequency: 2595130000 Hz
2022-09-21 19:58:14 INFO  ---RUNTIME: Original pipeline execution took 18409.547090530396 ms (excluding imports and monkey-patching)
2022-09-21 19:58:14 INFO  Starting execution of 0 what-if analyses...
2022-09-21 19:58:14 INFO  Estimated runtime of original DAG is 16556.878328323364ms
2022-09-21 19:58:14 INFO  Performing Multi-Query Optimization
2022-09-21 19:58:14 INFO  Estimated unoptimized what-if runtime is 0ms
2022-09-21 19:58:14 INFO  Estimated optimised what-if runtime is 0ms
2022-09-21 19:58:14 INFO  Estimated optimisation runtime saving is 0ms
2022-09-21 19:58:14 INFO  ---RUNTIME: Multi-Query Optimization took 0.7526874542236328 ms
2022-09-21 19:58:14 INFO  Executing generated plans
2022-09-21 19:58:14 INFO  ---RUNTIME: Execution took 0.037670135498046875 ms
2022-09-21 19:58:14 INFO  Done!
2022-09-21 19:58:14 INFO  # Optimization benchmark for feature_importance with args [['reviews', 'fast_loading', 'featurization_2', 'neural_network']] -- repetition 1 of 7
2022-09-21 19:58:14 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-21 19:58:14 INFO  Running instrumented original pipeline...
2022-09-21 19:58:14 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-21 19:58:14 INFO  ---RUNTIME: Importing and monkey-patching took 8.05974006652832 ms
2022-09-21 19:58:32 INFO  ---RUNTIME: Original pipeline execution took 17969.915628433228 ms (excluding imports and monkey-patching)
2022-09-21 19:58:32 INFO  Starting execution of 1 what-if analyses...
2022-09-21 19:58:32 INFO  Start plan generation for analysis PermutationFeatureImportance...
2022-09-21 19:58:32 INFO  ---RUNTIME: Plan generation took 0.22530555725097656 ms
2022-09-21 19:58:32 INFO  Estimated runtime of original DAG is 16170.043230056763ms
2022-09-21 19:58:32 INFO  Performing Multi-Query Optimization
2022-09-21 19:58:32 INFO  Estimated unoptimized what-if runtime is 80850.21615028381ms
2022-09-21 19:58:32 INFO  Estimated optimised what-if runtime is 20877.990007400513ms
2022-09-21 19:58:32 INFO  Estimated optimisation runtime saving is 59972.2261428833ms
2022-09-21 19:58:32 INFO  ---RUNTIME: Multi-Query Optimization took 11.368274688720703 ms
2022-09-21 19:58:32 INFO  Executing generated plans
2022-09-21 19:58:54 INFO  ---RUNTIME: Execution took 21910.747289657593 ms
2022-09-21 19:58:54 INFO  Done!
2022-09-21 19:58:54 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-21 19:58:54 INFO  Running instrumented original pipeline...
2022-09-21 19:58:54 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-21 19:58:54 INFO  ---RUNTIME: Importing and monkey-patching took 6.257534027099609 ms
2022-09-21 19:59:12 INFO  ---RUNTIME: Original pipeline execution took 18091.085195541382 ms (excluding imports and monkey-patching)
2022-09-21 19:59:12 INFO  Starting execution of 1 what-if analyses...
2022-09-21 19:59:12 INFO  Start plan generation for analysis PermutationFeatureImportance...
2022-09-21 19:59:12 INFO  ---RUNTIME: Plan generation took 0.1385211944580078 ms
2022-09-21 19:59:12 INFO  Estimated runtime of original DAG is 15953.856945037842ms
2022-09-21 19:59:12 WARNING Skipping Multi-Query Optimization (instead, only applying patches)
2022-09-21 19:59:12 INFO  Estimated unoptimised what-if runtime is 79769.28472518921ms
2022-09-21 19:59:12 INFO  ---RUNTIME: Multi-Query Optimization took 4.132509231567383 ms
2022-09-21 19:59:12 INFO  Executing generated plans
2022-09-21 20:00:37 INFO  ---RUNTIME: Execution took 85617.3038482666 ms
2022-09-21 20:00:37 INFO  Done!
2022-09-21 20:00:37 INFO  # Finished -- repetition 1 of 7 
2022-09-21 20:00:37 INFO  # Optimization benchmark for feature_importance with args [['reviews', 'fast_loading', 'featurization_2', 'neural_network']] -- repetition 2 of 7
2022-09-21 20:00:37 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-21 20:00:37 INFO  Running instrumented original pipeline...
2022-09-21 20:00:37 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-21 20:00:37 INFO  ---RUNTIME: Importing and monkey-patching took 6.103277206420898 ms
2022-09-21 20:00:56 INFO  ---RUNTIME: Original pipeline execution took 18257.904052734375 ms (excluding imports and monkey-patching)
2022-09-21 20:00:56 INFO  Starting execution of 1 what-if analyses...
2022-09-21 20:00:56 INFO  Start plan generation for analysis PermutationFeatureImportance...
2022-09-21 20:00:56 INFO  ---RUNTIME: Plan generation took 0.13828277587890625 ms
2022-09-21 20:00:56 INFO  Estimated runtime of original DAG is 16908.232927322388ms
2022-09-21 20:00:56 INFO  Performing Multi-Query Optimization
2022-09-21 20:00:56 INFO  Estimated unoptimized what-if runtime is 84541.16463661194ms
2022-09-21 20:00:56 INFO  Estimated optimised what-if runtime is 21656.418561935425ms
2022-09-21 20:00:56 INFO  Estimated optimisation runtime saving is 62884.746074676514ms
2022-09-21 20:00:56 INFO  ---RUNTIME: Multi-Query Optimization took 10.349750518798828 ms
2022-09-21 20:00:56 INFO  Executing generated plans
2022-09-21 20:01:16 INFO  ---RUNTIME: Execution took 20352.928400039673 ms
2022-09-21 20:01:16 INFO  Done!
2022-09-21 20:01:16 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-21 20:01:16 INFO  Running instrumented original pipeline...
2022-09-21 20:01:16 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-21 20:01:16 INFO  ---RUNTIME: Importing and monkey-patching took 6.538629531860352 ms
2022-09-21 20:01:37 INFO  ---RUNTIME: Original pipeline execution took 20717.211484909058 ms (excluding imports and monkey-patching)
2022-09-21 20:01:37 INFO  Starting execution of 1 what-if analyses...
2022-09-21 20:01:37 INFO  Start plan generation for analysis PermutationFeatureImportance...
2022-09-21 20:01:37 INFO  ---RUNTIME: Plan generation took 0.1838207244873047 ms
2022-09-21 20:01:37 INFO  Estimated runtime of original DAG is 18940.336227416992ms
2022-09-21 20:01:37 WARNING Skipping Multi-Query Optimization (instead, only applying patches)
2022-09-21 20:01:37 INFO  Estimated unoptimised what-if runtime is 94701.68113708496ms
2022-09-21 20:01:37 INFO  ---RUNTIME: Multi-Query Optimization took 5.951166152954102 ms
2022-09-21 20:01:37 INFO  Executing generated plans
2022-09-21 20:03:12 INFO  ---RUNTIME: Execution took 95116.28270149231 ms
2022-09-21 20:03:12 INFO  Done!
2022-09-21 20:03:12 INFO  # Finished -- repetition 2 of 7 
2022-09-21 20:03:12 INFO  # Optimization benchmark for feature_importance with args [['reviews', 'fast_loading', 'featurization_2', 'neural_network']] -- repetition 3 of 7
2022-09-21 20:03:12 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-21 20:03:12 INFO  Running instrumented original pipeline...
2022-09-21 20:03:12 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-21 20:03:12 INFO  ---RUNTIME: Importing and monkey-patching took 6.117820739746094 ms
2022-09-21 20:03:30 INFO  ---RUNTIME: Original pipeline execution took 18048.659801483154 ms (excluding imports and monkey-patching)
2022-09-21 20:03:30 INFO  Starting execution of 1 what-if analyses...
2022-09-21 20:03:30 INFO  Start plan generation for analysis PermutationFeatureImportance...
2022-09-21 20:03:30 INFO  ---RUNTIME: Plan generation took 0.12612342834472656 ms
2022-09-21 20:03:30 INFO  Estimated runtime of original DAG is 16788.828372955322ms
2022-09-21 20:03:30 INFO  Performing Multi-Query Optimization
2022-09-21 20:03:30 INFO  Estimated unoptimized what-if runtime is 83944.14186477661ms
2022-09-21 20:03:30 INFO  Estimated optimised what-if runtime is 22033.555507659912ms
2022-09-21 20:03:30 INFO  Estimated optimisation runtime saving is 61910.5863571167ms
2022-09-21 20:03:30 INFO  ---RUNTIME: Multi-Query Optimization took 11.114835739135742 ms
2022-09-21 20:03:30 INFO  Executing generated plans
2022-09-21 20:03:52 INFO  ---RUNTIME: Execution took 21721.630811691284 ms
2022-09-21 20:03:52 INFO  Done!
2022-09-21 20:03:52 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-21 20:03:52 INFO  Running instrumented original pipeline...
2022-09-21 20:03:52 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-21 20:03:52 INFO  ---RUNTIME: Importing and monkey-patching took 8.8653564453125 ms
2022-09-21 20:04:09 INFO  ---RUNTIME: Original pipeline execution took 17487.407684326172 ms (excluding imports and monkey-patching)
2022-09-21 20:04:09 INFO  Starting execution of 1 what-if analyses...
2022-09-21 20:04:09 INFO  Start plan generation for analysis PermutationFeatureImportance...
2022-09-21 20:04:09 INFO  ---RUNTIME: Plan generation took 0.1609325408935547 ms
2022-09-21 20:04:09 INFO  Estimated runtime of original DAG is 15973.6008644104ms
2022-09-21 20:04:09 WARNING Skipping Multi-Query Optimization (instead, only applying patches)
2022-09-21 20:04:09 INFO  Estimated unoptimised what-if runtime is 79868.004322052ms
2022-09-21 20:04:09 INFO  ---RUNTIME: Multi-Query Optimization took 6.057262420654297 ms
2022-09-21 20:04:09 INFO  Executing generated plans
2022-09-21 20:05:33 INFO  ---RUNTIME: Execution took 83567.45982170105 ms
2022-09-21 20:05:33 INFO  Done!
2022-09-21 20:05:33 INFO  # Finished -- repetition 3 of 7 
2022-09-21 20:05:33 INFO  # Optimization benchmark for feature_importance with args [['reviews', 'fast_loading', 'featurization_2', 'neural_network']] -- repetition 4 of 7
2022-09-21 20:05:33 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-21 20:05:33 INFO  Running instrumented original pipeline...
2022-09-21 20:05:33 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-21 20:05:33 INFO  ---RUNTIME: Importing and monkey-patching took 11.322498321533203 ms
2022-09-21 20:05:54 INFO  ---RUNTIME: Original pipeline execution took 21340.745449066162 ms (excluding imports and monkey-patching)
2022-09-21 20:05:54 INFO  Starting execution of 1 what-if analyses...
2022-09-21 20:05:54 INFO  Start plan generation for analysis PermutationFeatureImportance...
2022-09-21 20:05:54 INFO  ---RUNTIME: Plan generation took 0.16546249389648438 ms
2022-09-21 20:05:54 INFO  Estimated runtime of original DAG is 19494.520664215088ms
2022-09-21 20:05:54 INFO  Performing Multi-Query Optimization
2022-09-21 20:05:54 INFO  Estimated unoptimized what-if runtime is 97472.60332107544ms
2022-09-21 20:05:54 INFO  Estimated optimised what-if runtime is 26974.16639328003ms
2022-09-21 20:05:54 INFO  Estimated optimisation runtime saving is 70498.43692779541ms
2022-09-21 20:05:54 INFO  ---RUNTIME: Multi-Query Optimization took 15.922784805297852 ms
2022-09-21 20:05:54 INFO  Executing generated plans
2022-09-21 20:06:21 INFO  ---RUNTIME: Execution took 27267.75074005127 ms
2022-09-21 20:06:21 INFO  Done!
2022-09-21 20:06:21 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-21 20:06:21 INFO  Running instrumented original pipeline...
2022-09-21 20:06:21 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-21 20:06:21 INFO  ---RUNTIME: Importing and monkey-patching took 9.617090225219727 ms
2022-09-21 20:06:43 INFO  ---RUNTIME: Original pipeline execution took 21165.35234451294 ms (excluding imports and monkey-patching)
2022-09-21 20:06:43 INFO  Starting execution of 1 what-if analyses...
2022-09-21 20:06:43 INFO  Start plan generation for analysis PermutationFeatureImportance...
2022-09-21 20:06:43 INFO  ---RUNTIME: Plan generation took 0.1971721649169922 ms
2022-09-21 20:06:43 INFO  Estimated runtime of original DAG is 19372.424364089966ms
2022-09-21 20:06:43 WARNING Skipping Multi-Query Optimization (instead, only applying patches)
2022-09-21 20:06:43 INFO  Estimated unoptimised what-if runtime is 96862.12182044983ms
2022-09-21 20:06:43 INFO  ---RUNTIME: Multi-Query Optimization took 6.28352165222168 ms
2022-09-21 20:06:43 INFO  Executing generated plans
2022-09-21 20:08:07 INFO  ---RUNTIME: Execution took 84457.90243148804 ms
2022-09-21 20:08:07 INFO  Done!
2022-09-21 20:08:07 INFO  # Finished -- repetition 4 of 7 
2022-09-21 20:08:07 INFO  # Optimization benchmark for feature_importance with args [['reviews', 'fast_loading', 'featurization_2', 'neural_network']] -- repetition 5 of 7
2022-09-21 20:08:07 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-21 20:08:07 INFO  Running instrumented original pipeline...
2022-09-21 20:08:07 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-21 20:08:07 INFO  ---RUNTIME: Importing and monkey-patching took 7.280826568603516 ms
2022-09-21 20:08:24 INFO  ---RUNTIME: Original pipeline execution took 16878.78465652466 ms (excluding imports and monkey-patching)
2022-09-21 20:08:24 INFO  Starting execution of 1 what-if analyses...
2022-09-21 20:08:24 INFO  Start plan generation for analysis PermutationFeatureImportance...
2022-09-21 20:08:24 INFO  ---RUNTIME: Plan generation took 0.18167495727539062 ms
2022-09-21 20:08:24 INFO  Estimated runtime of original DAG is 15138.412952423096ms
2022-09-21 20:08:24 INFO  Performing Multi-Query Optimization
2022-09-21 20:08:24 INFO  Estimated unoptimized what-if runtime is 75692.06476211548ms
2022-09-21 20:08:24 INFO  Estimated optimised what-if runtime is 22012.840747833252ms
2022-09-21 20:08:24 INFO  Estimated optimisation runtime saving is 53679.22401428223ms
2022-09-21 20:08:24 INFO  ---RUNTIME: Multi-Query Optimization took 21.35944366455078 ms
2022-09-21 20:08:24 INFO  Executing generated plans
2022-09-21 20:08:48 INFO  ---RUNTIME: Execution took 23614.705085754395 ms
2022-09-21 20:08:48 INFO  Done!
2022-09-21 20:08:48 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-21 20:08:48 INFO  Running instrumented original pipeline...
2022-09-21 20:08:48 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-21 20:08:48 INFO  ---RUNTIME: Importing and monkey-patching took 13.599634170532227 ms
2022-09-21 20:09:05 INFO  ---RUNTIME: Original pipeline execution took 17236.608266830444 ms (excluding imports and monkey-patching)
2022-09-21 20:09:05 INFO  Starting execution of 1 what-if analyses...
2022-09-21 20:09:05 INFO  Start plan generation for analysis PermutationFeatureImportance...
2022-09-21 20:09:05 INFO  ---RUNTIME: Plan generation took 0.1068115234375 ms
2022-09-21 20:09:05 INFO  Estimated runtime of original DAG is 15349.526405334473ms
2022-09-21 20:09:05 WARNING Skipping Multi-Query Optimization (instead, only applying patches)
2022-09-21 20:09:05 INFO  Estimated unoptimised what-if runtime is 76747.63202667236ms
2022-09-21 20:09:05 INFO  ---RUNTIME: Multi-Query Optimization took 4.065752029418945 ms
2022-09-21 20:09:05 INFO  Executing generated plans
2022-09-21 20:10:35 INFO  ---RUNTIME: Execution took 90055.75919151306 ms
2022-09-21 20:10:35 INFO  Done!
2022-09-21 20:10:35 INFO  # Finished -- repetition 5 of 7 
2022-09-21 20:10:35 INFO  # Optimization benchmark for feature_importance with args [['reviews', 'fast_loading', 'featurization_2', 'neural_network']] -- repetition 6 of 7
2022-09-21 20:10:35 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-21 20:10:35 INFO  Running instrumented original pipeline...
2022-09-21 20:10:35 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-21 20:10:35 INFO  ---RUNTIME: Importing and monkey-patching took 11.29460334777832 ms
2022-09-21 20:10:56 INFO  ---RUNTIME: Original pipeline execution took 21233.633995056152 ms (excluding imports and monkey-patching)
2022-09-21 20:10:56 INFO  Starting execution of 1 what-if analyses...
2022-09-21 20:10:56 INFO  Start plan generation for analysis PermutationFeatureImportance...
2022-09-21 20:10:56 INFO  ---RUNTIME: Plan generation took 0.14781951904296875 ms
2022-09-21 20:10:56 INFO  Estimated runtime of original DAG is 19411.1807346344ms
2022-09-21 20:10:56 INFO  Performing Multi-Query Optimization
2022-09-21 20:10:56 INFO  Estimated unoptimized what-if runtime is 97055.903673172ms
2022-09-21 20:10:56 INFO  Estimated optimised what-if runtime is 26847.776889801025ms
2022-09-21 20:10:56 INFO  Estimated optimisation runtime saving is 70208.12678337097ms
2022-09-21 20:10:56 INFO  ---RUNTIME: Multi-Query Optimization took 16.700267791748047 ms
2022-09-21 20:10:56 INFO  Executing generated plans
2022-09-21 20:11:21 INFO  ---RUNTIME: Execution took 25008.17346572876 ms
2022-09-21 20:11:21 INFO  Done!
2022-09-21 20:11:21 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-21 20:11:21 INFO  Running instrumented original pipeline...
2022-09-21 20:11:21 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-21 20:11:21 INFO  ---RUNTIME: Importing and monkey-patching took 6.726980209350586 ms
2022-09-21 20:11:38 INFO  ---RUNTIME: Original pipeline execution took 16943.437576293945 ms (excluding imports and monkey-patching)
2022-09-21 20:11:38 INFO  Starting execution of 1 what-if analyses...
2022-09-21 20:11:38 INFO  Start plan generation for analysis PermutationFeatureImportance...
2022-09-21 20:11:38 INFO  ---RUNTIME: Plan generation took 0.1251697540283203 ms
2022-09-21 20:11:38 INFO  Estimated runtime of original DAG is 15116.619348526001ms
2022-09-21 20:11:38 WARNING Skipping Multi-Query Optimization (instead, only applying patches)
2022-09-21 20:11:38 INFO  Estimated unoptimised what-if runtime is 75583.09674263ms
2022-09-21 20:11:38 INFO  ---RUNTIME: Multi-Query Optimization took 5.062341690063477 ms
2022-09-21 20:11:38 INFO  Executing generated plans
2022-09-21 20:13:03 INFO  ---RUNTIME: Execution took 84374.7980594635 ms
2022-09-21 20:13:03 INFO  Done!
2022-09-21 20:13:03 INFO  # Finished -- repetition 6 of 7 
2022-09-21 20:13:03 INFO  # Optimization benchmark for feature_importance with args [['reviews', 'fast_loading', 'featurization_2', 'neural_network']] -- repetition 7 of 7
2022-09-21 20:13:03 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-21 20:13:03 INFO  Running instrumented original pipeline...
2022-09-21 20:13:03 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-21 20:13:03 INFO  ---RUNTIME: Importing and monkey-patching took 5.858898162841797 ms
2022-09-21 20:13:22 INFO  ---RUNTIME: Original pipeline execution took 19542.52028465271 ms (excluding imports and monkey-patching)
2022-09-21 20:13:22 INFO  Starting execution of 1 what-if analyses...
2022-09-21 20:13:22 INFO  Start plan generation for analysis PermutationFeatureImportance...
2022-09-21 20:13:22 INFO  ---RUNTIME: Plan generation took 0.10347366333007812 ms
2022-09-21 20:13:22 INFO  Estimated runtime of original DAG is 17688.62223625183ms
2022-09-21 20:13:22 INFO  Performing Multi-Query Optimization
2022-09-21 20:13:22 INFO  Estimated unoptimized what-if runtime is 88443.11118125916ms
2022-09-21 20:13:22 INFO  Estimated optimised what-if runtime is 22605.92269897461ms
2022-09-21 20:13:22 INFO  Estimated optimisation runtime saving is 65837.18848228455ms
2022-09-21 20:13:22 INFO  ---RUNTIME: Multi-Query Optimization took 10.978460311889648 ms
2022-09-21 20:13:22 INFO  Executing generated plans
2022-09-21 20:13:45 INFO  ---RUNTIME: Execution took 22461.42601966858 ms
2022-09-21 20:13:45 INFO  Done!
2022-09-21 20:13:45 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-21 20:13:45 INFO  Running instrumented original pipeline...
2022-09-21 20:13:45 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-21 20:13:45 INFO  ---RUNTIME: Importing and monkey-patching took 5.789518356323242 ms
2022-09-21 20:13:59 INFO  ---RUNTIME: Original pipeline execution took 14061.954736709595 ms (excluding imports and monkey-patching)
2022-09-21 20:13:59 INFO  Starting execution of 1 what-if analyses...
2022-09-21 20:13:59 INFO  Start plan generation for analysis PermutationFeatureImportance...
2022-09-21 20:13:59 INFO  ---RUNTIME: Plan generation took 0.13685226440429688 ms
2022-09-21 20:13:59 INFO  Estimated runtime of original DAG is 12843.440771102905ms
2022-09-21 20:13:59 WARNING Skipping Multi-Query Optimization (instead, only applying patches)
2022-09-21 20:13:59 INFO  Estimated unoptimised what-if runtime is 64217.20385551453ms
2022-09-21 20:13:59 INFO  ---RUNTIME: Multi-Query Optimization took 4.136323928833008 ms
2022-09-21 20:13:59 INFO  Executing generated plans
2022-09-21 20:15:08 INFO  ---RUNTIME: Execution took 69537.84132003784 ms
2022-09-21 20:15:08 INFO  Done!
2022-09-21 20:15:08 INFO  # Finished -- repetition 7 of 7 
2022-09-21 20:15:08 INFO  # Final results after all repetitions
2022-09-21 20:15:08 INFO     repetition  ... no_opt_what_if_execution_combined_model_training
0           0  ...                                     39218.769789
1           1  ...                                     44181.621075
2           2  ...                                     36593.873262
3           3  ...                                     36621.890545
4           4  ...                                     40209.985733
5           5  ...                                     36616.559029
6           6  ...                                     32739.934921

[7 rows x 26 columns]
taskset -c 32-39 PROTOCOL_BUFFERS_PYTHON_IMPLEMENTATION=python python3.9 benchmarks_end_to_end.py feature_importance reviews fast_loading featurization_3 logistic_regression
2022-09-21 20:15:11.469167: W tensorflow/stream_executor/platform/default/dso_loader.cc:64] Could not load dynamic library 'libcudart.so.11.0'; dlerror: libcudart.so.11.0: cannot open shared object file: No such file or directory; LD_LIBRARY_PATH: /home/sgrafbe/mlwhatif/venv/lib/python3.9/site-packages/cv2/../../lib64:
2022-09-21 20:15:11.469210: I tensorflow/stream_executor/cuda/cudart_stub.cc:29] Ignore above cudart dlerror if you do not have a GPU set up on your machine.
2022-09-21 20:15:12 INFO  Patching sys.argv with ['mlwhatif', 'reviews', 'fast_loading', 'featurization_3', 'logistic_regression']
2022-09-21 20:15:12 INFO  Running instrumented original pipeline...
2022-09-21 20:15:12 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-21 20:15:13 INFO  ---RUNTIME: Importing and monkey-patching took 125.48995018005371 ms
2022-09-21 20:15:53 INFO  ---RUNTIME: Original pipeline execution took 40331.61497116089 ms (excluding imports and monkey-patching)
2022-09-21 20:15:53 INFO  Starting execution of 0 what-if analyses...
2022-09-21 20:15:53 INFO  Estimated runtime of original DAG is 32929.484605789185ms
2022-09-21 20:15:53 INFO  Performing Multi-Query Optimization
2022-09-21 20:15:53 INFO  Estimated unoptimized what-if runtime is 0ms
2022-09-21 20:15:53 INFO  Estimated optimised what-if runtime is 0ms
2022-09-21 20:15:53 INFO  Estimated optimisation runtime saving is 0ms
2022-09-21 20:15:53 INFO  ---RUNTIME: Multi-Query Optimization took 0.5986690521240234 ms
2022-09-21 20:15:53 INFO  Executing generated plans
2022-09-21 20:15:53 INFO  ---RUNTIME: Execution took 0.03337860107421875 ms
2022-09-21 20:15:53 INFO  Done!
2022-09-21 20:15:53 INFO  # Optimization benchmark for feature_importance with args [['reviews', 'fast_loading', 'featurization_3', 'logistic_regression']] -- repetition 1 of 7
2022-09-21 20:15:53 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-21 20:15:53 INFO  Running instrumented original pipeline...
2022-09-21 20:15:53 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-21 20:15:53 INFO  ---RUNTIME: Importing and monkey-patching took 6.387233734130859 ms
2022-09-21 20:16:34 INFO  ---RUNTIME: Original pipeline execution took 41083.133935928345 ms (excluding imports and monkey-patching)
2022-09-21 20:16:34 INFO  Starting execution of 1 what-if analyses...
2022-09-21 20:16:34 INFO  Start plan generation for analysis PermutationFeatureImportance...
2022-09-21 20:16:34 INFO  ---RUNTIME: Plan generation took 0.20837783813476562 ms
2022-09-21 20:16:34 INFO  Estimated runtime of original DAG is 33523.58603477478ms
2022-09-21 20:16:34 INFO  Performing Multi-Query Optimization
2022-09-21 20:16:34 INFO  Estimated unoptimized what-if runtime is 167617.9301738739ms
2022-09-21 20:16:34 INFO  Estimated optimised what-if runtime is 50437.37316131592ms
2022-09-21 20:16:34 INFO  Estimated optimisation runtime saving is 117180.55701255798ms
2022-09-21 20:16:34 INFO  ---RUNTIME: Multi-Query Optimization took 12.677431106567383 ms
2022-09-21 20:16:34 INFO  Executing generated plans
2022-09-21 20:17:02 INFO  ---RUNTIME: Execution took 27988.558769226074 ms
2022-09-21 20:17:02 INFO  Done!
2022-09-21 20:17:02 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-21 20:17:02 INFO  Running instrumented original pipeline...
2022-09-21 20:17:02 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-21 20:17:02 INFO  ---RUNTIME: Importing and monkey-patching took 6.452322006225586 ms
2022-09-21 20:17:44 INFO  ---RUNTIME: Original pipeline execution took 42116.307973861694 ms (excluding imports and monkey-patching)
2022-09-21 20:17:44 INFO  Starting execution of 1 what-if analyses...
2022-09-21 20:17:44 INFO  Start plan generation for analysis PermutationFeatureImportance...
2022-09-21 20:17:44 INFO  ---RUNTIME: Plan generation took 0.14591217041015625 ms
2022-09-21 20:17:44 INFO  Estimated runtime of original DAG is 33466.68529510498ms
2022-09-21 20:17:44 WARNING Skipping Multi-Query Optimization (instead, only applying patches)
2022-09-21 20:17:44 INFO  Estimated unoptimised what-if runtime is 167333.4264755249ms
2022-09-21 20:17:44 INFO  ---RUNTIME: Multi-Query Optimization took 4.912614822387695 ms
2022-09-21 20:17:44 INFO  Executing generated plans
2022-09-21 20:20:16 INFO  ---RUNTIME: Execution took 151639.10961151123 ms
2022-09-21 20:20:16 INFO  Done!
2022-09-21 20:20:16 INFO  # Finished -- repetition 1 of 7 
2022-09-21 20:20:16 INFO  # Optimization benchmark for feature_importance with args [['reviews', 'fast_loading', 'featurization_3', 'logistic_regression']] -- repetition 2 of 7
2022-09-21 20:20:16 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-21 20:20:16 INFO  Running instrumented original pipeline...
2022-09-21 20:20:16 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-21 20:20:16 INFO  ---RUNTIME: Importing and monkey-patching took 6.46209716796875 ms
2022-09-21 20:21:08 INFO  ---RUNTIME: Original pipeline execution took 52759.613275527954 ms (excluding imports and monkey-patching)
2022-09-21 20:21:08 INFO  Starting execution of 1 what-if analyses...
2022-09-21 20:21:08 INFO  Start plan generation for analysis PermutationFeatureImportance...
2022-09-21 20:21:08 INFO  ---RUNTIME: Plan generation took 0.8938312530517578 ms
2022-09-21 20:21:08 INFO  Estimated runtime of original DAG is 38584.99312400818ms
2022-09-21 20:21:08 INFO  Performing Multi-Query Optimization
2022-09-21 20:21:09 INFO  Estimated unoptimized what-if runtime is 192924.9656200409ms
2022-09-21 20:21:09 INFO  Estimated optimised what-if runtime is 60764.002561569214ms
2022-09-21 20:21:09 INFO  Estimated optimisation runtime saving is 132160.96305847168ms
2022-09-21 20:21:09 INFO  ---RUNTIME: Multi-Query Optimization took 19.39988136291504 ms
2022-09-21 20:21:09 INFO  Executing generated plans
2022-09-21 20:21:46 INFO  ---RUNTIME: Execution took 37106.996059417725 ms
2022-09-21 20:21:46 INFO  Done!
2022-09-21 20:21:47 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-21 20:21:47 INFO  Running instrumented original pipeline...
2022-09-21 20:21:47 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-21 20:21:47 INFO  ---RUNTIME: Importing and monkey-patching took 10.31637191772461 ms
2022-09-21 20:22:28 INFO  ---RUNTIME: Original pipeline execution took 41593.661069869995 ms (excluding imports and monkey-patching)
2022-09-21 20:22:28 INFO  Starting execution of 1 what-if analyses...
2022-09-21 20:22:28 INFO  Start plan generation for analysis PermutationFeatureImportance...
2022-09-21 20:22:28 INFO  ---RUNTIME: Plan generation took 0.16760826110839844 ms
2022-09-21 20:22:28 INFO  Estimated runtime of original DAG is 33904.974699020386ms
2022-09-21 20:22:28 WARNING Skipping Multi-Query Optimization (instead, only applying patches)
2022-09-21 20:22:28 INFO  Estimated unoptimised what-if runtime is 169524.87349510193ms
2022-09-21 20:22:28 INFO  ---RUNTIME: Multi-Query Optimization took 6.570339202880859 ms
2022-09-21 20:22:28 INFO  Executing generated plans
2022-09-21 20:25:06 INFO  ---RUNTIME: Execution took 157742.89965629578 ms
2022-09-21 20:25:06 INFO  Done!
2022-09-21 20:25:07 INFO  # Finished -- repetition 2 of 7 
2022-09-21 20:25:07 INFO  # Optimization benchmark for feature_importance with args [['reviews', 'fast_loading', 'featurization_3', 'logistic_regression']] -- repetition 3 of 7
2022-09-21 20:25:07 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-21 20:25:07 INFO  Running instrumented original pipeline...
2022-09-21 20:25:07 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-21 20:25:07 INFO  ---RUNTIME: Importing and monkey-patching took 6.93821907043457 ms
2022-09-21 20:25:50 INFO  ---RUNTIME: Original pipeline execution took 42335.87074279785 ms (excluding imports and monkey-patching)
2022-09-21 20:25:50 INFO  Starting execution of 1 what-if analyses...
2022-09-21 20:25:50 INFO  Start plan generation for analysis PermutationFeatureImportance...
2022-09-21 20:25:50 INFO  ---RUNTIME: Plan generation took 0.1499652862548828 ms
2022-09-21 20:25:50 INFO  Estimated runtime of original DAG is 33631.56843185425ms
2022-09-21 20:25:50 INFO  Performing Multi-Query Optimization
2022-09-21 20:25:50 INFO  Estimated unoptimized what-if runtime is 168157.84215927124ms
2022-09-21 20:25:50 INFO  Estimated optimised what-if runtime is 50281.8329334259ms
2022-09-21 20:25:50 INFO  Estimated optimisation runtime saving is 117876.00922584534ms
2022-09-21 20:25:50 INFO  ---RUNTIME: Multi-Query Optimization took 13.930559158325195 ms
2022-09-21 20:25:50 INFO  Executing generated plans
2022-09-21 20:26:26 INFO  ---RUNTIME: Execution took 36647.12738990784 ms
2022-09-21 20:26:26 INFO  Done!
2022-09-21 20:26:28 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-21 20:26:28 INFO  Running instrumented original pipeline...
2022-09-21 20:26:28 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-21 20:26:28 INFO  ---RUNTIME: Importing and monkey-patching took 7.218360900878906 ms
2022-09-21 20:27:15 INFO  ---RUNTIME: Original pipeline execution took 47820.96338272095 ms (excluding imports and monkey-patching)
2022-09-21 20:27:15 INFO  Starting execution of 1 what-if analyses...
2022-09-21 20:27:15 INFO  Start plan generation for analysis PermutationFeatureImportance...
2022-09-21 20:27:15 INFO  ---RUNTIME: Plan generation took 0.1575946807861328 ms
2022-09-21 20:27:15 INFO  Estimated runtime of original DAG is 35265.52438735962ms
2022-09-21 20:27:15 WARNING Skipping Multi-Query Optimization (instead, only applying patches)
2022-09-21 20:27:15 INFO  Estimated unoptimised what-if runtime is 176327.6219367981ms
2022-09-21 20:27:15 INFO  ---RUNTIME: Multi-Query Optimization took 4.999876022338867 ms
2022-09-21 20:27:15 INFO  Executing generated plans
2022-09-21 20:30:13 INFO  ---RUNTIME: Execution took 177162.12844848633 ms
2022-09-21 20:30:13 INFO  Done!
2022-09-21 20:30:13 INFO  # Finished -- repetition 3 of 7 
2022-09-21 20:30:13 INFO  # Optimization benchmark for feature_importance with args [['reviews', 'fast_loading', 'featurization_3', 'logistic_regression']] -- repetition 4 of 7
2022-09-21 20:30:13 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-21 20:30:13 INFO  Running instrumented original pipeline...
2022-09-21 20:30:13 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-21 20:30:13 INFO  ---RUNTIME: Importing and monkey-patching took 6.68644905090332 ms
2022-09-21 20:30:55 INFO  ---RUNTIME: Original pipeline execution took 41801.57947540283 ms (excluding imports and monkey-patching)
2022-09-21 20:30:55 INFO  Starting execution of 1 what-if analyses...
2022-09-21 20:30:55 INFO  Start plan generation for analysis PermutationFeatureImportance...
2022-09-21 20:30:55 INFO  ---RUNTIME: Plan generation took 0.17142295837402344 ms
2022-09-21 20:30:55 INFO  Estimated runtime of original DAG is 34039.17193412781ms
2022-09-21 20:30:55 INFO  Performing Multi-Query Optimization
2022-09-21 20:30:55 INFO  Estimated unoptimized what-if runtime is 170195.85967063904ms
2022-09-21 20:30:55 INFO  Estimated optimised what-if runtime is 51216.86100959778ms
2022-09-21 20:30:55 INFO  Estimated optimisation runtime saving is 118978.99866104126ms
2022-09-21 20:30:55 INFO  ---RUNTIME: Multi-Query Optimization took 13.196945190429688 ms
2022-09-21 20:30:55 INFO  Executing generated plans
2022-09-21 20:31:32 INFO  ---RUNTIME: Execution took 37759.07564163208 ms
2022-09-21 20:31:32 INFO  Done!
2022-09-21 20:31:33 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-21 20:31:33 INFO  Running instrumented original pipeline...
2022-09-21 20:31:33 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-21 20:31:33 INFO  ---RUNTIME: Importing and monkey-patching took 6.859540939331055 ms
2022-09-21 20:32:15 INFO  ---RUNTIME: Original pipeline execution took 42564.356088638306 ms (excluding imports and monkey-patching)
2022-09-21 20:32:15 INFO  Starting execution of 1 what-if analyses...
2022-09-21 20:32:15 INFO  Start plan generation for analysis PermutationFeatureImportance...
2022-09-21 20:32:15 INFO  ---RUNTIME: Plan generation took 0.1690387725830078 ms
2022-09-21 20:32:15 INFO  Estimated runtime of original DAG is 33740.9303188324ms
2022-09-21 20:32:15 WARNING Skipping Multi-Query Optimization (instead, only applying patches)
2022-09-21 20:32:15 INFO  Estimated unoptimised what-if runtime is 168704.651594162ms
2022-09-21 20:32:15 INFO  ---RUNTIME: Multi-Query Optimization took 5.047082901000977 ms
2022-09-21 20:32:15 INFO  Executing generated plans
2022-09-21 20:35:07 INFO  ---RUNTIME: Execution took 171850.91018676758 ms
2022-09-21 20:35:07 INFO  Done!
2022-09-21 20:35:09 INFO  # Finished -- repetition 4 of 7 
2022-09-21 20:35:09 INFO  # Optimization benchmark for feature_importance with args [['reviews', 'fast_loading', 'featurization_3', 'logistic_regression']] -- repetition 5 of 7
2022-09-21 20:35:09 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-21 20:35:09 INFO  Running instrumented original pipeline...
2022-09-21 20:35:09 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-21 20:35:09 INFO  ---RUNTIME: Importing and monkey-patching took 8.029460906982422 ms
2022-09-21 20:35:56 INFO  ---RUNTIME: Original pipeline execution took 47354.15434837341 ms (excluding imports and monkey-patching)
2022-09-21 20:35:56 INFO  Starting execution of 1 what-if analyses...
2022-09-21 20:35:56 INFO  Start plan generation for analysis PermutationFeatureImportance...
2022-09-21 20:35:56 INFO  ---RUNTIME: Plan generation took 0.1590251922607422 ms
2022-09-21 20:35:56 INFO  Estimated runtime of original DAG is 34689.92519378662ms
2022-09-21 20:35:56 INFO  Performing Multi-Query Optimization
2022-09-21 20:35:56 INFO  Estimated unoptimized what-if runtime is 173449.6259689331ms
2022-09-21 20:35:56 INFO  Estimated optimised what-if runtime is 52246.10161781311ms
2022-09-21 20:35:56 INFO  Estimated optimisation runtime saving is 121203.52435112ms
2022-09-21 20:35:56 INFO  ---RUNTIME: Multi-Query Optimization took 13.063192367553711 ms
2022-09-21 20:35:56 INFO  Executing generated plans
2022-09-21 20:36:34 INFO  ---RUNTIME: Execution took 37559.823989868164 ms
2022-09-21 20:36:34 INFO  Done!
2022-09-21 20:36:34 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-21 20:36:34 INFO  Running instrumented original pipeline...
2022-09-21 20:36:34 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-21 20:36:34 INFO  ---RUNTIME: Importing and monkey-patching took 7.159948348999023 ms
2022-09-21 20:37:18 INFO  ---RUNTIME: Original pipeline execution took 44515.738010406494 ms (excluding imports and monkey-patching)
2022-09-21 20:37:18 INFO  Starting execution of 1 what-if analyses...
2022-09-21 20:37:18 INFO  Start plan generation for analysis PermutationFeatureImportance...
2022-09-21 20:37:18 INFO  ---RUNTIME: Plan generation took 0.15592575073242188 ms
2022-09-21 20:37:18 INFO  Estimated runtime of original DAG is 32914.90864753723ms
2022-09-21 20:37:18 WARNING Skipping Multi-Query Optimization (instead, only applying patches)
2022-09-21 20:37:18 INFO  Estimated unoptimised what-if runtime is 164574.54323768616ms
2022-09-21 20:37:18 INFO  ---RUNTIME: Multi-Query Optimization took 5.150556564331055 ms
2022-09-21 20:37:18 INFO  Executing generated plans
2022-09-21 20:40:13 INFO  ---RUNTIME: Execution took 174246.0916042328 ms
2022-09-21 20:40:13 INFO  Done!
2022-09-21 20:40:13 INFO  # Finished -- repetition 5 of 7 
2022-09-21 20:40:13 INFO  # Optimization benchmark for feature_importance with args [['reviews', 'fast_loading', 'featurization_3', 'logistic_regression']] -- repetition 6 of 7
2022-09-21 20:40:13 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-21 20:40:13 INFO  Running instrumented original pipeline...
2022-09-21 20:40:13 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-21 20:40:13 INFO  ---RUNTIME: Importing and monkey-patching took 7.064104080200195 ms
2022-09-21 20:40:56 INFO  ---RUNTIME: Original pipeline execution took 42879.52995300293 ms (excluding imports and monkey-patching)
2022-09-21 20:40:56 INFO  Starting execution of 1 what-if analyses...
2022-09-21 20:40:56 INFO  Start plan generation for analysis PermutationFeatureImportance...
2022-09-21 20:40:56 INFO  ---RUNTIME: Plan generation took 0.1556873321533203 ms
2022-09-21 20:40:56 INFO  Estimated runtime of original DAG is 33296.3490486145ms
2022-09-21 20:40:56 INFO  Performing Multi-Query Optimization
2022-09-21 20:40:56 INFO  Estimated unoptimized what-if runtime is 166481.7452430725ms
2022-09-21 20:40:56 INFO  Estimated optimised what-if runtime is 50214.49828147888ms
2022-09-21 20:40:56 INFO  Estimated optimisation runtime saving is 116267.24696159363ms
2022-09-21 20:40:56 INFO  ---RUNTIME: Multi-Query Optimization took 12.872457504272461 ms
2022-09-21 20:40:56 INFO  Executing generated plans
2022-09-21 20:41:31 INFO  ---RUNTIME: Execution took 34992.05780029297 ms
2022-09-21 20:41:31 INFO  Done!
2022-09-21 20:41:32 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-21 20:41:32 INFO  Running instrumented original pipeline...
2022-09-21 20:41:32 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-21 20:41:32 INFO  ---RUNTIME: Importing and monkey-patching took 6.318092346191406 ms
2022-09-21 20:42:23 INFO  ---RUNTIME: Original pipeline execution took 51107.502460479736 ms (excluding imports and monkey-patching)
2022-09-21 20:42:23 INFO  Starting execution of 1 what-if analyses...
2022-09-21 20:42:23 INFO  Start plan generation for analysis PermutationFeatureImportance...
2022-09-21 20:42:23 INFO  ---RUNTIME: Plan generation took 0.1976490020751953 ms
2022-09-21 20:42:23 INFO  Estimated runtime of original DAG is 35933.138847351074ms
2022-09-21 20:42:23 WARNING Skipping Multi-Query Optimization (instead, only applying patches)
2022-09-21 20:42:23 INFO  Estimated unoptimised what-if runtime is 179665.69423675537ms
2022-09-21 20:42:23 INFO  ---RUNTIME: Multi-Query Optimization took 4.962444305419922 ms
2022-09-21 20:42:23 INFO  Executing generated plans
./run-benchmarks--end-to-end.sh: line 50: 2042354 Killed                  PROTOCOL_BUFFERS_PYTHON_IMPLEMENTATION=python taskset -c "$core_num" python3.9 benchmarks_end_to_end.py "$scenario" "$dataset" "$data_loading" "$featurization" "$model"
taskset -c 32-39 PROTOCOL_BUFFERS_PYTHON_IMPLEMENTATION=python python3.9 benchmarks_end_to_end.py feature_importance reviews fast_loading featurization_3 xgboost
2022-09-21 20:42:35.823255: W tensorflow/stream_executor/platform/default/dso_loader.cc:64] Could not load dynamic library 'libcudart.so.11.0'; dlerror: libcudart.so.11.0: cannot open shared object file: No such file or directory; LD_LIBRARY_PATH: /home/sgrafbe/mlwhatif/venv/lib/python3.9/site-packages/cv2/../../lib64:
2022-09-21 20:42:35.823293: I tensorflow/stream_executor/cuda/cudart_stub.cc:29] Ignore above cudart dlerror if you do not have a GPU set up on your machine.
2022-09-21 20:42:38 INFO  Patching sys.argv with ['mlwhatif', 'reviews', 'fast_loading', 'featurization_3', 'xgboost']
2022-09-21 20:42:38 INFO  Running instrumented original pipeline...
2022-09-21 20:42:38 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-21 20:42:38 INFO  ---RUNTIME: Importing and monkey-patching took 210.30330657958984 ms
2022-09-21 20:43:32 INFO  ---RUNTIME: Original pipeline execution took 54316.96438789368 ms (excluding imports and monkey-patching)
2022-09-21 20:43:32 INFO  Starting execution of 0 what-if analyses...
2022-09-21 20:43:32 INFO  Estimated runtime of original DAG is 46793.79653930664ms
2022-09-21 20:43:32 INFO  Performing Multi-Query Optimization
2022-09-21 20:43:32 INFO  Estimated unoptimized what-if runtime is 0ms
2022-09-21 20:43:32 INFO  Estimated optimised what-if runtime is 0ms
2022-09-21 20:43:32 INFO  Estimated optimisation runtime saving is 0ms
2022-09-21 20:43:32 INFO  ---RUNTIME: Multi-Query Optimization took 0.576019287109375 ms
2022-09-21 20:43:32 INFO  Executing generated plans
2022-09-21 20:43:32 INFO  ---RUNTIME: Execution took 0.023365020751953125 ms
2022-09-21 20:43:32 INFO  Done!
2022-09-21 20:43:32 INFO  # Optimization benchmark for feature_importance with args [['reviews', 'fast_loading', 'featurization_3', 'xgboost']] -- repetition 1 of 7
2022-09-21 20:43:32 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-21 20:43:32 INFO  Running instrumented original pipeline...
2022-09-21 20:43:32 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-21 20:43:32 INFO  ---RUNTIME: Importing and monkey-patching took 5.730628967285156 ms
2022-09-21 20:44:26 INFO  ---RUNTIME: Original pipeline execution took 53833.51683616638 ms (excluding imports and monkey-patching)
2022-09-21 20:44:26 INFO  Starting execution of 1 what-if analyses...
2022-09-21 20:44:26 INFO  Start plan generation for analysis PermutationFeatureImportance...
2022-09-21 20:44:26 INFO  ---RUNTIME: Plan generation took 0.2727508544921875 ms
2022-09-21 20:44:26 INFO  Estimated runtime of original DAG is 45656.967878341675ms
2022-09-21 20:44:26 INFO  Performing Multi-Query Optimization
2022-09-21 20:44:26 INFO  Estimated unoptimized what-if runtime is 228284.83939170837ms
2022-09-21 20:44:26 INFO  Estimated optimised what-if runtime is 62165.84372520447ms
2022-09-21 20:44:26 INFO  Estimated optimisation runtime saving is 166118.9956665039ms
2022-09-21 20:44:26 INFO  ---RUNTIME: Multi-Query Optimization took 12.632369995117188 ms
2022-09-21 20:44:26 INFO  Executing generated plans
2022-09-21 20:45:15 INFO  ---RUNTIME: Execution took 48442.63672828674 ms
2022-09-21 20:45:15 INFO  Done!
2022-09-21 20:45:15 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-21 20:45:15 INFO  Running instrumented original pipeline...
2022-09-21 20:45:15 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-21 20:45:15 INFO  ---RUNTIME: Importing and monkey-patching took 6.232023239135742 ms
2022-09-21 20:46:19 INFO  ---RUNTIME: Original pipeline execution took 64361.55581474304 ms (excluding imports and monkey-patching)
2022-09-21 20:46:19 INFO  Starting execution of 1 what-if analyses...
2022-09-21 20:46:19 INFO  Start plan generation for analysis PermutationFeatureImportance...
2022-09-21 20:46:19 INFO  ---RUNTIME: Plan generation took 0.13375282287597656 ms
2022-09-21 20:46:19 INFO  Estimated runtime of original DAG is 50388.83852958679ms
2022-09-21 20:46:19 WARNING Skipping Multi-Query Optimization (instead, only applying patches)
2022-09-21 20:46:19 INFO  Estimated unoptimised what-if runtime is 251944.19264793396ms
2022-09-21 20:46:19 INFO  ---RUNTIME: Multi-Query Optimization took 4.881858825683594 ms
2022-09-21 20:46:19 INFO  Executing generated plans
Traceback (most recent call last):
  File "/home/sgrafbe/mlwhatif/experiments/end_to_end/benchmarks_end_to_end.py", line 238, in <module>
    analysis_result_no_opt = PipelineAnalyzer \
  File "/home/sgrafbe/mlwhatif/mlwhatif/_pipeline_analyzer.py", line 93, in execute
    return singleton.run(notebook_path=self._notebook_path,
  File "/home/sgrafbe/mlwhatif/mlwhatif/execution/_pipeline_executor.py", line 149, in run
    self.run_what_if_analyses()
  File "/home/sgrafbe/mlwhatif/mlwhatif/execution/_pipeline_executor.py", line 181, in run_what_if_analyses
    DagExecutor(self).execute(what_if_dag)
  File "/home/sgrafbe/mlwhatif/mlwhatif/execution/_dag_executor.py", line 45, in execute
    self.traverse_graph_and_process_nodes(dag, execute_node)
  File "/home/sgrafbe/mlwhatif/mlwhatif/execution/_dag_executor.py", line 57, in traverse_graph_and_process_nodes
    result_node = func(node)
  File "/home/sgrafbe/mlwhatif/mlwhatif/execution/_dag_executor.py", line 40, in execute_node
    optimizer_info, result_df = capture_optimizer_info(executable_processing_func)
  File "/home/sgrafbe/mlwhatif/mlwhatif/execution/_stat_tracking.py", line 28, in capture_optimizer_info
    result = instrumented_function_call()
  File "/home/sgrafbe/mlwhatif/mlwhatif/monkeypatching/_patch_sklearn.py", line 1729, in processing_func
    transformed_data = wrap_in_mlinspect_array_if_necessary(transformed_data)
  File "/home/sgrafbe/mlwhatif/mlwhatif/monkeypatching/_monkey_patching_utils.py", line 229, in wrap_in_mlinspect_array_if_necessary
    df_object = MlinspectNdarray(df_object)
  File "/home/sgrafbe/mlwhatif/mlwhatif/monkeypatching/_mlinspect_ndarray.py", line 16, in __new__
    obj = numpy.asarray(input_array).view(cls)
  File "/home/sgrafbe/mlwhatif/venv/lib64/python3.9/site-packages/numpy/core/_asarray.py", line 83, in asarray
    return array(a, dtype, copy=False, order=order)
numpy.core._exceptions.MemoryError: Unable to allocate 3.71 GiB for an array with shape (35312,) and data type <U28219
taskset -c 32-39 PROTOCOL_BUFFERS_PYTHON_IMPLEMENTATION=python python3.9 benchmarks_end_to_end.py feature_importance reviews fast_loading featurization_3 neural_network
2022-09-21 20:49:50.221424: W tensorflow/stream_executor/platform/default/dso_loader.cc:64] Could not load dynamic library 'libcudart.so.11.0'; dlerror: libcudart.so.11.0: cannot open shared object file: No such file or directory; LD_LIBRARY_PATH: /home/sgrafbe/mlwhatif/venv/lib/python3.9/site-packages/cv2/../../lib64:
2022-09-21 20:49:50.221462: I tensorflow/stream_executor/cuda/cudart_stub.cc:29] Ignore above cudart dlerror if you do not have a GPU set up on your machine.
2022-09-21 20:49:51 INFO  Patching sys.argv with ['mlwhatif', 'reviews', 'fast_loading', 'featurization_3', 'neural_network']
2022-09-21 20:49:51 INFO  Running instrumented original pipeline...
2022-09-21 20:49:51 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-21 20:49:51 INFO  ---RUNTIME: Importing and monkey-patching took 122.62487411499023 ms
2022-09-21 20:50:15.272127: W tensorflow/stream_executor/platform/default/dso_loader.cc:64] Could not load dynamic library 'libcuda.so.1'; dlerror: libcuda.so.1: cannot open shared object file: No such file or directory; LD_LIBRARY_PATH: /home/sgrafbe/mlwhatif/venv/lib/python3.9/site-packages/cv2/../../lib64:
2022-09-21 20:50:15.272165: W tensorflow/stream_executor/cuda/cuda_driver.cc:326] failed call to cuInit: UNKNOWN ERROR (303)
2022-09-21 20:50:15.272190: I tensorflow/stream_executor/cuda/cuda_diagnostics.cc:156] kernel driver does not appear to be running on this host (angus): /proc/driver/nvidia/version does not exist
2022-09-21 20:50:15.272692: I tensorflow/core/platform/cpu_feature_guard.cc:142] This TensorFlow binary is optimized with oneAPI Deep Neural Network Library (oneDNN) to use the following CPU instructions in performance-critical operations:  AVX2 FMA
To enable them in other operations, rebuild TensorFlow with the appropriate compiler flags.
2022-09-21 20:50:15.912365: I tensorflow/compiler/mlir/mlir_graph_optimization_pass.cc:176] None of the MLIR Optimization Passes are enabled (registered 2)
2022-09-21 20:50:15.926184: I tensorflow/core/platform/profile_utils/cpu_utils.cc:114] CPU Frequency: 2595130000 Hz
2022-09-21 20:50:40 INFO  ---RUNTIME: Original pipeline execution took 48934.57746505737 ms (excluding imports and monkey-patching)
2022-09-21 20:50:40 INFO  Starting execution of 0 what-if analyses...
2022-09-21 20:50:40 INFO  Estimated runtime of original DAG is 41547.06144332886ms
2022-09-21 20:50:40 INFO  Performing Multi-Query Optimization
2022-09-21 20:50:40 INFO  Estimated unoptimized what-if runtime is 0ms
2022-09-21 20:50:40 INFO  Estimated optimised what-if runtime is 0ms
2022-09-21 20:50:40 INFO  Estimated optimisation runtime saving is 0ms
2022-09-21 20:50:40 INFO  ---RUNTIME: Multi-Query Optimization took 0.5605220794677734 ms
2022-09-21 20:50:40 INFO  Executing generated plans
2022-09-21 20:50:40 INFO  ---RUNTIME: Execution took 0.015497207641601562 ms
2022-09-21 20:50:40 INFO  Done!
2022-09-21 20:50:40 INFO  # Optimization benchmark for feature_importance with args [['reviews', 'fast_loading', 'featurization_3', 'neural_network']] -- repetition 1 of 7
2022-09-21 20:50:40 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-21 20:50:40 INFO  Running instrumented original pipeline...
2022-09-21 20:50:40 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-21 20:50:40 INFO  ---RUNTIME: Importing and monkey-patching took 5.426883697509766 ms
2022-09-21 20:51:29 INFO  ---RUNTIME: Original pipeline execution took 48689.61238861084 ms (excluding imports and monkey-patching)
2022-09-21 20:51:29 INFO  Starting execution of 1 what-if analyses...
2022-09-21 20:51:29 INFO  Start plan generation for analysis PermutationFeatureImportance...
2022-09-21 20:51:29 INFO  ---RUNTIME: Plan generation took 0.2617835998535156 ms
2022-09-21 20:51:29 INFO  Estimated runtime of original DAG is 38991.42861366272ms
2022-09-21 20:51:29 INFO  Performing Multi-Query Optimization
2022-09-21 20:51:29 INFO  Estimated unoptimized what-if runtime is 194957.1430683136ms
2022-09-21 20:51:29 INFO  Estimated optimised what-if runtime is 58268.529653549194ms
2022-09-21 20:51:29 INFO  Estimated optimisation runtime saving is 136688.6134147644ms
2022-09-21 20:51:29 INFO  ---RUNTIME: Multi-Query Optimization took 13.040542602539062 ms
2022-09-21 20:51:29 INFO  Executing generated plans
2022-09-21 20:52:10 INFO  ---RUNTIME: Execution took 41107.372760772705 ms
2022-09-21 20:52:10 INFO  Done!
2022-09-21 20:52:10 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-21 20:52:10 INFO  Running instrumented original pipeline...
2022-09-21 20:52:10 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-21 20:52:10 INFO  ---RUNTIME: Importing and monkey-patching took 5.761623382568359 ms
2022-09-21 20:53:15 INFO  ---RUNTIME: Original pipeline execution took 64991.252183914185 ms (excluding imports and monkey-patching)
2022-09-21 20:53:15 INFO  Starting execution of 1 what-if analyses...
2022-09-21 20:53:15 INFO  Start plan generation for analysis PermutationFeatureImportance...
2022-09-21 20:53:15 INFO  ---RUNTIME: Plan generation took 0.13828277587890625 ms
2022-09-21 20:53:15 INFO  Estimated runtime of original DAG is 43509.21726226807ms
2022-09-21 20:53:15 WARNING Skipping Multi-Query Optimization (instead, only applying patches)
2022-09-21 20:53:15 INFO  Estimated unoptimised what-if runtime is 217546.08631134033ms
2022-09-21 20:53:15 INFO  ---RUNTIME: Multi-Query Optimization took 4.803895950317383 ms
2022-09-21 20:53:15 INFO  Executing generated plans
2022-09-21 20:56:39 INFO  ---RUNTIME: Execution took 204504.06098365784 ms
2022-09-21 20:56:39 INFO  Done!
2022-09-21 20:56:39 INFO  # Finished -- repetition 1 of 7 
2022-09-21 20:56:39 INFO  # Optimization benchmark for feature_importance with args [['reviews', 'fast_loading', 'featurization_3', 'neural_network']] -- repetition 2 of 7
2022-09-21 20:56:39 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-21 20:56:39 INFO  Running instrumented original pipeline...
2022-09-21 20:56:39 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-21 20:56:40 INFO  ---RUNTIME: Importing and monkey-patching took 6.31260871887207 ms
2022-09-21 20:57:37 INFO  ---RUNTIME: Original pipeline execution took 57761.274576187134 ms (excluding imports and monkey-patching)
2022-09-21 20:57:37 INFO  Starting execution of 1 what-if analyses...
2022-09-21 20:57:37 INFO  Start plan generation for analysis PermutationFeatureImportance...
2022-09-21 20:57:37 INFO  ---RUNTIME: Plan generation took 0.17404556274414062 ms
2022-09-21 20:57:37 INFO  Estimated runtime of original DAG is 42672.66058921814ms
2022-09-21 20:57:37 INFO  Performing Multi-Query Optimization
2022-09-21 20:57:37 INFO  Estimated unoptimized what-if runtime is 213363.3029460907ms
2022-09-21 20:57:37 INFO  Estimated optimised what-if runtime is 62447.98254966736ms
2022-09-21 20:57:37 INFO  Estimated optimisation runtime saving is 150915.32039642334ms
2022-09-21 20:57:37 INFO  ---RUNTIME: Multi-Query Optimization took 12.88461685180664 ms
2022-09-21 20:57:37 INFO  Executing generated plans
2022-09-21 20:58:28 INFO  ---RUNTIME: Execution took 50328.70173454285 ms
2022-09-21 20:58:28 INFO  Done!
2022-09-21 20:58:28 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-21 20:58:28 INFO  Running instrumented original pipeline...
2022-09-21 20:58:28 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-21 20:58:28 INFO  ---RUNTIME: Importing and monkey-patching took 6.162405014038086 ms
2022-09-21 20:59:45 INFO  ---RUNTIME: Original pipeline execution took 76878.09538841248 ms (excluding imports and monkey-patching)
2022-09-21 20:59:45 INFO  Starting execution of 1 what-if analyses...
2022-09-21 20:59:45 INFO  Start plan generation for analysis PermutationFeatureImportance...
2022-09-21 20:59:45 INFO  ---RUNTIME: Plan generation took 0.16570091247558594 ms
2022-09-21 20:59:45 INFO  Estimated runtime of original DAG is 65469.24042701721ms
2022-09-21 20:59:45 WARNING Skipping Multi-Query Optimization (instead, only applying patches)
2022-09-21 20:59:45 INFO  Estimated unoptimised what-if runtime is 327346.20213508606ms
2022-09-21 20:59:45 INFO  ---RUNTIME: Multi-Query Optimization took 6.575822830200195 ms
2022-09-21 20:59:45 INFO  Executing generated plans
2022-09-21 21:04:10 INFO  ---RUNTIME: Execution took 264920.0961589813 ms
2022-09-21 21:04:10 INFO  Done!
2022-09-21 21:04:12 INFO  # Finished -- repetition 2 of 7 
2022-09-21 21:04:12 INFO  # Optimization benchmark for feature_importance with args [['reviews', 'fast_loading', 'featurization_3', 'neural_network']] -- repetition 3 of 7
2022-09-21 21:04:12 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-21 21:04:12 INFO  Running instrumented original pipeline...
2022-09-21 21:04:12 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-21 21:04:12 INFO  ---RUNTIME: Importing and monkey-patching took 74.8600959777832 ms
2022-09-21 21:05:14 INFO  ---RUNTIME: Original pipeline execution took 62579.12278175354 ms (excluding imports and monkey-patching)
2022-09-21 21:05:14 INFO  Starting execution of 1 what-if analyses...
2022-09-21 21:05:14 INFO  Start plan generation for analysis PermutationFeatureImportance...
2022-09-21 21:05:14 INFO  ---RUNTIME: Plan generation took 0.15091896057128906 ms
2022-09-21 21:05:14 INFO  Estimated runtime of original DAG is 48257.062911987305ms
2022-09-21 21:05:14 INFO  Performing Multi-Query Optimization
2022-09-21 21:05:14 INFO  Estimated unoptimized what-if runtime is 241285.31455993652ms
2022-09-21 21:05:14 INFO  Estimated optimised what-if runtime is 69158.68377685547ms
2022-09-21 21:05:14 INFO  Estimated optimisation runtime saving is 172126.63078308105ms
2022-09-21 21:05:14 INFO  ---RUNTIME: Multi-Query Optimization took 13.056278228759766 ms
2022-09-21 21:05:14 INFO  Executing generated plans
2022-09-21 21:06:05 INFO  ---RUNTIME: Execution took 50645.28203010559 ms
2022-09-21 21:06:05 INFO  Done!
2022-09-21 21:06:07 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-21 21:06:07 INFO  Running instrumented original pipeline...
2022-09-21 21:06:07 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-21 21:06:07 INFO  ---RUNTIME: Importing and monkey-patching took 6.754398345947266 ms
2022-09-21 21:07:05 INFO  ---RUNTIME: Original pipeline execution took 57438.15016746521 ms (excluding imports and monkey-patching)
2022-09-21 21:07:05 INFO  Starting execution of 1 what-if analyses...
2022-09-21 21:07:05 INFO  Start plan generation for analysis PermutationFeatureImportance...
2022-09-21 21:07:05 INFO  ---RUNTIME: Plan generation took 0.15211105346679688 ms
2022-09-21 21:07:05 INFO  Estimated runtime of original DAG is 41405.526638031006ms
2022-09-21 21:07:05 WARNING Skipping Multi-Query Optimization (instead, only applying patches)
2022-09-21 21:07:05 INFO  Estimated unoptimised what-if runtime is 207027.63319015503ms
2022-09-21 21:07:05 INFO  ---RUNTIME: Multi-Query Optimization took 4.85539436340332 ms
2022-09-21 21:07:05 INFO  Executing generated plans
2022-09-21 21:10:45 INFO  ---RUNTIME: Execution took 219782.4010848999 ms
2022-09-21 21:10:45 INFO  Done!
2022-09-21 21:10:45 INFO  # Finished -- repetition 3 of 7 
2022-09-21 21:10:45 INFO  # Optimization benchmark for feature_importance with args [['reviews', 'fast_loading', 'featurization_3', 'neural_network']] -- repetition 4 of 7
2022-09-21 21:10:45 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-21 21:10:45 INFO  Running instrumented original pipeline...
2022-09-21 21:10:45 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-21 21:10:45 INFO  ---RUNTIME: Importing and monkey-patching took 6.927251815795898 ms
2022-09-21 21:11:37 INFO  ---RUNTIME: Original pipeline execution took 51223.838567733765 ms (excluding imports and monkey-patching)
2022-09-21 21:11:37 INFO  Starting execution of 1 what-if analyses...
2022-09-21 21:11:37 INFO  Start plan generation for analysis PermutationFeatureImportance...
2022-09-21 21:11:37 INFO  ---RUNTIME: Plan generation took 0.20456314086914062 ms
2022-09-21 21:11:37 INFO  Estimated runtime of original DAG is 40620.816707611084ms
2022-09-21 21:11:37 INFO  Performing Multi-Query Optimization
2022-09-21 21:11:37 INFO  Estimated unoptimized what-if runtime is 203104.08353805542ms
2022-09-21 21:11:37 INFO  Estimated optimised what-if runtime is 60210.05606651306ms
2022-09-21 21:11:37 INFO  Estimated optimisation runtime saving is 142894.02747154236ms
2022-09-21 21:11:37 INFO  ---RUNTIME: Multi-Query Optimization took 12.778043746948242 ms
2022-09-21 21:11:37 INFO  Executing generated plans
2022-09-21 21:12:16 INFO  ---RUNTIME: Execution took 39468.560218811035 ms
2022-09-21 21:12:16 INFO  Done!
2022-09-21 21:12:18 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-21 21:12:18 INFO  Running instrumented original pipeline...
2022-09-21 21:12:18 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-21 21:12:18 INFO  ---RUNTIME: Importing and monkey-patching took 6.22105598449707 ms
2022-09-21 21:13:07 INFO  ---RUNTIME: Original pipeline execution took 49403.56230735779 ms (excluding imports and monkey-patching)
2022-09-21 21:13:07 INFO  Starting execution of 1 what-if analyses...
2022-09-21 21:13:07 INFO  Start plan generation for analysis PermutationFeatureImportance...
2022-09-21 21:13:07 INFO  ---RUNTIME: Plan generation took 0.1437664031982422 ms
2022-09-21 21:13:07 INFO  Estimated runtime of original DAG is 41897.65501022339ms
2022-09-21 21:13:07 WARNING Skipping Multi-Query Optimization (instead, only applying patches)
2022-09-21 21:13:07 INFO  Estimated unoptimised what-if runtime is 209488.27505111694ms
2022-09-21 21:13:07 INFO  ---RUNTIME: Multi-Query Optimization took 4.770755767822266 ms
2022-09-21 21:13:07 INFO  Executing generated plans
2022-09-21 21:16:21 INFO  ---RUNTIME: Execution took 194048.54154586792 ms
2022-09-21 21:16:21 INFO  Done!
2022-09-21 21:16:24 INFO  # Finished -- repetition 4 of 7 
2022-09-21 21:16:24 INFO  # Optimization benchmark for feature_importance with args [['reviews', 'fast_loading', 'featurization_3', 'neural_network']] -- repetition 5 of 7
2022-09-21 21:16:24 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-21 21:16:24 INFO  Running instrumented original pipeline...
2022-09-21 21:16:24 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-21 21:16:24 INFO  ---RUNTIME: Importing and monkey-patching took 6.184101104736328 ms
2022-09-21 21:17:19 INFO  ---RUNTIME: Original pipeline execution took 54989.69650268555 ms (excluding imports and monkey-patching)
2022-09-21 21:17:19 INFO  Starting execution of 1 what-if analyses...
2022-09-21 21:17:19 INFO  Start plan generation for analysis PermutationFeatureImportance...
2022-09-21 21:17:19 INFO  ---RUNTIME: Plan generation took 0.15401840209960938 ms
2022-09-21 21:17:19 INFO  Estimated runtime of original DAG is 42536.213874816895ms
2022-09-21 21:17:19 INFO  Performing Multi-Query Optimization
2022-09-21 21:17:19 INFO  Estimated unoptimized what-if runtime is 212681.06937408447ms
2022-09-21 21:17:19 INFO  Estimated optimised what-if runtime is 63148.87356758118ms
2022-09-21 21:17:19 INFO  Estimated optimisation runtime saving is 149532.1958065033ms
2022-09-21 21:17:19 INFO  ---RUNTIME: Multi-Query Optimization took 12.768268585205078 ms
2022-09-21 21:17:19 INFO  Executing generated plans
2022-09-21 21:18:09 INFO  ---RUNTIME: Execution took 50001.190423965454 ms
2022-09-21 21:18:09 INFO  Done!
2022-09-21 21:18:10 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-21 21:18:10 INFO  Running instrumented original pipeline...
2022-09-21 21:18:10 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-21 21:18:10 INFO  ---RUNTIME: Importing and monkey-patching took 6.183862686157227 ms
2022-09-21 21:19:01 INFO  ---RUNTIME: Original pipeline execution took 51027.27246284485 ms (excluding imports and monkey-patching)
2022-09-21 21:19:01 INFO  Starting execution of 1 what-if analyses...
2022-09-21 21:19:01 INFO  Start plan generation for analysis PermutationFeatureImportance...
2022-09-21 21:19:01 INFO  ---RUNTIME: Plan generation took 0.1456737518310547 ms
2022-09-21 21:19:01 INFO  Estimated runtime of original DAG is 41539.20650482178ms
2022-09-21 21:19:01 WARNING Skipping Multi-Query Optimization (instead, only applying patches)
2022-09-21 21:19:01 INFO  Estimated unoptimised what-if runtime is 207696.0325241089ms
2022-09-21 21:19:01 INFO  ---RUNTIME: Multi-Query Optimization took 4.876613616943359 ms
2022-09-21 21:19:01 INFO  Executing generated plans
2022-09-21 21:22:39 INFO  ---RUNTIME: Execution took 218155.2677154541 ms
2022-09-21 21:22:39 INFO  Done!
2022-09-21 21:22:39 INFO  # Finished -- repetition 5 of 7 
2022-09-21 21:22:39 INFO  # Optimization benchmark for feature_importance with args [['reviews', 'fast_loading', 'featurization_3', 'neural_network']] -- repetition 6 of 7
2022-09-21 21:22:39 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-21 21:22:39 INFO  Running instrumented original pipeline...
2022-09-21 21:22:39 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-21 21:22:39 INFO  ---RUNTIME: Importing and monkey-patching took 6.1931610107421875 ms
2022-09-21 21:23:28 INFO  ---RUNTIME: Original pipeline execution took 48927.74224281311 ms (excluding imports and monkey-patching)
2022-09-21 21:23:28 INFO  Starting execution of 1 what-if analyses...
2022-09-21 21:23:28 INFO  Start plan generation for analysis PermutationFeatureImportance...
2022-09-21 21:23:28 INFO  ---RUNTIME: Plan generation took 0.15401840209960938 ms
2022-09-21 21:23:28 INFO  Estimated runtime of original DAG is 41184.90481376648ms
2022-09-21 21:23:28 INFO  Performing Multi-Query Optimization
2022-09-21 21:23:28 INFO  Estimated unoptimized what-if runtime is 205924.5240688324ms
2022-09-21 21:23:28 INFO  Estimated optimised what-if runtime is 60880.887031555176ms
2022-09-21 21:23:28 INFO  Estimated optimisation runtime saving is 145043.63703727722ms
2022-09-21 21:23:28 INFO  ---RUNTIME: Multi-Query Optimization took 12.450933456420898 ms
2022-09-21 21:23:28 INFO  Executing generated plans
2022-09-21 21:24:17 INFO  ---RUNTIME: Execution took 48411.670446395874 ms
2022-09-21 21:24:17 INFO  Done!
2022-09-21 21:24:18 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-21 21:24:18 INFO  Running instrumented original pipeline...
2022-09-21 21:24:18 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-21 21:24:18 INFO  ---RUNTIME: Importing and monkey-patching took 5.647182464599609 ms
2022-09-21 21:25:11 INFO  ---RUNTIME: Original pipeline execution took 52958.67729187012 ms (excluding imports and monkey-patching)
2022-09-21 21:25:11 INFO  Starting execution of 1 what-if analyses...
2022-09-21 21:25:11 INFO  Start plan generation for analysis PermutationFeatureImportance...
2022-09-21 21:25:11 INFO  ---RUNTIME: Plan generation took 0.1430511474609375 ms
2022-09-21 21:25:11 INFO  Estimated runtime of original DAG is 40413.40947151184ms
2022-09-21 21:25:11 WARNING Skipping Multi-Query Optimization (instead, only applying patches)
2022-09-21 21:25:11 INFO  Estimated unoptimised what-if runtime is 202067.0473575592ms
2022-09-21 21:25:11 INFO  ---RUNTIME: Multi-Query Optimization took 4.889011383056641 ms
2022-09-21 21:25:11 INFO  Executing generated plans
2022-09-21 21:29:07 INFO  ---RUNTIME: Execution took 235697.24225997925 ms
2022-09-21 21:29:07 INFO  Done!
2022-09-21 21:29:08 INFO  # Finished -- repetition 6 of 7 
2022-09-21 21:29:08 INFO  # Optimization benchmark for feature_importance with args [['reviews', 'fast_loading', 'featurization_3', 'neural_network']] -- repetition 7 of 7
2022-09-21 21:29:08 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-21 21:29:08 INFO  Running instrumented original pipeline...
2022-09-21 21:29:08 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-21 21:29:08 INFO  ---RUNTIME: Importing and monkey-patching took 6.215333938598633 ms
2022-09-21 21:30:06 INFO  ---RUNTIME: Original pipeline execution took 58533.347845077515 ms (excluding imports and monkey-patching)
2022-09-21 21:30:06 INFO  Starting execution of 1 what-if analyses...
2022-09-21 21:30:06 INFO  Start plan generation for analysis PermutationFeatureImportance...
2022-09-21 21:30:06 INFO  ---RUNTIME: Plan generation took 0.14972686767578125 ms
2022-09-21 21:30:06 INFO  Estimated runtime of original DAG is 48930.39917945862ms
2022-09-21 21:30:06 INFO  Performing Multi-Query Optimization
2022-09-21 21:30:06 INFO  Estimated unoptimized what-if runtime is 244651.9958972931ms
2022-09-21 21:30:06 INFO  Estimated optimised what-if runtime is 73020.97725868225ms
2022-09-21 21:30:06 INFO  Estimated optimisation runtime saving is 171631.01863861084ms
2022-09-21 21:30:06 INFO  ---RUNTIME: Multi-Query Optimization took 12.685060501098633 ms
2022-09-21 21:30:06 INFO  Executing generated plans
2022-09-21 21:31:03 INFO  ---RUNTIME: Execution took 56474.90692138672 ms
2022-09-21 21:31:03 INFO  Done!
2022-09-21 21:31:03 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-21 21:31:03 INFO  Running instrumented original pipeline...
2022-09-21 21:31:04 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-21 21:31:04 INFO  ---RUNTIME: Importing and monkey-patching took 8.720874786376953 ms
2022-09-21 21:32:02 INFO  ---RUNTIME: Original pipeline execution took 59000.75340270996 ms (excluding imports and monkey-patching)
2022-09-21 21:32:02 INFO  Starting execution of 1 what-if analyses...
2022-09-21 21:32:02 INFO  Start plan generation for analysis PermutationFeatureImportance...
2022-09-21 21:32:02 INFO  ---RUNTIME: Plan generation took 0.3428459167480469 ms
2022-09-21 21:32:02 INFO  Estimated runtime of original DAG is 50268.500566482544ms
2022-09-21 21:32:02 WARNING Skipping Multi-Query Optimization (instead, only applying patches)
2022-09-21 21:32:02 INFO  Estimated unoptimised what-if runtime is 251342.50283241272ms
2022-09-21 21:32:02 INFO  ---RUNTIME: Multi-Query Optimization took 13.704299926757812 ms
2022-09-21 21:32:02 INFO  Executing generated plans
2022-09-21 21:36:25 INFO  ---RUNTIME: Execution took 262984.07793045044 ms
2022-09-21 21:36:25 INFO  Done!
2022-09-21 21:36:27 INFO  # Finished -- repetition 7 of 7 
2022-09-21 21:36:27 INFO  # Final results after all repetitions
2022-09-21 21:36:27 INFO     repetition  ... no_opt_what_if_execution_combined_model_training
0           0  ...                                     30688.422203
1           1  ...                                     36306.326151
2           2  ...                                     32536.659241
3           3  ...                                     30548.953533
4           4  ...                                     30369.171143
5           5  ...                                     37884.567738
6           6  ...                                     38695.022345

[7 rows x 26 columns]
taskset -c 32-39 PROTOCOL_BUFFERS_PYTHON_IMPLEMENTATION=python python3.9 benchmarks_end_to_end.py feature_importance reviews fast_loading featurization_4 logistic_regression
2022-09-21 21:36:32.353146: W tensorflow/stream_executor/platform/default/dso_loader.cc:64] Could not load dynamic library 'libcudart.so.11.0'; dlerror: libcudart.so.11.0: cannot open shared object file: No such file or directory; LD_LIBRARY_PATH: /home/sgrafbe/mlwhatif/venv/lib/python3.9/site-packages/cv2/../../lib64:
2022-09-21 21:36:32.353189: I tensorflow/stream_executor/cuda/cudart_stub.cc:29] Ignore above cudart dlerror if you do not have a GPU set up on your machine.
2022-09-21 21:36:33 INFO  Patching sys.argv with ['mlwhatif', 'reviews', 'fast_loading', 'featurization_4', 'logistic_regression']
2022-09-21 21:36:33 INFO  Running instrumented original pipeline...
2022-09-21 21:36:33 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-21 21:36:33 INFO  ---RUNTIME: Importing and monkey-patching took 123.90518188476562 ms
2022-09-21 21:36:47 INFO  ---RUNTIME: Original pipeline execution took 14129.927158355713 ms (excluding imports and monkey-patching)
2022-09-21 21:36:47 INFO  Starting execution of 0 what-if analyses...
2022-09-21 21:36:47 INFO  Estimated runtime of original DAG is 10573.009014129639ms
2022-09-21 21:36:47 INFO  Performing Multi-Query Optimization
2022-09-21 21:36:47 INFO  Estimated unoptimized what-if runtime is 0ms
2022-09-21 21:36:47 INFO  Estimated optimised what-if runtime is 0ms
2022-09-21 21:36:47 INFO  Estimated optimisation runtime saving is 0ms
2022-09-21 21:36:47 INFO  ---RUNTIME: Multi-Query Optimization took 0.5426406860351562 ms
2022-09-21 21:36:47 INFO  Executing generated plans
2022-09-21 21:36:47 INFO  ---RUNTIME: Execution took 0.024557113647460938 ms
2022-09-21 21:36:47 INFO  Done!
2022-09-21 21:36:47 INFO  # Optimization benchmark for feature_importance with args [['reviews', 'fast_loading', 'featurization_4', 'logistic_regression']] -- repetition 1 of 7
2022-09-21 21:36:47 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-21 21:36:47 INFO  Running instrumented original pipeline...
2022-09-21 21:36:47 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-21 21:36:47 INFO  ---RUNTIME: Importing and monkey-patching took 5.552053451538086 ms
2022-09-21 21:37:02 INFO  ---RUNTIME: Original pipeline execution took 14650.548458099365 ms (excluding imports and monkey-patching)
2022-09-21 21:37:02 INFO  Starting execution of 1 what-if analyses...
2022-09-21 21:37:02 INFO  Start plan generation for analysis PermutationFeatureImportance...
2022-09-21 21:37:02 INFO  ---RUNTIME: Plan generation took 0.225067138671875 ms
2022-09-21 21:37:02 INFO  Estimated runtime of original DAG is 10630.711317062378ms
2022-09-21 21:37:02 INFO  Performing Multi-Query Optimization
2022-09-21 21:37:02 INFO  Estimated unoptimized what-if runtime is 53153.55658531189ms
2022-09-21 21:37:02 INFO  Estimated optimised what-if runtime is 10898.954629898071ms
2022-09-21 21:37:02 INFO  Estimated optimisation runtime saving is 42254.60195541382ms
2022-09-21 21:37:02 INFO  ---RUNTIME: Multi-Query Optimization took 11.133909225463867 ms
2022-09-21 21:37:02 INFO  Executing generated plans
2022-09-21 21:37:14 INFO  ---RUNTIME: Execution took 12343.839406967163 ms
2022-09-21 21:37:14 INFO  Done!
2022-09-21 21:37:14 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-21 21:37:14 INFO  Running instrumented original pipeline...
2022-09-21 21:37:15 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-21 21:37:15 INFO  ---RUNTIME: Importing and monkey-patching took 5.846261978149414 ms
2022-09-21 21:37:29 INFO  ---RUNTIME: Original pipeline execution took 14275.971412658691 ms (excluding imports and monkey-patching)
2022-09-21 21:37:29 INFO  Starting execution of 1 what-if analyses...
2022-09-21 21:37:29 INFO  Start plan generation for analysis PermutationFeatureImportance...
2022-09-21 21:37:29 INFO  ---RUNTIME: Plan generation took 0.09632110595703125 ms
2022-09-21 21:37:29 INFO  Estimated runtime of original DAG is 10448.61888885498ms
2022-09-21 21:37:29 WARNING Skipping Multi-Query Optimization (instead, only applying patches)
2022-09-21 21:37:29 INFO  Estimated unoptimised what-if runtime is 52243.0944442749ms
2022-09-21 21:37:29 INFO  ---RUNTIME: Multi-Query Optimization took 4.35948371887207 ms
2022-09-21 21:37:29 INFO  Executing generated plans
2022-09-21 21:38:25 INFO  ---RUNTIME: Execution took 55870.986461639404 ms
2022-09-21 21:38:25 INFO  Done!
2022-09-21 21:38:25 INFO  # Finished -- repetition 1 of 7 
2022-09-21 21:38:25 INFO  # Optimization benchmark for feature_importance with args [['reviews', 'fast_loading', 'featurization_4', 'logistic_regression']] -- repetition 2 of 7
2022-09-21 21:38:25 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-21 21:38:25 INFO  Running instrumented original pipeline...
2022-09-21 21:38:25 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-21 21:38:25 INFO  ---RUNTIME: Importing and monkey-patching took 6.345987319946289 ms
2022-09-21 21:38:38 INFO  ---RUNTIME: Original pipeline execution took 13372.802734375 ms (excluding imports and monkey-patching)
2022-09-21 21:38:38 INFO  Starting execution of 1 what-if analyses...
2022-09-21 21:38:38 INFO  Start plan generation for analysis PermutationFeatureImportance...
2022-09-21 21:38:38 INFO  ---RUNTIME: Plan generation took 0.18262863159179688 ms
2022-09-21 21:38:38 INFO  Estimated runtime of original DAG is 9781.367063522339ms
2022-09-21 21:38:38 INFO  Performing Multi-Query Optimization
2022-09-21 21:38:38 INFO  Estimated unoptimized what-if runtime is 48906.835317611694ms
2022-09-21 21:38:38 INFO  Estimated optimised what-if runtime is 10211.497068405151ms
2022-09-21 21:38:38 INFO  Estimated optimisation runtime saving is 38695.33824920654ms
2022-09-21 21:38:38 INFO  ---RUNTIME: Multi-Query Optimization took 22.681236267089844 ms
2022-09-21 21:38:38 INFO  Executing generated plans
2022-09-21 21:38:55 INFO  ---RUNTIME: Execution took 17327.991008758545 ms
2022-09-21 21:38:55 INFO  Done!
2022-09-21 21:38:55 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-21 21:38:55 INFO  Running instrumented original pipeline...
2022-09-21 21:38:55 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-21 21:38:55 INFO  ---RUNTIME: Importing and monkey-patching took 10.042905807495117 ms
2022-09-21 21:39:11 INFO  ---RUNTIME: Original pipeline execution took 16037.673711776733 ms (excluding imports and monkey-patching)
2022-09-21 21:39:11 INFO  Starting execution of 1 what-if analyses...
2022-09-21 21:39:11 INFO  Start plan generation for analysis PermutationFeatureImportance...
2022-09-21 21:39:11 INFO  ---RUNTIME: Plan generation took 0.12111663818359375 ms
2022-09-21 21:39:11 INFO  Estimated runtime of original DAG is 12094.338655471802ms
2022-09-21 21:39:11 WARNING Skipping Multi-Query Optimization (instead, only applying patches)
2022-09-21 21:39:11 INFO  Estimated unoptimised what-if runtime is 60471.69327735901ms
2022-09-21 21:39:11 INFO  ---RUNTIME: Multi-Query Optimization took 4.3163299560546875 ms
2022-09-21 21:39:11 INFO  Executing generated plans
2022-09-21 21:40:09 INFO  ---RUNTIME: Execution took 57591.94111824036 ms
2022-09-21 21:40:09 INFO  Done!
2022-09-21 21:40:09 INFO  # Finished -- repetition 2 of 7 
2022-09-21 21:40:09 INFO  # Optimization benchmark for feature_importance with args [['reviews', 'fast_loading', 'featurization_4', 'logistic_regression']] -- repetition 3 of 7
2022-09-21 21:40:09 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-21 21:40:09 INFO  Running instrumented original pipeline...
2022-09-21 21:40:09 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-21 21:40:09 INFO  ---RUNTIME: Importing and monkey-patching took 6.134271621704102 ms
2022-09-21 21:40:23 INFO  ---RUNTIME: Original pipeline execution took 14340.324878692627 ms (excluding imports and monkey-patching)
2022-09-21 21:40:23 INFO  Starting execution of 1 what-if analyses...
2022-09-21 21:40:23 INFO  Start plan generation for analysis PermutationFeatureImportance...
2022-09-21 21:40:23 INFO  ---RUNTIME: Plan generation took 0.09870529174804688 ms
2022-09-21 21:40:23 INFO  Estimated runtime of original DAG is 11013.402223587036ms
2022-09-21 21:40:23 INFO  Performing Multi-Query Optimization
2022-09-21 21:40:23 INFO  Estimated unoptimized what-if runtime is 55067.01111793518ms
2022-09-21 21:40:23 INFO  Estimated optimised what-if runtime is 11233.06655883789ms
2022-09-21 21:40:23 INFO  Estimated optimisation runtime saving is 43833.94455909729ms
2022-09-21 21:40:23 INFO  ---RUNTIME: Multi-Query Optimization took 10.771989822387695 ms
2022-09-21 21:40:23 INFO  Executing generated plans
2022-09-21 21:40:35 INFO  ---RUNTIME: Execution took 11768.957376480103 ms
2022-09-21 21:40:35 INFO  Done!
2022-09-21 21:40:35 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-21 21:40:35 INFO  Running instrumented original pipeline...
2022-09-21 21:40:35 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-21 21:40:35 INFO  ---RUNTIME: Importing and monkey-patching took 5.664587020874023 ms
2022-09-21 21:40:50 INFO  ---RUNTIME: Original pipeline execution took 14838.653087615967 ms (excluding imports and monkey-patching)
2022-09-21 21:40:50 INFO  Starting execution of 1 what-if analyses...
2022-09-21 21:40:50 INFO  Start plan generation for analysis PermutationFeatureImportance...
2022-09-21 21:40:50 INFO  ---RUNTIME: Plan generation took 0.12183189392089844 ms
2022-09-21 21:40:50 INFO  Estimated runtime of original DAG is 10260.704040527344ms
2022-09-21 21:40:50 WARNING Skipping Multi-Query Optimization (instead, only applying patches)
2022-09-21 21:40:50 INFO  Estimated unoptimised what-if runtime is 51303.52020263672ms
2022-09-21 21:40:50 INFO  ---RUNTIME: Multi-Query Optimization took 4.257917404174805 ms
2022-09-21 21:40:50 INFO  Executing generated plans
2022-09-21 21:41:45 INFO  ---RUNTIME: Execution took 54527.13418006897 ms
2022-09-21 21:41:45 INFO  Done!
2022-09-21 21:41:45 INFO  # Finished -- repetition 3 of 7 
2022-09-21 21:41:45 INFO  # Optimization benchmark for feature_importance with args [['reviews', 'fast_loading', 'featurization_4', 'logistic_regression']] -- repetition 4 of 7
2022-09-21 21:41:45 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-21 21:41:45 INFO  Running instrumented original pipeline...
2022-09-21 21:41:45 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-21 21:41:45 INFO  ---RUNTIME: Importing and monkey-patching took 6.134271621704102 ms
2022-09-21 21:42:04 INFO  ---RUNTIME: Original pipeline execution took 19037.285804748535 ms (excluding imports and monkey-patching)
2022-09-21 21:42:04 INFO  Starting execution of 1 what-if analyses...
2022-09-21 21:42:04 INFO  Start plan generation for analysis PermutationFeatureImportance...
2022-09-21 21:42:04 INFO  ---RUNTIME: Plan generation took 0.2951622009277344 ms
2022-09-21 21:42:04 INFO  Estimated runtime of original DAG is 13398.299217224121ms
2022-09-21 21:42:04 INFO  Performing Multi-Query Optimization
2022-09-21 21:42:04 INFO  Estimated unoptimized what-if runtime is 66991.4960861206ms
2022-09-21 21:42:04 INFO  Estimated optimised what-if runtime is 13869.732856750488ms
2022-09-21 21:42:04 INFO  Estimated optimisation runtime saving is 53121.76322937012ms
2022-09-21 21:42:04 INFO  ---RUNTIME: Multi-Query Optimization took 21.5909481048584 ms
2022-09-21 21:42:04 INFO  Executing generated plans
2022-09-21 21:42:18 INFO  ---RUNTIME: Execution took 14110.836267471313 ms
2022-09-21 21:42:18 INFO  Done!
2022-09-21 21:42:18 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-21 21:42:18 INFO  Running instrumented original pipeline...
2022-09-21 21:42:18 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-21 21:42:18 INFO  ---RUNTIME: Importing and monkey-patching took 5.668401718139648 ms
2022-09-21 21:42:32 INFO  ---RUNTIME: Original pipeline execution took 14286.595582962036 ms (excluding imports and monkey-patching)
2022-09-21 21:42:32 INFO  Starting execution of 1 what-if analyses...
2022-09-21 21:42:32 INFO  Start plan generation for analysis PermutationFeatureImportance...
2022-09-21 21:42:32 INFO  ---RUNTIME: Plan generation took 0.09703636169433594 ms
2022-09-21 21:42:32 INFO  Estimated runtime of original DAG is 10357.991218566895ms
2022-09-21 21:42:32 WARNING Skipping Multi-Query Optimization (instead, only applying patches)
2022-09-21 21:42:32 INFO  Estimated unoptimised what-if runtime is 51789.95609283447ms
2022-09-21 21:42:32 INFO  ---RUNTIME: Multi-Query Optimization took 4.220008850097656 ms
2022-09-21 21:42:32 INFO  Executing generated plans
2022-09-21 21:43:29 INFO  ---RUNTIME: Execution took 56868.504762649536 ms
2022-09-21 21:43:29 INFO  Done!
2022-09-21 21:43:29 INFO  # Finished -- repetition 4 of 7 
2022-09-21 21:43:29 INFO  # Optimization benchmark for feature_importance with args [['reviews', 'fast_loading', 'featurization_4', 'logistic_regression']] -- repetition 5 of 7
2022-09-21 21:43:29 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-21 21:43:29 INFO  Running instrumented original pipeline...
2022-09-21 21:43:29 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-21 21:43:29 INFO  ---RUNTIME: Importing and monkey-patching took 6.1817169189453125 ms
2022-09-21 21:43:43 INFO  ---RUNTIME: Original pipeline execution took 14163.167715072632 ms (excluding imports and monkey-patching)
2022-09-21 21:43:43 INFO  Starting execution of 1 what-if analyses...
2022-09-21 21:43:43 INFO  Start plan generation for analysis PermutationFeatureImportance...
2022-09-21 21:43:43 INFO  ---RUNTIME: Plan generation took 0.10538101196289062 ms
2022-09-21 21:43:43 INFO  Estimated runtime of original DAG is 10811.12027168274ms
2022-09-21 21:43:43 INFO  Performing Multi-Query Optimization
2022-09-21 21:43:43 INFO  Estimated unoptimized what-if runtime is 54055.601358413696ms
2022-09-21 21:43:43 INFO  Estimated optimised what-if runtime is 11022.318840026855ms
2022-09-21 21:43:43 INFO  Estimated optimisation runtime saving is 43033.28251838684ms
2022-09-21 21:43:43 INFO  ---RUNTIME: Multi-Query Optimization took 10.872840881347656 ms
2022-09-21 21:43:43 INFO  Executing generated plans
2022-09-21 21:43:55 INFO  ---RUNTIME: Execution took 11563.406229019165 ms
2022-09-21 21:43:55 INFO  Done!
2022-09-21 21:43:55 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-21 21:43:55 INFO  Running instrumented original pipeline...
2022-09-21 21:43:55 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-21 21:43:55 INFO  ---RUNTIME: Importing and monkey-patching took 8.403301239013672 ms
2022-09-21 21:44:09 INFO  ---RUNTIME: Original pipeline execution took 14601.470947265625 ms (excluding imports and monkey-patching)
2022-09-21 21:44:09 INFO  Starting execution of 1 what-if analyses...
2022-09-21 21:44:09 INFO  Start plan generation for analysis PermutationFeatureImportance...
2022-09-21 21:44:09 INFO  ---RUNTIME: Plan generation took 0.19621849060058594 ms
2022-09-21 21:44:09 INFO  Estimated runtime of original DAG is 10519.373178482056ms
2022-09-21 21:44:09 WARNING Skipping Multi-Query Optimization (instead, only applying patches)
2022-09-21 21:44:09 INFO  Estimated unoptimised what-if runtime is 52596.86589241028ms
2022-09-21 21:44:09 INFO  ---RUNTIME: Multi-Query Optimization took 7.080793380737305 ms
2022-09-21 21:44:09 INFO  Executing generated plans
2022-09-21 21:45:07 INFO  ---RUNTIME: Execution took 57445.958852767944 ms
2022-09-21 21:45:07 INFO  Done!
2022-09-21 21:45:07 INFO  # Finished -- repetition 5 of 7 
2022-09-21 21:45:07 INFO  # Optimization benchmark for feature_importance with args [['reviews', 'fast_loading', 'featurization_4', 'logistic_regression']] -- repetition 6 of 7
2022-09-21 21:45:07 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-21 21:45:07 INFO  Running instrumented original pipeline...
2022-09-21 21:45:07 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-21 21:45:07 INFO  ---RUNTIME: Importing and monkey-patching took 6.707191467285156 ms
2022-09-21 21:45:25 INFO  ---RUNTIME: Original pipeline execution took 18714.144468307495 ms (excluding imports and monkey-patching)
2022-09-21 21:45:26 INFO  Starting execution of 1 what-if analyses...
2022-09-21 21:45:26 INFO  Start plan generation for analysis PermutationFeatureImportance...
2022-09-21 21:45:26 INFO  ---RUNTIME: Plan generation took 0.12254714965820312 ms
2022-09-21 21:45:26 INFO  Estimated runtime of original DAG is 14302.161455154419ms
2022-09-21 21:45:26 INFO  Performing Multi-Query Optimization
2022-09-21 21:45:26 INFO  Estimated unoptimized what-if runtime is 71510.8072757721ms
2022-09-21 21:45:26 INFO  Estimated optimised what-if runtime is 14549.616813659668ms
2022-09-21 21:45:26 INFO  Estimated optimisation runtime saving is 56961.19046211243ms
2022-09-21 21:45:26 INFO  ---RUNTIME: Multi-Query Optimization took 11.038064956665039 ms
2022-09-21 21:45:26 INFO  Executing generated plans
2022-09-21 21:45:37 INFO  ---RUNTIME: Execution took 11573.572635650635 ms
2022-09-21 21:45:37 INFO  Done!
2022-09-21 21:45:37 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-21 21:45:37 INFO  Running instrumented original pipeline...
2022-09-21 21:45:37 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-21 21:45:37 INFO  ---RUNTIME: Importing and monkey-patching took 9.16600227355957 ms
2022-09-21 21:45:51 INFO  ---RUNTIME: Original pipeline execution took 13840.842485427856 ms (excluding imports and monkey-patching)
2022-09-21 21:45:51 INFO  Starting execution of 1 what-if analyses...
2022-09-21 21:45:51 INFO  Start plan generation for analysis PermutationFeatureImportance...
2022-09-21 21:45:51 INFO  ---RUNTIME: Plan generation took 0.15544891357421875 ms
2022-09-21 21:45:51 INFO  Estimated runtime of original DAG is 9812.489986419678ms
2022-09-21 21:45:51 WARNING Skipping Multi-Query Optimization (instead, only applying patches)
2022-09-21 21:45:51 INFO  Estimated unoptimised what-if runtime is 49062.44993209839ms
2022-09-21 21:45:51 INFO  ---RUNTIME: Multi-Query Optimization took 7.505178451538086 ms
2022-09-21 21:45:51 INFO  Executing generated plans
2022-09-21 21:46:46 INFO  ---RUNTIME: Execution took 55473.69146347046 ms
2022-09-21 21:46:46 INFO  Done!
2022-09-21 21:46:46 INFO  # Finished -- repetition 6 of 7 
2022-09-21 21:46:46 INFO  # Optimization benchmark for feature_importance with args [['reviews', 'fast_loading', 'featurization_4', 'logistic_regression']] -- repetition 7 of 7
2022-09-21 21:46:46 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-21 21:46:46 INFO  Running instrumented original pipeline...
2022-09-21 21:46:46 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-21 21:46:46 INFO  ---RUNTIME: Importing and monkey-patching took 6.455898284912109 ms
2022-09-21 21:47:01 INFO  ---RUNTIME: Original pipeline execution took 14509.888410568237 ms (excluding imports and monkey-patching)
2022-09-21 21:47:01 INFO  Starting execution of 1 what-if analyses...
2022-09-21 21:47:01 INFO  Start plan generation for analysis PermutationFeatureImportance...
2022-09-21 21:47:01 INFO  ---RUNTIME: Plan generation took 0.11801719665527344 ms
2022-09-21 21:47:01 INFO  Estimated runtime of original DAG is 9376.354932785034ms
2022-09-21 21:47:01 INFO  Performing Multi-Query Optimization
2022-09-21 21:47:01 INFO  Estimated unoptimized what-if runtime is 46881.77466392517ms
2022-09-21 21:47:01 INFO  Estimated optimised what-if runtime is 9588.295459747314ms
2022-09-21 21:47:01 INFO  Estimated optimisation runtime saving is 37293.47920417786ms
2022-09-21 21:47:01 INFO  ---RUNTIME: Multi-Query Optimization took 10.933637619018555 ms
2022-09-21 21:47:01 INFO  Executing generated plans
2022-09-21 21:47:11 INFO  ---RUNTIME: Execution took 10436.019897460938 ms
2022-09-21 21:47:11 INFO  Done!
2022-09-21 21:47:11 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-21 21:47:11 INFO  Running instrumented original pipeline...
2022-09-21 21:47:11 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-21 21:47:11 INFO  ---RUNTIME: Importing and monkey-patching took 5.785226821899414 ms
2022-09-21 21:47:26 INFO  ---RUNTIME: Original pipeline execution took 14898.032426834106 ms (excluding imports and monkey-patching)
2022-09-21 21:47:26 INFO  Starting execution of 1 what-if analyses...
2022-09-21 21:47:26 INFO  Start plan generation for analysis PermutationFeatureImportance...
2022-09-21 21:47:26 INFO  ---RUNTIME: Plan generation took 0.09965896606445312 ms
2022-09-21 21:47:26 INFO  Estimated runtime of original DAG is 10568.104267120361ms
2022-09-21 21:47:26 WARNING Skipping Multi-Query Optimization (instead, only applying patches)
2022-09-21 21:47:26 INFO  Estimated unoptimised what-if runtime is 52840.52133560181ms
2022-09-21 21:47:26 INFO  ---RUNTIME: Multi-Query Optimization took 4.219770431518555 ms
2022-09-21 21:47:26 INFO  Executing generated plans
2022-09-21 21:48:23 INFO  ---RUNTIME: Execution took 56790.844440460205 ms
2022-09-21 21:48:23 INFO  Done!
2022-09-21 21:48:23 INFO  # Finished -- repetition 7 of 7 
2022-09-21 21:48:23 INFO  # Final results after all repetitions
2022-09-21 21:48:23 INFO     repetition  ... no_opt_what_if_execution_combined_model_training
0           0  ...                                       981.545448
1           1  ...                                      1016.393423
2           2  ...                                      1008.350611
3           3  ...                                       919.427633
4           4  ...                                       933.914423
5           5  ...                                       879.157543
6           6  ...                                       986.187220

[7 rows x 26 columns]
taskset -c 32-39 PROTOCOL_BUFFERS_PYTHON_IMPLEMENTATION=python python3.9 benchmarks_end_to_end.py feature_importance reviews fast_loading featurization_4 xgboost
2022-09-21 21:48:27.857960: W tensorflow/stream_executor/platform/default/dso_loader.cc:64] Could not load dynamic library 'libcudart.so.11.0'; dlerror: libcudart.so.11.0: cannot open shared object file: No such file or directory; LD_LIBRARY_PATH: /home/sgrafbe/mlwhatif/venv/lib/python3.9/site-packages/cv2/../../lib64:
2022-09-21 21:48:27.858017: I tensorflow/stream_executor/cuda/cudart_stub.cc:29] Ignore above cudart dlerror if you do not have a GPU set up on your machine.
2022-09-21 21:48:30 INFO  Patching sys.argv with ['mlwhatif', 'reviews', 'fast_loading', 'featurization_4', 'xgboost']
2022-09-21 21:48:30 INFO  Running instrumented original pipeline...
2022-09-21 21:48:30 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-21 21:48:30 INFO  ---RUNTIME: Importing and monkey-patching took 227.5826930999756 ms
2022-09-21 21:48:51 INFO  ---RUNTIME: Original pipeline execution took 20966.50218963623 ms (excluding imports and monkey-patching)
2022-09-21 21:48:51 INFO  Starting execution of 0 what-if analyses...
2022-09-21 21:48:51 INFO  Estimated runtime of original DAG is 16953.845024108887ms
2022-09-21 21:48:51 INFO  Performing Multi-Query Optimization
2022-09-21 21:48:51 INFO  Estimated unoptimized what-if runtime is 0ms
2022-09-21 21:48:51 INFO  Estimated optimised what-if runtime is 0ms
2022-09-21 21:48:51 INFO  Estimated optimisation runtime saving is 0ms
2022-09-21 21:48:51 INFO  ---RUNTIME: Multi-Query Optimization took 0.5347728729248047 ms
2022-09-21 21:48:51 INFO  Executing generated plans
2022-09-21 21:48:51 INFO  ---RUNTIME: Execution took 0.027894973754882812 ms
2022-09-21 21:48:51 INFO  Done!
2022-09-21 21:48:51 INFO  # Optimization benchmark for feature_importance with args [['reviews', 'fast_loading', 'featurization_4', 'xgboost']] -- repetition 1 of 7
2022-09-21 21:48:51 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-21 21:48:51 INFO  Running instrumented original pipeline...
2022-09-21 21:48:51 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-21 21:48:51 INFO  ---RUNTIME: Importing and monkey-patching took 5.3730010986328125 ms
2022-09-21 21:49:09 INFO  ---RUNTIME: Original pipeline execution took 17572.64232635498 ms (excluding imports and monkey-patching)
2022-09-21 21:49:09 INFO  Starting execution of 1 what-if analyses...
2022-09-21 21:49:09 INFO  Start plan generation for analysis PermutationFeatureImportance...
2022-09-21 21:49:09 INFO  ---RUNTIME: Plan generation took 0.18262863159179688 ms
2022-09-21 21:49:09 INFO  Estimated runtime of original DAG is 14127.196311950684ms
2022-09-21 21:49:09 INFO  Performing Multi-Query Optimization
2022-09-21 21:49:09 INFO  Estimated unoptimized what-if runtime is 70635.98155975342ms
2022-09-21 21:49:09 INFO  Estimated optimised what-if runtime is 14509.685754776001ms
2022-09-21 21:49:09 INFO  Estimated optimisation runtime saving is 56126.29580497742ms
2022-09-21 21:49:09 INFO  ---RUNTIME: Multi-Query Optimization took 10.679960250854492 ms
2022-09-21 21:49:09 INFO  Executing generated plans
2022-09-21 21:49:24 INFO  ---RUNTIME: Execution took 15711.910247802734 ms
2022-09-21 21:49:24 INFO  Done!
2022-09-21 21:49:24 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-21 21:49:24 INFO  Running instrumented original pipeline...
2022-09-21 21:49:24 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-21 21:49:24 INFO  ---RUNTIME: Importing and monkey-patching took 6.100177764892578 ms
2022-09-21 21:49:42 INFO  ---RUNTIME: Original pipeline execution took 18015.14983177185 ms (excluding imports and monkey-patching)
2022-09-21 21:49:42 INFO  Starting execution of 1 what-if analyses...
2022-09-21 21:49:42 INFO  Start plan generation for analysis PermutationFeatureImportance...
2022-09-21 21:49:42 INFO  ---RUNTIME: Plan generation took 0.1323223114013672 ms
2022-09-21 21:49:42 INFO  Estimated runtime of original DAG is 14285.540342330933ms
2022-09-21 21:49:42 WARNING Skipping Multi-Query Optimization (instead, only applying patches)
2022-09-21 21:49:42 INFO  Estimated unoptimised what-if runtime is 71427.70171165466ms
2022-09-21 21:49:42 INFO  ---RUNTIME: Multi-Query Optimization took 4.993200302124023 ms
2022-09-21 21:49:42 INFO  Executing generated plans
2022-09-21 21:50:59 INFO  ---RUNTIME: Execution took 76891.03245735168 ms
2022-09-21 21:50:59 INFO  Done!
2022-09-21 21:50:59 INFO  # Finished -- repetition 1 of 7 
2022-09-21 21:50:59 INFO  # Optimization benchmark for feature_importance with args [['reviews', 'fast_loading', 'featurization_4', 'xgboost']] -- repetition 2 of 7
2022-09-21 21:50:59 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-21 21:50:59 INFO  Running instrumented original pipeline...
2022-09-21 21:50:59 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-21 21:50:59 INFO  ---RUNTIME: Importing and monkey-patching took 6.464242935180664 ms
2022-09-21 21:51:16 INFO  ---RUNTIME: Original pipeline execution took 16448.90069961548 ms (excluding imports and monkey-patching)
2022-09-21 21:51:16 INFO  Starting execution of 1 what-if analyses...
2022-09-21 21:51:16 INFO  Start plan generation for analysis PermutationFeatureImportance...
2022-09-21 21:51:16 INFO  ---RUNTIME: Plan generation took 0.11777877807617188 ms
2022-09-21 21:51:16 INFO  Estimated runtime of original DAG is 13060.303688049316ms
2022-09-21 21:51:16 INFO  Performing Multi-Query Optimization
2022-09-21 21:51:16 INFO  Estimated unoptimized what-if runtime is 65301.51844024658ms
2022-09-21 21:51:16 INFO  Estimated optimised what-if runtime is 13468.12391281128ms
2022-09-21 21:51:16 INFO  Estimated optimisation runtime saving is 51833.3945274353ms
2022-09-21 21:51:16 INFO  ---RUNTIME: Multi-Query Optimization took 10.816812515258789 ms
2022-09-21 21:51:16 INFO  Executing generated plans
2022-09-21 21:51:30 INFO  ---RUNTIME: Execution took 14124.45044517517 ms
2022-09-21 21:51:30 INFO  Done!
2022-09-21 21:51:30 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-21 21:51:30 INFO  Running instrumented original pipeline...
2022-09-21 21:51:30 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-21 21:51:30 INFO  ---RUNTIME: Importing and monkey-patching took 6.1740875244140625 ms
2022-09-21 21:51:46 INFO  ---RUNTIME: Original pipeline execution took 16266.138792037964 ms (excluding imports and monkey-patching)
2022-09-21 21:51:46 INFO  Starting execution of 1 what-if analyses...
2022-09-21 21:51:46 INFO  Start plan generation for analysis PermutationFeatureImportance...
2022-09-21 21:51:46 INFO  ---RUNTIME: Plan generation took 0.09989738464355469 ms
2022-09-21 21:51:46 INFO  Estimated runtime of original DAG is 13029.339075088501ms
2022-09-21 21:51:46 WARNING Skipping Multi-Query Optimization (instead, only applying patches)
2022-09-21 21:51:46 INFO  Estimated unoptimised what-if runtime is 65146.695375442505ms
2022-09-21 21:51:46 INFO  ---RUNTIME: Multi-Query Optimization took 4.159212112426758 ms
2022-09-21 21:51:46 INFO  Executing generated plans
2022-09-21 21:52:57 INFO  ---RUNTIME: Execution took 71041.583776474 ms
2022-09-21 21:52:57 INFO  Done!
2022-09-21 21:52:57 INFO  # Finished -- repetition 2 of 7 
2022-09-21 21:52:57 INFO  # Optimization benchmark for feature_importance with args [['reviews', 'fast_loading', 'featurization_4', 'xgboost']] -- repetition 3 of 7
2022-09-21 21:52:57 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-21 21:52:57 INFO  Running instrumented original pipeline...
2022-09-21 21:52:57 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-21 21:52:57 INFO  ---RUNTIME: Importing and monkey-patching took 6.235599517822266 ms
2022-09-21 21:53:14 INFO  ---RUNTIME: Original pipeline execution took 16813.11559677124 ms (excluding imports and monkey-patching)
2022-09-21 21:53:14 INFO  Starting execution of 1 what-if analyses...
2022-09-21 21:53:14 INFO  Start plan generation for analysis PermutationFeatureImportance...
2022-09-21 21:53:14 INFO  ---RUNTIME: Plan generation took 0.09751319885253906 ms
2022-09-21 21:53:14 INFO  Estimated runtime of original DAG is 13480.486392974854ms
2022-09-21 21:53:14 INFO  Performing Multi-Query Optimization
2022-09-21 21:53:14 INFO  Estimated unoptimized what-if runtime is 67402.43196487427ms
2022-09-21 21:53:14 INFO  Estimated optimised what-if runtime is 13886.545419692993ms
2022-09-21 21:53:14 INFO  Estimated optimisation runtime saving is 53515.886545181274ms
2022-09-21 21:53:14 INFO  ---RUNTIME: Multi-Query Optimization took 10.589838027954102 ms
2022-09-21 21:53:14 INFO  Executing generated plans
2022-09-21 21:53:28 INFO  ---RUNTIME: Execution took 14500.612258911133 ms
2022-09-21 21:53:28 INFO  Done!
2022-09-21 21:53:28 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-21 21:53:28 INFO  Running instrumented original pipeline...
2022-09-21 21:53:28 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-21 21:53:29 INFO  ---RUNTIME: Importing and monkey-patching took 6.113290786743164 ms
2022-09-21 21:53:45 INFO  ---RUNTIME: Original pipeline execution took 16883.247137069702 ms (excluding imports and monkey-patching)
2022-09-21 21:53:45 INFO  Starting execution of 1 what-if analyses...
2022-09-21 21:53:45 INFO  Start plan generation for analysis PermutationFeatureImportance...
2022-09-21 21:53:45 INFO  ---RUNTIME: Plan generation took 0.10418891906738281 ms
2022-09-21 21:53:45 INFO  Estimated runtime of original DAG is 13539.408683776855ms
2022-09-21 21:53:45 WARNING Skipping Multi-Query Optimization (instead, only applying patches)
2022-09-21 21:53:45 INFO  Estimated unoptimised what-if runtime is 67697.04341888428ms
2022-09-21 21:53:45 INFO  ---RUNTIME: Multi-Query Optimization took 4.098653793334961 ms
2022-09-21 21:53:45 INFO  Executing generated plans
2022-09-21 21:54:56 INFO  ---RUNTIME: Execution took 70463.71102333069 ms
2022-09-21 21:54:56 INFO  Done!
2022-09-21 21:54:56 INFO  # Finished -- repetition 3 of 7 
2022-09-21 21:54:56 INFO  # Optimization benchmark for feature_importance with args [['reviews', 'fast_loading', 'featurization_4', 'xgboost']] -- repetition 4 of 7
2022-09-21 21:54:56 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-21 21:54:56 INFO  Running instrumented original pipeline...
2022-09-21 21:54:56 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-21 21:54:56 INFO  ---RUNTIME: Importing and monkey-patching took 6.336688995361328 ms
2022-09-21 21:55:12 INFO  ---RUNTIME: Original pipeline execution took 16392.979621887207 ms (excluding imports and monkey-patching)
2022-09-21 21:55:12 INFO  Starting execution of 1 what-if analyses...
2022-09-21 21:55:12 INFO  Start plan generation for analysis PermutationFeatureImportance...
2022-09-21 21:55:12 INFO  ---RUNTIME: Plan generation took 0.11277198791503906 ms
2022-09-21 21:55:12 INFO  Estimated runtime of original DAG is 12868.75581741333ms
2022-09-21 21:55:12 INFO  Performing Multi-Query Optimization
2022-09-21 21:55:12 INFO  Estimated unoptimized what-if runtime is 64343.77908706665ms
2022-09-21 21:55:12 INFO  Estimated optimised what-if runtime is 13289.584159851074ms
2022-09-21 21:55:12 INFO  Estimated optimisation runtime saving is 51054.194927215576ms
2022-09-21 21:55:12 INFO  ---RUNTIME: Multi-Query Optimization took 10.8642578125 ms
2022-09-21 21:55:12 INFO  Executing generated plans
2022-09-21 21:55:27 INFO  ---RUNTIME: Execution took 14303.360223770142 ms
2022-09-21 21:55:27 INFO  Done!
2022-09-21 21:55:27 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-21 21:55:27 INFO  Running instrumented original pipeline...
2022-09-21 21:55:27 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-21 21:55:27 INFO  ---RUNTIME: Importing and monkey-patching took 5.770206451416016 ms
2022-09-21 21:55:44 INFO  ---RUNTIME: Original pipeline execution took 16999.09281730652 ms (excluding imports and monkey-patching)
2022-09-21 21:55:44 INFO  Starting execution of 1 what-if analyses...
2022-09-21 21:55:44 INFO  Start plan generation for analysis PermutationFeatureImportance...
2022-09-21 21:55:44 INFO  ---RUNTIME: Plan generation took 0.09846687316894531 ms
2022-09-21 21:55:44 INFO  Estimated runtime of original DAG is 13269.888877868652ms
2022-09-21 21:55:44 WARNING Skipping Multi-Query Optimization (instead, only applying patches)
2022-09-21 21:55:44 INFO  Estimated unoptimised what-if runtime is 66349.44438934326ms
2022-09-21 21:55:44 INFO  ---RUNTIME: Multi-Query Optimization took 4.855155944824219 ms
2022-09-21 21:55:44 INFO  Executing generated plans
2022-09-21 21:56:56 INFO  ---RUNTIME: Execution took 72245.83435058594 ms
2022-09-21 21:56:56 INFO  Done!
2022-09-21 21:56:56 INFO  # Finished -- repetition 4 of 7 
2022-09-21 21:56:56 INFO  # Optimization benchmark for feature_importance with args [['reviews', 'fast_loading', 'featurization_4', 'xgboost']] -- repetition 5 of 7
2022-09-21 21:56:56 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-21 21:56:56 INFO  Running instrumented original pipeline...
2022-09-21 21:56:56 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-21 21:56:56 INFO  ---RUNTIME: Importing and monkey-patching took 6.071805953979492 ms
2022-09-21 21:57:13 INFO  ---RUNTIME: Original pipeline execution took 16683.481693267822 ms (excluding imports and monkey-patching)
2022-09-21 21:57:13 INFO  Starting execution of 1 what-if analyses...
2022-09-21 21:57:13 INFO  Start plan generation for analysis PermutationFeatureImportance...
2022-09-21 21:57:13 INFO  ---RUNTIME: Plan generation took 0.10538101196289062 ms
2022-09-21 21:57:13 INFO  Estimated runtime of original DAG is 13356.910228729248ms
2022-09-21 21:57:13 INFO  Performing Multi-Query Optimization
2022-09-21 21:57:13 INFO  Estimated unoptimized what-if runtime is 66784.55114364624ms
2022-09-21 21:57:13 INFO  Estimated optimised what-if runtime is 13766.110897064209ms
2022-09-21 21:57:13 INFO  Estimated optimisation runtime saving is 53018.44024658203ms
2022-09-21 21:57:13 INFO  ---RUNTIME: Multi-Query Optimization took 10.846376419067383 ms
2022-09-21 21:57:13 INFO  Executing generated plans
2022-09-21 21:57:27 INFO  ---RUNTIME: Execution took 14686.166763305664 ms
2022-09-21 21:57:27 INFO  Done!
2022-09-21 21:57:27 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-21 21:57:27 INFO  Running instrumented original pipeline...
2022-09-21 21:57:27 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-21 21:57:27 INFO  ---RUNTIME: Importing and monkey-patching took 5.548000335693359 ms
2022-09-21 21:57:44 INFO  ---RUNTIME: Original pipeline execution took 16530.866384506226 ms (excluding imports and monkey-patching)
2022-09-21 21:57:44 INFO  Starting execution of 1 what-if analyses...
2022-09-21 21:57:44 INFO  Start plan generation for analysis PermutationFeatureImportance...
2022-09-21 21:57:44 INFO  ---RUNTIME: Plan generation took 0.10418891906738281 ms
2022-09-21 21:57:44 INFO  Estimated runtime of original DAG is 13181.931495666504ms
2022-09-21 21:57:44 WARNING Skipping Multi-Query Optimization (instead, only applying patches)
2022-09-21 21:57:44 INFO  Estimated unoptimised what-if runtime is 65909.65747833252ms
2022-09-21 21:57:44 INFO  ---RUNTIME: Multi-Query Optimization took 4.222631454467773 ms
2022-09-21 21:57:44 INFO  Executing generated plans
2022-09-21 21:58:54 INFO  ---RUNTIME: Execution took 70646.02828025818 ms
2022-09-21 21:58:54 INFO  Done!
2022-09-21 21:58:54 INFO  # Finished -- repetition 5 of 7 
2022-09-21 21:58:54 INFO  # Optimization benchmark for feature_importance with args [['reviews', 'fast_loading', 'featurization_4', 'xgboost']] -- repetition 6 of 7
2022-09-21 21:58:54 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-21 21:58:54 INFO  Running instrumented original pipeline...
2022-09-21 21:58:54 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-21 21:58:54 INFO  ---RUNTIME: Importing and monkey-patching took 7.147312164306641 ms
2022-09-21 21:59:11 INFO  ---RUNTIME: Original pipeline execution took 17015.21325111389 ms (excluding imports and monkey-patching)
2022-09-21 21:59:11 INFO  Starting execution of 1 what-if analyses...
2022-09-21 21:59:11 INFO  Start plan generation for analysis PermutationFeatureImportance...
2022-09-21 21:59:11 INFO  ---RUNTIME: Plan generation took 0.10538101196289062 ms
2022-09-21 21:59:11 INFO  Estimated runtime of original DAG is 13207.578420639038ms
2022-09-21 21:59:11 INFO  Performing Multi-Query Optimization
2022-09-21 21:59:11 INFO  Estimated unoptimized what-if runtime is 66037.89210319519ms
2022-09-21 21:59:11 INFO  Estimated optimised what-if runtime is 13616.772651672363ms
2022-09-21 21:59:11 INFO  Estimated optimisation runtime saving is 52421.11945152283ms
2022-09-21 21:59:11 INFO  ---RUNTIME: Multi-Query Optimization took 11.232137680053711 ms
2022-09-21 21:59:11 INFO  Executing generated plans
2022-09-21 21:59:26 INFO  ---RUNTIME: Execution took 14870.805501937866 ms
2022-09-21 21:59:26 INFO  Done!
2022-09-21 21:59:26 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-21 21:59:26 INFO  Running instrumented original pipeline...
2022-09-21 21:59:26 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-21 21:59:26 INFO  ---RUNTIME: Importing and monkey-patching took 5.735874176025391 ms
2022-09-21 21:59:42 INFO  ---RUNTIME: Original pipeline execution took 16023.902177810669 ms (excluding imports and monkey-patching)
2022-09-21 21:59:42 INFO  Starting execution of 1 what-if analyses...
2022-09-21 21:59:42 INFO  Start plan generation for analysis PermutationFeatureImportance...
2022-09-21 21:59:42 INFO  ---RUNTIME: Plan generation took 0.12445449829101562 ms
2022-09-21 21:59:42 INFO  Estimated runtime of original DAG is 12676.005840301514ms
2022-09-21 21:59:42 WARNING Skipping Multi-Query Optimization (instead, only applying patches)
2022-09-21 21:59:42 INFO  Estimated unoptimised what-if runtime is 63380.02920150757ms
2022-09-21 21:59:42 INFO  ---RUNTIME: Multi-Query Optimization took 4.575490951538086 ms
2022-09-21 21:59:42 INFO  Executing generated plans
2022-09-21 22:00:53 INFO  ---RUNTIME: Execution took 70290.88544845581 ms
2022-09-21 22:00:53 INFO  Done!
2022-09-21 22:00:53 INFO  # Finished -- repetition 6 of 7 
2022-09-21 22:00:53 INFO  # Optimization benchmark for feature_importance with args [['reviews', 'fast_loading', 'featurization_4', 'xgboost']] -- repetition 7 of 7
2022-09-21 22:00:53 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-21 22:00:53 INFO  Running instrumented original pipeline...
2022-09-21 22:00:53 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-21 22:00:53 INFO  ---RUNTIME: Importing and monkey-patching took 6.750822067260742 ms
2022-09-21 22:01:09 INFO  ---RUNTIME: Original pipeline execution took 16771.88801765442 ms (excluding imports and monkey-patching)
2022-09-21 22:01:09 INFO  Starting execution of 1 what-if analyses...
2022-09-21 22:01:09 INFO  Start plan generation for analysis PermutationFeatureImportance...
2022-09-21 22:01:09 INFO  ---RUNTIME: Plan generation took 0.10132789611816406 ms
2022-09-21 22:01:09 INFO  Estimated runtime of original DAG is 13153.072118759155ms
2022-09-21 22:01:09 INFO  Performing Multi-Query Optimization
2022-09-21 22:01:09 INFO  Estimated unoptimized what-if runtime is 65765.36059379578ms
2022-09-21 22:01:09 INFO  Estimated optimised what-if runtime is 13602.79893875122ms
2022-09-21 22:01:09 INFO  Estimated optimisation runtime saving is 52162.561655044556ms
2022-09-21 22:01:09 INFO  ---RUNTIME: Multi-Query Optimization took 10.771036148071289 ms
2022-09-21 22:01:09 INFO  Executing generated plans
2022-09-21 22:01:24 INFO  ---RUNTIME: Execution took 14624.455451965332 ms
2022-09-21 22:01:24 INFO  Done!
2022-09-21 22:01:24 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-21 22:01:24 INFO  Running instrumented original pipeline...
2022-09-21 22:01:24 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-21 22:01:24 INFO  ---RUNTIME: Importing and monkey-patching took 6.031036376953125 ms
2022-09-21 22:01:42 INFO  ---RUNTIME: Original pipeline execution took 18068.72797012329 ms (excluding imports and monkey-patching)
2022-09-21 22:01:42 INFO  Starting execution of 1 what-if analyses...
2022-09-21 22:01:42 INFO  Start plan generation for analysis PermutationFeatureImportance...
2022-09-21 22:01:42 INFO  ---RUNTIME: Plan generation took 0.09918212890625 ms
2022-09-21 22:01:42 INFO  Estimated runtime of original DAG is 14487.264156341553ms
2022-09-21 22:01:42 WARNING Skipping Multi-Query Optimization (instead, only applying patches)
2022-09-21 22:01:42 INFO  Estimated unoptimised what-if runtime is 72436.32078170776ms
2022-09-21 22:01:42 INFO  ---RUNTIME: Multi-Query Optimization took 4.191875457763672 ms
2022-09-21 22:01:42 INFO  Executing generated plans
2022-09-21 22:02:52 INFO  ---RUNTIME: Execution took 69529.88076210022 ms
2022-09-21 22:02:52 INFO  Done!
2022-09-21 22:02:52 INFO  # Finished -- repetition 7 of 7 
2022-09-21 22:02:52 INFO  # Final results after all repetitions
2022-09-21 22:02:52 INFO     repetition  ... no_opt_what_if_execution_combined_model_training
0           0  ...                                     19070.070267
1           1  ...                                     18290.479660
2           2  ...                                     18364.510536
3           3  ...                                     20159.937859
4           4  ...                                     18767.382145
5           5  ...                                     18489.987850
6           6  ...                                     17605.325460

[7 rows x 26 columns]
taskset -c 32-39 PROTOCOL_BUFFERS_PYTHON_IMPLEMENTATION=python python3.9 benchmarks_end_to_end.py feature_importance reviews fast_loading featurization_4 neural_network
2022-09-21 22:02:54.572778: W tensorflow/stream_executor/platform/default/dso_loader.cc:64] Could not load dynamic library 'libcudart.so.11.0'; dlerror: libcudart.so.11.0: cannot open shared object file: No such file or directory; LD_LIBRARY_PATH: /home/sgrafbe/mlwhatif/venv/lib/python3.9/site-packages/cv2/../../lib64:
2022-09-21 22:02:54.572825: I tensorflow/stream_executor/cuda/cudart_stub.cc:29] Ignore above cudart dlerror if you do not have a GPU set up on your machine.
2022-09-21 22:02:55 INFO  Patching sys.argv with ['mlwhatif', 'reviews', 'fast_loading', 'featurization_4', 'neural_network']
2022-09-21 22:02:55 INFO  Running instrumented original pipeline...
2022-09-21 22:02:55 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-21 22:02:56 INFO  ---RUNTIME: Importing and monkey-patching took 122.9708194732666 ms
2022-09-21 22:03:08.500582: W tensorflow/stream_executor/platform/default/dso_loader.cc:64] Could not load dynamic library 'libcuda.so.1'; dlerror: libcuda.so.1: cannot open shared object file: No such file or directory; LD_LIBRARY_PATH: /home/sgrafbe/mlwhatif/venv/lib/python3.9/site-packages/cv2/../../lib64:
2022-09-21 22:03:08.500620: W tensorflow/stream_executor/cuda/cuda_driver.cc:326] failed call to cuInit: UNKNOWN ERROR (303)
2022-09-21 22:03:08.500642: I tensorflow/stream_executor/cuda/cuda_diagnostics.cc:156] kernel driver does not appear to be running on this host (angus): /proc/driver/nvidia/version does not exist
2022-09-21 22:03:08.501216: I tensorflow/core/platform/cpu_feature_guard.cc:142] This TensorFlow binary is optimized with oneAPI Deep Neural Network Library (oneDNN) to use the following CPU instructions in performance-critical operations:  AVX2 FMA
To enable them in other operations, rebuild TensorFlow with the appropriate compiler flags.
2022-09-21 22:03:08.746620: I tensorflow/compiler/mlir/mlir_graph_optimization_pass.cc:176] None of the MLIR Optimization Passes are enabled (registered 2)
2022-09-21 22:03:08.759194: I tensorflow/core/platform/profile_utils/cpu_utils.cc:114] CPU Frequency: 2595130000 Hz
2022-09-21 22:03:12 INFO  ---RUNTIME: Original pipeline execution took 16778.965711593628 ms (excluding imports and monkey-patching)
2022-09-21 22:03:12 INFO  Starting execution of 0 what-if analyses...
2022-09-21 22:03:12 INFO  Estimated runtime of original DAG is 13392.73190498352ms
2022-09-21 22:03:12 INFO  Performing Multi-Query Optimization
2022-09-21 22:03:12 INFO  Estimated unoptimized what-if runtime is 0ms
2022-09-21 22:03:12 INFO  Estimated optimised what-if runtime is 0ms
2022-09-21 22:03:12 INFO  Estimated optimisation runtime saving is 0ms
2022-09-21 22:03:12 INFO  ---RUNTIME: Multi-Query Optimization took 0.4897117614746094 ms
2022-09-21 22:03:12 INFO  Executing generated plans
2022-09-21 22:03:12 INFO  ---RUNTIME: Execution took 0.015974044799804688 ms
2022-09-21 22:03:12 INFO  Done!
2022-09-21 22:03:12 INFO  # Optimization benchmark for feature_importance with args [['reviews', 'fast_loading', 'featurization_4', 'neural_network']] -- repetition 1 of 7
2022-09-21 22:03:12 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-21 22:03:12 INFO  Running instrumented original pipeline...
2022-09-21 22:03:12 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-21 22:03:12 INFO  ---RUNTIME: Importing and monkey-patching took 5.4187774658203125 ms
2022-09-21 22:03:29 INFO  ---RUNTIME: Original pipeline execution took 16470.731496810913 ms (excluding imports and monkey-patching)
2022-09-21 22:03:29 INFO  Starting execution of 1 what-if analyses...
2022-09-21 22:03:29 INFO  Start plan generation for analysis PermutationFeatureImportance...
2022-09-21 22:03:29 INFO  ---RUNTIME: Plan generation took 0.21028518676757812 ms
2022-09-21 22:03:29 INFO  Estimated runtime of original DAG is 13060.946226119995ms
2022-09-21 22:03:29 INFO  Performing Multi-Query Optimization
2022-09-21 22:03:29 INFO  Estimated unoptimized what-if runtime is 65304.731130599976ms
2022-09-21 22:03:29 INFO  Estimated optimised what-if runtime is 14900.487184524536ms
2022-09-21 22:03:29 INFO  Estimated optimisation runtime saving is 50404.24394607544ms
2022-09-21 22:03:29 INFO  ---RUNTIME: Multi-Query Optimization took 10.923147201538086 ms
2022-09-21 22:03:29 INFO  Executing generated plans
2022-09-21 22:03:44 INFO  ---RUNTIME: Execution took 15626.27625465393 ms
2022-09-21 22:03:44 INFO  Done!
2022-09-21 22:03:44 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-21 22:03:44 INFO  Running instrumented original pipeline...
2022-09-21 22:03:44 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-21 22:03:44 INFO  ---RUNTIME: Importing and monkey-patching took 6.060123443603516 ms
2022-09-21 22:04:01 INFO  ---RUNTIME: Original pipeline execution took 16560.027360916138 ms (excluding imports and monkey-patching)
2022-09-21 22:04:01 INFO  Starting execution of 1 what-if analyses...
2022-09-21 22:04:01 INFO  Start plan generation for analysis PermutationFeatureImportance...
2022-09-21 22:04:01 INFO  ---RUNTIME: Plan generation took 0.1785755157470703 ms
2022-09-21 22:04:01 INFO  Estimated runtime of original DAG is 13290.847539901733ms
2022-09-21 22:04:01 WARNING Skipping Multi-Query Optimization (instead, only applying patches)
2022-09-21 22:04:01 INFO  Estimated unoptimised what-if runtime is 66454.23769950867ms
2022-09-21 22:04:01 INFO  ---RUNTIME: Multi-Query Optimization took 5.094051361083984 ms
2022-09-21 22:04:01 INFO  Executing generated plans
2022-09-21 22:05:11 INFO  ---RUNTIME: Execution took 69652.5137424469 ms
2022-09-21 22:05:11 INFO  Done!
2022-09-21 22:05:11 INFO  # Finished -- repetition 1 of 7 
2022-09-21 22:05:11 INFO  # Optimization benchmark for feature_importance with args [['reviews', 'fast_loading', 'featurization_4', 'neural_network']] -- repetition 2 of 7
2022-09-21 22:05:11 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-21 22:05:11 INFO  Running instrumented original pipeline...
2022-09-21 22:05:11 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-21 22:05:11 INFO  ---RUNTIME: Importing and monkey-patching took 5.810260772705078 ms
2022-09-21 22:05:27 INFO  ---RUNTIME: Original pipeline execution took 16260.098457336426 ms (excluding imports and monkey-patching)
2022-09-21 22:05:27 INFO  Starting execution of 1 what-if analyses...
2022-09-21 22:05:27 INFO  Start plan generation for analysis PermutationFeatureImportance...
2022-09-21 22:05:27 INFO  ---RUNTIME: Plan generation took 0.12111663818359375 ms
2022-09-21 22:05:27 INFO  Estimated runtime of original DAG is 13023.92053604126ms
2022-09-21 22:05:27 INFO  Performing Multi-Query Optimization
2022-09-21 22:05:27 INFO  Estimated unoptimized what-if runtime is 65119.6026802063ms
2022-09-21 22:05:27 INFO  Estimated optimised what-if runtime is 14947.689771652222ms
2022-09-21 22:05:27 INFO  Estimated optimisation runtime saving is 50171.91290855408ms
2022-09-21 22:05:27 INFO  ---RUNTIME: Multi-Query Optimization took 12.16268539428711 ms
2022-09-21 22:05:27 INFO  Executing generated plans
2022-09-21 22:05:43 INFO  ---RUNTIME: Execution took 16125.719785690308 ms
2022-09-21 22:05:43 INFO  Done!
2022-09-21 22:05:43 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-21 22:05:43 INFO  Running instrumented original pipeline...
2022-09-21 22:05:43 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-21 22:05:43 INFO  ---RUNTIME: Importing and monkey-patching took 6.705999374389648 ms
2022-09-21 22:06:01 INFO  ---RUNTIME: Original pipeline execution took 17650.63190460205 ms (excluding imports and monkey-patching)
2022-09-21 22:06:01 INFO  Starting execution of 1 what-if analyses...
2022-09-21 22:06:01 INFO  Start plan generation for analysis PermutationFeatureImportance...
2022-09-21 22:06:01 INFO  ---RUNTIME: Plan generation took 0.10967254638671875 ms
2022-09-21 22:06:01 INFO  Estimated runtime of original DAG is 13853.212594985962ms
2022-09-21 22:06:01 WARNING Skipping Multi-Query Optimization (instead, only applying patches)
2022-09-21 22:06:01 INFO  Estimated unoptimised what-if runtime is 69266.06297492981ms
2022-09-21 22:06:01 INFO  ---RUNTIME: Multi-Query Optimization took 6.556272506713867 ms
2022-09-21 22:06:01 INFO  Executing generated plans
2022-09-21 22:07:10 INFO  ---RUNTIME: Execution took 69444.5858001709 ms
2022-09-21 22:07:10 INFO  Done!
2022-09-21 22:07:10 INFO  # Finished -- repetition 2 of 7 
2022-09-21 22:07:10 INFO  # Optimization benchmark for feature_importance with args [['reviews', 'fast_loading', 'featurization_4', 'neural_network']] -- repetition 3 of 7
2022-09-21 22:07:10 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-21 22:07:10 INFO  Running instrumented original pipeline...
2022-09-21 22:07:10 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-21 22:07:10 INFO  ---RUNTIME: Importing and monkey-patching took 5.887269973754883 ms
2022-09-21 22:07:27 INFO  ---RUNTIME: Original pipeline execution took 16982.210636138916 ms (excluding imports and monkey-patching)
2022-09-21 22:07:27 INFO  Starting execution of 1 what-if analyses...
2022-09-21 22:07:27 INFO  Start plan generation for analysis PermutationFeatureImportance...
2022-09-21 22:07:27 INFO  ---RUNTIME: Plan generation took 0.10657310485839844 ms
2022-09-21 22:07:27 INFO  Estimated runtime of original DAG is 13323.791980743408ms
2022-09-21 22:07:27 INFO  Performing Multi-Query Optimization
2022-09-21 22:07:27 INFO  Estimated unoptimized what-if runtime is 66618.95990371704ms
2022-09-21 22:07:27 INFO  Estimated optimised what-if runtime is 15449.549436569214ms
2022-09-21 22:07:27 INFO  Estimated optimisation runtime saving is 51169.41046714783ms
2022-09-21 22:07:27 INFO  ---RUNTIME: Multi-Query Optimization took 11.486530303955078 ms
2022-09-21 22:07:27 INFO  Executing generated plans
2022-09-21 22:07:43 INFO  ---RUNTIME: Execution took 15694.520950317383 ms
2022-09-21 22:07:43 INFO  Done!
2022-09-21 22:07:43 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-21 22:07:43 INFO  Running instrumented original pipeline...
2022-09-21 22:07:43 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-21 22:07:43 INFO  ---RUNTIME: Importing and monkey-patching took 6.217479705810547 ms
2022-09-21 22:08:00 INFO  ---RUNTIME: Original pipeline execution took 16950.0150680542 ms (excluding imports and monkey-patching)
2022-09-21 22:08:00 INFO  Starting execution of 1 what-if analyses...
2022-09-21 22:08:00 INFO  Start plan generation for analysis PermutationFeatureImportance...
2022-09-21 22:08:00 INFO  ---RUNTIME: Plan generation took 0.10633468627929688 ms
2022-09-21 22:08:00 INFO  Estimated runtime of original DAG is 13355.640649795532ms
2022-09-21 22:08:00 WARNING Skipping Multi-Query Optimization (instead, only applying patches)
2022-09-21 22:08:00 INFO  Estimated unoptimised what-if runtime is 66778.20324897766ms
2022-09-21 22:08:00 INFO  ---RUNTIME: Multi-Query Optimization took 4.424810409545898 ms
2022-09-21 22:08:00 INFO  Executing generated plans
2022-09-21 22:09:11 INFO  ---RUNTIME: Execution took 71161.22388839722 ms
2022-09-21 22:09:11 INFO  Done!
2022-09-21 22:09:11 INFO  # Finished -- repetition 3 of 7 
2022-09-21 22:09:11 INFO  # Optimization benchmark for feature_importance with args [['reviews', 'fast_loading', 'featurization_4', 'neural_network']] -- repetition 4 of 7
2022-09-21 22:09:11 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-21 22:09:11 INFO  Running instrumented original pipeline...
2022-09-21 22:09:11 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-21 22:09:11 INFO  ---RUNTIME: Importing and monkey-patching took 5.939722061157227 ms
2022-09-21 22:09:28 INFO  ---RUNTIME: Original pipeline execution took 16737.229824066162 ms (excluding imports and monkey-patching)
2022-09-21 22:09:28 INFO  Starting execution of 1 what-if analyses...
2022-09-21 22:09:28 INFO  Start plan generation for analysis PermutationFeatureImportance...
2022-09-21 22:09:28 INFO  ---RUNTIME: Plan generation took 0.11587142944335938 ms
2022-09-21 22:09:28 INFO  Estimated runtime of original DAG is 13478.831052780151ms
2022-09-21 22:09:28 INFO  Performing Multi-Query Optimization
2022-09-21 22:09:28 INFO  Estimated unoptimized what-if runtime is 67394.15526390076ms
2022-09-21 22:09:28 INFO  Estimated optimised what-if runtime is 15453.06921005249ms
2022-09-21 22:09:28 INFO  Estimated optimisation runtime saving is 51941.08605384827ms
2022-09-21 22:09:28 INFO  ---RUNTIME: Multi-Query Optimization took 11.53564453125 ms
2022-09-21 22:09:28 INFO  Executing generated plans
2022-09-21 22:09:44 INFO  ---RUNTIME: Execution took 15874.727964401245 ms
2022-09-21 22:09:44 INFO  Done!
2022-09-21 22:09:44 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-21 22:09:44 INFO  Running instrumented original pipeline...
2022-09-21 22:09:44 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-21 22:09:44 INFO  ---RUNTIME: Importing and monkey-patching took 5.816936492919922 ms
2022-09-21 22:10:00 INFO  ---RUNTIME: Original pipeline execution took 16670.525789260864 ms (excluding imports and monkey-patching)
2022-09-21 22:10:00 INFO  Starting execution of 1 what-if analyses...
2022-09-21 22:10:00 INFO  Start plan generation for analysis PermutationFeatureImportance...
2022-09-21 22:10:00 INFO  ---RUNTIME: Plan generation took 0.11610984802246094 ms
2022-09-21 22:10:00 INFO  Estimated runtime of original DAG is 12907.037258148193ms
2022-09-21 22:10:00 WARNING Skipping Multi-Query Optimization (instead, only applying patches)
2022-09-21 22:10:00 INFO  Estimated unoptimised what-if runtime is 64535.18629074097ms
2022-09-21 22:10:00 INFO  ---RUNTIME: Multi-Query Optimization took 4.23884391784668 ms
2022-09-21 22:10:00 INFO  Executing generated plans
2022-09-21 22:11:11 INFO  ---RUNTIME: Execution took 70878.15022468567 ms
2022-09-21 22:11:11 INFO  Done!
2022-09-21 22:11:11 INFO  # Finished -- repetition 4 of 7 
2022-09-21 22:11:11 INFO  # Optimization benchmark for feature_importance with args [['reviews', 'fast_loading', 'featurization_4', 'neural_network']] -- repetition 5 of 7
2022-09-21 22:11:11 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-21 22:11:11 INFO  Running instrumented original pipeline...
2022-09-21 22:11:11 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-21 22:11:11 INFO  ---RUNTIME: Importing and monkey-patching took 6.114721298217773 ms
2022-09-21 22:11:28 INFO  ---RUNTIME: Original pipeline execution took 16455.73592185974 ms (excluding imports and monkey-patching)
2022-09-21 22:11:28 INFO  Starting execution of 1 what-if analyses...
2022-09-21 22:11:28 INFO  Start plan generation for analysis PermutationFeatureImportance...
2022-09-21 22:11:28 INFO  ---RUNTIME: Plan generation took 0.1125335693359375 ms
2022-09-21 22:11:28 INFO  Estimated runtime of original DAG is 13213.419198989868ms
2022-09-21 22:11:28 INFO  Performing Multi-Query Optimization
2022-09-21 22:11:28 INFO  Estimated unoptimized what-if runtime is 66067.09599494934ms
2022-09-21 22:11:28 INFO  Estimated optimised what-if runtime is 15183.811902999878ms
2022-09-21 22:11:28 INFO  Estimated optimisation runtime saving is 50883.28409194946ms
2022-09-21 22:11:28 INFO  ---RUNTIME: Multi-Query Optimization took 13.027191162109375 ms
2022-09-21 22:11:28 INFO  Executing generated plans
2022-09-21 22:11:44 INFO  ---RUNTIME: Execution took 15805.50742149353 ms
2022-09-21 22:11:44 INFO  Done!
2022-09-21 22:11:44 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-21 22:11:44 INFO  Running instrumented original pipeline...
2022-09-21 22:11:44 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-21 22:11:44 INFO  ---RUNTIME: Importing and monkey-patching took 6.169557571411133 ms
2022-09-21 22:12:00 INFO  ---RUNTIME: Original pipeline execution took 16314.380168914795 ms (excluding imports and monkey-patching)
2022-09-21 22:12:00 INFO  Starting execution of 1 what-if analyses...
2022-09-21 22:12:00 INFO  Start plan generation for analysis PermutationFeatureImportance...
2022-09-21 22:12:00 INFO  ---RUNTIME: Plan generation took 0.1342296600341797 ms
2022-09-21 22:12:00 INFO  Estimated runtime of original DAG is 13056.7147731781ms
2022-09-21 22:12:00 WARNING Skipping Multi-Query Optimization (instead, only applying patches)
2022-09-21 22:12:00 INFO  Estimated unoptimised what-if runtime is 65283.5738658905ms
2022-09-21 22:12:00 INFO  ---RUNTIME: Multi-Query Optimization took 4.656076431274414 ms
2022-09-21 22:12:00 INFO  Executing generated plans
2022-09-21 22:13:11 INFO  ---RUNTIME: Execution took 71635.92314720154 ms
2022-09-21 22:13:11 INFO  Done!
2022-09-21 22:13:11 INFO  # Finished -- repetition 5 of 7 
2022-09-21 22:13:11 INFO  # Optimization benchmark for feature_importance with args [['reviews', 'fast_loading', 'featurization_4', 'neural_network']] -- repetition 6 of 7
2022-09-21 22:13:11 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-21 22:13:11 INFO  Running instrumented original pipeline...
2022-09-21 22:13:12 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-21 22:13:12 INFO  ---RUNTIME: Importing and monkey-patching took 5.966663360595703 ms
2022-09-21 22:13:28 INFO  ---RUNTIME: Original pipeline execution took 16400.50959587097 ms (excluding imports and monkey-patching)
2022-09-21 22:13:28 INFO  Starting execution of 1 what-if analyses...
2022-09-21 22:13:28 INFO  Start plan generation for analysis PermutationFeatureImportance...
2022-09-21 22:13:28 INFO  ---RUNTIME: Plan generation took 0.10585784912109375 ms
2022-09-21 22:13:28 INFO  Estimated runtime of original DAG is 13026.27420425415ms
2022-09-21 22:13:28 INFO  Performing Multi-Query Optimization
2022-09-21 22:13:28 INFO  Estimated unoptimized what-if runtime is 65131.37102127075ms
2022-09-21 22:13:28 INFO  Estimated optimised what-if runtime is 14845.99256515503ms
2022-09-21 22:13:28 INFO  Estimated optimisation runtime saving is 50285.37845611572ms
2022-09-21 22:13:28 INFO  ---RUNTIME: Multi-Query Optimization took 10.762453079223633 ms
2022-09-21 22:13:28 INFO  Executing generated plans
2022-09-21 22:13:44 INFO  ---RUNTIME: Execution took 16006.762027740479 ms
2022-09-21 22:13:44 INFO  Done!
2022-09-21 22:13:44 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-21 22:13:44 INFO  Running instrumented original pipeline...
2022-09-21 22:13:44 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-21 22:13:44 INFO  ---RUNTIME: Importing and monkey-patching took 5.829572677612305 ms
2022-09-21 22:14:00 INFO  ---RUNTIME: Original pipeline execution took 16348.611116409302 ms (excluding imports and monkey-patching)
2022-09-21 22:14:00 INFO  Starting execution of 1 what-if analyses...
2022-09-21 22:14:00 INFO  Start plan generation for analysis PermutationFeatureImportance...
2022-09-21 22:14:00 INFO  ---RUNTIME: Plan generation took 0.16498565673828125 ms
2022-09-21 22:14:00 INFO  Estimated runtime of original DAG is 13052.100896835327ms
2022-09-21 22:14:00 WARNING Skipping Multi-Query Optimization (instead, only applying patches)
2022-09-21 22:14:00 INFO  Estimated unoptimised what-if runtime is 65260.504484176636ms
2022-09-21 22:14:00 INFO  ---RUNTIME: Multi-Query Optimization took 4.145622253417969 ms
2022-09-21 22:14:00 INFO  Executing generated plans
2022-09-21 22:15:09 INFO  ---RUNTIME: Execution took 69196.4840888977 ms
2022-09-21 22:15:09 INFO  Done!
2022-09-21 22:15:09 INFO  # Finished -- repetition 6 of 7 
2022-09-21 22:15:09 INFO  # Optimization benchmark for feature_importance with args [['reviews', 'fast_loading', 'featurization_4', 'neural_network']] -- repetition 7 of 7
2022-09-21 22:15:09 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-21 22:15:09 INFO  Running instrumented original pipeline...
2022-09-21 22:15:10 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-21 22:15:10 INFO  ---RUNTIME: Importing and monkey-patching took 5.891323089599609 ms
2022-09-21 22:15:26 INFO  ---RUNTIME: Original pipeline execution took 16434.905529022217 ms (excluding imports and monkey-patching)
2022-09-21 22:15:26 INFO  Starting execution of 1 what-if analyses...
2022-09-21 22:15:26 INFO  Start plan generation for analysis PermutationFeatureImportance...
2022-09-21 22:15:26 INFO  ---RUNTIME: Plan generation took 0.10585784912109375 ms
2022-09-21 22:15:26 INFO  Estimated runtime of original DAG is 12769.837617874146ms
2022-09-21 22:15:26 INFO  Performing Multi-Query Optimization
2022-09-21 22:15:26 INFO  Estimated unoptimized what-if runtime is 63849.18808937073ms
2022-09-21 22:15:26 INFO  Estimated optimised what-if runtime is 14600.892305374146ms
2022-09-21 22:15:26 INFO  Estimated optimisation runtime saving is 49248.29578399658ms
2022-09-21 22:15:26 INFO  ---RUNTIME: Multi-Query Optimization took 12.165546417236328 ms
2022-09-21 22:15:26 INFO  Executing generated plans
2022-09-21 22:15:41 INFO  ---RUNTIME: Execution took 15344.256401062012 ms
2022-09-21 22:15:41 INFO  Done!
2022-09-21 22:15:41 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-21 22:15:41 INFO  Running instrumented original pipeline...
2022-09-21 22:15:42 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-21 22:15:42 INFO  ---RUNTIME: Importing and monkey-patching took 7.423877716064453 ms
2022-09-21 22:15:58 INFO  ---RUNTIME: Original pipeline execution took 16393.74542236328 ms (excluding imports and monkey-patching)
2022-09-21 22:15:58 INFO  Starting execution of 1 what-if analyses...
2022-09-21 22:15:58 INFO  Start plan generation for analysis PermutationFeatureImportance...
2022-09-21 22:15:58 INFO  ---RUNTIME: Plan generation took 0.12445449829101562 ms
2022-09-21 22:15:58 INFO  Estimated runtime of original DAG is 12771.640300750732ms
2022-09-21 22:15:58 WARNING Skipping Multi-Query Optimization (instead, only applying patches)
2022-09-21 22:15:58 INFO  Estimated unoptimised what-if runtime is 63858.20150375366ms
2022-09-21 22:15:58 INFO  ---RUNTIME: Multi-Query Optimization took 5.8994293212890625 ms
2022-09-21 22:15:58 INFO  Executing generated plans
2022-09-21 22:17:06 INFO  ---RUNTIME: Execution took 68467.47016906738 ms
2022-09-21 22:17:06 INFO  Done!
2022-09-21 22:17:06 INFO  # Finished -- repetition 7 of 7 
2022-09-21 22:17:06 INFO  # Final results after all repetitions
2022-09-21 22:17:06 INFO     repetition  ... no_opt_what_if_execution_combined_model_training
0           0  ...                                     16553.988934
1           1  ...                                     16702.557087
2           2  ...                                     17750.936031
3           3  ...                                     17997.842550
4           4  ...                                     17384.518385
5           5  ...                                     16553.059340
6           6  ...                                     16540.184975

[7 rows x 26 columns]
taskset -c 32-39 PROTOCOL_BUFFERS_PYTHON_IMPLEMENTATION=python python3.9 benchmarks_end_to_end.py data_corruption reviews fast_loading featurization_0 logistic_regression
2022-09-21 22:17:09.270526: W tensorflow/stream_executor/platform/default/dso_loader.cc:64] Could not load dynamic library 'libcudart.so.11.0'; dlerror: libcudart.so.11.0: cannot open shared object file: No such file or directory; LD_LIBRARY_PATH: /home/sgrafbe/mlwhatif/venv/lib/python3.9/site-packages/cv2/../../lib64:
2022-09-21 22:17:09.270573: I tensorflow/stream_executor/cuda/cudart_stub.cc:29] Ignore above cudart dlerror if you do not have a GPU set up on your machine.
2022-09-21 22:17:10 INFO  Patching sys.argv with ['mlwhatif', 'reviews', 'fast_loading', 'featurization_0', 'logistic_regression']
2022-09-21 22:17:10 INFO  Running instrumented original pipeline...
2022-09-21 22:17:10 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-21 22:17:10 INFO  ---RUNTIME: Importing and monkey-patching took 122.88546562194824 ms
2022-09-21 22:17:17 INFO  ---RUNTIME: Original pipeline execution took 6524.627923965454 ms (excluding imports and monkey-patching)
2022-09-21 22:17:17 INFO  Starting execution of 0 what-if analyses...
2022-09-21 22:17:17 INFO  Estimated runtime of original DAG is 4857.398748397827ms
2022-09-21 22:17:17 INFO  Performing Multi-Query Optimization
2022-09-21 22:17:17 INFO  Estimated unoptimized what-if runtime is 0ms
2022-09-21 22:17:17 INFO  Estimated optimised what-if runtime is 0ms
2022-09-21 22:17:17 INFO  Estimated optimisation runtime saving is 0ms
2022-09-21 22:17:17 INFO  ---RUNTIME: Multi-Query Optimization took 0.5004405975341797 ms
2022-09-21 22:17:17 INFO  Executing generated plans
2022-09-21 22:17:17 INFO  ---RUNTIME: Execution took 0.027418136596679688 ms
2022-09-21 22:17:17 INFO  Done!
2022-09-21 22:17:17 INFO  # Optimization benchmark for data_corruption with args [['reviews', 'fast_loading', 'featurization_0', 'logistic_regression']] -- repetition 1 of 7
2022-09-21 22:17:17 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-21 22:17:17 INFO  Running instrumented original pipeline...
2022-09-21 22:17:17 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-21 22:17:17 INFO  ---RUNTIME: Importing and monkey-patching took 5.695581436157227 ms
2022-09-21 22:17:23 INFO  ---RUNTIME: Original pipeline execution took 6621.263027191162 ms (excluding imports and monkey-patching)
2022-09-21 22:17:23 INFO  Starting execution of 1 what-if analyses...
2022-09-21 22:17:23 INFO  Start plan generation for analysis DataCorruption...
2022-09-21 22:17:23 INFO  ---RUNTIME: Plan generation took 0.4115104675292969 ms
2022-09-21 22:17:23 INFO  Estimated runtime of original DAG is 4792.273283004761ms
2022-09-21 22:17:23 INFO  Performing Multi-Query Optimization
2022-09-21 22:17:23 INFO  Estimated unoptimized what-if runtime is 119806.83207511902ms
2022-09-21 22:17:23 INFO  Estimated optimised what-if runtime is 11315.30499458313ms
2022-09-21 22:17:23 INFO  Estimated optimisation runtime saving is 108491.52708053589ms
2022-09-21 22:17:23 INFO  ---RUNTIME: Multi-Query Optimization took 58.81762504577637 ms
2022-09-21 22:17:23 INFO  Executing generated plans
2022-09-21 22:17:41 INFO  ---RUNTIME: Execution took 17404.858589172363 ms
2022-09-21 22:17:41 INFO  Done!
2022-09-21 22:17:41 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-21 22:17:41 INFO  Running instrumented original pipeline...
2022-09-21 22:17:41 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-21 22:17:41 INFO  ---RUNTIME: Importing and monkey-patching took 6.1798095703125 ms
2022-09-21 22:17:47 INFO  ---RUNTIME: Original pipeline execution took 6430.089950561523 ms (excluding imports and monkey-patching)
2022-09-21 22:17:47 INFO  Starting execution of 1 what-if analyses...
2022-09-21 22:17:47 INFO  Start plan generation for analysis DataCorruption...
2022-09-21 22:17:47 INFO  ---RUNTIME: Plan generation took 0.4305839538574219 ms
2022-09-21 22:17:47 INFO  Estimated runtime of original DAG is 4810.422897338867ms
2022-09-21 22:17:47 WARNING Skipping Multi-Query Optimization (instead, only applying patches)
2022-09-21 22:17:47 INFO  Estimated unoptimised what-if runtime is 120260.57243347168ms
2022-09-21 22:17:47 INFO  ---RUNTIME: Multi-Query Optimization took 17.482995986938477 ms
2022-09-21 22:17:47 INFO  Executing generated plans
2022-09-21 22:20:23 INFO  ---RUNTIME: Execution took 155903.79071235657 ms
2022-09-21 22:20:23 INFO  Done!
2022-09-21 22:20:23 INFO  # Finished -- repetition 1 of 7 
2022-09-21 22:20:23 INFO  # Optimization benchmark for data_corruption with args [['reviews', 'fast_loading', 'featurization_0', 'logistic_regression']] -- repetition 2 of 7
2022-09-21 22:20:23 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-21 22:20:23 INFO  Running instrumented original pipeline...
2022-09-21 22:20:23 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-21 22:20:23 INFO  ---RUNTIME: Importing and monkey-patching took 6.144046783447266 ms
2022-09-21 22:20:30 INFO  ---RUNTIME: Original pipeline execution took 6427.253723144531 ms (excluding imports and monkey-patching)
2022-09-21 22:20:30 INFO  Starting execution of 1 what-if analyses...
2022-09-21 22:20:30 INFO  Start plan generation for analysis DataCorruption...
2022-09-21 22:20:30 INFO  ---RUNTIME: Plan generation took 0.4570484161376953 ms
2022-09-21 22:20:30 INFO  Estimated runtime of original DAG is 4791.919469833374ms
2022-09-21 22:20:30 INFO  Performing Multi-Query Optimization
2022-09-21 22:20:30 INFO  Estimated unoptimized what-if runtime is 119797.98674583435ms
2022-09-21 22:20:30 INFO  Estimated optimised what-if runtime is 11347.189664840698ms
2022-09-21 22:20:30 INFO  Estimated optimisation runtime saving is 108450.79708099365ms
2022-09-21 22:20:30 INFO  ---RUNTIME: Multi-Query Optimization took 58.62903594970703 ms
2022-09-21 22:20:30 INFO  Executing generated plans
2022-09-21 22:20:47 INFO  ---RUNTIME: Execution took 17311.577320098877 ms
2022-09-21 22:20:47 INFO  Done!
2022-09-21 22:20:47 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-21 22:20:47 INFO  Running instrumented original pipeline...
2022-09-21 22:20:47 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-21 22:20:47 INFO  ---RUNTIME: Importing and monkey-patching took 6.187915802001953 ms
2022-09-21 22:20:53 INFO  ---RUNTIME: Original pipeline execution took 6417.46711730957 ms (excluding imports and monkey-patching)
2022-09-21 22:20:53 INFO  Starting execution of 1 what-if analyses...
2022-09-21 22:20:53 INFO  Start plan generation for analysis DataCorruption...
2022-09-21 22:20:53 INFO  ---RUNTIME: Plan generation took 0.4067420959472656 ms
2022-09-21 22:20:53 INFO  Estimated runtime of original DAG is 4787.225961685181ms
2022-09-21 22:20:53 WARNING Skipping Multi-Query Optimization (instead, only applying patches)
2022-09-21 22:20:53 INFO  Estimated unoptimised what-if runtime is 119680.64904212952ms
2022-09-21 22:20:53 INFO  ---RUNTIME: Multi-Query Optimization took 17.68803596496582 ms
2022-09-21 22:20:53 INFO  Executing generated plans
2022-09-21 22:23:29 INFO  ---RUNTIME: Execution took 155976.85837745667 ms
2022-09-21 22:23:29 INFO  Done!
2022-09-21 22:23:29 INFO  # Finished -- repetition 2 of 7 
2022-09-21 22:23:29 INFO  # Optimization benchmark for data_corruption with args [['reviews', 'fast_loading', 'featurization_0', 'logistic_regression']] -- repetition 3 of 7
2022-09-21 22:23:29 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-21 22:23:29 INFO  Running instrumented original pipeline...
2022-09-21 22:23:29 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-21 22:23:29 INFO  ---RUNTIME: Importing and monkey-patching took 6.119489669799805 ms
2022-09-21 22:23:36 INFO  ---RUNTIME: Original pipeline execution took 6428.989887237549 ms (excluding imports and monkey-patching)
2022-09-21 22:23:36 INFO  Starting execution of 1 what-if analyses...
2022-09-21 22:23:36 INFO  Start plan generation for analysis DataCorruption...
2022-09-21 22:23:36 INFO  ---RUNTIME: Plan generation took 0.42128562927246094 ms
2022-09-21 22:23:36 INFO  Estimated runtime of original DAG is 4795.891046524048ms
2022-09-21 22:23:36 INFO  Performing Multi-Query Optimization
2022-09-21 22:23:36 INFO  Estimated unoptimized what-if runtime is 119897.2761631012ms
2022-09-21 22:23:36 INFO  Estimated optimised what-if runtime is 11337.957859039307ms
2022-09-21 22:23:36 INFO  Estimated optimisation runtime saving is 108559.31830406189ms
2022-09-21 22:23:36 INFO  ---RUNTIME: Multi-Query Optimization took 58.69340896606445 ms
2022-09-21 22:23:36 INFO  Executing generated plans
2022-09-21 22:23:53 INFO  ---RUNTIME: Execution took 17412.89210319519 ms
2022-09-21 22:23:53 INFO  Done!
2022-09-21 22:23:53 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-21 22:23:53 INFO  Running instrumented original pipeline...
2022-09-21 22:23:54 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-21 22:23:54 INFO  ---RUNTIME: Importing and monkey-patching took 5.845785140991211 ms
2022-09-21 22:24:00 INFO  ---RUNTIME: Original pipeline execution took 6739.863395690918 ms (excluding imports and monkey-patching)
2022-09-21 22:24:00 INFO  Starting execution of 1 what-if analyses...
2022-09-21 22:24:00 INFO  Start plan generation for analysis DataCorruption...
2022-09-21 22:24:00 INFO  ---RUNTIME: Plan generation took 0.4153251647949219 ms
2022-09-21 22:24:00 INFO  Estimated runtime of original DAG is 4817.440748214722ms
2022-09-21 22:24:00 WARNING Skipping Multi-Query Optimization (instead, only applying patches)
2022-09-21 22:24:00 INFO  Estimated unoptimised what-if runtime is 120436.01870536804ms
2022-09-21 22:24:00 INFO  ---RUNTIME: Multi-Query Optimization took 17.58265495300293 ms
2022-09-21 22:24:00 INFO  Executing generated plans
2022-09-21 22:26:38 INFO  ---RUNTIME: Execution took 157480.67688941956 ms
2022-09-21 22:26:38 INFO  Done!
2022-09-21 22:26:38 INFO  # Finished -- repetition 3 of 7 
2022-09-21 22:26:38 INFO  # Optimization benchmark for data_corruption with args [['reviews', 'fast_loading', 'featurization_0', 'logistic_regression']] -- repetition 4 of 7
2022-09-21 22:26:38 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-21 22:26:38 INFO  Running instrumented original pipeline...
2022-09-21 22:26:38 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-21 22:26:38 INFO  ---RUNTIME: Importing and monkey-patching took 6.293773651123047 ms
2022-09-21 22:26:44 INFO  ---RUNTIME: Original pipeline execution took 6496.012449264526 ms (excluding imports and monkey-patching)
2022-09-21 22:26:44 INFO  Starting execution of 1 what-if analyses...
2022-09-21 22:26:44 INFO  Start plan generation for analysis DataCorruption...
2022-09-21 22:26:44 INFO  ---RUNTIME: Plan generation took 0.4620552062988281 ms
2022-09-21 22:26:44 INFO  Estimated runtime of original DAG is 4833.003759384155ms
2022-09-21 22:26:44 INFO  Performing Multi-Query Optimization
2022-09-21 22:26:44 INFO  Estimated unoptimized what-if runtime is 120825.09398460388ms
2022-09-21 22:26:44 INFO  Estimated optimised what-if runtime is 11374.032735824585ms
2022-09-21 22:26:44 INFO  Estimated optimisation runtime saving is 109451.0612487793ms
2022-09-21 22:26:44 INFO  ---RUNTIME: Multi-Query Optimization took 58.82549285888672 ms
2022-09-21 22:26:44 INFO  Executing generated plans
2022-09-21 22:27:02 INFO  ---RUNTIME: Execution took 17490.068674087524 ms
2022-09-21 22:27:02 INFO  Done!
2022-09-21 22:27:02 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-21 22:27:02 INFO  Running instrumented original pipeline...
2022-09-21 22:27:02 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-21 22:27:02 INFO  ---RUNTIME: Importing and monkey-patching took 6.030082702636719 ms
2022-09-21 22:27:08 INFO  ---RUNTIME: Original pipeline execution took 6479.637384414673 ms (excluding imports and monkey-patching)
2022-09-21 22:27:08 INFO  Starting execution of 1 what-if analyses...
2022-09-21 22:27:08 INFO  Start plan generation for analysis DataCorruption...
2022-09-21 22:27:08 INFO  ---RUNTIME: Plan generation took 0.40340423583984375 ms
2022-09-21 22:27:08 INFO  Estimated runtime of original DAG is 4820.482492446899ms
2022-09-21 22:27:08 WARNING Skipping Multi-Query Optimization (instead, only applying patches)
2022-09-21 22:27:08 INFO  Estimated unoptimised what-if runtime is 120512.06231117249ms
2022-09-21 22:27:08 INFO  ---RUNTIME: Multi-Query Optimization took 17.5018310546875 ms
2022-09-21 22:27:08 INFO  Executing generated plans
2022-09-21 22:29:45 INFO  ---RUNTIME: Execution took 156631.10947608948 ms
2022-09-21 22:29:45 INFO  Done!
2022-09-21 22:29:45 INFO  # Finished -- repetition 4 of 7 
2022-09-21 22:29:45 INFO  # Optimization benchmark for data_corruption with args [['reviews', 'fast_loading', 'featurization_0', 'logistic_regression']] -- repetition 5 of 7
2022-09-21 22:29:45 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-21 22:29:45 INFO  Running instrumented original pipeline...
2022-09-21 22:29:45 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-21 22:29:45 INFO  ---RUNTIME: Importing and monkey-patching took 6.047248840332031 ms
2022-09-21 22:29:51 INFO  ---RUNTIME: Original pipeline execution took 6460.2210521698 ms (excluding imports and monkey-patching)
2022-09-21 22:29:51 INFO  Starting execution of 1 what-if analyses...
2022-09-21 22:29:51 INFO  Start plan generation for analysis DataCorruption...
2022-09-21 22:29:51 INFO  ---RUNTIME: Plan generation took 0.4105567932128906 ms
2022-09-21 22:29:51 INFO  Estimated runtime of original DAG is 4815.184831619263ms
2022-09-21 22:29:51 INFO  Performing Multi-Query Optimization
2022-09-21 22:29:51 INFO  Estimated unoptimized what-if runtime is 120379.62079048157ms
2022-09-21 22:29:51 INFO  Estimated optimised what-if runtime is 11359.772682189941ms
2022-09-21 22:29:51 INFO  Estimated optimisation runtime saving is 109019.84810829163ms
2022-09-21 22:29:51 INFO  ---RUNTIME: Multi-Query Optimization took 59.03887748718262 ms
2022-09-21 22:29:51 INFO  Executing generated plans
2022-09-21 22:30:09 INFO  ---RUNTIME: Execution took 17405.928134918213 ms
2022-09-21 22:30:09 INFO  Done!
2022-09-21 22:30:09 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-21 22:30:09 INFO  Running instrumented original pipeline...
2022-09-21 22:30:09 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-21 22:30:09 INFO  ---RUNTIME: Importing and monkey-patching took 6.150245666503906 ms
2022-09-21 22:30:15 INFO  ---RUNTIME: Original pipeline execution took 6448.311328887939 ms (excluding imports and monkey-patching)
2022-09-21 22:30:15 INFO  Starting execution of 1 what-if analyses...
2022-09-21 22:30:15 INFO  Start plan generation for analysis DataCorruption...
2022-09-21 22:30:15 INFO  ---RUNTIME: Plan generation took 0.40030479431152344 ms
2022-09-21 22:30:15 INFO  Estimated runtime of original DAG is 4803.400278091431ms
2022-09-21 22:30:15 WARNING Skipping Multi-Query Optimization (instead, only applying patches)
2022-09-21 22:30:15 INFO  Estimated unoptimised what-if runtime is 120085.00695228577ms
2022-09-21 22:30:15 INFO  ---RUNTIME: Multi-Query Optimization took 17.53401756286621 ms
2022-09-21 22:30:15 INFO  Executing generated plans
2022-09-21 22:32:51 INFO  ---RUNTIME: Execution took 156091.86697006226 ms
2022-09-21 22:32:51 INFO  Done!
2022-09-21 22:32:51 INFO  # Finished -- repetition 5 of 7 
2022-09-21 22:32:51 INFO  # Optimization benchmark for data_corruption with args [['reviews', 'fast_loading', 'featurization_0', 'logistic_regression']] -- repetition 6 of 7
2022-09-21 22:32:51 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-21 22:32:51 INFO  Running instrumented original pipeline...
2022-09-21 22:32:51 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-21 22:32:51 INFO  ---RUNTIME: Importing and monkey-patching took 6.081581115722656 ms
2022-09-21 22:32:58 INFO  ---RUNTIME: Original pipeline execution took 6409.331321716309 ms (excluding imports and monkey-patching)
2022-09-21 22:32:58 INFO  Starting execution of 1 what-if analyses...
2022-09-21 22:32:58 INFO  Start plan generation for analysis DataCorruption...
2022-09-21 22:32:58 INFO  ---RUNTIME: Plan generation took 0.4010200500488281 ms
2022-09-21 22:32:58 INFO  Estimated runtime of original DAG is 4777.205467224121ms
2022-09-21 22:32:58 INFO  Performing Multi-Query Optimization
2022-09-21 22:32:58 INFO  Estimated unoptimized what-if runtime is 119430.13668060303ms
2022-09-21 22:32:58 INFO  Estimated optimised what-if runtime is 11294.997215270996ms
2022-09-21 22:32:58 INFO  Estimated optimisation runtime saving is 108135.13946533203ms
2022-09-21 22:32:58 INFO  ---RUNTIME: Multi-Query Optimization took 58.60400199890137 ms
2022-09-21 22:32:58 INFO  Executing generated plans
2022-09-21 22:33:15 INFO  ---RUNTIME: Execution took 17324.626445770264 ms
2022-09-21 22:33:15 INFO  Done!
2022-09-21 22:33:15 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-21 22:33:15 INFO  Running instrumented original pipeline...
2022-09-21 22:33:15 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-21 22:33:15 INFO  ---RUNTIME: Importing and monkey-patching took 5.847692489624023 ms
2022-09-21 22:33:22 INFO  ---RUNTIME: Original pipeline execution took 6947.587966918945 ms (excluding imports and monkey-patching)
2022-09-21 22:33:22 INFO  Starting execution of 1 what-if analyses...
2022-09-21 22:33:22 INFO  Start plan generation for analysis DataCorruption...
2022-09-21 22:33:22 INFO  ---RUNTIME: Plan generation took 0.41866302490234375 ms
2022-09-21 22:33:22 INFO  Estimated runtime of original DAG is 5016.271591186523ms
2022-09-21 22:33:22 WARNING Skipping Multi-Query Optimization (instead, only applying patches)
2022-09-21 22:33:22 INFO  Estimated unoptimised what-if runtime is 125406.78977966309ms
2022-09-21 22:33:22 INFO  ---RUNTIME: Multi-Query Optimization took 17.104625701904297 ms
2022-09-21 22:33:22 INFO  Executing generated plans
2022-09-21 22:36:07 INFO  ---RUNTIME: Execution took 165113.4181022644 ms
2022-09-21 22:36:07 INFO  Done!
2022-09-21 22:36:07 INFO  # Finished -- repetition 6 of 7 
2022-09-21 22:36:07 INFO  # Optimization benchmark for data_corruption with args [['reviews', 'fast_loading', 'featurization_0', 'logistic_regression']] -- repetition 7 of 7
2022-09-21 22:36:07 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-21 22:36:07 INFO  Running instrumented original pipeline...
2022-09-21 22:36:07 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-21 22:36:07 INFO  ---RUNTIME: Importing and monkey-patching took 6.164789199829102 ms
2022-09-21 22:36:14 INFO  ---RUNTIME: Original pipeline execution took 6680.2637577056885 ms (excluding imports and monkey-patching)
2022-09-21 22:36:14 INFO  Starting execution of 1 what-if analyses...
2022-09-21 22:36:14 INFO  Start plan generation for analysis DataCorruption...
2022-09-21 22:36:14 INFO  ---RUNTIME: Plan generation took 0.4203319549560547 ms
2022-09-21 22:36:14 INFO  Estimated runtime of original DAG is 5031.957149505615ms
2022-09-21 22:36:14 INFO  Performing Multi-Query Optimization
2022-09-21 22:36:14 INFO  Estimated unoptimized what-if runtime is 125798.92873764038ms
2022-09-21 22:36:14 INFO  Estimated optimised what-if runtime is 12631.59441947937ms
2022-09-21 22:36:14 INFO  Estimated optimisation runtime saving is 113167.33431816101ms
2022-09-21 22:36:14 INFO  ---RUNTIME: Multi-Query Optimization took 57.6634407043457 ms
2022-09-21 22:36:14 INFO  Executing generated plans
2022-09-21 22:36:32 INFO  ---RUNTIME: Execution took 17682.0011138916 ms
2022-09-21 22:36:32 INFO  Done!
2022-09-21 22:36:32 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-21 22:36:32 INFO  Running instrumented original pipeline...
2022-09-21 22:36:32 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-21 22:36:32 INFO  ---RUNTIME: Importing and monkey-patching took 5.745410919189453 ms
2022-09-21 22:36:38 INFO  ---RUNTIME: Original pipeline execution took 6728.465795516968 ms (excluding imports and monkey-patching)
2022-09-21 22:36:38 INFO  Starting execution of 1 what-if analyses...
2022-09-21 22:36:38 INFO  Start plan generation for analysis DataCorruption...
2022-09-21 22:36:38 INFO  ---RUNTIME: Plan generation took 0.4038810729980469 ms
2022-09-21 22:36:38 INFO  Estimated runtime of original DAG is 5015.917062759399ms
2022-09-21 22:36:38 WARNING Skipping Multi-Query Optimization (instead, only applying patches)
2022-09-21 22:36:38 INFO  Estimated unoptimised what-if runtime is 125397.92656898499ms
2022-09-21 22:36:38 INFO  ---RUNTIME: Multi-Query Optimization took 17.0595645904541 ms
2022-09-21 22:36:38 INFO  Executing generated plans
2022-09-21 22:39:23 INFO  ---RUNTIME: Execution took 164247.00736999512 ms
2022-09-21 22:39:23 INFO  Done!
2022-09-21 22:39:23 INFO  # Finished -- repetition 7 of 7 
2022-09-21 22:39:23 INFO  # Final results after all repetitions
2022-09-21 22:39:23 INFO     repetition  ... no_opt_what_if_execution_combined_model_training
0           0  ...                                      3936.975002
1           1  ...                                      3941.290617
2           2  ...                                      3924.909353
3           3  ...                                      3927.855015
4           4  ...                                      3899.913549
5           5  ...                                      4237.163305
6           6  ...                                      4187.724113

[7 rows x 26 columns]
taskset -c 32-39 PROTOCOL_BUFFERS_PYTHON_IMPLEMENTATION=python python3.9 benchmarks_end_to_end.py data_corruption reviews fast_loading featurization_0 xgboost
2022-09-21 22:39:25.351387: W tensorflow/stream_executor/platform/default/dso_loader.cc:64] Could not load dynamic library 'libcudart.so.11.0'; dlerror: libcudart.so.11.0: cannot open shared object file: No such file or directory; LD_LIBRARY_PATH: /home/sgrafbe/mlwhatif/venv/lib/python3.9/site-packages/cv2/../../lib64:
2022-09-21 22:39:25.351434: I tensorflow/stream_executor/cuda/cudart_stub.cc:29] Ignore above cudart dlerror if you do not have a GPU set up on your machine.
2022-09-21 22:39:26 INFO  Patching sys.argv with ['mlwhatif', 'reviews', 'fast_loading', 'featurization_0', 'xgboost']
2022-09-21 22:39:26 INFO  Running instrumented original pipeline...
2022-09-21 22:39:26 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-21 22:39:27 INFO  ---RUNTIME: Importing and monkey-patching took 140.9914493560791 ms
2022-09-21 22:39:35 INFO  ---RUNTIME: Original pipeline execution took 8387.985467910767 ms (excluding imports and monkey-patching)
2022-09-21 22:39:35 INFO  Starting execution of 0 what-if analyses...
2022-09-21 22:39:35 INFO  Estimated runtime of original DAG is 6730.795621871948ms
2022-09-21 22:39:35 INFO  Performing Multi-Query Optimization
2022-09-21 22:39:35 INFO  Estimated unoptimized what-if runtime is 0ms
2022-09-21 22:39:35 INFO  Estimated optimised what-if runtime is 0ms
2022-09-21 22:39:35 INFO  Estimated optimisation runtime saving is 0ms
2022-09-21 22:39:35 INFO  ---RUNTIME: Multi-Query Optimization took 0.48470497131347656 ms
2022-09-21 22:39:35 INFO  Executing generated plans
2022-09-21 22:39:35 INFO  ---RUNTIME: Execution took 0.028133392333984375 ms
2022-09-21 22:39:35 INFO  Done!
2022-09-21 22:39:35 INFO  # Optimization benchmark for data_corruption with args [['reviews', 'fast_loading', 'featurization_0', 'xgboost']] -- repetition 1 of 7
2022-09-21 22:39:35 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-21 22:39:35 INFO  Running instrumented original pipeline...
2022-09-21 22:39:35 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-21 22:39:35 INFO  ---RUNTIME: Importing and monkey-patching took 5.77235221862793 ms
2022-09-21 22:39:42 INFO  ---RUNTIME: Original pipeline execution took 7497.329950332642 ms (excluding imports and monkey-patching)
2022-09-21 22:39:42 INFO  Starting execution of 1 what-if analyses...
2022-09-21 22:39:42 INFO  Start plan generation for analysis DataCorruption...
2022-09-21 22:39:42 INFO  ---RUNTIME: Plan generation took 0.4260540008544922 ms
2022-09-21 22:39:42 INFO  Estimated runtime of original DAG is 5497.587442398071ms
2022-09-21 22:39:42 INFO  Performing Multi-Query Optimization
2022-09-21 22:39:43 INFO  Estimated unoptimized what-if runtime is 137439.68605995178ms
2022-09-21 22:39:43 INFO  Estimated optimised what-if runtime is 13281.051635742188ms
2022-09-21 22:39:43 INFO  Estimated optimisation runtime saving is 124158.6344242096ms
2022-09-21 22:39:43 INFO  ---RUNTIME: Multi-Query Optimization took 59.57841873168945 ms
2022-09-21 22:39:43 INFO  Executing generated plans
2022-09-21 22:40:02 INFO  ---RUNTIME: Execution took 19169.857501983643 ms
2022-09-21 22:40:02 INFO  Done!
2022-09-21 22:40:02 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-21 22:40:02 INFO  Running instrumented original pipeline...
2022-09-21 22:40:02 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-21 22:40:02 INFO  ---RUNTIME: Importing and monkey-patching took 6.286859512329102 ms
2022-09-21 22:40:11 INFO  ---RUNTIME: Original pipeline execution took 9017.00472831726 ms (excluding imports and monkey-patching)
2022-09-21 22:40:11 INFO  Starting execution of 1 what-if analyses...
2022-09-21 22:40:11 INFO  Start plan generation for analysis DataCorruption...
2022-09-21 22:40:11 INFO  ---RUNTIME: Plan generation took 0.6642341613769531 ms
2022-09-21 22:40:11 INFO  Estimated runtime of original DAG is 6746.844291687012ms
2022-09-21 22:40:11 WARNING Skipping Multi-Query Optimization (instead, only applying patches)
2022-09-21 22:40:11 INFO  Estimated unoptimised what-if runtime is 168671.1072921753ms
2022-09-21 22:40:11 INFO  ---RUNTIME: Multi-Query Optimization took 25.30956268310547 ms
2022-09-21 22:40:11 INFO  Executing generated plans
2022-09-21 22:43:10 INFO  ---RUNTIME: Execution took 178897.6490497589 ms
2022-09-21 22:43:10 INFO  Done!
2022-09-21 22:43:10 INFO  # Finished -- repetition 1 of 7 
2022-09-21 22:43:10 INFO  # Optimization benchmark for data_corruption with args [['reviews', 'fast_loading', 'featurization_0', 'xgboost']] -- repetition 2 of 7
2022-09-21 22:43:10 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-21 22:43:10 INFO  Running instrumented original pipeline...
2022-09-21 22:43:10 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-21 22:43:10 INFO  ---RUNTIME: Importing and monkey-patching took 5.977153778076172 ms
2022-09-21 22:43:17 INFO  ---RUNTIME: Original pipeline execution took 7460.308790206909 ms (excluding imports and monkey-patching)
2022-09-21 22:43:17 INFO  Starting execution of 1 what-if analyses...
2022-09-21 22:43:17 INFO  Start plan generation for analysis DataCorruption...
2022-09-21 22:43:17 INFO  ---RUNTIME: Plan generation took 0.6792545318603516 ms
2022-09-21 22:43:17 INFO  Estimated runtime of original DAG is 5811.470746994019ms
2022-09-21 22:43:17 INFO  Performing Multi-Query Optimization
2022-09-21 22:43:17 INFO  Estimated unoptimized what-if runtime is 145286.76867485046ms
2022-09-21 22:43:17 INFO  Estimated optimised what-if runtime is 15409.382343292236ms
2022-09-21 22:43:17 INFO  Estimated optimisation runtime saving is 129877.38633155823ms
2022-09-21 22:43:17 INFO  ---RUNTIME: Multi-Query Optimization took 82.08298683166504 ms
2022-09-21 22:43:17 INFO  Executing generated plans
2022-09-21 22:43:40 INFO  ---RUNTIME: Execution took 22570.3604221344 ms
2022-09-21 22:43:40 INFO  Done!
2022-09-21 22:43:40 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-21 22:43:40 INFO  Running instrumented original pipeline...
2022-09-21 22:43:40 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-21 22:43:40 INFO  ---RUNTIME: Importing and monkey-patching took 6.09278678894043 ms
2022-09-21 22:43:47 INFO  ---RUNTIME: Original pipeline execution took 7266.277313232422 ms (excluding imports and monkey-patching)
2022-09-21 22:43:47 INFO  Starting execution of 1 what-if analyses...
2022-09-21 22:43:47 INFO  Start plan generation for analysis DataCorruption...
2022-09-21 22:43:47 INFO  ---RUNTIME: Plan generation took 0.41031837463378906 ms
2022-09-21 22:43:47 INFO  Estimated runtime of original DAG is 5629.094123840332ms
2022-09-21 22:43:47 WARNING Skipping Multi-Query Optimization (instead, only applying patches)
2022-09-21 22:43:47 INFO  Estimated unoptimised what-if runtime is 140727.3530960083ms
2022-09-21 22:43:47 INFO  ---RUNTIME: Multi-Query Optimization took 17.388582229614258 ms
2022-09-21 22:43:47 INFO  Executing generated plans
2022-09-21 22:46:46 INFO  ---RUNTIME: Execution took 179202.09336280823 ms
2022-09-21 22:46:46 INFO  Done!
2022-09-21 22:46:46 INFO  # Finished -- repetition 2 of 7 
2022-09-21 22:46:46 INFO  # Optimization benchmark for data_corruption with args [['reviews', 'fast_loading', 'featurization_0', 'xgboost']] -- repetition 3 of 7
2022-09-21 22:46:46 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-21 22:46:46 INFO  Running instrumented original pipeline...
2022-09-21 22:46:46 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-21 22:46:46 INFO  ---RUNTIME: Importing and monkey-patching took 5.980968475341797 ms
2022-09-21 22:46:54 INFO  ---RUNTIME: Original pipeline execution took 7289.596080780029 ms (excluding imports and monkey-patching)
2022-09-21 22:46:54 INFO  Starting execution of 1 what-if analyses...
2022-09-21 22:46:54 INFO  Start plan generation for analysis DataCorruption...
2022-09-21 22:46:54 INFO  ---RUNTIME: Plan generation took 0.43320655822753906 ms
2022-09-21 22:46:54 INFO  Estimated runtime of original DAG is 5435.254812240601ms
2022-09-21 22:46:54 INFO  Performing Multi-Query Optimization
2022-09-21 22:46:54 INFO  Estimated unoptimized what-if runtime is 135881.37030601501ms
2022-09-21 22:46:54 INFO  Estimated optimised what-if runtime is 13039.949178695679ms
2022-09-21 22:46:54 INFO  Estimated optimisation runtime saving is 122841.42112731934ms
2022-09-21 22:46:54 INFO  ---RUNTIME: Multi-Query Optimization took 59.76390838623047 ms
2022-09-21 22:46:54 INFO  Executing generated plans
2022-09-21 22:47:13 INFO  ---RUNTIME: Execution took 19862.706899642944 ms
2022-09-21 22:47:13 INFO  Done!
2022-09-21 22:47:13 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-21 22:47:13 INFO  Running instrumented original pipeline...
2022-09-21 22:47:14 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-21 22:47:14 INFO  ---RUNTIME: Importing and monkey-patching took 5.829572677612305 ms
2022-09-21 22:47:21 INFO  ---RUNTIME: Original pipeline execution took 7491.491317749023 ms (excluding imports and monkey-patching)
2022-09-21 22:47:21 INFO  Starting execution of 1 what-if analyses...
2022-09-21 22:47:21 INFO  Start plan generation for analysis DataCorruption...
2022-09-21 22:47:21 INFO  ---RUNTIME: Plan generation took 0.3986358642578125 ms
2022-09-21 22:47:21 INFO  Estimated runtime of original DAG is 5481.0826778411865ms
2022-09-21 22:47:21 WARNING Skipping Multi-Query Optimization (instead, only applying patches)
2022-09-21 22:47:21 INFO  Estimated unoptimised what-if runtime is 137027.06694602966ms
2022-09-21 22:47:21 INFO  ---RUNTIME: Multi-Query Optimization took 17.173051834106445 ms
2022-09-21 22:47:21 INFO  Executing generated plans
2022-09-21 22:50:20 INFO  ---RUNTIME: Execution took 179142.24481582642 ms
2022-09-21 22:50:20 INFO  Done!
2022-09-21 22:50:20 INFO  # Finished -- repetition 3 of 7 
2022-09-21 22:50:20 INFO  # Optimization benchmark for data_corruption with args [['reviews', 'fast_loading', 'featurization_0', 'xgboost']] -- repetition 4 of 7
2022-09-21 22:50:20 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-21 22:50:20 INFO  Running instrumented original pipeline...
2022-09-21 22:50:20 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-21 22:50:20 INFO  ---RUNTIME: Importing and monkey-patching took 5.963802337646484 ms
2022-09-21 22:50:27 INFO  ---RUNTIME: Original pipeline execution took 7253.216505050659 ms (excluding imports and monkey-patching)
2022-09-21 22:50:27 INFO  Starting execution of 1 what-if analyses...
2022-09-21 22:50:27 INFO  Start plan generation for analysis DataCorruption...
2022-09-21 22:50:27 INFO  ---RUNTIME: Plan generation took 0.38909912109375 ms
2022-09-21 22:50:27 INFO  Estimated runtime of original DAG is 5424.617767333984ms
2022-09-21 22:50:27 INFO  Performing Multi-Query Optimization
2022-09-21 22:50:27 INFO  Estimated unoptimized what-if runtime is 135615.4441833496ms
2022-09-21 22:50:27 INFO  Estimated optimised what-if runtime is 13147.40800857544ms
2022-09-21 22:50:27 INFO  Estimated optimisation runtime saving is 122468.03617477417ms
2022-09-21 22:50:27 INFO  ---RUNTIME: Multi-Query Optimization took 57.852983474731445 ms
2022-09-21 22:50:27 INFO  Executing generated plans
2022-09-21 22:50:47 INFO  ---RUNTIME: Execution took 19455.37495613098 ms
2022-09-21 22:50:47 INFO  Done!
2022-09-21 22:50:47 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-21 22:50:47 INFO  Running instrumented original pipeline...
2022-09-21 22:50:47 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-21 22:50:47 INFO  ---RUNTIME: Importing and monkey-patching took 5.652427673339844 ms
2022-09-21 22:50:54 INFO  ---RUNTIME: Original pipeline execution took 7275.398254394531 ms (excluding imports and monkey-patching)
2022-09-21 22:50:54 INFO  Starting execution of 1 what-if analyses...
2022-09-21 22:50:54 INFO  Start plan generation for analysis DataCorruption...
2022-09-21 22:50:54 INFO  ---RUNTIME: Plan generation took 0.41103363037109375 ms
2022-09-21 22:50:54 INFO  Estimated runtime of original DAG is 5501.966238021851ms
2022-09-21 22:50:54 WARNING Skipping Multi-Query Optimization (instead, only applying patches)
2022-09-21 22:50:54 INFO  Estimated unoptimised what-if runtime is 137549.15595054626ms
2022-09-21 22:50:54 INFO  ---RUNTIME: Multi-Query Optimization took 17.022132873535156 ms
2022-09-21 22:50:54 INFO  Executing generated plans
2022-09-21 22:54:01 INFO  ---RUNTIME: Execution took 186567.5663948059 ms
2022-09-21 22:54:01 INFO  Done!
2022-09-21 22:54:01 INFO  # Finished -- repetition 4 of 7 
2022-09-21 22:54:01 INFO  # Optimization benchmark for data_corruption with args [['reviews', 'fast_loading', 'featurization_0', 'xgboost']] -- repetition 5 of 7
2022-09-21 22:54:01 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-21 22:54:01 INFO  Running instrumented original pipeline...
2022-09-21 22:54:01 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-21 22:54:01 INFO  ---RUNTIME: Importing and monkey-patching took 5.8956146240234375 ms
2022-09-21 22:54:08 INFO  ---RUNTIME: Original pipeline execution took 7228.819370269775 ms (excluding imports and monkey-patching)
2022-09-21 22:54:08 INFO  Starting execution of 1 what-if analyses...
2022-09-21 22:54:08 INFO  Start plan generation for analysis DataCorruption...
2022-09-21 22:54:08 INFO  ---RUNTIME: Plan generation took 0.4124641418457031 ms
2022-09-21 22:54:08 INFO  Estimated runtime of original DAG is 5607.450008392334ms
2022-09-21 22:54:08 INFO  Performing Multi-Query Optimization
2022-09-21 22:54:08 INFO  Estimated unoptimized what-if runtime is 140186.25020980835ms
2022-09-21 22:54:08 INFO  Estimated optimised what-if runtime is 13332.196712493896ms
2022-09-21 22:54:08 INFO  Estimated optimisation runtime saving is 126854.05349731445ms
2022-09-21 22:54:08 INFO  ---RUNTIME: Multi-Query Optimization took 58.49909782409668 ms
2022-09-21 22:54:08 INFO  Executing generated plans
2022-09-21 22:54:28 INFO  ---RUNTIME: Execution took 19431.446075439453 ms
2022-09-21 22:54:28 INFO  Done!
2022-09-21 22:54:28 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-21 22:54:28 INFO  Running instrumented original pipeline...
2022-09-21 22:54:28 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-21 22:54:28 INFO  ---RUNTIME: Importing and monkey-patching took 6.05320930480957 ms
2022-09-21 22:54:35 INFO  ---RUNTIME: Original pipeline execution took 7255.656003952026 ms (excluding imports and monkey-patching)
2022-09-21 22:54:35 INFO  Starting execution of 1 what-if analyses...
2022-09-21 22:54:35 INFO  Start plan generation for analysis DataCorruption...
2022-09-21 22:54:35 INFO  ---RUNTIME: Plan generation took 0.39458274841308594 ms
2022-09-21 22:54:35 INFO  Estimated runtime of original DAG is 5598.6151695251465ms
2022-09-21 22:54:35 WARNING Skipping Multi-Query Optimization (instead, only applying patches)
2022-09-21 22:54:35 INFO  Estimated unoptimised what-if runtime is 139965.37923812866ms
2022-09-21 22:54:35 INFO  ---RUNTIME: Multi-Query Optimization took 16.948938369750977 ms
2022-09-21 22:54:35 INFO  Executing generated plans
2022-09-21 22:57:36 INFO  ---RUNTIME: Execution took 181112.44130134583 ms
2022-09-21 22:57:36 INFO  Done!
2022-09-21 22:57:36 INFO  # Finished -- repetition 5 of 7 
2022-09-21 22:57:36 INFO  # Optimization benchmark for data_corruption with args [['reviews', 'fast_loading', 'featurization_0', 'xgboost']] -- repetition 6 of 7
2022-09-21 22:57:36 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-21 22:57:36 INFO  Running instrumented original pipeline...
2022-09-21 22:57:36 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-21 22:57:36 INFO  ---RUNTIME: Importing and monkey-patching took 6.417512893676758 ms
2022-09-21 22:57:43 INFO  ---RUNTIME: Original pipeline execution took 7292.261123657227 ms (excluding imports and monkey-patching)
2022-09-21 22:57:43 INFO  Starting execution of 1 what-if analyses...
2022-09-21 22:57:43 INFO  Start plan generation for analysis DataCorruption...
2022-09-21 22:57:43 INFO  ---RUNTIME: Plan generation took 0.3991127014160156 ms
2022-09-21 22:57:43 INFO  Estimated runtime of original DAG is 5587.237358093262ms
2022-09-21 22:57:43 INFO  Performing Multi-Query Optimization
2022-09-21 22:57:43 INFO  Estimated unoptimized what-if runtime is 139680.93395233154ms
2022-09-21 22:57:43 INFO  Estimated optimised what-if runtime is 13318.041324615479ms
2022-09-21 22:57:43 INFO  Estimated optimisation runtime saving is 126362.89262771606ms
2022-09-21 22:57:43 INFO  ---RUNTIME: Multi-Query Optimization took 58.40611457824707 ms
2022-09-21 22:57:43 INFO  Executing generated plans
2022-09-21 22:58:03 INFO  ---RUNTIME: Execution took 19593.934535980225 ms
2022-09-21 22:58:03 INFO  Done!
2022-09-21 22:58:03 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-21 22:58:03 INFO  Running instrumented original pipeline...
2022-09-21 22:58:03 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-21 22:58:03 INFO  ---RUNTIME: Importing and monkey-patching took 6.429433822631836 ms
2022-09-21 22:58:14 INFO  ---RUNTIME: Original pipeline execution took 11042.314052581787 ms (excluding imports and monkey-patching)
2022-09-21 22:58:14 INFO  Starting execution of 1 what-if analyses...
2022-09-21 22:58:14 INFO  Start plan generation for analysis DataCorruption...
2022-09-21 22:58:14 INFO  ---RUNTIME: Plan generation took 0.40459632873535156 ms
2022-09-21 22:58:14 INFO  Estimated runtime of original DAG is 9043.10655593872ms
2022-09-21 22:58:14 WARNING Skipping Multi-Query Optimization (instead, only applying patches)
2022-09-21 22:58:14 INFO  Estimated unoptimised what-if runtime is 226077.66389846802ms
2022-09-21 22:58:14 INFO  ---RUNTIME: Multi-Query Optimization took 16.994714736938477 ms
2022-09-21 22:58:14 INFO  Executing generated plans
2022-09-21 23:01:11 INFO  ---RUNTIME: Execution took 177453.26256752014 ms
2022-09-21 23:01:11 INFO  Done!
2022-09-21 23:01:11 INFO  # Finished -- repetition 6 of 7 
2022-09-21 23:01:11 INFO  # Optimization benchmark for data_corruption with args [['reviews', 'fast_loading', 'featurization_0', 'xgboost']] -- repetition 7 of 7
2022-09-21 23:01:11 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-21 23:01:11 INFO  Running instrumented original pipeline...
2022-09-21 23:01:11 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-21 23:01:11 INFO  ---RUNTIME: Importing and monkey-patching took 6.256818771362305 ms
2022-09-21 23:01:19 INFO  ---RUNTIME: Original pipeline execution took 7246.603727340698 ms (excluding imports and monkey-patching)
2022-09-21 23:01:19 INFO  Starting execution of 1 what-if analyses...
2022-09-21 23:01:19 INFO  Start plan generation for analysis DataCorruption...
2022-09-21 23:01:19 INFO  ---RUNTIME: Plan generation took 0.41222572326660156 ms
2022-09-21 23:01:19 INFO  Estimated runtime of original DAG is 5571.859836578369ms
2022-09-21 23:01:19 INFO  Performing Multi-Query Optimization
2022-09-21 23:01:19 INFO  Estimated unoptimized what-if runtime is 139296.49591445923ms
2022-09-21 23:01:19 INFO  Estimated optimised what-if runtime is 13339.69521522522ms
2022-09-21 23:01:19 INFO  Estimated optimisation runtime saving is 125956.80069923401ms
2022-09-21 23:01:19 INFO  ---RUNTIME: Multi-Query Optimization took 57.58190155029297 ms
2022-09-21 23:01:19 INFO  Executing generated plans
2022-09-21 23:01:38 INFO  ---RUNTIME: Execution took 19246.331691741943 ms
2022-09-21 23:01:38 INFO  Done!
2022-09-21 23:01:38 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-21 23:01:38 INFO  Running instrumented original pipeline...
2022-09-21 23:01:38 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-21 23:01:38 INFO  ---RUNTIME: Importing and monkey-patching took 6.056070327758789 ms
2022-09-21 23:01:46 INFO  ---RUNTIME: Original pipeline execution took 7515.1801109313965 ms (excluding imports and monkey-patching)
2022-09-21 23:01:46 INFO  Starting execution of 1 what-if analyses...
2022-09-21 23:01:46 INFO  Start plan generation for analysis DataCorruption...
2022-09-21 23:01:46 INFO  ---RUNTIME: Plan generation took 0.4019737243652344 ms
2022-09-21 23:01:46 INFO  Estimated runtime of original DAG is 5760.30969619751ms
2022-09-21 23:01:46 WARNING Skipping Multi-Query Optimization (instead, only applying patches)
2022-09-21 23:01:46 INFO  Estimated unoptimised what-if runtime is 144007.74240493774ms
2022-09-21 23:01:46 INFO  ---RUNTIME: Multi-Query Optimization took 17.673730850219727 ms
2022-09-21 23:01:46 INFO  Executing generated plans
2022-09-21 23:04:47 INFO  ---RUNTIME: Execution took 181277.0335674286 ms
2022-09-21 23:04:47 INFO  Done!
2022-09-21 23:04:47 INFO  # Finished -- repetition 7 of 7 
2022-09-21 23:04:47 INFO  # Final results after all repetitions
2022-09-21 23:04:47 INFO     repetition  ... no_opt_what_if_execution_combined_model_training
0           0  ...                                     19853.022099
1           1  ...                                     18834.856987
2           2  ...                                     18024.069786
3           3  ...                                     24999.235153
4           4  ...                                     22622.784853
5           5  ...                                     20498.586893
6           6  ...                                     21636.934996

[7 rows x 26 columns]
taskset -c 32-39 PROTOCOL_BUFFERS_PYTHON_IMPLEMENTATION=python python3.9 benchmarks_end_to_end.py data_corruption reviews fast_loading featurization_0 neural_network
2022-09-21 23:04:49.530718: W tensorflow/stream_executor/platform/default/dso_loader.cc:64] Could not load dynamic library 'libcudart.so.11.0'; dlerror: libcudart.so.11.0: cannot open shared object file: No such file or directory; LD_LIBRARY_PATH: /home/sgrafbe/mlwhatif/venv/lib/python3.9/site-packages/cv2/../../lib64:
2022-09-21 23:04:49.530765: I tensorflow/stream_executor/cuda/cudart_stub.cc:29] Ignore above cudart dlerror if you do not have a GPU set up on your machine.
2022-09-21 23:04:50 INFO  Patching sys.argv with ['mlwhatif', 'reviews', 'fast_loading', 'featurization_0', 'neural_network']
2022-09-21 23:04:50 INFO  Running instrumented original pipeline...
2022-09-21 23:04:50 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-21 23:04:50 INFO  ---RUNTIME: Importing and monkey-patching took 122.04384803771973 ms
2022-09-21 23:04:56.114484: W tensorflow/stream_executor/platform/default/dso_loader.cc:64] Could not load dynamic library 'libcuda.so.1'; dlerror: libcuda.so.1: cannot open shared object file: No such file or directory; LD_LIBRARY_PATH: /home/sgrafbe/mlwhatif/venv/lib/python3.9/site-packages/cv2/../../lib64:
2022-09-21 23:04:56.114522: W tensorflow/stream_executor/cuda/cuda_driver.cc:326] failed call to cuInit: UNKNOWN ERROR (303)
2022-09-21 23:04:56.114545: I tensorflow/stream_executor/cuda/cuda_diagnostics.cc:156] kernel driver does not appear to be running on this host (angus): /proc/driver/nvidia/version does not exist
2022-09-21 23:04:56.115038: I tensorflow/core/platform/cpu_feature_guard.cc:142] This TensorFlow binary is optimized with oneAPI Deep Neural Network Library (oneDNN) to use the following CPU instructions in performance-critical operations:  AVX2 FMA
To enable them in other operations, rebuild TensorFlow with the appropriate compiler flags.
2022-09-21 23:04:56.350588: I tensorflow/compiler/mlir/mlir_graph_optimization_pass.cc:176] None of the MLIR Optimization Passes are enabled (registered 2)
2022-09-21 23:04:56.362199: I tensorflow/core/platform/profile_utils/cpu_utils.cc:114] CPU Frequency: 2595130000 Hz
2022-09-21 23:05:01 INFO  ---RUNTIME: Original pipeline execution took 10485.805749893188 ms (excluding imports and monkey-patching)
2022-09-21 23:05:01 INFO  Starting execution of 0 what-if analyses...
2022-09-21 23:05:01 INFO  Estimated runtime of original DAG is 8752.474784851074ms
2022-09-21 23:05:01 INFO  Performing Multi-Query Optimization
2022-09-21 23:05:01 INFO  Estimated unoptimized what-if runtime is 0ms
2022-09-21 23:05:01 INFO  Estimated optimised what-if runtime is 0ms
2022-09-21 23:05:01 INFO  Estimated optimisation runtime saving is 0ms
2022-09-21 23:05:01 INFO  ---RUNTIME: Multi-Query Optimization took 0.5118846893310547 ms
2022-09-21 23:05:01 INFO  Executing generated plans
2022-09-21 23:05:01 INFO  ---RUNTIME: Execution took 0.03266334533691406 ms
2022-09-21 23:05:01 INFO  Done!
2022-09-21 23:05:01 INFO  # Optimization benchmark for data_corruption with args [['reviews', 'fast_loading', 'featurization_0', 'neural_network']] -- repetition 1 of 7
2022-09-21 23:05:01 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-21 23:05:01 INFO  Running instrumented original pipeline...
2022-09-21 23:05:01 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-21 23:05:01 INFO  ---RUNTIME: Importing and monkey-patching took 6.070137023925781 ms
2022-09-21 23:05:11 INFO  ---RUNTIME: Original pipeline execution took 10290.451049804688 ms (excluding imports and monkey-patching)
2022-09-21 23:05:11 INFO  Starting execution of 1 what-if analyses...
2022-09-21 23:05:11 INFO  Start plan generation for analysis DataCorruption...
2022-09-21 23:05:11 INFO  ---RUNTIME: Plan generation took 0.5114078521728516 ms
2022-09-21 23:05:11 INFO  Estimated runtime of original DAG is 8622.933626174927ms
2022-09-21 23:05:11 INFO  Performing Multi-Query Optimization
2022-09-21 23:05:11 INFO  Estimated unoptimized what-if runtime is 215573.34065437317ms
2022-09-21 23:05:11 INFO  Estimated optimised what-if runtime is 26527.44722366333ms
2022-09-21 23:05:11 INFO  Estimated optimisation runtime saving is 189045.89343070984ms
2022-09-21 23:05:11 INFO  ---RUNTIME: Multi-Query Optimization took 62.09158897399902 ms
2022-09-21 23:05:11 INFO  Executing generated plans
2022-09-21 23:05:42 INFO  ---RUNTIME: Execution took 31059.47756767273 ms
2022-09-21 23:05:42 INFO  Done!
2022-09-21 23:05:42 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-21 23:05:42 INFO  Running instrumented original pipeline...
2022-09-21 23:05:42 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-21 23:05:42 INFO  ---RUNTIME: Importing and monkey-patching took 6.477832794189453 ms
2022-09-21 23:05:53 INFO  ---RUNTIME: Original pipeline execution took 10151.848793029785 ms (excluding imports and monkey-patching)
2022-09-21 23:05:53 INFO  Starting execution of 1 what-if analyses...
2022-09-21 23:05:53 INFO  Start plan generation for analysis DataCorruption...
2022-09-21 23:05:53 INFO  ---RUNTIME: Plan generation took 0.4336833953857422 ms
2022-09-21 23:05:53 INFO  Estimated runtime of original DAG is 8514.55044746399ms
2022-09-21 23:05:53 WARNING Skipping Multi-Query Optimization (instead, only applying patches)
2022-09-21 23:05:53 INFO  Estimated unoptimised what-if runtime is 212863.76118659973ms
2022-09-21 23:05:53 INFO  ---RUNTIME: Multi-Query Optimization took 18.501758575439453 ms
2022-09-21 23:05:53 INFO  Executing generated plans
2022-09-21 23:10:05 INFO  ---RUNTIME: Execution took 252550.5712032318 ms
2022-09-21 23:10:05 INFO  Done!
2022-09-21 23:10:05 INFO  # Finished -- repetition 1 of 7 
2022-09-21 23:10:05 INFO  # Optimization benchmark for data_corruption with args [['reviews', 'fast_loading', 'featurization_0', 'neural_network']] -- repetition 2 of 7
2022-09-21 23:10:05 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-21 23:10:05 INFO  Running instrumented original pipeline...
2022-09-21 23:10:05 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-21 23:10:05 INFO  ---RUNTIME: Importing and monkey-patching took 6.0577392578125 ms
2022-09-21 23:10:15 INFO  ---RUNTIME: Original pipeline execution took 10210.484981536865 ms (excluding imports and monkey-patching)
2022-09-21 23:10:15 INFO  Starting execution of 1 what-if analyses...
2022-09-21 23:10:15 INFO  Start plan generation for analysis DataCorruption...
2022-09-21 23:10:15 INFO  ---RUNTIME: Plan generation took 0.4513263702392578 ms
2022-09-21 23:10:15 INFO  Estimated runtime of original DAG is 8553.654909133911ms
2022-09-21 23:10:15 INFO  Performing Multi-Query Optimization
2022-09-21 23:10:15 INFO  Estimated unoptimized what-if runtime is 213841.37272834778ms
2022-09-21 23:10:15 INFO  Estimated optimised what-if runtime is 26642.22741127014ms
2022-09-21 23:10:15 INFO  Estimated optimisation runtime saving is 187199.14531707764ms
2022-09-21 23:10:15 INFO  ---RUNTIME: Multi-Query Optimization took 65.47045707702637 ms
2022-09-21 23:10:15 INFO  Executing generated plans
2022-09-21 23:10:46 INFO  ---RUNTIME: Execution took 30731.346607208252 ms
2022-09-21 23:10:46 INFO  Done!
2022-09-21 23:10:46 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-21 23:10:46 INFO  Running instrumented original pipeline...
2022-09-21 23:10:46 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-21 23:10:46 INFO  ---RUNTIME: Importing and monkey-patching took 5.927085876464844 ms
2022-09-21 23:10:57 INFO  ---RUNTIME: Original pipeline execution took 10593.039512634277 ms (excluding imports and monkey-patching)
2022-09-21 23:10:57 INFO  Starting execution of 1 what-if analyses...
2022-09-21 23:10:57 INFO  Start plan generation for analysis DataCorruption...
2022-09-21 23:10:57 INFO  ---RUNTIME: Plan generation took 2.207040786743164 ms
2022-09-21 23:10:57 INFO  Estimated runtime of original DAG is 8959.478855133057ms
2022-09-21 23:10:57 WARNING Skipping Multi-Query Optimization (instead, only applying patches)
2022-09-21 23:10:57 INFO  Estimated unoptimised what-if runtime is 223986.97137832642ms
2022-09-21 23:10:57 INFO  ---RUNTIME: Multi-Query Optimization took 17.878055572509766 ms
2022-09-21 23:10:57 INFO  Executing generated plans
2022-09-21 23:15:10 INFO  ---RUNTIME: Execution took 253233.33144187927 ms
2022-09-21 23:15:10 INFO  Done!
2022-09-21 23:15:10 INFO  # Finished -- repetition 2 of 7 
2022-09-21 23:15:10 INFO  # Optimization benchmark for data_corruption with args [['reviews', 'fast_loading', 'featurization_0', 'neural_network']] -- repetition 3 of 7
2022-09-21 23:15:10 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-21 23:15:10 INFO  Running instrumented original pipeline...
2022-09-21 23:15:10 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-21 23:15:10 INFO  ---RUNTIME: Importing and monkey-patching took 6.479024887084961 ms
2022-09-21 23:15:20 INFO  ---RUNTIME: Original pipeline execution took 10257.887363433838 ms (excluding imports and monkey-patching)
2022-09-21 23:15:20 INFO  Starting execution of 1 what-if analyses...
2022-09-21 23:15:20 INFO  Start plan generation for analysis DataCorruption...
2022-09-21 23:15:20 INFO  ---RUNTIME: Plan generation took 0.4355907440185547 ms
2022-09-21 23:15:20 INFO  Estimated runtime of original DAG is 8608.635663986206ms
2022-09-21 23:15:20 INFO  Performing Multi-Query Optimization
2022-09-21 23:15:20 INFO  Estimated unoptimized what-if runtime is 215215.89159965515ms
2022-09-21 23:15:20 INFO  Estimated optimised what-if runtime is 25969.18749809265ms
2022-09-21 23:15:20 INFO  Estimated optimisation runtime saving is 189246.7041015625ms
2022-09-21 23:15:20 INFO  ---RUNTIME: Multi-Query Optimization took 62.9878044128418 ms
2022-09-21 23:15:20 INFO  Executing generated plans
2022-09-21 23:15:51 INFO  ---RUNTIME: Execution took 30853.986501693726 ms
2022-09-21 23:15:51 INFO  Done!
2022-09-21 23:15:51 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-21 23:15:51 INFO  Running instrumented original pipeline...
2022-09-21 23:15:51 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-21 23:15:51 INFO  ---RUNTIME: Importing and monkey-patching took 6.012201309204102 ms
2022-09-21 23:16:01 INFO  ---RUNTIME: Original pipeline execution took 10231.931209564209 ms (excluding imports and monkey-patching)
2022-09-21 23:16:01 INFO  Starting execution of 1 what-if analyses...
2022-09-21 23:16:01 INFO  Start plan generation for analysis DataCorruption...
2022-09-21 23:16:01 INFO  ---RUNTIME: Plan generation took 0.4189014434814453 ms
2022-09-21 23:16:01 INFO  Estimated runtime of original DAG is 8565.941333770752ms
2022-09-21 23:16:01 WARNING Skipping Multi-Query Optimization (instead, only applying patches)
2022-09-21 23:16:01 INFO  Estimated unoptimised what-if runtime is 214148.5333442688ms
2022-09-21 23:16:01 INFO  ---RUNTIME: Multi-Query Optimization took 17.642974853515625 ms
2022-09-21 23:16:01 INFO  Executing generated plans
2022-09-21 23:20:14 INFO  ---RUNTIME: Execution took 252630.69987297058 ms
2022-09-21 23:20:14 INFO  Done!
2022-09-21 23:20:14 INFO  # Finished -- repetition 3 of 7 
2022-09-21 23:20:14 INFO  # Optimization benchmark for data_corruption with args [['reviews', 'fast_loading', 'featurization_0', 'neural_network']] -- repetition 4 of 7
2022-09-21 23:20:14 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-21 23:20:14 INFO  Running instrumented original pipeline...
2022-09-21 23:20:14 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-21 23:20:14 INFO  ---RUNTIME: Importing and monkey-patching took 6.356477737426758 ms
2022-09-21 23:20:24 INFO  ---RUNTIME: Original pipeline execution took 10173.962831497192 ms (excluding imports and monkey-patching)
2022-09-21 23:20:24 INFO  Starting execution of 1 what-if analyses...
2022-09-21 23:20:24 INFO  Start plan generation for analysis DataCorruption...
2022-09-21 23:20:24 INFO  ---RUNTIME: Plan generation took 0.3955364227294922 ms
2022-09-21 23:20:24 INFO  Estimated runtime of original DAG is 8518.646001815796ms
2022-09-21 23:20:24 INFO  Performing Multi-Query Optimization
2022-09-21 23:20:24 INFO  Estimated unoptimized what-if runtime is 212966.1500453949ms
2022-09-21 23:20:24 INFO  Estimated optimised what-if runtime is 24926.361322402954ms
2022-09-21 23:20:24 INFO  Estimated optimisation runtime saving is 188039.78872299194ms
2022-09-21 23:20:24 INFO  ---RUNTIME: Multi-Query Optimization took 57.44576454162598 ms
2022-09-21 23:20:24 INFO  Executing generated plans
2022-09-21 23:20:55 INFO  ---RUNTIME: Execution took 30631.43229484558 ms
2022-09-21 23:20:55 INFO  Done!
2022-09-21 23:20:55 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-21 23:20:55 INFO  Running instrumented original pipeline...
2022-09-21 23:20:55 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-21 23:20:55 INFO  ---RUNTIME: Importing and monkey-patching took 5.9375762939453125 ms
2022-09-21 23:21:05 INFO  ---RUNTIME: Original pipeline execution took 10228.095531463623 ms (excluding imports and monkey-patching)
2022-09-21 23:21:05 INFO  Starting execution of 1 what-if analyses...
2022-09-21 23:21:05 INFO  Start plan generation for analysis DataCorruption...
2022-09-21 23:21:05 INFO  ---RUNTIME: Plan generation took 0.40221214294433594 ms
2022-09-21 23:21:05 INFO  Estimated runtime of original DAG is 8535.149335861206ms
2022-09-21 23:21:05 WARNING Skipping Multi-Query Optimization (instead, only applying patches)
2022-09-21 23:21:05 INFO  Estimated unoptimised what-if runtime is 213378.73339653015ms
2022-09-21 23:21:05 INFO  ---RUNTIME: Multi-Query Optimization took 17.387866973876953 ms
2022-09-21 23:21:05 INFO  Executing generated plans
2022-09-21 23:25:17 INFO  ---RUNTIME: Execution took 251609.82012748718 ms
2022-09-21 23:25:17 INFO  Done!
2022-09-21 23:25:17 INFO  # Finished -- repetition 4 of 7 
2022-09-21 23:25:17 INFO  # Optimization benchmark for data_corruption with args [['reviews', 'fast_loading', 'featurization_0', 'neural_network']] -- repetition 5 of 7
2022-09-21 23:25:17 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-21 23:25:17 INFO  Running instrumented original pipeline...
2022-09-21 23:25:17 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-21 23:25:17 INFO  ---RUNTIME: Importing and monkey-patching took 6.649494171142578 ms
2022-09-21 23:25:27 INFO  ---RUNTIME: Original pipeline execution took 10582.378149032593 ms (excluding imports and monkey-patching)
2022-09-21 23:25:27 INFO  Starting execution of 1 what-if analyses...
2022-09-21 23:25:27 INFO  Start plan generation for analysis DataCorruption...
2022-09-21 23:25:27 INFO  ---RUNTIME: Plan generation took 0.45561790466308594 ms
2022-09-21 23:25:27 INFO  Estimated runtime of original DAG is 8954.518556594849ms
2022-09-21 23:25:27 INFO  Performing Multi-Query Optimization
2022-09-21 23:25:27 INFO  Estimated unoptimized what-if runtime is 223862.96391487122ms
2022-09-21 23:25:27 INFO  Estimated optimised what-if runtime is 26301.634550094604ms
2022-09-21 23:25:27 INFO  Estimated optimisation runtime saving is 197561.3293647766ms
2022-09-21 23:25:27 INFO  ---RUNTIME: Multi-Query Optimization took 62.77036666870117 ms
2022-09-21 23:25:27 INFO  Executing generated plans
2022-09-21 23:25:58 INFO  ---RUNTIME: Execution took 30336.503744125366 ms
2022-09-21 23:25:58 INFO  Done!
2022-09-21 23:25:58 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-21 23:25:58 INFO  Running instrumented original pipeline...
2022-09-21 23:25:58 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-21 23:25:58 INFO  ---RUNTIME: Importing and monkey-patching took 5.870580673217773 ms
2022-09-21 23:26:08 INFO  ---RUNTIME: Original pipeline execution took 10267.329931259155 ms (excluding imports and monkey-patching)
2022-09-21 23:26:08 INFO  Starting execution of 1 what-if analyses...
2022-09-21 23:26:08 INFO  Start plan generation for analysis DataCorruption...
2022-09-21 23:26:08 INFO  ---RUNTIME: Plan generation took 0.44417381286621094 ms
2022-09-21 23:26:08 INFO  Estimated runtime of original DAG is 8623.199462890625ms
2022-09-21 23:26:08 WARNING Skipping Multi-Query Optimization (instead, only applying patches)
2022-09-21 23:26:08 INFO  Estimated unoptimised what-if runtime is 215579.98657226562ms
2022-09-21 23:26:08 INFO  ---RUNTIME: Multi-Query Optimization took 17.166614532470703 ms
2022-09-21 23:26:08 INFO  Executing generated plans
2022-09-21 23:30:19 INFO  ---RUNTIME: Execution took 251072.27396965027 ms
2022-09-21 23:30:19 INFO  Done!
2022-09-21 23:30:19 INFO  # Finished -- repetition 5 of 7 
2022-09-21 23:30:19 INFO  # Optimization benchmark for data_corruption with args [['reviews', 'fast_loading', 'featurization_0', 'neural_network']] -- repetition 6 of 7
2022-09-21 23:30:19 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-21 23:30:19 INFO  Running instrumented original pipeline...
2022-09-21 23:30:19 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-21 23:30:19 INFO  ---RUNTIME: Importing and monkey-patching took 6.811380386352539 ms
2022-09-21 23:30:29 INFO  ---RUNTIME: Original pipeline execution took 10070.548057556152 ms (excluding imports and monkey-patching)
2022-09-21 23:30:29 INFO  Starting execution of 1 what-if analyses...
2022-09-21 23:30:29 INFO  Start plan generation for analysis DataCorruption...
2022-09-21 23:30:29 INFO  ---RUNTIME: Plan generation took 0.46896934509277344 ms
2022-09-21 23:30:29 INFO  Estimated runtime of original DAG is 8417.0982837677ms
2022-09-21 23:30:29 INFO  Performing Multi-Query Optimization
2022-09-21 23:30:29 INFO  Estimated unoptimized what-if runtime is 210427.4570941925ms
2022-09-21 23:30:29 INFO  Estimated optimised what-if runtime is 25773.06318283081ms
2022-09-21 23:30:29 INFO  Estimated optimisation runtime saving is 184654.3939113617ms
2022-09-21 23:30:29 INFO  ---RUNTIME: Multi-Query Optimization took 64.50271606445312 ms
2022-09-21 23:30:29 INFO  Executing generated plans
2022-09-21 23:31:01 INFO  ---RUNTIME: Execution took 31198.30369949341 ms
2022-09-21 23:31:01 INFO  Done!
2022-09-21 23:31:01 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-21 23:31:01 INFO  Running instrumented original pipeline...
2022-09-21 23:31:01 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-21 23:31:01 INFO  ---RUNTIME: Importing and monkey-patching took 6.523370742797852 ms
2022-09-21 23:31:11 INFO  ---RUNTIME: Original pipeline execution took 10280.690431594849 ms (excluding imports and monkey-patching)
2022-09-21 23:31:11 INFO  Starting execution of 1 what-if analyses...
2022-09-21 23:31:11 INFO  Start plan generation for analysis DataCorruption...
2022-09-21 23:31:11 INFO  ---RUNTIME: Plan generation took 2.2771358489990234 ms
2022-09-21 23:31:11 INFO  Estimated runtime of original DAG is 8630.623579025269ms
2022-09-21 23:31:11 WARNING Skipping Multi-Query Optimization (instead, only applying patches)
2022-09-21 23:31:11 INFO  Estimated unoptimised what-if runtime is 215765.5894756317ms
2022-09-21 23:31:11 INFO  ---RUNTIME: Multi-Query Optimization took 16.767263412475586 ms
2022-09-21 23:31:11 INFO  Executing generated plans
2022-09-21 23:35:14 INFO  ---RUNTIME: Execution took 243541.5825843811 ms
2022-09-21 23:35:14 INFO  Done!
2022-09-21 23:35:14 INFO  # Finished -- repetition 6 of 7 
2022-09-21 23:35:14 INFO  # Optimization benchmark for data_corruption with args [['reviews', 'fast_loading', 'featurization_0', 'neural_network']] -- repetition 7 of 7
2022-09-21 23:35:14 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-21 23:35:14 INFO  Running instrumented original pipeline...
2022-09-21 23:35:14 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-21 23:35:14 INFO  ---RUNTIME: Importing and monkey-patching took 6.6680908203125 ms
2022-09-21 23:35:24 INFO  ---RUNTIME: Original pipeline execution took 9931.583404541016 ms (excluding imports and monkey-patching)
2022-09-21 23:35:24 INFO  Starting execution of 1 what-if analyses...
2022-09-21 23:35:24 INFO  Start plan generation for analysis DataCorruption...
2022-09-21 23:35:24 INFO  ---RUNTIME: Plan generation took 0.41103363037109375 ms
2022-09-21 23:35:24 INFO  Estimated runtime of original DAG is 8268.561363220215ms
2022-09-21 23:35:24 INFO  Performing Multi-Query Optimization
2022-09-21 23:35:24 INFO  Estimated unoptimized what-if runtime is 206714.03408050537ms
2022-09-21 23:35:24 INFO  Estimated optimised what-if runtime is 25004.502773284912ms
2022-09-21 23:35:24 INFO  Estimated optimisation runtime saving is 181709.53130722046ms
2022-09-21 23:35:24 INFO  ---RUNTIME: Multi-Query Optimization took 58.36200714111328 ms
2022-09-21 23:35:24 INFO  Executing generated plans
2022-09-21 23:35:54 INFO  ---RUNTIME: Execution took 29600.17967224121 ms
2022-09-21 23:35:54 INFO  Done!
2022-09-21 23:35:54 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-21 23:35:54 INFO  Running instrumented original pipeline...
2022-09-21 23:35:54 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-21 23:35:54 INFO  ---RUNTIME: Importing and monkey-patching took 5.887508392333984 ms
2022-09-21 23:36:04 INFO  ---RUNTIME: Original pipeline execution took 10355.625629425049 ms (excluding imports and monkey-patching)
2022-09-21 23:36:04 INFO  Starting execution of 1 what-if analyses...
2022-09-21 23:36:04 INFO  Start plan generation for analysis DataCorruption...
2022-09-21 23:36:04 INFO  ---RUNTIME: Plan generation took 0.38170814514160156 ms
2022-09-21 23:36:04 INFO  Estimated runtime of original DAG is 8265.712976455688ms
2022-09-21 23:36:04 WARNING Skipping Multi-Query Optimization (instead, only applying patches)
2022-09-21 23:36:04 INFO  Estimated unoptimised what-if runtime is 206642.8244113922ms
2022-09-21 23:36:04 INFO  ---RUNTIME: Multi-Query Optimization took 17.375469207763672 ms
2022-09-21 23:36:04 INFO  Executing generated plans
2022-09-21 23:40:06 INFO  ---RUNTIME: Execution took 242055.02223968506 ms
2022-09-21 23:40:06 INFO  Done!
2022-09-21 23:40:06 INFO  # Finished -- repetition 7 of 7 
2022-09-21 23:40:06 INFO  # Final results after all repetitions
2022-09-21 23:40:06 INFO     repetition  ... no_opt_what_if_execution_combined_model_training
0           0  ...                                     86067.648411
1           1  ...                                     86484.588861
2           2  ...                                     86537.172079
3           3  ...                                     86046.463013
4           4  ...                                     84899.758816
5           5  ...                                     81951.229572
6           6  ...                                     79650.995493

[7 rows x 26 columns]
taskset -c 32-39 PROTOCOL_BUFFERS_PYTHON_IMPLEMENTATION=python python3.9 benchmarks_end_to_end.py data_corruption reviews fast_loading featurization_1 logistic_regression
2022-09-21 23:40:09.301777: W tensorflow/stream_executor/platform/default/dso_loader.cc:64] Could not load dynamic library 'libcudart.so.11.0'; dlerror: libcudart.so.11.0: cannot open shared object file: No such file or directory; LD_LIBRARY_PATH: /home/sgrafbe/mlwhatif/venv/lib/python3.9/site-packages/cv2/../../lib64:
2022-09-21 23:40:09.301824: I tensorflow/stream_executor/cuda/cudart_stub.cc:29] Ignore above cudart dlerror if you do not have a GPU set up on your machine.
2022-09-21 23:40:10 INFO  Patching sys.argv with ['mlwhatif', 'reviews', 'fast_loading', 'featurization_1', 'logistic_regression']
2022-09-21 23:40:10 INFO  Running instrumented original pipeline...
2022-09-21 23:40:10 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-21 23:40:10 INFO  ---RUNTIME: Importing and monkey-patching took 122.38836288452148 ms
2022-09-21 23:40:17 INFO  ---RUNTIME: Original pipeline execution took 7131.303071975708 ms (excluding imports and monkey-patching)
2022-09-21 23:40:17 INFO  Starting execution of 0 what-if analyses...
2022-09-21 23:40:17 INFO  Estimated runtime of original DAG is 4889.415502548218ms
2022-09-21 23:40:17 INFO  Performing Multi-Query Optimization
2022-09-21 23:40:17 INFO  Estimated unoptimized what-if runtime is 0ms
2022-09-21 23:40:17 INFO  Estimated optimised what-if runtime is 0ms
2022-09-21 23:40:17 INFO  Estimated optimisation runtime saving is 0ms
2022-09-21 23:40:17 INFO  ---RUNTIME: Multi-Query Optimization took 0.4901885986328125 ms
2022-09-21 23:40:17 INFO  Executing generated plans
2022-09-21 23:40:17 INFO  ---RUNTIME: Execution took 0.026226043701171875 ms
2022-09-21 23:40:17 INFO  Done!
2022-09-21 23:40:17 INFO  # Optimization benchmark for data_corruption with args [['reviews', 'fast_loading', 'featurization_1', 'logistic_regression']] -- repetition 1 of 7
2022-09-21 23:40:17 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-21 23:40:17 INFO  Running instrumented original pipeline...
2022-09-21 23:40:18 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-21 23:40:18 INFO  ---RUNTIME: Importing and monkey-patching took 6.149530410766602 ms
2022-09-21 23:40:25 INFO  ---RUNTIME: Original pipeline execution took 7253.150224685669 ms (excluding imports and monkey-patching)
2022-09-21 23:40:25 INFO  Starting execution of 1 what-if analyses...
2022-09-21 23:40:25 INFO  Start plan generation for analysis DataCorruption...
2022-09-21 23:40:25 INFO  ---RUNTIME: Plan generation took 0.5371570587158203 ms
2022-09-21 23:40:25 INFO  Estimated runtime of original DAG is 4815.965414047241ms
2022-09-21 23:40:25 INFO  Performing Multi-Query Optimization
2022-09-21 23:40:25 INFO  Estimated unoptimized what-if runtime is 120399.13535118103ms
2022-09-21 23:40:25 INFO  Estimated optimised what-if runtime is 11490.230321884155ms
2022-09-21 23:40:25 INFO  Estimated optimisation runtime saving is 108908.90502929688ms
2022-09-21 23:40:25 INFO  ---RUNTIME: Multi-Query Optimization took 62.3018741607666 ms
2022-09-21 23:40:25 INFO  Executing generated plans
2022-09-21 23:40:42 INFO  ---RUNTIME: Execution took 17545.14241218567 ms
2022-09-21 23:40:42 INFO  Done!
2022-09-21 23:40:42 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-21 23:40:42 INFO  Running instrumented original pipeline...
2022-09-21 23:40:42 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-21 23:40:42 INFO  ---RUNTIME: Importing and monkey-patching took 6.157398223876953 ms
2022-09-21 23:40:49 INFO  ---RUNTIME: Original pipeline execution took 7045.0708866119385 ms (excluding imports and monkey-patching)
2022-09-21 23:40:49 INFO  Starting execution of 1 what-if analyses...
2022-09-21 23:40:49 INFO  Start plan generation for analysis DataCorruption...
2022-09-21 23:40:49 INFO  ---RUNTIME: Plan generation took 0.5619525909423828 ms
2022-09-21 23:40:49 INFO  Estimated runtime of original DAG is 4859.568119049072ms
2022-09-21 23:40:49 WARNING Skipping Multi-Query Optimization (instead, only applying patches)
2022-09-21 23:40:49 INFO  Estimated unoptimised what-if runtime is 121489.2029762268ms
2022-09-21 23:40:49 INFO  ---RUNTIME: Multi-Query Optimization took 39.19076919555664 ms
2022-09-21 23:40:49 INFO  Executing generated plans
2022-09-21 23:43:26 INFO  ---RUNTIME: Execution took 156318.99166107178 ms
2022-09-21 23:43:26 INFO  Done!
2022-09-21 23:43:26 INFO  # Finished -- repetition 1 of 7 
2022-09-21 23:43:26 INFO  # Optimization benchmark for data_corruption with args [['reviews', 'fast_loading', 'featurization_1', 'logistic_regression']] -- repetition 2 of 7
2022-09-21 23:43:26 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-21 23:43:26 INFO  Running instrumented original pipeline...
2022-09-21 23:43:26 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-21 23:43:26 INFO  ---RUNTIME: Importing and monkey-patching took 6.1511993408203125 ms
2022-09-21 23:43:33 INFO  ---RUNTIME: Original pipeline execution took 7095.481634140015 ms (excluding imports and monkey-patching)
2022-09-21 23:43:33 INFO  Starting execution of 1 what-if analyses...
2022-09-21 23:43:33 INFO  Start plan generation for analysis DataCorruption...
2022-09-21 23:43:33 INFO  ---RUNTIME: Plan generation took 0.5257129669189453 ms
2022-09-21 23:43:33 INFO  Estimated runtime of original DAG is 4891.990661621094ms
2022-09-21 23:43:33 INFO  Performing Multi-Query Optimization
2022-09-21 23:43:33 INFO  Estimated unoptimized what-if runtime is 122299.76654052734ms
2022-09-21 23:43:33 INFO  Estimated optimised what-if runtime is 11546.02074623108ms
2022-09-21 23:43:33 INFO  Estimated optimisation runtime saving is 110753.74579429626ms
2022-09-21 23:43:33 INFO  ---RUNTIME: Multi-Query Optimization took 62.522172927856445 ms
2022-09-21 23:43:33 INFO  Executing generated plans
2022-09-21 23:43:50 INFO  ---RUNTIME: Execution took 17427.703857421875 ms
2022-09-21 23:43:50 INFO  Done!
2022-09-21 23:43:50 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-21 23:43:50 INFO  Running instrumented original pipeline...
2022-09-21 23:43:50 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-21 23:43:50 INFO  ---RUNTIME: Importing and monkey-patching took 6.157398223876953 ms
2022-09-21 23:43:57 INFO  ---RUNTIME: Original pipeline execution took 7176.679611206055 ms (excluding imports and monkey-patching)
2022-09-21 23:43:57 INFO  Starting execution of 1 what-if analyses...
2022-09-21 23:43:57 INFO  Start plan generation for analysis DataCorruption...
2022-09-21 23:43:57 INFO  ---RUNTIME: Plan generation took 0.5147457122802734 ms
2022-09-21 23:43:57 INFO  Estimated runtime of original DAG is 4959.3505859375ms
2022-09-21 23:43:57 WARNING Skipping Multi-Query Optimization (instead, only applying patches)
2022-09-21 23:43:57 INFO  Estimated unoptimised what-if runtime is 123983.7646484375ms
2022-09-21 23:43:57 INFO  ---RUNTIME: Multi-Query Optimization took 18.23115348815918 ms
2022-09-21 23:43:57 INFO  Executing generated plans
2022-09-21 23:46:34 INFO  ---RUNTIME: Execution took 156858.3881855011 ms
2022-09-21 23:46:34 INFO  Done!
2022-09-21 23:46:34 INFO  # Finished -- repetition 2 of 7 
2022-09-21 23:46:34 INFO  # Optimization benchmark for data_corruption with args [['reviews', 'fast_loading', 'featurization_1', 'logistic_regression']] -- repetition 3 of 7
2022-09-21 23:46:34 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-21 23:46:34 INFO  Running instrumented original pipeline...
2022-09-21 23:46:34 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-21 23:46:34 INFO  ---RUNTIME: Importing and monkey-patching took 6.130695343017578 ms
2022-09-21 23:46:41 INFO  ---RUNTIME: Original pipeline execution took 7056.208848953247 ms (excluding imports and monkey-patching)
2022-09-21 23:46:41 INFO  Starting execution of 1 what-if analyses...
2022-09-21 23:46:41 INFO  Start plan generation for analysis DataCorruption...
2022-09-21 23:46:41 INFO  ---RUNTIME: Plan generation took 0.7240772247314453 ms
2022-09-21 23:46:41 INFO  Estimated runtime of original DAG is 4843.038082122803ms
2022-09-21 23:46:41 INFO  Performing Multi-Query Optimization
2022-09-21 23:46:42 INFO  Estimated unoptimized what-if runtime is 121075.95205307007ms
2022-09-21 23:46:42 INFO  Estimated optimised what-if runtime is 11541.295528411865ms
2022-09-21 23:46:42 INFO  Estimated optimisation runtime saving is 109534.6565246582ms
2022-09-21 23:46:42 INFO  ---RUNTIME: Multi-Query Optimization took 318.8059329986572 ms
2022-09-21 23:46:42 INFO  Executing generated plans
2022-09-21 23:46:59 INFO  ---RUNTIME: Execution took 17723.14167022705 ms
2022-09-21 23:46:59 INFO  Done!
2022-09-21 23:46:59 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-21 23:46:59 INFO  Running instrumented original pipeline...
2022-09-21 23:46:59 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-21 23:47:00 INFO  ---RUNTIME: Importing and monkey-patching took 5.9871673583984375 ms
2022-09-21 23:47:07 INFO  ---RUNTIME: Original pipeline execution took 7158.696174621582 ms (excluding imports and monkey-patching)
2022-09-21 23:47:07 INFO  Starting execution of 1 what-if analyses...
2022-09-21 23:47:07 INFO  Start plan generation for analysis DataCorruption...
2022-09-21 23:47:07 INFO  ---RUNTIME: Plan generation took 0.5109310150146484 ms
2022-09-21 23:47:07 INFO  Estimated runtime of original DAG is 4883.933544158936ms
2022-09-21 23:47:07 WARNING Skipping Multi-Query Optimization (instead, only applying patches)
2022-09-21 23:47:07 INFO  Estimated unoptimised what-if runtime is 122098.33860397339ms
2022-09-21 23:47:07 INFO  ---RUNTIME: Multi-Query Optimization took 18.517255783081055 ms
2022-09-21 23:47:07 INFO  Executing generated plans
2022-09-21 23:49:44 INFO  ---RUNTIME: Execution took 157532.9167842865 ms
2022-09-21 23:49:44 INFO  Done!
2022-09-21 23:49:44 INFO  # Finished -- repetition 3 of 7 
2022-09-21 23:49:44 INFO  # Optimization benchmark for data_corruption with args [['reviews', 'fast_loading', 'featurization_1', 'logistic_regression']] -- repetition 4 of 7
2022-09-21 23:49:44 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-21 23:49:44 INFO  Running instrumented original pipeline...
2022-09-21 23:49:44 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-21 23:49:44 INFO  ---RUNTIME: Importing and monkey-patching took 6.181955337524414 ms
2022-09-21 23:49:51 INFO  ---RUNTIME: Original pipeline execution took 7106.257438659668 ms (excluding imports and monkey-patching)
2022-09-21 23:49:51 INFO  Starting execution of 1 what-if analyses...
2022-09-21 23:49:51 INFO  Start plan generation for analysis DataCorruption...
2022-09-21 23:49:51 INFO  ---RUNTIME: Plan generation took 0.5626678466796875 ms
2022-09-21 23:49:51 INFO  Estimated runtime of original DAG is 4876.0998249053955ms
2022-09-21 23:49:51 INFO  Performing Multi-Query Optimization
2022-09-21 23:49:51 INFO  Estimated unoptimized what-if runtime is 121902.49562263489ms
2022-09-21 23:49:51 INFO  Estimated optimised what-if runtime is 11546.32592201233ms
2022-09-21 23:49:51 INFO  Estimated optimisation runtime saving is 110356.16970062256ms
2022-09-21 23:49:51 INFO  ---RUNTIME: Multi-Query Optimization took 81.97498321533203 ms
2022-09-21 23:49:51 INFO  Executing generated plans
2022-09-21 23:50:09 INFO  ---RUNTIME: Execution took 17576.083183288574 ms
2022-09-21 23:50:09 INFO  Done!
2022-09-21 23:50:09 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-21 23:50:09 INFO  Running instrumented original pipeline...
2022-09-21 23:50:09 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-21 23:50:09 INFO  ---RUNTIME: Importing and monkey-patching took 5.701780319213867 ms
2022-09-21 23:50:16 INFO  ---RUNTIME: Original pipeline execution took 7101.407289505005 ms (excluding imports and monkey-patching)
2022-09-21 23:50:16 INFO  Starting execution of 1 what-if analyses...
2022-09-21 23:50:16 INFO  Start plan generation for analysis DataCorruption...
2022-09-21 23:50:16 INFO  ---RUNTIME: Plan generation took 0.5116462707519531 ms
2022-09-21 23:50:16 INFO  Estimated runtime of original DAG is 4856.530427932739ms
2022-09-21 23:50:16 WARNING Skipping Multi-Query Optimization (instead, only applying patches)
2022-09-21 23:50:16 INFO  Estimated unoptimised what-if runtime is 121413.26069831848ms
2022-09-21 23:50:16 INFO  ---RUNTIME: Multi-Query Optimization took 18.525362014770508 ms
2022-09-21 23:50:16 INFO  Executing generated plans
2022-09-21 23:53:00 INFO  ---RUNTIME: Execution took 164377.53915786743 ms
2022-09-21 23:53:00 INFO  Done!
2022-09-21 23:53:00 INFO  # Finished -- repetition 4 of 7 
2022-09-21 23:53:00 INFO  # Optimization benchmark for data_corruption with args [['reviews', 'fast_loading', 'featurization_1', 'logistic_regression']] -- repetition 5 of 7
2022-09-21 23:53:00 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-21 23:53:00 INFO  Running instrumented original pipeline...
2022-09-21 23:53:01 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-21 23:53:01 INFO  ---RUNTIME: Importing and monkey-patching took 9.750127792358398 ms
2022-09-21 23:53:08 INFO  ---RUNTIME: Original pipeline execution took 7555.111646652222 ms (excluding imports and monkey-patching)
2022-09-21 23:53:08 INFO  Starting execution of 1 what-if analyses...
2022-09-21 23:53:08 INFO  Start plan generation for analysis DataCorruption...
2022-09-21 23:53:08 INFO  ---RUNTIME: Plan generation took 0.70953369140625 ms
2022-09-21 23:53:08 INFO  Estimated runtime of original DAG is 5303.873062133789ms
2022-09-21 23:53:08 INFO  Performing Multi-Query Optimization
2022-09-21 23:53:08 INFO  Estimated unoptimized what-if runtime is 132596.82655334473ms
2022-09-21 23:53:08 INFO  Estimated optimised what-if runtime is 13242.657899856567ms
2022-09-21 23:53:08 INFO  Estimated optimisation runtime saving is 119354.16865348816ms
2022-09-21 23:53:08 INFO  ---RUNTIME: Multi-Query Optimization took 63.63320350646973 ms
2022-09-21 23:53:08 INFO  Executing generated plans
2022-09-21 23:53:26 INFO  ---RUNTIME: Execution took 17910.739421844482 ms
2022-09-21 23:53:26 INFO  Done!
2022-09-21 23:53:26 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-21 23:53:26 INFO  Running instrumented original pipeline...
2022-09-21 23:53:26 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-21 23:53:26 INFO  ---RUNTIME: Importing and monkey-patching took 5.820035934448242 ms
2022-09-21 23:53:33 INFO  ---RUNTIME: Original pipeline execution took 7381.570816040039 ms (excluding imports and monkey-patching)
2022-09-21 23:53:33 INFO  Starting execution of 1 what-if analyses...
2022-09-21 23:53:33 INFO  Start plan generation for analysis DataCorruption...
2022-09-21 23:53:33 INFO  ---RUNTIME: Plan generation took 0.5083084106445312 ms
2022-09-21 23:53:33 INFO  Estimated runtime of original DAG is 5174.081087112427ms
2022-09-21 23:53:33 WARNING Skipping Multi-Query Optimization (instead, only applying patches)
2022-09-21 23:53:33 INFO  Estimated unoptimised what-if runtime is 129352.02717781067ms
2022-09-21 23:53:33 INFO  ---RUNTIME: Multi-Query Optimization took 18.338441848754883 ms
2022-09-21 23:53:33 INFO  Executing generated plans
2022-09-21 23:56:21 INFO  ---RUNTIME: Execution took 167762.61115074158 ms
2022-09-21 23:56:21 INFO  Done!
2022-09-21 23:56:21 INFO  # Finished -- repetition 5 of 7 
2022-09-21 23:56:21 INFO  # Optimization benchmark for data_corruption with args [['reviews', 'fast_loading', 'featurization_1', 'logistic_regression']] -- repetition 6 of 7
2022-09-21 23:56:21 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-21 23:56:21 INFO  Running instrumented original pipeline...
2022-09-21 23:56:22 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-21 23:56:22 INFO  ---RUNTIME: Importing and monkey-patching took 6.320953369140625 ms
2022-09-21 23:56:29 INFO  ---RUNTIME: Original pipeline execution took 7730.195045471191 ms (excluding imports and monkey-patching)
2022-09-21 23:56:29 INFO  Starting execution of 1 what-if analyses...
2022-09-21 23:56:29 INFO  Start plan generation for analysis DataCorruption...
2022-09-21 23:56:29 INFO  ---RUNTIME: Plan generation took 0.4906654357910156 ms
2022-09-21 23:56:29 INFO  Estimated runtime of original DAG is 4939.832448959351ms
2022-09-21 23:56:29 INFO  Performing Multi-Query Optimization
2022-09-21 23:56:29 INFO  Estimated unoptimized what-if runtime is 123495.81122398376ms
2022-09-21 23:56:29 INFO  Estimated optimised what-if runtime is 11600.757360458374ms
2022-09-21 23:56:29 INFO  Estimated optimisation runtime saving is 111895.05386352539ms
2022-09-21 23:56:29 INFO  ---RUNTIME: Multi-Query Optimization took 61.734914779663086 ms
2022-09-21 23:56:29 INFO  Executing generated plans
2022-09-21 23:56:47 INFO  ---RUNTIME: Execution took 18305.177211761475 ms
2022-09-21 23:56:47 INFO  Done!
2022-09-21 23:56:47 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-21 23:56:47 INFO  Running instrumented original pipeline...
2022-09-21 23:56:47 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-21 23:56:47 INFO  ---RUNTIME: Importing and monkey-patching took 8.764266967773438 ms
2022-09-21 23:56:55 INFO  ---RUNTIME: Original pipeline execution took 7512.312173843384 ms (excluding imports and monkey-patching)
2022-09-21 23:56:55 INFO  Starting execution of 1 what-if analyses...
2022-09-21 23:56:55 INFO  Start plan generation for analysis DataCorruption...
2022-09-21 23:56:55 INFO  ---RUNTIME: Plan generation took 0.5025863647460938 ms
2022-09-21 23:56:55 INFO  Estimated runtime of original DAG is 5223.86360168457ms
2022-09-21 23:56:55 WARNING Skipping Multi-Query Optimization (instead, only applying patches)
2022-09-21 23:56:55 INFO  Estimated unoptimised what-if runtime is 130596.59004211426ms
2022-09-21 23:56:55 INFO  ---RUNTIME: Multi-Query Optimization took 18.077373504638672 ms
2022-09-21 23:56:55 INFO  Executing generated plans
2022-09-21 23:59:44 INFO  ---RUNTIME: Execution took 168862.89262771606 ms
2022-09-21 23:59:44 INFO  Done!
2022-09-21 23:59:44 INFO  # Finished -- repetition 6 of 7 
2022-09-21 23:59:44 INFO  # Optimization benchmark for data_corruption with args [['reviews', 'fast_loading', 'featurization_1', 'logistic_regression']] -- repetition 7 of 7
2022-09-21 23:59:44 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-21 23:59:44 INFO  Running instrumented original pipeline...
2022-09-21 23:59:44 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-21 23:59:44 INFO  ---RUNTIME: Importing and monkey-patching took 5.9986114501953125 ms
2022-09-21 23:59:51 INFO  ---RUNTIME: Original pipeline execution took 7364.704132080078 ms (excluding imports and monkey-patching)
2022-09-21 23:59:51 INFO  Starting execution of 1 what-if analyses...
2022-09-21 23:59:51 INFO  Start plan generation for analysis DataCorruption...
2022-09-21 23:59:51 INFO  ---RUNTIME: Plan generation took 0.5261898040771484 ms
2022-09-21 23:59:51 INFO  Estimated runtime of original DAG is 5123.241186141968ms
2022-09-21 23:59:51 INFO  Performing Multi-Query Optimization
2022-09-21 23:59:51 INFO  Estimated unoptimized what-if runtime is 128081.0296535492ms
2022-09-21 23:59:51 INFO  Estimated optimised what-if runtime is 11841.403007507324ms
2022-09-21 23:59:51 INFO  Estimated optimisation runtime saving is 116239.62664604187ms
2022-09-21 23:59:51 INFO  ---RUNTIME: Multi-Query Optimization took 61.48672103881836 ms
2022-09-21 23:59:51 INFO  Executing generated plans
2022-09-22 00:00:09 INFO  ---RUNTIME: Execution took 18318.68863105774 ms
2022-09-22 00:00:09 INFO  Done!
2022-09-22 00:00:09 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-22 00:00:09 INFO  Running instrumented original pipeline...
2022-09-22 00:00:10 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-22 00:00:10 INFO  ---RUNTIME: Importing and monkey-patching took 5.995988845825195 ms
2022-09-22 00:00:17 INFO  ---RUNTIME: Original pipeline execution took 7411.747217178345 ms (excluding imports and monkey-patching)
2022-09-22 00:00:17 INFO  Starting execution of 1 what-if analyses...
2022-09-22 00:00:17 INFO  Start plan generation for analysis DataCorruption...
2022-09-22 00:00:17 INFO  ---RUNTIME: Plan generation took 0.5192756652832031 ms
2022-09-22 00:00:17 INFO  Estimated runtime of original DAG is 4860.606908798218ms
2022-09-22 00:00:17 WARNING Skipping Multi-Query Optimization (instead, only applying patches)
2022-09-22 00:00:17 INFO  Estimated unoptimised what-if runtime is 121515.17271995544ms
2022-09-22 00:00:17 INFO  ---RUNTIME: Multi-Query Optimization took 18.076658248901367 ms
2022-09-22 00:00:17 INFO  Executing generated plans
2022-09-22 00:03:04 INFO  ---RUNTIME: Execution took 167552.23989486694 ms
2022-09-22 00:03:04 INFO  Done!
2022-09-22 00:03:04 INFO  # Finished -- repetition 7 of 7 
2022-09-22 00:03:04 INFO  # Final results after all repetitions
2022-09-22 00:03:04 INFO     repetition  ... no_opt_what_if_execution_combined_model_training
0           0  ...                                      3212.875605
1           1  ...                                      3233.599424
2           2  ...                                      3206.882954
3           3  ...                                      3731.202841
4           4  ...                                      3431.314707
5           5  ...                                      3801.820278
6           6  ...                                      3627.302408

[7 rows x 26 columns]
taskset -c 32-39 PROTOCOL_BUFFERS_PYTHON_IMPLEMENTATION=python python3.9 benchmarks_end_to_end.py data_corruption reviews fast_loading featurization_1 xgboost
2022-09-22 00:03:07.215920: W tensorflow/stream_executor/platform/default/dso_loader.cc:64] Could not load dynamic library 'libcudart.so.11.0'; dlerror: libcudart.so.11.0: cannot open shared object file: No such file or directory; LD_LIBRARY_PATH: /home/sgrafbe/mlwhatif/venv/lib/python3.9/site-packages/cv2/../../lib64:
2022-09-22 00:03:07.215964: I tensorflow/stream_executor/cuda/cudart_stub.cc:29] Ignore above cudart dlerror if you do not have a GPU set up on your machine.
2022-09-22 00:03:08 INFO  Patching sys.argv with ['mlwhatif', 'reviews', 'fast_loading', 'featurization_1', 'xgboost']
2022-09-22 00:03:08 INFO  Running instrumented original pipeline...
2022-09-22 00:03:08 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-22 00:03:08 INFO  ---RUNTIME: Importing and monkey-patching took 176.31268501281738 ms
2022-09-22 00:03:17 INFO  ---RUNTIME: Original pipeline execution took 8662.043333053589 ms (excluding imports and monkey-patching)
2022-09-22 00:03:17 INFO  Starting execution of 0 what-if analyses...
2022-09-22 00:03:17 INFO  Estimated runtime of original DAG is 6388.771533966064ms
2022-09-22 00:03:17 INFO  Performing Multi-Query Optimization
2022-09-22 00:03:17 INFO  Estimated unoptimized what-if runtime is 0ms
2022-09-22 00:03:17 INFO  Estimated optimised what-if runtime is 0ms
2022-09-22 00:03:17 INFO  Estimated optimisation runtime saving is 0ms
2022-09-22 00:03:17 INFO  ---RUNTIME: Multi-Query Optimization took 0.4813671112060547 ms
2022-09-22 00:03:17 INFO  Executing generated plans
2022-09-22 00:03:17 INFO  ---RUNTIME: Execution took 0.027418136596679688 ms
2022-09-22 00:03:17 INFO  Done!
2022-09-22 00:03:17 INFO  # Optimization benchmark for data_corruption with args [['reviews', 'fast_loading', 'featurization_1', 'xgboost']] -- repetition 1 of 7
2022-09-22 00:03:17 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-22 00:03:17 INFO  Running instrumented original pipeline...
2022-09-22 00:03:17 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-22 00:03:17 INFO  ---RUNTIME: Importing and monkey-patching took 6.270170211791992 ms
2022-09-22 00:03:25 INFO  ---RUNTIME: Original pipeline execution took 8327.93116569519 ms (excluding imports and monkey-patching)
2022-09-22 00:03:25 INFO  Starting execution of 1 what-if analyses...
2022-09-22 00:03:25 INFO  Start plan generation for analysis DataCorruption...
2022-09-22 00:03:25 INFO  ---RUNTIME: Plan generation took 0.5409717559814453 ms
2022-09-22 00:03:25 INFO  Estimated runtime of original DAG is 5842.442035675049ms
2022-09-22 00:03:25 INFO  Performing Multi-Query Optimization
2022-09-22 00:03:26 INFO  Estimated unoptimized what-if runtime is 146061.05089187622ms
2022-09-22 00:03:26 INFO  Estimated optimised what-if runtime is 13704.908847808838ms
2022-09-22 00:03:26 INFO  Estimated optimisation runtime saving is 132356.14204406738ms
2022-09-22 00:03:26 INFO  ---RUNTIME: Multi-Query Optimization took 62.74819374084473 ms
2022-09-22 00:03:26 INFO  Executing generated plans
2022-09-22 00:03:46 INFO  ---RUNTIME: Execution took 20386.150121688843 ms
2022-09-22 00:03:46 INFO  Done!
2022-09-22 00:03:46 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-22 00:03:46 INFO  Running instrumented original pipeline...
2022-09-22 00:03:46 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-22 00:03:46 INFO  ---RUNTIME: Importing and monkey-patching took 6.410121917724609 ms
2022-09-22 00:03:54 INFO  ---RUNTIME: Original pipeline execution took 8092.0233726501465 ms (excluding imports and monkey-patching)
2022-09-22 00:03:54 INFO  Starting execution of 1 what-if analyses...
2022-09-22 00:03:54 INFO  Start plan generation for analysis DataCorruption...
2022-09-22 00:03:54 INFO  ---RUNTIME: Plan generation took 0.5338191986083984 ms
2022-09-22 00:03:54 INFO  Estimated runtime of original DAG is 5859.865188598633ms
2022-09-22 00:03:54 WARNING Skipping Multi-Query Optimization (instead, only applying patches)
2022-09-22 00:03:54 INFO  Estimated unoptimised what-if runtime is 146496.62971496582ms
2022-09-22 00:03:54 INFO  ---RUNTIME: Multi-Query Optimization took 18.143653869628906 ms
2022-09-22 00:03:54 INFO  Executing generated plans
2022-09-22 00:07:02 INFO  ---RUNTIME: Execution took 188197.61419296265 ms
2022-09-22 00:07:02 INFO  Done!
2022-09-22 00:07:02 INFO  # Finished -- repetition 1 of 7 
2022-09-22 00:07:02 INFO  # Optimization benchmark for data_corruption with args [['reviews', 'fast_loading', 'featurization_1', 'xgboost']] -- repetition 2 of 7
2022-09-22 00:07:02 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-22 00:07:02 INFO  Running instrumented original pipeline...
2022-09-22 00:07:02 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-22 00:07:02 INFO  ---RUNTIME: Importing and monkey-patching took 6.232738494873047 ms
2022-09-22 00:07:11 INFO  ---RUNTIME: Original pipeline execution took 8400.384664535522 ms (excluding imports and monkey-patching)
2022-09-22 00:07:11 INFO  Starting execution of 1 what-if analyses...
2022-09-22 00:07:11 INFO  Start plan generation for analysis DataCorruption...
2022-09-22 00:07:11 INFO  ---RUNTIME: Plan generation took 0.522613525390625 ms
2022-09-22 00:07:11 INFO  Estimated runtime of original DAG is 6208.74285697937ms
2022-09-22 00:07:11 INFO  Performing Multi-Query Optimization
2022-09-22 00:07:11 INFO  Estimated unoptimized what-if runtime is 155218.57142448425ms
2022-09-22 00:07:11 INFO  Estimated optimised what-if runtime is 15182.57188796997ms
2022-09-22 00:07:11 INFO  Estimated optimisation runtime saving is 140035.99953651428ms
2022-09-22 00:07:11 INFO  ---RUNTIME: Multi-Query Optimization took 62.624454498291016 ms
2022-09-22 00:07:11 INFO  Executing generated plans
2022-09-22 00:07:31 INFO  ---RUNTIME: Execution took 19993.102312088013 ms
2022-09-22 00:07:31 INFO  Done!
2022-09-22 00:07:31 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-22 00:07:31 INFO  Running instrumented original pipeline...
2022-09-22 00:07:31 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-22 00:07:31 INFO  ---RUNTIME: Importing and monkey-patching took 8.77070426940918 ms
2022-09-22 00:07:39 INFO  ---RUNTIME: Original pipeline execution took 8276.23963356018 ms (excluding imports and monkey-patching)
2022-09-22 00:07:39 INFO  Starting execution of 1 what-if analyses...
2022-09-22 00:07:39 INFO  Start plan generation for analysis DataCorruption...
2022-09-22 00:07:39 INFO  ---RUNTIME: Plan generation took 0.5054473876953125 ms
2022-09-22 00:07:39 INFO  Estimated runtime of original DAG is 6043.27392578125ms
2022-09-22 00:07:39 WARNING Skipping Multi-Query Optimization (instead, only applying patches)
2022-09-22 00:07:39 INFO  Estimated unoptimised what-if runtime is 151081.84814453125ms
2022-09-22 00:07:39 INFO  ---RUNTIME: Multi-Query Optimization took 18.24951171875 ms
2022-09-22 00:07:39 INFO  Executing generated plans
2022-09-22 00:10:47 INFO  ---RUNTIME: Execution took 187602.0064353943 ms
2022-09-22 00:10:47 INFO  Done!
2022-09-22 00:10:47 INFO  # Finished -- repetition 2 of 7 
2022-09-22 00:10:47 INFO  # Optimization benchmark for data_corruption with args [['reviews', 'fast_loading', 'featurization_1', 'xgboost']] -- repetition 3 of 7
2022-09-22 00:10:47 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-22 00:10:47 INFO  Running instrumented original pipeline...
2022-09-22 00:10:47 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-22 00:10:47 INFO  ---RUNTIME: Importing and monkey-patching took 6.218194961547852 ms
2022-09-22 00:10:55 INFO  ---RUNTIME: Original pipeline execution took 8166.001319885254 ms (excluding imports and monkey-patching)
2022-09-22 00:10:55 INFO  Starting execution of 1 what-if analyses...
2022-09-22 00:10:55 INFO  Start plan generation for analysis DataCorruption...
2022-09-22 00:10:55 INFO  ---RUNTIME: Plan generation took 0.5102157592773438 ms
2022-09-22 00:10:55 INFO  Estimated runtime of original DAG is 5599.119663238525ms
2022-09-22 00:10:55 INFO  Performing Multi-Query Optimization
2022-09-22 00:10:55 INFO  Estimated unoptimized what-if runtime is 139977.99158096313ms
2022-09-22 00:10:55 INFO  Estimated optimised what-if runtime is 13459.786653518677ms
2022-09-22 00:10:55 INFO  Estimated optimisation runtime saving is 126518.20492744446ms
2022-09-22 00:10:55 INFO  ---RUNTIME: Multi-Query Optimization took 282.42945671081543 ms
2022-09-22 00:10:55 INFO  Executing generated plans
2022-09-22 00:11:16 INFO  ---RUNTIME: Execution took 20756.38222694397 ms
2022-09-22 00:11:16 INFO  Done!
2022-09-22 00:11:16 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-22 00:11:16 INFO  Running instrumented original pipeline...
2022-09-22 00:11:16 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-22 00:11:16 INFO  ---RUNTIME: Importing and monkey-patching took 6.081581115722656 ms
2022-09-22 00:11:24 INFO  ---RUNTIME: Original pipeline execution took 8437.984466552734 ms (excluding imports and monkey-patching)
2022-09-22 00:11:24 INFO  Starting execution of 1 what-if analyses...
2022-09-22 00:11:24 INFO  Start plan generation for analysis DataCorruption...
2022-09-22 00:11:24 INFO  ---RUNTIME: Plan generation took 0.5381107330322266 ms
2022-09-22 00:11:24 INFO  Estimated runtime of original DAG is 6205.029726028442ms
2022-09-22 00:11:24 WARNING Skipping Multi-Query Optimization (instead, only applying patches)
2022-09-22 00:11:24 INFO  Estimated unoptimised what-if runtime is 155125.74315071106ms
2022-09-22 00:11:24 INFO  ---RUNTIME: Multi-Query Optimization took 18.512248992919922 ms
2022-09-22 00:11:24 INFO  Executing generated plans
2022-09-22 00:14:33 INFO  ---RUNTIME: Execution took 188725.72875022888 ms
2022-09-22 00:14:33 INFO  Done!
2022-09-22 00:14:33 INFO  # Finished -- repetition 3 of 7 
2022-09-22 00:14:33 INFO  # Optimization benchmark for data_corruption with args [['reviews', 'fast_loading', 'featurization_1', 'xgboost']] -- repetition 4 of 7
2022-09-22 00:14:33 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-22 00:14:33 INFO  Running instrumented original pipeline...
2022-09-22 00:14:33 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-22 00:14:33 INFO  ---RUNTIME: Importing and monkey-patching took 8.518218994140625 ms
2022-09-22 00:14:41 INFO  ---RUNTIME: Original pipeline execution took 8350.419998168945 ms (excluding imports and monkey-patching)
2022-09-22 00:14:41 INFO  Starting execution of 1 what-if analyses...
2022-09-22 00:14:41 INFO  Start plan generation for analysis DataCorruption...
2022-09-22 00:14:41 INFO  ---RUNTIME: Plan generation took 0.5469322204589844 ms
2022-09-22 00:14:41 INFO  Estimated runtime of original DAG is 6086.414813995361ms
2022-09-22 00:14:41 INFO  Performing Multi-Query Optimization
2022-09-22 00:14:41 INFO  Estimated unoptimized what-if runtime is 152160.37034988403ms
2022-09-22 00:14:41 INFO  Estimated optimised what-if runtime is 15160.011529922485ms
2022-09-22 00:14:41 INFO  Estimated optimisation runtime saving is 137000.35881996155ms
2022-09-22 00:14:41 INFO  ---RUNTIME: Multi-Query Optimization took 62.2556209564209 ms
2022-09-22 00:14:41 INFO  Executing generated plans
2022-09-22 00:15:02 INFO  ---RUNTIME: Execution took 20228.898763656616 ms
2022-09-22 00:15:02 INFO  Done!
2022-09-22 00:15:02 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-22 00:15:02 INFO  Running instrumented original pipeline...
2022-09-22 00:15:02 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-22 00:15:02 INFO  ---RUNTIME: Importing and monkey-patching took 5.791664123535156 ms
2022-09-22 00:15:10 INFO  ---RUNTIME: Original pipeline execution took 8313.833951950073 ms (excluding imports and monkey-patching)
2022-09-22 00:15:10 INFO  Starting execution of 1 what-if analyses...
2022-09-22 00:15:10 INFO  Start plan generation for analysis DataCorruption...
2022-09-22 00:15:10 INFO  ---RUNTIME: Plan generation took 0.49567222595214844 ms
2022-09-22 00:15:10 INFO  Estimated runtime of original DAG is 5864.938497543335ms
2022-09-22 00:15:10 WARNING Skipping Multi-Query Optimization (instead, only applying patches)
2022-09-22 00:15:10 INFO  Estimated unoptimised what-if runtime is 146623.46243858337ms
2022-09-22 00:15:10 INFO  ---RUNTIME: Multi-Query Optimization took 18.45550537109375 ms
2022-09-22 00:15:10 INFO  Executing generated plans
2022-09-22 00:18:15 INFO  ---RUNTIME: Execution took 184588.83786201477 ms
2022-09-22 00:18:15 INFO  Done!
2022-09-22 00:18:15 INFO  # Finished -- repetition 4 of 7 
2022-09-22 00:18:15 INFO  # Optimization benchmark for data_corruption with args [['reviews', 'fast_loading', 'featurization_1', 'xgboost']] -- repetition 5 of 7
2022-09-22 00:18:15 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-22 00:18:15 INFO  Running instrumented original pipeline...
2022-09-22 00:18:15 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-22 00:18:15 INFO  ---RUNTIME: Importing and monkey-patching took 6.599903106689453 ms
2022-09-22 00:18:23 INFO  ---RUNTIME: Original pipeline execution took 8074.328184127808 ms (excluding imports and monkey-patching)
2022-09-22 00:18:23 INFO  Starting execution of 1 what-if analyses...
2022-09-22 00:18:23 INFO  Start plan generation for analysis DataCorruption...
2022-09-22 00:18:23 INFO  ---RUNTIME: Plan generation took 0.5247592926025391 ms
2022-09-22 00:18:23 INFO  Estimated runtime of original DAG is 5830.621004104614ms
2022-09-22 00:18:23 INFO  Performing Multi-Query Optimization
2022-09-22 00:18:23 INFO  Estimated unoptimized what-if runtime is 145765.52510261536ms
2022-09-22 00:18:23 INFO  Estimated optimised what-if runtime is 13667.576551437378ms
2022-09-22 00:18:23 INFO  Estimated optimisation runtime saving is 132097.94855117798ms
2022-09-22 00:18:23 INFO  ---RUNTIME: Multi-Query Optimization took 62.80112266540527 ms
2022-09-22 00:18:23 INFO  Executing generated plans
2022-09-22 00:18:43 INFO  ---RUNTIME: Execution took 19996.52147293091 ms
2022-09-22 00:18:43 INFO  Done!
2022-09-22 00:18:43 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-22 00:18:43 INFO  Running instrumented original pipeline...
2022-09-22 00:18:43 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-22 00:18:43 INFO  ---RUNTIME: Importing and monkey-patching took 6.483316421508789 ms
2022-09-22 00:18:51 INFO  ---RUNTIME: Original pipeline execution took 8085.858106613159 ms (excluding imports and monkey-patching)
2022-09-22 00:18:51 INFO  Starting execution of 1 what-if analyses...
2022-09-22 00:18:51 INFO  Start plan generation for analysis DataCorruption...
2022-09-22 00:18:51 INFO  ---RUNTIME: Plan generation took 0.5536079406738281 ms
2022-09-22 00:18:51 INFO  Estimated runtime of original DAG is 5826.8883228302ms
2022-09-22 00:18:51 WARNING Skipping Multi-Query Optimization (instead, only applying patches)
2022-09-22 00:18:51 INFO  Estimated unoptimised what-if runtime is 145672.208070755ms
2022-09-22 00:18:51 INFO  ---RUNTIME: Multi-Query Optimization took 18.59426498413086 ms
2022-09-22 00:18:51 INFO  Executing generated plans
2022-09-22 00:21:55 INFO  ---RUNTIME: Execution took 184470.6256389618 ms
2022-09-22 00:21:55 INFO  Done!
2022-09-22 00:21:55 INFO  # Finished -- repetition 5 of 7 
2022-09-22 00:21:55 INFO  # Optimization benchmark for data_corruption with args [['reviews', 'fast_loading', 'featurization_1', 'xgboost']] -- repetition 6 of 7
2022-09-22 00:21:55 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-22 00:21:55 INFO  Running instrumented original pipeline...
2022-09-22 00:21:56 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-22 00:21:56 INFO  ---RUNTIME: Importing and monkey-patching took 7.42793083190918 ms
2022-09-22 00:22:04 INFO  ---RUNTIME: Original pipeline execution took 8689.375638961792 ms (excluding imports and monkey-patching)
2022-09-22 00:22:04 INFO  Starting execution of 1 what-if analyses...
2022-09-22 00:22:04 INFO  Start plan generation for analysis DataCorruption...
2022-09-22 00:22:04 INFO  ---RUNTIME: Plan generation took 0.5571842193603516 ms
2022-09-22 00:22:04 INFO  Estimated runtime of original DAG is 6035.897016525269ms
2022-09-22 00:22:04 INFO  Performing Multi-Query Optimization
2022-09-22 00:22:04 INFO  Estimated unoptimized what-if runtime is 150897.4254131317ms
2022-09-22 00:22:04 INFO  Estimated optimised what-if runtime is 14224.938154220581ms
2022-09-22 00:22:04 INFO  Estimated optimisation runtime saving is 136672.48725891113ms
2022-09-22 00:22:04 INFO  ---RUNTIME: Multi-Query Optimization took 66.06292724609375 ms
2022-09-22 00:22:04 INFO  Executing generated plans
2022-09-22 00:22:25 INFO  ---RUNTIME: Execution took 20691.031217575073 ms
2022-09-22 00:22:25 INFO  Done!
2022-09-22 00:22:25 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-22 00:22:25 INFO  Running instrumented original pipeline...
2022-09-22 00:22:25 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-22 00:22:25 INFO  ---RUNTIME: Importing and monkey-patching took 6.520986557006836 ms
2022-09-22 00:22:33 INFO  ---RUNTIME: Original pipeline execution took 8425.020217895508 ms (excluding imports and monkey-patching)
2022-09-22 00:22:33 INFO  Starting execution of 1 what-if analyses...
2022-09-22 00:22:33 INFO  Start plan generation for analysis DataCorruption...
2022-09-22 00:22:33 INFO  ---RUNTIME: Plan generation took 0.5340576171875 ms
2022-09-22 00:22:33 INFO  Estimated runtime of original DAG is 5960.198879241943ms
2022-09-22 00:22:33 WARNING Skipping Multi-Query Optimization (instead, only applying patches)
2022-09-22 00:22:33 INFO  Estimated unoptimised what-if runtime is 149004.97198104858ms
2022-09-22 00:22:33 INFO  ---RUNTIME: Multi-Query Optimization took 20.0498104095459 ms
2022-09-22 00:22:33 INFO  Executing generated plans
2022-09-22 00:25:52 INFO  ---RUNTIME: Execution took 198581.0968875885 ms
2022-09-22 00:25:52 INFO  Done!
2022-09-22 00:25:52 INFO  # Finished -- repetition 6 of 7 
2022-09-22 00:25:52 INFO  # Optimization benchmark for data_corruption with args [['reviews', 'fast_loading', 'featurization_1', 'xgboost']] -- repetition 7 of 7
2022-09-22 00:25:52 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-22 00:25:52 INFO  Running instrumented original pipeline...
2022-09-22 00:25:52 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-22 00:25:52 INFO  ---RUNTIME: Importing and monkey-patching took 6.068706512451172 ms
2022-09-22 00:26:00 INFO  ---RUNTIME: Original pipeline execution took 8232.792377471924 ms (excluding imports and monkey-patching)
2022-09-22 00:26:00 INFO  Starting execution of 1 what-if analyses...
2022-09-22 00:26:00 INFO  Start plan generation for analysis DataCorruption...
2022-09-22 00:26:00 INFO  ---RUNTIME: Plan generation took 0.5435943603515625 ms
2022-09-22 00:26:00 INFO  Estimated runtime of original DAG is 5918.580055236816ms
2022-09-22 00:26:00 INFO  Performing Multi-Query Optimization
2022-09-22 00:26:00 INFO  Estimated unoptimized what-if runtime is 147964.5013809204ms
2022-09-22 00:26:00 INFO  Estimated optimised what-if runtime is 14360.386610031128ms
2022-09-22 00:26:00 INFO  Estimated optimisation runtime saving is 133604.11477088928ms
2022-09-22 00:26:00 INFO  ---RUNTIME: Multi-Query Optimization took 60.837507247924805 ms
2022-09-22 00:26:00 INFO  Executing generated plans
2022-09-22 00:26:20 INFO  ---RUNTIME: Execution took 19790.26222229004 ms
2022-09-22 00:26:20 INFO  Done!
2022-09-22 00:26:20 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-22 00:26:20 INFO  Running instrumented original pipeline...
2022-09-22 00:26:20 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-22 00:26:20 INFO  ---RUNTIME: Importing and monkey-patching took 5.583524703979492 ms
2022-09-22 00:26:28 INFO  ---RUNTIME: Original pipeline execution took 8078.218936920166 ms (excluding imports and monkey-patching)
2022-09-22 00:26:28 INFO  Starting execution of 1 what-if analyses...
2022-09-22 00:26:28 INFO  Start plan generation for analysis DataCorruption...
2022-09-22 00:26:28 INFO  ---RUNTIME: Plan generation took 0.5741119384765625 ms
2022-09-22 00:26:28 INFO  Estimated runtime of original DAG is 5770.519256591797ms
2022-09-22 00:26:28 WARNING Skipping Multi-Query Optimization (instead, only applying patches)
2022-09-22 00:26:28 INFO  Estimated unoptimised what-if runtime is 144262.98141479492ms
2022-09-22 00:26:28 INFO  ---RUNTIME: Multi-Query Optimization took 19.314289093017578 ms
2022-09-22 00:26:28 INFO  Executing generated plans
2022-09-22 00:29:35 INFO  ---RUNTIME: Execution took 187050.20666122437 ms
2022-09-22 00:29:35 INFO  Done!
2022-09-22 00:29:35 INFO  # Finished -- repetition 7 of 7 
2022-09-22 00:29:35 INFO  # Final results after all repetitions
2022-09-22 00:29:35 INFO     repetition  ... no_opt_what_if_execution_combined_model_training
0           0  ...                                     23744.417191
1           1  ...                                     23314.485073
2           2  ...                                     25175.328732
3           3  ...                                     24867.385626
4           4  ...                                     26719.373941
5           5  ...                                     39887.555838
6           6  ...                                     28170.079947

[7 rows x 26 columns]
taskset -c 32-39 PROTOCOL_BUFFERS_PYTHON_IMPLEMENTATION=python python3.9 benchmarks_end_to_end.py data_corruption reviews fast_loading featurization_1 neural_network
2022-09-22 00:29:38.020226: W tensorflow/stream_executor/platform/default/dso_loader.cc:64] Could not load dynamic library 'libcudart.so.11.0'; dlerror: libcudart.so.11.0: cannot open shared object file: No such file or directory; LD_LIBRARY_PATH: /home/sgrafbe/mlwhatif/venv/lib/python3.9/site-packages/cv2/../../lib64:
2022-09-22 00:29:38.020278: I tensorflow/stream_executor/cuda/cudart_stub.cc:29] Ignore above cudart dlerror if you do not have a GPU set up on your machine.
2022-09-22 00:29:39 INFO  Patching sys.argv with ['mlwhatif', 'reviews', 'fast_loading', 'featurization_1', 'neural_network']
2022-09-22 00:29:39 INFO  Running instrumented original pipeline...
2022-09-22 00:29:39 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-22 00:29:39 INFO  ---RUNTIME: Importing and monkey-patching took 125.46944618225098 ms
2022-09-22 00:29:45.214628: W tensorflow/stream_executor/platform/default/dso_loader.cc:64] Could not load dynamic library 'libcuda.so.1'; dlerror: libcuda.so.1: cannot open shared object file: No such file or directory; LD_LIBRARY_PATH: /home/sgrafbe/mlwhatif/venv/lib/python3.9/site-packages/cv2/../../lib64:
2022-09-22 00:29:45.214671: W tensorflow/stream_executor/cuda/cuda_driver.cc:326] failed call to cuInit: UNKNOWN ERROR (303)
2022-09-22 00:29:45.214695: I tensorflow/stream_executor/cuda/cuda_diagnostics.cc:156] kernel driver does not appear to be running on this host (angus): /proc/driver/nvidia/version does not exist
2022-09-22 00:29:45.215337: I tensorflow/core/platform/cpu_feature_guard.cc:142] This TensorFlow binary is optimized with oneAPI Deep Neural Network Library (oneDNN) to use the following CPU instructions in performance-critical operations:  AVX2 FMA
To enable them in other operations, rebuild TensorFlow with the appropriate compiler flags.
2022-09-22 00:29:45.467629: I tensorflow/compiler/mlir/mlir_graph_optimization_pass.cc:176] None of the MLIR Optimization Passes are enabled (registered 2)
2022-09-22 00:29:45.480194: I tensorflow/core/platform/profile_utils/cpu_utils.cc:114] CPU Frequency: 2595130000 Hz
2022-09-22 00:29:50 INFO  ---RUNTIME: Original pipeline execution took 11182.056427001953 ms (excluding imports and monkey-patching)
2022-09-22 00:29:50 INFO  Starting execution of 0 what-if analyses...
2022-09-22 00:29:50 INFO  Estimated runtime of original DAG is 8847.256422042847ms
2022-09-22 00:29:50 INFO  Performing Multi-Query Optimization
2022-09-22 00:29:50 INFO  Estimated unoptimized what-if runtime is 0ms
2022-09-22 00:29:50 INFO  Estimated optimised what-if runtime is 0ms
2022-09-22 00:29:50 INFO  Estimated optimisation runtime saving is 0ms
2022-09-22 00:29:50 INFO  ---RUNTIME: Multi-Query Optimization took 0.5037784576416016 ms
2022-09-22 00:29:50 INFO  Executing generated plans
2022-09-22 00:29:50 INFO  ---RUNTIME: Execution took 0.025987625122070312 ms
2022-09-22 00:29:50 INFO  Done!
2022-09-22 00:29:50 INFO  # Optimization benchmark for data_corruption with args [['reviews', 'fast_loading', 'featurization_1', 'neural_network']] -- repetition 1 of 7
2022-09-22 00:29:50 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-22 00:29:50 INFO  Running instrumented original pipeline...
2022-09-22 00:29:50 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-22 00:29:50 INFO  ---RUNTIME: Importing and monkey-patching took 5.553960800170898 ms
2022-09-22 00:30:01 INFO  ---RUNTIME: Original pipeline execution took 10641.157865524292 ms (excluding imports and monkey-patching)
2022-09-22 00:30:01 INFO  Starting execution of 1 what-if analyses...
2022-09-22 00:30:01 INFO  Start plan generation for analysis DataCorruption...
2022-09-22 00:30:01 INFO  ---RUNTIME: Plan generation took 0.40221214294433594 ms
2022-09-22 00:30:01 INFO  Estimated runtime of original DAG is 8362.613201141357ms
2022-09-22 00:30:01 INFO  Performing Multi-Query Optimization
2022-09-22 00:30:01 INFO  Estimated unoptimized what-if runtime is 209065.33002853394ms
2022-09-22 00:30:01 INFO  Estimated optimised what-if runtime is 24627.87914276123ms
2022-09-22 00:30:01 INFO  Estimated optimisation runtime saving is 184437.4508857727ms
2022-09-22 00:30:01 INFO  ---RUNTIME: Multi-Query Optimization took 63.55571746826172 ms
2022-09-22 00:30:01 INFO  Executing generated plans
2022-09-22 00:30:32 INFO  ---RUNTIME: Execution took 31013.65351676941 ms
2022-09-22 00:30:32 INFO  Done!
2022-09-22 00:30:32 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-22 00:30:32 INFO  Running instrumented original pipeline...
2022-09-22 00:30:32 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-22 00:30:32 INFO  ---RUNTIME: Importing and monkey-patching took 7.101535797119141 ms
2022-09-22 00:30:43 INFO  ---RUNTIME: Original pipeline execution took 10769.43850517273 ms (excluding imports and monkey-patching)
2022-09-22 00:30:43 INFO  Starting execution of 1 what-if analyses...
2022-09-22 00:30:43 INFO  Start plan generation for analysis DataCorruption...
2022-09-22 00:30:43 INFO  ---RUNTIME: Plan generation took 2.3431777954101562 ms
2022-09-22 00:30:43 INFO  Estimated runtime of original DAG is 8587.979078292847ms
2022-09-22 00:30:43 WARNING Skipping Multi-Query Optimization (instead, only applying patches)
2022-09-22 00:30:43 INFO  Estimated unoptimised what-if runtime is 214699.47695732117ms
2022-09-22 00:30:43 INFO  ---RUNTIME: Multi-Query Optimization took 20.136117935180664 ms
2022-09-22 00:30:43 INFO  Executing generated plans
2022-09-22 00:34:56 INFO  ---RUNTIME: Execution took 253630.70797920227 ms
2022-09-22 00:34:56 INFO  Done!
2022-09-22 00:34:56 INFO  # Finished -- repetition 1 of 7 
2022-09-22 00:34:56 INFO  # Optimization benchmark for data_corruption with args [['reviews', 'fast_loading', 'featurization_1', 'neural_network']] -- repetition 2 of 7
2022-09-22 00:34:56 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-22 00:34:56 INFO  Running instrumented original pipeline...
2022-09-22 00:34:56 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-22 00:34:56 INFO  ---RUNTIME: Importing and monkey-patching took 5.797147750854492 ms
2022-09-22 00:35:07 INFO  ---RUNTIME: Original pipeline execution took 10994.428634643555 ms (excluding imports and monkey-patching)
2022-09-22 00:35:07 INFO  Starting execution of 1 what-if analyses...
2022-09-22 00:35:07 INFO  Start plan generation for analysis DataCorruption...
2022-09-22 00:35:07 INFO  ---RUNTIME: Plan generation took 0.396728515625 ms
2022-09-22 00:35:07 INFO  Estimated runtime of original DAG is 8776.07011795044ms
2022-09-22 00:35:07 INFO  Performing Multi-Query Optimization
2022-09-22 00:35:07 INFO  Estimated unoptimized what-if runtime is 219401.752948761ms
2022-09-22 00:35:07 INFO  Estimated optimised what-if runtime is 25279.37626838684ms
2022-09-22 00:35:07 INFO  Estimated optimisation runtime saving is 194122.37668037415ms
2022-09-22 00:35:07 INFO  ---RUNTIME: Multi-Query Optimization took 61.40494346618652 ms
2022-09-22 00:35:07 INFO  Executing generated plans
2022-09-22 00:35:38 INFO  ---RUNTIME: Execution took 30737.443923950195 ms
2022-09-22 00:35:38 INFO  Done!
2022-09-22 00:35:38 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-22 00:35:38 INFO  Running instrumented original pipeline...
2022-09-22 00:35:38 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-22 00:35:38 INFO  ---RUNTIME: Importing and monkey-patching took 6.320714950561523 ms
2022-09-22 00:35:49 INFO  ---RUNTIME: Original pipeline execution took 11021.884202957153 ms (excluding imports and monkey-patching)
2022-09-22 00:35:49 INFO  Starting execution of 1 what-if analyses...
2022-09-22 00:35:49 INFO  Start plan generation for analysis DataCorruption...
2022-09-22 00:35:49 INFO  ---RUNTIME: Plan generation took 0.38361549377441406 ms
2022-09-22 00:35:49 INFO  Estimated runtime of original DAG is 8431.961059570312ms
2022-09-22 00:35:49 WARNING Skipping Multi-Query Optimization (instead, only applying patches)
2022-09-22 00:35:49 INFO  Estimated unoptimised what-if runtime is 210799.0264892578ms
2022-09-22 00:35:49 INFO  ---RUNTIME: Multi-Query Optimization took 18.375635147094727 ms
2022-09-22 00:35:49 INFO  Executing generated plans
2022-09-22 00:40:03 INFO  ---RUNTIME: Execution took 253543.2164669037 ms
2022-09-22 00:40:03 INFO  Done!
2022-09-22 00:40:03 INFO  # Finished -- repetition 2 of 7 
2022-09-22 00:40:03 INFO  # Optimization benchmark for data_corruption with args [['reviews', 'fast_loading', 'featurization_1', 'neural_network']] -- repetition 3 of 7
2022-09-22 00:40:03 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-22 00:40:03 INFO  Running instrumented original pipeline...
2022-09-22 00:40:03 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-22 00:40:03 INFO  ---RUNTIME: Importing and monkey-patching took 6.371736526489258 ms
2022-09-22 00:40:14 INFO  ---RUNTIME: Original pipeline execution took 10939.098596572876 ms (excluding imports and monkey-patching)
2022-09-22 00:40:14 INFO  Starting execution of 1 what-if analyses...
2022-09-22 00:40:14 INFO  Start plan generation for analysis DataCorruption...
2022-09-22 00:40:14 INFO  ---RUNTIME: Plan generation took 2.145528793334961 ms
2022-09-22 00:40:14 INFO  Estimated runtime of original DAG is 8752.882957458496ms
2022-09-22 00:40:14 INFO  Performing Multi-Query Optimization
2022-09-22 00:40:14 INFO  Estimated unoptimized what-if runtime is 218822.0739364624ms
2022-09-22 00:40:14 INFO  Estimated optimised what-if runtime is 27474.658727645874ms
2022-09-22 00:40:14 INFO  Estimated optimisation runtime saving is 191347.41520881653ms
2022-09-22 00:40:14 INFO  ---RUNTIME: Multi-Query Optimization took 65.5829906463623 ms
2022-09-22 00:40:14 INFO  Executing generated plans
2022-09-22 00:40:45 INFO  ---RUNTIME: Execution took 31076.162338256836 ms
2022-09-22 00:40:45 INFO  Done!
2022-09-22 00:40:45 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-22 00:40:45 INFO  Running instrumented original pipeline...
2022-09-22 00:40:45 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-22 00:40:45 INFO  ---RUNTIME: Importing and monkey-patching took 5.808830261230469 ms
2022-09-22 00:40:56 INFO  ---RUNTIME: Original pipeline execution took 10818.873882293701 ms (excluding imports and monkey-patching)
2022-09-22 00:40:56 INFO  Starting execution of 1 what-if analyses...
2022-09-22 00:40:56 INFO  Start plan generation for analysis DataCorruption...
2022-09-22 00:40:56 INFO  ---RUNTIME: Plan generation took 0.42057037353515625 ms
2022-09-22 00:40:56 INFO  Estimated runtime of original DAG is 8514.700889587402ms
2022-09-22 00:40:56 WARNING Skipping Multi-Query Optimization (instead, only applying patches)
2022-09-22 00:40:56 INFO  Estimated unoptimised what-if runtime is 212867.52223968506ms
2022-09-22 00:40:56 INFO  ---RUNTIME: Multi-Query Optimization took 18.796205520629883 ms
2022-09-22 00:40:56 INFO  Executing generated plans
2022-09-22 00:45:10 INFO  ---RUNTIME: Execution took 254523.5357284546 ms
2022-09-22 00:45:10 INFO  Done!
2022-09-22 00:45:10 INFO  # Finished -- repetition 3 of 7 
2022-09-22 00:45:10 INFO  # Optimization benchmark for data_corruption with args [['reviews', 'fast_loading', 'featurization_1', 'neural_network']] -- repetition 4 of 7
2022-09-22 00:45:10 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-22 00:45:10 INFO  Running instrumented original pipeline...
2022-09-22 00:45:11 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-22 00:45:11 INFO  ---RUNTIME: Importing and monkey-patching took 6.387948989868164 ms
2022-09-22 00:45:22 INFO  ---RUNTIME: Original pipeline execution took 11432.729005813599 ms (excluding imports and monkey-patching)
2022-09-22 00:45:22 INFO  Starting execution of 1 what-if analyses...
2022-09-22 00:45:22 INFO  Start plan generation for analysis DataCorruption...
2022-09-22 00:45:22 INFO  ---RUNTIME: Plan generation took 0.4596710205078125 ms
2022-09-22 00:45:22 INFO  Estimated runtime of original DAG is 8745.710134506226ms
2022-09-22 00:45:22 INFO  Performing Multi-Query Optimization
2022-09-22 00:45:22 INFO  Estimated unoptimized what-if runtime is 218642.75336265564ms
2022-09-22 00:45:22 INFO  Estimated optimised what-if runtime is 26319.19550895691ms
2022-09-22 00:45:22 INFO  Estimated optimisation runtime saving is 192323.55785369873ms
2022-09-22 00:45:22 INFO  ---RUNTIME: Multi-Query Optimization took 65.9482479095459 ms
2022-09-22 00:45:22 INFO  Executing generated plans
2022-09-22 00:45:53 INFO  ---RUNTIME: Execution took 30918.994426727295 ms
2022-09-22 00:45:53 INFO  Done!
2022-09-22 00:45:53 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-22 00:45:53 INFO  Running instrumented original pipeline...
2022-09-22 00:45:53 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-22 00:45:53 INFO  ---RUNTIME: Importing and monkey-patching took 5.8574676513671875 ms
2022-09-22 00:46:03 INFO  ---RUNTIME: Original pipeline execution took 10852.75149345398 ms (excluding imports and monkey-patching)
2022-09-22 00:46:03 INFO  Starting execution of 1 what-if analyses...
2022-09-22 00:46:03 INFO  Start plan generation for analysis DataCorruption...
2022-09-22 00:46:03 INFO  ---RUNTIME: Plan generation took 0.3914833068847656 ms
2022-09-22 00:46:03 INFO  Estimated runtime of original DAG is 8539.499044418335ms
2022-09-22 00:46:03 WARNING Skipping Multi-Query Optimization (instead, only applying patches)
2022-09-22 00:46:04 INFO  Estimated unoptimised what-if runtime is 213487.47611045837ms
2022-09-22 00:46:04 INFO  ---RUNTIME: Multi-Query Optimization took 19.580364227294922 ms
2022-09-22 00:46:04 INFO  Executing generated plans
2022-09-22 00:50:18 INFO  ---RUNTIME: Execution took 254069.08917427063 ms
2022-09-22 00:50:18 INFO  Done!
2022-09-22 00:50:18 INFO  # Finished -- repetition 4 of 7 
2022-09-22 00:50:18 INFO  # Optimization benchmark for data_corruption with args [['reviews', 'fast_loading', 'featurization_1', 'neural_network']] -- repetition 5 of 7
2022-09-22 00:50:18 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-22 00:50:18 INFO  Running instrumented original pipeline...
2022-09-22 00:50:18 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-22 00:50:18 INFO  ---RUNTIME: Importing and monkey-patching took 6.562471389770508 ms
2022-09-22 00:50:29 INFO  ---RUNTIME: Original pipeline execution took 11363.731145858765 ms (excluding imports and monkey-patching)
2022-09-22 00:50:29 INFO  Starting execution of 1 what-if analyses...
2022-09-22 00:50:29 INFO  Start plan generation for analysis DataCorruption...
2022-09-22 00:50:29 INFO  ---RUNTIME: Plan generation took 0.42438507080078125 ms
2022-09-22 00:50:29 INFO  Estimated runtime of original DAG is 8675.247192382812ms
2022-09-22 00:50:29 INFO  Performing Multi-Query Optimization
2022-09-22 00:50:29 INFO  Estimated unoptimized what-if runtime is 216881.1798095703ms
2022-09-22 00:50:29 INFO  Estimated optimised what-if runtime is 26240.82374572754ms
2022-09-22 00:50:29 INFO  Estimated optimisation runtime saving is 190640.35606384277ms
2022-09-22 00:50:29 INFO  ---RUNTIME: Multi-Query Optimization took 68.62235069274902 ms
2022-09-22 00:50:29 INFO  Executing generated plans
2022-09-22 00:51:00 INFO  ---RUNTIME: Execution took 30731.412172317505 ms
2022-09-22 00:51:00 INFO  Done!
2022-09-22 00:51:00 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-22 00:51:00 INFO  Running instrumented original pipeline...
2022-09-22 00:51:00 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-22 00:51:00 INFO  ---RUNTIME: Importing and monkey-patching took 5.742549896240234 ms
2022-09-22 00:51:11 INFO  ---RUNTIME: Original pipeline execution took 10760.216236114502 ms (excluding imports and monkey-patching)
2022-09-22 00:51:11 INFO  Starting execution of 1 what-if analyses...
2022-09-22 00:51:11 INFO  Start plan generation for analysis DataCorruption...
2022-09-22 00:51:11 INFO  ---RUNTIME: Plan generation took 0.3917217254638672 ms
2022-09-22 00:51:11 INFO  Estimated runtime of original DAG is 8470.604419708252ms
2022-09-22 00:51:11 WARNING Skipping Multi-Query Optimization (instead, only applying patches)
2022-09-22 00:51:11 INFO  Estimated unoptimised what-if runtime is 211765.1104927063ms
2022-09-22 00:51:11 INFO  ---RUNTIME: Multi-Query Optimization took 17.97318458557129 ms
2022-09-22 00:51:11 INFO  Executing generated plans
2022-09-22 00:55:16 INFO  ---RUNTIME: Execution took 245508.4900856018 ms
2022-09-22 00:55:16 INFO  Done!
2022-09-22 00:55:16 INFO  # Finished -- repetition 5 of 7 
2022-09-22 00:55:16 INFO  # Optimization benchmark for data_corruption with args [['reviews', 'fast_loading', 'featurization_1', 'neural_network']] -- repetition 6 of 7
2022-09-22 00:55:16 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-22 00:55:16 INFO  Running instrumented original pipeline...
2022-09-22 00:55:16 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-22 00:55:16 INFO  ---RUNTIME: Importing and monkey-patching took 6.178140640258789 ms
2022-09-22 00:55:27 INFO  ---RUNTIME: Original pipeline execution took 10860.735654830933 ms (excluding imports and monkey-patching)
2022-09-22 00:55:27 INFO  Starting execution of 1 what-if analyses...
2022-09-22 00:55:27 INFO  Start plan generation for analysis DataCorruption...
2022-09-22 00:55:27 INFO  ---RUNTIME: Plan generation took 1.9085407257080078 ms
2022-09-22 00:55:27 INFO  Estimated runtime of original DAG is 8644.413232803345ms
2022-09-22 00:55:27 INFO  Performing Multi-Query Optimization
2022-09-22 00:55:27 INFO  Estimated unoptimized what-if runtime is 216110.33082008362ms
2022-09-22 00:55:27 INFO  Estimated optimised what-if runtime is 24867.91229248047ms
2022-09-22 00:55:27 INFO  Estimated optimisation runtime saving is 191242.41852760315ms
2022-09-22 00:55:27 INFO  ---RUNTIME: Multi-Query Optimization took 60.858964920043945 ms
2022-09-22 00:55:27 INFO  Executing generated plans
2022-09-22 00:55:57 INFO  ---RUNTIME: Execution took 29842.384815216064 ms
2022-09-22 00:55:57 INFO  Done!
2022-09-22 00:55:57 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-22 00:55:57 INFO  Running instrumented original pipeline...
2022-09-22 00:55:57 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-22 00:55:57 INFO  ---RUNTIME: Importing and monkey-patching took 6.005525588989258 ms
2022-09-22 00:56:07 INFO  ---RUNTIME: Original pipeline execution took 10519.844055175781 ms (excluding imports and monkey-patching)
2022-09-22 00:56:07 INFO  Starting execution of 1 what-if analyses...
2022-09-22 00:56:07 INFO  Start plan generation for analysis DataCorruption...
2022-09-22 00:56:07 INFO  ---RUNTIME: Plan generation took 0.41413307189941406 ms
2022-09-22 00:56:07 INFO  Estimated runtime of original DAG is 8289.403200149536ms
2022-09-22 00:56:07 WARNING Skipping Multi-Query Optimization (instead, only applying patches)
2022-09-22 00:56:07 INFO  Estimated unoptimised what-if runtime is 207235.0800037384ms
2022-09-22 00:56:07 INFO  ---RUNTIME: Multi-Query Optimization took 18.649816513061523 ms
2022-09-22 00:56:07 INFO  Executing generated plans
2022-09-22 01:00:11 INFO  ---RUNTIME: Execution took 243168.28966140747 ms
2022-09-22 01:00:11 INFO  Done!
2022-09-22 01:00:11 INFO  # Finished -- repetition 6 of 7 
2022-09-22 01:00:11 INFO  # Optimization benchmark for data_corruption with args [['reviews', 'fast_loading', 'featurization_1', 'neural_network']] -- repetition 7 of 7
2022-09-22 01:00:11 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-22 01:00:11 INFO  Running instrumented original pipeline...
2022-09-22 01:00:11 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-22 01:00:11 INFO  ---RUNTIME: Importing and monkey-patching took 6.132602691650391 ms
2022-09-22 01:00:21 INFO  ---RUNTIME: Original pipeline execution took 10490.49186706543 ms (excluding imports and monkey-patching)
2022-09-22 01:00:21 INFO  Starting execution of 1 what-if analyses...
2022-09-22 01:00:21 INFO  Start plan generation for analysis DataCorruption...
2022-09-22 01:00:21 INFO  ---RUNTIME: Plan generation took 2.5115013122558594 ms
2022-09-22 01:00:21 INFO  Estimated runtime of original DAG is 8276.975154876709ms
2022-09-22 01:00:21 INFO  Performing Multi-Query Optimization
2022-09-22 01:00:21 INFO  Estimated unoptimized what-if runtime is 206924.37887191772ms
2022-09-22 01:00:21 INFO  Estimated optimised what-if runtime is 24401.58748626709ms
2022-09-22 01:00:21 INFO  Estimated optimisation runtime saving is 182522.79138565063ms
2022-09-22 01:00:21 INFO  ---RUNTIME: Multi-Query Optimization took 61.54441833496094 ms
2022-09-22 01:00:21 INFO  Executing generated plans
2022-09-22 01:00:51 INFO  ---RUNTIME: Execution took 30152.59289741516 ms
2022-09-22 01:00:51 INFO  Done!
2022-09-22 01:00:51 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-22 01:00:51 INFO  Running instrumented original pipeline...
2022-09-22 01:00:51 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-22 01:00:51 INFO  ---RUNTIME: Importing and monkey-patching took 5.8002471923828125 ms
2022-09-22 01:01:02 INFO  ---RUNTIME: Original pipeline execution took 10515.892744064331 ms (excluding imports and monkey-patching)
2022-09-22 01:01:02 INFO  Starting execution of 1 what-if analyses...
2022-09-22 01:01:02 INFO  Start plan generation for analysis DataCorruption...
2022-09-22 01:01:02 INFO  ---RUNTIME: Plan generation took 0.396728515625 ms
2022-09-22 01:01:02 INFO  Estimated runtime of original DAG is 8266.297817230225ms
2022-09-22 01:01:02 WARNING Skipping Multi-Query Optimization (instead, only applying patches)
2022-09-22 01:01:02 INFO  Estimated unoptimised what-if runtime is 206657.44543075562ms
2022-09-22 01:01:02 INFO  ---RUNTIME: Multi-Query Optimization took 18.669843673706055 ms
2022-09-22 01:01:02 INFO  Executing generated plans
2022-09-22 01:05:05 INFO  ---RUNTIME: Execution took 242838.9868736267 ms
2022-09-22 01:05:05 INFO  Done!
2022-09-22 01:05:05 INFO  # Finished -- repetition 7 of 7 
2022-09-22 01:05:05 INFO  # Final results after all repetitions
2022-09-22 01:05:05 INFO     repetition  ... no_opt_what_if_execution_combined_model_training
0           0  ...                                     86604.557276
1           1  ...                                     85561.040878
2           2  ...                                     85837.144613
3           3  ...                                     86239.442587
4           4  ...                                     81826.203108
5           5  ...                                     80440.268278
6           6  ...                                     80266.005278

[7 rows x 26 columns]
taskset -c 32-39 PROTOCOL_BUFFERS_PYTHON_IMPLEMENTATION=python python3.9 benchmarks_end_to_end.py data_corruption reviews fast_loading featurization_2 logistic_regression
2022-09-22 01:05:07.631019: W tensorflow/stream_executor/platform/default/dso_loader.cc:64] Could not load dynamic library 'libcudart.so.11.0'; dlerror: libcudart.so.11.0: cannot open shared object file: No such file or directory; LD_LIBRARY_PATH: /home/sgrafbe/mlwhatif/venv/lib/python3.9/site-packages/cv2/../../lib64:
2022-09-22 01:05:07.631067: I tensorflow/stream_executor/cuda/cudart_stub.cc:29] Ignore above cudart dlerror if you do not have a GPU set up on your machine.
2022-09-22 01:05:08 INFO  Patching sys.argv with ['mlwhatif', 'reviews', 'fast_loading', 'featurization_2', 'logistic_regression']
2022-09-22 01:05:08 INFO  Running instrumented original pipeline...
2022-09-22 01:05:08 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-22 01:05:09 INFO  ---RUNTIME: Importing and monkey-patching took 121.5219497680664 ms
2022-09-22 01:05:15 INFO  ---RUNTIME: Original pipeline execution took 6659.680604934692 ms (excluding imports and monkey-patching)
2022-09-22 01:05:15 INFO  Starting execution of 0 what-if analyses...
2022-09-22 01:05:15 INFO  Estimated runtime of original DAG is 5487.081527709961ms
2022-09-22 01:05:15 INFO  Performing Multi-Query Optimization
2022-09-22 01:05:15 INFO  Estimated unoptimized what-if runtime is 0ms
2022-09-22 01:05:15 INFO  Estimated optimised what-if runtime is 0ms
2022-09-22 01:05:15 INFO  Estimated optimisation runtime saving is 0ms
2022-09-22 01:05:15 INFO  ---RUNTIME: Multi-Query Optimization took 0.5846023559570312 ms
2022-09-22 01:05:15 INFO  Executing generated plans
2022-09-22 01:05:15 INFO  ---RUNTIME: Execution took 0.026464462280273438 ms
2022-09-22 01:05:15 INFO  Done!
2022-09-22 01:05:15 INFO  # Optimization benchmark for data_corruption with args [['reviews', 'fast_loading', 'featurization_2', 'logistic_regression']] -- repetition 1 of 7
2022-09-22 01:05:15 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-22 01:05:15 INFO  Running instrumented original pipeline...
2022-09-22 01:05:15 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-22 01:05:15 INFO  ---RUNTIME: Importing and monkey-patching took 5.423545837402344 ms
2022-09-22 01:05:22 INFO  ---RUNTIME: Original pipeline execution took 6789.413928985596 ms (excluding imports and monkey-patching)
2022-09-22 01:05:22 INFO  Starting execution of 1 what-if analyses...
2022-09-22 01:05:22 INFO  Start plan generation for analysis DataCorruption...
2022-09-22 01:05:22 INFO  ---RUNTIME: Plan generation took 0.44798851013183594 ms
2022-09-22 01:05:22 INFO  Estimated runtime of original DAG is 5621.601581573486ms
2022-09-22 01:05:22 INFO  Performing Multi-Query Optimization
2022-09-22 01:05:22 INFO  Estimated unoptimized what-if runtime is 140540.03953933716ms
2022-09-22 01:05:22 INFO  Estimated optimised what-if runtime is 13746.77300453186ms
2022-09-22 01:05:22 INFO  Estimated optimisation runtime saving is 126793.2665348053ms
2022-09-22 01:05:22 INFO  ---RUNTIME: Multi-Query Optimization took 66.5891170501709 ms
2022-09-22 01:05:22 INFO  Executing generated plans
2022-09-22 01:05:41 INFO  ---RUNTIME: Execution took 19014.325857162476 ms
2022-09-22 01:05:41 INFO  Done!
2022-09-22 01:05:41 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-22 01:05:41 INFO  Running instrumented original pipeline...
2022-09-22 01:05:41 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-22 01:05:41 INFO  ---RUNTIME: Importing and monkey-patching took 6.089448928833008 ms
2022-09-22 01:05:48 INFO  ---RUNTIME: Original pipeline execution took 6592.520713806152 ms (excluding imports and monkey-patching)
2022-09-22 01:05:48 INFO  Starting execution of 1 what-if analyses...
2022-09-22 01:05:48 INFO  Start plan generation for analysis DataCorruption...
2022-09-22 01:05:48 INFO  ---RUNTIME: Plan generation took 0.4723072052001953 ms
2022-09-22 01:05:48 INFO  Estimated runtime of original DAG is 5433.234214782715ms
2022-09-22 01:05:48 WARNING Skipping Multi-Query Optimization (instead, only applying patches)
2022-09-22 01:05:48 INFO  Estimated unoptimised what-if runtime is 135830.85536956787ms
2022-09-22 01:05:48 INFO  ---RUNTIME: Multi-Query Optimization took 19.37270164489746 ms
2022-09-22 01:05:48 INFO  Executing generated plans
2022-09-22 01:08:38 INFO  ---RUNTIME: Execution took 169875.9961128235 ms
2022-09-22 01:08:38 INFO  Done!
2022-09-22 01:08:38 INFO  # Finished -- repetition 1 of 7 
2022-09-22 01:08:38 INFO  # Optimization benchmark for data_corruption with args [['reviews', 'fast_loading', 'featurization_2', 'logistic_regression']] -- repetition 2 of 7
2022-09-22 01:08:38 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-22 01:08:38 INFO  Running instrumented original pipeline...
2022-09-22 01:08:38 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-22 01:08:38 INFO  ---RUNTIME: Importing and monkey-patching took 6.030082702636719 ms
2022-09-22 01:08:44 INFO  ---RUNTIME: Original pipeline execution took 6589.33687210083 ms (excluding imports and monkey-patching)
2022-09-22 01:08:44 INFO  Starting execution of 1 what-if analyses...
2022-09-22 01:08:44 INFO  Start plan generation for analysis DataCorruption...
2022-09-22 01:08:44 INFO  ---RUNTIME: Plan generation took 0.4184246063232422 ms
2022-09-22 01:08:44 INFO  Estimated runtime of original DAG is 5411.8242263793945ms
2022-09-22 01:08:44 INFO  Performing Multi-Query Optimization
2022-09-22 01:08:44 INFO  Estimated unoptimized what-if runtime is 135295.60565948486ms
2022-09-22 01:08:44 INFO  Estimated optimised what-if runtime is 13489.385843276978ms
2022-09-22 01:08:44 INFO  Estimated optimisation runtime saving is 121806.21981620789ms
2022-09-22 01:08:44 INFO  ---RUNTIME: Multi-Query Optimization took 65.89722633361816 ms
2022-09-22 01:08:44 INFO  Executing generated plans
2022-09-22 01:09:03 INFO  ---RUNTIME: Execution took 18806.462049484253 ms
2022-09-22 01:09:03 INFO  Done!
2022-09-22 01:09:03 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-22 01:09:03 INFO  Running instrumented original pipeline...
2022-09-22 01:09:03 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-22 01:09:03 INFO  ---RUNTIME: Importing and monkey-patching took 5.592584609985352 ms
2022-09-22 01:09:10 INFO  ---RUNTIME: Original pipeline execution took 6592.462539672852 ms (excluding imports and monkey-patching)
2022-09-22 01:09:10 INFO  Starting execution of 1 what-if analyses...
2022-09-22 01:09:10 INFO  Start plan generation for analysis DataCorruption...
2022-09-22 01:09:10 INFO  ---RUNTIME: Plan generation took 0.4069805145263672 ms
2022-09-22 01:09:10 INFO  Estimated runtime of original DAG is 5418.923139572144ms
2022-09-22 01:09:10 WARNING Skipping Multi-Query Optimization (instead, only applying patches)
2022-09-22 01:09:10 INFO  Estimated unoptimised what-if runtime is 135473.0784893036ms
2022-09-22 01:09:10 INFO  ---RUNTIME: Multi-Query Optimization took 19.35291290283203 ms
2022-09-22 01:09:10 INFO  Executing generated plans
2022-09-22 01:12:00 INFO  ---RUNTIME: Execution took 169824.29909706116 ms
2022-09-22 01:12:00 INFO  Done!
2022-09-22 01:12:00 INFO  # Finished -- repetition 2 of 7 
2022-09-22 01:12:00 INFO  # Optimization benchmark for data_corruption with args [['reviews', 'fast_loading', 'featurization_2', 'logistic_regression']] -- repetition 3 of 7
2022-09-22 01:12:00 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-22 01:12:00 INFO  Running instrumented original pipeline...
2022-09-22 01:12:00 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-22 01:12:00 INFO  ---RUNTIME: Importing and monkey-patching took 5.884885787963867 ms
2022-09-22 01:12:06 INFO  ---RUNTIME: Original pipeline execution took 6813.108205795288 ms (excluding imports and monkey-patching)
2022-09-22 01:12:06 INFO  Starting execution of 1 what-if analyses...
2022-09-22 01:12:06 INFO  Start plan generation for analysis DataCorruption...
2022-09-22 01:12:06 INFO  ---RUNTIME: Plan generation took 0.4379749298095703 ms
2022-09-22 01:12:06 INFO  Estimated runtime of original DAG is 5410.988330841064ms
2022-09-22 01:12:06 INFO  Performing Multi-Query Optimization
2022-09-22 01:12:06 INFO  Estimated unoptimized what-if runtime is 135274.7082710266ms
2022-09-22 01:12:06 INFO  Estimated optimised what-if runtime is 13485.657691955566ms
2022-09-22 01:12:06 INFO  Estimated optimisation runtime saving is 121789.05057907104ms
2022-09-22 01:12:06 INFO  ---RUNTIME: Multi-Query Optimization took 65.12856483459473 ms
2022-09-22 01:12:06 INFO  Executing generated plans
2022-09-22 01:12:25 INFO  ---RUNTIME: Execution took 18984.061002731323 ms
2022-09-22 01:12:25 INFO  Done!
2022-09-22 01:12:25 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-22 01:12:25 INFO  Running instrumented original pipeline...
2022-09-22 01:12:25 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-22 01:12:25 INFO  ---RUNTIME: Importing and monkey-patching took 5.707740783691406 ms
2022-09-22 01:12:32 INFO  ---RUNTIME: Original pipeline execution took 6709.429979324341 ms (excluding imports and monkey-patching)
2022-09-22 01:12:32 INFO  Starting execution of 1 what-if analyses...
2022-09-22 01:12:32 INFO  Start plan generation for analysis DataCorruption...
2022-09-22 01:12:32 INFO  ---RUNTIME: Plan generation took 0.45228004455566406 ms
2022-09-22 01:12:32 INFO  Estimated runtime of original DAG is 5506.37149810791ms
2022-09-22 01:12:32 WARNING Skipping Multi-Query Optimization (instead, only applying patches)
2022-09-22 01:12:32 INFO  Estimated unoptimised what-if runtime is 137659.28745269775ms
2022-09-22 01:12:32 INFO  ---RUNTIME: Multi-Query Optimization took 19.56629753112793 ms
2022-09-22 01:12:32 INFO  Executing generated plans
2022-09-22 01:15:49 INFO  ---RUNTIME: Execution took 196803.92026901245 ms
2022-09-22 01:15:49 INFO  Done!
2022-09-22 01:15:49 INFO  # Finished -- repetition 3 of 7 
2022-09-22 01:15:49 INFO  # Optimization benchmark for data_corruption with args [['reviews', 'fast_loading', 'featurization_2', 'logistic_regression']] -- repetition 4 of 7
2022-09-22 01:15:49 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-22 01:15:49 INFO  Running instrumented original pipeline...
2022-09-22 01:15:49 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-22 01:15:49 INFO  ---RUNTIME: Importing and monkey-patching took 9.174108505249023 ms
2022-09-22 01:15:59 INFO  ---RUNTIME: Original pipeline execution took 10200.520277023315 ms (excluding imports and monkey-patching)
2022-09-22 01:15:59 INFO  Starting execution of 1 what-if analyses...
2022-09-22 01:15:59 INFO  Start plan generation for analysis DataCorruption...
2022-09-22 01:15:59 INFO  ---RUNTIME: Plan generation took 0.6957054138183594 ms
2022-09-22 01:15:59 INFO  Estimated runtime of original DAG is 8333.646774291992ms
2022-09-22 01:15:59 INFO  Performing Multi-Query Optimization
2022-09-22 01:15:59 INFO  Estimated unoptimized what-if runtime is 208341.1693572998ms
2022-09-22 01:15:59 INFO  Estimated optimised what-if runtime is 20176.192045211792ms
2022-09-22 01:15:59 INFO  Estimated optimisation runtime saving is 188164.977312088ms
2022-09-22 01:15:59 INFO  ---RUNTIME: Multi-Query Optimization took 107.50460624694824 ms
2022-09-22 01:15:59 INFO  Executing generated plans
2022-09-22 01:16:28 INFO  ---RUNTIME: Execution took 28337.31722831726 ms
2022-09-22 01:16:28 INFO  Done!
2022-09-22 01:16:28 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-22 01:16:28 INFO  Running instrumented original pipeline...
2022-09-22 01:16:28 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-22 01:16:28 INFO  ---RUNTIME: Importing and monkey-patching took 8.15582275390625 ms
2022-09-22 01:16:38 INFO  ---RUNTIME: Original pipeline execution took 10210.644006729126 ms (excluding imports and monkey-patching)
2022-09-22 01:16:38 INFO  Starting execution of 1 what-if analyses...
2022-09-22 01:16:38 INFO  Start plan generation for analysis DataCorruption...
2022-09-22 01:16:38 INFO  ---RUNTIME: Plan generation took 0.5626678466796875 ms
2022-09-22 01:16:38 INFO  Estimated runtime of original DAG is 8492.93065071106ms
2022-09-22 01:16:38 WARNING Skipping Multi-Query Optimization (instead, only applying patches)
2022-09-22 01:16:38 INFO  Estimated unoptimised what-if runtime is 212323.2662677765ms
2022-09-22 01:16:38 INFO  ---RUNTIME: Multi-Query Optimization took 30.996322631835938 ms
2022-09-22 01:16:38 INFO  Executing generated plans
2022-09-22 01:20:46 INFO  ---RUNTIME: Execution took 248131.06966018677 ms
2022-09-22 01:20:46 INFO  Done!
2022-09-22 01:20:46 INFO  # Finished -- repetition 4 of 7 
2022-09-22 01:20:46 INFO  # Optimization benchmark for data_corruption with args [['reviews', 'fast_loading', 'featurization_2', 'logistic_regression']] -- repetition 5 of 7
2022-09-22 01:20:46 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-22 01:20:46 INFO  Running instrumented original pipeline...
2022-09-22 01:20:46 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-22 01:20:46 INFO  ---RUNTIME: Importing and monkey-patching took 8.893966674804688 ms
2022-09-22 01:20:54 INFO  ---RUNTIME: Original pipeline execution took 8417.990446090698 ms (excluding imports and monkey-patching)
2022-09-22 01:20:54 INFO  Starting execution of 1 what-if analyses...
2022-09-22 01:20:54 INFO  Start plan generation for analysis DataCorruption...
2022-09-22 01:20:54 INFO  ---RUNTIME: Plan generation took 0.408172607421875 ms
2022-09-22 01:20:54 INFO  Estimated runtime of original DAG is 6699.5556354522705ms
2022-09-22 01:20:54 INFO  Performing Multi-Query Optimization
2022-09-22 01:20:55 INFO  Estimated unoptimized what-if runtime is 167488.89088630676ms
2022-09-22 01:20:55 INFO  Estimated optimised what-if runtime is 14781.149864196777ms
2022-09-22 01:20:55 INFO  Estimated optimisation runtime saving is 152707.74102210999ms
2022-09-22 01:20:55 INFO  ---RUNTIME: Multi-Query Optimization took 65.2165412902832 ms
2022-09-22 01:20:55 INFO  Executing generated plans
2022-09-22 01:21:18 INFO  ---RUNTIME: Execution took 23385.06054878235 ms
2022-09-22 01:21:18 INFO  Done!
2022-09-22 01:21:18 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-22 01:21:18 INFO  Running instrumented original pipeline...
2022-09-22 01:21:18 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-22 01:21:18 INFO  ---RUNTIME: Importing and monkey-patching took 8.046388626098633 ms
2022-09-22 01:21:29 INFO  ---RUNTIME: Original pipeline execution took 10690.707683563232 ms (excluding imports and monkey-patching)
2022-09-22 01:21:29 INFO  Starting execution of 1 what-if analyses...
2022-09-22 01:21:29 INFO  Start plan generation for analysis DataCorruption...
2022-09-22 01:21:29 INFO  ---RUNTIME: Plan generation took 0.5474090576171875 ms
2022-09-22 01:21:29 INFO  Estimated runtime of original DAG is 8431.98037147522ms
2022-09-22 01:21:29 WARNING Skipping Multi-Query Optimization (instead, only applying patches)
2022-09-22 01:21:29 INFO  Estimated unoptimised what-if runtime is 210799.5092868805ms
2022-09-22 01:21:29 INFO  ---RUNTIME: Multi-Query Optimization took 28.467655181884766 ms
2022-09-22 01:21:29 INFO  Executing generated plans
2022-09-22 01:25:13 INFO  ---RUNTIME: Execution took 224440.65189361572 ms
2022-09-22 01:25:13 INFO  Done!
2022-09-22 01:25:13 INFO  # Finished -- repetition 5 of 7 
2022-09-22 01:25:13 INFO  # Optimization benchmark for data_corruption with args [['reviews', 'fast_loading', 'featurization_2', 'logistic_regression']] -- repetition 6 of 7
2022-09-22 01:25:13 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-22 01:25:13 INFO  Running instrumented original pipeline...
2022-09-22 01:25:13 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-22 01:25:13 INFO  ---RUNTIME: Importing and monkey-patching took 5.869865417480469 ms
2022-09-22 01:25:20 INFO  ---RUNTIME: Original pipeline execution took 6723.190546035767 ms (excluding imports and monkey-patching)
2022-09-22 01:25:20 INFO  Starting execution of 1 what-if analyses...
2022-09-22 01:25:20 INFO  Start plan generation for analysis DataCorruption...
2022-09-22 01:25:20 INFO  ---RUNTIME: Plan generation took 0.44798851013183594 ms
2022-09-22 01:25:20 INFO  Estimated runtime of original DAG is 5534.2042446136475ms
2022-09-22 01:25:20 INFO  Performing Multi-Query Optimization
2022-09-22 01:25:20 INFO  Estimated unoptimized what-if runtime is 138355.1061153412ms
2022-09-22 01:25:20 INFO  Estimated optimised what-if runtime is 14000.331163406372ms
2022-09-22 01:25:20 INFO  Estimated optimisation runtime saving is 124354.77495193481ms
2022-09-22 01:25:20 INFO  ---RUNTIME: Multi-Query Optimization took 116.37425422668457 ms
2022-09-22 01:25:20 INFO  Executing generated plans
2022-09-22 01:25:45 INFO  ---RUNTIME: Execution took 24670.724153518677 ms
2022-09-22 01:25:45 INFO  Done!
2022-09-22 01:25:45 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-22 01:25:45 INFO  Running instrumented original pipeline...
2022-09-22 01:25:45 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-22 01:25:45 INFO  ---RUNTIME: Importing and monkey-patching took 11.246204376220703 ms
2022-09-22 01:25:55 INFO  ---RUNTIME: Original pipeline execution took 10181.278228759766 ms (excluding imports and monkey-patching)
2022-09-22 01:25:55 INFO  Starting execution of 1 what-if analyses...
2022-09-22 01:25:55 INFO  Start plan generation for analysis DataCorruption...
2022-09-22 01:25:55 INFO  ---RUNTIME: Plan generation took 1.949310302734375 ms
2022-09-22 01:25:55 INFO  Estimated runtime of original DAG is 8399.580955505371ms
2022-09-22 01:25:55 WARNING Skipping Multi-Query Optimization (instead, only applying patches)
2022-09-22 01:25:55 INFO  Estimated unoptimised what-if runtime is 209989.52388763428ms
2022-09-22 01:25:55 INFO  ---RUNTIME: Multi-Query Optimization took 30.371904373168945 ms
2022-09-22 01:25:55 INFO  Executing generated plans
2022-09-22 01:29:52 INFO  ---RUNTIME: Execution took 237567.58999824524 ms
2022-09-22 01:29:52 INFO  Done!
2022-09-22 01:29:52 INFO  # Finished -- repetition 6 of 7 
2022-09-22 01:29:52 INFO  # Optimization benchmark for data_corruption with args [['reviews', 'fast_loading', 'featurization_2', 'logistic_regression']] -- repetition 7 of 7
2022-09-22 01:29:52 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-22 01:29:52 INFO  Running instrumented original pipeline...
2022-09-22 01:29:53 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-22 01:29:53 INFO  ---RUNTIME: Importing and monkey-patching took 10.538578033447266 ms
2022-09-22 01:30:03 INFO  ---RUNTIME: Original pipeline execution took 10516.18504524231 ms (excluding imports and monkey-patching)
2022-09-22 01:30:03 INFO  Starting execution of 1 what-if analyses...
2022-09-22 01:30:03 INFO  Start plan generation for analysis DataCorruption...
2022-09-22 01:30:03 INFO  ---RUNTIME: Plan generation took 0.6289482116699219 ms
2022-09-22 01:30:03 INFO  Estimated runtime of original DAG is 8824.809312820435ms
2022-09-22 01:30:03 INFO  Performing Multi-Query Optimization
2022-09-22 01:30:03 INFO  Estimated unoptimized what-if runtime is 220620.23282051086ms
2022-09-22 01:30:03 INFO  Estimated optimised what-if runtime is 21640.453815460205ms
2022-09-22 01:30:03 INFO  Estimated optimisation runtime saving is 198979.77900505066ms
2022-09-22 01:30:03 INFO  ---RUNTIME: Multi-Query Optimization took 114.99762535095215 ms
2022-09-22 01:30:03 INFO  Executing generated plans
2022-09-22 01:30:32 INFO  ---RUNTIME: Execution took 28649.22070503235 ms
2022-09-22 01:30:32 INFO  Done!
2022-09-22 01:30:32 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-22 01:30:32 INFO  Running instrumented original pipeline...
2022-09-22 01:30:32 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-22 01:30:32 INFO  ---RUNTIME: Importing and monkey-patching took 6.91533088684082 ms
2022-09-22 01:30:42 INFO  ---RUNTIME: Original pipeline execution took 10090.15965461731 ms (excluding imports and monkey-patching)
2022-09-22 01:30:42 INFO  Starting execution of 1 what-if analyses...
2022-09-22 01:30:42 INFO  Start plan generation for analysis DataCorruption...
2022-09-22 01:30:42 INFO  ---RUNTIME: Plan generation took 0.5548000335693359 ms
2022-09-22 01:30:42 INFO  Estimated runtime of original DAG is 8300.772905349731ms
2022-09-22 01:30:42 WARNING Skipping Multi-Query Optimization (instead, only applying patches)
2022-09-22 01:30:42 INFO  Estimated unoptimised what-if runtime is 207519.3226337433ms
2022-09-22 01:30:42 INFO  ---RUNTIME: Multi-Query Optimization took 33.13493728637695 ms
2022-09-22 01:30:42 INFO  Executing generated plans
2022-09-22 01:34:34 INFO  ---RUNTIME: Execution took 232347.6505279541 ms
2022-09-22 01:34:34 INFO  Done!
2022-09-22 01:34:34 INFO  # Finished -- repetition 7 of 7 
2022-09-22 01:34:34 INFO  # Final results after all repetitions
2022-09-22 01:34:34 INFO     repetition  ... no_opt_what_if_execution_combined_model_training
0           0  ...                                      2502.674818
1           1  ...                                      2450.721502
2           2  ...                                      3151.435852
3           3  ...                                      4447.499752
4           4  ...                                      3574.270010
5           5  ...                                      4159.509420
6           6  ...                                      4119.069815

[7 rows x 26 columns]
taskset -c 32-39 PROTOCOL_BUFFERS_PYTHON_IMPLEMENTATION=python python3.9 benchmarks_end_to_end.py data_corruption reviews fast_loading featurization_2 xgboost
2022-09-22 01:34:37.006267: W tensorflow/stream_executor/platform/default/dso_loader.cc:64] Could not load dynamic library 'libcudart.so.11.0'; dlerror: libcudart.so.11.0: cannot open shared object file: No such file or directory; LD_LIBRARY_PATH: /home/sgrafbe/mlwhatif/venv/lib/python3.9/site-packages/cv2/../../lib64:
2022-09-22 01:34:37.006317: I tensorflow/stream_executor/cuda/cudart_stub.cc:29] Ignore above cudart dlerror if you do not have a GPU set up on your machine.
2022-09-22 01:34:38 INFO  Patching sys.argv with ['mlwhatif', 'reviews', 'fast_loading', 'featurization_2', 'xgboost']
2022-09-22 01:34:38 INFO  Running instrumented original pipeline...
2022-09-22 01:34:38 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-22 01:34:38 INFO  ---RUNTIME: Importing and monkey-patching took 148.56934547424316 ms
2022-09-22 01:35:02 INFO  ---RUNTIME: Original pipeline execution took 23619.155168533325 ms (excluding imports and monkey-patching)
2022-09-22 01:35:02 INFO  Starting execution of 0 what-if analyses...
2022-09-22 01:35:02 INFO  Estimated runtime of original DAG is 21888.110876083374ms
2022-09-22 01:35:02 INFO  Performing Multi-Query Optimization
2022-09-22 01:35:02 INFO  Estimated unoptimized what-if runtime is 0ms
2022-09-22 01:35:02 INFO  Estimated optimised what-if runtime is 0ms
2022-09-22 01:35:02 INFO  Estimated optimisation runtime saving is 0ms
2022-09-22 01:35:02 INFO  ---RUNTIME: Multi-Query Optimization took 0.7586479187011719 ms
2022-09-22 01:35:02 INFO  Executing generated plans
2022-09-22 01:35:02 INFO  ---RUNTIME: Execution took 0.03314018249511719 ms
2022-09-22 01:35:02 INFO  Done!
2022-09-22 01:35:02 INFO  # Optimization benchmark for data_corruption with args [['reviews', 'fast_loading', 'featurization_2', 'xgboost']] -- repetition 1 of 7
2022-09-22 01:35:02 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-22 01:35:02 INFO  Running instrumented original pipeline...
2022-09-22 01:35:02 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-22 01:35:02 INFO  ---RUNTIME: Importing and monkey-patching took 13.129234313964844 ms
2022-09-22 01:35:26 INFO  ---RUNTIME: Original pipeline execution took 23873.20637702942 ms (excluding imports and monkey-patching)
2022-09-22 01:35:26 INFO  Starting execution of 1 what-if analyses...
2022-09-22 01:35:26 INFO  Start plan generation for analysis DataCorruption...
2022-09-22 01:35:26 INFO  ---RUNTIME: Plan generation took 0.6592273712158203 ms
2022-09-22 01:35:26 INFO  Estimated runtime of original DAG is 21832.47947692871ms
2022-09-22 01:35:26 INFO  Performing Multi-Query Optimization
2022-09-22 01:35:26 INFO  Estimated unoptimized what-if runtime is 545811.9869232178ms
2022-09-22 01:35:26 INFO  Estimated optimised what-if runtime is 34873.528480529785ms
2022-09-22 01:35:26 INFO  Estimated optimisation runtime saving is 510938.458442688ms
2022-09-22 01:35:26 INFO  ---RUNTIME: Multi-Query Optimization took 136.89637184143066 ms
2022-09-22 01:35:26 INFO  Executing generated plans
2022-09-22 01:36:06 INFO  ---RUNTIME: Execution took 40447.72744178772 ms
2022-09-22 01:36:06 INFO  Done!
2022-09-22 01:36:06 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-22 01:36:06 INFO  Running instrumented original pipeline...
2022-09-22 01:36:06 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-22 01:36:06 INFO  ---RUNTIME: Importing and monkey-patching took 6.097316741943359 ms
2022-09-22 01:36:30 INFO  ---RUNTIME: Original pipeline execution took 23525.6028175354 ms (excluding imports and monkey-patching)
2022-09-22 01:36:30 INFO  Starting execution of 1 what-if analyses...
2022-09-22 01:36:30 INFO  Start plan generation for analysis DataCorruption...
2022-09-22 01:36:30 INFO  ---RUNTIME: Plan generation took 0.44226646423339844 ms
2022-09-22 01:36:30 INFO  Estimated runtime of original DAG is 21673.927307128906ms
2022-09-22 01:36:30 WARNING Skipping Multi-Query Optimization (instead, only applying patches)
2022-09-22 01:36:30 INFO  Estimated unoptimised what-if runtime is 541848.1826782227ms
2022-09-22 01:36:30 INFO  ---RUNTIME: Multi-Query Optimization took 19.339799880981445 ms
2022-09-22 01:36:30 INFO  Executing generated plans
2022-09-22 01:46:57 INFO  ---RUNTIME: Execution took 627798.4609603882 ms
2022-09-22 01:46:58 INFO  Done!
2022-09-22 01:46:58 INFO  # Finished -- repetition 1 of 7 
2022-09-22 01:46:58 INFO  # Optimization benchmark for data_corruption with args [['reviews', 'fast_loading', 'featurization_2', 'xgboost']] -- repetition 2 of 7
2022-09-22 01:46:58 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-22 01:46:58 INFO  Running instrumented original pipeline...
2022-09-22 01:46:58 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-22 01:46:58 INFO  ---RUNTIME: Importing and monkey-patching took 6.148815155029297 ms
2022-09-22 01:47:21 INFO  ---RUNTIME: Original pipeline execution took 23364.575147628784 ms (excluding imports and monkey-patching)
2022-09-22 01:47:21 INFO  Starting execution of 1 what-if analyses...
2022-09-22 01:47:21 INFO  Start plan generation for analysis DataCorruption...
2022-09-22 01:47:21 INFO  ---RUNTIME: Plan generation took 0.4639625549316406 ms
2022-09-22 01:47:21 INFO  Estimated runtime of original DAG is 21567.143440246582ms
2022-09-22 01:47:21 INFO  Performing Multi-Query Optimization
2022-09-22 01:47:21 INFO  Estimated unoptimized what-if runtime is 539178.5860061646ms
2022-09-22 01:47:21 INFO  Estimated optimised what-if runtime is 31242.515087127686ms
2022-09-22 01:47:21 INFO  Estimated optimisation runtime saving is 507936.07091903687ms
2022-09-22 01:47:21 INFO  ---RUNTIME: Multi-Query Optimization took 67.28744506835938 ms
2022-09-22 01:47:21 INFO  Executing generated plans
2022-09-22 01:48:02 INFO  ---RUNTIME: Execution took 41372.00593948364 ms
2022-09-22 01:48:02 INFO  Done!
2022-09-22 01:48:02 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-22 01:48:02 INFO  Running instrumented original pipeline...
2022-09-22 01:48:02 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-22 01:48:02 INFO  ---RUNTIME: Importing and monkey-patching took 5.969524383544922 ms
2022-09-22 01:48:26 INFO  ---RUNTIME: Original pipeline execution took 23449.06997680664 ms (excluding imports and monkey-patching)
2022-09-22 01:48:26 INFO  Starting execution of 1 what-if analyses...
2022-09-22 01:48:26 INFO  Start plan generation for analysis DataCorruption...
2022-09-22 01:48:26 INFO  ---RUNTIME: Plan generation took 0.5474090576171875 ms
2022-09-22 01:48:26 INFO  Estimated runtime of original DAG is 21771.743535995483ms
2022-09-22 01:48:26 WARNING Skipping Multi-Query Optimization (instead, only applying patches)
2022-09-22 01:48:26 INFO  Estimated unoptimised what-if runtime is 544293.5883998871ms
2022-09-22 01:48:26 INFO  ---RUNTIME: Multi-Query Optimization took 19.15264129638672 ms
2022-09-22 01:48:26 INFO  Executing generated plans
2022-09-22 01:59:00 INFO  ---RUNTIME: Execution took 633846.2369441986 ms
2022-09-22 01:59:00 INFO  Done!
2022-09-22 01:59:00 INFO  # Finished -- repetition 2 of 7 
2022-09-22 01:59:00 INFO  # Optimization benchmark for data_corruption with args [['reviews', 'fast_loading', 'featurization_2', 'xgboost']] -- repetition 3 of 7
2022-09-22 01:59:00 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-22 01:59:00 INFO  Running instrumented original pipeline...
2022-09-22 01:59:00 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-22 01:59:00 INFO  ---RUNTIME: Importing and monkey-patching took 6.7501068115234375 ms
2022-09-22 01:59:26 INFO  ---RUNTIME: Original pipeline execution took 26671.913862228394 ms (excluding imports and monkey-patching)
2022-09-22 01:59:26 INFO  Starting execution of 1 what-if analyses...
2022-09-22 01:59:26 INFO  Start plan generation for analysis DataCorruption...
2022-09-22 01:59:26 INFO  ---RUNTIME: Plan generation took 0.9052753448486328 ms
2022-09-22 01:59:26 INFO  Estimated runtime of original DAG is 24830.735206604004ms
2022-09-22 01:59:26 INFO  Performing Multi-Query Optimization
2022-09-22 01:59:27 INFO  Estimated unoptimized what-if runtime is 620768.3801651001ms
2022-09-22 01:59:27 INFO  Estimated optimised what-if runtime is 38213.27590942383ms
2022-09-22 01:59:27 INFO  Estimated optimisation runtime saving is 582555.1042556763ms
2022-09-22 01:59:27 INFO  ---RUNTIME: Multi-Query Optimization took 464.16568756103516 ms
2022-09-22 01:59:27 INFO  Executing generated plans
2022-09-22 02:00:14 INFO  ---RUNTIME: Execution took 46778.74302864075 ms
2022-09-22 02:00:14 INFO  Done!
2022-09-22 02:00:14 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-22 02:00:14 INFO  Running instrumented original pipeline...
2022-09-22 02:00:14 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-22 02:00:14 INFO  ---RUNTIME: Importing and monkey-patching took 11.78121566772461 ms
2022-09-22 02:00:40 INFO  ---RUNTIME: Original pipeline execution took 26539.536476135254 ms (excluding imports and monkey-patching)
2022-09-22 02:00:40 INFO  Starting execution of 1 what-if analyses...
2022-09-22 02:00:40 INFO  Start plan generation for analysis DataCorruption...
2022-09-22 02:00:40 INFO  ---RUNTIME: Plan generation took 0.9472370147705078 ms
2022-09-22 02:00:40 INFO  Estimated runtime of original DAG is 24718.36566925049ms
2022-09-22 02:00:40 WARNING Skipping Multi-Query Optimization (instead, only applying patches)
2022-09-22 02:00:40 INFO  Estimated unoptimised what-if runtime is 617959.1417312622ms
2022-09-22 02:00:40 INFO  ---RUNTIME: Multi-Query Optimization took 28.293132781982422 ms
2022-09-22 02:00:40 INFO  Executing generated plans
2022-09-22 02:10:34 INFO  ---RUNTIME: Execution took 593371.1388111115 ms
2022-09-22 02:10:34 INFO  Done!
2022-09-22 02:10:34 INFO  # Finished -- repetition 3 of 7 
2022-09-22 02:10:34 INFO  # Optimization benchmark for data_corruption with args [['reviews', 'fast_loading', 'featurization_2', 'xgboost']] -- repetition 4 of 7
2022-09-22 02:10:34 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-22 02:10:34 INFO  Running instrumented original pipeline...
2022-09-22 02:10:34 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-22 02:10:34 INFO  ---RUNTIME: Importing and monkey-patching took 6.338357925415039 ms
2022-09-22 02:11:00 INFO  ---RUNTIME: Original pipeline execution took 26687.272548675537 ms (excluding imports and monkey-patching)
2022-09-22 02:11:00 INFO  Starting execution of 1 what-if analyses...
2022-09-22 02:11:00 INFO  Start plan generation for analysis DataCorruption...
2022-09-22 02:11:00 INFO  ---RUNTIME: Plan generation took 0.5738735198974609 ms
2022-09-22 02:11:00 INFO  Estimated runtime of original DAG is 24878.42297554016ms
2022-09-22 02:11:00 INFO  Performing Multi-Query Optimization
2022-09-22 02:11:00 INFO  Estimated unoptimized what-if runtime is 621960.574388504ms
2022-09-22 02:11:00 INFO  Estimated optimised what-if runtime is 37830.47342300415ms
2022-09-22 02:11:00 INFO  Estimated optimisation runtime saving is 584130.1009654999ms
2022-09-22 02:11:00 INFO  ---RUNTIME: Multi-Query Optimization took 108.94918441772461 ms
2022-09-22 02:11:00 INFO  Executing generated plans
2022-09-22 02:11:47 INFO  ---RUNTIME: Execution took 46226.02367401123 ms
2022-09-22 02:11:47 INFO  Done!
2022-09-22 02:11:47 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-22 02:11:47 INFO  Running instrumented original pipeline...
2022-09-22 02:11:47 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-22 02:11:47 INFO  ---RUNTIME: Importing and monkey-patching took 9.285688400268555 ms
2022-09-22 02:12:14 INFO  ---RUNTIME: Original pipeline execution took 27056.1945438385 ms (excluding imports and monkey-patching)
2022-09-22 02:12:14 INFO  Starting execution of 1 what-if analyses...
2022-09-22 02:12:14 INFO  Start plan generation for analysis DataCorruption...
2022-09-22 02:12:14 INFO  ---RUNTIME: Plan generation took 0.5857944488525391 ms
2022-09-22 02:12:14 INFO  Estimated runtime of original DAG is 25104.532718658447ms
2022-09-22 02:12:14 WARNING Skipping Multi-Query Optimization (instead, only applying patches)
2022-09-22 02:12:14 INFO  Estimated unoptimised what-if runtime is 627613.3179664612ms
2022-09-22 02:12:14 INFO  ---RUNTIME: Multi-Query Optimization took 41.05257987976074 ms
2022-09-22 02:12:14 INFO  Executing generated plans
2022-09-22 02:22:28 INFO  ---RUNTIME: Execution took 614550.5414009094 ms
2022-09-22 02:22:28 INFO  Done!
2022-09-22 02:22:28 INFO  # Finished -- repetition 4 of 7 
2022-09-22 02:22:28 INFO  # Optimization benchmark for data_corruption with args [['reviews', 'fast_loading', 'featurization_2', 'xgboost']] -- repetition 5 of 7
2022-09-22 02:22:28 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-22 02:22:28 INFO  Running instrumented original pipeline...
2022-09-22 02:22:28 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-22 02:22:28 INFO  ---RUNTIME: Importing and monkey-patching took 5.8498382568359375 ms
2022-09-22 02:22:51 INFO  ---RUNTIME: Original pipeline execution took 22984.262466430664 ms (excluding imports and monkey-patching)
2022-09-22 02:22:51 INFO  Starting execution of 1 what-if analyses...
2022-09-22 02:22:51 INFO  Start plan generation for analysis DataCorruption...
2022-09-22 02:22:51 INFO  ---RUNTIME: Plan generation took 0.5872249603271484 ms
2022-09-22 02:22:51 INFO  Estimated runtime of original DAG is 21762.59684562683ms
2022-09-22 02:22:51 INFO  Performing Multi-Query Optimization
2022-09-22 02:22:51 INFO  Estimated unoptimized what-if runtime is 544064.9211406708ms
2022-09-22 02:22:51 INFO  Estimated optimised what-if runtime is 35168.87617111206ms
2022-09-22 02:22:51 INFO  Estimated optimisation runtime saving is 508896.0449695587ms
2022-09-22 02:22:51 INFO  ---RUNTIME: Multi-Query Optimization took 103.46531867980957 ms
2022-09-22 02:22:51 INFO  Executing generated plans
2022-09-22 02:23:31 INFO  ---RUNTIME: Execution took 39512.31336593628 ms
2022-09-22 02:23:31 INFO  Done!
2022-09-22 02:23:31 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-22 02:23:31 INFO  Running instrumented original pipeline...
2022-09-22 02:23:31 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-22 02:23:31 INFO  ---RUNTIME: Importing and monkey-patching took 8.44883918762207 ms
2022-09-22 02:23:55 INFO  ---RUNTIME: Original pipeline execution took 24545.8083152771 ms (excluding imports and monkey-patching)
2022-09-22 02:23:55 INFO  Starting execution of 1 what-if analyses...
2022-09-22 02:23:55 INFO  Start plan generation for analysis DataCorruption...
2022-09-22 02:23:55 INFO  ---RUNTIME: Plan generation took 0.67138671875 ms
2022-09-22 02:23:55 INFO  Estimated runtime of original DAG is 22662.67490386963ms
2022-09-22 02:23:55 WARNING Skipping Multi-Query Optimization (instead, only applying patches)
2022-09-22 02:23:55 INFO  Estimated unoptimised what-if runtime is 566566.8725967407ms
2022-09-22 02:23:55 INFO  ---RUNTIME: Multi-Query Optimization took 28.86056900024414 ms
2022-09-22 02:23:55 INFO  Executing generated plans
2022-09-22 02:34:43 INFO  ---RUNTIME: Execution took 647954.2632102966 ms
2022-09-22 02:34:43 INFO  Done!
2022-09-22 02:34:43 INFO  # Finished -- repetition 5 of 7 
2022-09-22 02:34:43 INFO  # Optimization benchmark for data_corruption with args [['reviews', 'fast_loading', 'featurization_2', 'xgboost']] -- repetition 6 of 7
2022-09-22 02:34:43 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-22 02:34:43 INFO  Running instrumented original pipeline...
2022-09-22 02:34:44 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-22 02:34:44 INFO  ---RUNTIME: Importing and monkey-patching took 9.168624877929688 ms
2022-09-22 02:35:13 INFO  ---RUNTIME: Original pipeline execution took 29015.737056732178 ms (excluding imports and monkey-patching)
2022-09-22 02:35:13 INFO  Starting execution of 1 what-if analyses...
2022-09-22 02:35:13 INFO  Start plan generation for analysis DataCorruption...
2022-09-22 02:35:13 INFO  ---RUNTIME: Plan generation took 0.5848407745361328 ms
2022-09-22 02:35:13 INFO  Estimated runtime of original DAG is 27067.4831867218ms
2022-09-22 02:35:13 INFO  Performing Multi-Query Optimization
2022-09-22 02:35:13 INFO  Estimated unoptimized what-if runtime is 676687.079668045ms
2022-09-22 02:35:13 INFO  Estimated optimised what-if runtime is 40192.43907928467ms
2022-09-22 02:35:13 INFO  Estimated optimisation runtime saving is 636494.6405887604ms
2022-09-22 02:35:13 INFO  ---RUNTIME: Multi-Query Optimization took 103.65748405456543 ms
2022-09-22 02:35:13 INFO  Executing generated plans
2022-09-22 02:35:56 INFO  ---RUNTIME: Execution took 43168.04552078247 ms
2022-09-22 02:35:56 INFO  Done!
2022-09-22 02:35:56 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-22 02:35:56 INFO  Running instrumented original pipeline...
2022-09-22 02:35:56 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-22 02:35:56 INFO  ---RUNTIME: Importing and monkey-patching took 8.423805236816406 ms
2022-09-22 02:36:22 INFO  ---RUNTIME: Original pipeline execution took 25886.59405708313 ms (excluding imports and monkey-patching)
2022-09-22 02:36:22 INFO  Starting execution of 1 what-if analyses...
2022-09-22 02:36:22 INFO  Start plan generation for analysis DataCorruption...
2022-09-22 02:36:22 INFO  ---RUNTIME: Plan generation took 0.4494190216064453 ms
2022-09-22 02:36:22 INFO  Estimated runtime of original DAG is 24018.7029838562ms
2022-09-22 02:36:22 WARNING Skipping Multi-Query Optimization (instead, only applying patches)
2022-09-22 02:36:22 INFO  Estimated unoptimised what-if runtime is 600467.574596405ms
2022-09-22 02:36:22 INFO  ---RUNTIME: Multi-Query Optimization took 28.212308883666992 ms
2022-09-22 02:36:22 INFO  Executing generated plans
2022-09-22 02:46:46 INFO  ---RUNTIME: Execution took 623909.0116024017 ms
2022-09-22 02:46:46 INFO  Done!
2022-09-22 02:46:46 INFO  # Finished -- repetition 6 of 7 
2022-09-22 02:46:46 INFO  # Optimization benchmark for data_corruption with args [['reviews', 'fast_loading', 'featurization_2', 'xgboost']] -- repetition 7 of 7
2022-09-22 02:46:46 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-22 02:46:46 INFO  Running instrumented original pipeline...
2022-09-22 02:46:46 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-22 02:46:46 INFO  ---RUNTIME: Importing and monkey-patching took 6.177425384521484 ms
2022-09-22 02:47:09 INFO  ---RUNTIME: Original pipeline execution took 23291.277647018433 ms (excluding imports and monkey-patching)
2022-09-22 02:47:09 INFO  Starting execution of 1 what-if analyses...
2022-09-22 02:47:09 INFO  Start plan generation for analysis DataCorruption...
2022-09-22 02:47:09 INFO  ---RUNTIME: Plan generation took 0.5619525909423828 ms
2022-09-22 02:47:09 INFO  Estimated runtime of original DAG is 22086.673498153687ms
2022-09-22 02:47:09 INFO  Performing Multi-Query Optimization
2022-09-22 02:47:09 INFO  Estimated unoptimized what-if runtime is 552166.8374538422ms
2022-09-22 02:47:09 INFO  Estimated optimised what-if runtime is 32047.45650291443ms
2022-09-22 02:47:09 INFO  Estimated optimisation runtime saving is 520119.38095092773ms
2022-09-22 02:47:09 INFO  ---RUNTIME: Multi-Query Optimization took 65.39607048034668 ms
2022-09-22 02:47:09 INFO  Executing generated plans
2022-09-22 02:47:50 INFO  ---RUNTIME: Execution took 40685.70685386658 ms
2022-09-22 02:47:50 INFO  Done!
2022-09-22 02:47:50 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-22 02:47:50 INFO  Running instrumented original pipeline...
2022-09-22 02:47:50 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-22 02:47:50 INFO  ---RUNTIME: Importing and monkey-patching took 7.671356201171875 ms
2022-09-22 02:48:13 INFO  ---RUNTIME: Original pipeline execution took 23406.72516822815 ms (excluding imports and monkey-patching)
2022-09-22 02:48:13 INFO  Starting execution of 1 what-if analyses...
2022-09-22 02:48:13 INFO  Start plan generation for analysis DataCorruption...
2022-09-22 02:48:13 INFO  ---RUNTIME: Plan generation took 0.6279945373535156 ms
2022-09-22 02:48:13 INFO  Estimated runtime of original DAG is 22156.419038772583ms
2022-09-22 02:48:13 WARNING Skipping Multi-Query Optimization (instead, only applying patches)
2022-09-22 02:48:13 INFO  Estimated unoptimised what-if runtime is 553910.4759693146ms
2022-09-22 02:48:13 INFO  ---RUNTIME: Multi-Query Optimization took 30.052900314331055 ms
2022-09-22 02:48:13 INFO  Executing generated plans
2022-09-22 02:57:36 INFO  ---RUNTIME: Execution took 562888.8030052185 ms
2022-09-22 02:57:36 INFO  Done!
2022-09-22 02:57:36 INFO  # Finished -- repetition 7 of 7 
2022-09-22 02:57:36 INFO  # Final results after all repetitions
2022-09-22 02:57:36 INFO     repetition  ... no_opt_what_if_execution_combined_model_training
0           0  ...                                    387014.934540
1           1  ...                                    392793.695211
2           2  ...                                    390872.578859
3           3  ...                                    386921.817303
4           4  ...                                    414272.614241
5           5  ...                                    398245.071888
6           6  ...                                    373356.180191

[7 rows x 26 columns]
taskset -c 32-39 PROTOCOL_BUFFERS_PYTHON_IMPLEMENTATION=python python3.9 benchmarks_end_to_end.py data_corruption reviews fast_loading featurization_2 neural_network
2022-09-22 02:57:38.896500: W tensorflow/stream_executor/platform/default/dso_loader.cc:64] Could not load dynamic library 'libcudart.so.11.0'; dlerror: libcudart.so.11.0: cannot open shared object file: No such file or directory; LD_LIBRARY_PATH: /home/sgrafbe/mlwhatif/venv/lib/python3.9/site-packages/cv2/../../lib64:
2022-09-22 02:57:38.896550: I tensorflow/stream_executor/cuda/cudart_stub.cc:29] Ignore above cudart dlerror if you do not have a GPU set up on your machine.
2022-09-22 02:57:40 INFO  Patching sys.argv with ['mlwhatif', 'reviews', 'fast_loading', 'featurization_2', 'neural_network']
2022-09-22 02:57:40 INFO  Running instrumented original pipeline...
2022-09-22 02:57:40 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-22 02:57:40 INFO  ---RUNTIME: Importing and monkey-patching took 122.01642990112305 ms
2022-09-22 02:57:45.416435: W tensorflow/stream_executor/platform/default/dso_loader.cc:64] Could not load dynamic library 'libcuda.so.1'; dlerror: libcuda.so.1: cannot open shared object file: No such file or directory; LD_LIBRARY_PATH: /home/sgrafbe/mlwhatif/venv/lib/python3.9/site-packages/cv2/../../lib64:
2022-09-22 02:57:45.416475: W tensorflow/stream_executor/cuda/cuda_driver.cc:326] failed call to cuInit: UNKNOWN ERROR (303)
2022-09-22 02:57:45.416499: I tensorflow/stream_executor/cuda/cuda_diagnostics.cc:156] kernel driver does not appear to be running on this host (angus): /proc/driver/nvidia/version does not exist
2022-09-22 02:57:45.416977: I tensorflow/core/platform/cpu_feature_guard.cc:142] This TensorFlow binary is optimized with oneAPI Deep Neural Network Library (oneDNN) to use the following CPU instructions in performance-critical operations:  AVX2 FMA
To enable them in other operations, rebuild TensorFlow with the appropriate compiler flags.
2022-09-22 02:57:46.079496: I tensorflow/compiler/mlir/mlir_graph_optimization_pass.cc:176] None of the MLIR Optimization Passes are enabled (registered 2)
2022-09-22 02:57:46.094185: I tensorflow/core/platform/profile_utils/cpu_utils.cc:114] CPU Frequency: 2595130000 Hz
2022-09-22 02:57:54 INFO  ---RUNTIME: Original pipeline execution took 14188.700675964355 ms (excluding imports and monkey-patching)
2022-09-22 02:57:54 INFO  Starting execution of 0 what-if analyses...
2022-09-22 02:57:54 INFO  Estimated runtime of original DAG is 13000.78558921814ms
2022-09-22 02:57:54 INFO  Performing Multi-Query Optimization
2022-09-22 02:57:54 INFO  Estimated unoptimized what-if runtime is 0ms
2022-09-22 02:57:54 INFO  Estimated optimised what-if runtime is 0ms
2022-09-22 02:57:54 INFO  Estimated optimisation runtime saving is 0ms
2022-09-22 02:57:54 INFO  ---RUNTIME: Multi-Query Optimization took 0.49948692321777344 ms
2022-09-22 02:57:54 INFO  Executing generated plans
2022-09-22 02:57:54 INFO  ---RUNTIME: Execution took 0.024080276489257812 ms
2022-09-22 02:57:54 INFO  Done!
2022-09-22 02:57:54 INFO  # Optimization benchmark for data_corruption with args [['reviews', 'fast_loading', 'featurization_2', 'neural_network']] -- repetition 1 of 7
2022-09-22 02:57:54 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-22 02:57:54 INFO  Running instrumented original pipeline...
2022-09-22 02:57:54 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-22 02:57:54 INFO  ---RUNTIME: Importing and monkey-patching took 5.298852920532227 ms
2022-09-22 02:58:08 INFO  ---RUNTIME: Original pipeline execution took 13895.659923553467 ms (excluding imports and monkey-patching)
2022-09-22 02:58:08 INFO  Starting execution of 1 what-if analyses...
2022-09-22 02:58:08 INFO  Start plan generation for analysis DataCorruption...
2022-09-22 02:58:08 INFO  ---RUNTIME: Plan generation took 0.4208087921142578 ms
2022-09-22 02:58:08 INFO  Estimated runtime of original DAG is 12724.324226379395ms
2022-09-22 02:58:08 INFO  Performing Multi-Query Optimization
2022-09-22 02:58:08 INFO  Estimated unoptimized what-if runtime is 318108.10565948486ms
2022-09-22 02:58:08 INFO  Estimated optimised what-if runtime is 39191.61868095398ms
2022-09-22 02:58:08 INFO  Estimated optimisation runtime saving is 278916.4869785309ms
2022-09-22 02:58:08 INFO  ---RUNTIME: Multi-Query Optimization took 65.70148468017578 ms
2022-09-22 02:58:08 INFO  Executing generated plans
2022-09-22 02:58:52 INFO  ---RUNTIME: Execution took 43898.93913269043 ms
2022-09-22 02:58:52 INFO  Done!
2022-09-22 02:58:52 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-22 02:58:52 INFO  Running instrumented original pipeline...
2022-09-22 02:58:52 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-22 02:58:52 INFO  ---RUNTIME: Importing and monkey-patching took 5.67626953125 ms
2022-09-22 02:59:06 INFO  ---RUNTIME: Original pipeline execution took 13751.164674758911 ms (excluding imports and monkey-patching)
2022-09-22 02:59:06 INFO  Starting execution of 1 what-if analyses...
2022-09-22 02:59:06 INFO  Start plan generation for analysis DataCorruption...
2022-09-22 02:59:06 INFO  ---RUNTIME: Plan generation took 1.2888908386230469 ms
2022-09-22 02:59:06 INFO  Estimated runtime of original DAG is 12299.040794372559ms
2022-09-22 02:59:06 WARNING Skipping Multi-Query Optimization (instead, only applying patches)
2022-09-22 02:59:06 INFO  Estimated unoptimised what-if runtime is 307476.01985931396ms
2022-09-22 02:59:06 INFO  ---RUNTIME: Multi-Query Optimization took 18.914461135864258 ms
2022-09-22 02:59:06 INFO  Executing generated plans
2022-09-22 03:04:54 INFO  ---RUNTIME: Execution took 348348.41322898865 ms
2022-09-22 03:04:54 INFO  Done!
2022-09-22 03:04:54 INFO  # Finished -- repetition 1 of 7 
2022-09-22 03:04:54 INFO  # Optimization benchmark for data_corruption with args [['reviews', 'fast_loading', 'featurization_2', 'neural_network']] -- repetition 2 of 7
2022-09-22 03:04:54 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-22 03:04:54 INFO  Running instrumented original pipeline...
2022-09-22 03:04:54 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-22 03:04:54 INFO  ---RUNTIME: Importing and monkey-patching took 6.718158721923828 ms
2022-09-22 03:05:08 INFO  ---RUNTIME: Original pipeline execution took 14125.050783157349 ms (excluding imports and monkey-patching)
2022-09-22 03:05:08 INFO  Starting execution of 1 what-if analyses...
2022-09-22 03:05:08 INFO  Start plan generation for analysis DataCorruption...
2022-09-22 03:05:08 INFO  ---RUNTIME: Plan generation took 0.4398822784423828 ms
2022-09-22 03:05:08 INFO  Estimated runtime of original DAG is 12845.001697540283ms
2022-09-22 03:05:08 INFO  Performing Multi-Query Optimization
2022-09-22 03:05:08 INFO  Estimated unoptimized what-if runtime is 321125.0424385071ms
2022-09-22 03:05:08 INFO  Estimated optimised what-if runtime is 40712.36801147461ms
2022-09-22 03:05:08 INFO  Estimated optimisation runtime saving is 280412.67442703247ms
2022-09-22 03:05:08 INFO  ---RUNTIME: Multi-Query Optimization took 71.84171676635742 ms
2022-09-22 03:05:08 INFO  Executing generated plans
2022-09-22 03:05:51 INFO  ---RUNTIME: Execution took 43185.40620803833 ms
2022-09-22 03:05:51 INFO  Done!
2022-09-22 03:05:51 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-22 03:05:51 INFO  Running instrumented original pipeline...
2022-09-22 03:05:51 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-22 03:05:51 INFO  ---RUNTIME: Importing and monkey-patching took 6.117105484008789 ms
2022-09-22 03:06:05 INFO  ---RUNTIME: Original pipeline execution took 13660.868406295776 ms (excluding imports and monkey-patching)
2022-09-22 03:06:05 INFO  Starting execution of 1 what-if analyses...
2022-09-22 03:06:05 INFO  Start plan generation for analysis DataCorruption...
2022-09-22 03:06:05 INFO  ---RUNTIME: Plan generation took 1.3468265533447266 ms
2022-09-22 03:06:05 INFO  Estimated runtime of original DAG is 12457.98134803772ms
2022-09-22 03:06:05 WARNING Skipping Multi-Query Optimization (instead, only applying patches)
2022-09-22 03:06:05 INFO  Estimated unoptimised what-if runtime is 311449.533700943ms
2022-09-22 03:06:05 INFO  ---RUNTIME: Multi-Query Optimization took 19.008874893188477 ms
2022-09-22 03:06:05 INFO  Executing generated plans
2022-09-22 03:12:00 INFO  ---RUNTIME: Execution took 354720.06130218506 ms
2022-09-22 03:12:00 INFO  Done!
2022-09-22 03:12:00 INFO  # Finished -- repetition 2 of 7 
2022-09-22 03:12:00 INFO  # Optimization benchmark for data_corruption with args [['reviews', 'fast_loading', 'featurization_2', 'neural_network']] -- repetition 3 of 7
2022-09-22 03:12:00 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-22 03:12:00 INFO  Running instrumented original pipeline...
2022-09-22 03:12:00 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-22 03:12:00 INFO  ---RUNTIME: Importing and monkey-patching took 6.638050079345703 ms
2022-09-22 03:12:14 INFO  ---RUNTIME: Original pipeline execution took 14439.859628677368 ms (excluding imports and monkey-patching)
2022-09-22 03:12:14 INFO  Starting execution of 1 what-if analyses...
2022-09-22 03:12:14 INFO  Start plan generation for analysis DataCorruption...
2022-09-22 03:12:14 INFO  ---RUNTIME: Plan generation took 0.4489421844482422 ms
2022-09-22 03:12:14 INFO  Estimated runtime of original DAG is 13141.070127487183ms
2022-09-22 03:12:14 INFO  Performing Multi-Query Optimization
2022-09-22 03:12:14 INFO  Estimated unoptimized what-if runtime is 328526.75318717957ms
2022-09-22 03:12:14 INFO  Estimated optimised what-if runtime is 41189.16964530945ms
2022-09-22 03:12:14 INFO  Estimated optimisation runtime saving is 287337.5835418701ms
2022-09-22 03:12:14 INFO  ---RUNTIME: Multi-Query Optimization took 69.2589282989502 ms
2022-09-22 03:12:14 INFO  Executing generated plans
2022-09-22 03:12:59 INFO  ---RUNTIME: Execution took 45077.34751701355 ms
2022-09-22 03:12:59 INFO  Done!
2022-09-22 03:12:59 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-22 03:12:59 INFO  Running instrumented original pipeline...
2022-09-22 03:12:59 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-22 03:12:59 INFO  ---RUNTIME: Importing and monkey-patching took 6.251811981201172 ms
2022-09-22 03:13:13 INFO  ---RUNTIME: Original pipeline execution took 13569.523572921753 ms (excluding imports and monkey-patching)
2022-09-22 03:13:13 INFO  Starting execution of 1 what-if analyses...
2022-09-22 03:13:13 INFO  Start plan generation for analysis DataCorruption...
2022-09-22 03:13:13 INFO  ---RUNTIME: Plan generation took 0.5331039428710938 ms
2022-09-22 03:13:13 INFO  Estimated runtime of original DAG is 12306.790828704834ms
2022-09-22 03:13:13 WARNING Skipping Multi-Query Optimization (instead, only applying patches)
2022-09-22 03:13:13 INFO  Estimated unoptimised what-if runtime is 307669.77071762085ms
2022-09-22 03:13:13 INFO  ---RUNTIME: Multi-Query Optimization took 22.150039672851562 ms
2022-09-22 03:13:13 INFO  Executing generated plans
2022-09-22 03:19:06 INFO  ---RUNTIME: Execution took 353144.23060417175 ms
2022-09-22 03:19:06 INFO  Done!
2022-09-22 03:19:06 INFO  # Finished -- repetition 3 of 7 
2022-09-22 03:19:06 INFO  # Optimization benchmark for data_corruption with args [['reviews', 'fast_loading', 'featurization_2', 'neural_network']] -- repetition 4 of 7
2022-09-22 03:19:06 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-22 03:19:06 INFO  Running instrumented original pipeline...
2022-09-22 03:19:06 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-22 03:19:06 INFO  ---RUNTIME: Importing and monkey-patching took 6.621837615966797 ms
2022-09-22 03:19:21 INFO  ---RUNTIME: Original pipeline execution took 14348.604440689087 ms (excluding imports and monkey-patching)
2022-09-22 03:19:21 INFO  Starting execution of 1 what-if analyses...
2022-09-22 03:19:21 INFO  Start plan generation for analysis DataCorruption...
2022-09-22 03:19:21 INFO  ---RUNTIME: Plan generation took 0.4436969757080078 ms
2022-09-22 03:19:21 INFO  Estimated runtime of original DAG is 13083.707094192505ms
2022-09-22 03:19:21 INFO  Performing Multi-Query Optimization
2022-09-22 03:19:21 INFO  Estimated unoptimized what-if runtime is 327092.6773548126ms
2022-09-22 03:19:21 INFO  Estimated optimised what-if runtime is 41331.74633979797ms
2022-09-22 03:19:21 INFO  Estimated optimisation runtime saving is 285760.93101501465ms
2022-09-22 03:19:21 INFO  ---RUNTIME: Multi-Query Optimization took 66.41268730163574 ms
2022-09-22 03:19:21 INFO  Executing generated plans
2022-09-22 03:20:06 INFO  ---RUNTIME: Execution took 45483.22534561157 ms
2022-09-22 03:20:06 INFO  Done!
2022-09-22 03:20:06 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-22 03:20:06 INFO  Running instrumented original pipeline...
2022-09-22 03:20:06 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-22 03:20:06 INFO  ---RUNTIME: Importing and monkey-patching took 5.763530731201172 ms
2022-09-22 03:20:21 INFO  ---RUNTIME: Original pipeline execution took 14416.763544082642 ms (excluding imports and monkey-patching)
2022-09-22 03:20:21 INFO  Starting execution of 1 what-if analyses...
2022-09-22 03:20:21 INFO  Start plan generation for analysis DataCorruption...
2022-09-22 03:20:21 INFO  ---RUNTIME: Plan generation took 0.4570484161376953 ms
2022-09-22 03:20:21 INFO  Estimated runtime of original DAG is 13125.720024108887ms
2022-09-22 03:20:21 WARNING Skipping Multi-Query Optimization (instead, only applying patches)
2022-09-22 03:20:21 INFO  Estimated unoptimised what-if runtime is 328143.00060272217ms
2022-09-22 03:20:21 INFO  ---RUNTIME: Multi-Query Optimization took 19.28257942199707 ms
2022-09-22 03:20:21 INFO  Executing generated plans
2022-09-22 03:26:11 INFO  ---RUNTIME: Execution took 350497.28298187256 ms
2022-09-22 03:26:11 INFO  Done!
2022-09-22 03:26:11 INFO  # Finished -- repetition 4 of 7 
2022-09-22 03:26:11 INFO  # Optimization benchmark for data_corruption with args [['reviews', 'fast_loading', 'featurization_2', 'neural_network']] -- repetition 5 of 7
2022-09-22 03:26:11 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-22 03:26:11 INFO  Running instrumented original pipeline...
2022-09-22 03:26:11 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-22 03:26:11 INFO  ---RUNTIME: Importing and monkey-patching took 6.045103073120117 ms
2022-09-22 03:26:25 INFO  ---RUNTIME: Original pipeline execution took 14114.33744430542 ms (excluding imports and monkey-patching)
2022-09-22 03:26:25 INFO  Starting execution of 1 what-if analyses...
2022-09-22 03:26:25 INFO  Start plan generation for analysis DataCorruption...
2022-09-22 03:26:25 INFO  ---RUNTIME: Plan generation took 0.42057037353515625 ms
2022-09-22 03:26:25 INFO  Estimated runtime of original DAG is 12875.0319480896ms
2022-09-22 03:26:25 INFO  Performing Multi-Query Optimization
2022-09-22 03:26:25 INFO  Estimated unoptimized what-if runtime is 321875.79870224ms
2022-09-22 03:26:25 INFO  Estimated optimised what-if runtime is 41630.985260009766ms
2022-09-22 03:26:25 INFO  Estimated optimisation runtime saving is 280244.8134422302ms
2022-09-22 03:26:25 INFO  ---RUNTIME: Multi-Query Optimization took 72.23701477050781 ms
2022-09-22 03:26:25 INFO  Executing generated plans
2022-09-22 03:27:11 INFO  ---RUNTIME: Execution took 45603.373527526855 ms
2022-09-22 03:27:11 INFO  Done!
2022-09-22 03:27:11 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-22 03:27:11 INFO  Running instrumented original pipeline...
2022-09-22 03:27:11 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-22 03:27:11 INFO  ---RUNTIME: Importing and monkey-patching took 5.706548690795898 ms
2022-09-22 03:27:26 INFO  ---RUNTIME: Original pipeline execution took 14841.59255027771 ms (excluding imports and monkey-patching)
2022-09-22 03:27:26 INFO  Starting execution of 1 what-if analyses...
2022-09-22 03:27:26 INFO  Start plan generation for analysis DataCorruption...
2022-09-22 03:27:26 INFO  ---RUNTIME: Plan generation took 0.48613548278808594 ms
2022-09-22 03:27:26 INFO  Estimated runtime of original DAG is 13611.67597770691ms
2022-09-22 03:27:26 WARNING Skipping Multi-Query Optimization (instead, only applying patches)
2022-09-22 03:27:26 INFO  Estimated unoptimised what-if runtime is 340291.89944267273ms
2022-09-22 03:27:26 INFO  ---RUNTIME: Multi-Query Optimization took 19.35577392578125 ms
2022-09-22 03:27:26 INFO  Executing generated plans
2022-09-22 03:33:18 INFO  ---RUNTIME: Execution took 352705.1272392273 ms
2022-09-22 03:33:18 INFO  Done!
2022-09-22 03:33:18 INFO  # Finished -- repetition 5 of 7 
2022-09-22 03:33:18 INFO  # Optimization benchmark for data_corruption with args [['reviews', 'fast_loading', 'featurization_2', 'neural_network']] -- repetition 6 of 7
2022-09-22 03:33:18 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-22 03:33:18 INFO  Running instrumented original pipeline...
2022-09-22 03:33:18 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-22 03:33:18 INFO  ---RUNTIME: Importing and monkey-patching took 6.090402603149414 ms
2022-09-22 03:33:33 INFO  ---RUNTIME: Original pipeline execution took 14323.211431503296 ms (excluding imports and monkey-patching)
2022-09-22 03:33:33 INFO  Starting execution of 1 what-if analyses...
2022-09-22 03:33:33 INFO  Start plan generation for analysis DataCorruption...
2022-09-22 03:33:33 INFO  ---RUNTIME: Plan generation took 0.4360675811767578 ms
2022-09-22 03:33:33 INFO  Estimated runtime of original DAG is 13116.459131240845ms
2022-09-22 03:33:33 INFO  Performing Multi-Query Optimization
2022-09-22 03:33:33 INFO  Estimated unoptimized what-if runtime is 327911.4782810211ms
2022-09-22 03:33:33 INFO  Estimated optimised what-if runtime is 38904.33573722839ms
2022-09-22 03:33:33 INFO  Estimated optimisation runtime saving is 289007.1425437927ms
2022-09-22 03:33:33 INFO  ---RUNTIME: Multi-Query Optimization took 65.28782844543457 ms
2022-09-22 03:33:33 INFO  Executing generated plans
2022-09-22 03:34:17 INFO  ---RUNTIME: Execution took 44307.09767341614 ms
2022-09-22 03:34:17 INFO  Done!
2022-09-22 03:34:17 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-22 03:34:17 INFO  Running instrumented original pipeline...
2022-09-22 03:34:17 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-22 03:34:17 INFO  ---RUNTIME: Importing and monkey-patching took 5.812883377075195 ms
2022-09-22 03:34:32 INFO  ---RUNTIME: Original pipeline execution took 14593.49536895752 ms (excluding imports and monkey-patching)
2022-09-22 03:34:32 INFO  Starting execution of 1 what-if analyses...
2022-09-22 03:34:32 INFO  Start plan generation for analysis DataCorruption...
2022-09-22 03:34:32 INFO  ---RUNTIME: Plan generation took 0.49948692321777344 ms
2022-09-22 03:34:32 INFO  Estimated runtime of original DAG is 13262.91823387146ms
2022-09-22 03:34:32 WARNING Skipping Multi-Query Optimization (instead, only applying patches)
2022-09-22 03:34:32 INFO  Estimated unoptimised what-if runtime is 331572.9558467865ms
2022-09-22 03:34:32 INFO  ---RUNTIME: Multi-Query Optimization took 19.85335350036621 ms
2022-09-22 03:34:32 INFO  Executing generated plans
2022-09-22 03:40:24 INFO  ---RUNTIME: Execution took 352328.3224105835 ms
2022-09-22 03:40:24 INFO  Done!
2022-09-22 03:40:24 INFO  # Finished -- repetition 6 of 7 
2022-09-22 03:40:24 INFO  # Optimization benchmark for data_corruption with args [['reviews', 'fast_loading', 'featurization_2', 'neural_network']] -- repetition 7 of 7
2022-09-22 03:40:24 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-22 03:40:24 INFO  Running instrumented original pipeline...
2022-09-22 03:40:24 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-22 03:40:24 INFO  ---RUNTIME: Importing and monkey-patching took 5.778789520263672 ms
2022-09-22 03:40:38 INFO  ---RUNTIME: Original pipeline execution took 13850.276947021484 ms (excluding imports and monkey-patching)
2022-09-22 03:40:38 INFO  Starting execution of 1 what-if analyses...
2022-09-22 03:40:38 INFO  Start plan generation for analysis DataCorruption...
2022-09-22 03:40:38 INFO  ---RUNTIME: Plan generation took 0.48279762268066406 ms
2022-09-22 03:40:38 INFO  Estimated runtime of original DAG is 12624.57299232483ms
2022-09-22 03:40:38 INFO  Performing Multi-Query Optimization
2022-09-22 03:40:38 INFO  Estimated unoptimized what-if runtime is 315614.3248081207ms
2022-09-22 03:40:38 INFO  Estimated optimised what-if runtime is 38707.20934867859ms
2022-09-22 03:40:38 INFO  Estimated optimisation runtime saving is 276907.11545944214ms
2022-09-22 03:40:38 INFO  ---RUNTIME: Multi-Query Optimization took 67.15178489685059 ms
2022-09-22 03:40:38 INFO  Executing generated plans
2022-09-22 03:41:22 INFO  ---RUNTIME: Execution took 43657.429695129395 ms
2022-09-22 03:41:22 INFO  Done!
2022-09-22 03:41:22 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-22 03:41:22 INFO  Running instrumented original pipeline...
2022-09-22 03:41:22 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-22 03:41:22 INFO  ---RUNTIME: Importing and monkey-patching took 5.716562271118164 ms
2022-09-22 03:41:35 INFO  ---RUNTIME: Original pipeline execution took 13156.02993965149 ms (excluding imports and monkey-patching)
2022-09-22 03:41:35 INFO  Starting execution of 1 what-if analyses...
2022-09-22 03:41:35 INFO  Start plan generation for analysis DataCorruption...
2022-09-22 03:41:35 INFO  ---RUNTIME: Plan generation took 0.3921985626220703 ms
2022-09-22 03:41:35 INFO  Estimated runtime of original DAG is 11945.095777511597ms
2022-09-22 03:41:35 WARNING Skipping Multi-Query Optimization (instead, only applying patches)
2022-09-22 03:41:35 INFO  Estimated unoptimised what-if runtime is 298627.3944377899ms
2022-09-22 03:41:35 INFO  ---RUNTIME: Multi-Query Optimization took 19.407987594604492 ms
2022-09-22 03:41:35 INFO  Executing generated plans
2022-09-22 03:47:28 INFO  ---RUNTIME: Execution took 352992.9699897766 ms
2022-09-22 03:47:28 INFO  Done!
2022-09-22 03:47:28 INFO  # Finished -- repetition 7 of 7 
2022-09-22 03:47:28 INFO  # Final results after all repetitions
2022-09-22 03:47:28 INFO     repetition  ... no_opt_what_if_execution_combined_model_training
0           0  ...                                    154944.413662
1           1  ...                                    162824.125051
2           2  ...                                    159901.076317
3           3  ...                                    156119.469404
4           4  ...                                    158348.906994
5           5  ...                                    158283.005953
6           6  ...                                    157287.292242

[7 rows x 26 columns]
taskset -c 32-39 PROTOCOL_BUFFERS_PYTHON_IMPLEMENTATION=python python3.9 benchmarks_end_to_end.py data_corruption reviews fast_loading featurization_3 logistic_regression
2022-09-22 03:47:30.908799: W tensorflow/stream_executor/platform/default/dso_loader.cc:64] Could not load dynamic library 'libcudart.so.11.0'; dlerror: libcudart.so.11.0: cannot open shared object file: No such file or directory; LD_LIBRARY_PATH: /home/sgrafbe/mlwhatif/venv/lib/python3.9/site-packages/cv2/../../lib64:
2022-09-22 03:47:30.908844: I tensorflow/stream_executor/cuda/cudart_stub.cc:29] Ignore above cudart dlerror if you do not have a GPU set up on your machine.
2022-09-22 03:47:32 INFO  Patching sys.argv with ['mlwhatif', 'reviews', 'fast_loading', 'featurization_3', 'logistic_regression']
2022-09-22 03:47:32 INFO  Running instrumented original pipeline...
2022-09-22 03:47:32 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-22 03:47:32 INFO  ---RUNTIME: Importing and monkey-patching took 122.06745147705078 ms
2022-09-22 03:48:12 INFO  ---RUNTIME: Original pipeline execution took 40538.59996795654 ms (excluding imports and monkey-patching)
2022-09-22 03:48:12 INFO  Starting execution of 0 what-if analyses...
2022-09-22 03:48:12 INFO  Estimated runtime of original DAG is 33081.73727989197ms
2022-09-22 03:48:12 INFO  Performing Multi-Query Optimization
2022-09-22 03:48:12 INFO  Estimated unoptimized what-if runtime is 0ms
2022-09-22 03:48:12 INFO  Estimated optimised what-if runtime is 0ms
2022-09-22 03:48:12 INFO  Estimated optimisation runtime saving is 0ms
2022-09-22 03:48:12 INFO  ---RUNTIME: Multi-Query Optimization took 0.5877017974853516 ms
2022-09-22 03:48:12 INFO  Executing generated plans
2022-09-22 03:48:12 INFO  ---RUNTIME: Execution took 0.025510787963867188 ms
2022-09-22 03:48:12 INFO  Done!
2022-09-22 03:48:12 INFO  # Optimization benchmark for data_corruption with args [['reviews', 'fast_loading', 'featurization_3', 'logistic_regression']] -- repetition 1 of 7
2022-09-22 03:48:12 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-22 03:48:12 INFO  Running instrumented original pipeline...
2022-09-22 03:48:13 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-22 03:48:13 INFO  ---RUNTIME: Importing and monkey-patching took 5.658864974975586 ms
2022-09-22 03:48:53 INFO  ---RUNTIME: Original pipeline execution took 40351.78446769714 ms (excluding imports and monkey-patching)
2022-09-22 03:48:53 INFO  Starting execution of 1 what-if analyses...
2022-09-22 03:48:53 INFO  Start plan generation for analysis DataCorruption...
2022-09-22 03:48:53 INFO  ---RUNTIME: Plan generation took 0.4200935363769531 ms
2022-09-22 03:48:53 INFO  Estimated runtime of original DAG is 32884.83691215515ms
2022-09-22 03:48:53 INFO  Performing Multi-Query Optimization
2022-09-22 03:48:53 INFO  Estimated unoptimized what-if runtime is 822120.9228038788ms
2022-09-22 03:48:53 INFO  Estimated optimised what-if runtime is 114116.08600616455ms
2022-09-22 03:48:53 INFO  Estimated optimisation runtime saving is 708004.8367977142ms
2022-09-22 03:48:53 INFO  ---RUNTIME: Multi-Query Optimization took 76.23887062072754 ms
2022-09-22 03:48:53 INFO  Executing generated plans
2022-09-22 03:49:42 INFO  ---RUNTIME: Execution took 48910.099029541016 ms
2022-09-22 03:49:42 INFO  Done!
2022-09-22 03:49:42 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-22 03:49:42 INFO  Running instrumented original pipeline...
2022-09-22 03:49:42 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-22 03:49:42 INFO  ---RUNTIME: Importing and monkey-patching took 6.126880645751953 ms
2022-09-22 03:50:30 INFO  ---RUNTIME: Original pipeline execution took 48219.20561790466 ms (excluding imports and monkey-patching)
2022-09-22 03:50:30 INFO  Starting execution of 1 what-if analyses...
2022-09-22 03:50:30 INFO  Start plan generation for analysis DataCorruption...
2022-09-22 03:50:30 INFO  ---RUNTIME: Plan generation took 0.51116943359375 ms
2022-09-22 03:50:30 INFO  Estimated runtime of original DAG is 34067.697525024414ms
2022-09-22 03:50:30 WARNING Skipping Multi-Query Optimization (instead, only applying patches)
2022-09-22 03:50:30 INFO  Estimated unoptimised what-if runtime is 851692.4381256104ms
2022-09-22 03:50:30 INFO  ---RUNTIME: Multi-Query Optimization took 24.07383918762207 ms
2022-09-22 03:50:30 INFO  Executing generated plans
2022-09-22 04:04:27 INFO  ---RUNTIME: Execution took 837005.2425861359 ms
2022-09-22 04:04:27 INFO  Done!
2022-09-22 04:04:27 INFO  # Finished -- repetition 1 of 7 
2022-09-22 04:04:27 INFO  # Optimization benchmark for data_corruption with args [['reviews', 'fast_loading', 'featurization_3', 'logistic_regression']] -- repetition 2 of 7
2022-09-22 04:04:27 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-22 04:04:27 INFO  Running instrumented original pipeline...
2022-09-22 04:04:27 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-22 04:04:27 INFO  ---RUNTIME: Importing and monkey-patching took 8.778095245361328 ms
2022-09-22 04:05:15 INFO  ---RUNTIME: Original pipeline execution took 48167.25945472717 ms (excluding imports and monkey-patching)
2022-09-22 04:05:15 INFO  Starting execution of 1 what-if analyses...
2022-09-22 04:05:15 INFO  Start plan generation for analysis DataCorruption...
2022-09-22 04:05:15 INFO  ---RUNTIME: Plan generation took 0.5247592926025391 ms
2022-09-22 04:05:15 INFO  Estimated runtime of original DAG is 33535.889863967896ms
2022-09-22 04:05:15 INFO  Performing Multi-Query Optimization
2022-09-22 04:05:15 INFO  Estimated unoptimized what-if runtime is 838397.2465991974ms
2022-09-22 04:05:15 INFO  Estimated optimised what-if runtime is 116849.81417655945ms
2022-09-22 04:05:15 INFO  Estimated optimisation runtime saving is 721547.4324226379ms
2022-09-22 04:05:15 INFO  ---RUNTIME: Multi-Query Optimization took 95.92270851135254 ms
2022-09-22 04:05:15 INFO  Executing generated plans
Traceback (most recent call last):
  File "/home/sgrafbe/mlwhatif/experiments/end_to_end/benchmarks_end_to_end.py", line 228, in <module>
    analysis_result_opt = PipelineAnalyzer \
  File "/home/sgrafbe/mlwhatif/mlwhatif/_pipeline_analyzer.py", line 93, in execute
    return singleton.run(notebook_path=self._notebook_path,
  File "/home/sgrafbe/mlwhatif/mlwhatif/execution/_pipeline_executor.py", line 149, in run
    self.run_what_if_analyses()
  File "/home/sgrafbe/mlwhatif/mlwhatif/execution/_pipeline_executor.py", line 178, in run_what_if_analyses
    DagExecutor(self).execute(self.analysis_results.combined_optimized_dag)
  File "/home/sgrafbe/mlwhatif/mlwhatif/execution/_dag_executor.py", line 45, in execute
    self.traverse_graph_and_process_nodes(dag, execute_node)
  File "/home/sgrafbe/mlwhatif/mlwhatif/execution/_dag_executor.py", line 57, in traverse_graph_and_process_nodes
    result_node = func(node)
  File "/home/sgrafbe/mlwhatif/mlwhatif/execution/_dag_executor.py", line 40, in execute_node
    optimizer_info, result_df = capture_optimizer_info(executable_processing_func)
  File "/home/sgrafbe/mlwhatif/mlwhatif/execution/_stat_tracking.py", line 28, in capture_optimizer_info
    result = instrumented_function_call()
  File "/home/sgrafbe/mlwhatif/mlwhatif/monkeypatching/_patch_sklearn.py", line 1726, in processing_func
    input_df_copy = input_df.copy()
numpy.core._exceptions.MemoryError: Unable to allocate 3.89 GiB for an array with shape (35312,) and data type <U29600
taskset -c 32-39 PROTOCOL_BUFFERS_PYTHON_IMPLEMENTATION=python python3.9 benchmarks_end_to_end.py data_corruption reviews fast_loading featurization_3 xgboost
2022-09-22 04:05:52.281035: W tensorflow/stream_executor/platform/default/dso_loader.cc:64] Could not load dynamic library 'libcudart.so.11.0'; dlerror: libcudart.so.11.0: cannot open shared object file: No such file or directory; LD_LIBRARY_PATH: /home/sgrafbe/mlwhatif/venv/lib/python3.9/site-packages/cv2/../../lib64:
2022-09-22 04:05:52.281076: I tensorflow/stream_executor/cuda/cudart_stub.cc:29] Ignore above cudart dlerror if you do not have a GPU set up on your machine.
2022-09-22 04:05:56 INFO  Patching sys.argv with ['mlwhatif', 'reviews', 'fast_loading', 'featurization_3', 'xgboost']
2022-09-22 04:05:56 INFO  Running instrumented original pipeline...
2022-09-22 04:05:56 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-22 04:05:58 INFO  ---RUNTIME: Importing and monkey-patching took 1901.097059249878 ms
2022-09-22 04:07:00 INFO  ---RUNTIME: Original pipeline execution took 61583.27341079712 ms (excluding imports and monkey-patching)
2022-09-22 04:07:00 INFO  Starting execution of 0 what-if analyses...
2022-09-22 04:07:00 INFO  Estimated runtime of original DAG is 50867.788314819336ms
2022-09-22 04:07:00 INFO  Performing Multi-Query Optimization
2022-09-22 04:07:00 INFO  Estimated unoptimized what-if runtime is 0ms
2022-09-22 04:07:00 INFO  Estimated optimised what-if runtime is 0ms
2022-09-22 04:07:00 INFO  Estimated optimisation runtime saving is 0ms
2022-09-22 04:07:00 INFO  ---RUNTIME: Multi-Query Optimization took 0.6098747253417969 ms
2022-09-22 04:07:00 INFO  Executing generated plans
2022-09-22 04:07:00 INFO  ---RUNTIME: Execution took 0.02384185791015625 ms
2022-09-22 04:07:00 INFO  Done!
2022-09-22 04:07:00 INFO  # Optimization benchmark for data_corruption with args [['reviews', 'fast_loading', 'featurization_3', 'xgboost']] -- repetition 1 of 7
2022-09-22 04:07:00 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-22 04:07:00 INFO  Running instrumented original pipeline...
2022-09-22 04:07:00 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-22 04:07:00 INFO  ---RUNTIME: Importing and monkey-patching took 5.637407302856445 ms
2022-09-22 04:08:04 INFO  ---RUNTIME: Original pipeline execution took 63793.21885108948 ms (excluding imports and monkey-patching)
2022-09-22 04:08:04 INFO  Starting execution of 1 what-if analyses...
2022-09-22 04:08:04 INFO  Start plan generation for analysis DataCorruption...
2022-09-22 04:08:04 INFO  ---RUNTIME: Plan generation took 0.4763603210449219 ms
2022-09-22 04:08:04 INFO  Estimated runtime of original DAG is 51048.16961288452ms
2022-09-22 04:08:04 INFO  Performing Multi-Query Optimization
2022-09-22 04:08:04 INFO  Estimated unoptimized what-if runtime is 1276204.240322113ms
2022-09-22 04:08:04 INFO  Estimated optimised what-if runtime is 136817.44360923767ms
2022-09-22 04:08:04 INFO  Estimated optimisation runtime saving is 1139386.7967128754ms
2022-09-22 04:08:04 INFO  ---RUNTIME: Multi-Query Optimization took 78.66573333740234 ms
2022-09-22 04:08:04 INFO  Executing generated plans
2022-09-22 04:09:18 INFO  ---RUNTIME: Execution took 74475.29125213623 ms
2022-09-22 04:09:18 INFO  Done!
2022-09-22 04:09:18 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-22 04:09:18 INFO  Running instrumented original pipeline...
2022-09-22 04:09:18 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-22 04:09:18 INFO  ---RUNTIME: Importing and monkey-patching took 6.183862686157227 ms
2022-09-22 04:10:20 INFO  ---RUNTIME: Original pipeline execution took 61337.99910545349 ms (excluding imports and monkey-patching)
2022-09-22 04:10:20 INFO  Starting execution of 1 what-if analyses...
2022-09-22 04:10:20 INFO  Start plan generation for analysis DataCorruption...
2022-09-22 04:10:20 INFO  ---RUNTIME: Plan generation took 0.5083084106445312 ms
2022-09-22 04:10:20 INFO  Estimated runtime of original DAG is 48672.01495170593ms
2022-09-22 04:10:20 WARNING Skipping Multi-Query Optimization (instead, only applying patches)
2022-09-22 04:10:20 INFO  Estimated unoptimised what-if runtime is 1216800.3737926483ms
2022-09-22 04:10:20 INFO  ---RUNTIME: Multi-Query Optimization took 23.291587829589844 ms
2022-09-22 04:10:20 INFO  Executing generated plans
Traceback (most recent call last):
  File "/home/sgrafbe/mlwhatif/experiments/end_to_end/benchmarks_end_to_end.py", line 238, in <module>
    analysis_result_no_opt = PipelineAnalyzer \
  File "/home/sgrafbe/mlwhatif/mlwhatif/_pipeline_analyzer.py", line 93, in execute
    return singleton.run(notebook_path=self._notebook_path,
  File "/home/sgrafbe/mlwhatif/mlwhatif/execution/_pipeline_executor.py", line 149, in run
    self.run_what_if_analyses()
  File "/home/sgrafbe/mlwhatif/mlwhatif/execution/_pipeline_executor.py", line 181, in run_what_if_analyses
    DagExecutor(self).execute(what_if_dag)
  File "/home/sgrafbe/mlwhatif/mlwhatif/execution/_dag_executor.py", line 45, in execute
    self.traverse_graph_and_process_nodes(dag, execute_node)
  File "/home/sgrafbe/mlwhatif/mlwhatif/execution/_dag_executor.py", line 57, in traverse_graph_and_process_nodes
    result_node = func(node)
  File "/home/sgrafbe/mlwhatif/mlwhatif/execution/_dag_executor.py", line 40, in execute_node
    optimizer_info, result_df = capture_optimizer_info(executable_processing_func)
  File "/home/sgrafbe/mlwhatif/mlwhatif/execution/_stat_tracking.py", line 28, in capture_optimizer_info
    result = instrumented_function_call()
  File "/home/sgrafbe/mlwhatif/mlwhatif/monkeypatching/_patch_sklearn.py", line 1729, in processing_func
    transformed_data = wrap_in_mlinspect_array_if_necessary(transformed_data)
  File "/home/sgrafbe/mlwhatif/mlwhatif/monkeypatching/_monkey_patching_utils.py", line 229, in wrap_in_mlinspect_array_if_necessary
    df_object = MlinspectNdarray(df_object)
  File "/home/sgrafbe/mlwhatif/mlwhatif/monkeypatching/_mlinspect_ndarray.py", line 16, in __new__
    obj = numpy.asarray(input_array).view(cls)
  File "/home/sgrafbe/mlwhatif/venv/lib64/python3.9/site-packages/numpy/core/_asarray.py", line 83, in asarray
    return array(a, dtype, copy=False, order=order)
numpy.core._exceptions.MemoryError: Unable to allocate 3.72 GiB for an array with shape (35312,) and data type <U28286
taskset -c 32-39 PROTOCOL_BUFFERS_PYTHON_IMPLEMENTATION=python python3.9 benchmarks_end_to_end.py data_corruption reviews fast_loading featurization_3 neural_network
2022-09-22 04:10:43.964480: W tensorflow/stream_executor/platform/default/dso_loader.cc:64] Could not load dynamic library 'libcudart.so.11.0'; dlerror: libcudart.so.11.0: cannot open shared object file: No such file or directory; LD_LIBRARY_PATH: /home/sgrafbe/mlwhatif/venv/lib/python3.9/site-packages/cv2/../../lib64:
2022-09-22 04:10:43.964514: I tensorflow/stream_executor/cuda/cudart_stub.cc:29] Ignore above cudart dlerror if you do not have a GPU set up on your machine.
2022-09-22 04:10:46 INFO  Patching sys.argv with ['mlwhatif', 'reviews', 'fast_loading', 'featurization_3', 'neural_network']
2022-09-22 04:10:46 INFO  Running instrumented original pipeline...
2022-09-22 04:10:46 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-22 04:10:46 INFO  ---RUNTIME: Importing and monkey-patching took 187.5629425048828 ms
2022-09-22 04:11:07.752667: W tensorflow/stream_executor/platform/default/dso_loader.cc:64] Could not load dynamic library 'libcuda.so.1'; dlerror: libcuda.so.1: cannot open shared object file: No such file or directory; LD_LIBRARY_PATH: /home/sgrafbe/mlwhatif/venv/lib/python3.9/site-packages/cv2/../../lib64:
2022-09-22 04:11:07.752700: W tensorflow/stream_executor/cuda/cuda_driver.cc:326] failed call to cuInit: UNKNOWN ERROR (303)
2022-09-22 04:11:07.752723: I tensorflow/stream_executor/cuda/cuda_diagnostics.cc:156] kernel driver does not appear to be running on this host (angus): /proc/driver/nvidia/version does not exist
2022-09-22 04:11:07.753166: I tensorflow/core/platform/cpu_feature_guard.cc:142] This TensorFlow binary is optimized with oneAPI Deep Neural Network Library (oneDNN) to use the following CPU instructions in performance-critical operations:  AVX2 FMA
To enable them in other operations, rebuild TensorFlow with the appropriate compiler flags.
2022-09-22 04:11:08.384989: I tensorflow/compiler/mlir/mlir_graph_optimization_pass.cc:176] None of the MLIR Optimization Passes are enabled (registered 2)
2022-09-22 04:11:08.399173: I tensorflow/core/platform/profile_utils/cpu_utils.cc:114] CPU Frequency: 2595130000 Hz
2022-09-22 04:11:33 INFO  ---RUNTIME: Original pipeline execution took 47338.632345199585 ms (excluding imports and monkey-patching)
2022-09-22 04:11:33 INFO  Starting execution of 0 what-if analyses...
2022-09-22 04:11:33 INFO  Estimated runtime of original DAG is 39417.097091674805ms
2022-09-22 04:11:33 INFO  Performing Multi-Query Optimization
2022-09-22 04:11:33 INFO  Estimated unoptimized what-if runtime is 0ms
2022-09-22 04:11:33 INFO  Estimated optimised what-if runtime is 0ms
2022-09-22 04:11:33 INFO  Estimated optimisation runtime saving is 0ms
2022-09-22 04:11:33 INFO  ---RUNTIME: Multi-Query Optimization took 0.5471706390380859 ms
2022-09-22 04:11:33 INFO  Executing generated plans
2022-09-22 04:11:33 INFO  ---RUNTIME: Execution took 0.0152587890625 ms
2022-09-22 04:11:33 INFO  Done!
2022-09-22 04:11:33 INFO  # Optimization benchmark for data_corruption with args [['reviews', 'fast_loading', 'featurization_3', 'neural_network']] -- repetition 1 of 7
2022-09-22 04:11:33 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-22 04:11:33 INFO  Running instrumented original pipeline...
2022-09-22 04:11:33 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-22 04:11:33 INFO  ---RUNTIME: Importing and monkey-patching took 5.317211151123047 ms
2022-09-22 04:12:27 INFO  ---RUNTIME: Original pipeline execution took 53571.96640968323 ms (excluding imports and monkey-patching)
2022-09-22 04:12:27 INFO  Starting execution of 1 what-if analyses...
2022-09-22 04:12:27 INFO  Start plan generation for analysis DataCorruption...
2022-09-22 04:12:27 INFO  ---RUNTIME: Plan generation took 0.42438507080078125 ms
2022-09-22 04:12:27 INFO  Estimated runtime of original DAG is 40867.43998527527ms
2022-09-22 04:12:27 INFO  Performing Multi-Query Optimization
2022-09-22 04:12:27 INFO  Estimated unoptimized what-if runtime is 1021685.9996318817ms
2022-09-22 04:12:27 INFO  Estimated optimised what-if runtime is 143028.4924507141ms
2022-09-22 04:12:27 INFO  Estimated optimisation runtime saving is 878657.5071811676ms
2022-09-22 04:12:27 INFO  ---RUNTIME: Multi-Query Optimization took 81.8319320678711 ms
2022-09-22 04:12:27 INFO  Executing generated plans
2022-09-22 04:13:53 INFO  ---RUNTIME: Execution took 86135.56361198425 ms
2022-09-22 04:13:53 INFO  Done!
2022-09-22 04:13:53 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-22 04:13:53 INFO  Running instrumented original pipeline...
2022-09-22 04:13:53 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-22 04:13:53 INFO  ---RUNTIME: Importing and monkey-patching took 6.719350814819336 ms
2022-09-22 04:14:50 INFO  ---RUNTIME: Original pipeline execution took 57220.5650806427 ms (excluding imports and monkey-patching)
2022-09-22 04:14:50 INFO  Starting execution of 1 what-if analyses...
2022-09-22 04:14:50 INFO  Start plan generation for analysis DataCorruption...
2022-09-22 04:14:50 INFO  ---RUNTIME: Plan generation took 0.48065185546875 ms
2022-09-22 04:14:50 INFO  Estimated runtime of original DAG is 42609.28416252136ms
2022-09-22 04:14:50 WARNING Skipping Multi-Query Optimization (instead, only applying patches)
2022-09-22 04:14:50 INFO  Estimated unoptimised what-if runtime is 1065232.104063034ms
2022-09-22 04:14:50 INFO  ---RUNTIME: Multi-Query Optimization took 24.25217628479004 ms
2022-09-22 04:14:50 INFO  Executing generated plans
Traceback (most recent call last):
  File "/home/sgrafbe/mlwhatif/experiments/end_to_end/benchmarks_end_to_end.py", line 238, in <module>
    analysis_result_no_opt = PipelineAnalyzer \
  File "/home/sgrafbe/mlwhatif/mlwhatif/_pipeline_analyzer.py", line 93, in execute
    return singleton.run(notebook_path=self._notebook_path,
  File "/home/sgrafbe/mlwhatif/mlwhatif/execution/_pipeline_executor.py", line 149, in run
    self.run_what_if_analyses()
  File "/home/sgrafbe/mlwhatif/mlwhatif/execution/_pipeline_executor.py", line 181, in run_what_if_analyses
    DagExecutor(self).execute(what_if_dag)
  File "/home/sgrafbe/mlwhatif/mlwhatif/execution/_dag_executor.py", line 45, in execute
    self.traverse_graph_and_process_nodes(dag, execute_node)
  File "/home/sgrafbe/mlwhatif/mlwhatif/execution/_dag_executor.py", line 57, in traverse_graph_and_process_nodes
    result_node = func(node)
  File "/home/sgrafbe/mlwhatif/mlwhatif/execution/_dag_executor.py", line 40, in execute_node
    optimizer_info, result_df = capture_optimizer_info(executable_processing_func)
  File "/home/sgrafbe/mlwhatif/mlwhatif/execution/_stat_tracking.py", line 28, in capture_optimizer_info
    result = instrumented_function_call()
  File "/home/sgrafbe/mlwhatif/mlwhatif/monkeypatching/_patch_sklearn.py", line 1726, in processing_func
    input_df_copy = input_df.copy()
numpy.core._exceptions.MemoryError: Unable to allocate 3.89 GiB for an array with shape (35312,) and data type <U29600
taskset -c 32-39 PROTOCOL_BUFFERS_PYTHON_IMPLEMENTATION=python python3.9 benchmarks_end_to_end.py data_corruption reviews fast_loading featurization_4 logistic_regression
2022-09-22 04:15:01.536333: W tensorflow/stream_executor/platform/default/dso_loader.cc:64] Could not load dynamic library 'libcudart.so.11.0'; dlerror: libcudart.so.11.0: cannot open shared object file: No such file or directory; LD_LIBRARY_PATH: /home/sgrafbe/mlwhatif/venv/lib/python3.9/site-packages/cv2/../../lib64:
2022-09-22 04:15:01.536377: I tensorflow/stream_executor/cuda/cudart_stub.cc:29] Ignore above cudart dlerror if you do not have a GPU set up on your machine.
2022-09-22 04:15:02 INFO  Patching sys.argv with ['mlwhatif', 'reviews', 'fast_loading', 'featurization_4', 'logistic_regression']
2022-09-22 04:15:02 INFO  Running instrumented original pipeline...
2022-09-22 04:15:02 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-22 04:15:02 INFO  ---RUNTIME: Importing and monkey-patching took 121.65689468383789 ms
2022-09-22 04:15:15 INFO  ---RUNTIME: Original pipeline execution took 12665.358304977417 ms (excluding imports and monkey-patching)
2022-09-22 04:15:15 INFO  Starting execution of 0 what-if analyses...
2022-09-22 04:15:15 INFO  Estimated runtime of original DAG is 9381.534337997437ms
2022-09-22 04:15:15 INFO  Performing Multi-Query Optimization
2022-09-22 04:15:15 INFO  Estimated unoptimized what-if runtime is 0ms
2022-09-22 04:15:15 INFO  Estimated optimised what-if runtime is 0ms
2022-09-22 04:15:15 INFO  Estimated optimisation runtime saving is 0ms
2022-09-22 04:15:15 INFO  ---RUNTIME: Multi-Query Optimization took 0.5235671997070312 ms
2022-09-22 04:15:15 INFO  Executing generated plans
2022-09-22 04:15:15 INFO  ---RUNTIME: Execution took 0.023126602172851562 ms
2022-09-22 04:15:15 INFO  Done!
2022-09-22 04:15:15 INFO  # Optimization benchmark for data_corruption with args [['reviews', 'fast_loading', 'featurization_4', 'logistic_regression']] -- repetition 1 of 7
2022-09-22 04:15:15 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-22 04:15:15 INFO  Running instrumented original pipeline...
2022-09-22 04:15:15 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-22 04:15:15 INFO  ---RUNTIME: Importing and monkey-patching took 5.49626350402832 ms
2022-09-22 04:15:28 INFO  ---RUNTIME: Original pipeline execution took 12638.58437538147 ms (excluding imports and monkey-patching)
2022-09-22 04:15:28 INFO  Starting execution of 1 what-if analyses...
2022-09-22 04:15:28 INFO  Start plan generation for analysis DataCorruption...
2022-09-22 04:15:28 INFO  ---RUNTIME: Plan generation took 0.4572868347167969 ms
2022-09-22 04:15:28 INFO  Estimated runtime of original DAG is 9346.839189529419ms
2022-09-22 04:15:28 INFO  Performing Multi-Query Optimization
2022-09-22 04:15:28 INFO  Estimated unoptimized what-if runtime is 233670.97973823547ms
2022-09-22 04:15:28 INFO  Estimated optimised what-if runtime is 10422.820568084717ms
2022-09-22 04:15:28 INFO  Estimated optimisation runtime saving is 223248.15917015076ms
2022-09-22 04:15:28 INFO  ---RUNTIME: Multi-Query Optimization took 72.39770889282227 ms
2022-09-22 04:15:28 INFO  Executing generated plans
2022-09-22 04:15:43 INFO  ---RUNTIME: Execution took 15602.28967666626 ms
2022-09-22 04:15:43 INFO  Done!
2022-09-22 04:15:43 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-22 04:15:43 INFO  Running instrumented original pipeline...
2022-09-22 04:15:43 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-22 04:15:43 INFO  ---RUNTIME: Importing and monkey-patching took 6.324529647827148 ms
2022-09-22 04:15:56 INFO  ---RUNTIME: Original pipeline execution took 12521.737813949585 ms (excluding imports and monkey-patching)
2022-09-22 04:15:56 INFO  Starting execution of 1 what-if analyses...
2022-09-22 04:15:56 INFO  Start plan generation for analysis DataCorruption...
2022-09-22 04:15:56 INFO  ---RUNTIME: Plan generation took 0.3933906555175781 ms
2022-09-22 04:15:56 INFO  Estimated runtime of original DAG is 9100.554704666138ms
2022-09-22 04:15:56 WARNING Skipping Multi-Query Optimization (instead, only applying patches)
2022-09-22 04:15:56 INFO  Estimated unoptimised what-if runtime is 227513.86761665344ms
2022-09-22 04:15:56 INFO  ---RUNTIME: Multi-Query Optimization took 20.105361938476562 ms
2022-09-22 04:15:56 INFO  Executing generated plans
2022-09-22 04:20:21 INFO  ---RUNTIME: Execution took 265382.3564052582 ms
2022-09-22 04:20:21 INFO  Done!
2022-09-22 04:20:21 INFO  # Finished -- repetition 1 of 7 
2022-09-22 04:20:21 INFO  # Optimization benchmark for data_corruption with args [['reviews', 'fast_loading', 'featurization_4', 'logistic_regression']] -- repetition 2 of 7
2022-09-22 04:20:21 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-22 04:20:21 INFO  Running instrumented original pipeline...
2022-09-22 04:20:21 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-22 04:20:21 INFO  ---RUNTIME: Importing and monkey-patching took 6.031036376953125 ms
2022-09-22 04:20:34 INFO  ---RUNTIME: Original pipeline execution took 12455.200672149658 ms (excluding imports and monkey-patching)
2022-09-22 04:20:34 INFO  Starting execution of 1 what-if analyses...
2022-09-22 04:20:34 INFO  Start plan generation for analysis DataCorruption...
2022-09-22 04:20:34 INFO  ---RUNTIME: Plan generation took 0.4322528839111328 ms
2022-09-22 04:20:34 INFO  Estimated runtime of original DAG is 9032.225131988525ms
2022-09-22 04:20:34 INFO  Performing Multi-Query Optimization
2022-09-22 04:20:34 INFO  Estimated unoptimized what-if runtime is 225805.62829971313ms
2022-09-22 04:20:34 INFO  Estimated optimised what-if runtime is 10109.589338302612ms
2022-09-22 04:20:34 INFO  Estimated optimisation runtime saving is 215696.03896141052ms
2022-09-22 04:20:34 INFO  ---RUNTIME: Multi-Query Optimization took 69.39005851745605 ms
2022-09-22 04:20:34 INFO  Executing generated plans
2022-09-22 04:20:49 INFO  ---RUNTIME: Execution took 15371.464729309082 ms
2022-09-22 04:20:49 INFO  Done!
2022-09-22 04:20:49 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-22 04:20:49 INFO  Running instrumented original pipeline...
2022-09-22 04:20:49 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-22 04:20:49 INFO  ---RUNTIME: Importing and monkey-patching took 5.727052688598633 ms
2022-09-22 04:21:02 INFO  ---RUNTIME: Original pipeline execution took 12628.687620162964 ms (excluding imports and monkey-patching)
2022-09-22 04:21:02 INFO  Starting execution of 1 what-if analyses...
2022-09-22 04:21:02 INFO  Start plan generation for analysis DataCorruption...
2022-09-22 04:21:02 INFO  ---RUNTIME: Plan generation took 0.44155120849609375 ms
2022-09-22 04:21:02 INFO  Estimated runtime of original DAG is 9347.301959991455ms
2022-09-22 04:21:02 WARNING Skipping Multi-Query Optimization (instead, only applying patches)
2022-09-22 04:21:02 INFO  Estimated unoptimised what-if runtime is 233682.54899978638ms
2022-09-22 04:21:02 INFO  ---RUNTIME: Multi-Query Optimization took 19.931793212890625 ms
2022-09-22 04:21:02 INFO  Executing generated plans
2022-09-22 04:25:30 INFO  ---RUNTIME: Execution took 268121.4153766632 ms
2022-09-22 04:25:30 INFO  Done!
2022-09-22 04:25:30 INFO  # Finished -- repetition 2 of 7 
2022-09-22 04:25:30 INFO  # Optimization benchmark for data_corruption with args [['reviews', 'fast_loading', 'featurization_4', 'logistic_regression']] -- repetition 3 of 7
2022-09-22 04:25:30 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-22 04:25:30 INFO  Running instrumented original pipeline...
2022-09-22 04:25:30 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-22 04:25:30 INFO  ---RUNTIME: Importing and monkey-patching took 6.148338317871094 ms
2022-09-22 04:25:43 INFO  ---RUNTIME: Original pipeline execution took 12671.160697937012 ms (excluding imports and monkey-patching)
2022-09-22 04:25:43 INFO  Starting execution of 1 what-if analyses...
2022-09-22 04:25:43 INFO  Start plan generation for analysis DataCorruption...
2022-09-22 04:25:43 INFO  ---RUNTIME: Plan generation took 0.43773651123046875 ms
2022-09-22 04:25:43 INFO  Estimated runtime of original DAG is 9201.827049255371ms
2022-09-22 04:25:43 INFO  Performing Multi-Query Optimization
2022-09-22 04:25:43 INFO  Estimated unoptimized what-if runtime is 230045.67623138428ms
2022-09-22 04:25:43 INFO  Estimated optimised what-if runtime is 10483.3345413208ms
2022-09-22 04:25:43 INFO  Estimated optimisation runtime saving is 219562.34169006348ms
2022-09-22 04:25:43 INFO  ---RUNTIME: Multi-Query Optimization took 70.1897144317627 ms
2022-09-22 04:25:43 INFO  Executing generated plans
2022-09-22 04:25:59 INFO  ---RUNTIME: Execution took 15786.800146102905 ms
2022-09-22 04:25:59 INFO  Done!
2022-09-22 04:25:59 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-22 04:25:59 INFO  Running instrumented original pipeline...
2022-09-22 04:25:59 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-22 04:25:59 INFO  ---RUNTIME: Importing and monkey-patching took 6.172418594360352 ms
2022-09-22 04:26:11 INFO  ---RUNTIME: Original pipeline execution took 12669.512748718262 ms (excluding imports and monkey-patching)
2022-09-22 04:26:11 INFO  Starting execution of 1 what-if analyses...
2022-09-22 04:26:11 INFO  Start plan generation for analysis DataCorruption...
2022-09-22 04:26:11 INFO  ---RUNTIME: Plan generation took 0.40221214294433594 ms
2022-09-22 04:26:11 INFO  Estimated runtime of original DAG is 9177.929401397705ms
2022-09-22 04:26:11 WARNING Skipping Multi-Query Optimization (instead, only applying patches)
2022-09-22 04:26:11 INFO  Estimated unoptimised what-if runtime is 229448.23503494263ms
2022-09-22 04:26:11 INFO  ---RUNTIME: Multi-Query Optimization took 20.112276077270508 ms
2022-09-22 04:26:11 INFO  Executing generated plans
2022-09-22 04:30:38 INFO  ---RUNTIME: Execution took 266881.0796737671 ms
2022-09-22 04:30:38 INFO  Done!
2022-09-22 04:30:38 INFO  # Finished -- repetition 3 of 7 
2022-09-22 04:30:38 INFO  # Optimization benchmark for data_corruption with args [['reviews', 'fast_loading', 'featurization_4', 'logistic_regression']] -- repetition 4 of 7
2022-09-22 04:30:38 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-22 04:30:38 INFO  Running instrumented original pipeline...
2022-09-22 04:30:38 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-22 04:30:38 INFO  ---RUNTIME: Importing and monkey-patching took 5.809783935546875 ms
2022-09-22 04:30:51 INFO  ---RUNTIME: Original pipeline execution took 12730.883359909058 ms (excluding imports and monkey-patching)
2022-09-22 04:30:51 INFO  Starting execution of 1 what-if analyses...
2022-09-22 04:30:51 INFO  Start plan generation for analysis DataCorruption...
2022-09-22 04:30:51 INFO  ---RUNTIME: Plan generation took 0.4360675811767578 ms
2022-09-22 04:30:51 INFO  Estimated runtime of original DAG is 9420.754432678223ms
2022-09-22 04:30:51 INFO  Performing Multi-Query Optimization
2022-09-22 04:30:51 INFO  Estimated unoptimized what-if runtime is 235518.86081695557ms
2022-09-22 04:30:51 INFO  Estimated optimised what-if runtime is 10940.82498550415ms
2022-09-22 04:30:51 INFO  Estimated optimisation runtime saving is 224578.03583145142ms
2022-09-22 04:30:51 INFO  ---RUNTIME: Multi-Query Optimization took 110.81790924072266 ms
2022-09-22 04:30:51 INFO  Executing generated plans
2022-09-22 04:31:06 INFO  ---RUNTIME: Execution took 15377.674102783203 ms
2022-09-22 04:31:06 INFO  Done!
2022-09-22 04:31:06 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-22 04:31:06 INFO  Running instrumented original pipeline...
2022-09-22 04:31:06 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-22 04:31:06 INFO  ---RUNTIME: Importing and monkey-patching took 5.827665328979492 ms
2022-09-22 04:31:19 INFO  ---RUNTIME: Original pipeline execution took 12624.727964401245 ms (excluding imports and monkey-patching)
2022-09-22 04:31:19 INFO  Starting execution of 1 what-if analyses...
2022-09-22 04:31:19 INFO  Start plan generation for analysis DataCorruption...
2022-09-22 04:31:19 INFO  ---RUNTIME: Plan generation took 0.4177093505859375 ms
2022-09-22 04:31:19 INFO  Estimated runtime of original DAG is 9383.442401885986ms
2022-09-22 04:31:19 WARNING Skipping Multi-Query Optimization (instead, only applying patches)
2022-09-22 04:31:19 INFO  Estimated unoptimised what-if runtime is 234586.06004714966ms
2022-09-22 04:31:19 INFO  ---RUNTIME: Multi-Query Optimization took 20.557403564453125 ms
2022-09-22 04:31:19 INFO  Executing generated plans
2022-09-22 04:35:47 INFO  ---RUNTIME: Execution took 267968.40262413025 ms
2022-09-22 04:35:47 INFO  Done!
2022-09-22 04:35:47 INFO  # Finished -- repetition 4 of 7 
2022-09-22 04:35:47 INFO  # Optimization benchmark for data_corruption with args [['reviews', 'fast_loading', 'featurization_4', 'logistic_regression']] -- repetition 5 of 7
2022-09-22 04:35:47 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-22 04:35:47 INFO  Running instrumented original pipeline...
2022-09-22 04:35:47 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-22 04:35:47 INFO  ---RUNTIME: Importing and monkey-patching took 5.990266799926758 ms
2022-09-22 04:36:00 INFO  ---RUNTIME: Original pipeline execution took 12920.231819152832 ms (excluding imports and monkey-patching)
2022-09-22 04:36:00 INFO  Starting execution of 1 what-if analyses...
2022-09-22 04:36:00 INFO  Start plan generation for analysis DataCorruption...
2022-09-22 04:36:00 INFO  ---RUNTIME: Plan generation took 0.5054473876953125 ms
2022-09-22 04:36:00 INFO  Estimated runtime of original DAG is 9611.91701889038ms
2022-09-22 04:36:00 INFO  Performing Multi-Query Optimization
2022-09-22 04:36:00 INFO  Estimated unoptimized what-if runtime is 240297.92547225952ms
2022-09-22 04:36:00 INFO  Estimated optimised what-if runtime is 10967.64063835144ms
2022-09-22 04:36:00 INFO  Estimated optimisation runtime saving is 229330.28483390808ms
2022-09-22 04:36:00 INFO  ---RUNTIME: Multi-Query Optimization took 69.72312927246094 ms
2022-09-22 04:36:00 INFO  Executing generated plans
2022-09-22 04:36:16 INFO  ---RUNTIME: Execution took 15627.874612808228 ms
2022-09-22 04:36:16 INFO  Done!
2022-09-22 04:36:16 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-22 04:36:16 INFO  Running instrumented original pipeline...
2022-09-22 04:36:16 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-22 04:36:16 INFO  ---RUNTIME: Importing and monkey-patching took 5.80596923828125 ms
2022-09-22 04:36:29 INFO  ---RUNTIME: Original pipeline execution took 12820.93858718872 ms (excluding imports and monkey-patching)
2022-09-22 04:36:29 INFO  Starting execution of 1 what-if analyses...
2022-09-22 04:36:29 INFO  Start plan generation for analysis DataCorruption...
2022-09-22 04:36:29 INFO  ---RUNTIME: Plan generation took 0.4062652587890625 ms
2022-09-22 04:36:29 INFO  Estimated runtime of original DAG is 9540.607452392578ms
2022-09-22 04:36:29 WARNING Skipping Multi-Query Optimization (instead, only applying patches)
2022-09-22 04:36:29 INFO  Estimated unoptimised what-if runtime is 238515.18630981445ms
2022-09-22 04:36:29 INFO  ---RUNTIME: Multi-Query Optimization took 20.061492919921875 ms
2022-09-22 04:36:29 INFO  Executing generated plans
2022-09-22 04:40:58 INFO  ---RUNTIME: Execution took 269626.5437602997 ms
2022-09-22 04:40:58 INFO  Done!
2022-09-22 04:40:58 INFO  # Finished -- repetition 5 of 7 
2022-09-22 04:40:58 INFO  # Optimization benchmark for data_corruption with args [['reviews', 'fast_loading', 'featurization_4', 'logistic_regression']] -- repetition 6 of 7
2022-09-22 04:40:58 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-22 04:40:58 INFO  Running instrumented original pipeline...
2022-09-22 04:40:58 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-22 04:40:58 INFO  ---RUNTIME: Importing and monkey-patching took 6.059408187866211 ms
2022-09-22 04:41:11 INFO  ---RUNTIME: Original pipeline execution took 13019.361972808838 ms (excluding imports and monkey-patching)
2022-09-22 04:41:11 INFO  Starting execution of 1 what-if analyses...
2022-09-22 04:41:11 INFO  Start plan generation for analysis DataCorruption...
2022-09-22 04:41:11 INFO  ---RUNTIME: Plan generation took 0.4565715789794922 ms
2022-09-22 04:41:11 INFO  Estimated runtime of original DAG is 9343.564510345459ms
2022-09-22 04:41:11 INFO  Performing Multi-Query Optimization
2022-09-22 04:41:11 INFO  Estimated unoptimized what-if runtime is 233589.11275863647ms
2022-09-22 04:41:11 INFO  Estimated optimised what-if runtime is 10727.979183197021ms
2022-09-22 04:41:11 INFO  Estimated optimisation runtime saving is 222861.13357543945ms
2022-09-22 04:41:11 INFO  ---RUNTIME: Multi-Query Optimization took 69.34380531311035 ms
2022-09-22 04:41:11 INFO  Executing generated plans
2022-09-22 04:41:27 INFO  ---RUNTIME: Execution took 15659.476041793823 ms
2022-09-22 04:41:27 INFO  Done!
2022-09-22 04:41:27 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-22 04:41:27 INFO  Running instrumented original pipeline...
2022-09-22 04:41:27 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-22 04:41:27 INFO  ---RUNTIME: Importing and monkey-patching took 5.755901336669922 ms
2022-09-22 04:41:40 INFO  ---RUNTIME: Original pipeline execution took 12746.405839920044 ms (excluding imports and monkey-patching)
2022-09-22 04:41:40 INFO  Starting execution of 1 what-if analyses...
2022-09-22 04:41:40 INFO  Start plan generation for analysis DataCorruption...
2022-09-22 04:41:40 INFO  ---RUNTIME: Plan generation took 0.4417896270751953 ms
2022-09-22 04:41:40 INFO  Estimated runtime of original DAG is 9197.782278060913ms
2022-09-22 04:41:40 WARNING Skipping Multi-Query Optimization (instead, only applying patches)
2022-09-22 04:41:40 INFO  Estimated unoptimised what-if runtime is 229944.55695152283ms
2022-09-22 04:41:40 INFO  ---RUNTIME: Multi-Query Optimization took 20.641803741455078 ms
2022-09-22 04:41:40 INFO  Executing generated plans
2022-09-22 04:46:12 INFO  ---RUNTIME: Execution took 271782.7310562134 ms
2022-09-22 04:46:12 INFO  Done!
2022-09-22 04:46:12 INFO  # Finished -- repetition 6 of 7 
2022-09-22 04:46:12 INFO  # Optimization benchmark for data_corruption with args [['reviews', 'fast_loading', 'featurization_4', 'logistic_regression']] -- repetition 7 of 7
2022-09-22 04:46:12 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-22 04:46:12 INFO  Running instrumented original pipeline...
2022-09-22 04:46:12 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-22 04:46:12 INFO  ---RUNTIME: Importing and monkey-patching took 8.742094039916992 ms
2022-09-22 04:46:24 INFO  ---RUNTIME: Original pipeline execution took 12646.857261657715 ms (excluding imports and monkey-patching)
2022-09-22 04:46:24 INFO  Starting execution of 1 what-if analyses...
2022-09-22 04:46:24 INFO  Start plan generation for analysis DataCorruption...
2022-09-22 04:46:24 INFO  ---RUNTIME: Plan generation took 0.4038810729980469 ms
2022-09-22 04:46:24 INFO  Estimated runtime of original DAG is 9358.80708694458ms
2022-09-22 04:46:24 INFO  Performing Multi-Query Optimization
2022-09-22 04:46:24 INFO  Estimated unoptimized what-if runtime is 233970.1771736145ms
2022-09-22 04:46:24 INFO  Estimated optimised what-if runtime is 10893.439292907715ms
2022-09-22 04:46:24 INFO  Estimated optimisation runtime saving is 223076.7378807068ms
2022-09-22 04:46:24 INFO  ---RUNTIME: Multi-Query Optimization took 111.70458793640137 ms
2022-09-22 04:46:24 INFO  Executing generated plans
2022-09-22 04:46:40 INFO  ---RUNTIME: Execution took 15969.04182434082 ms
2022-09-22 04:46:40 INFO  Done!
2022-09-22 04:46:40 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-22 04:46:40 INFO  Running instrumented original pipeline...
2022-09-22 04:46:40 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-22 04:46:40 INFO  ---RUNTIME: Importing and monkey-patching took 6.063222885131836 ms
2022-09-22 04:46:53 INFO  ---RUNTIME: Original pipeline execution took 12893.553495407104 ms (excluding imports and monkey-patching)
2022-09-22 04:46:53 INFO  Starting execution of 1 what-if analyses...
2022-09-22 04:46:53 INFO  Start plan generation for analysis DataCorruption...
2022-09-22 04:46:53 INFO  ---RUNTIME: Plan generation took 0.6687641143798828 ms
2022-09-22 04:46:53 INFO  Estimated runtime of original DAG is 9578.439950942993ms
2022-09-22 04:46:53 WARNING Skipping Multi-Query Optimization (instead, only applying patches)
2022-09-22 04:46:53 INFO  Estimated unoptimised what-if runtime is 239460.99877357483ms
2022-09-22 04:46:53 INFO  ---RUNTIME: Multi-Query Optimization took 31.231164932250977 ms
2022-09-22 04:46:53 INFO  Executing generated plans
2022-09-22 04:51:25 INFO  ---RUNTIME: Execution took 272295.33219337463 ms
2022-09-22 04:51:25 INFO  Done!
2022-09-22 04:51:26 INFO  # Finished -- repetition 7 of 7 
2022-09-22 04:51:26 INFO  # Final results after all repetitions
2022-09-22 04:51:26 INFO     repetition  ... no_opt_what_if_execution_combined_model_training
0           0  ...                                      4576.750755
1           1  ...                                      4909.653902
2           2  ...                                      4589.804173
3           3  ...                                      4695.737123
4           4  ...                                      4589.766264
5           5  ...                                      5590.731859
6           6  ...                                      5428.801775

[7 rows x 26 columns]
taskset -c 32-39 PROTOCOL_BUFFERS_PYTHON_IMPLEMENTATION=python python3.9 benchmarks_end_to_end.py data_corruption reviews fast_loading featurization_4 xgboost
2022-09-22 04:51:28.359183: W tensorflow/stream_executor/platform/default/dso_loader.cc:64] Could not load dynamic library 'libcudart.so.11.0'; dlerror: libcudart.so.11.0: cannot open shared object file: No such file or directory; LD_LIBRARY_PATH: /home/sgrafbe/mlwhatif/venv/lib/python3.9/site-packages/cv2/../../lib64:
2022-09-22 04:51:28.359222: I tensorflow/stream_executor/cuda/cudart_stub.cc:29] Ignore above cudart dlerror if you do not have a GPU set up on your machine.
2022-09-22 04:51:29 INFO  Patching sys.argv with ['mlwhatif', 'reviews', 'fast_loading', 'featurization_4', 'xgboost']
2022-09-22 04:51:29 INFO  Running instrumented original pipeline...
2022-09-22 04:51:29 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-22 04:51:29 INFO  ---RUNTIME: Importing and monkey-patching took 122.71642684936523 ms
2022-09-22 04:51:48 INFO  ---RUNTIME: Original pipeline execution took 18326.16090774536 ms (excluding imports and monkey-patching)
2022-09-22 04:51:48 INFO  Starting execution of 0 what-if analyses...
2022-09-22 04:51:48 INFO  Estimated runtime of original DAG is 14857.490062713623ms
2022-09-22 04:51:48 INFO  Performing Multi-Query Optimization
2022-09-22 04:51:48 INFO  Estimated unoptimized what-if runtime is 0ms
2022-09-22 04:51:48 INFO  Estimated optimised what-if runtime is 0ms
2022-09-22 04:51:48 INFO  Estimated optimisation runtime saving is 0ms
2022-09-22 04:51:48 INFO  ---RUNTIME: Multi-Query Optimization took 0.6852149963378906 ms
2022-09-22 04:51:48 INFO  Executing generated plans
2022-09-22 04:51:48 INFO  ---RUNTIME: Execution took 0.029802322387695312 ms
2022-09-22 04:51:48 INFO  Done!
2022-09-22 04:51:48 INFO  # Optimization benchmark for data_corruption with args [['reviews', 'fast_loading', 'featurization_4', 'xgboost']] -- repetition 1 of 7
2022-09-22 04:51:48 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-22 04:51:48 INFO  Running instrumented original pipeline...
2022-09-22 04:51:48 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-22 04:51:48 INFO  ---RUNTIME: Importing and monkey-patching took 6.172895431518555 ms
2022-09-22 04:52:06 INFO  ---RUNTIME: Original pipeline execution took 18455.58762550354 ms (excluding imports and monkey-patching)
2022-09-22 04:52:06 INFO  Starting execution of 1 what-if analyses...
2022-09-22 04:52:06 INFO  Start plan generation for analysis DataCorruption...
2022-09-22 04:52:06 INFO  ---RUNTIME: Plan generation took 0.4887580871582031 ms
2022-09-22 04:52:06 INFO  Estimated runtime of original DAG is 14837.196826934814ms
2022-09-22 04:52:06 INFO  Performing Multi-Query Optimization
2022-09-22 04:52:06 INFO  Estimated unoptimized what-if runtime is 370929.92067337036ms
2022-09-22 04:52:06 INFO  Estimated optimised what-if runtime is 17530.308485031128ms
2022-09-22 04:52:06 INFO  Estimated optimisation runtime saving is 353399.61218833923ms
2022-09-22 04:52:06 INFO  ---RUNTIME: Multi-Query Optimization took 70.12271881103516 ms
2022-09-22 04:52:06 INFO  Executing generated plans
2022-09-22 04:52:28 INFO  ---RUNTIME: Execution took 21932.20543861389 ms
2022-09-22 04:52:28 INFO  Done!
2022-09-22 04:52:28 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-22 04:52:28 INFO  Running instrumented original pipeline...
2022-09-22 04:52:28 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-22 04:52:28 INFO  ---RUNTIME: Importing and monkey-patching took 6.092548370361328 ms
2022-09-22 04:52:46 INFO  ---RUNTIME: Original pipeline execution took 17606.208086013794 ms (excluding imports and monkey-patching)
2022-09-22 04:52:46 INFO  Starting execution of 1 what-if analyses...
2022-09-22 04:52:46 INFO  Start plan generation for analysis DataCorruption...
2022-09-22 04:52:46 INFO  ---RUNTIME: Plan generation took 0.4570484161376953 ms
2022-09-22 04:52:46 INFO  Estimated runtime of original DAG is 13986.453771591187ms
2022-09-22 04:52:46 WARNING Skipping Multi-Query Optimization (instead, only applying patches)
2022-09-22 04:52:46 INFO  Estimated unoptimised what-if runtime is 349661.34428977966ms
2022-09-22 04:52:46 INFO  ---RUNTIME: Multi-Query Optimization took 20.821332931518555 ms
2022-09-22 04:52:46 INFO  Executing generated plans
2022-09-22 04:59:00 INFO  ---RUNTIME: Execution took 374309.4892501831 ms
2022-09-22 04:59:00 INFO  Done!
2022-09-22 04:59:00 INFO  # Finished -- repetition 1 of 7 
2022-09-22 04:59:00 INFO  # Optimization benchmark for data_corruption with args [['reviews', 'fast_loading', 'featurization_4', 'xgboost']] -- repetition 2 of 7
2022-09-22 04:59:00 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-22 04:59:00 INFO  Running instrumented original pipeline...
2022-09-22 04:59:00 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-22 04:59:00 INFO  ---RUNTIME: Importing and monkey-patching took 6.355047225952148 ms
2022-09-22 04:59:17 INFO  ---RUNTIME: Original pipeline execution took 17264.05930519104 ms (excluding imports and monkey-patching)
2022-09-22 04:59:17 INFO  Starting execution of 1 what-if analyses...
2022-09-22 04:59:17 INFO  Start plan generation for analysis DataCorruption...
2022-09-22 04:59:17 INFO  ---RUNTIME: Plan generation took 0.45943260192871094 ms
2022-09-22 04:59:17 INFO  Estimated runtime of original DAG is 13723.764657974243ms
2022-09-22 04:59:17 INFO  Performing Multi-Query Optimization
2022-09-22 04:59:17 INFO  Estimated unoptimized what-if runtime is 343094.1164493561ms
2022-09-22 04:59:17 INFO  Estimated optimised what-if runtime is 16364.24970626831ms
2022-09-22 04:59:17 INFO  Estimated optimisation runtime saving is 326729.86674308777ms
2022-09-22 04:59:17 INFO  ---RUNTIME: Multi-Query Optimization took 71.14648818969727 ms
2022-09-22 04:59:17 INFO  Executing generated plans
2022-09-22 04:59:39 INFO  ---RUNTIME: Execution took 21087.653398513794 ms
2022-09-22 04:59:39 INFO  Done!
2022-09-22 04:59:39 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-22 04:59:39 INFO  Running instrumented original pipeline...
2022-09-22 04:59:39 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-22 04:59:39 INFO  ---RUNTIME: Importing and monkey-patching took 5.928754806518555 ms
2022-09-22 04:59:56 INFO  ---RUNTIME: Original pipeline execution took 17229.161739349365 ms (excluding imports and monkey-patching)
2022-09-22 04:59:56 INFO  Starting execution of 1 what-if analyses...
2022-09-22 04:59:56 INFO  Start plan generation for analysis DataCorruption...
2022-09-22 04:59:56 INFO  ---RUNTIME: Plan generation took 0.4744529724121094 ms
2022-09-22 04:59:56 INFO  Estimated runtime of original DAG is 13875.395774841309ms
2022-09-22 04:59:56 WARNING Skipping Multi-Query Optimization (instead, only applying patches)
2022-09-22 04:59:56 INFO  Estimated unoptimised what-if runtime is 346884.8943710327ms
2022-09-22 04:59:56 INFO  ---RUNTIME: Multi-Query Optimization took 20.46823501586914 ms
2022-09-22 04:59:56 INFO  Executing generated plans
2022-09-22 05:06:18 INFO  ---RUNTIME: Execution took 382233.681678772 ms
2022-09-22 05:06:18 INFO  Done!
2022-09-22 05:06:18 INFO  # Finished -- repetition 2 of 7 
2022-09-22 05:06:18 INFO  # Optimization benchmark for data_corruption with args [['reviews', 'fast_loading', 'featurization_4', 'xgboost']] -- repetition 3 of 7
2022-09-22 05:06:18 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-22 05:06:18 INFO  Running instrumented original pipeline...
2022-09-22 05:06:18 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-22 05:06:18 INFO  ---RUNTIME: Importing and monkey-patching took 8.933305740356445 ms
2022-09-22 05:06:36 INFO  ---RUNTIME: Original pipeline execution took 17614.289045333862 ms (excluding imports and monkey-patching)
2022-09-22 05:06:36 INFO  Starting execution of 1 what-if analyses...
2022-09-22 05:06:36 INFO  Start plan generation for analysis DataCorruption...
2022-09-22 05:06:36 INFO  ---RUNTIME: Plan generation took 0.43487548828125 ms
2022-09-22 05:06:36 INFO  Estimated runtime of original DAG is 13916.655540466309ms
2022-09-22 05:06:36 INFO  Performing Multi-Query Optimization
2022-09-22 05:06:36 INFO  Estimated unoptimized what-if runtime is 347916.3885116577ms
2022-09-22 05:06:36 INFO  Estimated optimised what-if runtime is 16590.48891067505ms
2022-09-22 05:06:36 INFO  Estimated optimisation runtime saving is 331325.89960098267ms
2022-09-22 05:06:36 INFO  ---RUNTIME: Multi-Query Optimization took 70.67656517028809 ms
2022-09-22 05:06:36 INFO  Executing generated plans
2022-09-22 05:06:57 INFO  ---RUNTIME: Execution took 21106.401205062866 ms
2022-09-22 05:06:57 INFO  Done!
2022-09-22 05:06:57 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-22 05:06:57 INFO  Running instrumented original pipeline...
2022-09-22 05:06:57 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-22 05:06:57 INFO  ---RUNTIME: Importing and monkey-patching took 5.958318710327148 ms
2022-09-22 05:07:14 INFO  ---RUNTIME: Original pipeline execution took 17478.055000305176 ms (excluding imports and monkey-patching)
2022-09-22 05:07:14 INFO  Starting execution of 1 what-if analyses...
2022-09-22 05:07:14 INFO  Start plan generation for analysis DataCorruption...
2022-09-22 05:07:14 INFO  ---RUNTIME: Plan generation took 0.4458427429199219 ms
2022-09-22 05:07:14 INFO  Estimated runtime of original DAG is 13814.863681793213ms
2022-09-22 05:07:14 WARNING Skipping Multi-Query Optimization (instead, only applying patches)
2022-09-22 05:07:14 INFO  Estimated unoptimised what-if runtime is 345371.5920448303ms
2022-09-22 05:07:14 INFO  ---RUNTIME: Multi-Query Optimization took 20.978212356567383 ms
2022-09-22 05:07:14 INFO  Executing generated plans
2022-09-22 05:13:25 INFO  ---RUNTIME: Execution took 370902.5433063507 ms
2022-09-22 05:13:25 INFO  Done!
2022-09-22 05:13:25 INFO  # Finished -- repetition 3 of 7 
2022-09-22 05:13:25 INFO  # Optimization benchmark for data_corruption with args [['reviews', 'fast_loading', 'featurization_4', 'xgboost']] -- repetition 4 of 7
2022-09-22 05:13:25 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-22 05:13:25 INFO  Running instrumented original pipeline...
2022-09-22 05:13:25 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-22 05:13:25 INFO  ---RUNTIME: Importing and monkey-patching took 6.259679794311523 ms
2022-09-22 05:13:42 INFO  ---RUNTIME: Original pipeline execution took 16739.79878425598 ms (excluding imports and monkey-patching)
2022-09-22 05:13:42 INFO  Starting execution of 1 what-if analyses...
2022-09-22 05:13:42 INFO  Start plan generation for analysis DataCorruption...
2022-09-22 05:13:42 INFO  ---RUNTIME: Plan generation took 0.4589557647705078 ms
2022-09-22 05:13:42 INFO  Estimated runtime of original DAG is 13432.393550872803ms
2022-09-22 05:13:42 INFO  Performing Multi-Query Optimization
2022-09-22 05:13:42 INFO  Estimated unoptimized what-if runtime is 335809.83877182007ms
2022-09-22 05:13:42 INFO  Estimated optimised what-if runtime is 16036.816120147705ms
2022-09-22 05:13:42 INFO  Estimated optimisation runtime saving is 319773.02265167236ms
2022-09-22 05:13:42 INFO  ---RUNTIME: Multi-Query Optimization took 69.85688209533691 ms
2022-09-22 05:13:42 INFO  Executing generated plans
2022-09-22 05:14:03 INFO  ---RUNTIME: Execution took 21054.561138153076 ms
2022-09-22 05:14:03 INFO  Done!
2022-09-22 05:14:03 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-22 05:14:03 INFO  Running instrumented original pipeline...
2022-09-22 05:14:03 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-22 05:14:03 INFO  ---RUNTIME: Importing and monkey-patching took 5.936384201049805 ms
2022-09-22 05:14:20 INFO  ---RUNTIME: Original pipeline execution took 16882.941484451294 ms (excluding imports and monkey-patching)
2022-09-22 05:14:20 INFO  Starting execution of 1 what-if analyses...
2022-09-22 05:14:20 INFO  Start plan generation for analysis DataCorruption...
2022-09-22 05:14:20 INFO  ---RUNTIME: Plan generation took 0.4467964172363281 ms
2022-09-22 05:14:20 INFO  Estimated runtime of original DAG is 13558.665990829468ms
2022-09-22 05:14:20 WARNING Skipping Multi-Query Optimization (instead, only applying patches)
2022-09-22 05:14:20 INFO  Estimated unoptimised what-if runtime is 338966.6497707367ms
2022-09-22 05:14:20 INFO  ---RUNTIME: Multi-Query Optimization took 20.382165908813477 ms
2022-09-22 05:14:20 INFO  Executing generated plans
2022-09-22 05:20:34 INFO  ---RUNTIME: Execution took 373626.4936923981 ms
2022-09-22 05:20:34 INFO  Done!
2022-09-22 05:20:34 INFO  # Finished -- repetition 4 of 7 
2022-09-22 05:20:34 INFO  # Optimization benchmark for data_corruption with args [['reviews', 'fast_loading', 'featurization_4', 'xgboost']] -- repetition 5 of 7
2022-09-22 05:20:34 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-22 05:20:34 INFO  Running instrumented original pipeline...
2022-09-22 05:20:34 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-22 05:20:34 INFO  ---RUNTIME: Importing and monkey-patching took 6.05320930480957 ms
2022-09-22 05:20:51 INFO  ---RUNTIME: Original pipeline execution took 17199.291467666626 ms (excluding imports and monkey-patching)
2022-09-22 05:20:51 INFO  Starting execution of 1 what-if analyses...
2022-09-22 05:20:51 INFO  Start plan generation for analysis DataCorruption...
2022-09-22 05:20:51 INFO  ---RUNTIME: Plan generation took 0.5679130554199219 ms
2022-09-22 05:20:51 INFO  Estimated runtime of original DAG is 13826.568365097046ms
2022-09-22 05:20:51 INFO  Performing Multi-Query Optimization
2022-09-22 05:20:51 INFO  Estimated unoptimized what-if runtime is 345664.20912742615ms
2022-09-22 05:20:51 INFO  Estimated optimised what-if runtime is 16712.772130966187ms
2022-09-22 05:20:51 INFO  Estimated optimisation runtime saving is 328951.43699645996ms
2022-09-22 05:20:51 INFO  ---RUNTIME: Multi-Query Optimization took 68.10784339904785 ms
2022-09-22 05:20:51 INFO  Executing generated plans
2022-09-22 05:21:12 INFO  ---RUNTIME: Execution took 21150.48885345459 ms
2022-09-22 05:21:12 INFO  Done!
2022-09-22 05:21:12 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-22 05:21:12 INFO  Running instrumented original pipeline...
2022-09-22 05:21:12 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-22 05:21:12 INFO  ---RUNTIME: Importing and monkey-patching took 5.7353973388671875 ms
2022-09-22 05:21:30 INFO  ---RUNTIME: Original pipeline execution took 17617.048978805542 ms (excluding imports and monkey-patching)
2022-09-22 05:21:30 INFO  Starting execution of 1 what-if analyses...
2022-09-22 05:21:30 INFO  Start plan generation for analysis DataCorruption...
2022-09-22 05:21:30 INFO  ---RUNTIME: Plan generation took 0.4761219024658203 ms
2022-09-22 05:21:30 INFO  Estimated runtime of original DAG is 14306.25057220459ms
2022-09-22 05:21:30 WARNING Skipping Multi-Query Optimization (instead, only applying patches)
2022-09-22 05:21:30 INFO  Estimated unoptimised what-if runtime is 357656.26430511475ms
2022-09-22 05:21:30 INFO  ---RUNTIME: Multi-Query Optimization took 20.37358283996582 ms
2022-09-22 05:21:30 INFO  Executing generated plans
2022-09-22 05:27:40 INFO  ---RUNTIME: Execution took 370367.09094047546 ms
2022-09-22 05:27:40 INFO  Done!
2022-09-22 05:27:40 INFO  # Finished -- repetition 5 of 7 
2022-09-22 05:27:40 INFO  # Optimization benchmark for data_corruption with args [['reviews', 'fast_loading', 'featurization_4', 'xgboost']] -- repetition 6 of 7
2022-09-22 05:27:40 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-22 05:27:40 INFO  Running instrumented original pipeline...
2022-09-22 05:27:40 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-22 05:27:40 INFO  ---RUNTIME: Importing and monkey-patching took 6.065845489501953 ms
2022-09-22 05:27:57 INFO  ---RUNTIME: Original pipeline execution took 17050.19211769104 ms (excluding imports and monkey-patching)
2022-09-22 05:27:57 INFO  Starting execution of 1 what-if analyses...
2022-09-22 05:27:57 INFO  Start plan generation for analysis DataCorruption...
2022-09-22 05:27:57 INFO  ---RUNTIME: Plan generation took 0.5261898040771484 ms
2022-09-22 05:27:57 INFO  Estimated runtime of original DAG is 13401.747226715088ms
2022-09-22 05:27:57 INFO  Performing Multi-Query Optimization
2022-09-22 05:27:57 INFO  Estimated unoptimized what-if runtime is 335043.6806678772ms
2022-09-22 05:27:57 INFO  Estimated optimised what-if runtime is 15904.359102249146ms
2022-09-22 05:27:57 INFO  Estimated optimisation runtime saving is 319139.32156562805ms
2022-09-22 05:27:57 INFO  ---RUNTIME: Multi-Query Optimization took 69.4892406463623 ms
2022-09-22 05:27:57 INFO  Executing generated plans
2022-09-22 05:28:18 INFO  ---RUNTIME: Execution took 20876.241445541382 ms
2022-09-22 05:28:18 INFO  Done!
2022-09-22 05:28:18 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-22 05:28:18 INFO  Running instrumented original pipeline...
2022-09-22 05:28:18 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-22 05:28:18 INFO  ---RUNTIME: Importing and monkey-patching took 5.795478820800781 ms
2022-09-22 05:28:35 INFO  ---RUNTIME: Original pipeline execution took 16997.262239456177 ms (excluding imports and monkey-patching)
2022-09-22 05:28:35 INFO  Starting execution of 1 what-if analyses...
2022-09-22 05:28:35 INFO  Start plan generation for analysis DataCorruption...
2022-09-22 05:28:35 INFO  ---RUNTIME: Plan generation took 0.4849433898925781 ms
2022-09-22 05:28:35 INFO  Estimated runtime of original DAG is 13372.12872505188ms
2022-09-22 05:28:35 WARNING Skipping Multi-Query Optimization (instead, only applying patches)
2022-09-22 05:28:35 INFO  Estimated unoptimised what-if runtime is 334303.218126297ms
2022-09-22 05:28:35 INFO  ---RUNTIME: Multi-Query Optimization took 20.62082290649414 ms
2022-09-22 05:28:35 INFO  Executing generated plans
2022-09-22 05:34:47 INFO  ---RUNTIME: Execution took 371533.35881233215 ms
2022-09-22 05:34:47 INFO  Done!
2022-09-22 05:34:47 INFO  # Finished -- repetition 6 of 7 
2022-09-22 05:34:47 INFO  # Optimization benchmark for data_corruption with args [['reviews', 'fast_loading', 'featurization_4', 'xgboost']] -- repetition 7 of 7
2022-09-22 05:34:47 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-22 05:34:47 INFO  Running instrumented original pipeline...
2022-09-22 05:34:47 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-22 05:34:47 INFO  ---RUNTIME: Importing and monkey-patching took 5.730628967285156 ms
2022-09-22 05:35:04 INFO  ---RUNTIME: Original pipeline execution took 16865.296840667725 ms (excluding imports and monkey-patching)
2022-09-22 05:35:04 INFO  Starting execution of 1 what-if analyses...
2022-09-22 05:35:04 INFO  Start plan generation for analysis DataCorruption...
2022-09-22 05:35:04 INFO  ---RUNTIME: Plan generation took 0.45800209045410156 ms
2022-09-22 05:35:04 INFO  Estimated runtime of original DAG is 13526.271343231201ms
2022-09-22 05:35:04 INFO  Performing Multi-Query Optimization
2022-09-22 05:35:04 INFO  Estimated unoptimized what-if runtime is 338156.78358078003ms
2022-09-22 05:35:04 INFO  Estimated optimised what-if runtime is 16102.025508880615ms
2022-09-22 05:35:04 INFO  Estimated optimisation runtime saving is 322054.7580718994ms
2022-09-22 05:35:04 INFO  ---RUNTIME: Multi-Query Optimization took 69.46897506713867 ms
2022-09-22 05:35:04 INFO  Executing generated plans
2022-09-22 05:35:25 INFO  ---RUNTIME: Execution took 21047.44529724121 ms
2022-09-22 05:35:25 INFO  Done!
2022-09-22 05:35:25 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-22 05:35:25 INFO  Running instrumented original pipeline...
2022-09-22 05:35:25 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-22 05:35:25 INFO  ---RUNTIME: Importing and monkey-patching took 6.077289581298828 ms
2022-09-22 05:35:42 INFO  ---RUNTIME: Original pipeline execution took 17289.74747657776 ms (excluding imports and monkey-patching)
2022-09-22 05:35:42 INFO  Starting execution of 1 what-if analyses...
2022-09-22 05:35:42 INFO  Start plan generation for analysis DataCorruption...
2022-09-22 05:35:42 INFO  ---RUNTIME: Plan generation took 0.4534721374511719 ms
2022-09-22 05:35:42 INFO  Estimated runtime of original DAG is 13890.49744606018ms
2022-09-22 05:35:42 WARNING Skipping Multi-Query Optimization (instead, only applying patches)
2022-09-22 05:35:42 INFO  Estimated unoptimised what-if runtime is 347262.4361515045ms
2022-09-22 05:35:42 INFO  ---RUNTIME: Multi-Query Optimization took 20.38121223449707 ms
2022-09-22 05:35:42 INFO  Executing generated plans
2022-09-22 05:41:56 INFO  ---RUNTIME: Execution took 373680.62567710876 ms
2022-09-22 05:41:56 INFO  Done!
2022-09-22 05:41:56 INFO  # Finished -- repetition 7 of 7 
2022-09-22 05:41:56 INFO  # Final results after all repetitions
2022-09-22 05:41:56 INFO     repetition  ... no_opt_what_if_execution_combined_model_training
0           0  ...                                    107008.138180
1           1  ...                                    110080.228567
2           2  ...                                    104205.053329
3           3  ...                                    107077.985048
4           4  ...                                    102442.339659
5           5  ...                                    103916.312695
6           6  ...                                    104355.907917

[7 rows x 26 columns]
taskset -c 32-39 PROTOCOL_BUFFERS_PYTHON_IMPLEMENTATION=python python3.9 benchmarks_end_to_end.py data_corruption reviews fast_loading featurization_4 neural_network
2022-09-22 05:41:58.645371: W tensorflow/stream_executor/platform/default/dso_loader.cc:64] Could not load dynamic library 'libcudart.so.11.0'; dlerror: libcudart.so.11.0: cannot open shared object file: No such file or directory; LD_LIBRARY_PATH: /home/sgrafbe/mlwhatif/venv/lib/python3.9/site-packages/cv2/../../lib64:
2022-09-22 05:41:58.645414: I tensorflow/stream_executor/cuda/cudart_stub.cc:29] Ignore above cudart dlerror if you do not have a GPU set up on your machine.
2022-09-22 05:41:59 INFO  Patching sys.argv with ['mlwhatif', 'reviews', 'fast_loading', 'featurization_4', 'neural_network']
2022-09-22 05:41:59 INFO  Running instrumented original pipeline...
2022-09-22 05:41:59 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-22 05:42:00 INFO  ---RUNTIME: Importing and monkey-patching took 121.06204032897949 ms
2022-09-22 05:42:12.429341: W tensorflow/stream_executor/platform/default/dso_loader.cc:64] Could not load dynamic library 'libcuda.so.1'; dlerror: libcuda.so.1: cannot open shared object file: No such file or directory; LD_LIBRARY_PATH: /home/sgrafbe/mlwhatif/venv/lib/python3.9/site-packages/cv2/../../lib64:
2022-09-22 05:42:12.429372: W tensorflow/stream_executor/cuda/cuda_driver.cc:326] failed call to cuInit: UNKNOWN ERROR (303)
2022-09-22 05:42:12.429392: I tensorflow/stream_executor/cuda/cuda_diagnostics.cc:156] kernel driver does not appear to be running on this host (angus): /proc/driver/nvidia/version does not exist
2022-09-22 05:42:12.429956: I tensorflow/core/platform/cpu_feature_guard.cc:142] This TensorFlow binary is optimized with oneAPI Deep Neural Network Library (oneDNN) to use the following CPU instructions in performance-critical operations:  AVX2 FMA
To enable them in other operations, rebuild TensorFlow with the appropriate compiler flags.
2022-09-22 05:42:12.669106: I tensorflow/compiler/mlir/mlir_graph_optimization_pass.cc:176] None of the MLIR Optimization Passes are enabled (registered 2)
2022-09-22 05:42:12.681225: I tensorflow/core/platform/profile_utils/cpu_utils.cc:114] CPU Frequency: 2595130000 Hz
2022-09-22 05:42:16 INFO  ---RUNTIME: Original pipeline execution took 16845.325469970703 ms (excluding imports and monkey-patching)
2022-09-22 05:42:16 INFO  Starting execution of 0 what-if analyses...
2022-09-22 05:42:16 INFO  Estimated runtime of original DAG is 13524.206638336182ms
2022-09-22 05:42:16 INFO  Performing Multi-Query Optimization
2022-09-22 05:42:16 INFO  Estimated unoptimized what-if runtime is 0ms
2022-09-22 05:42:16 INFO  Estimated optimised what-if runtime is 0ms
2022-09-22 05:42:16 INFO  Estimated optimisation runtime saving is 0ms
2022-09-22 05:42:16 INFO  ---RUNTIME: Multi-Query Optimization took 0.5996227264404297 ms
2022-09-22 05:42:16 INFO  Executing generated plans
2022-09-22 05:42:16 INFO  ---RUNTIME: Execution took 0.024318695068359375 ms
2022-09-22 05:42:16 INFO  Done!
2022-09-22 05:42:16 INFO  # Optimization benchmark for data_corruption with args [['reviews', 'fast_loading', 'featurization_4', 'neural_network']] -- repetition 1 of 7
2022-09-22 05:42:16 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-22 05:42:16 INFO  Running instrumented original pipeline...
2022-09-22 05:42:16 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-22 05:42:16 INFO  ---RUNTIME: Importing and monkey-patching took 6.430149078369141 ms
2022-09-22 05:42:34 INFO  ---RUNTIME: Original pipeline execution took 17176.082372665405 ms (excluding imports and monkey-patching)
2022-09-22 05:42:34 INFO  Starting execution of 1 what-if analyses...
2022-09-22 05:42:34 INFO  Start plan generation for analysis DataCorruption...
2022-09-22 05:42:34 INFO  ---RUNTIME: Plan generation took 0.4582405090332031 ms
2022-09-22 05:42:34 INFO  Estimated runtime of original DAG is 13557.411670684814ms
2022-09-22 05:42:34 INFO  Performing Multi-Query Optimization
2022-09-22 05:42:34 INFO  Estimated unoptimized what-if runtime is 338935.29176712036ms
2022-09-22 05:42:34 INFO  Estimated optimised what-if runtime is 25098.8929271698ms
2022-09-22 05:42:34 INFO  Estimated optimisation runtime saving is 313836.39883995056ms
2022-09-22 05:42:34 INFO  ---RUNTIME: Multi-Query Optimization took 70.16277313232422 ms
2022-09-22 05:42:34 INFO  Executing generated plans
2022-09-22 05:43:03 INFO  ---RUNTIME: Execution took 28938.804149627686 ms
2022-09-22 05:43:03 INFO  Done!
2022-09-22 05:43:03 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-22 05:43:03 INFO  Running instrumented original pipeline...
2022-09-22 05:43:03 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-22 05:43:03 INFO  ---RUNTIME: Importing and monkey-patching took 5.780696868896484 ms
2022-09-22 05:43:20 INFO  ---RUNTIME: Original pipeline execution took 16948.635578155518 ms (excluding imports and monkey-patching)
2022-09-22 05:43:20 INFO  Starting execution of 1 what-if analyses...
2022-09-22 05:43:20 INFO  Start plan generation for analysis DataCorruption...
2022-09-22 05:43:20 INFO  ---RUNTIME: Plan generation took 0.40435791015625 ms
2022-09-22 05:43:20 INFO  Estimated runtime of original DAG is 13397.660970687866ms
2022-09-22 05:43:20 WARNING Skipping Multi-Query Optimization (instead, only applying patches)
2022-09-22 05:43:20 INFO  Estimated unoptimised what-if runtime is 334941.52426719666ms
2022-09-22 05:43:20 INFO  ---RUNTIME: Multi-Query Optimization took 20.438432693481445 ms
2022-09-22 05:43:20 INFO  Executing generated plans
2022-09-22 05:50:35 INFO  ---RUNTIME: Execution took 435663.348197937 ms
2022-09-22 05:50:35 INFO  Done!
2022-09-22 05:50:35 INFO  # Finished -- repetition 1 of 7 
2022-09-22 05:50:35 INFO  # Optimization benchmark for data_corruption with args [['reviews', 'fast_loading', 'featurization_4', 'neural_network']] -- repetition 2 of 7
2022-09-22 05:50:35 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-22 05:50:35 INFO  Running instrumented original pipeline...
2022-09-22 05:50:35 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-22 05:50:35 INFO  ---RUNTIME: Importing and monkey-patching took 9.78994369506836 ms
2022-09-22 05:50:59 INFO  ---RUNTIME: Original pipeline execution took 23984.72499847412 ms (excluding imports and monkey-patching)
2022-09-22 05:50:59 INFO  Starting execution of 1 what-if analyses...
2022-09-22 05:50:59 INFO  Start plan generation for analysis DataCorruption...
2022-09-22 05:50:59 INFO  ---RUNTIME: Plan generation took 0.5071163177490234 ms
2022-09-22 05:50:59 INFO  Estimated runtime of original DAG is 18814.521551132202ms
2022-09-22 05:50:59 INFO  Performing Multi-Query Optimization
2022-09-22 05:50:59 INFO  Estimated unoptimized what-if runtime is 470363.03877830505ms
2022-09-22 05:50:59 INFO  Estimated optimised what-if runtime is 34142.87781715393ms
2022-09-22 05:50:59 INFO  Estimated optimisation runtime saving is 436220.1609611511ms
2022-09-22 05:50:59 INFO  ---RUNTIME: Multi-Query Optimization took 119.16375160217285 ms
2022-09-22 05:50:59 INFO  Executing generated plans
2022-09-22 05:51:33 INFO  ---RUNTIME: Execution took 33377.0797252655 ms
2022-09-22 05:51:33 INFO  Done!
2022-09-22 05:51:33 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-22 05:51:33 INFO  Running instrumented original pipeline...
2022-09-22 05:51:33 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-22 05:51:33 INFO  ---RUNTIME: Importing and monkey-patching took 5.895137786865234 ms
2022-09-22 05:51:53 INFO  ---RUNTIME: Original pipeline execution took 20597.50270843506 ms (excluding imports and monkey-patching)
2022-09-22 05:51:53 INFO  Starting execution of 1 what-if analyses...
2022-09-22 05:51:53 INFO  Start plan generation for analysis DataCorruption...
2022-09-22 05:51:53 INFO  ---RUNTIME: Plan generation took 0.3612041473388672 ms
2022-09-22 05:51:53 INFO  Estimated runtime of original DAG is 16170.006513595581ms
2022-09-22 05:51:53 WARNING Skipping Multi-Query Optimization (instead, only applying patches)
2022-09-22 05:51:53 INFO  Estimated unoptimised what-if runtime is 404250.1628398895ms
2022-09-22 05:51:53 INFO  ---RUNTIME: Multi-Query Optimization took 20.841360092163086 ms
2022-09-22 05:51:53 INFO  Executing generated plans
2022-09-22 05:58:25 INFO  ---RUNTIME: Execution took 391290.9061908722 ms
2022-09-22 05:58:25 INFO  Done!
2022-09-22 05:58:25 INFO  # Finished -- repetition 2 of 7 
2022-09-22 05:58:25 INFO  # Optimization benchmark for data_corruption with args [['reviews', 'fast_loading', 'featurization_4', 'neural_network']] -- repetition 3 of 7
2022-09-22 05:58:25 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-22 05:58:25 INFO  Running instrumented original pipeline...
2022-09-22 05:58:25 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-22 05:58:25 INFO  ---RUNTIME: Importing and monkey-patching took 5.881786346435547 ms
2022-09-22 05:58:45 INFO  ---RUNTIME: Original pipeline execution took 20442.365169525146 ms (excluding imports and monkey-patching)
2022-09-22 05:58:45 INFO  Starting execution of 1 what-if analyses...
2022-09-22 05:58:45 INFO  Start plan generation for analysis DataCorruption...
2022-09-22 05:58:45 INFO  ---RUNTIME: Plan generation took 2.154111862182617 ms
2022-09-22 05:58:45 INFO  Estimated runtime of original DAG is 16308.937072753906ms
2022-09-22 05:58:45 INFO  Performing Multi-Query Optimization
2022-09-22 05:58:45 INFO  Estimated unoptimized what-if runtime is 407723.42681884766ms
2022-09-22 05:58:45 INFO  Estimated optimised what-if runtime is 26849.11298751831ms
2022-09-22 05:58:45 INFO  Estimated optimisation runtime saving is 380874.31383132935ms
2022-09-22 05:58:45 INFO  ---RUNTIME: Multi-Query Optimization took 68.39728355407715 ms
2022-09-22 05:58:45 INFO  Executing generated plans
2022-09-22 05:59:16 INFO  ---RUNTIME: Execution took 31194.04435157776 ms
2022-09-22 05:59:16 INFO  Done!
2022-09-22 05:59:16 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-22 05:59:16 INFO  Running instrumented original pipeline...
2022-09-22 05:59:17 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-22 05:59:17 INFO  ---RUNTIME: Importing and monkey-patching took 11.674165725708008 ms
2022-09-22 05:59:34 INFO  ---RUNTIME: Original pipeline execution took 17813.241243362427 ms (excluding imports and monkey-patching)
2022-09-22 05:59:34 INFO  Starting execution of 1 what-if analyses...
2022-09-22 05:59:34 INFO  Start plan generation for analysis DataCorruption...
2022-09-22 05:59:34 INFO  ---RUNTIME: Plan generation took 0.3752708435058594 ms
2022-09-22 05:59:34 INFO  Estimated runtime of original DAG is 13922.135353088379ms
2022-09-22 05:59:34 WARNING Skipping Multi-Query Optimization (instead, only applying patches)
2022-09-22 05:59:34 INFO  Estimated unoptimised what-if runtime is 348053.3838272095ms
2022-09-22 05:59:34 INFO  ---RUNTIME: Multi-Query Optimization took 19.771575927734375 ms
2022-09-22 05:59:34 INFO  Executing generated plans
2022-09-22 06:06:16 INFO  ---RUNTIME: Execution took 401974.14350509644 ms
2022-09-22 06:06:16 INFO  Done!
2022-09-22 06:06:16 INFO  # Finished -- repetition 3 of 7 
2022-09-22 06:06:16 INFO  # Optimization benchmark for data_corruption with args [['reviews', 'fast_loading', 'featurization_4', 'neural_network']] -- repetition 4 of 7
2022-09-22 06:06:16 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-22 06:06:16 INFO  Running instrumented original pipeline...
2022-09-22 06:06:16 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-22 06:06:16 INFO  ---RUNTIME: Importing and monkey-patching took 5.729436874389648 ms
2022-09-22 06:06:33 INFO  ---RUNTIME: Original pipeline execution took 16497.578620910645 ms (excluding imports and monkey-patching)
2022-09-22 06:06:33 INFO  Starting execution of 1 what-if analyses...
2022-09-22 06:06:33 INFO  Start plan generation for analysis DataCorruption...
2022-09-22 06:06:33 INFO  ---RUNTIME: Plan generation took 0.43654441833496094 ms
2022-09-22 06:06:33 INFO  Estimated runtime of original DAG is 12970.587730407715ms
2022-09-22 06:06:33 INFO  Performing Multi-Query Optimization
2022-09-22 06:06:33 INFO  Estimated unoptimized what-if runtime is 324264.6932601929ms
2022-09-22 06:06:33 INFO  Estimated optimised what-if runtime is 23483.951568603516ms
2022-09-22 06:06:33 INFO  Estimated optimisation runtime saving is 300780.74169158936ms
2022-09-22 06:06:33 INFO  ---RUNTIME: Multi-Query Optimization took 71.2740421295166 ms
2022-09-22 06:06:33 INFO  Executing generated plans
2022-09-22 06:07:05 INFO  ---RUNTIME: Execution took 31868.928909301758 ms
2022-09-22 06:07:05 INFO  Done!
2022-09-22 06:07:05 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-22 06:07:05 INFO  Running instrumented original pipeline...
2022-09-22 06:07:05 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-22 06:07:05 INFO  ---RUNTIME: Importing and monkey-patching took 6.049156188964844 ms
2022-09-22 06:07:26 INFO  ---RUNTIME: Original pipeline execution took 20824.449062347412 ms (excluding imports and monkey-patching)
2022-09-22 06:07:26 INFO  Starting execution of 1 what-if analyses...
2022-09-22 06:07:26 INFO  Start plan generation for analysis DataCorruption...
2022-09-22 06:07:26 INFO  ---RUNTIME: Plan generation took 0.5064010620117188 ms
2022-09-22 06:07:26 INFO  Estimated runtime of original DAG is 15679.869890213013ms
2022-09-22 06:07:26 WARNING Skipping Multi-Query Optimization (instead, only applying patches)
2022-09-22 06:07:26 INFO  Estimated unoptimised what-if runtime is 391996.7472553253ms
2022-09-22 06:07:26 INFO  ---RUNTIME: Multi-Query Optimization took 28.10382843017578 ms
2022-09-22 06:07:26 INFO  Executing generated plans
2022-09-22 06:14:57 INFO  ---RUNTIME: Execution took 451962.3558521271 ms
2022-09-22 06:14:57 INFO  Done!
2022-09-22 06:14:58 INFO  # Finished -- repetition 4 of 7 
2022-09-22 06:14:58 INFO  # Optimization benchmark for data_corruption with args [['reviews', 'fast_loading', 'featurization_4', 'neural_network']] -- repetition 5 of 7
2022-09-22 06:14:58 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-22 06:14:58 INFO  Running instrumented original pipeline...
2022-09-22 06:14:58 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-22 06:14:58 INFO  ---RUNTIME: Importing and monkey-patching took 9.458303451538086 ms
2022-09-22 06:15:24 INFO  ---RUNTIME: Original pipeline execution took 26675.280809402466 ms (excluding imports and monkey-patching)
2022-09-22 06:15:24 INFO  Starting execution of 1 what-if analyses...
2022-09-22 06:15:24 INFO  Start plan generation for analysis DataCorruption...
2022-09-22 06:15:24 INFO  ---RUNTIME: Plan generation took 2.545595169067383 ms
2022-09-22 06:15:24 INFO  Estimated runtime of original DAG is 21810.535669326782ms
2022-09-22 06:15:24 INFO  Performing Multi-Query Optimization
2022-09-22 06:15:24 INFO  Estimated unoptimized what-if runtime is 545263.3917331696ms
2022-09-22 06:15:24 INFO  Estimated optimised what-if runtime is 38764.0540599823ms
2022-09-22 06:15:24 INFO  Estimated optimisation runtime saving is 506499.33767318726ms
2022-09-22 06:15:24 INFO  ---RUNTIME: Multi-Query Optimization took 136.4157199859619 ms
2022-09-22 06:15:24 INFO  Executing generated plans
2022-09-22 06:16:00 INFO  ---RUNTIME: Execution took 36108.11257362366 ms
2022-09-22 06:16:00 INFO  Done!
2022-09-22 06:16:00 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-22 06:16:00 INFO  Running instrumented original pipeline...
2022-09-22 06:16:00 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-22 06:16:01 INFO  ---RUNTIME: Importing and monkey-patching took 5.858898162841797 ms
2022-09-22 06:16:21 INFO  ---RUNTIME: Original pipeline execution took 20357.85460472107 ms (excluding imports and monkey-patching)
2022-09-22 06:16:21 INFO  Starting execution of 1 what-if analyses...
2022-09-22 06:16:21 INFO  Start plan generation for analysis DataCorruption...
2022-09-22 06:16:21 INFO  ---RUNTIME: Plan generation took 0.41174888610839844 ms
2022-09-22 06:16:21 INFO  Estimated runtime of original DAG is 15842.923879623413ms
2022-09-22 06:16:21 WARNING Skipping Multi-Query Optimization (instead, only applying patches)
2022-09-22 06:16:21 INFO  Estimated unoptimised what-if runtime is 396073.0969905853ms
2022-09-22 06:16:21 INFO  ---RUNTIME: Multi-Query Optimization took 20.238637924194336 ms
2022-09-22 06:16:21 INFO  Executing generated plans
2022-09-22 06:23:05 INFO  ---RUNTIME: Execution took 404286.17119789124 ms
2022-09-22 06:23:05 INFO  Done!
2022-09-22 06:23:05 INFO  # Finished -- repetition 5 of 7 
2022-09-22 06:23:05 INFO  # Optimization benchmark for data_corruption with args [['reviews', 'fast_loading', 'featurization_4', 'neural_network']] -- repetition 6 of 7
2022-09-22 06:23:05 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-22 06:23:05 INFO  Running instrumented original pipeline...
2022-09-22 06:23:06 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-22 06:23:06 INFO  ---RUNTIME: Importing and monkey-patching took 6.2770843505859375 ms
2022-09-22 06:23:22 INFO  ---RUNTIME: Original pipeline execution took 16814.807653427124 ms (excluding imports and monkey-patching)
2022-09-22 06:23:22 INFO  Starting execution of 1 what-if analyses...
2022-09-22 06:23:22 INFO  Start plan generation for analysis DataCorruption...
2022-09-22 06:23:22 INFO  ---RUNTIME: Plan generation took 0.4336833953857422 ms
2022-09-22 06:23:22 INFO  Estimated runtime of original DAG is 13084.357500076294ms
2022-09-22 06:23:22 INFO  Performing Multi-Query Optimization
2022-09-22 06:23:22 INFO  Estimated unoptimized what-if runtime is 327108.93750190735ms
2022-09-22 06:23:22 INFO  Estimated optimised what-if runtime is 23642.001152038574ms
2022-09-22 06:23:22 INFO  Estimated optimisation runtime saving is 303466.9363498688ms
2022-09-22 06:23:22 INFO  ---RUNTIME: Multi-Query Optimization took 68.91083717346191 ms
2022-09-22 06:23:22 INFO  Executing generated plans
2022-09-22 06:23:56 INFO  ---RUNTIME: Execution took 34114.89391326904 ms
2022-09-22 06:23:56 INFO  Done!
2022-09-22 06:23:56 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-22 06:23:56 INFO  Running instrumented original pipeline...
2022-09-22 06:23:56 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-22 06:23:56 INFO  ---RUNTIME: Importing and monkey-patching took 6.197214126586914 ms
2022-09-22 06:24:12 INFO  ---RUNTIME: Original pipeline execution took 16104.53176498413 ms (excluding imports and monkey-patching)
2022-09-22 06:24:12 INFO  Starting execution of 1 what-if analyses...
2022-09-22 06:24:12 INFO  Start plan generation for analysis DataCorruption...
2022-09-22 06:24:12 INFO  ---RUNTIME: Plan generation took 0.4076957702636719 ms
2022-09-22 06:24:12 INFO  Estimated runtime of original DAG is 12868.760108947754ms
2022-09-22 06:24:12 WARNING Skipping Multi-Query Optimization (instead, only applying patches)
2022-09-22 06:24:12 INFO  Estimated unoptimised what-if runtime is 321719.00272369385ms
2022-09-22 06:24:12 INFO  ---RUNTIME: Multi-Query Optimization took 19.483089447021484 ms
2022-09-22 06:24:12 INFO  Executing generated plans
2022-09-22 06:31:06 INFO  ---RUNTIME: Execution took 413969.9544906616 ms
2022-09-22 06:31:06 INFO  Done!
2022-09-22 06:31:06 INFO  # Finished -- repetition 6 of 7 
2022-09-22 06:31:06 INFO  # Optimization benchmark for data_corruption with args [['reviews', 'fast_loading', 'featurization_4', 'neural_network']] -- repetition 7 of 7
2022-09-22 06:31:06 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-22 06:31:06 INFO  Running instrumented original pipeline...
2022-09-22 06:31:06 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-22 06:31:06 INFO  ---RUNTIME: Importing and monkey-patching took 8.468151092529297 ms
2022-09-22 06:31:28 INFO  ---RUNTIME: Original pipeline execution took 22013.05651664734 ms (excluding imports and monkey-patching)
2022-09-22 06:31:28 INFO  Starting execution of 1 what-if analyses...
2022-09-22 06:31:28 INFO  Start plan generation for analysis DataCorruption...
2022-09-22 06:31:28 INFO  ---RUNTIME: Plan generation took 0.408172607421875 ms
2022-09-22 06:31:28 INFO  Estimated runtime of original DAG is 18055.25231361389ms
2022-09-22 06:31:28 INFO  Performing Multi-Query Optimization
2022-09-22 06:31:28 INFO  Estimated unoptimized what-if runtime is 451381.3078403473ms
2022-09-22 06:31:28 INFO  Estimated optimised what-if runtime is 28444.628953933716ms
2022-09-22 06:31:28 INFO  Estimated optimisation runtime saving is 422936.6788864136ms
2022-09-22 06:31:28 INFO  ---RUNTIME: Multi-Query Optimization took 69.17762756347656 ms
2022-09-22 06:31:28 INFO  Executing generated plans
2022-09-22 06:31:57 INFO  ---RUNTIME: Execution took 28649.27387237549 ms
2022-09-22 06:31:57 INFO  Done!
2022-09-22 06:31:57 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-22 06:31:57 INFO  Running instrumented original pipeline...
2022-09-22 06:31:57 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-22 06:31:57 INFO  ---RUNTIME: Importing and monkey-patching took 29.178142547607422 ms
2022-09-22 06:32:20 INFO  ---RUNTIME: Original pipeline execution took 22877.14457511902 ms (excluding imports and monkey-patching)
2022-09-22 06:32:20 INFO  Starting execution of 1 what-if analyses...
2022-09-22 06:32:20 INFO  Start plan generation for analysis DataCorruption...
2022-09-22 06:32:20 INFO  ---RUNTIME: Plan generation took 0.4329681396484375 ms
2022-09-22 06:32:20 INFO  Estimated runtime of original DAG is 18647.112369537354ms
2022-09-22 06:32:20 WARNING Skipping Multi-Query Optimization (instead, only applying patches)
2022-09-22 06:32:20 INFO  Estimated unoptimised what-if runtime is 466177.80923843384ms
2022-09-22 06:32:20 INFO  ---RUNTIME: Multi-Query Optimization took 20.123720169067383 ms
2022-09-22 06:32:20 INFO  Executing generated plans
2022-09-22 06:39:25 INFO  ---RUNTIME: Execution took 425335.866689682 ms
2022-09-22 06:39:25 INFO  Done!
2022-09-22 06:39:25 INFO  # Finished -- repetition 7 of 7 
2022-09-22 06:39:25 INFO  # Final results after all repetitions
2022-09-22 06:39:25 INFO     repetition  ... no_opt_what_if_execution_combined_model_training
0           0  ...                                    101041.410685
1           1  ...                                     91105.622053
2           2  ...                                     90945.490122
3           3  ...                                    104623.178244
4           4  ...                                     94098.757982
5           5  ...                                     99581.654549
6           6  ...                                     97592.530966

[7 rows x 26 columns]
