Variant name from 1-8: 8
Cores to use: 0-7
taskset -c 0-7 PROTOCOL_BUFFERS_PYTHON_IMPLEMENTATION=python python3.9 benchmarks_end_to_end.py data_corruption healthcare slow_loading featurization_0 logistic_regression
2022-09-21 14:33:22.513400: W tensorflow/stream_executor/platform/default/dso_loader.cc:64] Could not load dynamic library 'libcudart.so.11.0'; dlerror: libcudart.so.11.0: cannot open shared object file: No such file or directory; LD_LIBRARY_PATH: /home/sgrafbe/mlwhatif/venv/lib/python3.9/site-packages/cv2/../../lib64:
2022-09-21 14:33:22.513441: I tensorflow/stream_executor/cuda/cudart_stub.cc:29] Ignore above cudart dlerror if you do not have a GPU set up on your machine.
2022-09-21 14:33:23 INFO  Patching sys.argv with ['mlwhatif', 'healthcare', 'slow_loading', 'featurization_0', 'logistic_regression']
2022-09-21 14:33:23 INFO  Running instrumented original pipeline...
2022-09-21 14:33:23 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-21 14:33:23 INFO  ---RUNTIME: Importing and monkey-patching took 95.77298164367676 ms
2022-09-21 14:33:26 INFO  ---RUNTIME: Original pipeline execution took 2383.87393951416 ms (excluding imports and monkey-patching)
2022-09-21 14:33:26 INFO  Starting execution of 0 what-if analyses...
2022-09-21 14:33:26 INFO  Estimated runtime of original DAG is 2116.162061691284ms
2022-09-21 14:33:26 INFO  Performing Multi-Query Optimization
2022-09-21 14:33:26 INFO  Estimated unoptimized what-if runtime is 0ms
2022-09-21 14:33:26 INFO  Estimated optimised what-if runtime is 0ms
2022-09-21 14:33:26 INFO  Estimated optimisation runtime saving is 0ms
2022-09-21 14:33:26 INFO  ---RUNTIME: Multi-Query Optimization took 0.4324913024902344 ms
2022-09-21 14:33:26 INFO  Executing generated plans
2022-09-21 14:33:26 INFO  ---RUNTIME: Execution took 0.019788742065429688 ms
2022-09-21 14:33:26 INFO  Done!
2022-09-21 14:33:26 INFO  # Optimization benchmark for data_corruption with args [['healthcare', 'slow_loading', 'featurization_0', 'logistic_regression']] -- repetition 1 of 7
2022-09-21 14:33:26 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-21 14:33:26 INFO  Running instrumented original pipeline...
2022-09-21 14:33:26 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-21 14:33:26 INFO  ---RUNTIME: Importing and monkey-patching took 5.141973495483398 ms
2022-09-21 14:33:28 INFO  ---RUNTIME: Original pipeline execution took 1950.4098892211914 ms (excluding imports and monkey-patching)
2022-09-21 14:33:28 INFO  Starting execution of 1 what-if analyses...
2022-09-21 14:33:28 INFO  Start plan generation for analysis DataCorruption...
2022-09-21 14:33:28 INFO  ---RUNTIME: Plan generation took 0.41794776916503906 ms
2022-09-21 14:33:28 INFO  Estimated runtime of original DAG is 1717.909574508667ms
2022-09-21 14:33:28 INFO  Performing Multi-Query Optimization
2022-09-21 14:33:28 INFO  Estimated unoptimized what-if runtime is 51537.28723526001ms
2022-09-21 14:33:28 INFO  Estimated optimised what-if runtime is 1733.2160472869873ms
2022-09-21 14:33:28 INFO  Estimated optimisation runtime saving is 49804.07118797302ms
2022-09-21 14:33:28 INFO  ---RUNTIME: Multi-Query Optimization took 71.50697708129883 ms
2022-09-21 14:33:28 INFO  Executing generated plans
2022-09-21 14:33:30 INFO  ---RUNTIME: Execution took 1859.4436645507812 ms
2022-09-21 14:33:30 INFO  Done!
2022-09-21 14:33:30 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-21 14:33:30 INFO  Running instrumented original pipeline...
2022-09-21 14:33:30 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-21 14:33:30 INFO  ---RUNTIME: Importing and monkey-patching took 5.719900131225586 ms
2022-09-21 14:33:32 INFO  ---RUNTIME: Original pipeline execution took 2130.3086280822754 ms (excluding imports and monkey-patching)
2022-09-21 14:33:32 INFO  Starting execution of 1 what-if analyses...
2022-09-21 14:33:32 INFO  Start plan generation for analysis DataCorruption...
2022-09-21 14:33:32 INFO  ---RUNTIME: Plan generation took 0.45228004455566406 ms
2022-09-21 14:33:32 INFO  Estimated runtime of original DAG is 1741.0883903503418ms
2022-09-21 14:33:32 WARNING Skipping Multi-Query Optimization (instead, only applying patches)
2022-09-21 14:33:32 INFO  Estimated unoptimised what-if runtime is 52232.651710510254ms
2022-09-21 14:33:32 INFO  ---RUNTIME: Multi-Query Optimization took 19.548416137695312 ms
2022-09-21 14:33:32 INFO  Executing generated plans
2022-09-21 14:34:24 INFO  ---RUNTIME: Execution took 52123.76642227173 ms
2022-09-21 14:34:24 INFO  Done!
2022-09-21 14:34:24 INFO  # Finished -- repetition 1 of 7 
2022-09-21 14:34:24 INFO  # Optimization benchmark for data_corruption with args [['healthcare', 'slow_loading', 'featurization_0', 'logistic_regression']] -- repetition 2 of 7
2022-09-21 14:34:24 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-21 14:34:24 INFO  Running instrumented original pipeline...
2022-09-21 14:34:24 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-21 14:34:24 INFO  ---RUNTIME: Importing and monkey-patching took 6.011724472045898 ms
2022-09-21 14:34:26 INFO  ---RUNTIME: Original pipeline execution took 1945.4944133758545 ms (excluding imports and monkey-patching)
2022-09-21 14:34:26 INFO  Starting execution of 1 what-if analyses...
2022-09-21 14:34:26 INFO  Start plan generation for analysis DataCorruption...
2022-09-21 14:34:26 INFO  ---RUNTIME: Plan generation took 0.4050731658935547 ms
2022-09-21 14:34:26 INFO  Estimated runtime of original DAG is 1711.7154598236084ms
2022-09-21 14:34:26 INFO  Performing Multi-Query Optimization
2022-09-21 14:34:26 INFO  Estimated unoptimized what-if runtime is 51351.46379470825ms
2022-09-21 14:34:26 INFO  Estimated optimised what-if runtime is 1726.9060611724854ms
2022-09-21 14:34:26 INFO  Estimated optimisation runtime saving is 49624.55773353577ms
2022-09-21 14:34:26 INFO  ---RUNTIME: Multi-Query Optimization took 70.99604606628418 ms
2022-09-21 14:34:26 INFO  Executing generated plans
2022-09-21 14:34:28 INFO  ---RUNTIME: Execution took 1779.803991317749 ms
2022-09-21 14:34:28 INFO  Done!
2022-09-21 14:34:28 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-21 14:34:28 INFO  Running instrumented original pipeline...
2022-09-21 14:34:28 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-21 14:34:28 INFO  ---RUNTIME: Importing and monkey-patching took 5.684852600097656 ms
2022-09-21 14:34:30 INFO  ---RUNTIME: Original pipeline execution took 2113.4252548217773 ms (excluding imports and monkey-patching)
2022-09-21 14:34:30 INFO  Starting execution of 1 what-if analyses...
2022-09-21 14:34:30 INFO  Start plan generation for analysis DataCorruption...
2022-09-21 14:34:30 INFO  ---RUNTIME: Plan generation took 0.40602684020996094 ms
2022-09-21 14:34:30 INFO  Estimated runtime of original DAG is 1720.7326889038086ms
2022-09-21 14:34:30 WARNING Skipping Multi-Query Optimization (instead, only applying patches)
2022-09-21 14:34:30 INFO  Estimated unoptimised what-if runtime is 51621.98066711426ms
2022-09-21 14:34:30 INFO  ---RUNTIME: Multi-Query Optimization took 19.46425437927246 ms
2022-09-21 14:34:30 INFO  Executing generated plans
2022-09-21 14:35:22 INFO  ---RUNTIME: Execution took 52381.5221786499 ms
2022-09-21 14:35:22 INFO  Done!
2022-09-21 14:35:22 INFO  # Finished -- repetition 2 of 7 
2022-09-21 14:35:22 INFO  # Optimization benchmark for data_corruption with args [['healthcare', 'slow_loading', 'featurization_0', 'logistic_regression']] -- repetition 3 of 7
2022-09-21 14:35:22 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-21 14:35:22 INFO  Running instrumented original pipeline...
2022-09-21 14:35:22 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-21 14:35:22 INFO  ---RUNTIME: Importing and monkey-patching took 5.957365036010742 ms
2022-09-21 14:35:24 INFO  ---RUNTIME: Original pipeline execution took 1942.4879550933838 ms (excluding imports and monkey-patching)
2022-09-21 14:35:24 INFO  Starting execution of 1 what-if analyses...
2022-09-21 14:35:24 INFO  Start plan generation for analysis DataCorruption...
2022-09-21 14:35:24 INFO  ---RUNTIME: Plan generation took 0.4127025604248047 ms
2022-09-21 14:35:24 INFO  Estimated runtime of original DAG is 1709.9204063415527ms
2022-09-21 14:35:24 INFO  Performing Multi-Query Optimization
2022-09-21 14:35:24 INFO  Estimated unoptimized what-if runtime is 51297.61219024658ms
2022-09-21 14:35:24 INFO  Estimated optimised what-if runtime is 1725.281000137329ms
2022-09-21 14:35:24 INFO  Estimated optimisation runtime saving is 49572.33119010925ms
2022-09-21 14:35:24 INFO  ---RUNTIME: Multi-Query Optimization took 69.85950469970703 ms
2022-09-21 14:35:24 INFO  Executing generated plans
2022-09-21 14:35:26 INFO  ---RUNTIME: Execution took 1835.6587886810303 ms
2022-09-21 14:35:26 INFO  Done!
2022-09-21 14:35:26 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-21 14:35:26 INFO  Running instrumented original pipeline...
2022-09-21 14:35:26 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-21 14:35:26 INFO  ---RUNTIME: Importing and monkey-patching took 5.556583404541016 ms
2022-09-21 14:35:28 INFO  ---RUNTIME: Original pipeline execution took 1921.9985008239746 ms (excluding imports and monkey-patching)
2022-09-21 14:35:28 INFO  Starting execution of 1 what-if analyses...
2022-09-21 14:35:28 INFO  Start plan generation for analysis DataCorruption...
2022-09-21 14:35:28 INFO  ---RUNTIME: Plan generation took 0.4100799560546875 ms
2022-09-21 14:35:28 INFO  Estimated runtime of original DAG is 1686.849594116211ms
2022-09-21 14:35:28 WARNING Skipping Multi-Query Optimization (instead, only applying patches)
2022-09-21 14:35:28 INFO  Estimated unoptimised what-if runtime is 50605.48782348633ms
2022-09-21 14:35:28 INFO  ---RUNTIME: Multi-Query Optimization took 19.26732063293457 ms
2022-09-21 14:35:28 INFO  Executing generated plans
2022-09-21 14:36:20 INFO  ---RUNTIME: Execution took 52433.45093727112 ms
2022-09-21 14:36:20 INFO  Done!
2022-09-21 14:36:20 INFO  # Finished -- repetition 3 of 7 
2022-09-21 14:36:20 INFO  # Optimization benchmark for data_corruption with args [['healthcare', 'slow_loading', 'featurization_0', 'logistic_regression']] -- repetition 4 of 7
2022-09-21 14:36:20 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-21 14:36:20 INFO  Running instrumented original pipeline...
2022-09-21 14:36:20 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-21 14:36:20 INFO  ---RUNTIME: Importing and monkey-patching took 5.773782730102539 ms
2022-09-21 14:36:22 INFO  ---RUNTIME: Original pipeline execution took 1944.481611251831 ms (excluding imports and monkey-patching)
2022-09-21 14:36:22 INFO  Starting execution of 1 what-if analyses...
2022-09-21 14:36:22 INFO  Start plan generation for analysis DataCorruption...
2022-09-21 14:36:22 INFO  ---RUNTIME: Plan generation took 0.4284381866455078 ms
2022-09-21 14:36:22 INFO  Estimated runtime of original DAG is 1711.1499309539795ms
2022-09-21 14:36:22 INFO  Performing Multi-Query Optimization
2022-09-21 14:36:22 INFO  Estimated unoptimized what-if runtime is 51334.497928619385ms
2022-09-21 14:36:22 INFO  Estimated optimised what-if runtime is 1726.8037796020508ms
2022-09-21 14:36:22 INFO  Estimated optimisation runtime saving is 49607.694149017334ms
2022-09-21 14:36:22 INFO  ---RUNTIME: Multi-Query Optimization took 70.69063186645508 ms
2022-09-21 14:36:22 INFO  Executing generated plans
2022-09-21 14:36:24 INFO  ---RUNTIME: Execution took 1849.9901294708252 ms
2022-09-21 14:36:24 INFO  Done!
2022-09-21 14:36:24 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-21 14:36:24 INFO  Running instrumented original pipeline...
2022-09-21 14:36:24 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-21 14:36:24 INFO  ---RUNTIME: Importing and monkey-patching took 5.632877349853516 ms
2022-09-21 14:36:26 INFO  ---RUNTIME: Original pipeline execution took 1943.7570571899414 ms (excluding imports and monkey-patching)
2022-09-21 14:36:26 INFO  Starting execution of 1 what-if analyses...
2022-09-21 14:36:26 INFO  Start plan generation for analysis DataCorruption...
2022-09-21 14:36:26 INFO  ---RUNTIME: Plan generation took 0.4112720489501953 ms
2022-09-21 14:36:26 INFO  Estimated runtime of original DAG is 1713.193416595459ms
2022-09-21 14:36:26 WARNING Skipping Multi-Query Optimization (instead, only applying patches)
2022-09-21 14:36:26 INFO  Estimated unoptimised what-if runtime is 51395.80249786377ms
2022-09-21 14:36:26 INFO  ---RUNTIME: Multi-Query Optimization took 19.259929656982422 ms
2022-09-21 14:36:26 INFO  Executing generated plans
2022-09-21 14:37:19 INFO  ---RUNTIME: Execution took 52790.539503097534 ms
2022-09-21 14:37:19 INFO  Done!
2022-09-21 14:37:19 INFO  # Finished -- repetition 4 of 7 
2022-09-21 14:37:19 INFO  # Optimization benchmark for data_corruption with args [['healthcare', 'slow_loading', 'featurization_0', 'logistic_regression']] -- repetition 5 of 7
2022-09-21 14:37:19 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-21 14:37:19 INFO  Running instrumented original pipeline...
2022-09-21 14:37:19 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-21 14:37:19 INFO  ---RUNTIME: Importing and monkey-patching took 6.011009216308594 ms
2022-09-21 14:37:21 INFO  ---RUNTIME: Original pipeline execution took 1946.1359977722168 ms (excluding imports and monkey-patching)
2022-09-21 14:37:21 INFO  Starting execution of 1 what-if analyses...
2022-09-21 14:37:21 INFO  Start plan generation for analysis DataCorruption...
2022-09-21 14:37:21 INFO  ---RUNTIME: Plan generation took 0.4177093505859375 ms
2022-09-21 14:37:21 INFO  Estimated runtime of original DAG is 1712.0623588562012ms
2022-09-21 14:37:21 INFO  Performing Multi-Query Optimization
2022-09-21 14:37:21 INFO  Estimated unoptimized what-if runtime is 51361.870765686035ms
2022-09-21 14:37:21 INFO  Estimated optimised what-if runtime is 1727.4131774902344ms
2022-09-21 14:37:21 INFO  Estimated optimisation runtime saving is 49634.4575881958ms
2022-09-21 14:37:21 INFO  ---RUNTIME: Multi-Query Optimization took 70.62387466430664 ms
2022-09-21 14:37:21 INFO  Executing generated plans
2022-09-21 14:37:23 INFO  ---RUNTIME: Execution took 1803.0993938446045 ms
2022-09-21 14:37:23 INFO  Done!
2022-09-21 14:37:23 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-21 14:37:23 INFO  Running instrumented original pipeline...
2022-09-21 14:37:23 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-21 14:37:23 INFO  ---RUNTIME: Importing and monkey-patching took 5.810976028442383 ms
2022-09-21 14:37:25 INFO  ---RUNTIME: Original pipeline execution took 2136.399269104004 ms (excluding imports and monkey-patching)
2022-09-21 14:37:25 INFO  Starting execution of 1 what-if analyses...
2022-09-21 14:37:25 INFO  Start plan generation for analysis DataCorruption...
2022-09-21 14:37:25 INFO  ---RUNTIME: Plan generation took 0.41484832763671875 ms
2022-09-21 14:37:25 INFO  Estimated runtime of original DAG is 1710.5684280395508ms
2022-09-21 14:37:25 WARNING Skipping Multi-Query Optimization (instead, only applying patches)
2022-09-21 14:37:25 INFO  Estimated unoptimised what-if runtime is 51317.05284118652ms
2022-09-21 14:37:25 INFO  ---RUNTIME: Multi-Query Optimization took 19.552230834960938 ms
2022-09-21 14:37:25 INFO  Executing generated plans
2022-09-21 14:38:18 INFO  ---RUNTIME: Execution took 52442.60859489441 ms
2022-09-21 14:38:18 INFO  Done!
2022-09-21 14:38:18 INFO  # Finished -- repetition 5 of 7 
2022-09-21 14:38:18 INFO  # Optimization benchmark for data_corruption with args [['healthcare', 'slow_loading', 'featurization_0', 'logistic_regression']] -- repetition 6 of 7
2022-09-21 14:38:18 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-21 14:38:18 INFO  Running instrumented original pipeline...
2022-09-21 14:38:18 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-21 14:38:18 INFO  ---RUNTIME: Importing and monkey-patching took 5.717277526855469 ms
2022-09-21 14:38:19 INFO  ---RUNTIME: Original pipeline execution took 1950.7768154144287 ms (excluding imports and monkey-patching)
2022-09-21 14:38:19 INFO  Starting execution of 1 what-if analyses...
2022-09-21 14:38:19 INFO  Start plan generation for analysis DataCorruption...
2022-09-21 14:38:19 INFO  ---RUNTIME: Plan generation took 0.7841587066650391 ms
2022-09-21 14:38:19 INFO  Estimated runtime of original DAG is 1715.9969806671143ms
2022-09-21 14:38:19 INFO  Performing Multi-Query Optimization
2022-09-21 14:38:20 INFO  Estimated unoptimized what-if runtime is 51479.90942001343ms
2022-09-21 14:38:20 INFO  Estimated optimised what-if runtime is 1731.9974899291992ms
2022-09-21 14:38:20 INFO  Estimated optimisation runtime saving is 49747.91193008423ms
2022-09-21 14:38:20 INFO  ---RUNTIME: Multi-Query Optimization took 70.94216346740723 ms
2022-09-21 14:38:20 INFO  Executing generated plans
2022-09-21 14:38:21 INFO  ---RUNTIME: Execution took 1861.4420890808105 ms
2022-09-21 14:38:21 INFO  Done!
2022-09-21 14:38:21 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-21 14:38:21 INFO  Running instrumented original pipeline...
2022-09-21 14:38:21 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-21 14:38:21 INFO  ---RUNTIME: Importing and monkey-patching took 5.547046661376953 ms
2022-09-21 14:38:23 INFO  ---RUNTIME: Original pipeline execution took 1984.5643043518066 ms (excluding imports and monkey-patching)
2022-09-21 14:38:23 INFO  Starting execution of 1 what-if analyses...
2022-09-21 14:38:23 INFO  Start plan generation for analysis DataCorruption...
2022-09-21 14:38:23 INFO  ---RUNTIME: Plan generation took 0.4012584686279297 ms
2022-09-21 14:38:23 INFO  Estimated runtime of original DAG is 1751.0886192321777ms
2022-09-21 14:38:23 WARNING Skipping Multi-Query Optimization (instead, only applying patches)
2022-09-21 14:38:23 INFO  Estimated unoptimised what-if runtime is 52532.65857696533ms
2022-09-21 14:38:23 INFO  ---RUNTIME: Multi-Query Optimization took 19.33121681213379 ms
2022-09-21 14:38:23 INFO  Executing generated plans
2022-09-21 14:39:17 INFO  ---RUNTIME: Execution took 53408.03861618042 ms
2022-09-21 14:39:17 INFO  Done!
2022-09-21 14:39:17 INFO  # Finished -- repetition 6 of 7 
2022-09-21 14:39:17 INFO  # Optimization benchmark for data_corruption with args [['healthcare', 'slow_loading', 'featurization_0', 'logistic_regression']] -- repetition 7 of 7
2022-09-21 14:39:17 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-21 14:39:17 INFO  Running instrumented original pipeline...
2022-09-21 14:39:17 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-21 14:39:17 INFO  ---RUNTIME: Importing and monkey-patching took 5.484819412231445 ms
2022-09-21 14:39:19 INFO  ---RUNTIME: Original pipeline execution took 1958.5206508636475 ms (excluding imports and monkey-patching)
2022-09-21 14:39:19 INFO  Starting execution of 1 what-if analyses...
2022-09-21 14:39:19 INFO  Start plan generation for analysis DataCorruption...
2022-09-21 14:39:19 INFO  ---RUNTIME: Plan generation took 0.4184246063232422 ms
2022-09-21 14:39:19 INFO  Estimated runtime of original DAG is 1725.9185314178467ms
2022-09-21 14:39:19 INFO  Performing Multi-Query Optimization
2022-09-21 14:39:19 INFO  Estimated unoptimized what-if runtime is 51777.5559425354ms
2022-09-21 14:39:19 INFO  Estimated optimised what-if runtime is 1741.4562702178955ms
2022-09-21 14:39:19 INFO  Estimated optimisation runtime saving is 50036.099672317505ms
2022-09-21 14:39:19 INFO  ---RUNTIME: Multi-Query Optimization took 71.00749015808105 ms
2022-09-21 14:39:19 INFO  Executing generated plans
2022-09-21 14:39:21 INFO  ---RUNTIME: Execution took 1813.3504390716553 ms
2022-09-21 14:39:21 INFO  Done!
2022-09-21 14:39:21 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-21 14:39:21 INFO  Running instrumented original pipeline...
2022-09-21 14:39:21 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-21 14:39:21 INFO  ---RUNTIME: Importing and monkey-patching took 5.736589431762695 ms
2022-09-21 14:39:23 INFO  ---RUNTIME: Original pipeline execution took 1996.096134185791 ms (excluding imports and monkey-patching)
2022-09-21 14:39:23 INFO  Starting execution of 1 what-if analyses...
2022-09-21 14:39:23 INFO  Start plan generation for analysis DataCorruption...
2022-09-21 14:39:23 INFO  ---RUNTIME: Plan generation took 0.3960132598876953 ms
2022-09-21 14:39:23 INFO  Estimated runtime of original DAG is 1760.2386474609375ms
2022-09-21 14:39:23 WARNING Skipping Multi-Query Optimization (instead, only applying patches)
2022-09-21 14:39:23 INFO  Estimated unoptimised what-if runtime is 52807.159423828125ms
2022-09-21 14:39:23 INFO  ---RUNTIME: Multi-Query Optimization took 19.397258758544922 ms
2022-09-21 14:39:23 INFO  Executing generated plans
2022-09-21 14:40:15 INFO  ---RUNTIME: Execution took 52425.02284049988 ms
2022-09-21 14:40:15 INFO  Done!
2022-09-21 14:40:15 INFO  # Finished -- repetition 7 of 7 
2022-09-21 14:40:15 INFO  # Final results after all repetitions
2022-09-21 14:40:15 INFO     repetition  ... no_opt_what_if_execution_combined_model_training
0           0  ...                                        29.119968
1           1  ...                                        28.724432
2           2  ...                                        28.949261
3           3  ...                                        28.692722
4           4  ...                                        29.100180
5           5  ...                                        29.024124
6           6  ...                                        28.703928

[7 rows x 26 columns]
taskset -c 0-7 PROTOCOL_BUFFERS_PYTHON_IMPLEMENTATION=python python3.9 benchmarks_end_to_end.py data_corruption healthcare slow_loading featurization_0 xgboost
2022-09-21 14:40:17.592640: W tensorflow/stream_executor/platform/default/dso_loader.cc:64] Could not load dynamic library 'libcudart.so.11.0'; dlerror: libcudart.so.11.0: cannot open shared object file: No such file or directory; LD_LIBRARY_PATH: /home/sgrafbe/mlwhatif/venv/lib/python3.9/site-packages/cv2/../../lib64:
2022-09-21 14:40:17.592685: I tensorflow/stream_executor/cuda/cudart_stub.cc:29] Ignore above cudart dlerror if you do not have a GPU set up on your machine.
2022-09-21 14:40:18 INFO  Patching sys.argv with ['mlwhatif', 'healthcare', 'slow_loading', 'featurization_0', 'xgboost']
2022-09-21 14:40:18 INFO  Running instrumented original pipeline...
2022-09-21 14:40:18 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-21 14:40:18 INFO  ---RUNTIME: Importing and monkey-patching took 95.39961814880371 ms
2022-09-21 14:40:21 INFO  ---RUNTIME: Original pipeline execution took 2274.2648124694824 ms (excluding imports and monkey-patching)
2022-09-21 14:40:21 INFO  Starting execution of 0 what-if analyses...
2022-09-21 14:40:21 INFO  Estimated runtime of original DAG is 2014.3241882324219ms
2022-09-21 14:40:21 INFO  Performing Multi-Query Optimization
2022-09-21 14:40:21 INFO  Estimated unoptimized what-if runtime is 0ms
2022-09-21 14:40:21 INFO  Estimated optimised what-if runtime is 0ms
2022-09-21 14:40:21 INFO  Estimated optimisation runtime saving is 0ms
2022-09-21 14:40:21 INFO  ---RUNTIME: Multi-Query Optimization took 0.4343986511230469 ms
2022-09-21 14:40:21 INFO  Executing generated plans
2022-09-21 14:40:21 INFO  ---RUNTIME: Execution took 0.020503997802734375 ms
2022-09-21 14:40:21 INFO  Done!
2022-09-21 14:40:21 INFO  # Optimization benchmark for data_corruption with args [['healthcare', 'slow_loading', 'featurization_0', 'xgboost']] -- repetition 1 of 7
2022-09-21 14:40:21 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-21 14:40:21 INFO  Running instrumented original pipeline...
2022-09-21 14:40:21 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-21 14:40:21 INFO  ---RUNTIME: Importing and monkey-patching took 5.030632019042969 ms
2022-09-21 14:40:23 INFO  ---RUNTIME: Original pipeline execution took 2196.5882778167725 ms (excluding imports and monkey-patching)
2022-09-21 14:40:23 INFO  Starting execution of 1 what-if analyses...
2022-09-21 14:40:23 INFO  Start plan generation for analysis DataCorruption...
2022-09-21 14:40:23 INFO  ---RUNTIME: Plan generation took 0.44918060302734375 ms
2022-09-21 14:40:23 INFO  Estimated runtime of original DAG is 1960.6502056121826ms
2022-09-21 14:40:23 INFO  Performing Multi-Query Optimization
2022-09-21 14:40:23 INFO  Estimated unoptimized what-if runtime is 58819.50616836548ms
2022-09-21 14:40:23 INFO  Estimated optimised what-if runtime is 2029.4384956359863ms
2022-09-21 14:40:23 INFO  Estimated optimisation runtime saving is 56790.06767272949ms
2022-09-21 14:40:23 INFO  ---RUNTIME: Multi-Query Optimization took 72.784423828125 ms
2022-09-21 14:40:23 INFO  Executing generated plans
2022-09-21 14:40:25 INFO  ---RUNTIME: Execution took 2235.926389694214 ms
2022-09-21 14:40:25 INFO  Done!
2022-09-21 14:40:25 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-21 14:40:25 INFO  Running instrumented original pipeline...
2022-09-21 14:40:25 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-21 14:40:25 INFO  ---RUNTIME: Importing and monkey-patching took 5.770444869995117 ms
2022-09-21 14:40:27 INFO  ---RUNTIME: Original pipeline execution took 2136.6894245147705 ms (excluding imports and monkey-patching)
2022-09-21 14:40:27 INFO  Starting execution of 1 what-if analyses...
2022-09-21 14:40:27 INFO  Start plan generation for analysis DataCorruption...
2022-09-21 14:40:27 INFO  ---RUNTIME: Plan generation took 0.4248619079589844 ms
2022-09-21 14:40:27 INFO  Estimated runtime of original DAG is 1907.0780277252197ms
2022-09-21 14:40:27 WARNING Skipping Multi-Query Optimization (instead, only applying patches)
2022-09-21 14:40:27 INFO  Estimated unoptimised what-if runtime is 57212.34083175659ms
2022-09-21 14:40:27 INFO  ---RUNTIME: Multi-Query Optimization took 19.70815658569336 ms
2022-09-21 14:40:27 INFO  Executing generated plans
2022-09-21 14:41:27 INFO  ---RUNTIME: Execution took 59193.17269325256 ms
2022-09-21 14:41:27 INFO  Done!
2022-09-21 14:41:27 INFO  # Finished -- repetition 1 of 7 
2022-09-21 14:41:27 INFO  # Optimization benchmark for data_corruption with args [['healthcare', 'slow_loading', 'featurization_0', 'xgboost']] -- repetition 2 of 7
2022-09-21 14:41:27 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-21 14:41:27 INFO  Running instrumented original pipeline...
2022-09-21 14:41:27 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-21 14:41:27 INFO  ---RUNTIME: Importing and monkey-patching took 6.0291290283203125 ms
2022-09-21 14:41:29 INFO  ---RUNTIME: Original pipeline execution took 2161.0679626464844 ms (excluding imports and monkey-patching)
2022-09-21 14:41:29 INFO  Starting execution of 1 what-if analyses...
2022-09-21 14:41:29 INFO  Start plan generation for analysis DataCorruption...
2022-09-21 14:41:29 INFO  ---RUNTIME: Plan generation took 0.42700767517089844 ms
2022-09-21 14:41:29 INFO  Estimated runtime of original DAG is 1931.9846630096436ms
2022-09-21 14:41:29 INFO  Performing Multi-Query Optimization
2022-09-21 14:41:29 INFO  Estimated unoptimized what-if runtime is 57959.53989028931ms
2022-09-21 14:41:29 INFO  Estimated optimised what-if runtime is 1991.5804862976074ms
2022-09-21 14:41:29 INFO  Estimated optimisation runtime saving is 55967.9594039917ms
2022-09-21 14:41:29 INFO  ---RUNTIME: Multi-Query Optimization took 72.32141494750977 ms
2022-09-21 14:41:29 INFO  Executing generated plans
2022-09-21 14:41:31 INFO  ---RUNTIME: Execution took 2097.5921154022217 ms
2022-09-21 14:41:31 INFO  Done!
2022-09-21 14:41:31 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-21 14:41:31 INFO  Running instrumented original pipeline...
2022-09-21 14:41:31 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-21 14:41:31 INFO  ---RUNTIME: Importing and monkey-patching took 5.409955978393555 ms
2022-09-21 14:41:33 INFO  ---RUNTIME: Original pipeline execution took 2206.6051959991455 ms (excluding imports and monkey-patching)
2022-09-21 14:41:33 INFO  Starting execution of 1 what-if analyses...
2022-09-21 14:41:33 INFO  Start plan generation for analysis DataCorruption...
2022-09-21 14:41:33 INFO  ---RUNTIME: Plan generation took 0.41222572326660156 ms
2022-09-21 14:41:33 INFO  Estimated runtime of original DAG is 1978.5363674163818ms
2022-09-21 14:41:33 WARNING Skipping Multi-Query Optimization (instead, only applying patches)
2022-09-21 14:41:33 INFO  Estimated unoptimised what-if runtime is 59356.091022491455ms
2022-09-21 14:41:33 INFO  ---RUNTIME: Multi-Query Optimization took 191.15948677062988 ms
2022-09-21 14:41:33 INFO  Executing generated plans
2022-09-21 14:42:34 INFO  ---RUNTIME: Execution took 60529.0207862854 ms
2022-09-21 14:42:34 INFO  Done!
2022-09-21 14:42:34 INFO  # Finished -- repetition 2 of 7 
2022-09-21 14:42:34 INFO  # Optimization benchmark for data_corruption with args [['healthcare', 'slow_loading', 'featurization_0', 'xgboost']] -- repetition 3 of 7
2022-09-21 14:42:34 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-21 14:42:34 INFO  Running instrumented original pipeline...
2022-09-21 14:42:34 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-21 14:42:34 INFO  ---RUNTIME: Importing and monkey-patching took 6.644725799560547 ms
2022-09-21 14:42:36 INFO  ---RUNTIME: Original pipeline execution took 2241.4867877960205 ms (excluding imports and monkey-patching)
2022-09-21 14:42:36 INFO  Starting execution of 1 what-if analyses...
2022-09-21 14:42:36 INFO  Start plan generation for analysis DataCorruption...
2022-09-21 14:42:36 INFO  ---RUNTIME: Plan generation took 0.4565715789794922 ms
2022-09-21 14:42:36 INFO  Estimated runtime of original DAG is 2003.5138130187988ms
2022-09-21 14:42:36 INFO  Performing Multi-Query Optimization
2022-09-21 14:42:36 INFO  Estimated unoptimized what-if runtime is 60105.414390563965ms
2022-09-21 14:42:36 INFO  Estimated optimised what-if runtime is 2068.5877799987793ms
2022-09-21 14:42:36 INFO  Estimated optimisation runtime saving is 58036.826610565186ms
2022-09-21 14:42:36 INFO  ---RUNTIME: Multi-Query Optimization took 72.04055786132812 ms
2022-09-21 14:42:36 INFO  Executing generated plans
2022-09-21 14:42:38 INFO  ---RUNTIME: Execution took 2105.135917663574 ms
2022-09-21 14:42:38 INFO  Done!
2022-09-21 14:42:38 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-21 14:42:38 INFO  Running instrumented original pipeline...
2022-09-21 14:42:38 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-21 14:42:38 INFO  ---RUNTIME: Importing and monkey-patching took 5.615472793579102 ms
2022-09-21 14:42:40 INFO  ---RUNTIME: Original pipeline execution took 2209.5839977264404 ms (excluding imports and monkey-patching)
2022-09-21 14:42:40 INFO  Starting execution of 1 what-if analyses...
2022-09-21 14:42:40 INFO  Start plan generation for analysis DataCorruption...
2022-09-21 14:42:40 INFO  ---RUNTIME: Plan generation took 0.4253387451171875 ms
2022-09-21 14:42:40 INFO  Estimated runtime of original DAG is 1980.7095527648926ms
2022-09-21 14:42:40 WARNING Skipping Multi-Query Optimization (instead, only applying patches)
2022-09-21 14:42:40 INFO  Estimated unoptimised what-if runtime is 59421.28658294678ms
2022-09-21 14:42:40 INFO  ---RUNTIME: Multi-Query Optimization took 19.698619842529297 ms
2022-09-21 14:42:40 INFO  Executing generated plans
2022-09-21 14:43:41 INFO  ---RUNTIME: Execution took 60730.86476325989 ms
2022-09-21 14:43:41 INFO  Done!
2022-09-21 14:43:41 INFO  # Finished -- repetition 3 of 7 
2022-09-21 14:43:41 INFO  # Optimization benchmark for data_corruption with args [['healthcare', 'slow_loading', 'featurization_0', 'xgboost']] -- repetition 4 of 7
2022-09-21 14:43:41 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-21 14:43:41 INFO  Running instrumented original pipeline...
2022-09-21 14:43:41 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-21 14:43:41 INFO  ---RUNTIME: Importing and monkey-patching took 5.801200866699219 ms
2022-09-21 14:43:43 INFO  ---RUNTIME: Original pipeline execution took 2187.398672103882 ms (excluding imports and monkey-patching)
2022-09-21 14:43:43 INFO  Starting execution of 1 what-if analyses...
2022-09-21 14:43:43 INFO  Start plan generation for analysis DataCorruption...
2022-09-21 14:43:43 INFO  ---RUNTIME: Plan generation took 0.44465065002441406 ms
2022-09-21 14:43:43 INFO  Estimated runtime of original DAG is 1957.6354026794434ms
2022-09-21 14:43:43 INFO  Performing Multi-Query Optimization
2022-09-21 14:43:43 INFO  Estimated unoptimized what-if runtime is 58729.0620803833ms
2022-09-21 14:43:43 INFO  Estimated optimised what-if runtime is 2018.2108879089355ms
2022-09-21 14:43:43 INFO  Estimated optimisation runtime saving is 56710.851192474365ms
2022-09-21 14:43:43 INFO  ---RUNTIME: Multi-Query Optimization took 72.03197479248047 ms
2022-09-21 14:43:43 INFO  Executing generated plans
2022-09-21 14:43:46 INFO  ---RUNTIME: Execution took 2182.2853088378906 ms
2022-09-21 14:43:46 INFO  Done!
2022-09-21 14:43:46 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-21 14:43:46 INFO  Running instrumented original pipeline...
2022-09-21 14:43:46 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-21 14:43:46 INFO  ---RUNTIME: Importing and monkey-patching took 5.609989166259766 ms
2022-09-21 14:43:48 INFO  ---RUNTIME: Original pipeline execution took 2211.012363433838 ms (excluding imports and monkey-patching)
2022-09-21 14:43:48 INFO  Starting execution of 1 what-if analyses...
2022-09-21 14:43:48 INFO  Start plan generation for analysis DataCorruption...
2022-09-21 14:43:48 INFO  ---RUNTIME: Plan generation took 0.49567222595214844 ms
2022-09-21 14:43:48 INFO  Estimated runtime of original DAG is 1975.2795696258545ms
2022-09-21 14:43:48 WARNING Skipping Multi-Query Optimization (instead, only applying patches)
2022-09-21 14:43:48 INFO  Estimated unoptimised what-if runtime is 59258.387088775635ms
2022-09-21 14:43:48 INFO  ---RUNTIME: Multi-Query Optimization took 23.746013641357422 ms
2022-09-21 14:43:48 INFO  Executing generated plans
2022-09-21 14:44:48 INFO  ---RUNTIME: Execution took 60530.13491630554 ms
2022-09-21 14:44:48 INFO  Done!
2022-09-21 14:44:48 INFO  # Finished -- repetition 4 of 7 
2022-09-21 14:44:48 INFO  # Optimization benchmark for data_corruption with args [['healthcare', 'slow_loading', 'featurization_0', 'xgboost']] -- repetition 5 of 7
2022-09-21 14:44:48 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-21 14:44:48 INFO  Running instrumented original pipeline...
2022-09-21 14:44:48 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-21 14:44:48 INFO  ---RUNTIME: Importing and monkey-patching took 6.019830703735352 ms
2022-09-21 14:44:51 INFO  ---RUNTIME: Original pipeline execution took 2189.5344257354736 ms (excluding imports and monkey-patching)
2022-09-21 14:44:51 INFO  Starting execution of 1 what-if analyses...
2022-09-21 14:44:51 INFO  Start plan generation for analysis DataCorruption...
2022-09-21 14:44:51 INFO  ---RUNTIME: Plan generation took 0.8027553558349609 ms
2022-09-21 14:44:51 INFO  Estimated runtime of original DAG is 1957.9136371612549ms
2022-09-21 14:44:51 INFO  Performing Multi-Query Optimization
2022-09-21 14:44:51 INFO  Estimated unoptimized what-if runtime is 58737.40911483765ms
2022-09-21 14:44:51 INFO  Estimated optimised what-if runtime is 2017.5178050994873ms
2022-09-21 14:44:51 INFO  Estimated optimisation runtime saving is 56719.89130973816ms
2022-09-21 14:44:51 INFO  ---RUNTIME: Multi-Query Optimization took 71.99692726135254 ms
2022-09-21 14:44:51 INFO  Executing generated plans
2022-09-21 14:44:53 INFO  ---RUNTIME: Execution took 2091.106176376343 ms
2022-09-21 14:44:53 INFO  Done!
2022-09-21 14:44:53 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-21 14:44:53 INFO  Running instrumented original pipeline...
2022-09-21 14:44:53 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-21 14:44:53 INFO  ---RUNTIME: Importing and monkey-patching took 5.752325057983398 ms
2022-09-21 14:44:55 INFO  ---RUNTIME: Original pipeline execution took 2385.819673538208 ms (excluding imports and monkey-patching)
2022-09-21 14:44:55 INFO  Starting execution of 1 what-if analyses...
2022-09-21 14:44:55 INFO  Start plan generation for analysis DataCorruption...
2022-09-21 14:44:55 INFO  ---RUNTIME: Plan generation took 0.4546642303466797 ms
2022-09-21 14:44:55 INFO  Estimated runtime of original DAG is 1956.6230773925781ms
2022-09-21 14:44:55 WARNING Skipping Multi-Query Optimization (instead, only applying patches)
2022-09-21 14:44:55 INFO  Estimated unoptimised what-if runtime is 58698.692321777344ms
2022-09-21 14:44:55 INFO  ---RUNTIME: Multi-Query Optimization took 19.945383071899414 ms
2022-09-21 14:44:55 INFO  Executing generated plans
2022-09-21 14:46:01 INFO  ---RUNTIME: Execution took 65886.72924041748 ms
2022-09-21 14:46:01 INFO  Done!
2022-09-21 14:46:01 INFO  # Finished -- repetition 5 of 7 
2022-09-21 14:46:01 INFO  # Optimization benchmark for data_corruption with args [['healthcare', 'slow_loading', 'featurization_0', 'xgboost']] -- repetition 6 of 7
2022-09-21 14:46:01 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-21 14:46:01 INFO  Running instrumented original pipeline...
2022-09-21 14:46:01 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-21 14:46:01 INFO  ---RUNTIME: Importing and monkey-patching took 6.073236465454102 ms
2022-09-21 14:46:04 INFO  ---RUNTIME: Original pipeline execution took 2446.848154067993 ms (excluding imports and monkey-patching)
2022-09-21 14:46:04 INFO  Starting execution of 1 what-if analyses...
2022-09-21 14:46:04 INFO  Start plan generation for analysis DataCorruption...
2022-09-21 14:46:04 INFO  ---RUNTIME: Plan generation took 0.4391670227050781 ms
2022-09-21 14:46:04 INFO  Estimated runtime of original DAG is 2215.3866291046143ms
2022-09-21 14:46:04 INFO  Performing Multi-Query Optimization
2022-09-21 14:46:04 INFO  Estimated unoptimized what-if runtime is 66461.59887313843ms
2022-09-21 14:46:04 INFO  Estimated optimised what-if runtime is 2277.4956226348877ms
2022-09-21 14:46:04 INFO  Estimated optimisation runtime saving is 64184.10325050354ms
2022-09-21 14:46:04 INFO  ---RUNTIME: Multi-Query Optimization took 72.18074798583984 ms
2022-09-21 14:46:04 INFO  Executing generated plans
2022-09-21 14:46:06 INFO  ---RUNTIME: Execution took 2091.2089347839355 ms
2022-09-21 14:46:06 INFO  Done!
2022-09-21 14:46:06 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-21 14:46:06 INFO  Running instrumented original pipeline...
2022-09-21 14:46:06 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-21 14:46:06 INFO  ---RUNTIME: Importing and monkey-patching took 5.87010383605957 ms
2022-09-21 14:46:08 INFO  ---RUNTIME: Original pipeline execution took 2196.3701248168945 ms (excluding imports and monkey-patching)
2022-09-21 14:46:08 INFO  Starting execution of 1 what-if analyses...
2022-09-21 14:46:08 INFO  Start plan generation for analysis DataCorruption...
2022-09-21 14:46:08 INFO  ---RUNTIME: Plan generation took 0.4298686981201172 ms
2022-09-21 14:46:08 INFO  Estimated runtime of original DAG is 1962.6288414001465ms
2022-09-21 14:46:08 WARNING Skipping Multi-Query Optimization (instead, only applying patches)
2022-09-21 14:46:08 INFO  Estimated unoptimised what-if runtime is 58878.865242004395ms
2022-09-21 14:46:08 INFO  ---RUNTIME: Multi-Query Optimization took 19.520044326782227 ms
2022-09-21 14:46:08 INFO  Executing generated plans
2022-09-21 14:47:09 INFO  ---RUNTIME: Execution took 60786.09037399292 ms
2022-09-21 14:47:09 INFO  Done!
2022-09-21 14:47:09 INFO  # Finished -- repetition 6 of 7 
2022-09-21 14:47:09 INFO  # Optimization benchmark for data_corruption with args [['healthcare', 'slow_loading', 'featurization_0', 'xgboost']] -- repetition 7 of 7
2022-09-21 14:47:09 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-21 14:47:09 INFO  Running instrumented original pipeline...
2022-09-21 14:47:09 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-21 14:47:09 INFO  ---RUNTIME: Importing and monkey-patching took 6.306171417236328 ms
2022-09-21 14:47:11 INFO  ---RUNTIME: Original pipeline execution took 2402.536392211914 ms (excluding imports and monkey-patching)
2022-09-21 14:47:11 INFO  Starting execution of 1 what-if analyses...
2022-09-21 14:47:11 INFO  Start plan generation for analysis DataCorruption...
2022-09-21 14:47:11 INFO  ---RUNTIME: Plan generation took 0.41556358337402344 ms
2022-09-21 14:47:11 INFO  Estimated runtime of original DAG is 1963.2885456085205ms
2022-09-21 14:47:11 INFO  Performing Multi-Query Optimization
2022-09-21 14:47:11 INFO  Estimated unoptimized what-if runtime is 58898.656368255615ms
2022-09-21 14:47:11 INFO  Estimated optimised what-if runtime is 2023.3807563781738ms
2022-09-21 14:47:11 INFO  Estimated optimisation runtime saving is 56875.27561187744ms
2022-09-21 14:47:11 INFO  ---RUNTIME: Multi-Query Optimization took 71.62070274353027 ms
2022-09-21 14:47:11 INFO  Executing generated plans
2022-09-21 14:47:13 INFO  ---RUNTIME: Execution took 2109.7567081451416 ms
2022-09-21 14:47:13 INFO  Done!
2022-09-21 14:47:13 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-21 14:47:13 INFO  Running instrumented original pipeline...
2022-09-21 14:47:13 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-21 14:47:13 INFO  ---RUNTIME: Importing and monkey-patching took 5.449533462524414 ms
2022-09-21 14:47:16 INFO  ---RUNTIME: Original pipeline execution took 2193.070888519287 ms (excluding imports and monkey-patching)
2022-09-21 14:47:16 INFO  Starting execution of 1 what-if analyses...
2022-09-21 14:47:16 INFO  Start plan generation for analysis DataCorruption...
2022-09-21 14:47:16 INFO  ---RUNTIME: Plan generation took 0.4305839538574219 ms
2022-09-21 14:47:16 INFO  Estimated runtime of original DAG is 1962.4698162078857ms
2022-09-21 14:47:16 WARNING Skipping Multi-Query Optimization (instead, only applying patches)
2022-09-21 14:47:16 INFO  Estimated unoptimised what-if runtime is 58874.09448623657ms
2022-09-21 14:47:16 INFO  ---RUNTIME: Multi-Query Optimization took 19.712209701538086 ms
2022-09-21 14:47:16 INFO  Executing generated plans
2022-09-21 14:48:16 INFO  ---RUNTIME: Execution took 60624.090909957886 ms
2022-09-21 14:48:16 INFO  Done!
2022-09-21 14:48:16 INFO  # Finished -- repetition 7 of 7 
2022-09-21 14:48:16 INFO  # Final results after all repetitions
2022-09-21 14:48:16 INFO     repetition  ... no_opt_what_if_execution_combined_model_training
0           0  ...                                      5461.419582
1           1  ...                                      5510.304689
2           2  ...                                      5529.619932
3           3  ...                                      5502.511024
4           4  ...                                      5558.124781
5           5  ...                                      5527.890921
6           6  ...                                      5536.926270

[7 rows x 26 columns]
taskset -c 0-7 PROTOCOL_BUFFERS_PYTHON_IMPLEMENTATION=python python3.9 benchmarks_end_to_end.py data_corruption healthcare slow_loading featurization_0 neural_network
2022-09-21 14:48:18.705193: W tensorflow/stream_executor/platform/default/dso_loader.cc:64] Could not load dynamic library 'libcudart.so.11.0'; dlerror: libcudart.so.11.0: cannot open shared object file: No such file or directory; LD_LIBRARY_PATH: /home/sgrafbe/mlwhatif/venv/lib/python3.9/site-packages/cv2/../../lib64:
2022-09-21 14:48:18.705237: I tensorflow/stream_executor/cuda/cudart_stub.cc:29] Ignore above cudart dlerror if you do not have a GPU set up on your machine.
2022-09-21 14:48:19 INFO  Patching sys.argv with ['mlwhatif', 'healthcare', 'slow_loading', 'featurization_0', 'neural_network']
2022-09-21 14:48:19 INFO  Running instrumented original pipeline...
2022-09-21 14:48:19 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-21 14:48:20 INFO  ---RUNTIME: Importing and monkey-patching took 95.06368637084961 ms
2022-09-21 14:48:22.059453: W tensorflow/stream_executor/platform/default/dso_loader.cc:64] Could not load dynamic library 'libcuda.so.1'; dlerror: libcuda.so.1: cannot open shared object file: No such file or directory; LD_LIBRARY_PATH: /home/sgrafbe/mlwhatif/venv/lib/python3.9/site-packages/cv2/../../lib64:
2022-09-21 14:48:22.059487: W tensorflow/stream_executor/cuda/cuda_driver.cc:326] failed call to cuInit: UNKNOWN ERROR (303)
2022-09-21 14:48:22.059511: I tensorflow/stream_executor/cuda/cuda_diagnostics.cc:156] kernel driver does not appear to be running on this host (wagyu): /proc/driver/nvidia/version does not exist
2022-09-21 14:48:22.060038: I tensorflow/core/platform/cpu_feature_guard.cc:142] This TensorFlow binary is optimized with oneAPI Deep Neural Network Library (oneDNN) to use the following CPU instructions in performance-critical operations:  AVX2 FMA
To enable them in other operations, rebuild TensorFlow with the appropriate compiler flags.
2022-09-21 14:48:22.124470: I tensorflow/compiler/mlir/mlir_graph_optimization_pass.cc:176] None of the MLIR Optimization Passes are enabled (registered 2)
2022-09-21 14:48:22.137421: I tensorflow/core/platform/profile_utils/cpu_utils.cc:114] CPU Frequency: 2595290000 Hz
2022-09-21 14:48:22 INFO  ---RUNTIME: Original pipeline execution took 2736.464738845825 ms (excluding imports and monkey-patching)
2022-09-21 14:48:22 INFO  Starting execution of 0 what-if analyses...
2022-09-21 14:48:22 INFO  Estimated runtime of original DAG is 2481.989860534668ms
2022-09-21 14:48:22 INFO  Performing Multi-Query Optimization
2022-09-21 14:48:22 INFO  Estimated unoptimized what-if runtime is 0ms
2022-09-21 14:48:22 INFO  Estimated optimised what-if runtime is 0ms
2022-09-21 14:48:22 INFO  Estimated optimisation runtime saving is 0ms
2022-09-21 14:48:22 INFO  ---RUNTIME: Multi-Query Optimization took 0.4265308380126953 ms
2022-09-21 14:48:22 INFO  Executing generated plans
2022-09-21 14:48:22 INFO  ---RUNTIME: Execution took 0.015020370483398438 ms
2022-09-21 14:48:22 INFO  Done!
2022-09-21 14:48:22 INFO  # Optimization benchmark for data_corruption with args [['healthcare', 'slow_loading', 'featurization_0', 'neural_network']] -- repetition 1 of 7
2022-09-21 14:48:22 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-21 14:48:22 INFO  Running instrumented original pipeline...
2022-09-21 14:48:22 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-21 14:48:22 INFO  ---RUNTIME: Importing and monkey-patching took 5.24449348449707 ms
2022-09-21 14:48:25 INFO  ---RUNTIME: Original pipeline execution took 2356.1947345733643 ms (excluding imports and monkey-patching)
2022-09-21 14:48:25 INFO  Starting execution of 1 what-if analyses...
2022-09-21 14:48:25 INFO  Start plan generation for analysis DataCorruption...
2022-09-21 14:48:25 INFO  ---RUNTIME: Plan generation took 1.8353462219238281 ms
2022-09-21 14:48:25 INFO  Estimated runtime of original DAG is 2127.065420150757ms
2022-09-21 14:48:25 INFO  Performing Multi-Query Optimization
2022-09-21 14:48:25 INFO  Estimated unoptimized what-if runtime is 63811.962604522705ms
2022-09-21 14:48:25 INFO  Estimated optimised what-if runtime is 3592.3244953155518ms
2022-09-21 14:48:25 INFO  Estimated optimisation runtime saving is 60219.63810920715ms
2022-09-21 14:48:25 INFO  ---RUNTIME: Multi-Query Optimization took 70.97983360290527 ms
2022-09-21 14:48:25 INFO  Executing generated plans
2022-09-21 14:48:28 INFO  ---RUNTIME: Execution took 3068.2501792907715 ms
2022-09-21 14:48:28 INFO  Done!
2022-09-21 14:48:28 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-21 14:48:28 INFO  Running instrumented original pipeline...
2022-09-21 14:48:28 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-21 14:48:28 INFO  ---RUNTIME: Importing and monkey-patching took 5.744218826293945 ms
2022-09-21 14:48:31 INFO  ---RUNTIME: Original pipeline execution took 2759.033441543579 ms (excluding imports and monkey-patching)
2022-09-21 14:48:31 INFO  Starting execution of 1 what-if analyses...
2022-09-21 14:48:31 INFO  Start plan generation for analysis DataCorruption...
2022-09-21 14:48:31 INFO  ---RUNTIME: Plan generation took 0.41604042053222656 ms
2022-09-21 14:48:31 INFO  Estimated runtime of original DAG is 2536.0491275787354ms
2022-09-21 14:48:31 WARNING Skipping Multi-Query Optimization (instead, only applying patches)
2022-09-21 14:48:31 INFO  Estimated unoptimised what-if runtime is 76081.47382736206ms
2022-09-21 14:48:31 INFO  ---RUNTIME: Multi-Query Optimization took 19.385099411010742 ms
2022-09-21 14:48:31 INFO  Executing generated plans
2022-09-21 14:49:38 INFO  ---RUNTIME: Execution took 67286.6997718811 ms
2022-09-21 14:49:38 INFO  Done!
2022-09-21 14:49:38 INFO  # Finished -- repetition 1 of 7 
2022-09-21 14:49:38 INFO  # Optimization benchmark for data_corruption with args [['healthcare', 'slow_loading', 'featurization_0', 'neural_network']] -- repetition 2 of 7
2022-09-21 14:49:38 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-21 14:49:38 INFO  Running instrumented original pipeline...
2022-09-21 14:49:38 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-21 14:49:38 INFO  ---RUNTIME: Importing and monkey-patching took 6.468296051025391 ms
2022-09-21 14:49:40 INFO  ---RUNTIME: Original pipeline execution took 2369.359254837036 ms (excluding imports and monkey-patching)
2022-09-21 14:49:40 INFO  Starting execution of 1 what-if analyses...
2022-09-21 14:49:40 INFO  Start plan generation for analysis DataCorruption...
2022-09-21 14:49:40 INFO  ---RUNTIME: Plan generation took 0.5614757537841797 ms
2022-09-21 14:49:40 INFO  Estimated runtime of original DAG is 2137.744903564453ms
2022-09-21 14:49:40 INFO  Performing Multi-Query Optimization
2022-09-21 14:49:40 INFO  Estimated unoptimized what-if runtime is 64132.347106933594ms
2022-09-21 14:49:40 INFO  Estimated optimised what-if runtime is 3783.1404209136963ms
2022-09-21 14:49:40 INFO  Estimated optimisation runtime saving is 60349.2066860199ms
2022-09-21 14:49:40 INFO  ---RUNTIME: Multi-Query Optimization took 75.05393028259277 ms
2022-09-21 14:49:40 INFO  Executing generated plans
2022-09-21 14:49:44 INFO  ---RUNTIME: Execution took 3237.581491470337 ms
2022-09-21 14:49:44 INFO  Done!
2022-09-21 14:49:44 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-21 14:49:44 INFO  Running instrumented original pipeline...
2022-09-21 14:49:44 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-21 14:49:44 INFO  ---RUNTIME: Importing and monkey-patching took 5.923271179199219 ms
2022-09-21 14:49:46 INFO  ---RUNTIME: Original pipeline execution took 2590.5508995056152 ms (excluding imports and monkey-patching)
2022-09-21 14:49:46 INFO  Starting execution of 1 what-if analyses...
2022-09-21 14:49:46 INFO  Start plan generation for analysis DataCorruption...
2022-09-21 14:49:46 INFO  ---RUNTIME: Plan generation took 0.47707557678222656 ms
2022-09-21 14:49:46 INFO  Estimated runtime of original DAG is 2369.629383087158ms
2022-09-21 14:49:46 WARNING Skipping Multi-Query Optimization (instead, only applying patches)
2022-09-21 14:49:46 INFO  Estimated unoptimised what-if runtime is 71088.88149261475ms
2022-09-21 14:49:46 INFO  ---RUNTIME: Multi-Query Optimization took 20.087480545043945 ms
2022-09-21 14:49:46 INFO  Executing generated plans
2022-09-21 14:50:52 INFO  ---RUNTIME: Execution took 65420.918464660645 ms
2022-09-21 14:50:52 INFO  Done!
2022-09-21 14:50:52 INFO  # Finished -- repetition 2 of 7 
2022-09-21 14:50:52 INFO  # Optimization benchmark for data_corruption with args [['healthcare', 'slow_loading', 'featurization_0', 'neural_network']] -- repetition 3 of 7
2022-09-21 14:50:52 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-21 14:50:52 INFO  Running instrumented original pipeline...
2022-09-21 14:50:52 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-21 14:50:52 INFO  ---RUNTIME: Importing and monkey-patching took 5.892515182495117 ms
2022-09-21 14:50:54 INFO  ---RUNTIME: Original pipeline execution took 2343.4133529663086 ms (excluding imports and monkey-patching)
2022-09-21 14:50:54 INFO  Starting execution of 1 what-if analyses...
2022-09-21 14:50:54 INFO  Start plan generation for analysis DataCorruption...
2022-09-21 14:50:54 INFO  ---RUNTIME: Plan generation took 0.49757957458496094 ms
2022-09-21 14:50:54 INFO  Estimated runtime of original DAG is 2119.7245121002197ms
2022-09-21 14:50:54 INFO  Performing Multi-Query Optimization
2022-09-21 14:50:54 INFO  Estimated unoptimized what-if runtime is 63591.73536300659ms
2022-09-21 14:50:54 INFO  Estimated optimised what-if runtime is 3585.7348442077637ms
2022-09-21 14:50:54 INFO  Estimated optimisation runtime saving is 60006.00051879883ms
2022-09-21 14:50:54 INFO  ---RUNTIME: Multi-Query Optimization took 73.11820983886719 ms
2022-09-21 14:50:54 INFO  Executing generated plans
2022-09-21 14:50:57 INFO  ---RUNTIME: Execution took 3336.9407653808594 ms
2022-09-21 14:50:57 INFO  Done!
2022-09-21 14:50:57 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-21 14:50:57 INFO  Running instrumented original pipeline...
2022-09-21 14:50:57 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-21 14:50:57 INFO  ---RUNTIME: Importing and monkey-patching took 6.188631057739258 ms
2022-09-21 14:51:00 INFO  ---RUNTIME: Original pipeline execution took 2334.2599868774414 ms (excluding imports and monkey-patching)
2022-09-21 14:51:00 INFO  Starting execution of 1 what-if analyses...
2022-09-21 14:51:00 INFO  Start plan generation for analysis DataCorruption...
2022-09-21 14:51:00 INFO  ---RUNTIME: Plan generation took 0.6139278411865234 ms
2022-09-21 14:51:00 INFO  Estimated runtime of original DAG is 2109.4448566436768ms
2022-09-21 14:51:00 WARNING Skipping Multi-Query Optimization (instead, only applying patches)
2022-09-21 14:51:00 INFO  Estimated unoptimised what-if runtime is 63283.3456993103ms
2022-09-21 14:51:00 INFO  ---RUNTIME: Multi-Query Optimization took 20.1873779296875 ms
2022-09-21 14:51:00 INFO  Executing generated plans
2022-09-21 14:52:05 INFO  ---RUNTIME: Execution took 65687.26873397827 ms
2022-09-21 14:52:05 INFO  Done!
2022-09-21 14:52:05 INFO  # Finished -- repetition 3 of 7 
2022-09-21 14:52:05 INFO  # Optimization benchmark for data_corruption with args [['healthcare', 'slow_loading', 'featurization_0', 'neural_network']] -- repetition 4 of 7
2022-09-21 14:52:05 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-21 14:52:05 INFO  Running instrumented original pipeline...
2022-09-21 14:52:05 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-21 14:52:05 INFO  ---RUNTIME: Importing and monkey-patching took 5.889892578125 ms
2022-09-21 14:52:08 INFO  ---RUNTIME: Original pipeline execution took 2637.3419761657715 ms (excluding imports and monkey-patching)
2022-09-21 14:52:08 INFO  Starting execution of 1 what-if analyses...
2022-09-21 14:52:08 INFO  Start plan generation for analysis DataCorruption...
2022-09-21 14:52:08 INFO  ---RUNTIME: Plan generation took 0.499725341796875 ms
2022-09-21 14:52:08 INFO  Estimated runtime of original DAG is 2415.3099060058594ms
2022-09-21 14:52:08 INFO  Performing Multi-Query Optimization
2022-09-21 14:52:08 INFO  Estimated unoptimized what-if runtime is 72459.29718017578ms
2022-09-21 14:52:08 INFO  Estimated optimised what-if runtime is 3927.7544021606445ms
2022-09-21 14:52:08 INFO  Estimated optimisation runtime saving is 68531.54277801514ms
2022-09-21 14:52:08 INFO  ---RUNTIME: Multi-Query Optimization took 73.31538200378418 ms
2022-09-21 14:52:08 INFO  Executing generated plans
2022-09-21 14:52:11 INFO  ---RUNTIME: Execution took 3033.698797225952 ms
2022-09-21 14:52:11 INFO  Done!
2022-09-21 14:52:11 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-21 14:52:11 INFO  Running instrumented original pipeline...
2022-09-21 14:52:11 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-21 14:52:11 INFO  ---RUNTIME: Importing and monkey-patching took 5.57255744934082 ms
2022-09-21 14:52:13 INFO  ---RUNTIME: Original pipeline execution took 2326.8420696258545 ms (excluding imports and monkey-patching)
2022-09-21 14:52:13 INFO  Starting execution of 1 what-if analyses...
2022-09-21 14:52:13 INFO  Start plan generation for analysis DataCorruption...
2022-09-21 14:52:13 INFO  ---RUNTIME: Plan generation took 0.5660057067871094 ms
2022-09-21 14:52:13 INFO  Estimated runtime of original DAG is 2100.813865661621ms
2022-09-21 14:52:13 WARNING Skipping Multi-Query Optimization (instead, only applying patches)
2022-09-21 14:52:13 INFO  Estimated unoptimised what-if runtime is 63024.41596984863ms
2022-09-21 14:52:13 INFO  ---RUNTIME: Multi-Query Optimization took 19.881248474121094 ms
2022-09-21 14:52:13 INFO  Executing generated plans
2022-09-21 14:53:19 INFO  ---RUNTIME: Execution took 65649.5144367218 ms
2022-09-21 14:53:19 INFO  Done!
2022-09-21 14:53:19 INFO  # Finished -- repetition 4 of 7 
2022-09-21 14:53:19 INFO  # Optimization benchmark for data_corruption with args [['healthcare', 'slow_loading', 'featurization_0', 'neural_network']] -- repetition 5 of 7
2022-09-21 14:53:19 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-21 14:53:19 INFO  Running instrumented original pipeline...
2022-09-21 14:53:19 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-21 14:53:19 INFO  ---RUNTIME: Importing and monkey-patching took 5.921602249145508 ms
2022-09-21 14:53:21 INFO  ---RUNTIME: Original pipeline execution took 2337.03875541687 ms (excluding imports and monkey-patching)
2022-09-21 14:53:21 INFO  Starting execution of 1 what-if analyses...
2022-09-21 14:53:21 INFO  Start plan generation for analysis DataCorruption...
2022-09-21 14:53:21 INFO  ---RUNTIME: Plan generation took 0.5199909210205078 ms
2022-09-21 14:53:21 INFO  Estimated runtime of original DAG is 2113.868474960327ms
2022-09-21 14:53:21 INFO  Performing Multi-Query Optimization
2022-09-21 14:53:22 INFO  Estimated unoptimized what-if runtime is 63416.054248809814ms
2022-09-21 14:53:22 INFO  Estimated optimised what-if runtime is 3572.265625ms
2022-09-21 14:53:22 INFO  Estimated optimisation runtime saving is 59843.788623809814ms
2022-09-21 14:53:22 INFO  ---RUNTIME: Multi-Query Optimization took 72.31712341308594 ms
2022-09-21 14:53:22 INFO  Executing generated plans
2022-09-21 14:53:25 INFO  ---RUNTIME: Execution took 3415.34161567688 ms
2022-09-21 14:53:25 INFO  Done!
2022-09-21 14:53:25 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-21 14:53:25 INFO  Running instrumented original pipeline...
2022-09-21 14:53:25 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-21 14:53:25 INFO  ---RUNTIME: Importing and monkey-patching took 6.50477409362793 ms
2022-09-21 14:53:27 INFO  ---RUNTIME: Original pipeline execution took 2327.364444732666 ms (excluding imports and monkey-patching)
2022-09-21 14:53:27 INFO  Starting execution of 1 what-if analyses...
2022-09-21 14:53:27 INFO  Start plan generation for analysis DataCorruption...
2022-09-21 14:53:27 INFO  ---RUNTIME: Plan generation took 0.5049705505371094 ms
2022-09-21 14:53:27 INFO  Estimated runtime of original DAG is 2104.4631004333496ms
2022-09-21 14:53:27 WARNING Skipping Multi-Query Optimization (instead, only applying patches)
2022-09-21 14:53:27 INFO  Estimated unoptimised what-if runtime is 63133.89301300049ms
2022-09-21 14:53:27 INFO  ---RUNTIME: Multi-Query Optimization took 19.86861228942871 ms
2022-09-21 14:53:27 INFO  Executing generated plans
2022-09-21 14:54:34 INFO  ---RUNTIME: Execution took 66370.37134170532 ms
2022-09-21 14:54:34 INFO  Done!
2022-09-21 14:54:34 INFO  # Finished -- repetition 5 of 7 
2022-09-21 14:54:34 INFO  # Optimization benchmark for data_corruption with args [['healthcare', 'slow_loading', 'featurization_0', 'neural_network']] -- repetition 6 of 7
2022-09-21 14:54:34 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-21 14:54:34 INFO  Running instrumented original pipeline...
2022-09-21 14:54:34 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-21 14:54:34 INFO  ---RUNTIME: Importing and monkey-patching took 6.000518798828125 ms
2022-09-21 14:54:36 INFO  ---RUNTIME: Original pipeline execution took 2354.313373565674 ms (excluding imports and monkey-patching)
2022-09-21 14:54:36 INFO  Starting execution of 1 what-if analyses...
2022-09-21 14:54:36 INFO  Start plan generation for analysis DataCorruption...
2022-09-21 14:54:36 INFO  ---RUNTIME: Plan generation took 0.6053447723388672 ms
2022-09-21 14:54:36 INFO  Estimated runtime of original DAG is 2132.762908935547ms
2022-09-21 14:54:36 INFO  Performing Multi-Query Optimization
2022-09-21 14:54:36 INFO  Estimated unoptimized what-if runtime is 63982.887268066406ms
2022-09-21 14:54:36 INFO  Estimated optimised what-if runtime is 3638.3109092712402ms
2022-09-21 14:54:36 INFO  Estimated optimisation runtime saving is 60344.576358795166ms
2022-09-21 14:54:36 INFO  ---RUNTIME: Multi-Query Optimization took 72.34048843383789 ms
2022-09-21 14:54:36 INFO  Executing generated plans
2022-09-21 14:54:39 INFO  ---RUNTIME: Execution took 3021.0916996002197 ms
2022-09-21 14:54:39 INFO  Done!
2022-09-21 14:54:39 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-21 14:54:39 INFO  Running instrumented original pipeline...
2022-09-21 14:54:40 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-21 14:54:40 INFO  ---RUNTIME: Importing and monkey-patching took 5.771636962890625 ms
2022-09-21 14:54:42 INFO  ---RUNTIME: Original pipeline execution took 2685.1553916931152 ms (excluding imports and monkey-patching)
2022-09-21 14:54:42 INFO  Starting execution of 1 what-if analyses...
2022-09-21 14:54:42 INFO  Start plan generation for analysis DataCorruption...
2022-09-21 14:54:42 INFO  ---RUNTIME: Plan generation took 2.8755664825439453 ms
2022-09-21 14:54:42 INFO  Estimated runtime of original DAG is 2121.333599090576ms
2022-09-21 14:54:42 WARNING Skipping Multi-Query Optimization (instead, only applying patches)
2022-09-21 14:54:42 INFO  Estimated unoptimised what-if runtime is 63640.007972717285ms
2022-09-21 14:54:42 INFO  ---RUNTIME: Multi-Query Optimization took 22.656679153442383 ms
2022-09-21 14:54:42 INFO  Executing generated plans
2022-09-21 14:55:48 INFO  ---RUNTIME: Execution took 65813.43388557434 ms
2022-09-21 14:55:48 INFO  Done!
2022-09-21 14:55:48 INFO  # Finished -- repetition 6 of 7 
2022-09-21 14:55:48 INFO  # Optimization benchmark for data_corruption with args [['healthcare', 'slow_loading', 'featurization_0', 'neural_network']] -- repetition 7 of 7
2022-09-21 14:55:48 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-21 14:55:48 INFO  Running instrumented original pipeline...
2022-09-21 14:55:48 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-21 14:55:48 INFO  ---RUNTIME: Importing and monkey-patching took 6.062746047973633 ms
2022-09-21 14:55:50 INFO  ---RUNTIME: Original pipeline execution took 2342.1638011932373 ms (excluding imports and monkey-patching)
2022-09-21 14:55:50 INFO  Starting execution of 1 what-if analyses...
2022-09-21 14:55:50 INFO  Start plan generation for analysis DataCorruption...
2022-09-21 14:55:50 INFO  ---RUNTIME: Plan generation took 2.3241043090820312 ms
2022-09-21 14:55:50 INFO  Estimated runtime of original DAG is 2118.295669555664ms
2022-09-21 14:55:50 INFO  Performing Multi-Query Optimization
2022-09-21 14:55:50 INFO  Estimated unoptimized what-if runtime is 63548.87008666992ms
2022-09-21 14:55:50 INFO  Estimated optimised what-if runtime is 3583.5840702056885ms
2022-09-21 14:55:50 INFO  Estimated optimisation runtime saving is 59965.28601646423ms
2022-09-21 14:55:50 INFO  ---RUNTIME: Multi-Query Optimization took 74.87010955810547 ms
2022-09-21 14:55:50 INFO  Executing generated plans
2022-09-21 14:55:53 INFO  ---RUNTIME: Execution took 3055.173873901367 ms
2022-09-21 14:55:53 INFO  Done!
2022-09-21 14:55:53 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-21 14:55:53 INFO  Running instrumented original pipeline...
2022-09-21 14:55:53 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-21 14:55:53 INFO  ---RUNTIME: Importing and monkey-patching took 5.993127822875977 ms
2022-09-21 14:55:56 INFO  ---RUNTIME: Original pipeline execution took 2356.030225753784 ms (excluding imports and monkey-patching)
2022-09-21 14:55:56 INFO  Starting execution of 1 what-if analyses...
2022-09-21 14:55:56 INFO  Start plan generation for analysis DataCorruption...
2022-09-21 14:55:56 INFO  ---RUNTIME: Plan generation took 0.6577968597412109 ms
2022-09-21 14:55:56 INFO  Estimated runtime of original DAG is 2129.0924549102783ms
2022-09-21 14:55:56 WARNING Skipping Multi-Query Optimization (instead, only applying patches)
2022-09-21 14:55:56 INFO  Estimated unoptimised what-if runtime is 63872.77364730835ms
2022-09-21 14:55:56 INFO  ---RUNTIME: Multi-Query Optimization took 21.429777145385742 ms
2022-09-21 14:55:56 INFO  Executing generated plans
2022-09-21 14:57:01 INFO  ---RUNTIME: Execution took 65868.22175979614 ms
2022-09-21 14:57:01 INFO  Done!
2022-09-21 14:57:01 INFO  # Finished -- repetition 7 of 7 
2022-09-21 14:57:01 INFO  # Final results after all repetitions
2022-09-21 14:57:01 INFO     repetition  ... no_opt_what_if_execution_combined_model_training
0           0  ...                                     10625.602484
1           1  ...                                     10836.755514
2           2  ...                                     11131.835222
3           3  ...                                     10852.494240
4           4  ...                                     10631.820440
5           5  ...                                     11012.845278
6           6  ...                                     11404.721022

[7 rows x 26 columns]
taskset -c 0-7 PROTOCOL_BUFFERS_PYTHON_IMPLEMENTATION=python python3.9 benchmarks_end_to_end.py data_corruption healthcare slow_loading featurization_1 logistic_regression
2022-09-21 14:57:04.344992: W tensorflow/stream_executor/platform/default/dso_loader.cc:64] Could not load dynamic library 'libcudart.so.11.0'; dlerror: libcudart.so.11.0: cannot open shared object file: No such file or directory; LD_LIBRARY_PATH: /home/sgrafbe/mlwhatif/venv/lib/python3.9/site-packages/cv2/../../lib64:
2022-09-21 14:57:04.345038: I tensorflow/stream_executor/cuda/cudart_stub.cc:29] Ignore above cudart dlerror if you do not have a GPU set up on your machine.
2022-09-21 14:57:05 INFO  Patching sys.argv with ['mlwhatif', 'healthcare', 'slow_loading', 'featurization_1', 'logistic_regression']
2022-09-21 14:57:05 INFO  Running instrumented original pipeline...
2022-09-21 14:57:05 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-21 14:57:05 INFO  ---RUNTIME: Importing and monkey-patching took 100.66604614257812 ms
2022-09-21 14:57:07 INFO  ---RUNTIME: Original pipeline execution took 2076.0338306427 ms (excluding imports and monkey-patching)
2022-09-21 14:57:07 INFO  Starting execution of 0 what-if analyses...
2022-09-21 14:57:07 INFO  Estimated runtime of original DAG is 1791.4278507232666ms
2022-09-21 14:57:07 INFO  Performing Multi-Query Optimization
2022-09-21 14:57:07 INFO  Estimated unoptimized what-if runtime is 0ms
2022-09-21 14:57:07 INFO  Estimated optimised what-if runtime is 0ms
2022-09-21 14:57:07 INFO  Estimated optimisation runtime saving is 0ms
2022-09-21 14:57:07 INFO  ---RUNTIME: Multi-Query Optimization took 0.4451274871826172 ms
2022-09-21 14:57:07 INFO  Executing generated plans
2022-09-21 14:57:07 INFO  ---RUNTIME: Execution took 0.023126602172851562 ms
2022-09-21 14:57:07 INFO  Done!
2022-09-21 14:57:07 INFO  # Optimization benchmark for data_corruption with args [['healthcare', 'slow_loading', 'featurization_1', 'logistic_regression']] -- repetition 1 of 7
2022-09-21 14:57:07 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-21 14:57:07 INFO  Running instrumented original pipeline...
2022-09-21 14:57:07 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-21 14:57:07 INFO  ---RUNTIME: Importing and monkey-patching took 5.137205123901367 ms
2022-09-21 14:57:09 INFO  ---RUNTIME: Original pipeline execution took 2006.2930583953857 ms (excluding imports and monkey-patching)
2022-09-21 14:57:09 INFO  Starting execution of 1 what-if analyses...
2022-09-21 14:57:09 INFO  Start plan generation for analysis DataCorruption...
2022-09-21 14:57:09 INFO  ---RUNTIME: Plan generation took 0.5064010620117188 ms
2022-09-21 14:57:09 INFO  Estimated runtime of original DAG is 1753.429651260376ms
2022-09-21 14:57:09 INFO  Performing Multi-Query Optimization
2022-09-21 14:57:09 INFO  Estimated unoptimized what-if runtime is 52602.88953781128ms
2022-09-21 14:57:09 INFO  Estimated optimised what-if runtime is 1803.1575679779053ms
2022-09-21 14:57:09 INFO  Estimated optimisation runtime saving is 50799.731969833374ms
2022-09-21 14:57:09 INFO  ---RUNTIME: Multi-Query Optimization took 77.83150672912598 ms
2022-09-21 14:57:09 INFO  Executing generated plans
2022-09-21 14:57:11 INFO  ---RUNTIME: Execution took 1889.0905380249023 ms
2022-09-21 14:57:11 INFO  Done!
2022-09-21 14:57:11 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-21 14:57:11 INFO  Running instrumented original pipeline...
2022-09-21 14:57:12 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-21 14:57:12 INFO  ---RUNTIME: Importing and monkey-patching took 5.797863006591797 ms
2022-09-21 14:57:13 INFO  ---RUNTIME: Original pipeline execution took 2207.5448036193848 ms (excluding imports and monkey-patching)
2022-09-21 14:57:13 INFO  Starting execution of 1 what-if analyses...
2022-09-21 14:57:13 INFO  Start plan generation for analysis DataCorruption...
2022-09-21 14:57:13 INFO  ---RUNTIME: Plan generation took 1.0449886322021484 ms
2022-09-21 14:57:13 INFO  Estimated runtime of original DAG is 1762.0460987091064ms
2022-09-21 14:57:13 WARNING Skipping Multi-Query Optimization (instead, only applying patches)
2022-09-21 14:57:14 INFO  Estimated unoptimised what-if runtime is 52861.38296127319ms
2022-09-21 14:57:14 INFO  ---RUNTIME: Multi-Query Optimization took 27.341365814208984 ms
2022-09-21 14:57:14 INFO  Executing generated plans
2022-09-21 14:58:07 INFO  ---RUNTIME: Execution took 53592.47636795044 ms
2022-09-21 14:58:07 INFO  Done!
2022-09-21 14:58:07 INFO  # Finished -- repetition 1 of 7 
2022-09-21 14:58:07 INFO  # Optimization benchmark for data_corruption with args [['healthcare', 'slow_loading', 'featurization_1', 'logistic_regression']] -- repetition 2 of 7
2022-09-21 14:58:07 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-21 14:58:07 INFO  Running instrumented original pipeline...
2022-09-21 14:58:07 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-21 14:58:07 INFO  ---RUNTIME: Importing and monkey-patching took 6.012201309204102 ms
2022-09-21 14:58:09 INFO  ---RUNTIME: Original pipeline execution took 2040.1530265808105 ms (excluding imports and monkey-patching)
2022-09-21 14:58:09 INFO  Starting execution of 1 what-if analyses...
2022-09-21 14:58:09 INFO  Start plan generation for analysis DataCorruption...
2022-09-21 14:58:09 INFO  ---RUNTIME: Plan generation took 0.4868507385253906 ms
2022-09-21 14:58:09 INFO  Estimated runtime of original DAG is 1790.9936904907227ms
2022-09-21 14:58:09 INFO  Performing Multi-Query Optimization
2022-09-21 14:58:09 INFO  Estimated unoptimized what-if runtime is 53729.81071472168ms
2022-09-21 14:58:09 INFO  Estimated optimised what-if runtime is 1838.5426998138428ms
2022-09-21 14:58:09 INFO  Estimated optimisation runtime saving is 51891.26801490784ms
2022-09-21 14:58:09 INFO  ---RUNTIME: Multi-Query Optimization took 77.37183570861816 ms
2022-09-21 14:58:09 INFO  Executing generated plans
2022-09-21 14:58:11 INFO  ---RUNTIME: Execution took 1901.838779449463 ms
2022-09-21 14:58:11 INFO  Done!
2022-09-21 14:58:11 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-21 14:58:11 INFO  Running instrumented original pipeline...
2022-09-21 14:58:11 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-21 14:58:11 INFO  ---RUNTIME: Importing and monkey-patching took 5.836009979248047 ms
2022-09-21 14:58:13 INFO  ---RUNTIME: Original pipeline execution took 2190.720319747925 ms (excluding imports and monkey-patching)
2022-09-21 14:58:13 INFO  Starting execution of 1 what-if analyses...
2022-09-21 14:58:13 INFO  Start plan generation for analysis DataCorruption...
2022-09-21 14:58:13 INFO  ---RUNTIME: Plan generation took 0.4138946533203125 ms
2022-09-21 14:58:13 INFO  Estimated runtime of original DAG is 1750.558614730835ms
2022-09-21 14:58:13 WARNING Skipping Multi-Query Optimization (instead, only applying patches)
2022-09-21 14:58:13 INFO  Estimated unoptimised what-if runtime is 52516.75844192505ms
2022-09-21 14:58:13 INFO  ---RUNTIME: Multi-Query Optimization took 21.47054672241211 ms
2022-09-21 14:58:13 INFO  Executing generated plans
2022-09-21 14:59:07 INFO  ---RUNTIME: Execution took 54006.0977935791 ms
2022-09-21 14:59:07 INFO  Done!
2022-09-21 14:59:07 INFO  # Finished -- repetition 2 of 7 
2022-09-21 14:59:07 INFO  # Optimization benchmark for data_corruption with args [['healthcare', 'slow_loading', 'featurization_1', 'logistic_regression']] -- repetition 3 of 7
2022-09-21 14:59:07 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-21 14:59:07 INFO  Running instrumented original pipeline...
2022-09-21 14:59:07 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-21 14:59:07 INFO  ---RUNTIME: Importing and monkey-patching took 6.19053840637207 ms
2022-09-21 14:59:09 INFO  ---RUNTIME: Original pipeline execution took 2004.9424171447754 ms (excluding imports and monkey-patching)
2022-09-21 14:59:09 INFO  Starting execution of 1 what-if analyses...
2022-09-21 14:59:09 INFO  Start plan generation for analysis DataCorruption...
2022-09-21 14:59:09 INFO  ---RUNTIME: Plan generation took 0.4954338073730469 ms
2022-09-21 14:59:09 INFO  Estimated runtime of original DAG is 1755.3071975708008ms
2022-09-21 14:59:09 INFO  Performing Multi-Query Optimization
2022-09-21 14:59:09 INFO  Estimated unoptimized what-if runtime is 52659.21592712402ms
2022-09-21 14:59:09 INFO  Estimated optimised what-if runtime is 1802.7405738830566ms
2022-09-21 14:59:09 INFO  Estimated optimisation runtime saving is 50856.47535324097ms
2022-09-21 14:59:09 INFO  ---RUNTIME: Multi-Query Optimization took 77.1172046661377 ms
2022-09-21 14:59:09 INFO  Executing generated plans
2022-09-21 14:59:11 INFO  ---RUNTIME: Execution took 1896.5494632720947 ms
2022-09-21 14:59:11 INFO  Done!
2022-09-21 14:59:11 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-21 14:59:11 INFO  Running instrumented original pipeline...
2022-09-21 14:59:11 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-21 14:59:11 INFO  ---RUNTIME: Importing and monkey-patching took 5.694866180419922 ms
2022-09-21 14:59:13 INFO  ---RUNTIME: Original pipeline execution took 1987.9367351531982 ms (excluding imports and monkey-patching)
2022-09-21 14:59:13 INFO  Starting execution of 1 what-if analyses...
2022-09-21 14:59:13 INFO  Start plan generation for analysis DataCorruption...
2022-09-21 14:59:13 INFO  ---RUNTIME: Plan generation took 0.5168914794921875 ms
2022-09-21 14:59:13 INFO  Estimated runtime of original DAG is 1739.454746246338ms
2022-09-21 14:59:13 WARNING Skipping Multi-Query Optimization (instead, only applying patches)
2022-09-21 14:59:13 INFO  Estimated unoptimised what-if runtime is 52183.64238739014ms
2022-09-21 14:59:13 INFO  ---RUNTIME: Multi-Query Optimization took 21.39425277709961 ms
2022-09-21 14:59:13 INFO  Executing generated plans
2022-09-21 15:00:07 INFO  ---RUNTIME: Execution took 53543.015480041504 ms
2022-09-21 15:00:07 INFO  Done!
2022-09-21 15:00:07 INFO  # Finished -- repetition 3 of 7 
2022-09-21 15:00:07 INFO  # Optimization benchmark for data_corruption with args [['healthcare', 'slow_loading', 'featurization_1', 'logistic_regression']] -- repetition 4 of 7
2022-09-21 15:00:07 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-21 15:00:07 INFO  Running instrumented original pipeline...
2022-09-21 15:00:07 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-21 15:00:07 INFO  ---RUNTIME: Importing and monkey-patching took 5.97071647644043 ms
2022-09-21 15:00:09 INFO  ---RUNTIME: Original pipeline execution took 2019.8235511779785 ms (excluding imports and monkey-patching)
2022-09-21 15:00:09 INFO  Starting execution of 1 what-if analyses...
2022-09-21 15:00:09 INFO  Start plan generation for analysis DataCorruption...
2022-09-21 15:00:09 INFO  ---RUNTIME: Plan generation took 0.4718303680419922 ms
2022-09-21 15:00:09 INFO  Estimated runtime of original DAG is 1769.623041152954ms
2022-09-21 15:00:09 INFO  Performing Multi-Query Optimization
2022-09-21 15:00:09 INFO  Estimated unoptimized what-if runtime is 53088.69123458862ms
2022-09-21 15:00:09 INFO  Estimated optimised what-if runtime is 1817.0206546783447ms
2022-09-21 15:00:09 INFO  Estimated optimisation runtime saving is 51271.67057991028ms
2022-09-21 15:00:09 INFO  ---RUNTIME: Multi-Query Optimization took 77.28219032287598 ms
2022-09-21 15:00:09 INFO  Executing generated plans
2022-09-21 15:00:11 INFO  ---RUNTIME: Execution took 1884.3750953674316 ms
2022-09-21 15:00:11 INFO  Done!
2022-09-21 15:00:11 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-21 15:00:11 INFO  Running instrumented original pipeline...
2022-09-21 15:00:11 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-21 15:00:11 INFO  ---RUNTIME: Importing and monkey-patching took 6.134271621704102 ms
2022-09-21 15:00:13 INFO  ---RUNTIME: Original pipeline execution took 2214.138984680176 ms (excluding imports and monkey-patching)
2022-09-21 15:00:13 INFO  Starting execution of 1 what-if analyses...
2022-09-21 15:00:13 INFO  Start plan generation for analysis DataCorruption...
2022-09-21 15:00:13 INFO  ---RUNTIME: Plan generation took 0.4165172576904297 ms
2022-09-21 15:00:13 INFO  Estimated runtime of original DAG is 1768.5625553131104ms
2022-09-21 15:00:13 WARNING Skipping Multi-Query Optimization (instead, only applying patches)
2022-09-21 15:00:13 INFO  Estimated unoptimised what-if runtime is 53056.87665939331ms
2022-09-21 15:00:13 INFO  ---RUNTIME: Multi-Query Optimization took 21.23427391052246 ms
2022-09-21 15:00:13 INFO  Executing generated plans
2022-09-21 15:01:07 INFO  ---RUNTIME: Execution took 53513.05437088013 ms
2022-09-21 15:01:07 INFO  Done!
2022-09-21 15:01:07 INFO  # Finished -- repetition 4 of 7 
2022-09-21 15:01:07 INFO  # Optimization benchmark for data_corruption with args [['healthcare', 'slow_loading', 'featurization_1', 'logistic_regression']] -- repetition 5 of 7
2022-09-21 15:01:07 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-21 15:01:07 INFO  Running instrumented original pipeline...
2022-09-21 15:01:07 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-21 15:01:07 INFO  ---RUNTIME: Importing and monkey-patching took 6.16455078125 ms
2022-09-21 15:01:09 INFO  ---RUNTIME: Original pipeline execution took 2023.3163833618164 ms (excluding imports and monkey-patching)
2022-09-21 15:01:09 INFO  Starting execution of 1 what-if analyses...
2022-09-21 15:01:09 INFO  Start plan generation for analysis DataCorruption...
2022-09-21 15:01:09 INFO  ---RUNTIME: Plan generation took 0.5004405975341797 ms
2022-09-21 15:01:09 INFO  Estimated runtime of original DAG is 1774.1343975067139ms
2022-09-21 15:01:09 INFO  Performing Multi-Query Optimization
2022-09-21 15:01:09 INFO  Estimated unoptimized what-if runtime is 53224.031925201416ms
2022-09-21 15:01:09 INFO  Estimated optimised what-if runtime is 1821.5274810791016ms
2022-09-21 15:01:09 INFO  Estimated optimisation runtime saving is 51402.504444122314ms
2022-09-21 15:01:09 INFO  ---RUNTIME: Multi-Query Optimization took 78.47762107849121 ms
2022-09-21 15:01:09 INFO  Executing generated plans
2022-09-21 15:01:11 INFO  ---RUNTIME: Execution took 1884.9432468414307 ms
2022-09-21 15:01:11 INFO  Done!
2022-09-21 15:01:11 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-21 15:01:11 INFO  Running instrumented original pipeline...
2022-09-21 15:01:11 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-21 15:01:11 INFO  ---RUNTIME: Importing and monkey-patching took 5.482912063598633 ms
2022-09-21 15:01:13 INFO  ---RUNTIME: Original pipeline execution took 2041.8941974639893 ms (excluding imports and monkey-patching)
2022-09-21 15:01:13 INFO  Starting execution of 1 what-if analyses...
2022-09-21 15:01:13 INFO  Start plan generation for analysis DataCorruption...
2022-09-21 15:01:13 INFO  ---RUNTIME: Plan generation took 0.48041343688964844 ms
2022-09-21 15:01:13 INFO  Estimated runtime of original DAG is 1792.6957607269287ms
2022-09-21 15:01:13 WARNING Skipping Multi-Query Optimization (instead, only applying patches)
2022-09-21 15:01:13 INFO  Estimated unoptimised what-if runtime is 53780.87282180786ms
2022-09-21 15:01:13 INFO  ---RUNTIME: Multi-Query Optimization took 21.215438842773438 ms
2022-09-21 15:01:13 INFO  Executing generated plans
2022-09-21 15:02:06 INFO  ---RUNTIME: Execution took 53734.62009429932 ms
2022-09-21 15:02:06 INFO  Done!
2022-09-21 15:02:06 INFO  # Finished -- repetition 5 of 7 
2022-09-21 15:02:06 INFO  # Optimization benchmark for data_corruption with args [['healthcare', 'slow_loading', 'featurization_1', 'logistic_regression']] -- repetition 6 of 7
2022-09-21 15:02:06 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-21 15:02:06 INFO  Running instrumented original pipeline...
2022-09-21 15:02:07 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-21 15:02:07 INFO  ---RUNTIME: Importing and monkey-patching took 5.990505218505859 ms
2022-09-21 15:02:08 INFO  ---RUNTIME: Original pipeline execution took 1997.5948333740234 ms (excluding imports and monkey-patching)
2022-09-21 15:02:08 INFO  Starting execution of 1 what-if analyses...
2022-09-21 15:02:08 INFO  Start plan generation for analysis DataCorruption...
2022-09-21 15:02:08 INFO  ---RUNTIME: Plan generation took 0.4839897155761719 ms
2022-09-21 15:02:08 INFO  Estimated runtime of original DAG is 1748.8410472869873ms
2022-09-21 15:02:08 INFO  Performing Multi-Query Optimization
2022-09-21 15:02:09 INFO  Estimated unoptimized what-if runtime is 52465.23141860962ms
2022-09-21 15:02:09 INFO  Estimated optimised what-if runtime is 1796.314001083374ms
2022-09-21 15:02:09 INFO  Estimated optimisation runtime saving is 50668.917417526245ms
2022-09-21 15:02:09 INFO  ---RUNTIME: Multi-Query Optimization took 77.00729370117188 ms
2022-09-21 15:02:09 INFO  Executing generated plans
2022-09-21 15:02:11 INFO  ---RUNTIME: Execution took 1939.2523765563965 ms
2022-09-21 15:02:11 INFO  Done!
2022-09-21 15:02:11 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-21 15:02:11 INFO  Running instrumented original pipeline...
2022-09-21 15:02:11 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-21 15:02:11 INFO  ---RUNTIME: Importing and monkey-patching took 6.278276443481445 ms
2022-09-21 15:02:13 INFO  ---RUNTIME: Original pipeline execution took 2259.0110301971436 ms (excluding imports and monkey-patching)
2022-09-21 15:02:13 INFO  Starting execution of 1 what-if analyses...
2022-09-21 15:02:13 INFO  Start plan generation for analysis DataCorruption...
2022-09-21 15:02:13 INFO  ---RUNTIME: Plan generation took 0.4563331604003906 ms
2022-09-21 15:02:13 INFO  Estimated runtime of original DAG is 1806.6613674163818ms
2022-09-21 15:02:13 WARNING Skipping Multi-Query Optimization (instead, only applying patches)
2022-09-21 15:02:13 INFO  Estimated unoptimised what-if runtime is 54199.841022491455ms
2022-09-21 15:02:13 INFO  ---RUNTIME: Multi-Query Optimization took 21.29340171813965 ms
2022-09-21 15:02:13 INFO  Executing generated plans
2022-09-21 15:03:06 INFO  ---RUNTIME: Execution took 53452.712535858154 ms
2022-09-21 15:03:06 INFO  Done!
2022-09-21 15:03:06 INFO  # Finished -- repetition 6 of 7 
2022-09-21 15:03:06 INFO  # Optimization benchmark for data_corruption with args [['healthcare', 'slow_loading', 'featurization_1', 'logistic_regression']] -- repetition 7 of 7
2022-09-21 15:03:06 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-21 15:03:06 INFO  Running instrumented original pipeline...
2022-09-21 15:03:06 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-21 15:03:06 INFO  ---RUNTIME: Importing and monkey-patching took 5.922794342041016 ms
2022-09-21 15:03:08 INFO  ---RUNTIME: Original pipeline execution took 1997.7128505706787 ms (excluding imports and monkey-patching)
2022-09-21 15:03:08 INFO  Starting execution of 1 what-if analyses...
2022-09-21 15:03:08 INFO  Start plan generation for analysis DataCorruption...
2022-09-21 15:03:08 INFO  ---RUNTIME: Plan generation took 0.8299350738525391 ms
2022-09-21 15:03:08 INFO  Estimated runtime of original DAG is 1749.4170665740967ms
2022-09-21 15:03:08 INFO  Performing Multi-Query Optimization
2022-09-21 15:03:08 INFO  Estimated unoptimized what-if runtime is 52482.5119972229ms
2022-09-21 15:03:08 INFO  Estimated optimised what-if runtime is 1797.5363731384277ms
2022-09-21 15:03:08 INFO  Estimated optimisation runtime saving is 50684.97562408447ms
2022-09-21 15:03:08 INFO  ---RUNTIME: Multi-Query Optimization took 86.8375301361084 ms
2022-09-21 15:03:08 INFO  Executing generated plans
2022-09-21 15:03:10 INFO  ---RUNTIME: Execution took 1877.3167133331299 ms
2022-09-21 15:03:10 INFO  Done!
2022-09-21 15:03:10 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-21 15:03:10 INFO  Running instrumented original pipeline...
2022-09-21 15:03:10 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-21 15:03:10 INFO  ---RUNTIME: Importing and monkey-patching took 5.461215972900391 ms
2022-09-21 15:03:12 INFO  ---RUNTIME: Original pipeline execution took 2019.519329071045 ms (excluding imports and monkey-patching)
2022-09-21 15:03:12 INFO  Starting execution of 1 what-if analyses...
2022-09-21 15:03:12 INFO  Start plan generation for analysis DataCorruption...
2022-09-21 15:03:12 INFO  ---RUNTIME: Plan generation took 0.4475116729736328 ms
2022-09-21 15:03:12 INFO  Estimated runtime of original DAG is 1769.7606086730957ms
2022-09-21 15:03:12 WARNING Skipping Multi-Query Optimization (instead, only applying patches)
2022-09-21 15:03:12 INFO  Estimated unoptimised what-if runtime is 53092.81826019287ms
2022-09-21 15:03:12 INFO  ---RUNTIME: Multi-Query Optimization took 21.25835418701172 ms
2022-09-21 15:03:12 INFO  Executing generated plans
2022-09-21 15:04:07 INFO  ---RUNTIME: Execution took 54348.509073257446 ms
2022-09-21 15:04:07 INFO  Done!
2022-09-21 15:04:07 INFO  # Finished -- repetition 7 of 7 
2022-09-21 15:04:07 INFO  # Final results after all repetitions
2022-09-21 15:04:07 INFO     repetition  ... no_opt_what_if_execution_combined_model_training
0           0  ...                                        34.588814
1           1  ...                                        34.665585
2           2  ...                                        33.554554
3           3  ...                                        32.467842
4           4  ...                                        32.455206
5           5  ...                                        32.510042
6           6  ...                                        32.394648

[7 rows x 26 columns]
taskset -c 0-7 PROTOCOL_BUFFERS_PYTHON_IMPLEMENTATION=python python3.9 benchmarks_end_to_end.py data_corruption healthcare slow_loading featurization_1 xgboost
2022-09-21 15:04:09.194988: W tensorflow/stream_executor/platform/default/dso_loader.cc:64] Could not load dynamic library 'libcudart.so.11.0'; dlerror: libcudart.so.11.0: cannot open shared object file: No such file or directory; LD_LIBRARY_PATH: /home/sgrafbe/mlwhatif/venv/lib/python3.9/site-packages/cv2/../../lib64:
2022-09-21 15:04:09.195033: I tensorflow/stream_executor/cuda/cudart_stub.cc:29] Ignore above cudart dlerror if you do not have a GPU set up on your machine.
2022-09-21 15:04:10 INFO  Patching sys.argv with ['mlwhatif', 'healthcare', 'slow_loading', 'featurization_1', 'xgboost']
2022-09-21 15:04:10 INFO  Running instrumented original pipeline...
2022-09-21 15:04:10 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-21 15:04:10 INFO  ---RUNTIME: Importing and monkey-patching took 95.44014930725098 ms
2022-09-21 15:04:12 INFO  ---RUNTIME: Original pipeline execution took 2368.69740486145 ms (excluding imports and monkey-patching)
2022-09-21 15:04:12 INFO  Starting execution of 0 what-if analyses...
2022-09-21 15:04:12 INFO  Estimated runtime of original DAG is 2076.785087585449ms
2022-09-21 15:04:12 INFO  Performing Multi-Query Optimization
2022-09-21 15:04:12 INFO  Estimated unoptimized what-if runtime is 0ms
2022-09-21 15:04:12 INFO  Estimated optimised what-if runtime is 0ms
2022-09-21 15:04:12 INFO  Estimated optimisation runtime saving is 0ms
2022-09-21 15:04:12 INFO  ---RUNTIME: Multi-Query Optimization took 0.4489421844482422 ms
2022-09-21 15:04:12 INFO  Executing generated plans
2022-09-21 15:04:12 INFO  ---RUNTIME: Execution took 0.021219253540039062 ms
2022-09-21 15:04:12 INFO  Done!
2022-09-21 15:04:12 INFO  # Optimization benchmark for data_corruption with args [['healthcare', 'slow_loading', 'featurization_1', 'xgboost']] -- repetition 1 of 7
2022-09-21 15:04:12 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-21 15:04:12 INFO  Running instrumented original pipeline...
2022-09-21 15:04:12 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-21 15:04:12 INFO  ---RUNTIME: Importing and monkey-patching took 5.1116943359375 ms
2022-09-21 15:04:15 INFO  ---RUNTIME: Original pipeline execution took 2196.481466293335 ms (excluding imports and monkey-patching)
2022-09-21 15:04:15 INFO  Starting execution of 1 what-if analyses...
2022-09-21 15:04:15 INFO  Start plan generation for analysis DataCorruption...
2022-09-21 15:04:15 INFO  ---RUNTIME: Plan generation took 0.46062469482421875 ms
2022-09-21 15:04:15 INFO  Estimated runtime of original DAG is 1935.2827072143555ms
2022-09-21 15:04:15 INFO  Performing Multi-Query Optimization
2022-09-21 15:04:15 INFO  Estimated unoptimized what-if runtime is 58058.481216430664ms
2022-09-21 15:04:15 INFO  Estimated optimised what-if runtime is 2027.3168087005615ms
2022-09-21 15:04:15 INFO  Estimated optimisation runtime saving is 56031.1644077301ms
2022-09-21 15:04:15 INFO  ---RUNTIME: Multi-Query Optimization took 76.82633399963379 ms
2022-09-21 15:04:15 INFO  Executing generated plans
2022-09-21 15:04:17 INFO  ---RUNTIME: Execution took 2108.9251041412354 ms
2022-09-21 15:04:17 INFO  Done!
2022-09-21 15:04:17 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-21 15:04:17 INFO  Running instrumented original pipeline...
2022-09-21 15:04:17 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-21 15:04:17 INFO  ---RUNTIME: Importing and monkey-patching took 5.7392120361328125 ms
2022-09-21 15:04:19 INFO  ---RUNTIME: Original pipeline execution took 2359.710931777954 ms (excluding imports and monkey-patching)
2022-09-21 15:04:19 INFO  Starting execution of 1 what-if analyses...
2022-09-21 15:04:19 INFO  Start plan generation for analysis DataCorruption...
2022-09-21 15:04:19 INFO  ---RUNTIME: Plan generation took 0.6277561187744141 ms
2022-09-21 15:04:19 INFO  Estimated runtime of original DAG is 1937.2663497924805ms
2022-09-21 15:04:19 WARNING Skipping Multi-Query Optimization (instead, only applying patches)
2022-09-21 15:04:19 INFO  Estimated unoptimised what-if runtime is 58117.990493774414ms
2022-09-21 15:04:19 INFO  ---RUNTIME: Multi-Query Optimization took 20.771503448486328 ms
2022-09-21 15:04:19 INFO  Executing generated plans
2022-09-21 15:05:18 INFO  ---RUNTIME: Execution took 59330.43646812439 ms
2022-09-21 15:05:18 INFO  Done!
2022-09-21 15:05:18 INFO  # Finished -- repetition 1 of 7 
2022-09-21 15:05:18 INFO  # Optimization benchmark for data_corruption with args [['healthcare', 'slow_loading', 'featurization_1', 'xgboost']] -- repetition 2 of 7
2022-09-21 15:05:18 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-21 15:05:18 INFO  Running instrumented original pipeline...
2022-09-21 15:05:19 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-21 15:05:19 INFO  ---RUNTIME: Importing and monkey-patching took 5.865812301635742 ms
2022-09-21 15:05:21 INFO  ---RUNTIME: Original pipeline execution took 2213.733434677124 ms (excluding imports and monkey-patching)
2022-09-21 15:05:21 INFO  Starting execution of 1 what-if analyses...
2022-09-21 15:05:21 INFO  Start plan generation for analysis DataCorruption...
2022-09-21 15:05:21 INFO  ---RUNTIME: Plan generation took 0.45752525329589844 ms
2022-09-21 15:05:21 INFO  Estimated runtime of original DAG is 1954.685926437378ms
2022-09-21 15:05:21 INFO  Performing Multi-Query Optimization
2022-09-21 15:05:21 INFO  Estimated unoptimized what-if runtime is 58640.57779312134ms
2022-09-21 15:05:21 INFO  Estimated optimised what-if runtime is 2046.1387634277344ms
2022-09-21 15:05:21 INFO  Estimated optimisation runtime saving is 56594.4390296936ms
2022-09-21 15:05:21 INFO  ---RUNTIME: Multi-Query Optimization took 78.37700843811035 ms
2022-09-21 15:05:21 INFO  Executing generated plans
2022-09-21 15:05:23 INFO  ---RUNTIME: Execution took 2113.3763790130615 ms
2022-09-21 15:05:23 INFO  Done!
2022-09-21 15:05:23 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-21 15:05:23 INFO  Running instrumented original pipeline...
2022-09-21 15:05:23 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-21 15:05:23 INFO  ---RUNTIME: Importing and monkey-patching took 5.7811737060546875 ms
2022-09-21 15:05:25 INFO  ---RUNTIME: Original pipeline execution took 2386.4026069641113 ms (excluding imports and monkey-patching)
2022-09-21 15:05:25 INFO  Starting execution of 1 what-if analyses...
2022-09-21 15:05:25 INFO  Start plan generation for analysis DataCorruption...
2022-09-21 15:05:25 INFO  ---RUNTIME: Plan generation took 0.41937828063964844 ms
2022-09-21 15:05:25 INFO  Estimated runtime of original DAG is 1955.8591842651367ms
2022-09-21 15:05:25 WARNING Skipping Multi-Query Optimization (instead, only applying patches)
2022-09-21 15:05:25 INFO  Estimated unoptimised what-if runtime is 58675.7755279541ms
2022-09-21 15:05:25 INFO  ---RUNTIME: Multi-Query Optimization took 21.354198455810547 ms
2022-09-21 15:05:25 INFO  Executing generated plans
2022-09-21 15:06:26 INFO  ---RUNTIME: Execution took 60291.348695755005 ms
2022-09-21 15:06:26 INFO  Done!
2022-09-21 15:06:26 INFO  # Finished -- repetition 2 of 7 
2022-09-21 15:06:26 INFO  # Optimization benchmark for data_corruption with args [['healthcare', 'slow_loading', 'featurization_1', 'xgboost']] -- repetition 3 of 7
2022-09-21 15:06:26 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-21 15:06:26 INFO  Running instrumented original pipeline...
2022-09-21 15:06:26 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-21 15:06:26 INFO  ---RUNTIME: Importing and monkey-patching took 5.91278076171875 ms
2022-09-21 15:06:28 INFO  ---RUNTIME: Original pipeline execution took 2214.9243354797363 ms (excluding imports and monkey-patching)
2022-09-21 15:06:28 INFO  Starting execution of 1 what-if analyses...
2022-09-21 15:06:28 INFO  Start plan generation for analysis DataCorruption...
2022-09-21 15:06:28 INFO  ---RUNTIME: Plan generation took 0.4756450653076172 ms
2022-09-21 15:06:28 INFO  Estimated runtime of original DAG is 1953.30810546875ms
2022-09-21 15:06:28 INFO  Performing Multi-Query Optimization
2022-09-21 15:06:28 INFO  Estimated unoptimized what-if runtime is 58599.2431640625ms
2022-09-21 15:06:28 INFO  Estimated optimised what-if runtime is 2222.855567932129ms
2022-09-21 15:06:28 INFO  Estimated optimisation runtime saving is 56376.38759613037ms
2022-09-21 15:06:28 INFO  ---RUNTIME: Multi-Query Optimization took 76.4925479888916 ms
2022-09-21 15:06:28 INFO  Executing generated plans
2022-09-21 15:06:30 INFO  ---RUNTIME: Execution took 2187.5429153442383 ms
2022-09-21 15:06:30 INFO  Done!
2022-09-21 15:06:30 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-21 15:06:30 INFO  Running instrumented original pipeline...
2022-09-21 15:06:30 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-21 15:06:30 INFO  ---RUNTIME: Importing and monkey-patching took 5.6056976318359375 ms
2022-09-21 15:06:32 INFO  ---RUNTIME: Original pipeline execution took 2198.0042457580566 ms (excluding imports and monkey-patching)
2022-09-21 15:06:32 INFO  Starting execution of 1 what-if analyses...
2022-09-21 15:06:32 INFO  Start plan generation for analysis DataCorruption...
2022-09-21 15:06:32 INFO  ---RUNTIME: Plan generation took 0.4825592041015625 ms
2022-09-21 15:06:32 INFO  Estimated runtime of original DAG is 1935.638666152954ms
2022-09-21 15:06:32 WARNING Skipping Multi-Query Optimization (instead, only applying patches)
2022-09-21 15:06:32 INFO  Estimated unoptimised what-if runtime is 58069.15998458862ms
2022-09-21 15:06:32 INFO  ---RUNTIME: Multi-Query Optimization took 21.358251571655273 ms
2022-09-21 15:06:32 INFO  Executing generated plans
2022-09-21 15:07:35 INFO  ---RUNTIME: Execution took 62708.348751068115 ms
2022-09-21 15:07:35 INFO  Done!
2022-09-21 15:07:35 INFO  # Finished -- repetition 3 of 7 
2022-09-21 15:07:35 INFO  # Optimization benchmark for data_corruption with args [['healthcare', 'slow_loading', 'featurization_1', 'xgboost']] -- repetition 4 of 7
2022-09-21 15:07:35 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-21 15:07:35 INFO  Running instrumented original pipeline...
2022-09-21 15:07:35 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-21 15:07:35 INFO  ---RUNTIME: Importing and monkey-patching took 6.072044372558594 ms
2022-09-21 15:07:37 INFO  ---RUNTIME: Original pipeline execution took 2239.9208545684814 ms (excluding imports and monkey-patching)
2022-09-21 15:07:37 INFO  Starting execution of 1 what-if analyses...
2022-09-21 15:07:37 INFO  Start plan generation for analysis DataCorruption...
2022-09-21 15:07:37 INFO  ---RUNTIME: Plan generation took 0.4973411560058594 ms
2022-09-21 15:07:37 INFO  Estimated runtime of original DAG is 1981.6205501556396ms
2022-09-21 15:07:37 INFO  Performing Multi-Query Optimization
2022-09-21 15:07:37 INFO  Estimated unoptimized what-if runtime is 59448.61650466919ms
2022-09-21 15:07:37 INFO  Estimated optimised what-if runtime is 2073.4732151031494ms
2022-09-21 15:07:37 INFO  Estimated optimisation runtime saving is 57375.14328956604ms
2022-09-21 15:07:37 INFO  ---RUNTIME: Multi-Query Optimization took 76.83467864990234 ms
2022-09-21 15:07:37 INFO  Executing generated plans
2022-09-21 15:07:40 INFO  ---RUNTIME: Execution took 2143.9592838287354 ms
2022-09-21 15:07:40 INFO  Done!
2022-09-21 15:07:40 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-21 15:07:40 INFO  Running instrumented original pipeline...
2022-09-21 15:07:40 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-21 15:07:40 INFO  ---RUNTIME: Importing and monkey-patching took 5.918264389038086 ms
2022-09-21 15:07:42 INFO  ---RUNTIME: Original pipeline execution took 2443.9868927001953 ms (excluding imports and monkey-patching)
2022-09-21 15:07:42 INFO  Starting execution of 1 what-if analyses...
2022-09-21 15:07:42 INFO  Start plan generation for analysis DataCorruption...
2022-09-21 15:07:42 INFO  ---RUNTIME: Plan generation took 0.4878044128417969 ms
2022-09-21 15:07:42 INFO  Estimated runtime of original DAG is 1974.7543334960938ms
2022-09-21 15:07:42 WARNING Skipping Multi-Query Optimization (instead, only applying patches)
2022-09-21 15:07:42 INFO  Estimated unoptimised what-if runtime is 59242.63000488281ms
2022-09-21 15:07:42 INFO  ---RUNTIME: Multi-Query Optimization took 21.592378616333008 ms
2022-09-21 15:07:42 INFO  Executing generated plans
2022-09-21 15:08:44 INFO  ---RUNTIME: Execution took 61632.53140449524 ms
2022-09-21 15:08:44 INFO  Done!
2022-09-21 15:08:44 INFO  # Finished -- repetition 4 of 7 
2022-09-21 15:08:44 INFO  # Optimization benchmark for data_corruption with args [['healthcare', 'slow_loading', 'featurization_1', 'xgboost']] -- repetition 5 of 7
2022-09-21 15:08:44 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-21 15:08:44 INFO  Running instrumented original pipeline...
2022-09-21 15:08:44 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-21 15:08:44 INFO  ---RUNTIME: Importing and monkey-patching took 6.072759628295898 ms
2022-09-21 15:08:46 INFO  ---RUNTIME: Original pipeline execution took 2231.456995010376 ms (excluding imports and monkey-patching)
2022-09-21 15:08:46 INFO  Starting execution of 1 what-if analyses...
2022-09-21 15:08:46 INFO  Start plan generation for analysis DataCorruption...
2022-09-21 15:08:46 INFO  ---RUNTIME: Plan generation took 0.49376487731933594 ms
2022-09-21 15:08:46 INFO  Estimated runtime of original DAG is 1969.2156314849854ms
2022-09-21 15:08:46 INFO  Performing Multi-Query Optimization
2022-09-21 15:08:46 INFO  Estimated unoptimized what-if runtime is 59076.46894454956ms
2022-09-21 15:08:46 INFO  Estimated optimised what-if runtime is 2060.7731342315674ms
2022-09-21 15:08:46 INFO  Estimated optimisation runtime saving is 57015.69581031799ms
2022-09-21 15:08:46 INFO  ---RUNTIME: Multi-Query Optimization took 76.63893699645996 ms
2022-09-21 15:08:46 INFO  Executing generated plans
2022-09-21 15:08:48 INFO  ---RUNTIME: Execution took 2151.7937183380127 ms
2022-09-21 15:08:48 INFO  Done!
2022-09-21 15:08:48 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-21 15:08:48 INFO  Running instrumented original pipeline...
2022-09-21 15:08:48 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-21 15:08:48 INFO  ---RUNTIME: Importing and monkey-patching took 6.469011306762695 ms
2022-09-21 15:08:50 INFO  ---RUNTIME: Original pipeline execution took 2233.0727577209473 ms (excluding imports and monkey-patching)
2022-09-21 15:08:50 INFO  Starting execution of 1 what-if analyses...
2022-09-21 15:08:50 INFO  Start plan generation for analysis DataCorruption...
2022-09-21 15:08:50 INFO  ---RUNTIME: Plan generation took 0.49185752868652344 ms
2022-09-21 15:08:50 INFO  Estimated runtime of original DAG is 1951.5860080718994ms
2022-09-21 15:08:50 WARNING Skipping Multi-Query Optimization (instead, only applying patches)
2022-09-21 15:08:50 INFO  Estimated unoptimised what-if runtime is 58547.58024215698ms
2022-09-21 15:08:50 INFO  ---RUNTIME: Multi-Query Optimization took 21.218299865722656 ms
2022-09-21 15:08:50 INFO  Executing generated plans
2022-09-21 15:09:54 INFO  ---RUNTIME: Execution took 63550.47249794006 ms
2022-09-21 15:09:54 INFO  Done!
2022-09-21 15:09:54 INFO  # Finished -- repetition 5 of 7 
2022-09-21 15:09:54 INFO  # Optimization benchmark for data_corruption with args [['healthcare', 'slow_loading', 'featurization_1', 'xgboost']] -- repetition 6 of 7
2022-09-21 15:09:54 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-21 15:09:54 INFO  Running instrumented original pipeline...
2022-09-21 15:09:54 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-21 15:09:54 INFO  ---RUNTIME: Importing and monkey-patching took 6.090641021728516 ms
2022-09-21 15:09:56 INFO  ---RUNTIME: Original pipeline execution took 2226.2585163116455 ms (excluding imports and monkey-patching)
2022-09-21 15:09:56 INFO  Starting execution of 1 what-if analyses...
2022-09-21 15:09:56 INFO  Start plan generation for analysis DataCorruption...
2022-09-21 15:09:56 INFO  ---RUNTIME: Plan generation took 0.5156993865966797 ms
2022-09-21 15:09:56 INFO  Estimated runtime of original DAG is 1965.1010036468506ms
2022-09-21 15:09:56 INFO  Performing Multi-Query Optimization
2022-09-21 15:09:56 INFO  Estimated unoptimized what-if runtime is 58953.03010940552ms
2022-09-21 15:09:56 INFO  Estimated optimised what-if runtime is 2058.102607727051ms
2022-09-21 15:09:56 INFO  Estimated optimisation runtime saving is 56894.92750167847ms
2022-09-21 15:09:56 INFO  ---RUNTIME: Multi-Query Optimization took 76.7369270324707 ms
2022-09-21 15:09:56 INFO  Executing generated plans
2022-09-21 15:09:58 INFO  ---RUNTIME: Execution took 2156.4996242523193 ms
2022-09-21 15:09:58 INFO  Done!
2022-09-21 15:09:58 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-21 15:09:58 INFO  Running instrumented original pipeline...
2022-09-21 15:09:59 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-21 15:09:59 INFO  ---RUNTIME: Importing and monkey-patching took 6.349086761474609 ms
2022-09-21 15:10:01 INFO  ---RUNTIME: Original pipeline execution took 2468.4128761291504 ms (excluding imports and monkey-patching)
2022-09-21 15:10:01 INFO  Starting execution of 1 what-if analyses...
2022-09-21 15:10:01 INFO  Start plan generation for analysis DataCorruption...
2022-09-21 15:10:01 INFO  ---RUNTIME: Plan generation took 0.4947185516357422 ms
2022-09-21 15:10:01 INFO  Estimated runtime of original DAG is 1980.7469844818115ms
2022-09-21 15:10:01 WARNING Skipping Multi-Query Optimization (instead, only applying patches)
2022-09-21 15:10:01 INFO  Estimated unoptimised what-if runtime is 59422.409534454346ms
2022-09-21 15:10:01 INFO  ---RUNTIME: Multi-Query Optimization took 21.31199836730957 ms
2022-09-21 15:10:01 INFO  Executing generated plans
2022-09-21 15:11:02 INFO  ---RUNTIME: Execution took 60955.14416694641 ms
2022-09-21 15:11:02 INFO  Done!
2022-09-21 15:11:02 INFO  # Finished -- repetition 6 of 7 
2022-09-21 15:11:02 INFO  # Optimization benchmark for data_corruption with args [['healthcare', 'slow_loading', 'featurization_1', 'xgboost']] -- repetition 7 of 7
2022-09-21 15:11:02 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-21 15:11:02 INFO  Running instrumented original pipeline...
2022-09-21 15:11:02 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-21 15:11:02 INFO  ---RUNTIME: Importing and monkey-patching took 6.051063537597656 ms
2022-09-21 15:11:04 INFO  ---RUNTIME: Original pipeline execution took 2220.351219177246 ms (excluding imports and monkey-patching)
2022-09-21 15:11:04 INFO  Starting execution of 1 what-if analyses...
2022-09-21 15:11:04 INFO  Start plan generation for analysis DataCorruption...
2022-09-21 15:11:04 INFO  ---RUNTIME: Plan generation took 0.8916854858398438 ms
2022-09-21 15:11:04 INFO  Estimated runtime of original DAG is 1960.202693939209ms
2022-09-21 15:11:04 INFO  Performing Multi-Query Optimization
2022-09-21 15:11:04 INFO  Estimated unoptimized what-if runtime is 58806.08081817627ms
2022-09-21 15:11:04 INFO  Estimated optimised what-if runtime is 2052.1059036254883ms
2022-09-21 15:11:04 INFO  Estimated optimisation runtime saving is 56753.97491455078ms
2022-09-21 15:11:04 INFO  ---RUNTIME: Multi-Query Optimization took 76.24936103820801 ms
2022-09-21 15:11:04 INFO  Executing generated plans
2022-09-21 15:11:06 INFO  ---RUNTIME: Execution took 2128.9522647857666 ms
2022-09-21 15:11:06 INFO  Done!
2022-09-21 15:11:06 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-21 15:11:06 INFO  Running instrumented original pipeline...
2022-09-21 15:11:06 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-21 15:11:06 INFO  ---RUNTIME: Importing and monkey-patching took 5.928516387939453 ms
2022-09-21 15:11:09 INFO  ---RUNTIME: Original pipeline execution took 2243.354082107544 ms (excluding imports and monkey-patching)
2022-09-21 15:11:09 INFO  Starting execution of 1 what-if analyses...
2022-09-21 15:11:09 INFO  Start plan generation for analysis DataCorruption...
2022-09-21 15:11:09 INFO  ---RUNTIME: Plan generation took 0.5018711090087891 ms
2022-09-21 15:11:09 INFO  Estimated runtime of original DAG is 1982.0818901062012ms
2022-09-21 15:11:09 WARNING Skipping Multi-Query Optimization (instead, only applying patches)
2022-09-21 15:11:09 INFO  Estimated unoptimised what-if runtime is 59462.456703186035ms
2022-09-21 15:11:09 INFO  ---RUNTIME: Multi-Query Optimization took 22.32217788696289 ms
2022-09-21 15:11:09 INFO  Executing generated plans
2022-09-21 15:12:11 INFO  ---RUNTIME: Execution took 62445.762634277344 ms
2022-09-21 15:12:11 INFO  Done!
2022-09-21 15:12:11 INFO  # Finished -- repetition 7 of 7 
2022-09-21 15:12:11 INFO  # Final results after all repetitions
2022-09-21 15:12:11 INFO     repetition  ... no_opt_what_if_execution_combined_model_training
0           0  ...                                      5534.329414
1           1  ...                                      5541.033268
2           2  ...                                      7909.735680
3           3  ...                                      6403.818369
4           4  ...                                      8364.992380
5           5  ...                                      5686.709404
6           6  ...                                      7673.775196

[7 rows x 26 columns]
taskset -c 0-7 PROTOCOL_BUFFERS_PYTHON_IMPLEMENTATION=python python3.9 benchmarks_end_to_end.py data_corruption healthcare slow_loading featurization_1 neural_network
2022-09-21 15:12:13.555964: W tensorflow/stream_executor/platform/default/dso_loader.cc:64] Could not load dynamic library 'libcudart.so.11.0'; dlerror: libcudart.so.11.0: cannot open shared object file: No such file or directory; LD_LIBRARY_PATH: /home/sgrafbe/mlwhatif/venv/lib/python3.9/site-packages/cv2/../../lib64:
2022-09-21 15:12:13.556008: I tensorflow/stream_executor/cuda/cudart_stub.cc:29] Ignore above cudart dlerror if you do not have a GPU set up on your machine.
2022-09-21 15:12:14 INFO  Patching sys.argv with ['mlwhatif', 'healthcare', 'slow_loading', 'featurization_1', 'neural_network']
2022-09-21 15:12:14 INFO  Running instrumented original pipeline...
2022-09-21 15:12:14 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-21 15:12:14 INFO  ---RUNTIME: Importing and monkey-patching took 102.61750221252441 ms
2022-09-21 15:12:17.058170: W tensorflow/stream_executor/platform/default/dso_loader.cc:64] Could not load dynamic library 'libcuda.so.1'; dlerror: libcuda.so.1: cannot open shared object file: No such file or directory; LD_LIBRARY_PATH: /home/sgrafbe/mlwhatif/venv/lib/python3.9/site-packages/cv2/../../lib64:
2022-09-21 15:12:17.058203: W tensorflow/stream_executor/cuda/cuda_driver.cc:326] failed call to cuInit: UNKNOWN ERROR (303)
2022-09-21 15:12:17.058223: I tensorflow/stream_executor/cuda/cuda_diagnostics.cc:156] kernel driver does not appear to be running on this host (wagyu): /proc/driver/nvidia/version does not exist
2022-09-21 15:12:17.058669: I tensorflow/core/platform/cpu_feature_guard.cc:142] This TensorFlow binary is optimized with oneAPI Deep Neural Network Library (oneDNN) to use the following CPU instructions in performance-critical operations:  AVX2 FMA
To enable them in other operations, rebuild TensorFlow with the appropriate compiler flags.
2022-09-21 15:12:17.601563: I tensorflow/compiler/mlir/mlir_graph_optimization_pass.cc:176] None of the MLIR Optimization Passes are enabled (registered 2)
2022-09-21 15:12:17.615402: I tensorflow/core/platform/profile_utils/cpu_utils.cc:114] CPU Frequency: 2595290000 Hz
2022-09-21 15:12:17 INFO  ---RUNTIME: Original pipeline execution took 2899.5771408081055 ms (excluding imports and monkey-patching)
2022-09-21 15:12:17 INFO  Starting execution of 0 what-if analyses...
2022-09-21 15:12:17 INFO  Estimated runtime of original DAG is 2576.151132583618ms
2022-09-21 15:12:17 INFO  Performing Multi-Query Optimization
2022-09-21 15:12:17 INFO  Estimated unoptimized what-if runtime is 0ms
2022-09-21 15:12:17 INFO  Estimated optimised what-if runtime is 0ms
2022-09-21 15:12:17 INFO  Estimated optimisation runtime saving is 0ms
2022-09-21 15:12:17 INFO  ---RUNTIME: Multi-Query Optimization took 0.4868507385253906 ms
2022-09-21 15:12:17 INFO  Executing generated plans
2022-09-21 15:12:17 INFO  ---RUNTIME: Execution took 0.015974044799804688 ms
2022-09-21 15:12:17 INFO  Done!
2022-09-21 15:12:17 INFO  # Optimization benchmark for data_corruption with args [['healthcare', 'slow_loading', 'featurization_1', 'neural_network']] -- repetition 1 of 7
2022-09-21 15:12:17 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-21 15:12:17 INFO  Running instrumented original pipeline...
2022-09-21 15:12:17 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-21 15:12:17 INFO  ---RUNTIME: Importing and monkey-patching took 5.121946334838867 ms
2022-09-21 15:12:20 INFO  ---RUNTIME: Original pipeline execution took 2526.2439250946045 ms (excluding imports and monkey-patching)
2022-09-21 15:12:20 INFO  Starting execution of 1 what-if analyses...
2022-09-21 15:12:20 INFO  Start plan generation for analysis DataCorruption...
2022-09-21 15:12:20 INFO  ---RUNTIME: Plan generation took 0.5347728729248047 ms
2022-09-21 15:12:20 INFO  Estimated runtime of original DAG is 2260.897397994995ms
2022-09-21 15:12:20 INFO  Performing Multi-Query Optimization
2022-09-21 15:12:20 INFO  Estimated unoptimized what-if runtime is 67826.92193984985ms
2022-09-21 15:12:20 INFO  Estimated optimised what-if runtime is 3928.3816814422607ms
2022-09-21 15:12:20 INFO  Estimated optimisation runtime saving is 63898.54025840759ms
2022-09-21 15:12:20 INFO  ---RUNTIME: Multi-Query Optimization took 76.53093338012695 ms
2022-09-21 15:12:20 INFO  Executing generated plans
2022-09-21 15:12:23 INFO  ---RUNTIME: Execution took 2571.7904567718506 ms
2022-09-21 15:12:23 INFO  Done!
2022-09-21 15:12:23 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-21 15:12:23 INFO  Running instrumented original pipeline...
2022-09-21 15:12:23 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-21 15:12:23 INFO  ---RUNTIME: Importing and monkey-patching took 5.8383941650390625 ms
2022-09-21 15:12:25 INFO  ---RUNTIME: Original pipeline execution took 2800.5621433258057 ms (excluding imports and monkey-patching)
2022-09-21 15:12:25 INFO  Starting execution of 1 what-if analyses...
2022-09-21 15:12:25 INFO  Start plan generation for analysis DataCorruption...
2022-09-21 15:12:25 INFO  ---RUNTIME: Plan generation took 0.4906654357910156 ms
2022-09-21 15:12:25 INFO  Estimated runtime of original DAG is 2532.867670059204ms
2022-09-21 15:12:25 WARNING Skipping Multi-Query Optimization (instead, only applying patches)
2022-09-21 15:12:25 INFO  Estimated unoptimised what-if runtime is 75986.03010177612ms
2022-09-21 15:12:25 INFO  ---RUNTIME: Multi-Query Optimization took 21.354198455810547 ms
2022-09-21 15:12:25 INFO  Executing generated plans
2022-09-21 15:13:36 INFO  ---RUNTIME: Execution took 70620.31984329224 ms
2022-09-21 15:13:36 INFO  Done!
2022-09-21 15:13:36 INFO  # Finished -- repetition 1 of 7 
2022-09-21 15:13:36 INFO  # Optimization benchmark for data_corruption with args [['healthcare', 'slow_loading', 'featurization_1', 'neural_network']] -- repetition 2 of 7
2022-09-21 15:13:36 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-21 15:13:36 INFO  Running instrumented original pipeline...
2022-09-21 15:13:36 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-21 15:13:36 INFO  ---RUNTIME: Importing and monkey-patching took 5.877017974853516 ms
2022-09-21 15:13:39 INFO  ---RUNTIME: Original pipeline execution took 2841.6123390197754 ms (excluding imports and monkey-patching)
2022-09-21 15:13:39 INFO  Starting execution of 1 what-if analyses...
2022-09-21 15:13:39 INFO  Start plan generation for analysis DataCorruption...
2022-09-21 15:13:39 INFO  ---RUNTIME: Plan generation took 0.4897117614746094 ms
2022-09-21 15:13:39 INFO  Estimated runtime of original DAG is 2572.5393295288086ms
2022-09-21 15:13:39 INFO  Performing Multi-Query Optimization
2022-09-21 15:13:39 INFO  Estimated unoptimized what-if runtime is 77176.17988586426ms
2022-09-21 15:13:39 INFO  Estimated optimised what-if runtime is 4200.334787368774ms
2022-09-21 15:13:39 INFO  Estimated optimisation runtime saving is 72975.84509849548ms
2022-09-21 15:13:39 INFO  ---RUNTIME: Multi-Query Optimization took 76.72715187072754 ms
2022-09-21 15:13:39 INFO  Executing generated plans
2022-09-21 15:13:41 INFO  ---RUNTIME: Execution took 2572.725534439087 ms
2022-09-21 15:13:41 INFO  Done!
2022-09-21 15:13:41 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-21 15:13:41 INFO  Running instrumented original pipeline...
2022-09-21 15:13:42 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-21 15:13:42 INFO  ---RUNTIME: Importing and monkey-patching took 5.84864616394043 ms
2022-09-21 15:13:44 INFO  ---RUNTIME: Original pipeline execution took 2504.5995712280273 ms (excluding imports and monkey-patching)
2022-09-21 15:13:44 INFO  Starting execution of 1 what-if analyses...
2022-09-21 15:13:44 INFO  Start plan generation for analysis DataCorruption...
2022-09-21 15:13:44 INFO  ---RUNTIME: Plan generation took 0.5319118499755859 ms
2022-09-21 15:13:44 INFO  Estimated runtime of original DAG is 2237.067699432373ms
2022-09-21 15:13:44 WARNING Skipping Multi-Query Optimization (instead, only applying patches)
2022-09-21 15:13:44 INFO  Estimated unoptimised what-if runtime is 67112.03098297119ms
2022-09-21 15:13:44 INFO  ---RUNTIME: Multi-Query Optimization took 21.40069007873535 ms
2022-09-21 15:13:44 INFO  Executing generated plans
2022-09-21 15:14:55 INFO  ---RUNTIME: Execution took 70845.77465057373 ms
2022-09-21 15:14:55 INFO  Done!
2022-09-21 15:14:55 INFO  # Finished -- repetition 2 of 7 
2022-09-21 15:14:55 INFO  # Optimization benchmark for data_corruption with args [['healthcare', 'slow_loading', 'featurization_1', 'neural_network']] -- repetition 3 of 7
2022-09-21 15:14:55 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-21 15:14:55 INFO  Running instrumented original pipeline...
2022-09-21 15:14:55 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-21 15:14:55 INFO  ---RUNTIME: Importing and monkey-patching took 5.738735198974609 ms
2022-09-21 15:14:58 INFO  ---RUNTIME: Original pipeline execution took 2824.64599609375 ms (excluding imports and monkey-patching)
2022-09-21 15:14:58 INFO  Starting execution of 1 what-if analyses...
2022-09-21 15:14:58 INFO  Start plan generation for analysis DataCorruption...
2022-09-21 15:14:58 INFO  ---RUNTIME: Plan generation took 0.5712509155273438 ms
2022-09-21 15:14:58 INFO  Estimated runtime of original DAG is 2554.093837738037ms
2022-09-21 15:14:58 INFO  Performing Multi-Query Optimization
2022-09-21 15:14:58 INFO  Estimated unoptimized what-if runtime is 76622.81513214111ms
2022-09-21 15:14:58 INFO  Estimated optimised what-if runtime is 4307.621717453003ms
2022-09-21 15:14:58 INFO  Estimated optimisation runtime saving is 72315.19341468811ms
2022-09-21 15:14:58 INFO  ---RUNTIME: Multi-Query Optimization took 94.40159797668457 ms
2022-09-21 15:14:58 INFO  Executing generated plans
2022-09-21 15:15:00 INFO  ---RUNTIME: Execution took 2544.7914600372314 ms
2022-09-21 15:15:00 INFO  Done!
2022-09-21 15:15:00 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-21 15:15:00 INFO  Running instrumented original pipeline...
2022-09-21 15:15:00 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-21 15:15:00 INFO  ---RUNTIME: Importing and monkey-patching took 5.579233169555664 ms
2022-09-21 15:15:03 INFO  ---RUNTIME: Original pipeline execution took 2550.3270626068115 ms (excluding imports and monkey-patching)
2022-09-21 15:15:03 INFO  Starting execution of 1 what-if analyses...
2022-09-21 15:15:03 INFO  Start plan generation for analysis DataCorruption...
2022-09-21 15:15:03 INFO  ---RUNTIME: Plan generation took 0.5097389221191406 ms
2022-09-21 15:15:03 INFO  Estimated runtime of original DAG is 2283.0941677093506ms
2022-09-21 15:15:03 WARNING Skipping Multi-Query Optimization (instead, only applying patches)
2022-09-21 15:15:03 INFO  Estimated unoptimised what-if runtime is 68492.82503128052ms
2022-09-21 15:15:03 INFO  ---RUNTIME: Multi-Query Optimization took 21.185874938964844 ms
2022-09-21 15:15:03 INFO  Executing generated plans
2022-09-21 15:16:13 INFO  ---RUNTIME: Execution took 69632.63702392578 ms
2022-09-21 15:16:13 INFO  Done!
2022-09-21 15:16:13 INFO  # Finished -- repetition 3 of 7 
2022-09-21 15:16:13 INFO  # Optimization benchmark for data_corruption with args [['healthcare', 'slow_loading', 'featurization_1', 'neural_network']] -- repetition 4 of 7
2022-09-21 15:16:13 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-21 15:16:13 INFO  Running instrumented original pipeline...
2022-09-21 15:16:13 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-21 15:16:13 INFO  ---RUNTIME: Importing and monkey-patching took 5.7315826416015625 ms
2022-09-21 15:16:15 INFO  ---RUNTIME: Original pipeline execution took 2498.5218048095703 ms (excluding imports and monkey-patching)
2022-09-21 15:16:15 INFO  Starting execution of 1 what-if analyses...
2022-09-21 15:16:15 INFO  Start plan generation for analysis DataCorruption...
2022-09-21 15:16:15 INFO  ---RUNTIME: Plan generation took 0.6079673767089844 ms
2022-09-21 15:16:15 INFO  Estimated runtime of original DAG is 2228.4436225891113ms
2022-09-21 15:16:15 INFO  Performing Multi-Query Optimization
2022-09-21 15:16:15 INFO  Estimated unoptimized what-if runtime is 66853.30867767334ms
2022-09-21 15:16:15 INFO  Estimated optimised what-if runtime is 3845.935583114624ms
2022-09-21 15:16:15 INFO  Estimated optimisation runtime saving is 63007.373094558716ms
2022-09-21 15:16:15 INFO  ---RUNTIME: Multi-Query Optimization took 77.31270790100098 ms
2022-09-21 15:16:15 INFO  Executing generated plans
2022-09-21 15:16:18 INFO  ---RUNTIME: Execution took 2855.0074100494385 ms
2022-09-21 15:16:18 INFO  Done!
2022-09-21 15:16:18 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-21 15:16:18 INFO  Running instrumented original pipeline...
2022-09-21 15:16:18 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-21 15:16:18 INFO  ---RUNTIME: Importing and monkey-patching took 5.89299201965332 ms
2022-09-21 15:16:20 INFO  ---RUNTIME: Original pipeline execution took 2486.659526824951 ms (excluding imports and monkey-patching)
2022-09-21 15:16:20 INFO  Starting execution of 1 what-if analyses...
2022-09-21 15:16:20 INFO  Start plan generation for analysis DataCorruption...
2022-09-21 15:16:20 INFO  ---RUNTIME: Plan generation took 0.5929470062255859 ms
2022-09-21 15:16:20 INFO  Estimated runtime of original DAG is 2217.3261642456055ms
2022-09-21 15:16:20 WARNING Skipping Multi-Query Optimization (instead, only applying patches)
2022-09-21 15:16:21 INFO  Estimated unoptimised what-if runtime is 66519.78492736816ms
2022-09-21 15:16:21 INFO  ---RUNTIME: Multi-Query Optimization took 21.79694175720215 ms
2022-09-21 15:16:21 INFO  Executing generated plans
2022-09-21 15:17:30 INFO  ---RUNTIME: Execution took 69046.18120193481 ms
2022-09-21 15:17:30 INFO  Done!
2022-09-21 15:17:30 INFO  # Finished -- repetition 4 of 7 
2022-09-21 15:17:30 INFO  # Optimization benchmark for data_corruption with args [['healthcare', 'slow_loading', 'featurization_1', 'neural_network']] -- repetition 5 of 7
2022-09-21 15:17:30 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-21 15:17:30 INFO  Running instrumented original pipeline...
2022-09-21 15:17:30 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-21 15:17:30 INFO  ---RUNTIME: Importing and monkey-patching took 5.851984024047852 ms
2022-09-21 15:17:32 INFO  ---RUNTIME: Original pipeline execution took 2501.9876956939697 ms (excluding imports and monkey-patching)
2022-09-21 15:17:32 INFO  Starting execution of 1 what-if analyses...
2022-09-21 15:17:32 INFO  Start plan generation for analysis DataCorruption...
2022-09-21 15:17:32 INFO  ---RUNTIME: Plan generation took 0.5810260772705078 ms
2022-09-21 15:17:32 INFO  Estimated runtime of original DAG is 2233.147621154785ms
2022-09-21 15:17:32 INFO  Performing Multi-Query Optimization
2022-09-21 15:17:32 INFO  Estimated unoptimized what-if runtime is 66994.42863464355ms
2022-09-21 15:17:32 INFO  Estimated optimised what-if runtime is 3842.9932594299316ms
2022-09-21 15:17:32 INFO  Estimated optimisation runtime saving is 63151.43537521362ms
2022-09-21 15:17:32 INFO  ---RUNTIME: Multi-Query Optimization took 78.12929153442383 ms
2022-09-21 15:17:32 INFO  Executing generated plans
2022-09-21 15:17:35 INFO  ---RUNTIME: Execution took 2548.8224029541016 ms
2022-09-21 15:17:35 INFO  Done!
2022-09-21 15:17:35 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-21 15:17:35 INFO  Running instrumented original pipeline...
2022-09-21 15:17:35 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-21 15:17:35 INFO  ---RUNTIME: Importing and monkey-patching took 6.206512451171875 ms
2022-09-21 15:17:37 INFO  ---RUNTIME: Original pipeline execution took 2488.085985183716 ms (excluding imports and monkey-patching)
2022-09-21 15:17:37 INFO  Starting execution of 1 what-if analyses...
2022-09-21 15:17:37 INFO  Start plan generation for analysis DataCorruption...
2022-09-21 15:17:37 INFO  ---RUNTIME: Plan generation took 0.5171298980712891 ms
2022-09-21 15:17:37 INFO  Estimated runtime of original DAG is 2220.8504676818848ms
2022-09-21 15:17:37 WARNING Skipping Multi-Query Optimization (instead, only applying patches)
2022-09-21 15:17:37 INFO  Estimated unoptimised what-if runtime is 66625.51403045654ms
2022-09-21 15:17:37 INFO  ---RUNTIME: Multi-Query Optimization took 21.74210548400879 ms
2022-09-21 15:17:37 INFO  Executing generated plans
2022-09-21 15:18:47 INFO  ---RUNTIME: Execution took 69656.17990493774 ms
2022-09-21 15:18:47 INFO  Done!
2022-09-21 15:18:47 INFO  # Finished -- repetition 5 of 7 
2022-09-21 15:18:47 INFO  # Optimization benchmark for data_corruption with args [['healthcare', 'slow_loading', 'featurization_1', 'neural_network']] -- repetition 6 of 7
2022-09-21 15:18:47 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-21 15:18:47 INFO  Running instrumented original pipeline...
2022-09-21 15:18:47 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-21 15:18:47 INFO  ---RUNTIME: Importing and monkey-patching took 5.871772766113281 ms
2022-09-21 15:18:49 INFO  ---RUNTIME: Original pipeline execution took 2501.7900466918945 ms (excluding imports and monkey-patching)
2022-09-21 15:18:49 INFO  Starting execution of 1 what-if analyses...
2022-09-21 15:18:49 INFO  Start plan generation for analysis DataCorruption...
2022-09-21 15:18:49 INFO  ---RUNTIME: Plan generation took 0.5338191986083984 ms
2022-09-21 15:18:49 INFO  Estimated runtime of original DAG is 2232.7139377593994ms
2022-09-21 15:18:49 INFO  Performing Multi-Query Optimization
2022-09-21 15:18:49 INFO  Estimated unoptimized what-if runtime is 66981.41813278198ms
2022-09-21 15:18:49 INFO  Estimated optimised what-if runtime is 3852.303981781006ms
2022-09-21 15:18:49 INFO  Estimated optimisation runtime saving is 63129.11415100098ms
2022-09-21 15:18:49 INFO  ---RUNTIME: Multi-Query Optimization took 76.39193534851074 ms
2022-09-21 15:18:49 INFO  Executing generated plans
2022-09-21 15:18:52 INFO  ---RUNTIME: Execution took 2707.122802734375 ms
2022-09-21 15:18:52 INFO  Done!
2022-09-21 15:18:52 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-21 15:18:52 INFO  Running instrumented original pipeline...
2022-09-21 15:18:52 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-21 15:18:52 INFO  ---RUNTIME: Importing and monkey-patching took 6.000757217407227 ms
2022-09-21 15:18:55 INFO  ---RUNTIME: Original pipeline execution took 2899.9409675598145 ms (excluding imports and monkey-patching)
2022-09-21 15:18:55 INFO  Starting execution of 1 what-if analyses...
2022-09-21 15:18:55 INFO  Start plan generation for analysis DataCorruption...
2022-09-21 15:18:55 INFO  ---RUNTIME: Plan generation took 0.5362033843994141 ms
2022-09-21 15:18:55 INFO  Estimated runtime of original DAG is 2627.197265625ms
2022-09-21 15:18:55 WARNING Skipping Multi-Query Optimization (instead, only applying patches)
2022-09-21 15:18:55 INFO  Estimated unoptimised what-if runtime is 78815.91796875ms
2022-09-21 15:18:55 INFO  ---RUNTIME: Multi-Query Optimization took 22.434711456298828 ms
2022-09-21 15:18:55 INFO  Executing generated plans
2022-09-21 15:20:04 INFO  ---RUNTIME: Execution took 68942.17205047607 ms
2022-09-21 15:20:04 INFO  Done!
2022-09-21 15:20:04 INFO  # Finished -- repetition 6 of 7 
2022-09-21 15:20:04 INFO  # Optimization benchmark for data_corruption with args [['healthcare', 'slow_loading', 'featurization_1', 'neural_network']] -- repetition 7 of 7
2022-09-21 15:20:04 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-21 15:20:04 INFO  Running instrumented original pipeline...
2022-09-21 15:20:04 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-21 15:20:04 INFO  ---RUNTIME: Importing and monkey-patching took 5.83195686340332 ms
2022-09-21 15:20:07 INFO  ---RUNTIME: Original pipeline execution took 2581.1688899993896 ms (excluding imports and monkey-patching)
2022-09-21 15:20:07 INFO  Starting execution of 1 what-if analyses...
2022-09-21 15:20:07 INFO  Start plan generation for analysis DataCorruption...
2022-09-21 15:20:07 INFO  ---RUNTIME: Plan generation took 1.5933513641357422 ms
2022-09-21 15:20:07 INFO  Estimated runtime of original DAG is 2312.1769428253174ms
2022-09-21 15:20:07 INFO  Performing Multi-Query Optimization
2022-09-21 15:20:07 INFO  Estimated unoptimized what-if runtime is 69365.30828475952ms
2022-09-21 15:20:07 INFO  Estimated optimised what-if runtime is 3921.861410140991ms
2022-09-21 15:20:07 INFO  Estimated optimisation runtime saving is 65443.44687461853ms
2022-09-21 15:20:07 INFO  ---RUNTIME: Multi-Query Optimization took 75.97637176513672 ms
2022-09-21 15:20:07 INFO  Executing generated plans
2022-09-21 15:20:09 INFO  ---RUNTIME: Execution took 2525.564670562744 ms
2022-09-21 15:20:09 INFO  Done!
2022-09-21 15:20:09 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-21 15:20:09 INFO  Running instrumented original pipeline...
2022-09-21 15:20:09 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-21 15:20:09 INFO  ---RUNTIME: Importing and monkey-patching took 6.1168670654296875 ms
2022-09-21 15:20:12 INFO  ---RUNTIME: Original pipeline execution took 2891.350269317627 ms (excluding imports and monkey-patching)
2022-09-21 15:20:12 INFO  Starting execution of 1 what-if analyses...
2022-09-21 15:20:12 INFO  Start plan generation for analysis DataCorruption...
2022-09-21 15:20:12 INFO  ---RUNTIME: Plan generation took 0.5807876586914062 ms
2022-09-21 15:20:12 INFO  Estimated runtime of original DAG is 2625.343084335327ms
2022-09-21 15:20:12 WARNING Skipping Multi-Query Optimization (instead, only applying patches)
2022-09-21 15:20:12 INFO  Estimated unoptimised what-if runtime is 78760.29253005981ms
2022-09-21 15:20:12 INFO  ---RUNTIME: Multi-Query Optimization took 21.986961364746094 ms
2022-09-21 15:20:12 INFO  Executing generated plans
2022-09-21 15:21:21 INFO  ---RUNTIME: Execution took 68978.72734069824 ms
2022-09-21 15:21:21 INFO  Done!
2022-09-21 15:21:21 INFO  # Finished -- repetition 7 of 7 
2022-09-21 15:21:21 INFO  # Final results after all repetitions
2022-09-21 15:21:21 INFO     repetition  ... no_opt_what_if_execution_combined_model_training
0           0  ...                                     14372.742414
1           1  ...                                     14543.610334
2           2  ...                                     14299.936533
3           3  ...                                     13969.837189
4           4  ...                                     14397.258759
5           5  ...                                     14081.258535
6           6  ...                                     14454.015732

[7 rows x 26 columns]
taskset -c 0-7 PROTOCOL_BUFFERS_PYTHON_IMPLEMENTATION=python python3.9 benchmarks_end_to_end.py data_corruption healthcare slow_loading featurization_2 logistic_regression
2022-09-21 15:21:23.931607: W tensorflow/stream_executor/platform/default/dso_loader.cc:64] Could not load dynamic library 'libcudart.so.11.0'; dlerror: libcudart.so.11.0: cannot open shared object file: No such file or directory; LD_LIBRARY_PATH: /home/sgrafbe/mlwhatif/venv/lib/python3.9/site-packages/cv2/../../lib64:
2022-09-21 15:21:23.931655: I tensorflow/stream_executor/cuda/cudart_stub.cc:29] Ignore above cudart dlerror if you do not have a GPU set up on your machine.
2022-09-21 15:21:25 INFO  Patching sys.argv with ['mlwhatif', 'healthcare', 'slow_loading', 'featurization_2', 'logistic_regression']
2022-09-21 15:21:25 INFO  Running instrumented original pipeline...
2022-09-21 15:21:25 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-21 15:21:25 INFO  ---RUNTIME: Importing and monkey-patching took 96.05026245117188 ms
2022-09-21 15:21:27 INFO  ---RUNTIME: Original pipeline execution took 2082.7248096466064 ms (excluding imports and monkey-patching)
2022-09-21 15:21:27 INFO  Starting execution of 0 what-if analyses...
2022-09-21 15:21:27 INFO  Estimated runtime of original DAG is 1806.6952228546143ms
2022-09-21 15:21:27 INFO  Performing Multi-Query Optimization
2022-09-21 15:21:27 INFO  Estimated unoptimized what-if runtime is 0ms
2022-09-21 15:21:27 INFO  Estimated optimised what-if runtime is 0ms
2022-09-21 15:21:27 INFO  Estimated optimisation runtime saving is 0ms
2022-09-21 15:21:27 INFO  ---RUNTIME: Multi-Query Optimization took 0.4703998565673828 ms
2022-09-21 15:21:27 INFO  Executing generated plans
2022-09-21 15:21:27 INFO  ---RUNTIME: Execution took 0.021219253540039062 ms
2022-09-21 15:21:27 INFO  Done!
2022-09-21 15:21:27 INFO  # Optimization benchmark for data_corruption with args [['healthcare', 'slow_loading', 'featurization_2', 'logistic_regression']] -- repetition 1 of 7
2022-09-21 15:21:27 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-21 15:21:27 INFO  Running instrumented original pipeline...
2022-09-21 15:21:27 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-21 15:21:27 INFO  ---RUNTIME: Importing and monkey-patching took 5.035161972045898 ms
2022-09-21 15:21:29 INFO  ---RUNTIME: Original pipeline execution took 1976.649284362793 ms (excluding imports and monkey-patching)
2022-09-21 15:21:29 INFO  Starting execution of 1 what-if analyses...
2022-09-21 15:21:29 INFO  Start plan generation for analysis DataCorruption...
2022-09-21 15:21:29 INFO  ---RUNTIME: Plan generation took 0.45752525329589844 ms
2022-09-21 15:21:29 INFO  Estimated runtime of original DAG is 1732.6180934906006ms
2022-09-21 15:21:29 INFO  Performing Multi-Query Optimization
2022-09-21 15:21:29 INFO  Estimated unoptimized what-if runtime is 51978.54280471802ms
2022-09-21 15:21:29 INFO  Estimated optimised what-if runtime is 1794.5053577423096ms
2022-09-21 15:21:29 INFO  Estimated optimisation runtime saving is 50184.03744697571ms
2022-09-21 15:21:29 INFO  ---RUNTIME: Multi-Query Optimization took 81.89010620117188 ms
2022-09-21 15:21:29 INFO  Executing generated plans
2022-09-21 15:21:31 INFO  ---RUNTIME: Execution took 1892.9972648620605 ms
2022-09-21 15:21:31 INFO  Done!
2022-09-21 15:21:31 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-21 15:21:31 INFO  Running instrumented original pipeline...
2022-09-21 15:21:31 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-21 15:21:31 INFO  ---RUNTIME: Importing and monkey-patching took 6.126880645751953 ms
2022-09-21 15:21:33 INFO  ---RUNTIME: Original pipeline execution took 2149.6379375457764 ms (excluding imports and monkey-patching)
2022-09-21 15:21:33 INFO  Starting execution of 1 what-if analyses...
2022-09-21 15:21:33 INFO  Start plan generation for analysis DataCorruption...
2022-09-21 15:21:33 INFO  ---RUNTIME: Plan generation took 0.47850608825683594 ms
2022-09-21 15:21:33 INFO  Estimated runtime of original DAG is 1747.5292682647705ms
2022-09-21 15:21:33 WARNING Skipping Multi-Query Optimization (instead, only applying patches)
2022-09-21 15:21:33 INFO  Estimated unoptimised what-if runtime is 52425.878047943115ms
2022-09-21 15:21:33 INFO  ---RUNTIME: Multi-Query Optimization took 22.220849990844727 ms
2022-09-21 15:21:33 INFO  Executing generated plans
2022-09-21 15:22:26 INFO  ---RUNTIME: Execution took 53406.81481361389 ms
2022-09-21 15:22:26 INFO  Done!
2022-09-21 15:22:26 INFO  # Finished -- repetition 1 of 7 
2022-09-21 15:22:26 INFO  # Optimization benchmark for data_corruption with args [['healthcare', 'slow_loading', 'featurization_2', 'logistic_regression']] -- repetition 2 of 7
2022-09-21 15:22:26 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-21 15:22:26 INFO  Running instrumented original pipeline...
2022-09-21 15:22:26 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-21 15:22:26 INFO  ---RUNTIME: Importing and monkey-patching took 5.930423736572266 ms
2022-09-21 15:22:28 INFO  ---RUNTIME: Original pipeline execution took 1986.778974533081 ms (excluding imports and monkey-patching)
2022-09-21 15:22:28 INFO  Starting execution of 1 what-if analyses...
2022-09-21 15:22:28 INFO  Start plan generation for analysis DataCorruption...
2022-09-21 15:22:28 INFO  ---RUNTIME: Plan generation took 0.7622241973876953 ms
2022-09-21 15:22:28 INFO  Estimated runtime of original DAG is 1743.699073791504ms
2022-09-21 15:22:28 INFO  Performing Multi-Query Optimization
2022-09-21 15:22:28 INFO  Estimated unoptimized what-if runtime is 52310.97221374512ms
2022-09-21 15:22:28 INFO  Estimated optimised what-if runtime is 1804.0320873260498ms
2022-09-21 15:22:28 INFO  Estimated optimisation runtime saving is 50506.94012641907ms
2022-09-21 15:22:28 INFO  ---RUNTIME: Multi-Query Optimization took 81.27641677856445 ms
2022-09-21 15:22:28 INFO  Executing generated plans
2022-09-21 15:22:30 INFO  ---RUNTIME: Execution took 1892.8155899047852 ms
2022-09-21 15:22:30 INFO  Done!
2022-09-21 15:22:30 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-21 15:22:30 INFO  Running instrumented original pipeline...
2022-09-21 15:22:30 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-21 15:22:30 INFO  ---RUNTIME: Importing and monkey-patching took 5.79524040222168 ms
2022-09-21 15:22:32 INFO  ---RUNTIME: Original pipeline execution took 1977.6172637939453 ms (excluding imports and monkey-patching)
2022-09-21 15:22:32 INFO  Starting execution of 1 what-if analyses...
2022-09-21 15:22:32 INFO  Start plan generation for analysis DataCorruption...
2022-09-21 15:22:32 INFO  ---RUNTIME: Plan generation took 0.46133995056152344 ms
2022-09-21 15:22:32 INFO  Estimated runtime of original DAG is 1735.3312969207764ms
2022-09-21 15:22:32 WARNING Skipping Multi-Query Optimization (instead, only applying patches)
2022-09-21 15:22:33 INFO  Estimated unoptimised what-if runtime is 52059.93890762329ms
2022-09-21 15:22:33 INFO  ---RUNTIME: Multi-Query Optimization took 206.66766166687012 ms
2022-09-21 15:22:33 INFO  Executing generated plans
2022-09-21 15:23:26 INFO  ---RUNTIME: Execution took 53245.44596672058 ms
2022-09-21 15:23:26 INFO  Done!
2022-09-21 15:23:26 INFO  # Finished -- repetition 2 of 7 
2022-09-21 15:23:26 INFO  # Optimization benchmark for data_corruption with args [['healthcare', 'slow_loading', 'featurization_2', 'logistic_regression']] -- repetition 3 of 7
2022-09-21 15:23:26 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-21 15:23:26 INFO  Running instrumented original pipeline...
2022-09-21 15:23:26 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-21 15:23:26 INFO  ---RUNTIME: Importing and monkey-patching took 5.866050720214844 ms
2022-09-21 15:23:28 INFO  ---RUNTIME: Original pipeline execution took 1976.6013622283936 ms (excluding imports and monkey-patching)
2022-09-21 15:23:28 INFO  Starting execution of 1 what-if analyses...
2022-09-21 15:23:28 INFO  Start plan generation for analysis DataCorruption...
2022-09-21 15:23:28 INFO  ---RUNTIME: Plan generation took 0.46181678771972656 ms
2022-09-21 15:23:28 INFO  Estimated runtime of original DAG is 1734.2607975006104ms
2022-09-21 15:23:28 INFO  Performing Multi-Query Optimization
2022-09-21 15:23:28 INFO  Estimated unoptimized what-if runtime is 52027.82392501831ms
2022-09-21 15:23:28 INFO  Estimated optimised what-if runtime is 1794.5728302001953ms
2022-09-21 15:23:28 INFO  Estimated optimisation runtime saving is 50233.251094818115ms
2022-09-21 15:23:28 INFO  ---RUNTIME: Multi-Query Optimization took 81.04300498962402 ms
2022-09-21 15:23:28 INFO  Executing generated plans
2022-09-21 15:23:30 INFO  ---RUNTIME: Execution took 1879.364013671875 ms
2022-09-21 15:23:30 INFO  Done!
2022-09-21 15:23:30 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-21 15:23:30 INFO  Running instrumented original pipeline...
2022-09-21 15:23:30 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-21 15:23:30 INFO  ---RUNTIME: Importing and monkey-patching took 5.728244781494141 ms
2022-09-21 15:23:32 INFO  ---RUNTIME: Original pipeline execution took 2015.6846046447754 ms (excluding imports and monkey-patching)
2022-09-21 15:23:32 INFO  Starting execution of 1 what-if analyses...
2022-09-21 15:23:32 INFO  Start plan generation for analysis DataCorruption...
2022-09-21 15:23:32 INFO  ---RUNTIME: Plan generation took 0.8227825164794922 ms
2022-09-21 15:23:32 INFO  Estimated runtime of original DAG is 1771.2147235870361ms
2022-09-21 15:23:32 WARNING Skipping Multi-Query Optimization (instead, only applying patches)
2022-09-21 15:23:32 INFO  Estimated unoptimised what-if runtime is 53136.441707611084ms
2022-09-21 15:23:32 INFO  ---RUNTIME: Multi-Query Optimization took 22.085189819335938 ms
2022-09-21 15:23:32 INFO  Executing generated plans
2022-09-21 15:24:26 INFO  ---RUNTIME: Execution took 53721.041679382324 ms
2022-09-21 15:24:26 INFO  Done!
2022-09-21 15:24:26 INFO  # Finished -- repetition 3 of 7 
2022-09-21 15:24:26 INFO  # Optimization benchmark for data_corruption with args [['healthcare', 'slow_loading', 'featurization_2', 'logistic_regression']] -- repetition 4 of 7
2022-09-21 15:24:26 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-21 15:24:26 INFO  Running instrumented original pipeline...
2022-09-21 15:24:26 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-21 15:24:26 INFO  ---RUNTIME: Importing and monkey-patching took 6.154060363769531 ms
2022-09-21 15:24:28 INFO  ---RUNTIME: Original pipeline execution took 2003.7474632263184 ms (excluding imports and monkey-patching)
2022-09-21 15:24:28 INFO  Starting execution of 1 what-if analyses...
2022-09-21 15:24:28 INFO  Start plan generation for analysis DataCorruption...
2022-09-21 15:24:28 INFO  ---RUNTIME: Plan generation took 0.7927417755126953 ms
2022-09-21 15:24:28 INFO  Estimated runtime of original DAG is 1755.5058002471924ms
2022-09-21 15:24:28 INFO  Performing Multi-Query Optimization
2022-09-21 15:24:28 INFO  Estimated unoptimized what-if runtime is 52665.17400741577ms
2022-09-21 15:24:28 INFO  Estimated optimised what-if runtime is 1815.4449462890625ms
2022-09-21 15:24:28 INFO  Estimated optimisation runtime saving is 50849.72906112671ms
2022-09-21 15:24:28 INFO  ---RUNTIME: Multi-Query Optimization took 81.15458488464355 ms
2022-09-21 15:24:28 INFO  Executing generated plans
2022-09-21 15:24:29 INFO  ---RUNTIME: Execution took 1876.4088153839111 ms
2022-09-21 15:24:29 INFO  Done!
2022-09-21 15:24:29 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-21 15:24:29 INFO  Running instrumented original pipeline...
2022-09-21 15:24:30 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-21 15:24:30 INFO  ---RUNTIME: Importing and monkey-patching took 5.615949630737305 ms
2022-09-21 15:24:31 INFO  ---RUNTIME: Original pipeline execution took 1996.7772960662842 ms (excluding imports and monkey-patching)
2022-09-21 15:24:31 INFO  Starting execution of 1 what-if analyses...
2022-09-21 15:24:31 INFO  Start plan generation for analysis DataCorruption...
2022-09-21 15:24:31 INFO  ---RUNTIME: Plan generation took 0.44727325439453125 ms
2022-09-21 15:24:31 INFO  Estimated runtime of original DAG is 1753.1423568725586ms
2022-09-21 15:24:31 WARNING Skipping Multi-Query Optimization (instead, only applying patches)
2022-09-21 15:24:32 INFO  Estimated unoptimised what-if runtime is 52594.27070617676ms
2022-09-21 15:24:32 INFO  ---RUNTIME: Multi-Query Optimization took 22.264480590820312 ms
2022-09-21 15:24:32 INFO  Executing generated plans
2022-09-21 15:25:25 INFO  ---RUNTIME: Execution took 53275.5811214447 ms
2022-09-21 15:25:25 INFO  Done!
2022-09-21 15:25:25 INFO  # Finished -- repetition 4 of 7 
2022-09-21 15:25:25 INFO  # Optimization benchmark for data_corruption with args [['healthcare', 'slow_loading', 'featurization_2', 'logistic_regression']] -- repetition 5 of 7
2022-09-21 15:25:25 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-21 15:25:25 INFO  Running instrumented original pipeline...
2022-09-21 15:25:25 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-21 15:25:25 INFO  ---RUNTIME: Importing and monkey-patching took 5.613565444946289 ms
2022-09-21 15:25:27 INFO  ---RUNTIME: Original pipeline execution took 1981.2252521514893 ms (excluding imports and monkey-patching)
2022-09-21 15:25:27 INFO  Starting execution of 1 what-if analyses...
2022-09-21 15:25:27 INFO  Start plan generation for analysis DataCorruption...
2022-09-21 15:25:27 INFO  ---RUNTIME: Plan generation took 0.5128383636474609 ms
2022-09-21 15:25:27 INFO  Estimated runtime of original DAG is 1736.7582321166992ms
2022-09-21 15:25:27 INFO  Performing Multi-Query Optimization
2022-09-21 15:25:27 INFO  Estimated unoptimized what-if runtime is 52102.74696350098ms
2022-09-21 15:25:27 INFO  Estimated optimised what-if runtime is 1797.7004051208496ms
2022-09-21 15:25:27 INFO  Estimated optimisation runtime saving is 50305.04655838013ms
2022-09-21 15:25:27 INFO  ---RUNTIME: Multi-Query Optimization took 82.10182189941406 ms
2022-09-21 15:25:27 INFO  Executing generated plans
2022-09-21 15:25:29 INFO  ---RUNTIME: Execution took 1858.9324951171875 ms
2022-09-21 15:25:29 INFO  Done!
2022-09-21 15:25:29 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-21 15:25:29 INFO  Running instrumented original pipeline...
2022-09-21 15:25:29 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-21 15:25:29 INFO  ---RUNTIME: Importing and monkey-patching took 5.649805068969727 ms
2022-09-21 15:25:31 INFO  ---RUNTIME: Original pipeline execution took 1969.0067768096924 ms (excluding imports and monkey-patching)
2022-09-21 15:25:31 INFO  Starting execution of 1 what-if analyses...
2022-09-21 15:25:31 INFO  Start plan generation for analysis DataCorruption...
2022-09-21 15:25:31 INFO  ---RUNTIME: Plan generation took 0.7538795471191406 ms
2022-09-21 15:25:31 INFO  Estimated runtime of original DAG is 1726.844310760498ms
2022-09-21 15:25:31 WARNING Skipping Multi-Query Optimization (instead, only applying patches)
2022-09-21 15:25:31 INFO  Estimated unoptimised what-if runtime is 51805.32932281494ms
2022-09-21 15:25:31 INFO  ---RUNTIME: Multi-Query Optimization took 21.937847137451172 ms
2022-09-21 15:25:31 INFO  Executing generated plans
2022-09-21 15:26:24 INFO  ---RUNTIME: Execution took 53014.32991027832 ms
2022-09-21 15:26:24 INFO  Done!
2022-09-21 15:26:24 INFO  # Finished -- repetition 5 of 7 
2022-09-21 15:26:24 INFO  # Optimization benchmark for data_corruption with args [['healthcare', 'slow_loading', 'featurization_2', 'logistic_regression']] -- repetition 6 of 7
2022-09-21 15:26:24 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-21 15:26:24 INFO  Running instrumented original pipeline...
2022-09-21 15:26:24 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-21 15:26:24 INFO  ---RUNTIME: Importing and monkey-patching took 6.237268447875977 ms
2022-09-21 15:26:26 INFO  ---RUNTIME: Original pipeline execution took 2210.0670337677 ms (excluding imports and monkey-patching)
2022-09-21 15:26:26 INFO  Starting execution of 1 what-if analyses...
2022-09-21 15:26:26 INFO  Start plan generation for analysis DataCorruption...
2022-09-21 15:26:26 INFO  ---RUNTIME: Plan generation took 0.5204677581787109 ms
2022-09-21 15:26:26 INFO  Estimated runtime of original DAG is 1964.2860889434814ms
2022-09-21 15:26:26 INFO  Performing Multi-Query Optimization
2022-09-21 15:26:26 INFO  Estimated unoptimized what-if runtime is 58928.58266830444ms
2022-09-21 15:26:26 INFO  Estimated optimised what-if runtime is 2031.3425064086914ms
2022-09-21 15:26:26 INFO  Estimated optimisation runtime saving is 56897.24016189575ms
2022-09-21 15:26:26 INFO  ---RUNTIME: Multi-Query Optimization took 83.46962928771973 ms
2022-09-21 15:26:26 INFO  Executing generated plans
2022-09-21 15:26:28 INFO  ---RUNTIME: Execution took 1940.6580924987793 ms
2022-09-21 15:26:28 INFO  Done!
2022-09-21 15:26:28 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-21 15:26:28 INFO  Running instrumented original pipeline...
2022-09-21 15:26:28 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-21 15:26:28 INFO  ---RUNTIME: Importing and monkey-patching took 6.308794021606445 ms
2022-09-21 15:26:30 INFO  ---RUNTIME: Original pipeline execution took 2024.919033050537 ms (excluding imports and monkey-patching)
2022-09-21 15:26:30 INFO  Starting execution of 1 what-if analyses...
2022-09-21 15:26:30 INFO  Start plan generation for analysis DataCorruption...
2022-09-21 15:26:30 INFO  ---RUNTIME: Plan generation took 0.5338191986083984 ms
2022-09-21 15:26:30 INFO  Estimated runtime of original DAG is 1767.695426940918ms
2022-09-21 15:26:30 WARNING Skipping Multi-Query Optimization (instead, only applying patches)
2022-09-21 15:26:30 INFO  Estimated unoptimised what-if runtime is 53030.86280822754ms
2022-09-21 15:26:30 INFO  ---RUNTIME: Multi-Query Optimization took 22.925615310668945 ms
2022-09-21 15:26:30 INFO  Executing generated plans
2022-09-21 15:27:23 INFO  ---RUNTIME: Execution took 53330.19256591797 ms
2022-09-21 15:27:23 INFO  Done!
2022-09-21 15:27:23 INFO  # Finished -- repetition 6 of 7 
2022-09-21 15:27:23 INFO  # Optimization benchmark for data_corruption with args [['healthcare', 'slow_loading', 'featurization_2', 'logistic_regression']] -- repetition 7 of 7
2022-09-21 15:27:23 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-21 15:27:23 INFO  Running instrumented original pipeline...
2022-09-21 15:27:23 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-21 15:27:23 INFO  ---RUNTIME: Importing and monkey-patching took 6.165742874145508 ms
2022-09-21 15:27:25 INFO  ---RUNTIME: Original pipeline execution took 1973.682165145874 ms (excluding imports and monkey-patching)
2022-09-21 15:27:25 INFO  Starting execution of 1 what-if analyses...
2022-09-21 15:27:25 INFO  Start plan generation for analysis DataCorruption...
2022-09-21 15:27:25 INFO  ---RUNTIME: Plan generation took 0.48089027404785156 ms
2022-09-21 15:27:25 INFO  Estimated runtime of original DAG is 1731.6970825195312ms
2022-09-21 15:27:25 INFO  Performing Multi-Query Optimization
2022-09-21 15:27:25 INFO  Estimated unoptimized what-if runtime is 51950.91247558594ms
2022-09-21 15:27:25 INFO  Estimated optimised what-if runtime is 1791.8198108673096ms
2022-09-21 15:27:25 INFO  Estimated optimisation runtime saving is 50159.09266471863ms
2022-09-21 15:27:25 INFO  ---RUNTIME: Multi-Query Optimization took 81.31170272827148 ms
2022-09-21 15:27:25 INFO  Executing generated plans
2022-09-21 15:27:27 INFO  ---RUNTIME: Execution took 1874.2742538452148 ms
2022-09-21 15:27:27 INFO  Done!
2022-09-21 15:27:27 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-21 15:27:27 INFO  Running instrumented original pipeline...
2022-09-21 15:27:27 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-21 15:27:27 INFO  ---RUNTIME: Importing and monkey-patching took 5.677461624145508 ms
2022-09-21 15:27:29 INFO  ---RUNTIME: Original pipeline execution took 1987.5400066375732 ms (excluding imports and monkey-patching)
2022-09-21 15:27:29 INFO  Starting execution of 1 what-if analyses...
2022-09-21 15:27:29 INFO  Start plan generation for analysis DataCorruption...
2022-09-21 15:27:29 INFO  ---RUNTIME: Plan generation took 0.7579326629638672 ms
2022-09-21 15:27:29 INFO  Estimated runtime of original DAG is 1743.9565658569336ms
2022-09-21 15:27:29 WARNING Skipping Multi-Query Optimization (instead, only applying patches)
2022-09-21 15:27:29 INFO  Estimated unoptimised what-if runtime is 52318.69697570801ms
2022-09-21 15:27:29 INFO  ---RUNTIME: Multi-Query Optimization took 22.09615707397461 ms
2022-09-21 15:27:29 INFO  Executing generated plans
2022-09-21 15:28:23 INFO  ---RUNTIME: Execution took 53315.47689437866 ms
2022-09-21 15:28:23 INFO  Done!
2022-09-21 15:28:23 INFO  # Finished -- repetition 7 of 7 
2022-09-21 15:28:23 INFO  # Final results after all repetitions
2022-09-21 15:28:23 INFO     repetition  ... no_opt_what_if_execution_combined_model_training
0           0  ...                                        33.494949
1           1  ...                                        32.624483
2           2  ...                                        33.560038
3           3  ...                                        33.035755
4           4  ...                                        33.036947
5           5  ...                                        31.709433
6           6  ...                                        31.733036

[7 rows x 26 columns]
taskset -c 0-7 PROTOCOL_BUFFERS_PYTHON_IMPLEMENTATION=python python3.9 benchmarks_end_to_end.py data_corruption healthcare slow_loading featurization_2 xgboost
2022-09-21 15:28:25.234938: W tensorflow/stream_executor/platform/default/dso_loader.cc:64] Could not load dynamic library 'libcudart.so.11.0'; dlerror: libcudart.so.11.0: cannot open shared object file: No such file or directory; LD_LIBRARY_PATH: /home/sgrafbe/mlwhatif/venv/lib/python3.9/site-packages/cv2/../../lib64:
2022-09-21 15:28:25.234981: I tensorflow/stream_executor/cuda/cudart_stub.cc:29] Ignore above cudart dlerror if you do not have a GPU set up on your machine.
2022-09-21 15:28:26 INFO  Patching sys.argv with ['mlwhatif', 'healthcare', 'slow_loading', 'featurization_2', 'xgboost']
2022-09-21 15:28:26 INFO  Running instrumented original pipeline...
2022-09-21 15:28:26 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-21 15:28:26 INFO  ---RUNTIME: Importing and monkey-patching took 95.63565254211426 ms
2022-09-21 15:28:28 INFO  ---RUNTIME: Original pipeline execution took 2243.894577026367 ms (excluding imports and monkey-patching)
2022-09-21 15:28:28 INFO  Starting execution of 0 what-if analyses...
2022-09-21 15:28:28 INFO  Estimated runtime of original DAG is 1983.1950664520264ms
2022-09-21 15:28:28 INFO  Performing Multi-Query Optimization
2022-09-21 15:28:28 INFO  Estimated unoptimized what-if runtime is 0ms
2022-09-21 15:28:28 INFO  Estimated optimised what-if runtime is 0ms
2022-09-21 15:28:28 INFO  Estimated optimisation runtime saving is 0ms
2022-09-21 15:28:28 INFO  ---RUNTIME: Multi-Query Optimization took 0.46563148498535156 ms
2022-09-21 15:28:28 INFO  Executing generated plans
2022-09-21 15:28:28 INFO  ---RUNTIME: Execution took 0.022411346435546875 ms
2022-09-21 15:28:28 INFO  Done!
2022-09-21 15:28:28 INFO  # Optimization benchmark for data_corruption with args [['healthcare', 'slow_loading', 'featurization_2', 'xgboost']] -- repetition 1 of 7
2022-09-21 15:28:28 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-21 15:28:28 INFO  Running instrumented original pipeline...
2022-09-21 15:28:28 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-21 15:28:28 INFO  ---RUNTIME: Importing and monkey-patching took 5.3081512451171875 ms
2022-09-21 15:28:30 INFO  ---RUNTIME: Original pipeline execution took 2169.954776763916 ms (excluding imports and monkey-patching)
2022-09-21 15:28:30 INFO  Starting execution of 1 what-if analyses...
2022-09-21 15:28:30 INFO  Start plan generation for analysis DataCorruption...
2022-09-21 15:28:30 INFO  ---RUNTIME: Plan generation took 0.4887580871582031 ms
2022-09-21 15:28:30 INFO  Estimated runtime of original DAG is 1940.1044845581055ms
2022-09-21 15:28:30 INFO  Performing Multi-Query Optimization
2022-09-21 15:28:31 INFO  Estimated unoptimized what-if runtime is 58203.134536743164ms
2022-09-21 15:28:31 INFO  Estimated optimised what-if runtime is 2045.867681503296ms
2022-09-21 15:28:31 INFO  Estimated optimisation runtime saving is 56157.26685523987ms
2022-09-21 15:28:31 INFO  ---RUNTIME: Multi-Query Optimization took 81.93826675415039 ms
2022-09-21 15:28:31 INFO  Executing generated plans
2022-09-21 15:28:33 INFO  ---RUNTIME: Execution took 2154.583692550659 ms
2022-09-21 15:28:33 INFO  Done!
2022-09-21 15:28:33 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-21 15:28:33 INFO  Running instrumented original pipeline...
2022-09-21 15:28:33 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-21 15:28:33 INFO  ---RUNTIME: Importing and monkey-patching took 6.186962127685547 ms
2022-09-21 15:28:36 INFO  ---RUNTIME: Original pipeline execution took 3133.655309677124 ms (excluding imports and monkey-patching)
2022-09-21 15:28:36 INFO  Starting execution of 1 what-if analyses...
2022-09-21 15:28:36 INFO  Start plan generation for analysis DataCorruption...
2022-09-21 15:28:36 INFO  ---RUNTIME: Plan generation took 0.49233436584472656 ms
2022-09-21 15:28:36 INFO  Estimated runtime of original DAG is 2725.1663208007812ms
2022-09-21 15:28:36 WARNING Skipping Multi-Query Optimization (instead, only applying patches)
2022-09-21 15:28:36 INFO  Estimated unoptimised what-if runtime is 81754.98962402344ms
2022-09-21 15:28:36 INFO  ---RUNTIME: Multi-Query Optimization took 22.089242935180664 ms
2022-09-21 15:28:36 INFO  Executing generated plans
2022-09-21 15:29:35 INFO  ---RUNTIME: Execution took 58929.24499511719 ms
2022-09-21 15:29:35 INFO  Done!
2022-09-21 15:29:35 INFO  # Finished -- repetition 1 of 7 
2022-09-21 15:29:35 INFO  # Optimization benchmark for data_corruption with args [['healthcare', 'slow_loading', 'featurization_2', 'xgboost']] -- repetition 2 of 7
2022-09-21 15:29:35 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-21 15:29:35 INFO  Running instrumented original pipeline...
2022-09-21 15:29:35 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-21 15:29:35 INFO  ---RUNTIME: Importing and monkey-patching took 6.44683837890625 ms
2022-09-21 15:29:37 INFO  ---RUNTIME: Original pipeline execution took 2174.3102073669434 ms (excluding imports and monkey-patching)
2022-09-21 15:29:37 INFO  Starting execution of 1 what-if analyses...
2022-09-21 15:29:37 INFO  Start plan generation for analysis DataCorruption...
2022-09-21 15:29:37 INFO  ---RUNTIME: Plan generation took 0.8294582366943359 ms
2022-09-21 15:29:37 INFO  Estimated runtime of original DAG is 1936.4862442016602ms
2022-09-21 15:29:37 INFO  Performing Multi-Query Optimization
2022-09-21 15:29:37 INFO  Estimated unoptimized what-if runtime is 58094.587326049805ms
2022-09-21 15:29:37 INFO  Estimated optimised what-if runtime is 2041.3165092468262ms
2022-09-21 15:29:37 INFO  Estimated optimisation runtime saving is 56053.27081680298ms
2022-09-21 15:29:37 INFO  ---RUNTIME: Multi-Query Optimization took 81.09045028686523 ms
2022-09-21 15:29:37 INFO  Executing generated plans
2022-09-21 15:29:39 INFO  ---RUNTIME: Execution took 2107.365846633911 ms
2022-09-21 15:29:39 INFO  Done!
2022-09-21 15:29:39 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-21 15:29:39 INFO  Running instrumented original pipeline...
2022-09-21 15:29:39 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-21 15:29:39 INFO  ---RUNTIME: Importing and monkey-patching took 5.733966827392578 ms
2022-09-21 15:29:41 INFO  ---RUNTIME: Original pipeline execution took 2161.616086959839 ms (excluding imports and monkey-patching)
2022-09-21 15:29:41 INFO  Starting execution of 1 what-if analyses...
2022-09-21 15:29:41 INFO  Start plan generation for analysis DataCorruption...
2022-09-21 15:29:41 INFO  ---RUNTIME: Plan generation took 0.48851966857910156 ms
2022-09-21 15:29:41 INFO  Estimated runtime of original DAG is 1932.6770305633545ms
2022-09-21 15:29:41 WARNING Skipping Multi-Query Optimization (instead, only applying patches)
2022-09-21 15:29:41 INFO  Estimated unoptimised what-if runtime is 57980.310916900635ms
2022-09-21 15:29:41 INFO  ---RUNTIME: Multi-Query Optimization took 22.303104400634766 ms
2022-09-21 15:29:41 INFO  Executing generated plans
2022-09-21 15:30:40 INFO  ---RUNTIME: Execution took 58919.837951660156 ms
2022-09-21 15:30:40 INFO  Done!
2022-09-21 15:30:40 INFO  # Finished -- repetition 2 of 7 
2022-09-21 15:30:40 INFO  # Optimization benchmark for data_corruption with args [['healthcare', 'slow_loading', 'featurization_2', 'xgboost']] -- repetition 3 of 7
2022-09-21 15:30:40 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-21 15:30:40 INFO  Running instrumented original pipeline...
2022-09-21 15:30:40 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-21 15:30:40 INFO  ---RUNTIME: Importing and monkey-patching took 6.016731262207031 ms
2022-09-21 15:30:42 INFO  ---RUNTIME: Original pipeline execution took 2177.565097808838 ms (excluding imports and monkey-patching)
2022-09-21 15:30:42 INFO  Starting execution of 1 what-if analyses...
2022-09-21 15:30:42 INFO  Start plan generation for analysis DataCorruption...
2022-09-21 15:30:42 INFO  ---RUNTIME: Plan generation took 0.5660057067871094 ms
2022-09-21 15:30:42 INFO  Estimated runtime of original DAG is 1945.0299739837646ms
2022-09-21 15:30:42 INFO  Performing Multi-Query Optimization
2022-09-21 15:30:43 INFO  Estimated unoptimized what-if runtime is 58350.89921951294ms
2022-09-21 15:30:43 INFO  Estimated optimised what-if runtime is 2059.380531311035ms
2022-09-21 15:30:43 INFO  Estimated optimisation runtime saving is 56291.518688201904ms
2022-09-21 15:30:43 INFO  ---RUNTIME: Multi-Query Optimization took 81.9087028503418 ms
2022-09-21 15:30:43 INFO  Executing generated plans
2022-09-21 15:30:45 INFO  ---RUNTIME: Execution took 2157.2861671447754 ms
2022-09-21 15:30:45 INFO  Done!
2022-09-21 15:30:45 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-21 15:30:45 INFO  Running instrumented original pipeline...
2022-09-21 15:30:45 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-21 15:30:45 INFO  ---RUNTIME: Importing and monkey-patching took 5.836009979248047 ms
2022-09-21 15:30:47 INFO  ---RUNTIME: Original pipeline execution took 2199.1007328033447 ms (excluding imports and monkey-patching)
2022-09-21 15:30:47 INFO  Starting execution of 1 what-if analyses...
2022-09-21 15:30:47 INFO  Start plan generation for analysis DataCorruption...
2022-09-21 15:30:47 INFO  ---RUNTIME: Plan generation took 0.4630088806152344 ms
2022-09-21 15:30:47 INFO  Estimated runtime of original DAG is 1967.7948951721191ms
2022-09-21 15:30:47 WARNING Skipping Multi-Query Optimization (instead, only applying patches)
2022-09-21 15:30:47 INFO  Estimated unoptimised what-if runtime is 59033.846855163574ms
2022-09-21 15:30:47 INFO  ---RUNTIME: Multi-Query Optimization took 22.444725036621094 ms
2022-09-21 15:30:47 INFO  Executing generated plans
2022-09-21 15:31:46 INFO  ---RUNTIME: Execution took 58819.02742385864 ms
2022-09-21 15:31:46 INFO  Done!
2022-09-21 15:31:46 INFO  # Finished -- repetition 3 of 7 
2022-09-21 15:31:46 INFO  # Optimization benchmark for data_corruption with args [['healthcare', 'slow_loading', 'featurization_2', 'xgboost']] -- repetition 4 of 7
2022-09-21 15:31:46 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-21 15:31:46 INFO  Running instrumented original pipeline...
2022-09-21 15:31:46 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-21 15:31:46 INFO  ---RUNTIME: Importing and monkey-patching took 6.244659423828125 ms
2022-09-21 15:31:48 INFO  ---RUNTIME: Original pipeline execution took 2196.676254272461 ms (excluding imports and monkey-patching)
2022-09-21 15:31:48 INFO  Starting execution of 1 what-if analyses...
2022-09-21 15:31:48 INFO  Start plan generation for analysis DataCorruption...
2022-09-21 15:31:48 INFO  ---RUNTIME: Plan generation took 184.71431732177734 ms
2022-09-21 15:31:48 INFO  Estimated runtime of original DAG is 1967.4232006072998ms
2022-09-21 15:31:48 INFO  Performing Multi-Query Optimization
2022-09-21 15:31:48 INFO  Estimated unoptimized what-if runtime is 59022.696018218994ms
2022-09-21 15:31:48 INFO  Estimated optimised what-if runtime is 2074.8815536499023ms
2022-09-21 15:31:48 INFO  Estimated optimisation runtime saving is 56947.81446456909ms
2022-09-21 15:31:48 INFO  ---RUNTIME: Multi-Query Optimization took 81.25662803649902 ms
2022-09-21 15:31:48 INFO  Executing generated plans
2022-09-21 15:31:50 INFO  ---RUNTIME: Execution took 2125.5791187286377 ms
2022-09-21 15:31:50 INFO  Done!
2022-09-21 15:31:50 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-21 15:31:50 INFO  Running instrumented original pipeline...
2022-09-21 15:31:50 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-21 15:31:50 INFO  ---RUNTIME: Importing and monkey-patching took 6.08515739440918 ms
2022-09-21 15:31:53 INFO  ---RUNTIME: Original pipeline execution took 2150.8913040161133 ms (excluding imports and monkey-patching)
2022-09-21 15:31:53 INFO  Starting execution of 1 what-if analyses...
2022-09-21 15:31:53 INFO  Start plan generation for analysis DataCorruption...
2022-09-21 15:31:53 INFO  ---RUNTIME: Plan generation took 0.7295608520507812 ms
2022-09-21 15:31:53 INFO  Estimated runtime of original DAG is 1922.0380783081055ms
2022-09-21 15:31:53 WARNING Skipping Multi-Query Optimization (instead, only applying patches)
2022-09-21 15:31:53 INFO  Estimated unoptimised what-if runtime is 57661.142349243164ms
2022-09-21 15:31:53 INFO  ---RUNTIME: Multi-Query Optimization took 22.04418182373047 ms
2022-09-21 15:31:53 INFO  Executing generated plans
2022-09-21 15:32:51 INFO  ---RUNTIME: Execution took 58847.21398353577 ms
2022-09-21 15:32:51 INFO  Done!
2022-09-21 15:32:51 INFO  # Finished -- repetition 4 of 7 
2022-09-21 15:32:51 INFO  # Optimization benchmark for data_corruption with args [['healthcare', 'slow_loading', 'featurization_2', 'xgboost']] -- repetition 5 of 7
2022-09-21 15:32:51 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-21 15:32:51 INFO  Running instrumented original pipeline...
2022-09-21 15:32:51 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-21 15:32:51 INFO  ---RUNTIME: Importing and monkey-patching took 5.989551544189453 ms
2022-09-21 15:32:54 INFO  ---RUNTIME: Original pipeline execution took 2168.0386066436768 ms (excluding imports and monkey-patching)
2022-09-21 15:32:54 INFO  Starting execution of 1 what-if analyses...
2022-09-21 15:32:54 INFO  Start plan generation for analysis DataCorruption...
2022-09-21 15:32:54 INFO  ---RUNTIME: Plan generation took 0.49376487731933594 ms
2022-09-21 15:32:54 INFO  Estimated runtime of original DAG is 1939.4402503967285ms
2022-09-21 15:32:54 INFO  Performing Multi-Query Optimization
2022-09-21 15:32:54 INFO  Estimated unoptimized what-if runtime is 58183.207511901855ms
2022-09-21 15:32:54 INFO  Estimated optimised what-if runtime is 2043.4815883636475ms
2022-09-21 15:32:54 INFO  Estimated optimisation runtime saving is 56139.72592353821ms
2022-09-21 15:32:54 INFO  ---RUNTIME: Multi-Query Optimization took 81.41207695007324 ms
2022-09-21 15:32:54 INFO  Executing generated plans
2022-09-21 15:32:56 INFO  ---RUNTIME: Execution took 2113.637924194336 ms
2022-09-21 15:32:56 INFO  Done!
2022-09-21 15:32:56 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-21 15:32:56 INFO  Running instrumented original pipeline...
2022-09-21 15:32:56 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-21 15:32:56 INFO  ---RUNTIME: Importing and monkey-patching took 5.809307098388672 ms
2022-09-21 15:32:58 INFO  ---RUNTIME: Original pipeline execution took 2348.954439163208 ms (excluding imports and monkey-patching)
2022-09-21 15:32:58 INFO  Starting execution of 1 what-if analyses...
2022-09-21 15:32:58 INFO  Start plan generation for analysis DataCorruption...
2022-09-21 15:32:58 INFO  ---RUNTIME: Plan generation took 0.44989585876464844 ms
2022-09-21 15:32:58 INFO  Estimated runtime of original DAG is 2119.3230152130127ms
2022-09-21 15:32:58 WARNING Skipping Multi-Query Optimization (instead, only applying patches)
2022-09-21 15:32:58 INFO  Estimated unoptimised what-if runtime is 63579.69045639038ms
2022-09-21 15:32:58 INFO  ---RUNTIME: Multi-Query Optimization took 22.17555046081543 ms
2022-09-21 15:32:58 INFO  Executing generated plans
2022-09-21 15:33:58 INFO  ---RUNTIME: Execution took 59657.904386520386 ms
2022-09-21 15:33:58 INFO  Done!
2022-09-21 15:33:58 INFO  # Finished -- repetition 5 of 7 
2022-09-21 15:33:58 INFO  # Optimization benchmark for data_corruption with args [['healthcare', 'slow_loading', 'featurization_2', 'xgboost']] -- repetition 6 of 7
2022-09-21 15:33:58 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-21 15:33:58 INFO  Running instrumented original pipeline...
2022-09-21 15:33:58 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-21 15:33:58 INFO  ---RUNTIME: Importing and monkey-patching took 6.44993782043457 ms
2022-09-21 15:34:00 INFO  ---RUNTIME: Original pipeline execution took 2486.90128326416 ms (excluding imports and monkey-patching)
2022-09-21 15:34:00 INFO  Starting execution of 1 what-if analyses...
2022-09-21 15:34:00 INFO  Start plan generation for analysis DataCorruption...
2022-09-21 15:34:00 INFO  ---RUNTIME: Plan generation took 0.5877017974853516 ms
2022-09-21 15:34:00 INFO  Estimated runtime of original DAG is 2235.914945602417ms
2022-09-21 15:34:00 INFO  Performing Multi-Query Optimization
2022-09-21 15:34:00 INFO  Estimated unoptimized what-if runtime is 67077.44836807251ms
2022-09-21 15:34:00 INFO  Estimated optimised what-if runtime is 2353.0349731445312ms
2022-09-21 15:34:00 INFO  Estimated optimisation runtime saving is 64724.41339492798ms
2022-09-21 15:34:00 INFO  ---RUNTIME: Multi-Query Optimization took 99.65229034423828 ms
2022-09-21 15:34:00 INFO  Executing generated plans
2022-09-21 15:34:03 INFO  ---RUNTIME: Execution took 2404.208183288574 ms
2022-09-21 15:34:03 INFO  Done!
2022-09-21 15:34:03 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-21 15:34:03 INFO  Running instrumented original pipeline...
2022-09-21 15:34:03 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-21 15:34:03 INFO  ---RUNTIME: Importing and monkey-patching took 5.527496337890625 ms
2022-09-21 15:34:05 INFO  ---RUNTIME: Original pipeline execution took 2168.776512145996 ms (excluding imports and monkey-patching)
2022-09-21 15:34:05 INFO  Starting execution of 1 what-if analyses...
2022-09-21 15:34:05 INFO  Start plan generation for analysis DataCorruption...
2022-09-21 15:34:05 INFO  ---RUNTIME: Plan generation took 0.7624626159667969 ms
2022-09-21 15:34:05 INFO  Estimated runtime of original DAG is 1930.4871559143066ms
2022-09-21 15:34:05 WARNING Skipping Multi-Query Optimization (instead, only applying patches)
2022-09-21 15:34:05 INFO  Estimated unoptimised what-if runtime is 57914.6146774292ms
2022-09-21 15:34:05 INFO  ---RUNTIME: Multi-Query Optimization took 22.027015686035156 ms
2022-09-21 15:34:05 INFO  Executing generated plans
2022-09-21 15:35:05 INFO  ---RUNTIME: Execution took 59756.388664245605 ms
2022-09-21 15:35:05 INFO  Done!
2022-09-21 15:35:05 INFO  # Finished -- repetition 6 of 7 
2022-09-21 15:35:05 INFO  # Optimization benchmark for data_corruption with args [['healthcare', 'slow_loading', 'featurization_2', 'xgboost']] -- repetition 7 of 7
2022-09-21 15:35:05 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-21 15:35:05 INFO  Running instrumented original pipeline...
2022-09-21 15:35:05 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-21 15:35:05 INFO  ---RUNTIME: Importing and monkey-patching took 6.738901138305664 ms
2022-09-21 15:35:07 INFO  ---RUNTIME: Original pipeline execution took 2227.2932529449463 ms (excluding imports and monkey-patching)
2022-09-21 15:35:07 INFO  Starting execution of 1 what-if analyses...
2022-09-21 15:35:07 INFO  Start plan generation for analysis DataCorruption...
2022-09-21 15:35:07 INFO  ---RUNTIME: Plan generation took 0.8754730224609375 ms
2022-09-21 15:35:07 INFO  Estimated runtime of original DAG is 1989.0103340148926ms
2022-09-21 15:35:07 INFO  Performing Multi-Query Optimization
2022-09-21 15:35:07 INFO  Estimated unoptimized what-if runtime is 59670.31002044678ms
2022-09-21 15:35:07 INFO  Estimated optimised what-if runtime is 2098.1597900390625ms
2022-09-21 15:35:07 INFO  Estimated optimisation runtime saving is 57572.150230407715ms
2022-09-21 15:35:07 INFO  ---RUNTIME: Multi-Query Optimization took 81.08758926391602 ms
2022-09-21 15:35:07 INFO  Executing generated plans
2022-09-21 15:35:09 INFO  ---RUNTIME: Execution took 2248.002767562866 ms
2022-09-21 15:35:09 INFO  Done!
2022-09-21 15:35:09 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-21 15:35:09 INFO  Running instrumented original pipeline...
2022-09-21 15:35:09 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-21 15:35:09 INFO  ---RUNTIME: Importing and monkey-patching took 6.548643112182617 ms
2022-09-21 15:35:12 INFO  ---RUNTIME: Original pipeline execution took 2484.164237976074 ms (excluding imports and monkey-patching)
2022-09-21 15:35:12 INFO  Starting execution of 1 what-if analyses...
2022-09-21 15:35:12 INFO  Start plan generation for analysis DataCorruption...
2022-09-21 15:35:12 INFO  ---RUNTIME: Plan generation took 0.5009174346923828 ms
2022-09-21 15:35:12 INFO  Estimated runtime of original DAG is 2235.5282306671143ms
2022-09-21 15:35:12 WARNING Skipping Multi-Query Optimization (instead, only applying patches)
2022-09-21 15:35:12 INFO  Estimated unoptimised what-if runtime is 67065.84692001343ms
2022-09-21 15:35:12 INFO  ---RUNTIME: Multi-Query Optimization took 27.06146240234375 ms
2022-09-21 15:35:12 INFO  Executing generated plans
2022-09-21 15:36:12 INFO  ---RUNTIME: Execution took 59798.211097717285 ms
2022-09-21 15:36:12 INFO  Done!
2022-09-21 15:36:12 INFO  # Finished -- repetition 7 of 7 
2022-09-21 15:36:12 INFO  # Final results after all repetitions
2022-09-21 15:36:12 INFO     repetition  ... no_opt_what_if_execution_combined_model_training
0           0  ...                                      5503.655910
1           1  ...                                      5531.219959
2           2  ...                                      5511.326551
3           3  ...                                      5514.684916
4           4  ...                                      5557.844400
5           5  ...                                      5615.352154
6           6  ...                                      5551.870823

[7 rows x 26 columns]
taskset -c 0-7 PROTOCOL_BUFFERS_PYTHON_IMPLEMENTATION=python python3.9 benchmarks_end_to_end.py data_corruption healthcare slow_loading featurization_2 neural_network
2022-09-21 15:36:14.242958: W tensorflow/stream_executor/platform/default/dso_loader.cc:64] Could not load dynamic library 'libcudart.so.11.0'; dlerror: libcudart.so.11.0: cannot open shared object file: No such file or directory; LD_LIBRARY_PATH: /home/sgrafbe/mlwhatif/venv/lib/python3.9/site-packages/cv2/../../lib64:
2022-09-21 15:36:14.243004: I tensorflow/stream_executor/cuda/cudart_stub.cc:29] Ignore above cudart dlerror if you do not have a GPU set up on your machine.
2022-09-21 15:36:15 INFO  Patching sys.argv with ['mlwhatif', 'healthcare', 'slow_loading', 'featurization_2', 'neural_network']
2022-09-21 15:36:15 INFO  Running instrumented original pipeline...
2022-09-21 15:36:15 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-21 15:36:15 INFO  ---RUNTIME: Importing and monkey-patching took 95.45135498046875 ms
2022-09-21 15:36:17.721822: W tensorflow/stream_executor/platform/default/dso_loader.cc:64] Could not load dynamic library 'libcuda.so.1'; dlerror: libcuda.so.1: cannot open shared object file: No such file or directory; LD_LIBRARY_PATH: /home/sgrafbe/mlwhatif/venv/lib/python3.9/site-packages/cv2/../../lib64:
2022-09-21 15:36:17.721858: W tensorflow/stream_executor/cuda/cuda_driver.cc:326] failed call to cuInit: UNKNOWN ERROR (303)
2022-09-21 15:36:17.721884: I tensorflow/stream_executor/cuda/cuda_diagnostics.cc:156] kernel driver does not appear to be running on this host (wagyu): /proc/driver/nvidia/version does not exist
2022-09-21 15:36:17.722443: I tensorflow/core/platform/cpu_feature_guard.cc:142] This TensorFlow binary is optimized with oneAPI Deep Neural Network Library (oneDNN) to use the following CPU instructions in performance-critical operations:  AVX2 FMA
To enable them in other operations, rebuild TensorFlow with the appropriate compiler flags.
2022-09-21 15:36:18.266086: I tensorflow/compiler/mlir/mlir_graph_optimization_pass.cc:176] None of the MLIR Optimization Passes are enabled (registered 2)
2022-09-21 15:36:18.279378: I tensorflow/core/platform/profile_utils/cpu_utils.cc:114] CPU Frequency: 2595290000 Hz
2022-09-21 15:36:18 INFO  ---RUNTIME: Original pipeline execution took 2965.5921459198 ms (excluding imports and monkey-patching)
2022-09-21 15:36:18 INFO  Starting execution of 0 what-if analyses...
2022-09-21 15:36:18 INFO  Estimated runtime of original DAG is 2706.806421279907ms
2022-09-21 15:36:18 INFO  Performing Multi-Query Optimization
2022-09-21 15:36:18 INFO  Estimated unoptimized what-if runtime is 0ms
2022-09-21 15:36:18 INFO  Estimated optimised what-if runtime is 0ms
2022-09-21 15:36:18 INFO  Estimated optimisation runtime saving is 0ms
2022-09-21 15:36:18 INFO  ---RUNTIME: Multi-Query Optimization took 0.4947185516357422 ms
2022-09-21 15:36:18 INFO  Executing generated plans
2022-09-21 15:36:18 INFO  ---RUNTIME: Execution took 0.01621246337890625 ms
2022-09-21 15:36:18 INFO  Done!
2022-09-21 15:36:18 INFO  # Optimization benchmark for data_corruption with args [['healthcare', 'slow_loading', 'featurization_2', 'neural_network']] -- repetition 1 of 7
2022-09-21 15:36:18 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-21 15:36:18 INFO  Running instrumented original pipeline...
2022-09-21 15:36:18 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-21 15:36:18 INFO  ---RUNTIME: Importing and monkey-patching took 5.773067474365234 ms
2022-09-21 15:36:21 INFO  ---RUNTIME: Original pipeline execution took 2796.8876361846924 ms (excluding imports and monkey-patching)
2022-09-21 15:36:21 INFO  Starting execution of 1 what-if analyses...
2022-09-21 15:36:21 INFO  Start plan generation for analysis DataCorruption...
2022-09-21 15:36:21 INFO  ---RUNTIME: Plan generation took 1.5745162963867188 ms
2022-09-21 15:36:21 INFO  Estimated runtime of original DAG is 2553.8506507873535ms
2022-09-21 15:36:21 INFO  Performing Multi-Query Optimization
2022-09-21 15:36:21 INFO  Estimated unoptimized what-if runtime is 76615.5195236206ms
2022-09-21 15:36:21 INFO  Estimated optimised what-if runtime is 4388.90528678894ms
2022-09-21 15:36:21 INFO  Estimated optimisation runtime saving is 72226.61423683167ms
2022-09-21 15:36:21 INFO  ---RUNTIME: Multi-Query Optimization took 100.05712509155273 ms
2022-09-21 15:36:21 INFO  Executing generated plans
2022-09-21 15:36:24 INFO  ---RUNTIME: Execution took 3010.1912021636963 ms
2022-09-21 15:36:24 INFO  Done!
2022-09-21 15:36:24 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-21 15:36:24 INFO  Running instrumented original pipeline...
2022-09-21 15:36:24 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-21 15:36:24 INFO  ---RUNTIME: Importing and monkey-patching took 5.98907470703125 ms
2022-09-21 15:36:27 INFO  ---RUNTIME: Original pipeline execution took 2716.6552543640137 ms (excluding imports and monkey-patching)
2022-09-21 15:36:27 INFO  Starting execution of 1 what-if analyses...
2022-09-21 15:36:27 INFO  Start plan generation for analysis DataCorruption...
2022-09-21 15:36:27 INFO  ---RUNTIME: Plan generation took 0.4668235778808594 ms
2022-09-21 15:36:27 INFO  Estimated runtime of original DAG is 2481.441020965576ms
2022-09-21 15:36:27 WARNING Skipping Multi-Query Optimization (instead, only applying patches)
2022-09-21 15:36:27 INFO  Estimated unoptimised what-if runtime is 74443.23062896729ms
2022-09-21 15:36:27 INFO  ---RUNTIME: Multi-Query Optimization took 22.516250610351562 ms
2022-09-21 15:36:27 INFO  Executing generated plans
2022-09-21 15:37:38 INFO  ---RUNTIME: Execution took 71278.51724624634 ms
2022-09-21 15:37:38 INFO  Done!
2022-09-21 15:37:38 INFO  # Finished -- repetition 1 of 7 
2022-09-21 15:37:38 INFO  # Optimization benchmark for data_corruption with args [['healthcare', 'slow_loading', 'featurization_2', 'neural_network']] -- repetition 2 of 7
2022-09-21 15:37:38 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-21 15:37:38 INFO  Running instrumented original pipeline...
2022-09-21 15:37:38 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-21 15:37:38 INFO  ---RUNTIME: Importing and monkey-patching took 6.0214996337890625 ms
2022-09-21 15:37:41 INFO  ---RUNTIME: Original pipeline execution took 2806.3881397247314 ms (excluding imports and monkey-patching)
2022-09-21 15:37:41 INFO  Starting execution of 1 what-if analyses...
2022-09-21 15:37:41 INFO  Start plan generation for analysis DataCorruption...
2022-09-21 15:37:41 INFO  ---RUNTIME: Plan generation took 0.5106925964355469 ms
2022-09-21 15:37:41 INFO  Estimated runtime of original DAG is 2284.24072265625ms
2022-09-21 15:37:41 INFO  Performing Multi-Query Optimization
2022-09-21 15:37:41 INFO  Estimated unoptimized what-if runtime is 68527.2216796875ms
2022-09-21 15:37:41 INFO  Estimated optimised what-if runtime is 3922.65248298645ms
2022-09-21 15:37:41 INFO  Estimated optimisation runtime saving is 64604.56919670105ms
2022-09-21 15:37:41 INFO  ---RUNTIME: Multi-Query Optimization took 82.44156837463379 ms
2022-09-21 15:37:41 INFO  Executing generated plans
2022-09-21 15:37:44 INFO  ---RUNTIME: Execution took 2660.935163497925 ms
2022-09-21 15:37:44 INFO  Done!
2022-09-21 15:37:44 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-21 15:37:44 INFO  Running instrumented original pipeline...
2022-09-21 15:37:44 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-21 15:37:44 INFO  ---RUNTIME: Importing and monkey-patching took 5.794048309326172 ms
2022-09-21 15:37:46 INFO  ---RUNTIME: Original pipeline execution took 2511.827230453491 ms (excluding imports and monkey-patching)
2022-09-21 15:37:46 INFO  Starting execution of 1 what-if analyses...
2022-09-21 15:37:46 INFO  Start plan generation for analysis DataCorruption...
2022-09-21 15:37:46 INFO  ---RUNTIME: Plan generation took 0.5838871002197266 ms
2022-09-21 15:37:46 INFO  Estimated runtime of original DAG is 2282.353401184082ms
2022-09-21 15:37:46 WARNING Skipping Multi-Query Optimization (instead, only applying patches)
2022-09-21 15:37:46 INFO  Estimated unoptimised what-if runtime is 68470.60203552246ms
2022-09-21 15:37:46 INFO  ---RUNTIME: Multi-Query Optimization took 22.753238677978516 ms
2022-09-21 15:37:46 INFO  Executing generated plans
2022-09-21 15:38:58 INFO  ---RUNTIME: Execution took 71496.55055999756 ms
2022-09-21 15:38:58 INFO  Done!
2022-09-21 15:38:58 INFO  # Finished -- repetition 2 of 7 
2022-09-21 15:38:58 INFO  # Optimization benchmark for data_corruption with args [['healthcare', 'slow_loading', 'featurization_2', 'neural_network']] -- repetition 3 of 7
2022-09-21 15:38:58 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-21 15:38:58 INFO  Running instrumented original pipeline...
2022-09-21 15:38:58 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-21 15:38:58 INFO  ---RUNTIME: Importing and monkey-patching took 5.920171737670898 ms
2022-09-21 15:39:00 INFO  ---RUNTIME: Original pipeline execution took 2810.6069564819336 ms (excluding imports and monkey-patching)
2022-09-21 15:39:00 INFO  Starting execution of 1 what-if analyses...
2022-09-21 15:39:00 INFO  Start plan generation for analysis DataCorruption...
2022-09-21 15:39:00 INFO  ---RUNTIME: Plan generation took 0.49233436584472656 ms
2022-09-21 15:39:00 INFO  Estimated runtime of original DAG is 2581.756114959717ms
2022-09-21 15:39:00 INFO  Performing Multi-Query Optimization
2022-09-21 15:39:00 INFO  Estimated unoptimized what-if runtime is 77452.6834487915ms
2022-09-21 15:39:00 INFO  Estimated optimised what-if runtime is 4232.5990200042725ms
2022-09-21 15:39:00 INFO  Estimated optimisation runtime saving is 73220.08442878723ms
2022-09-21 15:39:00 INFO  ---RUNTIME: Multi-Query Optimization took 81.83932304382324 ms
2022-09-21 15:39:00 INFO  Executing generated plans
2022-09-21 15:39:03 INFO  ---RUNTIME: Execution took 2593.031644821167 ms
2022-09-21 15:39:03 INFO  Done!
2022-09-21 15:39:03 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-21 15:39:03 INFO  Running instrumented original pipeline...
2022-09-21 15:39:03 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-21 15:39:03 INFO  ---RUNTIME: Importing and monkey-patching took 5.641698837280273 ms
2022-09-21 15:39:06 INFO  ---RUNTIME: Original pipeline execution took 2537.1954441070557 ms (excluding imports and monkey-patching)
2022-09-21 15:39:06 INFO  Starting execution of 1 what-if analyses...
2022-09-21 15:39:06 INFO  Start plan generation for analysis DataCorruption...
2022-09-21 15:39:06 INFO  ---RUNTIME: Plan generation took 0.6122589111328125 ms
2022-09-21 15:39:06 INFO  Estimated runtime of original DAG is 2308.8841438293457ms
2022-09-21 15:39:06 WARNING Skipping Multi-Query Optimization (instead, only applying patches)
2022-09-21 15:39:06 INFO  Estimated unoptimised what-if runtime is 69266.52431488037ms
2022-09-21 15:39:06 INFO  ---RUNTIME: Multi-Query Optimization took 22.809743881225586 ms
2022-09-21 15:39:06 INFO  Executing generated plans
2022-09-21 15:40:17 INFO  ---RUNTIME: Execution took 71719.65599060059 ms
2022-09-21 15:40:17 INFO  Done!
2022-09-21 15:40:17 INFO  # Finished -- repetition 3 of 7 
2022-09-21 15:40:17 INFO  # Optimization benchmark for data_corruption with args [['healthcare', 'slow_loading', 'featurization_2', 'neural_network']] -- repetition 4 of 7
2022-09-21 15:40:17 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-21 15:40:17 INFO  Running instrumented original pipeline...
2022-09-21 15:40:17 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-21 15:40:17 INFO  ---RUNTIME: Importing and monkey-patching took 6.503582000732422 ms
2022-09-21 15:40:20 INFO  ---RUNTIME: Original pipeline execution took 2519.122838973999 ms (excluding imports and monkey-patching)
2022-09-21 15:40:20 INFO  Starting execution of 1 what-if analyses...
2022-09-21 15:40:20 INFO  Start plan generation for analysis DataCorruption...
2022-09-21 15:40:20 INFO  ---RUNTIME: Plan generation took 0.6167888641357422 ms
2022-09-21 15:40:20 INFO  Estimated runtime of original DAG is 2274.5563983917236ms
2022-09-21 15:40:20 INFO  Performing Multi-Query Optimization
2022-09-21 15:40:20 INFO  Estimated unoptimized what-if runtime is 68236.69195175171ms
2022-09-21 15:40:20 INFO  Estimated optimised what-if runtime is 3909.1084003448486ms
2022-09-21 15:40:20 INFO  Estimated optimisation runtime saving is 64327.58355140686ms
2022-09-21 15:40:20 INFO  ---RUNTIME: Multi-Query Optimization took 82.50021934509277 ms
2022-09-21 15:40:20 INFO  Executing generated plans
2022-09-21 15:40:23 INFO  ---RUNTIME: Execution took 3001.984119415283 ms
2022-09-21 15:40:23 INFO  Done!
2022-09-21 15:40:23 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-21 15:40:23 INFO  Running instrumented original pipeline...
2022-09-21 15:40:23 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-21 15:40:23 INFO  ---RUNTIME: Importing and monkey-patching took 5.721569061279297 ms
2022-09-21 15:40:26 INFO  ---RUNTIME: Original pipeline execution took 2539.3221378326416 ms (excluding imports and monkey-patching)
2022-09-21 15:40:26 INFO  Starting execution of 1 what-if analyses...
2022-09-21 15:40:26 INFO  Start plan generation for analysis DataCorruption...
2022-09-21 15:40:26 INFO  ---RUNTIME: Plan generation took 0.5753040313720703 ms
2022-09-21 15:40:26 INFO  Estimated runtime of original DAG is 2310.190439224243ms
2022-09-21 15:40:26 WARNING Skipping Multi-Query Optimization (instead, only applying patches)
2022-09-21 15:40:26 INFO  Estimated unoptimised what-if runtime is 69305.7131767273ms
2022-09-21 15:40:26 INFO  ---RUNTIME: Multi-Query Optimization took 23.357629776000977 ms
2022-09-21 15:40:26 INFO  Executing generated plans
2022-09-21 15:41:37 INFO  ---RUNTIME: Execution took 71415.28153419495 ms
2022-09-21 15:41:37 INFO  Done!
2022-09-21 15:41:37 INFO  # Finished -- repetition 4 of 7 
2022-09-21 15:41:37 INFO  # Optimization benchmark for data_corruption with args [['healthcare', 'slow_loading', 'featurization_2', 'neural_network']] -- repetition 5 of 7
2022-09-21 15:41:37 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-21 15:41:37 INFO  Running instrumented original pipeline...
2022-09-21 15:41:37 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-21 15:41:37 INFO  ---RUNTIME: Importing and monkey-patching took 6.009340286254883 ms
2022-09-21 15:41:39 INFO  ---RUNTIME: Original pipeline execution took 2505.0923824310303 ms (excluding imports and monkey-patching)
2022-09-21 15:41:39 INFO  Starting execution of 1 what-if analyses...
2022-09-21 15:41:39 INFO  Start plan generation for analysis DataCorruption...
2022-09-21 15:41:39 INFO  ---RUNTIME: Plan generation took 1.4815330505371094 ms
2022-09-21 15:41:39 INFO  Estimated runtime of original DAG is 2273.4553813934326ms
2022-09-21 15:41:39 INFO  Performing Multi-Query Optimization
2022-09-21 15:41:40 INFO  Estimated unoptimized what-if runtime is 68203.66144180298ms
2022-09-21 15:41:40 INFO  Estimated optimised what-if runtime is 3892.6894664764404ms
2022-09-21 15:41:40 INFO  Estimated optimisation runtime saving is 64310.97197532654ms
2022-09-21 15:41:40 INFO  ---RUNTIME: Multi-Query Optimization took 81.12907409667969 ms
2022-09-21 15:41:40 INFO  Executing generated plans
2022-09-21 15:41:42 INFO  ---RUNTIME: Execution took 2596.7047214508057 ms
2022-09-21 15:41:42 INFO  Done!
2022-09-21 15:41:42 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-21 15:41:42 INFO  Running instrumented original pipeline...
2022-09-21 15:41:42 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-21 15:41:42 INFO  ---RUNTIME: Importing and monkey-patching took 6.897449493408203 ms
2022-09-21 15:41:45 INFO  ---RUNTIME: Original pipeline execution took 2504.5228004455566 ms (excluding imports and monkey-patching)
2022-09-21 15:41:45 INFO  Starting execution of 1 what-if analyses...
2022-09-21 15:41:45 INFO  Start plan generation for analysis DataCorruption...
2022-09-21 15:41:45 INFO  ---RUNTIME: Plan generation took 0.4889965057373047 ms
2022-09-21 15:41:45 INFO  Estimated runtime of original DAG is 2260.704517364502ms
2022-09-21 15:41:45 WARNING Skipping Multi-Query Optimization (instead, only applying patches)
2022-09-21 15:41:45 INFO  Estimated unoptimised what-if runtime is 67821.13552093506ms
2022-09-21 15:41:45 INFO  ---RUNTIME: Multi-Query Optimization took 22.544384002685547 ms
2022-09-21 15:41:45 INFO  Executing generated plans
2022-09-21 15:42:55 INFO  ---RUNTIME: Execution took 70536.53073310852 ms
2022-09-21 15:42:55 INFO  Done!
2022-09-21 15:42:55 INFO  # Finished -- repetition 5 of 7 
2022-09-21 15:42:55 INFO  # Optimization benchmark for data_corruption with args [['healthcare', 'slow_loading', 'featurization_2', 'neural_network']] -- repetition 6 of 7
2022-09-21 15:42:55 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-21 15:42:55 INFO  Running instrumented original pipeline...
2022-09-21 15:42:55 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-21 15:42:55 INFO  ---RUNTIME: Importing and monkey-patching took 6.046772003173828 ms
2022-09-21 15:42:58 INFO  ---RUNTIME: Original pipeline execution took 2468.6508178710938 ms (excluding imports and monkey-patching)
2022-09-21 15:42:58 INFO  Starting execution of 1 what-if analyses...
2022-09-21 15:42:58 INFO  Start plan generation for analysis DataCorruption...
2022-09-21 15:42:58 INFO  ---RUNTIME: Plan generation took 0.583648681640625 ms
2022-09-21 15:42:58 INFO  Estimated runtime of original DAG is 2236.372470855713ms
2022-09-21 15:42:58 INFO  Performing Multi-Query Optimization
2022-09-21 15:42:58 INFO  Estimated unoptimized what-if runtime is 67091.17412567139ms
2022-09-21 15:42:58 INFO  Estimated optimised what-if runtime is 3993.445873260498ms
2022-09-21 15:42:58 INFO  Estimated optimisation runtime saving is 63097.72825241089ms
2022-09-21 15:42:58 INFO  ---RUNTIME: Multi-Query Optimization took 83.91761779785156 ms
2022-09-21 15:42:58 INFO  Executing generated plans
2022-09-21 15:43:00 INFO  ---RUNTIME: Execution took 2566.4522647857666 ms
2022-09-21 15:43:00 INFO  Done!
2022-09-21 15:43:00 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-21 15:43:00 INFO  Running instrumented original pipeline...
2022-09-21 15:43:00 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-21 15:43:00 INFO  ---RUNTIME: Importing and monkey-patching took 6.125926971435547 ms
2022-09-21 15:43:03 INFO  ---RUNTIME: Original pipeline execution took 2909.5535278320312 ms (excluding imports and monkey-patching)
2022-09-21 15:43:03 INFO  Starting execution of 1 what-if analyses...
2022-09-21 15:43:03 INFO  Start plan generation for analysis DataCorruption...
2022-09-21 15:43:03 INFO  ---RUNTIME: Plan generation took 0.4622936248779297 ms
2022-09-21 15:43:03 INFO  Estimated runtime of original DAG is 2677.2449016571045ms
2022-09-21 15:43:03 WARNING Skipping Multi-Query Optimization (instead, only applying patches)
2022-09-21 15:43:03 INFO  Estimated unoptimised what-if runtime is 80317.34704971313ms
2022-09-21 15:43:03 INFO  ---RUNTIME: Multi-Query Optimization took 22.95541763305664 ms
2022-09-21 15:43:03 INFO  Executing generated plans
2022-09-21 15:44:14 INFO  ---RUNTIME: Execution took 70510.90931892395 ms
2022-09-21 15:44:14 INFO  Done!
2022-09-21 15:44:14 INFO  # Finished -- repetition 6 of 7 
2022-09-21 15:44:14 INFO  # Optimization benchmark for data_corruption with args [['healthcare', 'slow_loading', 'featurization_2', 'neural_network']] -- repetition 7 of 7
2022-09-21 15:44:14 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-21 15:44:14 INFO  Running instrumented original pipeline...
2022-09-21 15:44:14 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-21 15:44:14 INFO  ---RUNTIME: Importing and monkey-patching took 5.711555480957031 ms
2022-09-21 15:44:16 INFO  ---RUNTIME: Original pipeline execution took 2468.3029651641846 ms (excluding imports and monkey-patching)
2022-09-21 15:44:16 INFO  Starting execution of 1 what-if analyses...
2022-09-21 15:44:16 INFO  Start plan generation for analysis DataCorruption...
2022-09-21 15:44:16 INFO  ---RUNTIME: Plan generation took 1.5022754669189453 ms
2022-09-21 15:44:16 INFO  Estimated runtime of original DAG is 2237.11895942688ms
2022-09-21 15:44:16 INFO  Performing Multi-Query Optimization
2022-09-21 15:44:16 INFO  Estimated unoptimized what-if runtime is 67113.5687828064ms
2022-09-21 15:44:16 INFO  Estimated optimised what-if runtime is 3843.147039413452ms
2022-09-21 15:44:16 INFO  Estimated optimisation runtime saving is 63270.421743392944ms
2022-09-21 15:44:16 INFO  ---RUNTIME: Multi-Query Optimization took 81.4371109008789 ms
2022-09-21 15:44:16 INFO  Executing generated plans
2022-09-21 15:44:19 INFO  ---RUNTIME: Execution took 2563.9584064483643 ms
2022-09-21 15:44:19 INFO  Done!
2022-09-21 15:44:19 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-21 15:44:19 INFO  Running instrumented original pipeline...
2022-09-21 15:44:19 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-21 15:44:19 INFO  ---RUNTIME: Importing and monkey-patching took 6.093263626098633 ms
2022-09-21 15:44:22 INFO  ---RUNTIME: Original pipeline execution took 2869.788646697998 ms (excluding imports and monkey-patching)
2022-09-21 15:44:22 INFO  Starting execution of 1 what-if analyses...
2022-09-21 15:44:22 INFO  Start plan generation for analysis DataCorruption...
2022-09-21 15:44:22 INFO  ---RUNTIME: Plan generation took 0.4818439483642578 ms
2022-09-21 15:44:22 INFO  Estimated runtime of original DAG is 2641.653060913086ms
2022-09-21 15:44:22 WARNING Skipping Multi-Query Optimization (instead, only applying patches)
2022-09-21 15:44:22 INFO  Estimated unoptimised what-if runtime is 79249.59182739258ms
2022-09-21 15:44:22 INFO  ---RUNTIME: Multi-Query Optimization took 23.3917236328125 ms
2022-09-21 15:44:22 INFO  Executing generated plans
2022-09-21 15:45:31 INFO  ---RUNTIME: Execution took 69644.86479759216 ms
2022-09-21 15:45:31 INFO  Done!
2022-09-21 15:45:31 INFO  # Finished -- repetition 7 of 7 
2022-09-21 15:45:31 INFO  # Final results after all repetitions
2022-09-21 15:45:31 INFO     repetition  ... no_opt_what_if_execution_combined_model_training
0           0  ...                                     14308.857679
1           1  ...                                     14655.227661
2           2  ...                                     14800.853968
3           3  ...                                     14954.931974
4           4  ...                                     14811.336517
5           5  ...                                     14275.609732
6           6  ...                                     14622.131586

[7 rows x 26 columns]
taskset -c 0-7 PROTOCOL_BUFFERS_PYTHON_IMPLEMENTATION=python python3.9 benchmarks_end_to_end.py data_corruption healthcare slow_loading featurization_3 logistic_regression
2022-09-21 15:45:34.375903: W tensorflow/stream_executor/platform/default/dso_loader.cc:64] Could not load dynamic library 'libcudart.so.11.0'; dlerror: libcudart.so.11.0: cannot open shared object file: No such file or directory; LD_LIBRARY_PATH: /home/sgrafbe/mlwhatif/venv/lib/python3.9/site-packages/cv2/../../lib64:
2022-09-21 15:45:34.375944: I tensorflow/stream_executor/cuda/cudart_stub.cc:29] Ignore above cudart dlerror if you do not have a GPU set up on your machine.
2022-09-21 15:45:35 INFO  Patching sys.argv with ['mlwhatif', 'healthcare', 'slow_loading', 'featurization_3', 'logistic_regression']
2022-09-21 15:45:35 INFO  Running instrumented original pipeline...
2022-09-21 15:45:35 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-21 15:45:35 INFO  ---RUNTIME: Importing and monkey-patching took 98.41060638427734 ms
2022-09-21 15:45:37 INFO  ---RUNTIME: Original pipeline execution took 2163.489580154419 ms (excluding imports and monkey-patching)
2022-09-21 15:45:37 INFO  Starting execution of 0 what-if analyses...
2022-09-21 15:45:37 INFO  Estimated runtime of original DAG is 1818.7382221221924ms
2022-09-21 15:45:37 INFO  Performing Multi-Query Optimization
2022-09-21 15:45:37 INFO  Estimated unoptimized what-if runtime is 0ms
2022-09-21 15:45:37 INFO  Estimated optimised what-if runtime is 0ms
2022-09-21 15:45:37 INFO  Estimated optimisation runtime saving is 0ms
2022-09-21 15:45:37 INFO  ---RUNTIME: Multi-Query Optimization took 0.5254745483398438 ms
2022-09-21 15:45:37 INFO  Executing generated plans
2022-09-21 15:45:37 INFO  ---RUNTIME: Execution took 0.022411346435546875 ms
2022-09-21 15:45:37 INFO  Done!
2022-09-21 15:45:37 INFO  # Optimization benchmark for data_corruption with args [['healthcare', 'slow_loading', 'featurization_3', 'logistic_regression']] -- repetition 1 of 7
2022-09-21 15:45:37 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-21 15:45:37 INFO  Running instrumented original pipeline...
2022-09-21 15:45:37 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-21 15:45:37 INFO  ---RUNTIME: Importing and monkey-patching took 5.148887634277344 ms
2022-09-21 15:45:40 INFO  ---RUNTIME: Original pipeline execution took 2093.5792922973633 ms (excluding imports and monkey-patching)
2022-09-21 15:45:40 INFO  Starting execution of 1 what-if analyses...
2022-09-21 15:45:40 INFO  Start plan generation for analysis DataCorruption...
2022-09-21 15:45:40 INFO  ---RUNTIME: Plan generation took 0.5388259887695312 ms
2022-09-21 15:45:40 INFO  Estimated runtime of original DAG is 1777.8253555297852ms
2022-09-21 15:45:40 INFO  Performing Multi-Query Optimization
2022-09-21 15:45:40 INFO  Estimated unoptimized what-if runtime is 53334.760665893555ms
2022-09-21 15:45:40 INFO  Estimated optimised what-if runtime is 1840.6102657318115ms
2022-09-21 15:45:40 INFO  Estimated optimisation runtime saving is 51494.15040016174ms
2022-09-21 15:45:40 INFO  ---RUNTIME: Multi-Query Optimization took 273.9396095275879 ms
2022-09-21 15:45:40 INFO  Executing generated plans
2022-09-21 15:45:42 INFO  ---RUNTIME: Execution took 1926.4929294586182 ms
2022-09-21 15:45:42 INFO  Done!
2022-09-21 15:45:42 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-21 15:45:42 INFO  Running instrumented original pipeline...
2022-09-21 15:45:42 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-21 15:45:42 INFO  ---RUNTIME: Importing and monkey-patching took 6.140470504760742 ms
2022-09-21 15:45:44 INFO  ---RUNTIME: Original pipeline execution took 2076.5140056610107 ms (excluding imports and monkey-patching)
2022-09-21 15:45:44 INFO  Starting execution of 1 what-if analyses...
2022-09-21 15:45:44 INFO  Start plan generation for analysis DataCorruption...
2022-09-21 15:45:44 INFO  ---RUNTIME: Plan generation took 0.6933212280273438 ms
2022-09-21 15:45:44 INFO  Estimated runtime of original DAG is 1763.8893127441406ms
2022-09-21 15:45:44 WARNING Skipping Multi-Query Optimization (instead, only applying patches)
2022-09-21 15:45:44 INFO  Estimated unoptimised what-if runtime is 52916.67938232422ms
2022-09-21 15:45:44 INFO  ---RUNTIME: Multi-Query Optimization took 26.305198669433594 ms
2022-09-21 15:45:44 INFO  Executing generated plans
2022-09-21 15:46:38 INFO  ---RUNTIME: Execution took 54167.2580242157 ms
2022-09-21 15:46:38 INFO  Done!
2022-09-21 15:46:38 INFO  # Finished -- repetition 1 of 7 
2022-09-21 15:46:38 INFO  # Optimization benchmark for data_corruption with args [['healthcare', 'slow_loading', 'featurization_3', 'logistic_regression']] -- repetition 2 of 7
2022-09-21 15:46:38 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-21 15:46:38 INFO  Running instrumented original pipeline...
2022-09-21 15:46:38 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-21 15:46:38 INFO  ---RUNTIME: Importing and monkey-patching took 5.978107452392578 ms
2022-09-21 15:46:40 INFO  ---RUNTIME: Original pipeline execution took 2095.1080322265625 ms (excluding imports and monkey-patching)
2022-09-21 15:46:40 INFO  Starting execution of 1 what-if analyses...
2022-09-21 15:46:40 INFO  Start plan generation for analysis DataCorruption...
2022-09-21 15:46:40 INFO  ---RUNTIME: Plan generation took 0.4601478576660156 ms
2022-09-21 15:46:40 INFO  Estimated runtime of original DAG is 1780.6615829467773ms
2022-09-21 15:46:40 INFO  Performing Multi-Query Optimization
2022-09-21 15:46:40 INFO  Estimated unoptimized what-if runtime is 53419.84748840332ms
2022-09-21 15:46:40 INFO  Estimated optimised what-if runtime is 1842.3807621002197ms
2022-09-21 15:46:40 INFO  Estimated optimisation runtime saving is 51577.4667263031ms
2022-09-21 15:46:40 INFO  ---RUNTIME: Multi-Query Optimization took 95.0462818145752 ms
2022-09-21 15:46:40 INFO  Executing generated plans
2022-09-21 15:46:42 INFO  ---RUNTIME: Execution took 1896.2044715881348 ms
2022-09-21 15:46:42 INFO  Done!
2022-09-21 15:46:42 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-21 15:46:42 INFO  Running instrumented original pipeline...
2022-09-21 15:46:42 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-21 15:46:42 INFO  ---RUNTIME: Importing and monkey-patching took 5.687952041625977 ms
2022-09-21 15:46:44 INFO  ---RUNTIME: Original pipeline execution took 2088.707447052002 ms (excluding imports and monkey-patching)
2022-09-21 15:46:44 INFO  Starting execution of 1 what-if analyses...
2022-09-21 15:46:44 INFO  Start plan generation for analysis DataCorruption...
2022-09-21 15:46:44 INFO  ---RUNTIME: Plan generation took 0.7183551788330078 ms
2022-09-21 15:46:44 INFO  Estimated runtime of original DAG is 1775.1991748809814ms
2022-09-21 15:46:44 WARNING Skipping Multi-Query Optimization (instead, only applying patches)
2022-09-21 15:46:44 INFO  Estimated unoptimised what-if runtime is 53255.97524642944ms
2022-09-21 15:46:44 INFO  ---RUNTIME: Multi-Query Optimization took 217.6809310913086 ms
2022-09-21 15:46:44 INFO  Executing generated plans
2022-09-21 15:47:38 INFO  ---RUNTIME: Execution took 53995.99480628967 ms
2022-09-21 15:47:38 INFO  Done!
2022-09-21 15:47:38 INFO  # Finished -- repetition 2 of 7 
2022-09-21 15:47:38 INFO  # Optimization benchmark for data_corruption with args [['healthcare', 'slow_loading', 'featurization_3', 'logistic_regression']] -- repetition 3 of 7
2022-09-21 15:47:38 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-21 15:47:38 INFO  Running instrumented original pipeline...
2022-09-21 15:47:38 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-21 15:47:38 INFO  ---RUNTIME: Importing and monkey-patching took 5.990505218505859 ms
2022-09-21 15:47:41 INFO  ---RUNTIME: Original pipeline execution took 2088.6471271514893 ms (excluding imports and monkey-patching)
2022-09-21 15:47:41 INFO  Starting execution of 1 what-if analyses...
2022-09-21 15:47:41 INFO  Start plan generation for analysis DataCorruption...
2022-09-21 15:47:41 INFO  ---RUNTIME: Plan generation took 0.457763671875 ms
2022-09-21 15:47:41 INFO  Estimated runtime of original DAG is 1774.7204303741455ms
2022-09-21 15:47:41 INFO  Performing Multi-Query Optimization
2022-09-21 15:47:41 INFO  Estimated unoptimized what-if runtime is 53241.612911224365ms
2022-09-21 15:47:41 INFO  Estimated optimised what-if runtime is 1836.6775512695312ms
2022-09-21 15:47:41 INFO  Estimated optimisation runtime saving is 51404.935359954834ms
2022-09-21 15:47:41 INFO  ---RUNTIME: Multi-Query Optimization took 94.64526176452637 ms
2022-09-21 15:47:41 INFO  Executing generated plans
2022-09-21 15:47:43 INFO  ---RUNTIME: Execution took 1903.2223224639893 ms
2022-09-21 15:47:43 INFO  Done!
2022-09-21 15:47:43 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-21 15:47:43 INFO  Running instrumented original pipeline...
2022-09-21 15:47:43 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-21 15:47:43 INFO  ---RUNTIME: Importing and monkey-patching took 5.663156509399414 ms
2022-09-21 15:47:45 INFO  ---RUNTIME: Original pipeline execution took 2077.516794204712 ms (excluding imports and monkey-patching)
2022-09-21 15:47:45 INFO  Starting execution of 1 what-if analyses...
2022-09-21 15:47:45 INFO  Start plan generation for analysis DataCorruption...
2022-09-21 15:47:45 INFO  ---RUNTIME: Plan generation took 0.4436969757080078 ms
2022-09-21 15:47:45 INFO  Estimated runtime of original DAG is 1766.1981582641602ms
2022-09-21 15:47:45 WARNING Skipping Multi-Query Optimization (instead, only applying patches)
2022-09-21 15:47:45 INFO  Estimated unoptimised what-if runtime is 52985.944747924805ms
2022-09-21 15:47:45 INFO  ---RUNTIME: Multi-Query Optimization took 26.2753963470459 ms
2022-09-21 15:47:45 INFO  Executing generated plans
2022-09-21 15:48:39 INFO  ---RUNTIME: Execution took 54040.71545600891 ms
2022-09-21 15:48:39 INFO  Done!
2022-09-21 15:48:39 INFO  # Finished -- repetition 3 of 7 
2022-09-21 15:48:39 INFO  # Optimization benchmark for data_corruption with args [['healthcare', 'slow_loading', 'featurization_3', 'logistic_regression']] -- repetition 4 of 7
2022-09-21 15:48:39 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-21 15:48:39 INFO  Running instrumented original pipeline...
2022-09-21 15:48:39 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-21 15:48:39 INFO  ---RUNTIME: Importing and monkey-patching took 5.995988845825195 ms
2022-09-21 15:48:41 INFO  ---RUNTIME: Original pipeline execution took 2467.2012329101562 ms (excluding imports and monkey-patching)
2022-09-21 15:48:41 INFO  Starting execution of 1 what-if analyses...
2022-09-21 15:48:41 INFO  Start plan generation for analysis DataCorruption...
2022-09-21 15:48:41 INFO  ---RUNTIME: Plan generation took 0.4811286926269531 ms
2022-09-21 15:48:41 INFO  Estimated runtime of original DAG is 2154.017686843872ms
2022-09-21 15:48:41 INFO  Performing Multi-Query Optimization
2022-09-21 15:48:41 INFO  Estimated unoptimized what-if runtime is 64620.53060531616ms
2022-09-21 15:48:41 INFO  Estimated optimised what-if runtime is 2215.8000469207764ms
2022-09-21 15:48:41 INFO  Estimated optimisation runtime saving is 62404.730558395386ms
2022-09-21 15:48:41 INFO  ---RUNTIME: Multi-Query Optimization took 95.08228302001953 ms
2022-09-21 15:48:41 INFO  Executing generated plans
2022-09-21 15:48:43 INFO  ---RUNTIME: Execution took 1988.3384704589844 ms
2022-09-21 15:48:43 INFO  Done!
2022-09-21 15:48:43 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-21 15:48:43 INFO  Running instrumented original pipeline...
2022-09-21 15:48:43 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-21 15:48:43 INFO  ---RUNTIME: Importing and monkey-patching took 6.031036376953125 ms
2022-09-21 15:48:45 INFO  ---RUNTIME: Original pipeline execution took 2093.520402908325 ms (excluding imports and monkey-patching)
2022-09-21 15:48:45 INFO  Starting execution of 1 what-if analyses...
2022-09-21 15:48:45 INFO  Start plan generation for analysis DataCorruption...
2022-09-21 15:48:45 INFO  ---RUNTIME: Plan generation took 0.4699230194091797 ms
2022-09-21 15:48:45 INFO  Estimated runtime of original DAG is 1777.1492004394531ms
2022-09-21 15:48:45 WARNING Skipping Multi-Query Optimization (instead, only applying patches)
2022-09-21 15:48:45 INFO  Estimated unoptimised what-if runtime is 53314.476013183594ms
2022-09-21 15:48:45 INFO  ---RUNTIME: Multi-Query Optimization took 26.52740478515625 ms
2022-09-21 15:48:45 INFO  Executing generated plans
2022-09-21 15:49:40 INFO  ---RUNTIME: Execution took 54145.82395553589 ms
2022-09-21 15:49:40 INFO  Done!
2022-09-21 15:49:40 INFO  # Finished -- repetition 4 of 7 
2022-09-21 15:49:40 INFO  # Optimization benchmark for data_corruption with args [['healthcare', 'slow_loading', 'featurization_3', 'logistic_regression']] -- repetition 5 of 7
2022-09-21 15:49:40 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-21 15:49:40 INFO  Running instrumented original pipeline...
2022-09-21 15:49:40 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-21 15:49:40 INFO  ---RUNTIME: Importing and monkey-patching took 5.612850189208984 ms
2022-09-21 15:49:42 INFO  ---RUNTIME: Original pipeline execution took 2099.144697189331 ms (excluding imports and monkey-patching)
2022-09-21 15:49:42 INFO  Starting execution of 1 what-if analyses...
2022-09-21 15:49:42 INFO  Start plan generation for analysis DataCorruption...
2022-09-21 15:49:42 INFO  ---RUNTIME: Plan generation took 0.46062469482421875 ms
2022-09-21 15:49:42 INFO  Estimated runtime of original DAG is 1785.9411239624023ms
2022-09-21 15:49:42 INFO  Performing Multi-Query Optimization
2022-09-21 15:49:42 INFO  Estimated unoptimized what-if runtime is 53578.23371887207ms
2022-09-21 15:49:42 INFO  Estimated optimised what-if runtime is 1847.235918045044ms
2022-09-21 15:49:42 INFO  Estimated optimisation runtime saving is 51730.99780082703ms
2022-09-21 15:49:42 INFO  ---RUNTIME: Multi-Query Optimization took 94.9704647064209 ms
2022-09-21 15:49:42 INFO  Executing generated plans
2022-09-21 15:49:44 INFO  ---RUNTIME: Execution took 1964.6046161651611 ms
2022-09-21 15:49:44 INFO  Done!
2022-09-21 15:49:44 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-21 15:49:44 INFO  Running instrumented original pipeline...
2022-09-21 15:49:44 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-21 15:49:44 INFO  ---RUNTIME: Importing and monkey-patching took 6.086826324462891 ms
2022-09-21 15:49:46 INFO  ---RUNTIME: Original pipeline execution took 2088.0017280578613 ms (excluding imports and monkey-patching)
2022-09-21 15:49:46 INFO  Starting execution of 1 what-if analyses...
2022-09-21 15:49:46 INFO  Start plan generation for analysis DataCorruption...
2022-09-21 15:49:46 INFO  ---RUNTIME: Plan generation took 0.7441043853759766 ms
2022-09-21 15:49:46 INFO  Estimated runtime of original DAG is 1772.5002765655518ms
2022-09-21 15:49:46 WARNING Skipping Multi-Query Optimization (instead, only applying patches)
2022-09-21 15:49:46 INFO  Estimated unoptimised what-if runtime is 53175.00829696655ms
2022-09-21 15:49:46 INFO  ---RUNTIME: Multi-Query Optimization took 26.352643966674805 ms
2022-09-21 15:49:46 INFO  Executing generated plans
2022-09-21 15:50:40 INFO  ---RUNTIME: Execution took 54221.43602371216 ms
2022-09-21 15:50:40 INFO  Done!
2022-09-21 15:50:40 INFO  # Finished -- repetition 5 of 7 
2022-09-21 15:50:40 INFO  # Optimization benchmark for data_corruption with args [['healthcare', 'slow_loading', 'featurization_3', 'logistic_regression']] -- repetition 6 of 7
2022-09-21 15:50:40 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-21 15:50:40 INFO  Running instrumented original pipeline...
2022-09-21 15:50:40 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-21 15:50:40 INFO  ---RUNTIME: Importing and monkey-patching took 6.2408447265625 ms
2022-09-21 15:50:42 INFO  ---RUNTIME: Original pipeline execution took 2061.7775917053223 ms (excluding imports and monkey-patching)
2022-09-21 15:50:42 INFO  Starting execution of 1 what-if analyses...
2022-09-21 15:50:42 INFO  Start plan generation for analysis DataCorruption...
2022-09-21 15:50:42 INFO  ---RUNTIME: Plan generation took 0.492095947265625 ms
2022-09-21 15:50:42 INFO  Estimated runtime of original DAG is 1750.8227825164795ms
2022-09-21 15:50:42 INFO  Performing Multi-Query Optimization
2022-09-21 15:50:42 INFO  Estimated unoptimized what-if runtime is 52524.683475494385ms
2022-09-21 15:50:42 INFO  Estimated optimised what-if runtime is 1812.9222393035889ms
2022-09-21 15:50:42 INFO  Estimated optimisation runtime saving is 50711.761236190796ms
2022-09-21 15:50:42 INFO  ---RUNTIME: Multi-Query Optimization took 94.79618072509766 ms
2022-09-21 15:50:42 INFO  Executing generated plans
2022-09-21 15:50:44 INFO  ---RUNTIME: Execution took 1907.1595668792725 ms
2022-09-21 15:50:44 INFO  Done!
2022-09-21 15:50:44 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-21 15:50:44 INFO  Running instrumented original pipeline...
2022-09-21 15:50:44 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-21 15:50:44 INFO  ---RUNTIME: Importing and monkey-patching took 5.5942535400390625 ms
2022-09-21 15:50:46 INFO  ---RUNTIME: Original pipeline execution took 2074.6328830718994 ms (excluding imports and monkey-patching)
2022-09-21 15:50:46 INFO  Starting execution of 1 what-if analyses...
2022-09-21 15:50:46 INFO  Start plan generation for analysis DataCorruption...
2022-09-21 15:50:46 INFO  ---RUNTIME: Plan generation took 0.7207393646240234 ms
2022-09-21 15:50:46 INFO  Estimated runtime of original DAG is 1761.8827819824219ms
2022-09-21 15:50:46 WARNING Skipping Multi-Query Optimization (instead, only applying patches)
2022-09-21 15:50:46 INFO  Estimated unoptimised what-if runtime is 52856.483459472656ms
2022-09-21 15:50:46 INFO  ---RUNTIME: Multi-Query Optimization took 234.8182201385498 ms
2022-09-21 15:50:46 INFO  Executing generated plans
2022-09-21 15:51:40 INFO  ---RUNTIME: Execution took 53730.39793968201 ms
2022-09-21 15:51:40 INFO  Done!
2022-09-21 15:51:40 INFO  # Finished -- repetition 6 of 7 
2022-09-21 15:51:40 INFO  # Optimization benchmark for data_corruption with args [['healthcare', 'slow_loading', 'featurization_3', 'logistic_regression']] -- repetition 7 of 7
2022-09-21 15:51:40 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-21 15:51:40 INFO  Running instrumented original pipeline...
2022-09-21 15:51:40 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-21 15:51:40 INFO  ---RUNTIME: Importing and monkey-patching took 6.029605865478516 ms
2022-09-21 15:51:42 INFO  ---RUNTIME: Original pipeline execution took 2107.6338291168213 ms (excluding imports and monkey-patching)
2022-09-21 15:51:42 INFO  Starting execution of 1 what-if analyses...
2022-09-21 15:51:42 INFO  Start plan generation for analysis DataCorruption...
2022-09-21 15:51:42 INFO  ---RUNTIME: Plan generation took 0.4909038543701172 ms
2022-09-21 15:51:42 INFO  Estimated runtime of original DAG is 1795.3426837921143ms
2022-09-21 15:51:42 INFO  Performing Multi-Query Optimization
2022-09-21 15:51:42 INFO  Estimated unoptimized what-if runtime is 53860.28051376343ms
2022-09-21 15:51:42 INFO  Estimated optimised what-if runtime is 1856.6794395446777ms
2022-09-21 15:51:42 INFO  Estimated optimisation runtime saving is 52003.60107421875ms
2022-09-21 15:51:42 INFO  ---RUNTIME: Multi-Query Optimization took 94.55561637878418 ms
2022-09-21 15:51:42 INFO  Executing generated plans
2022-09-21 15:51:44 INFO  ---RUNTIME: Execution took 1886.65771484375 ms
2022-09-21 15:51:44 INFO  Done!
2022-09-21 15:51:44 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-21 15:51:44 INFO  Running instrumented original pipeline...
2022-09-21 15:51:44 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-21 15:51:44 INFO  ---RUNTIME: Importing and monkey-patching took 5.61213493347168 ms
2022-09-21 15:51:46 INFO  ---RUNTIME: Original pipeline execution took 2064.980983734131 ms (excluding imports and monkey-patching)
2022-09-21 15:51:46 INFO  Starting execution of 1 what-if analyses...
2022-09-21 15:51:46 INFO  Start plan generation for analysis DataCorruption...
2022-09-21 15:51:46 INFO  ---RUNTIME: Plan generation took 0.453948974609375 ms
2022-09-21 15:51:46 INFO  Estimated runtime of original DAG is 1752.1326541900635ms
2022-09-21 15:51:46 WARNING Skipping Multi-Query Optimization (instead, only applying patches)
2022-09-21 15:51:46 INFO  Estimated unoptimised what-if runtime is 52563.979625701904ms
2022-09-21 15:51:46 INFO  ---RUNTIME: Multi-Query Optimization took 26.01337432861328 ms
2022-09-21 15:51:46 INFO  Executing generated plans
2022-09-21 15:52:40 INFO  ---RUNTIME: Execution took 53973.05703163147 ms
2022-09-21 15:52:40 INFO  Done!
2022-09-21 15:52:40 INFO  # Finished -- repetition 7 of 7 
2022-09-21 15:52:40 INFO  # Final results after all repetitions
2022-09-21 15:52:40 INFO     repetition  ... no_opt_what_if_execution_combined_model_training
0           0  ...                                        32.950163
1           1  ...                                        33.342600
2           2  ...                                        32.167196
3           3  ...                                        32.342672
4           4  ...                                        32.648087
5           5  ...                                        32.742977
6           6  ...                                        33.207178

[7 rows x 26 columns]
taskset -c 0-7 PROTOCOL_BUFFERS_PYTHON_IMPLEMENTATION=python python3.9 benchmarks_end_to_end.py data_corruption healthcare slow_loading featurization_3 xgboost
2022-09-21 15:52:42.881905: W tensorflow/stream_executor/platform/default/dso_loader.cc:64] Could not load dynamic library 'libcudart.so.11.0'; dlerror: libcudart.so.11.0: cannot open shared object file: No such file or directory; LD_LIBRARY_PATH: /home/sgrafbe/mlwhatif/venv/lib/python3.9/site-packages/cv2/../../lib64:
2022-09-21 15:52:42.881954: I tensorflow/stream_executor/cuda/cudart_stub.cc:29] Ignore above cudart dlerror if you do not have a GPU set up on your machine.
2022-09-21 15:52:44 INFO  Patching sys.argv with ['mlwhatif', 'healthcare', 'slow_loading', 'featurization_3', 'xgboost']
2022-09-21 15:52:44 INFO  Running instrumented original pipeline...
2022-09-21 15:52:44 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-21 15:52:44 INFO  ---RUNTIME: Importing and monkey-patching took 95.11327743530273 ms
2022-09-21 15:52:50 INFO  ---RUNTIME: Original pipeline execution took 6296.184301376343 ms (excluding imports and monkey-patching)
2022-09-21 15:52:50 INFO  Starting execution of 0 what-if analyses...
2022-09-21 15:52:50 INFO  Estimated runtime of original DAG is 5940.252065658569ms
2022-09-21 15:52:50 INFO  Performing Multi-Query Optimization
2022-09-21 15:52:50 INFO  Estimated unoptimized what-if runtime is 0ms
2022-09-21 15:52:50 INFO  Estimated optimised what-if runtime is 0ms
2022-09-21 15:52:50 INFO  Estimated optimisation runtime saving is 0ms
2022-09-21 15:52:50 INFO  ---RUNTIME: Multi-Query Optimization took 0.8399486541748047 ms
2022-09-21 15:52:50 INFO  Executing generated plans
2022-09-21 15:52:50 INFO  ---RUNTIME: Execution took 0.029087066650390625 ms
2022-09-21 15:52:50 INFO  Done!
2022-09-21 15:52:50 INFO  # Optimization benchmark for data_corruption with args [['healthcare', 'slow_loading', 'featurization_3', 'xgboost']] -- repetition 1 of 7
2022-09-21 15:52:50 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-21 15:52:50 INFO  Running instrumented original pipeline...
2022-09-21 15:52:50 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-21 15:52:50 INFO  ---RUNTIME: Importing and monkey-patching took 5.18345832824707 ms
2022-09-21 15:52:54 INFO  ---RUNTIME: Original pipeline execution took 4469.825744628906 ms (excluding imports and monkey-patching)
2022-09-21 15:52:54 INFO  Starting execution of 1 what-if analyses...
2022-09-21 15:52:54 INFO  Start plan generation for analysis DataCorruption...
2022-09-21 15:52:54 INFO  ---RUNTIME: Plan generation took 0.5509853363037109 ms
2022-09-21 15:52:54 INFO  Estimated runtime of original DAG is 4141.5112018585205ms
2022-09-21 15:52:54 INFO  Performing Multi-Query Optimization
2022-09-21 15:52:55 INFO  Estimated unoptimized what-if runtime is 124245.33605575562ms
2022-09-21 15:52:55 INFO  Estimated optimised what-if runtime is 4259.28521156311ms
2022-09-21 15:52:55 INFO  Estimated optimisation runtime saving is 119986.0508441925ms
2022-09-21 15:52:55 INFO  ---RUNTIME: Multi-Query Optimization took 263.77248764038086 ms
2022-09-21 15:52:55 INFO  Executing generated plans
2022-09-21 15:52:57 INFO  ---RUNTIME: Execution took 2552.946090698242 ms
2022-09-21 15:52:57 INFO  Done!
2022-09-21 15:52:57 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-21 15:52:57 INFO  Running instrumented original pipeline...
2022-09-21 15:52:57 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-21 15:52:57 INFO  ---RUNTIME: Importing and monkey-patching took 6.220817565917969 ms
2022-09-21 15:53:00 INFO  ---RUNTIME: Original pipeline execution took 2334.0508937835693 ms (excluding imports and monkey-patching)
2022-09-21 15:53:00 INFO  Starting execution of 1 what-if analyses...
2022-09-21 15:53:00 INFO  Start plan generation for analysis DataCorruption...
2022-09-21 15:53:00 INFO  ---RUNTIME: Plan generation took 0.7753372192382812 ms
2022-09-21 15:53:00 INFO  Estimated runtime of original DAG is 2018.9788341522217ms
2022-09-21 15:53:00 WARNING Skipping Multi-Query Optimization (instead, only applying patches)
2022-09-21 15:53:00 INFO  Estimated unoptimised what-if runtime is 60569.36502456665ms
2022-09-21 15:53:00 INFO  ---RUNTIME: Multi-Query Optimization took 25.93398094177246 ms
2022-09-21 15:53:00 INFO  Executing generated plans
2022-09-21 15:54:07 INFO  ---RUNTIME: Execution took 67598.30021858215 ms
2022-09-21 15:54:07 INFO  Done!
2022-09-21 15:54:07 INFO  # Finished -- repetition 1 of 7 
2022-09-21 15:54:07 INFO  # Optimization benchmark for data_corruption with args [['healthcare', 'slow_loading', 'featurization_3', 'xgboost']] -- repetition 2 of 7
2022-09-21 15:54:07 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-21 15:54:07 INFO  Running instrumented original pipeline...
2022-09-21 15:54:07 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-21 15:54:07 INFO  ---RUNTIME: Importing and monkey-patching took 6.119012832641602 ms
2022-09-21 15:54:10 INFO  ---RUNTIME: Original pipeline execution took 2296.992063522339 ms (excluding imports and monkey-patching)
2022-09-21 15:54:10 INFO  Starting execution of 1 what-if analyses...
2022-09-21 15:54:10 INFO  Start plan generation for analysis DataCorruption...
2022-09-21 15:54:10 INFO  ---RUNTIME: Plan generation took 0.5207061767578125 ms
2022-09-21 15:54:10 INFO  Estimated runtime of original DAG is 1981.477975845337ms
2022-09-21 15:54:10 INFO  Performing Multi-Query Optimization
2022-09-21 15:54:10 INFO  Estimated unoptimized what-if runtime is 59444.33927536011ms
2022-09-21 15:54:10 INFO  Estimated optimised what-if runtime is 2088.402509689331ms
2022-09-21 15:54:10 INFO  Estimated optimisation runtime saving is 57355.93676567078ms
2022-09-21 15:54:10 INFO  ---RUNTIME: Multi-Query Optimization took 94.80500221252441 ms
2022-09-21 15:54:10 INFO  Executing generated plans
2022-09-21 15:54:12 INFO  ---RUNTIME: Execution took 2119.0781593322754 ms
2022-09-21 15:54:12 INFO  Done!
2022-09-21 15:54:12 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-21 15:54:12 INFO  Running instrumented original pipeline...
2022-09-21 15:54:12 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-21 15:54:12 INFO  ---RUNTIME: Importing and monkey-patching took 6.232261657714844 ms
2022-09-21 15:54:14 INFO  ---RUNTIME: Original pipeline execution took 2458.7275981903076 ms (excluding imports and monkey-patching)
2022-09-21 15:54:14 INFO  Starting execution of 1 what-if analyses...
2022-09-21 15:54:14 INFO  Start plan generation for analysis DataCorruption...
2022-09-21 15:54:14 INFO  ---RUNTIME: Plan generation took 0.4928112030029297 ms
2022-09-21 15:54:14 INFO  Estimated runtime of original DAG is 1966.2699699401855ms
2022-09-21 15:54:14 WARNING Skipping Multi-Query Optimization (instead, only applying patches)
2022-09-21 15:54:14 INFO  Estimated unoptimised what-if runtime is 58988.09909820557ms
2022-09-21 15:54:14 INFO  ---RUNTIME: Multi-Query Optimization took 26.211261749267578 ms
2022-09-21 15:54:14 INFO  Executing generated plans
2022-09-21 15:55:14 INFO  ---RUNTIME: Execution took 59361.5026473999 ms
2022-09-21 15:55:14 INFO  Done!
2022-09-21 15:55:14 INFO  # Finished -- repetition 2 of 7 
2022-09-21 15:55:14 INFO  # Optimization benchmark for data_corruption with args [['healthcare', 'slow_loading', 'featurization_3', 'xgboost']] -- repetition 3 of 7
2022-09-21 15:55:14 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-21 15:55:14 INFO  Running instrumented original pipeline...
2022-09-21 15:55:14 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-21 15:55:14 INFO  ---RUNTIME: Importing and monkey-patching took 6.095647811889648 ms
2022-09-21 15:55:16 INFO  ---RUNTIME: Original pipeline execution took 2372.6675510406494 ms (excluding imports and monkey-patching)
2022-09-21 15:55:16 INFO  Starting execution of 1 what-if analyses...
2022-09-21 15:55:16 INFO  Start plan generation for analysis DataCorruption...
2022-09-21 15:55:16 INFO  ---RUNTIME: Plan generation took 0.5259513854980469 ms
2022-09-21 15:55:16 INFO  Estimated runtime of original DAG is 2057.6326847076416ms
2022-09-21 15:55:16 INFO  Performing Multi-Query Optimization
2022-09-21 15:55:16 INFO  Estimated unoptimized what-if runtime is 61728.98054122925ms
2022-09-21 15:55:16 INFO  Estimated optimised what-if runtime is 2163.065195083618ms
2022-09-21 15:55:16 INFO  Estimated optimisation runtime saving is 59565.91534614563ms
2022-09-21 15:55:16 INFO  ---RUNTIME: Multi-Query Optimization took 94.41518783569336 ms
2022-09-21 15:55:16 INFO  Executing generated plans
2022-09-21 15:55:18 INFO  ---RUNTIME: Execution took 2115.6654357910156 ms
2022-09-21 15:55:18 INFO  Done!
2022-09-21 15:55:18 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-21 15:55:18 INFO  Running instrumented original pipeline...
2022-09-21 15:55:18 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-21 15:55:18 INFO  ---RUNTIME: Importing and monkey-patching took 5.748748779296875 ms
2022-09-21 15:55:20 INFO  ---RUNTIME: Original pipeline execution took 2267.0249938964844 ms (excluding imports and monkey-patching)
2022-09-21 15:55:20 INFO  Starting execution of 1 what-if analyses...
2022-09-21 15:55:20 INFO  Start plan generation for analysis DataCorruption...
2022-09-21 15:55:20 INFO  ---RUNTIME: Plan generation took 0.5486011505126953 ms
2022-09-21 15:55:20 INFO  Estimated runtime of original DAG is 1952.347755432129ms
2022-09-21 15:55:20 WARNING Skipping Multi-Query Optimization (instead, only applying patches)
2022-09-21 15:55:21 INFO  Estimated unoptimised what-if runtime is 58570.43266296387ms
2022-09-21 15:55:21 INFO  ---RUNTIME: Multi-Query Optimization took 26.484966278076172 ms
2022-09-21 15:55:21 INFO  Executing generated plans
2022-09-21 15:56:20 INFO  ---RUNTIME: Execution took 59783.27822685242 ms
2022-09-21 15:56:20 INFO  Done!
2022-09-21 15:56:20 INFO  # Finished -- repetition 3 of 7 
2022-09-21 15:56:20 INFO  # Optimization benchmark for data_corruption with args [['healthcare', 'slow_loading', 'featurization_3', 'xgboost']] -- repetition 4 of 7
2022-09-21 15:56:20 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-21 15:56:20 INFO  Running instrumented original pipeline...
2022-09-21 15:56:20 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-21 15:56:20 INFO  ---RUNTIME: Importing and monkey-patching took 6.097078323364258 ms
2022-09-21 15:56:23 INFO  ---RUNTIME: Original pipeline execution took 2292.424440383911 ms (excluding imports and monkey-patching)
2022-09-21 15:56:23 INFO  Starting execution of 1 what-if analyses...
2022-09-21 15:56:23 INFO  Start plan generation for analysis DataCorruption...
2022-09-21 15:56:23 INFO  ---RUNTIME: Plan generation took 0.7307529449462891 ms
2022-09-21 15:56:23 INFO  Estimated runtime of original DAG is 1971.238374710083ms
2022-09-21 15:56:23 INFO  Performing Multi-Query Optimization
2022-09-21 15:56:23 INFO  Estimated unoptimized what-if runtime is 59137.15124130249ms
2022-09-21 15:56:23 INFO  Estimated optimised what-if runtime is 2119.3928718566895ms
2022-09-21 15:56:23 INFO  Estimated optimisation runtime saving is 57017.7583694458ms
2022-09-21 15:56:23 INFO  ---RUNTIME: Multi-Query Optimization took 94.8343276977539 ms
2022-09-21 15:56:23 INFO  Executing generated plans
2022-09-21 15:56:25 INFO  ---RUNTIME: Execution took 2121.3910579681396 ms
2022-09-21 15:56:25 INFO  Done!
2022-09-21 15:56:25 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-21 15:56:25 INFO  Running instrumented original pipeline...
2022-09-21 15:56:25 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-21 15:56:25 INFO  ---RUNTIME: Importing and monkey-patching took 5.770683288574219 ms
2022-09-21 15:56:27 INFO  ---RUNTIME: Original pipeline execution took 2274.165391921997 ms (excluding imports and monkey-patching)
2022-09-21 15:56:27 INFO  Starting execution of 1 what-if analyses...
2022-09-21 15:56:27 INFO  Start plan generation for analysis DataCorruption...
2022-09-21 15:56:27 INFO  ---RUNTIME: Plan generation took 0.5013942718505859 ms
2022-09-21 15:56:27 INFO  Estimated runtime of original DAG is 1959.1047763824463ms
2022-09-21 15:56:27 WARNING Skipping Multi-Query Optimization (instead, only applying patches)
2022-09-21 15:56:27 INFO  Estimated unoptimised what-if runtime is 58773.14329147339ms
2022-09-21 15:56:27 INFO  ---RUNTIME: Multi-Query Optimization took 26.179790496826172 ms
2022-09-21 15:56:27 INFO  Executing generated plans
2022-09-21 15:57:27 INFO  ---RUNTIME: Execution took 59940.79494476318 ms
2022-09-21 15:57:27 INFO  Done!
2022-09-21 15:57:27 INFO  # Finished -- repetition 4 of 7 
2022-09-21 15:57:27 INFO  # Optimization benchmark for data_corruption with args [['healthcare', 'slow_loading', 'featurization_3', 'xgboost']] -- repetition 5 of 7
2022-09-21 15:57:27 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-21 15:57:27 INFO  Running instrumented original pipeline...
2022-09-21 15:57:27 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-21 15:57:27 INFO  ---RUNTIME: Importing and monkey-patching took 5.879402160644531 ms
2022-09-21 15:57:29 INFO  ---RUNTIME: Original pipeline execution took 2277.9757976531982 ms (excluding imports and monkey-patching)
2022-09-21 15:57:29 INFO  Starting execution of 1 what-if analyses...
2022-09-21 15:57:29 INFO  Start plan generation for analysis DataCorruption...
2022-09-21 15:57:29 INFO  ---RUNTIME: Plan generation took 0.5023479461669922 ms
2022-09-21 15:57:29 INFO  Estimated runtime of original DAG is 1967.0264720916748ms
2022-09-21 15:57:29 INFO  Performing Multi-Query Optimization
2022-09-21 15:57:29 INFO  Estimated unoptimized what-if runtime is 59010.794162750244ms
2022-09-21 15:57:29 INFO  Estimated optimised what-if runtime is 2073.434591293335ms
2022-09-21 15:57:29 INFO  Estimated optimisation runtime saving is 56937.35957145691ms
2022-09-21 15:57:29 INFO  ---RUNTIME: Multi-Query Optimization took 94.37155723571777 ms
2022-09-21 15:57:29 INFO  Executing generated plans
2022-09-21 15:57:32 INFO  ---RUNTIME: Execution took 2124.218463897705 ms
2022-09-21 15:57:32 INFO  Done!
2022-09-21 15:57:32 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-21 15:57:32 INFO  Running instrumented original pipeline...
2022-09-21 15:57:32 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-21 15:57:32 INFO  ---RUNTIME: Importing and monkey-patching took 5.827665328979492 ms
2022-09-21 15:57:34 INFO  ---RUNTIME: Original pipeline execution took 2324.927806854248 ms (excluding imports and monkey-patching)
2022-09-21 15:57:34 INFO  Starting execution of 1 what-if analyses...
2022-09-21 15:57:34 INFO  Start plan generation for analysis DataCorruption...
2022-09-21 15:57:34 INFO  ---RUNTIME: Plan generation took 0.8709430694580078 ms
2022-09-21 15:57:34 INFO  Estimated runtime of original DAG is 2007.4527263641357ms
2022-09-21 15:57:34 WARNING Skipping Multi-Query Optimization (instead, only applying patches)
2022-09-21 15:57:34 INFO  Estimated unoptimised what-if runtime is 60223.58179092407ms
2022-09-21 15:57:34 INFO  ---RUNTIME: Multi-Query Optimization took 26.151180267333984 ms
2022-09-21 15:57:34 INFO  Executing generated plans
2022-09-21 15:58:33 INFO  ---RUNTIME: Execution took 59398.20170402527 ms
2022-09-21 15:58:33 INFO  Done!
2022-09-21 15:58:33 INFO  # Finished -- repetition 5 of 7 
2022-09-21 15:58:33 INFO  # Optimization benchmark for data_corruption with args [['healthcare', 'slow_loading', 'featurization_3', 'xgboost']] -- repetition 6 of 7
2022-09-21 15:58:33 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-21 15:58:33 INFO  Running instrumented original pipeline...
2022-09-21 15:58:33 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-21 15:58:33 INFO  ---RUNTIME: Importing and monkey-patching took 6.5784454345703125 ms
2022-09-21 15:58:36 INFO  ---RUNTIME: Original pipeline execution took 2537.327766418457 ms (excluding imports and monkey-patching)
2022-09-21 15:58:36 INFO  Starting execution of 1 what-if analyses...
2022-09-21 15:58:36 INFO  Start plan generation for analysis DataCorruption...
2022-09-21 15:58:36 INFO  ---RUNTIME: Plan generation took 0.8416175842285156 ms
2022-09-21 15:58:36 INFO  Estimated runtime of original DAG is 2200.817108154297ms
2022-09-21 15:58:36 INFO  Performing Multi-Query Optimization
2022-09-21 15:58:36 INFO  Estimated unoptimized what-if runtime is 66024.5132446289ms
2022-09-21 15:58:36 INFO  Estimated optimised what-if runtime is 2308.4805011749268ms
2022-09-21 15:58:36 INFO  Estimated optimisation runtime saving is 63716.03274345398ms
2022-09-21 15:58:36 INFO  ---RUNTIME: Multi-Query Optimization took 93.97411346435547 ms
2022-09-21 15:58:36 INFO  Executing generated plans
2022-09-21 15:58:38 INFO  ---RUNTIME: Execution took 2131.491184234619 ms
2022-09-21 15:58:38 INFO  Done!
2022-09-21 15:58:38 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-21 15:58:38 INFO  Running instrumented original pipeline...
2022-09-21 15:58:38 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-21 15:58:38 INFO  ---RUNTIME: Importing and monkey-patching took 5.826234817504883 ms
2022-09-21 15:58:40 INFO  ---RUNTIME: Original pipeline execution took 2302.4888038635254 ms (excluding imports and monkey-patching)
2022-09-21 15:58:40 INFO  Starting execution of 1 what-if analyses...
2022-09-21 15:58:40 INFO  Start plan generation for analysis DataCorruption...
2022-09-21 15:58:40 INFO  ---RUNTIME: Plan generation took 0.49233436584472656 ms
2022-09-21 15:58:40 INFO  Estimated runtime of original DAG is 1986.6359233856201ms
2022-09-21 15:58:40 WARNING Skipping Multi-Query Optimization (instead, only applying patches)
2022-09-21 15:58:40 INFO  Estimated unoptimised what-if runtime is 59599.0777015686ms
2022-09-21 15:58:40 INFO  ---RUNTIME: Multi-Query Optimization took 26.163816452026367 ms
2022-09-21 15:58:40 INFO  Executing generated plans
2022-09-21 15:59:40 INFO  ---RUNTIME: Execution took 59786.07964515686 ms
2022-09-21 15:59:40 INFO  Done!
2022-09-21 15:59:40 INFO  # Finished -- repetition 6 of 7 
2022-09-21 15:59:40 INFO  # Optimization benchmark for data_corruption with args [['healthcare', 'slow_loading', 'featurization_3', 'xgboost']] -- repetition 7 of 7
2022-09-21 15:59:40 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-21 15:59:40 INFO  Running instrumented original pipeline...
2022-09-21 15:59:40 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-21 15:59:40 INFO  ---RUNTIME: Importing and monkey-patching took 6.065607070922852 ms
2022-09-21 15:59:43 INFO  ---RUNTIME: Original pipeline execution took 2270.1056003570557 ms (excluding imports and monkey-patching)
2022-09-21 15:59:43 INFO  Starting execution of 1 what-if analyses...
2022-09-21 15:59:43 INFO  Start plan generation for analysis DataCorruption...
2022-09-21 15:59:43 INFO  ---RUNTIME: Plan generation took 0.47135353088378906 ms
2022-09-21 15:59:43 INFO  Estimated runtime of original DAG is 1954.766035079956ms
2022-09-21 15:59:43 INFO  Performing Multi-Query Optimization
2022-09-21 15:59:43 INFO  Estimated unoptimized what-if runtime is 58642.98105239868ms
2022-09-21 15:59:43 INFO  Estimated optimised what-if runtime is 2060.9633922576904ms
2022-09-21 15:59:43 INFO  Estimated optimisation runtime saving is 56582.01766014099ms
2022-09-21 15:59:43 INFO  ---RUNTIME: Multi-Query Optimization took 94.91848945617676 ms
2022-09-21 15:59:43 INFO  Executing generated plans
2022-09-21 15:59:45 INFO  ---RUNTIME: Execution took 2133.345603942871 ms
2022-09-21 15:59:45 INFO  Done!
2022-09-21 15:59:45 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-21 15:59:45 INFO  Running instrumented original pipeline...
2022-09-21 15:59:45 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-21 15:59:45 INFO  ---RUNTIME: Importing and monkey-patching took 5.751848220825195 ms
2022-09-21 15:59:47 INFO  ---RUNTIME: Original pipeline execution took 2237.8880977630615 ms (excluding imports and monkey-patching)
2022-09-21 15:59:47 INFO  Starting execution of 1 what-if analyses...
2022-09-21 15:59:47 INFO  Start plan generation for analysis DataCorruption...
2022-09-21 15:59:47 INFO  ---RUNTIME: Plan generation took 0.46825408935546875 ms
2022-09-21 15:59:47 INFO  Estimated runtime of original DAG is 1920.9015369415283ms
2022-09-21 15:59:47 WARNING Skipping Multi-Query Optimization (instead, only applying patches)
2022-09-21 15:59:47 INFO  Estimated unoptimised what-if runtime is 57627.04610824585ms
2022-09-21 15:59:47 INFO  ---RUNTIME: Multi-Query Optimization took 25.955915451049805 ms
2022-09-21 15:59:47 INFO  Executing generated plans
2022-09-21 16:00:47 INFO  ---RUNTIME: Execution took 59532.233238220215 ms
2022-09-21 16:00:47 INFO  Done!
2022-09-21 16:00:47 INFO  # Finished -- repetition 7 of 7 
2022-09-21 16:00:47 INFO  # Final results after all repetitions
2022-09-21 16:00:47 INFO     repetition  ... no_opt_what_if_execution_combined_model_training
0           0  ...                                     13581.141233
1           1  ...                                      5647.389412
2           2  ...                                      5652.272224
3           3  ...                                      5684.093475
4           4  ...                                      5679.590702
5           5  ...                                      5688.426971
6           6  ...                                      5661.290646

[7 rows x 26 columns]
taskset -c 0-7 PROTOCOL_BUFFERS_PYTHON_IMPLEMENTATION=python python3.9 benchmarks_end_to_end.py data_corruption healthcare slow_loading featurization_3 neural_network
2022-09-21 16:00:49.114920: W tensorflow/stream_executor/platform/default/dso_loader.cc:64] Could not load dynamic library 'libcudart.so.11.0'; dlerror: libcudart.so.11.0: cannot open shared object file: No such file or directory; LD_LIBRARY_PATH: /home/sgrafbe/mlwhatif/venv/lib/python3.9/site-packages/cv2/../../lib64:
2022-09-21 16:00:49.114963: I tensorflow/stream_executor/cuda/cudart_stub.cc:29] Ignore above cudart dlerror if you do not have a GPU set up on your machine.
2022-09-21 16:00:50 INFO  Patching sys.argv with ['mlwhatif', 'healthcare', 'slow_loading', 'featurization_3', 'neural_network']
2022-09-21 16:00:50 INFO  Running instrumented original pipeline...
2022-09-21 16:00:50 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-21 16:00:50 INFO  ---RUNTIME: Importing and monkey-patching took 94.65408325195312 ms
2022-09-21 16:00:52.903652: W tensorflow/stream_executor/platform/default/dso_loader.cc:64] Could not load dynamic library 'libcuda.so.1'; dlerror: libcuda.so.1: cannot open shared object file: No such file or directory; LD_LIBRARY_PATH: /home/sgrafbe/mlwhatif/venv/lib/python3.9/site-packages/cv2/../../lib64:
2022-09-21 16:00:52.903693: W tensorflow/stream_executor/cuda/cuda_driver.cc:326] failed call to cuInit: UNKNOWN ERROR (303)
2022-09-21 16:00:52.903717: I tensorflow/stream_executor/cuda/cuda_diagnostics.cc:156] kernel driver does not appear to be running on this host (wagyu): /proc/driver/nvidia/version does not exist
2022-09-21 16:00:52.904204: I tensorflow/core/platform/cpu_feature_guard.cc:142] This TensorFlow binary is optimized with oneAPI Deep Neural Network Library (oneDNN) to use the following CPU instructions in performance-critical operations:  AVX2 FMA
To enable them in other operations, rebuild TensorFlow with the appropriate compiler flags.
2022-09-21 16:00:53.511632: I tensorflow/compiler/mlir/mlir_graph_optimization_pass.cc:176] None of the MLIR Optimization Passes are enabled (registered 2)
2022-09-21 16:00:53.525380: I tensorflow/core/platform/profile_utils/cpu_utils.cc:114] CPU Frequency: 2595290000 Hz
2022-09-21 16:00:53 INFO  ---RUNTIME: Original pipeline execution took 3351.015090942383 ms (excluding imports and monkey-patching)
2022-09-21 16:00:53 INFO  Starting execution of 0 what-if analyses...
2022-09-21 16:00:53 INFO  Estimated runtime of original DAG is 2983.5684299468994ms
2022-09-21 16:00:53 INFO  Performing Multi-Query Optimization
2022-09-21 16:00:53 INFO  Estimated unoptimized what-if runtime is 0ms
2022-09-21 16:00:53 INFO  Estimated optimised what-if runtime is 0ms
2022-09-21 16:00:53 INFO  Estimated optimisation runtime saving is 0ms
2022-09-21 16:00:53 INFO  ---RUNTIME: Multi-Query Optimization took 0.8938312530517578 ms
2022-09-21 16:00:53 INFO  Executing generated plans
2022-09-21 16:00:53 INFO  ---RUNTIME: Execution took 0.022649765014648438 ms
2022-09-21 16:00:53 INFO  Done!
2022-09-21 16:00:53 INFO  # Optimization benchmark for data_corruption with args [['healthcare', 'slow_loading', 'featurization_3', 'neural_network']] -- repetition 1 of 7
2022-09-21 16:00:53 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-21 16:00:53 INFO  Running instrumented original pipeline...
2022-09-21 16:00:53 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-21 16:00:53 INFO  ---RUNTIME: Importing and monkey-patching took 7.484197616577148 ms
2022-09-21 16:00:56 INFO  ---RUNTIME: Original pipeline execution took 3022.731065750122 ms (excluding imports and monkey-patching)
2022-09-21 16:00:56 INFO  Starting execution of 1 what-if analyses...
2022-09-21 16:00:56 INFO  Start plan generation for analysis DataCorruption...
2022-09-21 16:00:56 INFO  ---RUNTIME: Plan generation took 0.5197525024414062 ms
2022-09-21 16:00:56 INFO  Estimated runtime of original DAG is 2687.4842643737793ms
2022-09-21 16:00:56 INFO  Performing Multi-Query Optimization
2022-09-21 16:00:56 INFO  Estimated unoptimized what-if runtime is 80624.52793121338ms
2022-09-21 16:00:56 INFO  Estimated optimised what-if runtime is 4309.473276138306ms
2022-09-21 16:00:56 INFO  Estimated optimisation runtime saving is 76315.05465507507ms
2022-09-21 16:00:56 INFO  ---RUNTIME: Multi-Query Optimization took 94.12550926208496 ms
2022-09-21 16:00:56 INFO  Executing generated plans
2022-09-21 16:00:59 INFO  ---RUNTIME: Execution took 2778.576374053955 ms
2022-09-21 16:00:59 INFO  Done!
2022-09-21 16:00:59 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-21 16:00:59 INFO  Running instrumented original pipeline...
2022-09-21 16:00:59 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-21 16:00:59 INFO  ---RUNTIME: Importing and monkey-patching took 7.241249084472656 ms
2022-09-21 16:01:02 INFO  ---RUNTIME: Original pipeline execution took 2750.7128715515137 ms (excluding imports and monkey-patching)
2022-09-21 16:01:02 INFO  Starting execution of 1 what-if analyses...
2022-09-21 16:01:02 INFO  Start plan generation for analysis DataCorruption...
2022-09-21 16:01:02 INFO  ---RUNTIME: Plan generation took 1.112222671508789 ms
2022-09-21 16:01:02 INFO  Estimated runtime of original DAG is 2432.286262512207ms
2022-09-21 16:01:02 WARNING Skipping Multi-Query Optimization (instead, only applying patches)
2022-09-21 16:01:02 INFO  Estimated unoptimised what-if runtime is 72968.58787536621ms
2022-09-21 16:01:02 INFO  ---RUNTIME: Multi-Query Optimization took 25.791645050048828 ms
2022-09-21 16:01:02 INFO  Executing generated plans
2022-09-21 16:02:13 INFO  ---RUNTIME: Execution took 70517.84491539001 ms
2022-09-21 16:02:13 INFO  Done!
2022-09-21 16:02:13 INFO  # Finished -- repetition 1 of 7 
2022-09-21 16:02:13 INFO  # Optimization benchmark for data_corruption with args [['healthcare', 'slow_loading', 'featurization_3', 'neural_network']] -- repetition 2 of 7
2022-09-21 16:02:13 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-21 16:02:13 INFO  Running instrumented original pipeline...
2022-09-21 16:02:13 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-21 16:02:13 INFO  ---RUNTIME: Importing and monkey-patching took 5.890369415283203 ms
2022-09-21 16:02:15 INFO  ---RUNTIME: Original pipeline execution took 2904.7842025756836 ms (excluding imports and monkey-patching)
2022-09-21 16:02:15 INFO  Starting execution of 1 what-if analyses...
2022-09-21 16:02:15 INFO  Start plan generation for analysis DataCorruption...
2022-09-21 16:02:15 INFO  ---RUNTIME: Plan generation took 0.4794597625732422 ms
2022-09-21 16:02:15 INFO  Estimated runtime of original DAG is 2592.231035232544ms
2022-09-21 16:02:15 INFO  Performing Multi-Query Optimization
2022-09-21 16:02:16 INFO  Estimated unoptimized what-if runtime is 77766.93105697632ms
2022-09-21 16:02:16 INFO  Estimated optimised what-if runtime is 4208.846807479858ms
2022-09-21 16:02:16 INFO  Estimated optimisation runtime saving is 73558.08424949646ms
2022-09-21 16:02:16 INFO  ---RUNTIME: Multi-Query Optimization took 94.83671188354492 ms
2022-09-21 16:02:16 INFO  Executing generated plans
2022-09-21 16:02:18 INFO  ---RUNTIME: Execution took 2554.4865131378174 ms
2022-09-21 16:02:18 INFO  Done!
2022-09-21 16:02:18 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-21 16:02:18 INFO  Running instrumented original pipeline...
2022-09-21 16:02:18 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-21 16:02:18 INFO  ---RUNTIME: Importing and monkey-patching took 5.596399307250977 ms
2022-09-21 16:02:21 INFO  ---RUNTIME: Original pipeline execution took 2556.8580627441406 ms (excluding imports and monkey-patching)
2022-09-21 16:02:21 INFO  Starting execution of 1 what-if analyses...
2022-09-21 16:02:21 INFO  Start plan generation for analysis DataCorruption...
2022-09-21 16:02:21 INFO  ---RUNTIME: Plan generation took 0.4878044128417969 ms
2022-09-21 16:02:21 INFO  Estimated runtime of original DAG is 2245.34010887146ms
2022-09-21 16:02:21 WARNING Skipping Multi-Query Optimization (instead, only applying patches)
2022-09-21 16:02:21 INFO  Estimated unoptimised what-if runtime is 67360.2032661438ms
2022-09-21 16:02:21 INFO  ---RUNTIME: Multi-Query Optimization took 26.612520217895508 ms
2022-09-21 16:02:21 INFO  Executing generated plans
2022-09-21 16:03:31 INFO  ---RUNTIME: Execution took 70707.0951461792 ms
2022-09-21 16:03:31 INFO  Done!
2022-09-21 16:03:31 INFO  # Finished -- repetition 2 of 7 
2022-09-21 16:03:31 INFO  # Optimization benchmark for data_corruption with args [['healthcare', 'slow_loading', 'featurization_3', 'neural_network']] -- repetition 3 of 7
2022-09-21 16:03:31 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-21 16:03:31 INFO  Running instrumented original pipeline...
2022-09-21 16:03:31 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-21 16:03:31 INFO  ---RUNTIME: Importing and monkey-patching took 5.852222442626953 ms
2022-09-21 16:03:34 INFO  ---RUNTIME: Original pipeline execution took 2876.0926723480225 ms (excluding imports and monkey-patching)
2022-09-21 16:03:34 INFO  Starting execution of 1 what-if analyses...
2022-09-21 16:03:34 INFO  Start plan generation for analysis DataCorruption...
2022-09-21 16:03:34 INFO  ---RUNTIME: Plan generation took 0.4794597625732422 ms
2022-09-21 16:03:34 INFO  Estimated runtime of original DAG is 2565.715551376343ms
2022-09-21 16:03:34 INFO  Performing Multi-Query Optimization
2022-09-21 16:03:34 INFO  Estimated unoptimized what-if runtime is 76971.46654129028ms
2022-09-21 16:03:34 INFO  Estimated optimised what-if runtime is 4296.210050582886ms
2022-09-21 16:03:34 INFO  Estimated optimisation runtime saving is 72675.2564907074ms
2022-09-21 16:03:34 INFO  ---RUNTIME: Multi-Query Optimization took 93.7497615814209 ms
2022-09-21 16:03:34 INFO  Executing generated plans
2022-09-21 16:03:37 INFO  ---RUNTIME: Execution took 2651.9393920898438 ms
2022-09-21 16:03:37 INFO  Done!
2022-09-21 16:03:37 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-21 16:03:37 INFO  Running instrumented original pipeline...
2022-09-21 16:03:37 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-21 16:03:37 INFO  ---RUNTIME: Importing and monkey-patching took 6.06989860534668 ms
2022-09-21 16:03:40 INFO  ---RUNTIME: Original pipeline execution took 2634.232521057129 ms (excluding imports and monkey-patching)
2022-09-21 16:03:40 INFO  Starting execution of 1 what-if analyses...
2022-09-21 16:03:40 INFO  Start plan generation for analysis DataCorruption...
2022-09-21 16:03:40 INFO  ---RUNTIME: Plan generation took 0.5586147308349609 ms
2022-09-21 16:03:40 INFO  Estimated runtime of original DAG is 2287.8007888793945ms
2022-09-21 16:03:40 WARNING Skipping Multi-Query Optimization (instead, only applying patches)
2022-09-21 16:03:40 INFO  Estimated unoptimised what-if runtime is 68634.02366638184ms
2022-09-21 16:03:40 INFO  ---RUNTIME: Multi-Query Optimization took 27.435779571533203 ms
2022-09-21 16:03:40 INFO  Executing generated plans
2022-09-21 16:04:50 INFO  ---RUNTIME: Execution took 70809.13066864014 ms
2022-09-21 16:04:50 INFO  Done!
2022-09-21 16:04:50 INFO  # Finished -- repetition 3 of 7 
2022-09-21 16:04:50 INFO  # Optimization benchmark for data_corruption with args [['healthcare', 'slow_loading', 'featurization_3', 'neural_network']] -- repetition 4 of 7
2022-09-21 16:04:50 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-21 16:04:50 INFO  Running instrumented original pipeline...
2022-09-21 16:04:51 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-21 16:04:51 INFO  ---RUNTIME: Importing and monkey-patching took 5.7163238525390625 ms
2022-09-21 16:04:53 INFO  ---RUNTIME: Original pipeline execution took 2567.2361850738525 ms (excluding imports and monkey-patching)
2022-09-21 16:04:53 INFO  Starting execution of 1 what-if analyses...
2022-09-21 16:04:53 INFO  Start plan generation for analysis DataCorruption...
2022-09-21 16:04:53 INFO  ---RUNTIME: Plan generation took 0.4413127899169922 ms
2022-09-21 16:04:53 INFO  Estimated runtime of original DAG is 2259.6595287323ms
2022-09-21 16:04:53 INFO  Performing Multi-Query Optimization
2022-09-21 16:04:53 INFO  Estimated unoptimized what-if runtime is 67789.785861969ms
2022-09-21 16:04:53 INFO  Estimated optimised what-if runtime is 3887.6118659973145ms
2022-09-21 16:04:53 INFO  Estimated optimisation runtime saving is 63902.17399597168ms
2022-09-21 16:04:53 INFO  ---RUNTIME: Multi-Query Optimization took 93.17493438720703 ms
2022-09-21 16:04:53 INFO  Executing generated plans
2022-09-21 16:04:56 INFO  ---RUNTIME: Execution took 2686.3129138946533 ms
2022-09-21 16:04:56 INFO  Done!
2022-09-21 16:04:56 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-21 16:04:56 INFO  Running instrumented original pipeline...
2022-09-21 16:04:56 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-21 16:04:56 INFO  ---RUNTIME: Importing and monkey-patching took 6.423711776733398 ms
2022-09-21 16:04:59 INFO  ---RUNTIME: Original pipeline execution took 2853.865146636963 ms (excluding imports and monkey-patching)
2022-09-21 16:04:59 INFO  Starting execution of 1 what-if analyses...
2022-09-21 16:04:59 INFO  Start plan generation for analysis DataCorruption...
2022-09-21 16:04:59 INFO  ---RUNTIME: Plan generation took 0.4875659942626953 ms
2022-09-21 16:04:59 INFO  Estimated runtime of original DAG is 2246.5622425079346ms
2022-09-21 16:04:59 WARNING Skipping Multi-Query Optimization (instead, only applying patches)
2022-09-21 16:04:59 INFO  Estimated unoptimised what-if runtime is 67396.86727523804ms
2022-09-21 16:04:59 INFO  ---RUNTIME: Multi-Query Optimization took 26.22389793395996 ms
2022-09-21 16:04:59 INFO  Executing generated plans
2022-09-21 16:06:10 INFO  ---RUNTIME: Execution took 71214.41626548767 ms
2022-09-21 16:06:10 INFO  Done!
2022-09-21 16:06:10 INFO  # Finished -- repetition 4 of 7 
2022-09-21 16:06:10 INFO  # Optimization benchmark for data_corruption with args [['healthcare', 'slow_loading', 'featurization_3', 'neural_network']] -- repetition 5 of 7
2022-09-21 16:06:10 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-21 16:06:10 INFO  Running instrumented original pipeline...
2022-09-21 16:06:10 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-21 16:06:10 INFO  ---RUNTIME: Importing and monkey-patching took 5.725622177124023 ms
2022-09-21 16:06:13 INFO  ---RUNTIME: Original pipeline execution took 2547.1367835998535 ms (excluding imports and monkey-patching)
2022-09-21 16:06:13 INFO  Starting execution of 1 what-if analyses...
2022-09-21 16:06:13 INFO  Start plan generation for analysis DataCorruption...
2022-09-21 16:06:13 INFO  ---RUNTIME: Plan generation took 0.4515647888183594 ms
2022-09-21 16:06:13 INFO  Estimated runtime of original DAG is 2236.513614654541ms
2022-09-21 16:06:13 INFO  Performing Multi-Query Optimization
2022-09-21 16:06:13 INFO  Estimated unoptimized what-if runtime is 67095.40843963623ms
2022-09-21 16:06:13 INFO  Estimated optimised what-if runtime is 3840.5559062957764ms
2022-09-21 16:06:13 INFO  Estimated optimisation runtime saving is 63254.852533340454ms
2022-09-21 16:06:13 INFO  ---RUNTIME: Multi-Query Optimization took 94.32864189147949 ms
2022-09-21 16:06:13 INFO  Executing generated plans
2022-09-21 16:06:15 INFO  ---RUNTIME: Execution took 2595.5522060394287 ms
2022-09-21 16:06:15 INFO  Done!
2022-09-21 16:06:15 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-21 16:06:15 INFO  Running instrumented original pipeline...
2022-09-21 16:06:15 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-21 16:06:15 INFO  ---RUNTIME: Importing and monkey-patching took 6.272077560424805 ms
2022-09-21 16:06:18 INFO  ---RUNTIME: Original pipeline execution took 2553.8530349731445 ms (excluding imports and monkey-patching)
2022-09-21 16:06:18 INFO  Starting execution of 1 what-if analyses...
2022-09-21 16:06:18 INFO  Start plan generation for analysis DataCorruption...
2022-09-21 16:06:18 INFO  ---RUNTIME: Plan generation took 0.5733966827392578 ms
2022-09-21 16:06:18 INFO  Estimated runtime of original DAG is 2240.8483028411865ms
2022-09-21 16:06:18 WARNING Skipping Multi-Query Optimization (instead, only applying patches)
2022-09-21 16:06:18 INFO  Estimated unoptimised what-if runtime is 67225.4490852356ms
2022-09-21 16:06:18 INFO  ---RUNTIME: Multi-Query Optimization took 26.95751190185547 ms
2022-09-21 16:06:18 INFO  Executing generated plans
2022-09-21 16:07:30 INFO  ---RUNTIME: Execution took 71810.19496917725 ms
2022-09-21 16:07:30 INFO  Done!
2022-09-21 16:07:30 INFO  # Finished -- repetition 5 of 7 
2022-09-21 16:07:30 INFO  # Optimization benchmark for data_corruption with args [['healthcare', 'slow_loading', 'featurization_3', 'neural_network']] -- repetition 6 of 7
2022-09-21 16:07:30 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-21 16:07:30 INFO  Running instrumented original pipeline...
2022-09-21 16:07:30 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-21 16:07:30 INFO  ---RUNTIME: Importing and monkey-patching took 5.800008773803711 ms
2022-09-21 16:07:32 INFO  ---RUNTIME: Original pipeline execution took 2552.1180629730225 ms (excluding imports and monkey-patching)
2022-09-21 16:07:32 INFO  Starting execution of 1 what-if analyses...
2022-09-21 16:07:32 INFO  Start plan generation for analysis DataCorruption...
2022-09-21 16:07:32 INFO  ---RUNTIME: Plan generation took 0.45990943908691406 ms
2022-09-21 16:07:32 INFO  Estimated runtime of original DAG is 2225.7070541381836ms
2022-09-21 16:07:32 INFO  Performing Multi-Query Optimization
2022-09-21 16:07:32 INFO  Estimated unoptimized what-if runtime is 66771.21162414551ms
2022-09-21 16:07:32 INFO  Estimated optimised what-if runtime is 3855.1182746887207ms
2022-09-21 16:07:32 INFO  Estimated optimisation runtime saving is 62916.09334945679ms
2022-09-21 16:07:32 INFO  ---RUNTIME: Multi-Query Optimization took 95.0918197631836 ms
2022-09-21 16:07:32 INFO  Executing generated plans
2022-09-21 16:07:35 INFO  ---RUNTIME: Execution took 2593.8560962677 ms
2022-09-21 16:07:35 INFO  Done!
2022-09-21 16:07:35 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-21 16:07:35 INFO  Running instrumented original pipeline...
2022-09-21 16:07:35 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-21 16:07:35 INFO  ---RUNTIME: Importing and monkey-patching took 6.377220153808594 ms
2022-09-21 16:07:38 INFO  ---RUNTIME: Original pipeline execution took 2929.299831390381 ms (excluding imports and monkey-patching)
2022-09-21 16:07:38 INFO  Starting execution of 1 what-if analyses...
2022-09-21 16:07:38 INFO  Start plan generation for analysis DataCorruption...
2022-09-21 16:07:38 INFO  ---RUNTIME: Plan generation took 1.2814998626708984 ms
2022-09-21 16:07:38 INFO  Estimated runtime of original DAG is 2617.0341968536377ms
2022-09-21 16:07:38 WARNING Skipping Multi-Query Optimization (instead, only applying patches)
2022-09-21 16:07:38 INFO  Estimated unoptimised what-if runtime is 78511.02590560913ms
2022-09-21 16:07:38 INFO  ---RUNTIME: Multi-Query Optimization took 26.41916275024414 ms
2022-09-21 16:07:38 INFO  Executing generated plans
2022-09-21 16:08:49 INFO  ---RUNTIME: Execution took 71153.77593040466 ms
2022-09-21 16:08:49 INFO  Done!
2022-09-21 16:08:49 INFO  # Finished -- repetition 6 of 7 
2022-09-21 16:08:49 INFO  # Optimization benchmark for data_corruption with args [['healthcare', 'slow_loading', 'featurization_3', 'neural_network']] -- repetition 7 of 7
2022-09-21 16:08:49 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-21 16:08:49 INFO  Running instrumented original pipeline...
2022-09-21 16:08:49 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-21 16:08:49 INFO  ---RUNTIME: Importing and monkey-patching took 5.955934524536133 ms
2022-09-21 16:08:52 INFO  ---RUNTIME: Original pipeline execution took 2538.701295852661 ms (excluding imports and monkey-patching)
2022-09-21 16:08:52 INFO  Starting execution of 1 what-if analyses...
2022-09-21 16:08:52 INFO  Start plan generation for analysis DataCorruption...
2022-09-21 16:08:52 INFO  ---RUNTIME: Plan generation took 0.47850608825683594 ms
2022-09-21 16:08:52 INFO  Estimated runtime of original DAG is 2203.789472579956ms
2022-09-21 16:08:52 INFO  Performing Multi-Query Optimization
2022-09-21 16:08:52 INFO  Estimated unoptimized what-if runtime is 66113.68417739868ms
2022-09-21 16:08:52 INFO  Estimated optimised what-if runtime is 3833.7113857269287ms
2022-09-21 16:08:52 INFO  Estimated optimisation runtime saving is 62279.97279167175ms
2022-09-21 16:08:52 INFO  ---RUNTIME: Multi-Query Optimization took 93.0931568145752 ms
2022-09-21 16:08:52 INFO  Executing generated plans
2022-09-21 16:08:54 INFO  ---RUNTIME: Execution took 2579.102039337158 ms
2022-09-21 16:08:54 INFO  Done!
2022-09-21 16:08:54 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-21 16:08:54 INFO  Running instrumented original pipeline...
2022-09-21 16:08:54 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-21 16:08:54 INFO  ---RUNTIME: Importing and monkey-patching took 6.035566329956055 ms
2022-09-21 16:08:57 INFO  ---RUNTIME: Original pipeline execution took 2941.3881301879883 ms (excluding imports and monkey-patching)
2022-09-21 16:08:57 INFO  Starting execution of 1 what-if analyses...
2022-09-21 16:08:57 INFO  Start plan generation for analysis DataCorruption...
2022-09-21 16:08:57 INFO  ---RUNTIME: Plan generation took 0.5009174346923828 ms
2022-09-21 16:08:57 INFO  Estimated runtime of original DAG is 2630.7661533355713ms
2022-09-21 16:08:57 WARNING Skipping Multi-Query Optimization (instead, only applying patches)
2022-09-21 16:08:57 INFO  Estimated unoptimised what-if runtime is 78922.98460006714ms
2022-09-21 16:08:57 INFO  ---RUNTIME: Multi-Query Optimization took 25.92945098876953 ms
2022-09-21 16:08:57 INFO  Executing generated plans
2022-09-21 16:10:07 INFO  ---RUNTIME: Execution took 69493.69311332703 ms
2022-09-21 16:10:07 INFO  Done!
2022-09-21 16:10:07 INFO  # Finished -- repetition 7 of 7 
2022-09-21 16:10:07 INFO  # Final results after all repetitions
2022-09-21 16:10:07 INFO     repetition  ... no_opt_what_if_execution_combined_model_training
0           0  ...                                     14299.335957
1           1  ...                                     14676.937342
2           2  ...                                     14186.385393
3           3  ...                                     14762.786627
4           4  ...                                     14787.119150
5           5  ...                                     14263.448238
6           6  ...                                     14190.818310

[7 rows x 26 columns]
taskset -c 0-7 PROTOCOL_BUFFERS_PYTHON_IMPLEMENTATION=python python3.9 benchmarks_end_to_end.py data_corruption healthcare slow_loading featurization_4 logistic_regression
2022-09-21 16:10:09.520898: W tensorflow/stream_executor/platform/default/dso_loader.cc:64] Could not load dynamic library 'libcudart.so.11.0'; dlerror: libcudart.so.11.0: cannot open shared object file: No such file or directory; LD_LIBRARY_PATH: /home/sgrafbe/mlwhatif/venv/lib/python3.9/site-packages/cv2/../../lib64:
2022-09-21 16:10:09.520942: I tensorflow/stream_executor/cuda/cudart_stub.cc:29] Ignore above cudart dlerror if you do not have a GPU set up on your machine.
2022-09-21 16:10:10 INFO  Patching sys.argv with ['mlwhatif', 'healthcare', 'slow_loading', 'featurization_4', 'logistic_regression']
2022-09-21 16:10:10 INFO  Running instrumented original pipeline...
2022-09-21 16:10:10 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-21 16:10:10 INFO  ---RUNTIME: Importing and monkey-patching took 95.78633308410645 ms
2022-09-21 16:10:13 INFO  ---RUNTIME: Original pipeline execution took 2215.5001163482666 ms (excluding imports and monkey-patching)
2022-09-21 16:10:13 INFO  Starting execution of 0 what-if analyses...
2022-09-21 16:10:13 INFO  Estimated runtime of original DAG is 1905.440092086792ms
2022-09-21 16:10:13 INFO  Performing Multi-Query Optimization
2022-09-21 16:10:13 INFO  Estimated unoptimized what-if runtime is 0ms
2022-09-21 16:10:13 INFO  Estimated optimised what-if runtime is 0ms
2022-09-21 16:10:13 INFO  Estimated optimisation runtime saving is 0ms
2022-09-21 16:10:13 INFO  ---RUNTIME: Multi-Query Optimization took 0.5095005035400391 ms
2022-09-21 16:10:13 INFO  Executing generated plans
2022-09-21 16:10:13 INFO  ---RUNTIME: Execution took 0.023126602172851562 ms
2022-09-21 16:10:13 INFO  Done!
2022-09-21 16:10:13 INFO  # Optimization benchmark for data_corruption with args [['healthcare', 'slow_loading', 'featurization_4', 'logistic_regression']] -- repetition 1 of 7
2022-09-21 16:10:13 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-21 16:10:13 INFO  Running instrumented original pipeline...
2022-09-21 16:10:13 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-21 16:10:13 INFO  ---RUNTIME: Importing and monkey-patching took 5.1708221435546875 ms
2022-09-21 16:10:15 INFO  ---RUNTIME: Original pipeline execution took 2054.919481277466 ms (excluding imports and monkey-patching)
2022-09-21 16:10:15 INFO  Starting execution of 1 what-if analyses...
2022-09-21 16:10:15 INFO  Start plan generation for analysis DataCorruption...
2022-09-21 16:10:15 INFO  ---RUNTIME: Plan generation took 0.5393028259277344 ms
2022-09-21 16:10:15 INFO  Estimated runtime of original DAG is 1776.1898040771484ms
2022-09-21 16:10:15 INFO  Performing Multi-Query Optimization
2022-09-21 16:10:15 INFO  Estimated unoptimized what-if runtime is 53285.69412231445ms
2022-09-21 16:10:15 INFO  Estimated optimised what-if runtime is 1805.19437789917ms
2022-09-21 16:10:15 INFO  Estimated optimisation runtime saving is 51480.49974441528ms
2022-09-21 16:10:15 INFO  ---RUNTIME: Multi-Query Optimization took 255.57470321655273 ms
2022-09-21 16:10:15 INFO  Executing generated plans
2022-09-21 16:10:17 INFO  ---RUNTIME: Execution took 1914.1802787780762 ms
2022-09-21 16:10:17 INFO  Done!
2022-09-21 16:10:17 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-21 16:10:17 INFO  Running instrumented original pipeline...
2022-09-21 16:10:17 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-21 16:10:17 INFO  ---RUNTIME: Importing and monkey-patching took 6.178140640258789 ms
2022-09-21 16:10:19 INFO  ---RUNTIME: Original pipeline execution took 2046.9181537628174 ms (excluding imports and monkey-patching)
2022-09-21 16:10:19 INFO  Starting execution of 1 what-if analyses...
2022-09-21 16:10:19 INFO  Start plan generation for analysis DataCorruption...
2022-09-21 16:10:19 INFO  ---RUNTIME: Plan generation took 0.5025863647460938 ms
2022-09-21 16:10:19 INFO  Estimated runtime of original DAG is 1773.940086364746ms
2022-09-21 16:10:19 WARNING Skipping Multi-Query Optimization (instead, only applying patches)
2022-09-21 16:10:19 INFO  Estimated unoptimised what-if runtime is 53218.20259094238ms
2022-09-21 16:10:19 INFO  ---RUNTIME: Multi-Query Optimization took 23.619651794433594 ms
2022-09-21 16:10:19 INFO  Executing generated plans
2022-09-21 16:11:13 INFO  ---RUNTIME: Execution took 54369.77028846741 ms
2022-09-21 16:11:13 INFO  Done!
2022-09-21 16:11:13 INFO  # Finished -- repetition 1 of 7 
2022-09-21 16:11:13 INFO  # Optimization benchmark for data_corruption with args [['healthcare', 'slow_loading', 'featurization_4', 'logistic_regression']] -- repetition 2 of 7
2022-09-21 16:11:13 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-21 16:11:13 INFO  Running instrumented original pipeline...
2022-09-21 16:11:13 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-21 16:11:13 INFO  ---RUNTIME: Importing and monkey-patching took 6.108283996582031 ms
2022-09-21 16:11:15 INFO  ---RUNTIME: Original pipeline execution took 2072.7720260620117 ms (excluding imports and monkey-patching)
2022-09-21 16:11:15 INFO  Starting execution of 1 what-if analyses...
2022-09-21 16:11:15 INFO  Start plan generation for analysis DataCorruption...
2022-09-21 16:11:15 INFO  ---RUNTIME: Plan generation took 0.5402565002441406 ms
2022-09-21 16:11:15 INFO  Estimated runtime of original DAG is 1796.0984706878662ms
2022-09-21 16:11:15 INFO  Performing Multi-Query Optimization
2022-09-21 16:11:16 INFO  Estimated unoptimized what-if runtime is 53882.954120635986ms
2022-09-21 16:11:16 INFO  Estimated optimised what-if runtime is 1825.5870342254639ms
2022-09-21 16:11:16 INFO  Estimated optimisation runtime saving is 52057.36708641052ms
2022-09-21 16:11:16 INFO  ---RUNTIME: Multi-Query Optimization took 276.2768268585205 ms
2022-09-21 16:11:16 INFO  Executing generated plans
2022-09-21 16:11:18 INFO  ---RUNTIME: Execution took 1932.2714805603027 ms
2022-09-21 16:11:18 INFO  Done!
2022-09-21 16:11:18 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-21 16:11:18 INFO  Running instrumented original pipeline...
2022-09-21 16:11:18 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-21 16:11:18 INFO  ---RUNTIME: Importing and monkey-patching took 5.77092170715332 ms
2022-09-21 16:11:20 INFO  ---RUNTIME: Original pipeline execution took 2047.1243858337402 ms (excluding imports and monkey-patching)
2022-09-21 16:11:20 INFO  Starting execution of 1 what-if analyses...
2022-09-21 16:11:20 INFO  Start plan generation for analysis DataCorruption...
2022-09-21 16:11:20 INFO  ---RUNTIME: Plan generation took 0.5109310150146484 ms
2022-09-21 16:11:20 INFO  Estimated runtime of original DAG is 1773.5865116119385ms
2022-09-21 16:11:20 WARNING Skipping Multi-Query Optimization (instead, only applying patches)
2022-09-21 16:11:20 INFO  Estimated unoptimised what-if runtime is 53207.595348358154ms
2022-09-21 16:11:20 INFO  ---RUNTIME: Multi-Query Optimization took 23.854732513427734 ms
2022-09-21 16:11:20 INFO  Executing generated plans
2022-09-21 16:12:14 INFO  ---RUNTIME: Execution took 53928.09319496155 ms
2022-09-21 16:12:14 INFO  Done!
2022-09-21 16:12:14 INFO  # Finished -- repetition 2 of 7 
2022-09-21 16:12:14 INFO  # Optimization benchmark for data_corruption with args [['healthcare', 'slow_loading', 'featurization_4', 'logistic_regression']] -- repetition 3 of 7
2022-09-21 16:12:14 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-21 16:12:14 INFO  Running instrumented original pipeline...
2022-09-21 16:12:14 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-21 16:12:14 INFO  ---RUNTIME: Importing and monkey-patching took 6.197452545166016 ms
2022-09-21 16:12:16 INFO  ---RUNTIME: Original pipeline execution took 2031.925916671753 ms (excluding imports and monkey-patching)
2022-09-21 16:12:16 INFO  Starting execution of 1 what-if analyses...
2022-09-21 16:12:16 INFO  Start plan generation for analysis DataCorruption...
2022-09-21 16:12:16 INFO  ---RUNTIME: Plan generation took 0.4677772521972656 ms
2022-09-21 16:12:16 INFO  Estimated runtime of original DAG is 1757.4756145477295ms
2022-09-21 16:12:16 INFO  Performing Multi-Query Optimization
2022-09-21 16:12:16 INFO  Estimated unoptimized what-if runtime is 52724.268436431885ms
2022-09-21 16:12:16 INFO  Estimated optimised what-if runtime is 1784.794807434082ms
2022-09-21 16:12:16 INFO  Estimated optimisation runtime saving is 50939.4736289978ms
2022-09-21 16:12:16 INFO  ---RUNTIME: Multi-Query Optimization took 85.18600463867188 ms
2022-09-21 16:12:16 INFO  Executing generated plans
2022-09-21 16:12:18 INFO  ---RUNTIME: Execution took 1881.8495273590088 ms
2022-09-21 16:12:18 INFO  Done!
2022-09-21 16:12:18 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-21 16:12:18 INFO  Running instrumented original pipeline...
2022-09-21 16:12:18 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-21 16:12:18 INFO  ---RUNTIME: Importing and monkey-patching took 5.839824676513672 ms
2022-09-21 16:12:20 INFO  ---RUNTIME: Original pipeline execution took 2068.087577819824 ms (excluding imports and monkey-patching)
2022-09-21 16:12:20 INFO  Starting execution of 1 what-if analyses...
2022-09-21 16:12:20 INFO  Start plan generation for analysis DataCorruption...
2022-09-21 16:12:20 INFO  ---RUNTIME: Plan generation took 0.5517005920410156 ms
2022-09-21 16:12:20 INFO  Estimated runtime of original DAG is 1792.5596237182617ms
2022-09-21 16:12:20 WARNING Skipping Multi-Query Optimization (instead, only applying patches)
2022-09-21 16:12:20 INFO  Estimated unoptimised what-if runtime is 53776.78871154785ms
2022-09-21 16:12:20 INFO  ---RUNTIME: Multi-Query Optimization took 23.452043533325195 ms
2022-09-21 16:12:20 INFO  Executing generated plans
2022-09-21 16:13:14 INFO  ---RUNTIME: Execution took 54609.532594680786 ms
2022-09-21 16:13:14 INFO  Done!
2022-09-21 16:13:14 INFO  # Finished -- repetition 3 of 7 
2022-09-21 16:13:14 INFO  # Optimization benchmark for data_corruption with args [['healthcare', 'slow_loading', 'featurization_4', 'logistic_regression']] -- repetition 4 of 7
2022-09-21 16:13:14 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-21 16:13:14 INFO  Running instrumented original pipeline...
2022-09-21 16:13:14 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-21 16:13:14 INFO  ---RUNTIME: Importing and monkey-patching took 5.686044692993164 ms
2022-09-21 16:13:16 INFO  ---RUNTIME: Original pipeline execution took 2045.959711074829 ms (excluding imports and monkey-patching)
2022-09-21 16:13:16 INFO  Starting execution of 1 what-if analyses...
2022-09-21 16:13:16 INFO  Start plan generation for analysis DataCorruption...
2022-09-21 16:13:16 INFO  ---RUNTIME: Plan generation took 0.4737377166748047 ms
2022-09-21 16:13:16 INFO  Estimated runtime of original DAG is 1772.2663879394531ms
2022-09-21 16:13:16 INFO  Performing Multi-Query Optimization
2022-09-21 16:13:16 INFO  Estimated unoptimized what-if runtime is 53167.991638183594ms
2022-09-21 16:13:16 INFO  Estimated optimised what-if runtime is 1799.600601196289ms
2022-09-21 16:13:16 INFO  Estimated optimisation runtime saving is 51368.391036987305ms
2022-09-21 16:13:16 INFO  ---RUNTIME: Multi-Query Optimization took 85.44421195983887 ms
2022-09-21 16:13:16 INFO  Executing generated plans
2022-09-21 16:13:18 INFO  ---RUNTIME: Execution took 2016.765832901001 ms
2022-09-21 16:13:18 INFO  Done!
2022-09-21 16:13:18 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-21 16:13:18 INFO  Running instrumented original pipeline...
2022-09-21 16:13:18 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-21 16:13:18 INFO  ---RUNTIME: Importing and monkey-patching took 6.056785583496094 ms
2022-09-21 16:13:20 INFO  ---RUNTIME: Original pipeline execution took 2051.603078842163 ms (excluding imports and monkey-patching)
2022-09-21 16:13:20 INFO  Starting execution of 1 what-if analyses...
2022-09-21 16:13:20 INFO  Start plan generation for analysis DataCorruption...
2022-09-21 16:13:20 INFO  ---RUNTIME: Plan generation took 0.48065185546875 ms
2022-09-21 16:13:20 INFO  Estimated runtime of original DAG is 1777.9452800750732ms
2022-09-21 16:13:20 WARNING Skipping Multi-Query Optimization (instead, only applying patches)
2022-09-21 16:13:21 INFO  Estimated unoptimised what-if runtime is 53338.3584022522ms
2022-09-21 16:13:21 INFO  ---RUNTIME: Multi-Query Optimization took 28.903722763061523 ms
2022-09-21 16:13:21 INFO  Executing generated plans
2022-09-21 16:14:15 INFO  ---RUNTIME: Execution took 54497.67017364502 ms
2022-09-21 16:14:15 INFO  Done!
2022-09-21 16:14:15 INFO  # Finished -- repetition 4 of 7 
2022-09-21 16:14:15 INFO  # Optimization benchmark for data_corruption with args [['healthcare', 'slow_loading', 'featurization_4', 'logistic_regression']] -- repetition 5 of 7
2022-09-21 16:14:15 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-21 16:14:15 INFO  Running instrumented original pipeline...
2022-09-21 16:14:15 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-21 16:14:15 INFO  ---RUNTIME: Importing and monkey-patching took 6.16002082824707 ms
2022-09-21 16:14:17 INFO  ---RUNTIME: Original pipeline execution took 2036.160945892334 ms (excluding imports and monkey-patching)
2022-09-21 16:14:17 INFO  Starting execution of 1 what-if analyses...
2022-09-21 16:14:17 INFO  Start plan generation for analysis DataCorruption...
2022-09-21 16:14:17 INFO  ---RUNTIME: Plan generation took 0.5354881286621094 ms
2022-09-21 16:14:17 INFO  Estimated runtime of original DAG is 1760.6592178344727ms
2022-09-21 16:14:17 INFO  Performing Multi-Query Optimization
2022-09-21 16:14:17 INFO  Estimated unoptimized what-if runtime is 52819.77653503418ms
2022-09-21 16:14:17 INFO  Estimated optimised what-if runtime is 1788.7938022613525ms
2022-09-21 16:14:17 INFO  Estimated optimisation runtime saving is 51030.98273277283ms
2022-09-21 16:14:17 INFO  ---RUNTIME: Multi-Query Optimization took 307.66844749450684 ms
2022-09-21 16:14:17 INFO  Executing generated plans
2022-09-21 16:14:19 INFO  ---RUNTIME: Execution took 1865.3087615966797 ms
2022-09-21 16:14:19 INFO  Done!
2022-09-21 16:14:19 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-21 16:14:19 INFO  Running instrumented original pipeline...
2022-09-21 16:14:19 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-21 16:14:19 INFO  ---RUNTIME: Importing and monkey-patching took 5.622148513793945 ms
2022-09-21 16:14:21 INFO  ---RUNTIME: Original pipeline execution took 2085.470199584961 ms (excluding imports and monkey-patching)
2022-09-21 16:14:21 INFO  Starting execution of 1 what-if analyses...
2022-09-21 16:14:21 INFO  Start plan generation for analysis DataCorruption...
2022-09-21 16:14:21 INFO  ---RUNTIME: Plan generation took 0.5042552947998047 ms
2022-09-21 16:14:21 INFO  Estimated runtime of original DAG is 1806.847333908081ms
2022-09-21 16:14:21 WARNING Skipping Multi-Query Optimization (instead, only applying patches)
2022-09-21 16:14:21 INFO  Estimated unoptimised what-if runtime is 54205.42001724243ms
2022-09-21 16:14:21 INFO  ---RUNTIME: Multi-Query Optimization took 23.909330368041992 ms
2022-09-21 16:14:21 INFO  Executing generated plans
2022-09-21 16:15:15 INFO  ---RUNTIME: Execution took 53933.207511901855 ms
2022-09-21 16:15:15 INFO  Done!
2022-09-21 16:15:15 INFO  # Finished -- repetition 5 of 7 
2022-09-21 16:15:15 INFO  # Optimization benchmark for data_corruption with args [['healthcare', 'slow_loading', 'featurization_4', 'logistic_regression']] -- repetition 6 of 7
2022-09-21 16:15:15 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-21 16:15:15 INFO  Running instrumented original pipeline...
2022-09-21 16:15:15 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-21 16:15:15 INFO  ---RUNTIME: Importing and monkey-patching took 6.173372268676758 ms
2022-09-21 16:15:17 INFO  ---RUNTIME: Original pipeline execution took 2049.0074157714844 ms (excluding imports and monkey-patching)
2022-09-21 16:15:17 INFO  Starting execution of 1 what-if analyses...
2022-09-21 16:15:17 INFO  Start plan generation for analysis DataCorruption...
2022-09-21 16:15:17 INFO  ---RUNTIME: Plan generation took 0.5447864532470703 ms
2022-09-21 16:15:17 INFO  Estimated runtime of original DAG is 1776.1354446411133ms
2022-09-21 16:15:17 INFO  Performing Multi-Query Optimization
2022-09-21 16:15:17 INFO  Estimated unoptimized what-if runtime is 53284.0633392334ms
2022-09-21 16:15:17 INFO  Estimated optimised what-if runtime is 1804.1479587554932ms
2022-09-21 16:15:17 INFO  Estimated optimisation runtime saving is 51479.915380477905ms
2022-09-21 16:15:17 INFO  ---RUNTIME: Multi-Query Optimization took 84.72442626953125 ms
2022-09-21 16:15:17 INFO  Executing generated plans
2022-09-21 16:15:19 INFO  ---RUNTIME: Execution took 1889.1253471374512 ms
2022-09-21 16:15:19 INFO  Done!
2022-09-21 16:15:19 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-21 16:15:19 INFO  Running instrumented original pipeline...
2022-09-21 16:15:19 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-21 16:15:19 INFO  ---RUNTIME: Importing and monkey-patching took 5.736589431762695 ms
2022-09-21 16:15:21 INFO  ---RUNTIME: Original pipeline execution took 2011.976718902588 ms (excluding imports and monkey-patching)
2022-09-21 16:15:21 INFO  Starting execution of 1 what-if analyses...
2022-09-21 16:15:21 INFO  Start plan generation for analysis DataCorruption...
2022-09-21 16:15:21 INFO  ---RUNTIME: Plan generation took 0.6999969482421875 ms
2022-09-21 16:15:21 INFO  Estimated runtime of original DAG is 1737.5469207763672ms
2022-09-21 16:15:21 WARNING Skipping Multi-Query Optimization (instead, only applying patches)
2022-09-21 16:15:21 INFO  Estimated unoptimised what-if runtime is 52126.407623291016ms
2022-09-21 16:15:21 INFO  ---RUNTIME: Multi-Query Optimization took 23.2083797454834 ms
2022-09-21 16:15:21 INFO  Executing generated plans
2022-09-21 16:16:16 INFO  ---RUNTIME: Execution took 54210.848808288574 ms
2022-09-21 16:16:16 INFO  Done!
2022-09-21 16:16:16 INFO  # Finished -- repetition 6 of 7 
2022-09-21 16:16:16 INFO  # Optimization benchmark for data_corruption with args [['healthcare', 'slow_loading', 'featurization_4', 'logistic_regression']] -- repetition 7 of 7
2022-09-21 16:16:16 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-21 16:16:16 INFO  Running instrumented original pipeline...
2022-09-21 16:16:16 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-21 16:16:16 INFO  ---RUNTIME: Importing and monkey-patching took 5.686283111572266 ms
2022-09-21 16:16:18 INFO  ---RUNTIME: Original pipeline execution took 2045.2651977539062 ms (excluding imports and monkey-patching)
2022-09-21 16:16:18 INFO  Starting execution of 1 what-if analyses...
2022-09-21 16:16:18 INFO  Start plan generation for analysis DataCorruption...
2022-09-21 16:16:18 INFO  ---RUNTIME: Plan generation took 0.7727146148681641 ms
2022-09-21 16:16:18 INFO  Estimated runtime of original DAG is 1772.2785472869873ms
2022-09-21 16:16:18 INFO  Performing Multi-Query Optimization
2022-09-21 16:16:18 INFO  Estimated unoptimized what-if runtime is 53168.35641860962ms
2022-09-21 16:16:18 INFO  Estimated optimised what-if runtime is 1801.3513088226318ms
2022-09-21 16:16:18 INFO  Estimated optimisation runtime saving is 51367.00510978699ms
2022-09-21 16:16:18 INFO  ---RUNTIME: Multi-Query Optimization took 84.60021018981934 ms
2022-09-21 16:16:18 INFO  Executing generated plans
2022-09-21 16:16:20 INFO  ---RUNTIME: Execution took 1887.6299858093262 ms
2022-09-21 16:16:20 INFO  Done!
2022-09-21 16:16:20 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-21 16:16:20 INFO  Running instrumented original pipeline...
2022-09-21 16:16:20 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-21 16:16:20 INFO  ---RUNTIME: Importing and monkey-patching took 5.793333053588867 ms
2022-09-21 16:16:22 INFO  ---RUNTIME: Original pipeline execution took 2060.499668121338 ms (excluding imports and monkey-patching)
2022-09-21 16:16:22 INFO  Starting execution of 1 what-if analyses...
2022-09-21 16:16:22 INFO  Start plan generation for analysis DataCorruption...
2022-09-21 16:16:22 INFO  ---RUNTIME: Plan generation took 0.49757957458496094 ms
2022-09-21 16:16:22 INFO  Estimated runtime of original DAG is 1787.12797164917ms
2022-09-21 16:16:22 WARNING Skipping Multi-Query Optimization (instead, only applying patches)
2022-09-21 16:16:22 INFO  Estimated unoptimised what-if runtime is 53613.8391494751ms
2022-09-21 16:16:22 INFO  ---RUNTIME: Multi-Query Optimization took 23.337841033935547 ms
2022-09-21 16:16:22 INFO  Executing generated plans
2022-09-21 16:17:16 INFO  ---RUNTIME: Execution took 53996.986865997314 ms
2022-09-21 16:17:16 INFO  Done!
2022-09-21 16:17:16 INFO  # Finished -- repetition 7 of 7 
2022-09-21 16:17:16 INFO  # Final results after all repetitions
2022-09-21 16:17:16 INFO     repetition  ... no_opt_what_if_execution_combined_model_training
0           0  ...                                        73.745251
1           1  ...                                        72.752237
2           2  ...                                        73.583126
3           3  ...                                        72.904587
4           4  ...                                        72.764874
5           5  ...                                        73.074341
6           6  ...                                        72.845221

[7 rows x 26 columns]
taskset -c 0-7 PROTOCOL_BUFFERS_PYTHON_IMPLEMENTATION=python python3.9 benchmarks_end_to_end.py data_corruption healthcare slow_loading featurization_4 xgboost
2022-09-21 16:17:18.317895: W tensorflow/stream_executor/platform/default/dso_loader.cc:64] Could not load dynamic library 'libcudart.so.11.0'; dlerror: libcudart.so.11.0: cannot open shared object file: No such file or directory; LD_LIBRARY_PATH: /home/sgrafbe/mlwhatif/venv/lib/python3.9/site-packages/cv2/../../lib64:
2022-09-21 16:17:18.317931: I tensorflow/stream_executor/cuda/cudart_stub.cc:29] Ignore above cudart dlerror if you do not have a GPU set up on your machine.
2022-09-21 16:17:19 INFO  Patching sys.argv with ['mlwhatif', 'healthcare', 'slow_loading', 'featurization_4', 'xgboost']
2022-09-21 16:17:19 INFO  Running instrumented original pipeline...
2022-09-21 16:17:19 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-21 16:17:19 INFO  ---RUNTIME: Importing and monkey-patching took 95.17669677734375 ms
2022-09-21 16:17:22 INFO  ---RUNTIME: Original pipeline execution took 2398.448705673218 ms (excluding imports and monkey-patching)
2022-09-21 16:17:22 INFO  Starting execution of 0 what-if analyses...
2022-09-21 16:17:22 INFO  Estimated runtime of original DAG is 2094.285488128662ms
2022-09-21 16:17:22 INFO  Performing Multi-Query Optimization
2022-09-21 16:17:22 INFO  Estimated unoptimized what-if runtime is 0ms
2022-09-21 16:17:22 INFO  Estimated optimised what-if runtime is 0ms
2022-09-21 16:17:22 INFO  Estimated optimisation runtime saving is 0ms
2022-09-21 16:17:22 INFO  ---RUNTIME: Multi-Query Optimization took 0.4839897155761719 ms
2022-09-21 16:17:22 INFO  Executing generated plans
2022-09-21 16:17:22 INFO  ---RUNTIME: Execution took 0.021696090698242188 ms
2022-09-21 16:17:22 INFO  Done!
2022-09-21 16:17:22 INFO  # Optimization benchmark for data_corruption with args [['healthcare', 'slow_loading', 'featurization_4', 'xgboost']] -- repetition 1 of 7
2022-09-21 16:17:22 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-21 16:17:22 INFO  Running instrumented original pipeline...
2022-09-21 16:17:22 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-21 16:17:22 INFO  ---RUNTIME: Importing and monkey-patching took 5.105257034301758 ms
2022-09-21 16:17:24 INFO  ---RUNTIME: Original pipeline execution took 2221.1673259735107 ms (excluding imports and monkey-patching)
2022-09-21 16:17:24 INFO  Starting execution of 1 what-if analyses...
2022-09-21 16:17:24 INFO  Start plan generation for analysis DataCorruption...
2022-09-21 16:17:24 INFO  ---RUNTIME: Plan generation took 0.46753883361816406 ms
2022-09-21 16:17:24 INFO  Estimated runtime of original DAG is 1949.3834972381592ms
2022-09-21 16:17:24 INFO  Performing Multi-Query Optimization
2022-09-21 16:17:24 INFO  Estimated unoptimized what-if runtime is 58481.504917144775ms
2022-09-21 16:17:24 INFO  Estimated optimised what-if runtime is 2024.5261192321777ms
2022-09-21 16:17:24 INFO  Estimated optimisation runtime saving is 56456.9787979126ms
2022-09-21 16:17:24 INFO  ---RUNTIME: Multi-Query Optimization took 244.72403526306152 ms
2022-09-21 16:17:24 INFO  Executing generated plans
2022-09-21 16:17:26 INFO  ---RUNTIME: Execution took 2112.9636764526367 ms
2022-09-21 16:17:26 INFO  Done!
2022-09-21 16:17:26 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-21 16:17:26 INFO  Running instrumented original pipeline...
2022-09-21 16:17:26 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-21 16:17:26 INFO  ---RUNTIME: Importing and monkey-patching took 5.79833984375 ms
2022-09-21 16:17:28 INFO  ---RUNTIME: Original pipeline execution took 2232.106924057007 ms (excluding imports and monkey-patching)
2022-09-21 16:17:28 INFO  Starting execution of 1 what-if analyses...
2022-09-21 16:17:28 INFO  Start plan generation for analysis DataCorruption...
2022-09-21 16:17:28 INFO  ---RUNTIME: Plan generation took 0.47659873962402344 ms
2022-09-21 16:17:28 INFO  Estimated runtime of original DAG is 1954.6616077423096ms
2022-09-21 16:17:28 WARNING Skipping Multi-Query Optimization (instead, only applying patches)
2022-09-21 16:17:28 INFO  Estimated unoptimised what-if runtime is 58639.84823226929ms
2022-09-21 16:17:28 INFO  ---RUNTIME: Multi-Query Optimization took 23.523569107055664 ms
2022-09-21 16:17:28 INFO  Executing generated plans
2022-09-21 16:18:29 INFO  ---RUNTIME: Execution took 60466.752767562866 ms
2022-09-21 16:18:29 INFO  Done!
2022-09-21 16:18:29 INFO  # Finished -- repetition 1 of 7 
2022-09-21 16:18:29 INFO  # Optimization benchmark for data_corruption with args [['healthcare', 'slow_loading', 'featurization_4', 'xgboost']] -- repetition 2 of 7
2022-09-21 16:18:29 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-21 16:18:29 INFO  Running instrumented original pipeline...
2022-09-21 16:18:29 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-21 16:18:29 INFO  ---RUNTIME: Importing and monkey-patching took 6.111383438110352 ms
2022-09-21 16:18:31 INFO  ---RUNTIME: Original pipeline execution took 2219.541072845459 ms (excluding imports and monkey-patching)
2022-09-21 16:18:31 INFO  Starting execution of 1 what-if analyses...
2022-09-21 16:18:31 INFO  Start plan generation for analysis DataCorruption...
2022-09-21 16:18:31 INFO  ---RUNTIME: Plan generation took 0.5202293395996094 ms
2022-09-21 16:18:31 INFO  Estimated runtime of original DAG is 1946.4080333709717ms
2022-09-21 16:18:31 INFO  Performing Multi-Query Optimization
2022-09-21 16:18:31 INFO  Estimated unoptimized what-if runtime is 58392.24100112915ms
2022-09-21 16:18:31 INFO  Estimated optimised what-if runtime is 2021.1148262023926ms
2022-09-21 16:18:31 INFO  Estimated optimisation runtime saving is 56371.12617492676ms
2022-09-21 16:18:31 INFO  ---RUNTIME: Multi-Query Optimization took 84.42544937133789 ms
2022-09-21 16:18:31 INFO  Executing generated plans
2022-09-21 16:18:33 INFO  ---RUNTIME: Execution took 2294.3060398101807 ms
2022-09-21 16:18:33 INFO  Done!
2022-09-21 16:18:33 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-21 16:18:33 INFO  Running instrumented original pipeline...
2022-09-21 16:18:34 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-21 16:18:34 INFO  ---RUNTIME: Importing and monkey-patching took 6.089687347412109 ms
2022-09-21 16:18:36 INFO  ---RUNTIME: Original pipeline execution took 2224.3199348449707 ms (excluding imports and monkey-patching)
2022-09-21 16:18:36 INFO  Starting execution of 1 what-if analyses...
2022-09-21 16:18:36 INFO  Start plan generation for analysis DataCorruption...
2022-09-21 16:18:36 INFO  ---RUNTIME: Plan generation took 0.5090236663818359 ms
2022-09-21 16:18:36 INFO  Estimated runtime of original DAG is 1950.899362564087ms
2022-09-21 16:18:36 WARNING Skipping Multi-Query Optimization (instead, only applying patches)
2022-09-21 16:18:36 INFO  Estimated unoptimised what-if runtime is 58526.98087692261ms
2022-09-21 16:18:36 INFO  ---RUNTIME: Multi-Query Optimization took 23.285388946533203 ms
2022-09-21 16:18:36 INFO  Executing generated plans
2022-09-21 16:19:54 INFO  ---RUNTIME: Execution took 78405.76267242432 ms
2022-09-21 16:19:54 INFO  Done!
2022-09-21 16:19:54 INFO  # Finished -- repetition 2 of 7 
2022-09-21 16:19:54 INFO  # Optimization benchmark for data_corruption with args [['healthcare', 'slow_loading', 'featurization_4', 'xgboost']] -- repetition 3 of 7
2022-09-21 16:19:54 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-21 16:19:54 INFO  Running instrumented original pipeline...
2022-09-21 16:19:54 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-21 16:19:54 INFO  ---RUNTIME: Importing and monkey-patching took 6.099224090576172 ms
2022-09-21 16:19:56 INFO  ---RUNTIME: Original pipeline execution took 2236.0785007476807 ms (excluding imports and monkey-patching)
2022-09-21 16:19:56 INFO  Starting execution of 1 what-if analyses...
2022-09-21 16:19:56 INFO  Start plan generation for analysis DataCorruption...
2022-09-21 16:19:56 INFO  ---RUNTIME: Plan generation took 0.5085468292236328 ms
2022-09-21 16:19:56 INFO  Estimated runtime of original DAG is 1961.0717296600342ms
2022-09-21 16:19:56 INFO  Performing Multi-Query Optimization
2022-09-21 16:19:56 INFO  Estimated unoptimized what-if runtime is 58832.151889801025ms
2022-09-21 16:19:56 INFO  Estimated optimised what-if runtime is 2035.6471538543701ms
2022-09-21 16:19:56 INFO  Estimated optimisation runtime saving is 56796.504735946655ms
2022-09-21 16:19:56 INFO  ---RUNTIME: Multi-Query Optimization took 84.05828475952148 ms
2022-09-21 16:19:56 INFO  Executing generated plans
2022-09-21 16:19:59 INFO  ---RUNTIME: Execution took 2103.18922996521 ms
2022-09-21 16:19:59 INFO  Done!
2022-09-21 16:19:59 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-21 16:19:59 INFO  Running instrumented original pipeline...
2022-09-21 16:19:59 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-21 16:19:59 INFO  ---RUNTIME: Importing and monkey-patching took 5.645036697387695 ms
2022-09-21 16:20:01 INFO  ---RUNTIME: Original pipeline execution took 2225.728750228882 ms (excluding imports and monkey-patching)
2022-09-21 16:20:01 INFO  Starting execution of 1 what-if analyses...
2022-09-21 16:20:01 INFO  Start plan generation for analysis DataCorruption...
2022-09-21 16:20:01 INFO  ---RUNTIME: Plan generation took 0.6611347198486328 ms
2022-09-21 16:20:01 INFO  Estimated runtime of original DAG is 1950.7100582122803ms
2022-09-21 16:20:01 WARNING Skipping Multi-Query Optimization (instead, only applying patches)
2022-09-21 16:20:01 INFO  Estimated unoptimised what-if runtime is 58521.30174636841ms
2022-09-21 16:20:01 INFO  ---RUNTIME: Multi-Query Optimization took 23.33521842956543 ms
2022-09-21 16:20:01 INFO  Executing generated plans
2022-09-21 16:21:04 INFO  ---RUNTIME: Execution took 62881.367444992065 ms
2022-09-21 16:21:04 INFO  Done!
2022-09-21 16:21:04 INFO  # Finished -- repetition 3 of 7 
2022-09-21 16:21:04 INFO  # Optimization benchmark for data_corruption with args [['healthcare', 'slow_loading', 'featurization_4', 'xgboost']] -- repetition 4 of 7
2022-09-21 16:21:04 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-21 16:21:04 INFO  Running instrumented original pipeline...
2022-09-21 16:21:04 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-21 16:21:04 INFO  ---RUNTIME: Importing and monkey-patching took 5.84721565246582 ms
2022-09-21 16:21:06 INFO  ---RUNTIME: Original pipeline execution took 2224.3199348449707 ms (excluding imports and monkey-patching)
2022-09-21 16:21:06 INFO  Starting execution of 1 what-if analyses...
2022-09-21 16:21:06 INFO  Start plan generation for analysis DataCorruption...
2022-09-21 16:21:06 INFO  ---RUNTIME: Plan generation took 0.8513927459716797 ms
2022-09-21 16:21:06 INFO  Estimated runtime of original DAG is 1951.6572952270508ms
2022-09-21 16:21:06 INFO  Performing Multi-Query Optimization
2022-09-21 16:21:06 INFO  Estimated unoptimized what-if runtime is 58549.71885681152ms
2022-09-21 16:21:06 INFO  Estimated optimised what-if runtime is 2025.3784656524658ms
2022-09-21 16:21:06 INFO  Estimated optimisation runtime saving is 56524.34039115906ms
2022-09-21 16:21:06 INFO  ---RUNTIME: Multi-Query Optimization took 83.71520042419434 ms
2022-09-21 16:21:06 INFO  Executing generated plans
2022-09-21 16:21:08 INFO  ---RUNTIME: Execution took 2092.4229621887207 ms
2022-09-21 16:21:08 INFO  Done!
2022-09-21 16:21:08 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-21 16:21:08 INFO  Running instrumented original pipeline...
2022-09-21 16:21:08 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-21 16:21:08 INFO  ---RUNTIME: Importing and monkey-patching took 5.804538726806641 ms
2022-09-21 16:21:10 INFO  ---RUNTIME: Original pipeline execution took 2228.874683380127 ms (excluding imports and monkey-patching)
2022-09-21 16:21:10 INFO  Starting execution of 1 what-if analyses...
2022-09-21 16:21:10 INFO  Start plan generation for analysis DataCorruption...
2022-09-21 16:21:10 INFO  ---RUNTIME: Plan generation took 0.51116943359375 ms
2022-09-21 16:21:10 INFO  Estimated runtime of original DAG is 1956.5150737762451ms
2022-09-21 16:21:10 WARNING Skipping Multi-Query Optimization (instead, only applying patches)
2022-09-21 16:21:10 INFO  Estimated unoptimised what-if runtime is 58695.45221328735ms
2022-09-21 16:21:10 INFO  ---RUNTIME: Multi-Query Optimization took 23.28944206237793 ms
2022-09-21 16:21:10 INFO  Executing generated plans
2022-09-21 16:22:10 INFO  ---RUNTIME: Execution took 59466.981410980225 ms
2022-09-21 16:22:10 INFO  Done!
2022-09-21 16:22:10 INFO  # Finished -- repetition 4 of 7 
2022-09-21 16:22:10 INFO  # Optimization benchmark for data_corruption with args [['healthcare', 'slow_loading', 'featurization_4', 'xgboost']] -- repetition 5 of 7
2022-09-21 16:22:10 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-21 16:22:10 INFO  Running instrumented original pipeline...
2022-09-21 16:22:10 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-21 16:22:10 INFO  ---RUNTIME: Importing and monkey-patching took 6.189107894897461 ms
2022-09-21 16:22:12 INFO  ---RUNTIME: Original pipeline execution took 2219.5212841033936 ms (excluding imports and monkey-patching)
2022-09-21 16:22:12 INFO  Starting execution of 1 what-if analyses...
2022-09-21 16:22:12 INFO  Start plan generation for analysis DataCorruption...
2022-09-21 16:22:12 INFO  ---RUNTIME: Plan generation took 0.5221366882324219 ms
2022-09-21 16:22:12 INFO  Estimated runtime of original DAG is 1946.904182434082ms
2022-09-21 16:22:12 INFO  Performing Multi-Query Optimization
2022-09-21 16:22:12 INFO  Estimated unoptimized what-if runtime is 58407.12547302246ms
2022-09-21 16:22:12 INFO  Estimated optimised what-if runtime is 2021.9802856445312ms
2022-09-21 16:22:12 INFO  Estimated optimisation runtime saving is 56385.14518737793ms
2022-09-21 16:22:12 INFO  ---RUNTIME: Multi-Query Optimization took 306.6835403442383 ms
2022-09-21 16:22:12 INFO  Executing generated plans
2022-09-21 16:22:15 INFO  ---RUNTIME: Execution took 2119.0361976623535 ms
2022-09-21 16:22:15 INFO  Done!
2022-09-21 16:22:15 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-21 16:22:15 INFO  Running instrumented original pipeline...
2022-09-21 16:22:15 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-21 16:22:15 INFO  ---RUNTIME: Importing and monkey-patching took 5.860090255737305 ms
2022-09-21 16:22:17 INFO  ---RUNTIME: Original pipeline execution took 2229.2122840881348 ms (excluding imports and monkey-patching)
2022-09-21 16:22:17 INFO  Starting execution of 1 what-if analyses...
2022-09-21 16:22:17 INFO  Start plan generation for analysis DataCorruption...
2022-09-21 16:22:17 INFO  ---RUNTIME: Plan generation took 0.5633831024169922 ms
2022-09-21 16:22:17 INFO  Estimated runtime of original DAG is 1951.7512321472168ms
2022-09-21 16:22:17 WARNING Skipping Multi-Query Optimization (instead, only applying patches)
2022-09-21 16:22:17 INFO  Estimated unoptimised what-if runtime is 58552.536964416504ms
2022-09-21 16:22:17 INFO  ---RUNTIME: Multi-Query Optimization took 23.50592613220215 ms
2022-09-21 16:22:17 INFO  Executing generated plans
2022-09-21 16:23:16 INFO  ---RUNTIME: Execution took 59513.010025024414 ms
2022-09-21 16:23:16 INFO  Done!
2022-09-21 16:23:16 INFO  # Finished -- repetition 5 of 7 
2022-09-21 16:23:16 INFO  # Optimization benchmark for data_corruption with args [['healthcare', 'slow_loading', 'featurization_4', 'xgboost']] -- repetition 6 of 7
2022-09-21 16:23:16 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-21 16:23:16 INFO  Running instrumented original pipeline...
2022-09-21 16:23:16 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-21 16:23:16 INFO  ---RUNTIME: Importing and monkey-patching took 6.2274932861328125 ms
2022-09-21 16:23:19 INFO  ---RUNTIME: Original pipeline execution took 2222.290277481079 ms (excluding imports and monkey-patching)
2022-09-21 16:23:19 INFO  Starting execution of 1 what-if analyses...
2022-09-21 16:23:19 INFO  Start plan generation for analysis DataCorruption...
2022-09-21 16:23:19 INFO  ---RUNTIME: Plan generation took 0.5319118499755859 ms
2022-09-21 16:23:19 INFO  Estimated runtime of original DAG is 1947.5376605987549ms
2022-09-21 16:23:19 INFO  Performing Multi-Query Optimization
2022-09-21 16:23:19 INFO  Estimated unoptimized what-if runtime is 58426.12981796265ms
2022-09-21 16:23:19 INFO  Estimated optimised what-if runtime is 2023.3495235443115ms
2022-09-21 16:23:19 INFO  Estimated optimisation runtime saving is 56402.780294418335ms
2022-09-21 16:23:19 INFO  ---RUNTIME: Multi-Query Optimization took 84.0458869934082 ms
2022-09-21 16:23:19 INFO  Executing generated plans
2022-09-21 16:23:21 INFO  ---RUNTIME: Execution took 2107.0897579193115 ms
2022-09-21 16:23:21 INFO  Done!
2022-09-21 16:23:21 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-21 16:23:21 INFO  Running instrumented original pipeline...
2022-09-21 16:23:21 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-21 16:23:21 INFO  ---RUNTIME: Importing and monkey-patching took 5.759954452514648 ms
2022-09-21 16:23:23 INFO  ---RUNTIME: Original pipeline execution took 2235.0454330444336 ms (excluding imports and monkey-patching)
2022-09-21 16:23:23 INFO  Starting execution of 1 what-if analyses...
2022-09-21 16:23:23 INFO  Start plan generation for analysis DataCorruption...
2022-09-21 16:23:23 INFO  ---RUNTIME: Plan generation took 0.9353160858154297 ms
2022-09-21 16:23:23 INFO  Estimated runtime of original DAG is 1960.2975845336914ms
2022-09-21 16:23:23 WARNING Skipping Multi-Query Optimization (instead, only applying patches)
2022-09-21 16:23:23 INFO  Estimated unoptimised what-if runtime is 58808.92753601074ms
2022-09-21 16:23:23 INFO  ---RUNTIME: Multi-Query Optimization took 259.63330268859863 ms
2022-09-21 16:23:23 INFO  Executing generated plans
2022-09-21 16:24:23 INFO  ---RUNTIME: Execution took 60055.346727371216 ms
2022-09-21 16:24:23 INFO  Done!
2022-09-21 16:24:23 INFO  # Finished -- repetition 6 of 7 
2022-09-21 16:24:23 INFO  # Optimization benchmark for data_corruption with args [['healthcare', 'slow_loading', 'featurization_4', 'xgboost']] -- repetition 7 of 7
2022-09-21 16:24:23 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-21 16:24:23 INFO  Running instrumented original pipeline...
2022-09-21 16:24:23 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-21 16:24:23 INFO  ---RUNTIME: Importing and monkey-patching took 6.042003631591797 ms
2022-09-21 16:24:26 INFO  ---RUNTIME: Original pipeline execution took 2230.5774688720703 ms (excluding imports and monkey-patching)
2022-09-21 16:24:26 INFO  Starting execution of 1 what-if analyses...
2022-09-21 16:24:26 INFO  Start plan generation for analysis DataCorruption...
2022-09-21 16:24:26 INFO  ---RUNTIME: Plan generation took 0.5452632904052734 ms
2022-09-21 16:24:26 INFO  Estimated runtime of original DAG is 1954.7016620635986ms
2022-09-21 16:24:26 INFO  Performing Multi-Query Optimization
2022-09-21 16:24:26 INFO  Estimated unoptimized what-if runtime is 58641.04986190796ms
2022-09-21 16:24:26 INFO  Estimated optimised what-if runtime is 2029.7596454620361ms
2022-09-21 16:24:26 INFO  Estimated optimisation runtime saving is 56611.29021644592ms
2022-09-21 16:24:26 INFO  ---RUNTIME: Multi-Query Optimization took 83.7857723236084 ms
2022-09-21 16:24:26 INFO  Executing generated plans
2022-09-21 16:24:28 INFO  ---RUNTIME: Execution took 2113.499164581299 ms
2022-09-21 16:24:28 INFO  Done!
2022-09-21 16:24:28 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-21 16:24:28 INFO  Running instrumented original pipeline...
2022-09-21 16:24:28 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-21 16:24:28 INFO  ---RUNTIME: Importing and monkey-patching took 5.777597427368164 ms
2022-09-21 16:24:30 INFO  ---RUNTIME: Original pipeline execution took 2215.590715408325 ms (excluding imports and monkey-patching)
2022-09-21 16:24:30 INFO  Starting execution of 1 what-if analyses...
2022-09-21 16:24:30 INFO  Start plan generation for analysis DataCorruption...
2022-09-21 16:24:30 INFO  ---RUNTIME: Plan generation took 0.4982948303222656 ms
2022-09-21 16:24:30 INFO  Estimated runtime of original DAG is 1942.34299659729ms
2022-09-21 16:24:30 WARNING Skipping Multi-Query Optimization (instead, only applying patches)
2022-09-21 16:24:30 INFO  Estimated unoptimised what-if runtime is 58270.2898979187ms
2022-09-21 16:24:30 INFO  ---RUNTIME: Multi-Query Optimization took 22.996187210083008 ms
2022-09-21 16:24:30 INFO  Executing generated plans
2022-09-21 16:25:30 INFO  ---RUNTIME: Execution took 59591.325759887695 ms
2022-09-21 16:25:30 INFO  Done!
2022-09-21 16:25:30 INFO  # Finished -- repetition 7 of 7 
2022-09-21 16:25:30 INFO  # Final results after all repetitions
2022-09-21 16:25:30 INFO     repetition  ... no_opt_what_if_execution_combined_model_training
0           0  ...                                      6993.314981
1           1  ...                                     24009.175777
2           2  ...                                      9058.053970
3           3  ...                                      5931.983471
4           4  ...                                      5945.482969
5           5  ...                                      5947.628021
6           6  ...                                      5951.768398

[7 rows x 26 columns]
taskset -c 0-7 PROTOCOL_BUFFERS_PYTHON_IMPLEMENTATION=python python3.9 benchmarks_end_to_end.py data_corruption healthcare slow_loading featurization_4 neural_network
2022-09-21 16:25:32.203882: W tensorflow/stream_executor/platform/default/dso_loader.cc:64] Could not load dynamic library 'libcudart.so.11.0'; dlerror: libcudart.so.11.0: cannot open shared object file: No such file or directory; LD_LIBRARY_PATH: /home/sgrafbe/mlwhatif/venv/lib/python3.9/site-packages/cv2/../../lib64:
2022-09-21 16:25:32.203925: I tensorflow/stream_executor/cuda/cudart_stub.cc:29] Ignore above cudart dlerror if you do not have a GPU set up on your machine.
2022-09-21 16:25:33 INFO  Patching sys.argv with ['mlwhatif', 'healthcare', 'slow_loading', 'featurization_4', 'neural_network']
2022-09-21 16:25:33 INFO  Running instrumented original pipeline...
2022-09-21 16:25:33 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-21 16:25:33 INFO  ---RUNTIME: Importing and monkey-patching took 96.39453887939453 ms
2022-09-21 16:25:35.666205: W tensorflow/stream_executor/platform/default/dso_loader.cc:64] Could not load dynamic library 'libcuda.so.1'; dlerror: libcuda.so.1: cannot open shared object file: No such file or directory; LD_LIBRARY_PATH: /home/sgrafbe/mlwhatif/venv/lib/python3.9/site-packages/cv2/../../lib64:
2022-09-21 16:25:35.666238: W tensorflow/stream_executor/cuda/cuda_driver.cc:326] failed call to cuInit: UNKNOWN ERROR (303)
2022-09-21 16:25:35.666259: I tensorflow/stream_executor/cuda/cuda_diagnostics.cc:156] kernel driver does not appear to be running on this host (wagyu): /proc/driver/nvidia/version does not exist
2022-09-21 16:25:35.666709: I tensorflow/core/platform/cpu_feature_guard.cc:142] This TensorFlow binary is optimized with oneAPI Deep Neural Network Library (oneDNN) to use the following CPU instructions in performance-critical operations:  AVX2 FMA
To enable them in other operations, rebuild TensorFlow with the appropriate compiler flags.
2022-09-21 16:25:35.730880: I tensorflow/compiler/mlir/mlir_graph_optimization_pass.cc:176] None of the MLIR Optimization Passes are enabled (registered 2)
2022-09-21 16:25:35.743375: I tensorflow/core/platform/profile_utils/cpu_utils.cc:114] CPU Frequency: 2595290000 Hz
2022-09-21 16:25:36 INFO  ---RUNTIME: Original pipeline execution took 2818.1400299072266 ms (excluding imports and monkey-patching)
2022-09-21 16:25:36 INFO  Starting execution of 0 what-if analyses...
2022-09-21 16:25:36 INFO  Estimated runtime of original DAG is 2514.699697494507ms
2022-09-21 16:25:36 INFO  Performing Multi-Query Optimization
2022-09-21 16:25:36 INFO  Estimated unoptimized what-if runtime is 0ms
2022-09-21 16:25:36 INFO  Estimated optimised what-if runtime is 0ms
2022-09-21 16:25:36 INFO  Estimated optimisation runtime saving is 0ms
2022-09-21 16:25:36 INFO  ---RUNTIME: Multi-Query Optimization took 0.5102157592773438 ms
2022-09-21 16:25:36 INFO  Executing generated plans
2022-09-21 16:25:36 INFO  ---RUNTIME: Execution took 0.016450881958007812 ms
2022-09-21 16:25:36 INFO  Done!
2022-09-21 16:25:36 INFO  # Optimization benchmark for data_corruption with args [['healthcare', 'slow_loading', 'featurization_4', 'neural_network']] -- repetition 1 of 7
2022-09-21 16:25:36 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-21 16:25:36 INFO  Running instrumented original pipeline...
2022-09-21 16:25:36 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-21 16:25:36 INFO  ---RUNTIME: Importing and monkey-patching took 5.255460739135742 ms
2022-09-21 16:25:38 INFO  ---RUNTIME: Original pipeline execution took 2409.4135761260986 ms (excluding imports and monkey-patching)
2022-09-21 16:25:38 INFO  Starting execution of 1 what-if analyses...
2022-09-21 16:25:38 INFO  Start plan generation for analysis DataCorruption...
2022-09-21 16:25:38 INFO  ---RUNTIME: Plan generation took 0.4744529724121094 ms
2022-09-21 16:25:38 INFO  Estimated runtime of original DAG is 2138.2675170898438ms
2022-09-21 16:25:38 INFO  Performing Multi-Query Optimization
2022-09-21 16:25:38 INFO  Estimated unoptimized what-if runtime is 64148.02551269531ms
2022-09-21 16:25:38 INFO  Estimated optimised what-if runtime is 3640.9153938293457ms
2022-09-21 16:25:38 INFO  Estimated optimisation runtime saving is 60507.11011886597ms
2022-09-21 16:25:38 INFO  ---RUNTIME: Multi-Query Optimization took 83.97626876831055 ms
2022-09-21 16:25:38 INFO  Executing generated plans
2022-09-21 16:25:41 INFO  ---RUNTIME: Execution took 3105.807065963745 ms
2022-09-21 16:25:41 INFO  Done!
2022-09-21 16:25:41 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-21 16:25:41 INFO  Running instrumented original pipeline...
2022-09-21 16:25:42 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-21 16:25:42 INFO  ---RUNTIME: Importing and monkey-patching took 5.811929702758789 ms
2022-09-21 16:25:44 INFO  ---RUNTIME: Original pipeline execution took 2619.0543174743652 ms (excluding imports and monkey-patching)
2022-09-21 16:25:44 INFO  Starting execution of 1 what-if analyses...
2022-09-21 16:25:44 INFO  Start plan generation for analysis DataCorruption...
2022-09-21 16:25:44 INFO  ---RUNTIME: Plan generation took 0.48160552978515625 ms
2022-09-21 16:25:44 INFO  Estimated runtime of original DAG is 2343.2228565216064ms
2022-09-21 16:25:44 WARNING Skipping Multi-Query Optimization (instead, only applying patches)
2022-09-21 16:25:44 INFO  Estimated unoptimised what-if runtime is 70296.6856956482ms
2022-09-21 16:25:44 INFO  ---RUNTIME: Multi-Query Optimization took 23.076295852661133 ms
2022-09-21 16:25:44 INFO  Executing generated plans
2022-09-21 16:26:51 INFO  ---RUNTIME: Execution took 66709.17296409607 ms
2022-09-21 16:26:51 INFO  Done!
2022-09-21 16:26:51 INFO  # Finished -- repetition 1 of 7 
2022-09-21 16:26:51 INFO  # Optimization benchmark for data_corruption with args [['healthcare', 'slow_loading', 'featurization_4', 'neural_network']] -- repetition 2 of 7
2022-09-21 16:26:51 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-21 16:26:51 INFO  Running instrumented original pipeline...
2022-09-21 16:26:51 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-21 16:26:51 INFO  ---RUNTIME: Importing and monkey-patching took 5.8193206787109375 ms
2022-09-21 16:26:53 INFO  ---RUNTIME: Original pipeline execution took 2424.6747493743896 ms (excluding imports and monkey-patching)
2022-09-21 16:26:53 INFO  Starting execution of 1 what-if analyses...
2022-09-21 16:26:53 INFO  Start plan generation for analysis DataCorruption...
2022-09-21 16:26:53 INFO  ---RUNTIME: Plan generation took 0.5300045013427734 ms
2022-09-21 16:26:53 INFO  Estimated runtime of original DAG is 2149.0979194641113ms
2022-09-21 16:26:53 INFO  Performing Multi-Query Optimization
2022-09-21 16:26:53 INFO  Estimated unoptimized what-if runtime is 64472.93758392334ms
2022-09-21 16:26:53 INFO  Estimated optimised what-if runtime is 3768.523693084717ms
2022-09-21 16:26:53 INFO  Estimated optimisation runtime saving is 60704.41389083862ms
2022-09-21 16:26:53 INFO  ---RUNTIME: Multi-Query Optimization took 86.6236686706543 ms
2022-09-21 16:26:53 INFO  Executing generated plans
2022-09-21 16:26:57 INFO  ---RUNTIME: Execution took 3314.8539066314697 ms
2022-09-21 16:26:57 INFO  Done!
2022-09-21 16:26:57 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-21 16:26:57 INFO  Running instrumented original pipeline...
2022-09-21 16:26:57 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-21 16:26:57 INFO  ---RUNTIME: Importing and monkey-patching took 5.863428115844727 ms
2022-09-21 16:26:59 INFO  ---RUNTIME: Original pipeline execution took 2464.8756980895996 ms (excluding imports and monkey-patching)
2022-09-21 16:26:59 INFO  Starting execution of 1 what-if analyses...
2022-09-21 16:26:59 INFO  Start plan generation for analysis DataCorruption...
2022-09-21 16:26:59 INFO  ---RUNTIME: Plan generation took 0.5590915679931641 ms
2022-09-21 16:26:59 INFO  Estimated runtime of original DAG is 2187.9258155822754ms
2022-09-21 16:26:59 WARNING Skipping Multi-Query Optimization (instead, only applying patches)
2022-09-21 16:26:59 INFO  Estimated unoptimised what-if runtime is 65637.77446746826ms
2022-09-21 16:26:59 INFO  ---RUNTIME: Multi-Query Optimization took 25.00319480895996 ms
2022-09-21 16:26:59 INFO  Executing generated plans
2022-09-21 16:28:06 INFO  ---RUNTIME: Execution took 67026.85642242432 ms
2022-09-21 16:28:06 INFO  Done!
2022-09-21 16:28:06 INFO  # Finished -- repetition 2 of 7 
2022-09-21 16:28:06 INFO  # Optimization benchmark for data_corruption with args [['healthcare', 'slow_loading', 'featurization_4', 'neural_network']] -- repetition 3 of 7
2022-09-21 16:28:06 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-21 16:28:06 INFO  Running instrumented original pipeline...
2022-09-21 16:28:06 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-21 16:28:06 INFO  ---RUNTIME: Importing and monkey-patching took 8.478879928588867 ms
2022-09-21 16:28:09 INFO  ---RUNTIME: Original pipeline execution took 2885.5786323547363 ms (excluding imports and monkey-patching)
2022-09-21 16:28:09 INFO  Starting execution of 1 what-if analyses...
2022-09-21 16:28:09 INFO  Start plan generation for analysis DataCorruption...
2022-09-21 16:28:09 INFO  ---RUNTIME: Plan generation took 0.5707740783691406 ms
2022-09-21 16:28:09 INFO  Estimated runtime of original DAG is 2562.4783039093018ms
2022-09-21 16:28:09 INFO  Performing Multi-Query Optimization
2022-09-21 16:28:09 INFO  Estimated unoptimized what-if runtime is 76874.34911727905ms
2022-09-21 16:28:09 INFO  Estimated optimised what-if runtime is 4262.084007263184ms
2022-09-21 16:28:09 INFO  Estimated optimisation runtime saving is 72612.26511001587ms
2022-09-21 16:28:09 INFO  ---RUNTIME: Multi-Query Optimization took 104.10690307617188 ms
2022-09-21 16:28:09 INFO  Executing generated plans
2022-09-21 16:28:13 INFO  ---RUNTIME: Execution took 3740.2005195617676 ms
2022-09-21 16:28:13 INFO  Done!
2022-09-21 16:28:13 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-21 16:28:13 INFO  Running instrumented original pipeline...
2022-09-21 16:28:13 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-21 16:28:13 INFO  ---RUNTIME: Importing and monkey-patching took 6.492376327514648 ms
2022-09-21 16:28:15 INFO  ---RUNTIME: Original pipeline execution took 2433.584213256836 ms (excluding imports and monkey-patching)
2022-09-21 16:28:15 INFO  Starting execution of 1 what-if analyses...
2022-09-21 16:28:15 INFO  Start plan generation for analysis DataCorruption...
2022-09-21 16:28:15 INFO  ---RUNTIME: Plan generation took 0.5316734313964844 ms
2022-09-21 16:28:15 INFO  Estimated runtime of original DAG is 2159.987211227417ms
2022-09-21 16:28:15 WARNING Skipping Multi-Query Optimization (instead, only applying patches)
2022-09-21 16:28:15 INFO  Estimated unoptimised what-if runtime is 64799.61633682251ms
2022-09-21 16:28:15 INFO  ---RUNTIME: Multi-Query Optimization took 23.716211318969727 ms
2022-09-21 16:28:15 INFO  Executing generated plans
2022-09-21 16:29:24 INFO  ---RUNTIME: Execution took 68438.07649612427 ms
2022-09-21 16:29:24 INFO  Done!
2022-09-21 16:29:24 INFO  # Finished -- repetition 3 of 7 
2022-09-21 16:29:24 INFO  # Optimization benchmark for data_corruption with args [['healthcare', 'slow_loading', 'featurization_4', 'neural_network']] -- repetition 4 of 7
2022-09-21 16:29:24 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-21 16:29:24 INFO  Running instrumented original pipeline...
2022-09-21 16:29:24 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-21 16:29:24 INFO  ---RUNTIME: Importing and monkey-patching took 6.007909774780273 ms
2022-09-21 16:29:26 INFO  ---RUNTIME: Original pipeline execution took 2450.4573345184326 ms (excluding imports and monkey-patching)
2022-09-21 16:29:26 INFO  Starting execution of 1 what-if analyses...
2022-09-21 16:29:26 INFO  Start plan generation for analysis DataCorruption...
2022-09-21 16:29:26 INFO  ---RUNTIME: Plan generation took 0.5033016204833984 ms
2022-09-21 16:29:26 INFO  Estimated runtime of original DAG is 2174.2990016937256ms
2022-09-21 16:29:26 INFO  Performing Multi-Query Optimization
2022-09-21 16:29:26 INFO  Estimated unoptimized what-if runtime is 65228.97005081177ms
2022-09-21 16:29:26 INFO  Estimated optimised what-if runtime is 3678.9629459381104ms
2022-09-21 16:29:26 INFO  Estimated optimisation runtime saving is 61550.00710487366ms
2022-09-21 16:29:26 INFO  ---RUNTIME: Multi-Query Optimization took 83.35685729980469 ms
2022-09-21 16:29:26 INFO  Executing generated plans
2022-09-21 16:29:30 INFO  ---RUNTIME: Execution took 3468.458890914917 ms
2022-09-21 16:29:30 INFO  Done!
2022-09-21 16:29:30 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-21 16:29:30 INFO  Running instrumented original pipeline...
2022-09-21 16:29:30 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-21 16:29:30 INFO  ---RUNTIME: Importing and monkey-patching took 6.094217300415039 ms
2022-09-21 16:29:32 INFO  ---RUNTIME: Original pipeline execution took 2439.073085784912 ms (excluding imports and monkey-patching)
2022-09-21 16:29:32 INFO  Starting execution of 1 what-if analyses...
2022-09-21 16:29:32 INFO  Start plan generation for analysis DataCorruption...
2022-09-21 16:29:32 INFO  ---RUNTIME: Plan generation took 0.5526542663574219 ms
2022-09-21 16:29:32 INFO  Estimated runtime of original DAG is 2163.968324661255ms
2022-09-21 16:29:32 WARNING Skipping Multi-Query Optimization (instead, only applying patches)
2022-09-21 16:29:32 INFO  Estimated unoptimised what-if runtime is 64919.04973983765ms
2022-09-21 16:29:32 INFO  ---RUNTIME: Multi-Query Optimization took 24.953603744506836 ms
2022-09-21 16:29:32 INFO  Executing generated plans
2022-09-21 16:30:41 INFO  ---RUNTIME: Execution took 68169.27909851074 ms
2022-09-21 16:30:41 INFO  Done!
2022-09-21 16:30:41 INFO  # Finished -- repetition 4 of 7 
2022-09-21 16:30:41 INFO  # Optimization benchmark for data_corruption with args [['healthcare', 'slow_loading', 'featurization_4', 'neural_network']] -- repetition 5 of 7
2022-09-21 16:30:41 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-21 16:30:41 INFO  Running instrumented original pipeline...
2022-09-21 16:30:41 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-21 16:30:41 INFO  ---RUNTIME: Importing and monkey-patching took 5.923032760620117 ms
2022-09-21 16:30:43 INFO  ---RUNTIME: Original pipeline execution took 2445.7621574401855 ms (excluding imports and monkey-patching)
2022-09-21 16:30:43 INFO  Starting execution of 1 what-if analyses...
2022-09-21 16:30:43 INFO  Start plan generation for analysis DataCorruption...
2022-09-21 16:30:43 INFO  ---RUNTIME: Plan generation took 0.5450248718261719 ms
2022-09-21 16:30:43 INFO  Estimated runtime of original DAG is 2171.3428497314453ms
2022-09-21 16:30:43 INFO  Performing Multi-Query Optimization
2022-09-21 16:30:43 INFO  Estimated unoptimized what-if runtime is 65140.28549194336ms
2022-09-21 16:30:43 INFO  Estimated optimised what-if runtime is 3649.930000305176ms
2022-09-21 16:30:43 INFO  Estimated optimisation runtime saving is 61490.35549163818ms
2022-09-21 16:30:43 INFO  ---RUNTIME: Multi-Query Optimization took 85.26086807250977 ms
2022-09-21 16:30:43 INFO  Executing generated plans
2022-09-21 16:30:47 INFO  ---RUNTIME: Execution took 3461.174488067627 ms
2022-09-21 16:30:47 INFO  Done!
2022-09-21 16:30:47 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-21 16:30:47 INFO  Running instrumented original pipeline...
2022-09-21 16:30:47 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-21 16:30:47 INFO  ---RUNTIME: Importing and monkey-patching took 6.087541580200195 ms
2022-09-21 16:30:49 INFO  ---RUNTIME: Original pipeline execution took 2449.7876167297363 ms (excluding imports and monkey-patching)
2022-09-21 16:30:49 INFO  Starting execution of 1 what-if analyses...
2022-09-21 16:30:49 INFO  Start plan generation for analysis DataCorruption...
2022-09-21 16:30:49 INFO  ---RUNTIME: Plan generation took 0.5578994750976562 ms
2022-09-21 16:30:49 INFO  Estimated runtime of original DAG is 2172.3663806915283ms
2022-09-21 16:30:49 WARNING Skipping Multi-Query Optimization (instead, only applying patches)
2022-09-21 16:30:49 INFO  Estimated unoptimised what-if runtime is 65170.99142074585ms
2022-09-21 16:30:49 INFO  ---RUNTIME: Multi-Query Optimization took 23.405790328979492 ms
2022-09-21 16:30:49 INFO  Executing generated plans
2022-09-21 16:31:57 INFO  ---RUNTIME: Execution took 68324.44453239441 ms
2022-09-21 16:31:57 INFO  Done!
2022-09-21 16:31:57 INFO  # Finished -- repetition 5 of 7 
2022-09-21 16:31:57 INFO  # Optimization benchmark for data_corruption with args [['healthcare', 'slow_loading', 'featurization_4', 'neural_network']] -- repetition 6 of 7
2022-09-21 16:31:57 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-21 16:31:57 INFO  Running instrumented original pipeline...
2022-09-21 16:31:57 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-21 16:31:57 INFO  ---RUNTIME: Importing and monkey-patching took 5.920171737670898 ms
2022-09-21 16:32:00 INFO  ---RUNTIME: Original pipeline execution took 2452.1145820617676 ms (excluding imports and monkey-patching)
2022-09-21 16:32:00 INFO  Starting execution of 1 what-if analyses...
2022-09-21 16:32:00 INFO  Start plan generation for analysis DataCorruption...
2022-09-21 16:32:00 INFO  ---RUNTIME: Plan generation took 0.5469322204589844 ms
2022-09-21 16:32:00 INFO  Estimated runtime of original DAG is 2174.858570098877ms
2022-09-21 16:32:00 INFO  Performing Multi-Query Optimization
2022-09-21 16:32:00 INFO  Estimated unoptimized what-if runtime is 65245.75710296631ms
2022-09-21 16:32:00 INFO  Estimated optimised what-if runtime is 3706.7482471466064ms
2022-09-21 16:32:00 INFO  Estimated optimisation runtime saving is 61539.0088558197ms
2022-09-21 16:32:00 INFO  ---RUNTIME: Multi-Query Optimization took 84.81240272521973 ms
2022-09-21 16:32:00 INFO  Executing generated plans
2022-09-21 16:32:03 INFO  ---RUNTIME: Execution took 3105.6859493255615 ms
2022-09-21 16:32:03 INFO  Done!
2022-09-21 16:32:03 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-21 16:32:03 INFO  Running instrumented original pipeline...
2022-09-21 16:32:03 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-21 16:32:03 INFO  ---RUNTIME: Importing and monkey-patching took 6.701946258544922 ms
2022-09-21 16:32:05 INFO  ---RUNTIME: Original pipeline execution took 2477.4417877197266 ms (excluding imports and monkey-patching)
2022-09-21 16:32:05 INFO  Starting execution of 1 what-if analyses...
2022-09-21 16:32:05 INFO  Start plan generation for analysis DataCorruption...
2022-09-21 16:32:05 INFO  ---RUNTIME: Plan generation took 0.4887580871582031 ms
2022-09-21 16:32:05 INFO  Estimated runtime of original DAG is 2188.185691833496ms
2022-09-21 16:32:05 WARNING Skipping Multi-Query Optimization (instead, only applying patches)
2022-09-21 16:32:06 INFO  Estimated unoptimised what-if runtime is 65645.57075500488ms
2022-09-21 16:32:06 INFO  ---RUNTIME: Multi-Query Optimization took 23.71048927307129 ms
2022-09-21 16:32:06 INFO  Executing generated plans
2022-09-21 16:33:15 INFO  ---RUNTIME: Execution took 69102.5800704956 ms
2022-09-21 16:33:15 INFO  Done!
2022-09-21 16:33:15 INFO  # Finished -- repetition 6 of 7 
2022-09-21 16:33:15 INFO  # Optimization benchmark for data_corruption with args [['healthcare', 'slow_loading', 'featurization_4', 'neural_network']] -- repetition 7 of 7
2022-09-21 16:33:15 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-21 16:33:15 INFO  Running instrumented original pipeline...
2022-09-21 16:33:15 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-21 16:33:15 INFO  ---RUNTIME: Importing and monkey-patching took 5.879640579223633 ms
2022-09-21 16:33:17 INFO  ---RUNTIME: Original pipeline execution took 2874.9992847442627 ms (excluding imports and monkey-patching)
2022-09-21 16:33:17 INFO  Starting execution of 1 what-if analyses...
2022-09-21 16:33:17 INFO  Start plan generation for analysis DataCorruption...
2022-09-21 16:33:17 INFO  ---RUNTIME: Plan generation took 0.4608631134033203 ms
2022-09-21 16:33:17 INFO  Estimated runtime of original DAG is 2598.2813835144043ms
2022-09-21 16:33:17 INFO  Performing Multi-Query Optimization
2022-09-21 16:33:18 INFO  Estimated unoptimized what-if runtime is 77948.44150543213ms
2022-09-21 16:33:18 INFO  Estimated optimised what-if runtime is 4094.8891639709473ms
2022-09-21 16:33:18 INFO  Estimated optimisation runtime saving is 73853.55234146118ms
2022-09-21 16:33:18 INFO  ---RUNTIME: Multi-Query Optimization took 83.71305465698242 ms
2022-09-21 16:33:18 INFO  Executing generated plans
2022-09-21 16:33:21 INFO  ---RUNTIME: Execution took 3135.770082473755 ms
2022-09-21 16:33:21 INFO  Done!
2022-09-21 16:33:21 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-21 16:33:21 INFO  Running instrumented original pipeline...
2022-09-21 16:33:21 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-21 16:33:21 INFO  ---RUNTIME: Importing and monkey-patching took 5.877971649169922 ms
2022-09-21 16:33:23 INFO  ---RUNTIME: Original pipeline execution took 2462.646722793579 ms (excluding imports and monkey-patching)
2022-09-21 16:33:23 INFO  Starting execution of 1 what-if analyses...
2022-09-21 16:33:23 INFO  Start plan generation for analysis DataCorruption...
2022-09-21 16:33:23 INFO  ---RUNTIME: Plan generation took 0.48923492431640625 ms
2022-09-21 16:33:23 INFO  Estimated runtime of original DAG is 2188.504457473755ms
2022-09-21 16:33:23 WARNING Skipping Multi-Query Optimization (instead, only applying patches)
2022-09-21 16:33:23 INFO  Estimated unoptimised what-if runtime is 65655.13372421265ms
2022-09-21 16:33:23 INFO  ---RUNTIME: Multi-Query Optimization took 23.50783348083496 ms
2022-09-21 16:33:23 INFO  Executing generated plans
2022-09-21 16:34:33 INFO  ---RUNTIME: Execution took 69352.86688804626 ms
2022-09-21 16:34:33 INFO  Done!
2022-09-21 16:34:33 INFO  # Finished -- repetition 7 of 7 
2022-09-21 16:34:33 INFO  # Final results after all repetitions
2022-09-21 16:34:33 INFO     repetition  ... no_opt_what_if_execution_combined_model_training
0           0  ...                                     11146.956921
1           1  ...                                     11156.060219
2           2  ...                                     10756.235123
3           3  ...                                     11234.686852
4           4  ...                                     11687.202215
5           5  ...                                     10587.684631
6           6  ...                                     11450.576067

[7 rows x 26 columns]
taskset -c 0-7 PROTOCOL_BUFFERS_PYTHON_IMPLEMENTATION=python python3.9 benchmarks_end_to_end.py feature_importance healthcare slow_loading featurization_0 logistic_regression
2022-09-21 16:34:35.496569: W tensorflow/stream_executor/platform/default/dso_loader.cc:64] Could not load dynamic library 'libcudart.so.11.0'; dlerror: libcudart.so.11.0: cannot open shared object file: No such file or directory; LD_LIBRARY_PATH: /home/sgrafbe/mlwhatif/venv/lib/python3.9/site-packages/cv2/../../lib64:
2022-09-21 16:34:35.496614: I tensorflow/stream_executor/cuda/cudart_stub.cc:29] Ignore above cudart dlerror if you do not have a GPU set up on your machine.
2022-09-21 16:34:36 INFO  Patching sys.argv with ['mlwhatif', 'healthcare', 'slow_loading', 'featurization_0', 'logistic_regression']
2022-09-21 16:34:36 INFO  Running instrumented original pipeline...
2022-09-21 16:34:36 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-21 16:34:36 INFO  ---RUNTIME: Importing and monkey-patching took 107.43093490600586 ms
2022-09-21 16:34:38 INFO  ---RUNTIME: Original pipeline execution took 2071.9573497772217 ms (excluding imports and monkey-patching)
2022-09-21 16:34:38 INFO  Starting execution of 0 what-if analyses...
2022-09-21 16:34:38 INFO  Estimated runtime of original DAG is 1794.755458831787ms
2022-09-21 16:34:38 INFO  Performing Multi-Query Optimization
2022-09-21 16:34:38 INFO  Estimated unoptimized what-if runtime is 0ms
2022-09-21 16:34:38 INFO  Estimated optimised what-if runtime is 0ms
2022-09-21 16:34:38 INFO  Estimated optimisation runtime saving is 0ms
2022-09-21 16:34:38 INFO  ---RUNTIME: Multi-Query Optimization took 0.4928112030029297 ms
2022-09-21 16:34:38 INFO  Executing generated plans
2022-09-21 16:34:38 INFO  ---RUNTIME: Execution took 0.0247955322265625 ms
2022-09-21 16:34:38 INFO  Done!
2022-09-21 16:34:38 INFO  # Optimization benchmark for feature_importance with args [['healthcare', 'slow_loading', 'featurization_0', 'logistic_regression']] -- repetition 1 of 7
2022-09-21 16:34:38 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-21 16:34:38 INFO  Running instrumented original pipeline...
2022-09-21 16:34:38 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-21 16:34:38 INFO  ---RUNTIME: Importing and monkey-patching took 5.163431167602539 ms
2022-09-21 16:34:40 INFO  ---RUNTIME: Original pipeline execution took 1968.5115814208984 ms (excluding imports and monkey-patching)
2022-09-21 16:34:40 INFO  Starting execution of 1 what-if analyses...
2022-09-21 16:34:40 INFO  Start plan generation for analysis PermutationFeatureImportance...
2022-09-21 16:34:40 INFO  ---RUNTIME: Plan generation took 0.19478797912597656 ms
2022-09-21 16:34:40 INFO  Estimated runtime of original DAG is 1730.912685394287ms
2022-09-21 16:34:40 INFO  Performing Multi-Query Optimization
2022-09-21 16:34:40 INFO  Estimated unoptimized what-if runtime is 10385.476112365723ms
2022-09-21 16:34:40 INFO  Estimated optimised what-if runtime is 1734.1423034667969ms
2022-09-21 16:34:40 INFO  Estimated optimisation runtime saving is 8651.333808898926ms
2022-09-21 16:34:40 INFO  ---RUNTIME: Multi-Query Optimization took 13.0157470703125 ms
2022-09-21 16:34:40 INFO  Executing generated plans
2022-09-21 16:34:42 INFO  ---RUNTIME: Execution took 1757.4858665466309 ms
2022-09-21 16:34:42 INFO  Done!
2022-09-21 16:34:42 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-21 16:34:42 INFO  Running instrumented original pipeline...
2022-09-21 16:34:42 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-21 16:34:42 INFO  ---RUNTIME: Importing and monkey-patching took 5.895137786865234 ms
2022-09-21 16:34:44 INFO  ---RUNTIME: Original pipeline execution took 2195.953845977783 ms (excluding imports and monkey-patching)
2022-09-21 16:34:44 INFO  Starting execution of 1 what-if analyses...
2022-09-21 16:34:44 INFO  Start plan generation for analysis PermutationFeatureImportance...
2022-09-21 16:34:44 INFO  ---RUNTIME: Plan generation took 0.11920928955078125 ms
2022-09-21 16:34:44 INFO  Estimated runtime of original DAG is 1763.991117477417ms
2022-09-21 16:34:44 WARNING Skipping Multi-Query Optimization (instead, only applying patches)
2022-09-21 16:34:44 INFO  Estimated unoptimised what-if runtime is 10583.946704864502ms
2022-09-21 16:34:44 INFO  ---RUNTIME: Multi-Query Optimization took 4.826784133911133 ms
2022-09-21 16:34:44 INFO  Executing generated plans
2022-09-21 16:34:55 INFO  ---RUNTIME: Execution took 10594.121217727661 ms
2022-09-21 16:34:55 INFO  Done!
2022-09-21 16:34:55 INFO  # Finished -- repetition 1 of 7 
2022-09-21 16:34:55 INFO  # Optimization benchmark for feature_importance with args [['healthcare', 'slow_loading', 'featurization_0', 'logistic_regression']] -- repetition 2 of 7
2022-09-21 16:34:55 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-21 16:34:55 INFO  Running instrumented original pipeline...
2022-09-21 16:34:55 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-21 16:34:55 INFO  ---RUNTIME: Importing and monkey-patching took 6.158590316772461 ms
2022-09-21 16:34:57 INFO  ---RUNTIME: Original pipeline execution took 1960.0484371185303 ms (excluding imports and monkey-patching)
2022-09-21 16:34:57 INFO  Starting execution of 1 what-if analyses...
2022-09-21 16:34:57 INFO  Start plan generation for analysis PermutationFeatureImportance...
2022-09-21 16:34:57 INFO  ---RUNTIME: Plan generation took 0.1354217529296875 ms
2022-09-21 16:34:57 INFO  Estimated runtime of original DAG is 1725.3594398498535ms
2022-09-21 16:34:57 INFO  Performing Multi-Query Optimization
2022-09-21 16:34:57 INFO  Estimated unoptimized what-if runtime is 10352.156639099121ms
2022-09-21 16:34:57 INFO  Estimated optimised what-if runtime is 1728.569746017456ms
2022-09-21 16:34:57 INFO  Estimated optimisation runtime saving is 8623.586893081665ms
2022-09-21 16:34:57 INFO  ---RUNTIME: Multi-Query Optimization took 13.135433197021484 ms
2022-09-21 16:34:57 INFO  Executing generated plans
2022-09-21 16:34:59 INFO  ---RUNTIME: Execution took 1750.9169578552246 ms
2022-09-21 16:34:59 INFO  Done!
2022-09-21 16:34:59 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-21 16:34:59 INFO  Running instrumented original pipeline...
2022-09-21 16:34:59 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-21 16:34:59 INFO  ---RUNTIME: Importing and monkey-patching took 5.439043045043945 ms
2022-09-21 16:35:01 INFO  ---RUNTIME: Original pipeline execution took 2090.4836654663086 ms (excluding imports and monkey-patching)
2022-09-21 16:35:01 INFO  Starting execution of 1 what-if analyses...
2022-09-21 16:35:01 INFO  Start plan generation for analysis PermutationFeatureImportance...
2022-09-21 16:35:01 INFO  ---RUNTIME: Plan generation took 0.133514404296875 ms
2022-09-21 16:35:01 INFO  Estimated runtime of original DAG is 1867.793321609497ms
2022-09-21 16:35:01 WARNING Skipping Multi-Query Optimization (instead, only applying patches)
2022-09-21 16:35:01 INFO  Estimated unoptimised what-if runtime is 11206.759929656982ms
2022-09-21 16:35:01 INFO  ---RUNTIME: Multi-Query Optimization took 4.407644271850586 ms
2022-09-21 16:35:01 INFO  Executing generated plans
2022-09-21 16:35:12 INFO  ---RUNTIME: Execution took 10784.900188446045 ms
2022-09-21 16:35:12 INFO  Done!
2022-09-21 16:35:12 INFO  # Finished -- repetition 2 of 7 
2022-09-21 16:35:12 INFO  # Optimization benchmark for feature_importance with args [['healthcare', 'slow_loading', 'featurization_0', 'logistic_regression']] -- repetition 3 of 7
2022-09-21 16:35:12 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-21 16:35:12 INFO  Running instrumented original pipeline...
2022-09-21 16:35:12 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-21 16:35:12 INFO  ---RUNTIME: Importing and monkey-patching took 6.117820739746094 ms
2022-09-21 16:35:14 INFO  ---RUNTIME: Original pipeline execution took 1971.2114334106445 ms (excluding imports and monkey-patching)
2022-09-21 16:35:14 INFO  Starting execution of 1 what-if analyses...
2022-09-21 16:35:14 INFO  Start plan generation for analysis PermutationFeatureImportance...
2022-09-21 16:35:14 INFO  ---RUNTIME: Plan generation took 0.11658668518066406 ms
2022-09-21 16:35:14 INFO  Estimated runtime of original DAG is 1748.0247020721436ms
2022-09-21 16:35:14 INFO  Performing Multi-Query Optimization
2022-09-21 16:35:14 INFO  Estimated unoptimized what-if runtime is 10488.148212432861ms
2022-09-21 16:35:14 INFO  Estimated optimised what-if runtime is 1750.9033679962158ms
2022-09-21 16:35:14 INFO  Estimated optimisation runtime saving is 8737.244844436646ms
2022-09-21 16:35:14 INFO  ---RUNTIME: Multi-Query Optimization took 10.943174362182617 ms
2022-09-21 16:35:14 INFO  Executing generated plans
2022-09-21 16:35:15 INFO  ---RUNTIME: Execution took 1862.9710674285889 ms
2022-09-21 16:35:15 INFO  Done!
2022-09-21 16:35:15 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-21 16:35:15 INFO  Running instrumented original pipeline...
2022-09-21 16:35:15 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-21 16:35:15 INFO  ---RUNTIME: Importing and monkey-patching took 6.3629150390625 ms
2022-09-21 16:35:18 INFO  ---RUNTIME: Original pipeline execution took 2279.155969619751 ms (excluding imports and monkey-patching)
2022-09-21 16:35:18 INFO  Starting execution of 1 what-if analyses...
2022-09-21 16:35:18 INFO  Start plan generation for analysis PermutationFeatureImportance...
2022-09-21 16:35:18 INFO  ---RUNTIME: Plan generation took 0.14853477478027344 ms
2022-09-21 16:35:18 INFO  Estimated runtime of original DAG is 2034.4321727752686ms
2022-09-21 16:35:18 WARNING Skipping Multi-Query Optimization (instead, only applying patches)
2022-09-21 16:35:18 INFO  Estimated unoptimised what-if runtime is 12206.593036651611ms
2022-09-21 16:35:18 INFO  ---RUNTIME: Multi-Query Optimization took 4.858732223510742 ms
2022-09-21 16:35:18 INFO  Executing generated plans
2022-09-21 16:35:29 INFO  ---RUNTIME: Execution took 11059.94963645935 ms
2022-09-21 16:35:29 INFO  Done!
2022-09-21 16:35:29 INFO  # Finished -- repetition 3 of 7 
2022-09-21 16:35:29 INFO  # Optimization benchmark for feature_importance with args [['healthcare', 'slow_loading', 'featurization_0', 'logistic_regression']] -- repetition 4 of 7
2022-09-21 16:35:29 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-21 16:35:29 INFO  Running instrumented original pipeline...
2022-09-21 16:35:29 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-21 16:35:29 INFO  ---RUNTIME: Importing and monkey-patching took 5.8269500732421875 ms
2022-09-21 16:35:31 INFO  ---RUNTIME: Original pipeline execution took 1978.930950164795 ms (excluding imports and monkey-patching)
2022-09-21 16:35:31 INFO  Starting execution of 1 what-if analyses...
2022-09-21 16:35:31 INFO  Start plan generation for analysis PermutationFeatureImportance...
2022-09-21 16:35:31 INFO  ---RUNTIME: Plan generation took 0.10466575622558594 ms
2022-09-21 16:35:31 INFO  Estimated runtime of original DAG is 1757.4353218078613ms
2022-09-21 16:35:31 INFO  Performing Multi-Query Optimization
2022-09-21 16:35:31 INFO  Estimated unoptimized what-if runtime is 10544.611930847168ms
2022-09-21 16:35:31 INFO  Estimated optimised what-if runtime is 1760.2779865264893ms
2022-09-21 16:35:31 INFO  Estimated optimisation runtime saving is 8784.333944320679ms
2022-09-21 16:35:31 INFO  ---RUNTIME: Multi-Query Optimization took 10.488271713256836 ms
2022-09-21 16:35:31 INFO  Executing generated plans
2022-09-21 16:35:33 INFO  ---RUNTIME: Execution took 1782.3522090911865 ms
2022-09-21 16:35:33 INFO  Done!
2022-09-21 16:35:33 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-21 16:35:33 INFO  Running instrumented original pipeline...
2022-09-21 16:35:33 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-21 16:35:33 INFO  ---RUNTIME: Importing and monkey-patching took 5.659341812133789 ms
2022-09-21 16:35:35 INFO  ---RUNTIME: Original pipeline execution took 1963.3772373199463 ms (excluding imports and monkey-patching)
2022-09-21 16:35:35 INFO  Starting execution of 1 what-if analyses...
2022-09-21 16:35:35 INFO  Start plan generation for analysis PermutationFeatureImportance...
2022-09-21 16:35:35 INFO  ---RUNTIME: Plan generation took 0.10013580322265625 ms
2022-09-21 16:35:35 INFO  Estimated runtime of original DAG is 1740.2544021606445ms
2022-09-21 16:35:35 WARNING Skipping Multi-Query Optimization (instead, only applying patches)
2022-09-21 16:35:35 INFO  Estimated unoptimised what-if runtime is 10441.526412963867ms
2022-09-21 16:35:35 INFO  ---RUNTIME: Multi-Query Optimization took 3.9682388305664062 ms
2022-09-21 16:35:35 INFO  Executing generated plans
2022-09-21 16:35:45 INFO  ---RUNTIME: Execution took 10580.606698989868 ms
2022-09-21 16:35:45 INFO  Done!
2022-09-21 16:35:45 INFO  # Finished -- repetition 4 of 7 
2022-09-21 16:35:45 INFO  # Optimization benchmark for feature_importance with args [['healthcare', 'slow_loading', 'featurization_0', 'logistic_regression']] -- repetition 5 of 7
2022-09-21 16:35:45 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-21 16:35:45 INFO  Running instrumented original pipeline...
2022-09-21 16:35:45 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-21 16:35:45 INFO  ---RUNTIME: Importing and monkey-patching took 6.05320930480957 ms
2022-09-21 16:35:47 INFO  ---RUNTIME: Original pipeline execution took 1978.7180423736572 ms (excluding imports and monkey-patching)
2022-09-21 16:35:47 INFO  Starting execution of 1 what-if analyses...
2022-09-21 16:35:47 INFO  Start plan generation for analysis PermutationFeatureImportance...
2022-09-21 16:35:47 INFO  ---RUNTIME: Plan generation took 0.11754035949707031 ms
2022-09-21 16:35:47 INFO  Estimated runtime of original DAG is 1755.7153701782227ms
2022-09-21 16:35:47 INFO  Performing Multi-Query Optimization
2022-09-21 16:35:47 INFO  Estimated unoptimized what-if runtime is 10534.292221069336ms
2022-09-21 16:35:47 INFO  Estimated optimised what-if runtime is 1758.5668563842773ms
2022-09-21 16:35:47 INFO  Estimated optimisation runtime saving is 8775.725364685059ms
2022-09-21 16:35:47 INFO  ---RUNTIME: Multi-Query Optimization took 10.637044906616211 ms
2022-09-21 16:35:47 INFO  Executing generated plans
2022-09-21 16:35:49 INFO  ---RUNTIME: Execution took 1785.308837890625 ms
2022-09-21 16:35:49 INFO  Done!
2022-09-21 16:35:49 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-21 16:35:49 INFO  Running instrumented original pipeline...
2022-09-21 16:35:49 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-21 16:35:49 INFO  ---RUNTIME: Importing and monkey-patching took 5.6209564208984375 ms
2022-09-21 16:35:51 INFO  ---RUNTIME: Original pipeline execution took 1976.7646789550781 ms (excluding imports and monkey-patching)
2022-09-21 16:35:51 INFO  Starting execution of 1 what-if analyses...
2022-09-21 16:35:51 INFO  Start plan generation for analysis PermutationFeatureImportance...
2022-09-21 16:35:51 INFO  ---RUNTIME: Plan generation took 0.10180473327636719 ms
2022-09-21 16:35:51 INFO  Estimated runtime of original DAG is 1755.3431987762451ms
2022-09-21 16:35:51 WARNING Skipping Multi-Query Optimization (instead, only applying patches)
2022-09-21 16:35:51 INFO  Estimated unoptimised what-if runtime is 10532.05919265747ms
2022-09-21 16:35:51 INFO  ---RUNTIME: Multi-Query Optimization took 3.9548873901367188 ms
2022-09-21 16:35:51 INFO  Executing generated plans
2022-09-21 16:36:02 INFO  ---RUNTIME: Execution took 10834.118604660034 ms
2022-09-21 16:36:02 INFO  Done!
2022-09-21 16:36:02 INFO  # Finished -- repetition 5 of 7 
2022-09-21 16:36:02 INFO  # Optimization benchmark for feature_importance with args [['healthcare', 'slow_loading', 'featurization_0', 'logistic_regression']] -- repetition 6 of 7
2022-09-21 16:36:02 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-21 16:36:02 INFO  Running instrumented original pipeline...
2022-09-21 16:36:02 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-21 16:36:02 INFO  ---RUNTIME: Importing and monkey-patching took 5.7926177978515625 ms
2022-09-21 16:36:04 INFO  ---RUNTIME: Original pipeline execution took 1927.9601573944092 ms (excluding imports and monkey-patching)
2022-09-21 16:36:04 INFO  Starting execution of 1 what-if analyses...
2022-09-21 16:36:04 INFO  Start plan generation for analysis PermutationFeatureImportance...
2022-09-21 16:36:04 INFO  ---RUNTIME: Plan generation took 0.10323524475097656 ms
2022-09-21 16:36:04 INFO  Estimated runtime of original DAG is 1703.0024528503418ms
2022-09-21 16:36:04 INFO  Performing Multi-Query Optimization
2022-09-21 16:36:04 INFO  Estimated unoptimized what-if runtime is 10218.01471710205ms
2022-09-21 16:36:04 INFO  Estimated optimised what-if runtime is 1705.8384418487549ms
2022-09-21 16:36:04 INFO  Estimated optimisation runtime saving is 8512.176275253296ms
2022-09-21 16:36:04 INFO  ---RUNTIME: Multi-Query Optimization took 10.706901550292969 ms
2022-09-21 16:36:04 INFO  Executing generated plans
2022-09-21 16:36:05 INFO  ---RUNTIME: Execution took 1781.7974090576172 ms
2022-09-21 16:36:05 INFO  Done!
2022-09-21 16:36:05 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-21 16:36:05 INFO  Running instrumented original pipeline...
2022-09-21 16:36:06 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-21 16:36:06 INFO  ---RUNTIME: Importing and monkey-patching took 5.662441253662109 ms
2022-09-21 16:36:08 INFO  ---RUNTIME: Original pipeline execution took 2044.4352626800537 ms (excluding imports and monkey-patching)
2022-09-21 16:36:08 INFO  Starting execution of 1 what-if analyses...
2022-09-21 16:36:08 INFO  Start plan generation for analysis PermutationFeatureImportance...
2022-09-21 16:36:08 INFO  ---RUNTIME: Plan generation took 0.10585784912109375 ms
2022-09-21 16:36:08 INFO  Estimated runtime of original DAG is 1823.8024711608887ms
2022-09-21 16:36:08 WARNING Skipping Multi-Query Optimization (instead, only applying patches)
2022-09-21 16:36:08 INFO  Estimated unoptimised what-if runtime is 10942.814826965332ms
2022-09-21 16:36:08 INFO  ---RUNTIME: Multi-Query Optimization took 4.068613052368164 ms
2022-09-21 16:36:08 INFO  Executing generated plans
2022-09-21 16:36:19 INFO  ---RUNTIME: Execution took 10982.4857711792 ms
2022-09-21 16:36:19 INFO  Done!
2022-09-21 16:36:19 INFO  # Finished -- repetition 6 of 7 
2022-09-21 16:36:19 INFO  # Optimization benchmark for feature_importance with args [['healthcare', 'slow_loading', 'featurization_0', 'logistic_regression']] -- repetition 7 of 7
2022-09-21 16:36:19 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-21 16:36:19 INFO  Running instrumented original pipeline...
2022-09-21 16:36:19 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-21 16:36:19 INFO  ---RUNTIME: Importing and monkey-patching took 5.770444869995117 ms
2022-09-21 16:36:20 INFO  ---RUNTIME: Original pipeline execution took 1933.777093887329 ms (excluding imports and monkey-patching)
2022-09-21 16:36:20 INFO  Starting execution of 1 what-if analyses...
2022-09-21 16:36:20 INFO  Start plan generation for analysis PermutationFeatureImportance...
2022-09-21 16:36:20 INFO  ---RUNTIME: Plan generation took 0.10061264038085938 ms
2022-09-21 16:36:20 INFO  Estimated runtime of original DAG is 1712.8376960754395ms
2022-09-21 16:36:20 INFO  Performing Multi-Query Optimization
2022-09-21 16:36:20 INFO  Estimated unoptimized what-if runtime is 10277.026176452637ms
2022-09-21 16:36:20 INFO  Estimated optimised what-if runtime is 1715.679407119751ms
2022-09-21 16:36:20 INFO  Estimated optimisation runtime saving is 8561.346769332886ms
2022-09-21 16:36:20 INFO  ---RUNTIME: Multi-Query Optimization took 10.442495346069336 ms
2022-09-21 16:36:20 INFO  Executing generated plans
2022-09-21 16:36:22 INFO  ---RUNTIME: Execution took 1735.7609272003174 ms
2022-09-21 16:36:22 INFO  Done!
2022-09-21 16:36:22 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-21 16:36:22 INFO  Running instrumented original pipeline...
2022-09-21 16:36:22 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-21 16:36:22 INFO  ---RUNTIME: Importing and monkey-patching took 5.641698837280273 ms
2022-09-21 16:36:24 INFO  ---RUNTIME: Original pipeline execution took 1942.4567222595215 ms (excluding imports and monkey-patching)
2022-09-21 16:36:24 INFO  Starting execution of 1 what-if analyses...
2022-09-21 16:36:24 INFO  Start plan generation for analysis PermutationFeatureImportance...
2022-09-21 16:36:24 INFO  ---RUNTIME: Plan generation took 0.1010894775390625 ms
2022-09-21 16:36:24 INFO  Estimated runtime of original DAG is 1720.6165790557861ms
2022-09-21 16:36:24 WARNING Skipping Multi-Query Optimization (instead, only applying patches)
2022-09-21 16:36:24 INFO  Estimated unoptimised what-if runtime is 10323.699474334717ms
2022-09-21 16:36:24 INFO  ---RUNTIME: Multi-Query Optimization took 4.009246826171875 ms
2022-09-21 16:36:24 INFO  Executing generated plans
2022-09-21 16:36:35 INFO  ---RUNTIME: Execution took 10490.904569625854 ms
2022-09-21 16:36:35 INFO  Done!
2022-09-21 16:36:35 INFO  # Finished -- repetition 7 of 7 
2022-09-21 16:36:35 INFO  # Final results after all repetitions
2022-09-21 16:36:35 INFO     repetition  ... no_opt_what_if_execution_combined_model_training
0           0  ...                                         5.815029
1           1  ...                                         5.725145
2           2  ...                                         5.649805
3           3  ...                                         5.795240
4           4  ...                                         5.694628
5           5  ...                                         5.800724
6           6  ...                                         5.763292

[7 rows x 26 columns]
taskset -c 0-7 PROTOCOL_BUFFERS_PYTHON_IMPLEMENTATION=python python3.9 benchmarks_end_to_end.py feature_importance healthcare slow_loading featurization_0 xgboost
2022-09-21 16:36:37.195972: W tensorflow/stream_executor/platform/default/dso_loader.cc:64] Could not load dynamic library 'libcudart.so.11.0'; dlerror: libcudart.so.11.0: cannot open shared object file: No such file or directory; LD_LIBRARY_PATH: /home/sgrafbe/mlwhatif/venv/lib/python3.9/site-packages/cv2/../../lib64:
2022-09-21 16:36:37.196008: I tensorflow/stream_executor/cuda/cudart_stub.cc:29] Ignore above cudart dlerror if you do not have a GPU set up on your machine.
2022-09-21 16:36:38 INFO  Patching sys.argv with ['mlwhatif', 'healthcare', 'slow_loading', 'featurization_0', 'xgboost']
2022-09-21 16:36:38 INFO  Running instrumented original pipeline...
2022-09-21 16:36:38 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-21 16:36:38 INFO  ---RUNTIME: Importing and monkey-patching took 97.98526763916016 ms
2022-09-21 16:36:40 INFO  ---RUNTIME: Original pipeline execution took 2252.4518966674805 ms (excluding imports and monkey-patching)
2022-09-21 16:36:40 INFO  Starting execution of 0 what-if analyses...
2022-09-21 16:36:40 INFO  Estimated runtime of original DAG is 1990.7772541046143ms
2022-09-21 16:36:40 INFO  Performing Multi-Query Optimization
2022-09-21 16:36:40 INFO  Estimated unoptimized what-if runtime is 0ms
2022-09-21 16:36:40 INFO  Estimated optimised what-if runtime is 0ms
2022-09-21 16:36:40 INFO  Estimated optimisation runtime saving is 0ms
2022-09-21 16:36:40 INFO  ---RUNTIME: Multi-Query Optimization took 0.4444122314453125 ms
2022-09-21 16:36:40 INFO  Executing generated plans
2022-09-21 16:36:40 INFO  ---RUNTIME: Execution took 0.026226043701171875 ms
2022-09-21 16:36:40 INFO  Done!
2022-09-21 16:36:40 INFO  # Optimization benchmark for feature_importance with args [['healthcare', 'slow_loading', 'featurization_0', 'xgboost']] -- repetition 1 of 7
2022-09-21 16:36:40 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-21 16:36:40 INFO  Running instrumented original pipeline...
2022-09-21 16:36:40 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-21 16:36:40 INFO  ---RUNTIME: Importing and monkey-patching took 5.119085311889648 ms
2022-09-21 16:36:43 INFO  ---RUNTIME: Original pipeline execution took 2148.4484672546387 ms (excluding imports and monkey-patching)
2022-09-21 16:36:43 INFO  Starting execution of 1 what-if analyses...
2022-09-21 16:36:43 INFO  Start plan generation for analysis PermutationFeatureImportance...
2022-09-21 16:36:43 INFO  ---RUNTIME: Plan generation took 0.19741058349609375 ms
2022-09-21 16:36:43 INFO  Estimated runtime of original DAG is 1923.227310180664ms
2022-09-21 16:36:43 INFO  Performing Multi-Query Optimization
2022-09-21 16:36:43 INFO  Estimated unoptimized what-if runtime is 11539.363861083984ms
2022-09-21 16:36:43 INFO  Estimated optimised what-if runtime is 1934.2610836029053ms
2022-09-21 16:36:43 INFO  Estimated optimisation runtime saving is 9605.10277748108ms
2022-09-21 16:36:43 INFO  ---RUNTIME: Multi-Query Optimization took 12.593269348144531 ms
2022-09-21 16:36:43 INFO  Executing generated plans
2022-09-21 16:36:46 INFO  ---RUNTIME: Execution took 3877.7987957000732 ms
2022-09-21 16:36:46 INFO  Done!
2022-09-21 16:36:46 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-21 16:36:46 INFO  Running instrumented original pipeline...
2022-09-21 16:36:47 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-21 16:36:47 INFO  ---RUNTIME: Importing and monkey-patching took 5.885124206542969 ms
2022-09-21 16:36:49 INFO  ---RUNTIME: Original pipeline execution took 2412.1358394622803 ms (excluding imports and monkey-patching)
2022-09-21 16:36:49 INFO  Starting execution of 1 what-if analyses...
2022-09-21 16:36:49 INFO  Start plan generation for analysis PermutationFeatureImportance...
2022-09-21 16:36:49 INFO  ---RUNTIME: Plan generation took 0.102996826171875 ms
2022-09-21 16:36:49 INFO  Estimated runtime of original DAG is 1999.8271465301514ms
2022-09-21 16:36:49 WARNING Skipping Multi-Query Optimization (instead, only applying patches)
2022-09-21 16:36:49 INFO  Estimated unoptimised what-if runtime is 11998.962879180908ms
2022-09-21 16:36:49 INFO  ---RUNTIME: Multi-Query Optimization took 4.0073394775390625 ms
2022-09-21 16:36:49 INFO  Executing generated plans
2022-09-21 16:37:01 INFO  ---RUNTIME: Execution took 11807.005882263184 ms
2022-09-21 16:37:01 INFO  Done!
2022-09-21 16:37:01 INFO  # Finished -- repetition 1 of 7 
2022-09-21 16:37:01 INFO  # Optimization benchmark for feature_importance with args [['healthcare', 'slow_loading', 'featurization_0', 'xgboost']] -- repetition 2 of 7
2022-09-21 16:37:01 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-21 16:37:01 INFO  Running instrumented original pipeline...
2022-09-21 16:37:01 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-21 16:37:01 INFO  ---RUNTIME: Importing and monkey-patching took 5.867958068847656 ms
2022-09-21 16:37:03 INFO  ---RUNTIME: Original pipeline execution took 2241.029739379883 ms (excluding imports and monkey-patching)
2022-09-21 16:37:03 INFO  Starting execution of 1 what-if analyses...
2022-09-21 16:37:03 INFO  Start plan generation for analysis PermutationFeatureImportance...
2022-09-21 16:37:03 INFO  ---RUNTIME: Plan generation took 0.15306472778320312 ms
2022-09-21 16:37:03 INFO  Estimated runtime of original DAG is 2019.538402557373ms
2022-09-21 16:37:03 INFO  Performing Multi-Query Optimization
2022-09-21 16:37:03 INFO  Estimated unoptimized what-if runtime is 12117.230415344238ms
2022-09-21 16:37:03 INFO  Estimated optimised what-if runtime is 2030.3122997283936ms
2022-09-21 16:37:03 INFO  Estimated optimisation runtime saving is 10086.918115615845ms
2022-09-21 16:37:03 INFO  ---RUNTIME: Multi-Query Optimization took 10.756969451904297 ms
2022-09-21 16:37:03 INFO  Executing generated plans
2022-09-21 16:37:05 INFO  ---RUNTIME: Execution took 1968.691349029541 ms
2022-09-21 16:37:05 INFO  Done!
2022-09-21 16:37:05 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-21 16:37:05 INFO  Running instrumented original pipeline...
2022-09-21 16:37:05 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-21 16:37:05 INFO  ---RUNTIME: Importing and monkey-patching took 5.812406539916992 ms
2022-09-21 16:37:07 INFO  ---RUNTIME: Original pipeline execution took 2147.683620452881 ms (excluding imports and monkey-patching)
2022-09-21 16:37:07 INFO  Starting execution of 1 what-if analyses...
2022-09-21 16:37:07 INFO  Start plan generation for analysis PermutationFeatureImportance...
2022-09-21 16:37:07 INFO  ---RUNTIME: Plan generation took 0.14138221740722656 ms
2022-09-21 16:37:07 INFO  Estimated runtime of original DAG is 1924.7944355010986ms
2022-09-21 16:37:07 WARNING Skipping Multi-Query Optimization (instead, only applying patches)
2022-09-21 16:37:07 INFO  Estimated unoptimised what-if runtime is 11548.766613006592ms
2022-09-21 16:37:07 INFO  ---RUNTIME: Multi-Query Optimization took 4.484653472900391 ms
2022-09-21 16:37:07 INFO  Executing generated plans
2022-09-21 16:37:19 INFO  ---RUNTIME: Execution took 12391.616344451904 ms
2022-09-21 16:37:19 INFO  Done!
2022-09-21 16:37:19 INFO  # Finished -- repetition 2 of 7 
2022-09-21 16:37:19 INFO  # Optimization benchmark for feature_importance with args [['healthcare', 'slow_loading', 'featurization_0', 'xgboost']] -- repetition 3 of 7
2022-09-21 16:37:19 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-21 16:37:19 INFO  Running instrumented original pipeline...
2022-09-21 16:37:19 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-21 16:37:19 INFO  ---RUNTIME: Importing and monkey-patching took 6.07609748840332 ms
2022-09-21 16:37:22 INFO  ---RUNTIME: Original pipeline execution took 2167.5453186035156 ms (excluding imports and monkey-patching)
2022-09-21 16:37:22 INFO  Starting execution of 1 what-if analyses...
2022-09-21 16:37:22 INFO  Start plan generation for analysis PermutationFeatureImportance...
2022-09-21 16:37:22 INFO  ---RUNTIME: Plan generation took 0.11754035949707031 ms
2022-09-21 16:37:22 INFO  Estimated runtime of original DAG is 1943.5234069824219ms
2022-09-21 16:37:22 INFO  Performing Multi-Query Optimization
2022-09-21 16:37:22 INFO  Estimated unoptimized what-if runtime is 11661.140441894531ms
2022-09-21 16:37:22 INFO  Estimated optimised what-if runtime is 1954.237937927246ms
2022-09-21 16:37:22 INFO  Estimated optimisation runtime saving is 9706.902503967285ms
2022-09-21 16:37:22 INFO  ---RUNTIME: Multi-Query Optimization took 11.083602905273438 ms
2022-09-21 16:37:22 INFO  Executing generated plans
2022-09-21 16:37:24 INFO  ---RUNTIME: Execution took 1981.7187786102295 ms
2022-09-21 16:37:24 INFO  Done!
2022-09-21 16:37:24 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-21 16:37:24 INFO  Running instrumented original pipeline...
2022-09-21 16:37:24 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-21 16:37:24 INFO  ---RUNTIME: Importing and monkey-patching took 5.769014358520508 ms
2022-09-21 16:37:26 INFO  ---RUNTIME: Original pipeline execution took 2158.900737762451 ms (excluding imports and monkey-patching)
2022-09-21 16:37:26 INFO  Starting execution of 1 what-if analyses...
2022-09-21 16:37:26 INFO  Start plan generation for analysis PermutationFeatureImportance...
2022-09-21 16:37:26 INFO  ---RUNTIME: Plan generation took 0.10418891906738281 ms
2022-09-21 16:37:26 INFO  Estimated runtime of original DAG is 1935.4195594787598ms
2022-09-21 16:37:26 WARNING Skipping Multi-Query Optimization (instead, only applying patches)
2022-09-21 16:37:26 INFO  Estimated unoptimised what-if runtime is 11612.517356872559ms
2022-09-21 16:37:26 INFO  ---RUNTIME: Multi-Query Optimization took 4.0760040283203125 ms
2022-09-21 16:37:26 INFO  Executing generated plans
2022-09-21 16:37:42 INFO  ---RUNTIME: Execution took 16457.0152759552 ms
2022-09-21 16:37:42 INFO  Done!
2022-09-21 16:37:42 INFO  # Finished -- repetition 3 of 7 
2022-09-21 16:37:42 INFO  # Optimization benchmark for feature_importance with args [['healthcare', 'slow_loading', 'featurization_0', 'xgboost']] -- repetition 4 of 7
2022-09-21 16:37:42 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-21 16:37:42 INFO  Running instrumented original pipeline...
2022-09-21 16:37:42 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-21 16:37:42 INFO  ---RUNTIME: Importing and monkey-patching took 6.061315536499023 ms
2022-09-21 16:37:44 INFO  ---RUNTIME: Original pipeline execution took 2139.552354812622 ms (excluding imports and monkey-patching)
2022-09-21 16:37:44 INFO  Starting execution of 1 what-if analyses...
2022-09-21 16:37:44 INFO  Start plan generation for analysis PermutationFeatureImportance...
2022-09-21 16:37:44 INFO  ---RUNTIME: Plan generation took 0.12922286987304688 ms
2022-09-21 16:37:44 INFO  Estimated runtime of original DAG is 1909.5356464385986ms
2022-09-21 16:37:44 INFO  Performing Multi-Query Optimization
2022-09-21 16:37:44 INFO  Estimated unoptimized what-if runtime is 11457.213878631592ms
2022-09-21 16:37:44 INFO  Estimated optimised what-if runtime is 1922.7123260498047ms
2022-09-21 16:37:44 INFO  Estimated optimisation runtime saving is 9534.501552581787ms
2022-09-21 16:37:44 INFO  ---RUNTIME: Multi-Query Optimization took 11.113882064819336 ms
2022-09-21 16:37:44 INFO  Executing generated plans
2022-09-21 16:37:49 INFO  ---RUNTIME: Execution took 4730.652332305908 ms
2022-09-21 16:37:49 INFO  Done!
2022-09-21 16:37:49 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-21 16:37:49 INFO  Running instrumented original pipeline...
2022-09-21 16:37:49 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-21 16:37:49 INFO  ---RUNTIME: Importing and monkey-patching took 6.168603897094727 ms
2022-09-21 16:37:51 INFO  ---RUNTIME: Original pipeline execution took 2143.7020301818848 ms (excluding imports and monkey-patching)
2022-09-21 16:37:51 INFO  Starting execution of 1 what-if analyses...
2022-09-21 16:37:51 INFO  Start plan generation for analysis PermutationFeatureImportance...
2022-09-21 16:37:51 INFO  ---RUNTIME: Plan generation took 0.11086463928222656 ms
2022-09-21 16:37:51 INFO  Estimated runtime of original DAG is 1921.2007522583008ms
2022-09-21 16:37:51 WARNING Skipping Multi-Query Optimization (instead, only applying patches)
2022-09-21 16:37:51 INFO  Estimated unoptimised what-if runtime is 11527.204513549805ms
2022-09-21 16:37:51 INFO  ---RUNTIME: Multi-Query Optimization took 4.048585891723633 ms
2022-09-21 16:37:51 INFO  Executing generated plans
2022-09-21 16:38:03 INFO  ---RUNTIME: Execution took 11992.44213104248 ms
2022-09-21 16:38:03 INFO  Done!
2022-09-21 16:38:03 INFO  # Finished -- repetition 4 of 7 
2022-09-21 16:38:03 INFO  # Optimization benchmark for feature_importance with args [['healthcare', 'slow_loading', 'featurization_0', 'xgboost']] -- repetition 5 of 7
2022-09-21 16:38:03 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-21 16:38:03 INFO  Running instrumented original pipeline...
2022-09-21 16:38:03 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-21 16:38:03 INFO  ---RUNTIME: Importing and monkey-patching took 8.18014144897461 ms
2022-09-21 16:38:06 INFO  ---RUNTIME: Original pipeline execution took 3146.1315155029297 ms (excluding imports and monkey-patching)
2022-09-21 16:38:06 INFO  Starting execution of 1 what-if analyses...
2022-09-21 16:38:06 INFO  Start plan generation for analysis PermutationFeatureImportance...
2022-09-21 16:38:06 INFO  ---RUNTIME: Plan generation took 0.1361370086669922 ms
2022-09-21 16:38:06 INFO  Estimated runtime of original DAG is 2895.3816890716553ms
2022-09-21 16:38:06 INFO  Performing Multi-Query Optimization
2022-09-21 16:38:06 INFO  Estimated unoptimized what-if runtime is 17372.29013442993ms
2022-09-21 16:38:06 INFO  Estimated optimised what-if runtime is 2912.689447402954ms
2022-09-21 16:38:06 INFO  Estimated optimisation runtime saving is 14459.600687026978ms
2022-09-21 16:38:06 INFO  ---RUNTIME: Multi-Query Optimization took 12.444734573364258 ms
2022-09-21 16:38:06 INFO  Executing generated plans
2022-09-21 16:38:08 INFO  ---RUNTIME: Execution took 1959.1243267059326 ms
2022-09-21 16:38:08 INFO  Done!
2022-09-21 16:38:08 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-21 16:38:08 INFO  Running instrumented original pipeline...
2022-09-21 16:38:08 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-21 16:38:08 INFO  ---RUNTIME: Importing and monkey-patching took 5.688905715942383 ms
2022-09-21 16:38:11 INFO  ---RUNTIME: Original pipeline execution took 2215.117931365967 ms (excluding imports and monkey-patching)
2022-09-21 16:38:11 INFO  Starting execution of 1 what-if analyses...
2022-09-21 16:38:11 INFO  Start plan generation for analysis PermutationFeatureImportance...
2022-09-21 16:38:11 INFO  ---RUNTIME: Plan generation took 0.10991096496582031 ms
2022-09-21 16:38:11 INFO  Estimated runtime of original DAG is 1982.3939800262451ms
2022-09-21 16:38:11 WARNING Skipping Multi-Query Optimization (instead, only applying patches)
2022-09-21 16:38:11 INFO  Estimated unoptimised what-if runtime is 11894.36388015747ms
2022-09-21 16:38:11 INFO  ---RUNTIME: Multi-Query Optimization took 4.521369934082031 ms
2022-09-21 16:38:11 INFO  Executing generated plans
2022-09-21 16:38:24 INFO  ---RUNTIME: Execution took 12939.115047454834 ms
2022-09-21 16:38:24 INFO  Done!
2022-09-21 16:38:24 INFO  # Finished -- repetition 5 of 7 
2022-09-21 16:38:24 INFO  # Optimization benchmark for feature_importance with args [['healthcare', 'slow_loading', 'featurization_0', 'xgboost']] -- repetition 6 of 7
2022-09-21 16:38:24 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-21 16:38:24 INFO  Running instrumented original pipeline...
2022-09-21 16:38:24 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-21 16:38:24 INFO  ---RUNTIME: Importing and monkey-patching took 5.9719085693359375 ms
2022-09-21 16:38:26 INFO  ---RUNTIME: Original pipeline execution took 2183.037519454956 ms (excluding imports and monkey-patching)
2022-09-21 16:38:26 INFO  Starting execution of 1 what-if analyses...
2022-09-21 16:38:26 INFO  Start plan generation for analysis PermutationFeatureImportance...
2022-09-21 16:38:26 INFO  ---RUNTIME: Plan generation took 0.11086463928222656 ms
2022-09-21 16:38:26 INFO  Estimated runtime of original DAG is 1961.4431858062744ms
2022-09-21 16:38:26 INFO  Performing Multi-Query Optimization
2022-09-21 16:38:26 INFO  Estimated unoptimized what-if runtime is 11768.659114837646ms
2022-09-21 16:38:26 INFO  Estimated optimised what-if runtime is 1971.9831943511963ms
2022-09-21 16:38:26 INFO  Estimated optimisation runtime saving is 9796.67592048645ms
2022-09-21 16:38:26 INFO  ---RUNTIME: Multi-Query Optimization took 10.999441146850586 ms
2022-09-21 16:38:26 INFO  Executing generated plans
2022-09-21 16:38:29 INFO  ---RUNTIME: Execution took 3590.2931690216064 ms
2022-09-21 16:38:29 INFO  Done!
2022-09-21 16:38:29 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-21 16:38:29 INFO  Running instrumented original pipeline...
2022-09-21 16:38:29 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-21 16:38:29 INFO  ---RUNTIME: Importing and monkey-patching took 5.901813507080078 ms
2022-09-21 16:38:32 INFO  ---RUNTIME: Original pipeline execution took 2390.113592147827 ms (excluding imports and monkey-patching)
2022-09-21 16:38:32 INFO  Starting execution of 1 what-if analyses...
2022-09-21 16:38:32 INFO  Start plan generation for analysis PermutationFeatureImportance...
2022-09-21 16:38:32 INFO  ---RUNTIME: Plan generation took 0.10991096496582031 ms
2022-09-21 16:38:32 INFO  Estimated runtime of original DAG is 2159.9326133728027ms
2022-09-21 16:38:32 WARNING Skipping Multi-Query Optimization (instead, only applying patches)
2022-09-21 16:38:32 INFO  Estimated unoptimised what-if runtime is 12959.595680236816ms
2022-09-21 16:38:32 INFO  ---RUNTIME: Multi-Query Optimization took 4.333972930908203 ms
2022-09-21 16:38:32 INFO  Executing generated plans
2022-09-21 16:38:44 INFO  ---RUNTIME: Execution took 12658.742427825928 ms
2022-09-21 16:38:44 INFO  Done!
2022-09-21 16:38:44 INFO  # Finished -- repetition 6 of 7 
2022-09-21 16:38:44 INFO  # Optimization benchmark for feature_importance with args [['healthcare', 'slow_loading', 'featurization_0', 'xgboost']] -- repetition 7 of 7
2022-09-21 16:38:44 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-21 16:38:44 INFO  Running instrumented original pipeline...
2022-09-21 16:38:44 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-21 16:38:44 INFO  ---RUNTIME: Importing and monkey-patching took 6.003856658935547 ms
2022-09-21 16:38:47 INFO  ---RUNTIME: Original pipeline execution took 2187.3459815979004 ms (excluding imports and monkey-patching)
2022-09-21 16:38:47 INFO  Starting execution of 1 what-if analyses...
2022-09-21 16:38:47 INFO  Start plan generation for analysis PermutationFeatureImportance...
2022-09-21 16:38:47 INFO  ---RUNTIME: Plan generation took 0.1125335693359375 ms
2022-09-21 16:38:47 INFO  Estimated runtime of original DAG is 1965.0721549987793ms
2022-09-21 16:38:47 INFO  Performing Multi-Query Optimization
2022-09-21 16:38:47 INFO  Estimated unoptimized what-if runtime is 11790.432929992676ms
2022-09-21 16:38:47 INFO  Estimated optimised what-if runtime is 1975.879192352295ms
2022-09-21 16:38:47 INFO  Estimated optimisation runtime saving is 9814.55373764038ms
2022-09-21 16:38:47 INFO  ---RUNTIME: Multi-Query Optimization took 10.986328125 ms
2022-09-21 16:38:47 INFO  Executing generated plans
2022-09-21 16:38:49 INFO  ---RUNTIME: Execution took 2359.4284057617188 ms
2022-09-21 16:38:49 INFO  Done!
2022-09-21 16:38:49 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-21 16:38:49 INFO  Running instrumented original pipeline...
2022-09-21 16:38:49 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-21 16:38:49 INFO  ---RUNTIME: Importing and monkey-patching took 5.582571029663086 ms
2022-09-21 16:38:51 INFO  ---RUNTIME: Original pipeline execution took 2229.8104763031006 ms (excluding imports and monkey-patching)
2022-09-21 16:38:51 INFO  Starting execution of 1 what-if analyses...
2022-09-21 16:38:51 INFO  Start plan generation for analysis PermutationFeatureImportance...
2022-09-21 16:38:51 INFO  ---RUNTIME: Plan generation took 0.10609626770019531 ms
2022-09-21 16:38:51 INFO  Estimated runtime of original DAG is 2005.4688453674316ms
2022-09-21 16:38:51 WARNING Skipping Multi-Query Optimization (instead, only applying patches)
2022-09-21 16:38:51 INFO  Estimated unoptimised what-if runtime is 12032.81307220459ms
2022-09-21 16:38:51 INFO  ---RUNTIME: Multi-Query Optimization took 4.067659378051758 ms
2022-09-21 16:38:51 INFO  Executing generated plans
2022-09-21 16:39:03 INFO  ---RUNTIME: Execution took 11815.905570983887 ms
2022-09-21 16:39:03 INFO  Done!
2022-09-21 16:39:03 INFO  # Finished -- repetition 7 of 7 
2022-09-21 16:39:03 INFO  # Final results after all repetitions
2022-09-21 16:39:03 INFO     repetition  ... no_opt_what_if_execution_combined_model_training
0           0  ...                                      1091.168880
1           1  ...                                      1730.135918
2           2  ...                                      5623.497248
3           3  ...                                      1211.410522
4           4  ...                                      2294.422626
5           5  ...                                      2077.431202
6           6  ...                                      1138.796806

[7 rows x 26 columns]
taskset -c 0-7 PROTOCOL_BUFFERS_PYTHON_IMPLEMENTATION=python python3.9 benchmarks_end_to_end.py feature_importance healthcare slow_loading featurization_0 neural_network
2022-09-21 16:39:05.584438: W tensorflow/stream_executor/platform/default/dso_loader.cc:64] Could not load dynamic library 'libcudart.so.11.0'; dlerror: libcudart.so.11.0: cannot open shared object file: No such file or directory; LD_LIBRARY_PATH: /home/sgrafbe/mlwhatif/venv/lib/python3.9/site-packages/cv2/../../lib64:
2022-09-21 16:39:05.584483: I tensorflow/stream_executor/cuda/cudart_stub.cc:29] Ignore above cudart dlerror if you do not have a GPU set up on your machine.
2022-09-21 16:39:06 INFO  Patching sys.argv with ['mlwhatif', 'healthcare', 'slow_loading', 'featurization_0', 'neural_network']
2022-09-21 16:39:06 INFO  Running instrumented original pipeline...
2022-09-21 16:39:06 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-21 16:39:07 INFO  ---RUNTIME: Importing and monkey-patching took 96.47464752197266 ms
2022-09-21 16:39:09.031830: W tensorflow/stream_executor/platform/default/dso_loader.cc:64] Could not load dynamic library 'libcuda.so.1'; dlerror: libcuda.so.1: cannot open shared object file: No such file or directory; LD_LIBRARY_PATH: /home/sgrafbe/mlwhatif/venv/lib/python3.9/site-packages/cv2/../../lib64:
2022-09-21 16:39:09.031863: W tensorflow/stream_executor/cuda/cuda_driver.cc:326] failed call to cuInit: UNKNOWN ERROR (303)
2022-09-21 16:39:09.031885: I tensorflow/stream_executor/cuda/cuda_diagnostics.cc:156] kernel driver does not appear to be running on this host (wagyu): /proc/driver/nvidia/version does not exist
2022-09-21 16:39:09.032430: I tensorflow/core/platform/cpu_feature_guard.cc:142] This TensorFlow binary is optimized with oneAPI Deep Neural Network Library (oneDNN) to use the following CPU instructions in performance-critical operations:  AVX2 FMA
To enable them in other operations, rebuild TensorFlow with the appropriate compiler flags.
2022-09-21 16:39:09.098458: I tensorflow/compiler/mlir/mlir_graph_optimization_pass.cc:176] None of the MLIR Optimization Passes are enabled (registered 2)
2022-09-21 16:39:09.110379: I tensorflow/core/platform/profile_utils/cpu_utils.cc:114] CPU Frequency: 2595290000 Hz
2022-09-21 16:39:09 INFO  ---RUNTIME: Original pipeline execution took 2755.915641784668 ms (excluding imports and monkey-patching)
2022-09-21 16:39:09 INFO  Starting execution of 0 what-if analyses...
2022-09-21 16:39:09 INFO  Estimated runtime of original DAG is 2498.9171028137207ms
2022-09-21 16:39:09 INFO  Performing Multi-Query Optimization
2022-09-21 16:39:09 INFO  Estimated unoptimized what-if runtime is 0ms
2022-09-21 16:39:09 INFO  Estimated optimised what-if runtime is 0ms
2022-09-21 16:39:09 INFO  Estimated optimisation runtime saving is 0ms
2022-09-21 16:39:09 INFO  ---RUNTIME: Multi-Query Optimization took 0.4470348358154297 ms
2022-09-21 16:39:09 INFO  Executing generated plans
2022-09-21 16:39:09 INFO  ---RUNTIME: Execution took 0.016689300537109375 ms
2022-09-21 16:39:09 INFO  Done!
2022-09-21 16:39:09 INFO  # Optimization benchmark for feature_importance with args [['healthcare', 'slow_loading', 'featurization_0', 'neural_network']] -- repetition 1 of 7
2022-09-21 16:39:09 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-21 16:39:09 INFO  Running instrumented original pipeline...
2022-09-21 16:39:09 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-21 16:39:09 INFO  ---RUNTIME: Importing and monkey-patching took 5.147457122802734 ms
2022-09-21 16:39:12 INFO  ---RUNTIME: Original pipeline execution took 2352.820634841919 ms (excluding imports and monkey-patching)
2022-09-21 16:39:12 INFO  Starting execution of 1 what-if analyses...
2022-09-21 16:39:12 INFO  Start plan generation for analysis PermutationFeatureImportance...
2022-09-21 16:39:12 INFO  ---RUNTIME: Plan generation took 0.16832351684570312 ms
2022-09-21 16:39:12 INFO  Estimated runtime of original DAG is 2126.445770263672ms
2022-09-21 16:39:12 INFO  Performing Multi-Query Optimization
2022-09-21 16:39:12 INFO  Estimated unoptimized what-if runtime is 12758.674621582031ms
2022-09-21 16:39:12 INFO  Estimated optimised what-if runtime is 2380.1817893981934ms
2022-09-21 16:39:12 INFO  Estimated optimisation runtime saving is 10378.492832183838ms
2022-09-21 16:39:12 INFO  ---RUNTIME: Multi-Query Optimization took 12.235879898071289 ms
2022-09-21 16:39:12 INFO  Executing generated plans
2022-09-21 16:39:14 INFO  ---RUNTIME: Execution took 2360.8133792877197 ms
2022-09-21 16:39:14 INFO  Done!
2022-09-21 16:39:14 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-21 16:39:14 INFO  Running instrumented original pipeline...
2022-09-21 16:39:14 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-21 16:39:14 INFO  ---RUNTIME: Importing and monkey-patching took 6.402015686035156 ms
2022-09-21 16:39:16 INFO  ---RUNTIME: Original pipeline execution took 2410.4795455932617 ms (excluding imports and monkey-patching)
2022-09-21 16:39:16 INFO  Starting execution of 1 what-if analyses...
2022-09-21 16:39:16 INFO  Start plan generation for analysis PermutationFeatureImportance...
2022-09-21 16:39:16 INFO  ---RUNTIME: Plan generation took 0.14925003051757812 ms
2022-09-21 16:39:16 INFO  Estimated runtime of original DAG is 2173.205852508545ms
2022-09-21 16:39:16 WARNING Skipping Multi-Query Optimization (instead, only applying patches)
2022-09-21 16:39:16 INFO  Estimated unoptimised what-if runtime is 13039.23511505127ms
2022-09-21 16:39:16 INFO  ---RUNTIME: Multi-Query Optimization took 4.266262054443359 ms
2022-09-21 16:39:16 INFO  Executing generated plans
2022-09-21 16:39:30 INFO  ---RUNTIME: Execution took 13412.781715393066 ms
2022-09-21 16:39:30 INFO  Done!
2022-09-21 16:39:30 INFO  # Finished -- repetition 1 of 7 
2022-09-21 16:39:30 INFO  # Optimization benchmark for feature_importance with args [['healthcare', 'slow_loading', 'featurization_0', 'neural_network']] -- repetition 2 of 7
2022-09-21 16:39:30 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-21 16:39:30 INFO  Running instrumented original pipeline...
2022-09-21 16:39:30 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-21 16:39:30 INFO  ---RUNTIME: Importing and monkey-patching took 6.463050842285156 ms
2022-09-21 16:39:33 INFO  ---RUNTIME: Original pipeline execution took 2729.1765213012695 ms (excluding imports and monkey-patching)
2022-09-21 16:39:33 INFO  Starting execution of 1 what-if analyses...
2022-09-21 16:39:33 INFO  Start plan generation for analysis PermutationFeatureImportance...
2022-09-21 16:39:33 INFO  ---RUNTIME: Plan generation took 0.110626220703125 ms
2022-09-21 16:39:33 INFO  Estimated runtime of original DAG is 2175.86088180542ms
2022-09-21 16:39:33 INFO  Performing Multi-Query Optimization
2022-09-21 16:39:33 INFO  Estimated unoptimized what-if runtime is 13055.16529083252ms
2022-09-21 16:39:33 INFO  Estimated optimised what-if runtime is 2436.2401962280273ms
2022-09-21 16:39:33 INFO  Estimated optimisation runtime saving is 10618.925094604492ms
2022-09-21 16:39:33 INFO  ---RUNTIME: Multi-Query Optimization took 10.798454284667969 ms
2022-09-21 16:39:33 INFO  Executing generated plans
2022-09-21 16:39:35 INFO  ---RUNTIME: Execution took 2417.0780181884766 ms
2022-09-21 16:39:35 INFO  Done!
2022-09-21 16:39:35 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-21 16:39:35 INFO  Running instrumented original pipeline...
2022-09-21 16:39:35 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-21 16:39:35 INFO  ---RUNTIME: Importing and monkey-patching took 6.047248840332031 ms
2022-09-21 16:39:37 INFO  ---RUNTIME: Original pipeline execution took 2490.0689125061035 ms (excluding imports and monkey-patching)
2022-09-21 16:39:37 INFO  Starting execution of 1 what-if analyses...
2022-09-21 16:39:37 INFO  Start plan generation for analysis PermutationFeatureImportance...
2022-09-21 16:39:37 INFO  ---RUNTIME: Plan generation took 0.19168853759765625 ms
2022-09-21 16:39:37 INFO  Estimated runtime of original DAG is 2255.423069000244ms
2022-09-21 16:39:37 WARNING Skipping Multi-Query Optimization (instead, only applying patches)
2022-09-21 16:39:37 INFO  Estimated unoptimised what-if runtime is 13532.538414001465ms
2022-09-21 16:39:37 INFO  ---RUNTIME: Multi-Query Optimization took 7.296323776245117 ms
2022-09-21 16:39:37 INFO  Executing generated plans
2022-09-21 16:39:51 INFO  ---RUNTIME: Execution took 13349.000930786133 ms
2022-09-21 16:39:51 INFO  Done!
2022-09-21 16:39:51 INFO  # Finished -- repetition 2 of 7 
2022-09-21 16:39:51 INFO  # Optimization benchmark for feature_importance with args [['healthcare', 'slow_loading', 'featurization_0', 'neural_network']] -- repetition 3 of 7
2022-09-21 16:39:51 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-21 16:39:51 INFO  Running instrumented original pipeline...
2022-09-21 16:39:51 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-21 16:39:51 INFO  ---RUNTIME: Importing and monkey-patching took 6.180286407470703 ms
2022-09-21 16:39:53 INFO  ---RUNTIME: Original pipeline execution took 2356.411933898926 ms (excluding imports and monkey-patching)
2022-09-21 16:39:53 INFO  Starting execution of 1 what-if analyses...
2022-09-21 16:39:53 INFO  Start plan generation for analysis PermutationFeatureImportance...
2022-09-21 16:39:53 INFO  ---RUNTIME: Plan generation took 0.12564659118652344 ms
2022-09-21 16:39:53 INFO  Estimated runtime of original DAG is 2124.0973472595215ms
2022-09-21 16:39:53 INFO  Performing Multi-Query Optimization
2022-09-21 16:39:53 INFO  Estimated unoptimized what-if runtime is 12744.584083557129ms
2022-09-21 16:39:53 INFO  Estimated optimised what-if runtime is 2401.02219581604ms
2022-09-21 16:39:53 INFO  Estimated optimisation runtime saving is 10343.561887741089ms
2022-09-21 16:39:53 INFO  ---RUNTIME: Multi-Query Optimization took 10.783195495605469 ms
2022-09-21 16:39:53 INFO  Executing generated plans
2022-09-21 16:39:56 INFO  ---RUNTIME: Execution took 2587.6355171203613 ms
2022-09-21 16:39:56 INFO  Done!
2022-09-21 16:39:56 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-21 16:39:56 INFO  Running instrumented original pipeline...
2022-09-21 16:39:56 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-21 16:39:56 INFO  ---RUNTIME: Importing and monkey-patching took 5.983114242553711 ms
2022-09-21 16:39:58 INFO  ---RUNTIME: Original pipeline execution took 2400.3279209136963 ms (excluding imports and monkey-patching)
2022-09-21 16:39:58 INFO  Starting execution of 1 what-if analyses...
2022-09-21 16:39:58 INFO  Start plan generation for analysis PermutationFeatureImportance...
2022-09-21 16:39:58 INFO  ---RUNTIME: Plan generation took 0.10275840759277344 ms
2022-09-21 16:39:58 INFO  Estimated runtime of original DAG is 2172.433376312256ms
2022-09-21 16:39:58 WARNING Skipping Multi-Query Optimization (instead, only applying patches)
2022-09-21 16:39:58 INFO  Estimated unoptimised what-if runtime is 13034.600257873535ms
2022-09-21 16:39:58 INFO  ---RUNTIME: Multi-Query Optimization took 4.266023635864258 ms
2022-09-21 16:39:58 INFO  Executing generated plans
2022-09-21 16:40:12 INFO  ---RUNTIME: Execution took 13362.886905670166 ms
2022-09-21 16:40:12 INFO  Done!
2022-09-21 16:40:12 INFO  # Finished -- repetition 3 of 7 
2022-09-21 16:40:12 INFO  # Optimization benchmark for feature_importance with args [['healthcare', 'slow_loading', 'featurization_0', 'neural_network']] -- repetition 4 of 7
2022-09-21 16:40:12 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-21 16:40:12 INFO  Running instrumented original pipeline...
2022-09-21 16:40:12 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-21 16:40:12 INFO  ---RUNTIME: Importing and monkey-patching took 6.039142608642578 ms
2022-09-21 16:40:14 INFO  ---RUNTIME: Original pipeline execution took 2380.692481994629 ms (excluding imports and monkey-patching)
2022-09-21 16:40:14 INFO  Starting execution of 1 what-if analyses...
2022-09-21 16:40:14 INFO  Start plan generation for analysis PermutationFeatureImportance...
2022-09-21 16:40:14 INFO  ---RUNTIME: Plan generation took 0.10800361633300781 ms
2022-09-21 16:40:14 INFO  Estimated runtime of original DAG is 2150.883197784424ms
2022-09-21 16:40:14 INFO  Performing Multi-Query Optimization
2022-09-21 16:40:14 INFO  Estimated unoptimized what-if runtime is 12905.299186706543ms
2022-09-21 16:40:14 INFO  Estimated optimised what-if runtime is 2403.404712677002ms
2022-09-21 16:40:14 INFO  Estimated optimisation runtime saving is 10501.894474029541ms
2022-09-21 16:40:14 INFO  ---RUNTIME: Multi-Query Optimization took 11.899948120117188 ms
2022-09-21 16:40:14 INFO  Executing generated plans
2022-09-21 16:40:16 INFO  ---RUNTIME: Execution took 2292.638063430786 ms
2022-09-21 16:40:16 INFO  Done!
2022-09-21 16:40:16 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-21 16:40:16 INFO  Running instrumented original pipeline...
2022-09-21 16:40:16 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-21 16:40:16 INFO  ---RUNTIME: Importing and monkey-patching took 5.883693695068359 ms
2022-09-21 16:40:19 INFO  ---RUNTIME: Original pipeline execution took 2375.342845916748 ms (excluding imports and monkey-patching)
2022-09-21 16:40:19 INFO  Starting execution of 1 what-if analyses...
2022-09-21 16:40:19 INFO  Start plan generation for analysis PermutationFeatureImportance...
2022-09-21 16:40:19 INFO  ---RUNTIME: Plan generation took 0.12636184692382812 ms
2022-09-21 16:40:19 INFO  Estimated runtime of original DAG is 2144.5865631103516ms
2022-09-21 16:40:19 WARNING Skipping Multi-Query Optimization (instead, only applying patches)
2022-09-21 16:40:19 INFO  Estimated unoptimised what-if runtime is 12867.51937866211ms
2022-09-21 16:40:19 INFO  ---RUNTIME: Multi-Query Optimization took 4.139184951782227 ms
2022-09-21 16:40:19 INFO  Executing generated plans
2022-09-21 16:40:32 INFO  ---RUNTIME: Execution took 13194.190502166748 ms
2022-09-21 16:40:32 INFO  Done!
2022-09-21 16:40:32 INFO  # Finished -- repetition 4 of 7 
2022-09-21 16:40:32 INFO  # Optimization benchmark for feature_importance with args [['healthcare', 'slow_loading', 'featurization_0', 'neural_network']] -- repetition 5 of 7
2022-09-21 16:40:32 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-21 16:40:32 INFO  Running instrumented original pipeline...
2022-09-21 16:40:32 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-21 16:40:32 INFO  ---RUNTIME: Importing and monkey-patching took 6.20579719543457 ms
2022-09-21 16:40:35 INFO  ---RUNTIME: Original pipeline execution took 2763.676643371582 ms (excluding imports and monkey-patching)
2022-09-21 16:40:35 INFO  Starting execution of 1 what-if analyses...
2022-09-21 16:40:35 INFO  Start plan generation for analysis PermutationFeatureImportance...
2022-09-21 16:40:35 INFO  ---RUNTIME: Plan generation took 0.10776519775390625 ms
2022-09-21 16:40:35 INFO  Estimated runtime of original DAG is 2534.011125564575ms
2022-09-21 16:40:35 INFO  Performing Multi-Query Optimization
2022-09-21 16:40:35 INFO  Estimated unoptimized what-if runtime is 15204.066753387451ms
2022-09-21 16:40:35 INFO  Estimated optimised what-if runtime is 2793.964385986328ms
2022-09-21 16:40:35 INFO  Estimated optimisation runtime saving is 12410.102367401123ms
2022-09-21 16:40:35 INFO  ---RUNTIME: Multi-Query Optimization took 12.39013671875 ms
2022-09-21 16:40:35 INFO  Executing generated plans
2022-09-21 16:40:37 INFO  ---RUNTIME: Execution took 2324.0156173706055 ms
2022-09-21 16:40:37 INFO  Done!
2022-09-21 16:40:37 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-21 16:40:37 INFO  Running instrumented original pipeline...
2022-09-21 16:40:37 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-21 16:40:37 INFO  ---RUNTIME: Importing and monkey-patching took 6.008625030517578 ms
2022-09-21 16:40:39 INFO  ---RUNTIME: Original pipeline execution took 2395.4057693481445 ms (excluding imports and monkey-patching)
2022-09-21 16:40:39 INFO  Starting execution of 1 what-if analyses...
2022-09-21 16:40:39 INFO  Start plan generation for analysis PermutationFeatureImportance...
2022-09-21 16:40:39 INFO  ---RUNTIME: Plan generation took 0.1480579376220703 ms
2022-09-21 16:40:39 INFO  Estimated runtime of original DAG is 2164.5355224609375ms
2022-09-21 16:40:39 WARNING Skipping Multi-Query Optimization (instead, only applying patches)
2022-09-21 16:40:39 INFO  Estimated unoptimised what-if runtime is 12987.213134765625ms
2022-09-21 16:40:39 INFO  ---RUNTIME: Multi-Query Optimization took 4.292964935302734 ms
2022-09-21 16:40:39 INFO  Executing generated plans
2022-09-21 16:40:53 INFO  ---RUNTIME: Execution took 13615.016222000122 ms
2022-09-21 16:40:53 INFO  Done!
2022-09-21 16:40:53 INFO  # Finished -- repetition 5 of 7 
2022-09-21 16:40:53 INFO  # Optimization benchmark for feature_importance with args [['healthcare', 'slow_loading', 'featurization_0', 'neural_network']] -- repetition 6 of 7
2022-09-21 16:40:53 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-21 16:40:53 INFO  Running instrumented original pipeline...
2022-09-21 16:40:53 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-21 16:40:53 INFO  ---RUNTIME: Importing and monkey-patching took 5.895376205444336 ms
2022-09-21 16:40:55 INFO  ---RUNTIME: Original pipeline execution took 2370.1162338256836 ms (excluding imports and monkey-patching)
2022-09-21 16:40:55 INFO  Starting execution of 1 what-if analyses...
2022-09-21 16:40:55 INFO  Start plan generation for analysis PermutationFeatureImportance...
2022-09-21 16:40:55 INFO  ---RUNTIME: Plan generation took 0.1418590545654297 ms
2022-09-21 16:40:55 INFO  Estimated runtime of original DAG is 2141.3824558258057ms
2022-09-21 16:40:55 INFO  Performing Multi-Query Optimization
2022-09-21 16:40:55 INFO  Estimated unoptimized what-if runtime is 12848.294734954834ms
2022-09-21 16:40:55 INFO  Estimated optimised what-if runtime is 2403.9969444274902ms
2022-09-21 16:40:55 INFO  Estimated optimisation runtime saving is 10444.297790527344ms
2022-09-21 16:40:55 INFO  ---RUNTIME: Multi-Query Optimization took 10.750293731689453 ms
2022-09-21 16:40:55 INFO  Executing generated plans
2022-09-21 16:40:58 INFO  ---RUNTIME: Execution took 2302.226781845093 ms
2022-09-21 16:40:58 INFO  Done!
2022-09-21 16:40:58 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-21 16:40:58 INFO  Running instrumented original pipeline...
2022-09-21 16:40:58 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-21 16:40:58 INFO  ---RUNTIME: Importing and monkey-patching took 5.919456481933594 ms
2022-09-21 16:41:00 INFO  ---RUNTIME: Original pipeline execution took 2339.5848274230957 ms (excluding imports and monkey-patching)
2022-09-21 16:41:00 INFO  Starting execution of 1 what-if analyses...
2022-09-21 16:41:00 INFO  Start plan generation for analysis PermutationFeatureImportance...
2022-09-21 16:41:00 INFO  ---RUNTIME: Plan generation took 0.10800361633300781 ms
2022-09-21 16:41:00 INFO  Estimated runtime of original DAG is 2110.1577281951904ms
2022-09-21 16:41:00 WARNING Skipping Multi-Query Optimization (instead, only applying patches)
2022-09-21 16:41:00 INFO  Estimated unoptimised what-if runtime is 12660.946369171143ms
2022-09-21 16:41:00 INFO  ---RUNTIME: Multi-Query Optimization took 4.0740966796875 ms
2022-09-21 16:41:00 INFO  Executing generated plans
2022-09-21 16:41:13 INFO  ---RUNTIME: Execution took 13320.931911468506 ms
2022-09-21 16:41:13 INFO  Done!
2022-09-21 16:41:13 INFO  # Finished -- repetition 6 of 7 
2022-09-21 16:41:13 INFO  # Optimization benchmark for feature_importance with args [['healthcare', 'slow_loading', 'featurization_0', 'neural_network']] -- repetition 7 of 7
2022-09-21 16:41:13 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-21 16:41:13 INFO  Running instrumented original pipeline...
2022-09-21 16:41:13 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-21 16:41:13 INFO  ---RUNTIME: Importing and monkey-patching took 6.0272216796875 ms
2022-09-21 16:41:16 INFO  ---RUNTIME: Original pipeline execution took 2369.1911697387695 ms (excluding imports and monkey-patching)
2022-09-21 16:41:16 INFO  Starting execution of 1 what-if analyses...
2022-09-21 16:41:16 INFO  Start plan generation for analysis PermutationFeatureImportance...
2022-09-21 16:41:16 INFO  ---RUNTIME: Plan generation took 0.11754035949707031 ms
2022-09-21 16:41:16 INFO  Estimated runtime of original DAG is 2139.686107635498ms
2022-09-21 16:41:16 INFO  Performing Multi-Query Optimization
2022-09-21 16:41:16 INFO  Estimated unoptimized what-if runtime is 12838.116645812988ms
2022-09-21 16:41:16 INFO  Estimated optimised what-if runtime is 2396.940231323242ms
2022-09-21 16:41:16 INFO  Estimated optimisation runtime saving is 10441.176414489746ms
2022-09-21 16:41:16 INFO  ---RUNTIME: Multi-Query Optimization took 10.687589645385742 ms
2022-09-21 16:41:16 INFO  Executing generated plans
2022-09-21 16:41:18 INFO  ---RUNTIME: Execution took 2619.3907260894775 ms
2022-09-21 16:41:18 INFO  Done!
2022-09-21 16:41:18 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-21 16:41:18 INFO  Running instrumented original pipeline...
2022-09-21 16:41:18 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-21 16:41:18 INFO  ---RUNTIME: Importing and monkey-patching took 5.882024765014648 ms
2022-09-21 16:41:21 INFO  ---RUNTIME: Original pipeline execution took 2364.0353679656982 ms (excluding imports and monkey-patching)
2022-09-21 16:41:21 INFO  Starting execution of 1 what-if analyses...
2022-09-21 16:41:21 INFO  Start plan generation for analysis PermutationFeatureImportance...
2022-09-21 16:41:21 INFO  ---RUNTIME: Plan generation took 0.10633468627929688 ms
2022-09-21 16:41:21 INFO  Estimated runtime of original DAG is 2133.0721378326416ms
2022-09-21 16:41:21 WARNING Skipping Multi-Query Optimization (instead, only applying patches)
2022-09-21 16:41:21 INFO  Estimated unoptimised what-if runtime is 12798.43282699585ms
2022-09-21 16:41:21 INFO  ---RUNTIME: Multi-Query Optimization took 4.113197326660156 ms
2022-09-21 16:41:21 INFO  Executing generated plans
2022-09-21 16:41:34 INFO  ---RUNTIME: Execution took 13205.02781867981 ms
2022-09-21 16:41:34 INFO  Done!
2022-09-21 16:41:34 INFO  # Finished -- repetition 7 of 7 
2022-09-21 16:41:34 INFO  # Final results after all repetitions
2022-09-21 16:41:34 INFO     repetition  ... no_opt_what_if_execution_combined_model_training
0           0  ...                                      2105.240345
1           1  ...                                      2321.955442
2           2  ...                                      1980.659723
3           3  ...                                      2294.260025
4           4  ...                                      1987.029314
5           5  ...                                      2010.276556
6           6  ...                                      1967.074633

[7 rows x 26 columns]
taskset -c 0-7 PROTOCOL_BUFFERS_PYTHON_IMPLEMENTATION=python python3.9 benchmarks_end_to_end.py feature_importance healthcare slow_loading featurization_1 logistic_regression
2022-09-21 16:41:36.678882: W tensorflow/stream_executor/platform/default/dso_loader.cc:64] Could not load dynamic library 'libcudart.so.11.0'; dlerror: libcudart.so.11.0: cannot open shared object file: No such file or directory; LD_LIBRARY_PATH: /home/sgrafbe/mlwhatif/venv/lib/python3.9/site-packages/cv2/../../lib64:
2022-09-21 16:41:36.678927: I tensorflow/stream_executor/cuda/cudart_stub.cc:29] Ignore above cudart dlerror if you do not have a GPU set up on your machine.
2022-09-21 16:41:37 INFO  Patching sys.argv with ['mlwhatif', 'healthcare', 'slow_loading', 'featurization_1', 'logistic_regression']
2022-09-21 16:41:37 INFO  Running instrumented original pipeline...
2022-09-21 16:41:37 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-21 16:41:38 INFO  ---RUNTIME: Importing and monkey-patching took 95.20888328552246 ms
2022-09-21 16:41:40 INFO  ---RUNTIME: Original pipeline execution took 2089.332103729248 ms (excluding imports and monkey-patching)
2022-09-21 16:41:40 INFO  Starting execution of 0 what-if analyses...
2022-09-21 16:41:40 INFO  Estimated runtime of original DAG is 1799.5455265045166ms
2022-09-21 16:41:40 INFO  Performing Multi-Query Optimization
2022-09-21 16:41:40 INFO  Estimated unoptimized what-if runtime is 0ms
2022-09-21 16:41:40 INFO  Estimated optimised what-if runtime is 0ms
2022-09-21 16:41:40 INFO  Estimated optimisation runtime saving is 0ms
2022-09-21 16:41:40 INFO  ---RUNTIME: Multi-Query Optimization took 0.44798851013183594 ms
2022-09-21 16:41:40 INFO  Executing generated plans
2022-09-21 16:41:40 INFO  ---RUNTIME: Execution took 0.023126602172851562 ms
2022-09-21 16:41:40 INFO  Done!
2022-09-21 16:41:40 INFO  # Optimization benchmark for feature_importance with args [['healthcare', 'slow_loading', 'featurization_1', 'logistic_regression']] -- repetition 1 of 7
2022-09-21 16:41:40 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-21 16:41:40 INFO  Running instrumented original pipeline...
2022-09-21 16:41:40 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-21 16:41:40 INFO  ---RUNTIME: Importing and monkey-patching took 5.140066146850586 ms
2022-09-21 16:41:42 INFO  ---RUNTIME: Original pipeline execution took 1987.699031829834 ms (excluding imports and monkey-patching)
2022-09-21 16:41:42 INFO  Starting execution of 1 what-if analyses...
2022-09-21 16:41:42 INFO  Start plan generation for analysis PermutationFeatureImportance...
2022-09-21 16:41:42 INFO  ---RUNTIME: Plan generation took 0.18310546875 ms
2022-09-21 16:41:42 INFO  Estimated runtime of original DAG is 1739.6636009216309ms
2022-09-21 16:41:42 INFO  Performing Multi-Query Optimization
2022-09-21 16:41:42 INFO  Estimated unoptimized what-if runtime is 10437.981605529785ms
2022-09-21 16:41:42 INFO  Estimated optimised what-if runtime is 1748.4040260314941ms
2022-09-21 16:41:42 INFO  Estimated optimisation runtime saving is 8689.577579498291ms
2022-09-21 16:41:42 INFO  ---RUNTIME: Multi-Query Optimization took 11.868476867675781 ms
2022-09-21 16:41:42 INFO  Executing generated plans
2022-09-21 16:41:43 INFO  ---RUNTIME: Execution took 1759.214162826538 ms
2022-09-21 16:41:43 INFO  Done!
2022-09-21 16:41:43 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-21 16:41:43 INFO  Running instrumented original pipeline...
2022-09-21 16:41:44 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-21 16:41:44 INFO  ---RUNTIME: Importing and monkey-patching took 5.781650543212891 ms
2022-09-21 16:41:46 INFO  ---RUNTIME: Original pipeline execution took 2163.1696224212646 ms (excluding imports and monkey-patching)
2022-09-21 16:41:46 INFO  Starting execution of 1 what-if analyses...
2022-09-21 16:41:46 INFO  Start plan generation for analysis PermutationFeatureImportance...
2022-09-21 16:41:46 INFO  ---RUNTIME: Plan generation took 0.18405914306640625 ms
2022-09-21 16:41:46 INFO  Estimated runtime of original DAG is 1741.5144443511963ms
2022-09-21 16:41:46 WARNING Skipping Multi-Query Optimization (instead, only applying patches)
2022-09-21 16:41:46 INFO  Estimated unoptimised what-if runtime is 10449.086666107178ms
2022-09-21 16:41:46 INFO  ---RUNTIME: Multi-Query Optimization took 4.34112548828125 ms
2022-09-21 16:41:46 INFO  Executing generated plans
2022-09-21 16:41:56 INFO  ---RUNTIME: Execution took 10563.026905059814 ms
2022-09-21 16:41:56 INFO  Done!
2022-09-21 16:41:56 INFO  # Finished -- repetition 1 of 7 
2022-09-21 16:41:56 INFO  # Optimization benchmark for feature_importance with args [['healthcare', 'slow_loading', 'featurization_1', 'logistic_regression']] -- repetition 2 of 7
2022-09-21 16:41:56 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-21 16:41:56 INFO  Running instrumented original pipeline...
2022-09-21 16:41:56 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-21 16:41:56 INFO  ---RUNTIME: Importing and monkey-patching took 6.014347076416016 ms
2022-09-21 16:41:58 INFO  ---RUNTIME: Original pipeline execution took 1978.0712127685547 ms (excluding imports and monkey-patching)
2022-09-21 16:41:58 INFO  Starting execution of 1 what-if analyses...
2022-09-21 16:41:58 INFO  Start plan generation for analysis PermutationFeatureImportance...
2022-09-21 16:41:58 INFO  ---RUNTIME: Plan generation took 0.12564659118652344 ms
2022-09-21 16:41:58 INFO  Estimated runtime of original DAG is 1727.7309894561768ms
2022-09-21 16:41:58 INFO  Performing Multi-Query Optimization
2022-09-21 16:41:58 INFO  Estimated unoptimized what-if runtime is 10366.38593673706ms
2022-09-21 16:41:58 INFO  Estimated optimised what-if runtime is 1736.3522052764893ms
2022-09-21 16:41:58 INFO  Estimated optimisation runtime saving is 8630.033731460571ms
2022-09-21 16:41:58 INFO  ---RUNTIME: Multi-Query Optimization took 11.459112167358398 ms
2022-09-21 16:41:58 INFO  Executing generated plans
2022-09-21 16:42:00 INFO  ---RUNTIME: Execution took 1817.2693252563477 ms
2022-09-21 16:42:00 INFO  Done!
2022-09-21 16:42:00 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-21 16:42:00 INFO  Running instrumented original pipeline...
2022-09-21 16:42:00 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-21 16:42:00 INFO  ---RUNTIME: Importing and monkey-patching took 6.084680557250977 ms
2022-09-21 16:42:02 INFO  ---RUNTIME: Original pipeline execution took 2004.706859588623 ms (excluding imports and monkey-patching)
2022-09-21 16:42:02 INFO  Starting execution of 1 what-if analyses...
2022-09-21 16:42:02 INFO  Start plan generation for analysis PermutationFeatureImportance...
2022-09-21 16:42:02 INFO  ---RUNTIME: Plan generation took 0.11897087097167969 ms
2022-09-21 16:42:02 INFO  Estimated runtime of original DAG is 1753.8187503814697ms
2022-09-21 16:42:02 WARNING Skipping Multi-Query Optimization (instead, only applying patches)
2022-09-21 16:42:02 INFO  Estimated unoptimised what-if runtime is 10522.912502288818ms
2022-09-21 16:42:02 INFO  ---RUNTIME: Multi-Query Optimization took 4.423856735229492 ms
2022-09-21 16:42:02 INFO  Executing generated plans
2022-09-21 16:42:13 INFO  ---RUNTIME: Execution took 10531.681776046753 ms
2022-09-21 16:42:13 INFO  Done!
2022-09-21 16:42:13 INFO  # Finished -- repetition 2 of 7 
2022-09-21 16:42:13 INFO  # Optimization benchmark for feature_importance with args [['healthcare', 'slow_loading', 'featurization_1', 'logistic_regression']] -- repetition 3 of 7
2022-09-21 16:42:13 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-21 16:42:13 INFO  Running instrumented original pipeline...
2022-09-21 16:42:13 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-21 16:42:13 INFO  ---RUNTIME: Importing and monkey-patching took 6.3953399658203125 ms
2022-09-21 16:42:15 INFO  ---RUNTIME: Original pipeline execution took 2004.3613910675049 ms (excluding imports and monkey-patching)
2022-09-21 16:42:15 INFO  Starting execution of 1 what-if analyses...
2022-09-21 16:42:15 INFO  Start plan generation for analysis PermutationFeatureImportance...
2022-09-21 16:42:15 INFO  ---RUNTIME: Plan generation took 0.14448165893554688 ms
2022-09-21 16:42:15 INFO  Estimated runtime of original DAG is 1750.7739067077637ms
2022-09-21 16:42:15 INFO  Performing Multi-Query Optimization
2022-09-21 16:42:15 INFO  Estimated unoptimized what-if runtime is 10504.643440246582ms
2022-09-21 16:42:15 INFO  Estimated optimised what-if runtime is 1759.725570678711ms
2022-09-21 16:42:15 INFO  Estimated optimisation runtime saving is 8744.917869567871ms
2022-09-21 16:42:15 INFO  ---RUNTIME: Multi-Query Optimization took 11.49129867553711 ms
2022-09-21 16:42:15 INFO  Executing generated plans
2022-09-21 16:42:16 INFO  ---RUNTIME: Execution took 1787.6272201538086 ms
2022-09-21 16:42:16 INFO  Done!
2022-09-21 16:42:16 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-21 16:42:16 INFO  Running instrumented original pipeline...
2022-09-21 16:42:16 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-21 16:42:16 INFO  ---RUNTIME: Importing and monkey-patching took 5.628108978271484 ms
2022-09-21 16:42:18 INFO  ---RUNTIME: Original pipeline execution took 2035.0322723388672 ms (excluding imports and monkey-patching)
2022-09-21 16:42:18 INFO  Starting execution of 1 what-if analyses...
2022-09-21 16:42:18 INFO  Start plan generation for analysis PermutationFeatureImportance...
2022-09-21 16:42:18 INFO  ---RUNTIME: Plan generation took 0.10967254638671875 ms
2022-09-21 16:42:18 INFO  Estimated runtime of original DAG is 1783.9434146881104ms
2022-09-21 16:42:18 WARNING Skipping Multi-Query Optimization (instead, only applying patches)
2022-09-21 16:42:18 INFO  Estimated unoptimised what-if runtime is 10703.660488128662ms
2022-09-21 16:42:18 INFO  ---RUNTIME: Multi-Query Optimization took 4.441022872924805 ms
2022-09-21 16:42:18 INFO  Executing generated plans
2022-09-21 16:42:29 INFO  ---RUNTIME: Execution took 10822.828769683838 ms
2022-09-21 16:42:29 INFO  Done!
2022-09-21 16:42:29 INFO  # Finished -- repetition 3 of 7 
2022-09-21 16:42:29 INFO  # Optimization benchmark for feature_importance with args [['healthcare', 'slow_loading', 'featurization_1', 'logistic_regression']] -- repetition 4 of 7
2022-09-21 16:42:29 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-21 16:42:29 INFO  Running instrumented original pipeline...
2022-09-21 16:42:29 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-21 16:42:29 INFO  ---RUNTIME: Importing and monkey-patching took 5.755901336669922 ms
2022-09-21 16:42:31 INFO  ---RUNTIME: Original pipeline execution took 1983.7040901184082 ms (excluding imports and monkey-patching)
2022-09-21 16:42:31 INFO  Starting execution of 1 what-if analyses...
2022-09-21 16:42:31 INFO  Start plan generation for analysis PermutationFeatureImportance...
2022-09-21 16:42:31 INFO  ---RUNTIME: Plan generation took 0.3151893615722656 ms
2022-09-21 16:42:31 INFO  Estimated runtime of original DAG is 1732.8872680664062ms
2022-09-21 16:42:31 INFO  Performing Multi-Query Optimization
2022-09-21 16:42:31 INFO  Estimated unoptimized what-if runtime is 10397.323608398438ms
2022-09-21 16:42:31 INFO  Estimated optimised what-if runtime is 1741.6388988494873ms
2022-09-21 16:42:31 INFO  Estimated optimisation runtime saving is 8655.68470954895ms
2022-09-21 16:42:31 INFO  ---RUNTIME: Multi-Query Optimization took 11.183023452758789 ms
2022-09-21 16:42:31 INFO  Executing generated plans
2022-09-21 16:42:33 INFO  ---RUNTIME: Execution took 1794.9373722076416 ms
2022-09-21 16:42:33 INFO  Done!
2022-09-21 16:42:33 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-21 16:42:33 INFO  Running instrumented original pipeline...
2022-09-21 16:42:33 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-21 16:42:33 INFO  ---RUNTIME: Importing and monkey-patching took 6.070852279663086 ms
2022-09-21 16:42:35 INFO  ---RUNTIME: Original pipeline execution took 2001.1610984802246 ms (excluding imports and monkey-patching)
2022-09-21 16:42:35 INFO  Starting execution of 1 what-if analyses...
2022-09-21 16:42:35 INFO  Start plan generation for analysis PermutationFeatureImportance...
2022-09-21 16:42:35 INFO  ---RUNTIME: Plan generation took 0.102996826171875 ms
2022-09-21 16:42:35 INFO  Estimated runtime of original DAG is 1750.0481605529785ms
2022-09-21 16:42:35 WARNING Skipping Multi-Query Optimization (instead, only applying patches)
2022-09-21 16:42:35 INFO  Estimated unoptimised what-if runtime is 10500.288963317871ms
2022-09-21 16:42:35 INFO  ---RUNTIME: Multi-Query Optimization took 4.368305206298828 ms
2022-09-21 16:42:35 INFO  Executing generated plans
2022-09-21 16:42:46 INFO  ---RUNTIME: Execution took 10572.201013565063 ms
2022-09-21 16:42:46 INFO  Done!
2022-09-21 16:42:46 INFO  # Finished -- repetition 4 of 7 
2022-09-21 16:42:46 INFO  # Optimization benchmark for feature_importance with args [['healthcare', 'slow_loading', 'featurization_1', 'logistic_regression']] -- repetition 5 of 7
2022-09-21 16:42:46 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-21 16:42:46 INFO  Running instrumented original pipeline...
2022-09-21 16:42:46 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-21 16:42:46 INFO  ---RUNTIME: Importing and monkey-patching took 5.605220794677734 ms
2022-09-21 16:42:48 INFO  ---RUNTIME: Original pipeline execution took 2012.3884677886963 ms (excluding imports and monkey-patching)
2022-09-21 16:42:48 INFO  Starting execution of 1 what-if analyses...
2022-09-21 16:42:48 INFO  Start plan generation for analysis PermutationFeatureImportance...
2022-09-21 16:42:48 INFO  ---RUNTIME: Plan generation took 0.09870529174804688 ms
2022-09-21 16:42:48 INFO  Estimated runtime of original DAG is 1762.885332107544ms
2022-09-21 16:42:48 INFO  Performing Multi-Query Optimization
2022-09-21 16:42:48 INFO  Estimated unoptimized what-if runtime is 10577.311992645264ms
2022-09-21 16:42:48 INFO  Estimated optimised what-if runtime is 1771.5449333190918ms
2022-09-21 16:42:48 INFO  Estimated optimisation runtime saving is 8805.767059326172ms
2022-09-21 16:42:48 INFO  ---RUNTIME: Multi-Query Optimization took 11.64555549621582 ms
2022-09-21 16:42:48 INFO  Executing generated plans
2022-09-21 16:42:49 INFO  ---RUNTIME: Execution took 1775.583267211914 ms
2022-09-21 16:42:49 INFO  Done!
2022-09-21 16:42:49 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-21 16:42:49 INFO  Running instrumented original pipeline...
2022-09-21 16:42:49 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-21 16:42:49 INFO  ---RUNTIME: Importing and monkey-patching took 5.534648895263672 ms
2022-09-21 16:42:51 INFO  ---RUNTIME: Original pipeline execution took 1988.4028434753418 ms (excluding imports and monkey-patching)
2022-09-21 16:42:51 INFO  Starting execution of 1 what-if analyses...
2022-09-21 16:42:51 INFO  Start plan generation for analysis PermutationFeatureImportance...
2022-09-21 16:42:51 INFO  ---RUNTIME: Plan generation took 0.13208389282226562 ms
2022-09-21 16:42:51 INFO  Estimated runtime of original DAG is 1739.5734786987305ms
2022-09-21 16:42:51 WARNING Skipping Multi-Query Optimization (instead, only applying patches)
2022-09-21 16:42:51 INFO  Estimated unoptimised what-if runtime is 10437.440872192383ms
2022-09-21 16:42:51 INFO  ---RUNTIME: Multi-Query Optimization took 4.385709762573242 ms
2022-09-21 16:42:51 INFO  Executing generated plans
2022-09-21 16:43:02 INFO  ---RUNTIME: Execution took 10626.777172088623 ms
2022-09-21 16:43:02 INFO  Done!
2022-09-21 16:43:02 INFO  # Finished -- repetition 5 of 7 
2022-09-21 16:43:02 INFO  # Optimization benchmark for feature_importance with args [['healthcare', 'slow_loading', 'featurization_1', 'logistic_regression']] -- repetition 6 of 7
2022-09-21 16:43:02 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-21 16:43:02 INFO  Running instrumented original pipeline...
2022-09-21 16:43:02 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-21 16:43:02 INFO  ---RUNTIME: Importing and monkey-patching took 5.707979202270508 ms
2022-09-21 16:43:04 INFO  ---RUNTIME: Original pipeline execution took 1991.6319847106934 ms (excluding imports and monkey-patching)
2022-09-21 16:43:04 INFO  Starting execution of 1 what-if analyses...
2022-09-21 16:43:04 INFO  Start plan generation for analysis PermutationFeatureImportance...
2022-09-21 16:43:04 INFO  ---RUNTIME: Plan generation took 0.09989738464355469 ms
2022-09-21 16:43:04 INFO  Estimated runtime of original DAG is 1740.8008575439453ms
2022-09-21 16:43:04 INFO  Performing Multi-Query Optimization
2022-09-21 16:43:04 INFO  Estimated unoptimized what-if runtime is 10444.805145263672ms
2022-09-21 16:43:04 INFO  Estimated optimised what-if runtime is 1749.6857643127441ms
2022-09-21 16:43:04 INFO  Estimated optimisation runtime saving is 8695.119380950928ms
2022-09-21 16:43:04 INFO  ---RUNTIME: Multi-Query Optimization took 11.421918869018555 ms
2022-09-21 16:43:04 INFO  Executing generated plans
2022-09-21 16:43:06 INFO  ---RUNTIME: Execution took 1795.4981327056885 ms
2022-09-21 16:43:06 INFO  Done!
2022-09-21 16:43:06 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-21 16:43:06 INFO  Running instrumented original pipeline...
2022-09-21 16:43:06 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-21 16:43:06 INFO  ---RUNTIME: Importing and monkey-patching took 5.494594573974609 ms
2022-09-21 16:43:08 INFO  ---RUNTIME: Original pipeline execution took 1982.9990863800049 ms (excluding imports and monkey-patching)
2022-09-21 16:43:08 INFO  Starting execution of 1 what-if analyses...
2022-09-21 16:43:08 INFO  Start plan generation for analysis PermutationFeatureImportance...
2022-09-21 16:43:08 INFO  ---RUNTIME: Plan generation took 0.09679794311523438 ms
2022-09-21 16:43:08 INFO  Estimated runtime of original DAG is 1733.41703414917ms
2022-09-21 16:43:08 WARNING Skipping Multi-Query Optimization (instead, only applying patches)
2022-09-21 16:43:08 INFO  Estimated unoptimised what-if runtime is 10400.50220489502ms
2022-09-21 16:43:08 INFO  ---RUNTIME: Multi-Query Optimization took 205.80244064331055 ms
2022-09-21 16:43:08 INFO  Executing generated plans
2022-09-21 16:43:19 INFO  ---RUNTIME: Execution took 10527.884006500244 ms
2022-09-21 16:43:19 INFO  Done!
2022-09-21 16:43:19 INFO  # Finished -- repetition 6 of 7 
2022-09-21 16:43:19 INFO  # Optimization benchmark for feature_importance with args [['healthcare', 'slow_loading', 'featurization_1', 'logistic_regression']] -- repetition 7 of 7
2022-09-21 16:43:19 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-21 16:43:19 INFO  Running instrumented original pipeline...
2022-09-21 16:43:19 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-21 16:43:19 INFO  ---RUNTIME: Importing and monkey-patching took 5.774021148681641 ms
2022-09-21 16:43:21 INFO  ---RUNTIME: Original pipeline execution took 1976.8095016479492 ms (excluding imports and monkey-patching)
2022-09-21 16:43:21 INFO  Starting execution of 1 what-if analyses...
2022-09-21 16:43:21 INFO  Start plan generation for analysis PermutationFeatureImportance...
2022-09-21 16:43:21 INFO  ---RUNTIME: Plan generation took 0.152587890625 ms
2022-09-21 16:43:21 INFO  Estimated runtime of original DAG is 1725.597858428955ms
2022-09-21 16:43:21 INFO  Performing Multi-Query Optimization
2022-09-21 16:43:21 INFO  Estimated unoptimized what-if runtime is 10353.58715057373ms
2022-09-21 16:43:21 INFO  Estimated optimised what-if runtime is 1735.3646755218506ms
2022-09-21 16:43:21 INFO  Estimated optimisation runtime saving is 8618.22247505188ms
2022-09-21 16:43:21 INFO  ---RUNTIME: Multi-Query Optimization took 11.808395385742188 ms
2022-09-21 16:43:21 INFO  Executing generated plans
2022-09-21 16:43:22 INFO  ---RUNTIME: Execution took 1795.3581809997559 ms
2022-09-21 16:43:22 INFO  Done!
2022-09-21 16:43:22 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-21 16:43:22 INFO  Running instrumented original pipeline...
2022-09-21 16:43:22 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-21 16:43:22 INFO  ---RUNTIME: Importing and monkey-patching took 6.209850311279297 ms
2022-09-21 16:43:24 INFO  ---RUNTIME: Original pipeline execution took 1979.015827178955 ms (excluding imports and monkey-patching)
2022-09-21 16:43:24 INFO  Starting execution of 1 what-if analyses...
2022-09-21 16:43:24 INFO  Start plan generation for analysis PermutationFeatureImportance...
2022-09-21 16:43:24 INFO  ---RUNTIME: Plan generation took 0.11491775512695312 ms
2022-09-21 16:43:24 INFO  Estimated runtime of original DAG is 1729.3331623077393ms
2022-09-21 16:43:24 WARNING Skipping Multi-Query Optimization (instead, only applying patches)
2022-09-21 16:43:24 INFO  Estimated unoptimised what-if runtime is 10375.998973846436ms
2022-09-21 16:43:24 INFO  ---RUNTIME: Multi-Query Optimization took 4.65703010559082 ms
2022-09-21 16:43:24 INFO  Executing generated plans
2022-09-21 16:43:35 INFO  ---RUNTIME: Execution took 10545.096158981323 ms
2022-09-21 16:43:35 INFO  Done!
2022-09-21 16:43:35 INFO  # Finished -- repetition 7 of 7 
2022-09-21 16:43:35 INFO  # Final results after all repetitions
2022-09-21 16:43:35 INFO     repetition  ... no_opt_what_if_execution_combined_model_training
0           0  ...                                         6.802320
1           1  ...                                         6.860256
2           2  ...                                         6.897211
3           3  ...                                         6.786346
4           4  ...                                         6.606102
5           5  ...                                         6.922722
6           6  ...                                         6.665468

[7 rows x 26 columns]
taskset -c 0-7 PROTOCOL_BUFFERS_PYTHON_IMPLEMENTATION=python python3.9 benchmarks_end_to_end.py feature_importance healthcare slow_loading featurization_1 xgboost
2022-09-21 16:43:37.476961: W tensorflow/stream_executor/platform/default/dso_loader.cc:64] Could not load dynamic library 'libcudart.so.11.0'; dlerror: libcudart.so.11.0: cannot open shared object file: No such file or directory; LD_LIBRARY_PATH: /home/sgrafbe/mlwhatif/venv/lib/python3.9/site-packages/cv2/../../lib64:
2022-09-21 16:43:37.476995: I tensorflow/stream_executor/cuda/cudart_stub.cc:29] Ignore above cudart dlerror if you do not have a GPU set up on your machine.
2022-09-21 16:43:38 INFO  Patching sys.argv with ['mlwhatif', 'healthcare', 'slow_loading', 'featurization_1', 'xgboost']
2022-09-21 16:43:38 INFO  Running instrumented original pipeline...
2022-09-21 16:43:38 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-21 16:43:38 INFO  ---RUNTIME: Importing and monkey-patching took 96.42672538757324 ms
2022-09-21 16:43:41 INFO  ---RUNTIME: Original pipeline execution took 2876.1210441589355 ms (excluding imports and monkey-patching)
2022-09-21 16:43:41 INFO  Starting execution of 0 what-if analyses...
2022-09-21 16:43:41 INFO  Estimated runtime of original DAG is 2586.9598388671875ms
2022-09-21 16:43:41 INFO  Performing Multi-Query Optimization
2022-09-21 16:43:41 INFO  Estimated unoptimized what-if runtime is 0ms
2022-09-21 16:43:41 INFO  Estimated optimised what-if runtime is 0ms
2022-09-21 16:43:41 INFO  Estimated optimisation runtime saving is 0ms
2022-09-21 16:43:41 INFO  ---RUNTIME: Multi-Query Optimization took 0.4627704620361328 ms
2022-09-21 16:43:41 INFO  Executing generated plans
2022-09-21 16:43:41 INFO  ---RUNTIME: Execution took 0.024557113647460938 ms
2022-09-21 16:43:41 INFO  Done!
2022-09-21 16:43:41 INFO  # Optimization benchmark for feature_importance with args [['healthcare', 'slow_loading', 'featurization_1', 'xgboost']] -- repetition 1 of 7
2022-09-21 16:43:41 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-21 16:43:41 INFO  Running instrumented original pipeline...
2022-09-21 16:43:41 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-21 16:43:41 INFO  ---RUNTIME: Importing and monkey-patching took 6.135463714599609 ms
2022-09-21 16:43:44 INFO  ---RUNTIME: Original pipeline execution took 2285.562515258789 ms (excluding imports and monkey-patching)
2022-09-21 16:43:44 INFO  Starting execution of 1 what-if analyses...
2022-09-21 16:43:44 INFO  Start plan generation for analysis PermutationFeatureImportance...
2022-09-21 16:43:44 INFO  ---RUNTIME: Plan generation took 0.2562999725341797 ms
2022-09-21 16:43:44 INFO  Estimated runtime of original DAG is 2020.296573638916ms
2022-09-21 16:43:44 INFO  Performing Multi-Query Optimization
2022-09-21 16:43:44 INFO  Estimated unoptimized what-if runtime is 12121.779441833496ms
2022-09-21 16:43:44 INFO  Estimated optimised what-if runtime is 2040.0745868682861ms
2022-09-21 16:43:44 INFO  Estimated optimisation runtime saving is 10081.70485496521ms
2022-09-21 16:43:44 INFO  ---RUNTIME: Multi-Query Optimization took 11.67154312133789 ms
2022-09-21 16:43:44 INFO  Executing generated plans
2022-09-21 16:43:46 INFO  ---RUNTIME: Execution took 2236.084222793579 ms
2022-09-21 16:43:46 INFO  Done!
2022-09-21 16:43:46 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-21 16:43:46 INFO  Running instrumented original pipeline...
2022-09-21 16:43:46 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-21 16:43:46 INFO  ---RUNTIME: Importing and monkey-patching took 5.760431289672852 ms
2022-09-21 16:43:48 INFO  ---RUNTIME: Original pipeline execution took 2430.438995361328 ms (excluding imports and monkey-patching)
2022-09-21 16:43:48 INFO  Starting execution of 1 what-if analyses...
2022-09-21 16:43:48 INFO  Start plan generation for analysis PermutationFeatureImportance...
2022-09-21 16:43:48 INFO  ---RUNTIME: Plan generation took 0.1468658447265625 ms
2022-09-21 16:43:48 INFO  Estimated runtime of original DAG is 2008.1424713134766ms
2022-09-21 16:43:48 WARNING Skipping Multi-Query Optimization (instead, only applying patches)
2022-09-21 16:43:48 INFO  Estimated unoptimised what-if runtime is 12048.85482788086ms
2022-09-21 16:43:48 INFO  ---RUNTIME: Multi-Query Optimization took 4.430055618286133 ms
2022-09-21 16:43:48 INFO  Executing generated plans
2022-09-21 16:44:00 INFO  ---RUNTIME: Execution took 12076.1559009552 ms
2022-09-21 16:44:00 INFO  Done!
2022-09-21 16:44:00 INFO  # Finished -- repetition 1 of 7 
2022-09-21 16:44:00 INFO  # Optimization benchmark for feature_importance with args [['healthcare', 'slow_loading', 'featurization_1', 'xgboost']] -- repetition 2 of 7
2022-09-21 16:44:00 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-21 16:44:00 INFO  Running instrumented original pipeline...
2022-09-21 16:44:00 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-21 16:44:00 INFO  ---RUNTIME: Importing and monkey-patching took 6.1969757080078125 ms
2022-09-21 16:44:02 INFO  ---RUNTIME: Original pipeline execution took 2200.1795768737793 ms (excluding imports and monkey-patching)
2022-09-21 16:44:02 INFO  Starting execution of 1 what-if analyses...
2022-09-21 16:44:02 INFO  Start plan generation for analysis PermutationFeatureImportance...
2022-09-21 16:44:02 INFO  ---RUNTIME: Plan generation took 0.1220703125 ms
2022-09-21 16:44:02 INFO  Estimated runtime of original DAG is 1941.3886070251465ms
2022-09-21 16:44:02 INFO  Performing Multi-Query Optimization
2022-09-21 16:44:03 INFO  Estimated unoptimized what-if runtime is 11648.331642150879ms
2022-09-21 16:44:03 INFO  Estimated optimised what-if runtime is 1958.5864543914795ms
2022-09-21 16:44:03 INFO  Estimated optimisation runtime saving is 9689.7451877594ms
2022-09-21 16:44:03 INFO  ---RUNTIME: Multi-Query Optimization took 11.598825454711914 ms
2022-09-21 16:44:03 INFO  Executing generated plans
2022-09-21 16:44:05 INFO  ---RUNTIME: Execution took 2042.0172214508057 ms
2022-09-21 16:44:05 INFO  Done!
2022-09-21 16:44:05 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-21 16:44:05 INFO  Running instrumented original pipeline...
2022-09-21 16:44:05 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-21 16:44:05 INFO  ---RUNTIME: Importing and monkey-patching took 5.617856979370117 ms
2022-09-21 16:44:07 INFO  ---RUNTIME: Original pipeline execution took 2197.394371032715 ms (excluding imports and monkey-patching)
2022-09-21 16:44:07 INFO  Starting execution of 1 what-if analyses...
2022-09-21 16:44:07 INFO  Start plan generation for analysis PermutationFeatureImportance...
2022-09-21 16:44:07 INFO  ---RUNTIME: Plan generation took 0.10323524475097656 ms
2022-09-21 16:44:07 INFO  Estimated runtime of original DAG is 1934.4689846038818ms
2022-09-21 16:44:07 WARNING Skipping Multi-Query Optimization (instead, only applying patches)
2022-09-21 16:44:07 INFO  Estimated unoptimised what-if runtime is 11606.813907623291ms
2022-09-21 16:44:07 INFO  ---RUNTIME: Multi-Query Optimization took 4.466772079467773 ms
2022-09-21 16:44:07 INFO  Executing generated plans
2022-09-21 16:44:25 INFO  ---RUNTIME: Execution took 17820.40786743164 ms
2022-09-21 16:44:25 INFO  Done!
2022-09-21 16:44:25 INFO  # Finished -- repetition 2 of 7 
2022-09-21 16:44:25 INFO  # Optimization benchmark for feature_importance with args [['healthcare', 'slow_loading', 'featurization_1', 'xgboost']] -- repetition 3 of 7
2022-09-21 16:44:25 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-21 16:44:25 INFO  Running instrumented original pipeline...
2022-09-21 16:44:25 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-21 16:44:25 INFO  ---RUNTIME: Importing and monkey-patching took 6.07752799987793 ms
2022-09-21 16:44:29 INFO  ---RUNTIME: Original pipeline execution took 4687.325954437256 ms (excluding imports and monkey-patching)
2022-09-21 16:44:29 INFO  Starting execution of 1 what-if analyses...
2022-09-21 16:44:29 INFO  Start plan generation for analysis PermutationFeatureImportance...
2022-09-21 16:44:29 INFO  ---RUNTIME: Plan generation took 0.1723766326904297 ms
2022-09-21 16:44:29 INFO  Estimated runtime of original DAG is 4407.635927200317ms
2022-09-21 16:44:29 INFO  Performing Multi-Query Optimization
2022-09-21 16:44:29 INFO  Estimated unoptimized what-if runtime is 26445.815563201904ms
2022-09-21 16:44:29 INFO  Estimated optimised what-if runtime is 4434.029579162598ms
2022-09-21 16:44:29 INFO  Estimated optimisation runtime saving is 22011.785984039307ms
2022-09-21 16:44:29 INFO  ---RUNTIME: Multi-Query Optimization took 19.39868927001953 ms
2022-09-21 16:44:29 INFO  Executing generated plans
2022-09-21 16:44:31 INFO  ---RUNTIME: Execution took 2117.4182891845703 ms
2022-09-21 16:44:31 INFO  Done!
2022-09-21 16:44:31 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-21 16:44:31 INFO  Running instrumented original pipeline...
2022-09-21 16:44:31 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-21 16:44:31 INFO  ---RUNTIME: Importing and monkey-patching took 5.667924880981445 ms
2022-09-21 16:44:34 INFO  ---RUNTIME: Original pipeline execution took 2211.148738861084 ms (excluding imports and monkey-patching)
2022-09-21 16:44:34 INFO  Starting execution of 1 what-if analyses...
2022-09-21 16:44:34 INFO  Start plan generation for analysis PermutationFeatureImportance...
2022-09-21 16:44:34 INFO  ---RUNTIME: Plan generation took 0.125885009765625 ms
2022-09-21 16:44:34 INFO  Estimated runtime of original DAG is 1949.2743015289307ms
2022-09-21 16:44:34 WARNING Skipping Multi-Query Optimization (instead, only applying patches)
2022-09-21 16:44:34 INFO  Estimated unoptimised what-if runtime is 11695.645809173584ms
2022-09-21 16:44:34 INFO  ---RUNTIME: Multi-Query Optimization took 4.530429840087891 ms
2022-09-21 16:44:34 INFO  Executing generated plans
2022-09-21 16:44:46 INFO  ---RUNTIME: Execution took 12400.627613067627 ms
2022-09-21 16:44:46 INFO  Done!
2022-09-21 16:44:46 INFO  # Finished -- repetition 3 of 7 
2022-09-21 16:44:46 INFO  # Optimization benchmark for feature_importance with args [['healthcare', 'slow_loading', 'featurization_1', 'xgboost']] -- repetition 4 of 7
2022-09-21 16:44:46 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-21 16:44:46 INFO  Running instrumented original pipeline...
2022-09-21 16:44:46 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-21 16:44:46 INFO  ---RUNTIME: Importing and monkey-patching took 5.753278732299805 ms
2022-09-21 16:44:50 INFO  ---RUNTIME: Original pipeline execution took 3621.9587326049805 ms (excluding imports and monkey-patching)
2022-09-21 16:44:50 INFO  Starting execution of 1 what-if analyses...
2022-09-21 16:44:50 INFO  Start plan generation for analysis PermutationFeatureImportance...
2022-09-21 16:44:50 INFO  ---RUNTIME: Plan generation took 0.4093647003173828 ms
2022-09-21 16:44:50 INFO  Estimated runtime of original DAG is 3359.2629432678223ms
2022-09-21 16:44:50 INFO  Performing Multi-Query Optimization
2022-09-21 16:44:50 INFO  Estimated unoptimized what-if runtime is 20155.577659606934ms
2022-09-21 16:44:50 INFO  Estimated optimised what-if runtime is 3382.3277950286865ms
2022-09-21 16:44:50 INFO  Estimated optimisation runtime saving is 16773.249864578247ms
2022-09-21 16:44:50 INFO  ---RUNTIME: Multi-Query Optimization took 11.468887329101562 ms
2022-09-21 16:44:50 INFO  Executing generated plans
2022-09-21 16:44:52 INFO  ---RUNTIME: Execution took 1969.095230102539 ms
2022-09-21 16:44:52 INFO  Done!
2022-09-21 16:44:52 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-21 16:44:52 INFO  Running instrumented original pipeline...
2022-09-21 16:44:52 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-21 16:44:52 INFO  ---RUNTIME: Importing and monkey-patching took 5.495309829711914 ms
2022-09-21 16:44:54 INFO  ---RUNTIME: Original pipeline execution took 2252.3927688598633 ms (excluding imports and monkey-patching)
2022-09-21 16:44:54 INFO  Starting execution of 1 what-if analyses...
2022-09-21 16:44:54 INFO  Start plan generation for analysis PermutationFeatureImportance...
2022-09-21 16:44:54 INFO  ---RUNTIME: Plan generation took 0.10275840759277344 ms
2022-09-21 16:44:54 INFO  Estimated runtime of original DAG is 1993.7045574188232ms
2022-09-21 16:44:54 WARNING Skipping Multi-Query Optimization (instead, only applying patches)
2022-09-21 16:44:54 INFO  Estimated unoptimised what-if runtime is 11962.22734451294ms
2022-09-21 16:44:54 INFO  ---RUNTIME: Multi-Query Optimization took 4.40526008605957 ms
2022-09-21 16:44:54 INFO  Executing generated plans
2022-09-21 16:45:06 INFO  ---RUNTIME: Execution took 11968.816041946411 ms
2022-09-21 16:45:06 INFO  Done!
2022-09-21 16:45:06 INFO  # Finished -- repetition 4 of 7 
2022-09-21 16:45:06 INFO  # Optimization benchmark for feature_importance with args [['healthcare', 'slow_loading', 'featurization_1', 'xgboost']] -- repetition 5 of 7
2022-09-21 16:45:06 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-21 16:45:06 INFO  Running instrumented original pipeline...
2022-09-21 16:45:06 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-21 16:45:06 INFO  ---RUNTIME: Importing and monkey-patching took 6.114959716796875 ms
2022-09-21 16:45:08 INFO  ---RUNTIME: Original pipeline execution took 2319.86927986145 ms (excluding imports and monkey-patching)
2022-09-21 16:45:08 INFO  Starting execution of 1 what-if analyses...
2022-09-21 16:45:08 INFO  Start plan generation for analysis PermutationFeatureImportance...
2022-09-21 16:45:08 INFO  ---RUNTIME: Plan generation took 0.11920928955078125 ms
2022-09-21 16:45:08 INFO  Estimated runtime of original DAG is 2051.8741607666016ms
2022-09-21 16:45:08 INFO  Performing Multi-Query Optimization
2022-09-21 16:45:08 INFO  Estimated unoptimized what-if runtime is 12311.24496459961ms
2022-09-21 16:45:08 INFO  Estimated optimised what-if runtime is 2076.263189315796ms
2022-09-21 16:45:08 INFO  Estimated optimisation runtime saving is 10234.981775283813ms
2022-09-21 16:45:08 INFO  ---RUNTIME: Multi-Query Optimization took 11.929512023925781 ms
2022-09-21 16:45:08 INFO  Executing generated plans
2022-09-21 16:45:13 INFO  ---RUNTIME: Execution took 4665.729522705078 ms
2022-09-21 16:45:13 INFO  Done!
2022-09-21 16:45:13 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-21 16:45:13 INFO  Running instrumented original pipeline...
2022-09-21 16:45:13 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-21 16:45:13 INFO  ---RUNTIME: Importing and monkey-patching took 6.690740585327148 ms
2022-09-21 16:45:15 INFO  ---RUNTIME: Original pipeline execution took 2336.3068103790283 ms (excluding imports and monkey-patching)
2022-09-21 16:45:15 INFO  Starting execution of 1 what-if analyses...
2022-09-21 16:45:15 INFO  Start plan generation for analysis PermutationFeatureImportance...
2022-09-21 16:45:15 INFO  ---RUNTIME: Plan generation took 0.11610984802246094 ms
2022-09-21 16:45:15 INFO  Estimated runtime of original DAG is 2066.046714782715ms
2022-09-21 16:45:15 WARNING Skipping Multi-Query Optimization (instead, only applying patches)
2022-09-21 16:45:15 INFO  Estimated unoptimised what-if runtime is 12396.280288696289ms
2022-09-21 16:45:15 INFO  ---RUNTIME: Multi-Query Optimization took 4.463911056518555 ms
2022-09-21 16:45:15 INFO  Executing generated plans
2022-09-21 16:45:29 INFO  ---RUNTIME: Execution took 13802.345514297485 ms
2022-09-21 16:45:29 INFO  Done!
2022-09-21 16:45:29 INFO  # Finished -- repetition 5 of 7 
2022-09-21 16:45:29 INFO  # Optimization benchmark for feature_importance with args [['healthcare', 'slow_loading', 'featurization_1', 'xgboost']] -- repetition 6 of 7
2022-09-21 16:45:29 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-21 16:45:29 INFO  Running instrumented original pipeline...
2022-09-21 16:45:29 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-21 16:45:29 INFO  ---RUNTIME: Importing and monkey-patching took 6.466388702392578 ms
2022-09-21 16:45:32 INFO  ---RUNTIME: Original pipeline execution took 2976.1722087860107 ms (excluding imports and monkey-patching)
2022-09-21 16:45:32 INFO  Starting execution of 1 what-if analyses...
2022-09-21 16:45:32 INFO  Start plan generation for analysis PermutationFeatureImportance...
2022-09-21 16:45:32 INFO  ---RUNTIME: Plan generation took 0.11730194091796875 ms
2022-09-21 16:45:32 INFO  Estimated runtime of original DAG is 2711.452007293701ms
2022-09-21 16:45:32 INFO  Performing Multi-Query Optimization
2022-09-21 16:45:32 INFO  Estimated unoptimized what-if runtime is 16268.712043762207ms
2022-09-21 16:45:32 INFO  Estimated optimised what-if runtime is 2729.329824447632ms
2022-09-21 16:45:32 INFO  Estimated optimisation runtime saving is 13539.382219314575ms
2022-09-21 16:45:32 INFO  ---RUNTIME: Multi-Query Optimization took 11.630535125732422 ms
2022-09-21 16:45:32 INFO  Executing generated plans
2022-09-21 16:45:34 INFO  ---RUNTIME: Execution took 1992.0048713684082 ms
2022-09-21 16:45:34 INFO  Done!
2022-09-21 16:45:34 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-21 16:45:34 INFO  Running instrumented original pipeline...
2022-09-21 16:45:34 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-21 16:45:34 INFO  ---RUNTIME: Importing and monkey-patching took 5.770683288574219 ms
2022-09-21 16:45:36 INFO  ---RUNTIME: Original pipeline execution took 2243.4072494506836 ms (excluding imports and monkey-patching)
2022-09-21 16:45:36 INFO  Starting execution of 1 what-if analyses...
2022-09-21 16:45:36 INFO  Start plan generation for analysis PermutationFeatureImportance...
2022-09-21 16:45:36 INFO  ---RUNTIME: Plan generation took 0.10061264038085938 ms
2022-09-21 16:45:36 INFO  Estimated runtime of original DAG is 1982.1958541870117ms
2022-09-21 16:45:36 WARNING Skipping Multi-Query Optimization (instead, only applying patches)
2022-09-21 16:45:37 INFO  Estimated unoptimised what-if runtime is 11893.17512512207ms
2022-09-21 16:45:37 INFO  ---RUNTIME: Multi-Query Optimization took 231.63533210754395 ms
2022-09-21 16:45:37 INFO  Executing generated plans
2022-09-21 16:45:49 INFO  ---RUNTIME: Execution took 12051.755666732788 ms
2022-09-21 16:45:49 INFO  Done!
2022-09-21 16:45:49 INFO  # Finished -- repetition 6 of 7 
2022-09-21 16:45:49 INFO  # Optimization benchmark for feature_importance with args [['healthcare', 'slow_loading', 'featurization_1', 'xgboost']] -- repetition 7 of 7
2022-09-21 16:45:49 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-21 16:45:49 INFO  Running instrumented original pipeline...
2022-09-21 16:45:49 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-21 16:45:49 INFO  ---RUNTIME: Importing and monkey-patching took 6.124258041381836 ms
2022-09-21 16:45:51 INFO  ---RUNTIME: Original pipeline execution took 2209.9435329437256 ms (excluding imports and monkey-patching)
2022-09-21 16:45:51 INFO  Starting execution of 1 what-if analyses...
2022-09-21 16:45:51 INFO  Start plan generation for analysis PermutationFeatureImportance...
2022-09-21 16:45:51 INFO  ---RUNTIME: Plan generation took 0.18644332885742188 ms
2022-09-21 16:45:51 INFO  Estimated runtime of original DAG is 1945.8050727844238ms
2022-09-21 16:45:51 INFO  Performing Multi-Query Optimization
2022-09-21 16:45:51 INFO  Estimated unoptimized what-if runtime is 11674.830436706543ms
2022-09-21 16:45:51 INFO  Estimated optimised what-if runtime is 1964.278221130371ms
2022-09-21 16:45:51 INFO  Estimated optimisation runtime saving is 9710.552215576172ms
2022-09-21 16:45:51 INFO  ---RUNTIME: Multi-Query Optimization took 11.604070663452148 ms
2022-09-21 16:45:51 INFO  Executing generated plans
2022-09-21 16:45:53 INFO  ---RUNTIME: Execution took 2153.3710956573486 ms
2022-09-21 16:45:53 INFO  Done!
2022-09-21 16:45:53 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-21 16:45:53 INFO  Running instrumented original pipeline...
2022-09-21 16:45:53 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-21 16:45:53 INFO  ---RUNTIME: Importing and monkey-patching took 5.6591033935546875 ms
2022-09-21 16:45:56 INFO  ---RUNTIME: Original pipeline execution took 2771.5046405792236 ms (excluding imports and monkey-patching)
2022-09-21 16:45:56 INFO  Starting execution of 1 what-if analyses...
2022-09-21 16:45:56 INFO  Start plan generation for analysis PermutationFeatureImportance...
2022-09-21 16:45:56 INFO  ---RUNTIME: Plan generation took 0.12683868408203125 ms
2022-09-21 16:45:56 INFO  Estimated runtime of original DAG is 2512.770891189575ms
2022-09-21 16:45:56 WARNING Skipping Multi-Query Optimization (instead, only applying patches)
2022-09-21 16:45:56 INFO  Estimated unoptimised what-if runtime is 15076.625347137451ms
2022-09-21 16:45:56 INFO  ---RUNTIME: Multi-Query Optimization took 4.905939102172852 ms
2022-09-21 16:45:56 INFO  Executing generated plans
2022-09-21 16:46:08 INFO  ---RUNTIME: Execution took 11805.988311767578 ms
2022-09-21 16:46:08 INFO  Done!
2022-09-21 16:46:08 INFO  # Finished -- repetition 7 of 7 
2022-09-21 16:46:08 INFO  # Final results after all repetitions
2022-09-21 16:46:08 INFO     repetition  ... no_opt_what_if_execution_combined_model_training
0           0  ...                                      1110.689163
1           1  ...                                      7160.438776
2           2  ...                                      1507.070303
3           3  ...                                      1218.657732
4           4  ...                                      2996.577024
5           5  ...                                      1380.310535
6           6  ...                                      1193.817854

[7 rows x 26 columns]
taskset -c 0-7 PROTOCOL_BUFFERS_PYTHON_IMPLEMENTATION=python python3.9 benchmarks_end_to_end.py feature_importance healthcare slow_loading featurization_1 neural_network
2022-09-21 16:46:10.090461: W tensorflow/stream_executor/platform/default/dso_loader.cc:64] Could not load dynamic library 'libcudart.so.11.0'; dlerror: libcudart.so.11.0: cannot open shared object file: No such file or directory; LD_LIBRARY_PATH: /home/sgrafbe/mlwhatif/venv/lib/python3.9/site-packages/cv2/../../lib64:
2022-09-21 16:46:10.090505: I tensorflow/stream_executor/cuda/cudart_stub.cc:29] Ignore above cudart dlerror if you do not have a GPU set up on your machine.
2022-09-21 16:46:11 INFO  Patching sys.argv with ['mlwhatif', 'healthcare', 'slow_loading', 'featurization_1', 'neural_network']
2022-09-21 16:46:11 INFO  Running instrumented original pipeline...
2022-09-21 16:46:11 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-21 16:46:11 INFO  ---RUNTIME: Importing and monkey-patching took 98.90007972717285 ms
2022-09-21 16:46:13.507907: W tensorflow/stream_executor/platform/default/dso_loader.cc:64] Could not load dynamic library 'libcuda.so.1'; dlerror: libcuda.so.1: cannot open shared object file: No such file or directory; LD_LIBRARY_PATH: /home/sgrafbe/mlwhatif/venv/lib/python3.9/site-packages/cv2/../../lib64:
2022-09-21 16:46:13.507941: W tensorflow/stream_executor/cuda/cuda_driver.cc:326] failed call to cuInit: UNKNOWN ERROR (303)
2022-09-21 16:46:13.507962: I tensorflow/stream_executor/cuda/cuda_diagnostics.cc:156] kernel driver does not appear to be running on this host (wagyu): /proc/driver/nvidia/version does not exist
2022-09-21 16:46:13.508418: I tensorflow/core/platform/cpu_feature_guard.cc:142] This TensorFlow binary is optimized with oneAPI Deep Neural Network Library (oneDNN) to use the following CPU instructions in performance-critical operations:  AVX2 FMA
To enable them in other operations, rebuild TensorFlow with the appropriate compiler flags.
2022-09-21 16:46:14.076125: I tensorflow/compiler/mlir/mlir_graph_optimization_pass.cc:176] None of the MLIR Optimization Passes are enabled (registered 2)
2022-09-21 16:46:14.089588: I tensorflow/core/platform/profile_utils/cpu_utils.cc:114] CPU Frequency: 2595290000 Hz
2022-09-21 16:46:14 INFO  ---RUNTIME: Original pipeline execution took 2888.173818588257 ms (excluding imports and monkey-patching)
2022-09-21 16:46:14 INFO  Starting execution of 0 what-if analyses...
2022-09-21 16:46:14 INFO  Estimated runtime of original DAG is 2598.1357097625732ms
2022-09-21 16:46:14 INFO  Performing Multi-Query Optimization
2022-09-21 16:46:14 INFO  Estimated unoptimized what-if runtime is 0ms
2022-09-21 16:46:14 INFO  Estimated optimised what-if runtime is 0ms
2022-09-21 16:46:14 INFO  Estimated optimisation runtime saving is 0ms
2022-09-21 16:46:14 INFO  ---RUNTIME: Multi-Query Optimization took 0.5078315734863281 ms
2022-09-21 16:46:14 INFO  Executing generated plans
2022-09-21 16:46:14 INFO  ---RUNTIME: Execution took 0.019073486328125 ms
2022-09-21 16:46:14 INFO  Done!
2022-09-21 16:46:14 INFO  # Optimization benchmark for feature_importance with args [['healthcare', 'slow_loading', 'featurization_1', 'neural_network']] -- repetition 1 of 7
2022-09-21 16:46:14 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-21 16:46:14 INFO  Running instrumented original pipeline...
2022-09-21 16:46:14 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-21 16:46:14 INFO  ---RUNTIME: Importing and monkey-patching took 5.281925201416016 ms
2022-09-21 16:46:16 INFO  ---RUNTIME: Original pipeline execution took 2484.1606616973877 ms (excluding imports and monkey-patching)
2022-09-21 16:46:16 INFO  Starting execution of 1 what-if analyses...
2022-09-21 16:46:16 INFO  Start plan generation for analysis PermutationFeatureImportance...
2022-09-21 16:46:16 INFO  ---RUNTIME: Plan generation took 0.18286705017089844 ms
2022-09-21 16:46:16 INFO  Estimated runtime of original DAG is 2232.5785160064697ms
2022-09-21 16:46:16 INFO  Performing Multi-Query Optimization
2022-09-21 16:46:16 INFO  Estimated unoptimized what-if runtime is 13395.471096038818ms
2022-09-21 16:46:16 INFO  Estimated optimised what-if runtime is 2517.4617767333984ms
2022-09-21 16:46:16 INFO  Estimated optimisation runtime saving is 10878.00931930542ms
2022-09-21 16:46:16 INFO  ---RUNTIME: Multi-Query Optimization took 11.783599853515625 ms
2022-09-21 16:46:16 INFO  Executing generated plans
2022-09-21 16:46:19 INFO  ---RUNTIME: Execution took 2291.4369106292725 ms
2022-09-21 16:46:19 INFO  Done!
2022-09-21 16:46:19 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-21 16:46:19 INFO  Running instrumented original pipeline...
2022-09-21 16:46:19 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-21 16:46:19 INFO  ---RUNTIME: Importing and monkey-patching took 5.818843841552734 ms
2022-09-21 16:46:21 INFO  ---RUNTIME: Original pipeline execution took 2680.4850101470947 ms (excluding imports and monkey-patching)
2022-09-21 16:46:21 INFO  Starting execution of 1 what-if analyses...
2022-09-21 16:46:21 INFO  Start plan generation for analysis PermutationFeatureImportance...
2022-09-21 16:46:21 INFO  ---RUNTIME: Plan generation took 0.12350082397460938 ms
2022-09-21 16:46:21 INFO  Estimated runtime of original DAG is 2424.6699810028076ms
2022-09-21 16:46:21 WARNING Skipping Multi-Query Optimization (instead, only applying patches)
2022-09-21 16:46:21 INFO  Estimated unoptimised what-if runtime is 14548.019886016846ms
2022-09-21 16:46:21 INFO  ---RUNTIME: Multi-Query Optimization took 4.590272903442383 ms
2022-09-21 16:46:21 INFO  Executing generated plans
2022-09-21 16:46:35 INFO  ---RUNTIME: Execution took 13970.622539520264 ms
2022-09-21 16:46:35 INFO  Done!
2022-09-21 16:46:35 INFO  # Finished -- repetition 1 of 7 
2022-09-21 16:46:35 INFO  # Optimization benchmark for feature_importance with args [['healthcare', 'slow_loading', 'featurization_1', 'neural_network']] -- repetition 2 of 7
2022-09-21 16:46:35 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-21 16:46:35 INFO  Running instrumented original pipeline...
2022-09-21 16:46:35 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-21 16:46:35 INFO  ---RUNTIME: Importing and monkey-patching took 6.181240081787109 ms
2022-09-21 16:46:38 INFO  ---RUNTIME: Original pipeline execution took 2495.6910610198975 ms (excluding imports and monkey-patching)
2022-09-21 16:46:38 INFO  Starting execution of 1 what-if analyses...
2022-09-21 16:46:38 INFO  Start plan generation for analysis PermutationFeatureImportance...
2022-09-21 16:46:38 INFO  ---RUNTIME: Plan generation took 0.12373924255371094 ms
2022-09-21 16:46:38 INFO  Estimated runtime of original DAG is 2241.903066635132ms
2022-09-21 16:46:38 INFO  Performing Multi-Query Optimization
2022-09-21 16:46:38 INFO  Estimated unoptimized what-if runtime is 13451.418399810791ms
2022-09-21 16:46:38 INFO  Estimated optimised what-if runtime is 2521.4173793792725ms
2022-09-21 16:46:38 INFO  Estimated optimisation runtime saving is 10930.001020431519ms
2022-09-21 16:46:38 INFO  ---RUNTIME: Multi-Query Optimization took 12.655496597290039 ms
2022-09-21 16:46:38 INFO  Executing generated plans
2022-09-21 16:46:40 INFO  ---RUNTIME: Execution took 2328.234910964966 ms
2022-09-21 16:46:40 INFO  Done!
2022-09-21 16:46:40 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-21 16:46:40 INFO  Running instrumented original pipeline...
2022-09-21 16:46:40 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-21 16:46:40 INFO  ---RUNTIME: Importing and monkey-patching took 6.179094314575195 ms
2022-09-21 16:46:43 INFO  ---RUNTIME: Original pipeline execution took 2837.700128555298 ms (excluding imports and monkey-patching)
2022-09-21 16:46:43 INFO  Starting execution of 1 what-if analyses...
2022-09-21 16:46:43 INFO  Start plan generation for analysis PermutationFeatureImportance...
2022-09-21 16:46:43 INFO  ---RUNTIME: Plan generation took 0.18358230590820312 ms
2022-09-21 16:46:43 INFO  Estimated runtime of original DAG is 2582.090139389038ms
2022-09-21 16:46:43 WARNING Skipping Multi-Query Optimization (instead, only applying patches)
2022-09-21 16:46:43 INFO  Estimated unoptimised what-if runtime is 15492.540836334229ms
2022-09-21 16:46:43 INFO  ---RUNTIME: Multi-Query Optimization took 6.375789642333984 ms
2022-09-21 16:46:43 INFO  Executing generated plans
2022-09-21 16:46:57 INFO  ---RUNTIME: Execution took 13949.368953704834 ms
2022-09-21 16:46:57 INFO  Done!
2022-09-21 16:46:57 INFO  # Finished -- repetition 2 of 7 
2022-09-21 16:46:57 INFO  # Optimization benchmark for feature_importance with args [['healthcare', 'slow_loading', 'featurization_1', 'neural_network']] -- repetition 3 of 7
2022-09-21 16:46:57 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-21 16:46:57 INFO  Running instrumented original pipeline...
2022-09-21 16:46:57 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-21 16:46:57 INFO  ---RUNTIME: Importing and monkey-patching took 5.704641342163086 ms
2022-09-21 16:46:59 INFO  ---RUNTIME: Original pipeline execution took 2475.1360416412354 ms (excluding imports and monkey-patching)
2022-09-21 16:46:59 INFO  Starting execution of 1 what-if analyses...
2022-09-21 16:46:59 INFO  Start plan generation for analysis PermutationFeatureImportance...
2022-09-21 16:46:59 INFO  ---RUNTIME: Plan generation took 0.2617835998535156 ms
2022-09-21 16:46:59 INFO  Estimated runtime of original DAG is 2221.7323780059814ms
2022-09-21 16:46:59 INFO  Performing Multi-Query Optimization
2022-09-21 16:46:59 INFO  Estimated unoptimized what-if runtime is 13330.394268035889ms
2022-09-21 16:46:59 INFO  Estimated optimised what-if runtime is 2503.8774013519287ms
2022-09-21 16:46:59 INFO  Estimated optimisation runtime saving is 10826.51686668396ms
2022-09-21 16:46:59 INFO  ---RUNTIME: Multi-Query Optimization took 11.710405349731445 ms
2022-09-21 16:46:59 INFO  Executing generated plans
2022-09-21 16:47:02 INFO  ---RUNTIME: Execution took 2306.1087131500244 ms
2022-09-21 16:47:02 INFO  Done!
2022-09-21 16:47:02 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-21 16:47:02 INFO  Running instrumented original pipeline...
2022-09-21 16:47:02 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-21 16:47:02 INFO  ---RUNTIME: Importing and monkey-patching took 5.901336669921875 ms
2022-09-21 16:47:04 INFO  ---RUNTIME: Original pipeline execution took 2517.8401470184326 ms (excluding imports and monkey-patching)
2022-09-21 16:47:04 INFO  Starting execution of 1 what-if analyses...
2022-09-21 16:47:04 INFO  Start plan generation for analysis PermutationFeatureImportance...
2022-09-21 16:47:04 INFO  ---RUNTIME: Plan generation took 0.13494491577148438 ms
2022-09-21 16:47:04 INFO  Estimated runtime of original DAG is 2263.770818710327ms
2022-09-21 16:47:04 WARNING Skipping Multi-Query Optimization (instead, only applying patches)
2022-09-21 16:47:04 INFO  Estimated unoptimised what-if runtime is 13582.624912261963ms
2022-09-21 16:47:04 INFO  ---RUNTIME: Multi-Query Optimization took 5.714654922485352 ms
2022-09-21 16:47:04 INFO  Executing generated plans
2022-09-21 16:47:18 INFO  ---RUNTIME: Execution took 13923.009634017944 ms
2022-09-21 16:47:18 INFO  Done!
2022-09-21 16:47:18 INFO  # Finished -- repetition 3 of 7 
2022-09-21 16:47:18 INFO  # Optimization benchmark for feature_importance with args [['healthcare', 'slow_loading', 'featurization_1', 'neural_network']] -- repetition 4 of 7
2022-09-21 16:47:18 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-21 16:47:18 INFO  Running instrumented original pipeline...
2022-09-21 16:47:18 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-21 16:47:18 INFO  ---RUNTIME: Importing and monkey-patching took 5.917787551879883 ms
2022-09-21 16:47:21 INFO  ---RUNTIME: Original pipeline execution took 2865.330934524536 ms (excluding imports and monkey-patching)
2022-09-21 16:47:21 INFO  Starting execution of 1 what-if analyses...
2022-09-21 16:47:21 INFO  Start plan generation for analysis PermutationFeatureImportance...
2022-09-21 16:47:21 INFO  ---RUNTIME: Plan generation took 0.11849403381347656 ms
2022-09-21 16:47:21 INFO  Estimated runtime of original DAG is 2611.785888671875ms
2022-09-21 16:47:21 INFO  Performing Multi-Query Optimization
2022-09-21 16:47:21 INFO  Estimated unoptimized what-if runtime is 15670.71533203125ms
2022-09-21 16:47:21 INFO  Estimated optimised what-if runtime is 2893.1829929351807ms
2022-09-21 16:47:21 INFO  Estimated optimisation runtime saving is 12777.53233909607ms
2022-09-21 16:47:21 INFO  ---RUNTIME: Multi-Query Optimization took 11.70659065246582 ms
2022-09-21 16:47:21 INFO  Executing generated plans
2022-09-21 16:47:23 INFO  ---RUNTIME: Execution took 2298.862934112549 ms
2022-09-21 16:47:23 INFO  Done!
2022-09-21 16:47:23 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-21 16:47:23 INFO  Running instrumented original pipeline...
2022-09-21 16:47:23 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-21 16:47:23 INFO  ---RUNTIME: Importing and monkey-patching took 5.814790725708008 ms
2022-09-21 16:47:26 INFO  ---RUNTIME: Original pipeline execution took 2576.5113830566406 ms (excluding imports and monkey-patching)
2022-09-21 16:47:26 INFO  Starting execution of 1 what-if analyses...
2022-09-21 16:47:26 INFO  Start plan generation for analysis PermutationFeatureImportance...
2022-09-21 16:47:26 INFO  ---RUNTIME: Plan generation took 0.10967254638671875 ms
2022-09-21 16:47:26 INFO  Estimated runtime of original DAG is 2323.697805404663ms
2022-09-21 16:47:26 WARNING Skipping Multi-Query Optimization (instead, only applying patches)
2022-09-21 16:47:26 INFO  Estimated unoptimised what-if runtime is 13942.186832427979ms
2022-09-21 16:47:26 INFO  ---RUNTIME: Multi-Query Optimization took 4.652261734008789 ms
2022-09-21 16:47:26 INFO  Executing generated plans
2022-09-21 16:47:40 INFO  ---RUNTIME: Execution took 13986.875057220459 ms
2022-09-21 16:47:40 INFO  Done!
2022-09-21 16:47:40 INFO  # Finished -- repetition 4 of 7 
2022-09-21 16:47:40 INFO  # Optimization benchmark for feature_importance with args [['healthcare', 'slow_loading', 'featurization_1', 'neural_network']] -- repetition 5 of 7
2022-09-21 16:47:40 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-21 16:47:40 INFO  Running instrumented original pipeline...
2022-09-21 16:47:40 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-21 16:47:40 INFO  ---RUNTIME: Importing and monkey-patching took 5.976676940917969 ms
2022-09-21 16:47:43 INFO  ---RUNTIME: Original pipeline execution took 2556.6084384918213 ms (excluding imports and monkey-patching)
2022-09-21 16:47:43 INFO  Starting execution of 1 what-if analyses...
2022-09-21 16:47:43 INFO  Start plan generation for analysis PermutationFeatureImportance...
2022-09-21 16:47:43 INFO  ---RUNTIME: Plan generation took 0.17762184143066406 ms
2022-09-21 16:47:43 INFO  Estimated runtime of original DAG is 2301.146984100342ms
2022-09-21 16:47:43 INFO  Performing Multi-Query Optimization
2022-09-21 16:47:43 INFO  Estimated unoptimized what-if runtime is 13806.88190460205ms
2022-09-21 16:47:43 INFO  Estimated optimised what-if runtime is 2583.4898948669434ms
2022-09-21 16:47:43 INFO  Estimated optimisation runtime saving is 11223.392009735107ms
2022-09-21 16:47:43 INFO  ---RUNTIME: Multi-Query Optimization took 12.809038162231445 ms
2022-09-21 16:47:43 INFO  Executing generated plans
2022-09-21 16:47:45 INFO  ---RUNTIME: Execution took 2673.8624572753906 ms
2022-09-21 16:47:45 INFO  Done!
2022-09-21 16:47:45 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-21 16:47:45 INFO  Running instrumented original pipeline...
2022-09-21 16:47:45 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-21 16:47:45 INFO  ---RUNTIME: Importing and monkey-patching took 6.020069122314453 ms
2022-09-21 16:47:48 INFO  ---RUNTIME: Original pipeline execution took 2471.362590789795 ms (excluding imports and monkey-patching)
2022-09-21 16:47:48 INFO  Starting execution of 1 what-if analyses...
2022-09-21 16:47:48 INFO  Start plan generation for analysis PermutationFeatureImportance...
2022-09-21 16:47:48 INFO  ---RUNTIME: Plan generation took 0.10967254638671875 ms
2022-09-21 16:47:48 INFO  Estimated runtime of original DAG is 2220.111846923828ms
2022-09-21 16:47:48 WARNING Skipping Multi-Query Optimization (instead, only applying patches)
2022-09-21 16:47:48 INFO  Estimated unoptimised what-if runtime is 13320.671081542969ms
2022-09-21 16:47:48 INFO  ---RUNTIME: Multi-Query Optimization took 4.637479782104492 ms
2022-09-21 16:47:48 INFO  Executing generated plans
2022-09-21 16:48:02 INFO  ---RUNTIME: Execution took 14021.44742012024 ms
2022-09-21 16:48:02 INFO  Done!
2022-09-21 16:48:02 INFO  # Finished -- repetition 5 of 7 
2022-09-21 16:48:02 INFO  # Optimization benchmark for feature_importance with args [['healthcare', 'slow_loading', 'featurization_1', 'neural_network']] -- repetition 6 of 7
2022-09-21 16:48:02 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-21 16:48:02 INFO  Running instrumented original pipeline...
2022-09-21 16:48:02 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-21 16:48:02 INFO  ---RUNTIME: Importing and monkey-patching took 5.820751190185547 ms
2022-09-21 16:48:04 INFO  ---RUNTIME: Original pipeline execution took 2511.8300914764404 ms (excluding imports and monkey-patching)
2022-09-21 16:48:04 INFO  Starting execution of 1 what-if analyses...
2022-09-21 16:48:04 INFO  Start plan generation for analysis PermutationFeatureImportance...
2022-09-21 16:48:04 INFO  ---RUNTIME: Plan generation took 0.19788742065429688 ms
2022-09-21 16:48:04 INFO  Estimated runtime of original DAG is 2258.2666873931885ms
2022-09-21 16:48:04 INFO  Performing Multi-Query Optimization
2022-09-21 16:48:04 INFO  Estimated unoptimized what-if runtime is 13549.60012435913ms
2022-09-21 16:48:04 INFO  Estimated optimised what-if runtime is 2538.618564605713ms
2022-09-21 16:48:04 INFO  Estimated optimisation runtime saving is 11010.981559753418ms
2022-09-21 16:48:04 INFO  ---RUNTIME: Multi-Query Optimization took 11.74473762512207 ms
2022-09-21 16:48:04 INFO  Executing generated plans
2022-09-21 16:48:07 INFO  ---RUNTIME: Execution took 2382.3020458221436 ms
2022-09-21 16:48:07 INFO  Done!
2022-09-21 16:48:07 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-21 16:48:07 INFO  Running instrumented original pipeline...
2022-09-21 16:48:07 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-21 16:48:07 INFO  ---RUNTIME: Importing and monkey-patching took 5.835294723510742 ms
2022-09-21 16:48:09 INFO  ---RUNTIME: Original pipeline execution took 2492.5267696380615 ms (excluding imports and monkey-patching)
2022-09-21 16:48:09 INFO  Starting execution of 1 what-if analyses...
2022-09-21 16:48:09 INFO  Start plan generation for analysis PermutationFeatureImportance...
2022-09-21 16:48:09 INFO  ---RUNTIME: Plan generation took 0.13780593872070312 ms
2022-09-21 16:48:09 INFO  Estimated runtime of original DAG is 2238.098382949829ms
2022-09-21 16:48:09 WARNING Skipping Multi-Query Optimization (instead, only applying patches)
2022-09-21 16:48:09 INFO  Estimated unoptimised what-if runtime is 13428.590297698975ms
2022-09-21 16:48:09 INFO  ---RUNTIME: Multi-Query Optimization took 6.542444229125977 ms
2022-09-21 16:48:09 INFO  Executing generated plans
2022-09-21 16:48:23 INFO  ---RUNTIME: Execution took 14232.905626296997 ms
2022-09-21 16:48:23 INFO  Done!
2022-09-21 16:48:23 INFO  # Finished -- repetition 6 of 7 
2022-09-21 16:48:23 INFO  # Optimization benchmark for feature_importance with args [['healthcare', 'slow_loading', 'featurization_1', 'neural_network']] -- repetition 7 of 7
2022-09-21 16:48:23 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-21 16:48:23 INFO  Running instrumented original pipeline...
2022-09-21 16:48:23 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-21 16:48:23 INFO  ---RUNTIME: Importing and monkey-patching took 6.015777587890625 ms
2022-09-21 16:48:26 INFO  ---RUNTIME: Original pipeline execution took 2549.11732673645 ms (excluding imports and monkey-patching)
2022-09-21 16:48:26 INFO  Starting execution of 1 what-if analyses...
2022-09-21 16:48:26 INFO  Start plan generation for analysis PermutationFeatureImportance...
2022-09-21 16:48:26 INFO  ---RUNTIME: Plan generation took 0.11801719665527344 ms
2022-09-21 16:48:26 INFO  Estimated runtime of original DAG is 2296.1244583129883ms
2022-09-21 16:48:26 INFO  Performing Multi-Query Optimization
2022-09-21 16:48:26 INFO  Estimated unoptimized what-if runtime is 13776.74674987793ms
2022-09-21 16:48:26 INFO  Estimated optimised what-if runtime is 2573.6563205718994ms
2022-09-21 16:48:26 INFO  Estimated optimisation runtime saving is 11203.09042930603ms
2022-09-21 16:48:26 INFO  ---RUNTIME: Multi-Query Optimization took 345.7057476043701 ms
2022-09-21 16:48:26 INFO  Executing generated plans
2022-09-21 16:48:29 INFO  ---RUNTIME: Execution took 2344.2251682281494 ms
2022-09-21 16:48:29 INFO  Done!
2022-09-21 16:48:29 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-21 16:48:29 INFO  Running instrumented original pipeline...
2022-09-21 16:48:29 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-21 16:48:29 INFO  ---RUNTIME: Importing and monkey-patching took 6.707668304443359 ms
2022-09-21 16:48:31 INFO  ---RUNTIME: Original pipeline execution took 2491.783857345581 ms (excluding imports and monkey-patching)
2022-09-21 16:48:31 INFO  Starting execution of 1 what-if analyses...
2022-09-21 16:48:31 INFO  Start plan generation for analysis PermutationFeatureImportance...
2022-09-21 16:48:31 INFO  ---RUNTIME: Plan generation took 0.10347366333007812 ms
2022-09-21 16:48:31 INFO  Estimated runtime of original DAG is 2216.6547775268555ms
2022-09-21 16:48:31 WARNING Skipping Multi-Query Optimization (instead, only applying patches)
2022-09-21 16:48:31 INFO  Estimated unoptimised what-if runtime is 13299.928665161133ms
2022-09-21 16:48:31 INFO  ---RUNTIME: Multi-Query Optimization took 4.677295684814453 ms
2022-09-21 16:48:31 INFO  Executing generated plans
2022-09-21 16:48:45 INFO  ---RUNTIME: Execution took 14114.03512954712 ms
2022-09-21 16:48:45 INFO  Done!
2022-09-21 16:48:45 INFO  # Finished -- repetition 7 of 7 
2022-09-21 16:48:45 INFO  # Final results after all repetitions
2022-09-21 16:48:45 INFO     repetition  ... no_opt_what_if_execution_combined_model_training
0           0  ...                                      2897.588491
1           1  ...                                      2960.833549
2           2  ...                                      2908.537865
3           3  ...                                      2907.592297
4           4  ...                                      2953.772783
5           5  ...                                      3027.573586
6           6  ...                                      2974.519491

[7 rows x 26 columns]
taskset -c 0-7 PROTOCOL_BUFFERS_PYTHON_IMPLEMENTATION=python python3.9 benchmarks_end_to_end.py feature_importance healthcare slow_loading featurization_2 logistic_regression
2022-09-21 16:48:48.099246: W tensorflow/stream_executor/platform/default/dso_loader.cc:64] Could not load dynamic library 'libcudart.so.11.0'; dlerror: libcudart.so.11.0: cannot open shared object file: No such file or directory; LD_LIBRARY_PATH: /home/sgrafbe/mlwhatif/venv/lib/python3.9/site-packages/cv2/../../lib64:
2022-09-21 16:48:48.099298: I tensorflow/stream_executor/cuda/cudart_stub.cc:29] Ignore above cudart dlerror if you do not have a GPU set up on your machine.
2022-09-21 16:48:49 INFO  Patching sys.argv with ['mlwhatif', 'healthcare', 'slow_loading', 'featurization_2', 'logistic_regression']
2022-09-21 16:48:49 INFO  Running instrumented original pipeline...
2022-09-21 16:48:49 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-21 16:48:49 INFO  ---RUNTIME: Importing and monkey-patching took 95.93510627746582 ms
2022-09-21 16:48:51 INFO  ---RUNTIME: Original pipeline execution took 2466.012954711914 ms (excluding imports and monkey-patching)
2022-09-21 16:48:51 INFO  Starting execution of 0 what-if analyses...
2022-09-21 16:48:51 INFO  Estimated runtime of original DAG is 2191.828489303589ms
2022-09-21 16:48:51 INFO  Performing Multi-Query Optimization
2022-09-21 16:48:51 INFO  Estimated unoptimized what-if runtime is 0ms
2022-09-21 16:48:51 INFO  Estimated optimised what-if runtime is 0ms
2022-09-21 16:48:51 INFO  Estimated optimisation runtime saving is 0ms
2022-09-21 16:48:51 INFO  ---RUNTIME: Multi-Query Optimization took 0.4673004150390625 ms
2022-09-21 16:48:51 INFO  Executing generated plans
2022-09-21 16:48:51 INFO  ---RUNTIME: Execution took 0.023126602172851562 ms
2022-09-21 16:48:51 INFO  Done!
2022-09-21 16:48:51 INFO  # Optimization benchmark for feature_importance with args [['healthcare', 'slow_loading', 'featurization_2', 'logistic_regression']] -- repetition 1 of 7
2022-09-21 16:48:51 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-21 16:48:51 INFO  Running instrumented original pipeline...
2022-09-21 16:48:51 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-21 16:48:51 INFO  ---RUNTIME: Importing and monkey-patching took 5.879640579223633 ms
2022-09-21 16:48:53 INFO  ---RUNTIME: Original pipeline execution took 2035.5606079101562 ms (excluding imports and monkey-patching)
2022-09-21 16:48:53 INFO  Starting execution of 1 what-if analyses...
2022-09-21 16:48:53 INFO  Start plan generation for analysis PermutationFeatureImportance...
2022-09-21 16:48:53 INFO  ---RUNTIME: Plan generation took 0.24580955505371094 ms
2022-09-21 16:48:53 INFO  Estimated runtime of original DAG is 1789.0453338623047ms
2022-09-21 16:48:53 INFO  Performing Multi-Query Optimization
2022-09-21 16:48:53 INFO  Estimated unoptimized what-if runtime is 10734.272003173828ms
2022-09-21 16:48:53 INFO  Estimated optimised what-if runtime is 1800.6269931793213ms
2022-09-21 16:48:53 INFO  Estimated optimisation runtime saving is 8933.645009994507ms
2022-09-21 16:48:53 INFO  ---RUNTIME: Multi-Query Optimization took 12.567281723022461 ms
2022-09-21 16:48:53 INFO  Executing generated plans
2022-09-21 16:48:55 INFO  ---RUNTIME: Execution took 1823.9398002624512 ms
2022-09-21 16:48:55 INFO  Done!
2022-09-21 16:48:55 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-21 16:48:55 INFO  Running instrumented original pipeline...
2022-09-21 16:48:56 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-21 16:48:56 INFO  ---RUNTIME: Importing and monkey-patching took 5.862712860107422 ms
2022-09-21 16:48:58 INFO  ---RUNTIME: Original pipeline execution took 2234.2333793640137 ms (excluding imports and monkey-patching)
2022-09-21 16:48:58 INFO  Starting execution of 1 what-if analyses...
2022-09-21 16:48:58 INFO  Start plan generation for analysis PermutationFeatureImportance...
2022-09-21 16:48:58 INFO  ---RUNTIME: Plan generation took 0.1811981201171875 ms
2022-09-21 16:48:58 INFO  Estimated runtime of original DAG is 1821.3837146759033ms
2022-09-21 16:48:58 WARNING Skipping Multi-Query Optimization (instead, only applying patches)
2022-09-21 16:48:58 INFO  Estimated unoptimised what-if runtime is 10928.30228805542ms
2022-09-21 16:48:58 INFO  ---RUNTIME: Multi-Query Optimization took 4.636526107788086 ms
2022-09-21 16:48:58 INFO  Executing generated plans
2022-09-21 16:49:08 INFO  ---RUNTIME: Execution took 10881.699562072754 ms
2022-09-21 16:49:08 INFO  Done!
2022-09-21 16:49:08 INFO  # Finished -- repetition 1 of 7 
2022-09-21 16:49:08 INFO  # Optimization benchmark for feature_importance with args [['healthcare', 'slow_loading', 'featurization_2', 'logistic_regression']] -- repetition 2 of 7
2022-09-21 16:49:08 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-21 16:49:08 INFO  Running instrumented original pipeline...
2022-09-21 16:49:08 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-21 16:49:08 INFO  ---RUNTIME: Importing and monkey-patching took 6.823301315307617 ms
2022-09-21 16:49:10 INFO  ---RUNTIME: Original pipeline execution took 2047.2536087036133 ms (excluding imports and monkey-patching)
2022-09-21 16:49:10 INFO  Starting execution of 1 what-if analyses...
2022-09-21 16:49:10 INFO  Start plan generation for analysis PermutationFeatureImportance...
2022-09-21 16:49:10 INFO  ---RUNTIME: Plan generation took 0.1857280731201172 ms
2022-09-21 16:49:10 INFO  Estimated runtime of original DAG is 1786.3261699676514ms
2022-09-21 16:49:10 INFO  Performing Multi-Query Optimization
2022-09-21 16:49:11 INFO  Estimated unoptimized what-if runtime is 10717.957019805908ms
2022-09-21 16:49:11 INFO  Estimated optimised what-if runtime is 1799.0624904632568ms
2022-09-21 16:49:11 INFO  Estimated optimisation runtime saving is 8918.894529342651ms
2022-09-21 16:49:11 INFO  ---RUNTIME: Multi-Query Optimization took 13.354063034057617 ms
2022-09-21 16:49:11 INFO  Executing generated plans
2022-09-21 16:49:12 INFO  ---RUNTIME: Execution took 1786.421775817871 ms
2022-09-21 16:49:12 INFO  Done!
2022-09-21 16:49:12 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-21 16:49:12 INFO  Running instrumented original pipeline...
2022-09-21 16:49:12 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-21 16:49:12 INFO  ---RUNTIME: Importing and monkey-patching took 6.749153137207031 ms
2022-09-21 16:49:14 INFO  ---RUNTIME: Original pipeline execution took 2017.7984237670898 ms (excluding imports and monkey-patching)
2022-09-21 16:49:14 INFO  Starting execution of 1 what-if analyses...
2022-09-21 16:49:14 INFO  Start plan generation for analysis PermutationFeatureImportance...
2022-09-21 16:49:14 INFO  ---RUNTIME: Plan generation took 0.47278404235839844 ms
2022-09-21 16:49:14 INFO  Estimated runtime of original DAG is 1766.2622928619385ms
2022-09-21 16:49:14 WARNING Skipping Multi-Query Optimization (instead, only applying patches)
2022-09-21 16:49:14 INFO  Estimated unoptimised what-if runtime is 10597.57375717163ms
2022-09-21 16:49:14 INFO  ---RUNTIME: Multi-Query Optimization took 4.631280899047852 ms
2022-09-21 16:49:14 INFO  Executing generated plans
2022-09-21 16:49:25 INFO  ---RUNTIME: Execution took 10945.8749294281 ms
2022-09-21 16:49:25 INFO  Done!
2022-09-21 16:49:25 INFO  # Finished -- repetition 2 of 7 
2022-09-21 16:49:25 INFO  # Optimization benchmark for feature_importance with args [['healthcare', 'slow_loading', 'featurization_2', 'logistic_regression']] -- repetition 3 of 7
2022-09-21 16:49:25 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-21 16:49:25 INFO  Running instrumented original pipeline...
2022-09-21 16:49:25 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-21 16:49:25 INFO  ---RUNTIME: Importing and monkey-patching took 6.081581115722656 ms
2022-09-21 16:49:27 INFO  ---RUNTIME: Original pipeline execution took 2026.3268947601318 ms (excluding imports and monkey-patching)
2022-09-21 16:49:27 INFO  Starting execution of 1 what-if analyses...
2022-09-21 16:49:27 INFO  Start plan generation for analysis PermutationFeatureImportance...
2022-09-21 16:49:27 INFO  ---RUNTIME: Plan generation took 0.5693435668945312 ms
2022-09-21 16:49:27 INFO  Estimated runtime of original DAG is 1778.6061763763428ms
2022-09-21 16:49:27 INFO  Performing Multi-Query Optimization
2022-09-21 16:49:27 INFO  Estimated unoptimized what-if runtime is 10671.637058258057ms
2022-09-21 16:49:27 INFO  Estimated optimised what-if runtime is 1790.2262210845947ms
2022-09-21 16:49:27 INFO  Estimated optimisation runtime saving is 8881.410837173462ms
2022-09-21 16:49:27 INFO  ---RUNTIME: Multi-Query Optimization took 12.554645538330078 ms
2022-09-21 16:49:27 INFO  Executing generated plans
2022-09-21 16:49:29 INFO  ---RUNTIME: Execution took 1798.8510131835938 ms
2022-09-21 16:49:29 INFO  Done!
2022-09-21 16:49:29 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-21 16:49:29 INFO  Running instrumented original pipeline...
2022-09-21 16:49:29 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-21 16:49:29 INFO  ---RUNTIME: Importing and monkey-patching took 5.704641342163086 ms
2022-09-21 16:49:31 INFO  ---RUNTIME: Original pipeline execution took 2022.0317840576172 ms (excluding imports and monkey-patching)
2022-09-21 16:49:31 INFO  Starting execution of 1 what-if analyses...
2022-09-21 16:49:31 INFO  Start plan generation for analysis PermutationFeatureImportance...
2022-09-21 16:49:31 INFO  ---RUNTIME: Plan generation took 0.14662742614746094 ms
2022-09-21 16:49:31 INFO  Estimated runtime of original DAG is 1777.3551940917969ms
2022-09-21 16:49:31 WARNING Skipping Multi-Query Optimization (instead, only applying patches)
2022-09-21 16:49:31 INFO  Estimated unoptimised what-if runtime is 10664.131164550781ms
2022-09-21 16:49:31 INFO  ---RUNTIME: Multi-Query Optimization took 4.543781280517578 ms
2022-09-21 16:49:31 INFO  Executing generated plans
2022-09-21 16:49:42 INFO  ---RUNTIME: Execution took 10703.06658744812 ms
2022-09-21 16:49:42 INFO  Done!
2022-09-21 16:49:42 INFO  # Finished -- repetition 3 of 7 
2022-09-21 16:49:42 INFO  # Optimization benchmark for feature_importance with args [['healthcare', 'slow_loading', 'featurization_2', 'logistic_regression']] -- repetition 4 of 7
2022-09-21 16:49:42 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-21 16:49:42 INFO  Running instrumented original pipeline...
2022-09-21 16:49:42 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-21 16:49:42 INFO  ---RUNTIME: Importing and monkey-patching took 6.295680999755859 ms
2022-09-21 16:49:44 INFO  ---RUNTIME: Original pipeline execution took 2198.0907917022705 ms (excluding imports and monkey-patching)
2022-09-21 16:49:44 INFO  Starting execution of 1 what-if analyses...
2022-09-21 16:49:44 INFO  Start plan generation for analysis PermutationFeatureImportance...
2022-09-21 16:49:44 INFO  ---RUNTIME: Plan generation took 0.29921531677246094 ms
2022-09-21 16:49:44 INFO  Estimated runtime of original DAG is 1756.4103603363037ms
2022-09-21 16:49:44 INFO  Performing Multi-Query Optimization
2022-09-21 16:49:44 INFO  Estimated unoptimized what-if runtime is 10538.462162017822ms
2022-09-21 16:49:44 INFO  Estimated optimised what-if runtime is 1767.7159309387207ms
2022-09-21 16:49:44 INFO  Estimated optimisation runtime saving is 8770.746231079102ms
2022-09-21 16:49:44 INFO  ---RUNTIME: Multi-Query Optimization took 12.243986129760742 ms
2022-09-21 16:49:44 INFO  Executing generated plans
2022-09-21 16:49:46 INFO  ---RUNTIME: Execution took 1803.2636642456055 ms
2022-09-21 16:49:46 INFO  Done!
2022-09-21 16:49:46 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-21 16:49:46 INFO  Running instrumented original pipeline...
2022-09-21 16:49:46 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-21 16:49:46 INFO  ---RUNTIME: Importing and monkey-patching took 5.8612823486328125 ms
2022-09-21 16:49:48 INFO  ---RUNTIME: Original pipeline execution took 2005.4078102111816 ms (excluding imports and monkey-patching)
2022-09-21 16:49:48 INFO  Starting execution of 1 what-if analyses...
2022-09-21 16:49:48 INFO  Start plan generation for analysis PermutationFeatureImportance...
2022-09-21 16:49:48 INFO  ---RUNTIME: Plan generation took 0.1423358917236328 ms
2022-09-21 16:49:48 INFO  Estimated runtime of original DAG is 1756.3941478729248ms
2022-09-21 16:49:48 WARNING Skipping Multi-Query Optimization (instead, only applying patches)
2022-09-21 16:49:48 INFO  Estimated unoptimised what-if runtime is 10538.364887237549ms
2022-09-21 16:49:48 INFO  ---RUNTIME: Multi-Query Optimization took 4.637479782104492 ms
2022-09-21 16:49:48 INFO  Executing generated plans
2022-09-21 16:49:59 INFO  ---RUNTIME: Execution took 10681.198120117188 ms
2022-09-21 16:49:59 INFO  Done!
2022-09-21 16:49:59 INFO  # Finished -- repetition 4 of 7 
2022-09-21 16:49:59 INFO  # Optimization benchmark for feature_importance with args [['healthcare', 'slow_loading', 'featurization_2', 'logistic_regression']] -- repetition 5 of 7
2022-09-21 16:49:59 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-21 16:49:59 INFO  Running instrumented original pipeline...
2022-09-21 16:49:59 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-21 16:49:59 INFO  ---RUNTIME: Importing and monkey-patching took 5.708932876586914 ms
2022-09-21 16:50:01 INFO  ---RUNTIME: Original pipeline execution took 2015.411376953125 ms (excluding imports and monkey-patching)
2022-09-21 16:50:01 INFO  Starting execution of 1 what-if analyses...
2022-09-21 16:50:01 INFO  Start plan generation for analysis PermutationFeatureImportance...
2022-09-21 16:50:01 INFO  ---RUNTIME: Plan generation took 0.15020370483398438 ms
2022-09-21 16:50:01 INFO  Estimated runtime of original DAG is 1769.8781490325928ms
2022-09-21 16:50:01 INFO  Performing Multi-Query Optimization
2022-09-21 16:50:01 INFO  Estimated unoptimized what-if runtime is 10619.268894195557ms
2022-09-21 16:50:01 INFO  Estimated optimised what-if runtime is 1781.3489437103271ms
2022-09-21 16:50:01 INFO  Estimated optimisation runtime saving is 8837.91995048523ms
2022-09-21 16:50:01 INFO  ---RUNTIME: Multi-Query Optimization took 12.723684310913086 ms
2022-09-21 16:50:01 INFO  Executing generated plans
2022-09-21 16:50:02 INFO  ---RUNTIME: Execution took 1807.7623844146729 ms
2022-09-21 16:50:02 INFO  Done!
2022-09-21 16:50:02 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-21 16:50:02 INFO  Running instrumented original pipeline...
2022-09-21 16:50:02 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-21 16:50:02 INFO  ---RUNTIME: Importing and monkey-patching took 5.958080291748047 ms
2022-09-21 16:50:04 INFO  ---RUNTIME: Original pipeline execution took 2012.7553939819336 ms (excluding imports and monkey-patching)
2022-09-21 16:50:04 INFO  Starting execution of 1 what-if analyses...
2022-09-21 16:50:04 INFO  Start plan generation for analysis PermutationFeatureImportance...
2022-09-21 16:50:04 INFO  ---RUNTIME: Plan generation took 0.17404556274414062 ms
2022-09-21 16:50:04 INFO  Estimated runtime of original DAG is 1768.237829208374ms
2022-09-21 16:50:04 WARNING Skipping Multi-Query Optimization (instead, only applying patches)
2022-09-21 16:50:04 INFO  Estimated unoptimised what-if runtime is 10609.426975250244ms
2022-09-21 16:50:04 INFO  ---RUNTIME: Multi-Query Optimization took 4.66465950012207 ms
2022-09-21 16:50:04 INFO  Executing generated plans
2022-09-21 16:50:15 INFO  ---RUNTIME: Execution took 10683.9759349823 ms
2022-09-21 16:50:15 INFO  Done!
2022-09-21 16:50:15 INFO  # Finished -- repetition 5 of 7 
2022-09-21 16:50:15 INFO  # Optimization benchmark for feature_importance with args [['healthcare', 'slow_loading', 'featurization_2', 'logistic_regression']] -- repetition 6 of 7
2022-09-21 16:50:15 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-21 16:50:15 INFO  Running instrumented original pipeline...
2022-09-21 16:50:15 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-21 16:50:15 INFO  ---RUNTIME: Importing and monkey-patching took 5.624055862426758 ms
2022-09-21 16:50:17 INFO  ---RUNTIME: Original pipeline execution took 2022.3572254180908 ms (excluding imports and monkey-patching)
2022-09-21 16:50:17 INFO  Starting execution of 1 what-if analyses...
2022-09-21 16:50:17 INFO  Start plan generation for analysis PermutationFeatureImportance...
2022-09-21 16:50:17 INFO  ---RUNTIME: Plan generation took 0.1537799835205078 ms
2022-09-21 16:50:17 INFO  Estimated runtime of original DAG is 1779.33931350708ms
2022-09-21 16:50:17 INFO  Performing Multi-Query Optimization
2022-09-21 16:50:17 INFO  Estimated unoptimized what-if runtime is 10676.03588104248ms
2022-09-21 16:50:17 INFO  Estimated optimised what-if runtime is 1790.7366752624512ms
2022-09-21 16:50:17 INFO  Estimated optimisation runtime saving is 8885.29920578003ms
2022-09-21 16:50:17 INFO  ---RUNTIME: Multi-Query Optimization took 12.582540512084961 ms
2022-09-21 16:50:17 INFO  Executing generated plans
2022-09-21 16:50:19 INFO  ---RUNTIME: Execution took 1807.4848651885986 ms
2022-09-21 16:50:19 INFO  Done!
2022-09-21 16:50:19 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-21 16:50:19 INFO  Running instrumented original pipeline...
2022-09-21 16:50:19 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-21 16:50:19 INFO  ---RUNTIME: Importing and monkey-patching took 5.712985992431641 ms
2022-09-21 16:50:21 INFO  ---RUNTIME: Original pipeline execution took 1987.8168106079102 ms (excluding imports and monkey-patching)
2022-09-21 16:50:21 INFO  Starting execution of 1 what-if analyses...
2022-09-21 16:50:21 INFO  Start plan generation for analysis PermutationFeatureImportance...
2022-09-21 16:50:21 INFO  ---RUNTIME: Plan generation took 0.11086463928222656 ms
2022-09-21 16:50:21 INFO  Estimated runtime of original DAG is 1743.110179901123ms
2022-09-21 16:50:21 WARNING Skipping Multi-Query Optimization (instead, only applying patches)
2022-09-21 16:50:21 INFO  Estimated unoptimised what-if runtime is 10458.661079406738ms
2022-09-21 16:50:21 INFO  ---RUNTIME: Multi-Query Optimization took 5.082845687866211 ms
2022-09-21 16:50:21 INFO  Executing generated plans
2022-09-21 16:50:32 INFO  ---RUNTIME: Execution took 10781.703472137451 ms
2022-09-21 16:50:32 INFO  Done!
2022-09-21 16:50:32 INFO  # Finished -- repetition 6 of 7 
2022-09-21 16:50:32 INFO  # Optimization benchmark for feature_importance with args [['healthcare', 'slow_loading', 'featurization_2', 'logistic_regression']] -- repetition 7 of 7
2022-09-21 16:50:32 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-21 16:50:32 INFO  Running instrumented original pipeline...
2022-09-21 16:50:32 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-21 16:50:32 INFO  ---RUNTIME: Importing and monkey-patching took 5.800008773803711 ms
2022-09-21 16:50:34 INFO  ---RUNTIME: Original pipeline execution took 2229.4921875 ms (excluding imports and monkey-patching)
2022-09-21 16:50:34 INFO  Starting execution of 1 what-if analyses...
2022-09-21 16:50:34 INFO  Start plan generation for analysis PermutationFeatureImportance...
2022-09-21 16:50:34 INFO  ---RUNTIME: Plan generation took 0.20051002502441406 ms
2022-09-21 16:50:34 INFO  Estimated runtime of original DAG is 1779.1600227355957ms
2022-09-21 16:50:34 INFO  Performing Multi-Query Optimization
2022-09-21 16:50:34 INFO  Estimated unoptimized what-if runtime is 10674.960136413574ms
2022-09-21 16:50:34 INFO  Estimated optimised what-if runtime is 1790.9533977508545ms
2022-09-21 16:50:34 INFO  Estimated optimisation runtime saving is 8884.00673866272ms
2022-09-21 16:50:34 INFO  ---RUNTIME: Multi-Query Optimization took 12.627363204956055 ms
2022-09-21 16:50:34 INFO  Executing generated plans
2022-09-21 16:50:36 INFO  ---RUNTIME: Execution took 1796.9975471496582 ms
2022-09-21 16:50:36 INFO  Done!
2022-09-21 16:50:36 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-21 16:50:36 INFO  Running instrumented original pipeline...
2022-09-21 16:50:36 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-21 16:50:36 INFO  ---RUNTIME: Importing and monkey-patching took 5.702018737792969 ms
2022-09-21 16:50:38 INFO  ---RUNTIME: Original pipeline execution took 2019.4087028503418 ms (excluding imports and monkey-patching)
2022-09-21 16:50:38 INFO  Starting execution of 1 what-if analyses...
2022-09-21 16:50:38 INFO  Start plan generation for analysis PermutationFeatureImportance...
2022-09-21 16:50:38 INFO  ---RUNTIME: Plan generation took 0.48089027404785156 ms
2022-09-21 16:50:38 INFO  Estimated runtime of original DAG is 1775.6340503692627ms
2022-09-21 16:50:38 WARNING Skipping Multi-Query Optimization (instead, only applying patches)
2022-09-21 16:50:38 INFO  Estimated unoptimised what-if runtime is 10653.804302215576ms
2022-09-21 16:50:38 INFO  ---RUNTIME: Multi-Query Optimization took 4.558086395263672 ms
2022-09-21 16:50:38 INFO  Executing generated plans
2022-09-21 16:50:49 INFO  ---RUNTIME: Execution took 10699.501991271973 ms
2022-09-21 16:50:49 INFO  Done!
2022-09-21 16:50:49 INFO  # Finished -- repetition 7 of 7 
2022-09-21 16:50:49 INFO  # Final results after all repetitions
2022-09-21 16:50:49 INFO     repetition  ... no_opt_what_if_execution_combined_model_training
0           0  ...                                         6.011963
1           1  ...                                         5.835295
2           2  ...                                         6.068230
3           3  ...                                         6.001711
4           4  ...                                         5.937338
5           5  ...                                         5.925417
6           6  ...                                         5.952597

[7 rows x 26 columns]
taskset -c 0-7 PROTOCOL_BUFFERS_PYTHON_IMPLEMENTATION=python python3.9 benchmarks_end_to_end.py feature_importance healthcare slow_loading featurization_2 xgboost
2022-09-21 16:50:51.058741: W tensorflow/stream_executor/platform/default/dso_loader.cc:64] Could not load dynamic library 'libcudart.so.11.0'; dlerror: libcudart.so.11.0: cannot open shared object file: No such file or directory; LD_LIBRARY_PATH: /home/sgrafbe/mlwhatif/venv/lib/python3.9/site-packages/cv2/../../lib64:
2022-09-21 16:50:51.058786: I tensorflow/stream_executor/cuda/cudart_stub.cc:29] Ignore above cudart dlerror if you do not have a GPU set up on your machine.
2022-09-21 16:50:52 INFO  Patching sys.argv with ['mlwhatif', 'healthcare', 'slow_loading', 'featurization_2', 'xgboost']
2022-09-21 16:50:52 INFO  Running instrumented original pipeline...
2022-09-21 16:50:52 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-21 16:50:52 INFO  ---RUNTIME: Importing and monkey-patching took 95.40581703186035 ms
2022-09-21 16:50:54 INFO  ---RUNTIME: Original pipeline execution took 2285.4762077331543 ms (excluding imports and monkey-patching)
2022-09-21 16:50:54 INFO  Starting execution of 0 what-if analyses...
2022-09-21 16:50:54 INFO  Estimated runtime of original DAG is 2026.1852741241455ms
2022-09-21 16:50:54 INFO  Performing Multi-Query Optimization
2022-09-21 16:50:54 INFO  Estimated unoptimized what-if runtime is 0ms
2022-09-21 16:50:54 INFO  Estimated optimised what-if runtime is 0ms
2022-09-21 16:50:54 INFO  Estimated optimisation runtime saving is 0ms
2022-09-21 16:50:54 INFO  ---RUNTIME: Multi-Query Optimization took 0.45680999755859375 ms
2022-09-21 16:50:54 INFO  Executing generated plans
2022-09-21 16:50:54 INFO  ---RUNTIME: Execution took 0.023603439331054688 ms
2022-09-21 16:50:54 INFO  Done!
2022-09-21 16:50:54 INFO  # Optimization benchmark for feature_importance with args [['healthcare', 'slow_loading', 'featurization_2', 'xgboost']] -- repetition 1 of 7
2022-09-21 16:50:54 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-21 16:50:54 INFO  Running instrumented original pipeline...
2022-09-21 16:50:54 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-21 16:50:54 INFO  ---RUNTIME: Importing and monkey-patching took 5.999088287353516 ms
2022-09-21 16:50:56 INFO  ---RUNTIME: Original pipeline execution took 2183.0663681030273 ms (excluding imports and monkey-patching)
2022-09-21 16:50:56 INFO  Starting execution of 1 what-if analyses...
2022-09-21 16:50:56 INFO  Start plan generation for analysis PermutationFeatureImportance...
2022-09-21 16:50:56 INFO  ---RUNTIME: Plan generation took 0.23412704467773438 ms
2022-09-21 16:50:56 INFO  Estimated runtime of original DAG is 1953.211784362793ms
2022-09-21 16:50:56 INFO  Performing Multi-Query Optimization
2022-09-21 16:50:56 INFO  Estimated unoptimized what-if runtime is 11719.270706176758ms
2022-09-21 16:50:56 INFO  Estimated optimised what-if runtime is 1972.4125862121582ms
2022-09-21 16:50:56 INFO  Estimated optimisation runtime saving is 9746.8581199646ms
2022-09-21 16:50:56 INFO  ---RUNTIME: Multi-Query Optimization took 12.354373931884766 ms
2022-09-21 16:50:56 INFO  Executing generated plans
2022-09-21 16:50:58 INFO  ---RUNTIME: Execution took 1990.6857013702393 ms
2022-09-21 16:50:58 INFO  Done!
2022-09-21 16:50:58 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-21 16:50:58 INFO  Running instrumented original pipeline...
2022-09-21 16:50:59 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-21 16:50:59 INFO  ---RUNTIME: Importing and monkey-patching took 5.782842636108398 ms
2022-09-21 16:51:01 INFO  ---RUNTIME: Original pipeline execution took 2401.5355110168457 ms (excluding imports and monkey-patching)
2022-09-21 16:51:01 INFO  Starting execution of 1 what-if analyses...
2022-09-21 16:51:01 INFO  Start plan generation for analysis PermutationFeatureImportance...
2022-09-21 16:51:01 INFO  ---RUNTIME: Plan generation took 0.14066696166992188 ms
2022-09-21 16:51:01 INFO  Estimated runtime of original DAG is 2011.0580921173096ms
2022-09-21 16:51:01 WARNING Skipping Multi-Query Optimization (instead, only applying patches)
2022-09-21 16:51:01 INFO  Estimated unoptimised what-if runtime is 12066.348552703857ms
2022-09-21 16:51:01 INFO  ---RUNTIME: Multi-Query Optimization took 4.562139511108398 ms
2022-09-21 16:51:01 INFO  Executing generated plans
2022-09-21 16:51:13 INFO  ---RUNTIME: Execution took 11833.852767944336 ms
2022-09-21 16:51:13 INFO  Done!
2022-09-21 16:51:13 INFO  # Finished -- repetition 1 of 7 
2022-09-21 16:51:13 INFO  # Optimization benchmark for feature_importance with args [['healthcare', 'slow_loading', 'featurization_2', 'xgboost']] -- repetition 2 of 7
2022-09-21 16:51:13 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-21 16:51:13 INFO  Running instrumented original pipeline...
2022-09-21 16:51:13 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-21 16:51:13 INFO  ---RUNTIME: Importing and monkey-patching took 5.797386169433594 ms
2022-09-21 16:51:15 INFO  ---RUNTIME: Original pipeline execution took 2173.5849380493164 ms (excluding imports and monkey-patching)
2022-09-21 16:51:15 INFO  Starting execution of 1 what-if analyses...
2022-09-21 16:51:15 INFO  Start plan generation for analysis PermutationFeatureImportance...
2022-09-21 16:51:15 INFO  ---RUNTIME: Plan generation took 0.20051002502441406 ms
2022-09-21 16:51:15 INFO  Estimated runtime of original DAG is 1945.207118988037ms
2022-09-21 16:51:15 INFO  Performing Multi-Query Optimization
2022-09-21 16:51:15 INFO  Estimated unoptimized what-if runtime is 11671.242713928223ms
2022-09-21 16:51:15 INFO  Estimated optimised what-if runtime is 1964.4527435302734ms
2022-09-21 16:51:15 INFO  Estimated optimisation runtime saving is 9706.78997039795ms
2022-09-21 16:51:15 INFO  ---RUNTIME: Multi-Query Optimization took 12.247562408447266 ms
2022-09-21 16:51:15 INFO  Executing generated plans
2022-09-21 16:51:17 INFO  ---RUNTIME: Execution took 1982.4087619781494 ms
2022-09-21 16:51:17 INFO  Done!
2022-09-21 16:51:17 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-21 16:51:17 INFO  Running instrumented original pipeline...
2022-09-21 16:51:17 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-21 16:51:17 INFO  ---RUNTIME: Importing and monkey-patching took 5.622625350952148 ms
2022-09-21 16:51:19 INFO  ---RUNTIME: Original pipeline execution took 2224.705934524536 ms (excluding imports and monkey-patching)
2022-09-21 16:51:19 INFO  Starting execution of 1 what-if analyses...
2022-09-21 16:51:19 INFO  Start plan generation for analysis PermutationFeatureImportance...
2022-09-21 16:51:19 INFO  ---RUNTIME: Plan generation took 0.18310546875 ms
2022-09-21 16:51:19 INFO  Estimated runtime of original DAG is 1992.2432899475098ms
2022-09-21 16:51:19 WARNING Skipping Multi-Query Optimization (instead, only applying patches)
2022-09-21 16:51:19 INFO  Estimated unoptimised what-if runtime is 11953.459739685059ms
2022-09-21 16:51:19 INFO  ---RUNTIME: Multi-Query Optimization took 4.584550857543945 ms
2022-09-21 16:51:19 INFO  Executing generated plans
2022-09-21 16:51:31 INFO  ---RUNTIME: Execution took 11995.65601348877 ms
2022-09-21 16:51:31 INFO  Done!
2022-09-21 16:51:31 INFO  # Finished -- repetition 2 of 7 
2022-09-21 16:51:31 INFO  # Optimization benchmark for feature_importance with args [['healthcare', 'slow_loading', 'featurization_2', 'xgboost']] -- repetition 3 of 7
2022-09-21 16:51:31 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-21 16:51:31 INFO  Running instrumented original pipeline...
2022-09-21 16:51:31 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-21 16:51:31 INFO  ---RUNTIME: Importing and monkey-patching took 6.122589111328125 ms
2022-09-21 16:51:33 INFO  ---RUNTIME: Original pipeline execution took 2141.388416290283 ms (excluding imports and monkey-patching)
2022-09-21 16:51:33 INFO  Starting execution of 1 what-if analyses...
2022-09-21 16:51:33 INFO  Start plan generation for analysis PermutationFeatureImportance...
2022-09-21 16:51:33 INFO  ---RUNTIME: Plan generation took 0.1862049102783203 ms
2022-09-21 16:51:33 INFO  Estimated runtime of original DAG is 1911.794900894165ms
2022-09-21 16:51:33 INFO  Performing Multi-Query Optimization
2022-09-21 16:51:33 INFO  Estimated unoptimized what-if runtime is 11470.76940536499ms
2022-09-21 16:51:33 INFO  Estimated optimised what-if runtime is 1931.8962097167969ms
2022-09-21 16:51:33 INFO  Estimated optimisation runtime saving is 9538.873195648193ms
2022-09-21 16:51:33 INFO  ---RUNTIME: Multi-Query Optimization took 12.388229370117188 ms
2022-09-21 16:51:33 INFO  Executing generated plans
2022-09-21 16:51:35 INFO  ---RUNTIME: Execution took 1984.1206073760986 ms
2022-09-21 16:51:35 INFO  Done!
2022-09-21 16:51:35 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-21 16:51:35 INFO  Running instrumented original pipeline...
2022-09-21 16:51:35 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-21 16:51:35 INFO  ---RUNTIME: Importing and monkey-patching took 5.765676498413086 ms
2022-09-21 16:51:37 INFO  ---RUNTIME: Original pipeline execution took 2235.840320587158 ms (excluding imports and monkey-patching)
2022-09-21 16:51:37 INFO  Starting execution of 1 what-if analyses...
2022-09-21 16:51:37 INFO  Start plan generation for analysis PermutationFeatureImportance...
2022-09-21 16:51:37 INFO  ---RUNTIME: Plan generation took 0.16427040100097656 ms
2022-09-21 16:51:37 INFO  Estimated runtime of original DAG is 2006.9396495819092ms
2022-09-21 16:51:37 WARNING Skipping Multi-Query Optimization (instead, only applying patches)
2022-09-21 16:51:37 INFO  Estimated unoptimised what-if runtime is 12041.637897491455ms
2022-09-21 16:51:37 INFO  ---RUNTIME: Multi-Query Optimization took 4.630565643310547 ms
2022-09-21 16:51:37 INFO  Executing generated plans
2022-09-21 16:51:49 INFO  ---RUNTIME: Execution took 11794.150114059448 ms
2022-09-21 16:51:49 INFO  Done!
2022-09-21 16:51:49 INFO  # Finished -- repetition 3 of 7 
2022-09-21 16:51:49 INFO  # Optimization benchmark for feature_importance with args [['healthcare', 'slow_loading', 'featurization_2', 'xgboost']] -- repetition 4 of 7
2022-09-21 16:51:49 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-21 16:51:49 INFO  Running instrumented original pipeline...
2022-09-21 16:51:49 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-21 16:51:49 INFO  ---RUNTIME: Importing and monkey-patching took 6.595611572265625 ms
2022-09-21 16:51:52 INFO  ---RUNTIME: Original pipeline execution took 2380.0251483917236 ms (excluding imports and monkey-patching)
2022-09-21 16:51:52 INFO  Starting execution of 1 what-if analyses...
2022-09-21 16:51:52 INFO  Start plan generation for analysis PermutationFeatureImportance...
2022-09-21 16:51:52 INFO  ---RUNTIME: Plan generation took 0.1533031463623047 ms
2022-09-21 16:51:52 INFO  Estimated runtime of original DAG is 1944.390058517456ms
2022-09-21 16:51:52 INFO  Performing Multi-Query Optimization
2022-09-21 16:51:52 INFO  Estimated unoptimized what-if runtime is 11666.340351104736ms
2022-09-21 16:51:52 INFO  Estimated optimised what-if runtime is 1963.8421535491943ms
2022-09-21 16:51:52 INFO  Estimated optimisation runtime saving is 9702.498197555542ms
2022-09-21 16:51:52 INFO  ---RUNTIME: Multi-Query Optimization took 12.101888656616211 ms
2022-09-21 16:51:52 INFO  Executing generated plans
2022-09-21 16:51:54 INFO  ---RUNTIME: Execution took 1985.7888221740723 ms
2022-09-21 16:51:54 INFO  Done!
2022-09-21 16:51:54 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-21 16:51:54 INFO  Running instrumented original pipeline...
2022-09-21 16:51:54 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-21 16:51:54 INFO  ---RUNTIME: Importing and monkey-patching took 5.674600601196289 ms
2022-09-21 16:51:56 INFO  ---RUNTIME: Original pipeline execution took 2179.978847503662 ms (excluding imports and monkey-patching)
2022-09-21 16:51:56 INFO  Starting execution of 1 what-if analyses...
2022-09-21 16:51:56 INFO  Start plan generation for analysis PermutationFeatureImportance...
2022-09-21 16:51:56 INFO  ---RUNTIME: Plan generation took 0.1609325408935547 ms
2022-09-21 16:51:56 INFO  Estimated runtime of original DAG is 1949.2640495300293ms
2022-09-21 16:51:56 WARNING Skipping Multi-Query Optimization (instead, only applying patches)
2022-09-21 16:51:56 INFO  Estimated unoptimised what-if runtime is 11695.584297180176ms
2022-09-21 16:51:56 INFO  ---RUNTIME: Multi-Query Optimization took 4.638671875 ms
2022-09-21 16:51:56 INFO  Executing generated plans
2022-09-21 16:52:08 INFO  ---RUNTIME: Execution took 11793.997764587402 ms
2022-09-21 16:52:08 INFO  Done!
2022-09-21 16:52:08 INFO  # Finished -- repetition 4 of 7 
2022-09-21 16:52:08 INFO  # Optimization benchmark for feature_importance with args [['healthcare', 'slow_loading', 'featurization_2', 'xgboost']] -- repetition 5 of 7
2022-09-21 16:52:08 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-21 16:52:08 INFO  Running instrumented original pipeline...
2022-09-21 16:52:08 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-21 16:52:08 INFO  ---RUNTIME: Importing and monkey-patching took 5.934476852416992 ms
2022-09-21 16:52:10 INFO  ---RUNTIME: Original pipeline execution took 2170.3174114227295 ms (excluding imports and monkey-patching)
2022-09-21 16:52:10 INFO  Starting execution of 1 what-if analyses...
2022-09-21 16:52:10 INFO  Start plan generation for analysis PermutationFeatureImportance...
2022-09-21 16:52:10 INFO  ---RUNTIME: Plan generation took 0.15807151794433594 ms
2022-09-21 16:52:10 INFO  Estimated runtime of original DAG is 1942.392349243164ms
2022-09-21 16:52:10 INFO  Performing Multi-Query Optimization
2022-09-21 16:52:10 INFO  Estimated unoptimized what-if runtime is 11654.354095458984ms
2022-09-21 16:52:10 INFO  Estimated optimised what-if runtime is 1961.3041877746582ms
2022-09-21 16:52:10 INFO  Estimated optimisation runtime saving is 9693.049907684326ms
2022-09-21 16:52:10 INFO  ---RUNTIME: Multi-Query Optimization took 12.488365173339844 ms
2022-09-21 16:52:10 INFO  Executing generated plans
2022-09-21 16:52:12 INFO  ---RUNTIME: Execution took 1963.4058475494385 ms
2022-09-21 16:52:12 INFO  Done!
2022-09-21 16:52:12 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-21 16:52:12 INFO  Running instrumented original pipeline...
2022-09-21 16:52:12 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-21 16:52:12 INFO  ---RUNTIME: Importing and monkey-patching took 5.699634552001953 ms
2022-09-21 16:52:14 INFO  ---RUNTIME: Original pipeline execution took 2170.1014041900635 ms (excluding imports and monkey-patching)
2022-09-21 16:52:14 INFO  Starting execution of 1 what-if analyses...
2022-09-21 16:52:14 INFO  Start plan generation for analysis PermutationFeatureImportance...
2022-09-21 16:52:14 INFO  ---RUNTIME: Plan generation took 0.15974044799804688 ms
2022-09-21 16:52:14 INFO  Estimated runtime of original DAG is 1940.4675960540771ms
2022-09-21 16:52:14 WARNING Skipping Multi-Query Optimization (instead, only applying patches)
2022-09-21 16:52:14 INFO  Estimated unoptimised what-if runtime is 11642.805576324463ms
2022-09-21 16:52:14 INFO  ---RUNTIME: Multi-Query Optimization took 4.643678665161133 ms
2022-09-21 16:52:14 INFO  Executing generated plans
2022-09-21 16:52:26 INFO  ---RUNTIME: Execution took 11840.715408325195 ms
2022-09-21 16:52:26 INFO  Done!
2022-09-21 16:52:26 INFO  # Finished -- repetition 5 of 7 
2022-09-21 16:52:26 INFO  # Optimization benchmark for feature_importance with args [['healthcare', 'slow_loading', 'featurization_2', 'xgboost']] -- repetition 6 of 7
2022-09-21 16:52:26 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-21 16:52:26 INFO  Running instrumented original pipeline...
2022-09-21 16:52:26 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-21 16:52:26 INFO  ---RUNTIME: Importing and monkey-patching took 5.922079086303711 ms
2022-09-21 16:52:28 INFO  ---RUNTIME: Original pipeline execution took 2168.5683727264404 ms (excluding imports and monkey-patching)
2022-09-21 16:52:28 INFO  Starting execution of 1 what-if analyses...
2022-09-21 16:52:28 INFO  Start plan generation for analysis PermutationFeatureImportance...
2022-09-21 16:52:28 INFO  ---RUNTIME: Plan generation took 0.15687942504882812 ms
2022-09-21 16:52:28 INFO  Estimated runtime of original DAG is 1940.7055377960205ms
2022-09-21 16:52:28 INFO  Performing Multi-Query Optimization
2022-09-21 16:52:28 INFO  Estimated unoptimized what-if runtime is 11644.233226776123ms
2022-09-21 16:52:28 INFO  Estimated optimised what-if runtime is 1960.0043296813965ms
2022-09-21 16:52:28 INFO  Estimated optimisation runtime saving is 9684.228897094727ms
2022-09-21 16:52:28 INFO  ---RUNTIME: Multi-Query Optimization took 12.23897933959961 ms
2022-09-21 16:52:28 INFO  Executing generated plans
2022-09-21 16:52:30 INFO  ---RUNTIME: Execution took 1981.8623065948486 ms
2022-09-21 16:52:30 INFO  Done!
2022-09-21 16:52:30 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-21 16:52:30 INFO  Running instrumented original pipeline...
2022-09-21 16:52:30 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-21 16:52:30 INFO  ---RUNTIME: Importing and monkey-patching took 5.670785903930664 ms
2022-09-21 16:52:32 INFO  ---RUNTIME: Original pipeline execution took 2164.970874786377 ms (excluding imports and monkey-patching)
2022-09-21 16:52:32 INFO  Starting execution of 1 what-if analyses...
2022-09-21 16:52:32 INFO  Start plan generation for analysis PermutationFeatureImportance...
2022-09-21 16:52:32 INFO  ---RUNTIME: Plan generation took 0.10395050048828125 ms
2022-09-21 16:52:32 INFO  Estimated runtime of original DAG is 1937.6287460327148ms
2022-09-21 16:52:32 WARNING Skipping Multi-Query Optimization (instead, only applying patches)
2022-09-21 16:52:32 INFO  Estimated unoptimised what-if runtime is 11625.772476196289ms
2022-09-21 16:52:32 INFO  ---RUNTIME: Multi-Query Optimization took 4.655599594116211 ms
2022-09-21 16:52:32 INFO  Executing generated plans
2022-09-21 16:52:44 INFO  ---RUNTIME: Execution took 12021.625518798828 ms
2022-09-21 16:52:44 INFO  Done!
2022-09-21 16:52:44 INFO  # Finished -- repetition 6 of 7 
2022-09-21 16:52:44 INFO  # Optimization benchmark for feature_importance with args [['healthcare', 'slow_loading', 'featurization_2', 'xgboost']] -- repetition 7 of 7
2022-09-21 16:52:44 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-21 16:52:44 INFO  Running instrumented original pipeline...
2022-09-21 16:52:44 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-21 16:52:44 INFO  ---RUNTIME: Importing and monkey-patching took 5.825042724609375 ms
2022-09-21 16:52:46 INFO  ---RUNTIME: Original pipeline execution took 2182.6865673065186 ms (excluding imports and monkey-patching)
2022-09-21 16:52:46 INFO  Starting execution of 1 what-if analyses...
2022-09-21 16:52:46 INFO  Start plan generation for analysis PermutationFeatureImportance...
2022-09-21 16:52:46 INFO  ---RUNTIME: Plan generation took 0.16880035400390625 ms
2022-09-21 16:52:46 INFO  Estimated runtime of original DAG is 1953.7744522094727ms
2022-09-21 16:52:46 INFO  Performing Multi-Query Optimization
2022-09-21 16:52:46 INFO  Estimated unoptimized what-if runtime is 11722.646713256836ms
2022-09-21 16:52:46 INFO  Estimated optimised what-if runtime is 1973.1647968292236ms
2022-09-21 16:52:46 INFO  Estimated optimisation runtime saving is 9749.481916427612ms
2022-09-21 16:52:46 INFO  ---RUNTIME: Multi-Query Optimization took 12.25423812866211 ms
2022-09-21 16:52:46 INFO  Executing generated plans
2022-09-21 16:52:48 INFO  ---RUNTIME: Execution took 1962.5723361968994 ms
2022-09-21 16:52:48 INFO  Done!
2022-09-21 16:52:48 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-21 16:52:48 INFO  Running instrumented original pipeline...
2022-09-21 16:52:48 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-21 16:52:48 INFO  ---RUNTIME: Importing and monkey-patching took 5.834102630615234 ms
2022-09-21 16:52:51 INFO  ---RUNTIME: Original pipeline execution took 2234.7800731658936 ms (excluding imports and monkey-patching)
2022-09-21 16:52:51 INFO  Starting execution of 1 what-if analyses...
2022-09-21 16:52:51 INFO  Start plan generation for analysis PermutationFeatureImportance...
2022-09-21 16:52:51 INFO  ---RUNTIME: Plan generation took 0.18477439880371094 ms
2022-09-21 16:52:51 INFO  Estimated runtime of original DAG is 2006.2694549560547ms
2022-09-21 16:52:51 WARNING Skipping Multi-Query Optimization (instead, only applying patches)
2022-09-21 16:52:51 INFO  Estimated unoptimised what-if runtime is 12037.616729736328ms
2022-09-21 16:52:51 INFO  ---RUNTIME: Multi-Query Optimization took 4.634380340576172 ms
2022-09-21 16:52:51 INFO  Executing generated plans
2022-09-21 16:53:02 INFO  ---RUNTIME: Execution took 11722.00345993042 ms
2022-09-21 16:53:02 INFO  Done!
2022-09-21 16:53:02 INFO  # Finished -- repetition 7 of 7 
2022-09-21 16:53:02 INFO  # Final results after all repetitions
2022-09-21 16:53:02 INFO     repetition  ... no_opt_what_if_execution_combined_model_training
0           0  ...                                      1126.876593
1           1  ...                                      1293.449402
2           2  ...                                      1105.102539
3           3  ...                                      1114.590883
4           4  ...                                      1152.044773
5           5  ...                                      1109.512329
6           6  ...                                      1103.818178

[7 rows x 26 columns]
taskset -c 0-7 PROTOCOL_BUFFERS_PYTHON_IMPLEMENTATION=python python3.9 benchmarks_end_to_end.py feature_importance healthcare slow_loading featurization_2 neural_network
2022-09-21 16:53:04.883399: W tensorflow/stream_executor/platform/default/dso_loader.cc:64] Could not load dynamic library 'libcudart.so.11.0'; dlerror: libcudart.so.11.0: cannot open shared object file: No such file or directory; LD_LIBRARY_PATH: /home/sgrafbe/mlwhatif/venv/lib/python3.9/site-packages/cv2/../../lib64:
2022-09-21 16:53:04.883442: I tensorflow/stream_executor/cuda/cudart_stub.cc:29] Ignore above cudart dlerror if you do not have a GPU set up on your machine.
2022-09-21 16:53:06 INFO  Patching sys.argv with ['mlwhatif', 'healthcare', 'slow_loading', 'featurization_2', 'neural_network']
2022-09-21 16:53:06 INFO  Running instrumented original pipeline...
2022-09-21 16:53:06 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-21 16:53:06 INFO  ---RUNTIME: Importing and monkey-patching took 94.46907043457031 ms
2022-09-21 16:53:08.217135: W tensorflow/stream_executor/platform/default/dso_loader.cc:64] Could not load dynamic library 'libcuda.so.1'; dlerror: libcuda.so.1: cannot open shared object file: No such file or directory; LD_LIBRARY_PATH: /home/sgrafbe/mlwhatif/venv/lib/python3.9/site-packages/cv2/../../lib64:
2022-09-21 16:53:08.217176: W tensorflow/stream_executor/cuda/cuda_driver.cc:326] failed call to cuInit: UNKNOWN ERROR (303)
2022-09-21 16:53:08.217202: I tensorflow/stream_executor/cuda/cuda_diagnostics.cc:156] kernel driver does not appear to be running on this host (wagyu): /proc/driver/nvidia/version does not exist
2022-09-21 16:53:08.217783: I tensorflow/core/platform/cpu_feature_guard.cc:142] This TensorFlow binary is optimized with oneAPI Deep Neural Network Library (oneDNN) to use the following CPU instructions in performance-critical operations:  AVX2 FMA
To enable them in other operations, rebuild TensorFlow with the appropriate compiler flags.
2022-09-21 16:53:08.764095: I tensorflow/compiler/mlir/mlir_graph_optimization_pass.cc:176] None of the MLIR Optimization Passes are enabled (registered 2)
2022-09-21 16:53:08.777371: I tensorflow/core/platform/profile_utils/cpu_utils.cc:114] CPU Frequency: 2595290000 Hz
2022-09-21 16:53:09 INFO  ---RUNTIME: Original pipeline execution took 2785.5117321014404 ms (excluding imports and monkey-patching)
2022-09-21 16:53:09 INFO  Starting execution of 0 what-if analyses...
2022-09-21 16:53:09 INFO  Estimated runtime of original DAG is 2529.597520828247ms
2022-09-21 16:53:09 INFO  Performing Multi-Query Optimization
2022-09-21 16:53:09 INFO  Estimated unoptimized what-if runtime is 0ms
2022-09-21 16:53:09 INFO  Estimated optimised what-if runtime is 0ms
2022-09-21 16:53:09 INFO  Estimated optimisation runtime saving is 0ms
2022-09-21 16:53:09 INFO  ---RUNTIME: Multi-Query Optimization took 0.5135536193847656 ms
2022-09-21 16:53:09 INFO  Executing generated plans
2022-09-21 16:53:09 INFO  ---RUNTIME: Execution took 0.015735626220703125 ms
2022-09-21 16:53:09 INFO  Done!
2022-09-21 16:53:09 INFO  # Optimization benchmark for feature_importance with args [['healthcare', 'slow_loading', 'featurization_2', 'neural_network']] -- repetition 1 of 7
2022-09-21 16:53:09 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-21 16:53:09 INFO  Running instrumented original pipeline...
2022-09-21 16:53:09 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-21 16:53:09 INFO  ---RUNTIME: Importing and monkey-patching took 5.592823028564453 ms
2022-09-21 16:53:11 INFO  ---RUNTIME: Original pipeline execution took 2423.8438606262207 ms (excluding imports and monkey-patching)
2022-09-21 16:53:11 INFO  Starting execution of 1 what-if analyses...
2022-09-21 16:53:11 INFO  Start plan generation for analysis PermutationFeatureImportance...
2022-09-21 16:53:11 INFO  ---RUNTIME: Plan generation took 0.2944469451904297 ms
2022-09-21 16:53:11 INFO  Estimated runtime of original DAG is 2199.218511581421ms
2022-09-21 16:53:11 INFO  Performing Multi-Query Optimization
2022-09-21 16:53:11 INFO  Estimated unoptimized what-if runtime is 13195.311069488525ms
2022-09-21 16:53:11 INFO  Estimated optimised what-if runtime is 2478.212356567383ms
2022-09-21 16:53:11 INFO  Estimated optimisation runtime saving is 10717.098712921143ms
2022-09-21 16:53:11 INFO  ---RUNTIME: Multi-Query Optimization took 13.359785079956055 ms
2022-09-21 16:53:11 INFO  Executing generated plans
2022-09-21 16:53:13 INFO  ---RUNTIME: Execution took 2246.434211730957 ms
2022-09-21 16:53:13 INFO  Done!
2022-09-21 16:53:13 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-21 16:53:13 INFO  Running instrumented original pipeline...
2022-09-21 16:53:13 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-21 16:53:13 INFO  ---RUNTIME: Importing and monkey-patching took 5.788087844848633 ms
2022-09-21 16:53:16 INFO  ---RUNTIME: Original pipeline execution took 2648.1947898864746 ms (excluding imports and monkey-patching)
2022-09-21 16:53:16 INFO  Starting execution of 1 what-if analyses...
2022-09-21 16:53:16 INFO  Start plan generation for analysis PermutationFeatureImportance...
2022-09-21 16:53:16 INFO  ---RUNTIME: Plan generation took 0.11181831359863281 ms
2022-09-21 16:53:16 INFO  Estimated runtime of original DAG is 2421.130657196045ms
2022-09-21 16:53:16 WARNING Skipping Multi-Query Optimization (instead, only applying patches)
2022-09-21 16:53:16 INFO  Estimated unoptimised what-if runtime is 14526.78394317627ms
2022-09-21 16:53:16 INFO  ---RUNTIME: Multi-Query Optimization took 4.680395126342773 ms
2022-09-21 16:53:16 INFO  Executing generated plans
2022-09-21 16:53:30 INFO  ---RUNTIME: Execution took 13649.386644363403 ms
2022-09-21 16:53:30 INFO  Done!
2022-09-21 16:53:30 INFO  # Finished -- repetition 1 of 7 
2022-09-21 16:53:30 INFO  # Optimization benchmark for feature_importance with args [['healthcare', 'slow_loading', 'featurization_2', 'neural_network']] -- repetition 2 of 7
2022-09-21 16:53:30 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-21 16:53:30 INFO  Running instrumented original pipeline...
2022-09-21 16:53:30 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-21 16:53:30 INFO  ---RUNTIME: Importing and monkey-patching took 6.207466125488281 ms
2022-09-21 16:53:32 INFO  ---RUNTIME: Original pipeline execution took 2492.7661418914795 ms (excluding imports and monkey-patching)
2022-09-21 16:53:32 INFO  Starting execution of 1 what-if analyses...
2022-09-21 16:53:32 INFO  Start plan generation for analysis PermutationFeatureImportance...
2022-09-21 16:53:32 INFO  ---RUNTIME: Plan generation took 0.12874603271484375 ms
2022-09-21 16:53:32 INFO  Estimated runtime of original DAG is 2264.1594409942627ms
2022-09-21 16:53:32 INFO  Performing Multi-Query Optimization
2022-09-21 16:53:32 INFO  Estimated unoptimized what-if runtime is 13584.956645965576ms
2022-09-21 16:53:32 INFO  Estimated optimised what-if runtime is 2543.0305004119873ms
2022-09-21 16:53:32 INFO  Estimated optimisation runtime saving is 11041.926145553589ms
2022-09-21 16:53:32 INFO  ---RUNTIME: Multi-Query Optimization took 13.16213607788086 ms
2022-09-21 16:53:32 INFO  Executing generated plans
2022-09-21 16:53:34 INFO  ---RUNTIME: Execution took 2273.84877204895 ms
2022-09-21 16:53:34 INFO  Done!
2022-09-21 16:53:34 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-21 16:53:34 INFO  Running instrumented original pipeline...
2022-09-21 16:53:34 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-21 16:53:34 INFO  ---RUNTIME: Importing and monkey-patching took 6.077289581298828 ms
2022-09-21 16:53:37 INFO  ---RUNTIME: Original pipeline execution took 2848.684549331665 ms (excluding imports and monkey-patching)
2022-09-21 16:53:37 INFO  Starting execution of 1 what-if analyses...
2022-09-21 16:53:37 INFO  Start plan generation for analysis PermutationFeatureImportance...
2022-09-21 16:53:37 INFO  ---RUNTIME: Plan generation took 0.12969970703125 ms
2022-09-21 16:53:37 INFO  Estimated runtime of original DAG is 2619.3652153015137ms
2022-09-21 16:53:37 WARNING Skipping Multi-Query Optimization (instead, only applying patches)
2022-09-21 16:53:37 INFO  Estimated unoptimised what-if runtime is 15716.191291809082ms
2022-09-21 16:53:37 INFO  ---RUNTIME: Multi-Query Optimization took 4.831075668334961 ms
2022-09-21 16:53:37 INFO  Executing generated plans
2022-09-21 16:53:51 INFO  ---RUNTIME: Execution took 13892.886877059937 ms
2022-09-21 16:53:51 INFO  Done!
2022-09-21 16:53:51 INFO  # Finished -- repetition 2 of 7 
2022-09-21 16:53:51 INFO  # Optimization benchmark for feature_importance with args [['healthcare', 'slow_loading', 'featurization_2', 'neural_network']] -- repetition 3 of 7
2022-09-21 16:53:51 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-21 16:53:51 INFO  Running instrumented original pipeline...
2022-09-21 16:53:51 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-21 16:53:51 INFO  ---RUNTIME: Importing and monkey-patching took 6.569385528564453 ms
2022-09-21 16:53:54 INFO  ---RUNTIME: Original pipeline execution took 2790.8990383148193 ms (excluding imports and monkey-patching)
2022-09-21 16:53:54 INFO  Starting execution of 1 what-if analyses...
2022-09-21 16:53:54 INFO  Start plan generation for analysis PermutationFeatureImportance...
2022-09-21 16:53:54 INFO  ---RUNTIME: Plan generation took 0.12111663818359375 ms
2022-09-21 16:53:54 INFO  Estimated runtime of original DAG is 2555.4864406585693ms
2022-09-21 16:53:54 INFO  Performing Multi-Query Optimization
2022-09-21 16:53:54 INFO  Estimated unoptimized what-if runtime is 15332.918643951416ms
2022-09-21 16:53:54 INFO  Estimated optimised what-if runtime is 2876.411199569702ms
2022-09-21 16:53:54 INFO  Estimated optimisation runtime saving is 12456.507444381714ms
2022-09-21 16:53:54 INFO  ---RUNTIME: Multi-Query Optimization took 14.732837677001953 ms
2022-09-21 16:53:54 INFO  Executing generated plans
2022-09-21 16:53:56 INFO  ---RUNTIME: Execution took 2284.341335296631 ms
2022-09-21 16:53:56 INFO  Done!
2022-09-21 16:53:56 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-21 16:53:56 INFO  Running instrumented original pipeline...
2022-09-21 16:53:56 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-21 16:53:56 INFO  ---RUNTIME: Importing and monkey-patching took 5.951166152954102 ms
2022-09-21 16:53:59 INFO  ---RUNTIME: Original pipeline execution took 2481.045722961426 ms (excluding imports and monkey-patching)
2022-09-21 16:53:59 INFO  Starting execution of 1 what-if analyses...
2022-09-21 16:53:59 INFO  Start plan generation for analysis PermutationFeatureImportance...
2022-09-21 16:53:59 INFO  ---RUNTIME: Plan generation took 0.11515617370605469 ms
2022-09-21 16:53:59 INFO  Estimated runtime of original DAG is 2251.9423961639404ms
2022-09-21 16:53:59 WARNING Skipping Multi-Query Optimization (instead, only applying patches)
2022-09-21 16:53:59 INFO  Estimated unoptimised what-if runtime is 13511.654376983643ms
2022-09-21 16:53:59 INFO  ---RUNTIME: Multi-Query Optimization took 4.682302474975586 ms
2022-09-21 16:53:59 INFO  Executing generated plans
2022-09-21 16:54:13 INFO  ---RUNTIME: Execution took 13996.612787246704 ms
2022-09-21 16:54:13 INFO  Done!
2022-09-21 16:54:13 INFO  # Finished -- repetition 3 of 7 
2022-09-21 16:54:13 INFO  # Optimization benchmark for feature_importance with args [['healthcare', 'slow_loading', 'featurization_2', 'neural_network']] -- repetition 4 of 7
2022-09-21 16:54:13 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-21 16:54:13 INFO  Running instrumented original pipeline...
2022-09-21 16:54:13 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-21 16:54:13 INFO  ---RUNTIME: Importing and monkey-patching took 7.215023040771484 ms
2022-09-21 16:54:15 INFO  ---RUNTIME: Original pipeline execution took 2844.0375328063965 ms (excluding imports and monkey-patching)
2022-09-21 16:54:15 INFO  Starting execution of 1 what-if analyses...
2022-09-21 16:54:15 INFO  Start plan generation for analysis PermutationFeatureImportance...
2022-09-21 16:54:15 INFO  ---RUNTIME: Plan generation took 0.11277198791503906 ms
2022-09-21 16:54:15 INFO  Estimated runtime of original DAG is 2241.4608001708984ms
2022-09-21 16:54:15 INFO  Performing Multi-Query Optimization
2022-09-21 16:54:16 INFO  Estimated unoptimized what-if runtime is 13448.76480102539ms
2022-09-21 16:54:16 INFO  Estimated optimised what-if runtime is 2517.606258392334ms
2022-09-21 16:54:16 INFO  Estimated optimisation runtime saving is 10931.158542633057ms
2022-09-21 16:54:16 INFO  ---RUNTIME: Multi-Query Optimization took 13.585090637207031 ms
2022-09-21 16:54:16 INFO  Executing generated plans
2022-09-21 16:54:18 INFO  ---RUNTIME: Execution took 2301.156520843506 ms
2022-09-21 16:54:18 INFO  Done!
2022-09-21 16:54:18 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-21 16:54:18 INFO  Running instrumented original pipeline...
2022-09-21 16:54:18 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-21 16:54:18 INFO  ---RUNTIME: Importing and monkey-patching took 6.126880645751953 ms
2022-09-21 16:54:20 INFO  ---RUNTIME: Original pipeline execution took 2466.867446899414 ms (excluding imports and monkey-patching)
2022-09-21 16:54:20 INFO  Starting execution of 1 what-if analyses...
2022-09-21 16:54:20 INFO  Start plan generation for analysis PermutationFeatureImportance...
2022-09-21 16:54:20 INFO  ---RUNTIME: Plan generation took 0.11849403381347656 ms
2022-09-21 16:54:20 INFO  Estimated runtime of original DAG is 2236.044406890869ms
2022-09-21 16:54:20 WARNING Skipping Multi-Query Optimization (instead, only applying patches)
2022-09-21 16:54:20 INFO  Estimated unoptimised what-if runtime is 13416.266441345215ms
2022-09-21 16:54:20 INFO  ---RUNTIME: Multi-Query Optimization took 4.844188690185547 ms
2022-09-21 16:54:20 INFO  Executing generated plans
2022-09-21 16:54:34 INFO  ---RUNTIME: Execution took 13927.962303161621 ms
2022-09-21 16:54:34 INFO  Done!
2022-09-21 16:54:34 INFO  # Finished -- repetition 4 of 7 
2022-09-21 16:54:34 INFO  # Optimization benchmark for feature_importance with args [['healthcare', 'slow_loading', 'featurization_2', 'neural_network']] -- repetition 5 of 7
2022-09-21 16:54:34 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-21 16:54:34 INFO  Running instrumented original pipeline...
2022-09-21 16:54:34 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-21 16:54:34 INFO  ---RUNTIME: Importing and monkey-patching took 6.726503372192383 ms
2022-09-21 16:54:37 INFO  ---RUNTIME: Original pipeline execution took 2492.3901557922363 ms (excluding imports and monkey-patching)
2022-09-21 16:54:37 INFO  Starting execution of 1 what-if analyses...
2022-09-21 16:54:37 INFO  Start plan generation for analysis PermutationFeatureImportance...
2022-09-21 16:54:37 INFO  ---RUNTIME: Plan generation took 0.11992454528808594 ms
2022-09-21 16:54:37 INFO  Estimated runtime of original DAG is 2253.2269954681396ms
2022-09-21 16:54:37 INFO  Performing Multi-Query Optimization
2022-09-21 16:54:37 INFO  Estimated unoptimized what-if runtime is 13519.361972808838ms
2022-09-21 16:54:37 INFO  Estimated optimised what-if runtime is 2574.8465061187744ms
2022-09-21 16:54:37 INFO  Estimated optimisation runtime saving is 10944.515466690063ms
2022-09-21 16:54:37 INFO  ---RUNTIME: Multi-Query Optimization took 14.860391616821289 ms
2022-09-21 16:54:37 INFO  Executing generated plans
2022-09-21 16:54:39 INFO  ---RUNTIME: Execution took 2698.5161304473877 ms
2022-09-21 16:54:39 INFO  Done!
2022-09-21 16:54:39 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-21 16:54:39 INFO  Running instrumented original pipeline...
2022-09-21 16:54:39 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-21 16:54:39 INFO  ---RUNTIME: Importing and monkey-patching took 5.923986434936523 ms
2022-09-21 16:54:42 INFO  ---RUNTIME: Original pipeline execution took 2469.166040420532 ms (excluding imports and monkey-patching)
2022-09-21 16:54:42 INFO  Starting execution of 1 what-if analyses...
2022-09-21 16:54:42 INFO  Start plan generation for analysis PermutationFeatureImportance...
2022-09-21 16:54:42 INFO  ---RUNTIME: Plan generation took 0.11134147644042969 ms
2022-09-21 16:54:42 INFO  Estimated runtime of original DAG is 2238.441228866577ms
2022-09-21 16:54:42 WARNING Skipping Multi-Query Optimization (instead, only applying patches)
2022-09-21 16:54:42 INFO  Estimated unoptimised what-if runtime is 13430.647373199463ms
2022-09-21 16:54:42 INFO  ---RUNTIME: Multi-Query Optimization took 4.757404327392578 ms
2022-09-21 16:54:42 INFO  Executing generated plans
2022-09-21 16:54:56 INFO  ---RUNTIME: Execution took 14042.558193206787 ms
2022-09-21 16:54:56 INFO  Done!
2022-09-21 16:54:56 INFO  # Finished -- repetition 5 of 7 
2022-09-21 16:54:56 INFO  # Optimization benchmark for feature_importance with args [['healthcare', 'slow_loading', 'featurization_2', 'neural_network']] -- repetition 6 of 7
2022-09-21 16:54:56 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-21 16:54:56 INFO  Running instrumented original pipeline...
2022-09-21 16:54:56 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-21 16:54:56 INFO  ---RUNTIME: Importing and monkey-patching took 6.645441055297852 ms
2022-09-21 16:54:58 INFO  ---RUNTIME: Original pipeline execution took 2508.2178115844727 ms (excluding imports and monkey-patching)
2022-09-21 16:54:58 INFO  Starting execution of 1 what-if analyses...
2022-09-21 16:54:58 INFO  Start plan generation for analysis PermutationFeatureImportance...
2022-09-21 16:54:58 INFO  ---RUNTIME: Plan generation took 0.10514259338378906 ms
2022-09-21 16:54:58 INFO  Estimated runtime of original DAG is 2270.484447479248ms
2022-09-21 16:54:58 INFO  Performing Multi-Query Optimization
2022-09-21 16:54:58 INFO  Estimated unoptimized what-if runtime is 13622.906684875488ms
2022-09-21 16:54:58 INFO  Estimated optimised what-if runtime is 2583.280086517334ms
2022-09-21 16:54:58 INFO  Estimated optimisation runtime saving is 11039.626598358154ms
2022-09-21 16:54:58 INFO  ---RUNTIME: Multi-Query Optimization took 12.115240097045898 ms
2022-09-21 16:54:58 INFO  Executing generated plans
2022-09-21 16:55:01 INFO  ---RUNTIME: Execution took 2297.9910373687744 ms
2022-09-21 16:55:01 INFO  Done!
2022-09-21 16:55:01 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-21 16:55:01 INFO  Running instrumented original pipeline...
2022-09-21 16:55:01 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-21 16:55:01 INFO  ---RUNTIME: Importing and monkey-patching took 5.692720413208008 ms
2022-09-21 16:55:03 INFO  ---RUNTIME: Original pipeline execution took 2463.541269302368 ms (excluding imports and monkey-patching)
2022-09-21 16:55:03 INFO  Starting execution of 1 what-if analyses...
2022-09-21 16:55:03 INFO  Start plan generation for analysis PermutationFeatureImportance...
2022-09-21 16:55:03 INFO  ---RUNTIME: Plan generation took 0.125885009765625 ms
2022-09-21 16:55:03 INFO  Estimated runtime of original DAG is 2235.8837127685547ms
2022-09-21 16:55:03 WARNING Skipping Multi-Query Optimization (instead, only applying patches)
2022-09-21 16:55:03 INFO  Estimated unoptimised what-if runtime is 13415.302276611328ms
2022-09-21 16:55:03 INFO  ---RUNTIME: Multi-Query Optimization took 4.80961799621582 ms
2022-09-21 16:55:03 INFO  Executing generated plans
2022-09-21 16:55:17 INFO  ---RUNTIME: Execution took 13962.784051895142 ms
2022-09-21 16:55:17 INFO  Done!
2022-09-21 16:55:17 INFO  # Finished -- repetition 6 of 7 
2022-09-21 16:55:17 INFO  # Optimization benchmark for feature_importance with args [['healthcare', 'slow_loading', 'featurization_2', 'neural_network']] -- repetition 7 of 7
2022-09-21 16:55:17 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-21 16:55:17 INFO  Running instrumented original pipeline...
2022-09-21 16:55:17 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-21 16:55:17 INFO  ---RUNTIME: Importing and monkey-patching took 6.588220596313477 ms
2022-09-21 16:55:20 INFO  ---RUNTIME: Original pipeline execution took 2895.1478004455566 ms (excluding imports and monkey-patching)
2022-09-21 16:55:20 INFO  Starting execution of 1 what-if analyses...
2022-09-21 16:55:20 INFO  Start plan generation for analysis PermutationFeatureImportance...
2022-09-21 16:55:20 INFO  ---RUNTIME: Plan generation took 0.10848045349121094 ms
2022-09-21 16:55:20 INFO  Estimated runtime of original DAG is 2658.6315631866455ms
2022-09-21 16:55:20 INFO  Performing Multi-Query Optimization
2022-09-21 16:55:20 INFO  Estimated unoptimized what-if runtime is 15951.789379119873ms
2022-09-21 16:55:20 INFO  Estimated optimised what-if runtime is 2937.2925758361816ms
2022-09-21 16:55:20 INFO  Estimated optimisation runtime saving is 13014.496803283691ms
2022-09-21 16:55:20 INFO  ---RUNTIME: Multi-Query Optimization took 12.727022171020508 ms
2022-09-21 16:55:20 INFO  Executing generated plans
2022-09-21 16:55:22 INFO  ---RUNTIME: Execution took 2305.6254386901855 ms
2022-09-21 16:55:22 INFO  Done!
2022-09-21 16:55:22 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-21 16:55:22 INFO  Running instrumented original pipeline...
2022-09-21 16:55:22 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-21 16:55:23 INFO  ---RUNTIME: Importing and monkey-patching took 6.063938140869141 ms
2022-09-21 16:55:25 INFO  ---RUNTIME: Original pipeline execution took 2532.1431159973145 ms (excluding imports and monkey-patching)
2022-09-21 16:55:25 INFO  Starting execution of 1 what-if analyses...
2022-09-21 16:55:25 INFO  Start plan generation for analysis PermutationFeatureImportance...
2022-09-21 16:55:25 INFO  ---RUNTIME: Plan generation took 0.11897087097167969 ms
2022-09-21 16:55:25 INFO  Estimated runtime of original DAG is 2302.032232284546ms
2022-09-21 16:55:25 WARNING Skipping Multi-Query Optimization (instead, only applying patches)
2022-09-21 16:55:25 INFO  Estimated unoptimised what-if runtime is 13812.193393707275ms
2022-09-21 16:55:25 INFO  ---RUNTIME: Multi-Query Optimization took 4.6672821044921875 ms
2022-09-21 16:55:25 INFO  Executing generated plans
2022-09-21 16:55:39 INFO  ---RUNTIME: Execution took 14006.898880004883 ms
2022-09-21 16:55:39 INFO  Done!
2022-09-21 16:55:39 INFO  # Finished -- repetition 7 of 7 
2022-09-21 16:55:39 INFO  # Final results after all repetitions
2022-09-21 16:55:39 INFO     repetition  ... no_opt_what_if_execution_combined_model_training
0           0  ...                                      2844.230890
1           1  ...                                      3023.812532
2           2  ...                                      2959.674358
3           3  ...                                      2933.162212
4           4  ...                                      3034.577370
5           5  ...                                      3003.203630
6           6  ...                                      3003.127098

[7 rows x 26 columns]
taskset -c 0-7 PROTOCOL_BUFFERS_PYTHON_IMPLEMENTATION=python python3.9 benchmarks_end_to_end.py feature_importance healthcare slow_loading featurization_3 logistic_regression
2022-09-21 16:55:41.797859: W tensorflow/stream_executor/platform/default/dso_loader.cc:64] Could not load dynamic library 'libcudart.so.11.0'; dlerror: libcudart.so.11.0: cannot open shared object file: No such file or directory; LD_LIBRARY_PATH: /home/sgrafbe/mlwhatif/venv/lib/python3.9/site-packages/cv2/../../lib64:
2022-09-21 16:55:41.797902: I tensorflow/stream_executor/cuda/cudart_stub.cc:29] Ignore above cudart dlerror if you do not have a GPU set up on your machine.
2022-09-21 16:55:43 INFO  Patching sys.argv with ['mlwhatif', 'healthcare', 'slow_loading', 'featurization_3', 'logistic_regression']
2022-09-21 16:55:43 INFO  Running instrumented original pipeline...
2022-09-21 16:55:43 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-21 16:55:43 INFO  ---RUNTIME: Importing and monkey-patching took 94.74444389343262 ms
2022-09-21 16:55:45 INFO  ---RUNTIME: Original pipeline execution took 2151.2386798858643 ms (excluding imports and monkey-patching)
2022-09-21 16:55:45 INFO  Starting execution of 0 what-if analyses...
2022-09-21 16:55:45 INFO  Estimated runtime of original DAG is 1804.9860000610352ms
2022-09-21 16:55:45 INFO  Performing Multi-Query Optimization
2022-09-21 16:55:45 INFO  Estimated unoptimized what-if runtime is 0ms
2022-09-21 16:55:45 INFO  Estimated optimised what-if runtime is 0ms
2022-09-21 16:55:45 INFO  Estimated optimisation runtime saving is 0ms
2022-09-21 16:55:45 INFO  ---RUNTIME: Multi-Query Optimization took 0.5142688751220703 ms
2022-09-21 16:55:45 INFO  Executing generated plans
2022-09-21 16:55:45 INFO  ---RUNTIME: Execution took 0.022411346435546875 ms
2022-09-21 16:55:45 INFO  Done!
2022-09-21 16:55:45 INFO  # Optimization benchmark for feature_importance with args [['healthcare', 'slow_loading', 'featurization_3', 'logistic_regression']] -- repetition 1 of 7
2022-09-21 16:55:45 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-21 16:55:45 INFO  Running instrumented original pipeline...
2022-09-21 16:55:45 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-21 16:55:45 INFO  ---RUNTIME: Importing and monkey-patching took 5.087852478027344 ms
2022-09-21 16:55:47 INFO  ---RUNTIME: Original pipeline execution took 2090.284824371338 ms (excluding imports and monkey-patching)
2022-09-21 16:55:47 INFO  Starting execution of 1 what-if analyses...
2022-09-21 16:55:47 INFO  Start plan generation for analysis PermutationFeatureImportance...
2022-09-21 16:55:47 INFO  ---RUNTIME: Plan generation took 0.22864341735839844 ms
2022-09-21 16:55:47 INFO  Estimated runtime of original DAG is 1780.4129123687744ms
2022-09-21 16:55:47 INFO  Performing Multi-Query Optimization
2022-09-21 16:55:47 INFO  Estimated unoptimized what-if runtime is 10682.477474212646ms
2022-09-21 16:55:47 INFO  Estimated optimised what-if runtime is 1791.9397354125977ms
2022-09-21 16:55:47 INFO  Estimated optimisation runtime saving is 8890.537738800049ms
2022-09-21 16:55:47 INFO  ---RUNTIME: Multi-Query Optimization took 14.409780502319336 ms
2022-09-21 16:55:47 INFO  Executing generated plans
2022-09-21 16:55:49 INFO  ---RUNTIME: Execution took 1869.6143627166748 ms
2022-09-21 16:55:49 INFO  Done!
2022-09-21 16:55:49 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-21 16:55:49 INFO  Running instrumented original pipeline...
2022-09-21 16:55:49 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-21 16:55:49 INFO  ---RUNTIME: Importing and monkey-patching took 5.8002471923828125 ms
2022-09-21 16:55:51 INFO  ---RUNTIME: Original pipeline execution took 2255.4776668548584 ms (excluding imports and monkey-patching)
2022-09-21 16:55:51 INFO  Starting execution of 1 what-if analyses...
2022-09-21 16:55:51 INFO  Start plan generation for analysis PermutationFeatureImportance...
2022-09-21 16:55:51 INFO  ---RUNTIME: Plan generation took 0.13780593872070312 ms
2022-09-21 16:55:51 INFO  Estimated runtime of original DAG is 1775.3243446350098ms
2022-09-21 16:55:51 WARNING Skipping Multi-Query Optimization (instead, only applying patches)
2022-09-21 16:55:51 INFO  Estimated unoptimised what-if runtime is 10651.946067810059ms
2022-09-21 16:55:51 INFO  ---RUNTIME: Multi-Query Optimization took 5.354166030883789 ms
2022-09-21 16:55:51 INFO  Executing generated plans
2022-09-21 16:56:02 INFO  ---RUNTIME: Execution took 10870.190620422363 ms
2022-09-21 16:56:02 INFO  Done!
2022-09-21 16:56:02 INFO  # Finished -- repetition 1 of 7 
2022-09-21 16:56:02 INFO  # Optimization benchmark for feature_importance with args [['healthcare', 'slow_loading', 'featurization_3', 'logistic_regression']] -- repetition 2 of 7
2022-09-21 16:56:02 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-21 16:56:02 INFO  Running instrumented original pipeline...
2022-09-21 16:56:02 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-21 16:56:02 INFO  ---RUNTIME: Importing and monkey-patching took 6.009340286254883 ms
2022-09-21 16:56:04 INFO  ---RUNTIME: Original pipeline execution took 2101.1574268341064 ms (excluding imports and monkey-patching)
2022-09-21 16:56:04 INFO  Starting execution of 1 what-if analyses...
2022-09-21 16:56:04 INFO  Start plan generation for analysis PermutationFeatureImportance...
2022-09-21 16:56:04 INFO  ---RUNTIME: Plan generation took 0.12683868408203125 ms
2022-09-21 16:56:04 INFO  Estimated runtime of original DAG is 1790.7054424285889ms
2022-09-21 16:56:04 INFO  Performing Multi-Query Optimization
2022-09-21 16:56:04 INFO  Estimated unoptimized what-if runtime is 10744.232654571533ms
2022-09-21 16:56:04 INFO  Estimated optimised what-if runtime is 1802.0856380462646ms
2022-09-21 16:56:04 INFO  Estimated optimisation runtime saving is 8942.147016525269ms
2022-09-21 16:56:04 INFO  ---RUNTIME: Multi-Query Optimization took 14.58740234375 ms
2022-09-21 16:56:04 INFO  Executing generated plans
2022-09-21 16:56:06 INFO  ---RUNTIME: Execution took 1800.8501529693604 ms
2022-09-21 16:56:06 INFO  Done!
2022-09-21 16:56:06 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-21 16:56:06 INFO  Running instrumented original pipeline...
2022-09-21 16:56:06 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-21 16:56:06 INFO  ---RUNTIME: Importing and monkey-patching took 6.008625030517578 ms
2022-09-21 16:56:08 INFO  ---RUNTIME: Original pipeline execution took 2073.2386112213135 ms (excluding imports and monkey-patching)
2022-09-21 16:56:08 INFO  Starting execution of 1 what-if analyses...
2022-09-21 16:56:08 INFO  Start plan generation for analysis PermutationFeatureImportance...
2022-09-21 16:56:08 INFO  ---RUNTIME: Plan generation took 0.12063980102539062 ms
2022-09-21 16:56:08 INFO  Estimated runtime of original DAG is 1765.4671669006348ms
2022-09-21 16:56:08 WARNING Skipping Multi-Query Optimization (instead, only applying patches)
2022-09-21 16:56:08 INFO  Estimated unoptimised what-if runtime is 10592.803001403809ms
2022-09-21 16:56:08 INFO  ---RUNTIME: Multi-Query Optimization took 5.363702774047852 ms
2022-09-21 16:56:08 INFO  Executing generated plans
2022-09-21 16:56:19 INFO  ---RUNTIME: Execution took 10798.056602478027 ms
2022-09-21 16:56:19 INFO  Done!
2022-09-21 16:56:19 INFO  # Finished -- repetition 2 of 7 
2022-09-21 16:56:19 INFO  # Optimization benchmark for feature_importance with args [['healthcare', 'slow_loading', 'featurization_3', 'logistic_regression']] -- repetition 3 of 7
2022-09-21 16:56:19 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-21 16:56:19 INFO  Running instrumented original pipeline...
2022-09-21 16:56:19 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-21 16:56:19 INFO  ---RUNTIME: Importing and monkey-patching took 6.057262420654297 ms
2022-09-21 16:56:21 INFO  ---RUNTIME: Original pipeline execution took 2059.035301208496 ms (excluding imports and monkey-patching)
2022-09-21 16:56:21 INFO  Starting execution of 1 what-if analyses...
2022-09-21 16:56:21 INFO  Start plan generation for analysis PermutationFeatureImportance...
2022-09-21 16:56:21 INFO  ---RUNTIME: Plan generation took 0.1366138458251953 ms
2022-09-21 16:56:21 INFO  Estimated runtime of original DAG is 1750.8900165557861ms
2022-09-21 16:56:21 INFO  Performing Multi-Query Optimization
2022-09-21 16:56:21 INFO  Estimated unoptimized what-if runtime is 10505.340099334717ms
2022-09-21 16:56:21 INFO  Estimated optimised what-if runtime is 1762.4647617340088ms
2022-09-21 16:56:21 INFO  Estimated optimisation runtime saving is 8742.875337600708ms
2022-09-21 16:56:21 INFO  ---RUNTIME: Multi-Query Optimization took 14.55998420715332 ms
2022-09-21 16:56:21 INFO  Executing generated plans
2022-09-21 16:56:23 INFO  ---RUNTIME: Execution took 1780.8518409729004 ms
2022-09-21 16:56:23 INFO  Done!
2022-09-21 16:56:23 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-21 16:56:23 INFO  Running instrumented original pipeline...
2022-09-21 16:56:23 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-21 16:56:23 INFO  ---RUNTIME: Importing and monkey-patching took 5.630731582641602 ms
2022-09-21 16:56:25 INFO  ---RUNTIME: Original pipeline execution took 2033.2050323486328 ms (excluding imports and monkey-patching)
2022-09-21 16:56:25 INFO  Starting execution of 1 what-if analyses...
2022-09-21 16:56:25 INFO  Start plan generation for analysis PermutationFeatureImportance...
2022-09-21 16:56:25 INFO  ---RUNTIME: Plan generation took 0.10132789611816406 ms
2022-09-21 16:56:25 INFO  Estimated runtime of original DAG is 1728.8882732391357ms
2022-09-21 16:56:25 WARNING Skipping Multi-Query Optimization (instead, only applying patches)
2022-09-21 16:56:25 INFO  Estimated unoptimised what-if runtime is 10373.329639434814ms
2022-09-21 16:56:25 INFO  ---RUNTIME: Multi-Query Optimization took 5.210638046264648 ms
2022-09-21 16:56:25 INFO  Executing generated plans
2022-09-21 16:56:35 INFO  ---RUNTIME: Execution took 10736.666917800903 ms
2022-09-21 16:56:35 INFO  Done!
2022-09-21 16:56:35 INFO  # Finished -- repetition 3 of 7 
2022-09-21 16:56:35 INFO  # Optimization benchmark for feature_importance with args [['healthcare', 'slow_loading', 'featurization_3', 'logistic_regression']] -- repetition 4 of 7
2022-09-21 16:56:35 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-21 16:56:35 INFO  Running instrumented original pipeline...
2022-09-21 16:56:35 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-21 16:56:35 INFO  ---RUNTIME: Importing and monkey-patching took 6.011486053466797 ms
2022-09-21 16:56:37 INFO  ---RUNTIME: Original pipeline execution took 2050.994634628296 ms (excluding imports and monkey-patching)
2022-09-21 16:56:37 INFO  Starting execution of 1 what-if analyses...
2022-09-21 16:56:37 INFO  Start plan generation for analysis PermutationFeatureImportance...
2022-09-21 16:56:37 INFO  ---RUNTIME: Plan generation took 0.10228157043457031 ms
2022-09-21 16:56:37 INFO  Estimated runtime of original DAG is 1743.180751800537ms
2022-09-21 16:56:37 INFO  Performing Multi-Query Optimization
2022-09-21 16:56:37 INFO  Estimated unoptimized what-if runtime is 10459.084510803223ms
2022-09-21 16:56:37 INFO  Estimated optimised what-if runtime is 1754.5690536499023ms
2022-09-21 16:56:37 INFO  Estimated optimisation runtime saving is 8704.51545715332ms
2022-09-21 16:56:37 INFO  ---RUNTIME: Multi-Query Optimization took 14.372110366821289 ms
2022-09-21 16:56:37 INFO  Executing generated plans
2022-09-21 16:56:39 INFO  ---RUNTIME: Execution took 1825.160264968872 ms
2022-09-21 16:56:39 INFO  Done!
2022-09-21 16:56:39 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-21 16:56:39 INFO  Running instrumented original pipeline...
2022-09-21 16:56:39 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-21 16:56:39 INFO  ---RUNTIME: Importing and monkey-patching took 5.707263946533203 ms
2022-09-21 16:56:41 INFO  ---RUNTIME: Original pipeline execution took 2051.288604736328 ms (excluding imports and monkey-patching)
2022-09-21 16:56:41 INFO  Starting execution of 1 what-if analyses...
2022-09-21 16:56:41 INFO  Start plan generation for analysis PermutationFeatureImportance...
2022-09-21 16:56:41 INFO  ---RUNTIME: Plan generation took 0.10728836059570312 ms
2022-09-21 16:56:41 INFO  Estimated runtime of original DAG is 1742.6488399505615ms
2022-09-21 16:56:41 WARNING Skipping Multi-Query Optimization (instead, only applying patches)
2022-09-21 16:56:41 INFO  Estimated unoptimised what-if runtime is 10455.89303970337ms
2022-09-21 16:56:41 INFO  ---RUNTIME: Multi-Query Optimization took 5.5446624755859375 ms
2022-09-21 16:56:41 INFO  Executing generated plans
2022-09-21 16:56:52 INFO  ---RUNTIME: Execution took 10506.861925125122 ms
2022-09-21 16:56:52 INFO  Done!
2022-09-21 16:56:52 INFO  # Finished -- repetition 4 of 7 
2022-09-21 16:56:52 INFO  # Optimization benchmark for feature_importance with args [['healthcare', 'slow_loading', 'featurization_3', 'logistic_regression']] -- repetition 5 of 7
2022-09-21 16:56:52 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-21 16:56:52 INFO  Running instrumented original pipeline...
2022-09-21 16:56:52 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-21 16:56:52 INFO  ---RUNTIME: Importing and monkey-patching took 5.664825439453125 ms
2022-09-21 16:56:54 INFO  ---RUNTIME: Original pipeline execution took 2055.3507804870605 ms (excluding imports and monkey-patching)
2022-09-21 16:56:54 INFO  Starting execution of 1 what-if analyses...
2022-09-21 16:56:54 INFO  Start plan generation for analysis PermutationFeatureImportance...
2022-09-21 16:56:54 INFO  ---RUNTIME: Plan generation took 0.10585784912109375 ms
2022-09-21 16:56:54 INFO  Estimated runtime of original DAG is 1748.136043548584ms
2022-09-21 16:56:54 INFO  Performing Multi-Query Optimization
2022-09-21 16:56:54 INFO  Estimated unoptimized what-if runtime is 10488.816261291504ms
2022-09-21 16:56:54 INFO  Estimated optimised what-if runtime is 1759.4494819641113ms
2022-09-21 16:56:54 INFO  Estimated optimisation runtime saving is 8729.366779327393ms
2022-09-21 16:56:54 INFO  ---RUNTIME: Multi-Query Optimization took 14.397382736206055 ms
2022-09-21 16:56:54 INFO  Executing generated plans
2022-09-21 16:56:56 INFO  ---RUNTIME: Execution took 1793.6174869537354 ms
2022-09-21 16:56:56 INFO  Done!
2022-09-21 16:56:56 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-21 16:56:56 INFO  Running instrumented original pipeline...
2022-09-21 16:56:56 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-21 16:56:56 INFO  ---RUNTIME: Importing and monkey-patching took 6.129741668701172 ms
2022-09-21 16:56:58 INFO  ---RUNTIME: Original pipeline execution took 2053.004503250122 ms (excluding imports and monkey-patching)
2022-09-21 16:56:58 INFO  Starting execution of 1 what-if analyses...
2022-09-21 16:56:58 INFO  Start plan generation for analysis PermutationFeatureImportance...
2022-09-21 16:56:58 INFO  ---RUNTIME: Plan generation took 0.1277923583984375 ms
2022-09-21 16:56:58 INFO  Estimated runtime of original DAG is 1743.6094284057617ms
2022-09-21 16:56:58 WARNING Skipping Multi-Query Optimization (instead, only applying patches)
2022-09-21 16:56:58 INFO  Estimated unoptimised what-if runtime is 10461.65657043457ms
2022-09-21 16:56:58 INFO  ---RUNTIME: Multi-Query Optimization took 5.434274673461914 ms
2022-09-21 16:56:58 INFO  Executing generated plans
2022-09-21 16:57:08 INFO  ---RUNTIME: Execution took 10572.670221328735 ms
2022-09-21 16:57:08 INFO  Done!
2022-09-21 16:57:08 INFO  # Finished -- repetition 5 of 7 
2022-09-21 16:57:08 INFO  # Optimization benchmark for feature_importance with args [['healthcare', 'slow_loading', 'featurization_3', 'logistic_regression']] -- repetition 6 of 7
2022-09-21 16:57:08 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-21 16:57:08 INFO  Running instrumented original pipeline...
2022-09-21 16:57:08 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-21 16:57:08 INFO  ---RUNTIME: Importing and monkey-patching took 5.687236785888672 ms
2022-09-21 16:57:10 INFO  ---RUNTIME: Original pipeline execution took 2094.343662261963 ms (excluding imports and monkey-patching)
2022-09-21 16:57:10 INFO  Starting execution of 1 what-if analyses...
2022-09-21 16:57:10 INFO  Start plan generation for analysis PermutationFeatureImportance...
2022-09-21 16:57:10 INFO  ---RUNTIME: Plan generation took 0.10371208190917969 ms
2022-09-21 16:57:10 INFO  Estimated runtime of original DAG is 1788.6197566986084ms
2022-09-21 16:57:10 INFO  Performing Multi-Query Optimization
2022-09-21 16:57:10 INFO  Estimated unoptimized what-if runtime is 10731.71854019165ms
2022-09-21 16:57:10 INFO  Estimated optimised what-if runtime is 1799.9370098114014ms
2022-09-21 16:57:10 INFO  Estimated optimisation runtime saving is 8931.781530380249ms
2022-09-21 16:57:10 INFO  ---RUNTIME: Multi-Query Optimization took 14.863967895507812 ms
2022-09-21 16:57:10 INFO  Executing generated plans
2022-09-21 16:57:12 INFO  ---RUNTIME: Execution took 1778.688669204712 ms
2022-09-21 16:57:12 INFO  Done!
2022-09-21 16:57:12 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-21 16:57:12 INFO  Running instrumented original pipeline...
2022-09-21 16:57:13 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-21 16:57:13 INFO  ---RUNTIME: Importing and monkey-patching took 5.882024765014648 ms
2022-09-21 16:57:15 INFO  ---RUNTIME: Original pipeline execution took 2267.863988876343 ms (excluding imports and monkey-patching)
2022-09-21 16:57:15 INFO  Starting execution of 1 what-if analyses...
2022-09-21 16:57:15 INFO  Start plan generation for analysis PermutationFeatureImportance...
2022-09-21 16:57:15 INFO  ---RUNTIME: Plan generation took 0.10633468627929688 ms
2022-09-21 16:57:15 INFO  Estimated runtime of original DAG is 1739.4845485687256ms
2022-09-21 16:57:15 WARNING Skipping Multi-Query Optimization (instead, only applying patches)
2022-09-21 16:57:15 INFO  Estimated unoptimised what-if runtime is 10436.907291412354ms
2022-09-21 16:57:15 INFO  ---RUNTIME: Multi-Query Optimization took 5.491971969604492 ms
2022-09-21 16:57:15 INFO  Executing generated plans
2022-09-21 16:57:25 INFO  ---RUNTIME: Execution took 10598.434448242188 ms
2022-09-21 16:57:25 INFO  Done!
2022-09-21 16:57:25 INFO  # Finished -- repetition 6 of 7 
2022-09-21 16:57:25 INFO  # Optimization benchmark for feature_importance with args [['healthcare', 'slow_loading', 'featurization_3', 'logistic_regression']] -- repetition 7 of 7
2022-09-21 16:57:25 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-21 16:57:25 INFO  Running instrumented original pipeline...
2022-09-21 16:57:25 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-21 16:57:25 INFO  ---RUNTIME: Importing and monkey-patching took 5.724906921386719 ms
2022-09-21 16:57:27 INFO  ---RUNTIME: Original pipeline execution took 2048.5785007476807 ms (excluding imports and monkey-patching)
2022-09-21 16:57:27 INFO  Starting execution of 1 what-if analyses...
2022-09-21 16:57:27 INFO  Start plan generation for analysis PermutationFeatureImportance...
2022-09-21 16:57:27 INFO  ---RUNTIME: Plan generation took 0.13399124145507812 ms
2022-09-21 16:57:27 INFO  Estimated runtime of original DAG is 1731.7357063293457ms
2022-09-21 16:57:27 INFO  Performing Multi-Query Optimization
2022-09-21 16:57:27 INFO  Estimated unoptimized what-if runtime is 10390.414237976074ms
2022-09-21 16:57:27 INFO  Estimated optimised what-if runtime is 1743.3679103851318ms
2022-09-21 16:57:27 INFO  Estimated optimisation runtime saving is 8647.046327590942ms
2022-09-21 16:57:27 INFO  ---RUNTIME: Multi-Query Optimization took 14.50967788696289 ms
2022-09-21 16:57:27 INFO  Executing generated plans
2022-09-21 16:57:29 INFO  ---RUNTIME: Execution took 1768.4497833251953 ms
2022-09-21 16:57:29 INFO  Done!
2022-09-21 16:57:29 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-21 16:57:29 INFO  Running instrumented original pipeline...
2022-09-21 16:57:29 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-21 16:57:29 INFO  ---RUNTIME: Importing and monkey-patching took 5.831241607666016 ms
2022-09-21 16:57:31 INFO  ---RUNTIME: Original pipeline execution took 2053.8032054901123 ms (excluding imports and monkey-patching)
2022-09-21 16:57:31 INFO  Starting execution of 1 what-if analyses...
2022-09-21 16:57:31 INFO  Start plan generation for analysis PermutationFeatureImportance...
2022-09-21 16:57:31 INFO  ---RUNTIME: Plan generation took 0.10561943054199219 ms
2022-09-21 16:57:31 INFO  Estimated runtime of original DAG is 1745.954990386963ms
2022-09-21 16:57:31 WARNING Skipping Multi-Query Optimization (instead, only applying patches)
2022-09-21 16:57:31 INFO  Estimated unoptimised what-if runtime is 10475.729942321777ms
2022-09-21 16:57:31 INFO  ---RUNTIME: Multi-Query Optimization took 5.590915679931641 ms
2022-09-21 16:57:31 INFO  Executing generated plans
2022-09-21 16:57:42 INFO  ---RUNTIME: Execution took 10535.710573196411 ms
2022-09-21 16:57:42 INFO  Done!
2022-09-21 16:57:42 INFO  # Finished -- repetition 7 of 7 
2022-09-21 16:57:42 INFO  # Final results after all repetitions
2022-09-21 16:57:42 INFO     repetition  ... no_opt_what_if_execution_combined_model_training
0           0  ...                                         6.740093
1           1  ...                                         6.533861
2           2  ...                                         6.717443
3           3  ...                                         6.518126
4           4  ...                                         6.808281
5           5  ...                                         6.670237
6           6  ...                                         6.691456

[7 rows x 26 columns]
taskset -c 0-7 PROTOCOL_BUFFERS_PYTHON_IMPLEMENTATION=python python3.9 benchmarks_end_to_end.py feature_importance healthcare slow_loading featurization_3 xgboost
2022-09-21 16:57:44.198375: W tensorflow/stream_executor/platform/default/dso_loader.cc:64] Could not load dynamic library 'libcudart.so.11.0'; dlerror: libcudart.so.11.0: cannot open shared object file: No such file or directory; LD_LIBRARY_PATH: /home/sgrafbe/mlwhatif/venv/lib/python3.9/site-packages/cv2/../../lib64:
2022-09-21 16:57:44.198415: I tensorflow/stream_executor/cuda/cudart_stub.cc:29] Ignore above cudart dlerror if you do not have a GPU set up on your machine.
2022-09-21 16:57:45 INFO  Patching sys.argv with ['mlwhatif', 'healthcare', 'slow_loading', 'featurization_3', 'xgboost']
2022-09-21 16:57:45 INFO  Running instrumented original pipeline...
2022-09-21 16:57:45 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-21 16:57:45 INFO  ---RUNTIME: Importing and monkey-patching took 95.50762176513672 ms
2022-09-21 16:57:49 INFO  ---RUNTIME: Original pipeline execution took 3457.8747749328613 ms (excluding imports and monkey-patching)
2022-09-21 16:57:49 INFO  Starting execution of 0 what-if analyses...
2022-09-21 16:57:49 INFO  Estimated runtime of original DAG is 3110.8338832855225ms
2022-09-21 16:57:49 INFO  Performing Multi-Query Optimization
2022-09-21 16:57:49 INFO  Estimated unoptimized what-if runtime is 0ms
2022-09-21 16:57:49 INFO  Estimated optimised what-if runtime is 0ms
2022-09-21 16:57:49 INFO  Estimated optimisation runtime saving is 0ms
2022-09-21 16:57:49 INFO  ---RUNTIME: Multi-Query Optimization took 0.5228519439697266 ms
2022-09-21 16:57:49 INFO  Executing generated plans
2022-09-21 16:57:49 INFO  ---RUNTIME: Execution took 0.022172927856445312 ms
2022-09-21 16:57:49 INFO  Done!
2022-09-21 16:57:49 INFO  # Optimization benchmark for feature_importance with args [['healthcare', 'slow_loading', 'featurization_3', 'xgboost']] -- repetition 1 of 7
2022-09-21 16:57:49 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-21 16:57:49 INFO  Running instrumented original pipeline...
2022-09-21 16:57:49 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-21 16:57:49 INFO  ---RUNTIME: Importing and monkey-patching took 5.102872848510742 ms
2022-09-21 16:57:53 INFO  ---RUNTIME: Original pipeline execution took 4275.173664093018 ms (excluding imports and monkey-patching)
2022-09-21 16:57:53 INFO  Starting execution of 1 what-if analyses...
2022-09-21 16:57:53 INFO  Start plan generation for analysis PermutationFeatureImportance...
2022-09-21 16:57:53 INFO  ---RUNTIME: Plan generation took 0.26106834411621094 ms
2022-09-21 16:57:53 INFO  Estimated runtime of original DAG is 3956.2840461730957ms
2022-09-21 16:57:53 INFO  Performing Multi-Query Optimization
2022-09-21 16:57:53 INFO  Estimated unoptimized what-if runtime is 23737.704277038574ms
2022-09-21 16:57:53 INFO  Estimated optimised what-if runtime is 3978.0476093292236ms
2022-09-21 16:57:53 INFO  Estimated optimisation runtime saving is 19759.65666770935ms
2022-09-21 16:57:53 INFO  ---RUNTIME: Multi-Query Optimization took 14.759540557861328 ms
2022-09-21 16:57:53 INFO  Executing generated plans
2022-09-21 16:57:55 INFO  ---RUNTIME: Execution took 2030.1704406738281 ms
2022-09-21 16:57:55 INFO  Done!
2022-09-21 16:57:55 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-21 16:57:55 INFO  Running instrumented original pipeline...
2022-09-21 16:57:55 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-21 16:57:55 INFO  ---RUNTIME: Importing and monkey-patching took 6.0291290283203125 ms
2022-09-21 16:57:57 INFO  ---RUNTIME: Original pipeline execution took 2458.4009647369385 ms (excluding imports and monkey-patching)
2022-09-21 16:57:57 INFO  Starting execution of 1 what-if analyses...
2022-09-21 16:57:57 INFO  Start plan generation for analysis PermutationFeatureImportance...
2022-09-21 16:57:57 INFO  ---RUNTIME: Plan generation took 0.1392364501953125 ms
2022-09-21 16:57:57 INFO  Estimated runtime of original DAG is 1970.9258079528809ms
2022-09-21 16:57:57 WARNING Skipping Multi-Query Optimization (instead, only applying patches)
2022-09-21 16:57:57 INFO  Estimated unoptimised what-if runtime is 11825.554847717285ms
2022-09-21 16:57:57 INFO  ---RUNTIME: Multi-Query Optimization took 5.540609359741211 ms
2022-09-21 16:57:57 INFO  Executing generated plans
2022-09-21 16:58:14 INFO  ---RUNTIME: Execution took 16317.044258117676 ms
2022-09-21 16:58:14 INFO  Done!
2022-09-21 16:58:14 INFO  # Finished -- repetition 1 of 7 
2022-09-21 16:58:14 INFO  # Optimization benchmark for feature_importance with args [['healthcare', 'slow_loading', 'featurization_3', 'xgboost']] -- repetition 2 of 7
2022-09-21 16:58:14 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-21 16:58:14 INFO  Running instrumented original pipeline...
2022-09-21 16:58:14 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-21 16:58:14 INFO  ---RUNTIME: Importing and monkey-patching took 6.047248840332031 ms
2022-09-21 16:58:16 INFO  ---RUNTIME: Original pipeline execution took 2260.4856491088867 ms (excluding imports and monkey-patching)
2022-09-21 16:58:16 INFO  Starting execution of 1 what-if analyses...
2022-09-21 16:58:16 INFO  Start plan generation for analysis PermutationFeatureImportance...
2022-09-21 16:58:16 INFO  ---RUNTIME: Plan generation took 0.1723766326904297 ms
2022-09-21 16:58:16 INFO  Estimated runtime of original DAG is 1941.8604373931885ms
2022-09-21 16:58:16 INFO  Performing Multi-Query Optimization
2022-09-21 16:58:16 INFO  Estimated unoptimized what-if runtime is 11651.16262435913ms
2022-09-21 16:58:16 INFO  Estimated optimised what-if runtime is 1961.48681640625ms
2022-09-21 16:58:16 INFO  Estimated optimisation runtime saving is 9689.67580795288ms
2022-09-21 16:58:16 INFO  ---RUNTIME: Multi-Query Optimization took 14.590978622436523 ms
2022-09-21 16:58:16 INFO  Executing generated plans
2022-09-21 16:58:19 INFO  ---RUNTIME: Execution took 3170.8216667175293 ms
2022-09-21 16:58:19 INFO  Done!
2022-09-21 16:58:19 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-21 16:58:19 INFO  Running instrumented original pipeline...
2022-09-21 16:58:19 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-21 16:58:19 INFO  ---RUNTIME: Importing and monkey-patching took 5.93256950378418 ms
2022-09-21 16:58:21 INFO  ---RUNTIME: Original pipeline execution took 2278.7816524505615 ms (excluding imports and monkey-patching)
2022-09-21 16:58:21 INFO  Starting execution of 1 what-if analyses...
2022-09-21 16:58:21 INFO  Start plan generation for analysis PermutationFeatureImportance...
2022-09-21 16:58:21 INFO  ---RUNTIME: Plan generation took 0.11348724365234375 ms
2022-09-21 16:58:21 INFO  Estimated runtime of original DAG is 1955.235481262207ms
2022-09-21 16:58:21 WARNING Skipping Multi-Query Optimization (instead, only applying patches)
2022-09-21 16:58:21 INFO  Estimated unoptimised what-if runtime is 11731.412887573242ms
2022-09-21 16:58:21 INFO  ---RUNTIME: Multi-Query Optimization took 5.684852600097656 ms
2022-09-21 16:58:21 INFO  Executing generated plans
2022-09-21 16:58:40 INFO  ---RUNTIME: Execution took 18134.49215888977 ms
2022-09-21 16:58:40 INFO  Done!
2022-09-21 16:58:40 INFO  # Finished -- repetition 2 of 7 
2022-09-21 16:58:40 INFO  # Optimization benchmark for feature_importance with args [['healthcare', 'slow_loading', 'featurization_3', 'xgboost']] -- repetition 3 of 7
2022-09-21 16:58:40 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-21 16:58:40 INFO  Running instrumented original pipeline...
2022-09-21 16:58:40 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-21 16:58:40 INFO  ---RUNTIME: Importing and monkey-patching took 6.056547164916992 ms
2022-09-21 16:58:42 INFO  ---RUNTIME: Original pipeline execution took 2356.006622314453 ms (excluding imports and monkey-patching)
2022-09-21 16:58:42 INFO  Starting execution of 1 what-if analyses...
2022-09-21 16:58:42 INFO  Start plan generation for analysis PermutationFeatureImportance...
2022-09-21 16:58:42 INFO  ---RUNTIME: Plan generation took 0.14090538024902344 ms
2022-09-21 16:58:42 INFO  Estimated runtime of original DAG is 2032.0987701416016ms
2022-09-21 16:58:42 INFO  Performing Multi-Query Optimization
2022-09-21 16:58:42 INFO  Estimated unoptimized what-if runtime is 12192.59262084961ms
2022-09-21 16:58:42 INFO  Estimated optimised what-if runtime is 2058.5360527038574ms
2022-09-21 16:58:42 INFO  Estimated optimisation runtime saving is 10134.056568145752ms
2022-09-21 16:58:42 INFO  ---RUNTIME: Multi-Query Optimization took 14.483213424682617 ms
2022-09-21 16:58:42 INFO  Executing generated plans
2022-09-21 16:58:45 INFO  ---RUNTIME: Execution took 2861.4985942840576 ms
2022-09-21 16:58:45 INFO  Done!
2022-09-21 16:58:45 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-21 16:58:45 INFO  Running instrumented original pipeline...
2022-09-21 16:58:45 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-21 16:58:45 INFO  ---RUNTIME: Importing and monkey-patching took 5.625486373901367 ms
2022-09-21 16:58:47 INFO  ---RUNTIME: Original pipeline execution took 2454.4801712036133 ms (excluding imports and monkey-patching)
2022-09-21 16:58:47 INFO  Starting execution of 1 what-if analyses...
2022-09-21 16:58:47 INFO  Start plan generation for analysis PermutationFeatureImportance...
2022-09-21 16:58:47 INFO  ---RUNTIME: Plan generation took 0.12373924255371094 ms
2022-09-21 16:58:47 INFO  Estimated runtime of original DAG is 2130.483627319336ms
2022-09-21 16:58:47 WARNING Skipping Multi-Query Optimization (instead, only applying patches)
2022-09-21 16:58:47 INFO  Estimated unoptimised what-if runtime is 12782.901763916016ms
2022-09-21 16:58:47 INFO  ---RUNTIME: Multi-Query Optimization took 5.528450012207031 ms
2022-09-21 16:58:47 INFO  Executing generated plans
2022-09-21 16:59:00 INFO  ---RUNTIME: Execution took 12871.684312820435 ms
2022-09-21 16:59:00 INFO  Done!
2022-09-21 16:59:00 INFO  # Finished -- repetition 3 of 7 
2022-09-21 16:59:00 INFO  # Optimization benchmark for feature_importance with args [['healthcare', 'slow_loading', 'featurization_3', 'xgboost']] -- repetition 4 of 7
2022-09-21 16:59:00 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-21 16:59:00 INFO  Running instrumented original pipeline...
2022-09-21 16:59:00 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-21 16:59:00 INFO  ---RUNTIME: Importing and monkey-patching took 5.822658538818359 ms
2022-09-21 16:59:02 INFO  ---RUNTIME: Original pipeline execution took 2271.8441486358643 ms (excluding imports and monkey-patching)
2022-09-21 16:59:02 INFO  Starting execution of 1 what-if analyses...
2022-09-21 16:59:02 INFO  Start plan generation for analysis PermutationFeatureImportance...
2022-09-21 16:59:02 INFO  ---RUNTIME: Plan generation took 0.11134147644042969 ms
2022-09-21 16:59:02 INFO  Estimated runtime of original DAG is 1952.897071838379ms
2022-09-21 16:59:02 INFO  Performing Multi-Query Optimization
2022-09-21 16:59:02 INFO  Estimated unoptimized what-if runtime is 11717.382431030273ms
2022-09-21 16:59:02 INFO  Estimated optimised what-if runtime is 1972.3291397094727ms
2022-09-21 16:59:02 INFO  Estimated optimisation runtime saving is 9745.0532913208ms
2022-09-21 16:59:02 INFO  ---RUNTIME: Multi-Query Optimization took 14.766454696655273 ms
2022-09-21 16:59:02 INFO  Executing generated plans
2022-09-21 16:59:04 INFO  ---RUNTIME: Execution took 2022.2599506378174 ms
2022-09-21 16:59:04 INFO  Done!
2022-09-21 16:59:04 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-21 16:59:04 INFO  Running instrumented original pipeline...
2022-09-21 16:59:04 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-21 16:59:04 INFO  ---RUNTIME: Importing and monkey-patching took 5.574226379394531 ms
2022-09-21 16:59:07 INFO  ---RUNTIME: Original pipeline execution took 2383.6991786956787 ms (excluding imports and monkey-patching)
2022-09-21 16:59:07 INFO  Starting execution of 1 what-if analyses...
2022-09-21 16:59:07 INFO  Start plan generation for analysis PermutationFeatureImportance...
2022-09-21 16:59:07 INFO  ---RUNTIME: Plan generation took 0.11920928955078125 ms
2022-09-21 16:59:07 INFO  Estimated runtime of original DAG is 2066.8957233428955ms
2022-09-21 16:59:07 WARNING Skipping Multi-Query Optimization (instead, only applying patches)
2022-09-21 16:59:07 INFO  Estimated unoptimised what-if runtime is 12401.374340057373ms
2022-09-21 16:59:07 INFO  ---RUNTIME: Multi-Query Optimization took 5.464792251586914 ms
2022-09-21 16:59:07 INFO  Executing generated plans
2022-09-21 16:59:22 INFO  ---RUNTIME: Execution took 15081.106424331665 ms
2022-09-21 16:59:22 INFO  Done!
2022-09-21 16:59:22 INFO  # Finished -- repetition 4 of 7 
2022-09-21 16:59:22 INFO  # Optimization benchmark for feature_importance with args [['healthcare', 'slow_loading', 'featurization_3', 'xgboost']] -- repetition 5 of 7
2022-09-21 16:59:22 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-21 16:59:22 INFO  Running instrumented original pipeline...
2022-09-21 16:59:22 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-21 16:59:22 INFO  ---RUNTIME: Importing and monkey-patching took 5.869865417480469 ms
2022-09-21 16:59:24 INFO  ---RUNTIME: Original pipeline execution took 2280.5888652801514 ms (excluding imports and monkey-patching)
2022-09-21 16:59:24 INFO  Starting execution of 1 what-if analyses...
2022-09-21 16:59:24 INFO  Start plan generation for analysis PermutationFeatureImportance...
2022-09-21 16:59:24 INFO  ---RUNTIME: Plan generation took 0.110626220703125 ms
2022-09-21 16:59:24 INFO  Estimated runtime of original DAG is 1963.942527770996ms
2022-09-21 16:59:24 INFO  Performing Multi-Query Optimization
2022-09-21 16:59:24 INFO  Estimated unoptimized what-if runtime is 11783.655166625977ms
2022-09-21 16:59:24 INFO  Estimated optimised what-if runtime is 1983.2637310028076ms
2022-09-21 16:59:24 INFO  Estimated optimisation runtime saving is 9800.391435623169ms
2022-09-21 16:59:24 INFO  ---RUNTIME: Multi-Query Optimization took 14.407873153686523 ms
2022-09-21 16:59:24 INFO  Executing generated plans
2022-09-21 16:59:26 INFO  ---RUNTIME: Execution took 2001.880407333374 ms
2022-09-21 16:59:26 INFO  Done!
2022-09-21 16:59:26 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-21 16:59:26 INFO  Running instrumented original pipeline...
2022-09-21 16:59:26 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-21 16:59:26 INFO  ---RUNTIME: Importing and monkey-patching took 6.155729293823242 ms
2022-09-21 16:59:28 INFO  ---RUNTIME: Original pipeline execution took 2270.99609375 ms (excluding imports and monkey-patching)
2022-09-21 16:59:28 INFO  Starting execution of 1 what-if analyses...
2022-09-21 16:59:28 INFO  Start plan generation for analysis PermutationFeatureImportance...
2022-09-21 16:59:28 INFO  ---RUNTIME: Plan generation took 0.11682510375976562 ms
2022-09-21 16:59:28 INFO  Estimated runtime of original DAG is 1951.62034034729ms
2022-09-21 16:59:28 WARNING Skipping Multi-Query Optimization (instead, only applying patches)
2022-09-21 16:59:28 INFO  Estimated unoptimised what-if runtime is 11709.72204208374ms
2022-09-21 16:59:28 INFO  ---RUNTIME: Multi-Query Optimization took 5.396842956542969 ms
2022-09-21 16:59:28 INFO  Executing generated plans
2022-09-21 16:59:40 INFO  ---RUNTIME: Execution took 11936.03539466858 ms
2022-09-21 16:59:40 INFO  Done!
2022-09-21 16:59:40 INFO  # Finished -- repetition 5 of 7 
2022-09-21 16:59:40 INFO  # Optimization benchmark for feature_importance with args [['healthcare', 'slow_loading', 'featurization_3', 'xgboost']] -- repetition 6 of 7
2022-09-21 16:59:40 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-21 16:59:40 INFO  Running instrumented original pipeline...
2022-09-21 16:59:40 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-21 16:59:40 INFO  ---RUNTIME: Importing and monkey-patching took 5.985498428344727 ms
2022-09-21 16:59:43 INFO  ---RUNTIME: Original pipeline execution took 2273.31805229187 ms (excluding imports and monkey-patching)
2022-09-21 16:59:43 INFO  Starting execution of 1 what-if analyses...
2022-09-21 16:59:43 INFO  Start plan generation for analysis PermutationFeatureImportance...
2022-09-21 16:59:43 INFO  ---RUNTIME: Plan generation took 0.11682510375976562 ms
2022-09-21 16:59:43 INFO  Estimated runtime of original DAG is 1955.6670188903809ms
2022-09-21 16:59:43 INFO  Performing Multi-Query Optimization
2022-09-21 16:59:43 INFO  Estimated unoptimized what-if runtime is 11734.002113342285ms
2022-09-21 16:59:43 INFO  Estimated optimised what-if runtime is 1975.2109050750732ms
2022-09-21 16:59:43 INFO  Estimated optimisation runtime saving is 9758.791208267212ms
2022-09-21 16:59:43 INFO  ---RUNTIME: Multi-Query Optimization took 14.868497848510742 ms
2022-09-21 16:59:43 INFO  Executing generated plans
2022-09-21 16:59:45 INFO  ---RUNTIME: Execution took 2001.3165473937988 ms
2022-09-21 16:59:45 INFO  Done!
2022-09-21 16:59:45 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-21 16:59:45 INFO  Running instrumented original pipeline...
2022-09-21 16:59:45 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-21 16:59:45 INFO  ---RUNTIME: Importing and monkey-patching took 5.692243576049805 ms
2022-09-21 16:59:47 INFO  ---RUNTIME: Original pipeline execution took 2518.6710357666016 ms (excluding imports and monkey-patching)
2022-09-21 16:59:47 INFO  Starting execution of 1 what-if analyses...
2022-09-21 16:59:47 INFO  Start plan generation for analysis PermutationFeatureImportance...
2022-09-21 16:59:47 INFO  ---RUNTIME: Plan generation took 0.15783309936523438 ms
2022-09-21 16:59:47 INFO  Estimated runtime of original DAG is 1976.1219024658203ms
2022-09-21 16:59:47 WARNING Skipping Multi-Query Optimization (instead, only applying patches)
2022-09-21 16:59:47 INFO  Estimated unoptimised what-if runtime is 11856.731414794922ms
2022-09-21 16:59:47 INFO  ---RUNTIME: Multi-Query Optimization took 5.514383316040039 ms
2022-09-21 16:59:47 INFO  Executing generated plans
2022-09-21 16:59:59 INFO  ---RUNTIME: Execution took 11891.502618789673 ms
2022-09-21 16:59:59 INFO  Done!
2022-09-21 16:59:59 INFO  # Finished -- repetition 6 of 7 
2022-09-21 16:59:59 INFO  # Optimization benchmark for feature_importance with args [['healthcare', 'slow_loading', 'featurization_3', 'xgboost']] -- repetition 7 of 7
2022-09-21 16:59:59 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-21 16:59:59 INFO  Running instrumented original pipeline...
2022-09-21 16:59:59 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-21 16:59:59 INFO  ---RUNTIME: Importing and monkey-patching took 5.9223175048828125 ms
2022-09-21 17:00:01 INFO  ---RUNTIME: Original pipeline execution took 2266.174077987671 ms (excluding imports and monkey-patching)
2022-09-21 17:00:01 INFO  Starting execution of 1 what-if analyses...
2022-09-21 17:00:01 INFO  Start plan generation for analysis PermutationFeatureImportance...
2022-09-21 17:00:01 INFO  ---RUNTIME: Plan generation took 0.1163482666015625 ms
2022-09-21 17:00:01 INFO  Estimated runtime of original DAG is 1951.204538345337ms
2022-09-21 17:00:01 INFO  Performing Multi-Query Optimization
2022-09-21 17:00:01 INFO  Estimated unoptimized what-if runtime is 11707.227230072021ms
2022-09-21 17:00:01 INFO  Estimated optimised what-if runtime is 1970.5829620361328ms
2022-09-21 17:00:01 INFO  Estimated optimisation runtime saving is 9736.644268035889ms
2022-09-21 17:00:01 INFO  ---RUNTIME: Multi-Query Optimization took 14.554500579833984 ms
2022-09-21 17:00:01 INFO  Executing generated plans
2022-09-21 17:00:03 INFO  ---RUNTIME: Execution took 1994.035005569458 ms
2022-09-21 17:00:03 INFO  Done!
2022-09-21 17:00:03 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-21 17:00:03 INFO  Running instrumented original pipeline...
2022-09-21 17:00:03 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-21 17:00:03 INFO  ---RUNTIME: Importing and monkey-patching took 5.721330642700195 ms
2022-09-21 17:00:06 INFO  ---RUNTIME: Original pipeline execution took 2288.9280319213867 ms (excluding imports and monkey-patching)
2022-09-21 17:00:06 INFO  Starting execution of 1 what-if analyses...
2022-09-21 17:00:06 INFO  Start plan generation for analysis PermutationFeatureImportance...
2022-09-21 17:00:06 INFO  ---RUNTIME: Plan generation took 0.12731552124023438 ms
2022-09-21 17:00:06 INFO  Estimated runtime of original DAG is 1967.214584350586ms
2022-09-21 17:00:06 WARNING Skipping Multi-Query Optimization (instead, only applying patches)
2022-09-21 17:00:06 INFO  Estimated unoptimised what-if runtime is 11803.287506103516ms
2022-09-21 17:00:06 INFO  ---RUNTIME: Multi-Query Optimization took 5.563974380493164 ms
2022-09-21 17:00:06 INFO  Executing generated plans
2022-09-21 17:00:18 INFO  ---RUNTIME: Execution took 11969.863891601562 ms
2022-09-21 17:00:18 INFO  Done!
2022-09-21 17:00:18 INFO  # Finished -- repetition 7 of 7 
2022-09-21 17:00:18 INFO  # Final results after all repetitions
2022-09-21 17:00:18 INFO     repetition  ... no_opt_what_if_execution_combined_model_training
0           0  ...                                      5404.412508
1           1  ...                                      7355.958939
2           2  ...                                      1552.566767
3           3  ...                                      4382.021427
4           4  ...                                      1234.557152
5           5  ...                                      1127.767801
6           6  ...                                      1125.270605

[7 rows x 26 columns]
taskset -c 0-7 PROTOCOL_BUFFERS_PYTHON_IMPLEMENTATION=python python3.9 benchmarks_end_to_end.py feature_importance healthcare slow_loading featurization_3 neural_network
2022-09-21 17:00:20.274588: W tensorflow/stream_executor/platform/default/dso_loader.cc:64] Could not load dynamic library 'libcudart.so.11.0'; dlerror: libcudart.so.11.0: cannot open shared object file: No such file or directory; LD_LIBRARY_PATH: /home/sgrafbe/mlwhatif/venv/lib/python3.9/site-packages/cv2/../../lib64:
2022-09-21 17:00:20.274632: I tensorflow/stream_executor/cuda/cudart_stub.cc:29] Ignore above cudart dlerror if you do not have a GPU set up on your machine.
2022-09-21 17:00:21 INFO  Patching sys.argv with ['mlwhatif', 'healthcare', 'slow_loading', 'featurization_3', 'neural_network']
2022-09-21 17:00:21 INFO  Running instrumented original pipeline...
2022-09-21 17:00:21 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-21 17:00:21 INFO  ---RUNTIME: Importing and monkey-patching took 95.9162712097168 ms
2022-09-21 17:00:23.759990: W tensorflow/stream_executor/platform/default/dso_loader.cc:64] Could not load dynamic library 'libcuda.so.1'; dlerror: libcuda.so.1: cannot open shared object file: No such file or directory; LD_LIBRARY_PATH: /home/sgrafbe/mlwhatif/venv/lib/python3.9/site-packages/cv2/../../lib64:
2022-09-21 17:00:23.760025: W tensorflow/stream_executor/cuda/cuda_driver.cc:326] failed call to cuInit: UNKNOWN ERROR (303)
2022-09-21 17:00:23.760055: I tensorflow/stream_executor/cuda/cuda_diagnostics.cc:156] kernel driver does not appear to be running on this host (wagyu): /proc/driver/nvidia/version does not exist
2022-09-21 17:00:23.760551: I tensorflow/core/platform/cpu_feature_guard.cc:142] This TensorFlow binary is optimized with oneAPI Deep Neural Network Library (oneDNN) to use the following CPU instructions in performance-critical operations:  AVX2 FMA
To enable them in other operations, rebuild TensorFlow with the appropriate compiler flags.
2022-09-21 17:00:24.312321: I tensorflow/compiler/mlir/mlir_graph_optimization_pass.cc:176] None of the MLIR Optimization Passes are enabled (registered 2)
2022-09-21 17:00:24.326442: I tensorflow/core/platform/profile_utils/cpu_utils.cc:114] CPU Frequency: 2595290000 Hz
2022-09-21 17:00:24 INFO  ---RUNTIME: Original pipeline execution took 2951.042652130127 ms (excluding imports and monkey-patching)
2022-09-21 17:00:24 INFO  Starting execution of 0 what-if analyses...
2022-09-21 17:00:24 INFO  Estimated runtime of original DAG is 2607.034683227539ms
2022-09-21 17:00:24 INFO  Performing Multi-Query Optimization
2022-09-21 17:00:24 INFO  Estimated unoptimized what-if runtime is 0ms
2022-09-21 17:00:24 INFO  Estimated optimised what-if runtime is 0ms
2022-09-21 17:00:24 INFO  Estimated optimisation runtime saving is 0ms
2022-09-21 17:00:24 INFO  ---RUNTIME: Multi-Query Optimization took 0.5273818969726562 ms
2022-09-21 17:00:24 INFO  Executing generated plans
2022-09-21 17:00:24 INFO  ---RUNTIME: Execution took 0.01621246337890625 ms
2022-09-21 17:00:24 INFO  Done!
2022-09-21 17:00:24 INFO  # Optimization benchmark for feature_importance with args [['healthcare', 'slow_loading', 'featurization_3', 'neural_network']] -- repetition 1 of 7
2022-09-21 17:00:24 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-21 17:00:24 INFO  Running instrumented original pipeline...
2022-09-21 17:00:24 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-21 17:00:24 INFO  ---RUNTIME: Importing and monkey-patching took 5.105018615722656 ms
2022-09-21 17:00:27 INFO  ---RUNTIME: Original pipeline execution took 2563.646078109741 ms (excluding imports and monkey-patching)
2022-09-21 17:00:27 INFO  Starting execution of 1 what-if analyses...
2022-09-21 17:00:27 INFO  Start plan generation for analysis PermutationFeatureImportance...
2022-09-21 17:00:27 INFO  ---RUNTIME: Plan generation took 0.2338886260986328 ms
2022-09-21 17:00:27 INFO  Estimated runtime of original DAG is 2252.4359226226807ms
2022-09-21 17:00:27 INFO  Performing Multi-Query Optimization
2022-09-21 17:00:27 INFO  Estimated unoptimized what-if runtime is 13514.615535736084ms
2022-09-21 17:00:27 INFO  Estimated optimised what-if runtime is 2535.862445831299ms
2022-09-21 17:00:27 INFO  Estimated optimisation runtime saving is 10978.753089904785ms
2022-09-21 17:00:27 INFO  ---RUNTIME: Multi-Query Optimization took 14.403343200683594 ms
2022-09-21 17:00:27 INFO  Executing generated plans
2022-09-21 17:00:29 INFO  ---RUNTIME: Execution took 2340.481758117676 ms
2022-09-21 17:00:29 INFO  Done!
2022-09-21 17:00:29 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-21 17:00:29 INFO  Running instrumented original pipeline...
2022-09-21 17:00:29 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-21 17:00:29 INFO  ---RUNTIME: Importing and monkey-patching took 5.706787109375 ms
2022-09-21 17:00:32 INFO  ---RUNTIME: Original pipeline execution took 2764.1706466674805 ms (excluding imports and monkey-patching)
2022-09-21 17:00:32 INFO  Starting execution of 1 what-if analyses...
2022-09-21 17:00:32 INFO  Start plan generation for analysis PermutationFeatureImportance...
2022-09-21 17:00:32 INFO  ---RUNTIME: Plan generation took 0.10609626770019531 ms
2022-09-21 17:00:32 INFO  Estimated runtime of original DAG is 2443.5629844665527ms
2022-09-21 17:00:32 WARNING Skipping Multi-Query Optimization (instead, only applying patches)
2022-09-21 17:00:32 INFO  Estimated unoptimised what-if runtime is 14661.377906799316ms
2022-09-21 17:00:32 INFO  ---RUNTIME: Multi-Query Optimization took 5.27501106262207 ms
2022-09-21 17:00:32 INFO  Executing generated plans
2022-09-21 17:00:46 INFO  ---RUNTIME: Execution took 13937.114953994751 ms
2022-09-21 17:00:46 INFO  Done!
2022-09-21 17:00:46 INFO  # Finished -- repetition 1 of 7 
2022-09-21 17:00:46 INFO  # Optimization benchmark for feature_importance with args [['healthcare', 'slow_loading', 'featurization_3', 'neural_network']] -- repetition 2 of 7
2022-09-21 17:00:46 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-21 17:00:46 INFO  Running instrumented original pipeline...
2022-09-21 17:00:46 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-21 17:00:46 INFO  ---RUNTIME: Importing and monkey-patching took 5.981683731079102 ms
2022-09-21 17:00:48 INFO  ---RUNTIME: Original pipeline execution took 2571.3260173797607 ms (excluding imports and monkey-patching)
2022-09-21 17:00:48 INFO  Starting execution of 1 what-if analyses...
2022-09-21 17:00:48 INFO  Start plan generation for analysis PermutationFeatureImportance...
2022-09-21 17:00:48 INFO  ---RUNTIME: Plan generation took 0.1308917999267578 ms
2022-09-21 17:00:48 INFO  Estimated runtime of original DAG is 2255.6564807891846ms
2022-09-21 17:00:48 INFO  Performing Multi-Query Optimization
2022-09-21 17:00:48 INFO  Estimated unoptimized what-if runtime is 13533.938884735107ms
2022-09-21 17:00:48 INFO  Estimated optimised what-if runtime is 2541.0258769989014ms
2022-09-21 17:00:48 INFO  Estimated optimisation runtime saving is 10992.913007736206ms
2022-09-21 17:00:48 INFO  ---RUNTIME: Multi-Query Optimization took 14.41049575805664 ms
2022-09-21 17:00:48 INFO  Executing generated plans
2022-09-21 17:00:51 INFO  ---RUNTIME: Execution took 2310.319423675537 ms
2022-09-21 17:00:51 INFO  Done!
2022-09-21 17:00:51 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-21 17:00:51 INFO  Running instrumented original pipeline...
2022-09-21 17:00:51 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-21 17:00:51 INFO  ---RUNTIME: Importing and monkey-patching took 5.829572677612305 ms
2022-09-21 17:00:53 INFO  ---RUNTIME: Original pipeline execution took 2880.439043045044 ms (excluding imports and monkey-patching)
2022-09-21 17:00:53 INFO  Starting execution of 1 what-if analyses...
2022-09-21 17:00:53 INFO  Start plan generation for analysis PermutationFeatureImportance...
2022-09-21 17:00:53 INFO  ---RUNTIME: Plan generation took 0.1316070556640625 ms
2022-09-21 17:00:53 INFO  Estimated runtime of original DAG is 2562.427759170532ms
2022-09-21 17:00:53 WARNING Skipping Multi-Query Optimization (instead, only applying patches)
2022-09-21 17:00:53 INFO  Estimated unoptimised what-if runtime is 15374.566555023193ms
2022-09-21 17:00:53 INFO  ---RUNTIME: Multi-Query Optimization took 5.400896072387695 ms
2022-09-21 17:00:53 INFO  Executing generated plans
2022-09-21 17:01:07 INFO  ---RUNTIME: Execution took 13985.981702804565 ms
2022-09-21 17:01:07 INFO  Done!
2022-09-21 17:01:07 INFO  # Finished -- repetition 2 of 7 
2022-09-21 17:01:07 INFO  # Optimization benchmark for feature_importance with args [['healthcare', 'slow_loading', 'featurization_3', 'neural_network']] -- repetition 3 of 7
2022-09-21 17:01:07 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-21 17:01:07 INFO  Running instrumented original pipeline...
2022-09-21 17:01:08 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-21 17:01:08 INFO  ---RUNTIME: Importing and monkey-patching took 8.831501007080078 ms
2022-09-21 17:01:10 INFO  ---RUNTIME: Original pipeline execution took 2583.469867706299 ms (excluding imports and monkey-patching)
2022-09-21 17:01:10 INFO  Starting execution of 1 what-if analyses...
2022-09-21 17:01:10 INFO  Start plan generation for analysis PermutationFeatureImportance...
2022-09-21 17:01:10 INFO  ---RUNTIME: Plan generation took 0.12755393981933594 ms
2022-09-21 17:01:10 INFO  Estimated runtime of original DAG is 2259.953260421753ms
2022-09-21 17:01:10 INFO  Performing Multi-Query Optimization
2022-09-21 17:01:10 INFO  Estimated unoptimized what-if runtime is 13559.719562530518ms
2022-09-21 17:01:10 INFO  Estimated optimised what-if runtime is 2536.7887020111084ms
2022-09-21 17:01:10 INFO  Estimated optimisation runtime saving is 11022.93086051941ms
2022-09-21 17:01:10 INFO  ---RUNTIME: Multi-Query Optimization took 15.15650749206543 ms
2022-09-21 17:01:10 INFO  Executing generated plans
2022-09-21 17:01:12 INFO  ---RUNTIME: Execution took 2332.1077823638916 ms
2022-09-21 17:01:12 INFO  Done!
2022-09-21 17:01:12 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-21 17:01:12 INFO  Running instrumented original pipeline...
2022-09-21 17:01:12 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-21 17:01:12 INFO  ---RUNTIME: Importing and monkey-patching took 5.737781524658203 ms
2022-09-21 17:01:15 INFO  ---RUNTIME: Original pipeline execution took 2606.811285018921 ms (excluding imports and monkey-patching)
2022-09-21 17:01:15 INFO  Starting execution of 1 what-if analyses...
2022-09-21 17:01:15 INFO  Start plan generation for analysis PermutationFeatureImportance...
2022-09-21 17:01:15 INFO  ---RUNTIME: Plan generation took 0.12230873107910156 ms
2022-09-21 17:01:15 INFO  Estimated runtime of original DAG is 2286.803722381592ms
2022-09-21 17:01:15 WARNING Skipping Multi-Query Optimization (instead, only applying patches)
2022-09-21 17:01:15 INFO  Estimated unoptimised what-if runtime is 13720.82233428955ms
2022-09-21 17:01:15 INFO  ---RUNTIME: Multi-Query Optimization took 5.367040634155273 ms
2022-09-21 17:01:15 INFO  Executing generated plans
2022-09-21 17:01:29 INFO  ---RUNTIME: Execution took 14018.128633499146 ms
2022-09-21 17:01:29 INFO  Done!
2022-09-21 17:01:29 INFO  # Finished -- repetition 3 of 7 
2022-09-21 17:01:29 INFO  # Optimization benchmark for feature_importance with args [['healthcare', 'slow_loading', 'featurization_3', 'neural_network']] -- repetition 4 of 7
2022-09-21 17:01:29 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-21 17:01:29 INFO  Running instrumented original pipeline...
2022-09-21 17:01:29 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-21 17:01:29 INFO  ---RUNTIME: Importing and monkey-patching took 6.0520172119140625 ms
2022-09-21 17:01:32 INFO  ---RUNTIME: Original pipeline execution took 2927.1414279937744 ms (excluding imports and monkey-patching)
2022-09-21 17:01:32 INFO  Starting execution of 1 what-if analyses...
2022-09-21 17:01:32 INFO  Start plan generation for analysis PermutationFeatureImportance...
2022-09-21 17:01:32 INFO  ---RUNTIME: Plan generation took 0.11157989501953125 ms
2022-09-21 17:01:32 INFO  Estimated runtime of original DAG is 2285.4297161102295ms
2022-09-21 17:01:32 INFO  Performing Multi-Query Optimization
2022-09-21 17:01:32 INFO  Estimated unoptimized what-if runtime is 13712.578296661377ms
2022-09-21 17:01:32 INFO  Estimated optimised what-if runtime is 2568.9635276794434ms
2022-09-21 17:01:32 INFO  Estimated optimisation runtime saving is 11143.614768981934ms
2022-09-21 17:01:32 INFO  ---RUNTIME: Multi-Query Optimization took 15.202999114990234 ms
2022-09-21 17:01:32 INFO  Executing generated plans
2022-09-21 17:01:34 INFO  ---RUNTIME: Execution took 2335.844039916992 ms
2022-09-21 17:01:34 INFO  Done!
2022-09-21 17:01:34 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-21 17:01:34 INFO  Running instrumented original pipeline...
2022-09-21 17:01:34 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-21 17:01:34 INFO  ---RUNTIME: Importing and monkey-patching took 5.815744400024414 ms
2022-09-21 17:01:37 INFO  ---RUNTIME: Original pipeline execution took 2578.913688659668 ms (excluding imports and monkey-patching)
2022-09-21 17:01:37 INFO  Starting execution of 1 what-if analyses...
2022-09-21 17:01:37 INFO  Start plan generation for analysis PermutationFeatureImportance...
2022-09-21 17:01:37 INFO  ---RUNTIME: Plan generation took 0.12731552124023438 ms
2022-09-21 17:01:37 INFO  Estimated runtime of original DAG is 2261.812925338745ms
2022-09-21 17:01:37 WARNING Skipping Multi-Query Optimization (instead, only applying patches)
2022-09-21 17:01:37 INFO  Estimated unoptimised what-if runtime is 13570.87755203247ms
2022-09-21 17:01:37 INFO  ---RUNTIME: Multi-Query Optimization took 5.517721176147461 ms
2022-09-21 17:01:37 INFO  Executing generated plans
2022-09-21 17:01:51 INFO  ---RUNTIME: Execution took 13946.502685546875 ms
2022-09-21 17:01:51 INFO  Done!
2022-09-21 17:01:51 INFO  # Finished -- repetition 4 of 7 
2022-09-21 17:01:51 INFO  # Optimization benchmark for feature_importance with args [['healthcare', 'slow_loading', 'featurization_3', 'neural_network']] -- repetition 5 of 7
2022-09-21 17:01:51 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-21 17:01:51 INFO  Running instrumented original pipeline...
2022-09-21 17:01:51 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-21 17:01:51 INFO  ---RUNTIME: Importing and monkey-patching took 5.826711654663086 ms
2022-09-21 17:01:53 INFO  ---RUNTIME: Original pipeline execution took 2564.906120300293 ms (excluding imports and monkey-patching)
2022-09-21 17:01:53 INFO  Starting execution of 1 what-if analyses...
2022-09-21 17:01:53 INFO  Start plan generation for analysis PermutationFeatureImportance...
2022-09-21 17:01:53 INFO  ---RUNTIME: Plan generation took 0.14066696166992188 ms
2022-09-21 17:01:53 INFO  Estimated runtime of original DAG is 2252.66170501709ms
2022-09-21 17:01:53 INFO  Performing Multi-Query Optimization
2022-09-21 17:01:53 INFO  Estimated unoptimized what-if runtime is 13515.970230102539ms
2022-09-21 17:01:53 INFO  Estimated optimised what-if runtime is 2535.8729362487793ms
2022-09-21 17:01:53 INFO  Estimated optimisation runtime saving is 10980.09729385376ms
2022-09-21 17:01:53 INFO  ---RUNTIME: Multi-Query Optimization took 14.389753341674805 ms
2022-09-21 17:01:53 INFO  Executing generated plans
2022-09-21 17:01:56 INFO  ---RUNTIME: Execution took 2637.0162963867188 ms
2022-09-21 17:01:56 INFO  Done!
2022-09-21 17:01:56 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-21 17:01:56 INFO  Running instrumented original pipeline...
2022-09-21 17:01:56 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-21 17:01:56 INFO  ---RUNTIME: Importing and monkey-patching took 5.932331085205078 ms
2022-09-21 17:01:59 INFO  ---RUNTIME: Original pipeline execution took 2574.337959289551 ms (excluding imports and monkey-patching)
2022-09-21 17:01:59 INFO  Starting execution of 1 what-if analyses...
2022-09-21 17:01:59 INFO  Start plan generation for analysis PermutationFeatureImportance...
2022-09-21 17:01:59 INFO  ---RUNTIME: Plan generation took 0.10848045349121094 ms
2022-09-21 17:01:59 INFO  Estimated runtime of original DAG is 2256.2406063079834ms
2022-09-21 17:01:59 WARNING Skipping Multi-Query Optimization (instead, only applying patches)
2022-09-21 17:01:59 INFO  Estimated unoptimised what-if runtime is 13537.4436378479ms
2022-09-21 17:01:59 INFO  ---RUNTIME: Multi-Query Optimization took 5.519866943359375 ms
2022-09-21 17:01:59 INFO  Executing generated plans
2022-09-21 17:02:13 INFO  ---RUNTIME: Execution took 13943.275928497314 ms
2022-09-21 17:02:13 INFO  Done!
2022-09-21 17:02:13 INFO  # Finished -- repetition 5 of 7 
2022-09-21 17:02:13 INFO  # Optimization benchmark for feature_importance with args [['healthcare', 'slow_loading', 'featurization_3', 'neural_network']] -- repetition 6 of 7
2022-09-21 17:02:13 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-21 17:02:13 INFO  Running instrumented original pipeline...
2022-09-21 17:02:13 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-21 17:02:13 INFO  ---RUNTIME: Importing and monkey-patching took 5.855798721313477 ms
2022-09-21 17:02:15 INFO  ---RUNTIME: Original pipeline execution took 2542.649507522583 ms (excluding imports and monkey-patching)
2022-09-21 17:02:15 INFO  Starting execution of 1 what-if analyses...
2022-09-21 17:02:15 INFO  Start plan generation for analysis PermutationFeatureImportance...
2022-09-21 17:02:15 INFO  ---RUNTIME: Plan generation took 0.11324882507324219 ms
2022-09-21 17:02:15 INFO  Estimated runtime of original DAG is 2227.09584236145ms
2022-09-21 17:02:15 INFO  Performing Multi-Query Optimization
2022-09-21 17:02:15 INFO  Estimated unoptimized what-if runtime is 13362.575054168701ms
2022-09-21 17:02:15 INFO  Estimated optimised what-if runtime is 2505.4314136505127ms
2022-09-21 17:02:15 INFO  Estimated optimisation runtime saving is 10857.143640518188ms
2022-09-21 17:02:15 INFO  ---RUNTIME: Multi-Query Optimization took 14.553070068359375 ms
2022-09-21 17:02:15 INFO  Executing generated plans
2022-09-21 17:02:18 INFO  ---RUNTIME: Execution took 2316.1675930023193 ms
2022-09-21 17:02:18 INFO  Done!
2022-09-21 17:02:18 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-21 17:02:18 INFO  Running instrumented original pipeline...
2022-09-21 17:02:18 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-21 17:02:18 INFO  ---RUNTIME: Importing and monkey-patching took 5.850076675415039 ms
2022-09-21 17:02:21 INFO  ---RUNTIME: Original pipeline execution took 2976.3331413269043 ms (excluding imports and monkey-patching)
2022-09-21 17:02:21 INFO  Starting execution of 1 what-if analyses...
2022-09-21 17:02:21 INFO  Start plan generation for analysis PermutationFeatureImportance...
2022-09-21 17:02:21 INFO  ---RUNTIME: Plan generation took 0.12612342834472656 ms
2022-09-21 17:02:21 INFO  Estimated runtime of original DAG is 2658.029556274414ms
2022-09-21 17:02:21 WARNING Skipping Multi-Query Optimization (instead, only applying patches)
2022-09-21 17:02:21 INFO  Estimated unoptimised what-if runtime is 15948.177337646484ms
2022-09-21 17:02:21 INFO  ---RUNTIME: Multi-Query Optimization took 5.482673645019531 ms
2022-09-21 17:02:21 INFO  Executing generated plans
2022-09-21 17:02:34 INFO  ---RUNTIME: Execution took 13595.323324203491 ms
2022-09-21 17:02:34 INFO  Done!
2022-09-21 17:02:34 INFO  # Finished -- repetition 6 of 7 
2022-09-21 17:02:34 INFO  # Optimization benchmark for feature_importance with args [['healthcare', 'slow_loading', 'featurization_3', 'neural_network']] -- repetition 7 of 7
2022-09-21 17:02:34 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-21 17:02:34 INFO  Running instrumented original pipeline...
2022-09-21 17:02:34 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-21 17:02:34 INFO  ---RUNTIME: Importing and monkey-patching took 5.99360466003418 ms
2022-09-21 17:02:37 INFO  ---RUNTIME: Original pipeline execution took 2938.9543533325195 ms (excluding imports and monkey-patching)
2022-09-21 17:02:37 INFO  Starting execution of 1 what-if analyses...
2022-09-21 17:02:37 INFO  Start plan generation for analysis PermutationFeatureImportance...
2022-09-21 17:02:37 INFO  ---RUNTIME: Plan generation took 0.11014938354492188 ms
2022-09-21 17:02:37 INFO  Estimated runtime of original DAG is 2621.96946144104ms
2022-09-21 17:02:37 INFO  Performing Multi-Query Optimization
2022-09-21 17:02:37 INFO  Estimated unoptimized what-if runtime is 15731.81676864624ms
2022-09-21 17:02:37 INFO  Estimated optimised what-if runtime is 2913.9676094055176ms
2022-09-21 17:02:37 INFO  Estimated optimisation runtime saving is 12817.849159240723ms
2022-09-21 17:02:37 INFO  ---RUNTIME: Multi-Query Optimization took 15.092134475708008 ms
2022-09-21 17:02:37 INFO  Executing generated plans
2022-09-21 17:02:39 INFO  ---RUNTIME: Execution took 2369.990825653076 ms
2022-09-21 17:02:39 INFO  Done!
2022-09-21 17:02:39 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-21 17:02:39 INFO  Running instrumented original pipeline...
2022-09-21 17:02:39 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-21 17:02:39 INFO  ---RUNTIME: Importing and monkey-patching took 5.919933319091797 ms
2022-09-21 17:02:42 INFO  ---RUNTIME: Original pipeline execution took 2567.2385692596436 ms (excluding imports and monkey-patching)
2022-09-21 17:02:42 INFO  Starting execution of 1 what-if analyses...
2022-09-21 17:02:42 INFO  Start plan generation for analysis PermutationFeatureImportance...
2022-09-21 17:02:42 INFO  ---RUNTIME: Plan generation took 0.12302398681640625 ms
2022-09-21 17:02:42 INFO  Estimated runtime of original DAG is 2239.542007446289ms
2022-09-21 17:02:42 WARNING Skipping Multi-Query Optimization (instead, only applying patches)
2022-09-21 17:02:42 INFO  Estimated unoptimised what-if runtime is 13437.252044677734ms
2022-09-21 17:02:42 INFO  ---RUNTIME: Multi-Query Optimization took 5.558252334594727 ms
2022-09-21 17:02:42 INFO  Executing generated plans
2022-09-21 17:02:56 INFO  ---RUNTIME: Execution took 14173.994779586792 ms
2022-09-21 17:02:56 INFO  Done!
2022-09-21 17:02:56 INFO  # Finished -- repetition 7 of 7 
2022-09-21 17:02:56 INFO  # Final results after all repetitions
2022-09-21 17:02:56 INFO     repetition  ... no_opt_what_if_execution_combined_model_training
0           0  ...                                      2857.327461
1           1  ...                                      2880.207062
2           2  ...                                      2912.275314
3           3  ...                                      2848.445892
4           4  ...                                      2909.976244
5           5  ...                                      2577.580929
6           6  ...                                      2906.691551

[7 rows x 26 columns]
taskset -c 0-7 PROTOCOL_BUFFERS_PYTHON_IMPLEMENTATION=python python3.9 benchmarks_end_to_end.py feature_importance healthcare slow_loading featurization_4 logistic_regression
2022-09-21 17:02:59.049231: W tensorflow/stream_executor/platform/default/dso_loader.cc:64] Could not load dynamic library 'libcudart.so.11.0'; dlerror: libcudart.so.11.0: cannot open shared object file: No such file or directory; LD_LIBRARY_PATH: /home/sgrafbe/mlwhatif/venv/lib/python3.9/site-packages/cv2/../../lib64:
2022-09-21 17:02:59.049284: I tensorflow/stream_executor/cuda/cudart_stub.cc:29] Ignore above cudart dlerror if you do not have a GPU set up on your machine.
2022-09-21 17:03:00 INFO  Patching sys.argv with ['mlwhatif', 'healthcare', 'slow_loading', 'featurization_4', 'logistic_regression']
2022-09-21 17:03:00 INFO  Running instrumented original pipeline...
2022-09-21 17:03:00 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-21 17:03:00 INFO  ---RUNTIME: Importing and monkey-patching took 95.05748748779297 ms
2022-09-21 17:03:02 INFO  ---RUNTIME: Original pipeline execution took 2104.8192977905273 ms (excluding imports and monkey-patching)
2022-09-21 17:03:02 INFO  Starting execution of 0 what-if analyses...
2022-09-21 17:03:02 INFO  Estimated runtime of original DAG is 1795.882225036621ms
2022-09-21 17:03:02 INFO  Performing Multi-Query Optimization
2022-09-21 17:03:02 INFO  Estimated unoptimized what-if runtime is 0ms
2022-09-21 17:03:02 INFO  Estimated optimised what-if runtime is 0ms
2022-09-21 17:03:02 INFO  Estimated optimisation runtime saving is 0ms
2022-09-21 17:03:02 INFO  ---RUNTIME: Multi-Query Optimization took 0.5221366882324219 ms
2022-09-21 17:03:02 INFO  Executing generated plans
2022-09-21 17:03:02 INFO  ---RUNTIME: Execution took 0.023365020751953125 ms
2022-09-21 17:03:02 INFO  Done!
2022-09-21 17:03:02 INFO  # Optimization benchmark for feature_importance with args [['healthcare', 'slow_loading', 'featurization_4', 'logistic_regression']] -- repetition 1 of 7
2022-09-21 17:03:02 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-21 17:03:02 INFO  Running instrumented original pipeline...
2022-09-21 17:03:02 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-21 17:03:02 INFO  ---RUNTIME: Importing and monkey-patching took 5.140781402587891 ms
2022-09-21 17:03:04 INFO  ---RUNTIME: Original pipeline execution took 2028.3925533294678 ms (excluding imports and monkey-patching)
2022-09-21 17:03:04 INFO  Starting execution of 1 what-if analyses...
2022-09-21 17:03:04 INFO  Start plan generation for analysis PermutationFeatureImportance...
2022-09-21 17:03:04 INFO  ---RUNTIME: Plan generation took 0.20742416381835938 ms
2022-09-21 17:03:04 INFO  Estimated runtime of original DAG is 1746.701717376709ms
2022-09-21 17:03:04 INFO  Performing Multi-Query Optimization
2022-09-21 17:03:04 INFO  Estimated unoptimized what-if runtime is 10480.210304260254ms
2022-09-21 17:03:04 INFO  Estimated optimised what-if runtime is 1751.995325088501ms
2022-09-21 17:03:04 INFO  Estimated optimisation runtime saving is 8728.214979171753ms
2022-09-21 17:03:04 INFO  ---RUNTIME: Multi-Query Optimization took 12.674093246459961 ms
2022-09-21 17:03:04 INFO  Executing generated plans
2022-09-21 17:03:06 INFO  ---RUNTIME: Execution took 1777.7156829833984 ms
2022-09-21 17:03:06 INFO  Done!
2022-09-21 17:03:06 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-21 17:03:06 INFO  Running instrumented original pipeline...
2022-09-21 17:03:06 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-21 17:03:06 INFO  ---RUNTIME: Importing and monkey-patching took 5.766868591308594 ms
2022-09-21 17:03:08 INFO  ---RUNTIME: Original pipeline execution took 2207.869052886963 ms (excluding imports and monkey-patching)
2022-09-21 17:03:08 INFO  Starting execution of 1 what-if analyses...
2022-09-21 17:03:08 INFO  Start plan generation for analysis PermutationFeatureImportance...
2022-09-21 17:03:08 INFO  ---RUNTIME: Plan generation took 0.10991096496582031 ms
2022-09-21 17:03:08 INFO  Estimated runtime of original DAG is 1746.8032836914062ms
2022-09-21 17:03:08 WARNING Skipping Multi-Query Optimization (instead, only applying patches)
2022-09-21 17:03:08 INFO  Estimated unoptimised what-if runtime is 10480.819702148438ms
2022-09-21 17:03:08 INFO  ---RUNTIME: Multi-Query Optimization took 4.770755767822266 ms
2022-09-21 17:03:08 INFO  Executing generated plans
2022-09-21 17:03:19 INFO  ---RUNTIME: Execution took 11082.557678222656 ms
2022-09-21 17:03:19 INFO  Done!
2022-09-21 17:03:19 INFO  # Finished -- repetition 1 of 7 
2022-09-21 17:03:19 INFO  # Optimization benchmark for feature_importance with args [['healthcare', 'slow_loading', 'featurization_4', 'logistic_regression']] -- repetition 2 of 7
2022-09-21 17:03:19 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-21 17:03:19 INFO  Running instrumented original pipeline...
2022-09-21 17:03:19 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-21 17:03:19 INFO  ---RUNTIME: Importing and monkey-patching took 6.062984466552734 ms
2022-09-21 17:03:21 INFO  ---RUNTIME: Original pipeline execution took 2014.6987438201904 ms (excluding imports and monkey-patching)
2022-09-21 17:03:21 INFO  Starting execution of 1 what-if analyses...
2022-09-21 17:03:21 INFO  Start plan generation for analysis PermutationFeatureImportance...
2022-09-21 17:03:21 INFO  ---RUNTIME: Plan generation took 0.12373924255371094 ms
2022-09-21 17:03:21 INFO  Estimated runtime of original DAG is 1736.037254333496ms
2022-09-21 17:03:21 INFO  Performing Multi-Query Optimization
2022-09-21 17:03:21 INFO  Estimated unoptimized what-if runtime is 10416.223526000977ms
2022-09-21 17:03:21 INFO  Estimated optimised what-if runtime is 1741.2495613098145ms
2022-09-21 17:03:21 INFO  Estimated optimisation runtime saving is 8674.973964691162ms
2022-09-21 17:03:21 INFO  ---RUNTIME: Multi-Query Optimization took 12.937307357788086 ms
2022-09-21 17:03:21 INFO  Executing generated plans
2022-09-21 17:03:23 INFO  ---RUNTIME: Execution took 1785.149097442627 ms
2022-09-21 17:03:23 INFO  Done!
2022-09-21 17:03:23 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-21 17:03:23 INFO  Running instrumented original pipeline...
2022-09-21 17:03:23 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-21 17:03:23 INFO  ---RUNTIME: Importing and monkey-patching took 5.690574645996094 ms
2022-09-21 17:03:25 INFO  ---RUNTIME: Original pipeline execution took 2052.9470443725586 ms (excluding imports and monkey-patching)
2022-09-21 17:03:25 INFO  Starting execution of 1 what-if analyses...
2022-09-21 17:03:25 INFO  Start plan generation for analysis PermutationFeatureImportance...
2022-09-21 17:03:25 INFO  ---RUNTIME: Plan generation took 0.10561943054199219 ms
2022-09-21 17:03:25 INFO  Estimated runtime of original DAG is 1773.6923694610596ms
2022-09-21 17:03:25 WARNING Skipping Multi-Query Optimization (instead, only applying patches)
2022-09-21 17:03:25 INFO  Estimated unoptimised what-if runtime is 10642.154216766357ms
2022-09-21 17:03:25 INFO  ---RUNTIME: Multi-Query Optimization took 4.7359466552734375 ms
2022-09-21 17:03:25 INFO  Executing generated plans
2022-09-21 17:03:36 INFO  ---RUNTIME: Execution took 10805.486679077148 ms
2022-09-21 17:03:36 INFO  Done!
2022-09-21 17:03:36 INFO  # Finished -- repetition 2 of 7 
2022-09-21 17:03:36 INFO  # Optimization benchmark for feature_importance with args [['healthcare', 'slow_loading', 'featurization_4', 'logistic_regression']] -- repetition 3 of 7
2022-09-21 17:03:36 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-21 17:03:36 INFO  Running instrumented original pipeline...
2022-09-21 17:03:36 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-21 17:03:36 INFO  ---RUNTIME: Importing and monkey-patching took 6.035804748535156 ms
2022-09-21 17:03:38 INFO  ---RUNTIME: Original pipeline execution took 2060.6532096862793 ms (excluding imports and monkey-patching)
2022-09-21 17:03:38 INFO  Starting execution of 1 what-if analyses...
2022-09-21 17:03:38 INFO  Start plan generation for analysis PermutationFeatureImportance...
2022-09-21 17:03:38 INFO  ---RUNTIME: Plan generation took 0.1342296600341797 ms
2022-09-21 17:03:38 INFO  Estimated runtime of original DAG is 1779.6521186828613ms
2022-09-21 17:03:38 INFO  Performing Multi-Query Optimization
2022-09-21 17:03:38 INFO  Estimated unoptimized what-if runtime is 10677.912712097168ms
2022-09-21 17:03:38 INFO  Estimated optimised what-if runtime is 1784.9950790405273ms
2022-09-21 17:03:38 INFO  Estimated optimisation runtime saving is 8892.91763305664ms
2022-09-21 17:03:38 INFO  ---RUNTIME: Multi-Query Optimization took 13.013124465942383 ms
2022-09-21 17:03:38 INFO  Executing generated plans
2022-09-21 17:03:40 INFO  ---RUNTIME: Execution took 1844.7108268737793 ms
2022-09-21 17:03:40 INFO  Done!
2022-09-21 17:03:40 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-21 17:03:40 INFO  Running instrumented original pipeline...
2022-09-21 17:03:40 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-21 17:03:40 INFO  ---RUNTIME: Importing and monkey-patching took 5.6476593017578125 ms
2022-09-21 17:03:42 INFO  ---RUNTIME: Original pipeline execution took 2040.6787395477295 ms (excluding imports and monkey-patching)
2022-09-21 17:03:42 INFO  Starting execution of 1 what-if analyses...
2022-09-21 17:03:42 INFO  Start plan generation for analysis PermutationFeatureImportance...
2022-09-21 17:03:42 INFO  ---RUNTIME: Plan generation took 0.10371208190917969 ms
2022-09-21 17:03:42 INFO  Estimated runtime of original DAG is 1760.8580589294434ms
2022-09-21 17:03:42 WARNING Skipping Multi-Query Optimization (instead, only applying patches)
2022-09-21 17:03:42 INFO  Estimated unoptimised what-if runtime is 10565.14835357666ms
2022-09-21 17:03:42 INFO  ---RUNTIME: Multi-Query Optimization took 4.711389541625977 ms
2022-09-21 17:03:42 INFO  Executing generated plans
2022-09-21 17:03:53 INFO  ---RUNTIME: Execution took 11131.584644317627 ms
2022-09-21 17:03:53 INFO  Done!
2022-09-21 17:03:53 INFO  # Finished -- repetition 3 of 7 
2022-09-21 17:03:53 INFO  # Optimization benchmark for feature_importance with args [['healthcare', 'slow_loading', 'featurization_4', 'logistic_regression']] -- repetition 4 of 7
2022-09-21 17:03:53 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-21 17:03:53 INFO  Running instrumented original pipeline...
2022-09-21 17:03:53 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-21 17:03:53 INFO  ---RUNTIME: Importing and monkey-patching took 5.879640579223633 ms
2022-09-21 17:03:56 INFO  ---RUNTIME: Original pipeline execution took 2691.447973251343 ms (excluding imports and monkey-patching)
2022-09-21 17:03:56 INFO  Starting execution of 1 what-if analyses...
2022-09-21 17:03:56 INFO  Start plan generation for analysis PermutationFeatureImportance...
2022-09-21 17:03:56 INFO  ---RUNTIME: Plan generation took 0.11324882507324219 ms
2022-09-21 17:03:56 INFO  Estimated runtime of original DAG is 2214.6780490875244ms
2022-09-21 17:03:56 INFO  Performing Multi-Query Optimization
2022-09-21 17:03:56 INFO  Estimated unoptimized what-if runtime is 13288.068294525146ms
2022-09-21 17:03:56 INFO  Estimated optimised what-if runtime is 2219.9389934539795ms
2022-09-21 17:03:56 INFO  Estimated optimisation runtime saving is 11068.129301071167ms
2022-09-21 17:03:56 INFO  ---RUNTIME: Multi-Query Optimization took 12.832880020141602 ms
2022-09-21 17:03:56 INFO  Executing generated plans
2022-09-21 17:03:57 INFO  ---RUNTIME: Execution took 1803.8105964660645 ms
2022-09-21 17:03:57 INFO  Done!
2022-09-21 17:03:57 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-21 17:03:57 INFO  Running instrumented original pipeline...
2022-09-21 17:03:58 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-21 17:03:58 INFO  ---RUNTIME: Importing and monkey-patching took 5.8269500732421875 ms
2022-09-21 17:04:00 INFO  ---RUNTIME: Original pipeline execution took 2044.53444480896 ms (excluding imports and monkey-patching)
2022-09-21 17:04:00 INFO  Starting execution of 1 what-if analyses...
2022-09-21 17:04:00 INFO  Start plan generation for analysis PermutationFeatureImportance...
2022-09-21 17:04:00 INFO  ---RUNTIME: Plan generation took 0.10728836059570312 ms
2022-09-21 17:04:00 INFO  Estimated runtime of original DAG is 1763.227939605713ms
2022-09-21 17:04:00 WARNING Skipping Multi-Query Optimization (instead, only applying patches)
2022-09-21 17:04:00 INFO  Estimated unoptimised what-if runtime is 10579.367637634277ms
2022-09-21 17:04:00 INFO  ---RUNTIME: Multi-Query Optimization took 4.75764274597168 ms
2022-09-21 17:04:00 INFO  Executing generated plans
2022-09-21 17:04:10 INFO  ---RUNTIME: Execution took 10855.154037475586 ms
2022-09-21 17:04:10 INFO  Done!
2022-09-21 17:04:10 INFO  # Finished -- repetition 4 of 7 
2022-09-21 17:04:10 INFO  # Optimization benchmark for feature_importance with args [['healthcare', 'slow_loading', 'featurization_4', 'logistic_regression']] -- repetition 5 of 7
2022-09-21 17:04:10 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-21 17:04:10 INFO  Running instrumented original pipeline...
2022-09-21 17:04:10 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-21 17:04:10 INFO  ---RUNTIME: Importing and monkey-patching took 5.974054336547852 ms
2022-09-21 17:04:12 INFO  ---RUNTIME: Original pipeline execution took 2054.950952529907 ms (excluding imports and monkey-patching)
2022-09-21 17:04:12 INFO  Starting execution of 1 what-if analyses...
2022-09-21 17:04:12 INFO  Start plan generation for analysis PermutationFeatureImportance...
2022-09-21 17:04:12 INFO  ---RUNTIME: Plan generation took 0.1266002655029297 ms
2022-09-21 17:04:12 INFO  Estimated runtime of original DAG is 1774.1332054138184ms
2022-09-21 17:04:12 INFO  Performing Multi-Query Optimization
2022-09-21 17:04:12 INFO  Estimated unoptimized what-if runtime is 10644.79923248291ms
2022-09-21 17:04:12 INFO  Estimated optimised what-if runtime is 1779.468059539795ms
2022-09-21 17:04:12 INFO  Estimated optimisation runtime saving is 8865.331172943115ms
2022-09-21 17:04:12 INFO  ---RUNTIME: Multi-Query Optimization took 12.925863265991211 ms
2022-09-21 17:04:12 INFO  Executing generated plans
2022-09-21 17:04:14 INFO  ---RUNTIME: Execution took 1801.543951034546 ms
2022-09-21 17:04:14 INFO  Done!
2022-09-21 17:04:14 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-21 17:04:14 INFO  Running instrumented original pipeline...
2022-09-21 17:04:14 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-21 17:04:14 INFO  ---RUNTIME: Importing and monkey-patching took 5.728721618652344 ms
2022-09-21 17:04:16 INFO  ---RUNTIME: Original pipeline execution took 2044.5444583892822 ms (excluding imports and monkey-patching)
2022-09-21 17:04:16 INFO  Starting execution of 1 what-if analyses...
2022-09-21 17:04:16 INFO  Start plan generation for analysis PermutationFeatureImportance...
2022-09-21 17:04:16 INFO  ---RUNTIME: Plan generation took 0.10442733764648438 ms
2022-09-21 17:04:16 INFO  Estimated runtime of original DAG is 1762.0902061462402ms
2022-09-21 17:04:16 WARNING Skipping Multi-Query Optimization (instead, only applying patches)
2022-09-21 17:04:16 INFO  Estimated unoptimised what-if runtime is 10572.541236877441ms
2022-09-21 17:04:16 INFO  ---RUNTIME: Multi-Query Optimization took 4.764318466186523 ms
2022-09-21 17:04:16 INFO  Executing generated plans
2022-09-21 17:04:27 INFO  ---RUNTIME: Execution took 11151.74651145935 ms
2022-09-21 17:04:27 INFO  Done!
2022-09-21 17:04:27 INFO  # Finished -- repetition 5 of 7 
2022-09-21 17:04:27 INFO  # Optimization benchmark for feature_importance with args [['healthcare', 'slow_loading', 'featurization_4', 'logistic_regression']] -- repetition 6 of 7
2022-09-21 17:04:27 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-21 17:04:27 INFO  Running instrumented original pipeline...
2022-09-21 17:04:28 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-21 17:04:28 INFO  ---RUNTIME: Importing and monkey-patching took 5.903482437133789 ms
2022-09-21 17:04:30 INFO  ---RUNTIME: Original pipeline execution took 2028.1503200531006 ms (excluding imports and monkey-patching)
2022-09-21 17:04:30 INFO  Starting execution of 1 what-if analyses...
2022-09-21 17:04:30 INFO  Start plan generation for analysis PermutationFeatureImportance...
2022-09-21 17:04:30 INFO  ---RUNTIME: Plan generation took 0.11849403381347656 ms
2022-09-21 17:04:30 INFO  Estimated runtime of original DAG is 1749.1698265075684ms
2022-09-21 17:04:30 INFO  Performing Multi-Query Optimization
2022-09-21 17:04:30 INFO  Estimated unoptimized what-if runtime is 10495.01895904541ms
2022-09-21 17:04:30 INFO  Estimated optimised what-if runtime is 1754.331350326538ms
2022-09-21 17:04:30 INFO  Estimated optimisation runtime saving is 8740.687608718872ms
2022-09-21 17:04:30 INFO  ---RUNTIME: Multi-Query Optimization took 12.875556945800781 ms
2022-09-21 17:04:30 INFO  Executing generated plans
2022-09-21 17:04:31 INFO  ---RUNTIME: Execution took 1799.1752624511719 ms
2022-09-21 17:04:31 INFO  Done!
2022-09-21 17:04:31 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-21 17:04:31 INFO  Running instrumented original pipeline...
2022-09-21 17:04:31 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-21 17:04:31 INFO  ---RUNTIME: Importing and monkey-patching took 5.817174911499023 ms
2022-09-21 17:04:33 INFO  ---RUNTIME: Original pipeline execution took 2059.5295429229736 ms (excluding imports and monkey-patching)
2022-09-21 17:04:33 INFO  Starting execution of 1 what-if analyses...
2022-09-21 17:04:33 INFO  Start plan generation for analysis PermutationFeatureImportance...
2022-09-21 17:04:33 INFO  ---RUNTIME: Plan generation took 0.1068115234375 ms
2022-09-21 17:04:33 INFO  Estimated runtime of original DAG is 1778.541088104248ms
2022-09-21 17:04:33 WARNING Skipping Multi-Query Optimization (instead, only applying patches)
2022-09-21 17:04:33 INFO  Estimated unoptimised what-if runtime is 10671.246528625488ms
2022-09-21 17:04:33 INFO  ---RUNTIME: Multi-Query Optimization took 4.754543304443359 ms
2022-09-21 17:04:33 INFO  Executing generated plans
2022-09-21 17:04:44 INFO  ---RUNTIME: Execution took 10840.48080444336 ms
2022-09-21 17:04:44 INFO  Done!
2022-09-21 17:04:44 INFO  # Finished -- repetition 6 of 7 
2022-09-21 17:04:44 INFO  # Optimization benchmark for feature_importance with args [['healthcare', 'slow_loading', 'featurization_4', 'logistic_regression']] -- repetition 7 of 7
2022-09-21 17:04:44 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-21 17:04:44 INFO  Running instrumented original pipeline...
2022-09-21 17:04:44 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-21 17:04:44 INFO  ---RUNTIME: Importing and monkey-patching took 5.911111831665039 ms
2022-09-21 17:04:47 INFO  ---RUNTIME: Original pipeline execution took 2284.524917602539 ms (excluding imports and monkey-patching)
2022-09-21 17:04:47 INFO  Starting execution of 1 what-if analyses...
2022-09-21 17:04:47 INFO  Start plan generation for analysis PermutationFeatureImportance...
2022-09-21 17:04:47 INFO  ---RUNTIME: Plan generation took 0.11730194091796875 ms
2022-09-21 17:04:47 INFO  Estimated runtime of original DAG is 1775.5775451660156ms
2022-09-21 17:04:47 INFO  Performing Multi-Query Optimization
2022-09-21 17:04:47 INFO  Estimated unoptimized what-if runtime is 10653.465270996094ms
2022-09-21 17:04:47 INFO  Estimated optimised what-if runtime is 1781.426191329956ms
2022-09-21 17:04:47 INFO  Estimated optimisation runtime saving is 8872.039079666138ms
2022-09-21 17:04:47 INFO  ---RUNTIME: Multi-Query Optimization took 15.513181686401367 ms
2022-09-21 17:04:47 INFO  Executing generated plans
2022-09-21 17:04:48 INFO  ---RUNTIME: Execution took 1781.8677425384521 ms
2022-09-21 17:04:48 INFO  Done!
2022-09-21 17:04:48 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-21 17:04:48 INFO  Running instrumented original pipeline...
2022-09-21 17:04:48 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-21 17:04:48 INFO  ---RUNTIME: Importing and monkey-patching took 5.663156509399414 ms
2022-09-21 17:04:50 INFO  ---RUNTIME: Original pipeline execution took 2067.561626434326 ms (excluding imports and monkey-patching)
2022-09-21 17:04:50 INFO  Starting execution of 1 what-if analyses...
2022-09-21 17:04:50 INFO  Start plan generation for analysis PermutationFeatureImportance...
2022-09-21 17:04:50 INFO  ---RUNTIME: Plan generation took 0.10633468627929688 ms
2022-09-21 17:04:50 INFO  Estimated runtime of original DAG is 1787.708044052124ms
2022-09-21 17:04:50 WARNING Skipping Multi-Query Optimization (instead, only applying patches)
2022-09-21 17:04:50 INFO  Estimated unoptimised what-if runtime is 10726.248264312744ms
2022-09-21 17:04:50 INFO  ---RUNTIME: Multi-Query Optimization took 4.962682723999023 ms
2022-09-21 17:04:50 INFO  Executing generated plans
2022-09-21 17:05:01 INFO  ---RUNTIME: Execution took 11046.655893325806 ms
2022-09-21 17:05:01 INFO  Done!
2022-09-21 17:05:01 INFO  # Finished -- repetition 7 of 7 
2022-09-21 17:05:01 INFO  # Final results after all repetitions
2022-09-21 17:05:01 INFO     repetition  ... no_opt_what_if_execution_combined_model_training
0           0  ...                                        15.946388
1           1  ...                                        14.782429
2           2  ...                                        15.284300
3           3  ...                                        14.738321
4           4  ...                                        15.103817
5           5  ...                                        15.069008
6           6  ...                                        15.130997

[7 rows x 26 columns]
taskset -c 0-7 PROTOCOL_BUFFERS_PYTHON_IMPLEMENTATION=python python3.9 benchmarks_end_to_end.py feature_importance healthcare slow_loading featurization_4 xgboost
2022-09-21 17:05:04.042306: W tensorflow/stream_executor/platform/default/dso_loader.cc:64] Could not load dynamic library 'libcudart.so.11.0'; dlerror: libcudart.so.11.0: cannot open shared object file: No such file or directory; LD_LIBRARY_PATH: /home/sgrafbe/mlwhatif/venv/lib/python3.9/site-packages/cv2/../../lib64:
2022-09-21 17:05:04.042354: I tensorflow/stream_executor/cuda/cudart_stub.cc:29] Ignore above cudart dlerror if you do not have a GPU set up on your machine.
2022-09-21 17:05:05 INFO  Patching sys.argv with ['mlwhatif', 'healthcare', 'slow_loading', 'featurization_4', 'xgboost']
2022-09-21 17:05:05 INFO  Running instrumented original pipeline...
2022-09-21 17:05:05 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-21 17:05:05 INFO  ---RUNTIME: Importing and monkey-patching took 95.2911376953125 ms
2022-09-21 17:05:07 INFO  ---RUNTIME: Original pipeline execution took 2389.9877071380615 ms (excluding imports and monkey-patching)
2022-09-21 17:05:07 INFO  Starting execution of 0 what-if analyses...
2022-09-21 17:05:07 INFO  Estimated runtime of original DAG is 2085.7744216918945ms
2022-09-21 17:05:07 INFO  Performing Multi-Query Optimization
2022-09-21 17:05:07 INFO  Estimated unoptimized what-if runtime is 0ms
2022-09-21 17:05:07 INFO  Estimated optimised what-if runtime is 0ms
2022-09-21 17:05:07 INFO  Estimated optimisation runtime saving is 0ms
2022-09-21 17:05:07 INFO  ---RUNTIME: Multi-Query Optimization took 0.4837512969970703 ms
2022-09-21 17:05:07 INFO  Executing generated plans
2022-09-21 17:05:07 INFO  ---RUNTIME: Execution took 0.026226043701171875 ms
2022-09-21 17:05:07 INFO  Done!
2022-09-21 17:05:07 INFO  # Optimization benchmark for feature_importance with args [['healthcare', 'slow_loading', 'featurization_4', 'xgboost']] -- repetition 1 of 7
2022-09-21 17:05:07 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-21 17:05:07 INFO  Running instrumented original pipeline...
2022-09-21 17:05:07 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-21 17:05:07 INFO  ---RUNTIME: Importing and monkey-patching took 5.089521408081055 ms
2022-09-21 17:05:10 INFO  ---RUNTIME: Original pipeline execution took 2298.5336780548096 ms (excluding imports and monkey-patching)
2022-09-21 17:05:10 INFO  Starting execution of 1 what-if analyses...
2022-09-21 17:05:10 INFO  Start plan generation for analysis PermutationFeatureImportance...
2022-09-21 17:05:10 INFO  ---RUNTIME: Plan generation took 0.22912025451660156 ms
2022-09-21 17:05:10 INFO  Estimated runtime of original DAG is 2024.010419845581ms
2022-09-21 17:05:10 INFO  Performing Multi-Query Optimization
2022-09-21 17:05:10 INFO  Estimated unoptimized what-if runtime is 12144.062519073486ms
2022-09-21 17:05:10 INFO  Estimated optimised what-if runtime is 2039.0214920043945ms
2022-09-21 17:05:10 INFO  Estimated optimisation runtime saving is 10105.041027069092ms
2022-09-21 17:05:10 INFO  ---RUNTIME: Multi-Query Optimization took 15.554428100585938 ms
2022-09-21 17:05:10 INFO  Executing generated plans
2022-09-21 17:05:12 INFO  ---RUNTIME: Execution took 2042.7265167236328 ms
2022-09-21 17:05:12 INFO  Done!
2022-09-21 17:05:12 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-21 17:05:12 INFO  Running instrumented original pipeline...
2022-09-21 17:05:12 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-21 17:05:12 INFO  ---RUNTIME: Importing and monkey-patching took 5.7830810546875 ms
2022-09-21 17:05:14 INFO  ---RUNTIME: Original pipeline execution took 2417.4928665161133 ms (excluding imports and monkey-patching)
2022-09-21 17:05:14 INFO  Starting execution of 1 what-if analyses...
2022-09-21 17:05:14 INFO  Start plan generation for analysis PermutationFeatureImportance...
2022-09-21 17:05:14 INFO  ---RUNTIME: Plan generation took 0.110626220703125 ms
2022-09-21 17:05:14 INFO  Estimated runtime of original DAG is 1976.8040180206299ms
2022-09-21 17:05:14 WARNING Skipping Multi-Query Optimization (instead, only applying patches)
2022-09-21 17:05:14 INFO  Estimated unoptimised what-if runtime is 11860.82410812378ms
2022-09-21 17:05:14 INFO  ---RUNTIME: Multi-Query Optimization took 4.776477813720703 ms
2022-09-21 17:05:14 INFO  Executing generated plans
2022-09-21 17:05:26 INFO  ---RUNTIME: Execution took 12069.810390472412 ms
2022-09-21 17:05:26 INFO  Done!
2022-09-21 17:05:26 INFO  # Finished -- repetition 1 of 7 
2022-09-21 17:05:26 INFO  # Optimization benchmark for feature_importance with args [['healthcare', 'slow_loading', 'featurization_4', 'xgboost']] -- repetition 2 of 7
2022-09-21 17:05:26 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-21 17:05:26 INFO  Running instrumented original pipeline...
2022-09-21 17:05:26 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-21 17:05:26 INFO  ---RUNTIME: Importing and monkey-patching took 6.073474884033203 ms
2022-09-21 17:05:28 INFO  ---RUNTIME: Original pipeline execution took 2290.6129360198975 ms (excluding imports and monkey-patching)
2022-09-21 17:05:28 INFO  Starting execution of 1 what-if analyses...
2022-09-21 17:05:28 INFO  Start plan generation for analysis PermutationFeatureImportance...
2022-09-21 17:05:28 INFO  ---RUNTIME: Plan generation took 0.1633167266845703 ms
2022-09-21 17:05:28 INFO  Estimated runtime of original DAG is 2008.0676078796387ms
2022-09-21 17:05:28 INFO  Performing Multi-Query Optimization
2022-09-21 17:05:28 INFO  Estimated unoptimized what-if runtime is 12048.405647277832ms
2022-09-21 17:05:28 INFO  Estimated optimised what-if runtime is 2024.507761001587ms
2022-09-21 17:05:28 INFO  Estimated optimisation runtime saving is 10023.897886276245ms
2022-09-21 17:05:28 INFO  ---RUNTIME: Multi-Query Optimization took 15.085697174072266 ms
2022-09-21 17:05:28 INFO  Executing generated plans
2022-09-21 17:05:31 INFO  ---RUNTIME: Execution took 2298.991918563843 ms
2022-09-21 17:05:31 INFO  Done!
2022-09-21 17:05:31 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-21 17:05:31 INFO  Running instrumented original pipeline...
2022-09-21 17:05:31 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-21 17:05:31 INFO  ---RUNTIME: Importing and monkey-patching took 6.625652313232422 ms
2022-09-21 17:05:33 INFO  ---RUNTIME: Original pipeline execution took 2285.0348949432373 ms (excluding imports and monkey-patching)
2022-09-21 17:05:33 INFO  Starting execution of 1 what-if analyses...
2022-09-21 17:05:33 INFO  Start plan generation for analysis PermutationFeatureImportance...
2022-09-21 17:05:33 INFO  ---RUNTIME: Plan generation took 0.12969970703125 ms
2022-09-21 17:05:33 INFO  Estimated runtime of original DAG is 2002.4785995483398ms
2022-09-21 17:05:33 WARNING Skipping Multi-Query Optimization (instead, only applying patches)
2022-09-21 17:05:33 INFO  Estimated unoptimised what-if runtime is 12014.871597290039ms
2022-09-21 17:05:33 INFO  ---RUNTIME: Multi-Query Optimization took 5.839347839355469 ms
2022-09-21 17:05:33 INFO  Executing generated plans
2022-09-21 17:05:45 INFO  ---RUNTIME: Execution took 11921.0205078125 ms
2022-09-21 17:05:45 INFO  Done!
2022-09-21 17:05:45 INFO  # Finished -- repetition 2 of 7 
2022-09-21 17:05:45 INFO  # Optimization benchmark for feature_importance with args [['healthcare', 'slow_loading', 'featurization_4', 'xgboost']] -- repetition 3 of 7
2022-09-21 17:05:45 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-21 17:05:45 INFO  Running instrumented original pipeline...
2022-09-21 17:05:45 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-21 17:05:45 INFO  ---RUNTIME: Importing and monkey-patching took 6.819486618041992 ms
2022-09-21 17:05:47 INFO  ---RUNTIME: Original pipeline execution took 2259.655714035034 ms (excluding imports and monkey-patching)
2022-09-21 17:05:47 INFO  Starting execution of 1 what-if analyses...
2022-09-21 17:05:47 INFO  Start plan generation for analysis PermutationFeatureImportance...
2022-09-21 17:05:47 INFO  ---RUNTIME: Plan generation took 0.12493133544921875 ms
2022-09-21 17:05:47 INFO  Estimated runtime of original DAG is 1968.4765338897705ms
2022-09-21 17:05:47 INFO  Performing Multi-Query Optimization
2022-09-21 17:05:47 INFO  Estimated unoptimized what-if runtime is 11810.859203338623ms
2022-09-21 17:05:47 INFO  Estimated optimised what-if runtime is 1981.801986694336ms
2022-09-21 17:05:47 INFO  Estimated optimisation runtime saving is 9829.057216644287ms
2022-09-21 17:05:47 INFO  ---RUNTIME: Multi-Query Optimization took 13.051509857177734 ms
2022-09-21 17:05:47 INFO  Executing generated plans
2022-09-21 17:05:49 INFO  ---RUNTIME: Execution took 2007.7643394470215 ms
2022-09-21 17:05:49 INFO  Done!
2022-09-21 17:05:49 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-21 17:05:49 INFO  Running instrumented original pipeline...
2022-09-21 17:05:49 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-21 17:05:49 INFO  ---RUNTIME: Importing and monkey-patching took 5.66864013671875 ms
2022-09-21 17:05:52 INFO  ---RUNTIME: Original pipeline execution took 2252.016544342041 ms (excluding imports and monkey-patching)
2022-09-21 17:05:52 INFO  Starting execution of 1 what-if analyses...
2022-09-21 17:05:52 INFO  Start plan generation for analysis PermutationFeatureImportance...
2022-09-21 17:05:52 INFO  ---RUNTIME: Plan generation took 0.12731552124023438 ms
2022-09-21 17:05:52 INFO  Estimated runtime of original DAG is 1973.7565517425537ms
2022-09-21 17:05:52 WARNING Skipping Multi-Query Optimization (instead, only applying patches)
2022-09-21 17:05:52 INFO  Estimated unoptimised what-if runtime is 11842.539310455322ms
2022-09-21 17:05:52 INFO  ---RUNTIME: Multi-Query Optimization took 4.816770553588867 ms
2022-09-21 17:05:52 INFO  Executing generated plans
2022-09-21 17:06:04 INFO  ---RUNTIME: Execution took 12380.805253982544 ms
2022-09-21 17:06:04 INFO  Done!
2022-09-21 17:06:04 INFO  # Finished -- repetition 3 of 7 
2022-09-21 17:06:04 INFO  # Optimization benchmark for feature_importance with args [['healthcare', 'slow_loading', 'featurization_4', 'xgboost']] -- repetition 4 of 7
2022-09-21 17:06:04 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-21 17:06:04 INFO  Running instrumented original pipeline...
2022-09-21 17:06:04 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-21 17:06:04 INFO  ---RUNTIME: Importing and monkey-patching took 5.878448486328125 ms
2022-09-21 17:06:06 INFO  ---RUNTIME: Original pipeline execution took 2444.897174835205 ms (excluding imports and monkey-patching)
2022-09-21 17:06:06 INFO  Starting execution of 1 what-if analyses...
2022-09-21 17:06:06 INFO  Start plan generation for analysis PermutationFeatureImportance...
2022-09-21 17:06:06 INFO  ---RUNTIME: Plan generation took 0.1308917999267578 ms
2022-09-21 17:06:06 INFO  Estimated runtime of original DAG is 1962.7835750579834ms
2022-09-21 17:06:06 INFO  Performing Multi-Query Optimization
2022-09-21 17:06:06 INFO  Estimated unoptimized what-if runtime is 11776.7014503479ms
2022-09-21 17:06:06 INFO  Estimated optimised what-if runtime is 1976.104736328125ms
2022-09-21 17:06:06 INFO  Estimated optimisation runtime saving is 9800.596714019775ms
2022-09-21 17:06:06 INFO  ---RUNTIME: Multi-Query Optimization took 12.807607650756836 ms
2022-09-21 17:06:06 INFO  Executing generated plans
2022-09-21 17:06:08 INFO  ---RUNTIME: Execution took 2004.9526691436768 ms
2022-09-21 17:06:08 INFO  Done!
2022-09-21 17:06:08 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-21 17:06:08 INFO  Running instrumented original pipeline...
2022-09-21 17:06:08 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-21 17:06:08 INFO  ---RUNTIME: Importing and monkey-patching took 5.711793899536133 ms
2022-09-21 17:06:11 INFO  ---RUNTIME: Original pipeline execution took 2254.0292739868164 ms (excluding imports and monkey-patching)
2022-09-21 17:06:11 INFO  Starting execution of 1 what-if analyses...
2022-09-21 17:06:11 INFO  Start plan generation for analysis PermutationFeatureImportance...
2022-09-21 17:06:11 INFO  ---RUNTIME: Plan generation took 0.13256072998046875 ms
2022-09-21 17:06:11 INFO  Estimated runtime of original DAG is 1979.4645309448242ms
2022-09-21 17:06:11 WARNING Skipping Multi-Query Optimization (instead, only applying patches)
2022-09-21 17:06:11 INFO  Estimated unoptimised what-if runtime is 11876.787185668945ms
2022-09-21 17:06:11 INFO  ---RUNTIME: Multi-Query Optimization took 4.753589630126953 ms
2022-09-21 17:06:11 INFO  Executing generated plans
2022-09-21 17:06:23 INFO  ---RUNTIME: Execution took 12036.549091339111 ms
2022-09-21 17:06:23 INFO  Done!
2022-09-21 17:06:23 INFO  # Finished -- repetition 4 of 7 
2022-09-21 17:06:23 INFO  # Optimization benchmark for feature_importance with args [['healthcare', 'slow_loading', 'featurization_4', 'xgboost']] -- repetition 5 of 7
2022-09-21 17:06:23 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-21 17:06:23 INFO  Running instrumented original pipeline...
2022-09-21 17:06:23 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-21 17:06:23 INFO  ---RUNTIME: Importing and monkey-patching took 6.089448928833008 ms
2022-09-21 17:06:25 INFO  ---RUNTIME: Original pipeline execution took 2299.1535663604736 ms (excluding imports and monkey-patching)
2022-09-21 17:06:25 INFO  Starting execution of 1 what-if analyses...
2022-09-21 17:06:25 INFO  Start plan generation for analysis PermutationFeatureImportance...
2022-09-21 17:06:25 INFO  ---RUNTIME: Plan generation took 0.1220703125 ms
2022-09-21 17:06:25 INFO  Estimated runtime of original DAG is 2023.5207080841064ms
2022-09-21 17:06:25 INFO  Performing Multi-Query Optimization
2022-09-21 17:06:25 INFO  Estimated unoptimized what-if runtime is 12141.124248504639ms
2022-09-21 17:06:25 INFO  Estimated optimised what-if runtime is 2037.045955657959ms
2022-09-21 17:06:25 INFO  Estimated optimisation runtime saving is 10104.07829284668ms
2022-09-21 17:06:25 INFO  ---RUNTIME: Multi-Query Optimization took 12.952804565429688 ms
2022-09-21 17:06:25 INFO  Executing generated plans
2022-09-21 17:06:27 INFO  ---RUNTIME: Execution took 2022.8517055511475 ms
2022-09-21 17:06:27 INFO  Done!
2022-09-21 17:06:27 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-21 17:06:27 INFO  Running instrumented original pipeline...
2022-09-21 17:06:27 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-21 17:06:27 INFO  ---RUNTIME: Importing and monkey-patching took 5.70988655090332 ms
2022-09-21 17:06:29 INFO  ---RUNTIME: Original pipeline execution took 2258.333206176758 ms (excluding imports and monkey-patching)
2022-09-21 17:06:29 INFO  Starting execution of 1 what-if analyses...
2022-09-21 17:06:29 INFO  Start plan generation for analysis PermutationFeatureImportance...
2022-09-21 17:06:29 INFO  ---RUNTIME: Plan generation took 0.12183189392089844 ms
2022-09-21 17:06:29 INFO  Estimated runtime of original DAG is 1982.332706451416ms
2022-09-21 17:06:29 WARNING Skipping Multi-Query Optimization (instead, only applying patches)
2022-09-21 17:06:29 INFO  Estimated unoptimised what-if runtime is 11893.996238708496ms
2022-09-21 17:06:29 INFO  ---RUNTIME: Multi-Query Optimization took 4.82177734375 ms
2022-09-21 17:06:29 INFO  Executing generated plans
2022-09-21 17:06:42 INFO  ---RUNTIME: Execution took 12545.268297195435 ms
2022-09-21 17:06:42 INFO  Done!
2022-09-21 17:06:42 INFO  # Finished -- repetition 5 of 7 
2022-09-21 17:06:42 INFO  # Optimization benchmark for feature_importance with args [['healthcare', 'slow_loading', 'featurization_4', 'xgboost']] -- repetition 6 of 7
2022-09-21 17:06:42 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-21 17:06:42 INFO  Running instrumented original pipeline...
2022-09-21 17:06:42 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-21 17:06:42 INFO  ---RUNTIME: Importing and monkey-patching took 5.932092666625977 ms
2022-09-21 17:06:44 INFO  ---RUNTIME: Original pipeline execution took 2269.803762435913 ms (excluding imports and monkey-patching)
2022-09-21 17:06:44 INFO  Starting execution of 1 what-if analyses...
2022-09-21 17:06:44 INFO  Start plan generation for analysis PermutationFeatureImportance...
2022-09-21 17:06:44 INFO  ---RUNTIME: Plan generation took 0.14400482177734375 ms
2022-09-21 17:06:44 INFO  Estimated runtime of original DAG is 1995.748519897461ms
2022-09-21 17:06:44 INFO  Performing Multi-Query Optimization
2022-09-21 17:06:44 INFO  Estimated unoptimized what-if runtime is 11974.491119384766ms
2022-09-21 17:06:44 INFO  Estimated optimised what-if runtime is 2009.1955661773682ms
2022-09-21 17:06:44 INFO  Estimated optimisation runtime saving is 9965.295553207397ms
2022-09-21 17:06:44 INFO  ---RUNTIME: Multi-Query Optimization took 13.00811767578125 ms
2022-09-21 17:06:44 INFO  Executing generated plans
2022-09-21 17:06:46 INFO  ---RUNTIME: Execution took 2019.144058227539 ms
2022-09-21 17:06:46 INFO  Done!
2022-09-21 17:06:46 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-21 17:06:46 INFO  Running instrumented original pipeline...
2022-09-21 17:06:46 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-21 17:06:46 INFO  ---RUNTIME: Importing and monkey-patching took 5.713939666748047 ms
2022-09-21 17:06:48 INFO  ---RUNTIME: Original pipeline execution took 2257.6212882995605 ms (excluding imports and monkey-patching)
2022-09-21 17:06:48 INFO  Starting execution of 1 what-if analyses...
2022-09-21 17:06:48 INFO  Start plan generation for analysis PermutationFeatureImportance...
2022-09-21 17:06:48 INFO  ---RUNTIME: Plan generation took 0.10657310485839844 ms
2022-09-21 17:06:48 INFO  Estimated runtime of original DAG is 1978.863000869751ms
2022-09-21 17:06:48 WARNING Skipping Multi-Query Optimization (instead, only applying patches)
2022-09-21 17:06:48 INFO  Estimated unoptimised what-if runtime is 11873.178005218506ms
2022-09-21 17:06:48 INFO  ---RUNTIME: Multi-Query Optimization took 4.796028137207031 ms
2022-09-21 17:06:48 INFO  Executing generated plans
2022-09-21 17:07:00 INFO  ---RUNTIME: Execution took 11995.671033859253 ms
2022-09-21 17:07:00 INFO  Done!
2022-09-21 17:07:00 INFO  # Finished -- repetition 6 of 7 
2022-09-21 17:07:00 INFO  # Optimization benchmark for feature_importance with args [['healthcare', 'slow_loading', 'featurization_4', 'xgboost']] -- repetition 7 of 7
2022-09-21 17:07:00 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-21 17:07:00 INFO  Running instrumented original pipeline...
2022-09-21 17:07:01 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-21 17:07:01 INFO  ---RUNTIME: Importing and monkey-patching took 5.959987640380859 ms
2022-09-21 17:07:03 INFO  ---RUNTIME: Original pipeline execution took 2496.9875812530518 ms (excluding imports and monkey-patching)
2022-09-21 17:07:03 INFO  Starting execution of 1 what-if analyses...
2022-09-21 17:07:03 INFO  Start plan generation for analysis PermutationFeatureImportance...
2022-09-21 17:07:03 INFO  ---RUNTIME: Plan generation took 0.14662742614746094 ms
2022-09-21 17:07:03 INFO  Estimated runtime of original DAG is 1993.9043521881104ms
2022-09-21 17:07:03 INFO  Performing Multi-Query Optimization
2022-09-21 17:07:03 INFO  Estimated unoptimized what-if runtime is 11963.426113128662ms
2022-09-21 17:07:03 INFO  Estimated optimised what-if runtime is 2007.462501525879ms
2022-09-21 17:07:03 INFO  Estimated optimisation runtime saving is 9955.963611602783ms
2022-09-21 17:07:03 INFO  ---RUNTIME: Multi-Query Optimization took 13.030052185058594 ms
2022-09-21 17:07:03 INFO  Executing generated plans
2022-09-21 17:07:05 INFO  ---RUNTIME: Execution took 2096.153497695923 ms
2022-09-21 17:07:05 INFO  Done!
2022-09-21 17:07:05 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-21 17:07:05 INFO  Running instrumented original pipeline...
2022-09-21 17:07:05 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-21 17:07:05 INFO  ---RUNTIME: Importing and monkey-patching took 5.707502365112305 ms
2022-09-21 17:07:07 INFO  ---RUNTIME: Original pipeline execution took 2291.264533996582 ms (excluding imports and monkey-patching)
2022-09-21 17:07:07 INFO  Starting execution of 1 what-if analyses...
2022-09-21 17:07:07 INFO  Start plan generation for analysis PermutationFeatureImportance...
2022-09-21 17:07:07 INFO  ---RUNTIME: Plan generation took 0.10466575622558594 ms
2022-09-21 17:07:07 INFO  Estimated runtime of original DAG is 2012.6690864562988ms
2022-09-21 17:07:07 WARNING Skipping Multi-Query Optimization (instead, only applying patches)
2022-09-21 17:07:07 INFO  Estimated unoptimised what-if runtime is 12076.014518737793ms
2022-09-21 17:07:07 INFO  ---RUNTIME: Multi-Query Optimization took 5.104780197143555 ms
2022-09-21 17:07:07 INFO  Executing generated plans
2022-09-21 17:07:19 INFO  ---RUNTIME: Execution took 11886.104345321655 ms
2022-09-21 17:07:19 INFO  Done!
2022-09-21 17:07:19 INFO  # Finished -- repetition 7 of 7 
2022-09-21 17:07:19 INFO  # Final results after all repetitions
2022-09-21 17:07:19 INFO     repetition  ... no_opt_what_if_execution_combined_model_training
0           0  ...                                      1186.090946
1           1  ...                                      1203.730583
2           2  ...                                      1212.728977
3           3  ...                                      1177.707195
4           4  ...                                      1192.343473
5           5  ...                                      1179.370403
6           6  ...                                      1183.446646

[7 rows x 26 columns]
taskset -c 0-7 PROTOCOL_BUFFERS_PYTHON_IMPLEMENTATION=python python3.9 benchmarks_end_to_end.py feature_importance healthcare slow_loading featurization_4 neural_network
2022-09-21 17:07:21.839437: W tensorflow/stream_executor/platform/default/dso_loader.cc:64] Could not load dynamic library 'libcudart.so.11.0'; dlerror: libcudart.so.11.0: cannot open shared object file: No such file or directory; LD_LIBRARY_PATH: /home/sgrafbe/mlwhatif/venv/lib/python3.9/site-packages/cv2/../../lib64:
2022-09-21 17:07:21.839483: I tensorflow/stream_executor/cuda/cudart_stub.cc:29] Ignore above cudart dlerror if you do not have a GPU set up on your machine.
2022-09-21 17:07:23 INFO  Patching sys.argv with ['mlwhatif', 'healthcare', 'slow_loading', 'featurization_4', 'neural_network']
2022-09-21 17:07:23 INFO  Running instrumented original pipeline...
2022-09-21 17:07:23 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-21 17:07:23 INFO  ---RUNTIME: Importing and monkey-patching took 95.37434577941895 ms
2022-09-21 17:07:25.350827: W tensorflow/stream_executor/platform/default/dso_loader.cc:64] Could not load dynamic library 'libcuda.so.1'; dlerror: libcuda.so.1: cannot open shared object file: No such file or directory; LD_LIBRARY_PATH: /home/sgrafbe/mlwhatif/venv/lib/python3.9/site-packages/cv2/../../lib64:
2022-09-21 17:07:25.350866: W tensorflow/stream_executor/cuda/cuda_driver.cc:326] failed call to cuInit: UNKNOWN ERROR (303)
2022-09-21 17:07:25.350889: I tensorflow/stream_executor/cuda/cuda_diagnostics.cc:156] kernel driver does not appear to be running on this host (wagyu): /proc/driver/nvidia/version does not exist
2022-09-21 17:07:25.351388: I tensorflow/core/platform/cpu_feature_guard.cc:142] This TensorFlow binary is optimized with oneAPI Deep Neural Network Library (oneDNN) to use the following CPU instructions in performance-critical operations:  AVX2 FMA
To enable them in other operations, rebuild TensorFlow with the appropriate compiler flags.
2022-09-21 17:07:25.416570: I tensorflow/compiler/mlir/mlir_graph_optimization_pass.cc:176] None of the MLIR Optimization Passes are enabled (registered 2)
2022-09-21 17:07:25.428441: I tensorflow/core/platform/profile_utils/cpu_utils.cc:114] CPU Frequency: 2595290000 Hz
2022-09-21 17:07:26 INFO  ---RUNTIME: Original pipeline execution took 2854.9857139587402 ms (excluding imports and monkey-patching)
2022-09-21 17:07:26 INFO  Starting execution of 0 what-if analyses...
2022-09-21 17:07:26 INFO  Estimated runtime of original DAG is 2542.755603790283ms
2022-09-21 17:07:26 INFO  Performing Multi-Query Optimization
2022-09-21 17:07:26 INFO  Estimated unoptimized what-if runtime is 0ms
2022-09-21 17:07:26 INFO  Estimated optimised what-if runtime is 0ms
2022-09-21 17:07:26 INFO  Estimated optimisation runtime saving is 0ms
2022-09-21 17:07:26 INFO  ---RUNTIME: Multi-Query Optimization took 0.5068778991699219 ms
2022-09-21 17:07:26 INFO  Executing generated plans
2022-09-21 17:07:26 INFO  ---RUNTIME: Execution took 0.018835067749023438 ms
2022-09-21 17:07:26 INFO  Done!
2022-09-21 17:07:26 INFO  # Optimization benchmark for feature_importance with args [['healthcare', 'slow_loading', 'featurization_4', 'neural_network']] -- repetition 1 of 7
2022-09-21 17:07:26 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-21 17:07:26 INFO  Running instrumented original pipeline...
2022-09-21 17:07:26 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-21 17:07:26 INFO  ---RUNTIME: Importing and monkey-patching took 5.246162414550781 ms
2022-09-21 17:07:28 INFO  ---RUNTIME: Original pipeline execution took 2430.204391479492 ms (excluding imports and monkey-patching)
2022-09-21 17:07:28 INFO  Starting execution of 1 what-if analyses...
2022-09-21 17:07:28 INFO  Start plan generation for analysis PermutationFeatureImportance...
2022-09-21 17:07:28 INFO  ---RUNTIME: Plan generation took 0.21457672119140625 ms
2022-09-21 17:07:28 INFO  Estimated runtime of original DAG is 2153.4719467163086ms
2022-09-21 17:07:28 INFO  Performing Multi-Query Optimization
2022-09-21 17:07:28 INFO  Estimated unoptimized what-if runtime is 12920.831680297852ms
2022-09-21 17:07:28 INFO  Estimated optimised what-if runtime is 2447.852849960327ms
2022-09-21 17:07:28 INFO  Estimated optimisation runtime saving is 10472.978830337524ms
2022-09-21 17:07:28 INFO  ---RUNTIME: Multi-Query Optimization took 12.67695426940918 ms
2022-09-21 17:07:28 INFO  Executing generated plans
2022-09-21 17:07:30 INFO  ---RUNTIME: Execution took 2301.1670112609863 ms
2022-09-21 17:07:30 INFO  Done!
2022-09-21 17:07:30 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-21 17:07:30 INFO  Running instrumented original pipeline...
2022-09-21 17:07:30 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-21 17:07:30 INFO  ---RUNTIME: Importing and monkey-patching took 5.763530731201172 ms
2022-09-21 17:07:33 INFO  ---RUNTIME: Original pipeline execution took 2676.8245697021484 ms (excluding imports and monkey-patching)
2022-09-21 17:07:33 INFO  Starting execution of 1 what-if analyses...
2022-09-21 17:07:33 INFO  Start plan generation for analysis PermutationFeatureImportance...
2022-09-21 17:07:33 INFO  ---RUNTIME: Plan generation took 0.11801719665527344 ms
2022-09-21 17:07:33 INFO  Estimated runtime of original DAG is 2399.186849594116ms
2022-09-21 17:07:33 WARNING Skipping Multi-Query Optimization (instead, only applying patches)
2022-09-21 17:07:33 INFO  Estimated unoptimised what-if runtime is 14395.121097564697ms
2022-09-21 17:07:33 INFO  ---RUNTIME: Multi-Query Optimization took 4.87065315246582 ms
2022-09-21 17:07:33 INFO  Executing generated plans
2022-09-21 17:07:46 INFO  ---RUNTIME: Execution took 13326.741695404053 ms
2022-09-21 17:07:46 INFO  Done!
2022-09-21 17:07:46 INFO  # Finished -- repetition 1 of 7 
2022-09-21 17:07:46 INFO  # Optimization benchmark for feature_importance with args [['healthcare', 'slow_loading', 'featurization_4', 'neural_network']] -- repetition 2 of 7
2022-09-21 17:07:46 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-21 17:07:46 INFO  Running instrumented original pipeline...
2022-09-21 17:07:46 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-21 17:07:46 INFO  ---RUNTIME: Importing and monkey-patching took 5.918025970458984 ms
2022-09-21 17:07:49 INFO  ---RUNTIME: Original pipeline execution took 2409.907817840576 ms (excluding imports and monkey-patching)
2022-09-21 17:07:49 INFO  Starting execution of 1 what-if analyses...
2022-09-21 17:07:49 INFO  Start plan generation for analysis PermutationFeatureImportance...
2022-09-21 17:07:49 INFO  ---RUNTIME: Plan generation took 0.12111663818359375 ms
2022-09-21 17:07:49 INFO  Estimated runtime of original DAG is 2125.021457672119ms
2022-09-21 17:07:49 INFO  Performing Multi-Query Optimization
2022-09-21 17:07:49 INFO  Estimated unoptimized what-if runtime is 12750.128746032715ms
2022-09-21 17:07:49 INFO  Estimated optimised what-if runtime is 2379.924774169922ms
2022-09-21 17:07:49 INFO  Estimated optimisation runtime saving is 10370.203971862793ms
2022-09-21 17:07:49 INFO  ---RUNTIME: Multi-Query Optimization took 14.475107192993164 ms
2022-09-21 17:07:49 INFO  Executing generated plans
2022-09-21 17:07:51 INFO  ---RUNTIME: Execution took 2348.227024078369 ms
2022-09-21 17:07:51 INFO  Done!
2022-09-21 17:07:51 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-21 17:07:51 INFO  Running instrumented original pipeline...
2022-09-21 17:07:51 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-21 17:07:51 INFO  ---RUNTIME: Importing and monkey-patching took 5.898952484130859 ms
2022-09-21 17:07:54 INFO  ---RUNTIME: Original pipeline execution took 2403.609037399292 ms (excluding imports and monkey-patching)
2022-09-21 17:07:54 INFO  Starting execution of 1 what-if analyses...
2022-09-21 17:07:54 INFO  Start plan generation for analysis PermutationFeatureImportance...
2022-09-21 17:07:54 INFO  ---RUNTIME: Plan generation took 0.12564659118652344 ms
2022-09-21 17:07:54 INFO  Estimated runtime of original DAG is 2125.7576942443848ms
2022-09-21 17:07:54 WARNING Skipping Multi-Query Optimization (instead, only applying patches)
2022-09-21 17:07:54 INFO  Estimated unoptimised what-if runtime is 12754.546165466309ms
2022-09-21 17:07:54 INFO  ---RUNTIME: Multi-Query Optimization took 6.318330764770508 ms
2022-09-21 17:07:54 INFO  Executing generated plans
2022-09-21 17:08:07 INFO  ---RUNTIME: Execution took 13358.391761779785 ms
2022-09-21 17:08:07 INFO  Done!
2022-09-21 17:08:07 INFO  # Finished -- repetition 2 of 7 
2022-09-21 17:08:07 INFO  # Optimization benchmark for feature_importance with args [['healthcare', 'slow_loading', 'featurization_4', 'neural_network']] -- repetition 3 of 7
2022-09-21 17:08:07 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-21 17:08:07 INFO  Running instrumented original pipeline...
2022-09-21 17:08:07 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-21 17:08:07 INFO  ---RUNTIME: Importing and monkey-patching took 6.219625473022461 ms
2022-09-21 17:08:09 INFO  ---RUNTIME: Original pipeline execution took 2393.9239978790283 ms (excluding imports and monkey-patching)
2022-09-21 17:08:09 INFO  Starting execution of 1 what-if analyses...
2022-09-21 17:08:09 INFO  Start plan generation for analysis PermutationFeatureImportance...
2022-09-21 17:08:09 INFO  ---RUNTIME: Plan generation took 0.13065338134765625 ms
2022-09-21 17:08:09 INFO  Estimated runtime of original DAG is 2120.4798221588135ms
2022-09-21 17:08:09 INFO  Performing Multi-Query Optimization
2022-09-21 17:08:09 INFO  Estimated unoptimized what-if runtime is 12722.87893295288ms
2022-09-21 17:08:09 INFO  Estimated optimised what-if runtime is 2380.000591278076ms
2022-09-21 17:08:09 INFO  Estimated optimisation runtime saving is 10342.878341674805ms
2022-09-21 17:08:09 INFO  ---RUNTIME: Multi-Query Optimization took 12.611865997314453 ms
2022-09-21 17:08:09 INFO  Executing generated plans
2022-09-21 17:08:12 INFO  ---RUNTIME: Execution took 2619.9824810028076 ms
2022-09-21 17:08:12 INFO  Done!
2022-09-21 17:08:12 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-21 17:08:12 INFO  Running instrumented original pipeline...
2022-09-21 17:08:12 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-21 17:08:12 INFO  ---RUNTIME: Importing and monkey-patching took 5.963802337646484 ms
2022-09-21 17:08:14 INFO  ---RUNTIME: Original pipeline execution took 2409.4817638397217 ms (excluding imports and monkey-patching)
2022-09-21 17:08:14 INFO  Starting execution of 1 what-if analyses...
2022-09-21 17:08:14 INFO  Start plan generation for analysis PermutationFeatureImportance...
2022-09-21 17:08:14 INFO  ---RUNTIME: Plan generation took 0.10943412780761719 ms
2022-09-21 17:08:14 INFO  Estimated runtime of original DAG is 2133.5105895996094ms
2022-09-21 17:08:14 WARNING Skipping Multi-Query Optimization (instead, only applying patches)
2022-09-21 17:08:14 INFO  Estimated unoptimised what-if runtime is 12801.063537597656ms
2022-09-21 17:08:14 INFO  ---RUNTIME: Multi-Query Optimization took 6.432056427001953 ms
2022-09-21 17:08:14 INFO  Executing generated plans
2022-09-21 17:08:28 INFO  ---RUNTIME: Execution took 13263.369798660278 ms
2022-09-21 17:08:28 INFO  Done!
2022-09-21 17:08:28 INFO  # Finished -- repetition 3 of 7 
2022-09-21 17:08:28 INFO  # Optimization benchmark for feature_importance with args [['healthcare', 'slow_loading', 'featurization_4', 'neural_network']] -- repetition 4 of 7
2022-09-21 17:08:28 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-21 17:08:28 INFO  Running instrumented original pipeline...
2022-09-21 17:08:28 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-21 17:08:28 INFO  ---RUNTIME: Importing and monkey-patching took 5.707025527954102 ms
2022-09-21 17:08:30 INFO  ---RUNTIME: Original pipeline execution took 2400.251626968384 ms (excluding imports and monkey-patching)
2022-09-21 17:08:30 INFO  Starting execution of 1 what-if analyses...
2022-09-21 17:08:30 INFO  Start plan generation for analysis PermutationFeatureImportance...
2022-09-21 17:08:30 INFO  ---RUNTIME: Plan generation took 0.13065338134765625 ms
2022-09-21 17:08:30 INFO  Estimated runtime of original DAG is 2125.1492500305176ms
2022-09-21 17:08:30 INFO  Performing Multi-Query Optimization
2022-09-21 17:08:30 INFO  Estimated unoptimized what-if runtime is 12750.895500183105ms
2022-09-21 17:08:30 INFO  Estimated optimised what-if runtime is 2385.5154514312744ms
2022-09-21 17:08:30 INFO  Estimated optimisation runtime saving is 10365.380048751831ms
2022-09-21 17:08:30 INFO  ---RUNTIME: Multi-Query Optimization took 12.392997741699219 ms
2022-09-21 17:08:30 INFO  Executing generated plans
2022-09-21 17:08:32 INFO  ---RUNTIME: Execution took 2322.2761154174805 ms
2022-09-21 17:08:32 INFO  Done!
2022-09-21 17:08:32 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-21 17:08:32 INFO  Running instrumented original pipeline...
2022-09-21 17:08:32 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-21 17:08:32 INFO  ---RUNTIME: Importing and monkey-patching took 6.130695343017578 ms
2022-09-21 17:08:35 INFO  ---RUNTIME: Original pipeline execution took 2467.179775238037 ms (excluding imports and monkey-patching)
2022-09-21 17:08:35 INFO  Starting execution of 1 what-if analyses...
2022-09-21 17:08:35 INFO  Start plan generation for analysis PermutationFeatureImportance...
2022-09-21 17:08:35 INFO  ---RUNTIME: Plan generation took 0.10895729064941406 ms
2022-09-21 17:08:35 INFO  Estimated runtime of original DAG is 2184.659957885742ms
2022-09-21 17:08:35 WARNING Skipping Multi-Query Optimization (instead, only applying patches)
2022-09-21 17:08:35 INFO  Estimated unoptimised what-if runtime is 13107.959747314453ms
2022-09-21 17:08:35 INFO  ---RUNTIME: Multi-Query Optimization took 4.792213439941406 ms
2022-09-21 17:08:35 INFO  Executing generated plans
2022-09-21 17:08:48 INFO  ---RUNTIME: Execution took 13377.855062484741 ms
2022-09-21 17:08:48 INFO  Done!
2022-09-21 17:08:48 INFO  # Finished -- repetition 4 of 7 
2022-09-21 17:08:48 INFO  # Optimization benchmark for feature_importance with args [['healthcare', 'slow_loading', 'featurization_4', 'neural_network']] -- repetition 5 of 7
2022-09-21 17:08:48 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-21 17:08:48 INFO  Running instrumented original pipeline...
2022-09-21 17:08:48 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-21 17:08:48 INFO  ---RUNTIME: Importing and monkey-patching took 6.402492523193359 ms
2022-09-21 17:08:51 INFO  ---RUNTIME: Original pipeline execution took 2816.0648345947266 ms (excluding imports and monkey-patching)
2022-09-21 17:08:51 INFO  Starting execution of 1 what-if analyses...
2022-09-21 17:08:51 INFO  Start plan generation for analysis PermutationFeatureImportance...
2022-09-21 17:08:51 INFO  ---RUNTIME: Plan generation took 0.11992454528808594 ms
2022-09-21 17:08:51 INFO  Estimated runtime of original DAG is 2540.3683185577393ms
2022-09-21 17:08:51 INFO  Performing Multi-Query Optimization
2022-09-21 17:08:51 INFO  Estimated unoptimized what-if runtime is 15242.209911346436ms
2022-09-21 17:08:51 INFO  Estimated optimised what-if runtime is 2805.47833442688ms
2022-09-21 17:08:51 INFO  Estimated optimisation runtime saving is 12436.731576919556ms
2022-09-21 17:08:51 INFO  ---RUNTIME: Multi-Query Optimization took 12.64333724975586 ms
2022-09-21 17:08:51 INFO  Executing generated plans
2022-09-21 17:08:53 INFO  ---RUNTIME: Execution took 2315.436601638794 ms
2022-09-21 17:08:53 INFO  Done!
2022-09-21 17:08:53 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-21 17:08:53 INFO  Running instrumented original pipeline...
2022-09-21 17:08:53 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-21 17:08:53 INFO  ---RUNTIME: Importing and monkey-patching took 5.736351013183594 ms
2022-09-21 17:08:56 INFO  ---RUNTIME: Original pipeline execution took 2574.0644931793213 ms (excluding imports and monkey-patching)
2022-09-21 17:08:56 INFO  Starting execution of 1 what-if analyses...
2022-09-21 17:08:56 INFO  Start plan generation for analysis PermutationFeatureImportance...
2022-09-21 17:08:56 INFO  ---RUNTIME: Plan generation took 0.10323524475097656 ms
2022-09-21 17:08:56 INFO  Estimated runtime of original DAG is 2295.494556427002ms
2022-09-21 17:08:56 WARNING Skipping Multi-Query Optimization (instead, only applying patches)
2022-09-21 17:08:56 INFO  Estimated unoptimised what-if runtime is 13772.967338562012ms
2022-09-21 17:08:56 INFO  ---RUNTIME: Multi-Query Optimization took 4.684925079345703 ms
2022-09-21 17:08:56 INFO  Executing generated plans
2022-09-21 17:09:09 INFO  ---RUNTIME: Execution took 13306.210279464722 ms
2022-09-21 17:09:09 INFO  Done!
2022-09-21 17:09:09 INFO  # Finished -- repetition 5 of 7 
2022-09-21 17:09:09 INFO  # Optimization benchmark for feature_importance with args [['healthcare', 'slow_loading', 'featurization_4', 'neural_network']] -- repetition 6 of 7
2022-09-21 17:09:09 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-21 17:09:09 INFO  Running instrumented original pipeline...
2022-09-21 17:09:09 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-21 17:09:09 INFO  ---RUNTIME: Importing and monkey-patching took 6.021738052368164 ms
2022-09-21 17:09:12 INFO  ---RUNTIME: Original pipeline execution took 2426.96213722229 ms (excluding imports and monkey-patching)
2022-09-21 17:09:12 INFO  Starting execution of 1 what-if analyses...
2022-09-21 17:09:12 INFO  Start plan generation for analysis PermutationFeatureImportance...
2022-09-21 17:09:12 INFO  ---RUNTIME: Plan generation took 0.12564659118652344 ms
2022-09-21 17:09:12 INFO  Estimated runtime of original DAG is 2149.6384143829346ms
2022-09-21 17:09:12 INFO  Performing Multi-Query Optimization
2022-09-21 17:09:12 INFO  Estimated unoptimized what-if runtime is 12897.830486297607ms
2022-09-21 17:09:12 INFO  Estimated optimised what-if runtime is 2409.691095352173ms
2022-09-21 17:09:12 INFO  Estimated optimisation runtime saving is 10488.139390945435ms
2022-09-21 17:09:12 INFO  ---RUNTIME: Multi-Query Optimization took 12.518882751464844 ms
2022-09-21 17:09:12 INFO  Executing generated plans
2022-09-21 17:09:14 INFO  ---RUNTIME: Execution took 2423.1116771698 ms
2022-09-21 17:09:14 INFO  Done!
2022-09-21 17:09:14 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-21 17:09:14 INFO  Running instrumented original pipeline...
2022-09-21 17:09:14 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-21 17:09:14 INFO  ---RUNTIME: Importing and monkey-patching took 5.735158920288086 ms
2022-09-21 17:09:17 INFO  ---RUNTIME: Original pipeline execution took 2740.892171859741 ms (excluding imports and monkey-patching)
2022-09-21 17:09:17 INFO  Starting execution of 1 what-if analyses...
2022-09-21 17:09:17 INFO  Start plan generation for analysis PermutationFeatureImportance...
2022-09-21 17:09:17 INFO  ---RUNTIME: Plan generation took 0.11968612670898438 ms
2022-09-21 17:09:17 INFO  Estimated runtime of original DAG is 2465.1038646698ms
2022-09-21 17:09:17 WARNING Skipping Multi-Query Optimization (instead, only applying patches)
2022-09-21 17:09:17 INFO  Estimated unoptimised what-if runtime is 14790.623188018799ms
2022-09-21 17:09:17 INFO  ---RUNTIME: Multi-Query Optimization took 4.9114227294921875 ms
2022-09-21 17:09:17 INFO  Executing generated plans
2022-09-21 17:09:30 INFO  ---RUNTIME: Execution took 13074.328184127808 ms
2022-09-21 17:09:30 INFO  Done!
2022-09-21 17:09:30 INFO  # Finished -- repetition 6 of 7 
2022-09-21 17:09:30 INFO  # Optimization benchmark for feature_importance with args [['healthcare', 'slow_loading', 'featurization_4', 'neural_network']] -- repetition 7 of 7
2022-09-21 17:09:30 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-21 17:09:30 INFO  Running instrumented original pipeline...
2022-09-21 17:09:30 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-21 17:09:30 INFO  ---RUNTIME: Importing and monkey-patching took 5.949497222900391 ms
2022-09-21 17:09:33 INFO  ---RUNTIME: Original pipeline execution took 2784.874677658081 ms (excluding imports and monkey-patching)
2022-09-21 17:09:33 INFO  Starting execution of 1 what-if analyses...
2022-09-21 17:09:33 INFO  Start plan generation for analysis PermutationFeatureImportance...
2022-09-21 17:09:33 INFO  ---RUNTIME: Plan generation took 0.11277198791503906 ms
2022-09-21 17:09:33 INFO  Estimated runtime of original DAG is 2508.3096027374268ms
2022-09-21 17:09:33 INFO  Performing Multi-Query Optimization
2022-09-21 17:09:33 INFO  Estimated unoptimized what-if runtime is 15049.85761642456ms
2022-09-21 17:09:33 INFO  Estimated optimised what-if runtime is 2786.789655685425ms
2022-09-21 17:09:33 INFO  Estimated optimisation runtime saving is 12263.067960739136ms
2022-09-21 17:09:33 INFO  ---RUNTIME: Multi-Query Optimization took 12.502431869506836 ms
2022-09-21 17:09:33 INFO  Executing generated plans
2022-09-21 17:09:35 INFO  ---RUNTIME: Execution took 2388.5366916656494 ms
2022-09-21 17:09:35 INFO  Done!
2022-09-21 17:09:35 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-21 17:09:35 INFO  Running instrumented original pipeline...
2022-09-21 17:09:35 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-21 17:09:35 INFO  ---RUNTIME: Importing and monkey-patching took 5.959272384643555 ms
2022-09-21 17:09:38 INFO  ---RUNTIME: Original pipeline execution took 2425.668716430664 ms (excluding imports and monkey-patching)
2022-09-21 17:09:38 INFO  Starting execution of 1 what-if analyses...
2022-09-21 17:09:38 INFO  Start plan generation for analysis PermutationFeatureImportance...
2022-09-21 17:09:38 INFO  ---RUNTIME: Plan generation took 0.12469291687011719 ms
2022-09-21 17:09:38 INFO  Estimated runtime of original DAG is 2145.6148624420166ms
2022-09-21 17:09:38 WARNING Skipping Multi-Query Optimization (instead, only applying patches)
2022-09-21 17:09:38 INFO  Estimated unoptimised what-if runtime is 12873.6891746521ms
2022-09-21 17:09:38 INFO  ---RUNTIME: Multi-Query Optimization took 5.224943161010742 ms
2022-09-21 17:09:38 INFO  Executing generated plans
2022-09-21 17:09:51 INFO  ---RUNTIME: Execution took 13331.361532211304 ms
2022-09-21 17:09:51 INFO  Done!
2022-09-21 17:09:51 INFO  # Finished -- repetition 7 of 7 
2022-09-21 17:09:51 INFO  # Final results after all repetitions
2022-09-21 17:09:51 INFO     repetition  ... no_opt_what_if_execution_combined_model_training
0           0  ...                                      2271.432877
1           1  ...                                      2288.510799
2           2  ...                                      1987.411499
3           3  ...                                      1992.355824
4           4  ...                                      2271.165133
5           5  ...                                      2001.269341
6           6  ...                                      2342.292786

[7 rows x 26 columns]
PROTOCOL_BUFFERS_PYTHON_IMPLEMENTATION=python taskset -c 0-7 python3.9 benchmarks_end_to_end.py data_corruption healthcare slow_loading image image
2022-09-21 17:09:53.695845: W tensorflow/stream_executor/platform/default/dso_loader.cc:64] Could not load dynamic library 'libcudart.so.11.0'; dlerror: libcudart.so.11.0: cannot open shared object file: No such file or directory; LD_LIBRARY_PATH: /home/sgrafbe/mlwhatif/venv/lib/python3.9/site-packages/cv2/../../lib64:
2022-09-21 17:09:53.695889: I tensorflow/stream_executor/cuda/cudart_stub.cc:29] Ignore above cudart dlerror if you do not have a GPU set up on your machine.
2022-09-21 17:09:54 INFO  Patching sys.argv with ['mlwhatif', 'sneakers', 'slow_loading', 'image', 'image']
2022-09-21 17:09:54 INFO  Running instrumented original pipeline...
2022-09-21 17:09:55 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-21 17:09:55 INFO  ---RUNTIME: Importing and monkey-patching took 95.55935859680176 ms
2022-09-21 17:09:58.717797: W tensorflow/stream_executor/platform/default/dso_loader.cc:64] Could not load dynamic library 'libcuda.so.1'; dlerror: libcuda.so.1: cannot open shared object file: No such file or directory; LD_LIBRARY_PATH: /home/sgrafbe/mlwhatif/venv/lib/python3.9/site-packages/cv2/../../lib64:
2022-09-21 17:09:58.717831: W tensorflow/stream_executor/cuda/cuda_driver.cc:326] failed call to cuInit: UNKNOWN ERROR (303)
2022-09-21 17:09:58.717855: I tensorflow/stream_executor/cuda/cuda_diagnostics.cc:156] kernel driver does not appear to be running on this host (wagyu): /proc/driver/nvidia/version does not exist
2022-09-21 17:09:58.718316: I tensorflow/core/platform/cpu_feature_guard.cc:142] This TensorFlow binary is optimized with oneAPI Deep Neural Network Library (oneDNN) to use the following CPU instructions in performance-critical operations:  AVX2 FMA
To enable them in other operations, rebuild TensorFlow with the appropriate compiler flags.
2022-09-21 17:09:58.799258: I tensorflow/compiler/mlir/mlir_graph_optimization_pass.cc:176] None of the MLIR Optimization Passes are enabled (registered 2)
2022-09-21 17:09:58.811433: I tensorflow/core/platform/profile_utils/cpu_utils.cc:114] CPU Frequency: 2595290000 Hz
2022-09-21 17:10:02 INFO  ---RUNTIME: Original pipeline execution took 7171.885013580322 ms (excluding imports and monkey-patching)
2022-09-21 17:10:02 INFO  Starting execution of 0 what-if analyses...
2022-09-21 17:10:02 INFO  Estimated runtime of original DAG is 6894.838809967041ms
2022-09-21 17:10:02 INFO  Performing Multi-Query Optimization
2022-09-21 17:10:02 INFO  Estimated unoptimized what-if runtime is 0ms
2022-09-21 17:10:02 INFO  Estimated optimised what-if runtime is 0ms
2022-09-21 17:10:02 INFO  Estimated optimisation runtime saving is 0ms
2022-09-21 17:10:02 INFO  ---RUNTIME: Multi-Query Optimization took 0.36787986755371094 ms
2022-09-21 17:10:02 INFO  Executing generated plans
2022-09-21 17:10:02 INFO  ---RUNTIME: Execution took 0.018596649169921875 ms
2022-09-21 17:10:02 INFO  Done!
2022-09-21 17:10:02 INFO  # Optimization benchmark for data_corruption with args [['sneakers', 'slow_loading', 'image', 'image']] -- repetition 1 of 7
2022-09-21 17:10:02 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-21 17:10:02 INFO  Running instrumented original pipeline...
2022-09-21 17:10:02 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-21 17:10:02 INFO  ---RUNTIME: Importing and monkey-patching took 5.121469497680664 ms
2022-09-21 17:10:08 INFO  ---RUNTIME: Original pipeline execution took 5932.848930358887 ms (excluding imports and monkey-patching)
2022-09-21 17:10:08 INFO  Starting execution of 1 what-if analyses...
2022-09-21 17:10:08 INFO  Start plan generation for analysis DataCorruption...
2022-09-21 17:10:08 INFO  ---RUNTIME: Plan generation took 0.4105567932128906 ms
2022-09-21 17:10:08 INFO  Estimated runtime of original DAG is 5682.55615234375ms
2022-09-21 17:10:08 INFO  Performing Multi-Query Optimization
2022-09-21 17:10:08 INFO  Estimated unoptimized what-if runtime is 113651.123046875ms
2022-09-21 17:10:08 INFO  Estimated optimised what-if runtime is 7377.116441726685ms
2022-09-21 17:10:08 INFO  Estimated optimisation runtime saving is 106274.00660514832ms
2022-09-21 17:10:08 INFO  ---RUNTIME: Multi-Query Optimization took 31.70156478881836 ms
2022-09-21 17:10:08 INFO  Executing generated plans
2022-09-21 17:10:20 INFO  ---RUNTIME: Execution took 11885.728120803833 ms
2022-09-21 17:10:20 INFO  Done!
2022-09-21 17:10:20 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-21 17:10:20 INFO  Running instrumented original pipeline...
2022-09-21 17:10:20 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-21 17:10:20 INFO  ---RUNTIME: Importing and monkey-patching took 5.983829498291016 ms
2022-09-21 17:10:25 INFO  ---RUNTIME: Original pipeline execution took 5874.128580093384 ms (excluding imports and monkey-patching)
2022-09-21 17:10:25 INFO  Starting execution of 1 what-if analyses...
2022-09-21 17:10:25 INFO  Start plan generation for analysis DataCorruption...
2022-09-21 17:10:25 INFO  ---RUNTIME: Plan generation took 0.4115104675292969 ms
2022-09-21 17:10:25 INFO  Estimated runtime of original DAG is 5629.097700119019ms
2022-09-21 17:10:25 WARNING Skipping Multi-Query Optimization (instead, only applying patches)
2022-09-21 17:10:25 INFO  Estimated unoptimised what-if runtime is 112581.95400238037ms
2022-09-21 17:10:25 INFO  ---RUNTIME: Multi-Query Optimization took 7.531404495239258 ms
2022-09-21 17:10:25 INFO  Executing generated plans
2022-09-21 17:12:32 INFO  ---RUNTIME: Execution took 126813.72904777527 ms
2022-09-21 17:12:32 INFO  Done!
2022-09-21 17:12:32 INFO  # Finished -- repetition 1 of 7 
2022-09-21 17:12:32 INFO  # Optimization benchmark for data_corruption with args [['sneakers', 'slow_loading', 'image', 'image']] -- repetition 2 of 7
2022-09-21 17:12:32 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-21 17:12:32 INFO  Running instrumented original pipeline...
2022-09-21 17:12:32 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-21 17:12:32 INFO  ---RUNTIME: Importing and monkey-patching took 5.955934524536133 ms
2022-09-21 17:12:38 INFO  ---RUNTIME: Original pipeline execution took 5951.929569244385 ms (excluding imports and monkey-patching)
2022-09-21 17:12:38 INFO  Starting execution of 1 what-if analyses...
2022-09-21 17:12:38 INFO  Start plan generation for analysis DataCorruption...
2022-09-21 17:12:38 INFO  ---RUNTIME: Plan generation took 0.3552436828613281 ms
2022-09-21 17:12:38 INFO  Estimated runtime of original DAG is 5706.905364990234ms
2022-09-21 17:12:38 INFO  Performing Multi-Query Optimization
2022-09-21 17:12:38 INFO  Estimated unoptimized what-if runtime is 114138.10729980469ms
2022-09-21 17:12:38 INFO  Estimated optimised what-if runtime is 7292.565584182739ms
2022-09-21 17:12:38 INFO  Estimated optimisation runtime saving is 106845.54171562195ms
2022-09-21 17:12:38 INFO  ---RUNTIME: Multi-Query Optimization took 33.30254554748535 ms
2022-09-21 17:12:38 INFO  Executing generated plans
2022-09-21 17:12:50 INFO  ---RUNTIME: Execution took 11952.573776245117 ms
2022-09-21 17:12:50 INFO  Done!
2022-09-21 17:12:50 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-21 17:12:50 INFO  Running instrumented original pipeline...
2022-09-21 17:12:50 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-21 17:12:50 INFO  ---RUNTIME: Importing and monkey-patching took 6.012439727783203 ms
2022-09-21 17:12:56 INFO  ---RUNTIME: Original pipeline execution took 5969.004392623901 ms (excluding imports and monkey-patching)
2022-09-21 17:12:56 INFO  Starting execution of 1 what-if analyses...
2022-09-21 17:12:56 INFO  Start plan generation for analysis DataCorruption...
2022-09-21 17:12:56 INFO  ---RUNTIME: Plan generation took 0.484466552734375 ms
2022-09-21 17:12:56 INFO  Estimated runtime of original DAG is 5714.928150177002ms
2022-09-21 17:12:56 WARNING Skipping Multi-Query Optimization (instead, only applying patches)
2022-09-21 17:12:56 INFO  Estimated unoptimised what-if runtime is 114298.56300354004ms
2022-09-21 17:12:56 INFO  ---RUNTIME: Multi-Query Optimization took 7.672786712646484 ms
2022-09-21 17:12:56 INFO  Executing generated plans
2022-09-21 17:15:02 INFO  ---RUNTIME: Execution took 125964.56408500671 ms
2022-09-21 17:15:02 INFO  Done!
2022-09-21 17:15:02 INFO  # Finished -- repetition 2 of 7 
2022-09-21 17:15:02 INFO  # Optimization benchmark for data_corruption with args [['sneakers', 'slow_loading', 'image', 'image']] -- repetition 3 of 7
2022-09-21 17:15:02 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-21 17:15:02 INFO  Running instrumented original pipeline...
2022-09-21 17:15:02 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-21 17:15:02 INFO  ---RUNTIME: Importing and monkey-patching took 5.991220474243164 ms
2022-09-21 17:15:08 INFO  ---RUNTIME: Original pipeline execution took 6256.799936294556 ms (excluding imports and monkey-patching)
2022-09-21 17:15:08 INFO  Starting execution of 1 what-if analyses...
2022-09-21 17:15:08 INFO  Start plan generation for analysis DataCorruption...
2022-09-21 17:15:08 INFO  ---RUNTIME: Plan generation took 0.3154277801513672 ms
2022-09-21 17:15:08 INFO  Estimated runtime of original DAG is 6006.482839584351ms
2022-09-21 17:15:08 INFO  Performing Multi-Query Optimization
2022-09-21 17:15:08 INFO  Estimated unoptimized what-if runtime is 120129.65679168701ms
2022-09-21 17:15:08 INFO  Estimated optimised what-if runtime is 7628.609180450439ms
2022-09-21 17:15:08 INFO  Estimated optimisation runtime saving is 112501.04761123657ms
2022-09-21 17:15:08 INFO  ---RUNTIME: Multi-Query Optimization took 31.18896484375 ms
2022-09-21 17:15:08 INFO  Executing generated plans
2022-09-21 17:15:20 INFO  ---RUNTIME: Execution took 11476.807594299316 ms
2022-09-21 17:15:20 INFO  Done!
2022-09-21 17:15:20 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-21 17:15:20 INFO  Running instrumented original pipeline...
2022-09-21 17:15:20 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-21 17:15:20 INFO  ---RUNTIME: Importing and monkey-patching took 5.80143928527832 ms
2022-09-21 17:15:26 INFO  ---RUNTIME: Original pipeline execution took 5830.972909927368 ms (excluding imports and monkey-patching)
2022-09-21 17:15:26 INFO  Starting execution of 1 what-if analyses...
2022-09-21 17:15:26 INFO  Start plan generation for analysis DataCorruption...
2022-09-21 17:15:26 INFO  ---RUNTIME: Plan generation took 0.4184246063232422 ms
2022-09-21 17:15:26 INFO  Estimated runtime of original DAG is 5579.961061477661ms
2022-09-21 17:15:26 WARNING Skipping Multi-Query Optimization (instead, only applying patches)
2022-09-21 17:15:26 INFO  Estimated unoptimised what-if runtime is 111599.22122955322ms
2022-09-21 17:15:26 INFO  ---RUNTIME: Multi-Query Optimization took 9.311676025390625 ms
2022-09-21 17:15:26 INFO  Executing generated plans
2022-09-21 17:17:32 INFO  ---RUNTIME: Execution took 126331.08401298523 ms
2022-09-21 17:17:32 INFO  Done!
2022-09-21 17:17:32 INFO  # Finished -- repetition 3 of 7 
2022-09-21 17:17:32 INFO  # Optimization benchmark for data_corruption with args [['sneakers', 'slow_loading', 'image', 'image']] -- repetition 4 of 7
2022-09-21 17:17:32 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-21 17:17:32 INFO  Running instrumented original pipeline...
2022-09-21 17:17:32 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-21 17:17:32 INFO  ---RUNTIME: Importing and monkey-patching took 6.085395812988281 ms
2022-09-21 17:17:38 INFO  ---RUNTIME: Original pipeline execution took 6029.211044311523 ms (excluding imports and monkey-patching)
2022-09-21 17:17:38 INFO  Starting execution of 1 what-if analyses...
2022-09-21 17:17:38 INFO  Start plan generation for analysis DataCorruption...
2022-09-21 17:17:38 INFO  ---RUNTIME: Plan generation took 0.40340423583984375 ms
2022-09-21 17:17:38 INFO  Estimated runtime of original DAG is 5772.436141967773ms
2022-09-21 17:17:38 INFO  Performing Multi-Query Optimization
2022-09-21 17:17:38 INFO  Estimated unoptimized what-if runtime is 115448.72283935547ms
2022-09-21 17:17:38 INFO  Estimated optimised what-if runtime is 7362.581014633179ms
2022-09-21 17:17:38 INFO  Estimated optimisation runtime saving is 108086.14182472229ms
2022-09-21 17:17:38 INFO  ---RUNTIME: Multi-Query Optimization took 31.786680221557617 ms
2022-09-21 17:17:38 INFO  Executing generated plans
2022-09-21 17:17:50 INFO  ---RUNTIME: Execution took 11491.028785705566 ms
2022-09-21 17:17:50 INFO  Done!
2022-09-21 17:17:50 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-21 17:17:50 INFO  Running instrumented original pipeline...
2022-09-21 17:17:50 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-21 17:17:50 INFO  ---RUNTIME: Importing and monkey-patching took 5.890130996704102 ms
2022-09-21 17:17:56 INFO  ---RUNTIME: Original pipeline execution took 5884.234666824341 ms (excluding imports and monkey-patching)
2022-09-21 17:17:56 INFO  Starting execution of 1 what-if analyses...
2022-09-21 17:17:56 INFO  Start plan generation for analysis DataCorruption...
2022-09-21 17:17:56 INFO  ---RUNTIME: Plan generation took 0.4057884216308594 ms
2022-09-21 17:17:56 INFO  Estimated runtime of original DAG is 5634.145259857178ms
2022-09-21 17:17:56 WARNING Skipping Multi-Query Optimization (instead, only applying patches)
2022-09-21 17:17:56 INFO  Estimated unoptimised what-if runtime is 112682.90519714355ms
2022-09-21 17:17:56 INFO  ---RUNTIME: Multi-Query Optimization took 7.475852966308594 ms
2022-09-21 17:17:56 INFO  Executing generated plans
2022-09-21 17:20:03 INFO  ---RUNTIME: Execution took 127432.96599388123 ms
2022-09-21 17:20:03 INFO  Done!
2022-09-21 17:20:03 INFO  # Finished -- repetition 4 of 7 
2022-09-21 17:20:03 INFO  # Optimization benchmark for data_corruption with args [['sneakers', 'slow_loading', 'image', 'image']] -- repetition 5 of 7
2022-09-21 17:20:03 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-21 17:20:03 INFO  Running instrumented original pipeline...
2022-09-21 17:20:03 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-21 17:20:03 INFO  ---RUNTIME: Importing and monkey-patching took 6.105184555053711 ms
2022-09-21 17:20:09 INFO  ---RUNTIME: Original pipeline execution took 5899.028062820435 ms (excluding imports and monkey-patching)
2022-09-21 17:20:09 INFO  Starting execution of 1 what-if analyses...
2022-09-21 17:20:09 INFO  Start plan generation for analysis DataCorruption...
2022-09-21 17:20:09 INFO  ---RUNTIME: Plan generation took 0.3581047058105469 ms
2022-09-21 17:20:09 INFO  Estimated runtime of original DAG is 5643.559217453003ms
2022-09-21 17:20:09 INFO  Performing Multi-Query Optimization
2022-09-21 17:20:09 INFO  Estimated unoptimized what-if runtime is 112871.18434906006ms
2022-09-21 17:20:09 INFO  Estimated optimised what-if runtime is 7248.199939727783ms
2022-09-21 17:20:09 INFO  Estimated optimisation runtime saving is 105622.98440933228ms
2022-09-21 17:20:09 INFO  ---RUNTIME: Multi-Query Optimization took 31.269311904907227 ms
2022-09-21 17:20:09 INFO  Executing generated plans
2022-09-21 17:20:20 INFO  ---RUNTIME: Execution took 11482.406377792358 ms
2022-09-21 17:20:20 INFO  Done!
2022-09-21 17:20:20 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-21 17:20:20 INFO  Running instrumented original pipeline...
2022-09-21 17:20:21 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-21 17:20:21 INFO  ---RUNTIME: Importing and monkey-patching took 5.885124206542969 ms
2022-09-21 17:20:27 INFO  ---RUNTIME: Original pipeline execution took 6239.092826843262 ms (excluding imports and monkey-patching)
2022-09-21 17:20:27 INFO  Starting execution of 1 what-if analyses...
2022-09-21 17:20:27 INFO  Start plan generation for analysis DataCorruption...
2022-09-21 17:20:27 INFO  ---RUNTIME: Plan generation took 0.3485679626464844 ms
2022-09-21 17:20:27 INFO  Estimated runtime of original DAG is 5988.932371139526ms
2022-09-21 17:20:27 WARNING Skipping Multi-Query Optimization (instead, only applying patches)
2022-09-21 17:20:27 INFO  Estimated unoptimised what-if runtime is 119778.64742279053ms
2022-09-21 17:20:27 INFO  ---RUNTIME: Multi-Query Optimization took 8.337259292602539 ms
2022-09-21 17:20:27 INFO  Executing generated plans
2022-09-21 17:22:33 INFO  ---RUNTIME: Execution took 126201.27415657043 ms
2022-09-21 17:22:33 INFO  Done!
2022-09-21 17:22:33 INFO  # Finished -- repetition 5 of 7 
2022-09-21 17:22:33 INFO  # Optimization benchmark for data_corruption with args [['sneakers', 'slow_loading', 'image', 'image']] -- repetition 6 of 7
2022-09-21 17:22:33 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-21 17:22:33 INFO  Running instrumented original pipeline...
2022-09-21 17:22:33 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-21 17:22:33 INFO  ---RUNTIME: Importing and monkey-patching took 5.956888198852539 ms
2022-09-21 17:22:39 INFO  ---RUNTIME: Original pipeline execution took 5910.869836807251 ms (excluding imports and monkey-patching)
2022-09-21 17:22:39 INFO  Starting execution of 1 what-if analyses...
2022-09-21 17:22:39 INFO  Start plan generation for analysis DataCorruption...
2022-09-21 17:22:39 INFO  ---RUNTIME: Plan generation took 0.37169456481933594 ms
2022-09-21 17:22:39 INFO  Estimated runtime of original DAG is 5657.069683074951ms
2022-09-21 17:22:39 INFO  Performing Multi-Query Optimization
2022-09-21 17:22:39 INFO  Estimated unoptimized what-if runtime is 113141.39366149902ms
2022-09-21 17:22:39 INFO  Estimated optimised what-if runtime is 7227.373361587524ms
2022-09-21 17:22:39 INFO  Estimated optimisation runtime saving is 105914.0202999115ms
2022-09-21 17:22:39 INFO  ---RUNTIME: Multi-Query Optimization took 31.07762336730957 ms
2022-09-21 17:22:39 INFO  Executing generated plans
2022-09-21 17:22:50 INFO  ---RUNTIME: Execution took 11490.98253250122 ms
2022-09-21 17:22:50 INFO  Done!
2022-09-21 17:22:50 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-21 17:22:50 INFO  Running instrumented original pipeline...
2022-09-21 17:22:50 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-21 17:22:50 INFO  ---RUNTIME: Importing and monkey-patching took 5.877256393432617 ms
2022-09-21 17:22:57 INFO  ---RUNTIME: Original pipeline execution took 6196.022272109985 ms (excluding imports and monkey-patching)
2022-09-21 17:22:57 INFO  Starting execution of 1 what-if analyses...
2022-09-21 17:22:57 INFO  Start plan generation for analysis DataCorruption...
2022-09-21 17:22:57 INFO  ---RUNTIME: Plan generation took 0.3170967102050781 ms
2022-09-21 17:22:57 INFO  Estimated runtime of original DAG is 5947.7527141571045ms
2022-09-21 17:22:57 WARNING Skipping Multi-Query Optimization (instead, only applying patches)
2022-09-21 17:22:57 INFO  Estimated unoptimised what-if runtime is 118955.05428314209ms
2022-09-21 17:22:57 INFO  ---RUNTIME: Multi-Query Optimization took 8.297920227050781 ms
2022-09-21 17:22:57 INFO  Executing generated plans
2022-09-21 17:25:03 INFO  ---RUNTIME: Execution took 126765.55228233337 ms
2022-09-21 17:25:03 INFO  Done!
2022-09-21 17:25:03 INFO  # Finished -- repetition 6 of 7 
2022-09-21 17:25:03 INFO  # Optimization benchmark for data_corruption with args [['sneakers', 'slow_loading', 'image', 'image']] -- repetition 7 of 7
2022-09-21 17:25:03 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-21 17:25:03 INFO  Running instrumented original pipeline...
2022-09-21 17:25:03 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-21 17:25:03 INFO  ---RUNTIME: Importing and monkey-patching took 6.025552749633789 ms
2022-09-21 17:25:09 INFO  ---RUNTIME: Original pipeline execution took 5892.06862449646 ms (excluding imports and monkey-patching)
2022-09-21 17:25:09 INFO  Starting execution of 1 what-if analyses...
2022-09-21 17:25:09 INFO  Start plan generation for analysis DataCorruption...
2022-09-21 17:25:09 INFO  ---RUNTIME: Plan generation took 0.3879070281982422 ms
2022-09-21 17:25:09 INFO  Estimated runtime of original DAG is 5637.299537658691ms
2022-09-21 17:25:09 INFO  Performing Multi-Query Optimization
2022-09-21 17:25:09 INFO  Estimated unoptimized what-if runtime is 112745.99075317383ms
2022-09-21 17:25:09 INFO  Estimated optimised what-if runtime is 7209.496736526489ms
2022-09-21 17:25:09 INFO  Estimated optimisation runtime saving is 105536.49401664734ms
2022-09-21 17:25:09 INFO  ---RUNTIME: Multi-Query Optimization took 31.8450927734375 ms
2022-09-21 17:25:09 INFO  Executing generated plans
2022-09-21 17:25:21 INFO  ---RUNTIME: Execution took 11556.87665939331 ms
2022-09-21 17:25:21 INFO  Done!
2022-09-21 17:25:21 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-21 17:25:21 INFO  Running instrumented original pipeline...
2022-09-21 17:25:21 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-21 17:25:21 INFO  ---RUNTIME: Importing and monkey-patching took 5.974769592285156 ms
2022-09-21 17:25:27 INFO  ---RUNTIME: Original pipeline execution took 5846.904993057251 ms (excluding imports and monkey-patching)
2022-09-21 17:25:27 INFO  Starting execution of 1 what-if analyses...
2022-09-21 17:25:27 INFO  Start plan generation for analysis DataCorruption...
2022-09-21 17:25:27 INFO  ---RUNTIME: Plan generation took 0.4494190216064453 ms
2022-09-21 17:25:27 INFO  Estimated runtime of original DAG is 5597.231149673462ms
2022-09-21 17:25:27 WARNING Skipping Multi-Query Optimization (instead, only applying patches)
2022-09-21 17:25:27 INFO  Estimated unoptimised what-if runtime is 111944.62299346924ms
2022-09-21 17:25:27 INFO  ---RUNTIME: Multi-Query Optimization took 7.714033126831055 ms
2022-09-21 17:25:27 INFO  Executing generated plans
2022-09-21 17:27:33 INFO  ---RUNTIME: Execution took 126755.17272949219 ms
2022-09-21 17:27:33 INFO  Done!
2022-09-21 17:27:33 INFO  # Finished -- repetition 7 of 7 
2022-09-21 17:27:33 INFO  # Final results after all repetitions
2022-09-21 17:27:33 INFO     repetition  ... no_opt_what_if_execution_combined_model_training
0           0  ...                                     63118.826151
1           1  ...                                     62049.049616
2           2  ...                                     63015.289783
3           3  ...                                     62434.590816
4           4  ...                                     62403.601408
5           5  ...                                     61982.130289
6           6  ...                                     62836.231470

[7 rows x 26 columns]
PROTOCOL_BUFFERS_PYTHON_IMPLEMENTATION=python taskset -c 0-7 python3.9 benchmarks_end_to_end.py data_cleaning healthcare slow_loading image image
2022-09-21 17:27:36.370288: W tensorflow/stream_executor/platform/default/dso_loader.cc:64] Could not load dynamic library 'libcudart.so.11.0'; dlerror: libcudart.so.11.0: cannot open shared object file: No such file or directory; LD_LIBRARY_PATH: /home/sgrafbe/mlwhatif/venv/lib/python3.9/site-packages/cv2/../../lib64:
2022-09-21 17:27:36.370333: I tensorflow/stream_executor/cuda/cudart_stub.cc:29] Ignore above cudart dlerror if you do not have a GPU set up on your machine.
2022-09-21 17:27:37 INFO  Patching sys.argv with ['mlwhatif', 'sneakers', 'slow_loading', 'image', 'image']
2022-09-21 17:27:37 INFO  Running instrumented original pipeline...
2022-09-21 17:27:37 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-21 17:27:37 INFO  ---RUNTIME: Importing and monkey-patching took 95.43609619140625 ms
2022-09-21 17:27:40.478854: W tensorflow/stream_executor/platform/default/dso_loader.cc:64] Could not load dynamic library 'libcuda.so.1'; dlerror: libcuda.so.1: cannot open shared object file: No such file or directory; LD_LIBRARY_PATH: /home/sgrafbe/mlwhatif/venv/lib/python3.9/site-packages/cv2/../../lib64:
2022-09-21 17:27:40.478887: W tensorflow/stream_executor/cuda/cuda_driver.cc:326] failed call to cuInit: UNKNOWN ERROR (303)
2022-09-21 17:27:40.478910: I tensorflow/stream_executor/cuda/cuda_diagnostics.cc:156] kernel driver does not appear to be running on this host (wagyu): /proc/driver/nvidia/version does not exist
2022-09-21 17:27:40.479350: I tensorflow/core/platform/cpu_feature_guard.cc:142] This TensorFlow binary is optimized with oneAPI Deep Neural Network Library (oneDNN) to use the following CPU instructions in performance-critical operations:  AVX2 FMA
To enable them in other operations, rebuild TensorFlow with the appropriate compiler flags.
2022-09-21 17:27:40.558218: I tensorflow/compiler/mlir/mlir_graph_optimization_pass.cc:176] None of the MLIR Optimization Passes are enabled (registered 2)
2022-09-21 17:27:40.570376: I tensorflow/core/platform/profile_utils/cpu_utils.cc:114] CPU Frequency: 2595290000 Hz
2022-09-21 17:27:43 INFO  ---RUNTIME: Original pipeline execution took 6254.776954650879 ms (excluding imports and monkey-patching)
2022-09-21 17:27:43 INFO  Starting execution of 0 what-if analyses...
2022-09-21 17:27:43 INFO  Estimated runtime of original DAG is 5970.862865447998ms
2022-09-21 17:27:43 INFO  Performing Multi-Query Optimization
2022-09-21 17:27:43 INFO  Estimated unoptimized what-if runtime is 0ms
2022-09-21 17:27:43 INFO  Estimated optimised what-if runtime is 0ms
2022-09-21 17:27:43 INFO  Estimated optimisation runtime saving is 0ms
2022-09-21 17:27:43 INFO  ---RUNTIME: Multi-Query Optimization took 0.32830238342285156 ms
2022-09-21 17:27:43 INFO  Executing generated plans
2022-09-21 17:27:43 INFO  ---RUNTIME: Execution took 0.016927719116210938 ms
2022-09-21 17:27:43 INFO  Done!
2022-09-21 17:27:43 INFO  # Optimization benchmark for data_cleaning with args [['sneakers', 'slow_loading', 'image', 'image']] -- repetition 1 of 7
2022-09-21 17:27:43 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-21 17:27:43 INFO  Running instrumented original pipeline...
2022-09-21 17:27:43 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-21 17:27:43 INFO  ---RUNTIME: Importing and monkey-patching took 5.08880615234375 ms
2022-09-21 17:27:49 INFO  ---RUNTIME: Original pipeline execution took 5899.723529815674 ms (excluding imports and monkey-patching)
2022-09-21 17:27:49 INFO  Starting execution of 1 what-if analyses...
2022-09-21 17:27:49 INFO  Start plan generation for analysis DataCleaning...
2022-09-21 17:27:49 INFO  ---RUNTIME: Plan generation took 0.10776519775390625 ms
2022-09-21 17:27:49 INFO  Estimated runtime of original DAG is 5646.317005157471ms
2022-09-21 17:27:49 INFO  Performing Multi-Query Optimization
2022-09-21 17:27:49 INFO  Estimated unoptimized what-if runtime is 29804.697036743164ms
2022-09-21 17:27:49 INFO  Estimated optimised what-if runtime is 27320.67370414734ms
2022-09-21 17:27:49 INFO  Estimated optimisation runtime saving is 2484.023332595825ms
2022-09-21 17:27:49 INFO  ---RUNTIME: Multi-Query Optimization took 2.1762847900390625 ms
2022-09-21 17:27:49 INFO  Executing generated plans
2022-09-21 17:28:17 INFO  ---RUNTIME: Execution took 27431.26106262207 ms
2022-09-21 17:28:17 INFO  Done!
2022-09-21 17:28:17 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-21 17:28:17 INFO  Running instrumented original pipeline...
2022-09-21 17:28:17 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-21 17:28:17 INFO  ---RUNTIME: Importing and monkey-patching took 6.227016448974609 ms
2022-09-21 17:28:23 INFO  ---RUNTIME: Original pipeline execution took 5888.455152511597 ms (excluding imports and monkey-patching)
2022-09-21 17:28:23 INFO  Starting execution of 1 what-if analyses...
2022-09-21 17:28:23 INFO  Start plan generation for analysis DataCleaning...
2022-09-21 17:28:23 INFO  ---RUNTIME: Plan generation took 0.09751319885253906 ms
2022-09-21 17:28:23 INFO  Estimated runtime of original DAG is 5636.2714767456055ms
2022-09-21 17:28:23 WARNING Skipping Multi-Query Optimization (instead, only applying patches)
2022-09-21 17:28:23 INFO  Estimated unoptimised what-if runtime is 29730.740070343018ms
2022-09-21 17:28:23 INFO  ---RUNTIME: Multi-Query Optimization took 0.42939186096191406 ms
2022-09-21 17:28:23 INFO  Executing generated plans
2022-09-21 17:28:53 INFO  ---RUNTIME: Execution took 29848.10519218445 ms
2022-09-21 17:28:53 INFO  Done!
2022-09-21 17:28:53 INFO  # Finished -- repetition 1 of 7 
2022-09-21 17:28:53 INFO  # Optimization benchmark for data_cleaning with args [['sneakers', 'slow_loading', 'image', 'image']] -- repetition 2 of 7
2022-09-21 17:28:53 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-21 17:28:53 INFO  Running instrumented original pipeline...
2022-09-21 17:28:53 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-21 17:28:53 INFO  ---RUNTIME: Importing and monkey-patching took 6.680965423583984 ms
2022-09-21 17:28:59 INFO  ---RUNTIME: Original pipeline execution took 6195.011138916016 ms (excluding imports and monkey-patching)
2022-09-21 17:28:59 INFO  Starting execution of 1 what-if analyses...
2022-09-21 17:28:59 INFO  Start plan generation for analysis DataCleaning...
2022-09-21 17:28:59 INFO  ---RUNTIME: Plan generation took 0.08440017700195312 ms
2022-09-21 17:28:59 INFO  Estimated runtime of original DAG is 5941.148996353149ms
2022-09-21 17:28:59 INFO  Performing Multi-Query Optimization
2022-09-21 17:28:59 INFO  Estimated unoptimized what-if runtime is 32145.468711853027ms
2022-09-21 17:28:59 INFO  Estimated optimised what-if runtime is 29657.796144485474ms
2022-09-21 17:28:59 INFO  Estimated optimisation runtime saving is 2487.6725673675537ms
2022-09-21 17:28:59 INFO  ---RUNTIME: Multi-Query Optimization took 2.0143985748291016 ms
2022-09-21 17:28:59 INFO  Executing generated plans
2022-09-21 17:29:26 INFO  ---RUNTIME: Execution took 27662.74333000183 ms
2022-09-21 17:29:26 INFO  Done!
2022-09-21 17:29:26 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-21 17:29:26 INFO  Running instrumented original pipeline...
2022-09-21 17:29:26 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-21 17:29:26 INFO  ---RUNTIME: Importing and monkey-patching took 6.942987442016602 ms
2022-09-21 17:29:32 INFO  ---RUNTIME: Original pipeline execution took 5865.840911865234 ms (excluding imports and monkey-patching)
2022-09-21 17:29:32 INFO  Starting execution of 1 what-if analyses...
2022-09-21 17:29:32 INFO  Start plan generation for analysis DataCleaning...
2022-09-21 17:29:32 INFO  ---RUNTIME: Plan generation took 0.09632110595703125 ms
2022-09-21 17:29:32 INFO  Estimated runtime of original DAG is 5607.051372528076ms
2022-09-21 17:29:32 WARNING Skipping Multi-Query Optimization (instead, only applying patches)
2022-09-21 17:29:32 INFO  Estimated unoptimised what-if runtime is 29481.903076171875ms
2022-09-21 17:29:32 INFO  ---RUNTIME: Multi-Query Optimization took 0.4527568817138672 ms
2022-09-21 17:29:32 INFO  Executing generated plans
2022-09-21 17:30:03 INFO  ---RUNTIME: Execution took 30406.570434570312 ms
2022-09-21 17:30:03 INFO  Done!
2022-09-21 17:30:03 INFO  # Finished -- repetition 2 of 7 
2022-09-21 17:30:03 INFO  # Optimization benchmark for data_cleaning with args [['sneakers', 'slow_loading', 'image', 'image']] -- repetition 3 of 7
2022-09-21 17:30:03 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-21 17:30:03 INFO  Running instrumented original pipeline...
2022-09-21 17:30:03 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-21 17:30:03 INFO  ---RUNTIME: Importing and monkey-patching took 6.294488906860352 ms
2022-09-21 17:30:09 INFO  ---RUNTIME: Original pipeline execution took 6659.431219100952 ms (excluding imports and monkey-patching)
2022-09-21 17:30:09 INFO  Starting execution of 1 what-if analyses...
2022-09-21 17:30:09 INFO  Start plan generation for analysis DataCleaning...
2022-09-21 17:30:09 INFO  ---RUNTIME: Plan generation took 0.11110305786132812 ms
2022-09-21 17:30:09 INFO  Estimated runtime of original DAG is 6016.337633132935ms
2022-09-21 17:30:09 INFO  Performing Multi-Query Optimization
2022-09-21 17:30:09 INFO  Estimated unoptimized what-if runtime is 30516.398429870605ms
2022-09-21 17:30:09 INFO  Estimated optimised what-if runtime is 27657.886028289795ms
2022-09-21 17:30:09 INFO  Estimated optimisation runtime saving is 2858.5124015808105ms
2022-09-21 17:30:09 INFO  ---RUNTIME: Multi-Query Optimization took 2.222776412963867 ms
2022-09-21 17:30:09 INFO  Executing generated plans
2022-09-21 17:30:37 INFO  ---RUNTIME: Execution took 27867.2776222229 ms
2022-09-21 17:30:37 INFO  Done!
2022-09-21 17:30:37 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-21 17:30:37 INFO  Running instrumented original pipeline...
2022-09-21 17:30:37 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-21 17:30:37 INFO  ---RUNTIME: Importing and monkey-patching took 6.338834762573242 ms
2022-09-21 17:30:43 INFO  ---RUNTIME: Original pipeline execution took 5908.9343547821045 ms (excluding imports and monkey-patching)
2022-09-21 17:30:43 INFO  Starting execution of 1 what-if analyses...
2022-09-21 17:30:43 INFO  Start plan generation for analysis DataCleaning...
2022-09-21 17:30:43 INFO  ---RUNTIME: Plan generation took 0.08845329284667969 ms
2022-09-21 17:30:43 INFO  Estimated runtime of original DAG is 5646.265029907227ms
2022-09-21 17:30:43 WARNING Skipping Multi-Query Optimization (instead, only applying patches)
2022-09-21 17:30:43 INFO  Estimated unoptimised what-if runtime is 29761.746406555176ms
2022-09-21 17:30:43 INFO  ---RUNTIME: Multi-Query Optimization took 0.43582916259765625 ms
2022-09-21 17:30:43 INFO  Executing generated plans
2022-09-21 17:31:14 INFO  ---RUNTIME: Execution took 30954.04577255249 ms
2022-09-21 17:31:14 INFO  Done!
2022-09-21 17:31:14 INFO  # Finished -- repetition 3 of 7 
2022-09-21 17:31:14 INFO  # Optimization benchmark for data_cleaning with args [['sneakers', 'slow_loading', 'image', 'image']] -- repetition 4 of 7
2022-09-21 17:31:14 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-21 17:31:14 INFO  Running instrumented original pipeline...
2022-09-21 17:31:14 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-21 17:31:14 INFO  ---RUNTIME: Importing and monkey-patching took 6.758928298950195 ms
2022-09-21 17:31:20 INFO  ---RUNTIME: Original pipeline execution took 6285.065412521362 ms (excluding imports and monkey-patching)
2022-09-21 17:31:20 INFO  Starting execution of 1 what-if analyses...
2022-09-21 17:31:20 INFO  Start plan generation for analysis DataCleaning...
2022-09-21 17:31:20 INFO  ---RUNTIME: Plan generation took 0.102996826171875 ms
2022-09-21 17:31:20 INFO  Estimated runtime of original DAG is 6010.481119155884ms
2022-09-21 17:31:20 INFO  Performing Multi-Query Optimization
2022-09-21 17:31:20 INFO  Estimated unoptimized what-if runtime is 30533.657550811768ms
2022-09-21 17:31:20 INFO  Estimated optimised what-if runtime is 27686.469316482544ms
2022-09-21 17:31:20 INFO  Estimated optimisation runtime saving is 2847.1882343292236ms
2022-09-21 17:31:20 INFO  ---RUNTIME: Multi-Query Optimization took 2.184152603149414 ms
2022-09-21 17:31:20 INFO  Executing generated plans
2022-09-21 17:31:48 INFO  ---RUNTIME: Execution took 28061.3009929657 ms
2022-09-21 17:31:48 INFO  Done!
2022-09-21 17:31:48 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-21 17:31:48 INFO  Running instrumented original pipeline...
2022-09-21 17:31:49 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-21 17:31:49 INFO  ---RUNTIME: Importing and monkey-patching took 6.578922271728516 ms
2022-09-21 17:31:54 INFO  ---RUNTIME: Original pipeline execution took 5892.061233520508 ms (excluding imports and monkey-patching)
2022-09-21 17:31:54 INFO  Starting execution of 1 what-if analyses...
2022-09-21 17:31:54 INFO  Start plan generation for analysis DataCleaning...
2022-09-21 17:31:54 INFO  ---RUNTIME: Plan generation took 0.10704994201660156 ms
2022-09-21 17:31:54 INFO  Estimated runtime of original DAG is 5626.412868499756ms
2022-09-21 17:31:54 WARNING Skipping Multi-Query Optimization (instead, only applying patches)
2022-09-21 17:31:54 INFO  Estimated unoptimised what-if runtime is 29674.30877685547ms
2022-09-21 17:31:54 INFO  ---RUNTIME: Multi-Query Optimization took 0.4658699035644531 ms
2022-09-21 17:31:54 INFO  Executing generated plans
2022-09-21 17:32:25 INFO  ---RUNTIME: Execution took 30898.676872253418 ms
2022-09-21 17:32:25 INFO  Done!
2022-09-21 17:32:25 INFO  # Finished -- repetition 4 of 7 
2022-09-21 17:32:25 INFO  # Optimization benchmark for data_cleaning with args [['sneakers', 'slow_loading', 'image', 'image']] -- repetition 5 of 7
2022-09-21 17:32:25 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-21 17:32:25 INFO  Running instrumented original pipeline...
2022-09-21 17:32:26 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-21 17:32:26 INFO  ---RUNTIME: Importing and monkey-patching took 5.97071647644043 ms
2022-09-21 17:32:32 INFO  ---RUNTIME: Original pipeline execution took 6271.114349365234 ms (excluding imports and monkey-patching)
2022-09-21 17:32:32 INFO  Starting execution of 1 what-if analyses...
2022-09-21 17:32:32 INFO  Start plan generation for analysis DataCleaning...
2022-09-21 17:32:32 INFO  ---RUNTIME: Plan generation took 0.08034706115722656 ms
2022-09-21 17:32:32 INFO  Estimated runtime of original DAG is 5645.319938659668ms
2022-09-21 17:32:32 INFO  Performing Multi-Query Optimization
2022-09-21 17:32:32 INFO  Estimated unoptimized what-if runtime is 29771.394729614258ms
2022-09-21 17:32:32 INFO  Estimated optimised what-if runtime is 27283.740043640137ms
2022-09-21 17:32:32 INFO  Estimated optimisation runtime saving is 2487.654685974121ms
2022-09-21 17:32:32 INFO  ---RUNTIME: Multi-Query Optimization took 2.1059513092041016 ms
2022-09-21 17:32:32 INFO  Executing generated plans
2022-09-21 17:33:00 INFO  ---RUNTIME: Execution took 28553.86519432068 ms
2022-09-21 17:33:00 INFO  Done!
2022-09-21 17:33:00 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-21 17:33:00 INFO  Running instrumented original pipeline...
2022-09-21 17:33:00 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-21 17:33:00 INFO  ---RUNTIME: Importing and monkey-patching took 6.396293640136719 ms
2022-09-21 17:33:06 INFO  ---RUNTIME: Original pipeline execution took 5999.914646148682 ms (excluding imports and monkey-patching)
2022-09-21 17:33:06 INFO  Starting execution of 1 what-if analyses...
2022-09-21 17:33:06 INFO  Start plan generation for analysis DataCleaning...
2022-09-21 17:33:06 INFO  ---RUNTIME: Plan generation took 0.11944770812988281 ms
2022-09-21 17:33:06 INFO  Estimated runtime of original DAG is 5729.58517074585ms
2022-09-21 17:33:06 WARNING Skipping Multi-Query Optimization (instead, only applying patches)
2022-09-21 17:33:06 INFO  Estimated unoptimised what-if runtime is 29854.974269866943ms
2022-09-21 17:33:06 INFO  ---RUNTIME: Multi-Query Optimization took 0.4558563232421875 ms
2022-09-21 17:33:06 INFO  Executing generated plans
2022-09-21 17:33:37 INFO  ---RUNTIME: Execution took 30977.34808921814 ms
2022-09-21 17:33:37 INFO  Done!
2022-09-21 17:33:37 INFO  # Finished -- repetition 5 of 7 
2022-09-21 17:33:37 INFO  # Optimization benchmark for data_cleaning with args [['sneakers', 'slow_loading', 'image', 'image']] -- repetition 6 of 7
2022-09-21 17:33:37 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-21 17:33:37 INFO  Running instrumented original pipeline...
2022-09-21 17:33:37 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-21 17:33:37 INFO  ---RUNTIME: Importing and monkey-patching took 6.630182266235352 ms
2022-09-21 17:33:43 INFO  ---RUNTIME: Original pipeline execution took 6253.785610198975 ms (excluding imports and monkey-patching)
2022-09-21 17:33:43 INFO  Starting execution of 1 what-if analyses...
2022-09-21 17:33:43 INFO  Start plan generation for analysis DataCleaning...
2022-09-21 17:33:43 INFO  ---RUNTIME: Plan generation took 0.08845329284667969 ms
2022-09-21 17:33:43 INFO  Estimated runtime of original DAG is 5998.511552810669ms
2022-09-21 17:33:43 INFO  Performing Multi-Query Optimization
2022-09-21 17:33:43 INFO  Estimated unoptimized what-if runtime is 32628.54051589966ms
2022-09-21 17:33:43 INFO  Estimated optimised what-if runtime is 30145.76768875122ms
2022-09-21 17:33:43 INFO  Estimated optimisation runtime saving is 2482.7728271484375ms
2022-09-21 17:33:43 INFO  ---RUNTIME: Multi-Query Optimization took 2.0945072174072266 ms
2022-09-21 17:33:43 INFO  Executing generated plans
2022-09-21 17:34:12 INFO  ---RUNTIME: Execution took 28339.818716049194 ms
2022-09-21 17:34:12 INFO  Done!
2022-09-21 17:34:12 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-21 17:34:12 INFO  Running instrumented original pipeline...
2022-09-21 17:34:12 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-21 17:34:12 INFO  ---RUNTIME: Importing and monkey-patching took 6.192922592163086 ms
2022-09-21 17:34:18 INFO  ---RUNTIME: Original pipeline execution took 5934.028625488281 ms (excluding imports and monkey-patching)
2022-09-21 17:34:18 INFO  Starting execution of 1 what-if analyses...
2022-09-21 17:34:18 INFO  Start plan generation for analysis DataCleaning...
2022-09-21 17:34:18 INFO  ---RUNTIME: Plan generation took 0.08821487426757812 ms
2022-09-21 17:34:18 INFO  Estimated runtime of original DAG is 5669.617652893066ms
2022-09-21 17:34:18 WARNING Skipping Multi-Query Optimization (instead, only applying patches)
2022-09-21 17:34:18 INFO  Estimated unoptimised what-if runtime is 29808.770656585693ms
2022-09-21 17:34:18 INFO  ---RUNTIME: Multi-Query Optimization took 0.42724609375 ms
2022-09-21 17:34:18 INFO  Executing generated plans
2022-09-21 17:34:49 INFO  ---RUNTIME: Execution took 30944.69952583313 ms
2022-09-21 17:34:49 INFO  Done!
2022-09-21 17:34:49 INFO  # Finished -- repetition 6 of 7 
2022-09-21 17:34:49 INFO  # Optimization benchmark for data_cleaning with args [['sneakers', 'slow_loading', 'image', 'image']] -- repetition 7 of 7
2022-09-21 17:34:49 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-21 17:34:49 INFO  Running instrumented original pipeline...
2022-09-21 17:34:49 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-21 17:34:49 INFO  ---RUNTIME: Importing and monkey-patching took 6.341218948364258 ms
2022-09-21 17:34:55 INFO  ---RUNTIME: Original pipeline execution took 5899.5115756988525 ms (excluding imports and monkey-patching)
2022-09-21 17:34:55 INFO  Starting execution of 1 what-if analyses...
2022-09-21 17:34:55 INFO  Start plan generation for analysis DataCleaning...
2022-09-21 17:34:55 INFO  ---RUNTIME: Plan generation took 0.08821487426757812 ms
2022-09-21 17:34:55 INFO  Estimated runtime of original DAG is 5637.044668197632ms
2022-09-21 17:34:55 INFO  Performing Multi-Query Optimization
2022-09-21 17:34:55 INFO  Estimated unoptimized what-if runtime is 29738.770961761475ms
2022-09-21 17:34:55 INFO  Estimated optimised what-if runtime is 27256.277561187744ms
2022-09-21 17:34:55 INFO  Estimated optimisation runtime saving is 2482.4934005737305ms
2022-09-21 17:34:55 INFO  ---RUNTIME: Multi-Query Optimization took 2.204418182373047 ms
2022-09-21 17:34:55 INFO  Executing generated plans
2022-09-21 17:35:23 INFO  ---RUNTIME: Execution took 28410.770893096924 ms
2022-09-21 17:35:23 INFO  Done!
2022-09-21 17:35:23 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-21 17:35:23 INFO  Running instrumented original pipeline...
2022-09-21 17:35:23 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-21 17:35:23 INFO  ---RUNTIME: Importing and monkey-patching took 6.474018096923828 ms
2022-09-21 17:35:30 INFO  ---RUNTIME: Original pipeline execution took 6655.271053314209 ms (excluding imports and monkey-patching)
2022-09-21 17:35:30 INFO  Starting execution of 1 what-if analyses...
2022-09-21 17:35:30 INFO  Start plan generation for analysis DataCleaning...
2022-09-21 17:35:30 INFO  ---RUNTIME: Plan generation took 0.08702278137207031 ms
2022-09-21 17:35:30 INFO  Estimated runtime of original DAG is 6397.79257774353ms
2022-09-21 17:35:30 WARNING Skipping Multi-Query Optimization (instead, only applying patches)
2022-09-21 17:35:30 INFO  Estimated unoptimised what-if runtime is 33669.52133178711ms
2022-09-21 17:35:30 INFO  ---RUNTIME: Multi-Query Optimization took 0.4374980926513672 ms
2022-09-21 17:35:30 INFO  Executing generated plans
2022-09-21 17:36:01 INFO  ---RUNTIME: Execution took 31118.743896484375 ms
2022-09-21 17:36:01 INFO  Done!
2022-09-21 17:36:01 INFO  # Finished -- repetition 7 of 7 
2022-09-21 17:36:01 INFO  # Final results after all repetitions
2022-09-21 17:36:01 INFO     repetition  ... no_opt_what_if_execution_combined_model_training
0           0  ...                                     24702.891827
1           1  ...                                     25232.896328
2           2  ...                                     25798.067093
3           3  ...                                     25762.239218
4           4  ...                                     25750.371456
5           5  ...                                     25774.304390
6           6  ...                                     25928.914070

[7 rows x 26 columns]
