Variant name from 1-8: 10
Cores to use: 64-71
taskset -c 64-71 PROTOCOL_BUFFERS_PYTHON_IMPLEMENTATION=python python3.9 benchmarks_end_to_end.py feature_importance folktables slow_loading featurization_0 logistic_regression
2022-09-21 18:43:38.705410: W tensorflow/stream_executor/platform/default/dso_loader.cc:64] Could not load dynamic library 'libcudart.so.11.0'; dlerror: libcudart.so.11.0: cannot open shared object file: No such file or directory; LD_LIBRARY_PATH: /home/sgrafbe/mlwhatif/venv/lib/python3.9/site-packages/cv2/../../lib64:
2022-09-21 18:43:38.705446: I tensorflow/stream_executor/cuda/cudart_stub.cc:29] Ignore above cudart dlerror if you do not have a GPU set up on your machine.
2022-09-21 18:43:39 INFO  Patching sys.argv with ['mlwhatif', 'folktables', 'slow_loading', 'featurization_0', 'logistic_regression']
2022-09-21 18:43:39 INFO  Running instrumented original pipeline...
2022-09-21 18:43:39 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-21 18:43:40 INFO  ---RUNTIME: Importing and monkey-patching took 96.9855785369873 ms
2022-09-21 18:43:41 INFO  ---RUNTIME: Original pipeline execution took 1907.189130783081 ms (excluding imports and monkey-patching)
2022-09-21 18:43:41 INFO  Starting execution of 0 what-if analyses...
2022-09-21 18:43:41 INFO  Estimated runtime of original DAG is 1481.5361499786377ms
2022-09-21 18:43:41 INFO  Performing Multi-Query Optimization
2022-09-21 18:43:41 INFO  Estimated unoptimized what-if runtime is 0ms
2022-09-21 18:43:41 INFO  Estimated optimised what-if runtime is 0ms
2022-09-21 18:43:41 INFO  Estimated optimisation runtime saving is 0ms
2022-09-21 18:43:41 INFO  ---RUNTIME: Multi-Query Optimization took 0.4200935363769531 ms
2022-09-21 18:43:41 INFO  Executing generated plans
2022-09-21 18:43:41 INFO  ---RUNTIME: Execution took 0.016927719116210938 ms
2022-09-21 18:43:41 INFO  Done!
2022-09-21 18:43:41 INFO  # Optimization benchmark for feature_importance with args [['folktables', 'slow_loading', 'featurization_0', 'logistic_regression']] -- repetition 1 of 7
2022-09-21 18:43:41 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-21 18:43:41 INFO  Running instrumented original pipeline...
2022-09-21 18:43:41 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-21 18:43:41 INFO  ---RUNTIME: Importing and monkey-patching took 5.148887634277344 ms
2022-09-21 18:43:43 INFO  ---RUNTIME: Original pipeline execution took 1701.566457748413 ms (excluding imports and monkey-patching)
2022-09-21 18:43:43 INFO  Starting execution of 1 what-if analyses...
2022-09-21 18:43:43 INFO  Start plan generation for analysis PermutationFeatureImportance...
2022-09-21 18:43:43 INFO  ---RUNTIME: Plan generation took 0.17690658569335938 ms
2022-09-21 18:43:43 INFO  Estimated runtime of original DAG is 1305.6635856628418ms
2022-09-21 18:43:43 INFO  Performing Multi-Query Optimization
2022-09-21 18:43:43 INFO  Estimated unoptimized what-if runtime is 10445.308685302734ms
2022-09-21 18:43:43 INFO  Estimated optimised what-if runtime is 1419.084072113037ms
2022-09-21 18:43:43 INFO  Estimated optimisation runtime saving is 9026.224613189697ms
2022-09-21 18:43:43 INFO  ---RUNTIME: Multi-Query Optimization took 14.274358749389648 ms
2022-09-21 18:43:43 INFO  Executing generated plans
2022-09-21 18:43:45 INFO  ---RUNTIME: Execution took 1539.5987033843994 ms
2022-09-21 18:43:45 INFO  Done!
2022-09-21 18:43:45 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-21 18:43:45 INFO  Running instrumented original pipeline...
2022-09-21 18:43:45 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-21 18:43:45 INFO  ---RUNTIME: Importing and monkey-patching took 5.546092987060547 ms
2022-09-21 18:43:47 INFO  ---RUNTIME: Original pipeline execution took 1944.8528289794922 ms (excluding imports and monkey-patching)
2022-09-21 18:43:47 INFO  Starting execution of 1 what-if analyses...
2022-09-21 18:43:47 INFO  Start plan generation for analysis PermutationFeatureImportance...
2022-09-21 18:43:47 INFO  ---RUNTIME: Plan generation took 0.11897087097167969 ms
2022-09-21 18:43:47 INFO  Estimated runtime of original DAG is 1405.3056240081787ms
2022-09-21 18:43:47 WARNING Skipping Multi-Query Optimization (instead, only applying patches)
2022-09-21 18:43:47 INFO  Estimated unoptimised what-if runtime is 11242.44499206543ms
2022-09-21 18:43:47 INFO  ---RUNTIME: Multi-Query Optimization took 4.891157150268555 ms
2022-09-21 18:43:47 INFO  Executing generated plans
2022-09-21 18:43:58 INFO  ---RUNTIME: Execution took 11315.274238586426 ms
2022-09-21 18:43:58 INFO  Done!
2022-09-21 18:43:58 INFO  # Finished -- repetition 1 of 7 
2022-09-21 18:43:58 INFO  # Optimization benchmark for feature_importance with args [['folktables', 'slow_loading', 'featurization_0', 'logistic_regression']] -- repetition 2 of 7
2022-09-21 18:43:58 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-21 18:43:58 INFO  Running instrumented original pipeline...
2022-09-21 18:43:58 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-21 18:43:58 INFO  ---RUNTIME: Importing and monkey-patching took 6.039619445800781 ms
2022-09-21 18:44:00 INFO  ---RUNTIME: Original pipeline execution took 1727.8385162353516 ms (excluding imports and monkey-patching)
2022-09-21 18:44:00 INFO  Starting execution of 1 what-if analyses...
2022-09-21 18:44:00 INFO  Start plan generation for analysis PermutationFeatureImportance...
2022-09-21 18:44:00 INFO  ---RUNTIME: Plan generation took 0.1590251922607422 ms
2022-09-21 18:44:00 INFO  Estimated runtime of original DAG is 1325.8190155029297ms
2022-09-21 18:44:00 INFO  Performing Multi-Query Optimization
2022-09-21 18:44:00 INFO  Estimated unoptimized what-if runtime is 10606.552124023438ms
2022-09-21 18:44:00 INFO  Estimated optimised what-if runtime is 1439.957857131958ms
2022-09-21 18:44:00 INFO  Estimated optimisation runtime saving is 9166.59426689148ms
2022-09-21 18:44:00 INFO  ---RUNTIME: Multi-Query Optimization took 14.203310012817383 ms
2022-09-21 18:44:00 INFO  Executing generated plans
2022-09-21 18:44:01 INFO  ---RUNTIME: Execution took 1548.661470413208 ms
2022-09-21 18:44:01 INFO  Done!
2022-09-21 18:44:01 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-21 18:44:01 INFO  Running instrumented original pipeline...
2022-09-21 18:44:01 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-21 18:44:01 INFO  ---RUNTIME: Importing and monkey-patching took 5.785465240478516 ms
2022-09-21 18:44:03 INFO  ---RUNTIME: Original pipeline execution took 1718.8265323638916 ms (excluding imports and monkey-patching)
2022-09-21 18:44:03 INFO  Starting execution of 1 what-if analyses...
2022-09-21 18:44:03 INFO  Start plan generation for analysis PermutationFeatureImportance...
2022-09-21 18:44:03 INFO  ---RUNTIME: Plan generation took 0.1201629638671875 ms
2022-09-21 18:44:03 INFO  Estimated runtime of original DAG is 1318.6841011047363ms
2022-09-21 18:44:03 WARNING Skipping Multi-Query Optimization (instead, only applying patches)
2022-09-21 18:44:03 INFO  Estimated unoptimised what-if runtime is 10549.47280883789ms
2022-09-21 18:44:03 INFO  ---RUNTIME: Multi-Query Optimization took 4.8828125 ms
2022-09-21 18:44:03 INFO  Executing generated plans
2022-09-21 18:44:14 INFO  ---RUNTIME: Execution took 11287.186861038208 ms
2022-09-21 18:44:14 INFO  Done!
2022-09-21 18:44:14 INFO  # Finished -- repetition 2 of 7 
2022-09-21 18:44:14 INFO  # Optimization benchmark for feature_importance with args [['folktables', 'slow_loading', 'featurization_0', 'logistic_regression']] -- repetition 3 of 7
2022-09-21 18:44:14 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-21 18:44:14 INFO  Running instrumented original pipeline...
2022-09-21 18:44:14 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-21 18:44:14 INFO  ---RUNTIME: Importing and monkey-patching took 5.816221237182617 ms
2022-09-21 18:44:16 INFO  ---RUNTIME: Original pipeline execution took 1720.7310199737549 ms (excluding imports and monkey-patching)
2022-09-21 18:44:16 INFO  Starting execution of 1 what-if analyses...
2022-09-21 18:44:16 INFO  Start plan generation for analysis PermutationFeatureImportance...
2022-09-21 18:44:16 INFO  ---RUNTIME: Plan generation took 0.13709068298339844 ms
2022-09-21 18:44:16 INFO  Estimated runtime of original DAG is 1317.6143169403076ms
2022-09-21 18:44:16 INFO  Performing Multi-Query Optimization
2022-09-21 18:44:16 INFO  Estimated unoptimized what-if runtime is 10540.914535522461ms
2022-09-21 18:44:16 INFO  Estimated optimised what-if runtime is 1433.2218170166016ms
2022-09-21 18:44:16 INFO  Estimated optimisation runtime saving is 9107.69271850586ms
2022-09-21 18:44:16 INFO  ---RUNTIME: Multi-Query Optimization took 15.347957611083984 ms
2022-09-21 18:44:16 INFO  Executing generated plans
2022-09-21 18:44:18 INFO  ---RUNTIME: Execution took 1554.6674728393555 ms
2022-09-21 18:44:18 INFO  Done!
2022-09-21 18:44:18 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-21 18:44:18 INFO  Running instrumented original pipeline...
2022-09-21 18:44:18 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-21 18:44:18 INFO  ---RUNTIME: Importing and monkey-patching took 5.71131706237793 ms
2022-09-21 18:44:19 INFO  ---RUNTIME: Original pipeline execution took 1738.555908203125 ms (excluding imports and monkey-patching)
2022-09-21 18:44:19 INFO  Starting execution of 1 what-if analyses...
2022-09-21 18:44:19 INFO  Start plan generation for analysis PermutationFeatureImportance...
2022-09-21 18:44:19 INFO  ---RUNTIME: Plan generation took 0.1289844512939453 ms
2022-09-21 18:44:19 INFO  Estimated runtime of original DAG is 1340.818166732788ms
2022-09-21 18:44:19 WARNING Skipping Multi-Query Optimization (instead, only applying patches)
2022-09-21 18:44:19 INFO  Estimated unoptimised what-if runtime is 10726.545333862305ms
2022-09-21 18:44:19 INFO  ---RUNTIME: Multi-Query Optimization took 4.797697067260742 ms
2022-09-21 18:44:19 INFO  Executing generated plans
2022-09-21 18:44:31 INFO  ---RUNTIME: Execution took 11466.894149780273 ms
2022-09-21 18:44:31 INFO  Done!
2022-09-21 18:44:31 INFO  # Finished -- repetition 3 of 7 
2022-09-21 18:44:31 INFO  # Optimization benchmark for feature_importance with args [['folktables', 'slow_loading', 'featurization_0', 'logistic_regression']] -- repetition 4 of 7
2022-09-21 18:44:31 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-21 18:44:31 INFO  Running instrumented original pipeline...
2022-09-21 18:44:31 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-21 18:44:31 INFO  ---RUNTIME: Importing and monkey-patching took 16.878366470336914 ms
2022-09-21 18:44:33 INFO  ---RUNTIME: Original pipeline execution took 1813.7423992156982 ms (excluding imports and monkey-patching)
2022-09-21 18:44:33 INFO  Starting execution of 1 what-if analyses...
2022-09-21 18:44:33 INFO  Start plan generation for analysis PermutationFeatureImportance...
2022-09-21 18:44:33 INFO  ---RUNTIME: Plan generation took 0.141143798828125 ms
2022-09-21 18:44:33 INFO  Estimated runtime of original DAG is 1359.0636253356934ms
2022-09-21 18:44:33 INFO  Performing Multi-Query Optimization
2022-09-21 18:44:33 INFO  Estimated unoptimized what-if runtime is 10872.509002685547ms
2022-09-21 18:44:33 INFO  Estimated optimised what-if runtime is 1477.8037071228027ms
2022-09-21 18:44:33 INFO  Estimated optimisation runtime saving is 9394.705295562744ms
2022-09-21 18:44:33 INFO  ---RUNTIME: Multi-Query Optimization took 14.094352722167969 ms
2022-09-21 18:44:33 INFO  Executing generated plans
2022-09-21 18:44:34 INFO  ---RUNTIME: Execution took 1571.3095664978027 ms
2022-09-21 18:44:34 INFO  Done!
2022-09-21 18:44:34 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-21 18:44:34 INFO  Running instrumented original pipeline...
2022-09-21 18:44:34 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-21 18:44:34 INFO  ---RUNTIME: Importing and monkey-patching took 5.499124526977539 ms
2022-09-21 18:44:36 INFO  ---RUNTIME: Original pipeline execution took 1763.6220455169678 ms (excluding imports and monkey-patching)
2022-09-21 18:44:36 INFO  Starting execution of 1 what-if analyses...
2022-09-21 18:44:36 INFO  Start plan generation for analysis PermutationFeatureImportance...
2022-09-21 18:44:36 INFO  ---RUNTIME: Plan generation took 0.13589859008789062 ms
2022-09-21 18:44:36 INFO  Estimated runtime of original DAG is 1323.3320713043213ms
2022-09-21 18:44:36 WARNING Skipping Multi-Query Optimization (instead, only applying patches)
2022-09-21 18:44:36 INFO  Estimated unoptimised what-if runtime is 10586.65657043457ms
2022-09-21 18:44:36 INFO  ---RUNTIME: Multi-Query Optimization took 4.8274993896484375 ms
2022-09-21 18:44:36 INFO  Executing generated plans
2022-09-21 18:44:48 INFO  ---RUNTIME: Execution took 11817.551851272583 ms
2022-09-21 18:44:48 INFO  Done!
2022-09-21 18:44:48 INFO  # Finished -- repetition 4 of 7 
2022-09-21 18:44:48 INFO  # Optimization benchmark for feature_importance with args [['folktables', 'slow_loading', 'featurization_0', 'logistic_regression']] -- repetition 5 of 7
2022-09-21 18:44:48 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-21 18:44:48 INFO  Running instrumented original pipeline...
2022-09-21 18:44:48 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-21 18:44:48 INFO  ---RUNTIME: Importing and monkey-patching took 6.377935409545898 ms
2022-09-21 18:44:50 INFO  ---RUNTIME: Original pipeline execution took 1999.427318572998 ms (excluding imports and monkey-patching)
2022-09-21 18:44:50 INFO  Starting execution of 1 what-if analyses...
2022-09-21 18:44:50 INFO  Start plan generation for analysis PermutationFeatureImportance...
2022-09-21 18:44:50 INFO  ---RUNTIME: Plan generation took 0.12469291687011719 ms
2022-09-21 18:44:50 INFO  Estimated runtime of original DAG is 1382.793664932251ms
2022-09-21 18:44:50 INFO  Performing Multi-Query Optimization
2022-09-21 18:44:50 INFO  Estimated unoptimized what-if runtime is 11062.349319458008ms
2022-09-21 18:44:50 INFO  Estimated optimised what-if runtime is 1511.0907554626465ms
2022-09-21 18:44:50 INFO  Estimated optimisation runtime saving is 9551.258563995361ms
2022-09-21 18:44:50 INFO  ---RUNTIME: Multi-Query Optimization took 13.88239860534668 ms
2022-09-21 18:44:50 INFO  Executing generated plans
2022-09-21 18:44:51 INFO  ---RUNTIME: Execution took 1584.1951370239258 ms
2022-09-21 18:44:51 INFO  Done!
2022-09-21 18:44:51 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-21 18:44:51 INFO  Running instrumented original pipeline...
2022-09-21 18:44:51 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-21 18:44:51 INFO  ---RUNTIME: Importing and monkey-patching took 5.481958389282227 ms
2022-09-21 18:44:53 INFO  ---RUNTIME: Original pipeline execution took 1757.380485534668 ms (excluding imports and monkey-patching)
2022-09-21 18:44:53 INFO  Starting execution of 1 what-if analyses...
2022-09-21 18:44:53 INFO  Start plan generation for analysis PermutationFeatureImportance...
2022-09-21 18:44:53 INFO  ---RUNTIME: Plan generation took 0.11873245239257812 ms
2022-09-21 18:44:53 INFO  Estimated runtime of original DAG is 1360.719919204712ms
2022-09-21 18:44:53 WARNING Skipping Multi-Query Optimization (instead, only applying patches)
2022-09-21 18:44:53 INFO  Estimated unoptimised what-if runtime is 10885.759353637695ms
2022-09-21 18:44:53 INFO  ---RUNTIME: Multi-Query Optimization took 4.760980606079102 ms
2022-09-21 18:44:53 INFO  Executing generated plans
2022-09-21 18:45:05 INFO  ---RUNTIME: Execution took 11666.030645370483 ms
2022-09-21 18:45:05 INFO  Done!
2022-09-21 18:45:05 INFO  # Finished -- repetition 5 of 7 
2022-09-21 18:45:05 INFO  # Optimization benchmark for feature_importance with args [['folktables', 'slow_loading', 'featurization_0', 'logistic_regression']] -- repetition 6 of 7
2022-09-21 18:45:05 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-21 18:45:05 INFO  Running instrumented original pipeline...
2022-09-21 18:45:05 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-21 18:45:05 INFO  ---RUNTIME: Importing and monkey-patching took 16.062021255493164 ms
2022-09-21 18:45:07 INFO  ---RUNTIME: Original pipeline execution took 1790.513277053833 ms (excluding imports and monkey-patching)
2022-09-21 18:45:07 INFO  Starting execution of 1 what-if analyses...
2022-09-21 18:45:07 INFO  Start plan generation for analysis PermutationFeatureImportance...
2022-09-21 18:45:07 INFO  ---RUNTIME: Plan generation took 0.133514404296875 ms
2022-09-21 18:45:07 INFO  Estimated runtime of original DAG is 1350.970983505249ms
2022-09-21 18:45:07 INFO  Performing Multi-Query Optimization
2022-09-21 18:45:07 INFO  Estimated unoptimized what-if runtime is 10807.767868041992ms
2022-09-21 18:45:07 INFO  Estimated optimised what-if runtime is 1470.2208042144775ms
2022-09-21 18:45:07 INFO  Estimated optimisation runtime saving is 9337.547063827515ms
2022-09-21 18:45:07 INFO  ---RUNTIME: Multi-Query Optimization took 24.376630783081055 ms
2022-09-21 18:45:07 INFO  Executing generated plans
2022-09-21 18:45:08 INFO  ---RUNTIME: Execution took 1625.5927085876465 ms
2022-09-21 18:45:08 INFO  Done!
2022-09-21 18:45:08 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-21 18:45:08 INFO  Running instrumented original pipeline...
2022-09-21 18:45:08 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-21 18:45:08 INFO  ---RUNTIME: Importing and monkey-patching took 5.51605224609375 ms
2022-09-21 18:45:11 INFO  ---RUNTIME: Original pipeline execution took 2221.9536304473877 ms (excluding imports and monkey-patching)
2022-09-21 18:45:11 INFO  Starting execution of 1 what-if analyses...
2022-09-21 18:45:11 INFO  Start plan generation for analysis PermutationFeatureImportance...
2022-09-21 18:45:11 INFO  ---RUNTIME: Plan generation took 0.148773193359375 ms
2022-09-21 18:45:11 INFO  Estimated runtime of original DAG is 1777.1227359771729ms
2022-09-21 18:45:11 WARNING Skipping Multi-Query Optimization (instead, only applying patches)
2022-09-21 18:45:11 INFO  Estimated unoptimised what-if runtime is 14216.981887817383ms
2022-09-21 18:45:11 INFO  ---RUNTIME: Multi-Query Optimization took 4.794836044311523 ms
2022-09-21 18:45:11 INFO  Executing generated plans
2022-09-21 18:45:25 INFO  ---RUNTIME: Execution took 14239.027500152588 ms
2022-09-21 18:45:25 INFO  Done!
2022-09-21 18:45:25 INFO  # Finished -- repetition 6 of 7 
2022-09-21 18:45:25 INFO  # Optimization benchmark for feature_importance with args [['folktables', 'slow_loading', 'featurization_0', 'logistic_regression']] -- repetition 7 of 7
2022-09-21 18:45:25 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-21 18:45:25 INFO  Running instrumented original pipeline...
2022-09-21 18:45:25 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-21 18:45:25 INFO  ---RUNTIME: Importing and monkey-patching took 8.10384750366211 ms
2022-09-21 18:45:27 INFO  ---RUNTIME: Original pipeline execution took 2326.8916606903076 ms (excluding imports and monkey-patching)
2022-09-21 18:45:27 INFO  Starting execution of 1 what-if analyses...
2022-09-21 18:45:27 INFO  Start plan generation for analysis PermutationFeatureImportance...
2022-09-21 18:45:27 INFO  ---RUNTIME: Plan generation took 0.18739700317382812 ms
2022-09-21 18:45:27 INFO  Estimated runtime of original DAG is 1719.9444770812988ms
2022-09-21 18:45:27 INFO  Performing Multi-Query Optimization
2022-09-21 18:45:27 INFO  Estimated unoptimized what-if runtime is 13759.55581665039ms
2022-09-21 18:45:27 INFO  Estimated optimised what-if runtime is 1868.1602478027344ms
2022-09-21 18:45:27 INFO  Estimated optimisation runtime saving is 11891.395568847656ms
2022-09-21 18:45:27 INFO  ---RUNTIME: Multi-Query Optimization took 20.100831985473633 ms
2022-09-21 18:45:27 INFO  Executing generated plans
2022-09-21 18:45:29 INFO  ---RUNTIME: Execution took 1924.4036674499512 ms
2022-09-21 18:45:29 INFO  Done!
2022-09-21 18:45:29 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-21 18:45:29 INFO  Running instrumented original pipeline...
2022-09-21 18:45:29 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-21 18:45:29 INFO  ---RUNTIME: Importing and monkey-patching took 5.536079406738281 ms
2022-09-21 18:45:31 INFO  ---RUNTIME: Original pipeline execution took 2117.2027587890625 ms (excluding imports and monkey-patching)
2022-09-21 18:45:31 INFO  Starting execution of 1 what-if analyses...
2022-09-21 18:45:31 INFO  Start plan generation for analysis PermutationFeatureImportance...
2022-09-21 18:45:31 INFO  ---RUNTIME: Plan generation took 0.14638900756835938 ms
2022-09-21 18:45:31 INFO  Estimated runtime of original DAG is 1600.1992225646973ms
2022-09-21 18:45:31 WARNING Skipping Multi-Query Optimization (instead, only applying patches)
2022-09-21 18:45:31 INFO  Estimated unoptimised what-if runtime is 12801.593780517578ms
2022-09-21 18:45:31 INFO  ---RUNTIME: Multi-Query Optimization took 5.9356689453125 ms
2022-09-21 18:45:31 INFO  Executing generated plans
2022-09-21 18:45:45 INFO  ---RUNTIME: Execution took 14070.791006088257 ms
2022-09-21 18:45:45 INFO  Done!
2022-09-21 18:45:45 INFO  # Finished -- repetition 7 of 7 
2022-09-21 18:45:45 INFO  # Final results after all repetitions
2022-09-21 18:45:45 INFO     repetition  ... no_opt_what_if_execution_combined_model_training
0           0  ...                                      8830.482483
1           1  ...                                      8826.941967
2           2  ...                                      8931.303263
3           3  ...                                      9178.688765
4           4  ...                                      9150.647879
5           5  ...                                     11298.950911
6           6  ...                                     10882.418394

[7 rows x 26 columns]
taskset -c 64-71 PROTOCOL_BUFFERS_PYTHON_IMPLEMENTATION=python python3.9 benchmarks_end_to_end.py feature_importance folktables slow_loading featurization_0 xgboost
2022-09-21 18:45:48.280347: W tensorflow/stream_executor/platform/default/dso_loader.cc:64] Could not load dynamic library 'libcudart.so.11.0'; dlerror: libcudart.so.11.0: cannot open shared object file: No such file or directory; LD_LIBRARY_PATH: /home/sgrafbe/mlwhatif/venv/lib/python3.9/site-packages/cv2/../../lib64:
2022-09-21 18:45:48.280384: I tensorflow/stream_executor/cuda/cudart_stub.cc:29] Ignore above cudart dlerror if you do not have a GPU set up on your machine.
2022-09-21 18:45:49 INFO  Patching sys.argv with ['mlwhatif', 'folktables', 'slow_loading', 'featurization_0', 'xgboost']
2022-09-21 18:45:49 INFO  Running instrumented original pipeline...
2022-09-21 18:45:49 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-21 18:45:49 INFO  ---RUNTIME: Importing and monkey-patching took 95.25299072265625 ms
2022-09-21 18:45:52 INFO  ---RUNTIME: Original pipeline execution took 2102.2298336029053 ms (excluding imports and monkey-patching)
2022-09-21 18:45:52 INFO  Starting execution of 0 what-if analyses...
2022-09-21 18:45:52 INFO  Estimated runtime of original DAG is 1527.5635719299316ms
2022-09-21 18:45:52 INFO  Performing Multi-Query Optimization
2022-09-21 18:45:52 INFO  Estimated unoptimized what-if runtime is 0ms
2022-09-21 18:45:52 INFO  Estimated optimised what-if runtime is 0ms
2022-09-21 18:45:52 INFO  Estimated optimisation runtime saving is 0ms
2022-09-21 18:45:52 INFO  ---RUNTIME: Multi-Query Optimization took 0.6442070007324219 ms
2022-09-21 18:45:52 INFO  Executing generated plans
2022-09-21 18:45:52 INFO  ---RUNTIME: Execution took 0.020742416381835938 ms
2022-09-21 18:45:52 INFO  Done!
2022-09-21 18:45:52 INFO  # Optimization benchmark for feature_importance with args [['folktables', 'slow_loading', 'featurization_0', 'xgboost']] -- repetition 1 of 7
2022-09-21 18:45:52 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-21 18:45:52 INFO  Running instrumented original pipeline...
2022-09-21 18:45:52 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-21 18:45:52 INFO  ---RUNTIME: Importing and monkey-patching took 9.959220886230469 ms
2022-09-21 18:45:54 INFO  ---RUNTIME: Original pipeline execution took 2101.2094020843506 ms (excluding imports and monkey-patching)
2022-09-21 18:45:54 INFO  Starting execution of 1 what-if analyses...
2022-09-21 18:45:54 INFO  Start plan generation for analysis PermutationFeatureImportance...
2022-09-21 18:45:54 INFO  ---RUNTIME: Plan generation took 0.29921531677246094 ms
2022-09-21 18:45:54 INFO  Estimated runtime of original DAG is 1536.541223526001ms
2022-09-21 18:45:54 INFO  Performing Multi-Query Optimization
2022-09-21 18:45:54 INFO  Estimated unoptimized what-if runtime is 12292.329788208008ms
2022-09-21 18:45:54 INFO  Estimated optimised what-if runtime is 1794.3310737609863ms
2022-09-21 18:45:54 INFO  Estimated optimisation runtime saving is 10497.998714447021ms
2022-09-21 18:45:54 INFO  ---RUNTIME: Multi-Query Optimization took 21.371126174926758 ms
2022-09-21 18:45:54 INFO  Executing generated plans
2022-09-21 18:45:56 INFO  ---RUNTIME: Execution took 1885.1923942565918 ms
2022-09-21 18:45:56 INFO  Done!
2022-09-21 18:45:56 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-21 18:45:56 INFO  Running instrumented original pipeline...
2022-09-21 18:45:56 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-21 18:45:56 INFO  ---RUNTIME: Importing and monkey-patching took 7.418632507324219 ms
2022-09-21 18:45:58 INFO  ---RUNTIME: Original pipeline execution took 2370.774984359741 ms (excluding imports and monkey-patching)
2022-09-21 18:45:58 INFO  Starting execution of 1 what-if analyses...
2022-09-21 18:45:58 INFO  Start plan generation for analysis PermutationFeatureImportance...
2022-09-21 18:45:58 INFO  ---RUNTIME: Plan generation took 0.171661376953125 ms
2022-09-21 18:45:58 INFO  Estimated runtime of original DAG is 1587.357521057129ms
2022-09-21 18:45:58 WARNING Skipping Multi-Query Optimization (instead, only applying patches)
2022-09-21 18:45:58 INFO  Estimated unoptimised what-if runtime is 12698.860168457031ms
2022-09-21 18:45:58 INFO  ---RUNTIME: Multi-Query Optimization took 6.923675537109375 ms
2022-09-21 18:45:58 INFO  Executing generated plans
2022-09-21 18:46:10 INFO  ---RUNTIME: Execution took 11666.671752929688 ms
2022-09-21 18:46:10 INFO  Done!
2022-09-21 18:46:10 INFO  # Finished -- repetition 1 of 7 
2022-09-21 18:46:10 INFO  # Optimization benchmark for feature_importance with args [['folktables', 'slow_loading', 'featurization_0', 'xgboost']] -- repetition 2 of 7
2022-09-21 18:46:10 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-21 18:46:10 INFO  Running instrumented original pipeline...
2022-09-21 18:46:10 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-21 18:46:10 INFO  ---RUNTIME: Importing and monkey-patching took 7.566213607788086 ms
2022-09-21 18:46:11 INFO  ---RUNTIME: Original pipeline execution took 1785.2296829223633 ms (excluding imports and monkey-patching)
2022-09-21 18:46:11 INFO  Starting execution of 1 what-if analyses...
2022-09-21 18:46:11 INFO  Start plan generation for analysis PermutationFeatureImportance...
2022-09-21 18:46:11 INFO  ---RUNTIME: Plan generation took 0.14400482177734375 ms
2022-09-21 18:46:11 INFO  Estimated runtime of original DAG is 1380.767822265625ms
2022-09-21 18:46:11 INFO  Performing Multi-Query Optimization
2022-09-21 18:46:11 INFO  Estimated unoptimized what-if runtime is 11046.142578125ms
2022-09-21 18:46:11 INFO  Estimated optimised what-if runtime is 1591.339111328125ms
2022-09-21 18:46:11 INFO  Estimated optimisation runtime saving is 9454.803466796875ms
2022-09-21 18:46:11 INFO  ---RUNTIME: Multi-Query Optimization took 13.816595077514648 ms
2022-09-21 18:46:11 INFO  Executing generated plans
2022-09-21 18:46:13 INFO  ---RUNTIME: Execution took 1598.802089691162 ms
2022-09-21 18:46:13 INFO  Done!
2022-09-21 18:46:13 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-21 18:46:13 INFO  Running instrumented original pipeline...
2022-09-21 18:46:13 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-21 18:46:13 INFO  ---RUNTIME: Importing and monkey-patching took 5.736589431762695 ms
2022-09-21 18:46:15 INFO  ---RUNTIME: Original pipeline execution took 1780.5109024047852 ms (excluding imports and monkey-patching)
2022-09-21 18:46:15 INFO  Starting execution of 1 what-if analyses...
2022-09-21 18:46:15 INFO  Start plan generation for analysis PermutationFeatureImportance...
2022-09-21 18:46:15 INFO  ---RUNTIME: Plan generation took 0.12540817260742188 ms
2022-09-21 18:46:15 INFO  Estimated runtime of original DAG is 1368.8690662384033ms
2022-09-21 18:46:15 WARNING Skipping Multi-Query Optimization (instead, only applying patches)
2022-09-21 18:46:15 INFO  Estimated unoptimised what-if runtime is 10950.952529907227ms
2022-09-21 18:46:15 INFO  ---RUNTIME: Multi-Query Optimization took 4.693031311035156 ms
2022-09-21 18:46:15 INFO  Executing generated plans
2022-09-21 18:46:26 INFO  ---RUNTIME: Execution took 11288.755893707275 ms
2022-09-21 18:46:26 INFO  Done!
2022-09-21 18:46:26 INFO  # Finished -- repetition 2 of 7 
2022-09-21 18:46:26 INFO  # Optimization benchmark for feature_importance with args [['folktables', 'slow_loading', 'featurization_0', 'xgboost']] -- repetition 3 of 7
2022-09-21 18:46:26 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-21 18:46:26 INFO  Running instrumented original pipeline...
2022-09-21 18:46:26 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-21 18:46:26 INFO  ---RUNTIME: Importing and monkey-patching took 6.918430328369141 ms
2022-09-21 18:46:28 INFO  ---RUNTIME: Original pipeline execution took 1688.5550022125244 ms (excluding imports and monkey-patching)
2022-09-21 18:46:28 INFO  Starting execution of 1 what-if analyses...
2022-09-21 18:46:28 INFO  Start plan generation for analysis PermutationFeatureImportance...
2022-09-21 18:46:28 INFO  ---RUNTIME: Plan generation took 0.1468658447265625 ms
2022-09-21 18:46:28 INFO  Estimated runtime of original DAG is 1290.8895015716553ms
2022-09-21 18:46:28 INFO  Performing Multi-Query Optimization
2022-09-21 18:46:28 INFO  Estimated unoptimized what-if runtime is 10327.116012573242ms
2022-09-21 18:46:28 INFO  Estimated optimised what-if runtime is 1486.7596626281738ms
2022-09-21 18:46:28 INFO  Estimated optimisation runtime saving is 8840.356349945068ms
2022-09-21 18:46:28 INFO  ---RUNTIME: Multi-Query Optimization took 13.992786407470703 ms
2022-09-21 18:46:28 INFO  Executing generated plans
2022-09-21 18:46:29 INFO  ---RUNTIME: Execution took 1552.7307987213135 ms
2022-09-21 18:46:29 INFO  Done!
2022-09-21 18:46:29 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-21 18:46:29 INFO  Running instrumented original pipeline...
2022-09-21 18:46:29 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-21 18:46:29 INFO  ---RUNTIME: Importing and monkey-patching took 5.977392196655273 ms
2022-09-21 18:46:31 INFO  ---RUNTIME: Original pipeline execution took 1635.6477737426758 ms (excluding imports and monkey-patching)
2022-09-21 18:46:31 INFO  Starting execution of 1 what-if analyses...
2022-09-21 18:46:31 INFO  Start plan generation for analysis PermutationFeatureImportance...
2022-09-21 18:46:31 INFO  ---RUNTIME: Plan generation took 0.1385211944580078 ms
2022-09-21 18:46:31 INFO  Estimated runtime of original DAG is 1233.1538200378418ms
2022-09-21 18:46:31 WARNING Skipping Multi-Query Optimization (instead, only applying patches)
2022-09-21 18:46:31 INFO  Estimated unoptimised what-if runtime is 9865.230560302734ms
2022-09-21 18:46:31 INFO  ---RUNTIME: Multi-Query Optimization took 5.304098129272461 ms
2022-09-21 18:46:31 INFO  Executing generated plans
2022-09-21 18:46:42 INFO  ---RUNTIME: Execution took 11246.848821640015 ms
2022-09-21 18:46:42 INFO  Done!
2022-09-21 18:46:42 INFO  # Finished -- repetition 3 of 7 
2022-09-21 18:46:42 INFO  # Optimization benchmark for feature_importance with args [['folktables', 'slow_loading', 'featurization_0', 'xgboost']] -- repetition 4 of 7
2022-09-21 18:46:42 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-21 18:46:42 INFO  Running instrumented original pipeline...
2022-09-21 18:46:42 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-21 18:46:42 INFO  ---RUNTIME: Importing and monkey-patching took 5.845785140991211 ms
2022-09-21 18:46:44 INFO  ---RUNTIME: Original pipeline execution took 1668.940782546997 ms (excluding imports and monkey-patching)
2022-09-21 18:46:44 INFO  Starting execution of 1 what-if analyses...
2022-09-21 18:46:44 INFO  Start plan generation for analysis PermutationFeatureImportance...
2022-09-21 18:46:44 INFO  ---RUNTIME: Plan generation took 0.14209747314453125 ms
2022-09-21 18:46:44 INFO  Estimated runtime of original DAG is 1250.356912612915ms
2022-09-21 18:46:44 INFO  Performing Multi-Query Optimization
2022-09-21 18:46:44 INFO  Estimated unoptimized what-if runtime is 10002.85530090332ms
2022-09-21 18:46:44 INFO  Estimated optimised what-if runtime is 1450.4051208496094ms
2022-09-21 18:46:44 INFO  Estimated optimisation runtime saving is 8552.450180053711ms
2022-09-21 18:46:44 INFO  ---RUNTIME: Multi-Query Optimization took 15.012979507446289 ms
2022-09-21 18:46:44 INFO  Executing generated plans
2022-09-21 18:46:46 INFO  ---RUNTIME: Execution took 1635.5764865875244 ms
2022-09-21 18:46:46 INFO  Done!
2022-09-21 18:46:46 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-21 18:46:46 INFO  Running instrumented original pipeline...
2022-09-21 18:46:46 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-21 18:46:46 INFO  ---RUNTIME: Importing and monkey-patching took 5.607128143310547 ms
2022-09-21 18:46:47 INFO  ---RUNTIME: Original pipeline execution took 1667.1507358551025 ms (excluding imports and monkey-patching)
2022-09-21 18:46:47 INFO  Starting execution of 1 what-if analyses...
2022-09-21 18:46:47 INFO  Start plan generation for analysis PermutationFeatureImportance...
2022-09-21 18:46:47 INFO  ---RUNTIME: Plan generation took 0.1323223114013672 ms
2022-09-21 18:46:47 INFO  Estimated runtime of original DAG is 1272.2196578979492ms
2022-09-21 18:46:47 WARNING Skipping Multi-Query Optimization (instead, only applying patches)
2022-09-21 18:46:47 INFO  Estimated unoptimised what-if runtime is 10177.757263183594ms
2022-09-21 18:46:47 INFO  ---RUNTIME: Multi-Query Optimization took 4.685163497924805 ms
2022-09-21 18:46:47 INFO  Executing generated plans
2022-09-21 18:46:59 INFO  ---RUNTIME: Execution took 11277.095317840576 ms
2022-09-21 18:46:59 INFO  Done!
2022-09-21 18:46:59 INFO  # Finished -- repetition 4 of 7 
2022-09-21 18:46:59 INFO  # Optimization benchmark for feature_importance with args [['folktables', 'slow_loading', 'featurization_0', 'xgboost']] -- repetition 5 of 7
2022-09-21 18:46:59 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-21 18:46:59 INFO  Running instrumented original pipeline...
2022-09-21 18:46:59 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-21 18:46:59 INFO  ---RUNTIME: Importing and monkey-patching took 7.071495056152344 ms
2022-09-21 18:47:00 INFO  ---RUNTIME: Original pipeline execution took 1883.0277919769287 ms (excluding imports and monkey-patching)
2022-09-21 18:47:00 INFO  Starting execution of 1 what-if analyses...
2022-09-21 18:47:00 INFO  Start plan generation for analysis PermutationFeatureImportance...
2022-09-21 18:47:00 INFO  ---RUNTIME: Plan generation took 0.1480579376220703 ms
2022-09-21 18:47:00 INFO  Estimated runtime of original DAG is 1267.928123474121ms
2022-09-21 18:47:00 INFO  Performing Multi-Query Optimization
2022-09-21 18:47:00 INFO  Estimated unoptimized what-if runtime is 10143.424987792969ms
2022-09-21 18:47:00 INFO  Estimated optimised what-if runtime is 1472.999095916748ms
2022-09-21 18:47:00 INFO  Estimated optimisation runtime saving is 8670.42589187622ms
2022-09-21 18:47:00 INFO  ---RUNTIME: Multi-Query Optimization took 16.21389389038086 ms
2022-09-21 18:47:00 INFO  Executing generated plans
2022-09-21 18:47:02 INFO  ---RUNTIME: Execution took 1533.5841178894043 ms
2022-09-21 18:47:02 INFO  Done!
2022-09-21 18:47:02 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-21 18:47:02 INFO  Running instrumented original pipeline...
2022-09-21 18:47:02 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-21 18:47:02 INFO  ---RUNTIME: Importing and monkey-patching took 6.389379501342773 ms
2022-09-21 18:47:04 INFO  ---RUNTIME: Original pipeline execution took 1759.6824169158936 ms (excluding imports and monkey-patching)
2022-09-21 18:47:04 INFO  Starting execution of 1 what-if analyses...
2022-09-21 18:47:04 INFO  Start plan generation for analysis PermutationFeatureImportance...
2022-09-21 18:47:04 INFO  ---RUNTIME: Plan generation took 0.13256072998046875 ms
2022-09-21 18:47:04 INFO  Estimated runtime of original DAG is 1353.9273738861084ms
2022-09-21 18:47:04 WARNING Skipping Multi-Query Optimization (instead, only applying patches)
2022-09-21 18:47:04 INFO  Estimated unoptimised what-if runtime is 10831.418991088867ms
2022-09-21 18:47:04 INFO  ---RUNTIME: Multi-Query Optimization took 5.020380020141602 ms
2022-09-21 18:47:04 INFO  Executing generated plans
2022-09-21 18:47:15 INFO  ---RUNTIME: Execution took 11162.198543548584 ms
2022-09-21 18:47:15 INFO  Done!
2022-09-21 18:47:15 INFO  # Finished -- repetition 5 of 7 
2022-09-21 18:47:15 INFO  # Optimization benchmark for feature_importance with args [['folktables', 'slow_loading', 'featurization_0', 'xgboost']] -- repetition 6 of 7
2022-09-21 18:47:15 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-21 18:47:15 INFO  Running instrumented original pipeline...
2022-09-21 18:47:15 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-21 18:47:15 INFO  ---RUNTIME: Importing and monkey-patching took 5.839824676513672 ms
2022-09-21 18:47:17 INFO  ---RUNTIME: Original pipeline execution took 1715.8350944519043 ms (excluding imports and monkey-patching)
2022-09-21 18:47:17 INFO  Starting execution of 1 what-if analyses...
2022-09-21 18:47:17 INFO  Start plan generation for analysis PermutationFeatureImportance...
2022-09-21 18:47:17 INFO  ---RUNTIME: Plan generation took 0.11682510375976562 ms
2022-09-21 18:47:17 INFO  Estimated runtime of original DAG is 1308.7210655212402ms
2022-09-21 18:47:17 INFO  Performing Multi-Query Optimization
2022-09-21 18:47:17 INFO  Estimated unoptimized what-if runtime is 10469.768524169922ms
2022-09-21 18:47:17 INFO  Estimated optimised what-if runtime is 1515.2819156646729ms
2022-09-21 18:47:17 INFO  Estimated optimisation runtime saving is 8954.486608505249ms
2022-09-21 18:47:17 INFO  ---RUNTIME: Multi-Query Optimization took 13.63992691040039 ms
2022-09-21 18:47:17 INFO  Executing generated plans
2022-09-21 18:47:18 INFO  ---RUNTIME: Execution took 1547.1642017364502 ms
2022-09-21 18:47:18 INFO  Done!
2022-09-21 18:47:18 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-21 18:47:18 INFO  Running instrumented original pipeline...
2022-09-21 18:47:18 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-21 18:47:18 INFO  ---RUNTIME: Importing and monkey-patching took 6.308317184448242 ms
2022-09-21 18:47:20 INFO  ---RUNTIME: Original pipeline execution took 1792.243242263794 ms (excluding imports and monkey-patching)
2022-09-21 18:47:20 INFO  Starting execution of 1 what-if analyses...
2022-09-21 18:47:20 INFO  Start plan generation for analysis PermutationFeatureImportance...
2022-09-21 18:47:20 INFO  ---RUNTIME: Plan generation took 0.1163482666015625 ms
2022-09-21 18:47:20 INFO  Estimated runtime of original DAG is 1377.6602745056152ms
2022-09-21 18:47:20 WARNING Skipping Multi-Query Optimization (instead, only applying patches)
2022-09-21 18:47:20 INFO  Estimated unoptimised what-if runtime is 11021.282196044922ms
2022-09-21 18:47:20 INFO  ---RUNTIME: Multi-Query Optimization took 4.709482192993164 ms
2022-09-21 18:47:20 INFO  Executing generated plans
2022-09-21 18:47:31 INFO  ---RUNTIME: Execution took 11329.036712646484 ms
2022-09-21 18:47:31 INFO  Done!
2022-09-21 18:47:31 INFO  # Finished -- repetition 6 of 7 
2022-09-21 18:47:31 INFO  # Optimization benchmark for feature_importance with args [['folktables', 'slow_loading', 'featurization_0', 'xgboost']] -- repetition 7 of 7
2022-09-21 18:47:31 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-21 18:47:31 INFO  Running instrumented original pipeline...
2022-09-21 18:47:31 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-21 18:47:31 INFO  ---RUNTIME: Importing and monkey-patching took 5.981922149658203 ms
2022-09-21 18:47:33 INFO  ---RUNTIME: Original pipeline execution took 1720.630407333374 ms (excluding imports and monkey-patching)
2022-09-21 18:47:33 INFO  Starting execution of 1 what-if analyses...
2022-09-21 18:47:33 INFO  Start plan generation for analysis PermutationFeatureImportance...
2022-09-21 18:47:33 INFO  ---RUNTIME: Plan generation took 0.12946128845214844 ms
2022-09-21 18:47:33 INFO  Estimated runtime of original DAG is 1321.8739032745361ms
2022-09-21 18:47:33 INFO  Performing Multi-Query Optimization
2022-09-21 18:47:33 INFO  Estimated unoptimized what-if runtime is 10574.991226196289ms
2022-09-21 18:47:33 INFO  Estimated optimised what-if runtime is 1520.0629234313965ms
2022-09-21 18:47:33 INFO  Estimated optimisation runtime saving is 9054.928302764893ms
2022-09-21 18:47:33 INFO  ---RUNTIME: Multi-Query Optimization took 14.633893966674805 ms
2022-09-21 18:47:33 INFO  Executing generated plans
2022-09-21 18:47:35 INFO  ---RUNTIME: Execution took 1557.9981803894043 ms
2022-09-21 18:47:35 INFO  Done!
2022-09-21 18:47:35 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-21 18:47:35 INFO  Running instrumented original pipeline...
2022-09-21 18:47:35 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-21 18:47:35 INFO  ---RUNTIME: Importing and monkey-patching took 6.288290023803711 ms
2022-09-21 18:47:36 INFO  ---RUNTIME: Original pipeline execution took 1748.5010623931885 ms (excluding imports and monkey-patching)
2022-09-21 18:47:36 INFO  Starting execution of 1 what-if analyses...
2022-09-21 18:47:36 INFO  Start plan generation for analysis PermutationFeatureImportance...
2022-09-21 18:47:36 INFO  ---RUNTIME: Plan generation took 0.11920928955078125 ms
2022-09-21 18:47:36 INFO  Estimated runtime of original DAG is 1349.360704421997ms
2022-09-21 18:47:36 WARNING Skipping Multi-Query Optimization (instead, only applying patches)
2022-09-21 18:47:36 INFO  Estimated unoptimised what-if runtime is 10794.885635375977ms
2022-09-21 18:47:36 INFO  ---RUNTIME: Multi-Query Optimization took 5.249261856079102 ms
2022-09-21 18:47:36 INFO  Executing generated plans
2022-09-21 18:47:48 INFO  ---RUNTIME: Execution took 11748.049974441528 ms
2022-09-21 18:47:48 INFO  Done!
2022-09-21 18:47:48 INFO  # Finished -- repetition 7 of 7 
2022-09-21 18:47:48 INFO  # Final results after all repetitions
2022-09-21 18:47:48 INFO     repetition  ... no_opt_what_if_execution_combined_model_training
0           0  ...                                      8954.655409
1           1  ...                                      8654.505730
2           2  ...                                      8520.477533
3           3  ...                                      8635.719776
4           4  ...                                      8399.448872
5           5  ...                                      8570.081234
6           6  ...                                      9001.675606

[7 rows x 26 columns]
taskset -c 64-71 PROTOCOL_BUFFERS_PYTHON_IMPLEMENTATION=python python3.9 benchmarks_end_to_end.py feature_importance folktables slow_loading featurization_0 neural_network
2022-09-21 18:47:50.955112: W tensorflow/stream_executor/platform/default/dso_loader.cc:64] Could not load dynamic library 'libcudart.so.11.0'; dlerror: libcudart.so.11.0: cannot open shared object file: No such file or directory; LD_LIBRARY_PATH: /home/sgrafbe/mlwhatif/venv/lib/python3.9/site-packages/cv2/../../lib64:
2022-09-21 18:47:50.955147: I tensorflow/stream_executor/cuda/cudart_stub.cc:29] Ignore above cudart dlerror if you do not have a GPU set up on your machine.
2022-09-21 18:47:52 INFO  Patching sys.argv with ['mlwhatif', 'folktables', 'slow_loading', 'featurization_0', 'neural_network']
2022-09-21 18:47:52 INFO  Running instrumented original pipeline...
2022-09-21 18:47:52 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-21 18:47:52 INFO  ---RUNTIME: Importing and monkey-patching took 107.60688781738281 ms
2022-09-21 18:47:53.167647: W tensorflow/stream_executor/platform/default/dso_loader.cc:64] Could not load dynamic library 'libcuda.so.1'; dlerror: libcuda.so.1: cannot open shared object file: No such file or directory; LD_LIBRARY_PATH: /home/sgrafbe/mlwhatif/venv/lib/python3.9/site-packages/cv2/../../lib64:
2022-09-21 18:47:53.167682: W tensorflow/stream_executor/cuda/cuda_driver.cc:326] failed call to cuInit: UNKNOWN ERROR (303)
2022-09-21 18:47:53.167699: I tensorflow/stream_executor/cuda/cuda_diagnostics.cc:156] kernel driver does not appear to be running on this host (wagyu): /proc/driver/nvidia/version does not exist
2022-09-21 18:47:53.168135: I tensorflow/core/platform/cpu_feature_guard.cc:142] This TensorFlow binary is optimized with oneAPI Deep Neural Network Library (oneDNN) to use the following CPU instructions in performance-critical operations:  AVX2 FMA
To enable them in other operations, rebuild TensorFlow with the appropriate compiler flags.
2022-09-21 18:47:53.259695: I tensorflow/compiler/mlir/mlir_graph_optimization_pass.cc:176] None of the MLIR Optimization Passes are enabled (registered 2)
2022-09-21 18:47:53.271372: I tensorflow/core/platform/profile_utils/cpu_utils.cc:114] CPU Frequency: 2595290000 Hz
2022-09-21 18:47:56 INFO  ---RUNTIME: Original pipeline execution took 3732.931137084961 ms (excluding imports and monkey-patching)
2022-09-21 18:47:56 INFO  Starting execution of 0 what-if analyses...
2022-09-21 18:47:56 INFO  Estimated runtime of original DAG is 3302.6936054229736ms
2022-09-21 18:47:56 INFO  Performing Multi-Query Optimization
2022-09-21 18:47:56 INFO  Estimated unoptimized what-if runtime is 0ms
2022-09-21 18:47:56 INFO  Estimated optimised what-if runtime is 0ms
2022-09-21 18:47:56 INFO  Estimated optimisation runtime saving is 0ms
2022-09-21 18:47:56 INFO  ---RUNTIME: Multi-Query Optimization took 0.3859996795654297 ms
2022-09-21 18:47:56 INFO  Executing generated plans
2022-09-21 18:47:56 INFO  ---RUNTIME: Execution took 0.014781951904296875 ms
2022-09-21 18:47:56 INFO  Done!
2022-09-21 18:47:56 INFO  # Optimization benchmark for feature_importance with args [['folktables', 'slow_loading', 'featurization_0', 'neural_network']] -- repetition 1 of 7
2022-09-21 18:47:56 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-21 18:47:56 INFO  Running instrumented original pipeline...
2022-09-21 18:47:56 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-21 18:47:56 INFO  ---RUNTIME: Importing and monkey-patching took 5.066871643066406 ms
2022-09-21 18:47:59 INFO  ---RUNTIME: Original pipeline execution took 3154.2916297912598 ms (excluding imports and monkey-patching)
2022-09-21 18:47:59 INFO  Starting execution of 1 what-if analyses...
2022-09-21 18:47:59 INFO  Start plan generation for analysis PermutationFeatureImportance...
2022-09-21 18:47:59 INFO  ---RUNTIME: Plan generation took 0.21028518676757812 ms
2022-09-21 18:47:59 INFO  Estimated runtime of original DAG is 2768.3470249176025ms
2022-09-21 18:47:59 INFO  Performing Multi-Query Optimization
2022-09-21 18:47:59 INFO  Estimated unoptimized what-if runtime is 22146.77619934082ms
2022-09-21 18:47:59 INFO  Estimated optimised what-if runtime is 3591.9556617736816ms
2022-09-21 18:47:59 INFO  Estimated optimisation runtime saving is 18554.82053756714ms
2022-09-21 18:47:59 INFO  ---RUNTIME: Multi-Query Optimization took 15.170574188232422 ms
2022-09-21 18:47:59 INFO  Executing generated plans
2022-09-21 18:48:03 INFO  ---RUNTIME: Execution took 3719.8901176452637 ms
2022-09-21 18:48:03 INFO  Done!
2022-09-21 18:48:03 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-21 18:48:03 INFO  Running instrumented original pipeline...
2022-09-21 18:48:03 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-21 18:48:03 INFO  ---RUNTIME: Importing and monkey-patching took 5.918741226196289 ms
2022-09-21 18:48:06 INFO  ---RUNTIME: Original pipeline execution took 3065.3345584869385 ms (excluding imports and monkey-patching)
2022-09-21 18:48:06 INFO  Starting execution of 1 what-if analyses...
2022-09-21 18:48:06 INFO  Start plan generation for analysis PermutationFeatureImportance...
2022-09-21 18:48:06 INFO  ---RUNTIME: Plan generation took 0.1442432403564453 ms
2022-09-21 18:48:06 INFO  Estimated runtime of original DAG is 2676.990747451782ms
2022-09-21 18:48:06 WARNING Skipping Multi-Query Optimization (instead, only applying patches)
2022-09-21 18:48:06 INFO  Estimated unoptimised what-if runtime is 21415.925979614258ms
2022-09-21 18:48:06 INFO  ---RUNTIME: Multi-Query Optimization took 4.873991012573242 ms
2022-09-21 18:48:06 INFO  Executing generated plans
2022-09-21 18:48:29 INFO  ---RUNTIME: Execution took 23464.99276161194 ms
2022-09-21 18:48:29 INFO  Done!
2022-09-21 18:48:29 INFO  # Finished -- repetition 1 of 7 
2022-09-21 18:48:29 INFO  # Optimization benchmark for feature_importance with args [['folktables', 'slow_loading', 'featurization_0', 'neural_network']] -- repetition 2 of 7
2022-09-21 18:48:29 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-21 18:48:29 INFO  Running instrumented original pipeline...
2022-09-21 18:48:29 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-21 18:48:29 INFO  ---RUNTIME: Importing and monkey-patching took 6.013154983520508 ms
2022-09-21 18:48:32 INFO  ---RUNTIME: Original pipeline execution took 3280.501127243042 ms (excluding imports and monkey-patching)
2022-09-21 18:48:32 INFO  Starting execution of 1 what-if analyses...
2022-09-21 18:48:32 INFO  Start plan generation for analysis PermutationFeatureImportance...
2022-09-21 18:48:32 INFO  ---RUNTIME: Plan generation took 0.14472007751464844 ms
2022-09-21 18:48:32 INFO  Estimated runtime of original DAG is 2887.2787952423096ms
2022-09-21 18:48:32 INFO  Performing Multi-Query Optimization
2022-09-21 18:48:32 INFO  Estimated unoptimized what-if runtime is 23098.230361938477ms
2022-09-21 18:48:32 INFO  Estimated optimised what-if runtime is 3775.4008769989014ms
2022-09-21 18:48:32 INFO  Estimated optimisation runtime saving is 19322.829484939575ms
2022-09-21 18:48:32 INFO  ---RUNTIME: Multi-Query Optimization took 13.955354690551758 ms
2022-09-21 18:48:32 INFO  Executing generated plans
2022-09-21 18:48:36 INFO  ---RUNTIME: Execution took 3617.7914142608643 ms
2022-09-21 18:48:36 INFO  Done!
2022-09-21 18:48:36 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-21 18:48:36 INFO  Running instrumented original pipeline...
2022-09-21 18:48:36 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-21 18:48:36 INFO  ---RUNTIME: Importing and monkey-patching took 5.661249160766602 ms
2022-09-21 18:48:39 INFO  ---RUNTIME: Original pipeline execution took 3198.981285095215 ms (excluding imports and monkey-patching)
2022-09-21 18:48:39 INFO  Starting execution of 1 what-if analyses...
2022-09-21 18:48:39 INFO  Start plan generation for analysis PermutationFeatureImportance...
2022-09-21 18:48:39 INFO  ---RUNTIME: Plan generation took 0.1418590545654297 ms
2022-09-21 18:48:39 INFO  Estimated runtime of original DAG is 2808.7704181671143ms
2022-09-21 18:48:39 WARNING Skipping Multi-Query Optimization (instead, only applying patches)
2022-09-21 18:48:39 INFO  Estimated unoptimised what-if runtime is 22470.163345336914ms
2022-09-21 18:48:39 INFO  ---RUNTIME: Multi-Query Optimization took 6.114006042480469 ms
2022-09-21 18:48:39 INFO  Executing generated plans
2022-09-21 18:49:04 INFO  ---RUNTIME: Execution took 25021.414279937744 ms
2022-09-21 18:49:04 INFO  Done!
2022-09-21 18:49:04 INFO  # Finished -- repetition 2 of 7 
2022-09-21 18:49:04 INFO  # Optimization benchmark for feature_importance with args [['folktables', 'slow_loading', 'featurization_0', 'neural_network']] -- repetition 3 of 7
2022-09-21 18:49:04 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-21 18:49:04 INFO  Running instrumented original pipeline...
2022-09-21 18:49:04 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-21 18:49:04 INFO  ---RUNTIME: Importing and monkey-patching took 6.254673004150391 ms
2022-09-21 18:49:08 INFO  ---RUNTIME: Original pipeline execution took 3463.669538497925 ms (excluding imports and monkey-patching)
2022-09-21 18:49:08 INFO  Starting execution of 1 what-if analyses...
2022-09-21 18:49:08 INFO  Start plan generation for analysis PermutationFeatureImportance...
2022-09-21 18:49:08 INFO  ---RUNTIME: Plan generation took 0.16307830810546875 ms
2022-09-21 18:49:08 INFO  Estimated runtime of original DAG is 3008.582353591919ms
2022-09-21 18:49:08 INFO  Performing Multi-Query Optimization
2022-09-21 18:49:08 INFO  Estimated unoptimized what-if runtime is 24068.65882873535ms
2022-09-21 18:49:08 INFO  Estimated optimised what-if runtime is 3966.8002128601074ms
2022-09-21 18:49:08 INFO  Estimated optimisation runtime saving is 20101.858615875244ms
2022-09-21 18:49:08 INFO  ---RUNTIME: Multi-Query Optimization took 20.312786102294922 ms
2022-09-21 18:49:08 INFO  Executing generated plans
2022-09-21 18:49:12 INFO  ---RUNTIME: Execution took 4127.686500549316 ms
2022-09-21 18:49:12 INFO  Done!
2022-09-21 18:49:12 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-21 18:49:12 INFO  Running instrumented original pipeline...
2022-09-21 18:49:12 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-21 18:49:12 INFO  ---RUNTIME: Importing and monkey-patching took 5.562067031860352 ms
2022-09-21 18:49:15 INFO  ---RUNTIME: Original pipeline execution took 3450.8743286132812 ms (excluding imports and monkey-patching)
2022-09-21 18:49:15 INFO  Starting execution of 1 what-if analyses...
2022-09-21 18:49:15 INFO  Start plan generation for analysis PermutationFeatureImportance...
2022-09-21 18:49:15 INFO  ---RUNTIME: Plan generation took 0.1652240753173828 ms
2022-09-21 18:49:15 INFO  Estimated runtime of original DAG is 3061.628818511963ms
2022-09-21 18:49:15 WARNING Skipping Multi-Query Optimization (instead, only applying patches)
2022-09-21 18:49:15 INFO  Estimated unoptimised what-if runtime is 24493.030548095703ms
2022-09-21 18:49:15 INFO  ---RUNTIME: Multi-Query Optimization took 6.110668182373047 ms
2022-09-21 18:49:15 INFO  Executing generated plans
2022-09-21 18:49:41 INFO  ---RUNTIME: Execution took 26029.50406074524 ms
2022-09-21 18:49:41 INFO  Done!
2022-09-21 18:49:41 INFO  # Finished -- repetition 3 of 7 
2022-09-21 18:49:41 INFO  # Optimization benchmark for feature_importance with args [['folktables', 'slow_loading', 'featurization_0', 'neural_network']] -- repetition 4 of 7
2022-09-21 18:49:41 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-21 18:49:41 INFO  Running instrumented original pipeline...
2022-09-21 18:49:42 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-21 18:49:42 INFO  ---RUNTIME: Importing and monkey-patching took 5.8383941650390625 ms
2022-09-21 18:49:45 INFO  ---RUNTIME: Original pipeline execution took 3748.422145843506 ms (excluding imports and monkey-patching)
2022-09-21 18:49:45 INFO  Starting execution of 1 what-if analyses...
2022-09-21 18:49:45 INFO  Start plan generation for analysis PermutationFeatureImportance...
2022-09-21 18:49:45 INFO  ---RUNTIME: Plan generation took 0.1723766326904297 ms
2022-09-21 18:49:45 INFO  Estimated runtime of original DAG is 2949.8131275177ms
2022-09-21 18:49:45 INFO  Performing Multi-Query Optimization
2022-09-21 18:49:45 INFO  Estimated unoptimized what-if runtime is 23598.5050201416ms
2022-09-21 18:49:45 INFO  Estimated optimised what-if runtime is 4001.354694366455ms
2022-09-21 18:49:45 INFO  Estimated optimisation runtime saving is 19597.150325775146ms
2022-09-21 18:49:45 INFO  ---RUNTIME: Multi-Query Optimization took 18.263578414916992 ms
2022-09-21 18:49:45 INFO  Executing generated plans
2022-09-21 18:49:49 INFO  ---RUNTIME: Execution took 4206.795454025269 ms
2022-09-21 18:49:49 INFO  Done!
2022-09-21 18:49:49 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-21 18:49:49 INFO  Running instrumented original pipeline...
2022-09-21 18:49:49 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-21 18:49:49 INFO  ---RUNTIME: Importing and monkey-patching took 5.663633346557617 ms
2022-09-21 18:49:53 INFO  ---RUNTIME: Original pipeline execution took 3463.487148284912 ms (excluding imports and monkey-patching)
2022-09-21 18:49:53 INFO  Starting execution of 1 what-if analyses...
2022-09-21 18:49:53 INFO  Start plan generation for analysis PermutationFeatureImportance...
2022-09-21 18:49:53 INFO  ---RUNTIME: Plan generation took 0.15878677368164062 ms
2022-09-21 18:49:53 INFO  Estimated runtime of original DAG is 3070.260524749756ms
2022-09-21 18:49:53 WARNING Skipping Multi-Query Optimization (instead, only applying patches)
2022-09-21 18:49:53 INFO  Estimated unoptimised what-if runtime is 24562.084197998047ms
2022-09-21 18:49:53 INFO  ---RUNTIME: Multi-Query Optimization took 6.5460205078125 ms
2022-09-21 18:49:53 INFO  Executing generated plans
2022-09-21 18:50:19 INFO  ---RUNTIME: Execution took 26034.069061279297 ms
2022-09-21 18:50:19 INFO  Done!
2022-09-21 18:50:19 INFO  # Finished -- repetition 4 of 7 
2022-09-21 18:50:19 INFO  # Optimization benchmark for feature_importance with args [['folktables', 'slow_loading', 'featurization_0', 'neural_network']] -- repetition 5 of 7
2022-09-21 18:50:19 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-21 18:50:19 INFO  Running instrumented original pipeline...
2022-09-21 18:50:19 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-21 18:50:19 INFO  ---RUNTIME: Importing and monkey-patching took 5.811214447021484 ms
2022-09-21 18:50:22 INFO  ---RUNTIME: Original pipeline execution took 3418.7395572662354 ms (excluding imports and monkey-patching)
2022-09-21 18:50:22 INFO  Starting execution of 1 what-if analyses...
2022-09-21 18:50:22 INFO  Start plan generation for analysis PermutationFeatureImportance...
2022-09-21 18:50:22 INFO  ---RUNTIME: Plan generation took 0.12922286987304688 ms
2022-09-21 18:50:22 INFO  Estimated runtime of original DAG is 2953.862428665161ms
2022-09-21 18:50:22 INFO  Performing Multi-Query Optimization
2022-09-21 18:50:22 INFO  Estimated unoptimized what-if runtime is 23630.89942932129ms
2022-09-21 18:50:22 INFO  Estimated optimised what-if runtime is 3789.419412612915ms
2022-09-21 18:50:22 INFO  Estimated optimisation runtime saving is 19841.480016708374ms
2022-09-21 18:50:22 INFO  ---RUNTIME: Multi-Query Optimization took 14.962434768676758 ms
2022-09-21 18:50:22 INFO  Executing generated plans
2022-09-21 18:50:26 INFO  ---RUNTIME: Execution took 3953.378438949585 ms
2022-09-21 18:50:26 INFO  Done!
2022-09-21 18:50:26 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-21 18:50:26 INFO  Running instrumented original pipeline...
2022-09-21 18:50:26 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-21 18:50:26 INFO  ---RUNTIME: Importing and monkey-patching took 7.108449935913086 ms
2022-09-21 18:50:30 INFO  ---RUNTIME: Original pipeline execution took 3539.8881435394287 ms (excluding imports and monkey-patching)
2022-09-21 18:50:30 INFO  Starting execution of 1 what-if analyses...
2022-09-21 18:50:30 INFO  Start plan generation for analysis PermutationFeatureImportance...
2022-09-21 18:50:30 INFO  ---RUNTIME: Plan generation took 0.13256072998046875 ms
2022-09-21 18:50:30 INFO  Estimated runtime of original DAG is 3130.9118270874023ms
2022-09-21 18:50:30 WARNING Skipping Multi-Query Optimization (instead, only applying patches)
2022-09-21 18:50:30 INFO  Estimated unoptimised what-if runtime is 25047.29461669922ms
2022-09-21 18:50:30 INFO  ---RUNTIME: Multi-Query Optimization took 4.866838455200195 ms
2022-09-21 18:50:30 INFO  Executing generated plans
2022-09-21 18:50:55 INFO  ---RUNTIME: Execution took 25563.303232192993 ms
2022-09-21 18:50:55 INFO  Done!
2022-09-21 18:50:55 INFO  # Finished -- repetition 5 of 7 
2022-09-21 18:50:55 INFO  # Optimization benchmark for feature_importance with args [['folktables', 'slow_loading', 'featurization_0', 'neural_network']] -- repetition 6 of 7
2022-09-21 18:50:55 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-21 18:50:55 INFO  Running instrumented original pipeline...
2022-09-21 18:50:55 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-21 18:50:55 INFO  ---RUNTIME: Importing and monkey-patching took 6.223440170288086 ms
2022-09-21 18:50:59 INFO  ---RUNTIME: Original pipeline execution took 3392.5886154174805 ms (excluding imports and monkey-patching)
2022-09-21 18:50:59 INFO  Starting execution of 1 what-if analyses...
2022-09-21 18:50:59 INFO  Start plan generation for analysis PermutationFeatureImportance...
2022-09-21 18:50:59 INFO  ---RUNTIME: Plan generation took 0.14400482177734375 ms
2022-09-21 18:50:59 INFO  Estimated runtime of original DAG is 2976.7441749572754ms
2022-09-21 18:50:59 INFO  Performing Multi-Query Optimization
2022-09-21 18:50:59 INFO  Estimated unoptimized what-if runtime is 23813.953399658203ms
2022-09-21 18:50:59 INFO  Estimated optimised what-if runtime is 3900.9039402008057ms
2022-09-21 18:50:59 INFO  Estimated optimisation runtime saving is 19913.049459457397ms
2022-09-21 18:50:59 INFO  ---RUNTIME: Multi-Query Optimization took 19.71602439880371 ms
2022-09-21 18:50:59 INFO  Executing generated plans
2022-09-21 18:51:03 INFO  ---RUNTIME: Execution took 3882.079601287842 ms
2022-09-21 18:51:03 INFO  Done!
2022-09-21 18:51:03 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-21 18:51:03 INFO  Running instrumented original pipeline...
2022-09-21 18:51:03 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-21 18:51:03 INFO  ---RUNTIME: Importing and monkey-patching took 5.686759948730469 ms
2022-09-21 18:51:06 INFO  ---RUNTIME: Original pipeline execution took 3385.9927654266357 ms (excluding imports and monkey-patching)
2022-09-21 18:51:06 INFO  Starting execution of 1 what-if analyses...
2022-09-21 18:51:06 INFO  Start plan generation for analysis PermutationFeatureImportance...
2022-09-21 18:51:06 INFO  ---RUNTIME: Plan generation took 0.14019012451171875 ms
2022-09-21 18:51:06 INFO  Estimated runtime of original DAG is 2995.105504989624ms
2022-09-21 18:51:06 WARNING Skipping Multi-Query Optimization (instead, only applying patches)
2022-09-21 18:51:06 INFO  Estimated unoptimised what-if runtime is 23960.844039916992ms
2022-09-21 18:51:06 INFO  ---RUNTIME: Multi-Query Optimization took 5.337238311767578 ms
2022-09-21 18:51:06 INFO  Executing generated plans
2022-09-21 18:51:32 INFO  ---RUNTIME: Execution took 25452.1267414093 ms
2022-09-21 18:51:32 INFO  Done!
2022-09-21 18:51:32 INFO  # Finished -- repetition 6 of 7 
2022-09-21 18:51:32 INFO  # Optimization benchmark for feature_importance with args [['folktables', 'slow_loading', 'featurization_0', 'neural_network']] -- repetition 7 of 7
2022-09-21 18:51:32 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-21 18:51:32 INFO  Running instrumented original pipeline...
2022-09-21 18:51:32 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-21 18:51:32 INFO  ---RUNTIME: Importing and monkey-patching took 5.927085876464844 ms
2022-09-21 18:51:35 INFO  ---RUNTIME: Original pipeline execution took 3883.117914199829 ms (excluding imports and monkey-patching)
2022-09-21 18:51:35 INFO  Starting execution of 1 what-if analyses...
2022-09-21 18:51:35 INFO  Start plan generation for analysis PermutationFeatureImportance...
2022-09-21 18:51:35 INFO  ---RUNTIME: Plan generation took 0.13399124145507812 ms
2022-09-21 18:51:35 INFO  Estimated runtime of original DAG is 3470.7820415496826ms
2022-09-21 18:51:35 INFO  Performing Multi-Query Optimization
2022-09-21 18:51:35 INFO  Estimated unoptimized what-if runtime is 27766.25633239746ms
2022-09-21 18:51:35 INFO  Estimated optimised what-if runtime is 4337.325572967529ms
2022-09-21 18:51:35 INFO  Estimated optimisation runtime saving is 23428.93075942993ms
2022-09-21 18:51:35 INFO  ---RUNTIME: Multi-Query Optimization took 13.802766799926758 ms
2022-09-21 18:51:35 INFO  Executing generated plans
2022-09-21 18:51:39 INFO  ---RUNTIME: Execution took 3780.8775901794434 ms
2022-09-21 18:51:39 INFO  Done!
2022-09-21 18:51:39 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-21 18:51:39 INFO  Running instrumented original pipeline...
2022-09-21 18:51:39 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-21 18:51:39 INFO  ---RUNTIME: Importing and monkey-patching took 5.652189254760742 ms
2022-09-21 18:51:43 INFO  ---RUNTIME: Original pipeline execution took 3607.142686843872 ms (excluding imports and monkey-patching)
2022-09-21 18:51:43 INFO  Starting execution of 1 what-if analyses...
2022-09-21 18:51:43 INFO  Start plan generation for analysis PermutationFeatureImportance...
2022-09-21 18:51:43 INFO  ---RUNTIME: Plan generation took 0.13327598571777344 ms
2022-09-21 18:51:43 INFO  Estimated runtime of original DAG is 3190.7413005828857ms
2022-09-21 18:51:43 WARNING Skipping Multi-Query Optimization (instead, only applying patches)
2022-09-21 18:51:43 INFO  Estimated unoptimised what-if runtime is 25525.930404663086ms
2022-09-21 18:51:43 INFO  ---RUNTIME: Multi-Query Optimization took 5.526542663574219 ms
2022-09-21 18:51:43 INFO  Executing generated plans
2022-09-21 18:52:08 INFO  ---RUNTIME: Execution took 25599.850177764893 ms
2022-09-21 18:52:08 INFO  Done!
2022-09-21 18:52:08 INFO  # Finished -- repetition 7 of 7 
2022-09-21 18:52:08 INFO  # Final results after all repetitions
2022-09-21 18:52:08 INFO     repetition  ... no_opt_what_if_execution_combined_model_training
0           0  ...                                     20138.290644
1           1  ...                                     21211.618900
2           2  ...                                     22187.400818
3           3  ...                                     21932.579756
4           4  ...                                     22025.839090
5           5  ...                                     22010.011673
6           6  ...                                     22103.252888

[7 rows x 26 columns]
taskset -c 64-71 PROTOCOL_BUFFERS_PYTHON_IMPLEMENTATION=python python3.9 benchmarks_end_to_end.py feature_importance folktables slow_loading featurization_1 logistic_regression
2022-09-21 18:52:11.236188: W tensorflow/stream_executor/platform/default/dso_loader.cc:64] Could not load dynamic library 'libcudart.so.11.0'; dlerror: libcudart.so.11.0: cannot open shared object file: No such file or directory; LD_LIBRARY_PATH: /home/sgrafbe/mlwhatif/venv/lib/python3.9/site-packages/cv2/../../lib64:
2022-09-21 18:52:11.236228: I tensorflow/stream_executor/cuda/cudart_stub.cc:29] Ignore above cudart dlerror if you do not have a GPU set up on your machine.
2022-09-21 18:52:12 INFO  Patching sys.argv with ['mlwhatif', 'folktables', 'slow_loading', 'featurization_1', 'logistic_regression']
2022-09-21 18:52:12 INFO  Running instrumented original pipeline...
2022-09-21 18:52:12 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-21 18:52:12 INFO  ---RUNTIME: Importing and monkey-patching took 95.34311294555664 ms
2022-09-21 18:52:14 INFO  ---RUNTIME: Original pipeline execution took 1580.9299945831299 ms (excluding imports and monkey-patching)
2022-09-21 18:52:14 INFO  Starting execution of 0 what-if analyses...
2022-09-21 18:52:14 INFO  Estimated runtime of original DAG is 300.42576789855957ms
2022-09-21 18:52:14 INFO  Performing Multi-Query Optimization
2022-09-21 18:52:14 INFO  Estimated unoptimized what-if runtime is 0ms
2022-09-21 18:52:14 INFO  Estimated optimised what-if runtime is 0ms
2022-09-21 18:52:14 INFO  Estimated optimisation runtime saving is 0ms
2022-09-21 18:52:14 INFO  ---RUNTIME: Multi-Query Optimization took 0.4749298095703125 ms
2022-09-21 18:52:14 INFO  Executing generated plans
2022-09-21 18:52:14 INFO  ---RUNTIME: Execution took 0.02193450927734375 ms
2022-09-21 18:52:14 INFO  Done!
2022-09-21 18:52:14 INFO  # Optimization benchmark for feature_importance with args [['folktables', 'slow_loading', 'featurization_1', 'logistic_regression']] -- repetition 1 of 7
2022-09-21 18:52:14 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-21 18:52:14 INFO  Running instrumented original pipeline...
2022-09-21 18:52:14 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-21 18:52:14 INFO  ---RUNTIME: Importing and monkey-patching took 5.354404449462891 ms
2022-09-21 18:52:15 INFO  ---RUNTIME: Original pipeline execution took 1561.1541271209717 ms (excluding imports and monkey-patching)
2022-09-21 18:52:15 INFO  Starting execution of 1 what-if analyses...
2022-09-21 18:52:15 INFO  Start plan generation for analysis PermutationFeatureImportance...
2022-09-21 18:52:15 INFO  ---RUNTIME: Plan generation took 0.2512931823730469 ms
2022-09-21 18:52:15 INFO  Estimated runtime of original DAG is 295.2115535736084ms
2022-09-21 18:52:15 INFO  Performing Multi-Query Optimization
2022-09-21 18:52:15 INFO  Estimated unoptimized what-if runtime is 2361.692428588867ms
2022-09-21 18:52:15 INFO  Estimated optimised what-if runtime is 348.813533782959ms
2022-09-21 18:52:15 INFO  Estimated optimisation runtime saving is 2012.8788948059082ms
2022-09-21 18:52:15 INFO  ---RUNTIME: Multi-Query Optimization took 17.603158950805664 ms
2022-09-21 18:52:15 INFO  Executing generated plans
2022-09-21 18:52:16 INFO  ---RUNTIME: Execution took 441.9057369232178 ms
2022-09-21 18:52:16 INFO  Done!
2022-09-21 18:52:16 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-21 18:52:16 INFO  Running instrumented original pipeline...
2022-09-21 18:52:16 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-21 18:52:16 INFO  ---RUNTIME: Importing and monkey-patching took 5.577802658081055 ms
2022-09-21 18:52:17 INFO  ---RUNTIME: Original pipeline execution took 1688.9684200286865 ms (excluding imports and monkey-patching)
2022-09-21 18:52:17 INFO  Starting execution of 1 what-if analyses...
2022-09-21 18:52:17 INFO  Start plan generation for analysis PermutationFeatureImportance...
2022-09-21 18:52:17 INFO  ---RUNTIME: Plan generation took 0.20813941955566406 ms
2022-09-21 18:52:17 INFO  Estimated runtime of original DAG is 293.0014133453369ms
2022-09-21 18:52:17 WARNING Skipping Multi-Query Optimization (instead, only applying patches)
2022-09-21 18:52:17 INFO  Estimated unoptimised what-if runtime is 2344.0113067626953ms
2022-09-21 18:52:17 INFO  ---RUNTIME: Multi-Query Optimization took 6.446361541748047 ms
2022-09-21 18:52:17 INFO  Executing generated plans
2022-09-21 18:52:20 INFO  ---RUNTIME: Execution took 3068.148612976074 ms
2022-09-21 18:52:20 INFO  Done!
2022-09-21 18:52:20 INFO  # Finished -- repetition 1 of 7 
2022-09-21 18:52:20 INFO  # Optimization benchmark for feature_importance with args [['folktables', 'slow_loading', 'featurization_1', 'logistic_regression']] -- repetition 2 of 7
2022-09-21 18:52:20 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-21 18:52:20 INFO  Running instrumented original pipeline...
2022-09-21 18:52:20 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-21 18:52:20 INFO  ---RUNTIME: Importing and monkey-patching took 6.588459014892578 ms
2022-09-21 18:52:22 INFO  ---RUNTIME: Original pipeline execution took 1560.4655742645264 ms (excluding imports and monkey-patching)
2022-09-21 18:52:22 INFO  Starting execution of 1 what-if analyses...
2022-09-21 18:52:22 INFO  Start plan generation for analysis PermutationFeatureImportance...
2022-09-21 18:52:22 INFO  ---RUNTIME: Plan generation took 0.1513957977294922 ms
2022-09-21 18:52:22 INFO  Estimated runtime of original DAG is 297.14345932006836ms
2022-09-21 18:52:22 INFO  Performing Multi-Query Optimization
2022-09-21 18:52:22 INFO  Estimated unoptimized what-if runtime is 2377.147674560547ms
2022-09-21 18:52:22 INFO  Estimated optimised what-if runtime is 348.7076759338379ms
2022-09-21 18:52:22 INFO  Estimated optimisation runtime saving is 2028.439998626709ms
2022-09-21 18:52:22 INFO  ---RUNTIME: Multi-Query Optimization took 17.694950103759766 ms
2022-09-21 18:52:22 INFO  Executing generated plans
2022-09-21 18:52:22 INFO  ---RUNTIME: Execution took 461.8368148803711 ms
2022-09-21 18:52:22 INFO  Done!
2022-09-21 18:52:22 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-21 18:52:22 INFO  Running instrumented original pipeline...
2022-09-21 18:52:23 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-21 18:52:23 INFO  ---RUNTIME: Importing and monkey-patching took 6.159543991088867 ms
2022-09-21 18:52:24 INFO  ---RUNTIME: Original pipeline execution took 1528.4311771392822 ms (excluding imports and monkey-patching)
2022-09-21 18:52:24 INFO  Starting execution of 1 what-if analyses...
2022-09-21 18:52:24 INFO  Start plan generation for analysis PermutationFeatureImportance...
2022-09-21 18:52:24 INFO  ---RUNTIME: Plan generation took 0.13017654418945312 ms
2022-09-21 18:52:24 INFO  Estimated runtime of original DAG is 294.51704025268555ms
2022-09-21 18:52:24 WARNING Skipping Multi-Query Optimization (instead, only applying patches)
2022-09-21 18:52:24 INFO  Estimated unoptimised what-if runtime is 2356.1363220214844ms
2022-09-21 18:52:24 INFO  ---RUNTIME: Multi-Query Optimization took 6.2427520751953125 ms
2022-09-21 18:52:24 INFO  Executing generated plans
2022-09-21 18:52:27 INFO  ---RUNTIME: Execution took 3106.674909591675 ms
2022-09-21 18:52:27 INFO  Done!
2022-09-21 18:52:27 INFO  # Finished -- repetition 2 of 7 
2022-09-21 18:52:27 INFO  # Optimization benchmark for feature_importance with args [['folktables', 'slow_loading', 'featurization_1', 'logistic_regression']] -- repetition 3 of 7
2022-09-21 18:52:27 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-21 18:52:27 INFO  Running instrumented original pipeline...
2022-09-21 18:52:27 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-21 18:52:27 INFO  ---RUNTIME: Importing and monkey-patching took 6.06083869934082 ms
2022-09-21 18:52:29 INFO  ---RUNTIME: Original pipeline execution took 1576.244831085205 ms (excluding imports and monkey-patching)
2022-09-21 18:52:29 INFO  Starting execution of 1 what-if analyses...
2022-09-21 18:52:29 INFO  Start plan generation for analysis PermutationFeatureImportance...
2022-09-21 18:52:29 INFO  ---RUNTIME: Plan generation took 0.15473365783691406 ms
2022-09-21 18:52:29 INFO  Estimated runtime of original DAG is 329.2956352233887ms
2022-09-21 18:52:29 INFO  Performing Multi-Query Optimization
2022-09-21 18:52:29 INFO  Estimated unoptimized what-if runtime is 2634.3650817871094ms
2022-09-21 18:52:29 INFO  Estimated optimised what-if runtime is 379.6389102935791ms
2022-09-21 18:52:29 INFO  Estimated optimisation runtime saving is 2254.7261714935303ms
2022-09-21 18:52:29 INFO  ---RUNTIME: Multi-Query Optimization took 16.748905181884766 ms
2022-09-21 18:52:29 INFO  Executing generated plans
2022-09-21 18:52:29 INFO  ---RUNTIME: Execution took 454.7991752624512 ms
2022-09-21 18:52:29 INFO  Done!
2022-09-21 18:52:29 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-21 18:52:29 INFO  Running instrumented original pipeline...
2022-09-21 18:52:29 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-21 18:52:29 INFO  ---RUNTIME: Importing and monkey-patching took 5.539417266845703 ms
2022-09-21 18:52:31 INFO  ---RUNTIME: Original pipeline execution took 1572.9870796203613 ms (excluding imports and monkey-patching)
2022-09-21 18:52:31 INFO  Starting execution of 1 what-if analyses...
2022-09-21 18:52:31 INFO  Start plan generation for analysis PermutationFeatureImportance...
2022-09-21 18:52:31 INFO  ---RUNTIME: Plan generation took 0.13208389282226562 ms
2022-09-21 18:52:31 INFO  Estimated runtime of original DAG is 312.1159076690674ms
2022-09-21 18:52:31 WARNING Skipping Multi-Query Optimization (instead, only applying patches)
2022-09-21 18:52:31 INFO  Estimated unoptimised what-if runtime is 2496.927261352539ms
2022-09-21 18:52:31 INFO  ---RUNTIME: Multi-Query Optimization took 6.2503814697265625 ms
2022-09-21 18:52:31 INFO  Executing generated plans
2022-09-21 18:52:34 INFO  ---RUNTIME: Execution took 3207.726001739502 ms
2022-09-21 18:52:34 INFO  Done!
2022-09-21 18:52:34 INFO  # Finished -- repetition 3 of 7 
2022-09-21 18:52:34 INFO  # Optimization benchmark for feature_importance with args [['folktables', 'slow_loading', 'featurization_1', 'logistic_regression']] -- repetition 4 of 7
2022-09-21 18:52:34 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-21 18:52:34 INFO  Running instrumented original pipeline...
2022-09-21 18:52:34 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-21 18:52:34 INFO  ---RUNTIME: Importing and monkey-patching took 5.890846252441406 ms
2022-09-21 18:52:36 INFO  ---RUNTIME: Original pipeline execution took 1555.9802055358887 ms (excluding imports and monkey-patching)
2022-09-21 18:52:36 INFO  Starting execution of 1 what-if analyses...
2022-09-21 18:52:36 INFO  Start plan generation for analysis PermutationFeatureImportance...
2022-09-21 18:52:36 INFO  ---RUNTIME: Plan generation took 0.13494491577148438 ms
2022-09-21 18:52:36 INFO  Estimated runtime of original DAG is 313.19332122802734ms
2022-09-21 18:52:36 INFO  Performing Multi-Query Optimization
2022-09-21 18:52:36 INFO  Estimated unoptimized what-if runtime is 2505.5465698242188ms
2022-09-21 18:52:36 INFO  Estimated optimised what-if runtime is 363.35206031799316ms
2022-09-21 18:52:36 INFO  Estimated optimisation runtime saving is 2142.1945095062256ms
2022-09-21 18:52:36 INFO  ---RUNTIME: Multi-Query Optimization took 16.788482666015625 ms
2022-09-21 18:52:36 INFO  Executing generated plans
2022-09-21 18:52:36 INFO  ---RUNTIME: Execution took 445.3272819519043 ms
2022-09-21 18:52:36 INFO  Done!
2022-09-21 18:52:36 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-21 18:52:36 INFO  Running instrumented original pipeline...
2022-09-21 18:52:36 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-21 18:52:36 INFO  ---RUNTIME: Importing and monkey-patching took 5.942583084106445 ms
2022-09-21 18:52:38 INFO  ---RUNTIME: Original pipeline execution took 1553.1768798828125 ms (excluding imports and monkey-patching)
2022-09-21 18:52:38 INFO  Starting execution of 1 what-if analyses...
2022-09-21 18:52:38 INFO  Start plan generation for analysis PermutationFeatureImportance...
2022-09-21 18:52:38 INFO  ---RUNTIME: Plan generation took 0.14901161193847656 ms
2022-09-21 18:52:38 INFO  Estimated runtime of original DAG is 291.0010814666748ms
2022-09-21 18:52:38 WARNING Skipping Multi-Query Optimization (instead, only applying patches)
2022-09-21 18:52:38 INFO  Estimated unoptimised what-if runtime is 2328.0086517333984ms
2022-09-21 18:52:38 INFO  ---RUNTIME: Multi-Query Optimization took 207.14163780212402 ms
2022-09-21 18:52:38 INFO  Executing generated plans
2022-09-21 18:52:41 INFO  ---RUNTIME: Execution took 3185.642719268799 ms
2022-09-21 18:52:41 INFO  Done!
2022-09-21 18:52:41 INFO  # Finished -- repetition 4 of 7 
2022-09-21 18:52:41 INFO  # Optimization benchmark for feature_importance with args [['folktables', 'slow_loading', 'featurization_1', 'logistic_regression']] -- repetition 5 of 7
2022-09-21 18:52:41 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-21 18:52:41 INFO  Running instrumented original pipeline...
2022-09-21 18:52:41 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-21 18:52:41 INFO  ---RUNTIME: Importing and monkey-patching took 6.3877105712890625 ms
2022-09-21 18:52:43 INFO  ---RUNTIME: Original pipeline execution took 1589.759111404419 ms (excluding imports and monkey-patching)
2022-09-21 18:52:43 INFO  Starting execution of 1 what-if analyses...
2022-09-21 18:52:43 INFO  Start plan generation for analysis PermutationFeatureImportance...
2022-09-21 18:52:43 INFO  ---RUNTIME: Plan generation took 0.12969970703125 ms
2022-09-21 18:52:43 INFO  Estimated runtime of original DAG is 300.42314529418945ms
2022-09-21 18:52:43 INFO  Performing Multi-Query Optimization
2022-09-21 18:52:43 INFO  Estimated unoptimized what-if runtime is 2403.3851623535156ms
2022-09-21 18:52:43 INFO  Estimated optimised what-if runtime is 350.74663162231445ms
2022-09-21 18:52:43 INFO  Estimated optimisation runtime saving is 2052.638530731201ms
2022-09-21 18:52:43 INFO  ---RUNTIME: Multi-Query Optimization took 15.916585922241211 ms
2022-09-21 18:52:43 INFO  Executing generated plans
2022-09-21 18:52:43 INFO  ---RUNTIME: Execution took 473.83999824523926 ms
2022-09-21 18:52:43 INFO  Done!
2022-09-21 18:52:43 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-21 18:52:43 INFO  Running instrumented original pipeline...
2022-09-21 18:52:43 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-21 18:52:43 INFO  ---RUNTIME: Importing and monkey-patching took 5.767345428466797 ms
2022-09-21 18:52:45 INFO  ---RUNTIME: Original pipeline execution took 1508.1310272216797 ms (excluding imports and monkey-patching)
2022-09-21 18:52:45 INFO  Starting execution of 1 what-if analyses...
2022-09-21 18:52:45 INFO  Start plan generation for analysis PermutationFeatureImportance...
2022-09-21 18:52:45 INFO  ---RUNTIME: Plan generation took 0.148773193359375 ms
2022-09-21 18:52:45 INFO  Estimated runtime of original DAG is 288.5558605194092ms
2022-09-21 18:52:45 WARNING Skipping Multi-Query Optimization (instead, only applying patches)
2022-09-21 18:52:45 INFO  Estimated unoptimised what-if runtime is 2308.4468841552734ms
2022-09-21 18:52:45 INFO  ---RUNTIME: Multi-Query Optimization took 5.808353424072266 ms
2022-09-21 18:52:45 INFO  Executing generated plans
2022-09-21 18:52:48 INFO  ---RUNTIME: Execution took 3179.6059608459473 ms
2022-09-21 18:52:48 INFO  Done!
2022-09-21 18:52:48 INFO  # Finished -- repetition 5 of 7 
2022-09-21 18:52:48 INFO  # Optimization benchmark for feature_importance with args [['folktables', 'slow_loading', 'featurization_1', 'logistic_regression']] -- repetition 6 of 7
2022-09-21 18:52:48 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-21 18:52:48 INFO  Running instrumented original pipeline...
2022-09-21 18:52:48 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-21 18:52:48 INFO  ---RUNTIME: Importing and monkey-patching took 5.544424057006836 ms
2022-09-21 18:52:49 INFO  ---RUNTIME: Original pipeline execution took 1533.5321426391602 ms (excluding imports and monkey-patching)
2022-09-21 18:52:49 INFO  Starting execution of 1 what-if analyses...
2022-09-21 18:52:49 INFO  Start plan generation for analysis PermutationFeatureImportance...
2022-09-21 18:52:49 INFO  ---RUNTIME: Plan generation took 0.1266002655029297 ms
2022-09-21 18:52:49 INFO  Estimated runtime of original DAG is 287.9624366760254ms
2022-09-21 18:52:49 INFO  Performing Multi-Query Optimization
2022-09-21 18:52:49 INFO  Estimated unoptimized what-if runtime is 2303.699493408203ms
2022-09-21 18:52:49 INFO  Estimated optimised what-if runtime is 341.3569927215576ms
2022-09-21 18:52:49 INFO  Estimated optimisation runtime saving is 1962.3425006866455ms
2022-09-21 18:52:49 INFO  ---RUNTIME: Multi-Query Optimization took 18.7838077545166 ms
2022-09-21 18:52:49 INFO  Executing generated plans
2022-09-21 18:52:50 INFO  ---RUNTIME: Execution took 444.31257247924805 ms
2022-09-21 18:52:50 INFO  Done!
2022-09-21 18:52:50 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-21 18:52:50 INFO  Running instrumented original pipeline...
2022-09-21 18:52:50 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-21 18:52:50 INFO  ---RUNTIME: Importing and monkey-patching took 6.11424446105957 ms
2022-09-21 18:52:51 INFO  ---RUNTIME: Original pipeline execution took 1553.992748260498 ms (excluding imports and monkey-patching)
2022-09-21 18:52:51 INFO  Starting execution of 1 what-if analyses...
2022-09-21 18:52:51 INFO  Start plan generation for analysis PermutationFeatureImportance...
2022-09-21 18:52:51 INFO  ---RUNTIME: Plan generation took 0.13399124145507812 ms
2022-09-21 18:52:51 INFO  Estimated runtime of original DAG is 291.51082038879395ms
2022-09-21 18:52:51 WARNING Skipping Multi-Query Optimization (instead, only applying patches)
2022-09-21 18:52:51 INFO  Estimated unoptimised what-if runtime is 2332.0865631103516ms
2022-09-21 18:52:51 INFO  ---RUNTIME: Multi-Query Optimization took 6.255149841308594 ms
2022-09-21 18:52:51 INFO  Executing generated plans
2022-09-21 18:52:54 INFO  ---RUNTIME: Execution took 3059.642791748047 ms
2022-09-21 18:52:54 INFO  Done!
2022-09-21 18:52:54 INFO  # Finished -- repetition 6 of 7 
2022-09-21 18:52:54 INFO  # Optimization benchmark for feature_importance with args [['folktables', 'slow_loading', 'featurization_1', 'logistic_regression']] -- repetition 7 of 7
2022-09-21 18:52:54 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-21 18:52:54 INFO  Running instrumented original pipeline...
2022-09-21 18:52:54 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-21 18:52:54 INFO  ---RUNTIME: Importing and monkey-patching took 5.650520324707031 ms
2022-09-21 18:52:56 INFO  ---RUNTIME: Original pipeline execution took 1549.3183135986328 ms (excluding imports and monkey-patching)
2022-09-21 18:52:56 INFO  Starting execution of 1 what-if analyses...
2022-09-21 18:52:56 INFO  Start plan generation for analysis PermutationFeatureImportance...
2022-09-21 18:52:56 INFO  ---RUNTIME: Plan generation took 0.12302398681640625 ms
2022-09-21 18:52:56 INFO  Estimated runtime of original DAG is 311.08760833740234ms
2022-09-21 18:52:56 INFO  Performing Multi-Query Optimization
2022-09-21 18:52:56 INFO  Estimated unoptimized what-if runtime is 2488.7008666992188ms
2022-09-21 18:52:56 INFO  Estimated optimised what-if runtime is 365.3838634490967ms
2022-09-21 18:52:56 INFO  Estimated optimisation runtime saving is 2123.317003250122ms
2022-09-21 18:52:56 INFO  ---RUNTIME: Multi-Query Optimization took 17.14158058166504 ms
2022-09-21 18:52:56 INFO  Executing generated plans
2022-09-21 18:52:56 INFO  ---RUNTIME: Execution took 452.36968994140625 ms
2022-09-21 18:52:56 INFO  Done!
2022-09-21 18:52:56 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-21 18:52:56 INFO  Running instrumented original pipeline...
2022-09-21 18:52:56 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-21 18:52:56 INFO  ---RUNTIME: Importing and monkey-patching took 5.647182464599609 ms
2022-09-21 18:52:58 INFO  ---RUNTIME: Original pipeline execution took 1550.3690242767334 ms (excluding imports and monkey-patching)
2022-09-21 18:52:58 INFO  Starting execution of 1 what-if analyses...
2022-09-21 18:52:58 INFO  Start plan generation for analysis PermutationFeatureImportance...
2022-09-21 18:52:58 INFO  ---RUNTIME: Plan generation took 0.12087821960449219 ms
2022-09-21 18:52:58 INFO  Estimated runtime of original DAG is 290.49038887023926ms
2022-09-21 18:52:58 WARNING Skipping Multi-Query Optimization (instead, only applying patches)
2022-09-21 18:52:58 INFO  Estimated unoptimised what-if runtime is 2323.923110961914ms
2022-09-21 18:52:58 INFO  ---RUNTIME: Multi-Query Optimization took 5.662679672241211 ms
2022-09-21 18:52:58 INFO  Executing generated plans
2022-09-21 18:53:01 INFO  ---RUNTIME: Execution took 3167.9646968841553 ms
2022-09-21 18:53:01 INFO  Done!
2022-09-21 18:53:01 INFO  # Finished -- repetition 7 of 7 
2022-09-21 18:53:01 INFO  # Final results after all repetitions
2022-09-21 18:53:01 INFO     repetition  ... no_opt_what_if_execution_combined_model_training
0           0  ...                                       494.603872
1           1  ...                                       496.598482
2           2  ...                                       497.199059
3           3  ...                                       497.869253
4           4  ...                                       501.184940
5           5  ...                                       494.055986
6           6  ...                                       491.078615

[7 rows x 26 columns]
taskset -c 64-71 PROTOCOL_BUFFERS_PYTHON_IMPLEMENTATION=python python3.9 benchmarks_end_to_end.py feature_importance folktables slow_loading featurization_1 xgboost
2022-09-21 18:53:03.794848: W tensorflow/stream_executor/platform/default/dso_loader.cc:64] Could not load dynamic library 'libcudart.so.11.0'; dlerror: libcudart.so.11.0: cannot open shared object file: No such file or directory; LD_LIBRARY_PATH: /home/sgrafbe/mlwhatif/venv/lib/python3.9/site-packages/cv2/../../lib64:
2022-09-21 18:53:03.794886: I tensorflow/stream_executor/cuda/cudart_stub.cc:29] Ignore above cudart dlerror if you do not have a GPU set up on your machine.
2022-09-21 18:53:05 INFO  Patching sys.argv with ['mlwhatif', 'folktables', 'slow_loading', 'featurization_1', 'xgboost']
2022-09-21 18:53:05 INFO  Running instrumented original pipeline...
2022-09-21 18:53:05 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-21 18:53:05 INFO  ---RUNTIME: Importing and monkey-patching took 103.76691818237305 ms
2022-09-21 18:53:07 INFO  ---RUNTIME: Original pipeline execution took 1935.9099864959717 ms (excluding imports and monkey-patching)
2022-09-21 18:53:07 INFO  Starting execution of 0 what-if analyses...
2022-09-21 18:53:07 INFO  Estimated runtime of original DAG is 645.6618309020996ms
2022-09-21 18:53:07 INFO  Performing Multi-Query Optimization
2022-09-21 18:53:07 INFO  Estimated unoptimized what-if runtime is 0ms
2022-09-21 18:53:07 INFO  Estimated optimised what-if runtime is 0ms
2022-09-21 18:53:07 INFO  Estimated optimisation runtime saving is 0ms
2022-09-21 18:53:07 INFO  ---RUNTIME: Multi-Query Optimization took 0.47135353088378906 ms
2022-09-21 18:53:07 INFO  Executing generated plans
2022-09-21 18:53:07 INFO  ---RUNTIME: Execution took 0.01811981201171875 ms
2022-09-21 18:53:07 INFO  Done!
2022-09-21 18:53:07 INFO  # Optimization benchmark for feature_importance with args [['folktables', 'slow_loading', 'featurization_1', 'xgboost']] -- repetition 1 of 7
2022-09-21 18:53:07 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-21 18:53:07 INFO  Running instrumented original pipeline...
2022-09-21 18:53:07 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-21 18:53:07 INFO  ---RUNTIME: Importing and monkey-patching took 5.445241928100586 ms
2022-09-21 18:53:08 INFO  ---RUNTIME: Original pipeline execution took 1839.0743732452393 ms (excluding imports and monkey-patching)
2022-09-21 18:53:08 INFO  Starting execution of 1 what-if analyses...
2022-09-21 18:53:08 INFO  Start plan generation for analysis PermutationFeatureImportance...
2022-09-21 18:53:08 INFO  ---RUNTIME: Plan generation took 0.2529621124267578 ms
2022-09-21 18:53:08 INFO  Estimated runtime of original DAG is 619.2426681518555ms
2022-09-21 18:53:08 INFO  Performing Multi-Query Optimization
2022-09-21 18:53:09 INFO  Estimated unoptimized what-if runtime is 4953.941345214844ms
2022-09-21 18:53:09 INFO  Estimated optimised what-if runtime is 747.534990310669ms
2022-09-21 18:53:09 INFO  Estimated optimisation runtime saving is 4206.406354904175ms
2022-09-21 18:53:09 INFO  ---RUNTIME: Multi-Query Optimization took 16.2811279296875 ms
2022-09-21 18:53:09 INFO  Executing generated plans
2022-09-21 18:53:09 INFO  ---RUNTIME: Execution took 853.5990715026855 ms
2022-09-21 18:53:09 INFO  Done!
2022-09-21 18:53:09 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-21 18:53:09 INFO  Running instrumented original pipeline...
2022-09-21 18:53:10 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-21 18:53:10 INFO  ---RUNTIME: Importing and monkey-patching took 5.579233169555664 ms
2022-09-21 18:53:11 INFO  ---RUNTIME: Original pipeline execution took 2054.7516345977783 ms (excluding imports and monkey-patching)
2022-09-21 18:53:11 INFO  Starting execution of 1 what-if analyses...
2022-09-21 18:53:11 INFO  Start plan generation for analysis PermutationFeatureImportance...
2022-09-21 18:53:11 INFO  ---RUNTIME: Plan generation took 0.2014636993408203 ms
2022-09-21 18:53:11 INFO  Estimated runtime of original DAG is 671.9300746917725ms
2022-09-21 18:53:11 WARNING Skipping Multi-Query Optimization (instead, only applying patches)
2022-09-21 18:53:11 INFO  Estimated unoptimised what-if runtime is 5375.44059753418ms
2022-09-21 18:53:11 INFO  ---RUNTIME: Multi-Query Optimization took 6.173133850097656 ms
2022-09-21 18:53:11 INFO  Executing generated plans
2022-09-21 18:53:17 INFO  ---RUNTIME: Execution took 5816.896915435791 ms
2022-09-21 18:53:17 INFO  Done!
2022-09-21 18:53:17 INFO  # Finished -- repetition 1 of 7 
2022-09-21 18:53:17 INFO  # Optimization benchmark for feature_importance with args [['folktables', 'slow_loading', 'featurization_1', 'xgboost']] -- repetition 2 of 7
2022-09-21 18:53:17 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-21 18:53:17 INFO  Running instrumented original pipeline...
2022-09-21 18:53:17 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-21 18:53:17 INFO  ---RUNTIME: Importing and monkey-patching took 6.029367446899414 ms
2022-09-21 18:53:19 INFO  ---RUNTIME: Original pipeline execution took 1914.1733646392822 ms (excluding imports and monkey-patching)
2022-09-21 18:53:19 INFO  Starting execution of 1 what-if analyses...
2022-09-21 18:53:19 INFO  Start plan generation for analysis PermutationFeatureImportance...
2022-09-21 18:53:19 INFO  ---RUNTIME: Plan generation took 0.1380443572998047 ms
2022-09-21 18:53:19 INFO  Estimated runtime of original DAG is 615.3898239135742ms
2022-09-21 18:53:19 INFO  Performing Multi-Query Optimization
2022-09-21 18:53:19 INFO  Estimated unoptimized what-if runtime is 4923.118591308594ms
2022-09-21 18:53:19 INFO  Estimated optimised what-if runtime is 738.4688854217529ms
2022-09-21 18:53:19 INFO  Estimated optimisation runtime saving is 4184.649705886841ms
2022-09-21 18:53:19 INFO  ---RUNTIME: Multi-Query Optimization took 16.55721664428711 ms
2022-09-21 18:53:19 INFO  Executing generated plans
2022-09-21 18:53:20 INFO  ---RUNTIME: Execution took 847.5143909454346 ms
2022-09-21 18:53:20 INFO  Done!
2022-09-21 18:53:20 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-21 18:53:20 INFO  Running instrumented original pipeline...
2022-09-21 18:53:20 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-21 18:53:20 INFO  ---RUNTIME: Importing and monkey-patching took 5.510568618774414 ms
2022-09-21 18:53:22 INFO  ---RUNTIME: Original pipeline execution took 1946.4037418365479 ms (excluding imports and monkey-patching)
2022-09-21 18:53:22 INFO  Starting execution of 1 what-if analyses...
2022-09-21 18:53:22 INFO  Start plan generation for analysis PermutationFeatureImportance...
2022-09-21 18:53:22 INFO  ---RUNTIME: Plan generation took 0.16355514526367188 ms
2022-09-21 18:53:22 INFO  Estimated runtime of original DAG is 685.3537559509277ms
2022-09-21 18:53:22 WARNING Skipping Multi-Query Optimization (instead, only applying patches)
2022-09-21 18:53:22 INFO  Estimated unoptimised what-if runtime is 5482.830047607422ms
2022-09-21 18:53:22 INFO  ---RUNTIME: Multi-Query Optimization took 6.615877151489258 ms
2022-09-21 18:53:22 INFO  Executing generated plans
2022-09-21 18:53:28 INFO  ---RUNTIME: Execution took 6073.58193397522 ms
2022-09-21 18:53:28 INFO  Done!
2022-09-21 18:53:28 INFO  # Finished -- repetition 2 of 7 
2022-09-21 18:53:28 INFO  # Optimization benchmark for feature_importance with args [['folktables', 'slow_loading', 'featurization_1', 'xgboost']] -- repetition 3 of 7
2022-09-21 18:53:28 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-21 18:53:28 INFO  Running instrumented original pipeline...
2022-09-21 18:53:28 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-21 18:53:28 INFO  ---RUNTIME: Importing and monkey-patching took 7.986545562744141 ms
2022-09-21 18:53:30 INFO  ---RUNTIME: Original pipeline execution took 1950.343132019043 ms (excluding imports and monkey-patching)
2022-09-21 18:53:30 INFO  Starting execution of 1 what-if analyses...
2022-09-21 18:53:30 INFO  Start plan generation for analysis PermutationFeatureImportance...
2022-09-21 18:53:30 INFO  ---RUNTIME: Plan generation took 0.14853477478027344 ms
2022-09-21 18:53:30 INFO  Estimated runtime of original DAG is 662.0640754699707ms
2022-09-21 18:53:30 INFO  Performing Multi-Query Optimization
2022-09-21 18:53:30 INFO  Estimated unoptimized what-if runtime is 5296.512603759766ms
2022-09-21 18:53:30 INFO  Estimated optimised what-if runtime is 781.7239761352539ms
2022-09-21 18:53:30 INFO  Estimated optimisation runtime saving is 4514.788627624512ms
2022-09-21 18:53:30 INFO  ---RUNTIME: Multi-Query Optimization took 16.663074493408203 ms
2022-09-21 18:53:30 INFO  Executing generated plans
2022-09-21 18:53:31 INFO  ---RUNTIME: Execution took 845.7229137420654 ms
2022-09-21 18:53:31 INFO  Done!
2022-09-21 18:53:31 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-21 18:53:31 INFO  Running instrumented original pipeline...
2022-09-21 18:53:31 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-21 18:53:31 INFO  ---RUNTIME: Importing and monkey-patching took 5.507946014404297 ms
2022-09-21 18:53:33 INFO  ---RUNTIME: Original pipeline execution took 1861.2613677978516 ms (excluding imports and monkey-patching)
2022-09-21 18:53:33 INFO  Starting execution of 1 what-if analyses...
2022-09-21 18:53:33 INFO  Start plan generation for analysis PermutationFeatureImportance...
2022-09-21 18:53:33 INFO  ---RUNTIME: Plan generation took 0.156402587890625 ms
2022-09-21 18:53:33 INFO  Estimated runtime of original DAG is 623.9540576934814ms
2022-09-21 18:53:33 WARNING Skipping Multi-Query Optimization (instead, only applying patches)
2022-09-21 18:53:33 INFO  Estimated unoptimised what-if runtime is 4991.632461547852ms
2022-09-21 18:53:33 INFO  ---RUNTIME: Multi-Query Optimization took 5.701780319213867 ms
2022-09-21 18:53:33 INFO  Executing generated plans
2022-09-21 18:53:39 INFO  ---RUNTIME: Execution took 5794.493198394775 ms
2022-09-21 18:53:39 INFO  Done!
2022-09-21 18:53:39 INFO  # Finished -- repetition 3 of 7 
2022-09-21 18:53:39 INFO  # Optimization benchmark for feature_importance with args [['folktables', 'slow_loading', 'featurization_1', 'xgboost']] -- repetition 4 of 7
2022-09-21 18:53:39 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-21 18:53:39 INFO  Running instrumented original pipeline...
2022-09-21 18:53:39 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-21 18:53:39 INFO  ---RUNTIME: Importing and monkey-patching took 6.049156188964844 ms
2022-09-21 18:53:43 INFO  ---RUNTIME: Original pipeline execution took 3968.437433242798 ms (excluding imports and monkey-patching)
2022-09-21 18:53:43 INFO  Starting execution of 1 what-if analyses...
2022-09-21 18:53:43 INFO  Start plan generation for analysis PermutationFeatureImportance...
2022-09-21 18:53:43 INFO  ---RUNTIME: Plan generation took 0.14925003051757812 ms
2022-09-21 18:53:43 INFO  Estimated runtime of original DAG is 2714.555501937866ms
2022-09-21 18:53:43 INFO  Performing Multi-Query Optimization
2022-09-21 18:53:43 INFO  Estimated unoptimized what-if runtime is 21716.44401550293ms
2022-09-21 18:53:43 INFO  Estimated optimised what-if runtime is 2838.637113571167ms
2022-09-21 18:53:43 INFO  Estimated optimisation runtime saving is 18877.806901931763ms
2022-09-21 18:53:43 INFO  ---RUNTIME: Multi-Query Optimization took 17.640113830566406 ms
2022-09-21 18:53:43 INFO  Executing generated plans
2022-09-21 18:53:44 INFO  ---RUNTIME: Execution took 1014.2054557800293 ms
2022-09-21 18:53:44 INFO  Done!
2022-09-21 18:53:44 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-21 18:53:44 INFO  Running instrumented original pipeline...
2022-09-21 18:53:44 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-21 18:53:44 INFO  ---RUNTIME: Importing and monkey-patching took 6.160497665405273 ms
2022-09-21 18:53:46 INFO  ---RUNTIME: Original pipeline execution took 2807.652235031128 ms (excluding imports and monkey-patching)
2022-09-21 18:53:46 INFO  Starting execution of 1 what-if analyses...
2022-09-21 18:53:46 INFO  Start plan generation for analysis PermutationFeatureImportance...
2022-09-21 18:53:46 INFO  ---RUNTIME: Plan generation took 0.13589859008789062 ms
2022-09-21 18:53:46 INFO  Estimated runtime of original DAG is 1567.671775817871ms
2022-09-21 18:53:46 WARNING Skipping Multi-Query Optimization (instead, only applying patches)
2022-09-21 18:53:47 INFO  Estimated unoptimised what-if runtime is 12541.374206542969ms
2022-09-21 18:53:47 INFO  ---RUNTIME: Multi-Query Optimization took 203.58824729919434 ms
2022-09-21 18:53:47 INFO  Executing generated plans
2022-09-21 18:53:53 INFO  ---RUNTIME: Execution took 6079.715251922607 ms
2022-09-21 18:53:53 INFO  Done!
2022-09-21 18:53:53 INFO  # Finished -- repetition 4 of 7 
2022-09-21 18:53:53 INFO  # Optimization benchmark for feature_importance with args [['folktables', 'slow_loading', 'featurization_1', 'xgboost']] -- repetition 5 of 7
2022-09-21 18:53:53 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-21 18:53:53 INFO  Running instrumented original pipeline...
2022-09-21 18:53:53 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-21 18:53:53 INFO  ---RUNTIME: Importing and monkey-patching took 6.05463981628418 ms
2022-09-21 18:53:55 INFO  ---RUNTIME: Original pipeline execution took 1872.2820281982422 ms (excluding imports and monkey-patching)
2022-09-21 18:53:55 INFO  Starting execution of 1 what-if analyses...
2022-09-21 18:53:55 INFO  Start plan generation for analysis PermutationFeatureImportance...
2022-09-21 18:53:55 INFO  ---RUNTIME: Plan generation took 0.13566017150878906 ms
2022-09-21 18:53:55 INFO  Estimated runtime of original DAG is 622.305154800415ms
2022-09-21 18:53:55 INFO  Performing Multi-Query Optimization
2022-09-21 18:53:55 INFO  Estimated unoptimized what-if runtime is 4978.44123840332ms
2022-09-21 18:53:55 INFO  Estimated optimised what-if runtime is 753.2925605773926ms
2022-09-21 18:53:55 INFO  Estimated optimisation runtime saving is 4225.148677825928ms
2022-09-21 18:53:55 INFO  ---RUNTIME: Multi-Query Optimization took 16.236543655395508 ms
2022-09-21 18:53:55 INFO  Executing generated plans
2022-09-21 18:53:56 INFO  ---RUNTIME: Execution took 993.3962821960449 ms
2022-09-21 18:53:56 INFO  Done!
2022-09-21 18:53:56 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-21 18:53:56 INFO  Running instrumented original pipeline...
2022-09-21 18:53:56 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-21 18:53:56 INFO  ---RUNTIME: Importing and monkey-patching took 6.07609748840332 ms
2022-09-21 18:53:58 INFO  ---RUNTIME: Original pipeline execution took 2113.7185096740723 ms (excluding imports and monkey-patching)
2022-09-21 18:53:58 INFO  Starting execution of 1 what-if analyses...
2022-09-21 18:53:58 INFO  Start plan generation for analysis PermutationFeatureImportance...
2022-09-21 18:53:58 INFO  ---RUNTIME: Plan generation took 0.12278556823730469 ms
2022-09-21 18:53:58 INFO  Estimated runtime of original DAG is 832.2327136993408ms
2022-09-21 18:53:58 WARNING Skipping Multi-Query Optimization (instead, only applying patches)
2022-09-21 18:53:58 INFO  Estimated unoptimised what-if runtime is 6657.861709594727ms
2022-09-21 18:53:58 INFO  ---RUNTIME: Multi-Query Optimization took 6.641864776611328 ms
2022-09-21 18:53:58 INFO  Executing generated plans
2022-09-21 18:54:04 INFO  ---RUNTIME: Execution took 5822.426557540894 ms
2022-09-21 18:54:04 INFO  Done!
2022-09-21 18:54:04 INFO  # Finished -- repetition 5 of 7 
2022-09-21 18:54:04 INFO  # Optimization benchmark for feature_importance with args [['folktables', 'slow_loading', 'featurization_1', 'xgboost']] -- repetition 6 of 7
2022-09-21 18:54:04 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-21 18:54:04 INFO  Running instrumented original pipeline...
2022-09-21 18:54:04 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-21 18:54:04 INFO  ---RUNTIME: Importing and monkey-patching took 6.729602813720703 ms
2022-09-21 18:54:05 INFO  ---RUNTIME: Original pipeline execution took 1899.282455444336 ms (excluding imports and monkey-patching)
2022-09-21 18:54:05 INFO  Starting execution of 1 what-if analyses...
2022-09-21 18:54:05 INFO  Start plan generation for analysis PermutationFeatureImportance...
2022-09-21 18:54:05 INFO  ---RUNTIME: Plan generation took 0.1430511474609375 ms
2022-09-21 18:54:05 INFO  Estimated runtime of original DAG is 619.0297603607178ms
2022-09-21 18:54:05 INFO  Performing Multi-Query Optimization
2022-09-21 18:54:05 INFO  Estimated unoptimized what-if runtime is 4952.238082885742ms
2022-09-21 18:54:05 INFO  Estimated optimised what-if runtime is 755.8438777923584ms
2022-09-21 18:54:05 INFO  Estimated optimisation runtime saving is 4196.394205093384ms
2022-09-21 18:54:05 INFO  ---RUNTIME: Multi-Query Optimization took 16.806364059448242 ms
2022-09-21 18:54:05 INFO  Executing generated plans
2022-09-21 18:54:06 INFO  ---RUNTIME: Execution took 869.530439376831 ms
2022-09-21 18:54:06 INFO  Done!
2022-09-21 18:54:06 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-21 18:54:06 INFO  Running instrumented original pipeline...
2022-09-21 18:54:06 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-21 18:54:06 INFO  ---RUNTIME: Importing and monkey-patching took 6.168603897094727 ms
2022-09-21 18:54:08 INFO  ---RUNTIME: Original pipeline execution took 1916.9671535491943 ms (excluding imports and monkey-patching)
2022-09-21 18:54:08 INFO  Starting execution of 1 what-if analyses...
2022-09-21 18:54:08 INFO  Start plan generation for analysis PermutationFeatureImportance...
2022-09-21 18:54:08 INFO  ---RUNTIME: Plan generation took 0.12135505676269531 ms
2022-09-21 18:54:08 INFO  Estimated runtime of original DAG is 647.3934650421143ms
2022-09-21 18:54:08 WARNING Skipping Multi-Query Optimization (instead, only applying patches)
2022-09-21 18:54:08 INFO  Estimated unoptimised what-if runtime is 5179.147720336914ms
2022-09-21 18:54:08 INFO  ---RUNTIME: Multi-Query Optimization took 6.813526153564453 ms
2022-09-21 18:54:08 INFO  Executing generated plans
2022-09-21 18:54:14 INFO  ---RUNTIME: Execution took 5966.19987487793 ms
2022-09-21 18:54:14 INFO  Done!
2022-09-21 18:54:14 INFO  # Finished -- repetition 6 of 7 
2022-09-21 18:54:14 INFO  # Optimization benchmark for feature_importance with args [['folktables', 'slow_loading', 'featurization_1', 'xgboost']] -- repetition 7 of 7
2022-09-21 18:54:14 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-21 18:54:14 INFO  Running instrumented original pipeline...
2022-09-21 18:54:14 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-21 18:54:14 INFO  ---RUNTIME: Importing and monkey-patching took 6.473064422607422 ms
2022-09-21 18:54:16 INFO  ---RUNTIME: Original pipeline execution took 1956.7687511444092 ms (excluding imports and monkey-patching)
2022-09-21 18:54:16 INFO  Starting execution of 1 what-if analyses...
2022-09-21 18:54:16 INFO  Start plan generation for analysis PermutationFeatureImportance...
2022-09-21 18:54:16 INFO  ---RUNTIME: Plan generation took 0.13566017150878906 ms
2022-09-21 18:54:16 INFO  Estimated runtime of original DAG is 658.4103107452393ms
2022-09-21 18:54:16 INFO  Performing Multi-Query Optimization
2022-09-21 18:54:16 INFO  Estimated unoptimized what-if runtime is 5267.282485961914ms
2022-09-21 18:54:16 INFO  Estimated optimised what-if runtime is 779.4971466064453ms
2022-09-21 18:54:16 INFO  Estimated optimisation runtime saving is 4487.785339355469ms
2022-09-21 18:54:16 INFO  ---RUNTIME: Multi-Query Optimization took 16.7543888092041 ms
2022-09-21 18:54:16 INFO  Executing generated plans
2022-09-21 18:54:17 INFO  ---RUNTIME: Execution took 844.4545269012451 ms
2022-09-21 18:54:17 INFO  Done!
2022-09-21 18:54:17 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-21 18:54:17 INFO  Running instrumented original pipeline...
2022-09-21 18:54:17 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-21 18:54:17 INFO  ---RUNTIME: Importing and monkey-patching took 6.605863571166992 ms
2022-09-21 18:54:19 INFO  ---RUNTIME: Original pipeline execution took 2095.456123352051 ms (excluding imports and monkey-patching)
2022-09-21 18:54:19 INFO  Starting execution of 1 what-if analyses...
2022-09-21 18:54:19 INFO  Start plan generation for analysis PermutationFeatureImportance...
2022-09-21 18:54:19 INFO  ---RUNTIME: Plan generation took 0.13184547424316406 ms
2022-09-21 18:54:19 INFO  Estimated runtime of original DAG is 794.3112850189209ms
2022-09-21 18:54:19 WARNING Skipping Multi-Query Optimization (instead, only applying patches)
2022-09-21 18:54:19 INFO  Estimated unoptimised what-if runtime is 6354.490280151367ms
2022-09-21 18:54:19 INFO  ---RUNTIME: Multi-Query Optimization took 5.658864974975586 ms
2022-09-21 18:54:19 INFO  Executing generated plans
2022-09-21 18:54:25 INFO  ---RUNTIME: Execution took 5810.8203411102295 ms
2022-09-21 18:54:25 INFO  Done!
2022-09-21 18:54:25 INFO  # Finished -- repetition 7 of 7 
2022-09-21 18:54:25 INFO  # Final results after all repetitions
2022-09-21 18:54:25 INFO     repetition  ... no_opt_what_if_execution_combined_model_training
0           0  ...                                      3144.075394
1           1  ...                                      3212.417841
2           2  ...                                      3122.074604
3           3  ...                                      3240.386486
4           4  ...                                      3155.116796
5           5  ...                                      3231.283903
6           6  ...                                      3118.092537

[7 rows x 26 columns]
taskset -c 64-71 PROTOCOL_BUFFERS_PYTHON_IMPLEMENTATION=python python3.9 benchmarks_end_to_end.py feature_importance folktables slow_loading featurization_1 neural_network
2022-09-21 18:54:27.584201: W tensorflow/stream_executor/platform/default/dso_loader.cc:64] Could not load dynamic library 'libcudart.so.11.0'; dlerror: libcudart.so.11.0: cannot open shared object file: No such file or directory; LD_LIBRARY_PATH: /home/sgrafbe/mlwhatif/venv/lib/python3.9/site-packages/cv2/../../lib64:
2022-09-21 18:54:27.584236: I tensorflow/stream_executor/cuda/cudart_stub.cc:29] Ignore above cudart dlerror if you do not have a GPU set up on your machine.
2022-09-21 18:54:28 INFO  Patching sys.argv with ['mlwhatif', 'folktables', 'slow_loading', 'featurization_1', 'neural_network']
2022-09-21 18:54:28 INFO  Running instrumented original pipeline...
2022-09-21 18:54:28 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-21 18:54:29 INFO  ---RUNTIME: Importing and monkey-patching took 99.4713306427002 ms
2022-09-21 18:54:30.391825: W tensorflow/stream_executor/platform/default/dso_loader.cc:64] Could not load dynamic library 'libcuda.so.1'; dlerror: libcuda.so.1: cannot open shared object file: No such file or directory; LD_LIBRARY_PATH: /home/sgrafbe/mlwhatif/venv/lib/python3.9/site-packages/cv2/../../lib64:
2022-09-21 18:54:30.391857: W tensorflow/stream_executor/cuda/cuda_driver.cc:326] failed call to cuInit: UNKNOWN ERROR (303)
2022-09-21 18:54:30.391875: I tensorflow/stream_executor/cuda/cuda_diagnostics.cc:156] kernel driver does not appear to be running on this host (wagyu): /proc/driver/nvidia/version does not exist
2022-09-21 18:54:30.392236: I tensorflow/core/platform/cpu_feature_guard.cc:142] This TensorFlow binary is optimized with oneAPI Deep Neural Network Library (oneDNN) to use the following CPU instructions in performance-critical operations:  AVX2 FMA
To enable them in other operations, rebuild TensorFlow with the appropriate compiler flags.
2022-09-21 18:54:30.939189: I tensorflow/compiler/mlir/mlir_graph_optimization_pass.cc:176] None of the MLIR Optimization Passes are enabled (registered 2)
2022-09-21 18:54:30.953368: I tensorflow/core/platform/profile_utils/cpu_utils.cc:114] CPU Frequency: 2595290000 Hz
2022-09-21 18:54:34 INFO  ---RUNTIME: Original pipeline execution took 5498.373746871948 ms (excluding imports and monkey-patching)
2022-09-21 18:54:34 INFO  Starting execution of 0 what-if analyses...
2022-09-21 18:54:34 INFO  Estimated runtime of original DAG is 4245.573997497559ms
2022-09-21 18:54:34 INFO  Performing Multi-Query Optimization
2022-09-21 18:54:34 INFO  Estimated unoptimized what-if runtime is 0ms
2022-09-21 18:54:34 INFO  Estimated optimised what-if runtime is 0ms
2022-09-21 18:54:34 INFO  Estimated optimisation runtime saving is 0ms
2022-09-21 18:54:34 INFO  ---RUNTIME: Multi-Query Optimization took 0.5457401275634766 ms
2022-09-21 18:54:34 INFO  Executing generated plans
2022-09-21 18:54:34 INFO  ---RUNTIME: Execution took 0.024557113647460938 ms
2022-09-21 18:54:34 INFO  Done!
2022-09-21 18:54:34 INFO  # Optimization benchmark for feature_importance with args [['folktables', 'slow_loading', 'featurization_1', 'neural_network']] -- repetition 1 of 7
2022-09-21 18:54:34 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-21 18:54:34 INFO  Running instrumented original pipeline...
2022-09-21 18:54:34 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-21 18:54:34 INFO  ---RUNTIME: Importing and monkey-patching took 5.530834197998047 ms
2022-09-21 18:54:39 INFO  ---RUNTIME: Original pipeline execution took 5368.880987167358 ms (excluding imports and monkey-patching)
2022-09-21 18:54:39 INFO  Starting execution of 1 what-if analyses...
2022-09-21 18:54:39 INFO  Start plan generation for analysis PermutationFeatureImportance...
2022-09-21 18:54:39 INFO  ---RUNTIME: Plan generation took 0.274658203125 ms
2022-09-21 18:54:39 INFO  Estimated runtime of original DAG is 4086.026191711426ms
2022-09-21 18:54:39 INFO  Performing Multi-Query Optimization
2022-09-21 18:54:39 INFO  Estimated unoptimized what-if runtime is 32688.209533691406ms
2022-09-21 18:54:39 INFO  Estimated optimised what-if runtime is 5244.065999984741ms
2022-09-21 18:54:39 INFO  Estimated optimisation runtime saving is 27444.143533706665ms
2022-09-21 18:54:39 INFO  ---RUNTIME: Multi-Query Optimization took 17.033815383911133 ms
2022-09-21 18:54:39 INFO  Executing generated plans
2022-09-21 18:54:44 INFO  ---RUNTIME: Execution took 5041.736841201782 ms
2022-09-21 18:54:44 INFO  Done!
2022-09-21 18:54:44 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-21 18:54:44 INFO  Running instrumented original pipeline...
2022-09-21 18:54:44 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-21 18:54:44 INFO  ---RUNTIME: Importing and monkey-patching took 5.982637405395508 ms
2022-09-21 18:54:50 INFO  ---RUNTIME: Original pipeline execution took 5518.539667129517 ms (excluding imports and monkey-patching)
2022-09-21 18:54:50 INFO  Starting execution of 1 what-if analyses...
2022-09-21 18:54:50 INFO  Start plan generation for analysis PermutationFeatureImportance...
2022-09-21 18:54:50 INFO  ---RUNTIME: Plan generation took 0.14138221740722656 ms
2022-09-21 18:54:50 INFO  Estimated runtime of original DAG is 4226.558446884155ms
2022-09-21 18:54:50 WARNING Skipping Multi-Query Optimization (instead, only applying patches)
2022-09-21 18:54:50 INFO  Estimated unoptimised what-if runtime is 33812.46757507324ms
2022-09-21 18:54:50 INFO  ---RUNTIME: Multi-Query Optimization took 5.767345428466797 ms
2022-09-21 18:54:50 INFO  Executing generated plans
2022-09-21 18:55:24 INFO  ---RUNTIME: Execution took 33771.485567092896 ms
2022-09-21 18:55:24 INFO  Done!
2022-09-21 18:55:24 INFO  # Finished -- repetition 1 of 7 
2022-09-21 18:55:24 INFO  # Optimization benchmark for feature_importance with args [['folktables', 'slow_loading', 'featurization_1', 'neural_network']] -- repetition 2 of 7
2022-09-21 18:55:24 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-21 18:55:24 INFO  Running instrumented original pipeline...
2022-09-21 18:55:24 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-21 18:55:24 INFO  ---RUNTIME: Importing and monkey-patching took 6.201982498168945 ms
2022-09-21 18:55:29 INFO  ---RUNTIME: Original pipeline execution took 5313.253402709961 ms (excluding imports and monkey-patching)
2022-09-21 18:55:29 INFO  Starting execution of 1 what-if analyses...
2022-09-21 18:55:29 INFO  Start plan generation for analysis PermutationFeatureImportance...
2022-09-21 18:55:29 INFO  ---RUNTIME: Plan generation took 0.14495849609375 ms
2022-09-21 18:55:29 INFO  Estimated runtime of original DAG is 4035.1572036743164ms
2022-09-21 18:55:29 INFO  Performing Multi-Query Optimization
2022-09-21 18:55:29 INFO  Estimated unoptimized what-if runtime is 32281.25762939453ms
2022-09-21 18:55:29 INFO  Estimated optimised what-if runtime is 5187.042236328125ms
2022-09-21 18:55:29 INFO  Estimated optimisation runtime saving is 27094.215393066406ms
2022-09-21 18:55:29 INFO  ---RUNTIME: Multi-Query Optimization took 16.20316505432129 ms
2022-09-21 18:55:29 INFO  Executing generated plans
2022-09-21 18:55:34 INFO  ---RUNTIME: Execution took 5230.560779571533 ms
2022-09-21 18:55:34 INFO  Done!
2022-09-21 18:55:34 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-21 18:55:34 INFO  Running instrumented original pipeline...
2022-09-21 18:55:34 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-21 18:55:34 INFO  ---RUNTIME: Importing and monkey-patching took 6.114482879638672 ms
2022-09-21 18:55:40 INFO  ---RUNTIME: Original pipeline execution took 5343.690633773804 ms (excluding imports and monkey-patching)
2022-09-21 18:55:40 INFO  Starting execution of 1 what-if analyses...
2022-09-21 18:55:40 INFO  Start plan generation for analysis PermutationFeatureImportance...
2022-09-21 18:55:40 INFO  ---RUNTIME: Plan generation took 0.14472007751464844 ms
2022-09-21 18:55:40 INFO  Estimated runtime of original DAG is 4054.1810989379883ms
2022-09-21 18:55:40 WARNING Skipping Multi-Query Optimization (instead, only applying patches)
2022-09-21 18:55:40 INFO  Estimated unoptimised what-if runtime is 32433.448791503906ms
2022-09-21 18:55:40 INFO  ---RUNTIME: Multi-Query Optimization took 6.29425048828125 ms
2022-09-21 18:55:40 INFO  Executing generated plans
2022-09-21 18:56:13 INFO  ---RUNTIME: Execution took 33243.83640289307 ms
2022-09-21 18:56:13 INFO  Done!
2022-09-21 18:56:13 INFO  # Finished -- repetition 2 of 7 
2022-09-21 18:56:13 INFO  # Optimization benchmark for feature_importance with args [['folktables', 'slow_loading', 'featurization_1', 'neural_network']] -- repetition 3 of 7
2022-09-21 18:56:13 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-21 18:56:13 INFO  Running instrumented original pipeline...
2022-09-21 18:56:13 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-21 18:56:13 INFO  ---RUNTIME: Importing and monkey-patching took 6.694316864013672 ms
2022-09-21 18:56:18 INFO  ---RUNTIME: Original pipeline execution took 5522.879838943481 ms (excluding imports and monkey-patching)
2022-09-21 18:56:18 INFO  Starting execution of 1 what-if analyses...
2022-09-21 18:56:18 INFO  Start plan generation for analysis PermutationFeatureImportance...
2022-09-21 18:56:18 INFO  ---RUNTIME: Plan generation took 0.14352798461914062 ms
2022-09-21 18:56:18 INFO  Estimated runtime of original DAG is 4233.607530593872ms
2022-09-21 18:56:18 INFO  Performing Multi-Query Optimization
2022-09-21 18:56:18 INFO  Estimated unoptimized what-if runtime is 33868.86024475098ms
2022-09-21 18:56:18 INFO  Estimated optimised what-if runtime is 5522.832870483398ms
2022-09-21 18:56:18 INFO  Estimated optimisation runtime saving is 28346.027374267578ms
2022-09-21 18:56:18 INFO  ---RUNTIME: Multi-Query Optimization took 17.758607864379883 ms
2022-09-21 18:56:18 INFO  Executing generated plans
2022-09-21 18:56:24 INFO  ---RUNTIME: Execution took 5287.077903747559 ms
2022-09-21 18:56:24 INFO  Done!
2022-09-21 18:56:24 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-21 18:56:24 INFO  Running instrumented original pipeline...
2022-09-21 18:56:24 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-21 18:56:24 INFO  ---RUNTIME: Importing and monkey-patching took 6.61778450012207 ms
2022-09-21 18:56:29 INFO  ---RUNTIME: Original pipeline execution took 5343.225955963135 ms (excluding imports and monkey-patching)
2022-09-21 18:56:29 INFO  Starting execution of 1 what-if analyses...
2022-09-21 18:56:29 INFO  Start plan generation for analysis PermutationFeatureImportance...
2022-09-21 18:56:29 INFO  ---RUNTIME: Plan generation took 0.13518333435058594 ms
2022-09-21 18:56:29 INFO  Estimated runtime of original DAG is 4058.263063430786ms
2022-09-21 18:56:29 WARNING Skipping Multi-Query Optimization (instead, only applying patches)
2022-09-21 18:56:29 INFO  Estimated unoptimised what-if runtime is 32466.10450744629ms
2022-09-21 18:56:29 INFO  ---RUNTIME: Multi-Query Optimization took 5.6133270263671875 ms
2022-09-21 18:56:29 INFO  Executing generated plans
2022-09-21 18:57:02 INFO  ---RUNTIME: Execution took 33365.87858200073 ms
2022-09-21 18:57:02 INFO  Done!
2022-09-21 18:57:02 INFO  # Finished -- repetition 3 of 7 
2022-09-21 18:57:02 INFO  # Optimization benchmark for feature_importance with args [['folktables', 'slow_loading', 'featurization_1', 'neural_network']] -- repetition 4 of 7
2022-09-21 18:57:02 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-21 18:57:02 INFO  Running instrumented original pipeline...
2022-09-21 18:57:03 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-21 18:57:03 INFO  ---RUNTIME: Importing and monkey-patching took 6.799936294555664 ms
2022-09-21 18:57:08 INFO  ---RUNTIME: Original pipeline execution took 5195.725679397583 ms (excluding imports and monkey-patching)
2022-09-21 18:57:08 INFO  Starting execution of 1 what-if analyses...
2022-09-21 18:57:08 INFO  Start plan generation for analysis PermutationFeatureImportance...
2022-09-21 18:57:08 INFO  ---RUNTIME: Plan generation took 0.14090538024902344 ms
2022-09-21 18:57:08 INFO  Estimated runtime of original DAG is 3947.9880332946777ms
2022-09-21 18:57:08 INFO  Performing Multi-Query Optimization
2022-09-21 18:57:08 INFO  Estimated unoptimized what-if runtime is 31583.904266357422ms
2022-09-21 18:57:08 INFO  Estimated optimised what-if runtime is 5177.265882492065ms
2022-09-21 18:57:08 INFO  Estimated optimisation runtime saving is 26406.638383865356ms
2022-09-21 18:57:08 INFO  ---RUNTIME: Multi-Query Optimization took 18.17488670349121 ms
2022-09-21 18:57:08 INFO  Executing generated plans
2022-09-21 18:57:13 INFO  ---RUNTIME: Execution took 5227.077960968018 ms
2022-09-21 18:57:13 INFO  Done!
2022-09-21 18:57:13 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-21 18:57:13 INFO  Running instrumented original pipeline...
2022-09-21 18:57:13 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-21 18:57:13 INFO  ---RUNTIME: Importing and monkey-patching took 5.896806716918945 ms
2022-09-21 18:57:18 INFO  ---RUNTIME: Original pipeline execution took 5405.7776927948 ms (excluding imports and monkey-patching)
2022-09-21 18:57:18 INFO  Starting execution of 1 what-if analyses...
2022-09-21 18:57:18 INFO  Start plan generation for analysis PermutationFeatureImportance...
2022-09-21 18:57:18 INFO  ---RUNTIME: Plan generation took 0.12826919555664062 ms
2022-09-21 18:57:18 INFO  Estimated runtime of original DAG is 4117.332935333252ms
2022-09-21 18:57:18 WARNING Skipping Multi-Query Optimization (instead, only applying patches)
2022-09-21 18:57:18 INFO  Estimated unoptimised what-if runtime is 32938.663482666016ms
2022-09-21 18:57:18 INFO  ---RUNTIME: Multi-Query Optimization took 5.712032318115234 ms
2022-09-21 18:57:18 INFO  Executing generated plans
2022-09-21 18:57:52 INFO  ---RUNTIME: Execution took 33906.56757354736 ms
2022-09-21 18:57:52 INFO  Done!
2022-09-21 18:57:52 INFO  # Finished -- repetition 4 of 7 
2022-09-21 18:57:52 INFO  # Optimization benchmark for feature_importance with args [['folktables', 'slow_loading', 'featurization_1', 'neural_network']] -- repetition 5 of 7
2022-09-21 18:57:52 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-21 18:57:52 INFO  Running instrumented original pipeline...
2022-09-21 18:57:52 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-21 18:57:52 INFO  ---RUNTIME: Importing and monkey-patching took 5.876779556274414 ms
2022-09-21 18:57:58 INFO  ---RUNTIME: Original pipeline execution took 5287.916421890259 ms (excluding imports and monkey-patching)
2022-09-21 18:57:58 INFO  Starting execution of 1 what-if analyses...
2022-09-21 18:57:58 INFO  Start plan generation for analysis PermutationFeatureImportance...
2022-09-21 18:57:58 INFO  ---RUNTIME: Plan generation took 0.12946128845214844 ms
2022-09-21 18:57:58 INFO  Estimated runtime of original DAG is 4058.187961578369ms
2022-09-21 18:57:58 INFO  Performing Multi-Query Optimization
2022-09-21 18:57:58 INFO  Estimated unoptimized what-if runtime is 32465.503692626953ms
2022-09-21 18:57:58 INFO  Estimated optimised what-if runtime is 5243.973970413208ms
2022-09-21 18:57:58 INFO  Estimated optimisation runtime saving is 27221.529722213745ms
2022-09-21 18:57:58 INFO  ---RUNTIME: Multi-Query Optimization took 17.180442810058594 ms
2022-09-21 18:57:58 INFO  Executing generated plans
2022-09-21 18:58:03 INFO  ---RUNTIME: Execution took 5316.395998001099 ms
2022-09-21 18:58:03 INFO  Done!
2022-09-21 18:58:03 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-21 18:58:03 INFO  Running instrumented original pipeline...
2022-09-21 18:58:03 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-21 18:58:03 INFO  ---RUNTIME: Importing and monkey-patching took 6.35528564453125 ms
2022-09-21 18:58:08 INFO  ---RUNTIME: Original pipeline execution took 5296.898365020752 ms (excluding imports and monkey-patching)
2022-09-21 18:58:08 INFO  Starting execution of 1 what-if analyses...
2022-09-21 18:58:08 INFO  Start plan generation for analysis PermutationFeatureImportance...
2022-09-21 18:58:08 INFO  ---RUNTIME: Plan generation took 0.1316070556640625 ms
2022-09-21 18:58:08 INFO  Estimated runtime of original DAG is 4054.9659729003906ms
2022-09-21 18:58:08 WARNING Skipping Multi-Query Optimization (instead, only applying patches)
2022-09-21 18:58:08 INFO  Estimated unoptimised what-if runtime is 32439.727783203125ms
2022-09-21 18:58:08 INFO  ---RUNTIME: Multi-Query Optimization took 6.384849548339844 ms
2022-09-21 18:58:08 INFO  Executing generated plans
2022-09-21 18:58:40 INFO  ---RUNTIME: Execution took 31802.622079849243 ms
2022-09-21 18:58:40 INFO  Done!
2022-09-21 18:58:40 INFO  # Finished -- repetition 5 of 7 
2022-09-21 18:58:40 INFO  # Optimization benchmark for feature_importance with args [['folktables', 'slow_loading', 'featurization_1', 'neural_network']] -- repetition 6 of 7
2022-09-21 18:58:40 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-21 18:58:40 INFO  Running instrumented original pipeline...
2022-09-21 18:58:40 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-21 18:58:40 INFO  ---RUNTIME: Importing and monkey-patching took 5.727052688598633 ms
2022-09-21 18:58:45 INFO  ---RUNTIME: Original pipeline execution took 4962.453603744507 ms (excluding imports and monkey-patching)
2022-09-21 18:58:45 INFO  Starting execution of 1 what-if analyses...
2022-09-21 18:58:45 INFO  Start plan generation for analysis PermutationFeatureImportance...
2022-09-21 18:58:45 INFO  ---RUNTIME: Plan generation took 0.12421607971191406 ms
2022-09-21 18:58:45 INFO  Estimated runtime of original DAG is 3743.3950901031494ms
2022-09-21 18:58:45 INFO  Performing Multi-Query Optimization
2022-09-21 18:58:45 INFO  Estimated unoptimized what-if runtime is 29947.160720825195ms
2022-09-21 18:58:45 INFO  Estimated optimised what-if runtime is 4921.182632446289ms
2022-09-21 18:58:45 INFO  Estimated optimisation runtime saving is 25025.978088378906ms
2022-09-21 18:58:45 INFO  ---RUNTIME: Multi-Query Optimization took 16.74509048461914 ms
2022-09-21 18:58:45 INFO  Executing generated plans
2022-09-21 18:58:50 INFO  ---RUNTIME: Execution took 4573.551654815674 ms
2022-09-21 18:58:50 INFO  Done!
2022-09-21 18:58:50 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-21 18:58:50 INFO  Running instrumented original pipeline...
2022-09-21 18:58:50 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-21 18:58:50 INFO  ---RUNTIME: Importing and monkey-patching took 5.978584289550781 ms
2022-09-21 18:58:55 INFO  ---RUNTIME: Original pipeline execution took 5366.081237792969 ms (excluding imports and monkey-patching)
2022-09-21 18:58:55 INFO  Starting execution of 1 what-if analyses...
2022-09-21 18:58:55 INFO  Start plan generation for analysis PermutationFeatureImportance...
2022-09-21 18:58:55 INFO  ---RUNTIME: Plan generation took 0.1239776611328125 ms
2022-09-21 18:58:55 INFO  Estimated runtime of original DAG is 4145.087718963623ms
2022-09-21 18:58:55 WARNING Skipping Multi-Query Optimization (instead, only applying patches)
2022-09-21 18:58:55 INFO  Estimated unoptimised what-if runtime is 33160.701751708984ms
2022-09-21 18:58:55 INFO  ---RUNTIME: Multi-Query Optimization took 5.674123764038086 ms
2022-09-21 18:58:55 INFO  Executing generated plans
2022-09-21 18:59:26 INFO  ---RUNTIME: Execution took 30998.338222503662 ms
2022-09-21 18:59:26 INFO  Done!
2022-09-21 18:59:26 INFO  # Finished -- repetition 6 of 7 
2022-09-21 18:59:26 INFO  # Optimization benchmark for feature_importance with args [['folktables', 'slow_loading', 'featurization_1', 'neural_network']] -- repetition 7 of 7
2022-09-21 18:59:26 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-21 18:59:26 INFO  Running instrumented original pipeline...
2022-09-21 18:59:26 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-21 18:59:26 INFO  ---RUNTIME: Importing and monkey-patching took 5.764245986938477 ms
2022-09-21 18:59:31 INFO  ---RUNTIME: Original pipeline execution took 4903.8238525390625 ms (excluding imports and monkey-patching)
2022-09-21 18:59:31 INFO  Starting execution of 1 what-if analyses...
2022-09-21 18:59:31 INFO  Start plan generation for analysis PermutationFeatureImportance...
2022-09-21 18:59:31 INFO  ---RUNTIME: Plan generation took 0.13494491577148438 ms
2022-09-21 18:59:31 INFO  Estimated runtime of original DAG is 3676.0804653167725ms
2022-09-21 18:59:31 INFO  Performing Multi-Query Optimization
2022-09-21 18:59:31 INFO  Estimated unoptimized what-if runtime is 29408.64372253418ms
2022-09-21 18:59:31 INFO  Estimated optimised what-if runtime is 4829.184055328369ms
2022-09-21 18:59:31 INFO  Estimated optimisation runtime saving is 24579.45966720581ms
2022-09-21 18:59:31 INFO  ---RUNTIME: Multi-Query Optimization took 17.369508743286133 ms
2022-09-21 18:59:31 INFO  Executing generated plans
2022-09-21 18:59:35 INFO  ---RUNTIME: Execution took 4585.144996643066 ms
2022-09-21 18:59:35 INFO  Done!
2022-09-21 18:59:35 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-21 18:59:35 INFO  Running instrumented original pipeline...
2022-09-21 18:59:36 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-21 18:59:36 INFO  ---RUNTIME: Importing and monkey-patching took 5.607843399047852 ms
2022-09-21 18:59:40 INFO  ---RUNTIME: Original pipeline execution took 4903.037548065186 ms (excluding imports and monkey-patching)
2022-09-21 18:59:40 INFO  Starting execution of 1 what-if analyses...
2022-09-21 18:59:40 INFO  Start plan generation for analysis PermutationFeatureImportance...
2022-09-21 18:59:40 INFO  ---RUNTIME: Plan generation took 0.1709461212158203 ms
2022-09-21 18:59:40 INFO  Estimated runtime of original DAG is 3676.9745349884033ms
2022-09-21 18:59:40 WARNING Skipping Multi-Query Optimization (instead, only applying patches)
2022-09-21 18:59:40 INFO  Estimated unoptimised what-if runtime is 29415.796279907227ms
2022-09-21 18:59:40 INFO  ---RUNTIME: Multi-Query Optimization took 6.429195404052734 ms
2022-09-21 18:59:40 INFO  Executing generated plans
2022-09-21 19:00:13 INFO  ---RUNTIME: Execution took 32535.120248794556 ms
2022-09-21 19:00:13 INFO  Done!
2022-09-21 19:00:13 INFO  # Finished -- repetition 7 of 7 
2022-09-21 19:00:13 INFO  # Final results after all repetitions
2022-09-21 19:00:13 INFO     repetition  ... no_opt_what_if_execution_combined_model_training
0           0  ...                                     29560.228348
1           1  ...                                     28773.713589
2           2  ...                                     29236.535549
3           3  ...                                     29431.043863
4           4  ...                                     27922.701359
5           5  ...                                     27143.836975
6           6  ...                                     28087.148905

[7 rows x 26 columns]
taskset -c 64-71 PROTOCOL_BUFFERS_PYTHON_IMPLEMENTATION=python python3.9 benchmarks_end_to_end.py feature_importance folktables slow_loading featurization_2 logistic_regression
2022-09-21 19:00:16.044061: W tensorflow/stream_executor/platform/default/dso_loader.cc:64] Could not load dynamic library 'libcudart.so.11.0'; dlerror: libcudart.so.11.0: cannot open shared object file: No such file or directory; LD_LIBRARY_PATH: /home/sgrafbe/mlwhatif/venv/lib/python3.9/site-packages/cv2/../../lib64:
2022-09-21 19:00:16.044100: I tensorflow/stream_executor/cuda/cudart_stub.cc:29] Ignore above cudart dlerror if you do not have a GPU set up on your machine.
2022-09-21 19:00:17 INFO  Patching sys.argv with ['mlwhatif', 'folktables', 'slow_loading', 'featurization_2', 'logistic_regression']
2022-09-21 19:00:17 INFO  Running instrumented original pipeline...
2022-09-21 19:00:17 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-21 19:00:17 INFO  ---RUNTIME: Importing and monkey-patching took 95.28279304504395 ms
2022-09-21 19:00:18 INFO  ---RUNTIME: Original pipeline execution took 1386.2738609313965 ms (excluding imports and monkey-patching)
2022-09-21 19:00:18 INFO  Starting execution of 0 what-if analyses...
2022-09-21 19:00:18 INFO  Estimated runtime of original DAG is 1111.34934425354ms
2022-09-21 19:00:18 INFO  Performing Multi-Query Optimization
2022-09-21 19:00:18 INFO  Estimated unoptimized what-if runtime is 0ms
2022-09-21 19:00:18 INFO  Estimated optimised what-if runtime is 0ms
2022-09-21 19:00:18 INFO  Estimated optimisation runtime saving is 0ms
2022-09-21 19:00:18 INFO  ---RUNTIME: Multi-Query Optimization took 0.47588348388671875 ms
2022-09-21 19:00:18 INFO  Executing generated plans
2022-09-21 19:00:18 INFO  ---RUNTIME: Execution took 0.020742416381835938 ms
2022-09-21 19:00:18 INFO  Done!
2022-09-21 19:00:18 INFO  # Optimization benchmark for feature_importance with args [['folktables', 'slow_loading', 'featurization_2', 'logistic_regression']] -- repetition 1 of 7
2022-09-21 19:00:18 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-21 19:00:18 INFO  Running instrumented original pipeline...
2022-09-21 19:00:18 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-21 19:00:18 INFO  ---RUNTIME: Importing and monkey-patching took 5.292654037475586 ms
2022-09-21 19:00:20 INFO  ---RUNTIME: Original pipeline execution took 1404.4179916381836 ms (excluding imports and monkey-patching)
2022-09-21 19:00:20 INFO  Starting execution of 1 what-if analyses...
2022-09-21 19:00:20 INFO  Start plan generation for analysis PermutationFeatureImportance...
2022-09-21 19:00:20 INFO  ---RUNTIME: Plan generation took 0.36787986755371094 ms
2022-09-21 19:00:20 INFO  Estimated runtime of original DAG is 1154.453992843628ms
2022-09-21 19:00:20 INFO  Performing Multi-Query Optimization
2022-09-21 19:00:20 INFO  Estimated unoptimized what-if runtime is 9235.631942749023ms
2022-09-21 19:00:20 INFO  Estimated optimised what-if runtime is 1197.8754997253418ms
2022-09-21 19:00:20 INFO  Estimated optimisation runtime saving is 8037.756443023682ms
2022-09-21 19:00:20 INFO  ---RUNTIME: Multi-Query Optimization took 21.523714065551758 ms
2022-09-21 19:00:20 INFO  Executing generated plans
2022-09-21 19:00:21 INFO  ---RUNTIME: Execution took 1141.58034324646 ms
2022-09-21 19:00:21 INFO  Done!
2022-09-21 19:00:21 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-21 19:00:21 INFO  Running instrumented original pipeline...
2022-09-21 19:00:21 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-21 19:00:21 INFO  ---RUNTIME: Importing and monkey-patching took 5.9185028076171875 ms
2022-09-21 19:00:22 INFO  ---RUNTIME: Original pipeline execution took 1574.6855735778809 ms (excluding imports and monkey-patching)
2022-09-21 19:00:22 INFO  Starting execution of 1 what-if analyses...
2022-09-21 19:00:22 INFO  Start plan generation for analysis PermutationFeatureImportance...
2022-09-21 19:00:22 INFO  ---RUNTIME: Plan generation took 0.1380443572998047 ms
2022-09-21 19:00:22 INFO  Estimated runtime of original DAG is 1135.2179050445557ms
2022-09-21 19:00:22 WARNING Skipping Multi-Query Optimization (instead, only applying patches)
2022-09-21 19:00:22 INFO  Estimated unoptimised what-if runtime is 9081.743240356445ms
2022-09-21 19:00:22 INFO  ---RUNTIME: Multi-Query Optimization took 7.801055908203125 ms
2022-09-21 19:00:22 INFO  Executing generated plans
2022-09-21 19:00:32 INFO  ---RUNTIME: Execution took 9253.71789932251 ms
2022-09-21 19:00:32 INFO  Done!
2022-09-21 19:00:32 INFO  # Finished -- repetition 1 of 7 
2022-09-21 19:00:32 INFO  # Optimization benchmark for feature_importance with args [['folktables', 'slow_loading', 'featurization_2', 'logistic_regression']] -- repetition 2 of 7
2022-09-21 19:00:32 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-21 19:00:32 INFO  Running instrumented original pipeline...
2022-09-21 19:00:32 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-21 19:00:32 INFO  ---RUNTIME: Importing and monkey-patching took 5.898475646972656 ms
2022-09-21 19:00:33 INFO  ---RUNTIME: Original pipeline execution took 1302.0522594451904 ms (excluding imports and monkey-patching)
2022-09-21 19:00:33 INFO  Starting execution of 1 what-if analyses...
2022-09-21 19:00:33 INFO  Start plan generation for analysis PermutationFeatureImportance...
2022-09-21 19:00:33 INFO  ---RUNTIME: Plan generation took 0.19121170043945312 ms
2022-09-21 19:00:33 INFO  Estimated runtime of original DAG is 1054.9194812774658ms
2022-09-21 19:00:33 INFO  Performing Multi-Query Optimization
2022-09-21 19:00:33 INFO  Estimated unoptimized what-if runtime is 8439.355850219727ms
2022-09-21 19:00:33 INFO  Estimated optimised what-if runtime is 1090.8911228179932ms
2022-09-21 19:00:33 INFO  Estimated optimisation runtime saving is 7348.464727401733ms
2022-09-21 19:00:33 INFO  ---RUNTIME: Multi-Query Optimization took 17.417430877685547 ms
2022-09-21 19:00:33 INFO  Executing generated plans
2022-09-21 19:00:34 INFO  ---RUNTIME: Execution took 1185.2469444274902 ms
2022-09-21 19:00:34 INFO  Done!
2022-09-21 19:00:34 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-21 19:00:34 INFO  Running instrumented original pipeline...
2022-09-21 19:00:34 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-21 19:00:34 INFO  ---RUNTIME: Importing and monkey-patching took 5.607366561889648 ms
2022-09-21 19:00:36 INFO  ---RUNTIME: Original pipeline execution took 1306.9696426391602 ms (excluding imports and monkey-patching)
2022-09-21 19:00:36 INFO  Starting execution of 1 what-if analyses...
2022-09-21 19:00:36 INFO  Start plan generation for analysis PermutationFeatureImportance...
2022-09-21 19:00:36 INFO  ---RUNTIME: Plan generation took 0.18262863159179688 ms
2022-09-21 19:00:36 INFO  Estimated runtime of original DAG is 1053.772211074829ms
2022-09-21 19:00:36 WARNING Skipping Multi-Query Optimization (instead, only applying patches)
2022-09-21 19:00:36 INFO  Estimated unoptimised what-if runtime is 8430.177688598633ms
2022-09-21 19:00:36 INFO  ---RUNTIME: Multi-Query Optimization took 7.903814315795898 ms
2022-09-21 19:00:36 INFO  Executing generated plans
2022-09-21 19:00:45 INFO  ---RUNTIME: Execution took 9324.41759109497 ms
2022-09-21 19:00:45 INFO  Done!
2022-09-21 19:00:45 INFO  # Finished -- repetition 2 of 7 
2022-09-21 19:00:45 INFO  # Optimization benchmark for feature_importance with args [['folktables', 'slow_loading', 'featurization_2', 'logistic_regression']] -- repetition 3 of 7
2022-09-21 19:00:45 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-21 19:00:45 INFO  Running instrumented original pipeline...
2022-09-21 19:00:45 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-21 19:00:45 INFO  ---RUNTIME: Importing and monkey-patching took 7.094144821166992 ms
2022-09-21 19:00:46 INFO  ---RUNTIME: Original pipeline execution took 1326.3709545135498 ms (excluding imports and monkey-patching)
2022-09-21 19:00:46 INFO  Starting execution of 1 what-if analyses...
2022-09-21 19:00:46 INFO  Start plan generation for analysis PermutationFeatureImportance...
2022-09-21 19:00:46 INFO  ---RUNTIME: Plan generation took 1.0986328125 ms
2022-09-21 19:00:46 INFO  Estimated runtime of original DAG is 1067.0993328094482ms
2022-09-21 19:00:46 INFO  Performing Multi-Query Optimization
2022-09-21 19:00:46 INFO  Estimated unoptimized what-if runtime is 8536.794662475586ms
2022-09-21 19:00:46 INFO  Estimated optimised what-if runtime is 1109.6539497375488ms
2022-09-21 19:00:46 INFO  Estimated optimisation runtime saving is 7427.140712738037ms
2022-09-21 19:00:46 INFO  ---RUNTIME: Multi-Query Optimization took 21.854877471923828 ms
2022-09-21 19:00:46 INFO  Executing generated plans
2022-09-21 19:00:47 INFO  ---RUNTIME: Execution took 1167.5922870635986 ms
2022-09-21 19:00:47 INFO  Done!
2022-09-21 19:00:47 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-21 19:00:47 INFO  Running instrumented original pipeline...
2022-09-21 19:00:47 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-21 19:00:47 INFO  ---RUNTIME: Importing and monkey-patching took 5.539655685424805 ms
2022-09-21 19:00:49 INFO  ---RUNTIME: Original pipeline execution took 1360.2855205535889 ms (excluding imports and monkey-patching)
2022-09-21 19:00:49 INFO  Starting execution of 1 what-if analyses...
2022-09-21 19:00:49 INFO  Start plan generation for analysis PermutationFeatureImportance...
2022-09-21 19:00:49 INFO  ---RUNTIME: Plan generation took 1.0900497436523438 ms
2022-09-21 19:00:49 INFO  Estimated runtime of original DAG is 1070.8391666412354ms
2022-09-21 19:00:49 WARNING Skipping Multi-Query Optimization (instead, only applying patches)
2022-09-21 19:00:49 INFO  Estimated unoptimised what-if runtime is 8566.713333129883ms
2022-09-21 19:00:49 INFO  ---RUNTIME: Multi-Query Optimization took 7.405519485473633 ms
2022-09-21 19:00:49 INFO  Executing generated plans
2022-09-21 19:00:58 INFO  ---RUNTIME: Execution took 9137.833833694458 ms
2022-09-21 19:00:58 INFO  Done!
2022-09-21 19:00:58 INFO  # Finished -- repetition 3 of 7 
2022-09-21 19:00:58 INFO  # Optimization benchmark for feature_importance with args [['folktables', 'slow_loading', 'featurization_2', 'logistic_regression']] -- repetition 4 of 7
2022-09-21 19:00:58 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-21 19:00:58 INFO  Running instrumented original pipeline...
2022-09-21 19:00:58 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-21 19:00:58 INFO  ---RUNTIME: Importing and monkey-patching took 5.717754364013672 ms
2022-09-21 19:00:59 INFO  ---RUNTIME: Original pipeline execution took 1371.9482421875 ms (excluding imports and monkey-patching)
2022-09-21 19:00:59 INFO  Starting execution of 1 what-if analyses...
2022-09-21 19:00:59 INFO  Start plan generation for analysis PermutationFeatureImportance...
2022-09-21 19:00:59 INFO  ---RUNTIME: Plan generation took 0.14710426330566406 ms
2022-09-21 19:00:59 INFO  Estimated runtime of original DAG is 1118.8640594482422ms
2022-09-21 19:00:59 INFO  Performing Multi-Query Optimization
2022-09-21 19:00:59 INFO  Estimated unoptimized what-if runtime is 8950.912475585938ms
2022-09-21 19:00:59 INFO  Estimated optimised what-if runtime is 1161.930799484253ms
2022-09-21 19:00:59 INFO  Estimated optimisation runtime saving is 7788.981676101685ms
2022-09-21 19:00:59 INFO  ---RUNTIME: Multi-Query Optimization took 21.432876586914062 ms
2022-09-21 19:00:59 INFO  Executing generated plans
2022-09-21 19:01:01 INFO  ---RUNTIME: Execution took 1250.0154972076416 ms
2022-09-21 19:01:01 INFO  Done!
2022-09-21 19:01:01 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-21 19:01:01 INFO  Running instrumented original pipeline...
2022-09-21 19:01:01 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-21 19:01:01 INFO  ---RUNTIME: Importing and monkey-patching took 6.515979766845703 ms
2022-09-21 19:01:02 INFO  ---RUNTIME: Original pipeline execution took 1447.8509426116943 ms (excluding imports and monkey-patching)
2022-09-21 19:01:02 INFO  Starting execution of 1 what-if analyses...
2022-09-21 19:01:02 INFO  Start plan generation for analysis PermutationFeatureImportance...
2022-09-21 19:01:02 INFO  ---RUNTIME: Plan generation took 0.38361549377441406 ms
2022-09-21 19:01:02 INFO  Estimated runtime of original DAG is 1150.4762172698975ms
2022-09-21 19:01:02 WARNING Skipping Multi-Query Optimization (instead, only applying patches)
2022-09-21 19:01:02 INFO  Estimated unoptimised what-if runtime is 9203.80973815918ms
2022-09-21 19:01:02 INFO  ---RUNTIME: Multi-Query Optimization took 8.378982543945312 ms
2022-09-21 19:01:02 INFO  Executing generated plans
2022-09-21 19:01:11 INFO  ---RUNTIME: Execution took 9298.44355583191 ms
2022-09-21 19:01:11 INFO  Done!
2022-09-21 19:01:11 INFO  # Finished -- repetition 4 of 7 
2022-09-21 19:01:11 INFO  # Optimization benchmark for feature_importance with args [['folktables', 'slow_loading', 'featurization_2', 'logistic_regression']] -- repetition 5 of 7
2022-09-21 19:01:11 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-21 19:01:11 INFO  Running instrumented original pipeline...
2022-09-21 19:01:11 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-21 19:01:11 INFO  ---RUNTIME: Importing and monkey-patching took 7.393360137939453 ms
2022-09-21 19:01:13 INFO  ---RUNTIME: Original pipeline execution took 1304.4919967651367 ms (excluding imports and monkey-patching)
2022-09-21 19:01:13 INFO  Starting execution of 1 what-if analyses...
2022-09-21 19:01:13 INFO  Start plan generation for analysis PermutationFeatureImportance...
2022-09-21 19:01:13 INFO  ---RUNTIME: Plan generation took 0.14066696166992188 ms
2022-09-21 19:01:13 INFO  Estimated runtime of original DAG is 1033.8459014892578ms
2022-09-21 19:01:13 INFO  Performing Multi-Query Optimization
2022-09-21 19:01:13 INFO  Estimated unoptimized what-if runtime is 8270.767211914062ms
2022-09-21 19:01:13 INFO  Estimated optimised what-if runtime is 1070.2247619628906ms
2022-09-21 19:01:13 INFO  Estimated optimisation runtime saving is 7200.542449951172ms
2022-09-21 19:01:13 INFO  ---RUNTIME: Multi-Query Optimization took 17.178058624267578 ms
2022-09-21 19:01:13 INFO  Executing generated plans
2022-09-21 19:01:14 INFO  ---RUNTIME: Execution took 1173.8505363464355 ms
2022-09-21 19:01:14 INFO  Done!
2022-09-21 19:01:14 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-21 19:01:14 INFO  Running instrumented original pipeline...
2022-09-21 19:01:14 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-21 19:01:14 INFO  ---RUNTIME: Importing and monkey-patching took 5.594730377197266 ms
2022-09-21 19:01:15 INFO  ---RUNTIME: Original pipeline execution took 1283.85591506958 ms (excluding imports and monkey-patching)
2022-09-21 19:01:15 INFO  Starting execution of 1 what-if analyses...
2022-09-21 19:01:15 INFO  Start plan generation for analysis PermutationFeatureImportance...
2022-09-21 19:01:15 INFO  ---RUNTIME: Plan generation took 0.16188621520996094 ms
2022-09-21 19:01:15 INFO  Estimated runtime of original DAG is 1041.5802001953125ms
2022-09-21 19:01:15 WARNING Skipping Multi-Query Optimization (instead, only applying patches)
2022-09-21 19:01:15 INFO  Estimated unoptimised what-if runtime is 8332.6416015625ms
2022-09-21 19:01:15 INFO  ---RUNTIME: Multi-Query Optimization took 5.830049514770508 ms
2022-09-21 19:01:15 INFO  Executing generated plans
2022-09-21 19:01:25 INFO  ---RUNTIME: Execution took 9587.342262268066 ms
2022-09-21 19:01:25 INFO  Done!
2022-09-21 19:01:25 INFO  # Finished -- repetition 5 of 7 
2022-09-21 19:01:25 INFO  # Optimization benchmark for feature_importance with args [['folktables', 'slow_loading', 'featurization_2', 'logistic_regression']] -- repetition 6 of 7
2022-09-21 19:01:25 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-21 19:01:25 INFO  Running instrumented original pipeline...
2022-09-21 19:01:25 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-21 19:01:25 INFO  ---RUNTIME: Importing and monkey-patching took 5.701541900634766 ms
2022-09-21 19:01:26 INFO  ---RUNTIME: Original pipeline execution took 1327.6004791259766 ms (excluding imports and monkey-patching)
2022-09-21 19:01:26 INFO  Starting execution of 1 what-if analyses...
2022-09-21 19:01:26 INFO  Start plan generation for analysis PermutationFeatureImportance...
2022-09-21 19:01:26 INFO  ---RUNTIME: Plan generation took 0.1728534698486328 ms
2022-09-21 19:01:26 INFO  Estimated runtime of original DAG is 1085.4105949401855ms
2022-09-21 19:01:26 INFO  Performing Multi-Query Optimization
2022-09-21 19:01:26 INFO  Estimated unoptimized what-if runtime is 8683.284759521484ms
2022-09-21 19:01:26 INFO  Estimated optimised what-if runtime is 1122.2686767578125ms
2022-09-21 19:01:26 INFO  Estimated optimisation runtime saving is 7561.016082763672ms
2022-09-21 19:01:26 INFO  ---RUNTIME: Multi-Query Optimization took 17.2271728515625 ms
2022-09-21 19:01:26 INFO  Executing generated plans
2022-09-21 19:01:27 INFO  ---RUNTIME: Execution took 1284.7886085510254 ms
2022-09-21 19:01:27 INFO  Done!
2022-09-21 19:01:27 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-21 19:01:27 INFO  Running instrumented original pipeline...
2022-09-21 19:01:27 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-21 19:01:27 INFO  ---RUNTIME: Importing and monkey-patching took 7.528066635131836 ms
2022-09-21 19:01:29 INFO  ---RUNTIME: Original pipeline execution took 1334.0022563934326 ms (excluding imports and monkey-patching)
2022-09-21 19:01:29 INFO  Starting execution of 1 what-if analyses...
2022-09-21 19:01:29 INFO  Start plan generation for analysis PermutationFeatureImportance...
2022-09-21 19:01:29 INFO  ---RUNTIME: Plan generation took 0.16188621520996094 ms
2022-09-21 19:01:29 INFO  Estimated runtime of original DAG is 1056.9236278533936ms
2022-09-21 19:01:29 WARNING Skipping Multi-Query Optimization (instead, only applying patches)
2022-09-21 19:01:29 INFO  Estimated unoptimised what-if runtime is 8455.389022827148ms
2022-09-21 19:01:29 INFO  ---RUNTIME: Multi-Query Optimization took 6.541967391967773 ms
2022-09-21 19:01:29 INFO  Executing generated plans
2022-09-21 19:01:38 INFO  ---RUNTIME: Execution took 9160.873174667358 ms
2022-09-21 19:01:38 INFO  Done!
2022-09-21 19:01:38 INFO  # Finished -- repetition 6 of 7 
2022-09-21 19:01:38 INFO  # Optimization benchmark for feature_importance with args [['folktables', 'slow_loading', 'featurization_2', 'logistic_regression']] -- repetition 7 of 7
2022-09-21 19:01:38 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-21 19:01:38 INFO  Running instrumented original pipeline...
2022-09-21 19:01:38 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-21 19:01:38 INFO  ---RUNTIME: Importing and monkey-patching took 7.474660873413086 ms
2022-09-21 19:01:39 INFO  ---RUNTIME: Original pipeline execution took 1396.6877460479736 ms (excluding imports and monkey-patching)
2022-09-21 19:01:39 INFO  Starting execution of 1 what-if analyses...
2022-09-21 19:01:39 INFO  Start plan generation for analysis PermutationFeatureImportance...
2022-09-21 19:01:39 INFO  ---RUNTIME: Plan generation took 0.15616416931152344 ms
2022-09-21 19:01:39 INFO  Estimated runtime of original DAG is 1107.7609062194824ms
2022-09-21 19:01:39 INFO  Performing Multi-Query Optimization
2022-09-21 19:01:39 INFO  Estimated unoptimized what-if runtime is 8862.08724975586ms
2022-09-21 19:01:39 INFO  Estimated optimised what-if runtime is 1149.549961090088ms
2022-09-21 19:01:39 INFO  Estimated optimisation runtime saving is 7712.5372886657715ms
2022-09-21 19:01:39 INFO  ---RUNTIME: Multi-Query Optimization took 21.010398864746094 ms
2022-09-21 19:01:39 INFO  Executing generated plans
2022-09-21 19:01:40 INFO  ---RUNTIME: Execution took 1167.0565605163574 ms
2022-09-21 19:01:40 INFO  Done!
2022-09-21 19:01:40 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-21 19:01:40 INFO  Running instrumented original pipeline...
2022-09-21 19:01:41 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-21 19:01:41 INFO  ---RUNTIME: Importing and monkey-patching took 5.496978759765625 ms
2022-09-21 19:01:42 INFO  ---RUNTIME: Original pipeline execution took 1430.6490421295166 ms (excluding imports and monkey-patching)
2022-09-21 19:01:42 INFO  Starting execution of 1 what-if analyses...
2022-09-21 19:01:42 INFO  Start plan generation for analysis PermutationFeatureImportance...
2022-09-21 19:01:42 INFO  ---RUNTIME: Plan generation took 0.11944770812988281 ms
2022-09-21 19:01:42 INFO  Estimated runtime of original DAG is 1152.7900695800781ms
2022-09-21 19:01:42 WARNING Skipping Multi-Query Optimization (instead, only applying patches)
2022-09-21 19:01:42 INFO  Estimated unoptimised what-if runtime is 9222.320556640625ms
2022-09-21 19:01:42 INFO  ---RUNTIME: Multi-Query Optimization took 5.87916374206543 ms
2022-09-21 19:01:42 INFO  Executing generated plans
2022-09-21 19:01:51 INFO  ---RUNTIME: Execution took 9058.428525924683 ms
2022-09-21 19:01:51 INFO  Done!
2022-09-21 19:01:51 INFO  # Finished -- repetition 7 of 7 
2022-09-21 19:01:51 INFO  # Final results after all repetitions
2022-09-21 19:01:51 INFO     repetition  ... no_opt_what_if_execution_combined_model_training
0           0  ...                                       543.827057
1           1  ...                                       556.694031
2           2  ...                                       548.166990
3           3  ...                                       553.044796
4           4  ...                                       567.332745
5           5  ...                                       541.467905
6           6  ...                                       540.340185

[7 rows x 26 columns]
taskset -c 64-71 PROTOCOL_BUFFERS_PYTHON_IMPLEMENTATION=python python3.9 benchmarks_end_to_end.py feature_importance folktables slow_loading featurization_2 xgboost
2022-09-21 19:01:53.517931: W tensorflow/stream_executor/platform/default/dso_loader.cc:64] Could not load dynamic library 'libcudart.so.11.0'; dlerror: libcudart.so.11.0: cannot open shared object file: No such file or directory; LD_LIBRARY_PATH: /home/sgrafbe/mlwhatif/venv/lib/python3.9/site-packages/cv2/../../lib64:
2022-09-21 19:01:53.517968: I tensorflow/stream_executor/cuda/cudart_stub.cc:29] Ignore above cudart dlerror if you do not have a GPU set up on your machine.
2022-09-21 19:01:54 INFO  Patching sys.argv with ['mlwhatif', 'folktables', 'slow_loading', 'featurization_2', 'xgboost']
2022-09-21 19:01:54 INFO  Running instrumented original pipeline...
2022-09-21 19:01:54 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-21 19:01:54 INFO  ---RUNTIME: Importing and monkey-patching took 95.57199478149414 ms
2022-09-21 19:01:56 INFO  ---RUNTIME: Original pipeline execution took 1836.8940353393555 ms (excluding imports and monkey-patching)
2022-09-21 19:01:56 INFO  Starting execution of 0 what-if analyses...
2022-09-21 19:01:56 INFO  Estimated runtime of original DAG is 1560.6954097747803ms
2022-09-21 19:01:56 INFO  Performing Multi-Query Optimization
2022-09-21 19:01:56 INFO  Estimated unoptimized what-if runtime is 0ms
2022-09-21 19:01:56 INFO  Estimated optimised what-if runtime is 0ms
2022-09-21 19:01:56 INFO  Estimated optimisation runtime saving is 0ms
2022-09-21 19:01:56 INFO  ---RUNTIME: Multi-Query Optimization took 0.5571842193603516 ms
2022-09-21 19:01:56 INFO  Executing generated plans
2022-09-21 19:01:56 INFO  ---RUNTIME: Execution took 0.020742416381835938 ms
2022-09-21 19:01:56 INFO  Done!
2022-09-21 19:01:56 INFO  # Optimization benchmark for feature_importance with args [['folktables', 'slow_loading', 'featurization_2', 'xgboost']] -- repetition 1 of 7
2022-09-21 19:01:56 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-21 19:01:56 INFO  Running instrumented original pipeline...
2022-09-21 19:01:56 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-21 19:01:56 INFO  ---RUNTIME: Importing and monkey-patching took 6.559133529663086 ms
2022-09-21 19:01:58 INFO  ---RUNTIME: Original pipeline execution took 1834.6459865570068 ms (excluding imports and monkey-patching)
2022-09-21 19:01:58 INFO  Starting execution of 1 what-if analyses...
2022-09-21 19:01:58 INFO  Start plan generation for analysis PermutationFeatureImportance...
2022-09-21 19:01:58 INFO  ---RUNTIME: Plan generation took 0.396728515625 ms
2022-09-21 19:01:58 INFO  Estimated runtime of original DAG is 1539.3431186676025ms
2022-09-21 19:01:58 INFO  Performing Multi-Query Optimization
2022-09-21 19:01:58 INFO  Estimated unoptimized what-if runtime is 12314.74494934082ms
2022-09-21 19:01:58 INFO  Estimated optimised what-if runtime is 1661.0314846038818ms
2022-09-21 19:01:58 INFO  Estimated optimisation runtime saving is 10653.713464736938ms
2022-09-21 19:01:58 INFO  ---RUNTIME: Multi-Query Optimization took 22.046327590942383 ms
2022-09-21 19:01:58 INFO  Executing generated plans
2022-09-21 19:02:00 INFO  ---RUNTIME: Execution took 1553.9257526397705 ms
2022-09-21 19:02:00 INFO  Done!
2022-09-21 19:02:00 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-21 19:02:00 INFO  Running instrumented original pipeline...
2022-09-21 19:02:00 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-21 19:02:00 INFO  ---RUNTIME: Importing and monkey-patching took 7.149934768676758 ms
2022-09-21 19:02:02 INFO  ---RUNTIME: Original pipeline execution took 1943.307876586914 ms (excluding imports and monkey-patching)
2022-09-21 19:02:02 INFO  Starting execution of 1 what-if analyses...
2022-09-21 19:02:02 INFO  Start plan generation for analysis PermutationFeatureImportance...
2022-09-21 19:02:02 INFO  ---RUNTIME: Plan generation took 0.13494491577148438 ms
2022-09-21 19:02:02 INFO  Estimated runtime of original DAG is 1504.2369365692139ms
2022-09-21 19:02:02 WARNING Skipping Multi-Query Optimization (instead, only applying patches)
2022-09-21 19:02:02 INFO  Estimated unoptimised what-if runtime is 12033.895492553711ms
2022-09-21 19:02:02 INFO  ---RUNTIME: Multi-Query Optimization took 5.973100662231445 ms
2022-09-21 19:02:02 INFO  Executing generated plans
2022-09-21 19:02:14 INFO  ---RUNTIME: Execution took 12048.331260681152 ms
2022-09-21 19:02:14 INFO  Done!
2022-09-21 19:02:14 INFO  # Finished -- repetition 1 of 7 
2022-09-21 19:02:14 INFO  # Optimization benchmark for feature_importance with args [['folktables', 'slow_loading', 'featurization_2', 'xgboost']] -- repetition 2 of 7
2022-09-21 19:02:14 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-21 19:02:14 INFO  Running instrumented original pipeline...
2022-09-21 19:02:14 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-21 19:02:14 INFO  ---RUNTIME: Importing and monkey-patching took 6.314516067504883 ms
2022-09-21 19:02:15 INFO  ---RUNTIME: Original pipeline execution took 1677.3602962493896 ms (excluding imports and monkey-patching)
2022-09-21 19:02:15 INFO  Starting execution of 1 what-if analyses...
2022-09-21 19:02:15 INFO  Start plan generation for analysis PermutationFeatureImportance...
2022-09-21 19:02:15 INFO  ---RUNTIME: Plan generation took 0.19502639770507812 ms
2022-09-21 19:02:15 INFO  Estimated runtime of original DAG is 1429.0823936462402ms
2022-09-21 19:02:15 INFO  Performing Multi-Query Optimization
2022-09-21 19:02:15 INFO  Estimated unoptimized what-if runtime is 11432.659149169922ms
2022-09-21 19:02:15 INFO  Estimated optimised what-if runtime is 1612.2071743011475ms
2022-09-21 19:02:15 INFO  Estimated optimisation runtime saving is 9820.451974868774ms
2022-09-21 19:02:15 INFO  ---RUNTIME: Multi-Query Optimization took 17.510652542114258 ms
2022-09-21 19:02:15 INFO  Executing generated plans
2022-09-21 19:02:17 INFO  ---RUNTIME: Execution took 1574.05424118042 ms
2022-09-21 19:02:17 INFO  Done!
2022-09-21 19:02:17 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-21 19:02:17 INFO  Running instrumented original pipeline...
2022-09-21 19:02:17 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-21 19:02:17 INFO  ---RUNTIME: Importing and monkey-patching took 6.463766098022461 ms
2022-09-21 19:02:19 INFO  ---RUNTIME: Original pipeline execution took 1704.240322113037 ms (excluding imports and monkey-patching)
2022-09-21 19:02:19 INFO  Starting execution of 1 what-if analyses...
2022-09-21 19:02:19 INFO  Start plan generation for analysis PermutationFeatureImportance...
2022-09-21 19:02:19 INFO  ---RUNTIME: Plan generation took 0.21123886108398438 ms
2022-09-21 19:02:19 INFO  Estimated runtime of original DAG is 1448.28462600708ms
2022-09-21 19:02:19 WARNING Skipping Multi-Query Optimization (instead, only applying patches)
2022-09-21 19:02:19 INFO  Estimated unoptimised what-if runtime is 11586.27700805664ms
2022-09-21 19:02:19 INFO  ---RUNTIME: Multi-Query Optimization took 7.341861724853516 ms
2022-09-21 19:02:19 INFO  Executing generated plans
2022-09-21 19:02:31 INFO  ---RUNTIME: Execution took 11848.152160644531 ms
2022-09-21 19:02:31 INFO  Done!
2022-09-21 19:02:31 INFO  # Finished -- repetition 2 of 7 
2022-09-21 19:02:31 INFO  # Optimization benchmark for feature_importance with args [['folktables', 'slow_loading', 'featurization_2', 'xgboost']] -- repetition 3 of 7
2022-09-21 19:02:31 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-21 19:02:31 INFO  Running instrumented original pipeline...
2022-09-21 19:02:31 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-21 19:02:31 INFO  ---RUNTIME: Importing and monkey-patching took 5.980014801025391 ms
2022-09-21 19:02:32 INFO  ---RUNTIME: Original pipeline execution took 1679.7809600830078 ms (excluding imports and monkey-patching)
2022-09-21 19:02:32 INFO  Starting execution of 1 what-if analyses...
2022-09-21 19:02:32 INFO  Start plan generation for analysis PermutationFeatureImportance...
2022-09-21 19:02:32 INFO  ---RUNTIME: Plan generation took 0.23674964904785156 ms
2022-09-21 19:02:32 INFO  Estimated runtime of original DAG is 1422.656774520874ms
2022-09-21 19:02:32 INFO  Performing Multi-Query Optimization
2022-09-21 19:02:32 INFO  Estimated unoptimized what-if runtime is 11381.254196166992ms
2022-09-21 19:02:32 INFO  Estimated optimised what-if runtime is 1529.2320251464844ms
2022-09-21 19:02:32 INFO  Estimated optimisation runtime saving is 9852.022171020508ms
2022-09-21 19:02:32 INFO  ---RUNTIME: Multi-Query Optimization took 18.113374710083008 ms
2022-09-21 19:02:32 INFO  Executing generated plans
2022-09-21 19:02:34 INFO  ---RUNTIME: Execution took 1588.9856815338135 ms
2022-09-21 19:02:34 INFO  Done!
2022-09-21 19:02:34 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-21 19:02:34 INFO  Running instrumented original pipeline...
2022-09-21 19:02:34 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-21 19:02:34 INFO  ---RUNTIME: Importing and monkey-patching took 6.1092376708984375 ms
2022-09-21 19:02:36 INFO  ---RUNTIME: Original pipeline execution took 1718.0142402648926 ms (excluding imports and monkey-patching)
2022-09-21 19:02:36 INFO  Starting execution of 1 what-if analyses...
2022-09-21 19:02:36 INFO  Start plan generation for analysis PermutationFeatureImportance...
2022-09-21 19:02:36 INFO  ---RUNTIME: Plan generation took 0.19550323486328125 ms
2022-09-21 19:02:36 INFO  Estimated runtime of original DAG is 1464.5941257476807ms
2022-09-21 19:02:36 WARNING Skipping Multi-Query Optimization (instead, only applying patches)
2022-09-21 19:02:36 INFO  Estimated unoptimised what-if runtime is 11716.753005981445ms
2022-09-21 19:02:36 INFO  ---RUNTIME: Multi-Query Optimization took 6.227731704711914 ms
2022-09-21 19:02:36 INFO  Executing generated plans
2022-09-21 19:02:47 INFO  ---RUNTIME: Execution took 11812.875032424927 ms
2022-09-21 19:02:47 INFO  Done!
2022-09-21 19:02:47 INFO  # Finished -- repetition 3 of 7 
2022-09-21 19:02:47 INFO  # Optimization benchmark for feature_importance with args [['folktables', 'slow_loading', 'featurization_2', 'xgboost']] -- repetition 4 of 7
2022-09-21 19:02:47 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-21 19:02:47 INFO  Running instrumented original pipeline...
2022-09-21 19:02:47 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-21 19:02:47 INFO  ---RUNTIME: Importing and monkey-patching took 5.997657775878906 ms
2022-09-21 19:02:51 INFO  ---RUNTIME: Original pipeline execution took 3970.1545238494873 ms (excluding imports and monkey-patching)
2022-09-21 19:02:51 INFO  Starting execution of 1 what-if analyses...
2022-09-21 19:02:51 INFO  Start plan generation for analysis PermutationFeatureImportance...
2022-09-21 19:02:51 INFO  ---RUNTIME: Plan generation took 0.15807151794433594 ms
2022-09-21 19:02:51 INFO  Estimated runtime of original DAG is 3708.2221508026123ms
2022-09-21 19:02:51 INFO  Performing Multi-Query Optimization
2022-09-21 19:02:51 INFO  Estimated unoptimized what-if runtime is 29665.7772064209ms
2022-09-21 19:02:51 INFO  Estimated optimised what-if runtime is 3830.5132389068604ms
2022-09-21 19:02:51 INFO  Estimated optimisation runtime saving is 25835.263967514038ms
2022-09-21 19:02:51 INFO  ---RUNTIME: Multi-Query Optimization took 16.79253578186035 ms
2022-09-21 19:02:51 INFO  Executing generated plans
2022-09-21 19:02:53 INFO  ---RUNTIME: Execution took 1563.7784004211426 ms
2022-09-21 19:02:53 INFO  Done!
2022-09-21 19:02:53 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-21 19:02:53 INFO  Running instrumented original pipeline...
2022-09-21 19:02:53 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-21 19:02:53 INFO  ---RUNTIME: Importing and monkey-patching took 6.203889846801758 ms
2022-09-21 19:02:55 INFO  ---RUNTIME: Original pipeline execution took 1841.8872356414795 ms (excluding imports and monkey-patching)
2022-09-21 19:02:55 INFO  Starting execution of 1 what-if analyses...
2022-09-21 19:02:55 INFO  Start plan generation for analysis PermutationFeatureImportance...
2022-09-21 19:02:55 INFO  ---RUNTIME: Plan generation took 0.13828277587890625 ms
2022-09-21 19:02:55 INFO  Estimated runtime of original DAG is 1400.7058143615723ms
2022-09-21 19:02:55 WARNING Skipping Multi-Query Optimization (instead, only applying patches)
2022-09-21 19:02:55 INFO  Estimated unoptimised what-if runtime is 11205.646514892578ms
2022-09-21 19:02:55 INFO  ---RUNTIME: Multi-Query Optimization took 5.775690078735352 ms
2022-09-21 19:02:55 INFO  Executing generated plans
2022-09-21 19:03:07 INFO  ---RUNTIME: Execution took 11770.301580429077 ms
2022-09-21 19:03:07 INFO  Done!
2022-09-21 19:03:07 INFO  # Finished -- repetition 4 of 7 
2022-09-21 19:03:07 INFO  # Optimization benchmark for feature_importance with args [['folktables', 'slow_loading', 'featurization_2', 'xgboost']] -- repetition 5 of 7
2022-09-21 19:03:07 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-21 19:03:07 INFO  Running instrumented original pipeline...
2022-09-21 19:03:07 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-21 19:03:07 INFO  ---RUNTIME: Importing and monkey-patching took 6.366968154907227 ms
2022-09-21 19:03:08 INFO  ---RUNTIME: Original pipeline execution took 1572.4706649780273 ms (excluding imports and monkey-patching)
2022-09-21 19:03:08 INFO  Starting execution of 1 what-if analyses...
2022-09-21 19:03:08 INFO  Start plan generation for analysis PermutationFeatureImportance...
2022-09-21 19:03:08 INFO  ---RUNTIME: Plan generation took 0.20313262939453125 ms
2022-09-21 19:03:08 INFO  Estimated runtime of original DAG is 1321.362018585205ms
2022-09-21 19:03:08 INFO  Performing Multi-Query Optimization
2022-09-21 19:03:08 INFO  Estimated unoptimized what-if runtime is 10570.89614868164ms
2022-09-21 19:03:08 INFO  Estimated optimised what-if runtime is 1427.328109741211ms
2022-09-21 19:03:08 INFO  Estimated optimisation runtime saving is 9143.56803894043ms
2022-09-21 19:03:08 INFO  ---RUNTIME: Multi-Query Optimization took 17.827987670898438 ms
2022-09-21 19:03:08 INFO  Executing generated plans
2022-09-21 19:03:10 INFO  ---RUNTIME: Execution took 1744.8790073394775 ms
2022-09-21 19:03:10 INFO  Done!
2022-09-21 19:03:10 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-21 19:03:10 INFO  Running instrumented original pipeline...
2022-09-21 19:03:10 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-21 19:03:10 INFO  ---RUNTIME: Importing and monkey-patching took 5.907297134399414 ms
2022-09-21 19:03:12 INFO  ---RUNTIME: Original pipeline execution took 1627.9058456420898 ms (excluding imports and monkey-patching)
2022-09-21 19:03:12 INFO  Starting execution of 1 what-if analyses...
2022-09-21 19:03:12 INFO  Start plan generation for analysis PermutationFeatureImportance...
2022-09-21 19:03:12 INFO  ---RUNTIME: Plan generation took 0.20122528076171875 ms
2022-09-21 19:03:12 INFO  Estimated runtime of original DAG is 1380.706548690796ms
2022-09-21 19:03:12 WARNING Skipping Multi-Query Optimization (instead, only applying patches)
2022-09-21 19:03:12 INFO  Estimated unoptimised what-if runtime is 11045.652389526367ms
2022-09-21 19:03:12 INFO  ---RUNTIME: Multi-Query Optimization took 6.51097297668457 ms
2022-09-21 19:03:12 INFO  Executing generated plans
2022-09-21 19:03:24 INFO  ---RUNTIME: Execution took 12752.983093261719 ms
2022-09-21 19:03:24 INFO  Done!
2022-09-21 19:03:24 INFO  # Finished -- repetition 5 of 7 
2022-09-21 19:03:24 INFO  # Optimization benchmark for feature_importance with args [['folktables', 'slow_loading', 'featurization_2', 'xgboost']] -- repetition 6 of 7
2022-09-21 19:03:24 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-21 19:03:24 INFO  Running instrumented original pipeline...
2022-09-21 19:03:24 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-21 19:03:24 INFO  ---RUNTIME: Importing and monkey-patching took 5.745410919189453 ms
2022-09-21 19:03:26 INFO  ---RUNTIME: Original pipeline execution took 1604.3369770050049 ms (excluding imports and monkey-patching)
2022-09-21 19:03:26 INFO  Starting execution of 1 what-if analyses...
2022-09-21 19:03:26 INFO  Start plan generation for analysis PermutationFeatureImportance...
2022-09-21 19:03:26 INFO  ---RUNTIME: Plan generation took 0.22029876708984375 ms
2022-09-21 19:03:26 INFO  Estimated runtime of original DAG is 1358.764886856079ms
2022-09-21 19:03:26 INFO  Performing Multi-Query Optimization
2022-09-21 19:03:26 INFO  Estimated unoptimized what-if runtime is 10870.119094848633ms
2022-09-21 19:03:26 INFO  Estimated optimised what-if runtime is 1467.7646160125732ms
2022-09-21 19:03:26 INFO  Estimated optimisation runtime saving is 9402.35447883606ms
2022-09-21 19:03:26 INFO  ---RUNTIME: Multi-Query Optimization took 18.8143253326416 ms
2022-09-21 19:03:26 INFO  Executing generated plans
2022-09-21 19:03:28 INFO  ---RUNTIME: Execution took 1613.8348579406738 ms
2022-09-21 19:03:28 INFO  Done!
2022-09-21 19:03:28 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-21 19:03:28 INFO  Running instrumented original pipeline...
2022-09-21 19:03:28 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-21 19:03:28 INFO  ---RUNTIME: Importing and monkey-patching took 7.5225830078125 ms
2022-09-21 19:03:29 INFO  ---RUNTIME: Original pipeline execution took 1695.047378540039 ms (excluding imports and monkey-patching)
2022-09-21 19:03:29 INFO  Starting execution of 1 what-if analyses...
2022-09-21 19:03:29 INFO  Start plan generation for analysis PermutationFeatureImportance...
2022-09-21 19:03:29 INFO  ---RUNTIME: Plan generation took 0.19431114196777344 ms
2022-09-21 19:03:29 INFO  Estimated runtime of original DAG is 1416.8810844421387ms
2022-09-21 19:03:29 WARNING Skipping Multi-Query Optimization (instead, only applying patches)
2022-09-21 19:03:29 INFO  Estimated unoptimised what-if runtime is 11335.04867553711ms
2022-09-21 19:03:29 INFO  ---RUNTIME: Multi-Query Optimization took 5.867958068847656 ms
2022-09-21 19:03:29 INFO  Executing generated plans
2022-09-21 19:03:42 INFO  ---RUNTIME: Execution took 12749.069929122925 ms
2022-09-21 19:03:42 INFO  Done!
2022-09-21 19:03:42 INFO  # Finished -- repetition 6 of 7 
2022-09-21 19:03:42 INFO  # Optimization benchmark for feature_importance with args [['folktables', 'slow_loading', 'featurization_2', 'xgboost']] -- repetition 7 of 7
2022-09-21 19:03:42 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-21 19:03:42 INFO  Running instrumented original pipeline...
2022-09-21 19:03:42 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-21 19:03:42 INFO  ---RUNTIME: Importing and monkey-patching took 5.8574676513671875 ms
2022-09-21 19:03:44 INFO  ---RUNTIME: Original pipeline execution took 1669.853687286377 ms (excluding imports and monkey-patching)
2022-09-21 19:03:44 INFO  Starting execution of 1 what-if analyses...
2022-09-21 19:03:44 INFO  Start plan generation for analysis PermutationFeatureImportance...
2022-09-21 19:03:44 INFO  ---RUNTIME: Plan generation took 0.14829635620117188 ms
2022-09-21 19:03:44 INFO  Estimated runtime of original DAG is 1416.3281917572021ms
2022-09-21 19:03:44 INFO  Performing Multi-Query Optimization
2022-09-21 19:03:44 INFO  Estimated unoptimized what-if runtime is 11330.625534057617ms
2022-09-21 19:03:44 INFO  Estimated optimised what-if runtime is 1586.7316722869873ms
2022-09-21 19:03:44 INFO  Estimated optimisation runtime saving is 9743.89386177063ms
2022-09-21 19:03:44 INFO  ---RUNTIME: Multi-Query Optimization took 16.592979431152344 ms
2022-09-21 19:03:44 INFO  Executing generated plans
2022-09-21 19:03:45 INFO  ---RUNTIME: Execution took 1743.6540126800537 ms
2022-09-21 19:03:45 INFO  Done!
2022-09-21 19:03:45 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-21 19:03:45 INFO  Running instrumented original pipeline...
2022-09-21 19:03:46 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-21 19:03:46 INFO  ---RUNTIME: Importing and monkey-patching took 6.735086441040039 ms
2022-09-21 19:03:47 INFO  ---RUNTIME: Original pipeline execution took 1754.4314861297607 ms (excluding imports and monkey-patching)
2022-09-21 19:03:47 INFO  Starting execution of 1 what-if analyses...
2022-09-21 19:03:47 INFO  Start plan generation for analysis PermutationFeatureImportance...
2022-09-21 19:03:47 INFO  ---RUNTIME: Plan generation took 0.2143383026123047 ms
2022-09-21 19:03:47 INFO  Estimated runtime of original DAG is 1488.9280796051025ms
2022-09-21 19:03:47 WARNING Skipping Multi-Query Optimization (instead, only applying patches)
2022-09-21 19:03:47 INFO  Estimated unoptimised what-if runtime is 11911.42463684082ms
2022-09-21 19:03:47 INFO  ---RUNTIME: Multi-Query Optimization took 7.744312286376953 ms
2022-09-21 19:03:47 INFO  Executing generated plans
2022-09-21 19:03:59 INFO  ---RUNTIME: Execution took 12078.721046447754 ms
2022-09-21 19:03:59 INFO  Done!
2022-09-21 19:03:59 INFO  # Finished -- repetition 7 of 7 
2022-09-21 19:03:59 INFO  # Final results after all repetitions
2022-09-21 19:03:59 INFO     repetition  ... no_opt_what_if_execution_combined_model_training
0           0  ...                                      3268.979549
1           1  ...                                      3162.921906
2           2  ...                                      3053.411961
3           3  ...                                      3075.725794
4           4  ...                                      4210.499048
5           5  ...                                      3939.920664
6           6  ...                                      3338.454723

[7 rows x 26 columns]
taskset -c 64-71 PROTOCOL_BUFFERS_PYTHON_IMPLEMENTATION=python python3.9 benchmarks_end_to_end.py feature_importance folktables slow_loading featurization_2 neural_network
2022-09-21 19:04:01.984857: W tensorflow/stream_executor/platform/default/dso_loader.cc:64] Could not load dynamic library 'libcudart.so.11.0'; dlerror: libcudart.so.11.0: cannot open shared object file: No such file or directory; LD_LIBRARY_PATH: /home/sgrafbe/mlwhatif/venv/lib/python3.9/site-packages/cv2/../../lib64:
2022-09-21 19:04:01.984893: I tensorflow/stream_executor/cuda/cudart_stub.cc:29] Ignore above cudart dlerror if you do not have a GPU set up on your machine.
2022-09-21 19:04:03 INFO  Patching sys.argv with ['mlwhatif', 'folktables', 'slow_loading', 'featurization_2', 'neural_network']
2022-09-21 19:04:03 INFO  Running instrumented original pipeline...
2022-09-21 19:04:03 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-21 19:04:03 INFO  ---RUNTIME: Importing and monkey-patching took 105.06319999694824 ms
2022-09-21 19:04:04.767447: W tensorflow/stream_executor/platform/default/dso_loader.cc:64] Could not load dynamic library 'libcuda.so.1'; dlerror: libcuda.so.1: cannot open shared object file: No such file or directory; LD_LIBRARY_PATH: /home/sgrafbe/mlwhatif/venv/lib/python3.9/site-packages/cv2/../../lib64:
2022-09-21 19:04:04.767489: W tensorflow/stream_executor/cuda/cuda_driver.cc:326] failed call to cuInit: UNKNOWN ERROR (303)
2022-09-21 19:04:04.767510: I tensorflow/stream_executor/cuda/cuda_diagnostics.cc:156] kernel driver does not appear to be running on this host (wagyu): /proc/driver/nvidia/version does not exist
2022-09-21 19:04:04.767895: I tensorflow/core/platform/cpu_feature_guard.cc:142] This TensorFlow binary is optimized with oneAPI Deep Neural Network Library (oneDNN) to use the following CPU instructions in performance-critical operations:  AVX2 FMA
To enable them in other operations, rebuild TensorFlow with the appropriate compiler flags.
2022-09-21 19:04:05.343445: I tensorflow/compiler/mlir/mlir_graph_optimization_pass.cc:176] None of the MLIR Optimization Passes are enabled (registered 2)
2022-09-21 19:04:05.358385: I tensorflow/core/platform/profile_utils/cpu_utils.cc:114] CPU Frequency: 2595290000 Hz
2022-09-21 19:04:08 INFO  ---RUNTIME: Original pipeline execution took 5325.268268585205 ms (excluding imports and monkey-patching)
2022-09-21 19:04:08 INFO  Starting execution of 0 what-if analyses...
2022-09-21 19:04:08 INFO  Estimated runtime of original DAG is 5043.979167938232ms
2022-09-21 19:04:08 INFO  Performing Multi-Query Optimization
2022-09-21 19:04:08 INFO  Estimated unoptimized what-if runtime is 0ms
2022-09-21 19:04:08 INFO  Estimated optimised what-if runtime is 0ms
2022-09-21 19:04:08 INFO  Estimated optimisation runtime saving is 0ms
2022-09-21 19:04:08 INFO  ---RUNTIME: Multi-Query Optimization took 0.5173683166503906 ms
2022-09-21 19:04:08 INFO  Executing generated plans
2022-09-21 19:04:08 INFO  ---RUNTIME: Execution took 0.02288818359375 ms
2022-09-21 19:04:08 INFO  Done!
2022-09-21 19:04:08 INFO  # Optimization benchmark for feature_importance with args [['folktables', 'slow_loading', 'featurization_2', 'neural_network']] -- repetition 1 of 7
2022-09-21 19:04:08 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-21 19:04:08 INFO  Running instrumented original pipeline...
2022-09-21 19:04:08 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-21 19:04:08 INFO  ---RUNTIME: Importing and monkey-patching took 5.3501129150390625 ms
2022-09-21 19:04:13 INFO  ---RUNTIME: Original pipeline execution took 4969.488859176636 ms (excluding imports and monkey-patching)
2022-09-21 19:04:13 INFO  Starting execution of 1 what-if analyses...
2022-09-21 19:04:13 INFO  Start plan generation for analysis PermutationFeatureImportance...
2022-09-21 19:04:13 INFO  ---RUNTIME: Plan generation took 0.2582073211669922 ms
2022-09-21 19:04:13 INFO  Estimated runtime of original DAG is 4721.430063247681ms
2022-09-21 19:04:13 INFO  Performing Multi-Query Optimization
2022-09-21 19:04:13 INFO  Estimated unoptimized what-if runtime is 37771.440505981445ms
2022-09-21 19:04:13 INFO  Estimated optimised what-if runtime is 5783.264636993408ms
2022-09-21 19:04:13 INFO  Estimated optimisation runtime saving is 31988.175868988037ms
2022-09-21 19:04:13 INFO  ---RUNTIME: Multi-Query Optimization took 17.492294311523438 ms
2022-09-21 19:04:13 INFO  Executing generated plans
2022-09-21 19:04:19 INFO  ---RUNTIME: Execution took 5445.18518447876 ms
2022-09-21 19:04:19 INFO  Done!
2022-09-21 19:04:19 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-21 19:04:19 INFO  Running instrumented original pipeline...
2022-09-21 19:04:19 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-21 19:04:19 INFO  ---RUNTIME: Importing and monkey-patching took 6.046295166015625 ms
2022-09-21 19:04:24 INFO  ---RUNTIME: Original pipeline execution took 5084.863662719727 ms (excluding imports and monkey-patching)
2022-09-21 19:04:24 INFO  Starting execution of 1 what-if analyses...
2022-09-21 19:04:24 INFO  Start plan generation for analysis PermutationFeatureImportance...
2022-09-21 19:04:24 INFO  ---RUNTIME: Plan generation took 0.16498565673828125 ms
2022-09-21 19:04:24 INFO  Estimated runtime of original DAG is 4843.786716461182ms
2022-09-21 19:04:24 WARNING Skipping Multi-Query Optimization (instead, only applying patches)
2022-09-21 19:04:24 INFO  Estimated unoptimised what-if runtime is 38750.29373168945ms
2022-09-21 19:04:24 INFO  ---RUNTIME: Multi-Query Optimization took 6.675004959106445 ms
2022-09-21 19:04:24 INFO  Executing generated plans
2022-09-21 19:05:02 INFO  ---RUNTIME: Execution took 38342.7996635437 ms
2022-09-21 19:05:02 INFO  Done!
2022-09-21 19:05:02 INFO  # Finished -- repetition 1 of 7 
2022-09-21 19:05:02 INFO  # Optimization benchmark for feature_importance with args [['folktables', 'slow_loading', 'featurization_2', 'neural_network']] -- repetition 2 of 7
2022-09-21 19:05:02 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-21 19:05:02 INFO  Running instrumented original pipeline...
2022-09-21 19:05:02 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-21 19:05:02 INFO  ---RUNTIME: Importing and monkey-patching took 6.013631820678711 ms
2022-09-21 19:05:07 INFO  ---RUNTIME: Original pipeline execution took 5043.5826778411865 ms (excluding imports and monkey-patching)
2022-09-21 19:05:07 INFO  Starting execution of 1 what-if analyses...
2022-09-21 19:05:07 INFO  Start plan generation for analysis PermutationFeatureImportance...
2022-09-21 19:05:07 INFO  ---RUNTIME: Plan generation took 0.156402587890625 ms
2022-09-21 19:05:07 INFO  Estimated runtime of original DAG is 4801.04923248291ms
2022-09-21 19:05:07 INFO  Performing Multi-Query Optimization
2022-09-21 19:05:07 INFO  Estimated unoptimized what-if runtime is 38408.39385986328ms
2022-09-21 19:05:07 INFO  Estimated optimised what-if runtime is 5900.316953659058ms
2022-09-21 19:05:07 INFO  Estimated optimisation runtime saving is 32508.076906204224ms
2022-09-21 19:05:07 INFO  ---RUNTIME: Multi-Query Optimization took 17.829418182373047 ms
2022-09-21 19:05:07 INFO  Executing generated plans
2022-09-21 19:05:13 INFO  ---RUNTIME: Execution took 5944.294452667236 ms
2022-09-21 19:05:13 INFO  Done!
2022-09-21 19:05:13 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-21 19:05:13 INFO  Running instrumented original pipeline...
2022-09-21 19:05:13 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-21 19:05:13 INFO  ---RUNTIME: Importing and monkey-patching took 5.867958068847656 ms
2022-09-21 19:05:18 INFO  ---RUNTIME: Original pipeline execution took 4965.525150299072 ms (excluding imports and monkey-patching)
2022-09-21 19:05:18 INFO  Starting execution of 1 what-if analyses...
2022-09-21 19:05:18 INFO  Start plan generation for analysis PermutationFeatureImportance...
2022-09-21 19:05:18 INFO  ---RUNTIME: Plan generation took 0.1430511474609375 ms
2022-09-21 19:05:18 INFO  Estimated runtime of original DAG is 4714.53332901001ms
2022-09-21 19:05:18 WARNING Skipping Multi-Query Optimization (instead, only applying patches)
2022-09-21 19:05:18 INFO  Estimated unoptimised what-if runtime is 37716.26663208008ms
2022-09-21 19:05:18 INFO  ---RUNTIME: Multi-Query Optimization took 5.983829498291016 ms
2022-09-21 19:05:18 INFO  Executing generated plans
2022-09-21 19:05:57 INFO  ---RUNTIME: Execution took 39232.359409332275 ms
2022-09-21 19:05:57 INFO  Done!
2022-09-21 19:05:57 INFO  # Finished -- repetition 2 of 7 
2022-09-21 19:05:57 INFO  # Optimization benchmark for feature_importance with args [['folktables', 'slow_loading', 'featurization_2', 'neural_network']] -- repetition 3 of 7
2022-09-21 19:05:57 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-21 19:05:57 INFO  Running instrumented original pipeline...
2022-09-21 19:05:57 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-21 19:05:57 INFO  ---RUNTIME: Importing and monkey-patching took 6.048917770385742 ms
2022-09-21 19:06:02 INFO  ---RUNTIME: Original pipeline execution took 4941.256284713745 ms (excluding imports and monkey-patching)
2022-09-21 19:06:02 INFO  Starting execution of 1 what-if analyses...
2022-09-21 19:06:02 INFO  Start plan generation for analysis PermutationFeatureImportance...
2022-09-21 19:06:02 INFO  ---RUNTIME: Plan generation took 0.1480579376220703 ms
2022-09-21 19:06:02 INFO  Estimated runtime of original DAG is 4697.053670883179ms
2022-09-21 19:06:02 INFO  Performing Multi-Query Optimization
2022-09-21 19:06:02 INFO  Estimated unoptimized what-if runtime is 37576.42936706543ms
2022-09-21 19:06:02 INFO  Estimated optimised what-if runtime is 5801.530122756958ms
2022-09-21 19:06:02 INFO  Estimated optimisation runtime saving is 31774.89924430847ms
2022-09-21 19:06:02 INFO  ---RUNTIME: Multi-Query Optimization took 17.220258712768555 ms
2022-09-21 19:06:02 INFO  Executing generated plans
2022-09-21 19:06:08 INFO  ---RUNTIME: Execution took 5991.365432739258 ms
2022-09-21 19:06:08 INFO  Done!
2022-09-21 19:06:08 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-21 19:06:08 INFO  Running instrumented original pipeline...
2022-09-21 19:06:08 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-21 19:06:08 INFO  ---RUNTIME: Importing and monkey-patching took 6.399869918823242 ms
2022-09-21 19:06:13 INFO  ---RUNTIME: Original pipeline execution took 4861.815690994263 ms (excluding imports and monkey-patching)
2022-09-21 19:06:13 INFO  Starting execution of 1 what-if analyses...
2022-09-21 19:06:13 INFO  Start plan generation for analysis PermutationFeatureImportance...
2022-09-21 19:06:13 INFO  ---RUNTIME: Plan generation took 0.1316070556640625 ms
2022-09-21 19:06:13 INFO  Estimated runtime of original DAG is 4611.3245487213135ms
2022-09-21 19:06:13 WARNING Skipping Multi-Query Optimization (instead, only applying patches)
2022-09-21 19:06:13 INFO  Estimated unoptimised what-if runtime is 36890.59638977051ms
2022-09-21 19:06:13 INFO  ---RUNTIME: Multi-Query Optimization took 5.790472030639648 ms
2022-09-21 19:06:13 INFO  Executing generated plans
2022-09-21 19:06:52 INFO  ---RUNTIME: Execution took 39257.95006752014 ms
2022-09-21 19:06:52 INFO  Done!
2022-09-21 19:06:52 INFO  # Finished -- repetition 3 of 7 
2022-09-21 19:06:52 INFO  # Optimization benchmark for feature_importance with args [['folktables', 'slow_loading', 'featurization_2', 'neural_network']] -- repetition 4 of 7
2022-09-21 19:06:52 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-21 19:06:52 INFO  Running instrumented original pipeline...
2022-09-21 19:06:52 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-21 19:06:52 INFO  ---RUNTIME: Importing and monkey-patching took 6.279468536376953 ms
2022-09-21 19:06:57 INFO  ---RUNTIME: Original pipeline execution took 4992.420434951782 ms (excluding imports and monkey-patching)
2022-09-21 19:06:57 INFO  Starting execution of 1 what-if analyses...
2022-09-21 19:06:57 INFO  Start plan generation for analysis PermutationFeatureImportance...
2022-09-21 19:06:57 INFO  ---RUNTIME: Plan generation took 0.13113021850585938 ms
2022-09-21 19:06:57 INFO  Estimated runtime of original DAG is 4738.563537597656ms
2022-09-21 19:06:57 INFO  Performing Multi-Query Optimization
2022-09-21 19:06:57 INFO  Estimated unoptimized what-if runtime is 37908.50830078125ms
2022-09-21 19:06:57 INFO  Estimated optimised what-if runtime is 5989.113807678223ms
2022-09-21 19:06:57 INFO  Estimated optimisation runtime saving is 31919.394493103027ms
2022-09-21 19:06:57 INFO  ---RUNTIME: Multi-Query Optimization took 18.86153221130371 ms
2022-09-21 19:06:57 INFO  Executing generated plans
2022-09-21 19:07:03 INFO  ---RUNTIME: Execution took 5765.126466751099 ms
2022-09-21 19:07:03 INFO  Done!
2022-09-21 19:07:03 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-21 19:07:03 INFO  Running instrumented original pipeline...
2022-09-21 19:07:03 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-21 19:07:03 INFO  ---RUNTIME: Importing and monkey-patching took 6.126165390014648 ms
2022-09-21 19:07:08 INFO  ---RUNTIME: Original pipeline execution took 4960.159778594971 ms (excluding imports and monkey-patching)
2022-09-21 19:07:08 INFO  Starting execution of 1 what-if analyses...
2022-09-21 19:07:08 INFO  Start plan generation for analysis PermutationFeatureImportance...
2022-09-21 19:07:08 INFO  ---RUNTIME: Plan generation took 0.13518333435058594 ms
2022-09-21 19:07:08 INFO  Estimated runtime of original DAG is 4713.0537033081055ms
2022-09-21 19:07:08 WARNING Skipping Multi-Query Optimization (instead, only applying patches)
2022-09-21 19:07:08 INFO  Estimated unoptimised what-if runtime is 37704.429626464844ms
2022-09-21 19:07:08 INFO  ---RUNTIME: Multi-Query Optimization took 5.826234817504883 ms
2022-09-21 19:07:08 INFO  Executing generated plans
2022-09-21 19:07:47 INFO  ---RUNTIME: Execution took 38483.08539390564 ms
2022-09-21 19:07:47 INFO  Done!
2022-09-21 19:07:47 INFO  # Finished -- repetition 4 of 7 
2022-09-21 19:07:47 INFO  # Optimization benchmark for feature_importance with args [['folktables', 'slow_loading', 'featurization_2', 'neural_network']] -- repetition 5 of 7
2022-09-21 19:07:47 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-21 19:07:47 INFO  Running instrumented original pipeline...
2022-09-21 19:07:47 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-21 19:07:47 INFO  ---RUNTIME: Importing and monkey-patching took 5.95402717590332 ms
2022-09-21 19:07:52 INFO  ---RUNTIME: Original pipeline execution took 5045.95685005188 ms (excluding imports and monkey-patching)
2022-09-21 19:07:52 INFO  Starting execution of 1 what-if analyses...
2022-09-21 19:07:52 INFO  Start plan generation for analysis PermutationFeatureImportance...
2022-09-21 19:07:52 INFO  ---RUNTIME: Plan generation took 0.1308917999267578 ms
2022-09-21 19:07:52 INFO  Estimated runtime of original DAG is 4790.793180465698ms
2022-09-21 19:07:52 INFO  Performing Multi-Query Optimization
2022-09-21 19:07:52 INFO  Estimated unoptimized what-if runtime is 38326.345443725586ms
2022-09-21 19:07:52 INFO  Estimated optimised what-if runtime is 6010.286092758179ms
2022-09-21 19:07:52 INFO  Estimated optimisation runtime saving is 32316.059350967407ms
2022-09-21 19:07:52 INFO  ---RUNTIME: Multi-Query Optimization took 16.936779022216797 ms
2022-09-21 19:07:52 INFO  Executing generated plans
2022-09-21 19:07:57 INFO  ---RUNTIME: Execution took 5660.959482192993 ms
2022-09-21 19:07:57 INFO  Done!
2022-09-21 19:07:57 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-21 19:07:57 INFO  Running instrumented original pipeline...
2022-09-21 19:07:58 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-21 19:07:58 INFO  ---RUNTIME: Importing and monkey-patching took 5.724430084228516 ms
2022-09-21 19:08:03 INFO  ---RUNTIME: Original pipeline execution took 5511.475086212158 ms (excluding imports and monkey-patching)
2022-09-21 19:08:03 INFO  Starting execution of 1 what-if analyses...
2022-09-21 19:08:03 INFO  Start plan generation for analysis PermutationFeatureImportance...
2022-09-21 19:08:03 INFO  ---RUNTIME: Plan generation took 0.1614093780517578 ms
2022-09-21 19:08:03 INFO  Estimated runtime of original DAG is 4861.511707305908ms
2022-09-21 19:08:03 WARNING Skipping Multi-Query Optimization (instead, only applying patches)
2022-09-21 19:08:03 INFO  Estimated unoptimised what-if runtime is 38892.093658447266ms
2022-09-21 19:08:03 INFO  ---RUNTIME: Multi-Query Optimization took 6.315469741821289 ms
2022-09-21 19:08:03 INFO  Executing generated plans
2022-09-21 19:08:42 INFO  ---RUNTIME: Execution took 38572.24416732788 ms
2022-09-21 19:08:42 INFO  Done!
2022-09-21 19:08:42 INFO  # Finished -- repetition 5 of 7 
2022-09-21 19:08:42 INFO  # Optimization benchmark for feature_importance with args [['folktables', 'slow_loading', 'featurization_2', 'neural_network']] -- repetition 6 of 7
2022-09-21 19:08:42 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-21 19:08:42 INFO  Running instrumented original pipeline...
2022-09-21 19:08:42 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-21 19:08:42 INFO  ---RUNTIME: Importing and monkey-patching took 5.964756011962891 ms
2022-09-21 19:08:47 INFO  ---RUNTIME: Original pipeline execution took 5013.020038604736 ms (excluding imports and monkey-patching)
2022-09-21 19:08:47 INFO  Starting execution of 1 what-if analyses...
2022-09-21 19:08:47 INFO  Start plan generation for analysis PermutationFeatureImportance...
2022-09-21 19:08:47 INFO  ---RUNTIME: Plan generation took 0.1289844512939453 ms
2022-09-21 19:08:47 INFO  Estimated runtime of original DAG is 4765.340328216553ms
2022-09-21 19:08:47 INFO  Performing Multi-Query Optimization
2022-09-21 19:08:47 INFO  Estimated unoptimized what-if runtime is 38122.72262573242ms
2022-09-21 19:08:47 INFO  Estimated optimised what-if runtime is 5882.830381393433ms
2022-09-21 19:08:47 INFO  Estimated optimisation runtime saving is 32239.89224433899ms
2022-09-21 19:08:47 INFO  ---RUNTIME: Multi-Query Optimization took 16.738414764404297 ms
2022-09-21 19:08:47 INFO  Executing generated plans
2022-09-21 19:08:52 INFO  ---RUNTIME: Execution took 5459.776163101196 ms
2022-09-21 19:08:52 INFO  Done!
2022-09-21 19:08:52 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-21 19:08:52 INFO  Running instrumented original pipeline...
2022-09-21 19:08:52 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-21 19:08:52 INFO  ---RUNTIME: Importing and monkey-patching took 5.538702011108398 ms
2022-09-21 19:08:57 INFO  ---RUNTIME: Original pipeline execution took 5282.613515853882 ms (excluding imports and monkey-patching)
2022-09-21 19:08:57 INFO  Starting execution of 1 what-if analyses...
2022-09-21 19:08:57 INFO  Start plan generation for analysis PermutationFeatureImportance...
2022-09-21 19:08:57 INFO  ---RUNTIME: Plan generation took 0.12803077697753906 ms
2022-09-21 19:08:57 INFO  Estimated runtime of original DAG is 5037.980556488037ms
2022-09-21 19:08:57 WARNING Skipping Multi-Query Optimization (instead, only applying patches)
2022-09-21 19:08:57 INFO  Estimated unoptimised what-if runtime is 40303.8444519043ms
2022-09-21 19:08:57 INFO  ---RUNTIME: Multi-Query Optimization took 5.806446075439453 ms
2022-09-21 19:08:57 INFO  Executing generated plans
2022-09-21 19:09:36 INFO  ---RUNTIME: Execution took 39014.55092430115 ms
2022-09-21 19:09:36 INFO  Done!
2022-09-21 19:09:36 INFO  # Finished -- repetition 6 of 7 
2022-09-21 19:09:36 INFO  # Optimization benchmark for feature_importance with args [['folktables', 'slow_loading', 'featurization_2', 'neural_network']] -- repetition 7 of 7
2022-09-21 19:09:36 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-21 19:09:36 INFO  Running instrumented original pipeline...
2022-09-21 19:09:36 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-21 19:09:36 INFO  ---RUNTIME: Importing and monkey-patching took 6.206989288330078 ms
2022-09-21 19:09:41 INFO  ---RUNTIME: Original pipeline execution took 4899.033308029175 ms (excluding imports and monkey-patching)
2022-09-21 19:09:41 INFO  Starting execution of 1 what-if analyses...
2022-09-21 19:09:41 INFO  Start plan generation for analysis PermutationFeatureImportance...
2022-09-21 19:09:41 INFO  ---RUNTIME: Plan generation took 0.13184547424316406 ms
2022-09-21 19:09:41 INFO  Estimated runtime of original DAG is 4650.619745254517ms
2022-09-21 19:09:41 INFO  Performing Multi-Query Optimization
2022-09-21 19:09:41 INFO  Estimated unoptimized what-if runtime is 37204.95796203613ms
2022-09-21 19:09:41 INFO  Estimated optimised what-if runtime is 5860.463619232178ms
2022-09-21 19:09:41 INFO  Estimated optimisation runtime saving is 31344.494342803955ms
2022-09-21 19:09:41 INFO  ---RUNTIME: Multi-Query Optimization took 18.278837203979492 ms
2022-09-21 19:09:41 INFO  Executing generated plans
2022-09-21 19:09:47 INFO  ---RUNTIME: Execution took 5470.735549926758 ms
2022-09-21 19:09:47 INFO  Done!
2022-09-21 19:09:47 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-21 19:09:47 INFO  Running instrumented original pipeline...
2022-09-21 19:09:47 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-21 19:09:47 INFO  ---RUNTIME: Importing and monkey-patching took 5.528926849365234 ms
2022-09-21 19:09:52 INFO  ---RUNTIME: Original pipeline execution took 4979.213714599609 ms (excluding imports and monkey-patching)
2022-09-21 19:09:52 INFO  Starting execution of 1 what-if analyses...
2022-09-21 19:09:52 INFO  Start plan generation for analysis PermutationFeatureImportance...
2022-09-21 19:09:52 INFO  ---RUNTIME: Plan generation took 0.12278556823730469 ms
2022-09-21 19:09:52 INFO  Estimated runtime of original DAG is 4726.732015609741ms
2022-09-21 19:09:52 WARNING Skipping Multi-Query Optimization (instead, only applying patches)
2022-09-21 19:09:52 INFO  Estimated unoptimised what-if runtime is 37813.85612487793ms
2022-09-21 19:09:52 INFO  ---RUNTIME: Multi-Query Optimization took 6.508588790893555 ms
2022-09-21 19:09:52 INFO  Executing generated plans
2022-09-21 19:10:30 INFO  ---RUNTIME: Execution took 38673.10333251953 ms
2022-09-21 19:10:30 INFO  Done!
2022-09-21 19:10:30 INFO  # Finished -- repetition 7 of 7 
2022-09-21 19:10:30 INFO  # Final results after all repetitions
2022-09-21 19:10:30 INFO     repetition  ... no_opt_what_if_execution_combined_model_training
0           0  ...                                     28619.368076
1           1  ...                                     29300.711870
2           2  ...                                     28934.854984
3           3  ...                                     28564.439774
4           4  ...                                     28737.237215
5           5  ...                                     28884.806871
6           6  ...                                     28732.382059

[7 rows x 26 columns]
taskset -c 64-71 PROTOCOL_BUFFERS_PYTHON_IMPLEMENTATION=python python3.9 benchmarks_end_to_end.py feature_importance folktables slow_loading featurization_3 logistic_regression
2022-09-21 19:10:33.384514: W tensorflow/stream_executor/platform/default/dso_loader.cc:64] Could not load dynamic library 'libcudart.so.11.0'; dlerror: libcudart.so.11.0: cannot open shared object file: No such file or directory; LD_LIBRARY_PATH: /home/sgrafbe/mlwhatif/venv/lib/python3.9/site-packages/cv2/../../lib64:
2022-09-21 19:10:33.384550: I tensorflow/stream_executor/cuda/cudart_stub.cc:29] Ignore above cudart dlerror if you do not have a GPU set up on your machine.
2022-09-21 19:10:34 INFO  Patching sys.argv with ['mlwhatif', 'folktables', 'slow_loading', 'featurization_3', 'logistic_regression']
2022-09-21 19:10:34 INFO  Running instrumented original pipeline...
2022-09-21 19:10:34 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-21 19:10:34 INFO  ---RUNTIME: Importing and monkey-patching took 96.19927406311035 ms
2022-09-21 19:10:36 INFO  ---RUNTIME: Original pipeline execution took 1429.5787811279297 ms (excluding imports and monkey-patching)
2022-09-21 19:10:36 INFO  Starting execution of 0 what-if analyses...
2022-09-21 19:10:36 INFO  Estimated runtime of original DAG is 1142.9204940795898ms
2022-09-21 19:10:36 INFO  Performing Multi-Query Optimization
2022-09-21 19:10:36 INFO  Estimated unoptimized what-if runtime is 0ms
2022-09-21 19:10:36 INFO  Estimated optimised what-if runtime is 0ms
2022-09-21 19:10:36 INFO  Estimated optimisation runtime saving is 0ms
2022-09-21 19:10:36 INFO  ---RUNTIME: Multi-Query Optimization took 0.4830360412597656 ms
2022-09-21 19:10:36 INFO  Executing generated plans
2022-09-21 19:10:36 INFO  ---RUNTIME: Execution took 0.016927719116210938 ms
2022-09-21 19:10:36 INFO  Done!
2022-09-21 19:10:36 INFO  # Optimization benchmark for feature_importance with args [['folktables', 'slow_loading', 'featurization_3', 'logistic_regression']] -- repetition 1 of 7
2022-09-21 19:10:36 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-21 19:10:36 INFO  Running instrumented original pipeline...
2022-09-21 19:10:36 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-21 19:10:36 INFO  ---RUNTIME: Importing and monkey-patching took 5.102872848510742 ms
2022-09-21 19:10:37 INFO  ---RUNTIME: Original pipeline execution took 1395.8065509796143 ms (excluding imports and monkey-patching)
2022-09-21 19:10:37 INFO  Starting execution of 1 what-if analyses...
2022-09-21 19:10:37 INFO  Start plan generation for analysis PermutationFeatureImportance...
2022-09-21 19:10:37 INFO  ---RUNTIME: Plan generation took 0.2605915069580078 ms
2022-09-21 19:10:37 INFO  Estimated runtime of original DAG is 1141.8094635009766ms
2022-09-21 19:10:37 INFO  Performing Multi-Query Optimization
2022-09-21 19:10:37 INFO  Estimated unoptimized what-if runtime is 9134.475708007812ms
2022-09-21 19:10:37 INFO  Estimated optimised what-if runtime is 1181.0905933380127ms
2022-09-21 19:10:37 INFO  Estimated optimisation runtime saving is 7953.3851146698ms
2022-09-21 19:10:37 INFO  ---RUNTIME: Multi-Query Optimization took 19.583940505981445 ms
2022-09-21 19:10:37 INFO  Executing generated plans
2022-09-21 19:10:38 INFO  ---RUNTIME: Execution took 1327.364444732666 ms
2022-09-21 19:10:38 INFO  Done!
2022-09-21 19:10:38 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-21 19:10:38 INFO  Running instrumented original pipeline...
2022-09-21 19:10:39 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-21 19:10:39 INFO  ---RUNTIME: Importing and monkey-patching took 6.1092376708984375 ms
2022-09-21 19:10:40 INFO  ---RUNTIME: Original pipeline execution took 1586.0025882720947 ms (excluding imports and monkey-patching)
2022-09-21 19:10:40 INFO  Starting execution of 1 what-if analyses...
2022-09-21 19:10:40 INFO  Start plan generation for analysis PermutationFeatureImportance...
2022-09-21 19:10:40 INFO  ---RUNTIME: Plan generation took 0.1327991485595703 ms
2022-09-21 19:10:40 INFO  Estimated runtime of original DAG is 1171.466588973999ms
2022-09-21 19:10:40 WARNING Skipping Multi-Query Optimization (instead, only applying patches)
2022-09-21 19:10:40 INFO  Estimated unoptimised what-if runtime is 9371.732711791992ms
2022-09-21 19:10:40 INFO  ---RUNTIME: Multi-Query Optimization took 7.018804550170898 ms
2022-09-21 19:10:40 INFO  Executing generated plans
2022-09-21 19:10:50 INFO  ---RUNTIME: Execution took 9767.521858215332 ms
2022-09-21 19:10:50 INFO  Done!
2022-09-21 19:10:50 INFO  # Finished -- repetition 1 of 7 
2022-09-21 19:10:50 INFO  # Optimization benchmark for feature_importance with args [['folktables', 'slow_loading', 'featurization_3', 'logistic_regression']] -- repetition 2 of 7
2022-09-21 19:10:50 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-21 19:10:50 INFO  Running instrumented original pipeline...
2022-09-21 19:10:50 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-21 19:10:50 INFO  ---RUNTIME: Importing and monkey-patching took 6.026029586791992 ms
2022-09-21 19:10:51 INFO  ---RUNTIME: Original pipeline execution took 1388.8237476348877 ms (excluding imports and monkey-patching)
2022-09-21 19:10:51 INFO  Starting execution of 1 what-if analyses...
2022-09-21 19:10:51 INFO  Start plan generation for analysis PermutationFeatureImportance...
2022-09-21 19:10:51 INFO  ---RUNTIME: Plan generation took 0.1590251922607422 ms
2022-09-21 19:10:51 INFO  Estimated runtime of original DAG is 1127.9699802398682ms
2022-09-21 19:10:51 INFO  Performing Multi-Query Optimization
2022-09-21 19:10:51 INFO  Estimated unoptimized what-if runtime is 9023.759841918945ms
2022-09-21 19:10:51 INFO  Estimated optimised what-if runtime is 1167.0136451721191ms
2022-09-21 19:10:51 INFO  Estimated optimisation runtime saving is 7856.746196746826ms
2022-09-21 19:10:51 INFO  ---RUNTIME: Multi-Query Optimization took 18.7075138092041 ms
2022-09-21 19:10:51 INFO  Executing generated plans
2022-09-21 19:10:52 INFO  ---RUNTIME: Execution took 1238.5728359222412 ms
2022-09-21 19:10:52 INFO  Done!
2022-09-21 19:10:52 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-21 19:10:52 INFO  Running instrumented original pipeline...
2022-09-21 19:10:53 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-21 19:10:53 INFO  ---RUNTIME: Importing and monkey-patching took 5.528926849365234 ms
2022-09-21 19:10:54 INFO  ---RUNTIME: Original pipeline execution took 1385.305404663086 ms (excluding imports and monkey-patching)
2022-09-21 19:10:54 INFO  Starting execution of 1 what-if analyses...
2022-09-21 19:10:54 INFO  Start plan generation for analysis PermutationFeatureImportance...
2022-09-21 19:10:54 INFO  ---RUNTIME: Plan generation took 0.13256072998046875 ms
2022-09-21 19:10:54 INFO  Estimated runtime of original DAG is 1119.5440292358398ms
2022-09-21 19:10:54 WARNING Skipping Multi-Query Optimization (instead, only applying patches)
2022-09-21 19:10:54 INFO  Estimated unoptimised what-if runtime is 8956.352233886719ms
2022-09-21 19:10:54 INFO  ---RUNTIME: Multi-Query Optimization took 7.30133056640625 ms
2022-09-21 19:10:54 INFO  Executing generated plans
2022-09-21 19:11:04 INFO  ---RUNTIME: Execution took 9659.059047698975 ms
2022-09-21 19:11:04 INFO  Done!
2022-09-21 19:11:04 INFO  # Finished -- repetition 2 of 7 
2022-09-21 19:11:04 INFO  # Optimization benchmark for feature_importance with args [['folktables', 'slow_loading', 'featurization_3', 'logistic_regression']] -- repetition 3 of 7
2022-09-21 19:11:04 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-21 19:11:04 INFO  Running instrumented original pipeline...
2022-09-21 19:11:04 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-21 19:11:04 INFO  ---RUNTIME: Importing and monkey-patching took 6.54911994934082 ms
2022-09-21 19:11:05 INFO  ---RUNTIME: Original pipeline execution took 1372.2195625305176 ms (excluding imports and monkey-patching)
2022-09-21 19:11:05 INFO  Starting execution of 1 what-if analyses...
2022-09-21 19:11:05 INFO  Start plan generation for analysis PermutationFeatureImportance...
2022-09-21 19:11:05 INFO  ---RUNTIME: Plan generation took 0.16188621520996094 ms
2022-09-21 19:11:05 INFO  Estimated runtime of original DAG is 1102.2453308105469ms
2022-09-21 19:11:05 INFO  Performing Multi-Query Optimization
2022-09-21 19:11:05 INFO  Estimated unoptimized what-if runtime is 8817.962646484375ms
2022-09-21 19:11:05 INFO  Estimated optimised what-if runtime is 1138.6709213256836ms
2022-09-21 19:11:05 INFO  Estimated optimisation runtime saving is 7679.291725158691ms
2022-09-21 19:11:05 INFO  ---RUNTIME: Multi-Query Optimization took 17.606496810913086 ms
2022-09-21 19:11:05 INFO  Executing generated plans
2022-09-21 19:11:06 INFO  ---RUNTIME: Execution took 1212.9018306732178 ms
2022-09-21 19:11:06 INFO  Done!
2022-09-21 19:11:06 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-21 19:11:06 INFO  Running instrumented original pipeline...
2022-09-21 19:11:06 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-21 19:11:06 INFO  ---RUNTIME: Importing and monkey-patching took 5.654811859130859 ms
2022-09-21 19:11:08 INFO  ---RUNTIME: Original pipeline execution took 1371.150016784668 ms (excluding imports and monkey-patching)
2022-09-21 19:11:08 INFO  Starting execution of 1 what-if analyses...
2022-09-21 19:11:08 INFO  Start plan generation for analysis PermutationFeatureImportance...
2022-09-21 19:11:08 INFO  ---RUNTIME: Plan generation took 0.12493133544921875 ms
2022-09-21 19:11:08 INFO  Estimated runtime of original DAG is 1110.3136539459229ms
2022-09-21 19:11:08 WARNING Skipping Multi-Query Optimization (instead, only applying patches)
2022-09-21 19:11:08 INFO  Estimated unoptimised what-if runtime is 8882.509231567383ms
2022-09-21 19:11:08 INFO  ---RUNTIME: Multi-Query Optimization took 6.686210632324219 ms
2022-09-21 19:11:08 INFO  Executing generated plans
2022-09-21 19:11:17 INFO  ---RUNTIME: Execution took 9747.914791107178 ms
2022-09-21 19:11:17 INFO  Done!
2022-09-21 19:11:17 INFO  # Finished -- repetition 3 of 7 
2022-09-21 19:11:17 INFO  # Optimization benchmark for feature_importance with args [['folktables', 'slow_loading', 'featurization_3', 'logistic_regression']] -- repetition 4 of 7
2022-09-21 19:11:17 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-21 19:11:17 INFO  Running instrumented original pipeline...
2022-09-21 19:11:17 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-21 19:11:17 INFO  ---RUNTIME: Importing and monkey-patching took 6.538152694702148 ms
2022-09-21 19:11:19 INFO  ---RUNTIME: Original pipeline execution took 1535.2795124053955 ms (excluding imports and monkey-patching)
2022-09-21 19:11:19 INFO  Starting execution of 1 what-if analyses...
2022-09-21 19:11:19 INFO  Start plan generation for analysis PermutationFeatureImportance...
2022-09-21 19:11:19 INFO  ---RUNTIME: Plan generation took 0.13136863708496094 ms
2022-09-21 19:11:19 INFO  Estimated runtime of original DAG is 1262.2387409210205ms
2022-09-21 19:11:19 INFO  Performing Multi-Query Optimization
2022-09-21 19:11:19 INFO  Estimated unoptimized what-if runtime is 10097.909927368164ms
2022-09-21 19:11:19 INFO  Estimated optimised what-if runtime is 1298.0000972747803ms
2022-09-21 19:11:19 INFO  Estimated optimisation runtime saving is 8799.909830093384ms
2022-09-21 19:11:19 INFO  ---RUNTIME: Multi-Query Optimization took 18.399715423583984 ms
2022-09-21 19:11:19 INFO  Executing generated plans
2022-09-21 19:11:20 INFO  ---RUNTIME: Execution took 1172.365427017212 ms
2022-09-21 19:11:20 INFO  Done!
2022-09-21 19:11:20 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-21 19:11:20 INFO  Running instrumented original pipeline...
2022-09-21 19:11:20 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-21 19:11:20 INFO  ---RUNTIME: Importing and monkey-patching took 6.440877914428711 ms
2022-09-21 19:11:22 INFO  ---RUNTIME: Original pipeline execution took 1604.6216487884521 ms (excluding imports and monkey-patching)
2022-09-21 19:11:22 INFO  Starting execution of 1 what-if analyses...
2022-09-21 19:11:22 INFO  Start plan generation for analysis PermutationFeatureImportance...
2022-09-21 19:11:22 INFO  ---RUNTIME: Plan generation took 0.20599365234375 ms
2022-09-21 19:11:22 INFO  Estimated runtime of original DAG is 1141.5996551513672ms
2022-09-21 19:11:22 WARNING Skipping Multi-Query Optimization (instead, only applying patches)
2022-09-21 19:11:22 INFO  Estimated unoptimised what-if runtime is 9132.797241210938ms
2022-09-21 19:11:22 INFO  ---RUNTIME: Multi-Query Optimization took 7.227659225463867 ms
2022-09-21 19:11:22 INFO  Executing generated plans
2022-09-21 19:11:31 INFO  ---RUNTIME: Execution took 9836.984634399414 ms
2022-09-21 19:11:31 INFO  Done!
2022-09-21 19:11:31 INFO  # Finished -- repetition 4 of 7 
2022-09-21 19:11:31 INFO  # Optimization benchmark for feature_importance with args [['folktables', 'slow_loading', 'featurization_3', 'logistic_regression']] -- repetition 5 of 7
2022-09-21 19:11:31 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-21 19:11:31 INFO  Running instrumented original pipeline...
2022-09-21 19:11:32 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-21 19:11:32 INFO  ---RUNTIME: Importing and monkey-patching took 6.026029586791992 ms
2022-09-21 19:11:33 INFO  ---RUNTIME: Original pipeline execution took 1384.1993808746338 ms (excluding imports and monkey-patching)
2022-09-21 19:11:33 INFO  Starting execution of 1 what-if analyses...
2022-09-21 19:11:33 INFO  Start plan generation for analysis PermutationFeatureImportance...
2022-09-21 19:11:33 INFO  ---RUNTIME: Plan generation took 0.12445449829101562 ms
2022-09-21 19:11:33 INFO  Estimated runtime of original DAG is 1127.9172897338867ms
2022-09-21 19:11:33 INFO  Performing Multi-Query Optimization
2022-09-21 19:11:33 INFO  Estimated unoptimized what-if runtime is 9023.338317871094ms
2022-09-21 19:11:33 INFO  Estimated optimised what-if runtime is 1163.8786792755127ms
2022-09-21 19:11:33 INFO  Estimated optimisation runtime saving is 7859.459638595581ms
2022-09-21 19:11:33 INFO  ---RUNTIME: Multi-Query Optimization took 17.69566535949707 ms
2022-09-21 19:11:33 INFO  Executing generated plans
2022-09-21 19:11:34 INFO  ---RUNTIME: Execution took 1181.938886642456 ms
2022-09-21 19:11:34 INFO  Done!
2022-09-21 19:11:34 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-21 19:11:34 INFO  Running instrumented original pipeline...
2022-09-21 19:11:34 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-21 19:11:34 INFO  ---RUNTIME: Importing and monkey-patching took 5.483865737915039 ms
2022-09-21 19:11:35 INFO  ---RUNTIME: Original pipeline execution took 1321.3269710540771 ms (excluding imports and monkey-patching)
2022-09-21 19:11:35 INFO  Starting execution of 1 what-if analyses...
2022-09-21 19:11:35 INFO  Start plan generation for analysis PermutationFeatureImportance...
2022-09-21 19:11:35 INFO  ---RUNTIME: Plan generation took 0.14662742614746094 ms
2022-09-21 19:11:35 INFO  Estimated runtime of original DAG is 1072.460412979126ms
2022-09-21 19:11:35 WARNING Skipping Multi-Query Optimization (instead, only applying patches)
2022-09-21 19:11:35 INFO  Estimated unoptimised what-if runtime is 8579.683303833008ms
2022-09-21 19:11:35 INFO  ---RUNTIME: Multi-Query Optimization took 6.242275238037109 ms
2022-09-21 19:11:35 INFO  Executing generated plans
2022-09-21 19:11:45 INFO  ---RUNTIME: Execution took 9141.762018203735 ms
2022-09-21 19:11:45 INFO  Done!
2022-09-21 19:11:45 INFO  # Finished -- repetition 5 of 7 
2022-09-21 19:11:45 INFO  # Optimization benchmark for feature_importance with args [['folktables', 'slow_loading', 'featurization_3', 'logistic_regression']] -- repetition 6 of 7
2022-09-21 19:11:45 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-21 19:11:45 INFO  Running instrumented original pipeline...
2022-09-21 19:11:45 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-21 19:11:45 INFO  ---RUNTIME: Importing and monkey-patching took 5.724906921386719 ms
2022-09-21 19:11:46 INFO  ---RUNTIME: Original pipeline execution took 1344.5231914520264 ms (excluding imports and monkey-patching)
2022-09-21 19:11:46 INFO  Starting execution of 1 what-if analyses...
2022-09-21 19:11:46 INFO  Start plan generation for analysis PermutationFeatureImportance...
2022-09-21 19:11:46 INFO  ---RUNTIME: Plan generation took 0.1621246337890625 ms
2022-09-21 19:11:46 INFO  Estimated runtime of original DAG is 1087.9817008972168ms
2022-09-21 19:11:46 INFO  Performing Multi-Query Optimization
2022-09-21 19:11:46 INFO  Estimated unoptimized what-if runtime is 8703.853607177734ms
2022-09-21 19:11:46 INFO  Estimated optimised what-if runtime is 1123.7096786499023ms
2022-09-21 19:11:46 INFO  Estimated optimisation runtime saving is 7580.143928527832ms
2022-09-21 19:11:46 INFO  ---RUNTIME: Multi-Query Optimization took 18.25881004333496 ms
2022-09-21 19:11:46 INFO  Executing generated plans
2022-09-21 19:11:47 INFO  ---RUNTIME: Execution took 1248.236894607544 ms
2022-09-21 19:11:47 INFO  Done!
2022-09-21 19:11:47 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-21 19:11:47 INFO  Running instrumented original pipeline...
2022-09-21 19:11:47 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-21 19:11:47 INFO  ---RUNTIME: Importing and monkey-patching took 5.68079948425293 ms
2022-09-21 19:11:49 INFO  ---RUNTIME: Original pipeline execution took 1354.4354438781738 ms (excluding imports and monkey-patching)
2022-09-21 19:11:49 INFO  Starting execution of 1 what-if analyses...
2022-09-21 19:11:49 INFO  Start plan generation for analysis PermutationFeatureImportance...
2022-09-21 19:11:49 INFO  ---RUNTIME: Plan generation took 0.16832351684570312 ms
2022-09-21 19:11:49 INFO  Estimated runtime of original DAG is 1102.6434898376465ms
2022-09-21 19:11:49 WARNING Skipping Multi-Query Optimization (instead, only applying patches)
2022-09-21 19:11:49 INFO  Estimated unoptimised what-if runtime is 8821.147918701172ms
2022-09-21 19:11:49 INFO  ---RUNTIME: Multi-Query Optimization took 6.17527961730957 ms
2022-09-21 19:11:49 INFO  Executing generated plans
2022-09-21 19:11:58 INFO  ---RUNTIME: Execution took 9505.885124206543 ms
2022-09-21 19:11:58 INFO  Done!
2022-09-21 19:11:58 INFO  # Finished -- repetition 6 of 7 
2022-09-21 19:11:58 INFO  # Optimization benchmark for feature_importance with args [['folktables', 'slow_loading', 'featurization_3', 'logistic_regression']] -- repetition 7 of 7
2022-09-21 19:11:58 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-21 19:11:58 INFO  Running instrumented original pipeline...
2022-09-21 19:11:58 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-21 19:11:58 INFO  ---RUNTIME: Importing and monkey-patching took 5.880594253540039 ms
2022-09-21 19:12:00 INFO  ---RUNTIME: Original pipeline execution took 1449.4967460632324 ms (excluding imports and monkey-patching)
2022-09-21 19:12:00 INFO  Starting execution of 1 what-if analyses...
2022-09-21 19:12:00 INFO  Start plan generation for analysis PermutationFeatureImportance...
2022-09-21 19:12:00 INFO  ---RUNTIME: Plan generation took 0.12993812561035156 ms
2022-09-21 19:12:00 INFO  Estimated runtime of original DAG is 1194.6690082550049ms
2022-09-21 19:12:00 INFO  Performing Multi-Query Optimization
2022-09-21 19:12:00 INFO  Estimated unoptimized what-if runtime is 9557.352066040039ms
2022-09-21 19:12:00 INFO  Estimated optimised what-if runtime is 1230.971336364746ms
2022-09-21 19:12:00 INFO  Estimated optimisation runtime saving is 8326.380729675293ms
2022-09-21 19:12:00 INFO  ---RUNTIME: Multi-Query Optimization took 18.35489273071289 ms
2022-09-21 19:12:00 INFO  Executing generated plans
2022-09-21 19:12:01 INFO  ---RUNTIME: Execution took 1220.3750610351562 ms
2022-09-21 19:12:01 INFO  Done!
2022-09-21 19:12:01 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-21 19:12:01 INFO  Running instrumented original pipeline...
2022-09-21 19:12:01 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-21 19:12:01 INFO  ---RUNTIME: Importing and monkey-patching took 5.6743621826171875 ms
2022-09-21 19:12:02 INFO  ---RUNTIME: Original pipeline execution took 1345.9181785583496 ms (excluding imports and monkey-patching)
2022-09-21 19:12:02 INFO  Starting execution of 1 what-if analyses...
2022-09-21 19:12:02 INFO  Start plan generation for analysis PermutationFeatureImportance...
2022-09-21 19:12:02 INFO  ---RUNTIME: Plan generation took 0.13399124145507812 ms
2022-09-21 19:12:02 INFO  Estimated runtime of original DAG is 1080.9495449066162ms
2022-09-21 19:12:02 WARNING Skipping Multi-Query Optimization (instead, only applying patches)
2022-09-21 19:12:02 INFO  Estimated unoptimised what-if runtime is 8647.59635925293ms
2022-09-21 19:12:02 INFO  ---RUNTIME: Multi-Query Optimization took 6.997823715209961 ms
2022-09-21 19:12:02 INFO  Executing generated plans
2022-09-21 19:12:12 INFO  ---RUNTIME: Execution took 9444.551229476929 ms
2022-09-21 19:12:12 INFO  Done!
2022-09-21 19:12:12 INFO  # Finished -- repetition 7 of 7 
2022-09-21 19:12:12 INFO  # Final results after all repetitions
2022-09-21 19:12:12 INFO     repetition  ... no_opt_what_if_execution_combined_model_training
0           0  ...                                       580.923080
1           1  ...                                       572.499990
2           2  ...                                       564.380169
3           3  ...                                       618.077040
4           4  ...                                       514.674187
5           5  ...                                       514.122009
6           6  ...                                       539.527178

[7 rows x 26 columns]
taskset -c 64-71 PROTOCOL_BUFFERS_PYTHON_IMPLEMENTATION=python python3.9 benchmarks_end_to_end.py feature_importance folktables slow_loading featurization_3 xgboost
2022-09-21 19:12:14.109712: W tensorflow/stream_executor/platform/default/dso_loader.cc:64] Could not load dynamic library 'libcudart.so.11.0'; dlerror: libcudart.so.11.0: cannot open shared object file: No such file or directory; LD_LIBRARY_PATH: /home/sgrafbe/mlwhatif/venv/lib/python3.9/site-packages/cv2/../../lib64:
2022-09-21 19:12:14.109749: I tensorflow/stream_executor/cuda/cudart_stub.cc:29] Ignore above cudart dlerror if you do not have a GPU set up on your machine.
2022-09-21 19:12:15 INFO  Patching sys.argv with ['mlwhatif', 'folktables', 'slow_loading', 'featurization_3', 'xgboost']
2022-09-21 19:12:15 INFO  Running instrumented original pipeline...
2022-09-21 19:12:15 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-21 19:12:15 INFO  ---RUNTIME: Importing and monkey-patching took 95.2610969543457 ms
2022-09-21 19:12:17 INFO  ---RUNTIME: Original pipeline execution took 2334.4128131866455 ms (excluding imports and monkey-patching)
2022-09-21 19:12:17 INFO  Starting execution of 0 what-if analyses...
2022-09-21 19:12:17 INFO  Estimated runtime of original DAG is 2025.8491039276123ms
2022-09-21 19:12:17 INFO  Performing Multi-Query Optimization
2022-09-21 19:12:17 INFO  Estimated unoptimized what-if runtime is 0ms
2022-09-21 19:12:17 INFO  Estimated optimised what-if runtime is 0ms
2022-09-21 19:12:17 INFO  Estimated optimisation runtime saving is 0ms
2022-09-21 19:12:17 INFO  ---RUNTIME: Multi-Query Optimization took 0.5397796630859375 ms
2022-09-21 19:12:17 INFO  Executing generated plans
2022-09-21 19:12:17 INFO  ---RUNTIME: Execution took 0.0209808349609375 ms
2022-09-21 19:12:17 INFO  Done!
2022-09-21 19:12:17 INFO  # Optimization benchmark for feature_importance with args [['folktables', 'slow_loading', 'featurization_3', 'xgboost']] -- repetition 1 of 7
2022-09-21 19:12:17 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-21 19:12:17 INFO  Running instrumented original pipeline...
2022-09-21 19:12:17 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-21 19:12:17 INFO  ---RUNTIME: Importing and monkey-patching took 5.109071731567383 ms
2022-09-21 19:12:19 INFO  ---RUNTIME: Original pipeline execution took 1765.8636569976807 ms (excluding imports and monkey-patching)
2022-09-21 19:12:19 INFO  Starting execution of 1 what-if analyses...
2022-09-21 19:12:19 INFO  Start plan generation for analysis PermutationFeatureImportance...
2022-09-21 19:12:19 INFO  ---RUNTIME: Plan generation took 0.3199577331542969 ms
2022-09-21 19:12:19 INFO  Estimated runtime of original DAG is 1510.0035667419434ms
2022-09-21 19:12:19 INFO  Performing Multi-Query Optimization
2022-09-21 19:12:19 INFO  Estimated unoptimized what-if runtime is 12080.028533935547ms
2022-09-21 19:12:19 INFO  Estimated optimised what-if runtime is 1611.2079620361328ms
2022-09-21 19:12:19 INFO  Estimated optimisation runtime saving is 10468.820571899414ms
2022-09-21 19:12:19 INFO  ---RUNTIME: Multi-Query Optimization took 20.664453506469727 ms
2022-09-21 19:12:19 INFO  Executing generated plans
2022-09-21 19:12:21 INFO  ---RUNTIME: Execution took 2390.1500701904297 ms
2022-09-21 19:12:21 INFO  Done!
2022-09-21 19:12:21 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-21 19:12:21 INFO  Running instrumented original pipeline...
2022-09-21 19:12:22 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-21 19:12:22 INFO  ---RUNTIME: Importing and monkey-patching took 5.585432052612305 ms
2022-09-21 19:12:23 INFO  ---RUNTIME: Original pipeline execution took 1959.6705436706543 ms (excluding imports and monkey-patching)
2022-09-21 19:12:23 INFO  Starting execution of 1 what-if analyses...
2022-09-21 19:12:23 INFO  Start plan generation for analysis PermutationFeatureImportance...
2022-09-21 19:12:23 INFO  ---RUNTIME: Plan generation took 0.13637542724609375 ms
2022-09-21 19:12:23 INFO  Estimated runtime of original DAG is 1511.9681358337402ms
2022-09-21 19:12:23 WARNING Skipping Multi-Query Optimization (instead, only applying patches)
2022-09-21 19:12:23 INFO  Estimated unoptimised what-if runtime is 12095.745086669922ms
2022-09-21 19:12:23 INFO  ---RUNTIME: Multi-Query Optimization took 6.231784820556641 ms
2022-09-21 19:12:23 INFO  Executing generated plans
2022-09-21 19:12:37 INFO  ---RUNTIME: Execution took 13499.286890029907 ms
2022-09-21 19:12:37 INFO  Done!
2022-09-21 19:12:37 INFO  # Finished -- repetition 1 of 7 
2022-09-21 19:12:37 INFO  # Optimization benchmark for feature_importance with args [['folktables', 'slow_loading', 'featurization_3', 'xgboost']] -- repetition 2 of 7
2022-09-21 19:12:37 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-21 19:12:37 INFO  Running instrumented original pipeline...
2022-09-21 19:12:37 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-21 19:12:37 INFO  ---RUNTIME: Importing and monkey-patching took 8.738279342651367 ms
2022-09-21 19:12:39 INFO  ---RUNTIME: Original pipeline execution took 1853.454828262329 ms (excluding imports and monkey-patching)
2022-09-21 19:12:39 INFO  Starting execution of 1 what-if analyses...
2022-09-21 19:12:39 INFO  Start plan generation for analysis PermutationFeatureImportance...
2022-09-21 19:12:39 INFO  ---RUNTIME: Plan generation took 0.14019012451171875 ms
2022-09-21 19:12:39 INFO  Estimated runtime of original DAG is 1575.2036571502686ms
2022-09-21 19:12:39 INFO  Performing Multi-Query Optimization
2022-09-21 19:12:39 INFO  Estimated unoptimized what-if runtime is 12601.629257202148ms
2022-09-21 19:12:39 INFO  Estimated optimised what-if runtime is 1943.2878494262695ms
2022-09-21 19:12:39 INFO  Estimated optimisation runtime saving is 10658.341407775879ms
2022-09-21 19:12:39 INFO  ---RUNTIME: Multi-Query Optimization took 18.46456527709961 ms
2022-09-21 19:12:39 INFO  Executing generated plans
2022-09-21 19:12:41 INFO  ---RUNTIME: Execution took 2094.0423011779785 ms
2022-09-21 19:12:41 INFO  Done!
2022-09-21 19:12:41 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-21 19:12:41 INFO  Running instrumented original pipeline...
2022-09-21 19:12:41 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-21 19:12:41 INFO  ---RUNTIME: Importing and monkey-patching took 5.553245544433594 ms
2022-09-21 19:12:43 INFO  ---RUNTIME: Original pipeline execution took 1792.68217086792 ms (excluding imports and monkey-patching)
2022-09-21 19:12:43 INFO  Starting execution of 1 what-if analyses...
2022-09-21 19:12:43 INFO  Start plan generation for analysis PermutationFeatureImportance...
2022-09-21 19:12:43 INFO  ---RUNTIME: Plan generation took 0.14066696166992188 ms
2022-09-21 19:12:43 INFO  Estimated runtime of original DAG is 1513.5366916656494ms
2022-09-21 19:12:43 WARNING Skipping Multi-Query Optimization (instead, only applying patches)
2022-09-21 19:12:43 INFO  Estimated unoptimised what-if runtime is 12108.293533325195ms
2022-09-21 19:12:43 INFO  ---RUNTIME: Multi-Query Optimization took 6.161212921142578 ms
2022-09-21 19:12:43 INFO  Executing generated plans
2022-09-21 19:12:57 INFO  ---RUNTIME: Execution took 14547.096967697144 ms
2022-09-21 19:12:57 INFO  Done!
2022-09-21 19:12:57 INFO  # Finished -- repetition 2 of 7 
2022-09-21 19:12:57 INFO  # Optimization benchmark for feature_importance with args [['folktables', 'slow_loading', 'featurization_3', 'xgboost']] -- repetition 3 of 7
2022-09-21 19:12:57 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-21 19:12:57 INFO  Running instrumented original pipeline...
2022-09-21 19:12:57 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-21 19:12:57 INFO  ---RUNTIME: Importing and monkey-patching took 6.134748458862305 ms
2022-09-21 19:12:59 INFO  ---RUNTIME: Original pipeline execution took 1802.9155731201172 ms (excluding imports and monkey-patching)
2022-09-21 19:12:59 INFO  Starting execution of 1 what-if analyses...
2022-09-21 19:12:59 INFO  Start plan generation for analysis PermutationFeatureImportance...
2022-09-21 19:12:59 INFO  ---RUNTIME: Plan generation took 0.13184547424316406 ms
2022-09-21 19:12:59 INFO  Estimated runtime of original DAG is 1545.8674430847168ms
2022-09-21 19:12:59 INFO  Performing Multi-Query Optimization
2022-09-21 19:12:59 INFO  Estimated unoptimized what-if runtime is 12366.939544677734ms
2022-09-21 19:12:59 INFO  Estimated optimised what-if runtime is 2016.8719291687012ms
2022-09-21 19:12:59 INFO  Estimated optimisation runtime saving is 10350.067615509033ms
2022-09-21 19:12:59 INFO  ---RUNTIME: Multi-Query Optimization took 17.607927322387695 ms
2022-09-21 19:12:59 INFO  Executing generated plans
2022-09-21 19:13:01 INFO  ---RUNTIME: Execution took 1725.4400253295898 ms
2022-09-21 19:13:01 INFO  Done!
2022-09-21 19:13:01 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-21 19:13:01 INFO  Running instrumented original pipeline...
2022-09-21 19:13:01 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-21 19:13:01 INFO  ---RUNTIME: Importing and monkey-patching took 5.534172058105469 ms
2022-09-21 19:13:03 INFO  ---RUNTIME: Original pipeline execution took 2299.0405559539795 ms (excluding imports and monkey-patching)
2022-09-21 19:13:03 INFO  Starting execution of 1 what-if analyses...
2022-09-21 19:13:03 INFO  Start plan generation for analysis PermutationFeatureImportance...
2022-09-21 19:13:03 INFO  ---RUNTIME: Plan generation took 0.14710426330566406 ms
2022-09-21 19:13:03 INFO  Estimated runtime of original DAG is 2018.998146057129ms
2022-09-21 19:13:03 WARNING Skipping Multi-Query Optimization (instead, only applying patches)
2022-09-21 19:13:03 INFO  Estimated unoptimised what-if runtime is 16151.985168457031ms
2022-09-21 19:13:03 INFO  ---RUNTIME: Multi-Query Optimization took 6.182432174682617 ms
2022-09-21 19:13:03 INFO  Executing generated plans
2022-09-21 19:13:18 INFO  ---RUNTIME: Execution took 14554.309844970703 ms
2022-09-21 19:13:18 INFO  Done!
2022-09-21 19:13:18 INFO  # Finished -- repetition 3 of 7 
2022-09-21 19:13:18 INFO  # Optimization benchmark for feature_importance with args [['folktables', 'slow_loading', 'featurization_3', 'xgboost']] -- repetition 4 of 7
2022-09-21 19:13:18 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-21 19:13:18 INFO  Running instrumented original pipeline...
2022-09-21 19:13:18 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-21 19:13:18 INFO  ---RUNTIME: Importing and monkey-patching took 5.623817443847656 ms
2022-09-21 19:13:20 INFO  ---RUNTIME: Original pipeline execution took 1839.6170139312744 ms (excluding imports and monkey-patching)
2022-09-21 19:13:20 INFO  Starting execution of 1 what-if analyses...
2022-09-21 19:13:20 INFO  Start plan generation for analysis PermutationFeatureImportance...
2022-09-21 19:13:20 INFO  ---RUNTIME: Plan generation took 0.118255615234375 ms
2022-09-21 19:13:20 INFO  Estimated runtime of original DAG is 1540.0876998901367ms
2022-09-21 19:13:20 INFO  Performing Multi-Query Optimization
2022-09-21 19:13:20 INFO  Estimated unoptimized what-if runtime is 12320.701599121094ms
2022-09-21 19:13:20 INFO  Estimated optimised what-if runtime is 1813.5044574737549ms
2022-09-21 19:13:20 INFO  Estimated optimisation runtime saving is 10507.197141647339ms
2022-09-21 19:13:20 INFO  ---RUNTIME: Multi-Query Optimization took 18.145084381103516 ms
2022-09-21 19:13:20 INFO  Executing generated plans
2022-09-21 19:13:22 INFO  ---RUNTIME: Execution took 2670.7923412323 ms
2022-09-21 19:13:22 INFO  Done!
2022-09-21 19:13:22 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-21 19:13:22 INFO  Running instrumented original pipeline...
2022-09-21 19:13:22 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-21 19:13:22 INFO  ---RUNTIME: Importing and monkey-patching took 5.627870559692383 ms
2022-09-21 19:13:24 INFO  ---RUNTIME: Original pipeline execution took 2018.136739730835 ms (excluding imports and monkey-patching)
2022-09-21 19:13:24 INFO  Starting execution of 1 what-if analyses...
2022-09-21 19:13:24 INFO  Start plan generation for analysis PermutationFeatureImportance...
2022-09-21 19:13:24 INFO  ---RUNTIME: Plan generation took 0.15783309936523438 ms
2022-09-21 19:13:24 INFO  Estimated runtime of original DAG is 1568.7389373779297ms
2022-09-21 19:13:24 WARNING Skipping Multi-Query Optimization (instead, only applying patches)
2022-09-21 19:13:24 INFO  Estimated unoptimised what-if runtime is 12549.911499023438ms
2022-09-21 19:13:24 INFO  ---RUNTIME: Multi-Query Optimization took 7.133722305297852 ms
2022-09-21 19:13:24 INFO  Executing generated plans
2022-09-21 19:13:40 INFO  ---RUNTIME: Execution took 15442.383289337158 ms
2022-09-21 19:13:40 INFO  Done!
2022-09-21 19:13:40 INFO  # Finished -- repetition 4 of 7 
2022-09-21 19:13:40 INFO  # Optimization benchmark for feature_importance with args [['folktables', 'slow_loading', 'featurization_3', 'xgboost']] -- repetition 5 of 7
2022-09-21 19:13:40 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-21 19:13:40 INFO  Running instrumented original pipeline...
2022-09-21 19:13:40 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-21 19:13:40 INFO  ---RUNTIME: Importing and monkey-patching took 7.198095321655273 ms
2022-09-21 19:13:42 INFO  ---RUNTIME: Original pipeline execution took 1862.9510402679443 ms (excluding imports and monkey-patching)
2022-09-21 19:13:42 INFO  Starting execution of 1 what-if analyses...
2022-09-21 19:13:42 INFO  Start plan generation for analysis PermutationFeatureImportance...
2022-09-21 19:13:42 INFO  ---RUNTIME: Plan generation took 0.11968612670898438 ms
2022-09-21 19:13:42 INFO  Estimated runtime of original DAG is 1557.419776916504ms
2022-09-21 19:13:42 INFO  Performing Multi-Query Optimization
2022-09-21 19:13:42 INFO  Estimated unoptimized what-if runtime is 12459.358215332031ms
2022-09-21 19:13:42 INFO  Estimated optimised what-if runtime is 1848.193645477295ms
2022-09-21 19:13:42 INFO  Estimated optimisation runtime saving is 10611.164569854736ms
2022-09-21 19:13:42 INFO  ---RUNTIME: Multi-Query Optimization took 17.50016212463379 ms
2022-09-21 19:13:42 INFO  Executing generated plans
2022-09-21 19:13:44 INFO  ---RUNTIME: Execution took 2085.14142036438 ms
2022-09-21 19:13:44 INFO  Done!
2022-09-21 19:13:44 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-21 19:13:44 INFO  Running instrumented original pipeline...
2022-09-21 19:13:44 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-21 19:13:44 INFO  ---RUNTIME: Importing and monkey-patching took 5.525112152099609 ms
2022-09-21 19:13:46 INFO  ---RUNTIME: Original pipeline execution took 1976.9599437713623 ms (excluding imports and monkey-patching)
2022-09-21 19:13:46 INFO  Starting execution of 1 what-if analyses...
2022-09-21 19:13:46 INFO  Start plan generation for analysis PermutationFeatureImportance...
2022-09-21 19:13:46 INFO  ---RUNTIME: Plan generation took 6.190061569213867 ms
2022-09-21 19:13:46 INFO  Estimated runtime of original DAG is 1671.9508171081543ms
2022-09-21 19:13:46 WARNING Skipping Multi-Query Optimization (instead, only applying patches)
2022-09-21 19:13:46 INFO  Estimated unoptimised what-if runtime is 13375.606536865234ms
2022-09-21 19:13:46 INFO  ---RUNTIME: Multi-Query Optimization took 6.154298782348633 ms
2022-09-21 19:13:46 INFO  Executing generated plans
2022-09-21 19:14:00 INFO  ---RUNTIME: Execution took 13898.777723312378 ms
2022-09-21 19:14:00 INFO  Done!
2022-09-21 19:14:00 INFO  # Finished -- repetition 5 of 7 
2022-09-21 19:14:00 INFO  # Optimization benchmark for feature_importance with args [['folktables', 'slow_loading', 'featurization_3', 'xgboost']] -- repetition 6 of 7
2022-09-21 19:14:00 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-21 19:14:00 INFO  Running instrumented original pipeline...
2022-09-21 19:14:00 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-21 19:14:00 INFO  ---RUNTIME: Importing and monkey-patching took 8.262157440185547 ms
2022-09-21 19:14:02 INFO  ---RUNTIME: Original pipeline execution took 2079.40673828125 ms (excluding imports and monkey-patching)
2022-09-21 19:14:02 INFO  Starting execution of 1 what-if analyses...
2022-09-21 19:14:02 INFO  Start plan generation for analysis PermutationFeatureImportance...
2022-09-21 19:14:02 INFO  ---RUNTIME: Plan generation took 0.20122528076171875 ms
2022-09-21 19:14:02 INFO  Estimated runtime of original DAG is 1714.8945331573486ms
2022-09-21 19:14:02 INFO  Performing Multi-Query Optimization
2022-09-21 19:14:02 INFO  Estimated unoptimized what-if runtime is 13719.156265258789ms
2022-09-21 19:14:02 INFO  Estimated optimised what-if runtime is 2049.5963096618652ms
2022-09-21 19:14:02 INFO  Estimated optimisation runtime saving is 11669.559955596924ms
2022-09-21 19:14:02 INFO  ---RUNTIME: Multi-Query Optimization took 28.030872344970703 ms
2022-09-21 19:14:02 INFO  Executing generated plans
2022-09-21 19:14:04 INFO  ---RUNTIME: Execution took 2237.0262145996094 ms
2022-09-21 19:14:04 INFO  Done!
2022-09-21 19:14:04 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-21 19:14:04 INFO  Running instrumented original pipeline...
2022-09-21 19:14:04 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-21 19:14:04 INFO  ---RUNTIME: Importing and monkey-patching took 7.7991485595703125 ms
2022-09-21 19:14:06 INFO  ---RUNTIME: Original pipeline execution took 1853.708267211914 ms (excluding imports and monkey-patching)
2022-09-21 19:14:06 INFO  Starting execution of 1 what-if analyses...
2022-09-21 19:14:06 INFO  Start plan generation for analysis PermutationFeatureImportance...
2022-09-21 19:14:06 INFO  ---RUNTIME: Plan generation took 0.23746490478515625 ms
2022-09-21 19:14:06 INFO  Estimated runtime of original DAG is 1555.9065341949463ms
2022-09-21 19:14:06 WARNING Skipping Multi-Query Optimization (instead, only applying patches)
2022-09-21 19:14:06 INFO  Estimated unoptimised what-if runtime is 12447.25227355957ms
2022-09-21 19:14:06 INFO  ---RUNTIME: Multi-Query Optimization took 8.794069290161133 ms
2022-09-21 19:14:06 INFO  Executing generated plans
2022-09-21 19:14:27 INFO  ---RUNTIME: Execution took 21480.72099685669 ms
2022-09-21 19:14:27 INFO  Done!
2022-09-21 19:14:27 INFO  # Finished -- repetition 6 of 7 
2022-09-21 19:14:27 INFO  # Optimization benchmark for feature_importance with args [['folktables', 'slow_loading', 'featurization_3', 'xgboost']] -- repetition 7 of 7
2022-09-21 19:14:27 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-21 19:14:27 INFO  Running instrumented original pipeline...
2022-09-21 19:14:27 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-21 19:14:27 INFO  ---RUNTIME: Importing and monkey-patching took 7.198810577392578 ms
2022-09-21 19:14:29 INFO  ---RUNTIME: Original pipeline execution took 1749.0425109863281 ms (excluding imports and monkey-patching)
2022-09-21 19:14:29 INFO  Starting execution of 1 what-if analyses...
2022-09-21 19:14:29 INFO  Start plan generation for analysis PermutationFeatureImportance...
2022-09-21 19:14:29 INFO  ---RUNTIME: Plan generation took 0.17571449279785156 ms
2022-09-21 19:14:29 INFO  Estimated runtime of original DAG is 1467.212438583374ms
2022-09-21 19:14:29 INFO  Performing Multi-Query Optimization
2022-09-21 19:14:29 INFO  Estimated unoptimized what-if runtime is 11737.699508666992ms
2022-09-21 19:14:29 INFO  Estimated optimised what-if runtime is 1588.6726379394531ms
2022-09-21 19:14:29 INFO  Estimated optimisation runtime saving is 10149.026870727539ms
2022-09-21 19:14:29 INFO  ---RUNTIME: Multi-Query Optimization took 24.315357208251953 ms
2022-09-21 19:14:29 INFO  Executing generated plans
2022-09-21 19:14:31 INFO  ---RUNTIME: Execution took 1825.592041015625 ms
2022-09-21 19:14:31 INFO  Done!
2022-09-21 19:14:31 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-21 19:14:31 INFO  Running instrumented original pipeline...
2022-09-21 19:14:31 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-21 19:14:31 INFO  ---RUNTIME: Importing and monkey-patching took 6.263494491577148 ms
2022-09-21 19:14:33 INFO  ---RUNTIME: Original pipeline execution took 1838.5181427001953 ms (excluding imports and monkey-patching)
2022-09-21 19:14:33 INFO  Starting execution of 1 what-if analyses...
2022-09-21 19:14:33 INFO  Start plan generation for analysis PermutationFeatureImportance...
2022-09-21 19:14:33 INFO  ---RUNTIME: Plan generation took 0.1437664031982422 ms
2022-09-21 19:14:33 INFO  Estimated runtime of original DAG is 1535.6123447418213ms
2022-09-21 19:14:33 WARNING Skipping Multi-Query Optimization (instead, only applying patches)
2022-09-21 19:14:33 INFO  Estimated unoptimised what-if runtime is 12284.89875793457ms
2022-09-21 19:14:33 INFO  ---RUNTIME: Multi-Query Optimization took 7.785320281982422 ms
2022-09-21 19:14:33 INFO  Executing generated plans
2022-09-21 19:14:48 INFO  ---RUNTIME: Execution took 14759.812355041504 ms
2022-09-21 19:14:48 INFO  Done!
2022-09-21 19:14:48 INFO  # Finished -- repetition 7 of 7 
2022-09-21 19:14:48 INFO  # Final results after all repetitions
2022-09-21 19:14:48 INFO     repetition  ... no_opt_what_if_execution_combined_model_training
0           0  ...                                      4361.946106
1           1  ...                                      5489.999294
2           2  ...                                      5265.968323
3           3  ...                                      6086.362362
4           4  ...                                      4510.454655
5           5  ...                                     12256.618261
6           6  ...                                      5687.235355

[7 rows x 26 columns]
taskset -c 64-71 PROTOCOL_BUFFERS_PYTHON_IMPLEMENTATION=python python3.9 benchmarks_end_to_end.py feature_importance folktables slow_loading featurization_3 neural_network
2022-09-21 19:14:50.101788: W tensorflow/stream_executor/platform/default/dso_loader.cc:64] Could not load dynamic library 'libcudart.so.11.0'; dlerror: libcudart.so.11.0: cannot open shared object file: No such file or directory; LD_LIBRARY_PATH: /home/sgrafbe/mlwhatif/venv/lib/python3.9/site-packages/cv2/../../lib64:
2022-09-21 19:14:50.101828: I tensorflow/stream_executor/cuda/cudart_stub.cc:29] Ignore above cudart dlerror if you do not have a GPU set up on your machine.
2022-09-21 19:14:51 INFO  Patching sys.argv with ['mlwhatif', 'folktables', 'slow_loading', 'featurization_3', 'neural_network']
2022-09-21 19:14:51 INFO  Running instrumented original pipeline...
2022-09-21 19:14:51 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-21 19:14:51 INFO  ---RUNTIME: Importing and monkey-patching took 111.99665069580078 ms
2022-09-21 19:14:52.917561: W tensorflow/stream_executor/platform/default/dso_loader.cc:64] Could not load dynamic library 'libcuda.so.1'; dlerror: libcuda.so.1: cannot open shared object file: No such file or directory; LD_LIBRARY_PATH: /home/sgrafbe/mlwhatif/venv/lib/python3.9/site-packages/cv2/../../lib64:
2022-09-21 19:14:52.917604: W tensorflow/stream_executor/cuda/cuda_driver.cc:326] failed call to cuInit: UNKNOWN ERROR (303)
2022-09-21 19:14:52.917626: I tensorflow/stream_executor/cuda/cuda_diagnostics.cc:156] kernel driver does not appear to be running on this host (wagyu): /proc/driver/nvidia/version does not exist
2022-09-21 19:14:52.918042: I tensorflow/core/platform/cpu_feature_guard.cc:142] This TensorFlow binary is optimized with oneAPI Deep Neural Network Library (oneDNN) to use the following CPU instructions in performance-critical operations:  AVX2 FMA
To enable them in other operations, rebuild TensorFlow with the appropriate compiler flags.
2022-09-21 19:14:53.507088: I tensorflow/compiler/mlir/mlir_graph_optimization_pass.cc:176] None of the MLIR Optimization Passes are enabled (registered 2)
2022-09-21 19:14:53.521395: I tensorflow/core/platform/profile_utils/cpu_utils.cc:114] CPU Frequency: 2595290000 Hz
2022-09-21 19:14:57 INFO  ---RUNTIME: Original pipeline execution took 5702.472448348999 ms (excluding imports and monkey-patching)
2022-09-21 19:14:57 INFO  Starting execution of 0 what-if analyses...
2022-09-21 19:14:57 INFO  Estimated runtime of original DAG is 5362.692356109619ms
2022-09-21 19:14:57 INFO  Performing Multi-Query Optimization
2022-09-21 19:14:57 INFO  Estimated unoptimized what-if runtime is 0ms
2022-09-21 19:14:57 INFO  Estimated optimised what-if runtime is 0ms
2022-09-21 19:14:57 INFO  Estimated optimisation runtime saving is 0ms
2022-09-21 19:14:57 INFO  ---RUNTIME: Multi-Query Optimization took 0.6227493286132812 ms
2022-09-21 19:14:57 INFO  Executing generated plans
2022-09-21 19:14:57 INFO  ---RUNTIME: Execution took 0.019073486328125 ms
2022-09-21 19:14:57 INFO  Done!
2022-09-21 19:14:57 INFO  # Optimization benchmark for feature_importance with args [['folktables', 'slow_loading', 'featurization_3', 'neural_network']] -- repetition 1 of 7
2022-09-21 19:14:57 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-21 19:14:57 INFO  Running instrumented original pipeline...
2022-09-21 19:14:57 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-21 19:14:57 INFO  ---RUNTIME: Importing and monkey-patching took 6.619691848754883 ms
2022-09-21 19:15:02 INFO  ---RUNTIME: Original pipeline execution took 5537.936449050903 ms (excluding imports and monkey-patching)
2022-09-21 19:15:02 INFO  Starting execution of 1 what-if analyses...
2022-09-21 19:15:02 INFO  Start plan generation for analysis PermutationFeatureImportance...
2022-09-21 19:15:02 INFO  ---RUNTIME: Plan generation took 0.3688335418701172 ms
2022-09-21 19:15:02 INFO  Estimated runtime of original DAG is 5186.169385910034ms
2022-09-21 19:15:02 INFO  Performing Multi-Query Optimization
2022-09-21 19:15:02 INFO  Estimated unoptimized what-if runtime is 41489.35508728027ms
2022-09-21 19:15:02 INFO  Estimated optimised what-if runtime is 6378.0012130737305ms
2022-09-21 19:15:02 INFO  Estimated optimisation runtime saving is 35111.35387420654ms
2022-09-21 19:15:02 INFO  ---RUNTIME: Multi-Query Optimization took 28.5031795501709 ms
2022-09-21 19:15:02 INFO  Executing generated plans
2022-09-21 19:15:08 INFO  ---RUNTIME: Execution took 5818.309545516968 ms
2022-09-21 19:15:08 INFO  Done!
2022-09-21 19:15:08 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-21 19:15:08 INFO  Running instrumented original pipeline...
2022-09-21 19:15:08 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-21 19:15:08 INFO  ---RUNTIME: Importing and monkey-patching took 5.926370620727539 ms
2022-09-21 19:15:13 INFO  ---RUNTIME: Original pipeline execution took 5353.4557819366455 ms (excluding imports and monkey-patching)
2022-09-21 19:15:13 INFO  Starting execution of 1 what-if analyses...
2022-09-21 19:15:13 INFO  Start plan generation for analysis PermutationFeatureImportance...
2022-09-21 19:15:13 INFO  ---RUNTIME: Plan generation took 0.1583099365234375 ms
2022-09-21 19:15:13 INFO  Estimated runtime of original DAG is 5089.05553817749ms
2022-09-21 19:15:13 WARNING Skipping Multi-Query Optimization (instead, only applying patches)
2022-09-21 19:15:13 INFO  Estimated unoptimised what-if runtime is 40712.44430541992ms
2022-09-21 19:15:13 INFO  ---RUNTIME: Multi-Query Optimization took 6.921529769897461 ms
2022-09-21 19:15:13 INFO  Executing generated plans
2022-09-21 19:15:54 INFO  ---RUNTIME: Execution took 40558.833599090576 ms
2022-09-21 19:15:54 INFO  Done!
2022-09-21 19:15:54 INFO  # Finished -- repetition 1 of 7 
2022-09-21 19:15:54 INFO  # Optimization benchmark for feature_importance with args [['folktables', 'slow_loading', 'featurization_3', 'neural_network']] -- repetition 2 of 7
2022-09-21 19:15:54 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-21 19:15:54 INFO  Running instrumented original pipeline...
2022-09-21 19:15:54 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-21 19:15:54 INFO  ---RUNTIME: Importing and monkey-patching took 7.442474365234375 ms
2022-09-21 19:15:59 INFO  ---RUNTIME: Original pipeline execution took 5320.536136627197 ms (excluding imports and monkey-patching)
2022-09-21 19:15:59 INFO  Starting execution of 1 what-if analyses...
2022-09-21 19:15:59 INFO  Start plan generation for analysis PermutationFeatureImportance...
2022-09-21 19:15:59 INFO  ---RUNTIME: Plan generation took 0.20074844360351562 ms
2022-09-21 19:15:59 INFO  Estimated runtime of original DAG is 5023.400783538818ms
2022-09-21 19:15:59 INFO  Performing Multi-Query Optimization
2022-09-21 19:15:59 INFO  Estimated unoptimized what-if runtime is 40187.20626831055ms
2022-09-21 19:15:59 INFO  Estimated optimised what-if runtime is 6457.779407501221ms
2022-09-21 19:15:59 INFO  Estimated optimisation runtime saving is 33729.426860809326ms
2022-09-21 19:15:59 INFO  ---RUNTIME: Multi-Query Optimization took 28.00893783569336 ms
2022-09-21 19:15:59 INFO  Executing generated plans
2022-09-21 19:16:05 INFO  ---RUNTIME: Execution took 6058.683395385742 ms
2022-09-21 19:16:05 INFO  Done!
2022-09-21 19:16:05 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-21 19:16:05 INFO  Running instrumented original pipeline...
2022-09-21 19:16:05 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-21 19:16:05 INFO  ---RUNTIME: Importing and monkey-patching took 7.01594352722168 ms
2022-09-21 19:16:11 INFO  ---RUNTIME: Original pipeline execution took 5227.8289794921875 ms (excluding imports and monkey-patching)
2022-09-21 19:16:11 INFO  Starting execution of 1 what-if analyses...
2022-09-21 19:16:11 INFO  Start plan generation for analysis PermutationFeatureImportance...
2022-09-21 19:16:11 INFO  ---RUNTIME: Plan generation took 0.164031982421875 ms
2022-09-21 19:16:11 INFO  Estimated runtime of original DAG is 4943.121433258057ms
2022-09-21 19:16:11 WARNING Skipping Multi-Query Optimization (instead, only applying patches)
2022-09-21 19:16:11 INFO  Estimated unoptimised what-if runtime is 39544.97146606445ms
2022-09-21 19:16:11 INFO  ---RUNTIME: Multi-Query Optimization took 8.634328842163086 ms
2022-09-21 19:16:11 INFO  Executing generated plans
2022-09-21 19:16:51 INFO  ---RUNTIME: Execution took 39914.49427604675 ms
2022-09-21 19:16:51 INFO  Done!
2022-09-21 19:16:51 INFO  # Finished -- repetition 2 of 7 
2022-09-21 19:16:51 INFO  # Optimization benchmark for feature_importance with args [['folktables', 'slow_loading', 'featurization_3', 'neural_network']] -- repetition 3 of 7
2022-09-21 19:16:51 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-21 19:16:51 INFO  Running instrumented original pipeline...
2022-09-21 19:16:51 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-21 19:16:51 INFO  ---RUNTIME: Importing and monkey-patching took 6.613016128540039 ms
2022-09-21 19:16:56 INFO  ---RUNTIME: Original pipeline execution took 5145.333051681519 ms (excluding imports and monkey-patching)
2022-09-21 19:16:56 INFO  Starting execution of 1 what-if analyses...
2022-09-21 19:16:56 INFO  Start plan generation for analysis PermutationFeatureImportance...
2022-09-21 19:16:56 INFO  ---RUNTIME: Plan generation took 0.141143798828125 ms
2022-09-21 19:16:56 INFO  Estimated runtime of original DAG is 4851.382255554199ms
2022-09-21 19:16:56 INFO  Performing Multi-Query Optimization
2022-09-21 19:16:56 INFO  Estimated unoptimized what-if runtime is 38811.058044433594ms
2022-09-21 19:16:56 INFO  Estimated optimised what-if runtime is 6154.377460479736ms
2022-09-21 19:16:56 INFO  Estimated optimisation runtime saving is 32656.680583953857ms
2022-09-21 19:16:56 INFO  ---RUNTIME: Multi-Query Optimization took 18.20850372314453 ms
2022-09-21 19:16:56 INFO  Executing generated plans
2022-09-21 19:17:02 INFO  ---RUNTIME: Execution took 6176.048040390015 ms
2022-09-21 19:17:02 INFO  Done!
2022-09-21 19:17:02 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-21 19:17:02 INFO  Running instrumented original pipeline...
2022-09-21 19:17:02 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-21 19:17:02 INFO  ---RUNTIME: Importing and monkey-patching took 6.05320930480957 ms
2022-09-21 19:17:07 INFO  ---RUNTIME: Original pipeline execution took 5118.425130844116 ms (excluding imports and monkey-patching)
2022-09-21 19:17:07 INFO  Starting execution of 1 what-if analyses...
2022-09-21 19:17:07 INFO  Start plan generation for analysis PermutationFeatureImportance...
2022-09-21 19:17:07 INFO  ---RUNTIME: Plan generation took 0.1373291015625 ms
2022-09-21 19:17:07 INFO  Estimated runtime of original DAG is 4848.93012046814ms
2022-09-21 19:17:07 WARNING Skipping Multi-Query Optimization (instead, only applying patches)
2022-09-21 19:17:07 INFO  Estimated unoptimised what-if runtime is 38791.44096374512ms
2022-09-21 19:17:07 INFO  ---RUNTIME: Multi-Query Optimization took 6.393671035766602 ms
2022-09-21 19:17:07 INFO  Executing generated plans
2022-09-21 19:17:47 INFO  ---RUNTIME: Execution took 39528.49340438843 ms
2022-09-21 19:17:47 INFO  Done!
2022-09-21 19:17:47 INFO  # Finished -- repetition 3 of 7 
2022-09-21 19:17:47 INFO  # Optimization benchmark for feature_importance with args [['folktables', 'slow_loading', 'featurization_3', 'neural_network']] -- repetition 4 of 7
2022-09-21 19:17:47 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-21 19:17:47 INFO  Running instrumented original pipeline...
2022-09-21 19:17:47 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-21 19:17:47 INFO  ---RUNTIME: Importing and monkey-patching took 5.932331085205078 ms
2022-09-21 19:17:52 INFO  ---RUNTIME: Original pipeline execution took 5132.226467132568 ms (excluding imports and monkey-patching)
2022-09-21 19:17:52 INFO  Starting execution of 1 what-if analyses...
2022-09-21 19:17:52 INFO  Start plan generation for analysis PermutationFeatureImportance...
2022-09-21 19:17:52 INFO  ---RUNTIME: Plan generation took 0.12731552124023438 ms
2022-09-21 19:17:52 INFO  Estimated runtime of original DAG is 4862.724304199219ms
2022-09-21 19:17:52 INFO  Performing Multi-Query Optimization
2022-09-21 19:17:52 INFO  Estimated unoptimized what-if runtime is 38901.79443359375ms
2022-09-21 19:17:52 INFO  Estimated optimised what-if runtime is 6206.045150756836ms
2022-09-21 19:17:52 INFO  Estimated optimisation runtime saving is 32695.749282836914ms
2022-09-21 19:17:52 INFO  ---RUNTIME: Multi-Query Optimization took 17.752647399902344 ms
2022-09-21 19:17:52 INFO  Executing generated plans
2022-09-21 19:17:58 INFO  ---RUNTIME: Execution took 6101.019382476807 ms
2022-09-21 19:17:58 INFO  Done!
2022-09-21 19:17:58 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-21 19:17:58 INFO  Running instrumented original pipeline...
2022-09-21 19:17:58 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-21 19:17:58 INFO  ---RUNTIME: Importing and monkey-patching took 6.348371505737305 ms
2022-09-21 19:18:03 INFO  ---RUNTIME: Original pipeline execution took 5168.5802936553955 ms (excluding imports and monkey-patching)
2022-09-21 19:18:03 INFO  Starting execution of 1 what-if analyses...
2022-09-21 19:18:03 INFO  Start plan generation for analysis PermutationFeatureImportance...
2022-09-21 19:18:03 INFO  ---RUNTIME: Plan generation took 0.1323223114013672 ms
2022-09-21 19:18:03 INFO  Estimated runtime of original DAG is 4902.801990509033ms
2022-09-21 19:18:03 WARNING Skipping Multi-Query Optimization (instead, only applying patches)
2022-09-21 19:18:03 INFO  Estimated unoptimised what-if runtime is 39222.415924072266ms
2022-09-21 19:18:03 INFO  ---RUNTIME: Multi-Query Optimization took 6.220579147338867 ms
2022-09-21 19:18:03 INFO  Executing generated plans
2022-09-21 19:18:43 INFO  ---RUNTIME: Execution took 40445.960998535156 ms
2022-09-21 19:18:43 INFO  Done!
2022-09-21 19:18:43 INFO  # Finished -- repetition 4 of 7 
2022-09-21 19:18:43 INFO  # Optimization benchmark for feature_importance with args [['folktables', 'slow_loading', 'featurization_3', 'neural_network']] -- repetition 5 of 7
2022-09-21 19:18:43 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-21 19:18:43 INFO  Running instrumented original pipeline...
2022-09-21 19:18:44 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-21 19:18:44 INFO  ---RUNTIME: Importing and monkey-patching took 5.916833877563477 ms
2022-09-21 19:18:49 INFO  ---RUNTIME: Original pipeline execution took 5409.151077270508 ms (excluding imports and monkey-patching)
2022-09-21 19:18:49 INFO  Starting execution of 1 what-if analyses...
2022-09-21 19:18:49 INFO  Start plan generation for analysis PermutationFeatureImportance...
2022-09-21 19:18:49 INFO  ---RUNTIME: Plan generation took 0.12993812561035156 ms
2022-09-21 19:18:49 INFO  Estimated runtime of original DAG is 5138.66662979126ms
2022-09-21 19:18:49 INFO  Performing Multi-Query Optimization
2022-09-21 19:18:49 INFO  Estimated unoptimized what-if runtime is 41109.33303833008ms
2022-09-21 19:18:49 INFO  Estimated optimised what-if runtime is 6297.266960144043ms
2022-09-21 19:18:49 INFO  Estimated optimisation runtime saving is 34812.066078186035ms
2022-09-21 19:18:49 INFO  ---RUNTIME: Multi-Query Optimization took 18.200397491455078 ms
2022-09-21 19:18:49 INFO  Executing generated plans
2022-09-21 19:18:55 INFO  ---RUNTIME: Execution took 5841.110467910767 ms
2022-09-21 19:18:55 INFO  Done!
2022-09-21 19:18:55 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-21 19:18:55 INFO  Running instrumented original pipeline...
2022-09-21 19:18:55 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-21 19:18:55 INFO  ---RUNTIME: Importing and monkey-patching took 6.249666213989258 ms
2022-09-21 19:19:00 INFO  ---RUNTIME: Original pipeline execution took 5698.028564453125 ms (excluding imports and monkey-patching)
2022-09-21 19:19:00 INFO  Starting execution of 1 what-if analyses...
2022-09-21 19:19:00 INFO  Start plan generation for analysis PermutationFeatureImportance...
2022-09-21 19:19:00 INFO  ---RUNTIME: Plan generation took 0.18596649169921875 ms
2022-09-21 19:19:00 INFO  Estimated runtime of original DAG is 5011.4781856536865ms
2022-09-21 19:19:00 WARNING Skipping Multi-Query Optimization (instead, only applying patches)
2022-09-21 19:19:00 INFO  Estimated unoptimised what-if runtime is 40091.82548522949ms
2022-09-21 19:19:00 INFO  ---RUNTIME: Multi-Query Optimization took 9.367227554321289 ms
2022-09-21 19:19:00 INFO  Executing generated plans
2022-09-21 19:19:41 INFO  ---RUNTIME: Execution took 40067.821741104126 ms
2022-09-21 19:19:41 INFO  Done!
2022-09-21 19:19:41 INFO  # Finished -- repetition 5 of 7 
2022-09-21 19:19:41 INFO  # Optimization benchmark for feature_importance with args [['folktables', 'slow_loading', 'featurization_3', 'neural_network']] -- repetition 6 of 7
2022-09-21 19:19:41 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-21 19:19:41 INFO  Running instrumented original pipeline...
2022-09-21 19:19:41 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-21 19:19:41 INFO  ---RUNTIME: Importing and monkey-patching took 5.930185317993164 ms
2022-09-21 19:19:46 INFO  ---RUNTIME: Original pipeline execution took 5105.212450027466 ms (excluding imports and monkey-patching)
2022-09-21 19:19:46 INFO  Starting execution of 1 what-if analyses...
2022-09-21 19:19:46 INFO  Start plan generation for analysis PermutationFeatureImportance...
2022-09-21 19:19:46 INFO  ---RUNTIME: Plan generation took 0.12826919555664062 ms
2022-09-21 19:19:46 INFO  Estimated runtime of original DAG is 4842.082262039185ms
2022-09-21 19:19:46 INFO  Performing Multi-Query Optimization
2022-09-21 19:19:46 INFO  Estimated unoptimized what-if runtime is 38736.65809631348ms
2022-09-21 19:19:46 INFO  Estimated optimised what-if runtime is 6014.837265014648ms
2022-09-21 19:19:46 INFO  Estimated optimisation runtime saving is 32721.820831298828ms
2022-09-21 19:19:46 INFO  ---RUNTIME: Multi-Query Optimization took 17.780303955078125 ms
2022-09-21 19:19:46 INFO  Executing generated plans
2022-09-21 19:19:52 INFO  ---RUNTIME: Execution took 5842.106819152832 ms
2022-09-21 19:19:52 INFO  Done!
2022-09-21 19:19:52 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-21 19:19:52 INFO  Running instrumented original pipeline...
2022-09-21 19:19:52 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-21 19:19:52 INFO  ---RUNTIME: Importing and monkey-patching took 6.203413009643555 ms
2022-09-21 19:19:57 INFO  ---RUNTIME: Original pipeline execution took 5677.565813064575 ms (excluding imports and monkey-patching)
2022-09-21 19:19:57 INFO  Starting execution of 1 what-if analyses...
2022-09-21 19:19:57 INFO  Start plan generation for analysis PermutationFeatureImportance...
2022-09-21 19:19:57 INFO  ---RUNTIME: Plan generation took 0.1366138458251953 ms
2022-09-21 19:19:57 INFO  Estimated runtime of original DAG is 5404.266834259033ms
2022-09-21 19:19:57 WARNING Skipping Multi-Query Optimization (instead, only applying patches)
2022-09-21 19:19:57 INFO  Estimated unoptimised what-if runtime is 43234.134674072266ms
2022-09-21 19:19:57 INFO  ---RUNTIME: Multi-Query Optimization took 6.682395935058594 ms
2022-09-21 19:19:57 INFO  Executing generated plans
2022-09-21 19:20:37 INFO  ---RUNTIME: Execution took 39894.6533203125 ms
2022-09-21 19:20:37 INFO  Done!
2022-09-21 19:20:37 INFO  # Finished -- repetition 6 of 7 
2022-09-21 19:20:37 INFO  # Optimization benchmark for feature_importance with args [['folktables', 'slow_loading', 'featurization_3', 'neural_network']] -- repetition 7 of 7
2022-09-21 19:20:37 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-21 19:20:37 INFO  Running instrumented original pipeline...
2022-09-21 19:20:37 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-21 19:20:37 INFO  ---RUNTIME: Importing and monkey-patching took 5.837917327880859 ms
2022-09-21 19:20:42 INFO  ---RUNTIME: Original pipeline execution took 5262.811899185181 ms (excluding imports and monkey-patching)
2022-09-21 19:20:42 INFO  Starting execution of 1 what-if analyses...
2022-09-21 19:20:42 INFO  Start plan generation for analysis PermutationFeatureImportance...
2022-09-21 19:20:42 INFO  ---RUNTIME: Plan generation took 0.12731552124023438 ms
2022-09-21 19:20:42 INFO  Estimated runtime of original DAG is 4974.0660190582275ms
2022-09-21 19:20:42 INFO  Performing Multi-Query Optimization
2022-09-21 19:20:42 INFO  Estimated unoptimized what-if runtime is 39792.52815246582ms
2022-09-21 19:20:42 INFO  Estimated optimised what-if runtime is 6324.294805526733ms
2022-09-21 19:20:42 INFO  Estimated optimisation runtime saving is 33468.23334693909ms
2022-09-21 19:20:42 INFO  ---RUNTIME: Multi-Query Optimization took 17.7304744720459 ms
2022-09-21 19:20:42 INFO  Executing generated plans
2022-09-21 19:20:48 INFO  ---RUNTIME: Execution took 5822.164297103882 ms
2022-09-21 19:20:48 INFO  Done!
2022-09-21 19:20:48 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-21 19:20:48 INFO  Running instrumented original pipeline...
2022-09-21 19:20:48 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-21 19:20:48 INFO  ---RUNTIME: Importing and monkey-patching took 5.943775177001953 ms
2022-09-21 19:20:53 INFO  ---RUNTIME: Original pipeline execution took 5117.504596710205 ms (excluding imports and monkey-patching)
2022-09-21 19:20:53 INFO  Starting execution of 1 what-if analyses...
2022-09-21 19:20:53 INFO  Start plan generation for analysis PermutationFeatureImportance...
2022-09-21 19:20:53 INFO  ---RUNTIME: Plan generation took 0.1316070556640625 ms
2022-09-21 19:20:53 INFO  Estimated runtime of original DAG is 4846.865177154541ms
2022-09-21 19:20:53 WARNING Skipping Multi-Query Optimization (instead, only applying patches)
2022-09-21 19:20:53 INFO  Estimated unoptimised what-if runtime is 38774.92141723633ms
2022-09-21 19:20:53 INFO  ---RUNTIME: Multi-Query Optimization took 7.700920104980469 ms
2022-09-21 19:20:53 INFO  Executing generated plans
2022-09-21 19:21:33 INFO  ---RUNTIME: Execution took 40087.80360221863 ms
2022-09-21 19:21:33 INFO  Done!
2022-09-21 19:21:33 INFO  # Finished -- repetition 7 of 7 
2022-09-21 19:21:33 INFO  # Final results after all repetitions
2022-09-21 19:21:33 INFO     repetition  ... no_opt_what_if_execution_combined_model_training
0           0  ...                                     29960.812330
1           1  ...                                     29374.777555
2           2  ...                                     29170.606375
3           3  ...                                     29837.915182
4           4  ...                                     29838.948965
5           5  ...                                     29156.974792
6           6  ...                                     29264.158487

[7 rows x 26 columns]
taskset -c 64-71 PROTOCOL_BUFFERS_PYTHON_IMPLEMENTATION=python python3.9 benchmarks_end_to_end.py feature_importance folktables slow_loading featurization_4 logistic_regression
2022-09-21 19:21:36.543184: W tensorflow/stream_executor/platform/default/dso_loader.cc:64] Could not load dynamic library 'libcudart.so.11.0'; dlerror: libcudart.so.11.0: cannot open shared object file: No such file or directory; LD_LIBRARY_PATH: /home/sgrafbe/mlwhatif/venv/lib/python3.9/site-packages/cv2/../../lib64:
2022-09-21 19:21:36.543223: I tensorflow/stream_executor/cuda/cudart_stub.cc:29] Ignore above cudart dlerror if you do not have a GPU set up on your machine.
2022-09-21 19:21:37 INFO  Patching sys.argv with ['mlwhatif', 'folktables', 'slow_loading', 'featurization_4', 'logistic_regression']
2022-09-21 19:21:37 INFO  Running instrumented original pipeline...
2022-09-21 19:21:37 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-21 19:21:38 INFO  ---RUNTIME: Importing and monkey-patching took 101.90868377685547 ms
2022-09-21 19:21:39 INFO  ---RUNTIME: Original pipeline execution took 1669.5771217346191 ms (excluding imports and monkey-patching)
2022-09-21 19:21:39 INFO  Starting execution of 0 what-if analyses...
2022-09-21 19:21:39 INFO  Estimated runtime of original DAG is 333.41479301452637ms
2022-09-21 19:21:39 INFO  Performing Multi-Query Optimization
2022-09-21 19:21:39 INFO  Estimated unoptimized what-if runtime is 0ms
2022-09-21 19:21:39 INFO  Estimated optimised what-if runtime is 0ms
2022-09-21 19:21:39 INFO  Estimated optimisation runtime saving is 0ms
2022-09-21 19:21:39 INFO  ---RUNTIME: Multi-Query Optimization took 0.5593299865722656 ms
2022-09-21 19:21:39 INFO  Executing generated plans
2022-09-21 19:21:39 INFO  ---RUNTIME: Execution took 0.015735626220703125 ms
2022-09-21 19:21:39 INFO  Done!
2022-09-21 19:21:39 INFO  # Optimization benchmark for feature_importance with args [['folktables', 'slow_loading', 'featurization_4', 'logistic_regression']] -- repetition 1 of 7
2022-09-21 19:21:39 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-21 19:21:39 INFO  Running instrumented original pipeline...
2022-09-21 19:21:39 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-21 19:21:39 INFO  ---RUNTIME: Importing and monkey-patching took 5.209207534790039 ms
2022-09-21 19:21:41 INFO  ---RUNTIME: Original pipeline execution took 1593.6615467071533 ms (excluding imports and monkey-patching)
2022-09-21 19:21:41 INFO  Starting execution of 1 what-if analyses...
2022-09-21 19:21:41 INFO  Start plan generation for analysis PermutationFeatureImportance...
2022-09-21 19:21:41 INFO  ---RUNTIME: Plan generation took 0.40078163146972656 ms
2022-09-21 19:21:41 INFO  Estimated runtime of original DAG is 305.19962310791016ms
2022-09-21 19:21:41 INFO  Performing Multi-Query Optimization
2022-09-21 19:21:41 INFO  Estimated unoptimized what-if runtime is 2441.5969848632812ms
2022-09-21 19:21:41 INFO  Estimated optimised what-if runtime is 360.77094078063965ms
2022-09-21 19:21:41 INFO  Estimated optimisation runtime saving is 2080.8260440826416ms
2022-09-21 19:21:41 INFO  ---RUNTIME: Multi-Query Optimization took 19.694089889526367 ms
2022-09-21 19:21:41 INFO  Executing generated plans
2022-09-21 19:21:41 INFO  ---RUNTIME: Execution took 516.1919593811035 ms
2022-09-21 19:21:41 INFO  Done!
2022-09-21 19:21:41 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-21 19:21:41 INFO  Running instrumented original pipeline...
2022-09-21 19:21:41 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-21 19:21:41 INFO  ---RUNTIME: Importing and monkey-patching took 5.885124206542969 ms
2022-09-21 19:21:43 INFO  ---RUNTIME: Original pipeline execution took 1856.0585975646973 ms (excluding imports and monkey-patching)
2022-09-21 19:21:43 INFO  Starting execution of 1 what-if analyses...
2022-09-21 19:21:43 INFO  Start plan generation for analysis PermutationFeatureImportance...
2022-09-21 19:21:43 INFO  ---RUNTIME: Plan generation took 0.1251697540283203 ms
2022-09-21 19:21:43 INFO  Estimated runtime of original DAG is 432.82628059387207ms
2022-09-21 19:21:43 WARNING Skipping Multi-Query Optimization (instead, only applying patches)
2022-09-21 19:21:43 INFO  Estimated unoptimised what-if runtime is 3462.6102447509766ms
2022-09-21 19:21:43 INFO  ---RUNTIME: Multi-Query Optimization took 6.749868392944336 ms
2022-09-21 19:21:43 INFO  Executing generated plans
2022-09-21 19:21:47 INFO  ---RUNTIME: Execution took 3484.7073554992676 ms
2022-09-21 19:21:47 INFO  Done!
2022-09-21 19:21:47 INFO  # Finished -- repetition 1 of 7 
2022-09-21 19:21:47 INFO  # Optimization benchmark for feature_importance with args [['folktables', 'slow_loading', 'featurization_4', 'logistic_regression']] -- repetition 2 of 7
2022-09-21 19:21:47 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-21 19:21:47 INFO  Running instrumented original pipeline...
2022-09-21 19:21:47 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-21 19:21:47 INFO  ---RUNTIME: Importing and monkey-patching took 5.795001983642578 ms
2022-09-21 19:21:48 INFO  ---RUNTIME: Original pipeline execution took 1592.6837921142578 ms (excluding imports and monkey-patching)
2022-09-21 19:21:48 INFO  Starting execution of 1 what-if analyses...
2022-09-21 19:21:48 INFO  Start plan generation for analysis PermutationFeatureImportance...
2022-09-21 19:21:48 INFO  ---RUNTIME: Plan generation took 0.1404285430908203 ms
2022-09-21 19:21:48 INFO  Estimated runtime of original DAG is 335.48450469970703ms
2022-09-21 19:21:48 INFO  Performing Multi-Query Optimization
2022-09-21 19:21:48 INFO  Estimated unoptimized what-if runtime is 2683.8760375976562ms
2022-09-21 19:21:48 INFO  Estimated optimised what-if runtime is 389.1642093658447ms
2022-09-21 19:21:48 INFO  Estimated optimisation runtime saving is 2294.7118282318115ms
2022-09-21 19:21:48 INFO  ---RUNTIME: Multi-Query Optimization took 19.512653350830078 ms
2022-09-21 19:21:48 INFO  Executing generated plans
2022-09-21 19:21:49 INFO  ---RUNTIME: Execution took 552.1209239959717 ms
2022-09-21 19:21:49 INFO  Done!
2022-09-21 19:21:49 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-21 19:21:49 INFO  Running instrumented original pipeline...
2022-09-21 19:21:49 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-21 19:21:49 INFO  ---RUNTIME: Importing and monkey-patching took 6.947517395019531 ms
2022-09-21 19:21:51 INFO  ---RUNTIME: Original pipeline execution took 1688.9917850494385 ms (excluding imports and monkey-patching)
2022-09-21 19:21:51 INFO  Starting execution of 1 what-if analyses...
2022-09-21 19:21:51 INFO  Start plan generation for analysis PermutationFeatureImportance...
2022-09-21 19:21:51 INFO  ---RUNTIME: Plan generation took 0.13208389282226562 ms
2022-09-21 19:21:51 INFO  Estimated runtime of original DAG is 371.1872100830078ms
2022-09-21 19:21:51 WARNING Skipping Multi-Query Optimization (instead, only applying patches)
2022-09-21 19:21:51 INFO  Estimated unoptimised what-if runtime is 2969.4976806640625ms
2022-09-21 19:21:51 INFO  ---RUNTIME: Multi-Query Optimization took 6.590366363525391 ms
2022-09-21 19:21:51 INFO  Executing generated plans
2022-09-21 19:21:54 INFO  ---RUNTIME: Execution took 3824.6755599975586 ms
2022-09-21 19:21:54 INFO  Done!
2022-09-21 19:21:54 INFO  # Finished -- repetition 2 of 7 
2022-09-21 19:21:54 INFO  # Optimization benchmark for feature_importance with args [['folktables', 'slow_loading', 'featurization_4', 'logistic_regression']] -- repetition 3 of 7
2022-09-21 19:21:54 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-21 19:21:54 INFO  Running instrumented original pipeline...
2022-09-21 19:21:54 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-21 19:21:54 INFO  ---RUNTIME: Importing and monkey-patching took 5.745410919189453 ms
2022-09-21 19:21:56 INFO  ---RUNTIME: Original pipeline execution took 1675.304651260376 ms (excluding imports and monkey-patching)
2022-09-21 19:21:56 INFO  Starting execution of 1 what-if analyses...
2022-09-21 19:21:56 INFO  Start plan generation for analysis PermutationFeatureImportance...
2022-09-21 19:21:56 INFO  ---RUNTIME: Plan generation took 0.13208389282226562 ms
2022-09-21 19:21:56 INFO  Estimated runtime of original DAG is 387.0813846588135ms
2022-09-21 19:21:56 INFO  Performing Multi-Query Optimization
2022-09-21 19:21:56 INFO  Estimated unoptimized what-if runtime is 3096.651077270508ms
2022-09-21 19:21:56 INFO  Estimated optimised what-if runtime is 441.67351722717285ms
2022-09-21 19:21:56 INFO  Estimated optimisation runtime saving is 2654.977560043335ms
2022-09-21 19:21:56 INFO  ---RUNTIME: Multi-Query Optimization took 22.011280059814453 ms
2022-09-21 19:21:56 INFO  Executing generated plans
2022-09-21 19:21:57 INFO  ---RUNTIME: Execution took 531.4126014709473 ms
2022-09-21 19:21:57 INFO  Done!
2022-09-21 19:21:57 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-21 19:21:57 INFO  Running instrumented original pipeline...
2022-09-21 19:21:57 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-21 19:21:57 INFO  ---RUNTIME: Importing and monkey-patching took 5.896806716918945 ms
2022-09-21 19:21:58 INFO  ---RUNTIME: Original pipeline execution took 1743.1824207305908 ms (excluding imports and monkey-patching)
2022-09-21 19:21:58 INFO  Starting execution of 1 what-if analyses...
2022-09-21 19:21:58 INFO  Start plan generation for analysis PermutationFeatureImportance...
2022-09-21 19:21:58 INFO  ---RUNTIME: Plan generation took 0.1316070556640625 ms
2022-09-21 19:21:58 INFO  Estimated runtime of original DAG is 366.1196231842041ms
2022-09-21 19:21:58 WARNING Skipping Multi-Query Optimization (instead, only applying patches)
2022-09-21 19:21:58 INFO  Estimated unoptimised what-if runtime is 2928.956985473633ms
2022-09-21 19:21:58 INFO  ---RUNTIME: Multi-Query Optimization took 6.270647048950195 ms
2022-09-21 19:21:58 INFO  Executing generated plans
2022-09-21 19:22:03 INFO  ---RUNTIME: Execution took 4217.8754806518555 ms
2022-09-21 19:22:03 INFO  Done!
2022-09-21 19:22:03 INFO  # Finished -- repetition 3 of 7 
2022-09-21 19:22:03 INFO  # Optimization benchmark for feature_importance with args [['folktables', 'slow_loading', 'featurization_4', 'logistic_regression']] -- repetition 4 of 7
2022-09-21 19:22:03 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-21 19:22:03 INFO  Running instrumented original pipeline...
2022-09-21 19:22:03 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-21 19:22:03 INFO  ---RUNTIME: Importing and monkey-patching took 5.749702453613281 ms
2022-09-21 19:22:04 INFO  ---RUNTIME: Original pipeline execution took 1592.893362045288 ms (excluding imports and monkey-patching)
2022-09-21 19:22:04 INFO  Starting execution of 1 what-if analyses...
2022-09-21 19:22:04 INFO  Start plan generation for analysis PermutationFeatureImportance...
2022-09-21 19:22:04 INFO  ---RUNTIME: Plan generation took 0.13446807861328125 ms
2022-09-21 19:22:04 INFO  Estimated runtime of original DAG is 341.21179580688477ms
2022-09-21 19:22:04 INFO  Performing Multi-Query Optimization
2022-09-21 19:22:04 INFO  Estimated unoptimized what-if runtime is 2729.694366455078ms
2022-09-21 19:22:04 INFO  Estimated optimised what-if runtime is 392.8256034851074ms
2022-09-21 19:22:04 INFO  Estimated optimisation runtime saving is 2336.8687629699707ms
2022-09-21 19:22:04 INFO  ---RUNTIME: Multi-Query Optimization took 19.616365432739258 ms
2022-09-21 19:22:04 INFO  Executing generated plans
2022-09-21 19:22:05 INFO  ---RUNTIME: Execution took 854.088544845581 ms
2022-09-21 19:22:05 INFO  Done!
2022-09-21 19:22:05 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-21 19:22:05 INFO  Running instrumented original pipeline...
2022-09-21 19:22:05 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-21 19:22:05 INFO  ---RUNTIME: Importing and monkey-patching took 5.485773086547852 ms
2022-09-21 19:22:07 INFO  ---RUNTIME: Original pipeline execution took 1629.1956901550293 ms (excluding imports and monkey-patching)
2022-09-21 19:22:07 INFO  Starting execution of 1 what-if analyses...
2022-09-21 19:22:07 INFO  Start plan generation for analysis PermutationFeatureImportance...
2022-09-21 19:22:07 INFO  ---RUNTIME: Plan generation took 0.12040138244628906 ms
2022-09-21 19:22:07 INFO  Estimated runtime of original DAG is 320.0550079345703ms
2022-09-21 19:22:07 WARNING Skipping Multi-Query Optimization (instead, only applying patches)
2022-09-21 19:22:07 INFO  Estimated unoptimised what-if runtime is 2560.4400634765625ms
2022-09-21 19:22:07 INFO  ---RUNTIME: Multi-Query Optimization took 203.95851135253906 ms
2022-09-21 19:22:07 INFO  Executing generated plans
2022-09-21 19:22:10 INFO  ---RUNTIME: Execution took 3616.150140762329 ms
2022-09-21 19:22:10 INFO  Done!
2022-09-21 19:22:11 INFO  # Finished -- repetition 4 of 7 
2022-09-21 19:22:11 INFO  # Optimization benchmark for feature_importance with args [['folktables', 'slow_loading', 'featurization_4', 'logistic_regression']] -- repetition 5 of 7
2022-09-21 19:22:11 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-21 19:22:11 INFO  Running instrumented original pipeline...
2022-09-21 19:22:11 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-21 19:22:11 INFO  ---RUNTIME: Importing and monkey-patching took 6.2999725341796875 ms
2022-09-21 19:22:12 INFO  ---RUNTIME: Original pipeline execution took 1707.1573734283447 ms (excluding imports and monkey-patching)
2022-09-21 19:22:12 INFO  Starting execution of 1 what-if analyses...
2022-09-21 19:22:12 INFO  Start plan generation for analysis PermutationFeatureImportance...
2022-09-21 19:22:12 INFO  ---RUNTIME: Plan generation took 0.17380714416503906 ms
2022-09-21 19:22:12 INFO  Estimated runtime of original DAG is 345.2427387237549ms
2022-09-21 19:22:12 INFO  Performing Multi-Query Optimization
2022-09-21 19:22:12 INFO  Estimated unoptimized what-if runtime is 2761.941909790039ms
2022-09-21 19:22:12 INFO  Estimated optimised what-if runtime is 396.93355560302734ms
2022-09-21 19:22:12 INFO  Estimated optimisation runtime saving is 2365.0083541870117ms
2022-09-21 19:22:12 INFO  ---RUNTIME: Multi-Query Optimization took 27.129411697387695 ms
2022-09-21 19:22:12 INFO  Executing generated plans
2022-09-21 19:22:13 INFO  ---RUNTIME: Execution took 517.7841186523438 ms
2022-09-21 19:22:13 INFO  Done!
2022-09-21 19:22:13 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-21 19:22:13 INFO  Running instrumented original pipeline...
2022-09-21 19:22:13 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-21 19:22:13 INFO  ---RUNTIME: Importing and monkey-patching took 6.317138671875 ms
2022-09-21 19:22:14 INFO  ---RUNTIME: Original pipeline execution took 1649.7993469238281 ms (excluding imports and monkey-patching)
2022-09-21 19:22:14 INFO  Starting execution of 1 what-if analyses...
2022-09-21 19:22:14 INFO  Start plan generation for analysis PermutationFeatureImportance...
2022-09-21 19:22:14 INFO  ---RUNTIME: Plan generation took 0.16570091247558594 ms
2022-09-21 19:22:14 INFO  Estimated runtime of original DAG is 370.7406520843506ms
2022-09-21 19:22:14 WARNING Skipping Multi-Query Optimization (instead, only applying patches)
2022-09-21 19:22:14 INFO  Estimated unoptimised what-if runtime is 2965.9252166748047ms
2022-09-21 19:22:14 INFO  ---RUNTIME: Multi-Query Optimization took 6.789445877075195 ms
2022-09-21 19:22:14 INFO  Executing generated plans
2022-09-21 19:22:18 INFO  ---RUNTIME: Execution took 3790.6103134155273 ms
2022-09-21 19:22:18 INFO  Done!
2022-09-21 19:22:18 INFO  # Finished -- repetition 5 of 7 
2022-09-21 19:22:18 INFO  # Optimization benchmark for feature_importance with args [['folktables', 'slow_loading', 'featurization_4', 'logistic_regression']] -- repetition 6 of 7
2022-09-21 19:22:18 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-21 19:22:18 INFO  Running instrumented original pipeline...
2022-09-21 19:22:18 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-21 19:22:18 INFO  ---RUNTIME: Importing and monkey-patching took 5.911827087402344 ms
2022-09-21 19:22:20 INFO  ---RUNTIME: Original pipeline execution took 1642.9717540740967 ms (excluding imports and monkey-patching)
2022-09-21 19:22:20 INFO  Starting execution of 1 what-if analyses...
2022-09-21 19:22:20 INFO  Start plan generation for analysis PermutationFeatureImportance...
2022-09-21 19:22:20 INFO  ---RUNTIME: Plan generation took 0.1342296600341797 ms
2022-09-21 19:22:20 INFO  Estimated runtime of original DAG is 350.95834732055664ms
2022-09-21 19:22:20 INFO  Performing Multi-Query Optimization
2022-09-21 19:22:20 INFO  Estimated unoptimized what-if runtime is 2807.666778564453ms
2022-09-21 19:22:20 INFO  Estimated optimised what-if runtime is 404.04748916625977ms
2022-09-21 19:22:20 INFO  Estimated optimisation runtime saving is 2403.6192893981934ms
2022-09-21 19:22:20 INFO  ---RUNTIME: Multi-Query Optimization took 20.43604850769043 ms
2022-09-21 19:22:20 INFO  Executing generated plans
2022-09-21 19:22:20 INFO  ---RUNTIME: Execution took 544.8546409606934 ms
2022-09-21 19:22:20 INFO  Done!
2022-09-21 19:22:20 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-21 19:22:20 INFO  Running instrumented original pipeline...
2022-09-21 19:22:20 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-21 19:22:20 INFO  ---RUNTIME: Importing and monkey-patching took 6.050348281860352 ms
2022-09-21 19:22:22 INFO  ---RUNTIME: Original pipeline execution took 1610.8129024505615 ms (excluding imports and monkey-patching)
2022-09-21 19:22:22 INFO  Starting execution of 1 what-if analyses...
2022-09-21 19:22:22 INFO  Start plan generation for analysis PermutationFeatureImportance...
2022-09-21 19:22:22 INFO  ---RUNTIME: Plan generation took 0.12493133544921875 ms
2022-09-21 19:22:22 INFO  Estimated runtime of original DAG is 318.15314292907715ms
2022-09-21 19:22:22 WARNING Skipping Multi-Query Optimization (instead, only applying patches)
2022-09-21 19:22:22 INFO  Estimated unoptimised what-if runtime is 2545.225143432617ms
2022-09-21 19:22:22 INFO  ---RUNTIME: Multi-Query Optimization took 6.775140762329102 ms
2022-09-21 19:22:22 INFO  Executing generated plans
2022-09-21 19:22:26 INFO  ---RUNTIME: Execution took 3555.971622467041 ms
2022-09-21 19:22:26 INFO  Done!
2022-09-21 19:22:26 INFO  # Finished -- repetition 6 of 7 
2022-09-21 19:22:26 INFO  # Optimization benchmark for feature_importance with args [['folktables', 'slow_loading', 'featurization_4', 'logistic_regression']] -- repetition 7 of 7
2022-09-21 19:22:26 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-21 19:22:26 INFO  Running instrumented original pipeline...
2022-09-21 19:22:26 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-21 19:22:26 INFO  ---RUNTIME: Importing and monkey-patching took 6.171941757202148 ms
2022-09-21 19:22:27 INFO  ---RUNTIME: Original pipeline execution took 1668.6110496520996 ms (excluding imports and monkey-patching)
2022-09-21 19:22:27 INFO  Starting execution of 1 what-if analyses...
2022-09-21 19:22:27 INFO  Start plan generation for analysis PermutationFeatureImportance...
2022-09-21 19:22:27 INFO  ---RUNTIME: Plan generation took 0.12135505676269531 ms
2022-09-21 19:22:27 INFO  Estimated runtime of original DAG is 387.6361846923828ms
2022-09-21 19:22:27 INFO  Performing Multi-Query Optimization
2022-09-21 19:22:27 INFO  Estimated unoptimized what-if runtime is 3101.0894775390625ms
2022-09-21 19:22:27 INFO  Estimated optimised what-if runtime is 436.9018077850342ms
2022-09-21 19:22:27 INFO  Estimated optimisation runtime saving is 2664.1876697540283ms
2022-09-21 19:22:27 INFO  ---RUNTIME: Multi-Query Optimization took 17.40264892578125 ms
2022-09-21 19:22:27 INFO  Executing generated plans
2022-09-21 19:22:28 INFO  ---RUNTIME: Execution took 532.2678089141846 ms
2022-09-21 19:22:28 INFO  Done!
2022-09-21 19:22:28 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-21 19:22:28 INFO  Running instrumented original pipeline...
2022-09-21 19:22:28 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-21 19:22:28 INFO  ---RUNTIME: Importing and monkey-patching took 5.552768707275391 ms
2022-09-21 19:22:30 INFO  ---RUNTIME: Original pipeline execution took 1677.9890060424805 ms (excluding imports and monkey-patching)
2022-09-21 19:22:30 INFO  Starting execution of 1 what-if analyses...
2022-09-21 19:22:30 INFO  Start plan generation for analysis PermutationFeatureImportance...
2022-09-21 19:22:30 INFO  ---RUNTIME: Plan generation took 0.11849403381347656 ms
2022-09-21 19:22:30 INFO  Estimated runtime of original DAG is 375.3011226654053ms
2022-09-21 19:22:30 WARNING Skipping Multi-Query Optimization (instead, only applying patches)
2022-09-21 19:22:30 INFO  Estimated unoptimised what-if runtime is 3002.408981323242ms
2022-09-21 19:22:30 INFO  ---RUNTIME: Multi-Query Optimization took 6.309986114501953 ms
2022-09-21 19:22:30 INFO  Executing generated plans
2022-09-21 19:22:33 INFO  ---RUNTIME: Execution took 3670.8271503448486 ms
2022-09-21 19:22:33 INFO  Done!
2022-09-21 19:22:33 INFO  # Finished -- repetition 7 of 7 
2022-09-21 19:22:33 INFO  # Final results after all repetitions
2022-09-21 19:22:33 INFO     repetition  ... no_opt_what_if_execution_combined_model_training
0           0  ...                                       536.405802
1           1  ...                                       520.383835
2           2  ...                                       556.176901
3           3  ...                                       542.101145
4           4  ...                                       518.568516
5           5  ...                                       527.441025
6           6  ...                                       527.297735

[7 rows x 26 columns]
taskset -c 64-71 PROTOCOL_BUFFERS_PYTHON_IMPLEMENTATION=python python3.9 benchmarks_end_to_end.py feature_importance folktables slow_loading featurization_4 xgboost
2022-09-21 19:22:35.903365: W tensorflow/stream_executor/platform/default/dso_loader.cc:64] Could not load dynamic library 'libcudart.so.11.0'; dlerror: libcudart.so.11.0: cannot open shared object file: No such file or directory; LD_LIBRARY_PATH: /home/sgrafbe/mlwhatif/venv/lib/python3.9/site-packages/cv2/../../lib64:
2022-09-21 19:22:35.903401: I tensorflow/stream_executor/cuda/cudart_stub.cc:29] Ignore above cudart dlerror if you do not have a GPU set up on your machine.
2022-09-21 19:22:37 INFO  Patching sys.argv with ['mlwhatif', 'folktables', 'slow_loading', 'featurization_4', 'xgboost']
2022-09-21 19:22:37 INFO  Running instrumented original pipeline...
2022-09-21 19:22:37 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-21 19:22:37 INFO  ---RUNTIME: Importing and monkey-patching took 97.02682495117188 ms
2022-09-21 19:22:39 INFO  ---RUNTIME: Original pipeline execution took 2201.901912689209 ms (excluding imports and monkey-patching)
2022-09-21 19:22:39 INFO  Starting execution of 0 what-if analyses...
2022-09-21 19:22:39 INFO  Estimated runtime of original DAG is 818.5372352600098ms
2022-09-21 19:22:39 INFO  Performing Multi-Query Optimization
2022-09-21 19:22:39 INFO  Estimated unoptimized what-if runtime is 0ms
2022-09-21 19:22:39 INFO  Estimated optimised what-if runtime is 0ms
2022-09-21 19:22:39 INFO  Estimated optimisation runtime saving is 0ms
2022-09-21 19:22:39 INFO  ---RUNTIME: Multi-Query Optimization took 0.6833076477050781 ms
2022-09-21 19:22:39 INFO  Executing generated plans
2022-09-21 19:22:39 INFO  ---RUNTIME: Execution took 0.02002716064453125 ms
2022-09-21 19:22:39 INFO  Done!
2022-09-21 19:22:39 INFO  # Optimization benchmark for feature_importance with args [['folktables', 'slow_loading', 'featurization_4', 'xgboost']] -- repetition 1 of 7
2022-09-21 19:22:39 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-21 19:22:39 INFO  Running instrumented original pipeline...
2022-09-21 19:22:39 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-21 19:22:39 INFO  ---RUNTIME: Importing and monkey-patching took 6.166219711303711 ms
2022-09-21 19:22:41 INFO  ---RUNTIME: Original pipeline execution took 2022.0158100128174 ms (excluding imports and monkey-patching)
2022-09-21 19:22:41 INFO  Starting execution of 1 what-if analyses...
2022-09-21 19:22:41 INFO  Start plan generation for analysis PermutationFeatureImportance...
2022-09-21 19:22:41 INFO  ---RUNTIME: Plan generation took 0.30517578125 ms
2022-09-21 19:22:41 INFO  Estimated runtime of original DAG is 692.3274993896484ms
2022-09-21 19:22:41 INFO  Performing Multi-Query Optimization
2022-09-21 19:22:41 INFO  Estimated unoptimized what-if runtime is 5538.6199951171875ms
2022-09-21 19:22:41 INFO  Estimated optimised what-if runtime is 1004.3551921844482ms
2022-09-21 19:22:41 INFO  Estimated optimisation runtime saving is 4534.264802932739ms
2022-09-21 19:22:41 INFO  ---RUNTIME: Multi-Query Optimization took 19.696474075317383 ms
2022-09-21 19:22:41 INFO  Executing generated plans
2022-09-21 19:22:42 INFO  ---RUNTIME: Execution took 1091.2590026855469 ms
2022-09-21 19:22:42 INFO  Done!
2022-09-21 19:22:42 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-21 19:22:42 INFO  Running instrumented original pipeline...
2022-09-21 19:22:42 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-21 19:22:42 INFO  ---RUNTIME: Importing and monkey-patching took 5.644083023071289 ms
2022-09-21 19:22:44 INFO  ---RUNTIME: Original pipeline execution took 2281.0239791870117 ms (excluding imports and monkey-patching)
2022-09-21 19:22:44 INFO  Starting execution of 1 what-if analyses...
2022-09-21 19:22:44 INFO  Start plan generation for analysis PermutationFeatureImportance...
2022-09-21 19:22:44 INFO  ---RUNTIME: Plan generation took 0.13828277587890625 ms
2022-09-21 19:22:44 INFO  Estimated runtime of original DAG is 790.4086112976074ms
2022-09-21 19:22:44 WARNING Skipping Multi-Query Optimization (instead, only applying patches)
2022-09-21 19:22:44 INFO  Estimated unoptimised what-if runtime is 6323.268890380859ms
2022-09-21 19:22:44 INFO  ---RUNTIME: Multi-Query Optimization took 6.77180290222168 ms
2022-09-21 19:22:44 INFO  Executing generated plans
2022-09-21 19:22:53 INFO  ---RUNTIME: Execution took 8334.733009338379 ms
2022-09-21 19:22:53 INFO  Done!
2022-09-21 19:22:53 INFO  # Finished -- repetition 1 of 7 
2022-09-21 19:22:53 INFO  # Optimization benchmark for feature_importance with args [['folktables', 'slow_loading', 'featurization_4', 'xgboost']] -- repetition 2 of 7
2022-09-21 19:22:53 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-21 19:22:53 INFO  Running instrumented original pipeline...
2022-09-21 19:22:53 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-21 19:22:53 INFO  ---RUNTIME: Importing and monkey-patching took 5.9947967529296875 ms
2022-09-21 19:22:55 INFO  ---RUNTIME: Original pipeline execution took 2042.4463748931885 ms (excluding imports and monkey-patching)
2022-09-21 19:22:55 INFO  Starting execution of 1 what-if analyses...
2022-09-21 19:22:55 INFO  Start plan generation for analysis PermutationFeatureImportance...
2022-09-21 19:22:55 INFO  ---RUNTIME: Plan generation took 0.16951560974121094 ms
2022-09-21 19:22:55 INFO  Estimated runtime of original DAG is 702.8717994689941ms
2022-09-21 19:22:55 INFO  Performing Multi-Query Optimization
2022-09-21 19:22:55 INFO  Estimated unoptimized what-if runtime is 5622.974395751953ms
2022-09-21 19:22:55 INFO  Estimated optimised what-if runtime is 987.4863624572754ms
2022-09-21 19:22:55 INFO  Estimated optimisation runtime saving is 4635.488033294678ms
2022-09-21 19:22:55 INFO  ---RUNTIME: Multi-Query Optimization took 19.464969635009766 ms
2022-09-21 19:22:55 INFO  Executing generated plans
2022-09-21 19:22:56 INFO  ---RUNTIME: Execution took 1019.291877746582 ms
2022-09-21 19:22:56 INFO  Done!
2022-09-21 19:22:56 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-21 19:22:56 INFO  Running instrumented original pipeline...
2022-09-21 19:22:56 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-21 19:22:56 INFO  ---RUNTIME: Importing and monkey-patching took 5.62739372253418 ms
2022-09-21 19:22:58 INFO  ---RUNTIME: Original pipeline execution took 1939.7025108337402 ms (excluding imports and monkey-patching)
2022-09-21 19:22:58 INFO  Starting execution of 1 what-if analyses...
2022-09-21 19:22:58 INFO  Start plan generation for analysis PermutationFeatureImportance...
2022-09-21 19:22:58 INFO  ---RUNTIME: Plan generation took 0.16069412231445312 ms
2022-09-21 19:22:58 INFO  Estimated runtime of original DAG is 659.9876880645752ms
2022-09-21 19:22:58 WARNING Skipping Multi-Query Optimization (instead, only applying patches)
2022-09-21 19:22:58 INFO  Estimated unoptimised what-if runtime is 5279.901504516602ms
2022-09-21 19:22:58 INFO  ---RUNTIME: Multi-Query Optimization took 6.682157516479492 ms
2022-09-21 19:22:58 INFO  Executing generated plans
2022-09-21 19:23:07 INFO  ---RUNTIME: Execution took 9598.06752204895 ms
2022-09-21 19:23:07 INFO  Done!
2022-09-21 19:23:07 INFO  # Finished -- repetition 2 of 7 
2022-09-21 19:23:07 INFO  # Optimization benchmark for feature_importance with args [['folktables', 'slow_loading', 'featurization_4', 'xgboost']] -- repetition 3 of 7
2022-09-21 19:23:07 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-21 19:23:07 INFO  Running instrumented original pipeline...
2022-09-21 19:23:07 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-21 19:23:08 INFO  ---RUNTIME: Importing and monkey-patching took 6.109714508056641 ms
2022-09-21 19:23:09 INFO  ---RUNTIME: Original pipeline execution took 2014.81294631958 ms (excluding imports and monkey-patching)
2022-09-21 19:23:09 INFO  Starting execution of 1 what-if analyses...
2022-09-21 19:23:09 INFO  Start plan generation for analysis PermutationFeatureImportance...
2022-09-21 19:23:09 INFO  ---RUNTIME: Plan generation took 0.1347064971923828 ms
2022-09-21 19:23:09 INFO  Estimated runtime of original DAG is 716.5124416351318ms
2022-09-21 19:23:09 INFO  Performing Multi-Query Optimization
2022-09-21 19:23:10 INFO  Estimated unoptimized what-if runtime is 5732.099533081055ms
2022-09-21 19:23:10 INFO  Estimated optimised what-if runtime is 1130.2239894866943ms
2022-09-21 19:23:10 INFO  Estimated optimisation runtime saving is 4601.87554359436ms
2022-09-21 19:23:10 INFO  ---RUNTIME: Multi-Query Optimization took 19.983291625976562 ms
2022-09-21 19:23:10 INFO  Executing generated plans
2022-09-21 19:23:10 INFO  ---RUNTIME: Execution took 994.849443435669 ms
2022-09-21 19:23:10 INFO  Done!
2022-09-21 19:23:11 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-21 19:23:11 INFO  Running instrumented original pipeline...
2022-09-21 19:23:11 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-21 19:23:11 INFO  ---RUNTIME: Importing and monkey-patching took 6.01506233215332 ms
2022-09-21 19:23:13 INFO  ---RUNTIME: Original pipeline execution took 2748.02565574646 ms (excluding imports and monkey-patching)
2022-09-21 19:23:13 INFO  Starting execution of 1 what-if analyses...
2022-09-21 19:23:13 INFO  Start plan generation for analysis PermutationFeatureImportance...
2022-09-21 19:23:13 INFO  ---RUNTIME: Plan generation took 0.13685226440429688 ms
2022-09-21 19:23:13 INFO  Estimated runtime of original DAG is 1449.7954845428467ms
2022-09-21 19:23:13 WARNING Skipping Multi-Query Optimization (instead, only applying patches)
2022-09-21 19:23:13 INFO  Estimated unoptimised what-if runtime is 11598.363876342773ms
2022-09-21 19:23:13 INFO  ---RUNTIME: Multi-Query Optimization took 6.83903694152832 ms
2022-09-21 19:23:13 INFO  Executing generated plans
2022-09-21 19:23:21 INFO  ---RUNTIME: Execution took 7715.77787399292 ms
2022-09-21 19:23:21 INFO  Done!
2022-09-21 19:23:21 INFO  # Finished -- repetition 3 of 7 
2022-09-21 19:23:21 INFO  # Optimization benchmark for feature_importance with args [['folktables', 'slow_loading', 'featurization_4', 'xgboost']] -- repetition 4 of 7
2022-09-21 19:23:21 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-21 19:23:21 INFO  Running instrumented original pipeline...
2022-09-21 19:23:21 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-21 19:23:21 INFO  ---RUNTIME: Importing and monkey-patching took 5.853891372680664 ms
2022-09-21 19:23:23 INFO  ---RUNTIME: Original pipeline execution took 1975.480318069458 ms (excluding imports and monkey-patching)
2022-09-21 19:23:23 INFO  Starting execution of 1 what-if analyses...
2022-09-21 19:23:23 INFO  Start plan generation for analysis PermutationFeatureImportance...
2022-09-21 19:23:23 INFO  ---RUNTIME: Plan generation took 0.1595020294189453 ms
2022-09-21 19:23:23 INFO  Estimated runtime of original DAG is 679.2507171630859ms
2022-09-21 19:23:23 INFO  Performing Multi-Query Optimization
2022-09-21 19:23:23 INFO  Estimated unoptimized what-if runtime is 5434.0057373046875ms
2022-09-21 19:23:23 INFO  Estimated optimised what-if runtime is 986.2608909606934ms
2022-09-21 19:23:23 INFO  Estimated optimisation runtime saving is 4447.744846343994ms
2022-09-21 19:23:23 INFO  ---RUNTIME: Multi-Query Optimization took 17.73548126220703 ms
2022-09-21 19:23:23 INFO  Executing generated plans
2022-09-21 19:23:27 INFO  ---RUNTIME: Execution took 4152.045726776123 ms
2022-09-21 19:23:27 INFO  Done!
2022-09-21 19:23:27 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-21 19:23:27 INFO  Running instrumented original pipeline...
2022-09-21 19:23:27 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-21 19:23:27 INFO  ---RUNTIME: Importing and monkey-patching took 6.298303604125977 ms
2022-09-21 19:23:32 INFO  ---RUNTIME: Original pipeline execution took 4692.810773849487 ms (excluding imports and monkey-patching)
2022-09-21 19:23:32 INFO  Starting execution of 1 what-if analyses...
2022-09-21 19:23:32 INFO  Start plan generation for analysis PermutationFeatureImportance...
2022-09-21 19:23:32 INFO  ---RUNTIME: Plan generation took 0.12969970703125 ms
2022-09-21 19:23:32 INFO  Estimated runtime of original DAG is 3153.263568878174ms
2022-09-21 19:23:32 WARNING Skipping Multi-Query Optimization (instead, only applying patches)
2022-09-21 19:23:32 INFO  Estimated unoptimised what-if runtime is 25226.10855102539ms
2022-09-21 19:23:32 INFO  ---RUNTIME: Multi-Query Optimization took 6.154537200927734 ms
2022-09-21 19:23:32 INFO  Executing generated plans
2022-09-21 19:23:41 INFO  ---RUNTIME: Execution took 9209.701776504517 ms
2022-09-21 19:23:41 INFO  Done!
2022-09-21 19:23:41 INFO  # Finished -- repetition 4 of 7 
2022-09-21 19:23:41 INFO  # Optimization benchmark for feature_importance with args [['folktables', 'slow_loading', 'featurization_4', 'xgboost']] -- repetition 5 of 7
2022-09-21 19:23:41 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-21 19:23:41 INFO  Running instrumented original pipeline...
2022-09-21 19:23:41 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-21 19:23:41 INFO  ---RUNTIME: Importing and monkey-patching took 5.85484504699707 ms
2022-09-21 19:23:43 INFO  ---RUNTIME: Original pipeline execution took 2050.5757331848145 ms (excluding imports and monkey-patching)
2022-09-21 19:23:43 INFO  Starting execution of 1 what-if analyses...
2022-09-21 19:23:43 INFO  Start plan generation for analysis PermutationFeatureImportance...
2022-09-21 19:23:43 INFO  ---RUNTIME: Plan generation took 0.21195411682128906 ms
2022-09-21 19:23:43 INFO  Estimated runtime of original DAG is 739.3722534179688ms
2022-09-21 19:23:43 INFO  Performing Multi-Query Optimization
2022-09-21 19:23:43 INFO  Estimated unoptimized what-if runtime is 5914.97802734375ms
2022-09-21 19:23:43 INFO  Estimated optimised what-if runtime is 882.3866844177246ms
2022-09-21 19:23:43 INFO  Estimated optimisation runtime saving is 5032.591342926025ms
2022-09-21 19:23:43 INFO  ---RUNTIME: Multi-Query Optimization took 19.730567932128906 ms
2022-09-21 19:23:43 INFO  Executing generated plans
2022-09-21 19:23:44 INFO  ---RUNTIME: Execution took 1016.7741775512695 ms
2022-09-21 19:23:44 INFO  Done!
2022-09-21 19:23:44 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-21 19:23:44 INFO  Running instrumented original pipeline...
2022-09-21 19:23:44 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-21 19:23:44 INFO  ---RUNTIME: Importing and monkey-patching took 6.096363067626953 ms
2022-09-21 19:23:46 INFO  ---RUNTIME: Original pipeline execution took 2228.212833404541 ms (excluding imports and monkey-patching)
2022-09-21 19:23:46 INFO  Starting execution of 1 what-if analyses...
2022-09-21 19:23:46 INFO  Start plan generation for analysis PermutationFeatureImportance...
2022-09-21 19:23:46 INFO  ---RUNTIME: Plan generation took 0.13065338134765625 ms
2022-09-21 19:23:46 INFO  Estimated runtime of original DAG is 808.8846206665039ms
2022-09-21 19:23:46 WARNING Skipping Multi-Query Optimization (instead, only applying patches)
2022-09-21 19:23:46 INFO  Estimated unoptimised what-if runtime is 6471.076965332031ms
2022-09-21 19:23:46 INFO  ---RUNTIME: Multi-Query Optimization took 7.826805114746094 ms
2022-09-21 19:23:46 INFO  Executing generated plans
2022-09-21 19:23:53 INFO  ---RUNTIME: Execution took 7053.67636680603 ms
2022-09-21 19:23:53 INFO  Done!
2022-09-21 19:23:53 INFO  # Finished -- repetition 5 of 7 
2022-09-21 19:23:53 INFO  # Optimization benchmark for feature_importance with args [['folktables', 'slow_loading', 'featurization_4', 'xgboost']] -- repetition 6 of 7
2022-09-21 19:23:53 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-21 19:23:53 INFO  Running instrumented original pipeline...
2022-09-21 19:23:54 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-21 19:23:54 INFO  ---RUNTIME: Importing and monkey-patching took 6.441354751586914 ms
2022-09-21 19:23:57 INFO  ---RUNTIME: Original pipeline execution took 3709.1026306152344 ms (excluding imports and monkey-patching)
2022-09-21 19:23:57 INFO  Starting execution of 1 what-if analyses...
2022-09-21 19:23:57 INFO  Start plan generation for analysis PermutationFeatureImportance...
2022-09-21 19:23:57 INFO  ---RUNTIME: Plan generation took 0.17070770263671875 ms
2022-09-21 19:23:57 INFO  Estimated runtime of original DAG is 2353.2867431640625ms
2022-09-21 19:23:57 INFO  Performing Multi-Query Optimization
2022-09-21 19:23:57 INFO  Estimated unoptimized what-if runtime is 18826.2939453125ms
2022-09-21 19:23:57 INFO  Estimated optimised what-if runtime is 2681.4920902252197ms
2022-09-21 19:23:57 INFO  Estimated optimisation runtime saving is 16144.80185508728ms
2022-09-21 19:23:57 INFO  ---RUNTIME: Multi-Query Optimization took 19.669055938720703 ms
2022-09-21 19:23:57 INFO  Executing generated plans
2022-09-21 19:23:58 INFO  ---RUNTIME: Execution took 966.2086963653564 ms
2022-09-21 19:23:58 INFO  Done!
2022-09-21 19:23:58 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-21 19:23:58 INFO  Running instrumented original pipeline...
2022-09-21 19:23:58 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-21 19:23:58 INFO  ---RUNTIME: Importing and monkey-patching took 5.5255889892578125 ms
2022-09-21 19:24:00 INFO  ---RUNTIME: Original pipeline execution took 2040.8174991607666 ms (excluding imports and monkey-patching)
2022-09-21 19:24:00 INFO  Starting execution of 1 what-if analyses...
2022-09-21 19:24:00 INFO  Start plan generation for analysis PermutationFeatureImportance...
2022-09-21 19:24:00 INFO  ---RUNTIME: Plan generation took 0.16999244689941406 ms
2022-09-21 19:24:00 INFO  Estimated runtime of original DAG is 680.7150840759277ms
2022-09-21 19:24:00 WARNING Skipping Multi-Query Optimization (instead, only applying patches)
2022-09-21 19:24:00 INFO  Estimated unoptimised what-if runtime is 5445.720672607422ms
2022-09-21 19:24:00 INFO  ---RUNTIME: Multi-Query Optimization took 9.334325790405273 ms
2022-09-21 19:24:00 INFO  Executing generated plans
2022-09-21 19:24:09 INFO  ---RUNTIME: Execution took 8811.173915863037 ms
2022-09-21 19:24:09 INFO  Done!
2022-09-21 19:24:09 INFO  # Finished -- repetition 6 of 7 
2022-09-21 19:24:09 INFO  # Optimization benchmark for feature_importance with args [['folktables', 'slow_loading', 'featurization_4', 'xgboost']] -- repetition 7 of 7
2022-09-21 19:24:09 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-21 19:24:09 INFO  Running instrumented original pipeline...
2022-09-21 19:24:09 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-21 19:24:09 INFO  ---RUNTIME: Importing and monkey-patching took 6.719827651977539 ms
2022-09-21 19:24:11 INFO  ---RUNTIME: Original pipeline execution took 2098.9859104156494 ms (excluding imports and monkey-patching)
2022-09-21 19:24:11 INFO  Starting execution of 1 what-if analyses...
2022-09-21 19:24:11 INFO  Start plan generation for analysis PermutationFeatureImportance...
2022-09-21 19:24:11 INFO  ---RUNTIME: Plan generation took 0.1323223114013672 ms
2022-09-21 19:24:11 INFO  Estimated runtime of original DAG is 760.4207992553711ms
2022-09-21 19:24:11 INFO  Performing Multi-Query Optimization
2022-09-21 19:24:11 INFO  Estimated unoptimized what-if runtime is 6083.366394042969ms
2022-09-21 19:24:11 INFO  Estimated optimised what-if runtime is 1062.3652935028076ms
2022-09-21 19:24:11 INFO  Estimated optimisation runtime saving is 5021.001100540161ms
2022-09-21 19:24:11 INFO  ---RUNTIME: Multi-Query Optimization took 18.288850784301758 ms
2022-09-21 19:24:11 INFO  Executing generated plans
2022-09-21 19:24:13 INFO  ---RUNTIME: Execution took 1350.292682647705 ms
2022-09-21 19:24:13 INFO  Done!
2022-09-21 19:24:13 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-21 19:24:13 INFO  Running instrumented original pipeline...
2022-09-21 19:24:13 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-21 19:24:13 INFO  ---RUNTIME: Importing and monkey-patching took 6.088018417358398 ms
2022-09-21 19:24:15 INFO  ---RUNTIME: Original pipeline execution took 2056.969165802002 ms (excluding imports and monkey-patching)
2022-09-21 19:24:15 INFO  Starting execution of 1 what-if analyses...
2022-09-21 19:24:15 INFO  Start plan generation for analysis PermutationFeatureImportance...
2022-09-21 19:24:15 INFO  ---RUNTIME: Plan generation took 0.14734268188476562 ms
2022-09-21 19:24:15 INFO  Estimated runtime of original DAG is 689.202070236206ms
2022-09-21 19:24:15 WARNING Skipping Multi-Query Optimization (instead, only applying patches)
2022-09-21 19:24:15 INFO  Estimated unoptimised what-if runtime is 5513.616561889648ms
2022-09-21 19:24:15 INFO  ---RUNTIME: Multi-Query Optimization took 7.099628448486328 ms
2022-09-21 19:24:15 INFO  Executing generated plans
2022-09-21 19:24:23 INFO  ---RUNTIME: Execution took 8362.919092178345 ms
2022-09-21 19:24:23 INFO  Done!
2022-09-21 19:24:23 INFO  # Finished -- repetition 7 of 7 
2022-09-21 19:24:23 INFO  # Final results after all repetitions
2022-09-21 19:24:23 INFO     repetition  ... no_opt_what_if_execution_combined_model_training
0           0  ...                                      4985.164642
1           1  ...                                      6223.440886
2           2  ...                                      4408.079624
3           3  ...                                      6006.399393
4           4  ...                                      4001.267195
5           5  ...                                      5562.179565
6           6  ...                                      5188.977718

[7 rows x 26 columns]
taskset -c 64-71 PROTOCOL_BUFFERS_PYTHON_IMPLEMENTATION=python python3.9 benchmarks_end_to_end.py feature_importance folktables slow_loading featurization_4 neural_network
2022-09-21 19:24:25.580530: W tensorflow/stream_executor/platform/default/dso_loader.cc:64] Could not load dynamic library 'libcudart.so.11.0'; dlerror: libcudart.so.11.0: cannot open shared object file: No such file or directory; LD_LIBRARY_PATH: /home/sgrafbe/mlwhatif/venv/lib/python3.9/site-packages/cv2/../../lib64:
2022-09-21 19:24:25.580568: I tensorflow/stream_executor/cuda/cudart_stub.cc:29] Ignore above cudart dlerror if you do not have a GPU set up on your machine.
2022-09-21 19:24:26 INFO  Patching sys.argv with ['mlwhatif', 'folktables', 'slow_loading', 'featurization_4', 'neural_network']
2022-09-21 19:24:26 INFO  Running instrumented original pipeline...
2022-09-21 19:24:26 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-21 19:24:26 INFO  ---RUNTIME: Importing and monkey-patching took 101.5937328338623 ms
2022-09-21 19:24:28.619866: W tensorflow/stream_executor/platform/default/dso_loader.cc:64] Could not load dynamic library 'libcuda.so.1'; dlerror: libcuda.so.1: cannot open shared object file: No such file or directory; LD_LIBRARY_PATH: /home/sgrafbe/mlwhatif/venv/lib/python3.9/site-packages/cv2/../../lib64:
2022-09-21 19:24:28.619904: W tensorflow/stream_executor/cuda/cuda_driver.cc:326] failed call to cuInit: UNKNOWN ERROR (303)
2022-09-21 19:24:28.619923: I tensorflow/stream_executor/cuda/cuda_diagnostics.cc:156] kernel driver does not appear to be running on this host (wagyu): /proc/driver/nvidia/version does not exist
2022-09-21 19:24:28.620291: I tensorflow/core/platform/cpu_feature_guard.cc:142] This TensorFlow binary is optimized with oneAPI Deep Neural Network Library (oneDNN) to use the following CPU instructions in performance-critical operations:  AVX2 FMA
To enable them in other operations, rebuild TensorFlow with the appropriate compiler flags.
2022-09-21 19:24:29.168595: I tensorflow/compiler/mlir/mlir_graph_optimization_pass.cc:176] None of the MLIR Optimization Passes are enabled (registered 2)
2022-09-21 19:24:29.182371: I tensorflow/core/platform/profile_utils/cpu_utils.cc:114] CPU Frequency: 2595290000 Hz
2022-09-21 19:24:32 INFO  ---RUNTIME: Original pipeline execution took 5786.494493484497 ms (excluding imports and monkey-patching)
2022-09-21 19:24:32 INFO  Starting execution of 0 what-if analyses...
2022-09-21 19:24:32 INFO  Estimated runtime of original DAG is 4422.408819198608ms
2022-09-21 19:24:32 INFO  Performing Multi-Query Optimization
2022-09-21 19:24:32 INFO  Estimated unoptimized what-if runtime is 0ms
2022-09-21 19:24:32 INFO  Estimated optimised what-if runtime is 0ms
2022-09-21 19:24:32 INFO  Estimated optimisation runtime saving is 0ms
2022-09-21 19:24:32 INFO  ---RUNTIME: Multi-Query Optimization took 0.5278587341308594 ms
2022-09-21 19:24:32 INFO  Executing generated plans
2022-09-21 19:24:32 INFO  ---RUNTIME: Execution took 0.02002716064453125 ms
2022-09-21 19:24:32 INFO  Done!
2022-09-21 19:24:32 INFO  # Optimization benchmark for feature_importance with args [['folktables', 'slow_loading', 'featurization_4', 'neural_network']] -- repetition 1 of 7
2022-09-21 19:24:32 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-21 19:24:32 INFO  Running instrumented original pipeline...
2022-09-21 19:24:32 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-21 19:24:32 INFO  ---RUNTIME: Importing and monkey-patching took 5.351781845092773 ms
2022-09-21 19:24:38 INFO  ---RUNTIME: Original pipeline execution took 5512.930393218994 ms (excluding imports and monkey-patching)
2022-09-21 19:24:38 INFO  Starting execution of 1 what-if analyses...
2022-09-21 19:24:38 INFO  Start plan generation for analysis PermutationFeatureImportance...
2022-09-21 19:24:38 INFO  ---RUNTIME: Plan generation took 0.27942657470703125 ms
2022-09-21 19:24:38 INFO  Estimated runtime of original DAG is 4173.748016357422ms
2022-09-21 19:24:38 INFO  Performing Multi-Query Optimization
2022-09-21 19:24:38 INFO  Estimated unoptimized what-if runtime is 33389.984130859375ms
2022-09-21 19:24:38 INFO  Estimated optimised what-if runtime is 5547.37663269043ms
2022-09-21 19:24:38 INFO  Estimated optimisation runtime saving is 27842.607498168945ms
2022-09-21 19:24:38 INFO  ---RUNTIME: Multi-Query Optimization took 18.566131591796875 ms
2022-09-21 19:24:38 INFO  Executing generated plans
2022-09-21 19:24:43 INFO  ---RUNTIME: Execution took 5062.276363372803 ms
2022-09-21 19:24:43 INFO  Done!
2022-09-21 19:24:43 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-21 19:24:43 INFO  Running instrumented original pipeline...
2022-09-21 19:24:43 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-21 19:24:43 INFO  ---RUNTIME: Importing and monkey-patching took 6.016731262207031 ms
2022-09-21 19:24:48 INFO  ---RUNTIME: Original pipeline execution took 5628.16047668457 ms (excluding imports and monkey-patching)
2022-09-21 19:24:48 INFO  Starting execution of 1 what-if analyses...
2022-09-21 19:24:48 INFO  Start plan generation for analysis PermutationFeatureImportance...
2022-09-21 19:24:48 INFO  ---RUNTIME: Plan generation took 0.14543533325195312 ms
2022-09-21 19:24:48 INFO  Estimated runtime of original DAG is 4301.490306854248ms
2022-09-21 19:24:48 WARNING Skipping Multi-Query Optimization (instead, only applying patches)
2022-09-21 19:24:48 INFO  Estimated unoptimised what-if runtime is 34411.922454833984ms
2022-09-21 19:24:48 INFO  ---RUNTIME: Multi-Query Optimization took 6.336688995361328 ms
2022-09-21 19:24:48 INFO  Executing generated plans
2022-09-21 19:25:23 INFO  ---RUNTIME: Execution took 34100.55160522461 ms
2022-09-21 19:25:23 INFO  Done!
2022-09-21 19:25:23 INFO  # Finished -- repetition 1 of 7 
2022-09-21 19:25:23 INFO  # Optimization benchmark for feature_importance with args [['folktables', 'slow_loading', 'featurization_4', 'neural_network']] -- repetition 2 of 7
2022-09-21 19:25:23 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-21 19:25:23 INFO  Running instrumented original pipeline...
2022-09-21 19:25:23 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-21 19:25:23 INFO  ---RUNTIME: Importing and monkey-patching took 6.184577941894531 ms
2022-09-21 19:25:28 INFO  ---RUNTIME: Original pipeline execution took 5625.038623809814 ms (excluding imports and monkey-patching)
2022-09-21 19:25:28 INFO  Starting execution of 1 what-if analyses...
2022-09-21 19:25:28 INFO  Start plan generation for analysis PermutationFeatureImportance...
2022-09-21 19:25:28 INFO  ---RUNTIME: Plan generation took 0.17690658569335938 ms
2022-09-21 19:25:28 INFO  Estimated runtime of original DAG is 4253.443002700806ms
2022-09-21 19:25:28 INFO  Performing Multi-Query Optimization
2022-09-21 19:25:28 INFO  Estimated unoptimized what-if runtime is 34027.544021606445ms
2022-09-21 19:25:28 INFO  Estimated optimised what-if runtime is 5571.758270263672ms
2022-09-21 19:25:28 INFO  Estimated optimisation runtime saving is 28455.785751342773ms
2022-09-21 19:25:28 INFO  ---RUNTIME: Multi-Query Optimization took 18.691301345825195 ms
2022-09-21 19:25:28 INFO  Executing generated plans
2022-09-21 19:25:34 INFO  ---RUNTIME: Execution took 5499.4940757751465 ms
2022-09-21 19:25:34 INFO  Done!
2022-09-21 19:25:34 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-21 19:25:34 INFO  Running instrumented original pipeline...
2022-09-21 19:25:34 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-21 19:25:34 INFO  ---RUNTIME: Importing and monkey-patching took 5.917549133300781 ms
2022-09-21 19:25:39 INFO  ---RUNTIME: Original pipeline execution took 5365.760326385498 ms (excluding imports and monkey-patching)
2022-09-21 19:25:39 INFO  Starting execution of 1 what-if analyses...
2022-09-21 19:25:39 INFO  Start plan generation for analysis PermutationFeatureImportance...
2022-09-21 19:25:39 INFO  ---RUNTIME: Plan generation took 0.13256072998046875 ms
2022-09-21 19:25:39 INFO  Estimated runtime of original DAG is 4038.416624069214ms
2022-09-21 19:25:39 WARNING Skipping Multi-Query Optimization (instead, only applying patches)
2022-09-21 19:25:39 INFO  Estimated unoptimised what-if runtime is 32307.33299255371ms
2022-09-21 19:25:39 INFO  ---RUNTIME: Multi-Query Optimization took 6.335973739624023 ms
2022-09-21 19:25:39 INFO  Executing generated plans
2022-09-21 19:26:13 INFO  ---RUNTIME: Execution took 34198.88138771057 ms
2022-09-21 19:26:13 INFO  Done!
2022-09-21 19:26:13 INFO  # Finished -- repetition 2 of 7 
2022-09-21 19:26:13 INFO  # Optimization benchmark for feature_importance with args [['folktables', 'slow_loading', 'featurization_4', 'neural_network']] -- repetition 3 of 7
2022-09-21 19:26:13 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-21 19:26:13 INFO  Running instrumented original pipeline...
2022-09-21 19:26:13 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-21 19:26:13 INFO  ---RUNTIME: Importing and monkey-patching took 5.909204483032227 ms
2022-09-21 19:26:19 INFO  ---RUNTIME: Original pipeline execution took 5381.748914718628 ms (excluding imports and monkey-patching)
2022-09-21 19:26:19 INFO  Starting execution of 1 what-if analyses...
2022-09-21 19:26:19 INFO  Start plan generation for analysis PermutationFeatureImportance...
2022-09-21 19:26:19 INFO  ---RUNTIME: Plan generation took 0.17070770263671875 ms
2022-09-21 19:26:19 INFO  Estimated runtime of original DAG is 4071.8321800231934ms
2022-09-21 19:26:19 INFO  Performing Multi-Query Optimization
2022-09-21 19:26:19 INFO  Estimated unoptimized what-if runtime is 32574.657440185547ms
2022-09-21 19:26:19 INFO  Estimated optimised what-if runtime is 5344.54607963562ms
2022-09-21 19:26:19 INFO  Estimated optimisation runtime saving is 27230.111360549927ms
2022-09-21 19:26:19 INFO  ---RUNTIME: Multi-Query Optimization took 19.823789596557617 ms
2022-09-21 19:26:19 INFO  Executing generated plans
2022-09-21 19:26:24 INFO  ---RUNTIME: Execution took 5430.535078048706 ms
2022-09-21 19:26:24 INFO  Done!
2022-09-21 19:26:24 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-21 19:26:24 INFO  Running instrumented original pipeline...
2022-09-21 19:26:24 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-21 19:26:24 INFO  ---RUNTIME: Importing and monkey-patching took 5.814552307128906 ms
2022-09-21 19:26:30 INFO  ---RUNTIME: Original pipeline execution took 5381.897211074829 ms (excluding imports and monkey-patching)
2022-09-21 19:26:30 INFO  Starting execution of 1 what-if analyses...
2022-09-21 19:26:30 INFO  Start plan generation for analysis PermutationFeatureImportance...
2022-09-21 19:26:30 INFO  ---RUNTIME: Plan generation took 0.125885009765625 ms
2022-09-21 19:26:30 INFO  Estimated runtime of original DAG is 4046.173572540283ms
2022-09-21 19:26:30 WARNING Skipping Multi-Query Optimization (instead, only applying patches)
2022-09-21 19:26:30 INFO  Estimated unoptimised what-if runtime is 32369.388580322266ms
2022-09-21 19:26:30 INFO  ---RUNTIME: Multi-Query Optimization took 6.397724151611328 ms
2022-09-21 19:26:30 INFO  Executing generated plans
2022-09-21 19:27:04 INFO  ---RUNTIME: Execution took 34128.91936302185 ms
2022-09-21 19:27:04 INFO  Done!
2022-09-21 19:27:04 INFO  # Finished -- repetition 3 of 7 
2022-09-21 19:27:04 INFO  # Optimization benchmark for feature_importance with args [['folktables', 'slow_loading', 'featurization_4', 'neural_network']] -- repetition 4 of 7
2022-09-21 19:27:04 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-21 19:27:04 INFO  Running instrumented original pipeline...
2022-09-21 19:27:04 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-21 19:27:04 INFO  ---RUNTIME: Importing and monkey-patching took 6.642580032348633 ms
2022-09-21 19:27:09 INFO  ---RUNTIME: Original pipeline execution took 5365.662336349487 ms (excluding imports and monkey-patching)
2022-09-21 19:27:09 INFO  Starting execution of 1 what-if analyses...
2022-09-21 19:27:09 INFO  Start plan generation for analysis PermutationFeatureImportance...
2022-09-21 19:27:09 INFO  ---RUNTIME: Plan generation took 0.20170211791992188 ms
2022-09-21 19:27:09 INFO  Estimated runtime of original DAG is 4053.813934326172ms
2022-09-21 19:27:09 INFO  Performing Multi-Query Optimization
2022-09-21 19:27:09 INFO  Estimated unoptimized what-if runtime is 32430.511474609375ms
2022-09-21 19:27:09 INFO  Estimated optimised what-if runtime is 5343.771934509277ms
2022-09-21 19:27:09 INFO  Estimated optimisation runtime saving is 27086.739540100098ms
2022-09-21 19:27:09 INFO  ---RUNTIME: Multi-Query Optimization took 23.061752319335938 ms
2022-09-21 19:27:09 INFO  Executing generated plans
2022-09-21 19:27:14 INFO  ---RUNTIME: Execution took 5383.258581161499 ms
2022-09-21 19:27:14 INFO  Done!
2022-09-21 19:27:14 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-21 19:27:14 INFO  Running instrumented original pipeline...
2022-09-21 19:27:15 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-21 19:27:15 INFO  ---RUNTIME: Importing and monkey-patching took 6.301641464233398 ms
2022-09-21 19:27:20 INFO  ---RUNTIME: Original pipeline execution took 5251.477241516113 ms (excluding imports and monkey-patching)
2022-09-21 19:27:20 INFO  Starting execution of 1 what-if analyses...
2022-09-21 19:27:20 INFO  Start plan generation for analysis PermutationFeatureImportance...
2022-09-21 19:27:20 INFO  ---RUNTIME: Plan generation took 0.13875961303710938 ms
2022-09-21 19:27:20 INFO  Estimated runtime of original DAG is 3913.189649581909ms
2022-09-21 19:27:20 WARNING Skipping Multi-Query Optimization (instead, only applying patches)
2022-09-21 19:27:20 INFO  Estimated unoptimised what-if runtime is 31305.517196655273ms
2022-09-21 19:27:20 INFO  ---RUNTIME: Multi-Query Optimization took 6.209611892700195 ms
2022-09-21 19:27:20 INFO  Executing generated plans
2022-09-21 19:27:54 INFO  ---RUNTIME: Execution took 33925.75168609619 ms
2022-09-21 19:27:54 INFO  Done!
2022-09-21 19:27:54 INFO  # Finished -- repetition 4 of 7 
2022-09-21 19:27:54 INFO  # Optimization benchmark for feature_importance with args [['folktables', 'slow_loading', 'featurization_4', 'neural_network']] -- repetition 5 of 7
2022-09-21 19:27:54 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-21 19:27:54 INFO  Running instrumented original pipeline...
2022-09-21 19:27:54 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-21 19:27:54 INFO  ---RUNTIME: Importing and monkey-patching took 6.106376647949219 ms
2022-09-21 19:27:59 INFO  ---RUNTIME: Original pipeline execution took 5332.476615905762 ms (excluding imports and monkey-patching)
2022-09-21 19:27:59 INFO  Starting execution of 1 what-if analyses...
2022-09-21 19:27:59 INFO  Start plan generation for analysis PermutationFeatureImportance...
2022-09-21 19:27:59 INFO  ---RUNTIME: Plan generation took 0.14162063598632812 ms
2022-09-21 19:27:59 INFO  Estimated runtime of original DAG is 3856.4884662628174ms
2022-09-21 19:27:59 INFO  Performing Multi-Query Optimization
2022-09-21 19:27:59 INFO  Estimated unoptimized what-if runtime is 30851.90773010254ms
2022-09-21 19:27:59 INFO  Estimated optimised what-if runtime is 4985.426902770996ms
2022-09-21 19:27:59 INFO  Estimated optimisation runtime saving is 25866.480827331543ms
2022-09-21 19:27:59 INFO  ---RUNTIME: Multi-Query Optimization took 18.433332443237305 ms
2022-09-21 19:27:59 INFO  Executing generated plans
2022-09-21 19:28:04 INFO  ---RUNTIME: Execution took 5238.158702850342 ms
2022-09-21 19:28:04 INFO  Done!
2022-09-21 19:28:04 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-21 19:28:04 INFO  Running instrumented original pipeline...
2022-09-21 19:28:04 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-21 19:28:04 INFO  ---RUNTIME: Importing and monkey-patching took 5.600452423095703 ms
2022-09-21 19:28:10 INFO  ---RUNTIME: Original pipeline execution took 5862.257242202759 ms (excluding imports and monkey-patching)
2022-09-21 19:28:10 INFO  Starting execution of 1 what-if analyses...
2022-09-21 19:28:10 INFO  Start plan generation for analysis PermutationFeatureImportance...
2022-09-21 19:28:10 INFO  ---RUNTIME: Plan generation took 0.19979476928710938 ms
2022-09-21 19:28:10 INFO  Estimated runtime of original DAG is 4493.657827377319ms
2022-09-21 19:28:10 WARNING Skipping Multi-Query Optimization (instead, only applying patches)
2022-09-21 19:28:10 INFO  Estimated unoptimised what-if runtime is 35949.262619018555ms
2022-09-21 19:28:10 INFO  ---RUNTIME: Multi-Query Optimization took 9.295225143432617 ms
2022-09-21 19:28:10 INFO  Executing generated plans
2022-09-21 19:28:46 INFO  ---RUNTIME: Execution took 35451.10082626343 ms
2022-09-21 19:28:46 INFO  Done!
2022-09-21 19:28:46 INFO  # Finished -- repetition 5 of 7 
2022-09-21 19:28:46 INFO  # Optimization benchmark for feature_importance with args [['folktables', 'slow_loading', 'featurization_4', 'neural_network']] -- repetition 6 of 7
2022-09-21 19:28:46 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-21 19:28:46 INFO  Running instrumented original pipeline...
2022-09-21 19:28:46 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-21 19:28:46 INFO  ---RUNTIME: Importing and monkey-patching took 7.751703262329102 ms
2022-09-21 19:28:51 INFO  ---RUNTIME: Original pipeline execution took 5865.62180519104 ms (excluding imports and monkey-patching)
2022-09-21 19:28:51 INFO  Starting execution of 1 what-if analyses...
2022-09-21 19:28:51 INFO  Start plan generation for analysis PermutationFeatureImportance...
2022-09-21 19:28:51 INFO  ---RUNTIME: Plan generation took 0.14781951904296875 ms
2022-09-21 19:28:51 INFO  Estimated runtime of original DAG is 4178.393125534058ms
2022-09-21 19:28:51 INFO  Performing Multi-Query Optimization
2022-09-21 19:28:52 INFO  Estimated unoptimized what-if runtime is 33427.14500427246ms
2022-09-21 19:28:52 INFO  Estimated optimised what-if runtime is 5499.369859695435ms
2022-09-21 19:28:52 INFO  Estimated optimisation runtime saving is 27927.775144577026ms
2022-09-21 19:28:52 INFO  ---RUNTIME: Multi-Query Optimization took 18.332242965698242 ms
2022-09-21 19:28:52 INFO  Executing generated plans
2022-09-21 19:28:57 INFO  ---RUNTIME: Execution took 5424.483060836792 ms
2022-09-21 19:28:57 INFO  Done!
2022-09-21 19:28:57 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-21 19:28:57 INFO  Running instrumented original pipeline...
2022-09-21 19:28:57 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-21 19:28:57 INFO  ---RUNTIME: Importing and monkey-patching took 6.50787353515625 ms
2022-09-21 19:29:03 INFO  ---RUNTIME: Original pipeline execution took 5761.741399765015 ms (excluding imports and monkey-patching)
2022-09-21 19:29:03 INFO  Starting execution of 1 what-if analyses...
2022-09-21 19:29:03 INFO  Start plan generation for analysis PermutationFeatureImportance...
2022-09-21 19:29:03 INFO  ---RUNTIME: Plan generation took 0.1361370086669922 ms
2022-09-21 19:29:03 INFO  Estimated runtime of original DAG is 4213.290691375732ms
2022-09-21 19:29:03 WARNING Skipping Multi-Query Optimization (instead, only applying patches)
2022-09-21 19:29:03 INFO  Estimated unoptimised what-if runtime is 33706.32553100586ms
2022-09-21 19:29:03 INFO  ---RUNTIME: Multi-Query Optimization took 442.7816867828369 ms
2022-09-21 19:29:03 INFO  Executing generated plans
2022-09-21 19:29:41 INFO  ---RUNTIME: Execution took 37579.1449546814 ms
2022-09-21 19:29:41 INFO  Done!
2022-09-21 19:29:41 INFO  # Finished -- repetition 6 of 7 
2022-09-21 19:29:41 INFO  # Optimization benchmark for feature_importance with args [['folktables', 'slow_loading', 'featurization_4', 'neural_network']] -- repetition 7 of 7
2022-09-21 19:29:41 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-21 19:29:41 INFO  Running instrumented original pipeline...
2022-09-21 19:29:41 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-21 19:29:41 INFO  ---RUNTIME: Importing and monkey-patching took 5.827665328979492 ms
2022-09-21 19:29:47 INFO  ---RUNTIME: Original pipeline execution took 5883.115768432617 ms (excluding imports and monkey-patching)
2022-09-21 19:29:47 INFO  Starting execution of 1 what-if analyses...
2022-09-21 19:29:47 INFO  Start plan generation for analysis PermutationFeatureImportance...
2022-09-21 19:29:47 INFO  ---RUNTIME: Plan generation took 0.17213821411132812 ms
2022-09-21 19:29:47 INFO  Estimated runtime of original DAG is 4461.154937744141ms
2022-09-21 19:29:47 INFO  Performing Multi-Query Optimization
2022-09-21 19:29:47 INFO  Estimated unoptimized what-if runtime is 35689.239501953125ms
2022-09-21 19:29:47 INFO  Estimated optimised what-if runtime is 5868.9117431640625ms
2022-09-21 19:29:47 INFO  Estimated optimisation runtime saving is 29820.327758789062ms
2022-09-21 19:29:47 INFO  ---RUNTIME: Multi-Query Optimization took 23.767948150634766 ms
2022-09-21 19:29:47 INFO  Executing generated plans
2022-09-21 19:29:52 INFO  ---RUNTIME: Execution took 5289.481163024902 ms
2022-09-21 19:29:52 INFO  Done!
2022-09-21 19:29:52 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-21 19:29:52 INFO  Running instrumented original pipeline...
2022-09-21 19:29:52 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-21 19:29:52 INFO  ---RUNTIME: Importing and monkey-patching took 5.748510360717773 ms
2022-09-21 19:29:58 INFO  ---RUNTIME: Original pipeline execution took 6025.1500606536865 ms (excluding imports and monkey-patching)
2022-09-21 19:29:58 INFO  Starting execution of 1 what-if analyses...
2022-09-21 19:29:58 INFO  Start plan generation for analysis PermutationFeatureImportance...
2022-09-21 19:29:58 INFO  ---RUNTIME: Plan generation took 0.13184547424316406 ms
2022-09-21 19:29:58 INFO  Estimated runtime of original DAG is 4430.157661437988ms
2022-09-21 19:29:58 WARNING Skipping Multi-Query Optimization (instead, only applying patches)
2022-09-21 19:29:58 INFO  Estimated unoptimised what-if runtime is 35441.261291503906ms
2022-09-21 19:29:58 INFO  ---RUNTIME: Multi-Query Optimization took 6.687402725219727 ms
2022-09-21 19:29:58 INFO  Executing generated plans
2022-09-21 19:30:34 INFO  ---RUNTIME: Execution took 35830.73925971985 ms
2022-09-21 19:30:34 INFO  Done!
2022-09-21 19:30:34 INFO  # Finished -- repetition 7 of 7 
2022-09-21 19:30:34 INFO  # Final results after all repetitions
2022-09-21 19:30:34 INFO     repetition  ... no_opt_what_if_execution_combined_model_training
0           0  ...                                     29599.452257
1           1  ...                                     29325.082779
2           2  ...                                     29764.049292
3           3  ...                                     29308.481216
4           4  ...                                     30526.380301
5           5  ...                                     32435.024977
6           6  ...                                     31158.457994

[7 rows x 26 columns]
taskset -c 64-71 PROTOCOL_BUFFERS_PYTHON_IMPLEMENTATION=python python3.9 benchmarks_end_to_end.py data_corruption folktables slow_loading featurization_0 logistic_regression
2022-09-21 19:30:36.808329: W tensorflow/stream_executor/platform/default/dso_loader.cc:64] Could not load dynamic library 'libcudart.so.11.0'; dlerror: libcudart.so.11.0: cannot open shared object file: No such file or directory; LD_LIBRARY_PATH: /home/sgrafbe/mlwhatif/venv/lib/python3.9/site-packages/cv2/../../lib64:
2022-09-21 19:30:36.808367: I tensorflow/stream_executor/cuda/cudart_stub.cc:29] Ignore above cudart dlerror if you do not have a GPU set up on your machine.
2022-09-21 19:30:38 INFO  Patching sys.argv with ['mlwhatif', 'folktables', 'slow_loading', 'featurization_0', 'logistic_regression']
2022-09-21 19:30:38 INFO  Running instrumented original pipeline...
2022-09-21 19:30:38 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-21 19:30:38 INFO  ---RUNTIME: Importing and monkey-patching took 95.18146514892578 ms
2022-09-21 19:30:39 INFO  ---RUNTIME: Original pipeline execution took 1757.606029510498 ms (excluding imports and monkey-patching)
2022-09-21 19:30:39 INFO  Starting execution of 0 what-if analyses...
2022-09-21 19:30:39 INFO  Estimated runtime of original DAG is 1331.0225009918213ms
2022-09-21 19:30:39 INFO  Performing Multi-Query Optimization
2022-09-21 19:30:39 INFO  Estimated unoptimized what-if runtime is 0ms
2022-09-21 19:30:39 INFO  Estimated optimised what-if runtime is 0ms
2022-09-21 19:30:39 INFO  Estimated optimisation runtime saving is 0ms
2022-09-21 19:30:39 INFO  ---RUNTIME: Multi-Query Optimization took 0.5023479461669922 ms
2022-09-21 19:30:39 INFO  Executing generated plans
2022-09-21 19:30:39 INFO  ---RUNTIME: Execution took 0.018596649169921875 ms
2022-09-21 19:30:39 INFO  Done!
2022-09-21 19:30:39 INFO  # Optimization benchmark for data_corruption with args [['folktables', 'slow_loading', 'featurization_0', 'logistic_regression']] -- repetition 1 of 7
2022-09-21 19:30:39 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-21 19:30:39 INFO  Running instrumented original pipeline...
2022-09-21 19:30:39 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-21 19:30:39 INFO  ---RUNTIME: Importing and monkey-patching took 5.993127822875977 ms
2022-09-21 19:30:41 INFO  ---RUNTIME: Original pipeline execution took 1847.6831912994385 ms (excluding imports and monkey-patching)
2022-09-21 19:30:41 INFO  Starting execution of 1 what-if analyses...
2022-09-21 19:30:41 INFO  Start plan generation for analysis DataCorruption...
2022-09-21 19:30:41 INFO  ---RUNTIME: Plan generation took 0.4620552062988281 ms
2022-09-21 19:30:41 INFO  Estimated runtime of original DAG is 1431.80251121521ms
2022-09-21 19:30:41 INFO  Performing Multi-Query Optimization
2022-09-21 19:30:41 INFO  Estimated unoptimized what-if runtime is 45817.68035888672ms
2022-09-21 19:30:41 INFO  Estimated optimised what-if runtime is 1948.2321739196777ms
2022-09-21 19:30:41 INFO  Estimated optimisation runtime saving is 43869.44818496704ms
2022-09-21 19:30:41 INFO  ---RUNTIME: Multi-Query Optimization took 79.74410057067871 ms
2022-09-21 19:30:41 INFO  Executing generated plans
2022-09-21 19:30:44 INFO  ---RUNTIME: Execution took 2743.299961090088 ms
2022-09-21 19:30:44 INFO  Done!
2022-09-21 19:30:44 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-21 19:30:44 INFO  Running instrumented original pipeline...
2022-09-21 19:30:44 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-21 19:30:44 INFO  ---RUNTIME: Importing and monkey-patching took 6.182193756103516 ms
2022-09-21 19:30:46 INFO  ---RUNTIME: Original pipeline execution took 1942.681074142456 ms (excluding imports and monkey-patching)
2022-09-21 19:30:46 INFO  Starting execution of 1 what-if analyses...
2022-09-21 19:30:46 INFO  Start plan generation for analysis DataCorruption...
2022-09-21 19:30:46 INFO  ---RUNTIME: Plan generation took 1.2409687042236328 ms
2022-09-21 19:30:46 INFO  Estimated runtime of original DAG is 1371.3757991790771ms
2022-09-21 19:30:46 WARNING Skipping Multi-Query Optimization (instead, only applying patches)
2022-09-21 19:30:46 INFO  Estimated unoptimised what-if runtime is 43884.02557373047ms
2022-09-21 19:30:46 INFO  ---RUNTIME: Multi-Query Optimization took 20.841598510742188 ms
2022-09-21 19:30:46 INFO  Executing generated plans
2022-09-21 19:31:35 INFO  ---RUNTIME: Execution took 48882.0526599884 ms
2022-09-21 19:31:35 INFO  Done!
2022-09-21 19:31:35 INFO  # Finished -- repetition 1 of 7 
2022-09-21 19:31:35 INFO  # Optimization benchmark for data_corruption with args [['folktables', 'slow_loading', 'featurization_0', 'logistic_regression']] -- repetition 2 of 7
2022-09-21 19:31:35 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-21 19:31:35 INFO  Running instrumented original pipeline...
2022-09-21 19:31:35 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-21 19:31:35 INFO  ---RUNTIME: Importing and monkey-patching took 5.953073501586914 ms
2022-09-21 19:31:37 INFO  ---RUNTIME: Original pipeline execution took 1770.2724933624268 ms (excluding imports and monkey-patching)
2022-09-21 19:31:37 INFO  Starting execution of 1 what-if analyses...
2022-09-21 19:31:37 INFO  Start plan generation for analysis DataCorruption...
2022-09-21 19:31:37 INFO  ---RUNTIME: Plan generation took 0.4818439483642578 ms
2022-09-21 19:31:37 INFO  Estimated runtime of original DAG is 1369.1670894622803ms
2022-09-21 19:31:37 INFO  Performing Multi-Query Optimization
2022-09-21 19:31:37 INFO  Estimated unoptimized what-if runtime is 43813.34686279297ms
2022-09-21 19:31:37 INFO  Estimated optimised what-if runtime is 1881.7009925842285ms
2022-09-21 19:31:37 INFO  Estimated optimisation runtime saving is 41931.64587020874ms
2022-09-21 19:31:37 INFO  ---RUNTIME: Multi-Query Optimization took 105.14998435974121 ms
2022-09-21 19:31:37 INFO  Executing generated plans
2022-09-21 19:31:40 INFO  ---RUNTIME: Execution took 2732.7253818511963 ms
2022-09-21 19:31:40 INFO  Done!
2022-09-21 19:31:40 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-21 19:31:40 INFO  Running instrumented original pipeline...
2022-09-21 19:31:40 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-21 19:31:40 INFO  ---RUNTIME: Importing and monkey-patching took 6.133317947387695 ms
2022-09-21 19:31:41 INFO  ---RUNTIME: Original pipeline execution took 1802.9415607452393 ms (excluding imports and monkey-patching)
2022-09-21 19:31:41 INFO  Starting execution of 1 what-if analyses...
2022-09-21 19:31:41 INFO  Start plan generation for analysis DataCorruption...
2022-09-21 19:31:41 INFO  ---RUNTIME: Plan generation took 0.4470348358154297 ms
2022-09-21 19:31:41 INFO  Estimated runtime of original DAG is 1371.4609146118164ms
2022-09-21 19:31:41 WARNING Skipping Multi-Query Optimization (instead, only applying patches)
2022-09-21 19:31:41 INFO  Estimated unoptimised what-if runtime is 43886.749267578125ms
2022-09-21 19:31:41 INFO  ---RUNTIME: Multi-Query Optimization took 18.7985897064209 ms
2022-09-21 19:31:41 INFO  Executing generated plans
2022-09-21 19:32:30 INFO  ---RUNTIME: Execution took 48896.37303352356 ms
2022-09-21 19:32:30 INFO  Done!
2022-09-21 19:32:30 INFO  # Finished -- repetition 2 of 7 
2022-09-21 19:32:30 INFO  # Optimization benchmark for data_corruption with args [['folktables', 'slow_loading', 'featurization_0', 'logistic_regression']] -- repetition 3 of 7
2022-09-21 19:32:30 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-21 19:32:30 INFO  Running instrumented original pipeline...
2022-09-21 19:32:30 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-21 19:32:30 INFO  ---RUNTIME: Importing and monkey-patching took 5.917787551879883 ms
2022-09-21 19:32:32 INFO  ---RUNTIME: Original pipeline execution took 1752.6006698608398 ms (excluding imports and monkey-patching)
2022-09-21 19:32:32 INFO  Starting execution of 1 what-if analyses...
2022-09-21 19:32:32 INFO  Start plan generation for analysis DataCorruption...
2022-09-21 19:32:32 INFO  ---RUNTIME: Plan generation took 0.4818439483642578 ms
2022-09-21 19:32:32 INFO  Estimated runtime of original DAG is 1360.825777053833ms
2022-09-21 19:32:32 INFO  Performing Multi-Query Optimization
2022-09-21 19:32:32 INFO  Estimated unoptimized what-if runtime is 43546.424865722656ms
2022-09-21 19:32:32 INFO  Estimated optimised what-if runtime is 1908.043384552002ms
2022-09-21 19:32:32 INFO  Estimated optimisation runtime saving is 41638.381481170654ms
2022-09-21 19:32:32 INFO  ---RUNTIME: Multi-Query Optimization took 96.81129455566406 ms
2022-09-21 19:32:32 INFO  Executing generated plans
2022-09-21 19:32:35 INFO  ---RUNTIME: Execution took 2615.262269973755 ms
2022-09-21 19:32:35 INFO  Done!
2022-09-21 19:32:35 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-21 19:32:35 INFO  Running instrumented original pipeline...
2022-09-21 19:32:35 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-21 19:32:35 INFO  ---RUNTIME: Importing and monkey-patching took 5.892515182495117 ms
2022-09-21 19:32:37 INFO  ---RUNTIME: Original pipeline execution took 1956.624984741211 ms (excluding imports and monkey-patching)
2022-09-21 19:32:37 INFO  Starting execution of 1 what-if analyses...
2022-09-21 19:32:37 INFO  Start plan generation for analysis DataCorruption...
2022-09-21 19:32:37 INFO  ---RUNTIME: Plan generation took 0.4439353942871094 ms
2022-09-21 19:32:37 INFO  Estimated runtime of original DAG is 1565.5138492584229ms
2022-09-21 19:32:37 WARNING Skipping Multi-Query Optimization (instead, only applying patches)
2022-09-21 19:32:37 INFO  Estimated unoptimised what-if runtime is 50096.44317626953ms
2022-09-21 19:32:37 INFO  ---RUNTIME: Multi-Query Optimization took 18.213272094726562 ms
2022-09-21 19:32:37 INFO  Executing generated plans
2022-09-21 19:33:27 INFO  ---RUNTIME: Execution took 49824.451208114624 ms
2022-09-21 19:33:27 INFO  Done!
2022-09-21 19:33:27 INFO  # Finished -- repetition 3 of 7 
2022-09-21 19:33:27 INFO  # Optimization benchmark for data_corruption with args [['folktables', 'slow_loading', 'featurization_0', 'logistic_regression']] -- repetition 4 of 7
2022-09-21 19:33:27 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-21 19:33:27 INFO  Running instrumented original pipeline...
2022-09-21 19:33:27 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-21 19:33:27 INFO  ---RUNTIME: Importing and monkey-patching took 5.868434906005859 ms
2022-09-21 19:33:28 INFO  ---RUNTIME: Original pipeline execution took 1772.4847793579102 ms (excluding imports and monkey-patching)
2022-09-21 19:33:28 INFO  Starting execution of 1 what-if analyses...
2022-09-21 19:33:28 INFO  Start plan generation for analysis DataCorruption...
2022-09-21 19:33:28 INFO  ---RUNTIME: Plan generation took 0.4801750183105469 ms
2022-09-21 19:33:28 INFO  Estimated runtime of original DAG is 1359.4896793365479ms
2022-09-21 19:33:28 INFO  Performing Multi-Query Optimization
2022-09-21 19:33:28 INFO  Estimated unoptimized what-if runtime is 43503.66973876953ms
2022-09-21 19:33:28 INFO  Estimated optimised what-if runtime is 1932.7716827392578ms
2022-09-21 19:33:28 INFO  Estimated optimisation runtime saving is 41570.89805603027ms
2022-09-21 19:33:28 INFO  ---RUNTIME: Multi-Query Optimization took 83.62460136413574 ms
2022-09-21 19:33:28 INFO  Executing generated plans
2022-09-21 19:33:31 INFO  ---RUNTIME: Execution took 2632.890462875366 ms
2022-09-21 19:33:31 INFO  Done!
2022-09-21 19:33:31 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-21 19:33:31 INFO  Running instrumented original pipeline...
2022-09-21 19:33:31 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-21 19:33:31 INFO  ---RUNTIME: Importing and monkey-patching took 6.369829177856445 ms
2022-09-21 19:33:33 INFO  ---RUNTIME: Original pipeline execution took 1774.4643688201904 ms (excluding imports and monkey-patching)
2022-09-21 19:33:33 INFO  Starting execution of 1 what-if analyses...
2022-09-21 19:33:33 INFO  Start plan generation for analysis DataCorruption...
2022-09-21 19:33:33 INFO  ---RUNTIME: Plan generation took 0.4906654357910156 ms
2022-09-21 19:33:33 INFO  Estimated runtime of original DAG is 1365.3342723846436ms
2022-09-21 19:33:33 WARNING Skipping Multi-Query Optimization (instead, only applying patches)
2022-09-21 19:33:33 INFO  Estimated unoptimised what-if runtime is 43690.696716308594ms
2022-09-21 19:33:33 INFO  ---RUNTIME: Multi-Query Optimization took 18.645763397216797 ms
2022-09-21 19:33:33 INFO  Executing generated plans
2022-09-21 19:34:22 INFO  ---RUNTIME: Execution took 49564.31436538696 ms
2022-09-21 19:34:22 INFO  Done!
2022-09-21 19:34:22 INFO  # Finished -- repetition 4 of 7 
2022-09-21 19:34:22 INFO  # Optimization benchmark for data_corruption with args [['folktables', 'slow_loading', 'featurization_0', 'logistic_regression']] -- repetition 5 of 7
2022-09-21 19:34:22 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-21 19:34:22 INFO  Running instrumented original pipeline...
2022-09-21 19:34:22 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-21 19:34:23 INFO  ---RUNTIME: Importing and monkey-patching took 6.0272216796875 ms
2022-09-21 19:34:24 INFO  ---RUNTIME: Original pipeline execution took 1766.0167217254639 ms (excluding imports and monkey-patching)
2022-09-21 19:34:24 INFO  Starting execution of 1 what-if analyses...
2022-09-21 19:34:24 INFO  Start plan generation for analysis DataCorruption...
2022-09-21 19:34:24 INFO  ---RUNTIME: Plan generation took 0.4558563232421875 ms
2022-09-21 19:34:24 INFO  Estimated runtime of original DAG is 1364.2668724060059ms
2022-09-21 19:34:24 INFO  Performing Multi-Query Optimization
2022-09-21 19:34:24 INFO  Estimated unoptimized what-if runtime is 43656.53991699219ms
2022-09-21 19:34:24 INFO  Estimated optimised what-if runtime is 1894.7679996490479ms
2022-09-21 19:34:24 INFO  Estimated optimisation runtime saving is 41761.77191734314ms
2022-09-21 19:34:24 INFO  ---RUNTIME: Multi-Query Optimization took 79.47158813476562 ms
2022-09-21 19:34:24 INFO  Executing generated plans
2022-09-21 19:34:27 INFO  ---RUNTIME: Execution took 2638.917922973633 ms
2022-09-21 19:34:27 INFO  Done!
2022-09-21 19:34:27 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-21 19:34:27 INFO  Running instrumented original pipeline...
2022-09-21 19:34:27 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-21 19:34:27 INFO  ---RUNTIME: Importing and monkey-patching took 6.052970886230469 ms
2022-09-21 19:34:29 INFO  ---RUNTIME: Original pipeline execution took 1814.2797946929932 ms (excluding imports and monkey-patching)
2022-09-21 19:34:29 INFO  Starting execution of 1 what-if analyses...
2022-09-21 19:34:29 INFO  Start plan generation for analysis DataCorruption...
2022-09-21 19:34:29 INFO  ---RUNTIME: Plan generation took 0.5176067352294922 ms
2022-09-21 19:34:29 INFO  Estimated runtime of original DAG is 1391.3311958312988ms
2022-09-21 19:34:29 WARNING Skipping Multi-Query Optimization (instead, only applying patches)
2022-09-21 19:34:29 INFO  Estimated unoptimised what-if runtime is 44522.59826660156ms
2022-09-21 19:34:29 INFO  ---RUNTIME: Multi-Query Optimization took 20.633459091186523 ms
2022-09-21 19:34:29 INFO  Executing generated plans
2022-09-21 19:35:18 INFO  ---RUNTIME: Execution took 49275.77495574951 ms
2022-09-21 19:35:18 INFO  Done!
2022-09-21 19:35:18 INFO  # Finished -- repetition 5 of 7 
2022-09-21 19:35:18 INFO  # Optimization benchmark for data_corruption with args [['folktables', 'slow_loading', 'featurization_0', 'logistic_regression']] -- repetition 6 of 7
2022-09-21 19:35:18 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-21 19:35:18 INFO  Running instrumented original pipeline...
2022-09-21 19:35:18 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-21 19:35:18 INFO  ---RUNTIME: Importing and monkey-patching took 5.896568298339844 ms
2022-09-21 19:35:20 INFO  ---RUNTIME: Original pipeline execution took 1757.5953006744385 ms (excluding imports and monkey-patching)
2022-09-21 19:35:20 INFO  Starting execution of 1 what-if analyses...
2022-09-21 19:35:20 INFO  Start plan generation for analysis DataCorruption...
2022-09-21 19:35:20 INFO  ---RUNTIME: Plan generation took 0.5059242248535156 ms
2022-09-21 19:35:20 INFO  Estimated runtime of original DAG is 1366.9180870056152ms
2022-09-21 19:35:20 INFO  Performing Multi-Query Optimization
2022-09-21 19:35:20 INFO  Estimated unoptimized what-if runtime is 43741.37878417969ms
2022-09-21 19:35:20 INFO  Estimated optimised what-if runtime is 1928.6713600158691ms
2022-09-21 19:35:20 INFO  Estimated optimisation runtime saving is 41812.70742416382ms
2022-09-21 19:35:20 INFO  ---RUNTIME: Multi-Query Optimization took 82.61704444885254 ms
2022-09-21 19:35:20 INFO  Executing generated plans
2022-09-21 19:35:23 INFO  ---RUNTIME: Execution took 2849.7979640960693 ms
2022-09-21 19:35:23 INFO  Done!
2022-09-21 19:35:23 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-21 19:35:23 INFO  Running instrumented original pipeline...
2022-09-21 19:35:23 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-21 19:35:23 INFO  ---RUNTIME: Importing and monkey-patching took 5.550384521484375 ms
2022-09-21 19:35:25 INFO  ---RUNTIME: Original pipeline execution took 2049.868583679199 ms (excluding imports and monkey-patching)
2022-09-21 19:35:25 INFO  Starting execution of 1 what-if analyses...
2022-09-21 19:35:25 INFO  Start plan generation for analysis DataCorruption...
2022-09-21 19:35:25 INFO  ---RUNTIME: Plan generation took 0.5707740783691406 ms
2022-09-21 19:35:25 INFO  Estimated runtime of original DAG is 1425.2996444702148ms
2022-09-21 19:35:25 WARNING Skipping Multi-Query Optimization (instead, only applying patches)
2022-09-21 19:35:25 INFO  Estimated unoptimised what-if runtime is 45609.588623046875ms
2022-09-21 19:35:25 INFO  ---RUNTIME: Multi-Query Optimization took 20.200490951538086 ms
2022-09-21 19:35:25 INFO  Executing generated plans
2022-09-21 19:36:15 INFO  ---RUNTIME: Execution took 49672.640800476074 ms
2022-09-21 19:36:15 INFO  Done!
2022-09-21 19:36:15 INFO  # Finished -- repetition 6 of 7 
2022-09-21 19:36:15 INFO  # Optimization benchmark for data_corruption with args [['folktables', 'slow_loading', 'featurization_0', 'logistic_regression']] -- repetition 7 of 7
2022-09-21 19:36:15 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-21 19:36:15 INFO  Running instrumented original pipeline...
2022-09-21 19:36:15 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-21 19:36:15 INFO  ---RUNTIME: Importing and monkey-patching took 6.378650665283203 ms
2022-09-21 19:36:16 INFO  ---RUNTIME: Original pipeline execution took 1799.1094589233398 ms (excluding imports and monkey-patching)
2022-09-21 19:36:16 INFO  Starting execution of 1 what-if analyses...
2022-09-21 19:36:16 INFO  Start plan generation for analysis DataCorruption...
2022-09-21 19:36:16 INFO  ---RUNTIME: Plan generation took 0.4756450653076172 ms
2022-09-21 19:36:16 INFO  Estimated runtime of original DAG is 1392.0631408691406ms
2022-09-21 19:36:16 INFO  Performing Multi-Query Optimization
2022-09-21 19:36:16 INFO  Estimated unoptimized what-if runtime is 44546.0205078125ms
2022-09-21 19:36:16 INFO  Estimated optimised what-if runtime is 1933.5391521453857ms
2022-09-21 19:36:16 INFO  Estimated optimisation runtime saving is 42612.481355667114ms
2022-09-21 19:36:16 INFO  ---RUNTIME: Multi-Query Optimization took 82.91149139404297 ms
2022-09-21 19:36:16 INFO  Executing generated plans
2022-09-21 19:36:19 INFO  ---RUNTIME: Execution took 2565.408706665039 ms
2022-09-21 19:36:19 INFO  Done!
2022-09-21 19:36:19 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-21 19:36:19 INFO  Running instrumented original pipeline...
2022-09-21 19:36:19 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-21 19:36:19 INFO  ---RUNTIME: Importing and monkey-patching took 5.440950393676758 ms
2022-09-21 19:36:21 INFO  ---RUNTIME: Original pipeline execution took 1787.2893810272217 ms (excluding imports and monkey-patching)
2022-09-21 19:36:21 INFO  Starting execution of 1 what-if analyses...
2022-09-21 19:36:21 INFO  Start plan generation for analysis DataCorruption...
2022-09-21 19:36:21 INFO  ---RUNTIME: Plan generation took 0.44155120849609375 ms
2022-09-21 19:36:21 INFO  Estimated runtime of original DAG is 1380.2082538604736ms
2022-09-21 19:36:21 WARNING Skipping Multi-Query Optimization (instead, only applying patches)
2022-09-21 19:36:21 INFO  Estimated unoptimised what-if runtime is 44166.664123535156ms
2022-09-21 19:36:21 INFO  ---RUNTIME: Multi-Query Optimization took 21.49224281311035 ms
2022-09-21 19:36:21 INFO  Executing generated plans
2022-09-21 19:37:11 INFO  ---RUNTIME: Execution took 49732.292890548706 ms
2022-09-21 19:37:11 INFO  Done!
2022-09-21 19:37:11 INFO  # Finished -- repetition 7 of 7 
2022-09-21 19:37:11 INFO  # Final results after all repetitions
2022-09-21 19:37:11 INFO     repetition  ... no_opt_what_if_execution_combined_model_training
0           0  ...                                     36744.994640
1           1  ...                                     36810.198545
2           2  ...                                     37232.663393
3           3  ...                                     37088.227987
4           4  ...                                     37137.086153
5           5  ...                                     37364.279509
6           6  ...                                     37300.864935

[7 rows x 26 columns]
taskset -c 64-71 PROTOCOL_BUFFERS_PYTHON_IMPLEMENTATION=python python3.9 benchmarks_end_to_end.py data_corruption folktables slow_loading featurization_0 xgboost
2022-09-21 19:37:13.310148: W tensorflow/stream_executor/platform/default/dso_loader.cc:64] Could not load dynamic library 'libcudart.so.11.0'; dlerror: libcudart.so.11.0: cannot open shared object file: No such file or directory; LD_LIBRARY_PATH: /home/sgrafbe/mlwhatif/venv/lib/python3.9/site-packages/cv2/../../lib64:
2022-09-21 19:37:13.310184: I tensorflow/stream_executor/cuda/cudart_stub.cc:29] Ignore above cudart dlerror if you do not have a GPU set up on your machine.
2022-09-21 19:37:14 INFO  Patching sys.argv with ['mlwhatif', 'folktables', 'slow_loading', 'featurization_0', 'xgboost']
2022-09-21 19:37:14 INFO  Running instrumented original pipeline...
2022-09-21 19:37:14 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-21 19:37:14 INFO  ---RUNTIME: Importing and monkey-patching took 101.99666023254395 ms
2022-09-21 19:37:16 INFO  ---RUNTIME: Original pipeline execution took 1911.5345478057861 ms (excluding imports and monkey-patching)
2022-09-21 19:37:16 INFO  Starting execution of 0 what-if analyses...
2022-09-21 19:37:16 INFO  Estimated runtime of original DAG is 1451.246738433838ms
2022-09-21 19:37:16 INFO  Performing Multi-Query Optimization
2022-09-21 19:37:16 INFO  Estimated unoptimized what-if runtime is 0ms
2022-09-21 19:37:16 INFO  Estimated optimised what-if runtime is 0ms
2022-09-21 19:37:16 INFO  Estimated optimisation runtime saving is 0ms
2022-09-21 19:37:16 INFO  ---RUNTIME: Multi-Query Optimization took 0.5240440368652344 ms
2022-09-21 19:37:16 INFO  Executing generated plans
2022-09-21 19:37:16 INFO  ---RUNTIME: Execution took 0.020265579223632812 ms
2022-09-21 19:37:16 INFO  Done!
2022-09-21 19:37:16 INFO  # Optimization benchmark for data_corruption with args [['folktables', 'slow_loading', 'featurization_0', 'xgboost']] -- repetition 1 of 7
2022-09-21 19:37:16 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-21 19:37:16 INFO  Running instrumented original pipeline...
2022-09-21 19:37:16 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-21 19:37:16 INFO  ---RUNTIME: Importing and monkey-patching took 5.93113899230957 ms
2022-09-21 19:37:18 INFO  ---RUNTIME: Original pipeline execution took 1689.9378299713135 ms (excluding imports and monkey-patching)
2022-09-21 19:37:18 INFO  Starting execution of 1 what-if analyses...
2022-09-21 19:37:18 INFO  Start plan generation for analysis DataCorruption...
2022-09-21 19:37:18 INFO  ---RUNTIME: Plan generation took 0.492095947265625 ms
2022-09-21 19:37:18 INFO  Estimated runtime of original DAG is 1279.6130180358887ms
2022-09-21 19:37:18 INFO  Performing Multi-Query Optimization
2022-09-21 19:37:18 INFO  Estimated unoptimized what-if runtime is 40947.61657714844ms
2022-09-21 19:37:18 INFO  Estimated optimised what-if runtime is 2193.0084228515625ms
2022-09-21 19:37:18 INFO  Estimated optimisation runtime saving is 38754.608154296875ms
2022-09-21 19:37:18 INFO  ---RUNTIME: Multi-Query Optimization took 81.56013488769531 ms
2022-09-21 19:37:18 INFO  Executing generated plans
2022-09-21 19:37:21 INFO  ---RUNTIME: Execution took 3034.485101699829 ms
2022-09-21 19:37:21 INFO  Done!
2022-09-21 19:37:21 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-21 19:37:21 INFO  Running instrumented original pipeline...
2022-09-21 19:37:21 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-21 19:37:21 INFO  ---RUNTIME: Importing and monkey-patching took 6.001710891723633 ms
2022-09-21 19:37:23 INFO  ---RUNTIME: Original pipeline execution took 1871.3734149932861 ms (excluding imports and monkey-patching)
2022-09-21 19:37:23 INFO  Starting execution of 1 what-if analyses...
2022-09-21 19:37:23 INFO  Start plan generation for analysis DataCorruption...
2022-09-21 19:37:23 INFO  ---RUNTIME: Plan generation took 0.476837158203125 ms
2022-09-21 19:37:23 INFO  Estimated runtime of original DAG is 1287.4383926391602ms
2022-09-21 19:37:23 WARNING Skipping Multi-Query Optimization (instead, only applying patches)
2022-09-21 19:37:23 INFO  Estimated unoptimised what-if runtime is 41198.028564453125ms
2022-09-21 19:37:23 INFO  ---RUNTIME: Multi-Query Optimization took 20.134449005126953 ms
2022-09-21 19:37:23 INFO  Executing generated plans
2022-09-21 19:38:09 INFO  ---RUNTIME: Execution took 46593.130588531494 ms
2022-09-21 19:38:09 INFO  Done!
2022-09-21 19:38:09 INFO  # Finished -- repetition 1 of 7 
2022-09-21 19:38:09 INFO  # Optimization benchmark for data_corruption with args [['folktables', 'slow_loading', 'featurization_0', 'xgboost']] -- repetition 2 of 7
2022-09-21 19:38:09 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-21 19:38:09 INFO  Running instrumented original pipeline...
2022-09-21 19:38:10 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-21 19:38:10 INFO  ---RUNTIME: Importing and monkey-patching took 6.557703018188477 ms
2022-09-21 19:38:11 INFO  ---RUNTIME: Original pipeline execution took 1795.799732208252 ms (excluding imports and monkey-patching)
2022-09-21 19:38:11 INFO  Starting execution of 1 what-if analyses...
2022-09-21 19:38:11 INFO  Start plan generation for analysis DataCorruption...
2022-09-21 19:38:11 INFO  ---RUNTIME: Plan generation took 1.2068748474121094 ms
2022-09-21 19:38:11 INFO  Estimated runtime of original DAG is 1335.7579708099365ms
2022-09-21 19:38:11 INFO  Performing Multi-Query Optimization
2022-09-21 19:38:11 INFO  Estimated unoptimized what-if runtime is 42744.25506591797ms
2022-09-21 19:38:11 INFO  Estimated optimised what-if runtime is 2221.6341495513916ms
2022-09-21 19:38:11 INFO  Estimated optimisation runtime saving is 40522.62091636658ms
2022-09-21 19:38:11 INFO  ---RUNTIME: Multi-Query Optimization took 77.79288291931152 ms
2022-09-21 19:38:11 INFO  Executing generated plans
2022-09-21 19:38:14 INFO  ---RUNTIME: Execution took 2776.019811630249 ms
2022-09-21 19:38:14 INFO  Done!
2022-09-21 19:38:14 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-21 19:38:14 INFO  Running instrumented original pipeline...
2022-09-21 19:38:14 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-21 19:38:14 INFO  ---RUNTIME: Importing and monkey-patching took 5.57255744934082 ms
2022-09-21 19:38:16 INFO  ---RUNTIME: Original pipeline execution took 1732.6741218566895 ms (excluding imports and monkey-patching)
2022-09-21 19:38:16 INFO  Starting execution of 1 what-if analyses...
2022-09-21 19:38:16 INFO  Start plan generation for analysis DataCorruption...
2022-09-21 19:38:16 INFO  ---RUNTIME: Plan generation took 0.45490264892578125 ms
2022-09-21 19:38:16 INFO  Estimated runtime of original DAG is 1341.5164947509766ms
2022-09-21 19:38:16 WARNING Skipping Multi-Query Optimization (instead, only applying patches)
2022-09-21 19:38:16 INFO  Estimated unoptimised what-if runtime is 42928.52783203125ms
2022-09-21 19:38:16 INFO  ---RUNTIME: Multi-Query Optimization took 18.703699111938477 ms
2022-09-21 19:38:16 INFO  Executing generated plans
2022-09-21 19:39:03 INFO  ---RUNTIME: Execution took 47189.69941139221 ms
2022-09-21 19:39:03 INFO  Done!
2022-09-21 19:39:03 INFO  # Finished -- repetition 2 of 7 
2022-09-21 19:39:03 INFO  # Optimization benchmark for data_corruption with args [['folktables', 'slow_loading', 'featurization_0', 'xgboost']] -- repetition 3 of 7
2022-09-21 19:39:03 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-21 19:39:03 INFO  Running instrumented original pipeline...
2022-09-21 19:39:03 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-21 19:39:03 INFO  ---RUNTIME: Importing and monkey-patching took 7.792234420776367 ms
2022-09-21 19:39:05 INFO  ---RUNTIME: Original pipeline execution took 1783.3223342895508 ms (excluding imports and monkey-patching)
2022-09-21 19:39:05 INFO  Starting execution of 1 what-if analyses...
2022-09-21 19:39:05 INFO  Start plan generation for analysis DataCorruption...
2022-09-21 19:39:05 INFO  ---RUNTIME: Plan generation took 0.469207763671875 ms
2022-09-21 19:39:05 INFO  Estimated runtime of original DAG is 1305.790901184082ms
2022-09-21 19:39:05 INFO  Performing Multi-Query Optimization
2022-09-21 19:39:05 INFO  Estimated unoptimized what-if runtime is 41785.308837890625ms
2022-09-21 19:39:05 INFO  Estimated optimised what-if runtime is 2136.221408843994ms
2022-09-21 19:39:05 INFO  Estimated optimisation runtime saving is 39649.08742904663ms
2022-09-21 19:39:05 INFO  ---RUNTIME: Multi-Query Optimization took 79.4820785522461 ms
2022-09-21 19:39:05 INFO  Executing generated plans
2022-09-21 19:39:08 INFO  ---RUNTIME: Execution took 2831.636667251587 ms
2022-09-21 19:39:08 INFO  Done!
2022-09-21 19:39:08 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-21 19:39:08 INFO  Running instrumented original pipeline...
2022-09-21 19:39:08 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-21 19:39:08 INFO  ---RUNTIME: Importing and monkey-patching took 6.3953399658203125 ms
2022-09-21 19:39:10 INFO  ---RUNTIME: Original pipeline execution took 1776.8244743347168 ms (excluding imports and monkey-patching)
2022-09-21 19:39:10 INFO  Starting execution of 1 what-if analyses...
2022-09-21 19:39:10 INFO  Start plan generation for analysis DataCorruption...
2022-09-21 19:39:10 INFO  ---RUNTIME: Plan generation took 0.46372413635253906 ms
2022-09-21 19:39:10 INFO  Estimated runtime of original DAG is 1368.8290119171143ms
2022-09-21 19:39:10 WARNING Skipping Multi-Query Optimization (instead, only applying patches)
2022-09-21 19:39:10 INFO  Estimated unoptimised what-if runtime is 43802.528381347656ms
2022-09-21 19:39:10 INFO  ---RUNTIME: Multi-Query Optimization took 18.298625946044922 ms
2022-09-21 19:39:10 INFO  Executing generated plans
2022-09-21 19:39:57 INFO  ---RUNTIME: Execution took 47374.385833740234 ms
2022-09-21 19:39:57 INFO  Done!
2022-09-21 19:39:57 INFO  # Finished -- repetition 3 of 7 
2022-09-21 19:39:57 INFO  # Optimization benchmark for data_corruption with args [['folktables', 'slow_loading', 'featurization_0', 'xgboost']] -- repetition 4 of 7
2022-09-21 19:39:57 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-21 19:39:57 INFO  Running instrumented original pipeline...
2022-09-21 19:39:57 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-21 19:39:57 INFO  ---RUNTIME: Importing and monkey-patching took 6.249427795410156 ms
2022-09-21 19:39:59 INFO  ---RUNTIME: Original pipeline execution took 1680.9775829315186 ms (excluding imports and monkey-patching)
2022-09-21 19:39:59 INFO  Starting execution of 1 what-if analyses...
2022-09-21 19:39:59 INFO  Start plan generation for analysis DataCorruption...
2022-09-21 19:39:59 INFO  ---RUNTIME: Plan generation took 0.469207763671875 ms
2022-09-21 19:39:59 INFO  Estimated runtime of original DAG is 1270.4246044158936ms
2022-09-21 19:39:59 INFO  Performing Multi-Query Optimization
2022-09-21 19:39:59 INFO  Estimated unoptimized what-if runtime is 40653.587341308594ms
2022-09-21 19:39:59 INFO  Estimated optimised what-if runtime is 2052.903890609741ms
2022-09-21 19:39:59 INFO  Estimated optimisation runtime saving is 38600.68345069885ms
2022-09-21 19:39:59 INFO  ---RUNTIME: Multi-Query Optimization took 81.01940155029297 ms
2022-09-21 19:39:59 INFO  Executing generated plans
2022-09-21 19:40:02 INFO  ---RUNTIME: Execution took 2954.380512237549 ms
2022-09-21 19:40:02 INFO  Done!
2022-09-21 19:40:02 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-21 19:40:02 INFO  Running instrumented original pipeline...
2022-09-21 19:40:02 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-21 19:40:02 INFO  ---RUNTIME: Importing and monkey-patching took 5.875110626220703 ms
2022-09-21 19:40:03 INFO  ---RUNTIME: Original pipeline execution took 1723.473072052002 ms (excluding imports and monkey-patching)
2022-09-21 19:40:03 INFO  Starting execution of 1 what-if analyses...
2022-09-21 19:40:03 INFO  Start plan generation for analysis DataCorruption...
2022-09-21 19:40:03 INFO  ---RUNTIME: Plan generation took 0.4482269287109375 ms
2022-09-21 19:40:03 INFO  Estimated runtime of original DAG is 1318.9406394958496ms
2022-09-21 19:40:03 WARNING Skipping Multi-Query Optimization (instead, only applying patches)
2022-09-21 19:40:03 INFO  Estimated unoptimised what-if runtime is 42206.10046386719ms
2022-09-21 19:40:03 INFO  ---RUNTIME: Multi-Query Optimization took 18.58687400817871 ms
2022-09-21 19:40:03 INFO  Executing generated plans
2022-09-21 19:40:51 INFO  ---RUNTIME: Execution took 47728.551387786865 ms
2022-09-21 19:40:51 INFO  Done!
2022-09-21 19:40:51 INFO  # Finished -- repetition 4 of 7 
2022-09-21 19:40:51 INFO  # Optimization benchmark for data_corruption with args [['folktables', 'slow_loading', 'featurization_0', 'xgboost']] -- repetition 5 of 7
2022-09-21 19:40:51 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-21 19:40:51 INFO  Running instrumented original pipeline...
2022-09-21 19:40:51 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-21 19:40:51 INFO  ---RUNTIME: Importing and monkey-patching took 5.934476852416992 ms
2022-09-21 19:40:53 INFO  ---RUNTIME: Original pipeline execution took 1805.0682544708252 ms (excluding imports and monkey-patching)
2022-09-21 19:40:53 INFO  Starting execution of 1 what-if analyses...
2022-09-21 19:40:53 INFO  Start plan generation for analysis DataCorruption...
2022-09-21 19:40:53 INFO  ---RUNTIME: Plan generation took 0.49591064453125 ms
2022-09-21 19:40:53 INFO  Estimated runtime of original DAG is 1395.9407806396484ms
2022-09-21 19:40:53 INFO  Performing Multi-Query Optimization
2022-09-21 19:40:53 INFO  Estimated unoptimized what-if runtime is 44670.10498046875ms
2022-09-21 19:40:53 INFO  Estimated optimised what-if runtime is 2288.235902786255ms
2022-09-21 19:40:53 INFO  Estimated optimisation runtime saving is 42381.869077682495ms
2022-09-21 19:40:53 INFO  ---RUNTIME: Multi-Query Optimization took 77.62575149536133 ms
2022-09-21 19:40:53 INFO  Executing generated plans
2022-09-21 19:40:56 INFO  ---RUNTIME: Execution took 2861.717462539673 ms
2022-09-21 19:40:56 INFO  Done!
2022-09-21 19:40:56 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-21 19:40:56 INFO  Running instrumented original pipeline...
2022-09-21 19:40:56 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-21 19:40:56 INFO  ---RUNTIME: Importing and monkey-patching took 5.5084228515625 ms
2022-09-21 19:40:58 INFO  ---RUNTIME: Original pipeline execution took 1846.86279296875 ms (excluding imports and monkey-patching)
2022-09-21 19:40:58 INFO  Starting execution of 1 what-if analyses...
2022-09-21 19:40:58 INFO  Start plan generation for analysis DataCorruption...
2022-09-21 19:40:58 INFO  ---RUNTIME: Plan generation took 0.6108283996582031 ms
2022-09-21 19:40:58 INFO  Estimated runtime of original DAG is 1447.3063945770264ms
2022-09-21 19:40:58 WARNING Skipping Multi-Query Optimization (instead, only applying patches)
2022-09-21 19:40:58 INFO  Estimated unoptimised what-if runtime is 46313.804626464844ms
2022-09-21 19:40:58 INFO  ---RUNTIME: Multi-Query Optimization took 27.460813522338867 ms
2022-09-21 19:40:58 INFO  Executing generated plans
2022-09-21 19:41:45 INFO  ---RUNTIME: Execution took 47441.94507598877 ms
2022-09-21 19:41:45 INFO  Done!
2022-09-21 19:41:45 INFO  # Finished -- repetition 5 of 7 
2022-09-21 19:41:45 INFO  # Optimization benchmark for data_corruption with args [['folktables', 'slow_loading', 'featurization_0', 'xgboost']] -- repetition 6 of 7
2022-09-21 19:41:45 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-21 19:41:45 INFO  Running instrumented original pipeline...
2022-09-21 19:41:45 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-21 19:41:45 INFO  ---RUNTIME: Importing and monkey-patching took 5.959749221801758 ms
2022-09-21 19:41:47 INFO  ---RUNTIME: Original pipeline execution took 1767.4169540405273 ms (excluding imports and monkey-patching)
2022-09-21 19:41:47 INFO  Starting execution of 1 what-if analyses...
2022-09-21 19:41:47 INFO  Start plan generation for analysis DataCorruption...
2022-09-21 19:41:47 INFO  ---RUNTIME: Plan generation took 0.6549358367919922 ms
2022-09-21 19:41:47 INFO  Estimated runtime of original DAG is 1365.5264377593994ms
2022-09-21 19:41:47 INFO  Performing Multi-Query Optimization
2022-09-21 19:41:47 INFO  Estimated unoptimized what-if runtime is 43696.84600830078ms
2022-09-21 19:41:47 INFO  Estimated optimised what-if runtime is 2411.17000579834ms
2022-09-21 19:41:47 INFO  Estimated optimisation runtime saving is 41285.67600250244ms
2022-09-21 19:41:47 INFO  ---RUNTIME: Multi-Query Optimization took 95.63112258911133 ms
2022-09-21 19:41:47 INFO  Executing generated plans
2022-09-21 19:41:50 INFO  ---RUNTIME: Execution took 2914.8151874542236 ms
2022-09-21 19:41:50 INFO  Done!
2022-09-21 19:41:50 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-21 19:41:50 INFO  Running instrumented original pipeline...
2022-09-21 19:41:50 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-21 19:41:50 INFO  ---RUNTIME: Importing and monkey-patching took 5.6610107421875 ms
2022-09-21 19:41:52 INFO  ---RUNTIME: Original pipeline execution took 1944.889783859253 ms (excluding imports and monkey-patching)
2022-09-21 19:41:52 INFO  Starting execution of 1 what-if analyses...
2022-09-21 19:41:52 INFO  Start plan generation for analysis DataCorruption...
2022-09-21 19:41:52 INFO  ---RUNTIME: Plan generation took 0.47469139099121094 ms
2022-09-21 19:41:52 INFO  Estimated runtime of original DAG is 1334.1295719146729ms
2022-09-21 19:41:52 WARNING Skipping Multi-Query Optimization (instead, only applying patches)
2022-09-21 19:41:52 INFO  Estimated unoptimised what-if runtime is 42692.14630126953ms
2022-09-21 19:41:52 INFO  ---RUNTIME: Multi-Query Optimization took 18.121957778930664 ms
2022-09-21 19:41:52 INFO  Executing generated plans
2022-09-21 19:42:41 INFO  ---RUNTIME: Execution took 48876.8515586853 ms
2022-09-21 19:42:41 INFO  Done!
2022-09-21 19:42:41 INFO  # Finished -- repetition 6 of 7 
2022-09-21 19:42:41 INFO  # Optimization benchmark for data_corruption with args [['folktables', 'slow_loading', 'featurization_0', 'xgboost']] -- repetition 7 of 7
2022-09-21 19:42:41 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-21 19:42:41 INFO  Running instrumented original pipeline...
2022-09-21 19:42:41 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-21 19:42:41 INFO  ---RUNTIME: Importing and monkey-patching took 5.825996398925781 ms
2022-09-21 19:42:43 INFO  ---RUNTIME: Original pipeline execution took 1761.789083480835 ms (excluding imports and monkey-patching)
2022-09-21 19:42:43 INFO  Starting execution of 1 what-if analyses...
2022-09-21 19:42:43 INFO  Start plan generation for analysis DataCorruption...
2022-09-21 19:42:43 INFO  ---RUNTIME: Plan generation took 1.2400150299072266 ms
2022-09-21 19:42:43 INFO  Estimated runtime of original DAG is 1372.5337982177734ms
2022-09-21 19:42:43 INFO  Performing Multi-Query Optimization
2022-09-21 19:42:43 INFO  Estimated unoptimized what-if runtime is 43921.08154296875ms
2022-09-21 19:42:43 INFO  Estimated optimised what-if runtime is 2293.3402061462402ms
2022-09-21 19:42:43 INFO  Estimated optimisation runtime saving is 41627.74133682251ms
2022-09-21 19:42:43 INFO  ---RUNTIME: Multi-Query Optimization took 77.91852951049805 ms
2022-09-21 19:42:43 INFO  Executing generated plans
2022-09-21 19:42:46 INFO  ---RUNTIME: Execution took 2976.341485977173 ms
2022-09-21 19:42:46 INFO  Done!
2022-09-21 19:42:46 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-21 19:42:46 INFO  Running instrumented original pipeline...
2022-09-21 19:42:46 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-21 19:42:46 INFO  ---RUNTIME: Importing and monkey-patching took 5.73277473449707 ms
2022-09-21 19:42:48 INFO  ---RUNTIME: Original pipeline execution took 1847.280740737915 ms (excluding imports and monkey-patching)
2022-09-21 19:42:48 INFO  Starting execution of 1 what-if analyses...
2022-09-21 19:42:48 INFO  Start plan generation for analysis DataCorruption...
2022-09-21 19:42:48 INFO  ---RUNTIME: Plan generation took 0.43964385986328125 ms
2022-09-21 19:42:48 INFO  Estimated runtime of original DAG is 1456.7856788635254ms
2022-09-21 19:42:48 WARNING Skipping Multi-Query Optimization (instead, only applying patches)
2022-09-21 19:42:48 INFO  Estimated unoptimised what-if runtime is 46617.14172363281ms
2022-09-21 19:42:48 INFO  ---RUNTIME: Multi-Query Optimization took 18.386125564575195 ms
2022-09-21 19:42:48 INFO  Executing generated plans
2022-09-21 19:43:36 INFO  ---RUNTIME: Execution took 48608.970403671265 ms
2022-09-21 19:43:36 INFO  Done!
2022-09-21 19:43:36 INFO  # Finished -- repetition 7 of 7 
2022-09-21 19:43:36 INFO  # Final results after all repetitions
2022-09-21 19:43:36 INFO     repetition  ... no_opt_what_if_execution_combined_model_training
0           0  ...                                     34533.854008
1           1  ...                                     34503.185272
2           2  ...                                     34954.091311
3           3  ...                                     35816.040039
4           4  ...                                     35793.921709
5           5  ...                                     37036.062002
6           6  ...                                     36974.703789

[7 rows x 26 columns]
taskset -c 64-71 PROTOCOL_BUFFERS_PYTHON_IMPLEMENTATION=python python3.9 benchmarks_end_to_end.py data_corruption folktables slow_loading featurization_0 neural_network
2022-09-21 19:43:38.792004: W tensorflow/stream_executor/platform/default/dso_loader.cc:64] Could not load dynamic library 'libcudart.so.11.0'; dlerror: libcudart.so.11.0: cannot open shared object file: No such file or directory; LD_LIBRARY_PATH: /home/sgrafbe/mlwhatif/venv/lib/python3.9/site-packages/cv2/../../lib64:
2022-09-21 19:43:38.792046: I tensorflow/stream_executor/cuda/cudart_stub.cc:29] Ignore above cudart dlerror if you do not have a GPU set up on your machine.
2022-09-21 19:43:40 INFO  Patching sys.argv with ['mlwhatif', 'folktables', 'slow_loading', 'featurization_0', 'neural_network']
2022-09-21 19:43:40 INFO  Running instrumented original pipeline...
2022-09-21 19:43:40 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-21 19:43:40 INFO  ---RUNTIME: Importing and monkey-patching took 94.94853019714355 ms
2022-09-21 19:43:40.713654: W tensorflow/stream_executor/platform/default/dso_loader.cc:64] Could not load dynamic library 'libcuda.so.1'; dlerror: libcuda.so.1: cannot open shared object file: No such file or directory; LD_LIBRARY_PATH: /home/sgrafbe/mlwhatif/venv/lib/python3.9/site-packages/cv2/../../lib64:
2022-09-21 19:43:40.713689: W tensorflow/stream_executor/cuda/cuda_driver.cc:326] failed call to cuInit: UNKNOWN ERROR (303)
2022-09-21 19:43:40.713709: I tensorflow/stream_executor/cuda/cuda_diagnostics.cc:156] kernel driver does not appear to be running on this host (wagyu): /proc/driver/nvidia/version does not exist
2022-09-21 19:43:40.714146: I tensorflow/core/platform/cpu_feature_guard.cc:142] This TensorFlow binary is optimized with oneAPI Deep Neural Network Library (oneDNN) to use the following CPU instructions in performance-critical operations:  AVX2 FMA
To enable them in other operations, rebuild TensorFlow with the appropriate compiler flags.
2022-09-21 19:43:40.809617: I tensorflow/compiler/mlir/mlir_graph_optimization_pass.cc:176] None of the MLIR Optimization Passes are enabled (registered 2)
2022-09-21 19:43:40.821372: I tensorflow/core/platform/profile_utils/cpu_utils.cc:114] CPU Frequency: 2595290000 Hz
2022-09-21 19:43:43 INFO  ---RUNTIME: Original pipeline execution took 3469.8591232299805 ms (excluding imports and monkey-patching)
2022-09-21 19:43:43 INFO  Starting execution of 0 what-if analyses...
2022-09-21 19:43:43 INFO  Estimated runtime of original DAG is 3056.950330734253ms
2022-09-21 19:43:43 INFO  Performing Multi-Query Optimization
2022-09-21 19:43:43 INFO  Estimated unoptimized what-if runtime is 0ms
2022-09-21 19:43:43 INFO  Estimated optimised what-if runtime is 0ms
2022-09-21 19:43:43 INFO  Estimated optimisation runtime saving is 0ms
2022-09-21 19:43:43 INFO  ---RUNTIME: Multi-Query Optimization took 0.37384033203125 ms
2022-09-21 19:43:43 INFO  Executing generated plans
2022-09-21 19:43:43 INFO  ---RUNTIME: Execution took 0.014066696166992188 ms
2022-09-21 19:43:43 INFO  Done!
2022-09-21 19:43:43 INFO  # Optimization benchmark for data_corruption with args [['folktables', 'slow_loading', 'featurization_0', 'neural_network']] -- repetition 1 of 7
2022-09-21 19:43:43 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-21 19:43:43 INFO  Running instrumented original pipeline...
2022-09-21 19:43:43 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-21 19:43:43 INFO  ---RUNTIME: Importing and monkey-patching took 5.051374435424805 ms
2022-09-21 19:43:46 INFO  ---RUNTIME: Original pipeline execution took 3234.694242477417 ms (excluding imports and monkey-patching)
2022-09-21 19:43:46 INFO  Starting execution of 1 what-if analyses...
2022-09-21 19:43:46 INFO  Start plan generation for analysis DataCorruption...
2022-09-21 19:43:46 INFO  ---RUNTIME: Plan generation took 0.4787445068359375 ms
2022-09-21 19:43:46 INFO  Estimated runtime of original DAG is 2848.471164703369ms
2022-09-21 19:43:46 INFO  Performing Multi-Query Optimization
2022-09-21 19:43:46 INFO  Estimated unoptimized what-if runtime is 91151.07727050781ms
2022-09-21 19:43:46 INFO  Estimated optimised what-if runtime is 6838.86194229126ms
2022-09-21 19:43:46 INFO  Estimated optimisation runtime saving is 84312.21532821655ms
2022-09-21 19:43:46 INFO  ---RUNTIME: Multi-Query Optimization took 77.28147506713867 ms
2022-09-21 19:43:46 INFO  Executing generated plans
2022-09-21 19:43:53 INFO  ---RUNTIME: Execution took 6545.518398284912 ms
2022-09-21 19:43:53 INFO  Done!
2022-09-21 19:43:53 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-21 19:43:53 INFO  Running instrumented original pipeline...
2022-09-21 19:43:53 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-21 19:43:53 INFO  ---RUNTIME: Importing and monkey-patching took 6.147623062133789 ms
2022-09-21 19:43:57 INFO  ---RUNTIME: Original pipeline execution took 3632.7738761901855 ms (excluding imports and monkey-patching)
2022-09-21 19:43:57 INFO  Starting execution of 1 what-if analyses...
2022-09-21 19:43:57 INFO  Start plan generation for analysis DataCorruption...
2022-09-21 19:43:57 INFO  ---RUNTIME: Plan generation took 0.5717277526855469 ms
2022-09-21 19:43:57 INFO  Estimated runtime of original DAG is 3242.1584129333496ms
2022-09-21 19:43:57 WARNING Skipping Multi-Query Optimization (instead, only applying patches)
2022-09-21 19:43:57 INFO  Estimated unoptimised what-if runtime is 103749.06921386719ms
2022-09-21 19:43:57 INFO  ---RUNTIME: Multi-Query Optimization took 18.435239791870117 ms
2022-09-21 19:43:57 INFO  Executing generated plans
2022-09-21 19:45:34 INFO  ---RUNTIME: Execution took 97046.4026927948 ms
2022-09-21 19:45:34 INFO  Done!
2022-09-21 19:45:34 INFO  # Finished -- repetition 1 of 7 
2022-09-21 19:45:34 INFO  # Optimization benchmark for data_corruption with args [['folktables', 'slow_loading', 'featurization_0', 'neural_network']] -- repetition 2 of 7
2022-09-21 19:45:34 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-21 19:45:34 INFO  Running instrumented original pipeline...
2022-09-21 19:45:34 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-21 19:45:34 INFO  ---RUNTIME: Importing and monkey-patching took 5.554676055908203 ms
2022-09-21 19:45:37 INFO  ---RUNTIME: Original pipeline execution took 3172.633647918701 ms (excluding imports and monkey-patching)
2022-09-21 19:45:37 INFO  Starting execution of 1 what-if analyses...
2022-09-21 19:45:37 INFO  Start plan generation for analysis DataCorruption...
2022-09-21 19:45:37 INFO  ---RUNTIME: Plan generation took 0.4565715789794922 ms
2022-09-21 19:45:37 INFO  Estimated runtime of original DAG is 2786.8287563323975ms
2022-09-21 19:45:37 INFO  Performing Multi-Query Optimization
2022-09-21 19:45:37 INFO  Estimated unoptimized what-if runtime is 89178.52020263672ms
2022-09-21 19:45:37 INFO  Estimated optimised what-if runtime is 6284.093856811523ms
2022-09-21 19:45:37 INFO  Estimated optimisation runtime saving is 82894.4263458252ms
2022-09-21 19:45:37 INFO  ---RUNTIME: Multi-Query Optimization took 77.17370986938477 ms
2022-09-21 19:45:37 INFO  Executing generated plans
2022-09-21 19:45:44 INFO  ---RUNTIME: Execution took 6600.647926330566 ms
2022-09-21 19:45:44 INFO  Done!
2022-09-21 19:45:44 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-21 19:45:44 INFO  Running instrumented original pipeline...
2022-09-21 19:45:44 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-21 19:45:44 INFO  ---RUNTIME: Importing and monkey-patching took 5.652666091918945 ms
2022-09-21 19:45:47 INFO  ---RUNTIME: Original pipeline execution took 3460.0789546966553 ms (excluding imports and monkey-patching)
2022-09-21 19:45:47 INFO  Starting execution of 1 what-if analyses...
2022-09-21 19:45:47 INFO  Start plan generation for analysis DataCorruption...
2022-09-21 19:45:47 INFO  ---RUNTIME: Plan generation took 0.45943260192871094 ms
2022-09-21 19:45:47 INFO  Estimated runtime of original DAG is 3074.9402046203613ms
2022-09-21 19:45:47 WARNING Skipping Multi-Query Optimization (instead, only applying patches)
2022-09-21 19:45:47 INFO  Estimated unoptimised what-if runtime is 98398.08654785156ms
2022-09-21 19:45:47 INFO  ---RUNTIME: Multi-Query Optimization took 18.277406692504883 ms
2022-09-21 19:45:47 INFO  Executing generated plans
2022-09-21 19:47:23 INFO  ---RUNTIME: Execution took 96280.58242797852 ms
2022-09-21 19:47:23 INFO  Done!
2022-09-21 19:47:23 INFO  # Finished -- repetition 2 of 7 
2022-09-21 19:47:23 INFO  # Optimization benchmark for data_corruption with args [['folktables', 'slow_loading', 'featurization_0', 'neural_network']] -- repetition 3 of 7
2022-09-21 19:47:23 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-21 19:47:23 INFO  Running instrumented original pipeline...
2022-09-21 19:47:23 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-21 19:47:23 INFO  ---RUNTIME: Importing and monkey-patching took 5.870580673217773 ms
2022-09-21 19:47:27 INFO  ---RUNTIME: Original pipeline execution took 3365.2944564819336 ms (excluding imports and monkey-patching)
2022-09-21 19:47:27 INFO  Starting execution of 1 what-if analyses...
2022-09-21 19:47:27 INFO  Start plan generation for analysis DataCorruption...
2022-09-21 19:47:27 INFO  ---RUNTIME: Plan generation took 0.49304962158203125 ms
2022-09-21 19:47:27 INFO  Estimated runtime of original DAG is 2961.013078689575ms
2022-09-21 19:47:27 INFO  Performing Multi-Query Optimization
2022-09-21 19:47:27 INFO  Estimated unoptimized what-if runtime is 94752.4185180664ms
2022-09-21 19:47:27 INFO  Estimated optimised what-if runtime is 6596.1339473724365ms
2022-09-21 19:47:27 INFO  Estimated optimisation runtime saving is 88156.28457069397ms
2022-09-21 19:47:27 INFO  ---RUNTIME: Multi-Query Optimization took 77.4533748626709 ms
2022-09-21 19:47:27 INFO  Executing generated plans
2022-09-21 19:47:34 INFO  ---RUNTIME: Execution took 7127.948522567749 ms
2022-09-21 19:47:34 INFO  Done!
2022-09-21 19:47:34 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-21 19:47:34 INFO  Running instrumented original pipeline...
2022-09-21 19:47:34 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-21 19:47:34 INFO  ---RUNTIME: Importing and monkey-patching took 6.580352783203125 ms
2022-09-21 19:47:37 INFO  ---RUNTIME: Original pipeline execution took 3279.2298793792725 ms (excluding imports and monkey-patching)
2022-09-21 19:47:37 INFO  Starting execution of 1 what-if analyses...
2022-09-21 19:47:37 INFO  Start plan generation for analysis DataCorruption...
2022-09-21 19:47:37 INFO  ---RUNTIME: Plan generation took 0.4849433898925781 ms
2022-09-21 19:47:37 INFO  Estimated runtime of original DAG is 2876.1982917785645ms
2022-09-21 19:47:37 WARNING Skipping Multi-Query Optimization (instead, only applying patches)
2022-09-21 19:47:37 INFO  Estimated unoptimised what-if runtime is 92038.34533691406ms
2022-09-21 19:47:37 INFO  ---RUNTIME: Multi-Query Optimization took 18.393516540527344 ms
2022-09-21 19:47:37 INFO  Executing generated plans
2022-09-21 19:49:13 INFO  ---RUNTIME: Execution took 95702.3012638092 ms
2022-09-21 19:49:13 INFO  Done!
2022-09-21 19:49:13 INFO  # Finished -- repetition 3 of 7 
2022-09-21 19:49:13 INFO  # Optimization benchmark for data_corruption with args [['folktables', 'slow_loading', 'featurization_0', 'neural_network']] -- repetition 4 of 7
2022-09-21 19:49:13 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-21 19:49:13 INFO  Running instrumented original pipeline...
2022-09-21 19:49:13 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-21 19:49:13 INFO  ---RUNTIME: Importing and monkey-patching took 5.85484504699707 ms
2022-09-21 19:49:16 INFO  ---RUNTIME: Original pipeline execution took 3283.6833000183105 ms (excluding imports and monkey-patching)
2022-09-21 19:49:16 INFO  Starting execution of 1 what-if analyses...
2022-09-21 19:49:16 INFO  Start plan generation for analysis DataCorruption...
2022-09-21 19:49:16 INFO  ---RUNTIME: Plan generation took 0.4601478576660156 ms
2022-09-21 19:49:16 INFO  Estimated runtime of original DAG is 2860.475540161133ms
2022-09-21 19:49:16 INFO  Performing Multi-Query Optimization
2022-09-21 19:49:16 INFO  Estimated unoptimized what-if runtime is 91535.21728515625ms
2022-09-21 19:49:16 INFO  Estimated optimised what-if runtime is 6628.415822982788ms
2022-09-21 19:49:16 INFO  Estimated optimisation runtime saving is 84906.80146217346ms
2022-09-21 19:49:16 INFO  ---RUNTIME: Multi-Query Optimization took 80.49774169921875 ms
2022-09-21 19:49:16 INFO  Executing generated plans
2022-09-21 19:49:23 INFO  ---RUNTIME: Execution took 7094.8638916015625 ms
2022-09-21 19:49:23 INFO  Done!
2022-09-21 19:49:23 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-21 19:49:23 INFO  Running instrumented original pipeline...
2022-09-21 19:49:23 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-21 19:49:23 INFO  ---RUNTIME: Importing and monkey-patching took 5.800724029541016 ms
2022-09-21 19:49:27 INFO  ---RUNTIME: Original pipeline execution took 3259.719133377075 ms (excluding imports and monkey-patching)
2022-09-21 19:49:27 INFO  Starting execution of 1 what-if analyses...
2022-09-21 19:49:27 INFO  Start plan generation for analysis DataCorruption...
2022-09-21 19:49:27 INFO  ---RUNTIME: Plan generation took 0.45871734619140625 ms
2022-09-21 19:49:27 INFO  Estimated runtime of original DAG is 2872.6303577423096ms
2022-09-21 19:49:27 WARNING Skipping Multi-Query Optimization (instead, only applying patches)
2022-09-21 19:49:27 INFO  Estimated unoptimised what-if runtime is 91924.1714477539ms
2022-09-21 19:49:27 INFO  ---RUNTIME: Multi-Query Optimization took 18.42212677001953 ms
2022-09-21 19:49:27 INFO  Executing generated plans
2022-09-21 19:51:02 INFO  ---RUNTIME: Execution took 95632.7793598175 ms
2022-09-21 19:51:02 INFO  Done!
2022-09-21 19:51:02 INFO  # Finished -- repetition 4 of 7 
2022-09-21 19:51:02 INFO  # Optimization benchmark for data_corruption with args [['folktables', 'slow_loading', 'featurization_0', 'neural_network']] -- repetition 5 of 7
2022-09-21 19:51:02 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-21 19:51:02 INFO  Running instrumented original pipeline...
2022-09-21 19:51:02 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-21 19:51:02 INFO  ---RUNTIME: Importing and monkey-patching took 5.541086196899414 ms
2022-09-21 19:51:06 INFO  ---RUNTIME: Original pipeline execution took 3251.8310546875 ms (excluding imports and monkey-patching)
2022-09-21 19:51:06 INFO  Starting execution of 1 what-if analyses...
2022-09-21 19:51:06 INFO  Start plan generation for analysis DataCorruption...
2022-09-21 19:51:06 INFO  ---RUNTIME: Plan generation took 0.5075931549072266 ms
2022-09-21 19:51:06 INFO  Estimated runtime of original DAG is 2864.165782928467ms
2022-09-21 19:51:06 INFO  Performing Multi-Query Optimization
2022-09-21 19:51:06 INFO  Estimated unoptimized what-if runtime is 91653.30505371094ms
2022-09-21 19:51:06 INFO  Estimated optimised what-if runtime is 6767.746925354004ms
2022-09-21 19:51:06 INFO  Estimated optimisation runtime saving is 84885.55812835693ms
2022-09-21 19:51:06 INFO  ---RUNTIME: Multi-Query Optimization took 79.44464683532715 ms
2022-09-21 19:51:06 INFO  Executing generated plans
2022-09-21 19:51:13 INFO  ---RUNTIME: Execution took 7073.32181930542 ms
2022-09-21 19:51:13 INFO  Done!
2022-09-21 19:51:13 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-21 19:51:13 INFO  Running instrumented original pipeline...
2022-09-21 19:51:13 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-21 19:51:13 INFO  ---RUNTIME: Importing and monkey-patching took 5.746364593505859 ms
2022-09-21 19:51:16 INFO  ---RUNTIME: Original pipeline execution took 3295.8755493164062 ms (excluding imports and monkey-patching)
2022-09-21 19:51:16 INFO  Starting execution of 1 what-if analyses...
2022-09-21 19:51:16 INFO  Start plan generation for analysis DataCorruption...
2022-09-21 19:51:16 INFO  ---RUNTIME: Plan generation took 0.5145072937011719 ms
2022-09-21 19:51:16 INFO  Estimated runtime of original DAG is 2903.2492637634277ms
2022-09-21 19:51:16 WARNING Skipping Multi-Query Optimization (instead, only applying patches)
2022-09-21 19:51:16 INFO  Estimated unoptimised what-if runtime is 92903.97644042969ms
2022-09-21 19:51:16 INFO  ---RUNTIME: Multi-Query Optimization took 20.01214027404785 ms
2022-09-21 19:51:16 INFO  Executing generated plans
2022-09-21 19:52:52 INFO  ---RUNTIME: Execution took 95513.2749080658 ms
2022-09-21 19:52:52 INFO  Done!
2022-09-21 19:52:52 INFO  # Finished -- repetition 5 of 7 
2022-09-21 19:52:52 INFO  # Optimization benchmark for data_corruption with args [['folktables', 'slow_loading', 'featurization_0', 'neural_network']] -- repetition 6 of 7
2022-09-21 19:52:52 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-21 19:52:52 INFO  Running instrumented original pipeline...
2022-09-21 19:52:52 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-21 19:52:52 INFO  ---RUNTIME: Importing and monkey-patching took 6.008148193359375 ms
2022-09-21 19:52:55 INFO  ---RUNTIME: Original pipeline execution took 3241.800308227539 ms (excluding imports and monkey-patching)
2022-09-21 19:52:55 INFO  Starting execution of 1 what-if analyses...
2022-09-21 19:52:55 INFO  Start plan generation for analysis DataCorruption...
2022-09-21 19:52:55 INFO  ---RUNTIME: Plan generation took 0.5335807800292969 ms
2022-09-21 19:52:55 INFO  Estimated runtime of original DAG is 2856.4727306365967ms
2022-09-21 19:52:55 INFO  Performing Multi-Query Optimization
2022-09-21 19:52:55 INFO  Estimated unoptimized what-if runtime is 91407.1273803711ms
2022-09-21 19:52:55 INFO  Estimated optimised what-if runtime is 6642.371416091919ms
2022-09-21 19:52:55 INFO  Estimated optimisation runtime saving is 84764.75596427917ms
2022-09-21 19:52:55 INFO  ---RUNTIME: Multi-Query Optimization took 79.12063598632812 ms
2022-09-21 19:52:55 INFO  Executing generated plans
2022-09-21 19:53:01 INFO  ---RUNTIME: Execution took 6620.86820602417 ms
2022-09-21 19:53:01 INFO  Done!
2022-09-21 19:53:02 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-21 19:53:02 INFO  Running instrumented original pipeline...
2022-09-21 19:53:02 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-21 19:53:02 INFO  ---RUNTIME: Importing and monkey-patching took 5.637884140014648 ms
2022-09-21 19:53:05 INFO  ---RUNTIME: Original pipeline execution took 3677.4981021881104 ms (excluding imports and monkey-patching)
2022-09-21 19:53:05 INFO  Starting execution of 1 what-if analyses...
2022-09-21 19:53:05 INFO  Start plan generation for analysis DataCorruption...
2022-09-21 19:53:05 INFO  ---RUNTIME: Plan generation took 0.4596710205078125 ms
2022-09-21 19:53:05 INFO  Estimated runtime of original DAG is 3289.9482250213623ms
2022-09-21 19:53:05 WARNING Skipping Multi-Query Optimization (instead, only applying patches)
2022-09-21 19:53:05 INFO  Estimated unoptimised what-if runtime is 105278.3432006836ms
2022-09-21 19:53:05 INFO  ---RUNTIME: Multi-Query Optimization took 18.733739852905273 ms
2022-09-21 19:53:05 INFO  Executing generated plans
2022-09-21 19:54:42 INFO  ---RUNTIME: Execution took 96665.29989242554 ms
2022-09-21 19:54:42 INFO  Done!
2022-09-21 19:54:42 INFO  # Finished -- repetition 6 of 7 
2022-09-21 19:54:42 INFO  # Optimization benchmark for data_corruption with args [['folktables', 'slow_loading', 'featurization_0', 'neural_network']] -- repetition 7 of 7
2022-09-21 19:54:42 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-21 19:54:42 INFO  Running instrumented original pipeline...
2022-09-21 19:54:42 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-21 19:54:42 INFO  ---RUNTIME: Importing and monkey-patching took 5.683660507202148 ms
2022-09-21 19:54:46 INFO  ---RUNTIME: Original pipeline execution took 3635.8437538146973 ms (excluding imports and monkey-patching)
2022-09-21 19:54:46 INFO  Starting execution of 1 what-if analyses...
2022-09-21 19:54:46 INFO  Start plan generation for analysis DataCorruption...
2022-09-21 19:54:46 INFO  ---RUNTIME: Plan generation took 0.46634674072265625 ms
2022-09-21 19:54:46 INFO  Estimated runtime of original DAG is 2806.777000427246ms
2022-09-21 19:54:46 INFO  Performing Multi-Query Optimization
2022-09-21 19:54:46 INFO  Estimated unoptimized what-if runtime is 89816.86401367188ms
2022-09-21 19:54:46 INFO  Estimated optimised what-if runtime is 6606.868028640747ms
2022-09-21 19:54:46 INFO  Estimated optimisation runtime saving is 83209.99598503113ms
2022-09-21 19:54:46 INFO  ---RUNTIME: Multi-Query Optimization took 75.69146156311035 ms
2022-09-21 19:54:46 INFO  Executing generated plans
2022-09-21 19:54:52 INFO  ---RUNTIME: Execution took 6646.605730056763 ms
2022-09-21 19:54:52 INFO  Done!
2022-09-21 19:54:52 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-21 19:54:52 INFO  Running instrumented original pipeline...
2022-09-21 19:54:52 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-21 19:54:52 INFO  ---RUNTIME: Importing and monkey-patching took 5.506753921508789 ms
2022-09-21 19:54:55 INFO  ---RUNTIME: Original pipeline execution took 3213.0978107452393 ms (excluding imports and monkey-patching)
2022-09-21 19:54:55 INFO  Starting execution of 1 what-if analyses...
2022-09-21 19:54:55 INFO  Start plan generation for analysis DataCorruption...
2022-09-21 19:54:55 INFO  ---RUNTIME: Plan generation took 0.46753883361816406 ms
2022-09-21 19:54:55 INFO  Estimated runtime of original DAG is 2824.289321899414ms
2022-09-21 19:54:55 WARNING Skipping Multi-Query Optimization (instead, only applying patches)
2022-09-21 19:54:55 INFO  Estimated unoptimised what-if runtime is 90377.25830078125ms
2022-09-21 19:54:55 INFO  ---RUNTIME: Multi-Query Optimization took 19.32835578918457 ms
2022-09-21 19:54:55 INFO  Executing generated plans
2022-09-21 19:56:44 INFO  ---RUNTIME: Execution took 108879.17900085449 ms
2022-09-21 19:56:44 INFO  Done!
2022-09-21 19:56:44 INFO  # Finished -- repetition 7 of 7 
2022-09-21 19:56:44 INFO  # Final results after all repetitions
2022-09-21 19:56:44 INFO     repetition  ... no_opt_what_if_execution_combined_model_training
0           0  ...                                     81518.965483
1           1  ...                                     81497.338533
2           2  ...                                     81260.609865
3           3  ...                                     81252.750635
4           4  ...                                     80351.657629
5           5  ...                                     80628.274918
6           6  ...                                     91514.817476

[7 rows x 26 columns]
taskset -c 64-71 PROTOCOL_BUFFERS_PYTHON_IMPLEMENTATION=python python3.9 benchmarks_end_to_end.py data_corruption folktables slow_loading featurization_1 logistic_regression
2022-09-21 19:56:48.021499: W tensorflow/stream_executor/platform/default/dso_loader.cc:64] Could not load dynamic library 'libcudart.so.11.0'; dlerror: libcudart.so.11.0: cannot open shared object file: No such file or directory; LD_LIBRARY_PATH: /home/sgrafbe/mlwhatif/venv/lib/python3.9/site-packages/cv2/../../lib64:
2022-09-21 19:56:48.021540: I tensorflow/stream_executor/cuda/cudart_stub.cc:29] Ignore above cudart dlerror if you do not have a GPU set up on your machine.
2022-09-21 19:56:49 INFO  Patching sys.argv with ['mlwhatif', 'folktables', 'slow_loading', 'featurization_1', 'logistic_regression']
2022-09-21 19:56:49 INFO  Running instrumented original pipeline...
2022-09-21 19:56:49 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-21 19:56:49 INFO  ---RUNTIME: Importing and monkey-patching took 129.37450408935547 ms
2022-09-21 19:56:51 INFO  ---RUNTIME: Original pipeline execution took 2035.0475311279297 ms (excluding imports and monkey-patching)
2022-09-21 19:56:51 INFO  Starting execution of 0 what-if analyses...
2022-09-21 19:56:51 INFO  Estimated runtime of original DAG is 354.60495948791504ms
2022-09-21 19:56:51 INFO  Performing Multi-Query Optimization
2022-09-21 19:56:51 INFO  Estimated unoptimized what-if runtime is 0ms
2022-09-21 19:56:51 INFO  Estimated optimised what-if runtime is 0ms
2022-09-21 19:56:51 INFO  Estimated optimisation runtime saving is 0ms
2022-09-21 19:56:51 INFO  ---RUNTIME: Multi-Query Optimization took 0.46539306640625 ms
2022-09-21 19:56:51 INFO  Executing generated plans
2022-09-21 19:56:51 INFO  ---RUNTIME: Execution took 0.021457672119140625 ms
2022-09-21 19:56:51 INFO  Done!
2022-09-21 19:56:51 INFO  # Optimization benchmark for data_corruption with args [['folktables', 'slow_loading', 'featurization_1', 'logistic_regression']] -- repetition 1 of 7
2022-09-21 19:56:51 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-21 19:56:51 INFO  Running instrumented original pipeline...
2022-09-21 19:56:51 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-21 19:56:51 INFO  ---RUNTIME: Importing and monkey-patching took 5.358219146728516 ms
2022-09-21 19:56:53 INFO  ---RUNTIME: Original pipeline execution took 1721.816062927246 ms (excluding imports and monkey-patching)
2022-09-21 19:56:53 INFO  Starting execution of 1 what-if analyses...
2022-09-21 19:56:53 INFO  Start plan generation for analysis DataCorruption...
2022-09-21 19:56:53 INFO  ---RUNTIME: Plan generation took 0.7801055908203125 ms
2022-09-21 19:56:53 INFO  Estimated runtime of original DAG is 389.3768787384033ms
2022-09-21 19:56:53 INFO  Performing Multi-Query Optimization
2022-09-21 19:56:53 INFO  Estimated unoptimized what-if runtime is 12460.060119628906ms
2022-09-21 19:56:53 INFO  Estimated optimised what-if runtime is 661.5362167358398ms
2022-09-21 19:56:53 INFO  Estimated optimisation runtime saving is 11798.523902893066ms
2022-09-21 19:56:53 INFO  ---RUNTIME: Multi-Query Optimization took 129.12750244140625 ms
2022-09-21 19:56:53 INFO  Executing generated plans
2022-09-21 19:56:55 INFO  ---RUNTIME: Execution took 1469.728946685791 ms
2022-09-21 19:56:55 INFO  Done!
2022-09-21 19:56:55 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-21 19:56:55 INFO  Running instrumented original pipeline...
2022-09-21 19:56:55 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-21 19:56:55 INFO  ---RUNTIME: Importing and monkey-patching took 5.6915283203125 ms
2022-09-21 19:56:57 INFO  ---RUNTIME: Original pipeline execution took 1864.4511699676514 ms (excluding imports and monkey-patching)
2022-09-21 19:56:57 INFO  Starting execution of 1 what-if analyses...
2022-09-21 19:56:57 INFO  Start plan generation for analysis DataCorruption...
2022-09-21 19:56:57 INFO  ---RUNTIME: Plan generation took 0.5202293395996094 ms
2022-09-21 19:56:57 INFO  Estimated runtime of original DAG is 306.23650550842285ms
2022-09-21 19:56:57 WARNING Skipping Multi-Query Optimization (instead, only applying patches)
2022-09-21 19:56:57 INFO  Estimated unoptimised what-if runtime is 9799.568176269531ms
2022-09-21 19:56:57 INFO  ---RUNTIME: Multi-Query Optimization took 22.419452667236328 ms
2022-09-21 19:56:57 INFO  Executing generated plans
2022-09-21 19:57:13 INFO  ---RUNTIME: Execution took 15999.932527542114 ms
2022-09-21 19:57:13 INFO  Done!
2022-09-21 19:57:13 INFO  # Finished -- repetition 1 of 7 
2022-09-21 19:57:13 INFO  # Optimization benchmark for data_corruption with args [['folktables', 'slow_loading', 'featurization_1', 'logistic_regression']] -- repetition 2 of 7
2022-09-21 19:57:13 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-21 19:57:13 INFO  Running instrumented original pipeline...
2022-09-21 19:57:13 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-21 19:57:13 INFO  ---RUNTIME: Importing and monkey-patching took 5.858659744262695 ms
2022-09-21 19:57:15 INFO  ---RUNTIME: Original pipeline execution took 1989.1977310180664 ms (excluding imports and monkey-patching)
2022-09-21 19:57:15 INFO  Starting execution of 1 what-if analyses...
2022-09-21 19:57:15 INFO  Start plan generation for analysis DataCorruption...
2022-09-21 19:57:15 INFO  ---RUNTIME: Plan generation took 0.6110668182373047 ms
2022-09-21 19:57:15 INFO  Estimated runtime of original DAG is 340.1501178741455ms
2022-09-21 19:57:15 INFO  Performing Multi-Query Optimization
2022-09-21 19:57:15 INFO  Estimated unoptimized what-if runtime is 10884.803771972656ms
2022-09-21 19:57:15 INFO  Estimated optimised what-if runtime is 619.7624206542969ms
2022-09-21 19:57:15 INFO  Estimated optimisation runtime saving is 10265.04135131836ms
2022-09-21 19:57:15 INFO  ---RUNTIME: Multi-Query Optimization took 132.38930702209473 ms
2022-09-21 19:57:15 INFO  Executing generated plans
2022-09-21 19:57:16 INFO  ---RUNTIME: Execution took 1396.5134620666504 ms
2022-09-21 19:57:16 INFO  Done!
2022-09-21 19:57:16 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-21 19:57:16 INFO  Running instrumented original pipeline...
2022-09-21 19:57:16 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-21 19:57:16 INFO  ---RUNTIME: Importing and monkey-patching took 8.309364318847656 ms
2022-09-21 19:57:18 INFO  ---RUNTIME: Original pipeline execution took 2117.7942752838135 ms (excluding imports and monkey-patching)
2022-09-21 19:57:18 INFO  Starting execution of 1 what-if analyses...
2022-09-21 19:57:18 INFO  Start plan generation for analysis DataCorruption...
2022-09-21 19:57:18 INFO  ---RUNTIME: Plan generation took 0.6895065307617188 ms
2022-09-21 19:57:18 INFO  Estimated runtime of original DAG is 471.21334075927734ms
2022-09-21 19:57:18 WARNING Skipping Multi-Query Optimization (instead, only applying patches)
2022-09-21 19:57:18 INFO  Estimated unoptimised what-if runtime is 15078.826904296875ms
2022-09-21 19:57:18 INFO  ---RUNTIME: Multi-Query Optimization took 31.508445739746094 ms
2022-09-21 19:57:18 INFO  Executing generated plans
2022-09-21 19:57:34 INFO  ---RUNTIME: Execution took 15488.444328308105 ms
2022-09-21 19:57:34 INFO  Done!
2022-09-21 19:57:34 INFO  # Finished -- repetition 2 of 7 
2022-09-21 19:57:34 INFO  # Optimization benchmark for data_corruption with args [['folktables', 'slow_loading', 'featurization_1', 'logistic_regression']] -- repetition 3 of 7
2022-09-21 19:57:34 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-21 19:57:34 INFO  Running instrumented original pipeline...
2022-09-21 19:57:34 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-21 19:57:34 INFO  ---RUNTIME: Importing and monkey-patching took 5.986928939819336 ms
2022-09-21 19:57:35 INFO  ---RUNTIME: Original pipeline execution took 1504.3179988861084 ms (excluding imports and monkey-patching)
2022-09-21 19:57:35 INFO  Starting execution of 1 what-if analyses...
2022-09-21 19:57:35 INFO  Start plan generation for analysis DataCorruption...
2022-09-21 19:57:35 INFO  ---RUNTIME: Plan generation took 0.4658699035644531 ms
2022-09-21 19:57:35 INFO  Estimated runtime of original DAG is 292.8466796875ms
2022-09-21 19:57:35 INFO  Performing Multi-Query Optimization
2022-09-21 19:57:35 INFO  Estimated unoptimized what-if runtime is 9371.09375ms
2022-09-21 19:57:35 INFO  Estimated optimised what-if runtime is 498.48365783691406ms
2022-09-21 19:57:35 INFO  Estimated optimisation runtime saving is 8872.610092163086ms
2022-09-21 19:57:35 INFO  ---RUNTIME: Multi-Query Optimization took 86.99893951416016 ms
2022-09-21 19:57:35 INFO  Executing generated plans
2022-09-21 19:57:36 INFO  ---RUNTIME: Execution took 1171.77152633667 ms
2022-09-21 19:57:36 INFO  Done!
2022-09-21 19:57:36 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-21 19:57:36 INFO  Running instrumented original pipeline...
2022-09-21 19:57:37 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-21 19:57:37 INFO  ---RUNTIME: Importing and monkey-patching took 5.663633346557617 ms
2022-09-21 19:57:38 INFO  ---RUNTIME: Original pipeline execution took 1687.0324611663818 ms (excluding imports and monkey-patching)
2022-09-21 19:57:38 INFO  Starting execution of 1 what-if analyses...
2022-09-21 19:57:38 INFO  Start plan generation for analysis DataCorruption...
2022-09-21 19:57:38 INFO  ---RUNTIME: Plan generation took 1.0044574737548828 ms
2022-09-21 19:57:38 INFO  Estimated runtime of original DAG is 288.56492042541504ms
2022-09-21 19:57:38 WARNING Skipping Multi-Query Optimization (instead, only applying patches)
2022-09-21 19:57:38 INFO  Estimated unoptimised what-if runtime is 9234.077453613281ms
2022-09-21 19:57:38 INFO  ---RUNTIME: Multi-Query Optimization took 21.35610580444336 ms
2022-09-21 19:57:38 INFO  Executing generated plans
2022-09-21 19:57:54 INFO  ---RUNTIME: Execution took 15385.948657989502 ms
2022-09-21 19:57:54 INFO  Done!
2022-09-21 19:57:54 INFO  # Finished -- repetition 3 of 7 
2022-09-21 19:57:54 INFO  # Optimization benchmark for data_corruption with args [['folktables', 'slow_loading', 'featurization_1', 'logistic_regression']] -- repetition 4 of 7
2022-09-21 19:57:54 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-21 19:57:54 INFO  Running instrumented original pipeline...
2022-09-21 19:57:54 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-21 19:57:54 INFO  ---RUNTIME: Importing and monkey-patching took 8.152484893798828 ms
2022-09-21 19:57:56 INFO  ---RUNTIME: Original pipeline execution took 2143.1264877319336 ms (excluding imports and monkey-patching)
2022-09-21 19:57:56 INFO  Starting execution of 1 what-if analyses...
2022-09-21 19:57:56 INFO  Start plan generation for analysis DataCorruption...
2022-09-21 19:57:56 INFO  ---RUNTIME: Plan generation took 0.7102489471435547 ms
2022-09-21 19:57:56 INFO  Estimated runtime of original DAG is 361.76252365112305ms
2022-09-21 19:57:56 INFO  Performing Multi-Query Optimization
2022-09-21 19:57:56 INFO  Estimated unoptimized what-if runtime is 11576.400756835938ms
2022-09-21 19:57:56 INFO  Estimated optimised what-if runtime is 631.9353580474854ms
2022-09-21 19:57:56 INFO  Estimated optimisation runtime saving is 10944.465398788452ms
2022-09-21 19:57:56 INFO  ---RUNTIME: Multi-Query Optimization took 130.99980354309082 ms
2022-09-21 19:57:56 INFO  Executing generated plans
2022-09-21 19:57:58 INFO  ---RUNTIME: Execution took 1997.7507591247559 ms
2022-09-21 19:57:58 INFO  Done!
2022-09-21 19:57:58 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-21 19:57:58 INFO  Running instrumented original pipeline...
2022-09-21 19:57:58 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-21 19:57:58 INFO  ---RUNTIME: Importing and monkey-patching took 7.631778717041016 ms
2022-09-21 19:58:00 INFO  ---RUNTIME: Original pipeline execution took 2170.2792644500732 ms (excluding imports and monkey-patching)
2022-09-21 19:58:00 INFO  Starting execution of 1 what-if analyses...
2022-09-21 19:58:00 INFO  Start plan generation for analysis DataCorruption...
2022-09-21 19:58:00 INFO  ---RUNTIME: Plan generation took 0.7936954498291016 ms
2022-09-21 19:58:00 INFO  Estimated runtime of original DAG is 383.12745094299316ms
2022-09-21 19:58:00 WARNING Skipping Multi-Query Optimization (instead, only applying patches)
2022-09-21 19:58:00 INFO  Estimated unoptimised what-if runtime is 12260.078430175781ms
2022-09-21 19:58:00 INFO  ---RUNTIME: Multi-Query Optimization took 34.76119041442871 ms
2022-09-21 19:58:00 INFO  Executing generated plans
2022-09-21 19:58:18 INFO  ---RUNTIME: Execution took 17622.275590896606 ms
2022-09-21 19:58:18 INFO  Done!
2022-09-21 19:58:18 INFO  # Finished -- repetition 4 of 7 
2022-09-21 19:58:18 INFO  # Optimization benchmark for data_corruption with args [['folktables', 'slow_loading', 'featurization_1', 'logistic_regression']] -- repetition 5 of 7
2022-09-21 19:58:18 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-21 19:58:18 INFO  Running instrumented original pipeline...
2022-09-21 19:58:18 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-21 19:58:18 INFO  ---RUNTIME: Importing and monkey-patching took 8.595466613769531 ms
2022-09-21 19:58:20 INFO  ---RUNTIME: Original pipeline execution took 2134.1044902801514 ms (excluding imports and monkey-patching)
2022-09-21 19:58:20 INFO  Starting execution of 1 what-if analyses...
2022-09-21 19:58:20 INFO  Start plan generation for analysis DataCorruption...
2022-09-21 19:58:20 INFO  ---RUNTIME: Plan generation took 0.6411075592041016 ms
2022-09-21 19:58:20 INFO  Estimated runtime of original DAG is 371.3362216949463ms
2022-09-21 19:58:20 INFO  Performing Multi-Query Optimization
2022-09-21 19:58:20 INFO  Estimated unoptimized what-if runtime is 11882.759094238281ms
2022-09-21 19:58:20 INFO  Estimated optimised what-if runtime is 634.8061561584473ms
2022-09-21 19:58:20 INFO  Estimated optimisation runtime saving is 11247.952938079834ms
2022-09-21 19:58:20 INFO  ---RUNTIME: Multi-Query Optimization took 131.28304481506348 ms
2022-09-21 19:58:20 INFO  Executing generated plans
2022-09-21 19:58:22 INFO  ---RUNTIME: Execution took 1526.6163349151611 ms
2022-09-21 19:58:22 INFO  Done!
2022-09-21 19:58:22 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-21 19:58:22 INFO  Running instrumented original pipeline...
2022-09-21 19:58:22 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-21 19:58:22 INFO  ---RUNTIME: Importing and monkey-patching took 9.997844696044922 ms
2022-09-21 19:58:24 INFO  ---RUNTIME: Original pipeline execution took 2132.608413696289 ms (excluding imports and monkey-patching)
2022-09-21 19:58:24 INFO  Starting execution of 1 what-if analyses...
2022-09-21 19:58:24 INFO  Start plan generation for analysis DataCorruption...
2022-09-21 19:58:24 INFO  ---RUNTIME: Plan generation took 0.5447864532470703 ms
2022-09-21 19:58:24 INFO  Estimated runtime of original DAG is 365.28897285461426ms
2022-09-21 19:58:24 WARNING Skipping Multi-Query Optimization (instead, only applying patches)
2022-09-21 19:58:24 INFO  Estimated unoptimised what-if runtime is 11689.247131347656ms
2022-09-21 19:58:24 INFO  ---RUNTIME: Multi-Query Optimization took 32.1650505065918 ms
2022-09-21 19:58:24 INFO  Executing generated plans
2022-09-21 19:58:41 INFO  ---RUNTIME: Execution took 16856.45818710327 ms
2022-09-21 19:58:41 INFO  Done!
2022-09-21 19:58:41 INFO  # Finished -- repetition 5 of 7 
2022-09-21 19:58:41 INFO  # Optimization benchmark for data_corruption with args [['folktables', 'slow_loading', 'featurization_1', 'logistic_regression']] -- repetition 6 of 7
2022-09-21 19:58:41 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-21 19:58:41 INFO  Running instrumented original pipeline...
2022-09-21 19:58:41 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-21 19:58:41 INFO  ---RUNTIME: Importing and monkey-patching took 7.760763168334961 ms
2022-09-21 19:58:43 INFO  ---RUNTIME: Original pipeline execution took 1948.7643241882324 ms (excluding imports and monkey-patching)
2022-09-21 19:58:43 INFO  Starting execution of 1 what-if analyses...
2022-09-21 19:58:43 INFO  Start plan generation for analysis DataCorruption...
2022-09-21 19:58:43 INFO  ---RUNTIME: Plan generation took 0.5834102630615234 ms
2022-09-21 19:58:43 INFO  Estimated runtime of original DAG is 351.3069152832031ms
2022-09-21 19:58:43 INFO  Performing Multi-Query Optimization
2022-09-21 19:58:43 INFO  Estimated unoptimized what-if runtime is 11241.8212890625ms
2022-09-21 19:58:43 INFO  Estimated optimised what-if runtime is 611.9909286499023ms
2022-09-21 19:58:43 INFO  Estimated optimisation runtime saving is 10629.830360412598ms
2022-09-21 19:58:43 INFO  ---RUNTIME: Multi-Query Optimization took 93.91975402832031 ms
2022-09-21 19:58:43 INFO  Executing generated plans
2022-09-21 19:58:44 INFO  ---RUNTIME: Execution took 1470.1099395751953 ms
2022-09-21 19:58:44 INFO  Done!
2022-09-21 19:58:44 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-21 19:58:44 INFO  Running instrumented original pipeline...
2022-09-21 19:58:44 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-21 19:58:44 INFO  ---RUNTIME: Importing and monkey-patching took 5.562067031860352 ms
2022-09-21 19:58:46 INFO  ---RUNTIME: Original pipeline execution took 1926.6166687011719 ms (excluding imports and monkey-patching)
2022-09-21 19:58:46 INFO  Starting execution of 1 what-if analyses...
2022-09-21 19:58:46 INFO  Start plan generation for analysis DataCorruption...
2022-09-21 19:58:46 INFO  ---RUNTIME: Plan generation took 0.5357265472412109 ms
2022-09-21 19:58:46 INFO  Estimated runtime of original DAG is 300.8384704589844ms
2022-09-21 19:58:46 WARNING Skipping Multi-Query Optimization (instead, only applying patches)
2022-09-21 19:58:46 INFO  Estimated unoptimised what-if runtime is 9626.8310546875ms
2022-09-21 19:58:46 INFO  ---RUNTIME: Multi-Query Optimization took 27.09817886352539 ms
2022-09-21 19:58:46 INFO  Executing generated plans
2022-09-21 19:59:02 INFO  ---RUNTIME: Execution took 15957.469701766968 ms
2022-09-21 19:59:02 INFO  Done!
2022-09-21 19:59:02 INFO  # Finished -- repetition 6 of 7 
2022-09-21 19:59:02 INFO  # Optimization benchmark for data_corruption with args [['folktables', 'slow_loading', 'featurization_1', 'logistic_regression']] -- repetition 7 of 7
2022-09-21 19:59:02 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-21 19:59:02 INFO  Running instrumented original pipeline...
2022-09-21 19:59:02 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-21 19:59:02 INFO  ---RUNTIME: Importing and monkey-patching took 8.211612701416016 ms
2022-09-21 19:59:04 INFO  ---RUNTIME: Original pipeline execution took 1981.696605682373 ms (excluding imports and monkey-patching)
2022-09-21 19:59:04 INFO  Starting execution of 1 what-if analyses...
2022-09-21 19:59:04 INFO  Start plan generation for analysis DataCorruption...
2022-09-21 19:59:04 INFO  ---RUNTIME: Plan generation took 0.46324729919433594 ms
2022-09-21 19:59:04 INFO  Estimated runtime of original DAG is 350.8455753326416ms
2022-09-21 19:59:04 INFO  Performing Multi-Query Optimization
2022-09-21 19:59:04 INFO  Estimated unoptimized what-if runtime is 11227.058410644531ms
2022-09-21 19:59:04 INFO  Estimated optimised what-if runtime is 589.7436141967773ms
2022-09-21 19:59:04 INFO  Estimated optimisation runtime saving is 10637.314796447754ms
2022-09-21 19:59:04 INFO  ---RUNTIME: Multi-Query Optimization took 87.3880386352539 ms
2022-09-21 19:59:04 INFO  Executing generated plans
2022-09-21 19:59:06 INFO  ---RUNTIME: Execution took 1522.6140022277832 ms
2022-09-21 19:59:06 INFO  Done!
2022-09-21 19:59:06 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-21 19:59:06 INFO  Running instrumented original pipeline...
2022-09-21 19:59:06 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-21 19:59:06 INFO  ---RUNTIME: Importing and monkey-patching took 5.5599212646484375 ms
2022-09-21 19:59:08 INFO  ---RUNTIME: Original pipeline execution took 1892.470359802246 ms (excluding imports and monkey-patching)
2022-09-21 19:59:08 INFO  Starting execution of 1 what-if analyses...
2022-09-21 19:59:08 INFO  Start plan generation for analysis DataCorruption...
2022-09-21 19:59:08 INFO  ---RUNTIME: Plan generation took 0.44536590576171875 ms
2022-09-21 19:59:08 INFO  Estimated runtime of original DAG is 319.3984031677246ms
2022-09-21 19:59:08 WARNING Skipping Multi-Query Optimization (instead, only applying patches)
2022-09-21 19:59:08 INFO  Estimated unoptimised what-if runtime is 10220.748901367188ms
2022-09-21 19:59:08 INFO  ---RUNTIME: Multi-Query Optimization took 22.38297462463379 ms
2022-09-21 19:59:08 INFO  Executing generated plans
2022-09-21 19:59:24 INFO  ---RUNTIME: Execution took 16696.393251419067 ms
2022-09-21 19:59:24 INFO  Done!
2022-09-21 19:59:24 INFO  # Finished -- repetition 7 of 7 
2022-09-21 19:59:24 INFO  # Final results after all repetitions
2022-09-21 19:59:24 INFO     repetition  ... no_opt_what_if_execution_combined_model_training
0           0  ...                                      2313.057661
1           1  ...                                      2273.818493
2           2  ...                                      2290.408373
3           3  ...                                      2606.020212
4           4  ...                                      2459.460258
5           5  ...                                      2346.359968
6           6  ...                                      2491.022348

[7 rows x 26 columns]
taskset -c 64-71 PROTOCOL_BUFFERS_PYTHON_IMPLEMENTATION=python python3.9 benchmarks_end_to_end.py data_corruption folktables slow_loading featurization_1 xgboost
2022-09-21 19:59:27.049733: W tensorflow/stream_executor/platform/default/dso_loader.cc:64] Could not load dynamic library 'libcudart.so.11.0'; dlerror: libcudart.so.11.0: cannot open shared object file: No such file or directory; LD_LIBRARY_PATH: /home/sgrafbe/mlwhatif/venv/lib/python3.9/site-packages/cv2/../../lib64:
2022-09-21 19:59:27.049772: I tensorflow/stream_executor/cuda/cudart_stub.cc:29] Ignore above cudart dlerror if you do not have a GPU set up on your machine.
2022-09-21 19:59:28 INFO  Patching sys.argv with ['mlwhatif', 'folktables', 'slow_loading', 'featurization_1', 'xgboost']
2022-09-21 19:59:28 INFO  Running instrumented original pipeline...
2022-09-21 19:59:28 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-21 19:59:28 INFO  ---RUNTIME: Importing and monkey-patching took 95.0922966003418 ms
2022-09-21 19:59:30 INFO  ---RUNTIME: Original pipeline execution took 2114.5408153533936 ms (excluding imports and monkey-patching)
2022-09-21 19:59:30 INFO  Starting execution of 0 what-if analyses...
2022-09-21 19:59:30 INFO  Estimated runtime of original DAG is 854.6090126037598ms
2022-09-21 19:59:30 INFO  Performing Multi-Query Optimization
2022-09-21 19:59:30 INFO  Estimated unoptimized what-if runtime is 0ms
2022-09-21 19:59:30 INFO  Estimated optimised what-if runtime is 0ms
2022-09-21 19:59:30 INFO  Estimated optimisation runtime saving is 0ms
2022-09-21 19:59:30 INFO  ---RUNTIME: Multi-Query Optimization took 0.6105899810791016 ms
2022-09-21 19:59:30 INFO  Executing generated plans
2022-09-21 19:59:30 INFO  ---RUNTIME: Execution took 0.01811981201171875 ms
2022-09-21 19:59:30 INFO  Done!
2022-09-21 19:59:30 INFO  # Optimization benchmark for data_corruption with args [['folktables', 'slow_loading', 'featurization_1', 'xgboost']] -- repetition 1 of 7
2022-09-21 19:59:30 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-21 19:59:30 INFO  Running instrumented original pipeline...
2022-09-21 19:59:30 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-21 19:59:30 INFO  ---RUNTIME: Importing and monkey-patching took 8.275508880615234 ms
2022-09-21 19:59:32 INFO  ---RUNTIME: Original pipeline execution took 2320.4853534698486 ms (excluding imports and monkey-patching)
2022-09-21 19:59:32 INFO  Starting execution of 1 what-if analyses...
2022-09-21 19:59:32 INFO  Start plan generation for analysis DataCorruption...
2022-09-21 19:59:32 INFO  ---RUNTIME: Plan generation took 0.4782676696777344 ms
2022-09-21 19:59:32 INFO  Estimated runtime of original DAG is 718.5935974121094ms
2022-09-21 19:59:32 INFO  Performing Multi-Query Optimization
2022-09-21 19:59:32 INFO  Estimated unoptimized what-if runtime is 22994.9951171875ms
2022-09-21 19:59:32 INFO  Estimated optimised what-if runtime is 1245.9399700164795ms
2022-09-21 19:59:32 INFO  Estimated optimisation runtime saving is 21749.05514717102ms
2022-09-21 19:59:32 INFO  ---RUNTIME: Multi-Query Optimization took 87.59427070617676 ms
2022-09-21 19:59:32 INFO  Executing generated plans
2022-09-21 19:59:35 INFO  ---RUNTIME: Execution took 2312.2401237487793 ms
2022-09-21 19:59:35 INFO  Done!
2022-09-21 19:59:35 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-21 19:59:35 INFO  Running instrumented original pipeline...
2022-09-21 19:59:35 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-21 19:59:35 INFO  ---RUNTIME: Importing and monkey-patching took 5.6056976318359375 ms
2022-09-21 19:59:37 INFO  ---RUNTIME: Original pipeline execution took 1822.3071098327637 ms (excluding imports and monkey-patching)
2022-09-21 19:59:37 INFO  Starting execution of 1 what-if analyses...
2022-09-21 19:59:37 INFO  Start plan generation for analysis DataCorruption...
2022-09-21 19:59:37 INFO  ---RUNTIME: Plan generation took 0.5376338958740234 ms
2022-09-21 19:59:37 INFO  Estimated runtime of original DAG is 611.3898754119873ms
2022-09-21 19:59:37 WARNING Skipping Multi-Query Optimization (instead, only applying patches)
2022-09-21 19:59:37 INFO  Estimated unoptimised what-if runtime is 19564.476013183594ms
2022-09-21 19:59:37 INFO  ---RUNTIME: Multi-Query Optimization took 22.39847183227539 ms
2022-09-21 19:59:37 INFO  Executing generated plans
2022-09-21 20:00:04 INFO  ---RUNTIME: Execution took 27637.13264465332 ms
2022-09-21 20:00:04 INFO  Done!
2022-09-21 20:00:04 INFO  # Finished -- repetition 1 of 7 
2022-09-21 20:00:04 INFO  # Optimization benchmark for data_corruption with args [['folktables', 'slow_loading', 'featurization_1', 'xgboost']] -- repetition 2 of 7
2022-09-21 20:00:04 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-21 20:00:04 INFO  Running instrumented original pipeline...
2022-09-21 20:00:04 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-21 20:00:04 INFO  ---RUNTIME: Importing and monkey-patching took 8.478403091430664 ms
2022-09-21 20:00:07 INFO  ---RUNTIME: Original pipeline execution took 2553.285837173462 ms (excluding imports and monkey-patching)
2022-09-21 20:00:07 INFO  Starting execution of 1 what-if analyses...
2022-09-21 20:00:07 INFO  Start plan generation for analysis DataCorruption...
2022-09-21 20:00:07 INFO  ---RUNTIME: Plan generation took 0.7166862487792969 ms
2022-09-21 20:00:07 INFO  Estimated runtime of original DAG is 781.1379432678223ms
2022-09-21 20:00:07 INFO  Performing Multi-Query Optimization
2022-09-21 20:00:07 INFO  Estimated unoptimized what-if runtime is 24996.414184570312ms
2022-09-21 20:00:07 INFO  Estimated optimised what-if runtime is 1396.2714672088623ms
2022-09-21 20:00:07 INFO  Estimated optimisation runtime saving is 23600.14271736145ms
2022-09-21 20:00:07 INFO  ---RUNTIME: Multi-Query Optimization took 130.57494163513184 ms
2022-09-21 20:00:07 INFO  Executing generated plans
2022-09-21 20:00:09 INFO  ---RUNTIME: Execution took 2326.920747756958 ms
2022-09-21 20:00:09 INFO  Done!
2022-09-21 20:00:09 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-21 20:00:09 INFO  Running instrumented original pipeline...
2022-09-21 20:00:09 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-21 20:00:09 INFO  ---RUNTIME: Importing and monkey-patching took 7.476091384887695 ms
2022-09-21 20:00:12 INFO  ---RUNTIME: Original pipeline execution took 2539.7415161132812 ms (excluding imports and monkey-patching)
2022-09-21 20:00:12 INFO  Starting execution of 1 what-if analyses...
2022-09-21 20:00:12 INFO  Start plan generation for analysis DataCorruption...
2022-09-21 20:00:12 INFO  ---RUNTIME: Plan generation took 0.5788803100585938 ms
2022-09-21 20:00:12 INFO  Estimated runtime of original DAG is 766.4847373962402ms
2022-09-21 20:00:12 WARNING Skipping Multi-Query Optimization (instead, only applying patches)
2022-09-21 20:00:12 INFO  Estimated unoptimised what-if runtime is 24527.511596679688ms
2022-09-21 20:00:12 INFO  ---RUNTIME: Multi-Query Optimization took 32.69362449645996 ms
2022-09-21 20:00:12 INFO  Executing generated plans
2022-09-21 20:00:42 INFO  ---RUNTIME: Execution took 29916.097402572632 ms
2022-09-21 20:00:42 INFO  Done!
2022-09-21 20:00:42 INFO  # Finished -- repetition 2 of 7 
2022-09-21 20:00:42 INFO  # Optimization benchmark for data_corruption with args [['folktables', 'slow_loading', 'featurization_1', 'xgboost']] -- repetition 3 of 7
2022-09-21 20:00:42 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-21 20:00:42 INFO  Running instrumented original pipeline...
2022-09-21 20:00:42 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-21 20:00:42 INFO  ---RUNTIME: Importing and monkey-patching took 8.449554443359375 ms
2022-09-21 20:00:44 INFO  ---RUNTIME: Original pipeline execution took 2332.775354385376 ms (excluding imports and monkey-patching)
2022-09-21 20:00:44 INFO  Starting execution of 1 what-if analyses...
2022-09-21 20:00:44 INFO  Start plan generation for analysis DataCorruption...
2022-09-21 20:00:44 INFO  ---RUNTIME: Plan generation took 0.4799365997314453 ms
2022-09-21 20:00:44 INFO  Estimated runtime of original DAG is 747.3440170288086ms
2022-09-21 20:00:44 INFO  Performing Multi-Query Optimization
2022-09-21 20:00:44 INFO  Estimated unoptimized what-if runtime is 23915.008544921875ms
2022-09-21 20:00:44 INFO  Estimated optimised what-if runtime is 1387.4776363372803ms
2022-09-21 20:00:44 INFO  Estimated optimisation runtime saving is 22527.530908584595ms
2022-09-21 20:00:44 INFO  ---RUNTIME: Multi-Query Optimization took 87.20588684082031 ms
2022-09-21 20:00:44 INFO  Executing generated plans
2022-09-21 20:00:46 INFO  ---RUNTIME: Execution took 2181.6728115081787 ms
2022-09-21 20:00:46 INFO  Done!
2022-09-21 20:00:46 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-21 20:00:46 INFO  Running instrumented original pipeline...
2022-09-21 20:00:47 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-21 20:00:47 INFO  ---RUNTIME: Importing and monkey-patching took 8.116006851196289 ms
2022-09-21 20:00:49 INFO  ---RUNTIME: Original pipeline execution took 2605.6768894195557 ms (excluding imports and monkey-patching)
2022-09-21 20:00:49 INFO  Starting execution of 1 what-if analyses...
2022-09-21 20:00:49 INFO  Start plan generation for analysis DataCorruption...
2022-09-21 20:00:49 INFO  ---RUNTIME: Plan generation took 0.9939670562744141 ms
2022-09-21 20:00:49 INFO  Estimated runtime of original DAG is 730.0808429718018ms
2022-09-21 20:00:49 WARNING Skipping Multi-Query Optimization (instead, only applying patches)
2022-09-21 20:00:49 INFO  Estimated unoptimised what-if runtime is 23362.586975097656ms
2022-09-21 20:00:49 INFO  ---RUNTIME: Multi-Query Optimization took 21.500110626220703 ms
2022-09-21 20:00:49 INFO  Executing generated plans
2022-09-21 20:01:17 INFO  ---RUNTIME: Execution took 27864.15719985962 ms
2022-09-21 20:01:17 INFO  Done!
2022-09-21 20:01:17 INFO  # Finished -- repetition 3 of 7 
2022-09-21 20:01:17 INFO  # Optimization benchmark for data_corruption with args [['folktables', 'slow_loading', 'featurization_1', 'xgboost']] -- repetition 4 of 7
2022-09-21 20:01:17 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-21 20:01:17 INFO  Running instrumented original pipeline...
2022-09-21 20:01:17 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-21 20:01:17 INFO  ---RUNTIME: Importing and monkey-patching took 8.113384246826172 ms
2022-09-21 20:01:19 INFO  ---RUNTIME: Original pipeline execution took 2398.8687992095947 ms (excluding imports and monkey-patching)
2022-09-21 20:01:19 INFO  Starting execution of 1 what-if analyses...
2022-09-21 20:01:19 INFO  Start plan generation for analysis DataCorruption...
2022-09-21 20:01:19 INFO  ---RUNTIME: Plan generation took 0.49877166748046875 ms
2022-09-21 20:01:19 INFO  Estimated runtime of original DAG is 750.4260540008545ms
2022-09-21 20:01:19 INFO  Performing Multi-Query Optimization
2022-09-21 20:01:19 INFO  Estimated unoptimized what-if runtime is 24013.633728027344ms
2022-09-21 20:01:19 INFO  Estimated optimised what-if runtime is 1290.1215553283691ms
2022-09-21 20:01:19 INFO  Estimated optimisation runtime saving is 22723.512172698975ms
2022-09-21 20:01:19 INFO  ---RUNTIME: Multi-Query Optimization took 87.8455638885498 ms
2022-09-21 20:01:19 INFO  Executing generated plans
2022-09-21 20:01:22 INFO  ---RUNTIME: Execution took 2168.545961380005 ms
2022-09-21 20:01:22 INFO  Done!
2022-09-21 20:01:22 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-21 20:01:22 INFO  Running instrumented original pipeline...
2022-09-21 20:01:22 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-21 20:01:22 INFO  ---RUNTIME: Importing and monkey-patching took 7.824182510375977 ms
2022-09-21 20:01:24 INFO  ---RUNTIME: Original pipeline execution took 2421.983003616333 ms (excluding imports and monkey-patching)
2022-09-21 20:01:24 INFO  Starting execution of 1 what-if analyses...
2022-09-21 20:01:24 INFO  Start plan generation for analysis DataCorruption...
2022-09-21 20:01:24 INFO  ---RUNTIME: Plan generation took 0.7216930389404297 ms
2022-09-21 20:01:24 INFO  Estimated runtime of original DAG is 761.1730098724365ms
2022-09-21 20:01:24 WARNING Skipping Multi-Query Optimization (instead, only applying patches)
2022-09-21 20:01:24 INFO  Estimated unoptimised what-if runtime is 24357.53631591797ms
2022-09-21 20:01:24 INFO  ---RUNTIME: Multi-Query Optimization took 31.48031234741211 ms
2022-09-21 20:01:24 INFO  Executing generated plans
2022-09-21 20:01:54 INFO  ---RUNTIME: Execution took 29560.163021087646 ms
2022-09-21 20:01:54 INFO  Done!
2022-09-21 20:01:54 INFO  # Finished -- repetition 4 of 7 
2022-09-21 20:01:54 INFO  # Optimization benchmark for data_corruption with args [['folktables', 'slow_loading', 'featurization_1', 'xgboost']] -- repetition 5 of 7
2022-09-21 20:01:54 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-21 20:01:54 INFO  Running instrumented original pipeline...
2022-09-21 20:01:54 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-21 20:01:54 INFO  ---RUNTIME: Importing and monkey-patching took 8.245468139648438 ms
2022-09-21 20:01:56 INFO  ---RUNTIME: Original pipeline execution took 2179.7890663146973 ms (excluding imports and monkey-patching)
2022-09-21 20:01:56 INFO  Starting execution of 1 what-if analyses...
2022-09-21 20:01:56 INFO  Start plan generation for analysis DataCorruption...
2022-09-21 20:01:56 INFO  ---RUNTIME: Plan generation took 0.4742145538330078 ms
2022-09-21 20:01:56 INFO  Estimated runtime of original DAG is 641.6068077087402ms
2022-09-21 20:01:56 INFO  Performing Multi-Query Optimization
2022-09-21 20:01:56 INFO  Estimated unoptimized what-if runtime is 20531.417846679688ms
2022-09-21 20:01:56 INFO  Estimated optimised what-if runtime is 1165.001392364502ms
2022-09-21 20:01:56 INFO  Estimated optimisation runtime saving is 19366.416454315186ms
2022-09-21 20:01:56 INFO  ---RUNTIME: Multi-Query Optimization took 87.47577667236328 ms
2022-09-21 20:01:56 INFO  Executing generated plans
2022-09-21 20:01:58 INFO  ---RUNTIME: Execution took 1779.4442176818848 ms
2022-09-21 20:01:58 INFO  Done!
2022-09-21 20:01:58 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-21 20:01:58 INFO  Running instrumented original pipeline...
2022-09-21 20:01:58 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-21 20:01:58 INFO  ---RUNTIME: Importing and monkey-patching took 5.603551864624023 ms
2022-09-21 20:01:59 INFO  ---RUNTIME: Original pipeline execution took 1815.6874179840088 ms (excluding imports and monkey-patching)
2022-09-21 20:01:59 INFO  Starting execution of 1 what-if analyses...
2022-09-21 20:01:59 INFO  Start plan generation for analysis DataCorruption...
2022-09-21 20:02:00 INFO  ---RUNTIME: Plan generation took 0.45943260192871094 ms
2022-09-21 20:02:00 INFO  Estimated runtime of original DAG is 610.7480525970459ms
2022-09-21 20:02:00 WARNING Skipping Multi-Query Optimization (instead, only applying patches)
2022-09-21 20:02:00 INFO  Estimated unoptimised what-if runtime is 19543.93768310547ms
2022-09-21 20:02:00 INFO  ---RUNTIME: Multi-Query Optimization took 21.98958396911621 ms
2022-09-21 20:02:00 INFO  Executing generated plans
2022-09-21 20:02:30 INFO  ---RUNTIME: Execution took 30610.376834869385 ms
2022-09-21 20:02:30 INFO  Done!
2022-09-21 20:02:30 INFO  # Finished -- repetition 5 of 7 
2022-09-21 20:02:30 INFO  # Optimization benchmark for data_corruption with args [['folktables', 'slow_loading', 'featurization_1', 'xgboost']] -- repetition 6 of 7
2022-09-21 20:02:30 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-21 20:02:30 INFO  Running instrumented original pipeline...
2022-09-21 20:02:30 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-21 20:02:30 INFO  ---RUNTIME: Importing and monkey-patching took 9.043216705322266 ms
2022-09-21 20:02:33 INFO  ---RUNTIME: Original pipeline execution took 2527.1573066711426 ms (excluding imports and monkey-patching)
2022-09-21 20:02:33 INFO  Starting execution of 1 what-if analyses...
2022-09-21 20:02:33 INFO  Start plan generation for analysis DataCorruption...
2022-09-21 20:02:33 INFO  ---RUNTIME: Plan generation took 0.7066726684570312 ms
2022-09-21 20:02:33 INFO  Estimated runtime of original DAG is 772.258996963501ms
2022-09-21 20:02:33 INFO  Performing Multi-Query Optimization
2022-09-21 20:02:33 INFO  Estimated unoptimized what-if runtime is 24712.28790283203ms
2022-09-21 20:02:33 INFO  Estimated optimised what-if runtime is 1384.78684425354ms
2022-09-21 20:02:33 INFO  Estimated optimisation runtime saving is 23327.50105857849ms
2022-09-21 20:02:33 INFO  ---RUNTIME: Multi-Query Optimization took 129.25148010253906 ms
2022-09-21 20:02:33 INFO  Executing generated plans
2022-09-21 20:02:35 INFO  ---RUNTIME: Execution took 2301.177740097046 ms
2022-09-21 20:02:35 INFO  Done!
2022-09-21 20:02:35 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-21 20:02:35 INFO  Running instrumented original pipeline...
2022-09-21 20:02:35 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-21 20:02:35 INFO  ---RUNTIME: Importing and monkey-patching took 7.862329483032227 ms
2022-09-21 20:02:38 INFO  ---RUNTIME: Original pipeline execution took 2577.0881175994873 ms (excluding imports and monkey-patching)
2022-09-21 20:02:38 INFO  Starting execution of 1 what-if analyses...
2022-09-21 20:02:38 INFO  Start plan generation for analysis DataCorruption...
2022-09-21 20:02:38 INFO  ---RUNTIME: Plan generation took 0.629425048828125 ms
2022-09-21 20:02:38 INFO  Estimated runtime of original DAG is 765.8944129943848ms
2022-09-21 20:02:38 WARNING Skipping Multi-Query Optimization (instead, only applying patches)
2022-09-21 20:02:38 INFO  Estimated unoptimised what-if runtime is 24508.621215820312ms
2022-09-21 20:02:38 INFO  ---RUNTIME: Multi-Query Optimization took 32.77444839477539 ms
2022-09-21 20:02:38 INFO  Executing generated plans
2022-09-21 20:03:06 INFO  ---RUNTIME: Execution took 28347.0356464386 ms
2022-09-21 20:03:06 INFO  Done!
2022-09-21 20:03:06 INFO  # Finished -- repetition 6 of 7 
2022-09-21 20:03:06 INFO  # Optimization benchmark for data_corruption with args [['folktables', 'slow_loading', 'featurization_1', 'xgboost']] -- repetition 7 of 7
2022-09-21 20:03:06 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-21 20:03:06 INFO  Running instrumented original pipeline...
2022-09-21 20:03:06 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-21 20:03:06 INFO  ---RUNTIME: Importing and monkey-patching took 5.936861038208008 ms
2022-09-21 20:03:08 INFO  ---RUNTIME: Original pipeline execution took 2230.6156158447266 ms (excluding imports and monkey-patching)
2022-09-21 20:03:08 INFO  Starting execution of 1 what-if analyses...
2022-09-21 20:03:08 INFO  Start plan generation for analysis DataCorruption...
2022-09-21 20:03:08 INFO  ---RUNTIME: Plan generation took 0.4703998565673828 ms
2022-09-21 20:03:08 INFO  Estimated runtime of original DAG is 635.1120471954346ms
2022-09-21 20:03:08 INFO  Performing Multi-Query Optimization
2022-09-21 20:03:08 INFO  Estimated unoptimized what-if runtime is 20323.585510253906ms
2022-09-21 20:03:08 INFO  Estimated optimised what-if runtime is 1194.1032409667969ms
2022-09-21 20:03:08 INFO  Estimated optimisation runtime saving is 19129.48226928711ms
2022-09-21 20:03:08 INFO  ---RUNTIME: Multi-Query Optimization took 87.25523948669434 ms
2022-09-21 20:03:08 INFO  Executing generated plans
2022-09-21 20:03:10 INFO  ---RUNTIME: Execution took 2066.9143199920654 ms
2022-09-21 20:03:10 INFO  Done!
2022-09-21 20:03:10 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-21 20:03:10 INFO  Running instrumented original pipeline...
2022-09-21 20:03:11 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-21 20:03:11 INFO  ---RUNTIME: Importing and monkey-patching took 5.597114562988281 ms
2022-09-21 20:03:12 INFO  ---RUNTIME: Original pipeline execution took 1964.9982452392578 ms (excluding imports and monkey-patching)
2022-09-21 20:03:12 INFO  Starting execution of 1 what-if analyses...
2022-09-21 20:03:12 INFO  Start plan generation for analysis DataCorruption...
2022-09-21 20:03:12 INFO  ---RUNTIME: Plan generation took 0.7870197296142578 ms
2022-09-21 20:03:12 INFO  Estimated runtime of original DAG is 734.5986366271973ms
2022-09-21 20:03:12 WARNING Skipping Multi-Query Optimization (instead, only applying patches)
2022-09-21 20:03:12 INFO  Estimated unoptimised what-if runtime is 23507.156372070312ms
2022-09-21 20:03:12 INFO  ---RUNTIME: Multi-Query Optimization took 33.62464904785156 ms
2022-09-21 20:03:12 INFO  Executing generated plans
2022-09-21 20:03:41 INFO  ---RUNTIME: Execution took 28721.355676651 ms
2022-09-21 20:03:41 INFO  Done!
2022-09-21 20:03:41 INFO  # Finished -- repetition 7 of 7 
2022-09-21 20:03:41 INFO  # Final results after all repetitions
2022-09-21 20:03:41 INFO     repetition  ... no_opt_what_if_execution_combined_model_training
0           0  ...                                     13906.132936
1           1  ...                                     14927.761793
2           2  ...                                     14109.628201
3           3  ...                                     16327.424049
4           4  ...                                     14991.905689
5           5  ...                                     14192.878485
6           6  ...                                     14354.707956

[7 rows x 26 columns]
taskset -c 64-71 PROTOCOL_BUFFERS_PYTHON_IMPLEMENTATION=python python3.9 benchmarks_end_to_end.py data_corruption folktables slow_loading featurization_1 neural_network
2022-09-21 20:03:43.860523: W tensorflow/stream_executor/platform/default/dso_loader.cc:64] Could not load dynamic library 'libcudart.so.11.0'; dlerror: libcudart.so.11.0: cannot open shared object file: No such file or directory; LD_LIBRARY_PATH: /home/sgrafbe/mlwhatif/venv/lib/python3.9/site-packages/cv2/../../lib64:
2022-09-21 20:03:43.860568: I tensorflow/stream_executor/cuda/cudart_stub.cc:29] Ignore above cudart dlerror if you do not have a GPU set up on your machine.
2022-09-21 20:03:45 INFO  Patching sys.argv with ['mlwhatif', 'folktables', 'slow_loading', 'featurization_1', 'neural_network']
2022-09-21 20:03:45 INFO  Running instrumented original pipeline...
2022-09-21 20:03:45 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-21 20:03:45 INFO  ---RUNTIME: Importing and monkey-patching took 130.51176071166992 ms
2022-09-21 20:03:47.022818: W tensorflow/stream_executor/platform/default/dso_loader.cc:64] Could not load dynamic library 'libcuda.so.1'; dlerror: libcuda.so.1: cannot open shared object file: No such file or directory; LD_LIBRARY_PATH: /home/sgrafbe/mlwhatif/venv/lib/python3.9/site-packages/cv2/../../lib64:
2022-09-21 20:03:47.022854: W tensorflow/stream_executor/cuda/cuda_driver.cc:326] failed call to cuInit: UNKNOWN ERROR (303)
2022-09-21 20:03:47.022873: I tensorflow/stream_executor/cuda/cuda_diagnostics.cc:156] kernel driver does not appear to be running on this host (wagyu): /proc/driver/nvidia/version does not exist
2022-09-21 20:03:47.023350: I tensorflow/core/platform/cpu_feature_guard.cc:142] This TensorFlow binary is optimized with oneAPI Deep Neural Network Library (oneDNN) to use the following CPU instructions in performance-critical operations:  AVX2 FMA
To enable them in other operations, rebuild TensorFlow with the appropriate compiler flags.
2022-09-21 20:03:47.588775: I tensorflow/compiler/mlir/mlir_graph_optimization_pass.cc:176] None of the MLIR Optimization Passes are enabled (registered 2)
2022-09-21 20:03:47.602367: I tensorflow/core/platform/profile_utils/cpu_utils.cc:114] CPU Frequency: 2595290000 Hz
2022-09-21 20:03:50 INFO  ---RUNTIME: Original pipeline execution took 5274.429082870483 ms (excluding imports and monkey-patching)
2022-09-21 20:03:50 INFO  Starting execution of 0 what-if analyses...
2022-09-21 20:03:50 INFO  Estimated runtime of original DAG is 3861.7031574249268ms
2022-09-21 20:03:50 INFO  Performing Multi-Query Optimization
2022-09-21 20:03:50 INFO  Estimated unoptimized what-if runtime is 0ms
2022-09-21 20:03:50 INFO  Estimated optimised what-if runtime is 0ms
2022-09-21 20:03:50 INFO  Estimated optimisation runtime saving is 0ms
2022-09-21 20:03:50 INFO  ---RUNTIME: Multi-Query Optimization took 0.4582405090332031 ms
2022-09-21 20:03:50 INFO  Executing generated plans
2022-09-21 20:03:50 INFO  ---RUNTIME: Execution took 0.015020370483398438 ms
2022-09-21 20:03:50 INFO  Done!
2022-09-21 20:03:50 INFO  # Optimization benchmark for data_corruption with args [['folktables', 'slow_loading', 'featurization_1', 'neural_network']] -- repetition 1 of 7
2022-09-21 20:03:50 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-21 20:03:50 INFO  Running instrumented original pipeline...
2022-09-21 20:03:50 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-21 20:03:50 INFO  ---RUNTIME: Importing and monkey-patching took 5.164861679077148 ms
2022-09-21 20:03:56 INFO  ---RUNTIME: Original pipeline execution took 5507.690191268921 ms (excluding imports and monkey-patching)
2022-09-21 20:03:56 INFO  Starting execution of 1 what-if analyses...
2022-09-21 20:03:56 INFO  Start plan generation for analysis DataCorruption...
2022-09-21 20:03:56 INFO  ---RUNTIME: Plan generation took 0.5135536193847656 ms
2022-09-21 20:03:56 INFO  Estimated runtime of original DAG is 4024.332284927368ms
2022-09-21 20:03:56 INFO  Performing Multi-Query Optimization
2022-09-21 20:03:56 INFO  Estimated unoptimized what-if runtime is 128778.63311767578ms
2022-09-21 20:03:56 INFO  Estimated optimised what-if runtime is 8886.743068695068ms
2022-09-21 20:03:56 INFO  Estimated optimisation runtime saving is 119891.89004898071ms
2022-09-21 20:03:56 INFO  ---RUNTIME: Multi-Query Optimization took 87.85295486450195 ms
2022-09-21 20:03:56 INFO  Executing generated plans
2022-09-21 20:04:04 INFO  ---RUNTIME: Execution took 8065.55438041687 ms
2022-09-21 20:04:04 INFO  Done!
2022-09-21 20:04:04 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-21 20:04:04 INFO  Running instrumented original pipeline...
2022-09-21 20:04:04 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-21 20:04:04 INFO  ---RUNTIME: Importing and monkey-patching took 8.048772811889648 ms
2022-09-21 20:04:10 INFO  ---RUNTIME: Original pipeline execution took 5904.802560806274 ms (excluding imports and monkey-patching)
2022-09-21 20:04:10 INFO  Starting execution of 1 what-if analyses...
2022-09-21 20:04:10 INFO  Start plan generation for analysis DataCorruption...
2022-09-21 20:04:10 INFO  ---RUNTIME: Plan generation took 0.47016143798828125 ms
2022-09-21 20:04:10 INFO  Estimated runtime of original DAG is 4181.244373321533ms
2022-09-21 20:04:10 WARNING Skipping Multi-Query Optimization (instead, only applying patches)
2022-09-21 20:04:10 INFO  Estimated unoptimised what-if runtime is 133799.81994628906ms
2022-09-21 20:04:10 INFO  ---RUNTIME: Multi-Query Optimization took 21.884679794311523 ms
2022-09-21 20:04:10 INFO  Executing generated plans
2022-09-21 20:06:43 INFO  ---RUNTIME: Execution took 153629.73594665527 ms
2022-09-21 20:06:43 INFO  Done!
2022-09-21 20:06:43 INFO  # Finished -- repetition 1 of 7 
2022-09-21 20:06:43 INFO  # Optimization benchmark for data_corruption with args [['folktables', 'slow_loading', 'featurization_1', 'neural_network']] -- repetition 2 of 7
2022-09-21 20:06:43 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-21 20:06:43 INFO  Running instrumented original pipeline...
2022-09-21 20:06:43 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-21 20:06:43 INFO  ---RUNTIME: Importing and monkey-patching took 8.904218673706055 ms
2022-09-21 20:06:50 INFO  ---RUNTIME: Original pipeline execution took 6680.602073669434 ms (excluding imports and monkey-patching)
2022-09-21 20:06:50 INFO  Starting execution of 1 what-if analyses...
2022-09-21 20:06:50 INFO  Start plan generation for analysis DataCorruption...
2022-09-21 20:06:50 INFO  ---RUNTIME: Plan generation took 0.7112026214599609 ms
2022-09-21 20:06:50 INFO  Estimated runtime of original DAG is 4885.676860809326ms
2022-09-21 20:06:50 INFO  Performing Multi-Query Optimization
2022-09-21 20:06:50 INFO  Estimated unoptimized what-if runtime is 156341.65954589844ms
2022-09-21 20:06:50 INFO  Estimated optimised what-if runtime is 11338.215589523315ms
2022-09-21 20:06:50 INFO  Estimated optimisation runtime saving is 145003.44395637512ms
2022-09-21 20:06:50 INFO  ---RUNTIME: Multi-Query Optimization took 131.58917427062988 ms
2022-09-21 20:06:50 INFO  Executing generated plans
2022-09-21 20:06:59 INFO  ---RUNTIME: Execution took 9151.803016662598 ms
2022-09-21 20:06:59 INFO  Done!
2022-09-21 20:06:59 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-21 20:06:59 INFO  Running instrumented original pipeline...
2022-09-21 20:06:59 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-21 20:06:59 INFO  ---RUNTIME: Importing and monkey-patching took 8.604049682617188 ms
2022-09-21 20:07:06 INFO  ---RUNTIME: Original pipeline execution took 6210.200071334839 ms (excluding imports and monkey-patching)
2022-09-21 20:07:06 INFO  Starting execution of 1 what-if analyses...
2022-09-21 20:07:06 INFO  Start plan generation for analysis DataCorruption...
2022-09-21 20:07:06 INFO  ---RUNTIME: Plan generation took 1.605987548828125 ms
2022-09-21 20:07:06 INFO  Estimated runtime of original DAG is 4522.8095054626465ms
2022-09-21 20:07:06 WARNING Skipping Multi-Query Optimization (instead, only applying patches)
2022-09-21 20:07:06 INFO  Estimated unoptimised what-if runtime is 144729.9041748047ms
2022-09-21 20:07:06 INFO  ---RUNTIME: Multi-Query Optimization took 32.21440315246582 ms
2022-09-21 20:07:06 INFO  Executing generated plans
2022-09-21 20:09:37 INFO  ---RUNTIME: Execution took 151023.7398147583 ms
2022-09-21 20:09:37 INFO  Done!
2022-09-21 20:09:37 INFO  # Finished -- repetition 2 of 7 
2022-09-21 20:09:37 INFO  # Optimization benchmark for data_corruption with args [['folktables', 'slow_loading', 'featurization_1', 'neural_network']] -- repetition 3 of 7
2022-09-21 20:09:37 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-21 20:09:37 INFO  Running instrumented original pipeline...
2022-09-21 20:09:37 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-21 20:09:37 INFO  ---RUNTIME: Importing and monkey-patching took 8.147478103637695 ms
2022-09-21 20:09:43 INFO  ---RUNTIME: Original pipeline execution took 6028.872013092041 ms (excluding imports and monkey-patching)
2022-09-21 20:09:43 INFO  Starting execution of 1 what-if analyses...
2022-09-21 20:09:43 INFO  Start plan generation for analysis DataCorruption...
2022-09-21 20:09:43 INFO  ---RUNTIME: Plan generation took 0.4925727844238281 ms
2022-09-21 20:09:43 INFO  Estimated runtime of original DAG is 3766.2298679351807ms
2022-09-21 20:09:43 INFO  Performing Multi-Query Optimization
2022-09-21 20:09:43 INFO  Estimated unoptimized what-if runtime is 120519.35577392578ms
2022-09-21 20:09:43 INFO  Estimated optimised what-if runtime is 8808.470726013184ms
2022-09-21 20:09:43 INFO  Estimated optimisation runtime saving is 111710.8850479126ms
2022-09-21 20:09:43 INFO  ---RUNTIME: Multi-Query Optimization took 89.20049667358398 ms
2022-09-21 20:09:43 INFO  Executing generated plans
2022-09-21 20:09:51 INFO  ---RUNTIME: Execution took 8482.6340675354 ms
2022-09-21 20:09:51 INFO  Done!
2022-09-21 20:09:51 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-21 20:09:51 INFO  Running instrumented original pipeline...
2022-09-21 20:09:51 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-21 20:09:51 INFO  ---RUNTIME: Importing and monkey-patching took 5.671977996826172 ms
2022-09-21 20:09:57 INFO  ---RUNTIME: Original pipeline execution took 5262.007474899292 ms (excluding imports and monkey-patching)
2022-09-21 20:09:57 INFO  Starting execution of 1 what-if analyses...
2022-09-21 20:09:57 INFO  Start plan generation for analysis DataCorruption...
2022-09-21 20:09:57 INFO  ---RUNTIME: Plan generation took 0.5176067352294922 ms
2022-09-21 20:09:57 INFO  Estimated runtime of original DAG is 3978.6341190338135ms
2022-09-21 20:09:57 WARNING Skipping Multi-Query Optimization (instead, only applying patches)
2022-09-21 20:09:57 INFO  Estimated unoptimised what-if runtime is 127316.29180908203ms
2022-09-21 20:09:57 INFO  ---RUNTIME: Multi-Query Optimization took 24.008989334106445 ms
2022-09-21 20:09:57 INFO  Executing generated plans
2022-09-21 20:12:12 INFO  ---RUNTIME: Execution took 135885.06317138672 ms
2022-09-21 20:12:12 INFO  Done!
2022-09-21 20:12:12 INFO  # Finished -- repetition 3 of 7 
2022-09-21 20:12:12 INFO  # Optimization benchmark for data_corruption with args [['folktables', 'slow_loading', 'featurization_1', 'neural_network']] -- repetition 4 of 7
2022-09-21 20:12:12 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-21 20:12:12 INFO  Running instrumented original pipeline...
2022-09-21 20:12:13 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-21 20:12:13 INFO  ---RUNTIME: Importing and monkey-patching took 6.568431854248047 ms
2022-09-21 20:12:18 INFO  ---RUNTIME: Original pipeline execution took 5366.173028945923 ms (excluding imports and monkey-patching)
2022-09-21 20:12:18 INFO  Starting execution of 1 what-if analyses...
2022-09-21 20:12:18 INFO  Start plan generation for analysis DataCorruption...
2022-09-21 20:12:18 INFO  ---RUNTIME: Plan generation took 0.5235671997070312 ms
2022-09-21 20:12:18 INFO  Estimated runtime of original DAG is 4110.225439071655ms
2022-09-21 20:12:18 INFO  Performing Multi-Query Optimization
2022-09-21 20:12:18 INFO  Estimated unoptimized what-if runtime is 131527.21405029297ms
2022-09-21 20:12:18 INFO  Estimated optimised what-if runtime is 9425.229787826538ms
2022-09-21 20:12:18 INFO  Estimated optimisation runtime saving is 122101.98426246643ms
2022-09-21 20:12:18 INFO  ---RUNTIME: Multi-Query Optimization took 491.28055572509766 ms
2022-09-21 20:12:18 INFO  Executing generated plans
2022-09-21 20:12:27 INFO  ---RUNTIME: Execution took 8478.261232376099 ms
2022-09-21 20:12:27 INFO  Done!
2022-09-21 20:12:27 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-21 20:12:27 INFO  Running instrumented original pipeline...
2022-09-21 20:12:27 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-21 20:12:27 INFO  ---RUNTIME: Importing and monkey-patching took 5.762338638305664 ms
2022-09-21 20:12:32 INFO  ---RUNTIME: Original pipeline execution took 5395.080804824829 ms (excluding imports and monkey-patching)
2022-09-21 20:12:32 INFO  Starting execution of 1 what-if analyses...
2022-09-21 20:12:32 INFO  Start plan generation for analysis DataCorruption...
2022-09-21 20:12:32 INFO  ---RUNTIME: Plan generation took 0.4963874816894531 ms
2022-09-21 20:12:32 INFO  Estimated runtime of original DAG is 4070.9047317504883ms
2022-09-21 20:12:32 WARNING Skipping Multi-Query Optimization (instead, only applying patches)
2022-09-21 20:12:32 INFO  Estimated unoptimised what-if runtime is 130268.95141601562ms
2022-09-21 20:12:32 INFO  ---RUNTIME: Multi-Query Optimization took 25.647878646850586 ms
2022-09-21 20:12:32 INFO  Executing generated plans
2022-09-21 20:14:47 INFO  ---RUNTIME: Execution took 135139.79578018188 ms
2022-09-21 20:14:47 INFO  Done!
2022-09-21 20:14:47 INFO  # Finished -- repetition 4 of 7 
2022-09-21 20:14:47 INFO  # Optimization benchmark for data_corruption with args [['folktables', 'slow_loading', 'featurization_1', 'neural_network']] -- repetition 5 of 7
2022-09-21 20:14:47 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-21 20:14:47 INFO  Running instrumented original pipeline...
2022-09-21 20:14:47 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-21 20:14:47 INFO  ---RUNTIME: Importing and monkey-patching took 6.580352783203125 ms
2022-09-21 20:14:53 INFO  ---RUNTIME: Original pipeline execution took 5304.8553466796875 ms (excluding imports and monkey-patching)
2022-09-21 20:14:53 INFO  Starting execution of 1 what-if analyses...
2022-09-21 20:14:53 INFO  Start plan generation for analysis DataCorruption...
2022-09-21 20:14:53 INFO  ---RUNTIME: Plan generation took 0.6361007690429688 ms
2022-09-21 20:14:53 INFO  Estimated runtime of original DAG is 4005.017042160034ms
2022-09-21 20:14:53 INFO  Performing Multi-Query Optimization
2022-09-21 20:14:53 INFO  Estimated unoptimized what-if runtime is 128160.5453491211ms
2022-09-21 20:14:53 INFO  Estimated optimised what-if runtime is 9461.116313934326ms
2022-09-21 20:14:53 INFO  Estimated optimisation runtime saving is 118699.42903518677ms
2022-09-21 20:14:53 INFO  ---RUNTIME: Multi-Query Optimization took 96.96340560913086 ms
2022-09-21 20:14:53 INFO  Executing generated plans
2022-09-21 20:15:01 INFO  ---RUNTIME: Execution took 8474.895000457764 ms
2022-09-21 20:15:01 INFO  Done!
2022-09-21 20:15:01 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-21 20:15:01 INFO  Running instrumented original pipeline...
2022-09-21 20:15:01 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-21 20:15:01 INFO  ---RUNTIME: Importing and monkey-patching took 5.98454475402832 ms
2022-09-21 20:15:07 INFO  ---RUNTIME: Original pipeline execution took 5412.975788116455 ms (excluding imports and monkey-patching)
2022-09-21 20:15:07 INFO  Starting execution of 1 what-if analyses...
2022-09-21 20:15:07 INFO  Start plan generation for analysis DataCorruption...
2022-09-21 20:15:07 INFO  ---RUNTIME: Plan generation took 0.5776882171630859 ms
2022-09-21 20:15:07 INFO  Estimated runtime of original DAG is 4107.327699661255ms
2022-09-21 20:15:07 WARNING Skipping Multi-Query Optimization (instead, only applying patches)
2022-09-21 20:15:07 INFO  Estimated unoptimised what-if runtime is 131434.48638916016ms
2022-09-21 20:15:07 INFO  ---RUNTIME: Multi-Query Optimization took 24.324655532836914 ms
2022-09-21 20:15:07 INFO  Executing generated plans
2022-09-21 20:17:24 INFO  ---RUNTIME: Execution took 136976.14312171936 ms
2022-09-21 20:17:24 INFO  Done!
2022-09-21 20:17:24 INFO  # Finished -- repetition 5 of 7 
2022-09-21 20:17:24 INFO  # Optimization benchmark for data_corruption with args [['folktables', 'slow_loading', 'featurization_1', 'neural_network']] -- repetition 6 of 7
2022-09-21 20:17:24 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-21 20:17:24 INFO  Running instrumented original pipeline...
2022-09-21 20:17:24 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-21 20:17:24 INFO  ---RUNTIME: Importing and monkey-patching took 5.785703659057617 ms
2022-09-21 20:17:29 INFO  ---RUNTIME: Original pipeline execution took 5356.302976608276 ms (excluding imports and monkey-patching)
2022-09-21 20:17:29 INFO  Starting execution of 1 what-if analyses...
2022-09-21 20:17:29 INFO  Start plan generation for analysis DataCorruption...
2022-09-21 20:17:29 INFO  ---RUNTIME: Plan generation took 0.5068778991699219 ms
2022-09-21 20:17:29 INFO  Estimated runtime of original DAG is 4060.291051864624ms
2022-09-21 20:17:29 INFO  Performing Multi-Query Optimization
2022-09-21 20:17:29 INFO  Estimated unoptimized what-if runtime is 129929.31365966797ms
2022-09-21 20:17:29 INFO  Estimated optimised what-if runtime is 9786.641120910645ms
2022-09-21 20:17:29 INFO  Estimated optimisation runtime saving is 120142.67253875732ms
2022-09-21 20:17:29 INFO  ---RUNTIME: Multi-Query Optimization took 93.65105628967285 ms
2022-09-21 20:17:29 INFO  Executing generated plans
2022-09-21 20:17:38 INFO  ---RUNTIME: Execution took 8494.716167449951 ms
2022-09-21 20:17:38 INFO  Done!
2022-09-21 20:17:38 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-21 20:17:38 INFO  Running instrumented original pipeline...
2022-09-21 20:17:38 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-21 20:17:38 INFO  ---RUNTIME: Importing and monkey-patching took 5.782604217529297 ms
2022-09-21 20:17:43 INFO  ---RUNTIME: Original pipeline execution took 5379.763126373291 ms (excluding imports and monkey-patching)
2022-09-21 20:17:43 INFO  Starting execution of 1 what-if analyses...
2022-09-21 20:17:43 INFO  Start plan generation for analysis DataCorruption...
2022-09-21 20:17:43 INFO  ---RUNTIME: Plan generation took 0.6842613220214844 ms
2022-09-21 20:17:43 INFO  Estimated runtime of original DAG is 4102.022409439087ms
2022-09-21 20:17:43 WARNING Skipping Multi-Query Optimization (instead, only applying patches)
2022-09-21 20:17:43 INFO  Estimated unoptimised what-if runtime is 131264.71710205078ms
2022-09-21 20:17:43 INFO  ---RUNTIME: Multi-Query Optimization took 30.581235885620117 ms
2022-09-21 20:17:43 INFO  Executing generated plans
2022-09-21 20:20:04 INFO  ---RUNTIME: Execution took 141125.0205039978 ms
2022-09-21 20:20:04 INFO  Done!
2022-09-21 20:20:04 INFO  # Finished -- repetition 6 of 7 
2022-09-21 20:20:04 INFO  # Optimization benchmark for data_corruption with args [['folktables', 'slow_loading', 'featurization_1', 'neural_network']] -- repetition 7 of 7
2022-09-21 20:20:04 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-21 20:20:04 INFO  Running instrumented original pipeline...
2022-09-21 20:20:04 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-21 20:20:04 INFO  ---RUNTIME: Importing and monkey-patching took 6.683826446533203 ms
2022-09-21 20:20:10 INFO  ---RUNTIME: Original pipeline execution took 5314.916133880615 ms (excluding imports and monkey-patching)
2022-09-21 20:20:10 INFO  Starting execution of 1 what-if analyses...
2022-09-21 20:20:10 INFO  Start plan generation for analysis DataCorruption...
2022-09-21 20:20:10 INFO  ---RUNTIME: Plan generation took 0.4889965057373047 ms
2022-09-21 20:20:10 INFO  Estimated runtime of original DAG is 4023.574113845825ms
2022-09-21 20:20:10 INFO  Performing Multi-Query Optimization
2022-09-21 20:20:10 INFO  Estimated unoptimized what-if runtime is 128754.3716430664ms
2022-09-21 20:20:10 INFO  Estimated optimised what-if runtime is 9607.545375823975ms
2022-09-21 20:20:10 INFO  Estimated optimisation runtime saving is 119146.82626724243ms
2022-09-21 20:20:10 INFO  ---RUNTIME: Multi-Query Optimization took 90.26908874511719 ms
2022-09-21 20:20:10 INFO  Executing generated plans
2022-09-21 20:20:18 INFO  ---RUNTIME: Execution took 8705.60622215271 ms
2022-09-21 20:20:18 INFO  Done!
2022-09-21 20:20:18 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-21 20:20:18 INFO  Running instrumented original pipeline...
2022-09-21 20:20:18 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-21 20:20:18 INFO  ---RUNTIME: Importing and monkey-patching took 6.462335586547852 ms
2022-09-21 20:20:24 INFO  ---RUNTIME: Original pipeline execution took 5467.864513397217 ms (excluding imports and monkey-patching)
2022-09-21 20:20:24 INFO  Starting execution of 1 what-if analyses...
2022-09-21 20:20:24 INFO  Start plan generation for analysis DataCorruption...
2022-09-21 20:20:24 INFO  ---RUNTIME: Plan generation took 0.5478858947753906 ms
2022-09-21 20:20:24 INFO  Estimated runtime of original DAG is 4188.338279724121ms
2022-09-21 20:20:24 WARNING Skipping Multi-Query Optimization (instead, only applying patches)
2022-09-21 20:20:24 INFO  Estimated unoptimised what-if runtime is 134026.82495117188ms
2022-09-21 20:20:24 INFO  ---RUNTIME: Multi-Query Optimization took 25.92921257019043 ms
2022-09-21 20:20:24 INFO  Executing generated plans
2022-09-21 20:22:39 INFO  ---RUNTIME: Execution took 135359.0919971466 ms
2022-09-21 20:22:39 INFO  Done!
2022-09-21 20:22:39 INFO  # Finished -- repetition 7 of 7 
2022-09-21 20:22:39 INFO  # Final results after all repetitions
2022-09-21 20:22:39 INFO     repetition  ... no_opt_what_if_execution_combined_model_training
0           0  ...                                    132525.504112
1           1  ...                                    131368.862391
2           2  ...                                    118174.056292
3           3  ...                                    117083.252907
4           4  ...                                    118956.069469
5           5  ...                                    117658.349991
6           6  ...                                    117481.174946

[7 rows x 26 columns]
taskset -c 64-71 PROTOCOL_BUFFERS_PYTHON_IMPLEMENTATION=python python3.9 benchmarks_end_to_end.py data_corruption folktables slow_loading featurization_2 logistic_regression
2022-09-21 20:22:42.418401: W tensorflow/stream_executor/platform/default/dso_loader.cc:64] Could not load dynamic library 'libcudart.so.11.0'; dlerror: libcudart.so.11.0: cannot open shared object file: No such file or directory; LD_LIBRARY_PATH: /home/sgrafbe/mlwhatif/venv/lib/python3.9/site-packages/cv2/../../lib64:
2022-09-21 20:22:42.418442: I tensorflow/stream_executor/cuda/cudart_stub.cc:29] Ignore above cudart dlerror if you do not have a GPU set up on your machine.
2022-09-21 20:22:43 INFO  Patching sys.argv with ['mlwhatif', 'folktables', 'slow_loading', 'featurization_2', 'logistic_regression']
2022-09-21 20:22:43 INFO  Running instrumented original pipeline...
2022-09-21 20:22:43 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-21 20:22:43 INFO  ---RUNTIME: Importing and monkey-patching took 104.61711883544922 ms
2022-09-21 20:22:45 INFO  ---RUNTIME: Original pipeline execution took 1349.905014038086 ms (excluding imports and monkey-patching)
2022-09-21 20:22:45 INFO  Starting execution of 0 what-if analyses...
2022-09-21 20:22:45 INFO  Estimated runtime of original DAG is 1071.0301399230957ms
2022-09-21 20:22:45 INFO  Performing Multi-Query Optimization
2022-09-21 20:22:45 INFO  Estimated unoptimized what-if runtime is 0ms
2022-09-21 20:22:45 INFO  Estimated optimised what-if runtime is 0ms
2022-09-21 20:22:45 INFO  Estimated optimisation runtime saving is 0ms
2022-09-21 20:22:45 INFO  ---RUNTIME: Multi-Query Optimization took 0.44846534729003906 ms
2022-09-21 20:22:45 INFO  Executing generated plans
2022-09-21 20:22:45 INFO  ---RUNTIME: Execution took 0.014543533325195312 ms
2022-09-21 20:22:45 INFO  Done!
2022-09-21 20:22:45 INFO  # Optimization benchmark for data_corruption with args [['folktables', 'slow_loading', 'featurization_2', 'logistic_regression']] -- repetition 1 of 7
2022-09-21 20:22:45 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-21 20:22:45 INFO  Running instrumented original pipeline...
2022-09-21 20:22:45 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-21 20:22:45 INFO  ---RUNTIME: Importing and monkey-patching took 5.201816558837891 ms
2022-09-21 20:22:46 INFO  ---RUNTIME: Original pipeline execution took 1299.3910312652588 ms (excluding imports and monkey-patching)
2022-09-21 20:22:46 INFO  Starting execution of 1 what-if analyses...
2022-09-21 20:22:46 INFO  Start plan generation for analysis DataCorruption...
2022-09-21 20:22:46 INFO  ---RUNTIME: Plan generation took 0.5364418029785156 ms
2022-09-21 20:22:46 INFO  Estimated runtime of original DAG is 1052.26731300354ms
2022-09-21 20:22:46 INFO  Performing Multi-Query Optimization
2022-09-21 20:22:46 INFO  Estimated unoptimized what-if runtime is 33672.55401611328ms
2022-09-21 20:22:46 INFO  Estimated optimised what-if runtime is 1209.0785503387451ms
2022-09-21 20:22:46 INFO  Estimated optimisation runtime saving is 32463.475465774536ms
2022-09-21 20:22:46 INFO  ---RUNTIME: Multi-Query Optimization took 90.42930603027344 ms
2022-09-21 20:22:46 INFO  Executing generated plans
2022-09-21 20:22:48 INFO  ---RUNTIME: Execution took 1940.274953842163 ms
2022-09-21 20:22:48 INFO  Done!
2022-09-21 20:22:48 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-21 20:22:48 INFO  Running instrumented original pipeline...
2022-09-21 20:22:48 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-21 20:22:48 INFO  ---RUNTIME: Importing and monkey-patching took 5.942821502685547 ms
2022-09-21 20:22:49 INFO  ---RUNTIME: Original pipeline execution took 1289.4845008850098 ms (excluding imports and monkey-patching)
2022-09-21 20:22:49 INFO  Starting execution of 1 what-if analyses...
2022-09-21 20:22:49 INFO  Start plan generation for analysis DataCorruption...
2022-09-21 20:22:49 INFO  ---RUNTIME: Plan generation took 0.54931640625 ms
2022-09-21 20:22:49 INFO  Estimated runtime of original DAG is 1043.4849262237549ms
2022-09-21 20:22:49 WARNING Skipping Multi-Query Optimization (instead, only applying patches)
2022-09-21 20:22:49 INFO  Estimated unoptimised what-if runtime is 33391.517639160156ms
2022-09-21 20:22:49 INFO  ---RUNTIME: Multi-Query Optimization took 22.893428802490234 ms
2022-09-21 20:22:49 INFO  Executing generated plans
2022-09-21 20:23:28 INFO  ---RUNTIME: Execution took 38172.635555267334 ms
2022-09-21 20:23:28 INFO  Done!
2022-09-21 20:23:28 INFO  # Finished -- repetition 1 of 7 
2022-09-21 20:23:28 INFO  # Optimization benchmark for data_corruption with args [['folktables', 'slow_loading', 'featurization_2', 'logistic_regression']] -- repetition 2 of 7
2022-09-21 20:23:28 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-21 20:23:28 INFO  Running instrumented original pipeline...
2022-09-21 20:23:28 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-21 20:23:28 INFO  ---RUNTIME: Importing and monkey-patching took 6.191015243530273 ms
2022-09-21 20:23:29 INFO  ---RUNTIME: Original pipeline execution took 1362.7855777740479 ms (excluding imports and monkey-patching)
2022-09-21 20:23:29 INFO  Starting execution of 1 what-if analyses...
2022-09-21 20:23:29 INFO  Start plan generation for analysis DataCorruption...
2022-09-21 20:23:29 INFO  ---RUNTIME: Plan generation took 0.5183219909667969 ms
2022-09-21 20:23:29 INFO  Estimated runtime of original DAG is 1103.6100387573242ms
2022-09-21 20:23:29 INFO  Performing Multi-Query Optimization
2022-09-21 20:23:29 INFO  Estimated unoptimized what-if runtime is 35315.521240234375ms
2022-09-21 20:23:29 INFO  Estimated optimised what-if runtime is 1257.965326309204ms
2022-09-21 20:23:29 INFO  Estimated optimisation runtime saving is 34057.55591392517ms
2022-09-21 20:23:29 INFO  ---RUNTIME: Multi-Query Optimization took 93.20473670959473 ms
2022-09-21 20:23:29 INFO  Executing generated plans
2022-09-21 20:23:31 INFO  ---RUNTIME: Execution took 1970.9370136260986 ms
2022-09-21 20:23:31 INFO  Done!
2022-09-21 20:23:31 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-21 20:23:31 INFO  Running instrumented original pipeline...
2022-09-21 20:23:31 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-21 20:23:31 INFO  ---RUNTIME: Importing and monkey-patching took 5.897045135498047 ms
2022-09-21 20:23:32 INFO  ---RUNTIME: Original pipeline execution took 1352.3914813995361 ms (excluding imports and monkey-patching)
2022-09-21 20:23:32 INFO  Starting execution of 1 what-if analyses...
2022-09-21 20:23:32 INFO  Start plan generation for analysis DataCorruption...
2022-09-21 20:23:32 INFO  ---RUNTIME: Plan generation took 0.499725341796875 ms
2022-09-21 20:23:32 INFO  Estimated runtime of original DAG is 1098.8872051239014ms
2022-09-21 20:23:32 WARNING Skipping Multi-Query Optimization (instead, only applying patches)
2022-09-21 20:23:32 INFO  Estimated unoptimised what-if runtime is 35164.390563964844ms
2022-09-21 20:23:32 INFO  ---RUNTIME: Multi-Query Optimization took 26.409626007080078 ms
2022-09-21 20:23:32 INFO  Executing generated plans
2022-09-21 20:24:11 INFO  ---RUNTIME: Execution took 38922.876834869385 ms
2022-09-21 20:24:11 INFO  Done!
2022-09-21 20:24:11 INFO  # Finished -- repetition 2 of 7 
2022-09-21 20:24:11 INFO  # Optimization benchmark for data_corruption with args [['folktables', 'slow_loading', 'featurization_2', 'logistic_regression']] -- repetition 3 of 7
2022-09-21 20:24:11 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-21 20:24:11 INFO  Running instrumented original pipeline...
2022-09-21 20:24:11 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-21 20:24:11 INFO  ---RUNTIME: Importing and monkey-patching took 6.680965423583984 ms
2022-09-21 20:24:13 INFO  ---RUNTIME: Original pipeline execution took 1328.1922340393066 ms (excluding imports and monkey-patching)
2022-09-21 20:24:13 INFO  Starting execution of 1 what-if analyses...
2022-09-21 20:24:13 INFO  Start plan generation for analysis DataCorruption...
2022-09-21 20:24:13 INFO  ---RUNTIME: Plan generation took 1.3532638549804688 ms
2022-09-21 20:24:13 INFO  Estimated runtime of original DAG is 1072.986364364624ms
2022-09-21 20:24:13 INFO  Performing Multi-Query Optimization
2022-09-21 20:24:13 INFO  Estimated unoptimized what-if runtime is 34335.56365966797ms
2022-09-21 20:24:13 INFO  Estimated optimised what-if runtime is 1237.1172904968262ms
2022-09-21 20:24:13 INFO  Estimated optimisation runtime saving is 33098.44636917114ms
2022-09-21 20:24:13 INFO  ---RUNTIME: Multi-Query Optimization took 94.43211555480957 ms
2022-09-21 20:24:13 INFO  Executing generated plans
2022-09-21 20:24:15 INFO  ---RUNTIME: Execution took 1903.6030769348145 ms
2022-09-21 20:24:15 INFO  Done!
2022-09-21 20:24:15 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-21 20:24:15 INFO  Running instrumented original pipeline...
2022-09-21 20:24:15 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-21 20:24:15 INFO  ---RUNTIME: Importing and monkey-patching took 6.3800811767578125 ms
2022-09-21 20:24:16 INFO  ---RUNTIME: Original pipeline execution took 1547.2815036773682 ms (excluding imports and monkey-patching)
2022-09-21 20:24:16 INFO  Starting execution of 1 what-if analyses...
2022-09-21 20:24:16 INFO  Start plan generation for analysis DataCorruption...
2022-09-21 20:24:16 INFO  ---RUNTIME: Plan generation took 0.5710124969482422 ms
2022-09-21 20:24:16 INFO  Estimated runtime of original DAG is 1089.6217823028564ms
2022-09-21 20:24:16 WARNING Skipping Multi-Query Optimization (instead, only applying patches)
2022-09-21 20:24:16 INFO  Estimated unoptimised what-if runtime is 34867.897033691406ms
2022-09-21 20:24:16 INFO  ---RUNTIME: Multi-Query Optimization took 24.495363235473633 ms
2022-09-21 20:24:16 INFO  Executing generated plans
2022-09-21 20:24:55 INFO  ---RUNTIME: Execution took 38451.404094696045 ms
2022-09-21 20:24:55 INFO  Done!
2022-09-21 20:24:55 INFO  # Finished -- repetition 3 of 7 
2022-09-21 20:24:55 INFO  # Optimization benchmark for data_corruption with args [['folktables', 'slow_loading', 'featurization_2', 'logistic_regression']] -- repetition 4 of 7
2022-09-21 20:24:55 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-21 20:24:55 INFO  Running instrumented original pipeline...
2022-09-21 20:24:55 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-21 20:24:55 INFO  ---RUNTIME: Importing and monkey-patching took 6.000041961669922 ms
2022-09-21 20:24:56 INFO  ---RUNTIME: Original pipeline execution took 1421.9238758087158 ms (excluding imports and monkey-patching)
2022-09-21 20:24:56 INFO  Starting execution of 1 what-if analyses...
2022-09-21 20:24:56 INFO  Start plan generation for analysis DataCorruption...
2022-09-21 20:24:56 INFO  ---RUNTIME: Plan generation took 0.5035400390625 ms
2022-09-21 20:24:56 INFO  Estimated runtime of original DAG is 1157.9391956329346ms
2022-09-21 20:24:56 INFO  Performing Multi-Query Optimization
2022-09-21 20:24:56 INFO  Estimated unoptimized what-if runtime is 37054.054260253906ms
2022-09-21 20:24:56 INFO  Estimated optimised what-if runtime is 1316.5030479431152ms
2022-09-21 20:24:56 INFO  Estimated optimisation runtime saving is 35737.55121231079ms
2022-09-21 20:24:56 INFO  ---RUNTIME: Multi-Query Optimization took 101.76372528076172 ms
2022-09-21 20:24:56 INFO  Executing generated plans
2022-09-21 20:24:58 INFO  ---RUNTIME: Execution took 1887.1276378631592 ms
2022-09-21 20:24:58 INFO  Done!
2022-09-21 20:24:58 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-21 20:24:58 INFO  Running instrumented original pipeline...
2022-09-21 20:24:58 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-21 20:24:58 INFO  ---RUNTIME: Importing and monkey-patching took 6.294727325439453 ms
2022-09-21 20:24:59 INFO  ---RUNTIME: Original pipeline execution took 1345.1857566833496 ms (excluding imports and monkey-patching)
2022-09-21 20:24:59 INFO  Starting execution of 1 what-if analyses...
2022-09-21 20:24:59 INFO  Start plan generation for analysis DataCorruption...
2022-09-21 20:24:59 INFO  ---RUNTIME: Plan generation took 0.49567222595214844 ms
2022-09-21 20:24:59 INFO  Estimated runtime of original DAG is 1089.3912315368652ms
2022-09-21 20:24:59 WARNING Skipping Multi-Query Optimization (instead, only applying patches)
2022-09-21 20:24:59 INFO  Estimated unoptimised what-if runtime is 34860.51940917969ms
2022-09-21 20:24:59 INFO  ---RUNTIME: Multi-Query Optimization took 25.497913360595703 ms
2022-09-21 20:24:59 INFO  Executing generated plans
2022-09-21 20:25:37 INFO  ---RUNTIME: Execution took 37725.08716583252 ms
2022-09-21 20:25:37 INFO  Done!
2022-09-21 20:25:37 INFO  # Finished -- repetition 4 of 7 
2022-09-21 20:25:37 INFO  # Optimization benchmark for data_corruption with args [['folktables', 'slow_loading', 'featurization_2', 'logistic_regression']] -- repetition 5 of 7
2022-09-21 20:25:37 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-21 20:25:37 INFO  Running instrumented original pipeline...
2022-09-21 20:25:37 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-21 20:25:37 INFO  ---RUNTIME: Importing and monkey-patching took 6.113529205322266 ms
2022-09-21 20:25:39 INFO  ---RUNTIME: Original pipeline execution took 1297.0259189605713 ms (excluding imports and monkey-patching)
2022-09-21 20:25:39 INFO  Starting execution of 1 what-if analyses...
2022-09-21 20:25:39 INFO  Start plan generation for analysis DataCorruption...
2022-09-21 20:25:39 INFO  ---RUNTIME: Plan generation took 0.5199909210205078 ms
2022-09-21 20:25:39 INFO  Estimated runtime of original DAG is 1042.1981811523438ms
2022-09-21 20:25:39 INFO  Performing Multi-Query Optimization
2022-09-21 20:25:39 INFO  Estimated unoptimized what-if runtime is 33350.341796875ms
2022-09-21 20:25:39 INFO  Estimated optimised what-if runtime is 1201.153039932251ms
2022-09-21 20:25:39 INFO  Estimated optimisation runtime saving is 32149.18875694275ms
2022-09-21 20:25:39 INFO  ---RUNTIME: Multi-Query Optimization took 90.82961082458496 ms
2022-09-21 20:25:39 INFO  Executing generated plans
2022-09-21 20:25:41 INFO  ---RUNTIME: Execution took 1915.1537418365479 ms
2022-09-21 20:25:41 INFO  Done!
2022-09-21 20:25:41 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-21 20:25:41 INFO  Running instrumented original pipeline...
2022-09-21 20:25:41 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-21 20:25:41 INFO  ---RUNTIME: Importing and monkey-patching took 6.707668304443359 ms
2022-09-21 20:25:42 INFO  ---RUNTIME: Original pipeline execution took 1371.1247444152832 ms (excluding imports and monkey-patching)
2022-09-21 20:25:42 INFO  Starting execution of 1 what-if analyses...
2022-09-21 20:25:42 INFO  Start plan generation for analysis DataCorruption...
2022-09-21 20:25:42 INFO  ---RUNTIME: Plan generation took 1.4204978942871094 ms
2022-09-21 20:25:42 INFO  Estimated runtime of original DAG is 1112.1811866760254ms
2022-09-21 20:25:42 WARNING Skipping Multi-Query Optimization (instead, only applying patches)
2022-09-21 20:25:42 INFO  Estimated unoptimised what-if runtime is 35589.79797363281ms
2022-09-21 20:25:42 INFO  ---RUNTIME: Multi-Query Optimization took 23.98204803466797 ms
2022-09-21 20:25:42 INFO  Executing generated plans
2022-09-21 20:26:20 INFO  ---RUNTIME: Execution took 38377.17127799988 ms
2022-09-21 20:26:20 INFO  Done!
2022-09-21 20:26:20 INFO  # Finished -- repetition 5 of 7 
2022-09-21 20:26:20 INFO  # Optimization benchmark for data_corruption with args [['folktables', 'slow_loading', 'featurization_2', 'logistic_regression']] -- repetition 6 of 7
2022-09-21 20:26:20 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-21 20:26:20 INFO  Running instrumented original pipeline...
2022-09-21 20:26:21 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-21 20:26:21 INFO  ---RUNTIME: Importing and monkey-patching took 6.253957748413086 ms
2022-09-21 20:26:22 INFO  ---RUNTIME: Original pipeline execution took 1573.7695693969727 ms (excluding imports and monkey-patching)
2022-09-21 20:26:22 INFO  Starting execution of 1 what-if analyses...
2022-09-21 20:26:22 INFO  Start plan generation for analysis DataCorruption...
2022-09-21 20:26:22 INFO  ---RUNTIME: Plan generation took 0.5681514739990234 ms
2022-09-21 20:26:22 INFO  Estimated runtime of original DAG is 1085.3674411773682ms
2022-09-21 20:26:22 INFO  Performing Multi-Query Optimization
2022-09-21 20:26:22 INFO  Estimated unoptimized what-if runtime is 34731.75811767578ms
2022-09-21 20:26:22 INFO  Estimated optimised what-if runtime is 1249.044418334961ms
2022-09-21 20:26:22 INFO  Estimated optimisation runtime saving is 33482.71369934082ms
2022-09-21 20:26:22 INFO  ---RUNTIME: Multi-Query Optimization took 100.97599029541016 ms
2022-09-21 20:26:22 INFO  Executing generated plans
2022-09-21 20:26:24 INFO  ---RUNTIME: Execution took 1935.2495670318604 ms
2022-09-21 20:26:24 INFO  Done!
2022-09-21 20:26:24 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-21 20:26:24 INFO  Running instrumented original pipeline...
2022-09-21 20:26:24 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-21 20:26:24 INFO  ---RUNTIME: Importing and monkey-patching took 6.176948547363281 ms
2022-09-21 20:26:25 INFO  ---RUNTIME: Original pipeline execution took 1457.0376873016357 ms (excluding imports and monkey-patching)
2022-09-21 20:26:25 INFO  Starting execution of 1 what-if analyses...
2022-09-21 20:26:25 INFO  Start plan generation for analysis DataCorruption...
2022-09-21 20:26:25 INFO  ---RUNTIME: Plan generation took 0.5609989166259766 ms
2022-09-21 20:26:25 INFO  Estimated runtime of original DAG is 1190.091848373413ms
2022-09-21 20:26:25 WARNING Skipping Multi-Query Optimization (instead, only applying patches)
2022-09-21 20:26:25 INFO  Estimated unoptimised what-if runtime is 38082.93914794922ms
2022-09-21 20:26:25 INFO  ---RUNTIME: Multi-Query Optimization took 24.375438690185547 ms
2022-09-21 20:26:25 INFO  Executing generated plans
2022-09-21 20:27:03 INFO  ---RUNTIME: Execution took 37999.247789382935 ms
2022-09-21 20:27:03 INFO  Done!
2022-09-21 20:27:03 INFO  # Finished -- repetition 6 of 7 
2022-09-21 20:27:03 INFO  # Optimization benchmark for data_corruption with args [['folktables', 'slow_loading', 'featurization_2', 'logistic_regression']] -- repetition 7 of 7
2022-09-21 20:27:03 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-21 20:27:03 INFO  Running instrumented original pipeline...
2022-09-21 20:27:03 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-21 20:27:03 INFO  ---RUNTIME: Importing and monkey-patching took 6.337165832519531 ms
2022-09-21 20:27:05 INFO  ---RUNTIME: Original pipeline execution took 1343.733549118042 ms (excluding imports and monkey-patching)
2022-09-21 20:27:05 INFO  Starting execution of 1 what-if analyses...
2022-09-21 20:27:05 INFO  Start plan generation for analysis DataCorruption...
2022-09-21 20:27:05 INFO  ---RUNTIME: Plan generation took 0.48422813415527344 ms
2022-09-21 20:27:05 INFO  Estimated runtime of original DAG is 1084.8419666290283ms
2022-09-21 20:27:05 INFO  Performing Multi-Query Optimization
2022-09-21 20:27:05 INFO  Estimated unoptimized what-if runtime is 34714.942932128906ms
2022-09-21 20:27:05 INFO  Estimated optimised what-if runtime is 1238.929271697998ms
2022-09-21 20:27:05 INFO  Estimated optimisation runtime saving is 33476.01366043091ms
2022-09-21 20:27:05 INFO  ---RUNTIME: Multi-Query Optimization took 90.07859230041504 ms
2022-09-21 20:27:05 INFO  Executing generated plans
2022-09-21 20:27:07 INFO  ---RUNTIME: Execution took 1848.5159873962402 ms
2022-09-21 20:27:07 INFO  Done!
2022-09-21 20:27:07 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-21 20:27:07 INFO  Running instrumented original pipeline...
2022-09-21 20:27:07 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-21 20:27:07 INFO  ---RUNTIME: Importing and monkey-patching took 5.545854568481445 ms
2022-09-21 20:27:08 INFO  ---RUNTIME: Original pipeline execution took 1281.5091609954834 ms (excluding imports and monkey-patching)
2022-09-21 20:27:08 INFO  Starting execution of 1 what-if analyses...
2022-09-21 20:27:08 INFO  Start plan generation for analysis DataCorruption...
2022-09-21 20:27:08 INFO  ---RUNTIME: Plan generation took 0.48351287841796875 ms
2022-09-21 20:27:08 INFO  Estimated runtime of original DAG is 1037.4119281768799ms
2022-09-21 20:27:08 WARNING Skipping Multi-Query Optimization (instead, only applying patches)
2022-09-21 20:27:08 INFO  Estimated unoptimised what-if runtime is 33197.181701660156ms
2022-09-21 20:27:08 INFO  ---RUNTIME: Multi-Query Optimization took 23.13065528869629 ms
2022-09-21 20:27:08 INFO  Executing generated plans
2022-09-21 20:27:46 INFO  ---RUNTIME: Execution took 37691.38503074646 ms
2022-09-21 20:27:46 INFO  Done!
2022-09-21 20:27:46 INFO  # Finished -- repetition 7 of 7 
2022-09-21 20:27:46 INFO  # Final results after all repetitions
2022-09-21 20:27:46 INFO     repetition  ... no_opt_what_if_execution_combined_model_training
0           0  ...                                      2161.985159
1           1  ...                                      2161.657095
2           2  ...                                      2167.049170
3           3  ...                                      2162.225008
4           4  ...                                      2145.695686
5           5  ...                                      2148.071527
6           6  ...                                      2172.363043

[7 rows x 26 columns]
taskset -c 64-71 PROTOCOL_BUFFERS_PYTHON_IMPLEMENTATION=python python3.9 benchmarks_end_to_end.py data_corruption folktables slow_loading featurization_2 xgboost
2022-09-21 20:27:50.438718: W tensorflow/stream_executor/platform/default/dso_loader.cc:64] Could not load dynamic library 'libcudart.so.11.0'; dlerror: libcudart.so.11.0: cannot open shared object file: No such file or directory; LD_LIBRARY_PATH: /home/sgrafbe/mlwhatif/venv/lib/python3.9/site-packages/cv2/../../lib64:
2022-09-21 20:27:50.438756: I tensorflow/stream_executor/cuda/cudart_stub.cc:29] Ignore above cudart dlerror if you do not have a GPU set up on your machine.
2022-09-21 20:27:52 INFO  Patching sys.argv with ['mlwhatif', 'folktables', 'slow_loading', 'featurization_2', 'xgboost']
2022-09-21 20:27:52 INFO  Running instrumented original pipeline...
2022-09-21 20:27:52 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-21 20:27:52 INFO  ---RUNTIME: Importing and monkey-patching took 146.2388038635254 ms
2022-09-21 20:27:54 INFO  ---RUNTIME: Original pipeline execution took 2263.561964035034 ms (excluding imports and monkey-patching)
2022-09-21 20:27:54 INFO  Starting execution of 0 what-if analyses...
2022-09-21 20:27:54 INFO  Estimated runtime of original DAG is 1939.3770694732666ms
2022-09-21 20:27:54 INFO  Performing Multi-Query Optimization
2022-09-21 20:27:54 INFO  Estimated unoptimized what-if runtime is 0ms
2022-09-21 20:27:54 INFO  Estimated optimised what-if runtime is 0ms
2022-09-21 20:27:54 INFO  Estimated optimisation runtime saving is 0ms
2022-09-21 20:27:54 INFO  ---RUNTIME: Multi-Query Optimization took 0.5443096160888672 ms
2022-09-21 20:27:54 INFO  Executing generated plans
2022-09-21 20:27:54 INFO  ---RUNTIME: Execution took 0.021457672119140625 ms
2022-09-21 20:27:54 INFO  Done!
2022-09-21 20:27:54 INFO  # Optimization benchmark for data_corruption with args [['folktables', 'slow_loading', 'featurization_2', 'xgboost']] -- repetition 1 of 7
2022-09-21 20:27:54 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-21 20:27:54 INFO  Running instrumented original pipeline...
2022-09-21 20:27:55 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-21 20:27:55 INFO  ---RUNTIME: Importing and monkey-patching took 6.23774528503418 ms
2022-09-21 20:27:56 INFO  ---RUNTIME: Original pipeline execution took 1727.9644012451172 ms (excluding imports and monkey-patching)
2022-09-21 20:27:56 INFO  Starting execution of 1 what-if analyses...
2022-09-21 20:27:56 INFO  Start plan generation for analysis DataCorruption...
2022-09-21 20:27:56 INFO  ---RUNTIME: Plan generation took 0.5743503570556641 ms
2022-09-21 20:27:56 INFO  Estimated runtime of original DAG is 1467.0073986053467ms
2022-09-21 20:27:56 INFO  Performing Multi-Query Optimization
2022-09-21 20:27:56 INFO  Estimated unoptimized what-if runtime is 46944.236755371094ms
2022-09-21 20:27:56 INFO  Estimated optimised what-if runtime is 2672.6763248443604ms
2022-09-21 20:27:56 INFO  Estimated optimisation runtime saving is 44271.56043052673ms
2022-09-21 20:27:56 INFO  ---RUNTIME: Multi-Query Optimization took 95.88813781738281 ms
2022-09-21 20:27:56 INFO  Executing generated plans
2022-09-21 20:27:59 INFO  ---RUNTIME: Execution took 2731.6112518310547 ms
2022-09-21 20:27:59 INFO  Done!
2022-09-21 20:27:59 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-21 20:27:59 INFO  Running instrumented original pipeline...
2022-09-21 20:27:59 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-21 20:27:59 INFO  ---RUNTIME: Importing and monkey-patching took 6.358861923217773 ms
2022-09-21 20:28:01 INFO  ---RUNTIME: Original pipeline execution took 1700.9594440460205 ms (excluding imports and monkey-patching)
2022-09-21 20:28:01 INFO  Starting execution of 1 what-if analyses...
2022-09-21 20:28:01 INFO  Start plan generation for analysis DataCorruption...
2022-09-21 20:28:01 INFO  ---RUNTIME: Plan generation took 0.5292892456054688 ms
2022-09-21 20:28:01 INFO  Estimated runtime of original DAG is 1413.1369590759277ms
2022-09-21 20:28:01 WARNING Skipping Multi-Query Optimization (instead, only applying patches)
2022-09-21 20:28:01 INFO  Estimated unoptimised what-if runtime is 45220.38269042969ms
2022-09-21 20:28:01 INFO  ---RUNTIME: Multi-Query Optimization took 22.998809814453125 ms
2022-09-21 20:28:01 INFO  Executing generated plans
2022-09-21 20:28:50 INFO  ---RUNTIME: Execution took 49461.69590950012 ms
2022-09-21 20:28:50 INFO  Done!
2022-09-21 20:28:50 INFO  # Finished -- repetition 1 of 7 
2022-09-21 20:28:50 INFO  # Optimization benchmark for data_corruption with args [['folktables', 'slow_loading', 'featurization_2', 'xgboost']] -- repetition 2 of 7
2022-09-21 20:28:50 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-21 20:28:50 INFO  Running instrumented original pipeline...
2022-09-21 20:28:50 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-21 20:28:50 INFO  ---RUNTIME: Importing and monkey-patching took 6.194114685058594 ms
2022-09-21 20:28:52 INFO  ---RUNTIME: Original pipeline execution took 1714.8816585540771 ms (excluding imports and monkey-patching)
2022-09-21 20:28:52 INFO  Starting execution of 1 what-if analyses...
2022-09-21 20:28:52 INFO  Start plan generation for analysis DataCorruption...
2022-09-21 20:28:52 INFO  ---RUNTIME: Plan generation took 0.6053447723388672 ms
2022-09-21 20:28:52 INFO  Estimated runtime of original DAG is 1463.3421897888184ms
2022-09-21 20:28:52 INFO  Performing Multi-Query Optimization
2022-09-21 20:28:52 INFO  Estimated unoptimized what-if runtime is 46826.95007324219ms
2022-09-21 20:28:52 INFO  Estimated optimised what-if runtime is 1969.703197479248ms
2022-09-21 20:28:52 INFO  Estimated optimisation runtime saving is 44857.24687576294ms
2022-09-21 20:28:52 INFO  ---RUNTIME: Multi-Query Optimization took 95.17455101013184 ms
2022-09-21 20:28:52 INFO  Executing generated plans
2022-09-21 20:28:55 INFO  ---RUNTIME: Execution took 2642.009973526001 ms
2022-09-21 20:28:55 INFO  Done!
2022-09-21 20:28:55 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-21 20:28:55 INFO  Running instrumented original pipeline...
2022-09-21 20:28:55 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-21 20:28:55 INFO  ---RUNTIME: Importing and monkey-patching took 8.833885192871094 ms
2022-09-21 20:28:56 INFO  ---RUNTIME: Original pipeline execution took 1767.6713466644287 ms (excluding imports and monkey-patching)
2022-09-21 20:28:56 INFO  Starting execution of 1 what-if analyses...
2022-09-21 20:28:56 INFO  Start plan generation for analysis DataCorruption...
2022-09-21 20:28:56 INFO  ---RUNTIME: Plan generation took 1.2748241424560547 ms
2022-09-21 20:28:56 INFO  Estimated runtime of original DAG is 1511.061191558838ms
2022-09-21 20:28:56 WARNING Skipping Multi-Query Optimization (instead, only applying patches)
2022-09-21 20:28:57 INFO  Estimated unoptimised what-if runtime is 48353.95812988281ms
2022-09-21 20:28:57 INFO  ---RUNTIME: Multi-Query Optimization took 23.324251174926758 ms
2022-09-21 20:28:57 INFO  Executing generated plans
2022-09-21 20:29:49 INFO  ---RUNTIME: Execution took 52559.46755409241 ms
2022-09-21 20:29:49 INFO  Done!
2022-09-21 20:29:49 INFO  # Finished -- repetition 2 of 7 
2022-09-21 20:29:49 INFO  # Optimization benchmark for data_corruption with args [['folktables', 'slow_loading', 'featurization_2', 'xgboost']] -- repetition 3 of 7
2022-09-21 20:29:49 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-21 20:29:49 INFO  Running instrumented original pipeline...
2022-09-21 20:29:49 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-21 20:29:49 INFO  ---RUNTIME: Importing and monkey-patching took 6.241798400878906 ms
2022-09-21 20:29:51 INFO  ---RUNTIME: Original pipeline execution took 1701.6558647155762 ms (excluding imports and monkey-patching)
2022-09-21 20:29:51 INFO  Starting execution of 1 what-if analyses...
2022-09-21 20:29:51 INFO  Start plan generation for analysis DataCorruption...
2022-09-21 20:29:51 INFO  ---RUNTIME: Plan generation took 0.6821155548095703 ms
2022-09-21 20:29:51 INFO  Estimated runtime of original DAG is 1441.2972927093506ms
2022-09-21 20:29:51 INFO  Performing Multi-Query Optimization
2022-09-21 20:29:51 INFO  Estimated unoptimized what-if runtime is 46121.51336669922ms
2022-09-21 20:29:51 INFO  Estimated optimised what-if runtime is 1960.8266353607178ms
2022-09-21 20:29:51 INFO  Estimated optimisation runtime saving is 44160.6867313385ms
2022-09-21 20:29:51 INFO  ---RUNTIME: Multi-Query Optimization took 92.26846694946289 ms
2022-09-21 20:29:51 INFO  Executing generated plans
2022-09-21 20:29:54 INFO  ---RUNTIME: Execution took 3575.5090713500977 ms
2022-09-21 20:29:54 INFO  Done!
2022-09-21 20:29:54 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-21 20:29:54 INFO  Running instrumented original pipeline...
2022-09-21 20:29:55 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-21 20:29:55 INFO  ---RUNTIME: Importing and monkey-patching took 7.622003555297852 ms
2022-09-21 20:29:56 INFO  ---RUNTIME: Original pipeline execution took 1883.3904266357422 ms (excluding imports and monkey-patching)
2022-09-21 20:29:56 INFO  Starting execution of 1 what-if analyses...
2022-09-21 20:29:56 INFO  Start plan generation for analysis DataCorruption...
2022-09-21 20:29:56 INFO  ---RUNTIME: Plan generation took 0.4391670227050781 ms
2022-09-21 20:29:56 INFO  Estimated runtime of original DAG is 1428.1048774719238ms
2022-09-21 20:29:56 WARNING Skipping Multi-Query Optimization (instead, only applying patches)
2022-09-21 20:29:56 INFO  Estimated unoptimised what-if runtime is 45699.35607910156ms
2022-09-21 20:29:56 INFO  ---RUNTIME: Multi-Query Optimization took 25.056838989257812 ms
2022-09-21 20:29:56 INFO  Executing generated plans
2022-09-21 20:30:45 INFO  ---RUNTIME: Execution took 48760.93316078186 ms
2022-09-21 20:30:45 INFO  Done!
2022-09-21 20:30:45 INFO  # Finished -- repetition 3 of 7 
2022-09-21 20:30:45 INFO  # Optimization benchmark for data_corruption with args [['folktables', 'slow_loading', 'featurization_2', 'xgboost']] -- repetition 4 of 7
2022-09-21 20:30:45 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-21 20:30:45 INFO  Running instrumented original pipeline...
2022-09-21 20:30:45 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-21 20:30:45 INFO  ---RUNTIME: Importing and monkey-patching took 5.975008010864258 ms
2022-09-21 20:30:47 INFO  ---RUNTIME: Original pipeline execution took 1790.940284729004 ms (excluding imports and monkey-patching)
2022-09-21 20:30:47 INFO  Starting execution of 1 what-if analyses...
2022-09-21 20:30:47 INFO  Start plan generation for analysis DataCorruption...
2022-09-21 20:30:47 INFO  ---RUNTIME: Plan generation took 0.5140304565429688 ms
2022-09-21 20:30:47 INFO  Estimated runtime of original DAG is 1539.7777557373047ms
2022-09-21 20:30:47 INFO  Performing Multi-Query Optimization
2022-09-21 20:30:47 INFO  Estimated unoptimized what-if runtime is 49272.88818359375ms
2022-09-21 20:30:47 INFO  Estimated optimised what-if runtime is 2090.17276763916ms
2022-09-21 20:30:47 INFO  Estimated optimisation runtime saving is 47182.71541595459ms
2022-09-21 20:30:47 INFO  ---RUNTIME: Multi-Query Optimization took 91.40729904174805 ms
2022-09-21 20:30:47 INFO  Executing generated plans
2022-09-21 20:30:50 INFO  ---RUNTIME: Execution took 2571.808099746704 ms
2022-09-21 20:30:50 INFO  Done!
2022-09-21 20:30:50 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-21 20:30:50 INFO  Running instrumented original pipeline...
2022-09-21 20:30:50 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-21 20:30:50 INFO  ---RUNTIME: Importing and monkey-patching took 5.60760498046875 ms
2022-09-21 20:30:51 INFO  ---RUNTIME: Original pipeline execution took 1696.8417167663574 ms (excluding imports and monkey-patching)
2022-09-21 20:30:51 INFO  Starting execution of 1 what-if analyses...
2022-09-21 20:30:51 INFO  Start plan generation for analysis DataCorruption...
2022-09-21 20:30:51 INFO  ---RUNTIME: Plan generation took 0.5609989166259766 ms
2022-09-21 20:30:51 INFO  Estimated runtime of original DAG is 1430.4299354553223ms
2022-09-21 20:30:51 WARNING Skipping Multi-Query Optimization (instead, only applying patches)
2022-09-21 20:30:51 INFO  Estimated unoptimised what-if runtime is 45773.75793457031ms
2022-09-21 20:30:51 INFO  ---RUNTIME: Multi-Query Optimization took 26.983022689819336 ms
2022-09-21 20:30:51 INFO  Executing generated plans
2022-09-21 20:31:47 INFO  ---RUNTIME: Execution took 56055.00626564026 ms
2022-09-21 20:31:47 INFO  Done!
2022-09-21 20:31:47 INFO  # Finished -- repetition 4 of 7 
2022-09-21 20:31:47 INFO  # Optimization benchmark for data_corruption with args [['folktables', 'slow_loading', 'featurization_2', 'xgboost']] -- repetition 5 of 7
2022-09-21 20:31:47 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-21 20:31:47 INFO  Running instrumented original pipeline...
2022-09-21 20:31:47 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-21 20:31:47 INFO  ---RUNTIME: Importing and monkey-patching took 7.694482803344727 ms
2022-09-21 20:31:49 INFO  ---RUNTIME: Original pipeline execution took 1681.8714141845703 ms (excluding imports and monkey-patching)
2022-09-21 20:31:49 INFO  Starting execution of 1 what-if analyses...
2022-09-21 20:31:49 INFO  Start plan generation for analysis DataCorruption...
2022-09-21 20:31:49 INFO  ---RUNTIME: Plan generation took 1.1682510375976562 ms
2022-09-21 20:31:49 INFO  Estimated runtime of original DAG is 1420.5482006072998ms
2022-09-21 20:31:49 INFO  Performing Multi-Query Optimization
2022-09-21 20:31:49 INFO  Estimated unoptimized what-if runtime is 45457.542419433594ms
2022-09-21 20:31:49 INFO  Estimated optimised what-if runtime is 1891.7653560638428ms
2022-09-21 20:31:49 INFO  Estimated optimisation runtime saving is 43565.77706336975ms
2022-09-21 20:31:49 INFO  ---RUNTIME: Multi-Query Optimization took 94.57516670227051 ms
2022-09-21 20:31:49 INFO  Executing generated plans
2022-09-21 20:31:52 INFO  ---RUNTIME: Execution took 2574.575185775757 ms
2022-09-21 20:31:52 INFO  Done!
2022-09-21 20:31:52 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-21 20:31:52 INFO  Running instrumented original pipeline...
2022-09-21 20:31:52 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-21 20:31:52 INFO  ---RUNTIME: Importing and monkey-patching took 6.099700927734375 ms
2022-09-21 20:31:53 INFO  ---RUNTIME: Original pipeline execution took 1685.3671073913574 ms (excluding imports and monkey-patching)
2022-09-21 20:31:53 INFO  Starting execution of 1 what-if analyses...
2022-09-21 20:31:53 INFO  Start plan generation for analysis DataCorruption...
2022-09-21 20:31:53 INFO  ---RUNTIME: Plan generation took 0.5066394805908203 ms
2022-09-21 20:31:53 INFO  Estimated runtime of original DAG is 1428.5194873809814ms
2022-09-21 20:31:53 WARNING Skipping Multi-Query Optimization (instead, only applying patches)
2022-09-21 20:31:53 INFO  Estimated unoptimised what-if runtime is 45712.623596191406ms
2022-09-21 20:31:53 INFO  ---RUNTIME: Multi-Query Optimization took 23.37169647216797 ms
2022-09-21 20:31:53 INFO  Executing generated plans
2022-09-21 20:32:44 INFO  ---RUNTIME: Execution took 50675.59361457825 ms
2022-09-21 20:32:44 INFO  Done!
2022-09-21 20:32:44 INFO  # Finished -- repetition 5 of 7 
2022-09-21 20:32:44 INFO  # Optimization benchmark for data_corruption with args [['folktables', 'slow_loading', 'featurization_2', 'xgboost']] -- repetition 6 of 7
2022-09-21 20:32:44 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-21 20:32:44 INFO  Running instrumented original pipeline...
2022-09-21 20:32:44 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-21 20:32:44 INFO  ---RUNTIME: Importing and monkey-patching took 6.470680236816406 ms
2022-09-21 20:32:46 INFO  ---RUNTIME: Original pipeline execution took 1890.4471397399902 ms (excluding imports and monkey-patching)
2022-09-21 20:32:46 INFO  Starting execution of 1 what-if analyses...
2022-09-21 20:32:46 INFO  Start plan generation for analysis DataCorruption...
2022-09-21 20:32:46 INFO  ---RUNTIME: Plan generation took 0.4787445068359375 ms
2022-09-21 20:32:46 INFO  Estimated runtime of original DAG is 1427.1111488342285ms
2022-09-21 20:32:46 INFO  Performing Multi-Query Optimization
2022-09-21 20:32:46 INFO  Estimated unoptimized what-if runtime is 45667.55676269531ms
2022-09-21 20:32:46 INFO  Estimated optimised what-if runtime is 1915.8880710601807ms
2022-09-21 20:32:46 INFO  Estimated optimisation runtime saving is 43751.66869163513ms
2022-09-21 20:32:46 INFO  ---RUNTIME: Multi-Query Optimization took 99.73573684692383 ms
2022-09-21 20:32:46 INFO  Executing generated plans
2022-09-21 20:32:49 INFO  ---RUNTIME: Execution took 2557.1625232696533 ms
2022-09-21 20:32:49 INFO  Done!
2022-09-21 20:32:49 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-21 20:32:49 INFO  Running instrumented original pipeline...
2022-09-21 20:32:49 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-21 20:32:49 INFO  ---RUNTIME: Importing and monkey-patching took 5.800724029541016 ms
2022-09-21 20:32:50 INFO  ---RUNTIME: Original pipeline execution took 1648.15092086792 ms (excluding imports and monkey-patching)
2022-09-21 20:32:50 INFO  Starting execution of 1 what-if analyses...
2022-09-21 20:32:50 INFO  Start plan generation for analysis DataCorruption...
2022-09-21 20:32:50 INFO  ---RUNTIME: Plan generation took 0.5433559417724609 ms
2022-09-21 20:32:50 INFO  Estimated runtime of original DAG is 1400.517463684082ms
2022-09-21 20:32:50 WARNING Skipping Multi-Query Optimization (instead, only applying patches)
2022-09-21 20:32:50 INFO  Estimated unoptimised what-if runtime is 44816.558837890625ms
2022-09-21 20:32:50 INFO  ---RUNTIME: Multi-Query Optimization took 26.361703872680664 ms
2022-09-21 20:32:50 INFO  Executing generated plans
2022-09-21 20:33:42 INFO  ---RUNTIME: Execution took 51237.96558380127 ms
2022-09-21 20:33:42 INFO  Done!
2022-09-21 20:33:42 INFO  # Finished -- repetition 6 of 7 
2022-09-21 20:33:42 INFO  # Optimization benchmark for data_corruption with args [['folktables', 'slow_loading', 'featurization_2', 'xgboost']] -- repetition 7 of 7
2022-09-21 20:33:42 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-21 20:33:42 INFO  Running instrumented original pipeline...
2022-09-21 20:33:42 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-21 20:33:42 INFO  ---RUNTIME: Importing and monkey-patching took 6.362199783325195 ms
2022-09-21 20:33:43 INFO  ---RUNTIME: Original pipeline execution took 1666.1481857299805 ms (excluding imports and monkey-patching)
2022-09-21 20:33:43 INFO  Starting execution of 1 what-if analyses...
2022-09-21 20:33:43 INFO  Start plan generation for analysis DataCorruption...
2022-09-21 20:33:43 INFO  ---RUNTIME: Plan generation took 0.5705356597900391 ms
2022-09-21 20:33:43 INFO  Estimated runtime of original DAG is 1415.2007102966309ms
2022-09-21 20:33:43 INFO  Performing Multi-Query Optimization
2022-09-21 20:33:43 INFO  Estimated unoptimized what-if runtime is 45286.42272949219ms
2022-09-21 20:33:43 INFO  Estimated optimised what-if runtime is 1885.8821392059326ms
2022-09-21 20:33:43 INFO  Estimated optimisation runtime saving is 43400.540590286255ms
2022-09-21 20:33:43 INFO  ---RUNTIME: Multi-Query Optimization took 100.21734237670898 ms
2022-09-21 20:33:43 INFO  Executing generated plans
2022-09-21 20:33:46 INFO  ---RUNTIME: Execution took 2570.0693130493164 ms
2022-09-21 20:33:46 INFO  Done!
2022-09-21 20:33:46 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-21 20:33:46 INFO  Running instrumented original pipeline...
2022-09-21 20:33:46 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-21 20:33:46 INFO  ---RUNTIME: Importing and monkey-patching took 6.347179412841797 ms
2022-09-21 20:33:48 INFO  ---RUNTIME: Original pipeline execution took 1638.1821632385254 ms (excluding imports and monkey-patching)
2022-09-21 20:33:48 INFO  Starting execution of 1 what-if analyses...
2022-09-21 20:33:48 INFO  Start plan generation for analysis DataCorruption...
2022-09-21 20:33:48 INFO  ---RUNTIME: Plan generation took 1.3420581817626953 ms
2022-09-21 20:33:48 INFO  Estimated runtime of original DAG is 1380.505084991455ms
2022-09-21 20:33:48 WARNING Skipping Multi-Query Optimization (instead, only applying patches)
2022-09-21 20:33:48 INFO  Estimated unoptimised what-if runtime is 44176.16271972656ms
2022-09-21 20:33:48 INFO  ---RUNTIME: Multi-Query Optimization took 22.742271423339844 ms
2022-09-21 20:33:48 INFO  Executing generated plans
2022-09-21 20:34:39 INFO  ---RUNTIME: Execution took 51674.553632736206 ms
2022-09-21 20:34:39 INFO  Done!
2022-09-21 20:34:39 INFO  # Finished -- repetition 7 of 7 
2022-09-21 20:34:39 INFO  # Final results after all repetitions
2022-09-21 20:34:39 INFO     repetition  ... no_opt_what_if_execution_combined_model_training
0           0  ...                                     12889.448643
1           1  ...                                     16054.443836
2           2  ...                                     12613.587141
3           3  ...                                     20005.974054
4           4  ...                                     14350.987434
5           5  ...                                     15040.988445
6           6  ...                                     15301.387310

[7 rows x 26 columns]
taskset -c 64-71 PROTOCOL_BUFFERS_PYTHON_IMPLEMENTATION=python python3.9 benchmarks_end_to_end.py data_corruption folktables slow_loading featurization_2 neural_network
2022-09-21 20:34:41.974631: W tensorflow/stream_executor/platform/default/dso_loader.cc:64] Could not load dynamic library 'libcudart.so.11.0'; dlerror: libcudart.so.11.0: cannot open shared object file: No such file or directory; LD_LIBRARY_PATH: /home/sgrafbe/mlwhatif/venv/lib/python3.9/site-packages/cv2/../../lib64:
2022-09-21 20:34:41.974669: I tensorflow/stream_executor/cuda/cudart_stub.cc:29] Ignore above cudart dlerror if you do not have a GPU set up on your machine.
2022-09-21 20:34:43 INFO  Patching sys.argv with ['mlwhatif', 'folktables', 'slow_loading', 'featurization_2', 'neural_network']
2022-09-21 20:34:43 INFO  Running instrumented original pipeline...
2022-09-21 20:34:43 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-21 20:34:43 INFO  ---RUNTIME: Importing and monkey-patching took 104.26020622253418 ms
2022-09-21 20:34:44.747863: W tensorflow/stream_executor/platform/default/dso_loader.cc:64] Could not load dynamic library 'libcuda.so.1'; dlerror: libcuda.so.1: cannot open shared object file: No such file or directory; LD_LIBRARY_PATH: /home/sgrafbe/mlwhatif/venv/lib/python3.9/site-packages/cv2/../../lib64:
2022-09-21 20:34:44.747898: W tensorflow/stream_executor/cuda/cuda_driver.cc:326] failed call to cuInit: UNKNOWN ERROR (303)
2022-09-21 20:34:44.747916: I tensorflow/stream_executor/cuda/cuda_diagnostics.cc:156] kernel driver does not appear to be running on this host (wagyu): /proc/driver/nvidia/version does not exist
2022-09-21 20:34:44.748283: I tensorflow/core/platform/cpu_feature_guard.cc:142] This TensorFlow binary is optimized with oneAPI Deep Neural Network Library (oneDNN) to use the following CPU instructions in performance-critical operations:  AVX2 FMA
To enable them in other operations, rebuild TensorFlow with the appropriate compiler flags.
2022-09-21 20:34:45.327901: I tensorflow/compiler/mlir/mlir_graph_optimization_pass.cc:176] None of the MLIR Optimization Passes are enabled (registered 2)
2022-09-21 20:34:45.342374: I tensorflow/core/platform/profile_utils/cpu_utils.cc:114] CPU Frequency: 2595290000 Hz
2022-09-21 20:34:48 INFO  ---RUNTIME: Original pipeline execution took 5478.246688842773 ms (excluding imports and monkey-patching)
2022-09-21 20:34:48 INFO  Starting execution of 0 what-if analyses...
2022-09-21 20:34:48 INFO  Estimated runtime of original DAG is 5197.08776473999ms
2022-09-21 20:34:48 INFO  Performing Multi-Query Optimization
2022-09-21 20:34:48 INFO  Estimated unoptimized what-if runtime is 0ms
2022-09-21 20:34:48 INFO  Estimated optimised what-if runtime is 0ms
2022-09-21 20:34:48 INFO  Estimated optimisation runtime saving is 0ms
2022-09-21 20:34:48 INFO  ---RUNTIME: Multi-Query Optimization took 0.6291866302490234 ms
2022-09-21 20:34:48 INFO  Executing generated plans
2022-09-21 20:34:48 INFO  ---RUNTIME: Execution took 0.028848648071289062 ms
2022-09-21 20:34:48 INFO  Done!
2022-09-21 20:34:48 INFO  # Optimization benchmark for data_corruption with args [['folktables', 'slow_loading', 'featurization_2', 'neural_network']] -- repetition 1 of 7
2022-09-21 20:34:48 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-21 20:34:48 INFO  Running instrumented original pipeline...
2022-09-21 20:34:48 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-21 20:34:48 INFO  ---RUNTIME: Importing and monkey-patching took 6.190299987792969 ms
2022-09-21 20:34:54 INFO  ---RUNTIME: Original pipeline execution took 5106.9488525390625 ms (excluding imports and monkey-patching)
2022-09-21 20:34:54 INFO  Starting execution of 1 what-if analyses...
2022-09-21 20:34:54 INFO  Start plan generation for analysis DataCorruption...
2022-09-21 20:34:54 INFO  ---RUNTIME: Plan generation took 0.5741119384765625 ms
2022-09-21 20:34:54 INFO  Estimated runtime of original DAG is 4845.684289932251ms
2022-09-21 20:34:54 INFO  Performing Multi-Query Optimization
2022-09-21 20:34:54 INFO  Estimated unoptimized what-if runtime is 155061.89727783203ms
2022-09-21 20:34:54 INFO  Estimated optimised what-if runtime is 9598.932266235352ms
2022-09-21 20:34:54 INFO  Estimated optimisation runtime saving is 145462.96501159668ms
2022-09-21 20:34:54 INFO  ---RUNTIME: Multi-Query Optimization took 97.59688377380371 ms
2022-09-21 20:34:54 INFO  Executing generated plans
2022-09-21 20:35:02 INFO  ---RUNTIME: Execution took 8664.013147354126 ms
2022-09-21 20:35:02 INFO  Done!
2022-09-21 20:35:02 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-21 20:35:02 INFO  Running instrumented original pipeline...
2022-09-21 20:35:02 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-21 20:35:02 INFO  ---RUNTIME: Importing and monkey-patching took 6.451129913330078 ms
2022-09-21 20:35:08 INFO  ---RUNTIME: Original pipeline execution took 5352.489471435547 ms (excluding imports and monkey-patching)
2022-09-21 20:35:08 INFO  Starting execution of 1 what-if analyses...
2022-09-21 20:35:08 INFO  Start plan generation for analysis DataCorruption...
2022-09-21 20:35:08 INFO  ---RUNTIME: Plan generation took 0.5793571472167969 ms
2022-09-21 20:35:08 INFO  Estimated runtime of original DAG is 5100.0776290893555ms
2022-09-21 20:35:08 WARNING Skipping Multi-Query Optimization (instead, only applying patches)
2022-09-21 20:35:08 INFO  Estimated unoptimised what-if runtime is 163202.48413085938ms
2022-09-21 20:35:08 INFO  ---RUNTIME: Multi-Query Optimization took 26.433467864990234 ms
2022-09-21 20:35:08 INFO  Executing generated plans
2022-09-21 20:37:49 INFO  ---RUNTIME: Execution took 161132.01189041138 ms
2022-09-21 20:37:49 INFO  Done!
2022-09-21 20:37:49 INFO  # Finished -- repetition 1 of 7 
2022-09-21 20:37:49 INFO  # Optimization benchmark for data_corruption with args [['folktables', 'slow_loading', 'featurization_2', 'neural_network']] -- repetition 2 of 7
2022-09-21 20:37:49 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-21 20:37:49 INFO  Running instrumented original pipeline...
2022-09-21 20:37:49 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-21 20:37:49 INFO  ---RUNTIME: Importing and monkey-patching took 5.776166915893555 ms
2022-09-21 20:37:54 INFO  ---RUNTIME: Original pipeline execution took 5489.021778106689 ms (excluding imports and monkey-patching)
2022-09-21 20:37:54 INFO  Starting execution of 1 what-if analyses...
2022-09-21 20:37:54 INFO  Start plan generation for analysis DataCorruption...
2022-09-21 20:37:54 INFO  ---RUNTIME: Plan generation took 0.5037784576416016 ms
2022-09-21 20:37:54 INFO  Estimated runtime of original DAG is 4892.746925354004ms
2022-09-21 20:37:54 INFO  Performing Multi-Query Optimization
2022-09-21 20:37:54 INFO  Estimated unoptimized what-if runtime is 156567.90161132812ms
2022-09-21 20:37:54 INFO  Estimated optimised what-if runtime is 10401.668310165405ms
2022-09-21 20:37:54 INFO  Estimated optimisation runtime saving is 146166.23330116272ms
2022-09-21 20:37:54 INFO  ---RUNTIME: Multi-Query Optimization took 98.40679168701172 ms
2022-09-21 20:37:54 INFO  Executing generated plans
2022-09-21 20:38:03 INFO  ---RUNTIME: Execution took 9054.037809371948 ms
2022-09-21 20:38:03 INFO  Done!
2022-09-21 20:38:03 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-21 20:38:03 INFO  Running instrumented original pipeline...
2022-09-21 20:38:03 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-21 20:38:03 INFO  ---RUNTIME: Importing and monkey-patching took 5.889892578125 ms
2022-09-21 20:38:09 INFO  ---RUNTIME: Original pipeline execution took 5055.1698207855225 ms (excluding imports and monkey-patching)
2022-09-21 20:38:09 INFO  Starting execution of 1 what-if analyses...
2022-09-21 20:38:09 INFO  Start plan generation for analysis DataCorruption...
2022-09-21 20:38:09 INFO  ---RUNTIME: Plan generation took 0.48422813415527344 ms
2022-09-21 20:38:09 INFO  Estimated runtime of original DAG is 4805.5572509765625ms
2022-09-21 20:38:09 WARNING Skipping Multi-Query Optimization (instead, only applying patches)
2022-09-21 20:38:09 INFO  Estimated unoptimised what-if runtime is 153777.83203125ms
2022-09-21 20:38:09 INFO  ---RUNTIME: Multi-Query Optimization took 22.8579044342041 ms
2022-09-21 20:38:09 INFO  Executing generated plans
2022-09-21 20:40:43 INFO  ---RUNTIME: Execution took 154248.40354919434 ms
2022-09-21 20:40:43 INFO  Done!
2022-09-21 20:40:43 INFO  # Finished -- repetition 2 of 7 
2022-09-21 20:40:43 INFO  # Optimization benchmark for data_corruption with args [['folktables', 'slow_loading', 'featurization_2', 'neural_network']] -- repetition 3 of 7
2022-09-21 20:40:43 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-21 20:40:43 INFO  Running instrumented original pipeline...
2022-09-21 20:40:43 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-21 20:40:43 INFO  ---RUNTIME: Importing and monkey-patching took 5.759239196777344 ms
2022-09-21 20:40:48 INFO  ---RUNTIME: Original pipeline execution took 5149.609088897705 ms (excluding imports and monkey-patching)
2022-09-21 20:40:48 INFO  Starting execution of 1 what-if analyses...
2022-09-21 20:40:48 INFO  Start plan generation for analysis DataCorruption...
2022-09-21 20:40:48 INFO  ---RUNTIME: Plan generation took 0.5159378051757812 ms
2022-09-21 20:40:48 INFO  Estimated runtime of original DAG is 4551.5711307525635ms
2022-09-21 20:40:48 INFO  Performing Multi-Query Optimization
2022-09-21 20:40:48 INFO  Estimated unoptimized what-if runtime is 145650.27618408203ms
2022-09-21 20:40:48 INFO  Estimated optimised what-if runtime is 10024.415493011475ms
2022-09-21 20:40:48 INFO  Estimated optimisation runtime saving is 135625.86069107056ms
2022-09-21 20:40:48 INFO  ---RUNTIME: Multi-Query Optimization took 109.7409725189209 ms
2022-09-21 20:40:48 INFO  Executing generated plans
2022-09-21 20:40:56 INFO  ---RUNTIME: Execution took 8284.457206726074 ms
2022-09-21 20:40:56 INFO  Done!
2022-09-21 20:40:56 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-21 20:40:56 INFO  Running instrumented original pipeline...
2022-09-21 20:40:56 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-21 20:40:56 INFO  ---RUNTIME: Importing and monkey-patching took 5.556821823120117 ms
2022-09-21 20:41:01 INFO  ---RUNTIME: Original pipeline execution took 4703.253269195557 ms (excluding imports and monkey-patching)
2022-09-21 20:41:01 INFO  Starting execution of 1 what-if analyses...
2022-09-21 20:41:01 INFO  Start plan generation for analysis DataCorruption...
2022-09-21 20:41:01 INFO  ---RUNTIME: Plan generation took 1.5039443969726562 ms
2022-09-21 20:41:01 INFO  Estimated runtime of original DAG is 4460.4949951171875ms
2022-09-21 20:41:01 WARNING Skipping Multi-Query Optimization (instead, only applying patches)
2022-09-21 20:41:01 INFO  Estimated unoptimised what-if runtime is 142735.83984375ms
2022-09-21 20:41:01 INFO  ---RUNTIME: Multi-Query Optimization took 22.5830078125 ms
2022-09-21 20:41:01 INFO  Executing generated plans
2022-09-21 20:43:29 INFO  ---RUNTIME: Execution took 148124.9783039093 ms
2022-09-21 20:43:29 INFO  Done!
2022-09-21 20:43:29 INFO  # Finished -- repetition 3 of 7 
2022-09-21 20:43:29 INFO  # Optimization benchmark for data_corruption with args [['folktables', 'slow_loading', 'featurization_2', 'neural_network']] -- repetition 4 of 7
2022-09-21 20:43:29 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-21 20:43:29 INFO  Running instrumented original pipeline...
2022-09-21 20:43:29 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-21 20:43:29 INFO  ---RUNTIME: Importing and monkey-patching took 5.656242370605469 ms
2022-09-21 20:43:34 INFO  ---RUNTIME: Original pipeline execution took 5082.939386367798 ms (excluding imports and monkey-patching)
2022-09-21 20:43:34 INFO  Starting execution of 1 what-if analyses...
2022-09-21 20:43:34 INFO  Start plan generation for analysis DataCorruption...
2022-09-21 20:43:34 INFO  ---RUNTIME: Plan generation took 0.507354736328125 ms
2022-09-21 20:43:34 INFO  Estimated runtime of original DAG is 4834.887742996216ms
2022-09-21 20:43:34 INFO  Performing Multi-Query Optimization
2022-09-21 20:43:34 INFO  Estimated unoptimized what-if runtime is 154716.4077758789ms
2022-09-21 20:43:34 INFO  Estimated optimised what-if runtime is 9784.98363494873ms
2022-09-21 20:43:34 INFO  Estimated optimisation runtime saving is 144931.42414093018ms
2022-09-21 20:43:34 INFO  ---RUNTIME: Multi-Query Optimization took 90.8660888671875 ms
2022-09-21 20:43:34 INFO  Executing generated plans
2022-09-21 20:43:43 INFO  ---RUNTIME: Execution took 8564.81409072876 ms
2022-09-21 20:43:43 INFO  Done!
2022-09-21 20:43:43 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-21 20:43:43 INFO  Running instrumented original pipeline...
2022-09-21 20:43:43 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-21 20:43:43 INFO  ---RUNTIME: Importing and monkey-patching took 5.732536315917969 ms
2022-09-21 20:43:48 INFO  ---RUNTIME: Original pipeline execution took 4747.81346321106 ms (excluding imports and monkey-patching)
2022-09-21 20:43:48 INFO  Starting execution of 1 what-if analyses...
2022-09-21 20:43:48 INFO  Start plan generation for analysis DataCorruption...
2022-09-21 20:43:48 INFO  ---RUNTIME: Plan generation took 0.4982948303222656 ms
2022-09-21 20:43:48 INFO  Estimated runtime of original DAG is 4503.6561489105225ms
2022-09-21 20:43:48 WARNING Skipping Multi-Query Optimization (instead, only applying patches)
2022-09-21 20:43:48 INFO  Estimated unoptimised what-if runtime is 144116.99676513672ms
2022-09-21 20:43:48 INFO  ---RUNTIME: Multi-Query Optimization took 22.870779037475586 ms
2022-09-21 20:43:48 INFO  Executing generated plans
2022-09-21 20:46:28 INFO  ---RUNTIME: Execution took 160338.8590812683 ms
2022-09-21 20:46:28 INFO  Done!
2022-09-21 20:46:28 INFO  # Finished -- repetition 4 of 7 
2022-09-21 20:46:28 INFO  # Optimization benchmark for data_corruption with args [['folktables', 'slow_loading', 'featurization_2', 'neural_network']] -- repetition 5 of 7
2022-09-21 20:46:28 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-21 20:46:28 INFO  Running instrumented original pipeline...
2022-09-21 20:46:28 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-21 20:46:28 INFO  ---RUNTIME: Importing and monkey-patching took 5.745172500610352 ms
2022-09-21 20:46:33 INFO  ---RUNTIME: Original pipeline execution took 5129.849672317505 ms (excluding imports and monkey-patching)
2022-09-21 20:46:33 INFO  Starting execution of 1 what-if analyses...
2022-09-21 20:46:33 INFO  Start plan generation for analysis DataCorruption...
2022-09-21 20:46:33 INFO  ---RUNTIME: Plan generation took 0.5407333374023438 ms
2022-09-21 20:46:33 INFO  Estimated runtime of original DAG is 4879.191637039185ms
2022-09-21 20:46:33 INFO  Performing Multi-Query Optimization
2022-09-21 20:46:33 INFO  Estimated unoptimized what-if runtime is 156134.1323852539ms
2022-09-21 20:46:33 INFO  Estimated optimised what-if runtime is 10762.346267700195ms
2022-09-21 20:46:33 INFO  Estimated optimisation runtime saving is 145371.7861175537ms
2022-09-21 20:46:33 INFO  ---RUNTIME: Multi-Query Optimization took 122.1323013305664 ms
2022-09-21 20:46:33 INFO  Executing generated plans
2022-09-21 20:46:42 INFO  ---RUNTIME: Execution took 9118.825674057007 ms
2022-09-21 20:46:42 INFO  Done!
2022-09-21 20:46:42 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-21 20:46:42 INFO  Running instrumented original pipeline...
2022-09-21 20:46:43 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-21 20:46:43 INFO  ---RUNTIME: Importing and monkey-patching took 7.265329360961914 ms
2022-09-21 20:46:49 INFO  ---RUNTIME: Original pipeline execution took 6288.589715957642 ms (excluding imports and monkey-patching)
2022-09-21 20:46:49 INFO  Starting execution of 1 what-if analyses...
2022-09-21 20:46:49 INFO  Start plan generation for analysis DataCorruption...
2022-09-21 20:46:49 INFO  ---RUNTIME: Plan generation took 0.6215572357177734 ms
2022-09-21 20:46:49 INFO  Estimated runtime of original DAG is 5987.29944229126ms
2022-09-21 20:46:49 WARNING Skipping Multi-Query Optimization (instead, only applying patches)
2022-09-21 20:46:49 INFO  Estimated unoptimised what-if runtime is 191593.5821533203ms
2022-09-21 20:46:49 INFO  ---RUNTIME: Multi-Query Optimization took 29.40678596496582 ms
2022-09-21 20:46:49 INFO  Executing generated plans
2022-09-21 20:49:32 INFO  ---RUNTIME: Execution took 163026.44801139832 ms
2022-09-21 20:49:32 INFO  Done!
2022-09-21 20:49:32 INFO  # Finished -- repetition 5 of 7 
2022-09-21 20:49:32 INFO  # Optimization benchmark for data_corruption with args [['folktables', 'slow_loading', 'featurization_2', 'neural_network']] -- repetition 6 of 7
2022-09-21 20:49:32 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-21 20:49:32 INFO  Running instrumented original pipeline...
2022-09-21 20:49:32 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-21 20:49:32 INFO  ---RUNTIME: Importing and monkey-patching took 7.118463516235352 ms
2022-09-21 20:49:37 INFO  ---RUNTIME: Original pipeline execution took 5098.5894203186035 ms (excluding imports and monkey-patching)
2022-09-21 20:49:37 INFO  Starting execution of 1 what-if analyses...
2022-09-21 20:49:37 INFO  Start plan generation for analysis DataCorruption...
2022-09-21 20:49:37 INFO  ---RUNTIME: Plan generation took 0.5028247833251953 ms
2022-09-21 20:49:37 INFO  Estimated runtime of original DAG is 4837.048530578613ms
2022-09-21 20:49:37 INFO  Performing Multi-Query Optimization
2022-09-21 20:49:37 INFO  Estimated unoptimized what-if runtime is 154785.55297851562ms
2022-09-21 20:49:37 INFO  Estimated optimised what-if runtime is 9780.27868270874ms
2022-09-21 20:49:37 INFO  Estimated optimisation runtime saving is 145005.27429580688ms
2022-09-21 20:49:37 INFO  ---RUNTIME: Multi-Query Optimization took 538.3460521697998 ms
2022-09-21 20:49:37 INFO  Executing generated plans
2022-09-21 20:49:46 INFO  ---RUNTIME: Execution took 8652.168273925781 ms
2022-09-21 20:49:46 INFO  Done!
2022-09-21 20:49:46 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-21 20:49:46 INFO  Running instrumented original pipeline...
2022-09-21 20:49:46 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-21 20:49:46 INFO  ---RUNTIME: Importing and monkey-patching took 5.834341049194336 ms
2022-09-21 20:49:52 INFO  ---RUNTIME: Original pipeline execution took 5414.978981018066 ms (excluding imports and monkey-patching)
2022-09-21 20:49:52 INFO  Starting execution of 1 what-if analyses...
2022-09-21 20:49:52 INFO  Start plan generation for analysis DataCorruption...
2022-09-21 20:49:52 INFO  ---RUNTIME: Plan generation took 0.7183551788330078 ms
2022-09-21 20:49:52 INFO  Estimated runtime of original DAG is 5163.890600204468ms
2022-09-21 20:49:52 WARNING Skipping Multi-Query Optimization (instead, only applying patches)
2022-09-21 20:49:52 INFO  Estimated unoptimised what-if runtime is 165244.49920654297ms
2022-09-21 20:49:52 INFO  ---RUNTIME: Multi-Query Optimization took 30.805587768554688 ms
2022-09-21 20:49:52 INFO  Executing generated plans
2022-09-21 20:52:32 INFO  ---RUNTIME: Execution took 160231.75406455994 ms
2022-09-21 20:52:32 INFO  Done!
2022-09-21 20:52:32 INFO  # Finished -- repetition 6 of 7 
2022-09-21 20:52:32 INFO  # Optimization benchmark for data_corruption with args [['folktables', 'slow_loading', 'featurization_2', 'neural_network']] -- repetition 7 of 7
2022-09-21 20:52:32 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-21 20:52:32 INFO  Running instrumented original pipeline...
2022-09-21 20:52:32 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-21 20:52:32 INFO  ---RUNTIME: Importing and monkey-patching took 6.481170654296875 ms
2022-09-21 20:52:37 INFO  ---RUNTIME: Original pipeline execution took 5622.500658035278 ms (excluding imports and monkey-patching)
2022-09-21 20:52:37 INFO  Starting execution of 1 what-if analyses...
2022-09-21 20:52:37 INFO  Start plan generation for analysis DataCorruption...
2022-09-21 20:52:37 INFO  ---RUNTIME: Plan generation took 0.5621910095214844 ms
2022-09-21 20:52:37 INFO  Estimated runtime of original DAG is 5355.639457702637ms
2022-09-21 20:52:37 INFO  Performing Multi-Query Optimization
2022-09-21 20:52:38 INFO  Estimated unoptimized what-if runtime is 171380.46264648438ms
2022-09-21 20:52:38 INFO  Estimated optimised what-if runtime is 10552.584409713745ms
2022-09-21 20:52:38 INFO  Estimated optimisation runtime saving is 160827.87823677063ms
2022-09-21 20:52:38 INFO  ---RUNTIME: Multi-Query Optimization took 91.77088737487793 ms
2022-09-21 20:52:38 INFO  Executing generated plans
2022-09-21 20:52:46 INFO  ---RUNTIME: Execution took 8830.625772476196 ms
2022-09-21 20:52:46 INFO  Done!
2022-09-21 20:52:46 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-21 20:52:46 INFO  Running instrumented original pipeline...
2022-09-21 20:52:46 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-21 20:52:46 INFO  ---RUNTIME: Importing and monkey-patching took 5.690574645996094 ms
2022-09-21 20:52:52 INFO  ---RUNTIME: Original pipeline execution took 5153.053998947144 ms (excluding imports and monkey-patching)
2022-09-21 20:52:52 INFO  Starting execution of 1 what-if analyses...
2022-09-21 20:52:52 INFO  Start plan generation for analysis DataCorruption...
2022-09-21 20:52:52 INFO  ---RUNTIME: Plan generation took 0.5390644073486328 ms
2022-09-21 20:52:52 INFO  Estimated runtime of original DAG is 4903.606653213501ms
2022-09-21 20:52:52 WARNING Skipping Multi-Query Optimization (instead, only applying patches)
2022-09-21 20:52:52 INFO  Estimated unoptimised what-if runtime is 156915.41290283203ms
2022-09-21 20:52:52 INFO  ---RUNTIME: Multi-Query Optimization took 24.230241775512695 ms
2022-09-21 20:52:52 INFO  Executing generated plans
2022-09-21 20:55:29 INFO  ---RUNTIME: Execution took 157262.00127601624 ms
2022-09-21 20:55:29 INFO  Done!
2022-09-21 20:55:29 INFO  # Finished -- repetition 7 of 7 
2022-09-21 20:55:29 INFO  # Final results after all repetitions
2022-09-21 20:55:29 INFO     repetition  ... no_opt_what_if_execution_combined_model_training
0           0  ...                                    119142.329216
1           1  ...                                    113204.862595
2           2  ...                                    107905.512333
3           3  ...                                    117940.878391
4           4  ...                                    119902.474403
5           5  ...                                    117703.441143
6           6  ...                                    115334.907293

[7 rows x 26 columns]
taskset -c 64-71 PROTOCOL_BUFFERS_PYTHON_IMPLEMENTATION=python python3.9 benchmarks_end_to_end.py data_corruption folktables slow_loading featurization_3 logistic_regression
2022-09-21 20:55:32.063076: W tensorflow/stream_executor/platform/default/dso_loader.cc:64] Could not load dynamic library 'libcudart.so.11.0'; dlerror: libcudart.so.11.0: cannot open shared object file: No such file or directory; LD_LIBRARY_PATH: /home/sgrafbe/mlwhatif/venv/lib/python3.9/site-packages/cv2/../../lib64:
2022-09-21 20:55:32.063107: I tensorflow/stream_executor/cuda/cudart_stub.cc:29] Ignore above cudart dlerror if you do not have a GPU set up on your machine.
2022-09-21 20:55:33 INFO  Patching sys.argv with ['mlwhatif', 'folktables', 'slow_loading', 'featurization_3', 'logistic_regression']
2022-09-21 20:55:33 INFO  Running instrumented original pipeline...
2022-09-21 20:55:33 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-21 20:55:33 INFO  ---RUNTIME: Importing and monkey-patching took 99.92194175720215 ms
2022-09-21 20:55:35 INFO  ---RUNTIME: Original pipeline execution took 1485.4745864868164 ms (excluding imports and monkey-patching)
2022-09-21 20:55:35 INFO  Starting execution of 0 what-if analyses...
2022-09-21 20:55:35 INFO  Estimated runtime of original DAG is 1195.6632137298584ms
2022-09-21 20:55:35 INFO  Performing Multi-Query Optimization
2022-09-21 20:55:35 INFO  Estimated unoptimized what-if runtime is 0ms
2022-09-21 20:55:35 INFO  Estimated optimised what-if runtime is 0ms
2022-09-21 20:55:35 INFO  Estimated optimisation runtime saving is 0ms
2022-09-21 20:55:35 INFO  ---RUNTIME: Multi-Query Optimization took 0.5159378051757812 ms
2022-09-21 20:55:35 INFO  Executing generated plans
2022-09-21 20:55:35 INFO  ---RUNTIME: Execution took 0.016450881958007812 ms
2022-09-21 20:55:35 INFO  Done!
2022-09-21 20:55:35 INFO  # Optimization benchmark for data_corruption with args [['folktables', 'slow_loading', 'featurization_3', 'logistic_regression']] -- repetition 1 of 7
2022-09-21 20:55:35 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-21 20:55:35 INFO  Running instrumented original pipeline...
2022-09-21 20:55:35 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-21 20:55:35 INFO  ---RUNTIME: Importing and monkey-patching took 6.097316741943359 ms
2022-09-21 20:55:36 INFO  ---RUNTIME: Original pipeline execution took 1472.1558094024658 ms (excluding imports and monkey-patching)
2022-09-21 20:55:36 INFO  Starting execution of 1 what-if analyses...
2022-09-21 20:55:36 INFO  Start plan generation for analysis DataCorruption...
2022-09-21 20:55:36 INFO  ---RUNTIME: Plan generation took 0.5140304565429688 ms
2022-09-21 20:55:36 INFO  Estimated runtime of original DAG is 1209.1739177703857ms
2022-09-21 20:55:36 INFO  Performing Multi-Query Optimization
2022-09-21 20:55:36 INFO  Estimated unoptimized what-if runtime is 38693.565368652344ms
2022-09-21 20:55:36 INFO  Estimated optimised what-if runtime is 1380.0063133239746ms
2022-09-21 20:55:36 INFO  Estimated optimisation runtime saving is 37313.55905532837ms
2022-09-21 20:55:36 INFO  ---RUNTIME: Multi-Query Optimization took 102.80489921569824 ms
2022-09-21 20:55:36 INFO  Executing generated plans
2022-09-21 20:55:38 INFO  ---RUNTIME: Execution took 1940.678596496582 ms
2022-09-21 20:55:38 INFO  Done!
2022-09-21 20:55:38 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-21 20:55:38 INFO  Running instrumented original pipeline...
2022-09-21 20:55:38 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-21 20:55:38 INFO  ---RUNTIME: Importing and monkey-patching took 5.761623382568359 ms
2022-09-21 20:55:40 INFO  ---RUNTIME: Original pipeline execution took 1602.644443511963 ms (excluding imports and monkey-patching)
2022-09-21 20:55:40 INFO  Starting execution of 1 what-if analyses...
2022-09-21 20:55:40 INFO  Start plan generation for analysis DataCorruption...
2022-09-21 20:55:40 INFO  ---RUNTIME: Plan generation took 1.18255615234375 ms
2022-09-21 20:55:40 INFO  Estimated runtime of original DAG is 1159.0321063995361ms
2022-09-21 20:55:40 WARNING Skipping Multi-Query Optimization (instead, only applying patches)
2022-09-21 20:55:40 INFO  Estimated unoptimised what-if runtime is 37089.027404785156ms
2022-09-21 20:55:40 INFO  ---RUNTIME: Multi-Query Optimization took 26.339292526245117 ms
2022-09-21 20:55:40 INFO  Executing generated plans
2022-09-21 20:56:20 INFO  ---RUNTIME: Execution took 40026.24535560608 ms
2022-09-21 20:56:20 INFO  Done!
2022-09-21 20:56:20 INFO  # Finished -- repetition 1 of 7 
2022-09-21 20:56:20 INFO  # Optimization benchmark for data_corruption with args [['folktables', 'slow_loading', 'featurization_3', 'logistic_regression']] -- repetition 2 of 7
2022-09-21 20:56:20 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-21 20:56:20 INFO  Running instrumented original pipeline...
2022-09-21 20:56:20 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-21 20:56:20 INFO  ---RUNTIME: Importing and monkey-patching took 6.584882736206055 ms
2022-09-21 20:56:21 INFO  ---RUNTIME: Original pipeline execution took 1404.6168327331543 ms (excluding imports and monkey-patching)
2022-09-21 20:56:21 INFO  Starting execution of 1 what-if analyses...
2022-09-21 20:56:21 INFO  Start plan generation for analysis DataCorruption...
2022-09-21 20:56:21 INFO  ---RUNTIME: Plan generation took 0.52642822265625 ms
2022-09-21 20:56:21 INFO  Estimated runtime of original DAG is 1135.556936264038ms
2022-09-21 20:56:21 INFO  Performing Multi-Query Optimization
2022-09-21 20:56:21 INFO  Estimated unoptimized what-if runtime is 36337.82196044922ms
2022-09-21 20:56:21 INFO  Estimated optimised what-if runtime is 1303.6699295043945ms
2022-09-21 20:56:21 INFO  Estimated optimisation runtime saving is 35034.152030944824ms
2022-09-21 20:56:21 INFO  ---RUNTIME: Multi-Query Optimization took 101.65739059448242 ms
2022-09-21 20:56:21 INFO  Executing generated plans
2022-09-21 20:56:23 INFO  ---RUNTIME: Execution took 2043.1675910949707 ms
2022-09-21 20:56:23 INFO  Done!
2022-09-21 20:56:23 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-21 20:56:23 INFO  Running instrumented original pipeline...
2022-09-21 20:56:23 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-21 20:56:23 INFO  ---RUNTIME: Importing and monkey-patching took 5.783557891845703 ms
2022-09-21 20:56:25 INFO  ---RUNTIME: Original pipeline execution took 1406.8784713745117 ms (excluding imports and monkey-patching)
2022-09-21 20:56:25 INFO  Starting execution of 1 what-if analyses...
2022-09-21 20:56:25 INFO  Start plan generation for analysis DataCorruption...
2022-09-21 20:56:25 INFO  ---RUNTIME: Plan generation took 0.46825408935546875 ms
2022-09-21 20:56:25 INFO  Estimated runtime of original DAG is 1149.6243476867676ms
2022-09-21 20:56:25 WARNING Skipping Multi-Query Optimization (instead, only applying patches)
2022-09-21 20:56:25 INFO  Estimated unoptimised what-if runtime is 36787.97912597656ms
2022-09-21 20:56:25 INFO  ---RUNTIME: Multi-Query Optimization took 24.597644805908203 ms
2022-09-21 20:56:25 INFO  Executing generated plans
2022-09-21 20:57:05 INFO  ---RUNTIME: Execution took 40421.76389694214 ms
2022-09-21 20:57:05 INFO  Done!
2022-09-21 20:57:05 INFO  # Finished -- repetition 2 of 7 
2022-09-21 20:57:05 INFO  # Optimization benchmark for data_corruption with args [['folktables', 'slow_loading', 'featurization_3', 'logistic_regression']] -- repetition 3 of 7
2022-09-21 20:57:05 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-21 20:57:05 INFO  Running instrumented original pipeline...
2022-09-21 20:57:05 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-21 20:57:05 INFO  ---RUNTIME: Importing and monkey-patching took 5.993843078613281 ms
2022-09-21 20:57:07 INFO  ---RUNTIME: Original pipeline execution took 1395.693063735962 ms (excluding imports and monkey-patching)
2022-09-21 20:57:07 INFO  Starting execution of 1 what-if analyses...
2022-09-21 20:57:07 INFO  Start plan generation for analysis DataCorruption...
2022-09-21 20:57:07 INFO  ---RUNTIME: Plan generation took 0.5109310150146484 ms
2022-09-21 20:57:07 INFO  Estimated runtime of original DAG is 1135.7479095458984ms
2022-09-21 20:57:07 INFO  Performing Multi-Query Optimization
2022-09-21 20:57:07 INFO  Estimated unoptimized what-if runtime is 36343.93310546875ms
2022-09-21 20:57:07 INFO  Estimated optimised what-if runtime is 1301.7463684082031ms
2022-09-21 20:57:07 INFO  Estimated optimisation runtime saving is 35042.18673706055ms
2022-09-21 20:57:07 INFO  ---RUNTIME: Multi-Query Optimization took 101.73773765563965 ms
2022-09-21 20:57:07 INFO  Executing generated plans
2022-09-21 20:57:09 INFO  ---RUNTIME: Execution took 1953.8884162902832 ms
2022-09-21 20:57:09 INFO  Done!
2022-09-21 20:57:09 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-21 20:57:09 INFO  Running instrumented original pipeline...
2022-09-21 20:57:09 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-21 20:57:09 INFO  ---RUNTIME: Importing and monkey-patching took 5.9146881103515625 ms
2022-09-21 20:57:10 INFO  ---RUNTIME: Original pipeline execution took 1565.753698348999 ms (excluding imports and monkey-patching)
2022-09-21 20:57:10 INFO  Starting execution of 1 what-if analyses...
2022-09-21 20:57:10 INFO  Start plan generation for analysis DataCorruption...
2022-09-21 20:57:10 INFO  ---RUNTIME: Plan generation took 0.4565715789794922 ms
2022-09-21 20:57:10 INFO  Estimated runtime of original DAG is 1076.049566268921ms
2022-09-21 20:57:10 WARNING Skipping Multi-Query Optimization (instead, only applying patches)
2022-09-21 20:57:10 INFO  Estimated unoptimised what-if runtime is 34433.58612060547ms
2022-09-21 20:57:10 INFO  ---RUNTIME: Multi-Query Optimization took 24.715900421142578 ms
2022-09-21 20:57:10 INFO  Executing generated plans
2022-09-21 20:57:49 INFO  ---RUNTIME: Execution took 39224.605321884155 ms
2022-09-21 20:57:49 INFO  Done!
2022-09-21 20:57:49 INFO  # Finished -- repetition 3 of 7 
2022-09-21 20:57:49 INFO  # Optimization benchmark for data_corruption with args [['folktables', 'slow_loading', 'featurization_3', 'logistic_regression']] -- repetition 4 of 7
2022-09-21 20:57:49 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-21 20:57:49 INFO  Running instrumented original pipeline...
2022-09-21 20:57:49 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-21 20:57:49 INFO  ---RUNTIME: Importing and monkey-patching took 6.234169006347656 ms
2022-09-21 20:57:51 INFO  ---RUNTIME: Original pipeline execution took 1399.7094631195068 ms (excluding imports and monkey-patching)
2022-09-21 20:57:51 INFO  Starting execution of 1 what-if analyses...
2022-09-21 20:57:51 INFO  Start plan generation for analysis DataCorruption...
2022-09-21 20:57:51 INFO  ---RUNTIME: Plan generation took 0.46825408935546875 ms
2022-09-21 20:57:51 INFO  Estimated runtime of original DAG is 1139.7180557250977ms
2022-09-21 20:57:51 INFO  Performing Multi-Query Optimization
2022-09-21 20:57:51 INFO  Estimated unoptimized what-if runtime is 36470.977783203125ms
2022-09-21 20:57:51 INFO  Estimated optimised what-if runtime is 1293.3614253997803ms
2022-09-21 20:57:51 INFO  Estimated optimisation runtime saving is 35177.616357803345ms
2022-09-21 20:57:51 INFO  ---RUNTIME: Multi-Query Optimization took 99.63226318359375 ms
2022-09-21 20:57:51 INFO  Executing generated plans
2022-09-21 20:57:53 INFO  ---RUNTIME: Execution took 1958.5208892822266 ms
2022-09-21 20:57:53 INFO  Done!
2022-09-21 20:57:53 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-21 20:57:53 INFO  Running instrumented original pipeline...
2022-09-21 20:57:53 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-21 20:57:53 INFO  ---RUNTIME: Importing and monkey-patching took 5.576610565185547 ms
2022-09-21 20:57:54 INFO  ---RUNTIME: Original pipeline execution took 1398.9977836608887 ms (excluding imports and monkey-patching)
2022-09-21 20:57:54 INFO  Starting execution of 1 what-if analyses...
2022-09-21 20:57:54 INFO  Start plan generation for analysis DataCorruption...
2022-09-21 20:57:54 INFO  ---RUNTIME: Plan generation took 0.5528926849365234 ms
2022-09-21 20:57:54 INFO  Estimated runtime of original DAG is 1134.216070175171ms
2022-09-21 20:57:54 WARNING Skipping Multi-Query Optimization (instead, only applying patches)
2022-09-21 20:57:54 INFO  Estimated unoptimised what-if runtime is 36294.91424560547ms
2022-09-21 20:57:54 INFO  ---RUNTIME: Multi-Query Optimization took 28.107166290283203 ms
2022-09-21 20:57:54 INFO  Executing generated plans
2022-09-21 20:58:34 INFO  ---RUNTIME: Execution took 39995.13125419617 ms
2022-09-21 20:58:34 INFO  Done!
2022-09-21 20:58:34 INFO  # Finished -- repetition 4 of 7 
2022-09-21 20:58:34 INFO  # Optimization benchmark for data_corruption with args [['folktables', 'slow_loading', 'featurization_3', 'logistic_regression']] -- repetition 5 of 7
2022-09-21 20:58:34 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-21 20:58:34 INFO  Running instrumented original pipeline...
2022-09-21 20:58:34 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-21 20:58:34 INFO  ---RUNTIME: Importing and monkey-patching took 6.486177444458008 ms
2022-09-21 20:58:36 INFO  ---RUNTIME: Original pipeline execution took 1428.7362098693848 ms (excluding imports and monkey-patching)
2022-09-21 20:58:36 INFO  Starting execution of 1 what-if analyses...
2022-09-21 20:58:36 INFO  Start plan generation for analysis DataCorruption...
2022-09-21 20:58:36 INFO  ---RUNTIME: Plan generation took 0.5152225494384766 ms
2022-09-21 20:58:36 INFO  Estimated runtime of original DAG is 1170.0506210327148ms
2022-09-21 20:58:36 INFO  Performing Multi-Query Optimization
2022-09-21 20:58:36 INFO  Estimated unoptimized what-if runtime is 37441.619873046875ms
2022-09-21 20:58:36 INFO  Estimated optimised what-if runtime is 1327.0611763000488ms
2022-09-21 20:58:36 INFO  Estimated optimisation runtime saving is 36114.558696746826ms
2022-09-21 20:58:36 INFO  ---RUNTIME: Multi-Query Optimization took 104.3558120727539 ms
2022-09-21 20:58:36 INFO  Executing generated plans
2022-09-21 20:58:38 INFO  ---RUNTIME: Execution took 1972.381353378296 ms
2022-09-21 20:58:38 INFO  Done!
2022-09-21 20:58:38 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-21 20:58:38 INFO  Running instrumented original pipeline...
2022-09-21 20:58:38 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-21 20:58:38 INFO  ---RUNTIME: Importing and monkey-patching took 5.742788314819336 ms
2022-09-21 20:58:39 INFO  ---RUNTIME: Original pipeline execution took 1269.5903778076172 ms (excluding imports and monkey-patching)
2022-09-21 20:58:39 INFO  Starting execution of 1 what-if analyses...
2022-09-21 20:58:39 INFO  Start plan generation for analysis DataCorruption...
2022-09-21 20:58:39 INFO  ---RUNTIME: Plan generation took 0.5714893341064453 ms
2022-09-21 20:58:39 INFO  Estimated runtime of original DAG is 1014.6605968475342ms
2022-09-21 20:58:39 WARNING Skipping Multi-Query Optimization (instead, only applying patches)
2022-09-21 20:58:39 INFO  Estimated unoptimised what-if runtime is 32469.139099121094ms
2022-09-21 20:58:39 INFO  ---RUNTIME: Multi-Query Optimization took 24.193525314331055 ms
2022-09-21 20:58:39 INFO  Executing generated plans
2022-09-21 20:59:33 INFO  ---RUNTIME: Execution took 54242.98405647278 ms
2022-09-21 20:59:33 INFO  Done!
2022-09-21 20:59:33 INFO  # Finished -- repetition 5 of 7 
2022-09-21 20:59:33 INFO  # Optimization benchmark for data_corruption with args [['folktables', 'slow_loading', 'featurization_3', 'logistic_regression']] -- repetition 6 of 7
2022-09-21 20:59:33 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-21 20:59:33 INFO  Running instrumented original pipeline...
2022-09-21 20:59:33 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-21 20:59:33 INFO  ---RUNTIME: Importing and monkey-patching took 6.189584732055664 ms
2022-09-21 20:59:35 INFO  ---RUNTIME: Original pipeline execution took 1443.6321258544922 ms (excluding imports and monkey-patching)
2022-09-21 20:59:35 INFO  Starting execution of 1 what-if analyses...
2022-09-21 20:59:35 INFO  Start plan generation for analysis DataCorruption...
2022-09-21 20:59:35 INFO  ---RUNTIME: Plan generation took 0.5326271057128906 ms
2022-09-21 20:59:35 INFO  Estimated runtime of original DAG is 1175.9986877441406ms
2022-09-21 20:59:35 INFO  Performing Multi-Query Optimization
2022-09-21 20:59:35 INFO  Estimated unoptimized what-if runtime is 37631.9580078125ms
2022-09-21 20:59:35 INFO  Estimated optimised what-if runtime is 1341.6943550109863ms
2022-09-21 20:59:35 INFO  Estimated optimisation runtime saving is 36290.263652801514ms
2022-09-21 20:59:35 INFO  ---RUNTIME: Multi-Query Optimization took 104.43568229675293 ms
2022-09-21 20:59:35 INFO  Executing generated plans
2022-09-21 20:59:37 INFO  ---RUNTIME: Execution took 2089.2624855041504 ms
2022-09-21 20:59:37 INFO  Done!
2022-09-21 20:59:37 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-21 20:59:37 INFO  Running instrumented original pipeline...
2022-09-21 20:59:37 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-21 20:59:37 INFO  ---RUNTIME: Importing and monkey-patching took 6.151437759399414 ms
2022-09-21 20:59:39 INFO  ---RUNTIME: Original pipeline execution took 1439.7518634796143 ms (excluding imports and monkey-patching)
2022-09-21 20:59:39 INFO  Starting execution of 1 what-if analyses...
2022-09-21 20:59:39 INFO  Start plan generation for analysis DataCorruption...
2022-09-21 20:59:39 INFO  ---RUNTIME: Plan generation took 0.4329681396484375 ms
2022-09-21 20:59:39 INFO  Estimated runtime of original DAG is 1178.7819862365723ms
2022-09-21 20:59:39 WARNING Skipping Multi-Query Optimization (instead, only applying patches)
2022-09-21 20:59:39 INFO  Estimated unoptimised what-if runtime is 37721.02355957031ms
2022-09-21 20:59:39 INFO  ---RUNTIME: Multi-Query Optimization took 25.5126953125 ms
2022-09-21 20:59:39 INFO  Executing generated plans
2022-09-21 21:00:19 INFO  ---RUNTIME: Execution took 40043.24746131897 ms
2022-09-21 21:00:19 INFO  Done!
2022-09-21 21:00:19 INFO  # Finished -- repetition 6 of 7 
2022-09-21 21:00:19 INFO  # Optimization benchmark for data_corruption with args [['folktables', 'slow_loading', 'featurization_3', 'logistic_regression']] -- repetition 7 of 7
2022-09-21 21:00:19 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-21 21:00:19 INFO  Running instrumented original pipeline...
2022-09-21 21:00:19 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-21 21:00:19 INFO  ---RUNTIME: Importing and monkey-patching took 6.170988082885742 ms
2022-09-21 21:00:20 INFO  ---RUNTIME: Original pipeline execution took 1303.516149520874 ms (excluding imports and monkey-patching)
2022-09-21 21:00:20 INFO  Starting execution of 1 what-if analyses...
2022-09-21 21:00:20 INFO  Start plan generation for analysis DataCorruption...
2022-09-21 21:00:20 INFO  ---RUNTIME: Plan generation took 0.46706199645996094 ms
2022-09-21 21:00:20 INFO  Estimated runtime of original DAG is 1050.400972366333ms
2022-09-21 21:00:20 INFO  Performing Multi-Query Optimization
2022-09-21 21:00:20 INFO  Estimated unoptimized what-if runtime is 33612.831115722656ms
2022-09-21 21:00:20 INFO  Estimated optimised what-if runtime is 1202.8872966766357ms
2022-09-21 21:00:20 INFO  Estimated optimisation runtime saving is 32409.94381904602ms
2022-09-21 21:00:20 INFO  ---RUNTIME: Multi-Query Optimization took 96.16446495056152 ms
2022-09-21 21:00:20 INFO  Executing generated plans
2022-09-21 21:00:22 INFO  ---RUNTIME: Execution took 1974.3666648864746 ms
2022-09-21 21:00:22 INFO  Done!
2022-09-21 21:00:22 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-21 21:00:22 INFO  Running instrumented original pipeline...
2022-09-21 21:00:22 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-21 21:00:22 INFO  ---RUNTIME: Importing and monkey-patching took 5.849361419677734 ms
2022-09-21 21:00:23 INFO  ---RUNTIME: Original pipeline execution took 1340.5804634094238 ms (excluding imports and monkey-patching)
2022-09-21 21:00:23 INFO  Starting execution of 1 what-if analyses...
2022-09-21 21:00:23 INFO  Start plan generation for analysis DataCorruption...
2022-09-21 21:00:23 INFO  ---RUNTIME: Plan generation took 0.44226646423339844 ms
2022-09-21 21:00:23 INFO  Estimated runtime of original DAG is 1079.8149108886719ms
2022-09-21 21:00:23 WARNING Skipping Multi-Query Optimization (instead, only applying patches)
2022-09-21 21:00:23 INFO  Estimated unoptimised what-if runtime is 34554.0771484375ms
2022-09-21 21:00:23 INFO  ---RUNTIME: Multi-Query Optimization took 24.430274963378906 ms
2022-09-21 21:00:23 INFO  Executing generated plans
2022-09-21 21:01:03 INFO  ---RUNTIME: Execution took 39922.57118225098 ms
2022-09-21 21:01:03 INFO  Done!
2022-09-21 21:01:03 INFO  # Finished -- repetition 7 of 7 
2022-09-21 21:01:03 INFO  # Final results after all repetitions
2022-09-21 21:01:03 INFO     repetition  ... no_opt_what_if_execution_combined_model_training
0           0  ...                                      2157.395601
1           1  ...                                      2114.215612
2           2  ...                                      2210.506678
3           3  ...                                      2085.820913
4           4  ...                                      2306.934834
5           5  ...                                      2056.424856
6           6  ...                                      2208.978415

[7 rows x 26 columns]
taskset -c 64-71 PROTOCOL_BUFFERS_PYTHON_IMPLEMENTATION=python python3.9 benchmarks_end_to_end.py data_corruption folktables slow_loading featurization_3 xgboost
2022-09-21 21:01:05.958997: W tensorflow/stream_executor/platform/default/dso_loader.cc:64] Could not load dynamic library 'libcudart.so.11.0'; dlerror: libcudart.so.11.0: cannot open shared object file: No such file or directory; LD_LIBRARY_PATH: /home/sgrafbe/mlwhatif/venv/lib/python3.9/site-packages/cv2/../../lib64:
2022-09-21 21:01:05.959030: I tensorflow/stream_executor/cuda/cudart_stub.cc:29] Ignore above cudart dlerror if you do not have a GPU set up on your machine.
2022-09-21 21:01:07 INFO  Patching sys.argv with ['mlwhatif', 'folktables', 'slow_loading', 'featurization_3', 'xgboost']
2022-09-21 21:01:07 INFO  Running instrumented original pipeline...
2022-09-21 21:01:07 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-21 21:01:07 INFO  ---RUNTIME: Importing and monkey-patching took 98.18339347839355 ms
2022-09-21 21:01:10 INFO  ---RUNTIME: Original pipeline execution took 3114.9613857269287 ms (excluding imports and monkey-patching)
2022-09-21 21:01:10 INFO  Starting execution of 0 what-if analyses...
2022-09-21 21:01:10 INFO  Estimated runtime of original DAG is 2828.2864093780518ms
2022-09-21 21:01:10 INFO  Performing Multi-Query Optimization
2022-09-21 21:01:10 INFO  Estimated unoptimized what-if runtime is 0ms
2022-09-21 21:01:10 INFO  Estimated optimised what-if runtime is 0ms
2022-09-21 21:01:10 INFO  Estimated optimisation runtime saving is 0ms
2022-09-21 21:01:10 INFO  ---RUNTIME: Multi-Query Optimization took 0.5123615264892578 ms
2022-09-21 21:01:10 INFO  Executing generated plans
2022-09-21 21:01:10 INFO  ---RUNTIME: Execution took 0.015735626220703125 ms
2022-09-21 21:01:10 INFO  Done!
2022-09-21 21:01:10 INFO  # Optimization benchmark for data_corruption with args [['folktables', 'slow_loading', 'featurization_3', 'xgboost']] -- repetition 1 of 7
2022-09-21 21:01:10 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-21 21:01:10 INFO  Running instrumented original pipeline...
2022-09-21 21:01:10 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-21 21:01:10 INFO  ---RUNTIME: Importing and monkey-patching took 6.445646286010742 ms
2022-09-21 21:01:12 INFO  ---RUNTIME: Original pipeline execution took 1911.4432334899902 ms (excluding imports and monkey-patching)
2022-09-21 21:01:12 INFO  Starting execution of 1 what-if analyses...
2022-09-21 21:01:12 INFO  Start plan generation for analysis DataCorruption...
2022-09-21 21:01:12 INFO  ---RUNTIME: Plan generation took 0.5106925964355469 ms
2022-09-21 21:01:12 INFO  Estimated runtime of original DAG is 1646.3336944580078ms
2022-09-21 21:01:12 INFO  Performing Multi-Query Optimization
2022-09-21 21:01:12 INFO  Estimated unoptimized what-if runtime is 52682.67822265625ms
2022-09-21 21:01:12 INFO  Estimated optimised what-if runtime is 3062.467575073242ms
2022-09-21 21:01:12 INFO  Estimated optimisation runtime saving is 49620.21064758301ms
2022-09-21 21:01:12 INFO  ---RUNTIME: Multi-Query Optimization took 96.81081771850586 ms
2022-09-21 21:01:12 INFO  Executing generated plans
2022-09-21 21:01:15 INFO  ---RUNTIME: Execution took 2653.7024974823 ms
2022-09-21 21:01:15 INFO  Done!
2022-09-21 21:01:15 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-21 21:01:15 INFO  Running instrumented original pipeline...
2022-09-21 21:01:15 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-21 21:01:15 INFO  ---RUNTIME: Importing and monkey-patching took 5.976438522338867 ms
2022-09-21 21:01:18 INFO  ---RUNTIME: Original pipeline execution took 3288.886070251465 ms (excluding imports and monkey-patching)
2022-09-21 21:01:18 INFO  Starting execution of 1 what-if analyses...
2022-09-21 21:01:18 INFO  Start plan generation for analysis DataCorruption...
2022-09-21 21:01:18 INFO  ---RUNTIME: Plan generation took 1.1453628540039062 ms
2022-09-21 21:01:18 INFO  Estimated runtime of original DAG is 2836.1427783966064ms
2022-09-21 21:01:18 WARNING Skipping Multi-Query Optimization (instead, only applying patches)
2022-09-21 21:01:18 INFO  Estimated unoptimised what-if runtime is 90756.5689086914ms
2022-09-21 21:01:18 INFO  ---RUNTIME: Multi-Query Optimization took 28.37395668029785 ms
2022-09-21 21:01:18 INFO  Executing generated plans
2022-09-21 21:02:13 INFO  ---RUNTIME: Execution took 54512.343645095825 ms
2022-09-21 21:02:13 INFO  Done!
2022-09-21 21:02:13 INFO  # Finished -- repetition 1 of 7 
2022-09-21 21:02:13 INFO  # Optimization benchmark for data_corruption with args [['folktables', 'slow_loading', 'featurization_3', 'xgboost']] -- repetition 2 of 7
2022-09-21 21:02:13 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-21 21:02:13 INFO  Running instrumented original pipeline...
2022-09-21 21:02:13 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-21 21:02:13 INFO  ---RUNTIME: Importing and monkey-patching took 6.083250045776367 ms
2022-09-21 21:02:14 INFO  ---RUNTIME: Original pipeline execution took 1700.4284858703613 ms (excluding imports and monkey-patching)
2022-09-21 21:02:14 INFO  Starting execution of 1 what-if analyses...
2022-09-21 21:02:14 INFO  Start plan generation for analysis DataCorruption...
2022-09-21 21:02:14 INFO  ---RUNTIME: Plan generation took 0.5102157592773438 ms
2022-09-21 21:02:14 INFO  Estimated runtime of original DAG is 1445.4033374786377ms
2022-09-21 21:02:14 INFO  Performing Multi-Query Optimization
2022-09-21 21:02:14 INFO  Estimated unoptimized what-if runtime is 46252.906799316406ms
2022-09-21 21:02:14 INFO  Estimated optimised what-if runtime is 2635.235071182251ms
2022-09-21 21:02:14 INFO  Estimated optimisation runtime saving is 43617.671728134155ms
2022-09-21 21:02:14 INFO  ---RUNTIME: Multi-Query Optimization took 97.03850746154785 ms
2022-09-21 21:02:14 INFO  Executing generated plans
2022-09-21 21:02:17 INFO  ---RUNTIME: Execution took 2656.1408042907715 ms
2022-09-21 21:02:17 INFO  Done!
2022-09-21 21:02:17 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-21 21:02:17 INFO  Running instrumented original pipeline...
2022-09-21 21:02:17 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-21 21:02:17 INFO  ---RUNTIME: Importing and monkey-patching took 5.723237991333008 ms
2022-09-21 21:02:19 INFO  ---RUNTIME: Original pipeline execution took 1734.999656677246 ms (excluding imports and monkey-patching)
2022-09-21 21:02:19 INFO  Starting execution of 1 what-if analyses...
2022-09-21 21:02:19 INFO  Start plan generation for analysis DataCorruption...
2022-09-21 21:02:19 INFO  ---RUNTIME: Plan generation took 0.47898292541503906 ms
2022-09-21 21:02:19 INFO  Estimated runtime of original DAG is 1472.346544265747ms
2022-09-21 21:02:19 WARNING Skipping Multi-Query Optimization (instead, only applying patches)
2022-09-21 21:02:19 INFO  Estimated unoptimised what-if runtime is 47115.089416503906ms
2022-09-21 21:02:19 INFO  ---RUNTIME: Multi-Query Optimization took 24.892568588256836 ms
2022-09-21 21:02:19 INFO  Executing generated plans
2022-09-21 21:03:13 INFO  ---RUNTIME: Execution took 54470.86763381958 ms
2022-09-21 21:03:13 INFO  Done!
2022-09-21 21:03:13 INFO  # Finished -- repetition 2 of 7 
2022-09-21 21:03:13 INFO  # Optimization benchmark for data_corruption with args [['folktables', 'slow_loading', 'featurization_3', 'xgboost']] -- repetition 3 of 7
2022-09-21 21:03:13 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-21 21:03:13 INFO  Running instrumented original pipeline...
2022-09-21 21:03:13 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-21 21:03:13 INFO  ---RUNTIME: Importing and monkey-patching took 6.09135627746582 ms
2022-09-21 21:03:15 INFO  ---RUNTIME: Original pipeline execution took 1680.7801723480225 ms (excluding imports and monkey-patching)
2022-09-21 21:03:15 INFO  Starting execution of 1 what-if analyses...
2022-09-21 21:03:15 INFO  Start plan generation for analysis DataCorruption...
2022-09-21 21:03:15 INFO  ---RUNTIME: Plan generation took 0.4787445068359375 ms
2022-09-21 21:03:15 INFO  Estimated runtime of original DAG is 1426.0146617889404ms
2022-09-21 21:03:15 INFO  Performing Multi-Query Optimization
2022-09-21 21:03:15 INFO  Estimated unoptimized what-if runtime is 45632.469177246094ms
2022-09-21 21:03:15 INFO  Estimated optimised what-if runtime is 1928.4873008728027ms
2022-09-21 21:03:15 INFO  Estimated optimisation runtime saving is 43703.98187637329ms
2022-09-21 21:03:15 INFO  ---RUNTIME: Multi-Query Optimization took 97.0458984375 ms
2022-09-21 21:03:15 INFO  Executing generated plans
2022-09-21 21:03:18 INFO  ---RUNTIME: Execution took 2845.973253250122 ms
2022-09-21 21:03:18 INFO  Done!
2022-09-21 21:03:18 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-21 21:03:18 INFO  Running instrumented original pipeline...
2022-09-21 21:03:18 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-21 21:03:18 INFO  ---RUNTIME: Importing and monkey-patching took 5.856752395629883 ms
2022-09-21 21:03:20 INFO  ---RUNTIME: Original pipeline execution took 1853.1641960144043 ms (excluding imports and monkey-patching)
2022-09-21 21:03:20 INFO  Starting execution of 1 what-if analyses...
2022-09-21 21:03:20 INFO  Start plan generation for analysis DataCorruption...
2022-09-21 21:03:20 INFO  ---RUNTIME: Plan generation took 0.4849433898925781 ms
2022-09-21 21:03:20 INFO  Estimated runtime of original DAG is 1420.2818870544434ms
2022-09-21 21:03:20 WARNING Skipping Multi-Query Optimization (instead, only applying patches)
2022-09-21 21:03:20 INFO  Estimated unoptimised what-if runtime is 45449.02038574219ms
2022-09-21 21:03:20 INFO  ---RUNTIME: Multi-Query Optimization took 24.657487869262695 ms
2022-09-21 21:03:20 INFO  Executing generated plans
2022-09-21 21:04:18 INFO  ---RUNTIME: Execution took 58124.21369552612 ms
2022-09-21 21:04:18 INFO  Done!
2022-09-21 21:04:18 INFO  # Finished -- repetition 3 of 7 
2022-09-21 21:04:18 INFO  # Optimization benchmark for data_corruption with args [['folktables', 'slow_loading', 'featurization_3', 'xgboost']] -- repetition 4 of 7
2022-09-21 21:04:18 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-21 21:04:18 INFO  Running instrumented original pipeline...
2022-09-21 21:04:18 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-21 21:04:18 INFO  ---RUNTIME: Importing and monkey-patching took 6.085395812988281 ms
2022-09-21 21:04:20 INFO  ---RUNTIME: Original pipeline execution took 1709.5222473144531 ms (excluding imports and monkey-patching)
2022-09-21 21:04:20 INFO  Starting execution of 1 what-if analyses...
2022-09-21 21:04:20 INFO  Start plan generation for analysis DataCorruption...
2022-09-21 21:04:20 INFO  ---RUNTIME: Plan generation took 0.4978179931640625 ms
2022-09-21 21:04:20 INFO  Estimated runtime of original DAG is 1449.3472576141357ms
2022-09-21 21:04:20 INFO  Performing Multi-Query Optimization
2022-09-21 21:04:20 INFO  Estimated unoptimized what-if runtime is 46379.112243652344ms
2022-09-21 21:04:20 INFO  Estimated optimised what-if runtime is 1943.1495666503906ms
2022-09-21 21:04:20 INFO  Estimated optimisation runtime saving is 44435.96267700195ms
2022-09-21 21:04:20 INFO  ---RUNTIME: Multi-Query Optimization took 99.19548034667969 ms
2022-09-21 21:04:20 INFO  Executing generated plans
2022-09-21 21:04:25 INFO  ---RUNTIME: Execution took 5118.625164031982 ms
2022-09-21 21:04:25 INFO  Done!
2022-09-21 21:04:25 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-21 21:04:25 INFO  Running instrumented original pipeline...
2022-09-21 21:04:25 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-21 21:04:25 INFO  ---RUNTIME: Importing and monkey-patching took 5.679607391357422 ms
2022-09-21 21:04:27 INFO  ---RUNTIME: Original pipeline execution took 1815.8111572265625 ms (excluding imports and monkey-patching)
2022-09-21 21:04:27 INFO  Starting execution of 1 what-if analyses...
2022-09-21 21:04:27 INFO  Start plan generation for analysis DataCorruption...
2022-09-21 21:04:27 INFO  ---RUNTIME: Plan generation took 0.4870891571044922 ms
2022-09-21 21:04:27 INFO  Estimated runtime of original DAG is 1555.3538799285889ms
2022-09-21 21:04:27 WARNING Skipping Multi-Query Optimization (instead, only applying patches)
2022-09-21 21:04:27 INFO  Estimated unoptimised what-if runtime is 49771.324157714844ms
2022-09-21 21:04:27 INFO  ---RUNTIME: Multi-Query Optimization took 24.985790252685547 ms
2022-09-21 21:04:27 INFO  Executing generated plans
2022-09-21 21:05:26 INFO  ---RUNTIME: Execution took 59008.99648666382 ms
2022-09-21 21:05:26 INFO  Done!
2022-09-21 21:05:26 INFO  # Finished -- repetition 4 of 7 
2022-09-21 21:05:26 INFO  # Optimization benchmark for data_corruption with args [['folktables', 'slow_loading', 'featurization_3', 'xgboost']] -- repetition 5 of 7
2022-09-21 21:05:26 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-21 21:05:26 INFO  Running instrumented original pipeline...
2022-09-21 21:05:26 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-21 21:05:26 INFO  ---RUNTIME: Importing and monkey-patching took 6.262302398681641 ms
2022-09-21 21:05:27 INFO  ---RUNTIME: Original pipeline execution took 1748.6512660980225 ms (excluding imports and monkey-patching)
2022-09-21 21:05:27 INFO  Starting execution of 1 what-if analyses...
2022-09-21 21:05:27 INFO  Start plan generation for analysis DataCorruption...
2022-09-21 21:05:27 INFO  ---RUNTIME: Plan generation took 0.4730224609375 ms
2022-09-21 21:05:27 INFO  Estimated runtime of original DAG is 1482.605218887329ms
2022-09-21 21:05:27 INFO  Performing Multi-Query Optimization
2022-09-21 21:05:28 INFO  Estimated unoptimized what-if runtime is 47443.36700439453ms
2022-09-21 21:05:28 INFO  Estimated optimised what-if runtime is 2698.2290744781494ms
2022-09-21 21:05:28 INFO  Estimated optimisation runtime saving is 44745.13792991638ms
2022-09-21 21:05:28 INFO  ---RUNTIME: Multi-Query Optimization took 100.39520263671875 ms
2022-09-21 21:05:28 INFO  Executing generated plans
2022-09-21 21:05:30 INFO  ---RUNTIME: Execution took 2683.3531856536865 ms
2022-09-21 21:05:30 INFO  Done!
2022-09-21 21:05:30 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-21 21:05:30 INFO  Running instrumented original pipeline...
2022-09-21 21:05:30 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-21 21:05:30 INFO  ---RUNTIME: Importing and monkey-patching took 5.926370620727539 ms
2022-09-21 21:05:32 INFO  ---RUNTIME: Original pipeline execution took 1792.6535606384277 ms (excluding imports and monkey-patching)
2022-09-21 21:05:32 INFO  Starting execution of 1 what-if analyses...
2022-09-21 21:05:32 INFO  Start plan generation for analysis DataCorruption...
2022-09-21 21:05:32 INFO  ---RUNTIME: Plan generation took 0.5137920379638672 ms
2022-09-21 21:05:32 INFO  Estimated runtime of original DAG is 1520.326852798462ms
2022-09-21 21:05:32 WARNING Skipping Multi-Query Optimization (instead, only applying patches)
2022-09-21 21:05:32 INFO  Estimated unoptimised what-if runtime is 48650.45928955078ms
2022-09-21 21:05:32 INFO  ---RUNTIME: Multi-Query Optimization took 24.645566940307617 ms
2022-09-21 21:05:32 INFO  Executing generated plans
2022-09-21 21:06:29 INFO  ---RUNTIME: Execution took 56803.94911766052 ms
2022-09-21 21:06:29 INFO  Done!
2022-09-21 21:06:29 INFO  # Finished -- repetition 5 of 7 
2022-09-21 21:06:29 INFO  # Optimization benchmark for data_corruption with args [['folktables', 'slow_loading', 'featurization_3', 'xgboost']] -- repetition 6 of 7
2022-09-21 21:06:29 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-21 21:06:29 INFO  Running instrumented original pipeline...
2022-09-21 21:06:29 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-21 21:06:29 INFO  ---RUNTIME: Importing and monkey-patching took 5.876779556274414 ms
2022-09-21 21:06:31 INFO  ---RUNTIME: Original pipeline execution took 1787.6274585723877 ms (excluding imports and monkey-patching)
2022-09-21 21:06:31 INFO  Starting execution of 1 what-if analyses...
2022-09-21 21:06:31 INFO  Start plan generation for analysis DataCorruption...
2022-09-21 21:06:31 INFO  ---RUNTIME: Plan generation took 0.5013942718505859 ms
2022-09-21 21:06:31 INFO  Estimated runtime of original DAG is 1523.5991477966309ms
2022-09-21 21:06:31 INFO  Performing Multi-Query Optimization
2022-09-21 21:06:31 INFO  Estimated unoptimized what-if runtime is 48755.17272949219ms
2022-09-21 21:06:31 INFO  Estimated optimised what-if runtime is 3038.3524894714355ms
2022-09-21 21:06:31 INFO  Estimated optimisation runtime saving is 45716.82024002075ms
2022-09-21 21:06:31 INFO  ---RUNTIME: Multi-Query Optimization took 118.39151382446289 ms
2022-09-21 21:06:31 INFO  Executing generated plans
2022-09-21 21:06:33 INFO  ---RUNTIME: Execution took 2579.212427139282 ms
2022-09-21 21:06:33 INFO  Done!
2022-09-21 21:06:33 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-21 21:06:33 INFO  Running instrumented original pipeline...
2022-09-21 21:06:33 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-21 21:06:33 INFO  ---RUNTIME: Importing and monkey-patching took 5.711555480957031 ms
2022-09-21 21:06:35 INFO  ---RUNTIME: Original pipeline execution took 1840.7936096191406 ms (excluding imports and monkey-patching)
2022-09-21 21:06:35 INFO  Starting execution of 1 what-if analyses...
2022-09-21 21:06:35 INFO  Start plan generation for analysis DataCorruption...
2022-09-21 21:06:35 INFO  ---RUNTIME: Plan generation took 0.4584789276123047 ms
2022-09-21 21:06:35 INFO  Estimated runtime of original DAG is 1564.5785331726074ms
2022-09-21 21:06:35 WARNING Skipping Multi-Query Optimization (instead, only applying patches)
2022-09-21 21:06:35 INFO  Estimated unoptimised what-if runtime is 50066.51306152344ms
2022-09-21 21:06:35 INFO  ---RUNTIME: Multi-Query Optimization took 24.935483932495117 ms
2022-09-21 21:06:35 INFO  Executing generated plans
2022-09-21 21:07:33 INFO  ---RUNTIME: Execution took 57361.775398254395 ms
2022-09-21 21:07:33 INFO  Done!
2022-09-21 21:07:33 INFO  # Finished -- repetition 6 of 7 
2022-09-21 21:07:33 INFO  # Optimization benchmark for data_corruption with args [['folktables', 'slow_loading', 'featurization_3', 'xgboost']] -- repetition 7 of 7
2022-09-21 21:07:33 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-21 21:07:33 INFO  Running instrumented original pipeline...
2022-09-21 21:07:33 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-21 21:07:33 INFO  ---RUNTIME: Importing and monkey-patching took 6.324529647827148 ms
2022-09-21 21:07:34 INFO  ---RUNTIME: Original pipeline execution took 1743.2911396026611 ms (excluding imports and monkey-patching)
2022-09-21 21:07:34 INFO  Starting execution of 1 what-if analyses...
2022-09-21 21:07:34 INFO  Start plan generation for analysis DataCorruption...
2022-09-21 21:07:34 INFO  ---RUNTIME: Plan generation took 0.5249977111816406 ms
2022-09-21 21:07:34 INFO  Estimated runtime of original DAG is 1480.5448055267334ms
2022-09-21 21:07:34 INFO  Performing Multi-Query Optimization
2022-09-21 21:07:34 INFO  Estimated unoptimized what-if runtime is 47377.43377685547ms
2022-09-21 21:07:34 INFO  Estimated optimised what-if runtime is 2851.3495922088623ms
2022-09-21 21:07:34 INFO  Estimated optimisation runtime saving is 44526.08418464661ms
2022-09-21 21:07:34 INFO  ---RUNTIME: Multi-Query Optimization took 98.19841384887695 ms
2022-09-21 21:07:34 INFO  Executing generated plans
2022-09-21 21:07:37 INFO  ---RUNTIME: Execution took 2613.767385482788 ms
2022-09-21 21:07:37 INFO  Done!
2022-09-21 21:07:37 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-21 21:07:37 INFO  Running instrumented original pipeline...
2022-09-21 21:07:37 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-21 21:07:37 INFO  ---RUNTIME: Importing and monkey-patching took 6.299495697021484 ms
2022-09-21 21:07:39 INFO  ---RUNTIME: Original pipeline execution took 1788.7475490570068 ms (excluding imports and monkey-patching)
2022-09-21 21:07:39 INFO  Starting execution of 1 what-if analyses...
2022-09-21 21:07:39 INFO  Start plan generation for analysis DataCorruption...
2022-09-21 21:07:39 INFO  ---RUNTIME: Plan generation took 0.44274330139160156 ms
2022-09-21 21:07:39 INFO  Estimated runtime of original DAG is 1510.5819702148438ms
2022-09-21 21:07:39 WARNING Skipping Multi-Query Optimization (instead, only applying patches)
2022-09-21 21:07:39 INFO  Estimated unoptimised what-if runtime is 48338.623046875ms
2022-09-21 21:07:39 INFO  ---RUNTIME: Multi-Query Optimization took 26.093006134033203 ms
2022-09-21 21:07:39 INFO  Executing generated plans
2022-09-21 21:08:41 INFO  ---RUNTIME: Execution took 61895.08104324341 ms
2022-09-21 21:08:41 INFO  Done!
2022-09-21 21:08:41 INFO  # Finished -- repetition 7 of 7 
2022-09-21 21:08:41 INFO  # Final results after all repetitions
2022-09-21 21:08:41 INFO     repetition  ... no_opt_what_if_execution_combined_model_training
0           0  ...                                     16622.451067
1           1  ...                                     17350.730419
2           2  ...                                     20384.490490
3           3  ...                                     20828.594208
4           4  ...                                     18597.435474
5           5  ...                                     19518.522263
6           6  ...                                     22917.995214

[7 rows x 26 columns]
taskset -c 64-71 PROTOCOL_BUFFERS_PYTHON_IMPLEMENTATION=python python3.9 benchmarks_end_to_end.py data_corruption folktables slow_loading featurization_3 neural_network
2022-09-21 21:08:43.430628: W tensorflow/stream_executor/platform/default/dso_loader.cc:64] Could not load dynamic library 'libcudart.so.11.0'; dlerror: libcudart.so.11.0: cannot open shared object file: No such file or directory; LD_LIBRARY_PATH: /home/sgrafbe/mlwhatif/venv/lib/python3.9/site-packages/cv2/../../lib64:
2022-09-21 21:08:43.430657: I tensorflow/stream_executor/cuda/cudart_stub.cc:29] Ignore above cudart dlerror if you do not have a GPU set up on your machine.
2022-09-21 21:08:44 INFO  Patching sys.argv with ['mlwhatif', 'folktables', 'slow_loading', 'featurization_3', 'neural_network']
2022-09-21 21:08:44 INFO  Running instrumented original pipeline...
2022-09-21 21:08:44 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-21 21:08:44 INFO  ---RUNTIME: Importing and monkey-patching took 96.19474411010742 ms
2022-09-21 21:08:46.123319: W tensorflow/stream_executor/platform/default/dso_loader.cc:64] Could not load dynamic library 'libcuda.so.1'; dlerror: libcuda.so.1: cannot open shared object file: No such file or directory; LD_LIBRARY_PATH: /home/sgrafbe/mlwhatif/venv/lib/python3.9/site-packages/cv2/../../lib64:
2022-09-21 21:08:46.123350: W tensorflow/stream_executor/cuda/cuda_driver.cc:326] failed call to cuInit: UNKNOWN ERROR (303)
2022-09-21 21:08:46.123372: I tensorflow/stream_executor/cuda/cuda_diagnostics.cc:156] kernel driver does not appear to be running on this host (wagyu): /proc/driver/nvidia/version does not exist
2022-09-21 21:08:46.123709: I tensorflow/core/platform/cpu_feature_guard.cc:142] This TensorFlow binary is optimized with oneAPI Deep Neural Network Library (oneDNN) to use the following CPU instructions in performance-critical operations:  AVX2 FMA
To enable them in other operations, rebuild TensorFlow with the appropriate compiler flags.
2022-09-21 21:08:46.664349: I tensorflow/compiler/mlir/mlir_graph_optimization_pass.cc:176] None of the MLIR Optimization Passes are enabled (registered 2)
2022-09-21 21:08:46.678363: I tensorflow/core/platform/profile_utils/cpu_utils.cc:114] CPU Frequency: 2595290000 Hz
2022-09-21 21:08:50 INFO  ---RUNTIME: Original pipeline execution took 5291.371583938599 ms (excluding imports and monkey-patching)
2022-09-21 21:08:50 INFO  Starting execution of 0 what-if analyses...
2022-09-21 21:08:50 INFO  Estimated runtime of original DAG is 5008.443117141724ms
2022-09-21 21:08:50 INFO  Performing Multi-Query Optimization
2022-09-21 21:08:50 INFO  Estimated unoptimized what-if runtime is 0ms
2022-09-21 21:08:50 INFO  Estimated optimised what-if runtime is 0ms
2022-09-21 21:08:50 INFO  Estimated optimisation runtime saving is 0ms
2022-09-21 21:08:50 INFO  ---RUNTIME: Multi-Query Optimization took 0.5071163177490234 ms
2022-09-21 21:08:50 INFO  Executing generated plans
2022-09-21 21:08:50 INFO  ---RUNTIME: Execution took 0.0152587890625 ms
2022-09-21 21:08:50 INFO  Done!
2022-09-21 21:08:50 INFO  # Optimization benchmark for data_corruption with args [['folktables', 'slow_loading', 'featurization_3', 'neural_network']] -- repetition 1 of 7
2022-09-21 21:08:50 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-21 21:08:50 INFO  Running instrumented original pipeline...
2022-09-21 21:08:50 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-21 21:08:50 INFO  ---RUNTIME: Importing and monkey-patching took 5.643606185913086 ms
2022-09-21 21:08:55 INFO  ---RUNTIME: Original pipeline execution took 5173.846006393433 ms (excluding imports and monkey-patching)
2022-09-21 21:08:55 INFO  Starting execution of 1 what-if analyses...
2022-09-21 21:08:55 INFO  Start plan generation for analysis DataCorruption...
2022-09-21 21:08:55 INFO  ---RUNTIME: Plan generation took 0.5631446838378906 ms
2022-09-21 21:08:55 INFO  Estimated runtime of original DAG is 4914.977788925171ms
2022-09-21 21:08:55 INFO  Performing Multi-Query Optimization
2022-09-21 21:08:55 INFO  Estimated unoptimized what-if runtime is 157279.28924560547ms
2022-09-21 21:08:55 INFO  Estimated optimised what-if runtime is 9714.44582939148ms
2022-09-21 21:08:55 INFO  Estimated optimisation runtime saving is 147564.843416214ms
2022-09-21 21:08:55 INFO  ---RUNTIME: Multi-Query Optimization took 99.86448287963867 ms
2022-09-21 21:08:55 INFO  Executing generated plans
2022-09-21 21:09:03 INFO  ---RUNTIME: Execution took 8372.286081314087 ms
2022-09-21 21:09:03 INFO  Done!
2022-09-21 21:09:03 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-21 21:09:03 INFO  Running instrumented original pipeline...
2022-09-21 21:09:03 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-21 21:09:03 INFO  ---RUNTIME: Importing and monkey-patching took 6.6661834716796875 ms
2022-09-21 21:09:09 INFO  ---RUNTIME: Original pipeline execution took 5400.064468383789 ms (excluding imports and monkey-patching)
2022-09-21 21:09:09 INFO  Starting execution of 1 what-if analyses...
2022-09-21 21:09:09 INFO  Start plan generation for analysis DataCorruption...
2022-09-21 21:09:09 INFO  ---RUNTIME: Plan generation took 1.020669937133789 ms
2022-09-21 21:09:09 INFO  Estimated runtime of original DAG is 5134.78422164917ms
2022-09-21 21:09:09 WARNING Skipping Multi-Query Optimization (instead, only applying patches)
2022-09-21 21:09:09 INFO  Estimated unoptimised what-if runtime is 164313.09509277344ms
2022-09-21 21:09:09 INFO  ---RUNTIME: Multi-Query Optimization took 24.950265884399414 ms
2022-09-21 21:09:09 INFO  Executing generated plans
2022-09-21 21:11:50 INFO  ---RUNTIME: Execution took 161788.69724273682 ms
2022-09-21 21:11:50 INFO  Done!
2022-09-21 21:11:50 INFO  # Finished -- repetition 1 of 7 
2022-09-21 21:11:50 INFO  # Optimization benchmark for data_corruption with args [['folktables', 'slow_loading', 'featurization_3', 'neural_network']] -- repetition 2 of 7
2022-09-21 21:11:50 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-21 21:11:50 INFO  Running instrumented original pipeline...
2022-09-21 21:11:51 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-21 21:11:51 INFO  ---RUNTIME: Importing and monkey-patching took 6.146669387817383 ms
2022-09-21 21:11:56 INFO  ---RUNTIME: Original pipeline execution took 5510.531187057495 ms (excluding imports and monkey-patching)
2022-09-21 21:11:56 INFO  Starting execution of 1 what-if analyses...
2022-09-21 21:11:56 INFO  Start plan generation for analysis DataCorruption...
2022-09-21 21:11:56 INFO  ---RUNTIME: Plan generation took 0.4839897155761719 ms
2022-09-21 21:11:56 INFO  Estimated runtime of original DAG is 5250.244855880737ms
2022-09-21 21:11:56 INFO  Performing Multi-Query Optimization
2022-09-21 21:11:56 INFO  Estimated unoptimized what-if runtime is 168007.8353881836ms
2022-09-21 21:11:56 INFO  Estimated optimised what-if runtime is 10525.999784469604ms
2022-09-21 21:11:56 INFO  Estimated optimisation runtime saving is 157481.835603714ms
2022-09-21 21:11:56 INFO  ---RUNTIME: Multi-Query Optimization took 102.8907299041748 ms
2022-09-21 21:11:56 INFO  Executing generated plans
2022-09-21 21:12:05 INFO  ---RUNTIME: Execution took 8941.364049911499 ms
2022-09-21 21:12:05 INFO  Done!
2022-09-21 21:12:05 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-21 21:12:05 INFO  Running instrumented original pipeline...
2022-09-21 21:12:05 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-21 21:12:05 INFO  ---RUNTIME: Importing and monkey-patching took 5.962133407592773 ms
2022-09-21 21:12:10 INFO  ---RUNTIME: Original pipeline execution took 5176.649808883667 ms (excluding imports and monkey-patching)
2022-09-21 21:12:10 INFO  Starting execution of 1 what-if analyses...
2022-09-21 21:12:10 INFO  Start plan generation for analysis DataCorruption...
2022-09-21 21:12:10 INFO  ---RUNTIME: Plan generation took 0.5249977111816406 ms
2022-09-21 21:12:10 INFO  Estimated runtime of original DAG is 4916.945457458496ms
2022-09-21 21:12:10 WARNING Skipping Multi-Query Optimization (instead, only applying patches)
2022-09-21 21:12:10 INFO  Estimated unoptimised what-if runtime is 157342.25463867188ms
2022-09-21 21:12:10 INFO  ---RUNTIME: Multi-Query Optimization took 27.820825576782227 ms
2022-09-21 21:12:10 INFO  Executing generated plans
2022-09-21 21:14:49 INFO  ---RUNTIME: Execution took 159063.2963180542 ms
2022-09-21 21:14:49 INFO  Done!
2022-09-21 21:14:49 INFO  # Finished -- repetition 2 of 7 
2022-09-21 21:14:49 INFO  # Optimization benchmark for data_corruption with args [['folktables', 'slow_loading', 'featurization_3', 'neural_network']] -- repetition 3 of 7
2022-09-21 21:14:49 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-21 21:14:49 INFO  Running instrumented original pipeline...
2022-09-21 21:14:50 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-21 21:14:50 INFO  ---RUNTIME: Importing and monkey-patching took 7.495880126953125 ms
2022-09-21 21:14:55 INFO  ---RUNTIME: Original pipeline execution took 5606.600046157837 ms (excluding imports and monkey-patching)
2022-09-21 21:14:55 INFO  Starting execution of 1 what-if analyses...
2022-09-21 21:14:55 INFO  Start plan generation for analysis DataCorruption...
2022-09-21 21:14:55 INFO  ---RUNTIME: Plan generation took 0.6043910980224609 ms
2022-09-21 21:14:55 INFO  Estimated runtime of original DAG is 4913.463830947876ms
2022-09-21 21:14:55 INFO  Performing Multi-Query Optimization
2022-09-21 21:14:55 INFO  Estimated unoptimized what-if runtime is 157230.84259033203ms
2022-09-21 21:14:55 INFO  Estimated optimised what-if runtime is 10324.519872665405ms
2022-09-21 21:14:55 INFO  Estimated optimisation runtime saving is 146906.32271766663ms
2022-09-21 21:14:55 INFO  ---RUNTIME: Multi-Query Optimization took 117.95711517333984 ms
2022-09-21 21:14:55 INFO  Executing generated plans
2022-09-21 21:15:06 INFO  ---RUNTIME: Execution took 11023.558855056763 ms
2022-09-21 21:15:06 INFO  Done!
2022-09-21 21:15:06 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-21 21:15:06 INFO  Running instrumented original pipeline...
2022-09-21 21:15:06 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-21 21:15:06 INFO  ---RUNTIME: Importing and monkey-patching took 7.183074951171875 ms
2022-09-21 21:15:11 INFO  ---RUNTIME: Original pipeline execution took 5106.221914291382 ms (excluding imports and monkey-patching)
2022-09-21 21:15:11 INFO  Starting execution of 1 what-if analyses...
2022-09-21 21:15:11 INFO  Start plan generation for analysis DataCorruption...
2022-09-21 21:15:11 INFO  ---RUNTIME: Plan generation took 0.5414485931396484 ms
2022-09-21 21:15:11 INFO  Estimated runtime of original DAG is 4818.559408187866ms
2022-09-21 21:15:11 WARNING Skipping Multi-Query Optimization (instead, only applying patches)
2022-09-21 21:15:11 INFO  Estimated unoptimised what-if runtime is 154193.90106201172ms
2022-09-21 21:15:11 INFO  ---RUNTIME: Multi-Query Optimization took 27.436256408691406 ms
2022-09-21 21:15:11 INFO  Executing generated plans
2022-09-21 21:17:52 INFO  ---RUNTIME: Execution took 160709.0983390808 ms
2022-09-21 21:17:52 INFO  Done!
2022-09-21 21:17:52 INFO  # Finished -- repetition 3 of 7 
2022-09-21 21:17:52 INFO  # Optimization benchmark for data_corruption with args [['folktables', 'slow_loading', 'featurization_3', 'neural_network']] -- repetition 4 of 7
2022-09-21 21:17:52 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-21 21:17:52 INFO  Running instrumented original pipeline...
2022-09-21 21:17:52 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-21 21:17:52 INFO  ---RUNTIME: Importing and monkey-patching took 7.01594352722168 ms
2022-09-21 21:17:57 INFO  ---RUNTIME: Original pipeline execution took 5143.937110900879 ms (excluding imports and monkey-patching)
2022-09-21 21:17:57 INFO  Starting execution of 1 what-if analyses...
2022-09-21 21:17:57 INFO  Start plan generation for analysis DataCorruption...
2022-09-21 21:17:57 INFO  ---RUNTIME: Plan generation took 1.1706352233886719 ms
2022-09-21 21:17:57 INFO  Estimated runtime of original DAG is 4876.4965534210205ms
2022-09-21 21:17:57 INFO  Performing Multi-Query Optimization
2022-09-21 21:17:58 INFO  Estimated unoptimized what-if runtime is 156047.88970947266ms
2022-09-21 21:17:58 INFO  Estimated optimised what-if runtime is 10098.367691040039ms
2022-09-21 21:17:58 INFO  Estimated optimisation runtime saving is 145949.52201843262ms
2022-09-21 21:17:58 INFO  ---RUNTIME: Multi-Query Optimization took 500.5040168762207 ms
2022-09-21 21:17:58 INFO  Executing generated plans
2022-09-21 21:18:07 INFO  ---RUNTIME: Execution took 9159.709215164185 ms
2022-09-21 21:18:07 INFO  Done!
2022-09-21 21:18:07 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-21 21:18:07 INFO  Running instrumented original pipeline...
2022-09-21 21:18:07 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-21 21:18:07 INFO  ---RUNTIME: Importing and monkey-patching took 6.360292434692383 ms
2022-09-21 21:18:12 INFO  ---RUNTIME: Original pipeline execution took 5091.159105300903 ms (excluding imports and monkey-patching)
2022-09-21 21:18:12 INFO  Starting execution of 1 what-if analyses...
2022-09-21 21:18:12 INFO  Start plan generation for analysis DataCorruption...
2022-09-21 21:18:12 INFO  ---RUNTIME: Plan generation took 0.5412101745605469 ms
2022-09-21 21:18:12 INFO  Estimated runtime of original DAG is 4810.547113418579ms
2022-09-21 21:18:12 WARNING Skipping Multi-Query Optimization (instead, only applying patches)
2022-09-21 21:18:12 INFO  Estimated unoptimised what-if runtime is 153937.50762939453ms
2022-09-21 21:18:12 INFO  ---RUNTIME: Multi-Query Optimization took 25.819778442382812 ms
2022-09-21 21:18:12 INFO  Executing generated plans
2022-09-21 21:20:52 INFO  ---RUNTIME: Execution took 159660.56036949158 ms
2022-09-21 21:20:52 INFO  Done!
2022-09-21 21:20:52 INFO  # Finished -- repetition 4 of 7 
2022-09-21 21:20:52 INFO  # Optimization benchmark for data_corruption with args [['folktables', 'slow_loading', 'featurization_3', 'neural_network']] -- repetition 5 of 7
2022-09-21 21:20:52 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-21 21:20:52 INFO  Running instrumented original pipeline...
2022-09-21 21:20:52 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-21 21:20:52 INFO  ---RUNTIME: Importing and monkey-patching took 5.833625793457031 ms
2022-09-21 21:20:57 INFO  ---RUNTIME: Original pipeline execution took 5351.6175746917725 ms (excluding imports and monkey-patching)
2022-09-21 21:20:57 INFO  Starting execution of 1 what-if analyses...
2022-09-21 21:20:57 INFO  Start plan generation for analysis DataCorruption...
2022-09-21 21:20:57 INFO  ---RUNTIME: Plan generation took 0.5462169647216797 ms
2022-09-21 21:20:57 INFO  Estimated runtime of original DAG is 5090.8496379852295ms
2022-09-21 21:20:57 INFO  Performing Multi-Query Optimization
2022-09-21 21:20:57 INFO  Estimated unoptimized what-if runtime is 162907.18841552734ms
2022-09-21 21:20:57 INFO  Estimated optimised what-if runtime is 10309.040069580078ms
2022-09-21 21:20:57 INFO  Estimated optimisation runtime saving is 152598.14834594727ms
2022-09-21 21:20:57 INFO  ---RUNTIME: Multi-Query Optimization took 100.68225860595703 ms
2022-09-21 21:20:57 INFO  Executing generated plans
2022-09-21 21:21:06 INFO  ---RUNTIME: Execution took 9153.350830078125 ms
2022-09-21 21:21:06 INFO  Done!
2022-09-21 21:21:06 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-21 21:21:06 INFO  Running instrumented original pipeline...
2022-09-21 21:21:06 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-21 21:21:06 INFO  ---RUNTIME: Importing and monkey-patching took 6.191015243530273 ms
2022-09-21 21:21:11 INFO  ---RUNTIME: Original pipeline execution took 5067.533016204834 ms (excluding imports and monkey-patching)
2022-09-21 21:21:11 INFO  Starting execution of 1 what-if analyses...
2022-09-21 21:21:11 INFO  Start plan generation for analysis DataCorruption...
2022-09-21 21:21:11 INFO  ---RUNTIME: Plan generation took 0.5269050598144531 ms
2022-09-21 21:21:11 INFO  Estimated runtime of original DAG is 4807.411670684814ms
2022-09-21 21:21:11 WARNING Skipping Multi-Query Optimization (instead, only applying patches)
2022-09-21 21:21:11 INFO  Estimated unoptimised what-if runtime is 153837.17346191406ms
2022-09-21 21:21:11 INFO  ---RUNTIME: Multi-Query Optimization took 25.228023529052734 ms
2022-09-21 21:21:11 INFO  Executing generated plans
2022-09-21 21:23:52 INFO  ---RUNTIME: Execution took 161096.0557460785 ms
2022-09-21 21:23:52 INFO  Done!
2022-09-21 21:23:52 INFO  # Finished -- repetition 5 of 7 
2022-09-21 21:23:52 INFO  # Optimization benchmark for data_corruption with args [['folktables', 'slow_loading', 'featurization_3', 'neural_network']] -- repetition 6 of 7
2022-09-21 21:23:52 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-21 21:23:52 INFO  Running instrumented original pipeline...
2022-09-21 21:23:52 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-21 21:23:52 INFO  ---RUNTIME: Importing and monkey-patching took 6.954431533813477 ms
2022-09-21 21:23:57 INFO  ---RUNTIME: Original pipeline execution took 5072.239398956299 ms (excluding imports and monkey-patching)
2022-09-21 21:23:57 INFO  Starting execution of 1 what-if analyses...
2022-09-21 21:23:57 INFO  Start plan generation for analysis DataCorruption...
2022-09-21 21:23:57 INFO  ---RUNTIME: Plan generation took 0.5466938018798828 ms
2022-09-21 21:23:57 INFO  Estimated runtime of original DAG is 4805.10401725769ms
2022-09-21 21:23:57 INFO  Performing Multi-Query Optimization
2022-09-21 21:23:58 INFO  Estimated unoptimized what-if runtime is 153763.3285522461ms
2022-09-21 21:23:58 INFO  Estimated optimised what-if runtime is 10226.885080337524ms
2022-09-21 21:23:58 INFO  Estimated optimisation runtime saving is 143536.44347190857ms
2022-09-21 21:23:58 INFO  ---RUNTIME: Multi-Query Optimization took 106.22739791870117 ms
2022-09-21 21:23:58 INFO  Executing generated plans
2022-09-21 21:24:07 INFO  ---RUNTIME: Execution took 9654.981851577759 ms
2022-09-21 21:24:07 INFO  Done!
2022-09-21 21:24:07 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-21 21:24:07 INFO  Running instrumented original pipeline...
2022-09-21 21:24:07 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-21 21:24:07 INFO  ---RUNTIME: Importing and monkey-patching took 6.000041961669922 ms
2022-09-21 21:24:12 INFO  ---RUNTIME: Original pipeline execution took 4844.833135604858 ms (excluding imports and monkey-patching)
2022-09-21 21:24:12 INFO  Starting execution of 1 what-if analyses...
2022-09-21 21:24:12 INFO  Start plan generation for analysis DataCorruption...
2022-09-21 21:24:12 INFO  ---RUNTIME: Plan generation took 0.6191730499267578 ms
2022-09-21 21:24:12 INFO  Estimated runtime of original DAG is 4581.833124160767ms
2022-09-21 21:24:12 WARNING Skipping Multi-Query Optimization (instead, only applying patches)
2022-09-21 21:24:12 INFO  Estimated unoptimised what-if runtime is 146618.65997314453ms
2022-09-21 21:24:12 INFO  ---RUNTIME: Multi-Query Optimization took 25.265216827392578 ms
2022-09-21 21:24:12 INFO  Executing generated plans
2022-09-21 21:26:52 INFO  ---RUNTIME: Execution took 160143.46385002136 ms
2022-09-21 21:26:52 INFO  Done!
2022-09-21 21:26:52 INFO  # Finished -- repetition 6 of 7 
2022-09-21 21:26:52 INFO  # Optimization benchmark for data_corruption with args [['folktables', 'slow_loading', 'featurization_3', 'neural_network']] -- repetition 7 of 7
2022-09-21 21:26:52 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-21 21:26:52 INFO  Running instrumented original pipeline...
2022-09-21 21:26:52 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-21 21:26:52 INFO  ---RUNTIME: Importing and monkey-patching took 6.423711776733398 ms
2022-09-21 21:26:57 INFO  ---RUNTIME: Original pipeline execution took 5146.566152572632 ms (excluding imports and monkey-patching)
2022-09-21 21:26:57 INFO  Starting execution of 1 what-if analyses...
2022-09-21 21:26:57 INFO  Start plan generation for analysis DataCorruption...
2022-09-21 21:26:57 INFO  ---RUNTIME: Plan generation took 0.5218982696533203 ms
2022-09-21 21:26:57 INFO  Estimated runtime of original DAG is 4880.250930786133ms
2022-09-21 21:26:57 INFO  Performing Multi-Query Optimization
2022-09-21 21:26:58 INFO  Estimated unoptimized what-if runtime is 156168.02978515625ms
2022-09-21 21:26:58 INFO  Estimated optimised what-if runtime is 10102.328538894653ms
2022-09-21 21:26:58 INFO  Estimated optimisation runtime saving is 146065.7012462616ms
2022-09-21 21:26:58 INFO  ---RUNTIME: Multi-Query Optimization took 562.7238750457764 ms
2022-09-21 21:26:58 INFO  Executing generated plans
2022-09-21 21:27:07 INFO  ---RUNTIME: Execution took 8590.625286102295 ms
2022-09-21 21:27:07 INFO  Done!
2022-09-21 21:27:07 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-21 21:27:07 INFO  Running instrumented original pipeline...
2022-09-21 21:27:07 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-21 21:27:07 INFO  ---RUNTIME: Importing and monkey-patching took 5.857229232788086 ms
2022-09-21 21:27:12 INFO  ---RUNTIME: Original pipeline execution took 5088.9647006988525 ms (excluding imports and monkey-patching)
2022-09-21 21:27:12 INFO  Starting execution of 1 what-if analyses...
2022-09-21 21:27:12 INFO  Start plan generation for analysis DataCorruption...
2022-09-21 21:27:12 INFO  ---RUNTIME: Plan generation took 0.9086132049560547 ms
2022-09-21 21:27:12 INFO  Estimated runtime of original DAG is 4814.675331115723ms
2022-09-21 21:27:12 WARNING Skipping Multi-Query Optimization (instead, only applying patches)
2022-09-21 21:27:12 INFO  Estimated unoptimised what-if runtime is 154069.61059570312ms
2022-09-21 21:27:12 INFO  ---RUNTIME: Multi-Query Optimization took 37.64677047729492 ms
2022-09-21 21:27:12 INFO  Executing generated plans
2022-09-21 21:29:52 INFO  ---RUNTIME: Execution took 160594.38586235046 ms
2022-09-21 21:29:52 INFO  Done!
2022-09-21 21:29:52 INFO  # Finished -- repetition 7 of 7 
2022-09-21 21:29:52 INFO  # Final results after all repetitions
2022-09-21 21:29:52 INFO     repetition  ... no_opt_what_if_execution_combined_model_training
0           0  ...                                    116987.136841
1           1  ...                                    116324.338675
2           2  ...                                    116894.756079
3           3  ...                                    116572.116375
4           4  ...                                    116736.676693
5           5  ...                                    116706.653357
6           6  ...                                    116302.706718

[7 rows x 26 columns]
taskset -c 64-71 PROTOCOL_BUFFERS_PYTHON_IMPLEMENTATION=python python3.9 benchmarks_end_to_end.py data_corruption folktables slow_loading featurization_4 logistic_regression
2022-09-21 21:29:55.479429: W tensorflow/stream_executor/platform/default/dso_loader.cc:64] Could not load dynamic library 'libcudart.so.11.0'; dlerror: libcudart.so.11.0: cannot open shared object file: No such file or directory; LD_LIBRARY_PATH: /home/sgrafbe/mlwhatif/venv/lib/python3.9/site-packages/cv2/../../lib64:
2022-09-21 21:29:55.479458: I tensorflow/stream_executor/cuda/cudart_stub.cc:29] Ignore above cudart dlerror if you do not have a GPU set up on your machine.
2022-09-21 21:29:56 INFO  Patching sys.argv with ['mlwhatif', 'folktables', 'slow_loading', 'featurization_4', 'logistic_regression']
2022-09-21 21:29:56 INFO  Running instrumented original pipeline...
2022-09-21 21:29:56 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-21 21:29:56 INFO  ---RUNTIME: Importing and monkey-patching took 95.83163261413574 ms
2022-09-21 21:29:58 INFO  ---RUNTIME: Original pipeline execution took 1639.526128768921 ms (excluding imports and monkey-patching)
2022-09-21 21:29:58 INFO  Starting execution of 0 what-if analyses...
2022-09-21 21:29:58 INFO  Estimated runtime of original DAG is 348.1330871582031ms
2022-09-21 21:29:58 INFO  Performing Multi-Query Optimization
2022-09-21 21:29:58 INFO  Estimated unoptimized what-if runtime is 0ms
2022-09-21 21:29:58 INFO  Estimated optimised what-if runtime is 0ms
2022-09-21 21:29:58 INFO  Estimated optimisation runtime saving is 0ms
2022-09-21 21:29:58 INFO  ---RUNTIME: Multi-Query Optimization took 0.5445480346679688 ms
2022-09-21 21:29:58 INFO  Executing generated plans
2022-09-21 21:29:58 INFO  ---RUNTIME: Execution took 0.0171661376953125 ms
2022-09-21 21:29:58 INFO  Done!
2022-09-21 21:29:58 INFO  # Optimization benchmark for data_corruption with args [['folktables', 'slow_loading', 'featurization_4', 'logistic_regression']] -- repetition 1 of 7
2022-09-21 21:29:58 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-21 21:29:58 INFO  Running instrumented original pipeline...
2022-09-21 21:29:58 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-21 21:29:58 INFO  ---RUNTIME: Importing and monkey-patching took 5.925655364990234 ms
2022-09-21 21:30:00 INFO  ---RUNTIME: Original pipeline execution took 1579.3678760528564 ms (excluding imports and monkey-patching)
2022-09-21 21:30:00 INFO  Starting execution of 1 what-if analyses...
2022-09-21 21:30:00 INFO  Start plan generation for analysis DataCorruption...
2022-09-21 21:30:00 INFO  ---RUNTIME: Plan generation took 0.5640983581542969 ms
2022-09-21 21:30:00 INFO  Estimated runtime of original DAG is 313.464879989624ms
2022-09-21 21:30:00 INFO  Performing Multi-Query Optimization
2022-09-21 21:30:00 INFO  Estimated unoptimized what-if runtime is 10030.876159667969ms
2022-09-21 21:30:00 INFO  Estimated optimised what-if runtime is 536.8645191192627ms
2022-09-21 21:30:00 INFO  Estimated optimisation runtime saving is 9494.011640548706ms
2022-09-21 21:30:00 INFO  ---RUNTIME: Multi-Query Optimization took 106.50849342346191 ms
2022-09-21 21:30:00 INFO  Executing generated plans
2022-09-21 21:30:01 INFO  ---RUNTIME: Execution took 1321.882724761963 ms
2022-09-21 21:30:01 INFO  Done!
2022-09-21 21:30:01 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-21 21:30:01 INFO  Running instrumented original pipeline...
2022-09-21 21:30:01 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-21 21:30:01 INFO  ---RUNTIME: Importing and monkey-patching took 5.873918533325195 ms
2022-09-21 21:30:03 INFO  ---RUNTIME: Original pipeline execution took 1827.8932571411133 ms (excluding imports and monkey-patching)
2022-09-21 21:30:03 INFO  Starting execution of 1 what-if analyses...
2022-09-21 21:30:03 INFO  Start plan generation for analysis DataCorruption...
2022-09-21 21:30:03 INFO  ---RUNTIME: Plan generation took 0.4990100860595703 ms
2022-09-21 21:30:03 INFO  Estimated runtime of original DAG is 407.6354503631592ms
2022-09-21 21:30:03 WARNING Skipping Multi-Query Optimization (instead, only applying patches)
2022-09-21 21:30:03 INFO  Estimated unoptimised what-if runtime is 13044.334411621094ms
2022-09-21 21:30:03 INFO  ---RUNTIME: Multi-Query Optimization took 26.51071548461914 ms
2022-09-21 21:30:03 INFO  Executing generated plans
2022-09-21 21:30:19 INFO  ---RUNTIME: Execution took 15808.55917930603 ms
2022-09-21 21:30:19 INFO  Done!
2022-09-21 21:30:19 INFO  # Finished -- repetition 1 of 7 
2022-09-21 21:30:19 INFO  # Optimization benchmark for data_corruption with args [['folktables', 'slow_loading', 'featurization_4', 'logistic_regression']] -- repetition 2 of 7
2022-09-21 21:30:19 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-21 21:30:19 INFO  Running instrumented original pipeline...
2022-09-21 21:30:19 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-21 21:30:19 INFO  ---RUNTIME: Importing and monkey-patching took 6.042242050170898 ms
2022-09-21 21:30:20 INFO  ---RUNTIME: Original pipeline execution took 1672.5349426269531 ms (excluding imports and monkey-patching)
2022-09-21 21:30:20 INFO  Starting execution of 1 what-if analyses...
2022-09-21 21:30:20 INFO  Start plan generation for analysis DataCorruption...
2022-09-21 21:30:20 INFO  ---RUNTIME: Plan generation took 0.6890296936035156 ms
2022-09-21 21:30:20 INFO  Estimated runtime of original DAG is 350.73280334472656ms
2022-09-21 21:30:20 INFO  Performing Multi-Query Optimization
2022-09-21 21:30:20 INFO  Estimated unoptimized what-if runtime is 11223.44970703125ms
2022-09-21 21:30:20 INFO  Estimated optimised what-if runtime is 622.1923828125ms
2022-09-21 21:30:20 INFO  Estimated optimisation runtime saving is 10601.25732421875ms
2022-09-21 21:30:20 INFO  ---RUNTIME: Multi-Query Optimization took 101.72820091247559 ms
2022-09-21 21:30:20 INFO  Executing generated plans
2022-09-21 21:30:22 INFO  ---RUNTIME: Execution took 1330.672025680542 ms
2022-09-21 21:30:22 INFO  Done!
2022-09-21 21:30:22 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-21 21:30:22 INFO  Running instrumented original pipeline...
2022-09-21 21:30:22 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-21 21:30:22 INFO  ---RUNTIME: Importing and monkey-patching took 5.630254745483398 ms
2022-09-21 21:30:23 INFO  ---RUNTIME: Original pipeline execution took 1626.389741897583 ms (excluding imports and monkey-patching)
2022-09-21 21:30:23 INFO  Starting execution of 1 what-if analyses...
2022-09-21 21:30:23 INFO  Start plan generation for analysis DataCorruption...
2022-09-21 21:30:23 INFO  ---RUNTIME: Plan generation took 1.2595653533935547 ms
2022-09-21 21:30:23 INFO  Estimated runtime of original DAG is 346.92883491516113ms
2022-09-21 21:30:23 WARNING Skipping Multi-Query Optimization (instead, only applying patches)
2022-09-21 21:30:23 INFO  Estimated unoptimised what-if runtime is 11101.722717285156ms
2022-09-21 21:30:23 INFO  ---RUNTIME: Multi-Query Optimization took 24.759531021118164 ms
2022-09-21 21:30:23 INFO  Executing generated plans
2022-09-21 21:30:40 INFO  ---RUNTIME: Execution took 16375.680208206177 ms
2022-09-21 21:30:40 INFO  Done!
2022-09-21 21:30:40 INFO  # Finished -- repetition 2 of 7 
2022-09-21 21:30:40 INFO  # Optimization benchmark for data_corruption with args [['folktables', 'slow_loading', 'featurization_4', 'logistic_regression']] -- repetition 3 of 7
2022-09-21 21:30:40 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-21 21:30:40 INFO  Running instrumented original pipeline...
2022-09-21 21:30:40 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-21 21:30:40 INFO  ---RUNTIME: Importing and monkey-patching took 6.3629150390625 ms
2022-09-21 21:30:41 INFO  ---RUNTIME: Original pipeline execution took 1600.1858711242676 ms (excluding imports and monkey-patching)
2022-09-21 21:30:41 INFO  Starting execution of 1 what-if analyses...
2022-09-21 21:30:41 INFO  Start plan generation for analysis DataCorruption...
2022-09-21 21:30:41 INFO  ---RUNTIME: Plan generation took 0.5674362182617188 ms
2022-09-21 21:30:41 INFO  Estimated runtime of original DAG is 344.37036514282227ms
2022-09-21 21:30:41 INFO  Performing Multi-Query Optimization
2022-09-21 21:30:42 INFO  Estimated unoptimized what-if runtime is 11019.851684570312ms
2022-09-21 21:30:42 INFO  Estimated optimised what-if runtime is 566.3506984710693ms
2022-09-21 21:30:42 INFO  Estimated optimisation runtime saving is 10453.500986099243ms
2022-09-21 21:30:42 INFO  ---RUNTIME: Multi-Query Optimization took 106.17661476135254 ms
2022-09-21 21:30:42 INFO  Executing generated plans
2022-09-21 21:30:43 INFO  ---RUNTIME: Execution took 1376.8689632415771 ms
2022-09-21 21:30:43 INFO  Done!
2022-09-21 21:30:43 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-21 21:30:43 INFO  Running instrumented original pipeline...
2022-09-21 21:30:43 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-21 21:30:43 INFO  ---RUNTIME: Importing and monkey-patching took 5.938053131103516 ms
2022-09-21 21:30:45 INFO  ---RUNTIME: Original pipeline execution took 1810.126781463623 ms (excluding imports and monkey-patching)
2022-09-21 21:30:45 INFO  Starting execution of 1 what-if analyses...
2022-09-21 21:30:45 INFO  Start plan generation for analysis DataCorruption...
2022-09-21 21:30:45 INFO  ---RUNTIME: Plan generation took 0.4410743713378906 ms
2022-09-21 21:30:45 INFO  Estimated runtime of original DAG is 350.2652645111084ms
2022-09-21 21:30:45 WARNING Skipping Multi-Query Optimization (instead, only applying patches)
2022-09-21 21:30:45 INFO  Estimated unoptimised what-if runtime is 11208.488464355469ms
2022-09-21 21:30:45 INFO  ---RUNTIME: Multi-Query Optimization took 24.512767791748047 ms
2022-09-21 21:30:45 INFO  Executing generated plans
2022-09-21 21:31:01 INFO  ---RUNTIME: Execution took 15900.708675384521 ms
2022-09-21 21:31:01 INFO  Done!
2022-09-21 21:31:01 INFO  # Finished -- repetition 3 of 7 
2022-09-21 21:31:01 INFO  # Optimization benchmark for data_corruption with args [['folktables', 'slow_loading', 'featurization_4', 'logistic_regression']] -- repetition 4 of 7
2022-09-21 21:31:01 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-21 21:31:01 INFO  Running instrumented original pipeline...
2022-09-21 21:31:01 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-21 21:31:01 INFO  ---RUNTIME: Importing and monkey-patching took 7.270574569702148 ms
2022-09-21 21:31:02 INFO  ---RUNTIME: Original pipeline execution took 1632.6487064361572 ms (excluding imports and monkey-patching)
2022-09-21 21:31:02 INFO  Starting execution of 1 what-if analyses...
2022-09-21 21:31:02 INFO  Start plan generation for analysis DataCorruption...
2022-09-21 21:31:02 INFO  ---RUNTIME: Plan generation took 0.5400180816650391 ms
2022-09-21 21:31:02 INFO  Estimated runtime of original DAG is 345.029354095459ms
2022-09-21 21:31:02 INFO  Performing Multi-Query Optimization
2022-09-21 21:31:02 INFO  Estimated unoptimized what-if runtime is 11040.939331054688ms
2022-09-21 21:31:02 INFO  Estimated optimised what-if runtime is 558.4011077880859ms
2022-09-21 21:31:02 INFO  Estimated optimisation runtime saving is 10482.538223266602ms
2022-09-21 21:31:02 INFO  ---RUNTIME: Multi-Query Optimization took 97.39565849304199 ms
2022-09-21 21:31:02 INFO  Executing generated plans
2022-09-21 21:31:04 INFO  ---RUNTIME: Execution took 1339.357614517212 ms
2022-09-21 21:31:04 INFO  Done!
2022-09-21 21:31:04 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-21 21:31:04 INFO  Running instrumented original pipeline...
2022-09-21 21:31:04 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-21 21:31:04 INFO  ---RUNTIME: Importing and monkey-patching took 6.552696228027344 ms
2022-09-21 21:31:05 INFO  ---RUNTIME: Original pipeline execution took 1702.7952671051025 ms (excluding imports and monkey-patching)
2022-09-21 21:31:05 INFO  Starting execution of 1 what-if analyses...
2022-09-21 21:31:05 INFO  Start plan generation for analysis DataCorruption...
2022-09-21 21:31:05 INFO  ---RUNTIME: Plan generation took 0.5564689636230469 ms
2022-09-21 21:31:05 INFO  Estimated runtime of original DAG is 416.23592376708984ms
2022-09-21 21:31:05 WARNING Skipping Multi-Query Optimization (instead, only applying patches)
2022-09-21 21:31:05 INFO  Estimated unoptimised what-if runtime is 13319.549560546875ms
2022-09-21 21:31:05 INFO  ---RUNTIME: Multi-Query Optimization took 25.229454040527344 ms
2022-09-21 21:31:05 INFO  Executing generated plans
2022-09-21 21:31:22 INFO  ---RUNTIME: Execution took 16095.272541046143 ms
2022-09-21 21:31:22 INFO  Done!
2022-09-21 21:31:22 INFO  # Finished -- repetition 4 of 7 
2022-09-21 21:31:22 INFO  # Optimization benchmark for data_corruption with args [['folktables', 'slow_loading', 'featurization_4', 'logistic_regression']] -- repetition 5 of 7
2022-09-21 21:31:22 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-21 21:31:22 INFO  Running instrumented original pipeline...
2022-09-21 21:31:22 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-21 21:31:22 INFO  ---RUNTIME: Importing and monkey-patching took 6.686210632324219 ms
2022-09-21 21:31:23 INFO  ---RUNTIME: Original pipeline execution took 1545.5989837646484 ms (excluding imports and monkey-patching)
2022-09-21 21:31:23 INFO  Starting execution of 1 what-if analyses...
2022-09-21 21:31:23 INFO  Start plan generation for analysis DataCorruption...
2022-09-21 21:31:23 INFO  ---RUNTIME: Plan generation took 0.5285739898681641 ms
2022-09-21 21:31:23 INFO  Estimated runtime of original DAG is 318.1126117706299ms
2022-09-21 21:31:23 INFO  Performing Multi-Query Optimization
2022-09-21 21:31:23 INFO  Estimated unoptimized what-if runtime is 10179.603576660156ms
2022-09-21 21:31:23 INFO  Estimated optimised what-if runtime is 527.2421836853027ms
2022-09-21 21:31:23 INFO  Estimated optimisation runtime saving is 9652.361392974854ms
2022-09-21 21:31:23 INFO  ---RUNTIME: Multi-Query Optimization took 96.80676460266113 ms
2022-09-21 21:31:23 INFO  Executing generated plans
2022-09-21 21:31:25 INFO  ---RUNTIME: Execution took 1474.2708206176758 ms
2022-09-21 21:31:25 INFO  Done!
2022-09-21 21:31:25 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-21 21:31:25 INFO  Running instrumented original pipeline...
2022-09-21 21:31:25 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-21 21:31:25 INFO  ---RUNTIME: Importing and monkey-patching took 8.758783340454102 ms
2022-09-21 21:31:26 INFO  ---RUNTIME: Original pipeline execution took 1662.0893478393555 ms (excluding imports and monkey-patching)
2022-09-21 21:31:26 INFO  Starting execution of 1 what-if analyses...
2022-09-21 21:31:26 INFO  Start plan generation for analysis DataCorruption...
2022-09-21 21:31:26 INFO  ---RUNTIME: Plan generation took 0.6010532379150391 ms
2022-09-21 21:31:26 INFO  Estimated runtime of original DAG is 341.3686752319336ms
2022-09-21 21:31:26 WARNING Skipping Multi-Query Optimization (instead, only applying patches)
2022-09-21 21:31:26 INFO  Estimated unoptimised what-if runtime is 10923.797607421875ms
2022-09-21 21:31:26 INFO  ---RUNTIME: Multi-Query Optimization took 25.91085433959961 ms
2022-09-21 21:31:26 INFO  Executing generated plans
2022-09-21 21:31:42 INFO  ---RUNTIME: Execution took 15402.001857757568 ms
2022-09-21 21:31:42 INFO  Done!
2022-09-21 21:31:42 INFO  # Finished -- repetition 5 of 7 
2022-09-21 21:31:42 INFO  # Optimization benchmark for data_corruption with args [['folktables', 'slow_loading', 'featurization_4', 'logistic_regression']] -- repetition 6 of 7
2022-09-21 21:31:42 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-21 21:31:42 INFO  Running instrumented original pipeline...
2022-09-21 21:31:42 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-21 21:31:42 INFO  ---RUNTIME: Importing and monkey-patching took 6.005048751831055 ms
2022-09-21 21:31:44 INFO  ---RUNTIME: Original pipeline execution took 1780.409574508667 ms (excluding imports and monkey-patching)
2022-09-21 21:31:44 INFO  Starting execution of 1 what-if analyses...
2022-09-21 21:31:44 INFO  Start plan generation for analysis DataCorruption...
2022-09-21 21:31:44 INFO  ---RUNTIME: Plan generation took 0.4634857177734375 ms
2022-09-21 21:31:44 INFO  Estimated runtime of original DAG is 324.1710662841797ms
2022-09-21 21:31:44 INFO  Performing Multi-Query Optimization
2022-09-21 21:31:44 INFO  Estimated unoptimized what-if runtime is 10373.47412109375ms
2022-09-21 21:31:44 INFO  Estimated optimised what-if runtime is 535.4068279266357ms
2022-09-21 21:31:44 INFO  Estimated optimisation runtime saving is 9838.067293167114ms
2022-09-21 21:31:44 INFO  ---RUNTIME: Multi-Query Optimization took 97.6114273071289 ms
2022-09-21 21:31:44 INFO  Executing generated plans
2022-09-21 21:31:45 INFO  ---RUNTIME: Execution took 1256.7319869995117 ms
2022-09-21 21:31:45 INFO  Done!
2022-09-21 21:31:45 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-21 21:31:45 INFO  Running instrumented original pipeline...
2022-09-21 21:31:45 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-21 21:31:45 INFO  ---RUNTIME: Importing and monkey-patching took 5.8422088623046875 ms
2022-09-21 21:31:47 INFO  ---RUNTIME: Original pipeline execution took 1554.5978546142578 ms (excluding imports and monkey-patching)
2022-09-21 21:31:47 INFO  Starting execution of 1 what-if analyses...
2022-09-21 21:31:47 INFO  Start plan generation for analysis DataCorruption...
2022-09-21 21:31:47 INFO  ---RUNTIME: Plan generation took 0.5474090576171875 ms
2022-09-21 21:31:47 INFO  Estimated runtime of original DAG is 331.85887336730957ms
2022-09-21 21:31:47 WARNING Skipping Multi-Query Optimization (instead, only applying patches)
2022-09-21 21:31:47 INFO  Estimated unoptimised what-if runtime is 10619.483947753906ms
2022-09-21 21:31:47 INFO  ---RUNTIME: Multi-Query Optimization took 25.12359619140625 ms
2022-09-21 21:31:47 INFO  Executing generated plans
2022-09-21 21:32:02 INFO  ---RUNTIME: Execution took 15334.106922149658 ms
2022-09-21 21:32:02 INFO  Done!
2022-09-21 21:32:02 INFO  # Finished -- repetition 6 of 7 
2022-09-21 21:32:02 INFO  # Optimization benchmark for data_corruption with args [['folktables', 'slow_loading', 'featurization_4', 'logistic_regression']] -- repetition 7 of 7
2022-09-21 21:32:02 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-21 21:32:02 INFO  Running instrumented original pipeline...
2022-09-21 21:32:02 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-21 21:32:02 INFO  ---RUNTIME: Importing and monkey-patching took 6.347417831420898 ms
2022-09-21 21:32:04 INFO  ---RUNTIME: Original pipeline execution took 1601.6011238098145 ms (excluding imports and monkey-patching)
2022-09-21 21:32:04 INFO  Starting execution of 1 what-if analyses...
2022-09-21 21:32:04 INFO  Start plan generation for analysis DataCorruption...
2022-09-21 21:32:04 INFO  ---RUNTIME: Plan generation took 1.332998275756836 ms
2022-09-21 21:32:04 INFO  Estimated runtime of original DAG is 344.94853019714355ms
2022-09-21 21:32:04 INFO  Performing Multi-Query Optimization
2022-09-21 21:32:04 INFO  Estimated unoptimized what-if runtime is 11038.352966308594ms
2022-09-21 21:32:04 INFO  Estimated optimised what-if runtime is 555.7832717895508ms
2022-09-21 21:32:04 INFO  Estimated optimisation runtime saving is 10482.569694519043ms
2022-09-21 21:32:04 INFO  ---RUNTIME: Multi-Query Optimization took 97.26500511169434 ms
2022-09-21 21:32:04 INFO  Executing generated plans
2022-09-21 21:32:05 INFO  ---RUNTIME: Execution took 1255.521535873413 ms
2022-09-21 21:32:05 INFO  Done!
2022-09-21 21:32:05 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-21 21:32:05 INFO  Running instrumented original pipeline...
2022-09-21 21:32:05 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-21 21:32:05 INFO  ---RUNTIME: Importing and monkey-patching took 5.920648574829102 ms
2022-09-21 21:32:06 INFO  ---RUNTIME: Original pipeline execution took 1581.1083316802979 ms (excluding imports and monkey-patching)
2022-09-21 21:32:06 INFO  Starting execution of 1 what-if analyses...
2022-09-21 21:32:06 INFO  Start plan generation for analysis DataCorruption...
2022-09-21 21:32:06 INFO  ---RUNTIME: Plan generation took 0.47135353088378906 ms
2022-09-21 21:32:06 INFO  Estimated runtime of original DAG is 339.4458293914795ms
2022-09-21 21:32:06 WARNING Skipping Multi-Query Optimization (instead, only applying patches)
2022-09-21 21:32:07 INFO  Estimated unoptimised what-if runtime is 10862.266540527344ms
2022-09-21 21:32:07 INFO  ---RUNTIME: Multi-Query Optimization took 24.692773818969727 ms
2022-09-21 21:32:07 INFO  Executing generated plans
2022-09-21 21:32:22 INFO  ---RUNTIME: Execution took 15683.134317398071 ms
2022-09-21 21:32:22 INFO  Done!
2022-09-21 21:32:22 INFO  # Finished -- repetition 7 of 7 
2022-09-21 21:32:22 INFO  # Final results after all repetitions
2022-09-21 21:32:22 INFO     repetition  ... no_opt_what_if_execution_combined_model_training
0           0  ...                                      2067.088604
1           1  ...                                      2109.506607
2           2  ...                                      2124.483824
3           3  ...                                      2090.667248
4           4  ...                                      2125.733376
5           5  ...                                      2077.816725
6           6  ...                                      2092.744112

[7 rows x 26 columns]
taskset -c 64-71 PROTOCOL_BUFFERS_PYTHON_IMPLEMENTATION=python python3.9 benchmarks_end_to_end.py data_corruption folktables slow_loading featurization_4 xgboost
2022-09-21 21:32:24.910623: W tensorflow/stream_executor/platform/default/dso_loader.cc:64] Could not load dynamic library 'libcudart.so.11.0'; dlerror: libcudart.so.11.0: cannot open shared object file: No such file or directory; LD_LIBRARY_PATH: /home/sgrafbe/mlwhatif/venv/lib/python3.9/site-packages/cv2/../../lib64:
2022-09-21 21:32:24.910656: I tensorflow/stream_executor/cuda/cudart_stub.cc:29] Ignore above cudart dlerror if you do not have a GPU set up on your machine.
2022-09-21 21:32:26 INFO  Patching sys.argv with ['mlwhatif', 'folktables', 'slow_loading', 'featurization_4', 'xgboost']
2022-09-21 21:32:26 INFO  Running instrumented original pipeline...
2022-09-21 21:32:26 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-21 21:32:26 INFO  ---RUNTIME: Importing and monkey-patching took 96.9090461730957 ms
2022-09-21 21:32:30 INFO  ---RUNTIME: Original pipeline execution took 3858.7870597839355 ms (excluding imports and monkey-patching)
2022-09-21 21:32:30 INFO  Starting execution of 0 what-if analyses...
2022-09-21 21:32:30 INFO  Estimated runtime of original DAG is 2567.688226699829ms
2022-09-21 21:32:30 INFO  Performing Multi-Query Optimization
2022-09-21 21:32:30 INFO  Estimated unoptimized what-if runtime is 0ms
2022-09-21 21:32:30 INFO  Estimated optimised what-if runtime is 0ms
2022-09-21 21:32:30 INFO  Estimated optimisation runtime saving is 0ms
2022-09-21 21:32:30 INFO  ---RUNTIME: Multi-Query Optimization took 0.5118846893310547 ms
2022-09-21 21:32:30 INFO  Executing generated plans
2022-09-21 21:32:30 INFO  ---RUNTIME: Execution took 0.021457672119140625 ms
2022-09-21 21:32:30 INFO  Done!
2022-09-21 21:32:30 INFO  # Optimization benchmark for data_corruption with args [['folktables', 'slow_loading', 'featurization_4', 'xgboost']] -- repetition 1 of 7
2022-09-21 21:32:30 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-21 21:32:30 INFO  Running instrumented original pipeline...
2022-09-21 21:32:30 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-21 21:32:30 INFO  ---RUNTIME: Importing and monkey-patching took 5.284547805786133 ms
2022-09-21 21:32:32 INFO  ---RUNTIME: Original pipeline execution took 2024.7087478637695 ms (excluding imports and monkey-patching)
2022-09-21 21:32:32 INFO  Starting execution of 1 what-if analyses...
2022-09-21 21:32:32 INFO  Start plan generation for analysis DataCorruption...
2022-09-21 21:32:32 INFO  ---RUNTIME: Plan generation took 0.5159378051757812 ms
2022-09-21 21:32:32 INFO  Estimated runtime of original DAG is 745.837926864624ms
2022-09-21 21:32:32 INFO  Performing Multi-Query Optimization
2022-09-21 21:32:32 INFO  Estimated unoptimized what-if runtime is 23866.81365966797ms
2022-09-21 21:32:32 INFO  Estimated optimised what-if runtime is 2527.4291038513184ms
2022-09-21 21:32:32 INFO  Estimated optimisation runtime saving is 21339.38455581665ms
2022-09-21 21:32:32 INFO  ---RUNTIME: Multi-Query Optimization took 98.11758995056152 ms
2022-09-21 21:32:32 INFO  Executing generated plans
2022-09-21 21:32:34 INFO  ---RUNTIME: Execution took 2284.696102142334 ms
2022-09-21 21:32:34 INFO  Done!
2022-09-21 21:32:34 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-21 21:32:34 INFO  Running instrumented original pipeline...
2022-09-21 21:32:34 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-21 21:32:34 INFO  ---RUNTIME: Importing and monkey-patching took 5.748510360717773 ms
2022-09-21 21:32:36 INFO  ---RUNTIME: Original pipeline execution took 2148.188591003418 ms (excluding imports and monkey-patching)
2022-09-21 21:32:36 INFO  Starting execution of 1 what-if analyses...
2022-09-21 21:32:36 INFO  Start plan generation for analysis DataCorruption...
2022-09-21 21:32:36 INFO  ---RUNTIME: Plan generation took 0.5166530609130859 ms
2022-09-21 21:32:36 INFO  Estimated runtime of original DAG is 691.3974285125732ms
2022-09-21 21:32:36 WARNING Skipping Multi-Query Optimization (instead, only applying patches)
2022-09-21 21:32:36 INFO  Estimated unoptimised what-if runtime is 22124.717712402344ms
2022-09-21 21:32:36 INFO  ---RUNTIME: Multi-Query Optimization took 25.908231735229492 ms
2022-09-21 21:32:36 INFO  Executing generated plans
2022-09-21 21:33:19 INFO  ---RUNTIME: Execution took 42915.13204574585 ms
2022-09-21 21:33:19 INFO  Done!
2022-09-21 21:33:19 INFO  # Finished -- repetition 1 of 7 
2022-09-21 21:33:19 INFO  # Optimization benchmark for data_corruption with args [['folktables', 'slow_loading', 'featurization_4', 'xgboost']] -- repetition 2 of 7
2022-09-21 21:33:19 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-21 21:33:19 INFO  Running instrumented original pipeline...
2022-09-21 21:33:19 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-21 21:33:19 INFO  ---RUNTIME: Importing and monkey-patching took 6.273508071899414 ms
2022-09-21 21:33:21 INFO  ---RUNTIME: Original pipeline execution took 2008.7833404541016 ms (excluding imports and monkey-patching)
2022-09-21 21:33:21 INFO  Starting execution of 1 what-if analyses...
2022-09-21 21:33:21 INFO  Start plan generation for analysis DataCorruption...
2022-09-21 21:33:21 INFO  ---RUNTIME: Plan generation took 0.5247592926025391 ms
2022-09-21 21:33:21 INFO  Estimated runtime of original DAG is 733.6480617523193ms
2022-09-21 21:33:21 INFO  Performing Multi-Query Optimization
2022-09-21 21:33:21 INFO  Estimated unoptimized what-if runtime is 23476.73797607422ms
2022-09-21 21:33:21 INFO  Estimated optimised what-if runtime is 2170.6745624542236ms
2022-09-21 21:33:21 INFO  Estimated optimisation runtime saving is 21306.063413619995ms
2022-09-21 21:33:21 INFO  ---RUNTIME: Multi-Query Optimization took 97.02086448669434 ms
2022-09-21 21:33:21 INFO  Executing generated plans
2022-09-21 21:33:24 INFO  ---RUNTIME: Execution took 2957.9875469207764 ms
2022-09-21 21:33:24 INFO  Done!
2022-09-21 21:33:24 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-21 21:33:24 INFO  Running instrumented original pipeline...
2022-09-21 21:33:24 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-21 21:33:24 INFO  ---RUNTIME: Importing and monkey-patching took 5.758523941040039 ms
2022-09-21 21:33:35 INFO  ---RUNTIME: Original pipeline execution took 10320.48749923706 ms (excluding imports and monkey-patching)
2022-09-21 21:33:35 INFO  Starting execution of 1 what-if analyses...
2022-09-21 21:33:35 INFO  Start plan generation for analysis DataCorruption...
2022-09-21 21:33:35 INFO  ---RUNTIME: Plan generation took 1.3337135314941406 ms
2022-09-21 21:33:35 INFO  Estimated runtime of original DAG is 9047.16420173645ms
2022-09-21 21:33:35 WARNING Skipping Multi-Query Optimization (instead, only applying patches)
2022-09-21 21:33:35 INFO  Estimated unoptimised what-if runtime is 289509.2544555664ms
2022-09-21 21:33:35 INFO  ---RUNTIME: Multi-Query Optimization took 24.51157569885254 ms
2022-09-21 21:33:35 INFO  Executing generated plans
2022-09-21 21:34:19 INFO  ---RUNTIME: Execution took 44699.825048446655 ms
2022-09-21 21:34:19 INFO  Done!
2022-09-21 21:34:19 INFO  # Finished -- repetition 2 of 7 
2022-09-21 21:34:19 INFO  # Optimization benchmark for data_corruption with args [['folktables', 'slow_loading', 'featurization_4', 'xgboost']] -- repetition 3 of 7
2022-09-21 21:34:19 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-21 21:34:19 INFO  Running instrumented original pipeline...
2022-09-21 21:34:19 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-21 21:34:19 INFO  ---RUNTIME: Importing and monkey-patching took 6.158113479614258 ms
2022-09-21 21:34:21 INFO  ---RUNTIME: Original pipeline execution took 1947.3519325256348 ms (excluding imports and monkey-patching)
2022-09-21 21:34:21 INFO  Starting execution of 1 what-if analyses...
2022-09-21 21:34:21 INFO  Start plan generation for analysis DataCorruption...
2022-09-21 21:34:21 INFO  ---RUNTIME: Plan generation took 0.5154609680175781 ms
2022-09-21 21:34:21 INFO  Estimated runtime of original DAG is 670.9392070770264ms
2022-09-21 21:34:21 INFO  Performing Multi-Query Optimization
2022-09-21 21:34:21 INFO  Estimated unoptimized what-if runtime is 21470.054626464844ms
2022-09-21 21:34:21 INFO  Estimated optimised what-if runtime is 1894.7765827178955ms
2022-09-21 21:34:21 INFO  Estimated optimisation runtime saving is 19575.27804374695ms
2022-09-21 21:34:21 INFO  ---RUNTIME: Multi-Query Optimization took 96.88806533813477 ms
2022-09-21 21:34:21 INFO  Executing generated plans
2022-09-21 21:34:23 INFO  ---RUNTIME: Execution took 1864.513874053955 ms
2022-09-21 21:34:23 INFO  Done!
2022-09-21 21:34:23 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-21 21:34:23 INFO  Running instrumented original pipeline...
2022-09-21 21:34:23 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-21 21:34:23 INFO  ---RUNTIME: Importing and monkey-patching took 5.952596664428711 ms
2022-09-21 21:34:25 INFO  ---RUNTIME: Original pipeline execution took 2252.2642612457275 ms (excluding imports and monkey-patching)
2022-09-21 21:34:25 INFO  Starting execution of 1 what-if analyses...
2022-09-21 21:34:25 INFO  Start plan generation for analysis DataCorruption...
2022-09-21 21:34:25 INFO  ---RUNTIME: Plan generation took 0.6015300750732422 ms
2022-09-21 21:34:25 INFO  Estimated runtime of original DAG is 754.7092437744141ms
2022-09-21 21:34:25 WARNING Skipping Multi-Query Optimization (instead, only applying patches)
2022-09-21 21:34:25 INFO  Estimated unoptimised what-if runtime is 24150.69580078125ms
2022-09-21 21:34:25 INFO  ---RUNTIME: Multi-Query Optimization took 25.918960571289062 ms
2022-09-21 21:34:25 INFO  Executing generated plans
2022-09-21 21:35:03 INFO  ---RUNTIME: Execution took 37727.8892993927 ms
2022-09-21 21:35:03 INFO  Done!
2022-09-21 21:35:03 INFO  # Finished -- repetition 3 of 7 
2022-09-21 21:35:03 INFO  # Optimization benchmark for data_corruption with args [['folktables', 'slow_loading', 'featurization_4', 'xgboost']] -- repetition 4 of 7
2022-09-21 21:35:03 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-21 21:35:03 INFO  Running instrumented original pipeline...
2022-09-21 21:35:03 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-21 21:35:03 INFO  ---RUNTIME: Importing and monkey-patching took 6.517171859741211 ms
2022-09-21 21:35:05 INFO  ---RUNTIME: Original pipeline execution took 1987.4224662780762 ms (excluding imports and monkey-patching)
2022-09-21 21:35:05 INFO  Starting execution of 1 what-if analyses...
2022-09-21 21:35:05 INFO  Start plan generation for analysis DataCorruption...
2022-09-21 21:35:05 INFO  ---RUNTIME: Plan generation took 0.5521774291992188 ms
2022-09-21 21:35:05 INFO  Estimated runtime of original DAG is 687.8452301025391ms
2022-09-21 21:35:05 INFO  Performing Multi-Query Optimization
2022-09-21 21:35:05 INFO  Estimated unoptimized what-if runtime is 22011.04736328125ms
2022-09-21 21:35:05 INFO  Estimated optimised what-if runtime is 2499.950885772705ms
2022-09-21 21:35:05 INFO  Estimated optimisation runtime saving is 19511.096477508545ms
2022-09-21 21:35:05 INFO  ---RUNTIME: Multi-Query Optimization took 96.86732292175293 ms
2022-09-21 21:35:05 INFO  Executing generated plans
2022-09-21 21:35:07 INFO  ---RUNTIME: Execution took 1984.980583190918 ms
2022-09-21 21:35:07 INFO  Done!
2022-09-21 21:35:07 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-21 21:35:07 INFO  Running instrumented original pipeline...
2022-09-21 21:35:07 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-21 21:35:07 INFO  ---RUNTIME: Importing and monkey-patching took 5.862712860107422 ms
2022-09-21 21:35:09 INFO  ---RUNTIME: Original pipeline execution took 1997.4970817565918 ms (excluding imports and monkey-patching)
2022-09-21 21:35:09 INFO  Starting execution of 1 what-if analyses...
2022-09-21 21:35:09 INFO  Start plan generation for analysis DataCorruption...
2022-09-21 21:35:09 INFO  ---RUNTIME: Plan generation took 1.2989044189453125 ms
2022-09-21 21:35:09 INFO  Estimated runtime of original DAG is 727.8633117675781ms
2022-09-21 21:35:09 WARNING Skipping Multi-Query Optimization (instead, only applying patches)
2022-09-21 21:35:09 INFO  Estimated unoptimised what-if runtime is 23291.6259765625ms
2022-09-21 21:35:09 INFO  ---RUNTIME: Multi-Query Optimization took 24.39403533935547 ms
2022-09-21 21:35:09 INFO  Executing generated plans
2022-09-21 21:36:08 INFO  ---RUNTIME: Execution took 58669.88563537598 ms
2022-09-21 21:36:08 INFO  Done!
2022-09-21 21:36:08 INFO  # Finished -- repetition 4 of 7 
2022-09-21 21:36:08 INFO  # Optimization benchmark for data_corruption with args [['folktables', 'slow_loading', 'featurization_4', 'xgboost']] -- repetition 5 of 7
2022-09-21 21:36:08 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-21 21:36:08 INFO  Running instrumented original pipeline...
2022-09-21 21:36:08 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-21 21:36:08 INFO  ---RUNTIME: Importing and monkey-patching took 6.475687026977539 ms
2022-09-21 21:36:10 INFO  ---RUNTIME: Original pipeline execution took 2030.3564071655273 ms (excluding imports and monkey-patching)
2022-09-21 21:36:10 INFO  Starting execution of 1 what-if analyses...
2022-09-21 21:36:10 INFO  Start plan generation for analysis DataCorruption...
2022-09-21 21:36:10 INFO  ---RUNTIME: Plan generation took 0.5660057067871094 ms
2022-09-21 21:36:10 INFO  Estimated runtime of original DAG is 749.2454051971436ms
2022-09-21 21:36:10 INFO  Performing Multi-Query Optimization
2022-09-21 21:36:10 INFO  Estimated unoptimized what-if runtime is 23975.852966308594ms
2022-09-21 21:36:10 INFO  Estimated optimised what-if runtime is 2297.5988388061523ms
2022-09-21 21:36:10 INFO  Estimated optimisation runtime saving is 21678.25412750244ms
2022-09-21 21:36:10 INFO  ---RUNTIME: Multi-Query Optimization took 97.57614135742188 ms
2022-09-21 21:36:10 INFO  Executing generated plans
2022-09-21 21:36:12 INFO  ---RUNTIME: Execution took 2246.448040008545 ms
2022-09-21 21:36:12 INFO  Done!
2022-09-21 21:36:12 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-21 21:36:12 INFO  Running instrumented original pipeline...
2022-09-21 21:36:12 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-21 21:36:12 INFO  ---RUNTIME: Importing and monkey-patching took 5.859613418579102 ms
2022-09-21 21:36:14 INFO  ---RUNTIME: Original pipeline execution took 1972.477912902832 ms (excluding imports and monkey-patching)
2022-09-21 21:36:14 INFO  Starting execution of 1 what-if analyses...
2022-09-21 21:36:14 INFO  Start plan generation for analysis DataCorruption...
2022-09-21 21:36:14 INFO  ---RUNTIME: Plan generation took 0.5295276641845703 ms
2022-09-21 21:36:14 INFO  Estimated runtime of original DAG is 686.5971088409424ms
2022-09-21 21:36:14 WARNING Skipping Multi-Query Optimization (instead, only applying patches)
2022-09-21 21:36:14 INFO  Estimated unoptimised what-if runtime is 21971.107482910156ms
2022-09-21 21:36:14 INFO  ---RUNTIME: Multi-Query Optimization took 24.954795837402344 ms
2022-09-21 21:36:14 INFO  Executing generated plans
2022-09-21 21:37:03 INFO  ---RUNTIME: Execution took 48727.110385894775 ms
2022-09-21 21:37:03 INFO  Done!
2022-09-21 21:37:03 INFO  # Finished -- repetition 5 of 7 
2022-09-21 21:37:03 INFO  # Optimization benchmark for data_corruption with args [['folktables', 'slow_loading', 'featurization_4', 'xgboost']] -- repetition 6 of 7
2022-09-21 21:37:03 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-21 21:37:03 INFO  Running instrumented original pipeline...
2022-09-21 21:37:03 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-21 21:37:03 INFO  ---RUNTIME: Importing and monkey-patching took 5.912065505981445 ms
2022-09-21 21:37:05 INFO  ---RUNTIME: Original pipeline execution took 2316.944122314453 ms (excluding imports and monkey-patching)
2022-09-21 21:37:05 INFO  Starting execution of 1 what-if analyses...
2022-09-21 21:37:05 INFO  Start plan generation for analysis DataCorruption...
2022-09-21 21:37:05 INFO  ---RUNTIME: Plan generation took 0.45752525329589844 ms
2022-09-21 21:37:05 INFO  Estimated runtime of original DAG is 788.3832454681396ms
2022-09-21 21:37:05 INFO  Performing Multi-Query Optimization
2022-09-21 21:37:06 INFO  Estimated unoptimized what-if runtime is 25228.26385498047ms
2022-09-21 21:37:06 INFO  Estimated optimised what-if runtime is 2289.1087532043457ms
2022-09-21 21:37:06 INFO  Estimated optimisation runtime saving is 22939.155101776123ms
2022-09-21 21:37:06 INFO  ---RUNTIME: Multi-Query Optimization took 96.85778617858887 ms
2022-09-21 21:37:06 INFO  Executing generated plans
2022-09-21 21:37:08 INFO  ---RUNTIME: Execution took 2350.4955768585205 ms
2022-09-21 21:37:08 INFO  Done!
2022-09-21 21:37:08 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-21 21:37:08 INFO  Running instrumented original pipeline...
2022-09-21 21:37:08 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-21 21:37:08 INFO  ---RUNTIME: Importing and monkey-patching took 5.643367767333984 ms
2022-09-21 21:37:10 INFO  ---RUNTIME: Original pipeline execution took 1914.2563343048096 ms (excluding imports and monkey-patching)
2022-09-21 21:37:10 INFO  Starting execution of 1 what-if analyses...
2022-09-21 21:37:10 INFO  Start plan generation for analysis DataCorruption...
2022-09-21 21:37:10 INFO  ---RUNTIME: Plan generation took 0.48995018005371094 ms
2022-09-21 21:37:10 INFO  Estimated runtime of original DAG is 658.7471961975098ms
2022-09-21 21:37:10 WARNING Skipping Multi-Query Optimization (instead, only applying patches)
2022-09-21 21:37:10 INFO  Estimated unoptimised what-if runtime is 21079.910278320312ms
2022-09-21 21:37:10 INFO  ---RUNTIME: Multi-Query Optimization took 25.2835750579834 ms
2022-09-21 21:37:10 INFO  Executing generated plans
2022-09-21 21:37:51 INFO  ---RUNTIME: Execution took 41023.260831832886 ms
2022-09-21 21:37:51 INFO  Done!
2022-09-21 21:37:51 INFO  # Finished -- repetition 6 of 7 
2022-09-21 21:37:51 INFO  # Optimization benchmark for data_corruption with args [['folktables', 'slow_loading', 'featurization_4', 'xgboost']] -- repetition 7 of 7
2022-09-21 21:37:51 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-21 21:37:51 INFO  Running instrumented original pipeline...
2022-09-21 21:37:51 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-21 21:37:51 INFO  ---RUNTIME: Importing and monkey-patching took 6.366729736328125 ms
2022-09-21 21:37:53 INFO  ---RUNTIME: Original pipeline execution took 2043.081283569336 ms (excluding imports and monkey-patching)
2022-09-21 21:37:53 INFO  Starting execution of 1 what-if analyses...
2022-09-21 21:37:53 INFO  Start plan generation for analysis DataCorruption...
2022-09-21 21:37:53 INFO  ---RUNTIME: Plan generation took 0.5476474761962891 ms
2022-09-21 21:37:53 INFO  Estimated runtime of original DAG is 770.9939479827881ms
2022-09-21 21:37:53 INFO  Performing Multi-Query Optimization
2022-09-21 21:37:53 INFO  Estimated unoptimized what-if runtime is 24671.80633544922ms
2022-09-21 21:37:53 INFO  Estimated optimised what-if runtime is 2449.357509613037ms
2022-09-21 21:37:53 INFO  Estimated optimisation runtime saving is 22222.44882583618ms
2022-09-21 21:37:53 INFO  ---RUNTIME: Multi-Query Optimization took 96.27103805541992 ms
2022-09-21 21:37:53 INFO  Executing generated plans
2022-09-21 21:37:56 INFO  ---RUNTIME: Execution took 2502.5994777679443 ms
2022-09-21 21:37:56 INFO  Done!
2022-09-21 21:37:56 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-21 21:37:56 INFO  Running instrumented original pipeline...
2022-09-21 21:37:56 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-21 21:37:56 INFO  ---RUNTIME: Importing and monkey-patching took 5.669355392456055 ms
2022-09-21 21:37:59 INFO  ---RUNTIME: Original pipeline execution took 3028.4438133239746 ms (excluding imports and monkey-patching)
2022-09-21 21:37:59 INFO  Starting execution of 1 what-if analyses...
2022-09-21 21:37:59 INFO  Start plan generation for analysis DataCorruption...
2022-09-21 21:37:59 INFO  ---RUNTIME: Plan generation took 0.5195140838623047 ms
2022-09-21 21:37:59 INFO  Estimated runtime of original DAG is 1723.06227684021ms
2022-09-21 21:37:59 WARNING Skipping Multi-Query Optimization (instead, only applying patches)
2022-09-21 21:37:59 INFO  Estimated unoptimised what-if runtime is 55137.99285888672ms
2022-09-21 21:37:59 INFO  ---RUNTIME: Multi-Query Optimization took 24.80006217956543 ms
2022-09-21 21:37:59 INFO  Executing generated plans
2022-09-21 21:38:40 INFO  ---RUNTIME: Execution took 41170.804500579834 ms
2022-09-21 21:38:40 INFO  Done!
2022-09-21 21:38:40 INFO  # Finished -- repetition 7 of 7 
2022-09-21 21:38:40 INFO  # Final results after all repetitions
2022-09-21 21:38:40 INFO     repetition  ... no_opt_what_if_execution_combined_model_training
0           0  ...                                     28625.828028
1           1  ...                                     30697.627783
2           2  ...                                     23391.880035
3           3  ...                                     44686.158419
4           4  ...                                     34889.069796
5           5  ...                                     27240.258455
6           6  ...                                     27649.490833

[7 rows x 26 columns]
taskset -c 64-71 PROTOCOL_BUFFERS_PYTHON_IMPLEMENTATION=python python3.9 benchmarks_end_to_end.py data_corruption folktables slow_loading featurization_4 neural_network
2022-09-21 21:38:42.378272: W tensorflow/stream_executor/platform/default/dso_loader.cc:64] Could not load dynamic library 'libcudart.so.11.0'; dlerror: libcudart.so.11.0: cannot open shared object file: No such file or directory; LD_LIBRARY_PATH: /home/sgrafbe/mlwhatif/venv/lib/python3.9/site-packages/cv2/../../lib64:
2022-09-21 21:38:42.378312: I tensorflow/stream_executor/cuda/cudart_stub.cc:29] Ignore above cudart dlerror if you do not have a GPU set up on your machine.
2022-09-21 21:38:43 INFO  Patching sys.argv with ['mlwhatif', 'folktables', 'slow_loading', 'featurization_4', 'neural_network']
2022-09-21 21:38:43 INFO  Running instrumented original pipeline...
2022-09-21 21:38:43 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-21 21:38:43 INFO  ---RUNTIME: Importing and monkey-patching took 95.95608711242676 ms
2022-09-21 21:38:45.218948: W tensorflow/stream_executor/platform/default/dso_loader.cc:64] Could not load dynamic library 'libcuda.so.1'; dlerror: libcuda.so.1: cannot open shared object file: No such file or directory; LD_LIBRARY_PATH: /home/sgrafbe/mlwhatif/venv/lib/python3.9/site-packages/cv2/../../lib64:
2022-09-21 21:38:45.218977: W tensorflow/stream_executor/cuda/cuda_driver.cc:326] failed call to cuInit: UNKNOWN ERROR (303)
2022-09-21 21:38:45.218995: I tensorflow/stream_executor/cuda/cuda_diagnostics.cc:156] kernel driver does not appear to be running on this host (wagyu): /proc/driver/nvidia/version does not exist
2022-09-21 21:38:45.219339: I tensorflow/core/platform/cpu_feature_guard.cc:142] This TensorFlow binary is optimized with oneAPI Deep Neural Network Library (oneDNN) to use the following CPU instructions in performance-critical operations:  AVX2 FMA
To enable them in other operations, rebuild TensorFlow with the appropriate compiler flags.
2022-09-21 21:38:45.754097: I tensorflow/compiler/mlir/mlir_graph_optimization_pass.cc:176] None of the MLIR Optimization Passes are enabled (registered 2)
2022-09-21 21:38:45.767369: I tensorflow/core/platform/profile_utils/cpu_utils.cc:114] CPU Frequency: 2595290000 Hz
2022-09-21 21:38:48 INFO  ---RUNTIME: Original pipeline execution took 5227.554798126221 ms (excluding imports and monkey-patching)
2022-09-21 21:38:48 INFO  Starting execution of 0 what-if analyses...
2022-09-21 21:38:48 INFO  Estimated runtime of original DAG is 3924.940586090088ms
2022-09-21 21:38:48 INFO  Performing Multi-Query Optimization
2022-09-21 21:38:48 INFO  Estimated unoptimized what-if runtime is 0ms
2022-09-21 21:38:48 INFO  Estimated optimised what-if runtime is 0ms
2022-09-21 21:38:48 INFO  Estimated optimisation runtime saving is 0ms
2022-09-21 21:38:48 INFO  ---RUNTIME: Multi-Query Optimization took 0.5235671997070312 ms
2022-09-21 21:38:48 INFO  Executing generated plans
2022-09-21 21:38:48 INFO  ---RUNTIME: Execution took 0.017881393432617188 ms
2022-09-21 21:38:48 INFO  Done!
2022-09-21 21:38:48 INFO  # Optimization benchmark for data_corruption with args [['folktables', 'slow_loading', 'featurization_4', 'neural_network']] -- repetition 1 of 7
2022-09-21 21:38:48 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-21 21:38:48 INFO  Running instrumented original pipeline...
2022-09-21 21:38:48 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-21 21:38:48 INFO  ---RUNTIME: Importing and monkey-patching took 5.308628082275391 ms
2022-09-21 21:38:53 INFO  ---RUNTIME: Original pipeline execution took 4941.412448883057 ms (excluding imports and monkey-patching)
2022-09-21 21:38:53 INFO  Starting execution of 1 what-if analyses...
2022-09-21 21:38:53 INFO  Start plan generation for analysis DataCorruption...
2022-09-21 21:38:53 INFO  ---RUNTIME: Plan generation took 0.5319118499755859 ms
2022-09-21 21:38:53 INFO  Estimated runtime of original DAG is 3644.278049468994ms
2022-09-21 21:38:53 INFO  Performing Multi-Query Optimization
2022-09-21 21:38:53 INFO  Estimated unoptimized what-if runtime is 116616.89758300781ms
2022-09-21 21:38:53 INFO  Estimated optimised what-if runtime is 8327.040910720825ms
2022-09-21 21:38:53 INFO  Estimated optimisation runtime saving is 108289.85667228699ms
2022-09-21 21:38:53 INFO  ---RUNTIME: Multi-Query Optimization took 98.06323051452637 ms
2022-09-21 21:38:53 INFO  Executing generated plans
2022-09-21 21:39:01 INFO  ---RUNTIME: Execution took 7758.8536739349365 ms
2022-09-21 21:39:01 INFO  Done!
2022-09-21 21:39:01 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-21 21:39:01 INFO  Running instrumented original pipeline...
2022-09-21 21:39:01 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-21 21:39:01 INFO  ---RUNTIME: Importing and monkey-patching took 6.223917007446289 ms
2022-09-21 21:39:07 INFO  ---RUNTIME: Original pipeline execution took 5324.774503707886 ms (excluding imports and monkey-patching)
2022-09-21 21:39:07 INFO  Starting execution of 1 what-if analyses...
2022-09-21 21:39:07 INFO  Start plan generation for analysis DataCorruption...
2022-09-21 21:39:07 INFO  ---RUNTIME: Plan generation took 0.48661231994628906 ms
2022-09-21 21:39:07 INFO  Estimated runtime of original DAG is 4038.2673740386963ms
2022-09-21 21:39:07 WARNING Skipping Multi-Query Optimization (instead, only applying patches)
2022-09-21 21:39:07 INFO  Estimated unoptimised what-if runtime is 129224.55596923828ms
2022-09-21 21:39:07 INFO  ---RUNTIME: Multi-Query Optimization took 24.793386459350586 ms
2022-09-21 21:39:07 INFO  Executing generated plans
2022-09-21 21:41:17 INFO  ---RUNTIME: Execution took 130377.51293182373 ms
2022-09-21 21:41:17 INFO  Done!
2022-09-21 21:41:17 INFO  # Finished -- repetition 1 of 7 
2022-09-21 21:41:17 INFO  # Optimization benchmark for data_corruption with args [['folktables', 'slow_loading', 'featurization_4', 'neural_network']] -- repetition 2 of 7
2022-09-21 21:41:17 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-21 21:41:17 INFO  Running instrumented original pipeline...
2022-09-21 21:41:17 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-21 21:41:17 INFO  ---RUNTIME: Importing and monkey-patching took 6.1550140380859375 ms
2022-09-21 21:41:22 INFO  ---RUNTIME: Original pipeline execution took 5129.238128662109 ms (excluding imports and monkey-patching)
2022-09-21 21:41:22 INFO  Starting execution of 1 what-if analyses...
2022-09-21 21:41:22 INFO  Start plan generation for analysis DataCorruption...
2022-09-21 21:41:22 INFO  ---RUNTIME: Plan generation took 0.5543231964111328 ms
2022-09-21 21:41:22 INFO  Estimated runtime of original DAG is 3827.098608016968ms
2022-09-21 21:41:22 INFO  Performing Multi-Query Optimization
2022-09-21 21:41:22 INFO  Estimated unoptimized what-if runtime is 122467.15545654297ms
2022-09-21 21:41:22 INFO  Estimated optimised what-if runtime is 8824.674844741821ms
2022-09-21 21:41:22 INFO  Estimated optimisation runtime saving is 113642.48061180115ms
2022-09-21 21:41:22 INFO  ---RUNTIME: Multi-Query Optimization took 98.66738319396973 ms
2022-09-21 21:41:22 INFO  Executing generated plans
2022-09-21 21:41:30 INFO  ---RUNTIME: Execution took 8111.413478851318 ms
2022-09-21 21:41:30 INFO  Done!
2022-09-21 21:41:30 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-21 21:41:30 INFO  Running instrumented original pipeline...
2022-09-21 21:41:30 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-21 21:41:30 INFO  ---RUNTIME: Importing and monkey-patching took 5.81812858581543 ms
2022-09-21 21:41:36 INFO  ---RUNTIME: Original pipeline execution took 5208.129167556763 ms (excluding imports and monkey-patching)
2022-09-21 21:41:36 INFO  Starting execution of 1 what-if analyses...
2022-09-21 21:41:36 INFO  Start plan generation for analysis DataCorruption...
2022-09-21 21:41:36 INFO  ---RUNTIME: Plan generation took 0.5085468292236328 ms
2022-09-21 21:41:36 INFO  Estimated runtime of original DAG is 3820.7433223724365ms
2022-09-21 21:41:36 WARNING Skipping Multi-Query Optimization (instead, only applying patches)
2022-09-21 21:41:36 INFO  Estimated unoptimised what-if runtime is 122263.78631591797ms
2022-09-21 21:41:36 INFO  ---RUNTIME: Multi-Query Optimization took 25.416851043701172 ms
2022-09-21 21:41:36 INFO  Executing generated plans
2022-09-21 21:43:49 INFO  ---RUNTIME: Execution took 133921.43535614014 ms
2022-09-21 21:43:49 INFO  Done!
2022-09-21 21:43:49 INFO  # Finished -- repetition 2 of 7 
2022-09-21 21:43:49 INFO  # Optimization benchmark for data_corruption with args [['folktables', 'slow_loading', 'featurization_4', 'neural_network']] -- repetition 3 of 7
2022-09-21 21:43:49 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-21 21:43:49 INFO  Running instrumented original pipeline...
2022-09-21 21:43:50 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-21 21:43:50 INFO  ---RUNTIME: Importing and monkey-patching took 5.945920944213867 ms
2022-09-21 21:43:55 INFO  ---RUNTIME: Original pipeline execution took 5438.570022583008 ms (excluding imports and monkey-patching)
2022-09-21 21:43:55 INFO  Starting execution of 1 what-if analyses...
2022-09-21 21:43:55 INFO  Start plan generation for analysis DataCorruption...
2022-09-21 21:43:55 INFO  ---RUNTIME: Plan generation took 0.4951953887939453 ms
2022-09-21 21:43:55 INFO  Estimated runtime of original DAG is 4041.5987968444824ms
2022-09-21 21:43:55 INFO  Performing Multi-Query Optimization
2022-09-21 21:43:55 INFO  Estimated unoptimized what-if runtime is 129331.16149902344ms
2022-09-21 21:43:55 INFO  Estimated optimised what-if runtime is 8813.90643119812ms
2022-09-21 21:43:55 INFO  Estimated optimisation runtime saving is 120517.25506782532ms
2022-09-21 21:43:55 INFO  ---RUNTIME: Multi-Query Optimization took 96.24195098876953 ms
2022-09-21 21:43:55 INFO  Executing generated plans
2022-09-21 21:44:05 INFO  ---RUNTIME: Execution took 9472.100496292114 ms
2022-09-21 21:44:05 INFO  Done!
2022-09-21 21:44:05 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-21 21:44:05 INFO  Running instrumented original pipeline...
2022-09-21 21:44:05 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-21 21:44:05 INFO  ---RUNTIME: Importing and monkey-patching took 7.0743560791015625 ms
2022-09-21 21:44:11 INFO  ---RUNTIME: Original pipeline execution took 6078.468799591064 ms (excluding imports and monkey-patching)
2022-09-21 21:44:11 INFO  Starting execution of 1 what-if analyses...
2022-09-21 21:44:11 INFO  Start plan generation for analysis DataCorruption...
2022-09-21 21:44:11 INFO  ---RUNTIME: Plan generation took 1.611948013305664 ms
2022-09-21 21:44:11 INFO  Estimated runtime of original DAG is 4455.6286334991455ms
2022-09-21 21:44:11 WARNING Skipping Multi-Query Optimization (instead, only applying patches)
2022-09-21 21:44:11 INFO  Estimated unoptimised what-if runtime is 142580.11627197266ms
2022-09-21 21:44:11 INFO  ---RUNTIME: Multi-Query Optimization took 24.669170379638672 ms
2022-09-21 21:44:11 INFO  Executing generated plans
2022-09-21 21:46:26 INFO  ---RUNTIME: Execution took 135222.92304039001 ms
2022-09-21 21:46:26 INFO  Done!
2022-09-21 21:46:26 INFO  # Finished -- repetition 3 of 7 
2022-09-21 21:46:26 INFO  # Optimization benchmark for data_corruption with args [['folktables', 'slow_loading', 'featurization_4', 'neural_network']] -- repetition 4 of 7
2022-09-21 21:46:26 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-21 21:46:26 INFO  Running instrumented original pipeline...
2022-09-21 21:46:26 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-21 21:46:26 INFO  ---RUNTIME: Importing and monkey-patching took 5.805015563964844 ms
2022-09-21 21:46:32 INFO  ---RUNTIME: Original pipeline execution took 5659.3756675720215 ms (excluding imports and monkey-patching)
2022-09-21 21:46:32 INFO  Starting execution of 1 what-if analyses...
2022-09-21 21:46:32 INFO  Start plan generation for analysis DataCorruption...
2022-09-21 21:46:32 INFO  ---RUNTIME: Plan generation took 0.5736351013183594 ms
2022-09-21 21:46:32 INFO  Estimated runtime of original DAG is 4333.595275878906ms
2022-09-21 21:46:32 INFO  Performing Multi-Query Optimization
2022-09-21 21:46:32 INFO  Estimated unoptimized what-if runtime is 138675.048828125ms
2022-09-21 21:46:32 INFO  Estimated optimised what-if runtime is 23822.725296020508ms
2022-09-21 21:46:32 INFO  Estimated optimisation runtime saving is 114852.32353210449ms
2022-09-21 21:46:32 INFO  ---RUNTIME: Multi-Query Optimization took 106.51469230651855 ms
2022-09-21 21:46:32 INFO  Executing generated plans
2022-09-21 21:46:40 INFO  ---RUNTIME: Execution took 8111.3526821136475 ms
2022-09-21 21:46:40 INFO  Done!
2022-09-21 21:46:40 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-21 21:46:40 INFO  Running instrumented original pipeline...
2022-09-21 21:46:40 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-21 21:46:40 INFO  ---RUNTIME: Importing and monkey-patching took 5.88226318359375 ms
2022-09-21 21:46:45 INFO  ---RUNTIME: Original pipeline execution took 5594.461679458618 ms (excluding imports and monkey-patching)
2022-09-21 21:46:45 INFO  Starting execution of 1 what-if analyses...
2022-09-21 21:46:45 INFO  Start plan generation for analysis DataCorruption...
2022-09-21 21:46:45 INFO  ---RUNTIME: Plan generation took 0.5338191986083984 ms
2022-09-21 21:46:45 INFO  Estimated runtime of original DAG is 4253.939867019653ms
2022-09-21 21:46:45 WARNING Skipping Multi-Query Optimization (instead, only applying patches)
2022-09-21 21:46:45 INFO  Estimated unoptimised what-if runtime is 136126.0757446289ms
2022-09-21 21:46:45 INFO  ---RUNTIME: Multi-Query Optimization took 25.24733543395996 ms
2022-09-21 21:46:45 INFO  Executing generated plans
2022-09-21 21:49:01 INFO  ---RUNTIME: Execution took 136054.97217178345 ms
2022-09-21 21:49:01 INFO  Done!
2022-09-21 21:49:01 INFO  # Finished -- repetition 4 of 7 
2022-09-21 21:49:01 INFO  # Optimization benchmark for data_corruption with args [['folktables', 'slow_loading', 'featurization_4', 'neural_network']] -- repetition 5 of 7
2022-09-21 21:49:01 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-21 21:49:01 INFO  Running instrumented original pipeline...
2022-09-21 21:49:01 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-21 21:49:02 INFO  ---RUNTIME: Importing and monkey-patching took 7.302761077880859 ms
2022-09-21 21:49:08 INFO  ---RUNTIME: Original pipeline execution took 6123.817443847656 ms (excluding imports and monkey-patching)
2022-09-21 21:49:08 INFO  Starting execution of 1 what-if analyses...
2022-09-21 21:49:08 INFO  Start plan generation for analysis DataCorruption...
2022-09-21 21:49:08 INFO  ---RUNTIME: Plan generation took 0.6213188171386719 ms
2022-09-21 21:49:08 INFO  Estimated runtime of original DAG is 4468.34397315979ms
2022-09-21 21:49:08 INFO  Performing Multi-Query Optimization
2022-09-21 21:49:08 INFO  Estimated unoptimized what-if runtime is 142987.00714111328ms
2022-09-21 21:49:08 INFO  Estimated optimised what-if runtime is 10405.211210250854ms
2022-09-21 21:49:08 INFO  Estimated optimisation runtime saving is 132581.79593086243ms
2022-09-21 21:49:08 INFO  ---RUNTIME: Multi-Query Optimization took 125.16379356384277 ms
2022-09-21 21:49:08 INFO  Executing generated plans
2022-09-21 21:49:16 INFO  ---RUNTIME: Execution took 8086.751699447632 ms
2022-09-21 21:49:16 INFO  Done!
2022-09-21 21:49:16 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-21 21:49:16 INFO  Running instrumented original pipeline...
2022-09-21 21:49:16 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-21 21:49:16 INFO  ---RUNTIME: Importing and monkey-patching took 5.836725234985352 ms
2022-09-21 21:49:21 INFO  ---RUNTIME: Original pipeline execution took 5392.004728317261 ms (excluding imports and monkey-patching)
2022-09-21 21:49:21 INFO  Starting execution of 1 what-if analyses...
2022-09-21 21:49:21 INFO  Start plan generation for analysis DataCorruption...
2022-09-21 21:49:21 INFO  ---RUNTIME: Plan generation took 0.4413127899169922 ms
2022-09-21 21:49:21 INFO  Estimated runtime of original DAG is 4028.6004543304443ms
2022-09-21 21:49:21 WARNING Skipping Multi-Query Optimization (instead, only applying patches)
2022-09-21 21:49:22 INFO  Estimated unoptimised what-if runtime is 128915.21453857422ms
2022-09-21 21:49:22 INFO  ---RUNTIME: Multi-Query Optimization took 440.5186176300049 ms
2022-09-21 21:49:22 INFO  Executing generated plans
2022-09-21 21:51:36 INFO  ---RUNTIME: Execution took 134757.2202682495 ms
2022-09-21 21:51:36 INFO  Done!
2022-09-21 21:51:36 INFO  # Finished -- repetition 5 of 7 
2022-09-21 21:51:36 INFO  # Optimization benchmark for data_corruption with args [['folktables', 'slow_loading', 'featurization_4', 'neural_network']] -- repetition 6 of 7
2022-09-21 21:51:36 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-21 21:51:36 INFO  Running instrumented original pipeline...
2022-09-21 21:51:36 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-21 21:51:36 INFO  ---RUNTIME: Importing and monkey-patching took 5.962133407592773 ms
2022-09-21 21:51:42 INFO  ---RUNTIME: Original pipeline execution took 5468.528985977173 ms (excluding imports and monkey-patching)
2022-09-21 21:51:42 INFO  Starting execution of 1 what-if analyses...
2022-09-21 21:51:42 INFO  Start plan generation for analysis DataCorruption...
2022-09-21 21:51:42 INFO  ---RUNTIME: Plan generation took 0.5280971527099609 ms
2022-09-21 21:51:42 INFO  Estimated runtime of original DAG is 4091.500997543335ms
2022-09-21 21:51:42 INFO  Performing Multi-Query Optimization
2022-09-21 21:51:42 INFO  Estimated unoptimized what-if runtime is 130928.03192138672ms
2022-09-21 21:51:42 INFO  Estimated optimised what-if runtime is 9178.693294525146ms
2022-09-21 21:51:42 INFO  Estimated optimisation runtime saving is 121749.33862686157ms
2022-09-21 21:51:42 INFO  ---RUNTIME: Multi-Query Optimization took 515.3720378875732 ms
2022-09-21 21:51:42 INFO  Executing generated plans
2022-09-21 21:51:50 INFO  ---RUNTIME: Execution took 8013.4687423706055 ms
2022-09-21 21:51:50 INFO  Done!
2022-09-21 21:51:50 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-21 21:51:50 INFO  Running instrumented original pipeline...
2022-09-21 21:51:50 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-21 21:51:50 INFO  ---RUNTIME: Importing and monkey-patching took 5.7506561279296875 ms
2022-09-21 21:51:56 INFO  ---RUNTIME: Original pipeline execution took 5271.858692169189 ms (excluding imports and monkey-patching)
2022-09-21 21:51:56 INFO  Starting execution of 1 what-if analyses...
2022-09-21 21:51:56 INFO  Start plan generation for analysis DataCorruption...
2022-09-21 21:51:56 INFO  ---RUNTIME: Plan generation took 0.5004405975341797 ms
2022-09-21 21:51:56 INFO  Estimated runtime of original DAG is 3972.1202850341797ms
2022-09-21 21:51:56 WARNING Skipping Multi-Query Optimization (instead, only applying patches)
2022-09-21 21:51:56 INFO  Estimated unoptimised what-if runtime is 127107.84912109375ms
2022-09-21 21:51:56 INFO  ---RUNTIME: Multi-Query Optimization took 24.876832962036133 ms
2022-09-21 21:51:56 INFO  Executing generated plans
2022-09-21 21:54:12 INFO  ---RUNTIME: Execution took 136744.30298805237 ms
2022-09-21 21:54:12 INFO  Done!
2022-09-21 21:54:12 INFO  # Finished -- repetition 6 of 7 
2022-09-21 21:54:12 INFO  # Optimization benchmark for data_corruption with args [['folktables', 'slow_loading', 'featurization_4', 'neural_network']] -- repetition 7 of 7
2022-09-21 21:54:12 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-21 21:54:12 INFO  Running instrumented original pipeline...
2022-09-21 21:54:13 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-21 21:54:13 INFO  ---RUNTIME: Importing and monkey-patching took 6.293058395385742 ms
2022-09-21 21:54:19 INFO  ---RUNTIME: Original pipeline execution took 6045.295715332031 ms (excluding imports and monkey-patching)
2022-09-21 21:54:19 INFO  Starting execution of 1 what-if analyses...
2022-09-21 21:54:19 INFO  Start plan generation for analysis DataCorruption...
2022-09-21 21:54:19 INFO  ---RUNTIME: Plan generation took 1.4095306396484375 ms
2022-09-21 21:54:19 INFO  Estimated runtime of original DAG is 4767.1661376953125ms
2022-09-21 21:54:19 INFO  Performing Multi-Query Optimization
2022-09-21 21:54:19 INFO  Estimated unoptimized what-if runtime is 152549.31640625ms
2022-09-21 21:54:19 INFO  Estimated optimised what-if runtime is 10115.805625915527ms
2022-09-21 21:54:19 INFO  Estimated optimisation runtime saving is 142433.51078033447ms
2022-09-21 21:54:19 INFO  ---RUNTIME: Multi-Query Optimization took 100.41594505310059 ms
2022-09-21 21:54:19 INFO  Executing generated plans
2022-09-21 21:54:27 INFO  ---RUNTIME: Execution took 8523.136138916016 ms
2022-09-21 21:54:27 INFO  Done!
2022-09-21 21:54:27 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-21 21:54:27 INFO  Running instrumented original pipeline...
2022-09-21 21:54:27 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-21 21:54:27 INFO  ---RUNTIME: Importing and monkey-patching took 6.50787353515625 ms
2022-09-21 21:54:33 INFO  ---RUNTIME: Original pipeline execution took 5451.169967651367 ms (excluding imports and monkey-patching)
2022-09-21 21:54:33 INFO  Starting execution of 1 what-if analyses...
2022-09-21 21:54:33 INFO  Start plan generation for analysis DataCorruption...
2022-09-21 21:54:33 INFO  ---RUNTIME: Plan generation took 0.6411075592041016 ms
2022-09-21 21:54:33 INFO  Estimated runtime of original DAG is 4104.41780090332ms
2022-09-21 21:54:33 WARNING Skipping Multi-Query Optimization (instead, only applying patches)
2022-09-21 21:54:33 INFO  Estimated unoptimised what-if runtime is 131341.36962890625ms
2022-09-21 21:54:33 INFO  ---RUNTIME: Multi-Query Optimization took 33.186912536621094 ms
2022-09-21 21:54:33 INFO  Executing generated plans
2022-09-21 21:56:48 INFO  ---RUNTIME: Execution took 135173.50602149963 ms
2022-09-21 21:56:48 INFO  Done!
2022-09-21 21:56:48 INFO  # Finished -- repetition 7 of 7 
2022-09-21 21:56:48 INFO  # Final results after all repetitions
2022-09-21 21:56:48 INFO     repetition  ... no_opt_what_if_execution_combined_model_training
0           0  ...                                    110816.199541
1           1  ...                                    114317.289591
2           2  ...                                    114997.429848
3           3  ...                                    116162.850380
4           4  ...                                    115123.533010
5           5  ...                                    116608.353376
6           6  ...                                    115782.741547

[7 rows x 26 columns]
