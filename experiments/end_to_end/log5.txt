Variant name from 1-8: 5
Cores to use: 160-168
taskset -c 160-168 PROTOCOL_BUFFERS_PYTHON_IMPLEMENTATION=python python3.9 benchmarks_end_to_end.py data_corruption reviews slow_loading featurization_0 logistic_regression
2022-09-20 20:14:47.185648: W tensorflow/stream_executor/platform/default/dso_loader.cc:64] Could not load dynamic library 'libcudart.so.11.0'; dlerror: libcudart.so.11.0: cannot open shared object file: No such file or directory; LD_LIBRARY_PATH: /home/sgrafbe/mlwhatif/venv/lib/python3.9/site-packages/cv2/../../lib64:
2022-09-20 20:14:47.185697: I tensorflow/stream_executor/cuda/cudart_stub.cc:29] Ignore above cudart dlerror if you do not have a GPU set up on your machine.
2022-09-20 20:14:48 INFO  Patching sys.argv with ['mlwhatif', 'reviews', 'slow_loading', 'featurization_0', 'logistic_regression']
2022-09-20 20:14:48 INFO  Running instrumented original pipeline...
2022-09-20 20:14:48 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-20 20:14:48 INFO  ---RUNTIME: Importing and monkey-patching took 121.35672569274902 ms
2022-09-20 20:14:55 INFO  ---RUNTIME: Original pipeline execution took 6978.409051895142 ms (excluding imports and monkey-patching)
2022-09-20 20:14:55 INFO  Starting execution of 0 what-if analyses...
2022-09-20 20:14:55 INFO  Estimated runtime of original DAG is 5309.4322681427ms
2022-09-20 20:14:55 INFO  Performing Multi-Query Optimization
2022-09-20 20:14:55 INFO  Estimated unoptimized what-if runtime is 0ms
2022-09-20 20:14:55 INFO  Estimated optimised what-if runtime is 0ms
2022-09-20 20:14:55 INFO  Estimated optimisation runtime saving is 0ms
2022-09-20 20:14:55 INFO  ---RUNTIME: Multi-Query Optimization took 0.5047321319580078 ms
2022-09-20 20:14:55 INFO  Executing generated plans
2022-09-20 20:14:55 INFO  ---RUNTIME: Execution took 0.024080276489257812 ms
2022-09-20 20:14:55 INFO  Done!
2022-09-20 20:14:55 INFO  # Optimization benchmark for data_corruption with args [['reviews', 'slow_loading', 'featurization_0', 'logistic_regression']] -- repetition 1 of 7
2022-09-20 20:14:55 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-20 20:14:55 INFO  Running instrumented original pipeline...
2022-09-20 20:14:55 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-20 20:14:55 INFO  ---RUNTIME: Importing and monkey-patching took 5.860567092895508 ms
2022-09-20 20:15:02 INFO  ---RUNTIME: Original pipeline execution took 7089.812517166138 ms (excluding imports and monkey-patching)
2022-09-20 20:15:02 INFO  Starting execution of 1 what-if analyses...
2022-09-20 20:15:02 INFO  Start plan generation for analysis DataCorruption...
2022-09-20 20:15:02 INFO  ---RUNTIME: Plan generation took 0.46515464782714844 ms
2022-09-20 20:15:02 INFO  Estimated runtime of original DAG is 5291.116714477539ms
2022-09-20 20:15:02 INFO  Performing Multi-Query Optimization
2022-09-20 20:15:02 INFO  Estimated unoptimized what-if runtime is 132277.91786193848ms
2022-09-20 20:15:02 INFO  Estimated optimised what-if runtime is 11938.609838485718ms
2022-09-20 20:15:02 INFO  Estimated optimisation runtime saving is 120339.30802345276ms
2022-09-20 20:15:02 INFO  ---RUNTIME: Multi-Query Optimization took 59.41438674926758 ms
2022-09-20 20:15:02 INFO  Executing generated plans
2022-09-20 20:15:20 INFO  ---RUNTIME: Execution took 17789.528369903564 ms
2022-09-20 20:15:20 INFO  Done!
2022-09-20 20:15:20 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-20 20:15:20 INFO  Running instrumented original pipeline...
2022-09-20 20:15:20 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-20 20:15:20 INFO  ---RUNTIME: Importing and monkey-patching took 6.455421447753906 ms
2022-09-20 20:15:27 INFO  ---RUNTIME: Original pipeline execution took 6960.491418838501 ms (excluding imports and monkey-patching)
2022-09-20 20:15:27 INFO  Starting execution of 1 what-if analyses...
2022-09-20 20:15:27 INFO  Start plan generation for analysis DataCorruption...
2022-09-20 20:15:27 INFO  ---RUNTIME: Plan generation took 0.5178451538085938 ms
2022-09-20 20:15:27 INFO  Estimated runtime of original DAG is 5299.772500991821ms
2022-09-20 20:15:27 WARNING Skipping Multi-Query Optimization (instead, only combine execution DAGs)
2022-09-20 20:15:27 INFO  Estimated unoptimised what-if runtime is 132494.31252479553ms
2022-09-20 20:15:27 INFO  ---RUNTIME: Multi-Query Optimization took 125.34284591674805 ms
2022-09-20 20:15:27 INFO  Executing generated plans
2022-09-20 20:18:16 INFO  ---RUNTIME: Execution took 169082.44276046753 ms
2022-09-20 20:18:16 INFO  Done!
2022-09-20 20:18:16 INFO  # Finished -- repetition 1 of 7 
2022-09-20 20:18:16 INFO  # Optimization benchmark for data_corruption with args [['reviews', 'slow_loading', 'featurization_0', 'logistic_regression']] -- repetition 2 of 7
2022-09-20 20:18:16 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-20 20:18:16 INFO  Running instrumented original pipeline...
2022-09-20 20:18:16 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-20 20:18:16 INFO  ---RUNTIME: Importing and monkey-patching took 6.721258163452148 ms
2022-09-20 20:18:23 INFO  ---RUNTIME: Original pipeline execution took 6926.887512207031 ms (excluding imports and monkey-patching)
2022-09-20 20:18:23 INFO  Starting execution of 1 what-if analyses...
2022-09-20 20:18:23 INFO  Start plan generation for analysis DataCorruption...
2022-09-20 20:18:23 INFO  ---RUNTIME: Plan generation took 0.4680156707763672 ms
2022-09-20 20:18:23 INFO  Estimated runtime of original DAG is 5265.505313873291ms
2022-09-20 20:18:23 INFO  Performing Multi-Query Optimization
2022-09-20 20:18:23 INFO  Estimated unoptimized what-if runtime is 131637.63284683228ms
2022-09-20 20:18:23 INFO  Estimated optimised what-if runtime is 11795.589923858643ms
2022-09-20 20:18:23 INFO  Estimated optimisation runtime saving is 119842.04292297363ms
2022-09-20 20:18:23 INFO  ---RUNTIME: Multi-Query Optimization took 58.44902992248535 ms
2022-09-20 20:18:23 INFO  Executing generated plans
2022-09-20 20:18:41 INFO  ---RUNTIME: Execution took 17878.554582595825 ms
2022-09-20 20:18:41 INFO  Done!
2022-09-20 20:18:41 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-20 20:18:41 INFO  Running instrumented original pipeline...
2022-09-20 20:18:41 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-20 20:18:41 INFO  ---RUNTIME: Importing and monkey-patching took 5.893707275390625 ms
2022-09-20 20:18:48 INFO  ---RUNTIME: Original pipeline execution took 7017.8632736206055 ms (excluding imports and monkey-patching)
2022-09-20 20:18:48 INFO  Starting execution of 1 what-if analyses...
2022-09-20 20:18:48 INFO  Start plan generation for analysis DataCorruption...
2022-09-20 20:18:48 INFO  ---RUNTIME: Plan generation took 0.4532337188720703 ms
2022-09-20 20:18:48 INFO  Estimated runtime of original DAG is 5346.107482910156ms
2022-09-20 20:18:48 WARNING Skipping Multi-Query Optimization (instead, only combine execution DAGs)
2022-09-20 20:18:48 INFO  Estimated unoptimised what-if runtime is 133652.6870727539ms
2022-09-20 20:18:48 INFO  ---RUNTIME: Multi-Query Optimization took 347.5451469421387 ms
2022-09-20 20:18:48 INFO  Executing generated plans
2022-09-20 20:21:37 INFO  ---RUNTIME: Execution took 168138.4735107422 ms
2022-09-20 20:21:37 INFO  Done!
2022-09-20 20:21:37 INFO  # Finished -- repetition 2 of 7 
2022-09-20 20:21:37 INFO  # Optimization benchmark for data_corruption with args [['reviews', 'slow_loading', 'featurization_0', 'logistic_regression']] -- repetition 3 of 7
2022-09-20 20:21:37 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-20 20:21:37 INFO  Running instrumented original pipeline...
2022-09-20 20:21:37 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-20 20:21:37 INFO  ---RUNTIME: Importing and monkey-patching took 6.540060043334961 ms
2022-09-20 20:21:44 INFO  ---RUNTIME: Original pipeline execution took 7722.906827926636 ms (excluding imports and monkey-patching)
2022-09-20 20:21:44 INFO  Starting execution of 1 what-if analyses...
2022-09-20 20:21:44 INFO  Start plan generation for analysis DataCorruption...
2022-09-20 20:21:44 INFO  ---RUNTIME: Plan generation took 0.41031837463378906 ms
2022-09-20 20:21:44 INFO  Estimated runtime of original DAG is 6040.182590484619ms
2022-09-20 20:21:44 INFO  Performing Multi-Query Optimization
2022-09-20 20:21:44 INFO  Estimated unoptimized what-if runtime is 151004.56476211548ms
2022-09-20 20:21:44 INFO  Estimated optimised what-if runtime is 12622.283935546875ms
2022-09-20 20:21:44 INFO  Estimated optimisation runtime saving is 138382.2808265686ms
2022-09-20 20:21:44 INFO  ---RUNTIME: Multi-Query Optimization took 58.01200866699219 ms
2022-09-20 20:21:44 INFO  Executing generated plans
2022-09-20 20:22:02 INFO  ---RUNTIME: Execution took 17841.0005569458 ms
2022-09-20 20:22:02 INFO  Done!
2022-09-20 20:22:02 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-20 20:22:02 INFO  Running instrumented original pipeline...
2022-09-20 20:22:02 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-20 20:22:02 INFO  ---RUNTIME: Importing and monkey-patching took 6.548166275024414 ms
2022-09-20 20:22:09 INFO  ---RUNTIME: Original pipeline execution took 6981.553554534912 ms (excluding imports and monkey-patching)
2022-09-20 20:22:09 INFO  Starting execution of 1 what-if analyses...
2022-09-20 20:22:09 INFO  Start plan generation for analysis DataCorruption...
2022-09-20 20:22:09 INFO  ---RUNTIME: Plan generation took 0.42748451232910156 ms
2022-09-20 20:22:09 INFO  Estimated runtime of original DAG is 5292.600631713867ms
2022-09-20 20:22:09 WARNING Skipping Multi-Query Optimization (instead, only combine execution DAGs)
2022-09-20 20:22:09 INFO  Estimated unoptimised what-if runtime is 132315.01579284668ms
2022-09-20 20:22:09 INFO  ---RUNTIME: Multi-Query Optimization took 124.47309494018555 ms
2022-09-20 20:22:09 INFO  Executing generated plans
2022-09-20 20:24:58 INFO  ---RUNTIME: Execution took 168471.5540409088 ms
2022-09-20 20:24:58 INFO  Done!
2022-09-20 20:24:58 INFO  # Finished -- repetition 3 of 7 
2022-09-20 20:24:58 INFO  # Optimization benchmark for data_corruption with args [['reviews', 'slow_loading', 'featurization_0', 'logistic_regression']] -- repetition 4 of 7
2022-09-20 20:24:58 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-20 20:24:58 INFO  Running instrumented original pipeline...
2022-09-20 20:24:58 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-20 20:24:58 INFO  ---RUNTIME: Importing and monkey-patching took 7.309436798095703 ms
2022-09-20 20:25:05 INFO  ---RUNTIME: Original pipeline execution took 7050.928592681885 ms (excluding imports and monkey-patching)
2022-09-20 20:25:05 INFO  Starting execution of 1 what-if analyses...
2022-09-20 20:25:05 INFO  Start plan generation for analysis DataCorruption...
2022-09-20 20:25:05 INFO  ---RUNTIME: Plan generation took 0.4444122314453125 ms
2022-09-20 20:25:05 INFO  Estimated runtime of original DAG is 5349.62272644043ms
2022-09-20 20:25:05 INFO  Performing Multi-Query Optimization
2022-09-20 20:25:05 INFO  Estimated unoptimized what-if runtime is 133740.56816101074ms
2022-09-20 20:25:05 INFO  Estimated optimised what-if runtime is 11912.36400604248ms
2022-09-20 20:25:05 INFO  Estimated optimisation runtime saving is 121828.20415496826ms
2022-09-20 20:25:05 INFO  ---RUNTIME: Multi-Query Optimization took 307.94572830200195 ms
2022-09-20 20:25:05 INFO  Executing generated plans
2022-09-20 20:25:23 INFO  ---RUNTIME: Execution took 18095.659494400024 ms
2022-09-20 20:25:23 INFO  Done!
2022-09-20 20:25:23 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-20 20:25:23 INFO  Running instrumented original pipeline...
2022-09-20 20:25:23 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-20 20:25:23 INFO  ---RUNTIME: Importing and monkey-patching took 5.867719650268555 ms
2022-09-20 20:25:30 INFO  ---RUNTIME: Original pipeline execution took 7018.733978271484 ms (excluding imports and monkey-patching)
2022-09-20 20:25:30 INFO  Starting execution of 1 what-if analyses...
2022-09-20 20:25:30 INFO  Start plan generation for analysis DataCorruption...
2022-09-20 20:25:30 INFO  ---RUNTIME: Plan generation took 0.44727325439453125 ms
2022-09-20 20:25:30 INFO  Estimated runtime of original DAG is 5301.948308944702ms
2022-09-20 20:25:30 WARNING Skipping Multi-Query Optimization (instead, only combine execution DAGs)
2022-09-20 20:25:31 INFO  Estimated unoptimised what-if runtime is 132548.70772361755ms
2022-09-20 20:25:31 INFO  ---RUNTIME: Multi-Query Optimization took 126.42621994018555 ms
2022-09-20 20:25:31 INFO  Executing generated plans
2022-09-20 20:28:19 INFO  ---RUNTIME: Execution took 168376.54519081116 ms
2022-09-20 20:28:19 INFO  Done!
2022-09-20 20:28:19 INFO  # Finished -- repetition 4 of 7 
2022-09-20 20:28:19 INFO  # Optimization benchmark for data_corruption with args [['reviews', 'slow_loading', 'featurization_0', 'logistic_regression']] -- repetition 5 of 7
2022-09-20 20:28:19 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-20 20:28:19 INFO  Running instrumented original pipeline...
2022-09-20 20:28:19 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-20 20:28:19 INFO  ---RUNTIME: Importing and monkey-patching took 6.782293319702148 ms
2022-09-20 20:28:27 INFO  ---RUNTIME: Original pipeline execution took 7706.281423568726 ms (excluding imports and monkey-patching)
2022-09-20 20:28:27 INFO  Starting execution of 1 what-if analyses...
2022-09-20 20:28:27 INFO  Start plan generation for analysis DataCorruption...
2022-09-20 20:28:27 INFO  ---RUNTIME: Plan generation took 0.43272972106933594 ms
2022-09-20 20:28:27 INFO  Estimated runtime of original DAG is 5999.070405960083ms
2022-09-20 20:28:27 INFO  Performing Multi-Query Optimization
2022-09-20 20:28:27 INFO  Estimated unoptimized what-if runtime is 149976.76014900208ms
2022-09-20 20:28:27 INFO  Estimated optimised what-if runtime is 12579.395771026611ms
2022-09-20 20:28:27 INFO  Estimated optimisation runtime saving is 137397.36437797546ms
2022-09-20 20:28:27 INFO  ---RUNTIME: Multi-Query Optimization took 57.98029899597168 ms
2022-09-20 20:28:27 INFO  Executing generated plans
2022-09-20 20:28:45 INFO  ---RUNTIME: Execution took 17936.360120773315 ms
2022-09-20 20:28:45 INFO  Done!
2022-09-20 20:28:45 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-20 20:28:45 INFO  Running instrumented original pipeline...
2022-09-20 20:28:45 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-20 20:28:45 INFO  ---RUNTIME: Importing and monkey-patching took 6.548881530761719 ms
2022-09-20 20:28:52 INFO  ---RUNTIME: Original pipeline execution took 6999.4401931762695 ms (excluding imports and monkey-patching)
2022-09-20 20:28:52 INFO  Starting execution of 1 what-if analyses...
2022-09-20 20:28:52 INFO  Start plan generation for analysis DataCorruption...
2022-09-20 20:28:52 INFO  ---RUNTIME: Plan generation took 0.44345855712890625 ms
2022-09-20 20:28:52 INFO  Estimated runtime of original DAG is 5301.995515823364ms
2022-09-20 20:28:52 WARNING Skipping Multi-Query Optimization (instead, only combine execution DAGs)
2022-09-20 20:28:52 INFO  Estimated unoptimised what-if runtime is 132549.8878955841ms
2022-09-20 20:28:52 INFO  ---RUNTIME: Multi-Query Optimization took 126.07598304748535 ms
2022-09-20 20:28:52 INFO  Executing generated plans
2022-09-20 20:31:39 INFO  ---RUNTIME: Execution took 167562.02149391174 ms
2022-09-20 20:31:39 INFO  Done!
2022-09-20 20:31:39 INFO  # Finished -- repetition 5 of 7 
2022-09-20 20:31:39 INFO  # Optimization benchmark for data_corruption with args [['reviews', 'slow_loading', 'featurization_0', 'logistic_regression']] -- repetition 6 of 7
2022-09-20 20:31:39 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-20 20:31:39 INFO  Running instrumented original pipeline...
2022-09-20 20:31:39 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-20 20:31:39 INFO  ---RUNTIME: Importing and monkey-patching took 6.762266159057617 ms
2022-09-20 20:31:47 INFO  ---RUNTIME: Original pipeline execution took 7331.390380859375 ms (excluding imports and monkey-patching)
2022-09-20 20:31:47 INFO  Starting execution of 1 what-if analyses...
2022-09-20 20:31:47 INFO  Start plan generation for analysis DataCorruption...
2022-09-20 20:31:47 INFO  ---RUNTIME: Plan generation took 0.4391670227050781 ms
2022-09-20 20:31:47 INFO  Estimated runtime of original DAG is 5355.627775192261ms
2022-09-20 20:31:47 INFO  Performing Multi-Query Optimization
2022-09-20 20:31:47 INFO  Estimated unoptimized what-if runtime is 133890.69437980652ms
2022-09-20 20:31:47 INFO  Estimated optimised what-if runtime is 11989.805698394775ms
2022-09-20 20:31:47 INFO  Estimated optimisation runtime saving is 121900.88868141174ms
2022-09-20 20:31:47 INFO  ---RUNTIME: Multi-Query Optimization took 58.27450752258301 ms
2022-09-20 20:31:47 INFO  Executing generated plans
2022-09-20 20:32:05 INFO  ---RUNTIME: Execution took 18113.0428314209 ms
2022-09-20 20:32:05 INFO  Done!
2022-09-20 20:32:05 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-20 20:32:05 INFO  Running instrumented original pipeline...
2022-09-20 20:32:05 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-20 20:32:05 INFO  ---RUNTIME: Importing and monkey-patching took 6.662130355834961 ms
2022-09-20 20:32:12 INFO  ---RUNTIME: Original pipeline execution took 7061.326742172241 ms (excluding imports and monkey-patching)
2022-09-20 20:32:12 INFO  Starting execution of 1 what-if analyses...
2022-09-20 20:32:12 INFO  Start plan generation for analysis DataCorruption...
2022-09-20 20:32:12 INFO  ---RUNTIME: Plan generation took 0.4341602325439453 ms
2022-09-20 20:32:12 INFO  Estimated runtime of original DAG is 5336.517333984375ms
2022-09-20 20:32:12 WARNING Skipping Multi-Query Optimization (instead, only combine execution DAGs)
2022-09-20 20:32:12 INFO  Estimated unoptimised what-if runtime is 133412.93334960938ms
2022-09-20 20:32:12 INFO  ---RUNTIME: Multi-Query Optimization took 125.66852569580078 ms
2022-09-20 20:32:12 INFO  Executing generated plans
2022-09-20 20:35:00 INFO  ---RUNTIME: Execution took 167774.70684051514 ms
2022-09-20 20:35:00 INFO  Done!
2022-09-20 20:35:00 INFO  # Finished -- repetition 6 of 7 
2022-09-20 20:35:00 INFO  # Optimization benchmark for data_corruption with args [['reviews', 'slow_loading', 'featurization_0', 'logistic_regression']] -- repetition 7 of 7
2022-09-20 20:35:00 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-20 20:35:00 INFO  Running instrumented original pipeline...
2022-09-20 20:35:00 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-20 20:35:00 INFO  ---RUNTIME: Importing and monkey-patching took 6.9484710693359375 ms
2022-09-20 20:35:08 INFO  ---RUNTIME: Original pipeline execution took 7937.996864318848 ms (excluding imports and monkey-patching)
2022-09-20 20:35:08 INFO  Starting execution of 1 what-if analyses...
2022-09-20 20:35:08 INFO  Start plan generation for analysis DataCorruption...
2022-09-20 20:35:08 INFO  ---RUNTIME: Plan generation took 0.4324913024902344 ms
2022-09-20 20:35:08 INFO  Estimated runtime of original DAG is 6220.03436088562ms
2022-09-20 20:35:08 INFO  Performing Multi-Query Optimization
2022-09-20 20:35:08 INFO  Estimated unoptimized what-if runtime is 155500.8590221405ms
2022-09-20 20:35:08 INFO  Estimated optimised what-if runtime is 12808.25138092041ms
2022-09-20 20:35:08 INFO  Estimated optimisation runtime saving is 142692.6076412201ms
2022-09-20 20:35:08 INFO  ---RUNTIME: Multi-Query Optimization took 58.409690856933594 ms
2022-09-20 20:35:08 INFO  Executing generated plans
2022-09-20 20:35:26 INFO  ---RUNTIME: Execution took 17904.900550842285 ms
2022-09-20 20:35:26 INFO  Done!
2022-09-20 20:35:26 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-20 20:35:26 INFO  Running instrumented original pipeline...
2022-09-20 20:35:26 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-20 20:35:26 INFO  ---RUNTIME: Importing and monkey-patching took 6.066560745239258 ms
2022-09-20 20:35:33 INFO  ---RUNTIME: Original pipeline execution took 7057.767868041992 ms (excluding imports and monkey-patching)
2022-09-20 20:35:33 INFO  Starting execution of 1 what-if analyses...
2022-09-20 20:35:33 INFO  Start plan generation for analysis DataCorruption...
2022-09-20 20:35:33 INFO  ---RUNTIME: Plan generation took 0.41866302490234375 ms
2022-09-20 20:35:33 INFO  Estimated runtime of original DAG is 5337.992191314697ms
2022-09-20 20:35:33 WARNING Skipping Multi-Query Optimization (instead, only combine execution DAGs)
2022-09-20 20:35:33 INFO  Estimated unoptimised what-if runtime is 133449.80478286743ms
2022-09-20 20:35:33 INFO  ---RUNTIME: Multi-Query Optimization took 126.18136405944824 ms
2022-09-20 20:35:33 INFO  Executing generated plans
2022-09-20 20:38:22 INFO  ---RUNTIME: Execution took 169180.59182167053 ms
2022-09-20 20:38:22 INFO  Done!
2022-09-20 20:38:22 INFO  # Finished -- repetition 7 of 7 
2022-09-20 20:38:22 INFO  # Final results after all repetitions
2022-09-20 20:38:22 INFO     repetition  ... no_opt_what_if_execution_combined_model_training
0           0  ...                                      4002.565145
1           1  ...                                      4028.404713
2           2  ...                                      4045.273542
3           3  ...                                      4012.289047
4           4  ...                                      4019.738913
5           5  ...                                      3998.523712
6           6  ...                                      4033.284903

[7 rows x 26 columns]
taskset -c 160-168 PROTOCOL_BUFFERS_PYTHON_IMPLEMENTATION=python python3.9 benchmarks_end_to_end.py data_corruption reviews slow_loading featurization_0 xgboost
2022-09-20 20:38:25.012585: W tensorflow/stream_executor/platform/default/dso_loader.cc:64] Could not load dynamic library 'libcudart.so.11.0'; dlerror: libcudart.so.11.0: cannot open shared object file: No such file or directory; LD_LIBRARY_PATH: /home/sgrafbe/mlwhatif/venv/lib/python3.9/site-packages/cv2/../../lib64:
2022-09-20 20:38:25.012632: I tensorflow/stream_executor/cuda/cudart_stub.cc:29] Ignore above cudart dlerror if you do not have a GPU set up on your machine.
2022-09-20 20:38:26 INFO  Patching sys.argv with ['mlwhatif', 'reviews', 'slow_loading', 'featurization_0', 'xgboost']
2022-09-20 20:38:26 INFO  Running instrumented original pipeline...
2022-09-20 20:38:26 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-20 20:38:26 INFO  ---RUNTIME: Importing and monkey-patching took 122.7414608001709 ms
2022-09-20 20:38:37 INFO  ---RUNTIME: Original pipeline execution took 10776.55816078186 ms (excluding imports and monkey-patching)
2022-09-20 20:38:37 INFO  Starting execution of 0 what-if analyses...
2022-09-20 20:38:37 INFO  Estimated runtime of original DAG is 9110.143899917603ms
2022-09-20 20:38:37 INFO  Performing Multi-Query Optimization
2022-09-20 20:38:37 INFO  Estimated unoptimized what-if runtime is 0ms
2022-09-20 20:38:37 INFO  Estimated optimised what-if runtime is 0ms
2022-09-20 20:38:37 INFO  Estimated optimisation runtime saving is 0ms
2022-09-20 20:38:37 INFO  ---RUNTIME: Multi-Query Optimization took 0.5552768707275391 ms
2022-09-20 20:38:37 INFO  Executing generated plans
2022-09-20 20:38:37 INFO  ---RUNTIME: Execution took 0.024557113647460938 ms
2022-09-20 20:38:37 INFO  Done!
2022-09-20 20:38:37 INFO  # Optimization benchmark for data_corruption with args [['reviews', 'slow_loading', 'featurization_0', 'xgboost']] -- repetition 1 of 7
2022-09-20 20:38:37 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-20 20:38:37 INFO  Running instrumented original pipeline...
2022-09-20 20:38:37 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-20 20:38:37 INFO  ---RUNTIME: Importing and monkey-patching took 5.944967269897461 ms
2022-09-20 20:38:44 INFO  ---RUNTIME: Original pipeline execution took 7704.194068908691 ms (excluding imports and monkey-patching)
2022-09-20 20:38:44 INFO  Starting execution of 1 what-if analyses...
2022-09-20 20:38:44 INFO  Start plan generation for analysis DataCorruption...
2022-09-20 20:38:44 INFO  ---RUNTIME: Plan generation took 0.4343986511230469 ms
2022-09-20 20:38:44 INFO  Estimated runtime of original DAG is 5914.101362228394ms
2022-09-20 20:38:44 INFO  Performing Multi-Query Optimization
2022-09-20 20:38:44 INFO  Estimated unoptimized what-if runtime is 147852.53405570984ms
2022-09-20 20:38:44 INFO  Estimated optimised what-if runtime is 13494.971513748169ms
2022-09-20 20:38:44 INFO  Estimated optimisation runtime saving is 134357.56254196167ms
2022-09-20 20:38:44 INFO  ---RUNTIME: Multi-Query Optimization took 59.0062141418457 ms
2022-09-20 20:38:44 INFO  Executing generated plans
2022-09-20 20:39:04 INFO  ---RUNTIME: Execution took 19545.690774917603 ms
2022-09-20 20:39:04 INFO  Done!
2022-09-20 20:39:04 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-20 20:39:04 INFO  Running instrumented original pipeline...
2022-09-20 20:39:04 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-20 20:39:04 INFO  ---RUNTIME: Importing and monkey-patching took 6.303310394287109 ms
2022-09-20 20:39:12 INFO  ---RUNTIME: Original pipeline execution took 7559.649229049683 ms (excluding imports and monkey-patching)
2022-09-20 20:39:12 INFO  Starting execution of 1 what-if analyses...
2022-09-20 20:39:12 INFO  Start plan generation for analysis DataCorruption...
2022-09-20 20:39:12 INFO  ---RUNTIME: Plan generation took 0.4439353942871094 ms
2022-09-20 20:39:12 INFO  Estimated runtime of original DAG is 5917.625904083252ms
2022-09-20 20:39:12 WARNING Skipping Multi-Query Optimization (instead, only combine execution DAGs)
2022-09-20 20:39:12 INFO  Estimated unoptimised what-if runtime is 147940.6476020813ms
2022-09-20 20:39:12 INFO  ---RUNTIME: Multi-Query Optimization took 125.25200843811035 ms
2022-09-20 20:39:12 INFO  Executing generated plans
2022-09-20 20:42:20 INFO  ---RUNTIME: Execution took 187770.33257484436 ms
2022-09-20 20:42:20 INFO  Done!
2022-09-20 20:42:20 INFO  # Finished -- repetition 1 of 7 
2022-09-20 20:42:20 INFO  # Optimization benchmark for data_corruption with args [['reviews', 'slow_loading', 'featurization_0', 'xgboost']] -- repetition 2 of 7
2022-09-20 20:42:20 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-20 20:42:20 INFO  Running instrumented original pipeline...
2022-09-20 20:42:20 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-20 20:42:20 INFO  ---RUNTIME: Importing and monkey-patching took 6.260156631469727 ms
2022-09-20 20:42:28 INFO  ---RUNTIME: Original pipeline execution took 8005.056858062744 ms (excluding imports and monkey-patching)
2022-09-20 20:42:28 INFO  Starting execution of 1 what-if analyses...
2022-09-20 20:42:28 INFO  Start plan generation for analysis DataCorruption...
2022-09-20 20:42:28 INFO  ---RUNTIME: Plan generation took 0.4425048828125 ms
2022-09-20 20:42:28 INFO  Estimated runtime of original DAG is 6212.41021156311ms
2022-09-20 20:42:28 INFO  Performing Multi-Query Optimization
2022-09-20 20:42:28 INFO  Estimated unoptimized what-if runtime is 155310.25528907776ms
2022-09-20 20:42:28 INFO  Estimated optimised what-if runtime is 13822.84927368164ms
2022-09-20 20:42:28 INFO  Estimated optimisation runtime saving is 141487.40601539612ms
2022-09-20 20:42:28 INFO  ---RUNTIME: Multi-Query Optimization took 58.28356742858887 ms
2022-09-20 20:42:28 INFO  Executing generated plans
2022-09-20 20:42:47 INFO  ---RUNTIME: Execution took 19416.678190231323 ms
2022-09-20 20:42:47 INFO  Done!
2022-09-20 20:42:47 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-20 20:42:47 INFO  Running instrumented original pipeline...
2022-09-20 20:42:47 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-20 20:42:47 INFO  ---RUNTIME: Importing and monkey-patching took 5.854129791259766 ms
2022-09-20 20:42:55 INFO  ---RUNTIME: Original pipeline execution took 7705.770969390869 ms (excluding imports and monkey-patching)
2022-09-20 20:42:55 INFO  Starting execution of 1 what-if analyses...
2022-09-20 20:42:55 INFO  Start plan generation for analysis DataCorruption...
2022-09-20 20:42:55 INFO  ---RUNTIME: Plan generation took 0.4074573516845703 ms
2022-09-20 20:42:55 INFO  Estimated runtime of original DAG is 6013.611793518066ms
2022-09-20 20:42:55 WARNING Skipping Multi-Query Optimization (instead, only combine execution DAGs)
2022-09-20 20:42:55 INFO  Estimated unoptimised what-if runtime is 150340.29483795166ms
2022-09-20 20:42:55 INFO  ---RUNTIME: Multi-Query Optimization took 335.5576992034912 ms
2022-09-20 20:42:55 INFO  Executing generated plans
2022-09-20 20:46:03 INFO  ---RUNTIME: Execution took 187580.27696609497 ms
2022-09-20 20:46:03 INFO  Done!
2022-09-20 20:46:03 INFO  # Finished -- repetition 2 of 7 
2022-09-20 20:46:03 INFO  # Optimization benchmark for data_corruption with args [['reviews', 'slow_loading', 'featurization_0', 'xgboost']] -- repetition 3 of 7
2022-09-20 20:46:03 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-20 20:46:03 INFO  Running instrumented original pipeline...
2022-09-20 20:46:03 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-20 20:46:03 INFO  ---RUNTIME: Importing and monkey-patching took 8.485555648803711 ms
2022-09-20 20:46:13 INFO  ---RUNTIME: Original pipeline execution took 9891.671657562256 ms (excluding imports and monkey-patching)
2022-09-20 20:46:13 INFO  Starting execution of 1 what-if analyses...
2022-09-20 20:46:13 INFO  Start plan generation for analysis DataCorruption...
2022-09-20 20:46:13 INFO  ---RUNTIME: Plan generation took 0.4951953887939453 ms
2022-09-20 20:46:13 INFO  Estimated runtime of original DAG is 7594.177484512329ms
2022-09-20 20:46:13 INFO  Performing Multi-Query Optimization
2022-09-20 20:46:13 INFO  Estimated unoptimized what-if runtime is 189854.43711280823ms
2022-09-20 20:46:13 INFO  Estimated optimised what-if runtime is 15228.509664535522ms
2022-09-20 20:46:13 INFO  Estimated optimisation runtime saving is 174625.9274482727ms
2022-09-20 20:46:13 INFO  ---RUNTIME: Multi-Query Optimization took 58.89582633972168 ms
2022-09-20 20:46:13 INFO  Executing generated plans
2022-09-20 20:46:32 INFO  ---RUNTIME: Execution took 19799.120664596558 ms
2022-09-20 20:46:32 INFO  Done!
2022-09-20 20:46:32 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-20 20:46:32 INFO  Running instrumented original pipeline...
2022-09-20 20:46:32 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-20 20:46:32 INFO  ---RUNTIME: Importing and monkey-patching took 6.230831146240234 ms
2022-09-20 20:46:41 INFO  ---RUNTIME: Original pipeline execution took 8128.863573074341 ms (excluding imports and monkey-patching)
2022-09-20 20:46:41 INFO  Starting execution of 1 what-if analyses...
2022-09-20 20:46:41 INFO  Start plan generation for analysis DataCorruption...
2022-09-20 20:46:41 INFO  ---RUNTIME: Plan generation took 0.45800209045410156 ms
2022-09-20 20:46:41 INFO  Estimated runtime of original DAG is 6295.929431915283ms
2022-09-20 20:46:41 WARNING Skipping Multi-Query Optimization (instead, only combine execution DAGs)
2022-09-20 20:46:41 INFO  Estimated unoptimised what-if runtime is 157398.23579788208ms
2022-09-20 20:46:41 INFO  ---RUNTIME: Multi-Query Optimization took 125.40555000305176 ms
2022-09-20 20:46:41 INFO  Executing generated plans
2022-09-20 20:49:49 INFO  ---RUNTIME: Execution took 188548.86293411255 ms
2022-09-20 20:49:49 INFO  Done!
2022-09-20 20:49:49 INFO  # Finished -- repetition 3 of 7 
2022-09-20 20:49:49 INFO  # Optimization benchmark for data_corruption with args [['reviews', 'slow_loading', 'featurization_0', 'xgboost']] -- repetition 4 of 7
2022-09-20 20:49:49 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-20 20:49:49 INFO  Running instrumented original pipeline...
2022-09-20 20:49:49 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-20 20:49:49 INFO  ---RUNTIME: Importing and monkey-patching took 6.509304046630859 ms
2022-09-20 20:49:57 INFO  ---RUNTIME: Original pipeline execution took 7655.6408405303955 ms (excluding imports and monkey-patching)
2022-09-20 20:49:57 INFO  Starting execution of 1 what-if analyses...
2022-09-20 20:49:57 INFO  Start plan generation for analysis DataCorruption...
2022-09-20 20:49:57 INFO  ---RUNTIME: Plan generation took 0.4210472106933594 ms
2022-09-20 20:49:57 INFO  Estimated runtime of original DAG is 5960.85000038147ms
2022-09-20 20:49:57 INFO  Performing Multi-Query Optimization
2022-09-20 20:49:57 INFO  Estimated unoptimized what-if runtime is 149021.25000953674ms
2022-09-20 20:49:57 INFO  Estimated optimised what-if runtime is 13561.314582824707ms
2022-09-20 20:49:57 INFO  Estimated optimisation runtime saving is 135459.93542671204ms
2022-09-20 20:49:57 INFO  ---RUNTIME: Multi-Query Optimization took 58.59875679016113 ms
2022-09-20 20:49:57 INFO  Executing generated plans
2022-09-20 20:50:17 INFO  ---RUNTIME: Execution took 20035.133838653564 ms
2022-09-20 20:50:17 INFO  Done!
2022-09-20 20:50:17 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-20 20:50:17 INFO  Running instrumented original pipeline...
2022-09-20 20:50:17 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-20 20:50:17 INFO  ---RUNTIME: Importing and monkey-patching took 5.8956146240234375 ms
2022-09-20 20:50:25 INFO  ---RUNTIME: Original pipeline execution took 7954.622507095337 ms (excluding imports and monkey-patching)
2022-09-20 20:50:25 INFO  Starting execution of 1 what-if analyses...
2022-09-20 20:50:25 INFO  Start plan generation for analysis DataCorruption...
2022-09-20 20:50:25 INFO  ---RUNTIME: Plan generation took 0.5109310150146484 ms
2022-09-20 20:50:25 INFO  Estimated runtime of original DAG is 5979.626178741455ms
2022-09-20 20:50:25 WARNING Skipping Multi-Query Optimization (instead, only combine execution DAGs)
2022-09-20 20:50:25 INFO  Estimated unoptimised what-if runtime is 149490.65446853638ms
2022-09-20 20:50:25 INFO  ---RUNTIME: Multi-Query Optimization took 126.61552429199219 ms
2022-09-20 20:50:25 INFO  Executing generated plans
2022-09-20 20:53:34 INFO  ---RUNTIME: Execution took 189119.83180046082 ms
2022-09-20 20:53:34 INFO  Done!
2022-09-20 20:53:34 INFO  # Finished -- repetition 4 of 7 
2022-09-20 20:53:34 INFO  # Optimization benchmark for data_corruption with args [['reviews', 'slow_loading', 'featurization_0', 'xgboost']] -- repetition 5 of 7
2022-09-20 20:53:34 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-20 20:53:34 INFO  Running instrumented original pipeline...
2022-09-20 20:53:34 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-20 20:53:34 INFO  ---RUNTIME: Importing and monkey-patching took 7.561206817626953 ms
2022-09-20 20:53:42 INFO  ---RUNTIME: Original pipeline execution took 8074.18155670166 ms (excluding imports and monkey-patching)
2022-09-20 20:53:42 INFO  Starting execution of 1 what-if analyses...
2022-09-20 20:53:42 INFO  Start plan generation for analysis DataCorruption...
2022-09-20 20:53:42 INFO  ---RUNTIME: Plan generation took 0.4227161407470703 ms
2022-09-20 20:53:42 INFO  Estimated runtime of original DAG is 6247.222185134888ms
2022-09-20 20:53:42 INFO  Performing Multi-Query Optimization
2022-09-20 20:53:42 INFO  Estimated unoptimized what-if runtime is 156180.5546283722ms
2022-09-20 20:53:42 INFO  Estimated optimised what-if runtime is 13880.45883178711ms
2022-09-20 20:53:42 INFO  Estimated optimisation runtime saving is 142300.09579658508ms
2022-09-20 20:53:42 INFO  ---RUNTIME: Multi-Query Optimization took 58.89558792114258 ms
2022-09-20 20:53:42 INFO  Executing generated plans
2022-09-20 20:54:02 INFO  ---RUNTIME: Execution took 19797.089099884033 ms
2022-09-20 20:54:02 INFO  Done!
2022-09-20 20:54:02 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-20 20:54:02 INFO  Running instrumented original pipeline...
2022-09-20 20:54:02 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-20 20:54:02 INFO  ---RUNTIME: Importing and monkey-patching took 6.553173065185547 ms
2022-09-20 20:54:10 INFO  ---RUNTIME: Original pipeline execution took 7700.951099395752 ms (excluding imports and monkey-patching)
2022-09-20 20:54:10 INFO  Starting execution of 1 what-if analyses...
2022-09-20 20:54:10 INFO  Start plan generation for analysis DataCorruption...
2022-09-20 20:54:10 INFO  ---RUNTIME: Plan generation took 0.43392181396484375 ms
2022-09-20 20:54:10 INFO  Estimated runtime of original DAG is 5980.52191734314ms
2022-09-20 20:54:10 WARNING Skipping Multi-Query Optimization (instead, only combine execution DAGs)
2022-09-20 20:54:10 INFO  Estimated unoptimised what-if runtime is 149513.0479335785ms
2022-09-20 20:54:10 INFO  ---RUNTIME: Multi-Query Optimization took 125.78225135803223 ms
2022-09-20 20:54:10 INFO  Executing generated plans
2022-09-20 20:57:18 INFO  ---RUNTIME: Execution took 188008.85581970215 ms
2022-09-20 20:57:18 INFO  Done!
2022-09-20 20:57:18 INFO  # Finished -- repetition 5 of 7 
2022-09-20 20:57:18 INFO  # Optimization benchmark for data_corruption with args [['reviews', 'slow_loading', 'featurization_0', 'xgboost']] -- repetition 6 of 7
2022-09-20 20:57:18 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-20 20:57:18 INFO  Running instrumented original pipeline...
2022-09-20 20:57:18 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-20 20:57:18 INFO  ---RUNTIME: Importing and monkey-patching took 6.615161895751953 ms
2022-09-20 20:57:26 INFO  ---RUNTIME: Original pipeline execution took 8371.541738510132 ms (excluding imports and monkey-patching)
2022-09-20 20:57:26 INFO  Starting execution of 1 what-if analyses...
2022-09-20 20:57:26 INFO  Start plan generation for analysis DataCorruption...
2022-09-20 20:57:26 INFO  ---RUNTIME: Plan generation took 0.4169940948486328 ms
2022-09-20 20:57:26 INFO  Estimated runtime of original DAG is 6676.572799682617ms
2022-09-20 20:57:26 INFO  Performing Multi-Query Optimization
2022-09-20 20:57:27 INFO  Estimated unoptimized what-if runtime is 166914.31999206543ms
2022-09-20 20:57:27 INFO  Estimated optimised what-if runtime is 14275.469541549683ms
2022-09-20 20:57:27 INFO  Estimated optimisation runtime saving is 152638.85045051575ms
2022-09-20 20:57:27 INFO  ---RUNTIME: Multi-Query Optimization took 315.3650760650635 ms
2022-09-20 20:57:27 INFO  Executing generated plans
2022-09-20 20:57:46 INFO  ---RUNTIME: Execution took 19583.48846435547 ms
2022-09-20 20:57:46 INFO  Done!
2022-09-20 20:57:46 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-20 20:57:46 INFO  Running instrumented original pipeline...
2022-09-20 20:57:46 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-20 20:57:46 INFO  ---RUNTIME: Importing and monkey-patching took 5.863666534423828 ms
2022-09-20 20:57:54 INFO  ---RUNTIME: Original pipeline execution took 7776.767015457153 ms (excluding imports and monkey-patching)
2022-09-20 20:57:54 INFO  Starting execution of 1 what-if analyses...
2022-09-20 20:57:54 INFO  Start plan generation for analysis DataCorruption...
2022-09-20 20:57:54 INFO  ---RUNTIME: Plan generation took 0.4360675811767578 ms
2022-09-20 20:57:54 INFO  Estimated runtime of original DAG is 6051.976919174194ms
2022-09-20 20:57:54 WARNING Skipping Multi-Query Optimization (instead, only combine execution DAGs)
2022-09-20 20:57:54 INFO  Estimated unoptimised what-if runtime is 151299.42297935486ms
2022-09-20 20:57:54 INFO  ---RUNTIME: Multi-Query Optimization took 127.19345092773438 ms
2022-09-20 20:57:54 INFO  Executing generated plans
2022-09-20 21:00:59 INFO  ---RUNTIME: Execution took 184663.82455825806 ms
2022-09-20 21:00:59 INFO  Done!
2022-09-20 21:00:59 INFO  # Finished -- repetition 6 of 7 
2022-09-20 21:00:59 INFO  # Optimization benchmark for data_corruption with args [['reviews', 'slow_loading', 'featurization_0', 'xgboost']] -- repetition 7 of 7
2022-09-20 21:00:59 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-20 21:00:59 INFO  Running instrumented original pipeline...
2022-09-20 21:00:59 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-20 21:00:59 INFO  ---RUNTIME: Importing and monkey-patching took 6.48045539855957 ms
2022-09-20 21:01:07 INFO  ---RUNTIME: Original pipeline execution took 7700.417995452881 ms (excluding imports and monkey-patching)
2022-09-20 21:01:07 INFO  Starting execution of 1 what-if analyses...
2022-09-20 21:01:07 INFO  Start plan generation for analysis DataCorruption...
2022-09-20 21:01:07 INFO  ---RUNTIME: Plan generation took 0.4162788391113281 ms
2022-09-20 21:01:07 INFO  Estimated runtime of original DAG is 5978.482484817505ms
2022-09-20 21:01:07 INFO  Performing Multi-Query Optimization
2022-09-20 21:01:07 INFO  Estimated unoptimized what-if runtime is 149462.06212043762ms
2022-09-20 21:01:07 INFO  Estimated optimised what-if runtime is 13600.2938747406ms
2022-09-20 21:01:07 INFO  Estimated optimisation runtime saving is 135861.76824569702ms
2022-09-20 21:01:07 INFO  ---RUNTIME: Multi-Query Optimization took 58.51864814758301 ms
2022-09-20 21:01:07 INFO  Executing generated plans
2022-09-20 21:01:26 INFO  ---RUNTIME: Execution took 19516.377449035645 ms
2022-09-20 21:01:26 INFO  Done!
2022-09-20 21:01:26 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-20 21:01:26 INFO  Running instrumented original pipeline...
2022-09-20 21:01:26 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-20 21:01:26 INFO  ---RUNTIME: Importing and monkey-patching took 5.839824676513672 ms
2022-09-20 21:01:34 INFO  ---RUNTIME: Original pipeline execution took 7695.686340332031 ms (excluding imports and monkey-patching)
2022-09-20 21:01:34 INFO  Starting execution of 1 what-if analyses...
2022-09-20 21:01:34 INFO  Start plan generation for analysis DataCorruption...
2022-09-20 21:01:34 INFO  ---RUNTIME: Plan generation took 0.40340423583984375 ms
2022-09-20 21:01:34 INFO  Estimated runtime of original DAG is 5994.550466537476ms
2022-09-20 21:01:34 WARNING Skipping Multi-Query Optimization (instead, only combine execution DAGs)
2022-09-20 21:01:34 INFO  Estimated unoptimised what-if runtime is 149863.7616634369ms
2022-09-20 21:01:34 INFO  ---RUNTIME: Multi-Query Optimization took 125.42963027954102 ms
2022-09-20 21:01:34 INFO  Executing generated plans
2022-09-20 21:04:42 INFO  ---RUNTIME: Execution took 187843.64461898804 ms
2022-09-20 21:04:42 INFO  Done!
2022-09-20 21:04:42 INFO  # Finished -- repetition 7 of 7 
2022-09-20 21:04:42 INFO  # Final results after all repetitions
2022-09-20 21:04:42 INFO     repetition  ... no_opt_what_if_execution_combined_model_training
0           0  ...                                     18198.211432
1           1  ...                                     20979.412794
2           2  ...                                     19230.343103
3           3  ...                                     18377.472162
4           4  ...                                     18368.072033
5           5  ...                                     18079.777002
6           6  ...                                     17932.556391

[7 rows x 26 columns]
taskset -c 160-168 PROTOCOL_BUFFERS_PYTHON_IMPLEMENTATION=python python3.9 benchmarks_end_to_end.py data_corruption reviews slow_loading featurization_0 neural_network
2022-09-20 21:04:44.691423: W tensorflow/stream_executor/platform/default/dso_loader.cc:64] Could not load dynamic library 'libcudart.so.11.0'; dlerror: libcudart.so.11.0: cannot open shared object file: No such file or directory; LD_LIBRARY_PATH: /home/sgrafbe/mlwhatif/venv/lib/python3.9/site-packages/cv2/../../lib64:
2022-09-20 21:04:44.691470: I tensorflow/stream_executor/cuda/cudart_stub.cc:29] Ignore above cudart dlerror if you do not have a GPU set up on your machine.
2022-09-20 21:04:45 INFO  Patching sys.argv with ['mlwhatif', 'reviews', 'slow_loading', 'featurization_0', 'neural_network']
2022-09-20 21:04:45 INFO  Running instrumented original pipeline...
2022-09-20 21:04:46 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-20 21:04:46 INFO  ---RUNTIME: Importing and monkey-patching took 122.3459243774414 ms
2022-09-20 21:04:51.644457: W tensorflow/stream_executor/platform/default/dso_loader.cc:64] Could not load dynamic library 'libcuda.so.1'; dlerror: libcuda.so.1: cannot open shared object file: No such file or directory; LD_LIBRARY_PATH: /home/sgrafbe/mlwhatif/venv/lib/python3.9/site-packages/cv2/../../lib64:
2022-09-20 21:04:51.644502: W tensorflow/stream_executor/cuda/cuda_driver.cc:326] failed call to cuInit: UNKNOWN ERROR (303)
2022-09-20 21:04:51.644525: I tensorflow/stream_executor/cuda/cuda_diagnostics.cc:156] kernel driver does not appear to be running on this host (angus): /proc/driver/nvidia/version does not exist
2022-09-20 21:04:51.645051: I tensorflow/core/platform/cpu_feature_guard.cc:142] This TensorFlow binary is optimized with oneAPI Deep Neural Network Library (oneDNN) to use the following CPU instructions in performance-critical operations:  AVX2 FMA
To enable them in other operations, rebuild TensorFlow with the appropriate compiler flags.
2022-09-20 21:04:51.883315: I tensorflow/compiler/mlir/mlir_graph_optimization_pass.cc:176] None of the MLIR Optimization Passes are enabled (registered 2)
2022-09-20 21:04:51.896229: I tensorflow/core/platform/profile_utils/cpu_utils.cc:114] CPU Frequency: 2595130000 Hz
2022-09-20 21:04:56 INFO  ---RUNTIME: Original pipeline execution took 10653.774499893188 ms (excluding imports and monkey-patching)
2022-09-20 21:04:56 INFO  Starting execution of 0 what-if analyses...
2022-09-20 21:04:56 INFO  Estimated runtime of original DAG is 8984.289646148682ms
2022-09-20 21:04:56 INFO  Performing Multi-Query Optimization
2022-09-20 21:04:56 INFO  Estimated unoptimized what-if runtime is 0ms
2022-09-20 21:04:56 INFO  Estimated optimised what-if runtime is 0ms
2022-09-20 21:04:56 INFO  Estimated optimisation runtime saving is 0ms
2022-09-20 21:04:56 INFO  ---RUNTIME: Multi-Query Optimization took 0.45609474182128906 ms
2022-09-20 21:04:56 INFO  Executing generated plans
2022-09-20 21:04:56 INFO  ---RUNTIME: Execution took 0.023126602172851562 ms
2022-09-20 21:04:56 INFO  Done!
2022-09-20 21:04:56 INFO  # Optimization benchmark for data_corruption with args [['reviews', 'slow_loading', 'featurization_0', 'neural_network']] -- repetition 1 of 7
2022-09-20 21:04:56 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-20 21:04:56 INFO  Running instrumented original pipeline...
2022-09-20 21:04:56 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-20 21:04:56 INFO  ---RUNTIME: Importing and monkey-patching took 5.313396453857422 ms
2022-09-20 21:05:07 INFO  ---RUNTIME: Original pipeline execution took 10315.135717391968 ms (excluding imports and monkey-patching)
2022-09-20 21:05:07 INFO  Starting execution of 1 what-if analyses...
2022-09-20 21:05:07 INFO  Start plan generation for analysis DataCorruption...
2022-09-20 21:05:07 INFO  ---RUNTIME: Plan generation took 0.40984153747558594 ms
2022-09-20 21:05:07 INFO  Estimated runtime of original DAG is 8676.74970626831ms
2022-09-20 21:05:07 INFO  Performing Multi-Query Optimization
2022-09-20 21:05:07 INFO  Estimated unoptimized what-if runtime is 216918.74265670776ms
2022-09-20 21:05:07 INFO  Estimated optimised what-if runtime is 24939.077138900757ms
2022-09-20 21:05:07 INFO  Estimated optimisation runtime saving is 191979.665517807ms
2022-09-20 21:05:07 INFO  ---RUNTIME: Multi-Query Optimization took 59.66472625732422 ms
2022-09-20 21:05:07 INFO  Executing generated plans
2022-09-20 21:05:37 INFO  ---RUNTIME: Execution took 30454.96153831482 ms
2022-09-20 21:05:37 INFO  Done!
2022-09-20 21:05:37 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-20 21:05:37 INFO  Running instrumented original pipeline...
2022-09-20 21:05:37 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-20 21:05:37 INFO  ---RUNTIME: Importing and monkey-patching took 5.867242813110352 ms
2022-09-20 21:05:48 INFO  ---RUNTIME: Original pipeline execution took 10493.408679962158 ms (excluding imports and monkey-patching)
2022-09-20 21:05:48 INFO  Starting execution of 1 what-if analyses...
2022-09-20 21:05:48 INFO  Start plan generation for analysis DataCorruption...
2022-09-20 21:05:48 INFO  ---RUNTIME: Plan generation took 0.41961669921875 ms
2022-09-20 21:05:48 INFO  Estimated runtime of original DAG is 8853.02186012268ms
2022-09-20 21:05:48 WARNING Skipping Multi-Query Optimization (instead, only combine execution DAGs)
2022-09-20 21:05:48 INFO  Estimated unoptimised what-if runtime is 221325.54650306702ms
2022-09-20 21:05:48 INFO  ---RUNTIME: Multi-Query Optimization took 124.33528900146484 ms
2022-09-20 21:05:48 INFO  Executing generated plans
2022-09-20 21:10:07 INFO  ---RUNTIME: Execution took 258876.46460533142 ms
2022-09-20 21:10:07 INFO  Done!
2022-09-20 21:10:07 INFO  # Finished -- repetition 1 of 7 
2022-09-20 21:10:07 INFO  # Optimization benchmark for data_corruption with args [['reviews', 'slow_loading', 'featurization_0', 'neural_network']] -- repetition 2 of 7
2022-09-20 21:10:07 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-20 21:10:07 INFO  Running instrumented original pipeline...
2022-09-20 21:10:07 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-20 21:10:07 INFO  ---RUNTIME: Importing and monkey-patching took 7.063627243041992 ms
2022-09-20 21:10:18 INFO  ---RUNTIME: Original pipeline execution took 11834.216356277466 ms (excluding imports and monkey-patching)
2022-09-20 21:10:18 INFO  Starting execution of 1 what-if analyses...
2022-09-20 21:10:18 INFO  Start plan generation for analysis DataCorruption...
2022-09-20 21:10:18 INFO  ---RUNTIME: Plan generation took 0.43845176696777344 ms
2022-09-20 21:10:18 INFO  Estimated runtime of original DAG is 10120.77784538269ms
2022-09-20 21:10:18 INFO  Performing Multi-Query Optimization
2022-09-20 21:10:19 INFO  Estimated unoptimized what-if runtime is 253019.44613456726ms
2022-09-20 21:10:19 INFO  Estimated optimised what-if runtime is 27978.562593460083ms
2022-09-20 21:10:19 INFO  Estimated optimisation runtime saving is 225040.88354110718ms
2022-09-20 21:10:19 INFO  ---RUNTIME: Multi-Query Optimization took 63.082218170166016 ms
2022-09-20 21:10:19 INFO  Executing generated plans
2022-09-20 21:10:52 INFO  ---RUNTIME: Execution took 33055.26947975159 ms
2022-09-20 21:10:52 INFO  Done!
2022-09-20 21:10:52 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-20 21:10:52 INFO  Running instrumented original pipeline...
2022-09-20 21:10:52 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-20 21:10:52 INFO  ---RUNTIME: Importing and monkey-patching took 6.922245025634766 ms
2022-09-20 21:11:03 INFO  ---RUNTIME: Original pipeline execution took 11163.312435150146 ms (excluding imports and monkey-patching)
2022-09-20 21:11:03 INFO  Starting execution of 1 what-if analyses...
2022-09-20 21:11:03 INFO  Start plan generation for analysis DataCorruption...
2022-09-20 21:11:03 INFO  ---RUNTIME: Plan generation took 0.5414485931396484 ms
2022-09-20 21:11:03 INFO  Estimated runtime of original DAG is 9424.027442932129ms
2022-09-20 21:11:03 WARNING Skipping Multi-Query Optimization (instead, only combine execution DAGs)
2022-09-20 21:11:03 INFO  Estimated unoptimised what-if runtime is 235600.68607330322ms
2022-09-20 21:11:03 INFO  ---RUNTIME: Multi-Query Optimization took 135.512113571167 ms
2022-09-20 21:11:03 INFO  Executing generated plans
2022-09-20 21:15:23 INFO  ---RUNTIME: Execution took 260494.96984481812 ms
2022-09-20 21:15:23 INFO  Done!
2022-09-20 21:15:23 INFO  # Finished -- repetition 2 of 7 
2022-09-20 21:15:23 INFO  # Optimization benchmark for data_corruption with args [['reviews', 'slow_loading', 'featurization_0', 'neural_network']] -- repetition 3 of 7
2022-09-20 21:15:23 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-20 21:15:23 INFO  Running instrumented original pipeline...
2022-09-20 21:15:23 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-20 21:15:23 INFO  ---RUNTIME: Importing and monkey-patching took 6.378889083862305 ms
2022-09-20 21:15:36 INFO  ---RUNTIME: Original pipeline execution took 12134.619235992432 ms (excluding imports and monkey-patching)
2022-09-20 21:15:36 INFO  Starting execution of 1 what-if analyses...
2022-09-20 21:15:36 INFO  Start plan generation for analysis DataCorruption...
2022-09-20 21:15:36 INFO  ---RUNTIME: Plan generation took 0.4248619079589844 ms
2022-09-20 21:15:36 INFO  Estimated runtime of original DAG is 10369.733572006226ms
2022-09-20 21:15:36 INFO  Performing Multi-Query Optimization
2022-09-20 21:15:36 INFO  Estimated unoptimized what-if runtime is 259243.33930015564ms
2022-09-20 21:15:36 INFO  Estimated optimised what-if runtime is 27262.443780899048ms
2022-09-20 21:15:36 INFO  Estimated optimisation runtime saving is 231980.8955192566ms
2022-09-20 21:15:36 INFO  ---RUNTIME: Multi-Query Optimization took 59.979915618896484 ms
2022-09-20 21:15:36 INFO  Executing generated plans
2022-09-20 21:16:08 INFO  ---RUNTIME: Execution took 32490.678071975708 ms
2022-09-20 21:16:08 INFO  Done!
2022-09-20 21:16:08 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-20 21:16:08 INFO  Running instrumented original pipeline...
2022-09-20 21:16:08 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-20 21:16:08 INFO  ---RUNTIME: Importing and monkey-patching took 7.285833358764648 ms
2022-09-20 21:16:19 INFO  ---RUNTIME: Original pipeline execution took 11053.148031234741 ms (excluding imports and monkey-patching)
2022-09-20 21:16:19 INFO  Starting execution of 1 what-if analyses...
2022-09-20 21:16:19 INFO  Start plan generation for analysis DataCorruption...
2022-09-20 21:16:19 INFO  ---RUNTIME: Plan generation took 0.46563148498535156 ms
2022-09-20 21:16:19 INFO  Estimated runtime of original DAG is 9321.164608001709ms
2022-09-20 21:16:19 WARNING Skipping Multi-Query Optimization (instead, only combine execution DAGs)
2022-09-20 21:16:20 INFO  Estimated unoptimised what-if runtime is 233029.11520004272ms
2022-09-20 21:16:20 INFO  ---RUNTIME: Multi-Query Optimization took 993.2889938354492 ms
2022-09-20 21:16:20 INFO  Executing generated plans
2022-09-20 21:20:42 INFO  ---RUNTIME: Execution took 261787.9021167755 ms
2022-09-20 21:20:42 INFO  Done!
2022-09-20 21:20:42 INFO  # Finished -- repetition 3 of 7 
2022-09-20 21:20:42 INFO  # Optimization benchmark for data_corruption with args [['reviews', 'slow_loading', 'featurization_0', 'neural_network']] -- repetition 4 of 7
2022-09-20 21:20:42 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-20 21:20:42 INFO  Running instrumented original pipeline...
2022-09-20 21:20:42 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-20 21:20:42 INFO  ---RUNTIME: Importing and monkey-patching took 7.262706756591797 ms
2022-09-20 21:20:54 INFO  ---RUNTIME: Original pipeline execution took 12447.82543182373 ms (excluding imports and monkey-patching)
2022-09-20 21:20:54 INFO  Starting execution of 1 what-if analyses...
2022-09-20 21:20:54 INFO  Start plan generation for analysis DataCorruption...
2022-09-20 21:20:54 INFO  ---RUNTIME: Plan generation took 0.4799365997314453 ms
2022-09-20 21:20:54 INFO  Estimated runtime of original DAG is 10653.075218200684ms
2022-09-20 21:20:54 INFO  Performing Multi-Query Optimization
2022-09-20 21:20:54 INFO  Estimated unoptimized what-if runtime is 266326.8804550171ms
2022-09-20 21:20:54 INFO  Estimated optimised what-if runtime is 45822.18265533447ms
2022-09-20 21:20:54 INFO  Estimated optimisation runtime saving is 220504.69779968262ms
2022-09-20 21:20:54 INFO  ---RUNTIME: Multi-Query Optimization took 60.088396072387695 ms
2022-09-20 21:20:54 INFO  Executing generated plans
2022-09-20 21:21:27 INFO  ---RUNTIME: Execution took 32702.633142471313 ms
2022-09-20 21:21:27 INFO  Done!
2022-09-20 21:21:27 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-20 21:21:27 INFO  Running instrumented original pipeline...
2022-09-20 21:21:27 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-20 21:21:27 INFO  ---RUNTIME: Importing and monkey-patching took 7.170438766479492 ms
2022-09-20 21:21:39 INFO  ---RUNTIME: Original pipeline execution took 11420.552015304565 ms (excluding imports and monkey-patching)
2022-09-20 21:21:39 INFO  Starting execution of 1 what-if analyses...
2022-09-20 21:21:39 INFO  Start plan generation for analysis DataCorruption...
2022-09-20 21:21:39 INFO  ---RUNTIME: Plan generation took 0.4534721374511719 ms
2022-09-20 21:21:39 INFO  Estimated runtime of original DAG is 9583.568572998047ms
2022-09-20 21:21:39 WARNING Skipping Multi-Query Optimization (instead, only combine execution DAGs)
2022-09-20 21:21:39 INFO  Estimated unoptimised what-if runtime is 239589.21432495117ms
2022-09-20 21:21:39 INFO  ---RUNTIME: Multi-Query Optimization took 135.0100040435791 ms
2022-09-20 21:21:39 INFO  Executing generated plans
2022-09-20 21:26:00 INFO  ---RUNTIME: Execution took 261285.44974327087 ms
2022-09-20 21:26:00 INFO  Done!
2022-09-20 21:26:00 INFO  # Finished -- repetition 4 of 7 
2022-09-20 21:26:00 INFO  # Optimization benchmark for data_corruption with args [['reviews', 'slow_loading', 'featurization_0', 'neural_network']] -- repetition 5 of 7
2022-09-20 21:26:00 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-20 21:26:00 INFO  Running instrumented original pipeline...
2022-09-20 21:26:00 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-20 21:26:00 INFO  ---RUNTIME: Importing and monkey-patching took 6.856203079223633 ms
2022-09-20 21:26:12 INFO  ---RUNTIME: Original pipeline execution took 11642.087697982788 ms (excluding imports and monkey-patching)
2022-09-20 21:26:12 INFO  Starting execution of 1 what-if analyses...
2022-09-20 21:26:12 INFO  Start plan generation for analysis DataCorruption...
2022-09-20 21:26:12 INFO  ---RUNTIME: Plan generation took 0.484466552734375 ms
2022-09-20 21:26:12 INFO  Estimated runtime of original DAG is 9887.289762496948ms
2022-09-20 21:26:12 INFO  Performing Multi-Query Optimization
2022-09-20 21:26:12 INFO  Estimated unoptimized what-if runtime is 247182.2440624237ms
2022-09-20 21:26:12 INFO  Estimated optimised what-if runtime is 25837.935209274292ms
2022-09-20 21:26:12 INFO  Estimated optimisation runtime saving is 221344.3088531494ms
2022-09-20 21:26:12 INFO  ---RUNTIME: Multi-Query Optimization took 63.8427734375 ms
2022-09-20 21:26:12 INFO  Executing generated plans
2022-09-20 21:26:44 INFO  ---RUNTIME: Execution took 31974.86710548401 ms
2022-09-20 21:26:44 INFO  Done!
2022-09-20 21:26:44 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-20 21:26:44 INFO  Running instrumented original pipeline...
2022-09-20 21:26:44 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-20 21:26:44 INFO  ---RUNTIME: Importing and monkey-patching took 6.130456924438477 ms
2022-09-20 21:26:55 INFO  ---RUNTIME: Original pipeline execution took 11580.846071243286 ms (excluding imports and monkey-patching)
2022-09-20 21:26:55 INFO  Starting execution of 1 what-if analyses...
2022-09-20 21:26:55 INFO  Start plan generation for analysis DataCorruption...
2022-09-20 21:26:55 INFO  ---RUNTIME: Plan generation took 1.9948482513427734 ms
2022-09-20 21:26:55 INFO  Estimated runtime of original DAG is 9887.961864471436ms
2022-09-20 21:26:55 WARNING Skipping Multi-Query Optimization (instead, only combine execution DAGs)
2022-09-20 21:26:55 INFO  Estimated unoptimised what-if runtime is 247199.0466117859ms
2022-09-20 21:26:55 INFO  ---RUNTIME: Multi-Query Optimization took 126.81198120117188 ms
2022-09-20 21:26:55 INFO  Executing generated plans
2022-09-20 21:31:15 INFO  ---RUNTIME: Execution took 259594.90513801575 ms
2022-09-20 21:31:15 INFO  Done!
2022-09-20 21:31:15 INFO  # Finished -- repetition 5 of 7 
2022-09-20 21:31:15 INFO  # Optimization benchmark for data_corruption with args [['reviews', 'slow_loading', 'featurization_0', 'neural_network']] -- repetition 6 of 7
2022-09-20 21:31:15 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-20 21:31:15 INFO  Running instrumented original pipeline...
2022-09-20 21:31:15 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-20 21:31:15 INFO  ---RUNTIME: Importing and monkey-patching took 6.237506866455078 ms
2022-09-20 21:31:28 INFO  ---RUNTIME: Original pipeline execution took 12814.407110214233 ms (excluding imports and monkey-patching)
2022-09-20 21:31:28 INFO  Starting execution of 1 what-if analyses...
2022-09-20 21:31:28 INFO  Start plan generation for analysis DataCorruption...
2022-09-20 21:31:28 INFO  ---RUNTIME: Plan generation took 0.4887580871582031 ms
2022-09-20 21:31:28 INFO  Estimated runtime of original DAG is 11030.056238174438ms
2022-09-20 21:31:28 INFO  Performing Multi-Query Optimization
2022-09-20 21:31:28 INFO  Estimated unoptimized what-if runtime is 275751.40595436096ms
2022-09-20 21:31:28 INFO  Estimated optimised what-if runtime is 46852.14424133301ms
2022-09-20 21:31:28 INFO  Estimated optimisation runtime saving is 228899.26171302795ms
2022-09-20 21:31:28 INFO  ---RUNTIME: Multi-Query Optimization took 63.1098747253418 ms
2022-09-20 21:31:28 INFO  Executing generated plans
2022-09-20 21:31:59 INFO  ---RUNTIME: Execution took 31535.48264503479 ms
2022-09-20 21:31:59 INFO  Done!
2022-09-20 21:31:59 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-20 21:31:59 INFO  Running instrumented original pipeline...
2022-09-20 21:32:00 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-20 21:32:00 INFO  ---RUNTIME: Importing and monkey-patching took 6.314516067504883 ms
2022-09-20 21:32:10 INFO  ---RUNTIME: Original pipeline execution took 10690.19865989685 ms (excluding imports and monkey-patching)
2022-09-20 21:32:10 INFO  Starting execution of 1 what-if analyses...
2022-09-20 21:32:10 INFO  Start plan generation for analysis DataCorruption...
2022-09-20 21:32:10 INFO  ---RUNTIME: Plan generation took 0.4794597625732422 ms
2022-09-20 21:32:10 INFO  Estimated runtime of original DAG is 8934.5862865448ms
2022-09-20 21:32:10 WARNING Skipping Multi-Query Optimization (instead, only combine execution DAGs)
2022-09-20 21:32:10 INFO  Estimated unoptimised what-if runtime is 223364.65716362ms
2022-09-20 21:32:10 INFO  ---RUNTIME: Multi-Query Optimization took 126.50918960571289 ms
2022-09-20 21:32:10 INFO  Executing generated plans
2022-09-20 21:36:32 INFO  ---RUNTIME: Execution took 261691.28799438477 ms
2022-09-20 21:36:32 INFO  Done!
2022-09-20 21:36:32 INFO  # Finished -- repetition 6 of 7 
2022-09-20 21:36:32 INFO  # Optimization benchmark for data_corruption with args [['reviews', 'slow_loading', 'featurization_0', 'neural_network']] -- repetition 7 of 7
2022-09-20 21:36:32 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-20 21:36:32 INFO  Running instrumented original pipeline...
2022-09-20 21:36:32 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-20 21:36:32 INFO  ---RUNTIME: Importing and monkey-patching took 6.371498107910156 ms
2022-09-20 21:36:44 INFO  ---RUNTIME: Original pipeline execution took 11984.968185424805 ms (excluding imports and monkey-patching)
2022-09-20 21:36:44 INFO  Starting execution of 1 what-if analyses...
2022-09-20 21:36:44 INFO  Start plan generation for analysis DataCorruption...
2022-09-20 21:36:44 INFO  ---RUNTIME: Plan generation took 0.4978179931640625 ms
2022-09-20 21:36:44 INFO  Estimated runtime of original DAG is 10198.630332946777ms
2022-09-20 21:36:44 INFO  Performing Multi-Query Optimization
2022-09-20 21:36:44 INFO  Estimated unoptimized what-if runtime is 254965.75832366943ms
2022-09-20 21:36:44 INFO  Estimated optimised what-if runtime is 27823.79412651062ms
2022-09-20 21:36:44 INFO  Estimated optimisation runtime saving is 227141.9641971588ms
2022-09-20 21:36:44 INFO  ---RUNTIME: Multi-Query Optimization took 63.373565673828125 ms
2022-09-20 21:36:44 INFO  Executing generated plans
2022-09-20 21:37:15 INFO  ---RUNTIME: Execution took 30584.864139556885 ms
2022-09-20 21:37:15 INFO  Done!
2022-09-20 21:37:15 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-20 21:37:15 INFO  Running instrumented original pipeline...
2022-09-20 21:37:15 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-20 21:37:15 INFO  ---RUNTIME: Importing and monkey-patching took 6.323814392089844 ms
2022-09-20 21:37:25 INFO  ---RUNTIME: Original pipeline execution took 10791.326999664307 ms (excluding imports and monkey-patching)
2022-09-20 21:37:25 INFO  Starting execution of 1 what-if analyses...
2022-09-20 21:37:25 INFO  Start plan generation for analysis DataCorruption...
2022-09-20 21:37:25 INFO  ---RUNTIME: Plan generation took 0.47659873962402344 ms
2022-09-20 21:37:25 INFO  Estimated runtime of original DAG is 9106.246948242188ms
2022-09-20 21:37:25 WARNING Skipping Multi-Query Optimization (instead, only combine execution DAGs)
2022-09-20 21:37:26 INFO  Estimated unoptimised what-if runtime is 227656.1737060547ms
2022-09-20 21:37:26 INFO  ---RUNTIME: Multi-Query Optimization took 130.7053565979004 ms
2022-09-20 21:37:26 INFO  Executing generated plans
2022-09-20 21:41:49 INFO  ---RUNTIME: Execution took 263830.3782939911 ms
2022-09-20 21:41:49 INFO  Done!
2022-09-20 21:41:49 INFO  # Finished -- repetition 7 of 7 
2022-09-20 21:41:49 INFO  # Final results after all repetitions
2022-09-20 21:41:49 INFO     repetition  ... no_opt_what_if_execution_combined_model_training
0           0  ...                                     80107.375383
1           1  ...                                     81418.036699
2           2  ...                                     84726.336956
3           3  ...                                     84830.690384
4           4  ...                                     84381.317854
5           5  ...                                     85876.194954
6           6  ...                                     88303.268433

[7 rows x 26 columns]
taskset -c 160-168 PROTOCOL_BUFFERS_PYTHON_IMPLEMENTATION=python python3.9 benchmarks_end_to_end.py data_corruption reviews slow_loading featurization_1 logistic_regression
2022-09-20 21:41:53.060946: W tensorflow/stream_executor/platform/default/dso_loader.cc:64] Could not load dynamic library 'libcudart.so.11.0'; dlerror: libcudart.so.11.0: cannot open shared object file: No such file or directory; LD_LIBRARY_PATH: /home/sgrafbe/mlwhatif/venv/lib/python3.9/site-packages/cv2/../../lib64:
2022-09-20 21:41:53.060993: I tensorflow/stream_executor/cuda/cudart_stub.cc:29] Ignore above cudart dlerror if you do not have a GPU set up on your machine.
2022-09-20 21:41:54 INFO  Patching sys.argv with ['mlwhatif', 'reviews', 'slow_loading', 'featurization_1', 'logistic_regression']
2022-09-20 21:41:54 INFO  Running instrumented original pipeline...
2022-09-20 21:41:54 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-20 21:41:54 INFO  ---RUNTIME: Importing and monkey-patching took 121.93584442138672 ms
2022-09-20 21:42:03 INFO  ---RUNTIME: Original pipeline execution took 8554.039001464844 ms (excluding imports and monkey-patching)
2022-09-20 21:42:03 INFO  Starting execution of 0 what-if analyses...
2022-09-20 21:42:03 INFO  Estimated runtime of original DAG is 6241.675853729248ms
2022-09-20 21:42:03 INFO  Performing Multi-Query Optimization
2022-09-20 21:42:03 INFO  Estimated unoptimized what-if runtime is 0ms
2022-09-20 21:42:03 INFO  Estimated optimised what-if runtime is 0ms
2022-09-20 21:42:03 INFO  Estimated optimisation runtime saving is 0ms
2022-09-20 21:42:03 INFO  ---RUNTIME: Multi-Query Optimization took 0.49185752868652344 ms
2022-09-20 21:42:03 INFO  Executing generated plans
2022-09-20 21:42:03 INFO  ---RUNTIME: Execution took 0.024080276489257812 ms
2022-09-20 21:42:03 INFO  Done!
2022-09-20 21:42:03 INFO  # Optimization benchmark for data_corruption with args [['reviews', 'slow_loading', 'featurization_1', 'logistic_regression']] -- repetition 1 of 7
2022-09-20 21:42:03 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-20 21:42:03 INFO  Running instrumented original pipeline...
2022-09-20 21:42:03 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-20 21:42:03 INFO  ---RUNTIME: Importing and monkey-patching took 6.318330764770508 ms
2022-09-20 21:42:10 INFO  ---RUNTIME: Original pipeline execution took 7835.650205612183 ms (excluding imports and monkey-patching)
2022-09-20 21:42:10 INFO  Starting execution of 1 what-if analyses...
2022-09-20 21:42:10 INFO  Start plan generation for analysis DataCorruption...
2022-09-20 21:42:10 INFO  ---RUNTIME: Plan generation took 0.5598068237304688 ms
2022-09-20 21:42:10 INFO  Estimated runtime of original DAG is 5438.816547393799ms
2022-09-20 21:42:10 INFO  Performing Multi-Query Optimization
2022-09-20 21:42:10 INFO  Estimated unoptimized what-if runtime is 135970.41368484497ms
2022-09-20 21:42:10 INFO  Estimated optimised what-if runtime is 14181.477308273315ms
2022-09-20 21:42:10 INFO  Estimated optimisation runtime saving is 121788.93637657166ms
2022-09-20 21:42:10 INFO  ---RUNTIME: Multi-Query Optimization took 62.166690826416016 ms
2022-09-20 21:42:10 INFO  Executing generated plans
2022-09-20 21:42:28 INFO  ---RUNTIME: Execution took 18062.994480133057 ms
2022-09-20 21:42:28 INFO  Done!
2022-09-20 21:42:28 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-20 21:42:28 INFO  Running instrumented original pipeline...
2022-09-20 21:42:29 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-20 21:42:29 INFO  ---RUNTIME: Importing and monkey-patching took 6.250619888305664 ms
2022-09-20 21:42:36 INFO  ---RUNTIME: Original pipeline execution took 7589.739084243774 ms (excluding imports and monkey-patching)
2022-09-20 21:42:36 INFO  Starting execution of 1 what-if analyses...
2022-09-20 21:42:36 INFO  Start plan generation for analysis DataCorruption...
2022-09-20 21:42:36 INFO  ---RUNTIME: Plan generation took 0.5376338958740234 ms
2022-09-20 21:42:36 INFO  Estimated runtime of original DAG is 5383.709669113159ms
2022-09-20 21:42:36 WARNING Skipping Multi-Query Optimization (instead, only combine execution DAGs)
2022-09-20 21:42:36 INFO  Estimated unoptimised what-if runtime is 134592.74172782898ms
2022-09-20 21:42:36 INFO  ---RUNTIME: Multi-Query Optimization took 134.75847244262695 ms
2022-09-20 21:42:36 INFO  Executing generated plans
2022-09-20 21:45:25 INFO  ---RUNTIME: Execution took 168633.23760032654 ms
2022-09-20 21:45:25 INFO  Done!
2022-09-20 21:45:25 INFO  # Finished -- repetition 1 of 7 
2022-09-20 21:45:25 INFO  # Optimization benchmark for data_corruption with args [['reviews', 'slow_loading', 'featurization_1', 'logistic_regression']] -- repetition 2 of 7
2022-09-20 21:45:25 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-20 21:45:25 INFO  Running instrumented original pipeline...
2022-09-20 21:45:25 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-20 21:45:25 INFO  ---RUNTIME: Importing and monkey-patching took 6.322622299194336 ms
2022-09-20 21:45:32 INFO  ---RUNTIME: Original pipeline execution took 7605.449438095093 ms (excluding imports and monkey-patching)
2022-09-20 21:45:32 INFO  Starting execution of 1 what-if analyses...
2022-09-20 21:45:32 INFO  Start plan generation for analysis DataCorruption...
2022-09-20 21:45:32 INFO  ---RUNTIME: Plan generation took 0.55694580078125 ms
2022-09-20 21:45:32 INFO  Estimated runtime of original DAG is 5333.174467086792ms
2022-09-20 21:45:32 INFO  Performing Multi-Query Optimization
2022-09-20 21:45:33 INFO  Estimated unoptimized what-if runtime is 133329.3616771698ms
2022-09-20 21:45:33 INFO  Estimated optimised what-if runtime is 12061.745166778564ms
2022-09-20 21:45:33 INFO  Estimated optimisation runtime saving is 121267.61651039124ms
2022-09-20 21:45:33 INFO  ---RUNTIME: Multi-Query Optimization took 61.97547912597656 ms
2022-09-20 21:45:33 INFO  Executing generated plans
2022-09-20 21:45:51 INFO  ---RUNTIME: Execution took 18049.817323684692 ms
2022-09-20 21:45:51 INFO  Done!
2022-09-20 21:45:51 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-20 21:45:51 INFO  Running instrumented original pipeline...
2022-09-20 21:45:51 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-20 21:45:51 INFO  ---RUNTIME: Importing and monkey-patching took 6.305217742919922 ms
2022-09-20 21:45:58 INFO  ---RUNTIME: Original pipeline execution took 7662.187337875366 ms (excluding imports and monkey-patching)
2022-09-20 21:45:58 INFO  Starting execution of 1 what-if analyses...
2022-09-20 21:45:58 INFO  Start plan generation for analysis DataCorruption...
2022-09-20 21:45:58 INFO  ---RUNTIME: Plan generation took 0.5662441253662109 ms
2022-09-20 21:45:58 INFO  Estimated runtime of original DAG is 5390.326738357544ms
2022-09-20 21:45:58 WARNING Skipping Multi-Query Optimization (instead, only combine execution DAGs)
2022-09-20 21:45:59 INFO  Estimated unoptimised what-if runtime is 134758.1684589386ms
2022-09-20 21:45:59 INFO  ---RUNTIME: Multi-Query Optimization took 345.8709716796875 ms
2022-09-20 21:45:59 INFO  Executing generated plans
2022-09-20 21:48:48 INFO  ---RUNTIME: Execution took 169312.88170814514 ms
2022-09-20 21:48:48 INFO  Done!
2022-09-20 21:48:48 INFO  # Finished -- repetition 2 of 7 
2022-09-20 21:48:48 INFO  # Optimization benchmark for data_corruption with args [['reviews', 'slow_loading', 'featurization_1', 'logistic_regression']] -- repetition 3 of 7
2022-09-20 21:48:48 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-20 21:48:48 INFO  Running instrumented original pipeline...
2022-09-20 21:48:48 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-20 21:48:48 INFO  ---RUNTIME: Importing and monkey-patching took 6.348848342895508 ms
2022-09-20 21:48:56 INFO  ---RUNTIME: Original pipeline execution took 7690.6797885894775 ms (excluding imports and monkey-patching)
2022-09-20 21:48:56 INFO  Starting execution of 1 what-if analyses...
2022-09-20 21:48:56 INFO  Start plan generation for analysis DataCorruption...
2022-09-20 21:48:56 INFO  ---RUNTIME: Plan generation took 0.5953311920166016 ms
2022-09-20 21:48:56 INFO  Estimated runtime of original DAG is 5391.1378383636475ms
2022-09-20 21:48:56 INFO  Performing Multi-Query Optimization
2022-09-20 21:48:56 INFO  Estimated unoptimized what-if runtime is 134778.4459590912ms
2022-09-20 21:48:56 INFO  Estimated optimised what-if runtime is 12152.53210067749ms
2022-09-20 21:48:56 INFO  Estimated optimisation runtime saving is 122625.9138584137ms
2022-09-20 21:48:56 INFO  ---RUNTIME: Multi-Query Optimization took 62.39509582519531 ms
2022-09-20 21:48:56 INFO  Executing generated plans
2022-09-20 21:49:14 INFO  ---RUNTIME: Execution took 18087.805032730103 ms
2022-09-20 21:49:14 INFO  Done!
2022-09-20 21:49:14 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-20 21:49:14 INFO  Running instrumented original pipeline...
2022-09-20 21:49:14 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-20 21:49:14 INFO  ---RUNTIME: Importing and monkey-patching took 6.164789199829102 ms
2022-09-20 21:49:21 INFO  ---RUNTIME: Original pipeline execution took 7637.856721878052 ms (excluding imports and monkey-patching)
2022-09-20 21:49:21 INFO  Starting execution of 1 what-if analyses...
2022-09-20 21:49:21 INFO  Start plan generation for analysis DataCorruption...
2022-09-20 21:49:21 INFO  ---RUNTIME: Plan generation took 0.5249977111816406 ms
2022-09-20 21:49:21 INFO  Estimated runtime of original DAG is 5343.316316604614ms
2022-09-20 21:49:21 WARNING Skipping Multi-Query Optimization (instead, only combine execution DAGs)
2022-09-20 21:49:22 INFO  Estimated unoptimised what-if runtime is 133582.90791511536ms
2022-09-20 21:49:22 INFO  ---RUNTIME: Multi-Query Optimization took 136.23523712158203 ms
2022-09-20 21:49:22 INFO  Executing generated plans
2022-09-20 21:52:10 INFO  ---RUNTIME: Execution took 168474.51639175415 ms
2022-09-20 21:52:10 INFO  Done!
2022-09-20 21:52:10 INFO  # Finished -- repetition 3 of 7 
2022-09-20 21:52:10 INFO  # Optimization benchmark for data_corruption with args [['reviews', 'slow_loading', 'featurization_1', 'logistic_regression']] -- repetition 4 of 7
2022-09-20 21:52:10 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-20 21:52:10 INFO  Running instrumented original pipeline...
2022-09-20 21:52:10 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-20 21:52:10 INFO  ---RUNTIME: Importing and monkey-patching took 6.116390228271484 ms
2022-09-20 21:52:19 INFO  ---RUNTIME: Original pipeline execution took 8690.417766571045 ms (excluding imports and monkey-patching)
2022-09-20 21:52:19 INFO  Starting execution of 1 what-if analyses...
2022-09-20 21:52:19 INFO  Start plan generation for analysis DataCorruption...
2022-09-20 21:52:19 INFO  ---RUNTIME: Plan generation took 0.47397613525390625 ms
2022-09-20 21:52:19 INFO  Estimated runtime of original DAG is 6082.25154876709ms
2022-09-20 21:52:19 INFO  Performing Multi-Query Optimization
2022-09-20 21:52:19 INFO  Estimated unoptimized what-if runtime is 152056.28871917725ms
2022-09-20 21:52:19 INFO  Estimated optimised what-if runtime is 12913.503646850586ms
2022-09-20 21:52:19 INFO  Estimated optimisation runtime saving is 139142.78507232666ms
2022-09-20 21:52:19 INFO  ---RUNTIME: Multi-Query Optimization took 62.60275840759277 ms
2022-09-20 21:52:19 INFO  Executing generated plans
2022-09-20 21:52:37 INFO  ---RUNTIME: Execution took 18339.860200881958 ms
2022-09-20 21:52:37 INFO  Done!
2022-09-20 21:52:37 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-20 21:52:37 INFO  Running instrumented original pipeline...
2022-09-20 21:52:37 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-20 21:52:37 INFO  ---RUNTIME: Importing and monkey-patching took 5.864143371582031 ms
2022-09-20 21:52:45 INFO  ---RUNTIME: Original pipeline execution took 7818.76802444458 ms (excluding imports and monkey-patching)
2022-09-20 21:52:45 INFO  Starting execution of 1 what-if analyses...
2022-09-20 21:52:45 INFO  Start plan generation for analysis DataCorruption...
2022-09-20 21:52:45 INFO  ---RUNTIME: Plan generation took 0.4878044128417969 ms
2022-09-20 21:52:45 INFO  Estimated runtime of original DAG is 5463.985204696655ms
2022-09-20 21:52:45 WARNING Skipping Multi-Query Optimization (instead, only combine execution DAGs)
2022-09-20 21:52:45 INFO  Estimated unoptimised what-if runtime is 136599.63011741638ms
2022-09-20 21:52:45 INFO  ---RUNTIME: Multi-Query Optimization took 136.4920139312744 ms
2022-09-20 21:52:45 INFO  Executing generated plans
2022-09-20 21:55:34 INFO  ---RUNTIME: Execution took 169035.7358455658 ms
2022-09-20 21:55:34 INFO  Done!
2022-09-20 21:55:34 INFO  # Finished -- repetition 4 of 7 
2022-09-20 21:55:34 INFO  # Optimization benchmark for data_corruption with args [['reviews', 'slow_loading', 'featurization_1', 'logistic_regression']] -- repetition 5 of 7
2022-09-20 21:55:34 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-20 21:55:34 INFO  Running instrumented original pipeline...
2022-09-20 21:55:34 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-20 21:55:34 INFO  ---RUNTIME: Importing and monkey-patching took 6.731748580932617 ms
2022-09-20 21:55:42 INFO  ---RUNTIME: Original pipeline execution took 7757.991313934326 ms (excluding imports and monkey-patching)
2022-09-20 21:55:42 INFO  Starting execution of 1 what-if analyses...
2022-09-20 21:55:42 INFO  Start plan generation for analysis DataCorruption...
2022-09-20 21:55:42 INFO  ---RUNTIME: Plan generation took 0.5784034729003906 ms
2022-09-20 21:55:42 INFO  Estimated runtime of original DAG is 5445.996999740601ms
2022-09-20 21:55:42 INFO  Performing Multi-Query Optimization
2022-09-20 21:55:42 INFO  Estimated unoptimized what-if runtime is 136149.92499351501ms
2022-09-20 21:55:42 INFO  Estimated optimised what-if runtime is 12398.893117904663ms
2022-09-20 21:55:42 INFO  Estimated optimisation runtime saving is 123751.03187561035ms
2022-09-20 21:55:42 INFO  ---RUNTIME: Multi-Query Optimization took 62.73245811462402 ms
2022-09-20 21:55:42 INFO  Executing generated plans
2022-09-20 21:56:00 INFO  ---RUNTIME: Execution took 18125.15163421631 ms
2022-09-20 21:56:00 INFO  Done!
2022-09-20 21:56:00 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-20 21:56:00 INFO  Running instrumented original pipeline...
2022-09-20 21:56:00 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-20 21:56:00 INFO  ---RUNTIME: Importing and monkey-patching took 6.296396255493164 ms
2022-09-20 21:56:08 INFO  ---RUNTIME: Original pipeline execution took 7746.402263641357 ms (excluding imports and monkey-patching)
2022-09-20 21:56:08 INFO  Starting execution of 1 what-if analyses...
2022-09-20 21:56:08 INFO  Start plan generation for analysis DataCorruption...
2022-09-20 21:56:08 INFO  ---RUNTIME: Plan generation took 0.5841255187988281 ms
2022-09-20 21:56:08 INFO  Estimated runtime of original DAG is 5432.029247283936ms
2022-09-20 21:56:08 WARNING Skipping Multi-Query Optimization (instead, only combine execution DAGs)
2022-09-20 21:56:08 INFO  Estimated unoptimised what-if runtime is 135800.7311820984ms
2022-09-20 21:56:08 INFO  ---RUNTIME: Multi-Query Optimization took 419.0411567687988 ms
2022-09-20 21:56:08 INFO  Executing generated plans
2022-09-20 21:58:57 INFO  ---RUNTIME: Execution took 168608.61492156982 ms
2022-09-20 21:58:57 INFO  Done!
2022-09-20 21:58:57 INFO  # Finished -- repetition 5 of 7 
2022-09-20 21:58:57 INFO  # Optimization benchmark for data_corruption with args [['reviews', 'slow_loading', 'featurization_1', 'logistic_regression']] -- repetition 6 of 7
2022-09-20 21:58:57 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-20 21:58:57 INFO  Running instrumented original pipeline...
2022-09-20 21:58:57 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-20 21:58:57 INFO  ---RUNTIME: Importing and monkey-patching took 6.408452987670898 ms
2022-09-20 21:59:06 INFO  ---RUNTIME: Original pipeline execution took 8560.858488082886 ms (excluding imports and monkey-patching)
2022-09-20 21:59:06 INFO  Starting execution of 1 what-if analyses...
2022-09-20 21:59:06 INFO  Start plan generation for analysis DataCorruption...
2022-09-20 21:59:06 INFO  ---RUNTIME: Plan generation took 0.5791187286376953 ms
2022-09-20 21:59:06 INFO  Estimated runtime of original DAG is 6208.963394165039ms
2022-09-20 21:59:06 INFO  Performing Multi-Query Optimization
2022-09-20 21:59:06 INFO  Estimated unoptimized what-if runtime is 155224.08485412598ms
2022-09-20 21:59:06 INFO  Estimated optimised what-if runtime is 13018.787622451782ms
2022-09-20 21:59:06 INFO  Estimated optimisation runtime saving is 142205.2972316742ms
2022-09-20 21:59:06 INFO  ---RUNTIME: Multi-Query Optimization took 62.55459785461426 ms
2022-09-20 21:59:06 INFO  Executing generated plans
2022-09-20 21:59:24 INFO  ---RUNTIME: Execution took 18248.14796447754 ms
2022-09-20 21:59:24 INFO  Done!
2022-09-20 21:59:24 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-20 21:59:24 INFO  Running instrumented original pipeline...
2022-09-20 21:59:24 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-20 21:59:24 INFO  ---RUNTIME: Importing and monkey-patching took 6.426572799682617 ms
2022-09-20 21:59:32 INFO  ---RUNTIME: Original pipeline execution took 7772.400140762329 ms (excluding imports and monkey-patching)
2022-09-20 21:59:32 INFO  Starting execution of 1 what-if analyses...
2022-09-20 21:59:32 INFO  Start plan generation for analysis DataCorruption...
2022-09-20 21:59:32 INFO  ---RUNTIME: Plan generation took 0.5826950073242188 ms
2022-09-20 21:59:32 INFO  Estimated runtime of original DAG is 5428.936243057251ms
2022-09-20 21:59:32 WARNING Skipping Multi-Query Optimization (instead, only combine execution DAGs)
2022-09-20 21:59:32 INFO  Estimated unoptimised what-if runtime is 135723.40607643127ms
2022-09-20 21:59:32 INFO  ---RUNTIME: Multi-Query Optimization took 135.9398365020752 ms
2022-09-20 21:59:32 INFO  Executing generated plans
2022-09-20 22:02:20 INFO  ---RUNTIME: Execution took 168336.33995056152 ms
2022-09-20 22:02:20 INFO  Done!
2022-09-20 22:02:20 INFO  # Finished -- repetition 6 of 7 
2022-09-20 22:02:20 INFO  # Optimization benchmark for data_corruption with args [['reviews', 'slow_loading', 'featurization_1', 'logistic_regression']] -- repetition 7 of 7
2022-09-20 22:02:20 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-20 22:02:20 INFO  Running instrumented original pipeline...
2022-09-20 22:02:20 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-20 22:02:20 INFO  ---RUNTIME: Importing and monkey-patching took 6.685972213745117 ms
2022-09-20 22:02:28 INFO  ---RUNTIME: Original pipeline execution took 7768.765449523926 ms (excluding imports and monkey-patching)
2022-09-20 22:02:28 INFO  Starting execution of 1 what-if analyses...
2022-09-20 22:02:28 INFO  Start plan generation for analysis DataCorruption...
2022-09-20 22:02:28 INFO  ---RUNTIME: Plan generation took 0.5762577056884766 ms
2022-09-20 22:02:28 INFO  Estimated runtime of original DAG is 5422.354698181152ms
2022-09-20 22:02:28 INFO  Performing Multi-Query Optimization
2022-09-20 22:02:28 INFO  Estimated unoptimized what-if runtime is 135558.8674545288ms
2022-09-20 22:02:28 INFO  Estimated optimised what-if runtime is 12200.18219947815ms
2022-09-20 22:02:28 INFO  Estimated optimisation runtime saving is 123358.68525505066ms
2022-09-20 22:02:28 INFO  ---RUNTIME: Multi-Query Optimization took 62.12258338928223 ms
2022-09-20 22:02:28 INFO  Executing generated plans
2022-09-20 22:02:46 INFO  ---RUNTIME: Execution took 18099.751710891724 ms
2022-09-20 22:02:46 INFO  Done!
2022-09-20 22:02:46 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-20 22:02:46 INFO  Running instrumented original pipeline...
2022-09-20 22:02:46 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-20 22:02:46 INFO  ---RUNTIME: Importing and monkey-patching took 5.924224853515625 ms
2022-09-20 22:02:54 INFO  ---RUNTIME: Original pipeline execution took 7731.335639953613 ms (excluding imports and monkey-patching)
2022-09-20 22:02:54 INFO  Starting execution of 1 what-if analyses...
2022-09-20 22:02:54 INFO  Start plan generation for analysis DataCorruption...
2022-09-20 22:02:54 INFO  ---RUNTIME: Plan generation took 0.52642822265625 ms
2022-09-20 22:02:54 INFO  Estimated runtime of original DAG is 5414.285898208618ms
2022-09-20 22:02:54 WARNING Skipping Multi-Query Optimization (instead, only combine execution DAGs)
2022-09-20 22:02:54 INFO  Estimated unoptimised what-if runtime is 135357.14745521545ms
2022-09-20 22:02:54 INFO  ---RUNTIME: Multi-Query Optimization took 420.3755855560303 ms
2022-09-20 22:02:54 INFO  Executing generated plans
2022-09-20 22:05:43 INFO  ---RUNTIME: Execution took 169046.1676120758 ms
2022-09-20 22:05:43 INFO  Done!
2022-09-20 22:05:43 INFO  # Finished -- repetition 7 of 7 
2022-09-20 22:05:43 INFO  # Final results after all repetitions
2022-09-20 22:05:43 INFO     repetition  ... no_opt_what_if_execution_combined_model_training
0           0  ...                                      2891.477108
1           1  ...                                      2858.133554
2           2  ...                                      2876.972914
3           3  ...                                      2874.944210
4           4  ...                                      2889.780283
5           5  ...                                      2864.555120
6           6  ...                                      2863.657475

[7 rows x 26 columns]
taskset -c 160-168 PROTOCOL_BUFFERS_PYTHON_IMPLEMENTATION=python python3.9 benchmarks_end_to_end.py data_corruption reviews slow_loading featurization_1 xgboost
2022-09-20 22:05:46.100428: W tensorflow/stream_executor/platform/default/dso_loader.cc:64] Could not load dynamic library 'libcudart.so.11.0'; dlerror: libcudart.so.11.0: cannot open shared object file: No such file or directory; LD_LIBRARY_PATH: /home/sgrafbe/mlwhatif/venv/lib/python3.9/site-packages/cv2/../../lib64:
2022-09-20 22:05:46.100475: I tensorflow/stream_executor/cuda/cudart_stub.cc:29] Ignore above cudart dlerror if you do not have a GPU set up on your machine.
2022-09-20 22:05:47 INFO  Patching sys.argv with ['mlwhatif', 'reviews', 'slow_loading', 'featurization_1', 'xgboost']
2022-09-20 22:05:47 INFO  Running instrumented original pipeline...
2022-09-20 22:05:47 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-20 22:05:47 INFO  ---RUNTIME: Importing and monkey-patching took 121.71244621276855 ms
2022-09-20 22:06:09 INFO  ---RUNTIME: Original pipeline execution took 22350.516319274902 ms (excluding imports and monkey-patching)
2022-09-20 22:06:09 INFO  Starting execution of 0 what-if analyses...
2022-09-20 22:06:09 INFO  Estimated runtime of original DAG is 20090.5339717865ms
2022-09-20 22:06:09 INFO  Performing Multi-Query Optimization
2022-09-20 22:06:09 INFO  Estimated unoptimized what-if runtime is 0ms
2022-09-20 22:06:09 INFO  Estimated optimised what-if runtime is 0ms
2022-09-20 22:06:09 INFO  Estimated optimisation runtime saving is 0ms
2022-09-20 22:06:09 INFO  ---RUNTIME: Multi-Query Optimization took 0.5328655242919922 ms
2022-09-20 22:06:09 INFO  Executing generated plans
2022-09-20 22:06:09 INFO  ---RUNTIME: Execution took 0.024557113647460938 ms
2022-09-20 22:06:09 INFO  Done!
2022-09-20 22:06:09 INFO  # Optimization benchmark for data_corruption with args [['reviews', 'slow_loading', 'featurization_1', 'xgboost']] -- repetition 1 of 7
2022-09-20 22:06:09 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-20 22:06:09 INFO  Running instrumented original pipeline...
2022-09-20 22:06:10 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-20 22:06:10 INFO  ---RUNTIME: Importing and monkey-patching took 6.342649459838867 ms
2022-09-20 22:06:18 INFO  ---RUNTIME: Original pipeline execution took 8566.640615463257 ms (excluding imports and monkey-patching)
2022-09-20 22:06:18 INFO  Starting execution of 1 what-if analyses...
2022-09-20 22:06:18 INFO  Start plan generation for analysis DataCorruption...
2022-09-20 22:06:18 INFO  ---RUNTIME: Plan generation took 0.5197525024414062 ms
2022-09-20 22:06:18 INFO  Estimated runtime of original DAG is 6173.354625701904ms
2022-09-20 22:06:18 INFO  Performing Multi-Query Optimization
2022-09-20 22:06:18 INFO  Estimated unoptimized what-if runtime is 154333.8656425476ms
2022-09-20 22:06:18 INFO  Estimated optimised what-if runtime is 13991.81056022644ms
2022-09-20 22:06:18 INFO  Estimated optimisation runtime saving is 140342.05508232117ms
2022-09-20 22:06:18 INFO  ---RUNTIME: Multi-Query Optimization took 61.879634857177734 ms
2022-09-20 22:06:18 INFO  Executing generated plans
2022-09-20 22:06:38 INFO  ---RUNTIME: Execution took 20050.004720687866 ms
2022-09-20 22:06:38 INFO  Done!
2022-09-20 22:06:38 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-20 22:06:38 INFO  Running instrumented original pipeline...
2022-09-20 22:06:38 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-20 22:06:38 INFO  ---RUNTIME: Importing and monkey-patching took 6.164789199829102 ms
2022-09-20 22:06:46 INFO  ---RUNTIME: Original pipeline execution took 8323.534488677979 ms (excluding imports and monkey-patching)
2022-09-20 22:06:46 INFO  Starting execution of 1 what-if analyses...
2022-09-20 22:06:46 INFO  Start plan generation for analysis DataCorruption...
2022-09-20 22:06:46 INFO  ---RUNTIME: Plan generation took 0.5679130554199219 ms
2022-09-20 22:06:46 INFO  Estimated runtime of original DAG is 6119.566440582275ms
2022-09-20 22:06:46 WARNING Skipping Multi-Query Optimization (instead, only combine execution DAGs)
2022-09-20 22:06:47 INFO  Estimated unoptimised what-if runtime is 152989.16101455688ms
2022-09-20 22:06:47 INFO  ---RUNTIME: Multi-Query Optimization took 133.6066722869873 ms
2022-09-20 22:06:47 INFO  Executing generated plans
2022-09-20 22:10:04 INFO  ---RUNTIME: Execution took 197653.2952785492 ms
2022-09-20 22:10:04 INFO  Done!
2022-09-20 22:10:04 INFO  # Finished -- repetition 1 of 7 
2022-09-20 22:10:04 INFO  # Optimization benchmark for data_corruption with args [['reviews', 'slow_loading', 'featurization_1', 'xgboost']] -- repetition 2 of 7
2022-09-20 22:10:04 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-20 22:10:04 INFO  Running instrumented original pipeline...
2022-09-20 22:10:04 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-20 22:10:04 INFO  ---RUNTIME: Importing and monkey-patching took 6.368398666381836 ms
2022-09-20 22:10:13 INFO  ---RUNTIME: Original pipeline execution took 8438.721418380737 ms (excluding imports and monkey-patching)
2022-09-20 22:10:13 INFO  Starting execution of 1 what-if analyses...
2022-09-20 22:10:13 INFO  Start plan generation for analysis DataCorruption...
2022-09-20 22:10:13 INFO  ---RUNTIME: Plan generation took 0.5810260772705078 ms
2022-09-20 22:10:13 INFO  Estimated runtime of original DAG is 6181.018352508545ms
2022-09-20 22:10:13 INFO  Performing Multi-Query Optimization
2022-09-20 22:10:13 INFO  Estimated unoptimized what-if runtime is 154525.45881271362ms
2022-09-20 22:10:13 INFO  Estimated optimised what-if runtime is 14006.802082061768ms
2022-09-20 22:10:13 INFO  Estimated optimisation runtime saving is 140518.65673065186ms
2022-09-20 22:10:13 INFO  ---RUNTIME: Multi-Query Optimization took 61.80143356323242 ms
2022-09-20 22:10:13 INFO  Executing generated plans
2022-09-20 22:10:33 INFO  ---RUNTIME: Execution took 20054.020881652832 ms
2022-09-20 22:10:33 INFO  Done!
2022-09-20 22:10:33 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-20 22:10:33 INFO  Running instrumented original pipeline...
2022-09-20 22:10:33 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-20 22:10:33 INFO  ---RUNTIME: Importing and monkey-patching took 6.307363510131836 ms
2022-09-20 22:10:41 INFO  ---RUNTIME: Original pipeline execution took 8458.53304862976 ms (excluding imports and monkey-patching)
2022-09-20 22:10:41 INFO  Starting execution of 1 what-if analyses...
2022-09-20 22:10:41 INFO  Start plan generation for analysis DataCorruption...
2022-09-20 22:10:41 INFO  ---RUNTIME: Plan generation took 0.5259513854980469 ms
2022-09-20 22:10:41 INFO  Estimated runtime of original DAG is 6184.2663288116455ms
2022-09-20 22:10:41 WARNING Skipping Multi-Query Optimization (instead, only combine execution DAGs)
2022-09-20 22:10:42 INFO  Estimated unoptimised what-if runtime is 154606.65822029114ms
2022-09-20 22:10:42 INFO  ---RUNTIME: Multi-Query Optimization took 349.3030071258545 ms
2022-09-20 22:10:42 INFO  Executing generated plans
2022-09-20 22:13:56 INFO  ---RUNTIME: Execution took 194849.31635856628 ms
2022-09-20 22:13:56 INFO  Done!
2022-09-20 22:13:56 INFO  # Finished -- repetition 2 of 7 
2022-09-20 22:13:56 INFO  # Optimization benchmark for data_corruption with args [['reviews', 'slow_loading', 'featurization_1', 'xgboost']] -- repetition 3 of 7
2022-09-20 22:13:56 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-20 22:13:56 INFO  Running instrumented original pipeline...
2022-09-20 22:13:56 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-20 22:13:56 INFO  ---RUNTIME: Importing and monkey-patching took 6.34455680847168 ms
2022-09-20 22:14:05 INFO  ---RUNTIME: Original pipeline execution took 8524.836778640747 ms (excluding imports and monkey-patching)
2022-09-20 22:14:05 INFO  Starting execution of 1 what-if analyses...
2022-09-20 22:14:05 INFO  Start plan generation for analysis DataCorruption...
2022-09-20 22:14:05 INFO  ---RUNTIME: Plan generation took 0.5667209625244141 ms
2022-09-20 22:14:05 INFO  Estimated runtime of original DAG is 6208.27317237854ms
2022-09-20 22:14:05 INFO  Performing Multi-Query Optimization
2022-09-20 22:14:05 INFO  Estimated unoptimized what-if runtime is 155206.8293094635ms
2022-09-20 22:14:05 INFO  Estimated optimised what-if runtime is 13959.55777168274ms
2022-09-20 22:14:05 INFO  Estimated optimisation runtime saving is 141247.27153778076ms
2022-09-20 22:14:05 INFO  ---RUNTIME: Multi-Query Optimization took 61.41471862792969 ms
2022-09-20 22:14:05 INFO  Executing generated plans
2022-09-20 22:14:25 INFO  ---RUNTIME: Execution took 20203.43518257141 ms
2022-09-20 22:14:25 INFO  Done!
2022-09-20 22:14:25 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-20 22:14:25 INFO  Running instrumented original pipeline...
2022-09-20 22:14:25 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-20 22:14:25 INFO  ---RUNTIME: Importing and monkey-patching took 6.382942199707031 ms
2022-09-20 22:14:34 INFO  ---RUNTIME: Original pipeline execution took 8470.850944519043 ms (excluding imports and monkey-patching)
2022-09-20 22:14:34 INFO  Starting execution of 1 what-if analyses...
2022-09-20 22:14:34 INFO  Start plan generation for analysis DataCorruption...
2022-09-20 22:14:34 INFO  ---RUNTIME: Plan generation took 0.5786418914794922 ms
2022-09-20 22:14:34 INFO  Estimated runtime of original DAG is 6179.191589355469ms
2022-09-20 22:14:34 WARNING Skipping Multi-Query Optimization (instead, only combine execution DAGs)
2022-09-20 22:14:34 INFO  Estimated unoptimised what-if runtime is 154479.78973388672ms
2022-09-20 22:14:34 INFO  ---RUNTIME: Multi-Query Optimization took 131.85548782348633 ms
2022-09-20 22:14:34 INFO  Executing generated plans
2022-09-20 22:17:43 INFO  ---RUNTIME: Execution took 189369.12083625793 ms
2022-09-20 22:17:43 INFO  Done!
2022-09-20 22:17:43 INFO  # Finished -- repetition 3 of 7 
2022-09-20 22:17:43 INFO  # Optimization benchmark for data_corruption with args [['reviews', 'slow_loading', 'featurization_1', 'xgboost']] -- repetition 4 of 7
2022-09-20 22:17:43 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-20 22:17:43 INFO  Running instrumented original pipeline...
2022-09-20 22:17:44 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-20 22:17:44 INFO  ---RUNTIME: Importing and monkey-patching took 6.136894226074219 ms
2022-09-20 22:17:53 INFO  ---RUNTIME: Original pipeline execution took 9394.442558288574 ms (excluding imports and monkey-patching)
2022-09-20 22:17:53 INFO  Starting execution of 1 what-if analyses...
2022-09-20 22:17:53 INFO  Start plan generation for analysis DataCorruption...
2022-09-20 22:17:53 INFO  ---RUNTIME: Plan generation took 0.5214214324951172 ms
2022-09-20 22:17:53 INFO  Estimated runtime of original DAG is 6811.232566833496ms
2022-09-20 22:17:53 INFO  Performing Multi-Query Optimization
2022-09-20 22:17:53 INFO  Estimated unoptimized what-if runtime is 170280.8141708374ms
2022-09-20 22:17:53 INFO  Estimated optimised what-if runtime is 14652.242660522461ms
2022-09-20 22:17:53 INFO  Estimated optimisation runtime saving is 155628.57151031494ms
2022-09-20 22:17:53 INFO  ---RUNTIME: Multi-Query Optimization took 61.81645393371582 ms
2022-09-20 22:17:53 INFO  Executing generated plans
2022-09-20 22:18:13 INFO  ---RUNTIME: Execution took 20270.361185073853 ms
2022-09-20 22:18:13 INFO  Done!
2022-09-20 22:18:13 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-20 22:18:13 INFO  Running instrumented original pipeline...
2022-09-20 22:18:13 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-20 22:18:13 INFO  ---RUNTIME: Importing and monkey-patching took 8.373737335205078 ms
2022-09-20 22:18:25 INFO  ---RUNTIME: Original pipeline execution took 11578.39035987854 ms (excluding imports and monkey-patching)
2022-09-20 22:18:25 INFO  Starting execution of 1 what-if analyses...
2022-09-20 22:18:25 INFO  Start plan generation for analysis DataCorruption...
2022-09-20 22:18:25 INFO  ---RUNTIME: Plan generation took 0.9348392486572266 ms
2022-09-20 22:18:25 INFO  Estimated runtime of original DAG is 8207.23819732666ms
2022-09-20 22:18:25 WARNING Skipping Multi-Query Optimization (instead, only combine execution DAGs)
2022-09-20 22:18:25 INFO  Estimated unoptimised what-if runtime is 205180.9549331665ms
2022-09-20 22:18:25 INFO  ---RUNTIME: Multi-Query Optimization took 216.58635139465332 ms
2022-09-20 22:18:25 INFO  Executing generated plans
2022-09-20 22:21:37 INFO  ---RUNTIME: Execution took 192250.5075931549 ms
2022-09-20 22:21:37 INFO  Done!
2022-09-20 22:21:37 INFO  # Finished -- repetition 4 of 7 
2022-09-20 22:21:37 INFO  # Optimization benchmark for data_corruption with args [['reviews', 'slow_loading', 'featurization_1', 'xgboost']] -- repetition 5 of 7
2022-09-20 22:21:37 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-20 22:21:37 INFO  Running instrumented original pipeline...
2022-09-20 22:21:37 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-20 22:21:37 INFO  ---RUNTIME: Importing and monkey-patching took 6.5250396728515625 ms
2022-09-20 22:21:46 INFO  ---RUNTIME: Original pipeline execution took 8503.416061401367 ms (excluding imports and monkey-patching)
2022-09-20 22:21:46 INFO  Starting execution of 1 what-if analyses...
2022-09-20 22:21:46 INFO  Start plan generation for analysis DataCorruption...
2022-09-20 22:21:46 INFO  ---RUNTIME: Plan generation took 0.5311965942382812 ms
2022-09-20 22:21:46 INFO  Estimated runtime of original DAG is 6185.930252075195ms
2022-09-20 22:21:46 INFO  Performing Multi-Query Optimization
2022-09-20 22:21:46 INFO  Estimated unoptimized what-if runtime is 154648.25630187988ms
2022-09-20 22:21:46 INFO  Estimated optimised what-if runtime is 14027.381896972656ms
2022-09-20 22:21:46 INFO  Estimated optimisation runtime saving is 140620.87440490723ms
2022-09-20 22:21:46 INFO  ---RUNTIME: Multi-Query Optimization took 62.194108963012695 ms
2022-09-20 22:21:46 INFO  Executing generated plans
2022-09-20 22:22:10 INFO  ---RUNTIME: Execution took 24200.44732093811 ms
2022-09-20 22:22:10 INFO  Done!
2022-09-20 22:22:10 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-20 22:22:10 INFO  Running instrumented original pipeline...
2022-09-20 22:22:10 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-20 22:22:10 INFO  ---RUNTIME: Importing and monkey-patching took 9.152650833129883 ms
2022-09-20 22:22:19 INFO  ---RUNTIME: Original pipeline execution took 9372.944355010986 ms (excluding imports and monkey-patching)
2022-09-20 22:22:19 INFO  Starting execution of 1 what-if analyses...
2022-09-20 22:22:19 INFO  Start plan generation for analysis DataCorruption...
2022-09-20 22:22:19 INFO  ---RUNTIME: Plan generation took 0.5657672882080078 ms
2022-09-20 22:22:19 INFO  Estimated runtime of original DAG is 6900.658130645752ms
2022-09-20 22:22:19 WARNING Skipping Multi-Query Optimization (instead, only combine execution DAGs)
2022-09-20 22:22:19 INFO  Estimated unoptimised what-if runtime is 172516.4532661438ms
2022-09-20 22:22:19 INFO  ---RUNTIME: Multi-Query Optimization took 134.41133499145508 ms
2022-09-20 22:22:19 INFO  Executing generated plans
2022-09-20 22:25:30 INFO  ---RUNTIME: Execution took 190680.71031570435 ms
2022-09-20 22:25:30 INFO  Done!
2022-09-20 22:25:30 INFO  # Finished -- repetition 5 of 7 
2022-09-20 22:25:30 INFO  # Optimization benchmark for data_corruption with args [['reviews', 'slow_loading', 'featurization_1', 'xgboost']] -- repetition 6 of 7
2022-09-20 22:25:30 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-20 22:25:30 INFO  Running instrumented original pipeline...
2022-09-20 22:25:30 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-20 22:25:30 INFO  ---RUNTIME: Importing and monkey-patching took 6.258726119995117 ms
2022-09-20 22:25:39 INFO  ---RUNTIME: Original pipeline execution took 8554.932355880737 ms (excluding imports and monkey-patching)
2022-09-20 22:25:39 INFO  Starting execution of 1 what-if analyses...
2022-09-20 22:25:39 INFO  Start plan generation for analysis DataCorruption...
2022-09-20 22:25:39 INFO  ---RUNTIME: Plan generation took 0.5748271942138672 ms
2022-09-20 22:25:39 INFO  Estimated runtime of original DAG is 6204.576253890991ms
2022-09-20 22:25:39 INFO  Performing Multi-Query Optimization
2022-09-20 22:25:39 INFO  Estimated unoptimized what-if runtime is 155114.40634727478ms
2022-09-20 22:25:39 INFO  Estimated optimised what-if runtime is 14030.75909614563ms
2022-09-20 22:25:39 INFO  Estimated optimisation runtime saving is 141083.64725112915ms
2022-09-20 22:25:39 INFO  ---RUNTIME: Multi-Query Optimization took 61.95402145385742 ms
2022-09-20 22:25:39 INFO  Executing generated plans
2022-09-20 22:26:00 INFO  ---RUNTIME: Execution took 20966.84694290161 ms
2022-09-20 22:26:00 INFO  Done!
2022-09-20 22:26:00 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-20 22:26:00 INFO  Running instrumented original pipeline...
2022-09-20 22:26:00 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-20 22:26:00 INFO  ---RUNTIME: Importing and monkey-patching took 8.864164352416992 ms
2022-09-20 22:26:11 INFO  ---RUNTIME: Original pipeline execution took 11680.718898773193 ms (excluding imports and monkey-patching)
2022-09-20 22:26:11 INFO  Starting execution of 1 what-if analyses...
2022-09-20 22:26:11 INFO  Start plan generation for analysis DataCorruption...
2022-09-20 22:26:11 INFO  ---RUNTIME: Plan generation took 0.8826255798339844 ms
2022-09-20 22:26:11 INFO  Estimated runtime of original DAG is 8269.53148841858ms
2022-09-20 22:26:11 WARNING Skipping Multi-Query Optimization (instead, only combine execution DAGs)
2022-09-20 22:26:12 INFO  Estimated unoptimised what-if runtime is 206738.28721046448ms
2022-09-20 22:26:12 INFO  ---RUNTIME: Multi-Query Optimization took 243.41106414794922 ms
2022-09-20 22:26:12 INFO  Executing generated plans
2022-09-20 22:29:23 INFO  ---RUNTIME: Execution took 190954.27918434143 ms
2022-09-20 22:29:23 INFO  Done!
2022-09-20 22:29:23 INFO  # Finished -- repetition 6 of 7 
2022-09-20 22:29:23 INFO  # Optimization benchmark for data_corruption with args [['reviews', 'slow_loading', 'featurization_1', 'xgboost']] -- repetition 7 of 7
2022-09-20 22:29:23 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-20 22:29:23 INFO  Running instrumented original pipeline...
2022-09-20 22:29:23 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-20 22:29:23 INFO  ---RUNTIME: Importing and monkey-patching took 6.660223007202148 ms
2022-09-20 22:29:32 INFO  ---RUNTIME: Original pipeline execution took 9178.718090057373 ms (excluding imports and monkey-patching)
2022-09-20 22:29:32 INFO  Starting execution of 1 what-if analyses...
2022-09-20 22:29:32 INFO  Start plan generation for analysis DataCorruption...
2022-09-20 22:29:32 INFO  ---RUNTIME: Plan generation took 0.5695819854736328 ms
2022-09-20 22:29:32 INFO  Estimated runtime of original DAG is 6863.152265548706ms
2022-09-20 22:29:32 INFO  Performing Multi-Query Optimization
2022-09-20 22:29:32 INFO  Estimated unoptimized what-if runtime is 171578.80663871765ms
2022-09-20 22:29:32 INFO  Estimated optimised what-if runtime is 14709.58685874939ms
2022-09-20 22:29:32 INFO  Estimated optimisation runtime saving is 156869.21977996826ms
2022-09-20 22:29:32 INFO  ---RUNTIME: Multi-Query Optimization took 61.6762638092041 ms
2022-09-20 22:29:32 INFO  Executing generated plans
2022-09-20 22:29:52 INFO  ---RUNTIME: Execution took 20029.741287231445 ms
2022-09-20 22:29:52 INFO  Done!
2022-09-20 22:29:52 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-20 22:29:52 INFO  Running instrumented original pipeline...
2022-09-20 22:29:52 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-20 22:29:52 INFO  ---RUNTIME: Importing and monkey-patching took 6.539821624755859 ms
2022-09-20 22:30:00 INFO  ---RUNTIME: Original pipeline execution took 8435.059070587158 ms (excluding imports and monkey-patching)
2022-09-20 22:30:00 INFO  Starting execution of 1 what-if analyses...
2022-09-20 22:30:00 INFO  Start plan generation for analysis DataCorruption...
2022-09-20 22:30:00 INFO  ---RUNTIME: Plan generation took 0.5533695220947266 ms
2022-09-20 22:30:00 INFO  Estimated runtime of original DAG is 6116.633653640747ms
2022-09-20 22:30:00 WARNING Skipping Multi-Query Optimization (instead, only combine execution DAGs)
2022-09-20 22:30:00 INFO  Estimated unoptimised what-if runtime is 152915.84134101868ms
2022-09-20 22:30:00 INFO  ---RUNTIME: Multi-Query Optimization took 137.82954216003418 ms
2022-09-20 22:30:00 INFO  Executing generated plans
2022-09-20 22:33:16 INFO  ---RUNTIME: Execution took 196029.79445457458 ms
2022-09-20 22:33:16 INFO  Done!
2022-09-20 22:33:16 INFO  # Finished -- repetition 7 of 7 
2022-09-20 22:33:16 INFO  # Final results after all repetitions
2022-09-20 22:33:16 INFO     repetition  ... no_opt_what_if_execution_combined_model_training
0           0  ...                                     22084.014893
1           1  ...                                     22800.458670
2           2  ...                                     22237.957239
3           3  ...                                     22321.141005
4           4  ...                                     22335.811138
5           5  ...                                     22112.636805
6           6  ...                                     22499.547958

[7 rows x 26 columns]
taskset -c 160-168 PROTOCOL_BUFFERS_PYTHON_IMPLEMENTATION=python python3.9 benchmarks_end_to_end.py data_corruption reviews slow_loading featurization_1 neural_network
2022-09-20 22:33:19.896134: W tensorflow/stream_executor/platform/default/dso_loader.cc:64] Could not load dynamic library 'libcudart.so.11.0'; dlerror: libcudart.so.11.0: cannot open shared object file: No such file or directory; LD_LIBRARY_PATH: /home/sgrafbe/mlwhatif/venv/lib/python3.9/site-packages/cv2/../../lib64:
2022-09-20 22:33:19.896181: I tensorflow/stream_executor/cuda/cudart_stub.cc:29] Ignore above cudart dlerror if you do not have a GPU set up on your machine.
2022-09-20 22:33:21 INFO  Patching sys.argv with ['mlwhatif', 'reviews', 'slow_loading', 'featurization_1', 'neural_network']
2022-09-20 22:33:21 INFO  Running instrumented original pipeline...
2022-09-20 22:33:21 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-20 22:33:21 INFO  ---RUNTIME: Importing and monkey-patching took 132.7078342437744 ms
2022-09-20 22:33:27.998211: W tensorflow/stream_executor/platform/default/dso_loader.cc:64] Could not load dynamic library 'libcuda.so.1'; dlerror: libcuda.so.1: cannot open shared object file: No such file or directory; LD_LIBRARY_PATH: /home/sgrafbe/mlwhatif/venv/lib/python3.9/site-packages/cv2/../../lib64:
2022-09-20 22:33:27.998248: W tensorflow/stream_executor/cuda/cuda_driver.cc:326] failed call to cuInit: UNKNOWN ERROR (303)
2022-09-20 22:33:27.998273: I tensorflow/stream_executor/cuda/cuda_diagnostics.cc:156] kernel driver does not appear to be running on this host (angus): /proc/driver/nvidia/version does not exist
2022-09-20 22:33:27.998780: I tensorflow/core/platform/cpu_feature_guard.cc:142] This TensorFlow binary is optimized with oneAPI Deep Neural Network Library (oneDNN) to use the following CPU instructions in performance-critical operations:  AVX2 FMA
To enable them in other operations, rebuild TensorFlow with the appropriate compiler flags.
2022-09-20 22:33:28.234933: I tensorflow/compiler/mlir/mlir_graph_optimization_pass.cc:176] None of the MLIR Optimization Passes are enabled (registered 2)
2022-09-20 22:33:28.247236: I tensorflow/core/platform/profile_utils/cpu_utils.cc:114] CPU Frequency: 2595130000 Hz
2022-09-20 22:33:33 INFO  ---RUNTIME: Original pipeline execution took 11486.161947250366 ms (excluding imports and monkey-patching)
2022-09-20 22:33:33 INFO  Starting execution of 0 what-if analyses...
2022-09-20 22:33:33 INFO  Estimated runtime of original DAG is 8988.942861557007ms
2022-09-20 22:33:33 INFO  Performing Multi-Query Optimization
2022-09-20 22:33:33 INFO  Estimated unoptimized what-if runtime is 0ms
2022-09-20 22:33:33 INFO  Estimated optimised what-if runtime is 0ms
2022-09-20 22:33:33 INFO  Estimated optimisation runtime saving is 0ms
2022-09-20 22:33:33 INFO  ---RUNTIME: Multi-Query Optimization took 0.47779083251953125 ms
2022-09-20 22:33:33 INFO  Executing generated plans
2022-09-20 22:33:33 INFO  ---RUNTIME: Execution took 0.015974044799804688 ms
2022-09-20 22:33:33 INFO  Done!
2022-09-20 22:33:33 INFO  # Optimization benchmark for data_corruption with args [['reviews', 'slow_loading', 'featurization_1', 'neural_network']] -- repetition 1 of 7
2022-09-20 22:33:33 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-20 22:33:33 INFO  Running instrumented original pipeline...
2022-09-20 22:33:33 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-20 22:33:33 INFO  ---RUNTIME: Importing and monkey-patching took 5.361080169677734 ms
2022-09-20 22:33:43 INFO  ---RUNTIME: Original pipeline execution took 10697.320699691772 ms (excluding imports and monkey-patching)
2022-09-20 22:33:43 INFO  Starting execution of 1 what-if analyses...
2022-09-20 22:33:43 INFO  Start plan generation for analysis DataCorruption...
2022-09-20 22:33:43 INFO  ---RUNTIME: Plan generation took 0.4253387451171875 ms
2022-09-20 22:33:43 INFO  Estimated runtime of original DAG is 8504.554986953735ms
2022-09-20 22:33:43 INFO  Performing Multi-Query Optimization
2022-09-20 22:33:43 INFO  Estimated unoptimized what-if runtime is 212613.87467384338ms
2022-09-20 22:33:43 INFO  Estimated optimised what-if runtime is 24336.33255958557ms
2022-09-20 22:33:43 INFO  Estimated optimisation runtime saving is 188277.5421142578ms
2022-09-20 22:33:43 INFO  ---RUNTIME: Multi-Query Optimization took 62.07108497619629 ms
2022-09-20 22:33:43 INFO  Executing generated plans
2022-09-20 22:34:14 INFO  ---RUNTIME: Execution took 30330.271005630493 ms
2022-09-20 22:34:14 INFO  Done!
2022-09-20 22:34:14 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-20 22:34:14 INFO  Running instrumented original pipeline...
2022-09-20 22:34:14 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-20 22:34:14 INFO  ---RUNTIME: Importing and monkey-patching took 6.187915802001953 ms
2022-09-20 22:34:24 INFO  ---RUNTIME: Original pipeline execution took 10702.58903503418 ms (excluding imports and monkey-patching)
2022-09-20 22:34:24 INFO  Starting execution of 1 what-if analyses...
2022-09-20 22:34:24 INFO  Start plan generation for analysis DataCorruption...
2022-09-20 22:34:24 INFO  ---RUNTIME: Plan generation took 2.058744430541992 ms
2022-09-20 22:34:24 INFO  Estimated runtime of original DAG is 8487.60461807251ms
2022-09-20 22:34:24 WARNING Skipping Multi-Query Optimization (instead, only combine execution DAGs)
2022-09-20 22:34:24 INFO  Estimated unoptimised what-if runtime is 212190.11545181274ms
2022-09-20 22:34:24 INFO  ---RUNTIME: Multi-Query Optimization took 131.22105598449707 ms
2022-09-20 22:34:24 INFO  Executing generated plans
2022-09-20 22:38:47 INFO  ---RUNTIME: Execution took 262091.52269363403 ms
2022-09-20 22:38:47 INFO  Done!
2022-09-20 22:38:47 INFO  # Finished -- repetition 1 of 7 
2022-09-20 22:38:47 INFO  # Optimization benchmark for data_corruption with args [['reviews', 'slow_loading', 'featurization_1', 'neural_network']] -- repetition 2 of 7
2022-09-20 22:38:47 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-20 22:38:47 INFO  Running instrumented original pipeline...
2022-09-20 22:38:47 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-20 22:38:47 INFO  ---RUNTIME: Importing and monkey-patching took 5.866765975952148 ms
2022-09-20 22:38:58 INFO  ---RUNTIME: Original pipeline execution took 10971.314907073975 ms (excluding imports and monkey-patching)
2022-09-20 22:38:58 INFO  Starting execution of 1 what-if analyses...
2022-09-20 22:38:58 INFO  Start plan generation for analysis DataCorruption...
2022-09-20 22:38:58 INFO  ---RUNTIME: Plan generation took 0.4069805145263672 ms
2022-09-20 22:38:58 INFO  Estimated runtime of original DAG is 8701.042652130127ms
2022-09-20 22:38:58 INFO  Performing Multi-Query Optimization
2022-09-20 22:38:58 INFO  Estimated unoptimized what-if runtime is 217526.06630325317ms
2022-09-20 22:38:58 INFO  Estimated optimised what-if runtime is 25121.877431869507ms
2022-09-20 22:38:58 INFO  Estimated optimisation runtime saving is 192404.18887138367ms
2022-09-20 22:38:58 INFO  ---RUNTIME: Multi-Query Optimization took 63.09628486633301 ms
2022-09-20 22:38:58 INFO  Executing generated plans
2022-09-20 22:39:29 INFO  ---RUNTIME: Execution took 31000.628232955933 ms
2022-09-20 22:39:29 INFO  Done!
2022-09-20 22:39:29 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-20 22:39:29 INFO  Running instrumented original pipeline...
2022-09-20 22:39:29 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-20 22:39:29 INFO  ---RUNTIME: Importing and monkey-patching took 5.894184112548828 ms
2022-09-20 22:39:41 INFO  ---RUNTIME: Original pipeline execution took 11959.443092346191 ms (excluding imports and monkey-patching)
2022-09-20 22:39:41 INFO  Starting execution of 1 what-if analyses...
2022-09-20 22:39:41 INFO  Start plan generation for analysis DataCorruption...
2022-09-20 22:39:41 INFO  ---RUNTIME: Plan generation took 0.41103363037109375 ms
2022-09-20 22:39:41 INFO  Estimated runtime of original DAG is 9675.985097885132ms
2022-09-20 22:39:41 WARNING Skipping Multi-Query Optimization (instead, only combine execution DAGs)
2022-09-20 22:39:41 INFO  Estimated unoptimised what-if runtime is 241899.6274471283ms
2022-09-20 22:39:41 INFO  ---RUNTIME: Multi-Query Optimization took 133.8973045349121 ms
2022-09-20 22:39:41 INFO  Executing generated plans
2022-09-20 22:44:04 INFO  ---RUNTIME: Execution took 263703.8676738739 ms
2022-09-20 22:44:04 INFO  Done!
2022-09-20 22:44:04 INFO  # Finished -- repetition 2 of 7 
2022-09-20 22:44:04 INFO  # Optimization benchmark for data_corruption with args [['reviews', 'slow_loading', 'featurization_1', 'neural_network']] -- repetition 3 of 7
2022-09-20 22:44:04 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-20 22:44:04 INFO  Running instrumented original pipeline...
2022-09-20 22:44:04 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-20 22:44:04 INFO  ---RUNTIME: Importing and monkey-patching took 5.7544708251953125 ms
2022-09-20 22:44:16 INFO  ---RUNTIME: Original pipeline execution took 11084.990739822388 ms (excluding imports and monkey-patching)
2022-09-20 22:44:16 INFO  Starting execution of 1 what-if analyses...
2022-09-20 22:44:16 INFO  Start plan generation for analysis DataCorruption...
2022-09-20 22:44:16 INFO  ---RUNTIME: Plan generation took 0.38695335388183594 ms
2022-09-20 22:44:16 INFO  Estimated runtime of original DAG is 8793.35880279541ms
2022-09-20 22:44:16 INFO  Performing Multi-Query Optimization
2022-09-20 22:44:16 INFO  Estimated unoptimized what-if runtime is 219833.97006988525ms
2022-09-20 22:44:16 INFO  Estimated optimised what-if runtime is 25180.21249771118ms
2022-09-20 22:44:16 INFO  Estimated optimisation runtime saving is 194653.75757217407ms
2022-09-20 22:44:16 INFO  ---RUNTIME: Multi-Query Optimization took 61.19489669799805 ms
2022-09-20 22:44:16 INFO  Executing generated plans
2022-09-20 22:44:46 INFO  ---RUNTIME: Execution took 30220.834255218506 ms
2022-09-20 22:44:46 INFO  Done!
2022-09-20 22:44:46 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-20 22:44:46 INFO  Running instrumented original pipeline...
2022-09-20 22:44:46 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-20 22:44:46 INFO  ---RUNTIME: Importing and monkey-patching took 6.210088729858398 ms
2022-09-20 22:44:57 INFO  ---RUNTIME: Original pipeline execution took 11584.742307662964 ms (excluding imports and monkey-patching)
2022-09-20 22:44:57 INFO  Starting execution of 1 what-if analyses...
2022-09-20 22:44:57 INFO  Start plan generation for analysis DataCorruption...
2022-09-20 22:44:57 INFO  ---RUNTIME: Plan generation took 0.4050731658935547 ms
2022-09-20 22:44:57 INFO  Estimated runtime of original DAG is 9311.094284057617ms
2022-09-20 22:44:57 WARNING Skipping Multi-Query Optimization (instead, only combine execution DAGs)
2022-09-20 22:44:58 INFO  Estimated unoptimised what-if runtime is 232777.35710144043ms
2022-09-20 22:44:58 INFO  ---RUNTIME: Multi-Query Optimization took 915.4746532440186 ms
2022-09-20 22:44:58 INFO  Executing generated plans
2022-09-20 22:49:18 INFO  ---RUNTIME: Execution took 259953.16863059998 ms
2022-09-20 22:49:18 INFO  Done!
2022-09-20 22:49:18 INFO  # Finished -- repetition 3 of 7 
2022-09-20 22:49:18 INFO  # Optimization benchmark for data_corruption with args [['reviews', 'slow_loading', 'featurization_1', 'neural_network']] -- repetition 4 of 7
2022-09-20 22:49:18 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-20 22:49:18 INFO  Running instrumented original pipeline...
2022-09-20 22:49:18 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-20 22:49:18 INFO  ---RUNTIME: Importing and monkey-patching took 5.932331085205078 ms
2022-09-20 22:49:30 INFO  ---RUNTIME: Original pipeline execution took 11632.030487060547 ms (excluding imports and monkey-patching)
2022-09-20 22:49:30 INFO  Starting execution of 1 what-if analyses...
2022-09-20 22:49:30 INFO  Start plan generation for analysis DataCorruption...
2022-09-20 22:49:30 INFO  ---RUNTIME: Plan generation took 0.47850608825683594 ms
2022-09-20 22:49:30 INFO  Estimated runtime of original DAG is 9317.336320877075ms
2022-09-20 22:49:30 INFO  Performing Multi-Query Optimization
2022-09-20 22:49:30 INFO  Estimated unoptimized what-if runtime is 232933.40802192688ms
2022-09-20 22:49:30 INFO  Estimated optimised what-if runtime is 25643.85747909546ms
2022-09-20 22:49:30 INFO  Estimated optimisation runtime saving is 207289.55054283142ms
2022-09-20 22:49:30 INFO  ---RUNTIME: Multi-Query Optimization took 62.73388862609863 ms
2022-09-20 22:49:30 INFO  Executing generated plans
2022-09-20 22:50:00 INFO  ---RUNTIME: Execution took 30448.479175567627 ms
2022-09-20 22:50:00 INFO  Done!
2022-09-20 22:50:00 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-20 22:50:00 INFO  Running instrumented original pipeline...
2022-09-20 22:50:00 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-20 22:50:01 INFO  ---RUNTIME: Importing and monkey-patching took 5.8135986328125 ms
2022-09-20 22:50:13 INFO  ---RUNTIME: Original pipeline execution took 12091.673135757446 ms (excluding imports and monkey-patching)
2022-09-20 22:50:13 INFO  Starting execution of 1 what-if analyses...
2022-09-20 22:50:13 INFO  Start plan generation for analysis DataCorruption...
2022-09-20 22:50:13 INFO  ---RUNTIME: Plan generation took 0.4093647003173828 ms
2022-09-20 22:50:13 INFO  Estimated runtime of original DAG is 9734.50255393982ms
2022-09-20 22:50:13 WARNING Skipping Multi-Query Optimization (instead, only combine execution DAGs)
2022-09-20 22:50:13 INFO  Estimated unoptimised what-if runtime is 243362.56384849548ms
2022-09-20 22:50:13 INFO  ---RUNTIME: Multi-Query Optimization took 137.38632202148438 ms
2022-09-20 22:50:13 INFO  Executing generated plans
2022-09-20 22:54:30 INFO  ---RUNTIME: Execution took 257478.80911827087 ms
2022-09-20 22:54:30 INFO  Done!
2022-09-20 22:54:30 INFO  # Finished -- repetition 4 of 7 
2022-09-20 22:54:30 INFO  # Optimization benchmark for data_corruption with args [['reviews', 'slow_loading', 'featurization_1', 'neural_network']] -- repetition 5 of 7
2022-09-20 22:54:30 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-20 22:54:30 INFO  Running instrumented original pipeline...
2022-09-20 22:54:30 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-20 22:54:30 INFO  ---RUNTIME: Importing and monkey-patching took 6.352901458740234 ms
2022-09-20 22:54:41 INFO  ---RUNTIME: Original pipeline execution took 10895.745515823364 ms (excluding imports and monkey-patching)
2022-09-20 22:54:41 INFO  Starting execution of 1 what-if analyses...
2022-09-20 22:54:41 INFO  Start plan generation for analysis DataCorruption...
2022-09-20 22:54:41 INFO  ---RUNTIME: Plan generation took 0.45490264892578125 ms
2022-09-20 22:54:41 INFO  Estimated runtime of original DAG is 8614.130020141602ms
2022-09-20 22:54:41 INFO  Performing Multi-Query Optimization
2022-09-20 22:54:41 INFO  Estimated unoptimized what-if runtime is 215353.25050354004ms
2022-09-20 22:54:41 INFO  Estimated optimised what-if runtime is 24259.31406021118ms
2022-09-20 22:54:41 INFO  Estimated optimisation runtime saving is 191093.93644332886ms
2022-09-20 22:54:41 INFO  ---RUNTIME: Multi-Query Optimization took 62.734127044677734 ms
2022-09-20 22:54:41 INFO  Executing generated plans
2022-09-20 22:55:12 INFO  ---RUNTIME: Execution took 30383.720636367798 ms
2022-09-20 22:55:12 INFO  Done!
2022-09-20 22:55:12 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-20 22:55:12 INFO  Running instrumented original pipeline...
2022-09-20 22:55:12 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-20 22:55:12 INFO  ---RUNTIME: Importing and monkey-patching took 6.664037704467773 ms
2022-09-20 22:55:25 INFO  ---RUNTIME: Original pipeline execution took 13342.249155044556 ms (excluding imports and monkey-patching)
2022-09-20 22:55:25 INFO  Starting execution of 1 what-if analyses...
2022-09-20 22:55:25 INFO  Start plan generation for analysis DataCorruption...
2022-09-20 22:55:25 INFO  ---RUNTIME: Plan generation took 0.4811286926269531 ms
2022-09-20 22:55:25 INFO  Estimated runtime of original DAG is 9979.038000106812ms
2022-09-20 22:55:25 WARNING Skipping Multi-Query Optimization (instead, only combine execution DAGs)
2022-09-20 22:55:25 INFO  Estimated unoptimised what-if runtime is 249475.9500026703ms
2022-09-20 22:55:25 INFO  ---RUNTIME: Multi-Query Optimization took 142.51351356506348 ms
2022-09-20 22:55:25 INFO  Executing generated plans
2022-09-20 22:59:43 INFO  ---RUNTIME: Execution took 257855.9992313385 ms
2022-09-20 22:59:43 INFO  Done!
2022-09-20 22:59:43 INFO  # Finished -- repetition 5 of 7 
2022-09-20 22:59:43 INFO  # Optimization benchmark for data_corruption with args [['reviews', 'slow_loading', 'featurization_1', 'neural_network']] -- repetition 6 of 7
2022-09-20 22:59:43 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-20 22:59:43 INFO  Running instrumented original pipeline...
2022-09-20 22:59:44 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-20 22:59:44 INFO  ---RUNTIME: Importing and monkey-patching took 6.462812423706055 ms
2022-09-20 22:59:55 INFO  ---RUNTIME: Original pipeline execution took 11902.679204940796 ms (excluding imports and monkey-patching)
2022-09-20 22:59:55 INFO  Starting execution of 1 what-if analyses...
2022-09-20 22:59:55 INFO  Start plan generation for analysis DataCorruption...
2022-09-20 22:59:55 INFO  ---RUNTIME: Plan generation took 0.4076957702636719 ms
2022-09-20 22:59:55 INFO  Estimated runtime of original DAG is 8813.199043273926ms
2022-09-20 22:59:55 INFO  Performing Multi-Query Optimization
2022-09-20 22:59:55 INFO  Estimated unoptimized what-if runtime is 220329.97608184814ms
2022-09-20 22:59:55 INFO  Estimated optimised what-if runtime is 25061.14935874939ms
2022-09-20 22:59:55 INFO  Estimated optimisation runtime saving is 195268.82672309875ms
2022-09-20 22:59:55 INFO  ---RUNTIME: Multi-Query Optimization took 61.47885322570801 ms
2022-09-20 22:59:55 INFO  Executing generated plans
2022-09-20 23:00:27 INFO  ---RUNTIME: Execution took 32155.636310577393 ms
2022-09-20 23:00:27 INFO  Done!
2022-09-20 23:00:27 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-20 23:00:27 INFO  Running instrumented original pipeline...
2022-09-20 23:00:27 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-20 23:00:27 INFO  ---RUNTIME: Importing and monkey-patching took 6.323814392089844 ms
2022-09-20 23:00:40 INFO  ---RUNTIME: Original pipeline execution took 12626.774311065674 ms (excluding imports and monkey-patching)
2022-09-20 23:00:40 INFO  Starting execution of 1 what-if analyses...
2022-09-20 23:00:40 INFO  Start plan generation for analysis DataCorruption...
2022-09-20 23:00:40 INFO  ---RUNTIME: Plan generation took 0.45490264892578125 ms
2022-09-20 23:00:40 INFO  Estimated runtime of original DAG is 10109.131574630737ms
2022-09-20 23:00:40 WARNING Skipping Multi-Query Optimization (instead, only combine execution DAGs)
2022-09-20 23:00:40 INFO  Estimated unoptimised what-if runtime is 252728.28936576843ms
2022-09-20 23:00:40 INFO  ---RUNTIME: Multi-Query Optimization took 141.32165908813477 ms
2022-09-20 23:00:40 INFO  Executing generated plans
2022-09-20 23:04:56 INFO  ---RUNTIME: Execution took 256339.4513130188 ms
2022-09-20 23:04:56 INFO  Done!
2022-09-20 23:04:56 INFO  # Finished -- repetition 6 of 7 
2022-09-20 23:04:56 INFO  # Optimization benchmark for data_corruption with args [['reviews', 'slow_loading', 'featurization_1', 'neural_network']] -- repetition 7 of 7
2022-09-20 23:04:56 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-20 23:04:56 INFO  Running instrumented original pipeline...
2022-09-20 23:04:56 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-20 23:04:56 INFO  ---RUNTIME: Importing and monkey-patching took 6.345272064208984 ms
2022-09-20 23:05:07 INFO  ---RUNTIME: Original pipeline execution took 10928.021907806396 ms (excluding imports and monkey-patching)
2022-09-20 23:05:07 INFO  Starting execution of 1 what-if analyses...
2022-09-20 23:05:07 INFO  Start plan generation for analysis DataCorruption...
2022-09-20 23:05:07 INFO  ---RUNTIME: Plan generation took 0.4017353057861328 ms
2022-09-20 23:05:07 INFO  Estimated runtime of original DAG is 8646.169662475586ms
2022-09-20 23:05:07 INFO  Performing Multi-Query Optimization
2022-09-20 23:05:07 INFO  Estimated unoptimized what-if runtime is 216154.24156188965ms
2022-09-20 23:05:07 INFO  Estimated optimised what-if runtime is 24275.665998458862ms
2022-09-20 23:05:07 INFO  Estimated optimisation runtime saving is 191878.5755634308ms
2022-09-20 23:05:07 INFO  ---RUNTIME: Multi-Query Optimization took 61.54274940490723 ms
2022-09-20 23:05:07 INFO  Executing generated plans
2022-09-20 23:05:39 INFO  ---RUNTIME: Execution took 32317.140579223633 ms
2022-09-20 23:05:39 INFO  Done!
2022-09-20 23:05:39 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-20 23:05:39 INFO  Running instrumented original pipeline...
2022-09-20 23:05:40 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-20 23:05:40 INFO  ---RUNTIME: Importing and monkey-patching took 6.5021514892578125 ms
2022-09-20 23:05:52 INFO  ---RUNTIME: Original pipeline execution took 12638.798236846924 ms (excluding imports and monkey-patching)
2022-09-20 23:05:52 INFO  Starting execution of 1 what-if analyses...
2022-09-20 23:05:52 INFO  Start plan generation for analysis DataCorruption...
2022-09-20 23:05:52 INFO  ---RUNTIME: Plan generation took 0.385284423828125 ms
2022-09-20 23:05:52 INFO  Estimated runtime of original DAG is 10226.211547851562ms
2022-09-20 23:05:52 WARNING Skipping Multi-Query Optimization (instead, only combine execution DAGs)
2022-09-20 23:05:53 INFO  Estimated unoptimised what-if runtime is 255655.28869628906ms
2022-09-20 23:05:53 INFO  ---RUNTIME: Multi-Query Optimization took 1046.0693836212158 ms
2022-09-20 23:05:53 INFO  Executing generated plans
2022-09-20 23:10:09 INFO  ---RUNTIME: Execution took 256261.63816452026 ms
2022-09-20 23:10:09 INFO  Done!
2022-09-20 23:10:09 INFO  # Finished -- repetition 7 of 7 
2022-09-20 23:10:09 INFO  # Final results after all repetitions
2022-09-20 23:10:09 INFO     repetition  ... no_opt_what_if_execution_combined_model_training
0           0  ...                                     80853.940487
1           1  ...                                     82920.429468
2           2  ...                                     79086.330175
3           3  ...                                     78328.282833
4           4  ...                                     78682.461023
5           5  ...                                     78461.688280
6           6  ...                                     78475.851536

[7 rows x 26 columns]
taskset -c 160-168 PROTOCOL_BUFFERS_PYTHON_IMPLEMENTATION=python python3.9 benchmarks_end_to_end.py data_corruption reviews slow_loading featurization_2 logistic_regression
2022-09-20 23:10:12.989654: W tensorflow/stream_executor/platform/default/dso_loader.cc:64] Could not load dynamic library 'libcudart.so.11.0'; dlerror: libcudart.so.11.0: cannot open shared object file: No such file or directory; LD_LIBRARY_PATH: /home/sgrafbe/mlwhatif/venv/lib/python3.9/site-packages/cv2/../../lib64:
2022-09-20 23:10:12.989702: I tensorflow/stream_executor/cuda/cudart_stub.cc:29] Ignore above cudart dlerror if you do not have a GPU set up on your machine.
2022-09-20 23:10:14 INFO  Patching sys.argv with ['mlwhatif', 'reviews', 'slow_loading', 'featurization_2', 'logistic_regression']
2022-09-20 23:10:14 INFO  Running instrumented original pipeline...
2022-09-20 23:10:14 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-20 23:10:14 INFO  ---RUNTIME: Importing and monkey-patching took 132.6425075531006 ms
2022-09-20 23:10:22 INFO  ---RUNTIME: Original pipeline execution took 7614.1517162323 ms (excluding imports and monkey-patching)
2022-09-20 23:10:22 INFO  Starting execution of 0 what-if analyses...
2022-09-20 23:10:22 INFO  Estimated runtime of original DAG is 6338.803052902222ms
2022-09-20 23:10:22 INFO  Performing Multi-Query Optimization
2022-09-20 23:10:22 INFO  Estimated unoptimized what-if runtime is 0ms
2022-09-20 23:10:22 INFO  Estimated optimised what-if runtime is 0ms
2022-09-20 23:10:22 INFO  Estimated optimisation runtime saving is 0ms
2022-09-20 23:10:22 INFO  ---RUNTIME: Multi-Query Optimization took 0.7045269012451172 ms
2022-09-20 23:10:22 INFO  Executing generated plans
2022-09-20 23:10:22 INFO  ---RUNTIME: Execution took 0.03647804260253906 ms
2022-09-20 23:10:22 INFO  Done!
2022-09-20 23:10:22 INFO  # Optimization benchmark for data_corruption with args [['reviews', 'slow_loading', 'featurization_2', 'logistic_regression']] -- repetition 1 of 7
2022-09-20 23:10:22 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-20 23:10:22 INFO  Running instrumented original pipeline...
2022-09-20 23:10:22 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-20 23:10:22 INFO  ---RUNTIME: Importing and monkey-patching took 6.103515625 ms
2022-09-20 23:10:29 INFO  ---RUNTIME: Original pipeline execution took 7709.52582359314 ms (excluding imports and monkey-patching)
2022-09-20 23:10:29 INFO  Starting execution of 1 what-if analyses...
2022-09-20 23:10:29 INFO  Start plan generation for analysis DataCorruption...
2022-09-20 23:10:29 INFO  ---RUNTIME: Plan generation took 0.4630088806152344 ms
2022-09-20 23:10:29 INFO  Estimated runtime of original DAG is 6474.285840988159ms
2022-09-20 23:10:29 INFO  Performing Multi-Query Optimization
2022-09-20 23:10:29 INFO  Estimated unoptimized what-if runtime is 161857.14602470398ms
2022-09-20 23:10:29 INFO  Estimated optimised what-if runtime is 15023.547887802124ms
2022-09-20 23:10:29 INFO  Estimated optimisation runtime saving is 146833.59813690186ms
2022-09-20 23:10:29 INFO  ---RUNTIME: Multi-Query Optimization took 72.28422164916992 ms
2022-09-20 23:10:29 INFO  Executing generated plans
2022-09-20 23:10:50 INFO  ---RUNTIME: Execution took 20650.992393493652 ms
2022-09-20 23:10:50 INFO  Done!
2022-09-20 23:10:50 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-20 23:10:50 INFO  Running instrumented original pipeline...
2022-09-20 23:10:50 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-20 23:10:50 INFO  ---RUNTIME: Importing and monkey-patching took 7.137775421142578 ms
2022-09-20 23:10:58 INFO  ---RUNTIME: Original pipeline execution took 8209.022521972656 ms (excluding imports and monkey-patching)
2022-09-20 23:10:58 INFO  Starting execution of 1 what-if analyses...
2022-09-20 23:10:58 INFO  Start plan generation for analysis DataCorruption...
2022-09-20 23:10:58 INFO  ---RUNTIME: Plan generation took 0.5412101745605469 ms
2022-09-20 23:10:58 INFO  Estimated runtime of original DAG is 6923.900604248047ms
2022-09-20 23:10:58 WARNING Skipping Multi-Query Optimization (instead, only combine execution DAGs)
2022-09-20 23:10:58 INFO  Estimated unoptimised what-if runtime is 173097.51510620117ms
2022-09-20 23:10:58 INFO  ---RUNTIME: Multi-Query Optimization took 155.534029006958 ms
2022-09-20 23:10:58 INFO  Executing generated plans
2022-09-20 23:14:07 INFO  ---RUNTIME: Execution took 188196.24590873718 ms
2022-09-20 23:14:07 INFO  Done!
2022-09-20 23:14:07 INFO  # Finished -- repetition 1 of 7 
2022-09-20 23:14:07 INFO  # Optimization benchmark for data_corruption with args [['reviews', 'slow_loading', 'featurization_2', 'logistic_regression']] -- repetition 2 of 7
2022-09-20 23:14:07 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-20 23:14:07 INFO  Running instrumented original pipeline...
2022-09-20 23:14:07 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-20 23:14:07 INFO  ---RUNTIME: Importing and monkey-patching took 6.4373016357421875 ms
2022-09-20 23:14:14 INFO  ---RUNTIME: Original pipeline execution took 7242.92516708374 ms (excluding imports and monkey-patching)
2022-09-20 23:14:14 INFO  Starting execution of 1 what-if analyses...
2022-09-20 23:14:14 INFO  Start plan generation for analysis DataCorruption...
2022-09-20 23:14:14 INFO  ---RUNTIME: Plan generation took 0.48160552978515625 ms
2022-09-20 23:14:14 INFO  Estimated runtime of original DAG is 6049.952030181885ms
2022-09-20 23:14:14 INFO  Performing Multi-Query Optimization
2022-09-20 23:14:14 INFO  Estimated unoptimized what-if runtime is 151248.80075454712ms
2022-09-20 23:14:14 INFO  Estimated optimised what-if runtime is 14277.414083480835ms
2022-09-20 23:14:14 INFO  Estimated optimisation runtime saving is 136971.38667106628ms
2022-09-20 23:14:14 INFO  ---RUNTIME: Multi-Query Optimization took 66.63727760314941 ms
2022-09-20 23:14:14 INFO  Executing generated plans
2022-09-20 23:14:34 INFO  ---RUNTIME: Execution took 19853.370189666748 ms
2022-09-20 23:14:34 INFO  Done!
2022-09-20 23:14:34 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-20 23:14:34 INFO  Running instrumented original pipeline...
2022-09-20 23:14:34 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-20 23:14:34 INFO  ---RUNTIME: Importing and monkey-patching took 5.788564682006836 ms
2022-09-20 23:14:41 INFO  ---RUNTIME: Original pipeline execution took 7446.740627288818 ms (excluding imports and monkey-patching)
2022-09-20 23:14:41 INFO  Starting execution of 1 what-if analyses...
2022-09-20 23:14:41 INFO  Start plan generation for analysis DataCorruption...
2022-09-20 23:14:41 INFO  ---RUNTIME: Plan generation took 0.4591941833496094 ms
2022-09-20 23:14:41 INFO  Estimated runtime of original DAG is 6245.775461196899ms
2022-09-20 23:14:41 WARNING Skipping Multi-Query Optimization (instead, only combine execution DAGs)
2022-09-20 23:14:41 INFO  Estimated unoptimised what-if runtime is 156144.38652992249ms
2022-09-20 23:14:41 INFO  ---RUNTIME: Multi-Query Optimization took 146.24547958374023 ms
2022-09-20 23:14:41 INFO  Executing generated plans
2022-09-20 23:17:48 INFO  ---RUNTIME: Execution took 186880.4097175598 ms
2022-09-20 23:17:48 INFO  Done!
2022-09-20 23:17:48 INFO  # Finished -- repetition 2 of 7 
2022-09-20 23:17:48 INFO  # Optimization benchmark for data_corruption with args [['reviews', 'slow_loading', 'featurization_2', 'logistic_regression']] -- repetition 3 of 7
2022-09-20 23:17:48 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-20 23:17:48 INFO  Running instrumented original pipeline...
2022-09-20 23:17:48 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-20 23:17:48 INFO  ---RUNTIME: Importing and monkey-patching took 6.387233734130859 ms
2022-09-20 23:17:56 INFO  ---RUNTIME: Original pipeline execution took 8073.592185974121 ms (excluding imports and monkey-patching)
2022-09-20 23:17:56 INFO  Starting execution of 1 what-if analyses...
2022-09-20 23:17:56 INFO  Start plan generation for analysis DataCorruption...
2022-09-20 23:17:56 INFO  ---RUNTIME: Plan generation took 0.4756450653076172 ms
2022-09-20 23:17:56 INFO  Estimated runtime of original DAG is 6866.80793762207ms
2022-09-20 23:17:56 INFO  Performing Multi-Query Optimization
2022-09-20 23:17:57 INFO  Estimated unoptimized what-if runtime is 171670.19844055176ms
2022-09-20 23:17:57 INFO  Estimated optimised what-if runtime is 15141.366243362427ms
2022-09-20 23:17:57 INFO  Estimated optimisation runtime saving is 156528.83219718933ms
2022-09-20 23:17:57 INFO  ---RUNTIME: Multi-Query Optimization took 66.11800193786621 ms
2022-09-20 23:17:57 INFO  Executing generated plans
2022-09-20 23:18:17 INFO  ---RUNTIME: Execution took 20133.727312088013 ms
2022-09-20 23:18:17 INFO  Done!
2022-09-20 23:18:17 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-20 23:18:17 INFO  Running instrumented original pipeline...
2022-09-20 23:18:17 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-20 23:18:17 INFO  ---RUNTIME: Importing and monkey-patching took 5.714893341064453 ms
2022-09-20 23:18:24 INFO  ---RUNTIME: Original pipeline execution took 7304.254531860352 ms (excluding imports and monkey-patching)
2022-09-20 23:18:24 INFO  Starting execution of 1 what-if analyses...
2022-09-20 23:18:24 INFO  Start plan generation for analysis DataCorruption...
2022-09-20 23:18:24 INFO  ---RUNTIME: Plan generation took 0.42629241943359375 ms
2022-09-20 23:18:24 INFO  Estimated runtime of original DAG is 6093.445062637329ms
2022-09-20 23:18:24 WARNING Skipping Multi-Query Optimization (instead, only combine execution DAGs)
2022-09-20 23:18:24 INFO  Estimated unoptimised what-if runtime is 152336.12656593323ms
2022-09-20 23:18:24 INFO  ---RUNTIME: Multi-Query Optimization took 143.37658882141113 ms
2022-09-20 23:18:24 INFO  Executing generated plans
2022-09-20 23:21:32 INFO  ---RUNTIME: Execution took 187518.68748664856 ms
2022-09-20 23:21:32 INFO  Done!
2022-09-20 23:21:32 INFO  # Finished -- repetition 3 of 7 
2022-09-20 23:21:32 INFO  # Optimization benchmark for data_corruption with args [['reviews', 'slow_loading', 'featurization_2', 'logistic_regression']] -- repetition 4 of 7
2022-09-20 23:21:32 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-20 23:21:32 INFO  Running instrumented original pipeline...
2022-09-20 23:21:32 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-20 23:21:32 INFO  ---RUNTIME: Importing and monkey-patching took 6.2999725341796875 ms
2022-09-20 23:21:39 INFO  ---RUNTIME: Original pipeline execution took 7295.514106750488 ms (excluding imports and monkey-patching)
2022-09-20 23:21:39 INFO  Starting execution of 1 what-if analyses...
2022-09-20 23:21:39 INFO  Start plan generation for analysis DataCorruption...
2022-09-20 23:21:39 INFO  ---RUNTIME: Plan generation took 0.4489421844482422 ms
2022-09-20 23:21:39 INFO  Estimated runtime of original DAG is 6086.312055587769ms
2022-09-20 23:21:39 INFO  Performing Multi-Query Optimization
2022-09-20 23:21:39 INFO  Estimated unoptimized what-if runtime is 152157.8013896942ms
2022-09-20 23:21:39 INFO  Estimated optimised what-if runtime is 14331.459522247314ms
2022-09-20 23:21:39 INFO  Estimated optimisation runtime saving is 137826.3418674469ms
2022-09-20 23:21:39 INFO  ---RUNTIME: Multi-Query Optimization took 65.85359573364258 ms
2022-09-20 23:21:39 INFO  Executing generated plans
2022-09-20 23:21:59 INFO  ---RUNTIME: Execution took 19949.29790496826 ms
2022-09-20 23:21:59 INFO  Done!
2022-09-20 23:21:59 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-20 23:21:59 INFO  Running instrumented original pipeline...
2022-09-20 23:21:59 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-20 23:21:59 INFO  ---RUNTIME: Importing and monkey-patching took 6.327629089355469 ms
2022-09-20 23:22:06 INFO  ---RUNTIME: Original pipeline execution took 7250.963449478149 ms (excluding imports and monkey-patching)
2022-09-20 23:22:06 INFO  Starting execution of 1 what-if analyses...
2022-09-20 23:22:06 INFO  Start plan generation for analysis DataCorruption...
2022-09-20 23:22:06 INFO  ---RUNTIME: Plan generation took 0.4367828369140625 ms
2022-09-20 23:22:06 INFO  Estimated runtime of original DAG is 6043.444871902466ms
2022-09-20 23:22:06 WARNING Skipping Multi-Query Optimization (instead, only combine execution DAGs)
2022-09-20 23:22:06 INFO  Estimated unoptimised what-if runtime is 151086.12179756165ms
2022-09-20 23:22:06 INFO  ---RUNTIME: Multi-Query Optimization took 145.38836479187012 ms
2022-09-20 23:22:06 INFO  Executing generated plans
2022-09-20 23:25:14 INFO  ---RUNTIME: Execution took 187354.48169708252 ms
2022-09-20 23:25:14 INFO  Done!
2022-09-20 23:25:14 INFO  # Finished -- repetition 4 of 7 
2022-09-20 23:25:14 INFO  # Optimization benchmark for data_corruption with args [['reviews', 'slow_loading', 'featurization_2', 'logistic_regression']] -- repetition 5 of 7
2022-09-20 23:25:14 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-20 23:25:14 INFO  Running instrumented original pipeline...
2022-09-20 23:25:14 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-20 23:25:14 INFO  ---RUNTIME: Importing and monkey-patching took 6.290197372436523 ms
2022-09-20 23:25:21 INFO  ---RUNTIME: Original pipeline execution took 7295.431613922119 ms (excluding imports and monkey-patching)
2022-09-20 23:25:21 INFO  Starting execution of 1 what-if analyses...
2022-09-20 23:25:21 INFO  Start plan generation for analysis DataCorruption...
2022-09-20 23:25:21 INFO  ---RUNTIME: Plan generation took 0.4565715789794922 ms
2022-09-20 23:25:21 INFO  Estimated runtime of original DAG is 6085.661888122559ms
2022-09-20 23:25:21 INFO  Performing Multi-Query Optimization
2022-09-20 23:25:21 INFO  Estimated unoptimized what-if runtime is 152141.54720306396ms
2022-09-20 23:25:21 INFO  Estimated optimised what-if runtime is 14397.371530532837ms
2022-09-20 23:25:21 INFO  Estimated optimisation runtime saving is 137744.17567253113ms
2022-09-20 23:25:21 INFO  ---RUNTIME: Multi-Query Optimization took 66.32232666015625 ms
2022-09-20 23:25:21 INFO  Executing generated plans
2022-09-20 23:25:41 INFO  ---RUNTIME: Execution took 20115.875482559204 ms
2022-09-20 23:25:41 INFO  Done!
2022-09-20 23:25:41 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-20 23:25:41 INFO  Running instrumented original pipeline...
2022-09-20 23:25:42 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-20 23:25:42 INFO  ---RUNTIME: Importing and monkey-patching took 6.056308746337891 ms
2022-09-20 23:25:49 INFO  ---RUNTIME: Original pipeline execution took 7538.715124130249 ms (excluding imports and monkey-patching)
2022-09-20 23:25:49 INFO  Starting execution of 1 what-if analyses...
2022-09-20 23:25:49 INFO  Start plan generation for analysis DataCorruption...
2022-09-20 23:25:49 INFO  ---RUNTIME: Plan generation took 0.43082237243652344 ms
2022-09-20 23:25:49 INFO  Estimated runtime of original DAG is 6054.994583129883ms
2022-09-20 23:25:49 WARNING Skipping Multi-Query Optimization (instead, only combine execution DAGs)
2022-09-20 23:25:49 INFO  Estimated unoptimised what-if runtime is 151374.86457824707ms
2022-09-20 23:25:49 INFO  ---RUNTIME: Multi-Query Optimization took 144.44470405578613 ms
2022-09-20 23:25:49 INFO  Executing generated plans
2022-09-20 23:28:56 INFO  ---RUNTIME: Execution took 187093.56832504272 ms
2022-09-20 23:28:56 INFO  Done!
2022-09-20 23:28:56 INFO  # Finished -- repetition 5 of 7 
2022-09-20 23:28:56 INFO  # Optimization benchmark for data_corruption with args [['reviews', 'slow_loading', 'featurization_2', 'logistic_regression']] -- repetition 6 of 7
2022-09-20 23:28:56 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-20 23:28:56 INFO  Running instrumented original pipeline...
2022-09-20 23:28:56 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-20 23:28:56 INFO  ---RUNTIME: Importing and monkey-patching took 6.489276885986328 ms
2022-09-20 23:29:04 INFO  ---RUNTIME: Original pipeline execution took 7951.263189315796 ms (excluding imports and monkey-patching)
2022-09-20 23:29:04 INFO  Starting execution of 1 what-if analyses...
2022-09-20 23:29:04 INFO  Start plan generation for analysis DataCorruption...
2022-09-20 23:29:04 INFO  ---RUNTIME: Plan generation took 0.4742145538330078 ms
2022-09-20 23:29:04 INFO  Estimated runtime of original DAG is 6734.479188919067ms
2022-09-20 23:29:04 INFO  Performing Multi-Query Optimization
2022-09-20 23:29:04 INFO  Estimated unoptimized what-if runtime is 168361.97972297668ms
2022-09-20 23:29:04 INFO  Estimated optimised what-if runtime is 15019.616842269897ms
2022-09-20 23:29:04 INFO  Estimated optimisation runtime saving is 153342.3628807068ms
2022-09-20 23:29:04 INFO  ---RUNTIME: Multi-Query Optimization took 65.95993041992188 ms
2022-09-20 23:29:04 INFO  Executing generated plans
2022-09-20 23:29:24 INFO  ---RUNTIME: Execution took 20096.568822860718 ms
2022-09-20 23:29:24 INFO  Done!
2022-09-20 23:29:24 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-20 23:29:24 INFO  Running instrumented original pipeline...
2022-09-20 23:29:24 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-20 23:29:24 INFO  ---RUNTIME: Importing and monkey-patching took 5.779504776000977 ms
2022-09-20 23:29:32 INFO  ---RUNTIME: Original pipeline execution took 7271.878004074097 ms (excluding imports and monkey-patching)
2022-09-20 23:29:32 INFO  Starting execution of 1 what-if analyses...
2022-09-20 23:29:32 INFO  Start plan generation for analysis DataCorruption...
2022-09-20 23:29:32 INFO  ---RUNTIME: Plan generation took 0.5662441253662109 ms
2022-09-20 23:29:32 INFO  Estimated runtime of original DAG is 6050.590991973877ms
2022-09-20 23:29:32 WARNING Skipping Multi-Query Optimization (instead, only combine execution DAGs)
2022-09-20 23:29:32 INFO  Estimated unoptimised what-if runtime is 151264.77479934692ms
2022-09-20 23:29:32 INFO  ---RUNTIME: Multi-Query Optimization took 144.32644844055176 ms
2022-09-20 23:29:32 INFO  Executing generated plans
2022-09-20 23:32:39 INFO  ---RUNTIME: Execution took 187124.72701072693 ms
2022-09-20 23:32:39 INFO  Done!
2022-09-20 23:32:39 INFO  # Finished -- repetition 6 of 7 
2022-09-20 23:32:39 INFO  # Optimization benchmark for data_corruption with args [['reviews', 'slow_loading', 'featurization_2', 'logistic_regression']] -- repetition 7 of 7
2022-09-20 23:32:39 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-20 23:32:39 INFO  Running instrumented original pipeline...
2022-09-20 23:32:39 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-20 23:32:39 INFO  ---RUNTIME: Importing and monkey-patching took 6.314754486083984 ms
2022-09-20 23:32:46 INFO  ---RUNTIME: Original pipeline execution took 7322.4828243255615 ms (excluding imports and monkey-patching)
2022-09-20 23:32:46 INFO  Starting execution of 1 what-if analyses...
2022-09-20 23:32:46 INFO  Start plan generation for analysis DataCorruption...
2022-09-20 23:32:46 INFO  ---RUNTIME: Plan generation took 0.48279762268066406 ms
2022-09-20 23:32:46 INFO  Estimated runtime of original DAG is 6103.384733200073ms
2022-09-20 23:32:46 INFO  Performing Multi-Query Optimization
2022-09-20 23:32:46 INFO  Estimated unoptimized what-if runtime is 152584.61833000183ms
2022-09-20 23:32:46 INFO  Estimated optimised what-if runtime is 14432.344913482666ms
2022-09-20 23:32:46 INFO  Estimated optimisation runtime saving is 138152.27341651917ms
2022-09-20 23:32:46 INFO  ---RUNTIME: Multi-Query Optimization took 67.07406044006348 ms
2022-09-20 23:32:46 INFO  Executing generated plans
2022-09-20 23:33:06 INFO  ---RUNTIME: Execution took 19992.11311340332 ms
2022-09-20 23:33:06 INFO  Done!
2022-09-20 23:33:06 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-20 23:33:06 INFO  Running instrumented original pipeline...
2022-09-20 23:33:06 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-20 23:33:06 INFO  ---RUNTIME: Importing and monkey-patching took 6.463050842285156 ms
2022-09-20 23:33:14 INFO  ---RUNTIME: Original pipeline execution took 7259.18436050415 ms (excluding imports and monkey-patching)
2022-09-20 23:33:14 INFO  Starting execution of 1 what-if analyses...
2022-09-20 23:33:14 INFO  Start plan generation for analysis DataCorruption...
2022-09-20 23:33:14 INFO  ---RUNTIME: Plan generation took 0.4436969757080078 ms
2022-09-20 23:33:14 INFO  Estimated runtime of original DAG is 6042.67430305481ms
2022-09-20 23:33:14 WARNING Skipping Multi-Query Optimization (instead, only combine execution DAGs)
2022-09-20 23:33:14 INFO  Estimated unoptimised what-if runtime is 151066.85757637024ms
2022-09-20 23:33:14 INFO  ---RUNTIME: Multi-Query Optimization took 143.7058448791504 ms
2022-09-20 23:33:14 INFO  Executing generated plans
2022-09-20 23:36:21 INFO  ---RUNTIME: Execution took 187549.34525489807 ms
2022-09-20 23:36:21 INFO  Done!
2022-09-20 23:36:21 INFO  # Finished -- repetition 7 of 7 
2022-09-20 23:36:21 INFO  # Final results after all repetitions
2022-09-20 23:36:21 INFO     repetition  ... no_opt_what_if_execution_combined_model_training
0           0  ...                                      2683.585882
1           1  ...                                      2631.361961
2           2  ...                                      2682.248831
3           3  ...                                      2649.819374
4           4  ...                                      2656.380653
5           5  ...                                      2680.499077
6           6  ...                                      2917.397738

[7 rows x 26 columns]
taskset -c 160-168 PROTOCOL_BUFFERS_PYTHON_IMPLEMENTATION=python python3.9 benchmarks_end_to_end.py data_corruption reviews slow_loading featurization_2 xgboost
2022-09-20 23:36:24.896973: W tensorflow/stream_executor/platform/default/dso_loader.cc:64] Could not load dynamic library 'libcudart.so.11.0'; dlerror: libcudart.so.11.0: cannot open shared object file: No such file or directory; LD_LIBRARY_PATH: /home/sgrafbe/mlwhatif/venv/lib/python3.9/site-packages/cv2/../../lib64:
2022-09-20 23:36:24.897026: I tensorflow/stream_executor/cuda/cudart_stub.cc:29] Ignore above cudart dlerror if you do not have a GPU set up on your machine.
2022-09-20 23:36:26 INFO  Patching sys.argv with ['mlwhatif', 'reviews', 'slow_loading', 'featurization_2', 'xgboost']
2022-09-20 23:36:26 INFO  Running instrumented original pipeline...
2022-09-20 23:36:26 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-20 23:36:26 INFO  ---RUNTIME: Importing and monkey-patching took 140.9616470336914 ms
2022-09-20 23:37:03 INFO  ---RUNTIME: Original pipeline execution took 36994.96912956238 ms (excluding imports and monkey-patching)
2022-09-20 23:37:03 INFO  Starting execution of 0 what-if analyses...
2022-09-20 23:37:03 INFO  Estimated runtime of original DAG is 35749.794006347656ms
2022-09-20 23:37:03 INFO  Performing Multi-Query Optimization
2022-09-20 23:37:03 INFO  Estimated unoptimized what-if runtime is 0ms
2022-09-20 23:37:03 INFO  Estimated optimised what-if runtime is 0ms
2022-09-20 23:37:03 INFO  Estimated optimisation runtime saving is 0ms
2022-09-20 23:37:03 INFO  ---RUNTIME: Multi-Query Optimization took 0.5462169647216797 ms
2022-09-20 23:37:03 INFO  Executing generated plans
2022-09-20 23:37:03 INFO  ---RUNTIME: Execution took 0.025033950805664062 ms
2022-09-20 23:37:03 INFO  Done!
2022-09-20 23:37:03 INFO  # Optimization benchmark for data_corruption with args [['reviews', 'slow_loading', 'featurization_2', 'xgboost']] -- repetition 1 of 7
2022-09-20 23:37:03 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-20 23:37:03 INFO  Running instrumented original pipeline...
2022-09-20 23:37:03 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-20 23:37:03 INFO  ---RUNTIME: Importing and monkey-patching took 5.819797515869141 ms
2022-09-20 23:37:23 INFO  ---RUNTIME: Original pipeline execution took 19666.646718978882 ms (excluding imports and monkey-patching)
2022-09-20 23:37:23 INFO  Starting execution of 1 what-if analyses...
2022-09-20 23:37:23 INFO  Start plan generation for analysis DataCorruption...
2022-09-20 23:37:23 INFO  ---RUNTIME: Plan generation took 0.4792213439941406 ms
2022-09-20 23:37:23 INFO  Estimated runtime of original DAG is 18266.30425453186ms
2022-09-20 23:37:23 INFO  Performing Multi-Query Optimization
2022-09-20 23:37:23 INFO  Estimated unoptimized what-if runtime is 456657.6063632965ms
2022-09-20 23:37:23 INFO  Estimated optimised what-if runtime is 27818.71199607849ms
2022-09-20 23:37:23 INFO  Estimated optimisation runtime saving is 428838.894367218ms
2022-09-20 23:37:23 INFO  ---RUNTIME: Multi-Query Optimization took 66.29371643066406 ms
2022-09-20 23:37:23 INFO  Executing generated plans
2022-09-20 23:37:58 INFO  ---RUNTIME: Execution took 35314.39304351807 ms
2022-09-20 23:37:58 INFO  Done!
2022-09-20 23:37:58 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-20 23:37:58 INFO  Running instrumented original pipeline...
2022-09-20 23:37:58 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-20 23:37:58 INFO  ---RUNTIME: Importing and monkey-patching took 6.517171859741211 ms
2022-09-20 23:38:18 INFO  ---RUNTIME: Original pipeline execution took 19979.610919952393 ms (excluding imports and monkey-patching)
2022-09-20 23:38:18 INFO  Starting execution of 1 what-if analyses...
2022-09-20 23:38:18 INFO  Start plan generation for analysis DataCorruption...
2022-09-20 23:38:18 INFO  ---RUNTIME: Plan generation took 0.4534721374511719 ms
2022-09-20 23:38:18 INFO  Estimated runtime of original DAG is 18413.7179851532ms
2022-09-20 23:38:18 WARNING Skipping Multi-Query Optimization (instead, only combine execution DAGs)
2022-09-20 23:38:18 INFO  Estimated unoptimised what-if runtime is 460342.94962882996ms
2022-09-20 23:38:18 INFO  ---RUNTIME: Multi-Query Optimization took 142.45152473449707 ms
2022-09-20 23:38:18 INFO  Executing generated plans
2022-09-20 23:46:52 INFO  ---RUNTIME: Execution took 513666.32175445557 ms
2022-09-20 23:46:52 INFO  Done!
2022-09-20 23:46:52 INFO  # Finished -- repetition 1 of 7 
2022-09-20 23:46:52 INFO  # Optimization benchmark for data_corruption with args [['reviews', 'slow_loading', 'featurization_2', 'xgboost']] -- repetition 2 of 7
2022-09-20 23:46:52 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-20 23:46:52 INFO  Running instrumented original pipeline...
2022-09-20 23:46:52 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-20 23:46:52 INFO  ---RUNTIME: Importing and monkey-patching took 6.472110748291016 ms
2022-09-20 23:47:14 INFO  ---RUNTIME: Original pipeline execution took 22092.156648635864 ms (excluding imports and monkey-patching)
2022-09-20 23:47:14 INFO  Starting execution of 1 what-if analyses...
2022-09-20 23:47:14 INFO  Start plan generation for analysis DataCorruption...
2022-09-20 23:47:14 INFO  ---RUNTIME: Plan generation took 0.5359649658203125 ms
2022-09-20 23:47:14 INFO  Estimated runtime of original DAG is 20834.08236503601ms
2022-09-20 23:47:14 INFO  Performing Multi-Query Optimization
2022-09-20 23:47:14 INFO  Estimated unoptimized what-if runtime is 520852.05912590027ms
2022-09-20 23:47:14 INFO  Estimated optimised what-if runtime is 34166.37682914734ms
2022-09-20 23:47:14 INFO  Estimated optimisation runtime saving is 486685.68229675293ms
2022-09-20 23:47:14 INFO  ---RUNTIME: Multi-Query Optimization took 113.83914947509766 ms
2022-09-20 23:47:14 INFO  Executing generated plans
2022-09-20 23:47:48 INFO  ---RUNTIME: Execution took 34339.47277069092 ms
2022-09-20 23:47:48 INFO  Done!
2022-09-20 23:47:48 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-20 23:47:48 INFO  Running instrumented original pipeline...
2022-09-20 23:47:48 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-20 23:47:48 INFO  ---RUNTIME: Importing and monkey-patching took 6.212711334228516 ms
2022-09-20 23:48:10 INFO  ---RUNTIME: Original pipeline execution took 21114.507913589478 ms (excluding imports and monkey-patching)
2022-09-20 23:48:10 INFO  Starting execution of 1 what-if analyses...
2022-09-20 23:48:10 INFO  Start plan generation for analysis DataCorruption...
2022-09-20 23:48:10 INFO  ---RUNTIME: Plan generation took 0.5128383636474609 ms
2022-09-20 23:48:10 INFO  Estimated runtime of original DAG is 19881.043672561646ms
2022-09-20 23:48:10 WARNING Skipping Multi-Query Optimization (instead, only combine execution DAGs)
2022-09-20 23:48:10 INFO  Estimated unoptimised what-if runtime is 497026.09181404114ms
2022-09-20 23:48:10 INFO  ---RUNTIME: Multi-Query Optimization took 149.34587478637695 ms
2022-09-20 23:48:10 INFO  Executing generated plans
2022-09-20 23:56:57 INFO  ---RUNTIME: Execution took 527577.552318573 ms
2022-09-20 23:56:57 INFO  Done!
2022-09-20 23:56:57 INFO  # Finished -- repetition 2 of 7 
2022-09-20 23:56:57 INFO  # Optimization benchmark for data_corruption with args [['reviews', 'slow_loading', 'featurization_2', 'xgboost']] -- repetition 3 of 7
2022-09-20 23:56:57 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-20 23:56:57 INFO  Running instrumented original pipeline...
2022-09-20 23:56:57 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-20 23:56:57 INFO  ---RUNTIME: Importing and monkey-patching took 6.349802017211914 ms
2022-09-20 23:57:18 INFO  ---RUNTIME: Original pipeline execution took 20703.505039215088 ms (excluding imports and monkey-patching)
2022-09-20 23:57:18 INFO  Starting execution of 1 what-if analyses...
2022-09-20 23:57:18 INFO  Start plan generation for analysis DataCorruption...
2022-09-20 23:57:18 INFO  ---RUNTIME: Plan generation took 0.48041343688964844 ms
2022-09-20 23:57:18 INFO  Estimated runtime of original DAG is 19458.30726623535ms
2022-09-20 23:57:18 INFO  Performing Multi-Query Optimization
2022-09-20 23:57:18 INFO  Estimated unoptimized what-if runtime is 486457.6816558838ms
2022-09-20 23:57:18 INFO  Estimated optimised what-if runtime is 28974.640607833862ms
2022-09-20 23:57:18 INFO  Estimated optimisation runtime saving is 457483.0410480499ms
2022-09-20 23:57:18 INFO  ---RUNTIME: Multi-Query Optimization took 67.9786205291748 ms
2022-09-20 23:57:18 INFO  Executing generated plans
2022-09-20 23:57:52 INFO  ---RUNTIME: Execution took 33528.55730056763 ms
2022-09-20 23:57:52 INFO  Done!
2022-09-20 23:57:52 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-20 23:57:52 INFO  Running instrumented original pipeline...
2022-09-20 23:57:52 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-20 23:57:52 INFO  ---RUNTIME: Importing and monkey-patching took 5.890130996704102 ms
2022-09-20 23:58:12 INFO  ---RUNTIME: Original pipeline execution took 20252.93755531311 ms (excluding imports and monkey-patching)
2022-09-20 23:58:12 INFO  Starting execution of 1 what-if analyses...
2022-09-20 23:58:12 INFO  Start plan generation for analysis DataCorruption...
2022-09-20 23:58:12 INFO  ---RUNTIME: Plan generation took 0.4856586456298828 ms
2022-09-20 23:58:12 INFO  Estimated runtime of original DAG is 18913.045644760132ms
2022-09-20 23:58:12 WARNING Skipping Multi-Query Optimization (instead, only combine execution DAGs)
2022-09-20 23:58:12 INFO  Estimated unoptimised what-if runtime is 472826.1411190033ms
2022-09-20 23:58:12 INFO  ---RUNTIME: Multi-Query Optimization took 150.64525604248047 ms
2022-09-20 23:58:12 INFO  Executing generated plans
2022-09-21 00:06:58 INFO  ---RUNTIME: Execution took 525894.9739933014 ms
2022-09-21 00:06:58 INFO  Done!
2022-09-21 00:06:58 INFO  # Finished -- repetition 3 of 7 
2022-09-21 00:06:58 INFO  # Optimization benchmark for data_corruption with args [['reviews', 'slow_loading', 'featurization_2', 'xgboost']] -- repetition 4 of 7
2022-09-21 00:06:58 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-21 00:06:58 INFO  Running instrumented original pipeline...
2022-09-21 00:06:58 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-21 00:06:58 INFO  ---RUNTIME: Importing and monkey-patching took 6.350278854370117 ms
2022-09-21 00:07:21 INFO  ---RUNTIME: Original pipeline execution took 22974.143028259277 ms (excluding imports and monkey-patching)
2022-09-21 00:07:21 INFO  Starting execution of 1 what-if analyses...
2022-09-21 00:07:21 INFO  Start plan generation for analysis DataCorruption...
2022-09-21 00:07:21 INFO  ---RUNTIME: Plan generation took 0.48613548278808594 ms
2022-09-21 00:07:21 INFO  Estimated runtime of original DAG is 21402.64844894409ms
2022-09-21 00:07:21 INFO  Performing Multi-Query Optimization
2022-09-21 00:07:21 INFO  Estimated unoptimized what-if runtime is 535066.2112236023ms
2022-09-21 00:07:21 INFO  Estimated optimised what-if runtime is 30826.593160629272ms
2022-09-21 00:07:21 INFO  Estimated optimisation runtime saving is 504239.618062973ms
2022-09-21 00:07:21 INFO  ---RUNTIME: Multi-Query Optimization took 66.94841384887695 ms
2022-09-21 00:07:21 INFO  Executing generated plans
2022-09-21 00:07:54 INFO  ---RUNTIME: Execution took 33193.86553764343 ms
2022-09-21 00:07:54 INFO  Done!
2022-09-21 00:07:54 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-21 00:07:54 INFO  Running instrumented original pipeline...
2022-09-21 00:07:54 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-21 00:07:54 INFO  ---RUNTIME: Importing and monkey-patching took 6.213665008544922 ms
2022-09-21 00:08:13 INFO  ---RUNTIME: Original pipeline execution took 19031.733751296997 ms (excluding imports and monkey-patching)
2022-09-21 00:08:13 INFO  Starting execution of 1 what-if analyses...
2022-09-21 00:08:13 INFO  Start plan generation for analysis DataCorruption...
2022-09-21 00:08:13 INFO  ---RUNTIME: Plan generation took 0.4448890686035156 ms
2022-09-21 00:08:13 INFO  Estimated runtime of original DAG is 17810.302734375ms
2022-09-21 00:08:13 WARNING Skipping Multi-Query Optimization (instead, only combine execution DAGs)
2022-09-21 00:08:13 INFO  Estimated unoptimised what-if runtime is 445257.568359375ms
2022-09-21 00:08:13 INFO  ---RUNTIME: Multi-Query Optimization took 140.78545570373535 ms
2022-09-21 00:08:13 INFO  Executing generated plans
2022-09-21 00:16:56 INFO  ---RUNTIME: Execution took 522730.01194000244 ms
2022-09-21 00:16:56 INFO  Done!
2022-09-21 00:16:56 INFO  # Finished -- repetition 4 of 7 
2022-09-21 00:16:56 INFO  # Optimization benchmark for data_corruption with args [['reviews', 'slow_loading', 'featurization_2', 'xgboost']] -- repetition 5 of 7
2022-09-21 00:16:56 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-21 00:16:56 INFO  Running instrumented original pipeline...
2022-09-21 00:16:56 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-21 00:16:56 INFO  ---RUNTIME: Importing and monkey-patching took 6.1817169189453125 ms
2022-09-21 00:17:17 INFO  ---RUNTIME: Original pipeline execution took 20461.25555038452 ms (excluding imports and monkey-patching)
2022-09-21 00:17:17 INFO  Starting execution of 1 what-if analyses...
2022-09-21 00:17:17 INFO  Start plan generation for analysis DataCorruption...
2022-09-21 00:17:17 INFO  ---RUNTIME: Plan generation took 0.4317760467529297 ms
2022-09-21 00:17:17 INFO  Estimated runtime of original DAG is 19230.637311935425ms
2022-09-21 00:17:17 INFO  Performing Multi-Query Optimization
2022-09-21 00:17:17 INFO  Estimated unoptimized what-if runtime is 480765.9327983856ms
2022-09-21 00:17:17 INFO  Estimated optimised what-if runtime is 28583.034992218018ms
2022-09-21 00:17:17 INFO  Estimated optimisation runtime saving is 452182.8978061676ms
2022-09-21 00:17:17 INFO  ---RUNTIME: Multi-Query Optimization took 65.5210018157959 ms
2022-09-21 00:17:17 INFO  Executing generated plans
2022-09-21 00:17:54 INFO  ---RUNTIME: Execution took 37469.0306186676 ms
2022-09-21 00:17:54 INFO  Done!
2022-09-21 00:17:54 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-21 00:17:54 INFO  Running instrumented original pipeline...
2022-09-21 00:17:55 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-21 00:17:55 INFO  ---RUNTIME: Importing and monkey-patching took 6.750345230102539 ms
2022-09-21 00:18:16 INFO  ---RUNTIME: Original pipeline execution took 21346.904039382935 ms (excluding imports and monkey-patching)
2022-09-21 00:18:16 INFO  Starting execution of 1 what-if analyses...
2022-09-21 00:18:16 INFO  Start plan generation for analysis DataCorruption...
2022-09-21 00:18:16 INFO  ---RUNTIME: Plan generation took 0.4220008850097656 ms
2022-09-21 00:18:16 INFO  Estimated runtime of original DAG is 19442.838191986084ms
2022-09-21 00:18:16 WARNING Skipping Multi-Query Optimization (instead, only combine execution DAGs)
2022-09-21 00:18:16 INFO  Estimated unoptimised what-if runtime is 486070.9547996521ms
2022-09-21 00:18:16 INFO  ---RUNTIME: Multi-Query Optimization took 142.14801788330078 ms
2022-09-21 00:18:16 INFO  Executing generated plans
2022-09-21 00:27:05 INFO  ---RUNTIME: Execution took 529536.8070602417 ms
2022-09-21 00:27:05 INFO  Done!
2022-09-21 00:27:05 INFO  # Finished -- repetition 5 of 7 
2022-09-21 00:27:05 INFO  # Optimization benchmark for data_corruption with args [['reviews', 'slow_loading', 'featurization_2', 'xgboost']] -- repetition 6 of 7
2022-09-21 00:27:05 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-21 00:27:05 INFO  Running instrumented original pipeline...
2022-09-21 00:27:05 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-21 00:27:05 INFO  ---RUNTIME: Importing and monkey-patching took 11.706829071044922 ms
2022-09-21 00:27:26 INFO  ---RUNTIME: Original pipeline execution took 20710.797786712646 ms (excluding imports and monkey-patching)
2022-09-21 00:27:26 INFO  Starting execution of 1 what-if analyses...
2022-09-21 00:27:26 INFO  Start plan generation for analysis DataCorruption...
2022-09-21 00:27:26 INFO  ---RUNTIME: Plan generation took 0.4858970642089844 ms
2022-09-21 00:27:26 INFO  Estimated runtime of original DAG is 19443.83931159973ms
2022-09-21 00:27:26 INFO  Performing Multi-Query Optimization
2022-09-21 00:27:26 INFO  Estimated unoptimized what-if runtime is 486095.9827899933ms
2022-09-21 00:27:26 INFO  Estimated optimised what-if runtime is 28986.093521118164ms
2022-09-21 00:27:26 INFO  Estimated optimisation runtime saving is 457109.8892688751ms
2022-09-21 00:27:26 INFO  ---RUNTIME: Multi-Query Optimization took 67.03853607177734 ms
2022-09-21 00:27:26 INFO  Executing generated plans
2022-09-21 00:28:00 INFO  ---RUNTIME: Execution took 34049.50261116028 ms
2022-09-21 00:28:00 INFO  Done!
2022-09-21 00:28:00 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-21 00:28:00 INFO  Running instrumented original pipeline...
2022-09-21 00:28:00 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-21 00:28:00 INFO  ---RUNTIME: Importing and monkey-patching took 6.042957305908203 ms
2022-09-21 00:28:21 INFO  ---RUNTIME: Original pipeline execution took 21105.39960861206 ms (excluding imports and monkey-patching)
2022-09-21 00:28:21 INFO  Starting execution of 1 what-if analyses...
2022-09-21 00:28:21 INFO  Start plan generation for analysis DataCorruption...
2022-09-21 00:28:21 INFO  ---RUNTIME: Plan generation took 0.5917549133300781 ms
2022-09-21 00:28:21 INFO  Estimated runtime of original DAG is 19875.206232070923ms
2022-09-21 00:28:21 WARNING Skipping Multi-Query Optimization (instead, only combine execution DAGs)
2022-09-21 00:28:21 INFO  Estimated unoptimised what-if runtime is 496880.1558017731ms
2022-09-21 00:28:21 INFO  ---RUNTIME: Multi-Query Optimization took 146.49701118469238 ms
2022-09-21 00:28:21 INFO  Executing generated plans
2022-09-21 00:36:50 INFO  ---RUNTIME: Execution took 508576.2369632721 ms
2022-09-21 00:36:50 INFO  Done!
2022-09-21 00:36:50 INFO  # Finished -- repetition 6 of 7 
2022-09-21 00:36:50 INFO  # Optimization benchmark for data_corruption with args [['reviews', 'slow_loading', 'featurization_2', 'xgboost']] -- repetition 7 of 7
2022-09-21 00:36:50 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-21 00:36:50 INFO  Running instrumented original pipeline...
2022-09-21 00:36:50 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-21 00:36:50 INFO  ---RUNTIME: Importing and monkey-patching took 6.299734115600586 ms
2022-09-21 00:37:10 INFO  ---RUNTIME: Original pipeline execution took 19932.977437973022 ms (excluding imports and monkey-patching)
2022-09-21 00:37:10 INFO  Starting execution of 1 what-if analyses...
2022-09-21 00:37:10 INFO  Start plan generation for analysis DataCorruption...
2022-09-21 00:37:10 INFO  ---RUNTIME: Plan generation took 0.4894733428955078 ms
2022-09-21 00:37:10 INFO  Estimated runtime of original DAG is 18710.756540298462ms
2022-09-21 00:37:10 INFO  Performing Multi-Query Optimization
2022-09-21 00:37:10 INFO  Estimated unoptimized what-if runtime is 467768.91350746155ms
2022-09-21 00:37:10 INFO  Estimated optimised what-if runtime is 28887.91823387146ms
2022-09-21 00:37:10 INFO  Estimated optimisation runtime saving is 438880.9952735901ms
2022-09-21 00:37:10 INFO  ---RUNTIME: Multi-Query Optimization took 65.84405899047852 ms
2022-09-21 00:37:10 INFO  Executing generated plans
2022-09-21 00:37:43 INFO  ---RUNTIME: Execution took 32788.76733779907 ms
2022-09-21 00:37:43 INFO  Done!
2022-09-21 00:37:43 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-21 00:37:43 INFO  Running instrumented original pipeline...
2022-09-21 00:37:43 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-21 00:37:43 INFO  ---RUNTIME: Importing and monkey-patching took 5.741119384765625 ms
2022-09-21 00:38:02 INFO  ---RUNTIME: Original pipeline execution took 19162.834405899048 ms (excluding imports and monkey-patching)
2022-09-21 00:38:02 INFO  Starting execution of 1 what-if analyses...
2022-09-21 00:38:02 INFO  Start plan generation for analysis DataCorruption...
2022-09-21 00:38:02 INFO  ---RUNTIME: Plan generation took 0.48613548278808594 ms
2022-09-21 00:38:02 INFO  Estimated runtime of original DAG is 17953.105688095093ms
2022-09-21 00:38:02 WARNING Skipping Multi-Query Optimization (instead, only combine execution DAGs)
2022-09-21 00:38:02 INFO  Estimated unoptimised what-if runtime is 448827.6422023773ms
2022-09-21 00:38:02 INFO  ---RUNTIME: Multi-Query Optimization took 170.49598693847656 ms
2022-09-21 00:38:02 INFO  Executing generated plans
2022-09-21 00:46:57 INFO  ---RUNTIME: Execution took 535084.953546524 ms
2022-09-21 00:46:57 INFO  Done!
2022-09-21 00:46:57 INFO  # Finished -- repetition 7 of 7 
2022-09-21 00:46:57 INFO  # Final results after all repetitions
2022-09-21 00:46:57 INFO     repetition  ... no_opt_what_if_execution_combined_model_training
0           0  ...                                    324044.133425
1           1  ...                                    334611.581802
2           2  ...                                    332443.821907
3           3  ...                                    338798.155785
4           4  ...                                    334661.810398
5           5  ...                                    317381.310701
6           6  ...                                    338620.414257

[7 rows x 26 columns]
taskset -c 160-168 PROTOCOL_BUFFERS_PYTHON_IMPLEMENTATION=python python3.9 benchmarks_end_to_end.py data_corruption reviews slow_loading featurization_2 neural_network
2022-09-21 00:47:00.258333: W tensorflow/stream_executor/platform/default/dso_loader.cc:64] Could not load dynamic library 'libcudart.so.11.0'; dlerror: libcudart.so.11.0: cannot open shared object file: No such file or directory; LD_LIBRARY_PATH: /home/sgrafbe/mlwhatif/venv/lib/python3.9/site-packages/cv2/../../lib64:
2022-09-21 00:47:00.258381: I tensorflow/stream_executor/cuda/cudart_stub.cc:29] Ignore above cudart dlerror if you do not have a GPU set up on your machine.
2022-09-21 00:47:01 INFO  Patching sys.argv with ['mlwhatif', 'reviews', 'slow_loading', 'featurization_2', 'neural_network']
2022-09-21 00:47:01 INFO  Running instrumented original pipeline...
2022-09-21 00:47:01 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-21 00:47:01 INFO  ---RUNTIME: Importing and monkey-patching took 180.31024932861328 ms
2022-09-21 00:47:08.402311: W tensorflow/stream_executor/platform/default/dso_loader.cc:64] Could not load dynamic library 'libcuda.so.1'; dlerror: libcuda.so.1: cannot open shared object file: No such file or directory; LD_LIBRARY_PATH: /home/sgrafbe/mlwhatif/venv/lib/python3.9/site-packages/cv2/../../lib64:
2022-09-21 00:47:08.402353: W tensorflow/stream_executor/cuda/cuda_driver.cc:326] failed call to cuInit: UNKNOWN ERROR (303)
2022-09-21 00:47:08.402382: I tensorflow/stream_executor/cuda/cuda_diagnostics.cc:156] kernel driver does not appear to be running on this host (angus): /proc/driver/nvidia/version does not exist
2022-09-21 00:47:08.402894: I tensorflow/core/platform/cpu_feature_guard.cc:142] This TensorFlow binary is optimized with oneAPI Deep Neural Network Library (oneDNN) to use the following CPU instructions in performance-critical operations:  AVX2 FMA
To enable them in other operations, rebuild TensorFlow with the appropriate compiler flags.
2022-09-21 00:47:09.068831: I tensorflow/compiler/mlir/mlir_graph_optimization_pass.cc:176] None of the MLIR Optimization Passes are enabled (registered 2)
2022-09-21 00:47:09.083198: I tensorflow/core/platform/profile_utils/cpu_utils.cc:114] CPU Frequency: 2595130000 Hz
2022-09-21 00:47:18 INFO  ---RUNTIME: Original pipeline execution took 16665.73977470398 ms (excluding imports and monkey-patching)
2022-09-21 00:47:18 INFO  Starting execution of 0 what-if analyses...
2022-09-21 00:47:18 INFO  Estimated runtime of original DAG is 15387.987852096558ms
2022-09-21 00:47:18 INFO  Performing Multi-Query Optimization
2022-09-21 00:47:18 INFO  Estimated unoptimized what-if runtime is 0ms
2022-09-21 00:47:18 INFO  Estimated optimised what-if runtime is 0ms
2022-09-21 00:47:18 INFO  Estimated optimisation runtime saving is 0ms
2022-09-21 00:47:18 INFO  ---RUNTIME: Multi-Query Optimization took 0.6616115570068359 ms
2022-09-21 00:47:18 INFO  Executing generated plans
2022-09-21 00:47:18 INFO  ---RUNTIME: Execution took 0.027894973754882812 ms
2022-09-21 00:47:18 INFO  Done!
2022-09-21 00:47:18 INFO  # Optimization benchmark for data_corruption with args [['reviews', 'slow_loading', 'featurization_2', 'neural_network']] -- repetition 1 of 7
2022-09-21 00:47:18 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-21 00:47:18 INFO  Running instrumented original pipeline...
2022-09-21 00:47:18 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-21 00:47:18 INFO  ---RUNTIME: Importing and monkey-patching took 6.256103515625 ms
2022-09-21 00:47:35 INFO  ---RUNTIME: Original pipeline execution took 16609.85279083252 ms (excluding imports and monkey-patching)
2022-09-21 00:47:35 INFO  Starting execution of 1 what-if analyses...
2022-09-21 00:47:35 INFO  Start plan generation for analysis DataCorruption...
2022-09-21 00:47:35 INFO  ---RUNTIME: Plan generation took 0.6473064422607422 ms
2022-09-21 00:47:35 INFO  Estimated runtime of original DAG is 14938.034772872925ms
2022-09-21 00:47:35 INFO  Performing Multi-Query Optimization
2022-09-21 00:47:35 INFO  Estimated unoptimized what-if runtime is 373450.8693218231ms
2022-09-21 00:47:35 INFO  Estimated optimised what-if runtime is 50167.97137260437ms
2022-09-21 00:47:35 INFO  Estimated optimisation runtime saving is 323282.89794921875ms
2022-09-21 00:47:35 INFO  ---RUNTIME: Multi-Query Optimization took 92.37027168273926 ms
2022-09-21 00:47:35 INFO  Executing generated plans
2022-09-21 00:48:28 INFO  ---RUNTIME: Execution took 53768.83125305176 ms
2022-09-21 00:48:28 INFO  Done!
2022-09-21 00:48:28 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-21 00:48:28 INFO  Running instrumented original pipeline...
2022-09-21 00:48:29 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-21 00:48:29 INFO  ---RUNTIME: Importing and monkey-patching took 8.408308029174805 ms
2022-09-21 00:48:47 INFO  ---RUNTIME: Original pipeline execution took 18393.971920013428 ms (excluding imports and monkey-patching)
2022-09-21 00:48:47 INFO  Starting execution of 1 what-if analyses...
2022-09-21 00:48:47 INFO  Start plan generation for analysis DataCorruption...
2022-09-21 00:48:47 INFO  ---RUNTIME: Plan generation took 2.1173954010009766 ms
2022-09-21 00:48:47 INFO  Estimated runtime of original DAG is 16567.331790924072ms
2022-09-21 00:48:47 WARNING Skipping Multi-Query Optimization (instead, only combine execution DAGs)
2022-09-21 00:48:47 INFO  Estimated unoptimised what-if runtime is 414183.2947731018ms
2022-09-21 00:48:47 INFO  ---RUNTIME: Multi-Query Optimization took 208.48417282104492 ms
2022-09-21 00:48:47 INFO  Executing generated plans
2022-09-21 00:55:25 INFO  ---RUNTIME: Execution took 397874.13334846497 ms
2022-09-21 00:55:25 INFO  Done!
2022-09-21 00:55:25 INFO  # Finished -- repetition 1 of 7 
2022-09-21 00:55:25 INFO  # Optimization benchmark for data_corruption with args [['reviews', 'slow_loading', 'featurization_2', 'neural_network']] -- repetition 2 of 7
2022-09-21 00:55:25 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-21 00:55:25 INFO  Running instrumented original pipeline...
2022-09-21 00:55:27 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-21 00:55:27 INFO  ---RUNTIME: Importing and monkey-patching took 8.363008499145508 ms
2022-09-21 00:55:46 INFO  ---RUNTIME: Original pipeline execution took 21056.169033050537 ms (excluding imports and monkey-patching)
2022-09-21 00:55:46 INFO  Starting execution of 1 what-if analyses...
2022-09-21 00:55:46 INFO  Start plan generation for analysis DataCorruption...
2022-09-21 00:55:46 INFO  ---RUNTIME: Plan generation took 0.4773139953613281 ms
2022-09-21 00:55:46 INFO  Estimated runtime of original DAG is 18279.28137779236ms
2022-09-21 00:55:46 INFO  Performing Multi-Query Optimization
2022-09-21 00:55:46 INFO  Estimated unoptimized what-if runtime is 456982.03444480896ms
2022-09-21 00:55:46 INFO  Estimated optimised what-if runtime is 47410.775899887085ms
2022-09-21 00:55:46 INFO  Estimated optimisation runtime saving is 409571.2585449219ms
2022-09-21 00:55:46 INFO  ---RUNTIME: Multi-Query Optimization took 65.67263603210449 ms
2022-09-21 00:55:46 INFO  Executing generated plans
2022-09-21 00:56:37 INFO  ---RUNTIME: Execution took 50636.319637298584 ms
2022-09-21 00:56:37 INFO  Done!
2022-09-21 00:56:37 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-21 00:56:37 INFO  Running instrumented original pipeline...
2022-09-21 00:56:37 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-21 00:56:37 INFO  ---RUNTIME: Importing and monkey-patching took 6.60252571105957 ms
2022-09-21 00:56:54 INFO  ---RUNTIME: Original pipeline execution took 17387.866497039795 ms (excluding imports and monkey-patching)
2022-09-21 00:56:54 INFO  Starting execution of 1 what-if analyses...
2022-09-21 00:56:54 INFO  Start plan generation for analysis DataCorruption...
2022-09-21 00:56:54 INFO  ---RUNTIME: Plan generation took 1.5096664428710938 ms
2022-09-21 00:56:54 INFO  Estimated runtime of original DAG is 16139.229774475098ms
2022-09-21 00:56:54 WARNING Skipping Multi-Query Optimization (instead, only combine execution DAGs)
2022-09-21 00:56:54 INFO  Estimated unoptimised what-if runtime is 403480.74436187744ms
2022-09-21 00:56:54 INFO  ---RUNTIME: Multi-Query Optimization took 146.03471755981445 ms
2022-09-21 00:56:54 INFO  Executing generated plans
2022-09-21 01:04:12 INFO  ---RUNTIME: Execution took 437882.4334144592 ms
2022-09-21 01:04:12 INFO  Done!
2022-09-21 01:04:12 INFO  # Finished -- repetition 2 of 7 
2022-09-21 01:04:12 INFO  # Optimization benchmark for data_corruption with args [['reviews', 'slow_loading', 'featurization_2', 'neural_network']] -- repetition 3 of 7
2022-09-21 01:04:12 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-21 01:04:12 INFO  Running instrumented original pipeline...
2022-09-21 01:04:12 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-21 01:04:12 INFO  ---RUNTIME: Importing and monkey-patching took 6.080389022827148 ms
2022-09-21 01:04:29 INFO  ---RUNTIME: Original pipeline execution took 16871.22416496277 ms (excluding imports and monkey-patching)
2022-09-21 01:04:29 INFO  Starting execution of 1 what-if analyses...
2022-09-21 01:04:29 INFO  Start plan generation for analysis DataCorruption...
2022-09-21 01:04:29 INFO  ---RUNTIME: Plan generation took 1.4002323150634766 ms
2022-09-21 01:04:29 INFO  Estimated runtime of original DAG is 15599.525690078735ms
2022-09-21 01:04:29 INFO  Performing Multi-Query Optimization
2022-09-21 01:04:29 INFO  Estimated unoptimized what-if runtime is 389988.1422519684ms
2022-09-21 01:04:29 INFO  Estimated optimised what-if runtime is 45591.15242958069ms
2022-09-21 01:04:29 INFO  Estimated optimisation runtime saving is 344396.9898223877ms
2022-09-21 01:04:29 INFO  ---RUNTIME: Multi-Query Optimization took 65.47236442565918 ms
2022-09-21 01:04:29 INFO  Executing generated plans
2022-09-21 01:05:15 INFO  ---RUNTIME: Execution took 46135.0302696228 ms
2022-09-21 01:05:15 INFO  Done!
2022-09-21 01:05:15 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-21 01:05:15 INFO  Running instrumented original pipeline...
2022-09-21 01:05:15 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-21 01:05:15 INFO  ---RUNTIME: Importing and monkey-patching took 6.374835968017578 ms
2022-09-21 01:05:32 INFO  ---RUNTIME: Original pipeline execution took 16379.972219467163 ms (excluding imports and monkey-patching)
2022-09-21 01:05:32 INFO  Starting execution of 1 what-if analyses...
2022-09-21 01:05:32 INFO  Start plan generation for analysis DataCorruption...
2022-09-21 01:05:32 INFO  ---RUNTIME: Plan generation took 0.4582405090332031 ms
2022-09-21 01:05:32 INFO  Estimated runtime of original DAG is 15128.58772277832ms
2022-09-21 01:05:32 WARNING Skipping Multi-Query Optimization (instead, only combine execution DAGs)
2022-09-21 01:05:32 INFO  Estimated unoptimised what-if runtime is 378214.693069458ms
2022-09-21 01:05:32 INFO  ---RUNTIME: Multi-Query Optimization took 146.95143699645996 ms
2022-09-21 01:05:32 INFO  Executing generated plans
2022-09-21 01:12:20 INFO  ---RUNTIME: Execution took 408504.4684410095 ms
2022-09-21 01:12:20 INFO  Done!
2022-09-21 01:12:20 INFO  # Finished -- repetition 3 of 7 
2022-09-21 01:12:20 INFO  # Optimization benchmark for data_corruption with args [['reviews', 'slow_loading', 'featurization_2', 'neural_network']] -- repetition 4 of 7
2022-09-21 01:12:20 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-21 01:12:20 INFO  Running instrumented original pipeline...
2022-09-21 01:12:20 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-21 01:12:20 INFO  ---RUNTIME: Importing and monkey-patching took 6.690025329589844 ms
2022-09-21 01:12:39 INFO  ---RUNTIME: Original pipeline execution took 18831.724882125854 ms (excluding imports and monkey-patching)
2022-09-21 01:12:39 INFO  Starting execution of 1 what-if analyses...
2022-09-21 01:12:39 INFO  Start plan generation for analysis DataCorruption...
2022-09-21 01:12:39 INFO  ---RUNTIME: Plan generation took 0.4336833953857422 ms
2022-09-21 01:12:39 INFO  Estimated runtime of original DAG is 17557.77359008789ms
2022-09-21 01:12:39 INFO  Performing Multi-Query Optimization
2022-09-21 01:12:39 INFO  Estimated unoptimized what-if runtime is 438944.33975219727ms
2022-09-21 01:12:39 INFO  Estimated optimised what-if runtime is 55167.94466972351ms
2022-09-21 01:12:39 INFO  Estimated optimisation runtime saving is 383776.39508247375ms
2022-09-21 01:12:39 INFO  ---RUNTIME: Multi-Query Optimization took 67.05856323242188 ms
2022-09-21 01:12:39 INFO  Executing generated plans
2022-09-21 01:13:35 INFO  ---RUNTIME: Execution took 55918.68805885315 ms
2022-09-21 01:13:35 INFO  Done!
2022-09-21 01:13:35 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-21 01:13:35 INFO  Running instrumented original pipeline...
2022-09-21 01:13:35 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-21 01:13:35 INFO  ---RUNTIME: Importing and monkey-patching took 6.278038024902344 ms
2022-09-21 01:13:52 INFO  ---RUNTIME: Original pipeline execution took 16691.202640533447 ms (excluding imports and monkey-patching)
2022-09-21 01:13:52 INFO  Starting execution of 1 what-if analyses...
2022-09-21 01:13:52 INFO  Start plan generation for analysis DataCorruption...
2022-09-21 01:13:52 INFO  ---RUNTIME: Plan generation took 0.4284381866455078 ms
2022-09-21 01:13:52 INFO  Estimated runtime of original DAG is 15368.503332138062ms
2022-09-21 01:13:52 WARNING Skipping Multi-Query Optimization (instead, only combine execution DAGs)
2022-09-21 01:13:52 INFO  Estimated unoptimised what-if runtime is 384212.58330345154ms
2022-09-21 01:13:52 INFO  ---RUNTIME: Multi-Query Optimization took 151.52788162231445 ms
2022-09-21 01:13:52 INFO  Executing generated plans
2022-09-21 01:20:44 INFO  ---RUNTIME: Execution took 412041.9645309448 ms
2022-09-21 01:20:44 INFO  Done!
2022-09-21 01:20:44 INFO  # Finished -- repetition 4 of 7 
2022-09-21 01:20:44 INFO  # Optimization benchmark for data_corruption with args [['reviews', 'slow_loading', 'featurization_2', 'neural_network']] -- repetition 5 of 7
2022-09-21 01:20:44 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-21 01:20:44 INFO  Running instrumented original pipeline...
2022-09-21 01:20:44 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-21 01:20:44 INFO  ---RUNTIME: Importing and monkey-patching took 5.899906158447266 ms
2022-09-21 01:20:59 INFO  ---RUNTIME: Original pipeline execution took 14908.43415260315 ms (excluding imports and monkey-patching)
2022-09-21 01:20:59 INFO  Starting execution of 1 what-if analyses...
2022-09-21 01:20:59 INFO  Start plan generation for analysis DataCorruption...
2022-09-21 01:20:59 INFO  ---RUNTIME: Plan generation took 0.4055500030517578 ms
2022-09-21 01:20:59 INFO  Estimated runtime of original DAG is 13693.032264709473ms
2022-09-21 01:20:59 INFO  Performing Multi-Query Optimization
2022-09-21 01:20:59 INFO  Estimated unoptimized what-if runtime is 342325.8066177368ms
2022-09-21 01:20:59 INFO  Estimated optimised what-if runtime is 39609.73024368286ms
2022-09-21 01:20:59 INFO  Estimated optimisation runtime saving is 302716.07637405396ms
2022-09-21 01:20:59 INFO  ---RUNTIME: Multi-Query Optimization took 65.75369834899902 ms
2022-09-21 01:20:59 INFO  Executing generated plans
2022-09-21 01:21:43 INFO  ---RUNTIME: Execution took 43732.0761680603 ms
2022-09-21 01:21:43 INFO  Done!
2022-09-21 01:21:43 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-21 01:21:43 INFO  Running instrumented original pipeline...
2022-09-21 01:21:43 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-21 01:21:43 INFO  ---RUNTIME: Importing and monkey-patching took 6.317853927612305 ms
2022-09-21 01:21:57 INFO  ---RUNTIME: Original pipeline execution took 14365.08846282959 ms (excluding imports and monkey-patching)
2022-09-21 01:21:57 INFO  Starting execution of 1 what-if analyses...
2022-09-21 01:21:57 INFO  Start plan generation for analysis DataCorruption...
2022-09-21 01:21:57 INFO  ---RUNTIME: Plan generation took 1.3909339904785156 ms
2022-09-21 01:21:57 INFO  Estimated runtime of original DAG is 13149.828433990479ms
2022-09-21 01:21:57 WARNING Skipping Multi-Query Optimization (instead, only combine execution DAGs)
2022-09-21 01:21:57 INFO  Estimated unoptimised what-if runtime is 328745.71084976196ms
2022-09-21 01:21:57 INFO  ---RUNTIME: Multi-Query Optimization took 147.05991744995117 ms
2022-09-21 01:21:57 INFO  Executing generated plans
2022-09-21 01:29:03 INFO  ---RUNTIME: Execution took 425682.49559402466 ms
2022-09-21 01:29:03 INFO  Done!
2022-09-21 01:29:03 INFO  # Finished -- repetition 5 of 7 
2022-09-21 01:29:03 INFO  # Optimization benchmark for data_corruption with args [['reviews', 'slow_loading', 'featurization_2', 'neural_network']] -- repetition 6 of 7
2022-09-21 01:29:03 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-21 01:29:03 INFO  Running instrumented original pipeline...
2022-09-21 01:29:03 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-21 01:29:03 INFO  ---RUNTIME: Importing and monkey-patching took 7.647037506103516 ms
2022-09-21 01:29:21 INFO  ---RUNTIME: Original pipeline execution took 17567.390203475952 ms (excluding imports and monkey-patching)
2022-09-21 01:29:21 INFO  Starting execution of 1 what-if analyses...
2022-09-21 01:29:21 INFO  Start plan generation for analysis DataCorruption...
2022-09-21 01:29:21 INFO  ---RUNTIME: Plan generation took 0.41675567626953125 ms
2022-09-21 01:29:21 INFO  Estimated runtime of original DAG is 16238.328218460083ms
2022-09-21 01:29:21 INFO  Performing Multi-Query Optimization
2022-09-21 01:29:22 INFO  Estimated unoptimized what-if runtime is 405958.2054615021ms
2022-09-21 01:29:22 INFO  Estimated optimised what-if runtime is 47139.304637908936ms
2022-09-21 01:29:22 INFO  Estimated optimisation runtime saving is 358818.90082359314ms
2022-09-21 01:29:22 INFO  ---RUNTIME: Multi-Query Optimization took 1130.6142807006836 ms
2022-09-21 01:29:22 INFO  Executing generated plans
2022-09-21 01:30:18 INFO  ---RUNTIME: Execution took 56223.91867637634 ms
2022-09-21 01:30:18 INFO  Done!
2022-09-21 01:30:18 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-21 01:30:18 INFO  Running instrumented original pipeline...
2022-09-21 01:30:18 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-21 01:30:18 INFO  ---RUNTIME: Importing and monkey-patching took 6.475210189819336 ms
2022-09-21 01:30:35 INFO  ---RUNTIME: Original pipeline execution took 16745.96071243286 ms (excluding imports and monkey-patching)
2022-09-21 01:30:35 INFO  Starting execution of 1 what-if analyses...
2022-09-21 01:30:35 INFO  Start plan generation for analysis DataCorruption...
2022-09-21 01:30:35 INFO  ---RUNTIME: Plan generation took 0.6194114685058594 ms
2022-09-21 01:30:35 INFO  Estimated runtime of original DAG is 15449.764251708984ms
2022-09-21 01:30:35 WARNING Skipping Multi-Query Optimization (instead, only combine execution DAGs)
2022-09-21 01:30:35 INFO  Estimated unoptimised what-if runtime is 386244.1062927246ms
2022-09-21 01:30:35 INFO  ---RUNTIME: Multi-Query Optimization took 251.62935256958008 ms
2022-09-21 01:30:35 INFO  Executing generated plans
2022-09-21 01:37:02 INFO  ---RUNTIME: Execution took 387008.0695152283 ms
2022-09-21 01:37:02 INFO  Done!
2022-09-21 01:37:02 INFO  # Finished -- repetition 6 of 7 
2022-09-21 01:37:02 INFO  # Optimization benchmark for data_corruption with args [['reviews', 'slow_loading', 'featurization_2', 'neural_network']] -- repetition 7 of 7
2022-09-21 01:37:02 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-21 01:37:02 INFO  Running instrumented original pipeline...
2022-09-21 01:37:02 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-21 01:37:02 INFO  ---RUNTIME: Importing and monkey-patching took 6.11424446105957 ms
2022-09-21 01:37:17 INFO  ---RUNTIME: Original pipeline execution took 14966.025829315186 ms (excluding imports and monkey-patching)
2022-09-21 01:37:17 INFO  Starting execution of 1 what-if analyses...
2022-09-21 01:37:17 INFO  Start plan generation for analysis DataCorruption...
2022-09-21 01:37:17 INFO  ---RUNTIME: Plan generation took 0.42366981506347656 ms
2022-09-21 01:37:17 INFO  Estimated runtime of original DAG is 13734.92455482483ms
2022-09-21 01:37:17 INFO  Performing Multi-Query Optimization
2022-09-21 01:37:17 INFO  Estimated unoptimized what-if runtime is 343373.1138706207ms
2022-09-21 01:37:17 INFO  Estimated optimised what-if runtime is 39628.98063659668ms
2022-09-21 01:37:17 INFO  Estimated optimisation runtime saving is 303744.13323402405ms
2022-09-21 01:37:17 INFO  ---RUNTIME: Multi-Query Optimization took 65.49072265625 ms
2022-09-21 01:37:17 INFO  Executing generated plans
2022-09-21 01:38:01 INFO  ---RUNTIME: Execution took 44231.258153915405 ms
2022-09-21 01:38:01 INFO  Done!
2022-09-21 01:38:01 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-21 01:38:01 INFO  Running instrumented original pipeline...
2022-09-21 01:38:01 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-21 01:38:01 INFO  ---RUNTIME: Importing and monkey-patching took 6.142377853393555 ms
2022-09-21 01:38:18 INFO  ---RUNTIME: Original pipeline execution took 16807.288885116577 ms (excluding imports and monkey-patching)
2022-09-21 01:38:18 INFO  Starting execution of 1 what-if analyses...
2022-09-21 01:38:18 INFO  Start plan generation for analysis DataCorruption...
2022-09-21 01:38:18 INFO  ---RUNTIME: Plan generation took 0.453948974609375 ms
2022-09-21 01:38:18 INFO  Estimated runtime of original DAG is 15305.490732192993ms
2022-09-21 01:38:18 WARNING Skipping Multi-Query Optimization (instead, only combine execution DAGs)
2022-09-21 01:38:18 INFO  Estimated unoptimised what-if runtime is 382637.2683048248ms
2022-09-21 01:38:18 INFO  ---RUNTIME: Multi-Query Optimization took 142.14110374450684 ms
2022-09-21 01:38:18 INFO  Executing generated plans
2022-09-21 01:45:20 INFO  ---RUNTIME: Execution took 421923.8259792328 ms
2022-09-21 01:45:20 INFO  Done!
2022-09-21 01:45:20 INFO  # Finished -- repetition 7 of 7 
2022-09-21 01:45:20 INFO  # Final results after all repetitions
2022-09-21 01:45:20 INFO     repetition  ... no_opt_what_if_execution_combined_model_training
0           0  ...                                    165394.945621
1           1  ...                                    208437.901974
2           2  ...                                    195008.457184
3           3  ...                                    194459.767580
4           4  ...                                    213326.455355
5           5  ...                                    165688.155890
6           6  ...                                    203121.911049

[7 rows x 26 columns]
taskset -c 160-168 PROTOCOL_BUFFERS_PYTHON_IMPLEMENTATION=python python3.9 benchmarks_end_to_end.py data_corruption reviews slow_loading featurization_3 logistic_regression
2022-09-21 01:45:25.056273: W tensorflow/stream_executor/platform/default/dso_loader.cc:64] Could not load dynamic library 'libcudart.so.11.0'; dlerror: libcudart.so.11.0: cannot open shared object file: No such file or directory; LD_LIBRARY_PATH: /home/sgrafbe/mlwhatif/venv/lib/python3.9/site-packages/cv2/../../lib64:
2022-09-21 01:45:25.056325: I tensorflow/stream_executor/cuda/cudart_stub.cc:29] Ignore above cudart dlerror if you do not have a GPU set up on your machine.
2022-09-21 01:45:27 INFO  Patching sys.argv with ['mlwhatif', 'reviews', 'slow_loading', 'featurization_3', 'logistic_regression']
2022-09-21 01:45:27 INFO  Running instrumented original pipeline...
2022-09-21 01:45:27 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-21 01:45:27 INFO  ---RUNTIME: Importing and monkey-patching took 212.30816841125488 ms
2022-09-21 01:46:24 INFO  ---RUNTIME: Original pipeline execution took 56612.783908843994 ms (excluding imports and monkey-patching)
2022-09-21 01:46:24 INFO  Starting execution of 0 what-if analyses...
2022-09-21 01:46:24 INFO  Estimated runtime of original DAG is 46134.56153869629ms
2022-09-21 01:46:24 INFO  Performing Multi-Query Optimization
2022-09-21 01:46:24 INFO  Estimated unoptimized what-if runtime is 0ms
2022-09-21 01:46:24 INFO  Estimated optimised what-if runtime is 0ms
2022-09-21 01:46:24 INFO  Estimated optimisation runtime saving is 0ms
2022-09-21 01:46:24 INFO  ---RUNTIME: Multi-Query Optimization took 0.8215904235839844 ms
2022-09-21 01:46:24 INFO  Executing generated plans
2022-09-21 01:46:24 INFO  ---RUNTIME: Execution took 0.0324249267578125 ms
2022-09-21 01:46:24 INFO  Done!
2022-09-21 01:46:24 INFO  # Optimization benchmark for data_corruption with args [['reviews', 'slow_loading', 'featurization_3', 'logistic_regression']] -- repetition 1 of 7
2022-09-21 01:46:24 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-21 01:46:24 INFO  Running instrumented original pipeline...
2022-09-21 01:46:24 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-21 01:46:24 INFO  ---RUNTIME: Importing and monkey-patching took 9.893655776977539 ms
2022-09-21 01:47:08 INFO  ---RUNTIME: Original pipeline execution took 44598.47974777222 ms (excluding imports and monkey-patching)
2022-09-21 01:47:08 INFO  Starting execution of 1 what-if analyses...
2022-09-21 01:47:08 INFO  Start plan generation for analysis DataCorruption...
2022-09-21 01:47:08 INFO  ---RUNTIME: Plan generation took 0.42366981506347656 ms
2022-09-21 01:47:08 INFO  Estimated runtime of original DAG is 36397.408962249756ms
2022-09-21 01:47:08 INFO  Performing Multi-Query Optimization
2022-09-21 01:47:08 INFO  Estimated unoptimized what-if runtime is 909935.2240562439ms
2022-09-21 01:47:08 INFO  Estimated optimised what-if runtime is 122269.33360099792ms
2022-09-21 01:47:08 INFO  Estimated optimisation runtime saving is 787665.890455246ms
2022-09-21 01:47:08 INFO  ---RUNTIME: Multi-Query Optimization took 78.6745548248291 ms
2022-09-21 01:47:08 INFO  Executing generated plans
2022-09-21 01:48:09 INFO  ---RUNTIME: Execution took 60954.134941101074 ms
2022-09-21 01:48:09 INFO  Done!
2022-09-21 01:48:09 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-21 01:48:09 INFO  Running instrumented original pipeline...
2022-09-21 01:48:09 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-21 01:48:09 INFO  ---RUNTIME: Importing and monkey-patching took 6.847143173217773 ms
2022-09-21 01:49:00 INFO  ---RUNTIME: Original pipeline execution took 51069.44155693054 ms (excluding imports and monkey-patching)
2022-09-21 01:49:00 INFO  Starting execution of 1 what-if analyses...
2022-09-21 01:49:00 INFO  Start plan generation for analysis DataCorruption...
2022-09-21 01:49:00 INFO  ---RUNTIME: Plan generation took 0.47397613525390625 ms
2022-09-21 01:49:00 INFO  Estimated runtime of original DAG is 40860.225677490234ms
2022-09-21 01:49:00 WARNING Skipping Multi-Query Optimization (instead, only combine execution DAGs)
2022-09-21 01:49:01 INFO  Estimated unoptimised what-if runtime is 1021505.6419372559ms
2022-09-21 01:49:01 INFO  ---RUNTIME: Multi-Query Optimization took 175.99129676818848 ms
2022-09-21 01:49:01 INFO  Executing generated plans
2022-09-21 02:05:38 INFO  ---RUNTIME: Execution took 997523.8494873047 ms
2022-09-21 02:05:38 INFO  Done!
2022-09-21 02:05:38 INFO  # Finished -- repetition 1 of 7 
2022-09-21 02:05:38 INFO  # Optimization benchmark for data_corruption with args [['reviews', 'slow_loading', 'featurization_3', 'logistic_regression']] -- repetition 2 of 7
2022-09-21 02:05:38 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-21 02:05:38 INFO  Running instrumented original pipeline...
2022-09-21 02:05:38 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-21 02:05:38 INFO  ---RUNTIME: Importing and monkey-patching took 97.88155555725098 ms
2022-09-21 02:06:31 INFO  ---RUNTIME: Original pipeline execution took 52765.740633010864 ms (excluding imports and monkey-patching)
2022-09-21 02:06:31 INFO  Starting execution of 1 what-if analyses...
2022-09-21 02:06:31 INFO  Start plan generation for analysis DataCorruption...
2022-09-21 02:06:31 INFO  ---RUNTIME: Plan generation took 0.5514621734619141 ms
2022-09-21 02:06:31 INFO  Estimated runtime of original DAG is 35048.503160476685ms
2022-09-21 02:06:31 INFO  Performing Multi-Query Optimization
2022-09-21 02:06:31 INFO  Estimated unoptimized what-if runtime is 876212.5790119171ms
2022-09-21 02:06:31 INFO  Estimated optimised what-if runtime is 118376.14607810974ms
2022-09-21 02:06:31 INFO  Estimated optimisation runtime saving is 757836.4329338074ms
2022-09-21 02:06:31 INFO  ---RUNTIME: Multi-Query Optimization took 79.24199104309082 ms
2022-09-21 02:06:31 INFO  Executing generated plans
2022-09-21 02:07:31 INFO  ---RUNTIME: Execution took 59784.35921669006 ms
2022-09-21 02:07:31 INFO  Done!
2022-09-21 02:07:31 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-21 02:07:31 INFO  Running instrumented original pipeline...
2022-09-21 02:07:31 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-21 02:07:31 INFO  ---RUNTIME: Importing and monkey-patching took 6.548404693603516 ms
2022-09-21 02:08:13 INFO  ---RUNTIME: Original pipeline execution took 41739.744901657104 ms (excluding imports and monkey-patching)
2022-09-21 02:08:13 INFO  Starting execution of 1 what-if analyses...
2022-09-21 02:08:13 INFO  Start plan generation for analysis DataCorruption...
2022-09-21 02:08:13 INFO  ---RUNTIME: Plan generation took 0.5662441253662109 ms
2022-09-21 02:08:13 INFO  Estimated runtime of original DAG is 33459.17630195618ms
2022-09-21 02:08:13 WARNING Skipping Multi-Query Optimization (instead, only combine execution DAGs)
2022-09-21 02:08:13 INFO  Estimated unoptimised what-if runtime is 836479.4075489044ms
2022-09-21 02:08:13 INFO  ---RUNTIME: Multi-Query Optimization took 179.55327033996582 ms
2022-09-21 02:08:13 INFO  Executing generated plans
Traceback (most recent call last):
  File "/home/sgrafbe/mlwhatif/experiments/end_to_end/benchmarks_end_to_end.py", line 238, in <module>
    analysis_result_no_opt = PipelineAnalyzer \
  File "/home/sgrafbe/mlwhatif/mlwhatif/_pipeline_analyzer.py", line 93, in execute
    return singleton.run(notebook_path=self._notebook_path,
  File "/home/sgrafbe/mlwhatif/mlwhatif/execution/_pipeline_executor.py", line 145, in run
    self.run_what_if_analyses()
  File "/home/sgrafbe/mlwhatif/mlwhatif/execution/_pipeline_executor.py", line 173, in run_what_if_analyses
    DagExecutor(self).execute(self.analysis_results.combined_optimized_dag)
  File "/home/sgrafbe/mlwhatif/mlwhatif/execution/_dag_executor.py", line 45, in execute
    self.traverse_graph_and_process_nodes(dag, execute_node)
  File "/home/sgrafbe/mlwhatif/mlwhatif/execution/_dag_executor.py", line 57, in traverse_graph_and_process_nodes
    result_node = func(node)
  File "/home/sgrafbe/mlwhatif/mlwhatif/execution/_dag_executor.py", line 40, in execute_node
    optimizer_info, result_df = capture_optimizer_info(executable_processing_func)
  File "/home/sgrafbe/mlwhatif/mlwhatif/execution/_stat_tracking.py", line 28, in capture_optimizer_info
    result = instrumented_function_call()
  File "/home/sgrafbe/mlwhatif/mlwhatif/monkeypatching/_patch_sklearn.py", line 1729, in processing_func
    transformed_data = wrap_in_mlinspect_array_if_necessary(transformed_data)
  File "/home/sgrafbe/mlwhatif/mlwhatif/monkeypatching/_monkey_patching_utils.py", line 229, in wrap_in_mlinspect_array_if_necessary
    df_object = MlinspectNdarray(df_object)
  File "/home/sgrafbe/mlwhatif/mlwhatif/monkeypatching/_mlinspect_ndarray.py", line 16, in __new__
    obj = numpy.asarray(input_array).view(cls)
  File "/home/sgrafbe/mlwhatif/venv/lib64/python3.9/site-packages/numpy/core/_asarray.py", line 83, in asarray
    return array(a, dtype, copy=False, order=order)
numpy.core._exceptions.MemoryError: Unable to allocate 3.72 GiB for an array with shape (35312,) and data type <U28286
taskset -c 160-168 PROTOCOL_BUFFERS_PYTHON_IMPLEMENTATION=python python3.9 benchmarks_end_to_end.py data_corruption reviews slow_loading featurization_3 xgboost
2022-09-21 02:11:06.440870: W tensorflow/stream_executor/platform/default/dso_loader.cc:64] Could not load dynamic library 'libcudart.so.11.0'; dlerror: libcudart.so.11.0: cannot open shared object file: No such file or directory; LD_LIBRARY_PATH: /home/sgrafbe/mlwhatif/venv/lib/python3.9/site-packages/cv2/../../lib64:
2022-09-21 02:11:06.440911: I tensorflow/stream_executor/cuda/cudart_stub.cc:29] Ignore above cudart dlerror if you do not have a GPU set up on your machine.
2022-09-21 02:11:08 INFO  Patching sys.argv with ['mlwhatif', 'reviews', 'slow_loading', 'featurization_3', 'xgboost']
2022-09-21 02:11:08 INFO  Running instrumented original pipeline...
2022-09-21 02:11:08 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-21 02:11:08 INFO  ---RUNTIME: Importing and monkey-patching took 124.33791160583496 ms
2022-09-21 02:12:04 INFO  ---RUNTIME: Original pipeline execution took 55772.175788879395 ms (excluding imports and monkey-patching)
2022-09-21 02:12:04 INFO  Starting execution of 0 what-if analyses...
2022-09-21 02:12:04 INFO  Estimated runtime of original DAG is 48185.646295547485ms
2022-09-21 02:12:04 INFO  Performing Multi-Query Optimization
2022-09-21 02:12:04 INFO  Estimated unoptimized what-if runtime is 0ms
2022-09-21 02:12:04 INFO  Estimated optimised what-if runtime is 0ms
2022-09-21 02:12:04 INFO  Estimated optimisation runtime saving is 0ms
2022-09-21 02:12:04 INFO  ---RUNTIME: Multi-Query Optimization took 0.5855560302734375 ms
2022-09-21 02:12:04 INFO  Executing generated plans
2022-09-21 02:12:04 INFO  ---RUNTIME: Execution took 0.02384185791015625 ms
2022-09-21 02:12:04 INFO  Done!
2022-09-21 02:12:04 INFO  # Optimization benchmark for data_corruption with args [['reviews', 'slow_loading', 'featurization_3', 'xgboost']] -- repetition 1 of 7
2022-09-21 02:12:04 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-21 02:12:04 INFO  Running instrumented original pipeline...
2022-09-21 02:12:04 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-21 02:12:04 INFO  ---RUNTIME: Importing and monkey-patching took 5.791425704956055 ms
2022-09-21 02:12:56 INFO  ---RUNTIME: Original pipeline execution took 51913.15937042236 ms (excluding imports and monkey-patching)
2022-09-21 02:12:56 INFO  Starting execution of 1 what-if analyses...
2022-09-21 02:12:56 INFO  Start plan generation for analysis DataCorruption...
2022-09-21 02:12:56 INFO  ---RUNTIME: Plan generation took 0.5779266357421875 ms
2022-09-21 02:12:56 INFO  Estimated runtime of original DAG is 44508.16512107849ms
2022-09-21 02:12:56 INFO  Performing Multi-Query Optimization
2022-09-21 02:12:56 INFO  Estimated unoptimized what-if runtime is 1112704.1280269623ms
2022-09-21 02:12:56 INFO  Estimated optimised what-if runtime is 127021.7227935791ms
2022-09-21 02:12:56 INFO  Estimated optimisation runtime saving is 985682.4052333832ms
2022-09-21 02:12:56 INFO  ---RUNTIME: Multi-Query Optimization took 78.51314544677734 ms
2022-09-21 02:12:56 INFO  Executing generated plans
2022-09-21 02:13:59 INFO  ---RUNTIME: Execution took 62956.584453582764 ms
2022-09-21 02:13:59 INFO  Done!
2022-09-21 02:13:59 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-21 02:13:59 INFO  Running instrumented original pipeline...
2022-09-21 02:13:59 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-21 02:13:59 INFO  ---RUNTIME: Importing and monkey-patching took 6.258726119995117 ms
2022-09-21 02:14:52 INFO  ---RUNTIME: Original pipeline execution took 53364.44354057312 ms (excluding imports and monkey-patching)
2022-09-21 02:14:52 INFO  Starting execution of 1 what-if analyses...
2022-09-21 02:14:52 INFO  Start plan generation for analysis DataCorruption...
2022-09-21 02:14:52 INFO  ---RUNTIME: Plan generation took 0.4794597625732422 ms
2022-09-21 02:14:52 INFO  Estimated runtime of original DAG is 45258.713483810425ms
2022-09-21 02:14:52 WARNING Skipping Multi-Query Optimization (instead, only combine execution DAGs)
2022-09-21 02:14:52 INFO  Estimated unoptimised what-if runtime is 1131467.8370952606ms
2022-09-21 02:14:52 INFO  ---RUNTIME: Multi-Query Optimization took 176.64074897766113 ms
2022-09-21 02:14:52 INFO  Executing generated plans
2022-09-21 02:37:23 INFO  ---RUNTIME: Execution took 1350933.3596229553 ms
2022-09-21 02:37:23 INFO  Done!
2022-09-21 02:37:23 INFO  # Finished -- repetition 1 of 7 
2022-09-21 02:37:23 INFO  # Optimization benchmark for data_corruption with args [['reviews', 'slow_loading', 'featurization_3', 'xgboost']] -- repetition 2 of 7
2022-09-21 02:37:23 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-21 02:37:23 INFO  Running instrumented original pipeline...
2022-09-21 02:37:23 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-21 02:37:23 INFO  ---RUNTIME: Importing and monkey-patching took 81.54916763305664 ms
2022-09-21 02:38:32 INFO  ---RUNTIME: Original pipeline execution took 69071.96283340454 ms (excluding imports and monkey-patching)
2022-09-21 02:38:32 INFO  Starting execution of 1 what-if analyses...
2022-09-21 02:38:32 INFO  Start plan generation for analysis DataCorruption...
2022-09-21 02:38:32 INFO  ---RUNTIME: Plan generation took 0.5040168762207031 ms
2022-09-21 02:38:32 INFO  Estimated runtime of original DAG is 51722.2580909729ms
2022-09-21 02:38:32 INFO  Performing Multi-Query Optimization
2022-09-21 02:38:32 INFO  Estimated unoptimized what-if runtime is 1293056.4522743225ms
2022-09-21 02:38:32 INFO  Estimated optimised what-if runtime is 138034.08432006836ms
2022-09-21 02:38:32 INFO  Estimated optimisation runtime saving is 1155022.3679542542ms
2022-09-21 02:38:32 INFO  ---RUNTIME: Multi-Query Optimization took 78.5520076751709 ms
2022-09-21 02:38:32 INFO  Executing generated plans
2022-09-21 02:39:47 INFO  ---RUNTIME: Execution took 74305.94992637634 ms
2022-09-21 02:39:47 INFO  Done!
2022-09-21 02:39:47 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-21 02:39:47 INFO  Running instrumented original pipeline...
2022-09-21 02:39:47 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-21 02:39:47 INFO  ---RUNTIME: Importing and monkey-patching took 6.540060043334961 ms
2022-09-21 02:40:40 INFO  ---RUNTIME: Original pipeline execution took 53295.854330062866 ms (excluding imports and monkey-patching)
2022-09-21 02:40:40 INFO  Starting execution of 1 what-if analyses...
2022-09-21 02:40:40 INFO  Start plan generation for analysis DataCorruption...
2022-09-21 02:40:40 INFO  ---RUNTIME: Plan generation took 0.5171298980712891 ms
2022-09-21 02:40:40 INFO  Estimated runtime of original DAG is 45414.573431015015ms
2022-09-21 02:40:40 WARNING Skipping Multi-Query Optimization (instead, only combine execution DAGs)
2022-09-21 02:40:40 INFO  Estimated unoptimised what-if runtime is 1135364.3357753754ms
2022-09-21 02:40:40 INFO  ---RUNTIME: Multi-Query Optimization took 175.13728141784668 ms
2022-09-21 02:40:40 INFO  Executing generated plans
Traceback (most recent call last):
  File "/home/sgrafbe/mlwhatif/experiments/end_to_end/benchmarks_end_to_end.py", line 238, in <module>
    analysis_result_no_opt = PipelineAnalyzer \
  File "/home/sgrafbe/mlwhatif/mlwhatif/_pipeline_analyzer.py", line 93, in execute
    return singleton.run(notebook_path=self._notebook_path,
  File "/home/sgrafbe/mlwhatif/mlwhatif/execution/_pipeline_executor.py", line 145, in run
    self.run_what_if_analyses()
  File "/home/sgrafbe/mlwhatif/mlwhatif/execution/_pipeline_executor.py", line 173, in run_what_if_analyses
    DagExecutor(self).execute(self.analysis_results.combined_optimized_dag)
  File "/home/sgrafbe/mlwhatif/mlwhatif/execution/_dag_executor.py", line 45, in execute
    self.traverse_graph_and_process_nodes(dag, execute_node)
  File "/home/sgrafbe/mlwhatif/mlwhatif/execution/_dag_executor.py", line 57, in traverse_graph_and_process_nodes
    result_node = func(node)
  File "/home/sgrafbe/mlwhatif/mlwhatif/execution/_dag_executor.py", line 40, in execute_node
    optimizer_info, result_df = capture_optimizer_info(executable_processing_func)
  File "/home/sgrafbe/mlwhatif/mlwhatif/execution/_stat_tracking.py", line 28, in capture_optimizer_info
    result = instrumented_function_call()
  File "/home/sgrafbe/mlwhatif/mlwhatif/monkeypatching/_patch_sklearn.py", line 1726, in processing_func
    input_df_copy = input_df.copy()
numpy.core._exceptions.MemoryError: Unable to allocate 3.89 GiB for an array with shape (35312,) and data type <U29600
taskset -c 160-168 PROTOCOL_BUFFERS_PYTHON_IMPLEMENTATION=python python3.9 benchmarks_end_to_end.py data_corruption reviews slow_loading featurization_3 neural_network
2022-09-21 02:43:20.158997: W tensorflow/stream_executor/platform/default/dso_loader.cc:64] Could not load dynamic library 'libcudart.so.11.0'; dlerror: libcudart.so.11.0: cannot open shared object file: No such file or directory; LD_LIBRARY_PATH: /home/sgrafbe/mlwhatif/venv/lib/python3.9/site-packages/cv2/../../lib64:
2022-09-21 02:43:20.159048: I tensorflow/stream_executor/cuda/cudart_stub.cc:29] Ignore above cudart dlerror if you do not have a GPU set up on your machine.
2022-09-21 02:43:21 INFO  Patching sys.argv with ['mlwhatif', 'reviews', 'slow_loading', 'featurization_3', 'neural_network']
2022-09-21 02:43:21 INFO  Running instrumented original pipeline...
2022-09-21 02:43:21 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-21 02:43:21 INFO  ---RUNTIME: Importing and monkey-patching took 122.82514572143555 ms
2022-09-21 02:43:44.165369: W tensorflow/stream_executor/platform/default/dso_loader.cc:64] Could not load dynamic library 'libcuda.so.1'; dlerror: libcuda.so.1: cannot open shared object file: No such file or directory; LD_LIBRARY_PATH: /home/sgrafbe/mlwhatif/venv/lib/python3.9/site-packages/cv2/../../lib64:
2022-09-21 02:43:44.165411: W tensorflow/stream_executor/cuda/cuda_driver.cc:326] failed call to cuInit: UNKNOWN ERROR (303)
2022-09-21 02:43:44.165434: I tensorflow/stream_executor/cuda/cuda_diagnostics.cc:156] kernel driver does not appear to be running on this host (angus): /proc/driver/nvidia/version does not exist
2022-09-21 02:43:44.165928: I tensorflow/core/platform/cpu_feature_guard.cc:142] This TensorFlow binary is optimized with oneAPI Deep Neural Network Library (oneDNN) to use the following CPU instructions in performance-critical operations:  AVX2 FMA
To enable them in other operations, rebuild TensorFlow with the appropriate compiler flags.
2022-09-21 02:43:44.777686: I tensorflow/compiler/mlir/mlir_graph_optimization_pass.cc:176] None of the MLIR Optimization Passes are enabled (registered 2)
2022-09-21 02:43:44.791226: I tensorflow/core/platform/profile_utils/cpu_utils.cc:114] CPU Frequency: 2595130000 Hz
2022-09-21 02:44:08 INFO  ---RUNTIME: Original pipeline execution took 47326.98178291321 ms (excluding imports and monkey-patching)
2022-09-21 02:44:08 INFO  Starting execution of 0 what-if analyses...
2022-09-21 02:44:08 INFO  Estimated runtime of original DAG is 40045.09711265564ms
2022-09-21 02:44:08 INFO  Performing Multi-Query Optimization
2022-09-21 02:44:08 INFO  Estimated unoptimized what-if runtime is 0ms
2022-09-21 02:44:08 INFO  Estimated optimised what-if runtime is 0ms
2022-09-21 02:44:08 INFO  Estimated optimisation runtime saving is 0ms
2022-09-21 02:44:08 INFO  ---RUNTIME: Multi-Query Optimization took 0.6098747253417969 ms
2022-09-21 02:44:08 INFO  Executing generated plans
2022-09-21 02:44:08 INFO  ---RUNTIME: Execution took 0.024080276489257812 ms
2022-09-21 02:44:08 INFO  Done!
2022-09-21 02:44:08 INFO  # Optimization benchmark for data_corruption with args [['reviews', 'slow_loading', 'featurization_3', 'neural_network']] -- repetition 1 of 7
2022-09-21 02:44:08 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-21 02:44:08 INFO  Running instrumented original pipeline...
2022-09-21 02:44:08 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-21 02:44:08 INFO  ---RUNTIME: Importing and monkey-patching took 5.546331405639648 ms
2022-09-21 02:44:59 INFO  ---RUNTIME: Original pipeline execution took 50358.957052230835 ms (excluding imports and monkey-patching)
2022-09-21 02:44:59 INFO  Starting execution of 1 what-if analyses...
2022-09-21 02:44:59 INFO  Start plan generation for analysis DataCorruption...
2022-09-21 02:44:59 INFO  ---RUNTIME: Plan generation took 0.4329681396484375 ms
2022-09-21 02:44:59 INFO  Estimated runtime of original DAG is 39635.38575172424ms
2022-09-21 02:44:59 INFO  Performing Multi-Query Optimization
2022-09-21 02:44:59 INFO  Estimated unoptimized what-if runtime is 990884.6437931061ms
2022-09-21 02:44:59 INFO  Estimated optimised what-if runtime is 140333.14776420593ms
2022-09-21 02:44:59 INFO  Estimated optimisation runtime saving is 850551.4960289001ms
2022-09-21 02:44:59 INFO  ---RUNTIME: Multi-Query Optimization took 78.08756828308105 ms
2022-09-21 02:44:59 INFO  Executing generated plans
2022-09-21 02:46:24 INFO  ---RUNTIME: Execution took 85201.589345932 ms
2022-09-21 02:46:24 INFO  Done!
2022-09-21 02:46:24 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-21 02:46:24 INFO  Running instrumented original pipeline...
2022-09-21 02:46:24 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-21 02:46:24 INFO  ---RUNTIME: Importing and monkey-patching took 7.014989852905273 ms
2022-09-21 02:47:21 INFO  ---RUNTIME: Original pipeline execution took 56815.02175331116 ms (excluding imports and monkey-patching)
2022-09-21 02:47:21 INFO  Starting execution of 1 what-if analyses...
2022-09-21 02:47:21 INFO  Start plan generation for analysis DataCorruption...
2022-09-21 02:47:21 INFO  ---RUNTIME: Plan generation took 0.48613548278808594 ms
2022-09-21 02:47:21 INFO  Estimated runtime of original DAG is 42341.60780906677ms
2022-09-21 02:47:21 WARNING Skipping Multi-Query Optimization (instead, only combine execution DAGs)
2022-09-21 02:47:21 INFO  Estimated unoptimised what-if runtime is 1058540.1952266693ms
2022-09-21 02:47:21 INFO  ---RUNTIME: Multi-Query Optimization took 177.2000789642334 ms
2022-09-21 02:47:21 INFO  Executing generated plans
2022-09-21 03:04:08 INFO  ---RUNTIME: Execution took 1006647.118806839 ms
2022-09-21 03:04:08 INFO  Done!
2022-09-21 03:04:08 INFO  # Finished -- repetition 1 of 7 
2022-09-21 03:04:08 INFO  # Optimization benchmark for data_corruption with args [['reviews', 'slow_loading', 'featurization_3', 'neural_network']] -- repetition 2 of 7
2022-09-21 03:04:08 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-21 03:04:08 INFO  Running instrumented original pipeline...
2022-09-21 03:04:08 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-21 03:04:08 INFO  ---RUNTIME: Importing and monkey-patching took 6.639242172241211 ms
2022-09-21 03:04:57 INFO  ---RUNTIME: Original pipeline execution took 48862.96772956848 ms (excluding imports and monkey-patching)
2022-09-21 03:04:57 INFO  Starting execution of 1 what-if analyses...
2022-09-21 03:04:57 INFO  Start plan generation for analysis DataCorruption...
2022-09-21 03:04:57 INFO  ---RUNTIME: Plan generation took 0.48995018005371094 ms
2022-09-21 03:04:57 INFO  Estimated runtime of original DAG is 41363.441944122314ms
2022-09-21 03:04:57 INFO  Performing Multi-Query Optimization
2022-09-21 03:04:57 INFO  Estimated unoptimized what-if runtime is 1034086.0486030579ms
2022-09-21 03:04:57 INFO  Estimated optimised what-if runtime is 145265.7389640808ms
2022-09-21 03:04:57 INFO  Estimated optimisation runtime saving is 888820.309638977ms
2022-09-21 03:04:57 INFO  ---RUNTIME: Multi-Query Optimization took 76.54929161071777 ms
2022-09-21 03:04:57 INFO  Executing generated plans
2022-09-21 03:06:11 INFO  ---RUNTIME: Execution took 74550.04358291626 ms
2022-09-21 03:06:11 INFO  Done!
2022-09-21 03:06:12 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-21 03:06:12 INFO  Running instrumented original pipeline...
2022-09-21 03:06:12 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-21 03:06:12 INFO  ---RUNTIME: Importing and monkey-patching took 6.320476531982422 ms
2022-09-21 03:07:01 INFO  ---RUNTIME: Original pipeline execution took 48546.59366607666 ms (excluding imports and monkey-patching)
2022-09-21 03:07:01 INFO  Starting execution of 1 what-if analyses...
2022-09-21 03:07:01 INFO  Start plan generation for analysis DataCorruption...
2022-09-21 03:07:01 INFO  ---RUNTIME: Plan generation took 0.4734992980957031 ms
2022-09-21 03:07:01 INFO  Estimated runtime of original DAG is 39692.80982017517ms
2022-09-21 03:07:01 WARNING Skipping Multi-Query Optimization (instead, only combine execution DAGs)
2022-09-21 03:07:01 INFO  Estimated unoptimised what-if runtime is 992320.2455043793ms
2022-09-21 03:07:01 INFO  ---RUNTIME: Multi-Query Optimization took 179.7645092010498 ms
2022-09-21 03:07:01 INFO  Executing generated plans
Traceback (most recent call last):
  File "/home/sgrafbe/mlwhatif/experiments/end_to_end/benchmarks_end_to_end.py", line 238, in <module>
    analysis_result_no_opt = PipelineAnalyzer \
  File "/home/sgrafbe/mlwhatif/mlwhatif/_pipeline_analyzer.py", line 93, in execute
    return singleton.run(notebook_path=self._notebook_path,
  File "/home/sgrafbe/mlwhatif/mlwhatif/execution/_pipeline_executor.py", line 145, in run
    self.run_what_if_analyses()
  File "/home/sgrafbe/mlwhatif/mlwhatif/execution/_pipeline_executor.py", line 173, in run_what_if_analyses
    DagExecutor(self).execute(self.analysis_results.combined_optimized_dag)
  File "/home/sgrafbe/mlwhatif/mlwhatif/execution/_dag_executor.py", line 45, in execute
    self.traverse_graph_and_process_nodes(dag, execute_node)
  File "/home/sgrafbe/mlwhatif/mlwhatif/execution/_dag_executor.py", line 57, in traverse_graph_and_process_nodes
    result_node = func(node)
  File "/home/sgrafbe/mlwhatif/mlwhatif/execution/_dag_executor.py", line 40, in execute_node
    optimizer_info, result_df = capture_optimizer_info(executable_processing_func)
  File "/home/sgrafbe/mlwhatif/mlwhatif/execution/_stat_tracking.py", line 28, in capture_optimizer_info
    result = instrumented_function_call()
  File "/home/sgrafbe/mlwhatif/mlwhatif/monkeypatching/_patch_sklearn.py", line 1729, in processing_func
    transformed_data = wrap_in_mlinspect_array_if_necessary(transformed_data)
  File "/home/sgrafbe/mlwhatif/mlwhatif/monkeypatching/_monkey_patching_utils.py", line 229, in wrap_in_mlinspect_array_if_necessary
    df_object = MlinspectNdarray(df_object)
  File "/home/sgrafbe/mlwhatif/mlwhatif/monkeypatching/_mlinspect_ndarray.py", line 16, in __new__
    obj = numpy.asarray(input_array).view(cls)
  File "/home/sgrafbe/mlwhatif/venv/lib64/python3.9/site-packages/numpy/core/_asarray.py", line 83, in asarray
    return array(a, dtype, copy=False, order=order)
numpy.core._exceptions.MemoryError: Unable to allocate 3.72 GiB for an array with shape (35312,) and data type <U28286
taskset -c 160-168 PROTOCOL_BUFFERS_PYTHON_IMPLEMENTATION=python python3.9 benchmarks_end_to_end.py data_corruption reviews slow_loading featurization_4 logistic_regression
2022-09-21 03:09:43.267241: W tensorflow/stream_executor/platform/default/dso_loader.cc:64] Could not load dynamic library 'libcudart.so.11.0'; dlerror: libcudart.so.11.0: cannot open shared object file: No such file or directory; LD_LIBRARY_PATH: /home/sgrafbe/mlwhatif/venv/lib/python3.9/site-packages/cv2/../../lib64:
2022-09-21 03:09:43.267287: I tensorflow/stream_executor/cuda/cudart_stub.cc:29] Ignore above cudart dlerror if you do not have a GPU set up on your machine.
2022-09-21 03:09:44 INFO  Patching sys.argv with ['mlwhatif', 'reviews', 'slow_loading', 'featurization_4', 'logistic_regression']
2022-09-21 03:09:44 INFO  Running instrumented original pipeline...
2022-09-21 03:09:44 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-21 03:09:44 INFO  ---RUNTIME: Importing and monkey-patching took 125.90956687927246 ms
2022-09-21 03:09:58 INFO  ---RUNTIME: Original pipeline execution took 13802.78992652893 ms (excluding imports and monkey-patching)
2022-09-21 03:09:58 INFO  Starting execution of 0 what-if analyses...
2022-09-21 03:09:58 INFO  Estimated runtime of original DAG is 10492.518663406372ms
2022-09-21 03:09:58 INFO  Performing Multi-Query Optimization
2022-09-21 03:09:58 INFO  Estimated unoptimized what-if runtime is 0ms
2022-09-21 03:09:58 INFO  Estimated optimised what-if runtime is 0ms
2022-09-21 03:09:58 INFO  Estimated optimisation runtime saving is 0ms
2022-09-21 03:09:58 INFO  ---RUNTIME: Multi-Query Optimization took 0.5512237548828125 ms
2022-09-21 03:09:58 INFO  Executing generated plans
2022-09-21 03:09:58 INFO  ---RUNTIME: Execution took 0.024318695068359375 ms
2022-09-21 03:09:58 INFO  Done!
2022-09-21 03:09:58 INFO  # Optimization benchmark for data_corruption with args [['reviews', 'slow_loading', 'featurization_4', 'logistic_regression']] -- repetition 1 of 7
2022-09-21 03:09:58 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-21 03:09:58 INFO  Running instrumented original pipeline...
2022-09-21 03:09:58 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-21 03:09:58 INFO  ---RUNTIME: Importing and monkey-patching took 5.489349365234375 ms
2022-09-21 03:10:11 INFO  ---RUNTIME: Original pipeline execution took 13081.79497718811 ms (excluding imports and monkey-patching)
2022-09-21 03:10:11 INFO  Starting execution of 1 what-if analyses...
2022-09-21 03:10:11 INFO  Start plan generation for analysis DataCorruption...
2022-09-21 03:10:11 INFO  ---RUNTIME: Plan generation took 0.4315376281738281 ms
2022-09-21 03:10:11 INFO  Estimated runtime of original DAG is 9823.494672775269ms
2022-09-21 03:10:11 INFO  Performing Multi-Query Optimization
2022-09-21 03:10:11 INFO  Estimated unoptimized what-if runtime is 245587.3668193817ms
2022-09-21 03:10:11 INFO  Estimated optimised what-if runtime is 10919.537544250488ms
2022-09-21 03:10:11 INFO  Estimated optimisation runtime saving is 234667.82927513123ms
2022-09-21 03:10:11 INFO  ---RUNTIME: Multi-Query Optimization took 69.25845146179199 ms
2022-09-21 03:10:11 INFO  Executing generated plans
2022-09-21 03:10:27 INFO  ---RUNTIME: Execution took 15962.611436843872 ms
2022-09-21 03:10:27 INFO  Done!
2022-09-21 03:10:27 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-21 03:10:27 INFO  Running instrumented original pipeline...
2022-09-21 03:10:27 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-21 03:10:27 INFO  ---RUNTIME: Importing and monkey-patching took 6.066083908081055 ms
2022-09-21 03:10:41 INFO  ---RUNTIME: Original pipeline execution took 14035.89677810669 ms (excluding imports and monkey-patching)
2022-09-21 03:10:41 INFO  Starting execution of 1 what-if analyses...
2022-09-21 03:10:41 INFO  Start plan generation for analysis DataCorruption...
2022-09-21 03:10:41 INFO  ---RUNTIME: Plan generation took 0.40435791015625 ms
2022-09-21 03:10:41 INFO  Estimated runtime of original DAG is 10575.563192367554ms
2022-09-21 03:10:41 WARNING Skipping Multi-Query Optimization (instead, only combine execution DAGs)
2022-09-21 03:10:41 INFO  Estimated unoptimised what-if runtime is 264389.07980918884ms
2022-09-21 03:10:41 INFO  ---RUNTIME: Multi-Query Optimization took 152.70018577575684 ms
2022-09-21 03:10:41 INFO  Executing generated plans
2022-09-21 03:15:17 INFO  ---RUNTIME: Execution took 275638.7870311737 ms
2022-09-21 03:15:17 INFO  Done!
2022-09-21 03:15:17 INFO  # Finished -- repetition 1 of 7 
2022-09-21 03:15:17 INFO  # Optimization benchmark for data_corruption with args [['reviews', 'slow_loading', 'featurization_4', 'logistic_regression']] -- repetition 2 of 7
2022-09-21 03:15:17 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-21 03:15:17 INFO  Running instrumented original pipeline...
2022-09-21 03:15:17 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-21 03:15:17 INFO  ---RUNTIME: Importing and monkey-patching took 5.7697296142578125 ms
2022-09-21 03:15:31 INFO  ---RUNTIME: Original pipeline execution took 13634.59300994873 ms (excluding imports and monkey-patching)
2022-09-21 03:15:31 INFO  Starting execution of 1 what-if analyses...
2022-09-21 03:15:31 INFO  Start plan generation for analysis DataCorruption...
2022-09-21 03:15:31 INFO  ---RUNTIME: Plan generation took 0.5109310150146484 ms
2022-09-21 03:15:31 INFO  Estimated runtime of original DAG is 10321.552991867065ms
2022-09-21 03:15:31 INFO  Performing Multi-Query Optimization
2022-09-21 03:15:31 INFO  Estimated unoptimized what-if runtime is 258038.82479667664ms
2022-09-21 03:15:31 INFO  Estimated optimised what-if runtime is 11401.114225387573ms
2022-09-21 03:15:31 INFO  Estimated optimisation runtime saving is 246637.71057128906ms
2022-09-21 03:15:31 INFO  ---RUNTIME: Multi-Query Optimization took 69.70405578613281 ms
2022-09-21 03:15:31 INFO  Executing generated plans
2022-09-21 03:15:46 INFO  ---RUNTIME: Execution took 15682.403802871704 ms
2022-09-21 03:15:46 INFO  Done!
2022-09-21 03:15:46 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-21 03:15:46 INFO  Running instrumented original pipeline...
2022-09-21 03:15:46 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-21 03:15:46 INFO  ---RUNTIME: Importing and monkey-patching took 5.719900131225586 ms
2022-09-21 03:16:00 INFO  ---RUNTIME: Original pipeline execution took 13214.84923362732 ms (excluding imports and monkey-patching)
2022-09-21 03:16:00 INFO  Starting execution of 1 what-if analyses...
2022-09-21 03:16:00 INFO  Start plan generation for analysis DataCorruption...
2022-09-21 03:16:00 INFO  ---RUNTIME: Plan generation took 0.4830360412597656 ms
2022-09-21 03:16:00 INFO  Estimated runtime of original DAG is 9628.944158554077ms
2022-09-21 03:16:00 WARNING Skipping Multi-Query Optimization (instead, only combine execution DAGs)
2022-09-21 03:16:00 INFO  Estimated unoptimised what-if runtime is 240723.60396385193ms
2022-09-21 03:16:00 INFO  ---RUNTIME: Multi-Query Optimization took 152.99510955810547 ms
2022-09-21 03:16:00 INFO  Executing generated plans
2022-09-21 03:20:36 INFO  ---RUNTIME: Execution took 276598.1283187866 ms
2022-09-21 03:20:36 INFO  Done!
2022-09-21 03:20:36 INFO  # Finished -- repetition 2 of 7 
2022-09-21 03:20:36 INFO  # Optimization benchmark for data_corruption with args [['reviews', 'slow_loading', 'featurization_4', 'logistic_regression']] -- repetition 3 of 7
2022-09-21 03:20:36 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-21 03:20:36 INFO  Running instrumented original pipeline...
2022-09-21 03:20:36 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-21 03:20:36 INFO  ---RUNTIME: Importing and monkey-patching took 6.501197814941406 ms
2022-09-21 03:20:51 INFO  ---RUNTIME: Original pipeline execution took 14359.555721282959 ms (excluding imports and monkey-patching)
2022-09-21 03:20:51 INFO  Starting execution of 1 what-if analyses...
2022-09-21 03:20:51 INFO  Start plan generation for analysis DataCorruption...
2022-09-21 03:20:51 INFO  ---RUNTIME: Plan generation took 0.4630088806152344 ms
2022-09-21 03:20:51 INFO  Estimated runtime of original DAG is 10499.600887298584ms
2022-09-21 03:20:51 INFO  Performing Multi-Query Optimization
2022-09-21 03:20:51 INFO  Estimated unoptimized what-if runtime is 262490.0221824646ms
2022-09-21 03:20:51 INFO  Estimated optimised what-if runtime is 11700.591802597046ms
2022-09-21 03:20:51 INFO  Estimated optimisation runtime saving is 250789.43037986755ms
2022-09-21 03:20:51 INFO  ---RUNTIME: Multi-Query Optimization took 104.7220230102539 ms
2022-09-21 03:20:51 INFO  Executing generated plans
2022-09-21 03:21:07 INFO  ---RUNTIME: Execution took 16329.054594039917 ms
2022-09-21 03:21:07 INFO  Done!
2022-09-21 03:21:07 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-21 03:21:07 INFO  Running instrumented original pipeline...
2022-09-21 03:21:07 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-21 03:21:07 INFO  ---RUNTIME: Importing and monkey-patching took 5.736589431762695 ms
2022-09-21 03:21:21 INFO  ---RUNTIME: Original pipeline execution took 13443.62473487854 ms (excluding imports and monkey-patching)
2022-09-21 03:21:21 INFO  Starting execution of 1 what-if analyses...
2022-09-21 03:21:21 INFO  Start plan generation for analysis DataCorruption...
2022-09-21 03:21:21 INFO  ---RUNTIME: Plan generation took 0.4146099090576172 ms
2022-09-21 03:21:21 INFO  Estimated runtime of original DAG is 9829.602718353271ms
2022-09-21 03:21:21 WARNING Skipping Multi-Query Optimization (instead, only combine execution DAGs)
2022-09-21 03:21:21 INFO  Estimated unoptimised what-if runtime is 245740.0679588318ms
2022-09-21 03:21:21 INFO  ---RUNTIME: Multi-Query Optimization took 154.37889099121094 ms
2022-09-21 03:21:21 INFO  Executing generated plans
2022-09-21 03:25:58 INFO  ---RUNTIME: Execution took 277617.5034046173 ms
2022-09-21 03:25:58 INFO  Done!
2022-09-21 03:25:58 INFO  # Finished -- repetition 3 of 7 
2022-09-21 03:25:58 INFO  # Optimization benchmark for data_corruption with args [['reviews', 'slow_loading', 'featurization_4', 'logistic_regression']] -- repetition 4 of 7
2022-09-21 03:25:58 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-21 03:25:58 INFO  Running instrumented original pipeline...
2022-09-21 03:25:58 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-21 03:25:58 INFO  ---RUNTIME: Importing and monkey-patching took 6.386756896972656 ms
2022-09-21 03:26:13 INFO  ---RUNTIME: Original pipeline execution took 14472.11217880249 ms (excluding imports and monkey-patching)
2022-09-21 03:26:13 INFO  Starting execution of 1 what-if analyses...
2022-09-21 03:26:13 INFO  Start plan generation for analysis DataCorruption...
2022-09-21 03:26:13 INFO  ---RUNTIME: Plan generation took 0.45800209045410156 ms
2022-09-21 03:26:13 INFO  Estimated runtime of original DAG is 11062.266111373901ms
2022-09-21 03:26:13 INFO  Performing Multi-Query Optimization
2022-09-21 03:26:13 INFO  Estimated unoptimized what-if runtime is 276556.65278434753ms
2022-09-21 03:26:13 INFO  Estimated optimised what-if runtime is 12153.231382369995ms
2022-09-21 03:26:13 INFO  Estimated optimisation runtime saving is 264403.42140197754ms
2022-09-21 03:26:13 INFO  ---RUNTIME: Multi-Query Optimization took 69.7317123413086 ms
2022-09-21 03:26:13 INFO  Executing generated plans
2022-09-21 03:26:29 INFO  ---RUNTIME: Execution took 15785.298109054565 ms
2022-09-21 03:26:29 INFO  Done!
2022-09-21 03:26:29 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-21 03:26:29 INFO  Running instrumented original pipeline...
2022-09-21 03:26:29 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-21 03:26:29 INFO  ---RUNTIME: Importing and monkey-patching took 6.236791610717773 ms
2022-09-21 03:26:43 INFO  ---RUNTIME: Original pipeline execution took 14066.37692451477 ms (excluding imports and monkey-patching)
2022-09-21 03:26:43 INFO  Starting execution of 1 what-if analyses...
2022-09-21 03:26:43 INFO  Start plan generation for analysis DataCorruption...
2022-09-21 03:26:43 INFO  ---RUNTIME: Plan generation took 0.4405975341796875 ms
2022-09-21 03:26:43 INFO  Estimated runtime of original DAG is 10433.483600616455ms
2022-09-21 03:26:43 WARNING Skipping Multi-Query Optimization (instead, only combine execution DAGs)
2022-09-21 03:26:43 INFO  Estimated unoptimised what-if runtime is 260837.09001541138ms
2022-09-21 03:26:43 INFO  ---RUNTIME: Multi-Query Optimization took 153.7792682647705 ms
2022-09-21 03:26:43 INFO  Executing generated plans
2022-09-21 03:31:23 INFO  ---RUNTIME: Execution took 280025.5091190338 ms
2022-09-21 03:31:23 INFO  Done!
2022-09-21 03:31:23 INFO  # Finished -- repetition 4 of 7 
2022-09-21 03:31:23 INFO  # Optimization benchmark for data_corruption with args [['reviews', 'slow_loading', 'featurization_4', 'logistic_regression']] -- repetition 5 of 7
2022-09-21 03:31:23 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-21 03:31:23 INFO  Running instrumented original pipeline...
2022-09-21 03:31:23 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-21 03:31:23 INFO  ---RUNTIME: Importing and monkey-patching took 5.91588020324707 ms
2022-09-21 03:31:37 INFO  ---RUNTIME: Original pipeline execution took 14047.019004821777 ms (excluding imports and monkey-patching)
2022-09-21 03:31:37 INFO  Starting execution of 1 what-if analyses...
2022-09-21 03:31:37 INFO  Start plan generation for analysis DataCorruption...
2022-09-21 03:31:37 INFO  ---RUNTIME: Plan generation took 0.4112720489501953 ms
2022-09-21 03:31:37 INFO  Estimated runtime of original DAG is 10424.528360366821ms
2022-09-21 03:31:37 INFO  Performing Multi-Query Optimization
2022-09-21 03:31:37 INFO  Estimated unoptimized what-if runtime is 260613.20900917053ms
2022-09-21 03:31:37 INFO  Estimated optimised what-if runtime is 11515.87462425232ms
2022-09-21 03:31:37 INFO  Estimated optimisation runtime saving is 249097.3343849182ms
2022-09-21 03:31:37 INFO  ---RUNTIME: Multi-Query Optimization took 68.53437423706055 ms
2022-09-21 03:31:37 INFO  Executing generated plans
2022-09-21 03:31:55 INFO  ---RUNTIME: Execution took 18118.175745010376 ms
2022-09-21 03:31:55 INFO  Done!
2022-09-21 03:31:55 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-21 03:31:55 INFO  Running instrumented original pipeline...
2022-09-21 03:31:55 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-21 03:31:55 INFO  ---RUNTIME: Importing and monkey-patching took 9.06515121459961 ms
2022-09-21 03:32:17 INFO  ---RUNTIME: Original pipeline execution took 21234.535932540894 ms (excluding imports and monkey-patching)
2022-09-21 03:32:17 INFO  Starting execution of 1 what-if analyses...
2022-09-21 03:32:17 INFO  Start plan generation for analysis DataCorruption...
2022-09-21 03:32:17 INFO  ---RUNTIME: Plan generation took 0.6010532379150391 ms
2022-09-21 03:32:17 INFO  Estimated runtime of original DAG is 15054.969549179077ms
2022-09-21 03:32:17 WARNING Skipping Multi-Query Optimization (instead, only combine execution DAGs)
2022-09-21 03:32:17 INFO  Estimated unoptimised what-if runtime is 376374.2387294769ms
2022-09-21 03:32:17 INFO  ---RUNTIME: Multi-Query Optimization took 326.89833641052246 ms
2022-09-21 03:32:17 INFO  Executing generated plans
2022-09-21 03:37:14 INFO  ---RUNTIME: Execution took 297292.72079467773 ms
2022-09-21 03:37:14 INFO  Done!
2022-09-21 03:37:14 INFO  # Finished -- repetition 5 of 7 
2022-09-21 03:37:14 INFO  # Optimization benchmark for data_corruption with args [['reviews', 'slow_loading', 'featurization_4', 'logistic_regression']] -- repetition 6 of 7
2022-09-21 03:37:14 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-21 03:37:14 INFO  Running instrumented original pipeline...
2022-09-21 03:37:14 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-21 03:37:14 INFO  ---RUNTIME: Importing and monkey-patching took 6.084680557250977 ms
2022-09-21 03:37:28 INFO  ---RUNTIME: Original pipeline execution took 13664.927959442139 ms (excluding imports and monkey-patching)
2022-09-21 03:37:28 INFO  Starting execution of 1 what-if analyses...
2022-09-21 03:37:28 INFO  Start plan generation for analysis DataCorruption...
2022-09-21 03:37:28 INFO  ---RUNTIME: Plan generation took 0.4646778106689453 ms
2022-09-21 03:37:28 INFO  Estimated runtime of original DAG is 10334.34247970581ms
2022-09-21 03:37:28 INFO  Performing Multi-Query Optimization
2022-09-21 03:37:28 INFO  Estimated unoptimized what-if runtime is 258358.56199264526ms
2022-09-21 03:37:28 INFO  Estimated optimised what-if runtime is 11397.924900054932ms
2022-09-21 03:37:28 INFO  Estimated optimisation runtime saving is 246960.63709259033ms
2022-09-21 03:37:28 INFO  ---RUNTIME: Multi-Query Optimization took 69.10490989685059 ms
2022-09-21 03:37:28 INFO  Executing generated plans
2022-09-21 03:37:44 INFO  ---RUNTIME: Execution took 15833.00518989563 ms
2022-09-21 03:37:44 INFO  Done!
2022-09-21 03:37:44 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-21 03:37:44 INFO  Running instrumented original pipeline...
2022-09-21 03:37:44 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-21 03:37:44 INFO  ---RUNTIME: Importing and monkey-patching took 6.057262420654297 ms
2022-09-21 03:37:57 INFO  ---RUNTIME: Original pipeline execution took 13125.181913375854 ms (excluding imports and monkey-patching)
2022-09-21 03:37:57 INFO  Starting execution of 1 what-if analyses...
2022-09-21 03:37:57 INFO  Start plan generation for analysis DataCorruption...
2022-09-21 03:37:57 INFO  ---RUNTIME: Plan generation took 0.4782676696777344 ms
2022-09-21 03:37:57 INFO  Estimated runtime of original DAG is 9770.761251449585ms
2022-09-21 03:37:57 WARNING Skipping Multi-Query Optimization (instead, only combine execution DAGs)
2022-09-21 03:37:57 INFO  Estimated unoptimised what-if runtime is 244269.03128623962ms
2022-09-21 03:37:57 INFO  ---RUNTIME: Multi-Query Optimization took 446.60115242004395 ms
2022-09-21 03:37:57 INFO  Executing generated plans
2022-09-21 03:43:07 INFO  ---RUNTIME: Execution took 309817.3940181732 ms
2022-09-21 03:43:07 INFO  Done!
2022-09-21 03:43:07 INFO  # Finished -- repetition 6 of 7 
2022-09-21 03:43:07 INFO  # Optimization benchmark for data_corruption with args [['reviews', 'slow_loading', 'featurization_4', 'logistic_regression']] -- repetition 7 of 7
2022-09-21 03:43:07 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-21 03:43:07 INFO  Running instrumented original pipeline...
2022-09-21 03:43:07 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-21 03:43:07 INFO  ---RUNTIME: Importing and monkey-patching took 6.169795989990234 ms
2022-09-21 03:43:21 INFO  ---RUNTIME: Original pipeline execution took 13779.585361480713 ms (excluding imports and monkey-patching)
2022-09-21 03:43:21 INFO  Starting execution of 1 what-if analyses...
2022-09-21 03:43:21 INFO  Start plan generation for analysis DataCorruption...
2022-09-21 03:43:21 INFO  ---RUNTIME: Plan generation took 0.5583763122558594 ms
2022-09-21 03:43:21 INFO  Estimated runtime of original DAG is 10422.871828079224ms
2022-09-21 03:43:21 INFO  Performing Multi-Query Optimization
2022-09-21 03:43:21 INFO  Estimated unoptimized what-if runtime is 260571.7957019806ms
2022-09-21 03:43:21 INFO  Estimated optimised what-if runtime is 11455.812215805054ms
2022-09-21 03:43:21 INFO  Estimated optimisation runtime saving is 249115.98348617554ms
2022-09-21 03:43:21 INFO  ---RUNTIME: Multi-Query Optimization took 69.77367401123047 ms
2022-09-21 03:43:21 INFO  Executing generated plans
2022-09-21 03:43:37 INFO  ---RUNTIME: Execution took 15863.239526748657 ms
2022-09-21 03:43:37 INFO  Done!
2022-09-21 03:43:37 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-21 03:43:37 INFO  Running instrumented original pipeline...
2022-09-21 03:43:37 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-21 03:43:37 INFO  ---RUNTIME: Importing and monkey-patching took 5.936384201049805 ms
2022-09-21 03:43:50 INFO  ---RUNTIME: Original pipeline execution took 13399.461269378662 ms (excluding imports and monkey-patching)
2022-09-21 03:43:50 INFO  Starting execution of 1 what-if analyses...
2022-09-21 03:43:50 INFO  Start plan generation for analysis DataCorruption...
2022-09-21 03:43:50 INFO  ---RUNTIME: Plan generation took 0.4184246063232422 ms
2022-09-21 03:43:50 INFO  Estimated runtime of original DAG is 10022.936582565308ms
2022-09-21 03:43:50 WARNING Skipping Multi-Query Optimization (instead, only combine execution DAGs)
2022-09-21 03:43:50 INFO  Estimated unoptimised what-if runtime is 250573.4145641327ms
2022-09-21 03:43:50 INFO  ---RUNTIME: Multi-Query Optimization took 154.51502799987793 ms
2022-09-21 03:43:50 INFO  Executing generated plans
2022-09-21 03:49:01 INFO  ---RUNTIME: Execution took 310108.54506492615 ms
2022-09-21 03:49:01 INFO  Done!
2022-09-21 03:49:01 INFO  # Finished -- repetition 7 of 7 
2022-09-21 03:49:01 INFO  # Final results after all repetitions
2022-09-21 03:49:01 INFO     repetition  ... no_opt_what_if_execution_combined_model_training
0           0  ...                                      4553.384066
1           1  ...                                      4542.611361
2           2  ...                                      4526.723385
3           3  ...                                      4506.465197
4           4  ...                                      4526.956320
5           5  ...                                      4555.267096
6           6  ...                                      4514.755011

[7 rows x 26 columns]
taskset -c 160-168 PROTOCOL_BUFFERS_PYTHON_IMPLEMENTATION=python python3.9 benchmarks_end_to_end.py data_corruption reviews slow_loading featurization_4 xgboost
2022-09-21 03:49:03.428555: W tensorflow/stream_executor/platform/default/dso_loader.cc:64] Could not load dynamic library 'libcudart.so.11.0'; dlerror: libcudart.so.11.0: cannot open shared object file: No such file or directory; LD_LIBRARY_PATH: /home/sgrafbe/mlwhatif/venv/lib/python3.9/site-packages/cv2/../../lib64:
2022-09-21 03:49:03.428601: I tensorflow/stream_executor/cuda/cudart_stub.cc:29] Ignore above cudart dlerror if you do not have a GPU set up on your machine.
2022-09-21 03:49:04 INFO  Patching sys.argv with ['mlwhatif', 'reviews', 'slow_loading', 'featurization_4', 'xgboost']
2022-09-21 03:49:04 INFO  Running instrumented original pipeline...
2022-09-21 03:49:04 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-21 03:49:04 INFO  ---RUNTIME: Importing and monkey-patching took 121.49739265441895 ms
2022-09-21 03:49:23 INFO  ---RUNTIME: Original pipeline execution took 18416.2757396698 ms (excluding imports and monkey-patching)
2022-09-21 03:49:23 INFO  Starting execution of 0 what-if analyses...
2022-09-21 03:49:23 INFO  Estimated runtime of original DAG is 15135.119438171387ms
2022-09-21 03:49:23 INFO  Performing Multi-Query Optimization
2022-09-21 03:49:23 INFO  Estimated unoptimized what-if runtime is 0ms
2022-09-21 03:49:23 INFO  Estimated optimised what-if runtime is 0ms
2022-09-21 03:49:23 INFO  Estimated optimisation runtime saving is 0ms
2022-09-21 03:49:23 INFO  ---RUNTIME: Multi-Query Optimization took 0.5598068237304688 ms
2022-09-21 03:49:23 INFO  Executing generated plans
2022-09-21 03:49:23 INFO  ---RUNTIME: Execution took 0.027179718017578125 ms
2022-09-21 03:49:23 INFO  Done!
2022-09-21 03:49:23 INFO  # Optimization benchmark for data_corruption with args [['reviews', 'slow_loading', 'featurization_4', 'xgboost']] -- repetition 1 of 7
2022-09-21 03:49:23 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-21 03:49:23 INFO  Running instrumented original pipeline...
2022-09-21 03:49:23 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-21 03:49:23 INFO  ---RUNTIME: Importing and monkey-patching took 5.322456359863281 ms
2022-09-21 03:49:39 INFO  ---RUNTIME: Original pipeline execution took 16362.349510192871 ms (excluding imports and monkey-patching)
2022-09-21 03:49:39 INFO  Starting execution of 1 what-if analyses...
2022-09-21 03:49:39 INFO  Start plan generation for analysis DataCorruption...
2022-09-21 03:49:39 INFO  ---RUNTIME: Plan generation took 0.44083595275878906 ms
2022-09-21 03:49:39 INFO  Estimated runtime of original DAG is 12948.987483978271ms
2022-09-21 03:49:39 INFO  Performing Multi-Query Optimization
2022-09-21 03:49:39 INFO  Estimated unoptimized what-if runtime is 323724.6870994568ms
2022-09-21 03:49:39 INFO  Estimated optimised what-if runtime is 15140.782594680786ms
2022-09-21 03:49:39 INFO  Estimated optimisation runtime saving is 308583.904504776ms
2022-09-21 03:49:39 INFO  ---RUNTIME: Multi-Query Optimization took 70.14846801757812 ms
2022-09-21 03:49:39 INFO  Executing generated plans
2022-09-21 03:49:59 INFO  ---RUNTIME: Execution took 20283.595085144043 ms
2022-09-21 03:49:59 INFO  Done!
2022-09-21 03:49:59 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-21 03:49:59 INFO  Running instrumented original pipeline...
2022-09-21 03:50:00 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-21 03:50:00 INFO  ---RUNTIME: Importing and monkey-patching took 6.087303161621094 ms
2022-09-21 03:50:16 INFO  ---RUNTIME: Original pipeline execution took 16455.26885986328 ms (excluding imports and monkey-patching)
2022-09-21 03:50:16 INFO  Starting execution of 1 what-if analyses...
2022-09-21 03:50:16 INFO  Start plan generation for analysis DataCorruption...
2022-09-21 03:50:16 INFO  ---RUNTIME: Plan generation took 0.42128562927246094 ms
2022-09-21 03:50:16 INFO  Estimated runtime of original DAG is 13011.493444442749ms
2022-09-21 03:50:16 WARNING Skipping Multi-Query Optimization (instead, only combine execution DAGs)
2022-09-21 03:50:16 INFO  Estimated unoptimised what-if runtime is 325287.3361110687ms
2022-09-21 03:50:16 INFO  ---RUNTIME: Multi-Query Optimization took 149.5363712310791 ms
2022-09-21 03:50:16 INFO  Executing generated plans
2022-09-21 03:56:45 INFO  ---RUNTIME: Execution took 388542.20390319824 ms
2022-09-21 03:56:45 INFO  Done!
2022-09-21 03:56:45 INFO  # Finished -- repetition 1 of 7 
2022-09-21 03:56:45 INFO  # Optimization benchmark for data_corruption with args [['reviews', 'slow_loading', 'featurization_4', 'xgboost']] -- repetition 2 of 7
2022-09-21 03:56:45 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-21 03:56:45 INFO  Running instrumented original pipeline...
2022-09-21 03:56:45 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-21 03:56:45 INFO  ---RUNTIME: Importing and monkey-patching took 7.032632827758789 ms
2022-09-21 03:57:02 INFO  ---RUNTIME: Original pipeline execution took 17419.508457183838 ms (excluding imports and monkey-patching)
2022-09-21 03:57:02 INFO  Starting execution of 1 what-if analyses...
2022-09-21 03:57:02 INFO  Start plan generation for analysis DataCorruption...
2022-09-21 03:57:02 INFO  ---RUNTIME: Plan generation took 0.4782676696777344 ms
2022-09-21 03:57:02 INFO  Estimated runtime of original DAG is 14114.01081085205ms
2022-09-21 03:57:02 INFO  Performing Multi-Query Optimization
2022-09-21 03:57:02 INFO  Estimated unoptimized what-if runtime is 352850.27027130127ms
2022-09-21 03:57:02 INFO  Estimated optimised what-if runtime is 16102.033615112305ms
2022-09-21 03:57:02 INFO  Estimated optimisation runtime saving is 336748.23665618896ms
2022-09-21 03:57:02 INFO  ---RUNTIME: Multi-Query Optimization took 67.97099113464355 ms
2022-09-21 03:57:02 INFO  Executing generated plans
2022-09-21 03:57:23 INFO  ---RUNTIME: Execution took 20359.139919281006 ms
2022-09-21 03:57:23 INFO  Done!
2022-09-21 03:57:23 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-21 03:57:23 INFO  Running instrumented original pipeline...
2022-09-21 03:57:23 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-21 03:57:23 INFO  ---RUNTIME: Importing and monkey-patching took 5.932092666625977 ms
2022-09-21 03:57:39 INFO  ---RUNTIME: Original pipeline execution took 16333.070755004883 ms (excluding imports and monkey-patching)
2022-09-21 03:57:39 INFO  Starting execution of 1 what-if analyses...
2022-09-21 03:57:39 INFO  Start plan generation for analysis DataCorruption...
2022-09-21 03:57:39 INFO  ---RUNTIME: Plan generation took 0.4553794860839844 ms
2022-09-21 03:57:39 INFO  Estimated runtime of original DAG is 12809.532165527344ms
2022-09-21 03:57:39 WARNING Skipping Multi-Query Optimization (instead, only combine execution DAGs)
2022-09-21 03:57:39 INFO  Estimated unoptimised what-if runtime is 320238.3041381836ms
2022-09-21 03:57:39 INFO  ---RUNTIME: Multi-Query Optimization took 149.7504711151123 ms
2022-09-21 03:57:39 INFO  Executing generated plans
2022-09-21 04:04:12 INFO  ---RUNTIME: Execution took 393409.6415042877 ms
2022-09-21 04:04:12 INFO  Done!
2022-09-21 04:04:12 INFO  # Finished -- repetition 2 of 7 
2022-09-21 04:04:12 INFO  # Optimization benchmark for data_corruption with args [['reviews', 'slow_loading', 'featurization_4', 'xgboost']] -- repetition 3 of 7
2022-09-21 04:04:12 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-21 04:04:12 INFO  Running instrumented original pipeline...
2022-09-21 04:04:12 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-21 04:04:12 INFO  ---RUNTIME: Importing and monkey-patching took 6.202459335327148 ms
2022-09-21 04:04:31 INFO  ---RUNTIME: Original pipeline execution took 18246.768951416016 ms (excluding imports and monkey-patching)
2022-09-21 04:04:31 INFO  Starting execution of 1 what-if analyses...
2022-09-21 04:04:31 INFO  Start plan generation for analysis DataCorruption...
2022-09-21 04:04:31 INFO  ---RUNTIME: Plan generation took 0.4723072052001953 ms
2022-09-21 04:04:31 INFO  Estimated runtime of original DAG is 14639.451265335083ms
2022-09-21 04:04:31 INFO  Performing Multi-Query Optimization
2022-09-21 04:04:31 INFO  Estimated unoptimized what-if runtime is 365986.2816333771ms
2022-09-21 04:04:31 INFO  Estimated optimised what-if runtime is 16707.2651386261ms
2022-09-21 04:04:31 INFO  Estimated optimisation runtime saving is 349279.016494751ms
2022-09-21 04:04:31 INFO  ---RUNTIME: Multi-Query Optimization took 68.05157661437988 ms
2022-09-21 04:04:31 INFO  Executing generated plans
2022-09-21 04:04:52 INFO  ---RUNTIME: Execution took 21482.87272453308 ms
2022-09-21 04:04:52 INFO  Done!
2022-09-21 04:04:52 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-21 04:04:52 INFO  Running instrumented original pipeline...
2022-09-21 04:04:52 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-21 04:04:52 INFO  ---RUNTIME: Importing and monkey-patching took 5.785942077636719 ms
2022-09-21 04:05:10 INFO  ---RUNTIME: Original pipeline execution took 17941.871881484985 ms (excluding imports and monkey-patching)
2022-09-21 04:05:10 INFO  Starting execution of 1 what-if analyses...
2022-09-21 04:05:10 INFO  Start plan generation for analysis DataCorruption...
2022-09-21 04:05:10 INFO  ---RUNTIME: Plan generation took 0.43463706970214844 ms
2022-09-21 04:05:10 INFO  Estimated runtime of original DAG is 13773.9737033844ms
2022-09-21 04:05:10 WARNING Skipping Multi-Query Optimization (instead, only combine execution DAGs)
2022-09-21 04:05:10 INFO  Estimated unoptimised what-if runtime is 344349.34258461ms
2022-09-21 04:05:10 INFO  ---RUNTIME: Multi-Query Optimization took 149.0945816040039 ms
2022-09-21 04:05:10 INFO  Executing generated plans
2022-09-21 04:11:40 INFO  ---RUNTIME: Execution took 389837.8224372864 ms
2022-09-21 04:11:40 INFO  Done!
2022-09-21 04:11:40 INFO  # Finished -- repetition 3 of 7 
2022-09-21 04:11:40 INFO  # Optimization benchmark for data_corruption with args [['reviews', 'slow_loading', 'featurization_4', 'xgboost']] -- repetition 4 of 7
2022-09-21 04:11:40 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-21 04:11:40 INFO  Running instrumented original pipeline...
2022-09-21 04:11:40 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-21 04:11:40 INFO  ---RUNTIME: Importing and monkey-patching took 6.283760070800781 ms
2022-09-21 04:11:59 INFO  ---RUNTIME: Original pipeline execution took 18831.689834594727 ms (excluding imports and monkey-patching)
2022-09-21 04:11:59 INFO  Starting execution of 1 what-if analyses...
2022-09-21 04:11:59 INFO  Start plan generation for analysis DataCorruption...
2022-09-21 04:11:59 INFO  ---RUNTIME: Plan generation took 0.4227161407470703 ms
2022-09-21 04:11:59 INFO  Estimated runtime of original DAG is 14901.838302612305ms
2022-09-21 04:11:59 INFO  Performing Multi-Query Optimization
2022-09-21 04:11:59 INFO  Estimated unoptimized what-if runtime is 372545.9575653076ms
2022-09-21 04:11:59 INFO  Estimated optimised what-if runtime is 17065.966606140137ms
2022-09-21 04:11:59 INFO  Estimated optimisation runtime saving is 355479.9909591675ms
2022-09-21 04:11:59 INFO  ---RUNTIME: Multi-Query Optimization took 67.88420677185059 ms
2022-09-21 04:11:59 INFO  Executing generated plans
2022-09-21 04:12:21 INFO  ---RUNTIME: Execution took 21512.330055236816 ms
2022-09-21 04:12:21 INFO  Done!
2022-09-21 04:12:21 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-21 04:12:21 INFO  Running instrumented original pipeline...
2022-09-21 04:12:21 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-21 04:12:21 INFO  ---RUNTIME: Importing and monkey-patching took 5.922794342041016 ms
2022-09-21 04:12:39 INFO  ---RUNTIME: Original pipeline execution took 17945.682525634766 ms (excluding imports and monkey-patching)
2022-09-21 04:12:39 INFO  Starting execution of 1 what-if analyses...
2022-09-21 04:12:39 INFO  Start plan generation for analysis DataCorruption...
2022-09-21 04:12:39 INFO  ---RUNTIME: Plan generation took 0.4611015319824219 ms
2022-09-21 04:12:39 INFO  Estimated runtime of original DAG is 13668.538570404053ms
2022-09-21 04:12:39 WARNING Skipping Multi-Query Optimization (instead, only combine execution DAGs)
2022-09-21 04:12:39 INFO  Estimated unoptimised what-if runtime is 341713.4642601013ms
2022-09-21 04:12:39 INFO  ---RUNTIME: Multi-Query Optimization took 150.89869499206543 ms
2022-09-21 04:12:39 INFO  Executing generated plans
2022-09-21 04:19:04 INFO  ---RUNTIME: Execution took 385533.7860584259 ms
2022-09-21 04:19:04 INFO  Done!
2022-09-21 04:19:04 INFO  # Finished -- repetition 4 of 7 
2022-09-21 04:19:04 INFO  # Optimization benchmark for data_corruption with args [['reviews', 'slow_loading', 'featurization_4', 'xgboost']] -- repetition 5 of 7
2022-09-21 04:19:04 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-21 04:19:04 INFO  Running instrumented original pipeline...
2022-09-21 04:19:05 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-21 04:19:05 INFO  ---RUNTIME: Importing and monkey-patching took 6.502628326416016 ms
2022-09-21 04:19:22 INFO  ---RUNTIME: Original pipeline execution took 17472.221851348877 ms (excluding imports and monkey-patching)
2022-09-21 04:19:22 INFO  Starting execution of 1 what-if analyses...
2022-09-21 04:19:22 INFO  Start plan generation for analysis DataCorruption...
2022-09-21 04:19:22 INFO  ---RUNTIME: Plan generation took 0.39887428283691406 ms
2022-09-21 04:19:22 INFO  Estimated runtime of original DAG is 13831.911325454712ms
2022-09-21 04:19:22 INFO  Performing Multi-Query Optimization
2022-09-21 04:19:22 INFO  Estimated unoptimized what-if runtime is 345797.7831363678ms
2022-09-21 04:19:22 INFO  Estimated optimised what-if runtime is 15823.850393295288ms
2022-09-21 04:19:22 INFO  Estimated optimisation runtime saving is 329973.9327430725ms
2022-09-21 04:19:22 INFO  ---RUNTIME: Multi-Query Optimization took 67.9929256439209 ms
2022-09-21 04:19:22 INFO  Executing generated plans
2022-09-21 04:19:44 INFO  ---RUNTIME: Execution took 22031.290292739868 ms
2022-09-21 04:19:44 INFO  Done!
2022-09-21 04:19:44 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-21 04:19:44 INFO  Running instrumented original pipeline...
2022-09-21 04:19:44 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-21 04:19:44 INFO  ---RUNTIME: Importing and monkey-patching took 10.126590728759766 ms
2022-09-21 04:20:05 INFO  ---RUNTIME: Original pipeline execution took 21244.390964508057 ms (excluding imports and monkey-patching)
2022-09-21 04:20:05 INFO  Starting execution of 1 what-if analyses...
2022-09-21 04:20:05 INFO  Start plan generation for analysis DataCorruption...
2022-09-21 04:20:05 INFO  ---RUNTIME: Plan generation took 0.4334449768066406 ms
2022-09-21 04:20:05 INFO  Estimated runtime of original DAG is 16656.545877456665ms
2022-09-21 04:20:05 WARNING Skipping Multi-Query Optimization (instead, only combine execution DAGs)
2022-09-21 04:20:05 INFO  Estimated unoptimised what-if runtime is 416413.6469364166ms
2022-09-21 04:20:05 INFO  ---RUNTIME: Multi-Query Optimization took 149.82938766479492 ms
2022-09-21 04:20:05 INFO  Executing generated plans
2022-09-21 04:26:05 INFO  ---RUNTIME: Execution took 359915.2626991272 ms
2022-09-21 04:26:05 INFO  Done!
2022-09-21 04:26:05 INFO  # Finished -- repetition 5 of 7 
2022-09-21 04:26:05 INFO  # Optimization benchmark for data_corruption with args [['reviews', 'slow_loading', 'featurization_4', 'xgboost']] -- repetition 6 of 7
2022-09-21 04:26:05 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-21 04:26:05 INFO  Running instrumented original pipeline...
2022-09-21 04:26:05 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-21 04:26:05 INFO  ---RUNTIME: Importing and monkey-patching took 6.35075569152832 ms
2022-09-21 04:26:23 INFO  ---RUNTIME: Original pipeline execution took 17494.592905044556 ms (excluding imports and monkey-patching)
2022-09-21 04:26:23 INFO  Starting execution of 1 what-if analyses...
2022-09-21 04:26:23 INFO  Start plan generation for analysis DataCorruption...
2022-09-21 04:26:23 INFO  ---RUNTIME: Plan generation took 0.5199909210205078 ms
2022-09-21 04:26:23 INFO  Estimated runtime of original DAG is 13958.546161651611ms
2022-09-21 04:26:23 INFO  Performing Multi-Query Optimization
2022-09-21 04:26:23 INFO  Estimated unoptimized what-if runtime is 348963.6540412903ms
2022-09-21 04:26:23 INFO  Estimated optimised what-if runtime is 16152.313709259033ms
2022-09-21 04:26:23 INFO  Estimated optimisation runtime saving is 332811.34033203125ms
2022-09-21 04:26:23 INFO  ---RUNTIME: Multi-Query Optimization took 75.71840286254883 ms
2022-09-21 04:26:23 INFO  Executing generated plans
2022-09-21 04:26:44 INFO  ---RUNTIME: Execution took 20781.394004821777 ms
2022-09-21 04:26:44 INFO  Done!
2022-09-21 04:26:44 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-21 04:26:44 INFO  Running instrumented original pipeline...
2022-09-21 04:26:44 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-21 04:26:44 INFO  ---RUNTIME: Importing and monkey-patching took 7.126092910766602 ms
2022-09-21 04:27:00 INFO  ---RUNTIME: Original pipeline execution took 16830.345630645752 ms (excluding imports and monkey-patching)
2022-09-21 04:27:00 INFO  Starting execution of 1 what-if analyses...
2022-09-21 04:27:00 INFO  Start plan generation for analysis DataCorruption...
2022-09-21 04:27:00 INFO  ---RUNTIME: Plan generation took 0.4794597625732422 ms
2022-09-21 04:27:00 INFO  Estimated runtime of original DAG is 13326.298952102661ms
2022-09-21 04:27:00 WARNING Skipping Multi-Query Optimization (instead, only combine execution DAGs)
2022-09-21 04:27:01 INFO  Estimated unoptimised what-if runtime is 333157.4738025665ms
2022-09-21 04:27:01 INFO  ---RUNTIME: Multi-Query Optimization took 459.23590660095215 ms
2022-09-21 04:27:01 INFO  Executing generated plans
2022-09-21 04:33:02 INFO  ---RUNTIME: Execution took 360841.17102622986 ms
2022-09-21 04:33:02 INFO  Done!
2022-09-21 04:33:02 INFO  # Finished -- repetition 6 of 7 
2022-09-21 04:33:02 INFO  # Optimization benchmark for data_corruption with args [['reviews', 'slow_loading', 'featurization_4', 'xgboost']] -- repetition 7 of 7
2022-09-21 04:33:02 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-21 04:33:02 INFO  Running instrumented original pipeline...
2022-09-21 04:33:02 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-21 04:33:02 INFO  ---RUNTIME: Importing and monkey-patching took 6.180286407470703 ms
2022-09-21 04:33:19 INFO  ---RUNTIME: Original pipeline execution took 17191.927671432495 ms (excluding imports and monkey-patching)
2022-09-21 04:33:19 INFO  Starting execution of 1 what-if analyses...
2022-09-21 04:33:19 INFO  Start plan generation for analysis DataCorruption...
2022-09-21 04:33:19 INFO  ---RUNTIME: Plan generation took 0.7193088531494141 ms
2022-09-21 04:33:19 INFO  Estimated runtime of original DAG is 13850.40831565857ms
2022-09-21 04:33:19 INFO  Performing Multi-Query Optimization
2022-09-21 04:33:19 INFO  Estimated unoptimized what-if runtime is 346260.20789146423ms
2022-09-21 04:33:19 INFO  Estimated optimised what-if runtime is 16197.921991348267ms
2022-09-21 04:33:19 INFO  Estimated optimisation runtime saving is 330062.28590011597ms
2022-09-21 04:33:19 INFO  ---RUNTIME: Multi-Query Optimization took 78.81379127502441 ms
2022-09-21 04:33:19 INFO  Executing generated plans
2022-09-21 04:33:40 INFO  ---RUNTIME: Execution took 20975.507259368896 ms
2022-09-21 04:33:40 INFO  Done!
2022-09-21 04:33:40 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-21 04:33:40 INFO  Running instrumented original pipeline...
2022-09-21 04:33:40 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-21 04:33:40 INFO  ---RUNTIME: Importing and monkey-patching took 6.230354309082031 ms
2022-09-21 04:33:57 INFO  ---RUNTIME: Original pipeline execution took 17208.793878555298 ms (excluding imports and monkey-patching)
2022-09-21 04:33:57 INFO  Starting execution of 1 what-if analyses...
2022-09-21 04:33:57 INFO  Start plan generation for analysis DataCorruption...
2022-09-21 04:33:57 INFO  ---RUNTIME: Plan generation took 0.47016143798828125 ms
2022-09-21 04:33:57 INFO  Estimated runtime of original DAG is 13696.375131607056ms
2022-09-21 04:33:57 WARNING Skipping Multi-Query Optimization (instead, only combine execution DAGs)
2022-09-21 04:33:57 INFO  Estimated unoptimised what-if runtime is 342409.3782901764ms
2022-09-21 04:33:57 INFO  ---RUNTIME: Multi-Query Optimization took 156.75663948059082 ms
2022-09-21 04:33:57 INFO  Executing generated plans
2022-09-21 04:39:58 INFO  ---RUNTIME: Execution took 360225.54993629456 ms
2022-09-21 04:39:58 INFO  Done!
2022-09-21 04:39:58 INFO  # Finished -- repetition 7 of 7 
2022-09-21 04:39:58 INFO  # Final results after all repetitions
2022-09-21 04:39:58 INFO     repetition  ... no_opt_what_if_execution_combined_model_training
0           0  ...                                     86617.923975
1           1  ...                                    101028.803825
2           2  ...                                    105148.088932
3           3  ...                                     95686.042309
4           4  ...                                     81118.763924
5           5  ...                                     79713.909388
6           6  ...                                     79665.024996

[7 rows x 26 columns]
taskset -c 160-168 PROTOCOL_BUFFERS_PYTHON_IMPLEMENTATION=python python3.9 benchmarks_end_to_end.py data_corruption reviews slow_loading featurization_4 neural_network
2022-09-21 04:40:00.497219: W tensorflow/stream_executor/platform/default/dso_loader.cc:64] Could not load dynamic library 'libcudart.so.11.0'; dlerror: libcudart.so.11.0: cannot open shared object file: No such file or directory; LD_LIBRARY_PATH: /home/sgrafbe/mlwhatif/venv/lib/python3.9/site-packages/cv2/../../lib64:
2022-09-21 04:40:00.497268: I tensorflow/stream_executor/cuda/cudart_stub.cc:29] Ignore above cudart dlerror if you do not have a GPU set up on your machine.
2022-09-21 04:40:01 INFO  Patching sys.argv with ['mlwhatif', 'reviews', 'slow_loading', 'featurization_4', 'neural_network']
2022-09-21 04:40:01 INFO  Running instrumented original pipeline...
2022-09-21 04:40:01 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-21 04:40:01 INFO  ---RUNTIME: Importing and monkey-patching took 125.39148330688477 ms
2022-09-21 04:40:15.324641: W tensorflow/stream_executor/platform/default/dso_loader.cc:64] Could not load dynamic library 'libcuda.so.1'; dlerror: libcuda.so.1: cannot open shared object file: No such file or directory; LD_LIBRARY_PATH: /home/sgrafbe/mlwhatif/venv/lib/python3.9/site-packages/cv2/../../lib64:
2022-09-21 04:40:15.324679: W tensorflow/stream_executor/cuda/cuda_driver.cc:326] failed call to cuInit: UNKNOWN ERROR (303)
2022-09-21 04:40:15.324702: I tensorflow/stream_executor/cuda/cuda_diagnostics.cc:156] kernel driver does not appear to be running on this host (angus): /proc/driver/nvidia/version does not exist
2022-09-21 04:40:15.325293: I tensorflow/core/platform/cpu_feature_guard.cc:142] This TensorFlow binary is optimized with oneAPI Deep Neural Network Library (oneDNN) to use the following CPU instructions in performance-critical operations:  AVX2 FMA
To enable them in other operations, rebuild TensorFlow with the appropriate compiler flags.
2022-09-21 04:40:15.573398: I tensorflow/compiler/mlir/mlir_graph_optimization_pass.cc:176] None of the MLIR Optimization Passes are enabled (registered 2)
2022-09-21 04:40:15.585190: I tensorflow/core/platform/profile_utils/cpu_utils.cc:114] CPU Frequency: 2595130000 Hz
2022-09-21 04:40:19 INFO  ---RUNTIME: Original pipeline execution took 17639.98508453369 ms (excluding imports and monkey-patching)
2022-09-21 04:40:19 INFO  Starting execution of 0 what-if analyses...
2022-09-21 04:40:19 INFO  Estimated runtime of original DAG is 14356.266736984253ms
2022-09-21 04:40:19 INFO  Performing Multi-Query Optimization
2022-09-21 04:40:19 INFO  Estimated unoptimized what-if runtime is 0ms
2022-09-21 04:40:19 INFO  Estimated optimised what-if runtime is 0ms
2022-09-21 04:40:19 INFO  Estimated optimisation runtime saving is 0ms
2022-09-21 04:40:19 INFO  ---RUNTIME: Multi-Query Optimization took 0.5228519439697266 ms
2022-09-21 04:40:19 INFO  Executing generated plans
2022-09-21 04:40:19 INFO  ---RUNTIME: Execution took 0.015497207641601562 ms
2022-09-21 04:40:19 INFO  Done!
2022-09-21 04:40:19 INFO  # Optimization benchmark for data_corruption with args [['reviews', 'slow_loading', 'featurization_4', 'neural_network']] -- repetition 1 of 7
2022-09-21 04:40:19 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-21 04:40:19 INFO  Running instrumented original pipeline...
2022-09-21 04:40:19 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-21 04:40:19 INFO  ---RUNTIME: Importing and monkey-patching took 5.537271499633789 ms
2022-09-21 04:40:36 INFO  ---RUNTIME: Original pipeline execution took 17023.540496826172 ms (excluding imports and monkey-patching)
2022-09-21 04:40:36 INFO  Starting execution of 1 what-if analyses...
2022-09-21 04:40:36 INFO  Start plan generation for analysis DataCorruption...
2022-09-21 04:40:36 INFO  ---RUNTIME: Plan generation took 0.37169456481933594 ms
2022-09-21 04:40:36 INFO  Estimated runtime of original DAG is 13529.296875ms
2022-09-21 04:40:36 INFO  Performing Multi-Query Optimization
2022-09-21 04:40:36 INFO  Estimated unoptimized what-if runtime is 338232.421875ms
2022-09-21 04:40:36 INFO  Estimated optimised what-if runtime is 26001.562118530273ms
2022-09-21 04:40:36 INFO  Estimated optimisation runtime saving is 312230.8597564697ms
2022-09-21 04:40:36 INFO  ---RUNTIME: Multi-Query Optimization took 68.21322441101074 ms
2022-09-21 04:40:36 INFO  Executing generated plans
2022-09-21 04:41:07 INFO  ---RUNTIME: Execution took 30655.95316886902 ms
2022-09-21 04:41:07 INFO  Done!
2022-09-21 04:41:07 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-21 04:41:07 INFO  Running instrumented original pipeline...
2022-09-21 04:41:07 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-21 04:41:07 INFO  ---RUNTIME: Importing and monkey-patching took 11.598587036132812 ms
2022-09-21 04:41:25 INFO  ---RUNTIME: Original pipeline execution took 17699.621200561523 ms (excluding imports and monkey-patching)
2022-09-21 04:41:25 INFO  Starting execution of 1 what-if analyses...
2022-09-21 04:41:25 INFO  Start plan generation for analysis DataCorruption...
2022-09-21 04:41:25 INFO  ---RUNTIME: Plan generation took 0.4439353942871094 ms
2022-09-21 04:41:25 INFO  Estimated runtime of original DAG is 14070.40524482727ms
2022-09-21 04:41:25 WARNING Skipping Multi-Query Optimization (instead, only combine execution DAGs)
2022-09-21 04:41:25 INFO  Estimated unoptimised what-if runtime is 351760.13112068176ms
2022-09-21 04:41:25 INFO  ---RUNTIME: Multi-Query Optimization took 376.83701515197754 ms
2022-09-21 04:41:25 INFO  Executing generated plans
2022-09-21 04:47:36 INFO  ---RUNTIME: Execution took 371192.7046775818 ms
2022-09-21 04:47:36 INFO  Done!
2022-09-21 04:47:36 INFO  # Finished -- repetition 1 of 7 
2022-09-21 04:47:36 INFO  # Optimization benchmark for data_corruption with args [['reviews', 'slow_loading', 'featurization_4', 'neural_network']] -- repetition 2 of 7
2022-09-21 04:47:36 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-21 04:47:36 INFO  Running instrumented original pipeline...
2022-09-21 04:47:36 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-21 04:47:36 INFO  ---RUNTIME: Importing and monkey-patching took 6.088733673095703 ms
2022-09-21 04:47:55 INFO  ---RUNTIME: Original pipeline execution took 19103.811264038086 ms (excluding imports and monkey-patching)
2022-09-21 04:47:55 INFO  Starting execution of 1 what-if analyses...
2022-09-21 04:47:55 INFO  Start plan generation for analysis DataCorruption...
2022-09-21 04:47:55 INFO  ---RUNTIME: Plan generation took 0.5352497100830078 ms
2022-09-21 04:47:55 INFO  Estimated runtime of original DAG is 15693.137407302856ms
2022-09-21 04:47:55 INFO  Performing Multi-Query Optimization
2022-09-21 04:47:55 INFO  Estimated unoptimized what-if runtime is 392328.4351825714ms
2022-09-21 04:47:55 INFO  Estimated optimised what-if runtime is 31368.191242218018ms
2022-09-21 04:47:55 INFO  Estimated optimisation runtime saving is 360960.2439403534ms
2022-09-21 04:47:55 INFO  ---RUNTIME: Multi-Query Optimization took 95.8704948425293 ms
2022-09-21 04:47:55 INFO  Executing generated plans
2022-09-21 04:48:27 INFO  ---RUNTIME: Execution took 31348.07562828064 ms
2022-09-21 04:48:27 INFO  Done!
2022-09-21 04:48:27 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-21 04:48:27 INFO  Running instrumented original pipeline...
2022-09-21 04:48:27 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-21 04:48:27 INFO  ---RUNTIME: Importing and monkey-patching took 7.180690765380859 ms
2022-09-21 04:48:44 INFO  ---RUNTIME: Original pipeline execution took 17489.468812942505 ms (excluding imports and monkey-patching)
2022-09-21 04:48:44 INFO  Starting execution of 1 what-if analyses...
2022-09-21 04:48:44 INFO  Start plan generation for analysis DataCorruption...
2022-09-21 04:48:44 INFO  ---RUNTIME: Plan generation took 0.40984153747558594 ms
2022-09-21 04:48:44 INFO  Estimated runtime of original DAG is 14038.688898086548ms
2022-09-21 04:48:44 WARNING Skipping Multi-Query Optimization (instead, only combine execution DAGs)
2022-09-21 04:48:45 INFO  Estimated unoptimised what-if runtime is 350967.2224521637ms
2022-09-21 04:48:45 INFO  ---RUNTIME: Multi-Query Optimization took 495.12171745300293 ms
2022-09-21 04:48:45 INFO  Executing generated plans
2022-09-21 04:54:55 INFO  ---RUNTIME: Execution took 370553.48348617554 ms
2022-09-21 04:54:55 INFO  Done!
2022-09-21 04:54:55 INFO  # Finished -- repetition 2 of 7 
2022-09-21 04:54:55 INFO  # Optimization benchmark for data_corruption with args [['reviews', 'slow_loading', 'featurization_4', 'neural_network']] -- repetition 3 of 7
2022-09-21 04:54:55 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-21 04:54:55 INFO  Running instrumented original pipeline...
2022-09-21 04:54:55 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-21 04:54:55 INFO  ---RUNTIME: Importing and monkey-patching took 6.477117538452148 ms
2022-09-21 04:55:14 INFO  ---RUNTIME: Original pipeline execution took 18917.723417282104 ms (excluding imports and monkey-patching)
2022-09-21 04:55:14 INFO  Starting execution of 1 what-if analyses...
2022-09-21 04:55:14 INFO  Start plan generation for analysis DataCorruption...
2022-09-21 04:55:14 INFO  ---RUNTIME: Plan generation took 0.4107952117919922 ms
2022-09-21 04:55:14 INFO  Estimated runtime of original DAG is 15438.23266029358ms
2022-09-21 04:55:14 INFO  Performing Multi-Query Optimization
2022-09-21 04:55:14 INFO  Estimated unoptimized what-if runtime is 385955.8165073395ms
2022-09-21 04:55:14 INFO  Estimated optimised what-if runtime is 27276.249647140503ms
2022-09-21 04:55:14 INFO  Estimated optimisation runtime saving is 358679.566860199ms
2022-09-21 04:55:14 INFO  ---RUNTIME: Multi-Query Optimization took 67.85917282104492 ms
2022-09-21 04:55:14 INFO  Executing generated plans
2022-09-21 04:55:45 INFO  ---RUNTIME: Execution took 30467.29326248169 ms
2022-09-21 04:55:45 INFO  Done!
2022-09-21 04:55:45 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-21 04:55:45 INFO  Running instrumented original pipeline...
2022-09-21 04:55:45 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-21 04:55:45 INFO  ---RUNTIME: Importing and monkey-patching took 6.243467330932617 ms
2022-09-21 04:56:03 INFO  ---RUNTIME: Original pipeline execution took 18116.007804870605 ms (excluding imports and monkey-patching)
2022-09-21 04:56:03 INFO  Starting execution of 1 what-if analyses...
2022-09-21 04:56:03 INFO  Start plan generation for analysis DataCorruption...
2022-09-21 04:56:03 INFO  ---RUNTIME: Plan generation took 0.4343986511230469 ms
2022-09-21 04:56:03 INFO  Estimated runtime of original DAG is 14162.842512130737ms
2022-09-21 04:56:03 WARNING Skipping Multi-Query Optimization (instead, only combine execution DAGs)
2022-09-21 04:56:03 INFO  Estimated unoptimised what-if runtime is 354071.06280326843ms
2022-09-21 04:56:03 INFO  ---RUNTIME: Multi-Query Optimization took 165.29369354248047 ms
2022-09-21 04:56:03 INFO  Executing generated plans
2022-09-21 05:02:15 INFO  ---RUNTIME: Execution took 372086.66133880615 ms
2022-09-21 05:02:15 INFO  Done!
2022-09-21 05:02:15 INFO  # Finished -- repetition 3 of 7 
2022-09-21 05:02:15 INFO  # Optimization benchmark for data_corruption with args [['reviews', 'slow_loading', 'featurization_4', 'neural_network']] -- repetition 4 of 7
2022-09-21 05:02:15 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-21 05:02:15 INFO  Running instrumented original pipeline...
2022-09-21 05:02:15 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-21 05:02:15 INFO  ---RUNTIME: Importing and monkey-patching took 6.345272064208984 ms
2022-09-21 05:02:34 INFO  ---RUNTIME: Original pipeline execution took 19261.03663444519 ms (excluding imports and monkey-patching)
2022-09-21 05:02:34 INFO  Starting execution of 1 what-if analyses...
2022-09-21 05:02:34 INFO  Start plan generation for analysis DataCorruption...
2022-09-21 05:02:34 INFO  ---RUNTIME: Plan generation took 0.41174888610839844 ms
2022-09-21 05:02:34 INFO  Estimated runtime of original DAG is 15635.30158996582ms
2022-09-21 05:02:34 INFO  Performing Multi-Query Optimization
2022-09-21 05:02:34 INFO  Estimated unoptimized what-if runtime is 390882.5397491455ms
2022-09-21 05:02:34 INFO  Estimated optimised what-if runtime is 26763.77511024475ms
2022-09-21 05:02:34 INFO  Estimated optimisation runtime saving is 364118.76463890076ms
2022-09-21 05:02:34 INFO  ---RUNTIME: Multi-Query Optimization took 71.81477546691895 ms
2022-09-21 05:02:34 INFO  Executing generated plans
2022-09-21 05:03:05 INFO  ---RUNTIME: Execution took 30450.884342193604 ms
2022-09-21 05:03:05 INFO  Done!
2022-09-21 05:03:05 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-21 05:03:05 INFO  Running instrumented original pipeline...
2022-09-21 05:03:05 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-21 05:03:05 INFO  ---RUNTIME: Importing and monkey-patching took 6.296873092651367 ms
2022-09-21 05:03:23 INFO  ---RUNTIME: Original pipeline execution took 18029.821634292603 ms (excluding imports and monkey-patching)
2022-09-21 05:03:23 INFO  Starting execution of 1 what-if analyses...
2022-09-21 05:03:23 INFO  Start plan generation for analysis DataCorruption...
2022-09-21 05:03:23 INFO  ---RUNTIME: Plan generation took 0.446319580078125 ms
2022-09-21 05:03:23 INFO  Estimated runtime of original DAG is 14118.247985839844ms
2022-09-21 05:03:23 WARNING Skipping Multi-Query Optimization (instead, only combine execution DAGs)
2022-09-21 05:03:23 INFO  Estimated unoptimised what-if runtime is 352956.1996459961ms
2022-09-21 05:03:23 INFO  ---RUNTIME: Multi-Query Optimization took 152.68540382385254 ms
2022-09-21 05:03:23 INFO  Executing generated plans
2022-09-21 05:09:38 INFO  ---RUNTIME: Execution took 374940.7308101654 ms
2022-09-21 05:09:38 INFO  Done!
2022-09-21 05:09:38 INFO  # Finished -- repetition 4 of 7 
2022-09-21 05:09:38 INFO  # Optimization benchmark for data_corruption with args [['reviews', 'slow_loading', 'featurization_4', 'neural_network']] -- repetition 5 of 7
2022-09-21 05:09:38 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-21 05:09:38 INFO  Running instrumented original pipeline...
2022-09-21 05:09:38 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-21 05:09:38 INFO  ---RUNTIME: Importing and monkey-patching took 6.896734237670898 ms
2022-09-21 05:09:57 INFO  ---RUNTIME: Original pipeline execution took 19118.579387664795 ms (excluding imports and monkey-patching)
2022-09-21 05:09:57 INFO  Starting execution of 1 what-if analyses...
2022-09-21 05:09:57 INFO  Start plan generation for analysis DataCorruption...
2022-09-21 05:09:57 INFO  ---RUNTIME: Plan generation took 0.42057037353515625 ms
2022-09-21 05:09:57 INFO  Estimated runtime of original DAG is 14913.53440284729ms
2022-09-21 05:09:57 INFO  Performing Multi-Query Optimization
2022-09-21 05:09:57 INFO  Estimated unoptimized what-if runtime is 372838.36007118225ms
2022-09-21 05:09:57 INFO  Estimated optimised what-if runtime is 27320.775747299194ms
2022-09-21 05:09:57 INFO  Estimated optimisation runtime saving is 345517.58432388306ms
2022-09-21 05:09:57 INFO  ---RUNTIME: Multi-Query Optimization took 73.74691963195801 ms
2022-09-21 05:09:57 INFO  Executing generated plans
2022-09-21 05:10:28 INFO  ---RUNTIME: Execution took 30587.563514709473 ms
2022-09-21 05:10:28 INFO  Done!
2022-09-21 05:10:28 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-21 05:10:28 INFO  Running instrumented original pipeline...
2022-09-21 05:10:28 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-21 05:10:28 INFO  ---RUNTIME: Importing and monkey-patching took 6.725072860717773 ms
2022-09-21 05:10:46 INFO  ---RUNTIME: Original pipeline execution took 17651.9033908844 ms (excluding imports and monkey-patching)
2022-09-21 05:10:46 INFO  Starting execution of 1 what-if analyses...
2022-09-21 05:10:46 INFO  Start plan generation for analysis DataCorruption...
2022-09-21 05:10:46 INFO  ---RUNTIME: Plan generation took 0.45561790466308594 ms
2022-09-21 05:10:46 INFO  Estimated runtime of original DAG is 13796.068906784058ms
2022-09-21 05:10:46 WARNING Skipping Multi-Query Optimization (instead, only combine execution DAGs)
2022-09-21 05:10:46 INFO  Estimated unoptimised what-if runtime is 344901.72266960144ms
2022-09-21 05:10:46 INFO  ---RUNTIME: Multi-Query Optimization took 154.42681312561035 ms
2022-09-21 05:10:46 INFO  Executing generated plans
2022-09-21 05:16:52 INFO  ---RUNTIME: Execution took 366588.0072116852 ms
2022-09-21 05:16:52 INFO  Done!
2022-09-21 05:16:52 INFO  # Finished -- repetition 5 of 7 
2022-09-21 05:16:52 INFO  # Optimization benchmark for data_corruption with args [['reviews', 'slow_loading', 'featurization_4', 'neural_network']] -- repetition 6 of 7
2022-09-21 05:16:52 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-21 05:16:52 INFO  Running instrumented original pipeline...
2022-09-21 05:16:52 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-21 05:16:52 INFO  ---RUNTIME: Importing and monkey-patching took 5.936384201049805 ms
2022-09-21 05:17:11 INFO  ---RUNTIME: Original pipeline execution took 18532.87672996521 ms (excluding imports and monkey-patching)
2022-09-21 05:17:11 INFO  Starting execution of 1 what-if analyses...
2022-09-21 05:17:11 INFO  Start plan generation for analysis DataCorruption...
2022-09-21 05:17:11 INFO  ---RUNTIME: Plan generation took 0.4291534423828125 ms
2022-09-21 05:17:11 INFO  Estimated runtime of original DAG is 15121.06204032898ms
2022-09-21 05:17:11 INFO  Performing Multi-Query Optimization
2022-09-21 05:17:11 INFO  Estimated unoptimized what-if runtime is 378026.5510082245ms
2022-09-21 05:17:11 INFO  Estimated optimised what-if runtime is 25599.297761917114ms
2022-09-21 05:17:11 INFO  Estimated optimisation runtime saving is 352427.2532463074ms
2022-09-21 05:17:11 INFO  ---RUNTIME: Multi-Query Optimization took 69.07463073730469 ms
2022-09-21 05:17:11 INFO  Executing generated plans
2022-09-21 05:17:40 INFO  ---RUNTIME: Execution took 28669.824600219727 ms
2022-09-21 05:17:40 INFO  Done!
2022-09-21 05:17:40 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-21 05:17:40 INFO  Running instrumented original pipeline...
2022-09-21 05:17:40 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-21 05:17:40 INFO  ---RUNTIME: Importing and monkey-patching took 5.974292755126953 ms
2022-09-21 05:17:57 INFO  ---RUNTIME: Original pipeline execution took 17431.226015090942 ms (excluding imports and monkey-patching)
2022-09-21 05:17:57 INFO  Starting execution of 1 what-if analyses...
2022-09-21 05:17:57 INFO  Start plan generation for analysis DataCorruption...
2022-09-21 05:17:57 INFO  ---RUNTIME: Plan generation took 0.5121231079101562 ms
2022-09-21 05:17:57 INFO  Estimated runtime of original DAG is 13565.692663192749ms
2022-09-21 05:17:57 WARNING Skipping Multi-Query Optimization (instead, only combine execution DAGs)
2022-09-21 05:17:57 INFO  Estimated unoptimised what-if runtime is 339142.3165798187ms
2022-09-21 05:17:57 INFO  ---RUNTIME: Multi-Query Optimization took 157.3193073272705 ms
2022-09-21 05:17:57 INFO  Executing generated plans
2022-09-21 05:24:14 INFO  ---RUNTIME: Execution took 377015.2893066406 ms
2022-09-21 05:24:14 INFO  Done!
2022-09-21 05:24:14 INFO  # Finished -- repetition 6 of 7 
2022-09-21 05:24:14 INFO  # Optimization benchmark for data_corruption with args [['reviews', 'slow_loading', 'featurization_4', 'neural_network']] -- repetition 7 of 7
2022-09-21 05:24:14 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-21 05:24:14 INFO  Running instrumented original pipeline...
2022-09-21 05:24:14 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-21 05:24:14 INFO  ---RUNTIME: Importing and monkey-patching took 5.954265594482422 ms
2022-09-21 05:24:32 INFO  ---RUNTIME: Original pipeline execution took 17602.434396743774 ms (excluding imports and monkey-patching)
2022-09-21 05:24:32 INFO  Starting execution of 1 what-if analyses...
2022-09-21 05:24:32 INFO  Start plan generation for analysis DataCorruption...
2022-09-21 05:24:32 INFO  ---RUNTIME: Plan generation took 0.38242340087890625 ms
2022-09-21 05:24:32 INFO  Estimated runtime of original DAG is 14169.082880020142ms
2022-09-21 05:24:32 INFO  Performing Multi-Query Optimization
2022-09-21 05:24:32 INFO  Estimated unoptimized what-if runtime is 354227.07200050354ms
2022-09-21 05:24:32 INFO  Estimated optimised what-if runtime is 25285.80617904663ms
2022-09-21 05:24:32 INFO  Estimated optimisation runtime saving is 328941.2658214569ms
2022-09-21 05:24:32 INFO  ---RUNTIME: Multi-Query Optimization took 69.70858573913574 ms
2022-09-21 05:24:32 INFO  Executing generated plans
2022-09-21 05:25:01 INFO  ---RUNTIME: Execution took 29424.299716949463 ms
2022-09-21 05:25:01 INFO  Done!
2022-09-21 05:25:01 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-21 05:25:01 INFO  Running instrumented original pipeline...
2022-09-21 05:25:01 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-21 05:25:01 INFO  ---RUNTIME: Importing and monkey-patching took 6.539344787597656 ms
2022-09-21 05:25:18 INFO  ---RUNTIME: Original pipeline execution took 17001.221895217896 ms (excluding imports and monkey-patching)
2022-09-21 05:25:18 INFO  Starting execution of 1 what-if analyses...
2022-09-21 05:25:18 INFO  Start plan generation for analysis DataCorruption...
2022-09-21 05:25:18 INFO  ---RUNTIME: Plan generation took 0.4470348358154297 ms
2022-09-21 05:25:18 INFO  Estimated runtime of original DAG is 13573.057651519775ms
2022-09-21 05:25:18 WARNING Skipping Multi-Query Optimization (instead, only combine execution DAGs)
2022-09-21 05:25:19 INFO  Estimated unoptimised what-if runtime is 339326.4412879944ms
2022-09-21 05:25:19 INFO  ---RUNTIME: Multi-Query Optimization took 185.74094772338867 ms
2022-09-21 05:25:19 INFO  Executing generated plans
2022-09-21 05:31:35 INFO  ---RUNTIME: Execution took 376238.54207992554 ms
2022-09-21 05:31:35 INFO  Done!
2022-09-21 05:31:35 INFO  # Finished -- repetition 7 of 7 
2022-09-21 05:31:35 INFO  # Final results after all repetitions
2022-09-21 05:31:35 INFO     repetition  ... no_opt_what_if_execution_combined_model_training
0           0  ...                                     83786.729336
1           1  ...                                     83498.229265
2           2  ...                                     84282.293558
3           3  ...                                     86374.088287
4           4  ...                                     83224.184752
5           5  ...                                     87196.011543
6           6  ...                                     85640.930414

[7 rows x 26 columns]
taskset -c 160-168 PROTOCOL_BUFFERS_PYTHON_IMPLEMENTATION=python python3.9 benchmarks_end_to_end.py feature_importance reviews slow_loading featurization_0 logistic_regression
2022-09-21 05:31:38.323526: W tensorflow/stream_executor/platform/default/dso_loader.cc:64] Could not load dynamic library 'libcudart.so.11.0'; dlerror: libcudart.so.11.0: cannot open shared object file: No such file or directory; LD_LIBRARY_PATH: /home/sgrafbe/mlwhatif/venv/lib/python3.9/site-packages/cv2/../../lib64:
2022-09-21 05:31:38.323574: I tensorflow/stream_executor/cuda/cudart_stub.cc:29] Ignore above cudart dlerror if you do not have a GPU set up on your machine.
2022-09-21 05:31:39 INFO  Patching sys.argv with ['mlwhatif', 'reviews', 'slow_loading', 'featurization_0', 'logistic_regression']
2022-09-21 05:31:39 INFO  Running instrumented original pipeline...
2022-09-21 05:31:39 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-21 05:31:39 INFO  ---RUNTIME: Importing and monkey-patching took 138.3969783782959 ms
2022-09-21 05:31:47 INFO  ---RUNTIME: Original pipeline execution took 7999.791383743286 ms (excluding imports and monkey-patching)
2022-09-21 05:31:47 INFO  Starting execution of 0 what-if analyses...
2022-09-21 05:31:47 INFO  Estimated runtime of original DAG is 6221.689224243164ms
2022-09-21 05:31:47 INFO  Performing Multi-Query Optimization
2022-09-21 05:31:47 INFO  Estimated unoptimized what-if runtime is 0ms
2022-09-21 05:31:47 INFO  Estimated optimised what-if runtime is 0ms
2022-09-21 05:31:47 INFO  Estimated optimisation runtime saving is 0ms
2022-09-21 05:31:47 INFO  ---RUNTIME: Multi-Query Optimization took 0.5147457122802734 ms
2022-09-21 05:31:47 INFO  Executing generated plans
2022-09-21 05:31:47 INFO  ---RUNTIME: Execution took 0.025510787963867188 ms
2022-09-21 05:31:47 INFO  Done!
2022-09-21 05:31:47 INFO  # Optimization benchmark for feature_importance with args [['reviews', 'slow_loading', 'featurization_0', 'logistic_regression']] -- repetition 1 of 7
2022-09-21 05:31:47 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-21 05:31:47 INFO  Running instrumented original pipeline...
2022-09-21 05:31:48 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-21 05:31:48 INFO  ---RUNTIME: Importing and monkey-patching took 6.020545959472656 ms
2022-09-21 05:31:55 INFO  ---RUNTIME: Original pipeline execution took 7406.016826629639 ms (excluding imports and monkey-patching)
2022-09-21 05:31:55 INFO  Starting execution of 1 what-if analyses...
2022-09-21 05:31:55 INFO  Start plan generation for analysis PermutationFeatureImportance...
2022-09-21 05:31:55 INFO  ---RUNTIME: Plan generation took 0.2033710479736328 ms
2022-09-21 05:31:55 INFO  Estimated runtime of original DAG is 5530.045747756958ms
2022-09-21 05:31:55 INFO  Performing Multi-Query Optimization
2022-09-21 05:31:55 INFO  Estimated unoptimized what-if runtime is 27650.22873878479ms
2022-09-21 05:31:55 INFO  Estimated optimised what-if runtime is 6882.734775543213ms
2022-09-21 05:31:55 INFO  Estimated optimisation runtime saving is 20767.493963241577ms
2022-09-21 05:31:55 INFO  ---RUNTIME: Multi-Query Optimization took 10.019063949584961 ms
2022-09-21 05:31:55 INFO  Executing generated plans
2022-09-21 05:32:02 INFO  ---RUNTIME: Execution took 7575.599908828735 ms
2022-09-21 05:32:02 INFO  Done!
2022-09-21 05:32:02 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-21 05:32:02 INFO  Running instrumented original pipeline...
2022-09-21 05:32:02 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-21 05:32:02 INFO  ---RUNTIME: Importing and monkey-patching took 6.622314453125 ms
2022-09-21 05:32:09 INFO  ---RUNTIME: Original pipeline execution took 7045.683145523071 ms (excluding imports and monkey-patching)
2022-09-21 05:32:09 INFO  Starting execution of 1 what-if analyses...
2022-09-21 05:32:09 INFO  Start plan generation for analysis PermutationFeatureImportance...
2022-09-21 05:32:09 INFO  ---RUNTIME: Plan generation took 0.12946128845214844 ms
2022-09-21 05:32:09 INFO  Estimated runtime of original DAG is 5391.603708267212ms
2022-09-21 05:32:09 WARNING Skipping Multi-Query Optimization (instead, only combine execution DAGs)
2022-09-21 05:32:09 INFO  Estimated unoptimised what-if runtime is 26958.01854133606ms
2022-09-21 05:32:09 INFO  ---RUNTIME: Multi-Query Optimization took 13.385534286499023 ms
2022-09-21 05:32:09 INFO  Executing generated plans
2022-09-21 05:32:40 INFO  ---RUNTIME: Execution took 31099.629640579224 ms
2022-09-21 05:32:40 INFO  Done!
2022-09-21 05:32:40 INFO  # Finished -- repetition 1 of 7 
2022-09-21 05:32:40 INFO  # Optimization benchmark for feature_importance with args [['reviews', 'slow_loading', 'featurization_0', 'logistic_regression']] -- repetition 2 of 7
2022-09-21 05:32:40 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-21 05:32:40 INFO  Running instrumented original pipeline...
2022-09-21 05:32:41 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-21 05:32:41 INFO  ---RUNTIME: Importing and monkey-patching took 6.279945373535156 ms
2022-09-21 05:32:47 INFO  ---RUNTIME: Original pipeline execution took 6927.3693561553955 ms (excluding imports and monkey-patching)
2022-09-21 05:32:47 INFO  Starting execution of 1 what-if analyses...
2022-09-21 05:32:47 INFO  Start plan generation for analysis PermutationFeatureImportance...
2022-09-21 05:32:47 INFO  ---RUNTIME: Plan generation took 0.12159347534179688 ms
2022-09-21 05:32:47 INFO  Estimated runtime of original DAG is 5282.184362411499ms
2022-09-21 05:32:47 INFO  Performing Multi-Query Optimization
2022-09-21 05:32:47 INFO  Estimated unoptimized what-if runtime is 26410.921812057495ms
2022-09-21 05:32:47 INFO  Estimated optimised what-if runtime is 6602.141380310059ms
2022-09-21 05:32:47 INFO  Estimated optimisation runtime saving is 19808.780431747437ms
2022-09-21 05:32:47 INFO  ---RUNTIME: Multi-Query Optimization took 9.492874145507812 ms
2022-09-21 05:32:47 INFO  Executing generated plans
2022-09-21 05:32:55 INFO  ---RUNTIME: Execution took 7494.006633758545 ms
2022-09-21 05:32:55 INFO  Done!
2022-09-21 05:32:55 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-21 05:32:55 INFO  Running instrumented original pipeline...
2022-09-21 05:32:55 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-21 05:32:55 INFO  ---RUNTIME: Importing and monkey-patching took 5.914211273193359 ms
2022-09-21 05:33:02 INFO  ---RUNTIME: Original pipeline execution took 7224.970579147339 ms (excluding imports and monkey-patching)
2022-09-21 05:33:02 INFO  Starting execution of 1 what-if analyses...
2022-09-21 05:33:02 INFO  Start plan generation for analysis PermutationFeatureImportance...
2022-09-21 05:33:02 INFO  ---RUNTIME: Plan generation took 0.10609626770019531 ms
2022-09-21 05:33:02 INFO  Estimated runtime of original DAG is 5503.151893615723ms
2022-09-21 05:33:02 WARNING Skipping Multi-Query Optimization (instead, only combine execution DAGs)
2022-09-21 05:33:02 INFO  Estimated unoptimised what-if runtime is 27515.759468078613ms
2022-09-21 05:33:02 INFO  ---RUNTIME: Multi-Query Optimization took 13.539552688598633 ms
2022-09-21 05:33:02 INFO  Executing generated plans
2022-09-21 05:33:34 INFO  ---RUNTIME: Execution took 31430.39846420288 ms
2022-09-21 05:33:34 INFO  Done!
2022-09-21 05:33:34 INFO  # Finished -- repetition 2 of 7 
2022-09-21 05:33:34 INFO  # Optimization benchmark for feature_importance with args [['reviews', 'slow_loading', 'featurization_0', 'logistic_regression']] -- repetition 3 of 7
2022-09-21 05:33:34 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-21 05:33:34 INFO  Running instrumented original pipeline...
2022-09-21 05:33:34 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-21 05:33:34 INFO  ---RUNTIME: Importing and monkey-patching took 6.670951843261719 ms
2022-09-21 05:33:41 INFO  ---RUNTIME: Original pipeline execution took 7003.687620162964 ms (excluding imports and monkey-patching)
2022-09-21 05:33:41 INFO  Starting execution of 1 what-if analyses...
2022-09-21 05:33:41 INFO  Start plan generation for analysis PermutationFeatureImportance...
2022-09-21 05:33:41 INFO  ---RUNTIME: Plan generation took 0.12373924255371094 ms
2022-09-21 05:33:41 INFO  Estimated runtime of original DAG is 5341.732740402222ms
2022-09-21 05:33:41 INFO  Performing Multi-Query Optimization
2022-09-21 05:33:41 INFO  Estimated unoptimized what-if runtime is 26708.66370201111ms
2022-09-21 05:33:41 INFO  Estimated optimised what-if runtime is 6661.491394042969ms
2022-09-21 05:33:41 INFO  Estimated optimisation runtime saving is 20047.17230796814ms
2022-09-21 05:33:41 INFO  ---RUNTIME: Multi-Query Optimization took 9.473800659179688 ms
2022-09-21 05:33:41 INFO  Executing generated plans
2022-09-21 05:33:48 INFO  ---RUNTIME: Execution took 7709.249258041382 ms
2022-09-21 05:33:48 INFO  Done!
2022-09-21 05:33:48 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-21 05:33:48 INFO  Running instrumented original pipeline...
2022-09-21 05:33:48 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-21 05:33:48 INFO  ---RUNTIME: Importing and monkey-patching took 5.723476409912109 ms
2022-09-21 05:33:55 INFO  ---RUNTIME: Original pipeline execution took 6958.3587646484375 ms (excluding imports and monkey-patching)
2022-09-21 05:33:55 INFO  Starting execution of 1 what-if analyses...
2022-09-21 05:33:55 INFO  Start plan generation for analysis PermutationFeatureImportance...
2022-09-21 05:33:55 INFO  ---RUNTIME: Plan generation took 0.11563301086425781 ms
2022-09-21 05:33:55 INFO  Estimated runtime of original DAG is 5301.40495300293ms
2022-09-21 05:33:55 WARNING Skipping Multi-Query Optimization (instead, only combine execution DAGs)
2022-09-21 05:33:55 INFO  Estimated unoptimised what-if runtime is 26507.02476501465ms
2022-09-21 05:33:55 INFO  ---RUNTIME: Multi-Query Optimization took 13.366222381591797 ms
2022-09-21 05:33:55 INFO  Executing generated plans
2022-09-21 05:34:26 INFO  ---RUNTIME: Execution took 31097.980976104736 ms
2022-09-21 05:34:26 INFO  Done!
2022-09-21 05:34:26 INFO  # Finished -- repetition 3 of 7 
2022-09-21 05:34:26 INFO  # Optimization benchmark for feature_importance with args [['reviews', 'slow_loading', 'featurization_0', 'logistic_regression']] -- repetition 4 of 7
2022-09-21 05:34:26 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-21 05:34:26 INFO  Running instrumented original pipeline...
2022-09-21 05:34:26 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-21 05:34:26 INFO  ---RUNTIME: Importing and monkey-patching took 6.71696662902832 ms
2022-09-21 05:34:34 INFO  ---RUNTIME: Original pipeline execution took 7460.816383361816 ms (excluding imports and monkey-patching)
2022-09-21 05:34:34 INFO  Starting execution of 1 what-if analyses...
2022-09-21 05:34:34 INFO  Start plan generation for analysis PermutationFeatureImportance...
2022-09-21 05:34:34 INFO  ---RUNTIME: Plan generation took 0.11205673217773438 ms
2022-09-21 05:34:34 INFO  Estimated runtime of original DAG is 5443.445682525635ms
2022-09-21 05:34:34 INFO  Performing Multi-Query Optimization
2022-09-21 05:34:34 INFO  Estimated unoptimized what-if runtime is 27217.228412628174ms
2022-09-21 05:34:34 INFO  Estimated optimised what-if runtime is 6777.092456817627ms
2022-09-21 05:34:34 INFO  Estimated optimisation runtime saving is 20440.135955810547ms
2022-09-21 05:34:34 INFO  ---RUNTIME: Multi-Query Optimization took 9.386539459228516 ms
2022-09-21 05:34:34 INFO  Executing generated plans
2022-09-21 05:34:42 INFO  ---RUNTIME: Execution took 7791.579246520996 ms
2022-09-21 05:34:42 INFO  Done!
2022-09-21 05:34:42 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-21 05:34:42 INFO  Running instrumented original pipeline...
2022-09-21 05:34:42 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-21 05:34:42 INFO  ---RUNTIME: Importing and monkey-patching took 6.2618255615234375 ms
2022-09-21 05:34:49 INFO  ---RUNTIME: Original pipeline execution took 7053.055286407471 ms (excluding imports and monkey-patching)
2022-09-21 05:34:49 INFO  Starting execution of 1 what-if analyses...
2022-09-21 05:34:49 INFO  Start plan generation for analysis PermutationFeatureImportance...
2022-09-21 05:34:49 INFO  ---RUNTIME: Plan generation took 0.10895729064941406 ms
2022-09-21 05:34:49 INFO  Estimated runtime of original DAG is 5344.909429550171ms
2022-09-21 05:34:49 WARNING Skipping Multi-Query Optimization (instead, only combine execution DAGs)
2022-09-21 05:34:49 INFO  Estimated unoptimised what-if runtime is 26724.547147750854ms
2022-09-21 05:34:49 INFO  ---RUNTIME: Multi-Query Optimization took 13.292074203491211 ms
2022-09-21 05:34:49 INFO  Executing generated plans
2022-09-21 05:35:20 INFO  ---RUNTIME: Execution took 31167.97113418579 ms
2022-09-21 05:35:20 INFO  Done!
2022-09-21 05:35:20 INFO  # Finished -- repetition 4 of 7 
2022-09-21 05:35:20 INFO  # Optimization benchmark for feature_importance with args [['reviews', 'slow_loading', 'featurization_0', 'logistic_regression']] -- repetition 5 of 7
2022-09-21 05:35:20 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-21 05:35:20 INFO  Running instrumented original pipeline...
2022-09-21 05:35:20 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-21 05:35:20 INFO  ---RUNTIME: Importing and monkey-patching took 6.104230880737305 ms
2022-09-21 05:35:27 INFO  ---RUNTIME: Original pipeline execution took 7029.528379440308 ms (excluding imports and monkey-patching)
2022-09-21 05:35:27 INFO  Starting execution of 1 what-if analyses...
2022-09-21 05:35:27 INFO  Start plan generation for analysis PermutationFeatureImportance...
2022-09-21 05:35:27 INFO  ---RUNTIME: Plan generation took 0.1423358917236328 ms
2022-09-21 05:35:27 INFO  Estimated runtime of original DAG is 5321.232080459595ms
2022-09-21 05:35:27 INFO  Performing Multi-Query Optimization
2022-09-21 05:35:27 INFO  Estimated unoptimized what-if runtime is 26606.160402297974ms
2022-09-21 05:35:27 INFO  Estimated optimised what-if runtime is 6638.010740280151ms
2022-09-21 05:35:27 INFO  Estimated optimisation runtime saving is 19968.149662017822ms
2022-09-21 05:35:27 INFO  ---RUNTIME: Multi-Query Optimization took 9.561777114868164 ms
2022-09-21 05:35:27 INFO  Executing generated plans
2022-09-21 05:35:35 INFO  ---RUNTIME: Execution took 7663.708925247192 ms
2022-09-21 05:35:35 INFO  Done!
2022-09-21 05:35:35 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-21 05:35:35 INFO  Running instrumented original pipeline...
2022-09-21 05:35:35 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-21 05:35:35 INFO  ---RUNTIME: Importing and monkey-patching took 6.473779678344727 ms
2022-09-21 05:35:42 INFO  ---RUNTIME: Original pipeline execution took 7267.120122909546 ms (excluding imports and monkey-patching)
2022-09-21 05:35:42 INFO  Starting execution of 1 what-if analyses...
2022-09-21 05:35:42 INFO  Start plan generation for analysis PermutationFeatureImportance...
2022-09-21 05:35:42 INFO  ---RUNTIME: Plan generation took 0.1125335693359375 ms
2022-09-21 05:35:42 INFO  Estimated runtime of original DAG is 5552.775621414185ms
2022-09-21 05:35:42 WARNING Skipping Multi-Query Optimization (instead, only combine execution DAGs)
2022-09-21 05:35:42 INFO  Estimated unoptimised what-if runtime is 27763.878107070923ms
2022-09-21 05:35:42 INFO  ---RUNTIME: Multi-Query Optimization took 14.636993408203125 ms
2022-09-21 05:35:42 INFO  Executing generated plans
2022-09-21 05:36:13 INFO  ---RUNTIME: Execution took 30979.048490524292 ms
2022-09-21 05:36:13 INFO  Done!
2022-09-21 05:36:13 INFO  # Finished -- repetition 5 of 7 
2022-09-21 05:36:13 INFO  # Optimization benchmark for feature_importance with args [['reviews', 'slow_loading', 'featurization_0', 'logistic_regression']] -- repetition 6 of 7
2022-09-21 05:36:13 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-21 05:36:13 INFO  Running instrumented original pipeline...
2022-09-21 05:36:13 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-21 05:36:13 INFO  ---RUNTIME: Importing and monkey-patching took 5.985021591186523 ms
2022-09-21 05:36:20 INFO  ---RUNTIME: Original pipeline execution took 7005.68151473999 ms (excluding imports and monkey-patching)
2022-09-21 05:36:20 INFO  Starting execution of 1 what-if analyses...
2022-09-21 05:36:20 INFO  Start plan generation for analysis PermutationFeatureImportance...
2022-09-21 05:36:20 INFO  ---RUNTIME: Plan generation took 0.118255615234375 ms
2022-09-21 05:36:20 INFO  Estimated runtime of original DAG is 5321.2645053863525ms
2022-09-21 05:36:20 INFO  Performing Multi-Query Optimization
2022-09-21 05:36:20 INFO  Estimated unoptimized what-if runtime is 26606.322526931763ms
2022-09-21 05:36:20 INFO  Estimated optimised what-if runtime is 6638.134241104126ms
2022-09-21 05:36:20 INFO  Estimated optimisation runtime saving is 19968.188285827637ms
2022-09-21 05:36:20 INFO  ---RUNTIME: Multi-Query Optimization took 9.428977966308594 ms
2022-09-21 05:36:20 INFO  Executing generated plans
2022-09-21 05:36:27 INFO  ---RUNTIME: Execution took 7533.400774002075 ms
2022-09-21 05:36:27 INFO  Done!
2022-09-21 05:36:27 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-21 05:36:27 INFO  Running instrumented original pipeline...
2022-09-21 05:36:28 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-21 05:36:28 INFO  ---RUNTIME: Importing and monkey-patching took 5.769491195678711 ms
2022-09-21 05:36:35 INFO  ---RUNTIME: Original pipeline execution took 7004.324674606323 ms (excluding imports and monkey-patching)
2022-09-21 05:36:35 INFO  Starting execution of 1 what-if analyses...
2022-09-21 05:36:35 INFO  Start plan generation for analysis PermutationFeatureImportance...
2022-09-21 05:36:35 INFO  ---RUNTIME: Plan generation took 0.11754035949707031 ms
2022-09-21 05:36:35 INFO  Estimated runtime of original DAG is 5331.294298171997ms
2022-09-21 05:36:35 WARNING Skipping Multi-Query Optimization (instead, only combine execution DAGs)
2022-09-21 05:36:35 INFO  Estimated unoptimised what-if runtime is 26656.471490859985ms
2022-09-21 05:36:35 INFO  ---RUNTIME: Multi-Query Optimization took 13.42153549194336 ms
2022-09-21 05:36:35 INFO  Executing generated plans
2022-09-21 05:37:06 INFO  ---RUNTIME: Execution took 31390.169620513916 ms
2022-09-21 05:37:06 INFO  Done!
2022-09-21 05:37:06 INFO  # Finished -- repetition 6 of 7 
2022-09-21 05:37:06 INFO  # Optimization benchmark for feature_importance with args [['reviews', 'slow_loading', 'featurization_0', 'logistic_regression']] -- repetition 7 of 7
2022-09-21 05:37:06 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-21 05:37:06 INFO  Running instrumented original pipeline...
2022-09-21 05:37:06 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-21 05:37:06 INFO  ---RUNTIME: Importing and monkey-patching took 6.312131881713867 ms
2022-09-21 05:37:13 INFO  ---RUNTIME: Original pipeline execution took 6998.279333114624 ms (excluding imports and monkey-patching)
2022-09-21 05:37:13 INFO  Starting execution of 1 what-if analyses...
2022-09-21 05:37:13 INFO  Start plan generation for analysis PermutationFeatureImportance...
2022-09-21 05:37:13 INFO  ---RUNTIME: Plan generation took 0.1251697540283203 ms
2022-09-21 05:37:13 INFO  Estimated runtime of original DAG is 5316.164016723633ms
2022-09-21 05:37:13 INFO  Performing Multi-Query Optimization
2022-09-21 05:37:13 INFO  Estimated unoptimized what-if runtime is 26580.820083618164ms
2022-09-21 05:37:13 INFO  Estimated optimised what-if runtime is 6637.204885482788ms
2022-09-21 05:37:13 INFO  Estimated optimisation runtime saving is 19943.615198135376ms
2022-09-21 05:37:13 INFO  ---RUNTIME: Multi-Query Optimization took 9.430646896362305 ms
2022-09-21 05:37:13 INFO  Executing generated plans
2022-09-21 05:37:20 INFO  ---RUNTIME: Execution took 7554.74853515625 ms
2022-09-21 05:37:20 INFO  Done!
2022-09-21 05:37:20 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-21 05:37:20 INFO  Running instrumented original pipeline...
2022-09-21 05:37:21 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-21 05:37:21 INFO  ---RUNTIME: Importing and monkey-patching took 5.7964324951171875 ms
2022-09-21 05:37:28 INFO  ---RUNTIME: Original pipeline execution took 7040.409564971924 ms (excluding imports and monkey-patching)
2022-09-21 05:37:28 INFO  Starting execution of 1 what-if analyses...
2022-09-21 05:37:28 INFO  Start plan generation for analysis PermutationFeatureImportance...
2022-09-21 05:37:28 INFO  ---RUNTIME: Plan generation took 0.13899803161621094 ms
2022-09-21 05:37:28 INFO  Estimated runtime of original DAG is 5344.588279724121ms
2022-09-21 05:37:28 WARNING Skipping Multi-Query Optimization (instead, only combine execution DAGs)
2022-09-21 05:37:28 INFO  Estimated unoptimised what-if runtime is 26722.941398620605ms
2022-09-21 05:37:28 INFO  ---RUNTIME: Multi-Query Optimization took 13.756752014160156 ms
2022-09-21 05:37:28 INFO  Executing generated plans
2022-09-21 05:37:58 INFO  ---RUNTIME: Execution took 30699.283123016357 ms
2022-09-21 05:37:58 INFO  Done!
2022-09-21 05:37:58 INFO  # Finished -- repetition 7 of 7 
2022-09-21 05:37:58 INFO  # Final results after all repetitions
2022-09-21 05:37:58 INFO     repetition  ... no_opt_what_if_execution_combined_model_training
0           0  ...                                       839.755297
1           1  ...                                       879.650116
2           2  ...                                       891.449690
3           3  ...                                       839.069605
4           4  ...                                       839.187384
5           5  ...                                       837.518930
6           6  ...                                       841.558456

[7 rows x 26 columns]
taskset -c 160-168 PROTOCOL_BUFFERS_PYTHON_IMPLEMENTATION=python python3.9 benchmarks_end_to_end.py feature_importance reviews slow_loading featurization_0 xgboost
2022-09-21 05:38:01.042117: W tensorflow/stream_executor/platform/default/dso_loader.cc:64] Could not load dynamic library 'libcudart.so.11.0'; dlerror: libcudart.so.11.0: cannot open shared object file: No such file or directory; LD_LIBRARY_PATH: /home/sgrafbe/mlwhatif/venv/lib/python3.9/site-packages/cv2/../../lib64:
2022-09-21 05:38:01.042167: I tensorflow/stream_executor/cuda/cudart_stub.cc:29] Ignore above cudart dlerror if you do not have a GPU set up on your machine.
2022-09-21 05:38:02 INFO  Patching sys.argv with ['mlwhatif', 'reviews', 'slow_loading', 'featurization_0', 'xgboost']
2022-09-21 05:38:02 INFO  Running instrumented original pipeline...
2022-09-21 05:38:02 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-21 05:38:02 INFO  ---RUNTIME: Importing and monkey-patching took 121.18864059448242 ms
2022-09-21 05:38:23 INFO  ---RUNTIME: Original pipeline execution took 21118.464946746826 ms (excluding imports and monkey-patching)
2022-09-21 05:38:23 INFO  Starting execution of 0 what-if analyses...
2022-09-21 05:38:23 INFO  Estimated runtime of original DAG is 19464.91575241089ms
2022-09-21 05:38:23 INFO  Performing Multi-Query Optimization
2022-09-21 05:38:23 INFO  Estimated unoptimized what-if runtime is 0ms
2022-09-21 05:38:23 INFO  Estimated optimised what-if runtime is 0ms
2022-09-21 05:38:23 INFO  Estimated optimisation runtime saving is 0ms
2022-09-21 05:38:23 INFO  ---RUNTIME: Multi-Query Optimization took 0.49591064453125 ms
2022-09-21 05:38:23 INFO  Executing generated plans
2022-09-21 05:38:23 INFO  ---RUNTIME: Execution took 0.0247955322265625 ms
2022-09-21 05:38:23 INFO  Done!
2022-09-21 05:38:23 INFO  # Optimization benchmark for feature_importance with args [['reviews', 'slow_loading', 'featurization_0', 'xgboost']] -- repetition 1 of 7
2022-09-21 05:38:23 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-21 05:38:23 INFO  Running instrumented original pipeline...
2022-09-21 05:38:23 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-21 05:38:23 INFO  ---RUNTIME: Importing and monkey-patching took 5.778312683105469 ms
2022-09-21 05:38:31 INFO  ---RUNTIME: Original pipeline execution took 7631.921768188477 ms (excluding imports and monkey-patching)
2022-09-21 05:38:31 INFO  Starting execution of 1 what-if analyses...
2022-09-21 05:38:31 INFO  Start plan generation for analysis PermutationFeatureImportance...
2022-09-21 05:38:31 INFO  ---RUNTIME: Plan generation took 0.1666545867919922 ms
2022-09-21 05:38:31 INFO  Estimated runtime of original DAG is 5855.5004596710205ms
2022-09-21 05:38:31 INFO  Performing Multi-Query Optimization
2022-09-21 05:38:31 INFO  Estimated unoptimized what-if runtime is 29277.502298355103ms
2022-09-21 05:38:31 INFO  Estimated optimised what-if runtime is 7343.259811401367ms
2022-09-21 05:38:31 INFO  Estimated optimisation runtime saving is 21934.242486953735ms
2022-09-21 05:38:31 INFO  ---RUNTIME: Multi-Query Optimization took 9.265422821044922 ms
2022-09-21 05:38:31 INFO  Executing generated plans
2022-09-21 05:38:39 INFO  ---RUNTIME: Execution took 8212.47911453247 ms
2022-09-21 05:38:39 INFO  Done!
2022-09-21 05:38:39 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-21 05:38:39 INFO  Running instrumented original pipeline...
2022-09-21 05:38:39 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-21 05:38:39 INFO  ---RUNTIME: Importing and monkey-patching took 6.013631820678711 ms
2022-09-21 05:38:46 INFO  ---RUNTIME: Original pipeline execution took 7481.199264526367 ms (excluding imports and monkey-patching)
2022-09-21 05:38:46 INFO  Starting execution of 1 what-if analyses...
2022-09-21 05:38:46 INFO  Start plan generation for analysis PermutationFeatureImportance...
2022-09-21 05:38:46 INFO  ---RUNTIME: Plan generation took 0.1308917999267578 ms
2022-09-21 05:38:46 INFO  Estimated runtime of original DAG is 5856.195688247681ms
2022-09-21 05:38:46 WARNING Skipping Multi-Query Optimization (instead, only combine execution DAGs)
2022-09-21 05:38:46 INFO  Estimated unoptimised what-if runtime is 29280.978441238403ms
2022-09-21 05:38:46 INFO  ---RUNTIME: Multi-Query Optimization took 13.241291046142578 ms
2022-09-21 05:38:46 INFO  Executing generated plans
2022-09-21 05:39:20 INFO  ---RUNTIME: Execution took 33463.63806724548 ms
2022-09-21 05:39:20 INFO  Done!
2022-09-21 05:39:20 INFO  # Finished -- repetition 1 of 7 
2022-09-21 05:39:20 INFO  # Optimization benchmark for feature_importance with args [['reviews', 'slow_loading', 'featurization_0', 'xgboost']] -- repetition 2 of 7
2022-09-21 05:39:20 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-21 05:39:20 INFO  Running instrumented original pipeline...
2022-09-21 05:39:20 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-21 05:39:20 INFO  ---RUNTIME: Importing and monkey-patching took 6.332635879516602 ms
2022-09-21 05:39:27 INFO  ---RUNTIME: Original pipeline execution took 7491.6651248931885 ms (excluding imports and monkey-patching)
2022-09-21 05:39:27 INFO  Starting execution of 1 what-if analyses...
2022-09-21 05:39:27 INFO  Start plan generation for analysis PermutationFeatureImportance...
2022-09-21 05:39:27 INFO  ---RUNTIME: Plan generation took 0.12087821960449219 ms
2022-09-21 05:39:27 INFO  Estimated runtime of original DAG is 5844.914436340332ms
2022-09-21 05:39:27 INFO  Performing Multi-Query Optimization
2022-09-21 05:39:27 INFO  Estimated unoptimized what-if runtime is 29224.57218170166ms
2022-09-21 05:39:27 INFO  Estimated optimised what-if runtime is 7320.417642593384ms
2022-09-21 05:39:27 INFO  Estimated optimisation runtime saving is 21904.154539108276ms
2022-09-21 05:39:27 INFO  ---RUNTIME: Multi-Query Optimization took 9.36579704284668 ms
2022-09-21 05:39:27 INFO  Executing generated plans
2022-09-21 05:39:36 INFO  ---RUNTIME: Execution took 8235.742568969727 ms
2022-09-21 05:39:36 INFO  Done!
2022-09-21 05:39:36 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-21 05:39:36 INFO  Running instrumented original pipeline...
2022-09-21 05:39:36 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-21 05:39:36 INFO  ---RUNTIME: Importing and monkey-patching took 5.778312683105469 ms
2022-09-21 05:39:43 INFO  ---RUNTIME: Original pipeline execution took 7515.259265899658 ms (excluding imports and monkey-patching)
2022-09-21 05:39:43 INFO  Starting execution of 1 what-if analyses...
2022-09-21 05:39:43 INFO  Start plan generation for analysis PermutationFeatureImportance...
2022-09-21 05:39:43 INFO  ---RUNTIME: Plan generation took 0.12493133544921875 ms
2022-09-21 05:39:43 INFO  Estimated runtime of original DAG is 5864.849328994751ms
2022-09-21 05:39:43 WARNING Skipping Multi-Query Optimization (instead, only combine execution DAGs)
2022-09-21 05:39:43 INFO  Estimated unoptimised what-if runtime is 29324.246644973755ms
2022-09-21 05:39:43 INFO  ---RUNTIME: Multi-Query Optimization took 13.324975967407227 ms
2022-09-21 05:39:43 INFO  Executing generated plans
2022-09-21 05:40:17 INFO  ---RUNTIME: Execution took 33502.66623497009 ms
2022-09-21 05:40:17 INFO  Done!
2022-09-21 05:40:17 INFO  # Finished -- repetition 2 of 7 
2022-09-21 05:40:17 INFO  # Optimization benchmark for feature_importance with args [['reviews', 'slow_loading', 'featurization_0', 'xgboost']] -- repetition 3 of 7
2022-09-21 05:40:17 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-21 05:40:17 INFO  Running instrumented original pipeline...
2022-09-21 05:40:17 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-21 05:40:17 INFO  ---RUNTIME: Importing and monkey-patching took 5.800962448120117 ms
2022-09-21 05:40:24 INFO  ---RUNTIME: Original pipeline execution took 7511.168956756592 ms (excluding imports and monkey-patching)
2022-09-21 05:40:24 INFO  Starting execution of 1 what-if analyses...
2022-09-21 05:40:24 INFO  Start plan generation for analysis PermutationFeatureImportance...
2022-09-21 05:40:24 INFO  ---RUNTIME: Plan generation took 0.125885009765625 ms
2022-09-21 05:40:24 INFO  Estimated runtime of original DAG is 5855.159759521484ms
2022-09-21 05:40:24 INFO  Performing Multi-Query Optimization
2022-09-21 05:40:24 INFO  Estimated unoptimized what-if runtime is 29275.798797607422ms
2022-09-21 05:40:24 INFO  Estimated optimised what-if runtime is 7335.163116455078ms
2022-09-21 05:40:24 INFO  Estimated optimisation runtime saving is 21940.635681152344ms
2022-09-21 05:40:24 INFO  ---RUNTIME: Multi-Query Optimization took 9.433269500732422 ms
2022-09-21 05:40:24 INFO  Executing generated plans
2022-09-21 05:40:32 INFO  ---RUNTIME: Execution took 8234.048843383789 ms
2022-09-21 05:40:32 INFO  Done!
2022-09-21 05:40:32 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-21 05:40:32 INFO  Running instrumented original pipeline...
2022-09-21 05:40:33 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-21 05:40:33 INFO  ---RUNTIME: Importing and monkey-patching took 5.910158157348633 ms
2022-09-21 05:40:40 INFO  ---RUNTIME: Original pipeline execution took 7506.3371658325195 ms (excluding imports and monkey-patching)
2022-09-21 05:40:40 INFO  Starting execution of 1 what-if analyses...
2022-09-21 05:40:40 INFO  Start plan generation for analysis PermutationFeatureImportance...
2022-09-21 05:40:40 INFO  ---RUNTIME: Plan generation took 0.10013580322265625 ms
2022-09-21 05:40:40 INFO  Estimated runtime of original DAG is 5851.5989780426025ms
2022-09-21 05:40:40 WARNING Skipping Multi-Query Optimization (instead, only combine execution DAGs)
2022-09-21 05:40:40 INFO  Estimated unoptimised what-if runtime is 29257.994890213013ms
2022-09-21 05:40:40 INFO  ---RUNTIME: Multi-Query Optimization took 13.258218765258789 ms
2022-09-21 05:40:40 INFO  Executing generated plans
2022-09-21 05:41:13 INFO  ---RUNTIME: Execution took 33399.717807769775 ms
2022-09-21 05:41:13 INFO  Done!
2022-09-21 05:41:13 INFO  # Finished -- repetition 3 of 7 
2022-09-21 05:41:13 INFO  # Optimization benchmark for feature_importance with args [['reviews', 'slow_loading', 'featurization_0', 'xgboost']] -- repetition 4 of 7
2022-09-21 05:41:13 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-21 05:41:13 INFO  Running instrumented original pipeline...
2022-09-21 05:41:13 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-21 05:41:13 INFO  ---RUNTIME: Importing and monkey-patching took 5.8536529541015625 ms
2022-09-21 05:41:21 INFO  ---RUNTIME: Original pipeline execution took 7795.293092727661 ms (excluding imports and monkey-patching)
2022-09-21 05:41:21 INFO  Starting execution of 1 what-if analyses...
2022-09-21 05:41:21 INFO  Start plan generation for analysis PermutationFeatureImportance...
2022-09-21 05:41:21 INFO  ---RUNTIME: Plan generation took 0.10132789611816406 ms
2022-09-21 05:41:21 INFO  Estimated runtime of original DAG is 5867.912530899048ms
2022-09-21 05:41:21 INFO  Performing Multi-Query Optimization
2022-09-21 05:41:21 INFO  Estimated unoptimized what-if runtime is 29339.56265449524ms
2022-09-21 05:41:21 INFO  Estimated optimised what-if runtime is 7350.071668624878ms
2022-09-21 05:41:21 INFO  Estimated optimisation runtime saving is 21989.49098587036ms
2022-09-21 05:41:21 INFO  ---RUNTIME: Multi-Query Optimization took 9.171485900878906 ms
2022-09-21 05:41:21 INFO  Executing generated plans
2022-09-21 05:41:30 INFO  ---RUNTIME: Execution took 8296.547412872314 ms
2022-09-21 05:41:30 INFO  Done!
2022-09-21 05:41:30 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-21 05:41:30 INFO  Running instrumented original pipeline...
2022-09-21 05:41:30 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-21 05:41:30 INFO  ---RUNTIME: Importing and monkey-patching took 5.959749221801758 ms
2022-09-21 05:41:37 INFO  ---RUNTIME: Original pipeline execution took 7595.395803451538 ms (excluding imports and monkey-patching)
2022-09-21 05:41:37 INFO  Starting execution of 1 what-if analyses...
2022-09-21 05:41:37 INFO  Start plan generation for analysis PermutationFeatureImportance...
2022-09-21 05:41:37 INFO  ---RUNTIME: Plan generation took 0.10275840759277344 ms
2022-09-21 05:41:37 INFO  Estimated runtime of original DAG is 5903.496026992798ms
2022-09-21 05:41:37 WARNING Skipping Multi-Query Optimization (instead, only combine execution DAGs)
2022-09-21 05:41:37 INFO  Estimated unoptimised what-if runtime is 29517.48013496399ms
2022-09-21 05:41:37 INFO  ---RUNTIME: Multi-Query Optimization took 13.308048248291016 ms
2022-09-21 05:41:37 INFO  Executing generated plans
2022-09-21 05:42:12 INFO  ---RUNTIME: Execution took 34395.29013633728 ms
2022-09-21 05:42:12 INFO  Done!
2022-09-21 05:42:12 INFO  # Finished -- repetition 4 of 7 
2022-09-21 05:42:12 INFO  # Optimization benchmark for feature_importance with args [['reviews', 'slow_loading', 'featurization_0', 'xgboost']] -- repetition 5 of 7
2022-09-21 05:42:12 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-21 05:42:12 INFO  Running instrumented original pipeline...
2022-09-21 05:42:12 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-21 05:42:12 INFO  ---RUNTIME: Importing and monkey-patching took 5.786418914794922 ms
2022-09-21 05:42:19 INFO  ---RUNTIME: Original pipeline execution took 7841.4483070373535 ms (excluding imports and monkey-patching)
2022-09-21 05:42:19 INFO  Starting execution of 1 what-if analyses...
2022-09-21 05:42:19 INFO  Start plan generation for analysis PermutationFeatureImportance...
2022-09-21 05:42:19 INFO  ---RUNTIME: Plan generation took 0.0972747802734375 ms
2022-09-21 05:42:19 INFO  Estimated runtime of original DAG is 5973.551034927368ms
2022-09-21 05:42:19 INFO  Performing Multi-Query Optimization
2022-09-21 05:42:19 INFO  Estimated unoptimized what-if runtime is 29867.75517463684ms
2022-09-21 05:42:19 INFO  Estimated optimised what-if runtime is 7457.424640655518ms
2022-09-21 05:42:19 INFO  Estimated optimisation runtime saving is 22410.330533981323ms
2022-09-21 05:42:19 INFO  ---RUNTIME: Multi-Query Optimization took 9.189605712890625 ms
2022-09-21 05:42:19 INFO  Executing generated plans
2022-09-21 05:42:28 INFO  ---RUNTIME: Execution took 8554.328918457031 ms
2022-09-21 05:42:28 INFO  Done!
2022-09-21 05:42:28 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-21 05:42:28 INFO  Running instrumented original pipeline...
2022-09-21 05:42:28 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-21 05:42:28 INFO  ---RUNTIME: Importing and monkey-patching took 6.122350692749023 ms
2022-09-21 05:42:36 INFO  ---RUNTIME: Original pipeline execution took 7863.1696701049805 ms (excluding imports and monkey-patching)
2022-09-21 05:42:36 INFO  Starting execution of 1 what-if analyses...
2022-09-21 05:42:36 INFO  Start plan generation for analysis PermutationFeatureImportance...
2022-09-21 05:42:36 INFO  ---RUNTIME: Plan generation took 0.11682510375976562 ms
2022-09-21 05:42:36 INFO  Estimated runtime of original DAG is 6086.17639541626ms
2022-09-21 05:42:36 WARNING Skipping Multi-Query Optimization (instead, only combine execution DAGs)
2022-09-21 05:42:36 INFO  Estimated unoptimised what-if runtime is 30430.8819770813ms
2022-09-21 05:42:36 INFO  ---RUNTIME: Multi-Query Optimization took 13.298749923706055 ms
2022-09-21 05:42:36 INFO  Executing generated plans
2022-09-21 05:43:10 INFO  ---RUNTIME: Execution took 34598.47187995911 ms
2022-09-21 05:43:10 INFO  Done!
2022-09-21 05:43:10 INFO  # Finished -- repetition 5 of 7 
2022-09-21 05:43:10 INFO  # Optimization benchmark for feature_importance with args [['reviews', 'slow_loading', 'featurization_0', 'xgboost']] -- repetition 6 of 7
2022-09-21 05:43:10 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-21 05:43:10 INFO  Running instrumented original pipeline...
2022-09-21 05:43:10 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-21 05:43:10 INFO  ---RUNTIME: Importing and monkey-patching took 5.734443664550781 ms
2022-09-21 05:43:18 INFO  ---RUNTIME: Original pipeline execution took 7810.324668884277 ms (excluding imports and monkey-patching)
2022-09-21 05:43:18 INFO  Starting execution of 1 what-if analyses...
2022-09-21 05:43:18 INFO  Start plan generation for analysis PermutationFeatureImportance...
2022-09-21 05:43:18 INFO  ---RUNTIME: Plan generation took 0.11539459228515625 ms
2022-09-21 05:43:18 INFO  Estimated runtime of original DAG is 6131.6587924957275ms
2022-09-21 05:43:18 INFO  Performing Multi-Query Optimization
2022-09-21 05:43:18 INFO  Estimated unoptimized what-if runtime is 30658.293962478638ms
2022-09-21 05:43:18 INFO  Estimated optimised what-if runtime is 7606.423854827881ms
2022-09-21 05:43:18 INFO  Estimated optimisation runtime saving is 23051.870107650757ms
2022-09-21 05:43:18 INFO  ---RUNTIME: Multi-Query Optimization took 9.254932403564453 ms
2022-09-21 05:43:18 INFO  Executing generated plans
2022-09-21 05:43:27 INFO  ---RUNTIME: Execution took 8605.430126190186 ms
2022-09-21 05:43:27 INFO  Done!
2022-09-21 05:43:27 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-21 05:43:27 INFO  Running instrumented original pipeline...
2022-09-21 05:43:27 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-21 05:43:27 INFO  ---RUNTIME: Importing and monkey-patching took 6.009578704833984 ms
2022-09-21 05:43:35 INFO  ---RUNTIME: Original pipeline execution took 7763.3607387542725 ms (excluding imports and monkey-patching)
2022-09-21 05:43:35 INFO  Starting execution of 1 what-if analyses...
2022-09-21 05:43:35 INFO  Start plan generation for analysis PermutationFeatureImportance...
2022-09-21 05:43:35 INFO  ---RUNTIME: Plan generation took 0.13303756713867188 ms
2022-09-21 05:43:35 INFO  Estimated runtime of original DAG is 6087.629079818726ms
2022-09-21 05:43:35 WARNING Skipping Multi-Query Optimization (instead, only combine execution DAGs)
2022-09-21 05:43:35 INFO  Estimated unoptimised what-if runtime is 30438.145399093628ms
2022-09-21 05:43:35 INFO  ---RUNTIME: Multi-Query Optimization took 13.077020645141602 ms
2022-09-21 05:43:35 INFO  Executing generated plans
2022-09-21 05:44:09 INFO  ---RUNTIME: Execution took 34774.16729927063 ms
2022-09-21 05:44:09 INFO  Done!
2022-09-21 05:44:09 INFO  # Finished -- repetition 6 of 7 
2022-09-21 05:44:09 INFO  # Optimization benchmark for feature_importance with args [['reviews', 'slow_loading', 'featurization_0', 'xgboost']] -- repetition 7 of 7
2022-09-21 05:44:09 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-21 05:44:09 INFO  Running instrumented original pipeline...
2022-09-21 05:44:09 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-21 05:44:09 INFO  ---RUNTIME: Importing and monkey-patching took 5.839824676513672 ms
2022-09-21 05:44:17 INFO  ---RUNTIME: Original pipeline execution took 7565.492153167725 ms (excluding imports and monkey-patching)
2022-09-21 05:44:17 INFO  Starting execution of 1 what-if analyses...
2022-09-21 05:44:17 INFO  Start plan generation for analysis PermutationFeatureImportance...
2022-09-21 05:44:17 INFO  ---RUNTIME: Plan generation took 0.1010894775390625 ms
2022-09-21 05:44:17 INFO  Estimated runtime of original DAG is 5888.697624206543ms
2022-09-21 05:44:17 INFO  Performing Multi-Query Optimization
2022-09-21 05:44:17 INFO  Estimated unoptimized what-if runtime is 29443.488121032715ms
2022-09-21 05:44:17 INFO  Estimated optimised what-if runtime is 7374.100685119629ms
2022-09-21 05:44:17 INFO  Estimated optimisation runtime saving is 22069.387435913086ms
2022-09-21 05:44:17 INFO  ---RUNTIME: Multi-Query Optimization took 9.401798248291016 ms
2022-09-21 05:44:17 INFO  Executing generated plans
2022-09-21 05:44:26 INFO  ---RUNTIME: Execution took 8767.967939376831 ms
2022-09-21 05:44:26 INFO  Done!
2022-09-21 05:44:26 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-21 05:44:26 INFO  Running instrumented original pipeline...
2022-09-21 05:44:26 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-21 05:44:26 INFO  ---RUNTIME: Importing and monkey-patching took 5.727529525756836 ms
2022-09-21 05:44:33 INFO  ---RUNTIME: Original pipeline execution took 7489.356756210327 ms (excluding imports and monkey-patching)
2022-09-21 05:44:33 INFO  Starting execution of 1 what-if analyses...
2022-09-21 05:44:33 INFO  Start plan generation for analysis PermutationFeatureImportance...
2022-09-21 05:44:33 INFO  ---RUNTIME: Plan generation took 0.1461505889892578 ms
2022-09-21 05:44:33 INFO  Estimated runtime of original DAG is 5818.805932998657ms
2022-09-21 05:44:33 WARNING Skipping Multi-Query Optimization (instead, only combine execution DAGs)
2022-09-21 05:44:33 INFO  Estimated unoptimised what-if runtime is 29094.029664993286ms
2022-09-21 05:44:33 INFO  ---RUNTIME: Multi-Query Optimization took 13.226032257080078 ms
2022-09-21 05:44:33 INFO  Executing generated plans
2022-09-21 05:45:08 INFO  ---RUNTIME: Execution took 34702.68392562866 ms
2022-09-21 05:45:08 INFO  Done!
2022-09-21 05:45:08 INFO  # Finished -- repetition 7 of 7 
2022-09-21 05:45:08 INFO  # Final results after all repetitions
2022-09-21 05:45:08 INFO     repetition  ... no_opt_what_if_execution_combined_model_training
0           0  ...                                      3505.945683
1           1  ...                                      3518.444777
2           2  ...                                      3482.158184
3           3  ...                                      3486.414194
4           4  ...                                      3462.303638
5           5  ...                                      3693.933725
6           6  ...                                      3713.518143

[7 rows x 26 columns]
taskset -c 160-168 PROTOCOL_BUFFERS_PYTHON_IMPLEMENTATION=python python3.9 benchmarks_end_to_end.py feature_importance reviews slow_loading featurization_0 neural_network
2022-09-21 05:45:10.784246: W tensorflow/stream_executor/platform/default/dso_loader.cc:64] Could not load dynamic library 'libcudart.so.11.0'; dlerror: libcudart.so.11.0: cannot open shared object file: No such file or directory; LD_LIBRARY_PATH: /home/sgrafbe/mlwhatif/venv/lib/python3.9/site-packages/cv2/../../lib64:
2022-09-21 05:45:10.784293: I tensorflow/stream_executor/cuda/cudart_stub.cc:29] Ignore above cudart dlerror if you do not have a GPU set up on your machine.
2022-09-21 05:45:12 INFO  Patching sys.argv with ['mlwhatif', 'reviews', 'slow_loading', 'featurization_0', 'neural_network']
2022-09-21 05:45:12 INFO  Running instrumented original pipeline...
2022-09-21 05:45:12 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-21 05:45:12 INFO  ---RUNTIME: Importing and monkey-patching took 121.54245376586914 ms
2022-09-21 05:45:18.028792: W tensorflow/stream_executor/platform/default/dso_loader.cc:64] Could not load dynamic library 'libcuda.so.1'; dlerror: libcuda.so.1: cannot open shared object file: No such file or directory; LD_LIBRARY_PATH: /home/sgrafbe/mlwhatif/venv/lib/python3.9/site-packages/cv2/../../lib64:
2022-09-21 05:45:18.028833: W tensorflow/stream_executor/cuda/cuda_driver.cc:326] failed call to cuInit: UNKNOWN ERROR (303)
2022-09-21 05:45:18.028868: I tensorflow/stream_executor/cuda/cuda_diagnostics.cc:156] kernel driver does not appear to be running on this host (angus): /proc/driver/nvidia/version does not exist
2022-09-21 05:45:18.029406: I tensorflow/core/platform/cpu_feature_guard.cc:142] This TensorFlow binary is optimized with oneAPI Deep Neural Network Library (oneDNN) to use the following CPU instructions in performance-critical operations:  AVX2 FMA
To enable them in other operations, rebuild TensorFlow with the appropriate compiler flags.
2022-09-21 05:45:18.266960: I tensorflow/compiler/mlir/mlir_graph_optimization_pass.cc:176] None of the MLIR Optimization Passes are enabled (registered 2)
2022-09-21 05:45:18.279187: I tensorflow/core/platform/profile_utils/cpu_utils.cc:114] CPU Frequency: 2595130000 Hz
2022-09-21 05:45:23 INFO  ---RUNTIME: Original pipeline execution took 11211.673736572266 ms (excluding imports and monkey-patching)
2022-09-21 05:45:23 INFO  Starting execution of 0 what-if analyses...
2022-09-21 05:45:23 INFO  Estimated runtime of original DAG is 9256.20722770691ms
2022-09-21 05:45:23 INFO  Performing Multi-Query Optimization
2022-09-21 05:45:23 INFO  Estimated unoptimized what-if runtime is 0ms
2022-09-21 05:45:23 INFO  Estimated optimised what-if runtime is 0ms
2022-09-21 05:45:23 INFO  Estimated optimisation runtime saving is 0ms
2022-09-21 05:45:23 INFO  ---RUNTIME: Multi-Query Optimization took 0.7624626159667969 ms
2022-09-21 05:45:23 INFO  Executing generated plans
2022-09-21 05:45:23 INFO  ---RUNTIME: Execution took 0.05054473876953125 ms
2022-09-21 05:45:23 INFO  Done!
2022-09-21 05:45:23 INFO  # Optimization benchmark for feature_importance with args [['reviews', 'slow_loading', 'featurization_0', 'neural_network']] -- repetition 1 of 7
2022-09-21 05:45:23 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-21 05:45:23 INFO  Running instrumented original pipeline...
2022-09-21 05:45:23 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-21 05:45:23 INFO  ---RUNTIME: Importing and monkey-patching took 5.693912506103516 ms
2022-09-21 05:45:33 INFO  ---RUNTIME: Original pipeline execution took 10189.927577972412 ms (excluding imports and monkey-patching)
2022-09-21 05:45:33 INFO  Starting execution of 1 what-if analyses...
2022-09-21 05:45:33 INFO  Start plan generation for analysis PermutationFeatureImportance...
2022-09-21 05:45:33 INFO  ---RUNTIME: Plan generation took 0.19216537475585938 ms
2022-09-21 05:45:33 INFO  Estimated runtime of original DAG is 8568.109035491943ms
2022-09-21 05:45:33 INFO  Performing Multi-Query Optimization
2022-09-21 05:45:33 INFO  Estimated unoptimized what-if runtime is 42840.54517745972ms
2022-09-21 05:45:33 INFO  Estimated optimised what-if runtime is 11489.340543746948ms
2022-09-21 05:45:33 INFO  Estimated optimisation runtime saving is 31351.20463371277ms
2022-09-21 05:45:33 INFO  ---RUNTIME: Multi-Query Optimization took 9.282588958740234 ms
2022-09-21 05:45:33 INFO  Executing generated plans
2022-09-21 05:45:45 INFO  ---RUNTIME: Execution took 12311.026811599731 ms
2022-09-21 05:45:45 INFO  Done!
2022-09-21 05:45:45 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-21 05:45:45 INFO  Running instrumented original pipeline...
2022-09-21 05:45:45 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-21 05:45:45 INFO  ---RUNTIME: Importing and monkey-patching took 6.258487701416016 ms
2022-09-21 05:45:57 INFO  ---RUNTIME: Original pipeline execution took 11552.050113677979 ms (excluding imports and monkey-patching)
2022-09-21 05:45:57 INFO  Starting execution of 1 what-if analyses...
2022-09-21 05:45:57 INFO  Start plan generation for analysis PermutationFeatureImportance...
2022-09-21 05:45:57 INFO  ---RUNTIME: Plan generation took 0.13017654418945312 ms
2022-09-21 05:45:57 INFO  Estimated runtime of original DAG is 9703.784227371216ms
2022-09-21 05:45:57 WARNING Skipping Multi-Query Optimization (instead, only combine execution DAGs)
2022-09-21 05:45:57 INFO  Estimated unoptimised what-if runtime is 48518.92113685608ms
2022-09-21 05:45:57 INFO  ---RUNTIME: Multi-Query Optimization took 14.836788177490234 ms
2022-09-21 05:45:57 INFO  Executing generated plans
2022-09-21 05:46:45 INFO  ---RUNTIME: Execution took 48474.40028190613 ms
2022-09-21 05:46:45 INFO  Done!
2022-09-21 05:46:45 INFO  # Finished -- repetition 1 of 7 
2022-09-21 05:46:45 INFO  # Optimization benchmark for feature_importance with args [['reviews', 'slow_loading', 'featurization_0', 'neural_network']] -- repetition 2 of 7
2022-09-21 05:46:45 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-21 05:46:45 INFO  Running instrumented original pipeline...
2022-09-21 05:46:46 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-21 05:46:46 INFO  ---RUNTIME: Importing and monkey-patching took 6.514549255371094 ms
2022-09-21 05:46:58 INFO  ---RUNTIME: Original pipeline execution took 12038.40446472168 ms (excluding imports and monkey-patching)
2022-09-21 05:46:58 INFO  Starting execution of 1 what-if analyses...
2022-09-21 05:46:58 INFO  Start plan generation for analysis PermutationFeatureImportance...
2022-09-21 05:46:58 INFO  ---RUNTIME: Plan generation took 0.1366138458251953 ms
2022-09-21 05:46:58 INFO  Estimated runtime of original DAG is 9823.012590408325ms
2022-09-21 05:46:58 INFO  Performing Multi-Query Optimization
2022-09-21 05:46:58 INFO  Estimated unoptimized what-if runtime is 49115.062952041626ms
2022-09-21 05:46:58 INFO  Estimated optimised what-if runtime is 12754.616022109985ms
2022-09-21 05:46:58 INFO  Estimated optimisation runtime saving is 36360.44692993164ms
2022-09-21 05:46:58 INFO  ---RUNTIME: Multi-Query Optimization took 9.275436401367188 ms
2022-09-21 05:46:58 INFO  Executing generated plans
2022-09-21 05:47:10 INFO  ---RUNTIME: Execution took 12732.258558273315 ms
2022-09-21 05:47:10 INFO  Done!
2022-09-21 05:47:10 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-21 05:47:10 INFO  Running instrumented original pipeline...
2022-09-21 05:47:10 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-21 05:47:10 INFO  ---RUNTIME: Importing and monkey-patching took 5.777835845947266 ms
2022-09-21 05:47:21 INFO  ---RUNTIME: Original pipeline execution took 10634.539604187012 ms (excluding imports and monkey-patching)
2022-09-21 05:47:21 INFO  Starting execution of 1 what-if analyses...
2022-09-21 05:47:21 INFO  Start plan generation for analysis PermutationFeatureImportance...
2022-09-21 05:47:21 INFO  ---RUNTIME: Plan generation took 0.12278556823730469 ms
2022-09-21 05:47:21 INFO  Estimated runtime of original DAG is 8910.635948181152ms
2022-09-21 05:47:21 WARNING Skipping Multi-Query Optimization (instead, only combine execution DAGs)
2022-09-21 05:47:21 INFO  Estimated unoptimised what-if runtime is 44553.17974090576ms
2022-09-21 05:47:21 INFO  ---RUNTIME: Multi-Query Optimization took 13.713836669921875 ms
2022-09-21 05:47:21 INFO  Executing generated plans
2022-09-21 05:48:11 INFO  ---RUNTIME: Execution took 49629.38189506531 ms
2022-09-21 05:48:11 INFO  Done!
2022-09-21 05:48:11 INFO  # Finished -- repetition 2 of 7 
2022-09-21 05:48:11 INFO  # Optimization benchmark for feature_importance with args [['reviews', 'slow_loading', 'featurization_0', 'neural_network']] -- repetition 3 of 7
2022-09-21 05:48:11 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-21 05:48:11 INFO  Running instrumented original pipeline...
2022-09-21 05:48:11 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-21 05:48:11 INFO  ---RUNTIME: Importing and monkey-patching took 6.398916244506836 ms
2022-09-21 05:48:22 INFO  ---RUNTIME: Original pipeline execution took 10942.339897155762 ms (excluding imports and monkey-patching)
2022-09-21 05:48:22 INFO  Starting execution of 1 what-if analyses...
2022-09-21 05:48:22 INFO  Start plan generation for analysis PermutationFeatureImportance...
2022-09-21 05:48:22 INFO  ---RUNTIME: Plan generation took 0.11944770812988281 ms
2022-09-21 05:48:22 INFO  Estimated runtime of original DAG is 9292.988061904907ms
2022-09-21 05:48:22 INFO  Performing Multi-Query Optimization
2022-09-21 05:48:22 INFO  Estimated unoptimized what-if runtime is 46464.940309524536ms
2022-09-21 05:48:22 INFO  Estimated optimised what-if runtime is 12151.095628738403ms
2022-09-21 05:48:22 INFO  Estimated optimisation runtime saving is 34313.84468078613ms
2022-09-21 05:48:22 INFO  ---RUNTIME: Multi-Query Optimization took 9.221792221069336 ms
2022-09-21 05:48:22 INFO  Executing generated plans
2022-09-21 05:48:34 INFO  ---RUNTIME: Execution took 12316.956520080566 ms
2022-09-21 05:48:34 INFO  Done!
2022-09-21 05:48:34 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-21 05:48:34 INFO  Running instrumented original pipeline...
2022-09-21 05:48:34 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-21 05:48:34 INFO  ---RUNTIME: Importing and monkey-patching took 5.741596221923828 ms
2022-09-21 05:48:45 INFO  ---RUNTIME: Original pipeline execution took 10696.141481399536 ms (excluding imports and monkey-patching)
2022-09-21 05:48:45 INFO  Starting execution of 1 what-if analyses...
2022-09-21 05:48:45 INFO  Start plan generation for analysis PermutationFeatureImportance...
2022-09-21 05:48:45 INFO  ---RUNTIME: Plan generation took 0.12421607971191406 ms
2022-09-21 05:48:45 INFO  Estimated runtime of original DAG is 9050.0009059906ms
2022-09-21 05:48:45 WARNING Skipping Multi-Query Optimization (instead, only combine execution DAGs)
2022-09-21 05:48:45 INFO  Estimated unoptimised what-if runtime is 45250.004529953ms
2022-09-21 05:48:45 INFO  ---RUNTIME: Multi-Query Optimization took 13.437509536743164 ms
2022-09-21 05:48:45 INFO  Executing generated plans
2022-09-21 05:49:35 INFO  ---RUNTIME: Execution took 50094.250202178955 ms
2022-09-21 05:49:35 INFO  Done!
2022-09-21 05:49:35 INFO  # Finished -- repetition 3 of 7 
2022-09-21 05:49:35 INFO  # Optimization benchmark for feature_importance with args [['reviews', 'slow_loading', 'featurization_0', 'neural_network']] -- repetition 4 of 7
2022-09-21 05:49:35 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-21 05:49:35 INFO  Running instrumented original pipeline...
2022-09-21 05:49:35 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-21 05:49:35 INFO  ---RUNTIME: Importing and monkey-patching took 6.984710693359375 ms
2022-09-21 05:49:46 INFO  ---RUNTIME: Original pipeline execution took 11241.202592849731 ms (excluding imports and monkey-patching)
2022-09-21 05:49:46 INFO  Starting execution of 1 what-if analyses...
2022-09-21 05:49:46 INFO  Start plan generation for analysis PermutationFeatureImportance...
2022-09-21 05:49:46 INFO  ---RUNTIME: Plan generation took 0.10752677917480469 ms
2022-09-21 05:49:46 INFO  Estimated runtime of original DAG is 9558.856725692749ms
2022-09-21 05:49:46 INFO  Performing Multi-Query Optimization
2022-09-21 05:49:46 INFO  Estimated unoptimized what-if runtime is 47794.283628463745ms
2022-09-21 05:49:46 INFO  Estimated optimised what-if runtime is 12429.021120071411ms
2022-09-21 05:49:46 INFO  Estimated optimisation runtime saving is 35365.262508392334ms
2022-09-21 05:49:46 INFO  ---RUNTIME: Multi-Query Optimization took 9.080886840820312 ms
2022-09-21 05:49:46 INFO  Executing generated plans
2022-09-21 05:49:59 INFO  ---RUNTIME: Execution took 13114.763021469116 ms
2022-09-21 05:49:59 INFO  Done!
2022-09-21 05:49:59 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-21 05:49:59 INFO  Running instrumented original pipeline...
2022-09-21 05:49:59 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-21 05:49:59 INFO  ---RUNTIME: Importing and monkey-patching took 6.139039993286133 ms
2022-09-21 05:50:10 INFO  ---RUNTIME: Original pipeline execution took 10651.530027389526 ms (excluding imports and monkey-patching)
2022-09-21 05:50:10 INFO  Starting execution of 1 what-if analyses...
2022-09-21 05:50:10 INFO  Start plan generation for analysis PermutationFeatureImportance...
2022-09-21 05:50:10 INFO  ---RUNTIME: Plan generation took 0.13113021850585938 ms
2022-09-21 05:50:10 INFO  Estimated runtime of original DAG is 8936.01369857788ms
2022-09-21 05:50:10 WARNING Skipping Multi-Query Optimization (instead, only combine execution DAGs)
2022-09-21 05:50:10 INFO  Estimated unoptimised what-if runtime is 44680.068492889404ms
2022-09-21 05:50:10 INFO  ---RUNTIME: Multi-Query Optimization took 13.143062591552734 ms
2022-09-21 05:50:10 INFO  Executing generated plans
2022-09-21 05:50:58 INFO  ---RUNTIME: Execution took 48170.94683647156 ms
2022-09-21 05:50:58 INFO  Done!
2022-09-21 05:50:58 INFO  # Finished -- repetition 4 of 7 
2022-09-21 05:50:58 INFO  # Optimization benchmark for feature_importance with args [['reviews', 'slow_loading', 'featurization_0', 'neural_network']] -- repetition 5 of 7
2022-09-21 05:50:58 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-21 05:50:58 INFO  Running instrumented original pipeline...
2022-09-21 05:50:58 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-21 05:50:58 INFO  ---RUNTIME: Importing and monkey-patching took 6.416559219360352 ms
2022-09-21 05:51:09 INFO  ---RUNTIME: Original pipeline execution took 11131.28638267517 ms (excluding imports and monkey-patching)
2022-09-21 05:51:09 INFO  Starting execution of 1 what-if analyses...
2022-09-21 05:51:09 INFO  Start plan generation for analysis PermutationFeatureImportance...
2022-09-21 05:51:09 INFO  ---RUNTIME: Plan generation took 0.1361370086669922 ms
2022-09-21 05:51:09 INFO  Estimated runtime of original DAG is 9376.30844116211ms
2022-09-21 05:51:09 INFO  Performing Multi-Query Optimization
2022-09-21 05:51:09 INFO  Estimated unoptimized what-if runtime is 46881.54220581055ms
2022-09-21 05:51:09 INFO  Estimated optimised what-if runtime is 12403.17440032959ms
2022-09-21 05:51:09 INFO  Estimated optimisation runtime saving is 34478.36780548096ms
2022-09-21 05:51:09 INFO  ---RUNTIME: Multi-Query Optimization took 9.864330291748047 ms
2022-09-21 05:51:09 INFO  Executing generated plans
2022-09-21 05:51:22 INFO  ---RUNTIME: Execution took 12758.480072021484 ms
2022-09-21 05:51:22 INFO  Done!
2022-09-21 05:51:22 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-21 05:51:22 INFO  Running instrumented original pipeline...
2022-09-21 05:51:22 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-21 05:51:22 INFO  ---RUNTIME: Importing and monkey-patching took 5.916833877563477 ms
2022-09-21 05:51:32 INFO  ---RUNTIME: Original pipeline execution took 10476.968765258789 ms (excluding imports and monkey-patching)
2022-09-21 05:51:32 INFO  Starting execution of 1 what-if analyses...
2022-09-21 05:51:32 INFO  Start plan generation for analysis PermutationFeatureImportance...
2022-09-21 05:51:32 INFO  ---RUNTIME: Plan generation took 0.09608268737792969 ms
2022-09-21 05:51:32 INFO  Estimated runtime of original DAG is 8762.317895889282ms
2022-09-21 05:51:32 WARNING Skipping Multi-Query Optimization (instead, only combine execution DAGs)
2022-09-21 05:51:32 INFO  Estimated unoptimised what-if runtime is 43811.58947944641ms
2022-09-21 05:51:32 INFO  ---RUNTIME: Multi-Query Optimization took 14.312267303466797 ms
2022-09-21 05:51:32 INFO  Executing generated plans
2022-09-21 05:52:21 INFO  ---RUNTIME: Execution took 48432.76572227478 ms
2022-09-21 05:52:21 INFO  Done!
2022-09-21 05:52:21 INFO  # Finished -- repetition 5 of 7 
2022-09-21 05:52:21 INFO  # Optimization benchmark for feature_importance with args [['reviews', 'slow_loading', 'featurization_0', 'neural_network']] -- repetition 6 of 7
2022-09-21 05:52:21 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-21 05:52:21 INFO  Running instrumented original pipeline...
2022-09-21 05:52:21 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-21 05:52:21 INFO  ---RUNTIME: Importing and monkey-patching took 7.26318359375 ms
2022-09-21 05:52:32 INFO  ---RUNTIME: Original pipeline execution took 11644.575595855713 ms (excluding imports and monkey-patching)
2022-09-21 05:52:32 INFO  Starting execution of 1 what-if analyses...
2022-09-21 05:52:32 INFO  Start plan generation for analysis PermutationFeatureImportance...
2022-09-21 05:52:32 INFO  ---RUNTIME: Plan generation took 0.13256072998046875 ms
2022-09-21 05:52:32 INFO  Estimated runtime of original DAG is 9865.734577178955ms
2022-09-21 05:52:32 INFO  Performing Multi-Query Optimization
2022-09-21 05:52:32 INFO  Estimated unoptimized what-if runtime is 49328.672885894775ms
2022-09-21 05:52:32 INFO  Estimated optimised what-if runtime is 12920.57466506958ms
2022-09-21 05:52:32 INFO  Estimated optimisation runtime saving is 36408.098220825195ms
2022-09-21 05:52:32 INFO  ---RUNTIME: Multi-Query Optimization took 11.852741241455078 ms
2022-09-21 05:52:32 INFO  Executing generated plans
2022-09-21 05:52:45 INFO  ---RUNTIME: Execution took 12604.461431503296 ms
2022-09-21 05:52:45 INFO  Done!
2022-09-21 05:52:45 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-21 05:52:45 INFO  Running instrumented original pipeline...
2022-09-21 05:52:45 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-21 05:52:45 INFO  ---RUNTIME: Importing and monkey-patching took 6.180047988891602 ms
2022-09-21 05:52:55 INFO  ---RUNTIME: Original pipeline execution took 10463.038921356201 ms (excluding imports and monkey-patching)
2022-09-21 05:52:55 INFO  Starting execution of 1 what-if analyses...
2022-09-21 05:52:55 INFO  Start plan generation for analysis PermutationFeatureImportance...
2022-09-21 05:52:55 INFO  ---RUNTIME: Plan generation took 0.09512901306152344 ms
2022-09-21 05:52:55 INFO  Estimated runtime of original DAG is 8770.96700668335ms
2022-09-21 05:52:55 WARNING Skipping Multi-Query Optimization (instead, only combine execution DAGs)
2022-09-21 05:52:56 INFO  Estimated unoptimised what-if runtime is 43854.83503341675ms
2022-09-21 05:52:56 INFO  ---RUNTIME: Multi-Query Optimization took 13.181924819946289 ms
2022-09-21 05:52:56 INFO  Executing generated plans
2022-09-21 05:53:44 INFO  ---RUNTIME: Execution took 48633.36968421936 ms
2022-09-21 05:53:44 INFO  Done!
2022-09-21 05:53:44 INFO  # Finished -- repetition 6 of 7 
2022-09-21 05:53:44 INFO  # Optimization benchmark for feature_importance with args [['reviews', 'slow_loading', 'featurization_0', 'neural_network']] -- repetition 7 of 7
2022-09-21 05:53:44 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-21 05:53:44 INFO  Running instrumented original pipeline...
2022-09-21 05:53:44 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-21 05:53:44 INFO  ---RUNTIME: Importing and monkey-patching took 6.291389465332031 ms
2022-09-21 05:53:55 INFO  ---RUNTIME: Original pipeline execution took 11112.306118011475 ms (excluding imports and monkey-patching)
2022-09-21 05:53:55 INFO  Starting execution of 1 what-if analyses...
2022-09-21 05:53:55 INFO  Start plan generation for analysis PermutationFeatureImportance...
2022-09-21 05:53:55 INFO  ---RUNTIME: Plan generation took 0.11706352233886719 ms
2022-09-21 05:53:55 INFO  Estimated runtime of original DAG is 9365.364789962769ms
2022-09-21 05:53:55 INFO  Performing Multi-Query Optimization
2022-09-21 05:53:55 INFO  Estimated unoptimized what-if runtime is 46826.82394981384ms
2022-09-21 05:53:55 INFO  Estimated optimised what-if runtime is 12507.854461669922ms
2022-09-21 05:53:55 INFO  Estimated optimisation runtime saving is 34318.96948814392ms
2022-09-21 05:53:55 INFO  ---RUNTIME: Multi-Query Optimization took 10.522127151489258 ms
2022-09-21 05:53:55 INFO  Executing generated plans
2022-09-21 05:54:08 INFO  ---RUNTIME: Execution took 12871.328353881836 ms
2022-09-21 05:54:08 INFO  Done!
2022-09-21 05:54:08 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-21 05:54:08 INFO  Running instrumented original pipeline...
2022-09-21 05:54:08 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-21 05:54:08 INFO  ---RUNTIME: Importing and monkey-patching took 6.130218505859375 ms
2022-09-21 05:54:19 INFO  ---RUNTIME: Original pipeline execution took 10897.103786468506 ms (excluding imports and monkey-patching)
2022-09-21 05:54:19 INFO  Starting execution of 1 what-if analyses...
2022-09-21 05:54:19 INFO  Start plan generation for analysis PermutationFeatureImportance...
2022-09-21 05:54:19 INFO  ---RUNTIME: Plan generation took 0.12445449829101562 ms
2022-09-21 05:54:19 INFO  Estimated runtime of original DAG is 9230.967283248901ms
2022-09-21 05:54:19 WARNING Skipping Multi-Query Optimization (instead, only combine execution DAGs)
2022-09-21 05:54:19 INFO  Estimated unoptimised what-if runtime is 46154.83641624451ms
2022-09-21 05:54:19 INFO  ---RUNTIME: Multi-Query Optimization took 14.759540557861328 ms
2022-09-21 05:54:19 INFO  Executing generated plans
2022-09-21 05:55:07 INFO  ---RUNTIME: Execution took 48252.56013870239 ms
2022-09-21 05:55:07 INFO  Done!
2022-09-21 05:55:07 INFO  # Finished -- repetition 7 of 7 
2022-09-21 05:55:07 INFO  # Final results after all repetitions
2022-09-21 05:55:07 INFO     repetition  ... no_opt_what_if_execution_combined_model_training
0           0  ...                                     15561.233282
1           1  ...                                     17994.299173
2           2  ...                                     17202.597857
3           3  ...                                     16473.458529
4           4  ...                                     16273.618937
5           5  ...                                     16259.636641
6           6  ...                                     15898.625135

[7 rows x 26 columns]
taskset -c 160-168 PROTOCOL_BUFFERS_PYTHON_IMPLEMENTATION=python python3.9 benchmarks_end_to_end.py feature_importance reviews slow_loading featurization_1 logistic_regression
2022-09-21 05:55:10.414865: W tensorflow/stream_executor/platform/default/dso_loader.cc:64] Could not load dynamic library 'libcudart.so.11.0'; dlerror: libcudart.so.11.0: cannot open shared object file: No such file or directory; LD_LIBRARY_PATH: /home/sgrafbe/mlwhatif/venv/lib/python3.9/site-packages/cv2/../../lib64:
2022-09-21 05:55:10.414910: I tensorflow/stream_executor/cuda/cudart_stub.cc:29] Ignore above cudart dlerror if you do not have a GPU set up on your machine.
2022-09-21 05:55:11 INFO  Patching sys.argv with ['mlwhatif', 'reviews', 'slow_loading', 'featurization_1', 'logistic_regression']
2022-09-21 05:55:11 INFO  Running instrumented original pipeline...
2022-09-21 05:55:11 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-21 05:55:11 INFO  ---RUNTIME: Importing and monkey-patching took 130.73444366455078 ms
2022-09-21 05:55:19 INFO  ---RUNTIME: Original pipeline execution took 8047.707796096802 ms (excluding imports and monkey-patching)
2022-09-21 05:55:19 INFO  Starting execution of 0 what-if analyses...
2022-09-21 05:55:19 INFO  Estimated runtime of original DAG is 5634.577751159668ms
2022-09-21 05:55:19 INFO  Performing Multi-Query Optimization
2022-09-21 05:55:19 INFO  Estimated unoptimized what-if runtime is 0ms
2022-09-21 05:55:19 INFO  Estimated optimised what-if runtime is 0ms
2022-09-21 05:55:19 INFO  Estimated optimisation runtime saving is 0ms
2022-09-21 05:55:19 INFO  ---RUNTIME: Multi-Query Optimization took 0.5025863647460938 ms
2022-09-21 05:55:19 INFO  Executing generated plans
2022-09-21 05:55:19 INFO  ---RUNTIME: Execution took 0.024557113647460938 ms
2022-09-21 05:55:19 INFO  Done!
2022-09-21 05:55:19 INFO  # Optimization benchmark for feature_importance with args [['reviews', 'slow_loading', 'featurization_1', 'logistic_regression']] -- repetition 1 of 7
2022-09-21 05:55:19 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-21 05:55:19 INFO  Running instrumented original pipeline...
2022-09-21 05:55:20 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-21 05:55:20 INFO  ---RUNTIME: Importing and monkey-patching took 6.610870361328125 ms
2022-09-21 05:55:27 INFO  ---RUNTIME: Original pipeline execution took 7690.42444229126 ms (excluding imports and monkey-patching)
2022-09-21 05:55:27 INFO  Starting execution of 1 what-if analyses...
2022-09-21 05:55:27 INFO  Start plan generation for analysis PermutationFeatureImportance...
2022-09-21 05:55:27 INFO  ---RUNTIME: Plan generation took 0.31256675720214844 ms
2022-09-21 05:55:27 INFO  Estimated runtime of original DAG is 5335.819244384766ms
2022-09-21 05:55:27 INFO  Performing Multi-Query Optimization
2022-09-21 05:55:27 INFO  Estimated unoptimized what-if runtime is 26679.096221923828ms
2022-09-21 05:55:27 INFO  Estimated optimised what-if runtime is 6663.556814193726ms
2022-09-21 05:55:27 INFO  Estimated optimisation runtime saving is 20015.539407730103ms
2022-09-21 05:55:27 INFO  ---RUNTIME: Multi-Query Optimization took 10.164260864257812 ms
2022-09-21 05:55:27 INFO  Executing generated plans
2022-09-21 05:55:35 INFO  ---RUNTIME: Execution took 7626.456022262573 ms
2022-09-21 05:55:35 INFO  Done!
2022-09-21 05:55:35 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-21 05:55:35 INFO  Running instrumented original pipeline...
2022-09-21 05:55:35 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-21 05:55:35 INFO  ---RUNTIME: Importing and monkey-patching took 6.137371063232422 ms
2022-09-21 05:55:42 INFO  ---RUNTIME: Original pipeline execution took 7566.689014434814 ms (excluding imports and monkey-patching)
2022-09-21 05:55:42 INFO  Starting execution of 1 what-if analyses...
2022-09-21 05:55:42 INFO  Start plan generation for analysis PermutationFeatureImportance...
2022-09-21 05:55:42 INFO  ---RUNTIME: Plan generation took 0.25534629821777344 ms
2022-09-21 05:55:42 INFO  Estimated runtime of original DAG is 5324.105501174927ms
2022-09-21 05:55:42 WARNING Skipping Multi-Query Optimization (instead, only combine execution DAGs)
2022-09-21 05:55:42 INFO  Estimated unoptimised what-if runtime is 26620.527505874634ms
2022-09-21 05:55:42 INFO  ---RUNTIME: Multi-Query Optimization took 15.878438949584961 ms
2022-09-21 05:55:42 INFO  Executing generated plans
2022-09-21 05:56:13 INFO  ---RUNTIME: Execution took 30717.175245285034 ms
2022-09-21 05:56:13 INFO  Done!
2022-09-21 05:56:13 INFO  # Finished -- repetition 1 of 7 
2022-09-21 05:56:13 INFO  # Optimization benchmark for feature_importance with args [['reviews', 'slow_loading', 'featurization_1', 'logistic_regression']] -- repetition 2 of 7
2022-09-21 05:56:13 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-21 05:56:13 INFO  Running instrumented original pipeline...
2022-09-21 05:56:13 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-21 05:56:13 INFO  ---RUNTIME: Importing and monkey-patching took 6.213665008544922 ms
2022-09-21 05:56:21 INFO  ---RUNTIME: Original pipeline execution took 7503.456115722656 ms (excluding imports and monkey-patching)
2022-09-21 05:56:21 INFO  Starting execution of 1 what-if analyses...
2022-09-21 05:56:21 INFO  Start plan generation for analysis PermutationFeatureImportance...
2022-09-21 05:56:21 INFO  ---RUNTIME: Plan generation took 0.22912025451660156 ms
2022-09-21 05:56:21 INFO  Estimated runtime of original DAG is 5284.76881980896ms
2022-09-21 05:56:21 INFO  Performing Multi-Query Optimization
2022-09-21 05:56:21 INFO  Estimated unoptimized what-if runtime is 26423.8440990448ms
2022-09-21 05:56:21 INFO  Estimated optimised what-if runtime is 6612.098217010498ms
2022-09-21 05:56:21 INFO  Estimated optimisation runtime saving is 19811.7458820343ms
2022-09-21 05:56:21 INFO  ---RUNTIME: Multi-Query Optimization took 10.293960571289062 ms
2022-09-21 05:56:21 INFO  Executing generated plans
2022-09-21 05:56:28 INFO  ---RUNTIME: Execution took 7784.8100662231445 ms
2022-09-21 05:56:28 INFO  Done!
2022-09-21 05:56:28 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-21 05:56:28 INFO  Running instrumented original pipeline...
2022-09-21 05:56:28 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-21 05:56:28 INFO  ---RUNTIME: Importing and monkey-patching took 6.497383117675781 ms
2022-09-21 05:56:36 INFO  ---RUNTIME: Original pipeline execution took 7923.676490783691 ms (excluding imports and monkey-patching)
2022-09-21 05:56:36 INFO  Starting execution of 1 what-if analyses...
2022-09-21 05:56:36 INFO  Start plan generation for analysis PermutationFeatureImportance...
2022-09-21 05:56:36 INFO  ---RUNTIME: Plan generation took 0.19121170043945312 ms
2022-09-21 05:56:36 INFO  Estimated runtime of original DAG is 5551.668405532837ms
2022-09-21 05:56:36 WARNING Skipping Multi-Query Optimization (instead, only combine execution DAGs)
2022-09-21 05:56:36 INFO  Estimated unoptimised what-if runtime is 27758.342027664185ms
2022-09-21 05:56:36 INFO  ---RUNTIME: Multi-Query Optimization took 15.195608139038086 ms
2022-09-21 05:56:36 INFO  Executing generated plans
2022-09-21 05:57:07 INFO  ---RUNTIME: Execution took 31096.152305603027 ms
2022-09-21 05:57:07 INFO  Done!
2022-09-21 05:57:08 INFO  # Finished -- repetition 2 of 7 
2022-09-21 05:57:08 INFO  # Optimization benchmark for feature_importance with args [['reviews', 'slow_loading', 'featurization_1', 'logistic_regression']] -- repetition 3 of 7
2022-09-21 05:57:08 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-21 05:57:08 INFO  Running instrumented original pipeline...
2022-09-21 05:57:08 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-21 05:57:08 INFO  ---RUNTIME: Importing and monkey-patching took 6.292581558227539 ms
2022-09-21 05:57:15 INFO  ---RUNTIME: Original pipeline execution took 7712.463140487671 ms (excluding imports and monkey-patching)
2022-09-21 05:57:15 INFO  Starting execution of 1 what-if analyses...
2022-09-21 05:57:15 INFO  Start plan generation for analysis PermutationFeatureImportance...
2022-09-21 05:57:15 INFO  ---RUNTIME: Plan generation took 0.22029876708984375 ms
2022-09-21 05:57:15 INFO  Estimated runtime of original DAG is 5382.626056671143ms
2022-09-21 05:57:15 INFO  Performing Multi-Query Optimization
2022-09-21 05:57:15 INFO  Estimated unoptimized what-if runtime is 26913.130283355713ms
2022-09-21 05:57:15 INFO  Estimated optimised what-if runtime is 6711.661338806152ms
2022-09-21 05:57:15 INFO  Estimated optimisation runtime saving is 20201.46894454956ms
2022-09-21 05:57:15 INFO  ---RUNTIME: Multi-Query Optimization took 10.458230972290039 ms
2022-09-21 05:57:15 INFO  Executing generated plans
2022-09-21 05:57:23 INFO  ---RUNTIME: Execution took 7468.3191776275635 ms
2022-09-21 05:57:23 INFO  Done!
2022-09-21 05:57:23 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-21 05:57:23 INFO  Running instrumented original pipeline...
2022-09-21 05:57:23 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-21 05:57:23 INFO  ---RUNTIME: Importing and monkey-patching took 5.8498382568359375 ms
2022-09-21 05:57:31 INFO  ---RUNTIME: Original pipeline execution took 8310.80436706543 ms (excluding imports and monkey-patching)
2022-09-21 05:57:31 INFO  Starting execution of 1 what-if analyses...
2022-09-21 05:57:31 INFO  Start plan generation for analysis PermutationFeatureImportance...
2022-09-21 05:57:31 INFO  ---RUNTIME: Plan generation took 0.24127960205078125 ms
2022-09-21 05:57:31 INFO  Estimated runtime of original DAG is 6044.980525970459ms
2022-09-21 05:57:31 WARNING Skipping Multi-Query Optimization (instead, only combine execution DAGs)
2022-09-21 05:57:31 INFO  Estimated unoptimised what-if runtime is 30224.902629852295ms
2022-09-21 05:57:31 INFO  ---RUNTIME: Multi-Query Optimization took 14.417886734008789 ms
2022-09-21 05:57:31 INFO  Executing generated plans
2022-09-21 05:58:02 INFO  ---RUNTIME: Execution took 31373.977661132812 ms
2022-09-21 05:58:02 INFO  Done!
2022-09-21 05:58:02 INFO  # Finished -- repetition 3 of 7 
2022-09-21 05:58:02 INFO  # Optimization benchmark for feature_importance with args [['reviews', 'slow_loading', 'featurization_1', 'logistic_regression']] -- repetition 4 of 7
2022-09-21 05:58:02 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-21 05:58:02 INFO  Running instrumented original pipeline...
2022-09-21 05:58:03 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-21 05:58:03 INFO  ---RUNTIME: Importing and monkey-patching took 6.423234939575195 ms
2022-09-21 05:58:10 INFO  ---RUNTIME: Original pipeline execution took 8052.6838302612305 ms (excluding imports and monkey-patching)
2022-09-21 05:58:10 INFO  Starting execution of 1 what-if analyses...
2022-09-21 05:58:10 INFO  Start plan generation for analysis PermutationFeatureImportance...
2022-09-21 05:58:10 INFO  ---RUNTIME: Plan generation took 0.19407272338867188 ms
2022-09-21 05:58:10 INFO  Estimated runtime of original DAG is 5438.292503356934ms
2022-09-21 05:58:10 INFO  Performing Multi-Query Optimization
2022-09-21 05:58:10 INFO  Estimated unoptimized what-if runtime is 27191.462516784668ms
2022-09-21 05:58:10 INFO  Estimated optimised what-if runtime is 6846.381902694702ms
2022-09-21 05:58:10 INFO  Estimated optimisation runtime saving is 20345.080614089966ms
2022-09-21 05:58:10 INFO  ---RUNTIME: Multi-Query Optimization took 9.943723678588867 ms
2022-09-21 05:58:10 INFO  Executing generated plans
2022-09-21 05:58:18 INFO  ---RUNTIME: Execution took 7631.896018981934 ms
2022-09-21 05:58:18 INFO  Done!
2022-09-21 05:58:18 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-21 05:58:18 INFO  Running instrumented original pipeline...
2022-09-21 05:58:18 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-21 05:58:18 INFO  ---RUNTIME: Importing and monkey-patching took 5.805492401123047 ms
2022-09-21 05:58:26 INFO  ---RUNTIME: Original pipeline execution took 7874.335527420044 ms (excluding imports and monkey-patching)
2022-09-21 05:58:26 INFO  Starting execution of 1 what-if analyses...
2022-09-21 05:58:26 INFO  Start plan generation for analysis PermutationFeatureImportance...
2022-09-21 05:58:26 INFO  ---RUNTIME: Plan generation took 0.23555755615234375 ms
2022-09-21 05:58:26 INFO  Estimated runtime of original DAG is 5471.153736114502ms
2022-09-21 05:58:26 WARNING Skipping Multi-Query Optimization (instead, only combine execution DAGs)
2022-09-21 05:58:26 INFO  Estimated unoptimised what-if runtime is 27355.76868057251ms
2022-09-21 05:58:26 INFO  ---RUNTIME: Multi-Query Optimization took 14.622926712036133 ms
2022-09-21 05:58:26 INFO  Executing generated plans
2022-09-21 05:58:57 INFO  ---RUNTIME: Execution took 30745.561122894287 ms
2022-09-21 05:58:57 INFO  Done!
2022-09-21 05:58:57 INFO  # Finished -- repetition 4 of 7 
2022-09-21 05:58:57 INFO  # Optimization benchmark for feature_importance with args [['reviews', 'slow_loading', 'featurization_1', 'logistic_regression']] -- repetition 5 of 7
2022-09-21 05:58:57 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-21 05:58:57 INFO  Running instrumented original pipeline...
2022-09-21 05:58:57 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-21 05:58:57 INFO  ---RUNTIME: Importing and monkey-patching took 6.031274795532227 ms
2022-09-21 05:59:04 INFO  ---RUNTIME: Original pipeline execution took 7622.765779495239 ms (excluding imports and monkey-patching)
2022-09-21 05:59:04 INFO  Starting execution of 1 what-if analyses...
2022-09-21 05:59:04 INFO  Start plan generation for analysis PermutationFeatureImportance...
2022-09-21 05:59:04 INFO  ---RUNTIME: Plan generation took 0.2048015594482422 ms
2022-09-21 05:59:04 INFO  Estimated runtime of original DAG is 5334.748268127441ms
2022-09-21 05:59:04 INFO  Performing Multi-Query Optimization
2022-09-21 05:59:04 INFO  Estimated unoptimized what-if runtime is 26673.741340637207ms
2022-09-21 05:59:04 INFO  Estimated optimised what-if runtime is 6663.779735565186ms
2022-09-21 05:59:04 INFO  Estimated optimisation runtime saving is 20009.96160507202ms
2022-09-21 05:59:04 INFO  ---RUNTIME: Multi-Query Optimization took 10.272502899169922 ms
2022-09-21 05:59:04 INFO  Executing generated plans
2022-09-21 05:59:12 INFO  ---RUNTIME: Execution took 7940.373420715332 ms
2022-09-21 05:59:12 INFO  Done!
2022-09-21 05:59:12 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-21 05:59:12 INFO  Running instrumented original pipeline...
2022-09-21 05:59:12 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-21 05:59:12 INFO  ---RUNTIME: Importing and monkey-patching took 6.507396697998047 ms
2022-09-21 05:59:20 INFO  ---RUNTIME: Original pipeline execution took 8085.510969161987 ms (excluding imports and monkey-patching)
2022-09-21 05:59:20 INFO  Starting execution of 1 what-if analyses...
2022-09-21 05:59:20 INFO  Start plan generation for analysis PermutationFeatureImportance...
2022-09-21 05:59:20 INFO  ---RUNTIME: Plan generation took 0.25773048400878906 ms
2022-09-21 05:59:20 INFO  Estimated runtime of original DAG is 5678.728342056274ms
2022-09-21 05:59:20 WARNING Skipping Multi-Query Optimization (instead, only combine execution DAGs)
2022-09-21 05:59:20 INFO  Estimated unoptimised what-if runtime is 28393.641710281372ms
2022-09-21 05:59:20 INFO  ---RUNTIME: Multi-Query Optimization took 15.992403030395508 ms
2022-09-21 05:59:20 INFO  Executing generated plans
2022-09-21 05:59:51 INFO  ---RUNTIME: Execution took 30564.343690872192 ms
2022-09-21 05:59:51 INFO  Done!
2022-09-21 05:59:51 INFO  # Finished -- repetition 5 of 7 
2022-09-21 05:59:51 INFO  # Optimization benchmark for feature_importance with args [['reviews', 'slow_loading', 'featurization_1', 'logistic_regression']] -- repetition 6 of 7
2022-09-21 05:59:51 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-21 05:59:51 INFO  Running instrumented original pipeline...
2022-09-21 05:59:51 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-21 05:59:51 INFO  ---RUNTIME: Importing and monkey-patching took 5.839347839355469 ms
2022-09-21 05:59:59 INFO  ---RUNTIME: Original pipeline execution took 7556.849479675293 ms (excluding imports and monkey-patching)
2022-09-21 05:59:59 INFO  Starting execution of 1 what-if analyses...
2022-09-21 05:59:59 INFO  Start plan generation for analysis PermutationFeatureImportance...
2022-09-21 05:59:59 INFO  ---RUNTIME: Plan generation took 0.2181529998779297 ms
2022-09-21 05:59:59 INFO  Estimated runtime of original DAG is 5298.829555511475ms
2022-09-21 05:59:59 INFO  Performing Multi-Query Optimization
2022-09-21 05:59:59 INFO  Estimated unoptimized what-if runtime is 26494.147777557373ms
2022-09-21 05:59:59 INFO  Estimated optimised what-if runtime is 6634.06777381897ms
2022-09-21 05:59:59 INFO  Estimated optimisation runtime saving is 19860.080003738403ms
2022-09-21 05:59:59 INFO  ---RUNTIME: Multi-Query Optimization took 10.022878646850586 ms
2022-09-21 05:59:59 INFO  Executing generated plans
2022-09-21 06:00:06 INFO  ---RUNTIME: Execution took 7511.949062347412 ms
2022-09-21 06:00:06 INFO  Done!
2022-09-21 06:00:06 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-21 06:00:06 INFO  Running instrumented original pipeline...
2022-09-21 06:00:06 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-21 06:00:06 INFO  ---RUNTIME: Importing and monkey-patching took 5.841732025146484 ms
2022-09-21 06:00:14 INFO  ---RUNTIME: Original pipeline execution took 7552.73175239563 ms (excluding imports and monkey-patching)
2022-09-21 06:00:14 INFO  Starting execution of 1 what-if analyses...
2022-09-21 06:00:14 INFO  Start plan generation for analysis PermutationFeatureImportance...
2022-09-21 06:00:14 INFO  ---RUNTIME: Plan generation took 0.24175643920898438 ms
2022-09-21 06:00:14 INFO  Estimated runtime of original DAG is 5303.100347518921ms
2022-09-21 06:00:14 WARNING Skipping Multi-Query Optimization (instead, only combine execution DAGs)
2022-09-21 06:00:14 INFO  Estimated unoptimised what-if runtime is 26515.501737594604ms
2022-09-21 06:00:14 INFO  ---RUNTIME: Multi-Query Optimization took 14.396429061889648 ms
2022-09-21 06:00:14 INFO  Executing generated plans
2022-09-21 06:00:44 INFO  ---RUNTIME: Execution took 30433.18486213684 ms
2022-09-21 06:00:44 INFO  Done!
2022-09-21 06:00:44 INFO  # Finished -- repetition 6 of 7 
2022-09-21 06:00:44 INFO  # Optimization benchmark for feature_importance with args [['reviews', 'slow_loading', 'featurization_1', 'logistic_regression']] -- repetition 7 of 7
2022-09-21 06:00:44 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-21 06:00:44 INFO  Running instrumented original pipeline...
2022-09-21 06:00:44 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-21 06:00:44 INFO  ---RUNTIME: Importing and monkey-patching took 5.877256393432617 ms
2022-09-21 06:00:52 INFO  ---RUNTIME: Original pipeline execution took 7555.1605224609375 ms (excluding imports and monkey-patching)
2022-09-21 06:00:52 INFO  Starting execution of 1 what-if analyses...
2022-09-21 06:00:52 INFO  Start plan generation for analysis PermutationFeatureImportance...
2022-09-21 06:00:52 INFO  ---RUNTIME: Plan generation took 0.09775161743164062 ms
2022-09-21 06:00:52 INFO  Estimated runtime of original DAG is 5301.814079284668ms
2022-09-21 06:00:52 INFO  Performing Multi-Query Optimization
2022-09-21 06:00:52 INFO  Estimated unoptimized what-if runtime is 26509.07039642334ms
2022-09-21 06:00:52 INFO  Estimated optimised what-if runtime is 6631.618499755859ms
2022-09-21 06:00:52 INFO  Estimated optimisation runtime saving is 19877.45189666748ms
2022-09-21 06:00:52 INFO  ---RUNTIME: Multi-Query Optimization took 10.096549987792969 ms
2022-09-21 06:00:52 INFO  Executing generated plans
2022-09-21 06:00:59 INFO  ---RUNTIME: Execution took 7505.7971477508545 ms
2022-09-21 06:00:59 INFO  Done!
2022-09-21 06:00:59 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-21 06:00:59 INFO  Running instrumented original pipeline...
2022-09-21 06:00:59 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-21 06:00:59 INFO  ---RUNTIME: Importing and monkey-patching took 5.736589431762695 ms
2022-09-21 06:01:07 INFO  ---RUNTIME: Original pipeline execution took 7943.408966064453 ms (excluding imports and monkey-patching)
2022-09-21 06:01:07 INFO  Starting execution of 1 what-if analyses...
2022-09-21 06:01:07 INFO  Start plan generation for analysis PermutationFeatureImportance...
2022-09-21 06:01:07 INFO  ---RUNTIME: Plan generation took 0.2307891845703125 ms
2022-09-21 06:01:07 INFO  Estimated runtime of original DAG is 5316.514015197754ms
2022-09-21 06:01:07 WARNING Skipping Multi-Query Optimization (instead, only combine execution DAGs)
2022-09-21 06:01:07 INFO  Estimated unoptimised what-if runtime is 26582.57007598877ms
2022-09-21 06:01:07 INFO  ---RUNTIME: Multi-Query Optimization took 14.313697814941406 ms
2022-09-21 06:01:07 INFO  Executing generated plans
2022-09-21 06:01:38 INFO  ---RUNTIME: Execution took 30732.36393928528 ms
2022-09-21 06:01:38 INFO  Done!
2022-09-21 06:01:38 INFO  # Finished -- repetition 7 of 7 
2022-09-21 06:01:38 INFO  # Final results after all repetitions
2022-09-21 06:01:38 INFO     repetition  ... no_opt_what_if_execution_combined_model_training
0           0  ...                                       527.957201
1           1  ...                                       522.692919
2           2  ...                                       585.928202
3           3  ...                                       522.728443
4           4  ...                                       521.553278
5           5  ...                                       528.212309
6           6  ...                                       520.402431

[7 rows x 26 columns]
taskset -c 160-168 PROTOCOL_BUFFERS_PYTHON_IMPLEMENTATION=python python3.9 benchmarks_end_to_end.py feature_importance reviews slow_loading featurization_1 xgboost
2022-09-21 06:01:40.612822: W tensorflow/stream_executor/platform/default/dso_loader.cc:64] Could not load dynamic library 'libcudart.so.11.0'; dlerror: libcudart.so.11.0: cannot open shared object file: No such file or directory; LD_LIBRARY_PATH: /home/sgrafbe/mlwhatif/venv/lib/python3.9/site-packages/cv2/../../lib64:
2022-09-21 06:01:40.612870: I tensorflow/stream_executor/cuda/cudart_stub.cc:29] Ignore above cudart dlerror if you do not have a GPU set up on your machine.
2022-09-21 06:01:41 INFO  Patching sys.argv with ['mlwhatif', 'reviews', 'slow_loading', 'featurization_1', 'xgboost']
2022-09-21 06:01:41 INFO  Running instrumented original pipeline...
2022-09-21 06:01:41 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-21 06:01:42 INFO  ---RUNTIME: Importing and monkey-patching took 121.63019180297852 ms
2022-09-21 06:01:59 INFO  ---RUNTIME: Original pipeline execution took 17540.323495864868 ms (excluding imports and monkey-patching)
2022-09-21 06:01:59 INFO  Starting execution of 0 what-if analyses...
2022-09-21 06:01:59 INFO  Estimated runtime of original DAG is 15277.520179748535ms
2022-09-21 06:01:59 INFO  Performing Multi-Query Optimization
2022-09-21 06:01:59 INFO  Estimated unoptimized what-if runtime is 0ms
2022-09-21 06:01:59 INFO  Estimated optimised what-if runtime is 0ms
2022-09-21 06:01:59 INFO  Estimated optimisation runtime saving is 0ms
2022-09-21 06:01:59 INFO  ---RUNTIME: Multi-Query Optimization took 0.5142688751220703 ms
2022-09-21 06:01:59 INFO  Executing generated plans
2022-09-21 06:01:59 INFO  ---RUNTIME: Execution took 0.025987625122070312 ms
2022-09-21 06:01:59 INFO  Done!
2022-09-21 06:01:59 INFO  # Optimization benchmark for feature_importance with args [['reviews', 'slow_loading', 'featurization_1', 'xgboost']] -- repetition 1 of 7
2022-09-21 06:01:59 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-21 06:01:59 INFO  Running instrumented original pipeline...
2022-09-21 06:01:59 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-21 06:01:59 INFO  ---RUNTIME: Importing and monkey-patching took 6.16145133972168 ms
2022-09-21 06:02:07 INFO  ---RUNTIME: Original pipeline execution took 8392.483711242676 ms (excluding imports and monkey-patching)
2022-09-21 06:02:07 INFO  Starting execution of 1 what-if analyses...
2022-09-21 06:02:07 INFO  Start plan generation for analysis PermutationFeatureImportance...
2022-09-21 06:02:07 INFO  ---RUNTIME: Plan generation took 0.31876564025878906 ms
2022-09-21 06:02:07 INFO  Estimated runtime of original DAG is 6042.697429656982ms
2022-09-21 06:02:07 INFO  Performing Multi-Query Optimization
2022-09-21 06:02:07 INFO  Estimated unoptimized what-if runtime is 30213.487148284912ms
2022-09-21 06:02:07 INFO  Estimated optimised what-if runtime is 7538.763761520386ms
2022-09-21 06:02:07 INFO  Estimated optimisation runtime saving is 22674.723386764526ms
2022-09-21 06:02:07 INFO  ---RUNTIME: Multi-Query Optimization took 10.068893432617188 ms
2022-09-21 06:02:07 INFO  Executing generated plans
2022-09-21 06:02:16 INFO  ---RUNTIME: Execution took 8471.877574920654 ms
2022-09-21 06:02:16 INFO  Done!
2022-09-21 06:02:16 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-21 06:02:16 INFO  Running instrumented original pipeline...
2022-09-21 06:02:16 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-21 06:02:16 INFO  ---RUNTIME: Importing and monkey-patching took 5.805015563964844 ms
2022-09-21 06:02:24 INFO  ---RUNTIME: Original pipeline execution took 8215.593576431274 ms (excluding imports and monkey-patching)
2022-09-21 06:02:24 INFO  Starting execution of 1 what-if analyses...
2022-09-21 06:02:24 INFO  Start plan generation for analysis PermutationFeatureImportance...
2022-09-21 06:02:24 INFO  ---RUNTIME: Plan generation took 0.24652481079101562 ms
2022-09-21 06:02:24 INFO  Estimated runtime of original DAG is 6025.973558425903ms
2022-09-21 06:02:24 WARNING Skipping Multi-Query Optimization (instead, only combine execution DAGs)
2022-09-21 06:02:24 INFO  Estimated unoptimised what-if runtime is 30129.867792129517ms
2022-09-21 06:02:24 INFO  ---RUNTIME: Multi-Query Optimization took 14.672517776489258 ms
2022-09-21 06:02:24 INFO  Executing generated plans
2022-09-21 06:02:59 INFO  ---RUNTIME: Execution took 35204.28800582886 ms
2022-09-21 06:02:59 INFO  Done!
2022-09-21 06:02:59 INFO  # Finished -- repetition 1 of 7 
2022-09-21 06:02:59 INFO  # Optimization benchmark for feature_importance with args [['reviews', 'slow_loading', 'featurization_1', 'xgboost']] -- repetition 2 of 7
2022-09-21 06:02:59 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-21 06:02:59 INFO  Running instrumented original pipeline...
2022-09-21 06:02:59 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-21 06:02:59 INFO  ---RUNTIME: Importing and monkey-patching took 6.137847900390625 ms
2022-09-21 06:03:08 INFO  ---RUNTIME: Original pipeline execution took 8234.522342681885 ms (excluding imports and monkey-patching)
2022-09-21 06:03:08 INFO  Starting execution of 1 what-if analyses...
2022-09-21 06:03:08 INFO  Start plan generation for analysis PermutationFeatureImportance...
2022-09-21 06:03:08 INFO  ---RUNTIME: Plan generation took 0.22292137145996094 ms
2022-09-21 06:03:08 INFO  Estimated runtime of original DAG is 6010.734796524048ms
2022-09-21 06:03:08 INFO  Performing Multi-Query Optimization
2022-09-21 06:03:08 INFO  Estimated unoptimized what-if runtime is 30053.67398262024ms
2022-09-21 06:03:08 INFO  Estimated optimised what-if runtime is 7508.82625579834ms
2022-09-21 06:03:08 INFO  Estimated optimisation runtime saving is 22544.8477268219ms
2022-09-21 06:03:08 INFO  ---RUNTIME: Multi-Query Optimization took 10.162591934204102 ms
2022-09-21 06:03:08 INFO  Executing generated plans
2022-09-21 06:03:16 INFO  ---RUNTIME: Execution took 8431.315183639526 ms
2022-09-21 06:03:16 INFO  Done!
2022-09-21 06:03:16 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-21 06:03:16 INFO  Running instrumented original pipeline...
2022-09-21 06:03:16 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-21 06:03:16 INFO  ---RUNTIME: Importing and monkey-patching took 5.640745162963867 ms
2022-09-21 06:03:24 INFO  ---RUNTIME: Original pipeline execution took 8244.273662567139 ms (excluding imports and monkey-patching)
2022-09-21 06:03:24 INFO  Starting execution of 1 what-if analyses...
2022-09-21 06:03:24 INFO  Start plan generation for analysis PermutationFeatureImportance...
2022-09-21 06:03:24 INFO  ---RUNTIME: Plan generation took 0.21147727966308594 ms
2022-09-21 06:03:24 INFO  Estimated runtime of original DAG is 6021.513223648071ms
2022-09-21 06:03:24 WARNING Skipping Multi-Query Optimization (instead, only combine execution DAGs)
2022-09-21 06:03:24 INFO  Estimated unoptimised what-if runtime is 30107.566118240356ms
2022-09-21 06:03:24 INFO  ---RUNTIME: Multi-Query Optimization took 14.156103134155273 ms
2022-09-21 06:03:24 INFO  Executing generated plans
2022-09-21 06:03:59 INFO  ---RUNTIME: Execution took 34477.81777381897 ms
2022-09-21 06:03:59 INFO  Done!
2022-09-21 06:03:59 INFO  # Finished -- repetition 2 of 7 
2022-09-21 06:03:59 INFO  # Optimization benchmark for feature_importance with args [['reviews', 'slow_loading', 'featurization_1', 'xgboost']] -- repetition 3 of 7
2022-09-21 06:03:59 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-21 06:03:59 INFO  Running instrumented original pipeline...
2022-09-21 06:03:59 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-21 06:03:59 INFO  ---RUNTIME: Importing and monkey-patching took 5.997419357299805 ms
2022-09-21 06:04:07 INFO  ---RUNTIME: Original pipeline execution took 8302.494287490845 ms (excluding imports and monkey-patching)
2022-09-21 06:04:07 INFO  Starting execution of 1 what-if analyses...
2022-09-21 06:04:07 INFO  Start plan generation for analysis PermutationFeatureImportance...
2022-09-21 06:04:07 INFO  ---RUNTIME: Plan generation took 0.23126602172851562 ms
2022-09-21 06:04:07 INFO  Estimated runtime of original DAG is 6032.141208648682ms
2022-09-21 06:04:07 INFO  Performing Multi-Query Optimization
2022-09-21 06:04:07 INFO  Estimated unoptimized what-if runtime is 30160.70604324341ms
2022-09-21 06:04:07 INFO  Estimated optimised what-if runtime is 7536.775588989258ms
2022-09-21 06:04:07 INFO  Estimated optimisation runtime saving is 22623.93045425415ms
2022-09-21 06:04:07 INFO  ---RUNTIME: Multi-Query Optimization took 9.983539581298828 ms
2022-09-21 06:04:07 INFO  Executing generated plans
2022-09-21 06:04:16 INFO  ---RUNTIME: Execution took 8454.033851623535 ms
2022-09-21 06:04:16 INFO  Done!
2022-09-21 06:04:16 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-21 06:04:16 INFO  Running instrumented original pipeline...
2022-09-21 06:04:16 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-21 06:04:16 INFO  ---RUNTIME: Importing and monkey-patching took 6.028413772583008 ms
2022-09-21 06:04:24 INFO  ---RUNTIME: Original pipeline execution took 8335.529088973999 ms (excluding imports and monkey-patching)
2022-09-21 06:04:24 INFO  Starting execution of 1 what-if analyses...
2022-09-21 06:04:24 INFO  Start plan generation for analysis PermutationFeatureImportance...
2022-09-21 06:04:24 INFO  ---RUNTIME: Plan generation took 0.2186298370361328 ms
2022-09-21 06:04:24 INFO  Estimated runtime of original DAG is 6093.95694732666ms
2022-09-21 06:04:24 WARNING Skipping Multi-Query Optimization (instead, only combine execution DAGs)
2022-09-21 06:04:24 INFO  Estimated unoptimised what-if runtime is 30469.7847366333ms
2022-09-21 06:04:24 INFO  ---RUNTIME: Multi-Query Optimization took 14.415264129638672 ms
2022-09-21 06:04:24 INFO  Executing generated plans
2022-09-21 06:04:58 INFO  ---RUNTIME: Execution took 34356.86779022217 ms
2022-09-21 06:04:58 INFO  Done!
2022-09-21 06:04:58 INFO  # Finished -- repetition 3 of 7 
2022-09-21 06:04:58 INFO  # Optimization benchmark for feature_importance with args [['reviews', 'slow_loading', 'featurization_1', 'xgboost']] -- repetition 4 of 7
2022-09-21 06:04:58 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-21 06:04:58 INFO  Running instrumented original pipeline...
2022-09-21 06:04:59 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-21 06:04:59 INFO  ---RUNTIME: Importing and monkey-patching took 6.375551223754883 ms
2022-09-21 06:05:07 INFO  ---RUNTIME: Original pipeline execution took 8571.49624824524 ms (excluding imports and monkey-patching)
2022-09-21 06:05:07 INFO  Starting execution of 1 what-if analyses...
2022-09-21 06:05:07 INFO  Start plan generation for analysis PermutationFeatureImportance...
2022-09-21 06:05:07 INFO  ---RUNTIME: Plan generation took 0.24247169494628906 ms
2022-09-21 06:05:07 INFO  Estimated runtime of original DAG is 6049.933671951294ms
2022-09-21 06:05:07 INFO  Performing Multi-Query Optimization
2022-09-21 06:05:07 INFO  Estimated unoptimized what-if runtime is 30249.66835975647ms
2022-09-21 06:05:07 INFO  Estimated optimised what-if runtime is 7564.702987670898ms
2022-09-21 06:05:07 INFO  Estimated optimisation runtime saving is 22684.96537208557ms
2022-09-21 06:05:07 INFO  ---RUNTIME: Multi-Query Optimization took 9.971380233764648 ms
2022-09-21 06:05:07 INFO  Executing generated plans
2022-09-21 06:05:15 INFO  ---RUNTIME: Execution took 8490.157842636108 ms
2022-09-21 06:05:15 INFO  Done!
2022-09-21 06:05:15 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-21 06:05:15 INFO  Running instrumented original pipeline...
2022-09-21 06:05:15 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-21 06:05:15 INFO  ---RUNTIME: Importing and monkey-patching took 5.684852600097656 ms
2022-09-21 06:05:24 INFO  ---RUNTIME: Original pipeline execution took 8354.261875152588 ms (excluding imports and monkey-patching)
2022-09-21 06:05:24 INFO  Starting execution of 1 what-if analyses...
2022-09-21 06:05:24 INFO  Start plan generation for analysis PermutationFeatureImportance...
2022-09-21 06:05:24 INFO  ---RUNTIME: Plan generation took 0.20813941955566406 ms
2022-09-21 06:05:24 INFO  Estimated runtime of original DAG is 6055.850267410278ms
2022-09-21 06:05:24 WARNING Skipping Multi-Query Optimization (instead, only combine execution DAGs)
2022-09-21 06:05:24 INFO  Estimated unoptimised what-if runtime is 30279.25133705139ms
2022-09-21 06:05:24 INFO  ---RUNTIME: Multi-Query Optimization took 14.199495315551758 ms
2022-09-21 06:05:24 INFO  Executing generated plans
2022-09-21 06:05:58 INFO  ---RUNTIME: Execution took 34479.02178764343 ms
2022-09-21 06:05:58 INFO  Done!
2022-09-21 06:05:58 INFO  # Finished -- repetition 4 of 7 
2022-09-21 06:05:58 INFO  # Optimization benchmark for feature_importance with args [['reviews', 'slow_loading', 'featurization_1', 'xgboost']] -- repetition 5 of 7
2022-09-21 06:05:58 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-21 06:05:58 INFO  Running instrumented original pipeline...
2022-09-21 06:05:58 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-21 06:05:58 INFO  ---RUNTIME: Importing and monkey-patching took 5.9871673583984375 ms
2022-09-21 06:06:08 INFO  ---RUNTIME: Original pipeline execution took 9413.322687149048 ms (excluding imports and monkey-patching)
2022-09-21 06:06:08 INFO  Starting execution of 1 what-if analyses...
2022-09-21 06:06:08 INFO  Start plan generation for analysis PermutationFeatureImportance...
2022-09-21 06:06:08 INFO  ---RUNTIME: Plan generation took 0.22983551025390625 ms
2022-09-21 06:06:08 INFO  Estimated runtime of original DAG is 6588.168144226074ms
2022-09-21 06:06:08 INFO  Performing Multi-Query Optimization
2022-09-21 06:06:08 INFO  Estimated unoptimized what-if runtime is 32940.84072113037ms
2022-09-21 06:06:08 INFO  Estimated optimised what-if runtime is 8189.98384475708ms
2022-09-21 06:06:08 INFO  Estimated optimisation runtime saving is 24750.85687637329ms
2022-09-21 06:06:08 INFO  ---RUNTIME: Multi-Query Optimization took 10.525941848754883 ms
2022-09-21 06:06:08 INFO  Executing generated plans
2022-09-21 06:06:17 INFO  ---RUNTIME: Execution took 9621.017932891846 ms
2022-09-21 06:06:17 INFO  Done!
2022-09-21 06:06:17 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-21 06:06:17 INFO  Running instrumented original pipeline...
2022-09-21 06:06:17 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-21 06:06:17 INFO  ---RUNTIME: Importing and monkey-patching took 5.779504776000977 ms
2022-09-21 06:06:27 INFO  ---RUNTIME: Original pipeline execution took 9522.084712982178 ms (excluding imports and monkey-patching)
2022-09-21 06:06:27 INFO  Starting execution of 1 what-if analyses...
2022-09-21 06:06:27 INFO  Start plan generation for analysis PermutationFeatureImportance...
2022-09-21 06:06:27 INFO  ---RUNTIME: Plan generation took 0.24890899658203125 ms
2022-09-21 06:06:27 INFO  Estimated runtime of original DAG is 7098.180770874023ms
2022-09-21 06:06:27 WARNING Skipping Multi-Query Optimization (instead, only combine execution DAGs)
2022-09-21 06:06:27 INFO  Estimated unoptimised what-if runtime is 35490.90385437012ms
2022-09-21 06:06:27 INFO  ---RUNTIME: Multi-Query Optimization took 22.73249626159668 ms
2022-09-21 06:06:27 INFO  Executing generated plans
2022-09-21 06:07:05 INFO  ---RUNTIME: Execution took 37979.002475738525 ms
2022-09-21 06:07:05 INFO  Done!
2022-09-21 06:07:05 INFO  # Finished -- repetition 5 of 7 
2022-09-21 06:07:05 INFO  # Optimization benchmark for feature_importance with args [['reviews', 'slow_loading', 'featurization_1', 'xgboost']] -- repetition 6 of 7
2022-09-21 06:07:05 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-21 06:07:05 INFO  Running instrumented original pipeline...
2022-09-21 06:07:05 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-21 06:07:05 INFO  ---RUNTIME: Importing and monkey-patching took 6.109952926635742 ms
2022-09-21 06:07:13 INFO  ---RUNTIME: Original pipeline execution took 8453.954219818115 ms (excluding imports and monkey-patching)
2022-09-21 06:07:13 INFO  Starting execution of 1 what-if analyses...
2022-09-21 06:07:13 INFO  Start plan generation for analysis PermutationFeatureImportance...
2022-09-21 06:07:13 INFO  ---RUNTIME: Plan generation took 0.2617835998535156 ms
2022-09-21 06:07:13 INFO  Estimated runtime of original DAG is 6193.610668182373ms
2022-09-21 06:07:13 INFO  Performing Multi-Query Optimization
2022-09-21 06:07:13 INFO  Estimated unoptimized what-if runtime is 30968.053340911865ms
2022-09-21 06:07:13 INFO  Estimated optimised what-if runtime is 7767.99201965332ms
2022-09-21 06:07:13 INFO  Estimated optimisation runtime saving is 23200.061321258545ms
2022-09-21 06:07:13 INFO  ---RUNTIME: Multi-Query Optimization took 10.001897811889648 ms
2022-09-21 06:07:13 INFO  Executing generated plans
2022-09-21 06:07:23 INFO  ---RUNTIME: Execution took 9253.995418548584 ms
2022-09-21 06:07:23 INFO  Done!
2022-09-21 06:07:23 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-21 06:07:23 INFO  Running instrumented original pipeline...
2022-09-21 06:07:23 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-21 06:07:23 INFO  ---RUNTIME: Importing and monkey-patching took 5.7506561279296875 ms
2022-09-21 06:07:33 INFO  ---RUNTIME: Original pipeline execution took 10217.88215637207 ms (excluding imports and monkey-patching)
2022-09-21 06:07:33 INFO  Starting execution of 1 what-if analyses...
2022-09-21 06:07:33 INFO  Start plan generation for analysis PermutationFeatureImportance...
2022-09-21 06:07:33 INFO  ---RUNTIME: Plan generation took 0.2205371856689453 ms
2022-09-21 06:07:33 INFO  Estimated runtime of original DAG is 7535.631895065308ms
2022-09-21 06:07:33 WARNING Skipping Multi-Query Optimization (instead, only combine execution DAGs)
2022-09-21 06:07:33 INFO  Estimated unoptimised what-if runtime is 37678.15947532654ms
2022-09-21 06:07:33 INFO  ---RUNTIME: Multi-Query Optimization took 15.251874923706055 ms
2022-09-21 06:07:33 INFO  Executing generated plans
2022-09-21 06:08:09 INFO  ---RUNTIME: Execution took 36455.77430725098 ms
2022-09-21 06:08:09 INFO  Done!
2022-09-21 06:08:09 INFO  # Finished -- repetition 6 of 7 
2022-09-21 06:08:09 INFO  # Optimization benchmark for feature_importance with args [['reviews', 'slow_loading', 'featurization_1', 'xgboost']] -- repetition 7 of 7
2022-09-21 06:08:09 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-21 06:08:09 INFO  Running instrumented original pipeline...
2022-09-21 06:08:09 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-21 06:08:09 INFO  ---RUNTIME: Importing and monkey-patching took 7.605075836181641 ms
2022-09-21 06:08:19 INFO  ---RUNTIME: Original pipeline execution took 9912.849187850952 ms (excluding imports and monkey-patching)
2022-09-21 06:08:19 INFO  Starting execution of 1 what-if analyses...
2022-09-21 06:08:19 INFO  Start plan generation for analysis PermutationFeatureImportance...
2022-09-21 06:08:19 INFO  ---RUNTIME: Plan generation took 0.118255615234375 ms
2022-09-21 06:08:19 INFO  Estimated runtime of original DAG is 7071.040868759155ms
2022-09-21 06:08:19 INFO  Performing Multi-Query Optimization
2022-09-21 06:08:19 INFO  Estimated unoptimized what-if runtime is 35355.20434379578ms
2022-09-21 06:08:19 INFO  Estimated optimised what-if runtime is 8562.296867370605ms
2022-09-21 06:08:19 INFO  Estimated optimisation runtime saving is 26792.90747642517ms
2022-09-21 06:08:19 INFO  ---RUNTIME: Multi-Query Optimization took 10.11967658996582 ms
2022-09-21 06:08:19 INFO  Executing generated plans
2022-09-21 06:08:28 INFO  ---RUNTIME: Execution took 8559.651374816895 ms
2022-09-21 06:08:28 INFO  Done!
2022-09-21 06:08:28 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-21 06:08:28 INFO  Running instrumented original pipeline...
2022-09-21 06:08:28 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-21 06:08:28 INFO  ---RUNTIME: Importing and monkey-patching took 5.707025527954102 ms
2022-09-21 06:08:37 INFO  ---RUNTIME: Original pipeline execution took 8681.024312973022 ms (excluding imports and monkey-patching)
2022-09-21 06:08:37 INFO  Starting execution of 1 what-if analyses...
2022-09-21 06:08:37 INFO  Start plan generation for analysis PermutationFeatureImportance...
2022-09-21 06:08:37 INFO  ---RUNTIME: Plan generation took 0.2224445343017578 ms
2022-09-21 06:08:37 INFO  Estimated runtime of original DAG is 6080.511808395386ms
2022-09-21 06:08:37 WARNING Skipping Multi-Query Optimization (instead, only combine execution DAGs)
2022-09-21 06:08:37 INFO  Estimated unoptimised what-if runtime is 30402.55904197693ms
2022-09-21 06:08:37 INFO  ---RUNTIME: Multi-Query Optimization took 14.241933822631836 ms
2022-09-21 06:08:37 INFO  Executing generated plans
2022-09-21 06:09:13 INFO  ---RUNTIME: Execution took 36178.14254760742 ms
2022-09-21 06:09:13 INFO  Done!
2022-09-21 06:09:13 INFO  # Finished -- repetition 7 of 7 
2022-09-21 06:09:13 INFO  # Final results after all repetitions
2022-09-21 06:09:13 INFO     repetition  ... no_opt_what_if_execution_combined_model_training
0           0  ...                                      4379.238367
1           1  ...                                      4315.237761
2           2  ...                                      4277.388811
3           3  ...                                      4294.511795
4           4  ...                                      4406.906843
5           5  ...                                      5276.928663
6           6  ...                                      5033.617258

[7 rows x 26 columns]
taskset -c 160-168 PROTOCOL_BUFFERS_PYTHON_IMPLEMENTATION=python python3.9 benchmarks_end_to_end.py feature_importance reviews slow_loading featurization_1 neural_network
2022-09-21 06:09:15.884037: W tensorflow/stream_executor/platform/default/dso_loader.cc:64] Could not load dynamic library 'libcudart.so.11.0'; dlerror: libcudart.so.11.0: cannot open shared object file: No such file or directory; LD_LIBRARY_PATH: /home/sgrafbe/mlwhatif/venv/lib/python3.9/site-packages/cv2/../../lib64:
2022-09-21 06:09:15.884099: I tensorflow/stream_executor/cuda/cudart_stub.cc:29] Ignore above cudart dlerror if you do not have a GPU set up on your machine.
2022-09-21 06:09:17 INFO  Patching sys.argv with ['mlwhatif', 'reviews', 'slow_loading', 'featurization_1', 'neural_network']
2022-09-21 06:09:17 INFO  Running instrumented original pipeline...
2022-09-21 06:09:17 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-21 06:09:17 INFO  ---RUNTIME: Importing and monkey-patching took 155.52377700805664 ms
2022-09-21 06:09:25.255297: W tensorflow/stream_executor/platform/default/dso_loader.cc:64] Could not load dynamic library 'libcuda.so.1'; dlerror: libcuda.so.1: cannot open shared object file: No such file or directory; LD_LIBRARY_PATH: /home/sgrafbe/mlwhatif/venv/lib/python3.9/site-packages/cv2/../../lib64:
2022-09-21 06:09:25.255343: W tensorflow/stream_executor/cuda/cuda_driver.cc:326] failed call to cuInit: UNKNOWN ERROR (303)
2022-09-21 06:09:25.255375: I tensorflow/stream_executor/cuda/cuda_diagnostics.cc:156] kernel driver does not appear to be running on this host (angus): /proc/driver/nvidia/version does not exist
2022-09-21 06:09:25.255986: I tensorflow/core/platform/cpu_feature_guard.cc:142] This TensorFlow binary is optimized with oneAPI Deep Neural Network Library (oneDNN) to use the following CPU instructions in performance-critical operations:  AVX2 FMA
To enable them in other operations, rebuild TensorFlow with the appropriate compiler flags.
2022-09-21 06:09:25.577887: I tensorflow/compiler/mlir/mlir_graph_optimization_pass.cc:176] None of the MLIR Optimization Passes are enabled (registered 2)
2022-09-21 06:09:25.590223: I tensorflow/core/platform/profile_utils/cpu_utils.cc:114] CPU Frequency: 2595130000 Hz
2022-09-21 06:09:32 INFO  ---RUNTIME: Original pipeline execution took 14455.69896697998 ms (excluding imports and monkey-patching)
2022-09-21 06:09:32 INFO  Starting execution of 0 what-if analyses...
2022-09-21 06:09:32 INFO  Estimated runtime of original DAG is 11541.950464248657ms
2022-09-21 06:09:32 INFO  Performing Multi-Query Optimization
2022-09-21 06:09:32 INFO  Estimated unoptimized what-if runtime is 0ms
2022-09-21 06:09:32 INFO  Estimated optimised what-if runtime is 0ms
2022-09-21 06:09:32 INFO  Estimated optimisation runtime saving is 0ms
2022-09-21 06:09:32 INFO  ---RUNTIME: Multi-Query Optimization took 0.5400180816650391 ms
2022-09-21 06:09:32 INFO  Executing generated plans
2022-09-21 06:09:32 INFO  ---RUNTIME: Execution took 0.018596649169921875 ms
2022-09-21 06:09:32 INFO  Done!
2022-09-21 06:09:32 INFO  # Optimization benchmark for feature_importance with args [['reviews', 'slow_loading', 'featurization_1', 'neural_network']] -- repetition 1 of 7
2022-09-21 06:09:32 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-21 06:09:32 INFO  Running instrumented original pipeline...
2022-09-21 06:09:32 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-21 06:09:32 INFO  ---RUNTIME: Importing and monkey-patching took 7.10749626159668 ms
2022-09-21 06:09:45 INFO  ---RUNTIME: Original pipeline execution took 13353.132963180542 ms (excluding imports and monkey-patching)
2022-09-21 06:09:45 INFO  Starting execution of 1 what-if analyses...
2022-09-21 06:09:45 INFO  Start plan generation for analysis PermutationFeatureImportance...
2022-09-21 06:09:45 INFO  ---RUNTIME: Plan generation took 0.2009868621826172 ms
2022-09-21 06:09:45 INFO  Estimated runtime of original DAG is 10574.427843093872ms
2022-09-21 06:09:45 INFO  Performing Multi-Query Optimization
2022-09-21 06:09:45 INFO  Estimated unoptimized what-if runtime is 52872.13921546936ms
2022-09-21 06:09:45 INFO  Estimated optimised what-if runtime is 13585.826635360718ms
2022-09-21 06:09:45 INFO  Estimated optimisation runtime saving is 39286.31258010864ms
2022-09-21 06:09:45 INFO  ---RUNTIME: Multi-Query Optimization took 10.076284408569336 ms
2022-09-21 06:09:45 INFO  Executing generated plans
2022-09-21 06:09:58 INFO  ---RUNTIME: Execution took 13307.803869247437 ms
2022-09-21 06:09:58 INFO  Done!
2022-09-21 06:09:58 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-21 06:09:58 INFO  Running instrumented original pipeline...
2022-09-21 06:09:58 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-21 06:09:58 INFO  ---RUNTIME: Importing and monkey-patching took 12.530088424682617 ms
2022-09-21 06:10:12 INFO  ---RUNTIME: Original pipeline execution took 13408.150434494019 ms (excluding imports and monkey-patching)
2022-09-21 06:10:12 INFO  Starting execution of 1 what-if analyses...
2022-09-21 06:10:12 INFO  Start plan generation for analysis PermutationFeatureImportance...
2022-09-21 06:10:12 INFO  ---RUNTIME: Plan generation took 0.10800361633300781 ms
2022-09-21 06:10:12 INFO  Estimated runtime of original DAG is 10186.203241348267ms
2022-09-21 06:10:12 WARNING Skipping Multi-Query Optimization (instead, only combine execution DAGs)
2022-09-21 06:10:12 INFO  Estimated unoptimised what-if runtime is 50931.01620674133ms
2022-09-21 06:10:12 INFO  ---RUNTIME: Multi-Query Optimization took 14.440774917602539 ms
2022-09-21 06:10:12 INFO  Executing generated plans
2022-09-21 06:11:04 INFO  ---RUNTIME: Execution took 52559.645652770996 ms
2022-09-21 06:11:04 INFO  Done!
2022-09-21 06:11:04 INFO  # Finished -- repetition 1 of 7 
2022-09-21 06:11:04 INFO  # Optimization benchmark for feature_importance with args [['reviews', 'slow_loading', 'featurization_1', 'neural_network']] -- repetition 2 of 7
2022-09-21 06:11:04 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-21 06:11:04 INFO  Running instrumented original pipeline...
2022-09-21 06:11:04 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-21 06:11:04 INFO  ---RUNTIME: Importing and monkey-patching took 5.930185317993164 ms
2022-09-21 06:11:16 INFO  ---RUNTIME: Original pipeline execution took 11483.591318130493 ms (excluding imports and monkey-patching)
2022-09-21 06:11:16 INFO  Starting execution of 1 what-if analyses...
2022-09-21 06:11:16 INFO  Start plan generation for analysis PermutationFeatureImportance...
2022-09-21 06:11:16 INFO  ---RUNTIME: Plan generation took 0.11324882507324219 ms
2022-09-21 06:11:16 INFO  Estimated runtime of original DAG is 9211.673498153687ms
2022-09-21 06:11:16 INFO  Performing Multi-Query Optimization
2022-09-21 06:11:16 INFO  Estimated unoptimized what-if runtime is 46058.36749076843ms
2022-09-21 06:11:16 INFO  Estimated optimised what-if runtime is 12346.518754959106ms
2022-09-21 06:11:16 INFO  Estimated optimisation runtime saving is 33711.848735809326ms
2022-09-21 06:11:16 INFO  ---RUNTIME: Multi-Query Optimization took 10.003805160522461 ms
2022-09-21 06:11:16 INFO  Executing generated plans
2022-09-21 06:11:29 INFO  ---RUNTIME: Execution took 12986.571550369263 ms
2022-09-21 06:11:29 INFO  Done!
2022-09-21 06:11:29 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-21 06:11:29 INFO  Running instrumented original pipeline...
2022-09-21 06:11:29 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-21 06:11:29 INFO  ---RUNTIME: Importing and monkey-patching took 6.646394729614258 ms
2022-09-21 06:11:40 INFO  ---RUNTIME: Original pipeline execution took 11404.268741607666 ms (excluding imports and monkey-patching)
2022-09-21 06:11:40 INFO  Starting execution of 1 what-if analyses...
2022-09-21 06:11:40 INFO  Start plan generation for analysis PermutationFeatureImportance...
2022-09-21 06:11:40 INFO  ---RUNTIME: Plan generation took 0.12755393981933594 ms
2022-09-21 06:11:40 INFO  Estimated runtime of original DAG is 9143.502473831177ms
2022-09-21 06:11:40 WARNING Skipping Multi-Query Optimization (instead, only combine execution DAGs)
2022-09-21 06:11:40 INFO  Estimated unoptimised what-if runtime is 45717.512369155884ms
2022-09-21 06:11:40 INFO  ---RUNTIME: Multi-Query Optimization took 14.108657836914062 ms
2022-09-21 06:11:40 INFO  Executing generated plans
2022-09-21 06:12:33 INFO  ---RUNTIME: Execution took 53243.815898895264 ms
2022-09-21 06:12:33 INFO  Done!
2022-09-21 06:12:33 INFO  # Finished -- repetition 2 of 7 
2022-09-21 06:12:33 INFO  # Optimization benchmark for feature_importance with args [['reviews', 'slow_loading', 'featurization_1', 'neural_network']] -- repetition 3 of 7
2022-09-21 06:12:33 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-21 06:12:33 INFO  Running instrumented original pipeline...
2022-09-21 06:12:34 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-21 06:12:34 INFO  ---RUNTIME: Importing and monkey-patching took 9.452342987060547 ms
2022-09-21 06:12:46 INFO  ---RUNTIME: Original pipeline execution took 12657.696723937988 ms (excluding imports and monkey-patching)
2022-09-21 06:12:46 INFO  Starting execution of 1 what-if analyses...
2022-09-21 06:12:46 INFO  Start plan generation for analysis PermutationFeatureImportance...
2022-09-21 06:12:46 INFO  ---RUNTIME: Plan generation took 0.13518333435058594 ms
2022-09-21 06:12:46 INFO  Estimated runtime of original DAG is 10185.033798217773ms
2022-09-21 06:12:46 INFO  Performing Multi-Query Optimization
2022-09-21 06:12:46 INFO  Estimated unoptimized what-if runtime is 50925.16899108887ms
2022-09-21 06:12:46 INFO  Estimated optimised what-if runtime is 13225.838422775269ms
2022-09-21 06:12:46 INFO  Estimated optimisation runtime saving is 37699.3305683136ms
2022-09-21 06:12:46 INFO  ---RUNTIME: Multi-Query Optimization took 9.879827499389648 ms
2022-09-21 06:12:46 INFO  Executing generated plans
2022-09-21 06:13:00 INFO  ---RUNTIME: Execution took 13731.113910675049 ms
2022-09-21 06:13:00 INFO  Done!
2022-09-21 06:13:00 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-21 06:13:00 INFO  Running instrumented original pipeline...
2022-09-21 06:13:00 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-21 06:13:00 INFO  ---RUNTIME: Importing and monkey-patching took 5.794763565063477 ms
2022-09-21 06:13:13 INFO  ---RUNTIME: Original pipeline execution took 12962.732076644897 ms (excluding imports and monkey-patching)
2022-09-21 06:13:13 INFO  Starting execution of 1 what-if analyses...
2022-09-21 06:13:13 INFO  Start plan generation for analysis PermutationFeatureImportance...
2022-09-21 06:13:13 INFO  ---RUNTIME: Plan generation took 0.19502639770507812 ms
2022-09-21 06:13:13 INFO  Estimated runtime of original DAG is 10658.926963806152ms
2022-09-21 06:13:13 WARNING Skipping Multi-Query Optimization (instead, only combine execution DAGs)
2022-09-21 06:13:13 INFO  Estimated unoptimised what-if runtime is 53294.63481903076ms
2022-09-21 06:13:13 INFO  ---RUNTIME: Multi-Query Optimization took 22.057533264160156 ms
2022-09-21 06:13:13 INFO  Executing generated plans
2022-09-21 06:14:05 INFO  ---RUNTIME: Execution took 51786.86594963074 ms
2022-09-21 06:14:05 INFO  Done!
2022-09-21 06:14:05 INFO  # Finished -- repetition 3 of 7 
2022-09-21 06:14:05 INFO  # Optimization benchmark for feature_importance with args [['reviews', 'slow_loading', 'featurization_1', 'neural_network']] -- repetition 4 of 7
2022-09-21 06:14:05 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-21 06:14:05 INFO  Running instrumented original pipeline...
2022-09-21 06:14:05 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-21 06:14:05 INFO  ---RUNTIME: Importing and monkey-patching took 6.421804428100586 ms
2022-09-21 06:14:16 INFO  ---RUNTIME: Original pipeline execution took 11459.553003311157 ms (excluding imports and monkey-patching)
2022-09-21 06:14:16 INFO  Starting execution of 1 what-if analyses...
2022-09-21 06:14:16 INFO  Start plan generation for analysis PermutationFeatureImportance...
2022-09-21 06:14:16 INFO  ---RUNTIME: Plan generation took 0.11277198791503906 ms
2022-09-21 06:14:16 INFO  Estimated runtime of original DAG is 9171.765327453613ms
2022-09-21 06:14:16 INFO  Performing Multi-Query Optimization
2022-09-21 06:14:16 INFO  Estimated unoptimized what-if runtime is 45858.82663726807ms
2022-09-21 06:14:16 INFO  Estimated optimised what-if runtime is 12069.128036499023ms
2022-09-21 06:14:16 INFO  Estimated optimisation runtime saving is 33789.69860076904ms
2022-09-21 06:14:16 INFO  ---RUNTIME: Multi-Query Optimization took 9.712696075439453 ms
2022-09-21 06:14:16 INFO  Executing generated plans
2022-09-21 06:14:30 INFO  ---RUNTIME: Execution took 13404.646158218384 ms
2022-09-21 06:14:30 INFO  Done!
2022-09-21 06:14:30 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-21 06:14:30 INFO  Running instrumented original pipeline...
2022-09-21 06:14:30 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-21 06:14:30 INFO  ---RUNTIME: Importing and monkey-patching took 6.797552108764648 ms
2022-09-21 06:14:42 INFO  ---RUNTIME: Original pipeline execution took 12200.927734375 ms (excluding imports and monkey-patching)
2022-09-21 06:14:42 INFO  Starting execution of 1 what-if analyses...
2022-09-21 06:14:42 INFO  Start plan generation for analysis PermutationFeatureImportance...
2022-09-21 06:14:42 INFO  ---RUNTIME: Plan generation took 0.10061264038085938 ms
2022-09-21 06:14:42 INFO  Estimated runtime of original DAG is 9815.984725952148ms
2022-09-21 06:14:42 WARNING Skipping Multi-Query Optimization (instead, only combine execution DAGs)
2022-09-21 06:14:42 INFO  Estimated unoptimised what-if runtime is 49079.92362976074ms
2022-09-21 06:14:42 INFO  ---RUNTIME: Multi-Query Optimization took 14.239311218261719 ms
2022-09-21 06:14:42 INFO  Executing generated plans
2022-09-21 06:15:36 INFO  ---RUNTIME: Execution took 53740.12494087219 ms
2022-09-21 06:15:36 INFO  Done!
2022-09-21 06:15:36 INFO  # Finished -- repetition 4 of 7 
2022-09-21 06:15:36 INFO  # Optimization benchmark for feature_importance with args [['reviews', 'slow_loading', 'featurization_1', 'neural_network']] -- repetition 5 of 7
2022-09-21 06:15:36 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-21 06:15:36 INFO  Running instrumented original pipeline...
2022-09-21 06:15:36 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-21 06:15:36 INFO  ---RUNTIME: Importing and monkey-patching took 5.92350959777832 ms
2022-09-21 06:15:47 INFO  ---RUNTIME: Original pipeline execution took 11625.069379806519 ms (excluding imports and monkey-patching)
2022-09-21 06:15:47 INFO  Starting execution of 1 what-if analyses...
2022-09-21 06:15:47 INFO  Start plan generation for analysis PermutationFeatureImportance...
2022-09-21 06:15:47 INFO  ---RUNTIME: Plan generation took 0.11754035949707031 ms
2022-09-21 06:15:47 INFO  Estimated runtime of original DAG is 9324.495077133179ms
2022-09-21 06:15:47 INFO  Performing Multi-Query Optimization
2022-09-21 06:15:47 INFO  Estimated unoptimized what-if runtime is 46622.47538566589ms
2022-09-21 06:15:47 INFO  Estimated optimised what-if runtime is 12445.406675338745ms
2022-09-21 06:15:47 INFO  Estimated optimisation runtime saving is 34177.06871032715ms
2022-09-21 06:15:47 INFO  ---RUNTIME: Multi-Query Optimization took 11.902809143066406 ms
2022-09-21 06:15:47 INFO  Executing generated plans
2022-09-21 06:16:01 INFO  ---RUNTIME: Execution took 13469.359636306763 ms
2022-09-21 06:16:01 INFO  Done!
2022-09-21 06:16:01 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-21 06:16:01 INFO  Running instrumented original pipeline...
2022-09-21 06:16:01 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-21 06:16:01 INFO  ---RUNTIME: Importing and monkey-patching took 6.266117095947266 ms
2022-09-21 06:16:12 INFO  ---RUNTIME: Original pipeline execution took 11541.763305664062 ms (excluding imports and monkey-patching)
2022-09-21 06:16:12 INFO  Starting execution of 1 what-if analyses...
2022-09-21 06:16:12 INFO  Start plan generation for analysis PermutationFeatureImportance...
2022-09-21 06:16:12 INFO  ---RUNTIME: Plan generation took 0.1266002655029297 ms
2022-09-21 06:16:12 INFO  Estimated runtime of original DAG is 9246.293306350708ms
2022-09-21 06:16:12 WARNING Skipping Multi-Query Optimization (instead, only combine execution DAGs)
2022-09-21 06:16:12 INFO  Estimated unoptimised what-if runtime is 46231.46653175354ms
2022-09-21 06:16:12 INFO  ---RUNTIME: Multi-Query Optimization took 14.351367950439453 ms
2022-09-21 06:16:12 INFO  Executing generated plans
2022-09-21 06:17:05 INFO  ---RUNTIME: Execution took 52926.12338066101 ms
2022-09-21 06:17:05 INFO  Done!
2022-09-21 06:17:05 INFO  # Finished -- repetition 5 of 7 
2022-09-21 06:17:05 INFO  # Optimization benchmark for feature_importance with args [['reviews', 'slow_loading', 'featurization_1', 'neural_network']] -- repetition 6 of 7
2022-09-21 06:17:05 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-21 06:17:05 INFO  Running instrumented original pipeline...
2022-09-21 06:17:05 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-21 06:17:05 INFO  ---RUNTIME: Importing and monkey-patching took 5.934953689575195 ms
2022-09-21 06:17:17 INFO  ---RUNTIME: Original pipeline execution took 12148.325681686401 ms (excluding imports and monkey-patching)
2022-09-21 06:17:17 INFO  Starting execution of 1 what-if analyses...
2022-09-21 06:17:17 INFO  Start plan generation for analysis PermutationFeatureImportance...
2022-09-21 06:17:17 INFO  ---RUNTIME: Plan generation took 0.1556873321533203 ms
2022-09-21 06:17:17 INFO  Estimated runtime of original DAG is 9804.185390472412ms
2022-09-21 06:17:17 INFO  Performing Multi-Query Optimization
2022-09-21 06:17:17 INFO  Estimated unoptimized what-if runtime is 49020.92695236206ms
2022-09-21 06:17:17 INFO  Estimated optimised what-if runtime is 13255.89895248413ms
2022-09-21 06:17:17 INFO  Estimated optimisation runtime saving is 35765.02799987793ms
2022-09-21 06:17:17 INFO  ---RUNTIME: Multi-Query Optimization took 18.456697463989258 ms
2022-09-21 06:17:17 INFO  Executing generated plans
2022-09-21 06:17:33 INFO  ---RUNTIME: Execution took 15660.003900527954 ms
2022-09-21 06:17:33 INFO  Done!
2022-09-21 06:17:33 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-21 06:17:33 INFO  Running instrumented original pipeline...
2022-09-21 06:17:33 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-21 06:17:33 INFO  ---RUNTIME: Importing and monkey-patching took 6.161212921142578 ms
2022-09-21 06:17:45 INFO  ---RUNTIME: Original pipeline execution took 11505.60450553894 ms (excluding imports and monkey-patching)
2022-09-21 06:17:45 INFO  Starting execution of 1 what-if analyses...
2022-09-21 06:17:45 INFO  Start plan generation for analysis PermutationFeatureImportance...
2022-09-21 06:17:45 INFO  ---RUNTIME: Plan generation took 0.11515617370605469 ms
2022-09-21 06:17:45 INFO  Estimated runtime of original DAG is 9171.602487564087ms
2022-09-21 06:17:45 WARNING Skipping Multi-Query Optimization (instead, only combine execution DAGs)
2022-09-21 06:17:45 INFO  Estimated unoptimised what-if runtime is 45858.012437820435ms
2022-09-21 06:17:45 INFO  ---RUNTIME: Multi-Query Optimization took 14.251708984375 ms
2022-09-21 06:17:45 INFO  Executing generated plans
2022-09-21 06:18:39 INFO  ---RUNTIME: Execution took 54842.72265434265 ms
2022-09-21 06:18:39 INFO  Done!
2022-09-21 06:18:39 INFO  # Finished -- repetition 6 of 7 
2022-09-21 06:18:39 INFO  # Optimization benchmark for feature_importance with args [['reviews', 'slow_loading', 'featurization_1', 'neural_network']] -- repetition 7 of 7
2022-09-21 06:18:39 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-21 06:18:39 INFO  Running instrumented original pipeline...
2022-09-21 06:18:39 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-21 06:18:39 INFO  ---RUNTIME: Importing and monkey-patching took 6.585359573364258 ms
2022-09-21 06:18:52 INFO  ---RUNTIME: Original pipeline execution took 12154.041528701782 ms (excluding imports and monkey-patching)
2022-09-21 06:18:52 INFO  Starting execution of 1 what-if analyses...
2022-09-21 06:18:52 INFO  Start plan generation for analysis PermutationFeatureImportance...
2022-09-21 06:18:52 INFO  ---RUNTIME: Plan generation took 0.12302398681640625 ms
2022-09-21 06:18:52 INFO  Estimated runtime of original DAG is 9869.338989257812ms
2022-09-21 06:18:52 INFO  Performing Multi-Query Optimization
2022-09-21 06:18:52 INFO  Estimated unoptimized what-if runtime is 49346.69494628906ms
2022-09-21 06:18:52 INFO  Estimated optimised what-if runtime is 12891.045808792114ms
2022-09-21 06:18:52 INFO  Estimated optimisation runtime saving is 36455.64913749695ms
2022-09-21 06:18:52 INFO  ---RUNTIME: Multi-Query Optimization took 9.89079475402832 ms
2022-09-21 06:18:52 INFO  Executing generated plans
2022-09-21 06:19:05 INFO  ---RUNTIME: Execution took 13144.270896911621 ms
2022-09-21 06:19:05 INFO  Done!
2022-09-21 06:19:05 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-21 06:19:05 INFO  Running instrumented original pipeline...
2022-09-21 06:19:05 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-21 06:19:06 INFO  ---RUNTIME: Importing and monkey-patching took 734.1299057006836 ms
2022-09-21 06:19:18 INFO  ---RUNTIME: Original pipeline execution took 12302.012205123901 ms (excluding imports and monkey-patching)
2022-09-21 06:19:18 INFO  Starting execution of 1 what-if analyses...
2022-09-21 06:19:18 INFO  Start plan generation for analysis PermutationFeatureImportance...
2022-09-21 06:19:18 INFO  ---RUNTIME: Plan generation took 0.09775161743164062 ms
2022-09-21 06:19:18 INFO  Estimated runtime of original DAG is 9878.947973251343ms
2022-09-21 06:19:18 WARNING Skipping Multi-Query Optimization (instead, only combine execution DAGs)
2022-09-21 06:19:18 INFO  Estimated unoptimised what-if runtime is 49394.739866256714ms
2022-09-21 06:19:18 INFO  ---RUNTIME: Multi-Query Optimization took 14.168977737426758 ms
2022-09-21 06:19:18 INFO  Executing generated plans
2022-09-21 06:20:10 INFO  ---RUNTIME: Execution took 51763.48400115967 ms
2022-09-21 06:20:10 INFO  Done!
2022-09-21 06:20:10 INFO  # Finished -- repetition 7 of 7 
2022-09-21 06:20:10 INFO  # Final results after all repetitions
2022-09-21 06:20:10 INFO     repetition  ... no_opt_what_if_execution_combined_model_training
0           0  ...                                     18749.272823
1           1  ...                                     19329.197168
2           2  ...                                     17793.663740
3           3  ...                                     19500.324726
4           4  ...                                     20399.372101
5           5  ...                                     19376.209259
6           6  ...                                     19075.639248

[7 rows x 26 columns]
taskset -c 160-168 PROTOCOL_BUFFERS_PYTHON_IMPLEMENTATION=python python3.9 benchmarks_end_to_end.py feature_importance reviews slow_loading featurization_2 logistic_regression
2022-09-21 06:20:13.053713: W tensorflow/stream_executor/platform/default/dso_loader.cc:64] Could not load dynamic library 'libcudart.so.11.0'; dlerror: libcudart.so.11.0: cannot open shared object file: No such file or directory; LD_LIBRARY_PATH: /home/sgrafbe/mlwhatif/venv/lib/python3.9/site-packages/cv2/../../lib64:
2022-09-21 06:20:13.053767: I tensorflow/stream_executor/cuda/cudart_stub.cc:29] Ignore above cudart dlerror if you do not have a GPU set up on your machine.
2022-09-21 06:20:14 INFO  Patching sys.argv with ['mlwhatif', 'reviews', 'slow_loading', 'featurization_2', 'logistic_regression']
2022-09-21 06:20:14 INFO  Running instrumented original pipeline...
2022-09-21 06:20:14 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-21 06:20:14 INFO  ---RUNTIME: Importing and monkey-patching took 154.88696098327637 ms
2022-09-21 06:20:22 INFO  ---RUNTIME: Original pipeline execution took 7411.64755821228 ms (excluding imports and monkey-patching)
2022-09-21 06:20:22 INFO  Starting execution of 0 what-if analyses...
2022-09-21 06:20:22 INFO  Estimated runtime of original DAG is 6157.468557357788ms
2022-09-21 06:20:22 INFO  Performing Multi-Query Optimization
2022-09-21 06:20:22 INFO  Estimated unoptimized what-if runtime is 0ms
2022-09-21 06:20:22 INFO  Estimated optimised what-if runtime is 0ms
2022-09-21 06:20:22 INFO  Estimated optimisation runtime saving is 0ms
2022-09-21 06:20:22 INFO  ---RUNTIME: Multi-Query Optimization took 0.5846023559570312 ms
2022-09-21 06:20:22 INFO  Executing generated plans
2022-09-21 06:20:22 INFO  ---RUNTIME: Execution took 0.023365020751953125 ms
2022-09-21 06:20:22 INFO  Done!
2022-09-21 06:20:22 INFO  # Optimization benchmark for feature_importance with args [['reviews', 'slow_loading', 'featurization_2', 'logistic_regression']] -- repetition 1 of 7
2022-09-21 06:20:22 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-21 06:20:22 INFO  Running instrumented original pipeline...
2022-09-21 06:20:22 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-21 06:20:22 INFO  ---RUNTIME: Importing and monkey-patching took 5.430459976196289 ms
2022-09-21 06:20:29 INFO  ---RUNTIME: Original pipeline execution took 7259.120941162109 ms (excluding imports and monkey-patching)
2022-09-21 06:20:29 INFO  Starting execution of 1 what-if analyses...
2022-09-21 06:20:29 INFO  Start plan generation for analysis PermutationFeatureImportance...
2022-09-21 06:20:29 INFO  ---RUNTIME: Plan generation took 0.20885467529296875 ms
2022-09-21 06:20:29 INFO  Estimated runtime of original DAG is 6082.446575164795ms
2022-09-21 06:20:29 INFO  Performing Multi-Query Optimization
2022-09-21 06:20:29 INFO  Estimated unoptimized what-if runtime is 30412.232875823975ms
2022-09-21 06:20:29 INFO  Estimated optimised what-if runtime is 7668.862104415894ms
2022-09-21 06:20:29 INFO  Estimated optimisation runtime saving is 22743.37077140808ms
2022-09-21 06:20:29 INFO  ---RUNTIME: Multi-Query Optimization took 11.04426383972168 ms
2022-09-21 06:20:29 INFO  Executing generated plans
2022-09-21 06:20:37 INFO  ---RUNTIME: Execution took 8377.0010471344 ms
2022-09-21 06:20:37 INFO  Done!
2022-09-21 06:20:37 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-21 06:20:37 INFO  Running instrumented original pipeline...
2022-09-21 06:20:37 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-21 06:20:37 INFO  ---RUNTIME: Importing and monkey-patching took 5.986452102661133 ms
2022-09-21 06:20:45 INFO  ---RUNTIME: Original pipeline execution took 7091.071367263794 ms (excluding imports and monkey-patching)
2022-09-21 06:20:45 INFO  Starting execution of 1 what-if analyses...
2022-09-21 06:20:45 INFO  Start plan generation for analysis PermutationFeatureImportance...
2022-09-21 06:20:45 INFO  ---RUNTIME: Plan generation took 0.10943412780761719 ms
2022-09-21 06:20:45 INFO  Estimated runtime of original DAG is 5883.598804473877ms
2022-09-21 06:20:45 WARNING Skipping Multi-Query Optimization (instead, only combine execution DAGs)
2022-09-21 06:20:45 INFO  Estimated unoptimised what-if runtime is 29417.994022369385ms
2022-09-21 06:20:45 INFO  ---RUNTIME: Multi-Query Optimization took 15.314102172851562 ms
2022-09-21 06:20:45 INFO  Executing generated plans
2022-09-21 06:21:26 INFO  ---RUNTIME: Execution took 41572.617292404175 ms
2022-09-21 06:21:26 INFO  Done!
2022-09-21 06:21:26 INFO  # Finished -- repetition 1 of 7 
2022-09-21 06:21:26 INFO  # Optimization benchmark for feature_importance with args [['reviews', 'slow_loading', 'featurization_2', 'logistic_regression']] -- repetition 2 of 7
2022-09-21 06:21:26 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-21 06:21:26 INFO  Running instrumented original pipeline...
2022-09-21 06:21:26 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-21 06:21:26 INFO  ---RUNTIME: Importing and monkey-patching took 8.456230163574219 ms
2022-09-21 06:21:35 INFO  ---RUNTIME: Original pipeline execution took 8862.132549285889 ms (excluding imports and monkey-patching)
2022-09-21 06:21:35 INFO  Starting execution of 1 what-if analyses...
2022-09-21 06:21:35 INFO  Start plan generation for analysis PermutationFeatureImportance...
2022-09-21 06:21:35 INFO  ---RUNTIME: Plan generation took 0.17333030700683594 ms
2022-09-21 06:21:35 INFO  Estimated runtime of original DAG is 7324.09405708313ms
2022-09-21 06:21:35 INFO  Performing Multi-Query Optimization
2022-09-21 06:21:35 INFO  Estimated unoptimized what-if runtime is 36620.47028541565ms
2022-09-21 06:21:35 INFO  Estimated optimised what-if runtime is 9216.805458068848ms
2022-09-21 06:21:35 INFO  Estimated optimisation runtime saving is 27403.6648273468ms
2022-09-21 06:21:35 INFO  ---RUNTIME: Multi-Query Optimization took 13.671636581420898 ms
2022-09-21 06:21:35 INFO  Executing generated plans
2022-09-21 06:21:46 INFO  ---RUNTIME: Execution took 10586.43364906311 ms
2022-09-21 06:21:46 INFO  Done!
2022-09-21 06:21:46 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-21 06:21:46 INFO  Running instrumented original pipeline...
2022-09-21 06:21:46 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-21 06:21:46 INFO  ---RUNTIME: Importing and monkey-patching took 6.411075592041016 ms
2022-09-21 06:21:53 INFO  ---RUNTIME: Original pipeline execution took 7663.284063339233 ms (excluding imports and monkey-patching)
2022-09-21 06:21:53 INFO  Starting execution of 1 what-if analyses...
2022-09-21 06:21:53 INFO  Start plan generation for analysis PermutationFeatureImportance...
2022-09-21 06:21:53 INFO  ---RUNTIME: Plan generation took 0.11754035949707031 ms
2022-09-21 06:21:53 INFO  Estimated runtime of original DAG is 6442.219972610474ms
2022-09-21 06:21:53 WARNING Skipping Multi-Query Optimization (instead, only combine execution DAGs)
2022-09-21 06:21:53 INFO  Estimated unoptimised what-if runtime is 32211.099863052368ms
2022-09-21 06:21:53 INFO  ---RUNTIME: Multi-Query Optimization took 15.241146087646484 ms
2022-09-21 06:21:53 INFO  Executing generated plans
2022-09-21 06:22:32 INFO  ---RUNTIME: Execution took 38690.691232681274 ms
2022-09-21 06:22:32 INFO  Done!
2022-09-21 06:22:32 INFO  # Finished -- repetition 2 of 7 
2022-09-21 06:22:32 INFO  # Optimization benchmark for feature_importance with args [['reviews', 'slow_loading', 'featurization_2', 'logistic_regression']] -- repetition 3 of 7
2022-09-21 06:22:32 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-21 06:22:32 INFO  Running instrumented original pipeline...
2022-09-21 06:22:32 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-21 06:22:32 INFO  ---RUNTIME: Importing and monkey-patching took 6.006717681884766 ms
2022-09-21 06:22:40 INFO  ---RUNTIME: Original pipeline execution took 8414.58249092102 ms (excluding imports and monkey-patching)
2022-09-21 06:22:40 INFO  Starting execution of 1 what-if analyses...
2022-09-21 06:22:40 INFO  Start plan generation for analysis PermutationFeatureImportance...
2022-09-21 06:22:40 INFO  ---RUNTIME: Plan generation took 0.16164779663085938 ms
2022-09-21 06:22:40 INFO  Estimated runtime of original DAG is 6841.117858886719ms
2022-09-21 06:22:40 INFO  Performing Multi-Query Optimization
2022-09-21 06:22:40 INFO  Estimated unoptimized what-if runtime is 34205.589294433594ms
2022-09-21 06:22:40 INFO  Estimated optimised what-if runtime is 8717.053890228271ms
2022-09-21 06:22:40 INFO  Estimated optimisation runtime saving is 25488.535404205322ms
2022-09-21 06:22:40 INFO  ---RUNTIME: Multi-Query Optimization took 14.175176620483398 ms
2022-09-21 06:22:40 INFO  Executing generated plans
2022-09-21 06:22:50 INFO  ---RUNTIME: Execution took 9420.363187789917 ms
2022-09-21 06:22:50 INFO  Done!
2022-09-21 06:22:50 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-21 06:22:50 INFO  Running instrumented original pipeline...
2022-09-21 06:22:50 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-21 06:22:50 INFO  ---RUNTIME: Importing and monkey-patching took 6.07752799987793 ms
2022-09-21 06:22:58 INFO  ---RUNTIME: Original pipeline execution took 7811.655521392822 ms (excluding imports and monkey-patching)
2022-09-21 06:22:58 INFO  Starting execution of 1 what-if analyses...
2022-09-21 06:22:58 INFO  Start plan generation for analysis PermutationFeatureImportance...
2022-09-21 06:22:58 INFO  ---RUNTIME: Plan generation took 0.12683868408203125 ms
2022-09-21 06:22:58 INFO  Estimated runtime of original DAG is 6626.409530639648ms
2022-09-21 06:22:58 WARNING Skipping Multi-Query Optimization (instead, only combine execution DAGs)
2022-09-21 06:22:58 INFO  Estimated unoptimised what-if runtime is 33132.04765319824ms
2022-09-21 06:22:58 INFO  ---RUNTIME: Multi-Query Optimization took 15.365362167358398 ms
2022-09-21 06:22:58 INFO  Executing generated plans
2022-09-21 06:23:34 INFO  ---RUNTIME: Execution took 35970.97730636597 ms
2022-09-21 06:23:34 INFO  Done!
2022-09-21 06:23:34 INFO  # Finished -- repetition 3 of 7 
2022-09-21 06:23:34 INFO  # Optimization benchmark for feature_importance with args [['reviews', 'slow_loading', 'featurization_2', 'logistic_regression']] -- repetition 4 of 7
2022-09-21 06:23:34 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-21 06:23:34 INFO  Running instrumented original pipeline...
2022-09-21 06:23:34 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-21 06:23:34 INFO  ---RUNTIME: Importing and monkey-patching took 8.088827133178711 ms
2022-09-21 06:23:43 INFO  ---RUNTIME: Original pipeline execution took 9308.045864105225 ms (excluding imports and monkey-patching)
2022-09-21 06:23:43 INFO  Starting execution of 1 what-if analyses...
2022-09-21 06:23:43 INFO  Start plan generation for analysis PermutationFeatureImportance...
2022-09-21 06:23:43 INFO  ---RUNTIME: Plan generation took 0.1289844512939453 ms
2022-09-21 06:23:43 INFO  Estimated runtime of original DAG is 7322.313070297241ms
2022-09-21 06:23:43 INFO  Performing Multi-Query Optimization
2022-09-21 06:23:43 INFO  Estimated unoptimized what-if runtime is 36611.565351486206ms
2022-09-21 06:23:43 INFO  Estimated optimised what-if runtime is 9179.74328994751ms
2022-09-21 06:23:43 INFO  Estimated optimisation runtime saving is 27431.822061538696ms
2022-09-21 06:23:43 INFO  ---RUNTIME: Multi-Query Optimization took 13.747215270996094 ms
2022-09-21 06:23:43 INFO  Executing generated plans
2022-09-21 06:23:53 INFO  ---RUNTIME: Execution took 10135.849237442017 ms
2022-09-21 06:23:53 INFO  Done!
2022-09-21 06:23:53 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-21 06:23:53 INFO  Running instrumented original pipeline...
2022-09-21 06:23:53 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-21 06:23:53 INFO  ---RUNTIME: Importing and monkey-patching took 6.5746307373046875 ms
2022-09-21 06:24:02 INFO  ---RUNTIME: Original pipeline execution took 8883.81838798523 ms (excluding imports and monkey-patching)
2022-09-21 06:24:02 INFO  Starting execution of 1 what-if analyses...
2022-09-21 06:24:02 INFO  Start plan generation for analysis PermutationFeatureImportance...
2022-09-21 06:24:02 INFO  ---RUNTIME: Plan generation took 0.11968612670898438 ms
2022-09-21 06:24:02 INFO  Estimated runtime of original DAG is 7317.133188247681ms
2022-09-21 06:24:02 WARNING Skipping Multi-Query Optimization (instead, only combine execution DAGs)
2022-09-21 06:24:02 INFO  Estimated unoptimised what-if runtime is 36585.6659412384ms
2022-09-21 06:24:02 INFO  ---RUNTIME: Multi-Query Optimization took 18.07260513305664 ms
2022-09-21 06:24:02 INFO  Executing generated plans
2022-09-21 06:24:43 INFO  ---RUNTIME: Execution took 40934.28158760071 ms
2022-09-21 06:24:43 INFO  Done!
2022-09-21 06:24:43 INFO  # Finished -- repetition 4 of 7 
2022-09-21 06:24:43 INFO  # Optimization benchmark for feature_importance with args [['reviews', 'slow_loading', 'featurization_2', 'logistic_regression']] -- repetition 5 of 7
2022-09-21 06:24:43 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-21 06:24:43 INFO  Running instrumented original pipeline...
2022-09-21 06:24:43 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-21 06:24:43 INFO  ---RUNTIME: Importing and monkey-patching took 7.392644882202148 ms
2022-09-21 06:24:51 INFO  ---RUNTIME: Original pipeline execution took 7772.94135093689 ms (excluding imports and monkey-patching)
2022-09-21 06:24:51 INFO  Starting execution of 1 what-if analyses...
2022-09-21 06:24:51 INFO  Start plan generation for analysis PermutationFeatureImportance...
2022-09-21 06:24:51 INFO  ---RUNTIME: Plan generation took 0.12469291687011719 ms
2022-09-21 06:24:51 INFO  Estimated runtime of original DAG is 6552.407741546631ms
2022-09-21 06:24:51 INFO  Performing Multi-Query Optimization
2022-09-21 06:24:51 INFO  Estimated unoptimized what-if runtime is 32762.038707733154ms
2022-09-21 06:24:51 INFO  Estimated optimised what-if runtime is 8126.526832580566ms
2022-09-21 06:24:51 INFO  Estimated optimisation runtime saving is 24635.511875152588ms
2022-09-21 06:24:51 INFO  ---RUNTIME: Multi-Query Optimization took 10.591745376586914 ms
2022-09-21 06:24:51 INFO  Executing generated plans
2022-09-21 06:25:00 INFO  ---RUNTIME: Execution took 9459.705114364624 ms
2022-09-21 06:25:00 INFO  Done!
2022-09-21 06:25:00 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-21 06:25:00 INFO  Running instrumented original pipeline...
2022-09-21 06:25:00 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-21 06:25:00 INFO  ---RUNTIME: Importing and monkey-patching took 7.391214370727539 ms
2022-09-21 06:25:09 INFO  ---RUNTIME: Original pipeline execution took 8768.040180206299 ms (excluding imports and monkey-patching)
2022-09-21 06:25:09 INFO  Starting execution of 1 what-if analyses...
2022-09-21 06:25:09 INFO  Start plan generation for analysis PermutationFeatureImportance...
2022-09-21 06:25:09 INFO  ---RUNTIME: Plan generation took 0.09608268737792969 ms
2022-09-21 06:25:09 INFO  Estimated runtime of original DAG is 7168.370962142944ms
2022-09-21 06:25:09 WARNING Skipping Multi-Query Optimization (instead, only combine execution DAGs)
2022-09-21 06:25:09 INFO  Estimated unoptimised what-if runtime is 35841.85481071472ms
2022-09-21 06:25:09 INFO  ---RUNTIME: Multi-Query Optimization took 14.987945556640625 ms
2022-09-21 06:25:09 INFO  Executing generated plans
2022-09-21 06:25:46 INFO  ---RUNTIME: Execution took 36454.46491241455 ms
2022-09-21 06:25:46 INFO  Done!
2022-09-21 06:25:46 INFO  # Finished -- repetition 5 of 7 
2022-09-21 06:25:46 INFO  # Optimization benchmark for feature_importance with args [['reviews', 'slow_loading', 'featurization_2', 'logistic_regression']] -- repetition 6 of 7
2022-09-21 06:25:46 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-21 06:25:46 INFO  Running instrumented original pipeline...
2022-09-21 06:25:46 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-21 06:25:46 INFO  ---RUNTIME: Importing and monkey-patching took 6.159543991088867 ms
2022-09-21 06:25:53 INFO  ---RUNTIME: Original pipeline execution took 7177.476406097412 ms (excluding imports and monkey-patching)
2022-09-21 06:25:53 INFO  Starting execution of 1 what-if analyses...
2022-09-21 06:25:53 INFO  Start plan generation for analysis PermutationFeatureImportance...
2022-09-21 06:25:53 INFO  ---RUNTIME: Plan generation took 0.12493133544921875 ms
2022-09-21 06:25:53 INFO  Estimated runtime of original DAG is 5964.818477630615ms
2022-09-21 06:25:53 INFO  Performing Multi-Query Optimization
2022-09-21 06:25:53 INFO  Estimated unoptimized what-if runtime is 29824.092388153076ms
2022-09-21 06:25:53 INFO  Estimated optimised what-if runtime is 7545.883417129517ms
2022-09-21 06:25:53 INFO  Estimated optimisation runtime saving is 22278.20897102356ms
2022-09-21 06:25:53 INFO  ---RUNTIME: Multi-Query Optimization took 10.65516471862793 ms
2022-09-21 06:25:53 INFO  Executing generated plans
2022-09-21 06:26:02 INFO  ---RUNTIME: Execution took 9075.51097869873 ms
2022-09-21 06:26:02 INFO  Done!
2022-09-21 06:26:02 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-21 06:26:02 INFO  Running instrumented original pipeline...
2022-09-21 06:26:02 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-21 06:26:02 INFO  ---RUNTIME: Importing and monkey-patching took 6.532430648803711 ms
2022-09-21 06:26:10 INFO  ---RUNTIME: Original pipeline execution took 8637.232303619385 ms (excluding imports and monkey-patching)
2022-09-21 06:26:10 INFO  Starting execution of 1 what-if analyses...
2022-09-21 06:26:10 INFO  Start plan generation for analysis PermutationFeatureImportance...
2022-09-21 06:26:10 INFO  ---RUNTIME: Plan generation took 0.12087821960449219 ms
2022-09-21 06:26:10 INFO  Estimated runtime of original DAG is 7154.2298793792725ms
2022-09-21 06:26:10 WARNING Skipping Multi-Query Optimization (instead, only combine execution DAGs)
2022-09-21 06:26:11 INFO  Estimated unoptimised what-if runtime is 35771.14939689636ms
2022-09-21 06:26:11 INFO  ---RUNTIME: Multi-Query Optimization took 19.53601837158203 ms
2022-09-21 06:26:11 INFO  Executing generated plans
2022-09-21 06:26:52 INFO  ---RUNTIME: Execution took 41895.5135345459 ms
2022-09-21 06:26:52 INFO  Done!
2022-09-21 06:26:52 INFO  # Finished -- repetition 6 of 7 
2022-09-21 06:26:52 INFO  # Optimization benchmark for feature_importance with args [['reviews', 'slow_loading', 'featurization_2', 'logistic_regression']] -- repetition 7 of 7
2022-09-21 06:26:52 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-21 06:26:52 INFO  Running instrumented original pipeline...
2022-09-21 06:26:52 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-21 06:26:52 INFO  ---RUNTIME: Importing and monkey-patching took 7.232904434204102 ms
2022-09-21 06:27:01 INFO  ---RUNTIME: Original pipeline execution took 8835.293769836426 ms (excluding imports and monkey-patching)
2022-09-21 06:27:01 INFO  Starting execution of 1 what-if analyses...
2022-09-21 06:27:01 INFO  Start plan generation for analysis PermutationFeatureImportance...
2022-09-21 06:27:01 INFO  ---RUNTIME: Plan generation took 0.15425682067871094 ms
2022-09-21 06:27:01 INFO  Estimated runtime of original DAG is 7287.787675857544ms
2022-09-21 06:27:01 INFO  Performing Multi-Query Optimization
2022-09-21 06:27:01 INFO  Estimated unoptimized what-if runtime is 36438.93837928772ms
2022-09-21 06:27:01 INFO  Estimated optimised what-if runtime is 9158.859491348267ms
2022-09-21 06:27:01 INFO  Estimated optimisation runtime saving is 27280.078887939453ms
2022-09-21 06:27:01 INFO  ---RUNTIME: Multi-Query Optimization took 13.663768768310547 ms
2022-09-21 06:27:01 INFO  Executing generated plans
2022-09-21 06:27:10 INFO  ---RUNTIME: Execution took 9134.785652160645 ms
2022-09-21 06:27:10 INFO  Done!
2022-09-21 06:27:10 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-21 06:27:10 INFO  Running instrumented original pipeline...
2022-09-21 06:27:10 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-21 06:27:10 INFO  ---RUNTIME: Importing and monkey-patching took 6.489038467407227 ms
2022-09-21 06:27:19 INFO  ---RUNTIME: Original pipeline execution took 8684.483051300049 ms (excluding imports and monkey-patching)
2022-09-21 06:27:19 INFO  Starting execution of 1 what-if analyses...
2022-09-21 06:27:19 INFO  Start plan generation for analysis PermutationFeatureImportance...
2022-09-21 06:27:19 INFO  ---RUNTIME: Plan generation took 0.10204315185546875 ms
2022-09-21 06:27:19 INFO  Estimated runtime of original DAG is 7126.84965133667ms
2022-09-21 06:27:19 WARNING Skipping Multi-Query Optimization (instead, only combine execution DAGs)
2022-09-21 06:27:19 INFO  Estimated unoptimised what-if runtime is 35634.24825668335ms
2022-09-21 06:27:19 INFO  ---RUNTIME: Multi-Query Optimization took 14.95051383972168 ms
2022-09-21 06:27:19 INFO  Executing generated plans
2022-09-21 06:27:59 INFO  ---RUNTIME: Execution took 39493.829011917114 ms
2022-09-21 06:27:59 INFO  Done!
2022-09-21 06:27:59 INFO  # Finished -- repetition 7 of 7 
2022-09-21 06:27:59 INFO  # Final results after all repetitions
2022-09-21 06:27:59 INFO     repetition  ... no_opt_what_if_execution_combined_model_training
0           0  ...                                       813.416958
1           1  ...                                       502.840519
2           2  ...                                       670.242786
3           3  ...                                       759.981871
4           4  ...                                       507.843733
5           5  ...                                       798.146248
6           6  ...                                       660.583496

[7 rows x 26 columns]
taskset -c 160-168 PROTOCOL_BUFFERS_PYTHON_IMPLEMENTATION=python python3.9 benchmarks_end_to_end.py feature_importance reviews slow_loading featurization_2 xgboost
2022-09-21 06:28:01.367247: W tensorflow/stream_executor/platform/default/dso_loader.cc:64] Could not load dynamic library 'libcudart.so.11.0'; dlerror: libcudart.so.11.0: cannot open shared object file: No such file or directory; LD_LIBRARY_PATH: /home/sgrafbe/mlwhatif/venv/lib/python3.9/site-packages/cv2/../../lib64:
2022-09-21 06:28:01.367298: I tensorflow/stream_executor/cuda/cudart_stub.cc:29] Ignore above cudart dlerror if you do not have a GPU set up on your machine.
2022-09-21 06:28:02 INFO  Patching sys.argv with ['mlwhatif', 'reviews', 'slow_loading', 'featurization_2', 'xgboost']
2022-09-21 06:28:02 INFO  Running instrumented original pipeline...
2022-09-21 06:28:02 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-21 06:28:02 INFO  ---RUNTIME: Importing and monkey-patching took 121.88839912414551 ms
2022-09-21 06:28:23 INFO  ---RUNTIME: Original pipeline execution took 20404.576063156128 ms (excluding imports and monkey-patching)
2022-09-21 06:28:23 INFO  Starting execution of 0 what-if analyses...
2022-09-21 06:28:23 INFO  Estimated runtime of original DAG is 19187.832832336426ms
2022-09-21 06:28:23 INFO  Performing Multi-Query Optimization
2022-09-21 06:28:23 INFO  Estimated unoptimized what-if runtime is 0ms
2022-09-21 06:28:23 INFO  Estimated optimised what-if runtime is 0ms
2022-09-21 06:28:23 INFO  Estimated optimisation runtime saving is 0ms
2022-09-21 06:28:23 INFO  ---RUNTIME: Multi-Query Optimization took 0.5428791046142578 ms
2022-09-21 06:28:23 INFO  Executing generated plans
2022-09-21 06:28:23 INFO  ---RUNTIME: Execution took 0.025510787963867188 ms
2022-09-21 06:28:23 INFO  Done!
2022-09-21 06:28:23 INFO  # Optimization benchmark for feature_importance with args [['reviews', 'slow_loading', 'featurization_2', 'xgboost']] -- repetition 1 of 7
2022-09-21 06:28:23 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-21 06:28:23 INFO  Running instrumented original pipeline...
2022-09-21 06:28:23 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-21 06:28:23 INFO  ---RUNTIME: Importing and monkey-patching took 5.47027587890625 ms
2022-09-21 06:28:43 INFO  ---RUNTIME: Original pipeline execution took 20567.14391708374 ms (excluding imports and monkey-patching)
2022-09-21 06:28:43 INFO  Starting execution of 1 what-if analyses...
2022-09-21 06:28:43 INFO  Start plan generation for analysis PermutationFeatureImportance...
2022-09-21 06:28:43 INFO  ---RUNTIME: Plan generation took 0.21886825561523438 ms
2022-09-21 06:28:43 INFO  Estimated runtime of original DAG is 19193.049669265747ms
2022-09-21 06:28:43 INFO  Performing Multi-Query Optimization
2022-09-21 06:28:43 INFO  Estimated unoptimized what-if runtime is 95965.24834632874ms
2022-09-21 06:28:43 INFO  Estimated optimised what-if runtime is 21078.375339508057ms
2022-09-21 06:28:43 INFO  Estimated optimisation runtime saving is 74886.87300682068ms
2022-09-21 06:28:43 INFO  ---RUNTIME: Multi-Query Optimization took 10.96343994140625 ms
2022-09-21 06:28:43 INFO  Executing generated plans
2022-09-21 06:29:06 INFO  ---RUNTIME: Execution took 22925.797700881958 ms
2022-09-21 06:29:06 INFO  Done!
2022-09-21 06:29:06 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-21 06:29:06 INFO  Running instrumented original pipeline...
2022-09-21 06:29:06 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-21 06:29:06 INFO  ---RUNTIME: Importing and monkey-patching took 6.67262077331543 ms
2022-09-21 06:29:28 INFO  ---RUNTIME: Original pipeline execution took 21284.350395202637 ms (excluding imports and monkey-patching)
2022-09-21 06:29:28 INFO  Starting execution of 1 what-if analyses...
2022-09-21 06:29:28 INFO  Start plan generation for analysis PermutationFeatureImportance...
2022-09-21 06:29:28 INFO  ---RUNTIME: Plan generation took 0.13327598571777344 ms
2022-09-21 06:29:28 INFO  Estimated runtime of original DAG is 20059.091091156006ms
2022-09-21 06:29:28 WARNING Skipping Multi-Query Optimization (instead, only combine execution DAGs)
2022-09-21 06:29:28 INFO  Estimated unoptimised what-if runtime is 100295.45545578003ms
2022-09-21 06:29:28 INFO  ---RUNTIME: Multi-Query Optimization took 15.543460845947266 ms
2022-09-21 06:29:28 INFO  Executing generated plans
2022-09-21 06:31:08 INFO  ---RUNTIME: Execution took 100438.71307373047 ms
2022-09-21 06:31:08 INFO  Done!
2022-09-21 06:31:08 INFO  # Finished -- repetition 1 of 7 
2022-09-21 06:31:08 INFO  # Optimization benchmark for feature_importance with args [['reviews', 'slow_loading', 'featurization_2', 'xgboost']] -- repetition 2 of 7
2022-09-21 06:31:08 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-21 06:31:08 INFO  Running instrumented original pipeline...
2022-09-21 06:31:08 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-21 06:31:08 INFO  ---RUNTIME: Importing and monkey-patching took 11.240959167480469 ms
2022-09-21 06:31:28 INFO  ---RUNTIME: Original pipeline execution took 19907.54199028015 ms (excluding imports and monkey-patching)
2022-09-21 06:31:28 INFO  Starting execution of 1 what-if analyses...
2022-09-21 06:31:28 INFO  Start plan generation for analysis PermutationFeatureImportance...
2022-09-21 06:31:28 INFO  ---RUNTIME: Plan generation took 0.14066696166992188 ms
2022-09-21 06:31:28 INFO  Estimated runtime of original DAG is 18637.893676757812ms
2022-09-21 06:31:28 INFO  Performing Multi-Query Optimization
2022-09-21 06:31:28 INFO  Estimated unoptimized what-if runtime is 93189.46838378906ms
2022-09-21 06:31:28 INFO  Estimated optimised what-if runtime is 20430.61113357544ms
2022-09-21 06:31:28 INFO  Estimated optimisation runtime saving is 72758.85725021362ms
2022-09-21 06:31:28 INFO  ---RUNTIME: Multi-Query Optimization took 11.17706298828125 ms
2022-09-21 06:31:28 INFO  Executing generated plans
2022-09-21 06:31:50 INFO  ---RUNTIME: Execution took 22480.331897735596 ms
2022-09-21 06:31:50 INFO  Done!
2022-09-21 06:31:50 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-21 06:31:50 INFO  Running instrumented original pipeline...
2022-09-21 06:31:50 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-21 06:31:50 INFO  ---RUNTIME: Importing and monkey-patching took 10.148763656616211 ms
2022-09-21 06:32:11 INFO  ---RUNTIME: Original pipeline execution took 20790.589570999146 ms (excluding imports and monkey-patching)
2022-09-21 06:32:11 INFO  Starting execution of 1 what-if analyses...
2022-09-21 06:32:11 INFO  Start plan generation for analysis PermutationFeatureImportance...
2022-09-21 06:32:11 INFO  ---RUNTIME: Plan generation took 0.1347064971923828 ms
2022-09-21 06:32:11 INFO  Estimated runtime of original DAG is 19505.310773849487ms
2022-09-21 06:32:11 WARNING Skipping Multi-Query Optimization (instead, only combine execution DAGs)
2022-09-21 06:32:11 INFO  Estimated unoptimised what-if runtime is 97526.55386924744ms
2022-09-21 06:32:11 INFO  ---RUNTIME: Multi-Query Optimization took 15.57159423828125 ms
2022-09-21 06:32:11 INFO  Executing generated plans
2022-09-21 06:33:53 INFO  ---RUNTIME: Execution took 101522.71914482117 ms
2022-09-21 06:33:53 INFO  Done!
2022-09-21 06:33:53 INFO  # Finished -- repetition 2 of 7 
2022-09-21 06:33:53 INFO  # Optimization benchmark for feature_importance with args [['reviews', 'slow_loading', 'featurization_2', 'xgboost']] -- repetition 3 of 7
2022-09-21 06:33:53 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-21 06:33:53 INFO  Running instrumented original pipeline...
2022-09-21 06:33:53 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-21 06:33:53 INFO  ---RUNTIME: Importing and monkey-patching took 7.494449615478516 ms
2022-09-21 06:34:13 INFO  ---RUNTIME: Original pipeline execution took 20581.85338973999 ms (excluding imports and monkey-patching)
2022-09-21 06:34:13 INFO  Starting execution of 1 what-if analyses...
2022-09-21 06:34:13 INFO  Start plan generation for analysis PermutationFeatureImportance...
2022-09-21 06:34:13 INFO  ---RUNTIME: Plan generation took 0.12636184692382812 ms
2022-09-21 06:34:13 INFO  Estimated runtime of original DAG is 19323.450088500977ms
2022-09-21 06:34:13 INFO  Performing Multi-Query Optimization
2022-09-21 06:34:13 INFO  Estimated unoptimized what-if runtime is 96617.25044250488ms
2022-09-21 06:34:13 INFO  Estimated optimised what-if runtime is 21131.28900527954ms
2022-09-21 06:34:13 INFO  Estimated optimisation runtime saving is 75485.96143722534ms
2022-09-21 06:34:13 INFO  ---RUNTIME: Multi-Query Optimization took 10.718584060668945 ms
2022-09-21 06:34:13 INFO  Executing generated plans
2022-09-21 06:34:34 INFO  ---RUNTIME: Execution took 21023.403644561768 ms
2022-09-21 06:34:34 INFO  Done!
2022-09-21 06:34:34 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-21 06:34:34 INFO  Running instrumented original pipeline...
2022-09-21 06:34:34 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-21 06:34:34 INFO  ---RUNTIME: Importing and monkey-patching took 6.51240348815918 ms
2022-09-21 06:34:55 INFO  ---RUNTIME: Original pipeline execution took 20322.39532470703 ms (excluding imports and monkey-patching)
2022-09-21 06:34:55 INFO  Starting execution of 1 what-if analyses...
2022-09-21 06:34:55 INFO  Start plan generation for analysis PermutationFeatureImportance...
2022-09-21 06:34:55 INFO  ---RUNTIME: Plan generation took 0.12493133544921875 ms
2022-09-21 06:34:55 INFO  Estimated runtime of original DAG is 19086.231470108032ms
2022-09-21 06:34:55 WARNING Skipping Multi-Query Optimization (instead, only combine execution DAGs)
2022-09-21 06:34:55 INFO  Estimated unoptimised what-if runtime is 95431.15735054016ms
2022-09-21 06:34:55 INFO  ---RUNTIME: Multi-Query Optimization took 15.09857177734375 ms
2022-09-21 06:34:55 INFO  Executing generated plans
2022-09-21 06:36:34 INFO  ---RUNTIME: Execution took 99576.45297050476 ms
2022-09-21 06:36:34 INFO  Done!
2022-09-21 06:36:34 INFO  # Finished -- repetition 3 of 7 
2022-09-21 06:36:34 INFO  # Optimization benchmark for feature_importance with args [['reviews', 'slow_loading', 'featurization_2', 'xgboost']] -- repetition 4 of 7
2022-09-21 06:36:34 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-21 06:36:34 INFO  Running instrumented original pipeline...
2022-09-21 06:36:35 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-21 06:36:35 INFO  ---RUNTIME: Importing and monkey-patching took 5.910158157348633 ms
2022-09-21 06:36:54 INFO  ---RUNTIME: Original pipeline execution took 19346.14872932434 ms (excluding imports and monkey-patching)
2022-09-21 06:36:54 INFO  Starting execution of 1 what-if analyses...
2022-09-21 06:36:54 INFO  Start plan generation for analysis PermutationFeatureImportance...
2022-09-21 06:36:54 INFO  ---RUNTIME: Plan generation took 0.11277198791503906 ms
2022-09-21 06:36:54 INFO  Estimated runtime of original DAG is 17834.674835205078ms
2022-09-21 06:36:54 INFO  Performing Multi-Query Optimization
2022-09-21 06:36:54 INFO  Estimated unoptimized what-if runtime is 89173.37417602539ms
2022-09-21 06:36:54 INFO  Estimated optimised what-if runtime is 19640.851974487305ms
2022-09-21 06:36:54 INFO  Estimated optimisation runtime saving is 69532.52220153809ms
2022-09-21 06:36:54 INFO  ---RUNTIME: Multi-Query Optimization took 10.558843612670898 ms
2022-09-21 06:36:54 INFO  Executing generated plans
2022-09-21 06:37:16 INFO  ---RUNTIME: Execution took 22452.577590942383 ms
2022-09-21 06:37:16 INFO  Done!
2022-09-21 06:37:16 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-21 06:37:16 INFO  Running instrumented original pipeline...
2022-09-21 06:37:16 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-21 06:37:16 INFO  ---RUNTIME: Importing and monkey-patching took 6.317138671875 ms
2022-09-21 06:37:38 INFO  ---RUNTIME: Original pipeline execution took 21861.225605010986 ms (excluding imports and monkey-patching)
2022-09-21 06:37:38 INFO  Starting execution of 1 what-if analyses...
2022-09-21 06:37:38 INFO  Start plan generation for analysis PermutationFeatureImportance...
2022-09-21 06:37:38 INFO  ---RUNTIME: Plan generation took 0.15282630920410156 ms
2022-09-21 06:37:38 INFO  Estimated runtime of original DAG is 20606.694221496582ms
2022-09-21 06:37:38 WARNING Skipping Multi-Query Optimization (instead, only combine execution DAGs)
2022-09-21 06:37:38 INFO  Estimated unoptimised what-if runtime is 103033.47110748291ms
2022-09-21 06:37:38 INFO  ---RUNTIME: Multi-Query Optimization took 26.111125946044922 ms
2022-09-21 06:37:38 INFO  Executing generated plans
2022-09-21 06:39:18 INFO  ---RUNTIME: Execution took 99551.29384994507 ms
2022-09-21 06:39:18 INFO  Done!
2022-09-21 06:39:18 INFO  # Finished -- repetition 4 of 7 
2022-09-21 06:39:18 INFO  # Optimization benchmark for feature_importance with args [['reviews', 'slow_loading', 'featurization_2', 'xgboost']] -- repetition 5 of 7
2022-09-21 06:39:18 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-21 06:39:18 INFO  Running instrumented original pipeline...
2022-09-21 06:39:18 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-21 06:39:18 INFO  ---RUNTIME: Importing and monkey-patching took 6.400346755981445 ms
2022-09-21 06:39:40 INFO  ---RUNTIME: Original pipeline execution took 22160.28094291687 ms (excluding imports and monkey-patching)
2022-09-21 06:39:40 INFO  Starting execution of 1 what-if analyses...
2022-09-21 06:39:40 INFO  Start plan generation for analysis PermutationFeatureImportance...
2022-09-21 06:39:40 INFO  ---RUNTIME: Plan generation took 0.1704692840576172 ms
2022-09-21 06:39:40 INFO  Estimated runtime of original DAG is 20888.99803161621ms
2022-09-21 06:39:40 INFO  Performing Multi-Query Optimization
2022-09-21 06:39:40 INFO  Estimated unoptimized what-if runtime is 104444.99015808105ms
2022-09-21 06:39:40 INFO  Estimated optimised what-if runtime is 23401.885509490967ms
2022-09-21 06:39:40 INFO  Estimated optimisation runtime saving is 81043.10464859009ms
2022-09-21 06:39:40 INFO  ---RUNTIME: Multi-Query Optimization took 14.142990112304688 ms
2022-09-21 06:39:40 INFO  Executing generated plans
2022-09-21 06:40:03 INFO  ---RUNTIME: Execution took 22837.91756629944 ms
2022-09-21 06:40:03 INFO  Done!
2022-09-21 06:40:03 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-21 06:40:03 INFO  Running instrumented original pipeline...
2022-09-21 06:40:03 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-21 06:40:03 INFO  ---RUNTIME: Importing and monkey-patching took 6.6318511962890625 ms
2022-09-21 06:40:24 INFO  ---RUNTIME: Original pipeline execution took 21440.613746643066 ms (excluding imports and monkey-patching)
2022-09-21 06:40:24 INFO  Starting execution of 1 what-if analyses...
2022-09-21 06:40:24 INFO  Start plan generation for analysis PermutationFeatureImportance...
2022-09-21 06:40:24 INFO  ---RUNTIME: Plan generation took 0.1308917999267578 ms
2022-09-21 06:40:24 INFO  Estimated runtime of original DAG is 20196.810722351074ms
2022-09-21 06:40:24 WARNING Skipping Multi-Query Optimization (instead, only combine execution DAGs)
2022-09-21 06:40:24 INFO  Estimated unoptimised what-if runtime is 100984.05361175537ms
2022-09-21 06:40:24 INFO  ---RUNTIME: Multi-Query Optimization took 15.362262725830078 ms
2022-09-21 06:40:24 INFO  Executing generated plans
2022-09-21 06:42:00 INFO  ---RUNTIME: Execution took 96235.72731018066 ms
2022-09-21 06:42:00 INFO  Done!
2022-09-21 06:42:00 INFO  # Finished -- repetition 5 of 7 
2022-09-21 06:42:00 INFO  # Optimization benchmark for feature_importance with args [['reviews', 'slow_loading', 'featurization_2', 'xgboost']] -- repetition 6 of 7
2022-09-21 06:42:00 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-21 06:42:00 INFO  Running instrumented original pipeline...
2022-09-21 06:42:00 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-21 06:42:00 INFO  ---RUNTIME: Importing and monkey-patching took 6.057024002075195 ms
2022-09-21 06:42:19 INFO  ---RUNTIME: Original pipeline execution took 18966.84241294861 ms (excluding imports and monkey-patching)
2022-09-21 06:42:19 INFO  Starting execution of 1 what-if analyses...
2022-09-21 06:42:19 INFO  Start plan generation for analysis PermutationFeatureImportance...
2022-09-21 06:42:19 INFO  ---RUNTIME: Plan generation took 0.12636184692382812 ms
2022-09-21 06:42:19 INFO  Estimated runtime of original DAG is 17744.203805923462ms
2022-09-21 06:42:19 INFO  Performing Multi-Query Optimization
2022-09-21 06:42:19 INFO  Estimated unoptimized what-if runtime is 88721.01902961731ms
2022-09-21 06:42:19 INFO  Estimated optimised what-if runtime is 19525.34580230713ms
2022-09-21 06:42:19 INFO  Estimated optimisation runtime saving is 69195.67322731018ms
2022-09-21 06:42:19 INFO  ---RUNTIME: Multi-Query Optimization took 10.709285736083984 ms
2022-09-21 06:42:19 INFO  Executing generated plans
2022-09-21 06:42:40 INFO  ---RUNTIME: Execution took 20348.822593688965 ms
2022-09-21 06:42:40 INFO  Done!
2022-09-21 06:42:40 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-21 06:42:40 INFO  Running instrumented original pipeline...
2022-09-21 06:42:40 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-21 06:42:40 INFO  ---RUNTIME: Importing and monkey-patching took 5.834102630615234 ms
2022-09-21 06:42:59 INFO  ---RUNTIME: Original pipeline execution took 18793.987035751343 ms (excluding imports and monkey-patching)
2022-09-21 06:42:59 INFO  Starting execution of 1 what-if analyses...
2022-09-21 06:42:59 INFO  Start plan generation for analysis PermutationFeatureImportance...
2022-09-21 06:42:59 INFO  ---RUNTIME: Plan generation took 0.11682510375976562 ms
2022-09-21 06:42:59 INFO  Estimated runtime of original DAG is 17587.629079818726ms
2022-09-21 06:42:59 WARNING Skipping Multi-Query Optimization (instead, only combine execution DAGs)
2022-09-21 06:42:59 INFO  Estimated unoptimised what-if runtime is 87938.14539909363ms
2022-09-21 06:42:59 INFO  ---RUNTIME: Multi-Query Optimization took 15.110015869140625 ms
2022-09-21 06:42:59 INFO  Executing generated plans
2022-09-21 06:44:31 INFO  ---RUNTIME: Execution took 92341.81189537048 ms
2022-09-21 06:44:31 INFO  Done!
2022-09-21 06:44:31 INFO  # Finished -- repetition 6 of 7 
2022-09-21 06:44:31 INFO  # Optimization benchmark for feature_importance with args [['reviews', 'slow_loading', 'featurization_2', 'xgboost']] -- repetition 7 of 7
2022-09-21 06:44:31 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-21 06:44:31 INFO  Running instrumented original pipeline...
2022-09-21 06:44:31 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-21 06:44:31 INFO  ---RUNTIME: Importing and monkey-patching took 6.176948547363281 ms
2022-09-21 06:44:50 INFO  ---RUNTIME: Original pipeline execution took 19555.742025375366 ms (excluding imports and monkey-patching)
2022-09-21 06:44:50 INFO  Starting execution of 1 what-if analyses...
2022-09-21 06:44:50 INFO  Start plan generation for analysis PermutationFeatureImportance...
2022-09-21 06:44:50 INFO  ---RUNTIME: Plan generation took 0.11682510375976562 ms
2022-09-21 06:44:50 INFO  Estimated runtime of original DAG is 18336.90857887268ms
2022-09-21 06:44:50 INFO  Performing Multi-Query Optimization
2022-09-21 06:44:50 INFO  Estimated unoptimized what-if runtime is 91684.5428943634ms
2022-09-21 06:44:50 INFO  Estimated optimised what-if runtime is 20120.497226715088ms
2022-09-21 06:44:50 INFO  Estimated optimisation runtime saving is 71564.04566764832ms
2022-09-21 06:44:50 INFO  ---RUNTIME: Multi-Query Optimization took 10.498523712158203 ms
2022-09-21 06:44:50 INFO  Executing generated plans
2022-09-21 06:45:11 INFO  ---RUNTIME: Execution took 20348.259925842285 ms
2022-09-21 06:45:11 INFO  Done!
2022-09-21 06:45:11 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-21 06:45:11 INFO  Running instrumented original pipeline...
2022-09-21 06:45:11 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-21 06:45:11 INFO  ---RUNTIME: Importing and monkey-patching took 6.1321258544921875 ms
2022-09-21 06:45:30 INFO  ---RUNTIME: Original pipeline execution took 18964.734315872192 ms (excluding imports and monkey-patching)
2022-09-21 06:45:30 INFO  Starting execution of 1 what-if analyses...
2022-09-21 06:45:30 INFO  Start plan generation for analysis PermutationFeatureImportance...
2022-09-21 06:45:30 INFO  ---RUNTIME: Plan generation took 0.11229515075683594 ms
2022-09-21 06:45:30 INFO  Estimated runtime of original DAG is 17746.578693389893ms
2022-09-21 06:45:30 WARNING Skipping Multi-Query Optimization (instead, only combine execution DAGs)
2022-09-21 06:45:30 INFO  Estimated unoptimised what-if runtime is 88732.89346694946ms
2022-09-21 06:45:30 INFO  ---RUNTIME: Multi-Query Optimization took 15.19322395324707 ms
2022-09-21 06:45:30 INFO  Executing generated plans
2022-09-21 06:47:04 INFO  ---RUNTIME: Execution took 94497.34258651733 ms
2022-09-21 06:47:04 INFO  Done!
2022-09-21 06:47:04 INFO  # Finished -- repetition 7 of 7 
2022-09-21 06:47:04 INFO  # Final results after all repetitions
2022-09-21 06:47:04 INFO     repetition  ... no_opt_what_if_execution_combined_model_training
0           0  ...                                     66361.176968
1           1  ...                                     65700.898170
2           2  ...                                     65566.027403
3           3  ...                                     64546.950579
4           4  ...                                     61454.454184
5           5  ...                                     58732.613325
6           6  ...                                     59472.194672

[7 rows x 26 columns]
taskset -c 160-168 PROTOCOL_BUFFERS_PYTHON_IMPLEMENTATION=python python3.9 benchmarks_end_to_end.py feature_importance reviews slow_loading featurization_2 neural_network
2022-09-21 06:47:07.013471: W tensorflow/stream_executor/platform/default/dso_loader.cc:64] Could not load dynamic library 'libcudart.so.11.0'; dlerror: libcudart.so.11.0: cannot open shared object file: No such file or directory; LD_LIBRARY_PATH: /home/sgrafbe/mlwhatif/venv/lib/python3.9/site-packages/cv2/../../lib64:
2022-09-21 06:47:07.013520: I tensorflow/stream_executor/cuda/cudart_stub.cc:29] Ignore above cudart dlerror if you do not have a GPU set up on your machine.
2022-09-21 06:47:08 INFO  Patching sys.argv with ['mlwhatif', 'reviews', 'slow_loading', 'featurization_2', 'neural_network']
2022-09-21 06:47:08 INFO  Running instrumented original pipeline...
2022-09-21 06:47:08 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-21 06:47:08 INFO  ---RUNTIME: Importing and monkey-patching took 121.7041015625 ms
2022-09-21 06:47:14.034496: W tensorflow/stream_executor/platform/default/dso_loader.cc:64] Could not load dynamic library 'libcuda.so.1'; dlerror: libcuda.so.1: cannot open shared object file: No such file or directory; LD_LIBRARY_PATH: /home/sgrafbe/mlwhatif/venv/lib/python3.9/site-packages/cv2/../../lib64:
2022-09-21 06:47:14.034541: W tensorflow/stream_executor/cuda/cuda_driver.cc:326] failed call to cuInit: UNKNOWN ERROR (303)
2022-09-21 06:47:14.034568: I tensorflow/stream_executor/cuda/cuda_diagnostics.cc:156] kernel driver does not appear to be running on this host (angus): /proc/driver/nvidia/version does not exist
2022-09-21 06:47:14.035093: I tensorflow/core/platform/cpu_feature_guard.cc:142] This TensorFlow binary is optimized with oneAPI Deep Neural Network Library (oneDNN) to use the following CPU instructions in performance-critical operations:  AVX2 FMA
To enable them in other operations, rebuild TensorFlow with the appropriate compiler flags.
2022-09-21 06:47:14.667889: I tensorflow/compiler/mlir/mlir_graph_optimization_pass.cc:176] None of the MLIR Optimization Passes are enabled (registered 2)
2022-09-21 06:47:14.682179: I tensorflow/core/platform/profile_utils/cpu_utils.cc:114] CPU Frequency: 2595130000 Hz
2022-09-21 06:47:21 INFO  ---RUNTIME: Original pipeline execution took 13546.982288360596 ms (excluding imports and monkey-patching)
2022-09-21 06:47:21 INFO  Starting execution of 0 what-if analyses...
2022-09-21 06:47:21 INFO  Estimated runtime of original DAG is 12330.405950546265ms
2022-09-21 06:47:21 INFO  Performing Multi-Query Optimization
2022-09-21 06:47:21 INFO  Estimated unoptimized what-if runtime is 0ms
2022-09-21 06:47:21 INFO  Estimated optimised what-if runtime is 0ms
2022-09-21 06:47:21 INFO  Estimated optimisation runtime saving is 0ms
2022-09-21 06:47:21 INFO  ---RUNTIME: Multi-Query Optimization took 0.5402565002441406 ms
2022-09-21 06:47:21 INFO  Executing generated plans
2022-09-21 06:47:21 INFO  ---RUNTIME: Execution took 0.02574920654296875 ms
2022-09-21 06:47:21 INFO  Done!
2022-09-21 06:47:21 INFO  # Optimization benchmark for feature_importance with args [['reviews', 'slow_loading', 'featurization_2', 'neural_network']] -- repetition 1 of 7
2022-09-21 06:47:21 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-21 06:47:21 INFO  Running instrumented original pipeline...
2022-09-21 06:47:22 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-21 06:47:22 INFO  ---RUNTIME: Importing and monkey-patching took 5.435943603515625 ms
2022-09-21 06:47:35 INFO  ---RUNTIME: Original pipeline execution took 13155.717134475708 ms (excluding imports and monkey-patching)
2022-09-21 06:47:35 INFO  Starting execution of 1 what-if analyses...
2022-09-21 06:47:35 INFO  Start plan generation for analysis PermutationFeatureImportance...
2022-09-21 06:47:35 INFO  ---RUNTIME: Plan generation took 0.2562999725341797 ms
2022-09-21 06:47:35 INFO  Estimated runtime of original DAG is 11950.89602470398ms
2022-09-21 06:47:35 INFO  Performing Multi-Query Optimization
2022-09-21 06:47:35 INFO  Estimated unoptimized what-if runtime is 59754.4801235199ms
2022-09-21 06:47:35 INFO  Estimated optimised what-if runtime is 16588.31024169922ms
2022-09-21 06:47:35 INFO  Estimated optimisation runtime saving is 43166.16988182068ms
2022-09-21 06:47:35 INFO  ---RUNTIME: Multi-Query Optimization took 11.600017547607422 ms
2022-09-21 06:47:35 INFO  Executing generated plans
2022-09-21 06:47:53 INFO  ---RUNTIME: Execution took 18457.95202255249 ms
2022-09-21 06:47:53 INFO  Done!
2022-09-21 06:47:53 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-21 06:47:53 INFO  Running instrumented original pipeline...
2022-09-21 06:47:53 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-21 06:47:53 INFO  ---RUNTIME: Importing and monkey-patching took 6.3018798828125 ms
2022-09-21 06:48:07 INFO  ---RUNTIME: Original pipeline execution took 14037.293434143066 ms (excluding imports and monkey-patching)
2022-09-21 06:48:07 INFO  Starting execution of 1 what-if analyses...
2022-09-21 06:48:07 INFO  Start plan generation for analysis PermutationFeatureImportance...
2022-09-21 06:48:07 INFO  ---RUNTIME: Plan generation took 0.12302398681640625 ms
2022-09-21 06:48:07 INFO  Estimated runtime of original DAG is 12600.971221923828ms
2022-09-21 06:48:07 WARNING Skipping Multi-Query Optimization (instead, only combine execution DAGs)
2022-09-21 06:48:07 INFO  Estimated unoptimised what-if runtime is 63004.85610961914ms
2022-09-21 06:48:07 INFO  ---RUNTIME: Multi-Query Optimization took 15.954017639160156 ms
2022-09-21 06:48:07 INFO  Executing generated plans
2022-09-21 06:49:16 INFO  ---RUNTIME: Execution took 69235.43429374695 ms
2022-09-21 06:49:16 INFO  Done!
2022-09-21 06:49:16 INFO  # Finished -- repetition 1 of 7 
2022-09-21 06:49:16 INFO  # Optimization benchmark for feature_importance with args [['reviews', 'slow_loading', 'featurization_2', 'neural_network']] -- repetition 2 of 7
2022-09-21 06:49:16 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-21 06:49:16 INFO  Running instrumented original pipeline...
2022-09-21 06:49:16 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-21 06:49:16 INFO  ---RUNTIME: Importing and monkey-patching took 5.7506561279296875 ms
2022-09-21 06:49:30 INFO  ---RUNTIME: Original pipeline execution took 13865.636587142944 ms (excluding imports and monkey-patching)
2022-09-21 06:49:30 INFO  Starting execution of 1 what-if analyses...
2022-09-21 06:49:30 INFO  Start plan generation for analysis PermutationFeatureImportance...
2022-09-21 06:49:30 INFO  ---RUNTIME: Plan generation took 0.10824203491210938 ms
2022-09-21 06:49:30 INFO  Estimated runtime of original DAG is 12650.968551635742ms
2022-09-21 06:49:30 INFO  Performing Multi-Query Optimization
2022-09-21 06:49:30 INFO  Estimated unoptimized what-if runtime is 63254.84275817871ms
2022-09-21 06:49:30 INFO  Estimated optimised what-if runtime is 17602.521657943726ms
2022-09-21 06:49:30 INFO  Estimated optimisation runtime saving is 45652.321100234985ms
2022-09-21 06:49:30 INFO  ---RUNTIME: Multi-Query Optimization took 11.789083480834961 ms
2022-09-21 06:49:30 INFO  Executing generated plans
2022-09-21 06:49:49 INFO  ---RUNTIME: Execution took 19057.33823776245 ms
2022-09-21 06:49:49 INFO  Done!
2022-09-21 06:49:49 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-21 06:49:49 INFO  Running instrumented original pipeline...
2022-09-21 06:49:49 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-21 06:49:49 INFO  ---RUNTIME: Importing and monkey-patching took 6.362676620483398 ms
2022-09-21 06:50:04 INFO  ---RUNTIME: Original pipeline execution took 15004.710912704468 ms (excluding imports and monkey-patching)
2022-09-21 06:50:04 INFO  Starting execution of 1 what-if analyses...
2022-09-21 06:50:04 INFO  Start plan generation for analysis PermutationFeatureImportance...
2022-09-21 06:50:04 INFO  ---RUNTIME: Plan generation took 0.13875961303710938 ms
2022-09-21 06:50:04 INFO  Estimated runtime of original DAG is 13750.16164779663ms
2022-09-21 06:50:04 WARNING Skipping Multi-Query Optimization (instead, only combine execution DAGs)
2022-09-21 06:50:04 INFO  Estimated unoptimised what-if runtime is 68750.80823898315ms
2022-09-21 06:50:04 INFO  ---RUNTIME: Multi-Query Optimization took 16.050100326538086 ms
2022-09-21 06:50:04 INFO  Executing generated plans
2022-09-21 06:51:15 INFO  ---RUNTIME: Execution took 70469.59638595581 ms
2022-09-21 06:51:15 INFO  Done!
2022-09-21 06:51:15 INFO  # Finished -- repetition 2 of 7 
2022-09-21 06:51:15 INFO  # Optimization benchmark for feature_importance with args [['reviews', 'slow_loading', 'featurization_2', 'neural_network']] -- repetition 3 of 7
2022-09-21 06:51:15 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-21 06:51:15 INFO  Running instrumented original pipeline...
2022-09-21 06:51:15 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-21 06:51:15 INFO  ---RUNTIME: Importing and monkey-patching took 5.835771560668945 ms
2022-09-21 06:51:29 INFO  ---RUNTIME: Original pipeline execution took 14012.53056526184 ms (excluding imports and monkey-patching)
2022-09-21 06:51:29 INFO  Starting execution of 1 what-if analyses...
2022-09-21 06:51:29 INFO  Start plan generation for analysis PermutationFeatureImportance...
2022-09-21 06:51:29 INFO  ---RUNTIME: Plan generation took 0.11229515075683594 ms
2022-09-21 06:51:29 INFO  Estimated runtime of original DAG is 12789.318323135376ms
2022-09-21 06:51:29 INFO  Performing Multi-Query Optimization
2022-09-21 06:51:29 INFO  Estimated unoptimized what-if runtime is 63946.59161567688ms
2022-09-21 06:51:29 INFO  Estimated optimised what-if runtime is 17747.955560684204ms
2022-09-21 06:51:29 INFO  Estimated optimisation runtime saving is 46198.636054992676ms
2022-09-21 06:51:29 INFO  ---RUNTIME: Multi-Query Optimization took 11.199951171875 ms
2022-09-21 06:51:29 INFO  Executing generated plans
2022-09-21 06:51:48 INFO  ---RUNTIME: Execution took 18992.355585098267 ms
2022-09-21 06:51:48 INFO  Done!
2022-09-21 06:51:48 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-21 06:51:48 INFO  Running instrumented original pipeline...
2022-09-21 06:51:48 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-21 06:51:48 INFO  ---RUNTIME: Importing and monkey-patching took 6.517171859741211 ms
2022-09-21 06:52:02 INFO  ---RUNTIME: Original pipeline execution took 14448.105812072754 ms (excluding imports and monkey-patching)
2022-09-21 06:52:02 INFO  Starting execution of 1 what-if analyses...
2022-09-21 06:52:02 INFO  Start plan generation for analysis PermutationFeatureImportance...
2022-09-21 06:52:02 INFO  ---RUNTIME: Plan generation took 0.10943412780761719 ms
2022-09-21 06:52:02 INFO  Estimated runtime of original DAG is 12729.846954345703ms
2022-09-21 06:52:02 WARNING Skipping Multi-Query Optimization (instead, only combine execution DAGs)
2022-09-21 06:52:02 INFO  Estimated unoptimised what-if runtime is 63649.234771728516ms
2022-09-21 06:52:02 INFO  ---RUNTIME: Multi-Query Optimization took 16.22796058654785 ms
2022-09-21 06:52:02 INFO  Executing generated plans
2022-09-21 06:53:11 INFO  ---RUNTIME: Execution took 68328.21726799011 ms
2022-09-21 06:53:11 INFO  Done!
2022-09-21 06:53:11 INFO  # Finished -- repetition 3 of 7 
2022-09-21 06:53:11 INFO  # Optimization benchmark for feature_importance with args [['reviews', 'slow_loading', 'featurization_2', 'neural_network']] -- repetition 4 of 7
2022-09-21 06:53:11 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-21 06:53:11 INFO  Running instrumented original pipeline...
2022-09-21 06:53:11 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-21 06:53:11 INFO  ---RUNTIME: Importing and monkey-patching took 6.3381195068359375 ms
2022-09-21 06:53:25 INFO  ---RUNTIME: Original pipeline execution took 14413.193702697754 ms (excluding imports and monkey-patching)
2022-09-21 06:53:25 INFO  Starting execution of 1 what-if analyses...
2022-09-21 06:53:25 INFO  Start plan generation for analysis PermutationFeatureImportance...
2022-09-21 06:53:25 INFO  ---RUNTIME: Plan generation took 0.1373291015625 ms
2022-09-21 06:53:25 INFO  Estimated runtime of original DAG is 13180.998086929321ms
2022-09-21 06:53:25 INFO  Performing Multi-Query Optimization
2022-09-21 06:53:25 INFO  Estimated unoptimized what-if runtime is 65904.9904346466ms
2022-09-21 06:53:25 INFO  Estimated optimised what-if runtime is 17948.816061019897ms
2022-09-21 06:53:25 INFO  Estimated optimisation runtime saving is 47956.17437362671ms
2022-09-21 06:53:25 INFO  ---RUNTIME: Multi-Query Optimization took 11.536121368408203 ms
2022-09-21 06:53:25 INFO  Executing generated plans
2022-09-21 06:53:44 INFO  ---RUNTIME: Execution took 18712.98050880432 ms
2022-09-21 06:53:44 INFO  Done!
2022-09-21 06:53:44 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-21 06:53:44 INFO  Running instrumented original pipeline...
2022-09-21 06:53:44 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-21 06:53:44 INFO  ---RUNTIME: Importing and monkey-patching took 5.897998809814453 ms
2022-09-21 06:53:58 INFO  ---RUNTIME: Original pipeline execution took 13881.819009780884 ms (excluding imports and monkey-patching)
2022-09-21 06:53:58 INFO  Starting execution of 1 what-if analyses...
2022-09-21 06:53:58 INFO  Start plan generation for analysis PermutationFeatureImportance...
2022-09-21 06:53:58 INFO  ---RUNTIME: Plan generation took 0.11277198791503906 ms
2022-09-21 06:53:58 INFO  Estimated runtime of original DAG is 12647.972345352173ms
2022-09-21 06:53:58 WARNING Skipping Multi-Query Optimization (instead, only combine execution DAGs)
2022-09-21 06:53:58 INFO  Estimated unoptimised what-if runtime is 63239.861726760864ms
2022-09-21 06:53:58 INFO  ---RUNTIME: Multi-Query Optimization took 15.532255172729492 ms
2022-09-21 06:53:58 INFO  Executing generated plans
2022-09-21 06:55:05 INFO  ---RUNTIME: Execution took 67637.07494735718 ms
2022-09-21 06:55:05 INFO  Done!
2022-09-21 06:55:05 INFO  # Finished -- repetition 4 of 7 
2022-09-21 06:55:05 INFO  # Optimization benchmark for feature_importance with args [['reviews', 'slow_loading', 'featurization_2', 'neural_network']] -- repetition 5 of 7
2022-09-21 06:55:05 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-21 06:55:05 INFO  Running instrumented original pipeline...
2022-09-21 06:55:05 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-21 06:55:05 INFO  ---RUNTIME: Importing and monkey-patching took 5.79380989074707 ms
2022-09-21 06:55:21 INFO  ---RUNTIME: Original pipeline execution took 15486.174821853638 ms (excluding imports and monkey-patching)
2022-09-21 06:55:21 INFO  Starting execution of 1 what-if analyses...
2022-09-21 06:55:21 INFO  Start plan generation for analysis PermutationFeatureImportance...
2022-09-21 06:55:21 INFO  ---RUNTIME: Plan generation took 0.1468658447265625 ms
2022-09-21 06:55:21 INFO  Estimated runtime of original DAG is 14201.712131500244ms
2022-09-21 06:55:21 INFO  Performing Multi-Query Optimization
2022-09-21 06:55:21 INFO  Estimated unoptimized what-if runtime is 71008.56065750122ms
2022-09-21 06:55:21 INFO  Estimated optimised what-if runtime is 19171.197175979614ms
2022-09-21 06:55:21 INFO  Estimated optimisation runtime saving is 51837.36348152161ms
2022-09-21 06:55:21 INFO  ---RUNTIME: Multi-Query Optimization took 12.385129928588867 ms
2022-09-21 06:55:21 INFO  Executing generated plans
2022-09-21 06:55:40 INFO  ---RUNTIME: Execution took 19262.349843978882 ms
2022-09-21 06:55:40 INFO  Done!
2022-09-21 06:55:40 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-21 06:55:40 INFO  Running instrumented original pipeline...
2022-09-21 06:55:40 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-21 06:55:40 INFO  ---RUNTIME: Importing and monkey-patching took 5.670309066772461 ms
2022-09-21 06:55:54 INFO  ---RUNTIME: Original pipeline execution took 13743.160247802734 ms (excluding imports and monkey-patching)
2022-09-21 06:55:54 INFO  Starting execution of 1 what-if analyses...
2022-09-21 06:55:54 INFO  Start plan generation for analysis PermutationFeatureImportance...
2022-09-21 06:55:54 INFO  ---RUNTIME: Plan generation took 0.1277923583984375 ms
2022-09-21 06:55:54 INFO  Estimated runtime of original DAG is 12499.207258224487ms
2022-09-21 06:55:54 WARNING Skipping Multi-Query Optimization (instead, only combine execution DAGs)
2022-09-21 06:55:54 INFO  Estimated unoptimised what-if runtime is 62496.03629112244ms
2022-09-21 06:55:54 INFO  ---RUNTIME: Multi-Query Optimization took 15.637636184692383 ms
2022-09-21 06:55:54 INFO  Executing generated plans
2022-09-21 06:57:01 INFO  ---RUNTIME: Execution took 66850.79193115234 ms
2022-09-21 06:57:01 INFO  Done!
2022-09-21 06:57:01 INFO  # Finished -- repetition 5 of 7 
2022-09-21 06:57:01 INFO  # Optimization benchmark for feature_importance with args [['reviews', 'slow_loading', 'featurization_2', 'neural_network']] -- repetition 6 of 7
2022-09-21 06:57:01 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-21 06:57:01 INFO  Running instrumented original pipeline...
2022-09-21 06:57:01 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-21 06:57:01 INFO  ---RUNTIME: Importing and monkey-patching took 11.970996856689453 ms
2022-09-21 06:57:15 INFO  ---RUNTIME: Original pipeline execution took 13723.111867904663 ms (excluding imports and monkey-patching)
2022-09-21 06:57:15 INFO  Starting execution of 1 what-if analyses...
2022-09-21 06:57:15 INFO  Start plan generation for analysis PermutationFeatureImportance...
2022-09-21 06:57:15 INFO  ---RUNTIME: Plan generation took 0.1544952392578125 ms
2022-09-21 06:57:15 INFO  Estimated runtime of original DAG is 12490.137577056885ms
2022-09-21 06:57:15 INFO  Performing Multi-Query Optimization
2022-09-21 06:57:15 INFO  Estimated unoptimized what-if runtime is 62450.687885284424ms
2022-09-21 06:57:15 INFO  Estimated optimised what-if runtime is 17182.515382766724ms
2022-09-21 06:57:15 INFO  Estimated optimisation runtime saving is 45268.1725025177ms
2022-09-21 06:57:15 INFO  ---RUNTIME: Multi-Query Optimization took 10.764837265014648 ms
2022-09-21 06:57:15 INFO  Executing generated plans
2022-09-21 06:57:33 INFO  ---RUNTIME: Execution took 18319.591283798218 ms
2022-09-21 06:57:33 INFO  Done!
2022-09-21 06:57:33 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-21 06:57:33 INFO  Running instrumented original pipeline...
2022-09-21 06:57:33 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-21 06:57:33 INFO  ---RUNTIME: Importing and monkey-patching took 5.876779556274414 ms
2022-09-21 06:57:47 INFO  ---RUNTIME: Original pipeline execution took 13973.403692245483 ms (excluding imports and monkey-patching)
2022-09-21 06:57:47 INFO  Starting execution of 1 what-if analyses...
2022-09-21 06:57:47 INFO  Start plan generation for analysis PermutationFeatureImportance...
2022-09-21 06:57:47 INFO  ---RUNTIME: Plan generation took 0.1308917999267578 ms
2022-09-21 06:57:47 INFO  Estimated runtime of original DAG is 12729.915380477905ms
2022-09-21 06:57:47 WARNING Skipping Multi-Query Optimization (instead, only combine execution DAGs)
2022-09-21 06:57:47 INFO  Estimated unoptimised what-if runtime is 63649.57690238953ms
2022-09-21 06:57:47 INFO  ---RUNTIME: Multi-Query Optimization took 15.088796615600586 ms
2022-09-21 06:57:47 INFO  Executing generated plans
2022-09-21 06:58:54 INFO  ---RUNTIME: Execution took 67586.56930923462 ms
2022-09-21 06:58:54 INFO  Done!
2022-09-21 06:58:54 INFO  # Finished -- repetition 6 of 7 
2022-09-21 06:58:54 INFO  # Optimization benchmark for feature_importance with args [['reviews', 'slow_loading', 'featurization_2', 'neural_network']] -- repetition 7 of 7
2022-09-21 06:58:54 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-21 06:58:54 INFO  Running instrumented original pipeline...
2022-09-21 06:58:55 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-21 06:58:55 INFO  ---RUNTIME: Importing and monkey-patching took 6.009340286254883 ms
2022-09-21 06:59:08 INFO  ---RUNTIME: Original pipeline execution took 13844.05255317688 ms (excluding imports and monkey-patching)
2022-09-21 06:59:08 INFO  Starting execution of 1 what-if analyses...
2022-09-21 06:59:08 INFO  Start plan generation for analysis PermutationFeatureImportance...
2022-09-21 06:59:08 INFO  ---RUNTIME: Plan generation took 0.1633167266845703 ms
2022-09-21 06:59:08 INFO  Estimated runtime of original DAG is 12594.926834106445ms
2022-09-21 06:59:08 INFO  Performing Multi-Query Optimization
2022-09-21 06:59:08 INFO  Estimated unoptimized what-if runtime is 62974.63417053223ms
2022-09-21 06:59:08 INFO  Estimated optimised what-if runtime is 17027.06217765808ms
2022-09-21 06:59:08 INFO  Estimated optimisation runtime saving is 45947.571992874146ms
2022-09-21 06:59:08 INFO  ---RUNTIME: Multi-Query Optimization took 10.749340057373047 ms
2022-09-21 06:59:08 INFO  Executing generated plans
2022-09-21 06:59:26 INFO  ---RUNTIME: Execution took 17692.590475082397 ms
2022-09-21 06:59:26 INFO  Done!
2022-09-21 06:59:26 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-21 06:59:26 INFO  Running instrumented original pipeline...
2022-09-21 06:59:26 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-21 06:59:26 INFO  ---RUNTIME: Importing and monkey-patching took 5.792856216430664 ms
2022-09-21 06:59:40 INFO  ---RUNTIME: Original pipeline execution took 13577.539920806885 ms (excluding imports and monkey-patching)
2022-09-21 06:59:40 INFO  Starting execution of 1 what-if analyses...
2022-09-21 06:59:40 INFO  Start plan generation for analysis PermutationFeatureImportance...
2022-09-21 06:59:40 INFO  ---RUNTIME: Plan generation took 0.12969970703125 ms
2022-09-21 06:59:40 INFO  Estimated runtime of original DAG is 12351.760625839233ms
2022-09-21 06:59:40 WARNING Skipping Multi-Query Optimization (instead, only combine execution DAGs)
2022-09-21 06:59:40 INFO  Estimated unoptimised what-if runtime is 61758.80312919617ms
2022-09-21 06:59:40 INFO  ---RUNTIME: Multi-Query Optimization took 15.161275863647461 ms
2022-09-21 06:59:40 INFO  Executing generated plans
2022-09-21 07:00:47 INFO  ---RUNTIME: Execution took 67696.45690917969 ms
2022-09-21 07:00:47 INFO  Done!
2022-09-21 07:00:47 INFO  # Finished -- repetition 7 of 7 
2022-09-21 07:00:47 INFO  # Final results after all repetitions
2022-09-21 07:00:47 INFO     repetition  ... no_opt_what_if_execution_combined_model_training
0           0  ...                                     31363.240480
1           1  ...                                     32805.306911
2           2  ...                                     30715.640783
3           3  ...                                     30102.905750
4           4  ...                                     28794.606686
5           5  ...                                     29807.887793
6           6  ...                                     30401.286364

[7 rows x 26 columns]
taskset -c 160-168 PROTOCOL_BUFFERS_PYTHON_IMPLEMENTATION=python python3.9 benchmarks_end_to_end.py feature_importance reviews slow_loading featurization_3 logistic_regression
2022-09-21 07:00:50.364692: W tensorflow/stream_executor/platform/default/dso_loader.cc:64] Could not load dynamic library 'libcudart.so.11.0'; dlerror: libcudart.so.11.0: cannot open shared object file: No such file or directory; LD_LIBRARY_PATH: /home/sgrafbe/mlwhatif/venv/lib/python3.9/site-packages/cv2/../../lib64:
2022-09-21 07:00:50.364742: I tensorflow/stream_executor/cuda/cudart_stub.cc:29] Ignore above cudart dlerror if you do not have a GPU set up on your machine.
2022-09-21 07:00:51 INFO  Patching sys.argv with ['mlwhatif', 'reviews', 'slow_loading', 'featurization_3', 'logistic_regression']
2022-09-21 07:00:51 INFO  Running instrumented original pipeline...
2022-09-21 07:00:51 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-21 07:00:51 INFO  ---RUNTIME: Importing and monkey-patching took 121.490478515625 ms
2022-09-21 07:01:38 INFO  ---RUNTIME: Original pipeline execution took 46649.58333969116 ms (excluding imports and monkey-patching)
2022-09-21 07:01:38 INFO  Starting execution of 0 what-if analyses...
2022-09-21 07:01:38 INFO  Estimated runtime of original DAG is 33919.24595832825ms
2022-09-21 07:01:38 INFO  Performing Multi-Query Optimization
2022-09-21 07:01:38 INFO  Estimated unoptimized what-if runtime is 0ms
2022-09-21 07:01:38 INFO  Estimated optimised what-if runtime is 0ms
2022-09-21 07:01:38 INFO  Estimated optimisation runtime saving is 0ms
2022-09-21 07:01:38 INFO  ---RUNTIME: Multi-Query Optimization took 0.6177425384521484 ms
2022-09-21 07:01:38 INFO  Executing generated plans
2022-09-21 07:01:38 INFO  ---RUNTIME: Execution took 0.030994415283203125 ms
2022-09-21 07:01:38 INFO  Done!
2022-09-21 07:01:38 INFO  # Optimization benchmark for feature_importance with args [['reviews', 'slow_loading', 'featurization_3', 'logistic_regression']] -- repetition 1 of 7
2022-09-21 07:01:38 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-21 07:01:38 INFO  Running instrumented original pipeline...
2022-09-21 07:01:38 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-21 07:01:38 INFO  ---RUNTIME: Importing and monkey-patching took 6.098270416259766 ms
2022-09-21 07:02:28 INFO  ---RUNTIME: Original pipeline execution took 50131.428480148315 ms (excluding imports and monkey-patching)
2022-09-21 07:02:28 INFO  Starting execution of 1 what-if analyses...
2022-09-21 07:02:28 INFO  Start plan generation for analysis PermutationFeatureImportance...
2022-09-21 07:02:28 INFO  ---RUNTIME: Plan generation took 0.25534629821777344 ms
2022-09-21 07:02:28 INFO  Estimated runtime of original DAG is 34577.83365249634ms
2022-09-21 07:02:28 INFO  Performing Multi-Query Optimization
2022-09-21 07:02:28 INFO  Estimated unoptimized what-if runtime is 172889.1682624817ms
2022-09-21 07:02:28 INFO  Estimated optimised what-if runtime is 51071.22802734375ms
2022-09-21 07:02:28 INFO  Estimated optimisation runtime saving is 121817.94023513794ms
2022-09-21 07:02:28 INFO  ---RUNTIME: Multi-Query Optimization took 12.99595832824707 ms
2022-09-21 07:02:28 INFO  Executing generated plans
2022-09-21 07:03:05 INFO  ---RUNTIME: Execution took 36972.93186187744 ms
2022-09-21 07:03:05 INFO  Done!
2022-09-21 07:03:05 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-21 07:03:05 INFO  Running instrumented original pipeline...
2022-09-21 07:03:05 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-21 07:03:05 INFO  ---RUNTIME: Importing and monkey-patching took 6.145715713500977 ms
2022-09-21 07:03:52 INFO  ---RUNTIME: Original pipeline execution took 46970.53122520447 ms (excluding imports and monkey-patching)
2022-09-21 07:03:52 INFO  Starting execution of 1 what-if analyses...
2022-09-21 07:03:52 INFO  Start plan generation for analysis PermutationFeatureImportance...
2022-09-21 07:03:52 INFO  ---RUNTIME: Plan generation took 0.1418590545654297 ms
2022-09-21 07:03:52 INFO  Estimated runtime of original DAG is 35304.58307266235ms
2022-09-21 07:03:52 WARNING Skipping Multi-Query Optimization (instead, only combine execution DAGs)
2022-09-21 07:03:52 INFO  Estimated unoptimised what-if runtime is 176522.91536331177ms
2022-09-21 07:03:52 INFO  ---RUNTIME: Multi-Query Optimization took 18.856048583984375 ms
2022-09-21 07:03:52 INFO  Executing generated plans
Traceback (most recent call last):
  File "/home/sgrafbe/mlwhatif/experiments/end_to_end/benchmarks_end_to_end.py", line 238, in <module>
    analysis_result_no_opt = PipelineAnalyzer \
  File "/home/sgrafbe/mlwhatif/mlwhatif/_pipeline_analyzer.py", line 93, in execute
    return singleton.run(notebook_path=self._notebook_path,
  File "/home/sgrafbe/mlwhatif/mlwhatif/execution/_pipeline_executor.py", line 145, in run
    self.run_what_if_analyses()
  File "/home/sgrafbe/mlwhatif/mlwhatif/execution/_pipeline_executor.py", line 173, in run_what_if_analyses
    DagExecutor(self).execute(self.analysis_results.combined_optimized_dag)
  File "/home/sgrafbe/mlwhatif/mlwhatif/execution/_dag_executor.py", line 45, in execute
    self.traverse_graph_and_process_nodes(dag, execute_node)
  File "/home/sgrafbe/mlwhatif/mlwhatif/execution/_dag_executor.py", line 57, in traverse_graph_and_process_nodes
    result_node = func(node)
  File "/home/sgrafbe/mlwhatif/mlwhatif/execution/_dag_executor.py", line 40, in execute_node
    optimizer_info, result_df = capture_optimizer_info(executable_processing_func)
  File "/home/sgrafbe/mlwhatif/mlwhatif/execution/_stat_tracking.py", line 28, in capture_optimizer_info
    result = instrumented_function_call()
  File "/home/sgrafbe/mlwhatif/mlwhatif/monkeypatching/_patch_sklearn.py", line 1729, in processing_func
    transformed_data = wrap_in_mlinspect_array_if_necessary(transformed_data)
  File "/home/sgrafbe/mlwhatif/mlwhatif/monkeypatching/_monkey_patching_utils.py", line 229, in wrap_in_mlinspect_array_if_necessary
    df_object = MlinspectNdarray(df_object)
  File "/home/sgrafbe/mlwhatif/mlwhatif/monkeypatching/_mlinspect_ndarray.py", line 16, in __new__
    obj = numpy.asarray(input_array).view(cls)
  File "/home/sgrafbe/mlwhatif/venv/lib64/python3.9/site-packages/numpy/core/_asarray.py", line 83, in asarray
    return array(a, dtype, copy=False, order=order)
numpy.core._exceptions.MemoryError: Unable to allocate 3.89 GiB for an array with shape (35312,) and data type <U29600
taskset -c 160-168 PROTOCOL_BUFFERS_PYTHON_IMPLEMENTATION=python python3.9 benchmarks_end_to_end.py feature_importance reviews slow_loading featurization_3 xgboost
2022-09-21 07:04:23.516118: W tensorflow/stream_executor/platform/default/dso_loader.cc:64] Could not load dynamic library 'libcudart.so.11.0'; dlerror: libcudart.so.11.0: cannot open shared object file: No such file or directory; LD_LIBRARY_PATH: /home/sgrafbe/mlwhatif/venv/lib/python3.9/site-packages/cv2/../../lib64:
2022-09-21 07:04:23.516160: I tensorflow/stream_executor/cuda/cudart_stub.cc:29] Ignore above cudart dlerror if you do not have a GPU set up on your machine.
2022-09-21 07:04:25 INFO  Patching sys.argv with ['mlwhatif', 'reviews', 'slow_loading', 'featurization_3', 'xgboost']
2022-09-21 07:04:25 INFO  Running instrumented original pipeline...
2022-09-21 07:04:25 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-21 07:04:25 INFO  ---RUNTIME: Importing and monkey-patching took 207.56936073303223 ms
2022-09-21 07:05:24 INFO  ---RUNTIME: Original pipeline execution took 58427.10733413696 ms (excluding imports and monkey-patching)
2022-09-21 07:05:24 INFO  Starting execution of 0 what-if analyses...
2022-09-21 07:05:24 INFO  Estimated runtime of original DAG is 51143.44072341919ms
2022-09-21 07:05:24 INFO  Performing Multi-Query Optimization
2022-09-21 07:05:24 INFO  Estimated unoptimized what-if runtime is 0ms
2022-09-21 07:05:24 INFO  Estimated optimised what-if runtime is 0ms
2022-09-21 07:05:24 INFO  Estimated optimisation runtime saving is 0ms
2022-09-21 07:05:24 INFO  ---RUNTIME: Multi-Query Optimization took 0.591278076171875 ms
2022-09-21 07:05:24 INFO  Executing generated plans
2022-09-21 07:05:24 INFO  ---RUNTIME: Execution took 0.023365020751953125 ms
2022-09-21 07:05:24 INFO  Done!
2022-09-21 07:05:24 INFO  # Optimization benchmark for feature_importance with args [['reviews', 'slow_loading', 'featurization_3', 'xgboost']] -- repetition 1 of 7
2022-09-21 07:05:24 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-21 07:05:24 INFO  Running instrumented original pipeline...
2022-09-21 07:05:24 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-21 07:05:24 INFO  ---RUNTIME: Importing and monkey-patching took 5.719661712646484 ms
2022-09-21 07:06:19 INFO  ---RUNTIME: Original pipeline execution took 55574.602365493774 ms (excluding imports and monkey-patching)
2022-09-21 07:06:19 INFO  Starting execution of 1 what-if analyses...
2022-09-21 07:06:19 INFO  Start plan generation for analysis PermutationFeatureImportance...
2022-09-21 07:06:19 INFO  ---RUNTIME: Plan generation took 0.24890899658203125 ms
2022-09-21 07:06:19 INFO  Estimated runtime of original DAG is 47405.317306518555ms
2022-09-21 07:06:19 INFO  Performing Multi-Query Optimization
2022-09-21 07:06:19 INFO  Estimated unoptimized what-if runtime is 237026.58653259277ms
2022-09-21 07:06:19 INFO  Estimated optimised what-if runtime is 63782.75227546692ms
2022-09-21 07:06:19 INFO  Estimated optimisation runtime saving is 173243.83425712585ms
2022-09-21 07:06:19 INFO  ---RUNTIME: Multi-Query Optimization took 12.941122055053711 ms
2022-09-21 07:06:19 INFO  Executing generated plans
2022-09-21 07:07:10 INFO  ---RUNTIME: Execution took 50903.13386917114 ms
2022-09-21 07:07:10 INFO  Done!
2022-09-21 07:07:10 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-21 07:07:10 INFO  Running instrumented original pipeline...
2022-09-21 07:07:10 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-21 07:07:10 INFO  ---RUNTIME: Importing and monkey-patching took 6.169557571411133 ms
2022-09-21 07:08:15 INFO  ---RUNTIME: Original pipeline execution took 64652.41622924805 ms (excluding imports and monkey-patching)
2022-09-21 07:08:15 INFO  Starting execution of 1 what-if analyses...
2022-09-21 07:08:15 INFO  Start plan generation for analysis PermutationFeatureImportance...
2022-09-21 07:08:15 INFO  ---RUNTIME: Plan generation took 0.13065338134765625 ms
2022-09-21 07:08:15 INFO  Estimated runtime of original DAG is 50464.96534347534ms
2022-09-21 07:08:15 WARNING Skipping Multi-Query Optimization (instead, only combine execution DAGs)
2022-09-21 07:08:15 INFO  Estimated unoptimised what-if runtime is 252324.8267173767ms
2022-09-21 07:08:15 INFO  ---RUNTIME: Multi-Query Optimization took 18.508434295654297 ms
2022-09-21 07:08:15 INFO  Executing generated plans
2022-09-21 07:12:47 INFO  ---RUNTIME: Execution took 272069.4396495819 ms
2022-09-21 07:12:47 INFO  Done!
2022-09-21 07:12:47 INFO  # Finished -- repetition 1 of 7 
2022-09-21 07:12:47 INFO  # Optimization benchmark for feature_importance with args [['reviews', 'slow_loading', 'featurization_3', 'xgboost']] -- repetition 2 of 7
2022-09-21 07:12:47 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-21 07:12:47 INFO  Running instrumented original pipeline...
2022-09-21 07:12:47 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-21 07:12:47 INFO  ---RUNTIME: Importing and monkey-patching took 6.090402603149414 ms
Traceback (most recent call last):
  File "/home/sgrafbe/mlwhatif/experiments/end_to_end/benchmarks_end_to_end.py", line 228, in <module>
    analysis_result_opt = PipelineAnalyzer \
  File "/home/sgrafbe/mlwhatif/mlwhatif/_pipeline_analyzer.py", line 93, in execute
    return singleton.run(notebook_path=self._notebook_path,
  File "/home/sgrafbe/mlwhatif/mlwhatif/execution/_pipeline_executor.py", line 110, in run
    self.run_instrumented_pipeline(notebook_path, python_code, python_path)
  File "/home/sgrafbe/mlwhatif/mlwhatif/execution/_pipeline_executor.py", line 197, in run_instrumented_pipeline
    exec(compile(parsed_modified_ast, filename=self.source_code_path, mode="exec"), self.script_scope)
  File "/home/sgrafbe/mlwhatif/experiments/end_to_end/run_pipeline.py", line 451, in <module>
    predictions = pipeline.predict(test)
  File "/home/sgrafbe/mlwhatif/venv/lib64/python3.9/site-packages/sklearn/utils/metaestimators.py", line 119, in <lambda>
    out = lambda *args, **kwargs: self.fn(obj, *args, **kwargs)
  File "/home/sgrafbe/mlwhatif/venv/lib64/python3.9/site-packages/sklearn/pipeline.py", line 407, in predict
    Xt = transform.transform(Xt)
  File "/home/sgrafbe/mlwhatif/mlwhatif/monkeypatching/_patch_sklearn.py", line 323, in patched_transform
    result = original(self, *args, **kwargs)
  File "/home/sgrafbe/mlwhatif/venv/lib64/python3.9/site-packages/sklearn/compose/_column_transformer.py", line 604, in transform
    Xs = self._fit_transform(X, None, _transform_one, fitted=True)
  File "/home/sgrafbe/mlwhatif/venv/lib64/python3.9/site-packages/sklearn/compose/_column_transformer.py", line 458, in _fit_transform
    return Parallel(n_jobs=self.n_jobs)(
  File "/home/sgrafbe/mlwhatif/venv/lib64/python3.9/site-packages/joblib/parallel.py", line 1046, in __call__
    while self.dispatch_one_batch(iterator):
  File "/home/sgrafbe/mlwhatif/venv/lib64/python3.9/site-packages/joblib/parallel.py", line 861, in dispatch_one_batch
    self._dispatch(tasks)
  File "/home/sgrafbe/mlwhatif/venv/lib64/python3.9/site-packages/joblib/parallel.py", line 779, in _dispatch
    job = self._backend.apply_async(batch, callback=cb)
  File "/home/sgrafbe/mlwhatif/venv/lib64/python3.9/site-packages/joblib/_parallel_backends.py", line 208, in apply_async
    result = ImmediateResult(func)
  File "/home/sgrafbe/mlwhatif/venv/lib64/python3.9/site-packages/joblib/_parallel_backends.py", line 572, in __init__
    self.results = batch()
  File "/home/sgrafbe/mlwhatif/venv/lib64/python3.9/site-packages/joblib/parallel.py", line 262, in __call__
    return [func(*args, **kwargs)
  File "/home/sgrafbe/mlwhatif/venv/lib64/python3.9/site-packages/joblib/parallel.py", line 262, in <listcomp>
    return [func(*args, **kwargs)
  File "/home/sgrafbe/mlwhatif/venv/lib64/python3.9/site-packages/sklearn/pipeline.py", line 719, in _transform_one
    res = transformer.transform(X)
  File "/home/sgrafbe/mlwhatif/venv/lib64/python3.9/site-packages/sklearn/pipeline.py", line 549, in _transform
    Xt = transform.transform(Xt)
  File "/home/sgrafbe/mlwhatif/mlwhatif/monkeypatching/_patch_sklearn.py", line 1789, in patched_transform
    add_dag_node(dag_node, [transformer_dag_node, input_info.dag_node], function_call_result)
  File "/home/sgrafbe/mlwhatif/mlwhatif/monkeypatching/_monkey_patching_utils.py", line 255, in add_dag_node
    function_call_result.function_result = wrap_in_mlinspect_array_if_necessary(
  File "/home/sgrafbe/mlwhatif/mlwhatif/monkeypatching/_monkey_patching_utils.py", line 229, in wrap_in_mlinspect_array_if_necessary
    df_object = MlinspectNdarray(df_object)
  File "/home/sgrafbe/mlwhatif/mlwhatif/monkeypatching/_mlinspect_ndarray.py", line 16, in __new__
    obj = numpy.asarray(input_array).view(cls)
  File "/home/sgrafbe/mlwhatif/venv/lib64/python3.9/site-packages/numpy/core/_asarray.py", line 83, in asarray
    return array(a, dtype, copy=False, order=order)
numpy.core._exceptions.MemoryError: Unable to allocate 4.57 GiB for an array with shape (52075,) and data type <U23536
taskset -c 160-168 PROTOCOL_BUFFERS_PYTHON_IMPLEMENTATION=python python3.9 benchmarks_end_to_end.py feature_importance reviews slow_loading featurization_3 neural_network
2022-09-21 07:13:57.465121: W tensorflow/stream_executor/platform/default/dso_loader.cc:64] Could not load dynamic library 'libcudart.so.11.0'; dlerror: libcudart.so.11.0: cannot open shared object file: No such file or directory; LD_LIBRARY_PATH: /home/sgrafbe/mlwhatif/venv/lib/python3.9/site-packages/cv2/../../lib64:
2022-09-21 07:13:57.465170: I tensorflow/stream_executor/cuda/cudart_stub.cc:29] Ignore above cudart dlerror if you do not have a GPU set up on your machine.
2022-09-21 07:13:58 INFO  Patching sys.argv with ['mlwhatif', 'reviews', 'slow_loading', 'featurization_3', 'neural_network']
2022-09-21 07:13:58 INFO  Running instrumented original pipeline...
2022-09-21 07:13:58 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-21 07:13:58 INFO  ---RUNTIME: Importing and monkey-patching took 121.5066909790039 ms
2022-09-21 07:14:20.677291: W tensorflow/stream_executor/platform/default/dso_loader.cc:64] Could not load dynamic library 'libcuda.so.1'; dlerror: libcuda.so.1: cannot open shared object file: No such file or directory; LD_LIBRARY_PATH: /home/sgrafbe/mlwhatif/venv/lib/python3.9/site-packages/cv2/../../lib64:
2022-09-21 07:14:20.677331: W tensorflow/stream_executor/cuda/cuda_driver.cc:326] failed call to cuInit: UNKNOWN ERROR (303)
2022-09-21 07:14:20.677354: I tensorflow/stream_executor/cuda/cuda_diagnostics.cc:156] kernel driver does not appear to be running on this host (angus): /proc/driver/nvidia/version does not exist
2022-09-21 07:14:20.677841: I tensorflow/core/platform/cpu_feature_guard.cc:142] This TensorFlow binary is optimized with oneAPI Deep Neural Network Library (oneDNN) to use the following CPU instructions in performance-critical operations:  AVX2 FMA
To enable them in other operations, rebuild TensorFlow with the appropriate compiler flags.
2022-09-21 07:14:21.288886: I tensorflow/compiler/mlir/mlir_graph_optimization_pass.cc:176] None of the MLIR Optimization Passes are enabled (registered 2)
2022-09-21 07:14:21.303185: I tensorflow/core/platform/profile_utils/cpu_utils.cc:114] CPU Frequency: 2595130000 Hz
2022-09-21 07:14:45 INFO  ---RUNTIME: Original pipeline execution took 46446.65837287903 ms (excluding imports and monkey-patching)
2022-09-21 07:14:45 INFO  Starting execution of 0 what-if analyses...
2022-09-21 07:14:45 INFO  Estimated runtime of original DAG is 39221.33493423462ms
2022-09-21 07:14:45 INFO  Performing Multi-Query Optimization
2022-09-21 07:14:45 INFO  Estimated unoptimized what-if runtime is 0ms
2022-09-21 07:14:45 INFO  Estimated optimised what-if runtime is 0ms
2022-09-21 07:14:45 INFO  Estimated optimisation runtime saving is 0ms
2022-09-21 07:14:45 INFO  ---RUNTIME: Multi-Query Optimization took 0.5884170532226562 ms
2022-09-21 07:14:45 INFO  Executing generated plans
2022-09-21 07:14:45 INFO  ---RUNTIME: Execution took 0.02193450927734375 ms
2022-09-21 07:14:45 INFO  Done!
2022-09-21 07:14:45 INFO  # Optimization benchmark for feature_importance with args [['reviews', 'slow_loading', 'featurization_3', 'neural_network']] -- repetition 1 of 7
2022-09-21 07:14:45 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-21 07:14:45 INFO  Running instrumented original pipeline...
2022-09-21 07:14:45 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-21 07:14:45 INFO  ---RUNTIME: Importing and monkey-patching took 5.431890487670898 ms
2022-09-21 07:15:34 INFO  ---RUNTIME: Original pipeline execution took 49324.03039932251 ms (excluding imports and monkey-patching)
2022-09-21 07:15:34 INFO  Starting execution of 1 what-if analyses...
2022-09-21 07:15:34 INFO  Start plan generation for analysis PermutationFeatureImportance...
2022-09-21 07:15:34 INFO  ---RUNTIME: Plan generation took 0.2434253692626953 ms
2022-09-21 07:15:34 INFO  Estimated runtime of original DAG is 39071.7933177948ms
2022-09-21 07:15:34 INFO  Performing Multi-Query Optimization
2022-09-21 07:15:34 INFO  Estimated unoptimized what-if runtime is 195358.966588974ms
2022-09-21 07:15:34 INFO  Estimated optimised what-if runtime is 58217.95701980591ms
2022-09-21 07:15:34 INFO  Estimated optimisation runtime saving is 137141.0095691681ms
2022-09-21 07:15:34 INFO  ---RUNTIME: Multi-Query Optimization took 13.0767822265625 ms
2022-09-21 07:15:34 INFO  Executing generated plans
2022-09-21 07:16:23 INFO  ---RUNTIME: Execution took 48410.06851196289 ms
2022-09-21 07:16:23 INFO  Done!
2022-09-21 07:16:23 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-21 07:16:23 INFO  Running instrumented original pipeline...
2022-09-21 07:16:23 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-21 07:16:23 INFO  ---RUNTIME: Importing and monkey-patching took 5.928754806518555 ms
2022-09-21 07:17:20 INFO  ---RUNTIME: Original pipeline execution took 57371.57392501831 ms (excluding imports and monkey-patching)
2022-09-21 07:17:20 INFO  Starting execution of 1 what-if analyses...
2022-09-21 07:17:20 INFO  Start plan generation for analysis PermutationFeatureImportance...
2022-09-21 07:17:20 INFO  ---RUNTIME: Plan generation took 0.1494884490966797 ms
2022-09-21 07:17:20 INFO  Estimated runtime of original DAG is 40529.30665016174ms
2022-09-21 07:17:20 WARNING Skipping Multi-Query Optimization (instead, only combine execution DAGs)
2022-09-21 07:17:20 INFO  Estimated unoptimised what-if runtime is 202646.53325080872ms
2022-09-21 07:17:20 INFO  ---RUNTIME: Multi-Query Optimization took 18.804311752319336 ms
2022-09-21 07:17:20 INFO  Executing generated plans
2022-09-21 07:20:42 INFO  ---RUNTIME: Execution took 201756.69169425964 ms
2022-09-21 07:20:42 INFO  Done!
2022-09-21 07:20:42 INFO  # Finished -- repetition 1 of 7 
2022-09-21 07:20:42 INFO  # Optimization benchmark for feature_importance with args [['reviews', 'slow_loading', 'featurization_3', 'neural_network']] -- repetition 2 of 7
2022-09-21 07:20:42 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-21 07:20:42 INFO  Running instrumented original pipeline...
2022-09-21 07:20:42 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-21 07:20:42 INFO  ---RUNTIME: Importing and monkey-patching took 11.038541793823242 ms
2022-09-21 07:21:30 INFO  ---RUNTIME: Original pipeline execution took 48015.862226486206 ms (excluding imports and monkey-patching)
2022-09-21 07:21:30 INFO  Starting execution of 1 what-if analyses...
2022-09-21 07:21:30 INFO  Start plan generation for analysis PermutationFeatureImportance...
2022-09-21 07:21:30 INFO  ---RUNTIME: Plan generation took 0.15115737915039062 ms
2022-09-21 07:21:30 INFO  Estimated runtime of original DAG is 40539.58177566528ms
2022-09-21 07:21:30 INFO  Performing Multi-Query Optimization
2022-09-21 07:21:30 INFO  Estimated unoptimized what-if runtime is 202697.90887832642ms
2022-09-21 07:21:30 INFO  Estimated optimised what-if runtime is 60121.657609939575ms
2022-09-21 07:21:30 INFO  Estimated optimisation runtime saving is 142576.25126838684ms
2022-09-21 07:21:30 INFO  ---RUNTIME: Multi-Query Optimization took 13.082504272460938 ms
2022-09-21 07:21:30 INFO  Executing generated plans
2022-09-21 07:22:09 INFO  ---RUNTIME: Execution took 39484.41457748413 ms
2022-09-21 07:22:09 INFO  Done!
2022-09-21 07:22:10 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-21 07:22:10 INFO  Running instrumented original pipeline...
2022-09-21 07:22:10 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-21 07:22:10 INFO  ---RUNTIME: Importing and monkey-patching took 6.598949432373047 ms
2022-09-21 07:22:59 INFO  ---RUNTIME: Original pipeline execution took 48755.223512649536 ms (excluding imports and monkey-patching)
2022-09-21 07:22:59 INFO  Starting execution of 1 what-if analyses...
2022-09-21 07:22:59 INFO  Start plan generation for analysis PermutationFeatureImportance...
2022-09-21 07:22:59 INFO  ---RUNTIME: Plan generation took 0.1418590545654297 ms
2022-09-21 07:22:59 INFO  Estimated runtime of original DAG is 39843.505859375ms
2022-09-21 07:22:59 WARNING Skipping Multi-Query Optimization (instead, only combine execution DAGs)
2022-09-21 07:22:59 INFO  Estimated unoptimised what-if runtime is 199217.529296875ms
2022-09-21 07:22:59 INFO  ---RUNTIME: Multi-Query Optimization took 18.43571662902832 ms
2022-09-21 07:22:59 INFO  Executing generated plans
2022-09-21 07:26:30 INFO  ---RUNTIME: Execution took 211091.4487838745 ms
2022-09-21 07:26:30 INFO  Done!
2022-09-21 07:26:32 INFO  # Finished -- repetition 2 of 7 
2022-09-21 07:26:32 INFO  # Optimization benchmark for feature_importance with args [['reviews', 'slow_loading', 'featurization_3', 'neural_network']] -- repetition 3 of 7
2022-09-21 07:26:32 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-21 07:26:32 INFO  Running instrumented original pipeline...
2022-09-21 07:26:32 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-21 07:26:32 INFO  ---RUNTIME: Importing and monkey-patching took 6.4601898193359375 ms
2022-09-21 07:27:27 INFO  ---RUNTIME: Original pipeline execution took 55236.05036735535 ms (excluding imports and monkey-patching)
2022-09-21 07:27:27 INFO  Starting execution of 1 what-if analyses...
2022-09-21 07:27:27 INFO  Start plan generation for analysis PermutationFeatureImportance...
2022-09-21 07:27:27 INFO  ---RUNTIME: Plan generation took 0.1571178436279297 ms
2022-09-21 07:27:27 INFO  Estimated runtime of original DAG is 42193.08018684387ms
2022-09-21 07:27:27 INFO  Performing Multi-Query Optimization
2022-09-21 07:27:27 INFO  Estimated unoptimized what-if runtime is 210965.40093421936ms
2022-09-21 07:27:27 INFO  Estimated optimised what-if runtime is 62802.70218849182ms
2022-09-21 07:27:27 INFO  Estimated optimisation runtime saving is 148162.69874572754ms
2022-09-21 07:27:27 INFO  ---RUNTIME: Multi-Query Optimization took 12.869596481323242 ms
2022-09-21 07:27:27 INFO  Executing generated plans
2022-09-21 07:28:15 INFO  ---RUNTIME: Execution took 47736.89603805542 ms
2022-09-21 07:28:15 INFO  Done!
2022-09-21 07:28:15 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-21 07:28:15 INFO  Running instrumented original pipeline...
2022-09-21 07:28:15 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-21 07:28:15 INFO  ---RUNTIME: Importing and monkey-patching took 6.908178329467773 ms
2022-09-21 07:29:02 INFO  ---RUNTIME: Original pipeline execution took 47362.15901374817 ms (excluding imports and monkey-patching)
2022-09-21 07:29:02 INFO  Starting execution of 1 what-if analyses...
2022-09-21 07:29:02 INFO  Start plan generation for analysis PermutationFeatureImportance...
2022-09-21 07:29:02 INFO  ---RUNTIME: Plan generation took 0.1506805419921875 ms
2022-09-21 07:29:02 INFO  Estimated runtime of original DAG is 39840.02470970154ms
2022-09-21 07:29:02 WARNING Skipping Multi-Query Optimization (instead, only combine execution DAGs)
2022-09-21 07:29:02 INFO  Estimated unoptimised what-if runtime is 199200.1235485077ms
2022-09-21 07:29:02 INFO  ---RUNTIME: Multi-Query Optimization took 19.029617309570312 ms
2022-09-21 07:29:02 INFO  Executing generated plans
2022-09-21 07:33:01 INFO  ---RUNTIME: Execution took 238802.40440368652 ms
2022-09-21 07:33:01 INFO  Done!
2022-09-21 07:33:02 INFO  # Finished -- repetition 3 of 7 
2022-09-21 07:33:02 INFO  # Optimization benchmark for feature_importance with args [['reviews', 'slow_loading', 'featurization_3', 'neural_network']] -- repetition 4 of 7
2022-09-21 07:33:02 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-21 07:33:02 INFO  Running instrumented original pipeline...
2022-09-21 07:33:02 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-21 07:33:02 INFO  ---RUNTIME: Importing and monkey-patching took 5.886077880859375 ms
2022-09-21 07:34:03 INFO  ---RUNTIME: Original pipeline execution took 61435.29009819031 ms (excluding imports and monkey-patching)
2022-09-21 07:34:03 INFO  Starting execution of 1 what-if analyses...
2022-09-21 07:34:03 INFO  Start plan generation for analysis PermutationFeatureImportance...
2022-09-21 07:34:03 INFO  ---RUNTIME: Plan generation took 0.1506805419921875 ms
2022-09-21 07:34:03 INFO  Estimated runtime of original DAG is 51006.41345977783ms
2022-09-21 07:34:03 INFO  Performing Multi-Query Optimization
2022-09-21 07:34:03 INFO  Estimated unoptimized what-if runtime is 255032.06729888916ms
2022-09-21 07:34:03 INFO  Estimated optimised what-if runtime is 73897.14121818542ms
2022-09-21 07:34:03 INFO  Estimated optimisation runtime saving is 181134.92608070374ms
2022-09-21 07:34:03 INFO  ---RUNTIME: Multi-Query Optimization took 12.467384338378906 ms
2022-09-21 07:34:03 INFO  Executing generated plans
2022-09-21 07:34:51 INFO  ---RUNTIME: Execution took 47731.15038871765 ms
2022-09-21 07:34:51 INFO  Done!
2022-09-21 07:34:53 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-21 07:34:53 INFO  Running instrumented original pipeline...
2022-09-21 07:34:53 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-21 07:34:53 INFO  ---RUNTIME: Importing and monkey-patching took 6.619930267333984 ms
2022-09-21 07:35:57 INFO  ---RUNTIME: Original pipeline execution took 64100.433588027954 ms (excluding imports and monkey-patching)
2022-09-21 07:35:57 INFO  Starting execution of 1 what-if analyses...
2022-09-21 07:35:57 INFO  Start plan generation for analysis PermutationFeatureImportance...
2022-09-21 07:35:57 INFO  ---RUNTIME: Plan generation took 0.15211105346679688 ms
2022-09-21 07:35:57 INFO  Estimated runtime of original DAG is 50211.8194103241ms
2022-09-21 07:35:57 WARNING Skipping Multi-Query Optimization (instead, only combine execution DAGs)
2022-09-21 07:35:57 INFO  Estimated unoptimised what-if runtime is 251059.09705162048ms
2022-09-21 07:35:57 INFO  ---RUNTIME: Multi-Query Optimization took 18.013715744018555 ms
2022-09-21 07:35:57 INFO  Executing generated plans
2022-09-21 07:40:06 INFO  ---RUNTIME: Execution took 248885.41078567505 ms
2022-09-21 07:40:06 INFO  Done!
2022-09-21 07:40:06 INFO  # Finished -- repetition 4 of 7 
2022-09-21 07:40:06 INFO  # Optimization benchmark for feature_importance with args [['reviews', 'slow_loading', 'featurization_3', 'neural_network']] -- repetition 5 of 7
2022-09-21 07:40:06 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-21 07:40:06 INFO  Running instrumented original pipeline...
2022-09-21 07:40:06 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-21 07:40:06 INFO  ---RUNTIME: Importing and monkey-patching took 8.580684661865234 ms
2022-09-21 07:40:59 INFO  ---RUNTIME: Original pipeline execution took 53084.76686477661 ms (excluding imports and monkey-patching)
2022-09-21 07:40:59 INFO  Starting execution of 1 what-if analyses...
2022-09-21 07:40:59 INFO  Start plan generation for analysis PermutationFeatureImportance...
2022-09-21 07:40:59 INFO  ---RUNTIME: Plan generation took 0.1697540283203125 ms
2022-09-21 07:40:59 INFO  Estimated runtime of original DAG is 45650.60043334961ms
2022-09-21 07:40:59 INFO  Performing Multi-Query Optimization
2022-09-21 07:40:59 INFO  Estimated unoptimized what-if runtime is 228253.00216674805ms
2022-09-21 07:40:59 INFO  Estimated optimised what-if runtime is 66892.9500579834ms
2022-09-21 07:40:59 INFO  Estimated optimisation runtime saving is 161360.05210876465ms
2022-09-21 07:40:59 INFO  ---RUNTIME: Multi-Query Optimization took 12.292146682739258 ms
2022-09-21 07:40:59 INFO  Executing generated plans
2022-09-21 07:41:49 INFO  ---RUNTIME: Execution took 50574.01442527771 ms
2022-09-21 07:41:49 INFO  Done!
2022-09-21 07:41:50 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-21 07:41:50 INFO  Running instrumented original pipeline...
2022-09-21 07:41:51 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-21 07:41:51 INFO  ---RUNTIME: Importing and monkey-patching took 9.892702102661133 ms
2022-09-21 07:42:48 INFO  ---RUNTIME: Original pipeline execution took 57826.446533203125 ms (excluding imports and monkey-patching)
2022-09-21 07:42:48 INFO  Starting execution of 1 what-if analyses...
2022-09-21 07:42:48 INFO  Start plan generation for analysis PermutationFeatureImportance...
2022-09-21 07:42:48 INFO  ---RUNTIME: Plan generation took 0.12969970703125 ms
2022-09-21 07:42:48 INFO  Estimated runtime of original DAG is 46286.612033843994ms
2022-09-21 07:42:48 WARNING Skipping Multi-Query Optimization (instead, only combine execution DAGs)
2022-09-21 07:42:48 INFO  Estimated unoptimised what-if runtime is 231433.06016921997ms
2022-09-21 07:42:48 INFO  ---RUNTIME: Multi-Query Optimization took 18.628358840942383 ms
2022-09-21 07:42:48 INFO  Executing generated plans
2022-09-21 07:46:25 INFO  ---RUNTIME: Execution took 217472.30577468872 ms
2022-09-21 07:46:26 INFO  Done!
2022-09-21 07:46:27 INFO  # Finished -- repetition 5 of 7 
2022-09-21 07:46:27 INFO  # Optimization benchmark for feature_importance with args [['reviews', 'slow_loading', 'featurization_3', 'neural_network']] -- repetition 6 of 7
2022-09-21 07:46:27 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-21 07:46:27 INFO  Running instrumented original pipeline...
2022-09-21 07:46:28 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-21 07:46:28 INFO  ---RUNTIME: Importing and monkey-patching took 5.9051513671875 ms
2022-09-21 07:47:23 INFO  ---RUNTIME: Original pipeline execution took 55676.90825462341 ms (excluding imports and monkey-patching)
2022-09-21 07:47:23 INFO  Starting execution of 1 what-if analyses...
2022-09-21 07:47:23 INFO  Start plan generation for analysis PermutationFeatureImportance...
2022-09-21 07:47:23 INFO  ---RUNTIME: Plan generation took 0.14925003051757812 ms
2022-09-21 07:47:23 INFO  Estimated runtime of original DAG is 42282.2151184082ms
2022-09-21 07:47:23 INFO  Performing Multi-Query Optimization
2022-09-21 07:47:23 INFO  Estimated unoptimized what-if runtime is 211411.07559204102ms
2022-09-21 07:47:23 INFO  Estimated optimised what-if runtime is 62840.654611587524ms
2022-09-21 07:47:23 INFO  Estimated optimisation runtime saving is 148570.4209804535ms
2022-09-21 07:47:23 INFO  ---RUNTIME: Multi-Query Optimization took 12.242317199707031 ms
2022-09-21 07:47:23 INFO  Executing generated plans
2022-09-21 07:48:10 INFO  ---RUNTIME: Execution took 46785.45308113098 ms
2022-09-21 07:48:10 INFO  Done!
2022-09-21 07:48:10 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-21 07:48:10 INFO  Running instrumented original pipeline...
2022-09-21 07:48:10 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-21 07:48:10 INFO  ---RUNTIME: Importing and monkey-patching took 7.331371307373047 ms
2022-09-21 07:48:58 INFO  ---RUNTIME: Original pipeline execution took 48739.77828025818 ms (excluding imports and monkey-patching)
2022-09-21 07:48:58 INFO  Starting execution of 1 what-if analyses...
2022-09-21 07:48:58 INFO  Start plan generation for analysis PermutationFeatureImportance...
2022-09-21 07:48:58 INFO  ---RUNTIME: Plan generation took 0.148773193359375 ms
2022-09-21 07:48:58 INFO  Estimated runtime of original DAG is 41002.670764923096ms
2022-09-21 07:48:58 WARNING Skipping Multi-Query Optimization (instead, only combine execution DAGs)
2022-09-21 07:48:58 INFO  Estimated unoptimised what-if runtime is 205013.35382461548ms
2022-09-21 07:48:58 INFO  ---RUNTIME: Multi-Query Optimization took 18.301010131835938 ms
2022-09-21 07:48:58 INFO  Executing generated plans
2022-09-21 07:52:40 INFO  ---RUNTIME: Execution took 221384.91797447205 ms
2022-09-21 07:52:40 INFO  Done!
2022-09-21 07:52:40 INFO  # Finished -- repetition 6 of 7 
2022-09-21 07:52:40 INFO  # Optimization benchmark for feature_importance with args [['reviews', 'slow_loading', 'featurization_3', 'neural_network']] -- repetition 7 of 7
2022-09-21 07:52:40 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-21 07:52:40 INFO  Running instrumented original pipeline...
2022-09-21 07:52:40 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-21 07:52:40 INFO  ---RUNTIME: Importing and monkey-patching took 6.951570510864258 ms
2022-09-21 07:53:31 INFO  ---RUNTIME: Original pipeline execution took 50653.94043922424 ms (excluding imports and monkey-patching)
2022-09-21 07:53:31 INFO  Starting execution of 1 what-if analyses...
2022-09-21 07:53:31 INFO  Start plan generation for analysis PermutationFeatureImportance...
2022-09-21 07:53:31 INFO  ---RUNTIME: Plan generation took 0.1513957977294922 ms
2022-09-21 07:53:31 INFO  Estimated runtime of original DAG is 41231.26173019409ms
2022-09-21 07:53:31 INFO  Performing Multi-Query Optimization
2022-09-21 07:53:31 INFO  Estimated unoptimized what-if runtime is 206156.30865097046ms
2022-09-21 07:53:31 INFO  Estimated optimised what-if runtime is 60467.64802932739ms
2022-09-21 07:53:31 INFO  Estimated optimisation runtime saving is 145688.66062164307ms
2022-09-21 07:53:31 INFO  ---RUNTIME: Multi-Query Optimization took 12.430667877197266 ms
2022-09-21 07:53:31 INFO  Executing generated plans
2022-09-21 07:54:18 INFO  ---RUNTIME: Execution took 46996.349811553955 ms
2022-09-21 07:54:18 INFO  Done!
2022-09-21 07:54:20 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-21 07:54:20 INFO  Running instrumented original pipeline...
2022-09-21 07:54:20 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-21 07:54:20 INFO  ---RUNTIME: Importing and monkey-patching took 5.840778350830078 ms
2022-09-21 07:55:13 INFO  ---RUNTIME: Original pipeline execution took 53760.65397262573 ms (excluding imports and monkey-patching)
2022-09-21 07:55:13 INFO  Starting execution of 1 what-if analyses...
2022-09-21 07:55:13 INFO  Start plan generation for analysis PermutationFeatureImportance...
2022-09-21 07:55:13 INFO  ---RUNTIME: Plan generation took 0.1499652862548828 ms
2022-09-21 07:55:13 INFO  Estimated runtime of original DAG is 41124.95017051697ms
2022-09-21 07:55:13 WARNING Skipping Multi-Query Optimization (instead, only combine execution DAGs)
2022-09-21 07:55:13 INFO  Estimated unoptimised what-if runtime is 205624.75085258484ms
2022-09-21 07:55:13 INFO  ---RUNTIME: Multi-Query Optimization took 18.405914306640625 ms
2022-09-21 07:55:13 INFO  Executing generated plans
2022-09-21 07:58:34 INFO  ---RUNTIME: Execution took 200696.44212722778 ms
2022-09-21 07:58:34 INFO  Done!
2022-09-21 07:58:34 INFO  # Finished -- repetition 7 of 7 
2022-09-21 07:58:34 INFO  # Final results after all repetitions
2022-09-21 07:58:34 INFO     repetition  ... no_opt_what_if_execution_combined_model_training
0           0  ...                                     35129.430294
1           1  ...                                     31487.917423
2           2  ...                                     31496.068478
3           3  ...                                     39907.532215
4           4  ...                                     32216.797829
5           5  ...                                     32357.757092
6           6  ...                                     32324.501991

[7 rows x 26 columns]
taskset -c 160-168 PROTOCOL_BUFFERS_PYTHON_IMPLEMENTATION=python python3.9 benchmarks_end_to_end.py feature_importance reviews slow_loading featurization_4 logistic_regression
2022-09-21 07:58:40.295725: W tensorflow/stream_executor/platform/default/dso_loader.cc:64] Could not load dynamic library 'libcudart.so.11.0'; dlerror: libcudart.so.11.0: cannot open shared object file: No such file or directory; LD_LIBRARY_PATH: /home/sgrafbe/mlwhatif/venv/lib/python3.9/site-packages/cv2/../../lib64:
2022-09-21 07:58:40.295772: I tensorflow/stream_executor/cuda/cudart_stub.cc:29] Ignore above cudart dlerror if you do not have a GPU set up on your machine.
2022-09-21 07:58:41 INFO  Patching sys.argv with ['mlwhatif', 'reviews', 'slow_loading', 'featurization_4', 'logistic_regression']
2022-09-21 07:58:41 INFO  Running instrumented original pipeline...
2022-09-21 07:58:41 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-21 07:58:41 INFO  ---RUNTIME: Importing and monkey-patching took 121.55556678771973 ms
2022-09-21 07:58:55 INFO  ---RUNTIME: Original pipeline execution took 13768.653869628906 ms (excluding imports and monkey-patching)
2022-09-21 07:58:55 INFO  Starting execution of 0 what-if analyses...
2022-09-21 07:58:55 INFO  Estimated runtime of original DAG is 10464.561223983765ms
2022-09-21 07:58:55 INFO  Performing Multi-Query Optimization
2022-09-21 07:58:55 INFO  Estimated unoptimized what-if runtime is 0ms
2022-09-21 07:58:55 INFO  Estimated optimised what-if runtime is 0ms
2022-09-21 07:58:55 INFO  Estimated optimisation runtime saving is 0ms
2022-09-21 07:58:55 INFO  ---RUNTIME: Multi-Query Optimization took 0.5385875701904297 ms
2022-09-21 07:58:55 INFO  Executing generated plans
2022-09-21 07:58:55 INFO  ---RUNTIME: Execution took 0.025987625122070312 ms
2022-09-21 07:58:55 INFO  Done!
2022-09-21 07:58:55 INFO  # Optimization benchmark for feature_importance with args [['reviews', 'slow_loading', 'featurization_4', 'logistic_regression']] -- repetition 1 of 7
2022-09-21 07:58:55 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-21 07:58:55 INFO  Running instrumented original pipeline...
2022-09-21 07:58:55 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-21 07:58:55 INFO  ---RUNTIME: Importing and monkey-patching took 5.544424057006836 ms
2022-09-21 07:59:08 INFO  ---RUNTIME: Original pipeline execution took 13102.627754211426 ms (excluding imports and monkey-patching)
2022-09-21 07:59:08 INFO  Starting execution of 1 what-if analyses...
2022-09-21 07:59:08 INFO  Start plan generation for analysis PermutationFeatureImportance...
2022-09-21 07:59:08 INFO  ---RUNTIME: Plan generation took 0.21338462829589844 ms
2022-09-21 07:59:08 INFO  Estimated runtime of original DAG is 9820.353269577026ms
2022-09-21 07:59:08 INFO  Performing Multi-Query Optimization
2022-09-21 07:59:08 INFO  Estimated unoptimized what-if runtime is 49101.76634788513ms
2022-09-21 07:59:08 INFO  Estimated optimised what-if runtime is 10021.159887313843ms
2022-09-21 07:59:08 INFO  Estimated optimisation runtime saving is 39080.60646057129ms
2022-09-21 07:59:08 INFO  ---RUNTIME: Multi-Query Optimization took 10.9405517578125 ms
2022-09-21 07:59:08 INFO  Executing generated plans
2022-09-21 07:59:19 INFO  ---RUNTIME: Execution took 10940.207958221436 ms
2022-09-21 07:59:19 INFO  Done!
2022-09-21 07:59:19 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-21 07:59:19 INFO  Running instrumented original pipeline...
2022-09-21 07:59:19 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-21 07:59:19 INFO  ---RUNTIME: Importing and monkey-patching took 6.114482879638672 ms
2022-09-21 07:59:32 INFO  ---RUNTIME: Original pipeline execution took 13071.571588516235 ms (excluding imports and monkey-patching)
2022-09-21 07:59:32 INFO  Starting execution of 1 what-if analyses...
2022-09-21 07:59:32 INFO  Start plan generation for analysis PermutationFeatureImportance...
2022-09-21 07:59:32 INFO  ---RUNTIME: Plan generation took 0.16617774963378906 ms
2022-09-21 07:59:32 INFO  Estimated runtime of original DAG is 9588.164329528809ms
2022-09-21 07:59:32 WARNING Skipping Multi-Query Optimization (instead, only combine execution DAGs)
2022-09-21 07:59:32 INFO  Estimated unoptimised what-if runtime is 47940.82164764404ms
2022-09-21 07:59:32 INFO  ---RUNTIME: Multi-Query Optimization took 15.82956314086914 ms
2022-09-21 07:59:32 INFO  Executing generated plans
2022-09-21 08:00:25 INFO  ---RUNTIME: Execution took 52998.0902671814 ms
2022-09-21 08:00:25 INFO  Done!
2022-09-21 08:00:25 INFO  # Finished -- repetition 1 of 7 
2022-09-21 08:00:25 INFO  # Optimization benchmark for feature_importance with args [['reviews', 'slow_loading', 'featurization_4', 'logistic_regression']] -- repetition 2 of 7
2022-09-21 08:00:25 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-21 08:00:25 INFO  Running instrumented original pipeline...
2022-09-21 08:00:25 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-21 08:00:25 INFO  ---RUNTIME: Importing and monkey-patching took 5.900859832763672 ms
2022-09-21 08:00:38 INFO  ---RUNTIME: Original pipeline execution took 12926.869869232178 ms (excluding imports and monkey-patching)
2022-09-21 08:00:38 INFO  Starting execution of 1 what-if analyses...
2022-09-21 08:00:38 INFO  Start plan generation for analysis PermutationFeatureImportance...
2022-09-21 08:00:38 INFO  ---RUNTIME: Plan generation took 0.12803077697753906 ms
2022-09-21 08:00:38 INFO  Estimated runtime of original DAG is 9633.805513381958ms
2022-09-21 08:00:38 INFO  Performing Multi-Query Optimization
2022-09-21 08:00:38 INFO  Estimated unoptimized what-if runtime is 48169.02756690979ms
2022-09-21 08:00:38 INFO  Estimated optimised what-if runtime is 9829.290866851807ms
2022-09-21 08:00:38 INFO  Estimated optimisation runtime saving is 38339.73670005798ms
2022-09-21 08:00:38 INFO  ---RUNTIME: Multi-Query Optimization took 10.888814926147461 ms
2022-09-21 08:00:38 INFO  Executing generated plans
2022-09-21 08:00:49 INFO  ---RUNTIME: Execution took 10782.170295715332 ms
2022-09-21 08:00:49 INFO  Done!
2022-09-21 08:00:49 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-21 08:00:49 INFO  Running instrumented original pipeline...
2022-09-21 08:00:49 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-21 08:00:49 INFO  ---RUNTIME: Importing and monkey-patching took 5.891561508178711 ms
2022-09-21 08:01:02 INFO  ---RUNTIME: Original pipeline execution took 13090.402126312256 ms (excluding imports and monkey-patching)
2022-09-21 08:01:02 INFO  Starting execution of 1 what-if analyses...
2022-09-21 08:01:02 INFO  Start plan generation for analysis PermutationFeatureImportance...
2022-09-21 08:01:02 INFO  ---RUNTIME: Plan generation took 0.12469291687011719 ms
2022-09-21 08:01:02 INFO  Estimated runtime of original DAG is 9780.900716781616ms
2022-09-21 08:01:02 WARNING Skipping Multi-Query Optimization (instead, only combine execution DAGs)
2022-09-21 08:01:02 INFO  Estimated unoptimised what-if runtime is 48904.50358390808ms
2022-09-21 08:01:02 INFO  ---RUNTIME: Multi-Query Optimization took 16.163110733032227 ms
2022-09-21 08:01:02 INFO  Executing generated plans
2022-09-21 08:01:55 INFO  ---RUNTIME: Execution took 52901.93486213684 ms
2022-09-21 08:01:55 INFO  Done!
2022-09-21 08:01:55 INFO  # Finished -- repetition 2 of 7 
2022-09-21 08:01:55 INFO  # Optimization benchmark for feature_importance with args [['reviews', 'slow_loading', 'featurization_4', 'logistic_regression']] -- repetition 3 of 7
2022-09-21 08:01:55 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-21 08:01:55 INFO  Running instrumented original pipeline...
2022-09-21 08:01:55 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-21 08:01:55 INFO  ---RUNTIME: Importing and monkey-patching took 5.895137786865234 ms
2022-09-21 08:02:08 INFO  ---RUNTIME: Original pipeline execution took 13158.62774848938 ms (excluding imports and monkey-patching)
2022-09-21 08:02:08 INFO  Starting execution of 1 what-if analyses...
2022-09-21 08:02:08 INFO  Start plan generation for analysis PermutationFeatureImportance...
2022-09-21 08:02:08 INFO  ---RUNTIME: Plan generation took 0.1308917999267578 ms
2022-09-21 08:02:08 INFO  Estimated runtime of original DAG is 9592.058897018433ms
2022-09-21 08:02:08 INFO  Performing Multi-Query Optimization
2022-09-21 08:02:08 INFO  Estimated unoptimized what-if runtime is 47960.29448509216ms
2022-09-21 08:02:08 INFO  Estimated optimised what-if runtime is 9797.5013256073ms
2022-09-21 08:02:08 INFO  Estimated optimisation runtime saving is 38162.79315948486ms
2022-09-21 08:02:08 INFO  ---RUNTIME: Multi-Query Optimization took 11.048316955566406 ms
2022-09-21 08:02:08 INFO  Executing generated plans
2022-09-21 08:02:19 INFO  ---RUNTIME: Execution took 10851.012229919434 ms
2022-09-21 08:02:19 INFO  Done!
2022-09-21 08:02:19 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-21 08:02:19 INFO  Running instrumented original pipeline...
2022-09-21 08:02:19 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-21 08:02:19 INFO  ---RUNTIME: Importing and monkey-patching took 5.9528350830078125 ms
2022-09-21 08:02:32 INFO  ---RUNTIME: Original pipeline execution took 13149.111270904541 ms (excluding imports and monkey-patching)
2022-09-21 08:02:32 INFO  Starting execution of 1 what-if analyses...
2022-09-21 08:02:32 INFO  Start plan generation for analysis PermutationFeatureImportance...
2022-09-21 08:02:32 INFO  ---RUNTIME: Plan generation took 0.10752677917480469 ms
2022-09-21 08:02:32 INFO  Estimated runtime of original DAG is 9599.751949310303ms
2022-09-21 08:02:32 WARNING Skipping Multi-Query Optimization (instead, only combine execution DAGs)
2022-09-21 08:02:32 INFO  Estimated unoptimised what-if runtime is 47998.759746551514ms
2022-09-21 08:02:32 INFO  ---RUNTIME: Multi-Query Optimization took 16.10732078552246 ms
2022-09-21 08:02:32 INFO  Executing generated plans
2022-09-21 08:03:25 INFO  ---RUNTIME: Execution took 53011.279344558716 ms
2022-09-21 08:03:25 INFO  Done!
2022-09-21 08:03:25 INFO  # Finished -- repetition 3 of 7 
2022-09-21 08:03:25 INFO  # Optimization benchmark for feature_importance with args [['reviews', 'slow_loading', 'featurization_4', 'logistic_regression']] -- repetition 4 of 7
2022-09-21 08:03:25 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-21 08:03:25 INFO  Running instrumented original pipeline...
2022-09-21 08:03:25 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-21 08:03:25 INFO  ---RUNTIME: Importing and monkey-patching took 6.061792373657227 ms
2022-09-21 08:03:38 INFO  ---RUNTIME: Original pipeline execution took 13019.729614257812 ms (excluding imports and monkey-patching)
2022-09-21 08:03:38 INFO  Starting execution of 1 what-if analyses...
2022-09-21 08:03:38 INFO  Start plan generation for analysis PermutationFeatureImportance...
2022-09-21 08:03:38 INFO  ---RUNTIME: Plan generation took 0.11229515075683594 ms
2022-09-21 08:03:38 INFO  Estimated runtime of original DAG is 9692.503929138184ms
2022-09-21 08:03:38 INFO  Performing Multi-Query Optimization
2022-09-21 08:03:38 INFO  Estimated unoptimized what-if runtime is 48462.51964569092ms
2022-09-21 08:03:38 INFO  Estimated optimised what-if runtime is 9906.7862033844ms
2022-09-21 08:03:38 INFO  Estimated optimisation runtime saving is 38555.73344230652ms
2022-09-21 08:03:38 INFO  ---RUNTIME: Multi-Query Optimization took 10.924339294433594 ms
2022-09-21 08:03:38 INFO  Executing generated plans
2022-09-21 08:03:49 INFO  ---RUNTIME: Execution took 11076.757192611694 ms
2022-09-21 08:03:49 INFO  Done!
2022-09-21 08:03:49 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-21 08:03:49 INFO  Running instrumented original pipeline...
2022-09-21 08:03:49 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-21 08:03:49 INFO  ---RUNTIME: Importing and monkey-patching took 5.917072296142578 ms
2022-09-21 08:04:03 INFO  ---RUNTIME: Original pipeline execution took 13738.14344406128 ms (excluding imports and monkey-patching)
2022-09-21 08:04:03 INFO  Starting execution of 1 what-if analyses...
2022-09-21 08:04:03 INFO  Start plan generation for analysis PermutationFeatureImportance...
2022-09-21 08:04:03 INFO  ---RUNTIME: Plan generation took 0.11348724365234375 ms
2022-09-21 08:04:03 INFO  Estimated runtime of original DAG is 10399.688959121704ms
2022-09-21 08:04:03 WARNING Skipping Multi-Query Optimization (instead, only combine execution DAGs)
2022-09-21 08:04:03 INFO  Estimated unoptimised what-if runtime is 51998.44479560852ms
2022-09-21 08:04:03 INFO  ---RUNTIME: Multi-Query Optimization took 15.969038009643555 ms
2022-09-21 08:04:03 INFO  Executing generated plans
2022-09-21 08:04:56 INFO  ---RUNTIME: Execution took 53018.19920539856 ms
2022-09-21 08:04:56 INFO  Done!
2022-09-21 08:04:56 INFO  # Finished -- repetition 4 of 7 
2022-09-21 08:04:56 INFO  # Optimization benchmark for feature_importance with args [['reviews', 'slow_loading', 'featurization_4', 'logistic_regression']] -- repetition 5 of 7
2022-09-21 08:04:56 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-21 08:04:56 INFO  Running instrumented original pipeline...
2022-09-21 08:04:56 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-21 08:04:56 INFO  ---RUNTIME: Importing and monkey-patching took 10.884761810302734 ms
2022-09-21 08:05:09 INFO  ---RUNTIME: Original pipeline execution took 13403.727769851685 ms (excluding imports and monkey-patching)
2022-09-21 08:05:09 INFO  Starting execution of 1 what-if analyses...
2022-09-21 08:05:09 INFO  Start plan generation for analysis PermutationFeatureImportance...
2022-09-21 08:05:09 INFO  ---RUNTIME: Plan generation took 0.12159347534179688 ms
2022-09-21 08:05:09 INFO  Estimated runtime of original DAG is 9778.972625732422ms
2022-09-21 08:05:09 INFO  Performing Multi-Query Optimization
2022-09-21 08:05:09 INFO  Estimated unoptimized what-if runtime is 48894.86312866211ms
2022-09-21 08:05:09 INFO  Estimated optimised what-if runtime is 10001.1568069458ms
2022-09-21 08:05:09 INFO  Estimated optimisation runtime saving is 38893.70632171631ms
2022-09-21 08:05:09 INFO  ---RUNTIME: Multi-Query Optimization took 10.88094711303711 ms
2022-09-21 08:05:09 INFO  Executing generated plans
2022-09-21 08:05:20 INFO  ---RUNTIME: Execution took 10753.522396087646 ms
2022-09-21 08:05:20 INFO  Done!
2022-09-21 08:05:20 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-21 08:05:20 INFO  Running instrumented original pipeline...
2022-09-21 08:05:20 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-21 08:05:20 INFO  ---RUNTIME: Importing and monkey-patching took 5.906820297241211 ms
2022-09-21 08:05:33 INFO  ---RUNTIME: Original pipeline execution took 13238.23618888855 ms (excluding imports and monkey-patching)
2022-09-21 08:05:33 INFO  Starting execution of 1 what-if analyses...
2022-09-21 08:05:33 INFO  Start plan generation for analysis PermutationFeatureImportance...
2022-09-21 08:05:33 INFO  ---RUNTIME: Plan generation took 0.11992454528808594 ms
2022-09-21 08:05:33 INFO  Estimated runtime of original DAG is 9632.34567642212ms
2022-09-21 08:05:33 WARNING Skipping Multi-Query Optimization (instead, only combine execution DAGs)
2022-09-21 08:05:33 INFO  Estimated unoptimised what-if runtime is 48161.728382110596ms
2022-09-21 08:05:33 INFO  ---RUNTIME: Multi-Query Optimization took 16.340255737304688 ms
2022-09-21 08:05:33 INFO  Executing generated plans
2022-09-21 08:06:27 INFO  ---RUNTIME: Execution took 53042.54698753357 ms
2022-09-21 08:06:27 INFO  Done!
2022-09-21 08:06:27 INFO  # Finished -- repetition 5 of 7 
2022-09-21 08:06:27 INFO  # Optimization benchmark for feature_importance with args [['reviews', 'slow_loading', 'featurization_4', 'logistic_regression']] -- repetition 6 of 7
2022-09-21 08:06:27 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-21 08:06:27 INFO  Running instrumented original pipeline...
2022-09-21 08:06:27 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-21 08:06:27 INFO  ---RUNTIME: Importing and monkey-patching took 5.994558334350586 ms
2022-09-21 08:06:40 INFO  ---RUNTIME: Original pipeline execution took 12958.157062530518 ms (excluding imports and monkey-patching)
2022-09-21 08:06:40 INFO  Starting execution of 1 what-if analyses...
2022-09-21 08:06:40 INFO  Start plan generation for analysis PermutationFeatureImportance...
2022-09-21 08:06:40 INFO  ---RUNTIME: Plan generation took 0.10228157043457031 ms
2022-09-21 08:06:40 INFO  Estimated runtime of original DAG is 9621.772527694702ms
2022-09-21 08:06:40 INFO  Performing Multi-Query Optimization
2022-09-21 08:06:40 INFO  Estimated unoptimized what-if runtime is 48108.86263847351ms
2022-09-21 08:06:40 INFO  Estimated optimised what-if runtime is 9844.62022781372ms
2022-09-21 08:06:40 INFO  Estimated optimisation runtime saving is 38264.24241065979ms
2022-09-21 08:06:40 INFO  ---RUNTIME: Multi-Query Optimization took 10.863304138183594 ms
2022-09-21 08:06:40 INFO  Executing generated plans
2022-09-21 08:06:50 INFO  ---RUNTIME: Execution took 10781.482696533203 ms
2022-09-21 08:06:50 INFO  Done!
2022-09-21 08:06:50 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-21 08:06:50 INFO  Running instrumented original pipeline...
2022-09-21 08:06:50 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-21 08:06:50 INFO  ---RUNTIME: Importing and monkey-patching took 5.847692489624023 ms
2022-09-21 08:07:04 INFO  ---RUNTIME: Original pipeline execution took 13284.639120101929 ms (excluding imports and monkey-patching)
2022-09-21 08:07:04 INFO  Starting execution of 1 what-if analyses...
2022-09-21 08:07:04 INFO  Start plan generation for analysis PermutationFeatureImportance...
2022-09-21 08:07:04 INFO  ---RUNTIME: Plan generation took 0.10013580322265625 ms
2022-09-21 08:07:04 INFO  Estimated runtime of original DAG is 9628.793478012085ms
2022-09-21 08:07:04 WARNING Skipping Multi-Query Optimization (instead, only combine execution DAGs)
2022-09-21 08:07:04 INFO  Estimated unoptimised what-if runtime is 48143.967390060425ms
2022-09-21 08:07:04 INFO  ---RUNTIME: Multi-Query Optimization took 15.761613845825195 ms
2022-09-21 08:07:04 INFO  Executing generated plans
2022-09-21 08:07:56 INFO  ---RUNTIME: Execution took 52807.912826538086 ms
2022-09-21 08:07:56 INFO  Done!
2022-09-21 08:07:56 INFO  # Finished -- repetition 6 of 7 
2022-09-21 08:07:56 INFO  # Optimization benchmark for feature_importance with args [['reviews', 'slow_loading', 'featurization_4', 'logistic_regression']] -- repetition 7 of 7
2022-09-21 08:07:56 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-21 08:07:56 INFO  Running instrumented original pipeline...
2022-09-21 08:07:56 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-21 08:07:56 INFO  ---RUNTIME: Importing and monkey-patching took 6.489276885986328 ms
2022-09-21 08:08:09 INFO  ---RUNTIME: Original pipeline execution took 12986.427545547485 ms (excluding imports and monkey-patching)
2022-09-21 08:08:09 INFO  Starting execution of 1 what-if analyses...
2022-09-21 08:08:09 INFO  Start plan generation for analysis PermutationFeatureImportance...
2022-09-21 08:08:09 INFO  ---RUNTIME: Plan generation took 0.1277923583984375 ms
2022-09-21 08:08:09 INFO  Estimated runtime of original DAG is 9640.995025634766ms
2022-09-21 08:08:09 INFO  Performing Multi-Query Optimization
2022-09-21 08:08:09 INFO  Estimated unoptimized what-if runtime is 48204.97512817383ms
2022-09-21 08:08:09 INFO  Estimated optimised what-if runtime is 9865.177154541016ms
2022-09-21 08:08:09 INFO  Estimated optimisation runtime saving is 38339.79797363281ms
2022-09-21 08:08:09 INFO  ---RUNTIME: Multi-Query Optimization took 10.92529296875 ms
2022-09-21 08:08:09 INFO  Executing generated plans
2022-09-21 08:08:20 INFO  ---RUNTIME: Execution took 10807.5692653656 ms
2022-09-21 08:08:20 INFO  Done!
2022-09-21 08:08:20 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-21 08:08:20 INFO  Running instrumented original pipeline...
2022-09-21 08:08:21 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-21 08:08:21 INFO  ---RUNTIME: Importing and monkey-patching took 5.875587463378906 ms
2022-09-21 08:08:33 INFO  ---RUNTIME: Original pipeline execution took 13212.869644165039 ms (excluding imports and monkey-patching)
2022-09-21 08:08:33 INFO  Starting execution of 1 what-if analyses...
2022-09-21 08:08:33 INFO  Start plan generation for analysis PermutationFeatureImportance...
2022-09-21 08:08:33 INFO  ---RUNTIME: Plan generation took 0.10228157043457031 ms
2022-09-21 08:08:33 INFO  Estimated runtime of original DAG is 9583.000659942627ms
2022-09-21 08:08:33 WARNING Skipping Multi-Query Optimization (instead, only combine execution DAGs)
2022-09-21 08:08:33 INFO  Estimated unoptimised what-if runtime is 47915.003299713135ms
2022-09-21 08:08:33 INFO  ---RUNTIME: Multi-Query Optimization took 15.910625457763672 ms
2022-09-21 08:08:33 INFO  Executing generated plans
2022-09-21 08:09:26 INFO  ---RUNTIME: Execution took 52952.31819152832 ms
2022-09-21 08:09:26 INFO  Done!
2022-09-21 08:09:26 INFO  # Finished -- repetition 7 of 7 
2022-09-21 08:09:26 INFO  # Final results after all repetitions
2022-09-21 08:09:26 INFO     repetition  ... no_opt_what_if_execution_combined_model_training
0           0  ...                                       896.509171
1           1  ...                                       897.865534
2           2  ...                                       897.006512
3           3  ...                                       899.811506
4           4  ...                                       923.540115
5           5  ...                                       898.325443
6           6  ...                                       897.550106

[7 rows x 26 columns]
taskset -c 160-168 PROTOCOL_BUFFERS_PYTHON_IMPLEMENTATION=python python3.9 benchmarks_end_to_end.py feature_importance reviews slow_loading featurization_4 xgboost
2022-09-21 08:09:29.234474: W tensorflow/stream_executor/platform/default/dso_loader.cc:64] Could not load dynamic library 'libcudart.so.11.0'; dlerror: libcudart.so.11.0: cannot open shared object file: No such file or directory; LD_LIBRARY_PATH: /home/sgrafbe/mlwhatif/venv/lib/python3.9/site-packages/cv2/../../lib64:
2022-09-21 08:09:29.234521: I tensorflow/stream_executor/cuda/cudart_stub.cc:29] Ignore above cudart dlerror if you do not have a GPU set up on your machine.
2022-09-21 08:09:30 INFO  Patching sys.argv with ['mlwhatif', 'reviews', 'slow_loading', 'featurization_4', 'xgboost']
2022-09-21 08:09:30 INFO  Running instrumented original pipeline...
2022-09-21 08:09:30 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-21 08:09:30 INFO  ---RUNTIME: Importing and monkey-patching took 121.6888427734375 ms
2022-09-21 08:09:47 INFO  ---RUNTIME: Original pipeline execution took 17008.51559638977 ms (excluding imports and monkey-patching)
2022-09-21 08:09:47 INFO  Starting execution of 0 what-if analyses...
2022-09-21 08:09:47 INFO  Estimated runtime of original DAG is 13729.390621185303ms
2022-09-21 08:09:47 INFO  Performing Multi-Query Optimization
2022-09-21 08:09:47 INFO  Estimated unoptimized what-if runtime is 0ms
2022-09-21 08:09:47 INFO  Estimated optimised what-if runtime is 0ms
2022-09-21 08:09:47 INFO  Estimated optimisation runtime saving is 0ms
2022-09-21 08:09:47 INFO  ---RUNTIME: Multi-Query Optimization took 0.54168701171875 ms
2022-09-21 08:09:47 INFO  Executing generated plans
2022-09-21 08:09:47 INFO  ---RUNTIME: Execution took 0.025987625122070312 ms
2022-09-21 08:09:47 INFO  Done!
2022-09-21 08:09:47 INFO  # Optimization benchmark for feature_importance with args [['reviews', 'slow_loading', 'featurization_4', 'xgboost']] -- repetition 1 of 7
2022-09-21 08:09:47 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-21 08:09:47 INFO  Running instrumented original pipeline...
2022-09-21 08:09:47 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-21 08:09:47 INFO  ---RUNTIME: Importing and monkey-patching took 5.3863525390625 ms
2022-09-21 08:10:03 INFO  ---RUNTIME: Original pipeline execution took 16213.083744049072 ms (excluding imports and monkey-patching)
2022-09-21 08:10:03 INFO  Starting execution of 1 what-if analyses...
2022-09-21 08:10:03 INFO  Start plan generation for analysis PermutationFeatureImportance...
2022-09-21 08:10:03 INFO  ---RUNTIME: Plan generation took 0.2105236053466797 ms
2022-09-21 08:10:03 INFO  Estimated runtime of original DAG is 12781.933069229126ms
2022-09-21 08:10:03 INFO  Performing Multi-Query Optimization
2022-09-21 08:10:03 INFO  Estimated unoptimized what-if runtime is 63909.66534614563ms
2022-09-21 08:10:03 INFO  Estimated optimised what-if runtime is 13165.746212005615ms
2022-09-21 08:10:03 INFO  Estimated optimisation runtime saving is 50743.919134140015ms
2022-09-21 08:10:03 INFO  ---RUNTIME: Multi-Query Optimization took 10.909557342529297 ms
2022-09-21 08:10:03 INFO  Executing generated plans
2022-09-21 08:10:18 INFO  ---RUNTIME: Execution took 14281.40926361084 ms
2022-09-21 08:10:18 INFO  Done!
2022-09-21 08:10:18 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-21 08:10:18 INFO  Running instrumented original pipeline...
2022-09-21 08:10:18 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-21 08:10:18 INFO  ---RUNTIME: Importing and monkey-patching took 6.299018859863281 ms
2022-09-21 08:10:34 INFO  ---RUNTIME: Original pipeline execution took 16244.521141052246 ms (excluding imports and monkey-patching)
2022-09-21 08:10:34 INFO  Starting execution of 1 what-if analyses...
2022-09-21 08:10:34 INFO  Start plan generation for analysis PermutationFeatureImportance...
2022-09-21 08:10:34 INFO  ---RUNTIME: Plan generation took 0.1010894775390625 ms
2022-09-21 08:10:34 INFO  Estimated runtime of original DAG is 12778.089046478271ms
2022-09-21 08:10:34 WARNING Skipping Multi-Query Optimization (instead, only combine execution DAGs)
2022-09-21 08:10:34 INFO  Estimated unoptimised what-if runtime is 63890.44523239136ms
2022-09-21 08:10:34 INFO  ---RUNTIME: Multi-Query Optimization took 15.820026397705078 ms
2022-09-21 08:10:34 INFO  Executing generated plans
2022-09-21 08:11:43 INFO  ---RUNTIME: Execution took 68907.94777870178 ms
2022-09-21 08:11:43 INFO  Done!
2022-09-21 08:11:43 INFO  # Finished -- repetition 1 of 7 
2022-09-21 08:11:43 INFO  # Optimization benchmark for feature_importance with args [['reviews', 'slow_loading', 'featurization_4', 'xgboost']] -- repetition 2 of 7
2022-09-21 08:11:43 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-21 08:11:43 INFO  Running instrumented original pipeline...
2022-09-21 08:11:43 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-21 08:11:43 INFO  ---RUNTIME: Importing and monkey-patching took 6.309986114501953 ms
2022-09-21 08:11:59 INFO  ---RUNTIME: Original pipeline execution took 16092.897891998291 ms (excluding imports and monkey-patching)
2022-09-21 08:11:59 INFO  Starting execution of 1 what-if analyses...
2022-09-21 08:11:59 INFO  Start plan generation for analysis PermutationFeatureImportance...
2022-09-21 08:11:59 INFO  ---RUNTIME: Plan generation took 0.12183189392089844 ms
2022-09-21 08:11:59 INFO  Estimated runtime of original DAG is 12762.112379074097ms
2022-09-21 08:11:59 INFO  Performing Multi-Query Optimization
2022-09-21 08:11:59 INFO  Estimated unoptimized what-if runtime is 63810.56189537048ms
2022-09-21 08:11:59 INFO  Estimated optimised what-if runtime is 13171.658754348755ms
2022-09-21 08:11:59 INFO  Estimated optimisation runtime saving is 50638.90314102173ms
2022-09-21 08:11:59 INFO  ---RUNTIME: Multi-Query Optimization took 10.929107666015625 ms
2022-09-21 08:11:59 INFO  Executing generated plans
2022-09-21 08:12:13 INFO  ---RUNTIME: Execution took 14131.465673446655 ms
2022-09-21 08:12:13 INFO  Done!
2022-09-21 08:12:13 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-21 08:12:13 INFO  Running instrumented original pipeline...
2022-09-21 08:12:13 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-21 08:12:13 INFO  ---RUNTIME: Importing and monkey-patching took 6.054401397705078 ms
2022-09-21 08:12:29 INFO  ---RUNTIME: Original pipeline execution took 16281.85772895813 ms (excluding imports and monkey-patching)
2022-09-21 08:12:29 INFO  Starting execution of 1 what-if analyses...
2022-09-21 08:12:29 INFO  Start plan generation for analysis PermutationFeatureImportance...
2022-09-21 08:12:29 INFO  ---RUNTIME: Plan generation took 0.1087188720703125 ms
2022-09-21 08:12:29 INFO  Estimated runtime of original DAG is 13023.356199264526ms
2022-09-21 08:12:29 WARNING Skipping Multi-Query Optimization (instead, only combine execution DAGs)
2022-09-21 08:12:29 INFO  Estimated unoptimised what-if runtime is 65116.78099632263ms
2022-09-21 08:12:29 INFO  ---RUNTIME: Multi-Query Optimization took 15.990972518920898 ms
2022-09-21 08:12:29 INFO  Executing generated plans
2022-09-21 08:13:38 INFO  ---RUNTIME: Execution took 69057.34014511108 ms
2022-09-21 08:13:38 INFO  Done!
2022-09-21 08:13:38 INFO  # Finished -- repetition 2 of 7 
2022-09-21 08:13:38 INFO  # Optimization benchmark for feature_importance with args [['reviews', 'slow_loading', 'featurization_4', 'xgboost']] -- repetition 3 of 7
2022-09-21 08:13:38 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-21 08:13:38 INFO  Running instrumented original pipeline...
2022-09-21 08:13:39 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-21 08:13:39 INFO  ---RUNTIME: Importing and monkey-patching took 6.216764450073242 ms
2022-09-21 08:13:55 INFO  ---RUNTIME: Original pipeline execution took 16423.62880706787 ms (excluding imports and monkey-patching)
2022-09-21 08:13:55 INFO  Starting execution of 1 what-if analyses...
2022-09-21 08:13:55 INFO  Start plan generation for analysis PermutationFeatureImportance...
2022-09-21 08:13:55 INFO  ---RUNTIME: Plan generation took 0.1010894775390625 ms
2022-09-21 08:13:55 INFO  Estimated runtime of original DAG is 12861.059188842773ms
2022-09-21 08:13:55 INFO  Performing Multi-Query Optimization
2022-09-21 08:13:55 INFO  Estimated unoptimized what-if runtime is 64305.29594421387ms
2022-09-21 08:13:55 INFO  Estimated optimised what-if runtime is 13260.973930358887ms
2022-09-21 08:13:55 INFO  Estimated optimisation runtime saving is 51044.32201385498ms
2022-09-21 08:13:55 INFO  ---RUNTIME: Multi-Query Optimization took 11.304140090942383 ms
2022-09-21 08:13:55 INFO  Executing generated plans
2022-09-21 08:14:09 INFO  ---RUNTIME: Execution took 14196.157932281494 ms
2022-09-21 08:14:09 INFO  Done!
2022-09-21 08:14:09 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-21 08:14:09 INFO  Running instrumented original pipeline...
2022-09-21 08:14:09 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-21 08:14:09 INFO  ---RUNTIME: Importing and monkey-patching took 6.079912185668945 ms
2022-09-21 08:14:26 INFO  ---RUNTIME: Original pipeline execution took 16473.649263381958 ms (excluding imports and monkey-patching)
2022-09-21 08:14:26 INFO  Starting execution of 1 what-if analyses...
2022-09-21 08:14:26 INFO  Start plan generation for analysis PermutationFeatureImportance...
2022-09-21 08:14:26 INFO  ---RUNTIME: Plan generation took 0.10132789611816406 ms
2022-09-21 08:14:26 INFO  Estimated runtime of original DAG is 12899.240493774414ms
2022-09-21 08:14:26 WARNING Skipping Multi-Query Optimization (instead, only combine execution DAGs)
2022-09-21 08:14:26 INFO  Estimated unoptimised what-if runtime is 64496.20246887207ms
2022-09-21 08:14:26 INFO  ---RUNTIME: Multi-Query Optimization took 15.92874526977539 ms
2022-09-21 08:14:26 INFO  Executing generated plans
2022-09-21 08:15:35 INFO  ---RUNTIME: Execution took 69585.11567115784 ms
2022-09-21 08:15:35 INFO  Done!
2022-09-21 08:15:35 INFO  # Finished -- repetition 3 of 7 
2022-09-21 08:15:35 INFO  # Optimization benchmark for feature_importance with args [['reviews', 'slow_loading', 'featurization_4', 'xgboost']] -- repetition 4 of 7
2022-09-21 08:15:35 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-21 08:15:35 INFO  Running instrumented original pipeline...
2022-09-21 08:15:35 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-21 08:15:35 INFO  ---RUNTIME: Importing and monkey-patching took 6.071329116821289 ms
2022-09-21 08:15:51 INFO  ---RUNTIME: Original pipeline execution took 16101.362228393555 ms (excluding imports and monkey-patching)
2022-09-21 08:15:51 INFO  Starting execution of 1 what-if analyses...
2022-09-21 08:15:51 INFO  Start plan generation for analysis PermutationFeatureImportance...
2022-09-21 08:15:51 INFO  ---RUNTIME: Plan generation took 0.13136863708496094 ms
2022-09-21 08:15:51 INFO  Estimated runtime of original DAG is 12811.988592147827ms
2022-09-21 08:15:51 INFO  Performing Multi-Query Optimization
2022-09-21 08:15:51 INFO  Estimated unoptimized what-if runtime is 64059.942960739136ms
2022-09-21 08:15:51 INFO  Estimated optimised what-if runtime is 13194.509744644165ms
2022-09-21 08:15:51 INFO  Estimated optimisation runtime saving is 50865.43321609497ms
2022-09-21 08:15:51 INFO  ---RUNTIME: Multi-Query Optimization took 10.89620590209961 ms
2022-09-21 08:15:51 INFO  Executing generated plans
2022-09-21 08:16:06 INFO  ---RUNTIME: Execution took 14396.267414093018 ms
2022-09-21 08:16:06 INFO  Done!
2022-09-21 08:16:06 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-21 08:16:06 INFO  Running instrumented original pipeline...
2022-09-21 08:16:06 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-21 08:16:06 INFO  ---RUNTIME: Importing and monkey-patching took 5.927801132202148 ms
2022-09-21 08:16:22 INFO  ---RUNTIME: Original pipeline execution took 16135.778903961182 ms (excluding imports and monkey-patching)
2022-09-21 08:16:22 INFO  Starting execution of 1 what-if analyses...
2022-09-21 08:16:22 INFO  Start plan generation for analysis PermutationFeatureImportance...
2022-09-21 08:16:22 INFO  ---RUNTIME: Plan generation took 0.09965896606445312 ms
2022-09-21 08:16:22 INFO  Estimated runtime of original DAG is 12841.000318527222ms
2022-09-21 08:16:22 WARNING Skipping Multi-Query Optimization (instead, only combine execution DAGs)
2022-09-21 08:16:22 INFO  Estimated unoptimised what-if runtime is 64205.00159263611ms
2022-09-21 08:16:22 INFO  ---RUNTIME: Multi-Query Optimization took 15.750885009765625 ms
2022-09-21 08:16:22 INFO  Executing generated plans
2022-09-21 08:17:31 INFO  ---RUNTIME: Execution took 68840.17848968506 ms
2022-09-21 08:17:31 INFO  Done!
2022-09-21 08:17:31 INFO  # Finished -- repetition 4 of 7 
2022-09-21 08:17:31 INFO  # Optimization benchmark for feature_importance with args [['reviews', 'slow_loading', 'featurization_4', 'xgboost']] -- repetition 5 of 7
2022-09-21 08:17:31 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-21 08:17:31 INFO  Running instrumented original pipeline...
2022-09-21 08:17:31 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-21 08:17:31 INFO  ---RUNTIME: Importing and monkey-patching took 6.086111068725586 ms
2022-09-21 08:17:47 INFO  ---RUNTIME: Original pipeline execution took 16729.694843292236 ms (excluding imports and monkey-patching)
2022-09-21 08:17:47 INFO  Starting execution of 1 what-if analyses...
2022-09-21 08:17:47 INFO  Start plan generation for analysis PermutationFeatureImportance...
2022-09-21 08:17:47 INFO  ---RUNTIME: Plan generation took 0.10895729064941406 ms
2022-09-21 08:17:47 INFO  Estimated runtime of original DAG is 13047.544479370117ms
2022-09-21 08:17:47 INFO  Performing Multi-Query Optimization
2022-09-21 08:17:47 INFO  Estimated unoptimized what-if runtime is 65237.722396850586ms
2022-09-21 08:17:47 INFO  Estimated optimised what-if runtime is 13436.607599258423ms
2022-09-21 08:17:47 INFO  Estimated optimisation runtime saving is 51801.11479759216ms
2022-09-21 08:17:47 INFO  ---RUNTIME: Multi-Query Optimization took 10.801553726196289 ms
2022-09-21 08:17:47 INFO  Executing generated plans
2022-09-21 08:18:02 INFO  ---RUNTIME: Execution took 14242.212772369385 ms
2022-09-21 08:18:02 INFO  Done!
2022-09-21 08:18:02 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-21 08:18:02 INFO  Running instrumented original pipeline...
2022-09-21 08:18:02 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-21 08:18:02 INFO  ---RUNTIME: Importing and monkey-patching took 5.9566497802734375 ms
2022-09-21 08:18:22 INFO  ---RUNTIME: Original pipeline execution took 19829.20503616333 ms (excluding imports and monkey-patching)
2022-09-21 08:18:22 INFO  Starting execution of 1 what-if analyses...
2022-09-21 08:18:22 INFO  Start plan generation for analysis PermutationFeatureImportance...
2022-09-21 08:18:22 INFO  ---RUNTIME: Plan generation took 0.12922286987304688 ms
2022-09-21 08:18:22 INFO  Estimated runtime of original DAG is 15261.357307434082ms
2022-09-21 08:18:22 WARNING Skipping Multi-Query Optimization (instead, only combine execution DAGs)
2022-09-21 08:18:22 INFO  Estimated unoptimised what-if runtime is 76306.78653717041ms
2022-09-21 08:18:22 INFO  ---RUNTIME: Multi-Query Optimization took 23.032426834106445 ms
2022-09-21 08:18:22 INFO  Executing generated plans
2022-09-21 08:19:31 INFO  ---RUNTIME: Execution took 69391.2889957428 ms
2022-09-21 08:19:31 INFO  Done!
2022-09-21 08:19:31 INFO  # Finished -- repetition 5 of 7 
2022-09-21 08:19:31 INFO  # Optimization benchmark for feature_importance with args [['reviews', 'slow_loading', 'featurization_4', 'xgboost']] -- repetition 6 of 7
2022-09-21 08:19:31 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-21 08:19:31 INFO  Running instrumented original pipeline...
2022-09-21 08:19:31 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-21 08:19:31 INFO  ---RUNTIME: Importing and monkey-patching took 5.733728408813477 ms
2022-09-21 08:19:48 INFO  ---RUNTIME: Original pipeline execution took 16569.29326057434 ms (excluding imports and monkey-patching)
2022-09-21 08:19:48 INFO  Starting execution of 1 what-if analyses...
2022-09-21 08:19:48 INFO  Start plan generation for analysis PermutationFeatureImportance...
2022-09-21 08:19:48 INFO  ---RUNTIME: Plan generation took 0.12731552124023438 ms
2022-09-21 08:19:48 INFO  Estimated runtime of original DAG is 13272.96257019043ms
2022-09-21 08:19:48 INFO  Performing Multi-Query Optimization
2022-09-21 08:19:48 INFO  Estimated unoptimized what-if runtime is 66364.81285095215ms
2022-09-21 08:19:48 INFO  Estimated optimised what-if runtime is 13662.431478500366ms
2022-09-21 08:19:48 INFO  Estimated optimisation runtime saving is 52702.38137245178ms
2022-09-21 08:19:48 INFO  ---RUNTIME: Multi-Query Optimization took 11.221885681152344 ms
2022-09-21 08:19:48 INFO  Executing generated plans
2022-09-21 08:20:02 INFO  ---RUNTIME: Execution took 14475.123643875122 ms
2022-09-21 08:20:02 INFO  Done!
2022-09-21 08:20:02 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-21 08:20:02 INFO  Running instrumented original pipeline...
2022-09-21 08:20:02 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-21 08:20:02 INFO  ---RUNTIME: Importing and monkey-patching took 5.964040756225586 ms
2022-09-21 08:20:19 INFO  ---RUNTIME: Original pipeline execution took 16446.90179824829 ms (excluding imports and monkey-patching)
2022-09-21 08:20:19 INFO  Starting execution of 1 what-if analyses...
2022-09-21 08:20:19 INFO  Start plan generation for analysis PermutationFeatureImportance...
2022-09-21 08:20:19 INFO  ---RUNTIME: Plan generation took 0.10037422180175781 ms
2022-09-21 08:20:19 INFO  Estimated runtime of original DAG is 12859.657764434814ms
2022-09-21 08:20:19 WARNING Skipping Multi-Query Optimization (instead, only combine execution DAGs)
2022-09-21 08:20:19 INFO  Estimated unoptimised what-if runtime is 64298.28882217407ms
2022-09-21 08:20:19 INFO  ---RUNTIME: Multi-Query Optimization took 15.833854675292969 ms
2022-09-21 08:20:19 INFO  Executing generated plans
2022-09-21 08:21:33 INFO  ---RUNTIME: Execution took 74797.51372337341 ms
2022-09-21 08:21:33 INFO  Done!
2022-09-21 08:21:33 INFO  # Finished -- repetition 6 of 7 
2022-09-21 08:21:33 INFO  # Optimization benchmark for feature_importance with args [['reviews', 'slow_loading', 'featurization_4', 'xgboost']] -- repetition 7 of 7
2022-09-21 08:21:33 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-21 08:21:33 INFO  Running instrumented original pipeline...
2022-09-21 08:21:33 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-21 08:21:33 INFO  ---RUNTIME: Importing and monkey-patching took 8.725404739379883 ms
2022-09-21 08:21:51 INFO  ---RUNTIME: Original pipeline execution took 17409.891605377197 ms (excluding imports and monkey-patching)
2022-09-21 08:21:51 INFO  Starting execution of 1 what-if analyses...
2022-09-21 08:21:51 INFO  Start plan generation for analysis PermutationFeatureImportance...
2022-09-21 08:21:51 INFO  ---RUNTIME: Plan generation took 0.11777877807617188 ms
2022-09-21 08:21:51 INFO  Estimated runtime of original DAG is 13689.427137374878ms
2022-09-21 08:21:51 INFO  Performing Multi-Query Optimization
2022-09-21 08:21:51 INFO  Estimated unoptimized what-if runtime is 68447.13568687439ms
2022-09-21 08:21:51 INFO  Estimated optimised what-if runtime is 14091.679811477661ms
2022-09-21 08:21:51 INFO  Estimated optimisation runtime saving is 54355.45587539673ms
2022-09-21 08:21:51 INFO  ---RUNTIME: Multi-Query Optimization took 10.810613632202148 ms
2022-09-21 08:21:51 INFO  Executing generated plans
2022-09-21 08:22:05 INFO  ---RUNTIME: Execution took 14323.223114013672 ms
2022-09-21 08:22:05 INFO  Done!
2022-09-21 08:22:05 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-21 08:22:05 INFO  Running instrumented original pipeline...
2022-09-21 08:22:05 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-21 08:22:05 INFO  ---RUNTIME: Importing and monkey-patching took 6.154537200927734 ms
2022-09-21 08:22:21 INFO  ---RUNTIME: Original pipeline execution took 16363.27314376831 ms (excluding imports and monkey-patching)
2022-09-21 08:22:21 INFO  Starting execution of 1 what-if analyses...
2022-09-21 08:22:21 INFO  Start plan generation for analysis PermutationFeatureImportance...
2022-09-21 08:22:21 INFO  ---RUNTIME: Plan generation took 0.09632110595703125 ms
2022-09-21 08:22:21 INFO  Estimated runtime of original DAG is 12731.876850128174ms
2022-09-21 08:22:21 WARNING Skipping Multi-Query Optimization (instead, only combine execution DAGs)
2022-09-21 08:22:22 INFO  Estimated unoptimised what-if runtime is 63659.38425064087ms
2022-09-21 08:22:22 INFO  ---RUNTIME: Multi-Query Optimization took 15.65241813659668 ms
2022-09-21 08:22:22 INFO  Executing generated plans
2022-09-21 08:23:31 INFO  ---RUNTIME: Execution took 69112.6708984375 ms
2022-09-21 08:23:31 INFO  Done!
2022-09-21 08:23:31 INFO  # Finished -- repetition 7 of 7 
2022-09-21 08:23:31 INFO  # Final results after all repetitions
2022-09-21 08:23:31 INFO     repetition  ... no_opt_what_if_execution_combined_model_training
0           0  ...                                     16614.760637
1           1  ...                                     16671.639681
2           2  ...                                     16532.668352
3           3  ...                                     16545.518398
4           4  ...                                     16455.556870
5           5  ...                                     19040.367842
6           6  ...                                     16632.050037

[7 rows x 26 columns]
taskset -c 160-168 PROTOCOL_BUFFERS_PYTHON_IMPLEMENTATION=python python3.9 benchmarks_end_to_end.py feature_importance reviews slow_loading featurization_4 neural_network
2022-09-21 08:23:33.385735: W tensorflow/stream_executor/platform/default/dso_loader.cc:64] Could not load dynamic library 'libcudart.so.11.0'; dlerror: libcudart.so.11.0: cannot open shared object file: No such file or directory; LD_LIBRARY_PATH: /home/sgrafbe/mlwhatif/venv/lib/python3.9/site-packages/cv2/../../lib64:
2022-09-21 08:23:33.385783: I tensorflow/stream_executor/cuda/cudart_stub.cc:29] Ignore above cudart dlerror if you do not have a GPU set up on your machine.
2022-09-21 08:23:34 INFO  Patching sys.argv with ['mlwhatif', 'reviews', 'slow_loading', 'featurization_4', 'neural_network']
2022-09-21 08:23:34 INFO  Running instrumented original pipeline...
2022-09-21 08:23:34 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-21 08:23:34 INFO  ---RUNTIME: Importing and monkey-patching took 121.3674545288086 ms
2022-09-21 08:23:47.576423: W tensorflow/stream_executor/platform/default/dso_loader.cc:64] Could not load dynamic library 'libcuda.so.1'; dlerror: libcuda.so.1: cannot open shared object file: No such file or directory; LD_LIBRARY_PATH: /home/sgrafbe/mlwhatif/venv/lib/python3.9/site-packages/cv2/../../lib64:
2022-09-21 08:23:47.576460: W tensorflow/stream_executor/cuda/cuda_driver.cc:326] failed call to cuInit: UNKNOWN ERROR (303)
2022-09-21 08:23:47.576484: I tensorflow/stream_executor/cuda/cuda_diagnostics.cc:156] kernel driver does not appear to be running on this host (angus): /proc/driver/nvidia/version does not exist
2022-09-21 08:23:47.577098: I tensorflow/core/platform/cpu_feature_guard.cc:142] This TensorFlow binary is optimized with oneAPI Deep Neural Network Library (oneDNN) to use the following CPU instructions in performance-critical operations:  AVX2 FMA
To enable them in other operations, rebuild TensorFlow with the appropriate compiler flags.
2022-09-21 08:23:47.819576: I tensorflow/compiler/mlir/mlir_graph_optimization_pass.cc:176] None of the MLIR Optimization Passes are enabled (registered 2)
2022-09-21 08:23:47.831192: I tensorflow/core/platform/profile_utils/cpu_utils.cc:114] CPU Frequency: 2595130000 Hz
2022-09-21 08:23:51 INFO  ---RUNTIME: Original pipeline execution took 16996.13857269287 ms (excluding imports and monkey-patching)
2022-09-21 08:23:51 INFO  Starting execution of 0 what-if analyses...
2022-09-21 08:23:51 INFO  Estimated runtime of original DAG is 13710.299015045166ms
2022-09-21 08:23:51 INFO  Performing Multi-Query Optimization
2022-09-21 08:23:51 INFO  Estimated unoptimized what-if runtime is 0ms
2022-09-21 08:23:51 INFO  Estimated optimised what-if runtime is 0ms
2022-09-21 08:23:51 INFO  Estimated optimisation runtime saving is 0ms
2022-09-21 08:23:51 INFO  ---RUNTIME: Multi-Query Optimization took 0.4730224609375 ms
2022-09-21 08:23:51 INFO  Executing generated plans
2022-09-21 08:23:51 INFO  ---RUNTIME: Execution took 0.0152587890625 ms
2022-09-21 08:23:51 INFO  Done!
2022-09-21 08:23:51 INFO  # Optimization benchmark for feature_importance with args [['reviews', 'slow_loading', 'featurization_4', 'neural_network']] -- repetition 1 of 7
2022-09-21 08:23:51 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-21 08:23:51 INFO  Running instrumented original pipeline...
2022-09-21 08:23:51 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-21 08:23:51 INFO  ---RUNTIME: Importing and monkey-patching took 5.427122116088867 ms
2022-09-21 08:24:12 INFO  ---RUNTIME: Original pipeline execution took 20271.636486053467 ms (excluding imports and monkey-patching)
2022-09-21 08:24:12 INFO  Starting execution of 1 what-if analyses...
2022-09-21 08:24:12 INFO  Start plan generation for analysis PermutationFeatureImportance...
2022-09-21 08:24:12 INFO  ---RUNTIME: Plan generation took 0.24056434631347656 ms
2022-09-21 08:24:12 INFO  Estimated runtime of original DAG is 15845.246076583862ms
2022-09-21 08:24:12 INFO  Performing Multi-Query Optimization
2022-09-21 08:24:12 INFO  Estimated unoptimized what-if runtime is 79226.23038291931ms
2022-09-21 08:24:12 INFO  Estimated optimised what-if runtime is 18121.845483779907ms
2022-09-21 08:24:12 INFO  Estimated optimisation runtime saving is 61104.384899139404ms
2022-09-21 08:24:12 INFO  ---RUNTIME: Multi-Query Optimization took 15.677213668823242 ms
2022-09-21 08:24:12 INFO  Executing generated plans
2022-09-21 08:24:27 INFO  ---RUNTIME: Execution took 15811.084032058716 ms
2022-09-21 08:24:27 INFO  Done!
2022-09-21 08:24:27 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-21 08:24:27 INFO  Running instrumented original pipeline...
2022-09-21 08:24:27 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-21 08:24:27 INFO  ---RUNTIME: Importing and monkey-patching took 6.178140640258789 ms
2022-09-21 08:24:44 INFO  ---RUNTIME: Original pipeline execution took 16742.52223968506 ms (excluding imports and monkey-patching)
2022-09-21 08:24:44 INFO  Starting execution of 1 what-if analyses...
2022-09-21 08:24:44 INFO  Start plan generation for analysis PermutationFeatureImportance...
2022-09-21 08:24:44 INFO  ---RUNTIME: Plan generation took 0.12230873107910156 ms
2022-09-21 08:24:44 INFO  Estimated runtime of original DAG is 13484.19713973999ms
2022-09-21 08:24:44 WARNING Skipping Multi-Query Optimization (instead, only combine execution DAGs)
2022-09-21 08:24:44 INFO  Estimated unoptimised what-if runtime is 67420.98569869995ms
2022-09-21 08:24:44 INFO  ---RUNTIME: Multi-Query Optimization took 16.057252883911133 ms
2022-09-21 08:24:44 INFO  Executing generated plans
2022-09-21 08:25:59 INFO  ---RUNTIME: Execution took 74789.95060920715 ms
2022-09-21 08:25:59 INFO  Done!
2022-09-21 08:25:59 INFO  # Finished -- repetition 1 of 7 
2022-09-21 08:25:59 INFO  # Optimization benchmark for feature_importance with args [['reviews', 'slow_loading', 'featurization_4', 'neural_network']] -- repetition 2 of 7
2022-09-21 08:25:59 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-21 08:25:59 INFO  Running instrumented original pipeline...
2022-09-21 08:25:59 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-21 08:25:59 INFO  ---RUNTIME: Importing and monkey-patching took 5.878925323486328 ms
2022-09-21 08:26:15 INFO  ---RUNTIME: Original pipeline execution took 16357.919931411743 ms (excluding imports and monkey-patching)
2022-09-21 08:26:15 INFO  Starting execution of 1 what-if analyses...
2022-09-21 08:26:15 INFO  Start plan generation for analysis PermutationFeatureImportance...
2022-09-21 08:26:15 INFO  ---RUNTIME: Plan generation took 0.11873245239257812 ms
2022-09-21 08:26:15 INFO  Estimated runtime of original DAG is 13118.821382522583ms
2022-09-21 08:26:15 INFO  Performing Multi-Query Optimization
2022-09-21 08:26:15 INFO  Estimated unoptimized what-if runtime is 65594.10691261292ms
2022-09-21 08:26:15 INFO  Estimated optimised what-if runtime is 14932.69681930542ms
2022-09-21 08:26:15 INFO  Estimated optimisation runtime saving is 50661.410093307495ms
2022-09-21 08:26:15 INFO  ---RUNTIME: Multi-Query Optimization took 10.478973388671875 ms
2022-09-21 08:26:15 INFO  Executing generated plans
2022-09-21 08:26:32 INFO  ---RUNTIME: Execution took 16174.060344696045 ms
2022-09-21 08:26:32 INFO  Done!
2022-09-21 08:26:32 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-21 08:26:32 INFO  Running instrumented original pipeline...
2022-09-21 08:26:32 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-21 08:26:32 INFO  ---RUNTIME: Importing and monkey-patching took 5.943775177001953 ms
2022-09-21 08:26:48 INFO  ---RUNTIME: Original pipeline execution took 16750.114679336548 ms (excluding imports and monkey-patching)
2022-09-21 08:26:48 INFO  Starting execution of 1 what-if analyses...
2022-09-21 08:26:48 INFO  Start plan generation for analysis PermutationFeatureImportance...
2022-09-21 08:26:48 INFO  ---RUNTIME: Plan generation took 0.12254714965820312 ms
2022-09-21 08:26:48 INFO  Estimated runtime of original DAG is 13482.312202453613ms
2022-09-21 08:26:48 WARNING Skipping Multi-Query Optimization (instead, only combine execution DAGs)
2022-09-21 08:26:48 INFO  Estimated unoptimised what-if runtime is 67411.56101226807ms
2022-09-21 08:26:48 INFO  ---RUNTIME: Multi-Query Optimization took 16.05963706970215 ms
2022-09-21 08:26:48 INFO  Executing generated plans
2022-09-21 08:28:03 INFO  ---RUNTIME: Execution took 74678.15661430359 ms
2022-09-21 08:28:03 INFO  Done!
2022-09-21 08:28:03 INFO  # Finished -- repetition 2 of 7 
2022-09-21 08:28:03 INFO  # Optimization benchmark for feature_importance with args [['reviews', 'slow_loading', 'featurization_4', 'neural_network']] -- repetition 3 of 7
2022-09-21 08:28:03 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-21 08:28:03 INFO  Running instrumented original pipeline...
2022-09-21 08:28:03 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-21 08:28:03 INFO  ---RUNTIME: Importing and monkey-patching took 5.97691535949707 ms
2022-09-21 08:28:20 INFO  ---RUNTIME: Original pipeline execution took 17124.810218811035 ms (excluding imports and monkey-patching)
2022-09-21 08:28:20 INFO  Starting execution of 1 what-if analyses...
2022-09-21 08:28:20 INFO  Start plan generation for analysis PermutationFeatureImportance...
2022-09-21 08:28:20 INFO  ---RUNTIME: Plan generation took 0.10824203491210938 ms
2022-09-21 08:28:20 INFO  Estimated runtime of original DAG is 13464.518070220947ms
2022-09-21 08:28:20 INFO  Performing Multi-Query Optimization
2022-09-21 08:28:20 INFO  Estimated unoptimized what-if runtime is 67322.59035110474ms
2022-09-21 08:28:20 INFO  Estimated optimised what-if runtime is 15292.932033538818ms
2022-09-21 08:28:20 INFO  Estimated optimisation runtime saving is 52029.65831756592ms
2022-09-21 08:28:20 INFO  ---RUNTIME: Multi-Query Optimization took 10.574817657470703 ms
2022-09-21 08:28:20 INFO  Executing generated plans
2022-09-21 08:28:36 INFO  ---RUNTIME: Execution took 16121.56057357788 ms
2022-09-21 08:28:36 INFO  Done!
2022-09-21 08:28:36 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-21 08:28:36 INFO  Running instrumented original pipeline...
2022-09-21 08:28:36 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-21 08:28:36 INFO  ---RUNTIME: Importing and monkey-patching took 5.913734436035156 ms
2022-09-21 08:28:54 INFO  ---RUNTIME: Original pipeline execution took 17307.782411575317 ms (excluding imports and monkey-patching)
2022-09-21 08:28:54 INFO  Starting execution of 1 what-if analyses...
2022-09-21 08:28:54 INFO  Start plan generation for analysis PermutationFeatureImportance...
2022-09-21 08:28:54 INFO  ---RUNTIME: Plan generation took 0.10323524475097656 ms
2022-09-21 08:28:54 INFO  Estimated runtime of original DAG is 13643.258333206177ms
2022-09-21 08:28:54 WARNING Skipping Multi-Query Optimization (instead, only combine execution DAGs)
2022-09-21 08:28:54 INFO  Estimated unoptimised what-if runtime is 68216.29166603088ms
2022-09-21 08:28:54 INFO  ---RUNTIME: Multi-Query Optimization took 15.497922897338867 ms
2022-09-21 08:28:54 INFO  Executing generated plans
2022-09-21 08:30:09 INFO  ---RUNTIME: Execution took 74957.30113983154 ms
2022-09-21 08:30:09 INFO  Done!
2022-09-21 08:30:09 INFO  # Finished -- repetition 3 of 7 
2022-09-21 08:30:09 INFO  # Optimization benchmark for feature_importance with args [['reviews', 'slow_loading', 'featurization_4', 'neural_network']] -- repetition 4 of 7
2022-09-21 08:30:09 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-21 08:30:09 INFO  Running instrumented original pipeline...
2022-09-21 08:30:09 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-21 08:30:09 INFO  ---RUNTIME: Importing and monkey-patching took 6.044149398803711 ms
2022-09-21 08:30:26 INFO  ---RUNTIME: Original pipeline execution took 17524.921894073486 ms (excluding imports and monkey-patching)
2022-09-21 08:30:26 INFO  Starting execution of 1 what-if analyses...
2022-09-21 08:30:26 INFO  Start plan generation for analysis PermutationFeatureImportance...
2022-09-21 08:30:26 INFO  ---RUNTIME: Plan generation took 0.10895729064941406 ms
2022-09-21 08:30:26 INFO  Estimated runtime of original DAG is 13847.602844238281ms
2022-09-21 08:30:26 INFO  Performing Multi-Query Optimization
2022-09-21 08:30:26 INFO  Estimated unoptimized what-if runtime is 69238.0142211914ms
2022-09-21 08:30:26 INFO  Estimated optimised what-if runtime is 15626.536846160889ms
2022-09-21 08:30:26 INFO  Estimated optimisation runtime saving is 53611.47737503052ms
2022-09-21 08:30:26 INFO  ---RUNTIME: Multi-Query Optimization took 10.474205017089844 ms
2022-09-21 08:30:26 INFO  Executing generated plans
2022-09-21 08:30:42 INFO  ---RUNTIME: Execution took 15856.695413589478 ms
2022-09-21 08:30:42 INFO  Done!
2022-09-21 08:30:42 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-21 08:30:42 INFO  Running instrumented original pipeline...
2022-09-21 08:30:42 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-21 08:30:42 INFO  ---RUNTIME: Importing and monkey-patching took 5.983591079711914 ms
2022-09-21 08:30:59 INFO  ---RUNTIME: Original pipeline execution took 16862.558364868164 ms (excluding imports and monkey-patching)
2022-09-21 08:30:59 INFO  Starting execution of 1 what-if analyses...
2022-09-21 08:30:59 INFO  Start plan generation for analysis PermutationFeatureImportance...
2022-09-21 08:30:59 INFO  ---RUNTIME: Plan generation took 0.10919570922851562 ms
2022-09-21 08:30:59 INFO  Estimated runtime of original DAG is 13191.941261291504ms
2022-09-21 08:30:59 WARNING Skipping Multi-Query Optimization (instead, only combine execution DAGs)
2022-09-21 08:30:59 INFO  Estimated unoptimised what-if runtime is 65959.70630645752ms
2022-09-21 08:30:59 INFO  ---RUNTIME: Multi-Query Optimization took 15.268325805664062 ms
2022-09-21 08:30:59 INFO  Executing generated plans
2022-09-21 08:32:12 INFO  ---RUNTIME: Execution took 73542.79017448425 ms
2022-09-21 08:32:12 INFO  Done!
2022-09-21 08:32:12 INFO  # Finished -- repetition 4 of 7 
2022-09-21 08:32:12 INFO  # Optimization benchmark for feature_importance with args [['reviews', 'slow_loading', 'featurization_4', 'neural_network']] -- repetition 5 of 7
2022-09-21 08:32:12 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-21 08:32:12 INFO  Running instrumented original pipeline...
2022-09-21 08:32:12 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-21 08:32:12 INFO  ---RUNTIME: Importing and monkey-patching took 8.723258972167969 ms
2022-09-21 08:32:30 INFO  ---RUNTIME: Original pipeline execution took 17842.341423034668 ms (excluding imports and monkey-patching)
2022-09-21 08:32:30 INFO  Starting execution of 1 what-if analyses...
2022-09-21 08:32:30 INFO  Start plan generation for analysis PermutationFeatureImportance...
2022-09-21 08:32:30 INFO  ---RUNTIME: Plan generation took 0.09942054748535156 ms
2022-09-21 08:32:30 INFO  Estimated runtime of original DAG is 14024.827241897583ms
2022-09-21 08:32:30 INFO  Performing Multi-Query Optimization
2022-09-21 08:32:30 INFO  Estimated unoptimized what-if runtime is 70124.13620948792ms
2022-09-21 08:32:30 INFO  Estimated optimised what-if runtime is 15842.960119247437ms
2022-09-21 08:32:30 INFO  Estimated optimisation runtime saving is 54281.17609024048ms
2022-09-21 08:32:30 INFO  ---RUNTIME: Multi-Query Optimization took 10.473251342773438 ms
2022-09-21 08:32:30 INFO  Executing generated plans
2022-09-21 08:32:46 INFO  ---RUNTIME: Execution took 15831.843137741089 ms
2022-09-21 08:32:46 INFO  Done!
2022-09-21 08:32:46 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-21 08:32:46 INFO  Running instrumented original pipeline...
2022-09-21 08:32:46 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-21 08:32:46 INFO  ---RUNTIME: Importing and monkey-patching took 5.888938903808594 ms
2022-09-21 08:33:07 INFO  ---RUNTIME: Original pipeline execution took 20526.978254318237 ms (excluding imports and monkey-patching)
2022-09-21 08:33:07 INFO  Starting execution of 1 what-if analyses...
2022-09-21 08:33:07 INFO  Start plan generation for analysis PermutationFeatureImportance...
2022-09-21 08:33:07 INFO  ---RUNTIME: Plan generation took 0.11348724365234375 ms
2022-09-21 08:33:07 INFO  Estimated runtime of original DAG is 15862.258195877075ms
2022-09-21 08:33:07 WARNING Skipping Multi-Query Optimization (instead, only combine execution DAGs)
2022-09-21 08:33:07 INFO  Estimated unoptimised what-if runtime is 79311.29097938538ms
2022-09-21 08:33:07 INFO  ---RUNTIME: Multi-Query Optimization took 15.676259994506836 ms
2022-09-21 08:33:07 INFO  Executing generated plans
2022-09-21 08:34:17 INFO  ---RUNTIME: Execution took 70743.30711364746 ms
2022-09-21 08:34:17 INFO  Done!
2022-09-21 08:34:17 INFO  # Finished -- repetition 5 of 7 
2022-09-21 08:34:17 INFO  # Optimization benchmark for feature_importance with args [['reviews', 'slow_loading', 'featurization_4', 'neural_network']] -- repetition 6 of 7
2022-09-21 08:34:17 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-21 08:34:17 INFO  Running instrumented original pipeline...
2022-09-21 08:34:17 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-21 08:34:17 INFO  ---RUNTIME: Importing and monkey-patching took 6.279945373535156 ms
2022-09-21 08:34:34 INFO  ---RUNTIME: Original pipeline execution took 17046.147346496582 ms (excluding imports and monkey-patching)
2022-09-21 08:34:34 INFO  Starting execution of 1 what-if analyses...
2022-09-21 08:34:34 INFO  Start plan generation for analysis PermutationFeatureImportance...
2022-09-21 08:34:34 INFO  ---RUNTIME: Plan generation took 0.09679794311523438 ms
2022-09-21 08:34:34 INFO  Estimated runtime of original DAG is 13312.093257904053ms
2022-09-21 08:34:34 INFO  Performing Multi-Query Optimization
2022-09-21 08:34:34 INFO  Estimated unoptimized what-if runtime is 66560.46628952026ms
2022-09-21 08:34:34 INFO  Estimated optimised what-if runtime is 15125.265836715698ms
2022-09-21 08:34:34 INFO  Estimated optimisation runtime saving is 51435.200452804565ms
2022-09-21 08:34:34 INFO  ---RUNTIME: Multi-Query Optimization took 10.387897491455078 ms
2022-09-21 08:34:34 INFO  Executing generated plans
2022-09-21 08:34:50 INFO  ---RUNTIME: Execution took 15973.191976547241 ms
2022-09-21 08:34:50 INFO  Done!
2022-09-21 08:34:50 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-21 08:34:50 INFO  Running instrumented original pipeline...
2022-09-21 08:34:50 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-21 08:34:51 INFO  ---RUNTIME: Importing and monkey-patching took 5.787372589111328 ms
2022-09-21 08:35:07 INFO  ---RUNTIME: Original pipeline execution took 16776.44634246826 ms (excluding imports and monkey-patching)
2022-09-21 08:35:07 INFO  Starting execution of 1 what-if analyses...
2022-09-21 08:35:07 INFO  Start plan generation for analysis PermutationFeatureImportance...
2022-09-21 08:35:07 INFO  ---RUNTIME: Plan generation took 0.11897087097167969 ms
2022-09-21 08:35:07 INFO  Estimated runtime of original DAG is 13422.673225402832ms
2022-09-21 08:35:07 WARNING Skipping Multi-Query Optimization (instead, only combine execution DAGs)
2022-09-21 08:35:07 INFO  Estimated unoptimised what-if runtime is 67113.36612701416ms
2022-09-21 08:35:07 INFO  ---RUNTIME: Multi-Query Optimization took 15.788078308105469 ms
2022-09-21 08:35:07 INFO  Executing generated plans
2022-09-21 08:36:27 INFO  ---RUNTIME: Execution took 80051.47790908813 ms
2022-09-21 08:36:27 INFO  Done!
2022-09-21 08:36:27 INFO  # Finished -- repetition 6 of 7 
2022-09-21 08:36:27 INFO  # Optimization benchmark for feature_importance with args [['reviews', 'slow_loading', 'featurization_4', 'neural_network']] -- repetition 7 of 7
2022-09-21 08:36:27 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-21 08:36:27 INFO  Running instrumented original pipeline...
2022-09-21 08:36:27 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-21 08:36:27 INFO  ---RUNTIME: Importing and monkey-patching took 6.696939468383789 ms
2022-09-21 08:36:45 INFO  ---RUNTIME: Original pipeline execution took 17299.26085472107 ms (excluding imports and monkey-patching)
2022-09-21 08:36:45 INFO  Starting execution of 1 what-if analyses...
2022-09-21 08:36:45 INFO  Start plan generation for analysis PermutationFeatureImportance...
2022-09-21 08:36:45 INFO  ---RUNTIME: Plan generation took 0.11110305786132812 ms
2022-09-21 08:36:45 INFO  Estimated runtime of original DAG is 13980.231285095215ms
2022-09-21 08:36:45 INFO  Performing Multi-Query Optimization
2022-09-21 08:36:45 INFO  Estimated unoptimized what-if runtime is 69901.15642547607ms
2022-09-21 08:36:45 INFO  Estimated optimised what-if runtime is 17470.940113067627ms
2022-09-21 08:36:45 INFO  Estimated optimisation runtime saving is 52430.21631240845ms
2022-09-21 08:36:45 INFO  ---RUNTIME: Multi-Query Optimization took 10.915279388427734 ms
2022-09-21 08:36:45 INFO  Executing generated plans
2022-09-21 08:37:01 INFO  ---RUNTIME: Execution took 16052.567720413208 ms
2022-09-21 08:37:01 INFO  Done!
2022-09-21 08:37:01 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-21 08:37:01 INFO  Running instrumented original pipeline...
2022-09-21 08:37:01 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-21 08:37:01 INFO  ---RUNTIME: Importing and monkey-patching took 5.931854248046875 ms
2022-09-21 08:37:18 INFO  ---RUNTIME: Original pipeline execution took 16926.105499267578 ms (excluding imports and monkey-patching)
2022-09-21 08:37:18 INFO  Starting execution of 1 what-if analyses...
2022-09-21 08:37:18 INFO  Start plan generation for analysis PermutationFeatureImportance...
2022-09-21 08:37:18 INFO  ---RUNTIME: Plan generation took 0.13709068298339844 ms
2022-09-21 08:37:18 INFO  Estimated runtime of original DAG is 13572.518825531006ms
2022-09-21 08:37:18 WARNING Skipping Multi-Query Optimization (instead, only combine execution DAGs)
2022-09-21 08:37:18 INFO  Estimated unoptimised what-if runtime is 67862.59412765503ms
2022-09-21 08:37:18 INFO  ---RUNTIME: Multi-Query Optimization took 19.541025161743164 ms
2022-09-21 08:37:18 INFO  Executing generated plans
2022-09-21 08:38:29 INFO  ---RUNTIME: Execution took 71119.94552612305 ms
2022-09-21 08:38:29 INFO  Done!
2022-09-21 08:38:29 INFO  # Finished -- repetition 7 of 7 
2022-09-21 08:38:29 INFO  # Final results after all repetitions
2022-09-21 08:38:29 INFO     repetition  ... no_opt_what_if_execution_combined_model_training
0           0  ...                                     16569.783449
1           1  ...                                     17332.860470
2           2  ...                                     17671.490431
3           3  ...                                     18418.115139
4           4  ...                                     16342.986584
5           5  ...                                     18561.590433
6           6  ...                                     16456.445217

[7 rows x 26 columns]
taskset -c 160-168 PROTOCOL_BUFFERS_PYTHON_IMPLEMENTATION=python python3.9 benchmarks_end_to_end.py data_cleaning reviews slow_loading featurization_0 logistic_regression
2022-09-21 08:38:31.819769: W tensorflow/stream_executor/platform/default/dso_loader.cc:64] Could not load dynamic library 'libcudart.so.11.0'; dlerror: libcudart.so.11.0: cannot open shared object file: No such file or directory; LD_LIBRARY_PATH: /home/sgrafbe/mlwhatif/venv/lib/python3.9/site-packages/cv2/../../lib64:
2022-09-21 08:38:31.819818: I tensorflow/stream_executor/cuda/cudart_stub.cc:29] Ignore above cudart dlerror if you do not have a GPU set up on your machine.
2022-09-21 08:38:33 INFO  Patching sys.argv with ['mlwhatif', 'reviews', 'slow_loading', 'featurization_0', 'logistic_regression']
2022-09-21 08:38:33 INFO  Running instrumented original pipeline...
2022-09-21 08:38:33 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-21 08:38:33 INFO  ---RUNTIME: Importing and monkey-patching took 122.91264533996582 ms
2022-09-21 08:38:40 INFO  ---RUNTIME: Original pipeline execution took 6979.840993881226 ms (excluding imports and monkey-patching)
2022-09-21 08:38:40 INFO  Starting execution of 0 what-if analyses...
2022-09-21 08:38:40 INFO  Estimated runtime of original DAG is 5308.078289031982ms
2022-09-21 08:38:40 INFO  Performing Multi-Query Optimization
2022-09-21 08:38:40 INFO  Estimated unoptimized what-if runtime is 0ms
2022-09-21 08:38:40 INFO  Estimated optimised what-if runtime is 0ms
2022-09-21 08:38:40 INFO  Estimated optimisation runtime saving is 0ms
2022-09-21 08:38:40 INFO  ---RUNTIME: Multi-Query Optimization took 0.49233436584472656 ms
2022-09-21 08:38:40 INFO  Executing generated plans
2022-09-21 08:38:40 INFO  ---RUNTIME: Execution took 0.026941299438476562 ms
2022-09-21 08:38:40 INFO  Done!
2022-09-21 08:38:40 INFO  # Optimization benchmark for data_cleaning with args [['reviews', 'slow_loading', 'featurization_0', 'logistic_regression']] -- repetition 1 of 7
2022-09-21 08:38:40 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-21 08:38:40 INFO  Running instrumented original pipeline...
2022-09-21 08:38:40 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-21 08:38:40 INFO  ---RUNTIME: Importing and monkey-patching took 5.794286727905273 ms
2022-09-21 08:38:47 INFO  ---RUNTIME: Original pipeline execution took 7082.8516483306885 ms (excluding imports and monkey-patching)
2022-09-21 08:38:47 INFO  Starting execution of 1 what-if analyses...
2022-09-21 08:38:47 INFO  Start plan generation for analysis DataCleaning...
2022-09-21 08:38:47 INFO  ---RUNTIME: Plan generation took 0.6196498870849609 ms
2022-09-21 08:38:47 INFO  Estimated runtime of original DAG is 5283.083915710449ms
2022-09-21 08:38:47 INFO  Performing Multi-Query Optimization
2022-09-21 08:38:47 INFO  Estimated unoptimized what-if runtime is 105661.67831420898ms
2022-09-21 08:38:47 INFO  Estimated optimised what-if runtime is 18802.445888519287ms
2022-09-21 08:38:47 INFO  Estimated optimisation runtime saving is 86859.2324256897ms
2022-09-21 08:38:47 INFO  ---RUNTIME: Multi-Query Optimization took 88.06061744689941 ms
2022-09-21 08:38:47 INFO  Executing generated plans
2022-09-21 08:39:13 INFO  ---RUNTIME: Execution took 25846.533060073853 ms
2022-09-21 08:39:13 INFO  Done!
2022-09-21 08:39:13 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-21 08:39:13 INFO  Running instrumented original pipeline...
2022-09-21 08:39:13 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-21 08:39:13 INFO  ---RUNTIME: Importing and monkey-patching took 6.523370742797852 ms
2022-09-21 08:39:20 INFO  ---RUNTIME: Original pipeline execution took 6927.124977111816 ms (excluding imports and monkey-patching)
2022-09-21 08:39:20 INFO  Starting execution of 1 what-if analyses...
2022-09-21 08:39:20 INFO  Start plan generation for analysis DataCleaning...
2022-09-21 08:39:20 INFO  ---RUNTIME: Plan generation took 0.60272216796875 ms
2022-09-21 08:39:20 INFO  Estimated runtime of original DAG is 5295.784950256348ms
2022-09-21 08:39:20 WARNING Skipping Multi-Query Optimization (instead, only combine execution DAGs)
2022-09-21 08:39:20 WARNING Columns ['review_id'] not present in train DAG after the train test split, only before!
2022-09-21 08:39:20 WARNING This could hint at data leakage!
2022-09-21 08:39:20 INFO  Estimated unoptimised what-if runtime is 105915.69900512695ms
2022-09-21 08:39:20 INFO  ---RUNTIME: Multi-Query Optimization took 99.70736503601074 ms
2022-09-21 08:39:20 INFO  Executing generated plans
2022-09-21 08:41:39 INFO  ---RUNTIME: Execution took 139421.37694358826 ms
2022-09-21 08:41:39 INFO  Done!
2022-09-21 08:41:39 INFO  # Finished -- repetition 1 of 7 
2022-09-21 08:41:39 INFO  # Optimization benchmark for data_cleaning with args [['reviews', 'slow_loading', 'featurization_0', 'logistic_regression']] -- repetition 2 of 7
2022-09-21 08:41:39 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-21 08:41:39 INFO  Running instrumented original pipeline...
2022-09-21 08:41:39 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-21 08:41:39 INFO  ---RUNTIME: Importing and monkey-patching took 6.239891052246094 ms
2022-09-21 08:41:47 INFO  ---RUNTIME: Original pipeline execution took 7429.85463142395 ms (excluding imports and monkey-patching)
2022-09-21 08:41:47 INFO  Starting execution of 1 what-if analyses...
2022-09-21 08:41:47 INFO  Start plan generation for analysis DataCleaning...
2022-09-21 08:41:47 INFO  ---RUNTIME: Plan generation took 0.5440711975097656 ms
2022-09-21 08:41:47 INFO  Estimated runtime of original DAG is 5767.244815826416ms
2022-09-21 08:41:47 INFO  Performing Multi-Query Optimization
2022-09-21 08:41:47 INFO  Estimated unoptimized what-if runtime is 115344.89631652832ms
2022-09-21 08:41:47 INFO  Estimated optimised what-if runtime is 19081.310033798218ms
2022-09-21 08:41:47 INFO  Estimated optimisation runtime saving is 96263.5862827301ms
2022-09-21 08:41:47 INFO  ---RUNTIME: Multi-Query Optimization took 85.38460731506348 ms
2022-09-21 08:41:47 INFO  Executing generated plans
2022-09-21 08:42:13 INFO  ---RUNTIME: Execution took 25807.297706604004 ms
2022-09-21 08:42:13 INFO  Done!
2022-09-21 08:42:13 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-21 08:42:13 INFO  Running instrumented original pipeline...
2022-09-21 08:42:13 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-21 08:42:13 INFO  ---RUNTIME: Importing and monkey-patching took 5.893468856811523 ms
2022-09-21 08:42:20 INFO  ---RUNTIME: Original pipeline execution took 6945.051670074463 ms (excluding imports and monkey-patching)
2022-09-21 08:42:20 INFO  Starting execution of 1 what-if analyses...
2022-09-21 08:42:20 INFO  Start plan generation for analysis DataCleaning...
2022-09-21 08:42:20 INFO  ---RUNTIME: Plan generation took 0.5114078521728516 ms
2022-09-21 08:42:20 INFO  Estimated runtime of original DAG is 5280.842304229736ms
2022-09-21 08:42:20 WARNING Skipping Multi-Query Optimization (instead, only combine execution DAGs)
2022-09-21 08:42:20 WARNING Columns ['review_id'] not present in train DAG after the train test split, only before!
2022-09-21 08:42:20 WARNING This could hint at data leakage!
2022-09-21 08:42:20 INFO  Estimated unoptimised what-if runtime is 105616.84608459473ms
2022-09-21 08:42:20 INFO  ---RUNTIME: Multi-Query Optimization took 98.61278533935547 ms
2022-09-21 08:42:20 INFO  Executing generated plans
2022-09-21 08:44:29 INFO  ---RUNTIME: Execution took 129450.71005821228 ms
2022-09-21 08:44:29 INFO  Done!
2022-09-21 08:44:29 INFO  # Finished -- repetition 2 of 7 
2022-09-21 08:44:29 INFO  # Optimization benchmark for data_cleaning with args [['reviews', 'slow_loading', 'featurization_0', 'logistic_regression']] -- repetition 3 of 7
2022-09-21 08:44:29 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-21 08:44:29 INFO  Running instrumented original pipeline...
2022-09-21 08:44:29 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-21 08:44:29 INFO  ---RUNTIME: Importing and monkey-patching took 6.525754928588867 ms
2022-09-21 08:44:36 INFO  ---RUNTIME: Original pipeline execution took 7009.0930461883545 ms (excluding imports and monkey-patching)
2022-09-21 08:44:36 INFO  Starting execution of 1 what-if analyses...
2022-09-21 08:44:36 INFO  Start plan generation for analysis DataCleaning...
2022-09-21 08:44:36 INFO  ---RUNTIME: Plan generation took 0.5950927734375 ms
2022-09-21 08:44:36 INFO  Estimated runtime of original DAG is 5325.510501861572ms
2022-09-21 08:44:36 INFO  Performing Multi-Query Optimization
2022-09-21 08:44:36 INFO  Estimated unoptimized what-if runtime is 106510.21003723145ms
2022-09-21 08:44:36 INFO  Estimated optimised what-if runtime is 18715.043783187866ms
2022-09-21 08:44:36 INFO  Estimated optimisation runtime saving is 87795.16625404358ms
2022-09-21 08:44:36 INFO  ---RUNTIME: Multi-Query Optimization took 86.18974685668945 ms
2022-09-21 08:44:36 INFO  Executing generated plans
2022-09-21 08:45:02 INFO  ---RUNTIME: Execution took 25883.517026901245 ms
2022-09-21 08:45:02 INFO  Done!
2022-09-21 08:45:02 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-21 08:45:02 INFO  Running instrumented original pipeline...
2022-09-21 08:45:02 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-21 08:45:02 INFO  ---RUNTIME: Importing and monkey-patching took 5.928516387939453 ms
2022-09-21 08:45:09 INFO  ---RUNTIME: Original pipeline execution took 6971.58408164978 ms (excluding imports and monkey-patching)
2022-09-21 08:45:09 INFO  Starting execution of 1 what-if analyses...
2022-09-21 08:45:09 INFO  Start plan generation for analysis DataCleaning...
2022-09-21 08:45:09 INFO  ---RUNTIME: Plan generation took 0.5304813385009766 ms
2022-09-21 08:45:09 INFO  Estimated runtime of original DAG is 5291.427373886108ms
2022-09-21 08:45:09 WARNING Skipping Multi-Query Optimization (instead, only combine execution DAGs)
2022-09-21 08:45:09 WARNING Columns ['review_id'] not present in train DAG after the train test split, only before!
2022-09-21 08:45:09 WARNING This could hint at data leakage!
2022-09-21 08:45:09 INFO  Estimated unoptimised what-if runtime is 105828.54747772217ms
2022-09-21 08:45:09 INFO  ---RUNTIME: Multi-Query Optimization took 98.05607795715332 ms
2022-09-21 08:45:09 INFO  Executing generated plans
2022-09-21 08:47:26 INFO  ---RUNTIME: Execution took 136760.66994667053 ms
2022-09-21 08:47:26 INFO  Done!
2022-09-21 08:47:26 INFO  # Finished -- repetition 3 of 7 
2022-09-21 08:47:26 INFO  # Optimization benchmark for data_cleaning with args [['reviews', 'slow_loading', 'featurization_0', 'logistic_regression']] -- repetition 4 of 7
2022-09-21 08:47:26 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-21 08:47:26 INFO  Running instrumented original pipeline...
2022-09-21 08:47:26 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-21 08:47:26 INFO  ---RUNTIME: Importing and monkey-patching took 7.014751434326172 ms
2022-09-21 08:47:34 INFO  ---RUNTIME: Original pipeline execution took 7613.090515136719 ms (excluding imports and monkey-patching)
2022-09-21 08:47:34 INFO  Starting execution of 1 what-if analyses...
2022-09-21 08:47:34 INFO  Start plan generation for analysis DataCleaning...
2022-09-21 08:47:34 INFO  ---RUNTIME: Plan generation took 0.6651878356933594 ms
2022-09-21 08:47:34 INFO  Estimated runtime of original DAG is 5921.563148498535ms
2022-09-21 08:47:34 INFO  Performing Multi-Query Optimization
2022-09-21 08:47:34 INFO  Estimated unoptimized what-if runtime is 118431.2629699707ms
2022-09-21 08:47:34 INFO  Estimated optimised what-if runtime is 19763.567447662354ms
2022-09-21 08:47:34 INFO  Estimated optimisation runtime saving is 98667.69552230835ms
2022-09-21 08:47:34 INFO  ---RUNTIME: Multi-Query Optimization took 92.90432929992676 ms
2022-09-21 08:47:34 INFO  Executing generated plans
2022-09-21 08:48:00 INFO  ---RUNTIME: Execution took 25890.618801116943 ms
2022-09-21 08:48:00 INFO  Done!
2022-09-21 08:48:00 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-21 08:48:00 INFO  Running instrumented original pipeline...
2022-09-21 08:48:00 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-21 08:48:00 INFO  ---RUNTIME: Importing and monkey-patching took 6.000280380249023 ms
2022-09-21 08:48:06 INFO  ---RUNTIME: Original pipeline execution took 6962.39709854126 ms (excluding imports and monkey-patching)
2022-09-21 08:48:06 INFO  Starting execution of 1 what-if analyses...
2022-09-21 08:48:06 INFO  Start plan generation for analysis DataCleaning...
2022-09-21 08:48:06 INFO  ---RUNTIME: Plan generation took 0.5090236663818359 ms
2022-09-21 08:48:06 INFO  Estimated runtime of original DAG is 5283.192157745361ms
2022-09-21 08:48:06 WARNING Skipping Multi-Query Optimization (instead, only combine execution DAGs)
2022-09-21 08:48:07 WARNING Columns ['review_id'] not present in train DAG after the train test split, only before!
2022-09-21 08:48:07 WARNING This could hint at data leakage!
2022-09-21 08:48:07 INFO  Estimated unoptimised what-if runtime is 105663.84315490723ms
2022-09-21 08:48:07 INFO  ---RUNTIME: Multi-Query Optimization took 97.82767295837402 ms
2022-09-21 08:48:07 INFO  Executing generated plans
2022-09-21 08:50:19 INFO  ---RUNTIME: Execution took 131982.26356506348 ms
2022-09-21 08:50:19 INFO  Done!
2022-09-21 08:50:19 INFO  # Finished -- repetition 4 of 7 
2022-09-21 08:50:19 INFO  # Optimization benchmark for data_cleaning with args [['reviews', 'slow_loading', 'featurization_0', 'logistic_regression']] -- repetition 5 of 7
2022-09-21 08:50:19 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-21 08:50:19 INFO  Running instrumented original pipeline...
2022-09-21 08:50:19 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-21 08:50:19 INFO  ---RUNTIME: Importing and monkey-patching took 6.605625152587891 ms
2022-09-21 08:50:26 INFO  ---RUNTIME: Original pipeline execution took 7533.1480503082275 ms (excluding imports and monkey-patching)
2022-09-21 08:50:26 INFO  Starting execution of 1 what-if analyses...
2022-09-21 08:50:26 INFO  Start plan generation for analysis DataCleaning...
2022-09-21 08:50:26 INFO  ---RUNTIME: Plan generation took 0.598907470703125 ms
2022-09-21 08:50:26 INFO  Estimated runtime of original DAG is 5761.2738609313965ms
2022-09-21 08:50:26 INFO  Performing Multi-Query Optimization
2022-09-21 08:50:26 INFO  Estimated unoptimized what-if runtime is 115225.47721862793ms
2022-09-21 08:50:26 INFO  Estimated optimised what-if runtime is 19663.244247436523ms
2022-09-21 08:50:26 INFO  Estimated optimisation runtime saving is 95562.2329711914ms
2022-09-21 08:50:26 INFO  ---RUNTIME: Multi-Query Optimization took 84.12361145019531 ms
2022-09-21 08:50:26 INFO  Executing generated plans
2022-09-21 08:50:53 INFO  ---RUNTIME: Execution took 27128.97562980652 ms
2022-09-21 08:50:53 INFO  Done!
2022-09-21 08:50:53 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-21 08:50:53 INFO  Running instrumented original pipeline...
2022-09-21 08:50:53 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-21 08:50:53 INFO  ---RUNTIME: Importing and monkey-patching took 6.755352020263672 ms
2022-09-21 08:51:01 INFO  ---RUNTIME: Original pipeline execution took 7184.99755859375 ms (excluding imports and monkey-patching)
2022-09-21 08:51:01 INFO  Starting execution of 1 what-if analyses...
2022-09-21 08:51:01 INFO  Start plan generation for analysis DataCleaning...
2022-09-21 08:51:01 INFO  ---RUNTIME: Plan generation took 0.5321502685546875 ms
2022-09-21 08:51:01 INFO  Estimated runtime of original DAG is 5462.3377323150635ms
2022-09-21 08:51:01 WARNING Skipping Multi-Query Optimization (instead, only combine execution DAGs)
2022-09-21 08:51:01 WARNING Columns ['review_id'] not present in train DAG after the train test split, only before!
2022-09-21 08:51:01 WARNING This could hint at data leakage!
2022-09-21 08:51:01 INFO  Estimated unoptimised what-if runtime is 109246.75464630127ms
2022-09-21 08:51:01 INFO  ---RUNTIME: Multi-Query Optimization took 100.2054214477539 ms
2022-09-21 08:51:01 INFO  Executing generated plans
2022-09-21 08:53:14 INFO  ---RUNTIME: Execution took 133078.8083076477 ms
2022-09-21 08:53:14 INFO  Done!
2022-09-21 08:53:14 INFO  # Finished -- repetition 5 of 7 
2022-09-21 08:53:14 INFO  # Optimization benchmark for data_cleaning with args [['reviews', 'slow_loading', 'featurization_0', 'logistic_regression']] -- repetition 6 of 7
2022-09-21 08:53:14 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-21 08:53:14 INFO  Running instrumented original pipeline...
2022-09-21 08:53:14 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-21 08:53:14 INFO  ---RUNTIME: Importing and monkey-patching took 6.779909133911133 ms
2022-09-21 08:53:21 INFO  ---RUNTIME: Original pipeline execution took 7601.224422454834 ms (excluding imports and monkey-patching)
2022-09-21 08:53:21 INFO  Starting execution of 1 what-if analyses...
2022-09-21 08:53:21 INFO  Start plan generation for analysis DataCleaning...
2022-09-21 08:53:21 INFO  ---RUNTIME: Plan generation took 0.5733966827392578 ms
2022-09-21 08:53:21 INFO  Estimated runtime of original DAG is 5894.941329956055ms
2022-09-21 08:53:21 INFO  Performing Multi-Query Optimization
2022-09-21 08:53:21 INFO  Estimated unoptimized what-if runtime is 117898.8265991211ms
2022-09-21 08:53:21 INFO  Estimated optimised what-if runtime is 19243.531227111816ms
2022-09-21 08:53:21 INFO  Estimated optimisation runtime saving is 98655.29537200928ms
2022-09-21 08:53:21 INFO  ---RUNTIME: Multi-Query Optimization took 85.3276252746582 ms
2022-09-21 08:53:21 INFO  Executing generated plans
2022-09-21 08:53:47 INFO  ---RUNTIME: Execution took 25844.520568847656 ms
2022-09-21 08:53:47 INFO  Done!
2022-09-21 08:53:47 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-21 08:53:47 INFO  Running instrumented original pipeline...
2022-09-21 08:53:47 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-21 08:53:47 INFO  ---RUNTIME: Importing and monkey-patching took 5.906820297241211 ms
2022-09-21 08:53:54 INFO  ---RUNTIME: Original pipeline execution took 6966.711044311523 ms (excluding imports and monkey-patching)
2022-09-21 08:53:54 INFO  Starting execution of 1 what-if analyses...
2022-09-21 08:53:54 INFO  Start plan generation for analysis DataCleaning...
2022-09-21 08:53:54 INFO  ---RUNTIME: Plan generation took 0.5660057067871094 ms
2022-09-21 08:53:54 INFO  Estimated runtime of original DAG is 5273.449182510376ms
2022-09-21 08:53:54 WARNING Skipping Multi-Query Optimization (instead, only combine execution DAGs)
2022-09-21 08:53:54 WARNING Columns ['review_id'] not present in train DAG after the train test split, only before!
2022-09-21 08:53:54 WARNING This could hint at data leakage!
2022-09-21 08:53:54 INFO  Estimated unoptimised what-if runtime is 105468.98365020752ms
2022-09-21 08:53:54 INFO  ---RUNTIME: Multi-Query Optimization took 97.9008674621582 ms
2022-09-21 08:53:54 INFO  Executing generated plans
2022-09-21 08:56:07 INFO  ---RUNTIME: Execution took 132613.98577690125 ms
2022-09-21 08:56:07 INFO  Done!
2022-09-21 08:56:07 INFO  # Finished -- repetition 6 of 7 
2022-09-21 08:56:07 INFO  # Optimization benchmark for data_cleaning with args [['reviews', 'slow_loading', 'featurization_0', 'logistic_regression']] -- repetition 7 of 7
2022-09-21 08:56:07 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-21 08:56:07 INFO  Running instrumented original pipeline...
2022-09-21 08:56:07 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-21 08:56:07 INFO  ---RUNTIME: Importing and monkey-patching took 6.633281707763672 ms
2022-09-21 08:56:14 INFO  ---RUNTIME: Original pipeline execution took 7166.890382766724 ms (excluding imports and monkey-patching)
2022-09-21 08:56:14 INFO  Starting execution of 1 what-if analyses...
2022-09-21 08:56:14 INFO  Start plan generation for analysis DataCleaning...
2022-09-21 08:56:14 INFO  ---RUNTIME: Plan generation took 0.5462169647216797 ms
2022-09-21 08:56:14 INFO  Estimated runtime of original DAG is 5468.194484710693ms
2022-09-21 08:56:14 INFO  Performing Multi-Query Optimization
2022-09-21 08:56:15 INFO  Estimated unoptimized what-if runtime is 109363.88969421387ms
2022-09-21 08:56:15 INFO  Estimated optimised what-if runtime is 18850.656270980835ms
2022-09-21 08:56:15 INFO  Estimated optimisation runtime saving is 90513.23342323303ms
2022-09-21 08:56:15 INFO  ---RUNTIME: Multi-Query Optimization took 368.1209087371826 ms
2022-09-21 08:56:15 INFO  Executing generated plans
2022-09-21 08:56:41 INFO  ---RUNTIME: Execution took 26792.126178741455 ms
2022-09-21 08:56:41 INFO  Done!
2022-09-21 08:56:41 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-21 08:56:41 INFO  Running instrumented original pipeline...
2022-09-21 08:56:41 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-21 08:56:41 INFO  ---RUNTIME: Importing and monkey-patching took 6.553411483764648 ms
2022-09-21 08:56:49 INFO  ---RUNTIME: Original pipeline execution took 7379.585027694702 ms (excluding imports and monkey-patching)
2022-09-21 08:56:49 INFO  Starting execution of 1 what-if analyses...
2022-09-21 08:56:49 INFO  Start plan generation for analysis DataCleaning...
2022-09-21 08:56:49 INFO  ---RUNTIME: Plan generation took 0.4947185516357422 ms
2022-09-21 08:56:49 INFO  Estimated runtime of original DAG is 5569.034576416016ms
2022-09-21 08:56:49 WARNING Skipping Multi-Query Optimization (instead, only combine execution DAGs)
2022-09-21 08:56:49 WARNING Columns ['review_id'] not present in train DAG after the train test split, only before!
2022-09-21 08:56:49 WARNING This could hint at data leakage!
2022-09-21 08:56:49 INFO  Estimated unoptimised what-if runtime is 111380.69152832031ms
2022-09-21 08:56:49 INFO  ---RUNTIME: Multi-Query Optimization took 98.37174415588379 ms
2022-09-21 08:56:49 INFO  Executing generated plans
2022-09-21 08:59:00 INFO  ---RUNTIME: Execution took 131162.76669502258 ms
2022-09-21 08:59:00 INFO  Done!
2022-09-21 08:59:00 INFO  # Finished -- repetition 7 of 7 
2022-09-21 08:59:00 INFO  # Final results after all repetitions
2022-09-21 08:59:00 INFO     repetition  ... no_opt_what_if_execution_combined_model_training
0           0  ...                                      3131.618261
1           1  ...                                      3133.250713
2           2  ...                                      3282.877207
3           3  ...                                      3205.589294
4           4  ...                                      3111.431837
5           5  ...                                      3104.692698
6           6  ...                                      3132.294416

[7 rows x 26 columns]
taskset -c 160-168 PROTOCOL_BUFFERS_PYTHON_IMPLEMENTATION=python python3.9 benchmarks_end_to_end.py data_cleaning reviews slow_loading featurization_0 xgboost
2022-09-21 08:59:02.774354: W tensorflow/stream_executor/platform/default/dso_loader.cc:64] Could not load dynamic library 'libcudart.so.11.0'; dlerror: libcudart.so.11.0: cannot open shared object file: No such file or directory; LD_LIBRARY_PATH: /home/sgrafbe/mlwhatif/venv/lib/python3.9/site-packages/cv2/../../lib64:
2022-09-21 08:59:02.774402: I tensorflow/stream_executor/cuda/cudart_stub.cc:29] Ignore above cudart dlerror if you do not have a GPU set up on your machine.
2022-09-21 08:59:04 INFO  Patching sys.argv with ['mlwhatif', 'reviews', 'slow_loading', 'featurization_0', 'xgboost']
2022-09-21 08:59:04 INFO  Running instrumented original pipeline...
2022-09-21 08:59:04 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-21 08:59:04 INFO  ---RUNTIME: Importing and monkey-patching took 122.26366996765137 ms
2022-09-21 08:59:25 INFO  ---RUNTIME: Original pipeline execution took 21366.79220199585 ms (excluding imports and monkey-patching)
2022-09-21 08:59:25 INFO  Starting execution of 0 what-if analyses...
2022-09-21 08:59:25 INFO  Estimated runtime of original DAG is 19705.43384552002ms
2022-09-21 08:59:25 INFO  Performing Multi-Query Optimization
2022-09-21 08:59:25 INFO  Estimated unoptimized what-if runtime is 0ms
2022-09-21 08:59:25 INFO  Estimated optimised what-if runtime is 0ms
2022-09-21 08:59:25 INFO  Estimated optimisation runtime saving is 0ms
2022-09-21 08:59:25 INFO  ---RUNTIME: Multi-Query Optimization took 0.4928112030029297 ms
2022-09-21 08:59:25 INFO  Executing generated plans
2022-09-21 08:59:25 INFO  ---RUNTIME: Execution took 0.022649765014648438 ms
2022-09-21 08:59:25 INFO  Done!
2022-09-21 08:59:25 INFO  # Optimization benchmark for data_cleaning with args [['reviews', 'slow_loading', 'featurization_0', 'xgboost']] -- repetition 1 of 7
2022-09-21 08:59:25 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-21 08:59:25 INFO  Running instrumented original pipeline...
2022-09-21 08:59:25 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-21 08:59:25 INFO  ---RUNTIME: Importing and monkey-patching took 5.744218826293945 ms
2022-09-21 08:59:33 INFO  ---RUNTIME: Original pipeline execution took 7721.556901931763 ms (excluding imports and monkey-patching)
2022-09-21 08:59:33 INFO  Starting execution of 1 what-if analyses...
2022-09-21 08:59:33 INFO  Start plan generation for analysis DataCleaning...
2022-09-21 08:59:33 INFO  ---RUNTIME: Plan generation took 0.5636215209960938 ms
2022-09-21 08:59:33 INFO  Estimated runtime of original DAG is 5917.286396026611ms
2022-09-21 08:59:33 INFO  Performing Multi-Query Optimization
2022-09-21 08:59:33 INFO  Estimated unoptimized what-if runtime is 118345.72792053223ms
2022-09-21 08:59:33 INFO  Estimated optimised what-if runtime is 31153.504371643066ms
2022-09-21 08:59:33 INFO  Estimated optimisation runtime saving is 87192.22354888916ms
2022-09-21 08:59:33 INFO  ---RUNTIME: Multi-Query Optimization took 87.56685256958008 ms
2022-09-21 08:59:33 INFO  Executing generated plans
2022-09-21 09:00:12 INFO  ---RUNTIME: Execution took 39077.003717422485 ms
2022-09-21 09:00:12 INFO  Done!
2022-09-21 09:00:12 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-21 09:00:12 INFO  Running instrumented original pipeline...
2022-09-21 09:00:12 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-21 09:00:12 INFO  ---RUNTIME: Importing and monkey-patching took 6.677865982055664 ms
2022-09-21 09:00:20 INFO  ---RUNTIME: Original pipeline execution took 7858.259677886963 ms (excluding imports and monkey-patching)
2022-09-21 09:00:20 INFO  Starting execution of 1 what-if analyses...
2022-09-21 09:00:20 INFO  Start plan generation for analysis DataCleaning...
2022-09-21 09:00:20 INFO  ---RUNTIME: Plan generation took 0.5426406860351562 ms
2022-09-21 09:00:20 INFO  Estimated runtime of original DAG is 6146.557092666626ms
2022-09-21 09:00:20 WARNING Skipping Multi-Query Optimization (instead, only combine execution DAGs)
2022-09-21 09:00:20 WARNING Columns ['review_id'] not present in train DAG after the train test split, only before!
2022-09-21 09:00:20 WARNING This could hint at data leakage!
2022-09-21 09:00:20 INFO  Estimated unoptimised what-if runtime is 122931.14185333252ms
2022-09-21 09:00:20 INFO  ---RUNTIME: Multi-Query Optimization took 105.80873489379883 ms
2022-09-21 09:00:20 INFO  Executing generated plans
2022-09-21 09:02:47 INFO  ---RUNTIME: Execution took 147010.44702529907 ms
2022-09-21 09:02:47 INFO  Done!
2022-09-21 09:02:47 INFO  # Finished -- repetition 1 of 7 
2022-09-21 09:02:47 INFO  # Optimization benchmark for data_cleaning with args [['reviews', 'slow_loading', 'featurization_0', 'xgboost']] -- repetition 2 of 7
2022-09-21 09:02:47 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-21 09:02:47 INFO  Running instrumented original pipeline...
2022-09-21 09:02:47 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-21 09:02:47 INFO  ---RUNTIME: Importing and monkey-patching took 6.9446563720703125 ms
2022-09-21 09:02:55 INFO  ---RUNTIME: Original pipeline execution took 7739.905834197998 ms (excluding imports and monkey-patching)
2022-09-21 09:02:55 INFO  Starting execution of 1 what-if analyses...
2022-09-21 09:02:55 INFO  Start plan generation for analysis DataCleaning...
2022-09-21 09:02:55 INFO  ---RUNTIME: Plan generation took 0.5497932434082031 ms
2022-09-21 09:02:55 INFO  Estimated runtime of original DAG is 6020.289659500122ms
2022-09-21 09:02:55 INFO  Performing Multi-Query Optimization
2022-09-21 09:02:55 INFO  Estimated unoptimized what-if runtime is 120405.79319000244ms
2022-09-21 09:02:55 INFO  Estimated optimised what-if runtime is 30950.850009918213ms
2022-09-21 09:02:55 INFO  Estimated optimisation runtime saving is 89454.94318008423ms
2022-09-21 09:02:55 INFO  ---RUNTIME: Multi-Query Optimization took 85.20126342773438 ms
2022-09-21 09:02:55 INFO  Executing generated plans
2022-09-21 09:03:33 INFO  ---RUNTIME: Execution took 38518.51415634155 ms
2022-09-21 09:03:33 INFO  Done!
2022-09-21 09:03:33 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-21 09:03:33 INFO  Running instrumented original pipeline...
2022-09-21 09:03:33 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-21 09:03:33 INFO  ---RUNTIME: Importing and monkey-patching took 6.247520446777344 ms
2022-09-21 09:03:41 INFO  ---RUNTIME: Original pipeline execution took 7545.82953453064 ms (excluding imports and monkey-patching)
2022-09-21 09:03:41 INFO  Starting execution of 1 what-if analyses...
2022-09-21 09:03:41 INFO  Start plan generation for analysis DataCleaning...
2022-09-21 09:03:41 INFO  ---RUNTIME: Plan generation took 0.5340576171875 ms
2022-09-21 09:03:41 INFO  Estimated runtime of original DAG is 5856.4605712890625ms
2022-09-21 09:03:41 WARNING Skipping Multi-Query Optimization (instead, only combine execution DAGs)
2022-09-21 09:03:41 WARNING Columns ['review_id'] not present in train DAG after the train test split, only before!
2022-09-21 09:03:41 WARNING This could hint at data leakage!
2022-09-21 09:03:41 INFO  Estimated unoptimised what-if runtime is 117129.21142578125ms
2022-09-21 09:03:41 INFO  ---RUNTIME: Multi-Query Optimization took 98.59156608581543 ms
2022-09-21 09:03:41 INFO  Executing generated plans
2022-09-21 09:06:06 INFO  ---RUNTIME: Execution took 144868.32451820374 ms
2022-09-21 09:06:06 INFO  Done!
2022-09-21 09:06:06 INFO  # Finished -- repetition 2 of 7 
2022-09-21 09:06:06 INFO  # Optimization benchmark for data_cleaning with args [['reviews', 'slow_loading', 'featurization_0', 'xgboost']] -- repetition 3 of 7
2022-09-21 09:06:06 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-21 09:06:06 INFO  Running instrumented original pipeline...
2022-09-21 09:06:06 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-21 09:06:06 INFO  ---RUNTIME: Importing and monkey-patching took 6.705284118652344 ms
2022-09-21 09:06:14 INFO  ---RUNTIME: Original pipeline execution took 7805.637359619141 ms (excluding imports and monkey-patching)
2022-09-21 09:06:14 INFO  Starting execution of 1 what-if analyses...
2022-09-21 09:06:14 INFO  Start plan generation for analysis DataCleaning...
2022-09-21 09:06:14 INFO  ---RUNTIME: Plan generation took 0.7843971252441406 ms
2022-09-21 09:06:14 INFO  Estimated runtime of original DAG is 6054.641008377075ms
2022-09-21 09:06:14 INFO  Performing Multi-Query Optimization
2022-09-21 09:06:14 INFO  Estimated unoptimized what-if runtime is 121092.8201675415ms
2022-09-21 09:06:14 INFO  Estimated optimised what-if runtime is 31338.054418563843ms
2022-09-21 09:06:14 INFO  Estimated optimisation runtime saving is 89754.76574897766ms
2022-09-21 09:06:14 INFO  ---RUNTIME: Multi-Query Optimization took 94.33984756469727 ms
2022-09-21 09:06:14 INFO  Executing generated plans
2022-09-21 09:06:53 INFO  ---RUNTIME: Execution took 39222.02110290527 ms
2022-09-21 09:06:53 INFO  Done!
2022-09-21 09:06:53 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-21 09:06:53 INFO  Running instrumented original pipeline...
2022-09-21 09:06:53 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-21 09:06:53 INFO  ---RUNTIME: Importing and monkey-patching took 6.501436233520508 ms
2022-09-21 09:07:01 INFO  ---RUNTIME: Original pipeline execution took 7883.974075317383 ms (excluding imports and monkey-patching)
2022-09-21 09:07:01 INFO  Starting execution of 1 what-if analyses...
2022-09-21 09:07:01 INFO  Start plan generation for analysis DataCleaning...
2022-09-21 09:07:01 INFO  ---RUNTIME: Plan generation took 0.6160736083984375 ms
2022-09-21 09:07:01 INFO  Estimated runtime of original DAG is 6105.871200561523ms
2022-09-21 09:07:01 WARNING Skipping Multi-Query Optimization (instead, only combine execution DAGs)
2022-09-21 09:07:01 WARNING Columns ['review_id'] not present in train DAG after the train test split, only before!
2022-09-21 09:07:01 WARNING This could hint at data leakage!
2022-09-21 09:07:01 INFO  Estimated unoptimised what-if runtime is 122117.42401123047ms
2022-09-21 09:07:01 INFO  ---RUNTIME: Multi-Query Optimization took 108.12664031982422 ms
2022-09-21 09:07:01 INFO  Executing generated plans
2022-09-21 09:09:26 INFO  ---RUNTIME: Execution took 145358.08849334717 ms
2022-09-21 09:09:26 INFO  Done!
2022-09-21 09:09:26 INFO  # Finished -- repetition 3 of 7 
2022-09-21 09:09:26 INFO  # Optimization benchmark for data_cleaning with args [['reviews', 'slow_loading', 'featurization_0', 'xgboost']] -- repetition 4 of 7
2022-09-21 09:09:26 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-21 09:09:26 INFO  Running instrumented original pipeline...
2022-09-21 09:09:26 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-21 09:09:26 INFO  ---RUNTIME: Importing and monkey-patching took 6.470203399658203 ms
2022-09-21 09:09:34 INFO  ---RUNTIME: Original pipeline execution took 8085.597515106201 ms (excluding imports and monkey-patching)
2022-09-21 09:09:34 INFO  Starting execution of 1 what-if analyses...
2022-09-21 09:09:34 INFO  Start plan generation for analysis DataCleaning...
2022-09-21 09:09:34 INFO  ---RUNTIME: Plan generation took 0.5450248718261719 ms
2022-09-21 09:09:34 INFO  Estimated runtime of original DAG is 6393.468379974365ms
2022-09-21 09:09:34 INFO  Performing Multi-Query Optimization
2022-09-21 09:09:35 INFO  Estimated unoptimized what-if runtime is 127869.3675994873ms
2022-09-21 09:09:35 INFO  Estimated optimised what-if runtime is 31326.111555099487ms
2022-09-21 09:09:35 INFO  Estimated optimisation runtime saving is 96543.25604438782ms
2022-09-21 09:09:35 INFO  ---RUNTIME: Multi-Query Optimization took 87.85629272460938 ms
2022-09-21 09:09:35 INFO  Executing generated plans
2022-09-21 09:10:13 INFO  ---RUNTIME: Execution took 38544.13962364197 ms
2022-09-21 09:10:13 INFO  Done!
2022-09-21 09:10:13 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-21 09:10:13 INFO  Running instrumented original pipeline...
2022-09-21 09:10:13 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-21 09:10:13 INFO  ---RUNTIME: Importing and monkey-patching took 5.918979644775391 ms
2022-09-21 09:10:21 INFO  ---RUNTIME: Original pipeline execution took 7598.34623336792 ms (excluding imports and monkey-patching)
2022-09-21 09:10:21 INFO  Starting execution of 1 what-if analyses...
2022-09-21 09:10:21 INFO  Start plan generation for analysis DataCleaning...
2022-09-21 09:10:21 INFO  ---RUNTIME: Plan generation took 0.5922317504882812 ms
2022-09-21 09:10:21 INFO  Estimated runtime of original DAG is 5908.14995765686ms
2022-09-21 09:10:21 WARNING Skipping Multi-Query Optimization (instead, only combine execution DAGs)
2022-09-21 09:10:21 WARNING Columns ['review_id'] not present in train DAG after the train test split, only before!
2022-09-21 09:10:21 WARNING This could hint at data leakage!
2022-09-21 09:10:21 INFO  Estimated unoptimised what-if runtime is 118162.9991531372ms
2022-09-21 09:10:21 INFO  ---RUNTIME: Multi-Query Optimization took 110.39924621582031 ms
2022-09-21 09:10:21 INFO  Executing generated plans
2022-09-21 09:12:48 INFO  ---RUNTIME: Execution took 147018.17750930786 ms
2022-09-21 09:12:48 INFO  Done!
2022-09-21 09:12:48 INFO  # Finished -- repetition 4 of 7 
2022-09-21 09:12:48 INFO  # Optimization benchmark for data_cleaning with args [['reviews', 'slow_loading', 'featurization_0', 'xgboost']] -- repetition 5 of 7
2022-09-21 09:12:48 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-21 09:12:48 INFO  Running instrumented original pipeline...
2022-09-21 09:12:48 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-21 09:12:48 INFO  ---RUNTIME: Importing and monkey-patching took 7.1697235107421875 ms
2022-09-21 09:12:56 INFO  ---RUNTIME: Original pipeline execution took 8588.12165260315 ms (excluding imports and monkey-patching)
2022-09-21 09:12:56 INFO  Starting execution of 1 what-if analyses...
2022-09-21 09:12:56 INFO  Start plan generation for analysis DataCleaning...
2022-09-21 09:12:56 INFO  ---RUNTIME: Plan generation took 0.6248950958251953 ms
2022-09-21 09:12:56 INFO  Estimated runtime of original DAG is 6445.426940917969ms
2022-09-21 09:12:56 INFO  Performing Multi-Query Optimization
2022-09-21 09:12:57 INFO  Estimated unoptimized what-if runtime is 128908.53881835938ms
2022-09-21 09:12:57 INFO  Estimated optimised what-if runtime is 32602.753400802612ms
2022-09-21 09:12:57 INFO  Estimated optimisation runtime saving is 96305.78541755676ms
2022-09-21 09:12:57 INFO  ---RUNTIME: Multi-Query Optimization took 95.31116485595703 ms
2022-09-21 09:12:57 INFO  Executing generated plans
2022-09-21 09:13:37 INFO  ---RUNTIME: Execution took 40260.57052612305 ms
2022-09-21 09:13:37 INFO  Done!
2022-09-21 09:13:37 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-21 09:13:37 INFO  Running instrumented original pipeline...
2022-09-21 09:13:37 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-21 09:13:37 INFO  ---RUNTIME: Importing and monkey-patching took 6.611108779907227 ms
2022-09-21 09:13:45 INFO  ---RUNTIME: Original pipeline execution took 7725.722551345825 ms (excluding imports and monkey-patching)
2022-09-21 09:13:45 INFO  Starting execution of 1 what-if analyses...
2022-09-21 09:13:45 INFO  Start plan generation for analysis DataCleaning...
2022-09-21 09:13:45 INFO  ---RUNTIME: Plan generation took 0.5428791046142578 ms
2022-09-21 09:13:45 INFO  Estimated runtime of original DAG is 5988.100528717041ms
2022-09-21 09:13:45 WARNING Skipping Multi-Query Optimization (instead, only combine execution DAGs)
2022-09-21 09:13:45 WARNING Columns ['review_id'] not present in train DAG after the train test split, only before!
2022-09-21 09:13:45 WARNING This could hint at data leakage!
2022-09-21 09:13:45 INFO  Estimated unoptimised what-if runtime is 119762.01057434082ms
2022-09-21 09:13:45 INFO  ---RUNTIME: Multi-Query Optimization took 99.7161865234375 ms
2022-09-21 09:13:45 INFO  Executing generated plans
2022-09-21 09:16:09 INFO  ---RUNTIME: Execution took 144776.06320381165 ms
2022-09-21 09:16:09 INFO  Done!
2022-09-21 09:16:09 INFO  # Finished -- repetition 5 of 7 
2022-09-21 09:16:09 INFO  # Optimization benchmark for data_cleaning with args [['reviews', 'slow_loading', 'featurization_0', 'xgboost']] -- repetition 6 of 7
2022-09-21 09:16:09 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-21 09:16:09 INFO  Running instrumented original pipeline...
2022-09-21 09:16:09 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-21 09:16:09 INFO  ---RUNTIME: Importing and monkey-patching took 7.213115692138672 ms
2022-09-21 09:16:18 INFO  ---RUNTIME: Original pipeline execution took 8106.248617172241 ms (excluding imports and monkey-patching)
2022-09-21 09:16:18 INFO  Starting execution of 1 what-if analyses...
2022-09-21 09:16:18 INFO  Start plan generation for analysis DataCleaning...
2022-09-21 09:16:18 INFO  ---RUNTIME: Plan generation took 0.5700588226318359 ms
2022-09-21 09:16:18 INFO  Estimated runtime of original DAG is 6302.311420440674ms
2022-09-21 09:16:18 INFO  Performing Multi-Query Optimization
2022-09-21 09:16:18 INFO  Estimated unoptimized what-if runtime is 126046.22840881348ms
2022-09-21 09:16:18 INFO  Estimated optimised what-if runtime is 32494.964361190796ms
2022-09-21 09:16:18 INFO  Estimated optimisation runtime saving is 93551.26404762268ms
2022-09-21 09:16:18 INFO  ---RUNTIME: Multi-Query Optimization took 86.23743057250977 ms
2022-09-21 09:16:18 INFO  Executing generated plans
2022-09-21 09:16:58 INFO  ---RUNTIME: Execution took 40156.90493583679 ms
2022-09-21 09:16:58 INFO  Done!
2022-09-21 09:16:58 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-21 09:16:58 INFO  Running instrumented original pipeline...
2022-09-21 09:16:58 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-21 09:16:58 INFO  ---RUNTIME: Importing and monkey-patching took 6.798028945922852 ms
2022-09-21 09:17:06 INFO  ---RUNTIME: Original pipeline execution took 7756.12998008728 ms (excluding imports and monkey-patching)
2022-09-21 09:17:06 INFO  Starting execution of 1 what-if analyses...
2022-09-21 09:17:06 INFO  Start plan generation for analysis DataCleaning...
2022-09-21 09:17:06 INFO  ---RUNTIME: Plan generation took 0.5409717559814453 ms
2022-09-21 09:17:06 INFO  Estimated runtime of original DAG is 6030.49635887146ms
2022-09-21 09:17:06 WARNING Skipping Multi-Query Optimization (instead, only combine execution DAGs)
2022-09-21 09:17:06 WARNING Columns ['review_id'] not present in train DAG after the train test split, only before!
2022-09-21 09:17:06 WARNING This could hint at data leakage!
2022-09-21 09:17:06 INFO  Estimated unoptimised what-if runtime is 120609.9271774292ms
2022-09-21 09:17:06 INFO  ---RUNTIME: Multi-Query Optimization took 98.28782081604004 ms
2022-09-21 09:17:06 INFO  Executing generated plans
2022-09-21 09:19:32 INFO  ---RUNTIME: Execution took 146369.08435821533 ms
2022-09-21 09:19:32 INFO  Done!
2022-09-21 09:19:32 INFO  # Finished -- repetition 6 of 7 
2022-09-21 09:19:32 INFO  # Optimization benchmark for data_cleaning with args [['reviews', 'slow_loading', 'featurization_0', 'xgboost']] -- repetition 7 of 7
2022-09-21 09:19:32 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-21 09:19:32 INFO  Running instrumented original pipeline...
2022-09-21 09:19:32 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-21 09:19:32 INFO  ---RUNTIME: Importing and monkey-patching took 6.610870361328125 ms
2022-09-21 09:19:40 INFO  ---RUNTIME: Original pipeline execution took 8143.515825271606 ms (excluding imports and monkey-patching)
2022-09-21 09:19:40 INFO  Starting execution of 1 what-if analyses...
2022-09-21 09:19:40 INFO  Start plan generation for analysis DataCleaning...
2022-09-21 09:19:40 INFO  ---RUNTIME: Plan generation took 0.5657672882080078 ms
2022-09-21 09:19:40 INFO  Estimated runtime of original DAG is 6425.77338218689ms
2022-09-21 09:19:40 INFO  Performing Multi-Query Optimization
2022-09-21 09:19:40 INFO  Estimated unoptimized what-if runtime is 128515.4676437378ms
2022-09-21 09:19:40 INFO  Estimated optimised what-if runtime is 31307.225227355957ms
2022-09-21 09:19:40 INFO  Estimated optimisation runtime saving is 97208.24241638184ms
2022-09-21 09:19:40 INFO  ---RUNTIME: Multi-Query Optimization took 86.18783950805664 ms
2022-09-21 09:19:40 INFO  Executing generated plans
2022-09-21 09:20:19 INFO  ---RUNTIME: Execution took 38575.25563240051 ms
2022-09-21 09:20:19 INFO  Done!
2022-09-21 09:20:19 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-21 09:20:19 INFO  Running instrumented original pipeline...
2022-09-21 09:20:19 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-21 09:20:19 INFO  ---RUNTIME: Importing and monkey-patching took 5.896568298339844 ms
2022-09-21 09:20:27 INFO  ---RUNTIME: Original pipeline execution took 8020.132064819336 ms (excluding imports and monkey-patching)
2022-09-21 09:20:27 INFO  Starting execution of 1 what-if analyses...
2022-09-21 09:20:27 INFO  Start plan generation for analysis DataCleaning...
2022-09-21 09:20:27 INFO  ---RUNTIME: Plan generation took 0.5588531494140625 ms
2022-09-21 09:20:27 INFO  Estimated runtime of original DAG is 5972.766876220703ms
2022-09-21 09:20:27 WARNING Skipping Multi-Query Optimization (instead, only combine execution DAGs)
2022-09-21 09:20:27 WARNING Columns ['review_id'] not present in train DAG after the train test split, only before!
2022-09-21 09:20:27 WARNING This could hint at data leakage!
2022-09-21 09:20:27 INFO  Estimated unoptimised what-if runtime is 119455.33752441406ms
2022-09-21 09:20:27 INFO  ---RUNTIME: Multi-Query Optimization took 98.82736206054688 ms
2022-09-21 09:20:27 INFO  Executing generated plans
2022-09-21 09:22:53 INFO  ---RUNTIME: Execution took 145848.3166694641 ms
2022-09-21 09:22:53 INFO  Done!
2022-09-21 09:22:53 INFO  # Finished -- repetition 7 of 7 
2022-09-21 09:22:53 INFO  # Final results after all repetitions
2022-09-21 09:22:53 INFO     repetition  ... no_opt_what_if_execution_combined_model_training
0           0  ...                                     15217.333317
1           1  ...                                     15098.822594
2           2  ...                                     14836.086750
3           3  ...                                     15150.132418
4           4  ...                                     15335.050106
5           5  ...                                     14777.730942
6           6  ...                                     14831.691027

[7 rows x 26 columns]
taskset -c 160-168 PROTOCOL_BUFFERS_PYTHON_IMPLEMENTATION=python python3.9 benchmarks_end_to_end.py data_cleaning reviews slow_loading featurization_0 neural_network
2022-09-21 09:22:55.641048: W tensorflow/stream_executor/platform/default/dso_loader.cc:64] Could not load dynamic library 'libcudart.so.11.0'; dlerror: libcudart.so.11.0: cannot open shared object file: No such file or directory; LD_LIBRARY_PATH: /home/sgrafbe/mlwhatif/venv/lib/python3.9/site-packages/cv2/../../lib64:
2022-09-21 09:22:55.641107: I tensorflow/stream_executor/cuda/cudart_stub.cc:29] Ignore above cudart dlerror if you do not have a GPU set up on your machine.
2022-09-21 09:22:56 INFO  Patching sys.argv with ['mlwhatif', 'reviews', 'slow_loading', 'featurization_0', 'neural_network']
2022-09-21 09:22:56 INFO  Running instrumented original pipeline...
2022-09-21 09:22:56 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-21 09:22:57 INFO  ---RUNTIME: Importing and monkey-patching took 121.83022499084473 ms
2022-09-21 09:23:02.752695: W tensorflow/stream_executor/platform/default/dso_loader.cc:64] Could not load dynamic library 'libcuda.so.1'; dlerror: libcuda.so.1: cannot open shared object file: No such file or directory; LD_LIBRARY_PATH: /home/sgrafbe/mlwhatif/venv/lib/python3.9/site-packages/cv2/../../lib64:
2022-09-21 09:23:02.752746: W tensorflow/stream_executor/cuda/cuda_driver.cc:326] failed call to cuInit: UNKNOWN ERROR (303)
2022-09-21 09:23:02.752770: I tensorflow/stream_executor/cuda/cuda_diagnostics.cc:156] kernel driver does not appear to be running on this host (angus): /proc/driver/nvidia/version does not exist
2022-09-21 09:23:02.753308: I tensorflow/core/platform/cpu_feature_guard.cc:142] This TensorFlow binary is optimized with oneAPI Deep Neural Network Library (oneDNN) to use the following CPU instructions in performance-critical operations:  AVX2 FMA
To enable them in other operations, rebuild TensorFlow with the appropriate compiler flags.
2022-09-21 09:23:02.994117: I tensorflow/compiler/mlir/mlir_graph_optimization_pass.cc:176] None of the MLIR Optimization Passes are enabled (registered 2)
2022-09-21 09:23:03.006177: I tensorflow/core/platform/profile_utils/cpu_utils.cc:114] CPU Frequency: 2595130000 Hz
2022-09-21 09:23:07 INFO  ---RUNTIME: Original pipeline execution took 10830.33013343811 ms (excluding imports and monkey-patching)
2022-09-21 09:23:07 INFO  Starting execution of 0 what-if analyses...
2022-09-21 09:23:07 INFO  Estimated runtime of original DAG is 9152.057409286499ms
2022-09-21 09:23:07 INFO  Performing Multi-Query Optimization
2022-09-21 09:23:07 INFO  Estimated unoptimized what-if runtime is 0ms
2022-09-21 09:23:07 INFO  Estimated optimised what-if runtime is 0ms
2022-09-21 09:23:07 INFO  Estimated optimisation runtime saving is 0ms
2022-09-21 09:23:07 INFO  ---RUNTIME: Multi-Query Optimization took 0.49233436584472656 ms
2022-09-21 09:23:07 INFO  Executing generated plans
2022-09-21 09:23:07 INFO  ---RUNTIME: Execution took 0.022411346435546875 ms
2022-09-21 09:23:07 INFO  Done!
2022-09-21 09:23:07 INFO  # Optimization benchmark for data_cleaning with args [['reviews', 'slow_loading', 'featurization_0', 'neural_network']] -- repetition 1 of 7
2022-09-21 09:23:07 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-21 09:23:07 INFO  Running instrumented original pipeline...
2022-09-21 09:23:07 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-21 09:23:07 INFO  ---RUNTIME: Importing and monkey-patching took 5.442619323730469 ms
2022-09-21 09:23:18 INFO  ---RUNTIME: Original pipeline execution took 10255.359172821045 ms (excluding imports and monkey-patching)
2022-09-21 09:23:18 INFO  Starting execution of 1 what-if analyses...
2022-09-21 09:23:18 INFO  Start plan generation for analysis DataCleaning...
2022-09-21 09:23:18 INFO  ---RUNTIME: Plan generation took 0.5674362182617188 ms
2022-09-21 09:23:18 INFO  Estimated runtime of original DAG is 8615.19455909729ms
2022-09-21 09:23:18 INFO  Performing Multi-Query Optimization
2022-09-21 09:23:18 INFO  Estimated unoptimized what-if runtime is 172303.8911819458ms
2022-09-21 09:23:18 INFO  Estimated optimised what-if runtime is 85953.67860794067ms
2022-09-21 09:23:18 INFO  Estimated optimisation runtime saving is 86350.21257400513ms
2022-09-21 09:23:18 INFO  ---RUNTIME: Multi-Query Optimization took 88.91558647155762 ms
2022-09-21 09:23:18 INFO  Executing generated plans
2022-09-21 09:24:51 INFO  ---RUNTIME: Execution took 93651.83544158936 ms
2022-09-21 09:24:51 INFO  Done!
2022-09-21 09:24:51 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-21 09:24:51 INFO  Running instrumented original pipeline...
2022-09-21 09:24:51 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-21 09:24:51 INFO  ---RUNTIME: Importing and monkey-patching took 6.272315979003906 ms
2022-09-21 09:25:02 INFO  ---RUNTIME: Original pipeline execution took 10724.927186965942 ms (excluding imports and monkey-patching)
2022-09-21 09:25:02 INFO  Starting execution of 1 what-if analyses...
2022-09-21 09:25:02 INFO  Start plan generation for analysis DataCleaning...
2022-09-21 09:25:02 INFO  ---RUNTIME: Plan generation took 0.5552768707275391 ms
2022-09-21 09:25:02 INFO  Estimated runtime of original DAG is 9099.572658538818ms
2022-09-21 09:25:02 WARNING Skipping Multi-Query Optimization (instead, only combine execution DAGs)
2022-09-21 09:25:02 WARNING Columns ['review_id'] not present in train DAG after the train test split, only before!
2022-09-21 09:25:02 WARNING This could hint at data leakage!
2022-09-21 09:25:02 INFO  Estimated unoptimised what-if runtime is 181991.45317077637ms
2022-09-21 09:25:02 INFO  ---RUNTIME: Multi-Query Optimization took 98.25682640075684 ms
2022-09-21 09:25:02 INFO  Executing generated plans
2022-09-21 09:28:20 INFO  ---RUNTIME: Execution took 197991.7550086975 ms
2022-09-21 09:28:20 INFO  Done!
2022-09-21 09:28:20 INFO  # Finished -- repetition 1 of 7 
2022-09-21 09:28:20 INFO  # Optimization benchmark for data_cleaning with args [['reviews', 'slow_loading', 'featurization_0', 'neural_network']] -- repetition 2 of 7
2022-09-21 09:28:20 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-21 09:28:20 INFO  Running instrumented original pipeline...
2022-09-21 09:28:20 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-21 09:28:20 INFO  ---RUNTIME: Importing and monkey-patching took 6.02412223815918 ms
2022-09-21 09:28:31 INFO  ---RUNTIME: Original pipeline execution took 10442.6908493042 ms (excluding imports and monkey-patching)
2022-09-21 09:28:31 INFO  Starting execution of 1 what-if analyses...
2022-09-21 09:28:31 INFO  Start plan generation for analysis DataCleaning...
2022-09-21 09:28:31 INFO  ---RUNTIME: Plan generation took 0.5307197570800781 ms
2022-09-21 09:28:31 INFO  Estimated runtime of original DAG is 8772.157192230225ms
2022-09-21 09:28:31 INFO  Performing Multi-Query Optimization
2022-09-21 09:28:31 INFO  Estimated unoptimized what-if runtime is 175443.1438446045ms
2022-09-21 09:28:31 INFO  Estimated optimised what-if runtime is 86156.09431266785ms
2022-09-21 09:28:31 INFO  Estimated optimisation runtime saving is 89287.04953193665ms
2022-09-21 09:28:31 INFO  ---RUNTIME: Multi-Query Optimization took 84.85627174377441 ms
2022-09-21 09:28:31 INFO  Executing generated plans
2022-09-21 09:30:04 INFO  ---RUNTIME: Execution took 93316.36953353882 ms
2022-09-21 09:30:04 INFO  Done!
2022-09-21 09:30:04 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-21 09:30:04 INFO  Running instrumented original pipeline...
2022-09-21 09:30:04 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-21 09:30:04 INFO  ---RUNTIME: Importing and monkey-patching took 5.729198455810547 ms
2022-09-21 09:30:15 INFO  ---RUNTIME: Original pipeline execution took 10823.338031768799 ms (excluding imports and monkey-patching)
2022-09-21 09:30:15 INFO  Starting execution of 1 what-if analyses...
2022-09-21 09:30:15 INFO  Start plan generation for analysis DataCleaning...
2022-09-21 09:30:15 INFO  ---RUNTIME: Plan generation took 0.5047321319580078 ms
2022-09-21 09:30:15 INFO  Estimated runtime of original DAG is 9170.54557800293ms
2022-09-21 09:30:15 WARNING Skipping Multi-Query Optimization (instead, only combine execution DAGs)
2022-09-21 09:30:15 WARNING Columns ['review_id'] not present in train DAG after the train test split, only before!
2022-09-21 09:30:15 WARNING This could hint at data leakage!
2022-09-21 09:30:15 INFO  Estimated unoptimised what-if runtime is 183410.9115600586ms
2022-09-21 09:30:15 INFO  ---RUNTIME: Multi-Query Optimization took 98.82688522338867 ms
2022-09-21 09:30:15 INFO  Executing generated plans
2022-09-21 09:33:32 INFO  ---RUNTIME: Execution took 197441.04623794556 ms
2022-09-21 09:33:32 INFO  Done!
2022-09-21 09:33:32 INFO  # Finished -- repetition 2 of 7 
2022-09-21 09:33:32 INFO  # Optimization benchmark for data_cleaning with args [['reviews', 'slow_loading', 'featurization_0', 'neural_network']] -- repetition 3 of 7
2022-09-21 09:33:32 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-21 09:33:32 INFO  Running instrumented original pipeline...
2022-09-21 09:33:33 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-21 09:33:33 INFO  ---RUNTIME: Importing and monkey-patching took 5.69915771484375 ms
2022-09-21 09:33:43 INFO  ---RUNTIME: Original pipeline execution took 10463.83261680603 ms (excluding imports and monkey-patching)
2022-09-21 09:33:43 INFO  Starting execution of 1 what-if analyses...
2022-09-21 09:33:43 INFO  Start plan generation for analysis DataCleaning...
2022-09-21 09:33:43 INFO  ---RUNTIME: Plan generation took 0.5168914794921875 ms
2022-09-21 09:33:43 INFO  Estimated runtime of original DAG is 8782.807350158691ms
2022-09-21 09:33:43 INFO  Performing Multi-Query Optimization
2022-09-21 09:33:43 INFO  Estimated unoptimized what-if runtime is 175656.14700317383ms
2022-09-21 09:33:43 INFO  Estimated optimised what-if runtime is 85633.1889629364ms
2022-09-21 09:33:43 INFO  Estimated optimisation runtime saving is 90022.95804023743ms
2022-09-21 09:33:43 INFO  ---RUNTIME: Multi-Query Optimization took 86.61174774169922 ms
2022-09-21 09:33:43 INFO  Executing generated plans
2022-09-21 09:35:18 INFO  ---RUNTIME: Execution took 94530.71284294128 ms
2022-09-21 09:35:18 INFO  Done!
2022-09-21 09:35:18 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-21 09:35:18 INFO  Running instrumented original pipeline...
2022-09-21 09:35:18 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-21 09:35:18 INFO  ---RUNTIME: Importing and monkey-patching took 5.753517150878906 ms
2022-09-21 09:35:28 INFO  ---RUNTIME: Original pipeline execution took 10706.860780715942 ms (excluding imports and monkey-patching)
2022-09-21 09:35:28 INFO  Starting execution of 1 what-if analyses...
2022-09-21 09:35:28 INFO  Start plan generation for analysis DataCleaning...
2022-09-21 09:35:28 INFO  ---RUNTIME: Plan generation took 0.5354881286621094 ms
2022-09-21 09:35:28 INFO  Estimated runtime of original DAG is 9027.005195617676ms
2022-09-21 09:35:28 WARNING Skipping Multi-Query Optimization (instead, only combine execution DAGs)
2022-09-21 09:35:28 WARNING Columns ['review_id'] not present in train DAG after the train test split, only before!
2022-09-21 09:35:28 WARNING This could hint at data leakage!
2022-09-21 09:35:28 INFO  Estimated unoptimised what-if runtime is 180540.10391235352ms
2022-09-21 09:35:28 INFO  ---RUNTIME: Multi-Query Optimization took 98.21915626525879 ms
2022-09-21 09:35:28 INFO  Executing generated plans
2022-09-21 09:38:46 INFO  ---RUNTIME: Execution took 197545.45879364014 ms
2022-09-21 09:38:46 INFO  Done!
2022-09-21 09:38:46 INFO  # Finished -- repetition 3 of 7 
2022-09-21 09:38:46 INFO  # Optimization benchmark for data_cleaning with args [['reviews', 'slow_loading', 'featurization_0', 'neural_network']] -- repetition 4 of 7
2022-09-21 09:38:46 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-21 09:38:46 INFO  Running instrumented original pipeline...
2022-09-21 09:38:46 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-21 09:38:46 INFO  ---RUNTIME: Importing and monkey-patching took 5.868673324584961 ms
2022-09-21 09:38:56 INFO  ---RUNTIME: Original pipeline execution took 10416.401624679565 ms (excluding imports and monkey-patching)
2022-09-21 09:38:56 INFO  Starting execution of 1 what-if analyses...
2022-09-21 09:38:56 INFO  Start plan generation for analysis DataCleaning...
2022-09-21 09:38:56 INFO  ---RUNTIME: Plan generation took 0.5106925964355469 ms
2022-09-21 09:38:56 INFO  Estimated runtime of original DAG is 8728.722095489502ms
2022-09-21 09:38:56 INFO  Performing Multi-Query Optimization
2022-09-21 09:38:56 INFO  Estimated unoptimized what-if runtime is 174574.44190979004ms
2022-09-21 09:38:56 INFO  Estimated optimised what-if runtime is 84454.74743843079ms
2022-09-21 09:38:56 INFO  Estimated optimisation runtime saving is 90119.69447135925ms
2022-09-21 09:38:56 INFO  ---RUNTIME: Multi-Query Optimization took 84.7921371459961 ms
2022-09-21 09:38:56 INFO  Executing generated plans
2022-09-21 09:40:29 INFO  ---RUNTIME: Execution took 92913.77973556519 ms
2022-09-21 09:40:29 INFO  Done!
2022-09-21 09:40:29 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-21 09:40:29 INFO  Running instrumented original pipeline...
2022-09-21 09:40:29 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-21 09:40:29 INFO  ---RUNTIME: Importing and monkey-patching took 5.714893341064453 ms
2022-09-21 09:40:40 INFO  ---RUNTIME: Original pipeline execution took 10701.515674591064 ms (excluding imports and monkey-patching)
2022-09-21 09:40:40 INFO  Starting execution of 1 what-if analyses...
2022-09-21 09:40:40 INFO  Start plan generation for analysis DataCleaning...
2022-09-21 09:40:40 INFO  ---RUNTIME: Plan generation took 2.160310745239258 ms
2022-09-21 09:40:40 INFO  Estimated runtime of original DAG is 9020.569324493408ms
2022-09-21 09:40:40 WARNING Skipping Multi-Query Optimization (instead, only combine execution DAGs)
2022-09-21 09:40:40 WARNING Columns ['review_id'] not present in train DAG after the train test split, only before!
2022-09-21 09:40:40 WARNING This could hint at data leakage!
2022-09-21 09:40:40 INFO  Estimated unoptimised what-if runtime is 180411.38648986816ms
2022-09-21 09:40:40 INFO  ---RUNTIME: Multi-Query Optimization took 96.51494026184082 ms
2022-09-21 09:40:40 INFO  Executing generated plans
2022-09-21 09:44:04 INFO  ---RUNTIME: Execution took 203992.8240776062 ms
2022-09-21 09:44:04 INFO  Done!
2022-09-21 09:44:04 INFO  # Finished -- repetition 4 of 7 
2022-09-21 09:44:04 INFO  # Optimization benchmark for data_cleaning with args [['reviews', 'slow_loading', 'featurization_0', 'neural_network']] -- repetition 5 of 7
2022-09-21 09:44:04 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-21 09:44:04 INFO  Running instrumented original pipeline...
2022-09-21 09:44:04 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-21 09:44:04 INFO  ---RUNTIME: Importing and monkey-patching took 5.808830261230469 ms
2022-09-21 09:44:15 INFO  ---RUNTIME: Original pipeline execution took 10394.862651824951 ms (excluding imports and monkey-patching)
2022-09-21 09:44:15 INFO  Starting execution of 1 what-if analyses...
2022-09-21 09:44:15 INFO  Start plan generation for analysis DataCleaning...
2022-09-21 09:44:15 INFO  ---RUNTIME: Plan generation took 0.5717277526855469 ms
2022-09-21 09:44:15 INFO  Estimated runtime of original DAG is 8700.207948684692ms
2022-09-21 09:44:15 INFO  Performing Multi-Query Optimization
2022-09-21 09:44:15 INFO  Estimated unoptimized what-if runtime is 174004.15897369385ms
2022-09-21 09:44:15 INFO  Estimated optimised what-if runtime is 84400.64930915833ms
2022-09-21 09:44:15 INFO  Estimated optimisation runtime saving is 89603.50966453552ms
2022-09-21 09:44:15 INFO  ---RUNTIME: Multi-Query Optimization took 85.26611328125 ms
2022-09-21 09:44:15 INFO  Executing generated plans
2022-09-21 09:45:49 INFO  ---RUNTIME: Execution took 94613.2664680481 ms
2022-09-21 09:45:49 INFO  Done!
2022-09-21 09:45:49 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-21 09:45:49 INFO  Running instrumented original pipeline...
2022-09-21 09:45:49 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-21 09:45:49 INFO  ---RUNTIME: Importing and monkey-patching took 5.957126617431641 ms
2022-09-21 09:46:01 INFO  ---RUNTIME: Original pipeline execution took 11950.42610168457 ms (excluding imports and monkey-patching)
2022-09-21 09:46:01 INFO  Starting execution of 1 what-if analyses...
2022-09-21 09:46:01 INFO  Start plan generation for analysis DataCleaning...
2022-09-21 09:46:01 INFO  ---RUNTIME: Plan generation took 0.5605220794677734 ms
2022-09-21 09:46:01 INFO  Estimated runtime of original DAG is 10199.188232421875ms
2022-09-21 09:46:01 WARNING Skipping Multi-Query Optimization (instead, only combine execution DAGs)
2022-09-21 09:46:01 WARNING Columns ['review_id'] not present in train DAG after the train test split, only before!
2022-09-21 09:46:01 WARNING This could hint at data leakage!
2022-09-21 09:46:01 INFO  Estimated unoptimised what-if runtime is 203983.7646484375ms
2022-09-21 09:46:01 INFO  ---RUNTIME: Multi-Query Optimization took 97.34821319580078 ms
2022-09-21 09:46:01 INFO  Executing generated plans
2022-09-21 09:49:26 INFO  ---RUNTIME: Execution took 204650.95806121826 ms
2022-09-21 09:49:26 INFO  Done!
2022-09-21 09:49:26 INFO  # Finished -- repetition 5 of 7 
2022-09-21 09:49:26 INFO  # Optimization benchmark for data_cleaning with args [['reviews', 'slow_loading', 'featurization_0', 'neural_network']] -- repetition 6 of 7
2022-09-21 09:49:26 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-21 09:49:26 INFO  Running instrumented original pipeline...
2022-09-21 09:49:26 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-21 09:49:26 INFO  ---RUNTIME: Importing and monkey-patching took 5.789041519165039 ms
2022-09-21 09:49:36 INFO  ---RUNTIME: Original pipeline execution took 10396.73376083374 ms (excluding imports and monkey-patching)
2022-09-21 09:49:36 INFO  Starting execution of 1 what-if analyses...
2022-09-21 09:49:36 INFO  Start plan generation for analysis DataCleaning...
2022-09-21 09:49:36 INFO  ---RUNTIME: Plan generation took 0.5559921264648438 ms
2022-09-21 09:49:36 INFO  Estimated runtime of original DAG is 8716.992616653442ms
2022-09-21 09:49:36 INFO  Performing Multi-Query Optimization
2022-09-21 09:49:36 INFO  Estimated unoptimized what-if runtime is 174339.85233306885ms
2022-09-21 09:49:36 INFO  Estimated optimised what-if runtime is 84591.52936935425ms
2022-09-21 09:49:36 INFO  Estimated optimisation runtime saving is 89748.3229637146ms
2022-09-21 09:49:36 INFO  ---RUNTIME: Multi-Query Optimization took 84.44809913635254 ms
2022-09-21 09:49:36 INFO  Executing generated plans
2022-09-21 09:51:17 INFO  ---RUNTIME: Execution took 100231.4682006836 ms
2022-09-21 09:51:17 INFO  Done!
2022-09-21 09:51:17 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-21 09:51:17 INFO  Running instrumented original pipeline...
2022-09-21 09:51:17 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-21 09:51:17 INFO  ---RUNTIME: Importing and monkey-patching took 7.899284362792969 ms
2022-09-21 09:51:29 INFO  ---RUNTIME: Original pipeline execution took 11901.856184005737 ms (excluding imports and monkey-patching)
2022-09-21 09:51:29 INFO  Starting execution of 1 what-if analyses...
2022-09-21 09:51:29 INFO  Start plan generation for analysis DataCleaning...
2022-09-21 09:51:29 INFO  ---RUNTIME: Plan generation took 0.4875659942626953 ms
2022-09-21 09:51:29 INFO  Estimated runtime of original DAG is 10142.577648162842ms
2022-09-21 09:51:29 WARNING Skipping Multi-Query Optimization (instead, only combine execution DAGs)
2022-09-21 09:51:29 WARNING Columns ['review_id'] not present in train DAG after the train test split, only before!
2022-09-21 09:51:29 WARNING This could hint at data leakage!
2022-09-21 09:51:29 INFO  Estimated unoptimised what-if runtime is 202851.55296325684ms
2022-09-21 09:51:29 INFO  ---RUNTIME: Multi-Query Optimization took 710.8194828033447 ms
2022-09-21 09:51:29 INFO  Executing generated plans
2022-09-21 09:54:55 INFO  ---RUNTIME: Execution took 206075.4690170288 ms
2022-09-21 09:54:55 INFO  Done!
2022-09-21 09:54:55 INFO  # Finished -- repetition 6 of 7 
2022-09-21 09:54:55 INFO  # Optimization benchmark for data_cleaning with args [['reviews', 'slow_loading', 'featurization_0', 'neural_network']] -- repetition 7 of 7
2022-09-21 09:54:55 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-21 09:54:55 INFO  Running instrumented original pipeline...
2022-09-21 09:54:55 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-21 09:54:55 INFO  ---RUNTIME: Importing and monkey-patching took 5.827426910400391 ms
2022-09-21 09:55:06 INFO  ---RUNTIME: Original pipeline execution took 10401.994228363037 ms (excluding imports and monkey-patching)
2022-09-21 09:55:06 INFO  Starting execution of 1 what-if analyses...
2022-09-21 09:55:06 INFO  Start plan generation for analysis DataCleaning...
2022-09-21 09:55:06 INFO  ---RUNTIME: Plan generation took 0.5068778991699219 ms
2022-09-21 09:55:06 INFO  Estimated runtime of original DAG is 8707.461595535278ms
2022-09-21 09:55:06 INFO  Performing Multi-Query Optimization
2022-09-21 09:55:06 INFO  Estimated unoptimized what-if runtime is 174149.23191070557ms
2022-09-21 09:55:06 INFO  Estimated optimised what-if runtime is 84248.93927574158ms
2022-09-21 09:55:06 INFO  Estimated optimisation runtime saving is 89900.29263496399ms
2022-09-21 09:55:06 INFO  ---RUNTIME: Multi-Query Optimization took 85.21246910095215 ms
2022-09-21 09:55:06 INFO  Executing generated plans
2022-09-21 09:56:48 INFO  ---RUNTIME: Execution took 101738.64698410034 ms
2022-09-21 09:56:48 INFO  Done!
2022-09-21 09:56:48 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-21 09:56:48 INFO  Running instrumented original pipeline...
2022-09-21 09:56:48 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-21 09:56:48 INFO  ---RUNTIME: Importing and monkey-patching took 5.950450897216797 ms
2022-09-21 09:56:58 INFO  ---RUNTIME: Original pipeline execution took 10790.696620941162 ms (excluding imports and monkey-patching)
2022-09-21 09:56:58 INFO  Starting execution of 1 what-if analyses...
2022-09-21 09:56:58 INFO  Start plan generation for analysis DataCleaning...
2022-09-21 09:56:58 INFO  ---RUNTIME: Plan generation took 0.49948692321777344 ms
2022-09-21 09:56:58 INFO  Estimated runtime of original DAG is 9085.373163223267ms
2022-09-21 09:56:58 WARNING Skipping Multi-Query Optimization (instead, only combine execution DAGs)
2022-09-21 09:56:58 WARNING Columns ['review_id'] not present in train DAG after the train test split, only before!
2022-09-21 09:56:58 WARNING This could hint at data leakage!
2022-09-21 09:56:59 INFO  Estimated unoptimised what-if runtime is 181707.46326446533ms
2022-09-21 09:56:59 INFO  ---RUNTIME: Multi-Query Optimization took 96.82846069335938 ms
2022-09-21 09:56:59 INFO  Executing generated plans
2022-09-21 10:00:27 INFO  ---RUNTIME: Execution took 208164.79420661926 ms
2022-09-21 10:00:27 INFO  Done!
2022-09-21 10:00:27 INFO  # Finished -- repetition 7 of 7 
2022-09-21 10:00:27 INFO  # Final results after all repetitions
2022-09-21 10:00:27 INFO     repetition  ... no_opt_what_if_execution_combined_model_training
0           0  ...                                     64233.848333
1           1  ...                                     64313.842058
2           2  ...                                     64113.064528
3           3  ...                                     70754.374743
4           4  ...                                     62732.248783
5           5  ...                                     67377.842665
6           6  ...                                     70567.538977

[7 rows x 26 columns]
taskset -c 160-168 PROTOCOL_BUFFERS_PYTHON_IMPLEMENTATION=python python3.9 benchmarks_end_to_end.py data_cleaning reviews slow_loading featurization_1 logistic_regression
2022-09-21 10:00:29.919418: W tensorflow/stream_executor/platform/default/dso_loader.cc:64] Could not load dynamic library 'libcudart.so.11.0'; dlerror: libcudart.so.11.0: cannot open shared object file: No such file or directory; LD_LIBRARY_PATH: /home/sgrafbe/mlwhatif/venv/lib/python3.9/site-packages/cv2/../../lib64:
2022-09-21 10:00:29.919467: I tensorflow/stream_executor/cuda/cudart_stub.cc:29] Ignore above cudart dlerror if you do not have a GPU set up on your machine.
2022-09-21 10:00:31 INFO  Patching sys.argv with ['mlwhatif', 'reviews', 'slow_loading', 'featurization_1', 'logistic_regression']
2022-09-21 10:00:31 INFO  Running instrumented original pipeline...
2022-09-21 10:00:31 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-21 10:00:31 INFO  ---RUNTIME: Importing and monkey-patching took 132.11297988891602 ms
2022-09-21 10:00:39 INFO  ---RUNTIME: Original pipeline execution took 7840.331077575684 ms (excluding imports and monkey-patching)
2022-09-21 10:00:39 INFO  Starting execution of 0 what-if analyses...
2022-09-21 10:00:39 INFO  Estimated runtime of original DAG is 5568.7994956970215ms
2022-09-21 10:00:39 INFO  Performing Multi-Query Optimization
2022-09-21 10:00:39 INFO  Estimated unoptimized what-if runtime is 0ms
2022-09-21 10:00:39 INFO  Estimated optimised what-if runtime is 0ms
2022-09-21 10:00:39 INFO  Estimated optimisation runtime saving is 0ms
2022-09-21 10:00:39 INFO  ---RUNTIME: Multi-Query Optimization took 0.5934238433837891 ms
2022-09-21 10:00:39 INFO  Executing generated plans
2022-09-21 10:00:39 INFO  ---RUNTIME: Execution took 0.028848648071289062 ms
2022-09-21 10:00:39 INFO  Done!
2022-09-21 10:00:39 INFO  # Optimization benchmark for data_cleaning with args [['reviews', 'slow_loading', 'featurization_1', 'logistic_regression']] -- repetition 1 of 7
2022-09-21 10:00:39 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-21 10:00:39 INFO  Running instrumented original pipeline...
2022-09-21 10:00:39 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-21 10:00:39 INFO  ---RUNTIME: Importing and monkey-patching took 6.397485733032227 ms
2022-09-21 10:00:46 INFO  ---RUNTIME: Original pipeline execution took 7679.046392440796 ms (excluding imports and monkey-patching)
2022-09-21 10:00:46 INFO  Starting execution of 1 what-if analyses...
2022-09-21 10:00:46 INFO  Start plan generation for analysis DataCleaning...
2022-09-21 10:00:46 INFO  ---RUNTIME: Plan generation took 0.7407665252685547 ms
2022-09-21 10:00:46 INFO  Estimated runtime of original DAG is 5316.664695739746ms
2022-09-21 10:00:46 INFO  Performing Multi-Query Optimization
2022-09-21 10:00:46 INFO  Estimated unoptimized what-if runtime is 106333.29391479492ms
2022-09-21 10:00:46 INFO  Estimated optimised what-if runtime is 19187.288522720337ms
2022-09-21 10:00:46 INFO  Estimated optimisation runtime saving is 87146.00539207458ms
2022-09-21 10:00:46 INFO  ---RUNTIME: Multi-Query Optimization took 93.39070320129395 ms
2022-09-21 10:00:46 INFO  Executing generated plans
2022-09-21 10:01:12 INFO  ---RUNTIME: Execution took 25589.369535446167 ms
2022-09-21 10:01:12 INFO  Done!
2022-09-21 10:01:12 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-21 10:01:12 INFO  Running instrumented original pipeline...
2022-09-21 10:01:12 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-21 10:01:12 INFO  ---RUNTIME: Importing and monkey-patching took 6.306886672973633 ms
2022-09-21 10:01:20 INFO  ---RUNTIME: Original pipeline execution took 7566.309928894043 ms (excluding imports and monkey-patching)
2022-09-21 10:01:20 INFO  Starting execution of 1 what-if analyses...
2022-09-21 10:01:20 INFO  Start plan generation for analysis DataCleaning...
2022-09-21 10:01:20 INFO  ---RUNTIME: Plan generation took 0.7388591766357422 ms
2022-09-21 10:01:20 INFO  Estimated runtime of original DAG is 5338.221311569214ms
2022-09-21 10:01:20 WARNING Skipping Multi-Query Optimization (instead, only combine execution DAGs)
2022-09-21 10:01:20 WARNING Columns ['review_id'] not present in train DAG after the train test split, only before!
2022-09-21 10:01:20 WARNING This could hint at data leakage!
2022-09-21 10:01:20 INFO  Estimated unoptimised what-if runtime is 106764.42623138428ms
2022-09-21 10:01:20 INFO  ---RUNTIME: Multi-Query Optimization took 106.56070709228516 ms
2022-09-21 10:01:20 INFO  Executing generated plans
2022-09-21 10:03:33 INFO  ---RUNTIME: Execution took 133348.23155403137 ms
2022-09-21 10:03:33 INFO  Done!
2022-09-21 10:03:33 INFO  # Finished -- repetition 1 of 7 
2022-09-21 10:03:33 INFO  # Optimization benchmark for data_cleaning with args [['reviews', 'slow_loading', 'featurization_1', 'logistic_regression']] -- repetition 2 of 7
2022-09-21 10:03:33 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-21 10:03:33 INFO  Running instrumented original pipeline...
2022-09-21 10:03:33 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-21 10:03:33 INFO  ---RUNTIME: Importing and monkey-patching took 10.581731796264648 ms
2022-09-21 10:03:43 INFO  ---RUNTIME: Original pipeline execution took 10260.94388961792 ms (excluding imports and monkey-patching)
2022-09-21 10:03:43 INFO  Starting execution of 1 what-if analyses...
2022-09-21 10:03:43 INFO  Start plan generation for analysis DataCleaning...
2022-09-21 10:03:43 INFO  ---RUNTIME: Plan generation took 0.7302761077880859 ms
2022-09-21 10:03:43 INFO  Estimated runtime of original DAG is 6942.375898361206ms
2022-09-21 10:03:43 INFO  Performing Multi-Query Optimization
2022-09-21 10:03:43 INFO  Estimated unoptimized what-if runtime is 138847.51796722412ms
2022-09-21 10:03:43 INFO  Estimated optimised what-if runtime is 23856.156587600708ms
2022-09-21 10:03:43 INFO  Estimated optimisation runtime saving is 114991.36137962341ms
2022-09-21 10:03:43 INFO  ---RUNTIME: Multi-Query Optimization took 93.25194358825684 ms
2022-09-21 10:03:43 INFO  Executing generated plans
2022-09-21 10:04:09 INFO  ---RUNTIME: Execution took 25635.441303253174 ms
2022-09-21 10:04:09 INFO  Done!
2022-09-21 10:04:09 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-21 10:04:09 INFO  Running instrumented original pipeline...
2022-09-21 10:04:09 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-21 10:04:09 INFO  ---RUNTIME: Importing and monkey-patching took 5.695104598999023 ms
2022-09-21 10:04:17 INFO  ---RUNTIME: Original pipeline execution took 7535.026788711548 ms (excluding imports and monkey-patching)
2022-09-21 10:04:17 INFO  Starting execution of 1 what-if analyses...
2022-09-21 10:04:17 INFO  Start plan generation for analysis DataCleaning...
2022-09-21 10:04:17 INFO  ---RUNTIME: Plan generation took 0.7152557373046875 ms
2022-09-21 10:04:17 INFO  Estimated runtime of original DAG is 5282.938003540039ms
2022-09-21 10:04:17 WARNING Skipping Multi-Query Optimization (instead, only combine execution DAGs)
2022-09-21 10:04:17 WARNING Columns ['review_id'] not present in train DAG after the train test split, only before!
2022-09-21 10:04:17 WARNING This could hint at data leakage!
2022-09-21 10:04:17 INFO  Estimated unoptimised what-if runtime is 105658.76007080078ms
2022-09-21 10:04:17 INFO  ---RUNTIME: Multi-Query Optimization took 313.10558319091797 ms
2022-09-21 10:04:17 INFO  Executing generated plans
2022-09-21 10:06:26 INFO  ---RUNTIME: Execution took 129078.0394077301 ms
2022-09-21 10:06:26 INFO  Done!
2022-09-21 10:06:26 INFO  # Finished -- repetition 2 of 7 
2022-09-21 10:06:26 INFO  # Optimization benchmark for data_cleaning with args [['reviews', 'slow_loading', 'featurization_1', 'logistic_regression']] -- repetition 3 of 7
2022-09-21 10:06:26 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-21 10:06:26 INFO  Running instrumented original pipeline...
2022-09-21 10:06:26 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-21 10:06:26 INFO  ---RUNTIME: Importing and monkey-patching took 6.454706192016602 ms
2022-09-21 10:06:34 INFO  ---RUNTIME: Original pipeline execution took 7763.843774795532 ms (excluding imports and monkey-patching)
2022-09-21 10:06:34 INFO  Starting execution of 1 what-if analyses...
2022-09-21 10:06:34 INFO  Start plan generation for analysis DataCleaning...
2022-09-21 10:06:34 INFO  ---RUNTIME: Plan generation took 0.7193088531494141 ms
2022-09-21 10:06:34 INFO  Estimated runtime of original DAG is 5479.117631912231ms
2022-09-21 10:06:34 INFO  Performing Multi-Query Optimization
2022-09-21 10:06:34 INFO  Estimated unoptimized what-if runtime is 109582.35263824463ms
2022-09-21 10:06:34 INFO  Estimated optimised what-if runtime is 19274.39022064209ms
2022-09-21 10:06:34 INFO  Estimated optimisation runtime saving is 90307.96241760254ms
2022-09-21 10:06:34 INFO  ---RUNTIME: Multi-Query Optimization took 92.2856330871582 ms
2022-09-21 10:06:34 INFO  Executing generated plans
2022-09-21 10:07:05 INFO  ---RUNTIME: Execution took 31130.50365447998 ms
2022-09-21 10:07:05 INFO  Done!
2022-09-21 10:07:05 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-21 10:07:05 INFO  Running instrumented original pipeline...
2022-09-21 10:07:05 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-21 10:07:05 INFO  ---RUNTIME: Importing and monkey-patching took 5.969047546386719 ms
2022-09-21 10:07:13 INFO  ---RUNTIME: Original pipeline execution took 8035.788536071777 ms (excluding imports and monkey-patching)
2022-09-21 10:07:13 INFO  Starting execution of 1 what-if analyses...
2022-09-21 10:07:13 INFO  Start plan generation for analysis DataCleaning...
2022-09-21 10:07:13 INFO  ---RUNTIME: Plan generation took 0.7100105285644531 ms
2022-09-21 10:07:13 INFO  Estimated runtime of original DAG is 5762.725830078125ms
2022-09-21 10:07:13 WARNING Skipping Multi-Query Optimization (instead, only combine execution DAGs)
2022-09-21 10:07:13 WARNING Columns ['review_id'] not present in train DAG after the train test split, only before!
2022-09-21 10:07:13 WARNING This could hint at data leakage!
2022-09-21 10:07:13 INFO  Estimated unoptimised what-if runtime is 115254.5166015625ms
2022-09-21 10:07:13 INFO  ---RUNTIME: Multi-Query Optimization took 108.38651657104492 ms
2022-09-21 10:07:13 INFO  Executing generated plans
2022-09-21 10:09:28 INFO  ---RUNTIME: Execution took 134501.95407867432 ms
2022-09-21 10:09:28 INFO  Done!
2022-09-21 10:09:28 INFO  # Finished -- repetition 3 of 7 
2022-09-21 10:09:28 INFO  # Optimization benchmark for data_cleaning with args [['reviews', 'slow_loading', 'featurization_1', 'logistic_regression']] -- repetition 4 of 7
2022-09-21 10:09:28 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-21 10:09:28 INFO  Running instrumented original pipeline...
2022-09-21 10:09:28 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-21 10:09:28 INFO  ---RUNTIME: Importing and monkey-patching took 6.56580924987793 ms
2022-09-21 10:09:35 INFO  ---RUNTIME: Original pipeline execution took 7643.204927444458 ms (excluding imports and monkey-patching)
2022-09-21 10:09:35 INFO  Starting execution of 1 what-if analyses...
2022-09-21 10:09:35 INFO  Start plan generation for analysis DataCleaning...
2022-09-21 10:09:35 INFO  ---RUNTIME: Plan generation took 0.7100105285644531 ms
2022-09-21 10:09:35 INFO  Estimated runtime of original DAG is 5341.64834022522ms
2022-09-21 10:09:35 INFO  Performing Multi-Query Optimization
2022-09-21 10:09:35 INFO  Estimated unoptimized what-if runtime is 106832.9668045044ms
2022-09-21 10:09:35 INFO  Estimated optimised what-if runtime is 19116.896867752075ms
2022-09-21 10:09:35 INFO  Estimated optimisation runtime saving is 87716.06993675232ms
2022-09-21 10:09:35 INFO  ---RUNTIME: Multi-Query Optimization took 93.06573867797852 ms
2022-09-21 10:09:35 INFO  Executing generated plans
2022-09-21 10:10:06 INFO  ---RUNTIME: Execution took 30395.343542099 ms
2022-09-21 10:10:06 INFO  Done!
2022-09-21 10:10:06 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-21 10:10:06 INFO  Running instrumented original pipeline...
2022-09-21 10:10:06 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-21 10:10:06 INFO  ---RUNTIME: Importing and monkey-patching took 8.716583251953125 ms
2022-09-21 10:10:15 INFO  ---RUNTIME: Original pipeline execution took 9068.8157081604 ms (excluding imports and monkey-patching)
2022-09-21 10:10:15 INFO  Starting execution of 1 what-if analyses...
2022-09-21 10:10:15 INFO  Start plan generation for analysis DataCleaning...
2022-09-21 10:10:15 INFO  ---RUNTIME: Plan generation took 0.7317066192626953 ms
2022-09-21 10:10:15 INFO  Estimated runtime of original DAG is 6204.04314994812ms
2022-09-21 10:10:15 WARNING Skipping Multi-Query Optimization (instead, only combine execution DAGs)
2022-09-21 10:10:15 WARNING Columns ['review_id'] not present in train DAG after the train test split, only before!
2022-09-21 10:10:15 WARNING This could hint at data leakage!
2022-09-21 10:10:15 INFO  Estimated unoptimised what-if runtime is 124080.8629989624ms
2022-09-21 10:10:15 INFO  ---RUNTIME: Multi-Query Optimization took 108.38747024536133 ms
2022-09-21 10:10:15 INFO  Executing generated plans
2022-09-21 10:12:29 INFO  ---RUNTIME: Execution took 134335.68358421326 ms
2022-09-21 10:12:29 INFO  Done!
2022-09-21 10:12:29 INFO  # Finished -- repetition 4 of 7 
2022-09-21 10:12:29 INFO  # Optimization benchmark for data_cleaning with args [['reviews', 'slow_loading', 'featurization_1', 'logistic_regression']] -- repetition 5 of 7
2022-09-21 10:12:29 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-21 10:12:29 INFO  Running instrumented original pipeline...
2022-09-21 10:12:30 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-21 10:12:30 INFO  ---RUNTIME: Importing and monkey-patching took 10.841131210327148 ms
2022-09-21 10:12:39 INFO  ---RUNTIME: Original pipeline execution took 9683.261394500732 ms (excluding imports and monkey-patching)
2022-09-21 10:12:39 INFO  Starting execution of 1 what-if analyses...
2022-09-21 10:12:39 INFO  Start plan generation for analysis DataCleaning...
2022-09-21 10:12:39 INFO  ---RUNTIME: Plan generation took 0.6799697875976562 ms
2022-09-21 10:12:39 INFO  Estimated runtime of original DAG is 7047.081470489502ms
2022-09-21 10:12:39 INFO  Performing Multi-Query Optimization
2022-09-21 10:12:39 INFO  Estimated unoptimized what-if runtime is 140941.62940979004ms
2022-09-21 10:12:39 INFO  Estimated optimised what-if runtime is 20933.985710144043ms
2022-09-21 10:12:39 INFO  Estimated optimisation runtime saving is 120007.643699646ms
2022-09-21 10:12:39 INFO  ---RUNTIME: Multi-Query Optimization took 94.37394142150879 ms
2022-09-21 10:12:39 INFO  Executing generated plans
2022-09-21 10:13:05 INFO  ---RUNTIME: Execution took 25785.52007675171 ms
2022-09-21 10:13:05 INFO  Done!
2022-09-21 10:13:05 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-21 10:13:05 INFO  Running instrumented original pipeline...
2022-09-21 10:13:05 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-21 10:13:05 INFO  ---RUNTIME: Importing and monkey-patching took 5.960702896118164 ms
2022-09-21 10:13:13 INFO  ---RUNTIME: Original pipeline execution took 7701.135873794556 ms (excluding imports and monkey-patching)
2022-09-21 10:13:13 INFO  Starting execution of 1 what-if analyses...
2022-09-21 10:13:13 INFO  Start plan generation for analysis DataCleaning...
2022-09-21 10:13:13 INFO  ---RUNTIME: Plan generation took 0.6284713745117188 ms
2022-09-21 10:13:13 INFO  Estimated runtime of original DAG is 5354.802131652832ms
2022-09-21 10:13:13 WARNING Skipping Multi-Query Optimization (instead, only combine execution DAGs)
2022-09-21 10:13:13 WARNING Columns ['review_id'] not present in train DAG after the train test split, only before!
2022-09-21 10:13:13 WARNING This could hint at data leakage!
2022-09-21 10:13:13 INFO  Estimated unoptimised what-if runtime is 107096.04263305664ms
2022-09-21 10:13:13 INFO  ---RUNTIME: Multi-Query Optimization took 108.86192321777344 ms
2022-09-21 10:13:13 INFO  Executing generated plans
2022-09-21 10:15:25 INFO  ---RUNTIME: Execution took 132554.76307868958 ms
2022-09-21 10:15:25 INFO  Done!
2022-09-21 10:15:25 INFO  # Finished -- repetition 5 of 7 
2022-09-21 10:15:25 INFO  # Optimization benchmark for data_cleaning with args [['reviews', 'slow_loading', 'featurization_1', 'logistic_regression']] -- repetition 6 of 7
2022-09-21 10:15:25 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-21 10:15:25 INFO  Running instrumented original pipeline...
2022-09-21 10:15:25 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-21 10:15:25 INFO  ---RUNTIME: Importing and monkey-patching took 6.785869598388672 ms
2022-09-21 10:15:33 INFO  ---RUNTIME: Original pipeline execution took 7721.937894821167 ms (excluding imports and monkey-patching)
2022-09-21 10:15:33 INFO  Starting execution of 1 what-if analyses...
2022-09-21 10:15:33 INFO  Start plan generation for analysis DataCleaning...
2022-09-21 10:15:33 INFO  ---RUNTIME: Plan generation took 0.6880760192871094 ms
2022-09-21 10:15:33 INFO  Estimated runtime of original DAG is 5405.275821685791ms
2022-09-21 10:15:33 INFO  Performing Multi-Query Optimization
2022-09-21 10:15:33 INFO  Estimated unoptimized what-if runtime is 108105.51643371582ms
2022-09-21 10:15:33 INFO  Estimated optimised what-if runtime is 19339.414596557617ms
2022-09-21 10:15:33 INFO  Estimated optimisation runtime saving is 88766.1018371582ms
2022-09-21 10:15:33 INFO  ---RUNTIME: Multi-Query Optimization took 93.98436546325684 ms
2022-09-21 10:15:33 INFO  Executing generated plans
2022-09-21 10:15:59 INFO  ---RUNTIME: Execution took 25728.06668281555 ms
2022-09-21 10:15:59 INFO  Done!
2022-09-21 10:15:59 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-21 10:15:59 INFO  Running instrumented original pipeline...
2022-09-21 10:15:59 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-21 10:15:59 INFO  ---RUNTIME: Importing and monkey-patching took 5.856752395629883 ms
2022-09-21 10:16:07 INFO  ---RUNTIME: Original pipeline execution took 7590.2159214019775 ms (excluding imports and monkey-patching)
2022-09-21 10:16:07 INFO  Starting execution of 1 what-if analyses...
2022-09-21 10:16:07 INFO  Start plan generation for analysis DataCleaning...
2022-09-21 10:16:07 INFO  ---RUNTIME: Plan generation took 0.7338523864746094 ms
2022-09-21 10:16:07 INFO  Estimated runtime of original DAG is 5306.008577346802ms
2022-09-21 10:16:07 WARNING Skipping Multi-Query Optimization (instead, only combine execution DAGs)
2022-09-21 10:16:07 WARNING Columns ['review_id'] not present in train DAG after the train test split, only before!
2022-09-21 10:16:07 WARNING This could hint at data leakage!
2022-09-21 10:16:07 INFO  Estimated unoptimised what-if runtime is 106120.17154693604ms
2022-09-21 10:16:07 INFO  ---RUNTIME: Multi-Query Optimization took 378.42440605163574 ms
2022-09-21 10:16:07 INFO  Executing generated plans
2022-09-21 10:18:20 INFO  ---RUNTIME: Execution took 133329.02789115906 ms
2022-09-21 10:18:20 INFO  Done!
2022-09-21 10:18:20 INFO  # Finished -- repetition 6 of 7 
2022-09-21 10:18:20 INFO  # Optimization benchmark for data_cleaning with args [['reviews', 'slow_loading', 'featurization_1', 'logistic_regression']] -- repetition 7 of 7
2022-09-21 10:18:20 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-21 10:18:20 INFO  Running instrumented original pipeline...
2022-09-21 10:18:20 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-21 10:18:20 INFO  ---RUNTIME: Importing and monkey-patching took 6.432533264160156 ms
2022-09-21 10:18:29 INFO  ---RUNTIME: Original pipeline execution took 8366.647720336914 ms (excluding imports and monkey-patching)
2022-09-21 10:18:29 INFO  Starting execution of 1 what-if analyses...
2022-09-21 10:18:29 INFO  Start plan generation for analysis DataCleaning...
2022-09-21 10:18:29 INFO  ---RUNTIME: Plan generation took 0.7009506225585938 ms
2022-09-21 10:18:29 INFO  Estimated runtime of original DAG is 6032.631397247314ms
2022-09-21 10:18:29 INFO  Performing Multi-Query Optimization
2022-09-21 10:18:29 INFO  Estimated unoptimized what-if runtime is 120652.62794494629ms
2022-09-21 10:18:29 INFO  Estimated optimised what-if runtime is 19792.01602935791ms
2022-09-21 10:18:29 INFO  Estimated optimisation runtime saving is 100860.61191558838ms
2022-09-21 10:18:29 INFO  ---RUNTIME: Multi-Query Optimization took 91.90487861633301 ms
2022-09-21 10:18:29 INFO  Executing generated plans
2022-09-21 10:18:56 INFO  ---RUNTIME: Execution took 27370.65601348877 ms
2022-09-21 10:18:56 INFO  Done!
2022-09-21 10:18:56 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-21 10:18:56 INFO  Running instrumented original pipeline...
2022-09-21 10:18:56 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-21 10:18:56 INFO  ---RUNTIME: Importing and monkey-patching took 6.189823150634766 ms
2022-09-21 10:19:04 INFO  ---RUNTIME: Original pipeline execution took 8085.075616836548 ms (excluding imports and monkey-patching)
2022-09-21 10:19:04 INFO  Starting execution of 1 what-if analyses...
2022-09-21 10:19:04 INFO  Start plan generation for analysis DataCleaning...
2022-09-21 10:19:04 INFO  ---RUNTIME: Plan generation took 0.7026195526123047 ms
2022-09-21 10:19:04 INFO  Estimated runtime of original DAG is 5631.564140319824ms
2022-09-21 10:19:04 WARNING Skipping Multi-Query Optimization (instead, only combine execution DAGs)
2022-09-21 10:19:04 WARNING Columns ['review_id'] not present in train DAG after the train test split, only before!
2022-09-21 10:19:04 WARNING This could hint at data leakage!
2022-09-21 10:19:04 INFO  Estimated unoptimised what-if runtime is 112631.28280639648ms
2022-09-21 10:19:04 INFO  ---RUNTIME: Multi-Query Optimization took 111.33337020874023 ms
2022-09-21 10:19:04 INFO  Executing generated plans
2022-09-21 10:21:16 INFO  ---RUNTIME: Execution took 131896.9442844391 ms
2022-09-21 10:21:16 INFO  Done!
2022-09-21 10:21:16 INFO  # Finished -- repetition 7 of 7 
2022-09-21 10:21:16 INFO  # Final results after all repetitions
2022-09-21 10:21:16 INFO     repetition  ... no_opt_what_if_execution_combined_model_training
0           0  ...                                      4708.614588
1           1  ...                                      2535.911798
2           2  ...                                      2907.086611
3           3  ...                                      4688.621759
4           4  ...                                      2507.485390
5           5  ...                                      2541.055441
6           6  ...                                      2520.666122

[7 rows x 26 columns]
taskset -c 160-168 PROTOCOL_BUFFERS_PYTHON_IMPLEMENTATION=python python3.9 benchmarks_end_to_end.py data_cleaning reviews slow_loading featurization_1 xgboost
2022-09-21 10:21:19.011067: W tensorflow/stream_executor/platform/default/dso_loader.cc:64] Could not load dynamic library 'libcudart.so.11.0'; dlerror: libcudart.so.11.0: cannot open shared object file: No such file or directory; LD_LIBRARY_PATH: /home/sgrafbe/mlwhatif/venv/lib/python3.9/site-packages/cv2/../../lib64:
2022-09-21 10:21:19.011121: I tensorflow/stream_executor/cuda/cudart_stub.cc:29] Ignore above cudart dlerror if you do not have a GPU set up on your machine.
2022-09-21 10:21:20 INFO  Patching sys.argv with ['mlwhatif', 'reviews', 'slow_loading', 'featurization_1', 'xgboost']
2022-09-21 10:21:20 INFO  Running instrumented original pipeline...
2022-09-21 10:21:20 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-21 10:21:20 INFO  ---RUNTIME: Importing and monkey-patching took 121.21081352233887 ms
2022-09-21 10:21:39 INFO  ---RUNTIME: Original pipeline execution took 18870.220184326172 ms (excluding imports and monkey-patching)
2022-09-21 10:21:39 INFO  Starting execution of 0 what-if analyses...
2022-09-21 10:21:39 INFO  Estimated runtime of original DAG is 16635.59126853943ms
2022-09-21 10:21:39 INFO  Performing Multi-Query Optimization
2022-09-21 10:21:39 INFO  Estimated unoptimized what-if runtime is 0ms
2022-09-21 10:21:39 INFO  Estimated optimised what-if runtime is 0ms
2022-09-21 10:21:39 INFO  Estimated optimisation runtime saving is 0ms
2022-09-21 10:21:39 INFO  ---RUNTIME: Multi-Query Optimization took 0.5259513854980469 ms
2022-09-21 10:21:39 INFO  Executing generated plans
2022-09-21 10:21:39 INFO  ---RUNTIME: Execution took 0.027894973754882812 ms
2022-09-21 10:21:39 INFO  Done!
2022-09-21 10:21:39 INFO  # Optimization benchmark for data_cleaning with args [['reviews', 'slow_loading', 'featurization_1', 'xgboost']] -- repetition 1 of 7
2022-09-21 10:21:39 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-21 10:21:39 INFO  Running instrumented original pipeline...
2022-09-21 10:21:39 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-21 10:21:39 INFO  ---RUNTIME: Importing and monkey-patching took 6.264448165893555 ms
2022-09-21 10:21:47 INFO  ---RUNTIME: Original pipeline execution took 8371.397972106934 ms (excluding imports and monkey-patching)
2022-09-21 10:21:47 INFO  Starting execution of 1 what-if analyses...
2022-09-21 10:21:47 INFO  Start plan generation for analysis DataCleaning...
2022-09-21 10:21:47 INFO  ---RUNTIME: Plan generation took 0.7023811340332031 ms
2022-09-21 10:21:47 INFO  Estimated runtime of original DAG is 6004.916191101074ms
2022-09-21 10:21:47 INFO  Performing Multi-Query Optimization
2022-09-21 10:21:47 INFO  Estimated unoptimized what-if runtime is 120098.32382202148ms
2022-09-21 10:21:47 INFO  Estimated optimised what-if runtime is 33770.758867263794ms
2022-09-21 10:21:47 INFO  Estimated optimisation runtime saving is 86327.56495475769ms
2022-09-21 10:21:47 INFO  ---RUNTIME: Multi-Query Optimization took 92.48638153076172 ms
2022-09-21 10:21:47 INFO  Executing generated plans
2022-09-21 10:22:31 INFO  ---RUNTIME: Execution took 43403.27024459839 ms
2022-09-21 10:22:31 INFO  Done!
2022-09-21 10:22:31 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-21 10:22:31 INFO  Running instrumented original pipeline...
2022-09-21 10:22:31 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-21 10:22:31 INFO  ---RUNTIME: Importing and monkey-patching took 6.6318511962890625 ms
2022-09-21 10:22:39 INFO  ---RUNTIME: Original pipeline execution took 8688.942670822144 ms (excluding imports and monkey-patching)
2022-09-21 10:22:39 INFO  Starting execution of 1 what-if analyses...
2022-09-21 10:22:39 INFO  Start plan generation for analysis DataCleaning...
2022-09-21 10:22:39 INFO  ---RUNTIME: Plan generation took 0.9343624114990234 ms
2022-09-21 10:22:39 INFO  Estimated runtime of original DAG is 6330.402612686157ms
2022-09-21 10:22:39 WARNING Skipping Multi-Query Optimization (instead, only combine execution DAGs)
2022-09-21 10:22:39 WARNING Columns ['review_id'] not present in train DAG after the train test split, only before!
2022-09-21 10:22:39 WARNING This could hint at data leakage!
2022-09-21 10:22:39 INFO  Estimated unoptimised what-if runtime is 126608.05225372314ms
2022-09-21 10:22:39 INFO  ---RUNTIME: Multi-Query Optimization took 107.7883243560791 ms
2022-09-21 10:22:39 INFO  Executing generated plans
2022-09-21 10:25:13 INFO  ---RUNTIME: Execution took 153441.19381904602 ms
2022-09-21 10:25:13 INFO  Done!
2022-09-21 10:25:13 INFO  # Finished -- repetition 1 of 7 
2022-09-21 10:25:13 INFO  # Optimization benchmark for data_cleaning with args [['reviews', 'slow_loading', 'featurization_1', 'xgboost']] -- repetition 2 of 7
2022-09-21 10:25:13 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-21 10:25:13 INFO  Running instrumented original pipeline...
2022-09-21 10:25:13 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-21 10:25:13 INFO  ---RUNTIME: Importing and monkey-patching took 6.251811981201172 ms
2022-09-21 10:25:21 INFO  ---RUNTIME: Original pipeline execution took 8276.6695022583 ms (excluding imports and monkey-patching)
2022-09-21 10:25:21 INFO  Starting execution of 1 what-if analyses...
2022-09-21 10:25:21 INFO  Start plan generation for analysis DataCleaning...
2022-09-21 10:25:21 INFO  ---RUNTIME: Plan generation took 0.7147789001464844 ms
2022-09-21 10:25:21 INFO  Estimated runtime of original DAG is 6045.927047729492ms
2022-09-21 10:25:21 INFO  Performing Multi-Query Optimization
2022-09-21 10:25:21 INFO  Estimated unoptimized what-if runtime is 120918.54095458984ms
2022-09-21 10:25:21 INFO  Estimated optimised what-if runtime is 33667.542695999146ms
2022-09-21 10:25:21 INFO  Estimated optimisation runtime saving is 87250.9982585907ms
2022-09-21 10:25:21 INFO  ---RUNTIME: Multi-Query Optimization took 91.88365936279297 ms
2022-09-21 10:25:21 INFO  Executing generated plans
2022-09-21 10:26:03 INFO  ---RUNTIME: Execution took 41554.17251586914 ms
2022-09-21 10:26:03 INFO  Done!
2022-09-21 10:26:03 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-21 10:26:03 INFO  Running instrumented original pipeline...
2022-09-21 10:26:03 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-21 10:26:03 INFO  ---RUNTIME: Importing and monkey-patching took 6.018877029418945 ms
2022-09-21 10:26:11 INFO  ---RUNTIME: Original pipeline execution took 8267.430067062378 ms (excluding imports and monkey-patching)
2022-09-21 10:26:11 INFO  Starting execution of 1 what-if analyses...
2022-09-21 10:26:11 INFO  Start plan generation for analysis DataCleaning...
2022-09-21 10:26:11 INFO  ---RUNTIME: Plan generation took 0.7240772247314453 ms
2022-09-21 10:26:11 INFO  Estimated runtime of original DAG is 6034.95717048645ms
2022-09-21 10:26:11 WARNING Skipping Multi-Query Optimization (instead, only combine execution DAGs)
2022-09-21 10:26:11 WARNING Columns ['review_id'] not present in train DAG after the train test split, only before!
2022-09-21 10:26:11 WARNING This could hint at data leakage!
2022-09-21 10:26:11 INFO  Estimated unoptimised what-if runtime is 120699.143409729ms
2022-09-21 10:26:11 INFO  ---RUNTIME: Multi-Query Optimization took 314.12744522094727 ms
2022-09-21 10:26:11 INFO  Executing generated plans
2022-09-21 10:28:41 INFO  ---RUNTIME: Execution took 149165.43412208557 ms
2022-09-21 10:28:41 INFO  Done!
2022-09-21 10:28:41 INFO  # Finished -- repetition 2 of 7 
2022-09-21 10:28:41 INFO  # Optimization benchmark for data_cleaning with args [['reviews', 'slow_loading', 'featurization_1', 'xgboost']] -- repetition 3 of 7
2022-09-21 10:28:41 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-21 10:28:41 INFO  Running instrumented original pipeline...
2022-09-21 10:28:41 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-21 10:28:41 INFO  ---RUNTIME: Importing and monkey-patching took 6.290197372436523 ms
2022-09-21 10:28:50 INFO  ---RUNTIME: Original pipeline execution took 8958.430767059326 ms (excluding imports and monkey-patching)
2022-09-21 10:28:50 INFO  Starting execution of 1 what-if analyses...
2022-09-21 10:28:50 INFO  Start plan generation for analysis DataCleaning...
2022-09-21 10:28:50 INFO  ---RUNTIME: Plan generation took 0.7779598236083984 ms
2022-09-21 10:28:50 INFO  Estimated runtime of original DAG is 6692.520380020142ms
2022-09-21 10:28:50 INFO  Performing Multi-Query Optimization
2022-09-21 10:28:50 INFO  Estimated unoptimized what-if runtime is 133850.40760040283ms
2022-09-21 10:28:50 INFO  Estimated optimised what-if runtime is 34606.460094451904ms
2022-09-21 10:28:50 INFO  Estimated optimisation runtime saving is 99243.94750595093ms
2022-09-21 10:28:50 INFO  ---RUNTIME: Multi-Query Optimization took 92.02003479003906 ms
2022-09-21 10:28:50 INFO  Executing generated plans
2022-09-21 10:29:32 INFO  ---RUNTIME: Execution took 42746.28806114197 ms
2022-09-21 10:29:32 INFO  Done!
2022-09-21 10:29:32 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-21 10:29:32 INFO  Running instrumented original pipeline...
2022-09-21 10:29:32 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-21 10:29:32 INFO  ---RUNTIME: Importing and monkey-patching took 6.829977035522461 ms
2022-09-21 10:29:41 INFO  ---RUNTIME: Original pipeline execution took 8753.75485420227 ms (excluding imports and monkey-patching)
2022-09-21 10:29:41 INFO  Starting execution of 1 what-if analyses...
2022-09-21 10:29:41 INFO  Start plan generation for analysis DataCleaning...
2022-09-21 10:29:41 INFO  ---RUNTIME: Plan generation took 0.8296966552734375 ms
2022-09-21 10:29:41 INFO  Estimated runtime of original DAG is 6307.342052459717ms
2022-09-21 10:29:41 WARNING Skipping Multi-Query Optimization (instead, only combine execution DAGs)
2022-09-21 10:29:41 WARNING Columns ['review_id'] not present in train DAG after the train test split, only before!
2022-09-21 10:29:41 WARNING This could hint at data leakage!
2022-09-21 10:29:41 INFO  Estimated unoptimised what-if runtime is 126146.84104919434ms
2022-09-21 10:29:41 INFO  ---RUNTIME: Multi-Query Optimization took 114.09854888916016 ms
2022-09-21 10:29:41 INFO  Executing generated plans
2022-09-21 10:32:08 INFO  ---RUNTIME: Execution took 146987.0092868805 ms
2022-09-21 10:32:08 INFO  Done!
2022-09-21 10:32:08 INFO  # Finished -- repetition 3 of 7 
2022-09-21 10:32:08 INFO  # Optimization benchmark for data_cleaning with args [['reviews', 'slow_loading', 'featurization_1', 'xgboost']] -- repetition 4 of 7
2022-09-21 10:32:08 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-21 10:32:08 INFO  Running instrumented original pipeline...
2022-09-21 10:32:08 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-21 10:32:08 INFO  ---RUNTIME: Importing and monkey-patching took 6.481409072875977 ms
2022-09-21 10:32:17 INFO  ---RUNTIME: Original pipeline execution took 8319.51904296875 ms (excluding imports and monkey-patching)
2022-09-21 10:32:17 INFO  Starting execution of 1 what-if analyses...
2022-09-21 10:32:17 INFO  Start plan generation for analysis DataCleaning...
2022-09-21 10:32:17 INFO  ---RUNTIME: Plan generation took 0.7307529449462891 ms
2022-09-21 10:32:17 INFO  Estimated runtime of original DAG is 6058.947563171387ms
2022-09-21 10:32:17 INFO  Performing Multi-Query Optimization
2022-09-21 10:32:17 INFO  Estimated unoptimized what-if runtime is 121178.95126342773ms
2022-09-21 10:32:17 INFO  Estimated optimised what-if runtime is 33871.64497375488ms
2022-09-21 10:32:17 INFO  Estimated optimisation runtime saving is 87307.30628967285ms
2022-09-21 10:32:17 INFO  ---RUNTIME: Multi-Query Optimization took 92.73171424865723 ms
2022-09-21 10:32:17 INFO  Executing generated plans
2022-09-21 10:32:59 INFO  ---RUNTIME: Execution took 42737.974882125854 ms
2022-09-21 10:32:59 INFO  Done!
2022-09-21 10:32:59 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-21 10:32:59 INFO  Running instrumented original pipeline...
2022-09-21 10:33:00 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-21 10:33:00 INFO  ---RUNTIME: Importing and monkey-patching took 6.819725036621094 ms
2022-09-21 10:33:09 INFO  ---RUNTIME: Original pipeline execution took 9145.267724990845 ms (excluding imports and monkey-patching)
2022-09-21 10:33:09 INFO  Starting execution of 1 what-if analyses...
2022-09-21 10:33:09 INFO  Start plan generation for analysis DataCleaning...
2022-09-21 10:33:09 INFO  ---RUNTIME: Plan generation took 0.8542537689208984 ms
2022-09-21 10:33:09 INFO  Estimated runtime of original DAG is 6375.845909118652ms
2022-09-21 10:33:09 WARNING Skipping Multi-Query Optimization (instead, only combine execution DAGs)
2022-09-21 10:33:09 WARNING Columns ['review_id'] not present in train DAG after the train test split, only before!
2022-09-21 10:33:09 WARNING This could hint at data leakage!
2022-09-21 10:33:09 INFO  Estimated unoptimised what-if runtime is 127516.91818237305ms
2022-09-21 10:33:09 INFO  ---RUNTIME: Multi-Query Optimization took 114.30859565734863 ms
2022-09-21 10:33:09 INFO  Executing generated plans
2022-09-21 10:35:41 INFO  ---RUNTIME: Execution took 151953.6280632019 ms
2022-09-21 10:35:41 INFO  Done!
2022-09-21 10:35:41 INFO  # Finished -- repetition 4 of 7 
2022-09-21 10:35:41 INFO  # Optimization benchmark for data_cleaning with args [['reviews', 'slow_loading', 'featurization_1', 'xgboost']] -- repetition 5 of 7
2022-09-21 10:35:41 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-21 10:35:41 INFO  Running instrumented original pipeline...
2022-09-21 10:35:41 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-21 10:35:41 INFO  ---RUNTIME: Importing and monkey-patching took 6.8149566650390625 ms
2022-09-21 10:35:49 INFO  ---RUNTIME: Original pipeline execution took 8570.732355117798 ms (excluding imports and monkey-patching)
2022-09-21 10:35:49 INFO  Starting execution of 1 what-if analyses...
2022-09-21 10:35:49 INFO  Start plan generation for analysis DataCleaning...
2022-09-21 10:35:49 INFO  ---RUNTIME: Plan generation took 0.7009506225585938 ms
2022-09-21 10:35:49 INFO  Estimated runtime of original DAG is 6236.536502838135ms
2022-09-21 10:35:49 INFO  Performing Multi-Query Optimization
2022-09-21 10:35:49 INFO  Estimated unoptimized what-if runtime is 124730.7300567627ms
2022-09-21 10:35:49 INFO  Estimated optimised what-if runtime is 34511.90257072449ms
2022-09-21 10:35:49 INFO  Estimated optimisation runtime saving is 90218.82748603821ms
2022-09-21 10:35:49 INFO  ---RUNTIME: Multi-Query Optimization took 91.03608131408691 ms
2022-09-21 10:35:49 INFO  Executing generated plans
2022-09-21 10:36:31 INFO  ---RUNTIME: Execution took 42039.10422325134 ms
2022-09-21 10:36:31 INFO  Done!
2022-09-21 10:36:31 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-21 10:36:31 INFO  Running instrumented original pipeline...
2022-09-21 10:36:31 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-21 10:36:31 INFO  ---RUNTIME: Importing and monkey-patching took 6.596565246582031 ms
2022-09-21 10:36:40 INFO  ---RUNTIME: Original pipeline execution took 8426.89061164856 ms (excluding imports and monkey-patching)
2022-09-21 10:36:40 INFO  Starting execution of 1 what-if analyses...
2022-09-21 10:36:40 INFO  Start plan generation for analysis DataCleaning...
2022-09-21 10:36:40 INFO  ---RUNTIME: Plan generation took 0.7395744323730469 ms
2022-09-21 10:36:40 INFO  Estimated runtime of original DAG is 6105.77917098999ms
2022-09-21 10:36:40 WARNING Skipping Multi-Query Optimization (instead, only combine execution DAGs)
2022-09-21 10:36:40 WARNING Columns ['review_id'] not present in train DAG after the train test split, only before!
2022-09-21 10:36:40 WARNING This could hint at data leakage!
2022-09-21 10:36:40 INFO  Estimated unoptimised what-if runtime is 122115.5834197998ms
2022-09-21 10:36:40 INFO  ---RUNTIME: Multi-Query Optimization took 106.78267478942871 ms
2022-09-21 10:36:40 INFO  Executing generated plans
