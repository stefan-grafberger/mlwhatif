Variant name from 1-8: 5
Cores to use: 160-167
taskset -c 160-167 PROTOCOL_BUFFERS_PYTHON_IMPLEMENTATION=python python3.9 benchmarks_end_to_end.py operator_impact reviews fast_loading featurization_0 logistic_regression
2022-09-21 18:42:42.170822: W tensorflow/stream_executor/platform/default/dso_loader.cc:64] Could not load dynamic library 'libcudart.so.11.0'; dlerror: libcudart.so.11.0: cannot open shared object file: No such file or directory; LD_LIBRARY_PATH: /home/sgrafbe/mlwhatif/venv/lib/python3.9/site-packages/cv2/../../lib64:
2022-09-21 18:42:42.170873: I tensorflow/stream_executor/cuda/cudart_stub.cc:29] Ignore above cudart dlerror if you do not have a GPU set up on your machine.
2022-09-21 18:42:43 INFO  Patching sys.argv with ['mlwhatif', 'reviews', 'fast_loading', 'featurization_0', 'logistic_regression']
2022-09-21 18:42:43 INFO  Running instrumented original pipeline...
2022-09-21 18:42:43 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-21 18:42:43 INFO  ---RUNTIME: Importing and monkey-patching took 120.49078941345215 ms
2022-09-21 18:42:50 INFO  ---RUNTIME: Original pipeline execution took 6545.744180679321 ms (excluding imports and monkey-patching)
2022-09-21 18:42:50 INFO  Starting execution of 0 what-if analyses...
2022-09-21 18:42:50 INFO  Estimated runtime of original DAG is 4847.978830337524ms
2022-09-21 18:42:50 INFO  Performing Multi-Query Optimization
2022-09-21 18:42:50 INFO  Estimated unoptimized what-if runtime is 0ms
2022-09-21 18:42:50 INFO  Estimated optimised what-if runtime is 0ms
2022-09-21 18:42:50 INFO  Estimated optimisation runtime saving is 0ms
2022-09-21 18:42:50 INFO  ---RUNTIME: Multi-Query Optimization took 0.5125999450683594 ms
2022-09-21 18:42:50 INFO  Executing generated plans
2022-09-21 18:42:50 INFO  ---RUNTIME: Execution took 0.0286102294921875 ms
2022-09-21 18:42:50 INFO  Done!
2022-09-21 18:42:50 INFO  # Optimization benchmark for operator_impact with args [['reviews', 'fast_loading', 'featurization_0', 'logistic_regression']] -- repetition 1 of 7
2022-09-21 18:42:50 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-21 18:42:50 INFO  Running instrumented original pipeline...
2022-09-21 18:42:50 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-21 18:42:50 INFO  ---RUNTIME: Importing and monkey-patching took 5.674123764038086 ms
2022-09-21 18:42:56 INFO  ---RUNTIME: Original pipeline execution took 6695.822238922119 ms (excluding imports and monkey-patching)
2022-09-21 18:42:56 INFO  Starting execution of 1 what-if analyses...
2022-09-21 18:42:56 INFO  Start plan generation for analysis OperatorImpact...
2022-09-21 18:42:56 INFO  ---RUNTIME: Plan generation took 5.340337753295898 ms
2022-09-21 18:42:56 INFO  Estimated runtime of original DAG is 4826.528072357178ms
2022-09-21 18:42:56 INFO  Performing Multi-Query Optimization
2022-09-21 18:42:56 INFO  Estimated unoptimized what-if runtime is 14918.08949542815ms
2022-09-21 18:42:56 INFO  Estimated optimised what-if runtime is 10736.881030159693ms
2022-09-21 18:42:56 INFO  Estimated optimisation runtime saving is 4181.208465268457ms
2022-09-21 18:42:56 INFO  ---RUNTIME: Multi-Query Optimization took 141.13473892211914 ms
2022-09-21 18:42:56 INFO  Executing generated plans
2022-09-21 18:43:09 INFO  ---RUNTIME: Execution took 12157.919645309448 ms
2022-09-21 18:43:09 INFO  Done!
2022-09-21 18:43:09 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-21 18:43:09 INFO  Running instrumented original pipeline...
2022-09-21 18:43:09 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-21 18:43:09 INFO  ---RUNTIME: Importing and monkey-patching took 6.216764450073242 ms
2022-09-21 18:43:15 INFO  ---RUNTIME: Original pipeline execution took 6543.40934753418 ms (excluding imports and monkey-patching)
2022-09-21 18:43:15 INFO  Starting execution of 1 what-if analyses...
2022-09-21 18:43:15 INFO  Start plan generation for analysis OperatorImpact...
2022-09-21 18:43:15 INFO  ---RUNTIME: Plan generation took 4.441976547241211 ms
2022-09-21 18:43:15 INFO  Estimated runtime of original DAG is 4834.813594818115ms
2022-09-21 18:43:15 WARNING Skipping Multi-Query Optimization (instead, only applying patches)
2022-09-21 18:43:15 INFO  Estimated unoptimised what-if runtime is 14887.077441440579ms
2022-09-21 18:43:15 INFO  ---RUNTIME: Multi-Query Optimization took 14.30964469909668 ms
2022-09-21 18:43:15 INFO  Executing generated plans
2022-09-21 18:43:33 INFO  ---RUNTIME: Execution took 17718.205213546753 ms
2022-09-21 18:43:33 INFO  Done!
2022-09-21 18:43:33 INFO  # Finished -- repetition 1 of 7 
2022-09-21 18:43:33 INFO  # Optimization benchmark for operator_impact with args [['reviews', 'fast_loading', 'featurization_0', 'logistic_regression']] -- repetition 2 of 7
2022-09-21 18:43:33 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-21 18:43:33 INFO  Running instrumented original pipeline...
2022-09-21 18:43:33 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-21 18:43:33 INFO  ---RUNTIME: Importing and monkey-patching took 6.252765655517578 ms
2022-09-21 18:43:39 INFO  ---RUNTIME: Original pipeline execution took 6516.0675048828125 ms (excluding imports and monkey-patching)
2022-09-21 18:43:39 INFO  Starting execution of 1 what-if analyses...
2022-09-21 18:43:39 INFO  Start plan generation for analysis OperatorImpact...
2022-09-21 18:43:39 INFO  ---RUNTIME: Plan generation took 4.697322845458984 ms
2022-09-21 18:43:39 INFO  Estimated runtime of original DAG is 4865.015268325806ms
2022-09-21 18:43:39 INFO  Performing Multi-Query Optimization
2022-09-21 18:43:40 INFO  Estimated unoptimized what-if runtime is 15031.226189339111ms
2022-09-21 18:43:40 INFO  Estimated optimised what-if runtime is 10760.999972166619ms
2022-09-21 18:43:40 INFO  Estimated optimisation runtime saving is 4270.226217172492ms
2022-09-21 18:43:40 INFO  ---RUNTIME: Multi-Query Optimization took 120.72443962097168 ms
2022-09-21 18:43:40 INFO  Executing generated plans
2022-09-21 18:43:52 INFO  ---RUNTIME: Execution took 12082.187414169312 ms
2022-09-21 18:43:52 INFO  Done!
2022-09-21 18:43:52 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-21 18:43:52 INFO  Running instrumented original pipeline...
2022-09-21 18:43:52 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-21 18:43:52 INFO  ---RUNTIME: Importing and monkey-patching took 6.132841110229492 ms
2022-09-21 18:43:58 INFO  ---RUNTIME: Original pipeline execution took 6512.110710144043 ms (excluding imports and monkey-patching)
2022-09-21 18:43:58 INFO  Starting execution of 1 what-if analyses...
2022-09-21 18:43:58 INFO  Start plan generation for analysis OperatorImpact...
2022-09-21 18:43:58 INFO  ---RUNTIME: Plan generation took 4.426240921020508 ms
2022-09-21 18:43:58 INFO  Estimated runtime of original DAG is 4843.236446380615ms
2022-09-21 18:43:58 WARNING Skipping Multi-Query Optimization (instead, only applying patches)
2022-09-21 18:43:58 INFO  Estimated unoptimised what-if runtime is 14922.490477487256ms
2022-09-21 18:43:58 INFO  ---RUNTIME: Multi-Query Optimization took 13.752937316894531 ms
2022-09-21 18:43:58 INFO  Executing generated plans
2022-09-21 18:44:16 INFO  ---RUNTIME: Execution took 17741.742372512817 ms
2022-09-21 18:44:16 INFO  Done!
2022-09-21 18:44:16 INFO  # Finished -- repetition 2 of 7 
2022-09-21 18:44:16 INFO  # Optimization benchmark for operator_impact with args [['reviews', 'fast_loading', 'featurization_0', 'logistic_regression']] -- repetition 3 of 7
2022-09-21 18:44:16 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-21 18:44:16 INFO  Running instrumented original pipeline...
2022-09-21 18:44:16 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-21 18:44:16 INFO  ---RUNTIME: Importing and monkey-patching took 5.9757232666015625 ms
2022-09-21 18:44:22 INFO  ---RUNTIME: Original pipeline execution took 6545.607805252075 ms (excluding imports and monkey-patching)
2022-09-21 18:44:22 INFO  Starting execution of 1 what-if analyses...
2022-09-21 18:44:22 INFO  Start plan generation for analysis OperatorImpact...
2022-09-21 18:44:23 INFO  ---RUNTIME: Plan generation took 4.557132720947266 ms
2022-09-21 18:44:23 INFO  Estimated runtime of original DAG is 4891.65472984314ms
2022-09-21 18:44:23 INFO  Performing Multi-Query Optimization
2022-09-21 18:44:23 INFO  Estimated unoptimized what-if runtime is 15114.14013379408ms
2022-09-21 18:44:23 INFO  Estimated optimised what-if runtime is 10875.259133014604ms
2022-09-21 18:44:23 INFO  Estimated optimisation runtime saving is 4238.881000779476ms
2022-09-21 18:44:23 INFO  ---RUNTIME: Multi-Query Optimization took 99.1520881652832 ms
2022-09-21 18:44:23 INFO  Executing generated plans
2022-09-21 18:44:35 INFO  ---RUNTIME: Execution took 12062.418222427368 ms
2022-09-21 18:44:35 INFO  Done!
2022-09-21 18:44:35 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-21 18:44:35 INFO  Running instrumented original pipeline...
2022-09-21 18:44:35 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-21 18:44:35 INFO  ---RUNTIME: Importing and monkey-patching took 5.827426910400391 ms
2022-09-21 18:44:41 INFO  ---RUNTIME: Original pipeline execution took 6505.3417682647705 ms (excluding imports and monkey-patching)
2022-09-21 18:44:41 INFO  Starting execution of 1 what-if analyses...
2022-09-21 18:44:41 INFO  Start plan generation for analysis OperatorImpact...
2022-09-21 18:44:41 INFO  ---RUNTIME: Plan generation took 4.317760467529297 ms
2022-09-21 18:44:41 INFO  Estimated runtime of original DAG is 4842.9059982299805ms
2022-09-21 18:44:41 WARNING Skipping Multi-Query Optimization (instead, only applying patches)
2022-09-21 18:44:41 INFO  Estimated unoptimised what-if runtime is 14918.91660203593ms
2022-09-21 18:44:41 INFO  ---RUNTIME: Multi-Query Optimization took 13.62156867980957 ms
2022-09-21 18:44:41 INFO  Executing generated plans
2022-09-21 18:44:59 INFO  ---RUNTIME: Execution took 17736.396074295044 ms
2022-09-21 18:44:59 INFO  Done!
2022-09-21 18:44:59 INFO  # Finished -- repetition 3 of 7 
2022-09-21 18:44:59 INFO  # Optimization benchmark for operator_impact with args [['reviews', 'fast_loading', 'featurization_0', 'logistic_regression']] -- repetition 4 of 7
2022-09-21 18:44:59 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-21 18:44:59 INFO  Running instrumented original pipeline...
2022-09-21 18:44:59 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-21 18:44:59 INFO  ---RUNTIME: Importing and monkey-patching took 6.511211395263672 ms
2022-09-21 18:45:06 INFO  ---RUNTIME: Original pipeline execution took 6888.539791107178 ms (excluding imports and monkey-patching)
2022-09-21 18:45:06 INFO  Starting execution of 1 what-if analyses...
2022-09-21 18:45:06 INFO  Start plan generation for analysis OperatorImpact...
2022-09-21 18:45:06 INFO  ---RUNTIME: Plan generation took 4.283905029296875 ms
2022-09-21 18:45:06 INFO  Estimated runtime of original DAG is 4951.0087966918945ms
2022-09-21 18:45:06 INFO  Performing Multi-Query Optimization
2022-09-21 18:45:06 INFO  Estimated unoptimized what-if runtime is 15305.300859046787ms
2022-09-21 18:45:06 INFO  Estimated optimised what-if runtime is 10948.532651052292ms
2022-09-21 18:45:06 INFO  Estimated optimisation runtime saving is 4356.768207994495ms
2022-09-21 18:45:06 INFO  ---RUNTIME: Multi-Query Optimization took 99.2894172668457 ms
2022-09-21 18:45:06 INFO  Executing generated plans
2022-09-21 18:45:18 INFO  ---RUNTIME: Execution took 12182.053327560425 ms
2022-09-21 18:45:18 INFO  Done!
2022-09-21 18:45:18 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-21 18:45:18 INFO  Running instrumented original pipeline...
2022-09-21 18:45:18 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-21 18:45:18 INFO  ---RUNTIME: Importing and monkey-patching took 6.197690963745117 ms
2022-09-21 18:45:25 INFO  ---RUNTIME: Original pipeline execution took 6560.777902603149 ms (excluding imports and monkey-patching)
2022-09-21 18:45:25 INFO  Starting execution of 1 what-if analyses...
2022-09-21 18:45:25 INFO  Start plan generation for analysis OperatorImpact...
2022-09-21 18:45:25 INFO  ---RUNTIME: Plan generation took 4.401206970214844 ms
2022-09-21 18:45:25 INFO  Estimated runtime of original DAG is 4874.396085739136ms
2022-09-21 18:45:25 WARNING Skipping Multi-Query Optimization (instead, only applying patches)
2022-09-21 18:45:25 INFO  Estimated unoptimised what-if runtime is 15013.781805845445ms
2022-09-21 18:45:25 INFO  ---RUNTIME: Multi-Query Optimization took 13.536453247070312 ms
2022-09-21 18:45:25 INFO  Executing generated plans
2022-09-21 18:45:43 INFO  ---RUNTIME: Execution took 17951.031923294067 ms
2022-09-21 18:45:43 INFO  Done!
2022-09-21 18:45:43 INFO  # Finished -- repetition 4 of 7 
2022-09-21 18:45:43 INFO  # Optimization benchmark for operator_impact with args [['reviews', 'fast_loading', 'featurization_0', 'logistic_regression']] -- repetition 5 of 7
2022-09-21 18:45:43 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-21 18:45:43 INFO  Running instrumented original pipeline...
2022-09-21 18:45:43 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-21 18:45:43 INFO  ---RUNTIME: Importing and monkey-patching took 5.858898162841797 ms
2022-09-21 18:45:49 INFO  ---RUNTIME: Original pipeline execution took 6613.003969192505 ms (excluding imports and monkey-patching)
2022-09-21 18:45:49 INFO  Starting execution of 1 what-if analyses...
2022-09-21 18:45:49 INFO  Start plan generation for analysis OperatorImpact...
2022-09-21 18:45:49 INFO  ---RUNTIME: Plan generation took 4.497289657592773 ms
2022-09-21 18:45:49 INFO  Estimated runtime of original DAG is 4927.045106887817ms
2022-09-21 18:45:49 INFO  Performing Multi-Query Optimization
2022-09-21 18:45:49 INFO  Estimated unoptimized what-if runtime is 15219.161193325548ms
2022-09-21 18:45:49 INFO  Estimated optimised what-if runtime is 10911.301399739492ms
2022-09-21 18:45:49 INFO  Estimated optimisation runtime saving is 4307.859793586056ms
2022-09-21 18:45:49 INFO  ---RUNTIME: Multi-Query Optimization took 99.26939010620117 ms
2022-09-21 18:45:49 INFO  Executing generated plans
2022-09-21 18:46:02 INFO  ---RUNTIME: Execution took 12138.654708862305 ms
2022-09-21 18:46:02 INFO  Done!
2022-09-21 18:46:02 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-21 18:46:02 INFO  Running instrumented original pipeline...
2022-09-21 18:46:02 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-21 18:46:02 INFO  ---RUNTIME: Importing and monkey-patching took 6.181001663208008 ms
2022-09-21 18:46:08 INFO  ---RUNTIME: Original pipeline execution took 6546.741962432861 ms (excluding imports and monkey-patching)
2022-09-21 18:46:08 INFO  Starting execution of 1 what-if analyses...
2022-09-21 18:46:08 INFO  Start plan generation for analysis OperatorImpact...
2022-09-21 18:46:08 INFO  ---RUNTIME: Plan generation took 4.3315887451171875 ms
2022-09-21 18:46:08 INFO  Estimated runtime of original DAG is 4879.839897155762ms
2022-09-21 18:46:08 WARNING Skipping Multi-Query Optimization (instead, only applying patches)
2022-09-21 18:46:08 INFO  Estimated unoptimised what-if runtime is 15036.226117220904ms
2022-09-21 18:46:08 INFO  ---RUNTIME: Multi-Query Optimization took 13.635873794555664 ms
2022-09-21 18:46:08 INFO  Executing generated plans
2022-09-21 18:46:26 INFO  ---RUNTIME: Execution took 17758.132457733154 ms
2022-09-21 18:46:26 INFO  Done!
2022-09-21 18:46:26 INFO  # Finished -- repetition 5 of 7 
2022-09-21 18:46:26 INFO  # Optimization benchmark for operator_impact with args [['reviews', 'fast_loading', 'featurization_0', 'logistic_regression']] -- repetition 6 of 7
2022-09-21 18:46:26 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-21 18:46:26 INFO  Running instrumented original pipeline...
2022-09-21 18:46:26 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-21 18:46:26 INFO  ---RUNTIME: Importing and monkey-patching took 5.770206451416016 ms
2022-09-21 18:46:32 INFO  ---RUNTIME: Original pipeline execution took 6546.278953552246 ms (excluding imports and monkey-patching)
2022-09-21 18:46:32 INFO  Starting execution of 1 what-if analyses...
2022-09-21 18:46:32 INFO  Start plan generation for analysis OperatorImpact...
2022-09-21 18:46:32 INFO  ---RUNTIME: Plan generation took 4.249334335327148 ms
2022-09-21 18:46:32 INFO  Estimated runtime of original DAG is 4881.310701370239ms
2022-09-21 18:46:32 INFO  Performing Multi-Query Optimization
2022-09-21 18:46:33 INFO  Estimated unoptimized what-if runtime is 15082.983138979516ms
2022-09-21 18:46:33 INFO  Estimated optimised what-if runtime is 10818.355225927278ms
2022-09-21 18:46:33 INFO  Estimated optimisation runtime saving is 4264.627913052238ms
2022-09-21 18:46:33 INFO  ---RUNTIME: Multi-Query Optimization took 99.15757179260254 ms
2022-09-21 18:46:33 INFO  Executing generated plans
2022-09-21 18:46:45 INFO  ---RUNTIME: Execution took 12126.933574676514 ms
2022-09-21 18:46:45 INFO  Done!
2022-09-21 18:46:45 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-21 18:46:45 INFO  Running instrumented original pipeline...
2022-09-21 18:46:45 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-21 18:46:45 INFO  ---RUNTIME: Importing and monkey-patching took 5.990743637084961 ms
2022-09-21 18:46:51 INFO  ---RUNTIME: Original pipeline execution took 6540.0230884552 ms (excluding imports and monkey-patching)
2022-09-21 18:46:51 INFO  Starting execution of 1 what-if analyses...
2022-09-21 18:46:51 INFO  Start plan generation for analysis OperatorImpact...
2022-09-21 18:46:51 INFO  ---RUNTIME: Plan generation took 4.387378692626953 ms
2022-09-21 18:46:51 INFO  Estimated runtime of original DAG is 4881.903886795044ms
2022-09-21 18:46:51 WARNING Skipping Multi-Query Optimization (instead, only applying patches)
2022-09-21 18:46:51 INFO  Estimated unoptimised what-if runtime is 15041.423667673298ms
2022-09-21 18:46:51 INFO  ---RUNTIME: Multi-Query Optimization took 13.737201690673828 ms
2022-09-21 18:46:51 INFO  Executing generated plans
2022-09-21 18:47:09 INFO  ---RUNTIME: Execution took 17767.40574836731 ms
2022-09-21 18:47:09 INFO  Done!
2022-09-21 18:47:09 INFO  # Finished -- repetition 6 of 7 
2022-09-21 18:47:09 INFO  # Optimization benchmark for operator_impact with args [['reviews', 'fast_loading', 'featurization_0', 'logistic_regression']] -- repetition 7 of 7
2022-09-21 18:47:09 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-21 18:47:09 INFO  Running instrumented original pipeline...
2022-09-21 18:47:09 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-21 18:47:09 INFO  ---RUNTIME: Importing and monkey-patching took 5.793571472167969 ms
2022-09-21 18:47:16 INFO  ---RUNTIME: Original pipeline execution took 6555.823564529419 ms (excluding imports and monkey-patching)
2022-09-21 18:47:16 INFO  Starting execution of 1 what-if analyses...
2022-09-21 18:47:16 INFO  Start plan generation for analysis OperatorImpact...
2022-09-21 18:47:16 INFO  ---RUNTIME: Plan generation took 4.204750061035156 ms
2022-09-21 18:47:16 INFO  Estimated runtime of original DAG is 4897.276878356934ms
2022-09-21 18:47:16 INFO  Performing Multi-Query Optimization
2022-09-21 18:47:16 INFO  Estimated unoptimized what-if runtime is 15132.523185994145ms
2022-09-21 18:47:16 INFO  Estimated optimised what-if runtime is 10897.815274367165ms
2022-09-21 18:47:16 INFO  Estimated optimisation runtime saving is 4234.70791162698ms
2022-09-21 18:47:16 INFO  ---RUNTIME: Multi-Query Optimization took 99.10321235656738 ms
2022-09-21 18:47:16 INFO  Executing generated plans
2022-09-21 18:47:28 INFO  ---RUNTIME: Execution took 12117.94400215149 ms
2022-09-21 18:47:28 INFO  Done!
2022-09-21 18:47:28 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-21 18:47:28 INFO  Running instrumented original pipeline...
2022-09-21 18:47:28 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-21 18:47:28 INFO  ---RUNTIME: Importing and monkey-patching took 5.7964324951171875 ms
2022-09-21 18:47:34 INFO  ---RUNTIME: Original pipeline execution took 6540.534019470215 ms (excluding imports and monkey-patching)
2022-09-21 18:47:34 INFO  Starting execution of 1 what-if analyses...
2022-09-21 18:47:34 INFO  Start plan generation for analysis OperatorImpact...
2022-09-21 18:47:34 INFO  ---RUNTIME: Plan generation took 4.227161407470703 ms
2022-09-21 18:47:34 INFO  Estimated runtime of original DAG is 4879.574537277222ms
2022-09-21 18:47:34 WARNING Skipping Multi-Query Optimization (instead, only applying patches)
2022-09-21 18:47:34 INFO  Estimated unoptimised what-if runtime is 15036.622945892537ms
2022-09-21 18:47:34 INFO  ---RUNTIME: Multi-Query Optimization took 13.469219207763672 ms
2022-09-21 18:47:34 INFO  Executing generated plans
2022-09-21 18:47:52 INFO  ---RUNTIME: Execution took 17973.114013671875 ms
2022-09-21 18:47:52 INFO  Done!
2022-09-21 18:47:52 INFO  # Finished -- repetition 7 of 7 
2022-09-21 18:47:52 INFO  # Final results after all repetitions
2022-09-21 18:47:52 INFO     repetition  ... no_opt_what_if_execution_combined_model_training
0           0  ...                                       462.799311
1           1  ...                                       463.430882
2           2  ...                                       460.853577
3           3  ...                                       461.388588
4           4  ...                                       462.417126
5           5  ...                                       480.654955
6           6  ...                                       460.148811

[7 rows x 26 columns]
taskset -c 160-167 PROTOCOL_BUFFERS_PYTHON_IMPLEMENTATION=python python3.9 benchmarks_end_to_end.py operator_impact reviews fast_loading featurization_0 xgboost
2022-09-21 18:47:55.203806: W tensorflow/stream_executor/platform/default/dso_loader.cc:64] Could not load dynamic library 'libcudart.so.11.0'; dlerror: libcudart.so.11.0: cannot open shared object file: No such file or directory; LD_LIBRARY_PATH: /home/sgrafbe/mlwhatif/venv/lib/python3.9/site-packages/cv2/../../lib64:
2022-09-21 18:47:55.203860: I tensorflow/stream_executor/cuda/cudart_stub.cc:29] Ignore above cudart dlerror if you do not have a GPU set up on your machine.
2022-09-21 18:47:56 INFO  Patching sys.argv with ['mlwhatif', 'reviews', 'fast_loading', 'featurization_0', 'xgboost']
2022-09-21 18:47:56 INFO  Running instrumented original pipeline...
2022-09-21 18:47:56 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-21 18:47:56 INFO  ---RUNTIME: Importing and monkey-patching took 121.19531631469727 ms
2022-09-21 18:48:06 INFO  ---RUNTIME: Original pipeline execution took 9846.675872802734 ms (excluding imports and monkey-patching)
2022-09-21 18:48:06 INFO  Starting execution of 0 what-if analyses...
2022-09-21 18:48:06 INFO  Estimated runtime of original DAG is 8176.660776138306ms
2022-09-21 18:48:06 INFO  Performing Multi-Query Optimization
2022-09-21 18:48:06 INFO  Estimated unoptimized what-if runtime is 0ms
2022-09-21 18:48:06 INFO  Estimated optimised what-if runtime is 0ms
2022-09-21 18:48:06 INFO  Estimated optimisation runtime saving is 0ms
2022-09-21 18:48:06 INFO  ---RUNTIME: Multi-Query Optimization took 0.5037784576416016 ms
2022-09-21 18:48:06 INFO  Executing generated plans
2022-09-21 18:48:06 INFO  ---RUNTIME: Execution took 0.026464462280273438 ms
2022-09-21 18:48:06 INFO  Done!
2022-09-21 18:48:06 INFO  # Optimization benchmark for operator_impact with args [['reviews', 'fast_loading', 'featurization_0', 'xgboost']] -- repetition 1 of 7
2022-09-21 18:48:06 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-21 18:48:06 INFO  Running instrumented original pipeline...
2022-09-21 18:48:06 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-21 18:48:06 INFO  ---RUNTIME: Importing and monkey-patching took 5.71751594543457 ms
2022-09-21 18:48:14 INFO  ---RUNTIME: Original pipeline execution took 7426.45525932312 ms (excluding imports and monkey-patching)
2022-09-21 18:48:14 INFO  Starting execution of 1 what-if analyses...
2022-09-21 18:48:14 INFO  Start plan generation for analysis OperatorImpact...
2022-09-21 18:48:14 INFO  ---RUNTIME: Plan generation took 5.196571350097656 ms
2022-09-21 18:48:14 INFO  Estimated runtime of original DAG is 5640.805244445801ms
2022-09-21 18:48:14 INFO  Performing Multi-Query Optimization
2022-09-21 18:48:14 INFO  Estimated unoptimized what-if runtime is 17481.941151767518ms
2022-09-21 18:48:14 INFO  Estimated optimised what-if runtime is 13347.409412680536ms
2022-09-21 18:48:14 INFO  Estimated optimisation runtime saving is 4134.531739086982ms
2022-09-21 18:48:14 INFO  ---RUNTIME: Multi-Query Optimization took 101.40180587768555 ms
2022-09-21 18:48:14 INFO  Executing generated plans
2022-09-21 18:48:28 INFO  ---RUNTIME: Execution took 14329.923629760742 ms
2022-09-21 18:48:28 INFO  Done!
2022-09-21 18:48:28 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-21 18:48:28 INFO  Running instrumented original pipeline...
2022-09-21 18:48:28 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-21 18:48:28 INFO  ---RUNTIME: Importing and monkey-patching took 6.551265716552734 ms
2022-09-21 18:48:35 INFO  ---RUNTIME: Original pipeline execution took 7229.204893112183 ms (excluding imports and monkey-patching)
2022-09-21 18:48:35 INFO  Starting execution of 1 what-if analyses...
2022-09-21 18:48:35 INFO  Start plan generation for analysis OperatorImpact...
2022-09-21 18:48:35 INFO  ---RUNTIME: Plan generation took 4.448890686035156 ms
2022-09-21 18:48:35 INFO  Estimated runtime of original DAG is 5589.500188827515ms
2022-09-21 18:48:35 WARNING Skipping Multi-Query Optimization (instead, only applying patches)
2022-09-21 18:48:35 INFO  Estimated unoptimised what-if runtime is 17275.06849340359ms
2022-09-21 18:48:35 INFO  ---RUNTIME: Multi-Query Optimization took 13.792753219604492 ms
2022-09-21 18:48:35 INFO  Executing generated plans
2022-09-21 18:48:55 INFO  ---RUNTIME: Execution took 20249.265432357788 ms
2022-09-21 18:48:55 INFO  Done!
2022-09-21 18:48:55 INFO  # Finished -- repetition 1 of 7 
2022-09-21 18:48:55 INFO  # Optimization benchmark for operator_impact with args [['reviews', 'fast_loading', 'featurization_0', 'xgboost']] -- repetition 2 of 7
2022-09-21 18:48:55 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-21 18:48:55 INFO  Running instrumented original pipeline...
2022-09-21 18:48:56 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-21 18:48:56 INFO  ---RUNTIME: Importing and monkey-patching took 6.393909454345703 ms
2022-09-21 18:49:03 INFO  ---RUNTIME: Original pipeline execution took 7342.682123184204 ms (excluding imports and monkey-patching)
2022-09-21 18:49:03 INFO  Starting execution of 1 what-if analyses...
2022-09-21 18:49:03 INFO  Start plan generation for analysis OperatorImpact...
2022-09-21 18:49:03 INFO  ---RUNTIME: Plan generation took 4.461526870727539 ms
2022-09-21 18:49:03 INFO  Estimated runtime of original DAG is 5685.517072677612ms
2022-09-21 18:49:03 INFO  Performing Multi-Query Optimization
2022-09-21 18:49:03 INFO  Estimated unoptimized what-if runtime is 17623.478396162544ms
2022-09-21 18:49:03 INFO  Estimated optimised what-if runtime is 13482.645905917141ms
2022-09-21 18:49:03 INFO  Estimated optimisation runtime saving is 4140.832490245402ms
2022-09-21 18:49:03 INFO  ---RUNTIME: Multi-Query Optimization took 99.74527359008789 ms
2022-09-21 18:49:03 INFO  Executing generated plans
2022-09-21 18:49:17 INFO  ---RUNTIME: Execution took 14484.15207862854 ms
2022-09-21 18:49:17 INFO  Done!
2022-09-21 18:49:17 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-21 18:49:17 INFO  Running instrumented original pipeline...
2022-09-21 18:49:17 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-21 18:49:17 INFO  ---RUNTIME: Importing and monkey-patching took 6.054401397705078 ms
2022-09-21 18:49:25 INFO  ---RUNTIME: Original pipeline execution took 7280.726194381714 ms (excluding imports and monkey-patching)
2022-09-21 18:49:25 INFO  Starting execution of 1 what-if analyses...
2022-09-21 18:49:25 INFO  Start plan generation for analysis OperatorImpact...
2022-09-21 18:49:25 INFO  ---RUNTIME: Plan generation took 4.443168640136719 ms
2022-09-21 18:49:25 INFO  Estimated runtime of original DAG is 5634.045124053955ms
2022-09-21 18:49:25 WARNING Skipping Multi-Query Optimization (instead, only applying patches)
2022-09-21 18:49:25 INFO  Estimated unoptimised what-if runtime is 17414.538608792307ms
2022-09-21 18:49:25 INFO  ---RUNTIME: Multi-Query Optimization took 13.908863067626953 ms
2022-09-21 18:49:25 INFO  Executing generated plans
2022-09-21 18:49:45 INFO  ---RUNTIME: Execution took 20279.377222061157 ms
2022-09-21 18:49:45 INFO  Done!
2022-09-21 18:49:45 INFO  # Finished -- repetition 2 of 7 
2022-09-21 18:49:45 INFO  # Optimization benchmark for operator_impact with args [['reviews', 'fast_loading', 'featurization_0', 'xgboost']] -- repetition 3 of 7
2022-09-21 18:49:45 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-21 18:49:45 INFO  Running instrumented original pipeline...
2022-09-21 18:49:45 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-21 18:49:45 INFO  ---RUNTIME: Importing and monkey-patching took 6.195068359375 ms
2022-09-21 18:49:52 INFO  ---RUNTIME: Original pipeline execution took 7367.029190063477 ms (excluding imports and monkey-patching)
2022-09-21 18:49:52 INFO  Starting execution of 1 what-if analyses...
2022-09-21 18:49:52 INFO  Start plan generation for analysis OperatorImpact...
2022-09-21 18:49:52 INFO  ---RUNTIME: Plan generation took 4.433631896972656 ms
2022-09-21 18:49:52 INFO  Estimated runtime of original DAG is 5533.795356750488ms
2022-09-21 18:49:52 INFO  Performing Multi-Query Optimization
2022-09-21 18:49:52 INFO  Estimated unoptimized what-if runtime is 17175.567765937078ms
2022-09-21 18:49:52 INFO  Estimated optimised what-if runtime is 12943.2194977453ms
2022-09-21 18:49:52 INFO  Estimated optimisation runtime saving is 4232.348268191778ms
2022-09-21 18:49:52 INFO  ---RUNTIME: Multi-Query Optimization took 99.69067573547363 ms
2022-09-21 18:49:52 INFO  Executing generated plans
2022-09-21 18:50:07 INFO  ---RUNTIME: Execution took 14520.867347717285 ms
2022-09-21 18:50:07 INFO  Done!
2022-09-21 18:50:07 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-21 18:50:07 INFO  Running instrumented original pipeline...
2022-09-21 18:50:07 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-21 18:50:07 INFO  ---RUNTIME: Importing and monkey-patching took 6.076574325561523 ms
2022-09-21 18:50:14 INFO  ---RUNTIME: Original pipeline execution took 7317.829608917236 ms (excluding imports and monkey-patching)
2022-09-21 18:50:14 INFO  Starting execution of 1 what-if analyses...
2022-09-21 18:50:14 INFO  Start plan generation for analysis OperatorImpact...
2022-09-21 18:50:14 INFO  ---RUNTIME: Plan generation took 4.420280456542969 ms
2022-09-21 18:50:14 INFO  Estimated runtime of original DAG is 5674.61895942688ms
2022-09-21 18:50:14 WARNING Skipping Multi-Query Optimization (instead, only applying patches)
2022-09-21 18:50:14 INFO  Estimated unoptimised what-if runtime is 17538.195433483597ms
2022-09-21 18:50:14 INFO  ---RUNTIME: Multi-Query Optimization took 13.675451278686523 ms
2022-09-21 18:50:14 INFO  Executing generated plans
2022-09-21 18:50:35 INFO  ---RUNTIME: Execution took 20331.51650428772 ms
2022-09-21 18:50:35 INFO  Done!
2022-09-21 18:50:35 INFO  # Finished -- repetition 3 of 7 
2022-09-21 18:50:35 INFO  # Optimization benchmark for operator_impact with args [['reviews', 'fast_loading', 'featurization_0', 'xgboost']] -- repetition 4 of 7
2022-09-21 18:50:35 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-21 18:50:35 INFO  Running instrumented original pipeline...
2022-09-21 18:50:35 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-21 18:50:35 INFO  ---RUNTIME: Importing and monkey-patching took 5.9299468994140625 ms
2022-09-21 18:50:42 INFO  ---RUNTIME: Original pipeline execution took 7687.700033187866 ms (excluding imports and monkey-patching)
2022-09-21 18:50:42 INFO  Starting execution of 1 what-if analyses...
2022-09-21 18:50:42 INFO  Start plan generation for analysis OperatorImpact...
2022-09-21 18:50:42 INFO  ---RUNTIME: Plan generation took 4.229068756103516 ms
2022-09-21 18:50:42 INFO  Estimated runtime of original DAG is 5493.759632110596ms
2022-09-21 18:50:42 INFO  Performing Multi-Query Optimization
2022-09-21 18:50:42 INFO  Estimated unoptimized what-if runtime is 17017.200420092573ms
2022-09-21 18:50:42 INFO  Estimated optimised what-if runtime is 12857.698868402298ms
2022-09-21 18:50:42 INFO  Estimated optimisation runtime saving is 4159.501551690275ms
2022-09-21 18:50:42 INFO  ---RUNTIME: Multi-Query Optimization took 99.33280944824219 ms
2022-09-21 18:50:42 INFO  Executing generated plans
2022-09-21 18:50:57 INFO  ---RUNTIME: Execution took 14679.413557052612 ms
2022-09-21 18:50:57 INFO  Done!
2022-09-21 18:50:57 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-21 18:50:57 INFO  Running instrumented original pipeline...
2022-09-21 18:50:57 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-21 18:50:57 INFO  ---RUNTIME: Importing and monkey-patching took 6.356000900268555 ms
2022-09-21 18:51:05 INFO  ---RUNTIME: Original pipeline execution took 7444.727182388306 ms (excluding imports and monkey-patching)
2022-09-21 18:51:05 INFO  Starting execution of 1 what-if analyses...
2022-09-21 18:51:05 INFO  Start plan generation for analysis OperatorImpact...
2022-09-21 18:51:05 INFO  ---RUNTIME: Plan generation took 4.445075988769531 ms
2022-09-21 18:51:05 INFO  Estimated runtime of original DAG is 5570.245742797852ms
2022-09-21 18:51:05 WARNING Skipping Multi-Query Optimization (instead, only applying patches)
2022-09-21 18:51:05 INFO  Estimated unoptimised what-if runtime is 17200.106858652733ms
2022-09-21 18:51:05 INFO  ---RUNTIME: Multi-Query Optimization took 13.71455192565918 ms
2022-09-21 18:51:05 INFO  Executing generated plans
2022-09-21 18:51:25 INFO  ---RUNTIME: Execution took 20485.34107208252 ms
2022-09-21 18:51:25 INFO  Done!
2022-09-21 18:51:25 INFO  # Finished -- repetition 4 of 7 
2022-09-21 18:51:25 INFO  # Optimization benchmark for operator_impact with args [['reviews', 'fast_loading', 'featurization_0', 'xgboost']] -- repetition 5 of 7
2022-09-21 18:51:25 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-21 18:51:25 INFO  Running instrumented original pipeline...
2022-09-21 18:51:25 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-21 18:51:25 INFO  ---RUNTIME: Importing and monkey-patching took 5.844831466674805 ms
2022-09-21 18:51:33 INFO  ---RUNTIME: Original pipeline execution took 7432.813405990601 ms (excluding imports and monkey-patching)
2022-09-21 18:51:33 INFO  Starting execution of 1 what-if analyses...
2022-09-21 18:51:33 INFO  Start plan generation for analysis OperatorImpact...
2022-09-21 18:51:33 INFO  ---RUNTIME: Plan generation took 4.276275634765625 ms
2022-09-21 18:51:33 INFO  Estimated runtime of original DAG is 5520.759344100952ms
2022-09-21 18:51:33 INFO  Performing Multi-Query Optimization
2022-09-21 18:51:33 INFO  Estimated unoptimized what-if runtime is 17096.424007730435ms
2022-09-21 18:51:33 INFO  Estimated optimised what-if runtime is 12789.575159700227ms
2022-09-21 18:51:33 INFO  Estimated optimisation runtime saving is 4306.848848030208ms
2022-09-21 18:51:33 INFO  ---RUNTIME: Multi-Query Optimization took 99.29585456848145 ms
2022-09-21 18:51:33 INFO  Executing generated plans
2022-09-21 18:51:47 INFO  ---RUNTIME: Execution took 14569.26441192627 ms
2022-09-21 18:51:47 INFO  Done!
2022-09-21 18:51:47 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-21 18:51:47 INFO  Running instrumented original pipeline...
2022-09-21 18:51:47 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-21 18:51:47 INFO  ---RUNTIME: Importing and monkey-patching took 6.197452545166016 ms
2022-09-21 18:51:55 INFO  ---RUNTIME: Original pipeline execution took 7452.390670776367 ms (excluding imports and monkey-patching)
2022-09-21 18:51:55 INFO  Starting execution of 1 what-if analyses...
2022-09-21 18:51:55 INFO  Start plan generation for analysis OperatorImpact...
2022-09-21 18:51:55 INFO  ---RUNTIME: Plan generation took 4.464626312255859 ms
2022-09-21 18:51:55 INFO  Estimated runtime of original DAG is 5521.665096282959ms
2022-09-21 18:51:55 WARNING Skipping Multi-Query Optimization (instead, only applying patches)
2022-09-21 18:51:55 INFO  Estimated unoptimised what-if runtime is 17053.48077114381ms
2022-09-21 18:51:55 INFO  ---RUNTIME: Multi-Query Optimization took 13.782501220703125 ms
2022-09-21 18:51:55 INFO  Executing generated plans
2022-09-21 18:52:15 INFO  ---RUNTIME: Execution took 20439.478874206543 ms
2022-09-21 18:52:15 INFO  Done!
2022-09-21 18:52:15 INFO  # Finished -- repetition 5 of 7 
2022-09-21 18:52:15 INFO  # Optimization benchmark for operator_impact with args [['reviews', 'fast_loading', 'featurization_0', 'xgboost']] -- repetition 6 of 7
2022-09-21 18:52:15 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-21 18:52:15 INFO  Running instrumented original pipeline...
2022-09-21 18:52:15 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-21 18:52:15 INFO  ---RUNTIME: Importing and monkey-patching took 5.782842636108398 ms
2022-09-21 18:52:23 INFO  ---RUNTIME: Original pipeline execution took 7404.9389362335205 ms (excluding imports and monkey-patching)
2022-09-21 18:52:23 INFO  Starting execution of 1 what-if analyses...
2022-09-21 18:52:23 INFO  Start plan generation for analysis OperatorImpact...
2022-09-21 18:52:23 INFO  ---RUNTIME: Plan generation took 4.2285919189453125 ms
2022-09-21 18:52:23 INFO  Estimated runtime of original DAG is 5497.59316444397ms
2022-09-21 18:52:23 INFO  Performing Multi-Query Optimization
2022-09-21 18:52:23 INFO  Estimated unoptimized what-if runtime is 17020.764006778158ms
2022-09-21 18:52:23 INFO  Estimated optimised what-if runtime is 12832.047379973006ms
2022-09-21 18:52:23 INFO  Estimated optimisation runtime saving is 4188.7166268051515ms
2022-09-21 18:52:23 INFO  ---RUNTIME: Multi-Query Optimization took 100.72994232177734 ms
2022-09-21 18:52:23 INFO  Executing generated plans
2022-09-21 18:52:37 INFO  ---RUNTIME: Execution took 14581.56943321228 ms
2022-09-21 18:52:37 INFO  Done!
2022-09-21 18:52:37 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-21 18:52:37 INFO  Running instrumented original pipeline...
2022-09-21 18:52:37 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-21 18:52:37 INFO  ---RUNTIME: Importing and monkey-patching took 6.30950927734375 ms
2022-09-21 18:52:45 INFO  ---RUNTIME: Original pipeline execution took 7383.436441421509 ms (excluding imports and monkey-patching)
2022-09-21 18:52:45 INFO  Starting execution of 1 what-if analyses...
2022-09-21 18:52:45 INFO  Start plan generation for analysis OperatorImpact...
2022-09-21 18:52:45 INFO  ---RUNTIME: Plan generation took 4.439353942871094 ms
2022-09-21 18:52:45 INFO  Estimated runtime of original DAG is 5712.209939956665ms
2022-09-21 18:52:45 WARNING Skipping Multi-Query Optimization (instead, only applying patches)
2022-09-21 18:52:45 INFO  Estimated unoptimised what-if runtime is 17624.387776445466ms
2022-09-21 18:52:45 INFO  ---RUNTIME: Multi-Query Optimization took 13.583183288574219 ms
2022-09-21 18:52:45 INFO  Executing generated plans
2022-09-21 18:53:05 INFO  ---RUNTIME: Execution took 20512.506246566772 ms
2022-09-21 18:53:05 INFO  Done!
2022-09-21 18:53:05 INFO  # Finished -- repetition 6 of 7 
2022-09-21 18:53:05 INFO  # Optimization benchmark for operator_impact with args [['reviews', 'fast_loading', 'featurization_0', 'xgboost']] -- repetition 7 of 7
2022-09-21 18:53:05 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-21 18:53:05 INFO  Running instrumented original pipeline...
2022-09-21 18:53:05 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-21 18:53:05 INFO  ---RUNTIME: Importing and monkey-patching took 5.80596923828125 ms
2022-09-21 18:53:13 INFO  ---RUNTIME: Original pipeline execution took 7383.6095333099365 ms (excluding imports and monkey-patching)
2022-09-21 18:53:13 INFO  Starting execution of 1 what-if analyses...
2022-09-21 18:53:13 INFO  Start plan generation for analysis OperatorImpact...
2022-09-21 18:53:13 INFO  ---RUNTIME: Plan generation took 4.316568374633789 ms
2022-09-21 18:53:13 INFO  Estimated runtime of original DAG is 5465.385913848877ms
2022-09-21 18:53:13 INFO  Performing Multi-Query Optimization
2022-09-21 18:53:13 INFO  Estimated unoptimized what-if runtime is 16924.15678061523ms
2022-09-21 18:53:13 INFO  Estimated optimised what-if runtime is 12744.288267027678ms
2022-09-21 18:53:13 INFO  Estimated optimisation runtime saving is 4179.868513587553ms
2022-09-21 18:53:13 INFO  ---RUNTIME: Multi-Query Optimization took 100.20637512207031 ms
2022-09-21 18:53:13 INFO  Executing generated plans
2022-09-21 18:53:27 INFO  ---RUNTIME: Execution took 14541.982889175415 ms
2022-09-21 18:53:27 INFO  Done!
2022-09-21 18:53:27 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-21 18:53:27 INFO  Running instrumented original pipeline...
2022-09-21 18:53:27 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-21 18:53:27 INFO  ---RUNTIME: Importing and monkey-patching took 6.183624267578125 ms
2022-09-21 18:53:35 INFO  ---RUNTIME: Original pipeline execution took 7371.299743652344 ms (excluding imports and monkey-patching)
2022-09-21 18:53:35 INFO  Starting execution of 1 what-if analyses...
2022-09-21 18:53:35 INFO  Start plan generation for analysis OperatorImpact...
2022-09-21 18:53:35 INFO  ---RUNTIME: Plan generation took 6.3724517822265625 ms
2022-09-21 18:53:35 INFO  Estimated runtime of original DAG is 5709.8870277404785ms
2022-09-21 18:53:35 WARNING Skipping Multi-Query Optimization (instead, only applying patches)
2022-09-21 18:53:35 INFO  Estimated unoptimised what-if runtime is 17616.74926376001ms
2022-09-21 18:53:35 INFO  ---RUNTIME: Multi-Query Optimization took 19.84858512878418 ms
2022-09-21 18:53:35 INFO  Executing generated plans
2022-09-21 18:53:55 INFO  ---RUNTIME: Execution took 20523.24652671814 ms
2022-09-21 18:53:55 INFO  Done!
2022-09-21 18:53:55 INFO  # Finished -- repetition 7 of 7 
2022-09-21 18:53:55 INFO  # Final results after all repetitions
2022-09-21 18:53:55 INFO     repetition  ... no_opt_what_if_execution_combined_model_training
0           0  ...                                      2447.017670
1           1  ...                                      2464.674234
2           2  ...                                      2455.204487
3           3  ...                                      2345.951080
4           4  ...                                      2379.639864
5           5  ...                                      2445.332766
6           6  ...                                      2450.402021

[7 rows x 26 columns]
taskset -c 160-167 PROTOCOL_BUFFERS_PYTHON_IMPLEMENTATION=python python3.9 benchmarks_end_to_end.py operator_impact reviews fast_loading featurization_0 neural_network
2022-09-21 18:53:57.947723: W tensorflow/stream_executor/platform/default/dso_loader.cc:64] Could not load dynamic library 'libcudart.so.11.0'; dlerror: libcudart.so.11.0: cannot open shared object file: No such file or directory; LD_LIBRARY_PATH: /home/sgrafbe/mlwhatif/venv/lib/python3.9/site-packages/cv2/../../lib64:
2022-09-21 18:53:57.947775: I tensorflow/stream_executor/cuda/cudart_stub.cc:29] Ignore above cudart dlerror if you do not have a GPU set up on your machine.
2022-09-21 18:53:59 INFO  Patching sys.argv with ['mlwhatif', 'reviews', 'fast_loading', 'featurization_0', 'neural_network']
2022-09-21 18:53:59 INFO  Running instrumented original pipeline...
2022-09-21 18:53:59 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-21 18:53:59 INFO  ---RUNTIME: Importing and monkey-patching took 121.28424644470215 ms
2022-09-21 18:54:04.610060: W tensorflow/stream_executor/platform/default/dso_loader.cc:64] Could not load dynamic library 'libcuda.so.1'; dlerror: libcuda.so.1: cannot open shared object file: No such file or directory; LD_LIBRARY_PATH: /home/sgrafbe/mlwhatif/venv/lib/python3.9/site-packages/cv2/../../lib64:
2022-09-21 18:54:04.610112: W tensorflow/stream_executor/cuda/cuda_driver.cc:326] failed call to cuInit: UNKNOWN ERROR (303)
2022-09-21 18:54:04.610139: I tensorflow/stream_executor/cuda/cuda_diagnostics.cc:156] kernel driver does not appear to be running on this host (angus): /proc/driver/nvidia/version does not exist
2022-09-21 18:54:04.610637: I tensorflow/core/platform/cpu_feature_guard.cc:142] This TensorFlow binary is optimized with oneAPI Deep Neural Network Library (oneDNN) to use the following CPU instructions in performance-critical operations:  AVX2 FMA
To enable them in other operations, rebuild TensorFlow with the appropriate compiler flags.
2022-09-21 18:54:04.898744: I tensorflow/compiler/mlir/mlir_graph_optimization_pass.cc:176] None of the MLIR Optimization Passes are enabled (registered 2)
2022-09-21 18:54:04.911282: I tensorflow/core/platform/profile_utils/cpu_utils.cc:114] CPU Frequency: 2595130000 Hz
2022-09-21 18:54:10 INFO  ---RUNTIME: Original pipeline execution took 10553.560495376587 ms (excluding imports and monkey-patching)
2022-09-21 18:54:10 INFO  Starting execution of 0 what-if analyses...
2022-09-21 18:54:10 INFO  Estimated runtime of original DAG is 8911.125659942627ms
2022-09-21 18:54:10 INFO  Performing Multi-Query Optimization
2022-09-21 18:54:10 INFO  Estimated unoptimized what-if runtime is 0ms
2022-09-21 18:54:10 INFO  Estimated optimised what-if runtime is 0ms
2022-09-21 18:54:10 INFO  Estimated optimisation runtime saving is 0ms
2022-09-21 18:54:10 INFO  ---RUNTIME: Multi-Query Optimization took 0.48851966857910156 ms
2022-09-21 18:54:10 INFO  Executing generated plans
2022-09-21 18:54:10 INFO  ---RUNTIME: Execution took 0.02193450927734375 ms
2022-09-21 18:54:10 INFO  Done!
2022-09-21 18:54:10 INFO  # Optimization benchmark for operator_impact with args [['reviews', 'fast_loading', 'featurization_0', 'neural_network']] -- repetition 1 of 7
2022-09-21 18:54:10 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-21 18:54:10 INFO  Running instrumented original pipeline...
2022-09-21 18:54:10 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-21 18:54:10 INFO  ---RUNTIME: Importing and monkey-patching took 5.82575798034668 ms
2022-09-21 18:54:20 INFO  ---RUNTIME: Original pipeline execution took 10149.10912513733 ms (excluding imports and monkey-patching)
2022-09-21 18:54:20 INFO  Starting execution of 1 what-if analyses...
2022-09-21 18:54:20 INFO  Start plan generation for analysis OperatorImpact...
2022-09-21 18:54:20 INFO  ---RUNTIME: Plan generation took 5.121707916259766 ms
2022-09-21 18:54:20 INFO  Estimated runtime of original DAG is 8518.316984176636ms
2022-09-21 18:54:20 INFO  Performing Multi-Query Optimization
2022-09-21 18:54:20 INFO  Estimated unoptimized what-if runtime is 26519.638920281133ms
2022-09-21 18:54:20 INFO  Estimated optimised what-if runtime is 22356.890559256964ms
2022-09-21 18:54:20 INFO  Estimated optimisation runtime saving is 4162.748361024169ms
2022-09-21 18:54:20 INFO  ---RUNTIME: Multi-Query Optimization took 101.38964653015137 ms
2022-09-21 18:54:20 INFO  Executing generated plans
2022-09-21 18:54:44 INFO  ---RUNTIME: Execution took 24369.5650100708 ms
2022-09-21 18:54:44 INFO  Done!
2022-09-21 18:54:44 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-21 18:54:44 INFO  Running instrumented original pipeline...
2022-09-21 18:54:44 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-21 18:54:44 INFO  ---RUNTIME: Importing and monkey-patching took 6.050586700439453 ms
2022-09-21 18:54:55 INFO  ---RUNTIME: Original pipeline execution took 10307.15537071228 ms (excluding imports and monkey-patching)
2022-09-21 18:54:55 INFO  Starting execution of 1 what-if analyses...
2022-09-21 18:54:55 INFO  Start plan generation for analysis OperatorImpact...
2022-09-21 18:54:55 INFO  ---RUNTIME: Plan generation took 4.496574401855469 ms
2022-09-21 18:54:55 INFO  Estimated runtime of original DAG is 8696.98166847229ms
2022-09-21 18:54:55 WARNING Skipping Multi-Query Optimization (instead, only applying patches)
2022-09-21 18:54:55 INFO  Estimated unoptimised what-if runtime is 27042.723550184193ms
2022-09-21 18:54:55 INFO  ---RUNTIME: Multi-Query Optimization took 15.60354232788086 ms
2022-09-21 18:54:55 INFO  Executing generated plans
2022-09-21 18:55:24 INFO  ---RUNTIME: Execution took 29860.591411590576 ms
2022-09-21 18:55:24 INFO  Done!
2022-09-21 18:55:24 INFO  # Finished -- repetition 1 of 7 
2022-09-21 18:55:24 INFO  # Optimization benchmark for operator_impact with args [['reviews', 'fast_loading', 'featurization_0', 'neural_network']] -- repetition 2 of 7
2022-09-21 18:55:24 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-21 18:55:24 INFO  Running instrumented original pipeline...
2022-09-21 18:55:25 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-21 18:55:25 INFO  ---RUNTIME: Importing and monkey-patching took 7.039546966552734 ms
2022-09-21 18:55:35 INFO  ---RUNTIME: Original pipeline execution took 10511.81960105896 ms (excluding imports and monkey-patching)
2022-09-21 18:55:35 INFO  Starting execution of 1 what-if analyses...
2022-09-21 18:55:35 INFO  Start plan generation for analysis OperatorImpact...
2022-09-21 18:55:35 INFO  ---RUNTIME: Plan generation took 5.272150039672852 ms
2022-09-21 18:55:35 INFO  Estimated runtime of original DAG is 8594.87771987915ms
2022-09-21 18:55:35 INFO  Performing Multi-Query Optimization
2022-09-21 18:55:35 INFO  Estimated unoptimized what-if runtime is 26758.64156639799ms
2022-09-21 18:55:35 INFO  Estimated optimised what-if runtime is 22440.5888015022ms
2022-09-21 18:55:35 INFO  Estimated optimisation runtime saving is 4318.0527648957905ms
2022-09-21 18:55:35 INFO  ---RUNTIME: Multi-Query Optimization took 110.65101623535156 ms
2022-09-21 18:55:35 INFO  Executing generated plans
2022-09-21 18:55:59 INFO  ---RUNTIME: Execution took 23904.093980789185 ms
2022-09-21 18:55:59 INFO  Done!
2022-09-21 18:55:59 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-21 18:55:59 INFO  Running instrumented original pipeline...
2022-09-21 18:55:59 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-21 18:55:59 INFO  ---RUNTIME: Importing and monkey-patching took 6.03938102722168 ms
2022-09-21 18:56:09 INFO  ---RUNTIME: Original pipeline execution took 10093.185424804688 ms (excluding imports and monkey-patching)
2022-09-21 18:56:09 INFO  Starting execution of 1 what-if analyses...
2022-09-21 18:56:09 INFO  Start plan generation for analysis OperatorImpact...
2022-09-21 18:56:09 INFO  ---RUNTIME: Plan generation took 4.537343978881836 ms
2022-09-21 18:56:09 INFO  Estimated runtime of original DAG is 8344.248056411743ms
2022-09-21 18:56:09 WARNING Skipping Multi-Query Optimization (instead, only applying patches)
2022-09-21 18:56:09 INFO  Estimated unoptimised what-if runtime is 25930.304432821387ms
2022-09-21 18:56:09 INFO  ---RUNTIME: Multi-Query Optimization took 14.000654220581055 ms
2022-09-21 18:56:09 INFO  Executing generated plans
2022-09-21 18:56:39 INFO  ---RUNTIME: Execution took 29939.769506454468 ms
2022-09-21 18:56:39 INFO  Done!
2022-09-21 18:56:39 INFO  # Finished -- repetition 2 of 7 
2022-09-21 18:56:39 INFO  # Optimization benchmark for operator_impact with args [['reviews', 'fast_loading', 'featurization_0', 'neural_network']] -- repetition 3 of 7
2022-09-21 18:56:39 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-21 18:56:39 INFO  Running instrumented original pipeline...
2022-09-21 18:56:39 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-21 18:56:39 INFO  ---RUNTIME: Importing and monkey-patching took 6.002664566040039 ms
2022-09-21 18:56:49 INFO  ---RUNTIME: Original pipeline execution took 10267.665386199951 ms (excluding imports and monkey-patching)
2022-09-21 18:56:49 INFO  Starting execution of 1 what-if analyses...
2022-09-21 18:56:49 INFO  Start plan generation for analysis OperatorImpact...
2022-09-21 18:56:49 INFO  ---RUNTIME: Plan generation took 4.434347152709961 ms
2022-09-21 18:56:49 INFO  Estimated runtime of original DAG is 8631.851434707642ms
2022-09-21 18:56:49 INFO  Performing Multi-Query Optimization
2022-09-21 18:56:49 INFO  Estimated unoptimized what-if runtime is 26881.08236415552ms
2022-09-21 18:56:49 INFO  Estimated optimised what-if runtime is 22701.784730541036ms
2022-09-21 18:56:49 INFO  Estimated optimisation runtime saving is 4179.297633614486ms
2022-09-21 18:56:49 INFO  ---RUNTIME: Multi-Query Optimization took 103.9421558380127 ms
2022-09-21 18:56:49 INFO  Executing generated plans
2022-09-21 18:57:14 INFO  ---RUNTIME: Execution took 24568.63570213318 ms
2022-09-21 18:57:14 INFO  Done!
2022-09-21 18:57:14 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-21 18:57:14 INFO  Running instrumented original pipeline...
2022-09-21 18:57:14 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-21 18:57:14 INFO  ---RUNTIME: Importing and monkey-patching took 6.590843200683594 ms
2022-09-21 18:57:24 INFO  ---RUNTIME: Original pipeline execution took 10280.040264129639 ms (excluding imports and monkey-patching)
2022-09-21 18:57:24 INFO  Starting execution of 1 what-if analyses...
2022-09-21 18:57:24 INFO  Start plan generation for analysis OperatorImpact...
2022-09-21 18:57:24 INFO  ---RUNTIME: Plan generation took 4.468679428100586 ms
2022-09-21 18:57:24 INFO  Estimated runtime of original DAG is 8605.815649032593ms
2022-09-21 18:57:24 WARNING Skipping Multi-Query Optimization (instead, only applying patches)
2022-09-21 18:57:24 INFO  Estimated unoptimised what-if runtime is 26745.29189771815ms
2022-09-21 18:57:24 INFO  ---RUNTIME: Multi-Query Optimization took 13.84592056274414 ms
2022-09-21 18:57:24 INFO  Executing generated plans
2022-09-21 18:57:55 INFO  ---RUNTIME: Execution took 30223.007440567017 ms
2022-09-21 18:57:55 INFO  Done!
2022-09-21 18:57:55 INFO  # Finished -- repetition 3 of 7 
2022-09-21 18:57:55 INFO  # Optimization benchmark for operator_impact with args [['reviews', 'fast_loading', 'featurization_0', 'neural_network']] -- repetition 4 of 7
2022-09-21 18:57:55 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-21 18:57:55 INFO  Running instrumented original pipeline...
2022-09-21 18:57:55 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-21 18:57:55 INFO  ---RUNTIME: Importing and monkey-patching took 6.676435470581055 ms
2022-09-21 18:58:05 INFO  ---RUNTIME: Original pipeline execution took 9957.940816879272 ms (excluding imports and monkey-patching)
2022-09-21 18:58:05 INFO  Starting execution of 1 what-if analyses...
2022-09-21 18:58:05 INFO  Start plan generation for analysis OperatorImpact...
2022-09-21 18:58:05 INFO  ---RUNTIME: Plan generation took 4.518985748291016 ms
2022-09-21 18:58:05 INFO  Estimated runtime of original DAG is 8307.453393936157ms
2022-09-21 18:58:05 INFO  Performing Multi-Query Optimization
2022-09-21 18:58:05 INFO  Estimated unoptimized what-if runtime is 25853.892325979697ms
2022-09-21 18:58:05 INFO  Estimated optimised what-if runtime is 21543.536733827776ms
2022-09-21 18:58:05 INFO  Estimated optimisation runtime saving is 4310.355592151922ms
2022-09-21 18:58:05 INFO  ---RUNTIME: Multi-Query Optimization took 111.8009090423584 ms
2022-09-21 18:58:05 INFO  Executing generated plans
2022-09-21 18:58:29 INFO  ---RUNTIME: Execution took 24364.651441574097 ms
2022-09-21 18:58:29 INFO  Done!
2022-09-21 18:58:29 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-21 18:58:29 INFO  Running instrumented original pipeline...
2022-09-21 18:58:29 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-21 18:58:29 INFO  ---RUNTIME: Importing and monkey-patching took 5.898952484130859 ms
2022-09-21 18:58:39 INFO  ---RUNTIME: Original pipeline execution took 10261.142492294312 ms (excluding imports and monkey-patching)
2022-09-21 18:58:39 INFO  Starting execution of 1 what-if analyses...
2022-09-21 18:58:39 INFO  Start plan generation for analysis OperatorImpact...
2022-09-21 18:58:39 INFO  ---RUNTIME: Plan generation took 4.313468933105469 ms
2022-09-21 18:58:39 INFO  Estimated runtime of original DAG is 8584.211826324463ms
2022-09-21 18:58:39 WARNING Skipping Multi-Query Optimization (instead, only applying patches)
2022-09-21 18:58:39 INFO  Estimated unoptimised what-if runtime is 26685.615684004904ms
2022-09-21 18:58:39 INFO  ---RUNTIME: Multi-Query Optimization took 15.404224395751953 ms
2022-09-21 18:58:39 INFO  Executing generated plans
2022-09-21 18:59:09 INFO  ---RUNTIME: Execution took 29939.033031463623 ms
2022-09-21 18:59:09 INFO  Done!
2022-09-21 18:59:09 INFO  # Finished -- repetition 4 of 7 
2022-09-21 18:59:09 INFO  # Optimization benchmark for operator_impact with args [['reviews', 'fast_loading', 'featurization_0', 'neural_network']] -- repetition 5 of 7
2022-09-21 18:59:09 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-21 18:59:09 INFO  Running instrumented original pipeline...
2022-09-21 18:59:10 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-21 18:59:10 INFO  ---RUNTIME: Importing and monkey-patching took 6.058216094970703 ms
2022-09-21 18:59:20 INFO  ---RUNTIME: Original pipeline execution took 10763.55242729187 ms (excluding imports and monkey-patching)
2022-09-21 18:59:20 INFO  Starting execution of 1 what-if analyses...
2022-09-21 18:59:20 INFO  Start plan generation for analysis OperatorImpact...
2022-09-21 18:59:20 INFO  ---RUNTIME: Plan generation took 4.445314407348633 ms
2022-09-21 18:59:20 INFO  Estimated runtime of original DAG is 8695.780992507935ms
2022-09-21 18:59:20 INFO  Performing Multi-Query Optimization
2022-09-21 18:59:20 INFO  Estimated unoptimized what-if runtime is 27078.920344415732ms
2022-09-21 18:59:20 INFO  Estimated optimised what-if runtime is 22830.521887572322ms
2022-09-21 18:59:20 INFO  Estimated optimisation runtime saving is 4248.39845684341ms
2022-09-21 18:59:20 INFO  ---RUNTIME: Multi-Query Optimization took 104.08234596252441 ms
2022-09-21 18:59:20 INFO  Executing generated plans
2022-09-21 18:59:44 INFO  ---RUNTIME: Execution took 23962.56446838379 ms
2022-09-21 18:59:44 INFO  Done!
2022-09-21 18:59:44 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-21 18:59:44 INFO  Running instrumented original pipeline...
2022-09-21 18:59:44 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-21 18:59:44 INFO  ---RUNTIME: Importing and monkey-patching took 6.118059158325195 ms
2022-09-21 18:59:54 INFO  ---RUNTIME: Original pipeline execution took 10189.411401748657 ms (excluding imports and monkey-patching)
2022-09-21 18:59:54 INFO  Starting execution of 1 what-if analyses...
2022-09-21 18:59:54 INFO  Start plan generation for analysis OperatorImpact...
2022-09-21 18:59:54 INFO  ---RUNTIME: Plan generation took 5.964756011962891 ms
2022-09-21 18:59:54 INFO  Estimated runtime of original DAG is 8482.682228088379ms
2022-09-21 18:59:54 WARNING Skipping Multi-Query Optimization (instead, only applying patches)
2022-09-21 18:59:54 INFO  Estimated unoptimised what-if runtime is 26346.87210403278ms
2022-09-21 18:59:54 INFO  ---RUNTIME: Multi-Query Optimization took 15.194177627563477 ms
2022-09-21 18:59:54 INFO  Executing generated plans
2022-09-21 19:00:25 INFO  ---RUNTIME: Execution took 30329.90550994873 ms
2022-09-21 19:00:25 INFO  Done!
2022-09-21 19:00:25 INFO  # Finished -- repetition 5 of 7 
2022-09-21 19:00:25 INFO  # Optimization benchmark for operator_impact with args [['reviews', 'fast_loading', 'featurization_0', 'neural_network']] -- repetition 6 of 7
2022-09-21 19:00:25 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-21 19:00:25 INFO  Running instrumented original pipeline...
2022-09-21 19:00:25 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-21 19:00:25 INFO  ---RUNTIME: Importing and monkey-patching took 6.356239318847656 ms
2022-09-21 19:00:35 INFO  ---RUNTIME: Original pipeline execution took 10336.681604385376 ms (excluding imports and monkey-patching)
2022-09-21 19:00:35 INFO  Starting execution of 1 what-if analyses...
2022-09-21 19:00:35 INFO  Start plan generation for analysis OperatorImpact...
2022-09-21 19:00:35 INFO  ---RUNTIME: Plan generation took 5.109548568725586 ms
2022-09-21 19:00:35 INFO  Estimated runtime of original DAG is 8589.369773864746ms
2022-09-21 19:00:35 INFO  Performing Multi-Query Optimization
2022-09-21 19:00:35 INFO  Estimated unoptimized what-if runtime is 26700.643791639195ms
2022-09-21 19:00:35 INFO  Estimated optimised what-if runtime is 22082.700112353876ms
2022-09-21 19:00:35 INFO  Estimated optimisation runtime saving is 4617.943679285319ms
2022-09-21 19:00:35 INFO  ---RUNTIME: Multi-Query Optimization took 107.44309425354004 ms
2022-09-21 19:00:35 INFO  Executing generated plans
2022-09-21 19:01:00 INFO  ---RUNTIME: Execution took 24515.605449676514 ms
2022-09-21 19:01:00 INFO  Done!
2022-09-21 19:01:00 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-21 19:01:00 INFO  Running instrumented original pipeline...
2022-09-21 19:01:00 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-21 19:01:00 INFO  ---RUNTIME: Importing and monkey-patching took 5.756378173828125 ms
2022-09-21 19:01:10 INFO  ---RUNTIME: Original pipeline execution took 10766.686201095581 ms (excluding imports and monkey-patching)
2022-09-21 19:01:10 INFO  Starting execution of 1 what-if analyses...
2022-09-21 19:01:10 INFO  Start plan generation for analysis OperatorImpact...
2022-09-21 19:01:10 INFO  ---RUNTIME: Plan generation took 4.282712936401367 ms
2022-09-21 19:01:10 INFO  Estimated runtime of original DAG is 9130.376100540161ms
2022-09-21 19:01:10 WARNING Skipping Multi-Query Optimization (instead, only applying patches)
2022-09-21 19:01:10 INFO  Estimated unoptimised what-if runtime is 28406.976638242217ms
2022-09-21 19:01:10 INFO  ---RUNTIME: Multi-Query Optimization took 13.849258422851562 ms
2022-09-21 19:01:10 INFO  Executing generated plans
2022-09-21 19:01:40 INFO  ---RUNTIME: Execution took 29772.687673568726 ms
2022-09-21 19:01:40 INFO  Done!
2022-09-21 19:01:40 INFO  # Finished -- repetition 6 of 7 
2022-09-21 19:01:40 INFO  # Optimization benchmark for operator_impact with args [['reviews', 'fast_loading', 'featurization_0', 'neural_network']] -- repetition 7 of 7
2022-09-21 19:01:40 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-21 19:01:40 INFO  Running instrumented original pipeline...
2022-09-21 19:01:40 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-21 19:01:40 INFO  ---RUNTIME: Importing and monkey-patching took 6.126880645751953 ms
2022-09-21 19:01:51 INFO  ---RUNTIME: Original pipeline execution took 10555.003881454468 ms (excluding imports and monkey-patching)
2022-09-21 19:01:51 INFO  Starting execution of 1 what-if analyses...
2022-09-21 19:01:51 INFO  Start plan generation for analysis OperatorImpact...
2022-09-21 19:01:51 INFO  ---RUNTIME: Plan generation took 4.409551620483398 ms
2022-09-21 19:01:51 INFO  Estimated runtime of original DAG is 8885.642766952515ms
2022-09-21 19:01:51 INFO  Performing Multi-Query Optimization
2022-09-21 19:01:51 INFO  Estimated unoptimized what-if runtime is 27680.297379937772ms
2022-09-21 19:01:51 INFO  Estimated optimised what-if runtime is 23493.019246913285ms
2022-09-21 19:01:51 INFO  Estimated optimisation runtime saving is 4187.278133024487ms
2022-09-21 19:01:51 INFO  ---RUNTIME: Multi-Query Optimization took 101.2411117553711 ms
2022-09-21 19:01:51 INFO  Executing generated plans
2022-09-21 19:02:15 INFO  ---RUNTIME: Execution took 24168.102979660034 ms
2022-09-21 19:02:15 INFO  Done!
2022-09-21 19:02:15 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-21 19:02:15 INFO  Running instrumented original pipeline...
2022-09-21 19:02:15 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-21 19:02:15 INFO  ---RUNTIME: Importing and monkey-patching took 5.964040756225586 ms
2022-09-21 19:02:25 INFO  ---RUNTIME: Original pipeline execution took 10126.262187957764 ms (excluding imports and monkey-patching)
2022-09-21 19:02:25 INFO  Starting execution of 1 what-if analyses...
2022-09-21 19:02:25 INFO  Start plan generation for analysis OperatorImpact...
2022-09-21 19:02:25 INFO  ---RUNTIME: Plan generation took 4.240989685058594 ms
2022-09-21 19:02:25 INFO  Estimated runtime of original DAG is 8344.865798950195ms
2022-09-21 19:02:25 WARNING Skipping Multi-Query Optimization (instead, only applying patches)
2022-09-21 19:02:25 INFO  Estimated unoptimised what-if runtime is 25927.244214504055ms
2022-09-21 19:02:25 INFO  ---RUNTIME: Multi-Query Optimization took 13.727903366088867 ms
2022-09-21 19:02:25 INFO  Executing generated plans
2022-09-21 19:02:55 INFO  ---RUNTIME: Execution took 29745.033740997314 ms
2022-09-21 19:02:55 INFO  Done!
2022-09-21 19:02:55 INFO  # Finished -- repetition 7 of 7 
2022-09-21 19:02:55 INFO  # Final results after all repetitions
2022-09-21 19:02:55 INFO     repetition  ... no_opt_what_if_execution_combined_model_training
0           0  ...                                     11367.650270
1           1  ...                                     11047.268391
2           2  ...                                     11652.525187
3           3  ...                                     11043.024540
4           4  ...                                     11464.361429
5           5  ...                                     11020.560741
6           6  ...                                     10612.957954

[7 rows x 26 columns]
taskset -c 160-167 PROTOCOL_BUFFERS_PYTHON_IMPLEMENTATION=python python3.9 benchmarks_end_to_end.py operator_impact reviews fast_loading featurization_1 logistic_regression
2022-09-21 19:02:58.014925: W tensorflow/stream_executor/platform/default/dso_loader.cc:64] Could not load dynamic library 'libcudart.so.11.0'; dlerror: libcudart.so.11.0: cannot open shared object file: No such file or directory; LD_LIBRARY_PATH: /home/sgrafbe/mlwhatif/venv/lib/python3.9/site-packages/cv2/../../lib64:
2022-09-21 19:02:58.014973: I tensorflow/stream_executor/cuda/cudart_stub.cc:29] Ignore above cudart dlerror if you do not have a GPU set up on your machine.
2022-09-21 19:02:59 INFO  Patching sys.argv with ['mlwhatif', 'reviews', 'fast_loading', 'featurization_1', 'logistic_regression']
2022-09-21 19:02:59 INFO  Running instrumented original pipeline...
2022-09-21 19:02:59 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-21 19:02:59 INFO  ---RUNTIME: Importing and monkey-patching took 122.26486206054688 ms
2022-09-21 19:03:06 INFO  ---RUNTIME: Original pipeline execution took 7107.2869300842285 ms (excluding imports and monkey-patching)
2022-09-21 19:03:06 INFO  Starting execution of 0 what-if analyses...
2022-09-21 19:03:06 INFO  Estimated runtime of original DAG is 4884.117841720581ms
2022-09-21 19:03:06 INFO  Performing Multi-Query Optimization
2022-09-21 19:03:06 INFO  Estimated unoptimized what-if runtime is 0ms
2022-09-21 19:03:06 INFO  Estimated optimised what-if runtime is 0ms
2022-09-21 19:03:06 INFO  Estimated optimisation runtime saving is 0ms
2022-09-21 19:03:06 INFO  ---RUNTIME: Multi-Query Optimization took 0.5381107330322266 ms
2022-09-21 19:03:06 INFO  Executing generated plans
2022-09-21 19:03:06 INFO  ---RUNTIME: Execution took 0.026941299438476562 ms
2022-09-21 19:03:06 INFO  Done!
2022-09-21 19:03:06 INFO  # Optimization benchmark for operator_impact with args [['reviews', 'fast_loading', 'featurization_1', 'logistic_regression']] -- repetition 1 of 7
2022-09-21 19:03:06 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-21 19:03:06 INFO  Running instrumented original pipeline...
2022-09-21 19:03:06 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-21 19:03:06 INFO  ---RUNTIME: Importing and monkey-patching took 7.105112075805664 ms
2022-09-21 19:03:14 INFO  ---RUNTIME: Original pipeline execution took 7609.330177307129 ms (excluding imports and monkey-patching)
2022-09-21 19:03:14 INFO  Starting execution of 1 what-if analyses...
2022-09-21 19:03:14 INFO  Start plan generation for analysis OperatorImpact...
2022-09-21 19:03:14 INFO  ---RUNTIME: Plan generation took 5.621194839477539 ms
2022-09-21 19:03:14 INFO  Estimated runtime of original DAG is 5196.387052536011ms
2022-09-21 19:03:14 INFO  Performing Multi-Query Optimization
2022-09-21 19:03:14 INFO  Estimated unoptimized what-if runtime is 26495.267871149015ms
2022-09-21 19:03:14 INFO  Estimated optimised what-if runtime is 12026.183953308362ms
2022-09-21 19:03:14 INFO  Estimated optimisation runtime saving is 14469.083917840653ms
2022-09-21 19:03:14 INFO  ---RUNTIME: Multi-Query Optimization took 112.02263832092285 ms
2022-09-21 19:03:14 INFO  Executing generated plans
2022-09-21 19:03:26 INFO  ---RUNTIME: Execution took 12579.246282577515 ms
2022-09-21 19:03:26 INFO  Done!
2022-09-21 19:03:26 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-21 19:03:26 INFO  Running instrumented original pipeline...
2022-09-21 19:03:26 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-21 19:03:26 INFO  ---RUNTIME: Importing and monkey-patching took 6.143093109130859 ms
2022-09-21 19:03:34 INFO  ---RUNTIME: Original pipeline execution took 7276.9775390625 ms (excluding imports and monkey-patching)
2022-09-21 19:03:34 INFO  Starting execution of 1 what-if analyses...
2022-09-21 19:03:34 INFO  Start plan generation for analysis OperatorImpact...
2022-09-21 19:03:34 INFO  ---RUNTIME: Plan generation took 4.922389984130859 ms
2022-09-21 19:03:34 INFO  Estimated runtime of original DAG is 5032.299757003784ms
2022-09-21 19:03:34 WARNING Skipping Multi-Query Optimization (instead, only applying patches)
2022-09-21 19:03:34 INFO  Estimated unoptimised what-if runtime is 25558.216585961567ms
2022-09-21 19:03:34 INFO  ---RUNTIME: Multi-Query Optimization took 15.572547912597656 ms
2022-09-21 19:03:34 INFO  Executing generated plans
2022-09-21 19:04:03 INFO  ---RUNTIME: Execution took 29642.603397369385 ms
2022-09-21 19:04:03 INFO  Done!
2022-09-21 19:04:03 INFO  # Finished -- repetition 1 of 7 
2022-09-21 19:04:03 INFO  # Optimization benchmark for operator_impact with args [['reviews', 'fast_loading', 'featurization_1', 'logistic_regression']] -- repetition 2 of 7
2022-09-21 19:04:03 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-21 19:04:03 INFO  Running instrumented original pipeline...
2022-09-21 19:04:03 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-21 19:04:03 INFO  ---RUNTIME: Importing and monkey-patching took 6.127119064331055 ms
2022-09-21 19:04:11 INFO  ---RUNTIME: Original pipeline execution took 7280.1833152771 ms (excluding imports and monkey-patching)
2022-09-21 19:04:11 INFO  Starting execution of 1 what-if analyses...
2022-09-21 19:04:11 INFO  Start plan generation for analysis OperatorImpact...
2022-09-21 19:04:11 INFO  ---RUNTIME: Plan generation took 4.904985427856445 ms
2022-09-21 19:04:11 INFO  Estimated runtime of original DAG is 5003.412961959839ms
2022-09-21 19:04:11 INFO  Performing Multi-Query Optimization
2022-09-21 19:04:11 INFO  Estimated unoptimized what-if runtime is 25513.746971650326ms
2022-09-21 19:04:11 INFO  Estimated optimised what-if runtime is 11461.165966662255ms
2022-09-21 19:04:11 INFO  Estimated optimisation runtime saving is 14052.581004988071ms
2022-09-21 19:04:11 INFO  ---RUNTIME: Multi-Query Optimization took 111.86695098876953 ms
2022-09-21 19:04:11 INFO  Executing generated plans
2022-09-21 19:04:23 INFO  ---RUNTIME: Execution took 12339.012145996094 ms
2022-09-21 19:04:23 INFO  Done!
2022-09-21 19:04:23 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-21 19:04:23 INFO  Running instrumented original pipeline...
2022-09-21 19:04:23 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-21 19:04:23 INFO  ---RUNTIME: Importing and monkey-patching took 5.95545768737793 ms
2022-09-21 19:04:30 INFO  ---RUNTIME: Original pipeline execution took 7066.138505935669 ms (excluding imports and monkey-patching)
2022-09-21 19:04:30 INFO  Starting execution of 1 what-if analyses...
2022-09-21 19:04:30 INFO  Start plan generation for analysis OperatorImpact...
2022-09-21 19:04:30 INFO  ---RUNTIME: Plan generation took 4.74238395690918 ms
2022-09-21 19:04:30 INFO  Estimated runtime of original DAG is 4853.865146636963ms
2022-09-21 19:04:30 WARNING Skipping Multi-Query Optimization (instead, only applying patches)
2022-09-21 19:04:30 INFO  Estimated unoptimised what-if runtime is 24644.789790643725ms
2022-09-21 19:04:30 INFO  ---RUNTIME: Multi-Query Optimization took 15.484809875488281 ms
2022-09-21 19:04:30 INFO  Executing generated plans
2022-09-21 19:04:59 INFO  ---RUNTIME: Execution took 29009.231328964233 ms
2022-09-21 19:04:59 INFO  Done!
2022-09-21 19:04:59 INFO  # Finished -- repetition 2 of 7 
2022-09-21 19:04:59 INFO  # Optimization benchmark for operator_impact with args [['reviews', 'fast_loading', 'featurization_1', 'logistic_regression']] -- repetition 3 of 7
2022-09-21 19:04:59 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-21 19:04:59 INFO  Running instrumented original pipeline...
2022-09-21 19:04:59 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-21 19:04:59 INFO  ---RUNTIME: Importing and monkey-patching took 6.118535995483398 ms
2022-09-21 19:05:06 INFO  ---RUNTIME: Original pipeline execution took 7076.522588729858 ms (excluding imports and monkey-patching)
2022-09-21 19:05:06 INFO  Starting execution of 1 what-if analyses...
2022-09-21 19:05:06 INFO  Start plan generation for analysis OperatorImpact...
2022-09-21 19:05:06 INFO  ---RUNTIME: Plan generation took 4.895687103271484 ms
2022-09-21 19:05:06 INFO  Estimated runtime of original DAG is 4861.576795578003ms
2022-09-21 19:05:06 INFO  Performing Multi-Query Optimization
2022-09-21 19:05:06 INFO  Estimated unoptimized what-if runtime is 24782.598934394355ms
2022-09-21 19:05:06 INFO  Estimated optimised what-if runtime is 11210.11960024805ms
2022-09-21 19:05:06 INFO  Estimated optimisation runtime saving is 13572.479334146305ms
2022-09-21 19:05:06 INFO  ---RUNTIME: Multi-Query Optimization took 111.79280281066895 ms
2022-09-21 19:05:06 INFO  Executing generated plans
2022-09-21 19:05:19 INFO  ---RUNTIME: Execution took 12345.42727470398 ms
2022-09-21 19:05:19 INFO  Done!
2022-09-21 19:05:19 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-21 19:05:19 INFO  Running instrumented original pipeline...
2022-09-21 19:05:19 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-21 19:05:19 INFO  ---RUNTIME: Importing and monkey-patching took 6.1092376708984375 ms
2022-09-21 19:05:26 INFO  ---RUNTIME: Original pipeline execution took 7077.507972717285 ms (excluding imports and monkey-patching)
2022-09-21 19:05:26 INFO  Starting execution of 1 what-if analyses...
2022-09-21 19:05:26 INFO  Start plan generation for analysis OperatorImpact...
2022-09-21 19:05:26 INFO  ---RUNTIME: Plan generation took 4.88734245300293 ms
2022-09-21 19:05:26 INFO  Estimated runtime of original DAG is 4863.796949386597ms
2022-09-21 19:05:26 WARNING Skipping Multi-Query Optimization (instead, only applying patches)
2022-09-21 19:05:26 INFO  Estimated unoptimised what-if runtime is 24710.353247231746ms
2022-09-21 19:05:26 INFO  ---RUNTIME: Multi-Query Optimization took 15.386819839477539 ms
2022-09-21 19:05:26 INFO  Executing generated plans
2022-09-21 19:05:55 INFO  ---RUNTIME: Execution took 29013.34238052368 ms
2022-09-21 19:05:55 INFO  Done!
2022-09-21 19:05:55 INFO  # Finished -- repetition 3 of 7 
2022-09-21 19:05:55 INFO  # Optimization benchmark for operator_impact with args [['reviews', 'fast_loading', 'featurization_1', 'logistic_regression']] -- repetition 4 of 7
2022-09-21 19:05:55 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-21 19:05:55 INFO  Running instrumented original pipeline...
2022-09-21 19:05:55 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-21 19:05:55 INFO  ---RUNTIME: Importing and monkey-patching took 6.026268005371094 ms
2022-09-21 19:06:02 INFO  ---RUNTIME: Original pipeline execution took 7401.276111602783 ms (excluding imports and monkey-patching)
2022-09-21 19:06:02 INFO  Starting execution of 1 what-if analyses...
2022-09-21 19:06:02 INFO  Start plan generation for analysis OperatorImpact...
2022-09-21 19:06:02 INFO  ---RUNTIME: Plan generation took 4.723072052001953 ms
2022-09-21 19:06:02 INFO  Estimated runtime of original DAG is 4880.590438842773ms
2022-09-21 19:06:02 INFO  Performing Multi-Query Optimization
2022-09-21 19:06:02 INFO  Estimated unoptimized what-if runtime is 24877.223249904535ms
2022-09-21 19:06:02 INFO  Estimated optimised what-if runtime is 11226.60854041582ms
2022-09-21 19:06:02 INFO  Estimated optimisation runtime saving is 13650.614709488715ms
2022-09-21 19:06:02 INFO  ---RUNTIME: Multi-Query Optimization took 111.2830638885498 ms
2022-09-21 19:06:02 INFO  Executing generated plans
2022-09-21 19:06:15 INFO  ---RUNTIME: Execution took 12406.708002090454 ms
2022-09-21 19:06:15 INFO  Done!
2022-09-21 19:06:15 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-21 19:06:15 INFO  Running instrumented original pipeline...
2022-09-21 19:06:15 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-21 19:06:15 INFO  ---RUNTIME: Importing and monkey-patching took 6.169319152832031 ms
2022-09-21 19:06:22 INFO  ---RUNTIME: Original pipeline execution took 7151.75461769104 ms (excluding imports and monkey-patching)
2022-09-21 19:06:22 INFO  Starting execution of 1 what-if analyses...
2022-09-21 19:06:22 INFO  Start plan generation for analysis OperatorImpact...
2022-09-21 19:06:22 INFO  ---RUNTIME: Plan generation took 4.791975021362305 ms
2022-09-21 19:06:22 INFO  Estimated runtime of original DAG is 4888.845443725586ms
2022-09-21 19:06:22 WARNING Skipping Multi-Query Optimization (instead, only applying patches)
2022-09-21 19:06:22 INFO  Estimated unoptimised what-if runtime is 24832.697940176953ms
2022-09-21 19:06:22 INFO  ---RUNTIME: Multi-Query Optimization took 15.674829483032227 ms
2022-09-21 19:06:22 INFO  Executing generated plans
2022-09-21 19:06:51 INFO  ---RUNTIME: Execution took 29328.15170288086 ms
2022-09-21 19:06:51 INFO  Done!
2022-09-21 19:06:51 INFO  # Finished -- repetition 4 of 7 
2022-09-21 19:06:51 INFO  # Optimization benchmark for operator_impact with args [['reviews', 'fast_loading', 'featurization_1', 'logistic_regression']] -- repetition 5 of 7
2022-09-21 19:06:51 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-21 19:06:51 INFO  Running instrumented original pipeline...
2022-09-21 19:06:51 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-21 19:06:51 INFO  ---RUNTIME: Importing and monkey-patching took 6.052732467651367 ms
2022-09-21 19:06:58 INFO  ---RUNTIME: Original pipeline execution took 7145.496368408203 ms (excluding imports and monkey-patching)
2022-09-21 19:06:58 INFO  Starting execution of 1 what-if analyses...
2022-09-21 19:06:58 INFO  Start plan generation for analysis OperatorImpact...
2022-09-21 19:06:58 INFO  ---RUNTIME: Plan generation took 4.749298095703125 ms
2022-09-21 19:06:58 INFO  Estimated runtime of original DAG is 4900.607109069824ms
2022-09-21 19:06:58 INFO  Performing Multi-Query Optimization
2022-09-21 19:06:59 INFO  Estimated unoptimized what-if runtime is 24974.39087253272ms
2022-09-21 19:06:59 INFO  Estimated optimised what-if runtime is 11251.42166159705ms
2022-09-21 19:06:59 INFO  Estimated optimisation runtime saving is 13722.96921093567ms
2022-09-21 19:06:59 INFO  ---RUNTIME: Multi-Query Optimization took 113.10887336730957 ms
2022-09-21 19:06:59 INFO  Executing generated plans
2022-09-21 19:07:11 INFO  ---RUNTIME: Execution took 12419.971942901611 ms
2022-09-21 19:07:11 INFO  Done!
2022-09-21 19:07:11 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-21 19:07:11 INFO  Running instrumented original pipeline...
2022-09-21 19:07:11 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-21 19:07:11 INFO  ---RUNTIME: Importing and monkey-patching took 8.824348449707031 ms
2022-09-21 19:07:18 INFO  ---RUNTIME: Original pipeline execution took 7162.124156951904 ms (excluding imports and monkey-patching)
2022-09-21 19:07:18 INFO  Starting execution of 1 what-if analyses...
2022-09-21 19:07:18 INFO  Start plan generation for analysis OperatorImpact...
2022-09-21 19:07:18 INFO  ---RUNTIME: Plan generation took 4.826784133911133 ms
2022-09-21 19:07:18 INFO  Estimated runtime of original DAG is 4905.297040939331ms
2022-09-21 19:07:18 WARNING Skipping Multi-Query Optimization (instead, only applying patches)
2022-09-21 19:07:18 INFO  Estimated unoptimised what-if runtime is 24920.033878307746ms
2022-09-21 19:07:18 INFO  ---RUNTIME: Multi-Query Optimization took 15.625 ms
2022-09-21 19:07:18 INFO  Executing generated plans
2022-09-21 19:07:48 INFO  ---RUNTIME: Execution took 29327.982187271118 ms
2022-09-21 19:07:48 INFO  Done!
2022-09-21 19:07:48 INFO  # Finished -- repetition 5 of 7 
2022-09-21 19:07:48 INFO  # Optimization benchmark for operator_impact with args [['reviews', 'fast_loading', 'featurization_1', 'logistic_regression']] -- repetition 6 of 7
2022-09-21 19:07:48 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-21 19:07:48 INFO  Running instrumented original pipeline...
2022-09-21 19:07:48 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-21 19:07:48 INFO  ---RUNTIME: Importing and monkey-patching took 5.973577499389648 ms
2022-09-21 19:07:55 INFO  ---RUNTIME: Original pipeline execution took 7100.938320159912 ms (excluding imports and monkey-patching)
2022-09-21 19:07:55 INFO  Starting execution of 1 what-if analyses...
2022-09-21 19:07:55 INFO  Start plan generation for analysis OperatorImpact...
2022-09-21 19:07:55 INFO  ---RUNTIME: Plan generation took 4.793405532836914 ms
2022-09-21 19:07:55 INFO  Estimated runtime of original DAG is 4879.256963729858ms
2022-09-21 19:07:55 INFO  Performing Multi-Query Optimization
2022-09-21 19:07:55 INFO  Estimated unoptimized what-if runtime is 24867.65165075704ms
2022-09-21 19:07:55 INFO  Estimated optimised what-if runtime is 11272.116613689004ms
2022-09-21 19:07:55 INFO  Estimated optimisation runtime saving is 13595.535037068037ms
2022-09-21 19:07:55 INFO  ---RUNTIME: Multi-Query Optimization took 111.24968528747559 ms
2022-09-21 19:07:55 INFO  Executing generated plans
2022-09-21 19:08:07 INFO  ---RUNTIME: Execution took 12396.95143699646 ms
2022-09-21 19:08:07 INFO  Done!
2022-09-21 19:08:07 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-21 19:08:07 INFO  Running instrumented original pipeline...
2022-09-21 19:08:07 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-21 19:08:07 INFO  ---RUNTIME: Importing and monkey-patching took 6.007671356201172 ms
2022-09-21 19:08:14 INFO  ---RUNTIME: Original pipeline execution took 7180.429220199585 ms (excluding imports and monkey-patching)
2022-09-21 19:08:14 INFO  Starting execution of 1 what-if analyses...
2022-09-21 19:08:14 INFO  Start plan generation for analysis OperatorImpact...
2022-09-21 19:08:14 INFO  ---RUNTIME: Plan generation took 4.764318466186523 ms
2022-09-21 19:08:14 INFO  Estimated runtime of original DAG is 4962.212085723877ms
2022-09-21 19:08:14 WARNING Skipping Multi-Query Optimization (instead, only applying patches)
2022-09-21 19:08:14 INFO  Estimated unoptimised what-if runtime is 25210.85140520712ms
2022-09-21 19:08:14 INFO  ---RUNTIME: Multi-Query Optimization took 15.453100204467773 ms
2022-09-21 19:08:14 INFO  Executing generated plans
2022-09-21 19:08:44 INFO  ---RUNTIME: Execution took 29202.02612876892 ms
2022-09-21 19:08:44 INFO  Done!
2022-09-21 19:08:44 INFO  # Finished -- repetition 6 of 7 
2022-09-21 19:08:44 INFO  # Optimization benchmark for operator_impact with args [['reviews', 'fast_loading', 'featurization_1', 'logistic_regression']] -- repetition 7 of 7
2022-09-21 19:08:44 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-21 19:08:44 INFO  Running instrumented original pipeline...
2022-09-21 19:08:44 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-21 19:08:44 INFO  ---RUNTIME: Importing and monkey-patching took 6.150484085083008 ms
2022-09-21 19:08:51 INFO  ---RUNTIME: Original pipeline execution took 7106.992483139038 ms (excluding imports and monkey-patching)
2022-09-21 19:08:51 INFO  Starting execution of 1 what-if analyses...
2022-09-21 19:08:51 INFO  Start plan generation for analysis OperatorImpact...
2022-09-21 19:08:51 INFO  ---RUNTIME: Plan generation took 4.891395568847656 ms
2022-09-21 19:08:51 INFO  Estimated runtime of original DAG is 4888.46492767334ms
2022-09-21 19:08:51 INFO  Performing Multi-Query Optimization
2022-09-21 19:08:51 INFO  Estimated unoptimized what-if runtime is 24916.433533966774ms
2022-09-21 19:08:51 INFO  Estimated optimised what-if runtime is 11256.91836763938ms
2022-09-21 19:08:51 INFO  Estimated optimisation runtime saving is 13659.515166327394ms
2022-09-21 19:08:51 INFO  ---RUNTIME: Multi-Query Optimization took 112.39123344421387 ms
2022-09-21 19:08:51 INFO  Executing generated plans
2022-09-21 19:09:03 INFO  ---RUNTIME: Execution took 12433.088302612305 ms
2022-09-21 19:09:03 INFO  Done!
2022-09-21 19:09:03 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-21 19:09:03 INFO  Running instrumented original pipeline...
2022-09-21 19:09:04 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-21 19:09:04 INFO  ---RUNTIME: Importing and monkey-patching took 5.898475646972656 ms
2022-09-21 19:09:11 INFO  ---RUNTIME: Original pipeline execution took 7557.499647140503 ms (excluding imports and monkey-patching)
2022-09-21 19:09:11 INFO  Starting execution of 1 what-if analyses...
2022-09-21 19:09:11 INFO  Start plan generation for analysis OperatorImpact...
2022-09-21 19:09:11 INFO  ---RUNTIME: Plan generation took 4.84466552734375 ms
2022-09-21 19:09:11 INFO  Estimated runtime of original DAG is 4971.92120552063ms
2022-09-21 19:09:11 WARNING Skipping Multi-Query Optimization (instead, only applying patches)
2022-09-21 19:09:11 INFO  Estimated unoptimised what-if runtime is 25257.179683384442ms
2022-09-21 19:09:11 INFO  ---RUNTIME: Multi-Query Optimization took 15.595197677612305 ms
2022-09-21 19:09:11 INFO  Executing generated plans
2022-09-21 19:09:40 INFO  ---RUNTIME: Execution took 29600.80122947693 ms
2022-09-21 19:09:40 INFO  Done!
2022-09-21 19:09:40 INFO  # Finished -- repetition 7 of 7 
2022-09-21 19:09:40 INFO  # Final results after all repetitions
2022-09-21 19:09:40 INFO     repetition  ... no_opt_what_if_execution_combined_model_training
0           0  ...                                       682.208061
1           1  ...                                       643.788815
2           2  ...                                       644.317389
3           3  ...                                       632.220030
4           4  ...                                       643.755436
5           5  ...                                       640.239716
6           6  ...                                       662.440062

[7 rows x 26 columns]
taskset -c 160-167 PROTOCOL_BUFFERS_PYTHON_IMPLEMENTATION=python python3.9 benchmarks_end_to_end.py operator_impact reviews fast_loading featurization_1 xgboost
2022-09-21 19:09:43.222026: W tensorflow/stream_executor/platform/default/dso_loader.cc:64] Could not load dynamic library 'libcudart.so.11.0'; dlerror: libcudart.so.11.0: cannot open shared object file: No such file or directory; LD_LIBRARY_PATH: /home/sgrafbe/mlwhatif/venv/lib/python3.9/site-packages/cv2/../../lib64:
2022-09-21 19:09:43.222070: I tensorflow/stream_executor/cuda/cudart_stub.cc:29] Ignore above cudart dlerror if you do not have a GPU set up on your machine.
2022-09-21 19:09:44 INFO  Patching sys.argv with ['mlwhatif', 'reviews', 'fast_loading', 'featurization_1', 'xgboost']
2022-09-21 19:09:44 INFO  Running instrumented original pipeline...
2022-09-21 19:09:44 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-21 19:09:44 INFO  ---RUNTIME: Importing and monkey-patching took 120.81241607666016 ms
2022-09-21 19:09:52 INFO  ---RUNTIME: Original pipeline execution took 8146.250009536743 ms (excluding imports and monkey-patching)
2022-09-21 19:09:52 INFO  Starting execution of 0 what-if analyses...
2022-09-21 19:09:52 INFO  Estimated runtime of original DAG is 5904.604434967041ms
2022-09-21 19:09:52 INFO  Performing Multi-Query Optimization
2022-09-21 19:09:52 INFO  Estimated unoptimized what-if runtime is 0ms
2022-09-21 19:09:52 INFO  Estimated optimised what-if runtime is 0ms
2022-09-21 19:09:52 INFO  Estimated optimisation runtime saving is 0ms
2022-09-21 19:09:52 INFO  ---RUNTIME: Multi-Query Optimization took 0.4715919494628906 ms
2022-09-21 19:09:52 INFO  Executing generated plans
2022-09-21 19:09:52 INFO  ---RUNTIME: Execution took 0.029802322387695312 ms
2022-09-21 19:09:52 INFO  Done!
2022-09-21 19:09:52 INFO  # Optimization benchmark for operator_impact with args [['reviews', 'fast_loading', 'featurization_1', 'xgboost']] -- repetition 1 of 7
2022-09-21 19:09:52 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-21 19:09:52 INFO  Running instrumented original pipeline...
2022-09-21 19:09:52 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-21 19:09:52 INFO  ---RUNTIME: Importing and monkey-patching took 6.114482879638672 ms
2022-09-21 19:10:00 INFO  ---RUNTIME: Original pipeline execution took 8081.029653549194 ms (excluding imports and monkey-patching)
2022-09-21 19:10:00 INFO  Starting execution of 1 what-if analyses...
2022-09-21 19:10:00 INFO  Start plan generation for analysis OperatorImpact...
2022-09-21 19:10:00 INFO  ---RUNTIME: Plan generation took 8.257150650024414 ms
2022-09-21 19:10:00 INFO  Estimated runtime of original DAG is 5681.734561920166ms
2022-09-21 19:10:00 INFO  Performing Multi-Query Optimization
2022-09-21 19:10:01 INFO  Estimated unoptimized what-if runtime is 29008.088573738118ms
2022-09-21 19:10:01 INFO  Estimated optimised what-if runtime is 15492.508131360928ms
2022-09-21 19:10:01 INFO  Estimated optimisation runtime saving is 13515.58044237719ms
2022-09-21 19:10:01 INFO  ---RUNTIME: Multi-Query Optimization took 131.73675537109375 ms
2022-09-21 19:10:01 INFO  Executing generated plans
2022-09-21 19:10:18 INFO  ---RUNTIME: Execution took 17033.41770172119 ms
2022-09-21 19:10:18 INFO  Done!
2022-09-21 19:10:18 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-21 19:10:18 INFO  Running instrumented original pipeline...
2022-09-21 19:10:18 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-21 19:10:18 INFO  ---RUNTIME: Importing and monkey-patching took 6.182432174682617 ms
2022-09-21 19:10:26 INFO  ---RUNTIME: Original pipeline execution took 8177.027225494385 ms (excluding imports and monkey-patching)
2022-09-21 19:10:26 INFO  Starting execution of 1 what-if analyses...
2022-09-21 19:10:26 INFO  Start plan generation for analysis OperatorImpact...
2022-09-21 19:10:26 INFO  ---RUNTIME: Plan generation took 6.970643997192383 ms
2022-09-21 19:10:26 INFO  Estimated runtime of original DAG is 5972.310543060303ms
2022-09-21 19:10:26 WARNING Skipping Multi-Query Optimization (instead, only applying patches)
2022-09-21 19:10:26 INFO  Estimated unoptimised what-if runtime is 30410.79251403686ms
2022-09-21 19:10:26 INFO  ---RUNTIME: Multi-Query Optimization took 22.377490997314453 ms
2022-09-21 19:10:26 INFO  Executing generated plans
2022-09-21 19:11:01 INFO  ---RUNTIME: Execution took 34914.43371772766 ms
2022-09-21 19:11:01 INFO  Done!
2022-09-21 19:11:01 INFO  # Finished -- repetition 1 of 7 
2022-09-21 19:11:01 INFO  # Optimization benchmark for operator_impact with args [['reviews', 'fast_loading', 'featurization_1', 'xgboost']] -- repetition 2 of 7
2022-09-21 19:11:01 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-21 19:11:01 INFO  Running instrumented original pipeline...
2022-09-21 19:11:01 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-21 19:11:01 INFO  ---RUNTIME: Importing and monkey-patching took 6.081819534301758 ms
2022-09-21 19:11:09 INFO  ---RUNTIME: Original pipeline execution took 8186.081171035767 ms (excluding imports and monkey-patching)
2022-09-21 19:11:09 INFO  Starting execution of 1 what-if analyses...
2022-09-21 19:11:09 INFO  Start plan generation for analysis OperatorImpact...
2022-09-21 19:11:09 INFO  ---RUNTIME: Plan generation took 4.961729049682617 ms
2022-09-21 19:11:09 INFO  Estimated runtime of original DAG is 5965.102672576904ms
2022-09-21 19:11:09 INFO  Performing Multi-Query Optimization
2022-09-21 19:11:09 INFO  Estimated unoptimized what-if runtime is 30454.759481302368ms
2022-09-21 19:11:09 INFO  Estimated optimised what-if runtime is 16406.02953777578ms
2022-09-21 19:11:09 INFO  Estimated optimisation runtime saving is 14048.729943526589ms
2022-09-21 19:11:09 INFO  ---RUNTIME: Multi-Query Optimization took 112.8394603729248 ms
2022-09-21 19:11:09 INFO  Executing generated plans
2022-09-21 19:11:27 INFO  ---RUNTIME: Execution took 17937.163829803467 ms
2022-09-21 19:11:27 INFO  Done!
2022-09-21 19:11:27 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-21 19:11:27 INFO  Running instrumented original pipeline...
2022-09-21 19:11:27 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-21 19:11:27 INFO  ---RUNTIME: Importing and monkey-patching took 6.122589111328125 ms
2022-09-21 19:11:35 INFO  ---RUNTIME: Original pipeline execution took 8247.21360206604 ms (excluding imports and monkey-patching)
2022-09-21 19:11:35 INFO  Starting execution of 1 what-if analyses...
2022-09-21 19:11:35 INFO  Start plan generation for analysis OperatorImpact...
2022-09-21 19:11:35 INFO  ---RUNTIME: Plan generation took 5.016088485717773 ms
2022-09-21 19:11:35 INFO  Estimated runtime of original DAG is 5787.927627563477ms
2022-09-21 19:11:35 WARNING Skipping Multi-Query Optimization (instead, only applying patches)
2022-09-21 19:11:35 INFO  Estimated unoptimised what-if runtime is 29463.476307498455ms
2022-09-21 19:11:35 INFO  ---RUNTIME: Multi-Query Optimization took 15.760421752929688 ms
2022-09-21 19:11:35 INFO  Executing generated plans
2022-09-21 19:12:10 INFO  ---RUNTIME: Execution took 35124.84622001648 ms
2022-09-21 19:12:10 INFO  Done!
2022-09-21 19:12:10 INFO  # Finished -- repetition 2 of 7 
2022-09-21 19:12:10 INFO  # Optimization benchmark for operator_impact with args [['reviews', 'fast_loading', 'featurization_1', 'xgboost']] -- repetition 3 of 7
2022-09-21 19:12:10 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-21 19:12:10 INFO  Running instrumented original pipeline...
2022-09-21 19:12:10 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-21 19:12:10 INFO  ---RUNTIME: Importing and monkey-patching took 6.013154983520508 ms
2022-09-21 19:12:19 INFO  ---RUNTIME: Original pipeline execution took 8539.355993270874 ms (excluding imports and monkey-patching)
2022-09-21 19:12:19 INFO  Starting execution of 1 what-if analyses...
2022-09-21 19:12:19 INFO  Start plan generation for analysis OperatorImpact...
2022-09-21 19:12:19 INFO  ---RUNTIME: Plan generation took 4.881620407104492 ms
2022-09-21 19:12:19 INFO  Estimated runtime of original DAG is 6292.97661781311ms
2022-09-21 19:12:19 INFO  Performing Multi-Query Optimization
2022-09-21 19:12:19 INFO  Estimated unoptimized what-if runtime is 32097.76466530646ms
2022-09-21 19:12:19 INFO  Estimated optimised what-if runtime is 16760.17651051397ms
2022-09-21 19:12:19 INFO  Estimated optimisation runtime saving is 15337.588154792487ms
2022-09-21 19:12:19 INFO  ---RUNTIME: Multi-Query Optimization took 111.66882514953613 ms
2022-09-21 19:12:19 INFO  Executing generated plans
2022-09-21 19:12:36 INFO  ---RUNTIME: Execution took 17471.3077545166 ms
2022-09-21 19:12:36 INFO  Done!
2022-09-21 19:12:36 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-21 19:12:36 INFO  Running instrumented original pipeline...
2022-09-21 19:12:37 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-21 19:12:37 INFO  ---RUNTIME: Importing and monkey-patching took 5.934476852416992 ms
2022-09-21 19:12:45 INFO  ---RUNTIME: Original pipeline execution took 8219.110250473022 ms (excluding imports and monkey-patching)
2022-09-21 19:12:45 INFO  Starting execution of 1 what-if analyses...
2022-09-21 19:12:45 INFO  Start plan generation for analysis OperatorImpact...
2022-09-21 19:12:45 INFO  ---RUNTIME: Plan generation took 4.844427108764648 ms
2022-09-21 19:12:45 INFO  Estimated runtime of original DAG is 5859.919548034668ms
2022-09-21 19:12:45 WARNING Skipping Multi-Query Optimization (instead, only applying patches)
2022-09-21 19:12:45 INFO  Estimated unoptimised what-if runtime is 29834.20161910284ms
2022-09-21 19:12:45 INFO  ---RUNTIME: Multi-Query Optimization took 15.62356948852539 ms
2022-09-21 19:12:45 INFO  Executing generated plans
2022-09-21 19:13:20 INFO  ---RUNTIME: Execution took 34904.747009277344 ms
2022-09-21 19:13:20 INFO  Done!
2022-09-21 19:13:20 INFO  # Finished -- repetition 3 of 7 
2022-09-21 19:13:20 INFO  # Optimization benchmark for operator_impact with args [['reviews', 'fast_loading', 'featurization_1', 'xgboost']] -- repetition 4 of 7
2022-09-21 19:13:20 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-21 19:13:20 INFO  Running instrumented original pipeline...
2022-09-21 19:13:20 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-21 19:13:20 INFO  ---RUNTIME: Importing and monkey-patching took 6.06846809387207 ms
2022-09-21 19:13:28 INFO  ---RUNTIME: Original pipeline execution took 8609.347581863403 ms (excluding imports and monkey-patching)
2022-09-21 19:13:28 INFO  Starting execution of 1 what-if analyses...
2022-09-21 19:13:28 INFO  Start plan generation for analysis OperatorImpact...
2022-09-21 19:13:28 INFO  ---RUNTIME: Plan generation took 4.723787307739258 ms
2022-09-21 19:13:28 INFO  Estimated runtime of original DAG is 5752.611875534058ms
2022-09-21 19:13:28 INFO  Performing Multi-Query Optimization
2022-09-21 19:13:28 INFO  Estimated unoptimized what-if runtime is 29364.08487268982ms
2022-09-21 19:13:28 INFO  Estimated optimised what-if runtime is 15651.676734523173ms
2022-09-21 19:13:28 INFO  Estimated optimisation runtime saving is 13712.408138166646ms
2022-09-21 19:13:28 INFO  ---RUNTIME: Multi-Query Optimization took 112.14780807495117 ms
2022-09-21 19:13:28 INFO  Executing generated plans
2022-09-21 19:13:46 INFO  ---RUNTIME: Execution took 17637.553215026855 ms
2022-09-21 19:13:46 INFO  Done!
2022-09-21 19:13:46 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-21 19:13:46 INFO  Running instrumented original pipeline...
2022-09-21 19:13:46 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-21 19:13:46 INFO  ---RUNTIME: Importing and monkey-patching took 6.38580322265625 ms
2022-09-21 19:13:54 INFO  ---RUNTIME: Original pipeline execution took 8304.45671081543 ms (excluding imports and monkey-patching)
2022-09-21 19:13:54 INFO  Starting execution of 1 what-if analyses...
2022-09-21 19:13:54 INFO  Start plan generation for analysis OperatorImpact...
2022-09-21 19:13:54 INFO  ---RUNTIME: Plan generation took 4.968404769897461 ms
2022-09-21 19:13:54 INFO  Estimated runtime of original DAG is 6028.6829471588135ms
2022-09-21 19:13:54 WARNING Skipping Multi-Query Optimization (instead, only applying patches)
2022-09-21 19:13:54 INFO  Estimated unoptimised what-if runtime is 30694.94428170172ms
2022-09-21 19:13:54 INFO  ---RUNTIME: Multi-Query Optimization took 15.903234481811523 ms
2022-09-21 19:13:54 INFO  Executing generated plans
2022-09-21 19:14:30 INFO  ---RUNTIME: Execution took 35209.413051605225 ms
2022-09-21 19:14:30 INFO  Done!
2022-09-21 19:14:30 INFO  # Finished -- repetition 4 of 7 
2022-09-21 19:14:30 INFO  # Optimization benchmark for operator_impact with args [['reviews', 'fast_loading', 'featurization_1', 'xgboost']] -- repetition 5 of 7
2022-09-21 19:14:30 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-21 19:14:30 INFO  Running instrumented original pipeline...
2022-09-21 19:14:30 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-21 19:14:30 INFO  ---RUNTIME: Importing and monkey-patching took 5.968332290649414 ms
2022-09-21 19:14:38 INFO  ---RUNTIME: Original pipeline execution took 8246.880292892456 ms (excluding imports and monkey-patching)
2022-09-21 19:14:38 INFO  Starting execution of 1 what-if analyses...
2022-09-21 19:14:38 INFO  Start plan generation for analysis OperatorImpact...
2022-09-21 19:14:38 INFO  ---RUNTIME: Plan generation took 5.000591278076172 ms
2022-09-21 19:14:38 INFO  Estimated runtime of original DAG is 5995.782852172852ms
2022-09-21 19:14:38 INFO  Performing Multi-Query Optimization
2022-09-21 19:14:38 INFO  Estimated unoptimized what-if runtime is 30611.029156369823ms
2022-09-21 19:14:38 INFO  Estimated optimised what-if runtime is 16405.39969397752ms
2022-09-21 19:14:38 INFO  Estimated optimisation runtime saving is 14205.629462392302ms
2022-09-21 19:14:38 INFO  ---RUNTIME: Multi-Query Optimization took 114.35389518737793 ms
2022-09-21 19:14:38 INFO  Executing generated plans
2022-09-21 19:14:55 INFO  ---RUNTIME: Execution took 17543.144702911377 ms
2022-09-21 19:14:55 INFO  Done!
2022-09-21 19:14:55 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-21 19:14:55 INFO  Running instrumented original pipeline...
2022-09-21 19:14:56 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-21 19:14:56 INFO  ---RUNTIME: Importing and monkey-patching took 6.1435699462890625 ms
2022-09-21 19:15:04 INFO  ---RUNTIME: Original pipeline execution took 8188.81368637085 ms (excluding imports and monkey-patching)
2022-09-21 19:15:04 INFO  Starting execution of 1 what-if analyses...
2022-09-21 19:15:04 INFO  Start plan generation for analysis OperatorImpact...
2022-09-21 19:15:04 INFO  ---RUNTIME: Plan generation took 4.749298095703125 ms
2022-09-21 19:15:04 INFO  Estimated runtime of original DAG is 5913.772344589233ms
2022-09-21 19:15:04 WARNING Skipping Multi-Query Optimization (instead, only applying patches)
2022-09-21 19:15:04 INFO  Estimated unoptimised what-if runtime is 30110.336051172955ms
2022-09-21 19:15:04 INFO  ---RUNTIME: Multi-Query Optimization took 15.341520309448242 ms
2022-09-21 19:15:04 INFO  Executing generated plans
2022-09-21 19:15:39 INFO  ---RUNTIME: Execution took 35194.2138671875 ms
2022-09-21 19:15:39 INFO  Done!
2022-09-21 19:15:39 INFO  # Finished -- repetition 5 of 7 
2022-09-21 19:15:39 INFO  # Optimization benchmark for operator_impact with args [['reviews', 'fast_loading', 'featurization_1', 'xgboost']] -- repetition 6 of 7
2022-09-21 19:15:39 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-21 19:15:39 INFO  Running instrumented original pipeline...
2022-09-21 19:15:39 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-21 19:15:39 INFO  ---RUNTIME: Importing and monkey-patching took 6.195306777954102 ms
2022-09-21 19:15:47 INFO  ---RUNTIME: Original pipeline execution took 8258.879899978638 ms (excluding imports and monkey-patching)
2022-09-21 19:15:47 INFO  Starting execution of 1 what-if analyses...
2022-09-21 19:15:47 INFO  Start plan generation for analysis OperatorImpact...
2022-09-21 19:15:47 INFO  ---RUNTIME: Plan generation took 4.951953887939453 ms
2022-09-21 19:15:47 INFO  Estimated runtime of original DAG is 5782.6995849609375ms
2022-09-21 19:15:47 INFO  Performing Multi-Query Optimization
2022-09-21 19:15:47 INFO  Estimated unoptimized what-if runtime is 29516.82356427845ms
2022-09-21 19:15:47 INFO  Estimated optimised what-if runtime is 15985.730186041148ms
2022-09-21 19:15:47 INFO  Estimated optimisation runtime saving is 13531.093378237301ms
2022-09-21 19:15:47 INFO  ---RUNTIME: Multi-Query Optimization took 112.22720146179199 ms
2022-09-21 19:15:47 INFO  Executing generated plans
2022-09-21 19:16:05 INFO  ---RUNTIME: Execution took 17376.232147216797 ms
2022-09-21 19:16:05 INFO  Done!
2022-09-21 19:16:05 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-21 19:16:05 INFO  Running instrumented original pipeline...
2022-09-21 19:16:05 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-21 19:16:05 INFO  ---RUNTIME: Importing and monkey-patching took 5.910158157348633 ms
2022-09-21 19:16:13 INFO  ---RUNTIME: Original pipeline execution took 8230.975866317749 ms (excluding imports and monkey-patching)
2022-09-21 19:16:13 INFO  Starting execution of 1 what-if analyses...
2022-09-21 19:16:13 INFO  Start plan generation for analysis OperatorImpact...
2022-09-21 19:16:13 INFO  ---RUNTIME: Plan generation took 4.732847213745117 ms
2022-09-21 19:16:13 INFO  Estimated runtime of original DAG is 5775.819778442383ms
2022-09-21 19:16:13 WARNING Skipping Multi-Query Optimization (instead, only applying patches)
2022-09-21 19:16:13 INFO  Estimated unoptimised what-if runtime is 29400.69803276656ms
2022-09-21 19:16:13 INFO  ---RUNTIME: Multi-Query Optimization took 15.766382217407227 ms
2022-09-21 19:16:13 INFO  Executing generated plans
2022-09-21 19:16:48 INFO  ---RUNTIME: Execution took 35451.4422416687 ms
2022-09-21 19:16:48 INFO  Done!
2022-09-21 19:16:48 INFO  # Finished -- repetition 6 of 7 
2022-09-21 19:16:48 INFO  # Optimization benchmark for operator_impact with args [['reviews', 'fast_loading', 'featurization_1', 'xgboost']] -- repetition 7 of 7
2022-09-21 19:16:48 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-21 19:16:48 INFO  Running instrumented original pipeline...
2022-09-21 19:16:48 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-21 19:16:48 INFO  ---RUNTIME: Importing and monkey-patching took 6.246805191040039 ms
2022-09-21 19:16:57 INFO  ---RUNTIME: Original pipeline execution took 8196.725368499756 ms (excluding imports and monkey-patching)
2022-09-21 19:16:57 INFO  Starting execution of 1 what-if analyses...
2022-09-21 19:16:57 INFO  Start plan generation for analysis OperatorImpact...
2022-09-21 19:16:57 INFO  ---RUNTIME: Plan generation took 4.909276962280273 ms
2022-09-21 19:16:57 INFO  Estimated runtime of original DAG is 5961.612701416016ms
2022-09-21 19:16:57 INFO  Performing Multi-Query Optimization
2022-09-21 19:16:57 INFO  Estimated unoptimized what-if runtime is 30441.515275696598ms
2022-09-21 19:16:57 INFO  Estimated optimised what-if runtime is 16303.255593765016ms
2022-09-21 19:16:57 INFO  Estimated optimisation runtime saving is 14138.259681931582ms
2022-09-21 19:16:57 INFO  ---RUNTIME: Multi-Query Optimization took 112.4734878540039 ms
2022-09-21 19:16:57 INFO  Executing generated plans
2022-09-21 19:17:14 INFO  ---RUNTIME: Execution took 17502.647399902344 ms
2022-09-21 19:17:14 INFO  Done!
2022-09-21 19:17:14 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-21 19:17:14 INFO  Running instrumented original pipeline...
2022-09-21 19:17:15 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-21 19:17:15 INFO  ---RUNTIME: Importing and monkey-patching took 5.971193313598633 ms
2022-09-21 19:17:23 INFO  ---RUNTIME: Original pipeline execution took 8929.232835769653 ms (excluding imports and monkey-patching)
2022-09-21 19:17:23 INFO  Starting execution of 1 what-if analyses...
2022-09-21 19:17:23 INFO  Start plan generation for analysis OperatorImpact...
2022-09-21 19:17:23 INFO  ---RUNTIME: Plan generation took 4.757165908813477 ms
2022-09-21 19:17:23 INFO  Estimated runtime of original DAG is 6334.503412246704ms
2022-09-21 19:17:23 WARNING Skipping Multi-Query Optimization (instead, only applying patches)
2022-09-21 19:17:23 INFO  Estimated unoptimised what-if runtime is 32224.087513564293ms
2022-09-21 19:17:23 INFO  ---RUNTIME: Multi-Query Optimization took 15.735864639282227 ms
2022-09-21 19:17:23 INFO  Executing generated plans
2022-09-21 19:17:58 INFO  ---RUNTIME: Execution took 34862.84637451172 ms
2022-09-21 19:17:58 INFO  Done!
2022-09-21 19:17:58 INFO  # Finished -- repetition 7 of 7 
2022-09-21 19:17:58 INFO  # Final results after all repetitions
2022-09-21 19:17:58 INFO     repetition  ... no_opt_what_if_execution_combined_model_training
0           0  ...                                      5212.924242
1           1  ...                                      5011.647940
2           2  ...                                      5477.923870
3           3  ...                                      5005.282402
4           4  ...                                      4880.629539
5           5  ...                                      4946.725607
6           6  ...                                      5097.629547

[7 rows x 26 columns]
taskset -c 160-167 PROTOCOL_BUFFERS_PYTHON_IMPLEMENTATION=python python3.9 benchmarks_end_to_end.py operator_impact reviews fast_loading featurization_1 neural_network
2022-09-21 19:18:00.751106: W tensorflow/stream_executor/platform/default/dso_loader.cc:64] Could not load dynamic library 'libcudart.so.11.0'; dlerror: libcudart.so.11.0: cannot open shared object file: No such file or directory; LD_LIBRARY_PATH: /home/sgrafbe/mlwhatif/venv/lib/python3.9/site-packages/cv2/../../lib64:
2022-09-21 19:18:00.751154: I tensorflow/stream_executor/cuda/cudart_stub.cc:29] Ignore above cudart dlerror if you do not have a GPU set up on your machine.
2022-09-21 19:18:02 INFO  Patching sys.argv with ['mlwhatif', 'reviews', 'fast_loading', 'featurization_1', 'neural_network']
2022-09-21 19:18:02 INFO  Running instrumented original pipeline...
2022-09-21 19:18:02 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-21 19:18:02 INFO  ---RUNTIME: Importing and monkey-patching took 120.99289894104004 ms
2022-09-21 19:18:07.967822: W tensorflow/stream_executor/platform/default/dso_loader.cc:64] Could not load dynamic library 'libcuda.so.1'; dlerror: libcuda.so.1: cannot open shared object file: No such file or directory; LD_LIBRARY_PATH: /home/sgrafbe/mlwhatif/venv/lib/python3.9/site-packages/cv2/../../lib64:
2022-09-21 19:18:07.967860: W tensorflow/stream_executor/cuda/cuda_driver.cc:326] failed call to cuInit: UNKNOWN ERROR (303)
2022-09-21 19:18:07.967889: I tensorflow/stream_executor/cuda/cuda_diagnostics.cc:156] kernel driver does not appear to be running on this host (angus): /proc/driver/nvidia/version does not exist
2022-09-21 19:18:07.968555: I tensorflow/core/platform/cpu_feature_guard.cc:142] This TensorFlow binary is optimized with oneAPI Deep Neural Network Library (oneDNN) to use the following CPU instructions in performance-critical operations:  AVX2 FMA
To enable them in other operations, rebuild TensorFlow with the appropriate compiler flags.
2022-09-21 19:18:08.218649: I tensorflow/compiler/mlir/mlir_graph_optimization_pass.cc:176] None of the MLIR Optimization Passes are enabled (registered 2)
2022-09-21 19:18:08.231200: I tensorflow/core/platform/profile_utils/cpu_utils.cc:114] CPU Frequency: 2595130000 Hz
2022-09-21 19:18:13 INFO  ---RUNTIME: Original pipeline execution took 11164.019584655762 ms (excluding imports and monkey-patching)
2022-09-21 19:18:13 INFO  Starting execution of 0 what-if analyses...
2022-09-21 19:18:13 INFO  Estimated runtime of original DAG is 8802.038192749023ms
2022-09-21 19:18:13 INFO  Performing Multi-Query Optimization
2022-09-21 19:18:13 INFO  Estimated unoptimized what-if runtime is 0ms
2022-09-21 19:18:13 INFO  Estimated optimised what-if runtime is 0ms
2022-09-21 19:18:13 INFO  Estimated optimisation runtime saving is 0ms
2022-09-21 19:18:13 INFO  ---RUNTIME: Multi-Query Optimization took 0.5021095275878906 ms
2022-09-21 19:18:13 INFO  Executing generated plans
2022-09-21 19:18:13 INFO  ---RUNTIME: Execution took 0.022411346435546875 ms
2022-09-21 19:18:13 INFO  Done!
2022-09-21 19:18:13 INFO  # Optimization benchmark for operator_impact with args [['reviews', 'fast_loading', 'featurization_1', 'neural_network']] -- repetition 1 of 7
2022-09-21 19:18:13 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-21 19:18:13 INFO  Running instrumented original pipeline...
2022-09-21 19:18:13 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-21 19:18:13 INFO  ---RUNTIME: Importing and monkey-patching took 5.720853805541992 ms
2022-09-21 19:18:24 INFO  ---RUNTIME: Original pipeline execution took 10790.747880935669 ms (excluding imports and monkey-patching)
2022-09-21 19:18:24 INFO  Starting execution of 1 what-if analyses...
2022-09-21 19:18:24 INFO  Start plan generation for analysis OperatorImpact...
2022-09-21 19:18:24 INFO  ---RUNTIME: Plan generation took 5.568742752075195 ms
2022-09-21 19:18:24 INFO  Estimated runtime of original DAG is 8525.588035583496ms
2022-09-21 19:18:24 INFO  Performing Multi-Query Optimization
2022-09-21 19:18:24 INFO  Estimated unoptimized what-if runtime is 43650.09142398763ms
2022-09-21 19:18:24 INFO  Estimated optimised what-if runtime is 29797.556365283075ms
2022-09-21 19:18:24 INFO  Estimated optimisation runtime saving is 13852.535058704554ms
2022-09-21 19:18:24 INFO  ---RUNTIME: Multi-Query Optimization took 113.00110816955566 ms
2022-09-21 19:18:24 INFO  Executing generated plans
2022-09-21 19:18:56 INFO  ---RUNTIME: Execution took 32245.912551879883 ms
2022-09-21 19:18:56 INFO  Done!
2022-09-21 19:18:56 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-21 19:18:56 INFO  Running instrumented original pipeline...
2022-09-21 19:18:56 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-21 19:18:56 INFO  ---RUNTIME: Importing and monkey-patching took 6.331682205200195 ms
2022-09-21 19:19:07 INFO  ---RUNTIME: Original pipeline execution took 10879.834175109863 ms (excluding imports and monkey-patching)
2022-09-21 19:19:07 INFO  Starting execution of 1 what-if analyses...
2022-09-21 19:19:07 INFO  Start plan generation for analysis OperatorImpact...
2022-09-21 19:19:07 INFO  ---RUNTIME: Plan generation took 5.125522613525391 ms
2022-09-21 19:19:07 INFO  Estimated runtime of original DAG is 8693.392276763916ms
2022-09-21 19:19:07 WARNING Skipping Multi-Query Optimization (instead, only applying patches)
2022-09-21 19:19:07 INFO  Estimated unoptimised what-if runtime is 44406.50629176582ms
2022-09-21 19:19:07 INFO  ---RUNTIME: Multi-Query Optimization took 17.43769645690918 ms
2022-09-21 19:19:07 INFO  Executing generated plans
2022-09-21 19:19:56 INFO  ---RUNTIME: Execution took 48990.27442932129 ms
2022-09-21 19:19:56 INFO  Done!
2022-09-21 19:19:56 INFO  # Finished -- repetition 1 of 7 
2022-09-21 19:19:56 INFO  # Optimization benchmark for operator_impact with args [['reviews', 'fast_loading', 'featurization_1', 'neural_network']] -- repetition 2 of 7
2022-09-21 19:19:56 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-21 19:19:56 INFO  Running instrumented original pipeline...
2022-09-21 19:19:56 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-21 19:19:56 INFO  ---RUNTIME: Importing and monkey-patching took 6.32929801940918 ms
2022-09-21 19:20:07 INFO  ---RUNTIME: Original pipeline execution took 10757.556676864624 ms (excluding imports and monkey-patching)
2022-09-21 19:20:07 INFO  Starting execution of 1 what-if analyses...
2022-09-21 19:20:07 INFO  Start plan generation for analysis OperatorImpact...
2022-09-21 19:20:07 INFO  ---RUNTIME: Plan generation took 5.6896209716796875 ms
2022-09-21 19:20:07 INFO  Estimated runtime of original DAG is 8491.32776260376ms
2022-09-21 19:20:07 INFO  Performing Multi-Query Optimization
2022-09-21 19:20:07 INFO  Estimated unoptimized what-if runtime is 43452.893914576336ms
2022-09-21 19:20:07 INFO  Estimated optimised what-if runtime is 29470.645215234235ms
2022-09-21 19:20:07 INFO  Estimated optimisation runtime saving is 13982.2486993421ms
2022-09-21 19:20:07 INFO  ---RUNTIME: Multi-Query Optimization took 116.98269844055176 ms
2022-09-21 19:20:07 INFO  Executing generated plans
2022-09-21 19:20:40 INFO  ---RUNTIME: Execution took 32789.40463066101 ms
2022-09-21 19:20:40 INFO  Done!
2022-09-21 19:20:40 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-21 19:20:40 INFO  Running instrumented original pipeline...
2022-09-21 19:20:40 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-21 19:20:40 INFO  ---RUNTIME: Importing and monkey-patching took 5.89299201965332 ms
2022-09-21 19:20:50 INFO  ---RUNTIME: Original pipeline execution took 10668.699741363525 ms (excluding imports and monkey-patching)
2022-09-21 19:20:50 INFO  Starting execution of 1 what-if analyses...
2022-09-21 19:20:50 INFO  Start plan generation for analysis OperatorImpact...
2022-09-21 19:20:50 INFO  ---RUNTIME: Plan generation took 5.064249038696289 ms
2022-09-21 19:20:50 INFO  Estimated runtime of original DAG is 8468.531847000122ms
2022-09-21 19:20:50 WARNING Skipping Multi-Query Optimization (instead, only applying patches)
2022-09-21 19:20:50 INFO  Estimated unoptimised what-if runtime is 43255.5299990607ms
2022-09-21 19:20:50 INFO  ---RUNTIME: Multi-Query Optimization took 15.960931777954102 ms
2022-09-21 19:20:50 INFO  Executing generated plans
2022-09-21 19:21:40 INFO  ---RUNTIME: Execution took 49466.5322303772 ms
2022-09-21 19:21:40 INFO  Done!
2022-09-21 19:21:40 INFO  # Finished -- repetition 2 of 7 
2022-09-21 19:21:40 INFO  # Optimization benchmark for operator_impact with args [['reviews', 'fast_loading', 'featurization_1', 'neural_network']] -- repetition 3 of 7
2022-09-21 19:21:40 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-21 19:21:40 INFO  Running instrumented original pipeline...
2022-09-21 19:21:40 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-21 19:21:40 INFO  ---RUNTIME: Importing and monkey-patching took 6.666421890258789 ms
2022-09-21 19:21:51 INFO  ---RUNTIME: Original pipeline execution took 10960.893630981445 ms (excluding imports and monkey-patching)
2022-09-21 19:21:51 INFO  Starting execution of 1 what-if analyses...
2022-09-21 19:21:51 INFO  Start plan generation for analysis OperatorImpact...
2022-09-21 19:21:51 INFO  ---RUNTIME: Plan generation took 5.453586578369141 ms
2022-09-21 19:21:51 INFO  Estimated runtime of original DAG is 8716.28212928772ms
2022-09-21 19:21:51 INFO  Performing Multi-Query Optimization
2022-09-21 19:21:51 INFO  Estimated unoptimized what-if runtime is 44572.03411056995ms
2022-09-21 19:21:51 INFO  Estimated optimised what-if runtime is 30196.665022528843ms
2022-09-21 19:21:51 INFO  Estimated optimisation runtime saving is 14375.369088041105ms
2022-09-21 19:21:51 INFO  ---RUNTIME: Multi-Query Optimization took 124.37891960144043 ms
2022-09-21 19:21:51 INFO  Executing generated plans
2022-09-21 19:22:23 INFO  ---RUNTIME: Execution took 32180.697202682495 ms
2022-09-21 19:22:23 INFO  Done!
2022-09-21 19:22:23 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-21 19:22:23 INFO  Running instrumented original pipeline...
2022-09-21 19:22:23 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-21 19:22:23 INFO  ---RUNTIME: Importing and monkey-patching took 6.453990936279297 ms
2022-09-21 19:22:34 INFO  ---RUNTIME: Original pipeline execution took 10687.809467315674 ms (excluding imports and monkey-patching)
2022-09-21 19:22:34 INFO  Starting execution of 1 what-if analyses...
2022-09-21 19:22:34 INFO  Start plan generation for analysis OperatorImpact...
2022-09-21 19:22:34 INFO  ---RUNTIME: Plan generation took 5.228281021118164 ms
2022-09-21 19:22:34 INFO  Estimated runtime of original DAG is 8468.47939491272ms
2022-09-21 19:22:34 WARNING Skipping Multi-Query Optimization (instead, only applying patches)
2022-09-21 19:22:34 INFO  Estimated unoptimised what-if runtime is 43236.91184452543ms
2022-09-21 19:22:34 INFO  ---RUNTIME: Multi-Query Optimization took 16.82591438293457 ms
2022-09-21 19:22:34 INFO  Executing generated plans
2022-09-21 19:23:24 INFO  ---RUNTIME: Execution took 50176.17583274841 ms
2022-09-21 19:23:24 INFO  Done!
2022-09-21 19:23:24 INFO  # Finished -- repetition 3 of 7 
2022-09-21 19:23:24 INFO  # Optimization benchmark for operator_impact with args [['reviews', 'fast_loading', 'featurization_1', 'neural_network']] -- repetition 4 of 7
2022-09-21 19:23:24 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-21 19:23:24 INFO  Running instrumented original pipeline...
2022-09-21 19:23:24 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-21 19:23:24 INFO  ---RUNTIME: Importing and monkey-patching took 6.406068801879883 ms
2022-09-21 19:23:35 INFO  ---RUNTIME: Original pipeline execution took 10715.784311294556 ms (excluding imports and monkey-patching)
2022-09-21 19:23:35 INFO  Starting execution of 1 what-if analyses...
2022-09-21 19:23:35 INFO  Start plan generation for analysis OperatorImpact...
2022-09-21 19:23:35 INFO  ---RUNTIME: Plan generation took 5.688905715942383 ms
2022-09-21 19:23:35 INFO  Estimated runtime of original DAG is 8484.352827072144ms
2022-09-21 19:23:35 INFO  Performing Multi-Query Optimization
2022-09-21 19:23:35 INFO  Estimated unoptimized what-if runtime is 43418.16292283971ms
2022-09-21 19:23:35 INFO  Estimated optimised what-if runtime is 29643.251643637883ms
2022-09-21 19:23:35 INFO  Estimated optimisation runtime saving is 13774.911279201824ms
2022-09-21 19:23:35 INFO  ---RUNTIME: Multi-Query Optimization took 119.6136474609375 ms
2022-09-21 19:23:35 INFO  Executing generated plans
2022-09-21 19:24:07 INFO  ---RUNTIME: Execution took 32403.77116203308 ms
2022-09-21 19:24:07 INFO  Done!
2022-09-21 19:24:07 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-21 19:24:07 INFO  Running instrumented original pipeline...
2022-09-21 19:24:07 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-21 19:24:07 INFO  ---RUNTIME: Importing and monkey-patching took 6.004571914672852 ms
2022-09-21 19:24:18 INFO  ---RUNTIME: Original pipeline execution took 10944.348335266113 ms (excluding imports and monkey-patching)
2022-09-21 19:24:18 INFO  Starting execution of 1 what-if analyses...
2022-09-21 19:24:18 INFO  Start plan generation for analysis OperatorImpact...
2022-09-21 19:24:18 INFO  ---RUNTIME: Plan generation took 5.062580108642578 ms
2022-09-21 19:24:18 INFO  Estimated runtime of original DAG is 8706.053256988525ms
2022-09-21 19:24:18 WARNING Skipping Multi-Query Optimization (instead, only applying patches)
2022-09-21 19:24:18 INFO  Estimated unoptimised what-if runtime is 44467.213353948624ms
2022-09-21 19:24:18 INFO  ---RUNTIME: Multi-Query Optimization took 16.1135196685791 ms
2022-09-21 19:24:18 INFO  Executing generated plans
2022-09-21 19:25:08 INFO  ---RUNTIME: Execution took 49890.00058174133 ms
2022-09-21 19:25:08 INFO  Done!
2022-09-21 19:25:08 INFO  # Finished -- repetition 4 of 7 
2022-09-21 19:25:08 INFO  # Optimization benchmark for operator_impact with args [['reviews', 'fast_loading', 'featurization_1', 'neural_network']] -- repetition 5 of 7
2022-09-21 19:25:08 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-21 19:25:08 INFO  Running instrumented original pipeline...
2022-09-21 19:25:08 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-21 19:25:08 INFO  ---RUNTIME: Importing and monkey-patching took 7.218599319458008 ms
2022-09-21 19:25:19 INFO  ---RUNTIME: Original pipeline execution took 10864.26043510437 ms (excluding imports and monkey-patching)
2022-09-21 19:25:19 INFO  Starting execution of 1 what-if analyses...
2022-09-21 19:25:19 INFO  Start plan generation for analysis OperatorImpact...
2022-09-21 19:25:19 INFO  ---RUNTIME: Plan generation took 4.58836555480957 ms
2022-09-21 19:25:19 INFO  Estimated runtime of original DAG is 8609.023094177246ms
2022-09-21 19:25:19 INFO  Performing Multi-Query Optimization
2022-09-21 19:25:19 INFO  Estimated unoptimized what-if runtime is 44042.951195553214ms
2022-09-21 19:25:19 INFO  Estimated optimised what-if runtime is 29794.902719374248ms
2022-09-21 19:25:19 INFO  Estimated optimisation runtime saving is 14248.048476178967ms
2022-09-21 19:25:19 INFO  ---RUNTIME: Multi-Query Optimization took 118.80779266357422 ms
2022-09-21 19:25:19 INFO  Executing generated plans
2022-09-21 19:25:52 INFO  ---RUNTIME: Execution took 32542.872428894043 ms
2022-09-21 19:25:52 INFO  Done!
2022-09-21 19:25:52 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-21 19:25:52 INFO  Running instrumented original pipeline...
2022-09-21 19:25:52 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-21 19:25:52 INFO  ---RUNTIME: Importing and monkey-patching took 6.212949752807617 ms
2022-09-21 19:26:03 INFO  ---RUNTIME: Original pipeline execution took 11159.008741378784 ms (excluding imports and monkey-patching)
2022-09-21 19:26:03 INFO  Starting execution of 1 what-if analyses...
2022-09-21 19:26:03 INFO  Start plan generation for analysis OperatorImpact...
2022-09-21 19:26:03 INFO  ---RUNTIME: Plan generation took 4.5413970947265625 ms
2022-09-21 19:26:03 INFO  Estimated runtime of original DAG is 8903.584241867065ms
2022-09-21 19:26:03 WARNING Skipping Multi-Query Optimization (instead, only applying patches)
2022-09-21 19:26:03 INFO  Estimated unoptimised what-if runtime is 45488.371697263494ms
2022-09-21 19:26:03 INFO  ---RUNTIME: Multi-Query Optimization took 17.16756820678711 ms
2022-09-21 19:26:03 INFO  Executing generated plans
2022-09-21 19:26:52 INFO  ---RUNTIME: Execution took 48921.459674835205 ms
2022-09-21 19:26:52 INFO  Done!
2022-09-21 19:26:52 INFO  # Finished -- repetition 5 of 7 
2022-09-21 19:26:52 INFO  # Optimization benchmark for operator_impact with args [['reviews', 'fast_loading', 'featurization_1', 'neural_network']] -- repetition 6 of 7
2022-09-21 19:26:52 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-21 19:26:52 INFO  Running instrumented original pipeline...
2022-09-21 19:26:52 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-21 19:26:52 INFO  ---RUNTIME: Importing and monkey-patching took 6.171464920043945 ms
2022-09-21 19:27:03 INFO  ---RUNTIME: Original pipeline execution took 11492.534875869751 ms (excluding imports and monkey-patching)
2022-09-21 19:27:03 INFO  Starting execution of 1 what-if analyses...
2022-09-21 19:27:03 INFO  Start plan generation for analysis OperatorImpact...
2022-09-21 19:27:03 INFO  ---RUNTIME: Plan generation took 4.780769348144531 ms
2022-09-21 19:27:03 INFO  Estimated runtime of original DAG is 8743.21985244751ms
2022-09-21 19:27:03 INFO  Performing Multi-Query Optimization
2022-09-21 19:27:03 INFO  Estimated unoptimized what-if runtime is 44733.34678327356ms
2022-09-21 19:27:03 INFO  Estimated optimised what-if runtime is 30391.691107367034ms
2022-09-21 19:27:03 INFO  Estimated optimisation runtime saving is 14341.655675906528ms
2022-09-21 19:27:03 INFO  ---RUNTIME: Multi-Query Optimization took 117.30241775512695 ms
2022-09-21 19:27:03 INFO  Executing generated plans
2022-09-21 19:27:35 INFO  ---RUNTIME: Execution took 31545.60422897339 ms
2022-09-21 19:27:35 INFO  Done!
2022-09-21 19:27:35 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-21 19:27:35 INFO  Running instrumented original pipeline...
2022-09-21 19:27:35 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-21 19:27:35 INFO  ---RUNTIME: Importing and monkey-patching took 5.904436111450195 ms
2022-09-21 19:27:46 INFO  ---RUNTIME: Original pipeline execution took 10926.141500473022 ms (excluding imports and monkey-patching)
2022-09-21 19:27:46 INFO  Starting execution of 1 what-if analyses...
2022-09-21 19:27:46 INFO  Start plan generation for analysis OperatorImpact...
2022-09-21 19:27:46 INFO  ---RUNTIME: Plan generation took 4.754304885864258 ms
2022-09-21 19:27:46 INFO  Estimated runtime of original DAG is 8697.3237991333ms
2022-09-21 19:27:46 WARNING Skipping Multi-Query Optimization (instead, only applying patches)
2022-09-21 19:27:46 INFO  Estimated unoptimised what-if runtime is 44429.95823167056ms
2022-09-21 19:27:46 INFO  ---RUNTIME: Multi-Query Optimization took 15.863656997680664 ms
2022-09-21 19:27:46 INFO  Executing generated plans
2022-09-21 19:28:33 INFO  ---RUNTIME: Execution took 47643.1200504303 ms
2022-09-21 19:28:33 INFO  Done!
2022-09-21 19:28:33 INFO  # Finished -- repetition 6 of 7 
2022-09-21 19:28:33 INFO  # Optimization benchmark for operator_impact with args [['reviews', 'fast_loading', 'featurization_1', 'neural_network']] -- repetition 7 of 7
2022-09-21 19:28:33 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-21 19:28:33 INFO  Running instrumented original pipeline...
2022-09-21 19:28:34 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-21 19:28:34 INFO  ---RUNTIME: Importing and monkey-patching took 5.887031555175781 ms
2022-09-21 19:28:44 INFO  ---RUNTIME: Original pipeline execution took 10523.988008499146 ms (excluding imports and monkey-patching)
2022-09-21 19:28:44 INFO  Starting execution of 1 what-if analyses...
2022-09-21 19:28:44 INFO  Start plan generation for analysis OperatorImpact...
2022-09-21 19:28:44 INFO  ---RUNTIME: Plan generation took 5.084753036499023 ms
2022-09-21 19:28:44 INFO  Estimated runtime of original DAG is 8299.72767829895ms
2022-09-21 19:28:44 INFO  Performing Multi-Query Optimization
2022-09-21 19:28:44 INFO  Estimated unoptimized what-if runtime is 42467.74497919153ms
2022-09-21 19:28:44 INFO  Estimated optimised what-if runtime is 28951.781114217865ms
2022-09-21 19:28:44 INFO  Estimated optimisation runtime saving is 13515.963864973663ms
2022-09-21 19:28:44 INFO  ---RUNTIME: Multi-Query Optimization took 114.97926712036133 ms
2022-09-21 19:28:44 INFO  Executing generated plans
2022-09-21 19:29:15 INFO  ---RUNTIME: Execution took 31244.090795516968 ms
2022-09-21 19:29:15 INFO  Done!
2022-09-21 19:29:15 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-21 19:29:15 INFO  Running instrumented original pipeline...
2022-09-21 19:29:15 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-21 19:29:15 INFO  ---RUNTIME: Importing and monkey-patching took 5.8460235595703125 ms
2022-09-21 19:29:26 INFO  ---RUNTIME: Original pipeline execution took 10527.036905288696 ms (excluding imports and monkey-patching)
2022-09-21 19:29:26 INFO  Starting execution of 1 what-if analyses...
2022-09-21 19:29:26 INFO  Start plan generation for analysis OperatorImpact...
2022-09-21 19:29:26 INFO  ---RUNTIME: Plan generation took 4.553318023681641 ms
2022-09-21 19:29:26 INFO  Estimated runtime of original DAG is 8299.992799758911ms
2022-09-21 19:29:26 WARNING Skipping Multi-Query Optimization (instead, only applying patches)
2022-09-21 19:29:26 INFO  Estimated unoptimised what-if runtime is 42387.17158221064ms
2022-09-21 19:29:26 INFO  ---RUNTIME: Multi-Query Optimization took 16.15595817565918 ms
2022-09-21 19:29:26 INFO  Executing generated plans
2022-09-21 19:30:14 INFO  ---RUNTIME: Execution took 47942.55828857422 ms
2022-09-21 19:30:14 INFO  Done!
2022-09-21 19:30:14 INFO  # Finished -- repetition 7 of 7 
2022-09-21 19:30:14 INFO  # Final results after all repetitions
2022-09-21 19:30:14 INFO     repetition  ... no_opt_what_if_execution_combined_model_training
0           0  ...                                     17871.558428
1           1  ...                                     17309.488535
2           2  ...                                     18515.360594
3           3  ...                                     18711.415052
4           4  ...                                     17885.625362
5           5  ...                                     17104.028225
6           6  ...                                     17541.569471

[7 rows x 26 columns]
taskset -c 160-167 PROTOCOL_BUFFERS_PYTHON_IMPLEMENTATION=python python3.9 benchmarks_end_to_end.py operator_impact reviews fast_loading featurization_2 logistic_regression
2022-09-21 19:30:16.783957: W tensorflow/stream_executor/platform/default/dso_loader.cc:64] Could not load dynamic library 'libcudart.so.11.0'; dlerror: libcudart.so.11.0: cannot open shared object file: No such file or directory; LD_LIBRARY_PATH: /home/sgrafbe/mlwhatif/venv/lib/python3.9/site-packages/cv2/../../lib64:
2022-09-21 19:30:16.784008: I tensorflow/stream_executor/cuda/cudart_stub.cc:29] Ignore above cudart dlerror if you do not have a GPU set up on your machine.
2022-09-21 19:30:18 INFO  Patching sys.argv with ['mlwhatif', 'reviews', 'fast_loading', 'featurization_2', 'logistic_regression']
2022-09-21 19:30:18 INFO  Running instrumented original pipeline...
2022-09-21 19:30:18 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-21 19:30:18 INFO  ---RUNTIME: Importing and monkey-patching took 120.8791732788086 ms
2022-09-21 19:30:24 INFO  ---RUNTIME: Original pipeline execution took 6720.756769180298 ms (excluding imports and monkey-patching)
2022-09-21 19:30:24 INFO  Starting execution of 0 what-if analyses...
2022-09-21 19:30:24 INFO  Estimated runtime of original DAG is 5493.013381958008ms
2022-09-21 19:30:24 INFO  Performing Multi-Query Optimization
2022-09-21 19:30:24 INFO  Estimated unoptimized what-if runtime is 0ms
2022-09-21 19:30:24 INFO  Estimated optimised what-if runtime is 0ms
2022-09-21 19:30:24 INFO  Estimated optimisation runtime saving is 0ms
2022-09-21 19:30:24 INFO  ---RUNTIME: Multi-Query Optimization took 0.6031990051269531 ms
2022-09-21 19:30:24 INFO  Executing generated plans
2022-09-21 19:30:24 INFO  ---RUNTIME: Execution took 0.02765655517578125 ms
2022-09-21 19:30:24 INFO  Done!
2022-09-21 19:30:24 INFO  # Optimization benchmark for operator_impact with args [['reviews', 'fast_loading', 'featurization_2', 'logistic_regression']] -- repetition 1 of 7
2022-09-21 19:30:24 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-21 19:30:24 INFO  Running instrumented original pipeline...
2022-09-21 19:30:24 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-21 19:30:24 INFO  ---RUNTIME: Importing and monkey-patching took 5.437612533569336 ms
2022-09-21 19:30:31 INFO  ---RUNTIME: Original pipeline execution took 6851.659774780273 ms (excluding imports and monkey-patching)
2022-09-21 19:30:31 INFO  Starting execution of 1 what-if analyses...
2022-09-21 19:30:31 INFO  Start plan generation for analysis OperatorImpact...
2022-09-21 19:30:31 INFO  ---RUNTIME: Plan generation took 5.816459655761719 ms
2022-09-21 19:30:31 INFO  Estimated runtime of original DAG is 5651.447772979736ms
2022-09-21 19:30:31 INFO  Performing Multi-Query Optimization
2022-09-21 19:30:31 INFO  Estimated unoptimized what-if runtime is 39810.486598162024ms
2022-09-21 19:30:31 INFO  Estimated optimised what-if runtime is 13749.02878115115ms
2022-09-21 19:30:31 INFO  Estimated optimisation runtime saving is 26061.457817010873ms
2022-09-21 19:30:31 INFO  ---RUNTIME: Multi-Query Optimization took 124.5110034942627 ms
2022-09-21 19:30:31 INFO  Executing generated plans
2022-09-21 19:30:47 INFO  ---RUNTIME: Execution took 15365.594148635864 ms
2022-09-21 19:30:47 INFO  Done!
2022-09-21 19:30:47 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-21 19:30:47 INFO  Running instrumented original pipeline...
2022-09-21 19:30:47 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-21 19:30:47 INFO  ---RUNTIME: Importing and monkey-patching took 6.188154220581055 ms
2022-09-21 19:30:53 INFO  ---RUNTIME: Original pipeline execution took 6659.377574920654 ms (excluding imports and monkey-patching)
2022-09-21 19:30:53 INFO  Starting execution of 1 what-if analyses...
2022-09-21 19:30:53 INFO  Start plan generation for analysis OperatorImpact...
2022-09-21 19:30:53 INFO  ---RUNTIME: Plan generation took 5.115032196044922 ms
2022-09-21 19:30:53 INFO  Estimated runtime of original DAG is 5469.878196716309ms
2022-09-21 19:30:53 WARNING Skipping Multi-Query Optimization (instead, only applying patches)
2022-09-21 19:30:53 INFO  Estimated unoptimised what-if runtime is 38401.28326357807ms
2022-09-21 19:30:53 INFO  ---RUNTIME: Multi-Query Optimization took 17.296791076660156 ms
2022-09-21 19:30:53 INFO  Executing generated plans
2022-09-21 19:31:39 INFO  ---RUNTIME: Execution took 45128.99732589722 ms
2022-09-21 19:31:39 INFO  Done!
2022-09-21 19:31:39 INFO  # Finished -- repetition 1 of 7 
2022-09-21 19:31:39 INFO  # Optimization benchmark for operator_impact with args [['reviews', 'fast_loading', 'featurization_2', 'logistic_regression']] -- repetition 2 of 7
2022-09-21 19:31:39 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-21 19:31:39 INFO  Running instrumented original pipeline...
2022-09-21 19:31:39 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-21 19:31:39 INFO  ---RUNTIME: Importing and monkey-patching took 6.158113479614258 ms
2022-09-21 19:31:45 INFO  ---RUNTIME: Original pipeline execution took 6623.8112449646 ms (excluding imports and monkey-patching)
2022-09-21 19:31:45 INFO  Starting execution of 1 what-if analyses...
2022-09-21 19:31:45 INFO  Start plan generation for analysis OperatorImpact...
2022-09-21 19:31:45 INFO  ---RUNTIME: Plan generation took 4.99725341796875 ms
2022-09-21 19:31:45 INFO  Estimated runtime of original DAG is 5422.2283363342285ms
2022-09-21 19:31:45 INFO  Performing Multi-Query Optimization
2022-09-21 19:31:45 INFO  Estimated unoptimized what-if runtime is 38208.75553819055ms
2022-09-21 19:31:45 INFO  Estimated optimised what-if runtime is 13447.820547455905ms
2022-09-21 19:31:45 INFO  Estimated optimisation runtime saving is 24760.93499073464ms
2022-09-21 19:31:45 INFO  ---RUNTIME: Multi-Query Optimization took 123.88801574707031 ms
2022-09-21 19:31:45 INFO  Executing generated plans
2022-09-21 19:32:01 INFO  ---RUNTIME: Execution took 15297.06883430481 ms
2022-09-21 19:32:01 INFO  Done!
2022-09-21 19:32:01 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-21 19:32:01 INFO  Running instrumented original pipeline...
2022-09-21 19:32:01 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-21 19:32:01 INFO  ---RUNTIME: Importing and monkey-patching took 6.034612655639648 ms
2022-09-21 19:32:07 INFO  ---RUNTIME: Original pipeline execution took 6662.347793579102 ms (excluding imports and monkey-patching)
2022-09-21 19:32:07 INFO  Starting execution of 1 what-if analyses...
2022-09-21 19:32:07 INFO  Start plan generation for analysis OperatorImpact...
2022-09-21 19:32:07 INFO  ---RUNTIME: Plan generation took 5.001306533813477 ms
2022-09-21 19:32:07 INFO  Estimated runtime of original DAG is 5463.757038116455ms
2022-09-21 19:32:07 WARNING Skipping Multi-Query Optimization (instead, only applying patches)
2022-09-21 19:32:07 INFO  Estimated unoptimised what-if runtime is 38365.061386957066ms
2022-09-21 19:32:07 INFO  ---RUNTIME: Multi-Query Optimization took 17.329931259155273 ms
2022-09-21 19:32:07 INFO  Executing generated plans
2022-09-21 19:32:53 INFO  ---RUNTIME: Execution took 45233.12973976135 ms
2022-09-21 19:32:53 INFO  Done!
2022-09-21 19:32:53 INFO  # Finished -- repetition 2 of 7 
2022-09-21 19:32:53 INFO  # Optimization benchmark for operator_impact with args [['reviews', 'fast_loading', 'featurization_2', 'logistic_regression']] -- repetition 3 of 7
2022-09-21 19:32:53 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-21 19:32:53 INFO  Running instrumented original pipeline...
2022-09-21 19:32:53 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-21 19:32:53 INFO  ---RUNTIME: Importing and monkey-patching took 6.140947341918945 ms
2022-09-21 19:32:59 INFO  ---RUNTIME: Original pipeline execution took 6679.102420806885 ms (excluding imports and monkey-patching)
2022-09-21 19:32:59 INFO  Starting execution of 1 what-if analyses...
2022-09-21 19:32:59 INFO  Start plan generation for analysis OperatorImpact...
2022-09-21 19:32:59 INFO  ---RUNTIME: Plan generation took 5.088090896606445 ms
2022-09-21 19:32:59 INFO  Estimated runtime of original DAG is 5473.886489868164ms
2022-09-21 19:32:59 INFO  Performing Multi-Query Optimization
2022-09-21 19:32:59 INFO  Estimated unoptimized what-if runtime is 38547.14791515414ms
2022-09-21 19:32:59 INFO  Estimated optimised what-if runtime is 13607.877995058609ms
2022-09-21 19:32:59 INFO  Estimated optimisation runtime saving is 24939.269920095532ms
2022-09-21 19:32:59 INFO  ---RUNTIME: Multi-Query Optimization took 124.4666576385498 ms
2022-09-21 19:32:59 INFO  Executing generated plans
2022-09-21 19:33:15 INFO  ---RUNTIME: Execution took 15343.739032745361 ms
2022-09-21 19:33:15 INFO  Done!
2022-09-21 19:33:15 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-21 19:33:15 INFO  Running instrumented original pipeline...
2022-09-21 19:33:15 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-21 19:33:15 INFO  ---RUNTIME: Importing and monkey-patching took 5.817651748657227 ms
2022-09-21 19:33:21 INFO  ---RUNTIME: Original pipeline execution took 6650.992870330811 ms (excluding imports and monkey-patching)
2022-09-21 19:33:21 INFO  Starting execution of 1 what-if analyses...
2022-09-21 19:33:21 INFO  Start plan generation for analysis OperatorImpact...
2022-09-21 19:33:21 INFO  ---RUNTIME: Plan generation took 4.883050918579102 ms
2022-09-21 19:33:21 INFO  Estimated runtime of original DAG is 5454.631805419922ms
2022-09-21 19:33:21 WARNING Skipping Multi-Query Optimization (instead, only applying patches)
2022-09-21 19:33:21 INFO  Estimated unoptimised what-if runtime is 38296.44202463853ms
2022-09-21 19:33:21 INFO  ---RUNTIME: Multi-Query Optimization took 17.32015609741211 ms
2022-09-21 19:33:21 INFO  Executing generated plans
2022-09-21 19:34:09 INFO  ---RUNTIME: Execution took 47719.300746917725 ms
2022-09-21 19:34:09 INFO  Done!
2022-09-21 19:34:09 INFO  # Finished -- repetition 3 of 7 
2022-09-21 19:34:09 INFO  # Optimization benchmark for operator_impact with args [['reviews', 'fast_loading', 'featurization_2', 'logistic_regression']] -- repetition 4 of 7
2022-09-21 19:34:09 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-21 19:34:09 INFO  Running instrumented original pipeline...
2022-09-21 19:34:09 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-21 19:34:09 INFO  ---RUNTIME: Importing and monkey-patching took 6.052255630493164 ms
2022-09-21 19:34:16 INFO  ---RUNTIME: Original pipeline execution took 6963.405609130859 ms (excluding imports and monkey-patching)
2022-09-21 19:34:16 INFO  Starting execution of 1 what-if analyses...
2022-09-21 19:34:16 INFO  Start plan generation for analysis OperatorImpact...
2022-09-21 19:34:16 INFO  ---RUNTIME: Plan generation took 4.901885986328125 ms
2022-09-21 19:34:16 INFO  Estimated runtime of original DAG is 5707.8447341918945ms
2022-09-21 19:34:16 INFO  Performing Multi-Query Optimization
2022-09-21 19:34:16 INFO  Estimated unoptimized what-if runtime is 40205.84588370162ms
2022-09-21 19:34:16 INFO  Estimated optimised what-if runtime is 14085.761469553707ms
2022-09-21 19:34:16 INFO  Estimated optimisation runtime saving is 26120.084414147917ms
2022-09-21 19:34:16 INFO  ---RUNTIME: Multi-Query Optimization took 123.86202812194824 ms
2022-09-21 19:34:16 INFO  Executing generated plans
2022-09-21 19:34:32 INFO  ---RUNTIME: Execution took 15883.084297180176 ms
2022-09-21 19:34:32 INFO  Done!
2022-09-21 19:34:32 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-21 19:34:32 INFO  Running instrumented original pipeline...
2022-09-21 19:34:32 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-21 19:34:32 INFO  ---RUNTIME: Importing and monkey-patching took 5.939245223999023 ms
2022-09-21 19:34:40 INFO  ---RUNTIME: Original pipeline execution took 8120.03755569458 ms (excluding imports and monkey-patching)
2022-09-21 19:34:40 INFO  Starting execution of 1 what-if analyses...
2022-09-21 19:34:40 INFO  Start plan generation for analysis OperatorImpact...
2022-09-21 19:34:40 INFO  ---RUNTIME: Plan generation took 5.016803741455078 ms
2022-09-21 19:34:40 INFO  Estimated runtime of original DAG is 6561.1395835876465ms
2022-09-21 19:34:40 WARNING Skipping Multi-Query Optimization (instead, only applying patches)
2022-09-21 19:34:40 INFO  Estimated unoptimised what-if runtime is 46156.47687344157ms
2022-09-21 19:34:40 INFO  ---RUNTIME: Multi-Query Optimization took 17.261981964111328 ms
2022-09-21 19:34:40 INFO  Executing generated plans
2022-09-21 19:35:34 INFO  ---RUNTIME: Execution took 54091.88938140869 ms
2022-09-21 19:35:34 INFO  Done!
2022-09-21 19:35:34 INFO  # Finished -- repetition 4 of 7 
2022-09-21 19:35:34 INFO  # Optimization benchmark for operator_impact with args [['reviews', 'fast_loading', 'featurization_2', 'logistic_regression']] -- repetition 5 of 7
2022-09-21 19:35:34 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-21 19:35:34 INFO  Running instrumented original pipeline...
2022-09-21 19:35:34 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-21 19:35:34 INFO  ---RUNTIME: Importing and monkey-patching took 5.852937698364258 ms
2022-09-21 19:35:41 INFO  ---RUNTIME: Original pipeline execution took 6896.975040435791 ms (excluding imports and monkey-patching)
2022-09-21 19:35:41 INFO  Starting execution of 1 what-if analyses...
2022-09-21 19:35:41 INFO  Start plan generation for analysis OperatorImpact...
2022-09-21 19:35:41 INFO  ---RUNTIME: Plan generation took 5.285739898681641 ms
2022-09-21 19:35:41 INFO  Estimated runtime of original DAG is 5644.1028118133545ms
2022-09-21 19:35:41 INFO  Performing Multi-Query Optimization
2022-09-21 19:35:41 INFO  Estimated unoptimized what-if runtime is 39776.50870374412ms
2022-09-21 19:35:41 INFO  Estimated optimised what-if runtime is 13939.099312093058ms
2022-09-21 19:35:41 INFO  Estimated optimisation runtime saving is 25837.40939165106ms
2022-09-21 19:35:41 INFO  ---RUNTIME: Multi-Query Optimization took 125.92864036560059 ms
2022-09-21 19:35:41 INFO  Executing generated plans
2022-09-21 19:36:00 INFO  ---RUNTIME: Execution took 18261.74759864807 ms
2022-09-21 19:36:00 INFO  Done!
2022-09-21 19:36:00 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-21 19:36:00 INFO  Running instrumented original pipeline...
2022-09-21 19:36:00 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-21 19:36:00 INFO  ---RUNTIME: Importing and monkey-patching took 5.984067916870117 ms
2022-09-21 19:36:07 INFO  ---RUNTIME: Original pipeline execution took 6862.5547885894775 ms (excluding imports and monkey-patching)
2022-09-21 19:36:07 INFO  Starting execution of 1 what-if analyses...
2022-09-21 19:36:07 INFO  Start plan generation for analysis OperatorImpact...
2022-09-21 19:36:07 INFO  ---RUNTIME: Plan generation took 5.126953125 ms
2022-09-21 19:36:07 INFO  Estimated runtime of original DAG is 5623.520135879517ms
2022-09-21 19:36:07 WARNING Skipping Multi-Query Optimization (instead, only applying patches)
2022-09-21 19:36:07 INFO  Estimated unoptimised what-if runtime is 39480.670583677675ms
2022-09-21 19:36:07 INFO  ---RUNTIME: Multi-Query Optimization took 18.709421157836914 ms
2022-09-21 19:36:07 INFO  Executing generated plans
2022-09-21 19:36:53 INFO  ---RUNTIME: Execution took 46198.10152053833 ms
2022-09-21 19:36:53 INFO  Done!
2022-09-21 19:36:53 INFO  # Finished -- repetition 5 of 7 
2022-09-21 19:36:53 INFO  # Optimization benchmark for operator_impact with args [['reviews', 'fast_loading', 'featurization_2', 'logistic_regression']] -- repetition 6 of 7
2022-09-21 19:36:53 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-21 19:36:53 INFO  Running instrumented original pipeline...
2022-09-21 19:36:53 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-21 19:36:53 INFO  ---RUNTIME: Importing and monkey-patching took 6.266117095947266 ms
2022-09-21 19:37:03 INFO  ---RUNTIME: Original pipeline execution took 10192.48104095459 ms (excluding imports and monkey-patching)
2022-09-21 19:37:03 INFO  Starting execution of 1 what-if analyses...
2022-09-21 19:37:03 INFO  Start plan generation for analysis OperatorImpact...
2022-09-21 19:37:03 INFO  ---RUNTIME: Plan generation took 7.90715217590332 ms
2022-09-21 19:37:03 INFO  Estimated runtime of original DAG is 8404.075145721436ms
2022-09-21 19:37:03 INFO  Performing Multi-Query Optimization
2022-09-21 19:37:03 INFO  Estimated unoptimized what-if runtime is 59328.00590124256ms
2022-09-21 19:37:03 INFO  Estimated optimised what-if runtime is 20270.919773707596ms
2022-09-21 19:37:03 INFO  Estimated optimisation runtime saving is 39057.08612753497ms
2022-09-21 19:37:03 INFO  ---RUNTIME: Multi-Query Optimization took 193.81117820739746 ms
2022-09-21 19:37:03 INFO  Executing generated plans
2022-09-21 19:37:22 INFO  ---RUNTIME: Execution took 19241.633415222168 ms
2022-09-21 19:37:22 INFO  Done!
2022-09-21 19:37:22 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-21 19:37:22 INFO  Running instrumented original pipeline...
2022-09-21 19:37:23 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-21 19:37:23 INFO  ---RUNTIME: Importing and monkey-patching took 6.505727767944336 ms
2022-09-21 19:37:30 INFO  ---RUNTIME: Original pipeline execution took 7754.848957061768 ms (excluding imports and monkey-patching)
2022-09-21 19:37:30 INFO  Starting execution of 1 what-if analyses...
2022-09-21 19:37:30 INFO  Start plan generation for analysis OperatorImpact...
2022-09-21 19:37:30 INFO  ---RUNTIME: Plan generation took 5.008697509765625 ms
2022-09-21 19:37:30 INFO  Estimated runtime of original DAG is 6373.84819984436ms
2022-09-21 19:37:30 WARNING Skipping Multi-Query Optimization (instead, only applying patches)
2022-09-21 19:37:30 INFO  Estimated unoptimised what-if runtime is 44722.897377091715ms
2022-09-21 19:37:30 INFO  ---RUNTIME: Multi-Query Optimization took 17.410993576049805 ms
2022-09-21 19:37:30 INFO  Executing generated plans
2022-09-21 19:38:26 INFO  ---RUNTIME: Execution took 55950.33621788025 ms
2022-09-21 19:38:26 INFO  Done!
2022-09-21 19:38:26 INFO  # Finished -- repetition 6 of 7 
2022-09-21 19:38:26 INFO  # Optimization benchmark for operator_impact with args [['reviews', 'fast_loading', 'featurization_2', 'logistic_regression']] -- repetition 7 of 7
2022-09-21 19:38:26 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-21 19:38:26 INFO  Running instrumented original pipeline...
2022-09-21 19:38:27 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-21 19:38:27 INFO  ---RUNTIME: Importing and monkey-patching took 8.221864700317383 ms
2022-09-21 19:38:36 INFO  ---RUNTIME: Original pipeline execution took 9312.19744682312 ms (excluding imports and monkey-patching)
2022-09-21 19:38:36 INFO  Starting execution of 1 what-if analyses...
2022-09-21 19:38:36 INFO  Start plan generation for analysis OperatorImpact...
2022-09-21 19:38:36 INFO  ---RUNTIME: Plan generation took 4.928350448608398 ms
2022-09-21 19:38:36 INFO  Estimated runtime of original DAG is 7027.724027633667ms
2022-09-21 19:38:36 INFO  Performing Multi-Query Optimization
2022-09-21 19:38:36 INFO  Estimated unoptimized what-if runtime is 49669.300570060186ms
2022-09-21 19:38:36 INFO  Estimated optimised what-if runtime is 15931.455696465035ms
2022-09-21 19:38:36 INFO  Estimated optimisation runtime saving is 33737.84487359515ms
2022-09-21 19:38:36 INFO  ---RUNTIME: Multi-Query Optimization took 124.1154670715332 ms
2022-09-21 19:38:36 INFO  Executing generated plans
2022-09-21 19:38:56 INFO  ---RUNTIME: Execution took 19890.59329032898 ms
2022-09-21 19:38:56 INFO  Done!
2022-09-21 19:38:56 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-21 19:38:56 INFO  Running instrumented original pipeline...
2022-09-21 19:38:56 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-21 19:38:56 INFO  ---RUNTIME: Importing and monkey-patching took 5.975008010864258 ms
2022-09-21 19:39:04 INFO  ---RUNTIME: Original pipeline execution took 8166.927814483643 ms (excluding imports and monkey-patching)
2022-09-21 19:39:04 INFO  Starting execution of 1 what-if analyses...
2022-09-21 19:39:04 INFO  Start plan generation for analysis OperatorImpact...
2022-09-21 19:39:04 INFO  ---RUNTIME: Plan generation took 7.940530776977539 ms
2022-09-21 19:39:04 INFO  Estimated runtime of original DAG is 6889.698266983032ms
2022-09-21 19:39:04 WARNING Skipping Multi-Query Optimization (instead, only applying patches)
2022-09-21 19:39:04 INFO  Estimated unoptimised what-if runtime is 48371.77342092528ms
2022-09-21 19:39:04 INFO  ---RUNTIME: Multi-Query Optimization took 28.980493545532227 ms
2022-09-21 19:39:04 INFO  Executing generated plans
2022-09-21 19:40:03 INFO  ---RUNTIME: Execution took 59400.792360305786 ms
2022-09-21 19:40:03 INFO  Done!
2022-09-21 19:40:03 INFO  # Finished -- repetition 7 of 7 
2022-09-21 19:40:03 INFO  # Final results after all repetitions
2022-09-21 19:40:03 INFO     repetition  ... no_opt_what_if_execution_combined_model_training
0           0  ...                                      1043.263912
1           1  ...                                      1047.622919
2           2  ...                                      1061.547279
3           3  ...                                      1443.457842
4           4  ...                                      1149.816513
5           5  ...                                      1441.086292
6           6  ...                                      1697.808266

[7 rows x 26 columns]
taskset -c 160-167 PROTOCOL_BUFFERS_PYTHON_IMPLEMENTATION=python python3.9 benchmarks_end_to_end.py operator_impact reviews fast_loading featurization_2 xgboost
2022-09-21 19:40:07.236257: W tensorflow/stream_executor/platform/default/dso_loader.cc:64] Could not load dynamic library 'libcudart.so.11.0'; dlerror: libcudart.so.11.0: cannot open shared object file: No such file or directory; LD_LIBRARY_PATH: /home/sgrafbe/mlwhatif/venv/lib/python3.9/site-packages/cv2/../../lib64:
2022-09-21 19:40:07.236306: I tensorflow/stream_executor/cuda/cudart_stub.cc:29] Ignore above cudart dlerror if you do not have a GPU set up on your machine.
2022-09-21 19:40:09 INFO  Patching sys.argv with ['mlwhatif', 'reviews', 'fast_loading', 'featurization_2', 'xgboost']
2022-09-21 19:40:09 INFO  Running instrumented original pipeline...
2022-09-21 19:40:09 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-21 19:40:09 INFO  ---RUNTIME: Importing and monkey-patching took 181.0929775238037 ms
2022-09-21 19:40:33 INFO  ---RUNTIME: Original pipeline execution took 23637.25447654724 ms (excluding imports and monkey-patching)
2022-09-21 19:40:33 INFO  Starting execution of 0 what-if analyses...
2022-09-21 19:40:33 INFO  Estimated runtime of original DAG is 22368.610382080078ms
2022-09-21 19:40:33 INFO  Performing Multi-Query Optimization
2022-09-21 19:40:33 INFO  Estimated unoptimized what-if runtime is 0ms
2022-09-21 19:40:33 INFO  Estimated optimised what-if runtime is 0ms
2022-09-21 19:40:33 INFO  Estimated optimisation runtime saving is 0ms
2022-09-21 19:40:33 INFO  ---RUNTIME: Multi-Query Optimization took 0.8549690246582031 ms
2022-09-21 19:40:33 INFO  Executing generated plans
2022-09-21 19:40:33 INFO  ---RUNTIME: Execution took 0.03266334533691406 ms
2022-09-21 19:40:33 INFO  Done!
2022-09-21 19:40:33 INFO  # Optimization benchmark for operator_impact with args [['reviews', 'fast_loading', 'featurization_2', 'xgboost']] -- repetition 1 of 7
2022-09-21 19:40:33 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-21 19:40:33 INFO  Running instrumented original pipeline...
2022-09-21 19:40:33 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-21 19:40:33 INFO  ---RUNTIME: Importing and monkey-patching took 10.321617126464844 ms
2022-09-21 19:40:56 INFO  ---RUNTIME: Original pipeline execution took 23599.98059272766 ms (excluding imports and monkey-patching)
2022-09-21 19:40:56 INFO  Starting execution of 1 what-if analyses...
2022-09-21 19:40:56 INFO  Start plan generation for analysis OperatorImpact...
2022-09-21 19:40:56 INFO  ---RUNTIME: Plan generation took 9.042501449584961 ms
2022-09-21 19:40:56 INFO  Estimated runtime of original DAG is 22192.58952140808ms
2022-09-21 19:40:56 INFO  Performing Multi-Query Optimization
2022-09-21 19:40:56 INFO  Estimated unoptimized what-if runtime is 157976.49628709359ms
2022-09-21 19:40:56 INFO  Estimated optimised what-if runtime is 128600.98322889202ms
2022-09-21 19:40:56 INFO  Estimated optimisation runtime saving is 29375.51305820157ms
2022-09-21 19:40:56 INFO  ---RUNTIME: Multi-Query Optimization took 218.5192108154297 ms
2022-09-21 19:40:56 INFO  Executing generated plans
2022-09-21 19:42:46 INFO  ---RUNTIME: Execution took 109650.24733543396 ms
2022-09-21 19:42:46 INFO  Done!
2022-09-21 19:42:46 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-21 19:42:46 INFO  Running instrumented original pipeline...
2022-09-21 19:42:46 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-21 19:42:46 INFO  ---RUNTIME: Importing and monkey-patching took 6.830692291259766 ms
2022-09-21 19:43:09 INFO  ---RUNTIME: Original pipeline execution took 23409.21139717102 ms (excluding imports and monkey-patching)
2022-09-21 19:43:09 INFO  Starting execution of 1 what-if analyses...
2022-09-21 19:43:09 INFO  Start plan generation for analysis OperatorImpact...
2022-09-21 19:43:10 INFO  ---RUNTIME: Plan generation took 7.493734359741211 ms
2022-09-21 19:43:10 INFO  Estimated runtime of original DAG is 21651.034832000732ms
2022-09-21 19:43:10 WARNING Skipping Multi-Query Optimization (instead, only applying patches)
2022-09-21 19:43:10 INFO  Estimated unoptimised what-if runtime is 153704.97386936043ms
2022-09-21 19:43:10 INFO  ---RUNTIME: Multi-Query Optimization took 32.184600830078125 ms
2022-09-21 19:43:10 INFO  Executing generated plans
2022-09-21 19:45:38 INFO  ---RUNTIME: Execution took 148220.51644325256 ms
2022-09-21 19:45:38 INFO  Done!
2022-09-21 19:45:38 INFO  # Finished -- repetition 1 of 7 
2022-09-21 19:45:38 INFO  # Optimization benchmark for operator_impact with args [['reviews', 'fast_loading', 'featurization_2', 'xgboost']] -- repetition 2 of 7
2022-09-21 19:45:38 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-21 19:45:38 INFO  Running instrumented original pipeline...
2022-09-21 19:45:38 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-21 19:45:38 INFO  ---RUNTIME: Importing and monkey-patching took 8.399248123168945 ms
2022-09-21 19:46:01 INFO  ---RUNTIME: Original pipeline execution took 23343.560218811035 ms (excluding imports and monkey-patching)
2022-09-21 19:46:01 INFO  Starting execution of 1 what-if analyses...
2022-09-21 19:46:01 INFO  Start plan generation for analysis OperatorImpact...
2022-09-21 19:46:01 INFO  ---RUNTIME: Plan generation took 5.098104476928711 ms
2022-09-21 19:46:01 INFO  Estimated runtime of original DAG is 21595.428705215454ms
2022-09-21 19:46:01 INFO  Performing Multi-Query Optimization
2022-09-21 19:46:01 INFO  Estimated unoptimized what-if runtime is 153738.60775179084ms
2022-09-21 19:46:01 INFO  Estimated optimised what-if runtime is 118342.01909362378ms
2022-09-21 19:46:01 INFO  Estimated optimisation runtime saving is 35396.588658167064ms
2022-09-21 19:46:01 INFO  ---RUNTIME: Multi-Query Optimization took 125.68187713623047 ms
2022-09-21 19:46:01 INFO  Executing generated plans
2022-09-21 19:47:52 INFO  ---RUNTIME: Execution took 110482.73372650146 ms
2022-09-21 19:47:52 INFO  Done!
2022-09-21 19:47:52 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-21 19:47:52 INFO  Running instrumented original pipeline...
2022-09-21 19:47:52 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-21 19:47:52 INFO  ---RUNTIME: Importing and monkey-patching took 6.614446640014648 ms
2022-09-21 19:48:15 INFO  ---RUNTIME: Original pipeline execution took 23275.740146636963 ms (excluding imports and monkey-patching)
2022-09-21 19:48:15 INFO  Starting execution of 1 what-if analyses...
2022-09-21 19:48:15 INFO  Start plan generation for analysis OperatorImpact...
2022-09-21 19:48:15 INFO  ---RUNTIME: Plan generation took 5.071163177490234 ms
2022-09-21 19:48:15 INFO  Estimated runtime of original DAG is 21582.20410346985ms
2022-09-21 19:48:15 WARNING Skipping Multi-Query Optimization (instead, only applying patches)
2022-09-21 19:48:15 INFO  Estimated unoptimised what-if runtime is 153295.9509565038ms
2022-09-21 19:48:15 INFO  ---RUNTIME: Multi-Query Optimization took 17.214536666870117 ms
2022-09-21 19:48:15 INFO  Executing generated plans
2022-09-21 19:50:44 INFO  ---RUNTIME: Execution took 149338.7095928192 ms
2022-09-21 19:50:44 INFO  Done!
2022-09-21 19:50:44 INFO  # Finished -- repetition 2 of 7 
2022-09-21 19:50:44 INFO  # Optimization benchmark for operator_impact with args [['reviews', 'fast_loading', 'featurization_2', 'xgboost']] -- repetition 3 of 7
2022-09-21 19:50:44 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-21 19:50:44 INFO  Running instrumented original pipeline...
2022-09-21 19:50:44 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-21 19:50:44 INFO  ---RUNTIME: Importing and monkey-patching took 6.589174270629883 ms
2022-09-21 19:51:08 INFO  ---RUNTIME: Original pipeline execution took 23190.579175949097 ms (excluding imports and monkey-patching)
2022-09-21 19:51:08 INFO  Starting execution of 1 what-if analyses...
2022-09-21 19:51:08 INFO  Start plan generation for analysis OperatorImpact...
2022-09-21 19:51:08 INFO  ---RUNTIME: Plan generation took 5.211353302001953 ms
2022-09-21 19:51:08 INFO  Estimated runtime of original DAG is 21838.69242668152ms
2022-09-21 19:51:08 INFO  Performing Multi-Query Optimization
2022-09-21 19:51:08 INFO  Estimated unoptimized what-if runtime is 155328.89485873128ms
2022-09-21 19:51:08 INFO  Estimated optimised what-if runtime is 126117.30159730712ms
2022-09-21 19:51:08 INFO  Estimated optimisation runtime saving is 29211.59326142416ms
2022-09-21 19:51:08 INFO  ---RUNTIME: Multi-Query Optimization took 125.10061264038086 ms
2022-09-21 19:51:08 INFO  Executing generated plans
2022-09-21 19:53:00 INFO  ---RUNTIME: Execution took 111789.35861587524 ms
2022-09-21 19:53:00 INFO  Done!
2022-09-21 19:53:00 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-21 19:53:00 INFO  Running instrumented original pipeline...
2022-09-21 19:53:00 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-21 19:53:00 INFO  ---RUNTIME: Importing and monkey-patching took 11.199712753295898 ms
2022-09-21 19:53:23 INFO  ---RUNTIME: Original pipeline execution took 23255.48481941223 ms (excluding imports and monkey-patching)
2022-09-21 19:53:23 INFO  Starting execution of 1 what-if analyses...
2022-09-21 19:53:23 INFO  Start plan generation for analysis OperatorImpact...
2022-09-21 19:53:23 INFO  ---RUNTIME: Plan generation took 9.58108901977539 ms
2022-09-21 19:53:23 INFO  Estimated runtime of original DAG is 21570.263147354126ms
2022-09-21 19:53:23 WARNING Skipping Multi-Query Optimization (instead, only applying patches)
2022-09-21 19:53:23 INFO  Estimated unoptimised what-if runtime is 153275.50029550798ms
2022-09-21 19:53:23 INFO  ---RUNTIME: Multi-Query Optimization took 25.21538734436035 ms
2022-09-21 19:53:23 INFO  Executing generated plans
2022-09-21 19:55:54 INFO  ---RUNTIME: Execution took 150995.85700035095 ms
2022-09-21 19:55:54 INFO  Done!
2022-09-21 19:55:54 INFO  # Finished -- repetition 3 of 7 
2022-09-21 19:55:54 INFO  # Optimization benchmark for operator_impact with args [['reviews', 'fast_loading', 'featurization_2', 'xgboost']] -- repetition 4 of 7
2022-09-21 19:55:54 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-21 19:55:54 INFO  Running instrumented original pipeline...
2022-09-21 19:55:54 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-21 19:55:54 INFO  ---RUNTIME: Importing and monkey-patching took 6.189823150634766 ms
2022-09-21 19:56:17 INFO  ---RUNTIME: Original pipeline execution took 23174.81565475464 ms (excluding imports and monkey-patching)
2022-09-21 19:56:17 INFO  Starting execution of 1 what-if analyses...
2022-09-21 19:56:17 INFO  Start plan generation for analysis OperatorImpact...
2022-09-21 19:56:17 INFO  ---RUNTIME: Plan generation took 5.021572113037109 ms
2022-09-21 19:56:17 INFO  Estimated runtime of original DAG is 21937.16526031494ms
2022-09-21 19:56:17 INFO  Performing Multi-Query Optimization
2022-09-21 19:56:17 INFO  Estimated unoptimized what-if runtime is 155982.06628854695ms
2022-09-21 19:56:17 INFO  Estimated optimised what-if runtime is 129690.54595399182ms
2022-09-21 19:56:17 INFO  Estimated optimisation runtime saving is 26291.520334555127ms
2022-09-21 19:56:17 INFO  ---RUNTIME: Multi-Query Optimization took 124.59683418273926 ms
2022-09-21 19:56:17 INFO  Executing generated plans
2022-09-21 19:58:08 INFO  ---RUNTIME: Execution took 110845.77178955078 ms
2022-09-21 19:58:08 INFO  Done!
2022-09-21 19:58:08 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-21 19:58:08 INFO  Running instrumented original pipeline...
2022-09-21 19:58:08 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-21 19:58:08 INFO  ---RUNTIME: Importing and monkey-patching took 6.398200988769531 ms
2022-09-21 19:58:28 INFO  ---RUNTIME: Original pipeline execution took 19726.52792930603 ms (excluding imports and monkey-patching)
2022-09-21 19:58:28 INFO  Starting execution of 1 what-if analyses...
2022-09-21 19:58:28 INFO  Start plan generation for analysis OperatorImpact...
2022-09-21 19:58:28 INFO  ---RUNTIME: Plan generation took 5.179643630981445 ms
2022-09-21 19:58:28 INFO  Estimated runtime of original DAG is 18496.61684036255ms
2022-09-21 19:58:28 WARNING Skipping Multi-Query Optimization (instead, only applying patches)
2022-09-21 19:58:28 INFO  Estimated unoptimised what-if runtime is 131452.65761543624ms
2022-09-21 19:58:28 INFO  ---RUNTIME: Multi-Query Optimization took 19.30832862854004 ms
2022-09-21 19:58:28 INFO  Executing generated plans
2022-09-21 20:00:35 INFO  ---RUNTIME: Execution took 127116.47701263428 ms
2022-09-21 20:00:35 INFO  Done!
2022-09-21 20:00:35 INFO  # Finished -- repetition 4 of 7 
2022-09-21 20:00:35 INFO  # Optimization benchmark for operator_impact with args [['reviews', 'fast_loading', 'featurization_2', 'xgboost']] -- repetition 5 of 7
2022-09-21 20:00:35 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-21 20:00:35 INFO  Running instrumented original pipeline...
2022-09-21 20:00:35 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-21 20:00:35 INFO  ---RUNTIME: Importing and monkey-patching took 6.589651107788086 ms
2022-09-21 20:00:55 INFO  ---RUNTIME: Original pipeline execution took 19669.99340057373 ms (excluding imports and monkey-patching)
2022-09-21 20:00:55 INFO  Starting execution of 1 what-if analyses...
2022-09-21 20:00:55 INFO  Start plan generation for analysis OperatorImpact...
2022-09-21 20:00:55 INFO  ---RUNTIME: Plan generation took 5.008697509765625 ms
2022-09-21 20:00:55 INFO  Estimated runtime of original DAG is 18421.976327896118ms
2022-09-21 20:00:55 INFO  Performing Multi-Query Optimization
2022-09-21 20:00:55 INFO  Estimated unoptimized what-if runtime is 131031.91317706754ms
2022-09-21 20:00:55 INFO  Estimated optimised what-if runtime is 105362.35989301724ms
2022-09-21 20:00:55 INFO  Estimated optimisation runtime saving is 25669.5532840503ms
2022-09-21 20:00:55 INFO  ---RUNTIME: Multi-Query Optimization took 124.95684623718262 ms
2022-09-21 20:00:55 INFO  Executing generated plans
2022-09-21 20:02:31 INFO  ---RUNTIME: Execution took 96552.0532131195 ms
2022-09-21 20:02:31 INFO  Done!
2022-09-21 20:02:31 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-21 20:02:31 INFO  Running instrumented original pipeline...
2022-09-21 20:02:31 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-21 20:02:31 INFO  ---RUNTIME: Importing and monkey-patching took 6.577968597412109 ms
2022-09-21 20:02:51 INFO  ---RUNTIME: Original pipeline execution took 19714.4455909729 ms (excluding imports and monkey-patching)
2022-09-21 20:02:51 INFO  Starting execution of 1 what-if analyses...
2022-09-21 20:02:51 INFO  Start plan generation for analysis OperatorImpact...
2022-09-21 20:02:51 INFO  ---RUNTIME: Plan generation took 6.145477294921875 ms
2022-09-21 20:02:51 INFO  Estimated runtime of original DAG is 18436.821937561035ms
2022-09-21 20:02:51 WARNING Skipping Multi-Query Optimization (instead, only applying patches)
2022-09-21 20:02:51 INFO  Estimated unoptimised what-if runtime is 131011.04383107272ms
2022-09-21 20:02:51 INFO  ---RUNTIME: Multi-Query Optimization took 21.578311920166016 ms
2022-09-21 20:02:51 INFO  Executing generated plans
2022-09-21 20:04:57 INFO  ---RUNTIME: Execution took 125897.9926109314 ms
2022-09-21 20:04:57 INFO  Done!
2022-09-21 20:04:57 INFO  # Finished -- repetition 5 of 7 
2022-09-21 20:04:57 INFO  # Optimization benchmark for operator_impact with args [['reviews', 'fast_loading', 'featurization_2', 'xgboost']] -- repetition 6 of 7
2022-09-21 20:04:57 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-21 20:04:57 INFO  Running instrumented original pipeline...
2022-09-21 20:04:57 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-21 20:04:57 INFO  ---RUNTIME: Importing and monkey-patching took 6.988286972045898 ms
2022-09-21 20:05:17 INFO  ---RUNTIME: Original pipeline execution took 19704.5419216156 ms (excluding imports and monkey-patching)
2022-09-21 20:05:17 INFO  Starting execution of 1 what-if analyses...
2022-09-21 20:05:17 INFO  Start plan generation for analysis OperatorImpact...
2022-09-21 20:05:17 INFO  ---RUNTIME: Plan generation took 4.963159561157227 ms
2022-09-21 20:05:17 INFO  Estimated runtime of original DAG is 18447.155475616455ms
2022-09-21 20:05:17 INFO  Performing Multi-Query Optimization
2022-09-21 20:05:17 INFO  Estimated unoptimized what-if runtime is 131236.70480671426ms
2022-09-21 20:05:17 INFO  Estimated optimised what-if runtime is 105135.90069733065ms
2022-09-21 20:05:17 INFO  Estimated optimisation runtime saving is 26100.804109383607ms
2022-09-21 20:05:17 INFO  ---RUNTIME: Multi-Query Optimization took 120.94879150390625 ms
2022-09-21 20:05:17 INFO  Executing generated plans
2022-09-21 20:06:52 INFO  ---RUNTIME: Execution took 94921.94819450378 ms
2022-09-21 20:06:52 INFO  Done!
2022-09-21 20:06:52 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-21 20:06:52 INFO  Running instrumented original pipeline...
2022-09-21 20:06:52 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-21 20:06:52 INFO  ---RUNTIME: Importing and monkey-patching took 6.110906600952148 ms
2022-09-21 20:07:11 INFO  ---RUNTIME: Original pipeline execution took 19509.733200073242 ms (excluding imports and monkey-patching)
2022-09-21 20:07:11 INFO  Starting execution of 1 what-if analyses...
2022-09-21 20:07:11 INFO  Start plan generation for analysis OperatorImpact...
2022-09-21 20:07:11 INFO  ---RUNTIME: Plan generation took 4.887580871582031 ms
2022-09-21 20:07:11 INFO  Estimated runtime of original DAG is 18246.843338012695ms
2022-09-21 20:07:11 WARNING Skipping Multi-Query Optimization (instead, only applying patches)
2022-09-21 20:07:11 INFO  Estimated unoptimised what-if runtime is 129654.20246416748ms
2022-09-21 20:07:11 INFO  ---RUNTIME: Multi-Query Optimization took 17.061233520507812 ms
2022-09-21 20:07:11 INFO  Executing generated plans
2022-09-21 20:09:17 INFO  ---RUNTIME: Execution took 125867.32697486877 ms
2022-09-21 20:09:17 INFO  Done!
2022-09-21 20:09:17 INFO  # Finished -- repetition 6 of 7 
2022-09-21 20:09:17 INFO  # Optimization benchmark for operator_impact with args [['reviews', 'fast_loading', 'featurization_2', 'xgboost']] -- repetition 7 of 7
2022-09-21 20:09:17 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-21 20:09:17 INFO  Running instrumented original pipeline...
2022-09-21 20:09:17 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-21 20:09:17 INFO  ---RUNTIME: Importing and monkey-patching took 5.915641784667969 ms
2022-09-21 20:09:37 INFO  ---RUNTIME: Original pipeline execution took 19980.557441711426 ms (excluding imports and monkey-patching)
2022-09-21 20:09:37 INFO  Starting execution of 1 what-if analyses...
2022-09-21 20:09:37 INFO  Start plan generation for analysis OperatorImpact...
2022-09-21 20:09:37 INFO  ---RUNTIME: Plan generation took 4.976034164428711 ms
2022-09-21 20:09:37 INFO  Estimated runtime of original DAG is 18455.556631088257ms
2022-09-21 20:09:37 INFO  Performing Multi-Query Optimization
2022-09-21 20:09:37 INFO  Estimated unoptimized what-if runtime is 131279.48812825241ms
2022-09-21 20:09:37 INFO  Estimated optimised what-if runtime is 105103.70385830768ms
2022-09-21 20:09:37 INFO  Estimated optimisation runtime saving is 26175.784269944736ms
2022-09-21 20:09:37 INFO  ---RUNTIME: Multi-Query Optimization took 134.94586944580078 ms
2022-09-21 20:09:37 INFO  Executing generated plans
2022-09-21 20:11:13 INFO  ---RUNTIME: Execution took 95902.43697166443 ms
2022-09-21 20:11:13 INFO  Done!
2022-09-21 20:11:13 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-21 20:11:13 INFO  Running instrumented original pipeline...
2022-09-21 20:11:13 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-21 20:11:13 INFO  ---RUNTIME: Importing and monkey-patching took 6.254434585571289 ms
2022-09-21 20:11:33 INFO  ---RUNTIME: Original pipeline execution took 19725.459098815918 ms (excluding imports and monkey-patching)
2022-09-21 20:11:33 INFO  Starting execution of 1 what-if analyses...
2022-09-21 20:11:33 INFO  Start plan generation for analysis OperatorImpact...
2022-09-21 20:11:33 INFO  ---RUNTIME: Plan generation took 5.456447601318359 ms
2022-09-21 20:11:33 INFO  Estimated runtime of original DAG is 18492.33388900757ms
2022-09-21 20:11:33 WARNING Skipping Multi-Query Optimization (instead, only applying patches)
2022-09-21 20:11:33 INFO  Estimated unoptimised what-if runtime is 131371.01302211007ms
2022-09-21 20:11:33 INFO  ---RUNTIME: Multi-Query Optimization took 18.79596710205078 ms
2022-09-21 20:11:33 INFO  Executing generated plans
2022-09-21 20:13:40 INFO  ---RUNTIME: Execution took 126874.68528747559 ms
2022-09-21 20:13:40 INFO  Done!
2022-09-21 20:13:40 INFO  # Finished -- repetition 7 of 7 
2022-09-21 20:13:40 INFO  # Final results after all repetitions
2022-09-21 20:13:40 INFO     repetition  ... no_opt_what_if_execution_combined_model_training
0           0  ...                                     89359.026432
1           1  ...                                     93671.111345
2           2  ...                                     95191.000700
3           3  ...                                     80917.396784
4           4  ...                                     80439.125299
5           5  ...                                     80048.332453
6           6  ...                                     81066.540003

[7 rows x 26 columns]
taskset -c 160-167 PROTOCOL_BUFFERS_PYTHON_IMPLEMENTATION=python python3.9 benchmarks_end_to_end.py operator_impact reviews fast_loading featurization_2 neural_network
2022-09-21 20:13:42.529498: W tensorflow/stream_executor/platform/default/dso_loader.cc:64] Could not load dynamic library 'libcudart.so.11.0'; dlerror: libcudart.so.11.0: cannot open shared object file: No such file or directory; LD_LIBRARY_PATH: /home/sgrafbe/mlwhatif/venv/lib/python3.9/site-packages/cv2/../../lib64:
2022-09-21 20:13:42.529543: I tensorflow/stream_executor/cuda/cudart_stub.cc:29] Ignore above cudart dlerror if you do not have a GPU set up on your machine.
2022-09-21 20:13:43 INFO  Patching sys.argv with ['mlwhatif', 'reviews', 'fast_loading', 'featurization_2', 'neural_network']
2022-09-21 20:13:43 INFO  Running instrumented original pipeline...
2022-09-21 20:13:43 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-21 20:13:44 INFO  ---RUNTIME: Importing and monkey-patching took 123.81672859191895 ms
2022-09-21 20:13:49.172969: W tensorflow/stream_executor/platform/default/dso_loader.cc:64] Could not load dynamic library 'libcuda.so.1'; dlerror: libcuda.so.1: cannot open shared object file: No such file or directory; LD_LIBRARY_PATH: /home/sgrafbe/mlwhatif/venv/lib/python3.9/site-packages/cv2/../../lib64:
2022-09-21 20:13:49.173007: W tensorflow/stream_executor/cuda/cuda_driver.cc:326] failed call to cuInit: UNKNOWN ERROR (303)
2022-09-21 20:13:49.173032: I tensorflow/stream_executor/cuda/cuda_diagnostics.cc:156] kernel driver does not appear to be running on this host (angus): /proc/driver/nvidia/version does not exist
2022-09-21 20:13:49.173546: I tensorflow/core/platform/cpu_feature_guard.cc:142] This TensorFlow binary is optimized with oneAPI Deep Neural Network Library (oneDNN) to use the following CPU instructions in performance-critical operations:  AVX2 FMA
To enable them in other operations, rebuild TensorFlow with the appropriate compiler flags.
2022-09-21 20:13:49.802344: I tensorflow/compiler/mlir/mlir_graph_optimization_pass.cc:176] None of the MLIR Optimization Passes are enabled (registered 2)
2022-09-21 20:13:49.816198: I tensorflow/core/platform/profile_utils/cpu_utils.cc:114] CPU Frequency: 2595130000 Hz
2022-09-21 20:13:58 INFO  ---RUNTIME: Original pipeline execution took 14381.673574447632 ms (excluding imports and monkey-patching)
2022-09-21 20:13:58 INFO  Starting execution of 0 what-if analyses...
2022-09-21 20:13:58 INFO  Estimated runtime of original DAG is 13161.41390800476ms
2022-09-21 20:13:58 INFO  Performing Multi-Query Optimization
2022-09-21 20:13:58 INFO  Estimated unoptimized what-if runtime is 0ms
2022-09-21 20:13:58 INFO  Estimated optimised what-if runtime is 0ms
2022-09-21 20:13:58 INFO  Estimated optimisation runtime saving is 0ms
2022-09-21 20:13:58 INFO  ---RUNTIME: Multi-Query Optimization took 0.5619525909423828 ms
2022-09-21 20:13:58 INFO  Executing generated plans
2022-09-21 20:13:58 INFO  ---RUNTIME: Execution took 0.025510787963867188 ms
2022-09-21 20:13:58 INFO  Done!
2022-09-21 20:13:58 INFO  # Optimization benchmark for operator_impact with args [['reviews', 'fast_loading', 'featurization_2', 'neural_network']] -- repetition 1 of 7
2022-09-21 20:13:58 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-21 20:13:58 INFO  Running instrumented original pipeline...
2022-09-21 20:13:58 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-21 20:13:58 INFO  ---RUNTIME: Importing and monkey-patching took 5.3539276123046875 ms
2022-09-21 20:14:12 INFO  ---RUNTIME: Original pipeline execution took 13929.604291915894 ms (excluding imports and monkey-patching)
2022-09-21 20:14:12 INFO  Starting execution of 1 what-if analyses...
2022-09-21 20:14:12 INFO  Start plan generation for analysis OperatorImpact...
2022-09-21 20:14:12 INFO  ---RUNTIME: Plan generation took 5.7735443115234375 ms
2022-09-21 20:14:12 INFO  Estimated runtime of original DAG is 12747.599363327026ms
2022-09-21 20:14:12 INFO  Performing Multi-Query Optimization
2022-09-21 20:14:12 INFO  Estimated unoptimized what-if runtime is 90527.65441480049ms
2022-09-21 20:14:12 INFO  Estimated optimised what-if runtime is 65312.577066992075ms
2022-09-21 20:14:12 INFO  Estimated optimisation runtime saving is 25215.077347808416ms
2022-09-21 20:14:12 INFO  ---RUNTIME: Multi-Query Optimization took 128.17668914794922 ms
2022-09-21 20:14:12 INFO  Executing generated plans
2022-09-21 20:15:19 INFO  ---RUNTIME: Execution took 66867.09547042847 ms
2022-09-21 20:15:19 INFO  Done!
2022-09-21 20:15:19 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-21 20:15:19 INFO  Running instrumented original pipeline...
2022-09-21 20:15:19 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-21 20:15:19 INFO  ---RUNTIME: Importing and monkey-patching took 6.262063980102539 ms
2022-09-21 20:15:32 INFO  ---RUNTIME: Original pipeline execution took 13420.394659042358 ms (excluding imports and monkey-patching)
2022-09-21 20:15:32 INFO  Starting execution of 1 what-if analyses...
2022-09-21 20:15:32 INFO  Start plan generation for analysis OperatorImpact...
2022-09-21 20:15:32 INFO  ---RUNTIME: Plan generation took 4.892587661743164 ms
2022-09-21 20:15:32 INFO  Estimated runtime of original DAG is 12234.564781188965ms
2022-09-21 20:15:32 WARNING Skipping Multi-Query Optimization (instead, only applying patches)
2022-09-21 20:15:32 INFO  Estimated unoptimised what-if runtime is 86719.2897681199ms
2022-09-21 20:15:32 INFO  ---RUNTIME: Multi-Query Optimization took 18.047571182250977 ms
2022-09-21 20:15:32 INFO  Executing generated plans
2022-09-21 20:17:07 INFO  ---RUNTIME: Execution took 94305.02533912659 ms
2022-09-21 20:17:07 INFO  Done!
2022-09-21 20:17:07 INFO  # Finished -- repetition 1 of 7 
2022-09-21 20:17:07 INFO  # Optimization benchmark for operator_impact with args [['reviews', 'fast_loading', 'featurization_2', 'neural_network']] -- repetition 2 of 7
2022-09-21 20:17:07 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-21 20:17:07 INFO  Running instrumented original pipeline...
2022-09-21 20:17:07 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-21 20:17:07 INFO  ---RUNTIME: Importing and monkey-patching took 6.028175354003906 ms
2022-09-21 20:17:20 INFO  ---RUNTIME: Original pipeline execution took 13289.277076721191 ms (excluding imports and monkey-patching)
2022-09-21 20:17:20 INFO  Starting execution of 1 what-if analyses...
2022-09-21 20:17:20 INFO  Start plan generation for analysis OperatorImpact...
2022-09-21 20:17:20 INFO  ---RUNTIME: Plan generation took 4.997968673706055 ms
2022-09-21 20:17:20 INFO  Estimated runtime of original DAG is 12091.488599777222ms
2022-09-21 20:17:20 INFO  Performing Multi-Query Optimization
2022-09-21 20:17:20 INFO  Estimated unoptimized what-if runtime is 85837.53564571113ms
2022-09-21 20:17:20 INFO  Estimated optimised what-if runtime is 61063.5770359513ms
2022-09-21 20:17:20 INFO  Estimated optimisation runtime saving is 24773.958609759837ms
2022-09-21 20:17:20 INFO  ---RUNTIME: Multi-Query Optimization took 126.03306770324707 ms
2022-09-21 20:17:20 INFO  Executing generated plans
2022-09-21 20:18:25 INFO  ---RUNTIME: Execution took 65260.60390472412 ms
2022-09-21 20:18:25 INFO  Done!
2022-09-21 20:18:25 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-21 20:18:25 INFO  Running instrumented original pipeline...
2022-09-21 20:18:25 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-21 20:18:25 INFO  ---RUNTIME: Importing and monkey-patching took 6.11114501953125 ms
2022-09-21 20:18:39 INFO  ---RUNTIME: Original pipeline execution took 13365.375757217407 ms (excluding imports and monkey-patching)
2022-09-21 20:18:39 INFO  Starting execution of 1 what-if analyses...
2022-09-21 20:18:39 INFO  Start plan generation for analysis OperatorImpact...
2022-09-21 20:18:39 INFO  ---RUNTIME: Plan generation took 4.953145980834961 ms
2022-09-21 20:18:39 INFO  Estimated runtime of original DAG is 12163.885116577148ms
2022-09-21 20:18:39 WARNING Skipping Multi-Query Optimization (instead, only applying patches)
2022-09-21 20:18:39 INFO  Estimated unoptimised what-if runtime is 86221.15014311585ms
2022-09-21 20:18:39 INFO  ---RUNTIME: Multi-Query Optimization took 17.351865768432617 ms
2022-09-21 20:18:39 INFO  Executing generated plans
2022-09-21 20:20:13 INFO  ---RUNTIME: Execution took 94770.17951011658 ms
2022-09-21 20:20:13 INFO  Done!
2022-09-21 20:20:13 INFO  # Finished -- repetition 2 of 7 
2022-09-21 20:20:13 INFO  # Optimization benchmark for operator_impact with args [['reviews', 'fast_loading', 'featurization_2', 'neural_network']] -- repetition 3 of 7
2022-09-21 20:20:13 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-21 20:20:13 INFO  Running instrumented original pipeline...
2022-09-21 20:20:13 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-21 20:20:13 INFO  ---RUNTIME: Importing and monkey-patching took 5.896806716918945 ms
2022-09-21 20:20:27 INFO  ---RUNTIME: Original pipeline execution took 13401.349782943726 ms (excluding imports and monkey-patching)
2022-09-21 20:20:27 INFO  Starting execution of 1 what-if analyses...
2022-09-21 20:20:27 INFO  Start plan generation for analysis OperatorImpact...
2022-09-21 20:20:27 INFO  ---RUNTIME: Plan generation took 5.945920944213867 ms
2022-09-21 20:20:27 INFO  Estimated runtime of original DAG is 12192.509889602661ms
2022-09-21 20:20:27 INFO  Performing Multi-Query Optimization
2022-09-21 20:20:27 INFO  Estimated unoptimized what-if runtime is 86556.27973455272ms
2022-09-21 20:20:27 INFO  Estimated optimised what-if runtime is 61420.60140053097ms
2022-09-21 20:20:27 INFO  Estimated optimisation runtime saving is 25135.67833402175ms
2022-09-21 20:20:27 INFO  ---RUNTIME: Multi-Query Optimization took 125.85687637329102 ms
2022-09-21 20:20:27 INFO  Executing generated plans
2022-09-21 20:21:51 INFO  ---RUNTIME: Execution took 83841.85767173767 ms
2022-09-21 20:21:51 INFO  Done!
2022-09-21 20:21:51 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-21 20:21:51 INFO  Running instrumented original pipeline...
2022-09-21 20:21:51 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-21 20:21:51 INFO  ---RUNTIME: Importing and monkey-patching took 11.521577835083008 ms
2022-09-21 20:22:06 INFO  ---RUNTIME: Original pipeline execution took 14912.50991821289 ms (excluding imports and monkey-patching)
2022-09-21 20:22:06 INFO  Starting execution of 1 what-if analyses...
2022-09-21 20:22:06 INFO  Start plan generation for analysis OperatorImpact...
2022-09-21 20:22:06 INFO  ---RUNTIME: Plan generation took 6.937742233276367 ms
2022-09-21 20:22:06 INFO  Estimated runtime of original DAG is 13653.29098701477ms
2022-09-21 20:22:06 WARNING Skipping Multi-Query Optimization (instead, only applying patches)
2022-09-21 20:22:06 INFO  Estimated unoptimised what-if runtime is 96763.21919082894ms
2022-09-21 20:22:06 INFO  ---RUNTIME: Multi-Query Optimization took 17.645835876464844 ms
2022-09-21 20:22:06 INFO  Executing generated plans
2022-09-21 20:23:42 INFO  ---RUNTIME: Execution took 95949.4788646698 ms
2022-09-21 20:23:42 INFO  Done!
2022-09-21 20:23:42 INFO  # Finished -- repetition 3 of 7 
2022-09-21 20:23:42 INFO  # Optimization benchmark for operator_impact with args [['reviews', 'fast_loading', 'featurization_2', 'neural_network']] -- repetition 4 of 7
2022-09-21 20:23:42 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-21 20:23:42 INFO  Running instrumented original pipeline...
2022-09-21 20:23:42 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-21 20:23:42 INFO  ---RUNTIME: Importing and monkey-patching took 5.864620208740234 ms
2022-09-21 20:23:56 INFO  ---RUNTIME: Original pipeline execution took 14118.076086044312 ms (excluding imports and monkey-patching)
2022-09-21 20:23:56 INFO  Starting execution of 1 what-if analyses...
2022-09-21 20:23:56 INFO  Start plan generation for analysis OperatorImpact...
2022-09-21 20:23:56 INFO  ---RUNTIME: Plan generation took 4.955053329467773 ms
2022-09-21 20:23:56 INFO  Estimated runtime of original DAG is 12893.281936645508ms
2022-09-21 20:23:56 INFO  Performing Multi-Query Optimization
2022-09-21 20:23:56 INFO  Estimated unoptimized what-if runtime is 91594.18161805658ms
2022-09-21 20:23:56 INFO  Estimated optimised what-if runtime is 64752.32446645998ms
2022-09-21 20:23:56 INFO  Estimated optimisation runtime saving is 26841.857151596603ms
2022-09-21 20:23:56 INFO  ---RUNTIME: Multi-Query Optimization took 129.3175220489502 ms
2022-09-21 20:23:56 INFO  Executing generated plans
2022-09-21 20:25:02 INFO  ---RUNTIME: Execution took 65882.9345703125 ms
2022-09-21 20:25:02 INFO  Done!
2022-09-21 20:25:02 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-21 20:25:02 INFO  Running instrumented original pipeline...
2022-09-21 20:25:02 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-21 20:25:02 INFO  ---RUNTIME: Importing and monkey-patching took 6.022214889526367 ms
2022-09-21 20:25:16 INFO  ---RUNTIME: Original pipeline execution took 13858.83617401123 ms (excluding imports and monkey-patching)
2022-09-21 20:25:16 INFO  Starting execution of 1 what-if analyses...
2022-09-21 20:25:16 INFO  Start plan generation for analysis OperatorImpact...
2022-09-21 20:25:16 INFO  ---RUNTIME: Plan generation took 5.154848098754883 ms
2022-09-21 20:25:16 INFO  Estimated runtime of original DAG is 12645.12848854065ms
2022-09-21 20:25:16 WARNING Skipping Multi-Query Optimization (instead, only applying patches)
2022-09-21 20:25:16 INFO  Estimated unoptimised what-if runtime is 89611.8392894383ms
2022-09-21 20:25:16 INFO  ---RUNTIME: Multi-Query Optimization took 18.040895462036133 ms
2022-09-21 20:25:16 INFO  Executing generated plans
2022-09-21 20:26:51 INFO  ---RUNTIME: Execution took 95297.94096946716 ms
2022-09-21 20:26:51 INFO  Done!
2022-09-21 20:26:51 INFO  # Finished -- repetition 4 of 7 
2022-09-21 20:26:51 INFO  # Optimization benchmark for operator_impact with args [['reviews', 'fast_loading', 'featurization_2', 'neural_network']] -- repetition 5 of 7
2022-09-21 20:26:51 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-21 20:26:51 INFO  Running instrumented original pipeline...
2022-09-21 20:26:51 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-21 20:26:51 INFO  ---RUNTIME: Importing and monkey-patching took 5.793094635009766 ms
2022-09-21 20:27:05 INFO  ---RUNTIME: Original pipeline execution took 14052.338361740112 ms (excluding imports and monkey-patching)
2022-09-21 20:27:05 INFO  Starting execution of 1 what-if analyses...
2022-09-21 20:27:05 INFO  Start plan generation for analysis OperatorImpact...
2022-09-21 20:27:05 INFO  ---RUNTIME: Plan generation took 4.897356033325195 ms
2022-09-21 20:27:05 INFO  Estimated runtime of original DAG is 12844.113111495972ms
2022-09-21 20:27:05 INFO  Performing Multi-Query Optimization
2022-09-21 20:27:05 INFO  Estimated unoptimized what-if runtime is 91200.45645226566ms
2022-09-21 20:27:05 INFO  Estimated optimised what-if runtime is 65831.59128452597ms
2022-09-21 20:27:05 INFO  Estimated optimisation runtime saving is 25368.865167739685ms
2022-09-21 20:27:05 INFO  ---RUNTIME: Multi-Query Optimization took 126.18184089660645 ms
2022-09-21 20:27:05 INFO  Executing generated plans
2022-09-21 20:28:10 INFO  ---RUNTIME: Execution took 65029.2387008667 ms
2022-09-21 20:28:10 INFO  Done!
2022-09-21 20:28:10 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-21 20:28:10 INFO  Running instrumented original pipeline...
2022-09-21 20:28:10 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-21 20:28:10 INFO  ---RUNTIME: Importing and monkey-patching took 5.919456481933594 ms
2022-09-21 20:28:24 INFO  ---RUNTIME: Original pipeline execution took 13429.953336715698 ms (excluding imports and monkey-patching)
2022-09-21 20:28:24 INFO  Starting execution of 1 what-if analyses...
2022-09-21 20:28:24 INFO  Start plan generation for analysis OperatorImpact...
2022-09-21 20:28:24 INFO  ---RUNTIME: Plan generation took 4.9495697021484375 ms
2022-09-21 20:28:24 INFO  Estimated runtime of original DAG is 12205.446720123291ms
2022-09-21 20:28:24 WARNING Skipping Multi-Query Optimization (instead, only applying patches)
2022-09-21 20:28:24 INFO  Estimated unoptimised what-if runtime is 86499.65172434073ms
2022-09-21 20:28:24 INFO  ---RUNTIME: Multi-Query Optimization took 17.519474029541016 ms
2022-09-21 20:28:24 INFO  Executing generated plans
2022-09-21 20:30:01 INFO  ---RUNTIME: Execution took 96886.23809814453 ms
2022-09-21 20:30:01 INFO  Done!
2022-09-21 20:30:01 INFO  # Finished -- repetition 5 of 7 
2022-09-21 20:30:01 INFO  # Optimization benchmark for operator_impact with args [['reviews', 'fast_loading', 'featurization_2', 'neural_network']] -- repetition 6 of 7
2022-09-21 20:30:01 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-21 20:30:01 INFO  Running instrumented original pipeline...
2022-09-21 20:30:01 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-21 20:30:01 INFO  ---RUNTIME: Importing and monkey-patching took 6.590843200683594 ms
2022-09-21 20:30:14 INFO  ---RUNTIME: Original pipeline execution took 13586.961030960083 ms (excluding imports and monkey-patching)
2022-09-21 20:30:14 INFO  Starting execution of 1 what-if analyses...
2022-09-21 20:30:14 INFO  Start plan generation for analysis OperatorImpact...
2022-09-21 20:30:14 INFO  ---RUNTIME: Plan generation took 5.977630615234375 ms
2022-09-21 20:30:14 INFO  Estimated runtime of original DAG is 12351.813554763794ms
2022-09-21 20:30:14 INFO  Performing Multi-Query Optimization
2022-09-21 20:30:14 INFO  Estimated unoptimized what-if runtime is 87664.92224362552ms
2022-09-21 20:30:14 INFO  Estimated optimised what-if runtime is 61642.45076490452ms
2022-09-21 20:30:14 INFO  Estimated optimisation runtime saving is 26022.471478721003ms
2022-09-21 20:30:14 INFO  ---RUNTIME: Multi-Query Optimization took 128.23057174682617 ms
2022-09-21 20:30:14 INFO  Executing generated plans
2022-09-21 20:31:20 INFO  ---RUNTIME: Execution took 65602.23627090454 ms
2022-09-21 20:31:20 INFO  Done!
2022-09-21 20:31:20 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-21 20:31:20 INFO  Running instrumented original pipeline...
2022-09-21 20:31:20 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-21 20:31:20 INFO  ---RUNTIME: Importing and monkey-patching took 6.057024002075195 ms
2022-09-21 20:31:34 INFO  ---RUNTIME: Original pipeline execution took 13513.45944404602 ms (excluding imports and monkey-patching)
2022-09-21 20:31:34 INFO  Starting execution of 1 what-if analyses...
2022-09-21 20:31:34 INFO  Start plan generation for analysis OperatorImpact...
2022-09-21 20:31:34 INFO  ---RUNTIME: Plan generation took 5.816459655761719 ms
2022-09-21 20:31:34 INFO  Estimated runtime of original DAG is 12287.654399871826ms
2022-09-21 20:31:34 WARNING Skipping Multi-Query Optimization (instead, only applying patches)
2022-09-21 20:31:34 INFO  Estimated unoptimised what-if runtime is 87104.06199830177ms
2022-09-21 20:31:34 INFO  ---RUNTIME: Multi-Query Optimization took 17.131328582763672 ms
2022-09-21 20:31:34 INFO  Executing generated plans
2022-09-21 20:33:10 INFO  ---RUNTIME: Execution took 96454.69164848328 ms
2022-09-21 20:33:10 INFO  Done!
2022-09-21 20:33:10 INFO  # Finished -- repetition 6 of 7 
2022-09-21 20:33:10 INFO  # Optimization benchmark for operator_impact with args [['reviews', 'fast_loading', 'featurization_2', 'neural_network']] -- repetition 7 of 7
2022-09-21 20:33:10 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-21 20:33:10 INFO  Running instrumented original pipeline...
2022-09-21 20:33:10 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-21 20:33:10 INFO  ---RUNTIME: Importing and monkey-patching took 6.238698959350586 ms
2022-09-21 20:33:24 INFO  ---RUNTIME: Original pipeline execution took 13497.735261917114 ms (excluding imports and monkey-patching)
2022-09-21 20:33:24 INFO  Starting execution of 1 what-if analyses...
2022-09-21 20:33:24 INFO  Start plan generation for analysis OperatorImpact...
2022-09-21 20:33:24 INFO  ---RUNTIME: Plan generation took 5.09953498840332 ms
2022-09-21 20:33:24 INFO  Estimated runtime of original DAG is 12289.851903915405ms
2022-09-21 20:33:24 INFO  Performing Multi-Query Optimization
2022-09-21 20:33:24 INFO  Estimated unoptimized what-if runtime is 87226.68771637976ms
2022-09-21 20:33:24 INFO  Estimated optimised what-if runtime is 61876.37311062581ms
2022-09-21 20:33:24 INFO  Estimated optimisation runtime saving is 25350.31460575395ms
2022-09-21 20:33:24 INFO  ---RUNTIME: Multi-Query Optimization took 127.39419937133789 ms
2022-09-21 20:33:24 INFO  Executing generated plans
2022-09-21 20:34:29 INFO  ---RUNTIME: Execution took 65342.78678894043 ms
2022-09-21 20:34:29 INFO  Done!
2022-09-21 20:34:29 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-21 20:34:29 INFO  Running instrumented original pipeline...
2022-09-21 20:34:29 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-21 20:34:29 INFO  ---RUNTIME: Importing and monkey-patching took 6.188631057739258 ms
2022-09-21 20:34:43 INFO  ---RUNTIME: Original pipeline execution took 14169.207096099854 ms (excluding imports and monkey-patching)
2022-09-21 20:34:43 INFO  Starting execution of 1 what-if analyses...
2022-09-21 20:34:43 INFO  Start plan generation for analysis OperatorImpact...
2022-09-21 20:34:43 INFO  ---RUNTIME: Plan generation took 4.930019378662109 ms
2022-09-21 20:34:43 INFO  Estimated runtime of original DAG is 12939.550399780273ms
2022-09-21 20:34:43 WARNING Skipping Multi-Query Optimization (instead, only applying patches)
2022-09-21 20:34:43 INFO  Estimated unoptimised what-if runtime is 91736.60553065116ms
2022-09-21 20:34:43 INFO  ---RUNTIME: Multi-Query Optimization took 18.12005043029785 ms
2022-09-21 20:34:43 INFO  Executing generated plans
2022-09-21 20:36:20 INFO  ---RUNTIME: Execution took 96585.48474311829 ms
2022-09-21 20:36:20 INFO  Done!
2022-09-21 20:36:20 INFO  # Finished -- repetition 7 of 7 
2022-09-21 20:36:20 INFO  # Final results after all repetitions
2022-09-21 20:36:20 INFO     repetition  ... no_opt_what_if_execution_combined_model_training
0           0  ...                                     44769.085884
1           1  ...                                     44846.995354
2           2  ...                                     44505.602121
3           3  ...                                     44433.168411
4           4  ...                                     45548.927307
5           5  ...                                     45482.048988
6           6  ...                                     45195.250034

[7 rows x 26 columns]
taskset -c 160-167 PROTOCOL_BUFFERS_PYTHON_IMPLEMENTATION=python python3.9 benchmarks_end_to_end.py operator_impact reviews fast_loading featurization_3 logistic_regression
2022-09-21 20:36:23.916185: W tensorflow/stream_executor/platform/default/dso_loader.cc:64] Could not load dynamic library 'libcudart.so.11.0'; dlerror: libcudart.so.11.0: cannot open shared object file: No such file or directory; LD_LIBRARY_PATH: /home/sgrafbe/mlwhatif/venv/lib/python3.9/site-packages/cv2/../../lib64:
2022-09-21 20:36:23.916227: I tensorflow/stream_executor/cuda/cudart_stub.cc:29] Ignore above cudart dlerror if you do not have a GPU set up on your machine.
2022-09-21 20:36:25 INFO  Patching sys.argv with ['mlwhatif', 'reviews', 'fast_loading', 'featurization_3', 'logistic_regression']
2022-09-21 20:36:25 INFO  Running instrumented original pipeline...
2022-09-21 20:36:25 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-21 20:36:25 INFO  ---RUNTIME: Importing and monkey-patching took 127.65049934387207 ms
2022-09-21 20:37:09 INFO  ---RUNTIME: Original pipeline execution took 44181.05053901672 ms (excluding imports and monkey-patching)
2022-09-21 20:37:09 INFO  Starting execution of 0 what-if analyses...
2022-09-21 20:37:09 INFO  Estimated runtime of original DAG is 33063.85540962219ms
2022-09-21 20:37:09 INFO  Performing Multi-Query Optimization
2022-09-21 20:37:09 INFO  Estimated unoptimized what-if runtime is 0ms
2022-09-21 20:37:09 INFO  Estimated optimised what-if runtime is 0ms
2022-09-21 20:37:09 INFO  Estimated optimisation runtime saving is 0ms
2022-09-21 20:37:09 INFO  ---RUNTIME: Multi-Query Optimization took 0.6246566772460938 ms
2022-09-21 20:37:09 INFO  Executing generated plans
2022-09-21 20:37:09 INFO  ---RUNTIME: Execution took 0.026702880859375 ms
2022-09-21 20:37:09 INFO  Done!
2022-09-21 20:37:09 INFO  # Optimization benchmark for operator_impact with args [['reviews', 'fast_loading', 'featurization_3', 'logistic_regression']] -- repetition 1 of 7
2022-09-21 20:37:09 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-21 20:37:09 INFO  Running instrumented original pipeline...
2022-09-21 20:37:09 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-21 20:37:09 INFO  ---RUNTIME: Importing and monkey-patching took 6.208896636962891 ms
2022-09-21 20:37:58 INFO  ---RUNTIME: Original pipeline execution took 48570.56760787964 ms (excluding imports and monkey-patching)
2022-09-21 20:37:58 INFO  Starting execution of 1 what-if analyses...
2022-09-21 20:37:58 INFO  Start plan generation for analysis OperatorImpact...
2022-09-21 20:37:58 INFO  ---RUNTIME: Plan generation took 7.515192031860352 ms
2022-09-21 20:37:58 INFO  Estimated runtime of original DAG is 33562.498807907104ms
2022-09-21 20:37:58 INFO  Performing Multi-Query Optimization
2022-09-21 20:37:58 INFO  Estimated unoptimized what-if runtime is 397225.2433838689ms
2022-09-21 20:37:58 INFO  Estimated optimised what-if runtime is 190380.20934902516ms
2022-09-21 20:37:58 INFO  Estimated optimisation runtime saving is 206845.03403484373ms
2022-09-21 20:37:58 INFO  ---RUNTIME: Multi-Query Optimization took 169.51584815979004 ms
2022-09-21 20:37:58 INFO  Executing generated plans
2022-09-21 20:41:05 INFO  ---RUNTIME: Execution took 187087.87989616394 ms
2022-09-21 20:41:05 INFO  Done!
2022-09-21 20:41:05 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-21 20:41:05 INFO  Running instrumented original pipeline...
2022-09-21 20:41:05 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-21 20:41:05 INFO  ---RUNTIME: Importing and monkey-patching took 6.833553314208984 ms
2022-09-21 20:41:51 INFO  ---RUNTIME: Original pipeline execution took 46212.019205093384 ms (excluding imports and monkey-patching)
2022-09-21 20:41:51 INFO  Starting execution of 1 what-if analyses...
2022-09-21 20:41:51 INFO  Start plan generation for analysis OperatorImpact...
2022-09-21 20:41:51 INFO  ---RUNTIME: Plan generation took 6.336450576782227 ms
2022-09-21 20:41:51 INFO  Estimated runtime of original DAG is 32986.17672920227ms
2022-09-21 20:41:51 WARNING Skipping Multi-Query Optimization (instead, only applying patches)
2022-09-21 20:41:51 INFO  Estimated unoptimised what-if runtime is 390036.3484225834ms
2022-09-21 20:41:51 INFO  ---RUNTIME: Multi-Query Optimization took 22.96137809753418 ms
2022-09-21 20:41:51 INFO  Executing generated plans
2022-09-21 20:48:27 INFO  ---RUNTIME: Execution took 395339.5245075226 ms
2022-09-21 20:48:27 INFO  Done!
2022-09-21 20:48:27 INFO  # Finished -- repetition 1 of 7 
2022-09-21 20:48:27 INFO  # Optimization benchmark for operator_impact with args [['reviews', 'fast_loading', 'featurization_3', 'logistic_regression']] -- repetition 2 of 7
2022-09-21 20:48:27 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-21 20:48:27 INFO  Running instrumented original pipeline...
2022-09-21 20:48:27 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-21 20:48:27 INFO  ---RUNTIME: Importing and monkey-patching took 6.353139877319336 ms
2022-09-21 20:49:46 INFO  ---RUNTIME: Original pipeline execution took 79241.83630943298 ms (excluding imports and monkey-patching)
2022-09-21 20:49:46 INFO  Starting execution of 1 what-if analyses...
2022-09-21 20:49:46 INFO  Start plan generation for analysis OperatorImpact...
2022-09-21 20:49:46 INFO  ---RUNTIME: Plan generation took 56.967973709106445 ms
2022-09-21 20:49:46 INFO  Estimated runtime of original DAG is 41646.1136341095ms
2022-09-21 20:49:46 INFO  Performing Multi-Query Optimization
2022-09-21 20:49:46 INFO  Estimated unoptimized what-if runtime is 492518.04808599234ms
2022-09-21 20:49:46 INFO  Estimated optimised what-if runtime is 244290.267423638ms
2022-09-21 20:49:46 INFO  Estimated optimisation runtime saving is 248227.78066235434ms
2022-09-21 20:49:46 INFO  ---RUNTIME: Multi-Query Optimization took 199.81074333190918 ms
2022-09-21 20:49:46 INFO  Executing generated plans
2022-09-21 20:52:03 INFO  ---RUNTIME: Execution took 136887.81881332397 ms
2022-09-21 20:52:03 INFO  Done!
2022-09-21 20:52:05 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-21 20:52:05 INFO  Running instrumented original pipeline...
2022-09-21 20:52:05 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-21 20:52:05 INFO  ---RUNTIME: Importing and monkey-patching took 10.508537292480469 ms
2022-09-21 20:52:51 INFO  ---RUNTIME: Original pipeline execution took 46710.80708503723 ms (excluding imports and monkey-patching)
2022-09-21 20:52:51 INFO  Starting execution of 1 what-if analyses...
2022-09-21 20:52:51 INFO  Start plan generation for analysis OperatorImpact...
2022-09-21 20:52:51 INFO  ---RUNTIME: Plan generation took 6.344795227050781 ms
2022-09-21 20:52:51 INFO  Estimated runtime of original DAG is 33653.81383895874ms
2022-09-21 20:52:51 WARNING Skipping Multi-Query Optimization (instead, only applying patches)
2022-09-21 20:52:51 INFO  Estimated unoptimised what-if runtime is 397867.2636085749ms
2022-09-21 20:52:51 INFO  ---RUNTIME: Multi-Query Optimization took 23.688316345214844 ms
2022-09-21 20:52:51 INFO  Executing generated plans
Traceback (most recent call last):
  File "/home/sgrafbe/mlwhatif/experiments/end_to_end/benchmarks_end_to_end.py", line 238, in <module>
    analysis_result_no_opt = PipelineAnalyzer \
  File "/home/sgrafbe/mlwhatif/mlwhatif/_pipeline_analyzer.py", line 93, in execute
    return singleton.run(notebook_path=self._notebook_path,
  File "/home/sgrafbe/mlwhatif/mlwhatif/execution/_pipeline_executor.py", line 149, in run
    self.run_what_if_analyses()
  File "/home/sgrafbe/mlwhatif/mlwhatif/execution/_pipeline_executor.py", line 181, in run_what_if_analyses
    DagExecutor(self).execute(what_if_dag)
  File "/home/sgrafbe/mlwhatif/mlwhatif/execution/_dag_executor.py", line 45, in execute
    self.traverse_graph_and_process_nodes(dag, execute_node)
  File "/home/sgrafbe/mlwhatif/mlwhatif/execution/_dag_executor.py", line 57, in traverse_graph_and_process_nodes
    result_node = func(node)
  File "/home/sgrafbe/mlwhatif/mlwhatif/execution/_dag_executor.py", line 40, in execute_node
    optimizer_info, result_df = capture_optimizer_info(executable_processing_func)
  File "/home/sgrafbe/mlwhatif/mlwhatif/execution/_stat_tracking.py", line 28, in capture_optimizer_info
    result = instrumented_function_call()
  File "/home/sgrafbe/mlwhatif/mlwhatif/monkeypatching/_patch_sklearn.py", line 1729, in processing_func
    transformed_data = wrap_in_mlinspect_array_if_necessary(transformed_data)
  File "/home/sgrafbe/mlwhatif/mlwhatif/monkeypatching/_monkey_patching_utils.py", line 229, in wrap_in_mlinspect_array_if_necessary
    df_object = MlinspectNdarray(df_object)
  File "/home/sgrafbe/mlwhatif/mlwhatif/monkeypatching/_mlinspect_ndarray.py", line 16, in __new__
    obj = numpy.asarray(input_array).view(cls)
  File "/home/sgrafbe/mlwhatif/venv/lib64/python3.9/site-packages/numpy/core/_asarray.py", line 83, in asarray
    return array(a, dtype, copy=False, order=order)
numpy.core._exceptions.MemoryError: Unable to allocate 3.72 GiB for an array with shape (35312,) and data type <U28286
taskset -c 160-167 PROTOCOL_BUFFERS_PYTHON_IMPLEMENTATION=python python3.9 benchmarks_end_to_end.py operator_impact reviews fast_loading featurization_3 xgboost
2022-09-21 20:53:24.173040: W tensorflow/stream_executor/platform/default/dso_loader.cc:64] Could not load dynamic library 'libcudart.so.11.0'; dlerror: libcudart.so.11.0: cannot open shared object file: No such file or directory; LD_LIBRARY_PATH: /home/sgrafbe/mlwhatif/venv/lib/python3.9/site-packages/cv2/../../lib64:
2022-09-21 20:53:24.173092: I tensorflow/stream_executor/cuda/cudart_stub.cc:29] Ignore above cudart dlerror if you do not have a GPU set up on your machine.
2022-09-21 20:53:25 INFO  Patching sys.argv with ['mlwhatif', 'reviews', 'fast_loading', 'featurization_3', 'xgboost']
2022-09-21 20:53:25 INFO  Running instrumented original pipeline...
2022-09-21 20:53:25 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-21 20:53:25 INFO  ---RUNTIME: Importing and monkey-patching took 122.47776985168457 ms
2022-09-21 20:54:20 INFO  ---RUNTIME: Original pipeline execution took 54484.52067375183 ms (excluding imports and monkey-patching)
2022-09-21 20:54:20 INFO  Starting execution of 0 what-if analyses...
2022-09-21 20:54:20 INFO  Estimated runtime of original DAG is 45782.74369239807ms
2022-09-21 20:54:20 INFO  Performing Multi-Query Optimization
2022-09-21 20:54:20 INFO  Estimated unoptimized what-if runtime is 0ms
2022-09-21 20:54:20 INFO  Estimated optimised what-if runtime is 0ms
2022-09-21 20:54:20 INFO  Estimated optimisation runtime saving is 0ms
2022-09-21 20:54:20 INFO  ---RUNTIME: Multi-Query Optimization took 0.5738735198974609 ms
2022-09-21 20:54:20 INFO  Executing generated plans
2022-09-21 20:54:20 INFO  ---RUNTIME: Execution took 0.025272369384765625 ms
2022-09-21 20:54:20 INFO  Done!
2022-09-21 20:54:20 INFO  # Optimization benchmark for operator_impact with args [['reviews', 'fast_loading', 'featurization_3', 'xgboost']] -- repetition 1 of 7
2022-09-21 20:54:20 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-21 20:54:20 INFO  Running instrumented original pipeline...
2022-09-21 20:54:20 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-21 20:54:20 INFO  ---RUNTIME: Importing and monkey-patching took 5.662679672241211 ms
2022-09-21 20:55:21 INFO  ---RUNTIME: Original pipeline execution took 61664.02792930603 ms (excluding imports and monkey-patching)
2022-09-21 20:55:21 INFO  Starting execution of 1 what-if analyses...
2022-09-21 20:55:21 INFO  Start plan generation for analysis OperatorImpact...
2022-09-21 20:55:21 INFO  ---RUNTIME: Plan generation took 6.713390350341797 ms
2022-09-21 20:55:21 INFO  Estimated runtime of original DAG is 47077.48365402222ms
2022-09-21 20:55:21 INFO  Performing Multi-Query Optimization
2022-09-21 20:55:21 INFO  Estimated unoptimized what-if runtime is 561423.2734191561ms
2022-09-21 20:55:21 INFO  Estimated optimised what-if runtime is 350976.98083034455ms
2022-09-21 20:55:21 INFO  Estimated optimisation runtime saving is 210446.29258881154ms
2022-09-21 20:55:21 INFO  ---RUNTIME: Multi-Query Optimization took 172.63412475585938 ms
2022-09-21 20:55:21 INFO  Executing generated plans
2022-09-21 21:01:29 INFO  ---RUNTIME: Execution took 367206.23874664307 ms
2022-09-21 21:01:29 INFO  Done!
2022-09-21 21:01:29 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-21 21:01:29 INFO  Running instrumented original pipeline...
2022-09-21 21:01:29 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-21 21:01:29 INFO  ---RUNTIME: Importing and monkey-patching took 6.241798400878906 ms
2022-09-21 21:02:50 INFO  ---RUNTIME: Original pipeline execution took 81103.82032394409 ms (excluding imports and monkey-patching)
2022-09-21 21:02:50 INFO  Starting execution of 1 what-if analyses...
2022-09-21 21:02:50 INFO  Start plan generation for analysis OperatorImpact...
2022-09-21 21:02:50 INFO  ---RUNTIME: Plan generation took 6.196260452270508 ms
2022-09-21 21:02:50 INFO  Estimated runtime of original DAG is 49797.67346382141ms
2022-09-21 21:02:50 WARNING Skipping Multi-Query Optimization (instead, only applying patches)
2022-09-21 21:02:50 INFO  Estimated unoptimised what-if runtime is 594004.841280835ms
2022-09-21 21:02:50 INFO  ---RUNTIME: Multi-Query Optimization took 23.08201789855957 ms
2022-09-21 21:02:50 INFO  Executing generated plans
Traceback (most recent call last):
  File "/home/sgrafbe/mlwhatif/experiments/end_to_end/benchmarks_end_to_end.py", line 238, in <module>
    analysis_result_no_opt = PipelineAnalyzer \
  File "/home/sgrafbe/mlwhatif/mlwhatif/_pipeline_analyzer.py", line 93, in execute
    return singleton.run(notebook_path=self._notebook_path,
  File "/home/sgrafbe/mlwhatif/mlwhatif/execution/_pipeline_executor.py", line 149, in run
    self.run_what_if_analyses()
  File "/home/sgrafbe/mlwhatif/mlwhatif/execution/_pipeline_executor.py", line 181, in run_what_if_analyses
    DagExecutor(self).execute(what_if_dag)
  File "/home/sgrafbe/mlwhatif/mlwhatif/execution/_dag_executor.py", line 45, in execute
    self.traverse_graph_and_process_nodes(dag, execute_node)
  File "/home/sgrafbe/mlwhatif/mlwhatif/execution/_dag_executor.py", line 57, in traverse_graph_and_process_nodes
    result_node = func(node)
  File "/home/sgrafbe/mlwhatif/mlwhatif/execution/_dag_executor.py", line 40, in execute_node
    optimizer_info, result_df = capture_optimizer_info(executable_processing_func)
  File "/home/sgrafbe/mlwhatif/mlwhatif/execution/_stat_tracking.py", line 28, in capture_optimizer_info
    result = instrumented_function_call()
  File "/home/sgrafbe/mlwhatif/mlwhatif/monkeypatching/_patch_sklearn.py", line 1729, in processing_func
    transformed_data = wrap_in_mlinspect_array_if_necessary(transformed_data)
  File "/home/sgrafbe/mlwhatif/mlwhatif/monkeypatching/_monkey_patching_utils.py", line 229, in wrap_in_mlinspect_array_if_necessary
    df_object = MlinspectNdarray(df_object)
  File "/home/sgrafbe/mlwhatif/mlwhatif/monkeypatching/_mlinspect_ndarray.py", line 16, in __new__
    obj = numpy.asarray(input_array).view(cls)
  File "/home/sgrafbe/mlwhatif/venv/lib64/python3.9/site-packages/numpy/core/_asarray.py", line 83, in asarray
    return array(a, dtype, copy=False, order=order)
numpy.core._exceptions.MemoryError: Unable to allocate 3.72 GiB for an array with shape (35312,) and data type <U28286
taskset -c 160-167 PROTOCOL_BUFFERS_PYTHON_IMPLEMENTATION=python python3.9 benchmarks_end_to_end.py operator_impact reviews fast_loading featurization_3 neural_network
2022-09-21 21:03:08.588727: W tensorflow/stream_executor/platform/default/dso_loader.cc:64] Could not load dynamic library 'libcudart.so.11.0'; dlerror: libcudart.so.11.0: cannot open shared object file: No such file or directory; LD_LIBRARY_PATH: /home/sgrafbe/mlwhatif/venv/lib/python3.9/site-packages/cv2/../../lib64:
2022-09-21 21:03:08.588771: I tensorflow/stream_executor/cuda/cudart_stub.cc:29] Ignore above cudart dlerror if you do not have a GPU set up on your machine.
2022-09-21 21:03:09 INFO  Patching sys.argv with ['mlwhatif', 'reviews', 'fast_loading', 'featurization_3', 'neural_network']
2022-09-21 21:03:09 INFO  Running instrumented original pipeline...
2022-09-21 21:03:09 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-21 21:03:10 INFO  ---RUNTIME: Importing and monkey-patching took 126.80792808532715 ms
2022-09-21 21:03:31.790508: W tensorflow/stream_executor/platform/default/dso_loader.cc:64] Could not load dynamic library 'libcuda.so.1'; dlerror: libcuda.so.1: cannot open shared object file: No such file or directory; LD_LIBRARY_PATH: /home/sgrafbe/mlwhatif/venv/lib/python3.9/site-packages/cv2/../../lib64:
2022-09-21 21:03:31.790549: W tensorflow/stream_executor/cuda/cuda_driver.cc:326] failed call to cuInit: UNKNOWN ERROR (303)
2022-09-21 21:03:31.790580: I tensorflow/stream_executor/cuda/cuda_diagnostics.cc:156] kernel driver does not appear to be running on this host (angus): /proc/driver/nvidia/version does not exist
2022-09-21 21:03:31.791065: I tensorflow/core/platform/cpu_feature_guard.cc:142] This TensorFlow binary is optimized with oneAPI Deep Neural Network Library (oneDNN) to use the following CPU instructions in performance-critical operations:  AVX2 FMA
To enable them in other operations, rebuild TensorFlow with the appropriate compiler flags.
2022-09-21 21:03:32.417119: I tensorflow/compiler/mlir/mlir_graph_optimization_pass.cc:176] None of the MLIR Optimization Passes are enabled (registered 2)
2022-09-21 21:03:32.431180: I tensorflow/core/platform/profile_utils/cpu_utils.cc:114] CPU Frequency: 2595130000 Hz
2022-09-21 21:03:58 INFO  ---RUNTIME: Original pipeline execution took 48972.66411781311 ms (excluding imports and monkey-patching)
2022-09-21 21:03:58 INFO  Starting execution of 0 what-if analyses...
2022-09-21 21:03:58 INFO  Estimated runtime of original DAG is 39789.38961029053ms
2022-09-21 21:03:58 INFO  Performing Multi-Query Optimization
2022-09-21 21:03:58 INFO  Estimated unoptimized what-if runtime is 0ms
2022-09-21 21:03:58 INFO  Estimated optimised what-if runtime is 0ms
2022-09-21 21:03:58 INFO  Estimated optimisation runtime saving is 0ms
2022-09-21 21:03:58 INFO  ---RUNTIME: Multi-Query Optimization took 0.5517005920410156 ms
2022-09-21 21:03:58 INFO  Executing generated plans
2022-09-21 21:03:58 INFO  ---RUNTIME: Execution took 0.015497207641601562 ms
2022-09-21 21:03:58 INFO  Done!
2022-09-21 21:03:58 INFO  # Optimization benchmark for operator_impact with args [['reviews', 'fast_loading', 'featurization_3', 'neural_network']] -- repetition 1 of 7
2022-09-21 21:03:58 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-21 21:03:58 INFO  Running instrumented original pipeline...
2022-09-21 21:03:59 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-21 21:03:59 INFO  ---RUNTIME: Importing and monkey-patching took 5.380868911743164 ms
2022-09-21 21:04:52 INFO  ---RUNTIME: Original pipeline execution took 53341.78280830383 ms (excluding imports and monkey-patching)
2022-09-21 21:04:52 INFO  Starting execution of 1 what-if analyses...
2022-09-21 21:04:52 INFO  Start plan generation for analysis OperatorImpact...
2022-09-21 21:04:52 INFO  ---RUNTIME: Plan generation took 7.426738739013672 ms
2022-09-21 21:04:52 INFO  Estimated runtime of original DAG is 40952.640533447266ms
2022-09-21 21:04:52 INFO  Performing Multi-Query Optimization
2022-09-21 21:04:52 INFO  Estimated unoptimized what-if runtime is 486939.0635475633ms
2022-09-21 21:04:52 INFO  Estimated optimised what-if runtime is 278046.1108590671ms
2022-09-21 21:04:52 INFO  Estimated optimisation runtime saving is 208892.95268849615ms
2022-09-21 21:04:52 INFO  ---RUNTIME: Multi-Query Optimization took 167.69957542419434 ms
2022-09-21 21:04:52 INFO  Executing generated plans
2022-09-21 21:09:50 INFO  ---RUNTIME: Execution took 297640.0034427643 ms
2022-09-21 21:09:50 INFO  Done!
2022-09-21 21:09:50 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-21 21:09:50 INFO  Running instrumented original pipeline...
2022-09-21 21:09:50 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-21 21:09:50 INFO  ---RUNTIME: Importing and monkey-patching took 6.484746932983398 ms
2022-09-21 21:10:50 INFO  ---RUNTIME: Original pipeline execution took 59933.14552307129 ms (excluding imports and monkey-patching)
2022-09-21 21:10:50 INFO  Starting execution of 1 what-if analyses...
2022-09-21 21:10:50 INFO  Start plan generation for analysis OperatorImpact...
2022-09-21 21:10:50 INFO  ---RUNTIME: Plan generation took 6.372928619384766 ms
2022-09-21 21:10:50 INFO  Estimated runtime of original DAG is 44979.94589805603ms
2022-09-21 21:10:50 WARNING Skipping Multi-Query Optimization (instead, only applying patches)
2022-09-21 21:10:50 INFO  Estimated unoptimised what-if runtime is 535233.4400446821ms
2022-09-21 21:10:50 INFO  ---RUNTIME: Multi-Query Optimization took 23.670196533203125 ms
2022-09-21 21:10:50 INFO  Executing generated plans
Traceback (most recent call last):
  File "/home/sgrafbe/mlwhatif/experiments/end_to_end/benchmarks_end_to_end.py", line 238, in <module>
    analysis_result_no_opt = PipelineAnalyzer \
  File "/home/sgrafbe/mlwhatif/mlwhatif/_pipeline_analyzer.py", line 93, in execute
    return singleton.run(notebook_path=self._notebook_path,
  File "/home/sgrafbe/mlwhatif/mlwhatif/execution/_pipeline_executor.py", line 149, in run
    self.run_what_if_analyses()
  File "/home/sgrafbe/mlwhatif/mlwhatif/execution/_pipeline_executor.py", line 181, in run_what_if_analyses
    DagExecutor(self).execute(what_if_dag)
  File "/home/sgrafbe/mlwhatif/mlwhatif/execution/_dag_executor.py", line 45, in execute
    self.traverse_graph_and_process_nodes(dag, execute_node)
  File "/home/sgrafbe/mlwhatif/mlwhatif/execution/_dag_executor.py", line 57, in traverse_graph_and_process_nodes
    result_node = func(node)
  File "/home/sgrafbe/mlwhatif/mlwhatif/execution/_dag_executor.py", line 40, in execute_node
    optimizer_info, result_df = capture_optimizer_info(executable_processing_func)
  File "/home/sgrafbe/mlwhatif/mlwhatif/execution/_stat_tracking.py", line 28, in capture_optimizer_info
    result = instrumented_function_call()
  File "/home/sgrafbe/mlwhatif/mlwhatif/monkeypatching/_patch_sklearn.py", line 1729, in processing_func
    transformed_data = wrap_in_mlinspect_array_if_necessary(transformed_data)
  File "/home/sgrafbe/mlwhatif/mlwhatif/monkeypatching/_monkey_patching_utils.py", line 229, in wrap_in_mlinspect_array_if_necessary
    df_object = MlinspectNdarray(df_object)
  File "/home/sgrafbe/mlwhatif/mlwhatif/monkeypatching/_mlinspect_ndarray.py", line 16, in __new__
    obj = numpy.asarray(input_array).view(cls)
  File "/home/sgrafbe/mlwhatif/venv/lib64/python3.9/site-packages/numpy/core/_asarray.py", line 83, in asarray
    return array(a, dtype, copy=False, order=order)
numpy.core._exceptions.MemoryError: Unable to allocate 3.72 GiB for an array with shape (35312,) and data type <U28286
taskset -c 160-167 PROTOCOL_BUFFERS_PYTHON_IMPLEMENTATION=python python3.9 benchmarks_end_to_end.py operator_impact reviews fast_loading featurization_4 logistic_regression
2022-09-21 21:11:42.525122: W tensorflow/stream_executor/platform/default/dso_loader.cc:64] Could not load dynamic library 'libcudart.so.11.0'; dlerror: libcudart.so.11.0: cannot open shared object file: No such file or directory; LD_LIBRARY_PATH: /home/sgrafbe/mlwhatif/venv/lib/python3.9/site-packages/cv2/../../lib64:
2022-09-21 21:11:42.525163: I tensorflow/stream_executor/cuda/cudart_stub.cc:29] Ignore above cudart dlerror if you do not have a GPU set up on your machine.
2022-09-21 21:11:43 INFO  Patching sys.argv with ['mlwhatif', 'reviews', 'fast_loading', 'featurization_4', 'logistic_regression']
2022-09-21 21:11:43 INFO  Running instrumented original pipeline...
2022-09-21 21:11:43 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-21 21:11:43 INFO  ---RUNTIME: Importing and monkey-patching took 124.68719482421875 ms
2022-09-21 21:11:57 INFO  ---RUNTIME: Original pipeline execution took 13053.933382034302 ms (excluding imports and monkey-patching)
2022-09-21 21:11:57 INFO  Starting execution of 0 what-if analyses...
2022-09-21 21:11:57 INFO  Estimated runtime of original DAG is 9711.889028549194ms
2022-09-21 21:11:57 INFO  Performing Multi-Query Optimization
2022-09-21 21:11:57 INFO  Estimated unoptimized what-if runtime is 0ms
2022-09-21 21:11:57 INFO  Estimated optimised what-if runtime is 0ms
2022-09-21 21:11:57 INFO  Estimated optimisation runtime saving is 0ms
2022-09-21 21:11:57 INFO  ---RUNTIME: Multi-Query Optimization took 0.6101131439208984 ms
2022-09-21 21:11:57 INFO  Executing generated plans
2022-09-21 21:11:57 INFO  ---RUNTIME: Execution took 0.03218650817871094 ms
2022-09-21 21:11:57 INFO  Done!
2022-09-21 21:11:57 INFO  # Optimization benchmark for operator_impact with args [['reviews', 'fast_loading', 'featurization_4', 'logistic_regression']] -- repetition 1 of 7
2022-09-21 21:11:57 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-21 21:11:57 INFO  Running instrumented original pipeline...
2022-09-21 21:11:57 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-21 21:11:57 INFO  ---RUNTIME: Importing and monkey-patching took 5.74040412902832 ms
2022-09-21 21:12:10 INFO  ---RUNTIME: Original pipeline execution took 13087.138175964355 ms (excluding imports and monkey-patching)
2022-09-21 21:12:10 INFO  Starting execution of 1 what-if analyses...
2022-09-21 21:12:10 INFO  Start plan generation for analysis OperatorImpact...
2022-09-21 21:12:10 INFO  ---RUNTIME: Plan generation took 6.187915802001953 ms
2022-09-21 21:12:10 INFO  Estimated runtime of original DAG is 9680.01127243042ms
2022-09-21 21:12:10 INFO  Performing Multi-Query Optimization
2022-09-21 21:12:10 INFO  Estimated unoptimized what-if runtime is 68889.32471954514ms
2022-09-21 21:12:10 INFO  Estimated optimised what-if runtime is 26444.747424641817ms
2022-09-21 21:12:10 INFO  Estimated optimisation runtime saving is 42444.57729490333ms
2022-09-21 21:12:10 INFO  ---RUNTIME: Multi-Query Optimization took 139.09173011779785 ms
2022-09-21 21:12:10 INFO  Executing generated plans
2022-09-21 21:12:39 INFO  ---RUNTIME: Execution took 29065.395832061768 ms
2022-09-21 21:12:39 INFO  Done!
2022-09-21 21:12:39 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-21 21:12:39 INFO  Running instrumented original pipeline...
2022-09-21 21:12:39 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-21 21:12:39 INFO  ---RUNTIME: Importing and monkey-patching took 6.136178970336914 ms
2022-09-21 21:12:52 INFO  ---RUNTIME: Original pipeline execution took 13135.673999786377 ms (excluding imports and monkey-patching)
2022-09-21 21:12:52 INFO  Starting execution of 1 what-if analyses...
2022-09-21 21:12:52 INFO  Start plan generation for analysis OperatorImpact...
2022-09-21 21:12:52 INFO  ---RUNTIME: Plan generation took 5.146980285644531 ms
2022-09-21 21:12:52 INFO  Estimated runtime of original DAG is 9888.519287109375ms
2022-09-21 21:12:52 WARNING Skipping Multi-Query Optimization (instead, only applying patches)
2022-09-21 21:12:52 INFO  Estimated unoptimised what-if runtime is 70295.13154404903ms
2022-09-21 21:12:52 INFO  ---RUNTIME: Multi-Query Optimization took 17.726659774780273 ms
2022-09-21 21:12:52 INFO  Executing generated plans
2022-09-21 21:14:08 INFO  ---RUNTIME: Execution took 75980.33237457275 ms
2022-09-21 21:14:08 INFO  Done!
2022-09-21 21:14:08 INFO  # Finished -- repetition 1 of 7 
2022-09-21 21:14:08 INFO  # Optimization benchmark for operator_impact with args [['reviews', 'fast_loading', 'featurization_4', 'logistic_regression']] -- repetition 2 of 7
2022-09-21 21:14:08 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-21 21:14:08 INFO  Running instrumented original pipeline...
2022-09-21 21:14:08 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-21 21:14:08 INFO  ---RUNTIME: Importing and monkey-patching took 5.836248397827148 ms
2022-09-21 21:14:21 INFO  ---RUNTIME: Original pipeline execution took 12690.313816070557 ms (excluding imports and monkey-patching)
2022-09-21 21:14:21 INFO  Starting execution of 1 what-if analyses...
2022-09-21 21:14:21 INFO  Start plan generation for analysis OperatorImpact...
2022-09-21 21:14:21 INFO  ---RUNTIME: Plan generation took 5.13148307800293 ms
2022-09-21 21:14:21 INFO  Estimated runtime of original DAG is 9435.845613479614ms
2022-09-21 21:14:21 INFO  Performing Multi-Query Optimization
2022-09-21 21:14:21 INFO  Estimated unoptimized what-if runtime is 67188.46842770041ms
2022-09-21 21:14:21 INFO  Estimated optimised what-if runtime is 26075.79367394596ms
2022-09-21 21:14:21 INFO  Estimated optimisation runtime saving is 41112.67475375446ms
2022-09-21 21:14:21 INFO  ---RUNTIME: Multi-Query Optimization took 332.34238624572754 ms
2022-09-21 21:14:21 INFO  Executing generated plans
2022-09-21 21:14:50 INFO  ---RUNTIME: Execution took 28962.35990524292 ms
2022-09-21 21:14:50 INFO  Done!
2022-09-21 21:14:50 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-21 21:14:50 INFO  Running instrumented original pipeline...
2022-09-21 21:14:50 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-21 21:14:50 INFO  ---RUNTIME: Importing and monkey-patching took 6.32023811340332 ms
2022-09-21 21:15:03 INFO  ---RUNTIME: Original pipeline execution took 13092.885255813599 ms (excluding imports and monkey-patching)
2022-09-21 21:15:03 INFO  Starting execution of 1 what-if analyses...
2022-09-21 21:15:03 INFO  Start plan generation for analysis OperatorImpact...
2022-09-21 21:15:03 INFO  ---RUNTIME: Plan generation took 5.099773406982422 ms
2022-09-21 21:15:03 INFO  Estimated runtime of original DAG is 9805.27949333191ms
2022-09-21 21:15:03 WARNING Skipping Multi-Query Optimization (instead, only applying patches)
2022-09-21 21:15:03 INFO  Estimated unoptimised what-if runtime is 69688.63139520833ms
2022-09-21 21:15:03 INFO  ---RUNTIME: Multi-Query Optimization took 18.169879913330078 ms
2022-09-21 21:15:03 INFO  Executing generated plans
2022-09-21 21:16:19 INFO  ---RUNTIME: Execution took 76057.47199058533 ms
2022-09-21 21:16:19 INFO  Done!
2022-09-21 21:16:19 INFO  # Finished -- repetition 2 of 7 
2022-09-21 21:16:19 INFO  # Optimization benchmark for operator_impact with args [['reviews', 'fast_loading', 'featurization_4', 'logistic_regression']] -- repetition 3 of 7
2022-09-21 21:16:19 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-21 21:16:19 INFO  Running instrumented original pipeline...
2022-09-21 21:16:19 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-21 21:16:19 INFO  ---RUNTIME: Importing and monkey-patching took 6.421089172363281 ms
2022-09-21 21:16:32 INFO  ---RUNTIME: Original pipeline execution took 13123.682498931885 ms (excluding imports and monkey-patching)
2022-09-21 21:16:32 INFO  Starting execution of 1 what-if analyses...
2022-09-21 21:16:32 INFO  Start plan generation for analysis OperatorImpact...
2022-09-21 21:16:32 INFO  ---RUNTIME: Plan generation took 5.002498626708984 ms
2022-09-21 21:16:32 INFO  Estimated runtime of original DAG is 9847.548007965088ms
2022-09-21 21:16:32 INFO  Performing Multi-Query Optimization
2022-09-21 21:16:32 INFO  Estimated unoptimized what-if runtime is 70125.45801595045ms
2022-09-21 21:16:32 INFO  Estimated optimised what-if runtime is 27236.693535224258ms
2022-09-21 21:16:32 INFO  Estimated optimisation runtime saving is 42888.7644807262ms
2022-09-21 21:16:32 INFO  ---RUNTIME: Multi-Query Optimization took 131.95157051086426 ms
2022-09-21 21:16:32 INFO  Executing generated plans
2022-09-21 21:17:02 INFO  ---RUNTIME: Execution took 29816.0617351532 ms
2022-09-21 21:17:02 INFO  Done!
2022-09-21 21:17:02 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-21 21:17:02 INFO  Running instrumented original pipeline...
2022-09-21 21:17:02 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-21 21:17:02 INFO  ---RUNTIME: Importing and monkey-patching took 6.186246871948242 ms
2022-09-21 21:17:15 INFO  ---RUNTIME: Original pipeline execution took 13013.115644454956 ms (excluding imports and monkey-patching)
2022-09-21 21:17:15 INFO  Starting execution of 1 what-if analyses...
2022-09-21 21:17:15 INFO  Start plan generation for analysis OperatorImpact...
2022-09-21 21:17:15 INFO  ---RUNTIME: Plan generation took 4.989385604858398 ms
2022-09-21 21:17:15 INFO  Estimated runtime of original DAG is 9487.489461898804ms
2022-09-21 21:17:15 WARNING Skipping Multi-Query Optimization (instead, only applying patches)
2022-09-21 21:17:15 INFO  Estimated unoptimised what-if runtime is 67451.78092712608ms
2022-09-21 21:17:15 INFO  ---RUNTIME: Multi-Query Optimization took 17.867326736450195 ms
2022-09-21 21:17:15 INFO  Executing generated plans
2022-09-21 21:18:32 INFO  ---RUNTIME: Execution took 76490.30470848083 ms
2022-09-21 21:18:32 INFO  Done!
2022-09-21 21:18:32 INFO  # Finished -- repetition 3 of 7 
2022-09-21 21:18:32 INFO  # Optimization benchmark for operator_impact with args [['reviews', 'fast_loading', 'featurization_4', 'logistic_regression']] -- repetition 4 of 7
2022-09-21 21:18:32 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-21 21:18:32 INFO  Running instrumented original pipeline...
2022-09-21 21:18:32 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-21 21:18:32 INFO  ---RUNTIME: Importing and monkey-patching took 5.995035171508789 ms
2022-09-21 21:18:45 INFO  ---RUNTIME: Original pipeline execution took 13292.201042175293 ms (excluding imports and monkey-patching)
2022-09-21 21:18:45 INFO  Starting execution of 1 what-if analyses...
2022-09-21 21:18:45 INFO  Start plan generation for analysis OperatorImpact...
2022-09-21 21:18:45 INFO  ---RUNTIME: Plan generation took 5.060911178588867 ms
2022-09-21 21:18:45 INFO  Estimated runtime of original DAG is 9688.28535079956ms
2022-09-21 21:18:45 INFO  Performing Multi-Query Optimization
2022-09-21 21:18:45 INFO  Estimated unoptimized what-if runtime is 69003.33250080384ms
2022-09-21 21:18:45 INFO  Estimated optimised what-if runtime is 26799.142306061014ms
2022-09-21 21:18:45 INFO  Estimated optimisation runtime saving is 42204.19019474283ms
2022-09-21 21:18:45 INFO  ---RUNTIME: Multi-Query Optimization took 132.9183578491211 ms
2022-09-21 21:18:45 INFO  Executing generated plans
2022-09-21 21:19:15 INFO  ---RUNTIME: Execution took 29454.30064201355 ms
2022-09-21 21:19:15 INFO  Done!
2022-09-21 21:19:15 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-21 21:19:15 INFO  Running instrumented original pipeline...
2022-09-21 21:19:15 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-21 21:19:15 INFO  ---RUNTIME: Importing and monkey-patching took 16.0677433013916 ms
2022-09-21 21:19:28 INFO  ---RUNTIME: Original pipeline execution took 13284.501314163208 ms (excluding imports and monkey-patching)
2022-09-21 21:19:28 INFO  Starting execution of 1 what-if analyses...
2022-09-21 21:19:28 INFO  Start plan generation for analysis OperatorImpact...
2022-09-21 21:19:28 INFO  ---RUNTIME: Plan generation took 5.194187164306641 ms
2022-09-21 21:19:28 INFO  Estimated runtime of original DAG is 9729.588747024536ms
2022-09-21 21:19:28 WARNING Skipping Multi-Query Optimization (instead, only applying patches)
2022-09-21 21:19:28 INFO  Estimated unoptimised what-if runtime is 69139.25664219186ms
2022-09-21 21:19:28 INFO  ---RUNTIME: Multi-Query Optimization took 18.43714714050293 ms
2022-09-21 21:19:28 INFO  Executing generated plans
2022-09-21 21:20:46 INFO  ---RUNTIME: Execution took 77782.97877311707 ms
2022-09-21 21:20:46 INFO  Done!
2022-09-21 21:20:46 INFO  # Finished -- repetition 4 of 7 
2022-09-21 21:20:46 INFO  # Optimization benchmark for operator_impact with args [['reviews', 'fast_loading', 'featurization_4', 'logistic_regression']] -- repetition 5 of 7
2022-09-21 21:20:46 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-21 21:20:46 INFO  Running instrumented original pipeline...
2022-09-21 21:20:46 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-21 21:20:46 INFO  ---RUNTIME: Importing and monkey-patching took 6.183624267578125 ms
2022-09-21 21:20:59 INFO  ---RUNTIME: Original pipeline execution took 13353.707075119019 ms (excluding imports and monkey-patching)
2022-09-21 21:20:59 INFO  Starting execution of 1 what-if analyses...
2022-09-21 21:20:59 INFO  Start plan generation for analysis OperatorImpact...
2022-09-21 21:20:59 INFO  ---RUNTIME: Plan generation took 5.020618438720703 ms
2022-09-21 21:20:59 INFO  Estimated runtime of original DAG is 9751.613140106201ms
2022-09-21 21:20:59 INFO  Performing Multi-Query Optimization
2022-09-21 21:20:59 INFO  Estimated unoptimized what-if runtime is 69447.60286834752ms
2022-09-21 21:20:59 INFO  Estimated optimised what-if runtime is 26812.45318405736ms
2022-09-21 21:20:59 INFO  Estimated optimisation runtime saving is 42635.149684290154ms
2022-09-21 21:20:59 INFO  ---RUNTIME: Multi-Query Optimization took 132.0023536682129 ms
2022-09-21 21:20:59 INFO  Executing generated plans
2022-09-21 21:21:29 INFO  ---RUNTIME: Execution took 29674.331665039062 ms
2022-09-21 21:21:29 INFO  Done!
2022-09-21 21:21:29 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-21 21:21:29 INFO  Running instrumented original pipeline...
2022-09-21 21:21:29 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-21 21:21:29 INFO  ---RUNTIME: Importing and monkey-patching took 5.758523941040039 ms
2022-09-21 21:21:42 INFO  ---RUNTIME: Original pipeline execution took 13350.309610366821 ms (excluding imports and monkey-patching)
2022-09-21 21:21:42 INFO  Starting execution of 1 what-if analyses...
2022-09-21 21:21:42 INFO  Start plan generation for analysis OperatorImpact...
2022-09-21 21:21:42 INFO  ---RUNTIME: Plan generation took 5.076408386230469 ms
2022-09-21 21:21:42 INFO  Estimated runtime of original DAG is 9695.474863052368ms
2022-09-21 21:21:42 WARNING Skipping Multi-Query Optimization (instead, only applying patches)
2022-09-21 21:21:42 INFO  Estimated unoptimised what-if runtime is 68908.5233470467ms
2022-09-21 21:21:42 INFO  ---RUNTIME: Multi-Query Optimization took 18.31817626953125 ms
2022-09-21 21:21:42 INFO  Executing generated plans
2022-09-21 21:23:00 INFO  ---RUNTIME: Execution took 77208.58764648438 ms
2022-09-21 21:23:00 INFO  Done!
2022-09-21 21:23:00 INFO  # Finished -- repetition 5 of 7 
2022-09-21 21:23:00 INFO  # Optimization benchmark for operator_impact with args [['reviews', 'fast_loading', 'featurization_4', 'logistic_regression']] -- repetition 6 of 7
2022-09-21 21:23:00 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-21 21:23:00 INFO  Running instrumented original pipeline...
2022-09-21 21:23:00 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-21 21:23:00 INFO  ---RUNTIME: Importing and monkey-patching took 5.890846252441406 ms
2022-09-21 21:23:13 INFO  ---RUNTIME: Original pipeline execution took 13377.77829170227 ms (excluding imports and monkey-patching)
2022-09-21 21:23:13 INFO  Starting execution of 1 what-if analyses...
2022-09-21 21:23:13 INFO  Start plan generation for analysis OperatorImpact...
2022-09-21 21:23:13 INFO  ---RUNTIME: Plan generation took 4.995822906494141 ms
2022-09-21 21:23:13 INFO  Estimated runtime of original DAG is 9785.888671875ms
2022-09-21 21:23:13 INFO  Performing Multi-Query Optimization
2022-09-21 21:23:13 INFO  Estimated unoptimized what-if runtime is 69692.18950834381ms
2022-09-21 21:23:13 INFO  Estimated optimised what-if runtime is 27058.945734357174ms
2022-09-21 21:23:13 INFO  Estimated optimisation runtime saving is 42633.243773986644ms
2022-09-21 21:23:13 INFO  ---RUNTIME: Multi-Query Optimization took 130.2356719970703 ms
2022-09-21 21:23:13 INFO  Executing generated plans
2022-09-21 21:23:43 INFO  ---RUNTIME: Execution took 29495.10407447815 ms
2022-09-21 21:23:43 INFO  Done!
2022-09-21 21:23:43 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-21 21:23:43 INFO  Running instrumented original pipeline...
2022-09-21 21:23:43 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-21 21:23:43 INFO  ---RUNTIME: Importing and monkey-patching took 5.735635757446289 ms
2022-09-21 21:23:56 INFO  ---RUNTIME: Original pipeline execution took 12952.878475189209 ms (excluding imports and monkey-patching)
2022-09-21 21:23:56 INFO  Starting execution of 1 what-if analyses...
2022-09-21 21:23:56 INFO  Start plan generation for analysis OperatorImpact...
2022-09-21 21:23:56 INFO  ---RUNTIME: Plan generation took 5.135059356689453 ms
2022-09-21 21:23:56 INFO  Estimated runtime of original DAG is 9640.675783157349ms
2022-09-21 21:23:56 WARNING Skipping Multi-Query Optimization (instead, only applying patches)
2022-09-21 21:23:56 INFO  Estimated unoptimised what-if runtime is 68493.5419792268ms
2022-09-21 21:23:56 INFO  ---RUNTIME: Multi-Query Optimization took 18.012046813964844 ms
2022-09-21 21:23:56 INFO  Executing generated plans
2022-09-21 21:25:13 INFO  ---RUNTIME: Execution took 77097.47982025146 ms
2022-09-21 21:25:13 INFO  Done!
2022-09-21 21:25:13 INFO  # Finished -- repetition 6 of 7 
2022-09-21 21:25:13 INFO  # Optimization benchmark for operator_impact with args [['reviews', 'fast_loading', 'featurization_4', 'logistic_regression']] -- repetition 7 of 7
2022-09-21 21:25:13 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-21 21:25:13 INFO  Running instrumented original pipeline...
2022-09-21 21:25:13 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-21 21:25:13 INFO  ---RUNTIME: Importing and monkey-patching took 5.811929702758789 ms
2022-09-21 21:25:26 INFO  ---RUNTIME: Original pipeline execution took 12944.373846054077 ms (excluding imports and monkey-patching)
2022-09-21 21:25:26 INFO  Starting execution of 1 what-if analyses...
2022-09-21 21:25:26 INFO  Start plan generation for analysis OperatorImpact...
2022-09-21 21:25:26 INFO  ---RUNTIME: Plan generation took 5.386114120483398 ms
2022-09-21 21:25:26 INFO  Estimated runtime of original DAG is 9614.40110206604ms
2022-09-21 21:25:26 INFO  Performing Multi-Query Optimization
2022-09-21 21:25:26 INFO  Estimated unoptimized what-if runtime is 68462.46130934701ms
2022-09-21 21:25:26 INFO  Estimated optimised what-if runtime is 26304.2649556267ms
2022-09-21 21:25:26 INFO  Estimated optimisation runtime saving is 42158.19635372031ms
2022-09-21 21:25:26 INFO  ---RUNTIME: Multi-Query Optimization took 140.55347442626953 ms
2022-09-21 21:25:26 INFO  Executing generated plans
2022-09-21 21:25:56 INFO  ---RUNTIME: Execution took 29710.281372070312 ms
2022-09-21 21:25:56 INFO  Done!
2022-09-21 21:25:56 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-21 21:25:56 INFO  Running instrumented original pipeline...
2022-09-21 21:25:56 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-21 21:25:56 INFO  ---RUNTIME: Importing and monkey-patching took 6.65736198425293 ms
2022-09-21 21:26:09 INFO  ---RUNTIME: Original pipeline execution took 13163.404941558838 ms (excluding imports and monkey-patching)
2022-09-21 21:26:09 INFO  Starting execution of 1 what-if analyses...
2022-09-21 21:26:09 INFO  Start plan generation for analysis OperatorImpact...
2022-09-21 21:26:09 INFO  ---RUNTIME: Plan generation took 5.18798828125 ms
2022-09-21 21:26:09 INFO  Estimated runtime of original DAG is 9864.440202713013ms
2022-09-21 21:26:09 WARNING Skipping Multi-Query Optimization (instead, only applying patches)
2022-09-21 21:26:09 INFO  Estimated unoptimised what-if runtime is 70097.71559219588ms
2022-09-21 21:26:09 INFO  ---RUNTIME: Multi-Query Optimization took 17.903566360473633 ms
2022-09-21 21:26:09 INFO  Executing generated plans
2022-09-21 21:27:26 INFO  ---RUNTIME: Execution took 77648.64110946655 ms
2022-09-21 21:27:26 INFO  Done!
2022-09-21 21:27:26 INFO  # Finished -- repetition 7 of 7 
2022-09-21 21:27:26 INFO  # Final results after all repetitions
2022-09-21 21:27:26 INFO     repetition  ... no_opt_what_if_execution_combined_model_training
0           0  ...                                      1856.417656
1           1  ...                                      1897.543192
2           2  ...                                      1921.120405
3           3  ...                                      2017.686129
4           4  ...                                      1983.999014
5           5  ...                                      1960.755825
6           6  ...                                      1962.027311

[7 rows x 26 columns]
taskset -c 160-167 PROTOCOL_BUFFERS_PYTHON_IMPLEMENTATION=python python3.9 benchmarks_end_to_end.py operator_impact reviews fast_loading featurization_4 xgboost
2022-09-21 21:27:29.396993: W tensorflow/stream_executor/platform/default/dso_loader.cc:64] Could not load dynamic library 'libcudart.so.11.0'; dlerror: libcudart.so.11.0: cannot open shared object file: No such file or directory; LD_LIBRARY_PATH: /home/sgrafbe/mlwhatif/venv/lib/python3.9/site-packages/cv2/../../lib64:
2022-09-21 21:27:29.397041: I tensorflow/stream_executor/cuda/cudart_stub.cc:29] Ignore above cudart dlerror if you do not have a GPU set up on your machine.
2022-09-21 21:27:30 INFO  Patching sys.argv with ['mlwhatif', 'reviews', 'fast_loading', 'featurization_4', 'xgboost']
2022-09-21 21:27:30 INFO  Running instrumented original pipeline...
2022-09-21 21:27:30 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-21 21:27:31 INFO  ---RUNTIME: Importing and monkey-patching took 128.02362442016602 ms
2022-09-21 21:27:49 INFO  ---RUNTIME: Original pipeline execution took 17950.207471847534 ms (excluding imports and monkey-patching)
2022-09-21 21:27:49 INFO  Starting execution of 0 what-if analyses...
2022-09-21 21:27:49 INFO  Estimated runtime of original DAG is 14426.99146270752ms
2022-09-21 21:27:49 INFO  Performing Multi-Query Optimization
2022-09-21 21:27:49 INFO  Estimated unoptimized what-if runtime is 0ms
2022-09-21 21:27:49 INFO  Estimated optimised what-if runtime is 0ms
2022-09-21 21:27:49 INFO  Estimated optimisation runtime saving is 0ms
2022-09-21 21:27:49 INFO  ---RUNTIME: Multi-Query Optimization took 0.6082057952880859 ms
2022-09-21 21:27:49 INFO  Executing generated plans
2022-09-21 21:27:49 INFO  ---RUNTIME: Execution took 0.02956390380859375 ms
2022-09-21 21:27:49 INFO  Done!
2022-09-21 21:27:49 INFO  # Optimization benchmark for operator_impact with args [['reviews', 'fast_loading', 'featurization_4', 'xgboost']] -- repetition 1 of 7
2022-09-21 21:27:49 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-21 21:27:49 INFO  Running instrumented original pipeline...
2022-09-21 21:27:49 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-21 21:27:49 INFO  ---RUNTIME: Importing and monkey-patching took 5.5484771728515625 ms
2022-09-21 21:28:06 INFO  ---RUNTIME: Original pipeline execution took 17097.368001937866 ms (excluding imports and monkey-patching)
2022-09-21 21:28:06 INFO  Starting execution of 1 what-if analyses...
2022-09-21 21:28:06 INFO  Start plan generation for analysis OperatorImpact...
2022-09-21 21:28:06 INFO  ---RUNTIME: Plan generation took 6.058692932128906 ms
2022-09-21 21:28:06 INFO  Estimated runtime of original DAG is 13389.51849937439ms
2022-09-21 21:28:06 INFO  Performing Multi-Query Optimization
2022-09-21 21:28:06 INFO  Estimated unoptimized what-if runtime is 95451.11592378926ms
2022-09-21 21:28:06 INFO  Estimated optimised what-if runtime is 52646.37002315163ms
2022-09-21 21:28:06 INFO  Estimated optimisation runtime saving is 42804.74590063763ms
2022-09-21 21:28:06 INFO  ---RUNTIME: Multi-Query Optimization took 141.97778701782227 ms
2022-09-21 21:28:06 INFO  Executing generated plans
2022-09-21 21:29:05 INFO  ---RUNTIME: Execution took 59678.903341293335 ms
2022-09-21 21:29:05 INFO  Done!
2022-09-21 21:29:05 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-21 21:29:05 INFO  Running instrumented original pipeline...
2022-09-21 21:29:06 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-21 21:29:06 INFO  ---RUNTIME: Importing and monkey-patching took 7.252931594848633 ms
2022-09-21 21:29:22 INFO  ---RUNTIME: Original pipeline execution took 16535.038709640503 ms (excluding imports and monkey-patching)
2022-09-21 21:29:22 INFO  Starting execution of 1 what-if analyses...
2022-09-21 21:29:22 INFO  Start plan generation for analysis OperatorImpact...
2022-09-21 21:29:22 INFO  ---RUNTIME: Plan generation took 5.064964294433594 ms
2022-09-21 21:29:22 INFO  Estimated runtime of original DAG is 13267.84372329712ms
2022-09-21 21:29:22 WARNING Skipping Multi-Query Optimization (instead, only applying patches)
2022-09-21 21:29:22 INFO  Estimated unoptimised what-if runtime is 94421.88213995847ms
2022-09-21 21:29:22 INFO  ---RUNTIME: Multi-Query Optimization took 17.54903793334961 ms
2022-09-21 21:29:22 INFO  Executing generated plans
2022-09-21 21:31:07 INFO  ---RUNTIME: Execution took 105110.44001579285 ms
2022-09-21 21:31:07 INFO  Done!
2022-09-21 21:31:07 INFO  # Finished -- repetition 1 of 7 
2022-09-21 21:31:07 INFO  # Optimization benchmark for operator_impact with args [['reviews', 'fast_loading', 'featurization_4', 'xgboost']] -- repetition 2 of 7
2022-09-21 21:31:07 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-21 21:31:07 INFO  Running instrumented original pipeline...
2022-09-21 21:31:07 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-21 21:31:07 INFO  ---RUNTIME: Importing and monkey-patching took 5.903482437133789 ms
2022-09-21 21:31:23 INFO  ---RUNTIME: Original pipeline execution took 16215.559005737305 ms (excluding imports and monkey-patching)
2022-09-21 21:31:23 INFO  Starting execution of 1 what-if analyses...
2022-09-21 21:31:23 INFO  Start plan generation for analysis OperatorImpact...
2022-09-21 21:31:23 INFO  ---RUNTIME: Plan generation took 5.137920379638672 ms
2022-09-21 21:31:23 INFO  Estimated runtime of original DAG is 12932.989835739136ms
2022-09-21 21:31:23 INFO  Performing Multi-Query Optimization
2022-09-21 21:31:24 INFO  Estimated unoptimized what-if runtime is 92199.4802213057ms
2022-09-21 21:31:24 INFO  Estimated optimised what-if runtime is 51310.57272075999ms
2022-09-21 21:31:24 INFO  Estimated optimisation runtime saving is 40888.907500545705ms
2022-09-21 21:31:24 INFO  ---RUNTIME: Multi-Query Optimization took 314.3603801727295 ms
2022-09-21 21:31:24 INFO  Executing generated plans
2022-09-21 21:32:23 INFO  ---RUNTIME: Execution took 59797.42455482483 ms
2022-09-21 21:32:23 INFO  Done!
2022-09-21 21:32:24 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-21 21:32:24 INFO  Running instrumented original pipeline...
2022-09-21 21:32:24 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-21 21:32:24 INFO  ---RUNTIME: Importing and monkey-patching took 6.338357925415039 ms
2022-09-21 21:32:41 INFO  ---RUNTIME: Original pipeline execution took 17949.24783706665 ms (excluding imports and monkey-patching)
2022-09-21 21:32:41 INFO  Starting execution of 1 what-if analyses...
2022-09-21 21:32:41 INFO  Start plan generation for analysis OperatorImpact...
2022-09-21 21:32:41 INFO  ---RUNTIME: Plan generation took 5.453824996948242 ms
2022-09-21 21:32:41 INFO  Estimated runtime of original DAG is 14539.002180099487ms
2022-09-21 21:32:41 WARNING Skipping Multi-Query Optimization (instead, only applying patches)
2022-09-21 21:32:41 INFO  Estimated unoptimised what-if runtime is 103521.13492677087ms
2022-09-21 21:32:41 INFO  ---RUNTIME: Multi-Query Optimization took 18.134117126464844 ms
2022-09-21 21:32:41 INFO  Executing generated plans
2022-09-21 21:34:28 INFO  ---RUNTIME: Execution took 106618.05582046509 ms
2022-09-21 21:34:28 INFO  Done!
2022-09-21 21:34:28 INFO  # Finished -- repetition 2 of 7 
2022-09-21 21:34:28 INFO  # Optimization benchmark for operator_impact with args [['reviews', 'fast_loading', 'featurization_4', 'xgboost']] -- repetition 3 of 7
2022-09-21 21:34:28 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-21 21:34:28 INFO  Running instrumented original pipeline...
2022-09-21 21:34:28 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-21 21:34:28 INFO  ---RUNTIME: Importing and monkey-patching took 6.075382232666016 ms
2022-09-21 21:34:46 INFO  ---RUNTIME: Original pipeline execution took 17924.744367599487 ms (excluding imports and monkey-patching)
2022-09-21 21:34:46 INFO  Starting execution of 1 what-if analyses...
2022-09-21 21:34:46 INFO  Start plan generation for analysis OperatorImpact...
2022-09-21 21:34:46 INFO  ---RUNTIME: Plan generation took 5.048036575317383 ms
2022-09-21 21:34:46 INFO  Estimated runtime of original DAG is 14395.350217819214ms
2022-09-21 21:34:46 INFO  Performing Multi-Query Optimization
2022-09-21 21:34:46 INFO  Estimated unoptimized what-if runtime is 102584.9655541387ms
2022-09-21 21:34:46 INFO  Estimated optimised what-if runtime is 59519.56487318022ms
2022-09-21 21:34:46 INFO  Estimated optimisation runtime saving is 43065.40068095848ms
2022-09-21 21:34:46 INFO  ---RUNTIME: Multi-Query Optimization took 130.54156303405762 ms
2022-09-21 21:34:46 INFO  Executing generated plans
2022-09-21 21:35:46 INFO  ---RUNTIME: Execution took 59459.52558517456 ms
2022-09-21 21:35:46 INFO  Done!
2022-09-21 21:35:46 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-21 21:35:46 INFO  Running instrumented original pipeline...
2022-09-21 21:35:46 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-21 21:35:46 INFO  ---RUNTIME: Importing and monkey-patching took 6.201744079589844 ms
2022-09-21 21:36:03 INFO  ---RUNTIME: Original pipeline execution took 17421.77152633667 ms (excluding imports and monkey-patching)
2022-09-21 21:36:03 INFO  Starting execution of 1 what-if analyses...
2022-09-21 21:36:03 INFO  Start plan generation for analysis OperatorImpact...
2022-09-21 21:36:03 INFO  ---RUNTIME: Plan generation took 5.114555358886719 ms
2022-09-21 21:36:03 INFO  Estimated runtime of original DAG is 13826.653242111206ms
2022-09-21 21:36:03 WARNING Skipping Multi-Query Optimization (instead, only applying patches)
2022-09-21 21:36:03 INFO  Estimated unoptimised what-if runtime is 98437.1765533162ms
2022-09-21 21:36:03 INFO  ---RUNTIME: Multi-Query Optimization took 17.856121063232422 ms
2022-09-21 21:36:03 INFO  Executing generated plans
2022-09-21 21:37:52 INFO  ---RUNTIME: Execution took 109250.69785118103 ms
2022-09-21 21:37:52 INFO  Done!
2022-09-21 21:37:52 INFO  # Finished -- repetition 3 of 7 
2022-09-21 21:37:52 INFO  # Optimization benchmark for operator_impact with args [['reviews', 'fast_loading', 'featurization_4', 'xgboost']] -- repetition 4 of 7
2022-09-21 21:37:52 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-21 21:37:52 INFO  Running instrumented original pipeline...
2022-09-21 21:37:52 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-21 21:37:52 INFO  ---RUNTIME: Importing and monkey-patching took 8.854866027832031 ms
2022-09-21 21:38:09 INFO  ---RUNTIME: Original pipeline execution took 16675.987243652344 ms (excluding imports and monkey-patching)
2022-09-21 21:38:09 INFO  Starting execution of 1 what-if analyses...
2022-09-21 21:38:09 INFO  Start plan generation for analysis OperatorImpact...
2022-09-21 21:38:09 INFO  ---RUNTIME: Plan generation took 5.110502243041992 ms
2022-09-21 21:38:09 INFO  Estimated runtime of original DAG is 13085.199117660522ms
2022-09-21 21:38:09 INFO  Performing Multi-Query Optimization
2022-09-21 21:38:09 INFO  Estimated unoptimized what-if runtime is 93292.64894681153ms
2022-09-21 21:38:09 INFO  Estimated optimised what-if runtime is 52009.47402911334ms
2022-09-21 21:38:09 INFO  Estimated optimisation runtime saving is 41283.17491769819ms
2022-09-21 21:38:09 INFO  ---RUNTIME: Multi-Query Optimization took 129.66227531433105 ms
2022-09-21 21:38:09 INFO  Executing generated plans
2022-09-21 21:39:04 INFO  ---RUNTIME: Execution took 55100.459575653076 ms
2022-09-21 21:39:04 INFO  Done!
2022-09-21 21:39:04 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-21 21:39:04 INFO  Running instrumented original pipeline...
2022-09-21 21:39:04 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-21 21:39:04 INFO  ---RUNTIME: Importing and monkey-patching took 6.176948547363281 ms
2022-09-21 21:39:21 INFO  ---RUNTIME: Original pipeline execution took 16749.163150787354 ms (excluding imports and monkey-patching)
2022-09-21 21:39:21 INFO  Starting execution of 1 what-if analyses...
2022-09-21 21:39:21 INFO  Start plan generation for analysis OperatorImpact...
2022-09-21 21:39:21 INFO  ---RUNTIME: Plan generation took 5.1441192626953125 ms
2022-09-21 21:39:21 INFO  Estimated runtime of original DAG is 13177.34146118164ms
2022-09-21 21:39:21 WARNING Skipping Multi-Query Optimization (instead, only applying patches)
2022-09-21 21:39:21 INFO  Estimated unoptimised what-if runtime is 93794.79159328016ms
2022-09-21 21:39:21 INFO  ---RUNTIME: Multi-Query Optimization took 18.223047256469727 ms
2022-09-21 21:39:21 INFO  Executing generated plans
2022-09-21 21:41:03 INFO  ---RUNTIME: Execution took 102124.06754493713 ms
2022-09-21 21:41:03 INFO  Done!
2022-09-21 21:41:03 INFO  # Finished -- repetition 4 of 7 
2022-09-21 21:41:03 INFO  # Optimization benchmark for operator_impact with args [['reviews', 'fast_loading', 'featurization_4', 'xgboost']] -- repetition 5 of 7
2022-09-21 21:41:03 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-21 21:41:03 INFO  Running instrumented original pipeline...
2022-09-21 21:41:03 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-21 21:41:03 INFO  ---RUNTIME: Importing and monkey-patching took 6.395578384399414 ms
2022-09-21 21:41:20 INFO  ---RUNTIME: Original pipeline execution took 16868.062019348145 ms (excluding imports and monkey-patching)
2022-09-21 21:41:20 INFO  Starting execution of 1 what-if analyses...
2022-09-21 21:41:20 INFO  Start plan generation for analysis OperatorImpact...
2022-09-21 21:41:20 INFO  ---RUNTIME: Plan generation took 5.143404006958008 ms
2022-09-21 21:41:20 INFO  Estimated runtime of original DAG is 13243.117570877075ms
2022-09-21 21:41:20 INFO  Performing Multi-Query Optimization
2022-09-21 21:41:20 INFO  Estimated unoptimized what-if runtime is 94396.74848059329ms
2022-09-21 21:41:20 INFO  Estimated optimised what-if runtime is 52637.547493225706ms
2022-09-21 21:41:20 INFO  Estimated optimisation runtime saving is 41759.200987367585ms
2022-09-21 21:41:20 INFO  ---RUNTIME: Multi-Query Optimization took 130.8269500732422 ms
2022-09-21 21:41:20 INFO  Executing generated plans
2022-09-21 21:42:13 INFO  ---RUNTIME: Execution took 52933.78043174744 ms
2022-09-21 21:42:13 INFO  Done!
2022-09-21 21:42:13 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-21 21:42:13 INFO  Running instrumented original pipeline...
2022-09-21 21:42:13 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-21 21:42:13 INFO  ---RUNTIME: Importing and monkey-patching took 5.8727264404296875 ms
2022-09-21 21:42:30 INFO  ---RUNTIME: Original pipeline execution took 16645.397424697876 ms (excluding imports and monkey-patching)
2022-09-21 21:42:30 INFO  Starting execution of 1 what-if analyses...
2022-09-21 21:42:30 INFO  Start plan generation for analysis OperatorImpact...
2022-09-21 21:42:30 INFO  ---RUNTIME: Plan generation took 5.20634651184082 ms
2022-09-21 21:42:30 INFO  Estimated runtime of original DAG is 13095.93677520752ms
2022-09-21 21:42:30 WARNING Skipping Multi-Query Optimization (instead, only applying patches)
2022-09-21 21:42:30 INFO  Estimated unoptimised what-if runtime is 93228.0108816834ms
2022-09-21 21:42:30 INFO  ---RUNTIME: Multi-Query Optimization took 17.820119857788086 ms
2022-09-21 21:42:30 INFO  Executing generated plans
2022-09-21 21:44:11 INFO  ---RUNTIME: Execution took 100888.75412940979 ms
2022-09-21 21:44:11 INFO  Done!
2022-09-21 21:44:11 INFO  # Finished -- repetition 5 of 7 
2022-09-21 21:44:11 INFO  # Optimization benchmark for operator_impact with args [['reviews', 'fast_loading', 'featurization_4', 'xgboost']] -- repetition 6 of 7
2022-09-21 21:44:11 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-21 21:44:11 INFO  Running instrumented original pipeline...
2022-09-21 21:44:11 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-21 21:44:11 INFO  ---RUNTIME: Importing and monkey-patching took 6.095409393310547 ms
2022-09-21 21:44:28 INFO  ---RUNTIME: Original pipeline execution took 16947.046041488647 ms (excluding imports and monkey-patching)
2022-09-21 21:44:28 INFO  Starting execution of 1 what-if analyses...
2022-09-21 21:44:28 INFO  Start plan generation for analysis OperatorImpact...
2022-09-21 21:44:28 INFO  ---RUNTIME: Plan generation took 5.229949951171875 ms
2022-09-21 21:44:28 INFO  Estimated runtime of original DAG is 13288.520812988281ms
2022-09-21 21:44:28 INFO  Performing Multi-Query Optimization
2022-09-21 21:44:28 INFO  Estimated unoptimized what-if runtime is 94734.0904835407ms
2022-09-21 21:44:28 INFO  Estimated optimised what-if runtime is 52447.63805653925ms
2022-09-21 21:44:28 INFO  Estimated optimisation runtime saving is 42286.45242700145ms
2022-09-21 21:44:28 INFO  ---RUNTIME: Multi-Query Optimization took 128.73148918151855 ms
2022-09-21 21:44:28 INFO  Executing generated plans
2022-09-21 21:45:22 INFO  ---RUNTIME: Execution took 54211.61150932312 ms
2022-09-21 21:45:22 INFO  Done!
2022-09-21 21:45:22 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-21 21:45:22 INFO  Running instrumented original pipeline...
2022-09-21 21:45:22 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-21 21:45:22 INFO  ---RUNTIME: Importing and monkey-patching took 6.11567497253418 ms
2022-09-21 21:45:38 INFO  ---RUNTIME: Original pipeline execution took 16311.191320419312 ms (excluding imports and monkey-patching)
2022-09-21 21:45:38 INFO  Starting execution of 1 what-if analyses...
2022-09-21 21:45:38 INFO  Start plan generation for analysis OperatorImpact...
2022-09-21 21:45:38 INFO  ---RUNTIME: Plan generation took 5.308389663696289 ms
2022-09-21 21:45:38 INFO  Estimated runtime of original DAG is 13037.470579147339ms
2022-09-21 21:45:38 WARNING Skipping Multi-Query Optimization (instead, only applying patches)
2022-09-21 21:45:38 INFO  Estimated unoptimised what-if runtime is 92793.1989193308ms
2022-09-21 21:45:38 INFO  ---RUNTIME: Multi-Query Optimization took 18.16272735595703 ms
2022-09-21 21:45:38 INFO  Executing generated plans
2022-09-21 21:47:31 INFO  ---RUNTIME: Execution took 113086.91310882568 ms
2022-09-21 21:47:31 INFO  Done!
2022-09-21 21:47:31 INFO  # Finished -- repetition 6 of 7 
2022-09-21 21:47:31 INFO  # Optimization benchmark for operator_impact with args [['reviews', 'fast_loading', 'featurization_4', 'xgboost']] -- repetition 7 of 7
2022-09-21 21:47:31 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-21 21:47:31 INFO  Running instrumented original pipeline...
2022-09-21 21:47:32 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-21 21:47:32 INFO  ---RUNTIME: Importing and monkey-patching took 5.8650970458984375 ms
2022-09-21 21:47:48 INFO  ---RUNTIME: Original pipeline execution took 16433.44807624817 ms (excluding imports and monkey-patching)
2022-09-21 21:47:48 INFO  Starting execution of 1 what-if analyses...
2022-09-21 21:47:48 INFO  Start plan generation for analysis OperatorImpact...
2022-09-21 21:47:48 INFO  ---RUNTIME: Plan generation took 5.202054977416992 ms
2022-09-21 21:47:48 INFO  Estimated runtime of original DAG is 13161.50164604187ms
2022-09-21 21:47:48 INFO  Performing Multi-Query Optimization
2022-09-21 21:47:48 INFO  Estimated unoptimized what-if runtime is 93816.07830666461ms
2022-09-21 21:47:48 INFO  Estimated optimised what-if runtime is 52183.21468626976ms
2022-09-21 21:47:48 INFO  Estimated optimisation runtime saving is 41632.86362039485ms
2022-09-21 21:47:48 INFO  ---RUNTIME: Multi-Query Optimization took 133.10837745666504 ms
2022-09-21 21:47:48 INFO  Executing generated plans
2022-09-21 21:48:42 INFO  ---RUNTIME: Execution took 54119.33350563049 ms
2022-09-21 21:48:42 INFO  Done!
2022-09-21 21:48:42 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-21 21:48:42 INFO  Running instrumented original pipeline...
2022-09-21 21:48:42 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-21 21:48:42 INFO  ---RUNTIME: Importing and monkey-patching took 6.759405136108398 ms
2022-09-21 21:49:00 INFO  ---RUNTIME: Original pipeline execution took 17671.69427871704 ms (excluding imports and monkey-patching)
2022-09-21 21:49:00 INFO  Starting execution of 1 what-if analyses...
2022-09-21 21:49:00 INFO  Start plan generation for analysis OperatorImpact...
2022-09-21 21:49:00 INFO  ---RUNTIME: Plan generation took 5.199432373046875 ms
2022-09-21 21:49:00 INFO  Estimated runtime of original DAG is 14359.869480133057ms
2022-09-21 21:49:00 WARNING Skipping Multi-Query Optimization (instead, only applying patches)
2022-09-21 21:49:00 INFO  Estimated unoptimised what-if runtime is 102240.56500518677ms
2022-09-21 21:49:00 INFO  ---RUNTIME: Multi-Query Optimization took 17.835140228271484 ms
2022-09-21 21:49:00 INFO  Executing generated plans
2022-09-21 21:50:49 INFO  ---RUNTIME: Execution took 109094.62356567383 ms
2022-09-21 21:50:49 INFO  Done!
2022-09-21 21:50:49 INFO  # Finished -- repetition 7 of 7 
2022-09-21 21:50:49 INFO  # Final results after all repetitions
2022-09-21 21:50:49 INFO     repetition  ... no_opt_what_if_execution_combined_model_training
0           0  ...                                     30269.125938
1           1  ...                                     31938.334227
2           2  ...                                     35303.499460
3           3  ...                                     27475.809097
4           4  ...                                     26642.690182
5           5  ...                                     38176.902056
6           6  ...                                     25844.844580

[7 rows x 26 columns]
taskset -c 160-167 PROTOCOL_BUFFERS_PYTHON_IMPLEMENTATION=python python3.9 benchmarks_end_to_end.py operator_impact reviews fast_loading featurization_4 neural_network
2022-09-21 21:50:51.888427: W tensorflow/stream_executor/platform/default/dso_loader.cc:64] Could not load dynamic library 'libcudart.so.11.0'; dlerror: libcudart.so.11.0: cannot open shared object file: No such file or directory; LD_LIBRARY_PATH: /home/sgrafbe/mlwhatif/venv/lib/python3.9/site-packages/cv2/../../lib64:
2022-09-21 21:50:51.888478: I tensorflow/stream_executor/cuda/cudart_stub.cc:29] Ignore above cudart dlerror if you do not have a GPU set up on your machine.
2022-09-21 21:50:53 INFO  Patching sys.argv with ['mlwhatif', 'reviews', 'fast_loading', 'featurization_4', 'neural_network']
2022-09-21 21:50:53 INFO  Running instrumented original pipeline...
2022-09-21 21:50:53 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-21 21:50:53 INFO  ---RUNTIME: Importing and monkey-patching took 124.12309646606445 ms
2022-09-21 21:51:07.286565: W tensorflow/stream_executor/platform/default/dso_loader.cc:64] Could not load dynamic library 'libcuda.so.1'; dlerror: libcuda.so.1: cannot open shared object file: No such file or directory; LD_LIBRARY_PATH: /home/sgrafbe/mlwhatif/venv/lib/python3.9/site-packages/cv2/../../lib64:
2022-09-21 21:51:07.286603: W tensorflow/stream_executor/cuda/cuda_driver.cc:326] failed call to cuInit: UNKNOWN ERROR (303)
2022-09-21 21:51:07.286628: I tensorflow/stream_executor/cuda/cuda_diagnostics.cc:156] kernel driver does not appear to be running on this host (angus): /proc/driver/nvidia/version does not exist
2022-09-21 21:51:07.287223: I tensorflow/core/platform/cpu_feature_guard.cc:142] This TensorFlow binary is optimized with oneAPI Deep Neural Network Library (oneDNN) to use the following CPU instructions in performance-critical operations:  AVX2 FMA
To enable them in other operations, rebuild TensorFlow with the appropriate compiler flags.
2022-09-21 21:51:07.528263: I tensorflow/compiler/mlir/mlir_graph_optimization_pass.cc:176] None of the MLIR Optimization Passes are enabled (registered 2)
2022-09-21 21:51:07.540199: I tensorflow/core/platform/profile_utils/cpu_utils.cc:114] CPU Frequency: 2595130000 Hz
2022-09-21 21:51:11 INFO  ---RUNTIME: Original pipeline execution took 18215.54183959961 ms (excluding imports and monkey-patching)
2022-09-21 21:51:11 INFO  Starting execution of 0 what-if analyses...
2022-09-21 21:51:11 INFO  Estimated runtime of original DAG is 14488.110303878784ms
2022-09-21 21:51:11 INFO  Performing Multi-Query Optimization
2022-09-21 21:51:11 INFO  Estimated unoptimized what-if runtime is 0ms
2022-09-21 21:51:11 INFO  Estimated optimised what-if runtime is 0ms
2022-09-21 21:51:11 INFO  Estimated optimisation runtime saving is 0ms
2022-09-21 21:51:11 INFO  ---RUNTIME: Multi-Query Optimization took 0.5540847778320312 ms
2022-09-21 21:51:11 INFO  Executing generated plans
2022-09-21 21:51:11 INFO  ---RUNTIME: Execution took 0.021457672119140625 ms
2022-09-21 21:51:11 INFO  Done!
2022-09-21 21:51:11 INFO  # Optimization benchmark for operator_impact with args [['reviews', 'fast_loading', 'featurization_4', 'neural_network']] -- repetition 1 of 7
2022-09-21 21:51:11 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-21 21:51:11 INFO  Running instrumented original pipeline...
2022-09-21 21:51:11 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-21 21:51:11 INFO  ---RUNTIME: Importing and monkey-patching took 5.872249603271484 ms
2022-09-21 21:51:31 INFO  ---RUNTIME: Original pipeline execution took 19618.66044998169 ms (excluding imports and monkey-patching)
2022-09-21 21:51:31 INFO  Starting execution of 1 what-if analyses...
2022-09-21 21:51:31 INFO  Start plan generation for analysis OperatorImpact...
2022-09-21 21:51:31 INFO  ---RUNTIME: Plan generation took 5.504846572875977 ms
2022-09-21 21:51:31 INFO  Estimated runtime of original DAG is 15652.065515518188ms
2022-09-21 21:51:31 INFO  Performing Multi-Query Optimization
2022-09-21 21:51:31 INFO  Estimated unoptimized what-if runtime is 111733.49733464925ms
2022-09-21 21:51:31 INFO  Estimated optimised what-if runtime is 63670.08748818917ms
2022-09-21 21:51:31 INFO  Estimated optimisation runtime saving is 48063.409846460076ms
2022-09-21 21:51:31 INFO  ---RUNTIME: Multi-Query Optimization took 132.62391090393066 ms
2022-09-21 21:51:31 INFO  Executing generated plans
2022-09-21 21:52:30 INFO  ---RUNTIME: Execution took 59649.65271949768 ms
2022-09-21 21:52:30 INFO  Done!
2022-09-21 21:52:30 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-21 21:52:30 INFO  Running instrumented original pipeline...
2022-09-21 21:52:30 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-21 21:52:30 INFO  ---RUNTIME: Importing and monkey-patching took 6.442785263061523 ms
2022-09-21 21:52:48 INFO  ---RUNTIME: Original pipeline execution took 17896.63863182068 ms (excluding imports and monkey-patching)
2022-09-21 21:52:48 INFO  Starting execution of 1 what-if analyses...
2022-09-21 21:52:48 INFO  Start plan generation for analysis OperatorImpact...
2022-09-21 21:52:48 INFO  ---RUNTIME: Plan generation took 5.076408386230469 ms
2022-09-21 21:52:48 INFO  Estimated runtime of original DAG is 14237.185716629028ms
2022-09-21 21:52:48 WARNING Skipping Multi-Query Optimization (instead, only applying patches)
2022-09-21 21:52:48 INFO  Estimated unoptimised what-if runtime is 101380.65644185155ms
2022-09-21 21:52:48 INFO  ---RUNTIME: Multi-Query Optimization took 19.13285255432129 ms
2022-09-21 21:52:48 INFO  Executing generated plans
2022-09-21 21:54:39 INFO  ---RUNTIME: Execution took 110167.76251792908 ms
2022-09-21 21:54:39 INFO  Done!
2022-09-21 21:54:39 INFO  # Finished -- repetition 1 of 7 
2022-09-21 21:54:39 INFO  # Optimization benchmark for operator_impact with args [['reviews', 'fast_loading', 'featurization_4', 'neural_network']] -- repetition 2 of 7
2022-09-21 21:54:39 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-21 21:54:39 INFO  Running instrumented original pipeline...
2022-09-21 21:54:39 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-21 21:54:39 INFO  ---RUNTIME: Importing and monkey-patching took 8.733749389648438 ms
2022-09-21 21:54:57 INFO  ---RUNTIME: Original pipeline execution took 18862.66851425171 ms (excluding imports and monkey-patching)
2022-09-21 21:54:57 INFO  Starting execution of 1 what-if analyses...
2022-09-21 21:54:57 INFO  Start plan generation for analysis OperatorImpact...
2022-09-21 21:54:57 INFO  ---RUNTIME: Plan generation took 6.422758102416992 ms
2022-09-21 21:54:57 INFO  Estimated runtime of original DAG is 15467.796087265015ms
2022-09-21 21:54:57 INFO  Performing Multi-Query Optimization
2022-09-21 21:54:58 INFO  Estimated unoptimized what-if runtime is 110127.30584809133ms
2022-09-21 21:54:58 INFO  Estimated optimised what-if runtime is 62345.94266296929ms
2022-09-21 21:54:58 INFO  Estimated optimisation runtime saving is 47781.36318512204ms
2022-09-21 21:54:58 INFO  ---RUNTIME: Multi-Query Optimization took 362.79869079589844 ms
2022-09-21 21:54:58 INFO  Executing generated plans
2022-09-21 21:55:58 INFO  ---RUNTIME: Execution took 60014.015197753906 ms
2022-09-21 21:55:58 INFO  Done!
2022-09-21 21:55:58 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-21 21:55:58 INFO  Running instrumented original pipeline...
2022-09-21 21:55:58 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-21 21:55:58 INFO  ---RUNTIME: Importing and monkey-patching took 10.838508605957031 ms
2022-09-21 21:56:16 INFO  ---RUNTIME: Original pipeline execution took 18310.423612594604 ms (excluding imports and monkey-patching)
2022-09-21 21:56:16 INFO  Starting execution of 1 what-if analyses...
2022-09-21 21:56:16 INFO  Start plan generation for analysis OperatorImpact...
2022-09-21 21:56:16 INFO  ---RUNTIME: Plan generation took 6.708621978759766 ms
2022-09-21 21:56:16 INFO  Estimated runtime of original DAG is 13077.592372894287ms
2022-09-21 21:56:16 WARNING Skipping Multi-Query Optimization (instead, only applying patches)
2022-09-21 21:56:16 INFO  Estimated unoptimised what-if runtime is 93081.79590867243ms
2022-09-21 21:56:16 INFO  ---RUNTIME: Multi-Query Optimization took 17.91214942932129 ms
2022-09-21 21:56:16 INFO  Executing generated plans
2022-09-21 21:58:05 INFO  ---RUNTIME: Execution took 108471.05836868286 ms
2022-09-21 21:58:05 INFO  Done!
2022-09-21 21:58:05 INFO  # Finished -- repetition 2 of 7 
2022-09-21 21:58:05 INFO  # Optimization benchmark for operator_impact with args [['reviews', 'fast_loading', 'featurization_4', 'neural_network']] -- repetition 3 of 7
2022-09-21 21:58:05 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-21 21:58:05 INFO  Running instrumented original pipeline...
2022-09-21 21:58:05 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-21 21:58:05 INFO  ---RUNTIME: Importing and monkey-patching took 5.762815475463867 ms
2022-09-21 21:58:22 INFO  ---RUNTIME: Original pipeline execution took 17766.335248947144 ms (excluding imports and monkey-patching)
2022-09-21 21:58:22 INFO  Starting execution of 1 what-if analyses...
2022-09-21 21:58:22 INFO  Start plan generation for analysis OperatorImpact...
2022-09-21 21:58:22 INFO  ---RUNTIME: Plan generation took 4.92548942565918 ms
2022-09-21 21:58:22 INFO  Estimated runtime of original DAG is 14487.7347946167ms
2022-09-21 21:58:22 INFO  Performing Multi-Query Optimization
2022-09-21 21:58:23 INFO  Estimated unoptimized what-if runtime is 103293.534607671ms
2022-09-21 21:58:23 INFO  Estimated optimised what-if runtime is 56923.39902575244ms
2022-09-21 21:58:23 INFO  Estimated optimisation runtime saving is 46370.135581918556ms
2022-09-21 21:58:23 INFO  ---RUNTIME: Multi-Query Optimization took 131.8953037261963 ms
2022-09-21 21:58:23 INFO  Executing generated plans
2022-09-21 21:59:23 INFO  ---RUNTIME: Execution took 60608.01100730896 ms
2022-09-21 21:59:23 INFO  Done!
2022-09-21 21:59:23 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-21 21:59:23 INFO  Running instrumented original pipeline...
2022-09-21 21:59:23 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-21 21:59:23 INFO  ---RUNTIME: Importing and monkey-patching took 8.07642936706543 ms
2022-09-21 21:59:43 INFO  ---RUNTIME: Original pipeline execution took 19341.110944747925 ms (excluding imports and monkey-patching)
2022-09-21 21:59:43 INFO  Starting execution of 1 what-if analyses...
2022-09-21 21:59:43 INFO  Start plan generation for analysis OperatorImpact...
2022-09-21 21:59:43 INFO  ---RUNTIME: Plan generation took 5.117654800415039 ms
2022-09-21 21:59:43 INFO  Estimated runtime of original DAG is 15628.988981246948ms
2022-09-21 21:59:43 WARNING Skipping Multi-Query Optimization (instead, only applying patches)
2022-09-21 21:59:43 INFO  Estimated unoptimised what-if runtime is 111162.43877410093ms
2022-09-21 21:59:43 INFO  ---RUNTIME: Multi-Query Optimization took 17.892837524414062 ms
2022-09-21 21:59:43 INFO  Executing generated plans
2022-09-21 22:01:33 INFO  ---RUNTIME: Execution took 110528.03373336792 ms
2022-09-21 22:01:33 INFO  Done!
2022-09-21 22:01:33 INFO  # Finished -- repetition 3 of 7 
2022-09-21 22:01:33 INFO  # Optimization benchmark for operator_impact with args [['reviews', 'fast_loading', 'featurization_4', 'neural_network']] -- repetition 4 of 7
2022-09-21 22:01:33 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-21 22:01:33 INFO  Running instrumented original pipeline...
2022-09-21 22:01:33 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-21 22:01:33 INFO  ---RUNTIME: Importing and monkey-patching took 5.825042724609375 ms
2022-09-21 22:01:50 INFO  ---RUNTIME: Original pipeline execution took 17186.37466430664 ms (excluding imports and monkey-patching)
2022-09-21 22:01:50 INFO  Starting execution of 1 what-if analyses...
2022-09-21 22:01:50 INFO  Start plan generation for analysis OperatorImpact...
2022-09-21 22:01:50 INFO  ---RUNTIME: Plan generation took 4.946231842041016 ms
2022-09-21 22:01:50 INFO  Estimated runtime of original DAG is 13895.922899246216ms
2022-09-21 22:01:50 INFO  Performing Multi-Query Optimization
2022-09-21 22:01:50 INFO  Estimated unoptimized what-if runtime is 99076.00827035011ms
2022-09-21 22:01:50 INFO  Estimated optimised what-if runtime is 54136.30699912543ms
2022-09-21 22:01:50 INFO  Estimated optimisation runtime saving is 44939.70127122468ms
2022-09-21 22:01:50 INFO  ---RUNTIME: Multi-Query Optimization took 132.51256942749023 ms
2022-09-21 22:01:50 INFO  Executing generated plans
2022-09-21 22:02:52 INFO  ---RUNTIME: Execution took 61504.04071807861 ms
2022-09-21 22:02:52 INFO  Done!
2022-09-21 22:02:52 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-21 22:02:52 INFO  Running instrumented original pipeline...
2022-09-21 22:02:52 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-21 22:02:52 INFO  ---RUNTIME: Importing and monkey-patching took 5.930900573730469 ms
2022-09-21 22:03:08 INFO  ---RUNTIME: Original pipeline execution took 15995.213508605957 ms (excluding imports and monkey-patching)
2022-09-21 22:03:08 INFO  Starting execution of 1 what-if analyses...
2022-09-21 22:03:08 INFO  Start plan generation for analysis OperatorImpact...
2022-09-21 22:03:08 INFO  ---RUNTIME: Plan generation took 5.018711090087891 ms
2022-09-21 22:03:08 INFO  Estimated runtime of original DAG is 12730.300426483154ms
2022-09-21 22:03:08 WARNING Skipping Multi-Query Optimization (instead, only applying patches)
2022-09-21 22:03:08 INFO  Estimated unoptimised what-if runtime is 90616.68068555459ms
2022-09-21 22:03:08 INFO  ---RUNTIME: Multi-Query Optimization took 17.917871475219727 ms
2022-09-21 22:03:08 INFO  Executing generated plans
2022-09-21 22:04:50 INFO  ---RUNTIME: Execution took 101562.69192695618 ms
2022-09-21 22:04:50 INFO  Done!
2022-09-21 22:04:50 INFO  # Finished -- repetition 4 of 7 
2022-09-21 22:04:50 INFO  # Optimization benchmark for operator_impact with args [['reviews', 'fast_loading', 'featurization_4', 'neural_network']] -- repetition 5 of 7
2022-09-21 22:04:50 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-21 22:04:50 INFO  Running instrumented original pipeline...
2022-09-21 22:04:50 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-21 22:04:50 INFO  ---RUNTIME: Importing and monkey-patching took 6.378412246704102 ms
2022-09-21 22:05:06 INFO  ---RUNTIME: Original pipeline execution took 16562.087535858154 ms (excluding imports and monkey-patching)
2022-09-21 22:05:06 INFO  Starting execution of 1 what-if analyses...
2022-09-21 22:05:06 INFO  Start plan generation for analysis OperatorImpact...
2022-09-21 22:05:06 INFO  ---RUNTIME: Plan generation took 4.880666732788086 ms
2022-09-21 22:05:06 INFO  Estimated runtime of original DAG is 13276.75485610962ms
2022-09-21 22:05:06 INFO  Performing Multi-Query Optimization
2022-09-21 22:05:06 INFO  Estimated unoptimized what-if runtime is 94648.51522466648ms
2022-09-21 22:05:06 INFO  Estimated optimised what-if runtime is 51797.80110385474ms
2022-09-21 22:05:06 INFO  Estimated optimisation runtime saving is 42850.71412081174ms
2022-09-21 22:05:06 INFO  ---RUNTIME: Multi-Query Optimization took 132.14468955993652 ms
2022-09-21 22:05:06 INFO  Executing generated plans
2022-09-21 22:06:02 INFO  ---RUNTIME: Execution took 55339.80321884155 ms
2022-09-21 22:06:02 INFO  Done!
2022-09-21 22:06:02 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-21 22:06:02 INFO  Running instrumented original pipeline...
2022-09-21 22:06:02 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-21 22:06:02 INFO  ---RUNTIME: Importing and monkey-patching took 6.458282470703125 ms
2022-09-21 22:06:19 INFO  ---RUNTIME: Original pipeline execution took 16933.225393295288 ms (excluding imports and monkey-patching)
2022-09-21 22:06:19 INFO  Starting execution of 1 what-if analyses...
2022-09-21 22:06:19 INFO  Start plan generation for analysis OperatorImpact...
2022-09-21 22:06:19 INFO  ---RUNTIME: Plan generation took 4.878044128417969 ms
2022-09-21 22:06:19 INFO  Estimated runtime of original DAG is 13492.626667022705ms
2022-09-21 22:06:19 WARNING Skipping Multi-Query Optimization (instead, only applying patches)
2022-09-21 22:06:19 INFO  Estimated unoptimised what-if runtime is 96054.63793952814ms
2022-09-21 22:06:19 INFO  ---RUNTIME: Multi-Query Optimization took 17.568111419677734 ms
2022-09-21 22:06:19 INFO  Executing generated plans
2022-09-21 22:08:00 INFO  ---RUNTIME: Execution took 101535.09020805359 ms
2022-09-21 22:08:00 INFO  Done!
2022-09-21 22:08:00 INFO  # Finished -- repetition 5 of 7 
2022-09-21 22:08:00 INFO  # Optimization benchmark for operator_impact with args [['reviews', 'fast_loading', 'featurization_4', 'neural_network']] -- repetition 6 of 7
2022-09-21 22:08:00 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-21 22:08:00 INFO  Running instrumented original pipeline...
2022-09-21 22:08:00 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-21 22:08:00 INFO  ---RUNTIME: Importing and monkey-patching took 5.7468414306640625 ms
2022-09-21 22:08:17 INFO  ---RUNTIME: Original pipeline execution took 16681.911945343018 ms (excluding imports and monkey-patching)
2022-09-21 22:08:17 INFO  Starting execution of 1 what-if analyses...
2022-09-21 22:08:17 INFO  Start plan generation for analysis OperatorImpact...
2022-09-21 22:08:17 INFO  ---RUNTIME: Plan generation took 7.55620002746582 ms
2022-09-21 22:08:17 INFO  Estimated runtime of original DAG is 12860.23235321045ms
2022-09-21 22:08:17 INFO  Performing Multi-Query Optimization
2022-09-21 22:08:17 INFO  Estimated unoptimized what-if runtime is 91683.79837865161ms
2022-09-21 22:08:17 INFO  Estimated optimised what-if runtime is 51129.041911422326ms
2022-09-21 22:08:17 INFO  Estimated optimisation runtime saving is 40554.75646722929ms
2022-09-21 22:08:17 INFO  ---RUNTIME: Multi-Query Optimization took 146.5449333190918 ms
2022-09-21 22:08:17 INFO  Executing generated plans
2022-09-21 22:09:12 INFO  ---RUNTIME: Execution took 55299.68881607056 ms
2022-09-21 22:09:12 INFO  Done!
2022-09-21 22:09:12 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-21 22:09:12 INFO  Running instrumented original pipeline...
2022-09-21 22:09:12 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-21 22:09:12 INFO  ---RUNTIME: Importing and monkey-patching took 6.348609924316406 ms
2022-09-21 22:09:29 INFO  ---RUNTIME: Original pipeline execution took 16895.46847343445 ms (excluding imports and monkey-patching)
2022-09-21 22:09:29 INFO  Starting execution of 1 what-if analyses...
2022-09-21 22:09:29 INFO  Start plan generation for analysis OperatorImpact...
2022-09-21 22:09:29 INFO  ---RUNTIME: Plan generation took 4.858732223510742 ms
2022-09-21 22:09:29 INFO  Estimated runtime of original DAG is 13131.348848342896ms
2022-09-21 22:09:29 WARNING Skipping Multi-Query Optimization (instead, only applying patches)
2022-09-21 22:09:29 INFO  Estimated unoptimised what-if runtime is 93477.40375378418ms
2022-09-21 22:09:29 INFO  ---RUNTIME: Multi-Query Optimization took 17.69089698791504 ms
2022-09-21 22:09:29 INFO  Executing generated plans
2022-09-21 22:11:11 INFO  ---RUNTIME: Execution took 102199.84340667725 ms
2022-09-21 22:11:11 INFO  Done!
2022-09-21 22:11:11 INFO  # Finished -- repetition 6 of 7 
2022-09-21 22:11:11 INFO  # Optimization benchmark for operator_impact with args [['reviews', 'fast_loading', 'featurization_4', 'neural_network']] -- repetition 7 of 7
2022-09-21 22:11:11 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-21 22:11:11 INFO  Running instrumented original pipeline...
2022-09-21 22:11:12 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-21 22:11:12 INFO  ---RUNTIME: Importing and monkey-patching took 5.745887756347656 ms
2022-09-21 22:11:28 INFO  ---RUNTIME: Original pipeline execution took 17104.07543182373 ms (excluding imports and monkey-patching)
2022-09-21 22:11:28 INFO  Starting execution of 1 what-if analyses...
2022-09-21 22:11:28 INFO  Start plan generation for analysis OperatorImpact...
2022-09-21 22:11:28 INFO  ---RUNTIME: Plan generation took 5.105733871459961 ms
2022-09-21 22:11:28 INFO  Estimated runtime of original DAG is 13369.614839553833ms
2022-09-21 22:11:28 INFO  Performing Multi-Query Optimization
2022-09-21 22:11:29 INFO  Estimated unoptimized what-if runtime is 95318.04289630085ms
2022-09-21 22:11:29 INFO  Estimated optimised what-if runtime is 53759.56663103323ms
2022-09-21 22:11:29 INFO  Estimated optimisation runtime saving is 41558.476265267615ms
2022-09-21 22:11:29 INFO  ---RUNTIME: Multi-Query Optimization took 131.8814754486084 ms
2022-09-21 22:11:29 INFO  Executing generated plans
2022-09-21 22:12:24 INFO  ---RUNTIME: Execution took 55382.89523124695 ms
2022-09-21 22:12:24 INFO  Done!
2022-09-21 22:12:24 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-21 22:12:24 INFO  Running instrumented original pipeline...
2022-09-21 22:12:24 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-21 22:12:24 INFO  ---RUNTIME: Importing and monkey-patching took 5.703449249267578 ms
2022-09-21 22:12:41 INFO  ---RUNTIME: Original pipeline execution took 16800.929069519043 ms (excluding imports and monkey-patching)
2022-09-21 22:12:41 INFO  Starting execution of 1 what-if analyses...
2022-09-21 22:12:41 INFO  Start plan generation for analysis OperatorImpact...
2022-09-21 22:12:41 INFO  ---RUNTIME: Plan generation took 5.223751068115234 ms
2022-09-21 22:12:41 INFO  Estimated runtime of original DAG is 13493.63088607788ms
2022-09-21 22:12:41 WARNING Skipping Multi-Query Optimization (instead, only applying patches)
2022-09-21 22:12:41 INFO  Estimated unoptimised what-if runtime is 96064.02397507557ms
2022-09-21 22:12:41 INFO  ---RUNTIME: Multi-Query Optimization took 20.07126808166504 ms
2022-09-21 22:12:41 INFO  Executing generated plans
2022-09-21 22:14:22 INFO  ---RUNTIME: Execution took 101436.28811836243 ms
2022-09-21 22:14:22 INFO  Done!
2022-09-21 22:14:22 INFO  # Finished -- repetition 7 of 7 
2022-09-21 22:14:22 INFO  # Final results after all repetitions
2022-09-21 22:14:22 INFO     repetition  ... no_opt_what_if_execution_combined_model_training
0           0  ...                                     24684.671164
1           1  ...                                     24585.608959
2           2  ...                                     26794.209957
3           3  ...                                     24593.089104
4           4  ...                                     25158.881187
5           5  ...                                     25389.401197
6           6  ...                                     24623.165131

[7 rows x 26 columns]
taskset -c 160-167 PROTOCOL_BUFFERS_PYTHON_IMPLEMENTATION=python python3.9 benchmarks_end_to_end.py data_cleaning reviews fast_loading featurization_0 logistic_regression
2022-09-21 22:14:25.284146: W tensorflow/stream_executor/platform/default/dso_loader.cc:64] Could not load dynamic library 'libcudart.so.11.0'; dlerror: libcudart.so.11.0: cannot open shared object file: No such file or directory; LD_LIBRARY_PATH: /home/sgrafbe/mlwhatif/venv/lib/python3.9/site-packages/cv2/../../lib64:
2022-09-21 22:14:25.284191: I tensorflow/stream_executor/cuda/cudart_stub.cc:29] Ignore above cudart dlerror if you do not have a GPU set up on your machine.
2022-09-21 22:14:26 INFO  Patching sys.argv with ['mlwhatif', 'reviews', 'fast_loading', 'featurization_0', 'logistic_regression']
2022-09-21 22:14:26 INFO  Running instrumented original pipeline...
2022-09-21 22:14:26 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-21 22:14:26 INFO  ---RUNTIME: Importing and monkey-patching took 124.4359016418457 ms
2022-09-21 22:14:33 INFO  ---RUNTIME: Original pipeline execution took 6685.157775878906 ms (excluding imports and monkey-patching)
2022-09-21 22:14:33 INFO  Starting execution of 0 what-if analyses...
2022-09-21 22:14:33 INFO  Estimated runtime of original DAG is 4997.002601623535ms
2022-09-21 22:14:33 INFO  Performing Multi-Query Optimization
2022-09-21 22:14:33 INFO  Estimated unoptimized what-if runtime is 0ms
2022-09-21 22:14:33 INFO  Estimated optimised what-if runtime is 0ms
2022-09-21 22:14:33 INFO  Estimated optimisation runtime saving is 0ms
2022-09-21 22:14:33 INFO  ---RUNTIME: Multi-Query Optimization took 0.5443096160888672 ms
2022-09-21 22:14:33 INFO  Executing generated plans
2022-09-21 22:14:33 INFO  ---RUNTIME: Execution took 0.0324249267578125 ms
2022-09-21 22:14:33 INFO  Done!
2022-09-21 22:14:33 INFO  # Optimization benchmark for data_cleaning with args [['reviews', 'fast_loading', 'featurization_0', 'logistic_regression']] -- repetition 1 of 7
2022-09-21 22:14:33 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-21 22:14:33 INFO  Running instrumented original pipeline...
2022-09-21 22:14:33 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-21 22:14:33 INFO  ---RUNTIME: Importing and monkey-patching took 5.732536315917969 ms
2022-09-21 22:14:40 INFO  ---RUNTIME: Original pipeline execution took 6569.136142730713 ms (excluding imports and monkey-patching)
2022-09-21 22:14:40 INFO  Starting execution of 1 what-if analyses...
2022-09-21 22:14:40 INFO  Start plan generation for analysis DataCleaning...
2022-09-21 22:14:40 INFO  ---RUNTIME: Plan generation took 0.5741119384765625 ms
2022-09-21 22:14:40 INFO  Estimated runtime of original DAG is 4802.446603775024ms
2022-09-21 22:14:40 INFO  Performing Multi-Query Optimization
2022-09-21 22:14:40 INFO  Estimated unoptimized what-if runtime is 96048.93207550049ms
2022-09-21 22:14:40 INFO  Estimated optimised what-if runtime is 18221.940517425537ms
2022-09-21 22:14:40 INFO  Estimated optimisation runtime saving is 77826.99155807495ms
2022-09-21 22:14:40 INFO  ---RUNTIME: Multi-Query Optimization took 89.51425552368164 ms
2022-09-21 22:14:40 INFO  Executing generated plans
2022-09-21 22:15:05 INFO  ---RUNTIME: Execution took 25800.84180831909 ms
2022-09-21 22:15:05 INFO  Done!
2022-09-21 22:15:05 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-21 22:15:05 INFO  Running instrumented original pipeline...
2022-09-21 22:15:05 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-21 22:15:05 INFO  ---RUNTIME: Importing and monkey-patching took 6.175041198730469 ms
2022-09-21 22:15:12 INFO  ---RUNTIME: Original pipeline execution took 6608.122825622559 ms (excluding imports and monkey-patching)
2022-09-21 22:15:12 INFO  Starting execution of 1 what-if analyses...
2022-09-21 22:15:12 INFO  Start plan generation for analysis DataCleaning...
2022-09-21 22:15:12 INFO  ---RUNTIME: Plan generation took 0.5934238433837891 ms
2022-09-21 22:15:12 INFO  Estimated runtime of original DAG is 4896.262884140015ms
2022-09-21 22:15:12 WARNING Skipping Multi-Query Optimization (instead, only applying patches)
2022-09-21 22:15:12 WARNING Columns ['review_id'] not present in train DAG after the train test split, only before!
2022-09-21 22:15:12 WARNING This could hint at data leakage!
2022-09-21 22:15:12 INFO  Estimated unoptimised what-if runtime is 97925.2576828003ms
2022-09-21 22:15:12 INFO  ---RUNTIME: Multi-Query Optimization took 22.02129364013672 ms
2022-09-21 22:15:12 INFO  Executing generated plans
2022-09-21 22:17:14 INFO  ---RUNTIME: Execution took 122113.70849609375 ms
2022-09-21 22:17:14 INFO  Done!
2022-09-21 22:17:14 INFO  # Finished -- repetition 1 of 7 
2022-09-21 22:17:14 INFO  # Optimization benchmark for data_cleaning with args [['reviews', 'fast_loading', 'featurization_0', 'logistic_regression']] -- repetition 2 of 7
2022-09-21 22:17:14 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-21 22:17:14 INFO  Running instrumented original pipeline...
2022-09-21 22:17:14 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-21 22:17:14 INFO  ---RUNTIME: Importing and monkey-patching took 6.053924560546875 ms
2022-09-21 22:17:21 INFO  ---RUNTIME: Original pipeline execution took 6422.240972518921 ms (excluding imports and monkey-patching)
2022-09-21 22:17:21 INFO  Starting execution of 1 what-if analyses...
2022-09-21 22:17:21 INFO  Start plan generation for analysis DataCleaning...
2022-09-21 22:17:21 INFO  ---RUNTIME: Plan generation took 0.5550384521484375 ms
2022-09-21 22:17:21 INFO  Estimated runtime of original DAG is 4800.616502761841ms
2022-09-21 22:17:21 INFO  Performing Multi-Query Optimization
2022-09-21 22:17:21 INFO  Estimated unoptimized what-if runtime is 96012.33005523682ms
2022-09-21 22:17:21 INFO  Estimated optimised what-if runtime is 18145.08104324341ms
2022-09-21 22:17:21 INFO  Estimated optimisation runtime saving is 77867.24901199341ms
2022-09-21 22:17:21 INFO  ---RUNTIME: Multi-Query Optimization took 85.86549758911133 ms
2022-09-21 22:17:21 INFO  Executing generated plans
2022-09-21 22:17:46 INFO  ---RUNTIME: Execution took 25225.106716156006 ms
2022-09-21 22:17:46 INFO  Done!
2022-09-21 22:17:46 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-21 22:17:46 INFO  Running instrumented original pipeline...
2022-09-21 22:17:46 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-21 22:17:46 INFO  ---RUNTIME: Importing and monkey-patching took 6.066083908081055 ms
2022-09-21 22:17:52 INFO  ---RUNTIME: Original pipeline execution took 6426.918029785156 ms (excluding imports and monkey-patching)
2022-09-21 22:17:52 INFO  Starting execution of 1 what-if analyses...
2022-09-21 22:17:52 INFO  Start plan generation for analysis DataCleaning...
2022-09-21 22:17:52 INFO  ---RUNTIME: Plan generation took 0.5612373352050781 ms
2022-09-21 22:17:52 INFO  Estimated runtime of original DAG is 4789.748430252075ms
2022-09-21 22:17:52 WARNING Skipping Multi-Query Optimization (instead, only applying patches)
2022-09-21 22:17:52 WARNING Columns ['review_id'] not present in train DAG after the train test split, only before!
2022-09-21 22:17:52 WARNING This could hint at data leakage!
2022-09-21 22:17:52 INFO  Estimated unoptimised what-if runtime is 95794.9686050415ms
2022-09-21 22:17:52 INFO  ---RUNTIME: Multi-Query Optimization took 22.60589599609375 ms
2022-09-21 22:17:52 INFO  Executing generated plans
2022-09-21 22:19:52 INFO  ---RUNTIME: Execution took 120066.49565696716 ms
2022-09-21 22:19:52 INFO  Done!
2022-09-21 22:19:52 INFO  # Finished -- repetition 2 of 7 
2022-09-21 22:19:52 INFO  # Optimization benchmark for data_cleaning with args [['reviews', 'fast_loading', 'featurization_0', 'logistic_regression']] -- repetition 3 of 7
2022-09-21 22:19:52 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-21 22:19:52 INFO  Running instrumented original pipeline...
2022-09-21 22:19:53 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-21 22:19:53 INFO  ---RUNTIME: Importing and monkey-patching took 6.072521209716797 ms
2022-09-21 22:19:59 INFO  ---RUNTIME: Original pipeline execution took 6428.849458694458 ms (excluding imports and monkey-patching)
2022-09-21 22:19:59 INFO  Starting execution of 1 what-if analyses...
2022-09-21 22:19:59 INFO  Start plan generation for analysis DataCleaning...
2022-09-21 22:19:59 INFO  ---RUNTIME: Plan generation took 0.5970001220703125 ms
2022-09-21 22:19:59 INFO  Estimated runtime of original DAG is 4797.4207401275635ms
2022-09-21 22:19:59 INFO  Performing Multi-Query Optimization
2022-09-21 22:19:59 INFO  Estimated unoptimized what-if runtime is 95948.41480255127ms
2022-09-21 22:19:59 INFO  Estimated optimised what-if runtime is 18168.699502944946ms
2022-09-21 22:19:59 INFO  Estimated optimisation runtime saving is 77779.71529960632ms
2022-09-21 22:19:59 INFO  ---RUNTIME: Multi-Query Optimization took 87.40091323852539 ms
2022-09-21 22:19:59 INFO  Executing generated plans
2022-09-21 22:20:24 INFO  ---RUNTIME: Execution took 25209.148406982422 ms
2022-09-21 22:20:24 INFO  Done!
2022-09-21 22:20:24 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-21 22:20:24 INFO  Running instrumented original pipeline...
2022-09-21 22:20:24 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-21 22:20:25 INFO  ---RUNTIME: Importing and monkey-patching took 5.810976028442383 ms
2022-09-21 22:20:31 INFO  ---RUNTIME: Original pipeline execution took 6683.135509490967 ms (excluding imports and monkey-patching)
2022-09-21 22:20:31 INFO  Starting execution of 1 what-if analyses...
2022-09-21 22:20:31 INFO  Start plan generation for analysis DataCleaning...
2022-09-21 22:20:31 INFO  ---RUNTIME: Plan generation took 0.5319118499755859 ms
2022-09-21 22:20:31 INFO  Estimated runtime of original DAG is 4812.552690505981ms
2022-09-21 22:20:31 WARNING Skipping Multi-Query Optimization (instead, only applying patches)
2022-09-21 22:20:31 WARNING Columns ['review_id'] not present in train DAG after the train test split, only before!
2022-09-21 22:20:31 WARNING This could hint at data leakage!
2022-09-21 22:20:31 INFO  Estimated unoptimised what-if runtime is 96251.05381011963ms
2022-09-21 22:20:31 INFO  ---RUNTIME: Multi-Query Optimization took 22.188425064086914 ms
2022-09-21 22:20:31 INFO  Executing generated plans
2022-09-21 22:22:32 INFO  ---RUNTIME: Execution took 121064.94116783142 ms
2022-09-21 22:22:32 INFO  Done!
2022-09-21 22:22:32 INFO  # Finished -- repetition 3 of 7 
2022-09-21 22:22:32 INFO  # Optimization benchmark for data_cleaning with args [['reviews', 'fast_loading', 'featurization_0', 'logistic_regression']] -- repetition 4 of 7
2022-09-21 22:22:32 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-21 22:22:32 INFO  Running instrumented original pipeline...
2022-09-21 22:22:32 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-21 22:22:32 INFO  ---RUNTIME: Importing and monkey-patching took 6.103038787841797 ms
2022-09-21 22:22:39 INFO  ---RUNTIME: Original pipeline execution took 6479.290008544922 ms (excluding imports and monkey-patching)
2022-09-21 22:22:39 INFO  Starting execution of 1 what-if analyses...
2022-09-21 22:22:39 INFO  Start plan generation for analysis DataCleaning...
2022-09-21 22:22:39 INFO  ---RUNTIME: Plan generation took 0.5381107330322266 ms
2022-09-21 22:22:39 INFO  Estimated runtime of original DAG is 4822.334766387939ms
2022-09-21 22:22:39 INFO  Performing Multi-Query Optimization
2022-09-21 22:22:39 INFO  Estimated unoptimized what-if runtime is 96446.69532775879ms
2022-09-21 22:22:39 INFO  Estimated optimised what-if runtime is 18141.064882278442ms
2022-09-21 22:22:39 INFO  Estimated optimisation runtime saving is 78305.63044548035ms
2022-09-21 22:22:39 INFO  ---RUNTIME: Multi-Query Optimization took 84.88178253173828 ms
2022-09-21 22:22:39 INFO  Executing generated plans
2022-09-21 22:23:04 INFO  ---RUNTIME: Execution took 25311.946153640747 ms
2022-09-21 22:23:04 INFO  Done!
2022-09-21 22:23:04 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-21 22:23:04 INFO  Running instrumented original pipeline...
2022-09-21 22:23:04 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-21 22:23:04 INFO  ---RUNTIME: Importing and monkey-patching took 6.011724472045898 ms
2022-09-21 22:23:10 INFO  ---RUNTIME: Original pipeline execution took 6478.6083698272705 ms (excluding imports and monkey-patching)
2022-09-21 22:23:10 INFO  Starting execution of 1 what-if analyses...
2022-09-21 22:23:10 INFO  Start plan generation for analysis DataCleaning...
2022-09-21 22:23:10 INFO  ---RUNTIME: Plan generation took 0.5183219909667969 ms
2022-09-21 22:23:10 INFO  Estimated runtime of original DAG is 4822.810888290405ms
2022-09-21 22:23:10 WARNING Skipping Multi-Query Optimization (instead, only applying patches)
2022-09-21 22:23:10 WARNING Columns ['review_id'] not present in train DAG after the train test split, only before!
2022-09-21 22:23:10 WARNING This could hint at data leakage!
2022-09-21 22:23:10 INFO  Estimated unoptimised what-if runtime is 96456.2177658081ms
2022-09-21 22:23:10 INFO  ---RUNTIME: Multi-Query Optimization took 21.821022033691406 ms
2022-09-21 22:23:10 INFO  Executing generated plans
2022-09-21 22:25:11 INFO  ---RUNTIME: Execution took 120483.9825630188 ms
2022-09-21 22:25:11 INFO  Done!
2022-09-21 22:25:11 INFO  # Finished -- repetition 4 of 7 
2022-09-21 22:25:11 INFO  # Optimization benchmark for data_cleaning with args [['reviews', 'fast_loading', 'featurization_0', 'logistic_regression']] -- repetition 5 of 7
2022-09-21 22:25:11 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-21 22:25:11 INFO  Running instrumented original pipeline...
2022-09-21 22:25:11 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-21 22:25:11 INFO  ---RUNTIME: Importing and monkey-patching took 6.061077117919922 ms
2022-09-21 22:25:17 INFO  ---RUNTIME: Original pipeline execution took 6445.063829421997 ms (excluding imports and monkey-patching)
2022-09-21 22:25:17 INFO  Starting execution of 1 what-if analyses...
2022-09-21 22:25:17 INFO  Start plan generation for analysis DataCleaning...
2022-09-21 22:25:17 INFO  ---RUNTIME: Plan generation took 0.5395412445068359 ms
2022-09-21 22:25:17 INFO  Estimated runtime of original DAG is 4797.199964523315ms
2022-09-21 22:25:17 INFO  Performing Multi-Query Optimization
2022-09-21 22:25:17 INFO  Estimated unoptimized what-if runtime is 95943.99929046631ms
2022-09-21 22:25:17 INFO  Estimated optimised what-if runtime is 18103.952646255493ms
2022-09-21 22:25:17 INFO  Estimated optimisation runtime saving is 77840.04664421082ms
2022-09-21 22:25:17 INFO  ---RUNTIME: Multi-Query Optimization took 86.48180961608887 ms
2022-09-21 22:25:17 INFO  Executing generated plans
2022-09-21 22:25:43 INFO  ---RUNTIME: Execution took 25286.606550216675 ms
2022-09-21 22:25:43 INFO  Done!
2022-09-21 22:25:43 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-21 22:25:43 INFO  Running instrumented original pipeline...
2022-09-21 22:25:43 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-21 22:25:43 INFO  ---RUNTIME: Importing and monkey-patching took 5.9909820556640625 ms
2022-09-21 22:25:49 INFO  ---RUNTIME: Original pipeline execution took 6452.38995552063 ms (excluding imports and monkey-patching)
2022-09-21 22:25:49 INFO  Starting execution of 1 what-if analyses...
2022-09-21 22:25:49 INFO  Start plan generation for analysis DataCleaning...
2022-09-21 22:25:49 INFO  ---RUNTIME: Plan generation took 0.5412101745605469 ms
2022-09-21 22:25:49 INFO  Estimated runtime of original DAG is 4820.230960845947ms
2022-09-21 22:25:49 WARNING Skipping Multi-Query Optimization (instead, only applying patches)
2022-09-21 22:25:49 WARNING Columns ['review_id'] not present in train DAG after the train test split, only before!
2022-09-21 22:25:49 WARNING This could hint at data leakage!
2022-09-21 22:25:49 INFO  Estimated unoptimised what-if runtime is 96404.61921691895ms
2022-09-21 22:25:49 INFO  ---RUNTIME: Multi-Query Optimization took 21.862268447875977 ms
2022-09-21 22:25:49 INFO  Executing generated plans
2022-09-21 22:27:50 INFO  ---RUNTIME: Execution took 120486.4308834076 ms
2022-09-21 22:27:50 INFO  Done!
2022-09-21 22:27:50 INFO  # Finished -- repetition 5 of 7 
2022-09-21 22:27:50 INFO  # Optimization benchmark for data_cleaning with args [['reviews', 'fast_loading', 'featurization_0', 'logistic_regression']] -- repetition 6 of 7
2022-09-21 22:27:50 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-21 22:27:50 INFO  Running instrumented original pipeline...
2022-09-21 22:27:50 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-21 22:27:50 INFO  ---RUNTIME: Importing and monkey-patching took 6.171226501464844 ms
2022-09-21 22:27:56 INFO  ---RUNTIME: Original pipeline execution took 6447.60537147522 ms (excluding imports and monkey-patching)
2022-09-21 22:27:56 INFO  Starting execution of 1 what-if analyses...
2022-09-21 22:27:56 INFO  Start plan generation for analysis DataCleaning...
2022-09-21 22:27:56 INFO  ---RUNTIME: Plan generation took 0.5295276641845703 ms
2022-09-21 22:27:56 INFO  Estimated runtime of original DAG is 4806.189775466919ms
2022-09-21 22:27:56 INFO  Performing Multi-Query Optimization
2022-09-21 22:27:56 INFO  Estimated unoptimized what-if runtime is 96123.79550933838ms
2022-09-21 22:27:56 INFO  Estimated optimised what-if runtime is 18072.46470451355ms
2022-09-21 22:27:56 INFO  Estimated optimisation runtime saving is 78051.33080482483ms
2022-09-21 22:27:56 INFO  ---RUNTIME: Multi-Query Optimization took 112.72835731506348 ms
2022-09-21 22:27:56 INFO  Executing generated plans
2022-09-21 22:28:22 INFO  ---RUNTIME: Execution took 25609.00926589966 ms
2022-09-21 22:28:22 INFO  Done!
2022-09-21 22:28:22 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-21 22:28:22 INFO  Running instrumented original pipeline...
2022-09-21 22:28:22 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-21 22:28:22 INFO  ---RUNTIME: Importing and monkey-patching took 6.170034408569336 ms
2022-09-21 22:28:28 INFO  ---RUNTIME: Original pipeline execution took 6515.780210494995 ms (excluding imports and monkey-patching)
2022-09-21 22:28:28 INFO  Starting execution of 1 what-if analyses...
2022-09-21 22:28:28 INFO  Start plan generation for analysis DataCleaning...
2022-09-21 22:28:28 INFO  ---RUNTIME: Plan generation took 0.5152225494384766 ms
2022-09-21 22:28:28 INFO  Estimated runtime of original DAG is 4855.696678161621ms
2022-09-21 22:28:28 WARNING Skipping Multi-Query Optimization (instead, only applying patches)
2022-09-21 22:28:28 WARNING Columns ['review_id'] not present in train DAG after the train test split, only before!
2022-09-21 22:28:28 WARNING This could hint at data leakage!
2022-09-21 22:28:28 INFO  Estimated unoptimised what-if runtime is 97113.93356323242ms
2022-09-21 22:28:28 INFO  ---RUNTIME: Multi-Query Optimization took 22.08232879638672 ms
2022-09-21 22:28:28 INFO  Executing generated plans
2022-09-21 22:30:30 INFO  ---RUNTIME: Execution took 121623.97456169128 ms
2022-09-21 22:30:30 INFO  Done!
2022-09-21 22:30:30 INFO  # Finished -- repetition 6 of 7 
2022-09-21 22:30:30 INFO  # Optimization benchmark for data_cleaning with args [['reviews', 'fast_loading', 'featurization_0', 'logistic_regression']] -- repetition 7 of 7
2022-09-21 22:30:30 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-21 22:30:30 INFO  Running instrumented original pipeline...
2022-09-21 22:30:30 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-21 22:30:30 INFO  ---RUNTIME: Importing and monkey-patching took 6.1931610107421875 ms
2022-09-21 22:30:37 INFO  ---RUNTIME: Original pipeline execution took 6544.697284698486 ms (excluding imports and monkey-patching)
2022-09-21 22:30:37 INFO  Starting execution of 1 what-if analyses...
2022-09-21 22:30:37 INFO  Start plan generation for analysis DataCleaning...
2022-09-21 22:30:37 INFO  ---RUNTIME: Plan generation took 0.5280971527099609 ms
2022-09-21 22:30:37 INFO  Estimated runtime of original DAG is 4868.213176727295ms
2022-09-21 22:30:37 INFO  Performing Multi-Query Optimization
2022-09-21 22:30:37 INFO  Estimated unoptimized what-if runtime is 97364.2635345459ms
2022-09-21 22:30:37 INFO  Estimated optimised what-if runtime is 18203.16457748413ms
2022-09-21 22:30:37 INFO  Estimated optimisation runtime saving is 79161.09895706177ms
2022-09-21 22:30:37 INFO  ---RUNTIME: Multi-Query Optimization took 85.88147163391113 ms
2022-09-21 22:30:37 INFO  Executing generated plans
2022-09-21 22:31:02 INFO  ---RUNTIME: Execution took 25460.92391014099 ms
2022-09-21 22:31:02 INFO  Done!
2022-09-21 22:31:02 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-21 22:31:02 INFO  Running instrumented original pipeline...
2022-09-21 22:31:02 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-21 22:31:02 INFO  ---RUNTIME: Importing and monkey-patching took 6.183147430419922 ms
2022-09-21 22:31:09 INFO  ---RUNTIME: Original pipeline execution took 6528.2697677612305 ms (excluding imports and monkey-patching)
2022-09-21 22:31:09 INFO  Starting execution of 1 what-if analyses...
2022-09-21 22:31:09 INFO  Start plan generation for analysis DataCleaning...
2022-09-21 22:31:09 INFO  ---RUNTIME: Plan generation took 0.5369186401367188 ms
2022-09-21 22:31:09 INFO  Estimated runtime of original DAG is 4862.928867340088ms
2022-09-21 22:31:09 WARNING Skipping Multi-Query Optimization (instead, only applying patches)
2022-09-21 22:31:09 WARNING Columns ['review_id'] not present in train DAG after the train test split, only before!
2022-09-21 22:31:09 WARNING This could hint at data leakage!
2022-09-21 22:31:09 INFO  Estimated unoptimised what-if runtime is 97258.57734680176ms
2022-09-21 22:31:09 INFO  ---RUNTIME: Multi-Query Optimization took 21.91948890686035 ms
2022-09-21 22:31:09 INFO  Executing generated plans
2022-09-21 22:33:10 INFO  ---RUNTIME: Execution took 121725.65841674805 ms
2022-09-21 22:33:10 INFO  Done!
2022-09-21 22:33:10 INFO  # Finished -- repetition 7 of 7 
2022-09-21 22:33:10 INFO  # Final results after all repetitions
2022-09-21 22:33:10 INFO     repetition  ... no_opt_what_if_execution_combined_model_training
0           0  ...                                      3076.793909
1           1  ...                                      3035.623550
2           2  ...                                      3057.932615
3           3  ...                                      3012.816668
4           4  ...                                      3032.265663
5           5  ...                                      3016.267776
6           6  ...                                      3036.153316

[7 rows x 26 columns]
taskset -c 160-167 PROTOCOL_BUFFERS_PYTHON_IMPLEMENTATION=python python3.9 benchmarks_end_to_end.py data_cleaning reviews fast_loading featurization_0 xgboost
2022-09-21 22:33:13.249683: W tensorflow/stream_executor/platform/default/dso_loader.cc:64] Could not load dynamic library 'libcudart.so.11.0'; dlerror: libcudart.so.11.0: cannot open shared object file: No such file or directory; LD_LIBRARY_PATH: /home/sgrafbe/mlwhatif/venv/lib/python3.9/site-packages/cv2/../../lib64:
2022-09-21 22:33:13.249727: I tensorflow/stream_executor/cuda/cudart_stub.cc:29] Ignore above cudart dlerror if you do not have a GPU set up on your machine.
2022-09-21 22:33:14 INFO  Patching sys.argv with ['mlwhatif', 'reviews', 'fast_loading', 'featurization_0', 'xgboost']
2022-09-21 22:33:14 INFO  Running instrumented original pipeline...
2022-09-21 22:33:14 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-21 22:33:14 INFO  ---RUNTIME: Importing and monkey-patching took 122.40719795227051 ms
2022-09-21 22:33:21 INFO  ---RUNTIME: Original pipeline execution took 7175.061225891113 ms (excluding imports and monkey-patching)
2022-09-21 22:33:21 INFO  Starting execution of 0 what-if analyses...
2022-09-21 22:33:21 INFO  Estimated runtime of original DAG is 5541.204929351807ms
2022-09-21 22:33:21 INFO  Performing Multi-Query Optimization
2022-09-21 22:33:21 INFO  Estimated unoptimized what-if runtime is 0ms
2022-09-21 22:33:21 INFO  Estimated optimised what-if runtime is 0ms
2022-09-21 22:33:21 INFO  Estimated optimisation runtime saving is 0ms
2022-09-21 22:33:21 INFO  ---RUNTIME: Multi-Query Optimization took 0.5016326904296875 ms
2022-09-21 22:33:21 INFO  Executing generated plans
2022-09-21 22:33:21 INFO  ---RUNTIME: Execution took 0.027179718017578125 ms
2022-09-21 22:33:21 INFO  Done!
2022-09-21 22:33:21 INFO  # Optimization benchmark for data_cleaning with args [['reviews', 'fast_loading', 'featurization_0', 'xgboost']] -- repetition 1 of 7
2022-09-21 22:33:21 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-21 22:33:21 INFO  Running instrumented original pipeline...
2022-09-21 22:33:22 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-21 22:33:22 INFO  ---RUNTIME: Importing and monkey-patching took 5.6362152099609375 ms
2022-09-21 22:33:29 INFO  ---RUNTIME: Original pipeline execution took 7235.907077789307 ms (excluding imports and monkey-patching)
2022-09-21 22:33:29 INFO  Starting execution of 1 what-if analyses...
2022-09-21 22:33:29 INFO  Start plan generation for analysis DataCleaning...
2022-09-21 22:33:29 INFO  ---RUNTIME: Plan generation took 0.5757808685302734 ms
2022-09-21 22:33:29 INFO  Estimated runtime of original DAG is 5444.739103317261ms
2022-09-21 22:33:29 INFO  Performing Multi-Query Optimization
2022-09-21 22:33:29 INFO  Estimated unoptimized what-if runtime is 108894.78206634521ms
2022-09-21 22:33:29 INFO  Estimated optimised what-if runtime is 31328.357458114624ms
2022-09-21 22:33:29 INFO  Estimated optimisation runtime saving is 77566.42460823059ms
2022-09-21 22:33:29 INFO  ---RUNTIME: Multi-Query Optimization took 88.14096450805664 ms
2022-09-21 22:33:29 INFO  Executing generated plans
2022-09-21 22:34:08 INFO  ---RUNTIME: Execution took 39076.69687271118 ms
2022-09-21 22:34:08 INFO  Done!
2022-09-21 22:34:08 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-21 22:34:08 INFO  Running instrumented original pipeline...
2022-09-21 22:34:08 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-21 22:34:08 INFO  ---RUNTIME: Importing and monkey-patching took 6.320714950561523 ms
2022-09-21 22:34:15 INFO  ---RUNTIME: Original pipeline execution took 7063.161849975586 ms (excluding imports and monkey-patching)
2022-09-21 22:34:15 INFO  Starting execution of 1 what-if analyses...
2022-09-21 22:34:15 INFO  Start plan generation for analysis DataCleaning...
2022-09-21 22:34:15 INFO  ---RUNTIME: Plan generation took 0.6053447723388672 ms
2022-09-21 22:34:15 INFO  Estimated runtime of original DAG is 5437.145948410034ms
2022-09-21 22:34:15 WARNING Skipping Multi-Query Optimization (instead, only applying patches)
2022-09-21 22:34:15 WARNING Columns ['review_id'] not present in train DAG after the train test split, only before!
2022-09-21 22:34:15 WARNING This could hint at data leakage!
2022-09-21 22:34:15 INFO  Estimated unoptimised what-if runtime is 108742.91896820068ms
2022-09-21 22:34:15 INFO  ---RUNTIME: Multi-Query Optimization took 22.256851196289062 ms
2022-09-21 22:34:15 INFO  Executing generated plans
2022-09-21 22:36:28 INFO  ---RUNTIME: Execution took 133320.39523124695 ms
2022-09-21 22:36:28 INFO  Done!
2022-09-21 22:36:28 INFO  # Finished -- repetition 1 of 7 
2022-09-21 22:36:28 INFO  # Optimization benchmark for data_cleaning with args [['reviews', 'fast_loading', 'featurization_0', 'xgboost']] -- repetition 2 of 7
2022-09-21 22:36:28 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-21 22:36:28 INFO  Running instrumented original pipeline...
2022-09-21 22:36:28 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-21 22:36:28 INFO  ---RUNTIME: Importing and monkey-patching took 6.220817565917969 ms
2022-09-21 22:36:35 INFO  ---RUNTIME: Original pipeline execution took 7061.320543289185 ms (excluding imports and monkey-patching)
2022-09-21 22:36:35 INFO  Starting execution of 1 what-if analyses...
2022-09-21 22:36:35 INFO  Start plan generation for analysis DataCleaning...
2022-09-21 22:36:35 INFO  ---RUNTIME: Plan generation took 0.5564689636230469 ms
2022-09-21 22:36:35 INFO  Estimated runtime of original DAG is 5432.814121246338ms
2022-09-21 22:36:35 INFO  Performing Multi-Query Optimization
2022-09-21 22:36:35 INFO  Estimated unoptimized what-if runtime is 108656.28242492676ms
2022-09-21 22:36:35 INFO  Estimated optimised what-if runtime is 31489.763736724854ms
2022-09-21 22:36:35 INFO  Estimated optimisation runtime saving is 77166.5186882019ms
2022-09-21 22:36:35 INFO  ---RUNTIME: Multi-Query Optimization took 85.5557918548584 ms
2022-09-21 22:36:35 INFO  Executing generated plans
2022-09-21 22:37:13 INFO  ---RUNTIME: Execution took 37993.20578575134 ms
2022-09-21 22:37:13 INFO  Done!
2022-09-21 22:37:13 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-21 22:37:13 INFO  Running instrumented original pipeline...
2022-09-21 22:37:13 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-21 22:37:13 INFO  ---RUNTIME: Importing and monkey-patching took 6.237983703613281 ms
2022-09-21 22:37:20 INFO  ---RUNTIME: Original pipeline execution took 7027.882814407349 ms (excluding imports and monkey-patching)
2022-09-21 22:37:20 INFO  Starting execution of 1 what-if analyses...
2022-09-21 22:37:20 INFO  Start plan generation for analysis DataCleaning...
2022-09-21 22:37:20 INFO  ---RUNTIME: Plan generation took 0.5588531494140625 ms
2022-09-21 22:37:20 INFO  Estimated runtime of original DAG is 5404.379844665527ms
2022-09-21 22:37:20 WARNING Skipping Multi-Query Optimization (instead, only applying patches)
2022-09-21 22:37:20 WARNING Columns ['review_id'] not present in train DAG after the train test split, only before!
2022-09-21 22:37:20 WARNING This could hint at data leakage!
2022-09-21 22:37:20 INFO  Estimated unoptimised what-if runtime is 108087.59689331055ms
2022-09-21 22:37:20 INFO  ---RUNTIME: Multi-Query Optimization took 22.873401641845703 ms
2022-09-21 22:37:20 INFO  Executing generated plans
2022-09-21 22:39:33 INFO  ---RUNTIME: Execution took 132850.48031806946 ms
2022-09-21 22:39:33 INFO  Done!
2022-09-21 22:39:33 INFO  # Finished -- repetition 2 of 7 
2022-09-21 22:39:33 INFO  # Optimization benchmark for data_cleaning with args [['reviews', 'fast_loading', 'featurization_0', 'xgboost']] -- repetition 3 of 7
2022-09-21 22:39:33 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-21 22:39:33 INFO  Running instrumented original pipeline...
2022-09-21 22:39:33 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-21 22:39:33 INFO  ---RUNTIME: Importing and monkey-patching took 8.478164672851562 ms
2022-09-21 22:39:40 INFO  ---RUNTIME: Original pipeline execution took 7168.093681335449 ms (excluding imports and monkey-patching)
2022-09-21 22:39:40 INFO  Starting execution of 1 what-if analyses...
2022-09-21 22:39:40 INFO  Start plan generation for analysis DataCleaning...
2022-09-21 22:39:40 INFO  ---RUNTIME: Plan generation took 0.8890628814697266 ms
2022-09-21 22:39:40 INFO  Estimated runtime of original DAG is 5496.946334838867ms
2022-09-21 22:39:40 INFO  Performing Multi-Query Optimization
2022-09-21 22:39:41 INFO  Estimated unoptimized what-if runtime is 109938.92669677734ms
2022-09-21 22:39:41 INFO  Estimated optimised what-if runtime is 31440.28925895691ms
2022-09-21 22:39:41 INFO  Estimated optimisation runtime saving is 78498.63743782043ms
2022-09-21 22:39:41 INFO  ---RUNTIME: Multi-Query Optimization took 121.57773971557617 ms
2022-09-21 22:39:41 INFO  Executing generated plans
2022-09-21 22:40:20 INFO  ---RUNTIME: Execution took 39544.26884651184 ms
2022-09-21 22:40:20 INFO  Done!
2022-09-21 22:40:20 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-21 22:40:20 INFO  Running instrumented original pipeline...
2022-09-21 22:40:20 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-21 22:40:20 INFO  ---RUNTIME: Importing and monkey-patching took 5.755186080932617 ms
2022-09-21 22:40:28 INFO  ---RUNTIME: Original pipeline execution took 7512.629270553589 ms (excluding imports and monkey-patching)
2022-09-21 22:40:28 INFO  Starting execution of 1 what-if analyses...
2022-09-21 22:40:28 INFO  Start plan generation for analysis DataCleaning...
2022-09-21 22:40:28 INFO  ---RUNTIME: Plan generation took 0.5948543548583984 ms
2022-09-21 22:40:28 INFO  Estimated runtime of original DAG is 5626.141548156738ms
2022-09-21 22:40:28 WARNING Skipping Multi-Query Optimization (instead, only applying patches)
2022-09-21 22:40:28 WARNING Columns ['review_id'] not present in train DAG after the train test split, only before!
2022-09-21 22:40:28 WARNING This could hint at data leakage!
2022-09-21 22:40:28 INFO  Estimated unoptimised what-if runtime is 112522.83096313477ms
2022-09-21 22:40:28 INFO  ---RUNTIME: Multi-Query Optimization took 22.086143493652344 ms
2022-09-21 22:40:28 INFO  Executing generated plans
2022-09-21 22:42:45 INFO  ---RUNTIME: Execution took 137400.03180503845 ms
2022-09-21 22:42:45 INFO  Done!
2022-09-21 22:42:45 INFO  # Finished -- repetition 3 of 7 
2022-09-21 22:42:45 INFO  # Optimization benchmark for data_cleaning with args [['reviews', 'fast_loading', 'featurization_0', 'xgboost']] -- repetition 4 of 7
2022-09-21 22:42:45 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-21 22:42:45 INFO  Running instrumented original pipeline...
2022-09-21 22:42:45 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-21 22:42:45 INFO  ---RUNTIME: Importing and monkey-patching took 6.095409393310547 ms
2022-09-21 22:42:52 INFO  ---RUNTIME: Original pipeline execution took 7234.330654144287 ms (excluding imports and monkey-patching)
2022-09-21 22:42:52 INFO  Starting execution of 1 what-if analyses...
2022-09-21 22:42:52 INFO  Start plan generation for analysis DataCleaning...
2022-09-21 22:42:52 INFO  ---RUNTIME: Plan generation took 0.5738735198974609 ms
2022-09-21 22:42:52 INFO  Estimated runtime of original DAG is 5579.037189483643ms
2022-09-21 22:42:52 INFO  Performing Multi-Query Optimization
2022-09-21 22:42:52 INFO  Estimated unoptimized what-if runtime is 111580.74378967285ms
2022-09-21 22:42:52 INFO  Estimated optimised what-if runtime is 33016.868114471436ms
2022-09-21 22:42:52 INFO  Estimated optimisation runtime saving is 78563.87567520142ms
2022-09-21 22:42:52 INFO  ---RUNTIME: Multi-Query Optimization took 87.32080459594727 ms
2022-09-21 22:42:52 INFO  Executing generated plans
2022-09-21 22:43:32 INFO  ---RUNTIME: Execution took 39409.84272956848 ms
2022-09-21 22:43:32 INFO  Done!
2022-09-21 22:43:32 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-21 22:43:32 INFO  Running instrumented original pipeline...
2022-09-21 22:43:32 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-21 22:43:32 INFO  ---RUNTIME: Importing and monkey-patching took 5.95402717590332 ms
2022-09-21 22:43:39 INFO  ---RUNTIME: Original pipeline execution took 7350.849151611328 ms (excluding imports and monkey-patching)
2022-09-21 22:43:39 INFO  Starting execution of 1 what-if analyses...
2022-09-21 22:43:39 INFO  Start plan generation for analysis DataCleaning...
2022-09-21 22:43:39 INFO  ---RUNTIME: Plan generation took 0.6403923034667969 ms
2022-09-21 22:43:39 INFO  Estimated runtime of original DAG is 5705.28769493103ms
2022-09-21 22:43:39 WARNING Skipping Multi-Query Optimization (instead, only applying patches)
2022-09-21 22:43:39 WARNING Columns ['review_id'] not present in train DAG after the train test split, only before!
2022-09-21 22:43:39 WARNING This could hint at data leakage!
2022-09-21 22:43:39 INFO  Estimated unoptimised what-if runtime is 114105.7538986206ms
2022-09-21 22:43:39 INFO  ---RUNTIME: Multi-Query Optimization took 22.96280860900879 ms
2022-09-21 22:43:39 INFO  Executing generated plans
2022-09-21 22:45:57 INFO  ---RUNTIME: Execution took 137931.1625957489 ms
2022-09-21 22:45:57 INFO  Done!
2022-09-21 22:45:57 INFO  # Finished -- repetition 4 of 7 
2022-09-21 22:45:57 INFO  # Optimization benchmark for data_cleaning with args [['reviews', 'fast_loading', 'featurization_0', 'xgboost']] -- repetition 5 of 7
2022-09-21 22:45:57 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-21 22:45:57 INFO  Running instrumented original pipeline...
2022-09-21 22:45:57 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-21 22:45:57 INFO  ---RUNTIME: Importing and monkey-patching took 6.007194519042969 ms
2022-09-21 22:46:04 INFO  ---RUNTIME: Original pipeline execution took 7300.009489059448 ms (excluding imports and monkey-patching)
2022-09-21 22:46:04 INFO  Starting execution of 1 what-if analyses...
2022-09-21 22:46:04 INFO  Start plan generation for analysis DataCleaning...
2022-09-21 22:46:04 INFO  ---RUNTIME: Plan generation took 0.553131103515625 ms
2022-09-21 22:46:04 INFO  Estimated runtime of original DAG is 5559.155702590942ms
2022-09-21 22:46:04 INFO  Performing Multi-Query Optimization
2022-09-21 22:46:05 INFO  Estimated unoptimized what-if runtime is 111183.11405181885ms
2022-09-21 22:46:05 INFO  Estimated optimised what-if runtime is 31377.771854400635ms
2022-09-21 22:46:05 INFO  Estimated optimisation runtime saving is 79805.34219741821ms
2022-09-21 22:46:05 INFO  ---RUNTIME: Multi-Query Optimization took 86.79008483886719 ms
2022-09-21 22:46:05 INFO  Executing generated plans
2022-09-21 22:46:44 INFO  ---RUNTIME: Execution took 39700.942277908325 ms
2022-09-21 22:46:44 INFO  Done!
2022-09-21 22:46:44 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-21 22:46:44 INFO  Running instrumented original pipeline...
2022-09-21 22:46:44 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-21 22:46:44 INFO  ---RUNTIME: Importing and monkey-patching took 6.065845489501953 ms
2022-09-21 22:46:52 INFO  ---RUNTIME: Original pipeline execution took 7325.070858001709 ms (excluding imports and monkey-patching)
2022-09-21 22:46:52 INFO  Starting execution of 1 what-if analyses...
2022-09-21 22:46:52 INFO  Start plan generation for analysis DataCleaning...
2022-09-21 22:46:52 INFO  ---RUNTIME: Plan generation took 0.9365081787109375 ms
2022-09-21 22:46:52 INFO  Estimated runtime of original DAG is 5680.15193939209ms
2022-09-21 22:46:52 WARNING Skipping Multi-Query Optimization (instead, only applying patches)
2022-09-21 22:46:52 WARNING Columns ['review_id'] not present in train DAG after the train test split, only before!
2022-09-21 22:46:52 WARNING This could hint at data leakage!
2022-09-21 22:46:52 INFO  Estimated unoptimised what-if runtime is 113603.0387878418ms
2022-09-21 22:46:52 INFO  ---RUNTIME: Multi-Query Optimization took 32.54055976867676 ms
2022-09-21 22:46:52 INFO  Executing generated plans
2022-09-21 22:49:08 INFO  ---RUNTIME: Execution took 136687.490940094 ms
2022-09-21 22:49:08 INFO  Done!
2022-09-21 22:49:08 INFO  # Finished -- repetition 5 of 7 
2022-09-21 22:49:08 INFO  # Optimization benchmark for data_cleaning with args [['reviews', 'fast_loading', 'featurization_0', 'xgboost']] -- repetition 6 of 7
2022-09-21 22:49:08 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-21 22:49:08 INFO  Running instrumented original pipeline...
2022-09-21 22:49:08 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-21 22:49:08 INFO  ---RUNTIME: Importing and monkey-patching took 6.174802780151367 ms
2022-09-21 22:49:16 INFO  ---RUNTIME: Original pipeline execution took 7340.517997741699 ms (excluding imports and monkey-patching)
2022-09-21 22:49:16 INFO  Starting execution of 1 what-if analyses...
2022-09-21 22:49:16 INFO  Start plan generation for analysis DataCleaning...
2022-09-21 22:49:16 INFO  ---RUNTIME: Plan generation took 0.5376338958740234 ms
2022-09-21 22:49:16 INFO  Estimated runtime of original DAG is 5630.694627761841ms
2022-09-21 22:49:16 INFO  Performing Multi-Query Optimization
2022-09-21 22:49:16 INFO  Estimated unoptimized what-if runtime is 112613.89255523682ms
2022-09-21 22:49:16 INFO  Estimated optimised what-if runtime is 31460.198163986206ms
2022-09-21 22:49:16 INFO  Estimated optimisation runtime saving is 81153.69439125061ms
2022-09-21 22:49:16 INFO  ---RUNTIME: Multi-Query Optimization took 355.5881977081299 ms
2022-09-21 22:49:16 INFO  Executing generated plans
2022-09-21 22:49:56 INFO  ---RUNTIME: Execution took 39972.18298912048 ms
2022-09-21 22:49:56 INFO  Done!
2022-09-21 22:49:56 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-21 22:49:56 INFO  Running instrumented original pipeline...
2022-09-21 22:49:56 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-21 22:49:56 INFO  ---RUNTIME: Importing and monkey-patching took 6.13856315612793 ms
2022-09-21 22:50:03 INFO  ---RUNTIME: Original pipeline execution took 7334.914922714233 ms (excluding imports and monkey-patching)
2022-09-21 22:50:03 INFO  Starting execution of 1 what-if analyses...
2022-09-21 22:50:03 INFO  Start plan generation for analysis DataCleaning...
2022-09-21 22:50:03 INFO  ---RUNTIME: Plan generation took 0.5519390106201172 ms
2022-09-21 22:50:03 INFO  Estimated runtime of original DAG is 5654.918432235718ms
2022-09-21 22:50:03 WARNING Skipping Multi-Query Optimization (instead, only applying patches)
2022-09-21 22:50:03 WARNING Columns ['review_id'] not present in train DAG after the train test split, only before!
2022-09-21 22:50:03 WARNING This could hint at data leakage!
2022-09-21 22:50:03 INFO  Estimated unoptimised what-if runtime is 113098.36864471436ms
2022-09-21 22:50:03 INFO  ---RUNTIME: Multi-Query Optimization took 22.171735763549805 ms
2022-09-21 22:50:03 INFO  Executing generated plans
2022-09-21 22:52:22 INFO  ---RUNTIME: Execution took 138689.42737579346 ms
2022-09-21 22:52:22 INFO  Done!
2022-09-21 22:52:22 INFO  # Finished -- repetition 6 of 7 
2022-09-21 22:52:22 INFO  # Optimization benchmark for data_cleaning with args [['reviews', 'fast_loading', 'featurization_0', 'xgboost']] -- repetition 7 of 7
2022-09-21 22:52:22 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-21 22:52:22 INFO  Running instrumented original pipeline...
2022-09-21 22:52:22 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-21 22:52:22 INFO  ---RUNTIME: Importing and monkey-patching took 6.181478500366211 ms
2022-09-21 22:52:29 INFO  ---RUNTIME: Original pipeline execution took 7367.21396446228 ms (excluding imports and monkey-patching)
2022-09-21 22:52:29 INFO  Starting execution of 1 what-if analyses...
2022-09-21 22:52:29 INFO  Start plan generation for analysis DataCleaning...
2022-09-21 22:52:29 INFO  ---RUNTIME: Plan generation took 0.5571842193603516 ms
2022-09-21 22:52:29 INFO  Estimated runtime of original DAG is 5551.506757736206ms
2022-09-21 22:52:29 INFO  Performing Multi-Query Optimization
2022-09-21 22:52:29 INFO  Estimated unoptimized what-if runtime is 111030.13515472412ms
2022-09-21 22:52:29 INFO  Estimated optimised what-if runtime is 31724.835872650146ms
2022-09-21 22:52:29 INFO  Estimated optimisation runtime saving is 79305.29928207397ms
2022-09-21 22:52:29 INFO  ---RUNTIME: Multi-Query Optimization took 86.3499641418457 ms
2022-09-21 22:52:29 INFO  Executing generated plans
2022-09-21 22:53:11 INFO  ---RUNTIME: Execution took 41740.37146568298 ms
2022-09-21 22:53:11 INFO  Done!
2022-09-21 22:53:11 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-21 22:53:11 INFO  Running instrumented original pipeline...
2022-09-21 22:53:11 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-21 22:53:11 INFO  ---RUNTIME: Importing and monkey-patching took 5.767583847045898 ms
2022-09-21 22:53:19 INFO  ---RUNTIME: Original pipeline execution took 7388.088941574097 ms (excluding imports and monkey-patching)
2022-09-21 22:53:19 INFO  Starting execution of 1 what-if analyses...
2022-09-21 22:53:19 INFO  Start plan generation for analysis DataCleaning...
2022-09-21 22:53:19 INFO  ---RUNTIME: Plan generation took 0.5319118499755859 ms
2022-09-21 22:53:19 INFO  Estimated runtime of original DAG is 5700.364112854004ms
2022-09-21 22:53:19 WARNING Skipping Multi-Query Optimization (instead, only applying patches)
2022-09-21 22:53:19 WARNING Columns ['review_id'] not present in train DAG after the train test split, only before!
2022-09-21 22:53:19 WARNING This could hint at data leakage!
2022-09-21 22:53:19 INFO  Estimated unoptimised what-if runtime is 114007.28225708008ms
2022-09-21 22:53:19 INFO  ---RUNTIME: Multi-Query Optimization took 22.357940673828125 ms
2022-09-21 22:53:19 INFO  Executing generated plans
2022-09-21 22:55:38 INFO  ---RUNTIME: Execution took 139441.97726249695 ms
2022-09-21 22:55:38 INFO  Done!
2022-09-21 22:55:38 INFO  # Finished -- repetition 7 of 7 
2022-09-21 22:55:38 INFO  # Final results after all repetitions
2022-09-21 22:55:38 INFO     repetition  ... no_opt_what_if_execution_combined_model_training
0           0  ...                                     16021.894455
1           1  ...                                     15398.729324
2           2  ...                                     15834.466934
3           3  ...                                     15897.890091
4           4  ...                                     15685.726404
5           5  ...                                     16008.073807
6           6  ...                                     15990.595341

[7 rows x 26 columns]
taskset -c 160-167 PROTOCOL_BUFFERS_PYTHON_IMPLEMENTATION=python python3.9 benchmarks_end_to_end.py data_cleaning reviews fast_loading featurization_0 neural_network
2022-09-21 22:55:40.894144: W tensorflow/stream_executor/platform/default/dso_loader.cc:64] Could not load dynamic library 'libcudart.so.11.0'; dlerror: libcudart.so.11.0: cannot open shared object file: No such file or directory; LD_LIBRARY_PATH: /home/sgrafbe/mlwhatif/venv/lib/python3.9/site-packages/cv2/../../lib64:
2022-09-21 22:55:40.894186: I tensorflow/stream_executor/cuda/cudart_stub.cc:29] Ignore above cudart dlerror if you do not have a GPU set up on your machine.
2022-09-21 22:55:42 INFO  Patching sys.argv with ['mlwhatif', 'reviews', 'fast_loading', 'featurization_0', 'neural_network']
2022-09-21 22:55:42 INFO  Running instrumented original pipeline...
2022-09-21 22:55:42 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-21 22:55:42 INFO  ---RUNTIME: Importing and monkey-patching took 122.19667434692383 ms
2022-09-21 22:55:47.519166: W tensorflow/stream_executor/platform/default/dso_loader.cc:64] Could not load dynamic library 'libcuda.so.1'; dlerror: libcuda.so.1: cannot open shared object file: No such file or directory; LD_LIBRARY_PATH: /home/sgrafbe/mlwhatif/venv/lib/python3.9/site-packages/cv2/../../lib64:
2022-09-21 22:55:47.519207: W tensorflow/stream_executor/cuda/cuda_driver.cc:326] failed call to cuInit: UNKNOWN ERROR (303)
2022-09-21 22:55:47.519231: I tensorflow/stream_executor/cuda/cuda_diagnostics.cc:156] kernel driver does not appear to be running on this host (angus): /proc/driver/nvidia/version does not exist
2022-09-21 22:55:47.519715: I tensorflow/core/platform/cpu_feature_guard.cc:142] This TensorFlow binary is optimized with oneAPI Deep Neural Network Library (oneDNN) to use the following CPU instructions in performance-critical operations:  AVX2 FMA
To enable them in other operations, rebuild TensorFlow with the appropriate compiler flags.
2022-09-21 22:55:47.752748: I tensorflow/compiler/mlir/mlir_graph_optimization_pass.cc:176] None of the MLIR Optimization Passes are enabled (registered 2)
2022-09-21 22:55:47.765181: I tensorflow/core/platform/profile_utils/cpu_utils.cc:114] CPU Frequency: 2595130000 Hz
2022-09-21 22:55:52 INFO  ---RUNTIME: Original pipeline execution took 10675.811290740967 ms (excluding imports and monkey-patching)
2022-09-21 22:55:52 INFO  Starting execution of 0 what-if analyses...
2022-09-21 22:55:52 INFO  Estimated runtime of original DAG is 9031.141996383667ms
2022-09-21 22:55:52 INFO  Performing Multi-Query Optimization
2022-09-21 22:55:52 INFO  Estimated unoptimized what-if runtime is 0ms
2022-09-21 22:55:52 INFO  Estimated optimised what-if runtime is 0ms
2022-09-21 22:55:52 INFO  Estimated optimisation runtime saving is 0ms
2022-09-21 22:55:52 INFO  ---RUNTIME: Multi-Query Optimization took 0.5388259887695312 ms
2022-09-21 22:55:52 INFO  Executing generated plans
2022-09-21 22:55:52 INFO  ---RUNTIME: Execution took 0.023603439331054688 ms
2022-09-21 22:55:52 INFO  Done!
2022-09-21 22:55:52 INFO  # Optimization benchmark for data_cleaning with args [['reviews', 'fast_loading', 'featurization_0', 'neural_network']] -- repetition 1 of 7
2022-09-21 22:55:52 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-21 22:55:52 INFO  Running instrumented original pipeline...
2022-09-21 22:55:53 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-21 22:55:53 INFO  ---RUNTIME: Importing and monkey-patching took 5.5713653564453125 ms
2022-09-21 22:56:02 INFO  ---RUNTIME: Original pipeline execution took 9998.482465744019 ms (excluding imports and monkey-patching)
2022-09-21 22:56:02 INFO  Starting execution of 1 what-if analyses...
2022-09-21 22:56:02 INFO  Start plan generation for analysis DataCleaning...
2022-09-21 22:56:02 INFO  ---RUNTIME: Plan generation took 0.5500316619873047 ms
2022-09-21 22:56:02 INFO  Estimated runtime of original DAG is 8370.846509933472ms
2022-09-21 22:56:02 INFO  Performing Multi-Query Optimization
2022-09-21 22:56:03 INFO  Estimated unoptimized what-if runtime is 167416.93019866943ms
2022-09-21 22:56:03 INFO  Estimated optimised what-if runtime is 89673.55537414551ms
2022-09-21 22:56:03 INFO  Estimated optimisation runtime saving is 77743.37482452393ms
2022-09-21 22:56:03 INFO  ---RUNTIME: Multi-Query Optimization took 86.95745468139648 ms
2022-09-21 22:56:03 INFO  Executing generated plans
2022-09-21 22:57:40 INFO  ---RUNTIME: Execution took 97258.82935523987 ms
2022-09-21 22:57:40 INFO  Done!
2022-09-21 22:57:40 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-21 22:57:40 INFO  Running instrumented original pipeline...
2022-09-21 22:57:40 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-21 22:57:40 INFO  ---RUNTIME: Importing and monkey-patching took 6.012678146362305 ms
2022-09-21 22:57:50 INFO  ---RUNTIME: Original pipeline execution took 10025.505781173706 ms (excluding imports and monkey-patching)
2022-09-21 22:57:50 INFO  Starting execution of 1 what-if analyses...
2022-09-21 22:57:50 INFO  Start plan generation for analysis DataCleaning...
2022-09-21 22:57:50 INFO  ---RUNTIME: Plan generation took 0.5474090576171875 ms
2022-09-21 22:57:50 INFO  Estimated runtime of original DAG is 8408.348083496094ms
2022-09-21 22:57:50 WARNING Skipping Multi-Query Optimization (instead, only applying patches)
2022-09-21 22:57:50 WARNING Columns ['review_id'] not present in train DAG after the train test split, only before!
2022-09-21 22:57:50 WARNING This could hint at data leakage!
2022-09-21 22:57:50 INFO  Estimated unoptimised what-if runtime is 168166.96166992188ms
2022-09-21 22:57:50 INFO  ---RUNTIME: Multi-Query Optimization took 22.297382354736328 ms
2022-09-21 22:57:50 INFO  Executing generated plans
2022-09-21 23:01:05 INFO  ---RUNTIME: Execution took 194660.5966091156 ms
2022-09-21 23:01:05 INFO  Done!
2022-09-21 23:01:05 INFO  # Finished -- repetition 1 of 7 
2022-09-21 23:01:05 INFO  # Optimization benchmark for data_cleaning with args [['reviews', 'fast_loading', 'featurization_0', 'neural_network']] -- repetition 2 of 7
2022-09-21 23:01:05 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-21 23:01:05 INFO  Running instrumented original pipeline...
2022-09-21 23:01:05 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-21 23:01:05 INFO  ---RUNTIME: Importing and monkey-patching took 8.307456970214844 ms
2022-09-21 23:01:15 INFO  ---RUNTIME: Original pipeline execution took 10116.356372833252 ms (excluding imports and monkey-patching)
2022-09-21 23:01:15 INFO  Starting execution of 1 what-if analyses...
2022-09-21 23:01:15 INFO  Start plan generation for analysis DataCleaning...
2022-09-21 23:01:15 INFO  ---RUNTIME: Plan generation took 0.5674362182617188 ms
2022-09-21 23:01:15 INFO  Estimated runtime of original DAG is 8461.98058128357ms
2022-09-21 23:01:15 INFO  Performing Multi-Query Optimization
2022-09-21 23:01:15 INFO  Estimated unoptimized what-if runtime is 169239.6116256714ms
2022-09-21 23:01:15 INFO  Estimated optimised what-if runtime is 89565.9613609314ms
2022-09-21 23:01:15 INFO  Estimated optimisation runtime saving is 79673.65026473999ms
2022-09-21 23:01:15 INFO  ---RUNTIME: Multi-Query Optimization took 87.79597282409668 ms
2022-09-21 23:01:15 INFO  Executing generated plans
2022-09-21 23:02:51 INFO  ---RUNTIME: Execution took 96420.5961227417 ms
2022-09-21 23:02:51 INFO  Done!
2022-09-21 23:02:51 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-21 23:02:51 INFO  Running instrumented original pipeline...
2022-09-21 23:02:51 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-21 23:02:51 INFO  ---RUNTIME: Importing and monkey-patching took 8.404016494750977 ms
2022-09-21 23:03:01 INFO  ---RUNTIME: Original pipeline execution took 10175.867795944214 ms (excluding imports and monkey-patching)
2022-09-21 23:03:01 INFO  Starting execution of 1 what-if analyses...
2022-09-21 23:03:01 INFO  Start plan generation for analysis DataCleaning...
2022-09-21 23:03:01 INFO  ---RUNTIME: Plan generation took 0.5090236663818359 ms
2022-09-21 23:03:01 INFO  Estimated runtime of original DAG is 8538.485288619995ms
2022-09-21 23:03:01 WARNING Skipping Multi-Query Optimization (instead, only applying patches)
2022-09-21 23:03:01 WARNING Columns ['review_id'] not present in train DAG after the train test split, only before!
2022-09-21 23:03:01 WARNING This could hint at data leakage!
2022-09-21 23:03:01 INFO  Estimated unoptimised what-if runtime is 170769.7057723999ms
2022-09-21 23:03:01 INFO  ---RUNTIME: Multi-Query Optimization took 23.300647735595703 ms
2022-09-21 23:03:01 INFO  Executing generated plans
2022-09-21 23:06:15 INFO  ---RUNTIME: Execution took 194055.50694465637 ms
2022-09-21 23:06:15 INFO  Done!
2022-09-21 23:06:15 INFO  # Finished -- repetition 2 of 7 
2022-09-21 23:06:15 INFO  # Optimization benchmark for data_cleaning with args [['reviews', 'fast_loading', 'featurization_0', 'neural_network']] -- repetition 3 of 7
2022-09-21 23:06:15 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-21 23:06:15 INFO  Running instrumented original pipeline...
2022-09-21 23:06:16 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-21 23:06:16 INFO  ---RUNTIME: Importing and monkey-patching took 5.821704864501953 ms
2022-09-21 23:06:26 INFO  ---RUNTIME: Original pipeline execution took 10084.183692932129 ms (excluding imports and monkey-patching)
2022-09-21 23:06:26 INFO  Starting execution of 1 what-if analyses...
2022-09-21 23:06:26 INFO  Start plan generation for analysis DataCleaning...
2022-09-21 23:06:26 INFO  ---RUNTIME: Plan generation took 0.5407333374023438 ms
2022-09-21 23:06:26 INFO  Estimated runtime of original DAG is 8355.513334274292ms
2022-09-21 23:06:26 INFO  Performing Multi-Query Optimization
2022-09-21 23:06:26 INFO  Estimated unoptimized what-if runtime is 167110.26668548584ms
2022-09-21 23:06:26 INFO  Estimated optimised what-if runtime is 87650.6724357605ms
2022-09-21 23:06:26 INFO  Estimated optimisation runtime saving is 79459.59424972534ms
2022-09-21 23:06:26 INFO  ---RUNTIME: Multi-Query Optimization took 85.75987815856934 ms
2022-09-21 23:06:26 INFO  Executing generated plans
2022-09-21 23:08:03 INFO  ---RUNTIME: Execution took 97569.61274147034 ms
2022-09-21 23:08:03 INFO  Done!
2022-09-21 23:08:03 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-21 23:08:03 INFO  Running instrumented original pipeline...
2022-09-21 23:08:03 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-21 23:08:03 INFO  ---RUNTIME: Importing and monkey-patching took 8.492231369018555 ms
2022-09-21 23:08:13 INFO  ---RUNTIME: Original pipeline execution took 10180.60827255249 ms (excluding imports and monkey-patching)
2022-09-21 23:08:13 INFO  Starting execution of 1 what-if analyses...
2022-09-21 23:08:13 INFO  Start plan generation for analysis DataCleaning...
2022-09-21 23:08:13 INFO  ---RUNTIME: Plan generation took 0.5166530609130859 ms
2022-09-21 23:08:13 INFO  Estimated runtime of original DAG is 8557.443380355835ms
2022-09-21 23:08:13 WARNING Skipping Multi-Query Optimization (instead, only applying patches)
2022-09-21 23:08:13 WARNING Columns ['review_id'] not present in train DAG after the train test split, only before!
2022-09-21 23:08:13 WARNING This could hint at data leakage!
2022-09-21 23:08:13 INFO  Estimated unoptimised what-if runtime is 171148.8676071167ms
2022-09-21 23:08:13 INFO  ---RUNTIME: Multi-Query Optimization took 21.476268768310547 ms
2022-09-21 23:08:13 INFO  Executing generated plans
2022-09-21 23:11:29 INFO  ---RUNTIME: Execution took 195080.15775680542 ms
2022-09-21 23:11:29 INFO  Done!
2022-09-21 23:11:29 INFO  # Finished -- repetition 3 of 7 
2022-09-21 23:11:29 INFO  # Optimization benchmark for data_cleaning with args [['reviews', 'fast_loading', 'featurization_0', 'neural_network']] -- repetition 4 of 7
2022-09-21 23:11:29 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-21 23:11:29 INFO  Running instrumented original pipeline...
2022-09-21 23:11:29 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-21 23:11:29 INFO  ---RUNTIME: Importing and monkey-patching took 5.8536529541015625 ms
2022-09-21 23:11:39 INFO  ---RUNTIME: Original pipeline execution took 10193.273544311523 ms (excluding imports and monkey-patching)
2022-09-21 23:11:39 INFO  Starting execution of 1 what-if analyses...
2022-09-21 23:11:39 INFO  Start plan generation for analysis DataCleaning...
2022-09-21 23:11:39 INFO  ---RUNTIME: Plan generation took 0.5509853363037109 ms
2022-09-21 23:11:39 INFO  Estimated runtime of original DAG is 8508.972883224487ms
2022-09-21 23:11:39 INFO  Performing Multi-Query Optimization
2022-09-21 23:11:39 INFO  Estimated unoptimized what-if runtime is 170179.45766448975ms
2022-09-21 23:11:39 INFO  Estimated optimised what-if runtime is 90611.6738319397ms
2022-09-21 23:11:39 INFO  Estimated optimisation runtime saving is 79567.78383255005ms
2022-09-21 23:11:39 INFO  ---RUNTIME: Multi-Query Optimization took 85.22868156433105 ms
2022-09-21 23:11:39 INFO  Executing generated plans
2022-09-21 23:13:17 INFO  ---RUNTIME: Execution took 97950.3607749939 ms
2022-09-21 23:13:17 INFO  Done!
2022-09-21 23:13:17 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-21 23:13:17 INFO  Running instrumented original pipeline...
2022-09-21 23:13:17 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-21 23:13:17 INFO  ---RUNTIME: Importing and monkey-patching took 6.036520004272461 ms
2022-09-21 23:13:27 INFO  ---RUNTIME: Original pipeline execution took 10116.574048995972 ms (excluding imports and monkey-patching)
2022-09-21 23:13:27 INFO  Starting execution of 1 what-if analyses...
2022-09-21 23:13:27 INFO  Start plan generation for analysis DataCleaning...
2022-09-21 23:13:27 INFO  ---RUNTIME: Plan generation took 0.5338191986083984 ms
2022-09-21 23:13:27 INFO  Estimated runtime of original DAG is 8467.041969299316ms
2022-09-21 23:13:27 WARNING Skipping Multi-Query Optimization (instead, only applying patches)
2022-09-21 23:13:27 WARNING Columns ['review_id'] not present in train DAG after the train test split, only before!
2022-09-21 23:13:27 WARNING This could hint at data leakage!
2022-09-21 23:13:27 INFO  Estimated unoptimised what-if runtime is 169340.83938598633ms
2022-09-21 23:13:27 INFO  ---RUNTIME: Multi-Query Optimization took 22.19557762145996 ms
2022-09-21 23:13:27 INFO  Executing generated plans
2022-09-21 23:16:42 INFO  ---RUNTIME: Execution took 194827.166557312 ms
2022-09-21 23:16:42 INFO  Done!
2022-09-21 23:16:42 INFO  # Finished -- repetition 4 of 7 
2022-09-21 23:16:42 INFO  # Optimization benchmark for data_cleaning with args [['reviews', 'fast_loading', 'featurization_0', 'neural_network']] -- repetition 5 of 7
2022-09-21 23:16:42 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-21 23:16:42 INFO  Running instrumented original pipeline...
2022-09-21 23:16:42 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-21 23:16:42 INFO  ---RUNTIME: Importing and monkey-patching took 6.252527236938477 ms
2022-09-21 23:16:52 INFO  ---RUNTIME: Original pipeline execution took 10722.167491912842 ms (excluding imports and monkey-patching)
2022-09-21 23:16:52 INFO  Starting execution of 1 what-if analyses...
2022-09-21 23:16:52 INFO  Start plan generation for analysis DataCleaning...
2022-09-21 23:16:52 INFO  ---RUNTIME: Plan generation took 0.5083084106445312 ms
2022-09-21 23:16:52 INFO  Estimated runtime of original DAG is 9089.372873306274ms
2022-09-21 23:16:52 INFO  Performing Multi-Query Optimization
2022-09-21 23:16:53 INFO  Estimated unoptimized what-if runtime is 181787.4574661255ms
2022-09-21 23:16:53 INFO  Estimated optimised what-if runtime is 103574.54204559326ms
2022-09-21 23:16:53 INFO  Estimated optimisation runtime saving is 78212.91542053223ms
2022-09-21 23:16:53 INFO  ---RUNTIME: Multi-Query Optimization took 84.65433120727539 ms
2022-09-21 23:16:53 INFO  Executing generated plans
2022-09-21 23:18:30 INFO  ---RUNTIME: Execution took 97253.18789482117 ms
2022-09-21 23:18:30 INFO  Done!
2022-09-21 23:18:30 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-21 23:18:30 INFO  Running instrumented original pipeline...
2022-09-21 23:18:30 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-21 23:18:30 INFO  ---RUNTIME: Importing and monkey-patching took 6.587743759155273 ms
2022-09-21 23:18:40 INFO  ---RUNTIME: Original pipeline execution took 10135.735034942627 ms (excluding imports and monkey-patching)
2022-09-21 23:18:40 INFO  Starting execution of 1 what-if analyses...
2022-09-21 23:18:40 INFO  Start plan generation for analysis DataCleaning...
2022-09-21 23:18:40 INFO  ---RUNTIME: Plan generation took 0.5769729614257812 ms
2022-09-21 23:18:40 INFO  Estimated runtime of original DAG is 8504.856824874878ms
2022-09-21 23:18:40 WARNING Skipping Multi-Query Optimization (instead, only applying patches)
2022-09-21 23:18:40 WARNING Columns ['review_id'] not present in train DAG after the train test split, only before!
2022-09-21 23:18:40 WARNING This could hint at data leakage!
2022-09-21 23:18:40 INFO  Estimated unoptimised what-if runtime is 170097.13649749756ms
2022-09-21 23:18:40 INFO  ---RUNTIME: Multi-Query Optimization took 24.94668960571289 ms
2022-09-21 23:18:40 INFO  Executing generated plans
2022-09-21 23:21:55 INFO  ---RUNTIME: Execution took 194774.93524551392 ms
2022-09-21 23:21:55 INFO  Done!
2022-09-21 23:21:55 INFO  # Finished -- repetition 5 of 7 
2022-09-21 23:21:55 INFO  # Optimization benchmark for data_cleaning with args [['reviews', 'fast_loading', 'featurization_0', 'neural_network']] -- repetition 6 of 7
2022-09-21 23:21:55 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-21 23:21:55 INFO  Running instrumented original pipeline...
2022-09-21 23:21:55 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-21 23:21:55 INFO  ---RUNTIME: Importing and monkey-patching took 6.02269172668457 ms
2022-09-21 23:22:05 INFO  ---RUNTIME: Original pipeline execution took 10643.976926803589 ms (excluding imports and monkey-patching)
2022-09-21 23:22:05 INFO  Starting execution of 1 what-if analyses...
2022-09-21 23:22:05 INFO  Start plan generation for analysis DataCleaning...
2022-09-21 23:22:05 INFO  ---RUNTIME: Plan generation took 0.5745887756347656 ms
2022-09-21 23:22:05 INFO  Estimated runtime of original DAG is 9013.646841049194ms
2022-09-21 23:22:05 INFO  Performing Multi-Query Optimization
2022-09-21 23:22:06 INFO  Estimated unoptimized what-if runtime is 180272.9368209839ms
2022-09-21 23:22:06 INFO  Estimated optimised what-if runtime is 101771.80314064026ms
2022-09-21 23:22:06 INFO  Estimated optimisation runtime saving is 78501.13368034363ms
2022-09-21 23:22:06 INFO  ---RUNTIME: Multi-Query Optimization took 84.5024585723877 ms
2022-09-21 23:22:06 INFO  Executing generated plans
2022-09-21 23:23:43 INFO  ---RUNTIME: Execution took 97302.78491973877 ms
2022-09-21 23:23:43 INFO  Done!
2022-09-21 23:23:43 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-21 23:23:43 INFO  Running instrumented original pipeline...
2022-09-21 23:23:43 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-21 23:23:43 INFO  ---RUNTIME: Importing and monkey-patching took 6.313085556030273 ms
2022-09-21 23:23:53 INFO  ---RUNTIME: Original pipeline execution took 9934.486389160156 ms (excluding imports and monkey-patching)
2022-09-21 23:23:53 INFO  Starting execution of 1 what-if analyses...
2022-09-21 23:23:53 INFO  Start plan generation for analysis DataCleaning...
2022-09-21 23:23:53 INFO  ---RUNTIME: Plan generation took 0.5495548248291016 ms
2022-09-21 23:23:53 INFO  Estimated runtime of original DAG is 8305.814027786255ms
2022-09-21 23:23:53 WARNING Skipping Multi-Query Optimization (instead, only applying patches)
2022-09-21 23:23:53 WARNING Columns ['review_id'] not present in train DAG after the train test split, only before!
2022-09-21 23:23:53 WARNING This could hint at data leakage!
2022-09-21 23:23:53 INFO  Estimated unoptimised what-if runtime is 166116.2805557251ms
2022-09-21 23:23:53 INFO  ---RUNTIME: Multi-Query Optimization took 21.625518798828125 ms
2022-09-21 23:23:53 INFO  Executing generated plans
2022-09-21 23:27:08 INFO  ---RUNTIME: Execution took 194974.10821914673 ms
2022-09-21 23:27:08 INFO  Done!
2022-09-21 23:27:08 INFO  # Finished -- repetition 6 of 7 
2022-09-21 23:27:08 INFO  # Optimization benchmark for data_cleaning with args [['reviews', 'fast_loading', 'featurization_0', 'neural_network']] -- repetition 7 of 7
2022-09-21 23:27:08 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-21 23:27:08 INFO  Running instrumented original pipeline...
2022-09-21 23:27:08 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-21 23:27:08 INFO  ---RUNTIME: Importing and monkey-patching took 5.968570709228516 ms
2022-09-21 23:27:18 INFO  ---RUNTIME: Original pipeline execution took 10262.633085250854 ms (excluding imports and monkey-patching)
2022-09-21 23:27:18 INFO  Starting execution of 1 what-if analyses...
2022-09-21 23:27:18 INFO  Start plan generation for analysis DataCleaning...
2022-09-21 23:27:18 INFO  ---RUNTIME: Plan generation took 0.5092620849609375 ms
2022-09-21 23:27:18 INFO  Estimated runtime of original DAG is 8620.275497436523ms
2022-09-21 23:27:18 INFO  Performing Multi-Query Optimization
2022-09-21 23:27:18 INFO  Estimated unoptimized what-if runtime is 172405.50994873047ms
2022-09-21 23:27:18 INFO  Estimated optimised what-if runtime is 93818.22729110718ms
2022-09-21 23:27:18 INFO  Estimated optimisation runtime saving is 78587.28265762329ms
2022-09-21 23:27:18 INFO  ---RUNTIME: Multi-Query Optimization took 84.26833152770996 ms
2022-09-21 23:27:18 INFO  Executing generated plans
2022-09-21 23:28:55 INFO  ---RUNTIME: Execution took 97172.71208763123 ms
2022-09-21 23:28:55 INFO  Done!
2022-09-21 23:28:55 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-21 23:28:55 INFO  Running instrumented original pipeline...
2022-09-21 23:28:55 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-21 23:28:55 INFO  ---RUNTIME: Importing and monkey-patching took 6.17527961730957 ms
2022-09-21 23:29:06 INFO  ---RUNTIME: Original pipeline execution took 10634.485721588135 ms (excluding imports and monkey-patching)
2022-09-21 23:29:06 INFO  Starting execution of 1 what-if analyses...
2022-09-21 23:29:06 INFO  Start plan generation for analysis DataCleaning...
2022-09-21 23:29:06 INFO  ---RUNTIME: Plan generation took 0.47898292541503906 ms
2022-09-21 23:29:06 INFO  Estimated runtime of original DAG is 8895.102262496948ms
2022-09-21 23:29:06 WARNING Skipping Multi-Query Optimization (instead, only applying patches)
2022-09-21 23:29:06 WARNING Columns ['review_id'] not present in train DAG after the train test split, only before!
2022-09-21 23:29:06 WARNING This could hint at data leakage!
2022-09-21 23:29:06 INFO  Estimated unoptimised what-if runtime is 177902.04524993896ms
2022-09-21 23:29:06 INFO  ---RUNTIME: Multi-Query Optimization took 24.162769317626953 ms
2022-09-21 23:29:06 INFO  Executing generated plans
2022-09-21 23:32:22 INFO  ---RUNTIME: Execution took 195665.13013839722 ms
2022-09-21 23:32:22 INFO  Done!
2022-09-21 23:32:22 INFO  # Finished -- repetition 7 of 7 
2022-09-21 23:32:22 INFO  # Final results after all repetitions
2022-09-21 23:32:22 INFO     repetition  ... no_opt_what_if_execution_combined_model_training
0           0  ...                                     65984.368801
1           1  ...                                     65827.249289
2           2  ...                                     66709.648371
3           3  ...                                     67634.505987
4           4  ...                                     67374.288082
5           5  ...                                     66761.939287
6           6  ...                                     66770.928383

[7 rows x 26 columns]
taskset -c 160-167 PROTOCOL_BUFFERS_PYTHON_IMPLEMENTATION=python python3.9 benchmarks_end_to_end.py data_cleaning reviews fast_loading featurization_1 logistic_regression
2022-09-21 23:32:24.583094: W tensorflow/stream_executor/platform/default/dso_loader.cc:64] Could not load dynamic library 'libcudart.so.11.0'; dlerror: libcudart.so.11.0: cannot open shared object file: No such file or directory; LD_LIBRARY_PATH: /home/sgrafbe/mlwhatif/venv/lib/python3.9/site-packages/cv2/../../lib64:
2022-09-21 23:32:24.583143: I tensorflow/stream_executor/cuda/cudart_stub.cc:29] Ignore above cudart dlerror if you do not have a GPU set up on your machine.
2022-09-21 23:32:25 INFO  Patching sys.argv with ['mlwhatif', 'reviews', 'fast_loading', 'featurization_1', 'logistic_regression']
2022-09-21 23:32:25 INFO  Running instrumented original pipeline...
2022-09-21 23:32:25 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-21 23:32:26 INFO  ---RUNTIME: Importing and monkey-patching took 136.67035102844238 ms
2022-09-21 23:32:33 INFO  ---RUNTIME: Original pipeline execution took 7313.621044158936 ms (excluding imports and monkey-patching)
2022-09-21 23:32:33 INFO  Starting execution of 0 what-if analyses...
2022-09-21 23:32:33 INFO  Estimated runtime of original DAG is 5014.593839645386ms
2022-09-21 23:32:33 INFO  Performing Multi-Query Optimization
2022-09-21 23:32:33 INFO  Estimated unoptimized what-if runtime is 0ms
2022-09-21 23:32:33 INFO  Estimated optimised what-if runtime is 0ms
2022-09-21 23:32:33 INFO  Estimated optimisation runtime saving is 0ms
2022-09-21 23:32:33 INFO  ---RUNTIME: Multi-Query Optimization took 0.5307197570800781 ms
2022-09-21 23:32:33 INFO  Executing generated plans
2022-09-21 23:32:33 INFO  ---RUNTIME: Execution took 0.027894973754882812 ms
2022-09-21 23:32:33 INFO  Done!
2022-09-21 23:32:33 INFO  # Optimization benchmark for data_cleaning with args [['reviews', 'fast_loading', 'featurization_1', 'logistic_regression']] -- repetition 1 of 7
2022-09-21 23:32:33 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-21 23:32:33 INFO  Running instrumented original pipeline...
2022-09-21 23:32:33 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-21 23:32:33 INFO  ---RUNTIME: Importing and monkey-patching took 6.088495254516602 ms
2022-09-21 23:32:40 INFO  ---RUNTIME: Original pipeline execution took 7422.20664024353 ms (excluding imports and monkey-patching)
2022-09-21 23:32:40 INFO  Starting execution of 1 what-if analyses...
2022-09-21 23:32:40 INFO  Start plan generation for analysis DataCleaning...
2022-09-21 23:32:40 INFO  ---RUNTIME: Plan generation took 0.7147789001464844 ms
2022-09-21 23:32:40 INFO  Estimated runtime of original DAG is 4978.54471206665ms
2022-09-21 23:32:40 INFO  Performing Multi-Query Optimization
2022-09-21 23:32:40 INFO  Estimated unoptimized what-if runtime is 99570.89424133301ms
2022-09-21 23:32:40 INFO  Estimated optimised what-if runtime is 19164.61181640625ms
2022-09-21 23:32:40 INFO  Estimated optimisation runtime saving is 80406.28242492676ms
2022-09-21 23:32:40 INFO  ---RUNTIME: Multi-Query Optimization took 94.74897384643555 ms
2022-09-21 23:32:40 INFO  Executing generated plans
2022-09-21 23:33:06 INFO  ---RUNTIME: Execution took 25948.736429214478 ms
2022-09-21 23:33:06 INFO  Done!
2022-09-21 23:33:06 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-21 23:33:06 INFO  Running instrumented original pipeline...
2022-09-21 23:33:06 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-21 23:33:06 INFO  ---RUNTIME: Importing and monkey-patching took 6.734371185302734 ms
2022-09-21 23:33:13 INFO  ---RUNTIME: Original pipeline execution took 7113.933563232422 ms (excluding imports and monkey-patching)
2022-09-21 23:33:13 INFO  Starting execution of 1 what-if analyses...
2022-09-21 23:33:13 INFO  Start plan generation for analysis DataCleaning...
2022-09-21 23:33:13 INFO  ---RUNTIME: Plan generation took 0.7491111755371094 ms
2022-09-21 23:33:13 INFO  Estimated runtime of original DAG is 4909.0869426727295ms
2022-09-21 23:33:13 WARNING Skipping Multi-Query Optimization (instead, only applying patches)
2022-09-21 23:33:13 WARNING Columns ['review_id'] not present in train DAG after the train test split, only before!
2022-09-21 23:33:13 WARNING This could hint at data leakage!
2022-09-21 23:33:13 INFO  Estimated unoptimised what-if runtime is 98181.73885345459ms
2022-09-21 23:33:13 INFO  ---RUNTIME: Multi-Query Optimization took 23.888826370239258 ms
2022-09-21 23:33:13 INFO  Executing generated plans
2022-09-21 23:35:17 INFO  ---RUNTIME: Execution took 123244.81225013733 ms
2022-09-21 23:35:17 INFO  Done!
2022-09-21 23:35:17 INFO  # Finished -- repetition 1 of 7 
2022-09-21 23:35:17 INFO  # Optimization benchmark for data_cleaning with args [['reviews', 'fast_loading', 'featurization_1', 'logistic_regression']] -- repetition 2 of 7
2022-09-21 23:35:17 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-21 23:35:17 INFO  Running instrumented original pipeline...
2022-09-21 23:35:17 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-21 23:35:17 INFO  ---RUNTIME: Importing and monkey-patching took 6.065607070922852 ms
2022-09-21 23:35:24 INFO  ---RUNTIME: Original pipeline execution took 7250.285863876343 ms (excluding imports and monkey-patching)
2022-09-21 23:35:24 INFO  Starting execution of 1 what-if analyses...
2022-09-21 23:35:24 INFO  Start plan generation for analysis DataCleaning...
2022-09-21 23:35:24 INFO  ---RUNTIME: Plan generation took 0.9264945983886719 ms
2022-09-21 23:35:24 INFO  Estimated runtime of original DAG is 4940.593004226685ms
2022-09-21 23:35:24 INFO  Performing Multi-Query Optimization
2022-09-21 23:35:24 INFO  Estimated unoptimized what-if runtime is 98811.86008453369ms
2022-09-21 23:35:24 INFO  Estimated optimised what-if runtime is 19430.410861968994ms
2022-09-21 23:35:24 INFO  Estimated optimisation runtime saving is 79381.4492225647ms
2022-09-21 23:35:24 INFO  ---RUNTIME: Multi-Query Optimization took 133.64005088806152 ms
2022-09-21 23:35:24 INFO  Executing generated plans
2022-09-21 23:35:50 INFO  ---RUNTIME: Execution took 25658.987760543823 ms
2022-09-21 23:35:50 INFO  Done!
2022-09-21 23:35:50 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-21 23:35:50 INFO  Running instrumented original pipeline...
2022-09-21 23:35:50 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-21 23:35:50 INFO  ---RUNTIME: Importing and monkey-patching took 6.242036819458008 ms
2022-09-21 23:35:57 INFO  ---RUNTIME: Original pipeline execution took 7240.402698516846 ms (excluding imports and monkey-patching)
2022-09-21 23:35:57 INFO  Starting execution of 1 what-if analyses...
2022-09-21 23:35:57 INFO  Start plan generation for analysis DataCleaning...
2022-09-21 23:35:57 INFO  ---RUNTIME: Plan generation took 0.6246566772460938 ms
2022-09-21 23:35:57 INFO  Estimated runtime of original DAG is 5004.881858825684ms
2022-09-21 23:35:57 WARNING Skipping Multi-Query Optimization (instead, only applying patches)
2022-09-21 23:35:57 WARNING Columns ['review_id'] not present in train DAG after the train test split, only before!
2022-09-21 23:35:57 WARNING This could hint at data leakage!
2022-09-21 23:35:57 INFO  Estimated unoptimised what-if runtime is 100097.63717651367ms
2022-09-21 23:35:57 INFO  ---RUNTIME: Multi-Query Optimization took 23.369550704956055 ms
2022-09-21 23:35:57 INFO  Executing generated plans
2022-09-21 23:38:00 INFO  ---RUNTIME: Execution took 122945.36328315735 ms
2022-09-21 23:38:00 INFO  Done!
2022-09-21 23:38:00 INFO  # Finished -- repetition 2 of 7 
2022-09-21 23:38:00 INFO  # Optimization benchmark for data_cleaning with args [['reviews', 'fast_loading', 'featurization_1', 'logistic_regression']] -- repetition 3 of 7
2022-09-21 23:38:00 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-21 23:38:00 INFO  Running instrumented original pipeline...
2022-09-21 23:38:00 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-21 23:38:00 INFO  ---RUNTIME: Importing and monkey-patching took 6.01506233215332 ms
2022-09-21 23:38:07 INFO  ---RUNTIME: Original pipeline execution took 7171.303033828735 ms (excluding imports and monkey-patching)
2022-09-21 23:38:07 INFO  Starting execution of 1 what-if analyses...
2022-09-21 23:38:07 INFO  Start plan generation for analysis DataCleaning...
2022-09-21 23:38:07 INFO  ---RUNTIME: Plan generation took 0.6699562072753906 ms
2022-09-21 23:38:07 INFO  Estimated runtime of original DAG is 4944.601774215698ms
2022-09-21 23:38:07 INFO  Performing Multi-Query Optimization
2022-09-21 23:38:07 INFO  Estimated unoptimized what-if runtime is 98892.03548431396ms
2022-09-21 23:38:07 INFO  Estimated optimised what-if runtime is 19746.666431427002ms
2022-09-21 23:38:07 INFO  Estimated optimisation runtime saving is 79145.36905288696ms
2022-09-21 23:38:07 INFO  ---RUNTIME: Multi-Query Optimization took 313.2357597351074 ms
2022-09-21 23:38:07 INFO  Executing generated plans
2022-09-21 23:38:33 INFO  ---RUNTIME: Execution took 25763.34571838379 ms
2022-09-21 23:38:33 INFO  Done!
2022-09-21 23:38:33 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-21 23:38:33 INFO  Running instrumented original pipeline...
2022-09-21 23:38:33 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-21 23:38:33 INFO  ---RUNTIME: Importing and monkey-patching took 6.184577941894531 ms
2022-09-21 23:38:41 INFO  ---RUNTIME: Original pipeline execution took 7290.903329849243 ms (excluding imports and monkey-patching)
2022-09-21 23:38:41 INFO  Starting execution of 1 what-if analyses...
2022-09-21 23:38:41 INFO  Start plan generation for analysis DataCleaning...
2022-09-21 23:38:41 INFO  ---RUNTIME: Plan generation took 0.6518363952636719 ms
2022-09-21 23:38:41 INFO  Estimated runtime of original DAG is 5031.270742416382ms
2022-09-21 23:38:41 WARNING Skipping Multi-Query Optimization (instead, only applying patches)
2022-09-21 23:38:41 WARNING Columns ['review_id'] not present in train DAG after the train test split, only before!
2022-09-21 23:38:41 WARNING This could hint at data leakage!
2022-09-21 23:38:41 INFO  Estimated unoptimised what-if runtime is 100625.41484832764ms
2022-09-21 23:38:41 INFO  ---RUNTIME: Multi-Query Optimization took 23.82040023803711 ms
2022-09-21 23:38:41 INFO  Executing generated plans
2022-09-21 23:40:43 INFO  ---RUNTIME: Execution took 122228.09934616089 ms
2022-09-21 23:40:43 INFO  Done!
2022-09-21 23:40:43 INFO  # Finished -- repetition 3 of 7 
2022-09-21 23:40:43 INFO  # Optimization benchmark for data_cleaning with args [['reviews', 'fast_loading', 'featurization_1', 'logistic_regression']] -- repetition 4 of 7
2022-09-21 23:40:43 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-21 23:40:43 INFO  Running instrumented original pipeline...
2022-09-21 23:40:43 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-21 23:40:43 INFO  ---RUNTIME: Importing and monkey-patching took 5.934000015258789 ms
2022-09-21 23:40:50 INFO  ---RUNTIME: Original pipeline execution took 7049.96657371521 ms (excluding imports and monkey-patching)
2022-09-21 23:40:50 INFO  Starting execution of 1 what-if analyses...
2022-09-21 23:40:50 INFO  Start plan generation for analysis DataCleaning...
2022-09-21 23:40:50 INFO  ---RUNTIME: Plan generation took 0.6563663482666016 ms
2022-09-21 23:40:50 INFO  Estimated runtime of original DAG is 4849.12633895874ms
2022-09-21 23:40:50 INFO  Performing Multi-Query Optimization
2022-09-21 23:40:50 INFO  Estimated unoptimized what-if runtime is 96982.5267791748ms
2022-09-21 23:40:50 INFO  Estimated optimised what-if runtime is 18747.565984725952ms
2022-09-21 23:40:50 INFO  Estimated optimisation runtime saving is 78234.96079444885ms
2022-09-21 23:40:50 INFO  ---RUNTIME: Multi-Query Optimization took 91.5384292602539 ms
2022-09-21 23:40:50 INFO  Executing generated plans
2022-09-21 23:41:15 INFO  ---RUNTIME: Execution took 25018.179178237915 ms
2022-09-21 23:41:15 INFO  Done!
2022-09-21 23:41:15 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-21 23:41:15 INFO  Running instrumented original pipeline...
2022-09-21 23:41:15 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-21 23:41:15 INFO  ---RUNTIME: Importing and monkey-patching took 5.910158157348633 ms
2022-09-21 23:41:22 INFO  ---RUNTIME: Original pipeline execution took 7010.2643966674805 ms (excluding imports and monkey-patching)
2022-09-21 23:41:22 INFO  Starting execution of 1 what-if analyses...
2022-09-21 23:41:22 INFO  Start plan generation for analysis DataCleaning...
2022-09-21 23:41:22 INFO  ---RUNTIME: Plan generation took 0.6270408630371094 ms
2022-09-21 23:41:22 INFO  Estimated runtime of original DAG is 4813.056707382202ms
2022-09-21 23:41:22 WARNING Skipping Multi-Query Optimization (instead, only applying patches)
2022-09-21 23:41:22 WARNING Columns ['review_id'] not present in train DAG after the train test split, only before!
2022-09-21 23:41:22 WARNING This could hint at data leakage!
2022-09-21 23:41:22 INFO  Estimated unoptimised what-if runtime is 96261.13414764404ms
2022-09-21 23:41:22 INFO  ---RUNTIME: Multi-Query Optimization took 23.517131805419922 ms
2022-09-21 23:41:22 INFO  Executing generated plans
2022-09-21 23:43:22 INFO  ---RUNTIME: Execution took 119998.08311462402 ms
2022-09-21 23:43:22 INFO  Done!
2022-09-21 23:43:22 INFO  # Finished -- repetition 4 of 7 
2022-09-21 23:43:22 INFO  # Optimization benchmark for data_cleaning with args [['reviews', 'fast_loading', 'featurization_1', 'logistic_regression']] -- repetition 5 of 7
2022-09-21 23:43:22 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-21 23:43:22 INFO  Running instrumented original pipeline...
2022-09-21 23:43:22 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-21 23:43:22 INFO  ---RUNTIME: Importing and monkey-patching took 6.0062408447265625 ms
2022-09-21 23:43:29 INFO  ---RUNTIME: Original pipeline execution took 7034.496307373047 ms (excluding imports and monkey-patching)
2022-09-21 23:43:29 INFO  Starting execution of 1 what-if analyses...
2022-09-21 23:43:29 INFO  Start plan generation for analysis DataCleaning...
2022-09-21 23:43:29 INFO  ---RUNTIME: Plan generation took 0.6575584411621094 ms
2022-09-21 23:43:29 INFO  Estimated runtime of original DAG is 4844.84601020813ms
2022-09-21 23:43:29 INFO  Performing Multi-Query Optimization
2022-09-21 23:43:29 INFO  Estimated unoptimized what-if runtime is 96896.9202041626ms
2022-09-21 23:43:29 INFO  Estimated optimised what-if runtime is 18717.56410598755ms
2022-09-21 23:43:29 INFO  Estimated optimisation runtime saving is 78179.35609817505ms
2022-09-21 23:43:29 INFO  ---RUNTIME: Multi-Query Optimization took 93.3525562286377 ms
2022-09-21 23:43:29 INFO  Executing generated plans
2022-09-21 23:43:54 INFO  ---RUNTIME: Execution took 25071.379899978638 ms
2022-09-21 23:43:54 INFO  Done!
2022-09-21 23:43:54 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-21 23:43:54 INFO  Running instrumented original pipeline...
2022-09-21 23:43:54 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-21 23:43:54 INFO  ---RUNTIME: Importing and monkey-patching took 6.01649284362793 ms
2022-09-21 23:44:01 INFO  ---RUNTIME: Original pipeline execution took 7037.417411804199 ms (excluding imports and monkey-patching)
2022-09-21 23:44:01 INFO  Starting execution of 1 what-if analyses...
2022-09-21 23:44:01 INFO  Start plan generation for analysis DataCleaning...
2022-09-21 23:44:01 INFO  ---RUNTIME: Plan generation took 0.6334781646728516 ms
2022-09-21 23:44:01 INFO  Estimated runtime of original DAG is 4849.969148635864ms
2022-09-21 23:44:01 WARNING Skipping Multi-Query Optimization (instead, only applying patches)
2022-09-21 23:44:01 WARNING Columns ['review_id'] not present in train DAG after the train test split, only before!
2022-09-21 23:44:01 WARNING This could hint at data leakage!
2022-09-21 23:44:01 INFO  Estimated unoptimised what-if runtime is 96999.38297271729ms
2022-09-21 23:44:01 INFO  ---RUNTIME: Multi-Query Optimization took 23.383617401123047 ms
2022-09-21 23:44:01 INFO  Executing generated plans
2022-09-21 23:46:02 INFO  ---RUNTIME: Execution took 120247.44582176208 ms
2022-09-21 23:46:02 INFO  Done!
2022-09-21 23:46:02 INFO  # Finished -- repetition 5 of 7 
2022-09-21 23:46:02 INFO  # Optimization benchmark for data_cleaning with args [['reviews', 'fast_loading', 'featurization_1', 'logistic_regression']] -- repetition 6 of 7
2022-09-21 23:46:02 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-21 23:46:02 INFO  Running instrumented original pipeline...
2022-09-21 23:46:02 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-21 23:46:02 INFO  ---RUNTIME: Importing and monkey-patching took 6.960391998291016 ms
2022-09-21 23:46:09 INFO  ---RUNTIME: Original pipeline execution took 7365.048885345459 ms (excluding imports and monkey-patching)
2022-09-21 23:46:09 INFO  Starting execution of 1 what-if analyses...
2022-09-21 23:46:09 INFO  Start plan generation for analysis DataCleaning...
2022-09-21 23:46:09 INFO  ---RUNTIME: Plan generation took 0.6062984466552734 ms
2022-09-21 23:46:09 INFO  Estimated runtime of original DAG is 4874.452829360962ms
2022-09-21 23:46:09 INFO  Performing Multi-Query Optimization
2022-09-21 23:46:09 INFO  Estimated unoptimized what-if runtime is 97489.05658721924ms
2022-09-21 23:46:09 INFO  Estimated optimised what-if runtime is 18691.03980064392ms
2022-09-21 23:46:09 INFO  Estimated optimisation runtime saving is 78798.01678657532ms
2022-09-21 23:46:09 INFO  ---RUNTIME: Multi-Query Optimization took 91.07708930969238 ms
2022-09-21 23:46:09 INFO  Executing generated plans
2022-09-21 23:46:34 INFO  ---RUNTIME: Execution took 25211.71808242798 ms
2022-09-21 23:46:34 INFO  Done!
2022-09-21 23:46:34 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-21 23:46:34 INFO  Running instrumented original pipeline...
2022-09-21 23:46:34 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-21 23:46:34 INFO  ---RUNTIME: Importing and monkey-patching took 6.041765213012695 ms
2022-09-21 23:46:41 INFO  ---RUNTIME: Original pipeline execution took 7155.096530914307 ms (excluding imports and monkey-patching)
2022-09-21 23:46:41 INFO  Starting execution of 1 what-if analyses...
2022-09-21 23:46:41 INFO  Start plan generation for analysis DataCleaning...
2022-09-21 23:46:41 INFO  ---RUNTIME: Plan generation took 0.6380081176757812 ms
2022-09-21 23:46:41 INFO  Estimated runtime of original DAG is 4897.575855255127ms
2022-09-21 23:46:41 WARNING Skipping Multi-Query Optimization (instead, only applying patches)
2022-09-21 23:46:41 WARNING Columns ['review_id'] not present in train DAG after the train test split, only before!
2022-09-21 23:46:41 WARNING This could hint at data leakage!
2022-09-21 23:46:41 INFO  Estimated unoptimised what-if runtime is 97951.51710510254ms
2022-09-21 23:46:41 INFO  ---RUNTIME: Multi-Query Optimization took 22.80902862548828 ms
2022-09-21 23:46:41 INFO  Executing generated plans
2022-09-21 23:48:43 INFO  ---RUNTIME: Execution took 121304.06594276428 ms
2022-09-21 23:48:43 INFO  Done!
2022-09-21 23:48:43 INFO  # Finished -- repetition 6 of 7 
2022-09-21 23:48:43 INFO  # Optimization benchmark for data_cleaning with args [['reviews', 'fast_loading', 'featurization_1', 'logistic_regression']] -- repetition 7 of 7
2022-09-21 23:48:43 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-21 23:48:43 INFO  Running instrumented original pipeline...
2022-09-21 23:48:43 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-21 23:48:43 INFO  ---RUNTIME: Importing and monkey-patching took 6.03795051574707 ms
2022-09-21 23:48:50 INFO  ---RUNTIME: Original pipeline execution took 7121.759653091431 ms (excluding imports and monkey-patching)
2022-09-21 23:48:50 INFO  Starting execution of 1 what-if analyses...
2022-09-21 23:48:50 INFO  Start plan generation for analysis DataCleaning...
2022-09-21 23:48:50 INFO  ---RUNTIME: Plan generation took 0.6458759307861328 ms
2022-09-21 23:48:50 INFO  Estimated runtime of original DAG is 4870.189428329468ms
2022-09-21 23:48:50 INFO  Performing Multi-Query Optimization
2022-09-21 23:48:50 INFO  Estimated unoptimized what-if runtime is 97403.78856658936ms
2022-09-21 23:48:50 INFO  Estimated optimised what-if runtime is 18715.94786643982ms
2022-09-21 23:48:50 INFO  Estimated optimisation runtime saving is 78687.84070014954ms
2022-09-21 23:48:50 INFO  ---RUNTIME: Multi-Query Optimization took 91.58444404602051 ms
2022-09-21 23:48:50 INFO  Executing generated plans
2022-09-21 23:49:15 INFO  ---RUNTIME: Execution took 25157.806873321533 ms
2022-09-21 23:49:15 INFO  Done!
2022-09-21 23:49:15 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-21 23:49:15 INFO  Running instrumented original pipeline...
2022-09-21 23:49:15 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-21 23:49:15 INFO  ---RUNTIME: Importing and monkey-patching took 5.676746368408203 ms
2022-09-21 23:49:22 INFO  ---RUNTIME: Original pipeline execution took 7098.1605052948 ms (excluding imports and monkey-patching)
2022-09-21 23:49:22 INFO  Starting execution of 1 what-if analyses...
2022-09-21 23:49:22 INFO  Start plan generation for analysis DataCleaning...
2022-09-21 23:49:22 INFO  ---RUNTIME: Plan generation took 0.6165504455566406 ms
2022-09-21 23:49:22 INFO  Estimated runtime of original DAG is 4863.313674926758ms
2022-09-21 23:49:22 WARNING Skipping Multi-Query Optimization (instead, only applying patches)
2022-09-21 23:49:22 WARNING Columns ['review_id'] not present in train DAG after the train test split, only before!
2022-09-21 23:49:22 WARNING This could hint at data leakage!
2022-09-21 23:49:22 INFO  Estimated unoptimised what-if runtime is 97266.27349853516ms
2022-09-21 23:49:22 INFO  ---RUNTIME: Multi-Query Optimization took 23.2851505279541 ms
2022-09-21 23:49:22 INFO  Executing generated plans
2022-09-21 23:51:23 INFO  ---RUNTIME: Execution took 120610.23211479187 ms
2022-09-21 23:51:23 INFO  Done!
2022-09-21 23:51:23 INFO  # Finished -- repetition 7 of 7 
2022-09-21 23:51:23 INFO  # Final results after all repetitions
2022-09-21 23:51:23 INFO     repetition  ... no_opt_what_if_execution_combined_model_training
0           0  ...                                      2453.972816
1           1  ...                                      2415.975571
2           2  ...                                      2409.517527
3           3  ...                                      2344.804525
4           4  ...                                      2354.639530
5           5  ...                                      2324.289083
6           6  ...                                      2335.451603

[7 rows x 26 columns]
taskset -c 160-167 PROTOCOL_BUFFERS_PYTHON_IMPLEMENTATION=python python3.9 benchmarks_end_to_end.py data_cleaning reviews fast_loading featurization_1 xgboost
2022-09-21 23:51:25.575683: W tensorflow/stream_executor/platform/default/dso_loader.cc:64] Could not load dynamic library 'libcudart.so.11.0'; dlerror: libcudart.so.11.0: cannot open shared object file: No such file or directory; LD_LIBRARY_PATH: /home/sgrafbe/mlwhatif/venv/lib/python3.9/site-packages/cv2/../../lib64:
2022-09-21 23:51:25.575732: I tensorflow/stream_executor/cuda/cudart_stub.cc:29] Ignore above cudart dlerror if you do not have a GPU set up on your machine.
2022-09-21 23:51:26 INFO  Patching sys.argv with ['mlwhatif', 'reviews', 'fast_loading', 'featurization_1', 'xgboost']
2022-09-21 23:51:26 INFO  Running instrumented original pipeline...
2022-09-21 23:51:26 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-21 23:51:27 INFO  ---RUNTIME: Importing and monkey-patching took 122.55096435546875 ms
2022-09-21 23:51:35 INFO  ---RUNTIME: Original pipeline execution took 8037.15443611145 ms (excluding imports and monkey-patching)
2022-09-21 23:51:35 INFO  Starting execution of 0 what-if analyses...
2022-09-21 23:51:35 INFO  Estimated runtime of original DAG is 5812.920808792114ms
2022-09-21 23:51:35 INFO  Performing Multi-Query Optimization
2022-09-21 23:51:35 INFO  Estimated unoptimized what-if runtime is 0ms
2022-09-21 23:51:35 INFO  Estimated optimised what-if runtime is 0ms
2022-09-21 23:51:35 INFO  Estimated optimisation runtime saving is 0ms
2022-09-21 23:51:35 INFO  ---RUNTIME: Multi-Query Optimization took 0.484466552734375 ms
2022-09-21 23:51:35 INFO  Executing generated plans
2022-09-21 23:51:35 INFO  ---RUNTIME: Execution took 0.025510787963867188 ms
2022-09-21 23:51:35 INFO  Done!
2022-09-21 23:51:35 INFO  # Optimization benchmark for data_cleaning with args [['reviews', 'fast_loading', 'featurization_1', 'xgboost']] -- repetition 1 of 7
2022-09-21 23:51:35 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-21 23:51:35 INFO  Running instrumented original pipeline...
2022-09-21 23:51:35 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-21 23:51:35 INFO  ---RUNTIME: Importing and monkey-patching took 6.037712097167969 ms
2022-09-21 23:51:43 INFO  ---RUNTIME: Original pipeline execution took 8109.616756439209 ms (excluding imports and monkey-patching)
2022-09-21 23:51:43 INFO  Starting execution of 1 what-if analyses...
2022-09-21 23:51:43 INFO  Start plan generation for analysis DataCleaning...
2022-09-21 23:51:43 INFO  ---RUNTIME: Plan generation took 0.6864070892333984 ms
2022-09-21 23:51:43 INFO  Estimated runtime of original DAG is 5732.710838317871ms
2022-09-21 23:51:43 INFO  Performing Multi-Query Optimization
2022-09-21 23:51:43 INFO  Estimated unoptimized what-if runtime is 114654.21676635742ms
2022-09-21 23:51:43 INFO  Estimated optimised what-if runtime is 35706.70485496521ms
2022-09-21 23:51:43 INFO  Estimated optimisation runtime saving is 78947.51191139221ms
2022-09-21 23:51:43 INFO  ---RUNTIME: Multi-Query Optimization took 94.3758487701416 ms
2022-09-21 23:51:43 INFO  Executing generated plans
2022-09-21 23:52:26 INFO  ---RUNTIME: Execution took 43644.89674568176 ms
2022-09-21 23:52:26 INFO  Done!
2022-09-21 23:52:26 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-21 23:52:26 INFO  Running instrumented original pipeline...
2022-09-21 23:52:26 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-21 23:52:26 INFO  ---RUNTIME: Importing and monkey-patching took 6.197690963745117 ms
2022-09-21 23:52:34 INFO  ---RUNTIME: Original pipeline execution took 7954.53953742981 ms (excluding imports and monkey-patching)
2022-09-21 23:52:34 INFO  Starting execution of 1 what-if analyses...
2022-09-21 23:52:34 INFO  Start plan generation for analysis DataCleaning...
2022-09-21 23:52:34 INFO  ---RUNTIME: Plan generation took 0.6966590881347656 ms
2022-09-21 23:52:34 INFO  Estimated runtime of original DAG is 5750.542879104614ms
2022-09-21 23:52:34 WARNING Skipping Multi-Query Optimization (instead, only applying patches)
2022-09-21 23:52:34 WARNING Columns ['review_id'] not present in train DAG after the train test split, only before!
2022-09-21 23:52:34 WARNING This could hint at data leakage!
2022-09-21 23:52:34 INFO  Estimated unoptimised what-if runtime is 115010.85758209229ms
2022-09-21 23:52:34 INFO  ---RUNTIME: Multi-Query Optimization took 23.795366287231445 ms
2022-09-21 23:52:34 INFO  Executing generated plans
2022-09-21 23:54:54 INFO  ---RUNTIME: Execution took 139827.60882377625 ms
2022-09-21 23:54:54 INFO  Done!
2022-09-21 23:54:54 INFO  # Finished -- repetition 1 of 7 
2022-09-21 23:54:54 INFO  # Optimization benchmark for data_cleaning with args [['reviews', 'fast_loading', 'featurization_1', 'xgboost']] -- repetition 2 of 7
2022-09-21 23:54:54 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-21 23:54:54 INFO  Running instrumented original pipeline...
2022-09-21 23:54:54 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-21 23:54:54 INFO  ---RUNTIME: Importing and monkey-patching took 6.001710891723633 ms
2022-09-21 23:55:02 INFO  ---RUNTIME: Original pipeline execution took 7941.84422492981 ms (excluding imports and monkey-patching)
2022-09-21 23:55:02 INFO  Starting execution of 1 what-if analyses...
2022-09-21 23:55:02 INFO  Start plan generation for analysis DataCleaning...
2022-09-21 23:55:02 INFO  ---RUNTIME: Plan generation took 0.7162094116210938 ms
2022-09-21 23:55:02 INFO  Estimated runtime of original DAG is 5730.384826660156ms
2022-09-21 23:55:02 INFO  Performing Multi-Query Optimization
2022-09-21 23:55:02 INFO  Estimated unoptimized what-if runtime is 114607.69653320312ms
2022-09-21 23:55:02 INFO  Estimated optimised what-if runtime is 35614.84336853027ms
2022-09-21 23:55:02 INFO  Estimated optimisation runtime saving is 78992.85316467285ms
2022-09-21 23:55:02 INFO  ---RUNTIME: Multi-Query Optimization took 93.98531913757324 ms
2022-09-21 23:55:02 INFO  Executing generated plans
2022-09-21 23:55:46 INFO  ---RUNTIME: Execution took 43603.3833026886 ms
2022-09-21 23:55:46 INFO  Done!
2022-09-21 23:55:46 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-21 23:55:46 INFO  Running instrumented original pipeline...
2022-09-21 23:55:46 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-21 23:55:46 INFO  ---RUNTIME: Importing and monkey-patching took 5.948781967163086 ms
2022-09-21 23:55:54 INFO  ---RUNTIME: Original pipeline execution took 7957.622766494751 ms (excluding imports and monkey-patching)
2022-09-21 23:55:54 INFO  Starting execution of 1 what-if analyses...
2022-09-21 23:55:54 INFO  Start plan generation for analysis DataCleaning...
2022-09-21 23:55:54 INFO  ---RUNTIME: Plan generation took 0.6763935089111328 ms
2022-09-21 23:55:54 INFO  Estimated runtime of original DAG is 5754.005432128906ms
2022-09-21 23:55:54 WARNING Skipping Multi-Query Optimization (instead, only applying patches)
2022-09-21 23:55:54 WARNING Columns ['review_id'] not present in train DAG after the train test split, only before!
2022-09-21 23:55:54 WARNING This could hint at data leakage!
2022-09-21 23:55:54 INFO  Estimated unoptimised what-if runtime is 115080.10864257812ms
2022-09-21 23:55:54 INFO  ---RUNTIME: Multi-Query Optimization took 23.74553680419922 ms
2022-09-21 23:55:54 INFO  Executing generated plans
2022-09-21 23:58:14 INFO  ---RUNTIME: Execution took 140237.37359046936 ms
2022-09-21 23:58:14 INFO  Done!
2022-09-21 23:58:14 INFO  # Finished -- repetition 2 of 7 
2022-09-21 23:58:14 INFO  # Optimization benchmark for data_cleaning with args [['reviews', 'fast_loading', 'featurization_1', 'xgboost']] -- repetition 3 of 7
2022-09-21 23:58:14 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-21 23:58:14 INFO  Running instrumented original pipeline...
2022-09-21 23:58:14 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-21 23:58:14 INFO  ---RUNTIME: Importing and monkey-patching took 6.099462509155273 ms
2022-09-21 23:58:22 INFO  ---RUNTIME: Original pipeline execution took 7984.658479690552 ms (excluding imports and monkey-patching)
2022-09-21 23:58:22 INFO  Starting execution of 1 what-if analyses...
2022-09-21 23:58:22 INFO  Start plan generation for analysis DataCleaning...
2022-09-21 23:58:22 INFO  ---RUNTIME: Plan generation took 0.7054805755615234 ms
2022-09-21 23:58:22 INFO  Estimated runtime of original DAG is 5761.086702346802ms
2022-09-21 23:58:22 INFO  Performing Multi-Query Optimization
2022-09-21 23:58:22 INFO  Estimated unoptimized what-if runtime is 115221.73404693604ms
2022-09-21 23:58:22 INFO  Estimated optimised what-if runtime is 35686.97929382324ms
2022-09-21 23:58:22 INFO  Estimated optimisation runtime saving is 79534.7547531128ms
2022-09-21 23:58:22 INFO  ---RUNTIME: Multi-Query Optimization took 313.4160041809082 ms
2022-09-21 23:58:22 INFO  Executing generated plans
2022-09-21 23:59:06 INFO  ---RUNTIME: Execution took 43754.26435470581 ms
2022-09-21 23:59:06 INFO  Done!
2022-09-21 23:59:06 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-21 23:59:06 INFO  Running instrumented original pipeline...
2022-09-21 23:59:06 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-21 23:59:06 INFO  ---RUNTIME: Importing and monkey-patching took 6.262302398681641 ms
2022-09-21 23:59:14 INFO  ---RUNTIME: Original pipeline execution took 8051.644802093506 ms (excluding imports and monkey-patching)
2022-09-21 23:59:14 INFO  Starting execution of 1 what-if analyses...
2022-09-21 23:59:14 INFO  Start plan generation for analysis DataCleaning...
2022-09-21 23:59:14 INFO  ---RUNTIME: Plan generation took 0.7128715515136719 ms
2022-09-21 23:59:14 INFO  Estimated runtime of original DAG is 5804.052829742432ms
2022-09-21 23:59:14 WARNING Skipping Multi-Query Optimization (instead, only applying patches)
2022-09-21 23:59:14 WARNING Columns ['review_id'] not present in train DAG after the train test split, only before!
2022-09-21 23:59:14 WARNING This could hint at data leakage!
2022-09-21 23:59:14 INFO  Estimated unoptimised what-if runtime is 116081.05659484863ms
2022-09-21 23:59:14 INFO  ---RUNTIME: Multi-Query Optimization took 23.630857467651367 ms
2022-09-21 23:59:14 INFO  Executing generated plans
2022-09-22 00:01:35 INFO  ---RUNTIME: Execution took 140890.90943336487 ms
2022-09-22 00:01:35 INFO  Done!
2022-09-22 00:01:35 INFO  # Finished -- repetition 3 of 7 
2022-09-22 00:01:35 INFO  # Optimization benchmark for data_cleaning with args [['reviews', 'fast_loading', 'featurization_1', 'xgboost']] -- repetition 4 of 7
2022-09-22 00:01:35 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-22 00:01:35 INFO  Running instrumented original pipeline...
2022-09-22 00:01:35 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-22 00:01:35 INFO  ---RUNTIME: Importing and monkey-patching took 6.336688995361328 ms
2022-09-22 00:01:43 INFO  ---RUNTIME: Original pipeline execution took 7996.414422988892 ms (excluding imports and monkey-patching)
2022-09-22 00:01:43 INFO  Starting execution of 1 what-if analyses...
2022-09-22 00:01:43 INFO  Start plan generation for analysis DataCleaning...
2022-09-22 00:01:43 INFO  ---RUNTIME: Plan generation took 0.6875991821289062 ms
2022-09-22 00:01:43 INFO  Estimated runtime of original DAG is 5765.906572341919ms
2022-09-22 00:01:43 INFO  Performing Multi-Query Optimization
2022-09-22 00:01:43 INFO  Estimated unoptimized what-if runtime is 115318.13144683838ms
2022-09-22 00:01:43 INFO  Estimated optimised what-if runtime is 35591.84813499451ms
2022-09-22 00:01:43 INFO  Estimated optimisation runtime saving is 79726.28331184387ms
2022-09-22 00:01:43 INFO  ---RUNTIME: Multi-Query Optimization took 94.86889839172363 ms
2022-09-22 00:01:43 INFO  Executing generated plans
2022-09-22 00:02:27 INFO  ---RUNTIME: Execution took 43634.902477264404 ms
2022-09-22 00:02:27 INFO  Done!
2022-09-22 00:02:27 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-22 00:02:27 INFO  Running instrumented original pipeline...
2022-09-22 00:02:27 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-22 00:02:27 INFO  ---RUNTIME: Importing and monkey-patching took 6.088018417358398 ms
2022-09-22 00:02:35 INFO  ---RUNTIME: Original pipeline execution took 7967.51070022583 ms (excluding imports and monkey-patching)
2022-09-22 00:02:35 INFO  Starting execution of 1 what-if analyses...
2022-09-22 00:02:35 INFO  Start plan generation for analysis DataCleaning...
2022-09-22 00:02:35 INFO  ---RUNTIME: Plan generation took 0.6899833679199219 ms
2022-09-22 00:02:35 INFO  Estimated runtime of original DAG is 5764.315366744995ms
2022-09-22 00:02:35 WARNING Skipping Multi-Query Optimization (instead, only applying patches)
2022-09-22 00:02:35 WARNING Columns ['review_id'] not present in train DAG after the train test split, only before!
2022-09-22 00:02:35 WARNING This could hint at data leakage!
2022-09-22 00:02:35 INFO  Estimated unoptimised what-if runtime is 115286.3073348999ms
2022-09-22 00:02:35 INFO  ---RUNTIME: Multi-Query Optimization took 23.62537384033203 ms
2022-09-22 00:02:35 INFO  Executing generated plans
2022-09-22 00:04:59 INFO  ---RUNTIME: Execution took 144153.13816070557 ms
2022-09-22 00:04:59 INFO  Done!
2022-09-22 00:04:59 INFO  # Finished -- repetition 4 of 7 
2022-09-22 00:04:59 INFO  # Optimization benchmark for data_cleaning with args [['reviews', 'fast_loading', 'featurization_1', 'xgboost']] -- repetition 5 of 7
2022-09-22 00:04:59 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-22 00:04:59 INFO  Running instrumented original pipeline...
2022-09-22 00:04:59 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-22 00:04:59 INFO  ---RUNTIME: Importing and monkey-patching took 6.354093551635742 ms
2022-09-22 00:05:07 INFO  ---RUNTIME: Original pipeline execution took 8246.786832809448 ms (excluding imports and monkey-patching)
2022-09-22 00:05:07 INFO  Starting execution of 1 what-if analyses...
2022-09-22 00:05:07 INFO  Start plan generation for analysis DataCleaning...
2022-09-22 00:05:07 INFO  ---RUNTIME: Plan generation took 0.7207393646240234 ms
2022-09-22 00:05:07 INFO  Estimated runtime of original DAG is 5819.735288619995ms
2022-09-22 00:05:07 INFO  Performing Multi-Query Optimization
2022-09-22 00:05:07 INFO  Estimated unoptimized what-if runtime is 116394.7057723999ms
2022-09-22 00:05:07 INFO  Estimated optimised what-if runtime is 36852.20956802368ms
2022-09-22 00:05:07 INFO  Estimated optimisation runtime saving is 79542.49620437622ms
2022-09-22 00:05:07 INFO  ---RUNTIME: Multi-Query Optimization took 94.9091911315918 ms
2022-09-22 00:05:07 INFO  Executing generated plans
2022-09-22 00:05:52 INFO  ---RUNTIME: Execution took 44896.64363861084 ms
2022-09-22 00:05:52 INFO  Done!
2022-09-22 00:05:52 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-22 00:05:52 INFO  Running instrumented original pipeline...
2022-09-22 00:05:52 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-22 00:05:52 INFO  ---RUNTIME: Importing and monkey-patching took 9.77778434753418 ms
2022-09-22 00:06:01 INFO  ---RUNTIME: Original pipeline execution took 8270.067691802979 ms (excluding imports and monkey-patching)
2022-09-22 00:06:01 INFO  Starting execution of 1 what-if analyses...
2022-09-22 00:06:01 INFO  Start plan generation for analysis DataCleaning...
2022-09-22 00:06:01 INFO  ---RUNTIME: Plan generation took 0.6937980651855469 ms
2022-09-22 00:06:01 INFO  Estimated runtime of original DAG is 6020.342588424683ms
2022-09-22 00:06:01 WARNING Skipping Multi-Query Optimization (instead, only applying patches)
2022-09-22 00:06:01 WARNING Columns ['review_id'] not present in train DAG after the train test split, only before!
2022-09-22 00:06:01 WARNING This could hint at data leakage!
2022-09-22 00:06:01 INFO  Estimated unoptimised what-if runtime is 120406.85176849365ms
2022-09-22 00:06:01 INFO  ---RUNTIME: Multi-Query Optimization took 23.819684982299805 ms
2022-09-22 00:06:01 INFO  Executing generated plans
2022-09-22 00:08:26 INFO  ---RUNTIME: Execution took 145363.0084991455 ms
2022-09-22 00:08:26 INFO  Done!
2022-09-22 00:08:26 INFO  # Finished -- repetition 5 of 7 
2022-09-22 00:08:26 INFO  # Optimization benchmark for data_cleaning with args [['reviews', 'fast_loading', 'featurization_1', 'xgboost']] -- repetition 6 of 7
2022-09-22 00:08:26 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-22 00:08:26 INFO  Running instrumented original pipeline...
2022-09-22 00:08:26 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-22 00:08:26 INFO  ---RUNTIME: Importing and monkey-patching took 6.272077560424805 ms
2022-09-22 00:08:35 INFO  ---RUNTIME: Original pipeline execution took 8677.42919921875 ms (excluding imports and monkey-patching)
2022-09-22 00:08:35 INFO  Starting execution of 1 what-if analyses...
2022-09-22 00:08:35 INFO  Start plan generation for analysis DataCleaning...
2022-09-22 00:08:35 INFO  ---RUNTIME: Plan generation took 0.6756782531738281 ms
2022-09-22 00:08:35 INFO  Estimated runtime of original DAG is 5931.170701980591ms
2022-09-22 00:08:35 INFO  Performing Multi-Query Optimization
2022-09-22 00:08:35 INFO  Estimated unoptimized what-if runtime is 118623.41403961182ms
2022-09-22 00:08:35 INFO  Estimated optimised what-if runtime is 35574.477195739746ms
2022-09-22 00:08:35 INFO  Estimated optimisation runtime saving is 83048.93684387207ms
2022-09-22 00:08:35 INFO  ---RUNTIME: Multi-Query Optimization took 95.3676700592041 ms
2022-09-22 00:08:35 INFO  Executing generated plans
2022-09-22 00:09:20 INFO  ---RUNTIME: Execution took 44952.62098312378 ms
2022-09-22 00:09:20 INFO  Done!
2022-09-22 00:09:20 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-22 00:09:20 INFO  Running instrumented original pipeline...
2022-09-22 00:09:20 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-22 00:09:20 INFO  ---RUNTIME: Importing and monkey-patching took 5.901813507080078 ms
2022-09-22 00:09:28 INFO  ---RUNTIME: Original pipeline execution took 8279.48546409607 ms (excluding imports and monkey-patching)
2022-09-22 00:09:28 INFO  Starting execution of 1 what-if analyses...
2022-09-22 00:09:28 INFO  Start plan generation for analysis DataCleaning...
2022-09-22 00:09:28 INFO  ---RUNTIME: Plan generation took 0.6587505340576172 ms
2022-09-22 00:09:28 INFO  Estimated runtime of original DAG is 5996.402025222778ms
2022-09-22 00:09:28 WARNING Skipping Multi-Query Optimization (instead, only applying patches)
2022-09-22 00:09:28 WARNING Columns ['review_id'] not present in train DAG after the train test split, only before!
2022-09-22 00:09:28 WARNING This could hint at data leakage!
2022-09-22 00:09:28 INFO  Estimated unoptimised what-if runtime is 119928.04050445557ms
2022-09-22 00:09:28 INFO  ---RUNTIME: Multi-Query Optimization took 23.568153381347656 ms
2022-09-22 00:09:28 INFO  Executing generated plans
2022-09-22 00:11:54 INFO  ---RUNTIME: Execution took 146166.92447662354 ms
2022-09-22 00:11:54 INFO  Done!
2022-09-22 00:11:54 INFO  # Finished -- repetition 6 of 7 
2022-09-22 00:11:54 INFO  # Optimization benchmark for data_cleaning with args [['reviews', 'fast_loading', 'featurization_1', 'xgboost']] -- repetition 7 of 7
2022-09-22 00:11:54 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-22 00:11:54 INFO  Running instrumented original pipeline...
2022-09-22 00:11:54 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-22 00:11:54 INFO  ---RUNTIME: Importing and monkey-patching took 6.197690963745117 ms
2022-09-22 00:12:03 INFO  ---RUNTIME: Original pipeline execution took 8333.644390106201 ms (excluding imports and monkey-patching)
2022-09-22 00:12:03 INFO  Starting execution of 1 what-if analyses...
2022-09-22 00:12:03 INFO  Start plan generation for analysis DataCleaning...
2022-09-22 00:12:03 INFO  ---RUNTIME: Plan generation took 0.7290840148925781 ms
2022-09-22 00:12:03 INFO  Estimated runtime of original DAG is 5916.934251785278ms
2022-09-22 00:12:03 INFO  Performing Multi-Query Optimization
2022-09-22 00:12:03 INFO  Estimated unoptimized what-if runtime is 118338.68503570557ms
2022-09-22 00:12:03 INFO  Estimated optimised what-if runtime is 36299.27039146423ms
2022-09-22 00:12:03 INFO  Estimated optimisation runtime saving is 82039.41464424133ms
2022-09-22 00:12:03 INFO  ---RUNTIME: Multi-Query Optimization took 94.33770179748535 ms
2022-09-22 00:12:03 INFO  Executing generated plans
2022-09-22 00:12:48 INFO  ---RUNTIME: Execution took 45017.1422958374 ms
2022-09-22 00:12:48 INFO  Done!
2022-09-22 00:12:48 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-22 00:12:48 INFO  Running instrumented original pipeline...
2022-09-22 00:12:48 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-22 00:12:48 INFO  ---RUNTIME: Importing and monkey-patching took 6.56890869140625 ms
2022-09-22 00:12:56 INFO  ---RUNTIME: Original pipeline execution took 8143.431901931763 ms (excluding imports and monkey-patching)
2022-09-22 00:12:56 INFO  Starting execution of 1 what-if analyses...
2022-09-22 00:12:56 INFO  Start plan generation for analysis DataCleaning...
2022-09-22 00:12:56 INFO  ---RUNTIME: Plan generation took 1.0790824890136719 ms
2022-09-22 00:12:56 INFO  Estimated runtime of original DAG is 5870.376825332642ms
2022-09-22 00:12:56 WARNING Skipping Multi-Query Optimization (instead, only applying patches)
2022-09-22 00:12:56 WARNING Columns ['review_id'] not present in train DAG after the train test split, only before!
2022-09-22 00:12:56 WARNING This could hint at data leakage!
2022-09-22 00:12:56 INFO  Estimated unoptimised what-if runtime is 117407.53650665283ms
2022-09-22 00:12:56 INFO  ---RUNTIME: Multi-Query Optimization took 33.393144607543945 ms
2022-09-22 00:12:56 INFO  Executing generated plans
2022-09-22 00:15:21 INFO  ---RUNTIME: Execution took 145131.4194202423 ms
2022-09-22 00:15:21 INFO  Done!
2022-09-22 00:15:21 INFO  # Finished -- repetition 7 of 7 
2022-09-22 00:15:21 INFO  # Final results after all repetitions
2022-09-22 00:15:21 INFO     repetition  ... no_opt_what_if_execution_combined_model_training
0           0  ...                                     19807.454824
1           1  ...                                     19914.418936
2           2  ...                                     19901.817083
3           3  ...                                     20266.411543
4           4  ...                                     19703.937531
5           5  ...                                     19432.846308
6           6  ...                                     20648.855686

[7 rows x 26 columns]
taskset -c 160-167 PROTOCOL_BUFFERS_PYTHON_IMPLEMENTATION=python python3.9 benchmarks_end_to_end.py data_cleaning reviews fast_loading featurization_1 neural_network
2022-09-22 00:15:23.706314: W tensorflow/stream_executor/platform/default/dso_loader.cc:64] Could not load dynamic library 'libcudart.so.11.0'; dlerror: libcudart.so.11.0: cannot open shared object file: No such file or directory; LD_LIBRARY_PATH: /home/sgrafbe/mlwhatif/venv/lib/python3.9/site-packages/cv2/../../lib64:
2022-09-22 00:15:23.706360: I tensorflow/stream_executor/cuda/cudart_stub.cc:29] Ignore above cudart dlerror if you do not have a GPU set up on your machine.
2022-09-22 00:15:25 INFO  Patching sys.argv with ['mlwhatif', 'reviews', 'fast_loading', 'featurization_1', 'neural_network']
2022-09-22 00:15:25 INFO  Running instrumented original pipeline...
2022-09-22 00:15:25 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-22 00:15:25 INFO  ---RUNTIME: Importing and monkey-patching took 122.5740909576416 ms
2022-09-22 00:15:31.250716: W tensorflow/stream_executor/platform/default/dso_loader.cc:64] Could not load dynamic library 'libcuda.so.1'; dlerror: libcuda.so.1: cannot open shared object file: No such file or directory; LD_LIBRARY_PATH: /home/sgrafbe/mlwhatif/venv/lib/python3.9/site-packages/cv2/../../lib64:
2022-09-22 00:15:31.250768: W tensorflow/stream_executor/cuda/cuda_driver.cc:326] failed call to cuInit: UNKNOWN ERROR (303)
2022-09-22 00:15:31.250798: I tensorflow/stream_executor/cuda/cuda_diagnostics.cc:156] kernel driver does not appear to be running on this host (angus): /proc/driver/nvidia/version does not exist
2022-09-22 00:15:31.251644: I tensorflow/core/platform/cpu_feature_guard.cc:142] This TensorFlow binary is optimized with oneAPI Deep Neural Network Library (oneDNN) to use the following CPU instructions in performance-critical operations:  AVX2 FMA
To enable them in other operations, rebuild TensorFlow with the appropriate compiler flags.
2022-09-22 00:15:31.618367: I tensorflow/compiler/mlir/mlir_graph_optimization_pass.cc:176] None of the MLIR Optimization Passes are enabled (registered 2)
2022-09-22 00:15:31.630196: I tensorflow/core/platform/profile_utils/cpu_utils.cc:114] CPU Frequency: 2595130000 Hz
2022-09-22 00:15:36 INFO  ---RUNTIME: Original pipeline execution took 11261.38973236084 ms (excluding imports and monkey-patching)
2022-09-22 00:15:36 INFO  Starting execution of 0 what-if analyses...
2022-09-22 00:15:36 INFO  Estimated runtime of original DAG is 8833.077430725098ms
2022-09-22 00:15:36 INFO  Performing Multi-Query Optimization
2022-09-22 00:15:36 INFO  Estimated unoptimized what-if runtime is 0ms
2022-09-22 00:15:36 INFO  Estimated optimised what-if runtime is 0ms
2022-09-22 00:15:36 INFO  Estimated optimisation runtime saving is 0ms
2022-09-22 00:15:36 INFO  ---RUNTIME: Multi-Query Optimization took 0.4706382751464844 ms
2022-09-22 00:15:36 INFO  Executing generated plans
2022-09-22 00:15:36 INFO  ---RUNTIME: Execution took 0.021219253540039062 ms
2022-09-22 00:15:36 INFO  Done!
2022-09-22 00:15:36 INFO  # Optimization benchmark for data_cleaning with args [['reviews', 'fast_loading', 'featurization_1', 'neural_network']] -- repetition 1 of 7
2022-09-22 00:15:36 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-22 00:15:36 INFO  Running instrumented original pipeline...
2022-09-22 00:15:36 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-22 00:15:36 INFO  ---RUNTIME: Importing and monkey-patching took 5.367755889892578 ms
2022-09-22 00:15:47 INFO  ---RUNTIME: Original pipeline execution took 11033.812046051025 ms (excluding imports and monkey-patching)
2022-09-22 00:15:47 INFO  Starting execution of 1 what-if analyses...
2022-09-22 00:15:47 INFO  Start plan generation for analysis DataCleaning...
2022-09-22 00:15:47 INFO  ---RUNTIME: Plan generation took 0.6096363067626953 ms
2022-09-22 00:15:47 INFO  Estimated runtime of original DAG is 8852.331638336182ms
2022-09-22 00:15:47 INFO  Performing Multi-Query Optimization
2022-09-22 00:15:47 INFO  Estimated unoptimized what-if runtime is 177046.63276672363ms
2022-09-22 00:15:47 INFO  Estimated optimised what-if runtime is 93363.7318611145ms
2022-09-22 00:15:47 INFO  Estimated optimisation runtime saving is 83682.90090560913ms
2022-09-22 00:15:47 INFO  ---RUNTIME: Multi-Query Optimization took 93.34421157836914 ms
2022-09-22 00:15:47 INFO  Executing generated plans
2022-09-22 00:17:27 INFO  ---RUNTIME: Execution took 100039.36171531677 ms
2022-09-22 00:17:27 INFO  Done!
2022-09-22 00:17:27 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-22 00:17:27 INFO  Running instrumented original pipeline...
2022-09-22 00:17:27 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-22 00:17:27 INFO  ---RUNTIME: Importing and monkey-patching took 5.927085876464844 ms
2022-09-22 00:17:38 INFO  ---RUNTIME: Original pipeline execution took 11032.346487045288 ms (excluding imports and monkey-patching)
2022-09-22 00:17:38 INFO  Starting execution of 1 what-if analyses...
2022-09-22 00:17:38 INFO  Start plan generation for analysis DataCleaning...
2022-09-22 00:17:38 INFO  ---RUNTIME: Plan generation took 0.6134510040283203 ms
2022-09-22 00:17:38 INFO  Estimated runtime of original DAG is 8682.942152023315ms
2022-09-22 00:17:38 WARNING Skipping Multi-Query Optimization (instead, only applying patches)
2022-09-22 00:17:38 WARNING Columns ['review_id'] not present in train DAG after the train test split, only before!
2022-09-22 00:17:38 WARNING This could hint at data leakage!
2022-09-22 00:17:38 INFO  Estimated unoptimised what-if runtime is 173658.8430404663ms
2022-09-22 00:17:38 INFO  ---RUNTIME: Multi-Query Optimization took 23.203372955322266 ms
2022-09-22 00:17:38 INFO  Executing generated plans
2022-09-22 00:20:57 INFO  ---RUNTIME: Execution took 198102.00881958008 ms
2022-09-22 00:20:57 INFO  Done!
2022-09-22 00:20:57 INFO  # Finished -- repetition 1 of 7 
2022-09-22 00:20:57 INFO  # Optimization benchmark for data_cleaning with args [['reviews', 'fast_loading', 'featurization_1', 'neural_network']] -- repetition 2 of 7
2022-09-22 00:20:57 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-22 00:20:57 INFO  Running instrumented original pipeline...
2022-09-22 00:20:57 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-22 00:20:57 INFO  ---RUNTIME: Importing and monkey-patching took 9.453535079956055 ms
2022-09-22 00:21:08 INFO  ---RUNTIME: Original pipeline execution took 11269.111156463623 ms (excluding imports and monkey-patching)
2022-09-22 00:21:08 INFO  Starting execution of 1 what-if analyses...
2022-09-22 00:21:08 INFO  Start plan generation for analysis DataCleaning...
2022-09-22 00:21:08 INFO  ---RUNTIME: Plan generation took 0.5602836608886719 ms
2022-09-22 00:21:08 INFO  Estimated runtime of original DAG is 9037.781953811646ms
2022-09-22 00:21:08 INFO  Performing Multi-Query Optimization
2022-09-22 00:21:08 INFO  Estimated unoptimized what-if runtime is 180755.6390762329ms
2022-09-22 00:21:08 INFO  Estimated optimised what-if runtime is 99662.60290145874ms
2022-09-22 00:21:08 INFO  Estimated optimisation runtime saving is 81093.03617477417ms
2022-09-22 00:21:08 INFO  ---RUNTIME: Multi-Query Optimization took 92.30566024780273 ms
2022-09-22 00:21:08 INFO  Executing generated plans
2022-09-22 00:22:47 INFO  ---RUNTIME: Execution took 99009.74559783936 ms
2022-09-22 00:22:47 INFO  Done!
2022-09-22 00:22:47 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-22 00:22:47 INFO  Running instrumented original pipeline...
2022-09-22 00:22:47 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-22 00:22:47 INFO  ---RUNTIME: Importing and monkey-patching took 6.297826766967773 ms
2022-09-22 00:22:58 INFO  ---RUNTIME: Original pipeline execution took 10974.292755126953 ms (excluding imports and monkey-patching)
2022-09-22 00:22:58 INFO  Starting execution of 1 what-if analyses...
2022-09-22 00:22:58 INFO  Start plan generation for analysis DataCleaning...
2022-09-22 00:22:58 INFO  ---RUNTIME: Plan generation took 0.5505084991455078 ms
2022-09-22 00:22:58 INFO  Estimated runtime of original DAG is 8794.061422348022ms
2022-09-22 00:22:58 WARNING Skipping Multi-Query Optimization (instead, only applying patches)
2022-09-22 00:22:58 WARNING Columns ['review_id'] not present in train DAG after the train test split, only before!
2022-09-22 00:22:58 WARNING This could hint at data leakage!
2022-09-22 00:22:58 INFO  Estimated unoptimised what-if runtime is 175881.22844696045ms
2022-09-22 00:22:58 INFO  ---RUNTIME: Multi-Query Optimization took 23.061275482177734 ms
2022-09-22 00:22:58 INFO  Executing generated plans
2022-09-22 00:26:17 INFO  ---RUNTIME: Execution took 198807.00206756592 ms
2022-09-22 00:26:17 INFO  Done!
2022-09-22 00:26:17 INFO  # Finished -- repetition 2 of 7 
2022-09-22 00:26:17 INFO  # Optimization benchmark for data_cleaning with args [['reviews', 'fast_loading', 'featurization_1', 'neural_network']] -- repetition 3 of 7
2022-09-22 00:26:17 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-22 00:26:17 INFO  Running instrumented original pipeline...
2022-09-22 00:26:17 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-22 00:26:17 INFO  ---RUNTIME: Importing and monkey-patching took 5.833625793457031 ms
2022-09-22 00:26:28 INFO  ---RUNTIME: Original pipeline execution took 11423.303842544556 ms (excluding imports and monkey-patching)
2022-09-22 00:26:28 INFO  Starting execution of 1 what-if analyses...
2022-09-22 00:26:28 INFO  Start plan generation for analysis DataCleaning...
2022-09-22 00:26:28 INFO  ---RUNTIME: Plan generation took 0.6124973297119141 ms
2022-09-22 00:26:28 INFO  Estimated runtime of original DAG is 9050.201416015625ms
2022-09-22 00:26:28 INFO  Performing Multi-Query Optimization
2022-09-22 00:26:28 INFO  Estimated unoptimized what-if runtime is 181004.0283203125ms
2022-09-22 00:26:28 INFO  Estimated optimised what-if runtime is 92654.61802482605ms
2022-09-22 00:26:28 INFO  Estimated optimisation runtime saving is 88349.41029548645ms
2022-09-22 00:26:28 INFO  ---RUNTIME: Multi-Query Optimization took 91.34268760681152 ms
2022-09-22 00:26:28 INFO  Executing generated plans
2022-09-22 00:28:08 INFO  ---RUNTIME: Execution took 99689.1222000122 ms
2022-09-22 00:28:08 INFO  Done!
2022-09-22 00:28:08 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-22 00:28:08 INFO  Running instrumented original pipeline...
2022-09-22 00:28:08 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-22 00:28:08 INFO  ---RUNTIME: Importing and monkey-patching took 6.383657455444336 ms
2022-09-22 00:28:19 INFO  ---RUNTIME: Original pipeline execution took 11290.149211883545 ms (excluding imports and monkey-patching)
2022-09-22 00:28:19 INFO  Starting execution of 1 what-if analyses...
2022-09-22 00:28:19 INFO  Start plan generation for analysis DataCleaning...
2022-09-22 00:28:19 INFO  ---RUNTIME: Plan generation took 0.6473064422607422 ms
2022-09-22 00:28:19 INFO  Estimated runtime of original DAG is 8996.54746055603ms
2022-09-22 00:28:19 WARNING Skipping Multi-Query Optimization (instead, only applying patches)
2022-09-22 00:28:19 WARNING Columns ['review_id'] not present in train DAG after the train test split, only before!
2022-09-22 00:28:19 WARNING This could hint at data leakage!
2022-09-22 00:28:19 INFO  Estimated unoptimised what-if runtime is 179930.9492111206ms
2022-09-22 00:28:19 INFO  ---RUNTIME: Multi-Query Optimization took 25.216102600097656 ms
2022-09-22 00:28:19 INFO  Executing generated plans
2022-09-22 00:31:37 INFO  ---RUNTIME: Execution took 197472.81503677368 ms
2022-09-22 00:31:37 INFO  Done!
2022-09-22 00:31:37 INFO  # Finished -- repetition 3 of 7 
2022-09-22 00:31:37 INFO  # Optimization benchmark for data_cleaning with args [['reviews', 'fast_loading', 'featurization_1', 'neural_network']] -- repetition 4 of 7
2022-09-22 00:31:37 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-22 00:31:37 INFO  Running instrumented original pipeline...
2022-09-22 00:31:37 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-22 00:31:37 INFO  ---RUNTIME: Importing and monkey-patching took 6.131410598754883 ms
2022-09-22 00:31:48 INFO  ---RUNTIME: Original pipeline execution took 11175.742626190186 ms (excluding imports and monkey-patching)
2022-09-22 00:31:48 INFO  Starting execution of 1 what-if analyses...
2022-09-22 00:31:48 INFO  Start plan generation for analysis DataCleaning...
2022-09-22 00:31:48 INFO  ---RUNTIME: Plan generation took 0.6194114685058594 ms
2022-09-22 00:31:48 INFO  Estimated runtime of original DAG is 8449.863910675049ms
2022-09-22 00:31:48 INFO  Performing Multi-Query Optimization
2022-09-22 00:31:48 INFO  Estimated unoptimized what-if runtime is 168997.27821350098ms
2022-09-22 00:31:48 INFO  Estimated optimised what-if runtime is 87562.58773803711ms
2022-09-22 00:31:48 INFO  Estimated optimisation runtime saving is 81434.69047546387ms
2022-09-22 00:31:48 INFO  ---RUNTIME: Multi-Query Optimization took 98.17862510681152 ms
2022-09-22 00:31:48 INFO  Executing generated plans
2022-09-22 00:33:27 INFO  ---RUNTIME: Execution took 99339.52116966248 ms
2022-09-22 00:33:27 INFO  Done!
2022-09-22 00:33:27 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-22 00:33:27 INFO  Running instrumented original pipeline...
2022-09-22 00:33:27 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-22 00:33:27 INFO  ---RUNTIME: Importing and monkey-patching took 5.8231353759765625 ms
2022-09-22 00:33:38 INFO  ---RUNTIME: Original pipeline execution took 10781.101942062378 ms (excluding imports and monkey-patching)
2022-09-22 00:33:38 INFO  Starting execution of 1 what-if analyses...
2022-09-22 00:33:38 INFO  Start plan generation for analysis DataCleaning...
2022-09-22 00:33:38 INFO  ---RUNTIME: Plan generation took 0.6010532379150391 ms
2022-09-22 00:33:38 INFO  Estimated runtime of original DAG is 8486.536741256714ms
2022-09-22 00:33:38 WARNING Skipping Multi-Query Optimization (instead, only applying patches)
2022-09-22 00:33:38 WARNING Columns ['review_id'] not present in train DAG after the train test split, only before!
2022-09-22 00:33:38 WARNING This could hint at data leakage!
2022-09-22 00:33:38 INFO  Estimated unoptimised what-if runtime is 169730.73482513428ms
2022-09-22 00:33:38 INFO  ---RUNTIME: Multi-Query Optimization took 23.233652114868164 ms
2022-09-22 00:33:38 INFO  Executing generated plans
2022-09-22 00:36:56 INFO  ---RUNTIME: Execution took 197765.48194885254 ms
2022-09-22 00:36:56 INFO  Done!
2022-09-22 00:36:56 INFO  # Finished -- repetition 4 of 7 
2022-09-22 00:36:56 INFO  # Optimization benchmark for data_cleaning with args [['reviews', 'fast_loading', 'featurization_1', 'neural_network']] -- repetition 5 of 7
2022-09-22 00:36:56 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-22 00:36:56 INFO  Running instrumented original pipeline...
2022-09-22 00:36:56 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-22 00:36:56 INFO  ---RUNTIME: Importing and monkey-patching took 6.14476203918457 ms
2022-09-22 00:37:07 INFO  ---RUNTIME: Original pipeline execution took 11078.382015228271 ms (excluding imports and monkey-patching)
2022-09-22 00:37:07 INFO  Starting execution of 1 what-if analyses...
2022-09-22 00:37:07 INFO  Start plan generation for analysis DataCleaning...
2022-09-22 00:37:07 INFO  ---RUNTIME: Plan generation took 0.6582736968994141 ms
2022-09-22 00:37:07 INFO  Estimated runtime of original DAG is 8782.751083374023ms
2022-09-22 00:37:07 INFO  Performing Multi-Query Optimization
2022-09-22 00:37:07 INFO  Estimated unoptimized what-if runtime is 175655.02166748047ms
2022-09-22 00:37:07 INFO  Estimated optimised what-if runtime is 93163.0208492279ms
2022-09-22 00:37:07 INFO  Estimated optimisation runtime saving is 82492.00081825256ms
2022-09-22 00:37:07 INFO  ---RUNTIME: Multi-Query Optimization took 98.53458404541016 ms
2022-09-22 00:37:07 INFO  Executing generated plans
2022-09-22 00:38:46 INFO  ---RUNTIME: Execution took 98592.47255325317 ms
2022-09-22 00:38:46 INFO  Done!
2022-09-22 00:38:46 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-22 00:38:46 INFO  Running instrumented original pipeline...
2022-09-22 00:38:46 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-22 00:38:46 INFO  ---RUNTIME: Importing and monkey-patching took 5.71751594543457 ms
2022-09-22 00:38:56 INFO  ---RUNTIME: Original pipeline execution took 10574.840307235718 ms (excluding imports and monkey-patching)
2022-09-22 00:38:56 INFO  Starting execution of 1 what-if analyses...
2022-09-22 00:38:56 INFO  Start plan generation for analysis DataCleaning...
2022-09-22 00:38:56 INFO  ---RUNTIME: Plan generation took 2.4144649505615234 ms
2022-09-22 00:38:56 INFO  Estimated runtime of original DAG is 8289.12377357483ms
2022-09-22 00:38:56 WARNING Skipping Multi-Query Optimization (instead, only applying patches)
2022-09-22 00:38:56 WARNING Columns ['review_id'] not present in train DAG after the train test split, only before!
2022-09-22 00:38:56 WARNING This could hint at data leakage!
2022-09-22 00:38:56 INFO  Estimated unoptimised what-if runtime is 165782.47547149658ms
2022-09-22 00:38:56 INFO  ---RUNTIME: Multi-Query Optimization took 23.29564094543457 ms
2022-09-22 00:38:56 INFO  Executing generated plans
2022-09-22 00:42:15 INFO  ---RUNTIME: Execution took 198285.06708145142 ms
2022-09-22 00:42:15 INFO  Done!
2022-09-22 00:42:15 INFO  # Finished -- repetition 5 of 7 
2022-09-22 00:42:15 INFO  # Optimization benchmark for data_cleaning with args [['reviews', 'fast_loading', 'featurization_1', 'neural_network']] -- repetition 6 of 7
2022-09-22 00:42:15 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-22 00:42:15 INFO  Running instrumented original pipeline...
2022-09-22 00:42:15 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-22 00:42:15 INFO  ---RUNTIME: Importing and monkey-patching took 5.903720855712891 ms
2022-09-22 00:42:26 INFO  ---RUNTIME: Original pipeline execution took 11039.418935775757 ms (excluding imports and monkey-patching)
2022-09-22 00:42:26 INFO  Starting execution of 1 what-if analyses...
2022-09-22 00:42:26 INFO  Start plan generation for analysis DataCleaning...
2022-09-22 00:42:26 INFO  ---RUNTIME: Plan generation took 0.6139278411865234 ms
2022-09-22 00:42:26 INFO  Estimated runtime of original DAG is 8751.045227050781ms
2022-09-22 00:42:26 INFO  Performing Multi-Query Optimization
2022-09-22 00:42:26 INFO  Estimated unoptimized what-if runtime is 175020.90454101562ms
2022-09-22 00:42:26 INFO  Estimated optimised what-if runtime is 95872.97892570496ms
2022-09-22 00:42:26 INFO  Estimated optimisation runtime saving is 79147.92561531067ms
2022-09-22 00:42:26 INFO  ---RUNTIME: Multi-Query Optimization took 91.40515327453613 ms
2022-09-22 00:42:26 INFO  Executing generated plans
2022-09-22 00:44:04 INFO  ---RUNTIME: Execution took 98036.86332702637 ms
2022-09-22 00:44:04 INFO  Done!
2022-09-22 00:44:04 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-22 00:44:04 INFO  Running instrumented original pipeline...
2022-09-22 00:44:04 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-22 00:44:04 INFO  ---RUNTIME: Importing and monkey-patching took 5.805015563964844 ms
2022-09-22 00:44:15 INFO  ---RUNTIME: Original pipeline execution took 10638.493537902832 ms (excluding imports and monkey-patching)
2022-09-22 00:44:15 INFO  Starting execution of 1 what-if analyses...
2022-09-22 00:44:15 INFO  Start plan generation for analysis DataCleaning...
2022-09-22 00:44:15 INFO  ---RUNTIME: Plan generation took 0.5450248718261719 ms
2022-09-22 00:44:15 INFO  Estimated runtime of original DAG is 8359.87401008606ms
2022-09-22 00:44:15 WARNING Skipping Multi-Query Optimization (instead, only applying patches)
2022-09-22 00:44:15 WARNING Columns ['review_id'] not present in train DAG after the train test split, only before!
2022-09-22 00:44:15 WARNING This could hint at data leakage!
2022-09-22 00:44:15 INFO  Estimated unoptimised what-if runtime is 167197.4802017212ms
2022-09-22 00:44:15 INFO  ---RUNTIME: Multi-Query Optimization took 24.2612361907959 ms
2022-09-22 00:44:15 INFO  Executing generated plans
2022-09-22 00:47:31 INFO  ---RUNTIME: Execution took 196655.62963485718 ms
2022-09-22 00:47:31 INFO  Done!
2022-09-22 00:47:31 INFO  # Finished -- repetition 6 of 7 
2022-09-22 00:47:31 INFO  # Optimization benchmark for data_cleaning with args [['reviews', 'fast_loading', 'featurization_1', 'neural_network']] -- repetition 7 of 7
2022-09-22 00:47:31 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-22 00:47:31 INFO  Running instrumented original pipeline...
2022-09-22 00:47:31 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-22 00:47:31 INFO  ---RUNTIME: Importing and monkey-patching took 6.114959716796875 ms
2022-09-22 00:47:42 INFO  ---RUNTIME: Original pipeline execution took 10933.336019515991 ms (excluding imports and monkey-patching)
2022-09-22 00:47:42 INFO  Starting execution of 1 what-if analyses...
2022-09-22 00:47:42 INFO  Start plan generation for analysis DataCleaning...
2022-09-22 00:47:42 INFO  ---RUNTIME: Plan generation took 0.6117820739746094 ms
2022-09-22 00:47:42 INFO  Estimated runtime of original DAG is 8668.160438537598ms
2022-09-22 00:47:42 INFO  Performing Multi-Query Optimization
2022-09-22 00:47:42 INFO  Estimated unoptimized what-if runtime is 173363.20877075195ms
2022-09-22 00:47:42 INFO  Estimated optimised what-if runtime is 93563.44270706177ms
2022-09-22 00:47:42 INFO  Estimated optimisation runtime saving is 79799.76606369019ms
2022-09-22 00:47:42 INFO  ---RUNTIME: Multi-Query Optimization took 90.98219871520996 ms
2022-09-22 00:47:42 INFO  Executing generated plans
2022-09-22 00:49:21 INFO  ---RUNTIME: Execution took 98653.68175506592 ms
2022-09-22 00:49:21 INFO  Done!
2022-09-22 00:49:21 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-22 00:49:21 INFO  Running instrumented original pipeline...
2022-09-22 00:49:21 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-22 00:49:21 INFO  ---RUNTIME: Importing and monkey-patching took 5.962371826171875 ms
2022-09-22 00:49:32 INFO  ---RUNTIME: Original pipeline execution took 10769.859552383423 ms (excluding imports and monkey-patching)
2022-09-22 00:49:32 INFO  Starting execution of 1 what-if analyses...
2022-09-22 00:49:32 INFO  Start plan generation for analysis DataCleaning...
2022-09-22 00:49:32 INFO  ---RUNTIME: Plan generation took 0.6422996520996094 ms
2022-09-22 00:49:32 INFO  Estimated runtime of original DAG is 8448.686361312866ms
2022-09-22 00:49:32 WARNING Skipping Multi-Query Optimization (instead, only applying patches)
2022-09-22 00:49:32 WARNING Columns ['review_id'] not present in train DAG after the train test split, only before!
2022-09-22 00:49:32 WARNING This could hint at data leakage!
2022-09-22 00:49:32 INFO  Estimated unoptimised what-if runtime is 168973.72722625732ms
2022-09-22 00:49:32 INFO  ---RUNTIME: Multi-Query Optimization took 23.6053466796875 ms
2022-09-22 00:49:32 INFO  Executing generated plans
2022-09-22 00:52:48 INFO  ---RUNTIME: Execution took 196510.84208488464 ms
2022-09-22 00:52:48 INFO  Done!
2022-09-22 00:52:48 INFO  # Finished -- repetition 7 of 7 
2022-09-22 00:52:48 INFO  # Final results after all repetitions
2022-09-22 00:52:48 INFO     repetition  ... no_opt_what_if_execution_combined_model_training
0           0  ...                                     67908.000708
1           1  ...                                     67625.060558
2           2  ...                                     67094.962597
3           3  ...                                     68231.230497
4           4  ...                                     67355.520964
5           5  ...                                     66812.591076
6           6  ...                                     67166.716337

[7 rows x 26 columns]
taskset -c 160-167 PROTOCOL_BUFFERS_PYTHON_IMPLEMENTATION=python python3.9 benchmarks_end_to_end.py data_cleaning reviews fast_loading featurization_2 logistic_regression
2022-09-22 00:52:51.192347: W tensorflow/stream_executor/platform/default/dso_loader.cc:64] Could not load dynamic library 'libcudart.so.11.0'; dlerror: libcudart.so.11.0: cannot open shared object file: No such file or directory; LD_LIBRARY_PATH: /home/sgrafbe/mlwhatif/venv/lib/python3.9/site-packages/cv2/../../lib64:
2022-09-22 00:52:51.192393: I tensorflow/stream_executor/cuda/cudart_stub.cc:29] Ignore above cudart dlerror if you do not have a GPU set up on your machine.
2022-09-22 00:52:52 INFO  Patching sys.argv with ['mlwhatif', 'reviews', 'fast_loading', 'featurization_2', 'logistic_regression']
2022-09-22 00:52:52 INFO  Running instrumented original pipeline...
2022-09-22 00:52:52 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-22 00:52:52 INFO  ---RUNTIME: Importing and monkey-patching took 122.02215194702148 ms
2022-09-22 00:52:59 INFO  ---RUNTIME: Original pipeline execution took 7010.417461395264 ms (excluding imports and monkey-patching)
2022-09-22 00:52:59 INFO  Starting execution of 0 what-if analyses...
2022-09-22 00:52:59 INFO  Estimated runtime of original DAG is 5725.4509925842285ms
2022-09-22 00:52:59 INFO  Performing Multi-Query Optimization
2022-09-22 00:52:59 INFO  Estimated unoptimized what-if runtime is 0ms
2022-09-22 00:52:59 INFO  Estimated optimised what-if runtime is 0ms
2022-09-22 00:52:59 INFO  Estimated optimisation runtime saving is 0ms
2022-09-22 00:52:59 INFO  ---RUNTIME: Multi-Query Optimization took 0.6501674652099609 ms
2022-09-22 00:52:59 INFO  Executing generated plans
2022-09-22 00:52:59 INFO  ---RUNTIME: Execution took 0.02956390380859375 ms
2022-09-22 00:52:59 INFO  Done!
2022-09-22 00:52:59 INFO  # Optimization benchmark for data_cleaning with args [['reviews', 'fast_loading', 'featurization_2', 'logistic_regression']] -- repetition 1 of 7
2022-09-22 00:52:59 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-22 00:52:59 INFO  Running instrumented original pipeline...
2022-09-22 00:52:59 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-22 00:52:59 INFO  ---RUNTIME: Importing and monkey-patching took 5.3958892822265625 ms
2022-09-22 00:53:06 INFO  ---RUNTIME: Original pipeline execution took 6809.1371059417725 ms (excluding imports and monkey-patching)
2022-09-22 00:53:06 INFO  Starting execution of 1 what-if analyses...
2022-09-22 00:53:06 INFO  Start plan generation for analysis DataCleaning...
2022-09-22 00:53:06 INFO  ---RUNTIME: Plan generation took 0.7114410400390625 ms
2022-09-22 00:53:06 INFO  Estimated runtime of original DAG is 5634.477138519287ms
2022-09-22 00:53:06 INFO  Performing Multi-Query Optimization
2022-09-22 00:53:06 INFO  Estimated unoptimized what-if runtime is 112689.54277038574ms
2022-09-22 00:53:06 INFO  Estimated optimised what-if runtime is 22861.44709587097ms
2022-09-22 00:53:06 INFO  Estimated optimisation runtime saving is 89828.09567451477ms
2022-09-22 00:53:06 INFO  ---RUNTIME: Multi-Query Optimization took 108.0925464630127 ms
2022-09-22 00:53:06 INFO  Executing generated plans
2022-09-22 00:53:37 INFO  ---RUNTIME: Execution took 30813.369035720825 ms
2022-09-22 00:53:37 INFO  Done!
2022-09-22 00:53:37 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-22 00:53:37 INFO  Running instrumented original pipeline...
2022-09-22 00:53:37 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-22 00:53:37 INFO  ---RUNTIME: Importing and monkey-patching took 6.227254867553711 ms
2022-09-22 00:53:44 INFO  ---RUNTIME: Original pipeline execution took 6704.287528991699 ms (excluding imports and monkey-patching)
2022-09-22 00:53:44 INFO  Starting execution of 1 what-if analyses...
2022-09-22 00:53:44 INFO  Start plan generation for analysis DataCleaning...
2022-09-22 00:53:44 INFO  ---RUNTIME: Plan generation took 0.7872581481933594 ms
2022-09-22 00:53:44 INFO  Estimated runtime of original DAG is 5522.716760635376ms
2022-09-22 00:53:44 WARNING Skipping Multi-Query Optimization (instead, only applying patches)
2022-09-22 00:53:44 WARNING Columns ['review_id'] not present in train DAG after the train test split, only before!
2022-09-22 00:53:44 WARNING This could hint at data leakage!
2022-09-22 00:53:44 INFO  Estimated unoptimised what-if runtime is 110454.33521270752ms
2022-09-22 00:53:44 INFO  ---RUNTIME: Multi-Query Optimization took 26.324748992919922 ms
2022-09-22 00:53:44 INFO  Executing generated plans
2022-09-22 00:56:00 INFO  ---RUNTIME: Execution took 136193.06802749634 ms
2022-09-22 00:56:00 INFO  Done!
2022-09-22 00:56:00 INFO  # Finished -- repetition 1 of 7 
2022-09-22 00:56:00 INFO  # Optimization benchmark for data_cleaning with args [['reviews', 'fast_loading', 'featurization_2', 'logistic_regression']] -- repetition 2 of 7
2022-09-22 00:56:00 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-22 00:56:00 INFO  Running instrumented original pipeline...
2022-09-22 00:56:00 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-22 00:56:00 INFO  ---RUNTIME: Importing and monkey-patching took 6.083011627197266 ms
2022-09-22 00:56:07 INFO  ---RUNTIME: Original pipeline execution took 6852.354526519775 ms (excluding imports and monkey-patching)
2022-09-22 00:56:07 INFO  Starting execution of 1 what-if analyses...
2022-09-22 00:56:07 INFO  Start plan generation for analysis DataCleaning...
2022-09-22 00:56:07 INFO  ---RUNTIME: Plan generation took 0.6473064422607422 ms
2022-09-22 00:56:07 INFO  Estimated runtime of original DAG is 5643.603324890137ms
2022-09-22 00:56:07 INFO  Performing Multi-Query Optimization
2022-09-22 00:56:07 INFO  Estimated unoptimized what-if runtime is 112872.06649780273ms
2022-09-22 00:56:07 INFO  Estimated optimised what-if runtime is 24068.753004074097ms
2022-09-22 00:56:07 INFO  Estimated optimisation runtime saving is 88803.31349372864ms
2022-09-22 00:56:07 INFO  ---RUNTIME: Multi-Query Optimization took 99.75004196166992 ms
2022-09-22 00:56:07 INFO  Executing generated plans
2022-09-22 00:56:37 INFO  ---RUNTIME: Execution took 30497.477531433105 ms
2022-09-22 00:56:37 INFO  Done!
2022-09-22 00:56:37 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-22 00:56:37 INFO  Running instrumented original pipeline...
2022-09-22 00:56:37 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-22 00:56:37 INFO  ---RUNTIME: Importing and monkey-patching took 5.684852600097656 ms
2022-09-22 00:56:44 INFO  ---RUNTIME: Original pipeline execution took 6786.104202270508 ms (excluding imports and monkey-patching)
2022-09-22 00:56:44 INFO  Starting execution of 1 what-if analyses...
2022-09-22 00:56:44 INFO  Start plan generation for analysis DataCleaning...
2022-09-22 00:56:44 INFO  ---RUNTIME: Plan generation took 0.7572174072265625 ms
2022-09-22 00:56:44 INFO  Estimated runtime of original DAG is 5594.275712966919ms
2022-09-22 00:56:44 WARNING Skipping Multi-Query Optimization (instead, only applying patches)
2022-09-22 00:56:44 WARNING Columns ['review_id'] not present in train DAG after the train test split, only before!
2022-09-22 00:56:44 WARNING This could hint at data leakage!
2022-09-22 00:56:44 INFO  Estimated unoptimised what-if runtime is 111885.51425933838ms
2022-09-22 00:56:44 INFO  ---RUNTIME: Multi-Query Optimization took 26.84497833251953 ms
2022-09-22 00:56:44 INFO  Executing generated plans
2022-09-22 00:59:00 INFO  ---RUNTIME: Execution took 136221.40884399414 ms
2022-09-22 00:59:00 INFO  Done!
2022-09-22 00:59:00 INFO  # Finished -- repetition 2 of 7 
2022-09-22 00:59:00 INFO  # Optimization benchmark for data_cleaning with args [['reviews', 'fast_loading', 'featurization_2', 'logistic_regression']] -- repetition 3 of 7
2022-09-22 00:59:00 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-22 00:59:00 INFO  Running instrumented original pipeline...
2022-09-22 00:59:01 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-22 00:59:01 INFO  ---RUNTIME: Importing and monkey-patching took 6.367683410644531 ms
2022-09-22 00:59:07 INFO  ---RUNTIME: Original pipeline execution took 6966.556072235107 ms (excluding imports and monkey-patching)
2022-09-22 00:59:07 INFO  Starting execution of 1 what-if analyses...
2022-09-22 00:59:07 INFO  Start plan generation for analysis DataCleaning...
2022-09-22 00:59:07 INFO  ---RUNTIME: Plan generation took 0.6206035614013672 ms
2022-09-22 00:59:07 INFO  Estimated runtime of original DAG is 5529.624938964844ms
2022-09-22 00:59:07 INFO  Performing Multi-Query Optimization
2022-09-22 00:59:07 INFO  Estimated unoptimized what-if runtime is 110592.49877929688ms
2022-09-22 00:59:07 INFO  Estimated optimised what-if runtime is 22716.235160827637ms
2022-09-22 00:59:07 INFO  Estimated optimisation runtime saving is 87876.26361846924ms
2022-09-22 00:59:07 INFO  ---RUNTIME: Multi-Query Optimization took 98.35433959960938 ms
2022-09-22 00:59:07 INFO  Executing generated plans
2022-09-22 00:59:38 INFO  ---RUNTIME: Execution took 30323.01616668701 ms
2022-09-22 00:59:38 INFO  Done!
2022-09-22 00:59:38 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-22 00:59:38 INFO  Running instrumented original pipeline...
2022-09-22 00:59:38 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-22 00:59:38 INFO  ---RUNTIME: Importing and monkey-patching took 5.891084671020508 ms
2022-09-22 00:59:45 INFO  ---RUNTIME: Original pipeline execution took 6979.904413223267 ms (excluding imports and monkey-patching)
2022-09-22 00:59:45 INFO  Starting execution of 1 what-if analyses...
2022-09-22 00:59:45 INFO  Start plan generation for analysis DataCleaning...
2022-09-22 00:59:45 INFO  ---RUNTIME: Plan generation took 0.6759166717529297 ms
2022-09-22 00:59:45 INFO  Estimated runtime of original DAG is 5693.819284439087ms
2022-09-22 00:59:45 WARNING Skipping Multi-Query Optimization (instead, only applying patches)
2022-09-22 00:59:45 WARNING Columns ['review_id'] not present in train DAG after the train test split, only before!
2022-09-22 00:59:45 WARNING This could hint at data leakage!
2022-09-22 00:59:45 INFO  Estimated unoptimised what-if runtime is 113876.38568878174ms
2022-09-22 00:59:45 INFO  ---RUNTIME: Multi-Query Optimization took 24.760007858276367 ms
2022-09-22 00:59:45 INFO  Executing generated plans
2022-09-22 01:02:01 INFO  ---RUNTIME: Execution took 136602.9725074768 ms
2022-09-22 01:02:01 INFO  Done!
2022-09-22 01:02:01 INFO  # Finished -- repetition 3 of 7 
2022-09-22 01:02:01 INFO  # Optimization benchmark for data_cleaning with args [['reviews', 'fast_loading', 'featurization_2', 'logistic_regression']] -- repetition 4 of 7
2022-09-22 01:02:01 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-22 01:02:01 INFO  Running instrumented original pipeline...
2022-09-22 01:02:01 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-22 01:02:01 INFO  ---RUNTIME: Importing and monkey-patching took 6.108522415161133 ms
2022-09-22 01:02:08 INFO  ---RUNTIME: Original pipeline execution took 6867.447376251221 ms (excluding imports and monkey-patching)
2022-09-22 01:02:08 INFO  Starting execution of 1 what-if analyses...
2022-09-22 01:02:08 INFO  Start plan generation for analysis DataCleaning...
2022-09-22 01:02:08 INFO  ---RUNTIME: Plan generation took 0.6258487701416016 ms
2022-09-22 01:02:08 INFO  Estimated runtime of original DAG is 5659.826993942261ms
2022-09-22 01:02:08 INFO  Performing Multi-Query Optimization
2022-09-22 01:02:08 INFO  Estimated unoptimized what-if runtime is 113196.53987884521ms
2022-09-22 01:02:08 INFO  Estimated optimised what-if runtime is 24056.17642402649ms
2022-09-22 01:02:08 INFO  Estimated optimisation runtime saving is 89140.36345481873ms
2022-09-22 01:02:08 INFO  ---RUNTIME: Multi-Query Optimization took 104.48980331420898 ms
2022-09-22 01:02:08 INFO  Executing generated plans
2022-09-22 01:02:39 INFO  ---RUNTIME: Execution took 30174.350023269653 ms
2022-09-22 01:02:39 INFO  Done!
2022-09-22 01:02:39 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-22 01:02:39 INFO  Running instrumented original pipeline...
2022-09-22 01:02:39 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-22 01:02:39 INFO  ---RUNTIME: Importing and monkey-patching took 6.05010986328125 ms
2022-09-22 01:02:45 INFO  ---RUNTIME: Original pipeline execution took 6908.61177444458 ms (excluding imports and monkey-patching)
2022-09-22 01:02:45 INFO  Starting execution of 1 what-if analyses...
2022-09-22 01:02:45 INFO  Start plan generation for analysis DataCleaning...
2022-09-22 01:02:45 INFO  ---RUNTIME: Plan generation took 0.6306171417236328 ms
2022-09-22 01:02:45 INFO  Estimated runtime of original DAG is 5704.8163414001465ms
2022-09-22 01:02:45 WARNING Skipping Multi-Query Optimization (instead, only applying patches)
2022-09-22 01:02:45 WARNING Columns ['review_id'] not present in train DAG after the train test split, only before!
2022-09-22 01:02:45 WARNING This could hint at data leakage!
2022-09-22 01:02:45 INFO  Estimated unoptimised what-if runtime is 114096.32682800293ms
2022-09-22 01:02:45 INFO  ---RUNTIME: Multi-Query Optimization took 24.708032608032227 ms
2022-09-22 01:02:45 INFO  Executing generated plans
2022-09-22 01:05:01 INFO  ---RUNTIME: Execution took 135626.21116638184 ms
2022-09-22 01:05:01 INFO  Done!
2022-09-22 01:05:01 INFO  # Finished -- repetition 4 of 7 
2022-09-22 01:05:01 INFO  # Optimization benchmark for data_cleaning with args [['reviews', 'fast_loading', 'featurization_2', 'logistic_regression']] -- repetition 5 of 7
2022-09-22 01:05:01 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-22 01:05:01 INFO  Running instrumented original pipeline...
2022-09-22 01:05:01 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-22 01:05:01 INFO  ---RUNTIME: Importing and monkey-patching took 5.93113899230957 ms
2022-09-22 01:05:08 INFO  ---RUNTIME: Original pipeline execution took 6859.371662139893 ms (excluding imports and monkey-patching)
2022-09-22 01:05:08 INFO  Starting execution of 1 what-if analyses...
2022-09-22 01:05:08 INFO  Start plan generation for analysis DataCleaning...
2022-09-22 01:05:08 INFO  ---RUNTIME: Plan generation took 0.6291866302490234 ms
2022-09-22 01:05:08 INFO  Estimated runtime of original DAG is 5592.84782409668ms
2022-09-22 01:05:08 INFO  Performing Multi-Query Optimization
2022-09-22 01:05:08 INFO  Estimated unoptimized what-if runtime is 111856.9564819336ms
2022-09-22 01:05:08 INFO  Estimated optimised what-if runtime is 22773.75817298889ms
2022-09-22 01:05:08 INFO  Estimated optimisation runtime saving is 89083.1983089447ms
2022-09-22 01:05:08 INFO  ---RUNTIME: Multi-Query Optimization took 97.72467613220215 ms
2022-09-22 01:05:08 INFO  Executing generated plans
2022-09-22 01:05:38 INFO  ---RUNTIME: Execution took 29780.122756958008 ms
2022-09-22 01:05:38 INFO  Done!
2022-09-22 01:05:38 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-22 01:05:38 INFO  Running instrumented original pipeline...
2022-09-22 01:05:38 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-22 01:05:38 INFO  ---RUNTIME: Importing and monkey-patching took 5.953073501586914 ms
2022-09-22 01:05:45 INFO  ---RUNTIME: Original pipeline execution took 6657.075881958008 ms (excluding imports and monkey-patching)
2022-09-22 01:05:45 INFO  Starting execution of 1 what-if analyses...
2022-09-22 01:05:45 INFO  Start plan generation for analysis DataCleaning...
2022-09-22 01:05:45 INFO  ---RUNTIME: Plan generation took 0.61798095703125 ms
2022-09-22 01:05:45 INFO  Estimated runtime of original DAG is 5466.375827789307ms
2022-09-22 01:05:45 WARNING Skipping Multi-Query Optimization (instead, only applying patches)
2022-09-22 01:05:45 WARNING Columns ['review_id'] not present in train DAG after the train test split, only before!
2022-09-22 01:05:45 WARNING This could hint at data leakage!
2022-09-22 01:05:45 INFO  Estimated unoptimised what-if runtime is 109327.51655578613ms
2022-09-22 01:05:45 INFO  ---RUNTIME: Multi-Query Optimization took 23.939132690429688 ms
2022-09-22 01:05:45 INFO  Executing generated plans
2022-09-22 01:07:58 INFO  ---RUNTIME: Execution took 133235.45861244202 ms
2022-09-22 01:07:58 INFO  Done!
2022-09-22 01:07:58 INFO  # Finished -- repetition 5 of 7 
2022-09-22 01:07:58 INFO  # Optimization benchmark for data_cleaning with args [['reviews', 'fast_loading', 'featurization_2', 'logistic_regression']] -- repetition 6 of 7
2022-09-22 01:07:58 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-22 01:07:58 INFO  Running instrumented original pipeline...
2022-09-22 01:07:58 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-22 01:07:58 INFO  ---RUNTIME: Importing and monkey-patching took 5.846977233886719 ms
2022-09-22 01:08:04 INFO  ---RUNTIME: Original pipeline execution took 6678.929805755615 ms (excluding imports and monkey-patching)
2022-09-22 01:08:04 INFO  Starting execution of 1 what-if analyses...
2022-09-22 01:08:04 INFO  Start plan generation for analysis DataCleaning...
2022-09-22 01:08:04 INFO  ---RUNTIME: Plan generation took 0.6234645843505859 ms
2022-09-22 01:08:04 INFO  Estimated runtime of original DAG is 5494.316339492798ms
2022-09-22 01:08:04 INFO  Performing Multi-Query Optimization
2022-09-22 01:08:05 INFO  Estimated unoptimized what-if runtime is 109886.32678985596ms
2022-09-22 01:08:05 INFO  Estimated optimised what-if runtime is 22890.22994041443ms
2022-09-22 01:08:05 INFO  Estimated optimisation runtime saving is 86996.09684944153ms
2022-09-22 01:08:05 INFO  ---RUNTIME: Multi-Query Optimization took 96.79150581359863 ms
2022-09-22 01:08:05 INFO  Executing generated plans
2022-09-22 01:08:34 INFO  ---RUNTIME: Execution took 29628.03888320923 ms
2022-09-22 01:08:34 INFO  Done!
2022-09-22 01:08:34 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-22 01:08:34 INFO  Running instrumented original pipeline...
2022-09-22 01:08:34 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-22 01:08:34 INFO  ---RUNTIME: Importing and monkey-patching took 5.855321884155273 ms
2022-09-22 01:08:41 INFO  ---RUNTIME: Original pipeline execution took 6637.834310531616 ms (excluding imports and monkey-patching)
2022-09-22 01:08:41 INFO  Starting execution of 1 what-if analyses...
2022-09-22 01:08:41 INFO  Start plan generation for analysis DataCleaning...
2022-09-22 01:08:41 INFO  ---RUNTIME: Plan generation took 0.6082057952880859 ms
2022-09-22 01:08:41 INFO  Estimated runtime of original DAG is 5452.993154525757ms
2022-09-22 01:08:41 WARNING Skipping Multi-Query Optimization (instead, only applying patches)
2022-09-22 01:08:41 WARNING Columns ['review_id'] not present in train DAG after the train test split, only before!
2022-09-22 01:08:41 WARNING This could hint at data leakage!
2022-09-22 01:08:41 INFO  Estimated unoptimised what-if runtime is 109059.86309051514ms
2022-09-22 01:08:41 INFO  ---RUNTIME: Multi-Query Optimization took 24.18994903564453 ms
2022-09-22 01:08:41 INFO  Executing generated plans
2022-09-22 01:10:54 INFO  ---RUNTIME: Execution took 132804.06713485718 ms
2022-09-22 01:10:54 INFO  Done!
2022-09-22 01:10:54 INFO  # Finished -- repetition 6 of 7 
2022-09-22 01:10:54 INFO  # Optimization benchmark for data_cleaning with args [['reviews', 'fast_loading', 'featurization_2', 'logistic_regression']] -- repetition 7 of 7
2022-09-22 01:10:54 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-22 01:10:54 INFO  Running instrumented original pipeline...
2022-09-22 01:10:54 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-22 01:10:54 INFO  ---RUNTIME: Importing and monkey-patching took 5.864620208740234 ms
2022-09-22 01:11:00 INFO  ---RUNTIME: Original pipeline execution took 6633.294105529785 ms (excluding imports and monkey-patching)
2022-09-22 01:11:00 INFO  Starting execution of 1 what-if analyses...
2022-09-22 01:11:00 INFO  Start plan generation for analysis DataCleaning...
2022-09-22 01:11:00 INFO  ---RUNTIME: Plan generation took 0.6115436553955078 ms
2022-09-22 01:11:00 INFO  Estimated runtime of original DAG is 5448.506116867065ms
2022-09-22 01:11:00 INFO  Performing Multi-Query Optimization
2022-09-22 01:11:00 INFO  Estimated unoptimized what-if runtime is 108970.12233734131ms
2022-09-22 01:11:00 INFO  Estimated optimised what-if runtime is 22552.64949798584ms
2022-09-22 01:11:00 INFO  Estimated optimisation runtime saving is 86417.47283935547ms
2022-09-22 01:11:00 INFO  ---RUNTIME: Multi-Query Optimization took 97.67317771911621 ms
2022-09-22 01:11:00 INFO  Executing generated plans
2022-09-22 01:11:30 INFO  ---RUNTIME: Execution took 29518.48840713501 ms
2022-09-22 01:11:30 INFO  Done!
2022-09-22 01:11:30 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-22 01:11:30 INFO  Running instrumented original pipeline...
2022-09-22 01:11:30 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-22 01:11:30 INFO  ---RUNTIME: Importing and monkey-patching took 5.511283874511719 ms
2022-09-22 01:11:37 INFO  ---RUNTIME: Original pipeline execution took 6620.18346786499 ms (excluding imports and monkey-patching)
2022-09-22 01:11:37 INFO  Starting execution of 1 what-if analyses...
2022-09-22 01:11:37 INFO  Start plan generation for analysis DataCleaning...
2022-09-22 01:11:37 INFO  ---RUNTIME: Plan generation took 0.6346702575683594 ms
2022-09-22 01:11:37 INFO  Estimated runtime of original DAG is 5432.148218154907ms
2022-09-22 01:11:37 WARNING Skipping Multi-Query Optimization (instead, only applying patches)
2022-09-22 01:11:37 WARNING Columns ['review_id'] not present in train DAG after the train test split, only before!
2022-09-22 01:11:37 WARNING This could hint at data leakage!
2022-09-22 01:11:37 INFO  Estimated unoptimised what-if runtime is 108642.96436309814ms
2022-09-22 01:11:37 INFO  ---RUNTIME: Multi-Query Optimization took 24.19447898864746 ms
2022-09-22 01:11:37 INFO  Executing generated plans
2022-09-22 01:13:50 INFO  ---RUNTIME: Execution took 133764.9643421173 ms
2022-09-22 01:13:50 INFO  Done!
2022-09-22 01:13:50 INFO  # Finished -- repetition 7 of 7 
2022-09-22 01:13:50 INFO  # Final results after all repetitions
2022-09-22 01:13:50 INFO     repetition  ... no_opt_what_if_execution_combined_model_training
0           0  ...                                      2277.927399
1           1  ...                                      2318.216085
2           2  ...                                      2309.217215
3           3  ...                                      2210.865974
4           4  ...                                      2167.142630
5           5  ...                                      2126.498938
6           6  ...                                      2149.382591

[7 rows x 26 columns]
taskset -c 160-167 PROTOCOL_BUFFERS_PYTHON_IMPLEMENTATION=python python3.9 benchmarks_end_to_end.py data_cleaning reviews fast_loading featurization_2 xgboost
2022-09-22 01:13:53.092165: W tensorflow/stream_executor/platform/default/dso_loader.cc:64] Could not load dynamic library 'libcudart.so.11.0'; dlerror: libcudart.so.11.0: cannot open shared object file: No such file or directory; LD_LIBRARY_PATH: /home/sgrafbe/mlwhatif/venv/lib/python3.9/site-packages/cv2/../../lib64:
2022-09-22 01:13:53.092211: I tensorflow/stream_executor/cuda/cudart_stub.cc:29] Ignore above cudart dlerror if you do not have a GPU set up on your machine.
2022-09-22 01:13:54 INFO  Patching sys.argv with ['mlwhatif', 'reviews', 'fast_loading', 'featurization_2', 'xgboost']
2022-09-22 01:13:54 INFO  Running instrumented original pipeline...
2022-09-22 01:13:54 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-22 01:13:54 INFO  ---RUNTIME: Importing and monkey-patching took 122.85995483398438 ms
2022-09-22 01:14:13 INFO  ---RUNTIME: Original pipeline execution took 19382.583141326904 ms (excluding imports and monkey-patching)
2022-09-22 01:14:13 INFO  Starting execution of 0 what-if analyses...
2022-09-22 01:14:13 INFO  Estimated runtime of original DAG is 18181.58745765686ms
2022-09-22 01:14:13 INFO  Performing Multi-Query Optimization
2022-09-22 01:14:13 INFO  Estimated unoptimized what-if runtime is 0ms
2022-09-22 01:14:13 INFO  Estimated optimised what-if runtime is 0ms
2022-09-22 01:14:13 INFO  Estimated optimisation runtime saving is 0ms
2022-09-22 01:14:13 INFO  ---RUNTIME: Multi-Query Optimization took 0.5271434783935547 ms
2022-09-22 01:14:13 INFO  Executing generated plans
2022-09-22 01:14:13 INFO  ---RUNTIME: Execution took 0.025987625122070312 ms
2022-09-22 01:14:13 INFO  Done!
2022-09-22 01:14:13 INFO  # Optimization benchmark for data_cleaning with args [['reviews', 'fast_loading', 'featurization_2', 'xgboost']] -- repetition 1 of 7
2022-09-22 01:14:13 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-22 01:14:13 INFO  Running instrumented original pipeline...
2022-09-22 01:14:13 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-22 01:14:13 INFO  ---RUNTIME: Importing and monkey-patching took 5.420446395874023 ms
2022-09-22 01:14:33 INFO  ---RUNTIME: Original pipeline execution took 19362.061500549316 ms (excluding imports and monkey-patching)
2022-09-22 01:14:33 INFO  Starting execution of 1 what-if analyses...
2022-09-22 01:14:33 INFO  Start plan generation for analysis DataCleaning...
2022-09-22 01:14:33 INFO  ---RUNTIME: Plan generation took 0.6463527679443359 ms
2022-09-22 01:14:33 INFO  Estimated runtime of original DAG is 18018.964767456055ms
2022-09-22 01:14:33 INFO  Performing Multi-Query Optimization
2022-09-22 01:14:33 INFO  Estimated unoptimized what-if runtime is 360379.2953491211ms
2022-09-22 01:14:33 INFO  Estimated optimised what-if runtime is 274161.9324684143ms
2022-09-22 01:14:33 INFO  Estimated optimisation runtime saving is 86217.36288070679ms
2022-09-22 01:14:33 INFO  ---RUNTIME: Multi-Query Optimization took 101.84550285339355 ms
2022-09-22 01:14:33 INFO  Executing generated plans
2022-09-22 01:19:34 INFO  ---RUNTIME: Execution took 300917.23799705505 ms
2022-09-22 01:19:34 INFO  Done!
2022-09-22 01:19:34 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-22 01:19:34 INFO  Running instrumented original pipeline...
2022-09-22 01:19:34 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-22 01:19:34 INFO  ---RUNTIME: Importing and monkey-patching took 6.258487701416016 ms
2022-09-22 01:19:53 INFO  ---RUNTIME: Original pipeline execution took 19598.116159439087 ms (excluding imports and monkey-patching)
2022-09-22 01:19:53 INFO  Starting execution of 1 what-if analyses...
2022-09-22 01:19:53 INFO  Start plan generation for analysis DataCleaning...
2022-09-22 01:19:53 INFO  ---RUNTIME: Plan generation took 0.6592273712158203 ms
2022-09-22 01:19:53 INFO  Estimated runtime of original DAG is 18412.605047225952ms
2022-09-22 01:19:53 WARNING Skipping Multi-Query Optimization (instead, only applying patches)
2022-09-22 01:19:53 WARNING Columns ['review_id'] not present in train DAG after the train test split, only before!
2022-09-22 01:19:53 WARNING This could hint at data leakage!
2022-09-22 01:19:53 INFO  Estimated unoptimised what-if runtime is 368252.10094451904ms
2022-09-22 01:19:53 INFO  ---RUNTIME: Multi-Query Optimization took 24.864673614501953 ms
2022-09-22 01:19:53 INFO  Executing generated plans
2022-09-22 01:26:37 INFO  ---RUNTIME: Execution took 403816.8878555298 ms
2022-09-22 01:26:37 INFO  Done!
2022-09-22 01:26:37 INFO  # Finished -- repetition 1 of 7 
2022-09-22 01:26:37 INFO  # Optimization benchmark for data_cleaning with args [['reviews', 'fast_loading', 'featurization_2', 'xgboost']] -- repetition 2 of 7
2022-09-22 01:26:37 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-22 01:26:37 INFO  Running instrumented original pipeline...
2022-09-22 01:26:37 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-22 01:26:37 INFO  ---RUNTIME: Importing and monkey-patching took 5.948305130004883 ms
2022-09-22 01:26:57 INFO  ---RUNTIME: Original pipeline execution took 19297.497272491455 ms (excluding imports and monkey-patching)
2022-09-22 01:26:57 INFO  Starting execution of 1 what-if analyses...
2022-09-22 01:26:57 INFO  Start plan generation for analysis DataCleaning...
2022-09-22 01:26:57 INFO  ---RUNTIME: Plan generation took 0.6396770477294922 ms
2022-09-22 01:26:57 INFO  Estimated runtime of original DAG is 18118.28327178955ms
2022-09-22 01:26:57 INFO  Performing Multi-Query Optimization
2022-09-22 01:26:57 INFO  Estimated unoptimized what-if runtime is 362365.665435791ms
2022-09-22 01:26:57 INFO  Estimated optimised what-if runtime is 276545.91512680054ms
2022-09-22 01:26:57 INFO  Estimated optimisation runtime saving is 85819.75030899048ms
2022-09-22 01:26:57 INFO  ---RUNTIME: Multi-Query Optimization took 99.43222999572754 ms
2022-09-22 01:26:57 INFO  Executing generated plans
2022-09-22 01:31:57 INFO  ---RUNTIME: Execution took 300839.870929718 ms
2022-09-22 01:31:57 INFO  Done!
2022-09-22 01:31:57 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-22 01:31:57 INFO  Running instrumented original pipeline...
2022-09-22 01:31:58 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-22 01:31:58 INFO  ---RUNTIME: Importing and monkey-patching took 6.018638610839844 ms
2022-09-22 01:32:17 INFO  ---RUNTIME: Original pipeline execution took 19456.601858139038 ms (excluding imports and monkey-patching)
2022-09-22 01:32:17 INFO  Starting execution of 1 what-if analyses...
2022-09-22 01:32:17 INFO  Start plan generation for analysis DataCleaning...
2022-09-22 01:32:17 INFO  ---RUNTIME: Plan generation took 0.6575584411621094 ms
2022-09-22 01:32:17 INFO  Estimated runtime of original DAG is 18273.766040802002ms
2022-09-22 01:32:17 WARNING Skipping Multi-Query Optimization (instead, only applying patches)
2022-09-22 01:32:17 WARNING Columns ['review_id'] not present in train DAG after the train test split, only before!
2022-09-22 01:32:17 WARNING This could hint at data leakage!
2022-09-22 01:32:17 INFO  Estimated unoptimised what-if runtime is 365475.32081604004ms
2022-09-22 01:32:17 INFO  ---RUNTIME: Multi-Query Optimization took 24.7495174407959 ms
2022-09-22 01:32:17 INFO  Executing generated plans
2022-09-22 01:39:47 INFO  ---RUNTIME: Execution took 450408.1768989563 ms
2022-09-22 01:39:47 INFO  Done!
2022-09-22 01:39:47 INFO  # Finished -- repetition 2 of 7 
2022-09-22 01:39:47 INFO  # Optimization benchmark for data_cleaning with args [['reviews', 'fast_loading', 'featurization_2', 'xgboost']] -- repetition 3 of 7
2022-09-22 01:39:47 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-22 01:39:47 INFO  Running instrumented original pipeline...
2022-09-22 01:39:48 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-22 01:39:48 INFO  ---RUNTIME: Importing and monkey-patching took 5.841493606567383 ms
2022-09-22 01:40:11 INFO  ---RUNTIME: Original pipeline execution took 23897.5989818573 ms (excluding imports and monkey-patching)
2022-09-22 01:40:11 INFO  Starting execution of 1 what-if analyses...
2022-09-22 01:40:11 INFO  Start plan generation for analysis DataCleaning...
2022-09-22 01:40:11 INFO  ---RUNTIME: Plan generation took 0.6139278411865234 ms
2022-09-22 01:40:11 INFO  Estimated runtime of original DAG is 21716.00604057312ms
2022-09-22 01:40:11 INFO  Performing Multi-Query Optimization
2022-09-22 01:40:11 INFO  Estimated unoptimized what-if runtime is 434320.1208114624ms
2022-09-22 01:40:11 INFO  Estimated optimised what-if runtime is 320142.89450645447ms
2022-09-22 01:40:11 INFO  Estimated optimisation runtime saving is 114177.22630500793ms
2022-09-22 01:40:11 INFO  ---RUNTIME: Multi-Query Optimization took 99.58338737487793 ms
2022-09-22 01:40:11 INFO  Executing generated plans
2022-09-22 01:46:04 INFO  ---RUNTIME: Execution took 352188.330411911 ms
2022-09-22 01:46:04 INFO  Done!
2022-09-22 01:46:04 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-22 01:46:04 INFO  Running instrumented original pipeline...
2022-09-22 01:46:04 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-22 01:46:04 INFO  ---RUNTIME: Importing and monkey-patching took 9.016036987304688 ms
2022-09-22 01:46:27 INFO  ---RUNTIME: Original pipeline execution took 23788.99836540222 ms (excluding imports and monkey-patching)
2022-09-22 01:46:27 INFO  Starting execution of 1 what-if analyses...
2022-09-22 01:46:27 INFO  Start plan generation for analysis DataCleaning...
2022-09-22 01:46:27 INFO  ---RUNTIME: Plan generation took 0.8420944213867188 ms
2022-09-22 01:46:27 INFO  Estimated runtime of original DAG is 21952.725172042847ms
2022-09-22 01:46:27 WARNING Skipping Multi-Query Optimization (instead, only applying patches)
2022-09-22 01:46:27 WARNING Columns ['review_id'] not present in train DAG after the train test split, only before!
2022-09-22 01:46:27 WARNING This could hint at data leakage!
2022-09-22 01:46:27 INFO  Estimated unoptimised what-if runtime is 439054.50344085693ms
2022-09-22 01:46:27 INFO  ---RUNTIME: Multi-Query Optimization took 43.34306716918945 ms
2022-09-22 01:46:27 INFO  Executing generated plans
2022-09-22 01:54:26 INFO  ---RUNTIME: Execution took 478587.64719963074 ms
2022-09-22 01:54:26 INFO  Done!
2022-09-22 01:54:26 INFO  # Finished -- repetition 3 of 7 
2022-09-22 01:54:26 INFO  # Optimization benchmark for data_cleaning with args [['reviews', 'fast_loading', 'featurization_2', 'xgboost']] -- repetition 4 of 7
2022-09-22 01:54:26 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-22 01:54:26 INFO  Running instrumented original pipeline...
2022-09-22 01:54:26 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-22 01:54:26 INFO  ---RUNTIME: Importing and monkey-patching took 8.611917495727539 ms
2022-09-22 01:54:50 INFO  ---RUNTIME: Original pipeline execution took 23702.340364456177 ms (excluding imports and monkey-patching)
2022-09-22 01:54:50 INFO  Starting execution of 1 what-if analyses...
2022-09-22 01:54:50 INFO  Start plan generation for analysis DataCleaning...
2022-09-22 01:54:50 INFO  ---RUNTIME: Plan generation took 0.8642673492431641 ms
2022-09-22 01:54:50 INFO  Estimated runtime of original DAG is 21845.390796661377ms
2022-09-22 01:54:50 INFO  Performing Multi-Query Optimization
2022-09-22 01:54:50 INFO  Estimated unoptimized what-if runtime is 436907.81593322754ms
2022-09-22 01:54:50 INFO  Estimated optimised what-if runtime is 306596.37808799744ms
2022-09-22 01:54:50 INFO  Estimated optimisation runtime saving is 130311.4378452301ms
2022-09-22 01:54:50 INFO  ---RUNTIME: Multi-Query Optimization took 196.33746147155762 ms
2022-09-22 01:54:50 INFO  Executing generated plans
2022-09-22 02:00:41 INFO  ---RUNTIME: Execution took 350613.30223083496 ms
2022-09-22 02:00:41 INFO  Done!
2022-09-22 02:00:41 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-22 02:00:41 INFO  Running instrumented original pipeline...
2022-09-22 02:00:41 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-22 02:00:41 INFO  ---RUNTIME: Importing and monkey-patching took 5.945682525634766 ms
2022-09-22 02:01:04 INFO  ---RUNTIME: Original pipeline execution took 23163.27953338623 ms (excluding imports and monkey-patching)
2022-09-22 02:01:04 INFO  Starting execution of 1 what-if analyses...
2022-09-22 02:01:04 INFO  Start plan generation for analysis DataCleaning...
2022-09-22 02:01:04 INFO  ---RUNTIME: Plan generation took 0.6620883941650391 ms
2022-09-22 02:01:04 INFO  Estimated runtime of original DAG is 21962.995529174805ms
2022-09-22 02:01:04 WARNING Skipping Multi-Query Optimization (instead, only applying patches)
2022-09-22 02:01:04 WARNING Columns ['review_id'] not present in train DAG after the train test split, only before!
2022-09-22 02:01:04 WARNING This could hint at data leakage!
2022-09-22 02:01:04 INFO  Estimated unoptimised what-if runtime is 439259.9105834961ms
2022-09-22 02:01:04 INFO  ---RUNTIME: Multi-Query Optimization took 24.697065353393555 ms
2022-09-22 02:01:04 INFO  Executing generated plans
2022-09-22 02:09:05 INFO  ---RUNTIME: Execution took 480717.54813194275 ms
2022-09-22 02:09:05 INFO  Done!
2022-09-22 02:09:05 INFO  # Finished -- repetition 4 of 7 
2022-09-22 02:09:05 INFO  # Optimization benchmark for data_cleaning with args [['reviews', 'fast_loading', 'featurization_2', 'xgboost']] -- repetition 5 of 7
2022-09-22 02:09:05 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-22 02:09:05 INFO  Running instrumented original pipeline...
2022-09-22 02:09:05 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-22 02:09:05 INFO  ---RUNTIME: Importing and monkey-patching took 6.093025207519531 ms
2022-09-22 02:09:28 INFO  ---RUNTIME: Original pipeline execution took 23207.356691360474 ms (excluding imports and monkey-patching)
2022-09-22 02:09:28 INFO  Starting execution of 1 what-if analyses...
2022-09-22 02:09:28 INFO  Start plan generation for analysis DataCleaning...
2022-09-22 02:09:28 INFO  ---RUNTIME: Plan generation took 0.6504058837890625 ms
2022-09-22 02:09:28 INFO  Estimated runtime of original DAG is 22007.667303085327ms
2022-09-22 02:09:28 INFO  Performing Multi-Query Optimization
2022-09-22 02:09:28 INFO  Estimated unoptimized what-if runtime is 440153.34606170654ms
2022-09-22 02:09:28 INFO  Estimated optimised what-if runtime is 344926.31340026855ms
2022-09-22 02:09:28 INFO  Estimated optimisation runtime saving is 95227.03266143799ms
2022-09-22 02:09:28 INFO  ---RUNTIME: Multi-Query Optimization took 329.5018672943115 ms
2022-09-22 02:09:28 INFO  Executing generated plans
2022-09-22 02:15:17 INFO  ---RUNTIME: Execution took 349320.9125995636 ms
2022-09-22 02:15:17 INFO  Done!
2022-09-22 02:15:17 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-22 02:15:17 INFO  Running instrumented original pipeline...
2022-09-22 02:15:18 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-22 02:15:18 INFO  ---RUNTIME: Importing and monkey-patching took 7.323741912841797 ms
2022-09-22 02:15:41 INFO  ---RUNTIME: Original pipeline execution took 23698.548316955566 ms (excluding imports and monkey-patching)
2022-09-22 02:15:41 INFO  Starting execution of 1 what-if analyses...
2022-09-22 02:15:41 INFO  Start plan generation for analysis DataCleaning...
2022-09-22 02:15:41 INFO  ---RUNTIME: Plan generation took 1.6674995422363281 ms
2022-09-22 02:15:41 INFO  Estimated runtime of original DAG is 22447.550535202026ms
2022-09-22 02:15:41 WARNING Skipping Multi-Query Optimization (instead, only applying patches)
2022-09-22 02:15:41 WARNING Columns ['review_id'] not present in train DAG after the train test split, only before!
2022-09-22 02:15:41 WARNING This could hint at data leakage!
2022-09-22 02:15:41 INFO  Estimated unoptimised what-if runtime is 448951.0107040405ms
2022-09-22 02:15:41 INFO  ---RUNTIME: Multi-Query Optimization took 37.42194175720215 ms
2022-09-22 02:15:41 INFO  Executing generated plans
2022-09-22 02:23:42 INFO  ---RUNTIME: Execution took 480456.5980434418 ms
2022-09-22 02:23:42 INFO  Done!
2022-09-22 02:23:42 INFO  # Finished -- repetition 5 of 7 
2022-09-22 02:23:42 INFO  # Optimization benchmark for data_cleaning with args [['reviews', 'fast_loading', 'featurization_2', 'xgboost']] -- repetition 6 of 7
2022-09-22 02:23:42 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-22 02:23:42 INFO  Running instrumented original pipeline...
2022-09-22 02:23:42 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-22 02:23:42 INFO  ---RUNTIME: Importing and monkey-patching took 8.71586799621582 ms
2022-09-22 02:24:05 INFO  ---RUNTIME: Original pipeline execution took 22859.14921760559 ms (excluding imports and monkey-patching)
2022-09-22 02:24:05 INFO  Starting execution of 1 what-if analyses...
2022-09-22 02:24:05 INFO  Start plan generation for analysis DataCleaning...
2022-09-22 02:24:05 INFO  ---RUNTIME: Plan generation took 0.675201416015625 ms
2022-09-22 02:24:05 INFO  Estimated runtime of original DAG is 21096.452713012695ms
2022-09-22 02:24:05 INFO  Performing Multi-Query Optimization
2022-09-22 02:24:05 INFO  Estimated unoptimized what-if runtime is 421929.0542602539ms
2022-09-22 02:24:05 INFO  Estimated optimised what-if runtime is 300676.6548156738ms
2022-09-22 02:24:05 INFO  Estimated optimisation runtime saving is 121252.39944458008ms
2022-09-22 02:24:05 INFO  ---RUNTIME: Multi-Query Optimization took 116.60075187683105 ms
2022-09-22 02:24:05 INFO  Executing generated plans
2022-09-22 02:29:59 INFO  ---RUNTIME: Execution took 353858.0961227417 ms
2022-09-22 02:29:59 INFO  Done!
2022-09-22 02:29:59 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-22 02:29:59 INFO  Running instrumented original pipeline...
2022-09-22 02:29:59 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-22 02:29:59 INFO  ---RUNTIME: Importing and monkey-patching took 6.169795989990234 ms
2022-09-22 02:30:22 INFO  ---RUNTIME: Original pipeline execution took 23123.892307281494 ms (excluding imports and monkey-patching)
2022-09-22 02:30:22 INFO  Starting execution of 1 what-if analyses...
2022-09-22 02:30:22 INFO  Start plan generation for analysis DataCleaning...
2022-09-22 02:30:22 INFO  ---RUNTIME: Plan generation took 0.6659030914306641 ms
2022-09-22 02:30:22 INFO  Estimated runtime of original DAG is 21918.373107910156ms
2022-09-22 02:30:22 WARNING Skipping Multi-Query Optimization (instead, only applying patches)
2022-09-22 02:30:22 WARNING Columns ['review_id'] not present in train DAG after the train test split, only before!
2022-09-22 02:30:22 WARNING This could hint at data leakage!
2022-09-22 02:30:22 INFO  Estimated unoptimised what-if runtime is 438367.4621582031ms
2022-09-22 02:30:22 INFO  ---RUNTIME: Multi-Query Optimization took 24.25217628479004 ms
2022-09-22 02:30:22 INFO  Executing generated plans
2022-09-22 02:38:18 INFO  ---RUNTIME: Execution took 476518.9309120178 ms
2022-09-22 02:38:18 INFO  Done!
2022-09-22 02:38:18 INFO  # Finished -- repetition 6 of 7 
2022-09-22 02:38:18 INFO  # Optimization benchmark for data_cleaning with args [['reviews', 'fast_loading', 'featurization_2', 'xgboost']] -- repetition 7 of 7
2022-09-22 02:38:18 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-22 02:38:18 INFO  Running instrumented original pipeline...
2022-09-22 02:38:18 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-22 02:38:18 INFO  ---RUNTIME: Importing and monkey-patching took 7.137775421142578 ms
2022-09-22 02:38:42 INFO  ---RUNTIME: Original pipeline execution took 23379.342794418335 ms (excluding imports and monkey-patching)
2022-09-22 02:38:42 INFO  Starting execution of 1 what-if analyses...
2022-09-22 02:38:42 INFO  Start plan generation for analysis DataCleaning...
2022-09-22 02:38:42 INFO  ---RUNTIME: Plan generation took 0.8704662322998047 ms
2022-09-22 02:38:42 INFO  Estimated runtime of original DAG is 22127.723455429077ms
2022-09-22 02:38:42 INFO  Performing Multi-Query Optimization
2022-09-22 02:38:42 INFO  Estimated unoptimized what-if runtime is 442554.46910858154ms
2022-09-22 02:38:42 INFO  Estimated optimised what-if runtime is 343797.17779159546ms
2022-09-22 02:38:42 INFO  Estimated optimisation runtime saving is 98757.29131698608ms
2022-09-22 02:38:42 INFO  ---RUNTIME: Multi-Query Optimization took 120.15318870544434 ms
2022-09-22 02:38:42 INFO  Executing generated plans
2022-09-22 02:44:28 INFO  ---RUNTIME: Execution took 345984.13586616516 ms
2022-09-22 02:44:28 INFO  Done!
2022-09-22 02:44:28 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-22 02:44:28 INFO  Running instrumented original pipeline...
2022-09-22 02:44:28 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-22 02:44:28 INFO  ---RUNTIME: Importing and monkey-patching took 5.979776382446289 ms
2022-09-22 02:44:51 INFO  ---RUNTIME: Original pipeline execution took 23030.87568283081 ms (excluding imports and monkey-patching)
2022-09-22 02:44:51 INFO  Starting execution of 1 what-if analyses...
2022-09-22 02:44:51 INFO  Start plan generation for analysis DataCleaning...
2022-09-22 02:44:51 INFO  ---RUNTIME: Plan generation took 0.6928443908691406 ms
2022-09-22 02:44:51 INFO  Estimated runtime of original DAG is 21757.224559783936ms
2022-09-22 02:44:51 WARNING Skipping Multi-Query Optimization (instead, only applying patches)
2022-09-22 02:44:51 WARNING Columns ['review_id'] not present in train DAG after the train test split, only before!
2022-09-22 02:44:51 WARNING This could hint at data leakage!
2022-09-22 02:44:51 INFO  Estimated unoptimised what-if runtime is 435144.4911956787ms
2022-09-22 02:44:51 INFO  ---RUNTIME: Multi-Query Optimization took 23.992538452148438 ms
2022-09-22 02:44:51 INFO  Executing generated plans
2022-09-22 02:52:51 INFO  ---RUNTIME: Execution took 479943.1414604187 ms
2022-09-22 02:52:51 INFO  Done!
2022-09-22 02:52:51 INFO  # Finished -- repetition 7 of 7 
2022-09-22 02:52:51 INFO  # Final results after all repetitions
2022-09-22 02:52:51 INFO     repetition  ... no_opt_what_if_execution_combined_model_training
0           0  ...                                    272028.770924
1           1  ...                                    294046.093464
2           2  ...                                    301791.602850
3           3  ...                                    328392.178535
4           4  ...                                    316275.354624
5           5  ...                                    313775.303602
6           6  ...                                    327598.926306

[7 rows x 26 columns]
taskset -c 160-167 PROTOCOL_BUFFERS_PYTHON_IMPLEMENTATION=python python3.9 benchmarks_end_to_end.py data_cleaning reviews fast_loading featurization_2 neural_network
2022-09-22 02:52:54.789345: W tensorflow/stream_executor/platform/default/dso_loader.cc:64] Could not load dynamic library 'libcudart.so.11.0'; dlerror: libcudart.so.11.0: cannot open shared object file: No such file or directory; LD_LIBRARY_PATH: /home/sgrafbe/mlwhatif/venv/lib/python3.9/site-packages/cv2/../../lib64:
2022-09-22 02:52:54.789394: I tensorflow/stream_executor/cuda/cudart_stub.cc:29] Ignore above cudart dlerror if you do not have a GPU set up on your machine.
2022-09-22 02:52:56 INFO  Patching sys.argv with ['mlwhatif', 'reviews', 'fast_loading', 'featurization_2', 'neural_network']
2022-09-22 02:52:56 INFO  Running instrumented original pipeline...
2022-09-22 02:52:56 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-22 02:52:56 INFO  ---RUNTIME: Importing and monkey-patching took 124.45473670959473 ms
2022-09-22 02:53:02.198520: W tensorflow/stream_executor/platform/default/dso_loader.cc:64] Could not load dynamic library 'libcuda.so.1'; dlerror: libcuda.so.1: cannot open shared object file: No such file or directory; LD_LIBRARY_PATH: /home/sgrafbe/mlwhatif/venv/lib/python3.9/site-packages/cv2/../../lib64:
2022-09-22 02:53:02.198561: W tensorflow/stream_executor/cuda/cuda_driver.cc:326] failed call to cuInit: UNKNOWN ERROR (303)
2022-09-22 02:53:02.198585: I tensorflow/stream_executor/cuda/cuda_diagnostics.cc:156] kernel driver does not appear to be running on this host (angus): /proc/driver/nvidia/version does not exist
2022-09-22 02:53:02.199080: I tensorflow/core/platform/cpu_feature_guard.cc:142] This TensorFlow binary is optimized with oneAPI Deep Neural Network Library (oneDNN) to use the following CPU instructions in performance-critical operations:  AVX2 FMA
To enable them in other operations, rebuild TensorFlow with the appropriate compiler flags.
2022-09-22 02:53:02.827230: I tensorflow/compiler/mlir/mlir_graph_optimization_pass.cc:176] None of the MLIR Optimization Passes are enabled (registered 2)
2022-09-22 02:53:02.841179: I tensorflow/core/platform/profile_utils/cpu_utils.cc:114] CPU Frequency: 2595130000 Hz
2022-09-22 02:53:14 INFO  ---RUNTIME: Original pipeline execution took 17781.293869018555 ms (excluding imports and monkey-patching)
2022-09-22 02:53:14 INFO  Starting execution of 0 what-if analyses...
2022-09-22 02:53:14 INFO  Estimated runtime of original DAG is 16555.845022201538ms
2022-09-22 02:53:14 INFO  Performing Multi-Query Optimization
2022-09-22 02:53:14 INFO  Estimated unoptimized what-if runtime is 0ms
2022-09-22 02:53:14 INFO  Estimated optimised what-if runtime is 0ms
2022-09-22 02:53:14 INFO  Estimated optimisation runtime saving is 0ms
2022-09-22 02:53:14 INFO  ---RUNTIME: Multi-Query Optimization took 0.8950233459472656 ms
2022-09-22 02:53:14 INFO  Executing generated plans
2022-09-22 02:53:14 INFO  ---RUNTIME: Execution took 0.05412101745605469 ms
2022-09-22 02:53:14 INFO  Done!
2022-09-22 02:53:14 INFO  # Optimization benchmark for data_cleaning with args [['reviews', 'fast_loading', 'featurization_2', 'neural_network']] -- repetition 1 of 7
2022-09-22 02:53:14 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-22 02:53:14 INFO  Running instrumented original pipeline...
2022-09-22 02:53:14 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-22 02:53:14 INFO  ---RUNTIME: Importing and monkey-patching took 6.93964958190918 ms
2022-09-22 02:53:30 INFO  ---RUNTIME: Original pipeline execution took 16174.70908164978 ms (excluding imports and monkey-patching)
2022-09-22 02:53:30 INFO  Starting execution of 1 what-if analyses...
2022-09-22 02:53:30 INFO  Start plan generation for analysis DataCleaning...
2022-09-22 02:53:30 INFO  ---RUNTIME: Plan generation took 2.6683807373046875 ms
2022-09-22 02:53:30 INFO  Estimated runtime of original DAG is 14754.426002502441ms
2022-09-22 02:53:30 INFO  Performing Multi-Query Optimization
2022-09-22 02:53:30 INFO  Estimated unoptimized what-if runtime is 295088.5200500488ms
2022-09-22 02:53:30 INFO  Estimated optimised what-if runtime is 190126.60670280457ms
2022-09-22 02:53:30 INFO  Estimated optimisation runtime saving is 104961.91334724426ms
2022-09-22 02:53:30 INFO  ---RUNTIME: Multi-Query Optimization took 170.42779922485352 ms
2022-09-22 02:53:30 INFO  Executing generated plans
2022-09-22 02:57:01 INFO  ---RUNTIME: Execution took 211329.04720306396 ms
2022-09-22 02:57:01 INFO  Done!
2022-09-22 02:57:01 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-22 02:57:01 INFO  Running instrumented original pipeline...
2022-09-22 02:57:01 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-22 02:57:01 INFO  ---RUNTIME: Importing and monkey-patching took 6.662130355834961 ms
2022-09-22 02:57:19 INFO  ---RUNTIME: Original pipeline execution took 17969.24090385437 ms (excluding imports and monkey-patching)
2022-09-22 02:57:19 INFO  Starting execution of 1 what-if analyses...
2022-09-22 02:57:19 INFO  Start plan generation for analysis DataCleaning...
2022-09-22 02:57:19 INFO  ---RUNTIME: Plan generation took 0.6318092346191406 ms
2022-09-22 02:57:19 INFO  Estimated runtime of original DAG is 16247.988939285278ms
2022-09-22 02:57:19 WARNING Skipping Multi-Query Optimization (instead, only applying patches)
2022-09-22 02:57:19 WARNING Columns ['review_id'] not present in train DAG after the train test split, only before!
2022-09-22 02:57:19 WARNING This could hint at data leakage!
2022-09-22 02:57:19 INFO  Estimated unoptimised what-if runtime is 324959.77878570557ms
2022-09-22 02:57:19 INFO  ---RUNTIME: Multi-Query Optimization took 24.913549423217773 ms
2022-09-22 02:57:19 INFO  Executing generated plans
2022-09-22 03:01:58 INFO  ---RUNTIME: Execution took 278197.8962421417 ms
2022-09-22 03:01:58 INFO  Done!
2022-09-22 03:01:58 INFO  # Finished -- repetition 1 of 7 
2022-09-22 03:01:58 INFO  # Optimization benchmark for data_cleaning with args [['reviews', 'fast_loading', 'featurization_2', 'neural_network']] -- repetition 2 of 7
2022-09-22 03:01:58 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-22 03:01:58 INFO  Running instrumented original pipeline...
2022-09-22 03:01:58 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-22 03:01:58 INFO  ---RUNTIME: Importing and monkey-patching took 6.475687026977539 ms
2022-09-22 03:02:11 INFO  ---RUNTIME: Original pipeline execution took 13545.856237411499 ms (excluding imports and monkey-patching)
2022-09-22 03:02:11 INFO  Starting execution of 1 what-if analyses...
2022-09-22 03:02:11 INFO  Start plan generation for analysis DataCleaning...
2022-09-22 03:02:11 INFO  ---RUNTIME: Plan generation took 1.706838607788086 ms
2022-09-22 03:02:11 INFO  Estimated runtime of original DAG is 12293.768882751465ms
2022-09-22 03:02:11 INFO  Performing Multi-Query Optimization
2022-09-22 03:02:11 INFO  Estimated unoptimized what-if runtime is 245875.3776550293ms
2022-09-22 03:02:11 INFO  Estimated optimised what-if runtime is 155462.00108528137ms
2022-09-22 03:02:11 INFO  Estimated optimisation runtime saving is 90413.37656974792ms
2022-09-22 03:02:11 INFO  ---RUNTIME: Multi-Query Optimization took 105.10468482971191 ms
2022-09-22 03:02:11 INFO  Executing generated plans
2022-09-22 03:04:59 INFO  ---RUNTIME: Execution took 167882.395029068 ms
2022-09-22 03:04:59 INFO  Done!
2022-09-22 03:04:59 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-22 03:04:59 INFO  Running instrumented original pipeline...
2022-09-22 03:04:59 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-22 03:04:59 INFO  ---RUNTIME: Importing and monkey-patching took 6.19816780090332 ms
2022-09-22 03:05:13 INFO  ---RUNTIME: Original pipeline execution took 13499.124765396118 ms (excluding imports and monkey-patching)
2022-09-22 03:05:13 INFO  Starting execution of 1 what-if analyses...
2022-09-22 03:05:13 INFO  Start plan generation for analysis DataCleaning...
2022-09-22 03:05:13 INFO  ---RUNTIME: Plan generation took 0.6537437438964844 ms
2022-09-22 03:05:13 INFO  Estimated runtime of original DAG is 12265.609741210938ms
2022-09-22 03:05:13 WARNING Skipping Multi-Query Optimization (instead, only applying patches)
2022-09-22 03:05:13 WARNING Columns ['review_id'] not present in train DAG after the train test split, only before!
2022-09-22 03:05:13 WARNING This could hint at data leakage!
2022-09-22 03:05:13 INFO  Estimated unoptimised what-if runtime is 245312.19482421875ms
2022-09-22 03:05:13 INFO  ---RUNTIME: Multi-Query Optimization took 24.636507034301758 ms
2022-09-22 03:05:13 INFO  Executing generated plans
2022-09-22 03:09:50 INFO  ---RUNTIME: Execution took 276904.66952323914 ms
2022-09-22 03:09:50 INFO  Done!
2022-09-22 03:09:50 INFO  # Finished -- repetition 2 of 7 
2022-09-22 03:09:50 INFO  # Optimization benchmark for data_cleaning with args [['reviews', 'fast_loading', 'featurization_2', 'neural_network']] -- repetition 3 of 7
2022-09-22 03:09:50 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-22 03:09:50 INFO  Running instrumented original pipeline...
2022-09-22 03:09:50 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-22 03:09:50 INFO  ---RUNTIME: Importing and monkey-patching took 5.984067916870117 ms
2022-09-22 03:10:03 INFO  ---RUNTIME: Original pipeline execution took 13828.217506408691 ms (excluding imports and monkey-patching)
2022-09-22 03:10:03 INFO  Starting execution of 1 what-if analyses...
2022-09-22 03:10:03 INFO  Start plan generation for analysis DataCleaning...
2022-09-22 03:10:03 INFO  ---RUNTIME: Plan generation took 0.5791187286376953 ms
2022-09-22 03:10:03 INFO  Estimated runtime of original DAG is 12620.065450668335ms
2022-09-22 03:10:03 INFO  Performing Multi-Query Optimization
2022-09-22 03:10:03 INFO  Estimated unoptimized what-if runtime is 252401.3090133667ms
2022-09-22 03:10:03 INFO  Estimated optimised what-if runtime is 164842.02432632446ms
2022-09-22 03:10:03 INFO  Estimated optimisation runtime saving is 87559.28468704224ms
2022-09-22 03:10:03 INFO  ---RUNTIME: Multi-Query Optimization took 99.10058975219727 ms
2022-09-22 03:10:03 INFO  Executing generated plans
2022-09-22 03:12:51 INFO  ---RUNTIME: Execution took 167869.5523738861 ms
2022-09-22 03:12:51 INFO  Done!
2022-09-22 03:12:51 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-22 03:12:51 INFO  Running instrumented original pipeline...
2022-09-22 03:12:51 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-22 03:12:51 INFO  ---RUNTIME: Importing and monkey-patching took 6.829023361206055 ms
2022-09-22 03:13:05 INFO  ---RUNTIME: Original pipeline execution took 13433.703422546387 ms (excluding imports and monkey-patching)
2022-09-22 03:13:05 INFO  Starting execution of 1 what-if analyses...
2022-09-22 03:13:05 INFO  Start plan generation for analysis DataCleaning...
2022-09-22 03:13:05 INFO  ---RUNTIME: Plan generation took 0.6413459777832031 ms
2022-09-22 03:13:05 INFO  Estimated runtime of original DAG is 12223.511457443237ms
2022-09-22 03:13:05 WARNING Skipping Multi-Query Optimization (instead, only applying patches)
2022-09-22 03:13:05 WARNING Columns ['review_id'] not present in train DAG after the train test split, only before!
2022-09-22 03:13:05 WARNING This could hint at data leakage!
2022-09-22 03:13:05 INFO  Estimated unoptimised what-if runtime is 244470.22914886475ms
2022-09-22 03:13:05 INFO  ---RUNTIME: Multi-Query Optimization took 24.09672737121582 ms
2022-09-22 03:13:05 INFO  Executing generated plans
2022-09-22 03:17:40 INFO  ---RUNTIME: Execution took 275662.12582588196 ms
2022-09-22 03:17:40 INFO  Done!
2022-09-22 03:17:40 INFO  # Finished -- repetition 3 of 7 
2022-09-22 03:17:40 INFO  # Optimization benchmark for data_cleaning with args [['reviews', 'fast_loading', 'featurization_2', 'neural_network']] -- repetition 4 of 7
2022-09-22 03:17:40 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-22 03:17:40 INFO  Running instrumented original pipeline...
2022-09-22 03:17:41 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-22 03:17:41 INFO  ---RUNTIME: Importing and monkey-patching took 5.944728851318359 ms
2022-09-22 03:17:55 INFO  ---RUNTIME: Original pipeline execution took 14333.21475982666 ms (excluding imports and monkey-patching)
2022-09-22 03:17:55 INFO  Starting execution of 1 what-if analyses...
2022-09-22 03:17:55 INFO  Start plan generation for analysis DataCleaning...
2022-09-22 03:17:55 INFO  ---RUNTIME: Plan generation took 0.6129741668701172 ms
2022-09-22 03:17:55 INFO  Estimated runtime of original DAG is 12712.430953979492ms
2022-09-22 03:17:55 INFO  Performing Multi-Query Optimization
2022-09-22 03:17:55 INFO  Estimated unoptimized what-if runtime is 254248.61907958984ms
2022-09-22 03:17:55 INFO  Estimated optimised what-if runtime is 166422.21522331238ms
2022-09-22 03:17:55 INFO  Estimated optimisation runtime saving is 87826.40385627747ms
2022-09-22 03:17:55 INFO  ---RUNTIME: Multi-Query Optimization took 98.46115112304688 ms
2022-09-22 03:17:55 INFO  Executing generated plans
2022-09-22 03:20:42 INFO  ---RUNTIME: Execution took 166727.98919677734 ms
2022-09-22 03:20:42 INFO  Done!
2022-09-22 03:20:42 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-22 03:20:42 INFO  Running instrumented original pipeline...
2022-09-22 03:20:42 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-22 03:20:42 INFO  ---RUNTIME: Importing and monkey-patching took 5.79380989074707 ms
2022-09-22 03:20:55 INFO  ---RUNTIME: Original pipeline execution took 13424.68237876892 ms (excluding imports and monkey-patching)
2022-09-22 03:20:55 INFO  Starting execution of 1 what-if analyses...
2022-09-22 03:20:55 INFO  Start plan generation for analysis DataCleaning...
2022-09-22 03:20:55 INFO  ---RUNTIME: Plan generation took 0.652313232421875 ms
2022-09-22 03:20:55 INFO  Estimated runtime of original DAG is 12194.451332092285ms
2022-09-22 03:20:55 WARNING Skipping Multi-Query Optimization (instead, only applying patches)
2022-09-22 03:20:55 WARNING Columns ['review_id'] not present in train DAG after the train test split, only before!
2022-09-22 03:20:55 WARNING This could hint at data leakage!
2022-09-22 03:20:55 INFO  Estimated unoptimised what-if runtime is 243889.0266418457ms
2022-09-22 03:20:55 INFO  ---RUNTIME: Multi-Query Optimization took 24.858713150024414 ms
2022-09-22 03:20:55 INFO  Executing generated plans
2022-09-22 03:25:30 INFO  ---RUNTIME: Execution took 274380.6314468384 ms
2022-09-22 03:25:30 INFO  Done!
2022-09-22 03:25:30 INFO  # Finished -- repetition 4 of 7 
2022-09-22 03:25:30 INFO  # Optimization benchmark for data_cleaning with args [['reviews', 'fast_loading', 'featurization_2', 'neural_network']] -- repetition 5 of 7
2022-09-22 03:25:30 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-22 03:25:30 INFO  Running instrumented original pipeline...
2022-09-22 03:25:30 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-22 03:25:30 INFO  ---RUNTIME: Importing and monkey-patching took 6.87098503112793 ms
2022-09-22 03:25:44 INFO  ---RUNTIME: Original pipeline execution took 14123.402118682861 ms (excluding imports and monkey-patching)
2022-09-22 03:25:44 INFO  Starting execution of 1 what-if analyses...
2022-09-22 03:25:44 INFO  Start plan generation for analysis DataCleaning...
2022-09-22 03:25:44 INFO  ---RUNTIME: Plan generation took 0.6418228149414062 ms
2022-09-22 03:25:44 INFO  Estimated runtime of original DAG is 12492.95163154602ms
2022-09-22 03:25:44 INFO  Performing Multi-Query Optimization
2022-09-22 03:25:44 INFO  Estimated unoptimized what-if runtime is 249859.0326309204ms
2022-09-22 03:25:44 INFO  Estimated optimised what-if runtime is 159874.66144561768ms
2022-09-22 03:25:44 INFO  Estimated optimisation runtime saving is 89984.37118530273ms
2022-09-22 03:25:44 INFO  ---RUNTIME: Multi-Query Optimization took 100.46744346618652 ms
2022-09-22 03:25:44 INFO  Executing generated plans
2022-09-22 03:28:30 INFO  ---RUNTIME: Execution took 166428.84588241577 ms
2022-09-22 03:28:30 INFO  Done!
2022-09-22 03:28:30 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-22 03:28:30 INFO  Running instrumented original pipeline...
2022-09-22 03:28:30 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-22 03:28:30 INFO  ---RUNTIME: Importing and monkey-patching took 6.450176239013672 ms
2022-09-22 03:28:44 INFO  ---RUNTIME: Original pipeline execution took 13330.152750015259 ms (excluding imports and monkey-patching)
2022-09-22 03:28:44 INFO  Starting execution of 1 what-if analyses...
2022-09-22 03:28:44 INFO  Start plan generation for analysis DataCleaning...
2022-09-22 03:28:44 INFO  ---RUNTIME: Plan generation took 0.7755756378173828 ms
2022-09-22 03:28:44 INFO  Estimated runtime of original DAG is 12064.919471740723ms
2022-09-22 03:28:44 WARNING Skipping Multi-Query Optimization (instead, only applying patches)
2022-09-22 03:28:44 WARNING Columns ['review_id'] not present in train DAG after the train test split, only before!
2022-09-22 03:28:44 WARNING This could hint at data leakage!
2022-09-22 03:28:44 INFO  Estimated unoptimised what-if runtime is 241298.38943481445ms
2022-09-22 03:28:44 INFO  ---RUNTIME: Multi-Query Optimization took 27.797698974609375 ms
2022-09-22 03:28:44 INFO  Executing generated plans
2022-09-22 03:33:17 INFO  ---RUNTIME: Execution took 273621.02794647217 ms
2022-09-22 03:33:17 INFO  Done!
2022-09-22 03:33:17 INFO  # Finished -- repetition 5 of 7 
2022-09-22 03:33:17 INFO  # Optimization benchmark for data_cleaning with args [['reviews', 'fast_loading', 'featurization_2', 'neural_network']] -- repetition 6 of 7
2022-09-22 03:33:17 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-22 03:33:17 INFO  Running instrumented original pipeline...
2022-09-22 03:33:17 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-22 03:33:17 INFO  ---RUNTIME: Importing and monkey-patching took 5.856037139892578 ms
2022-09-22 03:33:31 INFO  ---RUNTIME: Original pipeline execution took 13656.866312026978 ms (excluding imports and monkey-patching)
2022-09-22 03:33:31 INFO  Starting execution of 1 what-if analyses...
2022-09-22 03:33:31 INFO  Start plan generation for analysis DataCleaning...
2022-09-22 03:33:31 INFO  ---RUNTIME: Plan generation took 0.6070137023925781 ms
2022-09-22 03:33:31 INFO  Estimated runtime of original DAG is 12448.81820678711ms
2022-09-22 03:33:31 INFO  Performing Multi-Query Optimization
2022-09-22 03:33:31 INFO  Estimated unoptimized what-if runtime is 248976.3641357422ms
2022-09-22 03:33:31 INFO  Estimated optimised what-if runtime is 160760.4501247406ms
2022-09-22 03:33:31 INFO  Estimated optimisation runtime saving is 88215.91401100159ms
2022-09-22 03:33:31 INFO  ---RUNTIME: Multi-Query Optimization took 97.40161895751953 ms
2022-09-22 03:33:31 INFO  Executing generated plans
2022-09-22 03:36:17 INFO  ---RUNTIME: Execution took 166088.36126327515 ms
2022-09-22 03:36:17 INFO  Done!
2022-09-22 03:36:17 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-22 03:36:17 INFO  Running instrumented original pipeline...
2022-09-22 03:36:17 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-22 03:36:17 INFO  ---RUNTIME: Importing and monkey-patching took 5.79380989074707 ms
2022-09-22 03:36:31 INFO  ---RUNTIME: Original pipeline execution took 13499.293804168701 ms (excluding imports and monkey-patching)
2022-09-22 03:36:31 INFO  Starting execution of 1 what-if analyses...
2022-09-22 03:36:31 INFO  Start plan generation for analysis DataCleaning...
2022-09-22 03:36:31 INFO  ---RUNTIME: Plan generation took 0.5970001220703125 ms
2022-09-22 03:36:31 INFO  Estimated runtime of original DAG is 12263.905048370361ms
2022-09-22 03:36:31 WARNING Skipping Multi-Query Optimization (instead, only applying patches)
2022-09-22 03:36:31 WARNING Columns ['review_id'] not present in train DAG after the train test split, only before!
2022-09-22 03:36:31 WARNING This could hint at data leakage!
2022-09-22 03:36:31 INFO  Estimated unoptimised what-if runtime is 245278.10096740723ms
2022-09-22 03:36:31 INFO  ---RUNTIME: Multi-Query Optimization took 24.28746223449707 ms
2022-09-22 03:36:31 INFO  Executing generated plans
2022-09-22 03:41:03 INFO  ---RUNTIME: Execution took 272904.7725200653 ms
2022-09-22 03:41:03 INFO  Done!
2022-09-22 03:41:03 INFO  # Finished -- repetition 6 of 7 
2022-09-22 03:41:03 INFO  # Optimization benchmark for data_cleaning with args [['reviews', 'fast_loading', 'featurization_2', 'neural_network']] -- repetition 7 of 7
2022-09-22 03:41:03 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-22 03:41:03 INFO  Running instrumented original pipeline...
2022-09-22 03:41:04 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-22 03:41:04 INFO  ---RUNTIME: Importing and monkey-patching took 5.8879852294921875 ms
2022-09-22 03:41:18 INFO  ---RUNTIME: Original pipeline execution took 14237.531900405884 ms (excluding imports and monkey-patching)
2022-09-22 03:41:18 INFO  Starting execution of 1 what-if analyses...
2022-09-22 03:41:18 INFO  Start plan generation for analysis DataCleaning...
2022-09-22 03:41:18 INFO  ---RUNTIME: Plan generation took 0.7026195526123047 ms
2022-09-22 03:41:18 INFO  Estimated runtime of original DAG is 13024.65796470642ms
2022-09-22 03:41:18 INFO  Performing Multi-Query Optimization
2022-09-22 03:41:18 INFO  Estimated unoptimized what-if runtime is 260493.15929412842ms
2022-09-22 03:41:18 INFO  Estimated optimised what-if runtime is 171134.3948841095ms
2022-09-22 03:41:18 INFO  Estimated optimisation runtime saving is 89358.76441001892ms
2022-09-22 03:41:18 INFO  ---RUNTIME: Multi-Query Optimization took 110.76664924621582 ms
2022-09-22 03:41:18 INFO  Executing generated plans
2022-09-22 03:44:04 INFO  ---RUNTIME: Execution took 166605.31854629517 ms
2022-09-22 03:44:04 INFO  Done!
2022-09-22 03:44:04 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-22 03:44:04 INFO  Running instrumented original pipeline...
2022-09-22 03:44:04 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-22 03:44:05 INFO  ---RUNTIME: Importing and monkey-patching took 6.579875946044922 ms
2022-09-22 03:44:18 INFO  ---RUNTIME: Original pipeline execution took 13335.171222686768 ms (excluding imports and monkey-patching)
2022-09-22 03:44:18 INFO  Starting execution of 1 what-if analyses...
2022-09-22 03:44:18 INFO  Start plan generation for analysis DataCleaning...
2022-09-22 03:44:18 INFO  ---RUNTIME: Plan generation took 0.5891323089599609 ms
2022-09-22 03:44:18 INFO  Estimated runtime of original DAG is 12085.051536560059ms
2022-09-22 03:44:18 WARNING Skipping Multi-Query Optimization (instead, only applying patches)
2022-09-22 03:44:18 WARNING Columns ['review_id'] not present in train DAG after the train test split, only before!
2022-09-22 03:44:18 WARNING This could hint at data leakage!
2022-09-22 03:44:18 INFO  Estimated unoptimised what-if runtime is 241701.03073120117ms
2022-09-22 03:44:18 INFO  ---RUNTIME: Multi-Query Optimization took 24.54209327697754 ms
2022-09-22 03:44:18 INFO  Executing generated plans
2022-09-22 03:48:48 INFO  ---RUNTIME: Execution took 269829.9009799957 ms
2022-09-22 03:48:48 INFO  Done!
2022-09-22 03:48:48 INFO  # Finished -- repetition 7 of 7 
2022-09-22 03:48:48 INFO  # Final results after all repetitions
2022-09-22 03:48:48 INFO     repetition  ... no_opt_what_if_execution_combined_model_training
0           0  ...                                    124852.427483
1           1  ...                                    126515.663385
2           2  ...                                    125948.656082
3           3  ...                                    123477.504969
4           4  ...                                    122920.299292
5           5  ...                                    123529.777050
6           6  ...                                    119895.341635

[7 rows x 26 columns]
taskset -c 160-167 PROTOCOL_BUFFERS_PYTHON_IMPLEMENTATION=python python3.9 benchmarks_end_to_end.py data_cleaning reviews fast_loading featurization_3 logistic_regression
2022-09-22 03:48:50.934777: W tensorflow/stream_executor/platform/default/dso_loader.cc:64] Could not load dynamic library 'libcudart.so.11.0'; dlerror: libcudart.so.11.0: cannot open shared object file: No such file or directory; LD_LIBRARY_PATH: /home/sgrafbe/mlwhatif/venv/lib/python3.9/site-packages/cv2/../../lib64:
2022-09-22 03:48:50.934822: I tensorflow/stream_executor/cuda/cudart_stub.cc:29] Ignore above cudart dlerror if you do not have a GPU set up on your machine.
2022-09-22 03:48:52 INFO  Patching sys.argv with ['mlwhatif', 'reviews', 'fast_loading', 'featurization_3', 'logistic_regression']
2022-09-22 03:48:52 INFO  Running instrumented original pipeline...
2022-09-22 03:48:52 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-22 03:48:52 INFO  ---RUNTIME: Importing and monkey-patching took 122.41029739379883 ms
2022-09-22 03:49:33 INFO  ---RUNTIME: Original pipeline execution took 40829.970598220825 ms (excluding imports and monkey-patching)
2022-09-22 03:49:33 INFO  Starting execution of 0 what-if analyses...
2022-09-22 03:49:33 INFO  Estimated runtime of original DAG is 32597.282648086548ms
2022-09-22 03:49:33 INFO  Performing Multi-Query Optimization
2022-09-22 03:49:33 INFO  Estimated unoptimized what-if runtime is 0ms
2022-09-22 03:49:33 INFO  Estimated optimised what-if runtime is 0ms
2022-09-22 03:49:33 INFO  Estimated optimisation runtime saving is 0ms
2022-09-22 03:49:33 INFO  ---RUNTIME: Multi-Query Optimization took 0.6148815155029297 ms
2022-09-22 03:49:33 INFO  Executing generated plans
2022-09-22 03:49:33 INFO  ---RUNTIME: Execution took 0.0286102294921875 ms
2022-09-22 03:49:33 INFO  Done!
2022-09-22 03:49:33 INFO  # Optimization benchmark for data_cleaning with args [['reviews', 'fast_loading', 'featurization_3', 'logistic_regression']] -- repetition 1 of 7
2022-09-22 03:49:33 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-22 03:49:33 INFO  Running instrumented original pipeline...
2022-09-22 03:49:33 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-22 03:49:33 INFO  ---RUNTIME: Importing and monkey-patching took 5.701303482055664 ms
2022-09-22 03:50:19 INFO  ---RUNTIME: Original pipeline execution took 46687.76059150696 ms (excluding imports and monkey-patching)
2022-09-22 03:50:19 INFO  Starting execution of 1 what-if analyses...
2022-09-22 03:50:19 INFO  Start plan generation for analysis DataCleaning...
2022-09-22 03:50:19 INFO  ---RUNTIME: Plan generation took 0.8304119110107422 ms
2022-09-22 03:50:19 INFO  Estimated runtime of original DAG is 33024.99175071716ms
2022-09-22 03:50:19 INFO  Performing Multi-Query Optimization
2022-09-22 03:50:20 INFO  Estimated unoptimized what-if runtime is 660499.8350143433ms
2022-09-22 03:50:20 INFO  Estimated optimised what-if runtime is 160799.83806610107ms
2022-09-22 03:50:20 INFO  Estimated optimisation runtime saving is 499699.9969482422ms
2022-09-22 03:50:20 INFO  ---RUNTIME: Multi-Query Optimization took 119.69304084777832 ms
2022-09-22 03:50:20 INFO  Executing generated plans
2022-09-22 03:53:34 INFO  ---RUNTIME: Execution took 194026.23319625854 ms
2022-09-22 03:53:34 INFO  Done!
2022-09-22 03:53:34 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-22 03:53:34 INFO  Running instrumented original pipeline...
2022-09-22 03:53:34 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-22 03:53:34 INFO  ---RUNTIME: Importing and monkey-patching took 6.280660629272461 ms
2022-09-22 03:54:25 INFO  ---RUNTIME: Original pipeline execution took 51715.06381034851 ms (excluding imports and monkey-patching)
2022-09-22 03:54:25 INFO  Starting execution of 1 what-if analyses...
2022-09-22 03:54:25 INFO  Start plan generation for analysis DataCleaning...
2022-09-22 03:54:25 INFO  ---RUNTIME: Plan generation took 0.9758472442626953 ms
2022-09-22 03:54:25 INFO  Estimated runtime of original DAG is 35525.60496330261ms
2022-09-22 03:54:25 WARNING Skipping Multi-Query Optimization (instead, only applying patches)
2022-09-22 03:54:25 WARNING Columns ['review_id'] not present in train DAG after the train test split, only before!
2022-09-22 03:54:25 WARNING This could hint at data leakage!
2022-09-22 03:54:25 INFO  Estimated unoptimised what-if runtime is 710512.0992660522ms
2022-09-22 03:54:25 INFO  ---RUNTIME: Multi-Query Optimization took 30.823230743408203 ms
2022-09-22 03:54:25 INFO  Executing generated plans
2022-09-22 04:05:36 INFO  ---RUNTIME: Execution took 670430.8059215546 ms
2022-09-22 04:05:36 INFO  Done!
2022-09-22 04:05:36 INFO  # Finished -- repetition 1 of 7 
2022-09-22 04:05:36 INFO  # Optimization benchmark for data_cleaning with args [['reviews', 'fast_loading', 'featurization_3', 'logistic_regression']] -- repetition 2 of 7
2022-09-22 04:05:36 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-22 04:05:36 INFO  Running instrumented original pipeline...
2022-09-22 04:05:36 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-22 04:05:36 INFO  ---RUNTIME: Importing and monkey-patching took 12.215137481689453 ms
2022-09-22 04:06:19 INFO  ---RUNTIME: Original pipeline execution took 43143.76497268677 ms (excluding imports and monkey-patching)
2022-09-22 04:06:19 INFO  Starting execution of 1 what-if analyses...
2022-09-22 04:06:19 INFO  Start plan generation for analysis DataCleaning...
2022-09-22 04:06:19 INFO  ---RUNTIME: Plan generation took 0.8726119995117188 ms
2022-09-22 04:06:19 INFO  Estimated runtime of original DAG is 34103.355884552ms
2022-09-22 04:06:19 INFO  Performing Multi-Query Optimization
2022-09-22 04:06:19 INFO  Estimated unoptimized what-if runtime is 682067.11769104ms
2022-09-22 04:06:19 INFO  Estimated optimised what-if runtime is 166056.0007095337ms
2022-09-22 04:06:19 INFO  Estimated optimisation runtime saving is 516011.11698150635ms
2022-09-22 04:06:19 INFO  ---RUNTIME: Multi-Query Optimization took 118.95132064819336 ms
2022-09-22 04:06:19 INFO  Executing generated plans
2022-09-22 04:09:25 INFO  ---RUNTIME: Execution took 185711.0617160797 ms
2022-09-22 04:09:25 INFO  Done!
2022-09-22 04:09:26 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-22 04:09:26 INFO  Running instrumented original pipeline...
2022-09-22 04:09:26 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-22 04:09:26 INFO  ---RUNTIME: Importing and monkey-patching took 6.105899810791016 ms
2022-09-22 04:10:21 INFO  ---RUNTIME: Original pipeline execution took 55005.07068634033 ms (excluding imports and monkey-patching)
2022-09-22 04:10:21 INFO  Starting execution of 1 what-if analyses...
2022-09-22 04:10:21 INFO  Start plan generation for analysis DataCleaning...
2022-09-22 04:10:21 INFO  ---RUNTIME: Plan generation took 0.8287429809570312 ms
2022-09-22 04:10:21 INFO  Estimated runtime of original DAG is 40525.81310272217ms
2022-09-22 04:10:21 WARNING Skipping Multi-Query Optimization (instead, only applying patches)
2022-09-22 04:10:21 WARNING Columns ['review_id'] not present in train DAG after the train test split, only before!
2022-09-22 04:10:21 WARNING This could hint at data leakage!
2022-09-22 04:10:21 INFO  Estimated unoptimised what-if runtime is 810516.2620544434ms
2022-09-22 04:10:21 INFO  ---RUNTIME: Multi-Query Optimization took 29.041051864624023 ms
2022-09-22 04:10:21 INFO  Executing generated plans
2022-09-22 04:20:01 INFO  ---RUNTIME: Execution took 579424.2761135101 ms
2022-09-22 04:20:01 INFO  Done!
2022-09-22 04:20:03 INFO  # Finished -- repetition 2 of 7 
2022-09-22 04:20:03 INFO  # Optimization benchmark for data_cleaning with args [['reviews', 'fast_loading', 'featurization_3', 'logistic_regression']] -- repetition 3 of 7
2022-09-22 04:20:03 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-22 04:20:03 INFO  Running instrumented original pipeline...
2022-09-22 04:20:03 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-22 04:20:03 INFO  ---RUNTIME: Importing and monkey-patching took 6.201028823852539 ms
2022-09-22 04:20:43 INFO  ---RUNTIME: Original pipeline execution took 40910.57109832764 ms (excluding imports and monkey-patching)
2022-09-22 04:20:43 INFO  Starting execution of 1 what-if analyses...
2022-09-22 04:20:43 INFO  Start plan generation for analysis DataCleaning...
2022-09-22 04:20:43 INFO  ---RUNTIME: Plan generation took 0.8356571197509766 ms
2022-09-22 04:20:43 INFO  Estimated runtime of original DAG is 33516.81876182556ms
2022-09-22 04:20:43 INFO  Performing Multi-Query Optimization
2022-09-22 04:20:44 INFO  Estimated unoptimized what-if runtime is 670336.3752365112ms
2022-09-22 04:20:44 INFO  Estimated optimised what-if runtime is 163038.9952659607ms
2022-09-22 04:20:44 INFO  Estimated optimisation runtime saving is 507297.37997055054ms
2022-09-22 04:20:44 INFO  ---RUNTIME: Multi-Query Optimization took 120.18132209777832 ms
2022-09-22 04:20:44 INFO  Executing generated plans
2022-09-22 04:23:35 INFO  ---RUNTIME: Execution took 171368.27778816223 ms
2022-09-22 04:23:35 INFO  Done!
2022-09-22 04:23:36 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-22 04:23:36 INFO  Running instrumented original pipeline...
2022-09-22 04:23:36 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-22 04:23:36 INFO  ---RUNTIME: Importing and monkey-patching took 6.129026412963867 ms
2022-09-22 04:24:17 INFO  ---RUNTIME: Original pipeline execution took 40955.379009246826 ms (excluding imports and monkey-patching)
2022-09-22 04:24:17 INFO  Starting execution of 1 what-if analyses...
2022-09-22 04:24:17 INFO  Start plan generation for analysis DataCleaning...
2022-09-22 04:24:17 INFO  ---RUNTIME: Plan generation took 0.8273124694824219 ms
2022-09-22 04:24:17 INFO  Estimated runtime of original DAG is 33701.51352882385ms
2022-09-22 04:24:17 WARNING Skipping Multi-Query Optimization (instead, only applying patches)
2022-09-22 04:24:17 WARNING Columns ['review_id'] not present in train DAG after the train test split, only before!
2022-09-22 04:24:17 WARNING This could hint at data leakage!
2022-09-22 04:24:17 INFO  Estimated unoptimised what-if runtime is 674030.270576477ms
2022-09-22 04:24:17 INFO  ---RUNTIME: Multi-Query Optimization took 28.984546661376953 ms
2022-09-22 04:24:17 INFO  Executing generated plans
2022-09-22 04:34:09 INFO  ---RUNTIME: Execution took 592172.2414493561 ms
2022-09-22 04:34:09 INFO  Done!
2022-09-22 04:34:11 INFO  # Finished -- repetition 3 of 7 
2022-09-22 04:34:11 INFO  # Optimization benchmark for data_cleaning with args [['reviews', 'fast_loading', 'featurization_3', 'logistic_regression']] -- repetition 4 of 7
2022-09-22 04:34:11 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-22 04:34:11 INFO  Running instrumented original pipeline...
2022-09-22 04:34:11 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-22 04:34:11 INFO  ---RUNTIME: Importing and monkey-patching took 6.292104721069336 ms
2022-09-22 04:34:56 INFO  ---RUNTIME: Original pipeline execution took 45724.86901283264 ms (excluding imports and monkey-patching)
2022-09-22 04:34:56 INFO  Starting execution of 1 what-if analyses...
2022-09-22 04:34:56 INFO  Start plan generation for analysis DataCleaning...
2022-09-22 04:34:56 INFO  ---RUNTIME: Plan generation took 0.8232593536376953 ms
2022-09-22 04:34:56 INFO  Estimated runtime of original DAG is 33582.29947090149ms
2022-09-22 04:34:56 INFO  Performing Multi-Query Optimization
2022-09-22 04:34:56 INFO  Estimated unoptimized what-if runtime is 671645.9894180298ms
2022-09-22 04:34:56 INFO  Estimated optimised what-if runtime is 163085.18624305725ms
2022-09-22 04:34:56 INFO  Estimated optimisation runtime saving is 508560.80317497253ms
2022-09-22 04:34:56 INFO  ---RUNTIME: Multi-Query Optimization took 120.95952033996582 ms
2022-09-22 04:34:56 INFO  Executing generated plans
2022-09-22 04:38:02 INFO  ---RUNTIME: Execution took 185509.27662849426 ms
2022-09-22 04:38:02 INFO  Done!
2022-09-22 04:38:02 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-22 04:38:02 INFO  Running instrumented original pipeline...
2022-09-22 04:38:02 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-22 04:38:02 INFO  ---RUNTIME: Importing and monkey-patching took 6.323814392089844 ms
2022-09-22 04:38:43 INFO  ---RUNTIME: Original pipeline execution took 40672.88827896118 ms (excluding imports and monkey-patching)
2022-09-22 04:38:43 INFO  Starting execution of 1 what-if analyses...
2022-09-22 04:38:43 INFO  Start plan generation for analysis DataCleaning...
2022-09-22 04:38:43 INFO  ---RUNTIME: Plan generation took 0.8280277252197266 ms
2022-09-22 04:38:43 INFO  Estimated runtime of original DAG is 33349.785804748535ms
2022-09-22 04:38:43 WARNING Skipping Multi-Query Optimization (instead, only applying patches)
2022-09-22 04:38:43 WARNING Columns ['review_id'] not present in train DAG after the train test split, only before!
2022-09-22 04:38:43 WARNING This could hint at data leakage!
2022-09-22 04:38:43 INFO  Estimated unoptimised what-if runtime is 666995.7160949707ms
2022-09-22 04:38:43 INFO  ---RUNTIME: Multi-Query Optimization took 29.745817184448242 ms
2022-09-22 04:38:43 INFO  Executing generated plans
2022-09-22 04:50:14 INFO  ---RUNTIME: Execution took 691475.2061367035 ms
2022-09-22 04:50:14 INFO  Done!
2022-09-22 04:50:14 INFO  # Finished -- repetition 4 of 7 
2022-09-22 04:50:14 INFO  # Optimization benchmark for data_cleaning with args [['reviews', 'fast_loading', 'featurization_3', 'logistic_regression']] -- repetition 5 of 7
2022-09-22 04:50:14 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-22 04:50:14 INFO  Running instrumented original pipeline...
2022-09-22 04:50:14 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-22 04:50:14 INFO  ---RUNTIME: Importing and monkey-patching took 6.250619888305664 ms
2022-09-22 04:50:55 INFO  ---RUNTIME: Original pipeline execution took 40421.536445617676 ms (excluding imports and monkey-patching)
2022-09-22 04:50:55 INFO  Starting execution of 1 what-if analyses...
2022-09-22 04:50:55 INFO  Start plan generation for analysis DataCleaning...
2022-09-22 04:50:55 INFO  ---RUNTIME: Plan generation took 0.8306503295898438 ms
2022-09-22 04:50:55 INFO  Estimated runtime of original DAG is 33030.16686439514ms
2022-09-22 04:50:55 INFO  Performing Multi-Query Optimization
2022-09-22 04:50:55 INFO  Estimated unoptimized what-if runtime is 660603.3372879028ms
2022-09-22 04:50:55 INFO  Estimated optimised what-if runtime is 160089.7195339203ms
2022-09-22 04:50:55 INFO  Estimated optimisation runtime saving is 500513.61775398254ms
2022-09-22 04:50:55 INFO  ---RUNTIME: Multi-Query Optimization took 122.50924110412598 ms
2022-09-22 04:50:55 INFO  Executing generated plans
2022-09-22 04:54:21 INFO  ---RUNTIME: Execution took 206558.37512016296 ms
2022-09-22 04:54:21 INFO  Done!
2022-09-22 04:54:23 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-22 04:54:23 INFO  Running instrumented original pipeline...
2022-09-22 04:54:23 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-22 04:54:23 INFO  ---RUNTIME: Importing and monkey-patching took 6.234884262084961 ms
2022-09-22 04:55:18 INFO  ---RUNTIME: Original pipeline execution took 55001.392126083374 ms (excluding imports and monkey-patching)
2022-09-22 04:55:18 INFO  Starting execution of 1 what-if analyses...
2022-09-22 04:55:18 INFO  Start plan generation for analysis DataCleaning...
2022-09-22 04:55:18 INFO  ---RUNTIME: Plan generation took 0.8568763732910156 ms
2022-09-22 04:55:18 INFO  Estimated runtime of original DAG is 41657.73844718933ms
2022-09-22 04:55:18 WARNING Skipping Multi-Query Optimization (instead, only applying patches)
2022-09-22 04:55:18 WARNING Columns ['review_id'] not present in train DAG after the train test split, only before!
2022-09-22 04:55:18 WARNING This could hint at data leakage!
2022-09-22 04:55:18 INFO  Estimated unoptimised what-if runtime is 833154.7689437866ms
2022-09-22 04:55:18 INFO  ---RUNTIME: Multi-Query Optimization took 30.48253059387207 ms
2022-09-22 04:55:18 INFO  Executing generated plans
2022-09-22 05:08:00 INFO  ---RUNTIME: Execution took 762580.0352096558 ms
2022-09-22 05:08:00 INFO  Done!
2022-09-22 05:08:00 INFO  # Finished -- repetition 5 of 7 
2022-09-22 05:08:00 INFO  # Optimization benchmark for data_cleaning with args [['reviews', 'fast_loading', 'featurization_3', 'logistic_regression']] -- repetition 6 of 7
2022-09-22 05:08:00 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-22 05:08:00 INFO  Running instrumented original pipeline...
2022-09-22 05:08:00 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-22 05:08:00 INFO  ---RUNTIME: Importing and monkey-patching took 6.322145462036133 ms
2022-09-22 05:08:46 INFO  ---RUNTIME: Original pipeline execution took 46122.377157211304 ms (excluding imports and monkey-patching)
2022-09-22 05:08:46 INFO  Starting execution of 1 what-if analyses...
2022-09-22 05:08:46 INFO  Start plan generation for analysis DataCleaning...
2022-09-22 05:08:46 INFO  ---RUNTIME: Plan generation took 0.8270740509033203 ms
2022-09-22 05:08:46 INFO  Estimated runtime of original DAG is 37900.71368217468ms
2022-09-22 05:08:46 INFO  Performing Multi-Query Optimization
2022-09-22 05:08:47 INFO  Estimated unoptimized what-if runtime is 758014.2736434937ms
2022-09-22 05:08:47 INFO  Estimated optimised what-if runtime is 185072.80611991882ms
2022-09-22 05:08:47 INFO  Estimated optimisation runtime saving is 572941.4675235748ms
2022-09-22 05:08:47 INFO  ---RUNTIME: Multi-Query Optimization took 123.75283241271973 ms
2022-09-22 05:08:47 INFO  Executing generated plans
2022-09-22 05:12:15 INFO  ---RUNTIME: Execution took 208165.92860221863 ms
2022-09-22 05:12:15 INFO  Done!
2022-09-22 05:12:15 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-22 05:12:15 INFO  Running instrumented original pipeline...
2022-09-22 05:12:15 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-22 05:12:15 INFO  ---RUNTIME: Importing and monkey-patching took 6.196022033691406 ms
2022-09-22 05:13:02 INFO  ---RUNTIME: Original pipeline execution took 46885.66851615906 ms (excluding imports and monkey-patching)
2022-09-22 05:13:02 INFO  Starting execution of 1 what-if analyses...
2022-09-22 05:13:02 INFO  Start plan generation for analysis DataCleaning...
2022-09-22 05:13:02 INFO  ---RUNTIME: Plan generation took 0.8282661437988281 ms
2022-09-22 05:13:02 INFO  Estimated runtime of original DAG is 39013.200759887695ms
2022-09-22 05:13:02 WARNING Skipping Multi-Query Optimization (instead, only applying patches)
2022-09-22 05:13:02 WARNING Columns ['review_id'] not present in train DAG after the train test split, only before!
2022-09-22 05:13:02 WARNING This could hint at data leakage!
2022-09-22 05:13:02 INFO  Estimated unoptimised what-if runtime is 780264.0151977539ms
2022-09-22 05:13:02 INFO  ---RUNTIME: Multi-Query Optimization took 31.385421752929688 ms
2022-09-22 05:13:02 INFO  Executing generated plans
2022-09-22 05:25:31 INFO  ---RUNTIME: Execution took 749152.0481109619 ms
2022-09-22 05:25:31 INFO  Done!
2022-09-22 05:25:32 INFO  # Finished -- repetition 6 of 7 
2022-09-22 05:25:32 INFO  # Optimization benchmark for data_cleaning with args [['reviews', 'fast_loading', 'featurization_3', 'logistic_regression']] -- repetition 7 of 7
2022-09-22 05:25:32 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-22 05:25:32 INFO  Running instrumented original pipeline...
2022-09-22 05:25:32 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-22 05:25:32 INFO  ---RUNTIME: Importing and monkey-patching took 6.528139114379883 ms
2022-09-22 05:26:26 INFO  ---RUNTIME: Original pipeline execution took 54219.101905822754 ms (excluding imports and monkey-patching)
2022-09-22 05:26:26 INFO  Starting execution of 1 what-if analyses...
2022-09-22 05:26:26 INFO  Start plan generation for analysis DataCleaning...
2022-09-22 05:26:26 INFO  ---RUNTIME: Plan generation took 0.9591579437255859 ms
2022-09-22 05:26:26 INFO  Estimated runtime of original DAG is 40533.215284347534ms
2022-09-22 05:26:26 INFO  Performing Multi-Query Optimization
2022-09-22 05:26:27 INFO  Estimated unoptimized what-if runtime is 810664.3056869507ms
2022-09-22 05:26:27 INFO  Estimated optimised what-if runtime is 197821.8014240265ms
2022-09-22 05:26:27 INFO  Estimated optimisation runtime saving is 612842.5042629242ms
2022-09-22 05:26:27 INFO  ---RUNTIME: Multi-Query Optimization took 124.64714050292969 ms
2022-09-22 05:26:27 INFO  Executing generated plans
2022-09-22 05:29:53 INFO  ---RUNTIME: Execution took 206344.2940711975 ms
2022-09-22 05:29:53 INFO  Done!
2022-09-22 05:29:53 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-22 05:29:53 INFO  Running instrumented original pipeline...
2022-09-22 05:29:53 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-22 05:29:53 INFO  ---RUNTIME: Importing and monkey-patching took 6.335735321044922 ms
2022-09-22 05:30:40 INFO  ---RUNTIME: Original pipeline execution took 46697.26300239563 ms (excluding imports and monkey-patching)
2022-09-22 05:30:40 INFO  Starting execution of 1 what-if analyses...
2022-09-22 05:30:40 INFO  Start plan generation for analysis DataCleaning...
2022-09-22 05:30:40 INFO  ---RUNTIME: Plan generation took 0.8037090301513672 ms
2022-09-22 05:30:40 INFO  Estimated runtime of original DAG is 39173.52509498596ms
2022-09-22 05:30:40 WARNING Skipping Multi-Query Optimization (instead, only applying patches)
2022-09-22 05:30:40 WARNING Columns ['review_id'] not present in train DAG after the train test split, only before!
2022-09-22 05:30:40 WARNING This could hint at data leakage!
2022-09-22 05:30:40 INFO  Estimated unoptimised what-if runtime is 783470.5018997192ms
2022-09-22 05:30:40 INFO  ---RUNTIME: Multi-Query Optimization took 29.818058013916016 ms
2022-09-22 05:30:40 INFO  Executing generated plans
2022-09-22 05:43:15 INFO  ---RUNTIME: Execution took 755049.5352745056 ms
2022-09-22 05:43:15 INFO  Done!
2022-09-22 05:43:15 INFO  # Finished -- repetition 7 of 7 
2022-09-22 05:43:15 INFO  # Final results after all repetitions
2022-09-22 05:43:15 INFO     repetition  ... no_opt_what_if_execution_combined_model_training
0           0  ...                                      2081.964016
1           1  ...                                      2023.628235
2           2  ...                                      1876.223087
3           3  ...                                      1965.955496
4           4  ...                                      2704.942942
5           5  ...                                      2917.287588
6           6  ...                                      2300.154209

[7 rows x 26 columns]
taskset -c 160-167 PROTOCOL_BUFFERS_PYTHON_IMPLEMENTATION=python python3.9 benchmarks_end_to_end.py data_cleaning reviews fast_loading featurization_3 xgboost
2022-09-22 05:43:20.833873: W tensorflow/stream_executor/platform/default/dso_loader.cc:64] Could not load dynamic library 'libcudart.so.11.0'; dlerror: libcudart.so.11.0: cannot open shared object file: No such file or directory; LD_LIBRARY_PATH: /home/sgrafbe/mlwhatif/venv/lib/python3.9/site-packages/cv2/../../lib64:
2022-09-22 05:43:20.833913: I tensorflow/stream_executor/cuda/cudart_stub.cc:29] Ignore above cudart dlerror if you do not have a GPU set up on your machine.
2022-09-22 05:43:22 INFO  Patching sys.argv with ['mlwhatif', 'reviews', 'fast_loading', 'featurization_3', 'xgboost']
2022-09-22 05:43:22 INFO  Running instrumented original pipeline...
2022-09-22 05:43:22 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-22 05:43:22 INFO  ---RUNTIME: Importing and monkey-patching took 120.98050117492676 ms
2022-09-22 05:44:15 INFO  ---RUNTIME: Original pipeline execution took 53620.276927948 ms (excluding imports and monkey-patching)
2022-09-22 05:44:15 INFO  Starting execution of 0 what-if analyses...
2022-09-22 05:44:15 INFO  Estimated runtime of original DAG is 46309.492349624634ms
2022-09-22 05:44:15 INFO  Performing Multi-Query Optimization
2022-09-22 05:44:15 INFO  Estimated unoptimized what-if runtime is 0ms
2022-09-22 05:44:15 INFO  Estimated optimised what-if runtime is 0ms
2022-09-22 05:44:15 INFO  Estimated optimisation runtime saving is 0ms
2022-09-22 05:44:15 INFO  ---RUNTIME: Multi-Query Optimization took 0.6005764007568359 ms
2022-09-22 05:44:15 INFO  Executing generated plans
2022-09-22 05:44:15 INFO  ---RUNTIME: Execution took 0.02288818359375 ms
2022-09-22 05:44:15 INFO  Done!
2022-09-22 05:44:15 INFO  # Optimization benchmark for data_cleaning with args [['reviews', 'fast_loading', 'featurization_3', 'xgboost']] -- repetition 1 of 7
2022-09-22 05:44:15 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-22 05:44:15 INFO  Running instrumented original pipeline...
2022-09-22 05:44:16 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-22 05:44:16 INFO  ---RUNTIME: Importing and monkey-patching took 5.6476593017578125 ms
2022-09-22 05:45:09 INFO  ---RUNTIME: Original pipeline execution took 53243.21746826172 ms (excluding imports and monkey-patching)
2022-09-22 05:45:09 INFO  Starting execution of 1 what-if analyses...
2022-09-22 05:45:09 INFO  Start plan generation for analysis DataCleaning...
2022-09-22 05:45:09 INFO  ---RUNTIME: Plan generation took 0.8406639099121094 ms
2022-09-22 05:45:09 INFO  Estimated runtime of original DAG is 45775.062561035156ms
2022-09-22 05:45:09 INFO  Performing Multi-Query Optimization
2022-09-22 05:45:09 INFO  Estimated unoptimized what-if runtime is 915501.2512207031ms
2022-09-22 05:45:09 INFO  Estimated optimised what-if runtime is 410514.0814781189ms
2022-09-22 05:45:09 INFO  Estimated optimisation runtime saving is 504987.1697425842ms
2022-09-22 05:45:09 INFO  ---RUNTIME: Multi-Query Optimization took 133.73899459838867 ms
2022-09-22 05:45:09 INFO  Executing generated plans
2022-09-22 05:51:17 INFO  ---RUNTIME: Execution took 368254.06789779663 ms
2022-09-22 05:51:17 INFO  Done!
2022-09-22 05:51:17 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-22 05:51:17 INFO  Running instrumented original pipeline...
2022-09-22 05:51:17 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-22 05:51:17 INFO  ---RUNTIME: Importing and monkey-patching took 6.249904632568359 ms
2022-09-22 05:52:12 INFO  ---RUNTIME: Original pipeline execution took 54781.34107589722 ms (excluding imports and monkey-patching)
2022-09-22 05:52:12 INFO  Starting execution of 1 what-if analyses...
2022-09-22 05:52:12 INFO  Start plan generation for analysis DataCleaning...
2022-09-22 05:52:12 INFO  ---RUNTIME: Plan generation took 0.9329319000244141 ms
2022-09-22 05:52:12 INFO  Estimated runtime of original DAG is 46054.83555793762ms
2022-09-22 05:52:12 WARNING Skipping Multi-Query Optimization (instead, only applying patches)
2022-09-22 05:52:12 WARNING Columns ['review_id'] not present in train DAG after the train test split, only before!
2022-09-22 05:52:12 WARNING This could hint at data leakage!
2022-09-22 05:52:12 INFO  Estimated unoptimised what-if runtime is 921096.7111587524ms
2022-09-22 05:52:12 INFO  ---RUNTIME: Multi-Query Optimization took 29.178619384765625 ms
2022-09-22 05:52:12 INFO  Executing generated plans
2022-09-22 06:06:49 INFO  ---RUNTIME: Execution took 876791.8181419373 ms
2022-09-22 06:06:49 INFO  Done!
2022-09-22 06:06:49 INFO  # Finished -- repetition 1 of 7 
2022-09-22 06:06:49 INFO  # Optimization benchmark for data_cleaning with args [['reviews', 'fast_loading', 'featurization_3', 'xgboost']] -- repetition 2 of 7
2022-09-22 06:06:49 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-22 06:06:49 INFO  Running instrumented original pipeline...
2022-09-22 06:06:49 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-22 06:06:49 INFO  ---RUNTIME: Importing and monkey-patching took 6.134033203125 ms
2022-09-22 06:07:49 INFO  ---RUNTIME: Original pipeline execution took 60539.97254371643 ms (excluding imports and monkey-patching)
2022-09-22 06:07:49 INFO  Starting execution of 1 what-if analyses...
2022-09-22 06:07:49 INFO  Start plan generation for analysis DataCleaning...
2022-09-22 06:07:49 INFO  ---RUNTIME: Plan generation took 0.8521080017089844 ms
2022-09-22 06:07:49 INFO  Estimated runtime of original DAG is 47874.377727508545ms
2022-09-22 06:07:49 INFO  Performing Multi-Query Optimization
2022-09-22 06:07:49 INFO  Estimated unoptimized what-if runtime is 957487.5545501709ms
2022-09-22 06:07:49 INFO  Estimated optimised what-if runtime is 427484.1332435608ms
2022-09-22 06:07:49 INFO  Estimated optimisation runtime saving is 530003.4213066101ms
2022-09-22 06:07:49 INFO  ---RUNTIME: Multi-Query Optimization took 120.19515037536621 ms
2022-09-22 06:07:49 INFO  Executing generated plans
2022-09-22 06:15:46 INFO  ---RUNTIME: Execution took 476457.884311676 ms
2022-09-22 06:15:46 INFO  Done!
2022-09-22 06:15:46 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-22 06:15:46 INFO  Running instrumented original pipeline...
2022-09-22 06:15:46 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-22 06:15:46 INFO  ---RUNTIME: Importing and monkey-patching took 6.328582763671875 ms
2022-09-22 06:16:39 INFO  ---RUNTIME: Original pipeline execution took 53564.06569480896 ms (excluding imports and monkey-patching)
2022-09-22 06:16:39 INFO  Starting execution of 1 what-if analyses...
2022-09-22 06:16:39 INFO  Start plan generation for analysis DataCleaning...
2022-09-22 06:16:39 INFO  ---RUNTIME: Plan generation took 0.8344650268554688 ms
2022-09-22 06:16:39 INFO  Estimated runtime of original DAG is 46048.61235618591ms
2022-09-22 06:16:39 WARNING Skipping Multi-Query Optimization (instead, only applying patches)
2022-09-22 06:16:39 WARNING Columns ['review_id'] not present in train DAG after the train test split, only before!
2022-09-22 06:16:39 WARNING This could hint at data leakage!
2022-09-22 06:16:39 INFO  Estimated unoptimised what-if runtime is 920972.2471237183ms
2022-09-22 06:16:39 INFO  ---RUNTIME: Multi-Query Optimization took 29.706478118896484 ms
2022-09-22 06:16:39 INFO  Executing generated plans
2022-09-22 06:33:01 INFO  ---RUNTIME: Execution took 981470.1833724976 ms
2022-09-22 06:33:01 INFO  Done!
2022-09-22 06:33:01 INFO  # Finished -- repetition 2 of 7 
2022-09-22 06:33:01 INFO  # Optimization benchmark for data_cleaning with args [['reviews', 'fast_loading', 'featurization_3', 'xgboost']] -- repetition 3 of 7
2022-09-22 06:33:01 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-22 06:33:01 INFO  Running instrumented original pipeline...
2022-09-22 06:33:01 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-22 06:33:01 INFO  ---RUNTIME: Importing and monkey-patching took 6.1206817626953125 ms
2022-09-22 06:33:57 INFO  ---RUNTIME: Original pipeline execution took 55731.95004463196 ms (excluding imports and monkey-patching)
2022-09-22 06:33:57 INFO  Starting execution of 1 what-if analyses...
2022-09-22 06:33:57 INFO  Start plan generation for analysis DataCleaning...
2022-09-22 06:33:57 INFO  ---RUNTIME: Plan generation took 0.8182525634765625 ms
2022-09-22 06:33:57 INFO  Estimated runtime of original DAG is 46015.27380943298ms
2022-09-22 06:33:57 INFO  Performing Multi-Query Optimization
2022-09-22 06:33:57 INFO  Estimated unoptimized what-if runtime is 920305.4761886597ms
2022-09-22 06:33:57 INFO  Estimated optimised what-if runtime is 408638.7243270874ms
2022-09-22 06:33:57 INFO  Estimated optimisation runtime saving is 511666.75186157227ms
2022-09-22 06:33:57 INFO  ---RUNTIME: Multi-Query Optimization took 120.9878921508789 ms
2022-09-22 06:33:57 INFO  Executing generated plans
2022-09-22 06:41:25 INFO  ---RUNTIME: Execution took 447362.984418869 ms
2022-09-22 06:41:25 INFO  Done!
2022-09-22 06:41:26 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-22 06:41:26 INFO  Running instrumented original pipeline...
2022-09-22 06:41:26 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-22 06:41:26 INFO  ---RUNTIME: Importing and monkey-patching took 6.192684173583984 ms
2022-09-22 06:42:25 INFO  ---RUNTIME: Original pipeline execution took 59072.983741760254 ms (excluding imports and monkey-patching)
2022-09-22 06:42:25 INFO  Starting execution of 1 what-if analyses...
2022-09-22 06:42:25 INFO  Start plan generation for analysis DataCleaning...
2022-09-22 06:42:25 INFO  ---RUNTIME: Plan generation took 0.8282661437988281 ms
2022-09-22 06:42:25 INFO  Estimated runtime of original DAG is 47087.5985622406ms
2022-09-22 06:42:25 WARNING Skipping Multi-Query Optimization (instead, only applying patches)
2022-09-22 06:42:25 WARNING Columns ['review_id'] not present in train DAG after the train test split, only before!
2022-09-22 06:42:25 WARNING This could hint at data leakage!
2022-09-22 06:42:25 INFO  Estimated unoptimised what-if runtime is 941751.971244812ms
2022-09-22 06:42:25 INFO  ---RUNTIME: Multi-Query Optimization took 29.58965301513672 ms
2022-09-22 06:42:25 INFO  Executing generated plans
2022-09-22 06:57:05 INFO  ---RUNTIME: Execution took 880215.6975269318 ms
2022-09-22 06:57:05 INFO  Done!
2022-09-22 06:57:05 INFO  # Finished -- repetition 3 of 7 
2022-09-22 06:57:05 INFO  # Optimization benchmark for data_cleaning with args [['reviews', 'fast_loading', 'featurization_3', 'xgboost']] -- repetition 4 of 7
2022-09-22 06:57:05 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-22 06:57:05 INFO  Running instrumented original pipeline...
2022-09-22 06:57:05 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-22 06:57:05 INFO  ---RUNTIME: Importing and monkey-patching took 6.323814392089844 ms
2022-09-22 06:57:57 INFO  ---RUNTIME: Original pipeline execution took 51393.77236366272 ms (excluding imports and monkey-patching)
2022-09-22 06:57:57 INFO  Starting execution of 1 what-if analyses...
2022-09-22 06:57:57 INFO  Start plan generation for analysis DataCleaning...
2022-09-22 06:57:57 INFO  ---RUNTIME: Plan generation took 0.8139610290527344 ms
2022-09-22 06:57:57 INFO  Estimated runtime of original DAG is 44177.48928070068ms
2022-09-22 06:57:57 INFO  Performing Multi-Query Optimization
2022-09-22 06:57:57 INFO  Estimated unoptimized what-if runtime is 883549.7856140137ms
2022-09-22 06:57:57 INFO  Estimated optimised what-if runtime is 394054.4798374176ms
2022-09-22 06:57:57 INFO  Estimated optimisation runtime saving is 489495.30577659607ms
2022-09-22 06:57:57 INFO  ---RUNTIME: Multi-Query Optimization took 122.08890914916992 ms
2022-09-22 06:57:57 INFO  Executing generated plans
2022-09-22 07:04:57 INFO  ---RUNTIME: Execution took 420221.19307518005 ms
2022-09-22 07:04:57 INFO  Done!
2022-09-22 07:04:58 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-22 07:04:58 INFO  Running instrumented original pipeline...
2022-09-22 07:04:58 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-22 07:04:58 INFO  ---RUNTIME: Importing and monkey-patching took 6.16908073425293 ms
2022-09-22 07:05:50 INFO  ---RUNTIME: Original pipeline execution took 52109.071016311646 ms (excluding imports and monkey-patching)
2022-09-22 07:05:50 INFO  Starting execution of 1 what-if analyses...
2022-09-22 07:05:50 INFO  Start plan generation for analysis DataCleaning...
2022-09-22 07:05:50 INFO  ---RUNTIME: Plan generation took 0.8385181427001953 ms
2022-09-22 07:05:50 INFO  Estimated runtime of original DAG is 44141.89863204956ms
2022-09-22 07:05:50 WARNING Skipping Multi-Query Optimization (instead, only applying patches)
2022-09-22 07:05:50 WARNING Columns ['review_id'] not present in train DAG after the train test split, only before!
2022-09-22 07:05:50 WARNING This could hint at data leakage!
2022-09-22 07:05:50 INFO  Estimated unoptimised what-if runtime is 882837.9726409912ms
2022-09-22 07:05:50 INFO  ---RUNTIME: Multi-Query Optimization took 29.95014190673828 ms
2022-09-22 07:05:50 INFO  Executing generated plans
2022-09-22 07:21:09 INFO  ---RUNTIME: Execution took 919142.0149803162 ms
2022-09-22 07:21:09 INFO  Done!
2022-09-22 07:21:10 INFO  # Finished -- repetition 4 of 7 
2022-09-22 07:21:10 INFO  # Optimization benchmark for data_cleaning with args [['reviews', 'fast_loading', 'featurization_3', 'xgboost']] -- repetition 5 of 7
2022-09-22 07:21:10 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-22 07:21:10 INFO  Running instrumented original pipeline...
2022-09-22 07:21:10 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-22 07:21:10 INFO  ---RUNTIME: Importing and monkey-patching took 6.335735321044922 ms
2022-09-22 07:22:07 INFO  ---RUNTIME: Original pipeline execution took 57093.393087387085 ms (excluding imports and monkey-patching)
2022-09-22 07:22:07 INFO  Starting execution of 1 what-if analyses...
2022-09-22 07:22:07 INFO  Start plan generation for analysis DataCleaning...
2022-09-22 07:22:07 INFO  ---RUNTIME: Plan generation took 0.8339881896972656 ms
2022-09-22 07:22:07 INFO  Estimated runtime of original DAG is 45224.35688972473ms
2022-09-22 07:22:07 INFO  Performing Multi-Query Optimization
2022-09-22 07:22:07 INFO  Estimated unoptimized what-if runtime is 904487.1377944946ms
2022-09-22 07:22:07 INFO  Estimated optimised what-if runtime is 406078.44042778015ms
2022-09-22 07:22:07 INFO  Estimated optimisation runtime saving is 498408.6973667145ms
2022-09-22 07:22:07 INFO  ---RUNTIME: Multi-Query Optimization took 120.19634246826172 ms
2022-09-22 07:22:07 INFO  Executing generated plans
2022-09-22 07:29:40 INFO  ---RUNTIME: Execution took 452586.02476119995 ms
2022-09-22 07:29:40 INFO  Done!
2022-09-22 07:29:40 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-22 07:29:40 INFO  Running instrumented original pipeline...
2022-09-22 07:29:40 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-22 07:29:40 INFO  ---RUNTIME: Importing and monkey-patching took 6.128549575805664 ms
2022-09-22 07:30:31 INFO  ---RUNTIME: Original pipeline execution took 51504.45914268494 ms (excluding imports and monkey-patching)
2022-09-22 07:30:31 INFO  Starting execution of 1 what-if analyses...
2022-09-22 07:30:31 INFO  Start plan generation for analysis DataCleaning...
2022-09-22 07:30:31 INFO  ---RUNTIME: Plan generation took 0.8115768432617188 ms
2022-09-22 07:30:31 INFO  Estimated runtime of original DAG is 44214.582443237305ms
2022-09-22 07:30:31 WARNING Skipping Multi-Query Optimization (instead, only applying patches)
2022-09-22 07:30:31 WARNING Columns ['review_id'] not present in train DAG after the train test split, only before!
2022-09-22 07:30:31 WARNING This could hint at data leakage!
2022-09-22 07:30:31 INFO  Estimated unoptimised what-if runtime is 884291.6488647461ms
2022-09-22 07:30:31 INFO  ---RUNTIME: Multi-Query Optimization took 29.953956604003906 ms
2022-09-22 07:30:31 INFO  Executing generated plans
2022-09-22 07:45:53 INFO  ---RUNTIME: Execution took 921583.9784145355 ms
2022-09-22 07:45:53 INFO  Done!
2022-09-22 07:45:53 INFO  # Finished -- repetition 5 of 7 
2022-09-22 07:45:53 INFO  # Optimization benchmark for data_cleaning with args [['reviews', 'fast_loading', 'featurization_3', 'xgboost']] -- repetition 6 of 7
2022-09-22 07:45:53 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-22 07:45:53 INFO  Running instrumented original pipeline...
2022-09-22 07:45:53 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-22 07:45:53 INFO  ---RUNTIME: Importing and monkey-patching took 6.548404693603516 ms
2022-09-22 07:46:45 INFO  ---RUNTIME: Original pipeline execution took 52085.94632148743 ms (excluding imports and monkey-patching)
2022-09-22 07:46:45 INFO  Starting execution of 1 what-if analyses...
2022-09-22 07:46:45 INFO  Start plan generation for analysis DataCleaning...
2022-09-22 07:46:45 INFO  ---RUNTIME: Plan generation took 0.8053779602050781 ms
2022-09-22 07:46:45 INFO  Estimated runtime of original DAG is 44174.79348182678ms
2022-09-22 07:46:45 INFO  Performing Multi-Query Optimization
2022-09-22 07:46:45 INFO  Estimated unoptimized what-if runtime is 883495.8696365356ms
2022-09-22 07:46:45 INFO  Estimated optimised what-if runtime is 394054.1570186615ms
2022-09-22 07:46:45 INFO  Estimated optimisation runtime saving is 489441.71261787415ms
2022-09-22 07:46:45 INFO  ---RUNTIME: Multi-Query Optimization took 120.81289291381836 ms
2022-09-22 07:46:45 INFO  Executing generated plans
2022-09-22 07:53:56 INFO  ---RUNTIME: Execution took 430343.1906700134 ms
2022-09-22 07:53:56 INFO  Done!
2022-09-22 07:53:57 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-22 07:53:57 INFO  Running instrumented original pipeline...
2022-09-22 07:53:57 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-22 07:53:57 INFO  ---RUNTIME: Importing and monkey-patching took 6.066799163818359 ms
2022-09-22 07:54:53 INFO  ---RUNTIME: Original pipeline execution took 56511.15298271179 ms (excluding imports and monkey-patching)
2022-09-22 07:54:53 INFO  Starting execution of 1 what-if analyses...
2022-09-22 07:54:53 INFO  Start plan generation for analysis DataCleaning...
2022-09-22 07:54:53 INFO  ---RUNTIME: Plan generation took 0.8478164672851562 ms
2022-09-22 07:54:53 INFO  Estimated runtime of original DAG is 44894.82545852661ms
2022-09-22 07:54:53 WARNING Skipping Multi-Query Optimization (instead, only applying patches)
2022-09-22 07:54:54 WARNING Columns ['review_id'] not present in train DAG after the train test split, only before!
2022-09-22 07:54:54 WARNING This could hint at data leakage!
2022-09-22 07:54:54 INFO  Estimated unoptimised what-if runtime is 897896.5091705322ms
2022-09-22 07:54:54 INFO  ---RUNTIME: Multi-Query Optimization took 29.890775680541992 ms
2022-09-22 07:54:54 INFO  Executing generated plans
2022-09-22 08:10:58 INFO  ---RUNTIME: Execution took 964825.9711265564 ms
2022-09-22 08:10:58 INFO  Done!
2022-09-22 08:10:58 INFO  # Finished -- repetition 6 of 7 
2022-09-22 08:10:58 INFO  # Optimization benchmark for data_cleaning with args [['reviews', 'fast_loading', 'featurization_3', 'xgboost']] -- repetition 7 of 7
2022-09-22 08:10:58 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-22 08:10:58 INFO  Running instrumented original pipeline...
2022-09-22 08:10:58 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-22 08:10:58 INFO  ---RUNTIME: Importing and monkey-patching took 6.127357482910156 ms
2022-09-22 08:11:50 INFO  ---RUNTIME: Original pipeline execution took 51842.97561645508 ms (excluding imports and monkey-patching)
2022-09-22 08:11:50 INFO  Starting execution of 1 what-if analyses...
2022-09-22 08:11:50 INFO  Start plan generation for analysis DataCleaning...
2022-09-22 08:11:50 INFO  ---RUNTIME: Plan generation took 0.9210109710693359 ms
2022-09-22 08:11:50 INFO  Estimated runtime of original DAG is 44211.40146255493ms
2022-09-22 08:11:50 INFO  Performing Multi-Query Optimization
2022-09-22 08:11:50 INFO  Estimated unoptimized what-if runtime is 884228.0292510986ms
2022-09-22 08:11:50 INFO  Estimated optimised what-if runtime is 394258.3374977112ms
2022-09-22 08:11:50 INFO  Estimated optimisation runtime saving is 489969.69175338745ms
2022-09-22 08:11:50 INFO  ---RUNTIME: Multi-Query Optimization took 119.87733840942383 ms
2022-09-22 08:11:50 INFO  Executing generated plans
2022-09-22 08:19:28 INFO  ---RUNTIME: Execution took 457424.498796463 ms
2022-09-22 08:19:28 INFO  Done!
2022-09-22 08:19:28 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-22 08:19:28 INFO  Running instrumented original pipeline...
2022-09-22 08:19:28 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-22 08:19:28 INFO  ---RUNTIME: Importing and monkey-patching took 6.217002868652344 ms
2022-09-22 08:20:20 INFO  ---RUNTIME: Original pipeline execution took 52266.597032547 ms (excluding imports and monkey-patching)
2022-09-22 08:20:20 INFO  Starting execution of 1 what-if analyses...
2022-09-22 08:20:20 INFO  Start plan generation for analysis DataCleaning...
2022-09-22 08:20:20 INFO  ---RUNTIME: Plan generation took 0.8783340454101562 ms
2022-09-22 08:20:20 INFO  Estimated runtime of original DAG is 44313.85827064514ms
2022-09-22 08:20:20 WARNING Skipping Multi-Query Optimization (instead, only applying patches)
2022-09-22 08:20:20 WARNING Columns ['review_id'] not present in train DAG after the train test split, only before!
2022-09-22 08:20:20 WARNING This could hint at data leakage!
2022-09-22 08:20:20 INFO  Estimated unoptimised what-if runtime is 886277.1654129028ms
2022-09-22 08:20:20 INFO  ---RUNTIME: Multi-Query Optimization took 29.398441314697266 ms
2022-09-22 08:20:20 INFO  Executing generated plans
2022-09-22 08:36:25 INFO  ---RUNTIME: Execution took 964316.0555362701 ms
2022-09-22 08:36:25 INFO  Done!
2022-09-22 08:36:26 INFO  # Finished -- repetition 7 of 7 
2022-09-22 08:36:26 INFO  # Final results after all repetitions
2022-09-22 08:36:26 INFO     repetition  ... no_opt_what_if_execution_combined_model_training
0           0  ...                                    274397.828579
1           1  ...                                    315469.784021
2           2  ...                                    259194.426537
3           3  ...                                    266963.817835
4           4  ...                                    271586.440802
5           5  ...                                    302351.673365
6           6  ...                                    302860.511541

[7 rows x 26 columns]
taskset -c 160-167 PROTOCOL_BUFFERS_PYTHON_IMPLEMENTATION=python python3.9 benchmarks_end_to_end.py data_cleaning reviews fast_loading featurization_3 neural_network
2022-09-22 08:36:29.734890: W tensorflow/stream_executor/platform/default/dso_loader.cc:64] Could not load dynamic library 'libcudart.so.11.0'; dlerror: libcudart.so.11.0: cannot open shared object file: No such file or directory; LD_LIBRARY_PATH: /home/sgrafbe/mlwhatif/venv/lib/python3.9/site-packages/cv2/../../lib64:
2022-09-22 08:36:29.734938: I tensorflow/stream_executor/cuda/cudart_stub.cc:29] Ignore above cudart dlerror if you do not have a GPU set up on your machine.
2022-09-22 08:36:31 INFO  Patching sys.argv with ['mlwhatif', 'reviews', 'fast_loading', 'featurization_3', 'neural_network']
2022-09-22 08:36:31 INFO  Running instrumented original pipeline...
2022-09-22 08:36:31 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-22 08:36:31 INFO  ---RUNTIME: Importing and monkey-patching took 122.74527549743652 ms
2022-09-22 08:36:52.435171: W tensorflow/stream_executor/platform/default/dso_loader.cc:64] Could not load dynamic library 'libcuda.so.1'; dlerror: libcuda.so.1: cannot open shared object file: No such file or directory; LD_LIBRARY_PATH: /home/sgrafbe/mlwhatif/venv/lib/python3.9/site-packages/cv2/../../lib64:
2022-09-22 08:36:52.435210: W tensorflow/stream_executor/cuda/cuda_driver.cc:326] failed call to cuInit: UNKNOWN ERROR (303)
2022-09-22 08:36:52.435231: I tensorflow/stream_executor/cuda/cuda_diagnostics.cc:156] kernel driver does not appear to be running on this host (angus): /proc/driver/nvidia/version does not exist
2022-09-22 08:36:52.435705: I tensorflow/core/platform/cpu_feature_guard.cc:142] This TensorFlow binary is optimized with oneAPI Deep Neural Network Library (oneDNN) to use the following CPU instructions in performance-critical operations:  AVX2 FMA
To enable them in other operations, rebuild TensorFlow with the appropriate compiler flags.
2022-09-22 08:36:53.044675: I tensorflow/compiler/mlir/mlir_graph_optimization_pass.cc:176] None of the MLIR Optimization Passes are enabled (registered 2)
2022-09-22 08:36:53.058186: I tensorflow/core/platform/profile_utils/cpu_utils.cc:114] CPU Frequency: 2595130000 Hz
2022-09-22 08:37:17 INFO  ---RUNTIME: Original pipeline execution took 45903.01465988159 ms (excluding imports and monkey-patching)
2022-09-22 08:37:17 INFO  Starting execution of 0 what-if analyses...
2022-09-22 08:37:17 INFO  Estimated runtime of original DAG is 38696.93970680237ms
2022-09-22 08:37:17 INFO  Performing Multi-Query Optimization
2022-09-22 08:37:17 INFO  Estimated unoptimized what-if runtime is 0ms
2022-09-22 08:37:17 INFO  Estimated optimised what-if runtime is 0ms
2022-09-22 08:37:17 INFO  Estimated optimisation runtime saving is 0ms
2022-09-22 08:37:17 INFO  ---RUNTIME: Multi-Query Optimization took 0.5497932434082031 ms
2022-09-22 08:37:17 INFO  Executing generated plans
2022-09-22 08:37:17 INFO  ---RUNTIME: Execution took 0.0152587890625 ms
2022-09-22 08:37:17 INFO  Done!
2022-09-22 08:37:17 INFO  # Optimization benchmark for data_cleaning with args [['reviews', 'fast_loading', 'featurization_3', 'neural_network']] -- repetition 1 of 7
2022-09-22 08:37:17 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-22 08:37:17 INFO  Running instrumented original pipeline...
2022-09-22 08:37:17 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-22 08:37:17 INFO  ---RUNTIME: Importing and monkey-patching took 5.3863525390625 ms
2022-09-22 08:38:02 INFO  ---RUNTIME: Original pipeline execution took 45775.6667137146 ms (excluding imports and monkey-patching)
2022-09-22 08:38:02 INFO  Starting execution of 1 what-if analyses...
2022-09-22 08:38:02 INFO  Start plan generation for analysis DataCleaning...
2022-09-22 08:38:02 INFO  ---RUNTIME: Plan generation took 0.7472038269042969 ms
2022-09-22 08:38:02 INFO  Estimated runtime of original DAG is 38569.70191001892ms
2022-09-22 08:38:02 INFO  Performing Multi-Query Optimization
2022-09-22 08:38:03 INFO  Estimated unoptimized what-if runtime is 771394.0382003784ms
2022-09-22 08:38:03 INFO  Estimated optimised what-if runtime is 283994.167804718ms
2022-09-22 08:38:03 INFO  Estimated optimisation runtime saving is 487399.8703956604ms
2022-09-22 08:38:03 INFO  ---RUNTIME: Multi-Query Optimization took 119.40431594848633 ms
2022-09-22 08:38:03 INFO  Executing generated plans
2022-09-22 08:42:07 INFO  ---RUNTIME: Execution took 244019.6409225464 ms
2022-09-22 08:42:07 INFO  Done!
2022-09-22 08:42:07 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-22 08:42:07 INFO  Running instrumented original pipeline...
2022-09-22 08:42:07 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-22 08:42:07 INFO  ---RUNTIME: Importing and monkey-patching took 6.1359405517578125 ms
2022-09-22 08:42:53 INFO  ---RUNTIME: Original pipeline execution took 46397.504806518555 ms (excluding imports and monkey-patching)
2022-09-22 08:42:53 INFO  Starting execution of 1 what-if analyses...
2022-09-22 08:42:53 INFO  Start plan generation for analysis DataCleaning...
2022-09-22 08:42:53 INFO  ---RUNTIME: Plan generation took 0.7779598236083984 ms
2022-09-22 08:42:53 INFO  Estimated runtime of original DAG is 38625.812292099ms
2022-09-22 08:42:53 WARNING Skipping Multi-Query Optimization (instead, only applying patches)
2022-09-22 08:42:53 WARNING Columns ['review_id'] not present in train DAG after the train test split, only before!
2022-09-22 08:42:53 WARNING This could hint at data leakage!
2022-09-22 08:42:53 INFO  Estimated unoptimised what-if runtime is 772516.24584198ms
2022-09-22 08:42:53 INFO  ---RUNTIME: Multi-Query Optimization took 29.241323471069336 ms
2022-09-22 08:42:53 INFO  Executing generated plans
2022-09-22 08:54:46 INFO  ---RUNTIME: Execution took 713207.1430683136 ms
2022-09-22 08:54:46 INFO  Done!
2022-09-22 08:54:46 INFO  # Finished -- repetition 1 of 7 
2022-09-22 08:54:46 INFO  # Optimization benchmark for data_cleaning with args [['reviews', 'fast_loading', 'featurization_3', 'neural_network']] -- repetition 2 of 7
2022-09-22 08:54:46 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-22 08:54:46 INFO  Running instrumented original pipeline...
2022-09-22 08:54:46 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-22 08:54:46 INFO  ---RUNTIME: Importing and monkey-patching took 6.189823150634766 ms
2022-09-22 08:55:38 INFO  ---RUNTIME: Original pipeline execution took 51889.415979385376 ms (excluding imports and monkey-patching)
2022-09-22 08:55:38 INFO  Starting execution of 1 what-if analyses...
2022-09-22 08:55:38 INFO  Start plan generation for analysis DataCleaning...
2022-09-22 08:55:38 INFO  ---RUNTIME: Plan generation took 0.8218288421630859 ms
2022-09-22 08:55:38 INFO  Estimated runtime of original DAG is 39635.9167098999ms
2022-09-22 08:55:38 INFO  Performing Multi-Query Optimization
2022-09-22 08:55:38 INFO  Estimated unoptimized what-if runtime is 792718.334197998ms
2022-09-22 08:55:38 INFO  Estimated optimised what-if runtime is 287803.2500743866ms
2022-09-22 08:55:38 INFO  Estimated optimisation runtime saving is 504915.08412361145ms
2022-09-22 08:55:38 INFO  ---RUNTIME: Multi-Query Optimization took 120.42784690856934 ms
2022-09-22 08:55:38 INFO  Executing generated plans
2022-09-22 09:00:41 INFO  ---RUNTIME: Execution took 302415.6885147095 ms
2022-09-22 09:00:41 INFO  Done!
2022-09-22 09:00:41 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-22 09:00:41 INFO  Running instrumented original pipeline...
2022-09-22 09:00:41 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-22 09:00:41 INFO  ---RUNTIME: Importing and monkey-patching took 6.860494613647461 ms
2022-09-22 09:01:26 INFO  ---RUNTIME: Original pipeline execution took 45597.203731536865 ms (excluding imports and monkey-patching)
2022-09-22 09:01:26 INFO  Starting execution of 1 what-if analyses...
2022-09-22 09:01:26 INFO  Start plan generation for analysis DataCleaning...
2022-09-22 09:01:26 INFO  ---RUNTIME: Plan generation took 0.7839202880859375 ms
2022-09-22 09:01:26 INFO  Estimated runtime of original DAG is 38366.758823394775ms
2022-09-22 09:01:26 WARNING Skipping Multi-Query Optimization (instead, only applying patches)
2022-09-22 09:01:26 WARNING Columns ['review_id'] not present in train DAG after the train test split, only before!
2022-09-22 09:01:26 WARNING This could hint at data leakage!
2022-09-22 09:01:26 INFO  Estimated unoptimised what-if runtime is 767335.1764678955ms
2022-09-22 09:01:26 INFO  ---RUNTIME: Multi-Query Optimization took 28.9459228515625 ms
2022-09-22 09:01:26 INFO  Executing generated plans
2022-09-22 09:14:16 INFO  ---RUNTIME: Execution took 770085.1664543152 ms
2022-09-22 09:14:16 INFO  Done!
2022-09-22 09:14:17 INFO  # Finished -- repetition 2 of 7 
2022-09-22 09:14:17 INFO  # Optimization benchmark for data_cleaning with args [['reviews', 'fast_loading', 'featurization_3', 'neural_network']] -- repetition 3 of 7
2022-09-22 09:14:17 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-22 09:14:17 INFO  Running instrumented original pipeline...
2022-09-22 09:14:17 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-22 09:14:17 INFO  ---RUNTIME: Importing and monkey-patching took 6.061553955078125 ms
2022-09-22 09:15:04 INFO  ---RUNTIME: Original pipeline execution took 47038.75017166138 ms (excluding imports and monkey-patching)
2022-09-22 09:15:04 INFO  Starting execution of 1 what-if analyses...
2022-09-22 09:15:04 INFO  Start plan generation for analysis DataCleaning...
2022-09-22 09:15:04 INFO  ---RUNTIME: Plan generation took 0.7889270782470703 ms
2022-09-22 09:15:04 INFO  Estimated runtime of original DAG is 39127.63524055481ms
2022-09-22 09:15:04 INFO  Performing Multi-Query Optimization
2022-09-22 09:15:04 INFO  Estimated unoptimized what-if runtime is 782552.7048110962ms
2022-09-22 09:15:04 INFO  Estimated optimised what-if runtime is 290597.9232788086ms
2022-09-22 09:15:04 INFO  Estimated optimisation runtime saving is 491954.7815322876ms
2022-09-22 09:15:04 INFO  ---RUNTIME: Multi-Query Optimization took 122.65419960021973 ms
2022-09-22 09:15:04 INFO  Executing generated plans
2022-09-22 09:20:12 INFO  ---RUNTIME: Execution took 307897.8228569031 ms
2022-09-22 09:20:12 INFO  Done!
2022-09-22 09:20:13 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-22 09:20:13 INFO  Running instrumented original pipeline...
2022-09-22 09:20:13 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-22 09:20:13 INFO  ---RUNTIME: Importing and monkey-patching took 6.200075149536133 ms
2022-09-22 09:21:07 INFO  ---RUNTIME: Original pipeline execution took 53478.54447364807 ms (excluding imports and monkey-patching)
2022-09-22 09:21:07 INFO  Starting execution of 1 what-if analyses...
2022-09-22 09:21:07 INFO  Start plan generation for analysis DataCleaning...
2022-09-22 09:21:07 INFO  ---RUNTIME: Plan generation took 0.7650852203369141 ms
2022-09-22 09:21:07 INFO  Estimated runtime of original DAG is 41145.61986923218ms
2022-09-22 09:21:07 WARNING Skipping Multi-Query Optimization (instead, only applying patches)
2022-09-22 09:21:07 WARNING Columns ['review_id'] not present in train DAG after the train test split, only before!
2022-09-22 09:21:07 WARNING This could hint at data leakage!
2022-09-22 09:21:07 INFO  Estimated unoptimised what-if runtime is 822912.3973846436ms
2022-09-22 09:21:07 INFO  ---RUNTIME: Multi-Query Optimization took 29.495716094970703 ms
2022-09-22 09:21:07 INFO  Executing generated plans
2022-09-22 09:33:52 INFO  ---RUNTIME: Execution took 765917.7207946777 ms
2022-09-22 09:33:52 INFO  Done!
2022-09-22 09:33:53 INFO  # Finished -- repetition 3 of 7 
2022-09-22 09:33:53 INFO  # Optimization benchmark for data_cleaning with args [['reviews', 'fast_loading', 'featurization_3', 'neural_network']] -- repetition 4 of 7
2022-09-22 09:33:53 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-22 09:33:53 INFO  Running instrumented original pipeline...
2022-09-22 09:33:53 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-22 09:33:53 INFO  ---RUNTIME: Importing and monkey-patching took 6.521701812744141 ms
2022-09-22 09:34:39 INFO  ---RUNTIME: Original pipeline execution took 46417.02961921692 ms (excluding imports and monkey-patching)
2022-09-22 09:34:39 INFO  Starting execution of 1 what-if analyses...
2022-09-22 09:34:39 INFO  Start plan generation for analysis DataCleaning...
2022-09-22 09:34:39 INFO  ---RUNTIME: Plan generation took 1.8846988677978516 ms
2022-09-22 09:34:39 INFO  Estimated runtime of original DAG is 39026.596784591675ms
2022-09-22 09:34:39 INFO  Performing Multi-Query Optimization
2022-09-22 09:34:39 INFO  Estimated unoptimized what-if runtime is 780531.9356918335ms
2022-09-22 09:34:39 INFO  Estimated optimised what-if runtime is 288269.6375846863ms
2022-09-22 09:34:39 INFO  Estimated optimisation runtime saving is 492262.2981071472ms
2022-09-22 09:34:39 INFO  ---RUNTIME: Multi-Query Optimization took 120.64909934997559 ms
2022-09-22 09:34:39 INFO  Executing generated plans
2022-09-22 09:39:43 INFO  ---RUNTIME: Execution took 304213.31429481506 ms
2022-09-22 09:39:43 INFO  Done!
2022-09-22 09:39:44 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-22 09:39:44 INFO  Running instrumented original pipeline...
2022-09-22 09:39:44 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-22 09:39:44 INFO  ---RUNTIME: Importing and monkey-patching took 6.403207778930664 ms
2022-09-22 09:40:31 INFO  ---RUNTIME: Original pipeline execution took 47584.815979003906 ms (excluding imports and monkey-patching)
2022-09-22 09:40:31 INFO  Starting execution of 1 what-if analyses...
2022-09-22 09:40:31 INFO  Start plan generation for analysis DataCleaning...
2022-09-22 09:40:31 INFO  ---RUNTIME: Plan generation took 1.6193389892578125 ms
2022-09-22 09:40:31 INFO  Estimated runtime of original DAG is 39720.526456832886ms
2022-09-22 09:40:31 WARNING Skipping Multi-Query Optimization (instead, only applying patches)
2022-09-22 09:40:31 WARNING Columns ['review_id'] not present in train DAG after the train test split, only before!
2022-09-22 09:40:31 WARNING This could hint at data leakage!
2022-09-22 09:40:31 INFO  Estimated unoptimised what-if runtime is 794410.5291366577ms
2022-09-22 09:40:31 INFO  ---RUNTIME: Multi-Query Optimization took 29.337167739868164 ms
2022-09-22 09:40:31 INFO  Executing generated plans
2022-09-22 09:53:17 INFO  ---RUNTIME: Execution took 766060.4703426361 ms
2022-09-22 09:53:17 INFO  Done!
2022-09-22 09:53:18 INFO  # Finished -- repetition 4 of 7 
2022-09-22 09:53:18 INFO  # Optimization benchmark for data_cleaning with args [['reviews', 'fast_loading', 'featurization_3', 'neural_network']] -- repetition 5 of 7
2022-09-22 09:53:18 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-22 09:53:18 INFO  Running instrumented original pipeline...
2022-09-22 09:53:19 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-22 09:53:19 INFO  ---RUNTIME: Importing and monkey-patching took 6.042718887329102 ms
2022-09-22 09:54:11 INFO  ---RUNTIME: Original pipeline execution took 52698.43053817749 ms (excluding imports and monkey-patching)
2022-09-22 09:54:11 INFO  Starting execution of 1 what-if analyses...
2022-09-22 09:54:11 INFO  Start plan generation for analysis DataCleaning...
2022-09-22 09:54:11 INFO  ---RUNTIME: Plan generation took 0.8087158203125 ms
2022-09-22 09:54:11 INFO  Estimated runtime of original DAG is 39848.66404533386ms
2022-09-22 09:54:11 INFO  Performing Multi-Query Optimization
2022-09-22 09:54:11 INFO  Estimated unoptimized what-if runtime is 796973.2809066772ms
2022-09-22 09:54:11 INFO  Estimated optimised what-if runtime is 288781.2159061432ms
2022-09-22 09:54:11 INFO  Estimated optimisation runtime saving is 508192.06500053406ms
2022-09-22 09:54:11 INFO  ---RUNTIME: Multi-Query Optimization took 125.00166893005371 ms
2022-09-22 09:54:11 INFO  Executing generated plans
2022-09-22 09:59:16 INFO  ---RUNTIME: Execution took 304248.1873035431 ms
2022-09-22 09:59:16 INFO  Done!
2022-09-22 09:59:16 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-22 09:59:16 INFO  Running instrumented original pipeline...
2022-09-22 09:59:16 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-22 09:59:16 INFO  ---RUNTIME: Importing and monkey-patching took 6.41322135925293 ms
2022-09-22 10:00:02 INFO  ---RUNTIME: Original pipeline execution took 46047.03211784363 ms (excluding imports and monkey-patching)
2022-09-22 10:00:02 INFO  Starting execution of 1 what-if analyses...
2022-09-22 10:00:02 INFO  Start plan generation for analysis DataCleaning...
2022-09-22 10:00:02 INFO  ---RUNTIME: Plan generation took 0.7717609405517578 ms
2022-09-22 10:00:02 INFO  Estimated runtime of original DAG is 38764.32943344116ms
2022-09-22 10:00:02 WARNING Skipping Multi-Query Optimization (instead, only applying patches)
2022-09-22 10:00:02 WARNING Columns ['review_id'] not present in train DAG after the train test split, only before!
2022-09-22 10:00:02 WARNING This could hint at data leakage!
2022-09-22 10:00:02 INFO  Estimated unoptimised what-if runtime is 775286.5886688232ms
2022-09-22 10:00:02 INFO  ---RUNTIME: Multi-Query Optimization took 29.51836585998535 ms
2022-09-22 10:00:02 INFO  Executing generated plans
2022-09-22 10:12:37 INFO  ---RUNTIME: Execution took 755072.8504657745 ms
2022-09-22 10:12:37 INFO  Done!
2022-09-22 10:12:37 INFO  # Finished -- repetition 5 of 7 
2022-09-22 10:12:37 INFO  # Optimization benchmark for data_cleaning with args [['reviews', 'fast_loading', 'featurization_3', 'neural_network']] -- repetition 6 of 7
2022-09-22 10:12:37 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-22 10:12:37 INFO  Running instrumented original pipeline...
2022-09-22 10:12:37 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-22 10:12:37 INFO  ---RUNTIME: Importing and monkey-patching took 6.189823150634766 ms
2022-09-22 10:13:23 INFO  ---RUNTIME: Original pipeline execution took 46344.02060508728 ms (excluding imports and monkey-patching)
2022-09-22 10:13:23 INFO  Starting execution of 1 what-if analyses...
2022-09-22 10:13:23 INFO  Start plan generation for analysis DataCleaning...
2022-09-22 10:13:23 INFO  ---RUNTIME: Plan generation took 0.7748603820800781 ms
2022-09-22 10:13:23 INFO  Estimated runtime of original DAG is 38801.32985115051ms
2022-09-22 10:13:23 INFO  Performing Multi-Query Optimization
2022-09-22 10:13:23 INFO  Estimated unoptimized what-if runtime is 776026.5970230103ms
2022-09-22 10:13:23 INFO  Estimated optimised what-if runtime is 285101.6266345978ms
2022-09-22 10:13:23 INFO  Estimated optimisation runtime saving is 490924.9703884125ms
2022-09-22 10:13:23 INFO  ---RUNTIME: Multi-Query Optimization took 118.09134483337402 ms
2022-09-22 10:13:23 INFO  Executing generated plans
2022-09-22 10:18:30 INFO  ---RUNTIME: Execution took 306714.6511077881 ms
2022-09-22 10:18:30 INFO  Done!
2022-09-22 10:18:31 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-22 10:18:31 INFO  Running instrumented original pipeline...
2022-09-22 10:18:31 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-22 10:18:31 INFO  ---RUNTIME: Importing and monkey-patching took 6.440639495849609 ms
2022-09-22 10:19:24 INFO  ---RUNTIME: Original pipeline execution took 52298.14076423645 ms (excluding imports and monkey-patching)
2022-09-22 10:19:24 INFO  Starting execution of 1 what-if analyses...
2022-09-22 10:19:24 INFO  Start plan generation for analysis DataCleaning...
2022-09-22 10:19:24 INFO  ---RUNTIME: Plan generation took 0.7650852203369141 ms
2022-09-22 10:19:24 INFO  Estimated runtime of original DAG is 40088.44709396362ms
2022-09-22 10:19:24 WARNING Skipping Multi-Query Optimization (instead, only applying patches)
2022-09-22 10:19:24 WARNING Columns ['review_id'] not present in train DAG after the train test split, only before!
2022-09-22 10:19:24 WARNING This could hint at data leakage!
2022-09-22 10:19:24 INFO  Estimated unoptimised what-if runtime is 801768.9418792725ms
2022-09-22 10:19:24 INFO  ---RUNTIME: Multi-Query Optimization took 29.37459945678711 ms
2022-09-22 10:19:24 INFO  Executing generated plans
2022-09-22 10:32:18 INFO  ---RUNTIME: Execution took 774206.9134712219 ms
2022-09-22 10:32:18 INFO  Done!
2022-09-22 10:32:18 INFO  # Finished -- repetition 6 of 7 
2022-09-22 10:32:18 INFO  # Optimization benchmark for data_cleaning with args [['reviews', 'fast_loading', 'featurization_3', 'neural_network']] -- repetition 7 of 7
2022-09-22 10:32:18 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-22 10:32:18 INFO  Running instrumented original pipeline...
2022-09-22 10:32:18 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-22 10:32:18 INFO  ---RUNTIME: Importing and monkey-patching took 6.270647048950195 ms
2022-09-22 10:33:04 INFO  ---RUNTIME: Original pipeline execution took 46138.34595680237 ms (excluding imports and monkey-patching)
2022-09-22 10:33:04 INFO  Starting execution of 1 what-if analyses...
2022-09-22 10:33:04 INFO  Start plan generation for analysis DataCleaning...
2022-09-22 10:33:04 INFO  ---RUNTIME: Plan generation took 0.8134841918945312 ms
2022-09-22 10:33:04 INFO  Estimated runtime of original DAG is 38735.952854156494ms
2022-09-22 10:33:04 INFO  Performing Multi-Query Optimization
2022-09-22 10:33:04 INFO  Estimated unoptimized what-if runtime is 774719.0570831299ms
2022-09-22 10:33:04 INFO  Estimated optimised what-if runtime is 283037.30607032776ms
2022-09-22 10:33:04 INFO  Estimated optimisation runtime saving is 491681.7510128021ms
2022-09-22 10:33:04 INFO  ---RUNTIME: Multi-Query Optimization took 121.93918228149414 ms
2022-09-22 10:33:04 INFO  Executing generated plans
2022-09-22 10:38:09 INFO  ---RUNTIME: Execution took 304919.4095134735 ms
2022-09-22 10:38:09 INFO  Done!
2022-09-22 10:38:09 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-22 10:38:09 INFO  Running instrumented original pipeline...
2022-09-22 10:38:09 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-22 10:38:09 INFO  ---RUNTIME: Importing and monkey-patching took 6.225109100341797 ms
2022-09-22 10:38:56 INFO  ---RUNTIME: Original pipeline execution took 46150.38585662842 ms (excluding imports and monkey-patching)
2022-09-22 10:38:56 INFO  Starting execution of 1 what-if analyses...
2022-09-22 10:38:56 INFO  Start plan generation for analysis DataCleaning...
2022-09-22 10:38:56 INFO  ---RUNTIME: Plan generation took 0.7638931274414062 ms
2022-09-22 10:38:56 INFO  Estimated runtime of original DAG is 38658.955335617065ms
2022-09-22 10:38:56 WARNING Skipping Multi-Query Optimization (instead, only applying patches)
2022-09-22 10:38:56 WARNING Columns ['review_id'] not present in train DAG after the train test split, only before!
2022-09-22 10:38:56 WARNING This could hint at data leakage!
2022-09-22 10:38:56 INFO  Estimated unoptimised what-if runtime is 773179.1067123413ms
2022-09-22 10:38:56 INFO  ---RUNTIME: Multi-Query Optimization took 29.324054718017578 ms
2022-09-22 10:38:56 INFO  Executing generated plans
2022-09-22 10:51:51 INFO  ---RUNTIME: Execution took 775459.6138000488 ms
2022-09-22 10:51:51 INFO  Done!
2022-09-22 10:51:52 INFO  # Finished -- repetition 7 of 7 
2022-09-22 10:51:52 INFO  # Final results after all repetitions
2022-09-22 10:51:52 INFO     repetition  ... no_opt_what_if_execution_combined_model_training
0           0  ...                                    115203.789711
1           1  ...                                    114955.523252
2           2  ...                                    114699.854612
3           3  ...                                    114126.104355
4           4  ...                                    116031.747341
5           5  ...                                    115493.117332
6           6  ...                                    116294.361353

[7 rows x 26 columns]
taskset -c 160-167 PROTOCOL_BUFFERS_PYTHON_IMPLEMENTATION=python python3.9 benchmarks_end_to_end.py data_cleaning reviews fast_loading featurization_4 logistic_regression
2022-09-22 10:51:56.240729: W tensorflow/stream_executor/platform/default/dso_loader.cc:64] Could not load dynamic library 'libcudart.so.11.0'; dlerror: libcudart.so.11.0: cannot open shared object file: No such file or directory; LD_LIBRARY_PATH: /home/sgrafbe/mlwhatif/venv/lib/python3.9/site-packages/cv2/../../lib64:
2022-09-22 10:51:56.240777: I tensorflow/stream_executor/cuda/cudart_stub.cc:29] Ignore above cudart dlerror if you do not have a GPU set up on your machine.
2022-09-22 10:51:57 INFO  Patching sys.argv with ['mlwhatif', 'reviews', 'fast_loading', 'featurization_4', 'logistic_regression']
2022-09-22 10:51:57 INFO  Running instrumented original pipeline...
2022-09-22 10:51:57 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-22 10:51:57 INFO  ---RUNTIME: Importing and monkey-patching took 135.05101203918457 ms
2022-09-22 10:52:10 INFO  ---RUNTIME: Original pipeline execution took 12541.399478912354 ms (excluding imports and monkey-patching)
2022-09-22 10:52:10 INFO  Starting execution of 0 what-if analyses...
2022-09-22 10:52:10 INFO  Estimated runtime of original DAG is 9278.351068496704ms
2022-09-22 10:52:10 INFO  Performing Multi-Query Optimization
2022-09-22 10:52:10 INFO  Estimated unoptimized what-if runtime is 0ms
2022-09-22 10:52:10 INFO  Estimated optimised what-if runtime is 0ms
2022-09-22 10:52:10 INFO  Estimated optimisation runtime saving is 0ms
2022-09-22 10:52:10 INFO  ---RUNTIME: Multi-Query Optimization took 0.5433559417724609 ms
2022-09-22 10:52:10 INFO  Executing generated plans
2022-09-22 10:52:10 INFO  ---RUNTIME: Execution took 0.026941299438476562 ms
2022-09-22 10:52:10 INFO  Done!
2022-09-22 10:52:10 INFO  # Optimization benchmark for data_cleaning with args [['reviews', 'fast_loading', 'featurization_4', 'logistic_regression']] -- repetition 1 of 7
2022-09-22 10:52:10 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-22 10:52:10 INFO  Running instrumented original pipeline...
2022-09-22 10:52:10 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-22 10:52:10 INFO  ---RUNTIME: Importing and monkey-patching took 5.539655685424805 ms
2022-09-22 10:52:22 INFO  ---RUNTIME: Original pipeline execution took 12615.997314453125 ms (excluding imports and monkey-patching)
2022-09-22 10:52:22 INFO  Starting execution of 1 what-if analyses...
2022-09-22 10:52:22 INFO  Start plan generation for analysis DataCleaning...
2022-09-22 10:52:22 INFO  ---RUNTIME: Plan generation took 0.6639957427978516 ms
2022-09-22 10:52:22 INFO  Estimated runtime of original DAG is 9374.154090881348ms
2022-09-22 10:52:22 INFO  Performing Multi-Query Optimization
2022-09-22 10:52:22 INFO  Estimated unoptimized what-if runtime is 187483.08181762695ms
2022-09-22 10:52:22 INFO  Estimated optimised what-if runtime is 40911.94295883179ms
2022-09-22 10:52:22 INFO  Estimated optimisation runtime saving is 146571.13885879517ms
2022-09-22 10:52:22 INFO  ---RUNTIME: Multi-Query Optimization took 108.32476615905762 ms
2022-09-22 10:52:22 INFO  Executing generated plans
2022-09-22 10:53:11 INFO  ---RUNTIME: Execution took 48526.692390441895 ms
2022-09-22 10:53:11 INFO  Done!
2022-09-22 10:53:11 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-22 10:53:11 INFO  Running instrumented original pipeline...
2022-09-22 10:53:11 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-22 10:53:11 INFO  ---RUNTIME: Importing and monkey-patching took 6.156444549560547 ms
2022-09-22 10:53:23 INFO  ---RUNTIME: Original pipeline execution took 12235.448598861694 ms (excluding imports and monkey-patching)
2022-09-22 10:53:23 INFO  Starting execution of 1 what-if analyses...
2022-09-22 10:53:23 INFO  Start plan generation for analysis DataCleaning...
2022-09-22 10:53:23 INFO  ---RUNTIME: Plan generation took 0.6577968597412109 ms
2022-09-22 10:53:23 INFO  Estimated runtime of original DAG is 9045.607805252075ms
2022-09-22 10:53:23 WARNING Skipping Multi-Query Optimization (instead, only applying patches)
2022-09-22 10:53:23 WARNING Columns ['review_id'] not present in train DAG after the train test split, only before!
2022-09-22 10:53:23 WARNING This could hint at data leakage!
2022-09-22 10:53:23 INFO  Estimated unoptimised what-if runtime is 180912.1561050415ms
2022-09-22 10:53:23 INFO  ---RUNTIME: Multi-Query Optimization took 25.985002517700195 ms
2022-09-22 10:53:23 INFO  Executing generated plans
2022-09-22 10:56:50 INFO  ---RUNTIME: Execution took 207120.9704875946 ms
2022-09-22 10:56:50 INFO  Done!
2022-09-22 10:56:50 INFO  # Finished -- repetition 1 of 7 
2022-09-22 10:56:50 INFO  # Optimization benchmark for data_cleaning with args [['reviews', 'fast_loading', 'featurization_4', 'logistic_regression']] -- repetition 2 of 7
2022-09-22 10:56:50 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-22 10:56:50 INFO  Running instrumented original pipeline...
2022-09-22 10:56:50 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-22 10:56:50 INFO  ---RUNTIME: Importing and monkey-patching took 5.748271942138672 ms
2022-09-22 10:57:03 INFO  ---RUNTIME: Original pipeline execution took 12335.819482803345 ms (excluding imports and monkey-patching)
2022-09-22 10:57:03 INFO  Starting execution of 1 what-if analyses...
2022-09-22 10:57:03 INFO  Start plan generation for analysis DataCleaning...
2022-09-22 10:57:03 INFO  ---RUNTIME: Plan generation took 0.6878376007080078 ms
2022-09-22 10:57:03 INFO  Estimated runtime of original DAG is 9108.8228225708ms
2022-09-22 10:57:03 INFO  Performing Multi-Query Optimization
2022-09-22 10:57:03 INFO  Estimated unoptimized what-if runtime is 182176.45645141602ms
2022-09-22 10:57:03 INFO  Estimated optimised what-if runtime is 40452.14080810547ms
2022-09-22 10:57:03 INFO  Estimated optimisation runtime saving is 141724.31564331055ms
2022-09-22 10:57:03 INFO  ---RUNTIME: Multi-Query Optimization took 106.1563491821289 ms
2022-09-22 10:57:03 INFO  Executing generated plans
2022-09-22 10:57:51 INFO  ---RUNTIME: Execution took 47865.85259437561 ms
2022-09-22 10:57:51 INFO  Done!
2022-09-22 10:57:51 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-22 10:57:51 INFO  Running instrumented original pipeline...
2022-09-22 10:57:51 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-22 10:57:51 INFO  ---RUNTIME: Importing and monkey-patching took 6.168842315673828 ms
2022-09-22 10:58:03 INFO  ---RUNTIME: Original pipeline execution took 12440.906524658203 ms (excluding imports and monkey-patching)
2022-09-22 10:58:03 INFO  Starting execution of 1 what-if analyses...
2022-09-22 10:58:03 INFO  Start plan generation for analysis DataCleaning...
2022-09-22 10:58:03 INFO  ---RUNTIME: Plan generation took 0.6220340728759766 ms
2022-09-22 10:58:03 INFO  Estimated runtime of original DAG is 9040.720701217651ms
2022-09-22 10:58:03 WARNING Skipping Multi-Query Optimization (instead, only applying patches)
2022-09-22 10:58:03 WARNING Columns ['review_id'] not present in train DAG after the train test split, only before!
2022-09-22 10:58:03 WARNING This could hint at data leakage!
2022-09-22 10:58:03 INFO  Estimated unoptimised what-if runtime is 180814.41402435303ms
2022-09-22 10:58:03 INFO  ---RUNTIME: Multi-Query Optimization took 26.027202606201172 ms
2022-09-22 10:58:03 INFO  Executing generated plans
2022-09-22 11:01:30 INFO  ---RUNTIME: Execution took 206512.43042945862 ms
2022-09-22 11:01:30 INFO  Done!
2022-09-22 11:01:30 INFO  # Finished -- repetition 2 of 7 
2022-09-22 11:01:30 INFO  # Optimization benchmark for data_cleaning with args [['reviews', 'fast_loading', 'featurization_4', 'logistic_regression']] -- repetition 3 of 7
2022-09-22 11:01:30 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-22 11:01:30 INFO  Running instrumented original pipeline...
2022-09-22 11:01:30 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-22 11:01:30 INFO  ---RUNTIME: Importing and monkey-patching took 5.784511566162109 ms
2022-09-22 11:01:42 INFO  ---RUNTIME: Original pipeline execution took 12548.259496688843 ms (excluding imports and monkey-patching)
2022-09-22 11:01:42 INFO  Starting execution of 1 what-if analyses...
2022-09-22 11:01:42 INFO  Start plan generation for analysis DataCleaning...
2022-09-22 11:01:42 INFO  ---RUNTIME: Plan generation took 0.6937980651855469 ms
2022-09-22 11:01:42 INFO  Estimated runtime of original DAG is 9133.280515670776ms
2022-09-22 11:01:42 INFO  Performing Multi-Query Optimization
2022-09-22 11:01:42 INFO  Estimated unoptimized what-if runtime is 182665.61031341553ms
2022-09-22 11:01:42 INFO  Estimated optimised what-if runtime is 40518.00894737244ms
2022-09-22 11:01:42 INFO  Estimated optimisation runtime saving is 142147.6013660431ms
2022-09-22 11:01:42 INFO  ---RUNTIME: Multi-Query Optimization took 107.41400718688965 ms
2022-09-22 11:01:42 INFO  Executing generated plans
2022-09-22 11:02:30 INFO  ---RUNTIME: Execution took 47839.157581329346 ms
2022-09-22 11:02:30 INFO  Done!
2022-09-22 11:02:30 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-22 11:02:30 INFO  Running instrumented original pipeline...
2022-09-22 11:02:30 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-22 11:02:30 INFO  ---RUNTIME: Importing and monkey-patching took 5.862712860107422 ms
2022-09-22 11:02:43 INFO  ---RUNTIME: Original pipeline execution took 12398.627042770386 ms (excluding imports and monkey-patching)
2022-09-22 11:02:43 INFO  Starting execution of 1 what-if analyses...
2022-09-22 11:02:43 INFO  Start plan generation for analysis DataCleaning...
2022-09-22 11:02:43 INFO  ---RUNTIME: Plan generation took 0.6456375122070312 ms
2022-09-22 11:02:43 INFO  Estimated runtime of original DAG is 9209.88655090332ms
2022-09-22 11:02:43 WARNING Skipping Multi-Query Optimization (instead, only applying patches)
2022-09-22 11:02:43 WARNING Columns ['review_id'] not present in train DAG after the train test split, only before!
2022-09-22 11:02:43 WARNING This could hint at data leakage!
2022-09-22 11:02:43 INFO  Estimated unoptimised what-if runtime is 184197.7310180664ms
2022-09-22 11:02:43 INFO  ---RUNTIME: Multi-Query Optimization took 25.56133270263672 ms
2022-09-22 11:02:43 INFO  Executing generated plans
2022-09-22 11:06:10 INFO  ---RUNTIME: Execution took 206979.83145713806 ms
2022-09-22 11:06:10 INFO  Done!
2022-09-22 11:06:10 INFO  # Finished -- repetition 3 of 7 
2022-09-22 11:06:10 INFO  # Optimization benchmark for data_cleaning with args [['reviews', 'fast_loading', 'featurization_4', 'logistic_regression']] -- repetition 4 of 7
2022-09-22 11:06:10 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-22 11:06:10 INFO  Running instrumented original pipeline...
2022-09-22 11:06:10 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-22 11:06:10 INFO  ---RUNTIME: Importing and monkey-patching took 6.06226921081543 ms
2022-09-22 11:06:22 INFO  ---RUNTIME: Original pipeline execution took 12671.775817871094 ms (excluding imports and monkey-patching)
2022-09-22 11:06:22 INFO  Starting execution of 1 what-if analyses...
2022-09-22 11:06:22 INFO  Start plan generation for analysis DataCleaning...
2022-09-22 11:06:22 INFO  ---RUNTIME: Plan generation took 0.6458759307861328 ms
2022-09-22 11:06:22 INFO  Estimated runtime of original DAG is 9236.793279647827ms
2022-09-22 11:06:22 INFO  Performing Multi-Query Optimization
2022-09-22 11:06:22 INFO  Estimated unoptimized what-if runtime is 184735.86559295654ms
2022-09-22 11:06:22 INFO  Estimated optimised what-if runtime is 40991.17088317871ms
2022-09-22 11:06:22 INFO  Estimated optimisation runtime saving is 143744.69470977783ms
2022-09-22 11:06:22 INFO  ---RUNTIME: Multi-Query Optimization took 107.92064666748047 ms
2022-09-22 11:06:22 INFO  Executing generated plans
2022-09-22 11:07:10 INFO  ---RUNTIME: Execution took 47520.86138725281 ms
2022-09-22 11:07:10 INFO  Done!
2022-09-22 11:07:10 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-22 11:07:10 INFO  Running instrumented original pipeline...
2022-09-22 11:07:10 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-22 11:07:10 INFO  ---RUNTIME: Importing and monkey-patching took 5.84864616394043 ms
2022-09-22 11:07:23 INFO  ---RUNTIME: Original pipeline execution took 12595.227241516113 ms (excluding imports and monkey-patching)
2022-09-22 11:07:23 INFO  Starting execution of 1 what-if analyses...
2022-09-22 11:07:23 INFO  Start plan generation for analysis DataCleaning...
2022-09-22 11:07:23 INFO  ---RUNTIME: Plan generation took 0.6356239318847656 ms
2022-09-22 11:07:23 INFO  Estimated runtime of original DAG is 9162.57929801941ms
2022-09-22 11:07:23 WARNING Skipping Multi-Query Optimization (instead, only applying patches)
2022-09-22 11:07:23 WARNING Columns ['review_id'] not present in train DAG after the train test split, only before!
2022-09-22 11:07:23 WARNING This could hint at data leakage!
2022-09-22 11:07:23 INFO  Estimated unoptimised what-if runtime is 183251.58596038818ms
2022-09-22 11:07:23 INFO  ---RUNTIME: Multi-Query Optimization took 25.618791580200195 ms
2022-09-22 11:07:23 INFO  Executing generated plans
2022-09-22 11:10:50 INFO  ---RUNTIME: Execution took 207887.56465911865 ms
2022-09-22 11:10:50 INFO  Done!
2022-09-22 11:10:50 INFO  # Finished -- repetition 4 of 7 
2022-09-22 11:10:50 INFO  # Optimization benchmark for data_cleaning with args [['reviews', 'fast_loading', 'featurization_4', 'logistic_regression']] -- repetition 5 of 7
2022-09-22 11:10:50 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-22 11:10:50 INFO  Running instrumented original pipeline...
2022-09-22 11:10:51 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-22 11:10:51 INFO  ---RUNTIME: Importing and monkey-patching took 5.822420120239258 ms
2022-09-22 11:11:03 INFO  ---RUNTIME: Original pipeline execution took 12346.26817703247 ms (excluding imports and monkey-patching)
2022-09-22 11:11:03 INFO  Starting execution of 1 what-if analyses...
2022-09-22 11:11:03 INFO  Start plan generation for analysis DataCleaning...
2022-09-22 11:11:03 INFO  ---RUNTIME: Plan generation took 0.6344318389892578 ms
2022-09-22 11:11:03 INFO  Estimated runtime of original DAG is 9155.712842941284ms
2022-09-22 11:11:03 INFO  Performing Multi-Query Optimization
2022-09-22 11:11:03 INFO  Estimated unoptimized what-if runtime is 183114.25685882568ms
2022-09-22 11:11:03 INFO  Estimated optimised what-if runtime is 40540.14468193054ms
2022-09-22 11:11:03 INFO  Estimated optimisation runtime saving is 142574.11217689514ms
2022-09-22 11:11:03 INFO  ---RUNTIME: Multi-Query Optimization took 107.49053955078125 ms
2022-09-22 11:11:03 INFO  Executing generated plans
2022-09-22 11:11:51 INFO  ---RUNTIME: Execution took 48439.14723396301 ms
2022-09-22 11:11:51 INFO  Done!
2022-09-22 11:11:51 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-22 11:11:51 INFO  Running instrumented original pipeline...
2022-09-22 11:11:51 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-22 11:11:51 INFO  ---RUNTIME: Importing and monkey-patching took 5.862951278686523 ms
2022-09-22 11:12:04 INFO  ---RUNTIME: Original pipeline execution took 12652.125358581543 ms (excluding imports and monkey-patching)
2022-09-22 11:12:04 INFO  Starting execution of 1 what-if analyses...
2022-09-22 11:12:04 INFO  Start plan generation for analysis DataCleaning...
2022-09-22 11:12:04 INFO  ---RUNTIME: Plan generation took 0.6632804870605469 ms
2022-09-22 11:12:04 INFO  Estimated runtime of original DAG is 9425.122261047363ms
2022-09-22 11:12:04 WARNING Skipping Multi-Query Optimization (instead, only applying patches)
2022-09-22 11:12:04 WARNING Columns ['review_id'] not present in train DAG after the train test split, only before!
2022-09-22 11:12:04 WARNING This could hint at data leakage!
2022-09-22 11:12:04 INFO  Estimated unoptimised what-if runtime is 188502.44522094727ms
2022-09-22 11:12:04 INFO  ---RUNTIME: Multi-Query Optimization took 25.9397029876709 ms
2022-09-22 11:12:04 INFO  Executing generated plans
2022-09-22 11:15:32 INFO  ---RUNTIME: Execution took 208053.61795425415 ms
2022-09-22 11:15:32 INFO  Done!
2022-09-22 11:15:32 INFO  # Finished -- repetition 5 of 7 
2022-09-22 11:15:32 INFO  # Optimization benchmark for data_cleaning with args [['reviews', 'fast_loading', 'featurization_4', 'logistic_regression']] -- repetition 6 of 7
2022-09-22 11:15:32 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-22 11:15:32 INFO  Running instrumented original pipeline...
2022-09-22 11:15:32 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-22 11:15:32 INFO  ---RUNTIME: Importing and monkey-patching took 6.036281585693359 ms
2022-09-22 11:15:45 INFO  ---RUNTIME: Original pipeline execution took 12583.36329460144 ms (excluding imports and monkey-patching)
2022-09-22 11:15:45 INFO  Starting execution of 1 what-if analyses...
2022-09-22 11:15:45 INFO  Start plan generation for analysis DataCleaning...
2022-09-22 11:15:45 INFO  ---RUNTIME: Plan generation took 0.7274150848388672 ms
2022-09-22 11:15:45 INFO  Estimated runtime of original DAG is 9363.68179321289ms
2022-09-22 11:15:45 INFO  Performing Multi-Query Optimization
2022-09-22 11:15:45 INFO  Estimated unoptimized what-if runtime is 187273.6358642578ms
2022-09-22 11:15:45 INFO  Estimated optimised what-if runtime is 41815.98734855652ms
2022-09-22 11:15:45 INFO  Estimated optimisation runtime saving is 145457.6485157013ms
2022-09-22 11:15:45 INFO  ---RUNTIME: Multi-Query Optimization took 107.26380348205566 ms
2022-09-22 11:15:45 INFO  Executing generated plans
2022-09-22 11:16:33 INFO  ---RUNTIME: Execution took 48282.846450805664 ms
2022-09-22 11:16:33 INFO  Done!
2022-09-22 11:16:33 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-22 11:16:33 INFO  Running instrumented original pipeline...
2022-09-22 11:16:33 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-22 11:16:33 INFO  ---RUNTIME: Importing and monkey-patching took 6.068944931030273 ms
2022-09-22 11:16:46 INFO  ---RUNTIME: Original pipeline execution took 12396.891593933105 ms (excluding imports and monkey-patching)
2022-09-22 11:16:46 INFO  Starting execution of 1 what-if analyses...
2022-09-22 11:16:46 INFO  Start plan generation for analysis DataCleaning...
2022-09-22 11:16:46 INFO  ---RUNTIME: Plan generation took 0.6518363952636719 ms
2022-09-22 11:16:46 INFO  Estimated runtime of original DAG is 9177.113771438599ms
2022-09-22 11:16:46 WARNING Skipping Multi-Query Optimization (instead, only applying patches)
2022-09-22 11:16:46 WARNING Columns ['review_id'] not present in train DAG after the train test split, only before!
2022-09-22 11:16:46 WARNING This could hint at data leakage!
2022-09-22 11:16:46 INFO  Estimated unoptimised what-if runtime is 183542.27542877197ms
2022-09-22 11:16:46 INFO  ---RUNTIME: Multi-Query Optimization took 25.41041374206543 ms
2022-09-22 11:16:46 INFO  Executing generated plans
2022-09-22 11:20:13 INFO  ---RUNTIME: Execution took 207579.14209365845 ms
2022-09-22 11:20:13 INFO  Done!
2022-09-22 11:20:13 INFO  # Finished -- repetition 6 of 7 
2022-09-22 11:20:13 INFO  # Optimization benchmark for data_cleaning with args [['reviews', 'fast_loading', 'featurization_4', 'logistic_regression']] -- repetition 7 of 7
2022-09-22 11:20:13 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-22 11:20:13 INFO  Running instrumented original pipeline...
2022-09-22 11:20:13 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-22 11:20:13 INFO  ---RUNTIME: Importing and monkey-patching took 5.786418914794922 ms
2022-09-22 11:20:25 INFO  ---RUNTIME: Original pipeline execution took 12342.857837677002 ms (excluding imports and monkey-patching)
2022-09-22 11:20:25 INFO  Starting execution of 1 what-if analyses...
2022-09-22 11:20:25 INFO  Start plan generation for analysis DataCleaning...
2022-09-22 11:20:25 INFO  ---RUNTIME: Plan generation took 0.6697177886962891 ms
2022-09-22 11:20:25 INFO  Estimated runtime of original DAG is 9127.526998519897ms
2022-09-22 11:20:25 INFO  Performing Multi-Query Optimization
2022-09-22 11:20:26 INFO  Estimated unoptimized what-if runtime is 182550.53997039795ms
2022-09-22 11:20:26 INFO  Estimated optimised what-if runtime is 40443.650245666504ms
2022-09-22 11:20:26 INFO  Estimated optimisation runtime saving is 142106.88972473145ms
2022-09-22 11:20:26 INFO  ---RUNTIME: Multi-Query Optimization took 105.60202598571777 ms
2022-09-22 11:20:26 INFO  Executing generated plans
2022-09-22 11:21:14 INFO  ---RUNTIME: Execution took 48545.05681991577 ms
2022-09-22 11:21:14 INFO  Done!
2022-09-22 11:21:14 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-22 11:21:14 INFO  Running instrumented original pipeline...
2022-09-22 11:21:14 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-22 11:21:14 INFO  ---RUNTIME: Importing and monkey-patching took 5.781412124633789 ms
2022-09-22 11:21:27 INFO  ---RUNTIME: Original pipeline execution took 12621.385335922241 ms (excluding imports and monkey-patching)
2022-09-22 11:21:27 INFO  Starting execution of 1 what-if analyses...
2022-09-22 11:21:27 INFO  Start plan generation for analysis DataCleaning...
2022-09-22 11:21:27 INFO  ---RUNTIME: Plan generation took 0.6468296051025391 ms
2022-09-22 11:21:27 INFO  Estimated runtime of original DAG is 9391.229391098022ms
2022-09-22 11:21:27 WARNING Skipping Multi-Query Optimization (instead, only applying patches)
2022-09-22 11:21:27 WARNING Columns ['review_id'] not present in train DAG after the train test split, only before!
2022-09-22 11:21:27 WARNING This could hint at data leakage!
2022-09-22 11:21:27 INFO  Estimated unoptimised what-if runtime is 187824.58782196045ms
2022-09-22 11:21:27 INFO  ---RUNTIME: Multi-Query Optimization took 25.979995727539062 ms
2022-09-22 11:21:27 INFO  Executing generated plans
2022-09-22 11:24:55 INFO  ---RUNTIME: Execution took 208146.48485183716 ms
2022-09-22 11:24:55 INFO  Done!
2022-09-22 11:24:55 INFO  # Finished -- repetition 7 of 7 
2022-09-22 11:24:55 INFO  # Final results after all repetitions
2022-09-22 11:24:55 INFO     repetition  ... no_opt_what_if_execution_combined_model_training
0           0  ...                                      3735.090733
1           1  ...                                      3705.527067
2           2  ...                                      3739.294052
3           3  ...                                      3734.122276
4           4  ...                                      3752.267122
5           5  ...                                      3674.214840
6           6  ...                                      3685.651541

[7 rows x 26 columns]
taskset -c 160-167 PROTOCOL_BUFFERS_PYTHON_IMPLEMENTATION=python python3.9 benchmarks_end_to_end.py data_cleaning reviews fast_loading featurization_4 xgboost
2022-09-22 11:24:57.645500: W tensorflow/stream_executor/platform/default/dso_loader.cc:64] Could not load dynamic library 'libcudart.so.11.0'; dlerror: libcudart.so.11.0: cannot open shared object file: No such file or directory; LD_LIBRARY_PATH: /home/sgrafbe/mlwhatif/venv/lib/python3.9/site-packages/cv2/../../lib64:
2022-09-22 11:24:57.645550: I tensorflow/stream_executor/cuda/cudart_stub.cc:29] Ignore above cudart dlerror if you do not have a GPU set up on your machine.
2022-09-22 11:24:58 INFO  Patching sys.argv with ['mlwhatif', 'reviews', 'fast_loading', 'featurization_4', 'xgboost']
2022-09-22 11:24:58 INFO  Running instrumented original pipeline...
2022-09-22 11:24:58 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-22 11:24:59 INFO  ---RUNTIME: Importing and monkey-patching took 121.60301208496094 ms
2022-09-22 11:25:14 INFO  ---RUNTIME: Original pipeline execution took 15752.507448196411 ms (excluding imports and monkey-patching)
2022-09-22 11:25:14 INFO  Starting execution of 0 what-if analyses...
2022-09-22 11:25:14 INFO  Estimated runtime of original DAG is 12481.781721115112ms
2022-09-22 11:25:14 INFO  Performing Multi-Query Optimization
2022-09-22 11:25:14 INFO  Estimated unoptimized what-if runtime is 0ms
2022-09-22 11:25:14 INFO  Estimated optimised what-if runtime is 0ms
2022-09-22 11:25:14 INFO  Estimated optimisation runtime saving is 0ms
2022-09-22 11:25:14 INFO  ---RUNTIME: Multi-Query Optimization took 0.5905628204345703 ms
2022-09-22 11:25:14 INFO  Executing generated plans
2022-09-22 11:25:14 INFO  ---RUNTIME: Execution took 0.026941299438476562 ms
2022-09-22 11:25:14 INFO  Done!
2022-09-22 11:25:14 INFO  # Optimization benchmark for data_cleaning with args [['reviews', 'fast_loading', 'featurization_4', 'xgboost']] -- repetition 1 of 7
2022-09-22 11:25:14 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-22 11:25:14 INFO  Running instrumented original pipeline...
2022-09-22 11:25:14 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-22 11:25:14 INFO  ---RUNTIME: Importing and monkey-patching took 5.420684814453125 ms
2022-09-22 11:25:30 INFO  ---RUNTIME: Original pipeline execution took 15779.48021888733 ms (excluding imports and monkey-patching)
2022-09-22 11:25:30 INFO  Starting execution of 1 what-if analyses...
2022-09-22 11:25:30 INFO  Start plan generation for analysis DataCleaning...
2022-09-22 11:25:30 INFO  ---RUNTIME: Plan generation took 0.6520748138427734 ms
2022-09-22 11:25:30 INFO  Estimated runtime of original DAG is 12382.467031478882ms
2022-09-22 11:25:30 INFO  Performing Multi-Query Optimization
2022-09-22 11:25:30 INFO  Estimated unoptimized what-if runtime is 247649.34062957764ms
2022-09-22 11:25:30 INFO  Estimated optimised what-if runtime is 104093.81151199341ms
2022-09-22 11:25:30 INFO  Estimated optimisation runtime saving is 143555.52911758423ms
2022-09-22 11:25:30 INFO  ---RUNTIME: Multi-Query Optimization took 107.38778114318848 ms
2022-09-22 11:25:30 INFO  Executing generated plans
2022-09-22 11:27:21 INFO  ---RUNTIME: Execution took 110724.86615180969 ms
2022-09-22 11:27:21 INFO  Done!
2022-09-22 11:27:21 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-22 11:27:21 INFO  Running instrumented original pipeline...
2022-09-22 11:27:21 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-22 11:27:21 INFO  ---RUNTIME: Importing and monkey-patching took 6.292581558227539 ms
2022-09-22 11:27:36 INFO  ---RUNTIME: Original pipeline execution took 15541.598320007324 ms (excluding imports and monkey-patching)
2022-09-22 11:27:36 INFO  Starting execution of 1 what-if analyses...
2022-09-22 11:27:36 INFO  Start plan generation for analysis DataCleaning...
2022-09-22 11:27:36 INFO  ---RUNTIME: Plan generation took 0.6732940673828125 ms
2022-09-22 11:27:36 INFO  Estimated runtime of original DAG is 12345.434427261353ms
2022-09-22 11:27:36 WARNING Skipping Multi-Query Optimization (instead, only applying patches)
2022-09-22 11:27:37 WARNING Columns ['review_id'] not present in train DAG after the train test split, only before!
2022-09-22 11:27:37 WARNING This could hint at data leakage!
2022-09-22 11:27:37 INFO  Estimated unoptimised what-if runtime is 246908.68854522705ms
2022-09-22 11:27:37 INFO  ---RUNTIME: Multi-Query Optimization took 26.14593505859375 ms
2022-09-22 11:27:37 INFO  Executing generated plans
2022-09-22 11:32:12 INFO  ---RUNTIME: Execution took 275503.87239456177 ms
2022-09-22 11:32:12 INFO  Done!
2022-09-22 11:32:12 INFO  # Finished -- repetition 1 of 7 
2022-09-22 11:32:12 INFO  # Optimization benchmark for data_cleaning with args [['reviews', 'fast_loading', 'featurization_4', 'xgboost']] -- repetition 2 of 7
2022-09-22 11:32:12 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-22 11:32:12 INFO  Running instrumented original pipeline...
2022-09-22 11:32:12 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-22 11:32:12 INFO  ---RUNTIME: Importing and monkey-patching took 5.668163299560547 ms
2022-09-22 11:32:28 INFO  ---RUNTIME: Original pipeline execution took 15511.983633041382 ms (excluding imports and monkey-patching)
2022-09-22 11:32:28 INFO  Starting execution of 1 what-if analyses...
2022-09-22 11:32:28 INFO  Start plan generation for analysis DataCleaning...
2022-09-22 11:32:28 INFO  ---RUNTIME: Plan generation took 0.6451606750488281 ms
2022-09-22 11:32:28 INFO  Estimated runtime of original DAG is 12326.743125915527ms
2022-09-22 11:32:28 INFO  Performing Multi-Query Optimization
2022-09-22 11:32:28 INFO  Estimated unoptimized what-if runtime is 246534.86251831055ms
2022-09-22 11:32:28 INFO  Estimated optimised what-if runtime is 103791.57710075378ms
2022-09-22 11:32:28 INFO  Estimated optimisation runtime saving is 142743.28541755676ms
2022-09-22 11:32:28 INFO  ---RUNTIME: Multi-Query Optimization took 107.47337341308594 ms
2022-09-22 11:32:28 INFO  Executing generated plans
2022-09-22 11:34:18 INFO  ---RUNTIME: Execution took 110227.2162437439 ms
2022-09-22 11:34:18 INFO  Done!
2022-09-22 11:34:18 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-22 11:34:18 INFO  Running instrumented original pipeline...
2022-09-22 11:34:18 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-22 11:34:18 INFO  ---RUNTIME: Importing and monkey-patching took 6.122350692749023 ms
2022-09-22 11:34:34 INFO  ---RUNTIME: Original pipeline execution took 15717.445135116577 ms (excluding imports and monkey-patching)
2022-09-22 11:34:34 INFO  Starting execution of 1 what-if analyses...
2022-09-22 11:34:34 INFO  Start plan generation for analysis DataCleaning...
2022-09-22 11:34:34 INFO  ---RUNTIME: Plan generation took 0.675201416015625 ms
2022-09-22 11:34:34 INFO  Estimated runtime of original DAG is 12342.931270599365ms
2022-09-22 11:34:34 WARNING Skipping Multi-Query Optimization (instead, only applying patches)
2022-09-22 11:34:34 WARNING Columns ['review_id'] not present in train DAG after the train test split, only before!
2022-09-22 11:34:34 WARNING This could hint at data leakage!
2022-09-22 11:34:34 INFO  Estimated unoptimised what-if runtime is 246858.6254119873ms
2022-09-22 11:34:34 INFO  ---RUNTIME: Multi-Query Optimization took 25.58422088623047 ms
2022-09-22 11:34:34 INFO  Executing generated plans
2022-09-22 11:39:08 INFO  ---RUNTIME: Execution took 274768.3997154236 ms
2022-09-22 11:39:08 INFO  Done!
2022-09-22 11:39:08 INFO  # Finished -- repetition 2 of 7 
2022-09-22 11:39:08 INFO  # Optimization benchmark for data_cleaning with args [['reviews', 'fast_loading', 'featurization_4', 'xgboost']] -- repetition 3 of 7
2022-09-22 11:39:08 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-22 11:39:08 INFO  Running instrumented original pipeline...
2022-09-22 11:39:08 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-22 11:39:08 INFO  ---RUNTIME: Importing and monkey-patching took 5.795001983642578 ms
2022-09-22 11:39:24 INFO  ---RUNTIME: Original pipeline execution took 15737.01000213623 ms (excluding imports and monkey-patching)
2022-09-22 11:39:24 INFO  Starting execution of 1 what-if analyses...
2022-09-22 11:39:24 INFO  Start plan generation for analysis DataCleaning...
2022-09-22 11:39:24 INFO  ---RUNTIME: Plan generation took 0.7009506225585938 ms
2022-09-22 11:39:24 INFO  Estimated runtime of original DAG is 12280.445575714111ms
2022-09-22 11:39:24 INFO  Performing Multi-Query Optimization
2022-09-22 11:39:24 INFO  Estimated unoptimized what-if runtime is 245608.91151428223ms
2022-09-22 11:39:24 INFO  Estimated optimised what-if runtime is 103459.50698852539ms
2022-09-22 11:39:24 INFO  Estimated optimisation runtime saving is 142149.40452575684ms
2022-09-22 11:39:24 INFO  ---RUNTIME: Multi-Query Optimization took 106.43744468688965 ms
2022-09-22 11:39:24 INFO  Executing generated plans
2022-09-22 11:41:15 INFO  ---RUNTIME: Execution took 110626.00564956665 ms
2022-09-22 11:41:15 INFO  Done!
2022-09-22 11:41:15 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-22 11:41:15 INFO  Running instrumented original pipeline...
2022-09-22 11:41:15 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-22 11:41:15 INFO  ---RUNTIME: Importing and monkey-patching took 6.102323532104492 ms
2022-09-22 11:41:30 INFO  ---RUNTIME: Original pipeline execution took 15587.419271469116 ms (excluding imports and monkey-patching)
2022-09-22 11:41:30 INFO  Starting execution of 1 what-if analyses...
2022-09-22 11:41:30 INFO  Start plan generation for analysis DataCleaning...
2022-09-22 11:41:30 INFO  ---RUNTIME: Plan generation took 0.6535053253173828 ms
2022-09-22 11:41:30 INFO  Estimated runtime of original DAG is 12367.74468421936ms
2022-09-22 11:41:30 WARNING Skipping Multi-Query Optimization (instead, only applying patches)
2022-09-22 11:41:31 WARNING Columns ['review_id'] not present in train DAG after the train test split, only before!
2022-09-22 11:41:31 WARNING This could hint at data leakage!
2022-09-22 11:41:31 INFO  Estimated unoptimised what-if runtime is 247354.8936843872ms
2022-09-22 11:41:31 INFO  ---RUNTIME: Multi-Query Optimization took 25.43163299560547 ms
2022-09-22 11:41:31 INFO  Executing generated plans
2022-09-22 11:46:07 INFO  ---RUNTIME: Execution took 276850.8458137512 ms
2022-09-22 11:46:07 INFO  Done!
2022-09-22 11:46:07 INFO  # Finished -- repetition 3 of 7 
2022-09-22 11:46:07 INFO  # Optimization benchmark for data_cleaning with args [['reviews', 'fast_loading', 'featurization_4', 'xgboost']] -- repetition 4 of 7
2022-09-22 11:46:07 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-22 11:46:07 INFO  Running instrumented original pipeline...
2022-09-22 11:46:07 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-22 11:46:07 INFO  ---RUNTIME: Importing and monkey-patching took 5.710363388061523 ms
2022-09-22 11:46:23 INFO  ---RUNTIME: Original pipeline execution took 15960.565567016602 ms (excluding imports and monkey-patching)
2022-09-22 11:46:23 INFO  Starting execution of 1 what-if analyses...
2022-09-22 11:46:23 INFO  Start plan generation for analysis DataCleaning...
2022-09-22 11:46:23 INFO  ---RUNTIME: Plan generation took 0.6153583526611328 ms
2022-09-22 11:46:23 INFO  Estimated runtime of original DAG is 12470.940589904785ms
2022-09-22 11:46:23 INFO  Performing Multi-Query Optimization
2022-09-22 11:46:23 INFO  Estimated unoptimized what-if runtime is 249418.8117980957ms
2022-09-22 11:46:23 INFO  Estimated optimised what-if runtime is 104425.4207611084ms
2022-09-22 11:46:23 INFO  Estimated optimisation runtime saving is 144993.3910369873ms
2022-09-22 11:46:23 INFO  ---RUNTIME: Multi-Query Optimization took 105.56149482727051 ms
2022-09-22 11:46:23 INFO  Executing generated plans
2022-09-22 11:48:14 INFO  ---RUNTIME: Execution took 110255.20277023315 ms
2022-09-22 11:48:14 INFO  Done!
2022-09-22 11:48:14 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-22 11:48:14 INFO  Running instrumented original pipeline...
2022-09-22 11:48:14 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-22 11:48:14 INFO  ---RUNTIME: Importing and monkey-patching took 5.883455276489258 ms
2022-09-22 11:48:29 INFO  ---RUNTIME: Original pipeline execution took 15763.47017288208 ms (excluding imports and monkey-patching)
2022-09-22 11:48:29 INFO  Starting execution of 1 what-if analyses...
2022-09-22 11:48:29 INFO  Start plan generation for analysis DataCleaning...
2022-09-22 11:48:29 INFO  ---RUNTIME: Plan generation took 0.6859302520751953 ms
2022-09-22 11:48:29 INFO  Estimated runtime of original DAG is 12308.28595161438ms
2022-09-22 11:48:29 WARNING Skipping Multi-Query Optimization (instead, only applying patches)
2022-09-22 11:48:29 WARNING Columns ['review_id'] not present in train DAG after the train test split, only before!
2022-09-22 11:48:29 WARNING This could hint at data leakage!
2022-09-22 11:48:29 INFO  Estimated unoptimised what-if runtime is 246165.7190322876ms
2022-09-22 11:48:29 INFO  ---RUNTIME: Multi-Query Optimization took 25.64263343811035 ms
2022-09-22 11:48:29 INFO  Executing generated plans
2022-09-22 11:53:06 INFO  ---RUNTIME: Execution took 276683.57825279236 ms
2022-09-22 11:53:06 INFO  Done!
2022-09-22 11:53:06 INFO  # Finished -- repetition 4 of 7 
2022-09-22 11:53:06 INFO  # Optimization benchmark for data_cleaning with args [['reviews', 'fast_loading', 'featurization_4', 'xgboost']] -- repetition 5 of 7
2022-09-22 11:53:06 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-22 11:53:06 INFO  Running instrumented original pipeline...
2022-09-22 11:53:06 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-22 11:53:06 INFO  ---RUNTIME: Importing and monkey-patching took 5.711555480957031 ms
2022-09-22 11:53:22 INFO  ---RUNTIME: Original pipeline execution took 15639.672994613647 ms (excluding imports and monkey-patching)
2022-09-22 11:53:22 INFO  Starting execution of 1 what-if analyses...
2022-09-22 11:53:22 INFO  Start plan generation for analysis DataCleaning...
2022-09-22 11:53:22 INFO  ---RUNTIME: Plan generation took 0.6685256958007812 ms
2022-09-22 11:53:22 INFO  Estimated runtime of original DAG is 12388.787746429443ms
2022-09-22 11:53:22 INFO  Performing Multi-Query Optimization
2022-09-22 11:53:22 INFO  Estimated unoptimized what-if runtime is 247775.75492858887ms
2022-09-22 11:53:22 INFO  Estimated optimised what-if runtime is 104023.6656665802ms
2022-09-22 11:53:22 INFO  Estimated optimisation runtime saving is 143752.08926200867ms
2022-09-22 11:53:22 INFO  ---RUNTIME: Multi-Query Optimization took 107.05208778381348 ms
2022-09-22 11:53:22 INFO  Executing generated plans
2022-09-22 11:55:13 INFO  ---RUNTIME: Execution took 110738.16895484924 ms
2022-09-22 11:55:13 INFO  Done!
2022-09-22 11:55:13 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-22 11:55:13 INFO  Running instrumented original pipeline...
2022-09-22 11:55:13 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-22 11:55:13 INFO  ---RUNTIME: Importing and monkey-patching took 6.155490875244141 ms
2022-09-22 11:55:29 INFO  ---RUNTIME: Original pipeline execution took 15954.360723495483 ms (excluding imports and monkey-patching)
2022-09-22 11:55:29 INFO  Starting execution of 1 what-if analyses...
2022-09-22 11:55:29 INFO  Start plan generation for analysis DataCleaning...
2022-09-22 11:55:29 INFO  ---RUNTIME: Plan generation took 0.6768703460693359 ms
2022-09-22 11:55:29 INFO  Estimated runtime of original DAG is 12724.860906600952ms
2022-09-22 11:55:29 WARNING Skipping Multi-Query Optimization (instead, only applying patches)
2022-09-22 11:55:29 WARNING Columns ['review_id'] not present in train DAG after the train test split, only before!
2022-09-22 11:55:29 WARNING This could hint at data leakage!
2022-09-22 11:55:29 INFO  Estimated unoptimised what-if runtime is 254497.21813201904ms
2022-09-22 11:55:29 INFO  ---RUNTIME: Multi-Query Optimization took 25.832653045654297 ms
2022-09-22 11:55:29 INFO  Executing generated plans
2022-09-22 12:00:04 INFO  ---RUNTIME: Execution took 275617.5355911255 ms
2022-09-22 12:00:04 INFO  Done!
2022-09-22 12:00:04 INFO  # Finished -- repetition 5 of 7 
2022-09-22 12:00:04 INFO  # Optimization benchmark for data_cleaning with args [['reviews', 'fast_loading', 'featurization_4', 'xgboost']] -- repetition 6 of 7
2022-09-22 12:00:04 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-22 12:00:04 INFO  Running instrumented original pipeline...
2022-09-22 12:00:04 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-22 12:00:04 INFO  ---RUNTIME: Importing and monkey-patching took 6.001710891723633 ms
2022-09-22 12:00:20 INFO  ---RUNTIME: Original pipeline execution took 15845.678329467773 ms (excluding imports and monkey-patching)
2022-09-22 12:00:20 INFO  Starting execution of 1 what-if analyses...
2022-09-22 12:00:20 INFO  Start plan generation for analysis DataCleaning...
2022-09-22 12:00:20 INFO  ---RUNTIME: Plan generation took 0.6973743438720703 ms
2022-09-22 12:00:20 INFO  Estimated runtime of original DAG is 12611.221551895142ms
2022-09-22 12:00:20 INFO  Performing Multi-Query Optimization
2022-09-22 12:00:20 INFO  Estimated unoptimized what-if runtime is 252224.43103790283ms
2022-09-22 12:00:20 INFO  Estimated optimised what-if runtime is 105360.1586818695ms
2022-09-22 12:00:20 INFO  Estimated optimisation runtime saving is 146864.27235603333ms
2022-09-22 12:00:20 INFO  ---RUNTIME: Multi-Query Optimization took 105.63373565673828 ms
2022-09-22 12:00:20 INFO  Executing generated plans
2022-09-22 12:02:11 INFO  ---RUNTIME: Execution took 110866.59240722656 ms
2022-09-22 12:02:11 INFO  Done!
2022-09-22 12:02:11 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-22 12:02:11 INFO  Running instrumented original pipeline...
2022-09-22 12:02:11 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-22 12:02:11 INFO  ---RUNTIME: Importing and monkey-patching took 5.709648132324219 ms
2022-09-22 12:02:27 INFO  ---RUNTIME: Original pipeline execution took 15490.278244018555 ms (excluding imports and monkey-patching)
2022-09-22 12:02:27 INFO  Starting execution of 1 what-if analyses...
2022-09-22 12:02:27 INFO  Start plan generation for analysis DataCleaning...
2022-09-22 12:02:27 INFO  ---RUNTIME: Plan generation took 0.6303787231445312 ms
2022-09-22 12:02:27 INFO  Estimated runtime of original DAG is 12296.6947555542ms
2022-09-22 12:02:27 WARNING Skipping Multi-Query Optimization (instead, only applying patches)
2022-09-22 12:02:27 WARNING Columns ['review_id'] not present in train DAG after the train test split, only before!
2022-09-22 12:02:27 WARNING This could hint at data leakage!
2022-09-22 12:02:27 INFO  Estimated unoptimised what-if runtime is 245933.89511108398ms
2022-09-22 12:02:27 INFO  ---RUNTIME: Multi-Query Optimization took 25.83622932434082 ms
2022-09-22 12:02:27 INFO  Executing generated plans
2022-09-22 12:07:02 INFO  ---RUNTIME: Execution took 275777.49013900757 ms
2022-09-22 12:07:02 INFO  Done!
2022-09-22 12:07:02 INFO  # Finished -- repetition 6 of 7 
2022-09-22 12:07:02 INFO  # Optimization benchmark for data_cleaning with args [['reviews', 'fast_loading', 'featurization_4', 'xgboost']] -- repetition 7 of 7
2022-09-22 12:07:02 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-22 12:07:02 INFO  Running instrumented original pipeline...
2022-09-22 12:07:02 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-22 12:07:02 INFO  ---RUNTIME: Importing and monkey-patching took 6.103515625 ms
2022-09-22 12:07:18 INFO  ---RUNTIME: Original pipeline execution took 15546.106338500977 ms (excluding imports and monkey-patching)
2022-09-22 12:07:18 INFO  Starting execution of 1 what-if analyses...
2022-09-22 12:07:18 INFO  Start plan generation for analysis DataCleaning...
2022-09-22 12:07:18 INFO  ---RUNTIME: Plan generation took 0.6582736968994141 ms
2022-09-22 12:07:18 INFO  Estimated runtime of original DAG is 12322.65591621399ms
2022-09-22 12:07:18 INFO  Performing Multi-Query Optimization
2022-09-22 12:07:18 INFO  Estimated unoptimized what-if runtime is 246453.11832427979ms
2022-09-22 12:07:18 INFO  Estimated optimised what-if runtime is 103632.19356536865ms
2022-09-22 12:07:18 INFO  Estimated optimisation runtime saving is 142820.92475891113ms
2022-09-22 12:07:18 INFO  ---RUNTIME: Multi-Query Optimization took 105.7283878326416 ms
2022-09-22 12:07:18 INFO  Executing generated plans
2022-09-22 12:09:09 INFO  ---RUNTIME: Execution took 111033.7700843811 ms
2022-09-22 12:09:09 INFO  Done!
2022-09-22 12:09:09 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-22 12:09:09 INFO  Running instrumented original pipeline...
2022-09-22 12:09:09 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-22 12:09:09 INFO  ---RUNTIME: Importing and monkey-patching took 6.248712539672852 ms
2022-09-22 12:09:25 INFO  ---RUNTIME: Original pipeline execution took 15911.122798919678 ms (excluding imports and monkey-patching)
2022-09-22 12:09:25 INFO  Starting execution of 1 what-if analyses...
2022-09-22 12:09:25 INFO  Start plan generation for analysis DataCleaning...
2022-09-22 12:09:25 INFO  ---RUNTIME: Plan generation took 0.6024837493896484 ms
2022-09-22 12:09:25 INFO  Estimated runtime of original DAG is 12686.720609664917ms
2022-09-22 12:09:25 WARNING Skipping Multi-Query Optimization (instead, only applying patches)
2022-09-22 12:09:25 WARNING Columns ['review_id'] not present in train DAG after the train test split, only before!
2022-09-22 12:09:25 WARNING This could hint at data leakage!
2022-09-22 12:09:25 INFO  Estimated unoptimised what-if runtime is 253734.41219329834ms
2022-09-22 12:09:25 INFO  ---RUNTIME: Multi-Query Optimization took 25.696277618408203 ms
2022-09-22 12:09:25 INFO  Executing generated plans
2022-09-22 12:14:02 INFO  ---RUNTIME: Execution took 276487.82658576965 ms
2022-09-22 12:14:02 INFO  Done!
2022-09-22 12:14:02 INFO  # Finished -- repetition 7 of 7 
2022-09-22 12:14:02 INFO  # Final results after all repetitions
2022-09-22 12:14:02 INFO     repetition  ... no_opt_what_if_execution_combined_model_training
0           0  ...                                     69716.184616
1           1  ...                                     69539.046764
2           2  ...                                     69768.716574
3           3  ...                                     69789.586067
4           4  ...                                     69634.002209
5           5  ...                                     69589.578867
6           6  ...                                     69814.624071

[7 rows x 26 columns]
taskset -c 160-167 PROTOCOL_BUFFERS_PYTHON_IMPLEMENTATION=python python3.9 benchmarks_end_to_end.py data_cleaning reviews fast_loading featurization_4 neural_network
2022-09-22 12:14:04.291480: W tensorflow/stream_executor/platform/default/dso_loader.cc:64] Could not load dynamic library 'libcudart.so.11.0'; dlerror: libcudart.so.11.0: cannot open shared object file: No such file or directory; LD_LIBRARY_PATH: /home/sgrafbe/mlwhatif/venv/lib/python3.9/site-packages/cv2/../../lib64:
2022-09-22 12:14:04.291529: I tensorflow/stream_executor/cuda/cudart_stub.cc:29] Ignore above cudart dlerror if you do not have a GPU set up on your machine.
2022-09-22 12:14:05 INFO  Patching sys.argv with ['mlwhatif', 'reviews', 'fast_loading', 'featurization_4', 'neural_network']
2022-09-22 12:14:05 INFO  Running instrumented original pipeline...
2022-09-22 12:14:05 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-22 12:14:05 INFO  ---RUNTIME: Importing and monkey-patching took 121.5364933013916 ms
2022-09-22 12:14:17.886133: W tensorflow/stream_executor/platform/default/dso_loader.cc:64] Could not load dynamic library 'libcuda.so.1'; dlerror: libcuda.so.1: cannot open shared object file: No such file or directory; LD_LIBRARY_PATH: /home/sgrafbe/mlwhatif/venv/lib/python3.9/site-packages/cv2/../../lib64:
2022-09-22 12:14:17.886171: W tensorflow/stream_executor/cuda/cuda_driver.cc:326] failed call to cuInit: UNKNOWN ERROR (303)
2022-09-22 12:14:17.886194: I tensorflow/stream_executor/cuda/cuda_diagnostics.cc:156] kernel driver does not appear to be running on this host (angus): /proc/driver/nvidia/version does not exist
2022-09-22 12:14:17.886797: I tensorflow/core/platform/cpu_feature_guard.cc:142] This TensorFlow binary is optimized with oneAPI Deep Neural Network Library (oneDNN) to use the following CPU instructions in performance-critical operations:  AVX2 FMA
To enable them in other operations, rebuild TensorFlow with the appropriate compiler flags.
2022-09-22 12:14:18.145745: I tensorflow/compiler/mlir/mlir_graph_optimization_pass.cc:176] None of the MLIR Optimization Passes are enabled (registered 2)
2022-09-22 12:14:18.158188: I tensorflow/core/platform/profile_utils/cpu_utils.cc:114] CPU Frequency: 2595130000 Hz
2022-09-22 12:14:22 INFO  ---RUNTIME: Original pipeline execution took 16340.750217437744 ms (excluding imports and monkey-patching)
2022-09-22 12:14:22 INFO  Starting execution of 0 what-if analyses...
2022-09-22 12:14:22 INFO  Estimated runtime of original DAG is 13084.163665771484ms
2022-09-22 12:14:22 INFO  Performing Multi-Query Optimization
2022-09-22 12:14:22 INFO  Estimated unoptimized what-if runtime is 0ms
2022-09-22 12:14:22 INFO  Estimated optimised what-if runtime is 0ms
2022-09-22 12:14:22 INFO  Estimated optimisation runtime saving is 0ms
2022-09-22 12:14:22 INFO  ---RUNTIME: Multi-Query Optimization took 0.5209445953369141 ms
2022-09-22 12:14:22 INFO  Executing generated plans
2022-09-22 12:14:22 INFO  ---RUNTIME: Execution took 0.018835067749023438 ms
2022-09-22 12:14:22 INFO  Done!
2022-09-22 12:14:22 INFO  # Optimization benchmark for data_cleaning with args [['reviews', 'fast_loading', 'featurization_4', 'neural_network']] -- repetition 1 of 7
2022-09-22 12:14:22 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-22 12:14:22 INFO  Running instrumented original pipeline...
2022-09-22 12:14:22 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-22 12:14:22 INFO  ---RUNTIME: Importing and monkey-patching took 5.318164825439453 ms
2022-09-22 12:14:38 INFO  ---RUNTIME: Original pipeline execution took 16082.24868774414 ms (excluding imports and monkey-patching)
2022-09-22 12:14:38 INFO  Starting execution of 1 what-if analyses...
2022-09-22 12:14:38 INFO  Start plan generation for analysis DataCleaning...
2022-09-22 12:14:38 INFO  ---RUNTIME: Plan generation took 0.6933212280273438 ms
2022-09-22 12:14:38 INFO  Estimated runtime of original DAG is 12656.970739364624ms
2022-09-22 12:14:38 INFO  Performing Multi-Query Optimization
2022-09-22 12:14:38 INFO  Estimated unoptimized what-if runtime is 253139.41478729248ms
2022-09-22 12:14:38 INFO  Estimated optimised what-if runtime is 110798.78807067871ms
2022-09-22 12:14:38 INFO  Estimated optimisation runtime saving is 142340.62671661377ms
2022-09-22 12:14:38 INFO  ---RUNTIME: Multi-Query Optimization took 106.29963874816895 ms
2022-09-22 12:14:38 INFO  Executing generated plans
2022-09-22 12:16:35 INFO  ---RUNTIME: Execution took 117415.59410095215 ms
2022-09-22 12:16:35 INFO  Done!
2022-09-22 12:16:35 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-22 12:16:35 INFO  Running instrumented original pipeline...
2022-09-22 12:16:35 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-22 12:16:35 INFO  ---RUNTIME: Importing and monkey-patching took 6.313800811767578 ms
2022-09-22 12:16:52 INFO  ---RUNTIME: Original pipeline execution took 16358.632326126099 ms (excluding imports and monkey-patching)
2022-09-22 12:16:52 INFO  Starting execution of 1 what-if analyses...
2022-09-22 12:16:52 INFO  Start plan generation for analysis DataCleaning...
2022-09-22 12:16:52 INFO  ---RUNTIME: Plan generation took 0.6561279296875 ms
2022-09-22 12:16:52 INFO  Estimated runtime of original DAG is 12631.398916244507ms
2022-09-22 12:16:52 WARNING Skipping Multi-Query Optimization (instead, only applying patches)
2022-09-22 12:16:52 WARNING Columns ['review_id'] not present in train DAG after the train test split, only before!
2022-09-22 12:16:52 WARNING This could hint at data leakage!
2022-09-22 12:16:52 INFO  Estimated unoptimised what-if runtime is 252627.97832489014ms
2022-09-22 12:16:52 INFO  ---RUNTIME: Multi-Query Optimization took 26.07560157775879 ms
2022-09-22 12:16:52 INFO  Executing generated plans
2022-09-22 12:21:29 INFO  ---RUNTIME: Execution took 277489.67027664185 ms
2022-09-22 12:21:29 INFO  Done!
2022-09-22 12:21:29 INFO  # Finished -- repetition 1 of 7 
2022-09-22 12:21:29 INFO  # Optimization benchmark for data_cleaning with args [['reviews', 'fast_loading', 'featurization_4', 'neural_network']] -- repetition 2 of 7
2022-09-22 12:21:29 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-22 12:21:29 INFO  Running instrumented original pipeline...
2022-09-22 12:21:29 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-22 12:21:29 INFO  ---RUNTIME: Importing and monkey-patching took 6.2103271484375 ms
2022-09-22 12:21:45 INFO  ---RUNTIME: Original pipeline execution took 15953.55486869812 ms (excluding imports and monkey-patching)
2022-09-22 12:21:45 INFO  Starting execution of 1 what-if analyses...
2022-09-22 12:21:45 INFO  Start plan generation for analysis DataCleaning...
2022-09-22 12:21:45 INFO  ---RUNTIME: Plan generation took 0.5924701690673828 ms
2022-09-22 12:21:45 INFO  Estimated runtime of original DAG is 12749.01008605957ms
2022-09-22 12:21:45 INFO  Performing Multi-Query Optimization
2022-09-22 12:21:45 INFO  Estimated unoptimized what-if runtime is 254980.2017211914ms
2022-09-22 12:21:45 INFO  Estimated optimised what-if runtime is 109570.80864906311ms
2022-09-22 12:21:45 INFO  Estimated optimisation runtime saving is 145409.3930721283ms
2022-09-22 12:21:45 INFO  ---RUNTIME: Multi-Query Optimization took 107.3000431060791 ms
2022-09-22 12:21:45 INFO  Executing generated plans
2022-09-22 12:23:42 INFO  ---RUNTIME: Execution took 117359.29894447327 ms
2022-09-22 12:23:42 INFO  Done!
2022-09-22 12:23:42 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-22 12:23:42 INFO  Running instrumented original pipeline...
2022-09-22 12:23:43 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-22 12:23:43 INFO  ---RUNTIME: Importing and monkey-patching took 5.771398544311523 ms
2022-09-22 12:23:59 INFO  ---RUNTIME: Original pipeline execution took 16316.365242004395 ms (excluding imports and monkey-patching)
2022-09-22 12:23:59 INFO  Starting execution of 1 what-if analyses...
2022-09-22 12:23:59 INFO  Start plan generation for analysis DataCleaning...
2022-09-22 12:23:59 INFO  ---RUNTIME: Plan generation took 0.6053447723388672 ms
2022-09-22 12:23:59 INFO  Estimated runtime of original DAG is 12480.255126953125ms
2022-09-22 12:23:59 WARNING Skipping Multi-Query Optimization (instead, only applying patches)
2022-09-22 12:23:59 WARNING Columns ['review_id'] not present in train DAG after the train test split, only before!
2022-09-22 12:23:59 WARNING This could hint at data leakage!
2022-09-22 12:23:59 INFO  Estimated unoptimised what-if runtime is 249605.1025390625ms
2022-09-22 12:23:59 INFO  ---RUNTIME: Multi-Query Optimization took 25.763750076293945 ms
2022-09-22 12:23:59 INFO  Executing generated plans
2022-09-22 12:28:36 INFO  ---RUNTIME: Execution took 277499.0963935852 ms
2022-09-22 12:28:36 INFO  Done!
2022-09-22 12:28:36 INFO  # Finished -- repetition 2 of 7 
2022-09-22 12:28:36 INFO  # Optimization benchmark for data_cleaning with args [['reviews', 'fast_loading', 'featurization_4', 'neural_network']] -- repetition 3 of 7
2022-09-22 12:28:36 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-22 12:28:36 INFO  Running instrumented original pipeline...
2022-09-22 12:28:36 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-22 12:28:36 INFO  ---RUNTIME: Importing and monkey-patching took 6.0291290283203125 ms
2022-09-22 12:28:53 INFO  ---RUNTIME: Original pipeline execution took 16395.68567276001 ms (excluding imports and monkey-patching)
2022-09-22 12:28:53 INFO  Starting execution of 1 what-if analyses...
2022-09-22 12:28:53 INFO  Start plan generation for analysis DataCleaning...
2022-09-22 12:28:53 INFO  ---RUNTIME: Plan generation took 0.5936622619628906 ms
2022-09-22 12:28:53 INFO  Estimated runtime of original DAG is 13127.366065979004ms
2022-09-22 12:28:53 INFO  Performing Multi-Query Optimization
2022-09-22 12:28:53 INFO  Estimated unoptimized what-if runtime is 262547.3213195801ms
2022-09-22 12:28:53 INFO  Estimated optimised what-if runtime is 112578.47785949707ms
2022-09-22 12:28:53 INFO  Estimated optimisation runtime saving is 149968.843460083ms
2022-09-22 12:28:53 INFO  ---RUNTIME: Multi-Query Optimization took 104.80213165283203 ms
2022-09-22 12:28:53 INFO  Executing generated plans
2022-09-22 12:30:50 INFO  ---RUNTIME: Execution took 117169.19469833374 ms
2022-09-22 12:30:50 INFO  Done!
2022-09-22 12:30:50 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-22 12:30:50 INFO  Running instrumented original pipeline...
2022-09-22 12:30:50 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-22 12:30:50 INFO  ---RUNTIME: Importing and monkey-patching took 5.678892135620117 ms
2022-09-22 12:31:07 INFO  ---RUNTIME: Original pipeline execution took 16510.136604309082 ms (excluding imports and monkey-patching)
2022-09-22 12:31:07 INFO  Starting execution of 1 what-if analyses...
2022-09-22 12:31:07 INFO  Start plan generation for analysis DataCleaning...
2022-09-22 12:31:07 INFO  ---RUNTIME: Plan generation took 0.6201267242431641 ms
2022-09-22 12:31:07 INFO  Estimated runtime of original DAG is 13291.857957839966ms
2022-09-22 12:31:07 WARNING Skipping Multi-Query Optimization (instead, only applying patches)
2022-09-22 12:31:07 WARNING Columns ['review_id'] not present in train DAG after the train test split, only before!
2022-09-22 12:31:07 WARNING This could hint at data leakage!
2022-09-22 12:31:07 INFO  Estimated unoptimised what-if runtime is 265837.1591567993ms
2022-09-22 12:31:07 INFO  ---RUNTIME: Multi-Query Optimization took 25.77996253967285 ms
2022-09-22 12:31:07 INFO  Executing generated plans
2022-09-22 12:35:45 INFO  ---RUNTIME: Execution took 278480.9858798981 ms
2022-09-22 12:35:45 INFO  Done!
2022-09-22 12:35:45 INFO  # Finished -- repetition 3 of 7 
2022-09-22 12:35:45 INFO  # Optimization benchmark for data_cleaning with args [['reviews', 'fast_loading', 'featurization_4', 'neural_network']] -- repetition 4 of 7
2022-09-22 12:35:45 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-22 12:35:45 INFO  Running instrumented original pipeline...
2022-09-22 12:35:45 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-22 12:35:45 INFO  ---RUNTIME: Importing and monkey-patching took 6.067037582397461 ms
2022-09-22 12:36:01 INFO  ---RUNTIME: Original pipeline execution took 16300.328731536865 ms (excluding imports and monkey-patching)
2022-09-22 12:36:01 INFO  Starting execution of 1 what-if analyses...
2022-09-22 12:36:01 INFO  Start plan generation for analysis DataCleaning...
2022-09-22 12:36:01 INFO  ---RUNTIME: Plan generation took 0.6322860717773438 ms
2022-09-22 12:36:01 INFO  Estimated runtime of original DAG is 12695.095300674438ms
2022-09-22 12:36:01 INFO  Performing Multi-Query Optimization
2022-09-22 12:36:01 INFO  Estimated unoptimized what-if runtime is 253901.90601348877ms
2022-09-22 12:36:01 INFO  Estimated optimised what-if runtime is 109603.67345809937ms
2022-09-22 12:36:01 INFO  Estimated optimisation runtime saving is 144298.2325553894ms
2022-09-22 12:36:01 INFO  ---RUNTIME: Multi-Query Optimization took 106.54258728027344 ms
2022-09-22 12:36:01 INFO  Executing generated plans
2022-09-22 12:37:58 INFO  ---RUNTIME: Execution took 116540.043592453 ms
2022-09-22 12:37:58 INFO  Done!
2022-09-22 12:37:58 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-22 12:37:58 INFO  Running instrumented original pipeline...
2022-09-22 12:37:58 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-22 12:37:58 INFO  ---RUNTIME: Importing and monkey-patching took 5.8841705322265625 ms
2022-09-22 12:38:15 INFO  ---RUNTIME: Original pipeline execution took 16520.19429206848 ms (excluding imports and monkey-patching)
2022-09-22 12:38:15 INFO  Starting execution of 1 what-if analyses...
2022-09-22 12:38:15 INFO  Start plan generation for analysis DataCleaning...
2022-09-22 12:38:15 INFO  ---RUNTIME: Plan generation took 0.6644725799560547 ms
2022-09-22 12:38:15 INFO  Estimated runtime of original DAG is 13232.560396194458ms
2022-09-22 12:38:15 WARNING Skipping Multi-Query Optimization (instead, only applying patches)
2022-09-22 12:38:15 WARNING Columns ['review_id'] not present in train DAG after the train test split, only before!
2022-09-22 12:38:15 WARNING This could hint at data leakage!
2022-09-22 12:38:15 INFO  Estimated unoptimised what-if runtime is 264651.20792388916ms
2022-09-22 12:38:15 INFO  ---RUNTIME: Multi-Query Optimization took 25.496721267700195 ms
2022-09-22 12:38:15 INFO  Executing generated plans
2022-09-22 12:42:53 INFO  ---RUNTIME: Execution took 278037.5442504883 ms
2022-09-22 12:42:53 INFO  Done!
2022-09-22 12:42:53 INFO  # Finished -- repetition 4 of 7 
2022-09-22 12:42:53 INFO  # Optimization benchmark for data_cleaning with args [['reviews', 'fast_loading', 'featurization_4', 'neural_network']] -- repetition 5 of 7
2022-09-22 12:42:53 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-22 12:42:53 INFO  Running instrumented original pipeline...
2022-09-22 12:42:53 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-22 12:42:53 INFO  ---RUNTIME: Importing and monkey-patching took 6.378173828125 ms
2022-09-22 12:43:09 INFO  ---RUNTIME: Original pipeline execution took 16348.15502166748 ms (excluding imports and monkey-patching)
2022-09-22 12:43:09 INFO  Starting execution of 1 what-if analyses...
2022-09-22 12:43:09 INFO  Start plan generation for analysis DataCleaning...
2022-09-22 12:43:09 INFO  ---RUNTIME: Plan generation took 0.6344318389892578 ms
2022-09-22 12:43:09 INFO  Estimated runtime of original DAG is 13050.989389419556ms
2022-09-22 12:43:09 INFO  Performing Multi-Query Optimization
2022-09-22 12:43:09 INFO  Estimated unoptimized what-if runtime is 261019.7877883911ms
2022-09-22 12:43:09 INFO  Estimated optimised what-if runtime is 111326.29942893982ms
2022-09-22 12:43:09 INFO  Estimated optimisation runtime saving is 149693.4883594513ms
2022-09-22 12:43:09 INFO  ---RUNTIME: Multi-Query Optimization took 105.93414306640625 ms
2022-09-22 12:43:09 INFO  Executing generated plans
2022-09-22 12:45:06 INFO  ---RUNTIME: Execution took 117255.36680221558 ms
2022-09-22 12:45:06 INFO  Done!
2022-09-22 12:45:06 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-22 12:45:06 INFO  Running instrumented original pipeline...
2022-09-22 12:45:06 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-22 12:45:06 INFO  ---RUNTIME: Importing and monkey-patching took 5.845785140991211 ms
2022-09-22 12:45:22 INFO  ---RUNTIME: Original pipeline execution took 15802.471399307251 ms (excluding imports and monkey-patching)
2022-09-22 12:45:22 INFO  Starting execution of 1 what-if analyses...
2022-09-22 12:45:22 INFO  Start plan generation for analysis DataCleaning...
2022-09-22 12:45:22 INFO  ---RUNTIME: Plan generation took 0.6558895111083984 ms
2022-09-22 12:45:22 INFO  Estimated runtime of original DAG is 12541.628360748291ms
2022-09-22 12:45:22 WARNING Skipping Multi-Query Optimization (instead, only applying patches)
2022-09-22 12:45:22 WARNING Columns ['review_id'] not present in train DAG after the train test split, only before!
2022-09-22 12:45:22 WARNING This could hint at data leakage!
2022-09-22 12:45:22 INFO  Estimated unoptimised what-if runtime is 250832.56721496582ms
2022-09-22 12:45:22 INFO  ---RUNTIME: Multi-Query Optimization took 25.832653045654297 ms
2022-09-22 12:45:22 INFO  Executing generated plans
2022-09-22 12:50:01 INFO  ---RUNTIME: Execution took 278853.3272743225 ms
2022-09-22 12:50:01 INFO  Done!
2022-09-22 12:50:01 INFO  # Finished -- repetition 5 of 7 
2022-09-22 12:50:01 INFO  # Optimization benchmark for data_cleaning with args [['reviews', 'fast_loading', 'featurization_4', 'neural_network']] -- repetition 6 of 7
2022-09-22 12:50:01 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-22 12:50:01 INFO  Running instrumented original pipeline...
2022-09-22 12:50:01 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-22 12:50:01 INFO  ---RUNTIME: Importing and monkey-patching took 6.213903427124023 ms
2022-09-22 12:50:17 INFO  ---RUNTIME: Original pipeline execution took 16289.199113845825 ms (excluding imports and monkey-patching)
2022-09-22 12:50:17 INFO  Starting execution of 1 what-if analyses...
2022-09-22 12:50:17 INFO  Start plan generation for analysis DataCleaning...
2022-09-22 12:50:17 INFO  ---RUNTIME: Plan generation took 0.6196498870849609 ms
2022-09-22 12:50:17 INFO  Estimated runtime of original DAG is 12630.484819412231ms
2022-09-22 12:50:17 INFO  Performing Multi-Query Optimization
2022-09-22 12:50:17 INFO  Estimated unoptimized what-if runtime is 252609.69638824463ms
2022-09-22 12:50:17 INFO  Estimated optimised what-if runtime is 109171.2703704834ms
2022-09-22 12:50:17 INFO  Estimated optimisation runtime saving is 143438.42601776123ms
2022-09-22 12:50:17 INFO  ---RUNTIME: Multi-Query Optimization took 106.31132125854492 ms
2022-09-22 12:50:17 INFO  Executing generated plans
2022-09-22 12:52:15 INFO  ---RUNTIME: Execution took 117552.11114883423 ms
2022-09-22 12:52:15 INFO  Done!
2022-09-22 12:52:15 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-22 12:52:15 INFO  Running instrumented original pipeline...
2022-09-22 12:52:15 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-22 12:52:15 INFO  ---RUNTIME: Importing and monkey-patching took 5.795478820800781 ms
2022-09-22 12:52:31 INFO  ---RUNTIME: Original pipeline execution took 15901.710510253906 ms (excluding imports and monkey-patching)
2022-09-22 12:52:31 INFO  Starting execution of 1 what-if analyses...
2022-09-22 12:52:31 INFO  Start plan generation for analysis DataCleaning...
2022-09-22 12:52:31 INFO  ---RUNTIME: Plan generation took 0.6594657897949219 ms
2022-09-22 12:52:31 INFO  Estimated runtime of original DAG is 12598.424434661865ms
2022-09-22 12:52:31 WARNING Skipping Multi-Query Optimization (instead, only applying patches)
2022-09-22 12:52:31 WARNING Columns ['review_id'] not present in train DAG after the train test split, only before!
2022-09-22 12:52:31 WARNING This could hint at data leakage!
2022-09-22 12:52:31 INFO  Estimated unoptimised what-if runtime is 251968.4886932373ms
2022-09-22 12:52:31 INFO  ---RUNTIME: Multi-Query Optimization took 25.85887908935547 ms
2022-09-22 12:52:31 INFO  Executing generated plans
2022-09-22 12:57:09 INFO  ---RUNTIME: Execution took 278387.03179359436 ms
2022-09-22 12:57:09 INFO  Done!
2022-09-22 12:57:09 INFO  # Finished -- repetition 6 of 7 
2022-09-22 12:57:09 INFO  # Optimization benchmark for data_cleaning with args [['reviews', 'fast_loading', 'featurization_4', 'neural_network']] -- repetition 7 of 7
2022-09-22 12:57:09 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-22 12:57:09 INFO  Running instrumented original pipeline...
2022-09-22 12:57:09 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-22 12:57:09 INFO  ---RUNTIME: Importing and monkey-patching took 5.867719650268555 ms
2022-09-22 12:57:26 INFO  ---RUNTIME: Original pipeline execution took 16296.199560165405 ms (excluding imports and monkey-patching)
2022-09-22 12:57:26 INFO  Starting execution of 1 what-if analyses...
2022-09-22 12:57:26 INFO  Start plan generation for analysis DataCleaning...
2022-09-22 12:57:26 INFO  ---RUNTIME: Plan generation took 0.7033348083496094 ms
2022-09-22 12:57:26 INFO  Estimated runtime of original DAG is 12630.78236579895ms
2022-09-22 12:57:26 INFO  Performing Multi-Query Optimization
2022-09-22 12:57:26 INFO  Estimated unoptimized what-if runtime is 252615.647315979ms
2022-09-22 12:57:26 INFO  Estimated optimised what-if runtime is 108856.15062713623ms
2022-09-22 12:57:26 INFO  Estimated optimisation runtime saving is 143759.49668884277ms
2022-09-22 12:57:26 INFO  ---RUNTIME: Multi-Query Optimization took 105.38649559020996 ms
2022-09-22 12:57:26 INFO  Executing generated plans
2022-09-22 12:59:22 INFO  ---RUNTIME: Execution took 116609.06791687012 ms
2022-09-22 12:59:22 INFO  Done!
2022-09-22 12:59:22 INFO  The skip_multi_query_optimization function is only intended for benchmarking!
2022-09-22 12:59:22 INFO  Running instrumented original pipeline...
2022-09-22 12:59:22 INFO  Importing libraries and monkey-patching them... (Imports are slow if not in sys.modules cache yet!)
2022-09-22 12:59:22 INFO  ---RUNTIME: Importing and monkey-patching took 5.717039108276367 ms
2022-09-22 12:59:39 INFO  ---RUNTIME: Original pipeline execution took 16416.195154190063 ms (excluding imports and monkey-patching)
2022-09-22 12:59:39 INFO  Starting execution of 1 what-if analyses...
2022-09-22 12:59:39 INFO  Start plan generation for analysis DataCleaning...
2022-09-22 12:59:39 INFO  ---RUNTIME: Plan generation took 0.6814002990722656 ms
2022-09-22 12:59:39 INFO  Estimated runtime of original DAG is 12539.613485336304ms
2022-09-22 12:59:39 WARNING Skipping Multi-Query Optimization (instead, only applying patches)
2022-09-22 12:59:39 WARNING Columns ['review_id'] not present in train DAG after the train test split, only before!
2022-09-22 12:59:39 WARNING This could hint at data leakage!
2022-09-22 12:59:39 INFO  Estimated unoptimised what-if runtime is 250792.26970672607ms
2022-09-22 12:59:39 INFO  ---RUNTIME: Multi-Query Optimization took 26.297807693481445 ms
2022-09-22 12:59:39 INFO  Executing generated plans
2022-09-22 13:04:17 INFO  ---RUNTIME: Execution took 278516.00909233093 ms
2022-09-22 13:04:17 INFO  Done!
2022-09-22 13:04:17 INFO  # Finished -- repetition 7 of 7 
2022-09-22 13:04:17 INFO  # Final results after all repetitions
2022-09-22 13:04:17 INFO     repetition  ... no_opt_what_if_execution_combined_model_training
0           0  ...                                     64308.125257
1           1  ...                                     64380.260944
2           2  ...                                     64433.385849
3           3  ...                                     64452.750683
4           4  ...                                     64284.589529
5           5  ...                                     64435.842514
6           6  ...                                     64234.038115

[7 rows x 26 columns]
